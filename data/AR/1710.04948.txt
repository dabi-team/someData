7
1
0
2

t
c
O
3
1

]

O
C

.
t
a
t
s
[

1
v
8
4
9
4
0
.
0
1
7
1
:
v
i
X
r
a

ParsimoniousAdaptiveRejectionSamplingLucaMartino??ImageProcessingLaboratory,UniversitatdeVal`encia(Spain).AbstractMonteCarlo(MC)methodshavebecomeverypopularinsignalprocessingduringthepastdecades.Theadaptiverejectionsampling(ARS)algorithmsarewell-knownMCtechniquewhichdraweﬃcientlyindependentsamplesfromunivariatetargetdensities.TheARSschemesyieldasequenceofproposalfunctionsthatconvergetowardthetarget,sothattheprobabilityofacceptingasampleapproachesone.However,samplingfromtheproposalpdfbecomesmorecomputationallydemandingeachtimeitisupdated.WeproposetheParsimoniousAdaptiveRejectionSampling(PARS)method,whereaneﬃcienttrade-oﬀbetweenacceptancerateandproposalcomplexityisobtained.Thus,theresultingalgorithmisfasterthanthestandardARSapproach.Keywords:MonteCarlomethods,RejectionSampling,AdaptiveRejectionSampling.1IntroductionAdaptiverejectionsampling(ARS)schemesarewidelyemployedinsignalprocessingforoptimization,complexsystemsimulationandBayesianinference[8,9,10,12].Theygenerateindependentsamplesfromatargetprobabilitydensityfunction(pdf).Forinstance,theARSalgorithmsarerequiredwithinGibbs-typesamplersfordrawingone(orseveral;see[5])samplesfromtheunivariatefull-conditionalpdfs[2,9,5].SincethestandardARSmethod[2]canbeappliedonlywhenthetargetdensityislog-concave,severalextensionshavebeenproposed[1,3,4,7,8,6,9].Inthisletter,wefocusonthecomputationalcostrequiredbyARS.TheARSalgorithmsobtainhighacceptanceratesbuildingasequenceofnon-parametricproposalfunctionswhichbecomecloserandclosertotargetfunction.Hence,thisimprovementoftheacceptancerateisobtainedbuildingmorecomplexproposals,i.e.,morecomputationallydemanding.TheoveralltimespentbyanARSschemedependson(a)theacceptancerateand(b)thetimerequiredfordrawingfromtheproposalpdf.InARS,atrade-oﬀisfounddecreasingtheprobabilityofupdatingtheproposalastheacceptancerategrows.Here,weintroducetheParsimoniousAdaptiveRejectionSampling(PARS)method,whichachievesabettercompromisebetweenacceptancerateandproposalcomplexity.PARSobtainsabetterconstructionofthenon-parametricproposalpdf,reachinghighacceptancerateswithasmallercomplexityoftheproposalw.r.t.totheclassicalARSapproach.Asaconsequence,PARSisfasterthanARSasconﬁrmedbythenumerical 
 
 
 
 
 
simulations.TheMatlabcodeofPARSandARS,relatedtotheprovidednumericalresults,isgivenatMatlab-FileExchangewebpage.2StandardARSLetusdenotethetargetdensityas¯π(x)∝π(x)=exp(cid:0)V(x)(cid:1),x∈X⊆R.Theadaptiveproposalpdfisdenotedas¯qt(x|St)∝qt(x|St)=exp(cid:0)Wt(x)(cid:1),wheret∈N.Inordertoapplyrejectionsampling(RS)[8,12],itisnecessarytobuildqt(x|St)asanenvelopefunctionofπ(x),i.e.,qt(x|St)≥π(x),orWt(x)≥V(x),(1)forallx∈Xandt∈N.LetusassumethatV(x)=logπ(x)isconcave(i.e.,π(x)islog-concave),andweareabletoevaluatethefunctionV(x)anditsﬁrstderivativeV0(x).ThestandardARStechnique[2]considersasetofsupportpoints(nodes)atthet-thiteration,St={s1,s2,...,smt}⊂X,withs1<...<smtandmt=|St|,inordertoconstructanon-parametricenvelopefunctionqt(x|St).Wedenoteaswi(x)asthestraightlinetangenttoV(x)atsifori=1,...,mt.WecanbuildapiecewiselinearfunctionasWt(x)=min[w1(x),...,wmt(x)],x∈X.(2)Hence,theproposalfunctiondeﬁnedasqt(x|St)=exp(Wt(x))isformedbyexponentialpieces,whereWt(x)≥V(x)sothatqt(x|St)≥π(x).Figure1depictsanexampleofpiecewiselinearfunctionWt(x)builtwithmt=3supportpoints.Severalotherconstructionproceduresforspeciﬁcnon-log-concavetargetsπ(x)havebeenproposed[4,8].Table1summarizestheARSalgorithmfordrawingNindependentsamplesfrom¯π(x).Ateachiterationt,asamplex0isdrawnfrom¯qt(x|St)andacceptedwithprobabilityπ(x0)qt(x0|St).NotethatanewpointisaddedtothesupportsetStwheneverx0isrejectedintheRStest,sothatqt+1becomesclosertoπ.DenotingasTthetotalnumberofiterationsofthealgorithm,wehavealwaysT≥NowingtotheT−Nrejectedsamples.3ComputationalcostofARSThecomputationalcostofanARS-typemethoddependsontwoelements:1.Theacceptancerateatt-thiteration,ηt=ZXπ(x)qt(x|St)¯qt(x|St)dx,(3)where0≤ηt≤1,∀t∈N,byconstruction.Asqt(x|St)becomesclosertoπ(x)fort→∞thenηt→1.Intheidealcaseηt=1forallt,henceT=N.2.Thecomputationaltimerequiredforsamplingfrom¯qt(x|St).2€ s1€ s2€ s3€ w1(x)€ w2(x)€ w3(x)€ V(x)€ Wt(x)Figure1:ExampleofconstructionofthepiecewiselinearfunctionWt(x)withmt=3supportpoints,suchthatWt(x)≥V(x).Table1:StandardAdaptiveRejectionSampling1.Sett=0andn=0.ChooseaninitialsetS0={s1,...,sm0}.2.Whilen<N:(a)Buildtheproposalqt(x|St)accordingtoEq.(2).(b)Drawx0∼¯qt(x|St)andu0∼U([0,1]).(c)Ifu0≤π(x0)qt(x0|St),thensetxn+1=x0andSt+1=St.(d)Otherwise,ifu0>π(x0)qt(x0|St),updateSt+1=St∪{x0}.(e)Sett=t+1andn=n+1.3.Outputs:TheNacceptedsamples,x1,...,xN.Wedesirethattheacceptancerateiscloseto1and,simultaneously,thatthecomputationaltimerequiredfordrawingfromqt(x|St)issmall.Notethatanincreaseoftheacceptanceraterequirestheuseofamorecomplicatedproposaldensityqt(x|St).ARSprovidesapossiblecompromisechoosingthesupportpointsadequatelybytheadaptation.Indeed,letusdeﬁnetheL1distancebetweenqtandπasD(qt,π)=kqt(x|St)−π(x)k1=ZX|qt(x|St)−π(x)|dx.(4)3ARSensuresthatD(qt,π)→0whent→∞(andηt→1)sinceqtbecomesclosertoπasmorenodesareincluded(seeFigure1).TheprobabilityofaddinganewsupportpointPt=1−ηt=D(qt,π)RXqt(x|St)dx,(5)tendstozeroast→∞,sinceD(qt,π)→0.Hence,thenumberofnodesmttendstosaturateast→∞(i.e.,mtasfunctionoftisincreasingbutconvex).Letusdenotetheexponentialpiecesashn(x)=exp(wn(x)),n=1,...,N,sothatqt(x|St)=hn(x),forx∈In=(en−1,en),n=1,...,N,whereenistheintersectionpointbetweenthestraightlineswn(x)andwn+1(x),forn=2,...,N−1,ande0=−∞andeN=+∞(ifX=R).Thus,inordertodrawonesamplex0from¯qt(x|St),weneedto:1.ComputeanalyticallytheareaAi=RIihi(x)dxbeloweachexponentialpiece,andobtainthenormalizedweightsρi=AiPNn=1An.2.Selectanindexj∗(i.e.,onepiece)accordingtotheprobabilitymassρi,i=1,...,N.3.Drawx0fromhj∗(x)restrictedwithinthedomainIj∗=(ej∗−1,ej∗),andzerooutside(i.e.,fromatruncatedexponentialpdf).Notethatamultinomialsamplingisneededatstep2.Hence,thecomputationalcostofdrawingfrom¯qt(x|St)increasesasthenumberofpointsmtgrows.4ParsimoniousARS4.1KeyobservationInARS,theprobabilityofaddinganewsupportpointPtvanishestozeroast→∞.However,foraﬁnitet,wehavealwaysapositiveprobabilityPt>0(althoughsmall)ofaddinganewpoint,sothatanewsupportpointcouldbeincorporated,buildingabetterqt(x|St)andyieldinganincreaseoftheacceptancerate.Afteracertainiterationτ,i.e.,t>τ,thisimprovementoftheacceptanceratecouldnotbalanceouttheincreaseofthetimerequiredfordrawingfromtheproposal,duetotheadditionofthenewpoint.Namely,iftheacceptancerateisenoughcloseto1,afurtheradditionofasupportpointcouldslowdownthealgorithm,becomingprejudicial.4.2NovelschemeInthestandardARS,theadditionofanewnodeislinkedtotheRStest,indeedalltherejectedsamplesareincorporatedasnewsupportpoints.WeproposetheParsimoniousAdaptiveRejectionSampling(PARS)method,whereadiﬀerenttestisconsideredforaddinganewnode.Speciﬁcally,theRStestusedinordertoacceptorrejecttheproposedsamplex0,whereasanadditional4deterministictestisperformedforincorporating(ornot)x0inSt.Givenapre-establishedthreshold0≤δ≤1,x0isemployedasnewnodeifπ(x0)qt(x0|St)≤δ.PARSisoutlinedinTable2.Ifδ=0,PARSbecomesanon-adaptiveRStechniquewhereas,ifδ=1,alltheproposedsamplesx0areaddedasnewnodes.Forageneric0<δ<1,atsomeiterationt∗theadaptationisstoppedsincenomoresupportpointsareincluded.PARSforcestoobtainacceptanceprobabilitiesπ(x0)q(x0|St)greaterthanδ,performingabetterselectionofthenodes.Indeed,ingeneral,PARSobtainshighacceptancevaluesusingasmallernumberofsupportpointsthanARS.Asaconsequence,PARSisfasterthanARSasshowninthenumericalsimulations.Table2:ParsimoniousAdaptiveRejectionSampling(PARS)1.Sett=0andn=0.ChooseS0={s1,...,sm0}andathresholdvalue0≤δ≤1.2.Whilen<N:(a)Buildtheproposalqt(x|St)accordingtoEq.(2).(b)Drawx0∼¯qt(x|St)∝qt(x|St)andu0∼U([0,1]).(c)Ifu0≤π(x0)qt(x0|St),thensetxn+1=x0.(d)Ifπ(x0)qt(x0|St)≤δ,updateSt+1=St∪{x0}.Otherwise,ifπ(x0)qt(x0|St)>δ,setSt+1=St.(e)Sett=t+1andn=n+1.3.Outputs:TheNacceptedsamples,x1,...,xN.5NumericalResultsTheNakagami-mdistributioniswidelyusedforthesimulationoffadingchannelsinwirelesscommunications,duetoitsgoodagreementwithempiricalchannelmeasurementsforsomeurbanmultipathenvironments[11].TheNakagamipdfis¯π(x)∝π(x)=x2m−1exp(cid:16)−mΩx2(cid:17),x≥0,(6)wherem≥0.5isthefadingparameter,whichindicatesthefadingdepth,andΩ>0istheaveragereceivedpower.SeveralmethodsfordrawingsamplesfromaNakagami-mpdfhavebeenproposed[10,12].Inourexperiments,wesetm=1.2andΩ=2.Wecomparethecomputationaltime(computedinaMAC-1.7GHz-8GB)requiredbyARSandPARS(consideringδ=0.8)fordrawingN∈{5·104,105,1.5·105,2·105}samples,withinitialsetS0={0.5,1,2}.Theresults,averaged5over200runs,aregiveninFigure2(a).PARSisalwaysfasterthanARS,andthebeneﬁtgrowswithN.Thecorrespondingaveragedﬁnalnumbersofnodes,E[mT],areprovidedinFigures2(b).WecanobservethatthetotalnumberofnodesofPARS(δ=0.8)remainsvirtuallyconstant.Figures2(c)-(d)providesthecomputationaltimerequiredbyPARSandtheﬁnalnumberofnodesasfunctionofδ,settingN=5·104.ThevaluescorrespondingtoARSareshowingwithconstantdashedlines.WecanobservethatPARSisalwaysfasterthanARSwiththeexceptionoftheextremevaluesδ=0.999andδ=0.9999,forwhichvaluesPARSincorporateshighernumberofnodes,E[mT]=137.2andE[mT]=385.5,respectively.However,notethatthesevaluescorrespondingtoδ∈{0.999,0.9999},aresurprisinglysmall,sinceE[mT]=N=5·104forδ=1,byconstruction.ThisisduetotheabilityofPARSinselectingnodesforbuildingasuitableproposalpdf.Indeed,forN=5·104,PARSobtainsanoverallacceptancerateE(cid:2)NT(cid:3)=0.8524withonlyE[mT]=6.75nodeswhenδ=0.5,andE(cid:2)NT(cid:3)=0.9675withE[mT]=12.35whenδ=0.8(withARS,wehaveE(cid:2)NT(cid:3)=0.9962withE[mT]=71.60).RelatedcodeisprovidedatMatlab-FileExchangewebpage.6ConclusionsInthiswork,wehaveintroducedanovelparsimoniousARSscheme(PARS)whichautomaticallyreachesabettercompromisebetweenacceptancerateandproposalcomplexitythanthestandardARSmethod.Asaconsequence,PARSisafastersamplerthanARS.7AcknowledgementsThisworkhasbeensupportedbytheERCGrantSEDAL,ERC-2014-CoG647423.References[1]M.EvansandT.Swartz.Randomvariategenerationusingconcavitypropertiesoftransformeddensities.JournalofComputationalandGraphicalStatistics,7(4):514–528,1998.[2]W.R.GilksandP.Wild.AdaptiveRejectionSamplingforGibbsSampling.AppliedStatistics,41(2):337–348,1992.[3]DilanG¨or¨urandYeeWhyeTeh.Concaveconvexadaptiverejectionsampling.UniversityCollegeLondon,TechnicalReport,2009.[4]W.H¨ormann.ArejectiontechniqueforsamplingfromT-concavedistributions.ACMTransactionsonMathematicalSoftware,21(2):182–193,1995.[5]L.Martino,V.Elvira,andG.Camps-Valls.TheRecyclingGibbsSamplerforeﬃcientlearning.arXiv:1611.07056,2016.6[6]L.MartinoandF.Louzada.AdaptiveRejectionSamplingwithﬁxednumberofnodes.arXiv:1509.07985,2015.[7]L.MartinoandJ.M´ıguez.Anovelrejectionsamplingschemeforposteriorprobabilitydistributions.Proc.ofthe34thIEEEICASSP,April2009.[8]L.MartinoandJ.M´ıguez.Generalizedrejectionsamplingschemesandapplicationsinsignalprocessing.SignalProcessing,90(11):2981–2995,November2010.[9]L.Martino,J.Read,andD.Luengo.IndependentdoublyadaptiverejectionMetropolissamplingwithinGibbssampling.IEEETransactionsonSignalProcessing,63(12):3123–3138,2015.[10]M.MatthaiouandD.I.Laurenson.RejectionmethodforgeneratingNakagami-mindependentdeviates.IETElectronicsLetters,43(25):1474–1475,Dec.2007.[11]T.K.Sarkar,Z.Ji,K.Kim,A.Medouri,andM.Salazar-Palma.Asurveyofvariouspropagationmodelsformobilecommunication.IEEEAntennasandPropagationMag.,45(3):51–82,June2003.[12]Q.M.Zhu,X.Y.Dang,D.Z.Xu,andX.M.Chen.HighlyeﬃcientrejectionmethodforgeneratingNakagami-msequences.IETElectronicsLetters,47(19):1100–1101,Sep.2011.7(a)0.511.52x 1051020304050607080NTIME (sec)  ARSPARS (δ=0.8)(b)00.511.52x 105020406080100120NFinal number of nodes  ARSPARS (δ=0.8)(c)0.50.60.70.80.9110152025303540δTIME (sec)  PARSARS(d)0.50.60.70.80.910100200300400δFinal number of nodes  PARSARSFigure2:(a)-(c)ComputationaltimespentbyARSandPARSasfunctionofthenumberofthedesiredsamples,N,andtheparameterδ(in(a)δ=0.8,in(c)N=5·104).(b)-(d)Averagedﬁnalnumberofnodes,E[mT],asfunctionofNandδ(in(b)δ=0.8,in(d)N=5·104).8