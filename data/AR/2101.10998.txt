SDF-Bayes: Cautious Optimism in Safe Dose-Finding Clinical Trials
with Drug Combinations and Heterogeneous Patient Groups

Hyun-Suk Lee
Sejong University

Cong Shen
University of Virginia

William Zame
UCLA

1
2
0
2

n
a
J

6
2

]

G
L
.
s
c
[

1
v
8
9
9
0
1
.
1
0
1
2
:
v
i
X
r
a

Jang-Won Lee
Yonsei University

Abstract

Phase I clinical trials are designed to test
the safety (non-toxicity) of drugs and ﬁnd
the maximum tolerated dose (MTD). This
task becomes signiﬁcantly more challenging
when multiple-drug dose-combinations (DC)
are involved, due to the inherent conﬂict be-
tween the exponentially increasing DC can-
didates and the limited patient budget. This
paper proposes a novel Bayesian design, SDF-
Bayes, for ﬁnding the MTD for drug combi-
nations in the presence of safety constraints.
Rather than the conventional principle of
escalating or de-escalating the current dose
of one drug (perhaps alternating between
drugs), SDF-Bayes proceeds by cautious op-
timism: it chooses the next DC that, on the
basis of current information, is most likely to
be the MTD (optimism), subject to the con-
straint that it only chooses DCs that have a
high probability of being safe (caution). We
also propose an extension, SDF-Bayes-AR,
that accounts for patient heterogeneity and
enables heterogeneous patient recruitment.
Extensive experiments based on both syn-
thetic and real-world datasets demonstrate
the advantages of SDF-Bayes over state of
the art DC trial designs in terms of accuracy
and safety.

1

INTRODUCTION

of

combinations of drugs

The use
is becom-
ing an increasingly valuable–and common–treatment
modality (Bamias et al., 2011; Flaherty et al., 2012;

Proceedings of the 24th International Conference on Artiﬁ-
cial Intelligence and Statistics (AISTATS) 2021, San Diego,
California, USA. PMLR: Volume 130. Copyright 2021 by
the author(s).

Mihaela van der Schaar
University of Cambridge, UCLA,
The Alan Turing Institute

Ocana et al., 2019; Kelly and Halabi, 2018), especially
in the treatment of cancer, where it has been widely
observed that combinations of drugs can be eﬀective
when single drugs are not (Paller et al., 2019). (Sim-
ilar observations have been made for other diseases,
including COVID-19.) As a result, there has been
an enormous eﬀort to test and validate drug combi-
nations for treatment; indeed combination trials now
account for more than 25% of all clinical trials in on-
cology (Wu et al., 2014).

However, clinical trials of drug combinations face
greater challenges than those of single drugs, especially
in Phase I trials which are required to ﬁnd safe doses.
The essential problem is that the number of poten-
tial dose-combinations (DCs) to be tested in a trial
increases exponentially with the number of drugs, but
the patient budget cannot scale proportionately.
In-
deed, a typical real-world Phase I trial often recruits
fewer than 100 patients; a few examples are shown in
Table 1. The limited patient budget constrains the
number of DCs that can be throughly tested. More-
over, because drugs interact diﬀerently with diﬀerent
body chemistry of diﬀerent groups of patients (e.g.,
with the diﬀerent hormone balances and levels in males
and females), it is frequently possible to identify in
advance groups of patients who might be expected
to exhibit very diﬀerent tolerances for the same DC
(Sun and Braun, 2015; Kim et al., 2009; Dasari et al.,
2013; Moss et al., 2015; Wages et al., 2015).

In view of the growing importance of drug combina-
tions in the treatment of disease, it is of enormous
importance to design Phase I drug combination tri-
als in a way that is eﬃcient,
informative and safe
(Hamberg et al., 2010). This design includes the path
of DC testing and, in the presence of identiﬁed hetero-
geneous groups, the allocation of patient budgets to
groups as well.

This paper develops a new dose-ﬁnding Phase I clini-
cal trial method for drug combinations and heteroge-
neous patient groups and demonstrates that it is supe-

 
 
 
 
 
 
SDF-Bayes: Cautious Optimism in Safe Dose-Finding Clinical Trials

Table 1: Examples of Phase I clinical trial studies with drug combinations

Study

Drugs

No. of DC No. of Patients

Target disease

(Plummer et al., 2008) Rucaparib & temozolomide

(Bailey et al., 2009)

Nilotinib & imatinib

(Bagatell et al., 2014)

Temsirolimus & irinotecan
& temozolomide

(Calvo et al., 2017) Dacomitinib & Figitumumab

12

20

24

12

32

50

71

74

Advanced solid tumors

Gastrointestinal stromal tumors

Solid tumors

Advanced solid tumors

rior to existing methods. For a given patient budget,
the design objective is to maximize the probability of
ﬁnding the maximum tolerated dose (MTD), deﬁned
to be the DC that is closest to a given target toxic-
ity threshold, subject to constraints on the exposure
of patients to unsafe doses throughout the trial. Our
safe dose-ﬁnding (SDF) method employs an adaptive
design: the DC to be tested in the current round is
chosen on the basis of past observations. This is pos-
sible because Phase I trials are not blind; the trialist
knows the DC given to each patient and observes the
outcome. The SDF-Bayes algorithm builds on a novel
learning principle we call Cautious Optimism, which
manifests by combining two opposing ideas: (1) SDF-
Bayes constrains the choice of DC to be tested in the
current round to a set of DCs that it estimates to be
unlikely to violate the safety constraint; this is the
principle of caution, and (2) within this constrained
set of DCs, SDF-Bayes chooses the DC to be tested
in the current round to be the one estimated to be
most likely to be the MTD; this is the optimistic belief
principle (Aziz et al., 2019).

To deal with settings in which potentially heteroge-
neous patient groups can be identiﬁed in advance,
we also propose a extension, that we call SDF-Bayes-
AR,
in which both the DC to be tested and the
patient group to be sampled in the current round
are chosen adaptively. To determine the group from
which to recruit the next patient, SDF-Bayes-AR
uses
(EI).
the criterion of expected improvement
Adaptive recruitment is especially useful when there
is prior information about one or several groups
(Pallmann et al., 2018; Park et al., 2018; Atan et al.,
2019), and an appealing feature of our approach is that
it can smoothly incorporate prior information, be it
from the drug development phase, from dose-toxicity
models, from tests in vitro and in animals, or from
previous trials (Gasparini, 2013; Shen et al., 2019).

We validate the proposed designs via extensive sim-
ulated trials using both synthetic and real-world
datasets. We show that, using a realistic number of
patients, our algorithms provide signiﬁcantly more ac-
curate recommendations than state-of-the-art designs,
while obeying the safety constraints, for both homoge-
neous and heterogeneous patient populations.

2 DC-FINDING CLINICAL TRIALS

2.1 Dose-Toxicity Model

We consider a dual-agent dose-ﬁnding Phase I clinical
trial for the combination of agents (drugs) A and B. We
assume discrete dose levels J = {1, ..., J} for agent A
and K = {1, ..., K} for agent B. We use (j, k) to denote
the combination of dose j of agent A and dose k of
agent B so that the set of all DCs is just A = J ×K. We
model the toxicity event Yjk of DC (j, k) as a Bernoulli
random variable with unknown parameter pjk. We set
Yjk = 1 to indicate that a dose-limiting toxicity (DLT)
was observed for (j, k), and Yjk = 0 otherwise.

We assume the toxicities follow a parametric joint dose-
toxicity model

π : Θ × J × K → [0, 1]

(1)

where Θ is some space of parameters, and π(θ, j, k) =
pjk(θ) is the toxicity of the DC (j, k) if the parameter
is θ ∈ Θ. The true vector of parameters θ∗ is un-
known and must be learned/estimated. The literature
has suggested various dose-toxicity models (Gasparini,
2013; Riviere et al., 2014); we present details of some
commonly-used models in the Supplementary Mate-
rial; we focus here on developing a methodology that
can be used with many parametric joint dose-toxicity
models.

2.2 Problem Formulation

We consider an adaptive Phase I clinical trial for drug
combinations with a given patient budget T . The nom-
inal trial objective is to ﬁnd the DC whose estimated
toxicity is closest to the threshold ξ; i.e. to ﬁnd any
DC that belongs to

A∗ = argmin

jk

pjk(θ∗) − ξ

.

(cid:12)
(cid:12)
For each t, write O(t) = {(Yτ , a(τ ))}t−1
(cid:12)
(cid:12)
τ =1 for the history
of trial actions and observations before t; a(τ ) is the
DC that was administered to patient τ and Yτ is the ob-
served toxicity for DC a(τ ) on patient τ . As in typical
adaptive clinical trial designs, all DCs are actionable in
the trial. A DC-ﬁnding algorithm Π maps the history
O(t) to the DC a(t) ∈ A that is to be administered to
patient t. At the end of the clinical trial, the algorithm
recommends a DC ˆa∗. The recommendation is correct

Hyun-Suk Lee, Cong Shen, William Zame, Jang-Won Lee, Mihaela van der Schaar

if ˆa∗ ∈ A∗; otherwise the recommendation is an error.
We set the objective of our algorithm to minimize the
probability that errors occur. (Because the occurrence
of toxicity events is stochastic, there is always some
positive probability that errors will occur.)

Optimism for Eﬃciency We assess which DC is
most likely to be the MTD by using the posterior dis-
tribution f (θ|O) as described in (3). For this, in our
algorithm we follow the literature (see (Riviere et al.,
2014), for example) and ﬁnd the DC

Because testing unsafe DCs should be avoided, we
insist that, with high probability, the average toxicity
should not exceed the toxicity threshold plus a margin
of error. We formalize this by deﬁning the DLT
observation rate to be

S(T ) =

1
T

T

Yt

t=1
X

and we impose the safety constraint

P

S(T ) ≤ ξ + ǫ

≥ 1 − δ,

(2)

where ǫ > 0 is a prescribed margin of error and δ > 0
is a prescribed acceptable probability of failure.

(cid:0)

(cid:1)

3 CAUTIOUS OPTIMISM

3.1 Preliminaries

Given the dose-toxicity structure, we begin with a
prior distribution f (θ) on the parameter vector θ and
update the posterior distribution, based on the obser-
vations.
(The assumption of a prior distribution is
common in the literature, and is natural, because the
toxicities of the individual drugs are usually under-
stood on the basis of prior use, and the various drug
combinations will have already been tested in vitro
and in animals.) We write f (θ|O(t)) to denote the
posterior distribution of θ following the history O(t).
The likelihood of θ in round t for the observations O(t)
satisﬁes

L(θ|O(t)) ∝

pa(θ)sa (t)(1 − pa(θ))na (t)−sa(t),

Ya∈A

where na(t) is the number of times DC a has been
I[a(τ ) = a]Yτ
chosen before round t and sa(t) =
is the number of DLTs observed for the DC a before
round t. The posterior distribution satisﬁes

t−1
τ =1

P

f (θ|O(t)) ∝ L(θ|O(t))f (θ).

(3)

3.2 Cautious Optimism in Bayesian SDF

We base our algorithm on the principle of “optimism
in the face of uncertainty” (Bubeck and Cesa-Bianchi,
2012), which means choosing the DC that is currently
estimated to be most likely to be the MTD, but we
maintain safety by constraining the set of DCs from
which we choose.

P

argmax
a

{θ : |pa(θ) − ξ| < u}

,

(cid:0)

(cid:1)

where u is some prescribed allowable margin of error,
and the probability is taken with respect to the poste-
rior distribution on the parameter space Θ.
The probability GO(t)
(u) that the toxicity of DC a be-
longs to the given target toxicity interval [ξ−u, ξ+u] is

a

GO(t)
a

(u) = P[pa(θ) ∈ [ξ − u, ξ + u]|O(t)]

(4)

=

I[pa(θ) ∈ [ξ − u, ξ + u]]f (θ|O(t))dθ.

ZΘ

Then, we ﬁnd a DC a(t) that is deemed most likely
to have toxicity in [ξ − u, ξ + u]; i.e.

ao(t) = argmax

a

GO(t)
a

(u).

The DC is chosen to be allocated if it is deemed “safe
enough” (see the next paragraph) at round t. If the
argmax is not a singleton, we choose arbitrarily, sub-
ject to maximizing the total dose of both drugs.

Caution for Safety To determine the set of DCs
that are “safe enough” in round t we ﬁrst choose a
hyperparameter v > 0 that controls conservativeness
and deﬁne

F O(τ )
a

(v) = max

x ∈ [0, 1] : P

pa(θ) ≤ x

O(τ )

≤ v

Φ(t, v) =

t−1

n
F O(t)
a(τ ) (v)

(cid:2)

τ =1
X

r(t, v) = (ξ + ǫ)t − Φ(t, v).

(cid:12)
(cid:12)

(cid:3)

o

(5)

Roughly speaking, Φ(t, v) represents the number of
DLT observations that would have been expected be-
fore round t, given the posterior. For safety, we are
“allowed” a DLT observation rate ξ + ǫ so if Φ(t, v) ≤
(t − 1)(ξ + ǫ) the safety constraint holds in expec-
tation after t − 1 rounds; if we choose a(t) so that
Φ(t + 1, v) ≤ t(ξ + ǫ) then we will have met the safety
constraint in expectation after t rounds. We cannot
be assured of choosing such an a(t) because we do
not know what the posterior will be after t rounds,
but if the posterior after t rounds were the same as
the posterior after t − 1 rounds and we choose a(t)
to have expected toxicity less than the residual r(t, v)
then the safety constraint will be met in expectation
after t rounds. So deﬁne

Ar(t) := {a ∈ A : F O(t)

a

(v) ≤ r(t, v)}.

(6)

SDF-Bayes: Cautious Optimism in Safe Dose-Finding Clinical Trials

Unfortunately it might be that ao(t) /∈ Ar(t). (That
would certainly be the case if r(t, v) < 0, which means
that the safety constraint had already been violated in
expectation.) In that case we can use a conservative
DC, one whose expected toxicity is no greater than ξ,
so that after t rounds the residual r(t + 1, v) will be
greater than the residual r(t, v). The set of conserva-
tive DCs is

Ac(t) := {a ∈ A : F O(t)

a

(v) ≤ ξ}.

We allocate the most likely conservative DC to be
if
the MTD;
Ac(t) = ∅ we terminate the procedure with no rec-
ommendation.

i.e., argmaxa∈Ac(t) GO(t)

(u). Finally,

a

Theoretical Guarantee The following Proposition
shows that, when this cautiously optimistic procedure
can be carried out, it maintains the safety constraint
by keeping the residual non-negative with a high prob-
ability. (The proof is in the Supplementary Materials.)

Proposition 1 Fix t ≤ T . For each τ ≤ t, set vτ =
(1 − δ)1/τ . If the residuals r(τ, vτ ) are non-negative
for all τ ≤ t then the cautious optimism principle in
Bayesian SDF satisﬁes

P

t

1
t

pa(τ )(θ) ≤ ξ + ǫ

"

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
3.3 Algorithm Description

τ =1
X

≥ 1 − δ.

O(t)

#

Here we provide an implementation of the cautious
optimism principle described above. Because we are
considering an arbitrary joint dose-toxicity model, our
implementation relies on Bayesian sampling in order
to ensure the universal applicability of the algorithm.
We comment that our algorithm can be easily extended
for drug combinations with more than two drugs if a
corresponding dose-toxicity model is given.

We denote the number of samples from the posterior
distribution f (θ|O) by L, and the samples in round
t as ˜Θ(t) = {θ(l)(t)}l∈[L]. We use a Gibbs sampler
(Gilks et al., 1995); this is a common multidimensional
Bayesian sampling algorithm. Inside the Gibbs sam-
pler, we use the adaptive rejection Metropolis sam-
pling method (Gilks et al., 1995). Details can be found
in the Supplementary Material.

In round t, we use the samples to approximate the
probability GO(t)
L

(u) by

a

I

t : ξ − u ≤ pa(θ(l)(t)) ≤ ξ + u

.

˜GO(t)
a

(u) =

1
L

Using this approximation, the DC most likely to be
(u).
the MTD in round t is ˜ao(t) = argmaxa∈A

˜GO(t)
a

(cid:9)

Xl=1

(cid:8)

a

SDF-Bayes then infers whether the safety constraint
is violated or not for the chosen DC by evaluating the
residual. To calculate the residual in practice, we de-
ﬁne ˜F O(t)
(v) := Prctile(a, ˜Θ(t), v) that returns the
percentile of the toxicities of DC a calculated from
the samples ˜Θ(t) for the percentage v ∈ [0, 1]. Then,
from (5), we calculate the residual r(t, v) in round t by
˜F O(t)
a(τ ) (v) and deﬁne ˜Ar(t) as in
r(t, v) = (ξ+ǫ)t−
(6) with ˜F O(t)
(v). To keep the residual non-negative,
SDF-Bayes accepts the chosen DC ¯a(t) if it does not
make the residual negative: ˜ao(t) ∈ ˜Ar(t). Otherwise,
it rejects the chosen DC and chooses the most likely
DC to be the MTD in the set of conservative DCs; i.e.,
argmaxa∈ ˜Ac(t)

(u), where

˜GO(t)
a

t−1
τ =1

P

a

˜Ac(t, v) = {a ∈ A : ˜F O(t)

a

(v) ≤ ξ}.

If the set is empty, then the trial is terminated in
the cautious optimism principle. However, this may
be too conservative in the practical implementation,
especially if v is relatively large, because it implies
that there is no “safe enough” DC in a conservative
view, not all DCs are unacceptably unsafe. Hence,
if ˜Ac(t, v) = ∅, SDF-Bayes ﬁrst ﬁnds w so that
˜Ac(t, w) 6= ∅ and ˜Ac(t, v′) = ∅ for all v′ > w. Then,
it continues the trial by choosing the most likely DC
in ˜Ac(t, w) if w > ψ, where ψ is a predeﬁned param-
eter for early termination rule. Otherwise, it termi-
nates the trial with no recommendation because it
(This early termination
implies all DCs are unsafe.
rule is widely used in the literature (Riviere et al.,
2014; Yin and Yuan, 2009a).) With the chosen DC
a(t), the DLT Yt is then observed, and the observa-
tion O(t + 1) is updated. This process repeats un-
til T patients have been administered. At the end of
the clinical trial, the DC recommendation is given by
˜GO(T )
ˆa∗ = argmaxa∈A
(u). The pseudocode of the
a
algorithm is summarized in Algorithm 1.

4 HETEROGENEOUS GROUPS

4.1 Problem formulation

We now show how to adapt SDF-Bayes to deal with
heterogeneous groups. We continue to assume a total
budget of T patients, which now can be distributed
across M patient groups M = {1, 2, ..., M }. We al-
low for the possibility that the dose-toxicity model
varies across diﬀerent groups, and model the toxicity
Y m
jk of (j, k) for group m as a Bernoulli random vari-
able with unknown parameter pm
jk. For each group m,
we assume pm
jk follows a parametric joint dose-toxicity
model pm
m for the true
parameter and ξm for the prescribed toxicity thresh-
old. For patient t, the algorithm ﬁrst chooses a group

jk(θ) = πm(j, k, θ); we write θ∗

Hyun-Suk Lee, Cong Shen, William Zame, Jang-Won Lee, Mihaela van der Schaar

6:
7:
8:
9:
10:
11:

Algorithm 1 SDF-Bayes
1: while t ≤ T do
2:
3:
4:
5:

Sample θ from their posterior distribution
if ˜ao(t) ∈ ˜Ar(t) then
a(t) ← ˜ao(t)

else if ˜Ac(t, v) 6= ∅ then
a(t) ← argmaxa∈ ˜Ac(t,v)

˜GO(t)
a

(u)

else

if w > ψ then

a(t) ← argmaxa∈ ˜Ac(t,w)

else

˜GO(t)
a

(u)

Terminate trial without recommenda-

tion

end if

end if
Observe the DLT Yt
Update sa(t)(t + 1) and na(t)(t + 1)
t ← t + 1

12:
13:
14:
15:
16:
17: end while
18: Output: ˆa∗ = argmaxa∈A

˜GO(T )
a

(u)

g(t) ∈ M from which to recruit the next patient, then
chooses a DC for the recruited patient based on the his-
tory O(t) = {(Yτ , g(τ ), a(τ )}t−1
τ =1 prior to round t. The
outcome (DLT or not) is then observed and recorded.
This continues until the total budget T is exhausted.

At the end of the trial, the algorithm recommends, for
each group m, a DC ˆa∗
m to be used as the MTD for
that group. As before, the (set of) true MTD(s) for
group m is

A∗

m = argmin

a∈A

|pm

a (θ∗

m) − ξm|,

and the recommendation is an error if ˆa∗
m. The
safety constraint for group m is P[Sm(T ) ≤ ξm + ǫ] ≤
t=1 YtI[g(t)=m]
1 − δ, ∀m ∈ M, where Sm(T ) = PT
I[g(t)=m] .
PT

m /∈ A∗

t=1

4.2 SDF-Bayes for Heterogeneous Groups

The goal of a clinical trial with heterogeneous groups
is to minimize the DC recommendation error while sat-
isfying the safety constraints of each group. Given the
ﬂexibility of recruiting patients from diﬀerent groups,
it is intuitive that uniform recruitment across groups,
which does not utilize the history information prior
to each decision time, may be ineﬃcient. For exam-
ple,
if a particular patient group has already accu-
mulated suﬃcient observations to determine the MTD
with high conﬁdence, recruiting more patients for this
group is not as beneﬁcial as for other groups. We re-
inforce this intuition by proposing SDF-Bayes-AR, a
modiﬁcation of SDF-Bayes in which patients are adap-
tively recruited. We will prove that SDF-Bayes-AR
utilizes the limited number of patients more eﬃciently,
by adaptively recruiting patients to obtain the best

information for each group while satisfying the safety
constraints.

Adaptive Patient Recruitment
In SDF-Bayes-
AR, we use the probability GO(t)
(u) in (4) to measure
the likelihood of MTD. We denote the probability in
round t that the DC a for group m is the MTD by

a

GO(t)

m,a (u) =

ZΘ

I[pm

a (θ) ∈ [ξm−u, ξm+u]]fm(θ|O(t))dθ,

where fm(θ|O(t)) is the posterior distribution of θ for
group m. The posterior distribution for each group
can be calculated as in (3) by using, for each DC a,
the number (nm
a (t)) of times a is used for group m be-
fore round t and the number (sm
a (t)) of DLTs observed
when a is used within group m before round t. The
improvement of the probability of the most probable
DC for group m in round t for an additional patient
with DC a′ and observed toxicity Y is given by

m,∗

I O,Y
m,a′ (u) =

G{O,(Y,m,a
(cid:12)
(cid:12)
m,∗ = maxa∈A GO
(cid:12)

where GO
improvement (EI)

′

)}

(u) − GO

,

m,∗(u)
(cid:12)
(cid:12)
(cid:12)

m,a. Deﬁne the expected

H O(t)

m,a′ (u) =

ZΘ

a′ (θ)I O(t),1
pm

m,a′ (u)

n
+ (1 − pm

a′ (θ)I O(t),0

m,a′ (u)

fm(θ|O(t))dθ

o

Denote the tentatively allocated DC of group m in
round t by am(t). Then, in SDF-Bayes-AR, we adap-
tively recruit a patient of group m∗ by using am(t)’s
as m∗(t) = argmaxm∈M H O(t)

m,am(t)(u).

′

′

)

Algorithm Description In round t, we apply SDF-
Bayes for each group m to ﬁnd the DC am(t) that
should be chosen for that group. Speciﬁcally, we use
lines 2–13 of Algorithm 1. We then approximate the EI
H O(t)
m,am(t)(u) for group m. To this end, we sample from
three diﬀerent posterior distributions, fm(θ|O(t)),
fm(θ|{O(t), (1, m, a′)}), and fm(θ|{O(t), (0, m, a′)}).
the samples by ˜Θm(t),
We denote the sets of
˜Θ(1,m,a
)
(t), and ˜Θ(0,m,a
respectively. We
(t),
m
m
the EI H O(t)
˜H O(t)
approximate
m,a′ (u) =
a′ (O(t)) ˜I O(t),1
˜pm
m,a′ (u) + (1 − ˜pm
(u), where
a (O(t)) = 1
θ∈ ˜Θm(t) pm
˜pm
the
L
group to be recruited is chosen to be g(t) =
m,am(t)(u), and the DC to be allocated
argmaxm∈M
to that group is a(t) = ag(t)(t). (Ties for g(t) or ag(t)
are broken arbitrarily.) We then observe the DLT Yt
from the recruited patient of group g(t) with the allo-
cated DC a(t) and construct the history O(t + 1). At
the end of the trial, the DC recommendation for each

m,a′ (u) by
a′(O(t))) ˜I O(t),0
m,a′

Finally,

˜H O(t)

a (θ).

P

SDF-Bayes: Cautious Optimism in Safe Dose-Finding Clinical Trials

group is given by ˆa∗
m,a (u). A more
m = argmaxa∈A
detailed description of SDF-Bayes-AR is provided in
the Supplementary Material.

˜GO(T )

5 EXPERIMENTS

Here we describe a variety of experiments using a
real-world dataset and several synthetic data sets.
Synthetic datasets are widely used in designing and
evaluating novel Phase I clinical trials in order to
thoroughly investigate the design before subjecting
human subjects to a potentially dangerous regime of
drugs. Moreover, because a Phase I trial never identi-
ﬁes toxicity probabilities exactly and never identiﬁes
the MTD with certainty, a real-world dataset is not
“completely realistic” either.

The real-world dataset RW we use is taken from
(Bailey et al., 2009), which reports the observations
during a real Phase I clinical trial for the combina-
tion of two oncology drugs, nilotinib and imatinib.
Bailey et al. (2009) constructs a dose-toxicity model
based on DLT observations and on prior information
about the drugs. The dose combinations consist of
400, 600, and 800 mg of nilotinib (drug A) and 0, 400,
600, and 800 mg of imatinib (drug B). (Further de-
tails are in the Supplementary Materials.) The syn-
thetic datasets A,B,C,D are constructed as variations
on RW. (Additional synthetic datasets and results are
presented in the Supplementary Materials.) Table 2
reports the true toxicities for the various doses in the
datasets A,B,C,D,RW; the true MTD’s are shown in
boldface.

comparison purposes, we

implemented ﬁve
For
dose-ﬁnding algorithms:
SDF-Bayes; DF-Bayes
(SDF-Bayes without caution, chosen to illustrate the
eﬀect of optimism without caution); SOTA Bayes
a state-of-the-art Bayesian
(Riviere et al., 2014),
dose-ﬁnding algorithm; IndepTS (Aziz et al., 2019), a
Thompson sampling-based multi-armed bandit (MAB)
clinical trial algorithm; and StructMAB, a structured
MAB-based clinical trial algorithm that exploits the
joint dose-toxicity model based on the structured ban-
dit method from (Gupta et al., 2019) while taking into
account the safety constraint, which is an advanced
version of the safe dose allocation method in Shen et al.
(2020) to drug combinations. In the algorithms that
exploit the joint dose-toxicity model (SDF-Bayes, DF-
Bayes, SOTA Bayes and StructMAB), we use the logis-
tic model in Riviere et al. (2014) for fair comparison.

5.1 Homogeneous Groups

For each of these datasets, we conducted 5,000 runs of
each algorithm, each with a pool of 60 patients, using
ξ = 0.30, ǫ = 0.05, δ = 0.05 (these values are typical of

actual Phase I trials). In any run, we counted a rec-
ommendation error if the recommended DC is not the
true MTD and a safety violation if the DLT observa-
tion rate exceeds the threshold ξ + ǫ. Table 3 reports,
for each algorithm and each dataset, the proportions of
runs in which there was a safety violation and runs in
which the recommended DC was an error, with 95%
conﬁdence intervals. Safety violations do not satisfy
the safety constraint (i.e., the proportion of runs in
which there was a safety violation is more than 0.05)
are shown in red; in the absence of those safety vio-
lations, the best error performance for each dataset is
shown in boldface. As can be seen, for every dataset,
SDF-Bayes satisﬁes the safety constraint while mak-
ing fewer recommendation errors than SOTA Bayes,
Indep TS, or StructMAB. Indeed, SOTA Bayes is the
only one of these algorithms that is at all competi-
tive with SDF-Bayes; Indep TS and StructMAB are
recommending the wrong MTD more than half the
time. DF-Bayes makes fewer recommendation errors
than SDF-Bayes for dataset B, in which no DC ex-
ceeds the threshold ξ, but makes wildly unacceptable
proportions of safety violations for all other datasets.

SDF-Bayes does best because cautious optimism al-
lows it to more eﬃciently explore the boundary be-
tween safe and unsafe DCs. In the Supplementary Ma-
terials, we document that SDF-Bayes is more often
testing DC’s that are believed to be close to being un-
safe, while other algorithms more often test DC’s that
are believed to be safe. Because the primary objective
of a Phase I trial is to ﬁnd the MTD while maintain-
ing acceptable patient safety, which is determined by
the trialist, SDF-Bayes is making the proper trade-oﬀ
between accurate prediction and safety of patients in
the trial.

5.2 Heterogeneous Groups

To evaluate SDF-Bayes for heterogeneous groups, we
use the groups A, B whose toxicities are given by
Synthetic A and Synthetic B, respectively, provided
in Table 2. Because we have two groups, we allow for
a total of 80 patients. For each simulated trial, we
compute both the safety violations for each group and
the overall safety violation for the whole trial. (Other
details are in the Supplementary Material.)

To evaluate the eﬀectiveness of adaptive recruitment
in SDF-Bayes-AR, we use as baselines the various
Bayesian algorithms with uniform recruitment (UR),
so that patients from each group are recruited with
equal probability, and SOTA Bayes-AR in which the
proposed adaptive patient recruitment is adopted to
SOTA Bayes. (We have already found that the MAB-
based algorithms are not competitive, so we do not use
them here.) We also apply the Bayesian algorithms to

Hyun-Suk Lee, Cong Shen, William Zame, Jang-Won Lee, Mihaela van der Schaar

Table 2: True toxicity probabilities in datasets A,B,C,D,RW

Synthetic A

Synthetic B

Synthetic C

Synthetic D

Real-World

1

2

3

4

1

2

3

4

1

2

3

4

1

2

3

4

1

2

3

4

3 0.15 0.30 0.45 0.50 0.09 0.12 0.15 0.30 0.08 0.15 0.45 0.60 0.30 0.42 0.52 0.62 0.13 0.21 0.30 0.43
2 0.10 0.15 0.30 0.45 0.05 0.10 0.13 0.15 0.05 0.12 0.30 0.55 0.10 0.20 0.30 0.40 0.08 0.13 0.20 0.30
1 0.05 0.10 0.15 0.30 0.02 0.08 0.10 0.11 0.02 0.10 0.15 0.50 0.05 0.12 0.20 0.30 0.04 0.07 0.11 0.17

Table 3: Safety Violations and Recommendation Errors for datasets A,B,C,D,RW

Synthetic A

Synthetic B

Synthetic C

Synthetic D

Real-World

Algorithms Safety Viol. Rec. Errors Safety Viol. Rec. Errors Safety Viol. RecErrors Safety Viol. Rec Errors Safety Viol. Rec Errors
SDF-Bayes 0.019±.004 0.205±.011 0.001±.001 0.193±.009 0.010±.002 0.443±.012 0.040±.005 0.344±.011 0.003±.001 0.368±.011
0.411±.014 0.237±.012 0.020±.003 0.123±.008 0.434±.012 0.643±.011 0.460±.012 0.317±.011 0.154±.008 0.341±.011
DF-Bayes
SOTA Bayes 0.023±.004 0.233±.012 0.000±.000 0.196±.009 0.013±.003 0.570±.012 0.041±.005 0.394±.011 0.002±.001 0.391±.011
StructMAB 0.018±.004 0.516±.014 0.000±.000 0.488±.012 0.011±.002 0.740±.010 0.060±.006 0.564±.012 0.002±.001 0.621±.011
0.013±.003 0.603±.014 0.000±.000 0.847±.008 0.006±.002 0.819±.009 0.072±.006 0.623±.011 0.000±.000 0.749±.010

IndepTS

the entire population, treated as a single group called
EP, whose true toxicity probabilities are just the av-
erages of the toxicity probabilities for the two groups
A and B. At the end of each trial, the algorithms
recommend a single DC for EP, which we evaluate as a
recommendation for each group separately. As before,
we use boldface to indicate the best performance
subject to satisfying the safety constraints.

Safety Violations and Recommendation Errors
Table 4 shows that SDF-Bayes-AR achieves the low-
est overall error rate among the algorithms that sat-
isfy the safety constraint, but that the improvement
of SDF-Bayes-AR over SDF-Bayes-UR is marginal. As
we will see below, this is because no prior information
is used; as we show, adaptive recruitment is more ef-
fective when prior information is available.

When we force the algorithms to treat EP as a homoge-
neous group, we see that the rate of safety violations in
group B is extremely low; as a result, the overall rate of
safety violations is also low (for SDF-Bayes and SOTA
Bayes, applied to EP) although the rate of safety vi-
olations for group A is extremely high. We also see
that, in this setting, the recommendation errors are all
very high. This is because according to the averages
of the toxicity probabilities for the two groups A and
B, the true MTDs for EP are (2,4) and (3,3), neither
of which is an MTD for either group A or group B.
This highlights the danger of treating heterogeneous
populations as if they were homogeneous.

Impact of Prior Information As we have noted,
useful prior information about one or both groups may
be available (Hobbs et al., 2011). To illustrate the im-
pact of prior information on the adaptive recruitment
in SDF-Bayes-AR and hence on the results, we assume
that the prior information comes from a previous
trial for group B; we parametrize the amount/quality

of prior information by controlling the number of
patients Tp in the previous trial. Table 5 records the
fraction of patients recruiting in group A, the safety
violation rates, and the recommendation error rates of
SDF-Bayes-AR and SDF-Bayes-UR for various sizes of
prior trials (and hence various amounts of prior infor-
mation). We can see that SDF-Bayes-AR adaptively
recruits the patients according to the amount of the
In SDF-Bayes-AR, patients from
prior information.
group B are seldom recruited after the most likely
MTD DC for group B is determined with high probabil-
ity. (See the Supplementary Material for more detail.)
Because patients from group A are recruited more fre-
quently, more is learned about group A and the error
rate for group substantially reduced; the cost is only a
marginal increase in the error rate for group B. As a re-
sult, the overall error rate is improved as expected. Be-
cause adaptive recruitment reduces the number of pa-
tients recruited from group B, it also reduces the possi-
bility of balancing the risk of group B and increases the
rate of safety violations in group B – although fewer
group B patients are exposed to DCs that are found
to be unsafe. Overall, SDF-Bayes-AR outperforms
SDF-Bayes-UR in both accuracy and safety: it makes
fewer total errors with fewer total safety violations.

6 RELATED WORK

for

clinical

trials
Bayesian methodology
Bayesian methodology has been widely used for clini-
cal trials, ﬁrst to label the eﬀectiveness of treatments
(Atan et al., 2019; Berry, 2006).
It has also been
used in dose-ﬁnding clinical trials (Wages et al., 2015;
O’Quigley et al., 1990) and for drug combination
trials (Riviere et al., 2014; Yin and Yuan, 2009a,b;
Yan et al., 2017), which are about online learning for
dose-ﬁnding clinical trials.
In the latter setting it
is typically used in conjunction with a dose-toxicity

SDF-Bayes: Cautious Optimism in Safe Dose-Finding Clinical Trials

Table 4: Safety Violations and Recommendation Errors

Algorithm

Safety Violation Rate

Recommendation Error Rate

Average

Entire trial Group A

Group B
SDF-Bayes-AR 0.000±.000 0.049±.006 0.002±.001 0.283±.012 0.287±.013 0.279±.012
0.288±.013 0.287±.013 0.288±.013
SDF-Bayes-UR 0.000±.000 0.028±.005 0.001±.001
0.188±.011
0.325±.013
0.257±.012
DF-Bayes-UR 0.095±.008 0.452±.014 0.025±.004
0.287±.011
0.301±.011
0.294±.011
SOTA Bayes-AR 0.000±.000 0.064±.006 0.000±.000
0.283±.012
0.314±.013
0.298±.013
SOTA Bayes-UR 0.000±.000 0.036±.005 0.000±.000
0.906±.008
0.706±.008
0.806±.011
SDF-Bayes-EP 0.004±.002 0.734±.012 0.000±.000
0.830±.010
0.807±.011
0.819±.011
0.139±.010 0.842±.010 0.007±.002
DF-Bayes-EP
0.908±.008
0.692±.013
0.800±.011
SOTA Bayes-EP 0.003±.002 0.493±.014 0.000±.000

Group A

Group B

Table 5: Impact of Prior Information (A: Group A, B: Group B, E: Entire trial)

Fraction Recruited from Group
Tp = 60
Tp = 40
Tp = 20

Safety Violation Rates
Tp = 40

Tp = 20

Tp = 60

Recommendation Errors
Tp = 40

Tp = 60

Tp = 20

AR

UR

-

A 0.517±.001 0.599±.003 0.719±.004 0.027±.004 0.014±.003 0.014±.003 0.286±.013 0.281±.012 0.258±.012
B 0.483±.001 0.401±.003 0.281±.004 0.047±.006 0.105±.009 0.207±.011 0.233±.012 0.170±.010 0.131±.009
0.001±.001 0.002±.001 0.001±.001 0.259±.012 0.226±.012 0.195±.011
E
A 0.500±.000 0.500±.000 0.500±.000 0.031±.005 0.031±.005 0.031±.005 0.303±.013 0.303±.013 0.303±.013
B 0.500±.000 0.500±.000 0.500±.000 0.021±.004 0.039±.005 0.055±.006 0.234±.012 0.162±.010 0.127±.009
0.006±.002 0.011±.003 0.017±.004 0.268±.012 0.232±.012 0.215±.011
E

-

-

-

-

-

Table 6: Comparison of adaptive clinical trial Phase I methodologies

Reference

Principle No. of DCs Toxicity
Model

MAB

less than 10

No

Safety

No

Villar et al. (2015); Garivier et al. (2017);
Villar and Rosenberger (2018)
Varatharajah et al. (2018)
Aboutalebi et al. (2019)
Aziz et al. (2019)
Shen et al. (2020)
Lee et al. (2020)
Yan et al. (2017)
Wages et al. (2015)

less than 10
less than 10
less than 10
less than 10
less than 10
less than 10
less than 10
Yin and Yuan (2009a); Riviere et al. (2014) Bayesian more than 10

MAB
MAB
MAB
MAB
MAB
Bayesian
Bayesian

No
No
Fixed
Fixed
Fixed
No
Fixed
Fixed

No
Implicitly considered
Implicitly considered
δ-safety guaranteed
δ-safety guaranteed
Dose-escalation
Dose-escalation
Dose-escalation

This work (SDF-Bayes)

Bayesian more than 10 Arbitrary δ-safety guaranteed

Heterogeneous
Groups

No

Yes
No
No
No
Yes
No
Yes
No
Yes

model because it can signiﬁcantly reduce the size
of the search space (Shen et al., 2019). By using
the posterior distribution of the parameters of the
dose-toxicity model, traditional Bayesian DC-ﬁnding
algorithms are proposed to ﬁnd the MTD based on
dose escalation and de-escalation from the lowest dose
levels for safety (Riviere et al., 2014; Yin and Yuan,
2009a; Yan et al., 2017).

mality is not meaningful for a practical number (fewer
than 100) of patients in Phase I trials. In MAB models,
various safety management methods have been studied
to address safety issue. However, they deal with the
safety issue only implicitly or cannot be applied to the
drug combination setting because they rely on a very
limited dose-toxicity model with a single drug.

MAB for clinical trials MABs have also been
widely proposed for dose-ﬁnding clinical trials, es-
pecially for trials with a single drug (Aziz et al.,
2019; Shen et al., 2020; Varatharajah et al., 2018;
Villar and Rosenberger, 2018; Lee et al., 2020). Nev-
ertheless, they do not address the challenging issues of
Phase I clinical trials for multiple drugs, which operate
in the small sample size regime relative to the number
of potential doses. In trials for drug combination with
more than ten potential DCs, their asymptotic opti-

Methods for heterogeneous groups For both
Bayesian and MAB methods, there has been only
limited work involving heterogeneous groups.
In
Wages et al. (2015), a well-known Bayesian contin-
ual reassessment method (CRM) is extended for an
adaptive clinical trial design for heterogeneous groups.
However, it does not consider drug combinations and
a patient recruitment with a limited number of pa-
tients.
In Atan et al. (2019), a patient recruitment
with a limited number of patients is adaptively deter-
mined based on a Bayesian knowledge gradient policy,

Hyun-Suk Lee, Cong Shen, William Zame, Jang-Won Lee, Mihaela van der Schaar

but its goal is to label the eﬀectiveness of drugs as
opposed to dose-ﬁnding.
(Varatharajah et al., 2018;
Lee et al., 2020) adapt a contextual MAB for clinical
trials with heterogeneous groups by treating groups as
contexts. However, this work does not consider either
drug combinations or patient recruitment with a lim-
ited number of patients.

Table 6 provides a summary comparison of our work
with other methodologies.

7 CONCLUSION

In this paper, we have studied the problem of design-
ing Phase I clinical trials for drug combinations. We
have enunciated a principle of cautious optimism and
proposed the SDF-Bayes algorithm that applies that
principle to eﬀectively balance the trade-oﬀ between
the exploration of drug combinations and the risk of
safety violation. For settings with identiﬁed heteroge-
neous groups, we proposed an extension SDF-Bayes-
AR in which both the DC to be allocated and the
group from which the next patient is to be recruited
are chosen adaptively. On the basis of experiments,
we demonstrated that our proposed algorithms outper-
form previous state-of-the-art algorithms.

References

Aboutalebi, H., Precup, D., and Schuster, T. (2019).
Learning modular safe policies in the bandit setting
with application to adaptive clinical trials. arXiv
preprint arXiv:1903.01026.

Atan, O., Zame, W. R., and Schaar, M. (2019). Se-
quential patient recruitment and allocation for adap-
tive clinical trials.
In Proceedings of the 22nd In-
ternational Conference on Artiﬁcial Intelligence and
Statistics (AISTATS).

Aziz, M., Kaufmann, E., and Riviere, M.-K. (2019).
On multi-armed bandit designs for dose-ﬁnding clin-
ical trials. arXiv preprint arXiv:1903.07082.

Bagatell, R., Norris, R., Ingle, A. M., Ahern, C., Voss,
S., Fox, E., Little, A. R., Weigel, B. J., Adamson,
P. C., and Blaney, S. (2014). Phase 1 trial of tem-
sirolimus in combination with irinotecan and temo-
zolomide in children, adolescents and young adults
with relapsed or refractory solid tumors: a children’s
oncology group study. Pediatric blood & cancer,
61(5):833–839.

Bailey, S., Neuenschwander, B., Laird, G., and Bran-
son, M. (2009). A bayesian case study in oncology
phase I combination dose-ﬁnding using logistic re-
gression with covariates. Journal of biopharmaceu-
tical statistics, 19(3):469–484.

Bamias, A., Aravantinos, G., Kastriotis, I., Alivizatos,
G., Anastasiou, I., Christodoulou, C., Gyftaki, R.,
Kalofonos, H. P., and Dimopoulos, M. A. (2011).
Report of the long-term eﬃcacy of two cycles of
adjuvant bleomycin/etoposide/cisplatin in patients
with stage I testicular nonseminomatous germ-cell
tumors (NSGCT): a risk adapted protocol of the
Hellenic Cooperative Oncology Group. Urologic
Oncology: Seminars and Original Investigations,
29(2):189–193.

Berry, D. A. (2006). Bayesian clinical trials. Nature

reviews Drug discovery, 5(1):27.

Bubeck, S. and Cesa-Bianchi, N. (2012). Regret analy-
sis of stochastic and nonstochastic multi-armed ban-
dit problems. Foundations and Trends in Machine
Learning, 5(1):1–122.

Calvo, E., Soria, J.-C., Ma, W. W., Wang, T., Bahleda,
R., Tolcher, A. W., Gernhardt, D., O’Connell, J.,
Millham, R., Giri, N., et al. (2017). A phase I clini-
cal trial and independent patient-derived xenograft
study of combined targeted treatment with dacomi-
tinib and ﬁgitumumab in advanced solid tumors.
Clinical Cancer Research, 23(5):1177–1185.

Dasari, A., Gore, L., Messersmith, W., Diab, S., Ji-
meno, A., Weekes, C., Lewis, K., Drabkin, H., Flaig,
T., and Camidge, D. (2013). A phase I study of
sorafenib and vorinostat in patients with advanced
solid tumors with expanded cohorts in renal cell car-
Investiga-
cinoma and non-small cell lung cancer.
tional new drugs, 31(1):115–125.

Flaherty, K. T., Infante, J. R., Daud, A., Gonzalez, R.,
Keﬀord, R. F., Sosman, J., Hamid, O., Schuchter,
L., Cebon, J., Ibrahim, N., et al. (2012). Com-
bined BRAF and MEK inhibition in melanoma with
BRAF V600 mutations. New England Journal of
Medicine, 367(18):1694–1703.

Garivier, A., M´enard, P., Rossi, L., and Menard,
P. (2017). Thresholding bandit for dose-ranging:
The impact of monotonicity.
arXiv preprint
arXiv:1711.04454.

Gasparini, M. (2013). General classes of multiple bi-
nary regression models in dose ﬁnding problems for
combination therapies. Journal of the Royal Statisti-
cal Society: Series C (Applied Statistics), 62(1):115–
133.

Gilks, W. R., Best, N. G., and Tan, K. (1995). Adap-
tive rejection metropolis sampling within Gibbs sam-
pling. Journal of the Royal Statistical Society: Se-
ries C (Applied Statistics), 44(4):455–472.

Gupta, S., Chaudhari, S., Mukherjee, S., Joshi, G.,
and Ya˘gan, O. (2019). A uniﬁed approach to trans-
late classical bandit algorithms to the structured
bandit setting. arXiv preprint arXiv:1810.08164.

SDF-Bayes: Cautious Optimism in Safe Dose-Finding Clinical Trials

Hamberg, P., Ratain, M. J., Lesaﬀre, E., and Verweij,
J. (2010). Dose-escalation models for combination
phase I trials in oncology. European Journal of Can-
cer, 46(16):2870–2878.

Hobbs, B. P., Carlin, B. P., Mandrekar, S. J., and
Sargent, D. J. (2011). Hierarchical commensurate
and power prior models for adaptive incorporation
of historical information in clinical trials. Biomet-
rics, 67(3):1047–1056.

Kelly, W. K. and Halabi, S. (2018). Oncology clini-
cal trials: successful design, conduct, and analysis.
Springer Publishing Company.

Kim, T., Sym, S., Lee, S., Ryu, M., Lee, J., Chang,
H., Kim, H., Shin, J., Kang, Y., and Lee, J.
(2009). A UGT1A1 genotype-directed phase I study
of irinotecan (CPT-11) combined with ﬁxed dose
of capecitabine in patients with metastatic colorec-
tal cancer (mCRC). Journal of Clinical Oncology,
27(15 suppl):2554–2554.

Lee, H.-S., Shen, C., Jordon, J., and van der Schaar,
M. (2020). Contextual constrained learning for dose-
ﬁnding clinical trials. In Proceedings of the 23rd In-
ternational Conference on Artiﬁcial Intelligence and
Statistics (AISTATS).

Moss, R. B., Flume, P. A., Elborn, J. S., Cooke, J.,
Rowe, S. M., McColley, S. A., Rubenstein, R. C.,
and Higgins, M. (2015). Eﬃcacy and safety of iva-
caftor treatment: randomized trial in subjects with
cystic ﬁbrosis who have an R117H-CFTR mutation.
The Lancet. Respiratory medicine, 3(7):524.

Ocana, A., Gil-Martin, M., Antol´ın, S., Atienza,
M., Monta˜no, ´A., Ribelles, N., Urruticoechea,
A., Falc´on, A., Pernas, S., Orlando, J., et al.
Eﬃcacy and safety of dasatinib with
(2019).
trastuzumab and paclitaxel
in ﬁrst line HER2-
positive metastatic breast cancer: results from the
phase II GEICAM/2010-04 study. Breast cancer re-
search and treatment, 174(3):693–701.

O’Quigley, J., Pepe, M., and Fisher, L. (1990). Con-
tinual reassessment method: a practical design for
phase 1 clinical trials in cancer. Biometrics, pages
33–48.

Paller, C. J., Huang, E., Luechtefeld, T., Masset, H.,
Williams, C., Zhao, J., Gravell, A., Tamashiro, T.,
Reeves, S., Rosner, G., et al. (2019). Factors af-
fecting combination trial success (FACTS): Investi-
gator survey results on early-phase combination tri-
als. Frontiers in Medicine, 6:122.

Pallmann, P., Bedding, A. W., Choodari-Oskooei, B.,
Dimairo, M., Flight, L., Hampson, L. V., Holmes,
J., Mander, A. P., Sydes, M. R., Villar, S. S., et al.
(2018). Adaptive designs in clinical trials: why use

them, and how to run and report them. BMC
medicine, 16(1):29.

Park, J. J., Thorlund, K., and Mills, E. J. (2018). Crit-
ical concepts in adaptive clinical trials. Clinical epi-
demiology, 10:343.

Plummer, R., Jones, C., Middleton, M., Wilson,
R., Evans, J., Olsen, A., Curtin, N., Boddy, A.,
McHugh, P., Newell, D., et al. (2008). Phase
I study of the poly (ADP-ribose) polymerase in-
hibitor, AG014699, in combination with temozolo-
mide in patients with advanced solid tumors. Clini-
cal cancer research, 14(23):7917–7923.

Riviere, M.-K., Yuan, Y., Dubois, F., and Zohar, S.
(2014). A bayesian dose-ﬁnding design for drug com-
bination clinical trials based on the logistic model.
Pharmaceutical statistics, 13(4):247–257.

Shen, C., Wang, Z., Villar, S., and van der Schaar,
M. (2020). Learning for dose allocation in adaptive
clinical trials with safety constraints.
In Proceed-
ings of International Conference on Machine Learn-
ing (ICML).

Shen, Y., Liu, T., Chen, J., Li, X., Liu, L., Shen,
J., Wang, J., Zhang, R., Sun, M., Wang, Z., et al.
(2019). Harnessing artiﬁcial intelligence to optimize
long-term maintenance dosing for antiretroviral-
naive adults with HIV-1 infection. Advanced Thera-
peutics, page 1900114.

Sun, Z. and Braun, T. M. (2015). A two-dimensional
biased coin design for dual-agent dose-ﬁnding trials.
Clinical Trials, 12(6):596–607.

Thall, P. F., Millikan, R. E., Mueller, P., and Lee, S.-
J. (2003). Dose-ﬁnding with two agents in phase I
oncology trials. Biometrics, 59(3):487–496.

Varatharajah, Y., Berry, B., Koyejo, S., and Iyer,
R. (2018). A contextual-bandit-based approach for
informed decision-making in clinical trials. arXiv
preprint arXiv:1809.00258.

Villar, S. S., Bowden, J., and Wason, J. (2015). Multi-
armed bandit models for the optimal design of clin-
ical trials: beneﬁts and challenges. Statistical sci-
ence: a review journal of the Institute of Mathemat-
ical Statistics, 30(2):199.

Villar, S. S. and Rosenberger, W. F. (2018). Covariate-
adjusted response-adaptive randomization for multi-
arm clinical trials using a modiﬁed forward looking
Gittins index rule. Biometrics, 74(1):49–57.

Wages, N. A., Read, P. W., and Petroni, G. R.
(2015). A phase I/II adaptive design for heteroge-
neous groups with application to a stereotactic body
radiation therapy trial. Pharmaceutical statistics,
14(4):302–310.

Hyun-Suk Lee, Cong Shen, William Zame, Jang-Won Lee, Mihaela van der Schaar

Wu, M., Sirota, M., Butte, A. J., and Chen, B. (2014).
Characteristics of drug combination therapy in on-
cology by analyzing clinical trial data on Clinical-
Trials. gov. In Paciﬁc Symposium on Biocomputing
Co-Chairs, pages 68–79. World Scientiﬁc.

Yan, F., Mandrekar, S. J., and Yuan, Y. (2017). Key-
board: a novel bayesian toxicity probability interval
design for phase I clinical trials. Clinical Cancer
Research, 23(15):3994–4003.

Yin, G. and Yuan, Y. (2009a). Bayesian dose ﬁnding in
oncology for drug combinations by copula regression.
Journal of the Royal Statistical Society: Series C
(Applied Statistics), 58(2):211–224.

Yin, G. and Yuan, Y. (2009b). A latent contingency
table approach to dose ﬁnding for combinations of
two agents. Biometrics, 65(3):866–875.

Supplementary Material for SDF-Bayes: Cautious Optimism in Safe
Dose-Finding Clinical Trials with Drug Combinations and
Heterogeneous Patient Groups

A Joint Dose-Toxicity Models for Drug Combinations

To reduce the search space in dose-ﬁnding for drug combinations, various joint dose-toxicity models have been
proposed. They help us to eﬃciently investigate the toxicities of combinations of drugs. We denote the vector of
the parameters of joint-toxicity model as θ = {α, β, γ}, where α is a vector of the parameters that represents the
relation between the toxicity eﬀect and the dosage of drug A, β is a vector of the parameters that represents the
relation between the toxicity eﬀect and the dosage of drug B, and γ is a vector of the parameters that represents
the relation between the toxicity eﬀect and both dosages (i.e., drug-drug interaction). The type of functions
suitable for a joint dose-toxicity model is deﬁned as the following admissibility conditions (Gasparini, 2013):

1. π(j, k, θ) is increasing separately in both j and k

2. There are functions π1(j, α) and π2(k, β), which are called marginal dose-toxicity model such that π(j, 0, θ) =

π1(j, α) and π(0, k, θ) = π2(k, β)

3. π1(0, α) = π2(0, β) = 0

In joint dose-toxicity models, the drug-drug interaction such as
synergy and antagonism shown in Fig. 1 should be captured.
To this end, various joint dose-toxicity models have been pro-
posed in the literature as in Table 7. In some models, the joint
dose-toxicity model is deﬁned by using the marginal model (i.e.,
π1(j, α) and π2(k, β)).
In this case, any dose-toxicity model
for a single drug such as two-parameter logistic model can be
used. In the logistic model, the standardized dosage levels are
used (i.e., dj and uk do not indicate actual dosage levels). Thus,
there is a parameter ζ that is not related to any drugs to ensure
the appropriate toxicity modeling (Riviere et al., 2014). All the
models except for the no interaction model can capture the drug-drug interaction and the parameter γ implies
the characteristics of the interaction. For the detailed description and discussion on drug-drug interactions, we
refer the readers to (Gasparini, 2013).

Figure 1: Examples of drug-drug interac-
tions.

(b) Antagonistic.

(a) Synergistic.

Drug B

Drug B

Drug A

Drug A

y
t
i
c
x
o
T

y
t
i
c
x
o
T

i

i

Table 7: Summary of joint dose-toxicity models

Model

No interaction

Constant log-odds diﬀerence

Copula-based (Yin and Yuan, 2009a)

Thall (Thall et al., 2003)

π(j, k, θ)

1 − {1 − π1(j, α)}{1 − π2(k, β)}

1
1+γ−1[{π1(j,α)+π2(k,β)−π1(j,α)π2(k,β)}−1−1]
1 − C{1 − π1(j, α), 1 − π2(k, β), γ}

α1d

α2
j +β1u

β2
k +γα1d

1+α1d

α2
j +β1u

β2
k +γα1d

α2
β2
j β1u
k
α2
j β1u

β2
k

Exponential

1 − exp{−(αdj + βuk + αβγdjuk)}

Logistic (Riviere et al., 2014)

1
1−exp(−ζ−αdj −βuk−γdj uk)

Hyun-Suk Lee, Cong Shen, William Zame, Jang-Won Lee, Mihaela van der Schaar

B Proof of Proposition 1

From the deﬁnition of F O

a (v), in round t, we have

P

pa(θ) ≤ F O(t)

a

(v)

O(t)

= v.

h

t
τ =1

pa(τ )(θ) ≤ Fa(τ )(θ)O(t)(v)

(cid:12)
(cid:12)
(cid:12)

i
O(t)

is

a

subset

of

the

event

clearly. Then, with v = (1 − δ)1/t, we have

(cid:12)
(cid:12)

(cid:9)

that
Note
the
t
τ =1 pa(τ )(θ) ≤

event
τ =1 F O(t)

a

t

(v)
T

O(t)
(cid:8)

n P

P

"

t

P
pa(τ )(θ) ≤

t

τ =1
X

τ =1
X

(cid:12)
o
(cid:12)
(cid:12)
F O(t)
a(τ ) (v)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

≥

O(t)

#

t

P

τ =1
Y

h

From the proposition, the residual is non-negative, which implies that (ξ + ǫs)t ≥

pa(τ )(θ) ≤ F O(t)

O(t)

= vt = 1 − δ.

i
τ =1 F O(t)
t

a

(v). We then have

t

P

"

τ =1
X

pa(τ )(θ) ≤ (ξ + ǫs)t

≥ P

O(t)

#

t

"

τ =1
X

pa(τ )(θ) ≤

t

τ =1
X

P
O(t)

#

≥ 1 − δ.

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

C StructMAB: Safe DC-Finding Bandits Based on Dose-Toxicity Structure

a(τ ) (v)
(cid:12)
(cid:12)
(cid:12)

F O(t)
a(τ ) (v)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

C.1 DC-Finding Bandits Based on Structured Bandits

In our manuscript, we propose a DC-ﬁnding algorithm which allows the agent to eﬀectively ﬁnd the best rec-
ommendation for the MTD. To this end, our algorithm exploits a dose-toxicity structure for the drugs from
the joint dose-toxicity model. Moreover, it is able to exploit arbitrary joint dose-toxicity models to ensure its
practical use. Since the conventional MAB-based dose-ﬁnding clinical trial algorithm in Aziz et al. (2019) does
not consider the dose-toxicity structure for drug combinations, we develop an advanced MAB-based algorithm
by using structured bandits (Gupta et al., 2019).

We ﬁrst deﬁne a conﬁdence set for the parameters as

ˆΘ(t) :=

(

θ : ∀a ∈ C, |¯pa(t) − pa(θ)| <

α log t
2na(t) )

,

s

(7)

where ¯pa(t) is the empirical toxicity of DC a in round t and na(t) is the number of observed samples for DC a
until round t. Since there is no assumption on the parameters θ, this conﬁdence set can be obtained for arbitrary
joint dose-toxicity models. Then, by using the conﬁdence set, we deﬁne a set of candidate MTDs as

A(t) :=

a ∈ C : argmin

a′∈C

|pa′ (θ) − ξ| for some θ ∈ ˆΘ(t)

.

(8)

(cid:27)

(cid:26)

For the candidate MTDs, we choose the DC by using Thompson sampling. To this end, we assume that the
expected toxicity of the DCs, pa’s, are random variables. The posterior probability of the expected toxicity of
DC a in round t is updated as Beta(sa(t) + 1, na(t) − sa(t) + 1). Then, Thompson sampling is conducted on the
set of candidate MTDs as

Based on the samples, the DC whose the sample is closest to the threshold is chosen as

˜pa(t) ∼ Beta(sa(t) + 1, na(t) − sa(t) + 1), ∀a ∈ A(t).

a(t) = argmin
a∈A(t)

|˜pa(t) − ξ|.

(9)

(10)

At the end of the algorithm, the agent chooses the dose whose empirical toxicity is closest to ξ as the MTD

ˆa∗(T ) = argmin

a∈C

|¯pa(T ) − ξ|

(11)

or pick ˆa∗ uniformly at random among the allocated doses.

SDF-Bayes: Cautious Optimism in Safe Dose-Finding Clinical Trials

a(t) ← ¯a

Algorithm 2 StructMAB
1: while t ≤ T do
2:
3:
4:
5:
6:
7:
8:
9:
10:
11:
12:
13:
14:
15:
16: end while

else

Obtain a conﬁdence set ˆΘ(t) as in (7)
Obtain a set of candidate MTDs A(t) as in (8)
Sample the expected toxicities for all candidate MTDs as in (9)
¯a ← argmina∈A(t) |˜pa(t) − ξ|
if r(t) − maxθ∈ ˆΘ(t) p¯a ≥ 0 then

Obtain a set of conservative DCs Ac(t) as in (12)
Sample the expected toxicities for all conservative DCs
a(t) ← argmina∈Ac(t) |˜pa(t) − ξ|

end if
Observe the DLT Yt
Update ma(t)(t + 1) and na(t)(t + 1)
t ← t + 1

C.2 Safe DC-Finding Bandits

In clinical trials, it is important to avoid testing the unsafe DCs due to the ethical issues. This can be achieved
by considering the safety constraint in (1). Here, we propose a safe DC-ﬁnding approach that satisﬁes the safety
constraint as in the cautiousness of SDF-Bayes.

For the safe DC-ﬁnding approach, we ﬁrst deﬁne a set of conservative DCs as

Ac(t) :=

a ∈ C : max
θ∈ ˆΘ(t)

(

pa(θ) ≤ ξ

.

)

(12)

The DCs in the set of conservative DCs are safe (i.e., toxicity probability does not exceed the MTD threshold)
with a high probability. Thus, by choosing the DCs in the set only, we can avoid the trials with unsafe doses
with a high probability. However, this is too conservative and we cannot expect a good MTD recommendation.

To resolve this issue, we consider a residual for the safety constraint in each round. The residual for the safety
constraint in round t is deﬁned as

r(t) = (ξ + ǫs)t −

t−1

τ =1
X

max
θ∈ ˆΘ(t)

pa(τ )(θ).

Note that the conﬁdence set for the parameters in round t, ˆΘ(t), is used for the calculation of the sum of the
expected toxicities until round t. By using the residual, we can infer whether the safety constraint will be violated
or not based on the current conﬁdence set for the parameters. If we still have the non-negative residual with the
chosen DC in (10) (i.e., r(t)− maxθ∈ ˆΘ(t) pa(t)(θ) ≥ 0), then we can expect the safety constraint not to be violated
with the chosen DC. Thus, in that case, the safe DC-ﬁnding approach accepts the chosen DC, and otherwise, it
rejects the chosen DC and chooses the DC in the conservative set Ac(t) instead to ensure the positive residual.
We summarize the safe DC-ﬁnding algorithm (StructMAB) in Algorithm 2.

C.3 Sampling-Based Implementation of StructMAB

To use StructMAB in practice, we need to identify the conﬁdence set ˆΘ and the set of candidate MTDs A based
on the conﬁdence set, which requires a high computational complexity in general. Besides, we need diﬀerent
identiﬁcation methods for diﬀerent joint dose-toxicity model used in the algorithm. Thus, to resolve these issues,
we propose a simple sampling method for StructMAB that can eﬃciently approximate the conﬁdence set and
set of candidate MTDs regardless of which joint dose-toxicity model is used.

Here, we sample θ from the posterior distribution of θ, f (θ|O), by using Gibbs sampling which is one of most
representative Bayesian sampling algorithms for multidimensional sampling as in SDF-Bayes. The posterior
distribution of θ can be found in Section 3.1. of our manuscript. Details of the Gibbs sampling procedure can

Hyun-Suk Lee, Cong Shen, William Zame, Jang-Won Lee, Mihaela van der Schaar

be found in the following section. We denote the number of samples from the posterior distribution p(θ|O(t))
by L and the samples by ˜Θ(t) = {θ(l)}l∈[L]. Then, from the samples, we can deﬁne an approximated conﬁdence
set for the parameters as

ˆΘ′(t) :=

(

θ(l) ∈ ˜Θ(t) : ∀a ∈ C, |¯pa(t) − pa(θ(l))| <

α log t
2na(t) )

s

and an approximated set of candidate MTDs as

A′(t) :=

a ∈ C : argmin

a′∈C

|pa′(θ(l)) − ξ| for some θ(l) ∈ ˆΘ′(t)

.

(13)

(cid:27)

(cid:26)

Similarly, we can deﬁne an approximated conservative DCs as

A′

c(t) :=

a ∈ C : pa′(θ(l)) ≤ ξ, ∀θ(l) ∈ ˆΘ′(t)

.

We can use these approximated sets for StructMAB. Note that these approximations converges to the true sets
as the number of samples goes to inﬁnity. Moreover, for the residual, we use maxθ(l)∈ ˜Θ(t) pa(t)(θ(l)).

n

o

D Description of Sampling Procedure

We describe the sampling procedure used in SDF-Bayes.

• Gibbs sampling: Gibbs sampling is one of the most representative Markov chain Monte Carlo (MCMC)
sampling methods to generate a sequence of samples for multiple variables from a multivariate joint prob-
ability distribution. In SDF-Bayes, it is used to generate a sequence of samples of the parameter vector
θ = {θ0, θ1, ..., θDθ −1} from f (θ|O), where Dθ is the dimension of the parameter vector. Note that the
dimension of the parameter vector depends on which joint toxicity model is used for SDF-Bayes. In Gibbs
sampling, we start from an arbitrary initial sample θ in the distribution. We then samples each component
of the parameter vector in turn based on each of the full conditional distribution with updated parameter
samples. In Gibbs sampling, we discard Lb samples at the beginning which is so-called burn-in period, and
then, retain the following L samples. We formally summarize Gibbs sampling as following Algorithm 3.

Algorithm 3 Gibbs sampling
1: Initialize θ(0)
2: for l = 1 to Lb + L do
3:

for d = 0 to Dθ − 1 do

4:

Sample θ(l)
d

end for

5:
6: end for

from its full conditional distribution f

θd

(cid:16)

d−1, θ(l−1)

d+1 , ..., θ(l−1)

Dθ −1, O

θ(l)
0 , ..., θ(l)
(cid:12)
(cid:12)
(cid:12)

(cid:17)

• Adaptive rejection metropolis sampling: Gibbs sampling relies on the complete full conditional distri-
butions of all components. However, in general, we cannot access to closed forms of such distributions. Thus,
in SDF-Bayes, we use adaptive rejection metropolis sampling (ARMS) within Gibbs sampling (Gilks et al.,
1995). ARMS is a MCMC sampling method as well, and it used to sample from a univariate target distri-
bution speciﬁed by (unnormalized) log density.

Thus, we utilize ARMS to sample each component of the parameter vector from its univariate full conditional
distribution (i.e., for line 4 of Algorithm 3). We assume that the prior distributions of the parameters are
independent. We denote the parameter vector except for d-th component by θ−d. Then, we can obtain the
unnormalized density of the full conditional distribution of d-th parameter, f (θd|θ′
−d, O), from the likelihood
of θ and the prior distribution as

f (θd|θ′

−d, O) ∝ L(θd, θ′

−d|O)f (θd)

f (θ′

d′).

d′∈{1,...,d−1,d+1,...Dθ}
Y

By using this density, we can sample each component of the parameters within Gibbs sampling. For the
detail procedure of ARMS, we refer to (Gilks et al., 1995).

SDF-Bayes: Cautious Optimism in Safe Dose-Finding Clinical Trials

E Description of SDF-Bayes-AR

Algorithm 4 SDF-Bayes-AR
1: while t ≤ T do
2:

Obtain am(t)’s by SDF-Bayes (lines 2–13)
˜H O(t)
g(t) ← argmaxm∈M
a(t) ← ag(t)(t)
Observe DLT Yt
Update sg(t)
t ← t + 1

a(t)(t + 1) and ng(t)

m,am(t)(u)

a(t)(t + 1)

3:

4:
5:
6:
7:
8: end while
9: Output: ˆa∗

m = argmaxa∈A

˜GO(T )

m,a (u), ∀m ∈M

F Description of Detailed Experiment Settings

F.1 Real-World Dataset

We describe the real-world dataset used in the experiments. We consider a Phase I drug combination clinical
trial dataset and its corresponding dose-toxicity model provided in Bailey et al. (2009). In the dataset, the drug
combination of nilotinib and imatinib is considered and the DLT observations from 50 patients are provided to
assess the toxicity of diﬀerent dose combinations. Furthermore, in Bailey et al. (2009), the dose-toxicity model
of the combination is constructed in a Bayesian way based on a logistic regression model by using the DLT
observations and the prior information about the drugs. In speciﬁc, the model is given by

logit(d, X1, X2, X3) = log(α) + β log(d/d∗) + ξ1X1 + ξ2X2 + ξ3X3,

where α, β, ξn’s are dose-toxicity model parameters, d represents the doses of nilotinib and d∗ is the reference dose
of nilotinib (400mg) for scaling. Also, (X1, X2, X3) represents the dose of imatinib by taking the form (0, 0, 0),
(1, 0, 0), (1, 1, 0), and (1, 1, 1) for imatinib doses 0, 400, 600, and 800mg, respectively. The prior distributions
of the parameters are tuned by using the historical data such as previous clinical data of each drug without
combinations. We rounded up the toxicities at the third decimal place. This trial is originally designed to ﬁnd
the DCs whose toxicities belong to the target interval (0.20, 0.35). This implies that the potential DCs of the
trial are more conservative in terms of safety (toxicity) compared with typical synthetic datasets designed to ﬁnd
the DC whose toxicity is close to the target toxicity 0.3 because it should ﬁnd the DCs whose toxicities is lower
than 0.3 in average.

F.2 Description of Algorithms in Experiments

Here, we describe the algorithms used in the experiments. We set u = 0.1 for all the Bayesian algorithms.

• SDF-Bayes: We implement SDF-Bayes based on Algorithm 1 in our manuscript. Here, we provide the
settings of SDF-Bayes in the experiments. We set v = 0.9 unless mentioned. For warm-start of SDF-Bayes,
, where R
the residual at the early stage of trials can be given by r(t) = max
is a constant. Typically, ξT works well for the cases with a single group. For the joint dose-toxicity model,
P
we use the following logistic dose-toxicity model proposed in Riviere et al. (2014):

˜F O(t)
a(τ ) (v), R

(ξ + ǫs)t −

t−1
τ =1

(cid:16)

(cid:17)

logit(πjk) = θ0 + θ1uj + θ2vk + θ3ujvk,

where θ0, θ1, θ2, and θ3 are parameters and uj and vk are the standardized dose of drugs. In the literature
, where pj and qk
(Riviere et al., 2014), uj’s and vk’s are deﬁned as uj = log
are the prior estimates of the toxicity probabilities of the j-th dosage of drug A and k-th dosage of drug B.
However, such prior information is not always available, and thus, in the algorithm, we simply use (−2, −1, 0)
for uj’s and (−3, −2, −1, 0) for vk’s assuming without any prior information. In this model, the parameters
are deﬁned as θ1 > 0 and θ2 > 0 and −∞ < θ0 < ∞. In addition, θ3 should satisfy θ1 + θ3vk > 0 and
θ2 + θ3uj for all k ∈ K and j ∈ J . This ensures that the increasing toxicity probability with the increasing

and vk = log

pj
1−pj

qk
1−qk

(cid:17)

(cid:17)

(cid:16)

(cid:16)

Hyun-Suk Lee, Cong Shen, William Zame, Jang-Won Lee, Mihaela van der Schaar

dose of a single drug. For the prior of the parameters, we use a normal distribution N (0, 10) for θ0 and θ3.
This prior is vague with relatively high variance. For θ1 and θ2, we use an exponential distribution Exp(1)
since they are positive. These default prior settings are same with used in the literature (Riviere et al.,
2014) and used for the other algorithms with the joint dose-toxicity model. For dataset RW, we use v = 0.85
because the potential DCs of the dataset are designed to be more conservative in terms of safety compared
with other datasets as described in the previous section.

• SOTA Bayes (Riviere et al., 2014): We implement a Bayesian dose-ﬁnding algorithm in Riviere et al.
(2014). We denote the probability threshold for dose escalation by ce and the probability threshold for dose
de-escalation by cd. To avoid that the dose is determined to be escalated and de-escalated at the same time,
we need to ensure ce + cd > 1. We use the joint dose-toxicity model with the same setting from SDF-Bayes
for fair comparison. The dose-ﬁnding algorithm proposed in Riviere et al. (2014) is described in following:
– Dose escalation: Let the current DC be (j, k). If P[pjk < ξ|O] > ce, then the current DC is escalated to
an adjacent DC among {(j + 1, k), (j, k + 1), (j + 1, k − 1), (j − 1, k + 1)} that has a toxicity probability
higher than pjk and closest to ξ. If the current DC is the highest one, the same DC is allocated. With the
I[pjk(θ(l)) <
samples from the posterior distribution f (θ|O), we approximate the condition as 1
L
ξ] > ce.

L
l=1

– Dose de-escalation: Let the current DC be (j, k).

If P[pjk > ξ|O] > cd, then the current DC is
de-escalated to an adjacent DC among {(j − 1, k), (j, k − 1), (j + 1, k − 1), (j − 1, k + 1)} that has a
toxicity probability lower than pjk and closest to ξ. If the current DC is the lowest one, the same DC
is allocated. With the samples from the posterior distribution f (θ|O), we approximate the condition
as 1
L

I[pjk(θ(l)) > ξ] > cd.

– Dose retainment : Let the current DC be (j, k).

If P[pjk < ξ|O] ≤ ce and P[pjk > ξ|O] ≤ cd, the
current DC is allocated. With the samples from the posterior distribution f (θ|O), we approximate the
L
condition as 1
l=1
L

I[pjk(θ(l)) < ξ] ≤ ce and 1
L

I[pjk(θ(l)) > ξ] ≤ cd.

L
l=1

L
l=1

P

P

P

At the end of the trial, the DC recommendation is determined as same with SDF-Bayes.

P
• StructMAB: We implement StructMAB based on Algorithm 2. For the algorithm, we use the same joint
dose-toxicity model and settings for the model used in SDF-Bayes. We set the exploration parameter α in
the conﬁdence set for the parameters in (7) to be 1. Moreover, when constructing the set of candidate MTDs
in (13), its condition to include a DC into the set of candidate MTDs is too sensitive in practice since a DC
will be included into the set even with only one ground sample that asserts that the DC is optimal. Thus,
to mitigate such sensitivity of the condition, we add the following condition: from the set, remove the DCs
whose number of ground samples is below the 20% percentile of the number of ground samples of each DC.
This helps to remove only the outliers from the set of candidate MTDs. For example, when all the DCs in
the set have only one ground sample, then the condition does not remove any DC from the set. Similarly,
to avoid StructMAB being too conservative, we use the 80% percentile of the toxicity of the allocated DC
among the samples when calculating the residual for the safety constraint.

• IndepTS (Aziz et al., 2019): We extend an independent Thompson sampling algorithm in Aziz et al. (2019)
for drug combinations. To this end, we simply expand an arm space of IndepTS into two dimensional space
for drug combinations. In IndepTS, Thompson sampling is used to estimate the toxicity of DC a as follows:

˜pa(t) ∼ Beta(αa(t), βa(t)),

where αa(t) = sa(t) + 1 and βa(t) = na(t) − sa(t) + 1. In each round t, the expected toxicities of all DCs
are sampled based on the above equation. Then, the DC a(t) that has the maximum toxicity sample ˜pa(t)
is chosen (i.e., a(t) = argmina∈C |˜pa(t) − ξ|). At the end of the trial, it recommends a DC as: ˆa∗(T ) =
argmina∈C |ˆps,k(T ) − ξ|. Note that the implicit safety consideration in IndepTS is not exploited in IndepTS-
DC since it is for a single drug.

• SDF-Bayes-AR: We implement SDF-Bayes-AR based on Algorithm 4 in this supplementary material. In
a practical implementation of SDF-Bayes-AR, we adopt uniform patient recruitment in an early phase of
clinical trial with the rounds t ≤ T /4. This enables a warm-start of adaptive patient recruitment and avoids
biased recruitment. In addition, we adopt an early stopping strategy to adaptive patient recruitment that

SDF-Bayes: Cautious Optimism in Safe Dose-Finding Clinical Trials

has been widely considered in clinical literatures (Riviere et al., 2014). If the posterior probability of the
most likely DC to be the MTD for group m exceeds a threshold (i.e., maxa∈C ˜GO(t)
m,a (u) > pes, where pes is
the threshold), then SDF-Bayes-AR stops recruiting the patients from group m. This prevents unnecessary
patient recruitment for the groups whose MTD is conﬁdently discovered.

• SOTA Bayes-AR: We implement SOTA Bayes-AR by adopting our proposed adaptive patient recruitment
(AR) to SOTA Bayes. For this, we can simply change line 2 in Algorithm 4 as “Obtain am(t)’s by SOTA
Bayes”.

F.3 Experiments with Heterogeneous Groups

In the experiments with heterogeneous groups, we apply the Bayesian algo-
rithms to the entire population by treating it as a single group called EP. The
toxicity probabilities for EP are the averages of the toxicity probabilities for
group A and B, which are provided in Table 8. In the results, the safety vio-
lations of each group and the entire trial are considered. For each simulated
trial, the safety violation of each group occurs if Sm(T ) > ξ + ǫ as described
in Section 4.1. On the other hand, the safety violation of the entire trial oc-
T
curs if 1
t=1 Yt > ξ + ǫ. For prior information, we run a simulated trial for
T
group B with Tp patients using SDF-Bayes. Then, we use the observations from the simulated trial as the prior
P
information.

0.12 0.21 0.30 0.40
3
2 0.075 0.125 0.215 0.30
1 0.035 0.09 0.125 0.205

Synthetic EP

4

2

1

3

Table 8: True toxicity of EP

G More Experiment Results with Homogeneous Group

G.1 DLT Observation Rates with Datasets and Distribution of DLT Observation Rates

Table 9: DLT observation rates with datasets A,B,C,D,RW.

Synthetic A Synthetic B Synthetic C Synthetic D Real-World

SDF-Bayes
DF-Bayes

0.296±.001 0.245±.001 0.286±.001 0.305±.001 0.274±.001
0.342±.002 0.260±.001 0.343±.001 0.351±.001 0.303±.001
SOTA Bayes 0.268±.001 0.204±.001 0.268±.001 0.275±.001 0.238±.001
StructMAB 0.282±.001 0.184±.001 0.279±.001 0.301±.001 0.238±.001
0.239±.001 0.118±.001 0.233±.001 0.278±.001 0.176±.001

IndepTS

From Table 9, SDF-Bayes satisﬁes the safety constraint but it does not achieve the lowest DLT observation rate
because it is more often testing DC’s that are believed close to being unsafe; this allows it to more eﬀectively ﬁnd
the true MTD. This exploration-toxicity trade-oﬀ can be seen even more clearly by looking at the distribution
of DLT observation rates in the following.

0.2

y
t
i
l
i

b
a
b
o
r
P

0.15

0.1

0.05

0
0.1

SDF-Bayes

0.2

0.3
DLT observation rates

0.4

0.2

0.15

0.1

0.05

0.5

0
0.1

DF-Bayes

0.2

0.3
DLT observation rates

0.4

0.2

0.15

0.1

0.05

0.5

0
0.1

SOTA Bayes

0.2

0.3
DLT observation rates

0.4

0.2

0.15

0.1

0.05

0.5

0
0.1

StructMAB

0.2

0.3
DLT observation rates

0.4

0.2

0.15

0.1

0.05

0.5

0
0.1

IndepTS

0.2

0.3
DLT observation rates

0.4

0.5

Figure 2: The distribution of DLT observation rates. The region shaded in gray is the region of the DLT
observation rates that violate the safety constraint.

In Fig. 2, we provide the histogram of the DLT observation rates of the trials with synthetic dataset A. From the
ﬁgure, we can see that the DLT observation rates with SDF-Bayes are distributed close to the safety threshold,
but only a few trials violate the safety constraint. This clearly shows that SDF-Bayes eﬀectively balances the
trade-oﬀ between the exploration of the toxicities of the DCs and the DLT observation as intended in its cautious
optimism. On the other hand, DF-Bayes frequently violates the safety constraint. This shows the eﬀectiveness
of the risk management by the cautiousness in SDF-Bayes. The safety constraint is rarely violated with SOTA
Bayes as much as SDF-Bayes. However, their DLT observation rates do not concentrate as in SDF-Bayes since

Hyun-Suk Lee, Cong Shen, William Zame, Jang-Won Lee, Mihaela van der Schaar

its dose escalation does not have a capability to balance the trade-oﬀ explicitly. StructMAB has the similar
distribution of DLT observation rates with SDF-Bayes, since the cautiousness principle of SDF-Bayes is adopted
in StructMAB. The DLT observation rates of IndepTS are distributed over a low rate region since it fails to
estimate the toxicities of DCs.

G.2 DC Allocation Ratios

SDF-Bayes

DF-Bayes

SOTA Bayes

3

K

2

1

3

K

2

1

3

K

2

1

1

2

3

4

1

2

3

4

1

2

3

4

J

J

J

0.15

0.1

0.05

0

Figure 3: Heatmaps for DC allocation ratios of Bayesian algorithms. The regions with blue, green, and black
borders are underdosing, target-dose, and overdosing regions, respectively.

Fig. 3 shows heatmaps for the DC allocation ratios of the Bayesian algorithms. We can see that the optimism of
DF-Bayes results in allocating the most DCs to the target-dose and overdosing. SOTA Bayes concentrates DCs
near the MTD (3, 2) because of the way it escalates doses. On the other hand, SDF-Bayes allocates DCs in a less
concentrated fashion because it tempers its optimism with caution. The result is that SDF-Bayes obtains more in-
formation than the other algorithms (and hence makes fewer recommendation errors) while managing risk better.

G.3 Results with More Toxicity Probability Models

Table 10: Synthetic models.

Synthetic E

Synthetic F

Synthetic G

Synthetic H

Synthetic I

1

2

3

4

1

2

3

4

1

2

3

4

1

2

3

4

1

2

3

4

3 0.15 0.30 0.45 0.50 0.10 0.15 0.35 0.50 0.17 0.35 0.45 0.50 0.10 0.15 0.25 0.40 0.10 0.25 0.40 0.60
2 0.09 0.12 0.15 0.30 0.07 0.12 0.16 0.35 0.10 0.17 0.35 0.45 0.07 0.12 0.16 0.25 0.07 0.12 0.25 0.40
1 0.05 0.08 0.10 0.13 0.03 0.06 0.08 0.10 0.05 0.10 0.17 0.35 0.03 0.06 0.08 0.10 0.03 0.08 0.18 0.25

Table 11: Safety constraint violation rates and DC recommendation error rates with diﬀerent datasets.

Synthetic E

Synthetic F

Synthetic G

Synthetic H

Synthetic I

Errors

Algorithms Safety vio.
Safety vio.
SDF-Bayes 0.010±.002 0.295±.011 0.006±.002 0.251±.010 0.035±.004 0.285±.011 0.003±.001 0.331±.011 0.033±.004 0.298±.011
0.239±.010 0.235±.010 0.245±.010 0.195±.009 0.530±.012 0.277±.010 0.112±.007 0.359±.011 0.300±.011 0.392±.011
DF-Bayes
SOTA Bayes 0.005±.002 0.318±.011 0.005±.002 0.214±.010 0.049±.005 0.283±.010 0.001±.001 0.338±.011 0.014±.003 0.361±.011
StructMAB 0.001±.001 0.592±.011 0.001±.001 0.547±.012 0.033±.004 0.616±.011 0.000±.000 0.490±.012 0.010±.002 0.445±.012
0.000±.000 0.726±.010 0.000±.000 0.697±.011 0.029±.004 0.632±.011 0.000±.000 0.712±.011 0.004±.001 0.582±.011

Safety vio.

Safety vio.

Safety vio.

IndepTS

Errors

Errors

Errors

Errors

Here, we introduce 5 more diﬀerent synthetic datasets to consider various possible combination toxicities. The
toxicity probabilities of each synthetic model are summarized in Table 10 and the MTDs are highlighted in bold.
Datasets F and G describe the scenarios in which the MTD’s toxicity probability is higher than the target toxicity
(ξ = 0.3) and datasets H and I describe the scenarios in which the MTD’s toxicity probability is lower than the
target toxicity. In Table 11, we provide the performance of the algorithms with the additional synthetic model
in Table 10. From the results, we can see that in terms of recommendation error rates, SDF-Bayes outperforms
SOTA Bayes in datasets E, H, and I. On the other hand, in datasets F and G, SOTA Bayes achieves lower error
rates. This is because SDF-Bayes cautiously chooses the DC to be allocated considering the safety violation;
it is hard to follow the optimism principle in those datasets because the MTDs have the higher toxicity than
the target toxicity. Hence, SDF-Bayes has an advantage in terms of safety as shown in the results of dataset G;
SOTA Bayes is very close to the boundary of a failure to satisfy the safety constraint while SDF-Bayes is not.
In the results of MAB-based algorithms (i.e., StructMAB and IndepTS), StructMAB outperforms IndepTS in
terms of error rates and achieves similar or lower safety violation rates. However, their error rates are too high
compared with those of the other Bayesian algorithms.

SDF-Bayes: Cautious Optimism in Safe Dose-Finding Clinical Trials

G.4 Impact of Budgets

Fig. 4 reports the error rate as a function of the total patient budget. We see that in the practical regime of
budgets (less than 100), the error rates of the MAB-based algorithms are signiﬁcantly higher than the Bayesian
algorithms. We note that this is even by using StructMAB, which already exploits the dose-toxicity structure to
speed up learning. This clearly shows that the Bayesian designs are more suitable than the MAB-based designs
in practice in terms of error rates.

0.8

0.6

0.4

0.2

e
t
a
r

r
o
r
r

E

0

0

SDF-Bayes
SOTA Bayes
StructMAB
IndepTS

100

200

300

400

500

Number of patients

G.5 Impact of Hyperparameter v

Figure 4: Error rates varying budgets.

Table 12: Performances of SDF-Bayes varying v

To show the impact of hyperparameter v on the perfor-
mance of SDF-Bayes, we provide the performance of SDF-
Bayes varying v from 0.80 to 0.95 in Table 12. Note that
the hyperparameter v controls how conservative the algo-
rithm is. From the results, we can see that the recommen-
dation error rate increases as v increases. On the other
hand, the safety constraint violation rate decreases as v
increases. These results clearly show that the hyperparam-
eter v controls the conservativeness of SDF-Bayes well. When v is increasing, SDF-Bayes chooses the DCs more
conservatively. Thus, the risk of safety constraint violation decreases. On the other hand, it results in a less
exploration. Then, the recommendation error rate increases.

Safety vio. Rec. errors DLT observ.

0.191
0.188
0.203
0.222

0.313
0.313
0.296
0.279

0.135
0.056
0.022
0.005

0.80
0.85
0.90
0.95

v

G.6 Sensitivity of Prior Distribution

We now provide the performances of SDF-Bayes varying the
prior distribution of the parameters of the dose-toxicity model
in Table 13. To show the sensitivity of the algorithms, we con-
sider the non-informative prior distribution (NonInfo) (i.e., a
uniform distribution) and the distributions with higher vari-
ances (HiVar) compared with the prior distributions in our de-
fault setting. Speciﬁcally, for the non-informative prior, we use
a uniform distribution that is truncated according to the do-
main of each parameter. For the high variance prior, we use
a normal distribution N (0, 50) for θ0 and θ3 and use a gamma
distribution with mean 1 and variance 10 (i.e., Γ(0.1, 0.1)) for θ1 and θ2.

Prior

Default

HiVar

NonInfo

Table 13: Performances of SDF-Bayes vary-
ing the prior distribution

Safety vio. Rec. errors DLT observ.

0.023

0.203

0.008

0.008

0.212

0.208

0.296

0.288

0.261

From the results, we can see that the performance of SDF-Bayes is similar regardless of the prior distribution of
the parameters. This implies that SDF-Bayes is robust to the prior distribution since the posterior distribution
of the parameters is eﬀectively constructed thanks to the cautious optimism. Beside, it is worth noting that
the prior distribution in the default setting is not a precise one as well (Riviere et al., 2014). Thus, the case
with the non-informative prior distribution is an extreme case in clinical trials for drug combinations since the
prior information on the parameters can be usually acquired from historical information, such as laboratory tests
and clinical trials for a single drug, and characteristics of dose-combination models. In conclusion, we can use
SDF-Bayes in practice even in case with a lack of the prior information of drugs.

 
Hyun-Suk Lee, Cong Shen, William Zame, Jang-Won Lee, Mihaela van der Schaar

G.7 Impact of Target Safety

Table 14: Performances of SDF-Bayes varying ψs.

In clinical trials, the target toxicity threshold is a stan-
dard of safety, and thus, the target safety is usually
deﬁned by the target toxicity threshold ξ (ξ + ǫs in our
manuscript). In SOTA Bayes, dose (de-)escalation is de-
termined based on the target toxicity threshold. Thus,
its safety naturally focuses on the target toxicity thresh-
old, and the target safety threshold cannot be arbitrarily
determined. On the other hand, SDF-Bayes can con-
sider arbitrary target safety ψs in its cautious principle by substituting the safety threshold, ξ + ǫs, in residual
r(t) and the set of conservatice DCs Ac(t) in our manuscript, respectively, to any other target safety ψs.

0.000
0.000
0.000
0.019
0.193

0.169
0.221
0.263
0.297
0.321

0.421
0.328
0.257
0.203
0.193

0.048
0.056
0.022
0.019
0.027

Rec. errors DLT observ.

Safety viol.
(ξ + ǫs)

Safety viol.
(ψs)

0.20
0.25
0.30
0.35
0.40

ψs

Here, we show the impact of the safety threshold on SDF-Bayes. In Table 14, the recommendation error rates,
the safety violation rates with ψs, the safety violation rates with ξ + ǫs, and the DLT observation rates are
provided. From the table, we can see that the safety violation rates with ψs are similar regardless of the target
safety, ψs. This implies that SDF-Bayes eﬀectively manages the risk of safety violation for any given target safety.
Consequently, the DLT observation rates increase according to the target safety. This eﬀective risk management
in SDF-Bayes makes the target safety ψs become a safety budget for the exploration of the toxicities of the DCs.
Thus, the larger ψs allows SDF-Bayes to choose the DCs more optimistically during clinical trials. Consequently,
in the results, the recommendation error rates decreases as ψs increases. However, the target safety satisfying
ψs > ξ + ǫs is hard to use in practice since the safety violation rate with the standard target safety in clinical
trials (i.e., ξ + ǫs) signiﬁcantly increases. On the other hand, the target safety satisfying ψs < ξ + ǫs can be used
to make trials safer while sacriﬁcing the error rates.

G.8 Runtime and Scalability of SDF-Bayes

We evaluated runtime of SDF-Bayes in our simulations with homogeneous group; on average, it took approxi-
mately 2.7 milliseconds to complete a one-round update. (The implementation employed MATLAB with Intel
Core i7-8700 3.2GHz CPU but without parallel computing.) By contrast, in a clinical trial, it takes days or
weeks (sometimes months) to enroll patients for each round. Besides, actual clinical trials have limited numbers
of patients and drug combinations. Even if the trial allowed for a large number of patients, testing hundreds
of drug combinations would not be realistic because of safety issues. Hence, the runtime of SDF-Bayes is short
enough that it can be used in any realistic trial.

H More Experiment Results with Heterogeneous Groups

H.1 Understanding of Behavior of Bayesian Algorithms Applied to Entire Population

SDF-Bayes

DF-Bayes

SOTA Bayes

3

K

2

1

3

K

2

1

3

K

2

1

1

2

3

4

1

2

3

4

1

2

3

4

J

J

J

0.2

0.15

0.1

0.05

0

Figure 5: Heatmaps for DC allocation ratios of the patients of group A with the Bayesian algorithms applied to
entire population.

Given the toxicities of group EP, the toxicities to group A are under-estimated because the toxicities to group B
are very low. As a result, SDF-Bayes and DF-Bayes choose the DCs close to the MTDs of the averaged synthetic
model for the entire population (i.e., (2,4) and (3,3) as shown in Table 8). Also, SOTA Bayes escalates dose
above the MTDs of group A. These imply that the algorithms applied to group EP frequently select overdosing
DCs for the patients of group A; see Fig. 5. Then, as shown in Table 4 in the manuscript, the safety violation
rates of group A become excessively high.

SDF-Bayes: Cautious Optimism in Safe Dose-Finding Clinical Trials

H.2 Expected Improvements and Patient Recruitment Ratios

To understand the recruitment behavior of SDF-Bayes-AR, Fig.
6 plots the expected improvement (EI)
probability for the most likely DC for each group and the patient recruitment ratio of each group as a function
of the amount of prior information (Tp). The EI for group B decreases as the amount of the prior information
SDF-Bayes-UR recruits patients
increases.
uniformly; SDF-Bayes-AR adaptively recruits patients in order to maximize the EI gain from the next patient.

(Previous observations render later observations less useful.)

0.06

0.04

I

E

0.02

0

0.7
0.6
0.5

0.4
0.3

o
i
t
a
R

Group A
Group B

20

40
60
Rounds

80

20

40
60
Rounds

80

20

40
60
Rounds

80

Figure 6: EI of the probability measures and patient recruitments ratio of groups varying the amount of the
prior information.

H.3 Results in Section 5.2. with DLT Observation Rates

Here, we provide the DLT observation rates of the results for heterogeneous groups. Tables 15 and 16 provides
the DLT observation rates aligned to the results in Tables 3 and 4 in our manuscript, respectively. Table 15
shows that the DLT observation rates of variants of SDF-Bayes are slightly higher than those of SOTA Bayes-UR
due to the exploration-toxicity trade-oﬀ as in the single group case. (It is shown that they satisfy the safety
constraint in Table 3 in our manuscript.) Table 16 shows that SDF-Bayes-AR outperforms SDF-Bayes-UR in
terms of total DLT observation rates.

Table 15: DLT observation rates with heterogeneous groups (from Table 3 in the paper).

Algorithms

Total

Group A

Group B

SDF-Bayes-AR 0.263±.001
SDF-Bayes-UR 0.263±.001
0.302±.001
DF-Bayes-UR

0.236±.001
0.229±.001
0.252±.002
SOTA Bayes-UR 0.233±.001 0.270±.001 0.196±.001

0.292±.001
0.297±.001
0.352±.002

SDF-Bayes-EP
DF-Bayes-EP

0.278±.001
0.302±.001
SOTA Bayes-EP 0.247±.001

0.391±.002
0.427±.002
0.352±.002

0.166±.002
0.178±.002
0.142±.001

Table 16: DLT observation rates varying the amount of the prior information (from Table 5 in the paper).

Tp = 20

Tp = 40

Tp = 60

AR

UR

Group A 0.282±.001 0.261±.001 0.250±.001
Group B 0.243±.002 0.259±.002 0.269±.003
0.262±.001 0.255±.001 0.248±.001

Entire

Group A 0.296±.001 0.296±.001 0.296±.001
Group B 0.238±.002 0.248±.002 0.255±.002
0.267±.001 0.272±.001 0.275±.001

Entire

