H-factors in graphs with small independence number

Ming Chen∗

Jie Han†

Guanghui Wang‡

Donglei Yang§

8th July 2022

Abstract

2
2
0
2

l
u
J

7

Let H be an h-vertex graph. The vertex arboricity ar(H) of H is the least integer r such
that V (H) can be partitioned into r parts and each part induces a forest in H. We show that
(cid:17)
for suﬃciently large n ∈ hN, every n-vertex graph G with δ(G) ≥
and α(G) = o(n) contains an H-factor, where f (H) = 2ar(H) or 2ar(H) − 1. The result
can be viewed an analogue of the Alon–Yuster theorem [1] in Ramsey–Tur´an theory, which
generalises the results of Balogh–Molla–Sharifzadeh [2] and Knierm–Su [21] on clique factors.
In particular the degree conditions are asymptotically sharp for inﬁnitely many graphs H
which are not cliques.

f (H) , 1

1 − 2

+ o(1)

max

(cid:111)

(cid:110)

(cid:16)

2

n

]

O
C
.
h
t
a
m

[

1
v
8
5
0
3
0
.
7
0
2
2
:
v
i
X
r
a

1

Introduction

Let H be an h-vertex graph and G be an n-vertex graph. An H-tiling in G is a collection of
vertex-disjoint subgraphs of G isomorphic to H. An H-factor is an H-tiling which covers all
the vertices of G. Determining suﬃcient conditions for the existence of an H-factor is one of
the fundamental lines of research in extremal graph theory. One important reason is due to
a result of Hell and Kirkpatrick [17] which shows that the decision problem for H-factors is
NP -complete, given that H has a connected component of size at least 3.

The ﬁrst result in this line is due to Dirac [7], who proved that every n-vertex graph G
with δ(G) ≥ n
2 contains a Hamiltonian cycle, in particular if n is even then G has a perfect
matching. The celebrated Hajnal–Szemer´edi theorem [12] states that for all integers n, r with
r ≥ 2 and r|n, any n-vertex graph G with δ(G) ≥ (cid:0)1 − 1
(cid:1) n contains a Kr-factor. The K3-factor
r
case was previously proved by Corr´adi and Hajnal [6]. The balanced complete r-partite graph
witnesses the tightness of the minimum degree condition. For non-cliques H, Alon and Yuster [1]
proved that for any constant ε > 0 and large n ∈ N divisible by |H|, δ(G) ≥
n
guarantees an H-factor, namely, the relevant parameter in the degree condition is χ(H), the
chromatic number of H. However, as given in [5, 18], there are graphs H for which the term
1 − 1/χ(H) in the minimum degree condition can be improved signiﬁcantly and determining
the best possible bound on δ(G) for an arbitrary graph H has been an intriguing problem.
There had been many excellent results (see e.g. [22, 23, 32] and survey [25]) until it was ﬁnally
settled by K¨uhn and Osthus [26] in 2009. There are also several signiﬁcant generalisations of

χ(H) + ε

1 − 1

(cid:16)

(cid:17)

∗School of Mathematics, China University of Mining and Technology, Xuzhou, China.

Email:

chenming314@cumt.edu.cn.

†School of Mathematics and Statistics and Center for Applied Mathematics, Beijing Institute of Technology,

Beijing, China. Email: hanjie@bit.edu.cn.

‡School of Mathematics and Data Science Institute, Shandong University, Jinan, China.

Email:
ghwang@sdu.edu.cn. Supported by Young Taishan Scholar program of Shandong Province (201909001) and
Natural Science Foundation of China (11871311).

§Data Science Institute, Shandong University, Jinan, China. Email: dlyang@sdu.edu.cn. Supported by the
China Postdoctoral Science Foundation (2021T140413), Natural Science Foundation of China (12101365) and
Natural Science Foundation of Shandong Province (ZR2021QA029).

1

 
 
 
 
 
 
the Hajnal–Szemer´edi theorem in the setting of partite graphs [20, 28, 29], directed graphs [34]
and hypergraphs [31].

1.1 Main result

Note that the extremal example that achieves the optimality of the bound on δ(G) in the
Hajnal–Szemer´edi theorem contains a large independent set, which is “regular” and rather rare
among all graphs. Following the spirit of the well-known Ramsey–Tur´an theory (see [11, 9, 10,
31]), a natural question on the Hajnal–Szemer´edi theorem is to determine the minimum degree
condition forcing a clique factor when the host graph has sublinear independence number. The
following Ramsey–Tur´an type problem was proposed by Balogh, Molla and Sharifzadeh [2].

Problem 1 ([2]). Let r ≥ 3 be an integer and G be an n-vertex graph with α(G) = o(n). What
is the minimum degree condition on G that guarantees a Kr-factor?

degree condition δ(G) ≥ n

Balogh, Molla and Sharifzadeh [2] studied the K3-factors and showed that the minimum
2 + µn guarantees a triangle factor, for any µ > 0 and large n ∈ 3N.
Later, Nenadov and Pehova [30] generalised Problem 1 to K(cid:96)-independence numbers for
is it true that for every r, (cid:96) ∈ N with r ≥ (cid:96) ≥ 2 and µ > 0 there exist a constant
(cid:96) ≥ 2:
α and n0 ∈ N such that every graph G on n ≥ n0 vertices where r divides n with δ(G) ≥
max (cid:8) 1
r + µ(cid:9) n and α(cid:96)(G) ≤ αn has a Kr-factor? Nenadov and Pehova [30] also proved
a general upper bound for the minimum degree conditions, which is asymptotically optimal when
(cid:96) = r − 1. Chang, Han, Kim, Wang and Yang [4] provided a negative answer to this problem.
They [4] also determined an asymptotically optimal degree condition for (cid:96) ≥ 3

2 + µ, r−(cid:96)

4 r.

Recently, Knierim and Su [21] proved the following result, which solves Problem 1 asymp-

totically.

Theorem 1.1 ([21]). Given constant µ > 0, r ∈ N with r ≥ 4, there exists α > 0 such
that the following holds for suﬃciently large n. Let G be an n-vertex graph with r dividing n,
δ(G) ≥ (cid:0)1 − 2

r + µ(cid:1) n and α(G) ≤ αn. Then G contains a Kr-factor.

It is natural to study Problem 1 for arbitrary H other than cliques. The ﬁrst attempt would
be to prove a result that matches the Alon–Yuster theorem [1], which we shall formulate below.
For our problem, we ﬁnd that the relevant parameter for the minimum degree condition is the
vertex arboricity of H.

Deﬁnition 1.2. The vertex arboricity ar(H) of a graph H is the minimum integer r such
that the vertices of H can be partitioned into r subsets each of which induces a forest. The
corresponding partition is called an acyclic partition of H. We say that an acyclic partition of
H is optimal if it has exactly ar(H) parts.

Note that this deﬁnition extends that of the chromatic number of H, where each color class
is required to be an independent set. Our ﬁrst result provides an analogue of the Alon–Yuster
theorem [1] in host graphs with sublinear independence number.

Theorem 1.3. Given µ > 0, h ∈ N with h ≥ 3 and an h-vertex graph H, there exists α > 0
such that the following holds for suﬃciently large n ∈ hN. Let G be an n-vertex graph such that
δ(G) ≥ max

and α(G) ≤ αn. Then G contains an H-factor.

1 − 1

n, (cid:0) 1

(cid:110)(cid:16)

(cid:111)

(cid:17)
ar(H) + µ

2 + µ(cid:1) n

Similar to the Alon–Yuster theorem [1], the minimum degree condition in Theorem 1.3 is
asymptotically tight for inﬁnitely many graphs H which we deﬁne now. Let H be a graph and
P be a family of vertex partitions of H where each partition has (cid:96) parts. For P ∈ P, let
x1 ≤ x2 ≤ · · · ≤ x(cid:96) denote the sizes of the parts of P. Put D(P) := {xi+1 − xi | i = 1, . . . , (cid:96) − 1}.
Let D(H, P) denote the union of all the sets D(P) taken over all P ∈ P. Let hcf 1(H, P) be the
highest common factor of all integers in D(H, P). (If D(H, P) = ∅, then we set hcf 1(H, P) :=

2

∞.) Let hcf 2(H, P) be the highest common factor of all the orders of components of H. If
(cid:96) = 1 and hcf 2(H, P) = 1, then hcf(H, P) = 1. If (cid:96) = 2, hcf 2(H, P) = 1 and hcf 1(H, P) ≤ 2,
then hcf(H, P) = 1. If (cid:96) ≥ 3 and hcf 1(H, P) = 1, then hcf(H, P) = 1.

Given a graph H, let PC be the family of all proper colorings of H with χ(H) colors, and
let AP be the family of all acyclic partitions of H with ar(H) parts. Then for (cid:96) ≥ 2, whether
hcf(H, PC) = 1 or not is the dichotomy found by K¨uhn and Osthus [26] for the minimum degree
conditions for H-factors in general graphs. That is, the term 1 − 1
χ(H) in the Alon–Yuster
theorem is asymptotically tight if and only if hcf(H, PC) (cid:54)= 1. In the problem of K¨uhn and
Osthus [26], (cid:96) = 1 implies that H is an independent set, which is a trivial case. However, for
our problem, (cid:96) = 1 means that H is a forest, in which case we have the following result.

Theorem 1.4. Given µ > 0, h ∈ N with h ≥ 3 and an h-vertex forest H with hcf 2(H, AP) = 1,
there exists α > 0 such that the following holds for suﬃciently large n ∈ hN. Let G be an
n-vertex graph such that δ(G) ≥ µn and α(G) ≤ αn. Then G contains an H-factor.

Note that the degree condition in Theorem 1.4 is quite small. Its proof follows the lattice-
based absorbing method [15] used in previous works as well as in this paper. The proof is
omitted here and will appear in the ﬁrst author’s doctoral thesis.

For our problem, we show that the minimum degree condition in Theorem 1.3 is asymptot-
ically tight for H with hcf(H, AP) (cid:54)= 1 and conjecture that the relation is actually “if and only
if” (see Conjecture 1.10 below). The proof of the following Proposition 1.5 is presented in full
details in Section 2.

Proposition 1.5. Given α > 0 and h ∈ N, let H be an h-vertex graph with hcf(H, AP) (cid:54)= 1.
Then the following holds for suﬃciently large n. There exists an n-vertex graph G with δ(G) ≥
max{(1 − 1

2 − 2} and α(G) ≤ αn such that G has no H-factor.

ar(H) )n − 2, n

Comparing with Theorem 1.3, we actually prove a slightly stronger result. To state it, we

ﬁrst introduce some notation.

Deﬁnition 1.6. Let (cid:101)H be a family of graphs such that every element H ∈ (cid:101)H has an acyclic
partition P = {T1, . . . , Tr} with r := ar(H) such that i) H[T1] is an independent set and ii)
2|T1| = |Ti| for each i ∈ [2, r]. Given a graph H, let f (H) be an integer such that

f (H) :=

(cid:40)

2ar(H) − 1
2ar(H)

if H ∈ (cid:101)H;
otherwise.

Note that all cliques of odd order belong to (cid:101)H and f (Kr) = r. Our main result reads as

follows.

Theorem 1.7. Given µ > 0, h ∈ N and an h-vertex graph H, there exists α > 0 such that
the following holds for suﬃciently large n ∈ hN. Let G be an n-vertex graph such that δ(G) ≥
max

and α(G) ≤ αn. Then G contains an H-factor.

1 − 2

n, (cid:0) 1

(cid:110)(cid:16)

(cid:111)

(cid:17)
f (H) + µ

2 + µ(cid:1) n

Since f (H) ≤ 2ar(H), Theorem 1.3 follows from Theorem 1.7. Theorem 1.7 uniﬁes and
generalises the results of Balogh–Molla–Sharifzadeh [2] and Knierm–Su [21] on clique factors.
We remark that the minimum degree condition in Theorem 1.7 is asymptotically sharp for (all
graphs H with hcf(H, AP) (cid:54)= 1 and) inﬁnitely many graphs H with hcf(H, AP) = 1. To illustrate
this we introduce the following notation.

Deﬁnition 1.8. The critical arboricity arcr(H) of a graph H is deﬁned as (ar(H)−1)|V (H)|
|V (H)|−σ(H)
σ(H) denotes the minimum size of a part taken over all optimal acyclic partitions of H.

, where

Note that ar(H) − 1 < arcr(H) ≤ ar(H). We supply the following general lower bound

serving as a “space barrier” for this problem.

3

Proposition 1.9. Let h ∈ N and H be an h-vertex graph. Then for any α > 0, the fol-
lowing holds for suﬃciently large n ∈ hN. There exists an n-vertex graph G with δ(G) ≥
(cid:16)

(cid:17)

n − 1 and α(G) ≤ αn which does not have an H-factor.

1 − 1

arcr(H)

In particular, Proposition 1.9 implies that the degree condition in Theorem 1.7 is tight for
the graphs H with f (H) = 2arcr(H). In particular, when arcr(H) < ar(H), f (H) = 2arcr(H)
implies that H ∈ (cid:101)H and thus hcf(H, AP) = 1. The following is an example for such H. Let
r ∈ N and H be an (r + 1)-partite graph K2r+1,...,2r+1. By deﬁnition we have K2r+1,...,2r+1 ∈
(cid:101)H, f (K2r+1,...,2r+1) = 2r + 1 and arcr(K2r+1,...,2r+1) = 2r+1
. The proof of Proposition 1.9 is
presented in full details in Section 2.

2

In summary, the degree condition in Theorem 1.7 is tight for the graphs H with i) hcf(H, AP)
(cid:54)= 1 and ii) H ∈ (cid:101)H and arcr(H) = ar(H) − 1/2. Nevertheless, we put forward the following
conjecture for the H-factor problem.

Conjecture 1.10. Given µ > 0, h ∈ N and an h-vertex graph H with hcf(H, AP) = 1, there
exists α > 0 such that the following holds for suﬃciently large n ∈ hN. Let G be an n-vertex
(cid:17)
graph such that δ(G) ≥ max
arcr(H) + µ
and α(G) ≤ αn. Then G contains
an H-factor.

2 + µ(cid:1) n

1 − 1

n, (cid:0) 1

(cid:110)(cid:16)

(cid:111)

For complete multi-partite graphs H, the smallest open case is H = K3,3,4 where f (H) = 5,

arcr(H) = 20

9 and hcf(H, AP) = 1.

1.2 Proof strategy

Our proof makes use of the absorption method and builds on the techniques developed in [14, 15,
19]. The absorption method was introduced by R¨odl, Ruci´nski and Szemer´edi about a decade
ago in [31]. Since then, it has turned out to be an important tool for studying the existence of
spanning structures in graphs, digraphs and hypergraphs.

Now we sketch the proof idea. The main tasks are to (i) build an absorbing set and (ii) cover
almost all of the remaining vertices with an H-tiling. For (i), we need the following notation of
absorbers and absorbing sets in [30].

Deﬁnition 1.11. Let G be an n-vertex graph and H be an h-vertex graph. Then

(1) a subset A ⊆ V (G) is a ξ-absorbing set in G for some constant ξ if for any subset U ⊆

V (G)\A of size at most ξn and |A ∪ U | ∈ hN, G[A ∪ U ] contains an H-factor.

(2) for any subset S ∈ V (G) of size h and an integer t, we call a subset AS ⊆ V (G)\S an
(H, t)-absorber for S if |AS| = ht and both G[AS] and G[AS ∪ S] contain an H-factor.

Widely used constructions of absorbing set by R¨odl, Ruci´nski and Szemer´edi [31] and H`an,

Person and Schacht [13] rely on the property that

every h-subset S has Ω(nht) (H, t)-absorbers for S.

However, as pointed out in [2], in our setting this is usually impossible because when we construct
the absorbers using the independence number condition, it does not give such a strong counting.
Instead, a new approach due to Nenadov and Pehova [30] guarantees an absorbing set provided
that

every h-set S has Ω(n) vertex-disjoint (H, t)-absorbers for S.

However, it is still unclear how to verify this for our problem and the bulk of the work on building
absorbing sets is to handle this. Here we instead build a partition V (G) = B ∪ U satisfying that

|B| = o(n) and every h-set in U has Ω(n) vertex-disjoint absorbers.

4

Similar ideas already appeared in our recent work, e.g. [4]. Then the arguments reduce to ﬁnding
an absorbing set A in G[U ] and then covering vertices of B by a small H-tiling vertex disjoint
from A so as to yield a desired absorbing set. Our proof for this is also signiﬁcantly more
involved than that in [21] and uses the lattice-based absorption method by the second author
[15].

Our second task is to establish an almost perfect H-tiling. Following a standard application
of the regularity lemma, we obtain an ε-regular partition and then build a reduced multigraph
where two vertices are connected by a double-edge if the corresponding clusters form a regular
pair of density larger than 1
2 . Our proof uses a crucial notion of Kr-embeddable structures (see
Deﬁnition 4.1) from the work of Knierim and Su [21], which was used to model all possible
ways how Kr is embedded into a collection of clusters. To be more precise, a Kr-embeddable
structure, say K, is a clique in the reduced multigraph such that for a, b ∈ N with a + b = |V (K)|
and a + 2b = r, K has b vertices that are pairwise connected by multiple edges (if b > 1).
Another key ingredient in their approach is that they build an almost perfect fractional tiling
with Kr-embeddable structures via a novel idea (see Deﬁnition 4.2 and Lemma 4.3). We adapt
this approach to H-tilings which roughly boils down to embedding vertex-disjoint copies of H
in diﬀerent Kr-embeddable structures where r = f (H). To apply Lemma 4.3 in our proof,
it suﬃces to show that for every Kr-embeddable structure K with a, b given as above and
V (K) = {V1, V2, . . . , Va+b}, we can ﬁnd an almost perfect H-tiling in an arbitrary collection of
subclusters V (cid:48)

j | for every i ∈ [a], j ∈ [a + 1, a + b].

i ⊆ Vi, where 2|V (cid:48)

i | = |V (cid:48)

Unlike in [21] where they embed a copy of Kr each containing exactly one vertex in Vi and
one edge in Vj for every i ∈ [a], j ∈ [a + 1, a + b], we instead need to embed an independent set
in each Vi and a forest in Vj for every i ∈ [a] and j ∈ [a + 1, a + b]. For this we shall use a result
of Erd˝os, Hajnal, S´os and Szemer´edi [10] which allows us to embed two forests in a regular pair
with density above 1
2 , one in each side, such that they are complete to each other. Note that
the Kr-embeddable structures may have diﬀerent orders ranging from (cid:100) r
2 (cid:101) to r. For every Kr-
embeddable structure K with integers a, b as above, we deﬁne a suitably-chosen auxiliary graph
Q(a, b) which admits an acyclic partition {T1, T2, . . . , Ta+b} such that Ti induces an independent
set and 2|Ti| = |Tj|1 for every i ∈ [a], j ∈ [a + 1, a + b]. In particular, Q(a, b) has an H-factor,
and thus it suﬃces to ﬁnd an almost perfect Q(a, b)-tilings in the same context (see Lemma 4.6
and Corollary 4.7).

1.3 Basic notation and organization

We ﬁrst introduce some notation throughout the paper. For a graph G := G(V, E), we write
e(G) = |E(G)|. We say an independent set I is an (cid:96)-independent set if |I| = (cid:96). Similarly, we
can deﬁne an (cid:96)-tree and an (cid:96)-forest. The girth g(G) of a graph G is the length of a shortest
cycle. For U ⊆ V , let G[U ] be the induced subgraph of G on U . Let G − U := G[V \U ]. For
two subsets A, B ⊆ V (G), we use E(A, B) to denote the set of edges joining A and B. We write
NG(v) for the set of neighbors of v in G. For convenience, we use dG(v) to denote the number
of edges which contain v in G. We omit the subscript G if the graph is clear from the context.
For m ∈ N, we write [V ]≥m for the family of all subsets U ⊆ V with |U | ≥ m. For a vertex set
W and a positive integer (cid:96), we write (cid:0)W
(cid:1) to denote the set of all (cid:96)-subsets of distinct elements
(cid:96)
of W . We write V (G) = V1 ∪ V2 for a bipartition of G if G[Vi] is an independent set for each
i ∈ [2]. For any integers a ≤ b, let [a, b] := {i ∈ Z : a ≤ i ≤ b} and [a] := [1, a].

When we write β (cid:28) γ, we always mean that β, γ are constants in (0, 1), and β (cid:28) γ means
that there exists β0 = β0(γ) such that the subsequent arguments hold for all 0 < β ≤ β0.
Hierarchies of other lengths are deﬁned analogously.

The rest of the paper is organized as follows. In Section 2, we will prove Proposition 1.5 and
Proposition 1.9. In Section 3, we will give a proof of our main result and introduce the regularity

1This is the origin of the family (cid:101)H.

5

lemma. In Section 4, our main work is to ﬁnd a fractional tiling and establish an embedding
lemma. We will prove Lemma 3.1 in Section 4.3. In Section 5, we present some necessary results
and tools to introduce the latticed-based absorbing method and prove Lemma 3.2.

2 Proofs of Proposition 1.5 and Proposition 1.9

We ﬁrst give a result which is commonly used in the proof of Proposition 1.5 and Proposition
1.9.

Lemma 2.1 ([8]). For any α > 0, k ∈ N with k ≥ 3, there exists an n-vertex graph G for
suﬃciently large n such that α(G) < αn and g(G) > k.

Now we give the proof of Proposition 1.5.

Proof of Proposition 1.5. Given α > 0 and h ∈ N, we shall choose 1
divide the proof into following three cases: (cid:96) = 1, (cid:96) = 2 and (cid:96) ≥ 3.

n (cid:28) α. Let (cid:96) := ar(H). We

We ﬁrst give a construction for every graph H with hcf 2(H, AP) ≥ 2, which will commonly be
used when (cid:96) = 1, 2. Note that there exists p ∈ {(cid:98) n
2 (cid:99), (cid:98) n
2 (cid:99)+1} that is non-divisible by hcf 2(H, AP).
Let G0 be an n-vertex graph with V (G0) = V1 ∪ V2 such that |V1| = p and |V2| = n − p, and
G0[Vi] be a complete graph for each i ∈ [2]. It holds that δ(G0) ≥ n
2 − 2 and α(G0) = 2. Let H (cid:48)
be a copy of H in G0. Since G0 is disconnected, |V (H (cid:48)) ∩ V1| ≡ 0 (mod hcf 2(H, AP)). Thus,
for every H-tiling H in G0, | (cid:83)
H (cid:48)∈H(V (H (cid:48)) ∩ V1)| ≡ 0 (mod hcf 2(H, AP)). Note that |V1| = p
is non-divisible by hcf 2(H, AP). Hence, H is not an H-factor in G0.

If (cid:96) = 1, then by the assumption that hcf(H, AP) (cid:54)= 1, it holds that hcf 2(H, AP) ≥ 2. We

are done by the construction G0 as above.

If (cid:96) = 2, then by the assumption that hcf(H, AP) (cid:54)= 1, we may assume that hcf 2(H, AP) = 1
and hcf 1(H, AP) ≥ 3 as the case hcf 2(H, AP) ≥ 2 would be handled by G0. Let G be an
n-vertex graph with V (G) = V1 ∪ V2, |V1| = (cid:98) n
2 (cid:101) − 1 and G[V1, V2] be a
complete bipartite graph. Let G[Vi] be a subgraph with α(G[Vi]) ≤ αn and g(G[Vi]) ≥ h + 1
2 − 1 and α(G) ≤ αn. Let H (cid:48)
given by Lemma 2.1 for each i ∈ [2].
be a copy of H in G. Then g(G[Vi]) ≥ h + 1 implies that V (H (cid:48)) ∩ Vi induces a forest in H (cid:48)
for every i ∈ [2]. Hence, P := {V (H (cid:48)) ∩ V1, V (H (cid:48)) ∩ V2} is an acyclic partition of H (cid:48) and
thus |(V (H (cid:48)) ∩ V1)| − |(V (H (cid:48)) ∩ V2)| ≡ 0 (mod hcf 1(H, AP)). For every H-tiling H in G, it
holds that | (cid:83)
H (cid:48)∈H(V (H (cid:48)) ∩ V2)| ≡ 0 (mod hcf 1(H, AP)). Note that
hcf 1(H, AP) ≥ 3 and |V1| − |V2| ∈ {1, 2}. Hence, H is not an H-factor in G.

H (cid:48)∈H(V (H (cid:48)) ∩ V1)| − | (cid:83)

It holds that δ(G) ≥ n

2 (cid:99) + 1, |V2| = (cid:100) n

If (cid:96) ≥ 3, then by the assumption that hcf(H, AP) (cid:54)= 1, it holds that hcf 1(H, AP) (cid:54)= 1. Let G
be an n-vertex graph with V (G) = V1 ∪ · · · ∪ V(cid:96), |V1| = (cid:98) n
(cid:96) (cid:99) − 1 ≤ |Vi| ≤ (cid:100) n
(cid:96) (cid:101)
for each i ∈ [3, (cid:96)] and G[Vi, Vj] be a complete bipartite graph for distinct i, j ∈ [(cid:96)]. Let G[Vi]
be a subgraph with α(G[Vi]) ≤ αn and g(G[Vi]) ≥ h + 1 given by Lemma 2.1 for each i ∈ [(cid:96)].
It holds that δ(G) ≥ n − ((cid:98) n
(cid:96) )n − 1 and α(G) ≤ αn. Let H (cid:48) be a copy of H
in G. Then by the same arguments in the case above, it holds that for every H-tiling H in G,
| (cid:83)
H (cid:48)∈H(V (H (cid:48))∩V2)| ≡ 0 (mod hcf 1(H, AP)). Note that hcf 1(H, AP) (cid:54)= 1
and |V1| − |V2| = 1. Hence, H is not an H-factor in G.

H (cid:48)∈H(V (H (cid:48))∩V1)|−| (cid:83)

(cid:96) (cid:99) + 1) ≥ (1 − 1

(cid:96) (cid:99) + 1, |V2| = (cid:98) n

(cid:96) (cid:99), (cid:98) n

Next we prove Proposition 1.9.

Proof of Proposition 1.9. Given α > 0 and h ∈ N, we shall choose 1
n (cid:28) α. Let H be an h-vertex
graph and (cid:96) := ar(H), G be an n-vertex graph with V (G) = V1 ∪ · · · ∪ V(cid:96), |V1| = σ(H)
h n − 1,
|V2| = (cid:6) h−σ(H)
((cid:96)−1)h n(cid:7) for each i ∈ [3, (cid:96)] and G[Vi, Vj] be a
complete bipartite graph for distinct i, j ∈ [(cid:96)]. Let G[Vi] be a subgraph with α(G[Vi]) ≤ αn and
≥
g(G[Vi]) ≥ h+1 given by Lemma 2.1 for each i ∈ [(cid:96)]. It holds that δ(G) ≥ n−
(cid:16)

((cid:96)−1)h n(cid:5) ≤ |Vi| ≤ (cid:6) h−σ(H)

((cid:96)−1)h n(cid:7) + 1, (cid:4) h−σ(H)

n − 1 and α(G) ≤ αn. Let H (cid:48) be a copy of H in G. Then g(G[Vi]) ≥ h + 1 implies

((cid:96)−1)h n(cid:7) + 1

(cid:16)(cid:6) h−σ(H)

1 − 1

(cid:17)

(cid:17)

arcr(H)

6

that H (cid:48)[V (H (cid:48)) ∩ Vi] is a forest for each i ∈ [(cid:96)], and P := {V (H (cid:48)) ∩ V1, . . . , V (H (cid:48)) ∩ V(cid:96)} is an
acyclic partition of H (cid:48). By the deﬁnition of σ(H), |V (H (cid:48)) ∩ V1| ≥ σ(H). Since |V1| = σ(H)
h n − 1,
there are at most (cid:4) |V1|
σ(H)

h −1 vertex-disjoint copies of H in G. Hence, G has no H-factor.

(cid:5) ≤ n

In the next section, we prove Theorem 1.7.

3 Proof of Theorem 1.7

3.1 Proof of the main result

In this subsection, we introduce the central lemmas that are needed for the proof of our main
theorem. This subsection is devoted to explaining how they work together to give the proof of
Theorem 1.7. The proofs of these lemmas are then presented in full details in Section 4 and
Section 5 respectively.

A crucial and necessary step in our proof is to ﬁnd an H-tiling in the graph G which covers
all but a small set of vertices. The following result guarantees the existence of such an H-tiling.
The proof of Lemma 3.1 will be presented in Section 4.

Lemma 3.1. Given µ, δ > 0, an h-vertex graph H with h ∈ N and h ≥ 3, there exists α > 0
such that the following holds for suﬃciently large n. Let G be an n-vertex graph with δ(G) ≥
n, (cid:0) 1
max
and α(G) ≤ αn. Then G contains an H-tiling which covers
all but at most δn vertices.

(cid:17)
f (H) + µ

2 + µ(cid:1) n

1 − 2

(cid:110)(cid:16)

(cid:111)

Lemma 3.2 provides an absorbing set in the graph G, whose proof can be found in Section

5.

Lemma 3.2. Given µ, γ with 0 < γ ≤ µ
2 , an h-vertex graph H with h ∈ N and h ≥ 3, there exist
α, ξ > 0 such that the following holds for suﬃciently large n. Let G be an n-vertex graph with
1 − 2
δ(G) ≥ max
and α(G) ≤ αn. Then G contains a ξ-absorbing set
A of size at most γn.

(cid:17)
f (H) + µ

2 + µ(cid:1) n

n, (cid:0) 1

(cid:110)(cid:16)

(cid:111)

Now we give the proof of Theorem 1.7 using Lemma 3.1 and Lemma 3.2.

Proof of Theorem 1.7. Given µ > 0, h ∈ N with h ≥ 3 and an h-vertex graph H, we shall choose

Let G be an n-vertex graph with δ(G) ≥ max
By Lemma 3.2 with γ ≤ µ
ξ > 0. Let G1 := G − A. Then we have
n, (cid:0) 1

δ(G1) ≥ max

(cid:17)
f (H) + µ

2 + µ(cid:1) n

1 − 2

(cid:110)(cid:16)

(cid:111)

1
n (cid:28) α (cid:28) δ (cid:28) ξ (cid:28) γ (cid:28) µ.
(cid:110)(cid:16)

and α(G) ≤ αn.
2 , we ﬁnd a ξ-absorbing set A ⊆ V (G) of size at most γn for some

1 − 2

(cid:17)
f (H) + µ

n, (cid:0) 1

2 + µ(cid:1) n

(cid:111)

− γn ≥ max

(cid:110)(cid:16)

1 − 2

f (H) + µ

2

(cid:17)

n, (cid:0) 1

2 + µ

2

(cid:111)

(cid:1) n

.

Therefore by applying Lemma 3.1 on G1 with δ, we obtain an H-tiling H that covers all but
a set L of at most δn vertices in G1. Since δ (cid:28) ξ, the absorbing property of A implies that
G[A ∪ L] contains an H-factor, which together with H forms an H-factor in G.

3.2 Regularity

To ﬁnd an almost perfect tiling, an important ingredient in our proof is Szemer´edi’s Regularity
Lemma. In this paper, we make use of a degree form of the regularity lemma [24]. We shall
ﬁrst introduce some notation. Given a graph G and a pair (V1, V2) of vertex-disjoint subsets in
V (G), the density of (V1, V2) is deﬁned as

7

Deﬁnition 3.3. Given ε > 0, a graph G and a pair (V1, V2) of vertex-disjoint subsets in V (G),
we say that the pair (V1, V2) is ε-regular if for all X ⊆ V1 and Y ⊆ V2 satisfying

d(V1, V2) = e(V1,V2)
|V1||V2| .

we have

X ⊆ V1, |X| ≥ ε|V1| and Y ⊆ V2, |Y | ≥ ε|V2|,

|d(X, Y ) − d(V1, V2)| ≤ ε.
Lemma 3.4 ([24], Slicing Lemma). Assume (V1, V2) is ε-regular with density d. For some
α ≥ ε, let V (cid:48)
2) is ε(cid:48)-regular
1| ≥ α|V1| and V (cid:48)
with ε(cid:48) := max{2ε, ε/α} and for its density d(cid:48) we have |d(cid:48) − d| < ε.

2| ≥ α|V2|. Then (V (cid:48)

1 ⊆ V1 with |V (cid:48)

2 ⊆ V2 with |V (cid:48)

1, V (cid:48)

ε ≤ k ≤ N ;

Lemma 3.5 ([24], Degree form of the Regularity Lemma). For every ε > 0 there is an N = N (ε)
such that the following holds for any real number β ∈ [0, 1] and n ∈ N. Let G be a graph with
n vertices. Then there exist an (ε, β)-regular partition V (G) = V0 ∪ · · · ∪ Vk and a spanning
subgraph G(cid:48) ⊆ G with the following properties:
(1) 1
(2) |Vi| ≤ εn for i ∈ [0, k] and |V1| = |V2| = · · · = |Vk| = m for some m ∈ N;
(3) dG(cid:48)(v) > dG(v) − (β + ε)n for all v ∈ V (G);
(4) each Vi is an independent set in G(cid:48) for i ∈ [k];
(5) all pairs (Vi, Vj) are ε-regular (in G(cid:48)) with density 0 or at least β for distinct i, j (cid:54)= 0.

A widely-used auxiliary graph accompanied with the regular partition is the reduced graph.
To diﬀerentiate between dense and very dense pairs of partitions, we employ the following
deﬁnitions of reduced multigraph.
Deﬁnition 3.6 (Reduced graph). Let k ∈ N, β, ε > 0, G be a graph with a vertex partition
V (G) = V0 ∪· · ·∪Vk and G(cid:48) ⊆ G be a subgraph fulﬁlling the properties of Lemma 3.5. We denote
by Rβ,ε the reduced graph for the (ε, β)-partition, which is deﬁned as follows. Let V (Rβ,ε) =
{V1, . . . , Vk} and for two distinct clusters Vi and Vj we draw a double-edge between Vi and Vj if
dG(cid:48)(Vi, Vj) ≥ 1

2 + β, a single-edge if β ≤ dG(cid:48)(Vi, Vj) < 1

2 + β and no edge otherwise.

The following fact presents a minimum degree of the reduced graph provided the minimum

degree of G, where a double-edge is counted as two edges.
Fact 1. Let n, h ∈ N, µ > 0, 0 < ε, β ≤ µ
10 with β ∈ [0, 1], H be an h-vertex graph and G be an
(cid:17)
n-vertex graph with δ(G) ≥
n. Let V (G) = V0 ∪ · · · ∪ Vk be a vertex partition
f (H) + µ
of V (G) satisfying Lemma 3.5 (1)-(5). We denote the reduced graph as Rβ,ε. Then for every
Vi ∈ V (Rβ,ε) we have

1 − 2

(cid:16)

dRβ,ε(Vi) ≥ 2

(cid:16)

1 − 2

f (H) + µ

2

(cid:17)

k.

Proof. Note that |V0| ≤ εn and |Vi| = m for each i ∈ [k]. Every edge in Rβ,ε represents less than
2 + β(cid:1) m2 edges in G(cid:48) − V0. Thus we have
(cid:0) 1

dRβ,ε(Vi) ≥

≥

(cid:16)

(cid:17)

1 − 2

|Vi| (δ(G) − (β + ε)n − εn)
2 + β(cid:1) m2
(cid:0) 1
f (H) + µ − 2ε − β
2 + β(cid:1) m2
(cid:0) 1
2
f (H)
2
f (H)

+ µ − 2ε − β

1 −

1 −

µ
2

k,

+

(cid:19)

(cid:18)

(cid:18)

mn

(cid:19)

≥ 2

> 2

(1 − 2β)k

8

since 0 < ε, β ≤ µ

10 and (cid:0) 1

2 + β(cid:1)−1 ≥ 2(1 − 2β).

Remark A. Let R be a multigraph with multiplicity 2. Note that |NR(i)| ≥ 1
2 dR(i) for each
i ∈ V (R). The double-edge neighborhood of i ∈ V (R) is a set of vertices in V (R) which are
connected to i through double-edges. Similarly, we deﬁne the single-edge neighborhood.

4 Almost perfect tilings

To obtain an almost perfect H-tiling in the graph G, we ﬁrst deﬁne a family Q of suitably-
chosen auxiliary graphs Q(a, b) (to be deﬁned later) for a, b ∈ N such that a + 2b = f (H) and
Q(a, b) contains an H-factor. This roughly reduces the problem to ﬁnding in G a collection of
vertex-disjoint copies of members from Q which altogether cover almost all vertices. Here our
proof adopts a standard application the regularity lemma on G to get a reduced graph R. A
key step in it is to construct certain structures in R for embedding Q(a, b). In this case, we use
an idea from the work of Knierim and Su [21] to ﬁnd a fractional tiling with Kf (H)-embeddable
structures (see Deﬁnition 4.1); and then develop a tool (see Corollary 4.7) for embedding Q(a, b)
under certain pseudorandomness conditions.

4.1 Fractional tilings

The main result in this subsection is Lemma 4.3 which provides us a fractional tiling with some
special structures in the reduced graph. Here, we ﬁrst present some related notation about these
special structures. They are formalised as follows.

Deﬁnition 4.1 ([21], Deﬁnition 2.6). Let R be a multigraph with multiplicity 2. Then a Kr-
multi-embedding to R is a mapping φ : V (Kr) → V (R) with the following properties:

• for any i ∈ V (R) the induced subgraph on the vertex set φ−1(i) (if not empty) in Kr is

either an isolated vertex or an edge (in particular, |φ−1(i)| ≤ 2);

• if uv ∈ E(Kr), then φ(u) and φ(v) are connected by at least one edge in R (as long as

φ(u) and φ(v) diﬀer);

• if |φ−1(i)| = |φ−1(j)| = 2 for distinct i, j ∈ V (R), then i and j are connected by a

double-edge.

We also need some deﬁnitions which are related to the Kr-multi-embedding. If φ is a Kr-
multi-embedding to R, then the corresponding subgraph R[φ(Kr)] =: K is a Kr-embeddable
structure in R. We write iK(v) = |φ−1(v)| for every v ∈ V (R) and by Deﬁnition 4.1 we know
that iK(v) ∈ {0, 1, 2}. We use F(R, r) := {K1, . . . , K(cid:96)} to denote the family of all Kr-embeddable
structures in R.

Deﬁnition 4.2. Let R be a k-vertex multigraph with multiplicity 2 and F(R, r) be given as
above. Then a fractional F(R, r)-tiling ω in R is a weight function from the members of F(R, r)
to the interval [0, 1] such that for every vertex v ∈ V (R) it holds that

ω(v) :=

(cid:88)

ω(K)iK(v) ≤ 1.

K∈F (R,r)

We call ω(R) := (cid:80)

v∈V (G) ω(v) the total weight of the fractional F(R, r)-tiling ω and it is
a perfect fractional tiling for R if ω(R) = |V (R)|. We shall use the following result to ﬁnd a
fractional F(R, r)-tiling with a large total weight, whose proof will be given in Section 4.4.

9

Lemma 4.3. For h ∈ N, h ≥ 3, an h-vertex graph H and positive constants µ, η, there exist
β, ε, α > 0 such that the following holds for suﬃciently large n. Let G be an n-vertex graph
(cid:111)
with δ(G) ≥ max
, α(G) ≤ αn and R := Rβ,ε be a reduced graph
for an (ε, β)-regular partition of G. Then R contains a fractional F(R, f (H))-tiling ω such that
ω(R) ≥ (1 − η)|V (R)|.

(cid:17)
f (H) + µ

2 + µ(cid:1) n

1 − 2

n, (cid:0) 1

(cid:110)(cid:16)

4.2 An embedding Lemma

The main goal of this subsection is to prove an embedding lemma for our purpose. Recall that
Lemma 4.3 gives us a large fractional tiling with Kf (H)-embeddable structures. Let {K1, . . . , K(cid:96)}
be all the Kf (H)-embeddable structures in R. Roughly speaking, Lemma 4.3 tells us that one
can correspond the proportion of weight occupied by Ki, e.g. ω(Ki) into disjoint vertex sets
Wi in G, in each of which we shall ﬁnd an almost perfect H-tiling. To achieve this, e.g.
for
K1, we have unique non-negative integers a, b such that a + b = |V (K1)| and a + 2b = f (H),
and we build an intermediate auxiliary graph Q(a, b) such that we can ﬁnd an almost perfect
Q(a, b)-tiling in W1 and Q(a, b) itself has an H-factor.

To elaborate on this, we ﬁrst deﬁne a graph Q(a, b, s, F1, . . . , Fb) with given forests F1, . . . , Fb.

Deﬁnition 4.4. Let a, b, s ∈ N and Fi be any 2s-forest for each i ∈ [b]. Then we construct a
graph Q := Q(a, b, s, F1, . . . , Fb) with V (Q) = U1 ∪· · ·∪Ua+b which satisﬁes following conditions:

• Q[Ui, Uj] is a complete bipartite graph for distinct i, j ∈ [a + b];

• Q[Ui] is an s-independent set for i ∈ [a];

• Q[Ua+j] is a 2s-forest Fj for j ∈ [b].

We omit the index (a, b, s, F1, . . . , Fb) if it is clear from context. By the deﬁnition of Q, we

have 2|Ui| = |Uj| for each i ∈ [a] and j ∈ [a + 1, a + b].

The following lemma is an essential gadget which allows us to embed an auxiliary graph in

G[V1 ∪ · · · ∪ Va+b] with a, b given as above.

Lemma 4.5 (Embedding lemma). Let a, b, s be positive integers and β > 0. Then there exist
N0 ∈ N and positive constants α, ε such that the following holds for any N ≥ N0. Let G be
a graph with V (G) = V1 ∪ · · · ∪ Va+b, α(G) ≤ α|V (G)|, |Vi| ≥ N for each i ∈ [a + b] such
that (Vi, Vj) is ε-regular, d(Vi, Vj) ≥ β for distinct i ∈ [a], j ∈ [a + b] and d(Vi, Vj) ≥ 1
2 + β
for distinct i, j ∈ [a + 1, a + b]. Then for any given 2s-forests {F1, . . . , Fb} there exists a copy
of Q(a, b, s, F1, . . . , Fb) in G whose vertex set, say U1 ∪ · · · ∪ Ua+b, satisﬁes Ui ⊆ Vi for each
i ∈ [a + b].

To make use of Lemma 4.5, we shall need the following lemma which guarantees the existence

of Q(a, b) as aforementioned.

Lemma 4.6. Let h ∈ N, H be an h-vertex graph and a, b ∈ N with a + 2b = f (H). Then there
exist s ∈ N with s ≤ h and a family of forests {F1, . . . , Fb} such that Q(a, b, s, F1, . . . , Fb) =:
Q(a, b) contains an H-factor.

Note that the Q(a, b) is not necessary unique. In the rest of the proof, we ﬁx an instance of
Q(a, b) as returned by Lemma 4.6, which serves as building blocks in our proof of Lemma 3.1.
For convenience, we formulate this in the following corollary.

Corollary 4.7. For any constant β > 0, positive integers a, b, h and an h-vertex graph H with
a + 2b = f (H), there exist α, ε > 0 and an integer s with s ≤ h such that the following holds for
suﬃciently large N . Let G be a graph with α(G) ≤ α|V (G)|, V (G) = V1 ∪ · · · ∪ Va+b, |Vi| ≥ N
for each i ∈ [a + b], (Vi, Vj) be ε-regular with d(Vi, Vj) ≥ β for distinct i ∈ [a], j ∈ [a + b] and

10

d(Vi, Vj) ≥ 1
2 + β for distinct i, j ∈ [a + 1, a + b]. Then there exists a copy of Q(a, b) in G whose
vertex set, say U1 ∪ · · · ∪ Ua+b, satisﬁes 2|Ui| = |Uj| = 2s for i ∈ [a] and j ∈ [a + 1, a + b] and
Ui ⊆ Vi for every i ∈ [a + b].

Proof. Given a, b, h ∈ N, we choose 1
obtained from Lemma 4.6, we can embed a copy of Q(a, b) into G as desired.

N (cid:28) α (cid:28) ε (cid:28) β. Applying Lemma 4.5 with F1, F2, . . . , Fb

4.3 Proof of Lemma 3.1

Equipped with a fractional tiling (Lemma 4.3) in the reduced graph and an embedding lemma
(Corollary 4.7), we are able to ﬁnd an almost perfect H-tiling in the original graph G.

Proof of Lemma 3.1. Given h ∈ N, an h-vertex graph and positive constants δ, µ, we shall choose

1

n (cid:28) α (cid:28) 1

k (cid:28) ε (cid:28) β, η (cid:28) δ, µ, 1
h .
(cid:17)
1 − 2
f (H) + µ

(cid:110)(cid:16)

n, (cid:0) 1

2 + µ(cid:1) n

(cid:111)

and α(G) ≤ αn.
Let G be an n-vertex graph with δ(G) ≥ max
Applying Lemma 3.5 with ε, β > 0, we obtain an ε-regular partition P = {V0, V1, . . . , Vk} of
V (G). Let m := |Vi| for each i ∈ [k] and R := Rβ,ε be a reduced multigraph of the partition
P with multiplicity 2 and V (R) = {V1, . . . , Vk}. Write F := F(R, f (H)) = {K1, . . . , K(cid:96)}. By
applying Lemma 4.3 on R with η, we obtain a fractional F-tiling ω such that

ω(R) ≥ (1 − η)k.

Then we construct ω(cid:48) from the fractional tiling ω by scaling the weight function ω of every
Kf (H)-embeddable-structure with a factor of (1 − η) i.e. for every Kf (H)-embeddable-structure
K we have ω(cid:48)(K) = (1 − η)ω(K). Thus ω(cid:48) has total weight at least (1 − 2η)k.

For each Kf (H)-embeddable-structure K with ω(cid:48)(K) > 0, we have a unique pair of integers
a, b ∈ N such that a + b = |V (K)| and a + 2b = f (H). Write CK = ω(cid:48)(K)m. Now we construct
a Q(a, b)-tiling QK by greedily picking vertex-disjoint copies of Q(a, b) in G such that QK is
maximal subject to the fact that it contains at most iK(Vi)CK vertices from each Vi, i ∈ [k].
We repeat the process for every Kf (H)-embeddable-structure K with positive weight, such that
the corresponding Q(a, b)-tilings QK are pariwise vertex-disjoint. Note that at the end of this
process the set of uncovered vertices in each Vi, denoted by V (cid:48)

i , has size

|V (cid:48)

i | ≥ |Vi| −

(cid:88)

K∈F

iK(Vi)CK = m − ω(cid:48)(Vi)m ≥ m − (1 − 2η)m ≥ 2ηm.

Now, we claim that every QK covers at least iK(Vi)(CK − h) vertices from each Vi, i ∈ [k]. Oth-
erwise, by assuming that V (K) = {V1, V2, . . . , Va+b} and applying Lemma 3.4 and Corollary 4.7,
1 ∪· · ·∪V (cid:48)
we can pick one more copy of Q(a, b) in G[V (cid:48)
a+b] which contains at most iK(Vi)h vertices
in each V (cid:48)

i for i ∈ [a + b]. This contradicts the maximality of QK.
Therefore, the total number of vertices covered as above is at least

(cid:88)

(cid:88)

i∈[k]

K∈F

(CK − h)iK(Vi) = m

(cid:88)

(cid:88)

i∈[k]

K∈F

ω(cid:48)(K)iK(Vi) − h

(cid:88)

(cid:88)

i∈[k]

K∈F

iK(Vi) ≥ (1 − 3η)mk,

where the last inequality follows as ω(cid:48)(R) = (cid:80)
n (cid:28)
1
k (cid:28) ε (cid:28) η. As each Q(a, b) contains an H-factor and η (cid:28) δ, the union of these QK provides
an H-tiling which covers all but at most n − (1 − 3η)mk ≤ δn vertices in G and this completes
the proof.

K∈F ω(cid:48)(K)iK(Vi) ≥ (1 − 2η)k and 1

i∈[k]

(cid:80)

In the next subsection, we prove Lemma 4.3, Lemma 4.5 and Lemma 4.6.

11

4.4 Proof of related lemmas

4.4.1 Proof of Lemma 4.3

The proof of Lemma 4.3 relies on the following two results Lemma 4.8 [21] and Lemma 4.9 [21].

Lemma 4.8 ([21], Lemma 4.4). For every r ∈ N with r ≥ 4 and η, µ > 0, there exist α > 0 and
n0 ∈ N such that every graph G on n ≥ n0 vertices with δ(G) ≥ (cid:0)1 − 2
r + µ(cid:1) n and α(G) < αn
has a fractional Kr-tiling ω such that

|{v ∈ G : ω(v) < 1 − η}| ≤ ηn.

Lemma 4.9 ([21], Lemma 4.7). For every r ∈ N with r ≥ 4 and µ, η > 0, there exist β, ε, γ > 0
such that the following holds for suﬃciently large n. Let G be an n-vertex graph with δ(G) ≥
(cid:0)1 − 2
r + µ(cid:1) n, α(G) ≤ γn and R := Rβ,ε be a reduced multigraph with multiplicity 2, k :=
|V (R)|. There is a graph Γ with δ(Γ) ≥ (cid:0)1 − 2
(cid:1) |V (Γ)| and α(Γ) ≤ γ|V (Γ)| such that the
r + µ
following holds.

4

If Γ has a fractional Kr-tiling with total wight at least (1 − η)|V (Γ)|, then G contains a
Kr-tiling covering at least (1 − 2η)n vertices. Moreover, R contains a fractional F(R, r)-tiling
ω such that ω(R) ≥ (1 − η)k.

The “moreover” part of the statement is not a part of the original statement of the Lemma

4.9 in [21] but is stated explicitly in the proof.

For convenience, we need the following corollary.

Corollary 4.10. For every r ∈ N with r ≥ 4 and µ, η > 0, there exist β, ε, γ > 0 such that the
following holds for suﬃciently large n. Let G be an n-vertex graph with δ(G) ≥ (cid:0)1 − 2
r + µ(cid:1) n,
α(G) ≤ γn and R := Rβ,ε be a reduced multigraph with multiplicity 2. Then R contains a
fractional F(R, r)-tiling ω such that ω(R) ≥ (1 − η)|V (R)|.

Corollary 4.10 comes directly from Lemma 4.8 and Lemma 4.9 by applying Lemma 4.8 on

the graph Γ in Lemma 4.9 where µ
Next, we prove Lemma 4.3.

4 plays the role of µ.

Proof of Lemma 4.3. We write k := |V (R)|. If f (H) ≥ 4, then applying Corollary 4.10 with
r = f (H) we obtain that there exists a fractional F (R, f (H))-tiling ω and

ω(R) = (cid:80)

Vi∈V (R) ω(Vi) ≥ (1 − η)k.

3 ω(K) for each i ∈ [4].

If f (H) = 2, 3, then δ(G) ≥ (cid:0) 1

2 + µ(cid:1) n. Applying Corollary 4.10 with r = 4, we obtain that
there exists a fractional F(R, 4)-tiling ω. Next, we construct from ω a fractional F(R, 3)-tiling
ω1 and a fractional F(R, 2)-tiling ω2 such that ω1(Vi) = ω2(Vi) = ω(Vi) for every vertex Vi in R.
Note that F(R, 4) is the family of all K4-embeddable structures in R. For every K ∈ F(R, 4),
if K is a copy of K4 in R and the triangles in the K are denoted as {K1, K2, K3, K4}, then
we deﬁne ω1(Ki) = 1
If K is a triangle in R, say V1V2V3 such that
2iK(Vi) = iK(V3) = 2, i ∈ [2], then we have three K3-embeddable structures K1, K2, K3 deﬁned
as follows: K1 = V1V3 with iK1(V1) = 1 and iK1(V3) = 2; K2 = V2V3 with iK2(V2) = 1
and iK2(V3) = 2; K3 = V1V2V3 with iK3(Vi) = 1 for every i ∈ [3].
In this case, we deﬁne
ω1(K3) = 2ω1(Ki) = 2
3 ω(K) for each i ∈ [2]. If K is a double-edge in R, say V1V2 ∈ E(R) and
the multiple edges in the double-edge are denoted as {K1, K2}, then K1 (or K2) can be simply
regarded as a K3-embeddable structure with iK1(V1) = 1 and iK1(V2) = 2 (resp. iK2(V1) = 2
and iK2(V2) = 1). Here we deﬁne ω1(Ki) = 2
3 ω(K) for each i ∈ [2]. In all cases, it is easy to see
that ω1(Vi) = ω(Vi) for every i ∈ [k] and thus ω1(R) = (cid:80)
Vi∈V (R) ω1(Vi) = ω(R).
Next we shall construct a fractional F(R, 2)-tiling ω2 from ω such that (cid:80)

Vi∈V (R) ω2(Vi) ≥
(1 − η)k. By Deﬁnition 4.1, every vertex Vi in V (R) is a K2-embeddable structure, and we deﬁne
ω2(Vi) = ω(Vi) for every i ∈ [k]. Then ω2(R) = (cid:80)

Vi∈V (R) ω2(Vi) = ω(R).

12

4.4.2 Proof of Lemma 4.5

Before the proof of Lemma 4.5, we need several results as follows. The ﬁrst one is due to Gy´arf´as,
Szemer´edi and Tuza [24] and independently, Sumner [33].

Lemma 4.11 ([24], [33]). A k-chromatic graph contains every tree on k vertices as a subgraph.

In our context, we shall use the following corollary of Lemma 4.11.

Corollary 4.12. Let n ≥ k be any integers and G be an n-vertex graph with α(G) ≤ n
every k-tree is contained in G.

k . Then

The next gadget in our proof is Lemma 4.14 proved by Erd˝os, Hajnal, S´os and Szemer´edi [10],
which enables us to embed one tree inside the common neighborhood of other trees under certain
density conditions. Before the statement of Lemma 4.14, we ﬁrst need the following notation of
(r1, r2)-graphs [10].

Deﬁnition 4.13 ([10], Deﬁnition 2.2). For r1, r2 ∈ N, a graph G(V, E) is said to be an (r1, r2)-
graph with root v ∈ V (G) if |V (G)| ≤ rr2
1 + 1 and each u ∈ V (G) with distance at most r1 from
v has degree at least r2.

Obviously, for r ≥ 1 an arbitrary tree of r + 1 vertices is a subgraph of any (r, r)-graph.

Lemma 4.14 ([10], Lemma 2.4). Given r1, r2, p ∈ N and c > 0, there exist positive constants
c(cid:48) and s such that the following holds for suﬃciently large n. Let V0, V1, . . . , Vp be vertex sets
each of size n and G be a graph deﬁned on V0 with |E(G)| ≥ sn. Then for all given mappings
fi : E(G) → [Vi]≥cn with i ∈ [p], there exists an (r1, r2)-graph H1 ⊆ G with
e∈E(H1) fi(e)(cid:12)

(cid:12) ≥ c(cid:48)n for every i ∈ [p].

(cid:84)

(cid:12)
(cid:12)

Note that to invoke Lemma 4.14 in the proof of Lemma 4.5, we need Proposition 4.15 which

gives a lower bound on the number of edges in the setting of small independence number.

Proposition 4.15. Let G be an n-vertex graph with α(G) ≤ αn. Then e(G) ≥ (1−α)n
2α .

Proof. Note that

1 +

2e(G)
n

=

(cid:80)

v∈V (G) (d(v) + 1)
n

≥

(cid:80)

n

v∈V (G)

1
d(v)+1

≥

1
α

,

where the ﬁrst inequality follows from the fact that the arithmetic mean is at least the harmonic
mean, and the last inequality follows from a well-known result in [3] stating that α(G) ≥
(cid:80)

1

v∈V (G)

d(v)+1 . Thus e(G) ≥ (1−α)n
2α .

Next we prove Lemma 4.5.

Proof of Lemma 4.5. Given a, b, s ∈ N and β > 0, we shall choose

1
N

(cid:28) α (cid:28) ε (cid:28) εa+b−1 (cid:28) · · · (cid:28) ε1 (cid:28) c(cid:48) (cid:28) β,

1
s

and let G, F1, . . . , Fb be given in Lemma 4.5.

The proof will proceed by induction on a + b. The base case a + b = 1 is clear as either Q is
an s-independent set or a 2s-forest F1: If a = 1 and b = 0, then we only need to choose a vertex
set U1 ⊆ V1 with |U1| = s which is easily derived since |V1| ≥ N ≥ s. If a = 0 and b = 1, then
we only need to embed a 2s-forest F1 in G[V1]. By Corollary 4.12 with α ≤ 1
2s , G[V1] contains
every 2s-forest.

13

j := N (vi)∩Si−1

1| ≥ (1 − ε(a + b − 1)) |V1|. In V (cid:48)

1 ⊆ V1 such that every vertex in V (cid:48)

Next we show that our statement holds for a + b = k assuming it holds for a + b = (cid:96) < k.
First assume a ≥ 1. Since (Vi, Vj) is ε-regular in G for distinct i, j ∈ [1, a + b], there exists a
subset V (cid:48)
1 has at least (d(V1, Vj) − ε) |Vj| neighbors in Vj for
each j ∈ [2, a + b] and |V (cid:48)
1, we choose s vertices {v1, . . . , vs} with
2 |Si−1
j := N (v1)∩Vj, Si
S1
| for each i ∈ [2, s]
j
and each j ∈ [2, a + b]. Then the s vertices in V (cid:48)
j in Vj
2 )s|Vj|. Applying Lemma 3.4 to G[(cid:83)a+b
for each j ∈ [2, a + b] with |Sj| ≥ ( β
i=2 Si], we obtain that
(cid:110)
2ε, ε2s
= ε2s
βs and d(Si, Sj) ≥ d(Vi, Vj) − ε ≥ d(Vi, Vj) − β
(Si, Sj) is ε(cid:48)-regular with ε(cid:48) := max
βs
2
for distinct i, j ∈ [2, a + b]. Since ε (cid:28) εa+b−1, it holds that (Si, Sj) is εa+b−1-regular for distinct
i, j ∈ [2, a + b]. Note that |Sj| ≥ ( β
2 )sN . We apply the induction hypothesis to ﬁnd
in G[(cid:83)a+b
i=2 Si] a copy of Q(a − 1, b, s, F1, . . . , Fb) which together with {v1, . . . , vs} forms a copy
of Q(a, b, s, F1, . . . , Fb) as desired.

| ≥ β
j
1 have a common neighborhood Sj := Ss

and |N (vi)∩Si−1

2 )s|Vj| ≥ ( β

| ≥ (β−ε)|Si−1

(cid:111)

j

j

Now assume a = 0 and b ≥ 2. Recall that d(Vi, Vj) ≥ 1

2 + β for distinct i, j ∈ [b]. Inside V1,
|Vj|

1 has at least (d(V1, Vj)−ε)|Vj| ≥

(cid:16) 1
2 + β

(cid:17)

2

there exists a subset V (cid:48)
neighbors in Vj for every j ∈ [2, b] and

1 such that every vertex in V (cid:48)

|V (cid:48)

1| ≥ |V1| − ε|V1|b = (1 − εb)|V1| ≥ (1 − εb)N.

Our next step is to embed Q(a, b, s, F1, . . . , Fb) into G[V (cid:48)
and i ∈ [2, b], we have

1 ∪ V2 ∪ · · · ∪ Vb]. Note that for u, v ∈ V (cid:48)
1

|N (u) ∩ N (v) ∩ Vi| ≥ β|Vi|.

(1)

By Proposition 4.15, we have

e(V (cid:48)

1) ≥

(1 − α)
2α

|V (cid:48)

1| ≥

(1 − α)
2α

(1 − εb)N.

To apply Lemma 4.14, we deﬁne for every i ∈ [2, b] a mapping

fi : E(G[V (cid:48)

1]) → [Vi]≥β|Vi|,
by letting fi(uv) := N (u) ∩ N (v) ∩ Vi for every uv ∈ E(G[V (cid:48)
β|Vi| for every uv ∈ E(G[V (cid:48)
that there exist a constant c(cid:48) and a (2s, 2s)-subgraph H1 ⊆ G[V (cid:48)
| (cid:84)
(cid:84)
3.4, we have that (Si, Sj) is ε(cid:48)-regular where ε(cid:48) := max (cid:8)2ε, ε
c(cid:48)
d(Si, Sj) ≥ 1
which together with F1 forms a copy of Q(a, b, s, F1, . . . , Fb) as desired.

1]). From (1), it holds that |fi(uv)| ≥
1]). Lemma 4.14 applied with r1 = r2 = 2s and c = β implies
1] such that for i ∈ [2, b],
e∈E(H1) fi(e)| ≥ c(cid:48)|Vi|. By deﬁnition, H1 contains a subgraph isomorphic to F1. Write Si :=
e∈E(F1) fi(e) for each i ∈ [2, b]. Then for every i ∈ [2, b], we have |Si| ≥ c(cid:48)|Vi| ≥ c(cid:48)N . By Lemma
(cid:9) ≤ εa+b−1 since ε (cid:28) εa+b−1, c(cid:48) and
i=2 Si] contains a copy of Q(a, b−1, s, F2, . . . , Fb)

2 . By induction hypothesis, G[(cid:83)b

2 + β

4.4.3 Proof of Lemma 4.6

Proof of Lemma 4.6. Let r := ar(H) and T = {T0, T1, . . . , Tr−1} be an acyclic partition of H.
For every Ti ∈ T , Pi = {Vi,1, Vi,2} is a bipartition of Ti, and Ti,j := Vi,j is an independent set in
H for j ∈ [2]. We divide the proof into the following two cases.

If f (H) = 2r, then we take s = h and construct F1 = F2 = · · · = Fb such that F1 is a
2h-forest which consists of two vertex-disjoint copies of H[Tj] for each j ∈ [0, r − 1]. Recall that
a
2 + b = r. To show that Q(a, b, h, F1, . . . , Fb) contains an H-factor, we build an auxiliary matrix

A = {aij}r×r =








T1 T2
T2 T3
...
...
T0 T1








. . .
T0
. . .
T1
...
. . .
. . . Tr−1

14

where aij := Ti+j−1 (mod r) for i, j ∈ [r]. Note that every row (or column) of A corresponds to
a permutation of T = {T0, T1, . . . , Tr−1}. Now we construct two matrices A1 and A2 as follows
by “cutting” each of the ﬁrst a

2 columns in half and then swapping columns two by two:

A1 = {a1

i,j}r×(a+b) =








T1,1 T1,2
T2,1 T2,2
...
...
T0,1 T0,2

T a
T a
T a
. . .
2 ,1
2 ,2
2 +1
. . . T a
2 +1,2 T a
2 +1,1 T a
2 +2
...
...
...
. . .
T a
2 −1,1 T a
. . . T a
2 −1,2
2

T0
. . .
T1
. . .
...
. . .
. . . Tr−1








where a1

i,2j−1 := Ti+j−1 (mod r),1 and a1

i,2j := Ti+j−1 (mod r),2 for each i ∈ [r] and j ∈ [ a
2 ];

A2 = {a2

i,j}r×(a+b) =








T1,2 T1,1
T2,2 T2,1
...
...
T0,2 T0,1

T a
T a
T a
. . .
2 ,2
2 ,1
2 +1
2 +1,1 T a
2 +1,2 T a
. . . T a
2 +2
...
...
...
. . .
. . . T a
T a
2 −1,2 T a
2 −1,1
2

T0
. . .
T1
. . .
...
. . .
. . . Tr−1








where a2

i,2j−1 := Ti+j−1 (mod r),2 and a2

i,2j := Ti+j−1 (mod r),1 for each i ∈ [r] and j ∈ [ a
2 ].

Then A∗ :=

is a 2r × (a + b) matrix and observe that for each i ∈ [a], disjoint union

(cid:19)

(cid:18)A1
A2

of the elements taken over the ith column gives us an h-independent set, whilst each of the last
b columns of A∗ provides a copy of F1. Clearly, Q(a, b, h, F1, . . . , Fb) has an H-factor with 2r
vertex-disjoint copies of H.

If f (H) = 2r − 1, then we take s = 2h

2r−1 . By the deﬁnition of (cid:101)H, we know that in T =

{T0, T1, . . . , Tr−1}, T0 is an independent set in H and |Ti| = 2|T0|, i ∈ [r − 1]. Thus |T0| = h
and recall that a+1
which consists of two vertex-disjoint copies of H[Tr−b+i−1].

2r−1
2 + b = r. Now we construct F1, F2, . . . , Fb such that each Fi is a 4|T0|-forest

To show that Q(a, b, 2h

2r−1 , F1, . . . , Fb) contains an H-factor, we build an auxiliary matrix
A = {a1j}1×r = (cid:0)T0
It holds that A
corresponds to an acyclic partition of H. Similarly, we construct two matrices A1 and A2 as
follows:

(cid:1) where a1j := Tj for each j ∈ [0, r − 1].

. . . Tr−1

A1 = {a1

i,j}1×(a+b) =

i,j}1×(a+b) =

A2 = {a2
(cid:18)A1
A2

Let A∗ :=

(cid:16)

(cid:16)

T0 T1,1 T1,2

T0 T1,2 T1,1

. . . T a−1

2 ,1 T a−1

2 ,2 Tr−b

. . . T a−1

2 ,2 T a−1

2 ,1 Tr−b

. . . Tr−1

. . . Tr−1

(cid:17)

(cid:17)

,

.

(cid:19)

be a 2 × (a + b) matrix. By taking a disjoint union of the elements in the

columns as above, each of the ﬁrst a columns of A∗ provides a 2h
last b columns respectively provides copies of Fi, i ∈ [b]. Clearly, Q(a, b, 2h
H-factor containing two vertex-disjoint copies of H.

2r−1 -independent set while the
2r−1 , F1, . . . , Fb) has an

5 Absorbing

In this section, we give a proof of Lemma 3.2. We shall use a result of Nenadov and Pehova [30]
which gives a suﬃcient condition on the existence of an absorbing set.

Lemma 5.1 ([30], Lemma 2.2). Let H be a graph with h vertices, γ > 0 and t ∈ N be constants.
Then there exists ξ := ξ(h, t, γ) such that the following holds for suﬃciently large n. Suppose that
G is a graph with n vertices such that every S ∈ (cid:0)V (G)
(cid:1) has a family of at least γn vertex-disjoint
h
(H, t)-absorbers. Then G contains a ξ-absorbing set of size at most γn.

15

So the key point in the proof of Lemma 3.2 is to build linearly many vertex-disjoint absorbers
(cid:1). To achieve this, we employ the latticed-based absorbing method [16] and

for every S ∈ (cid:0)V (G)
h
we ﬁrst need the notion of H-reachability from [16] which originates in [27].

Deﬁnition 5.2. Let G, H be given as aforementioned and m, t ∈ N. Then we say that two
vertices u, v ∈ V (G) are (H, m, t)-reachable (in G) if for any vertex set W of m vertices, there is
a set S ⊆ V (G)\W of size at most ht−1 such that both G[S ∪{u}] and G[S ∪{v}] have H-factors,
where we call such S an H-connector for u, v. Moreover, a set U ⊆ V (G) is (H, m, t)-closed if
every two vertices u, v ∈ U are (H, m, t)-reachable, where the corresponding H-connector for
u, v may not be contained in U . If two vertices u, v ∈ V (G) are (H, m, 1)-reachable, then we say
u is 1-reachable to v. If u, v ∈ U are (H, m, t)-reachable, and the corresponding H-connector
for u, v is contained in U , then we say that u, v ∈ U are (H, m, t)-inner-reachable. Similarly, we
can deﬁne (H, m, t)-inner-closed and 1-inner-reachable.

The following result from [16] builds a suﬃcient condition to ensure that every subset S ⊆

V (G) with |S| = h has linearly many vertex-disjoint absorbers.

Lemma 5.3 ([16], Lemma 3.9). Given β > 0, t, h ∈ N with h ≥ 3 and an h-vertex graph H,
the following holds for suﬃciently large n ∈ N. Let G be an n-vertex graph such that V (G) is
(H, βn, t)-closed. Then every S ∈ (cid:0)V (G)
β
h2t n vertex-disjoint (H, t)-
h
absorbers.

(cid:1) has a family of at least

Based on this lemma, it suﬃces to show that V (G) is closed. However, we are only able to
prove a slightly weaker result which states that the graph G admits a vertex partition V (G) =
B ∪ U where B is a small vertex set and U is inner-closed.

Lemma 5.4. Given h ∈ N with h ≥ 3, an h-vertex graph H and constants τ, µ with 0 < τ < µ,
there exist positive constants α, β and t ∈ N such that the following holds for suﬃciently large
n. Let G be an n-vertex graph with δ(G) ≥ max
and α(G) ≤ αn.
Then G admits a partition V (G) = B ∪ U with |B| ≤ τ n and U is (H, βn, t)-inner-closed.

(cid:17)
f (H) + µ

2 + µ(cid:1) n

1 − 2

n, (cid:0) 1

(cid:110)(cid:16)

(cid:111)

Clearly, we shall focus on the subgraph G[U ] and obtain an absorbing set by applying

Lemma 5.3 and Lemma 5.1 on G[U ].

The next step is to deal with the vertex set B. We shall pick mutually vertex-disjoint copies
of H each covering a vertex in B. To achieve this, we use the following result which enables us
to ﬁnd linearly many copies of H covering any given vertex.

Lemma 5.5. Given h ∈ N with h ≥ 3, an h-vertex graph H and a constant µ > 0, there exists
α > 0 such that the following holds for suﬃciently large n. Let G be an n-vertex graph with
δ(G) ≥ max
and α(G) ≤ αn. If W is a subset of V (G) with
|W | ≤ µ
2 n, then there exists at least one copy of H covering v in G − W for each v ∈ V (G)\W .

2 + µ(cid:1) n

f (H) + µ

1 − 2

n, (cid:0) 1

(cid:110)(cid:16)

(cid:111)

(cid:17)

Now we give the proof of Lemma 3.2 by using Lemma 5.1, Lemma 5.3, Lemma 5.4 and

Lemma 5.5.

Proof of Lemma 3.2. Let h ∈ N, H be an h-vertex graph and constants γ, µ with 0 < γ ≤ µ
2 .
Then we shall choose τ = γ

2h and

1

n (cid:28) α (cid:28) ξ (cid:28) 1
(cid:110)(cid:16)

t , β (cid:28) γ, µ.

and α(G) ≤ αn.
Let G be an n-vertex graph with δ(G) ≥ max
Applying Lemma 5.4 on G, we obtain that G admits a vertex partition V (G) = B ∪ U such
that |B| ≤ τ n and U is (H, βn, t)-inner-closed. Applying Lemma 5.3 on G[U ], it holds that
every S ∈ (cid:0)U
2h2t n vertex-disjoint (H, t)-absorbers. Applying
h

(cid:1) has a family of at least β

h2t |U | ≥ β

1 − 2

(cid:17)
f (H) + µ

n, (cid:0) 1

2 + µ(cid:1) n

(cid:111)

16

Lemma 5.1 on G[U ] where γ
at most γ

2 n.

2 plays the role of γ, we obtain a ξ-absorbing set A1 in G[U ] of size

Now we shall iteratively pick vertex-disjoint copies of H each covering one vertex in B while
avoiding using any vertex in A1, and we claim that every vertex in B can be covered in this
way. Let G2 := G − A1. For each v ∈ B, we apply Lemma 5.5 iteratively to ﬁnd a copy of H
covering v in G2, while avoiding A1 and all copies of H found so far. This is possible as during
the process the number of vertices that we need to avoid is at most

h|B| + |A1| ≤ hτ n + γ

2 n = γn ≤ µ

2 n.

Let W be the union of the vertex sets over all the |B| vertex-disjoint copies of H as above
and A := A1 ∪ W . Recall that A1 is a ξ-absorbing set for G[U ], and G[W ] has an H-factor.
Thus A is a ξ-absorbing set for G with |A| ≤ γn.

Now it remains to prove Lemma 5.4 and Lemma 5.5 whose proofs will be given in next two

subsections respectively.

5.1 Proof of Lemma 5.4

To prove Lemma 5.4, we divide the proof into two steps (i): G admits a partition V (G) = B ∪ U
where B is a small vertex set and every vertex in U is 1-inner reachable to linearly many vertices;
(ii): U is inner-closed.

The following result is the ﬁrst step.

Lemma 5.6. Given h ∈ N with h ≥ 3, an h-vertex graph H and constants τ, µ with 0 < τ < µ,
there exist positive constants α, β1, γ1 such that the following holds for suﬃciently large n. Let G
and α(G) ≤ αn. Then G
be an n-vertex graph with δ(G) ≥ max
admits a vertex partition V (G) = B ∪ U such that |B| ≤ τ n and every vertex in U is (H, β1n, 1)-
inner-reachable to at least γ1n other vertices in G[U ].

(cid:17)
f (H) + µ

2 + µ(cid:1) n

1 − 2

n, (cid:0) 1

(cid:110)(cid:16)

(cid:111)

In the second step, we only need to apply the following result on G[U ].

Lemma 5.7. Given h ∈ N with h ≥ 3, an h-vertex graph H and constants µ, β1, γ1 with
0 < µ, β1, γ1 < 1, there exist positive constants α, β and t ∈ N such that the following holds for
(cid:111)
2 + µ(cid:1) n
suﬃciently large n. Let G be an n-vertex graph with δ(G) ≥ max
and α(G) ≤ αn such that every vertex in V (G) is (H, β1n, 1)-reachable to at least γ1n other
vertices. Then V (G) is (H, βn, t)-closed.

(cid:17)
f (H) + µ

1 − 2

n, (cid:0) 1

(cid:110)(cid:16)

Obviously, Lemma 5.4 is an immediate corollary of the above-mentioned two lemmas. In the

following, we will give the proofs of Lemma 5.6 and Lemma 5.7.

5.1.1 Proof of Lemma 5.6: 1-reachability

The proof of Lemma 5.6 goes roughly as follows. We ﬁrst apply the regularity lemma on G to
obtain a partition and a reduced graph R with multiplicity 2. A result of Knierim and Su [21]
guarantees that every cluster Vi is covered by a Kf (H)+1-embeddable structure, say Ki in the
reduced graph R (see Lemma 5.8). In this case, for each Vi, by using Corollary 4.7 on Ki, we
are able to show that almost all vertices in Vi are 1-reachable to linearly many other vertices
from Vi, where the bad vertices would be given iteratively at each stage of the process.

As sketched above, we need the following result which investigates the structure around every

cluster in the reduced graph.

Lemma 5.8 ([21], Lemma 3.7). For r ≥ 4 and k ∈ N, let R be a multigraph with multiplicity
(cid:1) 2k. Then any double-edge ij ∈ E(R) is contained in some
2 on k vertices and δ(R) > (cid:0)1 − 2
r
Kr+1-embeddable structure.

17

Proof of Lemma 5.6. Given h ∈ N, an h-vertex graph H and constants τ, µ with 0 < τ < µ, we
shall choose

1

n (cid:28) 1

N (cid:28) α (cid:28) β1, γ1 (cid:28) 1

k (cid:28) ε (cid:28) τ, µ.
(cid:110)(cid:16)

(cid:111)

(cid:17)
f (H) + µ

1 − 2

10 , G be an n-vertex graph with δ(G) ≥ max

Let β = µ
and
α(G) ≤ αn. Applying Lemma 3.5 on G with ε, β > 0, we obtain an ε-regular partition P =
{V0, V1, . . . , Vk} of G. Let m := |Vi| for each i ∈ [k] and R := Rβ,ε be a reduced multigraph with
multiplicity 2 of the ε-regular partition P. By Fact 1, we have δ(R) ≥ 2
k when
f (H) ≥ 4 and δ(R) ≥ (1 + µ)k when f (H) = 2, 3. Clearly, every cluster is in a double-edge.
Applying Lemma 5.8 with r = max{f (H), 4}, we have that every cluster is in a Kf (H)+1-
embeddable structure when f (H) ≥ 4 and every cluster is in a K5-embeddable structure when
f (H) = 2, 3. Therefore every cluster is covered by a Kf (H)+1-embeddable structure.

f (H) + µ

1 − 2

(cid:16)

(cid:17)

2

n, (cid:0) 1

2 + µ(cid:1) n

Write F := F(R, f (H) + 1) for the family of all Kf (H)+1-embeddable structures in R.
Since every cluster is in some Kf (H)+1-embeddable structure, there exists a minimal subfamily
{K1, . . . , K(cid:96)} such that V (R) = (cid:83)(cid:96)

i=1 V (Ki). Now we ﬁrst deﬁne the vertex set B as follows:

(1) Let Si = V (Ki)\ (cid:83)i−1

p=1 V (Kp) for i ∈ [(cid:96)], where S1 = V (K1). Then it follows from the

minimality that Si (cid:54)= ∅ and we write Si = {Vi1, . . . , Visi

} for some integer si := |Si|;

(2) For i ∈ [(cid:96)] and j ∈ [si], Bij

Vs ∈ V (Ki) with s (cid:54)= ij

(3) B := (cid:83)(cid:96)

i=1 Bi.

(cid:110)

:=
(cid:111)
, and Bi := (cid:83)si

v ∈ Vij

j=1 Bij ;

(cid:12)
(cid:12)
(cid:12)|N (v) ∩ Vs| ≤ (d(Vij , Vs) − ε)|Vs| for some

Observe that {S1, S2, . . . , S(cid:96)} is a partition of V (R) and |Si| ≤ 2r + 1, i ∈ [(cid:96)]. Moreover, for

every i ∈ [(cid:96)] and j ∈ [si], we have |Bij | ≤ εm|Ki|. Thus |B| ≤ εm(2r + 1)k ≤ τ n since ε (cid:28) τ .

Let U := V (G)\B = (cid:83)k

i=1 Ui where Ui := Vi\B. Then |Ui| ≥ m − εm(2r + 1). By Lemma
3.4, d(Ui, Uj) ≥ d(Vi, Vj) − ε for distinct i, j ∈ [k]. Next, we shall prove that every v ∈ U is
1-inner-reachable to linearly many vertices in U .

For each p ∈ [k] and any vertex v ∈ Up, we choose the minimum q ∈ [(cid:96)] such that Vp ∈ V (Kq).
q, which is a
q (Vp) = 1. Without loss of generality, we may assume
q) = {V1, . . . , Va, . . . , Va+b} for some integers a, b ∈ N and a + 2b = f (H).
r that every vertex u ∈ Ui
2 m neighbors in Uj.

Since Kq is a Kf (H)+1-embeddable structure, there exists a subgraph of Kq, say K(cid:48)
Kf (H)-embeddable structure such that iK(cid:48)
p = 1 and write V (K(cid:48)
Thus for distinct i, j ∈ [a + b], it follows from (2) and the fact ε (cid:28) β, 1
has at least |N (u) ∩ Vj| − |B ∩ Vj| > d(Vi, Vj)m − εm − εm(2r + 1) ≥ β

Recall that v ∈ U1. We denote by U ∗

j ∈ [2, a + b], |N (u) ∩ N (v) ∩ Uj| ≥ ( β
because |U ∗

1 the set of vertices u ∈ U1 such that for every
2 )2m. The following claim would complete our proof

1 | ≥ (1 − ε(2r + 1))|U1| ≥ (1 − ε(2r + 1))2m ≥ γ1n, where γ1 (cid:28) 1

k (cid:28) ε.

Claim 5.9. The vertex v is (H, β1n, 1)-reachable to every u ∈ U ∗
1 .

To prove this, for every u ∈ U ∗

:= N (u) ∩ N (v) ∩ Uj for each j ∈ [2, a + b]. Then |Nj| ≥ ( β

and write Nj
j ∈ [a + b]. For each j ∈ [a + b], N (cid:48)
2 )2m − β1n ≥ β2
8 m since 1
|N (cid:48)
(cid:111)
(cid:110)
2ε, 8ε
(N (cid:48)
j) is ε(cid:48)-regular with ε(cid:48) := max
β2
i, j ∈ [a + b]. Applying Corollary 4.7 on G[N (cid:48)
induces an independent set inside N (cid:48)

j| ≥ |Nj| − β1n ≥ ( β
i , N (cid:48)

1 , we arbitrarily choose N1 ⊆ U1\{u, v} with |N1| ≥ ( β

2 )2m
2 )2m for each
j comes from Nj by deleting any β1n vertices. Hence,
10 . By Lemma 3.4,
j) ≥ d(Vi, Vj) − ε for distinct
a+b], we obtain a copy of Q(a, b) which

n (cid:28) 1
= 8ε
1 ∪ · · · ∪ N (cid:48)

k , µ and β = µ
i , N (cid:48)

N (cid:28) β1 (cid:28) 1
β2 and d(N (cid:48)

1. Hence, by deﬁnition v is (H, β1n, 1)-reachable to u.

18

5.1.2 Proof of Lemma 5.7

In the following, we shall use the latticed-based absorbing method developed by Han [15] and
begin with the following notion introduced by Keevash and Mycroft [19]. Let G be an n-vertex
graph. We will often work with a vertex partition P = {V1, . . . , Vr} of V (G) for some integer
r ≥ 1. For any subset S ⊆ V (G), the index vector of S with respect to P, denoted by iP (S), is
the vector in Zr whose ith coordinate is the size of the intersections of S with Vi for each i ∈ [r].
For each j ∈ [r], let uj ∈ Zr be the jth unit vector, i.e. uj has 1 on the jth coordinate and 0 on
the other coordinates. A transferral is a vector of the form ui − uj for some distinct i, j ∈ [r].
A vector v ∈ Zr is an s-vector if all its coordinates are non-negative and their sum is s. Given
µ > 0 and an h-vertex graph H, we say that an h-vector v is (H, µ)-robust if for any set W of at
most µn vertices, there is a copy of H in G − W whose vertex set has an index vector equal to
v. Let I µ(P) be the set of all (H, µ)-robust h-vectors and Lµ(P) be the lattice (i.e. the additive
subgroup) generated by I µ(P).

Here is a brief proof outline for Lemma 5.7. In order to prove that V (G) is closed, we adopt
a less direct approach and build on the merging techniques developed in [16]. We ﬁrst partition
V (G) into a constant number of parts each of which is closed (see Lemma 5.10). Then we
try to merge some of them into a larger (still closed) part by analyzing the graph structures.
Lemma 5.11 allows us to iteratively merge two distinct parts into a closed one, given the existence
of a transferral. Therefore, the key step is to ﬁnd a transferral (see Lemma 5.12), where we shall
use the regularity method and Corollary 4.7.

The following lemma can be used to construct a partition such that each part is closed.

Lemma 5.10 ([16], Lemma 3.10). For any positive constants γ1, β1, h ∈ N with h ≥ 3 and an
h-vertex graph H, there exist β2 = β2(γ1, β1, h) > 0 and t2 ∈ N such that the following holds for
suﬃciently large n. Let G be an n-vertex graph such that every vertex in V (G) is (H, β1n, 1)-
reachable to at least γ1n other vertices. Then there is a partition P = {V1, . . . , Vp} of V (G) with
p ≤ (cid:100) 1
γ1

(cid:101) such that for each i ∈ [p], Vi is (H, β2n, t2)-closed and |Vi| ≥ γ1

2 n.

Lemma 5.11 ([16], Lemma 4.4). Given any positive integers h, t ∈ N with h ≥ 3, an h-vertex
graph H and constant β > 0, the following holds for suﬃciently large n. Let G be an n-vertex
graph with a partition P = {V1, . . . , Vp} of V (G) such that each Vi is (H, βn, t)-closed. For
distinct i, j ∈ [p], if there exist two h-vectors s, t ∈ I β(P) such that s − t = ui − uj, then Vi ∪ Vj
is

-closed.

H, βn

(cid:16)

(cid:17)
2 , 2ht

Note that to invoke Lemma 5.11, we need the following result which provides a suﬃcient

condition for the existence of a transferral.

Lemma 5.12. Given p, h ∈ N with h ≥ 3, an h-vertex graph H and constants µ, δ1 > 0, there
exist α, β(cid:48) > 0 such that the following holds for suﬃciently large n. Let G be an n-vertex graph
(cid:111)
, α(G) ≤ αn, P = {V1, . . . , Vp} be a partition of
with δ(G) ≥ max
V (G) with |Vi| ≥ δ1n for each i ∈ [p]. If p ≥ 2, then there exist two h-vectors s, t ∈ I β(cid:48)(P) such
that s − t = ui − uj for some distinct i, j ∈ [p].

2 + µ(cid:1) n

f (H) + µ

1 − 2

n, (cid:0) 1

(cid:110)(cid:16)

(cid:17)

Now, we have collected all the tools needed for the proof of Lemma 5.7.

Proof of Lemma 5.7. Given h ∈ N with h ≥ 3, an h-vertex graph H and constants β1, γ1, µ > 0,
we shall choose

Let G be an n-vertex graph with δ(G) ≥ max
, α(G) ≤ αn and
every vertex in V (G) is (H, β1n, 1)-reachable to at least γ1n other vertices. Applying Lemma 5.10

f (H) + µ

1 − 2

(cid:17)

n, (cid:0) 1

2 + µ(cid:1) n

(cid:111)

1

n (cid:28) α (cid:28) β, 1

t (cid:28) β2, 1
t2
(cid:110)(cid:16)

(cid:28) β1, γ1, µ.

19

on G, we obtain a partition P0 = {V1, . . . , Vp} for some p ≤ (cid:100) 1
γ1
closed and |Vi| ≥ γ1n
2 .

(cid:101), where each Vi is (H, β2n, t2)-

Let P (cid:48) = {U1, . . . , Up(cid:48)} be a vertex partition of G with minimum |P (cid:48)| such that |Ui| ≥ γ1n
2
and Ui is (H, βn, t)-closed. We claim that p(cid:48) = 1. If p(cid:48) ≥ 2, then by Lemma 5.11 and Lemma
5.12, there exist two distinct vertex parts Ui and Uj for distinct i, j ∈ [p(cid:48)] such that Ui ∪ Uj
is (H, β(cid:48)n, t(cid:48))-closed for some β(cid:48) and t(cid:48). By taking Ui ∪ Uj as a new part in partition and
renaming all the parts if necessary, we get a partition P (cid:48)(cid:48) with |P (cid:48)(cid:48)| < |P (cid:48)|, which contradicts
the minimality of |P (cid:48)|. Hence, V (G) is (H, βn, t)-closed.

Next, we give a proof of Lemma 5.12. In order to prove Lemma 5.12, we use the regularity
lemma (Lemma 3.5) and an embedding result (Claim 5.13). In particular, such an embedding
result allows us to construct vertex-disjoint copies of H with diﬀerent index vectors, which can
be used to show the existence of a transferral. This roughly reduces the problem to ﬁnding in
the reduced graph a crossing Kf (H)+1-embeddable structure, which will be made precise later.

Proof of Lemma 5.12. Given p, h, t ∈ N, an h-vertex graph H and positive constants µ, δ1, we
shall choose

1

n (cid:28) α (cid:28) 1

N (cid:28) β(cid:48) (cid:28) 1

k (cid:28) ε (cid:28) µ, δ1.

Let β = µ
10 , r := ar(H), T = {T1, . . . , Tr} be an acyclic partition of H, P = {V1, . . . , Vp} be
a vertex partition of V (G) with |Vi| ≥ δ1n for each i ∈ [p]. Anchoring at the current vertex
partition of V (G), we apply Lemma 3.5 with ε, β > 0 and reﬁne the current partition. After
reﬁnement, we denote the ε-regular partition by P (cid:48) = {V0, V1,1, . . . , V1,s1, . . . , Vp,1, . . . , Vp,sp}
where Vi,j ⊆ Vi and si ∈ N for each i ∈ [p], j ∈ [si]. Let R := Rβ,ε be the reduced graph with
|V (R)| = k and Vi := {Vi,1, . . . , Vi,si} be a vertex subset of V (R) for each i ∈ [p]. For every cluster
Vi,j, Di,j denotes the double-edge neighborhood of Vi,j. It holds that 2|Di,j| + (k − |Di,j|) ≥ δ(R)
which means that

|Di,j| ≥ δ(R) − k,

(2)

for each Vi,j ∈ V (R).

We call a subgraph K ⊆ R crossing with respect to the partition P if V (K) ∩ Vi (cid:54)= ∅ and
V (K) ∩ Vj (cid:54)= ∅ for some distinct i, j ∈ [p]. A double-edged K has every two adjacent vertices
connected by a double-edge. We use K=
to denote the triangle which contains exactly one
3
double-edge and write f := f (H) throughout this proof.

The following claim provides a suﬃcient condition for the existence of a transferral. Its proof

is postponed to the end of this subsection.

Claim 5.13. If there is a crossing Kf +1-embeddable structure K in R, then there exist two
h-vectors s, t ∈ I β(cid:48)(P) such that s − t = ui − uj for distinct integers i and j.

Thus, we may assume that there is no crossing Kf +1-embeddable structure. Note that if
there exists a crossing double-edge between Vi and Vj for some distinct i, j ∈ [p], then by
Lemma 5.8 the double-edge is contained in a Kf +1-embeddable structure which is crossing, a
contradiction. So we may further assume that there is no crossing double-edge in R. In this
case, we shall ﬁnd a crossing Kf +1-embeddable structure and this gives a ﬁnal contradiction.

x ≤ k
divide the proof into the following four cases.

In the following, we assume |Vi| ≤ |Vi+1| for each i ∈ [p − 1] and x := |V1| for some integer
2 . To ﬁnd a crossing Kf +1-embeddable structure without any crossing double-edge, we
2 + µ(cid:1) k. Hence for V1,1 ∈ V1, by (2) it holds

Assume f ≥ 8. By Fact 1, we have δ(R) ≥ (cid:0) 3

that

k

2 ≥ x = |V1| ≥ |D1,1| ≥ δ(R) − k ≥ (cid:0) 1

2 + µ(cid:1) k,

20

a contradiction.

Assume f = 7, 6. By Fact 1, we have δ(R) ≥ 2

k. Let V1,iV1,j be a double-edge
in R[V1] for distinct i, j ∈ [s1], V (cid:48) := (NR(V1,i) ∩ NR(V1,j))\V1 and y := |V (cid:48)|. Since there is no
crossing double-edge, it holds that

(cid:16)

1 − 2

f + µ

2

(cid:17)

(cid:20)
2

(cid:18)

1 −

y ≥ 2

(cid:21)

k − 2x

− (k − x)

(cid:19)

µ
2

2
f

+

(cid:19)

(cid:18)

=

3 −

(cid:18)

≥

2 −

8
f
8
f

+ 2µ

k − 3x

(cid:19)

+ 2µ

k − x.

(3)

For any Vw,(cid:96) ∈ V (cid:48), it holds that

|NR[V (cid:48)](Vw,(cid:96))| ≥

=

=

1
2
1
2
1
2

(cid:2)δ(R) − 2|V (R)\(V1 ∪ V (cid:48))| − |V1|(cid:3)
(cid:19)
(cid:20)

(cid:18)

(cid:21)

2
f

µ
2

+

(cid:19)

2

1 −

(cid:20)(cid:18)

−

4
f

+ µ

k + x + 2y

.

k − 2(k − x − y) − x

(cid:21)

If there is a copy of Kf −3 in R[V (cid:48)], then this copy combined with V1,iV1,j forms a crossing copy
of Kf +1-embeddable structure. So by Tur´an’s theorem, we must have

4
f
1
f − 4
(cid:18)

(cid:19)

(cid:21)

−

+ µ

k + x + 2y

<

y;

(cid:20)(cid:18)

1
2

f − 5
f − 4
1
2

x;

k −

(cid:19)

− µ

(cid:18) 4
f
f − 4
2

−

1
2
8
f

(cid:19)

µ

k −

f − 4
2

x.

⇐⇒

y <

⇐⇒ y <

2 −

However, this contradicts (3) and f ≥ 6.

Figure 1: Illustration of a graph ordering

x

Assume f = 5. For any cluster V1,i ∈ V1 for i ∈ [s1], it holds that |NR[V1](V1,i)| ≥
10 . Thus every double-edge V1,iV1,j is contained in a copy of K=

=
2 + k
3 in R[V1]. Based on this,
we shall ﬁrst show that there is no double-edged K5 in R[V1]. Suppose for a contradiction that
there exists a double-edged K5 in R[V1], whose vertex set is denoted by {V1,1, V1,2, . . . , V1,5}.
Then we claim that there exists a crossing K7-embeddable structure which consists one cluster
outside V1 and three clusters in the double-edged K5. Indeed, we calculate the edges between
{V1,1, V1,2, . . . , V1,5} and V (R)\V1. We aim to show e({V1,1, V1,2, . . . , V1,5}, V (R)\V1) > 2(k − x),

6
5 k−(k−x)
2

21

which would imply the existence of one cluster in V (R)\V1 with at least three neighbors in the
double-edged K5. Note that this gives a K7-embeddable structure. It suﬃces to show

5
(cid:88)

d(V1,i) >

dR[V1](V1,i) + 2(k − x);

5
(cid:88)

i=1

⇐= 5 ×

⇐⇒ x <

(cid:19)

i=1

+ µ

(cid:18) 6
5
4 + 5µ
8

k > 5 × 2x + 2(k − x);

k.

As x = |V1| ≤ k
double-edged K5 in R[V1].

2 , we are done.

In the following, we may further assume that there is no

Now we shall deﬁne an ordering of the graphs in {K=

3 , double-edged K3, double-edged K4,

double-edged K5} as illustrated in Figure 1. Let S be a maximal element in the chain which is
a subgraph of R[V1]. Without loss of generality, let V (S) = {V1,1, . . . , V1,a}. Then a ∈ {3, 4}.
Observe that (cid:84)
i=1 d(V1,i) − (2a − 1)(x −
a) − 2a2 = (cid:80)a

j∈[a] D1,j = ∅. Then we have e(V (S), V (R)\V1) ≥ (cid:80)a

i=1 d(V1,i) − (2a − 1)x − a. Since x ≤ k

2 , no matter a = 3 or 4, we always have

10a−15

x < (6a−10)k−5a

, that is, 6
which implies that e(V (S), V (R)\V1) ≥ (cid:80)a
i=1 d(V1,i) − (2a − 1)x − a > 2(k − x). This means
that there is a cluster in V (R) \ V1 which has at least three neighbors in V (S), giving a crossing
K6-embeddable structure consisting of one cluster in V (R)\V1 and three clusters in V (S). So
we are done.

5 ak − (2a − 1)x − a > 2(k − x),

Finally we have f = 4, 3, 2. We assume that there is no crossing K=

3 as otherwise we are
done. By Fact 1, we have δ(R) ≥ (1 + µ)k and without loss of generality, we may assume
V1,1V2,1 is a crossing single-edge. Then N (V1,1) ∩ D2,1 = ∅ and N (V2,1) ∩ D1,1 = ∅. We have
d(V1,1) ≤ k − |D1,1| − |D2,1| + 2|D1,1| and d(V2,1) ≤ k − |D1,1| − |D2,1| + 2|D2,1| which yields
(2 + 2µ)k ≤ 2δ(R) ≤ d(V1,1) + d(V2,1) ≤ 2k, a contradiction.

Now we prove Claim 5.13.

Proof of Claim 5.13. Recall that V (R) = {V1,1, . . . , V1,s1, . . . , Vp,1, . . . , Vp,sp} with |V (R)| = k
and Vi = {Vi,1, . . . , Vi,si}, for each i ∈ [p]. Without loss of generality, we assume that K is
a crossing Kf +1-embeddable structure in R such that V (K) = {U1, U2, . . . , Ua+b} for distinct
clusters U1, U2, . . . , Ua+b ∈ V (R) such that Ui ∈ Vi for i ∈ [2], where a + 2b = f + 1.

q such that |N (v) ∩ U (cid:48)

If there exists a cluster in V (K), say Uq ∈ V(cid:96) for some q ∈ [a + b] and (cid:96) ∈ [p], such that
iK(Uq) = 1, then K − {Uq} =: K(cid:48) is a Kf -embeddable structure. Now we shall ﬁnd two h-vectors
s, t ∈ I β(cid:48)(P) as required. Let U (cid:48)
i be a subset of Ui for every i ∈ [a+b], by deleting any β(cid:48)n vertices.
N (cid:28) β(cid:48) (cid:28) 1
Since (Uq, Ui) is an (ε, β)-regular pair for each i ∈ [a + b] \ {q} and 1
k (cid:28) β, we
pick a vertex v ∈ U (cid:48)
2 m ≥ N . Write Yi = N (v) ∩ U (cid:48)
i
(cid:110)
for each i ∈ [a + b] \ {q}. By Lemma 3.4, (Yi, Yj) is ε(cid:48)-regular with ε(cid:48) := max
β for
distinct i, j ∈ [a + b] \ {q} and d(Yi, Yj) ≥ d(Ui, Uj) − ε. Applying Corollary 4.7 on G[∪i(cid:54)=qYi],
there exists a copy of Q(a − 1, b). Recall that Ui ∈ Vi for i ∈ [2]. Thus there exists i0 ∈ [2] such
that (cid:96) (cid:54)= i0. Let H1 be a copy of H in Q(a − 1, b) such that V (H1) ∩ Ui0 (cid:54)= ∅. Then we replace
any vertex in V (H1) ∩ Ui0 with v and get another copy of H, say H2. The two copies H1, H2
respectively give two h-vectors s, t ∈ I β(cid:48)(P) such that s − t = u(cid:96) − ui0.

i | ≥ (β − ε)m − β(cid:48)n ≥ β

n (cid:28) 1

2ε, 2ε
β

= 2ε

(cid:111)

Now it remains to deal with the case that every Ui ∈ V (K) satisﬁes iK(Ui) = 2, i ∈ [a + b].
Then a = 0, f = 2b − 1. Here we obtain that H ∈ (cid:101)H and b = ar(H). Let T = {T1, . . . , Tb}
be an acyclic partition of H such that H[T1] is an s-independent set for some s ∈ N and
|Ti| = 2s, i ∈ [2, b]. Let F1 = K1,2s−1 and Fi = 2H[Ti] for each i ∈ [2, b]. For each Ui, let U (cid:48)
i be
obtained from Ui by deleting any β(cid:48)n vertices. Since 1
2 ≥ N

i | ≥ m−β(cid:48)n ≥ m

N (cid:28) β(cid:48) (cid:28) 1

n (cid:28) 1

k , |U (cid:48)

22

2 + β

i , U (cid:48)

2 and (U (cid:48)

j) ≥ d(Ui, Uj) − ε ≥ 1
for each i ∈ [b]. By Lemma 3.4, d(U (cid:48)
j) is ε(cid:48)-regular
with ε(cid:48) := max{2ε, ε|Ui|
1 ∪ · · · ∪ U (cid:48)
i | } = 2ε for distinct i, j ∈ [b]. Applying Lemma 4.5 on G[U (cid:48)
b],
|U (cid:48)
we obtain a copy of Q(0, b, 2s, F1, . . . , Fb), say Q, such that V (Q) = X1 ∪ X2 ∪ · · · ∪ Xb and
i , i ∈ [b]. Note that Q[X1] induces a copy of K1,2s−1 whose center is denoted by v∗.
Xi ⊆ U (cid:48)
It is easy to derive that Q contains a copy of H, say H1, such that V (H1) ∩ X1 are leaves of
the K1,2s−1, |V (H1) ∩ Ui| = 2|V (H1) ∩ U1| = 2s for every i ∈ [2, b]. By removing from H1 any
vertex in V (H1) ∩ U2 and adding the center v∗, we obtain another copy of H, say H2 such that
|V (H2) ∩ U1| = s + 1, |V (H2) ∩ U2| = 2s − 1 and |V (H2) ∩ Ui| = 2s, i ∈ [3, b]. So H1 and H2
provide two h-vectors s, t ∈ I β(cid:48)(P) such that s − t = u2 − u1.

i , U (cid:48)

5.2 Proof of Lemma 5.5

This subsection is devoted to the proof of Lemma 5.5 which states that the given minimum
degree and independence number suﬃce to guarantee that every vertex is in a copy of H while
excluding any vertex set W of size o(n). To achieve this goal, we need the following result which
investigates the structure around every vertex in the original graph G.

Lemma 5.14 ([21], Lemma 3.11). Given r ∈ N with r ≥ 4 and constants ε, β, µ with 0 <
ε, β ≤ µ
10 , the following holds for suﬃciently large n. Let G be an n-vertex graph with δ(G) ≥
r + µ(cid:1) n, P = {V0, . . . , Vk} be an ε-regular partition for some integer k and R be a reduced
(cid:0)1 − 2
multigraph with multiplicity 2. Fix a vertex v in G, and let Qv be the set of clusters Vi ∈ V (R)
such that |NVi(v)| ≥ β|Vi|. Then there exists a multi-embedding of Kr into R embedding at most
one vertex in V (R)\Qv.

Proof of Lemma 5.5. Given h ∈ N with h ≥ 3, an h-vertex graph H and constant µ, we choose

1

n (cid:28) 1

N (cid:28) α (cid:28) 1

k (cid:28) ε (cid:28) µ.
(cid:110)(cid:16)

Let β = µ
αn, W ⊆ V (G) with |W | ≤ µ

10 , G be an n-vertex graph with δ(G) ≥ max

1 − 2
2 n and G1 := G − W . Then we have
(cid:110)(cid:16)
(cid:111)

(cid:110)(cid:16)

1 − 2

(cid:17)
f (H) + µ

n, (cid:0) 1

2 + µ(cid:1) n

δ(G1) ≥ max

− |W | ≥ max

(cid:17)
f (H) + µ

n, (cid:0) 1

2 + µ(cid:1) n

(cid:111)

, α(G) ≤

1 − 2

f (H) + µ

2

(cid:17)

n, (cid:0) 1

2 + µ

2

(cid:1) n

(cid:111)
.

2

(cid:16)

2 + µ

Applying Lemma 3.5 to G1 with ε, β > 0, we obtain an (ε, β)-regular partition P = {V0, V1, . . . , Vk}
of G1. Let R := Rβ,ε be a reduced multigraph for the partition P with multiplicity 2, |V (R)| = k
k when f (H) ≥ 4
and m := |Vi| for each i ∈ [k]. By Fact 1, we have δ(R) ≥ 2
(cid:1) k when f (H) = 2, 3. Applying Lemma 5.14 with r = max{f (H), 4} where
and δ(R) ≥ 2 (cid:0) 1
µ
2 plays the role of µ, for any vertex v ∈ V (G1), we obtain a Kf (H)-embeddable structure K
such that |V (K)\Qv| ≤ 1 where Qv is as deﬁned in Lemma 5.14. Assume V (K) = {V1, . . . , V(cid:96)}.
If V (K)\Qv = ∅, then K is a subgraph of R[Qv]. Let Si := N (v) ∩ Vi for each i ∈ [(cid:96)]. Then
by the deﬁnition of Qv, we have |Si| ≥ βm ≥ N for each i ∈ [(cid:96)] since 1
k (cid:28) β. By
Lemma 3.4, (Si, Sj) is ε(cid:48)-regular with ε(cid:48) := max
β and d(Si, Sj) ≥ d(Vi, Vj) − ε for
distinct i, j ∈ [(cid:96)]. Corollary 4.7 applied on G[S1 ∪ · · · ∪ S(cid:96)] with a = 2(cid:96) − f (H) and b = f (H) − (cid:96)
gives a copy Q of Q(a, b). Note that V (Q) ⊆ N (v). Hence, v is in a copy of H.

f (H) + µ

N (cid:28) 1

n (cid:28) 1

1 − 2

2ε, ε
β

= ε

(cid:110)

(cid:111)

(cid:17)

2

Now assume V (K)\Qv = {V(cid:96)}, and thus iK(V(cid:96)) = 1. Similarly, we can choose subsets
Si ⊆ Vi ∩ N (v) as above for each i ∈ [(cid:96) − 1]. Applying Corollary 4.7 on G[S1 ∪ S2 ∪ · · · ∪ S(cid:96)−1 ∪ V(cid:96)]
with a = 2(cid:96) − f (H), b = f (H) − (cid:96) and the fact that iK(V(cid:96)) = 1, we obtain a copy Q of Q(a, b)
such that Q[V(cid:96)] is an independent set. Replacing any vertex in the independent set with v, we
conclude that v is in a copy of H.

23

References

[1] N. Alon and R. Yuster. H-factors in dense graphs. J. Combin. Theory Ser. B, 66(2):269–282,

1996.

[2] J. Balogh, T. Molla, and M. Sharifzadeh. Triangle factors of graphs without large inde-
pendent sets and of weighted graphs. Random Structures and Algorithms, 49(4):669–693,
2016.

[3] Y. Caro and Z. Tuza. Improved lower bounds on k-independence. Journal of Graph Theory,

15(01):99–107, 1991.

[4] F. Chang, J. Han, J. Kim, G. Wang, and D. Yang. Embedding clique-factors in graphs

with low l-independence number. arXiv preprint arXiv:2111.10512, 2021.

[5] O. Cooley, D. K¨uhn, and D. Osthus. Perfect packings with complete graphs minus an edge.

European Journal of Combinatorics, 28(8):2143–2155, 2007.

[6] K. Corr´adi and A. Hajnal. On the maximal number of independent circuits in graph. Acta

Mathematica Academiae Scientiarum Hungarica, 14(3-4):423–439, 1963.

[7] G. A. Dirac. Some theorems on abstract graphs. Proceedings of the London Mathematical

Society, (1):69–81, 1952.

[8] P. Erd˝os. Graph theory and probability. Canadian Journal of Mathematics, 11(3):34–38,

1996.

[9] P. Erd˝os, A. Hajnal, M. Simonovits, V. T. S´os, and E. Szemer´edi. Tur´an-Ramsey theorems
and Kp-independence numbers. Combinatorics, geometry and probability, pages 253–281,
1997.

[10] P. Erd˝os, A. Hajnal, V. T. S´os, and E. Szemer´edi. More results on Ramsey-Tur´an type

problems. Combinatorica, 3(1):69–81, 1983.

[11] P. Erd˝os and V. T. S´os. Some remarks on Ramsey’s and Tur´an’s theorem. In Combinatorial
theory and its applications, II (Proc. Colloq., Balatonf¨ured, 1969), pages 395–404, 1970.

[12] A. Hajnal and E. Szemer´edi. Proof of a conjecture of P. Erd˝os. Combinatorial theory and

its applications, 2(4):601–623, 1970.

[13] H. H`an, Y. Person, and M. Schacht. On perfect matchings in uniform hypergraphs with
large minimum vertex degree. SIAM Journal on Discrete Mathematics, 23(2):732–748,
2009.

[14] J. Han. Near perfect matchings in k-uniform hypergraphs II. SIAM Journal on Discrete

Mathematics, 30:1453–1469, 2016.

[15] J. Han. Decision problem for perfect matchings in dense k-uniform hypergraphs. Transac-

tions of the American Mathematical Society, 369(7):5197–5218, 2017.

[16] J. Han, P. Morris, G. Wang, and D. Yang. A Ramsey-Tur´an theory for tilings in graphs.

arXiv preprint arXiv:2106.09688, 2021.

[17] P. Hell and D. G. Kirkpatrick. On the complexity of general graph factor problems. SIAM

Journal on Computing, 12(3):601–609, 1983.

[18] K.-i. Kawarabayashi. K−

4 -factor in a graph. Journal of Graph Theory, 39(2):111–128, 2002.

24

[19] P. Keevash and R. Mycroft. A geometric theory for hypergraph matching. Memoirs of the

American Mathematical Society, 223(1098):vi+95, 2015.

[20] P. Keevash and R. Mycroft. A multipartite Hajnal–Szemer´edi theorem. Journal of Com-

binatorial Theory, Series B, 114:187–236, 2015.

[21] C. Knierim and P. Su. Kr-factors in graphs with low independence number. Journal of

Combinatorial Theory, Series B, 148:60–83, 2020.

[22] J. Koml´os. Tiling Tur´an theorems. Combinatorica, 20(2):203–218, 2000.

[23] J. Koml´os, G. N. S´ark¨ozy, and E. Szemer´edi. Proof of the Alon-Yuster conjecture. Discrete

Mathematics, 235(1-3):255–269, 2001.

[24] J. Koml´os and M. Simonovits. Szemer´edi’s regularity lemma and its applications in graph
theory, volume 2 of Bolyai Soc. Math. Stud. J´anos Bolyai Math. Soc., Budapest, 1996.

[25] D. K¨uhn and D. Osthus. Embedding large subgraphs into dense graphs. in surveys in

combinatorics 2009. London Math. Soc. Lecture Note Ser., 365:137–167, 2009.

[26] D. K¨uhn and D. Osthus. The minimum degree threshold for perfect graph packings. Com-

binatorica, 29(1):65–107, 2009.

[27] A. Lo and K. Markstr¨om. F -factors in hypergraphs via absorption. Graphs and Combin-

atorics, 31(3):679–712, 2015.

[28] C. Magyar and R. Martin. Tripartite version of the Corr´adi–Hajnal theorem. Discrete

Mathematics, 254(1-3):289–308, 2002.

[29] R. Martin and E. Szemer´edi. Quadripartite version of the Hajnal–Szemer´edi theorem.

Discrete Mathematics, 308(19):4337–4360, 2008.

[30] R. Nenadov and Y. Pehova. On a Ramsey–Tur´an variant of the Hajnal–Szemer´edi theorem.

SIAM Journal on Discrete Mathematics, 34(2):1001–1010, 2020.

[31] V. R¨odl, A. Ruci´nski, and E. Szemer´edi. Perfect matchings in large uniform hyper-
graphs with large minimum collective degree. Journal of Combinatorial Theory, Series
A, 116(3):613–636, 2009.

[32] A. Shokoufandeh and Y. Zhao. Proof of a tiling conjecture of Koml´os. Random Structures

Algorithms, 23(2):180–205, 2003.

[33] D. P. Sumner. Subtrees of a graph and the chromatic number. The Theory and Applications

of Graphs, pages 557–576, 1981.

[34] A. Treglown. On directed versions of the Hajnal–Szemer´edi theorem. Combinatorics, Prob-

ability and Computing, 24:873–928, 2015.

25

