9
1
0
2

r
p
A
1

]
P
A

.
t
a
t
s
[

1
v
6
1
1
1
0
.
4
0
9
1
:
v
i
X
r
a

Biometrics xx, 1–21

xxxx xxxx

DOI: 000

Gene-based Association Analysis for Bivariate Time-to-event Data through

Functional Regression with Copula Models

Yue Wei1,+, Yi Liu2,+, Wei Chen3, and Ying Ding1,∗

+: Equal contribution

∗: Corresponding author

1Department of Biostatistics, University of Pittsburgh, Pittsburgh, PA, U.S.A

2Boehringer Ingelheim, Ridgeﬁeld, CT, U.S.A

3Department of Pediatrics, Children’s Hospital of Pittsburgh, Pittsburgh, PA, U.S.A

*email: yingding@pitt.edu

Summary: Several gene-based association tests for time-to-event traits have been proposed recently, to detect

whether a gene region (containing multiple variants), as a set, is associated with the survival outcome. However,

for bivariate survival outcomes, to the best of our knowledge, there is no statistical method that can be directly

applied for gene-based association analysis. Motivated by a genetic study to discover gene regions associated with the

progression of a bilateral eye disease, Age-related Macular Degeneration (AMD), we implement a novel functional

regression method under the copula framework. Speciﬁcally, the eﬀects of variants within a gene region are modeled

through a functional linear model, which then contributes to the marginal survival functions within the copula.

Generalized score test and likelihood ratio test statistics are derived to test for the association between bivariate

survival traits and the genetic region. Extensive simulation studies are conducted to evaluate the type-I error control

and power performance of the proposed approach, with comparisons to several existing methods for a single survival

trait, as well as the marginal Cox functional regression model using the robust sandwich estimator for bivariate

survival traits. Finally, we apply our method to a large AMD study, the Age-related Eye Disease Study (AREDS),

to identify gene regions that are associated with AMD progression. The method has been implemented and added

into a newly developed R package {CopulaCenR}.
Key words: AMD progression; Bivariate time-to-event; Copula; Functional Regression; Gene-based association

analysis.

This paper has been submitted for consideration for publication in Biometrics

 
 
 
 
 
 
Gene-based Association Analysis for Bivariate Time-to-event Data through Functional Regression with Copula Models

1

1. Introduction

In genome-wide association studies (GWAS), single variant test is useful in detecting signif-

icant SNPs across the whole genome. Typically, after top loci are detected and conﬁrmed in

replication studies, regions around top variants will then be ﬁne-mapped to further evaluate

the disease loci. However, there are limitations of single variant tests. First, with each SNP

been tested individually, it may suﬀer from issues such as lack of power and multiple testing

adjustment. Secondly, the true causal SNP may not be genotyped due to the technology

or cost reason. Instead, a SNP that is close to the true causal variant is often captured.

With partial linkage disequilibrium (LD), the observed eﬀect size is likely to be smaller.

Furthermore, most statistical approaches used for single variant test focus on common

variants and can be too liberal for rare variants with low minor allele frequency (MAF).

A threshold for MAF (e.g., (cid:62) 5%) is commonly applied when performing GWAS on single

variants. To solve these problems, there has been increasing interests in developing gene-

based tests in genetic association analysis, which can usually take the LD information within

a region into account and are suitable for collapsing a set of variants with low MAF.

The statistical methods for gene-based association studies can be broadly classiﬁed as

burden tests, kernel-based association tests and functional-regression-based methods. Burden

test was ﬁrst proposed by Li and Leal (2008) for binary traits to detect association with

rare variants for common diseases. The general idea of burden test is based on collapsing

rare variants in a genetic region to a summary variable, which is then used for testing the

association with the phenotype. Han and Pan (2010) extended the burden test to the censored

time-to-event traits under Cox proportional hazards (PH) framework and Chien et al. (2017)

further developed burden test for survival traits in family-based designs. Traditional burden

test suﬀers from the lack of power when heterogeneous genetic eﬀects exist within a region,

therefore several adaptive approaches have been proposed recently. For example, Wu et al.

2

Biometrics, xxxx xxxx

(2018) proposed to use mixed-model tests to make full use of genetic correlations across

both samples and variants, and to gain power through “data-driven” weights which are

adaptive to the direction of individual variant’s eﬀect. Another popular approach is the

sequence kernel association test (SKAT), proposed by Wu et al. (2011). It is considered as a

computationally eﬃcient score test on variance component parameter to test for association

between genetic variants in a region and diﬀerent types of traits. In 2014, Chen et al. (2014)

proposed the SKAT tests for survival traits in a Cox PH regression framework. One advantage

of SKAT is that it can quickly calculate p-values by ﬁtting the null model containing only

the non-genetic covariates. A common limitation of the burden test and SKAT is the lack

of eﬀectively utilizing the LD information or in other words, correlations among genetic

variants. Fan et al. (2013) ﬁrst introduced the idea of functional regression (FR) for testing

associations between genetic variants and quantitative traits. The FR-based model treats

the eﬀect of genetic variants as an unknown function of variants’ actual physical positions

in a functional linear model (FLM) and utilizes the LD information among close variants. It

has been shown that for continuous, binary and censored traits, the FLM approach can be

more powerful than SKAT or burden test in various scenarios (Fan et al. 2013, 2014, 2016).

This work is motivated by a genetic study for Age-related Macular Degeneration (AMD)

to identify risk regions associated with AMD progression. AMD, a leading cause of blind-

ness in the developed world (Swaroop et al. 2009; The Eye Diseases Prevalence Research

Group 2004), is a bilateral and progressive neurodegenerative disease. Recently, multiple

studies have been conducted to underpin the genetic causes for disease progression where

the outcome of interest is the bivariate time-to-progression (e.g., time-to-late-AMD of the

two aﬀected eyes). For example, Sardell et al. (2016) and Ding et al. (2017) analyzed a

small set of variants on AMD progression using a Cox PH model with the robust variance

covariance estimate that takes the between-eye correlation into account. More recently, Yan

Gene-based Association Analysis for Bivariate Time-to-event Data through Functional Regression with Copula Models

3

et al. (2018) performed the ﬁrst GWAS on AMD progression using a similar robust Cox

PH model. Multiple risk loci have been identiﬁed to be associated with AMD progression.

However, in all these studies, the focus is on common variants with MAF (cid:62) 5%. In this

work, instead of evaluating the eﬀect of single (common) variants on AMD progression, we

are interested in identifying and assessing the gene regions associated with AMD progression.

To our knowledge, there has been only one attempt so far on gene-based analysis for AMD

progression, done by Fan et al. (2016). They applied the FR-based approach under the Cox

PH model by using the left eye information only, due to the lack of methods for bivariate

survival traits in gene-based analysis.

Bivariate or multivariate survival analysis has been studied for decades. Thorough reviews

with examples can be obtained from Joe (1997) and Hougaard (2000). The Copula family

is one of the earliest approaches for modeling bivariate survival data (Clayton 1978). The

idea is to model the joint distribution as a function of each marginal distribution together

with a dependence parameter. Another popular approach for correlated survival data is the

frailty model, of which the correlation is modeled through a common latent frailty variable

(Oakes 1982). The third approach is a marginal method (Wei et al. 1989) such as the robust

Cox model used in Ding et al. (2017) and Yan et al. (2018), of which the variance-covariance

matrix is estimated from a robust sandwich estimator.

In this work, we propose to develop and implement a novel gene-based association analysis

method for bivariate survival traits based on functional regression under the copula frame-

work. The paper is organized as follows. Section 2 introduces the proposed copula-based

FLM method. Section 3 presents simulation studies for evaluating type-I error control and

power performance under various settings. Section 4 demonstrates a real data analysis on

AMD progression using the proposed method, and followed by the discussion of practical

challenges and possible extensions in Section 5.

4

2. Method

Biometrics, xxxx xxxx

2.1 Copula model for bivariate time-to-event data

One of the earliest distribution families for modeling correlated bivariate measurements is

the copula family (Clayton 1978), originated from Sklar’s Theorem (Sklar 1959), in which

the joint distribution is modeled as a function of each marginal distribution together with a

dependence parameter. Assume U and V are both uniformly distributed random variables,

then a bivariate copula is a function deﬁned as {Cη : [0, 1]2 → [0, 1] : (u, v) → Cη(u, v), η ∈

R}. The parameter η in the copula function describes the dependence between U and V .

By the Sklar’s theorem (Sklar 1959), one can model the joint distribution by modeling the

dependence parameter and the marginal distributions separately. This is the unique feature

of copula functions that makes them attractive to use. The theorem is stated as: if marginal

survival functions S1(t1) = P (T1 > t1) and S2(t2) = P (T2 > t2) for T1 and T2 are continuous,

then there exists a unique copula function Cη such that for all t1 (cid:62) 0, t2 (cid:62) 0, the joint

survival function S(t1, t2) can be written as

S(t1, t2) = Cη((S1(t1), S2(t2)), t1, t2 (cid:62) 0.

(2.1)

Deﬁne the density function for Cη to be cη = ∂2Cη(u, v)/∂ u∂ v, then the joint density

function of T1 and T2 can be expressed as

f (t1, t2) = cη(S1(t1), S2(t2))f1(t1)f2(t2), t1, t2 (cid:62) 0.

In this work, we choose to use the Archimedean copula family, which is one of the most

popular copula families because of its ﬂexibility and simplicity. For example, the rank-

based dependence measurement Kendall’s τ can be directly obtained as a function of η

in Archimedean copula models. Two most frequently used Archimedean copulas in survival

analysis are:

Gene-based Association Analysis for Bivariate Time-to-event Data through Functional Regression with Copula Models

5

Clayton copula (Clayton 1978)

Cη(u, v) = (u−η + v−η − 1)−1/η, η ∈ (0, ∞),

which models the lower tail dependence in survival functions; and

Gumbel-Hougaard copula (Gumbel 1960)

Cη(u, v) = exp{−[(− log u)η + (− log v)η]1/η}, η ∈ [1, ∞),

which models the upper tail dependence in survival functions.

We consider modeling the margins S1(·) and S2(·) inside the copula function using the Cox

PH model, within which the eﬀect of a gene region (captured by multiple single variants) is

modeled through a FLM, as we describe below.

2.2 Functional Linear Model Speciﬁcation

Assume n individuals with m variants being sequenced for a gene region. Physical positions

for each variant within that region are denoted as 0 (cid:54) u1 < · · · < um (which are typically

standardized into [0, 1]). Let Gi = (gi(u1), . . . , gi(um))(cid:48), gi(uj) ∈ (0, 1, 2), i = 1, . . . , n, j =

1, . . . , m, denote the genotype information for the m variants of subject i, indicating the

number of copies of the minor allele for each of these m variants. Let

(X1i, X2i) = ((x1i1, . . . , x1ip), (x2i1, . . . , x2ip)),

denote a p × 2 matrix of bivariate covariates for subject i. Then the hazard function for the

kth margin (k = 1, 2) under the PH-FLM can be written as

λki(t) = λk0(t) exp

(cid:18)

X (cid:48)

kiβ +

(cid:90) 1

0

(cid:19)

Gi(u)γ(u)du

,

where λk0(t) is the baseline hazard function for the kth margin, β is a p × 1 vector of

coeﬃcients for the non-genetic covariates, and γ(u) is the genetic eﬀect function of the

genetic variant function Gi(u) at position u. We assume both γ(u) and Gi(u) are smooth

6

Biometrics, xxxx xxxx

functions. Then the corresponding marginal survival functions are

Ski(t) = exp(−Λki(t)) = exp

−

(cid:18)

(cid:90)

(cid:19)

λki(t)dt

(cid:18)

= exp

−

(cid:90)

λk0(t) exp

(cid:18)

X (cid:48)

kiβ +

(cid:19)

(cid:19)

Gi(u)γ(u)du

dt

, k = 1, 2.

(cid:90) 1

0

Next, we describe how we handle the two functions Gi(u) and γ(u), respectively.

2.2.1 The genetic variant function (GVF) Gi(u).

If the genotype data are of good quality

with low missing rate, we can simply use the observed genetic information to represent the

GVF directly, such as ˆGi(u) = Gi = (gi(u1), . . . , gi(um)). In this case, the elements of ˆGi(u)

take discrete values 0, 1, 2.

If the genotype data have a fairly high missing rate or equivalent, the region has only a

small number of variants being genotyped, one may consider applying an ordinary linear

square smoother (Ramsay et al. 2009) to obtain a continuous realization of Gi. Let φ(u) =

(φ1(u), . . . , φBG(u))(cid:48) be a series of basis functions (e.g, B-spline or Fourier spline basis).

Denote by Φ the m × BG matrix with elements φb(uj), b = 1, . . . , BG, j = 1, . . . , m. Then

through a linear square smoother, an estimate of the GVF can be written as

ˆGi(u) = (gi(u1)), . . . , gi(um))Φ[Φ(cid:48)Φ]−1φ(u).

(2.2)

Under the situation with missing data, we have

ˆGi(u) = (gi(u1)), . . . , gi(um(cid:48))) ˜Φ[ ˜Φ(cid:48) ˜Φ]−1φ(u),

where (gi(u1)), . . . , gi(um(cid:48))) are the observed non-missing genotypes and ˜Φ is the correspond-

ing basis matrix evaluated at the non-missing genotypes.

2.2.2 The genetic eﬀect function (GEF) γ(u). The GEF γ(u) is an unknown smooth

function with an arbitrary form that we need to estimate. To do this, one can approximate

it using a sieve approach with a linear combination of basis functions and coeﬃcients. Deﬁne

Gene-based Association Analysis for Bivariate Time-to-event Data through Functional Regression with Copula Models

7

a series of Bγ basis function by ψ(u) = (ψ1(u), . . . , ψBγ (u))(cid:48) and a Bγ × 1 vector γ =

(γ1, . . . , γBγ )(cid:48), then γ(u) can be approximated by

ˆγ(u) = (ψ1(u), . . . , ψBγ (u))(γ1, . . . , γBγ )(cid:48).

(2.3)

To test whether the variants in a region, as a set, is associated with the outcome, it is to test

whether the GEF is a zero function γ(u) = 0, which is equivalent to test the null hypothesis:

H0 : γ1 = · · · = γBγ = 0. Typically, the number of basis Bγ is much smaller than the number

of variants m in the region being tested.

2.2.3 The hazard function λ(t) under the FLM. Depending on whether or not to smooth

the GVF G(u), we propose two types of functional regression models for the hazard function.

The ﬁrst option is to smooth both G(u) and γ(u). By replacing G(u) and γ(u) with their

approximated values in (2.2) and (2.3), the hazard function for each margin can be written

as

λki(t) = λk0(t) exp

(cid:18)

X (cid:48)

kiβ + (gi(u1), . . . , gi(um))Φ[Φ(cid:48)Φ]−1γ

(cid:19)

φ(u)ψ(u)du

(2.4)

(cid:90) 1

0

= λk0(t) exp(X (cid:48)

iβ + M (cid:48)

iγ),

where M (cid:48)

i = (gi(u1), . . . , gi(um))Φ[Φ(cid:48)Φ]−1 (cid:82) 1

0 φ(u)ψ(u)du. The integral (cid:82) 1

0 φ(u)ψ(u)du can be

readily calculated using the R package {fda} (Ramsay et al. 2009) once the basis functions

are chosen.

Another option is to smooth γ(u) only. In this case, we directly replace Gi(u) by the

observed Gi = (gi(u1), ..., gi(um))(cid:48) and replace γ(u) by (2.3), which yields

λki(t) = λk0(t) exp

X (cid:48)

kiβ +

(cid:32)

(cid:34) m
(cid:88)

(gi(uj) × (ψ1(uj), . . . , ψBγ (uj))

(γ1, . . . , γBγ )(cid:48)

(2.5)

(cid:35)

(cid:33)

= λk0(t) exp(X (cid:48)

iβ + M (cid:48)

j=1
iγ),

where M (cid:48)

i = (cid:80)m

j=1 gi(uj) × (ψ1(uj), . . . , ψBγ (uj)) is a fully observed term.

8

Biometrics, xxxx xxxx

Two frequently used basis functions are B-splines and Fourier splines. The B-spline basis

(de Boor 2011) is a series of non-periodic functions with polynomial segments joint at values

called knots. The segments have speciﬁable smoothness across every breaks. Advantages of

applying the B-spline basis include its fast computation and great ﬂexibility in structure. The

Fourier splines consist of a set of periodic functions, with the basis function being Φ1(u) = 1,

Φ2r(u) = cos(2πru) and Φ2r+1(u) = sin(2πru) for a pre-speciﬁed r (de Boor 2011).

2.3 Bivariate FLM under the copula framework

Let (T1i, T2i) and (C1i, C2i) denote the bivariate survival times and censoring times for subject

i, respectively. Denote by ∆i = (∆1i, ∆2i) the corresponding censoring indicator. We consider

right censoring and assume that given covariates, (T1, T2) and (C1, C2) are independent. Then

for each subject, we observe

Di = {(Y1i, Y2i, ∆1i, ∆2i, X1i, X2i, Gi) : Yki = min(Tki, Cki), ∆ki = I(Tki (cid:54) Cki), k = 1, 2}.

Denote by θ all the parameters in S(t1, t2), then the joint likelihood for the observed data

{Di}n

i=1 can be written as

L(θ; D = (Y1, Y2, ∆1, ∆2, X1, X2, G))

n
(cid:89)

i=1
(cid:20)

−

=

×

f (y1i, y2i)δ1iδ2i ×

(cid:20)

−

∂S(y1i, y2i)
∂y1i

(cid:21)δ1i(1−δ2i)

(cid:21)(1−δ1i)δ2i

∂S(y1i, y2i)
∂y2i

× S(y1i, y2i)(1−δ1i)(1−δ2i),

(2.6)

where (δ1i, δ2i) ∈ {(0, 0), (0, 1), (1, 0), (1, 1)}. Then under the copula framework (2.1), with a

FLM for the genetic eﬀect, the joint survival function can be further written as

S(y1i, y2i) = Cη(exp

−

(cid:18)

(cid:90) y1i

0

(cid:19)

(cid:18)

λ1i(t)dt

, exp

−

(cid:19)

λ2i(t)dt

),

(cid:90) y2i

0

where λki(t) can be modeled by either (2.4) or (2.5), depending whether to smooth the GVF

Gi(u) or not.

Gene-based Association Analysis for Bivariate Time-to-event Data through Functional Regression with Copula Models

9

2.3.1 Generalized score test. We are interested in testing whether a gene region is as-

sociated with the disease progression, after adjusting for other risk factors. To accomplish

this, we separate the entire parameter θ into two parts: θ1, the parameter of interest; and

θ2, the nuisance parameter. Under the bivariate FLM-based copula model, we have θ1 = γ,

which is the gene/region eﬀect, and θ2 = (β, η, λ10, λ20) contains the rest of parameters in

the likelihood. Then the null hypothesis can be formulated as

H0 : θ1 = (γ1, . . . , γBγ )(cid:48) = 0 and θ2 is arbitrary.

(2.7)

In GWAS, score test is typically preferred than other likelihood-based tests due to its

computational advantage. This is because only one null model (without any SNP) needs to

be ﬁtted for the score test. We now describe the generalized score test under the FLM-based

copula framework for testing (2.7).

Assume ˆθ0 = (θ1 = 0, θ2 = ˆθ20) is the restricted maximum likelihood estimate (MLE)

of θ under the restriction of θ1 = 0, solved from the joint likelihood under (2.6), then the

corresponding score function is

U (ˆθ0) =

∂
∂θ

(cid:12)
(cid:12)
log L(θ; D)
(cid:12)
(cid:12)θ=ˆθ0

= (U (cid:48)

1(ˆθ0), U (cid:48)

2(ˆθ0))(cid:48) = (U (cid:48)

1(ˆθ0), 0(cid:48))(cid:48),

where Ul(·) = ∂ log L/∂θl, l = 1, 2, and the Fisher’s information is

I(ˆθ0) = −E

(cid:20) ∂2
∂θT ∂θ

log L(θ; D)

(cid:21)(cid:12)
(cid:12)
(cid:12)
(cid:12)θ=ˆθ0







I11(ˆθ0) I12(ˆθ0)

 ,
I21(ˆθ0) I22(ˆθ0)

=

with I11, I12, I21 and I22 being partitions of the information matrix I by θ1 and θ2.

Finally, by using the observed information matrix J (ˆθ0) (J (θ) = − ∂2 log L(θ;D)

∂θ(cid:48)∂θ

) to approx-

imate I(ˆθ0), the generalized score statistic for testing (2.7) can be constructed as follows

Qs = U (cid:48)

1(ˆθ0)J 11(ˆθ0)U1(ˆθ0),

where U (cid:48)

1(ˆθ0) is a Bγ × 1 vector and J 11 = (J −1)11 = (J11 − J12J −1

22 J21)−1 is a Bγ × Bγ

matrix.

10

Biometrics, xxxx xxxx

We can use similar numerical approximation techniques as proposed in Sun et al. (2019),

such as using the Richardson’s extrapolation to approximate the score function and observed

information matrix. The score test statistic asymptotically follows a χ2 distribution with Bγ

degrees of freedom under the null.

2.3.2 Likelihood ratio test. Diﬀerent from the GWAS case, where the computational

eﬃciency is a key factor for deciding the test procedure, we have a lot less number of tests

in the gene-based test situation (∼ 20K genes vs millions of variants in GWAS). Therefore,

an alternative approach to the generalized score test is to perform the likelihood ratio test

(LRT). Speciﬁcally, the LRT statistic can be written as

Ql = −2(log L(ˆθ0) − log L(ˆθ)),

where L(ˆθ) is the the unrestricted maximum likelihood value of the joint likelihood and

L(ˆθ0) is the restricted maximum likelihood under H0. Ql also asymptotically follows a χ2

distribution with degrees of freedom Bγ.

3. Simulation Study

In this section, we performed simulation studies to evaluate the performance of the proposed

method in terms of type-I error control and power. Two scenarios were considered: (1) a

mixture of common (MAF> 5%) and rare causal variants (MAF∈ [1%, 5%]); (2) all causal

variants are rare (MAF ∈ [1%, 5%]). We reported the results of copula-based functional

regression model using score test (Cop-Score) and LRT (Cop-LRT), and compared with the

following methods: (a) FLM under Cox PH assuming the bivariate traits are independent

(Cox-Ind), or (b) using the “robust sandwich estimator” for the variance-covariance matrix

(Cox-Rst), (c) univariate FLM under Cox PH (Cox-FLM), (d) Burden test, and (e) SKAT

test. The last two methods are from R package {seqMeta} (Voorman et al. 2016). To evaluate

Gene-based Association Analysis for Bivariate Time-to-event Data through Functional Regression with Copula Models

11

the performance of univariate methods (c)-(e), only one margin (left eye) from simulated data

was used.

3.1 Data generation

In our simulation, 100 genotype datasets, each with a sample size 1000 were simulated.

For each genotype set, 1000 phenotype datasets of bivariate survival times and one non-

genetic covariate were generated, which lead to a total of 100,000 datasets. Similar simulation

approach was used in Chen et al. (2014), which has been shown to produce valid comparisons

between methods.

Genetic data were generated from European ancestry of 10,000 haplotypes covering 1Mb

regions, simulated by Yun Li at the University of North Carolina (Fan et al. 2016). Calibrated

coalescent model as programmed in COSI was used to generate the haplotypes with linkage

disequilibrium (LD) information (Schaﬀner et al. 2005). With 10,000 haplotypes, we chose a

genetic region of length 6 Kb and 30 Kb for all and rare only variants scenarios, respectively.

For both scenarios, the regions contain around 20 variants. A random mating technical was

then applied to generate genetic information for 1000 subjects.

Bivariate time-to-event phenotypes were generated from a Clayton Weibull model as fol-

lows. Recall that under a copula model S(t1, t2) = Cη(S1(t1), S2(t2)), U = S1(T1), V = S2(T2)

each follows a uniform distribution U [0, 1]. Deﬁne Wv(u) = h(u, v) = P (U (cid:54) u|V =

v) = ∂Cη(u, v)/∂v. First, we generated vi and wi from two independent standard uniform

distributions. Then let wi = h(ui, vi)(= Cη(ui, vi)/∂vi) and solve for ui from the inverse

function h−1. Finally, we obtained two survival times t1i and t2i from S−1

1 (ui) and S−1

2 (vi)

respectively. The scale and shape parameters in the baseline Weibull distribution were set to

be λ = 0.1 and k = 2, same for both margins. For Clayton copula, the dependence strength

is determined by Kendall’s τ . Here we chose τ = 0.05, 0.4 and 0.8 to represent weak to strong

dependence between two marginal survivals. Censoring times c1i and c2i were generated from

12

Biometrics, xxxx xxxx

uniform distribution U (0, C) with C chosen to yield a 50% censoring rate. The non-genetic

covariate Xng,k(k = 1, 2) was generated from N (6, 22).

For type-I error control simulations, we assumed there is neither a genetic eﬀect (γ(u) =

0) nor a non-genetic eﬀect (β = 0). The type-I error was evaluated at various α levels:

0.05, 0.01, 10−3 and 10−4, respectively. For power analysis, we generated data to evaluate

both homogeneous genetic eﬀects (genes with eﬀects in the same direction) and heterogeneous

genetic eﬀects (genes with eﬀects in opposite directions). Similar as in (Fan et al. 2016), the

eﬀect size for each causal variant (i.e., γ(u)) was chosen to be a constant that depends on

MAF: c |log10M AF |

2

, where c = 0.4, 0.3, 0.25 for scenarios with 10%, 20% and 30% of causal

variants in a given region, respectively.

3.2 Type-I error

We chose B-splines with 5 basis for all FLM methods. Table 1 presents the type-I error results

for the scenario with both common and rare variants. As expected, the independent Cox FLM

(Cox-Ind) yields inﬂated type-I errors and the inﬂation becomes more severe when data

are more dependent. With robust variance-covariance estimates, Cox-Rst still shows some

inﬂation in type-I error, especially under small α tail. Similar observations were found in

testing single variants with bivariate survival outcomes (Sun et al. 2019). Within the copula-

based FLM, both the score test (Cop-Score) and LRT (Cop-LRT) produce satisfactory-

controlled type- I errors.

[Table 1 about here.]

Table 2 presents the type-I error results for testing regions that contain only rare variants

(MAF ∈ [1%, 5%]). The overall performance is similar to the all variants scenario. The

inﬂation in the robust Cox model (Cox-Rst) is slightly more compared to the all variants

scenario, which is also consistent with the observation in Sun et al. (2019).

Gene-based Association Analysis for Bivariate Time-to-event Data through Functional Regression with Copula Models

13

[Table 2 about here.]

3.3 Empirical power

[Figure 1 about here.]

Figure 1 illustrates the power bars over diﬀerent dependence levels and genetic eﬀect sizes

for the mixture of common and rare variants scenario. Given the independent Cox model

cannot control type-I error at all, we did not include it in the power analysis. Overall, the

bivariate approaches produce higher power than any univariate approach. When the two

margins are highly dependent, the copula-based tests achieve higher power than the Cox-

Rst method. In general, the score and LRT tests provide similar results, which is as expected.

We also notice that, when there are heterogeneous genetic eﬀects in a region (the bottom

panel), the power of burden test drops signiﬁcantly.

Figure 2 shows the power analysis for the rare variants only scenario. It can be seen that

when only rare variants are considered, the univariate Cox FLM model (CoxFLM) does not

perform well as compared to other univariate methods, which is diﬀerent from the case when

all variants are included. In contrast, SKAT maintains relatively high power for both cases of

homogeneous and heterogeneous genetic eﬀects. Burden test shows comparable results when

the genetic eﬀects are homogeneous, and the power drops when the eﬀects are heterogeneous.

As for the bivariate methods, Cox-Rst model performs well when the dependence between

two margins is weak, but as the dependence increases, the power tends to decrease. Overall,

our copula-based bivariate methods achieve high power in all the scenarios.

[Figure 2 about here.]

14

Biometrics, xxxx xxxx

4. Application on AREDS data

4.1 Examination on the Reported Four Regions from Previous Publications

AREDS is a major clinical trial sponsored by the National Eye Institute to study the risk

factors for AMD progression (Age-Related Eye Disease Study Research Group 1999). The

bilateral nature makes it a perfect example for the demonstration of our proposed methods.

Over the past few years, many case-control GWAS studies have identiﬁed multiple SNPs

associated with AMD susceptibility (Chen et al. 2010; Fritsche et al. 2013, 2016) and

recent genetic studies on AMD progression identiﬁed SNPs that are associated with disease

progression (Ding et al. 2017; Yan et al. 2018). Table 3 presents top four genetic regions

which contain SNPs associated with AMD risk identiﬁed by the traditional single-marker

GWAS in Fritsche et al. (2016). These four regions were also reported to be top gene regions

containing variants associated with AMD progression in Yan et al. (2018). Therefore, we ﬁrst

examined these four candidate regions speciﬁcally. Location of gene regions were extracted

based on GRCh37/hg19 assembly from UCSC Genome Browser. Variants within +/ − 5Kb

of the region boundary were included in the analysis.

We included all Caucasian participants with neither eye progressed at the time of enroll-

ment into the study. For bivariate approaches, time-to-progression was calculated for each

eye of each patient. For univariate approaches, only left-eye data were used. A total of 2296

subjects were included in the analysis. The baseline age and disease severity score (on a

continuous scale ranging from 1 to 8) were included in the regression part of the model as

the non-genetic risk factors.

[Table 3 about here.]

We ﬁtted a Clayton copula with Weibull margins to perform the gene-based analysis. B-

spline was used to smooth the genetic eﬀect function. The number of basis is usually decided

based upon the sample size (or equivalently, the total number of events in survival analysis)

Gene-based Association Analysis for Bivariate Time-to-event Data through Functional Regression with Copula Models

15

or through cross validations. In our analysis, we examined three diﬀerent number of bases:

5, 6 and 7. A mixture of common (MAF> 5%) and rare causal variants (MAF∈ [1%, 5%])

were tested. Similar to the simulation studies, we compared our proposed copula-based FLM

score test to the Cox robust model, the univariate Cox FLM, SKAT and burden test. Since

the copula-based FLM LRT has shown virtually identical results to the score test in the

simulations, we did not include it here.

Table 4 presents p-values of testing the four candidate gene regions that contain both

common and rare variants. The bivariate approaches, i.e., copula-based FLM (Cop-Score)

and robust Cox (Cox-Rst) identify CFH, C2-CFB-SKIV2L and ARMS2 regions at the

signiﬁcance level of 0.05, with smaller p-values produced from Cop-Score. For the C3 region,

both bivariate methods have shown marginal signiﬁcance. Due to ignoring data from the

right eye, none of the univariate approaches identiﬁes all four gene regions, with the best

case scenario, SKAT, identifying three gene regions except the ARMS2 region. The univariate

Cox-FLM identiﬁes two gene regions: CFH and ARMS2, while the burden test only shows

that CFH is signiﬁcant. Note that for the three approaches that involve FLM, varying the

number of basis from 5 to 7 produces similar results in this data set.

Figure 3 presents the estimated genetic eﬀect functions for the four gene regions under the

six B-spline bases scenario. The CFH shows the largest eﬀect size with most of the positions

having a negative eﬀect, and it explains the smallest p-values obtained from the FLM based

methods for this region. Since most of the eﬀects seem to be homogeneous in the CFH region,

the burden test maintains the power by providing a p-value as small as 7.11×10−4. For other

regions, they all show heterogeneous eﬀects with some positions having positive eﬀects while

others having negative eﬀects, so the burden test loses power under these situations. The

ARMS2 and C2 regions both show reasonable amount of eﬀects and thus the copula-based

16

Biometrics, xxxx xxxx

FLM method has detected these two regions to be signiﬁcant. The ﬂat curve presented by

the C3 region also explains the marginal signiﬁcance from the copula-FLM approach.

[Table 4 about here.]

[Figure 3 about here.]

4.2 Genome-wide Association Study

We then applied the copula-based model on the whole genome to search for top gene regions

that are associated with the AMD progression. Again, all gene regions were extracted based

on GRCh37/hg19 assembly from UCSC Genome Browser and those with less than 10 SNPs

were excluded from the analysis. In total we analyzed 22,747 gene regions.

Table 5 presents p-values of top gene regions identiﬁed by the proposed copula-FLM

approach, at the α level of 1.0 × 10−5. All methods have generated consistent p-values for

these regions, with copula-FLM producing the smallest p-values. The last column presents

the number of signiﬁcant SNPs identiﬁed by the traditional single-SNP-based clayton copula

model under the nominal α level of 0.05. In addition to the CFH and ARMS2 regions,

DLGAP2-AS1, GABRA5, CLEC4GP1 and HAL-C regions all have more than 30% of the

SNPs to be associated with the AMD progression in a less stringent sense, which explains

the reason why they were not among the top genes list in the single-SNP-based GWAS

studies but were identiﬁed in a gene-based analysis. Among these gene regions, gene HLA-C

has been shown to have association with AMD in combination with inhibitory Killer-cell

immunoglobulin-like receptors on natural killer (NK) cells (Goverdhan et al. 2005).

[Table 5 about here.]

5. Conclusion and Discussion

In this work, we have developed a new gene-based association analysis method for bivari-

ate time-to-event data using the functional linear model under the copula framework. We

Gene-based Association Analysis for Bivariate Time-to-event Data through Functional Regression with Copula Models

17

implemented our proposed methods in R. The key functions can be found in the GitHub

https://github.com/yingding99/CopulaFLM. This approach has also been added to a newly

developed R package {CopulaCenR}. On one hand, the genetic eﬀect can be viewed as a

function of the physical positions of variants under the functional linear model. On the

other hand, the copula model can eﬀectively handle the correlation between two margins.

Combining the FLM with the copula framework fully takes the advantage of both methods

for detecting gene regions that are signiﬁcantly associated with the progression of bilateral

diseases. The great advantage of the proposed copula-FLM model is that the genetic ef-

fects are treated as a function of the physical positions of the variants. Therefore, the LD

information can be directly taken account in this method.

Extensive simulation studies were performed to evaluate the type-I error rates and power

performance of our method. Both the score test and the LRT from our copula FLM model

control type-I error well. For the power analysis, our bivariate tests show great advantage

by utilizing all available data without collapsing them into the subject level.

We successfully applied our method on AREDS data at four known AMD risk gene

regions and obtained consistent ﬁndings. Through the genome-wide study, nine gene regions

were found to be signiﬁcantly associated with the disease progression, where PCDH9-AS4,

DLGAP2-AS1, LINC00476, GABRA5, CLEC4GP1, HLA-C and SULF1 are novel regions.

The ﬁndings from this research provide new perspectives on the genetic underpinning of

AMD progression, which will be valuable to establish novel and reliable predictive models

for AMD progression. The proposed method is useful for genome-wide association studies of

any bilateral disease with survival traits to identify disease susceptible gene regions.

Acknowledgements

This research is supported by the National Institute of Health (EY024226). We would

like to thank the participants in the AREDS study, who made this research possible, and

18

Biometrics, xxxx xxxx

International AMD Genomics Consortium for generating the genetic data and performing

quality check.

References

Age-Related Eye Disease Study Research Group (1999). The age-related eye disease study

(areds): design implications. areds report no. 1. Control Clinical Trials 20, 573–600.

Chen, H., Lumley, T., Brody, J., Heard-Costa, N. L., Fox, C. S., Cupples, L. A., and Dupuis,

J. (2014). Sequence kernel association test for survival traits. Genet Epidemiol 38,

191–197.

Chen, W., Stambolian, D., Edwards, A. O., Branham, K. E., Othman, M., and al., J. J.

(2010). Genetic variants near timp3 and high-density lipoproteinassociated loci inﬂuence

susceptibility to age-related macular degeneration. PNAS 107, 7401–7406.

Chien, L.-C., Bowden, D., and Chiu, Y.-F. (2017). Region-based association tests for

sequencing data on survival traits. Genetic epidemiology 41, 511–522.

Clayton, D. G. (1978). A model for association in bivariate life tables and its application in

epidemiological studies of familial tendency in chronic disease incidence. Biometrika 65,

141–151.

de Boor, C. (2011). A Practical Guide to Splines (Applied Mathematical Sciences). Springer.

Ding, Y., Liu, Y., Yan, Q., Fritsche, L. G., Cook, R. J., Clemons, T., Ratnapriya, R., Klein,

M. L., Abecasis, G. R., Swaroop, A., Chew, E. Y., Weeks, D. E., and Chen, W. (2017).

Bivariate analysis of age-related macular degeneration progression using genetic risk

scores. Genetics 206, 119–133.

Fan, R., Wang, Y., Mills, J. L., Carter, T. C., Lobach, I., Wilson, A. F., Bailey-Wilson,

J. E., Weeks, D. E., , and Xiong, M. (2014). Generalized functional linear models for

case-control association studies. Genet Epidemiol 38, 622–637.

Fan, R., Wang, Y., Mills, J. L., Wilson, A. F., Bailey-Wilson, J. E., , and Xiong, M. (2013).

Gene-based Association Analysis for Bivariate Time-to-event Data through Functional Regression with Copula Models

19

Functional linear models for association analysis of quantitative traits. Genet Epidemiol

37, 726 – 742.

Fan, R., Wang, Y., Yan, Q., Ding, Y., Weeks, D., Lu, Z., Ren, H., Cook, R. J., Xiong, M.,

Swaroop, A., Chew, E. Y., , and Chen, W. (2016). Gene-based association analysis for

censored traits via ﬁxed eﬀect functional regressions. Genet Epidemiol 40, 133–143.

Fritsche, L. G., Chen, W., and et al., M. S. (2013). Seven new loci associated with age-related

macular degeneration. Nature Genetics 45, 433–439.

Fritsche, L. G., Igl, W., Baileyet, J. N. C., et al. (2016). A large genome-wide association

study of age-related macular degeneration highlights contributions of rare and common

variants. Nature Genetics 48, 134–143.

Goverdhan, S. V., Howell, M. W., Mullins, R. F., Osmond, C., Hodgkins, P. R., Self, J.,

Avery, K., and Lotery, A. J. (2005). Association of hla class i and class ii polymorphisms

with age-related macular degeneration. Investigative Ophthalmology & Visual Science

46, 1726–1734.

Gumbel, E. J. (1960). Bivariate exponential distributions. Journal of the American Statistical

Association 55, 698–707.

Han, F. and Pan, W. (2010). A data-adaptive sum test for disease association with multiple

common or rare variants. Human Heredity 70, 537–545.

Hougaard, P. (2000). Analysis of Multivariate Survival Data. Springer New York.

Joe, H. (1997). Multivariate models and dependence concepts. Chapman & Hall.

Li, B. and Leal, S. M. (2008). Methods for detecting associations with rare variants for

common diseases: Application to analysis of sequence data. American Journal of Human

Genetics 83, 311–321.

Oakes, D. (1982). A model for association in bivariate survival data. Journal of the Royal

Statistical Society. Series B 44, 414–422.

20

Biometrics, xxxx xxxx

Ramsay, J. O., Hooker, G., and Graves, S. (2009). Functional Data Analysis With R and

Matlab. Springer New York.

Sardell, R. J., Persad, P. J., Pan, S. S., and et al., P. W. (2016). Progression rate from

intermediate to advanced Age-Related Macular Degeneration is correlated with the

wumber of risk alleles at the CFH locus. Invest Ophthalmol Vis Sci 57, 6107–6115.

Schaﬀner, S. F., Foo, C., Gabriel1, S., Reich, D., Daly1, M. J., and Altshuler, D. (2005).

Calibrating a coalescent simulation of human genome sequence variation. Genome Res

15, 1576–1583.

Sklar, A. (1959). Fonctions de repartition a n dimensions et leurs marges. Publications de L

Institut de Statistique de L Universite de Paris 8, 229–231.

Sun, T., Liu, Y., J. Cook, R., Chen, W., and Ding, Y. (2019). Copula-based score test for

bivariate time-to-event data, with application to a genetic study of amd progression.

Lifetime Data Analysis .

Swaroop, A., Chew, E. Y., Abecasis, G. R., et al. (2009). Unraveling a multifactorial late-

onset disease: from genetic susceptibility to disease mechanisms for age-related macular

degeneration. Annual review of genomics and human genetics 10, 19–43.

The Eye Diseases Prevalence Research Group (2004). Causes and Prevalence of Visual

Impairment Among Adults in the United States. Archives of Ophthalmology 122, 477–

485.

Voorman, A., Brody, J., Chen, H., Lumley, T., and Davis, B. (2016). cluster: Meta-Analysis

of Region-Based Tests of Rare DNA Variants.

Wei, L. J., Lin, D., and Weissfeld, L. (1989). Regression analysis of multivariate incomplete

failure time data by modeling marginal distributions. Journal of the American Statistical

Association 84, 1065–1073.

Wu, M. C., Lee, S., Cai, T., Li, Y., Boehnke, M., , and Lin, X. (2011). Rare-variant association

Gene-based Association Analysis for Bivariate Time-to-event Data through Functional Regression with Copula Models

21

testing for sequencing data with the sequence kernel association test. Am J Hum Genet

89, 82–93.

Wu, X., Guan, T., Liu, D. J., Novelo, L. G. L., and Bandyopadhyay, D. (2018). Adaptive-

weight burden test for associations between quantitative traits and genotype data with

complex correlations. Annals of Applied Statistics 12, 1558–1582.

Yan, Q., Ding, Y., Liu, Y., Sun, T., Fritsche, L. G., Clemons, T., Ratnapriya, R., Klein,

M. L., Cook, R. J., Liu, Y., Fan, R., Wei, L., Abecasis, G. R., Swaroop, A., Chew,

E. Y., Group, A. R., Weeks, D. E., and Chen, W. (2018). Genome-wide analysis of

disease progression in age-related macular degeneration. Human Molecular Genetics 27,

929–940.

22

Biometrics, xxxx xxxx

Figure 1. Empirical power analysis for 1000 gene regions that contain both common and
rare variants at various dependence strength levels

Gene-based Association Analysis for Bivariate Time-to-event Data through Functional Regression with Copula Models

23

Figure 2. Empirical power analysis for 1000 gene regions that contain only rare variants
at various dependence strength levels

24

Biometrics, xxxx xxxx

Figure 3. Estimated genetic eﬀect functions for four candidate gene regions from the
copula-FLM approach with six number of B-spline basis

Gene-based Association Analysis for Bivariate Time-to-event Data through Functional Regression with Copula Models

25

Table 1
Type-I error at various dependence levels from Clayton copula with Weibull margins for testing gene regions that
contain both common and rare variants.
Bivariate FLM

τ

0.05

0.4

0.8

α level Cop-Score Cop-LRT Cox-Ind Cox-Rst
0.05
0.01
0.001
0.0001
0.05
0.01
0.001
0.0001
0.05
0.01
0.001
0.0001

0.0673
0.0152
0.0020
0.00033
0.2119
0.0832
0.0214
0.00521
0.3293
0.1644
0.0594
0.02103

0.0626
0.0150
0.0022
0.00047
0.0653
0.0162
0.0025
0.00047
0.0628
0.0159
0.0021
0.00042

0.0547
0.0114
0.0014
0.00015
0.0527
0.0105
0.0011
0.00015
0.0534
0.0110
0.0011
0.00012

0.0524
0.0102
0.0012
0.00010
0.0522
0.0103
0.0011
0.00012
0.0521
0.0105
0.0011
0.00014

Univariate
CoxFLM Burden SKAT
0.0494
0.0492
0.0523
0.0099
0.0105
0.0104
0.0012
0.0010
0.0012
0.00009
0.00010
0.00018
0.0504
0.0495
0.0515
0.0099
0.0099
0.0104
0.0011
0.0010
0.0012
0.00009
0.00012
0.00010
0.0511
0.0500
0.0526
0.0101
0.0097
0.0107
0.0012
0.0011
0.0010
0.00013
0.00012
0.00010

26

Biometrics, xxxx xxxx

Table 2
Type-I error at various association levels from the Clayton copula with Weibull margins for testing gene regions that
contain only rare variants.

Bivariate FLM

τ

0.05

0.4

0.8

α level Cop-Score Cop-LRT Cox-Ind Cox-Rst
0.05
0.01
0.001
0.0001
0.05
0.01
0.001
0.0001
0.05
0.01
0.001
0.0001

0.0690
0.0160
0.0021
0.00030
0.2151
0.0855
0.0226
0.00628
0.3305
0.1671
0.0609
0.02122

0.0677
0.0175
0.0035
0.00135
0.0674
0.0173
0.0032
0.00063
0.0646
0.0151
0.0022
0.00035

0.0539
0.0115
0.0011
0.00014
0.0541
0.0113
0.0013
0.00012
0.0534
0.0110
0.0011
0.00012

0.0540
0.0118
0.0011
0.00011
0.0537
0.0110
0.0012
0.00012
0.0517
0.0101
0.0010
0.00006

Univariate
CoxFLM Burden SKAT
0.0490
0.0500
0.0516
0.0094
0.0099
0.0105
0.0009
0.0010
0.0010
0.00010
0.00009
0.00010
0.0499
0.0505
0.0521
0.0099
0.0101
0.0110
0.0008
0.0011
0.0011
0.00014
0.00011
0.00010
0.0502
0.0502
0.0519
0.0103
0.0104
0.0112
0.00091
0.0010
0.0012
0.00010
0.00008
0.0001

Gene-based Association Analysis for Bivariate Time-to-event Data through Functional Regression with Copula Models

27

Table 3
Four candidate gene regions from published single variant case-control GWAS AMD studies

Chr
Region
CFH
1
C2-CFB-SKIV2L 6
10
ARMS2 regions*
19
C3
* PLEKHA1,MIR3941,ARMS2,HTRA1

StartPos** EndPos**
196,621,008
31,65,562
124,134,094
6,677,715

196,716,634
31,937,532
124,274,424
6,730,573

Number of SNPs
281
250
541
294

** Actural regions are selected with reference start and end pos +/ − 5K (hg19)

28

Biometrics, xxxx xxxx

Table 4
Results from diﬀerent gene-based tests on four candidate regions (including both common and rare variants) using
the AREDS data

Chr basis # Cop-Score

Bivariate FLM

Gene

CFH

1

C2-CFB-SKIV2L 6

ARMS2 regions

10

C3

19

5
6
7
5
6
7
5
6
7
5
6
7

6.79 × 10−10
9.93 × 10−10
3.24 × 10−9
2.02 × 10−3
3.74 × 10−3
6.81 × 10−3
5.40 × 10−4
8.06 × 10−4
4.81 × 10−5
0.05
0.05
0.10

Cox-Rst
1.05 × 10−7
1.43 × 10−7
3.56 × 10−7
8.17 × 10−3
0.01
0.02
0.01
0.01
5.91 × 10−3
0.03
0.04
0.06

CoxFLM
3.82 × 10−4
4.14 × 10−4
8.14 × 10−4
0.13
0.19
0.23
0.03
0.03
0.01
0.14
0.15
0.24

Univariate
Burden

SKAT

7.11 × 10−4

0.01

0.43

0.02

0.88

0.19

0.77

1.37 × 10−3

Gene-based Association Analysis for Bivariate Time-to-event Data through Functional Regression with Copula Models

29

Table 5
Top gene regions identiﬁed by GWAS on AREDS data using the copula-FLM approach

Gene
CFH
PCDH9-AS4
DLGAP2-AS1
ARMS2
LINC00476
GABRA5
CLEC4GP1
HLA-C
SULF1
* based on 0.05 alpha level

Chr # of SNPs Cop-Score
1
13
8
10
9
15
19
6
8

9.93 × 10−10
6.64 × 10−8
8.40 × 10−7
2.07 × 10−6
2.23 × 10−6
2.59 × 10−6
3.23 × 10−6
3.12 × 10−6
8.72 × 10−6

281
55
336
51
201
168
75
574
563

Cox-Rst
1.43 × 10−7
4.21 × 10−4
7.53 × 10−6
1.37 × 10−3
3.41 × 10−5
7.75 × 10−6
2.60 × 10−4
3.85 × 10−4
4.91 × 10−5

CoxFLM
4.14 × 10−4
3.85 × 10−3
2.14 × 10−5
1.91 × 10−2
2.52 × 10−2
6.18 × 10−4
4.61 × 10−4
8.06 × 10−4
1.40 × 10−3

# of Sig. SNP (%)*
186 (66.2)
9 (16.4)
229 (68.2)
33 (64.7)
57 (28.4)
68 (40.5)
30 (40.0)
187 (32.6)
75 (13.3)

