0
2
0
2

l
u
J

0
2

]
P
S
.
s
s
e
e
[

1
v
9
2
8
9
0
.
7
0
0
2
:
v
i
X
r
a

IEEE

1

Wireless Performance Evaluation of Building

Layouts: Closed-Form Computation

of Figures of Merit

Jiliang Zhang, Senior Member IEEE, Andr´es Alay´on Glazunov, Senior Member

IEEE, and Jie Zhang, Senior Member IEEE

Abstract

This paper presents a part of our ground-breaking work on evaluation of buildings in terms of

wireless friendliness in the building-design stage. The main goal is to devise construction practices that

provide for a good performance of wireless networks deployed in buildings. In this paper, the interference

gain (IG) and power gain (PG) are deﬁned as two ﬁgures of merit (FoM) of the wireless performance of

buildings. The FoMs bridge the gap between building design and wireless communications industries. An

approach to derive exact closed-form equations for these FoMs is proposed for the ﬁrst time. The derived

analytic expressions facilitate straightforward and more computationally efﬁcient numerical evaluation of

the proposed FoMs as compared to Monte Carlo simulations for well-known indoor propagation models.

It is shown that the derived closed-form expression can be readily employed to evaluate the impact of

building properties, such as the sizes and the aspect ratios (ARs) of rooms, on the wireless performance.

The proposed approach sheds light to architects on evaluation and design of wireless-friendly building

layouts.

Index Terms

Smart buildings, building design, wireless performance evaluation, 5G networks.

Jiliang Zhang is with the Department of Electronic and Electrical Engineering, The University of Shefﬁeld, Shefﬁeld, UK.

Andr´es Alay´on Glazunov is with Department of Electrical Engineering, University of Twente, Enschede, Overijssel, Netherlands,

and also with Department of Electrical Engineering, Chalmers University of Technology, Gothenburg, Sweden. Jie Zhang is

with the Department of Electronic and Electrical Engineering, the University of Shefﬁeld, Shefﬁeld, UK, and also with Ranplan

Wireless Network Design Ltd., Cambridge, UK.

The research is funded by EUROSTARS Project BuildWise (11088).

 
 
 
 
 
 
IEEE

2

I. INTRODUCTION

It has been predicted that mobile trafﬁc will increase by up to 1000 times in the next decade,

with over 80% of mobile trafﬁc taking place indoors [1]. 6G systems will meet the required

mobile trafﬁc through the combined effects of densiﬁcation of the wireless network through

small cells and the large-scale deployment of massive multiple-input multiple-output (MIMO)

array antennas [2]. The large number of small cells are anticipated to enhance coverage and

spectral efﬁciency [3]–[9], whereas in massive MIMO, array antennas are scaled up to increase

reliability and spectral efﬁciency [10]–[13]. On the other hand, wireless communication plays

an important role in the realization of the “smart building” paradigm, or more broadly, in the

“smart city” vision [14]. Different types of buildings have an intrinsic wireless performance

which is independent of how densely small cells are deployed, or the massive MIMO array

antenna deployed [15], [16]. The present work is the ﬁrst step towards providing guidance, to

both civil engineers and architects, on incorporating the wireless performance of buildings at the

design stage.

Building design and construction has mainly focused on improving safety, visual and thermal

comfort, and indoor air quality [17]. In the last decade, energy efﬁciency became an important

metric in building design tools [18]. The operational energy required by a building can be

evaluated by taking into account the lighting, the heating, the ventilation and the cooling as

well as the provision of hot water [19]. At present, mobile operators are already among the top

energy consumers [20], and an increasing trend of power consumption of wireless networks can

be observed in different generations of wireless systems [21], [22]. Therefore, the energy saving

is worthwhile to be considered in the design of green buildings. However, the indoor power

consumption of wireless networks has not been considered.

One important factor impacting the power consumption in small-cell networks is the building-

blockage. In [23]–[25], the LOS probability is analytically and empirically modelled. In [26], an

analytic expression for the coverage rate is provided by approximating the line-of-sight (LOS)

region as a ﬁxed LOS ball. In [27], four random wall generation methods to place blockage

objects in an indoor scenario were proposed and analyzed, where walls are either distributed

randomly, semi-deterministically or heuristically. However, previous evaluations of the blockage

effect proposed that buildings form a random process of shapes. The LOS probability was there

assumed to be irrelevant for different directions of the link. This model seems to be promising in

IEEE

3

providing insights on the conﬁguration of a wireless network in a homogeneous indoor scenario,

where walls are assumed to be uniformly distributed in a building. However, in speciﬁc building

designs, whether a wireless link is blocked by structures not only depends on the distance

between the transmitter and the receiver, but also on their relative position and direction in the

ﬂoor plan of the building. That is, the blockage condition of the wireless signal depends on

the considered direction. Therefore, the homogeneous assumption is not suitable for evaluating

speciﬁc building designs.

Rather than random blockages, ray-tracing/ray-launching techniques are employed to evaluate

the indoor performance of wireless networks (i.e., for users located indoors) for speciﬁc building

designs in [28]–[34]. However, results attained through this approach are only valid for a

speciﬁc network deployment, and are not general enough to evaluate the wireless performance

of buildings, where all possible positions of transmitters and receivers in the building under

design are needed to be evaluated. In this case, ray-tracing/ray-launching techniques become

computationally expensive, and therefore it is not practical to evaluate the wireless performance

of a building layout in a reasonable time.

Moreover, wireless networks are traditionally designed and deployed when the buildings have

been built. Before the networks are deployed, wireless communications engineers have to carry

out ray-tracing/ray-launching based simulations for speciﬁc deployments of wireless networks. In

other words, wireless communications engineers adapt a network to suit its deployment scenarios

without modifying any property of the building layout. However, for an existing building with

a speciﬁc intrinsic wireless performance determined by the building layout, the indoor wireless

networks may not achieve an acceptable performance regardless how densely small cells or

MIMO array antenna elements are deployed. The wireless performance of building layout has to

be taken into account carefully in the building design stage, which means that building designers,

both civil engineers and architects, requires guidance on how to predict and evaluate the wireless

performance of a building under design.

Taking wireless performance of buildings into account will become indispensable for the

design of future smart buildings in which appliances and many other devices and “things” will

all be connected wirelessly. To address the challenges posed by the building evaluation in terms

of wireless performance, ground-breaking works are needed. We are engaged in the collaborative

project Build-Wise [35]. Supported by this project, ﬁgures of merits (FoMs) reﬂecting the

intrinsic wireless performance of buildings have been deﬁned considering the impact of blockage,

IEEE

4

bounce reﬂections, and waveguide effects introduced by indoor building structures employing the

open space scenario as a benchmark for wireless network performance evaluation [15], [16]. The

proposed FoMs bridge the gap between building design and wireless communications, laying

the foundation to an improved wireless service indoors by optimising building layouts. However,

the computation of the FoMs is based on Monte Carlo simulations, which is computationally

expensive since an inﬁnite number of transmit elements is assumed in the FoM deﬁnition.

Therefore, an analytic framework is critically needed for fast computation of the FoMs.

The main contribution of this paper is a mathematical framework to evaluate the wireless

performance of buildings. The proposed approach facilitates straightforward and more com-

putationally efﬁcient numerical evaluation of the proposed FoMs. Firstly, two FoMs, i.e., the

interference gain (IG) and power gain (PG) are deﬁned to capture the impact of the building

layout on the power of interference signals and intended signals, respectively. Secondly, an

approach to derive exact FoMs in closed form is proposed for polygonal-shaped rooms. By

using this approach, the FoMs can be quickly and exactly computed given building layout tiled

by polygonal rooms. Thirdly, the analytic approach is validated through Monte Carlo simulations

for typical indoor path gain models. This proposed analytic framework provides a direct and

practical quantiﬁcation of the wireless performance of a building. Finally, the impact of the

building layout, e.g., their sizes and the aspect ratios (AR) of rectangular rooms, on wireless

performance FoMs is analyzed based on the proposed analytic approach.

The remainder of this paper is organized as follows. Section II summarizes the notation

and main assumptions made in this paper. In Section III, two FoMs, i.e., the IG, and the PG

are introduced to measure the wireless performance of a building. In Section IV, an approach

to compute the closed-form expressions of the proposed FoMs is provided. In Section V, the

approach is validated through Monte Carlo simulations. In Section VI, the impact of building

layout on FoMs is analyzed. Conclusions are provided in Section VII.

A. Notation

II. NOTATION AND ASSUMPTION

We use the following notations throughout this paper. 1) Polylogarithm Lis(z) , ∞
k=1
0 xz
P
x)c
R

−
. 4) Hypergeometric function 2F1(a, b; c; z) ,

Γ(x+y) . 3) Gamma function Γ(z) ,

function B(x, y) ,
n)z

1dt = Γ(x)Γ(y)

0 tx
R

1(1

1(1

t)y

b
−

−

∞

∞

−

−

−

1

1

zk
ks . 2) Beta
xdx =
1e−

−

−

1(1

zx)−

−

adx =

1
B(b,c

b)

−

0 xb
R

(1+ 1
1+ z
n

1
z

n=1
Q

5

IEEE

∞

(a)n(b)n
(c)n

zn
n! , where (x)n ,

n=0
logical disjunction, and the logical complement, respectively. “
P
tautology and logical contradiction, respectively. 6) Im[z] denotes the imaginary part of a complex

” denote the logical

” and “

k=0
Q

⊥

⊤

∧

∨

¬

k). 5) “

”, “

”, and “

” denote the logical conjunction, the

n

−

1
(x

−

number z. 7) In the open space scenario, IO and PO denote the power of interference signals and

the power of intended signals, respectively. In the LOS scenario, IL and PL denote the power

of interference signals and the power of intended signals, respectively. In the non-LOS (NLOS)

scenario, IN and PN denote the power of interference signals and the power of intended signals,

respectively. 8) γO and γB denote the signal-to-interference-plus-noise-ratio (SINR) in the open

space and the indoor scenario, respectively. 9) GO, GL, and GN denote path gain models in the
2] denotes the transmit

open space, the LOS, and the NLOS scenarios, respectively. 10) PT [Wm−

power density, i.e., transmit power per unit area. 11) Pth [Wm−

2] denotes the threshold power

level determined by the sensitivity of the receiver also deﬁned per unit area. 12) RO, RL and RN

denote the coverage distances under open space, LOS and NLOS scenarios, respectively. 13) gI

and gP denote the IG and the PG of buildings, respectively. 14) δ(ξ) is deﬁned as a function of

inequality ξ. If ξ holds, δ(ξ) = 1. Otherwise, δ(ξ) = 0.

B. Assumptions

We use the following assumptions throughout this paper.

1) The FoMs proposed in this paper is designed to evaluate a building layout in terms of

wireless performance. Instead of any speciﬁcally deﬁned radio network, the idea of the

approach is to evaluate the maximum achievable performance gain of indoor wireless

networks in a building. In this paper, PT [W/m2] denotes the transmit power density, i.e.,
transmit power per unit area. For a small cell network with an intensity of Λ [BSs/m2],

the power of each small cell base station is PT/Λ [W/BS]. To ﬁgure out the maximum

achievable performance gain, we need to use the best case of indoor wireless network

deployment even though it might be not realistic in existing networks. It is predictable

that the average SINR for a downlink reference user equipment (UE) with a ﬁxed sensi-

tivity increases with the intensity of transmit elements with a ﬁxed total transmit power.

Therefore, an inﬁnite number of transmit elements is assumed in our derivations, i.e., small

cells [2] or equivalent antenna elements [39] are assumed to be uniformly distributed in

both the indoor and the outdoor environment.

IEEE

6

2) Multi-slope path gain models [36] for the open space, the LOS and the NLOS scenarios

are employed in this paper. Path gain is deﬁned in the general form as

G(R) , PR
PT

,

(1)

where PR and PT denote the received and the transmit power densities, respectively, and

R denotes the horizontal distance from the transmitter to the receiver.

The path gain in the open space scenario is given by [37, Eqs. (4,5)]

GO(R) = min

1,

(

2

R−

2, (hThR)2 R−

4

λ
4π

)

,

(2)

(cid:19)
where hT and hR are the heights of the transmit and the receive antenna, respectively; fc
is the center frequency, λ , c
fc

denotes the corresponding wavelength, c = 3

108[m/s]

(cid:18)

×

is the speed of light.

Path gain models for the LOS and NLOS indoor scenarios can then be computed as

GL(R) =

GN(R) =









GO(R),

λ
4π

2

R−

(cid:1)
(cid:0)
GO(R),

λ
4π

2

R−

R

1 m,

≤
nL, R > 1 m.

R

1 m,

≤
nN, R > 1 m,

(3)

(4)

where the numerical values of nL and nN are determined by the type of environment in-
(cid:1)

(cid:0)



cluding building materials, shape and size of rooms, etc. Following the energy conservation

law, path gains GO/L/N have to be less than one.

3) In this paper, we specialize our results to nL = 1.73, and nN = 3.19 following the 3GPP

indoor channel model working at 0.5-100 GHz [38, Table 7.4.1-1]. Since the 3GPP model

is deﬁned for R > 1 m, we assume that GL(R) = GN(R) = GO(R), at R

≤
, and therefore Pth < PT
O, L, N
}

1 m.
2.

λ
4π

4) We constrain ourselves to Rs > 1 m, s

∈ {

5) In this paper, the detectable power is deﬁned as the receive power from transmit elements

(cid:0)

(cid:1)

satisfying the condition

PTGs(R) > Pth, s

O, L, N
}

,

∈ {

(5)

where Pth [Wm−

2] is a threshold power level determined by the sensitivity of the UE

receiver.

6) RO, RL and RN denote the coverage distances under open space, LOS and NLOS sce-

narios, respectively and satisfy the identities PTGO(RO) = Pth, PTGL(RL) = Pth, and

IEEE

7

PTGN(RN) = Pth. Hence, it can be shown after some straightforward algebraic manipu-

lations that

RO = 


PT
Pth

λ
4π ,

q

PT
Pth

1

4 √hThR,

RL =

RN =

(cid:18)

(cid:16)

PT
Pth (cid:19)
PT
Pth (cid:19)

(cid:18)

(cid:17)
1
nL

(cid:18)

1
nN

2
nL

2
nN

,

.

λ
4π

(cid:19)

λ
4π

(cid:18)

(cid:19)

PT
Pth

< (4π)4(hThR)2
λ4

,

PT
Pth ≥

(4π)4(hThR)2
λ4

,

(6)

(7)

(8)

7) In the best case, the reference UE can make use of all the detectable power, which is

constrained by the sensitivity of its receiver. The receive power is in turn assumed to be

the result of maximum ratio transmissions (MRT) in distributed massive MIMO networks or

coordinated multipoint transmission (CoMP) in ultra-dense small-cell networks [40], [41],

where all network elements transmit the same signal for the reference UE continuously at

full power. To simplify the analysis, we further assume that all transmit elements use the

same frequency band.

8) In cooperative ultra-dense small-cell/massive MIMO systems, channel responses are smoothed

by the extremely large spatial diversity as a result of the favorable action of the law of

large numbers. In essence, small-scale fading is negligible [42], therefore, only large-scale

fading is considered in this paper.

With all the assumptions, we ﬁrst observe the impact of the room structure on a reference UE

located in the center of a circular room with a radius of RW. As shown in Fig. 1, the SINR of the

reference UE varies signiﬁcantly for different values of RW. Thus, it is necessary to consider

this impact on the building design stage. In practice, rooms in a building are not circular in

general, and the evaluation of the building is therefore much more complicated. In the following

Section III, we will design the FoMs to evaluate the wireless friendliness of building layouts.

III. FOM DEFINITION

In order to meaningfully evaluate the wireless performance of buildings, the impact of buildings

on wireless networks has to be well understood. To help in the analysis we employ the open space

scenario with path gain model (2) as a benchmark or reference. Then, the impact of buildings on

the wireless networks can be evaluated by comparing the SINR of the signals received indoors

with that in the open space scenario.

IEEE

8

40

35

30

25

20

15

10

5

0

]

B
d
[

R
N
I
S

-5
100

1 GHz
28 GHz

101

102

103

R

W

 [m]

Fig. 1. Impact of the radii RW of a circular room on the SINR of the reference UE at the center of it. σ = −93 dB, PT = −30
dBW/m2, Pth = −100 dBW/m2, and hT = hR = 1.2 m.

The expression of the SINR in the open space is given as follows. Using a polar-coordinate

system (R, θ) by choosing the UE as the reference point and an arbitrary angle as the reference

0-angle in the open space, the power of the intended signal is given by the integral of the receive

power from all transmit elements with a distance that is less than RO, i.e.,
2π

RO

PO =

PTGO(R)RdRdθ.

Whereas, the power of the interference signal is given by

0 Z
Z

0

2π

+

∞

IO =

PTGO(R)RdRdθ.

(9)

(10)

Thus, the SINR in an open space scenario is given by

0 Z
Z

RO

PO
IO + σ2 .
Then, the SINR of a UE in the considered building is given as follows. For an arbitrary

γO =

(11)

transmit element located at (R, θ), the transmission from the element to the UE could be either

LOS or NLOS. If the transmission is LOS, the received signal is considered as an intended signal

if R < RL. Otherwise, if R

≥

RL, the received signal is considered as an interference signal.

Similarly, if the transmission is NLOS, the intended signal satisﬁes R < RN, and the interference

signal satisﬁes R

RN. For a given (R, θ), we use a Boolean variable

(R, θ) to denote that

≥

“the transmission from the transmit element at (R, θ) to the UE is LOS”. Accordingly,

V

(R, θ)

¬V

denotes that “the transmission from the transmit element at (R, θ) to the UE is NLOS”. If a signal

transmitted from (R, θ) is an intended signal, we have [

[
¬V
RN )]. Then, the power of intended signals in the considered building is given by

(R < RL)]

(R, θ)

∧

∨

V

(R, θ)

(R <

∧

PB =

PTGL(R)RdRdθ

+

PTGN(R)RdRdθ

,

(12)

(R,θ)

(R<RL)

∧

ZV

|

PL

{z

Z¬V

}

|

(R,θ)

(R<RN )

∧

PN

{z

}

 
IEEE

9

where PL and PN, respectively, denote receive power of intended signals from LOS and NLOS

small cells/antenna elements, and can be computed separately since

(R, θ)

(R < RL) and

V

∧

(R < RN ) are exclusive. Similarly, the power of the interference signal is given by

(R, θ)

∧

¬V

IB =

ZV

PTGL(R)RdRdθ

+

PTGN(R)RdRdθ

,

(13)

(R,θ)

(R

∧

≥

RL)

IL

Z¬V

(R,θ)

(R

∧

≥

RN )

IN

where IL and IN, respectively, denote the LOS and the NLOS received powers of interference

{z
signals. Therefore, we have the expression of the indoor SINR as

{z

|

}

|

}

γB =

PB
IB + σ2 =

PL + PN
IL + IN + σ2 .

Combining (11) and (14), we obtain

γB =

IO + σ2
IL + IN + σ2

PL + PN
PO

γO = gIgPγO,

and we deﬁne two FoMs of a building’s wireless performance as [15], [16]

IL + IN + σ2 ,

gI , IO + σ2
gP , PL + PN

,

PO

(14)

(15)

(16)

(17)

where gI and gP denote the IG and the PG, respectively. The variables IO and PO denote the

power of interference signals and the power of intended signals in the open space scenario,

respectively. In the LOS scenario, IL and PL denote the power of interference signals and the

power of intended signals, respectively. In the NLOS scenario, IN and PN denote the power of

interference signals and the power of intended signals from the transmit elements in the ﬂoor

where the UE located, respectively. σ2 denotes the power of thermal noise.

Remark 1. The FoMs gI and gP are intrinsic wireless performance characteristics of buildings.
They represent the effective change in the SINR when coverage is provided within the building

relative to the SINR in the open space scenario. On one hand, gI captures the impact of the

building on the power of interference signals due to blockage, while, on the other hand, gP

captures the impact of the building on the power of intended signals.

The proposed FoMs and their analytic computation approach, will provide civil engineers and

architects guidance to evaluate the wireless friendliness of a building layout under their design.

If FoMs are lower than expected, an acceptable wireless performance will not be achievable. For

IEEE

10

communication engineers, the FoM is a performance gain upper bound provided by the buildings

under design. To achieve the upper bound, Assumptions 1) and 7) stated in Section II need to

be approached.

In our model we consider an inﬁnite number of small cells/antenna elements. Therefore,

analytic expressions are comparatively more computationally efﬁcient than performing Monte

Carlo simulations to approximately compute the FoMs. Also, analytic results can provide accurate

results and lead to a more straightforward comparison and optimization of the building layout.

Therefore, we propose next an approach to derive gI and gP in closed form for evaluating the

wireless performance of buildings.

IV. ANALYTIC COMPUTATION OF FOM

Next we provide analytic equations for intended and interference signals starting with the

open space scenario (IO and PO) and later for the LOS and NLOS scenarios too (i.e., IL, PL,

IN, and PN, respectively).

Theorem 1. In the open space scenario, the power of interference signals IO and the power of
intended signals PO are computed by (18) and (19), respectively.

IO =

PTλ2
8π

1
2 + ln

16√Pthπ2hThR
√PTλ2

,

PT
Pth

< (4π)4(hThR)2
λ4




(cid:16)
π√PthPThThR,

n

(cid:17)o

PT
Pth ≥

(4π)4(hThR)2
λ4

,

.


PO = 


PTλ2
16π

1 + ln

PT
Pth

,

h
16π + PTλ2
PTλ2

(cid:16)
8π ln

(cid:17)i
16π2hThR
λ2

Proof: See Appendix A.


(cid:16)

(cid:17)

PT
Pth

< (4π)4(hThR)2
λ4

+

λ4PT
29π3(hThR)2 −

πPth
2 ,

PT
Pth ≥

(4π)4(hThR)2
λ4

(18)

(19)

,

.

The parameters of the equations have been deﬁned above in Section II and are omitted here

for the sake of compactness.

The computation of IL, PL, IN, and PN is not straightforward since the indoor scenarios are

not homogeneous. Therefore, in order to facilitate their derivation, we propose a toy model (TM)

as shown in Fig. 2. In the TM, we consider a circular sector with an inﬁnite radius. A reference

(or probing) UE is located at the vertex of the sector. A wall of ﬁnite length is modeled as a

straight line segment across the sector with endpoints lying on the radii of the circular sector.

The distance from the UE to the wall is denoted as D0. A polar-coordinate system (R, θ) is

IEEE

11

θ

l

dΩ

θ = 0

θ

r

θ

R

D

0

R

N

Wall

R

L

ΩPL: LOS signal
ΩIL: LOS interference
ΩPN: NLOS signal
ΩIN: NLOS interference

rectangular room

corner

TM1

TM4

TM1

TM2

TM3

TM4

TM2

TM3

UE

UE

Wall

ΩPL

ΩIL

ΩPN

ΩIN

Fig. 2. An example of the toy model and its ΩPL, ΩPN, ΩIL,

Fig. 3. Examples of dividing a room into toy models.

and ΩIN.

introduced by choosing the UE as the reference point. The perpendicular direction to the wall

is assumed to be the reference 0-angle. θl and θr denote angles of the left and right end points

of the wall, respectively. With these deﬁnitions,

π

2 < θl < θr < π
2 .

−
It is worthwhile to note that the proposed TM of a wall can be used to represent any polygonal-

shaped room. Indeed, any room can be modelled by adding several TMs, i.e., one for each wall

that can be seen by the reference UE in the room. Some examples are given in Fig. 3. For a

speciﬁc direction, whether an area is LOS or NLOS is determined by the closest wall.

For a room consisting of NTM TMs, we then have

NTM

IL =

IL,nTM,

nTM=1
X
NTM

PL =

PL,nTM,

nTM=1
X
NTM

IN =

IN,nTM,

nTM=1
X
NTM

PN =

PN,nTM.

(20)

(21)

(22)

(23)

nTM=1
X
For known closed-form expressions of IL,nTM, PL,nTM, IN,nTM, and PN,nTM, it is straightforward
to compute IL, PL, IN, and PN by (20-23). For an arbitrary nTM (i.e., TM of a wall contribution

IEEE

to the computed signals) we have

PL,nTM =

PTGL(R)dΩ,

ZΩPL

IL,nTM =

PTGL(R)dΩ,

ZΩIL

PN,nTM =

PTGN(R)dΩ,

ZΩPN

IN,nTM =

PTGN(R)dΩ,

12

(24)

(25)

(26)

(27)

ZΩIN
where ΩPL, ΩIL, ΩPN, and ΩIN denote the areas contributing to the LOS intended signals, the

LOS interference signals, the NLOS intended signals, and the NLOS interference signals at the

reference UE, respectively. Expressed in polar-coordinates, the straight line equation of the wall

is given by R = D0

cos θ . For any inﬁnitesimal area at position (R, θ), the area is a LOS area
D0
cos θ . Therefore, ΩIL, ΩPL, ΩIN, and ΩPN are,

cos θ . Else, the area is NLOS if R

if R < D0

≥

respectively, deﬁned as

ΩPL ,

(R, θ)

R < min

RL,

< θl < θ < θr <

(cid:16)
< θl < θ < θr <

D0
cos θ

(cid:27)(cid:19)

π
2

−

∧
π
2
π
2

∧

(cid:19)

−

(cid:16)

−

(cid:16)

∧
(cid:19)
D0
cos θ

R < RN

< θl < θ < θr <

max

RN,

(cid:26)

∧

(cid:27)(cid:19)

−

(cid:16)

(cid:17) (cid:27)
< θl < θ < θr <

π
2

π
2
(cid:17)(cid:27)
π
2

,

(28)

(29)

(30)

.

(31)

π
2

,

(cid:17) (cid:27)

,

π
2

(cid:17)(cid:27)

(cid:26)

D0
cos θ

R <

ΩIL ,

(cid:26)

ΩPN ,

ΩIN ,

(cid:26)

(R, θ)

(cid:12)
(cid:18)
(cid:12)
(cid:12)
RL ≤
(cid:12)
(cid:12)
(cid:18)
(cid:12)
D0
(cid:12)
(R, θ)
(cid:12)
cos θ ≤
(cid:12)
(cid:18)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:18)
(cid:12)
(cid:12)
(cid:12)

≥

R

(R, θ)

(cid:26)

(cid:26)

In a TM with a given set of (PT, Pth, θr, θl, D0, λ), the integrals PL,nTM, IL,nTM, PN,nTM and

IN,nTM are computed by following Theorems 2-5.

Theorem 2. For an arbitrary nTM, PL,nTM is computed by TABLE I in closed form, where PL,1,
PL,2, and PL,3 are given by the following expressions

PL,1 = PT

PL,2 = PT

PL,3 = PT

(cid:18)

(cid:18)

(cid:18)

PT

−

(cid:18)

2

(cid:19)

2

(cid:19)

2

λ
4π

λ
4π

λ
4π

(cid:19)
λ
4π

(cid:19)

(θr −

θl)

(cid:20)

Z1 (max
{

θl,

1
2 −

ln

λ
4π

+ PT

2

λ
4π

(cid:18)
θL1}
−

(cid:19)(cid:21)

(cid:19)

(cid:18)
, RL, D0, nL −
θr, θL1}

, min
{

Z0(θl, θr, 1, RL, nL −

1), (32)

1) ,

(33)

Z1 (max
{

θl,

θL2}
−

, min
{

θr, θL2}

, 1, D0, 1)

2

Z1 (max
{

θl,

θL2}
−

, min
{

θr, θL2}

, 1, D0, nL −

1) ,

(34)

IEEE

13

COMPUTATION OF PL,nTM , WHERE PL,1, PL,2, AND PL,3 ARE RESPECTIVELY COMPUTED BY (32), (33), AND (34).

TABLE I

Case

D0

θ

(θl < θL1) ∧ (θr > −θL1)

PL,nTM

PL,1 + PL,2

1 ≤ D0 < RL

λ
4π < D0 < 1

λ
4π < D0 < 1

1

2

3

4

(θl < θL2) ∧ (θr > −θL2)

PL,1 + PL,2 + PL,3

(θl > θL2) ∨ (θr < −θL2) ∧ [(θl < θL1) ∧ (θr > −θL1)]

PL,1 + PL,2

else

PL,1

θL1 = arccos

D0
RL (cid:19)
θL2 = arccos (D0) ,

(cid:18)

Z0(z1, z2, z3, z4, z5) =






(z2 −

(z2

−

z1) ln
1−z5
z1)(z
4
1

z5

−

z4
z3
1−z5
(cid:17)
3

(cid:16)
z
−

z2
4[tan(z2)
−
2

tan(z1)]

,

z5 = 1,

= 1,

)

, z5 6
+ (z1

z2)z2
3
−
2

,

,

z2)z3,

(35)

(36)

(37)

1,

z5 =

−
z5 = 0,

Z1(z1, z2, z3, z4, z5) =

e2jz2 )
−
2

Li2(

−

e2jz1 )]

,

z5 = 1,

sgn(z1)]z

1−z5
4

(38)

+ (z1 −
Im[Li2(

−

(cid:17)
+

z4 ln

tan(z2)+sec(z2)
tan(z1)+sec(z1)

(cid:16)
z1) ln
(z2 −
B( 1
2 ,

2z4
z3
(cid:16)
z5
2 )[sgn(z2)
2(1
1−z5
z2)z
3
−
z5
1

−

−

(cid:17)
−
z5)
+ z
(1
−

+ (z1

sgn(z1) cosz5(z1) 2F1

1−z5
4
z5)z5 ×
z5
2 , 1











else,

, cos2(z1)

2; z5+2

2

where

−

π

2 < z1 < z2 < π

2 , z3 > 0, z4 > 0, and z5 >

−

(cid:2)
−

(cid:0)
sgn(z2) cosz5(z2) 2F1
1.

z5
2 , 1

2; z5+2

2

(cid:1)
, cos2(z2)

,

(cid:0)

(cid:1)(cid:3)

Proof: See Appendix B.

Theorem 3. IL,nTM is computed by TABLE II in closed form, where

IL,1 = PT

IL,2 = PT

(cid:18)

(cid:18)

2

(cid:19)

2

(cid:19)

λ
4π

λ
4π

2

Z1 (θl, θr, RL, D0, nL −

1) ,

Z1 (θl,

θL1, RL, D0, nL −
−

1) ,

IL,3 = PT

λ
4π

(cid:18)

Z1 (θL1, θr, RL, D0, nL −

1) ,

(cid:19)

(39)

(40)

(41)

IEEE

14

COMPUTATION OF IL,nTM , WHERE IL,1, IL,2, AND IL,3 ARE RESPECTIVELY COMPUTED BY (39), (40), AND (41).

TABLE II

Case

D0

θ

RL ≤ D0

θl < θr

RL > D0

(θr < −θL1) ∨ (θl > θL1)

RL > D0

(θl < θL1) ∧ (−θL1 < θr)

IL,nTM

IL,1

IL,1

IL,2δ(θl < −θL1)

+IL,3δ(θl > θL1)

else

0

1

2

3

4

where θL1 and Z1 are computed by (35) and (72), respectively.

Proof: See Appendix C.

Theorem 4. PN,nTM is computed by TABLE III in closed form, where PN,1 and PN,2 are
respectively computed by

PN,1 =

PT

−

PN,2 =

PT

−

λ
4π

λ
4π

(cid:18)

(cid:18)

2

(cid:19)
2

(cid:19)
2

Z1 (max

θl,

θN1}
−

, min
{

θr, θN1}

, RN, D0, nN −

{

1) ,

(42)

Z1 (max

θl,

θN2}
−

, min
{

θr, θN2}

{

, 1, D0, 1)

Z1 (max
{

θl,

θN2}
−

, min
{

θr, θN2}

, 1, D0, nN −

1) ,

+PT

λ
4π

(cid:18)

θN1 = arccos

(cid:19)
D0
RN (cid:19)
θN2 = arccos (D0) ,

(cid:18)

,

where Z0 and Z1 are computed by (65) and (72), respectively.

Proof: See Appendix D.

Theorem 5. IN,nTM is computed by TABLE IV in closed form, where

λ
4π

2

(cid:19)
2

Z1 (θl, θr, +

, D0, nN −

∞

1) ,

IN,1 =

PT

−

IN,2 = PT

(cid:18)

(cid:18)
λ
4π

Z1 (max
{

θl,

θN1}
−

, min

θr, θN1}

, RN, D0, nN −

{

1) ,

(cid:19)

where θN1, and Z1 are computed by (44) and (72), respectively.

(43)

(44)

(45)

(46)

(47)

IEEE

15

COMPUTATION OF PN,nTM , WHERE PN,1 AND PN,2 ARE COMPUTED BY (42) AND (43), RESPECTIVELY.

TABLE III

Case

D0

θ

(θl < θN1) ∧ (θr > −θN1)

PN,nTM

PN,1

1 ≤ D0 < RN

λ
4π < D0 < 1

λ
4π < D0 < 1

1

2

3

4

(θl < θN2) ∧ (θr > −θN2)

PN,1 + PN,2

(θl > θN2) ∨ (θr < −θN2) ∧ [(θl < θN1) ∧ (θr > −θN1)]

PN,1

else

0

COMPUTATION OF IN,nTM , WHERE IN,1 AND IN,2 ARE COMPUTED BY (46), AND (47), RESPECTIVELY.

TABLE IV

Case

D0

RN ≤ D0

θ

θl < θr

1

2

3

RN > D0

(θr < −θN1) ∨ (θl > θN1)

RN > D0

(θl < θN1) ∧ (−θN1 < θr)

IN,1 + IN,2

IN,nTM

IN,1

IN,1

Input

Building 
layout & UE 
position

nL, nN, fc

PT

Pth

Theorem 1

P
O

I
O

Theorem 2 & (20)

Theorem 3 & (21)

PL

IL

Theorem 4 & (22)

Theorem 5 & (23)

PN

IN

Output

(16)

gI

(17)

g

P

Fig. 4. The procedure of computing gI and gP.

Proof: See Appendix E.

Remark 2. The computation of the gI and gP follows the ﬂow chart shown in Fig. 4. The input
parameters are the building layout, the reference UE position, nL, nN, fc, PT and Pth. First,

Theorems 2, 3, 4, and 5 are used to compute signals corresponding to the open space, LOS

and NLOS scenarios. Second, the obtained (20-23) and (18-19) are substituted into (16-17) to

obtain the FoM.

 
   
 
   
 
   
 
   
 
 
   
 
   
 
   
 
   
 
 
   
 
   
 
   
 
   
 
   
 
   
 
   
 
   
 
IEEE

16

TABLE V

ANALYTIC RESULTS USED IN FIGS. 5-11

Figures

associating analytical results.

Fig. 5

(18) and (19)

Figs. 6-7

Theorems 2-5

Figs. 8-11

Remark 2

-44

-46

-48

-50

-52

-54

]

W
B
d
[

O

P
r
o

O

I

-73

-73.5

-74

-74.5

-75

-75.5

-76

]

W
B
d
[

O

P
r
o

O

I

I
O
P

O

Analytic

I

O
P
Analytic

O

-56

-100

-90
P

th

-80
 [dBWm-2]

-70

-76.5

-120

-110
P

th

-100
 [dBWm-2]

-90

(a) fc = 1 GHz

(b) fc = 28 GHz

Fig. 5. Comparison of analytic PO and IO, computed by Theorem 1, with Monte-Carlo simulations. PT = −30 dBWm

−2.

V. COMPARISON THEORETICAL RESULTS WITH MONTE-CARLO SIMULATIONS

In this section, we compare the results obtained by the derived closed-form expressions and the

Monte Carlo simulations. The analytic results used in the following Figs. 5-11 are summarized

in TABLE V. In Sections V-VI, we use hT = hR = 1.2 m without further speciﬁcation.

In Fig. 5, we compare the results obtained by the derived closed-form expressions of PO and

IO, i.e., (18) and (19), with Monte Carlo simulations. The numerical results show an excellent

agreement between the analytic, i.e., closed-form, results and the Monte Carlo simulations.

Let’s now consider two generic wireless systems operating at the 1 GHz and the 28 GHz

bands, respectively. The parameters PL, IL, PN, and IN are validated in Figs. 6-7, respectively,

where analytic PL, IL, PN, and IN are provided in TABLEs I-IV. The analytic results match

Monte Carlo simulations very well. With an increasing D0, more transmitted power is considered

as LOS power, and therefore PL and IL increase, while PN and IN decrease.

Following Remark 2, the analytic gI and gP of a rectangular room of size 5 m

10 m are

×

validated in Figs. 8 and 9 for the 1 GHz and the 28 GHz bands, respectively. Also, gI and gP of

 
 
 
 
 
 
IEEE

]

W
B
d
[

N

I

r
o

N

P

,

L

I
,

L

P

-45

-50

-55

-60

-65

-70

-75

-80

-85

0

]

W
B
d
[

N

I

r
o

N

P

,

L

I
,

L

P

-45

-50

-55

-60

-65

-70

-75

-80

-85

0

]

W
B
d
[

N

I

r
o

N

P

,

L

I
,

L

P

-45

-50

-55

-60

-65

-70

-75

-80

-85

0

P

L

I

L
P

N

I

N
Analytic

10

20

30

 [m]

D

0

17

P

L

I

L
P

N

I

N
Analytic

10

20

30

 [m]

D

0

]

W
B
d
[

N

I

r
o

N

P

,

L

I
,

L

P

-45

-50

-55

-60

-65

-70

-75

-80

-85

0

P

L

I

L
P

N

I

N
Analytic

10

20

30

 [m]

D

0

P

L

I

L
P

N

I

N
Analytic

10

20

30

 [m]

D

0

(a) θr = −0.4

(b) θr = 0

(c) θr = 0.4

(d) θr = 1

Fig. 6. Comparison of analytic PL, PN, IL and IN, computed by Theorems 2-5, with Monte-Carlo simulations. fc = 1GHz
−2, and θl = −1. Markers are generated from Monte Carlo simulations. Solid lines

−2, Pth = −75 dBWm

PT = −30 dBWm

are analytic results.

-75

-80

-85

-90

-95

-100

-105

]

W
B
d
[

N

I

r
o

N

P

,

L

I
,

L

P

P

L

I
L
P

N

I
N
Analytic

-75

-80

-85

-90

-95

-100

-105

]

W
B
d
[

N

I

r
o

N

P

,

L

I
,

L

P

P

L

I
L
P

N

I
N
Analytic

-75

-80

-85

-90

-95

-100

-105

]

W
B
d
[

N

I

r
o

N

P

,

L

I
,

L

P

P

L

I
L
P

N

I
N
Analytic

-75

-80

-85

-90

-95

-100

-105

]

W
B
d
[

N

I

r
o

N

P

,

L

I
,

L

P

P

L

I
L
P

N

I
N
Analytic

-110

0

1

2
D

0

3
 [m]

4

5

-110

0

1

2
D

0

3
 [m]

4

5

-110

0

1

2
D

0

3
 [m]

4

5

-110

0

1

2
D

0

3
 [m]

4

5

(a) θr = −0.4

(b) θr = 0

(c) θr = 0.4

(d) θr = 1

Fig. 7. Comparison of analytic PL, PN, IL and IN, computed by Theorems 2-5, with Monte-Carlo simulations. fc = 28GHz
−2, and θl = −1 rad. Markers are generated from Monte Carlo simulations. Solid

−2, Pth = −100 dBWm

PT = −30 dBWm

lines are analytic results.

an L-shaped corner room are validated in Figs. 10 and 11. Floor plans of the considered rooms

are given in Fig. 3. Numerical results show that the analytic gI and gP agree well with the Monte

Carlo simulations.

In the following sections, we use only the analytic results to propose some examples of building

wireless performance analysis since the computation of gI and gP by Monte Carlo simulation is

computationally expensive.

VI. SIMULATIONS

In this section, we give examples of the evaluation of building wireless performance of

two reference ﬂoor plans: a single rectangular room layout and an ofﬁce building layout with

 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
IEEE

18

(a) gI

(b) gP

(a) gI

(b) gP

Fig. 8. Comparison of analytic gains gI and gP with Monte-

Fig. 9. Comparison of analytic gains gI and gP with Monte-

Carlo simulations at 1 GHz in a 5m × 10m rectangular
−2. Markers

−2, Pth = 90 dBWm

room. PT = −30 dBWm

Carlo simulations at 28 GHz in a 5m×10m rectangular room.
−2. Markers

−2, Pth = −100 dBWm

PT = −30 dBWm

are generated from Monte Carlo simulations. Solid lines are

are generated from Monte Carlo simulations. Solid lines are

computed by Remark 2.

computed by Remark 2.

(a) gI

(b) gP

(a) gI

(b) gP

Fig. 10. Comparison of analytic gains gI and gP with Monte-

Fig. 11. Comparison of analytic gains gI and gP with Monte-

Carlo simulations at 1 GHz in the L-shaped corner in Fig.
3. PT = −30 dBWm−2, Pth = −90 dBWm−2. Markers
are generated from Monte Carlo simulations. Solid lines are

Carlo simulations at 28 GHz in the L-shaped corner in Fig.
3. PT = −30 dBWm−2, Pth = −100 dBWm−2. Markers
are generated from Monte Carlo simulations. Solid lines are

computed by Remark 2.

computed by Remark 2.

rectangular rooms.

A. Performance evaluation for a single room

The impact of the area of a rectangular room on gI and gP is analyzed. It is needed to emphasize

that gI and gP have different values at different positions in the room. To facilitate the comparison

of rooms in terms of wireless performance, for each considered room, we compute the average

gI and the average gP for that room.

IEEE

13.5

13

12.5

12

11.5

I

g

e
g
a
r
e
v
A

AR=1
AR=2

1

P

g

e
g
a
r
e
v
A

0.95

0.9

16

15

14

I

g

e
g
a
r
e
v
A

13

12

11

11

0

10

30
20
Area [m2]

40

50

0.85

0

10

30
20
Area [m2]

(a) gI

(b) gP

AR=1
AR=2

40

50

10

0

10

19

AR=1
AR=2

1.01

1

0.99

P

g

e
g
a
r
e
v
A

0.98

0.97

0.96

0.95

40

50

0.94

0

10

30
20
Area [m2]

(a) gI

AR=1
AR=2

40

50

30
20
Area [m2]

(b) gP

Fig. 12.

Impact of room size on gI and gP at 1 GHz in
−2, Pth = −75

a rectangular room. PT = −30 dBWm

Fig. 13.

Impact of room size on gI and gP at 28 GHz in
−2, Pth = −100

a rectangular room. PT = −30 dBWm

dBWm

−2.

dBWm

−2.

15

14.5

14

13.5

13

12.5

12

11.5

11

10.5

I

g

e
g
a
r
e
v
A

AR=1
AR=2

0.7

0.68

P

g

e
g
a
r
e
v
A

0.66

0.64

0.62

10

0

10

20
30
Area [m2]

40

50

0.6

0

10

(a) gI

AR=1
AR=2

40

50

20
30
Area [m2]

(b) gP

Fig. 14.

Impact of room size on gI and gP at 1 GHz in a rectangular room. PT = −30 dBWm

−2, Pth = −100 dBWm

−2.

Figs. 12-13 show the average gI and the average gP as a function of the indoor coverage area

for two different AR, i.e., AR

at 1 GHz and 28 GHz. While covering a small room in

1, 2

}

∈ {

the open space scenario, the power of the interference signals becomes larger in proportion to

the intended signals due to the strong attenuation, and the limited receive sensitivity. Therefore,

the signiﬁcant increase of IN takes place resulting in a decrease of gI. Whereas, in a larger room,

the interference is more likely to be LOS, then a larger IL signiﬁcantly reduces gI. Therefore, it

is observed that gI can be optimized subject to the size of the room by balancing IN and IL in an

appropriate way. For different values of AR, the optimum size of a room and the maximized gI

are different. With an increasing AR, the maximum gI decreases, and therefore a better wireless

performance is achieved with a lower AR.

In Fig. 12, shown results correspond to RO = 4.2 m, RL = 5.3 m, and RN = 2.5 m due to

 
 
 
 
 
 
IEEE

]

m
[
y

50

40

30

20

10

0

-10

-20

-30

-40

-50

13

12.5

12

11.5

11

10.5

10

]

m
[
y

50

40

30

20

10

0

-10

-20

-30

-40

-50

-20

-10

0
x[m]

10

20

9

8.5

8

7.5

7

6.5

6

5.5

]

m
[
y

50

40

30

20

10

0

-10

-20

-30

-40

-50

-20

-10

0
x[m]

10

20

0.8

0.75

0.7

0.65

]

m
[
y

50

40

30

20

10

0

-10

-20

-30

-40

-50

-20

-10

0
x[m]

10

20

-20

-10

0
x[m]

10

20

20

1.05

1

0.95

(a) gI at 1 GHz

(b) gI at 28 GHz

(c) gP at 1 GHz

(d) gP at 28 GHz

Fig. 15. gI and gP in a typical ofﬁce scenario. PT = −30 dBWm

−2, Pth = −100 dBWm

−2.

(6)-(8). In Fig. 13, we have RO = 2.7 m, RL = 3.2 m, and RN = 1.9 m. Since the coverage

area is in general less than the size of the room, the intended signal is less likely to be blocked.

Thus, the value of the average gP is close to one. Therefore, with a small coverage area, e.g., a
relative small PT
Pth

, the impact of gP is relatively slight. On the other hand, for a large PT
Pth

, e.g.,

PT =

30 dBWm−

2, Pth =

100 dBWm−

2 at 1 GHz, the average gI and the average gP are

−

−

shown in Fig. 14. Following (6)-(8), we have RO = 75 m, RL = 148 m, and RN = 15 m. Even
though for a room with an area of 50 m2 and an AR= 2, the maximum length of LOS link is

5√2 m, which is less than RN. Thus, all the interference power is NLOS, i.e., IL = 0. Also, the

IN becomes independent of the size and the AR of the room because the NLOS interference is

not impacted by any wall. Therefore, if the maximum possible distance between two points of

walls around the polygon room is less than RN, IN does not change with the size and the AR

of the room and gI is a constant.

However, when the size of a room is less than RN, the blockage of the room attenuates the

power of intended signals signiﬁcantly. Reducing the size of the room, more intended signals

are blocked and thus the gP decreases. Therefore, under this condition, a decreasing size reduces

the wireless performance of a room.

B. An example of building evaluation

In this subsection, the wireless performance evaluation for the A1 scenario of WINNER II

channel model [43, Fig. 2.1] is taken as an example. In the computations, we use PT =

dBWm−

2, and Pth =

100 dBWm−

2. For each room or corridor, gI and gP are computed by

30

−

−

evoking Remark 2. The obtained gI and gP are illustrated in Fig. 15. The average gI = 12.03

−

IEEE

21

and the average gP = 0.74, respectively. Whereas for fc = 28 GHz, i.e., at mm-Wave band,

the average gI = 7.08 and the average gP = 1.01, respectively. For PT =

30 dBWm−

2 and

Pth =

100 dBWm−

−

2, the WINNER II A1 at 1 GHz outperforms that at 28 GHz in terms

of gI because it blocks almost all interference signals. Whereas in terms of gP, the WINNER

II A1 building has better wireless performance at 28 GHz. Therefore, for a building wireless

performance evaluation in the future, the tradeoff between gI, gP, and fc has to be taken into

account carefully.

VII. CONCLUSIONS

The intrinsic wireless performance characteristics of buildings have been formally deﬁned

as the interference gain and the power gain ﬁgures of merit. An analytical approach has been

proposed to compute these ﬁgures of merit reﬂecting the wireless performance of buildings

with polygonal-shaped rooms. The analytic approach has been validated through Monte Carlo

simulations for typical indoor environments with well-established empirical path gain models

showing a good agreement between them. The proposed analytic approach allows to quantify

the impact of building properties, e.g., the aspect ratio and the area of rooms, on both the

interference gain and the power gain. Numerical examples are provided based on different

propagation scenarios at different frequencies, i.e., 1 GHz and 28 GHz. Based on the presented

analysis it is shown that wireless building design need to consider the trade-off between the

interference gain, the power gain and the frequency band of the wireless system deployed in a

speciﬁc building. This ﬁnding has tremendous implications on the way new buildings shall be

designed taking into consideration wireless performance already at the design phase. Indeed, it is

expected that architects and civil engineers will now be able to carefully take the interference gain

and the power gain into account before designing or retroﬁtting a building to provide adequate

performance margins for future indoor wireless networks. The proposed approach bridges the

building design and wireless communications industries. It has the potential to open up a wide

range of innovative solutions offering wireless friendly buildings, leading to improved wireless

services indoors where most of the communications trafﬁc takes place.

IEEE

APPENDICES

A. Proof of Theorem 1

1) Closed-form IO (18): IO is deﬁned by [15], [16]

IO =

2π

+

∞

0 Z
Z

RO

PTGO(R)RdRdθ.

Substituting (6) into (48), considering the case PT
Pth

< (4π)4(hThR)2
λ4

, we have

IO =

2π

+

∞

0 Z

Z

λ
4π r

PT
Pth

PTGO(R)RdRdθ.

Substituting (2) into (49), we obtain the closed-form IO as

IO =

PTλ2
8π

1
2

(cid:26)

+ ln

(cid:18)

16√Pthπ2hThR
√PTλ2

.

(cid:19)(cid:27)

For PT

Pth ≥

(4π)4(hThR)2
λ4

, we have

IO =

2π

+

∞

Z

0 Z
(cid:16)

PT
Pth (cid:17)

1
4 √hThR

PTGO(R)RdRdθ.

Substituting (2) into (51) and following some algebraic manipulations, we obtain

IO = π

PthPThThR.

p
Combining (50), and (52), we obtain (18).

2) Closed-form PO (19): PO is deﬁned by [15]

2π

RO

PO =

PTGO(R)RdRdθ.

0 Z
Z
< (4π)4(hThR)2
Substituting (6) into (53), for PT
λ4
Pth

0

, we have

2π

λ
4π r

PT
Pth

PO =

0
0 Z
Z

PTGO(R)RdRdθ.

Substituting (2) into (54), PO is then computed by

PO = 2π

λ
4π

0
Z

PTRdR + 2π

λ
4π r

PT
Pth

λ
4π

Z

PT

λ
4π

(cid:18)

2

(cid:19)

R−

1dR.

Following some algebraic manipulations, we obtain (56).

PO =

PTλ2
16π

(cid:20)

1 + ln

PT
Pth (cid:19)(cid:21)

.

(cid:18)

22

(48)

(49)

(50)

(51)

(52)

(53)

(54)

(55)

(56)

IEEE

23

θl

θ = 0

θr

RL

ΩPL1
ΩPL2

-θL1

θL1

D0

1

UE

ΩPL1
ΩPL2
ΩPL3

θl

-θL1

θ = 0

θr

-θL2

θL2

RL

1

D0

UE

Fig. 16. Computation of PL for 1 ≤ D0 < RL.

Fig. 17. Computation of PL for λ

4π ≤ D0 < 1.

For PT

Pth ≥

(4π)4(hThR)2
λ4

, we have

2π

1
4 √hThR

PT
Pth (cid:17)

(cid:16)

PO =

PTGO(R)RdRdθ.

0
0 Z
Z
Substituting (2) into (57), we obtain

PO = 2π

λ
4π

0
Z

4πhThR
λ

λ
4π
1
4 √hThR

PT

λ
4π

(cid:18)

2

(cid:19)

R−

1dR

PT(hThR)2R−

3dR.

PTRdR + 2π

Z

(cid:16)

PT
Pth (cid:17)
4πhThR
λ

Z

+2π

Following some algebraic manipulations, we obtain

PO =

PTλ2
16π

+

PTλ2
8π

ln

16π2hThR
λ2

(cid:18)

−

(cid:19)

πPth
2

+

λ4PT
29π3(hThR)2 .

Combining (56), and (60), we obtain (19).

B. Proof of Theorem 2

Here, we derive PL,nTM in a closed form. Substituting (28) into (24), we have

PL,nTM =

θr

RL,

min
{

D0
cos θ }

PTGL(R)RdRdθ.

RL: For D0 > RL, we have min

θl Z
Z

0

RL, D0
cos θ

= RL, and therefore

PL,nTM =

θr

RL
(cid:8)

(cid:9)
PTGL(R)RdRdθ.

1) D0 ≥

(57)

(58)

(59)

(60)

(61)

(62)

Following some algebraic manipulations, using (2), and the following Lemma 1, we obtain

θl Z
Z

0

where PL,1 is given in (32).

PL,nTM = PL,1,

(63)

IEEE

Lemma 1. The function Z0 is deﬁned as

Z0(z1, z2, z3, z4, z5) ,

z2

z4

R−

z5dRdθ,

24

(64)

where

−

π

2 < z1 < z2 < π

z1 Z
Z
2 , z3 > 0, z4 > 0, and z5 >

z3

Z0(z1, z2, z3, z4, z5)

≡ 


−
z1) ln
1−z5
z1)(z
4
1

z5

−

(z2 −

(z2

−

1. The closed-form expression is given by

z4
z3
1−z5
(cid:17)
3

(cid:16)
z
−

,

)

z5 = 1,

, z5 6

= 1.

(65)

The proof of this Lemma is straightforward and therefore omitted here.



2) 1

D0 < RL: For 1

≤

Under this condition,

D0 < RL, an example of the toy model is shown in Fig. 16.

≤

PL,nTM =

PTGL(R)dΩ

ZΩPL1

PT

λ
4π

(cid:18)

2

(cid:19)

−

ZΩPL2

R−

nLdΩ,

where ΩPL1 and ΩPL2 are given by

ΩPL1 ,

(R, θ)

n

ΩPL2 ,

θL1, θr}
where θL1 is deﬁned in (35). Next, following some algebraic manipulations, we obtain

< θ < min
{

(R, θ)

(max

{−

(cid:26)

(cid:19)

∧

)

(cid:27)

π
2

∧

−

(cid:16)
R < RL

D0
cos θ ≤

(R < RL)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:18)
(cid:12)
(cid:12)
(cid:12)

< θl < θ < θr <

,

π
2

(cid:17) o
θL1, θl}

and

PTGL(R)dΩ = PL,1,

ZΩPL1

(66)

(67)

,

(68)

(69)

PTGL(R)dΩ = 


ZΩPL2

min
max

θL1,θr
}
{
θL1,θl}
{−

RL
D0
cos θ

R
0,

R

PT( λ
RnL

4π )2
−1 dRdθ,

(θl < θL1)

(θr >

θL1),

−

∧

else,


=



PL,2,

−
0,

(θl < θL1)

(θr >

θL1),

−

∧

else,

where PL,2 is given in (33), and Z1 is computed by the following Lemma 2.



Lemma 2. The function Z1 is deﬁned as follows
z2

Z1(z1, z2, z3, z4, z5) ,

z4
cos(θ)

R−

z5dRdθ,

z1 Z
Z

z3

(70)

(71)

IEEE

where

−

π

2 < z1 < z2 < π

2 , z3 > 0, z4 > 0, and z5 ≥ −
,

z2
4[tan(z2)
−
2

z2)z2
3
−
2

+ (z1

tan(z1)]

Z1(z1, z2, z3, z4, z5)

≡

+ (z1 −
Im[Li2(

z4 ln

tan(z2)+sec(z2)
tan(z1)+sec(z1)

(cid:16)
z1) ln
(z2 −
B( 1
2 ,

−

(cid:17)
2z4
+
z3
sgn(z1)]z1−z5
(cid:17)
(cid:16)
z5
2 )[sgn(z2)
−
z5)
2(1
1−z5
z2)z
+ z
3
−
(1
z5
1
−

−

−

4

+ (z1

sgn(z1) cosz5(z1) 2F1

1−z5
4
z5)z5 ×
z5
2 , 1











25

1. The closed-form expression is given by

z2)z3,

1,

z5 =

−
z5 = 0,

e2jz2 )
−
2

Li2(

−

e2jz1 )]

,

z5 = 1,

(72)

else.

, cos2(z1)

2; z5+2

2

The Lemma is straightforward to verify and the proof of this Lemma is omitted here.

(cid:1)(cid:3)

(cid:0)

(cid:0)
sgn(z2) cosz5(z2) 2F1

(cid:2)
−

z5
2 , 1

2; z5+2

2

(cid:1)
, cos2(z2)

,

Substituting (69) and (70) into (66), we obtain

PL,nTM =

PL,1 + PL,2,

(θl < θL1)




PL,1,

else.

(θr >

θL1),

−

∧

3) λ

4π ≤

D0 < 1: An example of the toy model is shown in Fig. 17, for λ



4π ≤

this condition, PL,nTM is given by

PL,nTM =

ΩPL1

PTGL(R)dΩ

PT

λ
4π

2

R−

nLdΩ

ΩPL2

+

R
ΩPL3

PT

λ
4π

2

R−

(cid:1)
(cid:0)
PT
ΩPL3

λ
4π

2

R−

2dΩ,

−

−
R
nLdΩ

(73)

D0 < 1. Under

(74)

where the ﬁrst term

ΩPL1

R
PTGL(R)dΩ and the second term

R

(cid:1)

(cid:0)

(cid:0)
ΩPL2

(cid:1)
PT

2

λ
4π

R−

nLdΩ are computed

following steps of computing (69) and (70), respectively. For the third and the forth terms, ΩPL3

(cid:0)

(cid:1)

R

R

is deﬁned as

ΩPL3 ,

(R, θ)

θL2, θl}
where θL2 is deﬁned in (36). Further substituting (75) into

R < 1

(max

{−

(cid:26)

(cid:19)

∧

D0
cos θ ≤

(cid:12)
(cid:18)
(cid:12)
(cid:12)
(cid:12)

< θ < min
{

θL2, θr}

)

,

(cid:27)

PT

ZΩPL3

(cid:18)

λ
4π

2

(cid:19)

R−

nLdΩ

PT

λ
4π

(cid:18)

2

(cid:19)

−

ZΩPL3

R−

2dΩ,

(75)

(76)

and following some straightforward mathematical manipulations, we have

PT

ZΩPL3

(cid:18)

λ
4π

2

(cid:19)

R−

nLdΩ

PT

λ
4π

(cid:18)

2

(cid:19)

−

ZΩPL3

R−

2dΩ =

PL,3,

(θl < θL2)

(θr >

θL2),

−

∧

(77)

0,

else,






IEEE

26

where PL,3 is given in (34). Therefore, substituting (69), (70) and (77) into (74), we have

PL,1 + PL,2 + PL,3,

(θl < θL2)

PL,1 + PL,2,

(θl < θL1)

∧

∧

PL,1,

else.

(θr >

θL2),

−

(θr >

θL1)

−

∧

[(θl > θL2)

(θr <

θL2)] ,

−

∨

(78)

Combining (63), (73) and (78), we obtain TABLE I and therefore Theorem 2 is proved.

PL,nTM =






C. Proof of Theorem 3

Here, we derive IL,nTM in closed form. Since RL > 1 is assumed, for R > RL, we have

GL(R) =

λ
4π

2

R−

nL. Substituting (29) into (25), we have

(cid:0)

(cid:1)

IL,nTM =

D0
cos θ

RL

PT

2

λ
4π

(cid:18)

(cid:19)

R1
−

nLdRdθ.

1) RL ≤

D0: For RL < D0, (RL < D0

, and

⊤

Z(θl<θ<θr)
∧

(RL<

D0
cos θ ) Z
cos θ ) =
D0
cos θ

θr

IL,nTM =

PTGL(R)RdRdθ = IL,1,

(79)

(80)

where IL,1 is computed by (39).

θl Z
Z

RL

2) RL > D0: For RL > D0, we can show (81) by using straightforward mathematical

manipulations.

(θl < θ < θr)

RL <

∧

(cid:18)

D0
cos θ

(cid:19)

= (θl < θ < θr)

∧

|
θL1 < θr)

(

θ

|

|

)

>

θL1|
(θl < θ <

= [(θl <

−
[(θl < θL1 < θr)

∧
−
(θL1 < θ < θr)]

θL1)]

∨

∧
(θL1 < θl)]

[(θr <

θL1)

−

∨

∨ {

(θl < θ < θr)

(81)

.

}

∧

Substituting (81) into (79), we obtain the closed-form expression of IL,nTM for RL > D0 as

IL,nTM =

(θL1 < θl) ,

IL,1,

IL,2,

IL,3,

(θr <

(θl <

(θl <

θL1)

∨
θL1 < θr)

−

−

θL1 < θr)

−

(θl < θL1 < θr) ,

(θl < θL1 < θr) ,

∨

∨

(82)

−
where IL,2 and IL,3 are respectively computed by (40) and (41). Combining (80) and (82), we

∨

IL,2 + IL,3,

(θl <

θL1 < θr)

(θl < θL1 < θr) .

obtain TABLE II, and therefore Theorem 3 is proved.






IEEE

D. Proof of Theorem 4

We now derive PN,nTM in a closed form. Substituting (30) into (26), we have

RN

1) D0 ≥

PN,nTM =

PTGN(R)RdRdθ.

(RN>
RN: For D0 > RN, (RN > D0
cos θ ) =

Z(θl<θ<θr)
∧

D0
cos θ ) Z

D0
cos θ
, and therefore

⊥

PN,nTM = 0.

2) 1

D0 < RN: For 1

D0 < RN

≤

≤
PN,nTM =

λ
4π
(cid:19)
where θL1 is deﬁned in (35), and ΩPN1 is deﬁned as
D0
cos θ ≤
{−
Following some algebraic manipulations, we obtain

ΩPN1 ,

R < RN

ZΩPN1

(R, θ)

(max

PT

(cid:26)

(cid:19)

(cid:18)

∧

(cid:12)
(cid:18)
(cid:12)
(cid:12)
(cid:12)

2

R−

nNdΩ,

θN1, θl}

< θ < min

θN1, θr}

)

{

.

(cid:27)

PN,nTM =

PT

ZΩPN1

(cid:18)

λ
4π

2

(cid:19)

R−

nNdΩ =

PN,1,

(θl < θN1)




0,

else,

(θr >

θN1),

−

∧

where Z1 is deﬁned in (71) and computed by (72). PN,1 is computed by (42).



D0 < 1, an example of the toy model is shown in Fig. 18. Under

27

(83)

(84)

(85)

(86)

(87)

3) λ

4π ≤
this condition,

D0 < 1: For λ

4π ≤

PN,nTM =

PT

ZΩPN1

(cid:18)

λ
4π

2

(cid:19)

R−

nNdΩ

−

where θN2 is deﬁned in (45),

PT

ΩPN2

as

ΩPN2 ,

(R, θ)

R

D0
cos θ ≤

(cid:26)

(cid:18)

(cid:12)
(cid:12)
(cid:12)
(cid:12)

third terms of (88), we have

2

R−

nNdΩ +

PT

λ
4π

2

R−

2dΩ,(88)

λ
4π

(cid:19)

(cid:18)
nNdΩ is computed by (87), and ΩPN2 is deﬁned

(cid:18)

(cid:19)

ZΩPN2

PT

R−

ZΩPN2
2
λ
4π

(cid:0)

(cid:1)

Following some straightforward computations by substituting (89) into the second and the

R < 1

(max

θN2, θl}

{−

∧

< θ < min

θN2, θr}

)

{

.

(89)

(cid:27)

(cid:19)

PT

λ
4π

2

R−

2dΩ

−

PT

λ
4π

2

R−

nNdΩ =

(cid:18)

ZΩPN2
where PN,2 is computed by (43). Therefore, for λ

ZΩPN2

(cid:19)

(cid:19)

(cid:18)

PN,2,

(θl < θL2)




0,

else,

(θr >

θL2),

−

∧

(90)

D0 < 1, PN,nTM is given by

4π ≤


θN2),

−

(θr >

(θr >

θN1)

−

∧

[(θl > θN2)

(θr <

θN2)] ,

−

∨

(91)

PN,1 + PN,2,

(θl < θN2)

PN,1,

0,

(θl < θN1)

else.

∧

∧

PN,nTM =






Combining (84), (87) and (91), we obtain TABLE III and therefore Theorem 4 is proved.

IEEE

ΩPN1
ΩPN2

θl

-θN1

θ = 0

θr

-θN2

θN2

RN

1

D0

UE

28

θl

θ = 0

θr

-θN1

D0

RN

ΩNI1
ΩNI2

UE

Fig. 18. Computation of PN for λ

4π ≤ D0 < 1.

Fig. 19. Computation of IN for 1 ≤ D0 < RN.

E. Proof of Theorem 5

Here, we derive IN,nTM in a closed form. Substituting (31) into (27), we have

1) RN < D0: For RN < D0, we have

θr

+

∞

IN,nTM =

Z

θl Z

D0
cos θ }

RL,

max
{
max

IN,nTM =

θr

+

∞

D0
cos θ

2

(cid:0)
PT

(cid:18)

(cid:8)
λ
4π

(cid:19)

PTGN(R)RdRdθ.

(92)

RL, D0
cos θ

= D0
cos θ

=

. Therefore, we obtain

⊤

R1
−

(cid:9)
nNdRdθ = IN,1,

(cid:1)

(93)

θl Z
Z
where IN,1 is computed by (46).

2) RN > D0: For RN > D0, an example of the toy model is shown in Fig. 19. Under this

condition,

IN,nTM =

PT

ZΩIN1

(cid:18)

λ
4π

2

(cid:19)

R−

nNdΩ

PT

λ
4π

(cid:18)

2

(cid:19)

−

ZΩIN2

R−

nNdΩ,

where ΩIN1 and ΩIN2 are deﬁned as

D0
cos θ

π
2

ΩIN1 ,

(R, θ)

R

(cid:26)

ΩIN2 ,

(cid:12)
(cid:18)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:18)
(cid:12)
Following some algebraic manipulations, we have
(cid:12)
(cid:12)

(cid:16)
R < RN

(R, θ)

≥
D0
cos θ ≤

−

(cid:26)

(cid:19)

(cid:19)

∧

∧

< θl < θ < θr <

,

π
2

(cid:17) (cid:27)
< θ < min

(max

θN1, θl}

{−

IN,nTM =

IN,1 + IN,2,

(θl < θL2)




IN,1,

(θl > θL2)

(θr >

(θr <

θL2),

−

θL2),

−

∧

∨

(94)

(95)

θN1, θr}

)

{

(cid:27)

. (96)

(97)

where IN,2 is computed by (47). Combining (93) and (97), we obtain TABLE IV, and therefore



Theorem 5 is proved.

IEEE

29

[1] Cisco, “Cisco vision: 5G-thriving indoors,” [Online], https://www.cisco.com/c/dam/en/us/solutions/collateral/service-provider/ultra-services-platform/5g-ran-indoor.pdf.

[2] M. Giordani, et al., “Toward 6G networks: Use cases and technologies” IEEE Commun. Mag., vol. 58, no. 3, pp. 55-61,

REFERENCES

2020.

[3] X. Ge, et al., “5G ultra-dense cellular networks,” IEEE Wireless Commun., vol. 23, no. 1, pp. 72-79, 2016.

[4] L. Wang, “Wireless powered dense cellular networks: how many small cells do we need?” IEEE J. Sel. Areas Commun.,

vol. 35, no. 9, pp. 2010-2024, 2017.

[5] J. Chen, et al., “Coverage and handoff analysis of 5G fractal small cell networks,” IEEE Trans. Wireless Commun., vol 18,

no. 2, pp. 1263-1276, 2019.

[6] X. Ge, et al., “Small cell networks with fractal coverage characteristics,” IEEE Trans. Commun., vol. 66, no. 11, pp.

5457-5469, 2018.

[7] J. Zhang, et al., “Femtocells-technologies and deployment,” Wiley, 2010.

[8] D. Lopez, et al., “OFDMA femtocells: a roadmap on interference avoidance,” IEEE Commun. Mag., vol. 47, no 9, pp.

41-48, 2009.

[9] A. H. Jafari, et al., “Performance analysis of dense small cell networks with practical antenna heights under Rician fading,”

IEEE Access, vol. 6, pp. 9960-9974, 2017.

[10] X. Ge, et al., “Joint optimization of computation and communication power in multi-user massive MIMO systems,” IEEE

Trans Wireless Commun., Vol. 17, No. 6, pp. 4051-4063, 2018.

[11] J. Hoydis, et al., “Massive MIMO in the UL/DL of cellular networks: How many antennas do we need?” IEEE J. Sel.

Area Commun., vol. 31, no. 2, pp. 160-171, 2013.

[12] E. G. Larsson, et al., “Massive MIMO for next generation wireless systems,” IEEE Commun. Mag. vol. 52, no. 2, pp.

186-195, 2014.

[13] L. Lu, et al., “An overview of massive MIMO: Beneﬁts and challenges,” IEEE J. Sel. Topics Sig. Proc., vol. 8, no. 5, pp.

742-758, 2014.

[14] T. Nam and T. A. Pardo, “Conceptualizing smart city with dimensions of technology, people, and institutions,” in Proc.

Annual International Conference on Digital Government Research, pp. 282-291, 2011.

[15] Ranplan Wireless Network Design,“Method for evaluating the building wireless performance,” Patent, 2019.

[16] J. Zhang, et al., “Wireless energy efﬁciency evaluation for buildings under design based on analysis of interference gain,”

IEEE Trans. Veh. Tech., vol. 69, no. 6, pp. 6310-6324, 2020.

[17] D. Yagaanbuant, et al., “Some design issues of high-rise buildings,” in Proc. IFOST, 2007.

[18] L. P´erez-Lombard, et al., “A review on buildings energy consumption information,” Energy and buildings, vol. 40, no. 3,

pp. 394-398, 2008.

[19] CIBSE, “TM54: evaluating operational energy performance of buildings at the design stage,” CIBSE, 2013.

[20] D. Feng, et al., “A survey of energy-efﬁcient wireless communications,” IEEE Commun. S. & Tutor., vol. 15, no. 1, pp.

167-178, 2013.

[21] C. L. I, et al., “Energy-efﬁcient 5G for a greener future,” Nat. Electron., vol. 3, pp. 182-184, 2020.

[22] A. Abrol and R. K. Jha, “Power optimization in 5G Networks: a step towards green communication,” IEEE Access, vol.

4, pp. 1355-1374, 2016.

[23] H. Zheng, et al., “Exact line-of-sight probability for channel modelling in typical indoor environments,” IEEE Ant. Wireless

Prop. Lett., vol. 17, no. 7, pp. 1359-1362, 2018.

IEEE

30

[24] W. Yang, et al., “Line-of-sight probability for channel modeling in 3D indoor environments,” IEEE Ant. Wireless Prop.

Lett., vol. 19, no. 7, pp. 1182-1186, 2020.

[25] W. Yang, et al., “Machine learning based indoor line-of-sight probability prediction,” in Proc. IEEE ISAP, 2019.

[26] T. Bai, et al., “Coverage and rate analysis for millimeter-wave cellular networks,” IEEE Trans. Wireless Commun., vol. 4,

no. 2, pp. 1100-1114, 2015.

[27] M. K. M¨uller, et al., “Analyzing wireless indoor communications by blockage models,” IEEE Access, vol. 5, pp. 2172-2186,

2017.

[28] K. Haneda, et al., “Spatial coexistence of millimeter-wave distributed indoor channels,” in Proc. IEEE VTC-Spring, 2015.

[29] L. Azpilicueta, et al., “A hybrid ray launching-diffusion equation approach for propagation prediction in complex indoor

environments,” IEEE Ant. Wireless Prop. Lett., vol. 16, pp. 214-217, 2017.

[30] P. H. Tseng, et al.,“Ray-tracing-assisted ﬁngerprinting based on channel

impulse response measurement for indoor

positioning,” IEEE Trans. Ins. Mea., vol. 66, no. 5, pp. 1032-1045, 2017.

[31] F. Casino, et al., “Optimized wireless channel characterization in large complex environments by hybrid ray launching-

collaborative ﬁltering approach,” IEEE Ant. Wireless Prop. Lett., vol. 16, pp. 780-783, 2017.

[32] Z. Lai, et al., “Modelling the mmWave channel based on intelligent ray launching model,” in Proc. Eucap, 2015.

[33] W. Yang, et al., “Indoor measurement based veriﬁcation of ray launching algorithm at the Ka-band,” in Proc. URSI GASS,

2020.

[34] Z. Lai, et al., “Intelligent ray launching algorithm for indoor scenarios,” Radioengineering, vol. 20, no. 2, 2011.

[35] EUROSTARS Project 11088 BuildWise: The development of a software tool to design buildings with tailored wireless

performance (Ranked the 16th among 331 applications), [Online]. https://www.eurostars-eureka.eu/project/id/11088, 2017.

[36] X. Zhang and J. Andrews. “Downlink cellular network analysis with multi-slope path loss models,” IEEE Trans. Commun.,

vol. 63, no. 5, pp. 1881-1894, 2015.

[37] C. Sommer and F. Dressler, “Using the right two-ray model? a measurement based evaluation of PHY models in VANETs,”

in Proc. ACM MobiCom, 2011.

[38] 3GPP, “Study on channel model for frequencies from 0.5 to 100 GHz,” 3GPP TR 38.901 version 14.0.0 Release 14, 2017.

[39] U. Madhow, et al.,“Distributed massive MIMO: algorithms, architectures and concept systems,” in Proc. IEEE ITA, 2014.

[40] S. Fu, et al.,“Distributed transmission scheduling and power allocation in CoMP,” IEEE Sys. J., vol. 12, no. 4, pp. 3096-

3107, 2018.

[41] E. Pateromichelakis et al., “On the evolution of multi-cell scheduling in 3GPP LTE/LTE-A,” IEEE Commun. Surveys Tuts.,

vol. 15, no. 2, pp. 701-717, 2013.

[42] J. G. Andrews, et al., “What will 5G be?” IEEE J. Sel. Area Commun., vol. 32, no. 6, pp. 1065-1082, 2014.

[43] D. S. Baum,

et

al.,

“IST-WINNER D5.4, ﬁnal

report

on

link

and

system level

channel models,”

https://www.researchgate.net/publication/229031750 IST-2003-507581 WINNER D5 4 v 14 Final Report on Link Level and System Level Channel Models,

2005.

