7
1
0
2

b
e
F
2
2

]

R
S
.
h
p
-
o
r
t
s
a
[

1
v
8
0
8
6
0
.
2
0
7
1
:
v
i
X
r
a

Testing the Accuracy of Data Driven MHD Simulations of Active Region Evolution

James E. Leake∗
U.S. Naval Research Lab 4555 Overlook Ave., SW Washington, DC 20375 and
NASA Goddard Space Flight Center, 8800 Greenbelt Rd, Greenbelt, MD 20771

Mark G. Linton
U.S. Naval Research Lab 4555 Overlook Ave., SW Washington, DC 20375

Peter W. Schuck
NASA Goddard Space Flight Center, 8800 Greenbelt Rd, Greenbelt, MD 20771
(Dated: October 9, 2018)

Models for the evolution of the solar coronal magnetic ﬁeld are vital for understanding solar
activity, yet the best measurements of magnetic ﬁeld lie at the photosphere, necessitating the devel-
opment of coronal models which are “data-driven” at the photosphere. We present an investigation
to determine the feasibility and accuracy of such methods. Our validation framework uses a simula-
tion of active region (AR) formation, modeling the emergence of magnetic ﬂux from the convection
zone to the corona, as a ground-truth dataset, to supply both the photospheric information, and
to perform the validation of the data-driven method. We focus our investigation on how the data-
driven model accuracy depends on the temporal frequency of the driving data. The Helioseismic
and Magnetic Imager on NASA’s Solar Dynamics Observatory produces full-disk vector magnetic
ﬁeld measurements at a 12 minute cadence. Using our framework we show that ARs that emerge
over 25 hours can be modeled by the data-driving method with only ∼1% error in the free magnetic
energy, assuming the photospheric information is speciﬁed every 12 minutes. However, for rapidly
evolving features, under-sampling of the dynamics at this cadence leads to a strobe eﬀect, gener-
ating large electric currents and incorrect coronal morphology and energies. We derive a sampling
condition for the driving cadence based on the evolution of these small-scale features, and show
that higher-cadence driving can lead to acceptable errors. Future work will investigate the source
of errors associated with deriving plasma variables from the photospheric magnetograms as well as
other sources of errors such as reduced resolution and instrument bias and noise.

I.

INTRODUCTION AND MAIN RESULT

In order to understand the complex interplay of mag-
netic, hydrodynamic, and thermal forces associated with
the onset of various manifestations of solar activity, it
is vital to know the magnetic ﬁeld in the solar corona,
where the storage and release of energy in non-potential
(J = ∇ × B/µ0 (cid:54)= 0) magnetic ﬁelds is the cause of solar
ﬂares, coronal mass ejections (CMEs), and prominence
eruptions. However, as yet no method exists to accu-
rately achieve this goal. Fortunately, multiple missions
such as the Solar Optical Telescope on Hinode [SOT,
23], the Helioseismic and Magnetic Imager on the Solar
Dynamics Observatory [HMI/SDO, 19], Big Bear Solar
Observatory’s New Solar Telescope [7], and the National
Solar Observatory’s upcoming Daniel K. Inouye Solar
Telescope [DKIST, 22] are/will be able to observe the
magnetic ﬁeld at the photosphere. Currently, with HMI
there are observations of the Sun’s surface vector mag-
netic ﬁeld at one optical depth every 12 minutes. These
data can be used in a variety of ways to estimate the
coronal magnetic ﬁeld, using a number of assumptions.

One approach is to use measurements of the magnetic
ﬁeld at the photospheric surface, assuming that the con-

∗ james.e.leake@nasa.gov. JEL previously at [1], now at [2].

stant optical depth surface can be transformed to a con-
stant depth surface, and extrapolate the magnetic ﬁeld
into the domain above this surface, using either the po-
tential, J = 0, or more general force-free, J × B = 0
[e.g., 25, 26], approximations. These extrapolation meth-
ods are able to produce estimates of the 3D magnetic
ﬁeld at discrete times during an active region’s evolu-
tion based on the magnetogram data, and are used to
estimate useful indices, such as the free magnetic energy
(Ef ree ≡ E − Epot where E is the total magnetic en-
ergy, and Epot is the energy of the potential magnetic
ﬁeld). However, the approximations used in these ex-
trapolations (namely β = 2µ0P/B2 = 0 where P and B
are the gas pressure and magnetic ﬁeld strength, respec-
tively) are not generally true in the lower solar atmo-
sphere above where the photospheric data are observed.
Furthermore, Peter et al. [18] recently revisited the basic
assumptions associated with the force-free ﬁeld extrapo-
lations, guided by analysis of the MHD equations, global
energy considerations, and 3D MHD simulations. Their
analysis suggests that the relative diﬀerence between the
total energy in a volume of the atmosphere, and that
obtained from a force-free extrapolation, which assumes
β = 0, can be of the order of the plasma β averaged over
that volume.

In recent years, the dynamic coronal magnetic ﬁeld
has been modeled by considering the ﬁeld evolution as
a succession of equilibria, with boundary conditions in-

 
 
 
 
 
 
formed by measurement of the photospheric magnetic
ﬁeld. These “data-driven” models have various assump-
In the magneto-frictional (MF) approach [e.g.,
tions.
4, 24], the lower boundary of a zero-β (no plasma forces)
coronal model is periodically updated with photospheric
magnetic ﬁeld observations, and the velocity everywhere
is set proportional to the Lorentz force. Then an equi-
librium is found before the next input of photospheric
data.

Relaxing the zero-β approximation, recent data-driven
MHD approaches assume a low β atmosphere and update
the lower boundary with the observed normal magnetic
ﬁeld and user-deﬁned velocities. At t = 0 a potential
ﬁeld extrapolation is used to ﬁll the coronal volume, and
after each update of the normal ﬁeld and velocities on
the boundary, the system is allowed to relax to a new
equilibrium. The boundary velocities are derived from
either (a) local correlation tracking methods [2, 3, 9],
(b) imposed density perturbations proportional to the
horizontal magnetic ﬁeld magnitude at the surface [10,
11], or (c) by the method of MHD characteristics [27].

While these data-driven models of the solar atmo-
sphere represent an attractive approach to determining
the magnetic ﬁeld in the corona, there are many limi-
tations that need to be evaluated: The lower boundary
is assumed to be zero-β or low-β either by reducing the
driving magnetic ﬁeld strength, using coronal densities
and temperatures, or both, and in general, only the nor-
mal component of the magnetic ﬁeld vector is used. Fur-
thermore, these methods use the photospheric magnetic
ﬁeld, with the other MHD quantities being inferred using
various assumptions, to calculate a series of MHD equilib-
ria, rather than to dynamically drive an MHD simulation
at the photospheric boundary.

In this work it will be shown that this latter approach,
that of driving a dynamic MHD model above the photo-
sphere using observed MHD variables, is achievable given
enough photospheric data. Furthermore, a framework is
developed to test and validate such a method. There
are multiple sources of error associated with the estima-
tion of the coronal magnetic ﬁeld using this data-driving
approach. Two such sources are: (1) inferring the pho-
tospheric plasma velocity, density and temperature when
one only has measurements of the magnetic ﬁeld at the
photosphere, and (2) limited cadence of the photospheric
data. This study focuses on the latter of these two issues
here: Suppose one has exact measurements of all the nec-
essary MHD variables to use as boundary conditions to
drive a dynamic MHD model of the photosphere, chro-
mosphere and corona, at a particular temporal frequency.
How accurate can such a data-driven solution of the coro-
nal magnetic ﬁeld be, and how does the accuracy depend
on the particular frequency of the driving data and on the
temporal evolution of the active region’s surface magnetic
ﬁeld? These are important questions, as the answers can
tell us whether the standard HMI time interval of 12 min-
utes is suﬃcient to accurately describe the coronal mag-
netic ﬁeld above active regions using data-driven MHD

2

FIG. 1. Absolute value of the error in the free magnetic energy
in a data-driven run of simulated active region emergence,
compared to the ground-truth run, as a function of the time
it takes the active region to emerge. The data-driven runs
use a driving interval of 12 minutes, the standard temporal
resolution of available HMI magnetograms.

modeling. It can also guide us as to which active regions
are appropriate to study with such methods, and which
evolve too quickly to be accurately modeled at such a
driving interval.

Ideally, one would test the accuracy of such a data-
driven simulation by comparing the estimated MHD so-
lution with the actual temporal evolution of the MHD
variables in the domain above the surface. Obviously,
this latter ground-truth dataset does not exist for solar
observations. In this study, in lieu of this ground-truth,
a dynamic MHD simulation of active region formation is
run. This domain extends from below the surface into
the corona, and models the emergence of magnetic ﬂux
from the upper layers of the convection zone through
the stratiﬁed layers of the photosphere and chromo-
sphere, into the corona. Time-series of photospheric data
are extracted from this “ground-truth” dataset. These
“pseudo-magnetograms” (which also include the velocity,
density, and temperature) are used as a dynamic lower
boundary condition for a new “data-driven” run which
extends from the photosphere to the corona.

Using this framework the accuracy of the data-driving
method is calculated, by comparing the ground-truth and
data-driven runs, using various error diagnostics, and in-
ferences are made on the required temporal information
required to obtain satisfactory results with real observa-
tional data.

Figure 1 shows the main results from our investiga-
tion, and plots the absolute value of the percentage error
in the free magnetic energy, comparing the data-driven
MHD solution to the ground-truth dataset, for a data-
driving interval of 12 minutes, and for varying emergence
timescale (see §III A for the deﬁnition of this error mea-
sure). The range of emergence timescales is spanned by
varying the ﬂux, twist, and initial depth of the convection
zone magnetic ﬁeld in the ground-truth run. The ﬁgure

highlights that, generally, the longer that an active re-
gion takes to emerge, the more accurate the data-driven
MHD solution can be, when using a ﬁxed driving interval
of 12 minutes.

For active regions that emerge over long timescales
the error in the free magnetic energy can be as low as
1%. The two red points are exceptions to this rule and,
as will be shown, are results from active regions where
small scale features vary on timescales shorter than 12
minutes. The details of the procedures used to gener-
ate this ﬁgure are contained in the following sections, in
which the methodology of using self-consistent dynamic
MHD simulations of AR formation to test data-driven
coronal models is prescribed, and results are presented
on how the driving data interval aﬀects the accuracy of
the data-driven MHD solution.

II. USING MHD SIMULATIONS TO TEST THE
ACCURACY OF DATA-DRIVEN MODELS OF
THE MAGNETIC FIELD ABOVE ACTIVE
REGIONS

A. Ground Truth MHD Simulations

Our ground-truth dataset is a simulation of the dy-
namic emergence of a twisted ﬂux tube from the con-
vection zone into the corona. This type of simulation
has been used previously to understand the emergence
of magnetic ﬂux though the convectively stable layers
of the photosphere and above, the formation of bipolar
active regions, the observed shearing and rotational mo-
tions seen in active regions, the build up of coronal elec-
trical current, and the creation of stable and unstable
coronal ﬂux ropes [see living review by 5]. The equations
solved and the details of the setup of the simulation can
be found in Leake, Linton, and Antiochos [13], and the
details of the setup are merely summarized here. The
simulations are performed using the Lagrangian Remap
(LaRe) code Arber et al. [1] which evolves the MHD vari-
ables on a staggered cartesian grid. The initial thermo-
dynamic state is a hydrostatic atmosphere consisting of a
model convection zone, photosphere/chromosphere, tran-
sition region, and corona, and this is the same in all the
simulations in this study. A 1D slice of this initial atmo-
sphere can be seen in Figure 2. Into the model convection
zone a buoyant twisted magnetic ﬂux tube structure is
inserted, aligned along the ˆy direction:

(cid:16)

B = Bt

−q(z − zt)e−(r/a)2

, e−(r/a)2

, qxe−(r/a)2 (cid:17)

(1)

where y is the axial direction of the tube, z is the vertical
direction, Bt is the axial ﬁeld strength at the center of
the tube, a is the width of the Gaussian proﬁle, q is the
twist, and zt is the tube depth. The domain is 87Mm
in the horizontal (x) direction, and extends from -10Mm
to 50Mm in the vertical (z) direction for simulations 1-
4 and from -37Mm to 50Mm for simulations 5-9, where
z=0 denotes the photosphere.

3

FIG. 2. Initial hydrostatic equilibrium. The three Gaussian-
shaped curves are the magnetic pressure of the ﬂux tube in
Simulations 2, 5, and 9.

The majority of previous ﬂux emergence simulations,
including those in Leake, Linton, and T¨or¨ok [14] and
Leake, Linton, and Antiochos [13], are relatively small,
based on the axial ﬂux in the tube and the size of the ac-
tive region, with a typical ﬂux < 1020 Mx. Some larger
scale simulations have recently been performed, and sug-
gest that the mechanism for emergence is similar to that
in the smaller-scale scenarios, and that the emergence
rate depends on the ﬁeld strength, depth, width, and
twist of the initial ﬂux tube [17].

The simulations are run in 2.5D, which means there are
no variations in the axial (ˆy) direction but there is still
a component of the vector ﬁelds in this direction. This
allows us to run simulations for many realizations of the
model parameter space and extensively investigate the
accuracy of the “data-driven” models described below.
Table I shows the initial model parameters used for 9
ground-truth simulations, along with derived quantities
in those simulations. Figure 2 shows the initial magnetic
pressure as a function of height for a selection of those
simulations.

The details of the general evolution of this initial con-
dition can be seen in the top panels of Figure 3, and
are discussed in Leake, Linton, and Antiochos [12]: As
the tube rises it expands horizontally when it reaches the
stable surface layers, and then emerges through these sta-
ble layers and into the corona by virtue of the magnetic
buoyancy instability.

For each realization of the parameter space in Table I,
the emerging active region exhibits a diﬀerent emergence
rate. The emergence time, temerge, is deﬁned as the time
elapsed between 10% and 90% of the maximal potential
magnetic energy emerging above the surface. The po-
tential energy above the surface is (cid:82)
x,z>0 Bpot(x, z)dxdz
where Bpot is the potential magnetic ﬁeld with the same
normal component on the boundary as the total magnetic
ﬁeld. Plots of the potential energy above the surface,

4

FIG. 3. Panels (a)-(c): Plots of log10(B2/B2
0 ) where B0 = 1300 G, at 0 (a), 1.0 (b), and 1.7 (c) hours for the ground-truth run
for Simulation 2. Panels (d)-(f) are the same but for the data-driven run using a driving interval of 2.4 s. The black lines are
contours of constant magnetic ﬂux out of the plane. In panels (d)-(f), blank space below z = 0 has been included, even though
z < 0 is outside the domain in the data-driven runs, as a visual aid for comparing them with the ground-truth runs.

normalized to its maximal value, are shown for Simula-
tions 2, 5, and 9 in Figure 4. As can be seen in Table I,
our parameter study provides a range of emergence times
from less than 1 hour to ∼ 25 hours, and so allows us to
make conclusions regarding active regions which form on
a wide range of timescales.

B. Data-Driven Simulations

The MHD simulations described in §II A model the
evolution of magnetic ﬁeld as it buoyantly rises from the
upper layers of the convection zone through the stratiﬁed
layers of the photosphere and chromosphere, and into the
corona. Time-series of photospheric data are then ex-
tracted from this ground-truth dataset. These “pseudo-
magnetograms” (which also include the velocity, density,
and temperature) are used as a dynamic lower bound-
ary condition for a new “data-driven” run which extends
from the photosphere to the corona. The ground-truth
and data-driven runs are then compared above the sur-
face to test the accuracy of the data-driving method, us-
ing certain error diagnostics. Provided enough temporal

FIG. 4. Potential energy above z = 0 for Simulations 2, 5,
and 9, normalized to the maximum potential energy for each
simulation.

and spatial resolution is applied, and provided the lower
boundary is driven consistently with the MHD equations,
the magnetic ﬁeld above the photosphere in the data-
driven and ground-truth runs should be the same (within

5

Sim. B ﬁeld Tube width Tube twist Tube depth Beta Emergence time Free energy error

Bt (kG)
3.90
6.50
5.00
3.90
13.0
13.0
13.0
8.00
8.00

1
2
3
4
5
6
7
8
9

a (Mm)
0.85
2.25
2.25
2.25
4.25
4.25
4.25
4.25
4.25

qa
1.00
0.50
0.50
0.50
0.50
0.50
0.40
0.50
0.50

zt (Mm)
-4.08
-5.44
-5.44
-5.44
-17.0
-20.4
-20.4
-20.4
-20.4

βtube
51.06
29.80
51.06
84.55
144.0
230.1
230.5
609.0
609.0

temerge (hours)
0.83
1.27
1.91
2.36
4.98
6.90
8.05
12.17
24.92

1 − (cid:15)f ree (%)
+46.9
+19.7
+13.0
+6.27
-496.0
+1.50
-124.0
+1.30
+1.20

TABLE I. Simulation parameters and results, ordered by emergence time. The red rows are particular simulations discussed
later in this paper. The ﬁnal column are results from analysis of the error in the associated data-driven run, discussed in §III B.
βtube is deﬁned at the center of the tube.

the typical accumulation of machine precision errors over
space and time).

Figure 5 shows where the MHD variables are evolved
on the staggered 2.5D LaRe grid. The cell center for the
iz-th vertical cell is located at a height of zc(iz) and the
cell edge is located at zb(iz). Density (ρ), energy ((cid:15)),
and the horizontal magnetic ﬁeld components (Bx, By)
are deﬁned at cell centers. The vertical magnetic ﬁeld
(Bz) is deﬁned on the top cell edge, and the velocity
vector V is deﬁned on the cell vertex.

MHD only requires spec-
iﬁcation of variables on
the lower boundary of the
data driven runs at zb(0).
However, presently, LaRe
treats the boundary cells
of the driven simulation
with the same equations
as the interior cells of the
simulation. Therefore, be-
cause of the 3rd order gra-
dients used in the remap
step in LaRe, the integra-
tion method requires infor-
mation from two surround-
ing cells in each direction
to evolve the system. For
example, evolution of val-
ues at zc(1) requires infor-
mation from zc(0) and zc(-
1) which are formally exterior to the driven simulation.
This approach, in a study which is focused on the ef-
fects of the temporal cadence of the driving data, al-
lows for a proof of concept of the data-driving method
and allows the speciﬁcation of errors associated with in-
suﬃcient temporal information. This approach, how-
ever, may over-specify the boundary information in cer-
tain conditions. Future work will investigate particular
choices of boundary implementation, such as the method
of characteristics [e.g., 27] to determine which MHD vari-
ables are required at the boundary.

FIG. 5. Vertical grid of the
LaRe code. The boundary
and ghost cells are colored
red.

In the data-driven run, the boundary is supplied with

all the MHD variables (magnetic ﬁeld, velocity, pres-
sure, and temperature) at discrete intervals, and between
those times interpolation is used to update the bound-
ary conditions for each iteration of the numerical code.
Figure 3 shows the result of this data-driving process
at various times during the emergence of magnetic ﬂux
from beneath the surface, for Simulation 2. The snap-
shots are taken at 1, 1.7, and 2.4 hours. The top pan-
els show the ground-truth emergence run, and the bot-
tom panels show the data-driven run, when the pseudo-
magnetograms are applied to the data-driven bound-
ary every 2.4 s, which is much smaller than the emer-
gence timescale of 1.27 hours (Table I), and is approxi-
mately equal to the initial CFL [6] limited timestep in
the simulation. This timestep is deﬁned as dtCF L =
min(dx/|V|, dx/Cf ) where Cf = (cid:112)C 2
A, where dx
is the grid-cell resolution (170km), and where Cs and CA
are the local acoustic and Alfv´en speed, respectively.

s + C 2

Figure 3 shows that the data-driving process is success-
ful on a fundamental level: the magnetic ﬂux appears at
the photosphere in the data-driven run where no signiﬁ-
cant ﬂux was initially present at all in the domain. Not
only that, but the ﬂux distribution it generates within the
domain looks visually to be the same as what is gener-
ated in the ground truth run, where it is self-consistently
generated by ﬂux emergence, rather than by boundary
driving.

In the next section, the simulations will be examined
using quantitative error analysis, focusing on how the
errors vary when one drives at slower cadences, which are
more representative of cadences associated with standard
photospheric observations.

III. RESULTS

In this section results of quantitative error analysis
are presented, ﬁrst focusing in detail on one simulation
(Simulation 2) that has an emergence timescale of 1.27
hours, and then expanding to the nine simulations listed
in Table I. For each Simulation, the frequency at which
the pseudo-magnetograms from the ground-truth run are

6

FIG. 6. Spatial representation of the error in the data-driven run, given by log10 (|1 − b2
interval of 0.04 minutes, or 2.4 seconds.

i /B2

i |), for Simulation 2 with a driving

used to drive data-driven runs is varied.

A. Case-Study of Simulation 2

For a better visual comparison of the 2.4s data-driven
and the ground-truth run for Simulation 2, Figure 6
shows the diﬀerence in the two magnetic ﬁeld solutions at
the same three moments in time (1, 1.7, and 2.4 hours).
The diﬀerence is calculated at each pixel (i) in the 2D
driven domain as log10 (|1 − b2
is the
ground-truth magnetic ﬁeld and bi is the data-driven
magnetic ﬁeld. The errors appear maximal at the edge
of the emerging structure, with lower errors inside the
emerging magnetic ﬁeld.

i |) where Bi

i /B2

To further compare the datasets of magnetic ﬁeld be-
tween the ground-truth and data-driven runs, a set of
error metrics based on some of the scalar functions used
in Schrijver et al. [20] is used:

1 − Cvec = 1 −

(cid:46)(cid:115)(cid:88)

(bi · Bi)

(cid:115)(cid:88)

b2
i

B2
j

i

j

(cid:88)

i

En =

(cid:88)

i

1 − (cid:15) = 1 −

1 − φy = 1 −

1 − φx = 1 −

(cid:46) (cid:88)

|bi − Bi|

|Bi|

(cid:88)

i
(cid:88)

i

|bi|2(cid:46) (cid:88)

|Bi|2

i
(cid:46) (cid:88)

by,i

By,i

i
(cid:88)

i
(cid:46) (cid:88)

bx,i

Bx,i

1 − (cid:15)f ree = 1 −

i,x=0
(cid:88)

i,x=0

(cid:0)|bi|2 − |bpoti|2(cid:1) (cid:46)

i

(cid:0)|Bi|2 − |Bpoti|2(cid:1)

(cid:88)

i

(2)

where the subscript pot represents the potential magnetic

ﬁeld. These functions represent, respectively, the vector
correlation (1 − Cvec), the normalized vector error (En),
the error in the total magnetic energy (1 − (cid:15)), the errors
in the out-of-plane (y) and horizontal (x) ﬂux (1−φy, 1−
φx), and the error in the free magnetic energy (1 − (cid:15)f ree).
The last metric is a new metric, equal to 1 minus the ratio
of free magnetic energy in the data-driven run to that in
the ground-truth run. Note that if bi = Bi everywhere,
then all of these functions are identically zero.

FIG. 7. CFL limited timestep as a function of time for Sim-
ulation 2.

To investigate the eﬀect of the temporal frequency of
the driving data on the accuracy of the data-driven solu-
tion, the frequency with which boundary data is supplied
to the data-driven runs is varied, and linear interpolation
is used at steps between data inputs. The data-driven
and ground-truth runs are compared above the surface
to test the accuracy of the data-driving. Primary driving
timescales of [0.04, 0.12, 0.4, 1.2, 4, 12] minutes are used,
the largest being the standard timescale of the HMI mag-

netic ﬁeld data. Two additional data-driven runs are per-
formed. The ﬁrst is driven every dtCF L where dtCF L is
the CFL limited timestep of the numerical scheme. Fig-
ure 7 shows dtCF L as a function of time for Simulation 2.
The timestep decreases signiﬁcantly when magnetic ﬁeld
emerges into the low density corona and the Alfv´en speed
increases. The second additional data-driven run is pro-
vided with boundary data at every substep within one
CFL iteration of the numerical code where an interior
MHD variable is updated. This particular “sub-CFL”
data-driven run should thus result in the same atmo-
sphere above z = 0, with errors equal to spatially and
temporally accumulated machine precision errors for the
chosen error metric.

7

FIG. 9. Same as Figure 8 but for a time of 1.7 hours.

FIG. 8. Magnitude of the error metrics for the data-driven
runs, at 1 hour into the run, as a function of the driving
interval, for the case of Simulation 2. Diamonds are on a log
scale and the squares are on a linear scale. The data points
at 0.003 and 0.004 minutes are for the sub-CFL and CFL
timesteps, respectively.

Figures 8-10 show the magnitude of the metrics of
Equations (2) for Simulation 2, at 1, 1.7, and 2.4 hours
into the emergence, as a function of the driving interval.
The errors are shown on logarithmic (left axis, diamonds)
and linear (right axis, squares) scales. The two addi-
tional data-driven runs, in which the boundary is driven
with data on the sub-CFL and CFL limited timestep have
driving timesteps which vary throughout the simulation,
but are plotted for illustrative purposes at times of .0003
and .0004 minutes, respectively.

Using the the linear scale in Figures 8-10, one can see
that the errors are insigniﬁcant at driving intervals less
than 1 minute, which is much less than the emergence
timescale of 1.27 hours for Simulation 2 (Table I). Above
a driving interval of 1 minute, the errors increase, with,
e.g., the error in the free energy (magenta line) reaching
30% at 1.7 hours into the emergence, when driven at a
12 minute cadence (Figure 9).

Using the logarithmic scale in Figures 8-10, and fo-

FIG. 10. Same as Figure 8 but for a time of 2.4 hours.

cusing on the metric 1 − Cvec at 2.4 hours (black lines
of Figure 10), one can see that with decreasing driving
interval, the magnitude of the error plateaus at about
10−5 for Simulation 2, even at the CFL limited timestep
(represented by the datapoint at .0004 minutes). For the
sub-CFL driving interval (represented by the datapoint
at .0003 minutes) however, the error drops to 10−14. The
other metrics show larger magnitudes at this sub-CFL in-
terval, as their integrals are cumulative in nature. This
analysis shows that the method of data-driving, when us-
ing all the available boundary data as needed by the nu-
merical algorithm, is able to reproduce the ground-truth
solution to within errors associated with accumulation of
machine precision, and allows conﬁdent conclusions to be
drawn at longer driving intervals.

The free magnetic energy is an important measure for
space weather, as it gives an approximate measure for

yyythe amount of magnetic energy that can be released in a
solar ﬂare, CME, or ﬁlament eruption, and so warrants
error analysis in these data-driven runs. However, the
free magnetic energy is deﬁned as the diﬀerence between
the total magnetic energy and the energy in the potential
magnetic ﬁeld, where the potential ﬁeld is the ﬁeld having
the same vertical ﬁeld component at the surface as the
reference ﬁeld, but with no electric currents (J ∼ ∇×B =
0). Before making conclusions regarding the accuracy of
the data-driven runs based on the error in free magnetic
energy, it must be established that these errors are not
due to errors in the potential magnetic energy.

At speciﬁc times (e.g., every 12 minutes) when surface
boundary data are supplied from the ground-truth run to
the data-driven run, the potential ﬁeld in the data-driven
run should be identical to the potential ﬁeld above the
surface in the ground-truth run. In this case the error
in the free magnetic energy will be equal to the error in
the total magnetic energy multiplied by the ratio of total
to free energy. This is shown below, denoting dd for the
data-driven solution, and gt for the ground truth solution,
and using the assumption that Edd

pot = Egt

pot ≡ Epot:

1 − (cid:15)f ree = 1 −

f ree

Edd
Egt

f ree

=

Egt

f ree − Edd
Egt

f ree

f ree

=

=

Egt − Epot − Edd + Epot
Egt
f ree
Edd
Egt ) =

Egt
Egt

Egt
Egt

(1 −

f ree

f ree

(1 − (cid:15)).

(3)

8

those times, but linearly interpolated.
It is necessary
to check that these errors in the vertical magnetic ﬁeld
do not result in signiﬁcant errors in the potential ﬁeld.
Figure 11 shows the error in potential, total, and free en-
ergy in the data-driven run around the 3 hour mark for
Simulation 2, when using driving data every 12 minutes.
As predicted, the error in the potential energy is zero at
data-input times, and maximal at points between these
times. At these times, the absolute error in the potential
energy is below 0.5%. Noting that the errors in the free
energy are approximately 20-30% during this period, it is
clear that the errors in potential energy associated with
the linear interpolation between driving time inputs do
not signiﬁcantly contribute to the errors in the free en-
ergy. Furthermore, the dashed line in Figure 11(b) is the
total energy error multiplied by the ratio of total to free
energy, as in Equation (3), and only deviates slightly from
the free energy error at midpoints between data-driving
inputs. This analysis shows that calculated errors in free
magnetic energy can be reliably used to make conclu-
sions about the accuracy of the data-driven runs in the
following section.

B. Parameter study

√

Figure 12(a) shows the emergence time for each of the
nine ground-truth simulations as a speciﬁc function of
the initial condition model parameters,
βtube/qa. This
function is chosen based on insight from previous simu-
lations of ﬂux emergence in the convection zone and at-
mosphere above: Murray et al. [16] showed that as ﬂux
tubes rise in the convection zone, they fragment based
on the amount of twist (qa in these simulations) in the
tube. The lower the twist, the more fragmented and dis-
torted the tube becomes, and as a result, the less mag-
netic ﬂux is able to build up at the top of the convection
zone to drive the emergence. In addition, Longcope and
Fisher [15] and Emonet and Moreno-Insertis [8] showed
that the initial rise speed of the tube increases in pro-
portion to 1/
βtube, and although there is no guarantee
that the rise speed inﬂuences the emergence speed, this is
a reasonable function to use to predict emergence rates.
Relating these insights to the initial parameters of the
ground-truth runs, and based on Figure 12(a), a mono-
tonic dependence of the emergence time on
βtube/qa
is suggested here, leaving a more complete parametric
study of ﬂux emergence to future publication.

√

√

FIG. 11. Errors (%) in potential (a), total and free (b) en-
ergies around the 3 hour mark for Simulation 2, when the
data-driven run is provided with data every 12 minutes (in-
dicated by vertical dotted lines).

At times between the regular data-driving inputs, er-
rors will grow in the potential energy, as the boundary
data are not exactly equal to the ground truth data at

Figure 12(b) shows the magnitude of the error in the
free magnetic energy in the data driven runs for each of
the nine simulations from Table I, as a function of the
emergence time, when the data-driven run is supplied
with MHD data every 12 minutes. The error calculation
is performed towards the end of each emergence event,
when the potential energy has reached its maximal value.
From Figure 12(b), a general inverse relationship between
the emergence timescale and the error in the free energy
can be seen, with the slowest emerging Simulation (9)

9

FIG. 13. Panel (a): Evolution of potential energy in ground-
truth run for Simulation 4. Panel (b): Measure of magnetic
ﬁeld variability dB (red triangles) for the same Simulation.
Error in free energy for the data-driven run (solid black line).
Ratio of out-of plane current between the data-driven and
ground-truth run (solid red line).

√

FIG. 12. Panel (a): Emergence timescale as a function of
parameters:
βtube/qa. Panel (b): Absolute value of error
in free magnetic energy versus emergence timescale. The two
red points in both panels are for Simulations 5 and 7, and
exhibit large negative values of the free energy error.

having a free energy error in the data-driven solution
just above 1%. This result is encouraging for the valid-
ity of this method of data-driving to model the coronal
magnetic ﬁeld above emerging active regions using HMI
magnetograms, particularly as future data may be avail-
able at even smaller intervals [21].

However, from Figure 12(b), it is also clear that there
are two exceptions in the parameter space, Simulations 5
and 7, which show very large error magnitudes (> 100%),
and whose data points are colored red in both panels.
As seen in Table I, the error in the free magnetic energy
(1−(cid:15)f ree) of the data-driven run for these two simulations
is both large and negative, indicating that there is much
more free magnetic energy in the data-driven run than in
the ground-truth run. Note also from Table I that these
two simulations only diﬀer by relatively small values of
the initial ﬂux tube parameters (and hence emergence
time) from other simulations which show small (< 20%),
positive errors in the free magnetic energy. To under-
stand why and when such large errors might occur in
data-driven models using observed magnetograms, it is
instructive to examine these two simulations further.

FIG. 14. Same as Figure 13 but for Simulation 5.

Given that the free magnetic energy is related to the
magnetic energy in the non-potential (J (cid:54)= 0) part of the
magnetic ﬁeld, it is worthwhile to analyze the amount of
currents in the data-driven run compared to the ground-
truth run. This is done for a simulation which shows
small positive errors in free magnetic energy (Simulation
4), and one which has large negative errors (Simulation
5). The lower panels of Figures 13-14 show a measure
of magnetic ﬁeld variability dB (red triangles) for the
ground-truth data for Simulations 4 and 5, the error in
free energy for the data-driven run (solid black line), and
the ratio of out-of plane current between the data-driven
and ground-truth run (solid red line). The ratio of out-of-
plane current is given by (cid:80) |Jy|driven/ (cid:80) |Jy|ground with
the sum over the domain above z = 0. The variability
measure dB is a measure of how much the ground-truth
magnetic ﬁeld changes between driving input times of

10

FIG. 15. Panel (a): Error in free energy for the data-driven run vs the ratio of out-of-plane current (data-driven to ground-
truth), for all the simulations in the parameter study. The red points are Simulations 5 and 7. Panel (b): The same but for
in-plane current. Panel (c): The same but for a measure for the variability of the vertical magnetic ﬁeld data on a 12 minute
cadence, dB.

dt = 12 minutes:

dB(t) =

(cid:12)
(cid:12)
(cid:12)
(cid:12)

(cid:88)

xi

Bz(xi, t + dt) − Bz(xi, t)
Bz(xi, t + dt) + Bz(xi, t)

(cid:12)
(cid:12)
(cid:12)
(cid:12)

(4)

where xi are all points on the model surface (z = 0). The
upper panels in Figures 13-14 show the potential energy
in the ground-truth simulation to highlight where in time
during the emergence the errors occur.

As can be seen in Figure 13, for Simulation 4, the vari-
ability measure dB remains less than unity, the ratio of
out-of-plane current remains close to unity, and the er-
rors in free energy remain small (< 20%). By contrast,
in Simulation 5 (Figure 14) the variability measure has
periods where it is larger than unity, as does the ratio
of current, and the free energy error gets more and more
negative during the emergence.

Figure 15 shows plots of the free energy error against
the ratio of out-of-plane current, the ratio of in-plane cur-
rent (cid:80) |(Jx, 0, Jz)|driven/ (cid:80) |(Jx, 0, Jz)|ground, and mag-
netic ﬁeld variability dB, for all nine Simulations. Those
emergence events which exhibit large magnetic ﬁeld vari-
ability (dB) over 12 minute intervals (5 and 7) have large
currents generated in the data-driven runs and large, neg-
ative errors in the free magnetic energy. This is sugges-
tive that the source of the large errors in the data-driven
runs is the large variability of magnetic ﬁeld and associ-
ated currents.

To investigate the origin of these large currents in Sim-
ulations 5 and 7, the nature of the emergence, in partic-
ular the morphology of the emerging magnetic ﬁeld, is
examined. Figure 16 shows the shape of the ﬁeldlines in
the 2D (x, z) plane in Simulations 4 (small positive errors
in free magnetic energy) and 5 (large, negative errors).
The ﬁeldlines are represented by contours of constant ﬂux
Ay. Also shown are the magnitude of the current den-
sity in normalized units. Simulation 4 (panel a) shows
a simple bipolar emergence, with no undulations of the
ﬁeldlines crossing the surface. Simulation 5 shows mul-
tiple undulations of ﬁeldlines, and associated regions of
larger current density.

To represent these two emergence events in time, the

FIG. 16. Panel (a): Magnitude of current density (normal-
ized by B0/µ0L0 where B0 = 1300G and L0=170km) and con-
tours of ﬂux Ay (white lines) for Simulation 4 at 108 minutes.
Panel (b): The same but for Simulation 5 at 264 minutes.

top two panels of Figure 17 show the vertical ﬁeld along
the surface, stacked in time, for the ground-truth runs
of Simulations 4 and 5 at a cadence of 24 seconds. For
the simple emergence, e.g., as that seen in Figure 16(a)
for Simulation 4, one would expect two polarities slowly
separating in time, as the magnetic ﬂux associated with

11

FIG. 17. Panels (a) and (b): Stacked plot of vertical magnetic ﬁeld at the surface for Simulations 4 (a) and 5 (b). Panels (c)
and (d): The same but interpolated using 12 minute sampled data

the original ﬂux tube emerges though the surface. This
is indeed seen for Simulation 4, Figure 17(a). However,
for Simulation 5, shown in Figure 17(b), the signal of
the vertical ﬁeld is dominated by multiple pairs of po-
larities which appear on each side of the neutral line of
the active region and move outwards. A similar morphol-
ogy occurs, but is not shown here, for Simulation 7 (the
second simulation with large negative errors in the free
magnetic energy in the data-driven run). The emergence
associated with Simulations 5 and 7 is more complicated
than a simple bipole; the magnetic ﬁeld is undular and
ﬁeldlines cross the surface multiple times, resulting in
multipolar regions forming on small timescales.

The lower panels of Figure 17 show the same data as
the top panels, but now sampled every 12 minutes, and
interpolated to times (at a 24s cadence) between those 12
minute inputs. This is the data the data-driven run uses
as a lower boundary condition. For Simulation 5 (panel
d), with this interpolated data, the multipolar regions
result in regions where the magnetic ﬁeld changes sign
signiﬁcantly over a 12 minute period. This explains why

large surface magnetic ﬁeld variability is seen in Simu-
lations 5 and 7 (dB > 1). In general, one would expect
such variability and small scale structure, such as that
seen in Figure 17(b), in real active regions.

It is hypothesized here that this variability is the source
of the spurious currents in the data-driven runs for Sim-
ulations 5 and 7, when the driving interval violates a
sampling condition associated with the apparent motion
If
of these small-scale bipoles along the photosphere.
τ is deﬁned as the timestep at which the photospheric
data is sampled, the apparent velocity of the small-scale
bipoles is deﬁned as vh, and their spatial extent is char-
acterized by L, then the condition for the sampling in-
terval is τ < dtsample ≡ L/vh. If the condition is vio-
lated, then between sampling times, the bipoles move a
distance τ vh > L, i.e., a distance larger than their spa-
tial extent, and this under-sampling thereby eﬀectively
generates a strobe eﬀect in the driving data, where the
bipoles appear to jump across the photosphere, rather
than move continuously. Note, that this condition is dif-
ferent from the CFL limitation of the numerical integra-

tion, dtCF L ≡ dx/max(|V|, Cs, CA)

IV. DISCUSSION

12

For the ground-truth dataset for Simulation 5 (seen at
a cadence of 24s in panel (b) of Figure 17), the spatial
extent of the bipoles (half-width half-max of one polarity
of the bipole) is approximately L =1 Mm and the ap-
parent horizontal velocity is vh=20 km/s, which requires
a sampling interval less than dtsample = L/vh = 50 s.
The violation of this constraint, when the data-driven
run uses photospheric data sampled every 12 minutes, is
manifest in Figure 17(d), where one can see numerous
small scale features appearing and disappearing in the
pseudo-magnetograms, when sampled every 12 minutes,
due to the strobe eﬀect. To reconcile this time depen-
dent boundary condition, which has rapidly appearing
and disappearing bipoles, the data-driven run generates
large electric currents, which propagates into the domain.
This results, as was shown in Figure 14, in spurious elec-
tric currents in the data-driven model atmosphere, and
a larger free magnetic energy, compared to the ground-
truth run.

FIG. 18. % Error in free magnetic energy for Simulations
5 and 7, as a function of driving timescale. For both these
simulations, a driving cadence of ∼ 1 minute is required to
obtain errors with magnitude less than 10% in the data-driven
run.

To highlight the importance of the driving timescale on
the accuracy of the data-driven model for these multipo-
lar emergence events, Figure 18 shows the error in the
free magnetic energy in the data-driven runs for Simu-
lations 5 and 7 as a function of the driving timescale.
At the maximum driving timescale of 12 minutes, the er-
rors are large and negative, as the large variability of the
magnetic ﬁeld in these multipolar emergence events can-
not be captured on such a timescale (as shown above).
However, as the driving timescale is reduced to about a
minute, the errors in the data-driven run reduce to less
than a few percent, as the driving timescale is now able
to capture the magnetic ﬁeld variability related to the
undular, multipolar emergence. This is consistent with
the estimate of the required driving interval of 50 s from
above.

This study aimed to assess the accuracy and feasibility
of calculating the coronal magnetic ﬁeld above active re-
gions using dynamic data-driven MHD simulations with
data provided at the photosphere. As there currently
exist no observations that can provide us with a ground-
truth dataset for the magnetic ﬁeld in the corona above
the active region to test the data-driven MHD runs, we
created multiple test cases using nine diﬀerent dynamic
MHD simulations of ﬂux emergence from below the sur-
face. Then we used the data at the surface from these
ground-truth runs as synthetic magnetograms to drive
data-driven runs of the atmosphere above the surface.
To simplify our study, we assumed that all MHD vari-
ables are known at the surface, not just the magnetic
ﬁeld. This is not the case for current observations of
the photosphere, where only vector magnetic ﬁeld obser-
vations are reliably observed at high cadence over full
active region scales. We then investigated the eﬀect of
the driving timescale on the errors produced in the coro-
nal magnetic ﬁeld solution for the data driven runs. We
investigated timescales across the range from the CFL
limited timescale (dtCF L ∼ 0.004 min) all the way up
to the 12 minute timescale typical of HMI observations.
Furthermore, we conducted a parameter study by varying
the model parameters in our ground-truth simulations to
investigate the eﬀect of the emergence timescale on the
errors.

We found that, at a given emergence timescale, the er-
ror in the coronal magnetic ﬁeld decreased with decreas-
ing driving interval, as expected, and that at the fun-
damental (sub-CFL) timescale of the numerical method,
we were able to recover the ground-truth solution. Fur-
thermore, we found that at the standard HMI interval of
12 minutes, the error in the coronal magnetic ﬁeld solu-
tion decreased with emergence timescale, with the error
in the free magnetic energy being as low as 1% for the
active region that emerged over a day. This is encour-
aging for the future development of data-driven MHD
models which use photospheric magnetic ﬁeld measure-
ments, and derived values for the other MHD variables,
to model the dynamic evolution of the coronal magnetic
ﬁeld.

However, we also found exceptions to the above re-
sults, where large negative errors in the free magnetic en-
ergy were found in the data-driven solutions. Preliminary
analysis indicates that this is due to the emergence and
evolution of multiple sub-AR scale bipolar regions which
evolve on small timescales, and are thus under-sampled
by the 12 minute interval driving data. The data-driven
runs of these undular, multipolar regions generated large
electric currents which created spuriously large free en-
ergy in the atmosphere. We hypothesized that these cur-
rents were a result of the strobe eﬀect generated by fea-
tures moving at a rate faster than can be captured by
the input cadence.

We deﬁned a critical sampling condition dtsample =

L/vh for the data-driven runs in these complex emergence
events, where L and vh are the characteristic size and ap-
parent velocity of the sub-AR scale bipolar regions. For
the parameters we have considered, this sampling con-
dition was approximately one minute. By reducing the
driving timestep down to, and below, this critical value,
we resolved the problem of spurious currents and free
magnetic energy in the data-driven runs, and we recov-
ered errors in the magnetic free energy (compared to the
ground-truth) below a few percent. However, when using
real photospheric data, an eﬀort is clearly necessary to
calculate this condition for the active region being stud-
ied. This study shows that extreme care must be taken
when using solutions of magnetic ﬁeld from data-driven
MHD models of complex emerging active regions which
contain rapidly evolving magnetic features. Fortunately,
the potential availability of higher cadence magnetic ﬁeld
measurements (90-135 s) from HMI-data [21] will allow
for more analysis.

It is important to note that this investigation assumes
the best-case scenario, a scenario that is required by
MHD, that all the MHD variables (including velocity,
pressure and temperature), not just the magnetic ﬁeld,
are provided without error at the given cadence. This
is currently beyond the state of the art in the observa-

13

tions, where, for example, the velocity must be inferred
from the time-series of the photospheric magnetic ﬁeld.
The errors investigated in this study, which come from
the lack of temporal information at the photosphere, will
always be present in data-driven models regardless of the
methods used to mitigate the lack of information about
the velocity and temperature. Future investigations will
study the introduction of errors in data-driven coronal
ﬁeld models due to (1) this lack of information at the
photosphere and methods used to mitigate it, (2) reduced
spatial cadence of photospheric data, and (3) instrument
noise and bias.

ACKNOWLEDGMENTS

Acknowledgements: This work has been supported by
the NASA Living With a Star & Solar and Heliospheric
Physics programs, and the Chief of Naval Research 6.1
Program. The simulations were performed under a grant
of computer time from the DoD High Performance Com-
puting program. We thank the anonymous referee for
useful comments on the manuscript.

[1] Arber, T. D., Longbottom, A. W., Gerrard, C. L., and
Milne, A. M., “A Staggered Grid, Lagrangian-Eulerian
Remap Code for 3-D MHD Simulations,” Journal of
Computational Physics 171, 151–181 (2001).

[2] Bingert, S. and Peter, H., “Intermittent heating in the
solar corona employing a 3D MHD model,” Astron-
omy and Astrophyics 530, A112 (2011), arXiv:1103.6042
[physics.space-ph].

[3] Bourdin, P.-A., Bingert, S., and Peter, H., “Observation-
ally driven 3D magnetohydrodynamics model of the solar
corona above an active region,” Astronomy and Astro-
physics 555, A123 (2013), arXiv:1305.5693 [astro-ph.SR].
[4] Cheung, M. C. M. and DeRosa, M. L., “A Method
for Data-driven Simulations of Evolving Solar Ac-
tive Regions,” Astrophysical Journal 757, 147 (2012),
arXiv:1208.2954 [astro-ph.SR].

[5] Cheung, M. C. M. and Isobe, H., “Flux emergence
(theory),” Living Reviews in Solar Physics 11 (2014),
10.1007/lrsp-2014-3.

[6] Courant, R., Friedrichs, K., and Lewy, H., “ ¨Uber die
partiellen Diﬀerenzengleichungen der mathematischen
Physik,” Mathematische Annalen 100, 32–74 (1928).
[7] Didkovsky, L. V., BBSO/NJIT Team,, and Mees So-
lar Obs./U. Hawaii Team,, “A Concept for Optical and
Mechanical Design for a New Oﬀ-Axis 1.7 m Solar Tele-
scope (NST) at Big Bear,” in AAS/Solar Physics Divi-
sion Meeting #34, Bulletin of the American Astronomi-
cal Society, Vol. 35 (2003) p. 847.

[8] Emonet, T. and Moreno-Insertis, F., “The Physics of
Twisted Magnetic Tubes Rising in a Stratiﬁed Medium:
Two-dimensional Results,” Astrophysical Journal 492,
804–821 (1998), astro-ph/9711043.

[9] Galsgaard, K., Madjarska, M. S., Vanninathan, K.,
Huang, Z., and Presmann, M., “Active region upﬂows.
II. Data driven magnetohydrodynamic modelling,” As-
tronomy and Astrophysics 584, A39 (2015).

[10] Jiang, C., Feng, X., Fan, Y., and Xiang, C., “Recon-
struction of the Coronal Magnetic Field Using the CESE-
MHD Method,” Astrophysical Journal 727, 101 (2011).
[11] Jiang, C., Feng, X., Wu, S. T., and Hu, Q., “Study of the
Three-dimensional Coronal Magnetic Field of Active Re-
gion 11117 around the Time of a Conﬁned Flare Using a
Data-Driven CESE-MHD Model,” Astrophysical Journal
759, 85 (2012), arXiv:1209.2207 [astro-ph.SR].

[12] Leake, J. E., Linton, M. G., and Antiochos, S. K., “Tests
of Dynamical Flux Emergence as a Mechanism for Coro-
nal Mass Ejection Initiation,” Astrophyiscal Journal 722,
550–565 (2010), arXiv:1007.5484 [astro-ph.SR].

[13] Leake, J. E., Linton, M. G., and Antiochos, S. K., “Sim-
ulations of Emerging Magnetic Flux. II. The Formation
of Unstable Coronal Flux Ropes and the Initiation of
Coronal Mass Ejections,” Astrophysical Journal 787, 46
(2014), arXiv:1402.2645 [astro-ph.SR].

[14] Leake, J. E., Linton, M. G., and T¨or¨ok, T., “Simula-
tions of Emerging Magnetic Flux. I. The Formation of
Stable Coronal Flux Ropes,” Astrophysical Journal 778,
99 (2013), arXiv:1308.6204 [astro-ph.SR].

[15] Longcope, D. W. and Fisher, G. H., “The Eﬀects of Con-
vection Zone Turbulence on the Tilt Angles of Magnetic
Bipoles,” Astrophysical Journal 458, 380 (1996).

[16] Murray, M. J., Hood, A. W., Moreno-Insertis, F., Gals-
gaard, K., and Archontis, V., “3D simulations identi-
fying the eﬀects of varying the twist and ﬁeld strength
of an emerging ﬂux tube,” Astronomy and Astrophysics

460, 909–923 (2006).

[17] Norton, A., Linton, M. G., Leake, J. E.,

and Jones,
E., “Rates of Magnetic Flux Emergence for Preceder
and Follower Sunspots in Active Regions Observed with
HMI,” Astrophysical Journal - under review (2016).
[18] Peter, H., Warnecke, J., Chitta, L. P., and Cameron,
R. H., “Limitations of force-free magnetic ﬁeld extrapo-
lations: Revisiting basic assumptions,” Astronomy and
Astrophysics 584, A68 (2015), arXiv:1510.04642 [astro-
ph.SR].

[19] Scherrer, P. H., Schou, J., Bush, R. I., Kosovichev, A. G.,
Bogart, R. S., Hoeksema, J. T., Liu, Y., Duvall, T. L.,
Zhao, J., Title, A. M., Schrijver, C. J., Tarbell, T. D.,
and Tomczyk, S., “The Helioseismic and Magnetic Im-
ager (HMI) Investigation for the Solar Dynamics Obser-
vatory (SDO),” Solar Physics 275, 207–227 (2012).
[20] Schrijver, C. J., De Rosa, M. L., Metcalf, T. R., Liu, Y.,
McTiernan, J., R´egnier, S., Valori, G., Wheatland, M. S.,
and Wiegelmann, T., “Nonlinear Force-Free Modeling of
Coronal Magnetic Fields Part I: A Quantitative Compar-
ison of Methods,” Solar Physics 235, 161–190 (2006).
[21] Sun, X., Fisher, G. H., Torok, T., Hoeksema, J. T., Li,
Y., and CGEM Team,, “Unexpectedly Strong Lorentz-
Force Impulse Observed During a Solar Eruption,”
in AAS/Solar Physics Division Meeting, AAS/Solar
Physics Division Meeting, Vol. 47 (2016) p. 6.28.

[22] Tritschler, A., Rimmele, T. R., Berukoﬀ, S., Casini, R.,
Craig, S. C., Elmore, D. F., Hubbard, R. P., Kuhn, J. R.,
Lin, H., McMullin, J. P., Reardon, K. P., Schmidt, W.,
Warner, M.,
and Woger, F., “DKIST: Observing the
Sun at High Resolution,” in 18th Cambridge Workshop

14

on Cool Stars, Stellar Systems, and the Sun, Cambridge
Workshop on Cool Stars, Stellar Systems, and the Sun,
Vol. 18, edited by G. T. van Belle and H. C. Harris (2015)
pp. 933–944.

[23] Tsuneta, S., Ichimoto, K., Katsukawa, Y., Nagata, S.,
Otsubo, M., Shimizu, T., Suematsu, Y., Nakagiri, M.,
Noguchi, M., Tarbell, T., Title, A., Shine, R., Rosenberg,
W., Hoﬀmann, C., Jurcevich, B., Kushner, G., Levay,
M., Lites, B., Elmore, D., Matsushita, T., Kawaguchi,
N., Saito, H., Mikami, I., Hill, L. D.,
and Owens,
J. K., “The Solar Optical Telescope for the Hinode Mis-
sion: An Overview,” Solar Physics 249, 167–196 (2008),
arXiv:0711.1715.

[24] Weinzierl, M., Yeates, A. R., Mackay, D. H., Henney,
C. J., and Arge, C. N., “A New Technique for the Pho-
tospheric Driving of Non-potential Solar Coronal Mag-
netic Field Simulations,” Astrophysical Journal 823, 55
(2016).

[25] Wheatland, M. S., Sturrock, P. A.,

and Roumelio-
tis, G., “An Optimization Approach to Reconstructing
Force-free Fields,” Astrophysical Journal 540, 1150–1155
(2000).

[26] Wiegelmann, T., “Optimization code with weight-
ing function for the reconstruction of coronal mag-
netic ﬁelds,” Solar Physics 219, 87–108 (2004),
arXiv:0802.0124.

[27] Wu, S. T., Wang, A. H., Liu, Y., and Hoeksema, J. T.,
“Data-driven Magnetohydrodynamic Model for Active
Region Evolution,” Astrophysical Journal 652, 800–811
(2006).

