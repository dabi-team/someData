Astronomy&Astrophysicsmanuscript no. 43222_ﬁnal
May 5, 2022

©ESO 2022

2
2
0
2

y
a
M
4

]

R
S
.
h
p
-
o
r
t
s
a
[

2
v
7
6
2
9
0
.
4
0
2
2
:
v
i
X
r
a

The effect of spatial sampling
on magnetic ﬁeld modeling and helicity computation

J. K. Thalmann1, Manu Gupta1, and A. M. Veronig1, 2

1 University of Graz, Institute of Physics/IGAM, Universitätsplatz 5, 8010 Graz, Austria e-mail: julia.thalmann@uni-graz.at
2 Kanzelhöhe Observatory for Solar and Environmental Research, University of Graz, Austria

Accepted by A&A on April 19, 2022

ABSTRACT

Context. Nonlinear force-free (NLFF) modeling is regularly used to indirectly infer the 3D geometry of the coronal magnetic ﬁeld,
which is not otherwise accessible on a regular basis by means of direct measurements.
Aims. We study the eﬀect of binning in time-series NLFF modeling of individual active regions (ARs) in order to quantify the eﬀect
of a diﬀerent underlying spatial sampling on the quality of modeling as well as on the derived physical parameters.
Methods. We apply an optimization method to sequences of Solar Dynamics Observatory (SDO) Helioseismic and Magnetic Imager
(HMI) vector magnetogram data at three diﬀerent plate scales for three solar active regions to obtain nine NLFF model time series.
From the NLFF models, we deduce active-region magnetic ﬂuxes, electric currents, magnetic energies, and relative helicities, and
analyze those with respect to the underlying spatial sampling. We calculate various metrics to quantify the quality of the derived
NLFF models and apply a Helmholtz decomposition to characterize solenoidal errors.
Results. At a given spatial sampling, the quality of NLFF modeling is diﬀerent for diﬀerent ARs, and the quality varies along the
individual model time series. For a given AR, modeling at a certain spatial sampling is not necessarily of superior quality compared
to that performed with a diﬀerent plate scale. Generally, the NLFF model quality tends to be higher for larger pixel sizes with the
solenoidal quality being the ultimate cause for systematic variations in model-deduced physical quantities.
Conclusions. Optimization-based modeling using SDO/HMI vector data binned to larger pixel sizes yields variations in magnetic
energy and helicity estimates of .30% on overall, given that concise checks ensure the physical plausibility and high solenoidal
quality of the tested model. Spatial-sampling-induced diﬀerences are relatively small compared to those arising from other sources of
uncertainty, including the eﬀects of applying diﬀerent data calibration methods, those of using vector data from diﬀerent instruments,
or those arising from application of diﬀerent NLFF methods to identical input data.

Key words. Sun: corona – Sun: magnetic ﬁelds – Methods: data analysis – Methods: numerical

1. Introduction

To date, three-dimensional (3D) models of the coronal mag-
netic ﬁeld are commonly used to obtain insights into re-
lated physical processes (Wiegelmann et al. 2017). Correspond-
ing modeling approaches are needed because of the otherwise
sparse direct measurements of the coronal magnetic ﬁeld vec-
tor even within limited coronal volumes (e.g. review by Cargill
2009). In particular, nonlinear force-free (NLFF) magnetic ﬁeld
models are most often used (for dedicated reviews see, e.g.,
Wiegelmann & Sakurai 2012; Régnier 2013) which are static ap-
proximations of the magnetized coronal plasma being necessar-
ily in equilibrium when the Lorentz force vanishes, that is, when
gas pressure and other forces are negligible. These conditions
are satisﬁed to a high degree in the active-region corona (e.g.,
Gary 2001).

The computation of a force-free magnetic ﬁeld, B, requires

the numerical solution of

(∇ × B) × B = 0,

and

∇ · B = 0,

(1)

(2)

within a 3D volume, V, subject to conditions speciﬁed on the
lower boundary of the model volume at z = 0. In other words,

the magnetic ﬁeld information at the lower boundary of the
model is “extrapolated” into the coronal volume above. Ide-
ally, in order to specify suitable boundary conditions to solve
Eqs. (1)–(2), we would hope to have spectro-polarimetric ob-
servations at hand that would allow us to deduce a correspond-
ing magnetic ﬁeld vector consistent with the force-free as-
sumption, for instance measured at chromospheric heights (e.g.,
Metcalf et al. 1995). However, in practice, such data at high spa-
tial and temporal resolution are obtained only from measure-
ments at photospheric heights. The latter are known to repre-
sent a regime inconsistent with the force-free approach because
of non-negligible gas pressure and gravitational forces. Force-
free modeling carried out on the basis of such inconsistent data
is known to result in larger residual Lorentz force and diver-
gence, yet may be partially compensated by, for example, pre-
processing of the photospheric vector data prior to extrapola-
tion (e.g., Wiegelmann et al. 2006; Fuhrmann et al. 2011), al-
lowing the force-free solution to deviate from the actually sup-
plied input data at z = 0 (e.g., Wiegelmann & Inhester 2010;
Wheatland & Régnier 2009; Wheatland & Leka 2011), or both
(Wiegelmann et al. 2012).

In any case, force-free modeling at the full available spatial
and temporal scales may be numerically expensive. Thus, to re-
alize the modeling of, for example, active regions (ARs) during
their disk passage within a reasonable amount of time, the pho-

Article number, page 1 of 11

 
 
 
 
 
 
A&Aproofs: manuscript no. 43222_ﬁnal

tospheric vector magnetic ﬁeld data are often spatially binned
prior to their usage. DeRosa et al. (2015) provided the ﬁrst com-
prehensive study of the eﬀect of spatial sampling on NLFF mod-
eling by testing the eﬀect of binning of Hinode/Solar Optical
Telescope (SOT) (Tsuneta et al. 2008; Lites et al. 2013) Stokes
spectra onto the model outcome of ﬁve diﬀerent numerical meth-
ods. In particular, they binned the Stokes spectra from a chosen
spectral scan of AR 10978 using nine diﬀerent integer factors.
Those nine spectra were then subjected to spectro-polarimetric
inversion, 180◦ ambiguity resolution, and remapping to a planar
grid, ultimately representing the input data for subsequent NLFF
modeling. Correspondingly, the employed single-snapshot mod-
els were at nine diﬀerent plate scales ranging from ∼0.1 Mm to
∼1.7 Mm.

In order to obtain a more diﬀerentiated picture regarding
the eﬀect of spatial sampling onto NLFF modeling, we per-
form a corresponding in-depth analysis using one of the numer-
ical methods compared in DeRosa et al. (2015), namely the op-
timization method of Wiegelmann et al. (2012), which has been
widely applied within the solar community for the purpose of
coronal magnetic ﬁeld modeling. In contrast to earlier studies,
we do not base our analysis on a single-snapshot NLFF model
of a single AR, but instead use time series of NLFF models dur-
ing extended periods of time for diﬀerent ARs (Sect. 2.1). This
setting allows us to explore the potential of known metrics in
great detail in order to quantify the quality of NLFF solutions
(Sect. 3.1), and to explore the eﬀect of spatial sampling on the
derived quantities, including magnetic ﬂuxes and currents in 2D
as well as energies and helicities in 3D (Sect. 3.2). The analy-
sis of magnetic helicity, a quantity characterizing the structural
complexity of the magnetic ﬁeld (e.g., Moﬀatt 1969), has re-
cently gained particular attention, as well as its sensitivity to
the quality of the underlying magnetic ﬁeld model (Valori et al.
2012; Thalmann et al. 2019, 2020). Ultimately, the employed se-
quences of NLFF models for several ARs allow us to deduce and
discuss resolution-dependent trends (Sect. 4), and to compare
those to other eﬀects known to cause uncertainties in coronal
magnetic ﬁeld modeling (instrumental, data processing, etc.).

2. Data and Methods

2.1. Active region selection

For our study, we select three out of the ten ARs analyzed in
Gupta et al. (2021), namely NOAAs 11158, 11429, and 12673,
which hosted the top four solar ﬂares (in terms of peak soft X-
ray ﬂux) during solar cycle 24 that occurred within ±35◦ of the
central meridian (see Table 1). The time window for analysis is
chosen as in Gupta et al. (2021), that is, it covers a time interval
of several hours around the occurrence of the X-class ﬂares, as
is the time cadence (a 12min time cadence within ±1h around
the ﬂare peak time and a 1h cadence otherwise). Data possibly
available during the impulsive phases of the ﬂares were not con-
sidered due to the limited validity of the force-free assumption
during eruptive processes. Accordingly, the number of consid-
ered snapshots is diﬀerent for each of the target ARs, based on
the number of X-class ﬂares within the analysis time window
and also aﬀected by the availability photospheric vector mag-
netic ﬁeld data needed as an input for the analysis.

2.2. Vector magneticﬁeld data

We use time series of vector magnetic ﬁeld data as originally
prepared by Gupta et al. (2021), who use hmi.sharp_CEA_720s

Article number, page 2 of 11

Table 1. Properties of active regions under study, including NOAA
number, GOES SXR class of X-class ﬂares that occurred during the
analysis time window, and their respective on-disk location, followed
by the number of vector magnetic ﬁeld maps used.

NOAA
AR no.
11158
11429

12673

Flare
class
X2.2
X5.4
X2.2
X9.3

Flare
location
S20W10
N18E31
S08W32
S09W34

Analysis time window (UT)
(YYYY-MM-DD hh:mm – DD hh:mm)
2011-02-14 19:59 – 15 02:59(a)
2012-03-06 18:59 – 07 02:23(a)

2017-09-06 02:59 – 06 12:47(a)

No. of
maps
17
26

22

Notes. (a)No SDO/HMI data available between 6 September 06:00 UT
and 08:48 UT.

data within automatically identiﬁed active-region patches
(Bobra et al. 2014) constructed from polarization measurements
of the Helioseismic and Magnetic Imager (HMI; Scherrer et al.
2012) on board the Solar Dynamics Observatory (SDO;
Pesnell et al. 2012), and projected onto a (local) heliographic
plane (Gary & Hagyard 1990). In addition to using time series
of photospheric vector magnetic ﬁeld data at a native plate scale
(0.36 Mm at disk center; hereafter referred to as “bin1”), we
construct corresponding “bin2” and “bin4” time series by bin-
ning the original-resolution data by a factor of 2 and 4, respec-
tively, that is, by adhering to an eﬀective plate scale (pixel size)
of 0.72 Mm and 1.44 Mm, respectively. The binning applied to
to mimic a reduced spatial resolution of the data uses nearest-
neighbor averaging, that is, taking the magnetic ﬁeld data of 2×2
(4×4) neighboring pixels and calculating the mean value (for al-
ternative choices as well as an in-depth study of corresponding
eﬀects onto the vector magnetic ﬁeld data see Leka & Barnes
2012).

In order to inspect the eﬀect of binning of the vector mag-
netic ﬁeld data (later used as an input for NLFF modeling;
see Sect. 2.3), we compute two commonly used area-integrated
quantities for each of our target ARs at each of the plate scales,
namely the total unsigned magnetic ﬂux, |Φm|, deﬁned as

|Φm| =

ZS (z=0)

|Bz| · dS ,

(3)

with Bz being the vertical component of the vector magnetic ﬁeld
data, and the unsigned vertical current, |Iz|, deﬁned as

|Iz| =

ZS (z=0)

|Jz| · dS ,

(4)

For

where Jz is the vertical current density and µ0 Jz = (∇ × B)z=0.
the bin[2,4]-based estimates, we compute average
changes across the time series of the individual ARs with respect
to the respective original-resolution(bin1-data)-based estimates
as

δξbinX =

1
nt

nt

Xi=1

ξbinX(ti) − ξbin1(ti)
10−2ξbin1(ti)

,

(5)

where X = [2, 4] for the bin[2,4]-based modeling and nt is the
total number of time instances, nt =

ti.

P

The binned (down-sampled) HMI data exhibits successively
lesser unsigned ﬂuxes and currents. This is actually expected be-
cause the binning necessarily reduces the strength of and gra-
dients within the original magnetic ﬁeld data. From applica-
tion of Eq. (5) to the time series of unsigned ﬂuxes, we ﬁnd
δ|Φm|≃[−1.3±0.1,−3.6±0.1]% for the bin[2,4] vector magnetic
ﬁeld data of AR 11158 (Fig. 1(a)), [−2.4±0.0,−5.5±0.1]% for

Thalmann, J. K., et al.: The eﬀect of spatial sampling on magnetic ﬁeld modeling and helicity computation

Fig. 1. Area-integrated parameters computed from the photospheric vector data at three diﬀerent pixel sizes as a function of time for three ARs.
Top: Unsigned magnetic ﬂux, |Φm|. Bottom: Unsigned vertical current, |Iz|. Red, blue, and green colors correspond to bin1, bin2, and bin4 data,
respectively, with inherent plate scales of ∼0.36, ∼0.72, and ∼1.4 Mm. Vertical bars indicate the impulsive phase of X-class ﬂares that occurred
during the time intervals analyzed.

we

for

the

AR

vertical

unsigned

current,
AR
11429,

AR 11429 (Fig. 1(b)), and [−1.9±0.1,−4.8±0.2]% for AR 12673
(Fig. 1(c)).
For

ﬁnd
δ|Iz|≃[−42.8±0.4,−68.6±0.4]%
11158,
[−52.8±0.3,−77.1±0.4]%
and
for
[−49.2±1.2,−72.6±0.9]% for AR 12673 (Fig. 1(d)–(f), re-
spectively). This is in line with the successively lower electric
current found from down-sampled data in DeRosa et al. (2015).
Based on binned SOT Spectro-polarimeter (SP) spectra, relative
changes of the mean vertical current density of [−43.8,−68,6]%
can be deduced for spatial scales corresponding to those used
in our study. To compute those percentages, we ﬁrst deﬁned
a reference level from their “bin3” and “bin4” cases, corre-
sponding to an approximate plate scale of ∼0.37 Mm, which is
comparable to the plate scale our bin1 case. The corresponding
estimates of hJzi (cf. their Fig. 4c) were then used to compute
i≃12 mA m−2.
a corresponding average value of h
i≃6.8 mA m−2 for an
Similarly, we compute h
Jz,bin6, Jz,bin8
(cid:2)
approximate plate scale of ∼0.74 Mm, which is comparable
(cid:2)
to our bin2 case, and use their their Jz,bin14 at a plate scale of
∼1.48 Mm as comparable to our bin4 case.

Jz,bin3, Jz,bin4

(cid:3)

(cid:3)

2.3. Magneticﬁeld modeling

We employ NLFF models from the data time series at the three
diﬀerent plate scales (∼0.36, ∼0.72, and ∼1.4 Mm) for each of
the three target ARs. We use the method of Wiegelmann et al.
(2012), which involves two main computational steps, a pre-
processing of the 2D input data (to retrieve a force-free con-
sistent boundary condition at z = 0 Wiegelmann et al. 2006)
and subsequent extrapolation (allowing deviations from the in-
put data at z = 0 in order to account for measurement uncertain-
ties Wiegelmann & Inhester 2010). During both of these steps,
larger freedom is given to changes in the horizontal magnetic
ﬁeld component than to changes in the vertical magnetic ﬁeld
component, in accordance with the generally lower measurement
accuracy of the former compared to the latter. For completeness
we note here that the trend of data at smaller pixel sizes to host
more unsigned ﬂux and stronger vertical currents is preserved
during preprocessing as well as during optimization. In contrast
to Gupta et al. (2021), we employ only one time series per target

AR and plate scale using standard model parameter settings. In
other words, we omit the tuning of model parameters in order to
improve the NLFF model results (for dedicated in-depth studies
see, e.g., Thalmann et al. 2019, 2020). This is because we want
to obtain insights into the eﬀects that are purely attributable to
the diﬀerent spatial sampling of the data used as input for NLFF
modeling and to avoid complicating the (already complex) inter-
pretation of dependencies. Thus, we compute 195 NLFF models
in total (at three diﬀerent plate scales for the considered number
of time instance listed in the last column in Table 1).

From each modeled NLFF solution for B, we compute
the unsigned magnetic ﬂux and unsigned vertical current using
Eqs. (3) and (4), respectively, at the lower boundary of the NLFF
models (z = 0). In addition, we compute the total (volume-
integrated) magnetic energy, E, as,

E =

ZV

|B|2 dV.

(6)

Correspondingly, we compute the potential energy, E0, using the
current-free (minimum-energy) magnetic ﬁeld solution, B0, in
Eq. (6). The latter is deﬁned as B0 = ∇φ, with φ being the
scalar potential, which is subject to the constraint ∇nφ = Bn on
the volume-bounding surface, ∂V. We are therefore also able to
compute the free magnetic energy as EF = E − E0.

2.3.1. Quality measures

For the purpose of quantifying the force-freeness of the ob-
tained NLFF model magnetic ﬁelds in three dimensions, we
use the current-weighted angle between the modeled magnetic
ﬁeld and the electric current density, θJ, related to the otherwise
often-used current-weighted average of the sine of the angle be-
tween the current density and the magnetic ﬁeld, σJ (“CW sinθ”;
Wheatland et al. 2000) by hθJi = sin−1σJ. As is common prac-
tice, we compute the average angle over all grid points, hθJi. For
a completely force-free ﬁeld, hθJi = 0.

In order to determine the degree of solenoidality, we em-
ploy several diﬀerent measures commonly used for such pur-
poses. On the one hand, we use the fractional ﬂux as deﬁned
in Gilchrist et al. (2020), namely h| fd|i = (6 δx) h| fi|i, with δx

Article number, page 3 of 11

A&Aproofs: manuscript no. 43222_ﬁnal

representing the spacing of the Cartesian mesh and h| fi|i repre-
senting the volume-average of the magnitude of the fractional
ﬂux increase in a small discrete volume about each grid point
(Wheatland et al. 2000). Being nearly resolution-invariant, h| fd|i
serves as an ideal tool for the comparison of the solenoidal levels
of NLFF models with diﬀerent inherent pixel sizes while cover-
ing the same physical volume.

On the other hand, we use measures based on the decompo-
sition of the magnetic energy into solenoidal and nonsolenoidal
parts, the latter being nonzero if the considered magnetic ﬁeld is
not exactly divergence free. Valori et al. (2013) deﬁned a corre-
sponding measure as Ediv/E, quantifying the fraction of the total
magnetic energy which is related to the nonzero divergence of
a tested 3D ﬁeld B, where Ediv = E0,ns + EJ,ns + |Emix|. Here,
E0,ns and EJ,ns are the energies of the nonsolenoidal compo-
nents of the potential and current-carrying (BJ = B − B0) mag-
netic ﬁeld, respectively, and Emix is a mixed potential-current-
carrying term (see Eq. (8) of Valori et al. 2013, for details), the
latter usually representing the largest contribution to the non-
solenoidal energies (see Sect. 5 in this latter work and also
Sect. 3.1.2 in DeRosa et al. (2015)). Dedicated follow-up stud-
ies examined that Ediv/E ≃ 0.1 (at the most) is to be tolerated
when B is used for subsequent computation of magnetic he-
licity (Valori et al. 2016; Thalmann et al. 2019). In that context,
Thalmann et al. (2020) suggested using an even more restrictive
quantity, namely the ratio |Emix|/EJ,s as a criterion to disqualify
a given B for subsequent helicity computation, where EJ,s is the
energy of the solenoidal component of the current-carrying ﬁeld
(equivalent to the free magnetic energy in a perfectly solenoidal
ﬁeld), and suggested a corresponding threshold to be respected
as |Emix|/EJ,s.0.4. As the purpose of our work is to explore all
eﬀects caused by a change in the spatial sampling of the input
data, we check whether or not Ediv/E=0.1 and/or |Emix|/EJ,s=0.4
are exceeded in our NLFF model time series, yet do not exclude
them from subsequent helicity computation. In order to identify
corresponding time instances, we mark them separately in the
ﬁgures of Section 3. This allows us to understand the spatial-
sampling-induced variations to a reliable helicity computation.

2.4. Magnetichelicityand itscomputation

The gauge-invariant relative magnetic helicity in a volume, V,
can be written as (Berger & Field 1984; Finn & Antonsen 1984)

HV =

ZV

(A + A0) · (B − B0) dV,

(7)

where A and A0 are the respective vector potentials satisfying
B = ∇ × A and B0 = ∇ × A0. HV in Eq. (7) can be decomposed
as, HV = HJ + HPJ (Berger 1999, 2003), with

HJ =

ZV

(A − A0) · (B − B0) dV,

HPJ = 2

ZV

A0 · (B − B0) dV,

(8)

(9)

where HJ is the magnetic helicity of the current-carrying ﬁeld,
BJ, and HPJ is the volume-threading helicity, both being sepa-
rately gauge invariant (Linan et al. 2018).

We compute the vector potentials A and A0 required for the
computation of the relative helicities in Eqs. (7)–(9) using the
method of Thalmann et al. (2011). The method solves systems
of partial diﬀerential equations to obtain the vector potentials A
and A0 using the Coulomb gauge, ∇ · A = ∇ · A0 = 0. The
method has been shown to provide superior solutions of A and

Article number, page 4 of 11

A0 regarding their degree of solenoidality and to deliver helic-
ities in line with those produced using other existing methods
(Valori et al. 2016).

3. Results

In the following, we summarize the quality (Sect. 3.1) of
the NLFF modeling as well as deduced physical quantities
(Sect. 3.2) performed on the basis of HMI data at diﬀerent plate
scales. To do so, we compute time-series-averaged changes with
respect to the original-resolution (bin1) model time series, by
evaluating Eq. (5) for the analyzed quantities.

3.1. NLFF model quality

implying that

The NLFF time series of ARs 11158 and 11429 (Fig. 2(a)
and (b), respectively) exhibit values of hθJi.[10◦, 7◦, 6◦] for
the bin[1,2,4]-based solutions,
the force-free
quality is systematically higher for larger pixel sizes. The
overall changes computed for the bin[2,4]-based time se-
ries are δhθJi≃[−24.1±4.6,−33.4±4.7]% for AR 11158 and
≃[−32.8±4.2,−44.0±3.2]% for AR 11429. Though not shown
explicitly, we note that similar ﬁndings are obtained from the
analysis of hCW sinθi. The situation is diﬀerent for AR 12673,
for which no such systematic improvement of hθJi for a succes-
sively larger pixel size is observed (Fig. 2(c)). While the bin2-
based solutions exhibit comparably lower values of hθJi before
the occurrence of the ﬁrst X-class ﬂare (before ∼09:00 UT), it is
the bin4-based solutions that do so after its occurrence (between
∼09:24 and 10:00 UT; see inlet to Fig. 2(c)).

is,

for

the magnetic energy,

From the decomposition of

the solutions based on data at

for
AR 11158 we ﬁnd values of Ediv/E.[0.04,0.03,0.02] for
the bin[1,2,4]-based NLFF models, respectively (Fig. 2(d)),
larger pixel sizes
that
are of higher solenoidal quality. Similarly, we ﬁnd val-
ues of Ediv/E.[0.13,0.09,0.06]
the bin[1,2,4]-based
NLFF models for AR 11429 (Fig. 2(e)). More precisely,
the overall changes across the bin[2,4]-based time series
with respect
to the corresponding bin1-based time series
are δEdiv/E≃[−40.6±3.4,−58.3±7.5]% for AR 11158 and
≃[−38.8±3.0,−57.2±1.5]% for AR 11429, which means we
observe a comparable overall improvement of solenoidal quality
for successively larger pixel sizes for the two ARs. This is
diﬀerent for AR 12673 where the bin2-based series appears to
be that of highest solenoidal quality, followed by the bin1- and
bin4-based series (Fig. 2(f)), suggesting that Ediv/E does not
scale with plate scale of the underlying model.

We also note that Ediv = 0.1 is occasionally exceeded within
the individual time series, that is, speciﬁc solutions may not be
suitable for trustworthy subsequent computation of magnetic he-
licity (see Sect. 2.3.1 for details). For instance, the bin1-based
NLFF models of AR 11429 exhibit values of Ediv/E > 0.1
prior to the occurrence of the X-class ﬂare (see horizontal line
in Fig. 2(e) for reference). For AR 12673, the situation is even
more dramatic, where the NLFF models at all three spatial sam-
plings exhibit values of Ediv/E > 0.1 at various time instances
after the occurrence of the ﬁrst X-class ﬂare (after ∼09:12 UT;
see inlet to Fig. 2(f)).

For the ratio, |Emix|/EJ,s, we ﬁnd values of .[0.15,0.10,0.06]
for the bin[1,2,4]-based NLFF models of AR 11158 (Fig. 2(g)),
and in the range .[0.30,0.20,0.15] for AR 11429 (Fig. 2(h)),
which corresponds to overall changes across the bin[2,4]-
based time series of δ|Emix|/EJ,s≃[−42.2±3.3,−66.2±7.5]% and

Thalmann, J. K., et al.: The eﬀect of spatial sampling on magnetic ﬁeld modeling and helicity computation

Fig. 2. Quality of the NLFF solutions. From top to bottom for the individual ARs, we show: the volume-averaged current-weighted angle, hθJi,
the ratio of nonsolenoidal-to-total magnetic energy, Ediv/E, the ratio |Emix|/EJ,s, and its resolution-invariant complement, h| fd|i. Red, blue, and
green colors correspond to bin1, bin2, and bin4 data, respectively, with inherent plate scales of ∼0.36, ∼0.72, and ∼1.4 Mm. Empty symbols mark
disqualifying NLFF solutions (see Sect. 3.1 for explanation). The inlets in the rightmost column show a subrange of values for enhanced visibility.
Vertical bars indicate the impulsive phase of X-class ﬂares that occurred during the analyzed time intervals.

≃[−37.3±3.9,−57.9±2.3]%, respectively. As before, for Ediv/E,
a comparable overall improvement of solenoidal quality at suc-
cessively larger pixel sizes is observed for the two ARs. Compar-
atively larger values of |Emix|/EJ,s.0.4 are found for AR 12673
prior to the occurrence of the ﬁrst X-class ﬂare, while increasing
to larger values after the occurrence of the second X-class ﬂare
(see inlet to Fig. 2(i)). Notably, extreme values of |Emix|/EJ,s>1
are found from the bin4-based solutions. In Sect. 3.2.2, we show
that those models exhibit a negative free-energy budget (and are
therefore dubbed ‘non-physical’) and are observed in conjunc-
tion with low force-free quality (hθJi&20◦; compare Fig. 2(c)),
indicating the failure of successful extrapolation.

The computed values of the fractional ﬂux are in the
range h| fd|i(×109 cm−1).[0.04,0.02,0.03] for
the bin[1,2,4]-
based NLFF models of AR 11158 (Fig. 2(j)), .[0.06,0.04,0.03]
for AR 11429 (Fig. 2(k)), and .[0.05,0.05,0.04] for AR 12673
(Fig. 2(l)). In other words, while for AR 11158 the bin2-based
modeling exhibits the lowest values of h| fd|i, it is the bin4-based
modeling that exhibits lowest values for AR 11429, quite con-
sistently across the corresponding time series. For AR 12673,
again, NLFF models that are qualitatively superior at distinct
time instances are not necessarily associated to a systematically
diﬀerent plate scale. In fact, higher and lower values of h| fd|i
tend to be found together with larger and smaller values of hθJi,
respectively (compare Fig. 2(c)). The problematic bin4-based
solutions of AR 12673 (for which extreme values of hθJi and
|Emix|/EJ,s and partly Ediv/E were also found) exhibit the low-
est values (h| fd|i . 0.02; see symbols marked by empty circles
in Fig. 2(l)), which, on the contrary, suggest a high solenoidal
quality.

3.2. NLFF-model-deduced quantities

In the following, we analyze physical quantities deduced from
the time-series NLFF modeling with three diﬀerent plate scales.
As above, we do so by evaluating time-series-averaged changes
computed from Eq. (5), albeit disregarding nonphysical solu-
tions (EF < 0) within the individual time series (marked by
empty plot symbols in Figs. 3 and 4). In addition, when analyz-
ing the magnetic helicity in Sect. 3.2.3 we also disregard NLFF
solutions with non-negligible solenoidal errors (Ediv/E > 0.1;
marked by empty plot symbols in Figs. 5).

3.2.1. Unsigned ﬂux and current

compute
ﬁnd

the bin[2,4]-based NLFF
From the lower boundaries of
the base
series
as
model, using the bin1-based time
changes,
percentage
against which
the
to
δ|Φm|≃[−3.6±0.3,−8.5±0.4]%
for AR 11158 we
(Fig. 3(a)). For AR 11429, the corresponding changes are
δ|Φm|≃[−4.7±0.8,−11.0±1.1]% (Fig. 3(b)) and for AR 12673
they are δ|Φm|≃[−3.5±1.2,−10.8±1.0]% (Fig. 3(c)). Further-
more, we ﬁnd δ|Iz|≃[−31.8±2.6,−47.1±2.1]% for AR 11158
(Fig. 3(d)), ≃[−26.4±4.7,−43.7±3.6]% for AR 11429 (Fig. 3(e)),
and ≃[−17.6±14.8,−43.7±10.1]% for AR 12673 (Fig. 3(f)).

We note that the lower boundary data for the ﬁnal NLFF
model necessarily diﬀer from the input data (cf. Sect. 2.2) be-
cause they are altered once during the preprocessing step and
also iteratively updated during the optimization process (for de-
tails see Sect. 2.3). As a consequence, |Φm| computed from the
lower boundaries of the NLFF model is lower than in the corre-
sponding input data (up to ≈10% at most), as is |Iz| (up to ≈40%

Article number, page 5 of 11

A&Aproofs: manuscript no. 43222_ﬁnal

Fig. 3. Area-integrated parameters computed from the NLFF lower boundary data with diﬀerent inherent pixel sizes as a function of time for
three ARs. Top: Unsigned magnetic ﬂux, |Φm|. Bottom: Unsigned vertical current, |Iz|. Red, blue, and green colors correspond to bin1, bin2, and
bin4 data, respectively, with inherent plate scales of ∼0.36, ∼0.72, and ∼1.4 Mm. Vertical bars indicate the impulsive phase of X-class ﬂares that
occurred during the time intervals analyzed.

at most). Changes to the input data, especially to the horizontal
magnetic ﬁeld components, are expected given their inconsis-
tency with the force-free assumption; also, they are known to be
substantial in comparison to the uncertainties of the input data
(for a corresponding analysis, see e.g., Sect. 3.2 of DeRosa et al.
2015). However, qualitatively, the trends within the individual
NLFF lower boundary-based time series are similar to those in
the corresponding time series of input data (with the exception
of those that stem from unphysical NLFF solutions) and the in-
duced changes are on the order of the spatial-sampling-induced
changes as listed earlier.

3.2.2. Magnetic energy

For all three considered ARs,
the computed potential ﬁeld
energies, E0, are smaller for larger pixel sizes (Fig. 4(a)–
from the
(c)). More quantitatively,
corresponding bin1-based NLFF model
the
changes that are found are δE0≃[−0.6±0.2,−4.0±0.5]% for
AR 11158, ≃[−0.4±0.1,−2.1±0.5]% for AR 11429, and
≃[−0.9±0.8,−5.6±0.7]% for AR 12673, for the bin[2,4]-based
time series, respectively.

in comparison to E0

time series,

respectively). More quantitatively,

larger values of total magnetic energy, E, are
Overall
larger pixel sizes for ARs 11158 and 11429
found for
(Fig. 4(d) and (e),
in
comparison to the bin1-data based NLFF models, we ﬁnd
changes of δE≃[1.4±0.4,2.3±1.3]% for AR 11158, and
≃[3.7±0.8,7.4±0.8]% for AR 11429 at bin[2,4]. In contrast, and
similar to all other analyzed quantities so far, no such systematic
dependence of E on underlying spatial sampling is found for
AR 12673 (Fig. 4(f)). Here, we ﬁnd δE≃1.3±5.0% for the bin2-
based and δE≃−11.5±4.1% for the bin4-based NLFF model
time series.

For the free magnetic energies, EF, we note trends similar
to that found for the corresponding values of E (see Fig. 4(g)–
(i)). More quantitatively, overall and in comparison to the
bin1-data based NLFF models, the bin[2,4]-based estimates are
found to be δEF≃[10.2±2.7,29.8±10.0]% for AR 11158 and
≃[13.9±2.9,31.2±4.7]% for AR 11429. In contrast, we ﬁnd
≃[6.3±29.4,−32.7±18.6]% for AR 12673 (Fig. 4(i)). The non-
physical solutions, such as the bin4-based NLFF models of

Article number, page 6 of 11

AR 12673 at the end of the considered time interval where
EF < 0 (see empty plot symbols in Fig. 4(i)), were previously
identiﬁed based on outstandingly poor NLFF model quality met-
rics (see Sect. 3.1 for details) and were not considered for com-
putation of the percentages above.

We note that the spatial-sampling-induced changes to E0 re-
ﬂect those observed for |Φm|. This may be expected as the po-
tential ﬁeld is determined from the vertical ﬁeld on the lower
boundary of the model volume. In contrast, E and EF show a
diﬀerent behavior from the supposedly indicative unsigned ver-
tical current (|Iz|). Naively, one might expect to ﬁnd larger corre-
sponding values for larger values of |Iz|, as the latter represents a
measure of enhanced complexity in the horizontal ﬁeld. Though
it is true that smaller pixel sizes on overall relate to higher values
of |Iz| (cf. Fig. 3), this is not true for E. Consequently, this is also
not true for the free magnetic energy (compare Fig. 4(d)–(i)) as
it is calculated as EF = E − E0, and E0 is larger for smaller pixel
sizes. For completeness, we note here that we also inspected the
volume-integrated total unsigned current, |Itot|, in order to better
understand the obtained total energies. Though not shown ex-
plicitly, trends throughout the individual time series as well as
spatial-sampling-induced changes are found to be very similar
to that of E and EF, namely larger integrated values for larger
pixel sizes.

This apparent discrepancy can partly be resolved by com-
parison to the solenoidal quality of the NLFF models in Fig. 2,
revealing a rather clear dependency. Both trends within the indi-
vidual time series (at diﬀerent plate scales) and changes to them
are found to be directly reﬂected in the time series of |Emix|/EJ,s
(and to a somewhat lesser extent in the time series of Ediv/E
in conjunction with hθJi). More precisely, volume-integrated en-
ergies (and unsigned currents) are higher for NLFF models of
higher solenoidal quality. For instance, the bin4-based NLFF
models of ARs 11158 and 11429 exhibit larger values of E and
EF (and |Itot|) in conjunction with lowest values of |Emix|/EJ,s
than at other plate scales. In contrast, the bin4-based NLFF mod-
els of AR 12673 exhibit lower energies than for other pixel
sizes (bin1 and bin2) and simultaneously exhibit larger values
of |Emix|/EJ,s.

Thalmann, J. K., et al.: The eﬀect of spatial sampling on magnetic ﬁeld modeling and helicity computation

Fig. 4. Volume-integrated magnetic energies computed from the NLFF solutions with three diﬀerent plate scales as a function of time for three
ARs. Top: Potential energy, E0. Middle: Total energy, E. Bottom: Free magnetic energy, EF = E − E0. Red, blue, and green colors correspond
to bin1, bin2, and bin4 data, respectively, with inherent plate scales of ∼0.36, ∼0.72, and ∼1.4 Mm. Vertical bars indicate the impulsive phase of
X-class ﬂares that occurred during the analyzed time intervals.

3.2.3. Magnetic helicity

11158

and (d),

For the total relative helicity, HV , overall and in comparison
to the bin1-data-based NLFF models the bin[2,4]-based esti-
mate changes are found to be δHV ≃[−17.9±5.6,−40.7±9.9]%
for AR 11158 and ≃[−1.6±0.7,−0.7±1.0]% for AR 11429
respectively). Similarly, one ﬁnds
(Fig. 5(a)
δHPJ≃[−23.7±6.3,−52.4±12.7]% for AR
and
≃[−4.1±0.8,−5.9±1.2]% for AR 11429, respectively (Fig. 5(b)
and (e), respectively). In contrast, comparatively lower val-
the current-carrying helicities, HJ, are found for
ues of
smaller pixel sizes (Fig. 5(g) and (h), respectively), with
≃[17.9±2.6,39.5±7.2]%,
δHJ≃[16.5±6.7,31.7±15.8]% and
to all other quanti-
respectively. In contrast, and similar
ties analyzed for AR 12673 so far, no apparent depen-
the relative helicities on the underlying plate
dencies of
δHV ≃[9.8±5.2,−22.6±3.8]%
scale
are
(Fig. 5(c)), δHPJ≃[6.2±4.0,−22.4±2.9]% (Fig. 5(f)), and
δHJ≃[48.5±24.4,−24.0±12.8]% (Fig. 5(i)) for the bin[2,4]-
based modeling, respectively.

Instead,

found.

Again, comparison to the solenoidal quality of the underly-
ing NLFF models (Fig. 2) reveals a dependency of the relative
helicities on very similar to that found for the magnetic ener-
gies (Sect. 3.2.2). This can be seen from the bin4-based NLFF
models of AR 12673, which yield lower values for the relative
helicities and simultaneously larger values of |Emix|/EJ,s than the
corresponding models at

4. Discussion

We demonstrated that the spatial-sampling-induced eﬀects are
not only diﬀerent at diﬀerent times (for a speciﬁc AR) but are
also distinctly diﬀerent for diﬀerent ARs. The chosen setup in
this study (i.e., we employ three time series of NLFF models

with diﬀerent plate scales for three diﬀerent ARs) furthermore
allows us to study overall trends to be expected for NLFF mod-
eling (and subsequent magnetic energy and helicity computa-
tions). Therefore, we generate histograms of the changes to the
physical quantities caused by the down-sampling of the input
data. To do so, we quantify the variations of the physical quanti-
ties by comparison of all qualifying bin2- and bin4-based NLFF
solutions. We only do so if all of the three solutions at a given
time instant meet our quality criteria. Generally, a NLFF model
qualiﬁes if it is physical (i.e., if EF>0; 59 NLFF models at bin2
and 52 at bin4). It qualiﬁes for subsequent helicity-computation
if it is suﬃciently solenoidal (Ediv/E≤0.1; 35 NLFF models at
bin2 and 31 at bin4). For those, median values as well as cor-
responding median absolute deviations for the induced changes
(denoted by angular brackets hereafter) are discussed in the fol-
lowing, and are interpreted in context with the changes to the
individual NLFF model time series listed in Sect. 3.

A ﬁrst main ﬁnding of our analysis regards the relative power
of distinct metrics to measure the quality of NLFF models. When
using the most indicative (sensitive) metrics for a correspond-
ing quantiﬁcation, we ﬁnd that, overall, the NLFF model qual-
ity is higher for larger pixel sizes. Using hθJi as a measure,
median changes by hδhθJii≈−26.4±3.8% and ≈−34.3±5.2% are
found for the bin2-based and bin4-based modeling, respectively
(Fig. 6(a)), using the bin1-based NLFF modeling as a reference
(which is used as a basis for all median changes listed in the
following). Though not explicitly shown, we note that the cor-
responding analysis of hCW sinθi leads to very similar conclu-
sions. An improvement of the solenoidal quality of the NLFF
models for larger pixel sizes might be expected, as the appli-
cation of binning to mimic a lower spatial resolution reduces
gradients present in the original data, that is, it should yield a
reduction of ∇ · B. Corresponding conclusions can be drawn
from the quantities most sensitive to the solenoidal quality of

Article number, page 7 of 11

A&Aproofs: manuscript no. 43222_ﬁnal

Fig. 5. Volume-integrated relative helicities computed from the NLFF solutions with three diﬀerent plate scales as a function of time for three
ARs. Top: Total helicity, HV . Middle: Volume-threading helicity, HPJ. Bottom: Helicity of the current-carrying ﬁeld, HJ. Red, blue, and green color
correspond to bin1, bin2, and bin4 data, respectively, with inherent plate scales of ∼0.36, ∼0.72, and ∼1.4 Mm. Vertical bars indicate the impulsive
phase of X-class ﬂares that occurred during the analyzed time intervals.

a magnetic ﬁeld, Ediv/E and |Emix|/EJ,s. Here, median changes
are found of hδEdiv/Ei≈[−37.8±3.7,−43.7±6.1]% (Fig. 6(b))
and hδ|Emix|/EJ,si≈[−39.7±3.0,−45.9±7.2]% (Fig. 6(c)) for the
bin[2,4]-based modeling, respectively. Those two measures
were found to be most sensitive (and indicative) regarding the
solenoidal quality of the tested NLFF models in Sect. 3.1 (see
also Thalmann et al. 2019), and to be superior to the use of an
alternative metrics to quantify the divergence-freeness, such as
h| fi|i and h| fd|i.

DeRosa et al. (2015) used h| fi|i as a measure to quantify
the divergence-free quality at diﬀerent spatial resolutions, ac-
cording to which the analyzed optimization-based modeling ex-
hibited successively larger values at lower spatial resolutions
(see their Table 2). If we were to draw conclusions based on
h| fi|i, we would base these on the corresponding median val-
ues of hh| fi|i × 104i≈[2.5±0.5,3.7±0.4,6.9±0.5] for bin[1,2,4]-
based modeling, respectively, and we would arrive at a simi-
lar conclusion to that of DeRosa et al. (2015), namely that the
divergence-free property is improved at increased spatial res-
olution. Nevertheless, h| fi|i has recently been dubbed inappro-
priate for the purpose of analyzing resolution-induced aspects
by Gilchrist et al. (2020), who proposed an improved (reﬁned)
corresponding measure, h| fd|i, which is almost insensitive to the
plate scale of the analyzed NLFF solution. Here, we ﬁnd me-
dian values of hh| fd|i × 1011cm−1i≈[4.2±0.9,3.1±0.3,3.0±0.3]
for bin[1,2,4]-based modeling, respectively, which translates
to the lowest divergence-freeness at highest spatial resolution.
Moreover, the trend of a lower solenoidal quality for smaller
pixel sizes can also be deduced from the optimization-based
NLFF models studied by DeRosa et al. (2015) (see their Ta-
ble 4), and we can obtain average estimates for plate scales
that approximately correspond to those used in our study
([0.36,0.72,1.44] Mm for our bin[1,2,4] cases, respectively). In
particular, we compute h[(Ediv/E)bin6, (Ediv/E)bin8]i≃0.08 (cor-

Article number, page 8 of 11

(|Emix|/EJ,s)bin6, (|Emix|/EJ,s)bin8

responding to an average plate scale of ∼0.74 Mm) and use
the (Ediv/E)bin14=0.06 provided by these latter authors (cor-
responding to an average plate scale of ∼1.48 Mm) to ﬁnd
a solenoidal quality improved by ≈12% and ≈33%, respec-
tively, with respect to their h[(Ediv/E)bin3, (Ediv/E)bin4]i≃0.09
(corresponding to an average plate scale of ∼0.37 Mm). Do-
ing the same for |Emix|/EJ,s, that is, using (|Emix|/EJ,s)bin14≃1.00
i≃1.17, we ﬁnd improve-
and h
ments of ≈3% and ≈17%, respectively, with respect to their
(cid:3)
(cid:2)
i≃1.20.
(|Emix|/EJ,s)bin3, (|Emix|/EJ,s)bin4
h
(cid:3)
(cid:2)
As a second major ﬁnding, we may state that there are cer-
tain overall tendencies regarding how a change in the spatial
sampling translates into a corresponding variation in the de-
duced physical quantities. Overall, the NLFF lower boundary
area-integrated quantities, |Φm| and |Iz|, exhibit spatial-sampling-
dependent variations in the form of a successive reduction when
the pixels size is enlarged (see Sect. 3.2.1 and Fig. 3). This is
actually expected because the binning, which is used to mimic
a reduction of the spatial resolution of the data, necessarily
reduces amplitudes and gradients with respect to that of the
original-resolution data. Though not shown explicitly, we de-
duce median changes of hδ|Φm|i≈[−3.9±0.4,−9.6±0.9]% and
hδ|Iz|i≈[−27.3±4.7,−46.4±2.4]% for the bin[2,4]-based lower
boundary data, respectively. The comparatively larger modiﬁca-
tions to |Iz| (compared to that of |Φm|) are expected, because dur-
ing NLFF modeling the horizontal magnetic ﬁeld components
are altered to a much greater degree than the vertical magnetic
ﬁeld component (hence is |Φm|; see Sect. 3.2.1 for details).

Intuitively, corresponding to the lower values of |Φm| and
|Iz|, we would expect to also ﬁnd smaller values for the volume-
integrated estimates (magnetic energies, electric currents, and
magnetic helicities) at successively lower spatial resolution.
Nevertheless, this is only partially true. For instance, the spatial-
sampling-induced changes to E0 are consistent with those found

Thalmann, J. K., et al.: The eﬀect of spatial sampling on magnetic ﬁeld modeling and helicity computation

Fig. 6. Histograms displaying the variations of the NLFF model quality as quantiﬁed by (a) hθJi, (b) Ediv/E, and (c) |Emix|/EJ,s. Relative diﬀerences
between the bin1-based estimates and the bin2-(blue) and bin4-based (green) modeling are shown. The total number of considered (qualifying)
NLFF models is indicated in black and is used as the basis to compute percentages. The total number of qualifying solutions at bin2 and bin4 are
indicated in blue and green, respectively. Median values and median absolute deviation derived from the histograms are shown as dashed vertical
lines and shaded bars, respectively.

Fig. 7. Histograms displaying the variations of the volume-integrated magnetic energies E0 (a), E (b), and EF (c) and absolute relative helicities,
HV (d), HPJ (e), and HJ (f). Relative diﬀerences between the bin1-based estimates and the bin2- (blue) and bin4-based (green) modeling are shown.
The total number of considered (qualifying) NLFF models is indicated in black and used as the basis to compute percentages. The total number of
qualifying solutions at bin2 and bin4 are indicated in blue and green, respectively. Median values and median absolute deviation derived from the
histograms are shown as dashed vertical lines and shaded bars, respectively.

the

and

7(d)),

volume-threading

for |Φm|, namely hδE0i≈[−0.6±0.2,−3.7±1.0]% for bin[2,4]-
based NLFF modeling, respectively (Fig. 7(a)). This is also true
for the total helicity, with hδ|HV|i≈[−5.9±13.2,−25.6±14.4]%
(Fig.
helicity with
hδHPJi≈[−10.3±13.1,−33.5±19.4]% (Fig. 7(e)), and is also
consistent with the corresponding trends seen in hδ|Iz|i.
In contrast, weaker electric currents do not necessarily
translate to systematically lower volume-integrated total
free magnetic energies (Fig. 7(c)),
energies (Fig. 7(b)),
and
helicities
current-carrying
for which
successively
found, namely
hδEi≈[3.0±1.0,1.6±3.3]%, hδEFi≈[16.0±4.2,22.0±8.1]%, and
hδHJi≈[25.6±6.3,24.0±15.7]% for bin[2,4]-based modeling,
respectively.

larger median

values

7(f)),

(Fig.

are

based

(2013),

Thalmann et al.

of
Hinode/SOT-SP data to a plate scale of ∼0.5 arcsec (called the
“SPbin” case in their study and intended to match the spatial res-
olution of HMI data in their study) reported a binning-induced
decrease in the total unsigned ﬂux and potential ﬁeld energy,

binning

the

on

In contrast,

along with an increase in total and free magnetic energy when
compared to the NLFF modeling using original-resolution
(∼0.3 arcsec at disk center; called “SPorig” case in their study)
the optimization-based models
SOT-SP data.
based on down-sampled SOT-SP data in DeRosa et al. (2015)
were associated to lesser total and free magnetic energies.
However, as already noted by DeRosa et al. (2015), estimates
of physical quantities become questionable in the presence
of signiﬁcant residual errors in the divergence of B. Now,
with results from the dedicated studies by Valori et al. (2016),
Thalmann et al. (2019), and Thalmann et al. (2020) at hand,
optimization-based NLFF solutions may only be trustworthy if
they exhibit values of Ediv/E.0.1 and |Emix|/EJ,s.0.4. However,
all of the optimization-based models analyzed in the work
of DeRosa et al. (2015) exhibited values of Ediv/E&0.06 and
|Emix|/EJ,s&0.9. Measures of the quality of the analyzed NLFF
models were not reported by Thalmann et al. (2013), and were
therefore not interpreted in context with the obtained estimates
of physical parameters. The quality measures for SP-orig model

Article number, page 9 of 11

A&Aproofs: manuscript no. 43222_ﬁnal

Fig. 8. Morphology of the reconstructed magnetic ﬁeld of AR 12673 at 08:48 on 6 September 2017 at diﬀerent spatial resolutions. From left to
right, the bin1-, bin2-, and bin4-based modeling is shown. The same footpoints were used in all cases. Field lines are colored according to the
magnitude of the electric current density, |J|. The gray-scale background resembles Bz of the NLFF lower boundary, scaled to ±2 kG.

read Ediv/E=0.08 and |Emix|/EJ,s=0.55. For the SPbin model,
they read Ediv/E=0.09 and |Emix|/EJ,s=0.51. Thus, observed
(apparently spatial-sampling-dependent)
trends of deduced
model-based physical parameters in Thalmann et al. (2013) and
DeRosa et al. (2015) must be questioned due to the poor model
quality of the underlying NLFF solutions. This makes it diﬃcult
to interpret the ﬁndings of those studies alongside results from
our extended approach and NLFF models of high solenoidal
and
quality
h|Emix|/EJ,si≈[0.18±0.05,0.14±0.04,0.11±0.03] for bin[1,2,4]-
based modeling. For example, we ﬁnd that, generally, binning-
induced eﬀects include decreases in unsigned magnetic ﬂuxes
and potential ﬁeld energies, along with increases in total and
free magnetic energies.

hEdiv/Ei≈[0.05±0.03,0.05±0.03,0.04±0.02]

In addition to ﬁnding that the solenoidal quality of NLFF
solutions directly aﬀects the resulting volume-integrated esti-
mates, the generally lower model quality of NLFF solutions with
smaller pixel sizes (Fig. 6) together with the lower values of
volume-integrated quantities directly associated to the presence
of electric currents (E, EF and HJ; Fig. 7) raises the question of
whether one should favor the use of optimization-based NLFF
modeling at a reduced spatial resolution. While its use is en-
couraged for applications to HMI data based on the analysis
presented here, a general recommendation in that sense cannot
be given, particularly because spatial-sampling-induced eﬀects
might behave diﬀerently for applications to data from other in-
struments (e.g., SOT-SP as discussed above). Indeed, a robust
understanding of spatial-sampling-induced eﬀects from the ap-
plication of the optimization method (and of other existing NLFF
methods) to SOT-SP data remains elusive.

Another aspect to consider is the following. Trends detected
from the time series of qualifying solutions in terms of system-
atic increases or decreases along individual time series appear
consistent across diﬀerent resolutions, including ﬂare-related
changes of magnetic energies and helicities (Figs. 4 and 5). How-
ever, the magnitude of those changes decreases with decreasing
resolution. For instance, taking the last/ﬁrst available data point
prior to and following the start/end of the nominal ﬂare impul-
sive phase, respectively, from bin[1,2,4]-based modeling we ﬁnd
ﬂare-related changes of ∆EF≈[25.7,21.4,9.6]% for the X2.2 ﬂare
hosted by AR 11158, ∆EF≈[27.9,25.6,21.2]% for the X5.4 ﬂare
hosted by AR 11429, and ∆EF≈[38.4,32.9,31.3]% for the X2.2
ﬂare hosted by AR 12673. (Due to the lack of qualifying NLFF
solutions, a corresponding estimate for the X9.3 ﬂare cannot
be provided.) Similar tendencies can be deduced for the ﬂare-
related changes of HJ, for example. These ﬁndings indicate that
the binning of data prior to NLFF modeling lowers the estimates

Article number, page 10 of 11

of (and therefore possibly underestimates) ﬂare-related changes,
because the model magnetic ﬁelds are naturally more similar to
each other than if they were based on data at smaller pixels sizes
(due to the smoothing of possibly important magnetic ﬂux and
electric currents at small spatial scales).

More generally, the realism of any kind of modeling is usu-
ally assumed to increase if the truly involved spatial scales are
accommodated adequately. In other words, modeling involving
smaller pixel sizes is assumed to provide a better representation
of the true complexity of the static magnetic corona. In Fig. 8, we
visualize NLFF magnetic ﬁeld models with diﬀerent plate scales,
using the example of AR 12673 at 08:48 on 2017 September 6.
Despite exhibiting some diﬀerences in morphology, the models
at all three tested spatial resolutions reveal almost the same basic
connectivity within the AR core, including the strongly twisted
ﬁeld along the solar north-south direction in the eastern part of
the AR (see also, e.g., Moraitis et al. 2019, for the visualization
of morphological diﬀerences when using diﬀerent free model pa-
rameters during optimization). From case to case and based on a
corresponding in-depth analysis of the magnetic ﬁeld morphol-
ogy, it therefore remains to be judged whether or not its inherent
pixel size is suﬃcient to provide model support for speciﬁc ob-
served features.

Finally, to place all of the above into greater context, the
overall changes induced by a change of the spatial sampling are
small compared to those possibly induced by the use of diﬀer-
ent calibration products of a given instrument or the use of data
from diﬀerent instruments. For such cases, relative changes of
the unsigned magnetic ﬂuxes and magnetic energies by factors
of &2 were reported (Thalmann et al. 2012, 2013). Also, dif-
ferences arising from the application of diﬀerent NLFF meth-
ods to the very same data set appear much larger, with method-
induced diﬀerences of a factor of &2 for free-energy estimates
(DeRosa et al. 2015).

5. Summary and Conclusion

NLFF modeling is regularly used to indirectly infer the 3D ge-
ometry of the coronal magnetic ﬁeld, which is not otherwise ac-
cessible on a regular basis by means of direct measurements.
For such purposes, routinely measured photospheric magnetic
ﬁeld vector data binned to a larger pixel size are used as an in-
put. However, this practice was suspected to aﬀect the reliabil-
ity of the modeling (DeRosa et al. 2009). In a dedicated study
that analyzes the resolution-dependence of diﬀerent NLFF meth-
ods, DeRosa et al. (2015) indeed demonstrated non-negligible
eﬀects. However, that work was based on the analysis of NLFF

Thalmann, J. K., et al.: The eﬀect of spatial sampling on magnetic ﬁeld modeling and helicity computation

modeling itself based on vector magnetic ﬁeld data at a sin-
gle time instant. It therefore remains unclear whether or not
detected trends are to be expected in general. Moreover, it is
diﬃcult to compare spatial-sampling-induced variations with
method-induced ones, because diﬀerent NLFF methods tested
in DeRosa et al. (2015) treat the input data very diﬀerently.

The aim of this work is to partially close those gaps. In or-
der to study spatial-sampling-induced eﬀects systematically, we
performed multi-snapshot NLFF modeling using a single NLFF
(optimization; Wiegelmann et al. 2012) method. For three solar
ARs (NOAAs 11158, 11429, and 12673), we used time series
of SDO/HMI data at three diﬀerent spatial resolutions: once at
their native resolution, and reduced by factors of two and four.
This allowed us to (1) study the eﬀect of binning as a function of
time (within time series of individual ARs), 2) spot very diﬀer-
ent spatial-sampling-induced changes for diﬀerent ARs, and 3)
deduce general trends.

Regarding items (1) and (2) above, we clearly demonstrate
that a certain change of the spatial sampling does not necessarily
translate to similar eﬀects at another time instant within a time
series of NLFF models for a particular AR, and also that the in-
duced changes can be distinctly diﬀerent for diﬀerent ARs. This
is true for both the magnitude of the induced changes as well
as their “direction” (increasing or decreasing). From the detailed
analysis of the HMI data-based NLFF model time series with
diﬀerent underlying plate scales of speciﬁcally chosen ARs, our
ﬁndings are as follows.

1. The overall success of NLFF modeling at a given pixel size
(plate scale) is necessarily diﬀerent for diﬀerent ARs, but
also varies considerably across the model time series of in-
dividual ARs (Sect. 3.1). Therefore, in agreement with past
experience, concise quality checks are to be performed for
every single NLFF model prior to any attempt to interpret
deduced physical parameters.

2. Among frequently used metrics to quantify the solenoidal
quality of NLFF models, two measures deduced from mag-
netic energy decomposition appear most sensitive (thus in-
dicative), namely the fraction of nonsolenoidal contributions
to the total energy (Ediv/E) and the relative size of non-
solenoidal and free magnetic energy (|Emix|/EJ,s). The re-
cently proposed measure h| fd|i appears less sensitive in that
respect.

3. The solenoidal quality of a NLFF model neither relates to the
underlying spatial sampling nor is to be found at similar lev-
els for diﬀerent ARs even when given the same underlying
plate scale (Sect. 3.1 and Fig. 2).

4. Binning of SDO/HMI data by a factor of four (to a plate
scale of ∼1.44 Mm (our “bin4” case) may yield unphysical
solutions (for which EF < 0; see Sect. 3.2.2 and Fig. 4).
5. The ultimate controlling parameter of the variations of the
deduced physical quantities induced by a changed plate scale
is the solenoidal quality of the NLFF model. This is evi-
denced by a clear corresponding (1:1) relation of changes
to amplitudes as well as to temporal patterns.

6. For each of our tested ARs, comparatively larger values of
E, EF, and |HJ|, in conjunction with lower values of E0, |HV |,
and |HPJ| (Sect. 3.2.2 and 3.2.3) were found for models with
lower values of |Emix|/EJ,s (and to a large degree also lower
values of Ediv/E).

7. Despite ﬂuctuations, observed trends in the time series of the
model-deduced physical parameters for the individual ARs
appear consistent across diﬀerent resolutions, including, for
example, phases of systematic increases or decreases and
pronounced ﬂare-related changes.

Having our extended analysis at hand, we were also able to
deduce some general trends for the application to HMI data (cf.
Sect. 4). Using hθJi, Ediv/E and |Emix|/EJ,s as measures, NLFF
modeling quality tends to be higher for larger pixel sizes in-
volved (Fig. 6). Taken together with simultaneously found larger
values of E, EF and HJ (Fig. 7) suggests that the optimization
method converges to more satisfactory solutions. Importantly,
estimates of ﬂare-related changes of EF and HJ from NLFF mod-
eling based on down-sampled input data are found to be system-
atically smaller, and are possibly underestimations of the true
extent. Binning (down-sampling) of SDO/HMI data by a factor
of two (to a plate scale of ∼0.72 Mm; “bin2”) yields changes
to the deduced volume-integrated total and potential magnetic
energies of .5% and to the total and volume-threading relative
helicities of .10% (Fig. 7). Though corresponding changes to
EF and HJ are somewhat larger (≈20%), they are relatively small
compared to other possible sources of uncertainty, including ef-
fects related to the use of diﬀerent calibration products, the use
of input data from diﬀerent instruments, or the application of dif-
ferent NLFF methods. Finally, NLFF modeling at down-sampled
spatial scales appears to retain the basic magnetic connectivity
(Fig. 8).

Acknowledgements. We thank the anonymous referee for valuable suggestions
to improve the clarity of the manuscript. J.K.T., M.G., and A.M.V. acknowl-
edge Austrian Science Fund (FWF): P31413-N27. SDO data are courtesy of the
NASA/SDO AIA and HMI science teams.

References

Berger, M. A. 1999, Plasma Physics and Controlled Fusion, 41, B167
Berger, M. A. 2003, Topological quantities in magnetohydrodynamics, ed.

A. Ferriz-Mas & M. Núñez, 345–374

Berger, M. A. & Field, G. B. 1984, Journal of Fluid Mechanics, 147, 133
Bobra, M. G., Sun, X., Hoeksema, J. T., et al. 2014, Sol. Phys., 289, 3549
Cargill, P. J. 2009, Space Sci. Rev., 144, 413
DeRosa, M. L., Schrijver, C. J., Barnes, G., et al. 2009, ApJ, 696, 1780
DeRosa, M. L., Wheatland, M. S., Leka, K. D., et al. 2015, ApJ, 811, 107
Finn, J. & Antonsen, T. J. 1984, Comments Plasma Phys. Controlled Fusion, 9,

111

Fuhrmann, M., Seehafer, N., Valori, G., & Wiegelmann, T. 2011, A&A, 526,

A70

Gary, G. A. 2001, Sol. Phys., 203, 71
Gary, G. A. & Hagyard, M. J. 1990, Sol. Phys., 126, 21
Gilchrist, S. A., Leka, K. D., Barnes, G., Wheatland, M. S., & DeRosa, M. L.

2020, ApJ, 900, 136

Gupta, M., Thalmann, J. K., & Veronig, A. M. 2021, A&A, 653, A69
Leka, K. D. & Barnes, G. 2012, Sol. Phys., 277, 89
Linan, L., Pariat, É., Moraitis, K., Valori, G., & Leake, J. 2018, ApJ, 865, 52
Lites, B. W., Akin, D. L., Card, G., et al. 2013, Sol. Phys., 283, 579
Metcalf, T. R., Jiao, L., McClymont, A. N., Canﬁeld, R. C., & Uitenbroek, H.

1995, ApJ, 439, 474

Moﬀatt, H. K. 1969, Journal of Fluid Mechanics, 35, 117
Moraitis, K., Sun, X., Pariat, É., & Linan, L. 2019, A&A, 628, A50
Pesnell, W. D., Thompson, B. J., & Chamberlin, P. C. 2012, Sol. Phys., 275, 3
Régnier, S. 2013, Sol. Phys., 288, 481
Scherrer, P. H., Schou, J., Bush, R. I., et al. 2012, Sol. Phys., 275, 207
Thalmann, J. K., Inhester, B., & Wiegelmann, T. 2011, Sol. Phys., 272, 243
Thalmann, J. K., Linan, L., Pariat, E., & Valori, G. 2019, ApJ, 880, L6
Thalmann, J. K., Pietarila, A., Sun, X., & Wiegelmann, T. 2012, AJ, 144, 33
Thalmann, J. K., Sun, X., Moraitis, K., & Gupta, M. 2020, A&A, 643, A153
Thalmann, J. K., Tiwari, S. K., & Wiegelmann, T. 2013, ApJ, 769, 59
Tsuneta, S., Ichimoto, K., Katsukawa, Y., et al. 2008, Sol. Phys., 249, 167
Valori, G., Démoulin, P., & Pariat, E. 2012, Sol. Phys., 278, 347
Valori, G., Démoulin, P., Pariat, E., & Masson, S. 2013, A&A, 553, A38
Valori, G., Pariat, E., Anﬁnogentov, S., et al. 2016, Space Sci. Rev., 201, 147
Wheatland, M. S. & Leka, K. D. 2011, ApJ, 728, 112
Wheatland, M. S. & Régnier, S. 2009, ApJ, 700, L88
Wheatland, M. S., Sturrock, P. A., & Roumeliotis, G. 2000, ApJ, 540, 1150
Wiegelmann, T. & Inhester, B. 2010, A&A, 516, A107
Wiegelmann, T., Inhester, B., & Sakurai, T. 2006, Sol. Phys., 233, 215
Wiegelmann, T., Petrie, G. J. D., & Riley, P. 2017, Space Sci. Rev., 210, 249
Wiegelmann, T. & Sakurai, T. 2012, Living Reviews in Solar Physics, 9, 5
Wiegelmann, T., Thalmann, J. K., Inhester, B., et al. 2012, Sol. Phys., 281, 37

Article number, page 11 of 11

