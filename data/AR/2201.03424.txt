2
2
0
2

n
a
J

0
1

]

O
C
.
h
t
a
m

[

1
v
4
2
4
3
0
.
1
0
2
2
:
v
i
X
r
a

Anti-Ramsey numbers for vertex-disjoint triangles∗

Fangfang Wua,b, Shenggui Zhanga,b,†, Binlong Lia,b, Jimeng Xiaoa,b

aSchool of Mathematics and Statistics,

Northwestern Polytechnical University, Xi’an, Shaanxi 710129, China

bXi’an-Budapest Joint Research Center for Combinatorics,

Northwestern Polytechnical University, Xi’an, Shaanxi 710129, China

Abstract

An edge-colored graph is called rainbow if all the colors on its edges are distinct.

Given a positive integer n and a graph G, the anti-Ramsey number ar(n, G) is the

maximum number of colors in an edge-coloring of Kn with no rainbow copy of G.

Denote by kC3 the union of k vertex-disjoint copies of C3. In this paper, we determine
the anti-Ramsey number ar(n, kC3) for n = 3k and n ≥ 2k2−k+2, respectively. When
3k ≤ n ≤ 2k2 − k + 2, we give lower and upper bounds for ar(n, kC3).

Keywords: anti-Ramsey number; complete graphs; vertex-disjoint triangles

1

Introduction

All graphs considered in this paper are ﬁnite and simple. For terminology and notations

not deﬁned here, we refer the reader to [2].

Let G be a graph. We denote by V (G) and E(G) the vertex set and the edge set

of G, respectively, and use v(G) and e(G) to denote the numbers of vertices and edges

in G. For a vertex v of G and a subgraph H of G, NH(v) is the set of neighbors of v

contained in H. We let dH(v) = |NH (v)|. Thus dG(v) is the degree of v in G. Denote

by δ(G) and ∆(G) the minimum and maximum degrees of the vertices of G. For two

vertex-disjoint subgraphs F and H of G, we use E(F, H) to denote the set of edges in G

∗Supported by NSFC (No. 12071370, 12131013, 12171393 and U1803263) and Natural Science Foun-

dation of Shaanxi Provincial Department of Education (2021JM-040).

†Corresponding

author.

E-mail

addresses:

wufangfang2017@mail.nwpu.edu.cn

(F. Wu),

sgzhang@nwpu.edu.cn (S. Zhang), binlongli@nwpu.edu.cn (B. Li), xiaojimeng@mail.nwpu.edu.cn (J.

Xiao).

1

 
 
 
 
 
 
between F and H, and e(F, H) the number of edges between F and H. If F contains only

one vertex f , we write E(f, H) for E({f }, H) and e(f, H) for e({f }, H). For a nonempty

subset V ′ ⊆ V (G) (or E′ ⊆ E(G)), we use G[V ′] (or G[E′]) to denote the subgraph of G

induced by V ′ (or E′), and G − V ′ (or G − E′) to denote the subgraph G[V (G) \ V ′] (or

G[E(G) \ E′]). When V ′ = {v} (or E′ = {e}), we use G − v (or G − e) instead of G − {v}

(or G − {e}). Furthermore, for a subgraph G′ of G, we write G − G′ for G − V (G′).

An edge-coloring of G is a mapping C : E(G) → N, where N is the natural number

set. We call G an edge-colored graph if it is assigned such an edge-coloring C and use

C(G) to denote the set, and c(G) the number of colors of edges in G. An edge-colored

graph is called rainbow if all the colors on its edges are distinct. Given a positive integer

n and a graph G, the anti-Ramsey number ar(n, G) is the maximum number of colors in

an edge-coloring of Kn with no rainbow copy of G and the Tur´an number ex(n, G) is the

maximum number of edges of a graph on n vertices containing no subgraph isomorphic

to G. By taking one edge of each color in an edge-coloring of Kn, one can show that

ar(n, G) ≤ ex(n, G).

Anti-Ramsey numbers were introduced by Erd˝os, Simonovits and S´os [5]. They showed

that these are closely related to Tur´an numbers. Since then numerous results were es-

tablished for a variety of graphs,

including, among others, cycles [1, 5, 11, 13, 14, 16],

cliques [5, 15, 17], paths [18], matchings [3, 6, 8, 17] and trees [10, 12]. If the readers want

to know other related results, refer a survey paper [7].

An interesting open problem concerning anti-Ramsey numbers is the determination

of the anti-Ramsey number of cycles. Erd˝os, Simonovits and S´os [5] conjectured that

ar(n, Cl) = ( l−2

2 + 1
l = 4 by showing that ar(n, C4) =

l−1 )n + O(1) and proved it for l = 3. Alon [1] proved this conjecture for
− 1. Jiang, Schiermeyer and West [13] proved the

4n
3

conjecture for l ≤ 7. Finally, Montellano-Ballesteros and Neumann-Lara [16] completely

(cid:4)

(cid:5)

proved this conjecture. Denote by Ωk the union of k vertex-disjoint cycles. Jin and Li [14]

determined the anti-Ramsey number ar(n, Ω2) and gave an upper bound of ar(n, Ωk).

Let kC3 denote the union of k vertex-disjoint copies of C3. Yuan and Zhang [20]

provide the exact results of ar(n, kC3) when n is suﬃciently large.

In this paper, we

improve the result of Yuan and Zhang [20] from n suﬃciently large to n ≥ 2k2 − k + 2,

and give some bounds and exact values for the other n. Note that the result of Erd˝os,

Simonovits and S´os [5] implies ar(n, C3) = n − 1. Therefore, we assume k ≥ 2 in the

rest of the paper. Obviously, if n < 3k, then Kn does not have enough vertices for k

vertex-disjoint triangles, which implies that a rainbow Kn does not have kC3’s. Hence

2

ar(n, kC3) =

n
2

when n < 3k. For n ≥ 3k, the question becomes nontrivial. We ﬁrst

(cid:1)
give a lower bound for ar(n, kC3).

(cid:0)

Theorem 1. ar(n, kC3) ≥ max
k−2
2

for all n ≥ 3k.

+ 1

3k−1
2

(cid:8)(cid:0)

(cid:1)

+ n − 3k + 1,

(n−k+2)2
4

j

k

+ (k − 2)(n − k + 2) +

(cid:0)

(cid:9)

(cid:1)
If n = 3k, then the ﬁrst number is greater than the second number in the formula of

Theorem 1. The following theorem shows that ar(3k, kC3) is equal to the ﬁrst number in

the formula of Theorem 1, which just attains the lower bound of Theorem 1.

Theorem 2. ar(3k, kC3) =

+ 1.

3k−1
2

(cid:0)

(cid:1)

Our next theorem gives an upper bound of ar(n, kC3) with 3k ≤ n ≤ 2k2 − k + 2.

Theorem 3. ar(n, kC3) ≤

j
for all 3k ≤ n ≤ 2k2 − k + 2.

(n−k+2)2
4

k

+ (k − 2)(n − k + 2) +

k−2
2

+ (k − 1)2 − n−3k

2 + 1

(cid:0)

(cid:1)

When n = 3k, the upper bound in Theorem 3 is equal to

3k−1
2

+ 1. Theorem 2 shows

that ar(3k, kC3) =
number ar(n, kC3) for n ≥ 2k2 − k + 2 is determined in the following theorem, which

+ 1 attains the upper bound of Theorem 3. The anti-Ramsey

(cid:0)

(cid:1)

3k−1
2

(cid:0)

(cid:1)

matches the lower bound in Theorem 1.

Theorem 4. ar(n, kC3) =

(n−k+2)2
4

j

k

+(k−2)(n−k+2)+

k−2
2

(cid:0)

(cid:1)

+1 for all n ≥ 2k2 −k+2.

From the above conclusions, we believe that equality holds in the inequality of Theorem

1 and propose the following conjecture.

Conjecture 1. ar(n, kC3) = max
k−2
2

for all n ≥ 3k.

+ 1

3k−1
2

(cid:8)(cid:0)

(cid:1)

+ n − 3k + 1,

(n−k+2)2
4

j

k

+ (k − 2)(n − k + 2) +

(cid:0)

(cid:9)

(cid:1)
The next section will be focused on introducing some lemmas, which are needed tools

to derive our main results. Some additional deﬁnitions and notations will be introduced

in the next section as well. The proofs of our theorems will be given in Section 3.

2 Preliminaries

Lemma 1. Let k ≥ 4 be a positive integer.

If G is a graph on 3k vertices such that

e(G) ≥

3k−1
2

(cid:0)

(cid:1)

+ 2, then G contains a kC3.

The complement of a graph G, denote by G, is the graph whose vertex set is V (G) and

whose edges are the pairs of nonadjacent vertices of G. By considering complements, we

obtain the following equivalent formulation of Lemma 1.

3

Lemma 2. Let k ≥ 4 be a positive integer.

If G is a graph on 3k vertices such that

e(G) ≤ 3k − 3, then G is k-partite with parts of size 3.

In the proof of Lemma 2 we shall make use of the following result.

Theorem 5 (Hajnal and Szemer´edi [9]). Let k be a positive integer and G a graph on 3k

vertices with ∆(G) ≤ k − 1. Then G is k-partite with parts of size 3.

Proof of Lemma 2. We prove the lemma by induction on k and start with the following

claim.

Claim 1. If v(G) = 12 and e(G) ≤ 9, then G is 4-partite with parts of size 3.

Proof. By Theorem 5, we can assume that there exists a vertex u ∈ V (G) such that

dG(u) ≥ 4. Since v(G) = 12 and e(G) ≤ 9, the number of components of G is at least 3.

Thus there is an independent set A in G such that u ∈ A and |A| = 3. Let G′ = G − A.

Since dG(u) ≥ 4 and e(G) ≤ 9, we have e(G′) ≤ 5. If G′ is 3-partite with parts of size 3,

then G is 4-partite with parts of size 3. So by Theorem 5, we assume that there exists a

vertex w ∈ V (G′) such that dG′(w) ≥ 3. Since v(G′) = 9 and e(G′) ≤ 5, the number of

components of G′ is at least 4. Thus there is an independent set B in G′ such that w ∈ B

and |B| = 3. Let G′′ = G′ − B. Since dG′(w) ≥ 3 and e(G′) ≤ 5, we have e(G′′) ≤ 2.

Clearly, G′′ is 2-partite with parts of size 3, which implies that G′ is 3-partite with parts

of size 3. Further, we have G is 4-partite with parts of size 3.

The base case for k = 4 can be obtained from Claim 1. By Theorem 5, we may

assume that there exists a vertex u ∈ V (G) such that dG(u) ≥ k. Since v(G) = 3k and

e(G) ≤ 3k − 3, the number of components of G is at least 3. Thus there is an independent

set A in G such that u ∈ A and |A| = 3. Let G′ = G − A. Since dG(u) ≥ k and

e(G) ≤ 3k − 3, we have e(G′) ≤ 3k − 3 − k < 3k − 3 − 3 = 3(k − 1) − 3. Thus, by the

induction hypothesis, we see that G′ is (k − 1)-partite with parts of size 3 which implies

that G is k-partite with parts of size 3.

(cid:3)

The following two lemmas are technical lemmas that deal with the construction of

vertex-disjoint triangles in a given graph.

Lemma 3 (Wang [19]). Let P = uvw be a path and C a triangle in G such that C is

vertex-disjoint from P . Then the following hold:

(i) If e(u, C) + e(w, C) ≥ 5 and e(v, C) ≥ 1, then G[V (P ) ∪ V (C)] contains two

vertex-disjoint triangles;

4

(ii) If e(P, C) ≥ 7, then either G[V (P ) ∪ V (C)] contains two vertex-disjoint triangles,

or e(u, C) = e(w, C) = 2, NC (u) = NC(w) and e(v, C) = 3.

Lemma 4. Let M be a matching of size 2 and C a triangle in G such that C is vertex-

disjoint from M .

If e(M, C) ≥ 9, then G[V (M ) ∪ V (C)] contains two vertex-disjoint

triangles.

Proof of Lemma 4. Let M = {ab, cd} and C = v1v2v3v1. Since e(M, C) ≥ 9, it

may be assumed without loss of generality that one of the alternatives e(ab, C) = 5 and

e(ab, C) = 6 holds. If e(ab, C) = 5, then e(cd, C) ≥ 4. Without loss of generality, assume

that a is joined to v1, v2, v3 and b to v1, v2. Furthermore e(vi, cd) = 2 for at least one i,

1 ≤ i ≤ 3. Then cdvic and one of abv1a, abv2a together constitute two vertex-disjoint

triangles in G[V (M ) ∪ V (C)]. If e(ab, C) = 6, then a and b are joined to v1, v2, v3, also

e(cd, C) ≥ 3, so it may be assumed without loss of generality that cv1, cv2 ∈ E(G). Then

cv1v2c and abv3a are two vertex-disjoint triangles in G[V (M ) ∪ V (C)]. This proves the
(cid:3)

lemma.

In 1963, Dirac [4] gave the minimum degree condition for the existence of vertex-disjoint

triangles.

Theorem 6 (Dirac [4]). For all positive integers n and k with n ≥ 3k, every graph on n

vertices with minimum degree at least n+k
2

contains k vertex-disjoint triangles.

With more eﬀort, we can prove the following two stronger structural results.

Lemma 5. Let G be a graph on n vertices with n ≥ 3k.

If δ(G) ≥ n+k−1

2

and G

contains no kC3’s, then there exists a partition V (G) = V1 ∪ V2 ∪ V3, so that |V1| = k − 1,
|V2| = |V3| = n−k+1
edges joining pairs of vertices in V2 and so does V3, unless G is isomorphic to G′ in Figure

, any two vertices in diﬀerent parts are adjacent, and there are no

2

1 when n = 10.

Figure 1. An exceptional graph G′ in Lemma 5.

5

Lemma 6. Let G be a graph on n vertices with n ≥ 3k + 1.

If δ(G) ≥ n+k−2

2

and

G contains a (k − 1)C3 but not kC3’s, then there exists a subgraph H ⊆ G such that

|V (H)| = 3k − 3, H contains a (k − 1)C3 and G − H is a complete bipartite graph whose

two parts are at least 2 in size.

The proofs of Lemmas 5 and 6 are more complicated, and we will put them in the last

section. Next, we introduce some additional deﬁnitions and notations.

Let v be a vertex in an edge-colored graph G. A color c ∈ C(G) is saturated by v if

all the edges with the color c are incident to v. The color saturated degree of v, denote

by ds(v), is the number of colors saturated by v. Clearly, ds(v) = c(G) − c(G − v). A

representing subgraph in an edge-coloring of Kn is a spanning subgraph containing exactly

one edge of each color.

3 Proofs of the theorems

Proof of Theorem 1. We prove the theorem by giving two colorings of Kn. For the ﬁrst

coloring, we choose K3k−1 and color all its edges with distinct colors. Only one color is

added for each vertex in the remaining vertices added. This is an exact

coloring with no rainbow kC3’s (see Figure 2 (a)).

3k−1
2

(cid:0)(cid:0)

(cid:1)

+n−3k+1
(cid:1)

-

For the second coloring, we ﬁrst choose Kk−2 ∨ K⌊ n−k+2

with distinct colors, where Kk−2 ∨ K⌊ n−k+2
disjoint union of Kk−2 and K⌊ n−k+2
to every vertex of K⌊ n−k+2
2
in Kn. This is an exact

⌋,⌈ n−k+2
2
(n−k+2)2
4

2

2

2

⌋,⌈ n−k+2
2

⌉ and color all its edges
⌉ is a graph obtained from the vertex-
⌋,⌈ n−k+2
2
⌉ by adding edges joining every vertex of Kk−2
⌋,⌈ n−k+2
2
⌉. Next, we put one extra color to all remaining edges
-coloring with no

+ (k − 2)(n − k + 2) +

k−2
2

+ 1
(cid:1)

rainbow kC3’s (see Figure 2 (b)).

(cid:0) j

k

(cid:0)

(cid:1)

6

rb
K3k−1

. . .

v1

v2

vn−3k vn−3k+1

x1
x2

xs

...

y1
y2

yt

...

s =

n−k+2
2

(cid:4)

(cid:5)

t =

n−k+2
2

(cid:6)

(cid:7)

rb

rb Kk−2

(a) The ﬁrst coloring of Kn

(b) The second coloring of Kn

Figure 2. Two colorings of Kn in the proof of Theorem 1.

The proof is complete.

(cid:3)

Proof of Theorem 2. The lower bound is due to Theorem 1.

In proving the upper

bound, we color the edges of K3k with

3k−1
2

+ 2 colors and prove that a rainbow kC3 can

be found. Let G be a representing subgraph. Then e(G) =

(cid:0)

(cid:1)

3k−1
2

+ 2, which implies that

= 3k − 3. If k ≥ 4, then by Lemma 1, G contains a kC3 that

(cid:0)

(cid:1)

e(G) =

3k
2

−

3k−1
2

(cid:0)

(cid:1)

(cid:0)(cid:0)

+ 2
(cid:1)

(cid:1)

form a rainbow kC3 in K3k. So we next consider the cases of k = 2 and k = 3.

Case 1. k = 2.

In this case, we have v(G) = 6 and e(G) = 3.

If ∆(G) = 1 or ∆(G) = 2 but

G[E(G)] 6= C3 or ∆(G) = 3, then clearly G is a 2-partite graph with parts of size 3 which

implies that G contains a 2C3 that form a rainbow 2C3 in K6. If G[E(G)] = C3, then

G is obtained from K3,3 plus three edges in one class that form the rainbow spanning

subgraph in K6 (see Figure 3). Now {x1y1y2x1, y3x2x3y3} or {x2y1y2x2, y3x1x3y3} or

{x3y1y2x3, y3x1x2y3} is a rainbow 2C3 in K6.

x1

x2

x3

y1

y2

y3

x1

x2

x3

y1

y2

y3

(a) G

(b) K6

Figure 3. G and K6 in Case 1.

Case 2. k = 3.

7

In this case, we have v(G) = 9 and e(G) = 6. If ∆(G) ≤ 2, then by Theorem 5, G

is a 3-partite graph with parts of size 3. This implies that G contains a 3C3 that form a

rainbow 3C3 in K9. So we assume that there exists a vertex, say u, such that dG(u) ≥ 3.

Since G has 9 vertices and 6 edges, the number of components of G is at least 3. We know

that there is an independent set A of vertices such that u ∈ A and |A| = 3. Let G

′

be the

graph obtained from G by removing the vertices in A. If dG(u) ≥ 4, then e(G

′

) ≤ 6−4 = 2,

which implies that G

′

is a 2-partite graph with parts of size 3. Thus G is a 3-partite graph

with parts of size 3. Clearly, we can ﬁnd a 3C3 in G that form a rainbow 3C3 in K9.

So we assume that dG(u) = 3. Then e(G

′

) ≤ 6 − 3 = 3. Similar to the Case 1, when

′

G

[E(G

′

)] 6= C3, we know that G

′

is a 2-partite graph with parts of size 3. Thus G is

a 3-partite graph with parts of size 3, which implies that G contains a 3C3 that form a

′
rainbow 3C3 in K9. If G

′

[E(G

)] = C3, according to the value of |NG

′(u) ∩ V (G

′

[E(G

′

)])|,

we distinguish the following four cases.

′

′

′

′

[E(G

[E(G

′(u) ∩ V (G

′(u) ∩ V (G

)])| = 0, see Figure 4 (a);

)])| = 1, see Figure 4 (b);

(1) |NG
(2) |NG
(3) |NG
(4) |NG
We use the solid lines to denote the edges of G and the dotted lines to denote the

)])| = 3, see Figure 4 (d).

)])| = 2, see Figure 4 (c);

′(u) ∩ V (G

′(u) ∩ V (G

[E(G

[E(G

′

′

′

′

edges of G in Figure 3. Clearly, in Cases (1), (2) and (3), we can ﬁnd a 3C3 in G

that form a rainbow 3C3 in K9. The graph G in Case (4) form the rainbow spanning

subgraph in the corresponding K9 and we can still ﬁnd a rainbow 3C3 in this K9 using

{u′uvu′, v′u′′v′′v′, ww′w′′w} or {u′′uvu′′, v′u′w′′v′, wv′′w′w} or {w′uvw′, v′v′′w′′v′, wu′u′′w}.

The proof is complete.

(cid:3)

Proof of Theorem 3. We will prove that every edge-coloring of Kn with at least

(n−k+2)2
4

+ (k − 2)(n − k + 2) +

2 + 2 distinct colors (call this
j
edge-colored graph G) contains a rainbow kC3 by induction on n. When n = 3k, the

+ (k − 1)2 − n−3k

k

k−2
2

(cid:1)

(cid:0)

graph G is edge-colored with at least

3k−1
2

+ 2 colors and we can ﬁnd a rainbow kC3 in

G by Theorem 2. So we assume that n ≥ 3k + 1.

(cid:0)

(cid:1)

If there exists a vertex u ∈ V (G) such that ds(u) ≤

c(G)−ds(u) ≥

(n−k+1)2
4

+(k−2)(n−k+1)+

k−2
2

+(k−1)2− n−3k−1

(cid:4)

hypothesis, we can ﬁnd a rainbow kC3 in G − u. So we assume that ds(v) ≥

(cid:0)

(cid:1)

j

k

(cid:5)

, then c(G − u) =

n+k−3
2
2 +2. By the induction
for

n+k−1
2

every v ∈ V (G).

(cid:4)

(cid:5)

Let H be a spanning subgraph of G such that E(v, H − v) contains exactly one edge

of each color saturated by v for every v ∈ V (H). Then H is rainbow and dH(v) ≥

8

u

u′

u′′

v

v′

w

w′

v′′

w′′

u

u′

u′′

v

v′

w

w′

v′′

w′′

(a) The graph in Case 2 (1)

(b) The graph in Case 2 (2)

u

u′

u′′

v

v′

w

w′

v′′

w′′

u

u′

u′′

v

v′

w

w′

v′′

w′′

(c) The graph in Case 2 (3)

(d) The graph in Case 2 (4)

Figure 4. The graphs in Case 2.

n+k−1
2

≥ n+k−2

2

for each v ∈ V (H). By Lemmas 5 and 6, one of the following two

(cid:5)

(cid:4)
alternatives holds: (1) there exists a partition V (H) = V1 ∪ V2 ∪ V3 such that |V1| = k − 2,
|V2| = |V3| = n−k+2
edges joining pairs of vertices in V2 and so does V3; (2) there exists a subgraph H ′ ⊆ H
such that |V (H ′)| = 3k − 3, H ′ contains a (k − 1)C3 and H − H ′ is a complete bipartite

, any two vertices in diﬀerent parts are adjacent, and there are no

2

graph whose two parts are at least 2 in size.

If (1) is the case then

e(H) ≤

(n − k + 2)2
4

(cid:22)

(cid:23)

+ (k − 2)(n − k + 2) +

k − 2

(cid:18)

2 (cid:19)

.

This implies that

c(G − E(H)) = c(G) − e(H) ≥ (k − 1)2 −

n − 3k
2

+ 2 ≥ (k − 1)2 −

2k2 − k + 2 − 3k
2

+ 2 = 2.

Hence there must be two new colors not in C(H) appearing on E(G[V2])∪E(G[V3]). Recall

that n ≥ 3k + 1. We have

and

|V2| − (k − 2) =

n − k + 2
2

− (k − 2) ≥ 4

|V3| − (k − 2) =

n − k + 2
2

− (k − 2) ≥ 4.

9

So, we can ﬁrst ﬁnd a rainbow (k − 2)C3 in H (say T1), and then we can ﬁnd a rainbow

2C3 in G − V (T1) (say T2) such that T1 and T2 constitute a rainbow kC3 in G.

If (2) is the case then it may be supposed without loss of generality that (A, B) is

a bipartition of H − H ′. Hence |A| ≥ 2 and |B| ≥ 2. By the deﬁnition of H, either

there exists an edge e′ ∈ E(G[A]) ∪ E(G[B]) such that C(e′) /∈ C(H) or for each edge

e ∈ E(G[A]) ∪ E(G[B]), C(e) is the color saturated by the ends of e. In both cases, we

can ﬁnd a rainbow kC3 in G.

The proof is complete.

(cid:3)

Proof of Theorem 4. The lower bound is due to Theorem 1. For the upper bound,

we will show that every edge-coloring of Kn with at least

+ (k − 2)(n − k +

(n−k+2)2
4

j

k

+ 2 distinct colors (call this edge-colored graph G) contains a rainbow kC3 by

2) +

k−2
2

(cid:0)

(cid:1)

induction on n.

When n = 2k2 − k + 2, we have (k − 1)2 − n−3k

2 = 0. By Theorem 3, we know that
,

n+k−2
2

G contains a rainbow kC3. If there exists a vertex u ∈ V (G) such that ds(u) ≤

then

(cid:4)

(cid:5)

c(G − u) = c(G) − ds(u) ≥

(n − k + 1)2
4

(cid:22)

(cid:23)

+ (k − 2)(n − k + 1) +

k − 2

(cid:18)

2 (cid:19)

+ 2.

By the induction hypothesis, we know that G − u contains a rainbow kC3. So we assume
that ds(v) ≥

for every v ∈ V (G). Let H be a spanning subgraph of G such

n+k
2

≥ n+k−1
2

that E(v, H −v) contains exactly one edge of each color saturated by v for every v ∈ V (H).

(cid:4)

(cid:5)

Then H is rainbow and dH(v) ≥ n+k−1

2

for each v ∈ V (H). By Theorem 6, we see that H

contains a (k − 1)C3. Hence, there exists a subgraph H ′ ⊆ H such that |V (H ′)| = 3k − 3,
H ′ contains a (k − 1)C3 and H − H ′ is a complete bipartite graph whose two parts are
at least 2 in size by Lemma 6. Let (A, B) be a bipartition of H − H ′. Then |A| ≥ 2 and

|B| ≥ 2. By the deﬁnition of H, either there exists an edge e′ ∈ E(G[A]) ∪ E(G[B]) such

that C(e′) /∈ C(H) or for each edge e ∈ E(G[A]) ∪ E(G[B]), C(e) is the color saturated

by the ends of e. In both cases, we can ﬁnd a rainbow kC3 in G.

The proof is complete.

(cid:3)

4 Proofs of Lemmas 5 and 6

Proof of Lemma 5. If n = 3k, then δ(G) ≥ n+k−1

2 = 4k−1

2

, i.e., δ(G) ≥ 2k. By Theorem

6, we can ﬁnd a kC3 in G. Thus we may assume that n ≥ 3k + 1.

Let T denote the set of all those subgraphs of G which have 3k − 3 vertices and contain

k − 1 vertex-disjoint triangles and let T ∗ denote the set of those elements T of T for which

10

G − T contains a path of maximal length. By Theorem 6, we know that T , T ∗ 6= ∅. Now,

we proceed by proving the following.

Claim 1. If T ∈ T and uv is an edge of G − T , then e(u, T ) + e(v, T ) ≥ 4k − 4.

Proof. Since G contains no kC3’s, we see that G − T contains no triangles, which implies

that dG−T (u) + dG−T (v) ≤ n − 3(k − 1) = n − 3k + 3. Hence e(u, T ) + e(v, T ) ≥ 2
(cid:0)

(n − 3k + 3) = 4k − 4.

n+k−1
2

−

(cid:1)

Claim 2. If T ∈ T ∗, then G − T contains at least one edge.

Proof. Let T1, T2, . . . , Tk−1 denote k − 1 vertex-disjoint triangles contained in T . Recall

that n ≥ 3k + 1. We have v(G − T ) = n − 3(k − 1) ≥ 4. If u and v are two isolated vertices

in G − T , then e(u, T ) + e(v, T ) ≥ 2
(cid:0)

(cid:1)
a triangle in T , say T1, such that e(u, T1) + e(v, T1) ≥ 5. Let V (T1) = {x, y, z}. It may be

n+k−1
2

= n + k − 1 ≥ 4k > 4(k − 1). So there exists

supposed without loss of generality that u is joined to x, y, z and v to x, y. Let H denote

G[{x, y, v} ∪ V (T − T1)]. Then H ∈ T and uz ∈ G − H. By the deﬁnition of T ∗, we know

that G − T contains at least one edge.

Claim 3. There must exist a graph T ∈ T such that G − T contains a 2K2.

Proof. Let T ′ be a graph in T ∗ and let T1, T2, . . . , Tk−1 denote k−1 vertex-disjoint triangles
contained in T ′. By Claim 2, we know that G − T ′ contains at least one edge. Suppose

that ab is an edge in G − T ′.

Recall that n ≥ 3k + 1. We have v(G − T ′) = n − 3(k − 1) ≥ 4. If G − T ′ contains more

than one isolated vertex, let u and v be two isolated vertices in G − T ′, then e(u, T ′) +

e(v, T ′) ≥ 2( n+k−1

2

) = n + k − 1 ≥ 4k > 4(k − 1). So there exists a triangle in T ′, say T1,

such that e(u, T1) + e(v, T1) ≥ 5. Let V (T1) = {x, y, z}. Without loss of generality, assume
that u is joined to x, y, z and v to x, y. Let H denote G[{x, y, v}∪V (T ′ −T1)]. Then H ∈ T
and {ab, uz} is a 2K2 in G − H. So next we will assume that G − T ′ contains at most one
isolated vertex. If G − T ′ contains no 2K2’s, then one of the following two alternatives
holds: (1) V (G − T ′) = {v0, v1, . . . , vt−1} and E(G − T ′) = {v0v1, v0v2, . . . , v0vt−2}; (2)
V (G − T ′) = {v0, v1, . . . , vt−1} and E(G − T ′) = {v0v1, v0v2, . . . , v0vt−1}, where t ≥ 4
(since v(G − T ′) ≥ 4).

If (1) is the case then e(v1, T ′)+ e(vt−1, T ′) ≥ n+k−1

2 = n + k − 2 ≥ 4k − 1 >
4(k − 1), so it may be assumed without loss of generality that e(v1, T1) + e(vt−1, T1) ≥ 5.

2 − 1+ n+k−1

Then either e(v1, T1) = 2 or e(v1, T1) = 3.

If e(v1, T1) = 2, then it may be supposed

without loss of generality that v1x, v1y ∈ E(G), and e(vt−1, T1) = 3. Let H denote

11

G[{x, y, v1}∪V (T ′−T1)]. Then H ∈ T and {zvt−1, v0v2} is a 2K2 in G−H. If e(v1, T1) = 3,

then e(vt−1, T1) ≥ 2 and it may be supposed without loss of generality that vt−1x, vt−1y ∈
E(G). Let H denote G[{x, y, vt−1} ∪ V (T ′ − T1)]. Then H ∈ T and {zv1, v0v2} is a 2K2

in G − H.

If (2) is the case then e({v1, v2, v3}, T ′) ≥ 3( n+k−1

2 − 1) ≥ 6k − 3 > 6(k − 1), so it may
be assumed without loss of generality that e({v1, v2, v3}, T1) ≥ 7, and further that v1 is

joined to x, y, z and v2 to x, y. Let H denote G[{x, y, v2} ∪ V (T ′ − T1)]. Then H ∈ T and

{zv1, v0v3} is a 2K2 in G − H.

Claim 4. If T ∈ T such that G − T contains a 2K2, let T1, T2, . . . , Tk−1 denote k − 1

vertex-disjoint triangles contained in T and let M denote a 2K2 in G−T , then e(M, Ti) = 8

for every 1 ≤ i ≤ k − 1. Suppose, furthermore, that M = {ab, cd} and Ti = ti1ti2ti3ti1.

Then G[V (M ) ∪ V (Ti)] contains a subgraph isomorphic to one of the following graphs

(i) G1: V (G1) = V (M ) ∪ V (Ti) and E(G1) = E(M ) ∪ E(Ti) ∪ {ti1a, ti1 b, ti1c, ti1d, ti2a,

ti2c, ti3b, ti3d};

(ii) G2: V (G2) = V (M ) ∪ V (Ti) and E(G2) = E(M ) ∪ E(Ti) ∪ {ti1a, ti1b, ti1c, ti2a, ti2b,

ti2c, ti3a, ti3d};

(iii) G3: V (G3) = V (M )∪V (Ti) and E(G3) = E(M )∪E(Ti)∪{ti1a, ti1b, ti1c, ti2a, ti2b,

ti2d, ti3a, ti3b}.

Proof. By Claim 1, we have e(M, T ) ≥ 2(4k − 4) = 8k − 8. Furthermore, we see that

e(M, T ) ≤ 8(k − 1) = 8k − 8; otherwise there exists a triangle in T , say T1, such that

e(M, T1) ≥ 9. By Lemma 4, we know that G[V (M ) ∪ V (T1)] contains two vertex-disjoint

triangles, with T2, . . . , Tk−1 as k vertex-disjoint triangles contained in G, a contradiction.

Hence we have e(M, T ) = 8k − 8. Again, by Lemma 4, one can show that e(M, Ti) = 8

for every 1 ≤ i ≤ k − 1.

Since G contains no kC3’s, for each Ti ⊆ T , we have G[V (M )∪V (Ti)] contains no 2C3’s.

Hence for each pair of vertices tix and tiy of Ti with 1 ≤ x < y ≤ 3, e({tix , tiy }, M ) ≤ 6; oth-

erwise it may be assumed without loss of generality that e({ti1 , ti2}, M ) ≥ 7, furthermore

ti1 is joined to a, b, c, d and ti2 to a, b, c. Then {abti2a, cdti1 c} is a 2C3 in G[V (M ) ∪ V (Ti)].

Recall that e(M, Ti) = 8. We see that there exist two vertices in Ti, say ti1 and ti2, such

that e({ti1 , ti2}, M ) ≥ 6. Hence e({ti1 , ti2}, M ) = 6. It may be assumed without loss of

generality that one of the alternatives e(ti1, M ) = 4 and e(ti1, M ) = 3 holds.

If e(ti1, M ) = 4, then e(ti2 , M ) = 2 and e(ti3 , M ) = 2. Since G[V (M ) ∪ V (Ti)] contains

no 2C3’s, we have NM (ti2)∩NM (ti3) = ∅, and |NM (ti2)∩V (e)| = 1 and |NM (ti3)∩V (e)| = 1

12

for each e ∈ E(M ), which implies that G[V (M ) ∪ V (Ti)] contains a subgraph isomorphic

to G1.

If e(ti1 , M ) = 3, then e(ti2, M ) = 3 and e(ti3, M ) = 2. Without loss of generality, as-

sume that NM (ti1) = {a, b, c}. This implies that a, b ∈ NM (ti2); otherwise {abti1a, cdti2 c}

is a 2C3 in G[V (M ) ∪ V (Ti)]. If NM (ti2) = {a, b, c}, then NM (ti3) ∈ {{a, d}, {b, d}}, which

implies that G[V (M )∪V (Ti)] contains a subgraph isomorphic to G2. If NM (ti2) = {a, b, d},

then NM (ti3) = {a, b}, which implies that G[V (M ) ∪ V (Ti)] contains a subgraph isomor-

phic to G3.

Claim 5. If T ∈ T such that G − T contains a 2K2, then G − T is a bipartite graph.

Proof. By contradiction. Let C = v1v2 · · · vlv1 (indices are taken modulo l) be an odd

cycle in G − T . Since G contains no kC3’s, we know that G − T contains no C3’s which

implies that l ≥ 5. Let T1, T2, . . . , Tk−1 denote k − 1 vertex-disjoint triangles contained in

T . By Claim 4, we have e({vivi+1, vi+2vi+3}, Tj) = 8 for every 1 ≤ i ≤ l and 1 ≤ j ≤ k − 1.

If there exists Tj′ ⊆ T such that G[{vi′, vi′+1, vi′+2, vi′+3}∪ V (Tj′)] contains a subgraph
isomorphic to G2 for some i′, 1 ≤ i′ ≤ l, then by Claim 4, it may be assumed without

loss of generality that e(vi′ vi′+1, Tj′) = 5 and e(vi′+2vi′+3, Tj′) = 3. This implies that

e(vi′+3vi′+4, Tj′) = 3 and e(vi′+4vi′+5, Tj′) = 5, furthermore e(vi′+1vi′+2, Tj′) = 3. This

contradicts that e({vi′+1vi′+2, vi′+3vi′+4}, Tj′) = 8.

Similarly, if there exists Tj′ ⊆ T such that G[{vi′, vi′+1, vi′+2, vi′+3} ∪ V (Tj′)] contains
a subgraph isomorphic to G3 for some i′, 1 ≤ i′ ≤ l, then by Claim 4, it may be assumed

without loss of generality that e(vi′vi′+1, Tj′) = 6 and e(vi′+2vi′+3, Tj′) = 2. This implies

that e(vi′+3vi′+4, Tj′) = 2 and e(vi′+4vi′+5, Tj′) = 6, furthermore e(vi′+1vi′+2, Tj′) = 2.

Hence e({vi′+1vi′+2, vi′+3vi′+4}, Tj′) = 4, a contradiction.

From the above analysis, we see that G[{vi, vi+1, vi+2, vi+3} ∪ V (Tj)] contains a sub-

graph isomorphic to G1 for all 1 ≤ i ≤ l and 1 ≤ j ≤ k − 1. Let T1 = xyzx and

M = {v1v2, v3v4}. Without loss of generality, assume that NM (x) = {v1, v2, v3, v4},

NM (y) = {v1, v3} and NM (z) = {v2, v4}. Then NC (x) = V (C). Since C is an odd cycle

and G[{vi, vi+1, vi+2, vi+3} ∪ V (Tj)] contains a subgraph isomorphic to G1 for all 1 ≤ i ≤ l

and 1 ≤ j ≤ k − 1, there exist two consecutive vertices in C, say vs and vs+1, such that

{vs, vs+1} ⊂ NC(y) or {vs, vs+1} ⊂ NC(z). Now xvs−1vs−2x, one of {yvsvs+1y, zvsvs+1z}

and T2, . . . , Tk−1 constitute k vertex-disjoint triangles contained in G, a contradiction.

Claim 6. Let T ∈ T such that G − T contains a 2K2, and let T1, T2, . . . , Tk−1 denote k − 1

vertex-disjoint triangles contained in T . If e(v, Ti) ≤ 2 for each v ∈ V (G − T ) and Ti ⊆ T ,

13

then there exists a partition V (G) = V1 ∪ V2 ∪ V3, so that |V1| = k − 1, |V2| = |V3| = n−k+1

2

,

any two vertices in diﬀerent parts are adjacent, and there are no edges joining pairs of

vertices in V2 and so does V3.

Proof. For each v ∈ V (G − T ) and Ti ⊆ T , since e(v, Ti) ≤ 2, we have dG−T (v) ≥

n+k−1

2 − 2(k − 1) = n−3k+3
we see that G − T = K n−3k+3

2

. Recall that v(G − T ) = n − 3(k − 1) = n − 3k + 3. By Claim 5,

, n−3k+3
2

, which implies that all the equalities are attained in

2

above, that is, e(v, Ti) = 2 for every v ∈ V (G − T ) and Ti ⊆ T . Let (A, B) be a bipartition
of G−T . Then |A| = n−3k+3

≥ 2 since n ≥ 3k+1. For any subgraph

≥ 2 and |B| = n−3k+3

2

2

M = 2K2 of G − T and every Ti ∈ T , by Claim 4, we know that G[V (M ) ∪ V (Ti)] contains

a subgraph isomorphic to G1. Let V (Ti) = {ti1 , ti2, ti3}. Without loss of generality,

assume that e(ti1, M ) = 4 for every 1 ≤ i ≤ k − 1. Then by G − T = K n−3k+3

2

, n−3k+3
2

,

e(ti1 , G − T ) = v(G − T ) = n − 3k + 3 with 1 ≤ i ≤ k − 1. If there exist a ∈ A and
b ∈ B such that a, b ∈ NG−T (v′) for some v′ ∈ {t12, t22, . . . , t(k−1)2, t13 , t23, . . . , t(k−1)3 },
it may be assumed without loss of generality that v′ = t12, then abt12a, t11cdt11 and

T2, . . . , Tk−1 constitute k vertex-disjoint triangles contained in G for each cd ∈ E(G − T −

{a, b}), a contradiction. Hence for all v ∈ {t12, t22 , . . . , t(k−1)2 , t13, t23, . . . , t(k−1)3}, either

NG−T (v) ⊆ A or NG−T (v) ⊆ B. Since G − T = K n−3k+3

2

, n−3k+3
2

and G[V (M ) ∪ V (Ti)]

contains a subgraph isomorphic to G1 for any subgraph M = 2K2 of G − T and every

Ti ∈ T , either NG−T (ti2) = A and NG−T (ti3) = B or NG−T (ti2) = B and NG−T (ti3) = A,

where 1 ≤ i ≤ k − 1.

Next, we will show that G − {t11, t21 , . . . , t(k−1)1 } is a bipartite graph. Suppose the

contrary. Let C = v1v2 · · · vlv1 be the shortest odd cycle in G−{t11, t21 , . . . , t(k−1)1 }. Since

G − T = K n−3k+3

2

, n−3k+3
2

distinguish three cases.

, we have V (C) ∩ {t12, t22, . . . , t(k−1)2, t13 , t23, . . . , t(k−1)3} 6= ∅. We

Case 1. V (C) ⊂ {t12, t22 , . . . , t(k−1)2 , t13, t23, . . . , t(k−1)3 }.

In this case, there exist two consecutive vertices in C, say vx and vx+1, such that

either NG−T (vx) = NG−T (vx+1) = A or NG−T (vx) = NG−T (vx+1) = B.

If l ≥ 5,

then avxvx+1a or bvxvx+1b is a shorter odd cycle, where a ∈ A and b ∈ B, a contra-

diction. Hence we have l = 3. Since for every 1 ≤ i ≤ k − 1, either NG−T (ti2) = A and

NG−T (ti3) = B or NG−T (ti2) = B and NG−T (ti3) = A, it may be assumed without loss

of generality that one of the following two alternatives holds: (1) V (C) = {t12, t22 , t23},

and NG−T (t12) = NG−T (t22 ) = A and NG−T (t23) = B; (2) V (C) = {t12, t22, t32} and

NG−T (t12 ) = NG−T (t22) = NG−T (t32) = A. Suppose that a1, a2 ∈ A and b1, b2 ∈ B. If (1)

14

is the case then a1t12t22a1, b1t21t23b1, b2t11t13b2 and T3, . . . , Tk−1 constitute k vertex-

disjoint triangles contained in G, a contradiction.

If (2) is the case then a1t12t22a1,

b1t21t23b1, a2t31t32a2, b2t11t13b2 and T4, . . . , Tk−1 constitute k vertex-disjoint triangles con-

tained in G, a contradiction.

Case 2. There exists an edge ab ∈ E(G − T ) such that a, b ∈ V (C).

Since C is the shortest odd cycle in G − {t11 , t21, . . . , t(k−1)1 }, we see that ab ∈ E(C).

Without loss of generality, assume that ab = vxvx+1. Recall that V (C)∩{t12, t22, . . . , t(k−1)2 ,

t13, t23, . . . , t(k−1)3 } 6= ∅ and for each v ∈ {t12, t22 , . . . , t(k−1)2 , t13, t23, . . . , t(k−1)3}, either

NG−T (v) = A or NG−T (v) = B. We have l ≥ 5 and V (C)∩{t12 , t22, . . . , t(k−1)2, t13, t23 , . . . ,

t(k−1)3} ⊆ {vx−1, vx+2}; otherwise we can ﬁnd a shorter odd cycle in G−{t11, t21, . . . , t(k−1)1 }.

This implies that |V (C) \ {t12 , t22, . . . , t(k−1)2, t13 , t23, . . . , t(k−1)3 }| ≥ 3. Hence there exists

a vertex u ∈ V (G − T − {a, b}) such that u ∈ V (C). Since G − T = K n−3k+3

2

, n−3k+3
2

,

vxvx+1 . . . uvx or vx+1vx+2 . . . uvx+1 is a shorter odd cycle in G − {t11, t21, . . . , t(k−1)1 }, a

contradiction.

Case 3. V (C) ∩ V (G − T ) 6= ∅, and V (C) ∩ V (G − T ) ⊆ A or V (C) ∩ V (G − T ) ⊆ B.

Without loss of generality, assume that V (C)∩V (G−T ) ⊆ A. Since V (C)∩V (G−T ) 6=

∅, we have |V (C)∩V (G−T )| ≥ 1. If |V (C)∩V (G−T )| ≥ 2, then there exist vertices a1, a2 ∈

A such that a1, a2 ∈ V (C) and a1a2 /∈ E(C), which implies that l ≥ 5. Furthermore, we

have NC(a1), NC (a2) ⊂ {t12 , t22, . . . , t(k−1)2, t13, t23 , . . . , t(k−1)3 }. Since for each vertex

v ∈ {t12, t22, . . . , t(k−1)2, t13 , t23, . . . , t(k−1)3}, either NG−T (v) = A or NG−T (v) = B, we

can ﬁnd a shorter odd cycle in G − {t11, t21, . . . , t(k−1)1}, a contradiction. So we have

|V (C) ∩ V (G − T )| = 1. Without loss of generality, assume that V (C) ∩ V (G − T ) = {v1}.

Then V (C) \ {v1} ⊂ {t12, t22, . . . , t(k−1)2, t13 , t23, . . . , t(k−1)3 }.

If l = 3, then NG−T (v2) = NG−T (v3) = A, since for every 1 ≤ i ≤ k − 1, either

NG−T (ti2) = A and NG−T (ti3) = B or NG−T (ti2) = B and NG−T (ti3) = A. Furthermore,

it may be assumed without loss of generality that v2 = t12 and v3 = t22. Suppose that

a1, a2 ∈ A, b1, b2 ∈ B and a1 = v1. Now a1t12t22a1, b1t11t13b1, b2t21t23b2 and T3, . . . , Tk−1

constitute k vertex-disjoint triangles contained in G, a contradiction.

If l ≥ 5, then there exist two consecutive vertices in V (C) \ {v1}, say vx and vx+1,

such that either NG−T (vx) = NG−T (vx+1) = A or NG−T (vx) = NG−T (vx+1) = B. Now

avxvx+1a or bvxvx+1b is a shorter odd cycle, where a ∈ A and b ∈ B, a contradiction.

15

Claim 7. Let T ∈ T such that G − T contains a 2K2, and let T1, T2, . . . , Tk−1 denote

k − 1 vertex-disjoint triangles contained in T . If n ≥ 3k + 2, then e(v, Ti) ≤ 2 for each

v ∈ V (G − T ) and Ti ⊆ T .

Proof. If n = 3k + 2, then δ(G) ≥ n+k−1

2 = 4k+1

2

, i.e., δ(G) ≥ 2k + 1. By Theorem 6, we

can ﬁnd a kC3 in G. Thus we may assume that n ≥ 3k + 3.

Suppose to the contrary that there exists a vertex u ∈ V (G − T ) such that e(u, Ti′ ) = 3

for some Ti′ ∈ T . Recall that n ≥ 3k + 3. We have v(G − T − u) = n − 3(k − 1) − 1 ≥ 5.

Since G − T contains a 2K2, we see that G − T − u contains at least one edge. Let

V (Ti) = {ti1, ti2, ti3}, where 1 ≤ i ≤ k − 1. Then for any edge ab ∈ E(G − T − u), we

have e(ab, Ti′ ) ≤ 3; otherwise there exists a vertex in V (Ti′), say ti′

1

, such that abti′

1

a

is a triangle, together with uti′

3u, and {T1, T2, . . . , Tk−1} \ {Ti′} constituting k vertex-
disjoint triangles contained in G, a contradiction. If G − T − u contains a 2K2, say M ,

2ti′

then e(M, Ti′ ) ≤ 6, contrary to Claim 4. So G − T − u contains no 2K2’s. Since G − T

contains a 2K2, we see that u is contained in every 2K2 of G − T .

We assert that G − T − u does not contain more than one isolated vertex. Otherwise,

2k > 2(k − 1) and e(y, T ) ≥ n+k−1

suppose that x and y are two isolated vertices in G − T − u. Then e(x, T ) ≥ n+k−1

2 − 1 ≥
2 − 1 ≥ 2k > 2(k − 1). It may be supposed without
loss of generality that e(x, Tj′) = 3 and e(y, Tj′′) = 3, where Tj′, Tj′′ ∈ T . Similar to the

discussion of u, we have for any edge e of G − T − x, e(e, Tj′) ≤ 3 and for any edge f

of G − T − y, e(f, Tj′′) ≤ 3. Since u is contained in every 2K2 of G − T , we see that

G − T − x contains a 2K2, say M1, or G − T − y contains a 2K2, say M2, which implies

that e(M1, Tj′) ≤ 6 or e(M2, Tj′′) ≤ 6, contrary to Claim 4.

From the above analysis, one of the following two alternatives holds: (1) V (G − T −

u) = {v0, v1, . . . , vt−1} and E(G − T − u) = {v0v1, v0v2, . . . , v0vt−2}; (2) V (G − T − u) =

{v0, v1, . . . , vt−1} and E(G − T − u) = {v0v1, v0v2, . . . , v0vt−1}, where t ≥ 5. By Claim 5,

we know that G − T is a bipartite graph. Hence dG−T (vi) ≤ 2 for every 1 ≤ i ≤ t − 1.

Since G − T contains a 2K2, we have uv0 /∈ E(G). This implies that there exists a
vertex vi′ with 1 ≤ i′ ≤ t − 1 such that G − T − vi′ contains a 2K2 in Cases (1) and
(2), denote by M ′. Note that e(vi′, T ) ≥ n+k−1
2 − 2 ≥ 2k − 1 > 2(k − 1). So it may
be assumed without loss of generality that e(vi′ , T1) = 3. Let M ′ = {ab, cd}. Then

e(ab, T1) ≤ 3; otherwise there exists a vertex in V (T1), say t11, such that abt11a is a triangle,

together with vi′t12t13vi′, T2, . . . , Tk−1 constituting k vertex-disjoint triangles contained in

G, a contradiction. Similarly, we also have e(cd, T1) ≤ 3. Hence one can show that
e(M ′, T1) ≤ 6, contrary to Claim 4.

16

Now, let T be a graph in T such that G − T contains a 2K2 and let T1, T2, . . . , Tk−1

denote k − 1 vertex-disjoint triangles contained in T . If n ≥ 3k + 2, then by Claims 6 and

7, the lemma holds. For n = 3k + 1, by Claim 5 and G − T contains a 2K2, we assume

that ({a1, a2}, {b1, b2}) is a bipartition of G − T . Furthermore, by Claim 4, one can show

that

dG−T (v) ≥

4(3k + 1 + k − 1)
2

− 8(k − 1) = 8.

v∈V (G−T )

X

Hence we have G − T = K2,2. If e(v, Ti) ≤ 2 for each v ∈ V (G − T ) and Ti ⊆ T , then by

Claim 6, the lemma holds. So it may be assumed without loss of generality that e(a1, T1) =

3. By Claim 4, we see that G[{a1, a2, b1, b2} ∪ V (T1)] contains a subgraph isomorphic to

G2. Otherwise, G[{a1, a2, b1, b2} ∪ V (T1)] contains two vertex-disjoint triangles, together

with T2, . . . , Tk−1 constituting k vertex-disjoint triangles contained in G, a contradiction.

For every Ti ∈ T , let Ti = ti1ti2ti3ti1. Then we can assume that NT1(a1) = {t11, t12 , t13},

NT1(a2) = {t13}, NT1(b1) = {t11, t12} and NT1(b2) = {t11 , t12}. This implies that e(a2, T −
T1) ≥ 3k+1+k−1

−(2+1) = 2k−3 > 2(k−2), so it may be assumed without loss of generality

2

that e(a2, T2) = 3. Similarly, one can show that G[{a1, a2, b1, b2} ∪ V (T2)] contains a

subgraph isomorphic to G2. By Claim 4, we can assume that NT2(a1) = {t21, t22 , t23},

NT2(a2) = {t23}, NT2(b1) = {t21, t22} and NT2(b2) = {t21, t22}. First, replace T1 by

t11a1b1t11 and replace G−T by t12t13a2b2t12. Then one can show that t13t21, t13t22, t12t23 ∈

G. Second, we replace T1 by t12a1b2t12 and replace G − T by t11t13a2b1t11. Then we have

t11t23 ∈ G.

If k = 3, that is, n = 10, then G is isomorphic to G′ in Figure 1. If k ≥ 4, that is,

n ≥ 13, then there must be two triangles in T , say T1 and T2, such that G[V (T1) ∪ V (T2) ∪

V (G − T )] is isomorphic to G′ in Figure 1. From the above analysis, we know that for each

Ti with 3 ≤ i ≤ k − 1, G[{a1, a2, b1, b2} ∪ V (Ti)] contains either a subgraph isomorphic to

G1 or a subgraph isomorphic to G2.

If there exists Ti′ ∈ T with 3 ≤ i′ ≤ k − 1 such that G[{a1, a2, b1, b2} ∪ V (Ti′)]

contains a subgraph isomorphic to G1, then by Claim 4, it may be supposed without

loss of generality that NG−T (ti′

1

) = {a1, a2, b1, b2}, NG−T (ti′

2

) = {a1, a2} and NG−T (ti′

3

) =

{b1, b2}. Replace Ti′ by ti′

1

a2b2ti′

1

and replace G − T by a1b1ti′

3

ti′

2

a1. Then one can show

that ti′

2t11, ti′

ti′

3

t22t23ti′

3

3t13, ti′

2t12, ti′

2a1, a2b2t21a2,
and {T3, . . . , Tk−1}\{Ti′ } constitute k vertex-disjoint triangles contained in G,

3t23 ∈ G. Now T1, a1ti′

3t21, ti′

2t22, ti′

3t22, ti′

2t21, ti′

1ti′

a contradiction.

If there exists Ti′ ∈ T with 3 ≤ i′ ≤ k − 1 such that G[{a1, a2, b1, b2} ∪ V (Ti′)]

contains a subgraph isomorphic to G2, then by Claim 4, it may be supposed without

17

loss of generality that NG−T (ti′

1

) = {a1, a2, b1}, NG−T (ti′

2

) = {a1, a2, b1} and NG−T (ti′

3

) =

{b1, b2}. Replace Ti′ by ti′

2a1. Then one can show
2b1, a2b2t21a2,
and {T3, . . . , Tk−1}\{Ti′ } constitute k vertex-disjoint triangles contained in G,

1 and replace G − T by a1b2ti′
2t22, ti′
3t22, ti′

3t23 ∈ G. Now T1, b1ti′

1a2b1ti′
2t21, ti′

3t13, ti′

3t21, ti′

2t12, ti′

1ti′

3ti′

that ti′

2t11, ti′

ti′

3

t22t23ti′

3

a contradiction.

The proof of Lemma 5 is complete.

(cid:3)

Proof of Lemma 6. Let T denote the set of all those subgraphs of G which have 3k − 3

vertices and contain k − 1 vertex-disjoint triangles and let T ∗ denote the set of those

elements T of T for which G − T contains a path of maximal length. Since G contains a

(k − 1)C3, we see that T , T ∗ 6= ∅. Now, we proceed by proving the following claims.

Claim 1. If T ∈ T and uv is an edge of G − T , then e(u, T ) + e(v, T ) ≥ 4k − 5.

Proof. Since G contains no kC3’s, we see that G − T contains no triangles, which implies
that dG−T (u) + dG−T (v) ≤ n − 3(k − 1) = n − 3k + 3. Hence e(u, T ) + e(v, T ) ≥ 2( n+k−2

) −

2

(n − 3k + 3) = 4k − 5.

Claim 2. If T ∈ T ∗, then G − T contains at least one edge.

Proof. Let T1, T2, . . . , Tk−1 denote k − 1 vertex-disjoint triangles contained in T . Recall

that n ≥ 3k + 1. We have v(G − T ) = n − 3(k − 1) ≥ 4. If u and v are two isolated vertices

in G − T , then e(u, T ) + e(v, T ) ≥ 2( n+k−2

2

) = n + k − 2 ≥ 4k − 1 > 4(k − 1). So there

exists a triangle in T , say T1, such that e(u, T1) + e(v, T1) ≥ 5. Let V (T1) = {x, y, z}. It

may be supposed without loss of generality that u is joined to x, y, z and v to x, y. Let H

denote G[{x, y, v} ∪ V (T − T1)]. Then H ∈ T and uz ∈ G − H. By the deﬁnition of T ∗,

we know that G − T contains at least one edge.

Claim 3. There must exist a graph T ∈ T such that G − T contains a 2K2.

Proof. Let T ′ be a graph in T ∗ and let T1, T2, . . . , Tk−1 denote k−1 vertex-disjoint triangles
contained in T ′. By Claim 2, we see that G − T ′ contains at least one edge. Suppose that

ab is an edge in G − T ′.

If G − T ′ contains more than one isolated vertex, then let u and v be two isolated

vertices in G − T ′. Hence e(u, T ′) + e(v, T ′) ≥ n + k − 2 ≥ 4k − 1 > 4(k − 1). So it may

be assumed without loss of generality that e(u, T1) + e(v, T1) ≥ 5. Let V (T1) = {x, y, z}.

Without loss of generality, assume that u is joined to x, y, z and v to x, y. Let H denote

G[{x, y, v} ∪ V (T ′ − T1)]. Then H ∈ T and {ab, uz} is a 2K2 in G − H. So next we will
assume that G − T ′ contains at most one isolated vertex. If G − T ′ contains no 2K2’s,

18

then one of the following two alternatives holds: (1) V (G − T ′) = {v0, v1, . . . , vt−1} and
E(G − T ′) = {v0v1, v0v2, . . . , v0vt−2}; (2) V (G − T ′) = {v0, v1, . . . , vt−1} and E(G − T ′) =
{v0v1, v0v2, . . . , v0vt−1}, where t ≥ 4 (since v(G − T ′) = n − 3(k − 1) ≥ 4).

If (1) is the case then e(v1, T ′)+ e(vt−1, T ′) ≥ n+k−2

2 = n + k − 3 ≥ 4k − 2 >
4(k − 1), so it may be assumed without loss of generality that e(v1, T1) + e(vt−1, T1) ≥ 5.

2 − 1+ n+k−2

Either e(v1, T1) = 2 or e(v1, T1) = 3. If e(v1, T1) = 2 then it may be supposed without

loss of generality that v1x, v1y ∈ E(G), and e(vt−1, T1) = 3. Let H denote G[{x, y, v1} ∪
V (T ′ − T1)]. Then H ∈ T and {zvt−1, v0v2} is a 2K2 in G − H. If e(v1, T1) = 3, then

e(vt−1, T1) ≥ 2 and it may be supposed without loss of generality that vt−1x, vt−1y ∈ E(G).
Let H denote G[{x, y, vt−1} ∪ V (T ′ − T1)]. Then H ∈ T and {zv1, v0v2} is a 2K2 in G − H.

If (2) is the case then e({v1, v2, v3}, T ′) ≥ 3( n+k−2

2 − 1) ≥ 6k − 5 > 6(k − 1), so it may
be assumed without loss of generality that e({v1, v2, v3}, T1) ≥ 7, and further that v1 is
joined to x, y, z and v2 to x, y. Let H denote G[{x, y, v2} ∪ V (T ′ − T1)]. Then H ∈ T and

{zv1, v0v3} is a 2K2 in G − H.

Claim 4. If T ∈ T such that G − T contains a 2K2, then G − T is a bipartite graph.

Proof. By contradiction. Let C = v1v2 · · · vlv1 (indices are taken modulo l) be the shortest

odd cycle in G − T . Since G contains no kC3’s, we know that G − T contains no triangles

which implies that l ≥ 5. Let T1, T2, . . . , Tk−1 denote k − 1 vertex-disjoint triangles con-

tained in T . Then we have e({vivi+1, vi+2vi+3}, Tj ) ≤ 8 for every 1 ≤ i ≤ l and 1 ≤ j ≤

k − 1. Otherwise it may be assumed without loss of generality that e({v1v2, v3v4}, T1) ≥ 9.

Then by Lemma 4, G[{v1, v2, v3, v4} ∪ V (T1)] contains two vertex-disjoint triangles, to-

gether with T2, . . . , Tk−1 constituting k vertex-disjoint triangles contained in G, a contra-

diction. By Claim 1, we have e({vivi+1, vi+2vi+3}, T ) ≥ 2(4k − 5) = 8k − 10 for every

1 ≤ i ≤ l. This implies that e({vivi+1, vi+2vi+3}, Tj ) ≥ 6 for every 1 ≤ i ≤ l and

1 ≤ j ≤ k − 1. In the rest of the proof, let V (Ti) = {ti1, ti2, ti3} for all Ti ⊆ T .

Now, we will show that e(vi, Tj) ≤ 2 for every 1 ≤ i ≤ l and 1 ≤ j ≤ k − 1. Suppose

the contrary.

It may be assumed without loss of generality that e(v1, T1) = 3. Then

e(vivi+1, T1) ≤ 3 for every 2 ≤ i ≤ l − 1; otherwise there exists a vertex in V (T1), say

t11, such that t11vivi+1t11 is a triangle, together with v1t12t13v1, T2, . . . , Tk−1 constituting

k vertex-disjoint triangles contained in G, a contradiction. Since e({v2v3, vl−1vl}, T1) ≥ 6,

we know that e(v2v3, T1) = 3 and e(vl−1vl, T1) = 3. Furthermore, we have e(v2, T1) ≤ 2;

otherwise e({v1v2, vl−1vl}, T1) ≥ 3 + 3 + 3 = 9. Similarly, we have e(vl, T1) ≤ 2; otherwise

e({vlv1, v2v3}, T1) ≥ 9. If e(v2, T1) = 0, then e(vivi+1, T1) = 3 for every 3 ≤ i ≤ l−1; other-

wise e({v1v2, vivi+1}, T1) ≤ 3+2 = 5. Hence we know that e(v3, T1) = 3, which implies that

19

e(v4, T1) = 0, and so on. Finally, we have e(vl, T1) = 3, a contradiction. If e(v2, T1) = 1,

then e(v3, T1) = 2 by e(v2v3, T1) = 3. By Lemma 3, we see that G[{v1, v2, v3} ∪ V (T1)]

contains two vertex-disjoint triangles, together with T2, . . . , Tk−1 constituting k vertex-

disjoint triangles contained in G, a contradiction. So e(v2, T1) = 2. Similarly, we have

e(vl, T1) = 2. Now if l ≥ 7, then by e({vivi+1, vi+2vi+3}, T1) ≥ 6 for every 2 ≤ i ≤ l − 1,

we know that e(vivi+1, T1) = 3 with 2 ≤ i ≤ l − 1. By e(v2, T1) = 2, one can easily

check that e(v3, T1) = 1, e(v4, T1) = 2, . . . , e(vl, T1) = 1, contrary to e(vl, T1) = 2. So

we have l = 5. Since e(v2, T1) = 2, e(v2v3, T1) = 3, e(v5, T1) = 2 and e(v4v5, T1) = 3,

we see that e(v3, T1) = 1 and e(v4, T1) = 1. By Lemma 3, either G[{v5, v1, v2} ∪ V (T1)]

contains two vertex-disjoint triangles, or NT1(v5) = NT1(v2).
If G[{v5, v1, v2} ∪ V (T1)]
contains two vertex-disjoint triangles, say T ′ and T ′′, then T ′, T ′′ and T2, . . . , Tk−1 con-

stitute k vertex-disjoint triangles contained in G, a contradiction. If NT1(v5) = NT1(v2),

then G[V (C) ∪ V (T1)] contains two vertex-disjoint triangles, together with T2, . . . , Tk−1

constituting k vertex-disjoint triangles contained in G, a contradiction.

Since C is the shortest odd cycle in G − T , each vertex in G − T − C can be adjacent

to at most 2 vertices in the C; otherwise we can ﬁnd a shorter odd cycle. Hence

l(n + k − 2)
2

≤

v∈V (C)

X

If v(G − T − C) = 0, then

dG(v) ≤ l(2k − 2) + 2l + 2(n − 3k + 3 − l).

l(n + k − 2)
2

≤

v∈V (C)

X

dG(v) ≤ l(2k − 2) + 2l = 2kl.

We assert that n ≤ 3k+2. Otherwise l(n+k−2)

2

> 2kl. Since n = 3k−3+l ≥ 3k+2, we have

n = 3k + 2. Hence all the equalities are attained in above. This implies that e(vi, Tj) = 2

for every 1 ≤ i ≤ l and 1 ≤ j ≤ k − 1. One can easily check that G[V (C) ∪ V (T1)]

contains two vertex-disjoint triangles, together with T2, . . . , Tk−1 constituting k vertex-

disjoint triangles contained in G, a contradiction. So we have v(G − T − C) ≥ 1. Now
n ≥ 3k − 3 + l + 1 ≥ 3k + 3. We assert that l ≥ 7. Otherwise l(n+k−2)

> l(2k − 2) +

2

2l + 2(n − 3k + 3 − l). Since e(vi, Tj) ≤ 2 for every vi ∈ V (C) and Tj ⊆ T , we know
that e(vi, G − T − C) ≥ n+k−2

for each vi ∈ V (C). Note that

2 − 2(k − 1) − 2 = n−3k−2

2

v(G − T − C) = n − 3k + 3 − l ≤ n − 3k − 4. Thus there exists a vertex u ∈ V (G − T − C)

such that uv1v2u is a triangle, which implies that G contains a kC3, a contradiction.

Now, let T be a graph in T such that G − T contains a 2K2 and let T1, T2, . . . , Tk−1

denote k − 1 vertex-disjoint triangles contained in T . By Claim 4, we know that G − T

is a bipartite graph. Let (A, B) be a bipartition of G − T . Since G − T contains a

20

2K2, we have |A| ≥ 2 and |B| ≥ 2. If there exist vertices a′ ∈ A and b′ ∈ B such that
dG−T (a′) ≥ n−3k+3
2
for every a ∈ A or dG−T (b) ≤ n−3k+3
have dG−T (a) ≤ n−3k+3
for every b ∈ B. Without loss of generality, assume that dG−T (a) ≤ n−3k+1

. Otherwise, we
2 − 1 = n−3k+1
for all a ∈ A.

and dG−T (b′) ≥ n−3k+3
2 − 1 = n−3k+1

, then G − T = K n−3k+3

, n−3k+3
2

2

2

2

2

2

This implies that for any a ∈ A,

e(a, T ) ≥

n + k − 2
2

(cid:24)

−

n − 3k + 1
2

(cid:25)

≥ 2k − 1 > 2(k − 1).

For any 2K2 of G − T , denote by M , we have e(M, Ti) ≤ 8 for every 1 ≤ i ≤ k − 1. Oth-

erwise by Lemma 4, G[M ∪ V (Ti)] contains two vertex-disjoint triangles, together with

{T1, . . . , Tk−1} \ {Ti} constituting k vertex-disjoint triangles contained in G, a contradic-

tion. By Claim 1, we have e(M, T ) ≥ 2(4k − 5) = 8k − 10. This implies that e(M, Ti) ≥ 6

for every 1 ≤ i ≤ k − 1. We distinguish two cases.

Case 1. |A| = 2.

Let A = {a1, a2} and let M ′ = {a1b1, a2b2} be a 2K2 in G − T . Then

2n+2k −4 =

4(n + k − 2)
2

≤

v∈V (M ′)

X

dG(v) ≤ 8(k −1)+

2(n − 3k + 1)
2

+4 = n+5k −3.

This implies that n ≤ 3k + 1; otherwise 2n + 2k − 4 > n + 5k − 3. Recall that n ≥ 3k + 1.

We have n = 3k + 1, which implies that the equalities are attained in the above. Hence
we see that dG−T (b1) = dG−T (b2) = 2 and dG−T (a1) = dG−T (a2) = n−3k+1

= 1 6= 2, a

2

contradiction.

Case 2. |A| ≥ 3.

Let a be an arbitrary vertex of A. Since e(a, T ) > 2(k − 1), it may be assumed without

loss of generality that e(a, T1) = 3. Let V (T1) = {x, y, z}. If G − T − a contains a 2K2,
say, M ′ = {a1b1, a2b2}, then e(T1, aibi) ≤ 3 with i = 1, 2; otherwise there exists a vertex in

V (T1), say x, such that xaibix is a triangle, together with ayza, T2, . . . , Tk−1 constituting
k vertex-disjoint triangles contained in G, a contradiction. Hence we have e(M ′, T1) ≤ 6.
This implies that e(a, Ti) ≤ 2 for every 2 ≤ i ≤ k−1; otherwise e(M ′, T ) ≤ 6+6+8(k−3) =
8k − 12 < 8k − 10. Hence we have dG−T (a) ≥ n+k−2

2 − (3 + 2(k − 2)) = n−3k

. Furthermore,

2

we see that

2n + 2k − 4 =

4(n + k − 2)
2

≤

v∈V (M ′)

X

dG(v) ≤ 6 + 8(k − 2) + (n − 3k + 1) + 2|A|.

By 2n + 2k − 4 ≤ 6 + 8(k − 2) + (n − 3k + 1) + 2|A|, we have |A| ≥ n−3k+5
2 ≤ dG−T (a) ≤ n−3k+1
. If n − 3k is even, then G − T = K n−3k+6

that |B| = n − 3k + 3 − |A| ≤ n−3k+1

odd, then G − T = K n−3k+5

. Note that n−3k

2

2

2

, n−3k+1
2

2

, n−3k
2

.

2

. This implies

. If n − 3k is

21

If G − T contains a 3K2, then n ≥ 3k − 3 + 6 = 3k + 3 and for any a ∈ A, G − T − a

contains a 2K2. From the above analysis, now whether n − 3k is odd or even, we see that

G − T is a complete bipartite graph whose two parts are at least 2 in size.

Suppose that G − T contains no 3K2’s. Let M ′′ = {a′b′, a′′b′′} be a 2K2 in G − T .

for all a ∈ A \ {a′, a′′} and |B| ≤ n−3k+1

Then dG−T (a) ≥ n−3k
no 3K2’s, we know that dG−T (a) ≤ 2 for each a ∈ A \ {a′, a′′}. Hence n−3k
implies that n ≤ 3k + 4. So |B| ≤ n−3k+1

2 ≤ 2, which
≤ 2. Recall that |B| ≥ 2. We have |B| = 2,

. Since G − T contains

2

2

2

which implies that n ≥ 3k + 3. So |A| = n − 3k + 3 − |B| ≥ 4 and for all a ∈ A \ {a′, a′′},
dG−T (a) ≥ n−3k
2 ≥ 2. Since |B| = 2, we have dG−T (a) = 2, where a ∈ A \ {a′, a′′}. This
implies that both G−T −a′ and G−T −a′′ contain a 2K2. Hence dG−T (a′) = dG−T (a′′) = 2.

We see that G − T is a complete bipartite graph whose two parts are at least 2 in size.

The proof of Lemma 6 is complete.

(cid:3)

References

[1] N. Alon, On a conjecture of Erd˝os, Simonovits and S´os concerning anti-Ramsey the-

orems, J. Graph Theory, 7 (1983) 91–94.

[2] J.A. Bondy and U.S.R. Murty, Graph Theory with Applications, Macmillan London

and Elsevier, New York (1976).

[3] H. Chen, X. Li and J. Tu, Complete solution for the rainbow numbers of matchings,

Discrete Math., 309 (2009) 3370–3380.

[4] G.A. Dirac, On the maximal number of independent triangles in graphs, Abhandlun-

gen Aus Dem Mathematischen Seminar Der Universitt Hamburg, 26 (1963) 78–82.

[5] P. Erd˝os, M. Simonovits and V.T. S´os, Anti-Ramsey theorems, in Inﬁnite and Finite

sets (Colloq. Keszthely 1973), Colloq. Math. Soc. J´anos Bolyai 10 (1975) 633–643.

[6] S. Fujita, A. Kaneko, I. Schiermeyer and K. Suzuki, A rainbow k-matching in the

complete graph with r colors, Electron. J. Combin., 16 (2009) ♯R51.

[7] S. Fujita, C. Magnant and K. Ozeki, Rainbow generalizations of Ramsey theory: a

survey, Graphs Combin., 26 (2010) 1–30.

[8] R. Haas and M. Young, The anti-Ramsey number of perfect matching, Discrete Math.,

312 (2012) 933–937.

22

[9] A. Hajnal and E. Szemer´edi, Proof of a conjecture of Erd˝os, in Combinatorial Theory

and its Applications Vol. II, ed. by P. Erd˝os, A. Renyi and V.T. S´os, Colloq. Math.

Soc. J. Bolyai 4, North-Holland, Amsterdam, 1970, 601–623.

[10] T. Jiang, Edge-colorings with no large polychromatic stars, Graphs Combin., 18

(2002) 303–308.

[11] T. Jiang and D.B. West, On the Erd˝os-Simonovits-S´os conjecture about the anti-

Ramsey number of a cycle, Combin. Probab. Comput., 12 (2003) 585–598.

[12] T. Jiang and D.B. West, Edge-colorings of complete graphs that avoid polychromatic

trees, Discrete Math., 274 (2004) 137–145.

[13] T. Jiang, I. Schiermeyer and D.B. West, The Erd˝os-Simonovits-S´os conjecture for

k ≤ 7, unpublished manuscript.

[14] Z. Jin and X. Li, Anti-Ramsey numbers for graphs with independent cycles, Electron.

J. Combin., 16 (2009) ♯R85.

[15] J.J. Montellano-Ballesteros and V. Neumann-Lara, An anti-Ramsey theorem, Com-

binatorica, 22 (2002) 445–449.

[16] J.J. Montellano-Ballesteros and V. Neuman-Lara, An anti-Ramsey theorem on cycles,

Graphs Combin., 21 (2005) 343–354.

[17] I. Schiermeyer, Rainbow numbers for matchings and complete graphs, Discrete Math.,

286 (2004) 157–162.

[18] M. Simonovits and V.T. S´os, On restricting colorings of Kn, Combinatorica, 4 (1984)

101–110.

[19] H. Wang, On the maximum number of independent cycles in a graph, Discrete Math.,

205 (1999) 183–190.

[20] L. Yuan and X. Zhang, Anti-Ramsey numbers of graphs with some decomposition

family sequences, arXiv:1903.10319 [math.CO].

23

