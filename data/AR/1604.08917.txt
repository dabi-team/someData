6
1
0
2

r
p
A
9
2

]

G
A
.
h
t
a
m

[

1
v
7
1
9
8
0
.
4
0
6
1
:
v
i
X
r
a

A COMPACTIFICATION OF THE MODULI SPACE OF
SELF-MAPS OF CP1 USING STABLE MAPS

JOHANNES SCHMITT

Abstract. We present a new compactiﬁcation M (d, n) of the moduli
space of self-maps of CP1 of degree d with n markings. It is constructed
via GIT from the stable maps moduli space M 0,n(CP1 ×CP1, (1, d)). We
show that it is the coarse moduli space of a smooth Deligne-Mumford
stack and we compute its rational Picard group. Using the recursive
boundary structure inherited from the stable maps space, we give an
explicit algorithm for computing top-intersection numbers of divisors on
M (d, n). We also study the m-fold iteration map M (d, n) 99K M (dm, n)
and we give a geometric way to extend this rational map to parts of the
boundary of M (d, n).

1. Introduction

1.1. The moduli space of self-maps. Self-maps of the projective line
constitute a rich subject with connections to many branches of mathematics,
including, among others, complex and arithmetic dynamics ([Mil06],[Sil07]),
Hurwitz theory ([Hur01]) and enumerative geometry ([OP06]).

Recall that a degree d morphism ϕ : CP1 → CP1 is given by two homoge-
neous polynomials of degree d with no common zeros. A natural parameter
space is thus the complement Ratd of the resultant hypersurface in CP2d+1.
The automorphism group Aut(CP1) = PGL2(C) acts on Ratd by conjuga-
tion and we can form the GIT quotient Md = Ratd//PGL2(C). This quotient
Md is a moduli space of degree d self-maps C → C of curves C (abstractly)
isomorphic to CP1.

To study how such maps degenerate in families, when the two deﬁning
In
polynomials obtain common zeroes, it is necessary to compactify Md.
[Sil98], Silverman obtains a compactiﬁcation M ss
d of Md as a GIT quotient
of CP2d+1 by PGL2(C). The boundary consists of self-maps ˜ϕ : C → C
of curves C ∼= CP1 with degree d′ < d together with an eﬀective divisor
i ki[qi] on C of degree d − d′, where we ask that ki ≤ (d + 1)/2 and
D =
moreover ki ≤ (d − 1)/2 if qi is a ﬁxed point of ˜ϕ. Such a point ( ˜ϕ, D) is
the limit of a family of self-maps ϕ : C → C where the deﬁning polynomials
acquire common zeroes qi of multiplicities ki.

P

1.2. A new compactiﬁcation. Building on the work of Silverman, we
construct a diﬀerent compactiﬁcation M (d, 0) (for d ≥ 2 even), where we

Date: November 9, 2018.

1

 
 
 
 
 
 
2

JOHANNES SCHMITT

allow C to degenerate into a nodal curve. More precisely, the points of
M (d, 0) correspond to stable self-maps ϕ : C → C where C is a connected
genus 0 curve with at worst nodal singularities, such that ϕ has image in a
unique irreducible component C0 ⊂ C and the total degree of ϕ (summed
over the components of the domain) is d. Here ϕ is called stable if

• every component C ′

6= C0 of C contracted by ϕ contains at least

three nodes,

• all connected components Ci of the complement C \ C sm

of the
smooth points of C0 map with degree at most (d+1)/2. If in addition
Ci ∩ C0 is a ﬁxed point of ϕ|C0 , we require the degree to be at most
(d − 1)/2.

0

By allowing the curve C to have n marked smooth points p1, . . . , pn, we
deﬁne the space M (d, n) similarly.

To construct M (d, n), we consider the stable maps moduli space

Yd,n = M 0,n(CP1 × CP1, (1, d)).

It parametrizes maps

f = (π, ϕ) : (C; p1, . . . , pn) → CP1 × CP1

of degree (1, d) from an n-marked at worst nodal genus 0 curve C, such that
each component of C contracted by f contains at least three special points,
i.e. nodes or markings. Observe that there is exactly one component C0 of
C mapping isomorphically to CP1 via π.

The data of f is equivalent to a degree d self-map

ϕ

−→ CP1 π−1

−−→ C0 ⊂ C

C

of C with image contained in a single component C0, together with an
isomorphism π : C0 → CP1. Note that when C is irreducible, we have
C = C0 and this identiﬁes Ratd ⊂ Yd,0 as the open subset of points f with
smooth source curve. We can thus see Yd,0 as a compactiﬁcation of Ratd.

In order to forget the additional information of the isomorphism π : C0 →
CP1 above to obtain the space M (d, n), we let PGL2(C) act on Yd,n by
postcomposing π with ψ ∈ PGL2(C). The orbits of PGL2(C) parametrize
exactly all possible ways to choose the identiﬁcation C0 ∼= CP1. Then we
can take the quotient using GIT.

A priori, for technical reasons, this GIT quotient only works well for d
even (see Lemma 2.8 and Corollary 2.3). However, if we allow ourselves to
put nonnegative rational weights di on the points pi, which aﬀect the GIT
stability condition, we are able to deﬁne quotient spaces M (d|d1, . . . , dn) also
in the case d odd (provided we have at least one marking). More precisely
we ask that there exists k ∈ Z≥1 such that the numbers ˜di = kdi are integers
˜di is odd. The corresponding tuples (d|d1, . . . , dn)
and such that k(d+1)+
are called admissible. When d is even and all di = 0, we recover the previous
description of M (d, n).

P

i

COMPACTIFICATION OF SELF-MAPS SPACE OF CP1 USING STABLE MAPS

3

Theorem (see Corollary 2.12). For (d|d1, . . . , dn) admissible, there exists a
GIT quotient M (d|d1, . . . , dn) of Yd,n by PGL2(C) which is a normal pro-
jective variety.

For later use we mention here that the natural map Yd,n → M 0,n forget-
ting the map f and stabilizing the curve (C; p1, . . . , pn) is PGL2(C)-invariant
and thus induces forgetful maps M (d|d1, . . . , dn) → M 0,n.

Let us point out some diﬀerences between the compactiﬁcations M (d, 0)
and M ss
d of Md. When a map ϕ ∈ Md degenerates, instead of introducing
a base point qi and recording its multiplicity ki as in M ss
d , we insert a new
component C ′ of C over the point qi together with a map C ′ → C of degree
ki. Thus in this map C ′ → C we can hope to preserve information about
the behaviour of ϕ around qi as it degenerates. Also note that the locus of
maps ˜ϕ in M ss
d with a base point of multiplicity k has codimension 2k − 1.
On the other hand, the corresponding locus of ϕ : C → C in M (d, 0) having
a component C ′
6= C0 with degree k under ϕ is a divisor. Thus it seems
easier to study such degenerations in M (d, 0).

1.3. Modular interpretation. We can also give a rigorous modular in-
terpretation for M (d|d1, . . . , dn). It is the coarse moduli space of a smooth
Deligne-Mumford stack M(d|d1, . . . , dn), which is an open substack of the
quotient stack M0,n(CP1 × CP1, (1, d))/PGL2(C). While every single geo-
metric point of this stack can be interpreted as a self-map of an n-pointed
nodal curve C as described above, this does not generalize well to self-maps
of families of nodal curves. Instead, it is necessary to work with two diﬀerent
families of curves.

Theorem (see Theorem 3.8). Given a scheme S, the objects of the stack
M0,n(CP1 × CP1, (1, d))/PGL2(C) over S are diagrams

C

µ

ϕ

˜C

π

σi

˜π

S

where π, ˜π are ﬂat, projective families of quasi-stable genus 0 curves, all
geometric ﬁbres of ˜π are isomorphic to CP1 and the maps µ, ϕ satisfy
µ∗([Cs]) = [ ˜Cs] and ϕ∗([Cs]) = d[ ˜Cs] for all geometric points s ∈ S (plus the
stable maps condition for the map (µs, φs) : (Cs; σ1(s), . . . , σn(s)) → ˜Cs× ˜Cs).
Over the points s with Cs ∼= CP1, the morphism µ−1 ◦ φ becomes a self-
map of the family C of degree d as expected. While it might seem that the
use of two diﬀerent families of curves no longer allows an interpretation as
a self-map, the second family ˜C will be an important ingredient in deﬁning
self-composition and iteration maps on M (d|d1, . . . , dn) in Section 5.

4

JOHANNES SCHMITT

1.4. General properties and the Picard group of M (d|d1, . . . , dn).
From a result of Levy ([Lev11]), we conclude that the space M (d|d1, . . . , dn)
is rational. As it is the coarse moduli space of smooth Deligne-Mumford
stack, it has ﬁnite quotient singularities. This allows us to compute its
rational Picard group.

Theorem (see Theorem 4.4, Theorem 4.9 and Corollary 4.17). For d ≥ 2
even and n ≥ 0, the rational Picard group of M (d, n) is generated by bound-
ary divisors together with the divisor class H descending from the evaluation
class ev∗
1OCP1×CP1(1, 0) on Yd,n for n = 1, 2. The relations between these
generators are generated by the pullbacks of the relations

D(A; B) =

D(A; B)

Xi,j∈A
k,l∈B

Xi,k∈A
j,l∈B

between boundary divisors in M 0,n (for {i, j, k, l} ⊂ {1, . . . , n}) under the
forgetful map M (d, n) → M 0,n.

This solves the case when all di = 0. If some of them are not, we have
for d = 0 an additional generator G descending from ev∗
1OCP1×CP1(0, 1). On
the other hand, we can have additional relations: we need to divide by the
classes of all codimension one loci which are not GIT-stable with respect to
(d|d1, . . . , dn) (see Corollary 4.17).

The relations above are determined using a method adapted from [Pan99],
which is based on intersecting possible relations with test curves CB,k. In
Proposition 4.12, we give an algorithm for computing the class of a divisor
D in terms of the generators above from its intersection numbers with such
test curves. We also determine the classes of some interesting divisors, such
as the locus Di=ﬁx where the i-th marking is a ﬁxed point of the self-map
(4.15).

1.5. Iteration maps. Other geometrically signiﬁcant divisors can be ob-
tained by studying composition and iteration of maps on the moduli spaces
Yd,n and M (d|d1, . . . , dn). We give a geometric interpretation for an exten-
sion

c : Yd1,0 × Yd2,0 99K Yd1d2,0

of the composition morphism

Ratd1 ◦ Ratd2 → Ratd1d2, (f1, f2) 7→ f2 ◦ f1

to parts of the boundary. This allows us to deﬁne an m-fold self-composition
map

scm : M (d|d1, . . . , dn) 99K M (dm|d1, . . . , dn).
Using this map, we deﬁne divisors Perm(λ) ⊂ M (d|d1, . . . , dn) parametrizing
self-maps ϕ : C → C having an m-periodic point p with a given multiplier
dϕ◦m|p = λ. We relate these cycles to similar varieties studied by Milnor
([Mil93]).

COMPACTIFICATION OF SELF-MAPS SPACE OF CP1 USING STABLE MAPS

5

1.6. Intersection theory of M (d|d1, . . . , dn). Another advantage of us-
ing the stable maps spaces for the compactiﬁcation is that their intersec-
tion theory is very well-understood and many of the results carry over to
the quotients M (d|d1, . . . , dn). In Section 6.1 we deﬁne ψ-classes and show
that their intersection numbers satisfy recursions corresponding to the usual
String, Dilaton and Divisor equations. But we are also able to compute gen-
eral top-intersections of divisors D1, . . . , D2d−2+n on M (d|d1, . . . , dn). When
D1 is a boundary divisor, it is the quotient of a ﬁbre product of smaller-
In Section 6.3 we look at the equivariant in-
dimensional moduli spaces.
tersection theory of such products in some more generality. Using these
results, we can determine the intersection of the restrictions of the divisors
D2, . . . , D2d−2+n on D1. This leads to the following result.

Theorem (see Section 6.4). There is a recursive algorithm computing top-
intersection numbers of divisors on M (d|d1, . . . , dn), using as input the base
cases d = 0, n = 2, 3 and d = 1, n = 1 together with the torus-equivariant
intersection theory of divisors on M 0,n′(CP1, d′).

This algorithm has been implemented and tested using SAGE.

1.7. Plan of the paper. The paper is organized as follows:
in Section 2
we present the construction of the spaces M (d|d1, . . . , dn). Their general
properties as well as some key examples for small d and n are studied in
Section 3. The rational Picard groups of Yd,n and M (d|d1, . . . , dn) are com-
puted in Section 4. Section 5 studies composition and iteration maps and
loci of maps with given multipliers at periodic points. Finally, in Section 6
we give a recursive algorithm for computing intersection numbers of divisors
on M (d|d1, . . . , dn).

Appendix A contains a list of notations used throughout the text. A
collection of small technical results, which we include due to the lack of a
good reference, can be found in Appendix B. In Appendix C we treat group
actions on stacks and the corresponding quotient stacks, based on the work
of Romagny ([Rom05]).

Acknowledgements

I would like to express my gratitude towards my advisor Rahul Pandhari-
pande, who proposed the construction of M (d|d1, . . . , dn) to me and guided
me in my research.
I also want to thank Felix Janda, Georg Oberdieck,
Christoph Schießl, Junliang Shen and Qizheng Yin for their advice and for
I am indebted to
helpful discussions about various points in this paper.
Emily Clader and Javier Fres´an for helping me improve the quality of this
text considerably. Finally, I want to thank Jakob Oesinghaus, who taught
me much about stacks and was always willing to help me with the ﬁner and
coarser technical points concerning them.

I am supported by the grant SNF-200020162928.

6

JOHANNES SCHMITT

Conventions

Throughout the paper we will work over the complex numbers. Hence
in the future, notations such as P1, GLn, SLn, PGLn will always denote the
corresponding objects deﬁned over C.

By a coarse moduli space of a stack X we mean a morphism X → X from
X to an algebraic space X, which is initial among morphisms to algebraic
spaces and induces a bijection on geometric points.

Contents

Introduction

Iteration maps
Intersection theory of M (d|d1, . . . , dn)

1.
1.1. The moduli space of self-maps
1.2. A new compactiﬁcation
1.3. Modular interpretation
1.4. General properties and the Picard group of M (d|d1, . . . , dn)
1.5.
1.6.
1.7. Plan of the paper
Acknowledgements
Conventions
2. Construction of the moduli space of self-maps
2.1. The space of degree d maps
2.2. The conjugation action and stability
2.3. Parametrized graphs
2.4. Weighted points
3. Examples and properties
3.1. Examples
3.2.
3.3. Modular interpretations
3.4. Rationality
4. The Picard group of M (d|d1, . . . , dn)
4.1. The Picard group of M 0,n(P1 × P1, (1, d))
4.2. The Picard group of M (d|d1, . . . , dn) ﬁnished
5.
5.1. Composition maps
5.2. Self-composition and multiplier loci
6.
Intersection theory on M (d|d1, . . . , dn)
6.1. Deﬁnitions and properties of ψ-classes
6.2.
Intersection on boundary divisors
6.3. Equivariant intersection theory of products
6.4. A recursive algorithm for intersection numbers of divisors
Appendix A. Notations
Appendix B. Generalities
Appendix C. Group actions on stacks
References

Iteration of rational functions

Isotropy and Singularities

1
1
1
3
4
4
5
5
5
6
7
7
8
10
13
14
14
18
22
27
28
29
42
43
44
57
64
64
69
71
77
80
80
82
88

COMPACTIFICATION OF SELF-MAPS SPACE OF CP1 USING STABLE MAPS

7

2. Construction of the moduli space of self-maps

We want to study self-maps of P1 of a ﬁxed degree d modulo the conjuga-
tion action of Aut(P1) = PGL2. For this we will start with a moduli space
which was already studied by Silverman in [Sil98] and chose a diﬀerent way
to compactify it, also allowing markings now.

2.1. The space of degree d maps. A morphism of degree d ≥ 0 from P1 to
itself is given by two sections Fa, Fb of OP1(d) not vanishing simultaneously.
Identifying global sections of OP1(d) with homogeneous polynomials in X, Y
of degree d, the morphism is of the form

[X : Y ] 7→[Fa(X, Y ), Fb(X, Y )]

=[a0X d + a1X d−1Y + . . . + adY d : b0X d + . . . + bdY d],

where the two polynomials Fa, Fb have no common factor. This last condi-
tion can be rephrased as

Res(Fa, Fb) 6= 0.
Here Res(Fa, Fb) is the resultant of Fa, Fb, which is a homogeneous poly-
nomial of degree 2d in the coeﬃcients a0, . . . , bd. As the pair λFa, λFb for
λ ∈ C \ {0} gives the same map, we see that the degree d maps from P1 to
itself are exactly given by elements

[a0 : a1 : . . . : ad : b0 : . . . : bd] ∈ P2d+1 \ {Res(Fa, Fb) = 0}.
Until now we have only repeated the deﬁnitions used in [Sil98]. The numbers
ai, bi are interpreted as the parameters of the map they describe. Instead we
want to interpret a morphism ϕ : P1 → P1 as its graph Γϕ ⊂ P1 × P1. This
graph will be the zero-locus of a section γ ∈ H 0(P1 × P1, O(d, 1)). Indeed,
by the Kunneth formula we have

H 0(P1 × P1, O(d, 1)) = H 0(P1, O(d)) ⊗C H 0(P1, O(1)).
So γ can uniquely be written as γ = f ⊗ S + g ⊗ T where f, g ∈ H 0(P1, O(d))
and S, T denote coordinates on the second factor of P1 × P1. Then one
checks that γ vanishes exactly on the graph of the morphism φ = [g : −f ].
Let Zd = P(H 0(P1 × P1, O(d, 1))), then (the graphs of) rational maps of
degree d are parametrized by an open subset Ratd ⊂ Zd. Indeed we have
the following modular interpretation for Ratd.

Lemma 2.1. The variety Ratd carries a universal family
P1

−−−−→ P1

Ratd

Ratd

and it represents the functor
Ratd : SchC → Sets,


Ratd

y


Ratd

y

S 7→ {S-morphisms φ : P1

S → P1

S with φ∗O(1) = O(d)}.

8

JOHANNES SCHMITT

Proof. See [Sil98, Theorem 3.1].

(cid:3)

We also want to ﬁnd an interpretation for the elements of Zd \Ratd. They
correspond to f, g having some common roots, say we have pi = [ci : di] ∈ P1
distinct roots of multiplicity ei > 0 for i = 1, . . . , k. Then

k

k

f =

(diX − ciY )ei ˜f , g =

(diX − ciY )ei ˜g

Yi=1

Yi=1

with ˜f , ˜g homogeneous polynomials of degree ˜d = d −
k
i=1 ei without com-
mon factor. Then the zero locus of γ = f ⊗ S + g ⊗ T in P1 × P1 consists
of one horizontal section h, namely the graph of the degree ˜d map given
by [˜g : − ˜f ], together with the vertical sections vi = {pi} × P1, on which γ
vanishes with multiplicity ei. This corresponds to a rational map of degree
˜d with locus of indeterminacy formed by the points pi. After cancellation,
this gives a morphism of degree ˜d. We will see soon that the vertical sections
ﬁt naturally with our new geometric compactiﬁcation of Ratd.

P

2.2. The conjugation action and stability. Now we want to study self-
maps of P1 up to change of coordinates on P1, that is we want to divide by
the conjugation action of Aut(P1) = PGL2. For technical reasons we will
instead divide by the action of G = SL2. We have a natural action of G on
P1, given by

a b
c d

(cid:18)

(cid:19)

[X : Y ] = [aX + bY : cX + dY ].

Then for a map ϕ : P1 → P1 and an element g ∈ G we deﬁne

(gϕ)(x) = gϕ(g−1x).

Via the identiﬁcation above, this also induces a (projectively) linear action
of G on Zd. The action leaves the subset Ratd invariant. When viewing
elements of Zd as the corresponding graphs Γ ⊂ P1 × P1, the action comes
from the diagonal action g(p, q) = (gp, gq) of SL2 on P1 × P1.

Now in order to deﬁne a quotient of Zd by G, we will use Geometric
∼= P2d+1,
Invariant Theory as described by Mumford in [MFK94]. As Zd
it has a natural line bundle L = OP2d+1(1), which is ample and carries a
canonical G-linearization (see [MFK94, 1.§3]). In [Sil98, Proposition 2.2],
Silverman describes the set of (semi)stable points Z ss
d corresponding to
the action above. His results have the following convenient interpretation in
terms of vertical sections.

d , Z s

Lemma 2.2. An element Γ ∈ Zd consisting of a horizontal section h and
vertical sections vi = {pi} × P1 of multiplicities ei (i = 1, . . . , k) is

• semistable, iﬀ ei ≤ d−1

2 or we have ei ≤ d+1

2 and pi is not a ﬁxed point

of the induced morphism P1 → P1 of lower degree for i = 1, . . . , k,

• stable, iﬀ ei < d−1

2 or we have ei < d+1

2 and pi is not a ﬁxed point

of the induced morphism P1 → P1 of lower degree for i = 1, . . . , k.

COMPACTIFICATION OF SELF-MAPS SPACE OF CP1 USING STABLE MAPS

9

Proof. By [Sil98, Proposition 2.2], the rational map given by [a0X d + . . . +
adY d : b0X d + b1X d−1Y + . . . + bdY d] is unstable if and only if after conju-
gation by G we can reach

(1)

ai = 0 for i ≤

d − 1
2

and bi = 0 for i ≤

Condition (1) is equivalent to saying that

Fa vanishes at [1 : 0] to order >

(2)

and Fb vanishes at [1 : 0] to order >

d + 1
2

.

d − 1
2
d + 1
2

.

One checks that the negation of (2) is equivalent to the semistability con-
dition given above for pi = [1 : 0]. Here one uses that p = [1 : 0] is a ﬁxed
point of the induced morphism iﬀ Fb vanishes at p with strictly higher order
than Fa. But now our formulation of the stability condition no longer refers
to the speciﬁc point [1 : 0] and as G acts transitively on P1, we have the
desired criterion for semistability of Γ. The stable case follows similarly. (cid:3)

From the above one sees easily, that for d even the situation is particularly

nice.

Corollary 2.3. For d even we have Z ss

d = Z s
d.

It is also obvious that Ratd ⊂ Z s
deﬁne quotients Md = Ratd//G, M ss
work with those in the future, but mention them for completeness.

d. By [Sil98, Theorem 2.1] we can now
d = Z s
d = Z ss
d//G. We will not

d //G , M s

Finally, we want to add a remark that was mostly proved in Silverman’s

paper and we include the full result here.

Proposition 2.4. The space Md is a coarse moduli space for the functor

M d : SchC → Sets

where two S-morphisms φ, ψ : P1
isomorphism f : P1

S → P1

S over S such that φ ◦ f = f ◦ ψ.

S satisfy φ ∼ ψ if there exists an

S 7→ Ratd(S)/ ∼,
S → P1

Proof. This is essentially the content of Theorem 3.2 in [Sil98]. There, a
natural transformation ψ : M d → Hom(−, Md) is constructed such that the
diagram

Ratd

Hom(−, Ratd)

◦π



M d
y

ψ

−−−−→ Hom(−, Md)



y

commutes, where π : Ratd → Md is the quotient map.
It is also shown
that ψ induces a bijection on geometric points. To complete the proof that
ψ is initial among such natural transformations, one can use the fact that
Indeed, assume that ˜ψ : M d →
Ratd → Md is a categorical quotient.

10

JOHANNES SCHMITT

Hom(−, Z) is another natural transformation. Then composing with the
morphism Ratd → M d we obtain a functor Ratd → Hom(−, Z). But this
morphism of functors is equivalent to a morphism ϕ : Ratd → Z of schemes.
We would like to show that this morphism is G-invariant. Indeed, consider
the maps σ, π2 : G × Ratd → Ratd, where σ is the action map and π2 is the
projection on the second factor. We need to show ϕ ◦ σ = ϕ ◦ π2. But these
maps are the pullbacks of ϕ ∈ Hom(Ratd, Z) under σ, π2. By functoriality,
they come from the pullbacks

of the universal self-map

σ∗U , π∗

2U ∈ Ratd(G × Ratd)

U = (P1

Ratd → P1

Ratd) ∈ Ratd(Ratd)

over Ratd. However, from their deﬁnition one sees immediately that σ∗U ∼=
π∗
2U , so they induce the same maps ϕ ◦ σ = ϕ ◦ π2. Now as Ratd → Md is a
categorical quotient, the map ϕ factors through a unique map Md → Z. One
checks that this gives the desired natural transformation Hom(−, Md) →
Hom(−, Z) using that Ratd → M d is surjective on objects over all schemes
(cid:3)
S.

2.3. Parametrized graphs. We have already interpreted Zd as the space
of (generalized) graphs of rational self maps of P1 of degree d. Now we
will consider parametrizations of these graphs by trees of P1s, that is, nodal
curves of genus 0.

To be more precise, consider the stable maps space

Yd,n = M 0,n(P1 × P1, (1, d)).
The notation Yd,n is not standard but as the space will be used frequently in
the future, we use Yd,n for brevity. From [FP97, Theorem 2] we see that it
is a normal, projective variety of pure dimension 2d + 1 + n and it is locally
the quotient of a nonsingular variety by a ﬁnite group.

We now show that there is a natural action of PGL2 on Yd,n. At this
point it will be advantageous to construct this action as an action of the
group scheme PGL2 on the moduli stack M0,n(P1 × P1, (1, d)) inducing an
action of PGL2 on the coarse moduli space Yd,n. Here we use the deﬁnition
of [Rom05] for a group action on a stack (see also Appendix C).

Corollary 2.5. There exists a natural strict action of the group PGL2 on the
stack M0,n(P1×P1, (1, d)) induced by the diagonal action of PGL2 on P1×P1.
For g ∈ PGL2 and (f : C → P1 × P1; p1, . . . , pn) ∈ M0,n(P1 × P1, (1, d)) a
pair of C-valued points, we have

g(f ; p1, . . . , pn) = (g∗ ◦ f ; p1, . . . , pn),

where g∗ : P1 × P1, (p, q) 7→ (gp, gq).

Proof. This follows from Lemma C.6 applied to the diagonal action of PGL2
(cid:3)
on X = P1 × P1.

COMPACTIFICATION OF SELF-MAPS SPACE OF CP1 USING STABLE MAPS

11

We immediately obtain an induced action of PGL2 on the coarse moduli
space Yd,n of M0,n(P1 × P1, (1, d)). For taking the GIT quotient, we will
work with the induced action of G = SL2.

Lemma 2.6. There exists a natural G-equivariant morphism j : Yd,n → Zd
uniquely deﬁned by requiring that the image

s = j((f ; p1, . . . , pn)) ∈ Zd = P(H 0(P1 × P1, (d, 1)))

of the class of the morphism f : C → P1 × P1 satisﬁes

div(s) = f∗[C].

In particular we see that j does not depend on the marked points.

Proof. The map j was constructed by Givental in [Giv96, The Main Lemma]
for the case n = 0. From the proof there it is clear that on the closed
points it is given by the set theoretic map described above. We deﬁne it for
arbitrary n by precomposing the map for n = 0 with the forgetful map of
all marked points. Considering the action of G on closed points of Yd,n, one
sees immediately that the forgetful map Yd,n → Yd,0 is G-equivariant. As
the G-action on Zd is given by the componentwise action of G on P1 × P1
when considering elements of Zd as their corresponding vanishing schemes
in P1 × P1, one veriﬁes that the map j is G-equivariant in the n = 0 case by
(cid:3)
considering the action on closed points.

In the case n ≥ 1, the map j loses information by forgetting the marked
points. However, by using the evaluation maps, we can preserve this infor-
mation in many cases.

: Yd,n = M 0,n(P1 × P1, (1, d)) → P1 × P1 be the
Lemma 2.7. Let evi
evaluation associated to the ith marked point, and let π1 : P1 × P1 → P1 be
the projection to the ﬁrst component. Let ∆ ⊂ (P1)n be the union of all the
diagonals, that is

∆ = {(p1, . . . , pn) ∈ (P1)n; ∃i 6= j such that pi = pj}.

Then the map

J : Yd,n → Zd × (P1)n, J = j × (π1 ◦ ev1) × . . . × (π1 ◦ evn)
(3)
is equivariant with respect to the diagonal action of G on (P1)n. Further-
more, it is an isomorphism over Ratd × ((P1)n \ ∆).

Proof. The G-equivariance follows directly from the equivariance of the map
j and the deﬁnition of the G-action on Yd,n. If a closed point (f : C → P1 ×
P1; p1, . . . , pn) ∈ Yd,n maps to ([s], q1, . . . , qn) ∈ Ratd × ((P1)n \ ∆), then all
components of C must map with degrees (1, d) or (0, 0), as s has no vertical
sections. But as also the marked points p1, . . . , pn map to distinct points in
P1 × P1, there can be no contracted components for stability reasons. Hence
C is irreducible and π1 ◦ f : C → P1 is an isomorphism. But then we can
uniquely reconstruct the positions of the markings pi ∈ C from the points

12

JOHANNES SCHMITT

qi = π1(f (pi)) ∈ P1. All in all, this shows that the restriction of J to the
preimage of Ratd × ((P1)n \ ∆) induces a bijection on closed points. Thus it
(cid:3)
is an isomorphism by Proposition B.2.

For an algebraic group H acting on a scheme X, we denote by PicH(X)
the group of H-linearized line bundles on X (c.f. [MFK94, 1.§3]). We want
to obtain an ample G-linearized line bundle M′ on Yd,n allowing us to form
a quotient of Yd,n by G. Additionally, we want the stable and semistable
loci of L′ to coincide and to be given by the preimage of the stable locus of
L in Zd via the map j. For this, we use the following construction adapted
from [MFK94, Proposition 2.18].

Lemma 2.8. Let G = SL2 act on projective varieties Y, Z and let j : Y → Z
be a G-equivariant map. Assume we have L ∈ PicG(Z), M ∈ PicG(Y ) both
ample, G-linearized line bundles and assume Z ss = Z s ((semi-)stability with
respect to L). Then there exists N > 0 such that for all n ≥ N we have
that M′ = M ⊗ (j∗L)⊗n is an ample G-linearized line bundle on Y with
Y ss = Y s = j−1(Z s).

Proof. As M is ample and L is base-point free, it is clear that M′ is ample
and G-linearized. To identify (semi)stable points, we want to use the Hilbert
Mumford numerical criterion (see [MFK94, Theorem 2.1]). We note that for
a given y ∈ Y and a one-parameter subgroup λ in G we have

µM⊗(j∗L)⊗n

(y, λ) = µM(y, λ) + nµL(j(y), λ).

Now by [Muk03, Proposition 7.5], all one-parameter subgroups of SL2 are
conjugate to a multiple of the standard diagonal one-parameter subgroup

T : Gm → SL2, t 7→

t
0
0 t−1

(cid:18)

(cid:19)

For the analysis of stability, we may restrict ourselves to those conjugate to
T or T −1. Note further that as Z ss = Z s, we either have µL(j(y), λ) > 0 if
y ∈ j−1(Z s) or µL(j(y), λ) < 0 otherwise. Thus if we can uniformly bound
µM(y, λ) over all y ∈ Y and λ = T, T −1, we can choose N larger and then
the stability of y is only determined by the stability of j(y) as desired. Note
that here we use µL(z, g−1T g) = µL(gz, T ). But that such a bound exists
(cid:3)
follows immediately from [MFK94, Proposition 2.14].

We now apply this result to the map j constructed in Lemma 2.6.

In

order to achieve Z ss

d = Z s

d, we have to restrict to the case d even.

Corollary 2.9. Let M be any G-linearized ample line bundle on Yd,n, let
N > 0 as in Lemma 2.8 and M′ = M ⊗ (j∗L)⊗N . Then Y ss
d,n is
independent of the choice of M and it admits a uniform geometric quotient
φ : Y s
d,n → M (d, n). Here φ is aﬃne and universally submersive and M (d, n)
is a normal projective variety over C.

d,n = Y s

COMPACTIFICATION OF SELF-MAPS SPACE OF CP1 USING STABLE MAPS

13

Proof. Let M0 be an ample line bundle on the projective, normal variety
Yd,n, then by [MFK94, Corollary 1.6] some power M is G-linearizable. It
d,n = Y s
is clear from Lemma 2.8 that Y ss
d) is independent of the
constructed M′. By [MFK94, Theorem 1.10] we conclude the existence of
the aﬃne, universally submersive uniform geometric quotient φ, reducedness
and normality of M (d, n) follow from [MFK94, 0.§2 (2)] and projectivity
(cid:3)
from the remark above [MFK94, Converse 1.12].

d,n = j−1(Z s

The spaces M (d, n) (and their generalizations M (d|d1, . . . , dn) deﬁned in
the following section) will now be our main object of study. Note that the
G-equivariant map j : Yd,n → Zd descends to a map ˜j : M (d, n) → M s
d .

2.4. Weighted points. In order to analyze the recursive boundary struc-
ture of M (d, n), it will be necessary to generalize the construction above.
We will do so by attributing nonnegative rational weights to the marked
points in M 0,n(P1 × P1, (1, d)). This will not change the action, but it will
aﬀect the set of (semi)stable points and hence the geometric quotient.

Let d, n ≥ 0, k ≥ 1 and ˜d1, . . . , ˜dn ∈ Z≥0 nonnegative integers such that
˜di is positive and odd. We write d∼ = (d, k| ˜d1, . . . , ˜dn).

n
i=1

dS = k(d+1)+
Consider the map
P

J : Yd,n → Zd × (P1)n, J = j × (π1 ◦ ev1) × . . . × (π1 ◦ evn)

deﬁned in Lemma 2.7. On the target

Zd × (P1)n = P(H 0(P1 × P1, (d, 1))) × (P1)n

we have the basepoint free line bundle

Ld∼ = OZ (k) ⊠ O( ˜d1) ⊠ . . . ⊠ O( ˜dn).
We want to apply Lemma 2.8 to obtain an ample linearized line bundle M′
on Yd,n such that a point in Yd,n is (semi)stable iﬀ it maps to a (semi)stable
point in Zd × (P1)n with respect to the line bundle Ld∼ 1. Therefore we need
to analyze (semi)stability for the action of SL2 on Zd × (P1)n with respect
to Ld∼.

Lemma 2.10. A point q = ([s], p1, . . . , pn) ∈ Zd × (P1)n is semistable with
respect to Ld∼ iﬀ for all p ∈ P1 we have

(4)

νp([s]) + δp=ﬁx([s]) +

Xi:pi=p
Here νp([s]) is the order of vanishing of s on the cycle {p}×P1 or equivalently
the multiplicity of a potential vertical section over p. The number δp=ﬁx([s])

˜di
k

≤

d + 1 +
2

˜di
k

i

,

P

1Note in the following that Mumford’s numerical criterion and its consequence Lemma
2.8 were formulated for ample line bundles. Therefore if some of the numbers d or di are
zero, we have to modify the map J to leave out the corresponding factors Zd or P1 in the
target to make the modiﬁed line bundle Ld∼ ample. However, the analysis will not be
aﬀected by this so we will ignore this technicallity henceforth.

14

JOHANNES SCHMITT

is 1 if p is a ﬁxed point of the underlying map ˜ϕ from the horizontal section
of s and 0 otherwise. The point q is stable iﬀ the inequality above is strict
for all p.

Proof. The Lemma follows by applying the Hilbert-Mumford numerical cri-
terion [MFK94, Theorem 2.1]. As in the proof of Lemma 2.2, we can re-
strict to compute µ = µLd∼ (q, λ) for the diagonal one-parameter subgroup
λ ⊂ SL2. From the proof of [Sil98, Proposition 2.2], we see that the line
bundle OZd(k) on the factor Zd contributes a summand
d + 1 − 2ν[1:0]([s]) + 2δ[1:0]=ﬁx([s])
to µ. On the other hand, the line bundle O( ˜di) on the i-th factor P1 con-
tributes ˜di for pi 6= [1 : 0] and − ˜di for pi = [1 : 0]. This can be seen by using
[MFK94, Proposition 2.3]. The conditions µ ≥ 0 for semistability and µ > 0
for stability then translate to the claimed result by rearranging the terms
(cid:3)
and dividing by 2k.

k

(cid:0)

(cid:1)

i

P

We remark that multiplying the inequality (4) by k, the left side is an
˜di odd, the inequality is satisﬁed iﬀ it is satisﬁed
integer. So for k(d+1)+
strictly. Thus semistability is the same as stability. Then we can apply
Lemma 2.8 as described above to obtain an ample linearized line bundle M′
on Yd,n to deﬁne semistability. For brevity in the later text we make the
following deﬁnition.
Deﬁnition 2.11. A tuple d = (d|d1, . . . , dn) ∈ Z≥0 × (Q≥0)n is called ad-
missible if there exists an integer k ≥ 1 such that all numbers ˜di = kdi are
integers and such that k(d + 1) +
i

˜di is odd.

We are now able to deﬁne the space M (d|d1, . . . , dn).

P

Corollary 2.12. Let d = (d|d1, . . . , dn) be admissible, then the set

d,n = Y s,d
Y ss,d

d,n = J −1((Zd × (P1)n)s,Ld∼ )

admits a uniform geometric quotient φ : Y s,d
d,n → M (d|d1, . . . , dn). Here φ is
aﬃne and universally submersive and M (d|d1, . . . , dn) is a normal projective
variety over C.

Proof. This is exactly the same proof as for Corollary 2.9.

(cid:3)

3. Examples and properties
3.1. Examples. In the following we will study some of the spaces M 0,n(P1×
P1, (1, d)) and the corresponding quotient spaces M (d|d1, . . . , dn) in more
detail. For B ⊂ {1, . . . , n} and 0 ≤ k ≤ d with k ≥ 1 or |B| ≥ 2, we denote
by

DB,k = D({1, . . . , n} \ B, (1, d − k)|B, (0, k)) ⊂ Yd,n
the boundary divisor with general point (f : C → P1 × P1; p1, . . . , pn) for C
having two irreducible components C1, C2 carrying the markings {1, . . . , n}\
B and B and mapping with degrees (1, d − k), (0, k), respectively.

COMPACTIFICATION OF SELF-MAPS SPACE OF CP1 USING STABLE MAPS

15

3.1.1. d = 0, n ≤ 2. It is clear that we have an isomorphism

M 0,n(P1 × P1, (1, 0)) ∼= P1 × M 0,n(P1, 1).

For small n the space M 0,n(P1, 1) is easy to describe:

M 0,1(P1, 1) ∼= P1, M 0,2(P1, 1) ∼= (P1)2,

both via the evaluation maps of the markings.

Concerning the spaces M (0|d1, . . . , dn) with n ≤ 2, one checks using
Lemma 2.10 that the only cases with nonempty semistable sets occur for
n = 2 and the semistable set does not depend on the choice of d1, d2. Thus
these nonempty spaces M (0|d1, d2) are all isomorphic to M (0|1, 1).

Lemma 3.1. The space M (0|1, 1) is isomorphic to a single point Spec(C),
without isotropy.

Proof. The semistable points in M 0,2(P1 × P1, (0, 1)) ∼= (P1)3 are exactly
those where the two marked points have diﬀerent ﬁrst coordinates p1, p2 and
both of them are not ﬁxed points of the induced degree 0 morphism, which
is constant equal to q ∈ P1. Under the above ismorphism, this corresponds
exactly to the point (q, p1, p2). Hence

M 0,2(P1 × P1, (0, 1))ss,(1,1) = (P1)3 \ ∆.

As the action of PGL2 on P1 is strictly 3-transitive, the quotient is isomor-
(cid:3)
phic to a single point without isotropy.

3.1.2. d = 1, n = 1. First we note that the only nonempty moduli spaces
M (1|d1) are those with 0 < d1 < 2 and all of them are isomorphic to M (1|1)
(by an analysis of stable loci using Lemma 2.10).

For M 0,1(P1 × P1, (1, 1)) we ﬁrst look at the locus of stable maps with

smooth source curve and ﬁnd

M0,1(P1 × P1, (1, 1)) ∼= PGL2 × P1

by Lemma 2.7. Here PGL2 acts on itself by conjugation and on P1 in the
usual way. There are two boundary divisors on Y1,1, namely D∅,1 and D{1},1.
Then we have the following.

Lemma 3.2. Consider coordinates [X : Y ], [S : T ] on P1 × P1 and the
rational map

ϕ : Z1 = P(H 0(OP1×P1(1, 1)) 99K P1
[aXS + bXT + cY S + dY T ] 7→ [−bc + da : b2 − 2bc + c2].

It is PGL2-invariant and the image of

j : M 0,1(P1 × P1, (1, 1))ss,(1|1) → Z1

16

JOHANNES SCHMITT

lies in the domain of deﬁnition of ϕ. Hence ϕ◦j induces a map ψ : M (1|1) →
P1 and this map is an isomorphism. All points in M (1|1) have trivial PGL2-
stabilizers, except for the point corresponding to the orbit of

f0 =

−1 0
1
0
(cid:21)

(cid:18)(cid:20)

which has a Z/2Z-isotropy given by

, [1 : 1]

= ([z 7→ −z], z = 1) ∈ PGL2 × P1

(cid:19)

0 1
1 0

(cid:20)

(cid:21)

B0 =

= [z 7→ 1/z] ∈ PGL2.

Proof. From the semistability condition in Lemma 2.10 it follows that

M0,1(P1 × P1, (1, 1))ss,(1|1) = PGL2 × P1 \ {([A], p) : Ap = p}

.

=Fix

We will ﬁrst study the conjugation action of PGL2 on itself. Here it is
clear that in each orbit of a given [A] ∈ PGL2 there is a matrix in Jordan
canonical form and by scaling we may pick the representative A′ of this
matrix in PGL2 to have entries α, 1 on the diagonal.

{z

|

}

Now we determine the stabilizer under the conjugation action. If B ∈ GL2
satisﬁes BA′B−1 = λA′ for some λ ∈ C∗ then taking trace and determinant,
we have

α + 1 = tr(A′) = tr(BA′B−1) = tr(λA′) = λ(α + 1),
α = det(BA′B−1) = det(λA′) = λ2α.

Thus λ = ±1 and λ = 1 for α 6= −1.

We ﬁrst look for the solutions B of BA′ = A′B, so the equation for λ = 1.

If A is diagonalizable, the matrix A′ has the form

A′ =

α 0
0 1

.

a b
c d

(cid:18)
Note that for α = 1, the induced map [A] ∈ PGL2 is the identity. Therefore
all points are ﬁxed and thus this case does not occur in the semistable set
with BA′ = A′B. Spelling this

above. Excluding this case let B =

(cid:19)

(cid:19)

(cid:18)
out means exactly αb = b, αc = c. So as α 6= 1, we have b = c = 0, so B is
a diagonal matrix. Note that the diagonal matrices in PGL2 are isomorphic
to C∗. But now we also want to take into account the additional marked
point above. The complement of the ﬁxed points of A′ are the points p in
P1 \ {[0 : 1], [1 : 0]}. This eliminates the remaining stabilizing elements in
C∗, for instance moving the marked point to [1 : 1].

On the other hand, for α = −1 we have to check the case BA′ = −A′B.
This amounts to −a = a, −d = d. Thus in this case the stabilizer of [A′]
also contains antidiagonal matrices. As above, we can use the C∗-part of
the stabilizer to move the marking to [1 : 1]. Of the antidiagonal matrices,

exactly the class of the element B0 =

0 1
1 0

(cid:18)

(cid:19)

ﬁxes the marked point [1 : 1].

COMPACTIFICATION OF SELF-MAPS SPACE OF CP1 USING STABLE MAPS

17

This gives precisely the stabilizer of the point f0 above.
Finally there is the case where A is not diagonalizable. Necessarily its eigen-
values have to coincide, amounting to α = 1 (and thus λ = 1) above, and
the matrix A′ has the form

(cid:18)
The equation BA′ = A′B gives c = 0, a = d, so the stabilizer consists of

(cid:19)

A′ =

1 1
0 1

.

a b
0 a

(cid:18)

(cid:19)

matrices B =

. By scaling the diagonal to a = 1, we see that this is

exactly isomorphic to C. But now the only ﬁxed point of A′ is [1 : 0], so we
see that the marked point p ∈ C = P1 \ {[1 : 0]} eliminates the remaining
stabilizer.

We also have to analyze the boundary. Note that by Lemma 2.10, the
entire divisor D{1},1 is unstable. On the other hand we know from [FP97]
that there is a bijective gluing morphism

M 0,2(P1 × P1, (1, 0)) ×P1×P1 M 0,1(P1 × P1, (0, 1))

→ D∅,1.

=P1×P1

We see that the left side is actually isomorphic to M 0,2(P1 × P1, (1, 0)).
|
One checks that the preimage of the (semi)stable locus Dss,(1|1)
is precisely
M 0,2(P1 × P1, (1, 0))ss,(0|1,1). As seen in the proof of Lemma 3.1 this is
exactly the variety PGL2 and the corresponding action is given by left-
multiplication. Hence the boundary divisor D∅,1 in M (1|1) is isomorphic to
a point (without stabilizer).

{z

∅,1

}

Now we are ready to prove that the map ψ is bijective on closed points.
An element of the boundary divisor D∅,1 corresponds to a horizontal section
[e : f ] × P1 and a vertical section P1 × [g : h] with [e : f ] 6= [g : h]. Under j
it maps to sections of the form
(Xf −Y e)(Sh−T g) = f hXS−f gXT −ehY S+egY T ∈ H 0(P1×P1, O(1, 1)).

Thus the image under ψ is

[−(−f g)(−eh) + (eg)(f h) : (f g)2 − 2(−f g)(−eh) + (eh)2]

=[0 : (f g − eh)2] = [0 : 1],

where we use f g − eh 6= 0 as [e : f ] 6= [g : h].

On the other hand we look at (PGL2 × P1) \ Fix. Note that [A] =

[(ai,j)2

i,j=1] ∈ PGL2 corresponds to the map
P1 → P1 × P1, [x : y] 7→ ([x : y], [a1,1x + a1,2y : a2,1x + a2,2y]).

Under j the point ([A], p) maps to [S(a2,1X + a2,2Y ) − T (a1,1X + a1,2Y )].
Hence our proposed map ψ here simply takes the form
ψ([A], p) = [a1,1a2,2 − a2,1a1,2 : a2

2,2] = [det(A) : tr(A)2].

1,1 + 2a1,1a2,2 + a2

18

JOHANNES SCHMITT

Note that this map is independent of the choice of representative A in the
class [A] ∈ PGL2 and also invariant under the conjugation action. Because j
is dominant and PGL2-equivariant, we also obtain that ϕ is PGL2 invariant.
We know det(A) 6= 0 and by scaling we may reach det(A) = 1. The
scaling constant is unique up to a sign. On the other hand if we know
ψ([A], p) then tr(A) is determined up to a sign, giving us the eigenvalues of
A up to a common factor ±1. But this speciﬁes the Jordan canonical form
(as the identity matrix is excluded). Thus ψ in injective on closed points.
On the other hand one sees quickly that every point [1 : t] is in the image of
ψ. Thus by Proposition B.2, the space M (1|1) is isomorphic to P1 via the
(cid:3)
map ψ.

3.1.3. d = 2, n = 0.

Lemma 3.3. For d = 2, n = 0 the map j : Yd,n → Zd is an isomorphism
over Z s
2 is also an isomorphism. Hence,
the space M (2, 0) is isomorphic to P2.

d and thus the map ˜j : M (2, 0) → M s

d,n → Z s

Proof. We will show that the map j : Y s
d is bijective on closed points
and then apply Proposition B.2. We already know that over Ratd ⊂ Z s
d, this
morphism is an isomorphism, hence bijective, by Lemma 2.7. By Lemma
2.2 all remaining points in Z s
d \ Ratd are classes [s] of sections s ∈ H 0(P1 ×
P1, (d, 1)) corresponding to graphs Γ = V (s) ⊂ P1 × P1 with one or two
vertical sections vi over pi ∈ P1 of multiplicity exactly 1 such that pi is
not a ﬁxed point of the induced map ˜ϕ : P1 → P1 of degree 1 or 0. But
one sees easily that the inclusion Γ ֒→ P1 × P1 is a stable map of genus 0
d,n → Z s
curves corresponding to a point in Y s
d
is surjective. On the other hand if f : C → P1 × P1 is a stable map such
that j(f ) = [s], one sees that it deﬁnes an isomorphism C → Γ. Thus up
to isomorphism of stable maps, the inclusion C = Γ ֒→ P1 × P1 is the only
(cid:3)
curve in the preimage of [s], which shows injectivity.

d,n mapping to [s]. Thus j : Y s

3.2. Isotropy and Singularities. In this section we ﬁrst show that the
spaces M (d|d1, . . . , dn) we constructed have nice singularities. This will
be important for analyzing their Picard group. In the following, let d =
(d|d1, . . . , dn) be admissible.

Lemma 3.4. Let d ≥ 0, n ≥ 0 with (d, n) 6= (0, 0), (0, 1), (1, 0). Then for the
action of ˜G = PGL2 let Ad,n ⊂ M 0,n(P1 × P1, (1, d)) be the locus of points
where ˜G acts with nontrivial stabilizer. Then Ad,n is of codimension at least
1 for all d, n as above. Even more, for d ≥ 1 and (d, n) 6= (1, 1), (2, 0) the
set Ad,n is of codimension at least 2 and for d = 0 we have that

Ad,n \ D{1,...,n},0 ⊂ M 0,n(P1 × P1, (1, d)) \ D{1,...,n},0

is of codimension at least 2.

COMPACTIFICATION OF SELF-MAPS SPACE OF CP1 USING STABLE MAPS

19

Proof. Given a ﬁxed d, our proof will basically be an induction on n. For
this, consider the forgetful map

F : M 0,n+1(P1 × P1, (1, d)) → M 0,n(P1 × P1, (1, d)).
The ﬁbre over a closed point point [(f : C → P1 × P1; p1, . . . , pn)] is exactly
isomorphic to C/Aut(C), corresponding to the possibilites to add another
marked point, possibly having to add additional components to C after-
wards. It is clear that F (Ad,n+1) ⊂ Ad,n. By standard theorems on ﬁbre
dimensions this shows that

codim(Ad,n+1) ≤ codim(Ad,n)

with a strict inequality if for some (d, n) only a ﬁnite number of points in
the ﬁbre over a general point [(f : C → P1 × P1; p1, . . . , pn)] ∈ Ad,n have a
PGL2-isotropy.

Using this we see that for d ≥ 1 it suﬃces to prove the assertions above if

(d, n) = (1, 1), (1, 2), (2, 0), (2, 1), (3, 0), (4, 0) . . . .

Our analysis of Ad,n will be split in analyzing the interior of the moduli
space M 0,n+1(P1 × P1, (1, d)) and its boundary. By [FP97, Lemma 12] the
boundary divisor DB,k admits a surjective, birational map from
(5) M 0,n−|B|+1(P1 × P1, (1, d − k)) ×P1×P1 M 0,|B|+1(P1 × P1, (0, k)),
which amounts to gluing two curves and maps at a single point. One sees
easily that this gluing map is PGL2-equivariant with respect to the natural
actions. Note that DB,k is irreducible by [KP01, Corollary 2] and already
has codimension 1. Thus in order to show that the boundary part of Ad,n
has codimension at least 2, we only have to show that a general point in
DB,k has trivial stabilizer. But this immediately follows if we know that a
general point of M 0,n−|B|+1(P1 × P1, (d − k, 1)) has trivial stabilizer. For
almost all B, k this will be implied by our inductive argument below, where
we ﬁrst induce over d and then for ﬁxed d over n. The only exceptional case
is B = {1, . . . , n} and k = d. Here we have

DB,k

∼= M 0,1(P1 × P1, (1, 0)) ×P1×P1 M 0,n+1(P1 × P1, (0, d))
∼= (P1 × P1) ×P1×P1 (P1 × M 0,n+1(P1, d))
∼= P1 × M 0,n+1(P1, d).

Under these identiﬁcations, PGL2 acts on the ﬁrst factor in the usual way
and on the second factor by postcomposition. By another inductive argu-
ment using a forgetful morphism, it is enough to consider the case n = 0. We
claim that for d ≥ 2, a general point of the space above has trivial stabilizer.
Indeed let (q, [ϕ : P1 → P1; p]) be a general element of P1 × M0,n+1(P1, d).
Then we may assume that q 6= ϕ(p) and we can use our PGL2 action to
move those points to [0 : 1], [1 : 0], respectively. Now assume ψ ∈ PGL2
ﬁxes [0 : 1], [1 : 0] and satisﬁes [ψ ◦ ϕ] = [ϕ] ∈ M0,0(P1, d). In other words,
there exists B ∈ Aut(P1) such that ψ ◦ ϕ = ϕ ◦ B. Then B must ﬁx the

20

JOHANNES SCHMITT

preimages ϕ−1([0 : 1]) and ϕ−1([1 : 0]). As ϕ was supposed to be general,
these are two sets of d points, all distinct. For d ≥ 2 one sees that this
implies B = id so ψ = id as desired.

To conclude, we will now show the claimed results in the order

(d, n) = (0, 2), (0, 3), (0, 4), . . . ; (1, 1), (1, 2), (2, 0), (2, 1), (3, 0), (4, 0), . . .

where for d ≥ 2 we only have to consider the points of Ad,n in the interior
M0,n(P1 × P1, (1, d)) of Yd,n.
d = 0 and n ≥ 2
It is clear that

M0,n(P1 × P1, (1, 0)) ∼= P1 × ((P1)n \ ∆)

where PGL2 acts in the usual way on each component. Hence for n ≥ 2, a
general point of this space has trivial stabilizer. For n ≥ 3 we even have that
no point in this open locus has any stabilizer, so it remains to consider the
boundary components. For a proper subset B ( {1, . . . , n} with |B| ≥ 2, a
general element of DB,0 will consist of a horizontal inclusion P1 → P1 × {q}
with at least one marking from {1, . . . , n} \ B mapping to the point (p, q)
and a component of the source curve containing the marks B contracted to
a point (p′, q). For q, p, p′ pairwise distinct this element has trivial stabilizer
as desired.
d = 1 and n = 1

This case was analyzed in great detail in Lemma 3.2, where in particular
it is shown that a general point of M0,1(P1 × P1, (1, 1)) has trivial stabilizer.
d = 1 and n = 2

Here we will look at the ﬁbres of the forgetful map

F : M 0,2(P1 × P1, (1, 1)) → M 0,1(P1 × P1, (1, 1)).
On M0,1(P1 × P1, (1, 1)) = PGL2 × P1 we have seen that away from the locus
Fix ⊂ PGL2 × P1, the only orbit with nontrivial stabilizer is the orbit of
f0 = [(z 7→ −z, 1)], which has ﬁnite stabilizer. Therefore all but ﬁnitely
many points in the ﬁbre P1/Aut(f0) are not ﬁxed points of this stabilizer as
desired.

In the closed subset Fix there are two types of elements: ﬁrstly we have
([A], p) with [A] 6= [id] and p one of the ﬁnitely many ﬁxed point of A. Here
as above we see that adding an additional marked point in a suﬃciently
general position (i.e. diﬀerent from the ﬁxed points) removes the remaining
stabilizer. The other remaining case are the points ([id, p]) with p ∈ P1
arbitrary. But this locus is already itself of codimension 3 so its preimage
under F also has codimension 3.

In Lemma 3.2 we have already seen that a general point on the boundary
divisor D∅,1 has no isotropy and similarly it is easy to see the same for
D{1},1. Hence A1,1 intersected the boundary of M 0,1(P1 × P1, (1, 1)) has
codimension at least 2.
d ≥ 2 and n = 0

COMPACTIFICATION OF SELF-MAPS SPACE OF CP1 USING STABLE MAPS

21

By our preparations, we need to show that Ad,n ∩ M0,n(P1 × P1, (1, d)) has
codimension at least 1 for d = 2 and at least 2 for d ≥ 3. But by [MSW14,
Corollary 4] Ad,0 has codimension d − 1 in M0,n(P1 × P1, (1, d)). Here we
use that j is an isomorphism over Ratd by Lemma 2.6.
d = 2 and n = 1

All points in M0,0(P1 × P1, (1, 2)) ∼= Rat2 have ﬁnite PGL2-isotropy by
[Sil07, Proposition 4.65]. Hence as above we only have ﬁnitely many points
(cid:3)
in each ﬁbre of F with nontrivial isotropy. This ﬁnishes the proof.
Corollary 3.5. Let d = (d|d1, . . . , dn) be admissible. Then ˜G = PGL2
acts on Y ss,d
d,n with ﬁnite stabilizers at geometric points and for (d, n) 6=
(2, 0), (1, 1), the action is free on an invariant open set with complement of
codimension at least 2.

Proof. By [MFK94, 1.§4 (1)] the function y 7→ dim(Stab(y)) is locally con-
stant on Yd,n. But note that Yd,n is connected (see [KP01, Corollary 1]).
Hence for showing that the action has ﬁnite stabilizers on the semistable
set, it suﬃces to ﬁnd any semistable point with ﬁnite stabilizer. One sees
quickly that for all d as above such that there are semistable points at all,
the locus Y ss,d
d,n \Ad,n, where ˜G acts freely, is nonempty by Lemma 3.4. Thus
every geometric point has ﬁnite stabilizer.

Moreover, Lemma 3.4 immediately implies that Ad,n ∩ Y ss,d

is of codi-
mension at least 2 for (d, n) 6= (2, 0), (1, 1) and d ≥ 1. Finally for d = 0 we
see that D{1,...,n},0 is always disjoint from the locus of semistable points by
(cid:3)
Lemma 2.10, so again we can apply Lemma 3.4.

d,n

Denote by

Yd,n = M0,n(P1 × P1, (1, d))
the moduli stack of stable maps to P1 × P1 with coarse moduli space Yd,n →
Yd,n. Let Y ss,d

d,n be the preimage of the locus of semistable points Y ss,d
d,n .

Lemma 3.6. The space M (d|d1, . . . , dn) is the coarse moduli space of the
smooth Deligne-Mumford stack

M(d|d1, . . . , dn) = Y ss,d

d,n /PGL2.

d,n = Y s,d

In particular, it has ﬁnite quotient singularities.
Proof. As M (d|d1, . . . , dn) is a GIT quotient of Y ss,d
d,n is
a coarse moduli space for Y ss,d
d,n , we obtain that M (d|d1, . . . , dn) is a coarse
moduli space for the quotient stack Y ss,d
d,n /PGL2 by Lemma C.4 and Remark
C.5. To show that M(d|d1, . . . , dn) is a smooth Deligne-Mumford stack, we
want to apply Proposition C.3. The fact that Yd,n is an orbifold is proved
in [FP97] and [KP01]. The action of PGL2 on Y ss,d
d,n has ﬁnite stabilizers by
Corollary 3.5. Thus, the conditions of Proposition C.3 are veriﬁed and the
proof of the ﬁrst part is ﬁnished. Finally, M (d|d1, . . . , dn) has ﬁnite quotient

d,n and as Y ss,d

22

JOHANNES SCHMITT

singularities as it is normal and the coarse moduli space of a smooth Deligne-
(cid:3)
Mumford stack (see [Vis89, Proposition 2.8]).

Corollary 3.7. Every Weil divisor on M (d|d1, . . . , dn) is Q-Cartier.

Proof. This follows as M (d|d1, . . . , dn) has at most ﬁnite quotient singular-
(cid:3)
ities (see [KM98, Proposition 5.15]).

3.3. Modular interpretations. Let still d = (d|d1, . . . , dn) be admissible.
We want to ﬁnd a way to interpret the quotient M (d|d1, . . . , dn) as a moduli
space for a functor of stable self-maps, in a sense yet to be deﬁned. Our
strategy is as follows: ﬁrst we identify the stack Yd,n/PGL2 with an explicit
category ﬁbred in groupoids.
Its objects over a scheme S are a natural
generalization of families with ﬁbres P1 together with n markings and a
degree d self-map of the family. We can identify M(d|d1, . . . , dn) as an open
substack deﬁned by requiring that the self-maps satisfy a stability condition.
By passing from this stack to its coarse moduli space M (d|d1, . . . , dn), we
obtain the functor from schemes to sets, which associates to S the set of
isomorphism classes of families in M(d|d1, . . . , dn)(S). Finally, we see that
over the locus M ∗ of points [p] ∈ M (d|d1, . . . , dn) without PGL2-isotropy or
automorphisms (of p ∈ Yd,n), we have a universal family of curves with a
self-map (in the category of schemes). Let Md,n be the category ﬁbred in
groupoids over SchC, whose objects over a scheme S are diagrams

C

µ

ϕ

˜C

π

σi

˜π

S

(6)

where

• π, ˜π are ﬂat, projective families of quasi-stable genus 0 curves, all

geometric ﬁbres of ˜π are isomorphic to P1

• µ, ϕ satisfy µ∗([Cs]) = [ ˜Cs] and ϕ∗([Cs]) = d[ ˜Cs] for all geometric

points s ∈ S

• every component of a geometric ﬁbre Cs, which is contracted by both
µs, ϕs contains at least three special points (nodes or markings)

The morphisms between F ∈ Md,n(S) and F ′ ∈ Md,n(S′) lying over a mor-
phism ψ : S → S′ of schemes are exactly the pullback-diagrams identifying
F as the base change of the diagram F ′ by ψ.

Theorem 3.8. There is a natural isomorphism between the quotient stack
Yd,n/PGL2 and Md,n. Here, an element of (Yd,n/PGL2) (S) coming from a
family

(π : C → S; σ1, . . . , σn : S → C; (f1, f2) : C → P1 × P1) ∈ Yd,n(S)

COMPACTIFICATION OF SELF-MAPS SPACE OF CP1 USING STABLE MAPS

23

is identiﬁed with the diagram

C

π × f1

π × f2

S × P1

π

σi

S

in Md,n(S).

Proof. We give a natural identiﬁcation of the objects of Yd,n/PGL2 and
Md,n over a scheme S, which respects isomorphisms of these objects. Let
G = PGL2 for the remainder of the proof.

Using [Rom05, Theorem 4.1], we know that an object of Yd,n/PGL2 over
S is nothing but a G-torsor ψ : T → S over S together with a morphism
(f, σ) : T → Yd,n of G-stacks. Note that as G is quasi-aﬃne, the torsor T is
actually a scheme (not an algebraic space), see [sga71, VII, Corollaire 7.9].
The map f : T → Yd,n is just a usual (1)-morphism, so it is equivalent to
specifying the data

(f1, f2)

C

P1 × P1

π

si

(7)
of a family of stable maps to P1 × P1 with degree (1, d) and n markings. The
2-morphism σ relates the two paths in the commutative diagram

T

G × T

idG×ψ
−−−−→ G × Yd,n

µT

µY

,



T
y

ψ



−−−−→ Yd,n
y

where the two vertical arrows are the corresponding actions. Now the mor-
phism ψ ◦ µT corresponds to the data of the family

(µ∗

T π : µ∗

T C → G × T ; µ∗

T si : G × T → µ∗

T C; (f1, f2) : µ∗

T C → P1 × P1)

of stable maps. On the other hand µY ◦ (idG × ψ) corresponds to the data

(idG×π : G×C → G×T ; idG×si : G×T → G×C; (g, c) 7→ (g.f1(c), g.f2(c))).

Giving a 2-morphism σ between ψ ◦ µT and µY ◦ (idG × ψ) is thus equivalent
to an isomorphism between these two families. One sees that the necessary
data is a morphism

η : G × C → C

24

JOHANNES SCHMITT

making the diagram

G × C

η

−−−−→ C

(8)

idG×π

π
µT−−−−→ T


y


G × T

y

cartesian. Moreover, the map η should be compatible with the sections si
and the maps to P1 × P1.

Now for (f, σ) to be a 1-morphism of G-stacks, the map σ needs to satisfy
a compatibility condition. For any scheme Z and g, h ∈ G(Z), x ∈ T (Z) let

σx
g : g.ψ(x) → ψ(g.x)
be the isomorphism of families of stable maps over Z given by σ. Then we
require

σh.x
g

◦ (g.σx

h) = σx
gh.

Unwinding the deﬁnitions, one sees that this is exactly equivalent to the
map η satisfying η(g, η(h, x)) = η(gh, x). As the diagram (8) is cartesian,
we know that the identity element of G acts by an isomorphism. Hence, the
compatibility condition exactly requires η to be a group action. Before we
summarize, we note that assuming η is a group action, the diagramm (8) is
automatically cartesian if it is commutative.

We have seen above that an object of Yd,n/PGL2 over S is equivalent to
a G-torsor ψ : T → S, a family (7) of stable maps and an action of G on C
making all the arrows in the diagram (7) G-equivariant. We now rearrange
this data slightly as the following diagram

T × P1

C

π × f1

π × f2

π

si

˜π

T

(9)

and then take the quotient by G at every point of the diagram. As all G-
actions are free, the quotients are again algebraic spaces. Also, as T is a
G-torsor over S, we have T /G = S. Thus the quotient diagram looks like

C′

g1
g2

˜C

π′

s′
i

˜π′

S

(10)

and all maps between the quotients keep their respective fppf-local proper-
ties (ﬂat, proper, ﬁnite type, etc.) because of Remark C.2. To prove that

COMPACTIFICATION OF SELF-MAPS SPACE OF CP1 USING STABLE MAPS

25

π′, ˜π′ are still projective, we will construct G-linearized relatively ample line
bundles on C, T × P1 and then use a descent argument. The ingredients for
these line bundles are the following:

• The relative dualizing sheaf ωπ′ carries a natural G-action (this fol-
lows easily from the compatibility of the formation of relative dual-
izing sheaves with base change).

• The line bundle OP1(2) has a natural G-linearization and hence its
pullbacks via f1, f2 and via the projection T × P1 7→ P1 have induced
G-linearizations.

• On C we also want to have line bundles corresponding to the Weyl
divisors si(T ). To assure that they carry a G-linearization, we will
make a detour via the quotient C′ = C/G, because PicG(C) = Pic(C′).
i : S → C′ is a section of the ﬁnite type, ﬂat,
Now we have that s′
If we knew that C′ was a scheme, then
separated morphism π′.
Proposition B.3 would imply that s′
i is a Cartier divisor, hence it
would give rise to our desired G-linearized line bundle O(si) on C.
However, being a Cartier divisor can be checked fpqc-locally. This is
because a Cartier divisor is the same as a Koszul-regular immersion
of codimension 1 (see [Sta14, Tag 061T ] for a deﬁnition) and this
notion is fpqc-local on the target (see [Sta14, Tag 0694 ]). But to
check this, we again pull back via the map C → C′ and now Propo-
sition B.3 really shows that si, which are the pullbacks of the maps
s′
i, are Cartier divisors.

2 O(m) is π-ample for l, m suﬃciently large.

Clearly OP1(2) is ˜π-relatively ample on T × P1. On the other hand, as the
family π : C → T was supposed to be stable, the bundle ωπ(s1 + . . . + sn) ⊗
1 O(l) ⊗ f ∗
f ∗
But then by [sga71, VIII,Proposition 7.8], the spaces C′, ˜C are actually
schemes and the line bundles above descend to relatively ample line bundles
on them for the morphisms π′, ˜π′ . As these morphisms are also ﬁnite type
and proper, they are projective.

Note further that the geometric ﬁbres of ˜π′ are isomorphic to P1. Hence
we have obtained a family in Md,n(S). Conversely, for such a family as
above, we can consider the morphism

ψ : T = IsomS( ˜C, S × P1) → S.
Here for schemes X, Y over S, the scheme IsomS(X, Y ) represents the func-
tor

SchS → Sets, S′ 7→ {ψ : XS′ → YS′ : ψs isomorphism ∀s ∈ S′}.
The existence of this scheme follows from the fact that π′, ˜π′ are proper and
that π′ is ﬂat. We want to show that ψ is a G-torsor. It clearly has a G-
action by postcomposition. On the other hand, the map ˜π′ is smooth. Thus
it has sections ´etale locally and hence is a trivial P1-bundle after an ´etale
base change S′ → S. But then the pullback of T to S′ is simply S′ × PGL2,
a trivial G-torsor.

26

JOHANNES SCHMITT

Now after pulling back the diagram (10) above by the map ψ, we can
clearly trivialize the P1-bundle ψ∗ ˜C.
Indeed, by deﬁnition the scheme T
parametrizes all possible ways to perform this trivialization ﬁbrewise. Now
we have again a diagram as in (9) and the action of G on T lifts to an action
of the other spaces under the pullback T → S. This is not canonical, but it
exactly mirrors the choice we had when translating from the 2-morphism σ
above to an action map η : G × C → C.

One veriﬁes that the two operations we described are inverse to one-
another and one checks, that they respect the isomorphisms inherent in the
objects of Yd,n/PGL2 and Md,n over S. Here one uses that starting with a
diagram (9), the G-torsors T and IsomS( ˜C, S × P1) over S are isomorphic.
This is because there exists a G-equivariant map T → IsomS( ˜C, S × P1) by
the universal property of IsomS( ˜C, S × P1).

The explicit description of the image of a family in Yd,n/PGL2 coming
from a family in Yd,n is obvious from the above construction. Hence, the
(cid:3)
proof is ﬁnished.
Corollary 3.9. For d = (d|d1, . . . , dn) admissible, we have that the scheme
M (d|d1, . . . , dn) is a coarse moduli space for the functor SchC → Sets, as-
sociating to a scheme S the set of isomorphism classes of diagrams (6) in
Md,n such that for all s ∈ S the map

(Cs; σ1(s), . . . , σn(s)) → ˜Cs × ˜Cs

is semistable with respect to d as in Lemma 2.10.
Proof. The substack Y ss,d
d,n ⊂ Yd,n is open and G-invariant. By Lemma C.4,
the coarse moduli space of its quotient Y ss,d
d,n /G is exactly M (d|d1, . . . , dn).
On the other hand, Theorem 3.8 identiﬁes this quotient with the open sub-
stack of Md,n whose objects are exactly those described above. But then the
functor sending S to the set of isomorphism classes of such objects naturally
(cid:3)
has M (d|d1, . . . , dn) as a coarse moduli space.
Remark 3.10. If in the diagram (6), the ﬁbres Cs of C are smooth, the map
µ is an isomorphism and thus C ∼= ˜C. Thus in this case, the scheme S really
parametrizes a family of self-maps Cs → Cs of degree d. Thus the locus
M (d|d1, . . . , dn)o of classes of maps with smooth source curve is a coarse
moduli space for the functor

SchC → Sets

C

φ

π

σi

:

S

π ﬂat, projective family of
smooth genus 0 curves,
σ1, . . . , σn disjoint sections of π
φ self-map over S with
φ∗[Cs] = d[Cs] for all s ∈ S

S 7→






/iso.






Here, an isomorphism of families as above is an isomorphism C1 → C2 making
all diagrams commute.

COMPACTIFICATION OF SELF-MAPS SPACE OF CP1 USING STABLE MAPS

27

Note that if some of the di are greater than (d − 1 +

n
j=1 di)/2, we need

to require above that σi(s) is not a ﬁxed point of φ2 for all s ∈ S.

P

Remark 3.11. The forgetful map F : Yd,n+1 → Yd,n of the last marked
point is G-equivariant and the preimage of Y ss,d
, with (d, 0) =
d,n
(d|d1, . . . , dn, 0). Thus F induces a map

is Y ss,(d,0)

d,n+1

F : M (d|d1, . . . , dn, 0) → M (d|d1, . . . , dn).

Similarly one constructs sections

σi : M (d|d1, . . . , dn) → M (d|d1, . . . , dn, 0)
of F . We note that over the locus M ∗ of points [f ] ∈ M (d|d1, . . . , dn)
with trivial G-isotropy and such that f ∈ Yd,n has no automorphisms, the
family F and the sections σi are exactly the universal family π : C|M ∗ → M ∗
from above. This follows because by [FP97], the locus Y ∗
d,n of points without
automorphisms in Yd,n carries the restriction of the forgetful map from Yd,n+1
as a universal family. On the other hand, the geometric quotient of a scheme
by a free action is isomorphic to the corresponding quotient stack.

3.4. Rationality. In this section, we show that the spaces M (d|d1, . . . , dn)
are rational. First note that for diﬀerent weights d1, . . . , dn, all (nonempty)
spaces M (d|d1, . . . , dn) are canonically birational. Indeed, they are categor-
ical quotients for varying open, invariant subsets of Yd,n, hence they are iso-
morphic over the image of the intersection of those subsets. Thus, given d, n
we can choose the weights arbitarily without changing the birational class
of M (d|d1, . . . , dn). This also shows that they are birational to a categorical
quotient of some nonempty, G = PGL2-invariant subset of Ratd ×((P1)n \∆)
by G, if this quotient exists.

Theorem 3.12. The spaces M (d|d1, . . . , dn) are rational.

Proof. Our argument will basically be an induction on n for every ﬁxed
d ≥ 0. In the case n = 0, Levy shows that Ratd//G is rational for d ≥ 2 (see
[Lev11, Theorem 4.1]).

For n = 1 we must now also cover the case d = 1, but then we have seen
that all nonempty moduli spaces M (1|d1) are isomorphic to M (1|1) ∼= P1,
which is rational.

For d ≥ 2 consider the open subset

U = {(f, p) : p 6= f (p) 6= f (f (p)) 6= p} ⊂ Ratd × P1.
By the deﬁnition of the action of G, this subset is invariant. But on U we
can use the action of G to move p to 0 = [0 : 1], f (p) to ∞ = [1 : 0] and
f (f (p)) to 1 = [1 : 1] in a unique way. More precisely, let

U0 = {(f, 0) : f (0) = ∞, f (∞) = 1} ⊂ U .
Then the action map restricted to G × U0 is an isomorphism onto U . Thus
U //G = U0. But the conditions f (0) = ∞, f (∞) = 1 give linear conditions
on the coeﬃcients of f ∈ Ratd ⊂ P2d+1 and hence U0 is rational.

28

JOHANNES SCHMITT

Finally, for n ≥ 2 we note that the case d = 0, n = 2 is clear, as the
only nonempty moduli spaces here are isomorphic to M (0|1, 1) (which is a
point by Lemma 3.1). By the discussion preceding the Theorem, we may
restrict to the cases M = M (0|1, 1, 0, . . . , 0), M = M (d|0, . . . , 0) for d even
and M = M (d|1, 0, . . . , 0) for d odd. But by the forgetful map F : M →
˜M of the last marked point (which carries weight 0), these spaces map to
the corresponding spaces ˜M with one mark less. These are rational by
induction. Using Remark 3.11, the forgetful maps are ﬂat, projective P1-
ﬁbrations over the locus in ˜M parametrizing self-maps of smooth curves
without isotropy or automorphisms. Moreover, as n ≥ 2, the map F has a
section σ1 (whose image is the divisor D{1,n},0). But any ﬂat P1-ﬁbration
with a section is actually locally trivial (see [Har10, Proposition 25.3]), so
(cid:3)
indeed M is rational.

4. The Picard group of M (d|d1, . . . , dn)
Lemma 4.1. Let ˜G = PGL2 act freely on a normal variety X and let
φ : X → X ′ be a geometric quotient. Then the map

φ∗ : Pic(X ′) ⊗Z Q → Pic(X) ⊗Z Q

is an isomorphism.

Proof. The map φ∗ factors as the composition

Pic(X ′) ⊗Z Q → Pic

˜G(X) ⊗Z Q → Pic(X) ⊗Z Q

By [MFK94, 1.§3] the ﬁrst map is an isomorphism (even before tensoring
with Q). By [Dol03, Thereom 7.1, Exercise 7.2] the second map is injective
(using that PGL2 has only trivial characters as the same is true for SL2).
(cid:3)
Finally [Dol03, Corollary 7.2] implies that the right map is surjective.

Corollary 4.2. Let d = (d|d1, . . . , dn) be admissible with (d, n) 6= (2, 0),
(1, 1). Then the quotient map

φ : Y ss,d

d,n → M (d|d1, . . . , dn)

induces an isomorphism

φ∗ : Pic(M (d|d1, . . . , dn)) ⊗Z Q → Pic(Y ss,d

d,n ) ⊗Z Q

and we have Pic(Y ss,d

d,n ) ⊗Z Q ∼= Cl(Y ss,d

d,n ) ⊗Z Q.

Proof. By Corollary 3.5 we know that there is an open, ˜G-invariant subset
Y f ⊂ Y ss,d
d,n with complement of codimension at least 2, on which ˜G acts
freely. Let M f ⊂ M (d|d1, . . . , dn) be the image of Y f under φ. Then as
φ is a geometric quotient, this set is open with Y f = φ−1(M f ). But this
implies that M f has complement of codimension at least 2, too. As Yd,n and
M (d, n) only have ﬁnite quotient singularities, their corresponding rational

COMPACTIFICATION OF SELF-MAPS SPACE OF CP1 USING STABLE MAPS

29

Class groups and Picard groups coincide, and using that the Class group
does not change when removing sets of codimension at least 2 we obtain
d,n ) ⊗ Q ∼= Cl(Y f ) ⊗ Q ∼= Pic(Y f ) ⊗ Q

d,n ) ⊗ Q ∼= Cl(Y ss,d

Pic(Y ss,d

Pic(M (d|d1, . . . , dn)) ⊗ Q ∼= Cl(M (d|d1, . . . , dn)) ⊗ Q ∼= Cl(M f ) ⊗ Q
∼= Pic(M f ) ⊗ Q.

Note further that the restricted map φ : Y f → M f is not only a geometric
quotient for the action of G = SL2, but also for the induced action of ˜G on
(cid:3)
Y f . Using Lemma 4.1 we conclude the desired statement.

We see that we can reduce the computation of Pic(M (d|d1, . . . , dn)) ⊗ Q
d,n ) ⊗ Q. As Y ss,d
to the computation of Cl(Y ss,d
d,n ⊂ Yd,n is an open set whose
complement is a union of divisors, we will ﬁrst compute generators and
relations for the whole group Cl(M 0,n(P1 × P1, (1, d))) ⊗ Q and then obtain
the desired group as a quotient by the classes coming from the unstable loci.

4.1. The Picard group of M 0,n(P1 × P1, (1, d)). We will use methods
adapted from [Pan99] to compute the Picard group of Yd,n = M 0,n(P1 ×
P1, (1, d)). First we ﬁnd a set of divisors generating the group. Then we
construct test curves, which we intersect with those divisors. As the in-
tersection numbers only depend on the class of the divisors in the Picard
group, we will be able to show linear independence for some subsets of our
generators by comparing intersection numbers. We mention that in [Opr05],
Oprea has computed a system of generators for the rational Picard group of
M 0,n(X, β) for X = G/P a projective homogeneous space, which of course
also covers X = P1 × P1.

(11)

d,n = M0,n(P1 × P1, (1, d)) ⊂ Yd,n
d,n =

4.1.1. Generators. Consider the open set Y o
corresponding to maps with a smooth domain and its complement Y ∂
Yd,n \ Y o
d,n, the boundary of Yd,n. Then we have an exact sequence
d,n → A2d+nYd,n → A2d+nY o
of groups of algebraic (2d+n)-cycles modulo rational equivalence (see [Ful98,
Proposition 1.8]). We note that as dim(Yd,n) = dim(Y o
d,n) = 2d + 1 + n, we
d,n = Cl(Y o
have A2d+nYd,n = Cl(Yd,n), A2d+nY o
d,n). Furthermore by [FP97,
§3.1], Y ∂
d,n is of pure dimension 2d + n. Recall that by [KP01, Corollary 2]
we know that its irreducible components are the divisors

A2d+nY ∂

d,n → 0.

DB,k = D({1, . . . , n} \ B, (1, d − k); B, (0, k)),

where B ⊂ {1, . . . , n}, 0 ≤ k ≤ d with |B| ≥ 2 for k = 0.
In our inter-
pretation as pointed graphs of rational maps, this is the divisor of graphs,
where the vertical section contains the markings B and maps with degree
k. We conclude that A2d+nY ∂
d,n is the free abelian group generated by these
divisors.

30

JOHANNES SCHMITT

It remains to ﬁnd generators for the Class group of Y o

d,n. For this we use
the fact that the map J deﬁned in Lemma 2.7 is an isomorphism over this
locus.

Corollary 4.3. For d ≥ 1, n ≥ 0, the rational Picard group of Y o
by

d,n is given

Pic(Y o

d,n) ⊗ Q = 


0
Qπ∗
0

P1O(1)

for n = 0,
for n = 1, 2,
for n ≥ 3,



∼= Ratd × ((P1)n \ ∆) → P1 is the

d,n = M0,n(P1 × P1, (0, 1)) = M0,n(P1, 1) × P1
d,n → P1 on the last factor. This gives an

where for n = 1, 2 the map πP1 : Y o
d,n
projection on the ﬁrst factor P1.
In the case d = 0, we have Y o
and an induced projection p : Y o
additional direct summand QG for G = p∗(OP1(1)) to the formula above.
∼= Ratd × ((P1)n \ ∆). By [Isc74],
Proof. From Lemma 2.7 we see that Y o
d,n
the Picard group of the product of a rational variety with another variety
is the direct sum of their corresponding Picard groups. Now for d ≥ 1, the
set Ratd is the complement of a hypersurface in P2d+1 and thus has a ﬁnite
Picard group, which vanishes after tensoring with Q. For d = 0 the degree
d maps from P1 to itself are exactly the constant maps, so Ratd = P1 giving
the additional summand QG.

For the other factor we note that the rational Picard group of (P1)n is

freely generated by the classes

Hi = π∗

i OP1(1),

where πi : (P1)n → P1 is the projection on the i-th factor. The set ∆ we
remove is the union of irreducible divisors

∆ij = {(p1, . . . , pn); pi = pj}.
Their divisor class equals [∆ij] = Hi + Hj. By the excision exact sequence
we have

n

Pic((P1)n \ ∆) ⊗ Q =

QHi/

Q[∆ij].

For n = 0 this is obviously trivial, for n = 1 we have exactly QH1. For
n = 2 we obtain QH1 ⊕ QH2/Q(H1 + H2) ∼= QH1. For n ≥ 3 we note that
[∆1,2] + [∆1,3] − [∆2,3] = H1 + H2 + H1 + H3 − H2 − H3 = 2H1.

Mi=1

Mi6=j

Similarly we can represent all other classes Hi and thus one sees that the
(cid:3)
Picard group of (P1)n \ ∆ is trivial in this case.

Theorem 4.4. For d ≥ 0 and n ≥ 0, the rational Picard group of Yd,n is
generated by DB,k for B ⊂ {1, . . . , n}, 0 ≤ k ≤ d and |B| ≥ 2 if k = 0,
together with the divisor class

H = (π1 ◦ ev1)∗(OP1(1))

COMPACTIFICATION OF SELF-MAPS SPACE OF CP1 USING STABLE MAPS

31

in the cases n = 1, 2 and the class G = π∗(OP1(1)) for d = 0, where

π : M 0,n(P1 × P1, (0, 1)) = M 0,n(P1, 1) × P1 → P1

is the projection on the factor P1.

Proof. The ﬁrst part of the Theorem is a combination of the discussion at
the beginning of this section together with Corollary 4.3. Here we note that
the divisor H above obviously restricts to π∗
d,n and similarly for
(cid:3)
G.

P1O(1) on Y o

In the following, we denote the set of generators above by Gd,n.

4.1.2. Relations. Now we want to ﬁnd all relations between the generators
of the rational Picard group of Yd,n found above. Using techniques adapted
from [Pan99] we construct curves in Yd,n and intersect them with the divisors
above. Relations among the classes of the divisors would imply relations
between these intersection numbers. Hence using test curves for which the
vectors of intersection numbers are linearly independent, we can show the
linear independence of some of the generators above. The construction of
the curves will rely on the following explicit family of stable maps.

Consider the variety S = P1 × P1 with coordinates ([z : w], [x0 : x1]) and

the projections π1, π2 to the two factors. Let d ≥ 0, 0 ≤ k ≤ d and

1(OP1(d)) ⊗ π∗
N = OS(d, k) = π∗
Two global sections s1, s2 ∈ H 0(S, N ) are given by

2(OP1(k)).

s1 = (z − a1w)(z − a2w) . . . (z − ad−kw)(x1z − b1x0w) . . . (x1z − bkx0w)
s2 = (z − c1w)(z − c2w) . . . (z − cd−kw)(x1z − d1x0w) . . . (x1z − dkx0w),
where ai, bj, ci, dj ∈ C∗ for i = 1, . . . , d − k, j = 1, . . . , k are suﬃciently
general. In the case d = 0 we have N = O and we set s1 = a, s2 = c with
(a, c) 6= (0, 0). These sections deﬁne a rational map
µ :S − → P1 × P1,

([z : w], [x0 : x1]) 7→ ([z : w], [s1 : s2]).

For k = 0, this is a morphism and induces a constant map of degree d on
the ﬁbres of π2. For k ≥ 1 its base points are exactly

• the k(d−k) points ([ci : 1], [ci/bj : 1]) for i = 1, . . . , d−k, j = 1, . . . , k,
• the k(d − k) points ([ai : 1], [ai/dj : 1]) for i = 1, . . . , d − k, j =

1, . . . , k,

• the 2 points ([0 : 1], [0 : 1]) and ([1 : 0], [1 : 0]).

To illustrate this, consider the following picture. We draw for d = 4, k = 2
the vanishing sets of s1, s2 on P1 × P1. The horizontal lines of these sets
come from the zeroes at [z : w] = [ai : 1] and [z : w] = [ci : 1], respectively.
The curved parts depict the graphs of the linear maps [x0 : x1] 7→ [bjx0 : x1]
and [x0 : x1] 7→ [djx0 : x1], respectively. The base points are exactly the
intersection points of V (s1) with V (s2). In particular, we see the two special

32

JOHANNES SCHMITT

intersection points over [0 : 1] and [1 : 0], where k zeroes of s1 and s2 come
together.

P1 × P1

V (s1)

V (s1)

π2

[0 : 1]

P1
[x0 : x1]

[1 : 0]

From the formulas above, we conclude that for suﬃciently general ai, bj, ci, dj
all base points have distinct [x0 : x1]-coordinates.

Now let n ≥ 0 and assume we have sections σ1, . . . , σn : P1 → S of
π2 : S → P1. An intersection point is a point p ∈ S lying in the image of
at least two of the sections σi. The set of special points is the union of base
points and intersection points.

Lemma 4.5. Assume that there are ﬁnitely many intersection points and
that at each of them, the sections σi meeting there have distinct tangent
directions. Furthermore, assume that the [x0 : x1]-coordinates of all special
points are pairwise distinct.

Then the blow-up S of S at all special points resolves the indeterminacies
of µ and the induced maps µ : S → P1 × P1, σ1, . . . , σn : P1 → S give a
Kontsevich stable family of n-pointed genus 0 curves

C = (π2 : S → P1; σ1, . . . , σn; µ : S → P1 × P1)

over P1 which induces a map ψ : P1 → Yd,n = M 0,n(P1 × P1, (1, d)).

Moreover, for a suﬃciently general choice of the parameters ai, bi, ci, di,
the map ψ intersects the boundary of Yd,n transversally and a point x =
[x0 : x1] maps to the boundary if and only if there is a special point p ∈ S
with x = π2(p). Let

B = {i : σi passes through p} ⊂ {1, . . . , n}

COMPACTIFICATION OF SELF-MAPS SPACE OF CP1 USING STABLE MAPS

33

be the set of indices of sections through p and let m = 0 if p is not a
base point, m = 1 if p is a base point diﬀerent from ([1 : 0], [1 : 0]) and
([0 : 1], [0, 1]) and m = k otherwise. Then at x the map ψ intersects exactly
the boundary divisor DB,m.

Proof. We ﬁrst show that the blow-up of the special points resolves the
indeterminacies of our rational map. Note that all base points except ([1 :
0], [1 : 0]) (which is easily seen to behave similar to ([0 : 1], [0 : 1])) lie in
A2 ⊂ P1 × P1. Thus we will set w = x1 = 1 and use aﬃne coordinates z, x0.

Around the point p = (ci, ci/bj) we can identify

BlpA2 = {((z, w), [T : S]) : (z − ci)S − (x0 − ci/bj)T } ⊂ A2 × P1.

Then the second component of the map the map µ extends around p by
sending ((z, x0), [T : S]) to

(z − a1) . . . (z − bj−1x0)(T − bjS)(z − bj+1x0) . . . (z − bkx0)
(z − c1) . . . (z − ci−1)T (z − ci+1) . . . (z − dkx0)

.

Similarly for q = (0, 0) we have

BlqA2 = {((z, w), [T : S]) : zS − x0T } ⊂ A2 × P1.

Here, the second component of µ can be extended by sending ((z, x0), [T : S])
to

(z − a1) . . . (z − ad−k)(T − b1S) . . . (T − bkS)
(z − b1) . . . (z − bd−k)(T − d1S) . . . (T − dkS)

.

It is also clear that the sections σi factor through S. As their tangent
directions in every special point are distinct, they map to distinct points
on the exceptional divisors. As π2 : S → P1 is dominant, it is ﬂat and as
blowups are projective, it is projective. The ﬁbres of π2 are isomorphic to
P1 except for the ﬁbres over projections of special points, which are nodal
genus 0 curves with two branches. The exceptional divisors are one of the
branches and as can be seen above, they map to P1 × P1 with degree (0, 1)
or (0, k) at the base points and are contracted for the intersection points
which are not base points, and thus map with degree (0, 0). The fact that
the induced map P1 → Yd,n meets the boundary transverally follows because
(cid:3)
the total space S of the family is smooth (see [Vak99, Section 4.4]).

We will ﬁnd that for a given subset B ⊂ {1, . . . , n}, a particular choice of

the sections σi will be very useful.

Deﬁnition 4.6. For α ∈ C∗ we deﬁne

Sα : P1 → P1 × P1, [x0 : x1] 7→ ([αx0 : x1], [x0 : x1]).

For B ⊂ {1, . . . , n} and 0 ≤ k ≤ d we set

• σj = Sαj for general αj ∈ C \ {0, 1} for j ∈ B,
• σj = (pj, id) with general pj = [pj : 1] ∈ C ⊂ P1 for j /∈ B.

34

JOHANNES SCHMITT

We will specify the required generality for the points αi, pj in the proof of
Proposition 4.7 below. We denote by ψB,k : P1 → Yd,n the corresponding
curve from Lemma 4.5 and by CB,k = (ψB,k)∗([P1]) its image cycle in Yd,n.

For later use we compute the evaluation of the ith point along the map

ψB,k. Here for brevity we identify points [λ : 1] ∈ P1 with λ ∈ C.

(evi ◦ ψB,k)([x0 : x1])

(12)

(pj−b1)...(pj −bd−k)(x1pj−d1x0)...(x1pj−dkx0) ) for i /∈ B,

(pj, (pj−a1)...(pj −ad−k)(x1pj−b1x0)...(x1pj−bkx0)
([αix0 : x1], (αix0−a1x1)...(αix0−ad−kx1)(x1αix0−b1x0x1)...(x1αix0−bkx0x1)
(αix0−c1x1)...(αix0−cd−kx1)(x1αix0−d1x0x1)...(x1αix0−dkx0x1) )
= ([αix0 : x1], (αix0−a1x1)...(αix0−ad−kx1)(αi−b1)...(αi−bk)
(αix0−c1x1)...(αix0−cd−kx1)(αi−d1)...(αi−dk) ) for i ∈ B.

= 




We will see now that the curves CB,k above were constructed to meet very
speciﬁc divisors in Yd,n.

Proposition 4.7. The nonzero intersection numbers of the curves CB,k with
the generators of the rational Picard group of Yd,n are exactly

• (CB,k, H) = 1 if 1 ∈ B and 0 otherwise
• (CB,k, D{a,b},0) = 1 for a ∈ A = {1, . . . , n} \ B, b ∈ B
• (CB,k, DB,k) = 2
• (CB,k, D∅,1) = 2k(d − k)

Note that for B = ∅, k = 1 we have (CB,k, D∅,1) = 2d = 2 + 2(d − 1), so in
this case the two diﬀerent numbers from above are added.

Proof. All the base points in the construction of the test curves of Lemma
4.5 lie on the union of the images of the maps Sbj , Sdj for j = 1, . . . , k. But
the images of Sα, Sβ for α 6= β intersect exactly at (0, 0), (∞, ∞) and there
they have distinct tangent directions. We choose the points pi such that the
sections (pi, id) miss all those base points and additionally their intersection
points with the sections σj, j ∈ B do not have the same second coordinate
as one of the base points. Then it is ensured that the conditions of Lemma
4.5 are satisﬁed.

Using the projection formula we obtain

(CB,k.H) = deg((ψB,k)∗[P1].(π1 ◦ ev1)∗OP1(1))

= deg((π1 ◦ ev1 ◦ ψB,k)∗OP1(1)).

From equation (12) we see that π1 ◦ ev1 ◦ ψ is an isomorphism for 1 ∈ B
and constant for 1 /∈ B. The sections σi, i ∈ A, do not meet among each
other. For j ∈ B, they meet the section σj once and all those sections meet
exactly in the points (0, 0), (∞, ∞), which are base points of degree k. This
(cid:3)
explains the remaining intersection numbers.

We need one other test curve in case d = 0.

Proposition 4.8. For d = 0 consider the identity map id : S = P1 × P1 → S
and constant sections σi : P1 → S, q 7→ (pi, q). Then π2 : S → P1 deﬁnes a

COMPACTIFICATION OF SELF-MAPS SPACE OF CP1 USING STABLE MAPS

35

family of stable maps over P1 where the map over [x0 : x1] corresponds to the
inclusion P1 → P1 × {[x0 : x1]} with the horizontal position of the marked
points held ﬁxed. This gives a curve CG in Y0,n which of all generators in
Gd,n intersects exactly the divisor G with multiplicity 1.

For formulating results about the relations among the generators of the
rational Picard group of Yd,n, we group those generators into convenient
subsets. For 0 ≤ j ≤ n we deﬁne

∆j = {DB,k : |B| = j, 0 ≤ k ≤ d and 1 ≤ k for j = 0, 1}.
In terms of our interpretation as pointed graphs of rational maps, these
are exactly those graphs where the vertical section carries j marked points.
Additionally we let

n

be the set of all boundary divisor generators and for n ≥ 4 we deﬁne

[j=0

∆ =

∆j

∆′ = ∆ \ (∆0 ∪ ∆1 ∪ ∆n−1 ∪ ∆n),

where we set ∆′ = ∅ for n ≤ 4.

Theorem 4.9. Let d ≥ 0, n ≥ 0, then in Pic(Yd,n) ⊗ Q

• the divisor G is linearly independent of all other generators for d = 0,
• the divisor H is not contained in the span of ∆ for n = 1, 2,
• the set ∆0 is linearly independent for n = 0,
• the set ∆0 ∪ ∆1 ∪ ∆n−1 ∪ ∆n is linearly independent modulo the span

of ∆′ for n ≥ 1,

• the relations among the divisor classes in ∆′ are exactly the pullback
of relations between the boundary divisors in M 0,n for n ≥ 4. These
are generated by the relations

D(A; B) =

D(A; B)

Xi,j∈A
k,l∈B

Xi,k∈A
j,l∈B

for distinct i, j, k, l ∈ {1, . . . , n}.

Proof. For d = 0, as (CG.G) = 1 and all intersections with other generators
are zero, G is linearly independent of those.

For n = 1 we see that C{1},0 intersects exactly the divisor H with multi-

plicity 1. Hence H is linearly independent from the span of ∆.

For n = 2 we consider the curves C{i},0 for i = 1, 2. They intersect
D{1,2},0 with multiplicity 1 and C{1},0 also intersects H. Hence the 1-cycle
C{1},0 − C{2},0 intersects only H nontrivially, which is therefore linearly
independent.

Now let n ≥ 0 and consider the curves C∅,k, which only intersect D∅,k and
D∅,1 nontrivially. The case k = 1 shows that D∅,1 is linearly independent
from all other boundary divisors. Using this in the case 2 ≤ k ≤ d, we also
obtain linear independence of the other divisors D∅,k in ∆0.

36

JOHANNES SCHMITT

Let now n ≥ 1. For 1 ≤ i ≤ n and 1 ≤ k ≤ d choose σj = (pj, id) for j 6= i
missing the base points as in Deﬁnition 4.6, but σi = (0, id). Then the only
nonzero intersections with boundary divisors are

(C.D∅,1) = 2k(d − k), (C.D∅,k) = 1, (C.D{i},k) = 1

As the ﬁrst two types of divisors are in ∆0, which is already seen to be
linearly independent, we obtain the independence of all divisors in ∆1.

For n ≥ 2, 0 ≤ k ≤ d, we ﬁrst consider C{1,...,n},k, which only intersects
D{1,...,n},k and D∅,1. Again we already know that D∅,1 is independent of the
other boundary divisors and thus we obtain the independence of all elements
in ∆n.

Now if for some i ∈ {1, . . . , n} we modify the family giving us C{1,...,n},k
by setting σi = (0, id), this section no longer meets (∞, ∞) and we obtain a
new curve C in Yd,n. Note now that

(C.D∅,1) = 2k(d − k), (C.D{1,...,n},k) = 1, (C.D{1,...,n}\{i},k) = 1.

As we already know the independence of ∆n, this also gives us the indepen-
dence of ∆n−1.

Now for n ≥ 4 we come to the relations among the divisors in ∆′. Re-

member that there is a morphism

F : Yd,n = M 0,n(P1 × P1, (1, d)) → M 0,n

by forgetting the map and only remembering the stabilization of the domain
curve. The map F is ﬂat by Theorem B.1. For A, B ⊂ {1, . . . , n} disjoint
with |A|, |B| ≥ 2 and A ∪ B = {1, . . . , n}, the boundary divisor D(A; B) in
M 0,n pulls back under F to the multiplicity free sum

d

d

DA∪B =

DA,m +

DB,m = F ∗(D(A; B)).

We claim that given a relation

Xm=0

Xm=0

(13)

cDD = 0

XD∈∆′

in Pic(Yd,n) ⊗ Q, it is the pullback of a relation in M 0,n. In a ﬁrst step we
will show, that the coeﬃcient cDB,k of DB,k in (13) only depends on B and
moreover, the coeﬃcients for B and A = {1, . . . , n} \ B coincide. We will
denote them by cA∪B.

Indeed for k ≥ 1 we can take the intersection of the relation (13) with
the 1-cycle CB,k − CB,0. We see that all the intersections with the divisors
D{i,j},0 for i ∈ A, j ∈ B cancel and what remains is

0 = (CB,k − CB,0,

cDD) = 2cDB,k − 2cDB,0 ,

that is cDB,k = cDB,0 does not depend on k.

XD∈∆′

COMPACTIFICATION OF SELF-MAPS SPACE OF CP1 USING STABLE MAPS

37

For the claim that the coeﬃcient also remains the same if we switch the
roles of A and B, we take the intersection of (13) with CB,k − CA,k. Again
we see a cancellation and obtain

0 = (CB,k − CA,k,

cDD) = 2cDB,k − 2cDA,k

which concludes the proof that cD only depends on the partition of the
marked points in D.

XD∈∆′

Thus we know that the relation (13) is of the form

0 =

cA∪BDA∪B = F ∗(

cA∪BD(A; B))

XA∪B={1,...,n}

XA∪B={1,...,n}

But as F is surjective, proper and ﬂat, by [GJRW96, Corollary 2.3] the kernel
of the map map F ∗ : Pic(M 0,n) → Pic(Yd,n) is torsion, so the induced map
of rational Picard groups is injective. Hence as claimed, the relation (13)
is the pullback under F of the relation
A∪B={1,...,n} cA∪BD(A; B) = 0 in
Pic(M 0,n) ⊗ Q.

The form of the relations of boundary divisors in M 0,n was proved in
(cid:3)

[Kee92, Theorem 1].

P

Corollary 4.10. For d ≥ 0, n ≥ 0, the rank of the Picard group of Yd,n is
2n(d + 1) −

− 1 + δn,1 + δn,2 + δd,0.

n
2

(cid:1)

(cid:0)

Proof. Using Theorem 4.4, we ﬁrst count generators. For the boundary
divisors DB,k, we see that there are 2n choices for B and d + 1 choices for k.
In the case k = 0 we have to substract the n + 1 choices for a set B with at
most 1 element. We also have one additional generator H for n = 1, 2 and
G for d = 0.

For the relations, we see as in [Pan99] (c.f. the discussion above Lemma
− 1 independent relations among the boundary

1.2.3) that there are
components in M 0,n.

n−1
2

(cid:0)

(cid:1)

Thus the total dimension of Pic(Yd,n) ⊗ Q is

2n(d + 1) − (n + 1) + δn,1 + δn,2 + δd,0 −

=2n(d + 1) −

n
2

(cid:18)

(cid:19)

− 1 + δn,1 + δn,2 + δd,0

n − 1
2

(cid:19)

− 1

(cid:19)

(cid:18)(cid:18)

(cid:3)

For the sake of completeness, we also want to explicitly name one subset

of the generators that forms a basis.
Corollary 4.11. Consider the set Gd,n of generators of W = Pic(Yd,n) ⊗ Q
from Theorem 4.4. Then the set
(14) Bd,n = Gd,n \ {DB,0; B ⊂ {2, . . . , n}, |B| = 2 and B 6= {n − 1, n}}
forms a basis of W . Note that Bd,n = Gd,n for n ≤ 3.

38

JOHANNES SCHMITT

Proof. One sees easily from Corollary 4.10 that for all d, n, the set Bd,n has
dim(W ) elements. For n ≤ 3 this ﬁnishes the proof, so we may assume that
n ≥ 4. Let

V =

QD

MD∈Gd,n
be the vector space with formal basis Gd,n together with the natural sur-
jective map cl : V → W by taking the class in the rational Picard group.
Let U ⊂ V denote the kernel of this map. We have seen in the proof of
Corollary 4.10 that dim(U ) =
− 1. Moreover by Theorem 4.9, it is
spanned by relations among the generators in ∆′ obtained as pullback from
(cid:1)
the relations

n−1
2

(cid:0)

(15)

D(A; B) =

D(A; B)

Xi,j∈A
k,l∈B

Xi,k∈A
j,l∈B

k DB,k where the
among boundary divisors D(A; B) in M 0,n. Set DB =
sum is over k = 0, . . . , d if |B| ≥ 2 and k = 1, . . . , d otherwise. Then the
relation (15) pulls back to

P

(16)

DB +

DB =

DB +

DB.

Xi,j∈A
k,l∈B

Xi,j∈B
k,l∈A

Xi,k∈A
j,l∈B

Xi,k∈B
j,l∈A

Now consider the canonical projection V → V ′ on the subspace V ′ ⊂ V
generated by the divisors DB,0 with |B| = 2. From (16) we see that under
this projection, the space U maps to the space U ′ generated by elements of
the form

(17)

D{k,l},0 + D{i,j},0 − D{j,l},0 − D{i,k},0.

We have another projection V ′ → V ′′ where V ′′ is the span of

{DB,0; B ⊂ {2, . . . , n}, |B| = 2, and B 6= {n − 1, n}}.

One sees immediately that dim(V ′′) =
− 1 = dim(U ) and we claim
that the image U ′′ of the induced projection U ′ → V ′′ is all of V ′′. This in
turn would imply, that the map U → V ′′ is an isomorphism and from this
one immediately concludes that Bd,n forms a basis of W .

(cid:0)

(cid:1)

n−1
2

First note that under V ′ → V ′′ the elements

D{1,2},0, D{1,3},0, . . . , D{1,n},0, D{n−1,n},0

map to 0 by deﬁnition. Taking i = 1, k = n, l = n − 1 in (17) we see that
−D{j,n−1},0 ∈ U ′′. Switching k and l we also have −D{j,n},0 ∈ U ′′. But now
take 2 ≤ i, j ≤ n − 2 arbitrary distinct and k = n, l = n − 1 then we have
D{i,j},0 − D{i,n},0 − D{j,n−1},0 ∈ U ′′, so also D{i,j},0 ∈ U ′′. But this ﬁnishes
(cid:3)
the proof.

COMPACTIFICATION OF SELF-MAPS SPACE OF CP1 USING STABLE MAPS

39

4.1.3. Identiﬁcation of divisors. Now that we have a basis of the rational
Picard group of Yd,n, we can ﬁnd an algorithm to explicitly represent a
given divisor D as a linear combination in this basis. We will see that all
the information that is needed are the intersection numbers of D with the
test curves CB,k from Proposition 4.7 together with the intersection (CG.D)
for d = 0. We now give explicit formulas for the coeﬃcients of the basis
elements.

Proposition 4.12. Let D be a rational divisor class on Yd,n and let NB,k =
(CB,k.D). Then D has a unique representation

(18)

D =

cDB,k DB,k +cHH
for n=1,2

+cGG

.

for d=0

XDB,k∈Bd,n

The coeﬃcients are determined as follows

| {z }

| {z }

• cG = (CG.D) for d = 0,
• cH = N{1},0 for n = 1, cH = N{1},0−N{2},0 for n = 2 and 0 otherwise,
• c{1,2},0 = N{2},0 for n = 2,
• c{1,j},0 = N{j},0 for 2 ≤ j ≤ n − 2, n ≥ 3,
• c{1,n−1},0 = 1
for n ≥ 3,
• c{1,n},0 = 1
n ≥ 3,

2 (N{1},0 − N{2},0 − . . . − N{n−2},0 − N{n−1},0 + N{n},0) for

2 (N{1},0 − N{2},0 − . . . − N{n−2},0 + N{n−1},0 − N{n},0)

2 (−N{1},0 + N{2},0 + . . . + N{n−2},0 + N{n−1},0 + N{n},0)

• c{n−1,n},0 = 1
for n ≥ 3,

• c{k,l},0 = 0 for k, l > 1 if {k, l} 6= {n − 1, n} for n ≥ 3,
• cB,k = 1

d N∅,1 − χB(1)cH −

2 (NB,k − k(d−k)

a /∈B,b∈B c{a,b},0) for B ⊂

{1, . . . , n}, k ≥ 0 and (|B|, k) 6= (2, 0).

P

Here, χB is the characteristic function of the set B, so χB(m) = 1 if m ∈ B
and χB(m) = 0 otherwise.

Proof. From Corollary 4.11 it is clear that a unique representation of D
in the form (18) must exist. To arrive at the formulas above one takes
the intersection of equation (18) with the test curves CG, CB,k and checks
that the resulting linear system uniquely determines the coeﬃcients to be
the numbers above. Here one should proceed in the order suggested above,
except that one needs to determine c∅,1 using N∅,1 before calculating the
(cid:3)
other numbers cB,k.

4.1.4. Geometric divisors. We now want to deﬁne several divisors on Yd,n
and use Proposition 4.12 to identify them in terms of our basis.

First of all, for every i ∈ {1, . . . , n} we have the evaluation map evi :

Yd,n → P1 × P1. This gives us divisors

Hi,1 = (π1 ◦ evi)∗OP1(1),
Hi,2 = (π2 ◦ evi)∗OP1(1).

40

JOHANNES SCHMITT

For n = 1, 2, the divisor H1,1 = H is an element of or basis Bd,n of the ratio-
nal Picard group. While it is possible to describe the elements Hi,1 in other
cases as well using the formulas in Proposition 4.12, the resulting represen-
tation is not very illuminating. However we will see that by substracting
suitable multiples of the divisors Hi,j from other geometric divisors below,
the representation of these divisors becomes much nicer. As the divisors
Hi,1 are easy to handle in any case, we will use them in our expression of
other geometric divisors.

As a ﬁrst step we apply this to the divisors Hi,2.

Proposition 4.13. The divisor class of H′

i,2 = Hi,2 − dHi,1 has the form

H′

i,2 =

d

Xk=1





k2
2d

DB,k +

k2
2d

(
XB∋i

XB6∋i

− k)DB,k


+G

.

for d=0

Proof. To compute the intersection numbers of the divisors Hi,j with CB,k
consider again equation (12). Then it is clear that

|{z}

(CB,k.Hi,j) = deg(πj ◦ evi ◦ ψB,k).

Hence we conclude

(CB,k.Hi,1) = χB(i),
(CB,k.Hi,2) = dχB(i) + k(1 − 2χB(i)).

Thus

(CB,k.H′

i,2) = k(1 − 2χB(i)).

Going through the recipe of Proposition 4.12 we ﬁnd the desired formula. (cid:3)

The reason for substracting dHi,2 was that it eliminates intersections with
all the test curves CB,0, which would make the formulas much more compli-
cated.

For the next deﬁnitions, we will use that the evaluation maps, which were

already considered above, are ﬂat.

Lemma 4.14. For i = 1, . . . , n, the evaluation maps evi : Yd,n → P1 × P1
are ﬂat and surjective.

Proof. All that we will use, is that there exists a transitive action of an
algebraic group H on the target X = P1 × P1, which leaves the curve
class β = (1, d) invariant. In our case, we can take the natural action of
H = PGL2 × PGL2. Using Lemma C.6, we obtain an induced action of
H on Yd,n (by postcomposition) making evi equivariant. Then surjectivity
is immediate, as H acted transitively on X. Moreover, by generic ﬂatness,
the map evi is ﬂat over some open subset U ⊂ X. But then it is ﬂat over
g.U for all g ∈ H and using again the transitivity of the action, it is ﬂat
(cid:3)
everywhere.

COMPACTIFICATION OF SELF-MAPS SPACE OF CP1 USING STABLE MAPS

41

One divisor that will be important later is the subset of Yd,n where the ith
marked point is a ﬁxed point of the self-map. When looking at the graph Γ
of a map from P1 to itself, the set of ﬁxed points is exactly (the projection
of) the intersection of Γ with the diagonal ∆ ⊂ P1 × P1. Thus we make the
following deﬁnition.

Deﬁnition 4.15. For d, n ≥ 0 we call

Di=ﬁx = ev−1

i (∆) ⊂ M 0,n(P1 × P1, (1, d))

the ith ﬁxed point divisor.

This is an eﬀective Cartier divisor. As O(∆) = π∗

1(O(1)) ⊗ π∗

2(O(1)) we

have

Di=ﬁx = Hi,1 + Hi,2

as divisor classes in Pic(Yd,n).

Next, for a point p ∈ P1 × P1 we want to consider the locus Dp ⊂ Yd,n
of stable maps f : C → P1 × P1, where p lies on the graph f (C). For this,
consider the forgetful map F : Yd,n+1 → Yd,n of the last marking n+1, which
we interpret as the universal curve over Yd,n. Here, we have the evaluation
map evn+1 : Yd,n+1 → P1 × P1, which is ﬂat. Hence, we can pull back the
cycle {p} ⊂ P1 × P1 and then push it forward to Yd,n via F . Indeed, we
deﬁne

Dp = F∗ev∗

n+1[{p}].

As {p} is codimension 2 and as F has ﬁbres of dimension 1, this should
indeed be a divisor in Yd,n. We now compute its class in the rational Picard
group.

Proposition 4.16. The divisor class of Dp has the form

Dp =

k2
2d

d

Xk=1

DB,k +G

.

XB⊂{1,...,n}

for d=0

Proof. As the class of {p} in the Chow group of P1 × P1 is exactly

|{z}

[{p}] = c1(O(1, 0)) ∩ c1(O(0, 1)) ∩ [P1 × P1],

we know that

ev∗

n+1[{p}] = c1(Hn+1,2) ∩ c1(Hn+1,1) ∩ [Yd,n+1]
n+1,2) ∩ c1(Hn+1,1) ∩ [Yd,n+1].

= c1(H′

Here we use that c1(Hn+1,1)2 = ev∗
apply the formula for H′
that for n + 1 ∈ B, 1 ≤ k ≤ n we have

n+1c1(O(1, 0))2 = 0. But now we can
n+1,2 from Proposition 4.13. Note in the following,

F∗ (c1(Hn+1,1) ∩ DB,k) = 0,

42

JOHANNES SCHMITT

because a general point of the cycle on the left has a vertical section with
a ﬁxed horizontal position, and this is already a codimension 2 condition.
Using this, we compute

k2
2d

DB,k +

k2
2d

(
Xk,B∋i

− k)DB,k +G

for d=0

|{z}





F∗ev∗

n+1[{p}]

=F∗c1(Hn+1,1) ∩

=F∗c1(Hn+1,1) ∩


=F∗c1(Hn+1,1) ∩ F ∗







Xk,B6∋n+1
k2
2d

Xk,B

DB,k +G



for d=0

k2
2d





Xk,B


|{z}
DB,k +G

for d=0

|{z}

,





where in the last line, the sum of boundary divisors is on Yd,n. But then,
for using the projection formula to obtain the desired result, we only need
that

F∗c1(Hn+1,1) ∩ [Yd,n+1] = [Yd,n].

But this is clear, since over the locus Y o
subvariety ev−1
via F (for a formal proof see Lemma 5.2).

d,n with smooth domain curve, any
n+1({p1} × P1) (for p1 ∈ P1) maps birationally onto its image
(cid:3)

4.2. The Picard group of M (d|d1, . . . , dn) ﬁnished.

Corollary 4.17. Let d = (d|d1, . . . , dn) be admissible and set

n

dT = d + 1 +

di.

Xi=1

Then the rational Picard group of Y ss,d
the linear span of the divisors DB,k with k +
Di=ﬁx for all i with di > dT /2 − 1.
Proof. By restricting to the open set Y ss,d
of all codimension 1 components of Yd,n \ Y ss,d
identify this locus.

P

d,n is the quotient of Pic(Yd,n) ⊗Z Q by
2 and the divisors

i∈B di > dT

d,n we divide out the divisor classes
d,n . We will use Lemma 2.10 to

The ﬁrst case that can make a closed point of Yd,n unstable is when a
marked point i with weight di becomes a ﬁxed point and di + 1 > dT /2.
This is exactly accounted for by dividing by Di=ﬁx. We note that this is the
only cause of instability away from the boundary.

Now a general point of the boundary divisor DB,k corresponds to a
parametrized graph with exactly one vertical section of multiplicity k over a
non-ﬁxed point and with the points in B on the vertical section. As we have

COMPACTIFICATION OF SELF-MAPS SPACE OF CP1 USING STABLE MAPS

43

already taken care of instabilities from marked points being ﬁxed points,
(cid:3)
this is unstable iﬀ k +

i∈B di > dT
2 .
Corollary 4.18. For d = (d|d1, . . . , dn) admissible, the map

P

φ∗ : Pic(M (d|d1, . . . , dn)) ⊗Z Q → Pic(Y ss,d

d,n ) ⊗Z Q

is an isomorphism.

d,n → Z s

Proof. For (d, n) 6= (2, 0), (1, 1), this is exactly Corollary 4.2. For d = 2, n =
0 we have the isomorphism j : Y s
d from Lemma 3.3 inducing an
isomorphism M (2, 0) ∼= P2. Then one checks that the generator D∅,1 of the
rational Picard group corresponds exactly to the line at inﬁnity P2 \ A2 and
hence forms a basis of the rational Picard group. On the other hand in the
case d = 1, n = 1, we have seen that the only nonempty moduli spaces are
all isomorphic to M (1|1). But we saw M (1|1) ∼= P1 in Lemma 3.2. On the
other hand Corollary 4.17 gives generators H, D∅,1, but we must divide by
the class

D1=ﬁx = 2H +

D∅,1.

1
2

Hence the Picard group of Y ss,(1|1)
pullback map ϕ∗ induces an isomorphism with Pic(P1) ⊗Z Q = Q.

is of rank 1 and one checks that the
(cid:3)

1,1

5. Iteration of rational functions

One feature of self-maps f : X → X of a set X is the possibility to iterate

them. We deﬁne the m-fold self composition

f ◦m = f ◦ f ◦ · · · ◦ f

,

m times

of f , where f ◦0 = idX. Now if ψ : X → X is an automorphism of X, we can
|
look at the iteration of the conjugated map fψ = ψ−1 ◦ f ◦ ψ and see

{z

}

f ◦m
ψ = ψ−1 ◦ f ◦ ψ ◦ ψ−1 · · · f ◦ ψ = ψ−1 ◦ f ◦m ◦ ψ.
is conjugated to f ◦m, again by the map ψ.

Hence, f ◦m

ψ

Returning to our setting of self-maps of P1 this allows us to deﬁne iteration
on conjugacy classes [f ] of self-maps f : P1 → P1. The map f ◦m has degree
dm. By the argument above, one sees that the induced map

scm : Ratd → Ratdm, f 7→ f ◦m

descends to a map of the quotients

scm : Md → Mdm, [f ] 7→ [f ◦m].
In the following we want to see how to extend these maps to (parts of) the
boundary of our compactiﬁcations M (d, 0) and also how to handle marked
points. As above it will be more convenient to ﬁrst work on the original
varieties Yd,n = M 0,n(P1×P1, (1, d)), construct PGL2-equivariant maps there
and then descend them to the quotients.

44

JOHANNES SCHMITT

5.1. Composition maps. Recall that the spaces Yd,0 were natural com-
pactiﬁcations of the spaces Ratd of degree d maps from P1 to P1. But as
long as we do not “forget the coordinates” on P1 by taking the quotient
under the action of PGL2, we are even able to compose two diﬀerent maps
f, g : P1 → P1 of possibly diﬀerent degrees. One sees easily that the map
c : Ratd1 × Ratd2 → Ratd1d2, (f, g) 7→ g ◦ f
(19)
is an algebraic morphism The self-composition morphism sc2 : Ratd → Ratd2
is obtained from the map above (in case d1 = d2 = d) by precomposing with
the diagonal Ratd → Ratd × Ratd. Thus we can study the more general
question of how to extend c to parts of the compactiﬁcation Yd1,0 × Yd2,0 of
Ratd1 × Ratd2 and also how to handle marked points. We will see that this
more general setup will allow us to recursively construct an extension of the
map scm using the fact that

scm(f ) = f ◦ f ◦ · · · ◦ f

◦f = scm−1(f ) ◦ f.

m−1 times

We begin with an easy result that will allow us to handle marked points
later.

{z

|

}

Deﬁnition 5.1. For d, n ≥ 0 and f = (f : C → P1 × P1; p1, . . . , pn) ∈ Yd,n
let

Vert(f ) = {q ∈ P1 : some component of C is contracted to q by π1 ◦ f }

be the set of positions of vertical sections for f .

Obviously, Vert(f ) is ﬁnite and for f ∈ Y o

d,n it is empty.

Lemma 5.2. Let F : Yd,n+1 → Yd,n be the map forgetting the (n + 1)st
marking and let evn+1 : Yd,n+1 → P1 × P1 be the evaluation map for this
marking. Then the map

E = F × (π1 ◦ evn+1) : Yd,n+1 → Yd,n × P1

is birational. More precisely, the restriction of E to

V = Yd,n+1 \

(DB,k : n + 1 ∈ B and (|B| > 2 or k > 0))

is an open embedding V ∼−→ U ⊂ Yd,n × P1 with complement

[

Vertd,n = Yd,n × P1 \ U

of codimension at least 2. We have the description

U (C) = {(f, q) : q /∈ Vert(f )}

of the closed points of U . Over U we have a section s : U → Yd,n+1 of E.

Proof. We are going to show that E induces a bijection from the closed
points of V to the points in the set U (C) above. Then by Zariski’s main
theorem, as Yd,n × P1 is normal, E|V is an isomorphism of V to an open set

COMPACTIFICATION OF SELF-MAPS SPACE OF CP1 USING STABLE MAPS

45

U ⊂ Yd,n × P1 with the set U (C) of closed points given above. The section
s is then given by (E|V )−1.

To prove the bijection between V (C) and U (C), note ﬁrst that by con-
struction the closed points (f : C → P1 × P1; p1, . . . , pn+1) ∈ V are exactly
those elements of Yd,n+1 such that the marking pn+1 does not lie on a verti-
cal component of C remaining stable under forgetting pn+1. Under the map
E we forget this marking and stabilize to obtain a map ˜f : ˜C → P1 × P1, but
also remember the horizontal position q of f (pn+1). We have now veriﬁed
that indeed q /∈ Vert( ˜f ), so there is exactly one point
q) above
q and it lies on the horizontal component of ˜C. Hence we can recover the
original curve C by making
q the (n + 1)st marking (possibly introducing a
q is already a marked point of ˜C). One checks that
contracted component if
this is exactly a description of the inverse s of E|V over U .
b

q ∈ ˜C with f (

The only remaining point is to check that the complement Vertd,n of U

b
has codimension at least 2. But looking at the map

b

b

Vertd,n → Yd,n

we see it only has nonempty ﬁbres over the boundary of Yd,n and these ﬁbres
are ﬁnite, hence

dim(Vertd,n) ≤ dim(Yd,n) − 1 = dim(Yd,n × P1) − 2.

(cid:3)

The basic idea for extending the composition map c from (19) to the

boundary in Yd1,0 × Yd2,0 is to use the universal families

Ydi,1

ev1−−−−→ P1 × P1


Ydi,0

y

to construct a family in Yd1d2,0(W ) for an open set W ⊂ Yd1,0 × Yd2,0,
inducing a map W → Yd1d2,0. Let us illustrate the construction over points
fi = ((πi, φi) : Ci → P1 × P1) ∈ Ratdi,
where we already know the desired result f2 ◦ f1. Here the maps πi induce
isomorphisms Ci ∼= P1 and the composition f2 ◦f1 ∈ Ratd1d2 should be given
by

f2 ◦ f1 = (idP1, φ2 ◦ π−1

2 ◦ φ1 ◦ π−1

1 ) : P1 → P1 × P1.

One way to obtain this map without having to explicitly invert the maps πi
is to use as the domain of f2 ◦ f1 the curve

C = C1 ×φ1,P1,π2 C2 = {(c1, c2) ∈ C1 × C2 : φ1(c1) = π2(c2)}.
As π2 : C2 → P1 is an isomorphism, the projection C → C1 on the ﬁrst
factor is an isomorphism, so C is isomorphic to P1. However, it is now easy

46

JOHANNES SCHMITT

to write down f2 ◦ f1 on C as

f2 ◦ f1 : C → P1 × P1

(c1, c2) 7→ (π1(c1), φ2(c2)).

One sees that these two deﬁnitions of f2 ◦ f1 are compatible via the isomor-
phism C → C1

π1−→ P1 of the source curves:
2 ◦ φ1 ◦ π−1

(φ2 ◦ π−1

1 )(π1(c1)) = (φ2 ◦ π−1
= (φ2 ◦ π−1

2 )(φ1(c1))
2 )(π2(c2)) = φ2(c2).

The advantage of the second construction is that it does not require the
πi : Ci → P1 to be isomorphisms, and this is exactly what fails on the
boundary of Ydi,0. In the following Lemma, we will try to understand in
which situations the ﬁbre product C1 ×φ1,P1,π2 C2 is again a nice curve for
C1, C2 not necessarily smooth. The reader might beneﬁt from matching the
descriptions in the Lemma below to the illustration in Figure 1 and the
corresponding Remark 5.4.

Lemma 5.3. Let fi = ((πi, φi) : Ci → P1 × P1; pi,1, . . . , pi,ni) ∈ Ydi,ni be
geometric points, i = 1, 2. Assume that they satisfy the following condition:

(P1)

For all q ∈ Vert(f2), the preimage φ−1
smooth, reduced points of C1.

1 ({q}) is a union of

Then the ﬁbre product

C = C1 ×φ1,P1,π2 C2 = {(c1, c2) ∈ C1 × C2 : φ1(c1) = π2(c2)}

is a projective, connected, reduced genus 0 curve with at worst nodal singu-
larities. It maps to P1 × P1 × P1 via

\f2 ◦ f1 : C → P1 × P1 × P1
(c1, c2) 7→ (π1(c1), φ1(c1)

, φ2(c2)).

=π2(c2)

Let Gi = ((Vi,j)ri
j=0, Ei) be the dual graphs of the curves Ci. That is, the
graphs with vertices Vi,0, . . . , Vi,ri corresponding to the irreducible compo-
nents of Ci and edges e ∈ Ei corresponding to nodes shared by the com-
ponents connected by the edge. Let the component Vi,0 map with degree
(1, di,0) and the components Vi,j with degree (0, di,j ) for 0 < j ≤ ri.

| {z }

Then the dual graph G of C is obtained from G1 by glueing to all ver-
tices V1,j in G1 a number of d1,j copies of the graph G2 along its root
vertex V2,0. The new degree (with respect to (P1)3) of this glueing vertex is
(δj,0, dj,0, dj,0d2,0), the new degrees of the copies of V2,j for 0 < j ≤ r2 are
(0, 0, d2,j ).

Assume that in addition to condition (P1), the points f1, f2 satisfy

(P2)

For all marked points p1,j ∈ C1 we have φ1(p1,j) /∈ Vert(f2) ∪
π2 ({p2,j : j = 1, . . . , n2})

COMPACTIFICATION OF SELF-MAPS SPACE OF CP1 USING STABLE MAPS

47

and

(P3)

For all marked points q ∈ C2 on the horizontal component
(corresponding to V2,0), the preimage φ−1
1 (π2(q)) is a union
of smooth, reduced points of C1.
Then there exist n1 + d1n2 pairwise distinct markings
p1
2,1, . . . ,

p1
2,2, . . . ,

pd1
2,n1 ∈ C

pd1
2,2, . . . ,

p1,1, . . . ,

pd1
2,1,

p1,n1,

of smooth points in C such that with the projections πCi : C → Ci on the
b
b
two factors, we have

b

b

b

b

b

• πC1(
• πC2(
Moreover, the data

p1,j) = p1,j for j = 1, . . . , n1,
pl
2,k) = p2,k for k = 1, . . . , n2, l = 1, . . . , d1.
b
b

\f2 ◦ f1 : C → P1 × P1 × P1;
(cid:16)

p1,1, . . . ,

pd1
2,n1

(cid:17)

gives a stable map of a genus 0 curve with n1 + d1n2 markings of degree
pl
(1, d1, d1d2). It is uniquely deﬁned up to the ordering of the markings
2,k
for every k = 1, . . . , n2. Thus by forgetting the second component of the
map and stabilizing if necessary, we obtain a well-deﬁned closed point

b

b

b

[f2 ◦ f1] ∈ Yd1d2,n1+d1n2/(Sd1 )n2,

where the j-th copy of Sd1 acts by permuting the markings

p1
2,j, . . . ,

pd1
2,j.

Remark 5.4. In Figure 1 we illustrate the composition of (C1, f1) ∈ Y5,1 and
(C2, f2) ∈ Yd,2, both of them contained in the boundary of their respective
spaces. The components are labelled by the bidegree (with respect to P1×P1)
of the maps f1, f2, f2 ◦ f1 restricted to them, respectively. Note that for
pl
j = 1, 2, the ordering of the points
2,j only represents one of the possible
choices and is not canonical.

b

b

b
Proof of Lemma 5.3. As C1, C2 are projective, so is their product C1 × C2
and C is then also projective as a closed subscheme of C1 × C2. By property
(P1), we have

C ⊂

C1 ×P1 C sm
2,0

∪

C sm

1,j ×P1 C2

⊂ C1 ×P1 C2,

n1

(cid:0)

(cid:1)

[j=0

(cid:0)

(cid:1)

where C sm
1,j are the smooth points of irreducible components of C1 and C sm
2,0
are the smooth points of the horizontal component of C2 (mapping with
degree 1 on the ﬁrst component of P1 × P1). Indeed, if (c1, c2) ∈ C with
c2 /∈ C sm
2,0 , then q = π2(c2) ∈ Vert(f2), but then by property (P1) we know
c1 ∈ φ−1
1 ({q}) is a smooth point of C1.

Let Uj = C sm

1,j ×P1 C2 and W = C1 ×P1 C sm

2,0 be the open sets covering C.
We will see that the spaces Uj, W are reduced, at worst nodal, connected
genus 0 curves. This shows the local properties of being a reduced and at
worst nodal curve for C. For the global property of being connected of genus

48

JOHANNES SCHMITT

(0, 1)

(0, 2)

(0, k)

p2,2

p1,1

p2,1

(1, 2)

(1, d − k)

(C1, f1)

(C2, f2)

(0, d − k)

(0, k)

p1
2,1

b

p1
2,2

b

(0, 2(d − k))

(0, k)

(0, k)

p2
2,2

b

p3
2,1

b

p3
2,2

b

p1,1

b

(C1 ×P1 C2, f2 ◦ f1)

p2
2,1

b

p5
2,2

p4
b
2,2

b

(0, k)

p5
2,1

(0, k)

b
p4
2,1

b

(1, 2(d − k))

Figure 1. Illustration of composition of (C1, f1) and (C2, f2)

0 we will simultaneously keep track of which components of C are connected
by nodes and will verify the construction of the dual graph G of C. As G is
obviously a tree, this will ﬁnish the ﬁrst part of the proof.
First consider the set W . Via the map π2, the set C sm

2,0 ⊂ C2 is embedded
in P1 as an open subset and W is just the preimage of this subset in C1 via
φ1. This shows all the desired properties of W except the connectedness.
But as the preimage of P1 \ C sm
2,0 = Vert(f2) consists of isolated, smooth
points of C1, the curve W is also connected. In the dual graph G of C the
open subcurve W ⊂ C corresponds to the copy of the dual graph G1 of C1.
The degrees with which the components map can easily be seen: the ﬁrst
two components of \f2 ◦ f1 agree with the map f1 on W ⊂ C1. The last

COMPACTIFICATION OF SELF-MAPS SPACE OF CP1 USING STABLE MAPS

49

component is the composition

W

φ1−→ P1 \ Vert(f2)

π−1
2−−→ C sm
2,0

φ2−→ P1.

Thus, on each irreducible component of W , the degree of this composition
is equal to the degree of φ1 on this component times the degree of φ2 on
C2,0, as claimed.

Now consider the subsets Uj coming from cartesian diagrams

Uj −−−−→ C2

π2


P1

y


C sm
1,j −−−−→

y
= C sm

φ1

1,j

On the complement C sm,nc
1,j \ {p : dφ1|p = 0} of its critical points,
the map φ1 is ´etale. Similarly, on the smooth points C sm
2,0 of the horizontal
component of C2 the map π2 is an open embedding, so also ´etale. By
condition (P1) the preimages of these sets in Uj cover Uj, because a critical
point in C sm
1,j mapping by φ1 to an element in q ∈ Vert(f2), would give a non-
reduced point in φ−1
1 ({q}). Because the properties of being reduced and of
dimension 1 ascend along ´etale morphisms (see [Sta14, Tag 034E,Tag 04N4
]), Uj has these two properties. Note also that the property of having at
worst nodal singularities can be checked in an analytic neighborhood. As φ1
is a local isomorphism around all points in Vert(f2), the curve Uj inherits
this property from C2.

Now we come to the global geometry of Uj: over the points in P1\Vert(f2),
we obtain a copy of an open subset of C sm
1,j , sitting inside of the curve W
above. Over each point q ∈ Vert(f2) there sits a unique tree of P1s as
the preimage under π2 and a number of d1,j smooth, reduced points as the
preimage under φ1 by condition (P1). Thus d1,j copies of this tree are glued
to C sm
1,j at these preimages. This exactly corresponds to the operation on
the dual graph G described above and also the stated degrees of \f2 ◦ f1
are immediate from this description. As this subgraph of the dual graph is
connected and as all components of Uj have genus 0, we are done with the
ﬁrst part of the proof.

Now assume that also (P2) and (P3) hold. By (P2), for every j ∈
{1, . . . , n1} there is a unique point c2,j ∈ C2 lying on the horizontal com-
ponent of C2 such that
p1,j = (p1,j, c2,j) ∈ C, that is φ1(p1,j) = π2(c2,j).
Similarly, (P3) implies that for every marking p2,k of C2, the preimage
φ−1
1 (π2(p2,k)) consists of d1 distinct smooth points c1
1,k. We set
2,k = (cl
pl
1,k, p2,k) for l = 1, . . . , d1. By construction and by (P2), all these
n1 + d1n2 markings are pairwise distinct.
Now consider the map \f2 ◦ f1. To see that it is stable, note that we can
b
easily see on the dual graph G of C where the markings are placed: for a
p1,j remains
marking p1,j on the vertex V1,j′ of G1, the corresponding mark

1,k, . . . , cd1

b

b

50

JOHANNES SCHMITT

on the induced vertex V1,j′ of the graph G. For any marking p2,k lying on
the root vertex V2,0 of C2, every vertex V1,j of G coming from G1 receives a
pd1
p1
number of d1,j of the markings from the set {
2,k}. For all markings
2,k, . . . ,
pl
2,k lie on the d1 copies
p2,k on a vertex V2,j with j > 0, the induced markings
of V2,j on the trees glued to the vertices coming from G1.
b
b

With this, we can check that \f2 ◦ f1 is indeed stable, looking at all the
vertices of G. For those coming from G1 it is clear that they are stable,
because the ﬁrst two components of their degree as well as any markings
they had in G1 are inherited from G1. On the other hand, all remaining
vertices come from vertices in G2 and the second two components as well
as the markings are inherited from this graph. Hence, all vertices of G are
stable.

b

For the total degree of the graph note that the ﬁrst two components of
the degree are simply inherited from G1 on the corresponding subgraph of
G (and 0 outside of this subgraph), so we get (1, d1) here. For the last com-
ponent we have on the one hand the vertices V1,j from G1, which contribute
their old degree d1,j times d2,0, so a total of d1d2,0. On the other hand, for
every vertex V2,j with j > 0 we have d1 copies of this vertex contributing
d2,j each, so a total of

r2

d1d2,j = d1(d2 − d2,0).

Together we exactly have a degree of d1d2.

Xj=1

among the pl

The fact that the markings on C only depended on the choices of ordering
2,k for every k is clear. Hence, the rest of the statement follows.
(cid:3)

By the discussion preceding the Lemma above, we see that for n1 = n2 = 0
and for C1, C2 irreducible (that is f1 ∈ Ratd1, f2 ∈ Ratd2), the map f2 ◦ f1
is exactly the composition of f2 with f1 (seen as maps P1 → P1).

Now that we understand how to compose two elements of Yd1,n1 and
Yd2,n2, we can deﬁne a composition morphism on a suitable open subset of
Yd1,n1 × Yd2,n2. However, for simplicity we will restrict ourselves to the case
n2 = 0 below (see also Remark 5.6).

Theorem 5.5. Let d1, d2, n1 ≥ 0 and let U ⊂ Yd1,n1 × Yd2,0 be the set of
pairs (f1, f2) satisfying the conditions (P1), (P2) from Lemma 5.3. Then U
is open with complement of codimension at least 2 and the map

c : U → Yd1d2,n1
(f1, f2) 7→ f2 ◦ f1

is an algebraic morphism. It is an extension of the natural morphism

Yd1,n1 × Yd2,0 ⊃ Ratd1 ×

(cid:0)

(P1)n \ ∆
(P1)n \ ∆
× Ratd2 → Ratd1d2 ×
(φ1, p1, . . . , pn, φ2) 7→ (φ2 ◦ φ1, p1, . . . , pn).

(cid:0)

(cid:1)

(cid:1)

COMPACTIFICATION OF SELF-MAPS SPACE OF CP1 USING STABLE MAPS

51

Proof. To show that U is open, we will prove that the points (f1, f2) violating
conditions (P1), (P2) form closed subsets of Yd1,n1 × Yd2,0, respectively. Let

(π1,φ1)
−−−−→ P1 × P1

C1

F


Yd1,n1

y
be the universal curve2 over Yd1,n1 and consider the map

e : C1 × Yd2,0 → Yd2,0 × P1, (c, f2) 7→ (f2, φ1(c)).

Then the preimage V of the closed set Vertd,n ⊂ Yd2,0 × P1 from Lemma 5.2
under e is closed and consists of those (c, f2) with φ1(c) ∈ Vert(f2).

Secondly, the set N ⊂ C1 of c such that c is a node of the curve (C1)F (c)
is closed. Finally, away from N , the relative dualizing sheaf ωC1/Yd1,n1
is a
line bundle and the set R of c ∈ C1 \ N such that dφ1|c = 0 is the vanishing
set of a section of

, so it is closed in C1 \ N .

1Ω1
φ∗
P1
Now the set of all pairs (c, f2) such that c ∈ φ−1
(cid:1)

1 (Vert(f2)) is not a reduced,
smooth point of (C1)F (c) is exactly V ∩ (N × Yd2,0 ∪ R × Yd2,0), and thus
closed. The locus of points (f1, f2) ∈ Yd1,n1 × Yd2,0 violating (P1) is the
image of this set under the proper map F × idYd2,0 and hence also closed.

∨ ⊗ ωC1/Yd1,n1

(cid:0)

The set of points in Yd1,n1 × Yd2,0 violating (P2) is the union of the preim-

ages of V under the morphisms

σj × id : Yd1,n1 × Yd2,0 → C1 × Yd2,0

for j = 1, . . . , n1, and hence also closed.

For the codimension of the complement of U , note that for (f1, f2) ∈
Yd1,n1 × Yd2,0 \ U to violate (P1), we need f2 to be in the boundary of Yd2,0,
giving codimension 1 already. For a ﬁxed such f2 a generic f1 = (π1, φ1)
will satisfy that all preimages of q ∈ Vert(f2) under φ1 are reduced, smooth
points. Similarly, for condition (P2) to be violated, the map f2 must be in
the boundary and as φ−1
1 (π2(Vert(f2))) is a ﬁnite set for a generic φ1 ∈ Ratd1,
a generic choice of the markings p1,j will satisfy (P2).

To ﬁnish the proof, we need to show that c : U → Yd1d2,n1 is an alge-
braic morphism. To do this, we will construct a family of stable maps in
Yd1d2,n1(U ) inducing c. Let

Ci

(πi,φi)
−−−−→ P1 × P1

Fi


Ydi,ni

y

2Here we mean Yd1,n1+1 with F the forgetful map of the (n + 1)-st marking.

52

JOHANNES SCHMITT

be the universal families3 over Yd1,n1, Yd2,0 (with n2 = 0) and let

σ1, . . . , σn1 : Yd1,n1 → C1

be the sections of F1 corresponding to the markings. We deﬁne

C = C1 ×φ1,P1,π2 C2 = {(c1, c2) ∈ C1 × C2 : φ1(c1) = π2(c2)}.

This maps to (P1)3 via

µ : C → P1 × P1 × P1
(c1, c2) 7→ (π1(c1), φ1(c1)

, φ2(c2)).

=π2(c2)

Moreover, there is the map F = F1 × F2 : C → Yd1,n1 × Yd2,0. Over U , we
σn1 of F corresponding to markings of
now want to deﬁne sections
our family of stable maps. Let

σ1, . . . ,

| {z }

s : Yd2,0 × P1 \ Vertd2,0 → Yd2,1 = C2
b
be the map from Lemma 5.2. For j = 1, . . . , n1 consider

b

γj : U → Yd2,0 × P1 \ Vertd2,0
(f1, f2) 7→ (f2, (φ1 ◦ σj)(f1)).
The fact that γj indeed has image outside of Vertd2,0 is exactly guaranteed
by condition (P2). Thus the composition s ◦ γj has values in C2 and we
deﬁne

σj = σj × (s ◦ γj) : U → C1 × C2.

One checks that the map
5.2. It actually has image in C ⊂ C1 × C2 because

b

σj is a section of F1 × F2 over U by using Lemma

π2 ◦ s ◦ γj = φ1 ◦ σj.
Here again we use that s is a section of the map

b

E = F2 × π2 : C2 → Yd2,0 × P1.

We now show that the data

F = (F : C|U → U ;

σ1, . . . ,

σn1; µ)

gives a well-deﬁned element of M0,n1(P1 × P1 × P1, (1, d1, d1d2))(U ) which
agrees with \f2 ◦ f1 over a geometric point (f1, f2) ∈ U . Then we are done,
because by [BM96, Theorem 3.6], we can push forward this family via the
projection (P1)3 → (P1)2 on ﬁrst and third factor, obtaining an element in
Yd1d2,n1(U ) as desired. Fibrewise, this corresponds to composing µ with the

b

b

3This is a bit unprecise, as of course Ydi,ni is not a ﬁne moduli space. Here is what
we actually do: over the smooth DM-stacks Ydi,ni we do have a universal family. This we
pull back under a smooth, surjective morphism ˜Ydi,ni → Ydi,ni from a smooth, ﬁnite type
scheme ˜Ydi,ni . Afterwards we proceed as indicated in the proof, constructing a morphism
from a suitable open subset of ˜Yd1,n1 × ˜Yd0,0 to Yd1d2,n1 . By descent, we obtain a map
deﬁned on an open substack U of Yd1,n1 × Yd0,0. This factors through the corresponding
open subset U of its coarse moduli space.

COMPACTIFICATION OF SELF-MAPS SPACE OF CP1 USING STABLE MAPS

53

projection above and then stabilizing. But this is exactly the procedure by
which we obtained f2 ◦ f1 from \f2 ◦ f1. Hence we obtain the desired family
in Yd1d2,n1(U ) and the proof is ﬁnished.

The map F is projective, because F1, F2 were projective and we precom-
pose F1 × F2 with the closed embedding C ֒→ C1 × C2. By Lemma 5.3,
over a geometric point f = (f1, f2) ∈ U , the ﬁbre Cf of F is an n1-pointed,
genus 0 quasi-stable curve and the restriction of µ makes it a stable map
of degree (1, d1, d1d2). This shows everything except that the family π is
ﬂat. But observe that U , C1 × C2 are smooth (see the footnote 3 above)
and C ⊂ C1 × C2 is an eﬀective Cartier divisor, namely the pullback of the
diagonal ∆ ⊂ P1 × P1 under the surjective morphism

C1 × C2

(φ1,π2)
−−−−→ P1 × P1.

Hence C is Cohen-Macaulay and equidimensional. Then by the Miracle
ﬂatness theorem ([Mat89, Theorem 23.1]), the map F is ﬂat over U , as all
(cid:3)
ﬁbres are of dimension 1.

Remark 5.6. In Lemma 5.3, we clearly have laid the foundations for also
deﬁning a composition morphism on a subset of Yd1,n1 × Yd2,n2, with target
Yd1d2,n1+d1n2/(Sd1)n2. However, handling this would force us to deal with
the codimension 1 condition that two preimages of a marked point on f2
under φ1 come together. Furthermore, we would need to parametrize these
preimages with sections, up to ordering. As this introduces more technical
complications in an already quite technical proof, and as we are not going
to use it in the future, we have omitted this. However, it could be of in-
terest, as these d1n2 new markings are essentially the preimage in C1 of
the n2 markings on the curve C2. In connection with the self-composition
morphisms below, this could be used to study backward orbits of marked
points.

We have now an explicit description of the rational map c : Yd1,n1 ×
Yd2,0 99K Yd1d2,n1, deﬁned away from a codimension 2 locus in the domain.
Note that because the spaces Ydi,ni have ﬁnite quotient singularities, every
Weil-divisor is Q-Cartier. Using also that they are rational (as they contain
the rational open subvarieties Ratdi ×

(P1)ni \ ∆

), we have

Pic(U ) ⊗Z Q = Cl(U ) ⊗Z Q = Cl(Yd1,n1 × Yd2,0) ⊗Z Q
= Pic(Yd1,n1 × Yd2,0) ⊗Z Q
= Pic(Yd1,n1) ⊗Z Q ⊕ Pic(Yd2,0) ⊗Z Q.

(cid:0)

(cid:1)

Thus it makes sense to study the pullback-morphism

c∗ : Pic(Yd1d2,n1) ⊗Z Q → Pic(Yd1,n1) ⊗Z Q ⊕ Pic(Yd2,0) ⊗Z Q

and to express it in terms of the generators found in Theorem 4.4. For
handling the pullbacks of the boundary divisors, we will use the resultant.

54

JOHANNES SCHMITT

Recall from Section 2.1 the space

Zd = P(H 0(P1 × P1, O(d, 1)))
parametrizing pairs [(F, G)] of homogeneous polynomials of degree d up to
simultaneous scaling. The space Ratd ⊂ Zd is the locus where F, G do
not have a common root. This condition can be expressed in terms of
the resultant Res(F, G). Going to aﬃne coordinates, it has a very handy
description in terms of the roots of F, G. Assume these polynomials are
given by

F (x, 1) = λ(x − a1) · · · (x − ad), G(x, 1) = µ(x − b1) · · · (x − bd).

Then

Res(F, G) = (λµ)d

(ai − bj).

d

Yi,j=1

One checks that this is a homogeneous polynomial of degree 2d in the co-
eﬃcients of F, G. Hence it gives a section Res ∈ H 0(Zd, OZd(2d)), which
vanishes exactly on the locus where one of the ai equals one of the bj, i.e.
where F, G have a common root.

Now recall the map

j : Yd,n → Zd = P(H 0(P1 × P1, O(d, 1)))
from Lemma 2.6. Pulling back Res via j gives us a section

j∗Res ∈ H 0(Yd,n, j∗OZd(2d)),
which vanishes exactly on the boundary divisors DB,k for k ≥ 1. We will
now see which multiplicities it has on these divisors.

Lemma 5.7. Let d, n ≥ 0, then with notation as above, we have

(20)

div(j∗Res) =

k2DB,k,

X(B,k)

where the sum runs over all pairs (B, k) giving boundary divisors DB,k in
Yd,n.
Proof. We know that div(j∗Res) is supported on the boundary divisors DB,k
with k ≥ 1, so it remains to check the multiplicity is k2. To determine this
multiplicity, we can use our test curves CB,k from Proposition 4.7. Recall
that these were the image cycles of maps ψB,m : P1 → Yd,n such that over
[x : 1] ∈ P1 \ {0} the induced rational map was given by

φx(z) =

(z − a1) . . . (z − ad−k)(z − b1x) . . . (z − bkx)
(z − c1) . . . (z − cd−k)(z − d1x) . . . (z − dkx)

for ai, bj, ci, dj ∈ C, i = 1, . . . , d − k, j = 1, . . . , k suﬃciently general. We
have then seen, that the corresponding map ψB,k : P1 → Yd,0 intersects
DB,k transversally over the point [0 : 1]. Hence the multiplicity of DB,k in

COMPACTIFICATION OF SELF-MAPS SPACE OF CP1 USING STABLE MAPS

55

div(j∗Res) is exactly the order of vanishing of Res ◦ j ◦ ψB,k at [0 : 1]. This
is

ordx=0Res(j(ψB,k(x)))

=ordx=0

(ai − cj)

(ai − djx)

(bix − cj)

(bix − djx)

Y1≤i≤d−k
1≤j≤d−k

Y1≤i≤d−k
1≤j≤k

Y1≤i≤k
1≤j≤d−k

Y1≤i≤k
1≤j≤k

=k2.

This ﬁnishes the proof.

(cid:3)

We see above that the resultant cuts out all the boundary divisors DB,k
for k ≥ 1. However, using the evaluation maps, we can also cut out the
remaining divisors DB,0.

Lemma 5.8. Let d ≥ 0, n ≥ 2 and let 1 ≤ i, j ≤ n with i 6= j. Then for the
map

ei,j = (π1 ◦ evi) × (π1 ◦ evj) : Yd,n → P1 × P1

we have

e∗
i,j∆P1 =

DB,k,

where we mean pullback in the sense of pullback of pseudo-divisors (cf.
[Ful98, Section 2.2]).

Xk,B∋i,j

Proof. It is clear that the preimage of the diagonal ∆P1 is exactly the union
of the DB,k with i, j ∈ B. To see that all multiplicities are 1, note that the
curves CB,k intersect DB,k transversally in exactly two points. On the other
hand, the diagonal ∆P1 is of class O(1, 1) in Pic(P1 × P1). Thus its pullback
by ei,j is of class Hi,1 + Hj,1. But the intersection of CB,k with this is also
i,j∆P1 must be exactly 1. (cid:3)
exactly 2. Hence the multiplicity of DB,k in e∗

Proposition 5.9. For 1 ≤ i ≤ n1 we have

c∗Hi,1 = (Hi,1, 0),
c∗Hi,2 = (d2Hi,2, Dp),

where Dp is the divisor from Proposition 4.16.

On the other hand for a boundary divisor DB,k on Yd1d2,n1 we have

c∗DB,k = (DB,l, 0)

+ (0, d1D∅,k)

.

for k=d2l

for 0<k≤d2,B=∅

Finally, for d1 = 0 we have

{z

}
|
c∗G = (d2G, Dp).

|

{z

}

For d2 = 0 we obtain

c∗G = (0, G).

56

JOHANNES SCHMITT

Proof. Our general strategy will be to determine both components of the
pullback divisors separately. This is done by restricting c to slices {f1}×Yd2,0
and Yd1,n1 × {f2} for f1 ∈ Yd1,n1 and f2 ∈ Yd2,0, and then pulling back.

For the divisors Hi,j = ev∗

i,jO(1) coming from the evaluation maps

evi = (evi,1, evi,2) : Yd1d2,n1 → P1 × P1

we see that for

f1 = ((π1, φ1) : C1 → P1 × P1; p1, . . . , pn) ∈ Yd1,n1
f2 = ((π2, φ2) : C2 → P1 × P1) ∈ Yd2,0

with φ1(pi) /∈ Vert(f2), we have

evi(c(f1, f2)) = (π1(pi), φ2(π−1
Hence (evi,1 ◦ c)(f1, f2) = evi,1(f1), so c∗Hi,1 has the claimed form.

2 (φ1(pi)))).

For c∗Hi,2 we apply the strategy described at the beginning of the proof:
for f2 ∈ Ratd2 a ﬁxed degree d2 map, we see evi,2(c(f1, f2)) = (f2 ◦evi,2)(f1).
2 O(1) = O(d2), we obtain d2Hi,2 in the ﬁrst component of c∗Hi,2. On
As f ∗
the other hand, for f1 ﬁxed, the position φ1(pi) is ﬁxed and for q ∈ P1 ﬁxed,
the set

evi,2 ◦ c|{f1}×Yd2,0
(cid:16)

(cid:17)

−1

({q})

is exactly the locus of f2 ∈ Yd2,0 mapping φ1(pi) to q, and thus represents
the divisor class Dp.

The computation of the pullbacks of G is similar (after all, for d1 = 0, n1 >

0 we have G = H1,2) and will be omitted.

Now for the pullbacks of the boundary divisors DB,k note that if both
f1, f2 have smooth source curves C1, C2, then the source curve of f2 ◦ f1 is
smooth too. Thus the pullback of DB,k is supported on the boundaries of
Yd1,n1 and Yd2,0 in Yd1,n1 × Yd2,0.

For f1 ∈ DB,l and f2 ∈ Ratd2, the composition f2 ◦ f1 has exactly one
vertical component of degree d2l with the markings in B on it. If f1 has
smooth source curve and f2 ∈ D∅,l then f2 ◦ f1 has d1 vertical sections of
degree l. It remains to show that in the ﬁrst case the multiplicity of DB,l in
c∗DB,d2l is 1 and in the second case the multiplicity of D∅,k in c∗D∅,k is d1.
To show this, we are going to use our test curves CB,m (see also the proof

of Lemma 5.7).

For the ﬁrst case ﬁx f2 = (z 7→ zd2 ). Assume ﬁrst that d2l > 0, then
by Lemma 5.7 the divisor DB,d2l appears with a coeﬃcient of (d2l)2 in
div(j∗Res). Now let f1 vary along the test curve ψB,l : P1 → Yd1,n1. Then
the rational map induced by f2 ◦ f1 over x ∈ C is

z 7→

(z − a1) . . . (z − ad−l)(z − b1x) . . . (z − blx)
(z − c1) . . . (z − cd−l)(z − d1x) . . . (z − dlx)
Over x = 0 the zeroes b1x, . . . , blx of the numerator converge to the zeroes
d1x, . . . , dlx of the denominator, and all zeroes now have multiplicity d2.

(cid:19)

(cid:18)

.

d2

COMPACTIFICATION OF SELF-MAPS SPACE OF CP1 USING STABLE MAPS

57

Thus the resultant vanishes to order

ordx=0

(bix − cjx)d2

2 = d2

2l2.

As this is the same as the multiplicity of DB,d2l in div(j∗Res), the multiplic-
ity of DB,l in c∗DB,d2l is 1.

Y1≤i,j≤l

If d2l = 0 we make a similar argument, but now use Lemma 5.8. For
)∗∆P1 with multiplicity 1 and
Yd1,n1
,
i,j

Y0,n1
i, j ∈ B we have that DB,0 appears in (e
i,j
Yd1,n1
)∗∆P1. But e
i,j

Yd1d2,n1
i,j

◦ c = e

that DB,l also has multiplicity 1 in (e
so DB,l has multiplicity 1 in c∗DB,0.

Now ﬁx f1 ∈ Yd1,n1 as the rational map z 7→ zd1 with markings in general
position and vary f2 along ψ∅,k, then the rational map induced by f2 ◦ f1 is

φx(z) =

(zd1 − a1) . . . (zd1 − ad−k)(zd1 − b1x) . . . (zd1 − bkx)
(zd1 − c1) . . . (zd1 − cd−k)(zd1 − d1x) . . . (zd1 − dkx)

.

At x = 0 the d1l zeroes (bix)1/d1 ρj, i = 1, . . . , l, ρ a d1-th root of unity,
j = 0, . . . , d1 − 1, come together with the d1l zeroes (dkx)1/d1 ρm of the
denominator. Thus over x = 0 the resultant vanishes to order

ordx=0

((bix)1/d1 ρj − (dkx)1/d1 ρm) =

Y1≤i,k≤l
1≤j,m≤d1

1l2
d2
d1

= d1l2.

As on Yd1d2,n1 the resultant vanished to order l2 along D∅,l, the multiplicity
(cid:3)
of D∅,k in c∗D∅,k is d1.

5.2. Self-composition and multiplier loci. We can now apply the results
from the last section to our moduli spaces of self-maps. Indeed, the rational
map

scm : Yd,n

id×Qm−1
−−−−−−−→ Yd,n ×

i=0 F

m−1

Yd,0

c×id99K Yd2,n ×

m−2

Yd,0 · · ·

c×id99K Ydm,n

Yi=1

Yi=1

is G-equivariant. Here F is the map Yd,n → Yd,0 forgetting all markings. For
d = (d|d1, . . . , dn) admissible, it thus induces a rational map of quotients
scm : M (d|d1, . . . , dn) 99K M (dm|d1, . . . , dn).
On the open locus in M (d|d1, . . . , dn) of maps from a smooth curve to itself,
this is given by

(φ : C → C; p1, . . . , pn) 7→ (φ◦m : C → C; p1, . . . , pn).
As a rational map from a normal to a projective variety is deﬁned away from
a set of codimension at least 2, it makes sense to pull back divisor classes on
M (dm|d1, . . . , dn). In the following Proposition, scm can either denote the
rational map Yd,n 99K Ydm,n or the induced map of the quotients. Because
of the usual isomorphisms of rational Picard groups, it will suﬃce to prove
it for the former.

58

JOHANNES SCHMITT

Proposition 5.10. Let m ≥ 1. For 1 ≤ i ≤ n1 we have

sc∗

mHi,1 = Hi,1,

sc∗

mHi,2 = dm−1Hi,2 +

m−2



Dp,

dj





Xj=0
where Dp is the divisor from Proposition 4.16.



On the other hand for a boundary divisor DB,k on Yd1d2,n1 we have

sc∗

mDB,k = DB,l, for B 6= ∅, k = dm−1l

and sc∗

mD∅,k can inductively be computed by

sc∗

mD∅,k = dm−1

DB,k

+ sc∗

m−1D∅,l

,

XB
for k=1,...,d

sc∗

1D∅,k = D∅,k.

|

{z

}

for k=dl,l≥1

|

{z

}

Finally, for d = 0 we have

sc∗

mG = G.

Proof. Note that the map scm factors as

Yd,n

scm−1×F
−−−−−−→ Ydm−1,n × Yd,0

c
−→ Ydm,n.

We can thus show the formulas above in a simultaneous induction on m.
We ﬁrst recall the pullbacks of all divisors above under c:

Ydm−1,n × Yd,0
(Hi,1, 0)
(dHi,2, Dp)
+ (0, dm−1D∅,k)

c
−→ Ydm,n
7→ Hi,1
7→ Hi,2

7→ DB,k

(DB,l, 0)

for k=dl

for B=∅,k≤d

{z
Note also F ∗(Dp) = Dp. Then the formulas for m = 1 are immediate as
(cid:3)
sc1 = id and the induction step follows from the factorization above.

|

{z

}

|

(0, G)
}

7→ G.

We are going to apply these results by deﬁning another divisorial locus in
M (d|d1, . . . , dn) and computing its class in the rational Picard group. This
locus will be induced from a G-invariant locus on Yd,n, so we will work on
this space instead.

For ϕ : P1 → P1, a point p ∈ P1 is called of period m if ϕ◦m(p) = p. We
say that p is of strict period m if ϕ◦k(p) 6= p for all 1 ≤ k < m. For a point
p of period m, it makes sense to interpret the diﬀerential of ϕ◦m at p as a
complex number λ (because dϕ◦m : TpP1 → TpP1 is given by multiplication
with some λ ∈ C). We call λ the multiplier of ϕ at p.

COMPACTIFICATION OF SELF-MAPS SPACE OF CP1 USING STABLE MAPS

59

Given a ﬁxed λ ∈ C, we denote by

Per∼

m(λ) = {ϕ ∈ Ratd : ϕ has a point p of period m with multiplier λ}.

It is easy to see that this locus is a closed subset of codimension 1.
In
the following, we are going to decompose it into several components, cor-
responding to diﬀerent orbit types, and associate natural multiplicities to
these components.

Given a degree d map ϕ ∈ Ratd, we associate to it the normed polynomial

(21)

Ψd(ϕ, µ) =

(µ − ξj) = µd+1 + σ1(ϕ)µd + . . . + σd+1(ϕ),

d+1

Yj=1

whose zeroes ξ1, . . . , ξd+1 are exactly the multipliers at the ﬁxed points of ϕ
(ﬁxed points counted with multiplicities). Note that the ξj are only deﬁned
up to reordering, but the σi are (up to a sign) the elementary symmetric
polynomials in the ξj and thus are well-deﬁned. Even more, in [Sil98, Propo-
sition 4.2] it is shown that the σi are algebraic on Ratd. This is done by
interpreting the function Ψd(−, µ) as the determinant of an endomorphism
on a vector bundle on Ratd, a construction we will recall in the proof of
Proposition 5.12.

From the deﬁnition, it is immediate that

Per∼

1 (λ) = V (Ψd(−, λ)),

which shows that Per1(λ) is in a natural way a closed subscheme of Ratd.
Using the self-composition morphism scm : Ratd → Ratdm one sees that

Per∼

m(λ) = V (sc∗

mΨdm(−, λ)) = sc−1

m (Per∼

1 (λ)).

This induces a scheme structure on Per∼
m(λ), which however will not be
reduced in general. For d = 2, Milnor deﬁnes in the paper [Mil93] closely
related subvarieties of M2 = Rat2//PGL2. His construction immediately
generalizes to the case of general d and can be carried out on Ratd.
In
the following, we want to relate the two constructions. We will denote by
Pm(λ) ⊂ Ratd the loci of points of strict period m deﬁned by Milnor and
now recall their construction.

First note that a ﬁxed point of ϕ◦m is exactly a periodic point for ϕ with
mΨdm(−, λ) on Ratd

a strict period n dividing m. Hence the function sc∗
naturally decomposes into a product

Ψdm(scm(ϕ), λ) =

Gn(ϕ, λ),

Yn|m

where in Gn we collect all the factors λ − ξ for ξ a multiplier at a point
of strict period n. One sees immediately, that on an orbit p0 = p, p1 =
ϕ(p), . . . , pm−1 = ϕ◦m−1(p) of a point of strict period m, all the pi are
also of period m and have the same multiplier as p. Hence for ϕ ﬁxed, all
roots of Gm(ϕ, λ) occur with multiplicity divisible by m and we can write

60

JOHANNES SCHMITT

Gm(ϕ, λ) = ˜Gm(ϕ, λ)m. One can see that for ﬁxed λ, the function ˜Gm(ϕ, λ)
depends algebraically on ϕ ∈ Ratd and Milnor deﬁnes

Pm(λ) = V ( ˜Gm(−, λ)).

In the following Proposition, denote by [V ] the algebraic cycle associated to
a subscheme V ⊂ X of a scheme X.

Proposition 5.11. For d, m ﬁxed integers and λ ∈ C \ {0} we have

[Per∼

m(λ)] =

n[Pn(µ)] ∈ Zcodim=1(Ratd).

Xn|m Xµm/n=λ

Proof. By the discussion above, it is clear that [Per∼
m(λ)] is an algebraic cycle
supported on the union of codimension 1 subvarieties of Ratd on the right
side. It remains to compare the multiplicities. Note that the case m = 1 is
trivial, as here the deﬁnition of Per∼
1 (λ) and P1(λ) agree. For general m, we
will ﬁrst argue that it suﬃces to check the multiplicity at the terms n = 1
and n = m.

Indeed, assume we know that in [Per∼

m(λ)] the coeﬃcient of [P1(µ)] is
1 (for µm = λ) and the coeﬃcient of [Pm(λ)] is m. Then for any n|m,
the map scm factors as scm/n ◦ scn. The elements of Pn(µ) for µm/n = λ
1 (µ) under scn and then by scm/n to Per1(λ). But by
map to P1(µ) = Per∼
assumption, [P1(µ)] appears with a coeﬃcient 1 in sc−1
1 (λ)) and in
turn Pn(µ) appears with a coeﬃcient of n in sc−1
n (Per∼

m/n(Per∼
1 (µ)), as desired.

Now for the Pm(λ) we note that they were deﬁned by the equation
˜Gm(−, λ), whereas in the deﬁning equation Ψdm(scm(−), λ) of Per∼
m(λ), the
factor vanishing on the support of Pm(λ) is Gm(−, λ) = ˜Gm(−, λ)m. This
explains the coeﬃcient m.

As for the coeﬃcient of P1(µ) with µm = λ, the corresponding factor of the
function Ψdm(scm(−), λ) vanishing on it is G1(−, λ). Given ϕ ∈ Ratd having
ﬁxed points p1, . . . , pd+1 with multipliers ξ1, . . . , ξd+1, the multipliers of ϕ◦m
at the pi are ξm
d+1 and those are exactly the multipliers contributing
to G1(ϕ, λ). For some primitive m-th root of unity ρ we thus have

1 , . . . , ξm

d+1

G1(ϕ, λ) =

λ − ξm

j =

µm − ξm
j

d+1

Yj=1

µρi − ξj

Yj=1
m−1

d+1

Yi=0
m−1

Yj=1

=

=

Ψd(ϕ, µρi).

Yi=0

Hence, all the loci Per∼
[Per∼
m(λ)] as claimed.

1 (µρi) = V (Ψd(−, µρi)) appear with multiplicity 1 in
(cid:3)

COMPACTIFICATION OF SELF-MAPS SPACE OF CP1 USING STABLE MAPS

61

Now we will extend the deﬁnition of Per∼

m(λ) to all of Yd,0 (and Yd,n).

Consider the diagram

Yd,n+1

evn+1=(µ,ϕ)
−−−−−−−−→ P1 × P1

π


Yd,n

y

where we interpret Yd,n+1 as the universal curve over Yd,n. Note that on
d,n this actually is the universal curve, as the elements (f : P1 →
the locus Y o
P1 × P1; p1, . . . , pn) ∈ Y o
d,n do not have automorphisms. The diﬀerential of
evn+1 induces two sections

dµ ∈ Hom(µ∗ΩP1, ωπ),
dϕ ∈ Hom(ϕ∗ΩP1, ωπ).
On the preimage Fix = ev−1
n+1(∆P1) of the diagonal ∆P1 ⊂ P1 × P1, the
bundles µ∗ΩP1, ϕ∗ΩP1 coincide. Hence it makes sense to take the vanishing
set V = V ((dϕ − λdµ)|Fix) ⊂ Fix. Denote by

Per1(λ) = π∗[V ] ∈ Zcodim=1(Yd,n)

the pushforward under π of the algebraic cycle associated to V . By construc-
tion, the support |Per1(λ)| of this eﬀective divisor is the locus of ((f1, f2) :
C → P1 × P1; p1, . . . , pn) ∈ Yd,n such that there exists p ∈ C with f1(p) =
f2(p) and df2|p = λdf1|p. Thus clearly in the case n = 0 we have

|Per1(λ)| ∩ Ratd = Per∼

1 (λ)

as sets.

We can generalize this construction for m-periodic points. Consider the
pullback C of the forgetful map Ydm,n+1 → Ydm,n via the rational map scm.

C

π′

Yd,n

Ydm,n+1

evn+1

P1 × P1

scm

π

Yd,n

As above, denote by µ, ϕ the components of the map C → P1 × P1, then
on Perm = (µ, ϕ)−1(∆P1) we can consider the vanishing set V = V ((dϕ −
λdµ)|Perm) and push it forward via π′ to obtain

Perm(λ) = π′

∗[V ] ∈ Zcodim=1(Yd,n).

Note that here we use that scm is deﬁned away from a codimension 2 locus
in Yd,n. Again for n = 0 we have

|Perm(λ)| ∩ Ratd = Per∼

m(λ).

In the following Proposition, we check various compatibility conditions be-
tween these cycles and compute their class in the rational Picard group of

62

JOHANNES SCHMITT

Yd,n. Note that as the spaces Yd,n have ﬁnite quotient singularities, all Weyl-
divisors D are Q-Cartier and thus it makes sense to speak of pullback ofD
under maps X → Yd,n not having image inside D.

Proposition 5.12. Let λ ∈ C \ {0}. For the forgetful map F : Yd,n → Yd,0
we have

(22)
For the rational self-composition map scm : Yd,n 99K Ydm,n we have

F ∗Perm(λ)Yd,0 = Perm(λ)Yd,n.

(23)

sc∗

mPer1(λ)Ydm,n = Perm(λ)Yd,n.

In the case n = 0 we have

(24)

Perm(λ)|Ratd = [Per∼

m(λ)] ∈ Zcodim=1(Ratd).

For the rational divisor class of Perm(λ) we have

Perm(λ) = mdm−1

kDB,k ∈ Acodim=1(Yd,n) ⊗Z Q = Pic(Yd,n) ⊗Z Q,

where the sum runs over all boundary divisors DB,k of Yd,n.

Xk,B

Proof. In each of the equations (22 - 24), the divisors on the left and right
side are supported on the same closed sets. Therefore, it suﬃces to check
that for each irreducible component of these sets, the multiplicities of the
divisors agree. As also none of the divisors have components supported in
the boundary of Yd,n, we can compute these multiplicities on the complement
Y o
d,n of the boundary. Note that once we show equations (22) and (24), the
equation (23) follows as by deﬁnition Per∼

m(λ) = sc−1

m (Per1(λ)).

Let P = ((P1)n \ ∆), then Y o
d,n

∼= Ratd × P . Then restricted to Y o

dm,n, the

diagram for deﬁning Perm(λ) looks like

Ratd × P1 × P −−−−→ Ratdm × P1 × P

ev

−−−−→ P1 × P1

π′

π


Ratd × P

y

scm−−−−→ Ratdm × P



y

We then take the preimage Perm of ∆P1 under the upper map

(µ, ϕ◦m) : (ϕ, p, p1, . . . , pn) 7→ (p, ϕ◦m(p)),
take the vanishing set of the restricted section (dϕ◦m − λdµ)|Perm and push
forward via π′. First we note that the factor P does not play any role in
these operations, so we may as well leave it out. This shows equation (22).
Note that Perm is a relative Cartier divisor for the projection map p :
Ratd × P1 → Ratd. Hence the map π′ is ﬂat and clearly also ﬁnite. Instead
of considering s = dϕ◦m − λdµ|Perm as a section of Hom(µ∗ΩP1, ωp) we
precompose with the inverse of the isomorphism dµ : µ∗ΩP1 → ωp and
obtain a section

s ◦ (dµ)−1 = dϕ◦m ◦ (dµ)−1 − λ : ωp → ωp.

COMPACTIFICATION OF SELF-MAPS SPACE OF CP1 USING STABLE MAPS

63

Then by Lemma B.4, we have π′
(dµ)−1 − λ))]. But

∗([V (dϕ◦m ◦ (dµ)−1 − λ)]) = [V (det(dϕ◦m ◦

det(dϕ◦m ◦ (dµ)−1 − λ) = Ψdm(ϕ◦m, λ),

so the vanishing scheme of this section is exactly Per∼
Theorem 4.5]). This shows (24).

m(λ) (see also [Sil98,

To compute the class of Perm(λ) , by (22) it suﬃces to show the formula
above for n = 0, as it pulls back correctly under forgetful maps (all boundary
divisors DB,k with nonzero coeﬃcient have k ≥ 1). Assume we have showed
the formula for m = 1. Then we can use (23) to derive it for general m.
Indeed, using Proposition 5.9, we ﬁnd by induction

Perm(λ) = sc∗

mPer1(λ) = sc∗
m

kD∅,k

dm

Xk=1

d

Xk=1
d

=

=

=

=

kdm−1D∅,k + sc∗

m−1

dm−1

Xl=1

dlD∅,l

kdm−1D∅,k + d · sc∗

m−1Per1(λ)

Xk=1
d

kD∅,k

kD∅,k

!

!

Xk=1
d

Xk=1

· (dm−1 + d(m − 1)dm−2)

· mdm−1.

It remains to show the case m = 1, n = 0. Here recall that for the diagram

ev=(µ,ϕ)
−−−−−−→ P1 × P1

Yd,1

π


Yd,0

y

we deﬁned

Per1(λ) = π∗[V (dϕ − λdµ|Fix)].

Here dµ ∈ Hom(µ∗ΩP1, ωπ) = ωπ ⊗ µ∗Ω∨
given by

P1, so clearly the class of Per1(λ) is

Per1(λ) = π∗

c1(ωπ ⊗ µ∗Ω∨

P1) ∩ [Fix]

.

Now it is well-known that c1(ωπ) = ψ1 and in Proposition 6.4, we are going
to show that

(cid:1)

(cid:0)

d

ψ1 = −2H1,1 +

D{1},k.

Xk=1

 
 
64

JOHANNES SCHMITT

But by deﬁnition c1(µ∗Ω∨

P1) = c1(µ∗OP1(2)) = 2H1,1. Thus

d

Per1(λ) = π∗

c1(D{1},k) ∩ [Fix]

!

.

Xk=1

Note that in the interpretation as a universal curve, the divisor D{1},k is
exactly the union of vertical sections over the divisor D∅,k ⊂ Yd,0. For
k = 1, . . . , d, a general point f ∈ D∅,k has exactly k ﬁxed points on its
vertical component. Hence, as we have claimed, the coeﬃcient of D∅,k in
(cid:3)
π∗

is k, which shows the desired formula.

c1(D{1},k) ∩ [Fix]

(cid:1)

Finally, as the sets Perm(λ) are invariant under PGL2, the Weyl divisors
(cid:0)
deﬁned above induce Weyl-divisors on the quotient spaces M (d|d1, . . . , dn)
and their classes in the rational Picard group are given by the formulas
above (where unstable divisors DB,k are omitted).

6. Intersection theory on M (d|d1, . . . , dn)

In this section, we treat the intersection theory of M (d|d1, . . . , dn). We
ﬁrst describe ψ-classes and show that their intersection numbers satisfy the
usual recursions. Note that this discussion is largely independent of the
following results. Then we start dealing with general top-intersections of
divisor classes. Here we ﬁrst show how to compute an intersection number
involving a boundary divisor to an equivariant intersection on a product of
lower-dimensional moduli spaces. As an excursion, we treat the equivariant
intersection theory of such products in a separate subsection. Finally, we
show how to use these results to obtain a recursive algorithm, computing all
intersection numbers of divisors.

6.1. Deﬁnitions and properties of ψ-classes. Let d = (d|d1, . . . , dn) be
admissible. We construct ψ-classes on the spaces M(d) = M (d|d1, . . . , dn)
and prove analogues of the String, Dilaton and Divisor equation.
In or-
der to have a universal family, we ﬁrst work with the smooth DM-stacks
M(d|d1, . . . , dn) and then descend to M (d|d1, . . . , dn). Indeed, for a smooth
DM-stack X with coarse moduli space X, using [Vis89, Proposition 6.1] we
have natural isomorphisms

Pic(X ) ⊗Z Q = Acodim=1(X )Q = Acodim=1(X)Q = Pic(X) ⊗Z Q.
We apply these identiﬁcations for X = M(d|d1, . . . , dn) and X = M0,n(P1 ×
P1, (1, d)).

Deﬁnition 6.1. Let d = (d|d1, . . . , dn) be admissible and denote by (d, 0) =
(d|d1, . . . , dn, 0), which is also admissible. Then consider the forgetful map
π : M(d, 0) → M(d) of the additional marking, with sections σi : M(d) →
M(d, 0) corresponding to the marked points. We deﬁne
Li = σ∗

i (ωπ), ψi = c1(Li),

where ωπ is the relative dualizing sheaf of π.

 
COMPACTIFICATION OF SELF-MAPS SPACE OF CP1 USING STABLE MAPS

65

This induces a well-deﬁned classes Li ∈ Pic(M (d|d1, . . . , dn)) ⊗Z Q and

ψi ∈ A1(M (d|d1, . . . , dn))Q.

In the entire section, the additional mark of M(d, 0) will be 0 instead
of n + 1 to make the formulas more pleasant. In the following we want to
relate these classes to the corresponding (and well-studied) ψ-classes on the
prequotient M0,n(P1 × P1, (1, d)). Our main tool is the following result.

Proposition 6.2. The following diagram is cartesian (in the obvious sense
that ˜π, ˜σi are the pullbacks of π, σ).

M0,n+1(P1 × P1, (1, d))ss,(d,0)

˜π
M0,n(P1 × P1, (1, d))ss,d

˜σi

˜φ

φ

M(d, 0)

π

σi

M(d)

(25)

Proof. The diagram is cartesian by Lemma C.1 as the maps φ, ˜φ are quo-
tients under the actions of G = PGL2 and the map π is induced by the
(cid:3)
G-equivariant map ˜π.

Let

˜Li = ˜σ∗

i (ω˜π), ˜ψi = c1(˜Li)

be the i-th cotangent line bundle and ψ-class on Yd,n.

Corollary 6.3. In the situation of Proposition 6.2 we have

˜Li = φ∗Li in Pic(Y ss,d
˜ψi = φ∗ψi in A1(Y ss,d

d,n ) ⊗Z Q,
d,n )Q.

Proof. As this diagram is cartesian, we have that ( ˜φ)∗ωπ = ω˜π by [Nir08,
(cid:3)
Theorem 2.11]. Pulling back along ˜σi gives the desired result.

As mentioned before, cotangent line bundles and ψ-classes have been
extensively studied (for a good survey see [Koc]). As the pullback of line
bundles (with rational coeﬃcients) under the map Y ss,d
d,n → M (d|d1, . . . , dn)
induced by φ gives an isomorphism of rational Picard groups by Corollary
4.2, we see that

φ∗ : A1(M(d))Q → A1(Y ss,d
is an isomorphism. As a ﬁrst step we explicitly identify the line bundles ˜Li
in terms of our generators from Theorem 4.4.

d,n )Q

Proposition 6.4. On M 0,n(P1 × P1, (1, d)) we have

˜Li =

DB,k

X(B,k)
i∈B,a,b /∈B or
i /∈B,a,b∈B

66

JOHANNES SCHMITT

for n ≥ 3, a, b ∈ {1, . . . , n} \ {i}, a 6= b. On the other hand, for n = 1, 2 we
have

˜Li = −2Hi,1 +

DB,k.

X(B,k)
i∈B

In all cases the sum only includes pairs B ⊂ {1, . . . , n}, 0 ≤ k ≤ d, such
that |B| ≥ 2 for k = 0.

Proof. As explained in [Koc, Proposition 5.1.8], for n ≥ 3 the class ψi is the
sum (i|a, b) of boundary classes where marks i and a, b are on diﬀerent com-
ponents (for two other markings a, b such that i, a, b are pairwise distinct).
This readily translates to the expression above.

In the cases n = 1, 2 we need a diﬀerent argument. Note here that for the

map ˜π as in Proposition 6.2 we have

˜ψi = ˜π∗(ψi) + D{i,0},0

i ◦˜π∗ =
by [Koc, (5.1.7.2)]. Now the map ˜π∗ is injective on Picard groups as ˜σ∗
(˜π ◦ ˜σi)∗ = id. Hence all we need to show is that the divisor given by the
i = ˜ψi − D{i,0},0
formula above for n = 2, 1 pulls back to the correct class ψ′
on the space with 3 and 2 marks, respectively.

For n = 2 we have

˜π∗ 

−2Hi,1 +

DB,k

= −2Hi,1 +

DB,k − D{i,0},0 =: ψ′′
i .





Xk,B⊂{1,2}
i∈B





Xk,B⊂{0,1,2}
i∈B

By adding D{i,0},0 to both sides of the equation ψ′′

i = ψ′

i we are left to show

ψi = −2Hi,1 +

DB,k on Yd,3.

Xk,B⊂{0,1,2}
i∈B

For this we intersect both sides with our test curves CB′,k′ (and CG in case
d = 0) and show they give the same numbers (which suﬃces by Proposition
4.12). For calculating the intersection with the left side we use the explicit
formula from the case n = 3 that was already shown. The intersection
with CG is always zero. It turns out that both intersections only depend on
B′. Let the symbol (r|s) be 1 for r ∈ B′, s /∈ B′ or r /∈ B′, s ∈ B′ and 0
otherwise. Similarly let (r|s, t) be 1 for B′ = {r} or B′ = {s, t} and zero
otherwise. Then the desired equation of intersection numbers)(for i = 1 for
simplicity) is exactly

(1|2) + (1|0) = (2|0) + 2(1|20).

Substracting (2|0) this is a combinatorial inclusion-exclusion-type identity
(or it can simply be explicitly checked on all 8 possibilities for B′ ⊂ {0, 1, 2}).

COMPACTIFICATION OF SELF-MAPS SPACE OF CP1 USING STABLE MAPS

67

For n = 1 the equality

ψ1 = −2H1,1 +

DB,k = ˜π∗ 

−2H1,1 +

DB,k

+ D{1,0},0

is obvious.

X(B,k)
1∈B





X(B,k)
1∈B





(cid:3)

Now we deﬁne descendant Gromov-Witten invariants on the space M (d).
Because the markings can possibly carry diﬀerent weights di, they are not
necessarily interchangeable and it will be necessary to record them in the
notation. For i ∈ {1, . . . , n}, k ≥ 0 and

γ = r · 1 + c1(O(s, t)) + u · [pt] ∈ A∗(P1 × P1)

let

ei(γ) = r + sc1(Hi,1) + tc1(Hi,2) + uc1(Hi,1)c1(Hi,2) ∈ A∗(M (d)),
i (γ) = ψk
τ k

i ei(γ) ∈ A∗(M (d)).

This deﬁnition is of course constructed in such a way that the pullback of
ei(γ) under the quotient map φ : Y ss,d
d,n → M (d) is exactly ev∗
i (γ) and the
i (γ) is ˜ψk
pullback of τ k
i (γ). Then for k1, . . . , kn ≥ 0 and homogeneous
classes γ1, . . . , γn ∈ A∗(P1 × P1) with

i ev∗

(26)

we deﬁne

n

Xi=1

ki + deg(γi) = 2(d − 1) + n = dim(M (d))

hτ k1

1 (γ1) · · · τ kn

n (γn)id =

τ k1
1 (γ1) · · · τ kn

n (γn).

Z[M (d)]

We will now verify that the familiar String, Dilaton and Divisor equation
hold, establishing recursions that allow to compute some of the invariants
above. For this, the following Lemma summarises some key properties of
ψ-classes and related divisors that carry over from M 0,n(P1 × P1, (1, d)) to
M (d) via Proposition 6.2.

Lemma 6.5. In Pic(M(d, 0)) ⊗Z Q we have

Li = π∗(Li) + D{i,0},0.
Using that ψiD{i,0},0 = 0 one shows inductively

i = π∗(ψi)k + π∗(ψi)k−1D{i,0},0.
ψk
As the divisors D{i,0},0 are exactly the image of the (disjoint) sections σi,
we have

D{i,0},0D{j,0},0 = 0, for i 6= j.

68

JOHANNES SCHMITT

The following formulas hold for pushforwards of codimension 1 cycles on
M(d, 0) under π:

π∗(D{i,0},0) = [M(d)],

π∗(ψi) = (n − 2)[M(d)],

π∗(Hi,j) = 


[M(d)]
d[M(d)]
0

, for i = 0, j = 1
, for i = 0, j = 2
, otherwise.

Finally we have



Hi,jD{i,0},0 = H0,jD{i,0},0
Proof. The main strategy of our proof will be to transfer the claimed results,
which live on the right hand side of the commutative diagram in Proposition
6.2, to the left side. There, all of them are either proved in [Koc] or are
immediate from the deﬁnitions.

The ﬁrst formula can be seen using this strategy, as the pullback on
rational Picard groups under φ is injective. To prove ψiD{i,0},0 = 0 and also
Hi,jD{i,0},0 = H0,jD{i,0},0, one uses that D{i,0},0 is the isomorphic image of
M(d) under σi. Thus we only need to pull back Li and H0,j −Hi,j via σi and
check that they are trivial bundles on M(d). But again this can be checked
after pulling back via φ. On the left side of the diagram in Proposition 6.2,
these are standard identities. The formula for ψk

i follows by induction.

It remains to show the formulas for the pushforwards of codimension 1
cycles. Here, we can use the formula φ∗π∗ = ˜π∗ ˜φ∗ (see [Vis89, Lemma 3.9])
to transfer these identities to the morphism Yd,n+1 → Yd,n. There, all of the
(cid:3)
formulas follow very easily from known results.

In the following, the nonnegative integers k1, . . . , kn and homogeneous

classes γ1, . . . , γn ∈ A∗(P1 × P1) are chosen such that (26) is satisﬁed.
Proposition 6.6 (String equation). We have

(27)

n

n

hτ 0

0 (1)

τ ki
i (γi)i(d,0) =

hτ kj −1
j

(γj)

τ ki
i (γi)id.

Yi=1

Xj=1

Yi6=j

Proposition 6.7 (Dilaton equation). We have
n

n

(28)

hτ 1

0 (1)

τ ki
i (γi)i(d,0) = (n − 2)h

τ ki
i (γi)id.

Proposition 6.8 (Divisor equation). For a divisor D ∈ A1(P1 ×P1) we have

Yi=1

Yi=1

n

hτ 0

0 (D)

τ ki
i (γi)i(d,0)

Yi=1
=hD, (1, d)ih

n

n

τ ki
i (γi)id +

hτ kj −1
j

(γj ∪ D)

τ ki
i (γi)id.

Yi=1

Xj=1

Yi6=j

COMPACTIFICATION OF SELF-MAPS SPACE OF CP1 USING STABLE MAPS

69

The proofs of all three identities are exactly as for the corresponding
descendant invariants on M g,n(X, β). The analogous identities necessary in
these proofs are exactly the statements in Lemma 6.5.

6.2. Intersection on boundary divisors. The idea of our algorithm for
the top-intersections of divisors D1, . . . , D2d−2+n on M (d|d1, . . . , dn), fol-
lowing a similar algorithm presented in [Pan99], will be to ﬁrst reduce to
the case D1 = DB,k, a boundary divisor. Then we restrict all divisors
D2, . . . , D2d−2+n to D1 and perform the intersection there. In the following,
we look at this last step.

Let us outline again the strategy used in [Pan99], but already adapted to
our setting. There, the product structure of the boundary divisor D1 was
used to reduce the intersection of the remaining divisors to an intersection
on a moduli space of lower degree or with fewer marked points.
Indeed,
consider a boundary divisor D = DB,k on Yd,n = M 0,n(P1 × P1, (1, d)). Let
A = {1, . . . , n} \ B. Then we have a gluing map

τ : M 0,A∪{p}(P1 × P1, (1, d − k)) ×P1×P1 M 0,B∪{p′}(P1 × P1, (0, k)) → DB,k.

Informally a pair (fA : CA → P1 × P1, fB : CB → P1 × P1) of stable maps is
p CB → P1 × P1, where the curves
sent to the induced map fA
are glued along the points p, p′, which by deﬁnition map to the same point
fA(p) = fB(p′). For a formal deﬁnition of τ see [FP97, Section 6.2]. As we
have

fB : CA

`

`

M0,B∪{p′}(P1 × P1, (0, k)) = P1 × M0,B∪{p′}(P1, k),

we can perform a partial ﬁbre product above. Let

M A = M 0,A∪{p}(P1 × P1, (1, d − k)),
M B = M 0,B∪{p′}(P1, k),

then the map τ above has the form

τ : M A ×P1 M B → DB,k.

By [FP97, Lemma 12], the map τ is birational, as the degrees (1, d − k) and
(0, k) are always distinct. Thus any top-dimensional intersection number on
D can be computed on the product M A ×P1 M B. We can further simplify
this problem by observing that the diagram

M A ×P1 M B −−−−→ M A × M B

ev=(π2◦evp)×ev′
p


∆P1

y

−−−−→ P1 × P1



y

is cartesian. As we will see immediately, all the restrictions of divisor classes
from Yd,n via τ come from classes on MA × MB. Hence we can perform the
intersection there if we add to the intersection the class ev∗([∆P1]). But

70

JOHANNES SCHMITT

(the Poincare dual of) the class [∆P1] is given by c1(O(1, 1)), hence after the
pullback via ev we have

ev∗O(1, 1) = Hp,2 ⊠ ev∗

p′OP1(1).

Here, for L a line bundle on M A and M a line bundle on M B, we denote by
L ⊠ M the bundle π∗
(M) on M A × M B. Below, we denote in
the same way also the restriction of L ⊠ M to M A ×P1 M B. Let us compute
the pullbacks of divisors on Yd,n via τ .

(L) ⊗ π∗

M B

M A

Proposition 6.9. Let D be a rational divisor class on Yd,n. Then

• for D = Hi,j with i ∈ A we have τ ∗D = Hi,j ⊠ O,
• for D = Hi,1 with i ∈ B we have τ ∗D = Hp,1 ⊠ O,
• for D = Hi,2 with i ∈ B we have τ ∗D = O ⊠ ev∗
• for D = G in the case d = 0 we have τ ∗D = G ⊠ O,
• for D = DB′,k′ with B′ 6= B or k′ 6= k we have that D, DB,k intersect

i OP1(1),

transversally in the loci

– DB′,k′ ×P1 M B for B′ ⊂ A, d − k ≥ k′,
– D(B′\B)∪{p},k′−k ×P1 M B for B ⊂ B′ and k ≤ k′,
– M A ×P1 D((B \ B′) ∪ {p′}, k − k′; B′, k′) for B′ ⊂ B and k′ ≤ k

and (k′ < k or B \ B′ 6= ∅),

and thus τ ∗D is given by the sum of the corresponding divisors (with
multiplicity 1),

⊠ ψ∨
• for D = DB,k with B 6= ∅ or 2k > d we have τ ∗D = ψ∨
p′. If
p
⊠ O. Here
B = ∅ and 2k ≤ d we have an additional summand D∅,k
ψq denotes the cotangent line bundle corresponding to the marking
q.

Proof. The formulas for the pullbacks of divisors Hi,j are immediate from
the fact that, depending on whether i ∈ A or i ∈ B , the composition of the
ith evaluation map on Yd,n with τ only depends on one of the factors M A,
M B. Moreover, the horizontal position of the points in B agrees with the
horizontal position of the gluing point p coming from M A. The pullback of
G in case d = 0 is also clear.

It remains to consider the boundary divisors. Two diﬀerent boundary
divisors intersect transversally by [FP97, Theorem 3] and above we have just
distinguished all cases that are combinatorially possible. They correspond to
decorated dual graphs of curves with three vertices that are specializations
of the dual graphs coming from DB,k and DB′,k′.

We are left to consider the self-intersection of the boundary divisor DB,k.
p,p′ C ′ → P1 × P1) ∈ DB,k, the
It is known that at a generic point (f : C
normal space of DB,k in Yd,n is exactly given by TpC ⊗ Tp′C ′, the ﬁbre of
the bundle ψ∨
p′. If B 6= ∅ or 2k > d, the map τ is an embedding and
p
thus indeed the restriction of DB,k via τ is the normal bundle ψ∨
p

⊠ ψ∨

⊠ ψ∨
p′.

`

COMPACTIFICATION OF SELF-MAPS SPACE OF CP1 USING STABLE MAPS

71

However, if B = ∅ and 2k ≤ d, then τ is still birational, but it is not
injective exactly on the divisor D∅,k ×P1 M B, where it is generically 2 : 1.
(cid:3)
Thus we have to add this cycle with multiplicity 1.

For d = (d|d1, . . . , dn) admissible, we use a similar strategy as above on
our quotient spaces M (d). Let A ∪ B = {1, . . . , n} be a partition of our
markings and 0 ≤ k ≤ d such that D = DB,k is a divisor on M (d), i.e.
Dss,d = DB,k ∩ Y ss,d
d,n 6= ∅. We now want to restrict the map τ above to the
preimage of Dss,d. From the criterion for semistability in Lemma 2.10, one
sees that the question whether τ (p, q) is semistable for p ∈ M A, q ∈ M B,
depends solely on p. Let A = {a1, . . . , am} and dA = (d − k|da1 , . . . , dam , k +

b∈B db). Then we deﬁne

P

We have

M

ss

A = M 0,A∪{p}(P1 × P1, (1, d − k))ss,dA.

τ −1(Y ss,d

d,n ) = M

ss
A ×P1 M B

and τ restricted to this set will still be birational. Now we can apply Lemma
2.8 to the morphism τ and see that for a suitable G-linearized ample line bun-
dle on M A ×P1 M B, the (semi)stable points are exactly given by τ −1(Y ss,d
d,n ).
ss
A ×P1 M B and
Thus we obtain a geometric quotient M
an induced map

ss
A ×P1 M B/G of M

˜τ : M

ss

A ×P1 M B/G → Dss,d

/G = DB,k.

As τ was an isomorphism over a G-invariant subset of Dss,d, the map ˜τ is still
proper and birational. Hence we can reduce top-dimensional intersections
on DB,k to intersections on M

ss
A ×P1 M B/G. As before we have that
ss
A × M B/G

ss
A ×P1 M B/G ⊂ M

M

is a divisor and it is cut out exactly by the Chern class of the line bundle
corresponding to

ev∗O(1, 1) = Hp,2 ⊠ ev∗

p′OP1(1).

As the quotient maps induce isomorphisms of the rational Picard groups,
Proposition 6.9 tells us how to restrict divisor classes from M (d) via the
map ˜τ . Hence we have reduced the original question to the intersection
ss
theory of M
A × M B/G. In the following subsection we are going to see how
to reduce this to (equivariant) intersections on the factors M

ss
A and M B.

6.3. Equivariant intersection theory of products. In the following let
X, Y be varieties over C and let G be a reductive group acting on X, Y
ss
with ﬁnite stabilizers. The example to keep in mind is X = M
A , Y =
M B. Assume that for the induced diagonal action of G on X × Y we have
a geometric quotient Z = X × Y /G. We want to study the intersection
theory of Z. To compute the full intersection ring is, in general, a very
hard problem. Even for G = {e} trivial, Z = X × Y , this ring can be
quite complicated, as only very special schemes X, Y satisfy a K¨unneth-type

72

JOHANNES SCHMITT

formula A∗(X × Y ) = A∗(X) ⊗ A∗(Y ). However, if we restrict ourselves
to intersections of classes pulled back from the two factors X, Y , we can
compute the intersections on X, Y and then take the exterior product of
the resulting cycles. We will try a similar approach in the presence of a
nontrivial G.

Here, it is natural to use equivariant intersection theory. This was intro-
duced by Edidin and Graham in [EG98]. Let V be a representation of G of
dimension l containing an open set U , with complement of suﬃciently large
codimension, on which G acts freely. Denote by XG = (X × U )/G the quo-
tient in the category of algebraic spaces. Then one deﬁnes the equivariant
i (X) of i-cycles to be Ai+l−g(XG). For X ′ ⊂ X an invariant
Chow-group AG
closed subscheme, there is a natural fundamental class [X ′]G ∈ AG
i (X), in-
duced from the class of the subscheme X ′ × U in (X × U )/G. These groups
share many functorialities (proper pushforward, ﬂat pullback, exterior prod-
uct, ...) with ordinary Chow groups. This allows to deﬁne equivariant oper-
ational Chow groups Ai
∗−i(W )
for every morphism W → X, satisfying the usual compatibility relations.
Below we are going to collect several key properties of these groups from
[EG98], that we will use in the following:

G(X) as operations c(W → X) : AG

∗ (W ) → AG

• If X is smooth of dimension n then Ai
isomorphism. ([EG98, Proposition 4])

G(X)

∩[X]G−−−−→ AG

n−i(X) is an

• As X is assumed separated and as char(C) = 0, we have a canonical
G(X) = Ak(XG), assuming that V \ U has codimen-

isomorphism Ak
sion more than k. ([EG98, Corollary 2])

• For G a connected reductive group with split maximal torus T and
([EG98,

∗ (X) ⊗ Q = AT

∗ (X)W ⊗ Q.

Weyl group W , we have AG
Proposition 6])

• For H ⊂ G a subgroup, there is a pull-back map AG

∗ (X)
induced by the ﬂat map XH = (X × U )/H → XG = (X × U )/G.
(Section after [EG98, Proposition 6])

∗ (X) → AH

• If the action of G on X is (locally) proper and we have a quotient

π : X → Y , then there is an isomorphism

π∗ : A∗(Y )Q → A∗

G(X)Q

of operational Chow rings. ([EG98, Theorem 3])

We will need the following variant of the fourth point for operational Chow
rings.

Lemma 6.10. Let H ⊂ G be a subgroup, then there is a pull-back map
ϕG,H : A∗
H (X) induced by the ﬂat map XH = (X × U )/H →
XG = (X × U )/G.

G(X) → A∗

By the last property above, if the action of G on X × Y is proper, we
G(X × Y )Q. As we will heavily

have an isomorphism A∗((X × Y )/G)Q ∼= A∗
rely on this result, we make the following convention:

COMPACTIFICATION OF SELF-MAPS SPACE OF CP1 USING STABLE MAPS

73

From now on, all Chow groups and operational Chow groups are
taken with Q-coeﬃcients.

By pullback and product we can deﬁne a map
G(Y ) → A∗
Φ : A∗

G(X) ⊗ A∗

(29)

G(X × Y ).

Our goal in this section will be to understand the map above in top-degree,
that is in degree dim(X) + dim(Y ) − dim(G). Note that in contrast to the
usual intersection theory, the equivariant operational Chow groups A∗
G(pt) =
A∗
G(Y ) are modules over
this ring and by functoriality we see that the map in (29) factors through
their tensor product over this ring:

G(Spec C) can be highly nontrivial. Both A∗

G(X), A∗

G(pt) A∗
G(X) and A∗

(30)

Φ : A∗

G(X) ⊗A∗

G(Y ) → A∗

G(X × Y ).

Given several elements in A∗
G(Y ), the basic idea will be to ﬁrst
compute their product in their respective rings, then use the functoriality
G(pt) between A∗
above to shift factors coming from A∗
G(Y ) and
only then compute their image in A∗
G(X × Y ). Let us ﬁrst make this last
step precise, to see why we may want to shift classes between the factors.

G(X) and A∗

Proposition 6.11. Assume that for the action of G on X and on X×Y there
exist G-linearized line bundles with X = X ss = X s and X×Y = (X×Y )ss =
(X × Y )s. Let α ∈ A∗(X//G) = A∗
G(X) such that α ∩ [X//G] = [{[x]}] for
a point x ∈ X (which has ﬁnite stabilizer Gx by our global assumptions).
Then the preimage of [x] under the projection πX : (X × Y )//G → X//G is
the image of Y under the map

We have i∗[Y ] = |Gx| · [π−1

i : Y → (X × Y )//G, y 7→ [(x, y)].
X ([x])]. For any class β ∈ A∗

G(Y ) we then have

Φ(α ⊗ β) ∩ [(X × Y )//G] =

1
|Gx|

i∗

ϕG,{e}(β) ∩ [Y ]

.

Here ϕG,{e} : A∗
{e} of G.

(cid:0)
G(Y ) → A∗(Y ) is the map coming from the trivial subgroup

(cid:1)

Proof. One sees easily that π−1
X ([x]) = Y //Gx. Hence it follows immediately
that i∗[Y ] = |Gx| · [π−1
X ([x])]. Now in the calculation below, we will want to
use ﬂat pullback under the map πX. Unfortunately, this map does not need
to be ﬂat. However, the map [(X × Y )/G] → [X/G] of quotient stacks is
ﬂat. As these quotient stacks are also Deligne-Mumford (because G acted
with ﬁnite stabilizers), we may apply the results about intersection theory
from Vistoli’s paper [Vis89]. They tell us that on the stack level, we have
our accustomed functorialities (proper pushforward, ﬂat pullback, etc.) and
that the Chow groups of the stacks are isomorphic to the Chow groups
of their moduli spaces (assuming we work with Q-coeﬃcients, see [Vis89,
Proposition 6.1]). And indeed, the quotients (X × Y )//G and X//G are the
coarse moduli spaces of the quotient stacks [(X × Y )/G], [X/G] by Lemma

74

JOHANNES SCHMITT

C.4 and Remark C.5. Using these isomorphisms, we can indeed apply the
formal rules for ﬂat pullbacks under πX in the following. We compute

Φ(α ⊗ β) ∩ [(X × Y )//G]

=Φ(1 ⊗ β) ∩ π∗
=Φ(1 ⊗ β) ∩ π∗
=Φ(1 ⊗ β) ∩ [π−1

X (α) ∩ π∗
X (α ∩ [X//G]) = Φ(1 ⊗ β) ∩ π∗
X ([x])]

X[X//G]

X([{[x]}])

=

1
|Gx|

Φ(1 ⊗ β) ∩ i∗[Y ].

It remains to see how the class Φ(1 ⊗ β) restricts under the map i. For
this let V be a representation of G such that G acts freely on an open set
U ⊂ V with complement of suﬃciently high codimension. Then we have the
following diagram of maps

Y

i

−−−−→ (X × Y )//G

ψ

←−−−− (X × Y × U )/G

η


(Y × U )/G

y

x
Y × U



Now we want to compute i∗Φ(1 ⊗ β). By the properties above, the map
ψ∗ induces an isomorphism of operational Chow groups in suﬃciently small
degree. Hence, the class Φ(1 ⊗ β) is the unique class such that ψ∗Φ(1 ⊗ β) =
η∗β, where we regard β as an element of A∗(YG) = A∗((Y × U )/G). But i
lifts along ψ to a map i′ : Y → (X × Y × U )/G by i′(y) = [(x, y, u)] for a
ﬁxed u ∈ U . Hence Φ(1 ⊗ β) = (η ◦ i′)∗β. But (η ◦ i′)(y) = [(y, u)], so this
map lifts to a map Y → Y × U, y 7→ (y, u). But by deﬁnition, the pullback
under the map Y × U → (Y × U )/G is exactly ϕG,{e} and the pullback under
y 7→ (y, u) gives the identiﬁcation A∗(Y × U ) ∼= A∗(Y ). Together with the
(cid:3)
projection formula for i, this ﬁnishes the proof.

Now we have to look more carefully at the group A∗

G(Y ). For our ap-
plication, we can assume that Y is the coarse moduli space of a smooth,
projective DM-stack. We will include these assumptions when necessary.

We will apply torus localization to compute intersections on Y . As we
have seen above, we can express AG
∗ (X).
To go from operational Chow groups to Chow groups of cycles, we use the
following Lemma, extending the ﬁrst property of equivariant cohomology
mentioned above.

∗ (X) as the Weyl-invariant part of AT

Lemma 6.12. Assume Y is the coarse moduli space of a smooth DM-stack
Y of ﬁnite type over C with generically trivial stabilizer and of dimension n.

COMPACTIFICATION OF SELF-MAPS SPACE OF CP1 USING STABLE MAPS

75

G(Y )

∩[Y ]G−−−−→ AG

Assume also that the action of G comes from an action of G on the stack Y.
Then Ai
n−i(Y ) is an isomorphism (still with Q-coeﬃcients).
Proof. For a representation V of G of dimension l with an open set U on
which G acts freely and whose complement has suﬃcient codimension, we
can relate the equivariant Chow groups of Y to the usual Chow groups for
(Y × U )/G. Then we have the diagram
Ai

Ai((Y × U )/G)

G(Y )

∩[Y ]G

∩[(Y ×U )/G]

AG


n−i(Y )

y


An+l−g−i((Y × U )/G)

y

The space (Y × U )/G (which exists as an algebraic space as the action of
G on U is free) is the coarse moduli space of the quotient (Y × U )/G. This
follows from the proof of Lemma C.4. As Y × U is a smooth DM-stack,
Proposition C.3 implies that (Y × U )/G is still a smooth DM stack. Hence
by [Vis89, Proposition 6.1], the map on the right side of the diagram above
(cid:3)
is an isomorphism after tensoring with Q, which ﬁnishes the proof.

We conclude that for G reductive and connected with maximal torus T

and Weyl group W and Y as in the Lemma, we have the diagram

Ai

G(Y )Q

φG,T−−−−→ Ai

T (Y )W
Q

∩[Y ]G

∩[Y ]T

AG


n−i(Y )Q

y

AT


n−i(Y )W

Q
y

whose vertical maps are isomorphisms by Lemma 6.12. Thus φG,T is an
isomorphism (to the Weyl-invariant part of A∗
T (Y )Q and we can carry out
computations in the torus equivariant operational Chow groups.

We now want to argue that for applying Proposition 6.11 to compute top-
dimensional intersections on (X×Y )/G, it will suﬃce to intersect β ∈ A∗
T (Y )
with the fundamental class [Y ]T and ﬁnd the image of β ∩ [Y ]T in A∗(Y )
under φT,{e}.

For this we will use results of Vistoli from [Vis87] for the Chow group
of quotient varieties. We still have that all (operational) Chow groups are
taken with Q-coeﬃcients. Let us summarize the results from the above
paper in our current language.

Proposition 6.13. Let G = GLn or G = SLn act on a scheme Y such
that Y is covered by open, invariant, aﬃne subsets. Then the map φG,{e} :
∗ (Y ) → A∗(Y ) is surjective and its kernel are those elements β ∈ AG
AG
∗ (Y )
that can be written as a product β = σ ˜β of an element σ ∈ A∗
G(pt) and an
element ˜β ∈ AG
∗ (Y ). So we have an exact sequence

(31)

A∗

G(pt) ⊗ AG

∗ (Y ) → AG

∗ (Y )

φG,{e}
−−−−→ A∗(Y ) → 0.

76

JOHANNES SCHMITT

Proof. This follows by applying Theorem 1 and Theorem 2 from [Vis87] to
the quotient map Y × U → (Y × U )/G for U ⊂ V an open subset of a
representation V of G, on which G acts freely and whose complement has
suﬃcient codimension. Indeed, we still have that Y × U is covered by open,
invariant aﬃne subsets (as we can take V = Mat(n, p) for p large and the
corresponding U is covered by invariant aﬃnes). The action of G on Y × U
is even free, so the assumptions of the Theorems above are satisﬁed. The
classes ci operating on A∗((Y × U )/G) are exactly the generators of AG
∗ (pt)
(cid:3)
from [EG98] with their operation on AG

∗ (Y ).

The following Corollary summarizes the conclusions from this Proposi-
Gm(pt)

tion, that we will use later. Here we identify the ring A∗
as Z[t2] ⊂ Z[t].

SL2(pt) ⊂ A∗

Corollary 6.14. Let G = SL2 act on a scheme Y . Assume that the map
A∗
∗ (Y ) is an isomorphism (for instance for Y smooth or sat-
isfying the conditions of 6.12).

∩[Y ]G−−−−→ AG

G(Y )

Then for i ≥ 0, j = ⌈i/2⌉ any element β ∈ Adim(Y )+i

(Y ) can be written

T

as β = t2j ˜β for ˜β ∈ Adim(Y )+i−2j

T

Proof. Using the isomorphism A∗
becomes

(Y ).
G(Y ) ∼= AG

t2A∗

G(Y ) → A∗

G(Y )

φG,{e}
−−−−→ A∗(Y ) → 0.

∗ (Y ), the exact sequence (31)

We do an induction on i, reducing it in every step by 2. The case i = 0
is trivial and the case i = 1 will be obvious from the following induction
step. For i ≥ 1 we have for degree reasons that φG,{e}(β) = 0, as A∗(Y )
vanishes above degree dim(Y ). Hence β has the form t2β1 with β1 of degree
dim(Y ) + i − 2. We can then apply induction on β1 and obtain the desired
(cid:3)
result.

Now we will describe how to explicitly compute the map Φ from (30) in
our situation X = M A, Y = M B with the action of G = SL2. All Chow
groups below will be with Q-coeﬃcients. Let α ∈ Ai
G(Y ) with
i + j = dim(X × Y /G).
G(X) =
Ai
G(X/G). Hence we know j ≥ dim(Y ). But then we can use Corollary 6.14
to decompose β = t2⌈(j−dim(Y ))/2⌉ ˜β and we can put the power of t to the
factor A∗
G(Y ). If j − dim(Y ) is
odd, we see that in this case the product of α with this power of t vanishes
as it lies in degree dim(X/G) + 1 of A∗

If i > dim(X/G), then α vanishes as Ai

G(X) in the tensor product A∗

G(X), β ∈ Aj

G(X) ⊗A∗

G(pt) A∗

G(X) = A∗(X/G).

In the remaining case that j − dim(Y ) is even, we have arranged α ⊗ β =
(αtj−dim(Y )) ⊗ ˜β and (αtj−dim(Y )) ∩ [X/G] is a zero-cycle. We can represent
this cycle as a sum of points, all with ﬁnite stabilizers. For each of these
points, we are in the situation of Proposition 6.11 and we are reduced to
computing the intersection of ˜β with [Y ]. As we have explained above, we
can also perform this intersection in A∗
T (Y ). Here we can apply standard

COMPACTIFICATION OF SELF-MAPS SPACE OF CP1 USING STABLE MAPS

77

localization techniques. Even more is true: we do not need to perform
the decomposition β = tj−dim(Y ) ˜β explicitly. We can just compute the
intersection β ∩ [Y ]T in AT
∗ (pt) = Q[t2].
Then ˜β ∩ [Y ] is the coeﬃcient of tj−dim(Y ). This ﬁnishes the description of
the algorithm.

∗ (Y ) and then push forward to AT

6.4. A recursive algorithm for intersection numbers of divisors. We
now have all the necessary ingredients to compute intersection numbers of
divisors on our moduli spaces M (d|d1, . . . , dn). As input we have a collection
D1, . . . , D2d−2+n of divisors on M (d|d1, . . . , dn). By using Corollary 4.18
about the structure of the Picard group, we may assume that all divisors
are either boundary divisors or one of H = H1,1 for n = 1, 2 or G for d = 0.
If one of the divisors (say D1) is a boundary divisor DB,k, we can use
Proposition 6.9 to restrict the other divisors to it and reduce to an intersec-
ss
A × M B/G. As we have seen in Section 6.3, we can reduce this
tion on M
to ﬁrst performing an equivariant intersection on M B and then computing
an intersection on M A/G, which is a moduli space M (d − k|k, (da)a∈A) with
lower degree d − k or fewer markings. Recall that M B = M 0,B∪{p′}(P1, k)
so the intersection can be computed using Atiyah-Bott localization (see for
instance [HKK+03, Chapter 27]).

Note, however, that the intersection on M (d − k|k, (da)a∈A) may also
involve a purely equivariant factor t2r ∈ A∗
G(pt), which arose from the inter-
section on M B. We need a way to identify this class in terms of the known
divisor classes in order to conclude the recursion. This can be done using
the following Lemma.

Lemma 6.15. In A∗(M (d|d1, . . . , dn))Q, the class coming from t2 ∈ A∗
G(pt)Q
agrees with c1(Hi,j)2 for i = 1, . . . , n, j = 1, 2 and also with c1(G)2 for d = 0.

Proof. Note that from [EG98, Section 3.3], it follows that for the usual action
of G = SL2 on P1 we have an equivariant operational Chow ring

A∗

G(P1

Q = Q[h, t2]/(h2 − t2),

where t2 is the generator of the equivariant Chow ring of a point and h comes
from the canonically G-linearized line bundle O(1) on P1. To see this, use
T (P1)Q = Q[h, t]/(h2 − t2).
that A∗
Here T ⊂ G is the diagonal torus acting with weights 1, −1 on P1 and the
generator σ of the Weyl-group W = Z/2Z acts by σh = h, σt = −t.

G(P1)Q is the Weyl-invariant part of A∗

Now for i = 1, . . . , n, j = 1, 2, consider the G-equivariant evaluation map

evi,j = πj ◦ evi : Y ss,d

d,n → P1

giving the jth component of the evaluation of the ith marking in P1 × P1.
The line bundle Hi,j is exactly ev∗

c1(Hi,j) ∈ A∗(M (d|d1, . . . , dn))Q = A∗

i,jO(1). But then the class
G(Y ss,d

d,n )Q

78

JOHANNES SCHMITT

of the induced line bundle is nothing but the pullback of the class h ∈
A∗

G(P1)Q by

But as h2 = t2 in A∗

ev∗

i,j : A∗

G(Y ss,d
G(P1)Q → A∗
G(P1)Q, we have c1(Hi,j)2 = t2.

d,n )Q.

For d = 0, we must have at least one marking to have a nonempty moduli
(cid:3)

space, so n ≥ 1. Then the claim follows because G = H1,2.

By the above result, we can replace factors t2 by H2 in the presence of
markings. But note that the space M A always has at least the marking
coming from the gluing point p.

The only thing missing to ﬁnish the recursion is a strategy to deal with
intersections which only feature the divisors H, G (in cases n = 1, 2 or d = 0,
respectively), so we intersect c1(H)ac1(G)b. Here, we have one tool at our
disposal in case a > 1, because we know c1(H)2 = c1(H1,1)2 = c1(H1,2)2 by
the Lemma above. However, using Proposition 4.13, we know that

H1,2 = dH1,1 + R,

where R is a combination of boundary divisors and possibly G. Thus we
know

c1(H1,1)2 = c1(H1,2)2 = d2c1(H1,1)2 + c1(R) (2dc1(H1,1) + c1(R)) .

In the case d 6= 1, we can solve this equation for c1(H1,1) and express it as
an intersection of boundary divisors, G and only one copy of c1(H1,1). With
this we can reduce a sucessively until we can assume a ≤ 1.

However, for d = 1 we need a diﬀerent strategy. But note that we have
already restricted to the cases n = 1, 2. The case d = 1, n = 1 is a base-case
below. For d = 1, n = 2 one checks using Lemma 2.10 that either D1=ﬁx = 0
or D2=ﬁx = 0, as one of these loci in Y1,2 is unstable. But we have

D1=ﬁx = 2H1,1 + R, D2=ﬁx = −2H1,1 + R′,
where R, R′ are sums of boundary divisors. Hence we can express H1,1 as
such a sum and use the recursion above.

What we have proven is that we can restrict to the case a ≤ 1. For a = 1
we have n = 1, 2. For d 6= 0, we would have b = 0, so our moduli space
is one-dimensional, so 2d − 2 + n = 1, which implies d = 1, n = 1. This is
one of the base cases covered below. On the other hand, for d = 0 we need
n = 2 to have 2d − 2 + n ≥ 0, which will also be treated below as a base
case for the recursion.

On the other hand for a = 0 we again distinguish cases:

if b = 0, our
moduli space must be zero-dimensional, so 2d − 2 + n = 0, which implies
again d = 0, n = 2. For b = 1 we have d = 0 and so we are in the case of
M (0|c, d, e). This is covered in the following Lemma.

Lemma 6.16. To compute the intersection number (G) on the moduli spaces
M (0|c, d, e) we have to distinguish two cases

COMPACTIFICATION OF SELF-MAPS SPACE OF CP1 USING STABLE MAPS

79

• If the sum of any two of c, d, e is strictly larger than the third plus

1, we have M (0|c, d, e) ∼= P1 and G = O(1), hence (G) = 1.

• If, say, c + d ≤ 1 + e then we have

(G) =

1
2 

1 −1

−1

if c+e<1+d

if d+e<1+c

.







Proof. In the ﬁrst case, we see that by Lemma 2.10 no two of the horizontal
|{z}
positions of the three markings can collide, so we can use our PGL2-action
to arrange these positions to be 0, 1, ∞, in a unique way.
It also follows
that all three markings can still be ﬁxed points of the degree 0 map (as
2 + c < 1 + d + e and similar inequalities hold). Hence we see that the map

|{z}

P1 → M0,3(P1 × P1, (1, 0))ss,(c,d,e)
q 7→ (id × q : P1 → P1 × P1; 0, 1, ∞)

composed with the quotient map to M (0|c, d, e) is an isomorphism. But
from the deﬁnition it is clear that G = O(1).

For c + d ≤ 1 + e, it follows 1 + c + d ≤ 2 + e. Again by Lemma 2.10
this implies that Fix3 = 0. Using Proposition 4.12, one ﬁnds that on Y0,3
we have

Fix3 = G −

1
2

D{1,2},0 +

1
2

D{1,3},0 +

1
2

D{2,3},0 +

1
2

D{1,2,3},0.

A generic point of D{1,2},0 is always stable and on the other hand all points
in D{1,2,3},0 are unstable (we need a + b + c ≥ 1 because otherwise there are
no semistable points at all). On the other hand, a generic point of D{1,3},0
(or D{2,3},0) is stable iﬀ c + e < 1 + d (or d + e < 1 + c).

Then setting Fix3 = 0, solving for G and observing that D{1,2},0, D{1,3},0
and D{2,3},0 are reduced points in the quotient (if they are stable at all), we
(cid:3)
ﬁnd the claimed formula.

Finally, for b ≥ 2 we have n = b + 2 ≥ 4 and we replace two of the
factors c1(G) by c1(H1,1). But H1,1 can be expanded in the basis of the
Picard group of our moduli space, which by Corollary 4.18 only contains
boundary divisors and G. But by Proposition 4.12, the coeﬃcient cG of G
in this expansion is equal to (CG, H1,1) = 0. Thus only boundary divisors
appear and we are able to enter the recursion described above.

We are left to do the base cases:

for d = 0, n = 2 the only nonempty
spaces are isomorphic to a point by Lemma 3.1, so the empty intersection
gives result 1. For d = 1, n = 1 we have seen in Section 3.1.2 that all
nonempty moduli spaces are isomorphic to M (1|1) ∼= P1. On this space we
can use

0 = Fix1 = H1,1 + H1,2 = 2H +

D∅,1

1
2

by Proposition 4.13. As D∅,1 consists of a single point with no stabilizer, it
gives intersection number 1 and H therefore gives intersection number − 1
4 .

80

JOHANNES SCHMITT

This ﬁnishes the description of the algorithm. It has been implemented
using SAGE (see [Dev14]) and is available from the author upon request. In
this implementation, we used a SAGE program to compute top-intersections
on spaces M 0,n written by Drew Johnson. This program can be found at
[Joh12].

Appendix A. Notations

Ratd
Zd

Yd,n

Yd,n
M (d, n)

M (d|d1, . . . , dn)

M(d|d1, . . . , dn)
Ad,n
DB,k

Hi,j
H′
i,2
Di=ﬁx

G

Gd,n

Bd,n

ψB,k
CB,k
c

scm

Perm(λ)

d,n /PGL2

the space Ratd of degree d maps P1 → P1
the compactiﬁcation Zd = P(H 0(P1 × P1, O(d, 1))) of
Ratd
the moduli stack M0,n(P1 × P1, (1, d)) of stable maps to
P1 × P1 of degree (1, d) with n marked points
the coarse moduli space M 0,n(P1 × P1, (1, d)) of Yd,n
the moduli space of degree d self-maps with n marked
points (Corollary 2.9)
the moduli space of degree d self-maps with n marked
points and weights d1, . . . , dn (Corollary 2.12)
the quotient stack Y ss,d
the locus of points in Yd,n with PGL2-isotropy
the boundary divisor D({1, . . . , n}\B, (1, d−k); B, (0, k))
inside Yd,n or M (d|d1, . . . , dn)
the divisor (πj ◦ evi)∗OP1(1) on Yd,n
the divisor Hi,2 − dHi,1 on Yd,n
the divisor ev−1
Yd,n → P1 × P1
the divisor π∗
M 0,n(P1, 1) × P1
the generators of the rational Picard group of Yd,n from
Theorem 4.4
the basis of the rational Picard group of Yd,n from Corol-
lary 4.11
the test curve P1 → Yd,n constructed in Deﬁnition 4.6
the image cycle (ψB,k)∗[P1] in Yd,n
the composition map Yd1,n × Yd2,0 99K Yd1d2,n (Theorem
5.5)
the m-fold self-composition map Yd,n 99K Ydm,n (Section
5.2)
the Weyl-divisors in Yd,n of maps with m-periodic orbits
of multiplier λ

P1OP1(1) on Y0,n = M 0,n(P1 × P1, (1, 0)) ∼=

i (∆) ⊂ Yd,n for the evaluation map evi :

Appendix B. Generalities

Theorem B.1. Let X = G/P be a homogeneous space, where G is an
algebraic group and P is a parabolic subgroup. Let β ∈ A1(X) be a curve

COMPACTIFICATION OF SELF-MAPS SPACE OF CP1 USING STABLE MAPS

81

class, n ≥ 3 and consider the forgetful morphism

F : S = M 0,n(X, β) → M 0,n.

Then F is ﬂat of relative dimension δ = dim(X) +

β c1(TX ).

Proof. By [BM96, Proposition 7.4] applied to (V, τ ) = (X, g, n, β), we know
that the morphism of Deligne-Mumford stacks M g,n(X, β) → M g,n is ﬂat of
dimension δ. In general this will not imply that the corresponding morphism
of the coarse moduli spaces is also ﬂat.

R

However in the case g = 0, we can use the Miracle ﬂatness theorem
(see for instance [Mat89, Theorem 23.1]).
It tells us that a map from a
Cohen-Macaulay variety to a smooth variety with constant ﬁbre dimension
is ﬂat. Now indeed by [KP01] we have that F is a map between irreducible
varieties and M 0,n is smooth by [Knu83]. By [FP97, Theorem 2] the va-
riety M 0,n(X, β) is locally the quotient V /H of a smooth variety V by
a ﬁnite group H. Smooth varieties are Cohen-Macaulay and we now use
the Hochster-Roberts theorem from [HR74] to show that then also V /H is
Cohen-Macaulay. The theorem says that if an aﬃne linearly reductive group
(like H) acts rationally on a Noetherian k-algebra, then the ring of invari-
ants is Cohen-Macaulay. But the map V → V /H satisﬁes the conditions
of [MFK94, 1.§2, Theorem 1.1] and thus V /H is covered by the spectra of
rings of invariants as above, hence it is Cohen-Macaulay.

We are thus left to show that the ﬁbres of F are of dimension δ. But
this property is preserved when going from the stacks to the coarse moduli
(cid:3)
spaces, hence we are done by [BM96, Proposition 7.4].

Proposition B.2. Let k be an algebraically closed ﬁeld of characteristic
zero and f : X → Y a morphism between integral k-schemes of ﬁnite type
over k. Then if f is bijective on the closed points of X and Y and Y is
normal, the morphism f is an isomorphism.

Proof. This can be proved using Zariski’s Main Theorem together with the
fact that for a dominant, separable morphism of varieties over an alge-
braically closed ﬁeld k which has degree d, the generic ﬁbre consists of d
(cid:3)
points.

Proposition B.3. Let π : X → Y be a locally ﬁnitely presented, ﬂat,
separated morphism of relative dimension n. Let s : Y → X be a section
of π such that s(p) is a smooth point of Xp for all geometric points p ∈ Y .
Then s is an eﬀective Cartier divisor in X.

Proof. As s is a section of a separated morphism, it is a closed embedding
(see [Sta14, Tag 024T]). On the complement of the singular locus S of the
ﬁbres Xp we have that π : X \S → Y is still locally ﬁnitely presented and ﬂat
and now also smooth, as the geometric ﬁbres are smooth. Then by [Ful98,
B7.3], s is a regular embedding into X \ S. But as X \ S and X \ s(Y ) deﬁne
an open cover of X, s is also a regular embedding into X, that is a Cartier
(cid:3)
divisor.

82

JOHANNES SCHMITT

Lemma B.4. Let π : X → Y be a ﬁnite, ﬂat morphism from a scheme X
to a normal, irreducible variety Y . Let L be a line bundle on X and let
ϕ : L → L be a morphisms such that π(V (ϕ)) ⊂ Y is a proper subset.
Then π∗L is a vector bundle on Y and we have an equality of cycles
π∗([V (ϕ)]) = [V (det(π∗ϕ : π∗L → π∗L))].

Proof. For any V ⊂ Y irreducible of codimension 1, we have to check that
the multiplicities of [V ] in both sides of the claimed equation agree. Hence
we may take a base change by the spectrum of A = OV,Y and we obtain a
map πV : Spec(B) → Spec(A), where B is a ﬁnite A-algebra.

As the ﬁbres of π are ﬁnite, by general theorems about base-change and

cohomology the sheaf π∗L is locally free. Moreover, we have

(π∗L)|Spec(A) = (πV )∗L|Spec(B).
The restriction of L to Spec(B) corresponds to a B-module M . The push-
forward (πV )∗L|Spec(B) still corresponds to M , which is now a locally free
A-module. As A is a discrete valuation ring, M is thus even free as an
A-module. The endomorphism ϕ of L is given by multiplication with some
function, so on Spec(B) it corresponds to multiplication with some b ∈ B.
Then by [Ful98, Example A.2.3] we have

lA(M/(b)) = lA(A/(det(b)).
The left side gives the multiplicity of [V ] in π∗([V (ϕ)]) and the right side
(cid:3)
gives its multiplicity in [V (det(π∗ϕ : π∗L → π∗L))].

Appendix C. Group actions on stacks

The following results use deﬁnitions and techniques for group actions on

stacks introduced by Romagny in [Rom05].

Lemma C.1. Let S be a scheme, G a ﬂat, separated group scheme of ﬁnite
presentation over S. Let M, N be G-algebraic stacks over S and let f : M →
N be a morphism of G-stacks. Then there exists a canonical commutative
diagram

(32)

M

f

−−−−→ N

,



M/G
y

˜f

−−−−→ N /G



y

and this diagram is a ﬁbre product.

Proof. Our assumptions on G are chosen in such a way, that the quo-
tient stacks M/G, N /G are isomorphic to the stacks of G-torsors (M/G)∗,
(N /G)∗ by [Rom05, Theorem 4.1].

Recall that for a G-stack (M, µM : G × M → M), the stack (M/G)∗ has

as objects over a scheme T /S triples

t = (p : E → T, h : E → M, σ).

COMPACTIFICATION OF SELF-MAPS SPACE OF CP1 USING STABLE MAPS

83

Here E is an algebraic space with a strict action ν : G × E → E, p is
G-invariant such that fppf-locally on T it is isomorphic to the projection
G × T → T and the map (h, σ) : E → M is a morphism of G-stacks.

Isomorphisms between t, t′ are pairs (u, α) with a G-morphism u : E → E′

and a 2-isomorphism α : (h, σ) =⇒ (h′, σ′) ◦ u.

What will be important for us is that (M/G)∗, (N /G)∗ are algebraic
stacks, i.e. they have surjective, fppf atlases V → (M/G)∗, U → (N /G)∗
from schemes U, V . Moreover, the natural maps M → (M/G)∗ and N →
(N /G)∗ are actually the universal G-torsors.

As a ﬁrst step, we want to construct the map ˜f : (M/G)∗ → (N /G)∗.

On objects over T /S it is given by

(h,σ)

−−−−→ M

E

f ◦(h,σ)
−−−−−→ N

E





7→ 



.






T

y










T

y





One checks that the resulting diagram (32) is commutative. Let Z =
N ×(N /G)∗ (M/G)∗, then there is a natural map φ : M → Z. We want to
show that it is an isomorphism by taking suitable base-changes with smooth
maps from schemes. First take the base change with the atlas V → (M/G)∗
and we obtain

MV −−−−→ ZV −−−−→ V


M −−−−→ Z −−−−→ (M/G)∗

y



y



y


N −−−−→ (N /G)∗

y



y

It suﬃces to show MV → ZV is an isomorphisms. Because MV → V is
a G-torsor we have V ∼= MV /G and MV is an algebraic space. We have
reduced the problem to the case where M is an algebraic space and (M/G)∗
is a scheme. Similarly, by taking the base change of the entire diagram by
the atlas U → (N /G)∗ we reduce to the case N an algebraic space. But
here we see that the morphism (M/G)∗ → (N /G)∗ is induced by the G-
equivariant map M → N of the G-torsor M over (M/G)∗. Hence the fact
that the corresponding diagram is cartesian is simply the deﬁnition of the
(cid:3)
universal property of the G-torsor N → (N /G)∗.

Remark C.2. As the map N → N /G above is fppf (check on any atlas
U → N /G pulling back to a locally trivial G-bundle on U ) any property
of f : M → N that is fppf-local on the target is inherited by the induced
map ˜f : M/G → N /G. Also, arguing as above, for any cartesian diagram
of G-algebraic stacks where all morphisms are G-morphisms the induced
diagram of the quotients is also cartesian.

84

JOHANNES SCHMITT

Proposition C.3. Let M be an orbifold, i.e. a smooth separated Deligne-
Mumford stack with connected coarse moduli space and containing a non-
empty open substack which is a scheme. Let the smooth group scheme G
act on M with ﬁnite, reduced stabilizers at geometric points. Then the
quotient M/G is again a smooth DM stack.

Proof. We want to use the frame bundle F = Fr (TM) of the tangent bundle
TM of M. By [BNTGP14, Exercise 1.183], F is an algebraic space. For
n = dim(M), the group GLn acts on F on the right by
n

n

(33)

(v1, . . . , vn).(aij)n

i,j=1 = (

ai1vi, . . . ,

ainvi)

Xi=1

Xi=1

and we have that M = [F/GLn]. On the other hand, the action of G on M
induces an action of G on F by

(34)

g.(v1, . . . , vn) = (g∗v1, . . . , g∗vn),

where g∗ denotes the pushforward under the map p 7→ gp on M.

Note that the actions of G and GLn commute, because g∗ : TM → TM is

linear in the ﬁbres. Indeed, we have

g.((v1, . . . , vn).(aij )) = g.(

ai1vi, . . . ,

ainvi)

Xi

ai1g∗vi, . . . ,

Xi

= (

aing∗vi)

Xi

Xi
= (g.(v1, . . . , vn)).(aij ).

This means that we can combine these two actions to an action of G × GLn
on F. As F is an algebraic space, every action of an algebraic group on F
(in the usual sense) is automatically a strict action in the sense of [Rom05].
Note that a geometric point σ = (v1, . . . , vn) ∈ F in the ﬁbre of p ∈ M
has ﬁnite, reduced stabilizer in G×GLn. Indeed, for a pair (g, A) to stabilize
σ, the element g ∈ G must stabilize p. By assumption, the stabilizer of p in
G is ﬁnite and reduced. Hence the claim follows, as the action of GLn on
the ﬁbre of F over p is simply transitive, so the stabilizer of σ is isomorphic
to the stabilizer of p in G.

With these preparations done, we simply note that

M/G = [F/GLn]/G = (F/GLn)/G = F/(GLn × G).

The second isomorphism is a consequence of [Rom05, Theorem 4.1], the
third isomorphism comes from [Rom05, Remark 2.4], as GLn ⊂ GLn × G is
a normal subgroup with quotient group G. But now F is a smooth algebraic
space and the action of G × GLn has ﬁnite, reduced stabilizers at geometric
points. Then by [BCE+, Proposition 5.27], the quotient F/(GLn × G) is
again a Deligne-Mumford stack and as F is smooth and a locally trivial
(cid:3)
GLn × G-torsor over it, it is also smooth.

COMPACTIFICATION OF SELF-MAPS SPACE OF CP1 USING STABLE MAPS

85

Lemma C.4. Let M be an Deligne-Mumford stack with a strict action µM
of ﬂat, separated group scheme G of ﬁnite presentation. Let M be a coarse
moduli space carrying the induced action µM of G and assume M is locally
Noetherian. Let N be an algebraic space and [M/G] → N a tame moduli
space (in the sense of [Alp13]). Then there are natural maps

M/G → [M/G] → N

making N a coarse moduli space for M/G and [M/G].

Proof. By deﬁnition, we have

Hom(M/G, S) = HomG(M, S)
for any algebraic space S, where the right means homomorphisms of G-
stacks with the trivial G action on S. But any morphism ψ : M → S must
factor uniquely through a morphism ˜ψ : M → S. Because S is an algebraic
space, the category HomG(M, S) is actually a set(oid) and by deﬁnition it
is given by those morphisms f : M → S of stacks such that

f ◦ µM = f ◦ πM : G × M → S.

Now as M is Deligne-Mumford, it is tame and so the formation of its moduli
space M commutes with base change. Hence G×M is a coarse moduli space
for G × M, so the morphisms from these spaces to S agree. Thus the above
condition is equivalent to asking for a morphism ˜f : M → S such that

˜f ◦ µM = ˜f ◦ πM : G × M → S.
By now we have shown Hom(M/G, S) = HomG(M, S), but as M → [M/G]
is the universal G-torsor over [M/G] this clearly equals Hom([M/G], S). As
M is locally Noetherian, so is [M/G]. Then, by [Alp13, Theorem 6.6], the
good moduli space [M/G] → N is universal among maps to algebraic spaces,
so Hom([M/G], S) = Hom(N, S).

Note that the map M/G → [M/G] is obtained from the morphism M →
M of G-stacks via Lemma C.1, using that M/G = [M/G] by Theorem
[Rom05, Theorem 4.1].

Finally, any geometric point p ∈ M/G corresponds to a (necessarily) triv-
ial G-torsor E → p together with a G-equivariant map E → M. This data is
equivalent to specifying an orbit of some geometric point
p ∈ M. But as the
geometric points of M and M agree, this is equivalent to specifying an orbit
of a geometric point in M . In turn, this is equivalent to a geometric point
of [M/G]. By the deﬁnition of a tame moduli space, the geometric points
of [M/G] and N agree. This shows that geometric points of M/G, [M/G]
(cid:3)
and N coincide.

b

Remark C.5. A suﬃcient condition for the morphism [M/G] → N to be a
tame moduli space is to require that G is a smooth, aﬃne, linearly reductive
group scheme over a ﬁeld k and M = M ss = M s for some G-linearized line
bundle L on M and N = M//G. This is the only situation in which we are
going to use the above result.

86

JOHANNES SCHMITT

Note that in the Lemma above, it does not suﬃce to ask for instance N
to be a geometric quotient of M by G, if M is a scheme. Indeed, in Example
8.6 of [Alp13] we have a geometric quotient X → A1 of a scheme X by SL2
such that X/G = [X/G] is the non-locally separated aﬃne line, which is
an algebraic space. Hence A1 is not universal for morphisms from X/G to
algebraic spaces.

The following type of group action on a stack appears in the study of

self-maps.

Lemma C.6. Let X be a projective, algebraic scheme over C and β ∈ A1X.
Let G be a group scheme over S = Spec(C) with multiplication m : G×G →
G and unit e : S → G. Assume that σ : G × X → X is an algebraic action
leaving β invariant.

Then there is an induced action of G on M = M0,n(X, β), which sends

a C-point (g, (f : C → X; p1, . . . , pn)) to (σ(g, −) ◦ f : C → X; p1, . . . , pn).

Proof. By [Rom05, Deﬁnition 2.1], an action of G on M is a morphism of
stacks µ : G × M → M such that the diagram

(35)

G × G × M

m×idM−−−−−→ G × M

idG×µ

µ


G × M

y

µ


−−−−→ M

y

commutes and such that µ ◦ (e × idM) = idM. Note that we want these
equalities of 1-morphisms to hold strictly, that is not up to a choice of 2-
morphism between them. We now proceed to construct µ and check the
relations above.

As all our ﬁbre products are over the base category S = Sch/S, an object

in G × M over a scheme T → S consists of a tuple

f

X

C

π

T

T



g

,

G







, p1, . . . , pn : T → C









with pi sections of π. The functor µ assigns to this the stable family

(π : C → T, g.f : C → X, p1, . . . , pn) where

(36)

g.f = σ ◦ ((g ◦ π) × f ).

One checks that this still deﬁnes an element of M(T ) as the G-action on X
preserves β. Now assume we have a morphism between objects

P = ( T
P ′ = ( T ′ g′

g
−→ G,
−→ G, C ′ π′

C π−→ T,

−→ T ′, C ′ f ′

f
−→ X,
−→ X, p′

C

p1, . . . , pn : T → C ),
1, . . . , p′

n : T ′ → C ′

).

COMPACTIFICATION OF SELF-MAPS SPACE OF CP1 USING STABLE MAPS

87

This morphism is given by the data ϕ : T → T ′, ϕ : C → C ′ such that
g′ ◦ ϕ = g, f ′ ◦ ϕ = f and such that

C

ϕ

−−−−→ C ′

π

π′

becomes a cartesian diagram. Then the induced morphism µ(P → P ′)
between µ(P ) and µ(P ′) shall be given by the same data (ϕ, ϕ). To see that
this is well-deﬁned, we have to check that (g′.f ′) ◦ ϕ = g.f . Indeed


T

y

ϕ


−−−−→ T ′

y

(g′.f ′) ◦ ϕ = σ ◦ ((g′ ◦ π′) × f ′) ◦ ϕ

= σ ◦ ((g′ ◦ π′ ◦ ϕ) × f ′ ◦ ϕ)
= σ ◦ ((g′ ◦ ϕ ◦ π) × f )
= σ ◦ ((g ◦ π) × f ) = g.f.

Now that µ is deﬁned, we ﬁrst check the commutative diagram in (35). First
we start with an object



T

T

g

,

h ,

G

G







f

X

C

π

T

, p1, . . . , pn : T → C



∈ G × G × M.







Then the images under the upper-right and lower-left corners of the diagram
(35) are both stable families π : C → T with identical markings pi so we only
have to show that the maps C → X coincide. Spelling out the deﬁnitions
we obtain the equation

It is shown by the following diagram

(m ◦ (g × h)).f = g.(h.f ).

C

C

((g×h)◦π)×f

((g×h)◦π)×f


G × G × X

y

m×id


G × X

y

µ


G × G × X

y

id×µ


G × X

y

µ


X

y


X

y

where the left and right vertical side are the desired morphisms. Here the
lower diagram commutes because σ is an action. The fact that µ acts iden-
tically on morphisms is clear, because by deﬁnition µ does not change the
data (ϕ, ϕ) of the morphism at all.

88

JOHANNES SCHMITT

The fact that the action µ is compatible with the identity e is also straight-
(cid:3)

forward.

References

[Alp13]

[BCE+]

[BM96]

J. Alper. Good moduli spaces for Artin stacks. Ann. Inst. Fourier (Grenoble),
63(6):2349–2402, 2013.
K. Behrend, B. Conrad, D. Edidin, B. Fantechi, W. Ful-
ton,
stacks.
A.
https://www.math.uzh.ch/index.php?pr_vo_det&key1=1287&key2=580.
K. Behrend and Yu. Manin. Stacks of stable maps and Gromov-Witten in-
variants. Duke Math. J., 85(1):1–60, 1996.

G¨ottsche,

Algebraic

Kresch.

and

L.

[EG98]

[Dol03]

[Dev14]

[BNTGP14] L. Brambila, P. Newstead, R.P. Thomas, and O. Garc´ıa-Prada. Moduli
Spaces, volume 411 of London Mathematical Society Lecture Note Series.
Cambridge University Press, 2014.
The Sage Developers. Sage Mathematics Software (Version 6.1), 2014.
http://www.sagemath.org.
I. Dolgachev. Lectures on invariant theory, volume 296 of London Mathemat-
ical Society Lecture Note Series. Cambridge University Press, Cambridge,
2003.
D. Edidin and W. Graham. Equivariant intersection theory. Invent. Math.,
131(3):595–634, 1998.
W. Fulton and R. Pandharipande. Notes on stable maps and quantum coho-
mology. In Algebraic geometry—Santa Cruz 1995, volume 62 of Proc. Sympos.
Pure Math., pages 45–96. Amer. Math. Soc., Providence, RI, 1997.
W. Fulton. Intersection theory, volume 2 of Ergebnisse der Mathematik und
ihrer Grenzgebiete (3). Springer-Verlag, Berlin, second edition, 1998.
A.B. Givental. Equivariant Gromov-Witten invariants. Internat. Math. Res.
Notices, (13):613–663, 1996.

[Giv96]

[Ful98]

[FP97]

[GJRW96] R. Guralnick, D.B. Jaﬀe, W. Raskind, and R. Wiegand. On the Picard
group: torsion and the kernel induced by a faithfully ﬂat map. J. Algebra,
183(2):420–455, 1996.
R. Hartshorne. Deformation theory, volume 257 of Graduate Texts in Math-
ematics. Springer, New York, 2010.

[Har10]

[Isc74]

[HR74]

[Hur01]

[HKK+03] K. Hori, S. Katz, A. Klemm, R. Pandharipande, R. Thomas, C. Vafa,
R. Vakil, and E. Zaslow. Mirror symmetry, volume 1 of Clay Mathematics
Monographs. American Mathematical Society, Providence, RI; Clay Mathe-
matics Institute, Cambridge, MA, 2003. With a preface by Vafa.
M. Hochster and J.L. Roberts. Rings of invariants of reductive groups acting
on regular rings are Cohen-Macaulay. Advances in Math., 13:115–175, 1974.
A. Hurwitz. Ueber die Anzahl der Riemann’schen Fl¨achen mit gegebenen
Verzweigungspunkten. Math. Ann., 55(1):53–66, 1901.
F. Ischebeck. Zur Picard-Gruppe eines Produktes. Math. Z., 139:141–157,
1974.
D.
Mbarg,n.
https://bitbucket.org/drew_j/top-intersections-on-mbar_g-n, Feb-
ruary 2012.
S. Keel. Intersection theory of moduli space of stable n-pointed curves of
genus zero. Trans. Amer. Math. Soc., 330(2):545–574, 1992.
J. Koll´ar and S. Mori. Birational geometry of algebraic varieties, volume
134 of Cambridge Tracts in Mathematics. Cambridge University Press, Cam-
bridge, 1998. With the collaboration of C. H. Clemens and A. Corti, Trans-
lated from the 1998 Japanese original.

Intersections

Johnson.

[KM98]

[Kee92]

[Joh12]

Top

on

COMPACTIFICATION OF SELF-MAPS SPACE OF CP1 USING STABLE MAPS

89

[Knu83]

[Koc]
[KP01]

[Lev11]

[Mat89]

[MFK94]

[Mil93]

[Mil06]

[MSW14]

[Muk03]

[Nir08]

[OP06]

[Opr05]

[Pan99]

[Rom05]

[sga71]

[Sil98]

[Sil07]

[Sta14]

[Vak99]

[Vis87]

[Vis89]

F.F. Knudsen. The projectivity of the moduli space of stable curves. II. The
stacks Mg,n. Math. Scand., 52(2):161–199, 1983.
J. Kock. Notes on psi classes. http://mat.uab.cat/~kock/GW/notes/psi-notes.pdf.
B. Kim and R. Pandharipande. The connectedness of the moduli space of
maps to homogeneous spaces. In Symplectic geometry and mirror symmetry
(Seoul, 2000), pages 187–201. World Sci. Publ., River Edge, NJ, 2001.
A. Levy. The space of morphisms on projective space. Acta Arith., 146(1):13–
31, 2011.
H. Matsumura. Commutative ring theory, volume 8 of Cambridge Studies
in Advanced Mathematics. Cambridge University Press, Cambridge, second
edition, 1989. Translated from the Japanese by M. Reid.
D. Mumford, J. Fogarty, and F. Kirwan. Geometric invariant theory, vol-
ume 34 of Ergebnisse der Mathematik und ihrer Grenzgebiete (2). Springer-
Verlag, Berlin, third edition, 1994.
J. Milnor. Geometry and dynamics of quadratic rational maps. Experiment.
Math., 2(1):37–83, 1993. With an appendix by the author and Lei Tan.
J. Milnor. Dynamics in one complex variable, volume 160 of Annals of Math-
ematics Studies. Princeton University Press, Princeton, NJ, third edition,
2006.
N. Miasnikov, B. Stout, and P. Williams. Automorphism loci for the moduli
space of rational maps. ArXiv e-prints, August 2014.
S. Mukai. An introduction to invariants and moduli, volume 81 of Cambridge
Studies in Advanced Mathematics. Cambridge University Press, Cambridge,
2003. Translated from the 1998 and 2000 Japanese editions by W. M. Oxbury.
F. Nironi. Grothendieck Duality for Deligne-Mumford Stacks. ArXiv e-prints,
November 2008.
A. Okounkov and R. Pandharipande. Gromov-Witten theory, Hurwitz theory,
and completed cycles. Ann. of Math. (2), 163(2):517–560, 2006.
D. Oprea. Divisors on the moduli spaces of stable maps to ﬂag varieties and
reconstruction. J. Reine Angew. Math., 586:169–205, 2005.
Intersections of Q-divisors on Kontsevich’s moduli
R. Pandharipande.
space M 0,n(Pr, d) and enumerative geometry. Trans. Amer. Math. Soc.,
351(4):1481–1505, 1999.
M. Romagny. Group actions on stacks and applications. Michigan Math. J.,
53(1):209–236, 2005.
Revˆetements ´etales et groupe fondamental. Springer-Verlag, Berlin-New York,
1971. S´eminaire de G´eom´etrie Alg´ebrique du Bois Marie 1960–1961 (SGA
1), Dirig´e par Alexandre Grothendieck. Augment´e de deux expos´es de M.
Raynaud, Lecture Notes in Mathematics, Vol. 224.
J.H. Silverman. The space of rational maps on P1. Duke Math. J., 94(1):41–
77, 1998.
J.H. Silverman. The arithmetic of dynamical systems, volume 241 of Graduate
Texts in Mathematics. Springer, New York, 2007.
The
Project
http://stacks.math.columbia.edu, 2014.
R. Vakil. The characteristic numbers of quartic plane curves. Canad. J.
Math., 51(5):1089–1120, 1999.
A. Vistoli. Chow groups of quotient varieties. J. Algebra, 107(2):410–424,
1987.
A. Vistoli. Intersection theory on algebraic stacks and on their moduli spaces.
Invent. Math., 97(3):613–670, 1989.

Authors.

Project.

Stacks

Stacks

90

JOHANNES SCHMITT

Departement Mathematik, ETH Z¨urich, R¨amistrasse 101, 8092 Z¨urich, Switzer-

land

E-mail address: johannes.schmitt@math.ethz.ch

