rsta.royalsocietypublishing.org

Research

Article submitted to journal

Subject Areas:

Keywords:

Author for correspondence:

l.mckemmish@unsw.edu.au,

j.tennyson@ucl.ac.uk

General Mathematical
Formulation of Scattering
Processes in Atom-Diatomic
Collisions in the RmatReact
Methodology

Laura K. McKemmish,1,2 Jonathan
Tennyson2

Accurately modelling cold and ultracold reactive collisions occuring over deep potential
wells, such as D+ + H2 −−→ H+ + HD, requires the development of new theoretical
and computational methodologies. One potentially useful framework is the R-matrix
method adopted widely for electron-molecule collisions which has more recently been
applied to non-reactive heavy particle collisions such as Ar-Ar. The existing treatment of
non-reactive elastic and inelastic scattering needs to be substantially extended to enable
modelling of reactive collisions: this is the subject of this paper. Herein, we develop
the general mathematical formulation for non-reactive elastic and inelastic scattering,
photo-association, photo-dissociation, charge exchange and reactive scattering using the
R-matrix method. Of particular note is that the inner region, of central importance to
calculable R-matrix methodologies, must be ﬁnite in all scattering coordinates rather
than a single scattering coordinate as for non-reactive scattering.

9
1
0
2

b
e
F
7

]
h
p
-
m
e
h
c
.
s
c
i
s
y
h
p
[

1
v
5
4
5
2
0
.
2
0
9
1
:
v
i
X
r
a

1. Introduction

The rapid development of techniques for producing cold and even ultracold molecules over the last decade is now enabling the study
of chemical reactions and scattering at the quantum scattering limit with only a few partial waves contributing to the incident channel.
Moreover, the ability to perform these experiments with nonthermal distributions comprising speciﬁc states enables the observation

c(cid:13) The Authors. Published by the Royal Society under the terms of the

Creative Commons Attribution License http://creativecommons.org/licenses/

by/4.0/, which permits unrestricted use, provided the original author and

source are credited.

 
 
 
 
 
 
2

l

r
s
t
a
.
r
o
y
a
s
o
c
e
t
y
p
u
b

i

l
i

i

s
h
n
g
.
o
r
g

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

P
h

i
l
.

.

.

.

.

.

.

.

.

T
r
a
n
s
.

.

.

.

.

R

.

.

.

.

.

S
o
c
0
0
0
0
0
0
0

.

.

.

.

.

.

.

.

.

.

.

.

.

.

and even full control of state-to-state collision rates in this regime. This is perhaps the most elementary study possible of scattering
and reaction dynamics [1]. These experiments are driving the development of new theory to address the new physics encountered in
these ultra-slow collisions. Reactions involved charged species are of special interest, in part because of the extra experimental control
possible for charge particles [2].

[Table 1 about here.]

Due to the strength of the H3

+ system interaction, the reaction of H+ with H2 can be particularly expected to show quantum
behaviour at ultralow collision energies (temperatures); this has meant that the H+
3 system has become a benchmark system for the study
of ultracold reactions [3–9]. Processes of interest are described in Table 1 using the H2D+ system as an example. Other near-dissociation
properties of H+
3 that merit study include the near-infrared photodissociation spectrum which was extensively chararacterised by
Carrington, McNab and co-workers [10–14], but which remains poorly understood [15]. The long-range H+ – H2 potential has been
shown to support diffuse states which were called asymptotic vibrational states [16]. These states have some similar characteristics
to halo states found in diatomic systems [17] but unlike the diatomic systems are likely to be present in signiﬁcant numbers although
the actual density and structure of these states remains to be determined. Finally, formation of H+
3 by radiative association could be
important in diffuse environments such as the early Universe. There are low temperature measurements of this rate [18] but no theory
and no studies at very low temperatures.

Procedures based on the use of hyperspherical coordinates [19–21] have been developed to solve the close-coupling equations, and

applied to treat ultra-low energy reactive scattering in D++H2 see Lara et. al. [9] and references therein.

RmatReact is promising new methodology that addresses this problem by solving an initial energy-independent problem that
encapsulates most of the complicated physics in an inner region. These inner region solutions are then used to describe the scattering-
dependent problem in the simpler outer region. This approach can be employed study not just the reactive scattering process but,
in principle, all the processes in Table 1. The RmatReact methodology described here is a spiritual successor to the extremely
successful electron-molecule collision codes such as UKRMol [22,23], and indeed our implementation reuses part of this code base.
Both methodologies separate space into three regions based on the distance between the two scattering partners: the inner, outer and
asymptotic region. The inner region contains the region with signiﬁcant non-multipole, and indeed non-local, interaction between the
two scattering species; the Schrodinger equation solved here does not consider the scattering energy. The outer region contains the
region where the interaction between the two scattering species is signiﬁcant but simple in form (usually a multipole expansions); the
outer region equations depend on the scattering energy and are solved once for every different scattering energy under consideration
using the inner region solutions and a simple 1D propagation process. The asymptotic region is deﬁned as the region in which the
interaction between the scattering species is much less than the scattering energy and thus negligible; at this point, we can calculate
properties of the overall scattering interaction such as cross-sections.

The mathematical formulation of our RmatReact methodology for non-reactive single and multi-channel scattering was previously
presented by Tennyson et. al. [24]. Two initial applications of this new RmatReact calculable R-matrix method for heavy-particle
scattering to atom-atom collisions over the Morse potential and Ar-Ar scattering were presented by Rivlin et. al. [25,26].

Here, we extend the mathematical formulation of the RmatReact methodology to triatomics and consider for the ﬁrst time photo-

association, photo-dissociation, charge exchange and reactive scattering.

2. Mathematical Formulation

(a) Overview of general RmatReact methodology

Our methodology models scattering of atoms or molecules A and B with center of mass separation distance RAB using the following
steps:

(i) Variationally solve the (3N -3)D Schrodinger equation of the joint system AB in a ﬁnite region at zero scattering energy
(including Bloch terms to ensure the Hermicity of the Hamiltonian) where N is the total number of nuclei in the system and
RAB less than some box size a0: this produces a discrete number, Z, of inner-region energies, Ei, and wavefunctions, ψi.
(ii) Map the (3N-3)D problem onto a 1D Hamiltonian in RAB, with a reduced potential, U (RAB). Simultaneously, each inner-

region wavefunctions, ψi, can be mapped onto outer region channels, φc producing the surface amplitudes, ωc,i.

(iii) Using the energy-independent solutions, for each scattering energy under consideration, construct the scattering-energy-
dependent R-matrix (to be deﬁned below) at the boundary, thereby using the ﬁrst set of solutions as an effective basis for
describing the desired second set.

(iv) For each scattering energy, propagate this R-matrix to an asymptotic distance, at which point scattering observables such as

cross-section can be evaluated using simple formulae.

The Schrodinger equation solved in Step (i) is generally different for each system size. The bound state nuclear motion problem has
been extensively considered in the context of high resolution spectroscopy studies [27]. Introducing a ﬁnite region boundary into the
problem does modify the Schrodinger equation somewhat and considerably change the nature of the solution, particularly in modiﬁed
boundary conditions at RAB = a0 and through discretisation of the solutions above dissociation.

3

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

l

r
s
t
a
.
r
o
y
a
s
o
c
e
t
y
p
u
b

i

l
i

i

s
h
n
g
.
o
r
g

.

.

.

.

.

.

.

.

.

.

P
h

i
l
.

.

.

.

.

.

.

.

.

.

.

T
r
a
n
s
.

R

.

.

.

S
o
c
0
0
0
0
0
0
0

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

The Schrodinger equation solved in Step (iii) has the same general form for all system sizes (and indeed is the same as the equations
used in R-matrix theory for electron-atom and electron-molecule collisions aside from a reduced mass factor); a single program can
hence be used in this outer region, with only numerical considerations (e.g. step-size) changing between systems. However, the form
of the reduced potential, U (RAB), changes with system size and is often non-trivial, particularly if coordinate transformations are
involved.

(b) Developing the mathematical description of scattering processes using the RmatReact

methodology

(i) Establishing the problem

Much of the mathematics and analysis in this paper does not rely on the system being triatomic, and none relies on the system being
+ or its isotopologues, though this will be used extensively as a illustrative and useful example of the methodologies discussed.
H3

Non-reactive elastic and inelastic scattering A triatomic non-reactive scattering problem, e.g. H+ + H2 −−→ H+ + H2, is most
effectively solved using Jacobi coordinates, with r1 as the diatomic bond distance, r2 as the distance between the centre of mass of the
diatomic and the scattering atom, and θ as the angle between these two vectors.

Photo-association and photo-dissociation Non-reactive scattering coordinates are most appropriate here. These processes are half-
collision processes involving scattering energy equal to the photon energy, hν, minus the difference in energy between the dissociation
energy D0 and the energy of the initial state, E0, i.e. E = hν − D0 + E0.

Charge Exchange Treating charge exchange requires at least two electronic potential energy surfaces, called X and A here for
simplicity. It is simplest to represent both potentials in a single coordinate system, the same as that used for non-reactive scattering.

Reactive scattering Consider a reactive scattering system which includes scattering channels with products A+BC, B+AC and C+AB
with coordinates A, B and C respectively. Jacobi coordinates can be deﬁned for each scattering coordinate when considering the
triatomic reactive scattering case. Simpliﬁcation to just two channels (i.e. modelling just a single reaction) is straightforward, and the
extension to more than three channels logical.

The mathematics described here builds on that presented in Chapter 7 of Burke [28]; this has been successfully used for the study

of the positron-atom and positronium-ion reactive collision problem [29].

(ii) Nuclear Motion Schrodinger Equation: Solving the Inner Region Hamiltonian at energy-independent

The ﬁrst stage of the RmatReact methodology is to ﬁnd the wavefunctions and energies of the combined system in a ﬁnite inner region
with zero scattering-energy. As these solutions will formally form a complete basis set in this ﬁnite region, these solutions can be used
as a basis to describe the solutions to the scattering-energy-dependent problem in this inner region, i.e.

Ψ (E) =

(cid:88)

i

Ai(E)ψi

(2.1)

where E is the scattering energy, Ψ (E) is the inner region solution to the scattering-energy-dependent Schrodinger equation, i count
the solutions to the energy-independent inner region problem ψi and Ai are expansion coefﬁcients.

In traditional quantum chemistry treatments, the full Schrodinger equation can be simpliﬁed by ignoring translational wavefunction
and separating electronic, vibrational and rotational wavefunction. The separation of the electronic component is an approximation,
known as the Born-Oppenheimer approximation [30], while the separation identiﬁcation of the vibrational and electronic components
is not an approximation provided the Corolois term is included (as we do). The electronic component is considered in electronic structure
packages to produce potential energy curves. In nuclear motion packages when treating a single electronic state, the total wavefunction
can be represented as a sum of products between rotational and vibrational wavefunctions, i.e. ψtotal = (cid:80)
(coefﬁcients of the
summation are absorbed into the vibrational wavefunction typically). The rotational wavefunction is a function of Euler angles α, β,
γ and is quantised in terms of J (the total angular momentum of the triatomic system), M (the projected total angular momentum of
the system onto the space-ﬁxed z axis), and Ω (the projected total angular momentum of the system onto the body-ﬁxed z axis) and
described using Wigner D-functions [31], DJ∗
M Ω. Note in the absence of an external ﬁeld, M does not affect the energy of a molecular
system and can be dropped from consideratio. Using this ansatz, the full Schrodinger equation is simpliﬁed to a set of J-dependent
3N − 6 dimensional Schrodinger equations that are typically given in internal vibrational coordinates. The total wavefunction thus
becomes

i ψvib
i

i ψrot

(cid:88)

ψtotal =

J DJ∗
ψvib

M Ω(α, β, γ).

(2.2)

This basis set, or appropriately symmetrised versions of it, are used in variational nuclear motion programs, such as DVR3D [32] for
triatomic systems, to yield the vibrational wavefunctions, ψvib

J . For triatomics, using Jacobi coordinates gives ψvib

J (r1, r2, θ).

The solutions to the traditional problem are bound state normalisable wavefunctions. In describing scattering, however, we need
to include non-bound solutions corresponding to energies above the dissociation energy. Therefore, we move from an inﬁnite region

M ΩJ

to a ﬁnite region, i.e. form a ﬁnite inner region, thereby discretising the continuum solutions. We ultimately desire the wavefunction
solutions to the scattering Schrodinger equation at a large number of speciﬁc low scattering energies. An effective basis set to describe
this large number of solutions can be formed by solving the single problem at zero scattering energy, as long as some of these solutions
have non-zero value at the boundary between the inner and outer region (the R-matrix boundary). This is the ﬁrst task of any R-matrix
approach.

Deﬁning the inner region is a key component of the RmatReact methodology; slightly different concerns are necessary for each type

of scattering process.

Non-reactive elastic and inelastic scattering We formulate the inner region by introducing a ﬁnite domain constraint in the scattering
coordinate, i.e. 0 ≤ r2 ≤ a0 (utilising Jacobi coordinates), where a0 is known as the R-matrix boundary and deﬁned as the scattering
coordinate beyond which the two scattering systems interact via multipoles only to within the desired error, i.e. the potential beyond
a0 can be reduced from a full (3N − 6)D potential to an effective 1D potential in the scattering coordinate r2. In the inner region,
we need at least one basis function which has a non-zero value at the R-matrix boundary r2 = a0 in order to describe the scattering
wavefunction. We have found Lobatto shape functions [33–35] to be a suitable choice of basis functions for this coordinate [26,36].

Photo-association, photo-dissociation The inner region for photo-association and photo-dissociation will be deﬁned as for non-
reactive scattering with the additional caveat that the treatment of these processes [37] becomes more complicated [38] if the quantum
state of the combined system has signiﬁcant magnitude beyond the R-matrix boundary (this case will not be considered here). In photo-
dissociation, one would expect the reactant state to be well-bound and this will thus generally not be an issue. This is more likely to
arise in photo-association when the product system (e.g. H2D+) may be weakly bound in asymptotic halo states whose wavefunction is
extended.

4

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

l

r
s
t
a
.
r
o
y
a
s
o
c
e
t
y
p
u
b

i

l
i

i

s
h
n
g
.
o
r
g

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

P
h

i
l
.

T
r
a
n
s
.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

R

.

S
o
c
0
0
0
0
0
0
0

Charge-exchange reactions The inner region R-matrix boundary a0 should be deﬁned such that it contains all non-negligible
coupling between the two electronic states.

.

.

.

.

Reactive scattering We need to expand this deﬁnition from a inner region deﬁned by a single restricted domain to one that is
constrained in all relevant scattering coordinates, i.e. 0 ≤ rA
0 . Again, the three a0 values should
be chosen such that the interaction between A, B and C can be modelled as a function of the scattering coordinate alone. To ensure the
Hermiticity of the Schrodinger equation in this restricted region, we construct Bloch operators [39] at each of these boundaries like

0 and 0 ≤ rC

0 , 0 ≤ rB

2 ≤ aB

2 ≤ aA

2 ≤ aC

LA =

1
2

δ(rA

2 − aA
0 )

d
drA
2

We then want to ﬁnd the solutions to the Schrodinger equation with these Bloch terms, i.e. ﬁnd Z solutions Ei, Ψi to

(T + V + LA + LB + LC )ψi = Eiψi

(2.3)

(2.4)

where T is the kinetic energy operator and V is the potential energy operator for the system of interest. This is most easily done by
using existing nuclear motion programs, e.g. DVR3D for triatomic systems, in which the Hamiltonian is modiﬁed to incorporate the
Bloch terms and the basis functions are modiﬁed for this ﬁnite region. These inner region solutions i will include both bound states
of the molecule and a ﬁnite number of discretised continuum states. The strongly bound states will have energies and wavefunctions
indistinguishable from the inﬁnite region problem, but more weakly bound states will be inﬂuenced by the ﬁnite region constraints and
be modiﬁed. As the box size increases, the differences for these weakly bound states will be smaller. The number of solutions will
formally be equal to the number of basis functions utilised; however, we will only need to consider solutions with energies close to the
scattering energy (often just above the dissociation energy of the reactant channel).

The Bloch terms and ﬁnite region introduces substantial requirements for the basis set, which must now ideally consist of
basis functions with ﬁnite domain in three non-orthogonal scattering coordinates rA
2 , with tractable resulting integrals.
Furthermore, for each scattering boundary, at least one basis function must have a non-zero value but zero derivative; the zero derivative
boundary condition introduced by necessity by the Bloch operator is a non-trivial and not often understood condition that has become
obvious in our considerations of wavefunctions for RmatReact but which has been obscured in electron-molecule collision problems
due to their far inferior basis sets: this fact is demonstrated in a simple system in the Appendix. These multiple boundary conditions
are unusual and non-trivial constraints on the design of the basis set that are not yet fully understood, and will be the most challenging
part of utilising the RmatReact methodology for reactive collisions. We will thus defer its consideration to Section 3. We should,
however, be reassured by the fact that this type of approach has been successfully utilised in light particle reactive collisions, e.g. where
positron-atom reactants react to positronium-ion products [28,29].

2 and rC

2 , rB

(iii) Scattering Theory: Describing the Outer Region using Channels and Reduced Radial Functions

The close-coupling equations [40] also simpliﬁes the full Schrodinger equation in order to progress; however, instead of separating based
on rotational and vibrational wavefunction, the wavefunction in the scattering coordinate (the reduced radial function) is separated from
the other components of the wavefunction, which are described as channel in standard close-coupling treatments.

Non-reactive scattering The wavefunction in terms of channels and the reduced radial function, F as

5

ψtotal =

channels
(cid:88)

c

1
r2

Fc(r2)Φc

(2.5)

where the deﬁnition of F is by convention, c goes over all channel functions and Φc are the channel functions with all necessary
coordinates orthogonal to r2. The product of the quantum states of the two isolated systems and their relative angular motion is
typically used deﬁne the channels. For example, consider the triatomic system A + BC. The scattering coordinate is rA
2 , the diatomic
vibrational wavefunction is χn(r1), the rotational angular momentum of the diatomic is j and the relative angular momentum between
the atom and diatomic is l, with the channel deﬁned by nlj and having energy equal to the diatomic vibrational and rotational energy.
Mathematically, we can use our knowledge of the energies and wavefunctions of the asymptotic reactant and products that deﬁne the
channel based on solving the bound state (N − 1)-dimensional problem for which there are well-developed program solutions in the
nuclear motion community; in the case of atom-diatomic scattering, this means using codes such as LEVEL [41] or DUO [42]. The
form Equation (2.5) can in principle be used to describe the wavefunction in any region of space. However, for small rG
2 , the number
+, H2O), i.e. the potential energy surface is deep
of channels will be high especially if the combined system is strongly bound (e.g. H3
compared to the vibrational spacings. This is one key reason why the inner region problem is solved separately using traditional nuclear
motion techniques in the full dimensional space rather than using the equations in this section. In the outer region, however, for non-
reactive scattering problem, only a small number of channels are important for describing systems, especially for ultracold collsions
where often only a single rotational levels is populated.

The Schrodinger equation to be solved in the outer region for non-reactive scattering is given by the close-coupling [40] expansion:

(cid:18)

−

(cid:126)2
2µ2

∂2
∂r2
2

+

(cid:126)2
2µ2

l(l + 1)
r2
2

(cid:19)

+ (enj − E)

Fc(r2) = −

ˆUc,c(cid:48) (r2)Fc(cid:48) (r2)

(cid:88)

c(cid:48)

(2.6)

l

r
s
t
a
.
r
o
y
a
s
o
c
e
t
y
p
u
b

i

l
i

i

s
h
n
g
.
o
r
g

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

P
h

i
l
.

.

.

.

.

.

.

.

.

.

.

T
r
a
n
s
.

.

.

.

.

R

.

S
o
c
0
0
0
0
0
0
0

.

.

.

.

.

.

.

.

.

.

.

.

.

.

(cid:126)2
2µ2

is the reduced mass along the Jacobu ‘scattering’ coordinate, E is the scattering energy, enj is the energy of the n, j state
where
of the diatomic and Uc,c(cid:48) (r2) is the reduced potential (cid:104)φc|∆V |φ(cid:48)
c(cid:105) with ∆V equal to the difference between the total potential energy
operator for the triatomic system and the diatomic potential energy operator; thus Uc,c(cid:48) → 0 as r2 increases. The values of a0 should
be determined such that Uc,c(cid:48) (r2) is well represented by a multipole expansion in r2.

.

.

.

.

Photo-association, photo-dissociation In photo-association and photo-dissociation, only the reactant and product respectively
consist of separated species (e.g. H2 and D+) that are described by channels; the combined system (e.g. H2D+) will be described
by the quantum numbers of the combined system.

Charge-exchange The full wavefunction in the outer region will be described by channels in both electronic states, cX , and cA, i.e.

ψtotal =

(cid:88)

cX

1
r2

FcX (r2)ΦcX +

(cid:88)

cA

1
r2

FcA (r2)ΦcA .

(2.7)

The cX and cA channels are two sets of uncoupled channels. We can extend Equation (2.6) to sum over all c = {cX , cA} as long as
<< E for all cX , cA, i.e. the interaction between channels on the different electronic surfaces are negligible compared to the
UcX ,cA
scattering energy .

Reactive scattering In this more complicated case, we need to be able to deal with multiple scattering coordinates (i.e. rA
and thus channels in multiple coordinates, ΦcA , ΦcB and ΦcC , and multiple reduced radial functions FcA (rA
For generic coordinates, we will use ‘G’ as our notation. We can thus write the total wavefunction as

2 ), FcB (rB

2 , rC
2 , rB
2 ),
2 ) and FcC (rC
2 ).

ψtotal =

(cid:88)

cA

1
rA
2

FcA (rA

2 )ΦcA +

(cid:88)

cB

1
rB
2

FcB (rB

2 )ΦcB +

(cid:88)

cC

1
rC
2

FcC (rC

2 )ΦcC

(2.8)

where the coordinates of each of the channels are orthogonal to their associated rC

2 coordinate.

The number of channels in the outer region is dependent on the difference in energy between the reactant and product; modelling
more exothermic reactive scattering processes will necessitate a much larger number of channels with a consequent considerable
increase in the calculation time.

To ﬁnd FcG (rG

2 ) beyond the R-matrix boundary aG

0 , we reduce the full-dimensional Schrodinger to three one-dimension scattering
Schrodinger equation in each set of coordinates G = A, B, C equal to the Equation (2.6). Note that by construction of the multiple
R-matrix boundaries, the reduced potential U connecting channels that scatter in different coordinates should be negligible compared
to the scattering energy.

(iv) Energy-dependent Scattering using RmatReact methodology

Non-reactive scattering The mathematics here has been discussed by Tennyson et. al. [24] and is summarised here to make clear the
differences in treatment necessary between non-reactive scattering (the simplest kind of process) and the other processes, particularly
reactive scattering.

We have discussed earlier the fact that we solve the inner region energy-independent problem in order to provide an efﬁcient basis for
describing the non-zero-scattering energy problem at the boundary, i.e. Equation (2.1). Mathematically, this approach utilises resolution
of the identity (i.e. 1 = (cid:80)

i |i(cid:105) (cid:104)i|) and provides a spectral representation of the Green’s function to ﬁnd

|Ψ (E)(cid:105) =

Z
(cid:88)

i=1

|ψi(cid:105)

1
Ei − E

(cid:104)ψi|L|Ψ (E)(cid:105)

(2.9)

where L is the Bloch term given by L = (cid:126)2
, Ψ (E) is the scattering-energy-dependent wavefunction and E is again
2µ2
the scattering energy. The summation runs over all inner region solutions, i, which is formally inﬁnite but in practice ﬁnite due to the
representation of the inner region solutions in a basis set of size Z. As this equation has the desired solution Ψ (E) on both sides, this
representation cannot be directly utilised in a computational solution.

δ(r2 − a0) d
dr2

Instead, mathematical transformations described in Burke [28] and Tennyson et. al. [24] yield an expression linking the reduced

radial functions F and the R-matrix R at the R-matrix boundary r2 = a0 as

with the R-matrix deﬁned by

Fc(a0) =

(cid:88)

c

Rcc(cid:48) (E)a0

dFc
dr2

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)r2=a0

Rcc(cid:48) (E) =

1
2a0

Z
(cid:88)

i=1

ωc,iωc(cid:48),i
Ei − E

(2.10)

(2.11)

where the summation i is over all inner region solutions, c, c(cid:48) go over all channels and ωc,i are the surface amplitudes deﬁned by
(cid:28) φc
r2

ωc,i =

ψi

(cid:29)(cid:48)

(cid:12)
(cid:12)
(cid:12)
(cid:12)

(2.12)

r2=a0

where the prime in the Braket notation indicates the integral is over all coordinates except r2.

Note that the coordinate systems for the inner and outer region, and quantum numbers for the inner region solutions and outer
region channels need to be carefully considered and can have a substantial effect on the calculation time and accuracy. In particular, we
highlight that inner-region codes are generally based on body-ﬁxed coordinates, whereas outer-region propagation codes will generally
use space-ﬁxed coordinates to allow identiﬁcation of the asymptotic channels with the states of the fragmented systems. Thus, a frame
transformation is required to convert between these; this is discussed in Appendix A (which also deﬁnes the below quantum numbers
and notation). The key integral that must be calculated is the surface amplitude between inner region solution i and outer region channel
njl, denoted as ωJM (cid:15)
njl,i (a0), where the JM (cid:15) denote the quantum numbers for the combined triatomic system. As made clear by the
notation, the outer region channel function is usually deﬁned in space-ﬁxed (SF) coordinates as φJM (cid:15)
. The inner region solution,
njl
n(cid:48)j(cid:48) ¯Ω(cid:48) (r2)BF φJM (cid:15)
n(cid:48)j(cid:48) ¯Ω(cid:48) F JM (cid:15)
BF ψJM (cid:15)
n(cid:48)j(cid:48) ¯Ω(cid:48) . Thus
i
the surface amplitude can be calculated using

, is deﬁned in body-ﬁxed coordinates such that it can be expanded as BF ψJM (cid:15)

= (cid:80)

i

6

l

r
s
t
a
.
r
o
y
a
s
o
c
e
t
y
p
u
b

i

l
i

i

s
h
n
g
.
o
r
g

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

P
h

i
l
.

T
r
a
n
s
.

.

.

.

.

.

.

.

.

R

.

S
o
c
0
0
0
0
0
0
0

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

ωJM (cid:15)
njl,i (a0) =

(cid:42) SF φJM (cid:15)
njl
r2

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

(cid:43)(cid:48)

BF ψJM (cid:15)
i

P JM (cid:15):j
l ¯Ω

(cid:88)

¯Ω

(cid:42) BF φJM (cid:15)
nj ¯Ω
r2

r2=a0
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

(cid:88)

n(cid:48)j(cid:48) ¯Ω(cid:48)

n(cid:48)j(cid:48) ¯Ω(cid:48) (r2)BF φJM (cid:15)
F JM (cid:15)
n(cid:48)j(cid:48) ¯Ω(cid:48)

(cid:43)(cid:48)

1
a0

F JM (cid:15)

n(cid:48)j(cid:48) ¯Ω(cid:48) (a0)

P JM (cid:15):j
l ¯Ω

(cid:68)BF φJM (cid:15)
nj ¯Ω

(cid:12)
(cid:12)
(cid:12)

BF φJM (cid:15)

n(cid:48)j(cid:48) ¯Ω(cid:48)

r2=a0
(cid:69)(cid:48)

r2=a0

(cid:88)

¯Ω

(cid:88)

F JM (cid:15)

n(cid:48)j(cid:48) ¯Ω(cid:48) (a0)

P JM (cid:15):j
l ¯Ω

δnn(cid:48) δjj(cid:48) δ ¯Ω ¯Ω(cid:48)

¯Ω
nj ¯Ω (a0)P JM (cid:15):j(cid:48)
F JM (cid:15)

l ¯Ω

=

=

=

=

(cid:88)

n(cid:48)j(cid:48) ¯Ω(cid:48)

(cid:88)

n(cid:48)j(cid:48) ¯Ω(cid:48)

1
a0

(cid:88)

¯Ω

1
a0

(2.13)

(2.14)

(2.15)

(2.16)

(2.17)

(2.18)

where we use the fact
(cid:12)
(cid:69)(cid:48)
(cid:68)BF φJM (cid:15)
(cid:12)
n(cid:48)j(cid:48) ¯Ω(cid:48)
(cid:12)

BF φJM (cid:15)
nj ¯Ω

r2=a0

that

the channels in body-ﬁxed coordinates are deﬁned such that
= δnn(cid:48) δjj(cid:48) δ ¯Ω ¯Ω(cid:48) .

they are orthonormal,

i.e.

Photo-association and photo-dissociation To describe photo-association and photo-dissociation processes using the R-matrix
approach, we need to follow the approach to atomic photo-ionisation developed by Burke and Taylor [37] which links the initial
wavefunction with the ﬁnal wavefunction in the inner regions through the electric dipole.

In the case of photo-dissociation, let the initial wavefunction be Ψ0, an eigenstate of the energy-independent inner region, i.e. ψi
+). In the inner region, the

for some i; this will often be the ground or low-lying rovibrational states of the combined system (e.g. H3

7

l

r
s
t
a
.
r
o
y
a
s
o
c
e
t
y
p
u
b

i

l
i

i

s
h
n
g
.
o
r
g

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

T
r
a
n
s
.

P
h

i
l
.

.

.

.

.

R

.

.

.

.

.

S
o
c
0
0
0
0
0
0
0

.

.

.

.

.

.

.

.

.

.

.

.

.

.

ﬁnal wavefunction in the inner region, Ψ inner(E), can be written as a sum of inner region wavefunctions ψf where f sums over all
inner region states as in Equation (2.1), where the photon energy, hν, is equal to the scattering energy, E, plus the difference in energy
between the dissociation energy D0 and the energy of the initial state, E0, i.e. hν = E + D0 − E0. Then the integral that characterises
the strength of the photodissociation process as a function of hν is
(cid:12)
(cid:12) Ψ inner(hν − D0 + E0)
(cid:12)
(cid:12) µ (cid:12)
(cid:12)

(cid:12)
(cid:12)
(cid:12) µ
Af (hν − D0 + E0) (cid:10)ψi

µtrans-pd(hν) =

(2.20)

(2.19)

(cid:12) ψf

(cid:88)

Ψ0

=

(cid:69)

(cid:68)

(cid:11)

f

Then, we need to have the dipole moment function for the inner region so that (cid:10)ψi
(cid:11) can be calculated over the full ﬁnite inner
region, as well as Af , i.e. the coefﬁcients of expansion for the scattering-energy-dependent inner region wavefunction in terms of the
energy-independent wavefunction which are generated using non-reactive scattering with half-collision boundary conditions [37].

(cid:12) ψf

(cid:12) µ (cid:12)
(cid:12)

This approach should be capable of providing a complete model for the challenging H+

3 near-dissociation spectrum of Carrington

and coworkers [10–14] including, for example, modeling the different resonance widths observed in their spectra.

The case of photo-association is analogous except that the initial and ﬁnal states are switched, i.e.

µtrans-pa(hν) =

(cid:88)

i

Ai(hν − D0 + E0) (cid:10)ψf

(cid:12) µ (cid:12)
(cid:12)

(cid:12) ψi

(cid:11) ,

(2.21)

where this expression is only valid if the ﬁnal wavefunction ψf can be assumed to have negligible extent beyond the R-matrix boundary
a0. Within an R-matrix formulation it is also possible to consider the contribution of dipole transitions arising from the outer region [38],
but this is beyond the scope of this paper.

Charge-exchange Equation (2.9) applies for the charge exchange process with the channel index c going over both the cX and cA
channels.

Reactive scattering Following the same logic as for the non-scattering case, we obtain

|Ψ (E)(cid:105) =

n
(cid:88)

i=1

|ψi(cid:105)

1
Ei − E

(cid:104)ψi|LA + LB + LC |Ψ (E)(cid:105) ,

(2.22)

with the key difference here being the need for multiple R-matrix boundaries and thus multiple Bloch terms. As we need to consider
multiple boundaries and their associated coordinates, there is a substantially more complex form for the reduced radial functions F
and for the R-matrix, R. Following the methodology for a related derivation in Burke [28], we start from Equation (2.22), project onto
channel functions φcG (different for each coordinate), evaluate on the boundary, and ultimately obtain (in analogy with Eq. (7.26)–(7.27)
of Burke [28]), yielding

cG (aG
F G

0 ) =

(cid:88)

c(cid:48)
A

RcGc(cid:48)

A

(E)aA
0

A

dFc(cid:48)
drA
2

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)rA

2 =aA
0

(cid:88)

+

c(cid:48)
B

RcGc(cid:48)

B

(E)aB
0

B

dFc(cid:48)
drB
2

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)rB

2 =aB
0

(cid:88)

+

c(cid:48)
C

RcGc(cid:48)

C

(E)aC
0

C

dFc(cid:48)
drC
2

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)rC

2 =aC
0

.

(2.23)

and the R-matrix found by

RcGc(cid:48)
G(cid:48)

(E) =

1
2aG(cid:48)
0

Z
(cid:88)

i=1

ωcG,iωc(cid:48)
Ei − E

G(cid:48) i

(2.24)

where cG runs over all channels associated with coordinate G, i.e. A, B, C if A + BC, B + AC, C + AB are all considered explicitly, and
where ωG

c,i is the surface amplitude deﬁned as

ωcG,i =

(cid:42)

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

φcG
rG
2

ψi

(cid:43)(cid:48)

2 =aG
rG
0

(2.25)

Thus, with these equations, the R-matrix at a boundary aG(cid:48)
can be solved and if the surface amplitudes can be computed.

0 can thus be obtained for any scattering energy if the inner region problem

There are a number of important things to note about these expressions. First, the R-matrix is not symmetric with respect to its
indices, i.e. the denominator is a function only of the second coordinate boundary, aG(cid:48)
0 . Second, the summation in this deﬁnition is
formally over all inner region solutions to the energy-independent problem; however in practice bound state solutions corresponding to
states well below dissociation will have near zero amplitudes at all three boundaries (i.e. ωG
ci ≈ 0, ∀G) and can be excluded from the
summation without errors. It should also be possible to signiﬁcantly reduce the sum over inner-region solutions with positive scattering
to within, say, two orders-of-magnitude of the scattering energy, E, using the so-called partitioned R-matrix approach [43,44] which
uses simple formulae based on perturbation theory to correct the R-matrix for the contributions due to higher energy poles. This ability
to trim solutions should provide further contribute to the computational efﬁciency of this method. Finally, the key required integrals that
must be evaluated to utilise these expressions are given by Equation (2.25), in which an inner region solution to the energy-independent
problem ψi is projected onto an outer region channel. How this is done must be considered carefully as it is this point in the calculation
that one can introduce either a coordinate change and/or a frame transformation. Thus for example, one might wish to project solutions

on outer region channels which have different non-orthogonal scattering coordinates. Issues arising from this and possible choices of
inner-region basis sets are discussed in Section 3.

8

l

r
s
t
a
.
r
o
y
a
s
o
c
e
t
y
p
u
b

i

l
i

i

s
h
n
g
.
o
r
g

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

P
h

i
l
.

.

.

.

.

.

.

T
r
a
n
s
.

.

.

.

.

R

.

.

.

S
o
c
0
0
0
0
0
0
0

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

The issue of multiple coordinates to consider does substantially increase the difﬁculty of this problem. Note, for example, how the

surface amplitudes for the inner region solutions need to be evaluated in all scattering coordinates, A, B, C, in order to evaluate R.

(v) Propagation from R-matrix boundaries, and Asymptotic Expansion

There are standard procedures available for R-matrix propagation [45–47] which have been widely and successfully used for both light
and heavy particle scattering. Our proposed solution is to use the parallel fast asymptotic R-matrix (PFARM) code [48]. Therefore
considerations of how to propagate the R-matrix from the boundary to asymptotic distances, and to use asymptotic expansion and
calculate scattering observables, is largely a solved problem. However, we make some notes in this section.

Non-reactive scattering The propagation algorithm to go from the R-matrix boundary to its asymptotic value, and the way in which
these asymptotic R-matrix is used to calculate the K-matrix and other scattering observables, is discussed for the single channel case
in [36]. Extensions to the multi-channel case are in progress, based on the use of PFARM in the outer region.

Photo-association and photo-dissociation Propagation proceeds in the same manner as for non-reactive scattering, except an explicit
form for the wavefunction must be calculated (i.e. the Ai, Af ), and that half-boundary-conditions must be applied [37].

Charge exchange Techniques for propagating the R-matrix from the R-matrix boundary to asymptotic regions for sets of uncoupled
channels is developed for the case of two sets of channels in Appendix E6 of Burke [28], and can be adopted with minimal changes
to this problem. The crucial thing here is that two different electronic states are assumed be non-interacting in the outer region; this
assumption provides the criterion for choosing an appropriate R-matrix boundary. Note that the R-matrices associated with the channels
associatd with the two different surfaces are not always zero, otherwise the rate of the charge exchange process would be zero. Therefore,
the propagation of the entire global R-matrix containing the two set of uncoupled channels needs to be performed at one time [28].

[Figure 1 about here.]

The form of the K matrix expected from a charge exchange calculation is shown diagrammatically in Figure 1. Diagonal elements of
this matrix represent elastic scattering processes, off-diagonal elements within a block represent inelastic processes and off-diagonal
elements outside the two block diagonals represent charge transfer processes as the molecule moves from the X to A state.

Reactive scattering Techniques for propagating the R-matrix and reduced radial wavefunction from the R-matrix boundary to
asymptotic regions for sets of uncoupled channels is developed for the case of two sets of channels in Burke [28]; extensions to
three sets of channels, if necessary for a particular problem, do not introduce fundamental changes to the approach here and will thus
not be considered further in this paper. The mathematical framework used to solve the outer region problem of reactively scattering
atoms from positrons to form ions and positronium (considered by Burke) is highly analogous to the framework needed to describe
reactive scattering of atoms and diatomics. A full computational implementation of this mathematical framework will be the subject of
a future paper.

The key required component for this outer region propagation is an expression of the reduced 1D potential energy curves, Uc,c(cid:48) ,

deﬁned in Equation (2.6). A multipole expansion of the form

UcG,c(cid:48)
G(cid:48)

(r2) =

λmax
(cid:88)

λ=1

acG,c(cid:48)

G(cid:48) ,λ(rG

2 )−λ−1δG,G(cid:48)

(2.26)

is generally sufﬁcient in the outer region, simplifying the propagation procedure. The value of the coefﬁcients, ac,c(cid:48),λ, can be obtained
through appropriate integration of the non-diatomic potential, ∆V , over the channels in all coordinates other than the scattering
coordinate of interest, rG
+. Note that the reduced potential between channels in
different scattering coordinates must be negligible (and set as zero) for this methodology to be implementable.

2 . Thus for channels associated with H2 + H+H3

The form of the K matrix for the full reactive scattering problem involving all three scattering coordinates will be a logical extension
from Figure 1, with diagonal elements representing elastic scattering processes, off-diagonal in block elements representing inelastic
processes and off-diagonal, off-block elements representing reactive scattering where the product and reactant are described using
different Jacobi scattering coordinates.

3.

Inner Region Coordinates and Basis Sets for Reactive Scattering

For polyatomic systems the variational nuclear motion programs we plan to use to provide solutions to the inner region problem,
namely DVR3D [32], WAVR4 [49] and TROVE [50], all provide the choice of using a variety of different internal coordinates and
some control over the basis set employed. So far we assumed the use of Jacobi coordinates and have not deﬁned the basis sets will be
used to compute the inner region energy-independent solutions ψi. Basis sets consist of basis functions that are generally products of
one-dimension basis functions in each coordinate of interest. In practice, the nuclear motion problems are generally solved on a discrete

variable representation (DVR) grid but transformation between polynomial basis functions and a DVR is straightforward [51], so it is
sufﬁcient at this stage to simply consider basis functions.

For studies of the bound states of H3

+ and its isotopologues including those up to dissociation, Jacobi coordinates have proven
extremely successful [52–55], despite not representing the full symmetry of the problem. In describing these processes in the inner
region problem, we use Laguerre polynomials (either Morse-like oscillators [56] or spherical oscillator [57]) for the “diatomic”r1 Jacobi
coordinates, (associated) Legendre polynomials for the θ coordinate and Lobatto shape functions for the ﬁnite r2 Jacobi coordinates. At
the R-matrix boundary, we need at least one basis function to have a non-zero value (and formally the true solution has a zero-derivative
boundary though this condition is less important); the need to satisfy this boundary condition and the ﬁnite domain in this coordinate is
the main reason for utilising Lobatto shape functions.

For the reactive scattering problem a number of considerations need to be take into account meaning that there a several possible

options for internal coordinates. Explicitly, we consider:

• A single set of Jacobi coordinates,
• Multiple sets of Jacobi coordinates,
• Hyperspherical coordinates,
• Radau coordinates.

Each of these coordinate choices leads naturally to a set of basis functions.

When assessing our options, we want to consider a few factors. Ideally, we would like to consider the ingong and outgoing channels
on an equal footing. Second (and most importantly), we need to be able to computationally effectively evaluate the overlap integrals
and Hamiltonian matrix elements arising from the basis set and coordinates in a doubly- or triply-ﬁnite region (depending on how many
scattering channels are energetically accessible) as well as evaluating the surface amplitude integrals (i.e. Equation (2.25)).

9

l

r
s
t
a
.
r
o
y
a
s
o
c
e
t
y
p
u
b

i

l
i

i

s
h
n
g
.
o
r
g

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

P
h

i
l
.

.

.

.

.

T
r
a
n
s
.

.

.

.

.

.

.

.

.

R

.

.

.

.

.

.

.

S
o
c
0
0
0
0
0
0
0

.

.

.

.

.

.

.

.

.

.

Single Jacobi coordinate basis set For a triatomic reactive scattering code, it is potentially possible to use a traditional single set of
Jacobi coordinate and deﬁne basis functions in this coordinate of the form

.

.

.

.

for a set of m, n, j, k, where Mm are Laguerre polynomials, Ln are Lobatto basis sets and Pj,k are associated Legendre polynomials.

For this type of single-coordinate basis set runs into the following problems:

{Mm(r1)Ln(r2)Pj,k(θ)}

(3.1)

(i) The ingoing and outgoing channels are not treated equivalently;
(ii) The magnitude of the basis functions at the other R-matrix boundaries might not be sufﬁciently large to describe scattering
properly in that coordinate; if the inner region basis functions cannot describe the wavefunction involved in scattering properly,
then the RmatReact methodology will not be able to describe the scattering process properly;

(iii) The zero-derivative boundary conditions will not be met in the other coordinate systems (this is a desirable but in practice not

necessary condition);

(iv) Accurately evaluating integrals with the ﬁnite boundary conditions imposed by the other scattering coordinate constraints is

extremely complicated, especially as there will usually be no simple relationship between the coordinates.

Multiple Jacobi coordinate basis sets To address some of the problems associated with using basis sets deﬁned by a single set of
Jacobi coordinates, we can introduce sets of basis functions associated with each Jacobi coordinate, i.e.

{MmA(rA

1 )LnA(rA

2 )PjA,kA(θA), MmB(rB

1 )LnB(rB

2 )PjB,kB(θB), MmC (rC

1 )LnC (rC

2 )PjC,kC (θC )}

(3.2)

for a set of mA, nA, jA, kA, mB, nB, jB, kB, mC, nC, jC, kC.

This multiple-coordinate basis sets approach alleviates the ﬁrst two problems for a single Jacobi coordinate basis set, but the problem
of efﬁcient computation of integrals for a non-orthogonal and over-complete basis will be necessary for the methodology to be of
practical usefulness; this is not a general feature of variational nuclear motion programs. A related approach was successfully utilised
+. This approach
by Day and Truhlar [58], who used multiple Jacobi coordinate basis set to calculate the bound state energy levels of H3
has the additional advantage of restoring the full symmetry to the treatment of the H3

+ problem.

The key difference between our problem and that solved by Day and Truhlar [58] is that our problem has multiple boundary

conditions. For example, one of the simpler integrals required is of the form

(cid:90)

π

(cid:90)

∞

(cid:90)

aA
0

0

0

0

F (rA

1 , rA

2 , θA)H(aB

0 − rB

2 )drA

1 drA

2 dθA

(3.3)

where H(x) is the heavisidetheta function, i.e. H(x) = 1 for x > 0 and H(x) = 0 for x < 0. The best way to approach these integrals
is to design the basis functions, B, such that B(rA
0 . This is eminently feasible and will have the additional
beneﬁt of reducing linear dependency issues.

2 , θA) (cid:28) E for rB

2 > aB

1 , rA

Hyperspherical coordinates Hyperspherical coordinates represent one way to avoid the need for multiple internal region coordinate
sets and thus non-orthogonal basis sets. Hyperspherical coordinates have already been used successfully for H+ + H2 reactive scattering

10

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

l

r
s
t
a
.
r
o
y
a
s
o
c
e
t
y
p
u
b

i

l
i

i

s
h
n
g
.
o
r
g

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

P
h

i
l
.

T
r
a
n
s
.

.

.

.

.

R

.

.

.

.

.

.

.

.

.

.

.

S
o
c
0
0
0
0
0
0
0

.

.

.

.

.

.

.

.

[8]. However, hyperspherical coordinates become increasingly inefﬁcient at large scattering distances and thus applications to these sorts
of problems have generally require transformation into Jacobi coordinates at some large scattering distance for efﬁcient treatment of the
problem [9]. Furthermore, the inner region nuclear motion calculations using hyperspherical coordinates are much less efﬁcient than
DVR codes based on orthogonal Jacobi and Radau coordinates [59].

Radau coordinates Problems where there are two reaction channels, such as D + OH −−→ DO + H, can be efﬁciently treated using
a single set of Radau coordinates (eg [60–62]). In this case, one would use Lobatto shape functions (or Radau shape functions [63])
for both the r1 and r2 coordinates (with the θ coordinate basis functions being Legendre polynomials as usual). The surface amplitude
integrals will thus require projection of the basis functions deﬁned in Radau coordinates onto the channel basis functions that are
naturally deﬁned in the Jacobi r1 and θ coordinates; such transformations are relatively easily performed in a DVR representation (see
Appendix A of Tennyson et al. [32]).

4. Conclusions

The RmatReact methodology is a new theoretical and computational methodology designed to treat ultracold heavy-particle scattering.
The mathematical formalism borrows heavily from the highly successful calculable R-matrix methods that have been used extensively
to treat electron-atom and electron-molecule collisions. However, there are crucial differences in the approach, particularly in the
deﬁnition and solution for the inner region problem where the two scattering particles strongly interact. This paper extends for the ﬁrst
time the previously presented [24] mathematical framework for treating atom-atom inelastic and elastic scattering to all atom-diatomic
+ system: elastic and inelastic non-reactive scattering, photo-association and photo-dissociation,
scattering processes relevant for the H3
charge exchange and reactive scattering. The RmatReact methodology has the potential to revolutionise modelling of cold and ultracold
heavy particle scattering by exploiting the inherent division of space into two regions: an inner region where the particle interactions
are strong and should be treated in their full dimensionality with basis sets and calculation methods designed for molecular systems,
i.e. nuclear motion methods, and the outer region where particle interaction is weak but must be considered to a very large interparticle
distance due to the small collision energies.

Our detailed consideration of the mathematics required to describe all scattering processes using the new RmatReact methodology
shows that the key difﬁculty is probably in the choice of coordinates and basis sets to describe reactive heavy-particle scattering
problems like D+ + H2 −−→ H+ + HD. This occurs because the inner region becomes ﬁnite as deﬁned over every non-orthogonal
scattering coordinate. The modiﬁcations to this inner region Schrodinger equation require that for each boundary at least one basis
function must have a non-zero contribution, raising challenges in deﬁning an appropriate basis set and evaluating the resultant integrals
with multiple boundary conditions. To describe reactions with only two relevant reaction channels, e.g. D + OH −−→ H + OD, Radau
coordinates seem to be the most logical path forward. For systems where three reaction channels are of interest, e.g. symmetric H+ +
H2 collisions, use of multiple Jacobi coordinates or hyperspherical coordinates appear to offer the best prospects for success.

Previous studies on the H+

3 system for reactive problems, eg D+ + H2(v = 0, j = 0), have been performed on potentials with
accurate long-range behaviour but a relatively poor representation of the H+
3 well region. We have recently developed a global H+
3
ground state potential energy surface [64] which joins the highly accurate ab initio spectroscopic potential of Pavanello et al. [65] with
the correct treatment of the above dissociation and asymptotic regions due to Velilla et al. [66] to provide an accurate global potential
for the H3

+ system. This will be used for our future studies on this system.

Acknowledgement

We thank Tom Rivlin and Eryn Spinlove for many helpful discussions during the course of this work.

Authors’ Contributions. LKM carried out the main body of investigation and drafted the manuscript. JT conceived of the study and provided critical
insight to develop and interpret the results. All authors read and approved the manuscript.

Funding. This project has received funding from the European Union’s Horizon 2020 research and innovation programme under the Marie Sklodowska-
Curie grant agreement No 701962.

References

1. Stuhl BK, Hummon MT, Ye J. 2014 Cold State-Selected Molecular Collisions and Reactions.

Ann. Rev. Phys. Chem. 65, 501–518.

2. Willitsch S. 2017 Chemistry with controlled ions.

Adv. Chem. Phys. 162, 307–340.

3. Carmona-Novillo E, Gonzalez-Lezana T, Roncero O, Honvault P, Launay JM, Bulut N, Aoiz FJ, Banares L, Trottier A, Wrede E.

2008 On the dynamics of the H+ + D2(v=0, j=0) −−→ HD + D+ reaction: A comparison between theory and experiment.
J. Chem. Phys. 128, 014304.

4. Honvault P, Jorﬁ M, Gonzalez-Lezana T, Faure A, Pagani L. 2011 Ortho-Para H2 Conversion by Proton Exchange at Low

Temperature: An Accurate Quantum Mechanical Study.
Phys. Rev. Lett. 107, 023201.

11

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

l

r
s
t
a
.
r
o
y
a
s
o
c
e
t
y
p
u
b

i

l
i

i

s
h
n
g
.
o
r
g

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

P
h

i
l
.

T
r
a
n
s
.

R

.

S
o
c
0
0
0
0
0
0
0

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

5. Honvault P, Scribano Y. 2013 State-to-State Quantum Mechanical Calculations of Rate Coefﬁcients for the D+ + H2 −−→ HD + H+

Reaction at Low Temperature.
J. Phys. Chem. A 117, 9778–9784.

6. Gonzalez-Lezana T, Scribano Y, Honvault P. 2014 The D+ + H2 Reaction: Differential and Integral Cross Sections at Low Energy

and Rate Constants at Low Temperature.
J. Phys. Chem. A 118, 6416–6424.

7. Rao TR, Mahapatra S, Honvault P. 2014 A comparative account of quantum dynamics of the H+ + H2 reaction at low temperature

on two different potential energy surfaces.
J. Chem. Phys. 141, 064306.

8. Gonzalez-Lezana T, Honvault P. 2014 The H+ + H2 reaction.

Int. Rev. Phys. Chem. 33, 371–395.

9. Lara M, Jambrina PG, Aoiz FJ, Launay JM. 2015 Cold and ultracold dynamics of the barrierless D+ + H2 reaction: Quantum

reactive calculations for R−4 long range interaction potentials.
J. Chem. Phys. 143, 204305.

10. Carrington A, Buttenshaw J, Kennedy RA. 1982 Observation of the infrared spectrum of H+

3 ion at its near dissciation limit.

11. Carrington A, Kennedy RA. 1984 Infrared Predissociation Spectrum of the H+

3 ion.

Mol. Phys. 45, 753–758.

J. Chem. Phys. 81, 91–112.

12. Carrington A, McNab IR. 1989 The Infraread Predissocation Spectrum of H+
3 .

Accounts of Chemical Research 22, 218.

13. Carrington A, McNab IR, West YD. 1992 Infrared Predissociation Spectrum of the H+

3 ion. II.

14. Kemp F, Kirk CE, McNab IR. 2000 The Infrared Predissociation Spectrum of H+
3 .

J. Chem. Phys. 98, 1073.

Phil. Trans. A 358, 2403–2418.

15. Tennyson J, Kostin MA, Mussa HY, Polyansky OL, Prosmiti R. 2000 H+

3 near dissociation: theoretical progress.

Phil. Trans. Royal Soc. London A 358, 2419–2432.

16. Munro JJ, Ramanlal J, Tennyson J. 2005 Asymptotic vibrational states of the H+

3 molecular ion.

New J. Phys 7, 196.

17. Owens A, Spirko V. 2019 Universal behavior of diatomic halo states and the mass sensitivity of their properties.

J. Phys. B: At. Mol. Opt. Phys. 52, 025102.

18. Gerlich D, Plasil R, Zymak I, Hejduk M, Jusko P, Mulin D, Glosik J. 2013 State Speciﬁc Stabilization of H+ + H2(j) Collision

Complexes.
J. Phys. Chem. A 117, 10068–10075.

19. Pack RT, Parker GA. 1987 Quantum reactive scattering in three dimensions using hyperspherical (APH) coordinates. Theory.

J. Chem. Phys. 87, 3888–3921.

20. Launay JM, Le Dourneuf M. 1989 Hyperspherical close-coupling calculation of integral cross-sections for the reaction H+H2 →

H2+H.
Chem. Phys. Lett. 163, 178–188.

21. Kendrick BK. 2018 Non-adiabatic quantum reactive scattering in hyperspherical coordinates.

J. Chem. Phys. 148, 044116.

22. Tennyson J. 2010 Electron - molecule collision calculations using the R-matrix method.

Phys. Rep. 491, 29–76.

23. Carr JM, Galiatsatos PG, Gorﬁnkiel JD, Harvey AG, Lysaght MA, Madden D, Mašín Z, Plummer M, Tennyson J. 2012 The

UKRmol program suite.
Eur. Phys. J. D 66, 58.

24. Tennyson J, McKemmish LK, Rivlin T. 2016 Low temperature chemistry using the R-matrix method.

Faraday Discuss. 195, 31–48.

25. Rivlin T, McKemmish LK, Tennyson J. 2018 Low temperature scattering with the R-matrix method: the Morse potential.

In Quantum Collisions and Conﬁnement of Atomic and Molecular Species, and Photons (ed. PC Deshmukh, E Krishnakumar,
S Fritzsche, M Krishnamurthy, S Majumder), Springer Conference Series. Springer.

26. Rivlin T, McKemmish LK, Spinlove KE, Tennyson J. 2019 (submitted) Low temperature scattering with the R-matrix method:

Argon-Argon scattering.
Mol. Phys. .

27. Tennyson J, Yurchenko SN. 2017 The ExoMol project: Software for computing molecular line lists.

Intern. J. Quantum Chem. 117, 92–103.

28. Burke PG. 2011 R-matrix theory of atomic collisions: Application to atomic, molecular and optical processes, volume 61.

Springer Science & Business Media.

29. Higgins K, Burke PG. 1993 Positron Scattering by Atomic-Hydrogen including Positronium Formation.

J. Phys. B: At. Mol. Opt. Phys. 26, 4269–4288.

30. Born M. 1927 On the Quantum Theory of Molecules.

Ann. Physik 84, 457.

31. Rose ME, Feld B. 1957 Elementary theory of angular momentum.

Physics Today 10, 30.

32. Tennyson J, Kostin MA, Barletta P, Harris GJ, Polyansky OL, Ramanlal J, Zobov NF. 2004 DVR3D: a program suite for the

calculation of rotation-vibration spectra of triatomic molecules.
Comput. Phys. Commun. 163, 85–116.

33. Manolopoulos D, Wyatt R. 1988 Quantum Scattering via the log derivative version of the Kohn Variational Principle.

Chem. Phys. Lett. 152, 23–32.

34. Manolopoulos D. 1993 Lobatto shape functions.

In Numerical Grid Methods and Their Application to Schrödinger’s Equation, pp. 57–68. Springer.

35. Weisstein EW.

Lobatto quadrature From MathWorld—A Wolfram Web Resource.

36. Yurchenko SN, Bond W, Gorman MN, Lodi L, McKemmish LK, Nunn W, Shah R, Tennyson J. 2018 ExoMol Molecular linelists

– XXVI: spectra of SH and NS.
Mon. Not. R. Astron. Soc. 478, 270–282.

37. Burke PG, Taylor KT. 1975 R-Matrix Theory of Photoionisation - Application to Neon and Argon.

J. Phys. B: At. Mol. Opt. Phys. 8, 2620–2639.

38. SEATON MJ. 1986 Outer-Region Contributions to Radiative Transition-Probabilities.

J. Phys. B: At. Mol. Opt. Phys. 19, 2601–2610.

39. Bloch C. 1957 Une formulation uniﬁee de la theorie des reactions nucleaires.

Nucl. Phys. 4, 503–28.

40. Arthurs AM, Dalgarno A. 1960 The Theory of Scattering by a Rigid Rotator.

Proc. Phys. Soc. London A 256, 540–551.

41. Le Roy RJ. 2017 LEVEL: A Computer Program for Solving the Radial Schrödinger Equation for Bound and Quasibound Levels.

J. Quant. Spectrosc. Radiat. Transf. 186, 167 – 178.

42. Yurchenko SN, Lodi L, Tennyson J, Stolyarov AV. 2016 Duo: A general program for calculating spectra of diatomic molecules.

Comput. Phys. Commun. 202, 262 – 275.

43. Berrington KA, Ballance CP. 2002 Partitioned R-matrix theory .

J. Phys. B: At. Mol. Opt. Phys. 35, 2275–2289.

44. Tennyson J. 2004 Partitioned R-matrix theory for molecules.

J. Phys. B: At. Mol. Opt. Phys. 37, 1061–1071.

45. Light JC, Walker RB. 1976 R-Matrix Approach to Solution of Coupled Equations for Atom-Molecule Reactive Scattering.

J. Chem. Phys. 65, 4272–4282.

46. Baluja KL, Burke PG, Morgan LA. 1982 R-Matrix Propagation Program for Solving Coupled Second-order Differential-Equations.

Comput. Phys. Commun. 27, 299–307.

47. Morgan LA. 1984 A Generalized R-matrix Propagation Program for Solving Coupled 2nd-order Differential-equations.

Comput. Phys. Commun. 31, 419–422.

48. Sunderland AG, Noble CJ, Burke VM, Burke PG. 2002 A parallel R-matrix program PRMAT for electron-atom and electron-ion

scattering calculations.
Comput. Phys. Commun. 145, 311–340.

49. Kozin IN, Law MM, Tennyson J, Hutson JM. 2004 New vibration-rotation code for tetraatomic molecules WAVR4.

Comput. Phys. Commun. 163, 117–131.

50. Yurchenko SN, Thiel W, Jensen P. 2007 Theoretical ROVibrational Energies (TROVE): A robust numerical approach to the

calculation of rovibrational energies for polyatomic molecules.
J. Mol. Spectrosc. 245, 126–140.

51. Bacic Z, Light JC. 1989 Theoretical Methods for Rovibrational States of Floppy Molecules.

12

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

l

r
s
t
a
.
r
o
y
a
s
o
c
e
t
y
p
u
b

i

l
i

i

s
h
n
g
.
o
r
g

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

P
h

i
l
.

T
r
a
n
s
.

.

.

.

.

R

.

S
o
c
0
0
0
0
0
0
0

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

Annu. Rev. Phys. Chem 40, 469–498.

52. Miller S, Tennyson J. 1988 Overtone bands of H+

J. Mol. Spectrosc. 128, 530–539.

3 : ﬁrst principles calculation.

53. Henderson JR, Tennyson J. 1990 All the vibrational bound states of H+
3 .

Chem. Phys. Lett. 173, 133–138.

54. Polyansky OL, Tennyson J. 1999 Ab initio calculation of the rotation-vibration energy levels of H+

3 and its isotopomers to

spectroscopic accuracy.
J. Chem. Phys. 110, 5056–5064.

55. Pavanello M, Adamowicz L, Alijah A, Zobov NF, Mizus II, Polyansky OL, Tennyson J, Szidarovszky T, Császár AG, Berg M,
Petrignani A, Wolf A. 2012 Precision measurements and computations of transition energies in rotationally cold triatomic hydrogen
ions up to the mid-visible spectral range.
Phys. Rev. Lett. 108, 023002.

56. Tennyson J, Sutcliffe BT. 1982 The ab initio calculation of the vibrational-rotational spectrum of triatomic systems in the close-

coupling approach, with KCN and H2Ne as examples.
J. Chem. Phys. 77, 4061–4072.

57. Tennyson J, Sutcliffe BT. 1983 Variationally exact ro-vibrational levels of the ﬂoppy CH+

2 molecule.

J. Mol. Spectrosc. 101, 71–82.

58. Day PN, Truhlar DG. 1991 The calculation of highly excited bound-state energy levels for a triatomic molecule by using three-

arrangement basis sets and contracted basis functions.
J. Chem. Phys. 95, 6615–6621.

59. Diniz LG, Mohallem JR, Alijah A, Pavanello M, Adamowicz L, Polyansky OL, Tennyson J. 2013 Vibrationally and rotationally
3 using coordinate-dependent vibrational and rotational masses.

nonadiabatic calculations on H+
Phys. Rev. A 88, 032506.

60. Mussa HY, Tennyson J. 1998 Calculation of rotation-vibration states of water at dissociation.

J. Chem. Phys. 109, 10885–10892.

61. Császár AG, Mátyus E, Szidarovszky T, Lodi L, Zobov NF, Shirin SV, Polyansky OL, Tennyson J. 2010 Ab initio prediction and

partial characterization of the vibrational states of water up to dissociation.

l

r
s
t
a
.
r
o
y
a
s
o
c
e
t
y
p
u
b

i

l
i

i

s
h
n
g
.
o
r
g

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

T
r
a
n
s
.

P
h

i
l
.

R

.

.

.

.

.

.

.

.

.

.

.

.

.

S
o
c
0
0
0
0
0
0
0

.

.

.

.

.

.

.

.

J. Quant. Spectrosc. Radiat. Transf. 111, 1043–1064.

62. Zobov NF, Shirin SV, Lodi L, Silva BC, Tennyson J, Császár AG, Polyansky OL. 2011 First-principles rotation-vibration spectrum

13

of water above dissociation.
Chem. Phys. Lett. 507, 48–51.

63. Radau R. 1880 Étude sur les formules d’approximation qui servent à calculer l a valeur numérique d’une intégrale déﬁnie.

Journal de mathématiques pures et appliquées 6, 283–336.

64. Mizus II, Polyansky OL, McKemmish LK, Tennyson J, Alijah A, Zobov NF. 2018 A global potential energy surface for H+
3 .

Mol. Phys. .

65. Pavanello M, Adamowicz L, Alijah A, Zobov NF, Mizus II, Polyansky OL, Tennyson J, Szidarovszky T, Császár AG. 2012

Calibration-quality adiabatic potential energy surfaces for H+
J. Chem. Phys. 136, 184303.

3 and its isotopologues.

66. Velilla L, Lepetit B, Aguado A, Beswick JA, Paniagua M. 2008 The H+

3 rovibrational spectrum revisited with a global electronic

potential energy surface.
J. Chem. Phys. 129, 084307.

67. Launay JM. 1976 Body-ﬁxed formulation of rotational excitation: exact and centrifugal decoupling results for co-he.

Journal of Physics B: Atomic and Molecular Physics 9, 1823.

68. Brocks G, van der Avoird A, Sutcliffe BT, Tennyson J. 1983 Quantum dynamics of non-rigid systems comprising two polyatomic

molecules.
Mol. Phys. 50, 1025–1043.

Appendix: Frame Transformation for Triatomic Systems

Channels are deﬁned by three coordinates: the vibrational quantum number of the diatomic vibration n, the rotational quantum number
of the diatomic j and a relative angular momentum quantum number that is l in space-ﬁxed coordinates and ¯Ω in body-ﬁxed coordinates.
The inner region problem is generally solved in body-ﬁxed coordinates with solutions labelled by nj ¯Ω, while the outer region solutions
utilise space-ﬁxed coordinates njl. It is imperative to be able to convert between these representations. The frame transformation
mathematics described here are adapted from Launay (1976) [67] to be appropriate to the present problem.

In both coordinate systems, the r1 coordinate is the diatomic vector and the r2 coordinate is the vector between the centre-of-mass
of the diatomic and the scattering atom. For simplicity, the angular coordinates associated with each of these vectors are often referred
to collectively as ¯r1 and ¯r2; they are deﬁned differently for each coordinate system as described below.

The total angular momentum of the triatomic system is J, with a projection of M ; each solution to the inner region problem, each
channel, each full solution to the scattering problem and each reduced radial function solution to the scattering problem are labelled by
these quantum numbers.

Body-ﬁxed coordinates

In 2-angle embedding [68], the angular component of the wavefunction is given by

Y JM

j ¯Ω ( ˆr2, ˆr1) =

(cid:114)

(2J + 1)
4π

Yj ¯Ω(θ, γ)DJ

M Ω(α, β, 0),

(A 1)

where Ylm(θ, φ) is a spherical oscillator function and ¯Ω = 0, 1, .... min(j, J) if (cid:15) = (−1)J and ¯Ω = 1, .... min(j, J) if (cid:15) = (−1)J+1,
while in 3-angle embedding, it is instead given by

j ¯Ω ( ˆr2, ˆr1) = Pj ¯Ω(θ)DJ∗
Y JM

M Ω(α, β, γ).

where P is a Legendre polynomial.

The combined eigenfunctions of deﬁnite total parity are given by

Y JM (cid:15)

j ¯Ω ( ˆr2, ˆr1) =

1
(cid:112)2(1 + δ ¯Ω0)

(cid:16)

Y JM
j ¯Ω ( ˆr2, ˆr1) + (cid:15)(−1)J Y JM

j(− ¯Ω)( ˆr2, ˆr1)

(cid:17)

The expression for the channels in body-ﬁxed coordinates, labeled by nj ¯Ω, are thus

BFΦJM (cid:15)

nj ¯Ω ( ˆr2, r1) = χn(r1) BFY JM (cid:15)

j ¯Ω ( ˆr2, ˆr1)

An inner region solution α wavefunction in terms of channel functions is given by

Ψ JM (cid:15)
α

=

(cid:88)

nj ¯Ω

1
r2

BFF JM (cid:15)

i,nj ¯Ω(r2) BFΦJM (cid:15)

nj ¯Ω ( ˆr2, r1)

A scattering-energy solution s at scattering-energy E in terms of body-ﬁxed channel functions is given by

Ψ JM (cid:15)
sE (r2, r1) =

(cid:88)

nj ¯Ω

1
r2

BFF JM (cid:15)

sE,nj ¯Ω(r2) BFΦJM (cid:15)

nj ¯Ω ( ˆr2, r1)

(A 2)

(A 3)

(A 4)

(A 5)

(A 6)

Space-ﬁxed coordinates

14

l

r
s
t
a
.
r
o
y
a
s
o
c
e
t
y
p
u
b

i

l
i

i

s
h
n
g
.
o
r
g

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

T
r
a
n
s
.

P
h

i
l
.

.

.

.

.

R

.

.

.

.

.

S
o
c
0
0
0
0
0
0
0

.

.

.

.

.

.

.

.

.

.

.

.

.

.

The combined basis function for the angular coordinates takes the components of the angular momentum functions for the diatomic
(j, mj ) and the atom rel. to the diatomic (l, ml) that contribute to state with quantum numbers J, M [67]:

SFY JM (cid:15)
jl

( ˆr2, ˆr1) =

(cid:88)

mj ml

(−1)j−l+M (2J + 1)1/2

(cid:32)

j
l
mj ml −M

J

(cid:33)

Yjmj ( ˆr1)Ylml ( ˆr2)

(A 7)

In space ﬁxed coordinates, the channels are labelled by njl, and given by

SFΦJM (cid:15)

njl ( ˆr2, r1) = χn(r1) SFY JM (cid:15)

jl

( ˆr1, ˆr2)

A scattering-energy solution s at scattering-energy E in terms of space-ﬁxed channel functions is given by

Ψ JM (cid:15)
sE (r2, r1) =

(cid:88)

njl

1
r2

SFF JM (cid:15)

sE,njl(r2)SFΦJM (cid:15)

njl ( ˆr2, r1)

Connecting body-ﬁxed and space-ﬁxed coordinates

Deﬁne

P JM (cid:15):j
l ¯Ω

= (cid:104) SFY JM (cid:15)

jl

( ˆr1, ˆr2)| BFY JM (cid:15)

j ¯Ω ( ˆr2, ˆr1)(cid:105)

Then, since our functions are all real

P JM (cid:15):j
l ¯Ω

= (cid:104) BFY JM (cid:15)

j ¯Ω ( ˆr2, ˆr1)| SFY JM (cid:15)

jl

=(−1)J+ ¯Ω

(cid:32)

j
l
J
¯Ω − ¯Ω 0

( ˆr1, ˆr2)(cid:105)
(cid:33) (cid:112)2(2l + 1)
(cid:112)(1 + δ ¯Ω0)

(A 8)

(A 9)

(A 10)

(A 11)

(A 12)

Since Y SF,JM (cid:15)
jl

that

Similarly,

( ˆr2, ˆr1) for all l form a complete set of eigenfunctions in ˆr1, ˆr2, we can use resolution of the identity to demonstrate

| BFY JM (cid:15)

j ¯Ω ( ˆr2, ˆr1)(cid:105) =

=

(cid:88)

l
(cid:88)

l

| SFY JM (cid:15)
jl

( ˆr2, ˆr1)(cid:105) (cid:104) SFY JM (cid:15)

jl

( ˆr2, ˆr1)| BFY JM (cid:15)

j ¯Ω ( ˆr2, ˆr1)(cid:105)

P JM (cid:15):j
l ¯Ω

| SFY JM (cid:15)
jl

( ˆr2, ˆr1)(cid:105)

SFY JM (cid:15)
jl

( ˆr2, ˆr1) =

(cid:88)

¯Ω

P JM (cid:15):j
l ¯Ω

BFY JM (cid:15)

j ¯Ω ( ˆr2, ˆr1)

(A 13)

(A 14)

Equating the body-ﬁxed and space-ﬁxed representations of the full wavefunction,
(cid:88)
(cid:88)

| SFF JM (cid:15)
njl

(r2) SFY JM (cid:15)

jl

( ˆr1, ˆr2)(cid:105) =

| BFF JM (cid:15)

sE,nj ¯Ω(r2) BFY JM (cid:15)

j ¯Ω ( ˆr1, ˆr2)(cid:105)

l

¯Ω
(cid:88)

(cid:88)

=

¯Ω

l

| SFY JM (cid:15)
jl

( ˆr1, ˆr2)(cid:105) (cid:104) SFY JM (cid:15)

jl

( ˆr1, ˆr2)| | BFF JM (cid:15)

sE,nj ¯Ω(r2) BFY JM (cid:15)

j ¯Ω ( ˆr2, ˆr1)(cid:105)



| SFY JM (cid:15)
jl

( ˆr1, ˆr2)(cid:105)



(cid:88)

=

l

( ˆr1, ˆr2)| | BFF JM (cid:15)

sE,nj ¯Ω(r2) BFY JM (cid:15)

j ¯Ω ( ˆr2, ˆr1)(cid:105)





(cid:104) SFY JM (cid:15)
jl

(cid:88)

¯Ω



P JM (cid:15):j
l ¯Ω

| BFF JM (cid:15)

sE,nj ¯Ω(r2)(cid:105)



SFY JM (cid:15)
jl

( ˆr1, ˆr2)

(cid:88)

=





(cid:88)

l

¯Ω

Then, by comparing terms within the expression

Similarly,

SFF JM (cid:15)
njl

(r2) =

(cid:88)

¯Ω

P JM (cid:15):j
l ¯Ω

BFF JM (cid:15)

sE,nj ¯Ω(r2)

BFF JM (cid:15)

sE,nj ¯Ω(r2) =

(cid:88)

l

P JM (cid:15):j
l ¯Ω

SFF JM (cid:15)
njl

(r2)

(A 15)

(A 16)

(A 17)

List of Figures

15

1

Form of the K matrix for two uncoupled sets of channels.

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

16

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

l

r
s
t
a
.
r
o
y
a
s
o
c
e
t
y
p
u
b

i

l
i

i

s
h
n
g
.
o
r
g

.

.

.

.

.

.

.

.

.

P
h

i
l
.

.

.

.

.

.

.

T
r
a
n
s
.

.

.

R

.

S
o
c
0
0
0
0
0
0
0

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

Figure 1. Form of the K matrix for two uncoupled sets of channels.

16

l

r
s
t
a
.
r
o
y
a
s
o
c
e
t
y
p
u
b

i

l
i

i

s
h
n
g
.
o
r
g

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

T
r
a
n
s
.

P
h

i
l
.

.

.

.

.

R

.

S
o
c
0
0
0
0
0
0
0

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

Elastic scatteringElastic scatteringCharge transfer/ Reactive scatteringInelastic scatteringInelastic scatteringCharge transfer/ Reactive scatteringInelastic scatteringInelastic scatteringList of Tables

17

1

Processes that can be studied using the RMATREACT CODE, using H2D+ system as an example. . . . . . . . . . . . . . . .

18

l

r
s
t
a
.
r
o
y
a
s
o
c
e
t
y
p
u
b

i

l
i

i

s
h
n
g
.
o
r
g

P
h

i
l
.

T
r
a
n
s
.

R

.

S
o
c
0
0
0
0
0
0
0

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

Table 1. Processes that can be studied using the RMATREACT CODE, using H2D+ system as an example.

18

Process

Example
D+ + H2(v, J) → D+ + H2(v, J)
D+ + H2(v(cid:48)(cid:48), J (cid:48)(cid:48)) → D+ + H2(v(cid:48), J (cid:48))
H2D+ + hν → HD + H+ or H2 + D+
H2 + D+ → H2D+ + hν
D+ + H2 → D + H+
2

Elastic collisions
Inelastic collisions
Photodissociation
Photoassociation
Charge Exchange
Reactive scattering D+ + H2 → HD + H+

l

r
s
t
a
.
r
o
y
a
s
o
c
e
t
y
p
u
b

i

l
i

i

s
h
n
g
.
o
r
g

P
h

i
l
.

T
r
a
n
s
.

R

.

S
o
c
0
0
0
0
0
0
0

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

.

