1
2
0
2

c
e
D
3

]
h
p
-
p
m
o
c
.
s
c
i
s
y
h
p
[

3
v
1
4
0
2
0
.
0
1
1
2
:
v
i
X
r
a

Development of Kinetic Energy Density Functional Using
Response Function Deﬁned on the Energy Coordinate

Hideaki Takahashi∗
Department of Chemistry, Graduate School of Science,
Tohoku University, Sendai, Miyagi 980-8578, Japan
(Dated: December 6, 2021)

A kinetic energy functional E

e
kin was developed within the framework of the density-functional
theory (DFT) based on the energy electron density for the purpose of realizing the orbital-free DFT.
The functional includes the nonlocal term described with the linear-response function (LRF) of a
reference system. As a notable feature of the present approach, the LRF is represented on the
energy coordinate ǫ deﬁned for each system of interest.
In addition, an atomic system is taken
as a reference system for the construction of the LRF, which shows a clear diﬀerence from the
conventional approach based on the homogeneous electron gas. The explicit form of the functional
Ee
kin was formulated by means of the coupling-parameter integration scheme. The functional Ee
kin
was applied to the calculations of the kinetic energies of the pseudo atoms that mimics H, He, Ne,
e
and Ar. Explicitly, the kinetic energy of each atom was computed using the functional E
kin with
respect to the variation of the valence charge Zv of each atom. In these calculations, the electron
density n optimized by the Kohn-Sham DFT was adopted as an argument of the functional. It was
found that the results are in excellent agreements with those given by the Kohn-Sham DFT. We
also devised a method to perform the self-consistent ﬁeld calculation utilizing the functional Ee
kin.
The method was applied to the computation of the radial distribution functions of the electrons in
the pseudo Ne and Ar atoms. It was demonstrated that the results reasonably agree with those
yielded by the Kohn-Sham DFT.

I.

INTRODUCTION

Density-functional theory (DFT) for electrons[1] is one
of the principal subjects in modern physics and chem-
istry. It oﬀers an eﬃcient and robust theoretical frame-
work to study electronic structures of materials and
molecules[2]. Vast amounts of eﬀort have been devoted
to the developments of functionals and to the foundation
of the theoretical basis of DFT[3]. Nowadays, DFT is
an indispensable tool in the computational approach to
the material design and molecular synthesis because of
its eﬃciency and reliability. In the early study of DFT it
was proved in formulation[1, 4] that there exists an exact
universal functional E[n] that describes the total energy
E in terms of the N -representable[1, 4] electron density
n. However, the Kohn-Sham (KS) method[1, 5], which
has so far been the only workhorse in the DFT, utilizes
one-electron orbitals as the variables in the variational
search. The introduction of the wave functions in KS-
DFT is necessitated to ensure the accurate evaluation
of the kinetic energy of the electrons. However, it gives
rise to the computational cost associated with the or-
thogonalization among the orbitals, which roughly scales
as O(N 3) with the system size N .
If the construction
of an eﬀective kinetic energy functional is made possible,
the one-electron orbitals become no longer necessary, and
consequently, the computational cost scales linearly with
the system size (‘Order-N ’) since the orthogonalization
can be completely bypassed in the variational calcula-
tions. Thus, it is a matter of great signiﬁcance in physics

∗ hideaki.takahashi.c4@tohoku.ac.jp

and chemistry to develop the eﬃcacious orbital-free DFT
(OF-DFT) to extend the frontier of the applications of
DFT[6].

Development of an accurate kinetic energy density
functional Ekin[n] is, however, known as the toughest
subject. A primitive approximation to Ekin[n] was ﬁrst
given in 1928 by Thomas and Fermi (TF)[7, 8] using the
homogeneous electron gas (HEG)[1] as a reference sys-
tem. For the total electron density n, the TF functional
ETF[n] has the form

ETF[n] = CTF

dr n(r)

5
3

(1)

Z

where CTF = 3
10
the electrons. In 1935 a gradient correction EvW[n]

3 and r is the position vector of

3π2

dr n(r)1/2∇2n(r)1/2

(2)

Z

was made by von Weizs¨acker.[9] It is readily recognized
that Eq. (2) by itself is an exact Ekin[n] for one or two
electrons systems. Inclusion of EvW[n] with a prefactor
λ (λvW)

ETFW[n] = ETF[n] + λEvW[n]

(3)

makes a substantial contribution to reduce errors.
The behavior of the linear response function(LRF) of
ETFW[n] in the momentum space was analyzed, for in-
stance, in Ref. 10. It shows that LRF of ETFW[n] with
λ = 1 reproduces the asymptotic behavior of the HEG in
the large k limit, while setting λ = 1/9 realizes that in
the small k region. As demonstrated in Ref. 11, λ = 1/5

(cid:0)

EvW[n] = −

2

(cid:1)
1
2

 
 
 
 
 
 
gives the best results when it is applied to atoms. Un-
fortunately, higher order corrections to ETFW[n] oﬀers
quite minor improvements at the most. It has long been
considered that the deﬁciency of these local and semilo-
cal kinetic operators is that they would not be able to
realize the shell structures of electron densities in atoms.
This motivated the introduction of the nonlocal term in
the functional Ekin[n].

The nonlocal eﬀect was ﬁrst incorporated into the
kinetic functional ECAT by Chac´on, Alvarellos, and
Tarazona[12] through the weighted average n(r) of the
electron density n. The weight function was constructed
so that the functional realizes the linear response of the
HEG. Another type of the nonlocal kinetic functional
EWT[n] was proposed by Wang and Teter[13], which also
refers to the LRF of the HEG to formulate the integral
kernel in the functional. Explicitly, the nonlocal term
Enloc

WT [n] in the WT functional is in the form

Enloc

WT [n] = Cnloc
WT

drdr′n(r)αω0 (kF |r − r′|) n (r′)α

Z

(cid:1)

(cid:0)

1/3

3π2n0

(4)
where kF is the Fermi momentum of the HEG with den-
. α in Eq. (4)
sity n0 and is given by kF =
was taken as 5/6 in the original development. For the
bulk system, the average electron density in the unit cell
can be adopted to n0. The function ω0 is related to the
LRF of the HEG and it has an oscillatory behavior in real
space. It is, thus, plausible that the functional is capa-
ble of producing the quantum oscillations responsible for
the creation of the shell structures in atoms. Actually,
Figs. 8 and 9 in Ref. 13 show that the EWT[n] functional
yields weak, but apparent shell structures in the density
proﬁles of atoms. Motivated by this work, Wang, Govind,
and Carter made an improvement on the WT functional
in Ref. 14 and, further, developed a density-dependent
kernel in Ref. 15. However, adapting the LRF of the
HEG to atomic or molecular systems might be problem-
atic since it is not straightforward to specify the cor-
responding Fermi momentum kF for the given diﬀerent
positions r and r′ since the average electron density n0
is not well deﬁned in contrast to the bulk systems. Along
this line, Huang and Carter devised a method which in-
corporates the gradient of the density into the kernel for
the applications to semiconductors[16]. However, even
when kF is determined somehow, there is no good rea-
son that LRF for the HEG will be successfully applied to
the systems with large inhomogeneities. It is desirable to
build a novel LRF based on another reference system to
construct the nonlocal kinetic energy functional suitable
for the applications to atoms and molecules.

In a recent work[17], a new DFT for electrons was de-
veloped on the basis of the electron distribution ne(ǫ) on
the energy coordinate ǫ. The distribution ne(ǫ), referred
to as energy electron density, is given by the projection
of the density n(r) onto the coordinate ǫ, thus,

ne(ǫ) =

dr n(r)δ(ǫ − υdef(r))

(5)

Z

2

where υdef(r) is the potential introduced to deﬁne the
energy coordinate and the external potential υext(r) of
interest is adopted usually. Explicitly, the coordinate ǫ
is given by

υdef (r) =

ZA
|r − RA|

(6)

XA
where RA and ZA are the position vector and the charge
of the nucleus A, respectively.
Importantly, it can be
proved in parallel to the Hohenberg-Kohn theorem[18]
that there exists one-to-one correspondence between cer-
tain subsets of the energy electron densities and the ex-
ternal potentials[17]. Furthermore, the Levy’s constraint
search method[4] can also be formulated within the DFT
based on the energy electron density[17]. The introduc-
tion of the energy electron density ne(ǫ) is motivated by
the fact that it oﬀers a natural framework to incorpo-
rate the nonlocal electron correlations which are crucial
in describing the chemical bond dissociations. The cor-
relation is often referred to as static correlation(SC) or
left-right correlation. In Ref. 17 a prototype of the SC
energy functional was constructed utilizing ne(ǫ) and a
more sophisticated functional was developed in a subse-
quent paper[19].

In the present work, a prototype of the kinetic energy
functional is developed for the applications to atoms,
where a nonlocal kinetic potential is constructed on the
energy coordinate. It should also be noted that the LRF
of the individual atomic system instead of HEG is uti-
lized to build the nonlocal term in contrast to the previ-
ous works. At this stage, our kinetic energy functional is
only applicable to atoms. The performance is examined
by computing the energies of the atoms with shifted nu-
clear charges. The radial electron distributions around
the nucleus for the atom are also computed. The results
are compared with those obtained by using the functional
ETFW[n] in Eq. (3) and those by the KS-DFT calcula-
tion.

The organization of the paper is as follows. In Section
II, we provide the theoretical details for the construction
of the nonlocal kinetic energy functional of the energy
electron density, following a brief review of the LRF of
the HEG is presented at ﬁrst. Section III is devoted to
describe the details of the numerical implementations and
calculations. The results and discussion are presented in
Section IV. The summary and the perspective are given
in the last section.

II. THEORY AND METHOD

In this section, theoretical and methodological details
are provided for the construction of the kinetic energy
functional. In subsection A, we brieﬂy review the rela-
tion of the functional derivative of the kinetic potential
with the linear-response function of the system. Then,
we illustrate the projection of the nonlocal term in the

kinetic energy functional onto the energy coordinate with
a focus placed on its justiﬁcation. In the third subsec-
tion, the explicit form of the kinetic energy functional is
developed on the basis of the coupling-parameter integra-
tion. The methodology to realize the self-consistent ﬁeld
calculation (SCF) with the present approach is given in
the last subsection.

A. Linear-Response Function

We ﬁrst review the relationship between the kinetic
potential and the linear response function(LRF) of the
system of interest for later reference. We assume that
an energy functional E[n] of the density n(r) is given.
In the density functional framework, E[n] can be further
decomposed into the contributions

E[n] = Ekin[n] + EH[n] + Exc[n] + Eext[n]

(7)

In Eq. (7), EH[n] is the Hartree energy due to the clas-
sical Coulomb repulsion among electrons, Exc[n] is the
exchange-correlation energy, and Eext is the interaction
energy between the density n and the external potential
υext(r). At the equilibrium of the electronic state, the
functional derivative of the energy with respect to the
density becomes the chemical potential µ of the electron,

δE[n]
δn(r)

=

δEkin[n]
δn(r)
δ
δn(r)

+

= υkin[n](r) + υeﬀ[n](r) = µ

(8)

where υeﬀ[n](r) is the eﬀective potential due to the elec-
tron correlations and the external potential. Since it is
assumed the system is in the stationary state, the second
derivative of the left hand side of Eq. (8) leads to zero,

δ2E[n]
δn(r)δn (r′)

=

δυkin[n](r)
δn (r′)

+

δυeﬀ[n](r)
δn (r′)

= 0

(9)

It should be noticed that the second term of the right
hand side of the ﬁrst equality in Eq. (9) represents the
inverse of the response function χ(r, r′) of the system.
Thus, the functional derivative of the kinetic potential is
directly related to the response function of the system,

δυkin[n](r)
δn (r′)

= −

δυeﬀ[n](r)
δn (r′)

= −χ−1 (r, r′)

(10)

This equation constitutes the basis of the constructions of
the nonlocal kinetic functionals ECAT[12], EWT[13], and
their modiﬁcations. Importantly, all of these studies refer
to the Lindhard function[20], that is, the linear-response
function χ0(kF ; |r − r′|) of the homogeneous electron gas
(HEG) for the sake of numerical convenience. In the con-
struction of the nonlocal energy in the WT functional[13],
for instance, the integral kernel ω in Eq. (4) is obtained

3

by excluding the terms corresponding to the local and
semi-local energies ETF and EvW from −χ−1
0 . Although
the average density n0 is well deﬁned in bulk system, it
cannot be determined for atoms and molecules at least in
a natural manner. Moreover, the applicability of the LRF
of the HEG to atoms and molecules that have extreme
inhomogeneity is not yet well examined. It is, thus, de-
sirable to devise a new approach using the LRF for some
inhomogeneous reference system to construct the kinetic
energy density functional applicable to the systems with
large inhomogeneities.

B. Projection of Nonlocal Kinetic Energy
Functional onto the Energy Coordinate

As mentioned in Introduction, a novel framework of
the DFT was developed[17] in 2018 on the basis of the
energy electron density ne(ǫ) deﬁned in Eq.
(5). The
construction of this theory was, in part, motivated by a
hypothesis by Parr et al.
in Ref. 21. They advocated
that the contours of the electron densities of molecules
are more or less parallel to those of the bare nuclear po-
tentials, that is, Eq. (6) itself. Actually, this is valid for
the densities in atomic systems. With this in mind, we
reformulate the nonlocal term Enloc
WT [n] in Eq. (4) with
the method of the energy representation. First, we con-
sider the general form Enloc
gWT[n] of the nonlocal term of
the WT functional, which may be written as

Z

Note that the integral kernel ω0 built for the HEG is
replaced by some general function ω in Eq. (11). We
also suppose that the following relation is satisﬁed at
least approximately,

n(r) =

ne(ǫ)|ǫ=υdef(r)

(12)

e

ne(ǫ) is a certain function of ne(ǫ). In Eq. (12),
where
the density n(r) is supposed to be nearly constant on
the hypersurface with the energy coordinate ǫ speciﬁed
by ǫ = υdef(r). n(r) can be regarded as a composite
function, thus, n(r) =
ne(υdef(r)). Eq. (11) can then be
cast into the form of the energy representation,

e

Enloc

gWT[n] =Cnloc
gWT

Z

e

drdr′n(r)αω (r, r′) n (r′)α

dǫdǫ′

=Cnloc
gWT
× δ (ǫ′ − υdef (r′)) n(r)αω (r, r′) n (r′)α

drdr′δ(ǫ − υdef(r))

Z

Z

=Cnloc
gWT

dǫdǫ′

ne(ǫ)α

ne (ǫ′)α

Z

drdr′δ(ǫ − υdef(r))δ (ǫ′ − υdef (r′)) ω (r, r′)

e

e

Z
=Cnloc
gWT

Z

dǫdǫ′

ne(ǫ)αωe (ǫ, ǫ′)

ne (ǫ′)α

(13)

e

e

(EH[n] + Exc[n] + Eext [n])

Enloc

gWT[n] = Cnloc
gWT

drdr′n(r)αω (r, r′) n (r′)α

(11)

Note that the integral kernel ω(r, r′) in the generalized
WT functional is represented with the energy coordinate
in Eq. (13). It is readily recognized that the transfor-
(13) can be performed
mation from Eq.
without approximations as long as Eq.
(12) holds ex-
actly. In practice, however,
n(ǫ) in Eq. (13) is taken as
the average electron density of the region with coordinate
ǫ, thus,

(11) to Eq.

e

n(ǫ) = Ω(ǫ)−1

dr n(r)δ(ǫ − υdef(r))

(14)

Z

where Ω(ǫ) is the volume of the spatial region with the
energy coordinate ǫ and is given by

e

Ω(ǫ) =

dr δ(ǫ − υdef(r))

(15)

Z

The validity of projecting the kernel ω(r, r′) and the
density n(r) onto the energy coordinate is guaranteed by
the framework of the DFT using the distribution ne(ǫ)
where the one-to-one correspondence is established[17]
between a certain subset of ne(ǫ) and a subset of the
external potential υe(ǫ) deﬁned with Eq. (6).

It is also worth discussing the numerical advantage
of taking the projection of the kernel ω.
In a numeri-
cal implementation, the LRF for some reference system
should be somehow inverted to obtain the kinetic po-
tential. However, it is probably infeasible in practice to
make the inversion of the response function χ(r, r′) rep-
resented on the real space since it has six variables at
each matrix element. A possible way to overcome the
problem is to introduce some basis functions to represent
the response function so that one can reduce the size of
the matrix. However, the basis functions suitable for the
expansion of χ is not known to the best of our knowledge.
We close this subsection with a brief summary. Pro-
vided that the nonlocal functional model in Eq. (11) is
adequate for some applications, the functional projected
onto the energy coordinate (Eq. (13)) will also be appli-
cable since the electron density is reasonably supposed
to be nearly constant on the isosurfaces of energy coor-
dinates. In the next subsection, we provide an explicit
form of a kinetic energy functional represented on the
coordinate ǫ although it cannot be used for general pur-
poses.

C. Nonlocal Kinetic Energy in the Energy
Representation

In this subsection we develop a kinetic energy func-
tional represented on the energy coordinate. We note
that the functional will refer to the linear-response func-
tion(LRF) of some inhomogeneous electron density. In
the previous works, the nonlocal term Enloc
WT [n] deﬁned in
Eq. (4) and its sophisticated forms were tested through
several applications and their eﬃciencies were demon-
strated to a certain extent. However, it is not known

4

whether the same form will be as eﬀective a functional
as the functional that utilizes the LRF of an inhomoge-
neous system. We, thus, propose a prototype of the ki-
netic energy functional with another form although the
applicability to general systems might be lost.

To do this we introduce a parameter λ which couples
the reference density n0(r) and the target density n1(r).
In the construction of the functional it is presumed that
the corresponding kinetic potential υkin[n0](r) and the
energy Ekin[n0] for the given density n0 are somehow
provided from the outset. This is the major drawback of
the present approach since the preparation of the reason-
able υkin[n0](r) and Ekin[n0] can be a diﬃcult problem
by itself. However, there have been a lot of function-
als that yield better kinetic potentials and energies for
the non-selfconsistent densities. The choice of the func-
tional suitable for our functional is not a subject in the
present work and it will be examined in a forthcoming
issue. Anyway, the kinetic energy Ekin[n1] can be formu-
lated through the coupling parameter integration,

Ekin [n1] = Ekin [n0] +

1

dλ

0

Z

1

= Ekin [n0] +

dλ

= Ekin [n0] +

0

Z

Z

dEkin [nλ]
dλ
dr dnλ(r)
dλ

Z

δEkin [nλ]
δnλ(r)

dr ((n1(r) − n0(r))

1

×

dλ

0
Z

δEkin [nλ]
δnλ(r)

(cid:19)

(16)

In deriving the right hand side of the third equality in
Eq. (16), it is assumed that the density varies linearly
with respect to λ,

nλ(r) = (1 − λ)n0(r) + λn1(r)

(17)

(17) is implicitly based on the premise
Note that Eq.
that there exists the corresponding eﬀective potential
υeﬀ[nλ](r) which yields the intermediate density nλ(r)
obeying Eq.
(17). This is reasonably justiﬁed by the
one-to-one correspondence[1] between the potential and
the density nλ although the υ-representability of nλ(r) is
not guaranteed. We further approximate that the kinetic
potential υkin [nλ] (r) = δEkin[nλ]
in Eq. (16) changes lin-
δnλ(r)
early. Then, its integration with respect to λ becomes

0
Z

1

dλυkin [nλ] (r) =

1
2

(υkin [n0] (r) + υkin [n1] (r))

(18)
After the substitution of Eq. (18) into Eq. (16), we take
the functional derivatives with respect to n1(r) for both
sides of Eq. (16), which reads

υkin [n1] (r) = υkin [n0] (r)

dr′ δυkin [n1] (r)
δn1 (r′)

+

Z

(n1 (r′) − n0 (r′))

(19)

In Eq. (19) we ﬁnd the functional derivative of the ki-
netic potential υkin[n1](r), which can be replaced by the
negative inverse of the response function as shown in Eq.
(10). Therefore, the kinetic potential can be rewritten as

υkin [n1] (r) = υkin [n0] (r)

function of r, while the second term depends on the en-
ergy coordinate ǫ. It doesn’t matter, however, because
the kinetic potential on a spatial coordinate r can be
readily obtained through the transformation ǫ = υdef(r)
using Eq. (6).

−

dr′χ−1

0

(r, r′) (n1 (r′) − n0 (r′))

(20)

Z

D. Self-consistent Field Calculation for Orbital-free
Density-functional Theory

5

where χ0 is the LRF for a reference system with the den-
sity n0(r) and no longer supposed to be that for the HEG.
It is readily proved that the kinetic energy Ekin[n1] is ob-
tained as

Ekin [n1] = Ekin [n0] +

drυkin [n0] (r)δn(r)

Z
drdr′χ−1

0

−

1
2

Z

(r, r′) δn(r)δn (r′)

where δn(r) is deﬁned as

δn(r) = n1(r) − n0(r)

We note that Eq. (21) has the desirable property that
its second derivative with respect to the density n(r) be-
comes the negative inverse of the LRF for some reference
system. As a major issue in the present development, we
represent the nonlocal term in Eq. (20) on the energy
coordinate,

kin [n1] (r) = υkin [n0] (r)
υe

(21)

(22)

There have been a lot of works devoted to expedite the
self-consistent ﬁeld (SCF) calculations in OF-DFT. How-
ever, in the present development we are not interested in
the implementation of eﬃcient SCF techniques. Here,
we devise a minimal procedure to achieve SCF conver-
gence in our approach. A possible improvement of the
algorithm will be the subject of a forthcoming issue. We
start the discussion with the variational principle for the
energy functional E[n]. As shown in Eq. (8), the mini-
mization of the energy E[n] with respect to n(r) under
the constraint that the total number of electrons is ﬁxed
at N gives the chemical potential µ for the electrons at
the stationary state. That is, the potential υ[n](r) de-
ﬁned by υ[n](r) = δE[n]
δn(r) is constant irrespective of r at
the energy minimum. Provided that the chemical poten-
tial µ is set at 0, minimization of the functional E[n] is
equivalent to the solution of the nonlinear equation,

υ[n](r) = 0

(26)

Within the ﬁrst-order variation of n, the solution n of
the equation satisﬁes the following approximation

dǫ′χe

0 (ǫ, ǫ′)−1 (ne

1 (ǫ′) − ne

0 (ǫ′))

(23)

υ [n] (r) ∼= υ[n](r)

−

Z

χe
0 (ǫ, ǫ′) in Eq. (23) can be obtained by projecting the
LRF in the real space onto the energy coordinate,

χe
0 (ǫ, ǫ′) =

drdr′χ0 (r, r′) δ(ǫ − v(r))δ (ǫ′ − v (r′))

Z
(24)
0 (ǫ, ǫ′)−1 represents an element of the inverse
0. Accordingly, the kinetic energy functional

Note that χe
matrix of χe
Ekin [n] in Eq. (21) is transformed to

Ee

kin [n1] = Ekin [n0] +

drυkin [n0] (r)δn(r)

−

1
2

Z

Z
dǫdǫ′χe

0 (ǫ, ǫ′)−1 δne(ǫ)δne (ǫ′)

(25)

As described in Appendix A, it is possible to prove that
χe
0 (ǫ, ǫ′) is positive semi-deﬁnite and hence,
invertible
through the Moore-Penrose pseudo-inverse method. The
detailed discussion on the eigenvector with the null eigen-
value of the matrix is shown in Ref. 22. Thus, only the
nonlocal term in the kinetic potential is described with
the energy representation. In Eq. (23) it should be no-
ticed that the ﬁrst term in the right hand side is the

dr′ δυ[n](r)
δn (r′)

+

Z

(n (r′) − n (r′)) = 0

(27)

where n is an arbitrary density reasonably close to n.
Then, the formal solution for the above equation is given
by

n(r) ∼= n(r) −

dr′

Z

δn(r)
δυ[n] (r′)

υ[n] (r′)

(28)

Thus, the electron density ni at the ith SCF step can be
updated as

δni(r)
δυ[ni] (r′)

ni+1(r) = ni(r) −

dr′

υ[ni] (r′)

(29)

Z
(29) is
Unfortunately, the SCF iteration through Eq.
practically infeasible because the functional derivative
of the density with respect to the potential υ[n](r)(=
υkin + υeﬀ) cannot be readily obtained. A simple but
ineﬃcient way to bypass the calculation of the integral
kernel in Eq. (29) is to replace the kernel with a unit
matrix multiplied by a small positive factor η.
In our
preliminary calculations, however, it was found that such
an approach gives rise to quite slow convergence in the

density. In the present implementation, we replace the
kernel with the derivative of the density with respect to
the kinetic potential, thus,

ni+1(r) = ni(r) − η

dr′

Z

δni(r)
δυkin[ni] (r′)

υ[ni] (r′)

(30)

It is important to note that the replacement of the kernel
doesn’t change the stationary condition. Actually, at the
convergence of the density, that is, ni+1(r) − ni(r) ∼= 0,
we have,

dr′

δni(r)
δυkin[ni] (r′)

υ[ni] (r′) ∼= 0

(31)

Z

δni(r)

Then, υ[ni] (r′) ∼= 0 is guaranteed since the kernel
δυkin[ni](r′) is always positive semideﬁnite and invertible.
Further, we assume that the kernel in Eq. (30) is eval-
uated for the reference system and represented on the
energy coordinate,

ni+1(r) = ni(r) + η

dǫ′χe

0 (ǫ, ǫ′) υ [ni] (ǫ′)

(32)

where the potential υ[n](ǫ) is deﬁned as

Z

υ[n](ǫ) =

drδ(ǫ − υdef(r))υ[n](r)

(33)

Z

In Eq. (32) it is possible that the kernel χe
0 (ǫ, ǫ′) plays
as a nonlocal weight function acting on the potential to
expedite the SCF. The choice of the value η will aﬀect
more or less the rate of the SCF convergence and accu-
racy of the results. In the present work, the appropriate
value of η is determined empirically as η = 0.05, and it
is used in the SCF calculations throughout.

Finally, we describe a minor issue for the density in
the SCF iteration. It is common to employ the variable
ϕ(r), that is, the square root of the density n(r),

ϕ(r) = n(r)

1
2

(34)

to avoid the situation that n(r) becomes negative during
the SCF. Then, the SCF iteration using Eq. (30) should
be modiﬁed as
ϕi+1(r) = ϕi(r)

− η

dr′

Z

(cid:26)

δϕ(r)
δn(r)

δn(r)
δυkin[n] (r′)

υ[ni] (r′)

(35)

(cid:27)ni

Accordingly, Eq. (32) is rewritten as

ϕi+1(r) = ϕi(r) + η

dǫ′

0 (ǫ, ǫ′) υ [ni] (ǫ′)
χe

(36)

where

χe

0 is deﬁned as

Z

0 (ǫ, ǫ′) =
χe
e

drdr′

e
δϕ(r)
δn(r)

δn(r)
δυkin (r′)

Z
× δ (ǫ − υdef (r)) δ (ǫ′ − υdef (r′))

(cid:26)

(cid:27)n0

(37)

e

In Eq. (37), n0 is the density of the reference system.

6

III. COMPUTATIONAL DETAILS

As a benchmark test we apply the kinetic energy func-
tional of Eq. (25) to pseudo atomic systems(H, He, Ne,
and Ar), where the core charge Zυ of each atom is shifted
by q within the range of −0.2 ≤ q ≤ +0.2 in the unit of
the elementary charge. Throughout the calculations, the
system with q = 0 is taken as the reference system to
build the response function χe
0(ǫ, ǫ′) as well as the den-
sity ne
0(ǫ) on the energy coordinate. Then, the variation
of the kinetic energy of each atom is compared with that
given by the Kohn-Sham DFT calculation. We also em-
ploy other OF-DFT functionals, that is, ETF[n] in Eq.
(1) and ETFW[n] in Eq. (3) for comparisons. In these
calculations the electron density n(r) is individually op-
timized beforehand in the separate Kohn-Sham DFT cal-
culation.

Next, we perform the variational calculation using the
kin [n] (r) in Eq. (23) to obtain the self-
kinetic potential ve
consistent electron density, where the reference density
n0(r) is employed as an initial guess. Then, we compute
the radial distribution functions 4πr2n(r) of the Ne and
Ar systems with q = 0.2 through OF-DFT SCF calcula-
tions using Eq. (36).

The ﬁrst subsection provides the details of the base
program to perform numerical OF-DFT calculations us-
ing the real-space grids. In the second subsection, we in-
troduce the construction of the pseudo atoms that mimic
H, He, Ne, and Ar, where the bare Coulomb potentials
are replaced by some local pseudopotentials to realize the
smooth behaviors of the densities near the atomic cores
although the properties of the corresponding atoms are
no longer maintained. The numerical details for the con-
struction of the response function and the energy electron
density on the energy coordinate is described in the third
subsection.

A. Real-space Grid Approach

The program module for the present OF-DFT is
newly developed and embedded in the Kohn-Sham DFT
program ‘Vmol’[23–28] based on the real-space grid
approach[29, 30]. Thus, the electron density n(r) is rep-
resented on the real-space grids uniformly placed within a
cubic box. Throughout the present calculations, the size
of the real-space cell is set at L = 18.354 a.u. and each
axis is discretized by equally spaced 64 grids, which leads
the grid width h = 0.2868 a.u. The exchange-correlation
energy Exc[n] in Eq.
(7) is evaluated with the BLYP
functional[31, 32]. To make comparisons among the ki-
netic energy functionals, we also employ the functionals
ETF[n] and EvW[n] given in Eqs. (1) and (2), respec-
tively. The Laplacian in Eq. (2) is represented with the
fourth-order ﬁnite diﬀerence method[29, 30].

B. Construction of Pseudo Atoms

To achieve the OF-DFT calculation within the plane-
wave or real-space grid approach, it is also a subject
of critical importance to develop local pseudopotentials
for atoms. Unfortunately, to the best of our knowledge,
there have not been suﬃcient amount of works along this
line. In the present study, however, we are not interested
in the applications to realistic atoms. We, thus, con-
sider ‘pseudo’ atoms which stem from Hydrogen, He-
lium, Neon, and Argon atoms. The sole purpose of the
pseudization is to realize the smooth variation of the den-
sity so that the real-space grid approach can adequately
describe it. To this end we merely adopt the local term
Vloc(r) in an existing pseudopotential set as a function
of the distance r between the electron and the nucleus.
As a speciﬁc treatment for pseudo Ne and Ar atoms, we
additionally embed the potential ∆Vs(r) assigned as the
S component in the nonlocal term to mimic the repulsive
potential due to the core electrons. Actually, we found
that the valence electrons in Ne and Ar erroneously pen-
etrate into the core region without the term ∆Vs(r). In
the present calculation, we use the terms in the BHS
pseudopotential[33] as components to build the poten-
tial. We summarize the form of the local pseudopoten-
tial V A
ps (r) for atom A(= H, He, Ne, or Ar) used in our
calculations,

ps (r) = V A
V A

loc(r)

(A = H, He)




ps (r) = V A
V A

loc(r) + ∆V A

s (r)

(A = Ne, Ar)

(38)

where V A

forms,

loc(r) and ∆V A

s (r) are, respectively, given in the

.

.

u
a
/
)

r

(
s
p

V
y
g
r
e
n
E

l
a
i
t
n
e
t
o
P

5

0

!5

!10

!15

!20

!25

0

7

H
He
Ne
Ar

0.5

1.0

1.5

2.0

2.5

r /  a.u.

FIG. 1. The local pseudopotentials constructed using Eq.
(38) for H, He, Ne, and Ar pseudo atoms. The broken lines are
the corresponding Coulomb potentials of the valence charges
Zv.

Eq. (38) are not optimized to reproduce the properties
of the corresponding realistic atoms. Hence, the eigen-
values provided by the Kohn-Sham DFT calculation are
not coincident with those constructed by the full set of
pseudopotential that includes the nonlocal terms. How-
ever, it makes complete sense to compare the result given
by OF-DFT with that given by the KS-DFT calculation.
The time-saving double-grid technique[34] is employed to
describe adequately the steep variation of the local pseu-
dopotentials in the core region, where the width of the
dense grid is set at h/5 throughout the calculations.

(39)

C. Energy Coordinate and Linear-response
Function

Vloc(r) = −

Zv
r "

2

i=1
X

ci erf

(αi)1/2 r
h

#

i

and

3

∆Vs(r) =

Pi + r2Pi+3

exp(−αir2)

(40)

i=1
X

(cid:0)

(cid:1)

In Eqs.
(39) and (40) we omit the superscript A for
simplicity. In Eq. (39) Zv is the corresponding valence
charge for atom A. Zv are 1.0 and 2.0 for H and He atoms,
respectively, while Zv = 8.0 for Ne and Ar. The coeﬃ-
cients ci and αi in Eq. (39) are tabulated in Ref. 33 for
various atoms. The two sets of coeﬃcients Pi and Pi+3
in Eq. (40) correspond to the exponents αi (i = 1, 2, 3).
The set of Pi can be obtained by the numerical recon-
struction of the data in Table IV in Ref. 33. We refer the
readers to the paper for the detail of the algorithm. The
local pseudopotentials employed in the present calcula-
tions are displayed in Fig. 1. In the graphs for Ne and
Ar atoms, it is shown that each Vps(r) rises notably near
the core region due to the repulsive potential ∆Vs(r).
It should be stressed that the pseudopotentials given in

As shown in Eq. (6) the bare Coulomb potential is usu-
ally employed as the deﬁning potential υdef(r) for the en-
def(r) can
ergy coordinate ǫ. However, another potential υ′
also be adopted as a deﬁning potential as long as the re-
def(rB) holds for any points rA and rB
lation υ′
satisfying υdef(rA) = υdef(rB)[17]. In the present devel-
opment, in contrast to the previous works[17, 19], we em-
ploy the opposite sign of the BHS local potential V BHS
(r)
as the deﬁning potential, i.e., υdef(r) = −V BHS

def(rA) = υ′

loc
(r).

loc

The log-scaled energy coordinate with the range of
(log ǫmin, log ǫmax) is uniformly discretized by N e
grid grid
points. Then, the energy electron density ne(ǫ) in Eq.
(5) and the response function χe
0(ǫ, ǫ′) in Eq. (24) are
numerically constructed on the discrete energy coordi-
nates. The parameters N e
grid and (ǫmin, ǫmax) are indi-
vidually determined for each atom and the values are
summarized in the ‘Supplementary Material’.

The linear-response function(LRF) χ0(r, r′) in Eq.
(24) for a reference system is obtained by the 2nd-order
perturbation theory. To do this, we ﬁrst solve a Kohn-

 
 
 
Sham equation for the reference system(i.e., q = 0.0),

1
2

−

∇2 + υeﬀ [n0] (r)

i (r) = ǫ0
ϕ0

i ϕ0

i (r)

(41)

(cid:18)

(cid:19)
where n0 is the electron density constructed from the self-
consistent solutions {ϕ0
i }, and {ǫ0
i } is the corresponding
eigenvalues. Then, the LRF is evaluated as

occ

χ0(r, r′) =

vir

1
a − ε0
ε0
i
a (r′)ϕ0

i (r′)

i
X

a
X
× ϕ0∗

i (r)ϕ0
ϕ0∗

a(r)

(42)

where the indices i and a are for the occupied and virtual
orbitals, respectively. Explicitly, the numbers of the vir-
tual orbitals included in Eq. (42) are 23 for H and He, 20
for Ne, and 22 for Ar. It is found that the LRF is rather
insensitive to the number of the virtual orbitals. How-
ever, attention should be paid to the upper limit since
the virtual orbitals with larger eigenvalues can not be
adequately accommodated in the real-space cell. Note
that the kinetic potential υkin[n0](r) in Eq. (23) as well
as Ekin[n0] in Eq. (25) for the reference system can also
be obtained from the solution of Eq. (41). Speciﬁcally
for υkin[n0](r), we use the relation,

υkin[n0](r) = −υeﬀ [n0] (r)

(43)

Although the response function χ0(r, r′) can be eas-
ily computed, the projection onto the energy coordinate
through Eq. (24) is rather time-consuming. This could
be a serious problem when we consider its applications
to larger systems in a later development. In our perspec-
tive, however, the LRF of a composite system might be
adequately constructed from the overlap of the LRF of
the constituent systems on the energy coordinate.

D.

Inverse of Linear-response Function

We also make a remark on the inversion of the LRF
deﬁned on the energy coordinate. As shown in Appendix
A, the matrix χe
0(ǫ, ǫ′) is positive semi-deﬁnite, and hence
can be inverted using the pseudo-inverse method. Here,
we discuss another issue associated with the inversion.
Suppose that the matrix is given in the form of the spec-
tral decomposition,

N e

grid

0(ǫ, ǫ′) =
χe

hǫ | γii gi hγi | ǫ′i

(44)

i
X
where γi(ǫ) is the eigenvector of the matrix χe
0, and gi
is the corresponding eigenvalue. The matrix includes
at least one null eigenvector with the 0 eigenvalue due
to the condition that the number of electrons is being
ﬁxed. However, it is found unexpectedly that there ex-
ists a lot of eigenvectors with substantially zero eigenval-
ues for the atomic systems studied in the present work.

In addition, it is also revealed that the eigenvector with
the largest eigenvalue dominates the construction of the
matrix. Shown in Fig. 2(a) is the eigenvalues {gi} plot-

8

(a)

0.25

(b)

20

10

45

3

2

ϵ ′

1

χ e
0

(ϵ,

ϵ ′

)   

i
g

0.20

e
u
l
a
v
n
e
g
i
E

0.15

0.10

0.05

0

0.5
0.05

0.00

!0.05

0.5

1

(c)

(d)

       ϵ   

2

3 4 5

5

index i
index

10

20

10

(b)

20

10

45

3

2

1

ϵ ′

g 1

 = 0.2435

0.5
0.05

0.00

!0.05

0.5

1

       ϵ   

2

3 4 5

10

20

(c)

20

10

45

3

ϵ ′

2

1

g 2
    = 0.0138

(d)

20

10

45

3

ϵ ′

2

1

g 3

 = 0.0019

0.5
0.005

0.000

!0.005

0.5

1

       ϵ   

2

3 4 5

10

20

0.5
0.0005

0.0000

!0.0005

0.5

1

       ϵ   
2 3 4 5

10

20

FIG. 2. (a) The plot of the eigenvalues {gi} in descending
order for the pseudo Ar atom. The linear-response function
0(ǫ, ǫ′) of the Ar atom is superposed. (b), (c), and (d) show
χe
′
the functions giγi(ǫ)γi(ǫ
) (see Eq. (44)) for the indices i = 1,
2, and 3, respectively. Units of the energy coordinate ǫ is a.u.,
−2.
while that of χ

) is a.u.

′
e
0(ǫ, ǫ

ted for the pseudo Ar atom in descending order, where
the three-dimensional graph for the LRF χe
0(ǫ, ǫ′) is also
superposed. The notations (b), (c), and (d) in the plot
denote the three largest eigenvalues, for which the cor-
responding LRF components giγi(ǫ)γi(ǫ′) are drawn in
Figs. 2(b), 2(c) and 2(d), respectively. By consulting
Figs. 2(a) and 2(b), it is recognized that the eigenvector
γ1 with the lowest frequency is dominant in the decompo-
sition of the total LRF in Eq. (44). It seems that higher
frequency mode γi gives much smaller contribution to the
LRF as observed in the sequence of Figs. 2(b), 2(c) and
2(d). It is remarkable that the response function gener-
ated by the lowest frequency mode γ1 faithfully realizes
the total LRF shown in Fig. 2(a). It is found that this
trend is common to all the atoms treated in the present
work. In the pseudo-inverse approach, the inverse of the
LRF of Eq. (44) can be obtained by

N e

grid−1

0(ǫ, ǫ′)−1 =
χe

hǫ | γii g−1

i

hγi | ǫ′i

(45)

i
X

Note that the eigenvector with 0 eigenvalue is to be ex-
cluded from the summation in the right hand side of Eq.
In a practical calculation, however, the smallest
(45).

       
       
   
       
   
       
   
       
   
 
 
 
 
       
   
       
   
       
   
 
 
 
 
 
 
 
 
 
 
eigenvalue may not become exactly zero due to the nu-
merical error. Thus, the eigenvector with the smallest
eigenvalue should be excluded from the construction of
the inverse matrix. However, it is found in the prelimi-
nary calculations that the faithful execution of Eq. (45)
gives rise to the unphysical oscillations in the matrix
0(ǫ, ǫ′)−1 due to the high frequency modes multiplied
χe
by the huge values g−1
. Actually, as demonstrated in
Appendix B, the magnitude of the component of the re-
sponse function χe
0(ǫ, ǫ′) with a small eigenvalue is found
to be within the grid error due to the use of the real-
space grids in representing the function χ0(r, r′). Thus,
the summation in Eq.
(45) should be truncated after
the ﬁrst few leading terms in practice. Throughout this
work, we only consider the eigenvector γ1 with the largest
eigenvalue g1 to construct the inverse of the LRF. The
eﬀect of the inclusion of the residual contributions will
be examined later.

i

IV. RESULTS AND DISCUSSION

First, we apply our kinetic energy functional Ee
kin[n]
to the pseudo atoms (H, He, Ne, and Ar) to compute
the variation of the kinetic energy for each atom when
the valence charge Zv is shifted by q within the range of
−0.2 ≤ q ≤ 0.2 in the unit of the elementary charge. The
density n(r) optimized by Kohn-Sham DFT (KS-DFT)
is adopted as the argument of the functional.

Next, the self-consistent densities for the Ne and Ar
atoms are computed through the present OF-DFT ap-
proach. The radial distributions of the electrons are com-
pared with those obtained by the KS-DFT calculations.

A. Kinetic Energy Calculation Using
Non-self-consistent Density

Figure 3 shows the proﬁle of the kinetic energy Ee
kin[n]
(Eq. (25)) with respect to the variation of the valence
charge Zv (0.8 ≤ Zv ≤ 1.2) of the pseudo H atom.
To make comparisons we also employ the Thomas-Fermi
(TF) functional ETF in Eq.
(1) and ETF combined
with the Weizs¨acker correction, that is, the TFW func-
(3). The electron density n(r)
tional ETFW in Eq.
adopted as the argument is that optimized through the
self-consistent ﬁeld (SCF) calculation of the KS-DFT
method.
In every plot, the kinetic energy increases
monotonically with respect to the increase in the valence
charge Zv. The increase in Zv causes the stabilization of
the potential energy of the system, which leads to the in-
crease in the kinetic energy. As observed in the ﬁgure, the
functional Ee
kin[n] developed in the present work shows
excellent agreement with the result of KS-DFT except
for the region around Zv = 0.80. Although the kinetic
energy at Zv = 0.80 varies by ∼ 0.13 a.u.
from that
of the reference system with Zv = 1.0, the deviation of
the present work from the KS-DFT value stays ∼ 0.01

a.u. It is notable that the present work perfectly realizes
the KS-DFT values around another end of the valence
charge, i.e., Zv = 1.2. It is observed in the ﬁgure that

9

.

.

u
a
/
y
g
r
e
n
E
c
i
t
e
n
i
K

0.6

0.5

0.4

0.3

0.2

Kohn-Sham DFT

Present Work

TF +

GGA
1
5
1
9

TF +

 W

 W

TF

Charge of the
reference system

H

0.8

1.0
0.9
Valence Charge Z! / e

1.1

1.2

FIG. 3. Plots of the kinetic energies computed by various
kinetic functionals for the variation of the valence charge Zv
of the pseudo H atom. The atom with Zv = 1.0 is taken
as the reference system. The value of the ‘Present Work’
is
provided using Eq. (25). The GGA functional is that given
in Eq. (46) or equivalently Eq. (12) in Ref. 35. ‘TF + 1/5W’
and ‘TF + 1/9W’ are obtained by Eq. (3) with λ = 1/5 and
1/9, respectively. ‘TF’

is evaluated by Eq. (1).

the energy of the TF functional is always lower than that
of KS-DFT, where the diﬀerence between the TF and
the KS-DFT energy is ∼ 0.03 a.u. at the most. Unfor-
tunately, it is found that the inclusion of the Weizs¨acker
term with the factor λ = 1
5 overcorrects the underesti-
mation of the TF functional. Adopting the factor λ = 1
9 ,
which correctly reproduces the LRF of the homogeneous
electron gas in the small k region, provides much bet-
ter result. The fact that TFW functional with λ = 1
9
is superior to λ = 1
5 is somewhat surprising because it
was demonstrated in Ref. 11 that the choice of λ = 1
5
gives the smallest errors in the evaluation of the total
energies of various atoms. It is possible that the result
is aﬀected by the smooth behavior of the density due to
the pseudization of the atom. We also examine the per-
formance of a sophisticated GGA (generalized gradient
approximation) functional for the kinetic energy. Explic-
itly, we employ Eq. (12) in Ref. 35, which was heuris-
tically developed by integrating the several types of the
GGA functionals to minimize the error for the kinetic
energies of the 77 molecules. The explicit form of the
functional for a spin is given by

EGGA

kin [n] = 2

2

3 CTF

dr n(r)

5
3

Z

A1x2
1 + A2x sinh−1 x

×

1 +

(cid:18)

−

A3x
1 + A4x

(cid:19)

(46)

where x represents the inhomogeneity of the density of
the spin and deﬁned by |∇n(r)|/n(r)
3 . The parame-

4

 
 
 
(46) are speciﬁed as A1 = 0.0055,
ters {Ai} in Eq.
3 . Despite the
A2 = 0.0253, A3 = 0.072, and A4 = 2
sophistication of the GGA functional, it oﬀers quite mi-
nor improvement on the TFW functional with λ = 1
9 as
shown in the ﬁgure.

5

Here, we discuss the contribution of the nonlocal term
(25). As shown in the equation, the nonlocal
in Eq.
energy is the quantity proportional to the 2nd order of
the deviation of the energy electron density δne(ǫ) =
ne(ǫ) − ne
0(ǫ). Thus, the contribution is zero at Zv = 1.0
in principle and considered to be larger at the both ends
of the plot. Actually, the third term in Eq. (25) amounts
to 0.024 a.u. and 0.013 a.u., respectively, at Zv = 0.8 and
1.2, although the contributions are much smaller as com-
pared with those of the local term. For the calculation
of Fig. 3, the energy coordinate ǫ (0.05 ≤ ǫ ≤ 5.0) in the
unit of a.u. is discretized by N e
grid = 25 grids as listed in
the ‘Supplemental Material’. We examine the numerical
robustness by setting N e
grid = 15 in an additional calcula-
tion. It is demonstrated that the nonlocal terms become
0.025 a.u. at Zv = 0.8, and 0.014 a.u. at Zv = 1.2, which
shows the numerical stability of the functional with re-
spect to the choice of the width of the grid.

We also examine the eﬀect of the inclusion of the higher
frequency modes in the decomposition of Eq. (44). As
was described at the end of Subsec.
3.D., only the
term with the largest eigenvalue (g1 = 0.103) is incor-
porated in the calculation of Fig. 3.
It is found that
considering up to the term with the secondary largest
eigenvalue(g2 = 0.016) leads to the deviation of the ki-
netic energy upward by 0.01 a.u. at Zv = 1.2. Further-
more, it is also revealed that including up to the third
term (g3 = 0.00062) worsens the kinetic energy by 0.052
a.u. Thus, the inclusion of the residual modes besides the
leading term in Eq. (44) is found to degrade the func-
tional Ee
kin[n]. This trend also applies to the other end
of the Zv axis. At this stage, unfortunately, we have no
good reason to justify the truncation in the decomposi-
tion. However, it is speculated that some statistical noise
is present in the numerical construction of the LRF due
to the lack of samplings, which may cause the creation of
0 (ǫ, ǫ′). Actually,
unphysical high frequency modes in χe
in our real-space grid approach, the construction of the
LRF on the energy coordinate is numerically performed
by projecting the data on the 643 grid points in the real-
space cell onto the 25 grids for the energy coordinate.
Seemingly, the amount of the data assigned to an en-
ergy coordinate ǫ is not suﬃcient when the coordinate
corresponds to the atomic core region in particular. To
increase the sampling points, one may consider to ap-
ply the double-grid technique[34] to the core region. We
found, however, that the straightforward implementation
of the method leads to the destruction of the crucial con-
dition that the matrix χe
0 (ǫ, ǫ′) is positive semi-deﬁnite.
In the following, we provide the results for the remaining
pseudo atoms, i.e., He, Ne, and Ar.

In Fig. 4 the proﬁles of the kinetic energies for the
pseudo He atom are presented. The energy range of the

10

plots is extended by about 3 times as compared with that
for H atom because the depth of the local pseudopoten-
tial for He is much deeper than that for H as shown in
Fig. 1 and the number of electrons is twice that of H. It is
clearly recognized in the ﬁgure that the plots have quite
similar trend as those for the pseudo H atom. It is strik-
ing that the kinetic energy given by Eq. (25) excellently
agrees with that by KS-DFT over the whole range of Zv.
Actually, the two plots are almost indistinguishable in
the graph. We note, however, that absolute diﬀerence in
the kinetic energy at Zv = 2.2 between the present work
and the KS-DFT is evaluated as 0.006 a.u., and this is
found to be about the half of the diﬀerence between them
for the pseudo H atom at Zv = 0.8.

Kohn-Sham DFT

.

.

u
a
/
y
g
r
e
n
E
c
i
t
e
n
i
K

3.0

2.5

2.0

1.5

TF +

Present Work
1
5
1
9

TF +

 W

 W

TF

Charge of the
reference system

He

1.8

2.0
1.9
Valence Charge Z! / e

2.1

2.2

FIG. 4. Plots of the kinetic energies computed by various
kinetic functionals for the variation of the valence charge Zv
of the pseudo He atom. The atom with Zv = 2.0 is taken as
the reference system. The plots for ‘Kohn-Sham DFT’ and
‘Present Work’ are almost indiscernible in the ﬁgure. The
other notations are the same as in Fig. 3.

In Fig. 5 the results for the pseudo Ne atom are plot-
ted. The range of the energy variation is 1.5 times as
large as that of the He atom. This is attributed to the
fact that the number of the valence electrons for Ne is 4
times as many as that for He. Note, however, that the
valence electrons in Ne reside outside the core region due
to the repulsive potential ∆Vs(r) augmented in the lo-
cal pseudopotential drawn in Fig. 1. Again, it is found
that the coincidence between the present work and the
KS-DFT is quite excellent. The maximum absolute de-
viation from the KS-DFT value is 0.006 a.u. that occurs
at Zv = 7.8. As a notable feature speciﬁc to the results
for Ne, the Thomas-Fermi functional corrected with 1/9
Weizs¨acker term shows good agreements with the KS-
DFT in the range of 8.0 ≤ Zv ≤ 8.2.

Lastly, we provide the results for the pseudo Ar atom
in Fig. 6. In the ﬁgure, it is shown that the range of the
kinetic energy variation is reduced to about the half of the
energy range for Ne. This can be attributed to the facts
that the local pseudopotential of Ar (see Fig. 1) is much
shallower than that of Ne, and the potential valley of Ar

 
 
 
16

15

14

13

.

.

u
a
/
y
g
r
e
n
E
c
i
t
e
n
i
K

11

Ar

Kohn-Sham DFT

Kohn-Sham DFT

TF +

Present Work
1
5
1
9

TF +

 W

 W

TF

Charge of the
reference system

Ne

.

.

u
a
/
y
g
r
e
n
E
c
i
t
e
n
i
K

8.0

7.5

7.0

6.5

TF +

Present Work
1
5
1
9

TF +

 W

 W

TF

Charge of the
reference system

7.8

8.0
Valence Charge Z! / e

8.2

7.8

8.0

8.2

Valence Charge Z! / e

FIG. 5. Plots of the kinetic energies computed by various
kinetic functionals for the variation of the valence charge Zv
of the pseudo Ne atom. The atom with Zv = 8.0 is taken as
the reference system. The plots for ‘Kohn-Sham DFT’ and
‘Present Work’ are almost indiscernible in the ﬁgure. The
other notations are the same as in Fig. 3.

FIG. 6. Plots of the kinetic energies computed by various
kinetic functionals for the variation of the valence charge Zv
of the pseudo Ar atom. The atom with Zv = 8.0 is taken as
the reference system. The plots for ‘Kohn-Sham DFT’ and
‘Present Work’ are almost indiscernible in the ﬁgure. The
other notations are the same as in Fig. 3.

is located farther from the atomic core than that of Ne. It
is worthy of noting that the present work shows the best
agreements with the KS-DFT values in the application
to Ar among the other atoms. Actually, the maximum
deviation in the energy from the KS-DFT values is found
to be only ∼0.001 a.u. However, this is simply because
the nonlocal energy gives the minor contribution to the
kinetic energy in the Ar system. Explicitly, the nonlocal
energy in the functional Ee
kin of Eq. (25) is evaluated to
be 0.007 a.u. at Zv = 8.2.

We close this subsection by making a brief remark
on the kinetic energy functional Ee
kin using a non self-
consistent density. First, it was demonstrated that the
functional is able to compute the kinetic energies with
reasonable accuracies as compared with those obtained
by the Kohn-Sham DFT. Second, it was found that the
nonlocal term, represented with a functional of the en-
ergy electron density ne(ǫ), certainly improves the de-
scription of the kinetic energy although the contribution
to Ee
kin is proportional to the second order with respect
to δne.
In the next subsection, we provide the self-
consistent densities obtained through the present OF-
DFT approach.

B. Self-consistent Field Calculations with the
OF-DFT Method

In this subsection, the radial distribution functions
(RDFs) for electrons in the pseudo Ne and Ar atoms with
Zv = 8.2 are presented, where the corresponding electron
densities are optimized through the self-consistent ﬁeld
(SCF) calculations utilizing Eqs. (36) and (37). The pa-
rameter η in Eq. (36) is set at 0.05. The convergence

thresholds are 5.0 × 10−7 a.u. for the total energy, and
5.0 × 10−9 a.u.−3 for the density. The initial guess for
the density for each system is the electron density n0 of
the system with Zv = 8.0. The 4-points polynomial in-
terpolation method is utilized to increase the sampling
points for the construction of the smooth RDFs. Explic-
itly, (100, 200, 400) grid points are yielded for the spher-
ical coordinates (r, θ, φ) and the density on each grid is
evaluated by the polynomial interpolation of the rectan-
gular grids, where the range of the radial distance r is
0 ≤ r ≤ 8.604 a.u. The results are plotted in Fig. 7. We
found in the both plots that the RDFs optimized by the
OF-DFT reasonably agree with those given by KS-DFT.
We note, however, that the kinetic energies Ekin by the
OF-DFT are somewhat diﬀerent from those by KS-DFT
calculations. Explicitly, Ekin for the Ne atom is evaluated
as 14.685 a.u. by the OF-DFT, while the KS-DFT gives
Ekin = 14.709 a.u. For the Ar atom, Ekin are computed
as 7.344 and 7.355 a.u., by the OF-DFT and KS-DFT
methods, respectively. Thus, it was found the kinetic en-
ergy as well as the density are degraded through the SCF
procedure in the OF-DFT calculation.

loc

We should make additional remarks on the construc-
tion of the RDF for the Ne atom. Speciﬁcally in the
SCF calculation for the Ne atom, we actually adopt the
BHS local potential V BHS
(r) of the Ar atom[33] as the
potential υdef(r) to create the energy coordinate ǫ. The
(r) for Ne as υdef(r) necessitates the wide
use of V BHS
energy range for the energy coordinate because the Ne
potential is very steep around the atomic core. There-
fore, in the construction of the response function using
such a deﬁning potential, a lot of bins become null in
the region with large energy coordinate due to the low
resolution of the real-space grids around the core. This

loc

 
 
 
 
 
 
12

deﬁned as

KS-DFT (Ne)
OF-DFT (Ne)

KS-DFT (Ar)
OF-DFT (Ar)

F (r) = exp(−ζr2)

(ζ > 0)

(48)

In Eq. (47), the potential υTF
of the TF potential, thus,

kin [n](r) is expressed in terms

F
D
R

8

6

4

2

0

0

3
-

.

.

u
a
/
y
t
i
s
n
e
D

3

2

1

0

0

2

r / a.u.

4

6

6

8

2

4
r  / a.u.

FIG. 7. Plots of the radial distribution functions (RDFs) for
the electrons in the pseudo Ne and Ar atoms. Superposed in
the ﬁgure is the corresponding density proﬁles along the radial
distance r. The electron densities are obtained through the
SCF calculations. The valence charges Zv of these systems
are set at Zv = 8.2 in the unit of the elementary charge.

might give rise to a numerical instability in the SCF cal-
culation. In principle, the potential of any atomic core
can be indeed used as a deﬁning potential for another
atom within the framework of the DFT based on the en-
ergy electron density[17] since the potential due to the
nucleus is always spherically symmetric. Actually, the
use of the Ar potential rather than the Ne potential in
computing the plot in Fig. 5 makes a diﬀerence of only
∼ 0.5 kcal/mol (∼ 8 × 10−4 a.u.) in the kinetic energy
at Zv = 8.2.

We also note an unfavorable phenomenon found in the
SCF calculation for the Ne atom. That is, the elec-
tron population on the atomic core increases gradually
through the SCF iterations, which seriously aﬀects the
density convergence. This suggests that the nonlocal
term in the kinetic potential does not work appropri-
ately on the atomic core region since only the nonlocal
potential is dependent on the electron density as seen in
Eq. (23). The drawback might be attributed to the poor
resolution of the grids around the core. The problem also
(r) for Ne is used as υdef(r) because
emerges when V BHS
it also makes no contribution to increase the resolution
around the core. Here, we apply an ad hoc approach to
compensate for the error. Explicitly, we mix the kinetic
potential with the Thomas-Fermi (TF) potential only on
the core region using a Gaussian weight function F (r).
The explicit form of the kinetic potential υe
kin with the
patch on the core is given by

loc

kin [n](r) =υkin [n0] (r) + F (r)υTF
υe

kin [n](r)

+ (1 − F (r))υnloc

kin [ne] (ǫ)

(47)

where the potential υnloc
kin is the second term of the right
hand side of Eq. (23) and the weight function F (r) is

(cid:12)
(cid:12)
(cid:12)
(cid:12)

kin[n](r) =
υTF

δυTF[n](r)
δn(r)

(n(r) − n0(r))

(49)

n0

where the potential υTF is given by the functional deriva-
tive of Eq. (1), that is, δETF[n]/δn(r). Notice that the
kin[n](r) is designed so that it becomes zero
potential υTF
when the density n(r) coincides with n0(r). The param-
eter ζ in Eq. (48) speciﬁes the width of the Gaussian
and it is set at ζ = 5.0 a.u.−2 in the present calculation.
With this choice of ζ, the weight F (r) is reduced to less
than 0.2 within the distance r = 2h for the grid width
of h = 0.2868 a.u. Thus, the potential υTF
kin in Eq. (47)
applies only to the limited region around the core.
It
was demonstrated that the treatment improves the SCF
convergence in the electron density. It was also found in
the calculation of Zv = 8.2 that the contribution of the
TF energy to the kinetic energy amounts to 5.2 kcal/mol
after the SCF convergence.

V. CONCLUSION AND PERSPECTIVE

In this article, we developed a kinetic energy functional
Ee
kin[n] within the framework of the density-functional
theory based on the energy electron density ne(ǫ)[17]
for the purpose of realizing the orbital-free DFT(OF-
DFT) calculations. The functional includes the nonlocal
term described with a linear-response function(LRF) of
a reference system as was introduced in the Wang-Teter
functional[13]. As a notable feature, the LRF, which
constitutes the integral kernel of the nonlocal term, is
represented on the energy coordinate ǫ, thus, χe
0(ǫ, ǫ′).
In addition, an atomic system is taken as a reference
system in contrast to the conventional approach that
utilizes LRF of the homogeneous electron gas. The ki-
netic functional Ee
kin[n] was formulated by means of the
coupling-parameter integration scheme. The functional
was applied to the calculation of the kinetic energies of
the pseudo atoms which stem from H, He, Ne, and Ar
atoms. Explicitly, the kinetic energy of each atom was
computed with respect to the variation of the valence
charge Zv, where the atom with its original charge Zv was
0(ǫ, ǫ′).
adopted as the reference system to construct χe
It was demonstrated that the functional Ee
kin[n] is able
to provide the kinetic energies in good agreements with
those obtained by the Kohn-Sham DFT(KS-DFT) for the
given non self-consistent electron densities n.

We also devised a scheme to perform the self-consistent
ﬁeld (SCF) calculation using Ee
kin[n] although the sophis-
tications to expedite the convergence were not made.
The radial distribution functions (RDFs) of the elec-
trons in the pseudo Ne and Ar with Zv = 8.2 were

 
 
obtained through the SCF calculations. The RDFs by
the OF-DFT calculations showed reasonable agreements
with those given by KS-DFT calculations. Thus, the re-
liability of the method was demonstrated.

It should be noticed that the application of the
present approach to an actual system of interest such as
molecules is ineﬃcient since it necessitates the individual
solution of the KS equation for a certain reference system
to build the LRF for each system. Our strategy in the
near future to solve the problem is to compute and store
beforehand the LRFs of the constituent atomic systems.
Then, we take the overlap of the component LRFs on
the energy coordinate to construct the total LRF of
the target molecule. We note that the construction of
the molecular LRF on the energy coordinate is justiﬁed
by the DFT based on the energy electron density[17].
Although the projection of the LRF onto the energy
coordinate itself is time consuming, the computational
cost is proportional to the system size. The reference
electron density n0 will also be constructed from the
overlap of the electron densities of the constituent atoms.
The corresponding kinetic energy and the potential for
the reference system will be evaluated by some existing
GGA functional for instance. These methods will be
developed and examined in a forthcoming issue.

ACKNOWLEDGMENTS

The author is grateful to Prof. N. Matubayasi in Os-
aka university for the fruitful discussions on the pseudo
inverse method utilized for the inversion of the linear-
response matrix. This paper was supported by the
Grant-in-Aid for Scientiﬁc Research on Innovative Ar-
eas (No.
23118701) from the Ministry of Education,
Culture, Sports, Science, and Technology (MEXT); the
Grant-in-Aid for Challenging Exploratory Research (No.
25620004) from the Japan Society for the Promotion of
Science (JSPS); and the Grant-in-Aid for Scientiﬁc Re-
search(C) (No. 17K05138) from the Japan Society for
the Promotion of Science (JSPS). This research also used
computational resources of the HPCI system provided
by Kyoto, Nagoya, and Osaka university through the
HPCI System Research Project (Project IDs: hp170046,
hp180030, hp180032, hp190011, and hp200016).

13

coordinate. First, we provide the proof that χ0 (r, r′) is
positive semi-deﬁnite. To this end, we consider a quantity
Q with respect to an arbitrary function q(r),

Q =

drdr′q(r)χ0 (r, r′) q∗ (r′)

(A1)

Z

For our purpose, it is suﬃcient to prove that the relation
Q ≥ 0 always holds. By substituting Eq. (42) into Eq.
(A1), one readily obtains,

Q =

Z

drdr′

occ

vir

1
a − ε0
ε0
i
a
i
X
X
a (r′)ϕ0
i (r′)q∗(r′)

q(r)ϕ0∗

i (r)ϕ0

a(r)

× ϕ0∗
vir

occ

=

=

i
X
occ

a
X
vir

i
X

a
X

1
a − ǫ0
ǫ0

i Z

drdr′Φia(r)Φ∗

ia (r′)

1
a − ǫ0
ǫ0
i

|Sia|2

(A2)

where the function Φia(r) in the right hand side of the
a(r)
second equality is deﬁned as Φia(r) = q(r)ϕ0∗
i (r)ϕ0
drΦia(r).
and Sia in the last equality is given by Sia =
Note that the quantity Q becomes zero when the func-
tion q(r) is constant. Thus, it is proved that χ0 (r, r′) is
positive semi-deﬁnite. Then, the it is rather straightfor-
0(ǫ, ǫ′) is also positive semi-deﬁnite.
ward to prove that χe
For an arbitrary function qe(ǫ), it reads,

R

dǫdǫ′qe(ǫ)χe

0 (ǫ, ǫ′) qe (ǫ′)

Z
=

Z

dǫdǫ′qe(ǫ)qe (ǫ′)

×

drdr′χ0 (r, r′) δ(ǫ − v(r))δ (ǫ′ − v (r′))

Z

=

drdr′χ0 (r, r′)

dǫ qe(ǫ)δ(ǫ − v(r))

Z

Z

×

dǫ′qe (ǫ′) δ (ǫ′ − v (r′))

Z

=

drdr′ θ(r)χ0 (r, r′) θ(r′) ≥ 0

(A3)

Z

dǫqe(ǫ)δ(ǫ − v(r)). Thus,
where θ(r) is deﬁned as
χe
0(ǫ, ǫ′)
0(ǫ, ǫ′) is also positive semi-deﬁnite. Hence, χe
R
can be inverted through a manipulation such as a pseudo
inverse method.

Appendix A: Linear-response Function

Here, we prove that the linear-response function (LRF)
χe
0(ǫ, ǫ′) in Eq.
(24) deﬁned on the energy coordinate
is positive semi-deﬁnite. We start the discussion with
the LRF χ0 (r, r′) in Eq.
(42) deﬁned on the spatial

Since we utilize the real-space grid (RSG) approach in
representing the response function χ0(r, r′), its projec-
tion χe
0(ǫ, ǫ′) onto the energy energy coordinate ǫ (Eq.
(24)) is aﬀected by the grid error inherent in χ0(r, r′).
In this Appendix, we demonstrate that the terms with

Appendix B: Grid Error in Response Function

small eigenvalues in the spectral decomposition in Eq.
(44) are comparable in magnitude to the grid error in
0(ǫ, ǫ′). To this end, we employ the double-grid tech-
χe
nique. Explicitly, the values χ0(r, r′) at the double grids
(DGs) are evaluated through numerical interpolations of
the original coarse grids (CGs) to save the computer re-
In the next paragraph, a concise explanation
sources.
is provided for the DG method applied to the response
function of the Ar atom.

Hereafter, it is assumed that the origin of the position
vectors is set at the atomic center. Since χ0(r, r′) as
a function of r has a cylindrical symmetry around the
axis Z being oriented to the vector r′, the original data
χ0(r, r′) at CGs, which serve to evaluate the response
function at DGs, can be reduced to three-dimensional
χ0 without losing the information contents. Explic-
data
χ0 has the three ar-
itly, the reference response function
guments, thus
χ0(d; Y, Z), where d represents the length
e
of the vector r′, and the coordinates (Y, Z) specify the
position r on the plane which includes r and the axis Z.
We, thus evaluate
χ0(d; Y, Z) beforehand at CGs with
the grid width h given in subsection III A. The DGs are
then placed within each CG at the interval of h/NDG
along each axis (1 ≤ NDG ≤ 4, NDG ∈ Z). Let ri
and rj be the position vectors of the DGs with indices i
and j, respectively, the corresponding response function
χ0(ri, rj) is to be obtained through the following proce-
dure. Based on the above discussion, the six-dimensional
coordinate (ri, rj) can be readily cast into the reduced
variables (d; Y, Z), thus

e

e

e

d = |rj|
Y = |ri| sin θ
Z = |ri| cos θ




(B1)



where θ represents the angle between the vectors ri and
ri·rj
rj, and deﬁned by cos θ =
|ri|·|rj| . We note that the
indices i and j in Eq. (B1) are interchangeable because
of the symmetry of the function χ0(ri, rj). In this work,
the response function χ0(ri, rj) between the coordinates
ri and rj at the DGs is evaluated through the 4th-order
χ0(d; Y, Z) de-
polynomial interpolation of the function
ﬁned at CGs. The DGs are placed within the CGs of
which distances from the atomic core are less than 5.0
a.u. The numerical detail of the interpolation is pre-
sented in Ref. 24.

e

In Fig. 8 the diagonal elements of the response func-
tions χe
0(ǫ, ǫ′) as functions of the index for the discrete en-
ergy coordinate ǫ are presented for the various NDG. It is
seen in the ﬁgure that all the graphs are characterized by
two distinct peaks although they diﬀer slightly each other
due to the diﬀerence in the width of the DG. It is also
recognized that the graphs reasonably converge as the
grid interval decreases, which shows that the calculation
with NDG = 4 oﬀers the smallest grid error among the
plots as expected. We subtract the result for NDG = 4
from that for other NDG to estimate the eﬀect of the
grid width on the response function. Since the result for

14

NDG = 1 is equivalent in principle to the calculation done
in the main text, the graph ‘NDG(1) − NDG(4)’ approx-
0(ǫ, ǫ′)
imately exhibits the grid error in representing χe
in the present work. The three horizontal broken lines
in the ﬁgure approximately show maximum values of the
plots shown in Figs. 2(b), (c), and (d). It is observed that
the grid error is comparable or even larger in magnitude
than the response functions with g2 and g3. Therefore,
the high-frequency modes γi in the response function are
seriously contaminated by artifacts due to the grid errors.
These contributions should be excluded from the summa-
tion of Eq. (45) because the contamination is erroneously
ampliﬁed by the multiplication of g−1
. Seemingly, it is
quite diﬃcult to extract the grid errors from the eigen-
vectors. One might consider that the DG method will
alleviate the problem. We found, however, that the in-
troduction of the DGs destroys unfortunately the crucial
condition that χe
0(ǫ, ǫ′) is positive semi deﬁnite. This
problem could be attributed to the error in the polyno-
mial interpolation utilized in the DG method.

i

0.06

2
!

.

u
.
a
/
n
o
i
t
c
n
u
F
e
s
n
o
p
s
e
R

0.04

0.02

0

0

N

N

N

N

DG = 1
DG = 2
DG = 3
DG = 4

N

N

N

DG (1) !N
DG (2) !N
DG (3) !N

DG (4)
DG (4)
DG (4)

10

20
5
Index for Energy Coordinate

15

25

′
e
0(ǫ, ǫ

FIG. 8. The diagonal elements of the linear-response function
χ
) for the pseudo Ar atom as functions of the grid in-
dex for the energy coordinate ǫ. The real lines are the plots
for the calculations with NDG. The plots with the broken
lines are the results for NDG = 1, 2, and 3 subtracted by
that for NDG = 4. The three horizontal broken lines repre-
sent the values, 0.04, 0.004, and 0.0005, which are approxi-
mately the maximum values of the component response func-
tions giγi(ǫ)γi(ǫ′) with the eigenvalues g1, g2, and g3 shown
in Figs. 2(b), (c), and (d), respectively.

Although the truncation in the expansion of Eq. (44)
within a few terms would not seriously aﬀect the accu-
racy of the kinetic energy, it is desirable to make some
devices in the future work to alleviate the problem. First,
some approximate method should be developed to esti-
mate the error in the response function in terms of the
grid size in the real-space cell, which will oﬀer a method
of rational truncations. Second, a new numerical device
for the DG approach should be made to maintain the
positive semi deﬁniteness in the construction of the ma-
trix χe
0(ǫ, ǫ′). These subjects will be addressed in the
forthcoming issues.

 
 
 
[1] R. G. Parr and W. Yang, Density-functional theory of
atoms and molecules (Oxford university press, New York,
1989).

[2] R. M. Martin, Electronic Structure, Basic Theory and
Practical Methods (Cambridge University Press, Cam-
bridge, 2004).

[3] E. Engel and R. M. Dreizler, Theoretical and Mathemat-
ical Physics, Density Functional Theory (Springer, Hei-
delberg, 2011).

[4] M. Levy, Universal variational functionals of electron
densities, ﬁrst-order density matrices, and natural spin-
orbitals and solution of the v-representability problem,
Proc. Natl. Acad. Sci, USA 76, 6062 (1979).

[5] W. Kohn and L. J. Sham, Self-consistent equations in-
cluding exchange and correlation eﬀects, Phys. Rev. 140,
A1133 (1965).

[6] T. A. Wesolowski and Y. A. Wang, eds., Recent Progress
in Orbital: Free Density Functional Theory (Recent Ad-
vances in Computational Chemistry) (World Scientiﬁc,
Singapore, 2013).

[7] L. H. Thomas, The calculation of atomic ﬁelds, Proc.

Camb. Phil. Soc. 23, 541 (1927).

[8] E. Fermi, A statistical method for the determination
of some atomic properties and the application of this
method to the theory of the periodic system of elements,
Z. Phys. 48, 73 (1928).

[9] C. F. von Weizsacker, Zur theorie dier kernmassen, Z.

Phys. 96, 431 (1935).

[10] Y. A. Wang and E. A. Carter, Chapter 5 in Theoret-
ical Methods in Condensed Phase Chemistry (Progress
in Theoretical Chemistry and Physics), edited by S. D.
Schwartz, Vol. 5 (Kluwer, Dordrecht, 2000).

[11] K. Yonei and Y. Tomishima, On the weizsacker correction
to the thomas-fermi theory of atoms, J. Phys. Soc. Jpn.
20, 1051 (1965).

[12] E. Chac´on, J. E. Alvarellos, and P. Tarazona, Nonlocal
kinetic energy functional for nonhomogeneous electron
systems, Phys. Rev. B 32, 7868 (1985).

[13] L.-W. Wang and M. P. Teter, Kinetic-energy functional

of the electron density, Phys. Rev. B 45, 13196 (1992).

[14] Y. A. Wang, N. Govind, and E. A. Carter, Orbital-free
kinetic-energy functionals for the nearly free electron gas,
Phys. Rev. B 58, 13465 (1998).

[15] Y. A. Wang, N. Govind, and E. A. Carter, Orbital-
free kinetic-energy density functionals with a density-
dependent kernel, Phys. Rev. B 60, 350 (1999).

[16] C. Huang and E. A. Carter, Nonlocal orbital-free
for semiconductors,

kinetic energy density functional
Phys. Rev. B 81, 1 (2010).

[17] H. Takahashi, Density-functional theory based on the
electron distribution on the energy coordinate, J. Phys.
B: At. Mol. Opt. Phys. 51, 055102(11pp) (2018).

[18] P. Hohenberg and W. Kohn, Inhomogeneous electron gas,

Phys. Rev. 136, B864 (1964).

[19] H. Takahashi, Development of static correlation func-
tional using electron distribution on the energy coordi-
nate, J. Phys. B: At. Mol. Opt. Phys. 53, 245101(9pp)
(2020).

[20] J. Lindhard, On the properties of a gas of charged par-

15

ticles, Kgl. Danske Videnskab. Selskab Mat.-fys. Medd.
28 (1954).

[21] R. G. Parr and A. Berk, The bare-nuclear potential
as harbinger for the electron density in a molecule, in
Chemical Applications of Atomic and Molecular Electro-
static Potentials, edited by P. Politzer and D. G. Truhlar
(Plenum Press, 1981) pp. 51–62.

[22] N. Matubayasi and M. Nakahara, Theory of solutions in
the energy representation. iii. treatment of the molecular
ﬂexibility, J. Chem. Phys. 119, 9686 (2003).

[23] H. Takahashi, T. Hori, T. Wakabayashi, and T. Nitta,
A density functional study for hydrogen bond energy by
employing real space grids, Chem. Lett. 3, 222 (2000).

[24] H. Takahashi, T. Hori, T. Wakabayashi, and T. Nitta,
Real Space Ab Initio Molecular Dynamics Simulations for
the Reactions of OH Radical/OH Anion with Formalde-
hyde, J. Phys. Chem. A 105, 4351 (2001).

[25] H. Takahashi, T. Hori, H. Hashimoto, and T. Nitta, A
hybrid qm/mm method employing real space grids for
qm water in the tip4p water solvents, J. Comp. Chem.
22, 1252 (2001).

[26] H. Takahashi, N. Matubayasi, M. Nakahara, and
T. Nitta, A quantum chemical approach to the free en-
ergy calculations in condensed systems: The qm/mm
method combined with the theory of energy represen-
tation, J. Chem. Phys. 121, 3989 (2004).

[28] H. Takahashi,

[27] H. Takahashi, D. Suzuoka, S. Sakuraba, and A. Morita,
Role of the Photosystem II as an Environment in the
Oxidation Free Energy of the Mn Cluster from S 1 to S
2, J. Phys. Chem. B 123, 7081 (2019).
S.
Large-Scale Parallel
Fock
Using
Journal of Chemical Information and Modeling 60, 1376 (2020).

and A. Morita,
of Hartree-
on Real-Space Grids
Transform,

Sakuraba,
Implementation

3D-Parallel

Exchange

Fourier

Energy

Fast

[29] J. R. Chelikowsky, N. Troullier, K. Wu, and Y. Saad,
High-order ﬁnite-diﬀerence pseudopotential method: an
application to diatomic molecules, Phys. Rev. B 50,
11355 (1994).

[30] J. R. Chelikowsky, N. Troullier, and Y. Saad, Finite-
diﬀerence pseudopotential method: electronic structure
calculations without a basis, Phys. Rev. Lett. 72, 1240
(1994).

[31] A. D. Becke, Density-functional exchange-energy approx-
imation with correct asymptotic behavior, Phys. Rev. A
38, 3098 (1988).

[32] C. Lee, W. Yang, and R. G. Parr, Development of
the Colle-Salvetti correlation-energy formula into a func-
tional of the electron density, Phys. Rev. B 37, 785
(1988).

[33] G. B. Bachelet, D. R. Hamann, and M. Schluter, Pseu-
dopotentials that work: from H to Pu, Phys. Rev. B 26,
4199 (1982).

[34] T. Ono and K. Hirose, Timesaving double-grid method
for real-space electronic-structure calculations, Phys.
Rev. Lett. 82, 5016 (1999).

[35] A. J. Thakkar, Comparison of kinetic-energy density

functionals, Phys. Rev. A 46, 6920 (1992).

