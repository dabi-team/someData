Draft version November 2, 2018
Preprint typeset using LATEX style AASTeX6 v. 1.0

8
1
0
2

t
c
O
1
3

]

M

I
.
h
p
-
o
r
t
s
a
[

1
v
4
5
1
0
0
.
1
1
8
1
:
v
i
X
r
a

AGN VARIABILITY ANALYSIS HANDBOOK

Jackeline Moreno1,2, Michael S. Vogeley1, Gordon T. Richards1
1Drexel University, 3141 Chestnut Ave, Philadelphia, Pennsylvania 19104, USA
2 LSSTC Data Science Fellowship Program Fellow
(Dated: Submitted; Received 2018 Oct 30)

ABSTRACT

This work develops application techniques for stochastic modelling of Active Galactic Nuclei (AGN)
variability as a probe of accretion disk physics. Stochastic models, speciﬁcally Continuous Auto-
Regressive Moving Average (CARMA) models, characterize lightcurves by estimating delay timescales
that describe movements away from and toward equilibrium (mean ﬂux) as well as an amplitude and
frequency of intrinsic perturbations to the AGN ﬂux. We begin this tutorial by reviewing discrete auto-
regressive (AR) and moving-average (MA) processes, we bridge these components to their continuous
analogs, and lastly we investigate the signiﬁcance of timescales from direct stochastic modelling of a
lightcurve projected in power spectrum (PSD) and structure function (SF) space. We determine that
higher order CARMA models, for example the Damped Harmonic Oscillator (DHO or CARMA(2,1))
are more sensitive to deviations from a single-slope power-law description of AGN variability; unlike
Damped Random Walks (DRW or CAR(1)) where the PSD slope is ﬁxed, the DHO slope is not.
Higher complexity stochastic models than the DRW capture additional covariance in data and output
additional characteristic timescales that probe the driving mechanisms of variability.

1. INTRODUCTION

This work reviews the traditional statistical toolkit
for time series analysis of active galactic nuclei (AGN)
variability with an emphasis on stochastic modelling.
We aim to provide a practical understanding of simple
stochastic models such as damped random walks (DRW)
and (perturbation-driven) damped harmonic oscillators
(DHO). Stochastic models are applied widely to eco-
nomic and engineering data, but their interaction with
gappy astronomical data is still in its relative infancy.
The goal of this work is to provide an accessible de-
scription of a family of stochastic models known as auto-
regressive moving-average (ARMA) models, speciﬁcally
for the beneﬁt of early career researchers or more expe-
rienced researchers interested in learning to apply these
methods to astrophysical data. Included is discussion of
ARMA models both in their discrete form and (more
importantly to astronomers) in their continuous form
(CARMA). We discuss why CARMA models of higher
order than the DRW (such as the DHO) may be use-
ful and appropriate, and also when the data do not jus-
tify such models. For more details on the topics dis-
cussed herein we refer the reader to Pandit & Wu (1975),
Granger & Morris (1976), Mills (2012), Box et al. (2015),
Kelly et al. (2014), Kasliwal et al. (2017), Feigelson et al.
(2018).

Early science investigations of AGN variability em-
ployed simple stochastic models to characterize changes

in X-ray brightness (milli-second to month timescales)
(Uttley et al. 2002, Vaughan et al. 2003, Uttley et al.
2005, McHardy et al. 2006). A beneﬁt of investigat-
ing variability in the optical
is to expand the popu-
lation of AGN beyond small-areas or limited to X-ray
bright sources (which tend to be biased towards rela-
tively low-luminosity and low-redshift). A broader goal
of the community is to understand if variability is ca-
sually connected from the inner X-ray corona to the
outer UV/optical/infrared/radio-emitting annuli of the
disk (Pringle 1981, Kubota & Done 2018).

Optical variability of AGN is observed in the range of
roughly 3–50% with the median value on the order of
20% (Sesar et al. 2007, MacLeod et al. 2008). Interest in
expanding the statistical toolkit to read information en-
coded in a stochastic lightcurve is motivated by a desire
to learn about the physical mechanisms generating en-
ergy over a large range of observed timescales. Measures
of variability characteristics potentially relate to the di-
versity of Spectral Energy Distributions (SED) of AGN
and may improve our understanding of black hole mass,
fueling, and spin in addition to accretion disk geometries
(Krawczyk et al. 2013, Richards et al. 2006, Ni et al.
2018, Sartori et al. 2018).

This paper introduces ARMA models as building
blocks with an emphasis on visualizing the reconstruction
of lightcurve shapes (Sections 2-4). We build a bridge
from discrete to continuous ARMA models to facilitate

 
 
 
 
 
 
2

interpretation of the continuous model parameter space
where subregions reveal diﬀerent dynamics (or shapes) of
lightcurves (Section 5). Section 6 and 7 delve into deeper
explanations of CARMA diﬀerential equations necessary
for navigating the parameter space to conduct an ensem-
ble study of AGN variability. The remaining sections
review more traditional analyses including autocorrela-
tion, structure functions, spectral analysis, and impulse-
response functions—all in relation to CARMA models.
Speciﬁcally, we emphasize the connections between these
methods and oﬀer pitfall discussions based on modelling
real astrophysical data (Moreno et al. 2019 in prep).
This handbook is meant to advance the application of
stochastic models to astrophysical data and to contextu-
alize such methods with more traditional analyses used
to study AGN and stars in the time domain.

2. AUTO REGRESSION

An auto-regressive (AR) process describes a system
whose future value can be predicted given a measure of
its current state. That is, AR is a form of forecasting.
In a typical linear regression (y = mx + b) we predict
the value of a dependent variable (y) based on the value
of the independent variable (x).
In an auto-regressive
process we instead predict the future value of the system
based on the past value (or values) of the system itself.
Thus the dependent and independent variables are the
same, for example:

xi = µ + φ1xi−1 + (cid:15)i,

(1)

where φ1 is the auto-regressive or “lag” coeﬃcient that
indicates how closely tied future values are to past values
and where (cid:15)i represents a source of noise.

Equation 1 is a ﬁrst-order or “AR(1)” model where
the current state of the system is linearly dependent on
the immediately prior state plus a random perturbation
(cid:15)i (conventionally drawn from a Gaussian distribution).
These random perturbations are not external to the sys-
tem like measurement error; (cid:15)i represents a true pertur-
bation mechanism intrinsic to the system. A special case
of an AR(1) process, known as a “random walk”, has
φ1 = 1 with (cid:15)i represented by “white noise” (see § 10). A
random walk process is illustrated in Figure 1 where we
show both the white noise impulses (the “shock train”)
and the resulting state of the system, xi, at each time
step.

Since the current state of the system depends on the
previous state, it is possible for xi to grow beyond the
amplitude of the shocks themselves if there are a number
of consecutive shocks with the same sign. This is true
not just for the random walk shown in Figure 1, but
generically for an AR(1) process with φ1 > 1 (or for
φ1 < −1). Note that the change in a random walk is
equivalent to white noise: xi − xi−1 = (cid:15)i.

Figure 1. Illustration of a random walk in the context of
an AR(1) model. White noise disturbances (represented
by the gold lines) are shown as a train of shocks that
randomly change the state of the system (solid purple).
Random walks driven by white noise are the simplest
stochastic model and are a special case of AR(1) mod-
els. Note that the amplitude of the system can grow
arbitrarily large given enough time.

The state of a generic AR system, xi, is easier to under-
stand by visualizing the evolution forward in time after a
single shock. The left panel of Figure 2 presents examples
of a ﬁrst-order AR processes for a range of coeﬃcients,
φ1 (Equation 1). The lag coeﬃcient simply interpolates
from one state (data point) to the next by acting as the
slope between adjacent time step pairs. First order AR
models have dynamics that encompass three domains:
(1) φ1 < 0 results in a decaying sawtooth, (2) 0 < φ1 < 1
results in fast to gradual decay, and (3) φ1 > 1 leads to
unbounded growth.

The general notation for a pth-order AR process is
p
(cid:88)

xi = µ +

φpxi−p + (cid:15)i.

(2)

1

For example,
in an AR(p = 2) process, the state of
the system depends on two lag terms (and thus has two
timescales):

xi = µ + φ1xi−1 + φ2xi−2 + (cid:15)i.

(3)

The response to a single impulse in such a system is
shown in the right panel of Figure 2. In this example,
the ﬁrst lag coeﬃcient is held constant, while the second
lag term is varied. We highlight three types of dynamics
in parallel with the ﬁrst order models in the left panel of
Fig. 2. When φ2 → 0 (and φ1 necessarily becomes rela-
tively more signiﬁcant than φ2) the lag response reverts

3

Figure 2. Response of an AR system to a single impulse (gold) for a range of lag coeﬃcients, φi. (Left:) An AR(1) with
a single unit impulse (shown as triangle for visibility) at time step 4. φ1 > 1 leads to a runaway, while −1 < φ1 < 1
reverts to the mean, the speed of which depends on the magnitude of φ1. (Right:) As with the left panel except for
a second-order, AR(2), process. If both φi values are positive, then the system runs away (no matter how small the
coeﬃcients). φ1 > 0 is permitted if φ2 < 0, resulting in decaying oscillatory motion.

to the purple, gradually decaying curves of the AR(1)
process on the left panel. Negative values of the second
lag coeﬃcient, φ2 < 0, result in decaying oscillatory mo-
tion. Finally, positive values of the second lag coeﬃcient,
φ2 > 0, lead again to unbounded growth due to impulse
perturbations.

In AR processes, the lag coeﬃcients provide short-
memory-dependent structure in the form of positive or
negative correlations to the previous state.
Increasing
the order of an AR process is equivalent to increasing
the memory of past events in the system, akin to inertia.
To achieve a long-term dependence requires expanding
the sum to more and more AR terms. Long-term depen-
dence can also be recognized as a drift away from the
mean, implying non-constant (i.e. time-dependent) co-
eﬃcients referred to as “non-stationarity”. A stationary
system in this context is a system for which the mean
does not drift with time. We will return to stationarity
in Section 9.

In the context of this paper, it is important to realize
that the full domain of AR coeﬃcients is not relevant
for AGNs. Appropriate representations of AGN systems
exhibit stability such that they return to the mean and
have continuous analogs, which we will discuss in Sec-
tion 5. One of the goals of this paper is to achieve a bet-
ter understanding of the transition from gradual decay
to decaying oscillatory behavior within the AR domain
and how it may be used as a probe of AGN variability.

3. MOVING AVERAGES

In a moving average (MA) process, instead of the fu-
ture value depending on the previous value(s) of the sys-
tem, the future state dependS only on previous shocks to
the system, (cid:15)i, so that

xi = (cid:15)i + θ1(cid:15)i−1.

(4)

In the simplest MA process (order 1 with θ1 (cid:54)= 0), the
system depends not only on the current shock, but also
the previous one. Figure 3 presents the state of an MA
system driven by white noise with θ1 = −1. Unlike Fig-
ure 1, which has the same underlying shock train, the
MA system in Figure 3 is bounded by the size of the
individual shocks.

Since the state of an MA process depends only on pre-
vious shocks and not previous values of the system, the
eﬀects of a shock are more limited in time. Thus the
equivalent of Figure 2 for an MA process would be rather
subtle and not be very interesting. Instead, in Figure 4
we show what happens to the system as a result of in-
creasing the order (for both positive and negative values
of θ). As with AR processes, higher order generic MA(q)
processes are given by

xi =

q
(cid:88)

1

θq(cid:15)i−q + (cid:15)i.

(5)

The eﬀect of coeﬃcients with θq < 0 and θq > 0 are
shown in the left and right panels of Figure 4, respec-
tively. MA models are intrinsically shorter-term than
AR but they also characterize correlation structure of a
diﬀerent ﬂavor.

4

Figure 3. A moving average process. The same train
of white noise impulses (gold) used to generate the ran-
dom walk in Figure 1 and a resulting moving average
(θ1 = −1; blue line) process are over-plotted. The MA
coeﬃcient determines the amplitude and delay between
perturbations. The MA process is bounded by the am-
plitude of the individual shocks (unlike AR processes).

When θq < 0 each shock is included in the next time
step with the opposite sign, making the model highly er-
ratic (high frequency). On the other hand, when θq > 0
the result of each shock is more persistent—even more so
when the order is increased as can be seen going from the
upper to the middle panel on the right-hand side of Fig-
ure 4. The number and magnitude of MA terms in the
model determines the amplitude and delay between per-
turbations. Thus, the MA coeﬃcients determine whether
the process xi is highly erratic or rather quiet by mod-
ulating the delay between perturbations, so MA coeﬃ-
cients are sometimes said to act as noise ﬁlters.

While white noise exhibits an equal distribution of
power across all frequencies, MA reprocessing of white
noise input can transfer power to higher (or lower)
frequencies—despite the input and output processes hav-
ing equal means and standard deviations. The standard
deviation cannot distinguish whether higher amplitude
deviations happen at low frequency or high frequency.
This information is exactly what the MA process de-
scribes and it can be leveraged to help reconstruct a
lightcurve shape more accurately.

MA coeﬃcients encode frequency domain information
that is traditionally obtained from a power spectrum.
Thus, the diﬀerences between negative and positive val-
ues of θ are better illustrated in frequency domain (in
terms of correlated or “colored” noise) than in the time
domain as shown in the bottom panel of Figure 4. The

slope and steepness of the power spectral density (PSD)
of a stochastic process manifests as the “smoothness” of
a noisy process. When θ1 < 0, large amplitude per-
turbations are closely concentrated together in time (at
high frequency). When θ1 > 0 the opposite eﬀect results
in high amplitude perturbations spread out across lower
frequencies. MA processes with positive and negative
valued θi are contrasted in the top two rows of Figure
4. The diﬀerences are more apparent in the frequency
domain, however it it useful to recognize the signature of
this type of correlation in the time domain. In Section 10,
we will ﬁnd that, in the context of AGN variability, we
are highly interested in applications of MA processes that
produce excess power at higher frequencies, i.e. “blue”
noise as shown in the left panels of Figure 4.

While MA processes are intrinsically short-term, we
note that it is possible to rewrite a ﬁrst order auto-
regressive model as a moving average process with in-
ﬁnite terms: AR(1) = MA(∞) with all positive θi (Box
and Jenkins 1970). However, in practice, an MA model of
a ﬁnite number of terms cannot exactly replicate an AR
process. Together AR and MA processes can be thought
of as building blocks of more complex processes. In the
next section, we summarize mixed processes called auto-
regressive moving-average or ARMA processes (Box et al.
2015). Understanding the dynamics that these diﬀerent
building blocks describe will help with model application
to astrophysical data and interpretation of coeﬃcients.

4. MIXED MODELS: ARMA

In this section, we explore how AR and MA compo-
nents in discrete “mixed” ARMA models can be used
to characterize the shape and statistical complexity of
a stochastic time series—such as an AGN light curve.
ARMA models combine short-memory AR responses and
MA inputs that govern the “amplitude” of random per-
turbations at diﬀerent timescales. Together AR and MA
parameters reconstruct correlation structure and the de-
gree of smoothness in noisy processes. In discrete ARMA
models each index in the series evolves the process for-
ward by a constant time step.
In continuous models
(next section), the relative signiﬁcance between coeﬃ-
cients interpolates behavior in sparse and gappy time-
series data. Familiarity with discrete models provides an
intuition for the complexity of continuous models which
are more practical for “survey-quality” data like the Large
Synoptic Survey Telescope (LSST; Ivezi´c et al. 2008) will
provide.

Both AR and MA models can be used separately (or
together) to describe stochastic processes. For example
AR is a good description of day-to-day stock prices while
MA is a good description of intraday stock prices. How-
ever, both in the case of stock prices and the AGNs in
our analysis, when combining the models (ARMA anal-

5

Figure 4. Moving Average models of diﬀerent orders. Left: MA processes with all negative coeﬃcients, θi < 0. Right:
MA processes with the same amplitude as in the left panels, but with all positive MA coeﬃcients, θi > 0. All MA
processes are generated with the same (white noise) shock train. Bottom: Power spectral density (PSD; see § 10) of the
input white noise spectrum (grey line) and for θi < 0 (blue) and θi > 0 (red). MA processes with θi < 0 exhibit a “blue”
noise spectrum (more power at higher frequencies), while for θi > 0 power is transferred to low frequencies resulting
in a “red” power spectrum. The number and magnitude of MA coeﬃcients in a model determines the amplitude and
the frequency of disturbances.

ysis) it is useful to think of the MA model as the input
to the AR model.

Thus an AR(1) model describes a system with Brown-
ian motion (random walk) character and a decay channel
responsible for dissipating energy, while an MA process
describes the energy inputs. The convolution of these two
components is an ARMA(1,0) process (Figure 5, left),
where the (cid:15)i term is now represented as an MA(0) pro-
cess.

The next order mixed model arises from the convolu-
tion of an MA(1) process kicking the system and a sec-
ond order AR response channel, ARMA(2,1), (Figure 5,
right), expressed as

xi = µ + φ1xi−1 + φ2xi−2 + θ(cid:15)i−1 + (cid:15)i.

(6)

With only a single lag term (p=1, thus φ2 = 0), an AR(1)
model can only characterize the dissipation rate of im-
pulse perturbations back towards the mean state. With
two lag terms, an AR(2) model can additionally charac-
terize delays as the process moves away from the mean
state. The green curve in the bottom panel of Figure
5 (right) exhibits more correlated structure in the form

of asymmetric peaks and troughs. Thus, input and re-
sponse components are the building blocks of more com-
plex stochastic processes.

If considering higher-order models for astrophysical ap-
plications, it is important to realize that q < p is a con-
dition of stationarity for continuous processes. When we
explore continuous models (next section), we will relate
ARMA parameters to characteristic timescales of vari-
ability in the continuous space.

5. ARMA TO CARMA BRIDGE

5.1. Going From Discrete to Continuous

Although the AGN light curves that we wish to study
may be driven by (intrinsically) continuous processes, we
could in principle perform our analysis using discrete
ARMA processes if the light curves were sampled uni-
formly. However, in practice, light curves are rarely sam-
pled uniformly (due to seasonal and nightly gaps) and,
even when they are, bad data points can disturb an oth-
erwise uniform cadence. In the case of LSST data, we
expect that light curves will have a very non-uniform ca-
dence. Thus, we must treat our systems with the contin-

6

Figure 5. Building blocks of ARMA(1,0) (left) and ARMA(2,1) (right) models. A white noise input (top left) and an
MA(1) input (derived from the same white noise; top right), the response of lag coeﬃcient(s) (middle), and the ﬁnal
stochastic process (bottom panel). Input perturbations to the system are described by MA coeﬃcients (or lack thereof)
and AR lag coeﬃcients describe how the system responds and dissipates energy back to the mean state. Despite having
the same input white noise, the ﬁnal mixed processes (left vs. right) have noticeably diﬀerent characteristics.

uous mathematical analogs of discrete ARMA processes.
To gain insight into the transition from discrete to con-
tinuous analysis, we remind the reader of the derivation
of “e”, which ﬁgures prominently in this transition. For
example, consider the case of compound interest. If we
have a dollar and earn 1% interest per year (r=0.01), we
can write an AR(1) equation to describe the process as

r > 0 we have exponential growth, just as we had with
If r < 0 (com-
φ1 > 1 for a discrete AR(1) process.
pounded bank fees), then we have exponential decay.
Continuous-AR(1) models with r < 0 are better known
as damped random walks (DRW) and are commonly used
models of AGN variability (Kelly et al. 2009, Koz(cid:32)lowski
et al. 2010, MacLeod et al. 2011, Graham et al. 2014).

with

Dt = φ1Dt−1,

φ1 = 1 + r.

If our interest payments are made n times a year instead
of at the end of the year, then we have

φ1 = 1 +

r
n

,

and our ﬁnal account balance will be

Dt=1yr = φn

1 D0.

If our payments are made continuously rather than in
discrete intervals, we then have

r
n
so that after t years, our balance is

φn = lim
n→∞

lim
n→∞

(1 +

)n = er,

Dt = ertD0.

Thus we can see how a discrete AR(1) process can morph
into a continuous process:
in the limit where the time
interval gets very small compared to the observation
length, the process approaches continuous behavior. For

5.2. The Stability Triangle

Thus far we have presented a limited range of ARMA
processes because continuous-ARMA models are only de-
ﬁned in states of equilibrium, which correspond to limited
ranges of coeﬃcients, φ1 and φ2. We illustrate the corre-
spondence between discrete and continuous ARMA(2,1)
models (the most complicated model that we will con-
sider herein), using the stability triangle in Figure 6.
The stability conditions, φ1 + φ2 < 1, φ2 − φ1 < 1 and
−1 < φ2 < 1 bound the triangle (Phadke & Wu 1974).
Regions outside of the triangle are non-stationary and
run away with time. Colored regions inside the triangle
reveal the projection of the CARMA parameter space
that overlaps the discrete space.

Guided by the stability triangle, we now move from
discrete ARMA models (which correlate time lags) to
CARMA models (which extract timescales of highly-
correlated uneven data). A crucial diﬀerence between
discrete and continuous systems involves changing nota-
tion from a diﬀerencing representation, xi−p (as in equa-
tion 2) to a diﬀerential form dpx. Thus, a second order

7

equation of motion, i.e., the solution to the CARMA pro-
cess.

Second-order CARMA roots deﬁne two general do-
mains of behavior: complex roots yield damped quasi-
periodic behavior (Fig 6: below the solid outer parabola,
regions III and IV) and real roots yield decaying behav-
ior (Fig 6: colored region above the solid parabola, re-
gion II). With these roots in hand, Phadke & Wu (1974)
provide a way to visualize how CARMA roots map to
ARMA coeﬃcients with the following correspondence re-
lationships:

φ1 = er1dt + er2dt

φ2 = −e(r1+r2)dt

where r1 and r2 are negative real roots or complex roots,
which deﬁne the system dynamics.

5.3. Interpreting the Stability Triangle

The stability triangle organizes categorical information
about the response (dynamic behavior) of second order
systems, which we unpack by highlighting diﬀerences and
common attributes across four regions. In regions I and
IV (left half of the triangle), the negative φ1 domain
drives a sign ﬂip between even and odd elements in a
time series which creates a sawtooth response. Regions
II and III (right half of the triangle) exhibit monotonic
decay. We expect astrophysical time series to predom-
inantly occupy the right side of stability triangle where
each decay timescale is monotonic (does not change sign).
The complex CARMA roots, r1 and r2, provide
timescales of variability that we can interpret in the sta-
bility triangle context. The real parts of the roots are
negative (inside the triangle) and have units of inverse
time.
In Figure 6, color gradients from dark to light
correspond to decay timescales going from short to long
respectively.

4 φ2

The imaginary parts of the complex roots, Im(ri), de-
ﬁne the frequency of a quasi-periodic oscillation (QPO),
with period is TQP O = 2π/Im(ri). Each parabola,
φ2 = − n
1 (n = 1, 2, 4 shown), traces a line of con-
stant QPO frequency in the projected CARMA space.
Moving up along a parabola, we traverse the color gra-
dient in the ﬁgure, indicating a shorter decay timescale
as we approach the darker end. The QPO frequency
domain is continuous, but we illustrate three parabolas
parameterized by n which can be any positive, real num-
ber. To increase the QPO frequency of a process, we
must increase the magnitude of φ2 relative to φ1 via n
to obtain a narrower parabola. Figure 7 shows examples
of DHO processes in this quasi-periodic regime (the top
2 rows). We show “system response” curves with spec-
iﬁed timescale combinations of TQP O and τdecay in the
left column. Corresponding output lightcurves to each

Figure 6. ARMA(2,1) Stability Triangle: a projection of
CARMA space. Sawtooth decay occurs (inside the trian-
gle) where φ1 and φ2 are both negative. Region I is the
domain above the solid parabola and Region IV is the do-
main under the solid parabola. Monotonic decay occurs
(inside the triangle) where φ1 > 0 and φ2 < 0. Region II
(above the solid parabola) is over-damped and provides
a rise timescale in addition to the decay timescale that is
better known from DRW models (φ1 > 0 and φ2 → 0).
In Region III (under the solid parabola), CARMA roots
are complex, where the imaginary component describes
an average QPO frequency. Narrowing parabolas indi-
cate increasing QPO frequencies. Diamonds sample the
space see Fig10 which we will discuss in Section 8. The
color gradient (under the solid parabola and along the
φ2 = 0 is the DRW subspace) tracks the decay timescale,
increasing from dark to light. We expect AGN to popu-
late Regions II and III.

CARMA process is described by

d2x + α1d1x + α2x = β0(cid:15)(t) + β1d((cid:15)(t)).

(7)

The left-hand side of the equation, with C-AR coeﬃ-
cients, α1 and α2,1 describes the auto-regressive part of
the system. The perturbation terms (i.e., the moving
average part of the system), with coeﬃcients β0, β1, are
now on the right-hand side, indicative of their “driving”
nature, which we explore further in the next section. This
equation has the same diﬀerential form as a wave formula
and is popularly referred to as a damped harmonic oscil-
lator (DHO) model.

Consistent with the standard manner of solving a dif-
ferential equation, we set up the characteristic equation
for the left-hand side as

r2 + α1r + α2 = 0,

(8)

to obtain the roots, r1 and r2. These roots deﬁne the

1 Note that the coeﬃcient of the second-order term is tradition-

ally deﬁned to be unity.

8

Figure 7. DHO processes from the quasi-periodic regime in the top two rows and over-damped regime in the bottom
two rows. Each system response on the left acts on the same exact noise realization to produce the corresponding
stochastic lightcurve on the right. The amplitude of these processes is determined by the perturbation coeﬃcients in
combination with these timescales. Colors map back to the approximate locations of the speciﬁed timescales in the
stability triangle.

response are shown in the right column, using the exact
same noise input for each.

The outer-most parabola borders a special case of crit-
ical/transition behavior (two equal negative-real roots).
Above the critical parabola, two unique negative-real
roots (Region II) characterize over-damped behavior.
Over-damped models are cousins of damped random
walks. They consist of a delay timescale over which per-
turbations grow plus the primary decay timescale τdecay
better known in DRWs. For over-damped models, we will
refer to this additional timescale as the rise timescale,
τrise. When the rise timescale approaches zero we re-
cover the DRW model (φ2 = 0, where the color gradi-
ent from dark to light also indicates short to long decay
timescales). Figure 7 also shows examples of DHO pro-
cesses in the over-damped regimes (bottom two rows).
Again, we show “system response” curves with speciﬁed
timescale combinations of τrise and τdecay in the left col-
umn and corresponding output lightcurves in the right
column. We dive deeper into system response and how it
is used to extract characteristic timescales in Section 8.
We have now connected the correlation described by
discrete AR and MA components (as in Figures 2 and
4) to the timescales provided by continuous models (as

in Figure 7). Increasing the value of φ1 (when φ2 → 0)
corresponds to increasing the DRW decay timescale, i.e.,
less eﬃcient dissipation of energetic perturbations. In-
creasing the magnitude of φ2 relative to φ1 roughly
corresponds to increasing the secondary characteristic
timescale, either as an average QPO periodicity (com-
plex roots) or as a rise timescale (real roots). When the
rise timescale approaches zero we truly have a DRW.

In Sec 7, we expose the mathematics behind the graph-
ical representations of CARMA processes that we have
previewed from the stability triangle in Figure 7. We ex-
pect AGN lightcurves that are well modelled by DRWs
to cluster with very short rise timescales (close to zero
days). Lightcurves that are better modelled by DHOs
should lie in the lower right corner of the stability tri-
angle (in both Regions II and III). Our goal with the
stability triangle is to gain an intuition for navigating
the continuous model parameter space which is a much
broader landscape. It is useful to understand the stability
triangle as a phase diagram, where the simplest behavior
approaches a DRW, more complex behavior appears in
the form of a rise timescale (the over-damped regime),
transition behavior appears as a highly damped QPO,
and ﬁnally a relatively high frequency QPO may be the

signature of a secondary physical process that becomes
dominant.

6. PERTURBATION IN CONTINUOUS SYSTEMS

This section delves into the interaction of determin-
istic (C-AR) and stochastic (C-MA) components in a
CARMA model as we move away from discrete processes.
A stock price inﬂuenced by demand is a discrete process
that changes in time as a result of transactions of selling
and buying. In contrast, the swinging of a pendulum or
an unemployment index do not cease to exist between
measurement intervals, but rather they evolve continu-
ously in time. Continuous systems exhibit responses to
disturbances rather than instantaneous redirection upon
impact; in physical systems this is the property known as
inertia. The latter set of systems are also subject to “con-
tinuous” perturbation mechanisms that drive changes to
the system stochastically rather than deterministically.

Suppose a pendulum is swinging back and forth with
a constant amplitude. We observe small measurement
errors during its harmonic motion about its equilibrium
position. A graph of the measured position as a function
of time remains visibly periodic as in Figure 8 (top). If
the observation errors are large (compared to the ampli-
tude of the periodic component), the underlying periodic
behavior is obscured by “superposed ﬂuctuations”. Now,
consider a pendulum that initially sits at rest in its equi-
librium position when a group of children begin pelting
the pendulum with pebbles. The motion is subject to
a true disturbance (as opposed to measurement error)
and the eﬀect on the graph reﬂects an entirely diﬀerent
character. The graph of the pendulum’s motion remains
intrinsically harmonic but the amplitude and phase vary
continually as illustrated in the bottom panel of Figure 8.
Yule (1927) proposed such a thought experiment to high-
light the eﬀect of a randomly driven system having iner-
tia: the eﬀect is not simply periodicity with superposed
ﬂuctuations but quasi-periodicity.

Yule’s pendulum demonstrates how quasi-periodic (as
opposed to truly periodic) behavior arises from a stochas-
tic process acting on an inertial system.
In Figure 8,
we illustrate the diﬀerence between superposed ﬂuctua-
tions (measurement error) compared to intrinsic pertur-
bation and we recognize that Yule was describing quasi-
periodicity.

In second order CARMA processes (Equation 7), dif-
ferential terms (on the LHS) model viscous forces that
dissipate energy (maintaining equilibrium) and inertia
which similarly resists changes in motion and direction.
The LHS can deterministically describe periodic motion
in the trivial case (RHS = 0). A non-trivial case speci-
ﬁes a driving mechanism for example, pebbles kicking the
pendulum (RHS is stochastic). Quasi-periodic behavior
arises only with the right combination of “viscous” and

9

Figure 8. Superposed ﬂuctuations: a pendulum with
measurement error (top), and a pendulum driven by per-
turbations showing quasi-periodicity (bottom). The ori-
gin of quasi-periodic (as opposed to truly periodic) be-
havior arises from a stochastic process acting on an iner-
tial system.

perturbation parameters.

The DHO model characterizes noise with two pertur-
bation parameters, one that measures amplitude and
another that measures covariance. A continuous white
noise process is generated by a Gaussian distribution
with constant variance for all lengths of the interval dt.
If the variance of the noise process exhibits a rate of
change, as the interval length is varied, the perturba-
tion function has some correlation or covariance. The
rate of change of the variance is captured in the MA
coeﬃcient. A continuous MA process ultimately gov-
erns the variance of the noise-generating process. In the
most complex process that we consider, CARMA(2,1), a
perturbation function with two coeﬃcients β0 and β1 de-
scribes noise drawn from a density of all possible random
values. The larger the ratio of MA coeﬃcients β1
> 1,
β0
the more erratic (bluer) the behavior of the time series.
We summarize the minimum necessary mathematics of
continuous stochastic processes in the next section.

7. CARMA IN A NUTSHELL

The simplest of CARMA models is the damped ran-
dom walk (DRW or CARMA(1,0)). The DRW can be
expressed in diﬀerential form as

d1x + α1x(t) = β0dW (t),

(9)

where α1 is the C-AR coeﬃcient and β0 is the coeﬃcient
of random perturbations. The perturbation function on
the RHS is also redeﬁned using Wiener increments dW
rather than the random variable (cid:15)(t) as in previous equa-
tions, however both notations are equivalent by Ito’s the-
orem (Thomas 1986). The solution to Equation 9 is a
“forecasting equation”, which can be expressed as a so-
called “state space solution”:

x(t + δt) = eα1δtx(t) + β0

(cid:90) δt

0

eα1(δt−s)dWs.

(10)

10

Figure 9. Illustration of damping and perturbation eﬀects. Over-damped models are shown in the top panel and QPO
(under-damped) models are shown in bottom panel. Grey curves feature a white-noise-dominated perturbation process,
β1/β0 < 1, and blue curves features a blue-noise-dominated, β1/β0 > 1, process. The perturbation characteristics of
the mock lightcurves are subtle in the time domain but they become more apparent in frequency space (see section
10.)

Here x(t) represents the current state of the observed
system, α1 = |r1| in the case of a ﬁrst order process, β0
equals the standard deviation of the process, and ﬁnally,
the integral over Wiener increments dW fully describes
the density function of white noise perturbations (Jones
& Vecchia 1993, Brockwell & Davis 2013, Kelly et al.
2014). This model has of two degrees of freedom: a de-
cay or relaxation timescale, τ , and a limiting amplitude
of variability β0. We obtain the decay timescale from the
auto-regressive coeﬃcient τ = − 1
. The amplitude
r1
β0 is coupled to the decay timescale ∝ (cid:112)cτ /2, where
the constant c is analogous to the diﬀusion constant in
an Ornstien-Uhlenbeck (1D-diﬀusion) process (Gillespie
1996). Given that the perturbation function is a white
noise process, β0 takes the role of an “amplitude-like”
parameter when multiplied by the density function. The
density function, is also referred to as a univariate Gaus-
sian, drift-less Wiener process or Ito integral (Gillespie
1996, Kasliwal et al. 2017).

= 1
α1

CARMA(2,1), a second order diﬀerential equation
driven by a continuous MA(1) process, was introduced
in Equation 7; however, it is useful to present it in a

form re-written with a change of variables:

d2x + 2ξω0d1x + ω2

0x = β0dW (t) + β1d(dW (t)).

(11)

The C-AR coeﬃcients are now α1 = 2ξω0 and α2 = ω2
0. ξ
is the damping ratio of the oscillator and ω0 is the natural
QPO frequency. When the damping ratio, ξ, is greater
than 1 (over-damped), the system experiences delays in
the growth of perturbations that drive the state x away
from equilibrium and a delay as the system decays back
to equilibrium.
In this case, the roots r1 and r2 are
negative-real and describe both a rise timescale τ1 = −1
r1
and a decay timescale τ2 = −1
r2
DHO behavior is obtained by setting up a characteris-

.

tic equation and solving for two roots,

x(t+δt) = er1δtx(t)+er2δtx(t)+

(cid:90) δt

0

eA(δt−s)BdWs (12)

The density function of the continuous MA(1) process
now involves the matrices A =
(cid:35)

(cid:34)

−α1 1
−α2 0

and B = [β1, β0]T (Kelly et al. 2014 and references
therein). When parameters are speciﬁed (data is ﬁt-

ted) it deﬁnes a multivariate Gaussian N (0, C) having
a zero mean vector and a disturbance covariance matrix
(C(wi, wj) = Ci,j). We show this notation for full trans-
parency, however, it is easier to think of both β0 and β1
terms as white noise and blue noise terms, respectively,
as discussed previously in Section 3. For more informa-
tion we refer the reader to Jones & Vecchia (1993) and
Kasliwal et al. (2017).

τ +ω0i) and r2 = ( −1

For underdamped systems (ξ < 1), the roots are com-
plex conjugates with r1 = ( −1
τ −ω0i).
(cid:112)1 − ξ2.
The damped oscillator frequency is ωd = ω0
Applying Euler’s formula, the DHO state equation may
be rewritten by expanding the complex exponentials into
sines and cosines, rendering a full real-space solution of
the form:

x(t + δt) = x(t)e

−δt

τ sin(ωdt + φ) + perturbations.

The eﬀect of perturbations on the phase φ of the har-
monic term is to cause “quasi”- periodic behavior. Ex-
amples of a DHO with parameters on each side of criti-
cal damping are shown in Fig 9 (over-damped (top) and
under-damped bottom). A QPO is more apparent in a
light curve when the damping ratio ξ < 0.5. When the
roots are both real, quantities like the damping ratio, ξ,
and ω0 lose their signiﬁcance.

8. IMPULSE RESPONSE

In a similar manner as we did for ARMA processes, we
gain insight into how CARMA processes (and the DHO
model in particular) work by examining how the system
responds to a delta-function impulse. Speciﬁcally how
CARMA processes represent causal time series. Math-
ematically, the impulse response function is a Green’s
function of the diﬀerential equation. This impulse re-
sponse function, which is generally asymmetric in time
(as shown previously in Figure 7), describes how a dis-
turbance to the system at one time propagates into the
future state of the system. Statistical characterization of
the time series using second-order statistics (e.g., PSD’s
and structure functions, which will be discussed later)
neglects this time-ordering—thus losing information that
can be critical to a physical interpretation. The CARMA
description captures not only the statistical properties of
the driving disturbances, but also the characteristic re-
sponse in time to those disturbances. As discussed above
for the DHO model, this approach yields timescales for
the rise and subsequent decay of noise-driven perturba-
tions.

Yule’s pendulum demonstrates how crucial Green’s
functions are to developing our understanding and ap-
plication of CARMA processes. Previously, we exam-
ined this physical example to discuss perturbation and
quasi-periodicity, now we refocus on the motion of the
pendulum itself. The pendulum’s response to a single

11

pulse is the Green’s function G. The actual motion of the
pendulum is the linear superposition of multiple pulse re-
sponses. In the inﬁnitesimal limit, the pendulum would
be perturbed by a continuous spectrum of force pulses,
represented as delta functions δ(t), with the eﬀect on
the pendulum’s state characterized by the same Green’s
function.

The Green’s function of a CARMA(p,q) process can
be derived by describing the RHS of the CARMA diﬀer-
ential equation as a Dirac delta function δ(t),

dpG
dtp + α1

dp−1G
dtp−1 + ... + αpG = δ(t).

(13)

The order, p, of the diﬀerential equation describing the
CARMA process dictates the complexity of the impulse-
response of the system, which is given by

G(t) = Σp

kckerkt.

(14)

Here the constants, ck, for 1 (cid:54) k (cid:54) p are deﬁned by a
matrix involving the roots of the process discussed in the
previous section,

(cid:34)

r1 r2
1
1

(cid:35) (cid:34)

c1
c2

(cid:35)

=

(cid:35)

(cid:34)
1

0

.

(15)

This matrix is essentially a summary of boundary condi-
tions for p = 2 derivatives of the CARMA process. The
interested reader is referred to Appendix B of Kasliwal
et al. (2017) for the general form of the matrix. The
boundary conditions for a second order process allow us
to solve for the DHO Green’s function. Thus, we expand
the sum in Equation 14 and solve the for coeﬃcients c1
and c2 to obtain

G(t) =

er1t − er2t
r1 − r2

,

(16)

where r1 and r2 are again the roots of the characteristic
equation.

The shape of the DHO’s Green’s function has a diﬀer-
ent interpretation for the two regimes of behavior that
were discussed in the ARMA triangle (Figure 7). When
the roots of a DHO are complex conjugates (left panel),
G(t) reduces to

G(t) =

1
ωd

−1

τ tsin(ωdt)

e

(cid:112)1 − ξ2.
where the damped natural frequency is ωd = ω0
In this case, the Green’s function contains a harmonic
term as illustrated in Figure 10 (left). A lightcurve
with such a Green’s Function exhibits multiple peaks
and troughs of variable width. In the over-damped case
(right panel), the system’s viscous forces are highly ef-
ﬁcient and they contribute a delayed response to per-
turbations. Since the time delay describes the growth
of perturbations (how the lightcurve moves away from

12

Figure 10. QPO response (left) and over-damped response (right). Each curve on the left panel is the response of a
process sampled from the diamonds in the stability triangle (Figure 6). In the QPO-response, the frequency is set to a
constant and the decay timescale τdecay is increased from dark to light tones. In the case of the over-damped response,
the decay timescale is held constant and the rise timescale is increased from dark to lighter tones. For both responses,
darker tones are closer to DRWs

the mean) we refer to it as the rise timescale. Fig-
ure 10 (right) shows that as rise timescales approach zero,
the DHO model becomes degenerate with the DRW re-
sponse GDRW (t) = er1t. This means that a lightcurve
with a 5 day rise timescale is closer to a DRW than a
lightcurve with a rise timescale of 50 days. The PSD
of such lightcurves (with relatively short rise timescales),
would be characterized by high frequency deviations from
the DRW slope (ν−2) but we would be unable to inter-
pret exactly how the drop or excess in power manifests
in the time domain (further discussion in Section 10).

9. AUTO-CORRELATION

9.1. The ACVF

Related to Green’s Functions (and PSDs and structure
functions) are auto-covariance (ACVF) functions, which
are fundamental to an astromoner’s time-series tool kit.
The sample auto-covariance of a time series is

structure.

9.2. The ACVF of the DRW and DHO

The auto-regressive parameters of the DRW and DHO
may be used to estimate an analytic ACVF. In Figure 11,
we show the graphical representations of the analytic
ACVF of a DRW and multiple DHOs with varying roots.
The ACVF of a DRW is

ACV FDRW (∆t) = σ2

processe

−∆t

τ = β2

0 er1∆t

(18)

Normalizing the ACVF by the variance produces a
related function, the auto-correlation function (ACF),
which oﬀers another characterization of the data:

ACFDRW (∆t) = er1∆t.

(19)

The ACVF of the DHO or CARMA(2,1) model is in-

stead

ACV FDHO(∆t) = C0

(cid:18)

C1er1∆t + C2er2∆t

(cid:19)

(20)

ACV F (∆t) =

1
n

n−j
(cid:88)

i=1,j=0

(xi−j − x)(xi − x)

(17)

with weights (given two unique real roots or a complex
conjugate pair 2),

where xi−j is the state at a time lag ∆t, and the value
of the ACVF at lag ∆t = 0 (where i = j) is equivalent
to the variance of the data. For all ∆t > 0, we get
the averaged covariance or correlation of binned pairs of
points separated by time lags of increasing length.

The auto-covariance (ACVF) function of a time series
with itself gives a measure of the correlation strength of
an evolving process with its own ﬂuctuation history as a
function of time lag. The correlation strength shown by
the ACVF is a very informative guide for model selection.
In the case of stochastic or noisy data, the ACVF informs
our model building or prediction algorithms by revealing
if there is any persistent time dependence or correlation

C0 = −

β1

2(r2 − r1)(r∗

2 + r1)

C1 =

C2 =

r1
(cid:60)(r1)
r2
(cid:60)(r2)

(β0 − β1r1),

(β0 − β1r2).

The ACVF of a CARMA process described in Eq 20 has
a very similar mathematical form to the Green’s function
shown in Eq. 14. It is either a weighted sum of exponen-
tials (for real roots) or a weighted sum of exponentially

2 The symbol ∗ is the complex conjugate and (cid:60)(ri) is the real

part of the complex value.

damped harmonics (for complex roots); see Kelly et al.
(2014) for the generic ACVF formula.

The ACVF does not capture the same time-ordered
information as the Green’s function since it is a function
of time lag not time; however, its advantage is that it
takes into account the perturbation terms, β0 and β1.
We can think of Green’s functions as tools providing a
system of solutions ﬁtted to boundary conditions. The
ACVF, as speciﬁced by the roots (or eigen values) of both
the LHS and the RHS of a CARMA diﬀerential equation
is a unique solution. The ACVF can therefore be used
to approximate a CARMA process since it accounts for
C-AR and C-MA parameters (see Foreman-Mackey et al.
(2017) for an alternate form of the DHO ACVF). Note
that there are two representations of C-MA coeﬃcients
in the astronomical literature: one notation is expressed
in units of the standard deviation σ (σ is factored out of
the RHS) therefore βq = 1 is ﬁxed (Kelly et al. 2014),
and in the other notation the standard deviation is not
factored out and is therefore equal to the highest C-MA
coeﬃcient βq = σ (Kasliwal et al. 2017). We use the
latter representation in all our equations involving β0 and
β1.

9.3. Non-stationarity, Noise and Sampling Eﬀects

The deﬁnition of the ACVF implicitly requires that
the time series have a constant mean and variance for the
shape of the ACF or ACVF to be meaningful. In statisti-
cal literature, this combination of properties is referred to
as a “stationary” process: any segment of the light curve
looks (statistically) identical to any other segment of the
same length. A strong indicator of non-stationarity is if
the ACF of the process does not decay. We might also
observe a steep linear trend or runaway as examples of
non-stationary behavior.
In astrophysical applications,
our systems can be treated as approximately stationary
through the appropriate choice of a window function in
It is important for astronomers to confront the
time.
fact that non-stationarity aﬀects all second order statis-
tics like PSDs, structure functions, and CARMA mod-
els. The variability statistics of non-stationary or short
lightcurves (relative to intrinsically long timescales) may
still be eﬀective for classiﬁcation since they will operate
as indicators of non-stationarity (for more relevant em-
pirical work regarding length systematics see Koz(cid:32)lowski
2017b).

Measurement noise can also aﬀect the estimate of the
lightcurve variance and the resolution of the true ampli-
tude of variability. Since the amplitude can be smaller
at shorter time lags, a large noise ﬂoor can obscure true
variability as diagrammed in Figure 11. If the measure-
ment error is large, the choice of model would necessarily
be simpler because the data does not resolve higher or-
der structure. For example, a DHO simulated with large

13

Figure 11. The analytic ACF of a DRW (dashed pur-
ple) and DHO with relaxed damping ξ from over-damped
(dark, solid) to under-damped (light, solid). Higher or-
der correlation structure may be obscured in the error
ﬂoor (gray band), thus we potentially lose the ability to
resolve a rise timescale and the data would show satis-
factory agreement with a DRW model. If the model ap-
propriately represents the data, then the analytic curves
should follow the ACF of the data, thus the ACF and
ACVF are excellent diagnostics for model selection.

Figure 12.
Sample ACF of a DHO mock lightcurve
observed-like LSST-WFD (in orange) and LSST-DDF
cadences (in blue). The dashed lines in black show how
well the “true” DHO model follows correlation measured
by the sample ACF at short lags. Both ACFs are com-
puted with the same binning, however the DDF cadence
ACF has better agreement with the true ACF. The ini-
tial drop in the WFD and DDF ACFs are due to 6 month
observability gaps.

errors may appear like a DRW as shown by the ACFs in
Figure 11: the same correlation is well described by mul-
tiple models, yet they all diverge below the noise ﬂoor.
If the ACVF of a lightcurve shows correlation structure
above the noise ﬂoor, then a second order model may
provide more meaningful parameters.

When a process is under sampled, its time series ap-
pears uncorrelated even at the shortest resolved time lags

14

Figure 13. The ACF and PSD Fourier transform pair. A
broken power law is one of the simplest models used to
describe AGN variability, and it has the same form as
the PSD of a DRW process which has a ﬁxed amplitude-
frequency scaling of ν−2.

and the ACF decays extremely rapidly to zero due to
sparse sampling. A sparse cadence simply means that
binned time lags have non-equal density of observation
pairs, therefore parts of the ACF will be poorly resolved
or entirely unresolved. Figure 12 shows the sample ACF
of a mock AGN lightcurve with sampling like LSST’s
Wide Fast Deep (WFD) in orange and Deep Drilling
Fields (DDF) in blue (for the r-band). The DDF ca-
dence will capture more data at high frequency (short
timescale), however, it is unclear if timescales inside ob-
servability gaps can be recovered reliably. LSST’s WFD
cadence is suﬃcient to recover truth parameters of mock
the lightcurve with the max error being about a 50%
under-estimation of α2 and β0, while α1 and β1 had less
than 1% error. This example worked well for these pa-
rameters however, LSST cadences may not behave well
with all combinations of DHO parameters. Thus, this
requires further investigation.

The ACVF is a powerful diagnostic for model selection
when considering the DRW or the DHO and for deter-
mining whether a gappy time series captures suﬃcient
correlated behavior to assume a model more complex
than white noise in the ﬁrst place. The sample ACVF
and analytic ACVF should be overplotted (as demon-
strated in Figure 12) and compared to determine if higher
order correlation structure merits a more complex model.

10. POWER SPECTRA

transform of the ACVF, γ(τ ), is equivalent to the PSD

Sxx(ω) = |

(cid:90) ∞

−∞

γ(τ )e−iωτ dτ |2.

(21)

Power-spectral analysis decomposes the power in a time
series into a linear combination of complex exponentials
(harmonics) that are characterized by an amplitude and
frequency. Equation 21 represents the scaling of squared
variability amplitude as a function of frequency.

The simplest model used to describe AGN variabil-
ity corresponds to a power law in frequency space (e.g.,
Schmidt et al. 2010). Typical AGN PSD estimates
(which are historically poorly resolved) exhibit pink or
red spectra,

P SD ∝ ν−2,

and a break frequency at which the spectrum turns over
to a ﬂat slope at low frequencies (see Fig. 13). The
negative slope indicates that amplitude decreases with
increasing frequency. The ﬂat turnover corresponds to
(uncorrelated) white noise—signifying that resolved ﬂuc-
tuations are independent at these timescales (or maximal
length scales) in AGN accretion disks. Astronomers can
extract timescales of interest when the empirical spec-
trum deviates from the theoretical ﬁxed-slope scaling re-
lationship. These deviations may take the form of an
inﬂection point leading into a slope ﬂattening (decorre-
lation), steepening or a Lorentzian (QPO signal).

Thus, in this section we discuss the assumptions of
adopting a single-sloped power law (CARMA(1,0)) ver-
sus a multi-sloped power law (e.g., CARMA(2,1), as illus-
trated in Figure 14) and how it relates to multiscale anal-
ysis of AGN variability in the frequency domain. Devia-
tions from a single slope reveal characteristic timescales
that may point to multiple mechanisms for generating or
dissipating energy at diﬀerent scales. We explain such
timescale interpretation by examining the analytic func-
tions of DRW and DHO PSDs.

10.1. PSD of DRWs and DHOs

The analytic PSD of a DRW (shown in the bottom
panel of Figure 13) is parametrized by two values: (1) the
asymptotic amplitude where the ﬂat slope is observed,
β0, and (2) the decay timescale, τ in the C-AR parameter
α1 (Koz(cid:32)lowski et al. 2010, MacLeod et al. 2008, Kelly
et al. 2014), which are related by

P SDDRW (ν) =

β2
0
α1 + (2πν2)

.

(22)

The PSD of DHOs (CARMA(2,1)), on the other hand,
involves two additional degrees of freedom, α2 and β1,

While the ACVF provides a complexity diagnostic in
time space, the power spectral density (PSD) provides a
complementary diagnostic in frequency space. A Fourier

P SDDHO(ν) =

1
2π

0 + 4π2β2
β2
16π4ν4 + 4π2ν2(α2

1 ν2
1 − 2α2) + α2
2
(23)

15

Figure 14. DHO PSDs with diﬀerent characteristic frequencies and timescales. The left panel shows examples of DHO
PSDs with real roots, while the right illustrates PSDs of models with complex roots. Multi-sloped spectra can be
modelled by the analytic PSD of DHO processes. Dashed cyan lines track the blue noise perturbation frequency νblue
which we increase for each curve yellow to red). The right panels show how a Lorentzian reveals the strength of a
QPO signature. These examples demonstrate the ﬂexibility of the DHO model, but they also provide a sense of how
perturbation and response parameters interact to better recognize how the DHO model diverges from the DRW in the
frequency domain.

The numerator of Equation 23 is the perturbation spec-
trum and therefore contains positively sloped compo-
nents that add power, where as the denominator con-
tains negatively sloped components since α1 and α2 relax
and dissipate energetic perturbations to maintain equi-
librium.

DRWs are scale invariant up to the decay timescale
i.e.
their PSDs follow single sloped power law across
all observed frequencies in the lightcurve up to a break
frequency where the spectrum ﬂattens, νf lat. A single-
slope power law assumes self-similarity up to this fre-
quency. Self-similarity is broken when more complexity
or covariance is present in the stochastic process. A sec-
ondary critical frequency may lead into a secondary slope
in an empirical PSD. In the analytic PSDs of higher or-
der CARMA processes, break frequencies or characteris-
tic timescales can be estimated systematically by solving
for critical points in the numerator and denominator of
Eq. 23. We show multi-sloped PSDs of DHOs in Fig-
ure 14, however they are extensively ﬂexible, thus this is
not a complete preview.

The slopes of DHO PSDs can range from as steep as
Slope = −4 to values with more power than the DRW,
Slope > −2. They can also exhibit an additional char-
acteristic frequency break to νf lat, which we will refer
to as νblue. The secondary frequency νblue reveals an
excess power contribution such that frequencies higher
than νblue have more power than the projected scaling

relationship of lower frequencies. νblue is a critical point
found by solving for the root of the numerator of Eq. 23,
thus

νblue =

β0
2πβ1

.

Higher resolution optical data from Kepler (Van Cleve
& Caldwell 2016), Catalina Real Time Survey (CRTS;
Drake et al. 2009), OGLE (Udalski et al. 2015) and Pan-
STARRS (Kaiser et al. 2002) show evidence of deviations
from the broken power law in the form of excess power
at high frequencies thus DHO models may prove useful
to systematically measure the frequency where this de-
viation occurs (Mushotzky et al. 2011, Zu et al. 2013,
Graham et al. 2014, Kasliwal et al. 2015, Simm et al.
2016). The location of vblue for each example in Fig 14
is tracked by the dashed cyan lines until each terminates
at the intersection with its corresponding model.

The domain of PSD behavior is probably the most ﬂex-
ible in the case where the DHO ﬁt results in two real
roots r1 and r2. Two real roots are the negative inverse
of the rise and decay timescales, τrise and τdecay. When
we examined Green’s functions we learned that a rise
timescale acts as a delay time over which perturbations
drive the ﬂux away from the mean. However, the Green’s
function only tells half of the story. In the left panel of
Figure 14, we show how the rise mechanism couples to
the perturbation frequency νblue. A dashed purple line
shows an example DRW with a τdecay = 150 days. All

16

solid curves (DHOs) have the same decay timescale and
the same rise timescale, τrise = 25. The only variable
between each curve is the perturbation frequency νblue.
When νblue is approximately equal to the magnitude of
one of the real roots, then the rise timescale mechanism
is cancelled out and we approximate the DRW model
as shown by the yellow curve in the left panel. When
|r1| < νblue < |r2|, we obtain a more gradual turnover
than the DRW, which is a more adequate model for AGN
that show a slow ﬂattening but no clear turnover. If the
perturbation frequency is higher than the magnitude of
both roots, νblue > |r1|&|r2|, then the PSD is steeper
than a DRW for low frequencies, until νblue where there is
excess power than this scaling at the highest frequencies
(shown by the red curve in the left panel).

In the right panel of Fig 14, we preview DHOs with
complex roots with diﬀerent damping ratios in the range
.01 < ξ < 1. When the the damping factor is ξ < 0.5, the
DHO PSD exhibits a Lorentzian as shown by the three
lightest colored curves in the right panel. The peaked-
ness of the Lorentzian reveals how regular the periodicity
is. The more rounded it appears, the less apparent the
QPO will be in the lightcurve (hence “quasi”) (as seen
previously in Fig 9). If the νblue dominates frequencies
lower than the QPO frequency, it will make the QPO
resonate (more sharply peaked), especially if the damp-
ing factor is below the critical value. We can expect
this combination of parameters when applying the DHO
model to periodic stars (stars will have very low pertur-
bation frequencies compared to quasars). X-ray binaries
or pulsating stars with two oscillatory frequencies should
employ fourth order CARMA models, which resolve two
periodicities. QPO signatures in AGN although uncom-
mon have been detected (Graham et al. 2015, Smith et al.
2018). The DHO’s ability to measure periodicities ac-
curately should be further investigated. We illustrate
damped QPO features here as it is important to under-
stand what the PSDs of potential AGN contaminants will
look like if utilizing CARMA(2,1) not just for investiga-
tion of AGN physics, but also for AGN selection.

11. STRUCTURE FUNCTIONS

The structure function (SF) is another common tool
for the analysis of light curves; it is especially popular
because it is more eﬃcient to compute than a PSD for
gappy astronomical data. A SF estimates the mean ﬂux
as a function of binned time lags of increasing length as
depicted in Figure 15. The PSD and SF are both trans-
forms of the ACF and appear like distorted mirror images
of each other. Since log-log projections stretch smaller
values and concentrate together large orders of magni-
tude, the SF emphasizes the scaling of variability ampli-
tude at relatively short timescales, while the PSD empha-
sizes correlation structure at low frequencies (or equiv-

Figure 15. The ACF, SF,and PSD for various decay
timescales. All panels reﬂect the same temporal baseline
of 3000 days. The projections of the SF and PSD are dis-
torted mirror images of each other. Thus the decorrela-
tion timescale (τdecorr ≈ π
2 τdecay of the DRW) is harder
to observe in the SF and PSD for long timescales al-
though the ACF fully decays within the same baseline.

alently long timescales). As the ACF decay timescale
of a stochastic lightcurve gets longer, then the turnover
signaling decorrelation in PSDs is harder to resolve and
estimate in SF space. Several deﬁnitions of the struc-
ture function are employed in the literature as well as
critiques of the interpretation of SFs (Emmanoulopoulos
et al. 2010, MacLeod et al. 2011, Koz(cid:32)lowski 2017a). Here
we review equivalent forms described by Kasliwal et al.
(2015) and Koz(cid:32)lowski (2017a) (ﬁrst provided by Simon-
etti et al. (1985)). In parallel to the previous section on
multi-sloped PSDs, we provide graphs of analytic DHO
SFs in Figure 16.

The SF can be estimated directly from the data using
the sample ACVF in Equation 17 and taking into account
measurement error, σnoise as proposed by Koz(cid:32)lowski
(2017a)

(cid:113)

SFobs(∆t) =

2(ACV F (0) − ACV F (∆t)) − 2σ2

noise.
(24)
The analytic SFs DRWs and DHOs is evaluated with
nearly the same formula; however, the analytic ACVF
described in Equations 19 and 20 must be employed to
compute each respectively,

SFCARM A(∆t) = (cid:112)2(ACV F (0) − ACV F (∆t))

(25)

or equivalently,

SFCARM A(∆t) =

(cid:113)

2σ2

signal(1 − ACF (∆t)).

(26)

Uncertainty in SFCARM A can be accounted for by plot-

17

ting 1-σ conﬁdence intervals of C-AR and C-MA param-
eters and a measurement noise ﬂoor at some amplitude
cutoﬀ (similar to PSD examples in Kelly et al. 2014 and
Kasliwal et al. 2017).

Structure functions emphasize the information in the
auto-correlation function at short lags, however, the
highest priority timescale (as evidenced by the literature)
of SF analysis is the decorrelation timescale of AGN (re-
siding at long time lags). Another high priority statistic
is the slope of a power law ﬁtted to an empirical SF. A
turnover to a ﬂat slope in the SF (even if it is gradual)
shows decorrelation just as in PSDs. If there is no vis-
ible decay in the ACF, there is no chance of recovering
any characteristic timescale in the SF because the pro-
cess is non-stationary. However, if there is a decay in the
ACF, then timescale estimation is possible even if there
is no clear turnover in the empirical SF or PSD. These
timescales will not indicate decorrelation but rather they
reveal either deviations from the DRW SF or entirely
diﬀerent slopes ranging from 0 < Slope < 1.5.

The decorrelation timescale is related to the DRW de-
cay timescale by the relation τdecorr ∝ cτdecay, where c is
a numerical constant. A SF (or PSD) exhibiting a more
gradual turnover than a DRW SF at long lags may be
better described by a multi-sloped model. If we do not
assume a broken power law, but rather a multi-sloped SF
(or PSD) with a slow ﬂattening towards an asymptotic
amplitude, we would seek more than one characteristic
timescale rather than one signature turnover.

Analytic structure functions of DHOs with multi-
sloped power-laws are illustrated in Figure 16. DHOs
with real roots which provide a rise timescale τrise in ad-
dition to a decay timescale τdecay are displayed in the top
two panels and DHOs with complex roots which provide
a QPO period TQP O (rather than a rise timescale) are
shown in the bottom panel.

The pink cross hairs on each panel of Figure 16 are
located at the time lag where the SF amplitude is equal
to 0.795SF∞, which was empirically shown by Koz(cid:32)lowski
(2017a) to be a model-independent method to estimate
the decorrelation timescale

τdecor = ∆t(0.795SF∞)

of SFs. If a DHO ﬁt to a lightcurve results in two real
roots, then the decorrelation timescale of the SF can be
estimated as

τdecorr ≈

π
2

(τrise + τdecay).

This relation is illustrated in the ﬁrst panel which shows
that various sums of τrise and τdecay totaling to 300 days
all intersect at the same turnover timescale (marked by
the pink cross-hairs) including a DRW walk with a de-
cay timescale of 300 days. When the DHO ﬁt results in
complex roots the decorrelation timescale is computed

Figure 16. DHO SFs with diﬀerent slopes. In the case
of real roots (top two panels), the sum of the rise and
decay timescale is related to the decorrelation timescale,
but in the case of complex roots (bottom panel), the QPO
timescale predicts the decorrelation timescale. DHO SFs
exhibit slopes between 0 and 1.5. Generally real roots can
produce SF with slope < 1 and complex roots can predict
slopes steeper than the DRW (slopes > 1 ) with possible
excess at the timescale τblue. The grey ﬁll (bottom panel)
shows (6 month) observability gaps in the restframe of a
quasar with redshift z = 2

18

Figure 17. AGN variability analysis toolset: CARMA
models, ACFs, Impulse-Response functions, SFs and
PSDs. We show a sample DHO model with complex
roots in orange and a sample DHO with real roots in
blue. Both examples diverge the most at short time lags
in the ACF and SF. The low frequency discrepancies al-
though subtle are magniﬁed in the response function and
PSD. Direct lightcurve modelling provides parameters to
compute analytic SFs and PSDs, that correspond to ﬂex-
ible (multi-sloped) power models, which can be compared
with empirical estimates of the SF and PSD.

diﬀerently,

τdecorr ≈

π
2

TQP O.

We provide these relations to reconcile the timescales of
the DHO to timescales of SF analyses that are indepen-
dent of CARMA modelling 3.

The ﬂexibility of the DHO SF is very extensive; we
choose to highlight its ability to model diﬀerent slopes.
The DRW slope is ﬁxed, but DHO processes are de-
scribed by a range of slopes 0 → 1.5. When the per-
turbation timescale is very close to zero, both τrise and
TQP O mark critical points where the slope is steeper than
the DRW. When τblue becomes signiﬁcant relative to the
value of τrise, then timescales greater than τblue exhibit
slopes < 1 (diagrammed in the middle panel). The eﬀect
is opposite in the complex case, when τblue becomes sig-
niﬁcant relative to the value of TQP O, slopes are steeper
(> 1) than the DRW. If τblue ≥ (τrise or TQP O) this
condition is a test of overﬁtting and the DRW may be
more adequate to describe the lightcurve.

12. DISCUSSION AND SUMMARY

This work provides a guide for the application and in-
terpretation of auto-regressive (CARMA) models stud-

3 These relations are only valid when τblue < (τrise or TQP O)

ied jointly with causal Green’s Functions for the in-
vestigation of AGN variability. Directly modelling a
lightcurve with a stochastic process of ﬂexible complexity
extracts more descriptive information at short and long
timescales. To better understand what C-AR and C-
MA parameters are capable of describing, we investigated
the second order statistics of DRWs and DHOs including
the ACVF, PSD, and SF—which are used extensively
to study astrophysical variability (see AGN variability
analysis toolset in Figure 17). The simplest model of
stochastic variability is a power law in the SF or PSD
that decorrelates at long timescales. A deviation from
a single-slope power law in an AGN SF or PSD indi-
cates higher covariance which may be well described by
a CARMA process.

C-AR parameters describe a dynamic system (by deﬁn-
ing a diﬀerential equation) and C-MA parameters per-
turb the system. In other words, we can generally predict
the motion of a physical system via two delay timescales
(motion away or toward equilibrium). However, per-
turbations make the motion more random and less pre-
dictable depending on the amplitude and frequency of the
perturbation mechanism. These delay timescales as well
as the perturbation frequency (or timescale) come from
the roots of the CARMA diﬀerential equation. They can
be interpreted with the Green’s function, ACF, PSD and
SF as we have shown, and they are related to critical
points in the analytic formulas where the PSD and SF
deviate from the single-slope model, i.e., stochastic pro-
cesses with more characteristic timescales produce multi-
slope power laws.

We discussed the multi-sloped power-law model ap-
plied to PSDs and SFs as a method of conducting
multi-scale analysis. Multi-scale analysis may disentan-
gle the signiﬁcance of multiple characteristic timescales
or frequencies found in observations of the same AGN
that have diﬀerent time resolution (cadence). Multiple
timescales may indicate several processes dominating at
diﬀerent length scales or a break from homogeneity in a
control parameter, such as density or temperature, from
one length scale to the next. We also propose employing
techniques used to study critical phenomena to interpret
the (ARMA) DHO triangle and to approach ensemble
studies of AGN in the CARMA parameter landscape.

In ensemble studies, diﬀerent positions in the CARMA
parameter space may be related to diﬀerent mechanisms
involved in driving variability. It merits further investiga-
tion to understand why some roots (or solutions) may en-
ter the complex plane while others reside only in the real
regime. Dynamic systems with complex roots may have
high dimensionality (N > 2) in the number of control
parameters driving variability or they may be a system-
atic of non-stationarity. See the appendix for a summary
of CARMA DHO timescales.

The next steps towards improving AGN variability
analyses techniques are to carefully investigate the ac-
curacy of timescale estimation from gappy lightcurves.
Tests are needed to identify systematic biases
in
timescale estimation depending on cadence and length,
following the example of Koz(cid:32)lowski (2017b) with the
DRW timescale. We will further investigate degeneracies
between the DRW and DHOs and high proximity models
in the SF and PSD space using the analytic formulations
provided by CARMA analyses. Provided improvements
in sampling resolution, measurement error and improved
techniques for combining surveys (to obtain extended
baselines), these advancements in stochastic modelling
may provide meaningful timescales that probe the accre-
tion physics of these diverse and extreme engines.

13. ACKNOWLEDGEMENTS

We

acknowledge

from NASA grant
support
NNX17AF18G. We wish to thank Vishal Kasliwal
for his input, discussions and the development of the
time series modelling software, Kali. We thank David
Lioi and Mark Davis for theoretical discussions of
applied methods. We wish to thank Weixiang Yu for
valuable input and discussions regarding LSST cadences.
Thanks to the LSSTC Data Science Fellowship Program
for educational support.

REFERENCES

Box, G., Jenkins, G., Reinsel, G., & Ljung, G. 2015, Time Series
Analysis: Forecasting and Control, Wiley Series in Probability
and Statistics (Wiley)

Brockwell, P., & Davis, R. 2013, Time Series: Theory and

Methods, Springer Series in Statistics (Springer New York)
Drake, A. J., Djorgovski, S. G., Mahabal, A., et al. 2009, ApJ,

696, 870

Emmanoulopoulos, D., McHardy, I. M., & Uttley, P. 2010,

MNRAS, 404, 931

Feigelson, E. D., Babu, G. J., & Caceres, G. A. 2018, Frontiers in

Physics, 6, 80

Foreman-Mackey, D., Agol, E., Ambikasaran, S., & Angus, R.

2017, AJ, 154, 220

Gillespie, D. T. 1996, American Journal of Physics, 64, 225
Graham, M. J., Djorgovski, S. G., Drake, A. J., et al. 2014,

MNRAS, 439, 703

Graham, M. J., Djorgovski, S. G., Stern, D., et al. 2015, Nature,

518, 74

Granger, C. W. J., & Morris, M. J. 1976, Journal of the Royal

Statistical Society. Series A (General), 139, 246

Ivezi´c, ˇZ., Axelrod, T., Becker, A. C., et al. 2008, in American

Institute of Physics Conference Series, ed. C. A. L.
Bailer-Jones, Vol. 1082, 359

Jones, R. H., & Vecchia, A. V. 1993, Journal of the American

Statistical Association, 88, 947

Kaiser, N., Aussel, H., Burke, B. E., et al. 2002, in Survey and

Other Telescope Technologies and Discoveries, ed. J. A. Tyson
& S. Wolﬀ, Vol. 4836, 154

19

Kasliwal, V. P., Vogeley, M. S., & Richards, G. T. 2017, MNRAS,

470, 3027

Kasliwal, V. P., Vogeley, M. S., Richards, G. T., Williams, J., &

Carini, M. T. 2015, MNRAS, 453, 2075

Kelly, B. C., Bechtold, J., & Siemiginowska, A. 2009, ApJ, 698,

895

Kelly, B. C., Becker, A. C., Sobolewska, M., Siemiginowska, A., &

Uttley, P. 2014, ApJ, 788, 33
Koz(cid:32)lowski, S. 2017a, ApJ, 835, 250
—. 2017b, A&A, 597, A128
Koz(cid:32)lowski, S., Kochanek, C. S., Udalski, A., et al. 2010, ApJ, 708,

927

Krawczyk, C. M., Richards, G. T., Mehta, S. S., et al. 2013,

ApJS, 206, 4

Kubota, A., & Done, C. 2018, MNRAS, 480, 1247
MacLeod, C., Ivezi´c, ˇZ., de Vries, W., Sesar, B., & Becker, A.

2008, in American Institute of Physics Conference Series, ed.
C. A. L. Bailer-Jones, Vol. 1082, 282

MacLeod, C. L., Brooks, K., Ivezi´c, ˇZ., et al. 2011, ApJ, 728, 26
McHardy, I. M., Koerding, E., Knigge, C., Uttley, P., & Fender,

R. P. 2006, Nature, 444, 730

Mills, T. 2012, A Very British Aﬀair: Six Britons and the

Development of Time Series Analysis During the 20th Century,
Palgrave Advanced Texts in Econometrics (Palgrave
Macmillan)

Mushotzky, R. F., Edelson, R., Baumgartner, W., & Gandhi, P.

2011, ApJ, 743, L12

Ni, Q., Brandt, W. N., Luo, B., et al. 2018, MNRAS, 480, 5184
Pandit, & Wu. 1975, 62, 497
Phadke, M. S., & Wu, S. M. 1974, Journal of the American

Statistical Association, 69, 325

Pringle, J. E. 1981, Annual Review of Astronomy and

Astrophysics, 19, 137

Richards, G., Lacy, M., Storrie-Lombardi, L., et al. 2006, in
Astronomical Society of the Paciﬁc Conference Series, ed.
L. Armus & W. T. Reach, Vol. 357, 261

Sartori, L. F., Schawinski, K., Trakhtenbrot, B., et al. 2018,

MNRAS, 476, L34

Schmidt, K. B., Marshall, P. J., Rix, H.-W., et al. 2010, ApJ, 721,

1941

Sesar, B., Ivezi´c, ˇZ., Lupton, R. H., et al. 2007, AJ, 134, 2236
Simm, T., Salvato, M., Saglia, R., et al. 2016, A&A, 585, A129
Simonetti, J. H., Cordes, J. M., & Heeschen, D. S. 1985, ApJ,

296, 46

Smith, K. L., Mushotzky, R. F., Boyd, P. T., & Wagoner, R. V.

2018, ApJ, 860, L10

Thomas, A. 1986, Journal of Physics A: Mathematical and

General, 19, 929

Udalski, A., Szyma´nski, M. K., & Szyma´nski, G. 2015, Acta

Astron., 65, 1

Uttley, P., McHardy, I. M., & Papadakis, I. E. 2002, MNRAS,

332, 231

Uttley, P., McHardy, I. M., & Vaughan, S. 2005, MNRAS, 359,

345

Van Cleve, J. E., & Caldwell, D. A. 2016, Kepler Instrument

Handbook, Tech. rep.

Vaughan, S., Edelson, R., Warwick, R. S., & Uttley, P. 2003,

MNRAS, 345, 1271

Yule. 1927, Philosophical Transactions of the Royal Society of

London A: Mathematical, Physical and Engineering Sciences,
226, 267

Zu, Y., Kochanek, C. S., Koz(cid:32)lowski, S., & Udalski, A. 2013, ApJ,

765, 106

14. APPENDIX

We summarize CARMA DHO timescales here:

20

• Rise timescale (real roots)

• Blue noise dominates at the timescale,

τrise =

1
r2 − r1

ln|

r1
r2

| ≈ |

1
min(r1, r2)

|

• Eﬀective Decay timescale of the lightcurve

τef f decay =

Gtrise
e

≈ τrise + τdecay,

τdecay = |

1
max(r1, r2)

|

• QPO natural period (complex roots)

TQP O = |

1
(cid:61)(r1)

| = |

1
ω0

| ≈

2π
√
α1

• QPO damped period (complex roots)

TdQP O = |

2π
ωd

| =

2π
(cid:112)1 − ξ2

ω0

with resonance depending on the damping ratio,
α1
√

ξ =

2

α2

• Coherence/Decay timescale (complex roots) de-

scribes how resonant the QPO is

τdecay = |

1
(cid:60)(r1)

| = |

1
(cid:60)(r2)

|

τblue = |

β1
β0

|

• Multi-slope SF decorrelation timescale

τdecorr ≈

π
2

(τrise + τdecay) (or)

π
2

TQP O

• SF Secondary slope timescale
τblue√
2π

τexcess =

or

τsteep = τrise when τblue << τrise

• PSD secondary slope

νblue =

β1
2πβ0

when τblue << τrise or TQP O

P SD ∼ ν−2 → ν−4

νsteep = min(

2π
1 − 2α2

(cid:112)α2

,

2π
√
α2

)

