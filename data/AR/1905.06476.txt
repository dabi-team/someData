9
1
0
2

y
a
M
5
1

]

C
O
.
h
t
a
m

[

1
v
6
7
4
6
0
.
5
0
9
1
:
v
i
X
r
a

Stop-and-Go Suppression in Two-Class Congested Trafﬁc

Mark Burkhardt a, Huan Yu b,(cid:63) and Miroslav Krstic b

aInstitute for System Dynamics, University of Stuttgart, Waldburgstr. 17/19, Stuttgart, 70563, Germany

bDepartment of Mechanical and Aerospace Engineering, University of California, San Diego, La Jolla, CA, 92093, USA

Abstract

This paper develops boundary feedback control laws in order to damp out trafﬁc oscillations in the congested regime of the linearized
two-class Aw-Rascle (AR) trafﬁc model. The macroscopic second-order two-class AR trafﬁc model consists of four hyperbolic partial
differential equations (PDEs) describing the dynamics of densities and velocities on freeway. The concept of area occupancy is used
to express the trafﬁc pressure and equilibrium speed relationship yielding a coupling between the two classes of vehicles. Each vehicle
class is characterized by its own vehicle size and driver’s behavior. The considered equilibrium proﬁles of the model represent evenly
distributed trafﬁc with constant densities and velocities of both classes along the investigated track section. After linearizing the model
equations around those equilibrium proﬁles, it is observed that in the congested trafﬁc one of the four characteristic speeds is negative,
whereas the remaining three are positive. Backstepping control design is employed to stabilize the 4 × 4 heterodirectional hyperbolic
PDEs. The control input actuates the trafﬁc ﬂow at outlet of the investigated track section and is realized by a ramp metering. A full-state
feedback is designed to achieve ﬁnite time convergence of the density and velocity perturbations to the equilibrium at zero. This result is
then combined with an anti-collocated observer design in order to construct an output feedback control law that damps out stop-and-go
waves in ﬁnite time by measuring the velocities and densities of both vehicle classes at the inlet of the investigated track section. The
performance of the developed controllers is veriﬁed by simulation.

Key words: Multi-class trafﬁc model, PDE control, Backstepping, Output feedback controller.

1

Introduction

Nowadays, more and more people own a car leading to
crowded highways and congested trafﬁc during rush hours in
many countries of the world. Stop-and-go trafﬁc is common
to appear in congested trafﬁc. This phenonemon is charac-
terized by trafﬁc density and velocity perturbations, caus-
ing higher fuel consumption and a higher risk of accidents.
Trafﬁc management systems like ramp metering or variable
speed limits exist in order to regulate trafﬁc. Moreover, they
can be used to damp out those trafﬁc oscillations and dis-
tribute trafﬁc evenly on the highway. Many recent efforts
are focused on boundary control of stop-and-go trafﬁc in-
cluding [40], [43], [38] and [39]. However, the results pre-
sented in this paper assume heterogeneous vehicle sizes and
drivers’ behavior. Thus, the overall challenge addressed in
this work is the design of a ramp metering trafﬁc manage-
ment system to reduce trafﬁc oscillations in the congested
regime while distinguishing two different vehicle classes.

(cid:63) Corresponding author.

Email addresses: mburkhardt@eng.ucsd.edu (Mark

Burkhardt), huy015@ucsd.edu (Huan Yu), krstic@ucsd.edu
(Miroslav Krstic).

In general, trafﬁc models are categorized in micro-, meso-
and macroscopic models. Macroscopic models describe the
trafﬁc as a continuum and are thus more suitable to investi-
gate trafﬁc jams and disturbances in trafﬁc ﬂow. Typically,
their model equations are PDEs. The ﬁrst representative
of this model category is the Lighthill-Whitham-Richards
(LWR) model, [22] and [29], that is given by a single
PDE conserving the trafﬁc ﬂow. Although capturing a good
amount of realistic trafﬁc phenomena, the LWR model fails
to model important phenomena like platoon dispersion [37]
or stop-and-go waves and is faulty under light trafﬁc con-
ditions. Thus, a second order extension is provided inde-
pendently by [28] and [36]. This second order extension
is denoted as the PW model and introduces a second PDE
modeling the velocity dynamics of the vehicles in addition
to the conversation law. However, the critique in [9] points
out that the PW model fails to portray that personalities of
vehicles remain unchanged and drivers react more likely
to events in front of them. To overcome these issues, [4]
and [41] presented the Aw-Rascle-Zhang (ARZ) model
which is also a second-order model describing the interac-
tion between the vehicles by a trafﬁc pressure function.

Macroscopic multi-class models were proposed after the
publication of the ARZ model, including the ﬁrst order mod-

Preprint submitted to Automatica

17 May 2019

 
 
 
 
 
 
els [6], [8], [16], [23], [26], [27], [33], [37] and [42]. The
extended LWR model, introduced by [37], is the ﬁrst macro-
scopic multi-class extension. Instead of adjusting their ve-
locity only depending on the density of their own class, ve-
hicles are affected by the densities of all other classes. Thus,
the assumed speed-density relationship is formulated with
respect to the sum of all densities, the total density. Fur-
thermore, the n-populations model [6] extends this idea of
coupling regarding the average length of the vehicle classes
by denoting the speed-density relationship in dependence of
the mean free space between the vehicles. In [16] and [26],
a phenomenon called creeping is introduced. This behavior
occurs in reality and corresponds to the scenario where one
vehicle class, for instance trucks, are jammed and stopped
due to congestion and a second vehicle class, for instance
motorcycles, still moves in the gap between the trucks.

In addition to ﬁrst-order macroscopic multi-class models,
second-order multi-class models are introduced in [7], [18],
[21], [25], [31] and [32]. While ﬁrst-order models assume
that the velocities of all vehicles equal to their equilibrium
velocities at every time, second-order models provide PDEs
describing the velocity dynamics for each class. The de-
noted second-order models differ in the terms that occur in
the velocity dynamics and in the principles which are used
to deduce them. For instance, [32] presents an originally
microscopic model that is transformed to the macroscopic
one, whereas the model in [25] is based on the macroscopic
second-order model of [4]. The main focus of this paper
is the macroscopic multi-class model [25]. Considering this
extension for the case of two different classes yields four
coupled nonlinear hyperbolic PDEs which are denoted as
the two-class AR trafﬁc model in the following. In order
to consider vehicle sizes, the vehicles are assumed to ad-
just their speed according to a measure called area occu-
pancy, [1] and [24], which needs to be distinguished from
occupancy [2].

Typically, trafﬁc management systems act on the boundary
of the investigated track section yielding a boundary control
problem. In the literature, different techniques are proposed
that achieve convergence of the states of hyperbolic coupled
PDEs to a constant equilibrium with boundary control. The
main focus of this paper is on the backstepping stabilization
technique. While [10], [11], [14], [19], [34], [35] provide
results in case of 2 × 2 or 3 × 3 coupled hyperbolic systems,
there also exists literature if an arbitrary amount of linear
coupled PDEs is considered [3], [12], [15], [20], [30]. In
fact, the presented output feedback control of this work cor-
responds to the special case of the theoretical result in [20]
for m = 3 and n = 1. The elimination of trafﬁc oscillations
by applying the backstepping technique is achieved for the
ARZ model in [38] and in [40]. Moreover, [40] also presents
adaptive control results.

Main contribution of this paper: this work presents the ﬁrst
result on boundary control design for trafﬁc congestion con-
sisting of two different vehicle classes. On one hand, this
work contributes to trafﬁc modeling in the sense of deducing

a macroscopic multi-class trafﬁc model in its characteristic
form and investigating the obtained characteristic speeds. On
the other hand, a connection between the theoretical control
design method backstepping and an up-to-date extension of
the AR trafﬁc model for two classes is created by designing a
full-state feedback controller and output feedback controller
as ramp metering signal. Moreover, the results are a ﬁrst
step for control problem of more than two vehicle classes
or the combination of multiple classes with multiple lanes.

The rest of this paper is structured as follows: Section 2 intro-
duces the two-class AR trafﬁc model, the parameters charac-
terizing the two classes and where they occur as well as the
assumed boundary conditions. Section 3 includes the prepa-
ration of the linearized model for the control design and the
formulation of the control design model. Furthermore, the
full-state feedback controller result is presented in section
4 and the following section 5 presents the anti-collocated
observer design. Section 6 provides the combination of the
results to derive an the output feedback controller and sec-
tion 7 veriﬁes the performance of the presented controllers
with simulation results. Some future work is discussed in
section 8.

2 Problem statement

The two-class AR trafﬁc model is presented and impor-
tant model parameters are explained. Afterwards, the model
equations are linearized around a constant equilibrium, fol-
lowed by a discussion of the free-ﬂow or congested regimes.

2.1 Two-class AR trafﬁc model

The Extended AR model for heterogeneous trafﬁc presented
in [25] is investigated in case of two classes. This two-class
AR trafﬁc model is given by

∂t ρ1 = − ∂x(ρ1v1),
∂t (v1 + p1(AO)) = − v1∂x(v1 + p1(AO))

+

Ve,1(AO) − v1
τ1
∂t ρ2 = − ∂x(ρ2v2),
∂t (v2 + p2(AO)) = − v2∂x(v2 + p2(AO))

,

+

Ve,2(AO) − v2
τ2

,

(1)

(2)

(3)

(4)

where each vehicle class is described by trafﬁc density
ρi(x,t) and velocity vi(x,t) with (x,t) ∈ [0, L] × [0, ∞). The
parameter L is the length of the investigated track section.
The trafﬁc density ρi(x,t) is deﬁned as vehicles per unit
length. The higher the trafﬁc density, the more crowded
is the trafﬁc of class i vehicles at a speciﬁc spatial point.
In addition, the velocity vi(x,t) describes the velocity of
class i vehicles at a speciﬁed spatial point along the investi-
gated track section. The trafﬁc density ρ1(x,t) and velocity

2

v1(x,t) correspond to the ﬁrst vehicle class and the traf-
ﬁc density ρ2(x,t) and velocity v2(x,t) correspond to the
second vehicle class. The non-zero terms on the right hand
side represent the adaption of the vehicles to their desired
velocities, where τi is the adaptation time.

function (6) and the equilibrium speed-AO relationship (7),
both functions are plotted in Figure 1 using an example
parameter set. It is illustrated, that a more crowded highway,
corresponding to a higher area occupancy, implies a higher
experienced trafﬁc pressure and a lower equilibrium speed.

The variable AO(ρ1, ρ2) describes the area occupancy and is
based on the deﬁnition of the occupancy introduced in [2].
In [25], the expression for the area occupancy is simpliﬁed
to

AO(ρ1, ρ2) =

a1Lρ1 + a2Lρ2
W L

,

(5)

where ai is the occupied surface per vehicle class i and W
the width of the investigated track. Assuming that the trafﬁc
densities are ρ1(x,t) and ρ2(x,t) along the entire considered
highway section, the area occupancy AO(ρ1, ρ2) is the per-
centage of occupied road space by any class. It holds that
0 ≤ AO ≤ 1. The area occupancy depends on both densities
since the occupied road surface is inﬂuenced by the vehicles
of both classes.
The trafﬁc pressure function pi(AO) is formulated as

pi(AO) = Vi

(cid:18) AO(ρ1, ρ2)
AOi

(cid:19)γi

,

(6)

where Vi corresponds to the free-ﬂow velocity, γi > 1 to the
trafﬁc pressure exponent and 0 < AOi ≤ 1 to the maximum
area occupancy. The trafﬁc pressure pi(AO) is the experi-
enced trafﬁc pressure by class i vehicles and depends on the
area occupancy. The higher the area occupancy, the higher
the experienced trafﬁc pressure. For instance, if a vehicle
suddenly decelerates, then the following vehicle experiences
a high trafﬁc pressure forcing another deceleration. Thereby,
the free-ﬂow velocity Vi represents the desired velocity of
a driver, if no other vehicles of any class are present. The
pressure exponent γi is a parameter that models the experi-
ence of the trafﬁc pressure. Higher trafﬁc pressure exponents
lead to less experienced pressure. However, the maximum
experienced pressure remains the same and is given by the
free-ﬂow velocity. The maximum area occupancy AOi de-
scribes the percentage of occupied road surface for which
the corresponding vehicle class is jammed. To obtain phys-
ically meaningful results, 0 < AO ≤ 1 holds. For instance,
AO2 = 0.8 means that if 80% of the highway are covered by
vehicles of any class, then the class 2 vehicles are jammed
and therefore their desired velocity is zero. Finally, the equi-
librium speed-AO relationship is

(cid:18)

Ve,i(AO) = Vi

1 −

(cid:18) AO(ρ1, ρ2)
AOi

(cid:19)γi(cid:19)

,

(7)

according to the model of Greenshield [17], and represents
the desired velocity of the class i vehicles. It depends on the
area occupancy since a very crowded road implies a lower
desired speed in contrast to a nearly empty road. If the area
occupancy is at the maximum AOi, then the corresponding
equilibrium speed-AO relationship value is Ve,i(AOi) = 0. In
order to show the qualitative behavior of the trafﬁc pressure

3

2.2 Linearized two-class AR trafﬁc model

The two-class AR trafﬁc model (1) to (4) is linearized around
2)T . Inserting this
a constant equilibrium state (ρ ∗
constant state in (1) to (4) yields the conditions

1, ρ ∗

2 , v∗

1 , v∗

1(ρ ∗
v∗
2(ρ ∗
v∗

1 , ρ ∗
1 , ρ ∗

2 ) = Ve,1(AO(ρ ∗
2 ) = Ve,2(AO(ρ ∗

1 , ρ ∗
1 , ρ ∗

2 )),
2 )).

(8)
(9)

Thus, the equilibrium velocities are determined by the equi-
librium densities ρ ∗
1 and ρ ∗
2 . The perturbations of the dis-
tributed variables ρi(x,t) and vi(x,t) are deﬁned as

˜ρi(x,t) = ρi(x,t) − ρ ∗
i ,
˜vi(x,t) = vi(x,t) − v∗
i ,

(10)
(11)

for each class i and the linearized model equations are given
by

















Jt








˜ρ1t
˜v1t
˜ρ2t
˜v2t








+ Jx








+ J






















=








,








(12)

˜ρ1
˜v1
˜ρ2
˜v2

0

0

0

0

˜ρ1x
˜v1x
˜ρ2x
˜v2x

where the introduced Jacobian matrices are




























Jt =

Jx =

J =

and the abbreviations










,

1 0 0 0

β11 1 β12 0

0 0 1 0

β21 0 β22 1

0

0

ρ ∗
v∗
1
1
1β11 v∗
1 v∗
v∗
1β12 0
v∗
ρ ∗
0
0
2
2
2β22 v∗
2β21 0 v∗
v∗
2

0

1
τ1

β11

0
1
τ1
0
0
β21 0 1
τ2

0

0

β12 0

0

β22

0
1
τ2

1
τ1

1
τ2










,










,

βi j(ρ ∗

1 , ρ ∗

2 ) =

∂ pi(AO(ρ1, ρ2))
∂ ρ j

(cid:12)
(cid:12)
(cid:12)
(cid:12)ρ1=ρ ∗

1 ,ρ2=ρ ∗
2

(13)

(14)

(15)

(16)

Fig. 1. Trafﬁc pressure functions p1(AO) and p2(AO) (left) and equilibrium speed-AO relationships Ve,1(AO) and Ve,2(AO) (right) for the
example parameter set γ1 = 2.5, V1 = 80 km

h , AO = 0.9 for class 1 and γ2 = 2, V2 = 60 km

h , AO2 = 0.85 for class 2.

are introduced with i, j = 1, 2. The abbreviations βi j(ρ ∗
1 , ρ ∗
2 )
represent the derivative of the class i trafﬁc pressure func-
tion with respect to class j trafﬁc density. The boundary
conditions are assumed to be

ρ1(0,t) = ρ ∗
1 ,
ρ2(0,t) = ρ ∗
2 ,
1 + q∗
q1(0,t) + q2(0,t) = q∗
2,
1 + q∗
q1(L,t) + q2(L,t) = q∗
2,

(17)
(18)
(19)
(20)

where (19) and (20) assume that the same total trafﬁc ﬂow
enters and leaves the track section which is given by the sum
of the class 1 and class 2 equilibrium ﬂows q∗
2. The
trafﬁc ﬂow of class i is deﬁned as

1 and q∗

qi(x,t) = ρi(x,t)vi(x,t).

(21)

Boundary conditions (17) and (18) indicate that the trafﬁc
densities of the incoming trafﬁc ﬂow are equivalent to the
equilibrium densities. Thus, not only the entering trafﬁc ﬂow
is constant, in fact the densities of both classes in this trafﬁc
ﬂow are assumed to be constant. The linearization of the
introduced boundary conditions (17) to (20) is

0 = ˜ρ1(0,t),
0 = ˜ρ2(0,t),
0 = v∗
0 = v∗

1 ˜ρ1(0,t) + ρ ∗
1 ˜ρ1(L,t) + ρ ∗

1 ˜v1(0,t) + v∗
1 ˜v1(L,t) + v∗

2 ˜ρ2(0,t) + ρ ∗
2 ˜ρ2(L,t) + ρ ∗

(22)
(23)
2 ˜v2(0,t),
(24)
2 ˜v2(L,t). (25)

2.3 Free/congested regime analysis

In general, two different regimes of trafﬁc are distinguished:
the free-ﬂow regime and the congested regime. The free-
ﬂow regime is characterized by the fact that the total in-
formation of the system travels downstream along with the

vehicles. In that case, the model equations correspond to
four homodirectional hyperbolic PDEs. On the other hand,
a partial upstream propagation of information characterizes
the trafﬁc ﬂow in the congested regime. The corresponding
heterodirectional behavior causes the development of stop-
and-go trafﬁc which implies increased fuel consumption and
risk of accidents. Therefore, it is reasonable to investigate
which choices of equilibrium densities and parameters lead
to heterodirectional information propagation. Therefore, the
characteristic speeds are computed and their signs are con-
sidered in the following. First, the linearized model equa-
tions (12) need to be decoupled in time leading to



















˜ρ1t
˜v1t
˜ρ2t
˜v2t

+ ˜Jx



















˜ρ1x
˜v1x
˜ρ2x
˜v2x



= ˜J

















˜ρ1
˜v1
˜ρ2
˜v2

with the new Jacobian matrices

v∗
1
0

0

ρ ∗
1
1 − β11ρ ∗
v∗
0

0
1 β12(v∗
1 − v∗
v∗
2
0

1) −β21ρ ∗
1

2) −β12ρ ∗
2

ρ ∗
2
v∗
2 − β22ρ ∗
2

0
β21(v∗
2 − v∗










˜J =

0

0
0
0
− 1
− 1
β11 − 1
τ1
τ1
τ1
0
0
0
0
β22 − 1
0 − 1
− 1
τ2
τ2
τ2

β12

β21

0










.

˜Jx =









and

4

(26)

(27)









(28)

Then, the characteristic speeds are given by the eigenvalues
of ˜Jx which are

(29)
(30)
1 , ρ ∗
2 )

(31)

2(ρ ∗

1 , ρ ∗

2 ) − α1(ρ ∗
2

1 , ρ ∗

2 ) − α2(ρ ∗

2(ρ ∗

1 , ρ ∗

2 ) − α1(ρ ∗
2

1 , ρ ∗

2 ) − α2(ρ ∗

1 , ρ ∗
2 )

1(ρ ∗
λ1 =v∗
2(ρ ∗
λ2 =v∗
1(ρ ∗
v∗

1 , ρ ∗
2 ),
1 , ρ ∗
2 ),
2 ) + v∗
1 , ρ ∗

λ3 =

∆(ρ ∗
1 , ρ ∗
2 )
,
2
2 ) + v∗
1 , ρ ∗

+
1(ρ ∗
v∗

−

∆(ρ ∗
1 , ρ ∗
2 )
2

,

λ4 =

where

(32)

(cid:1)2 + 4α1α2ρ ∗

1 ρ ∗
2
(33)

∆(ρ ∗

1 , ρ ∗

2 ) =

(cid:113)(cid:0)α2ρ ∗

2 − α1ρ ∗

1 + v∗

1 − v∗
2

and

αi(ρ ∗

1 , ρ ∗

2 ) = βii(ρ ∗

1 , ρ ∗

2 ) =

∂ pi(AO(ρ1, ρ2))
∂ ρi

(cid:12)
(cid:12)
(cid:12)
(cid:12)ρ1=ρ ∗

.

1 ,ρ2=ρ ∗
2
(34)
For model validity, the equilibrium velocities of both vehicle
classes are chosen to be positive, i.e. v∗
2 > 0 and all
vehicles travel downstream. Thus, the ﬁrst two characteristic
speeds (29) and (30) are positive. In addition, it is shown
in [44] that

1 > 0 and v∗

λ4 ≤ min{λ1, λ2} ≤ λ3 ≤ max{λ1, λ2}

(35)

holds. Because λ1 > 0 and λ2 > 0, (35) implies that λ3 is
positive as well. Hence, the only characteristic speed that
may have a negative sign is λ4. Therefore, trafﬁc is deﬁned
to be in the free regime if the equilibrium densities and
parameters satisfy

λ1, λ2, λ3, λ4 > 0

and in the congested regime if they meet

λ1, λ2, λ3 > 0,

λ4 < 0.

(36)

(37)

Since a controller dealing with congested trafﬁc is designed
later on, it is assumed that the equilibrium densities and pa-
rameters are chosen such that (37) holds throughout the rest
of this paper. In fact, this result allows to formulate a trafﬁc
froude number as it is presented in [5] for the ARZ model.
Besides, in [44], a physical interpretation of the character-
istic speeds (29) to (32) is given. While λ1 and λ2 corre-
spond to the ﬂow of class 1 vehicles and class 2 vehicles, λ3
is related to the fact that the faster vehicle class overtakes
the slower one. For that reason, it is reasonable to obtain
λ1 = λ2 = λ3, if v∗
2 is assumed.

1 = v∗

According to the deﬁnitions in (36) and (37), the bound-
ary between the two regimes is deﬁned as λ4 = 0. In case

1 -ρ ∗

of the two-class AR trafﬁc model, this boundary is a line
which can be drawn in the ρ ∗
2 -plane. Compared to the
single class consideration, the boundary is equivalent to a
single density which is the critical density. The numerically
computed boundary between the two regimes is plotted as
a contour plot for an example parameter set in Figure 2.
The ﬁgure also indicates that small values for both equi-
librium densities ρ ∗
2 correspond to a positive value
of λ4 and therefore homodirectional behavior. On the other
hand, large values of densities lead to a negative value of λ4
indicating heterodirectional behavior. Hence, smaller equi-
librium densities correspond to free-ﬂow regime and large
equilibrium densities correspond to congested regime.

1 and ρ ∗

3 Boundary control design model

In a next step, the control objective and input is explained
and afterwards the introduced linearized two-class AR traf-
ﬁc model, (12), (22) to (25), is prepared for the control de-
sign. The preparation is done using two transformations, the
transformation to Riemann coordinates and a second trans-
formation to further simplify the equations expressed in Rie-
mann coordinates resulting in the control design model.

3.1 Control input and objective

The overall goal is to damp out stop-and-go trafﬁc in the
congested regime and achieve convergence to the equilib-
rium states in a ﬁnite time. The term of stop-and-go traf-
ﬁc refers to oscillations of the density and velocity pertur-
bations around their constant equilibrium values along the
highway. Moreover, a ramp metering is considered to be in-
stalled at the outlet of the investigated track section regu-
lating the trafﬁc outﬂow. In this work, the ramp metering is
used to damp out the introduced stop-and-go waves. Thus,
the boundary condition (25) becomes

U(t) = v∗

1 ˜ρ1(L,t) + ρ ∗

1 ˜v1(L,t) + v∗

2 ˜ρ2(L,t) + ρ ∗

2 ˜v2(L,t).

(38)
Compared to the application of multi-phase ﬂow in oil
pipelines, [13], a ramp metering works as a valve at the end
of the pipe to control the outgoing ﬂow.

3.2 Transformation to Riemann coordinates

The system is transformed to Riemann coordinates to ac-
complish a decoupling of the spatial derivatives. The Rie-
mann variables ( ¯w1, ¯w2, ¯w3, ¯w4)T are deﬁned as new coordi-
nates. The linear state transformation is given by



















¯w1
¯w2
¯w3
¯w4

= V −1



















˜ρ1
˜v1
˜ρ2
˜v2

(39)

5

Fig. 2. Contour plot of λ4 for the parameter set γ1 = 2.5, V1 = 80 km
2. The contour line λ4 = 0 describes the boundary between the free-ﬂow and congested regime.

h , AO = 0.9 for class 1 and γ2 = 2, V2 = 60 km

h , AO2 = 0.85 for class

where the constant invertible transformation matrix V satis-
ﬁes












λ1 0 0 0

0 λ2 0 0

0 0 λ3 0

0 0 0 λ4

= V −1 ˜JxV

(40)








and therefore diagonalizes the Jacobian ˜Jx. The entries of V
are denoted as

V = (cid:8)vi j

(cid:9)
1≤i≤4,1≤ j≤4 .

(41)

The matrix V is straightforward to obtain but omitted in this
paper due to its complexity and length. Inserting the trans-
formation in (12) yields the model equations in Riemann
coordinates



















¯w1t
¯w2t
¯w3t
¯w4t










+

λ1 0 0 0

0 λ2 0 0

0 0 λ3 0

0 0 0 λ4




























¯w1x
¯w2x
¯w3x
¯w4x



= ˆJ

















¯w1
¯w2
¯w3
¯w4

,

(42)

where

ˆJ = V −1 ˜JV

and the entries of the Jacobian ˆJ are denoted by

ˆJ = { ˆJi j}1≤i≤4,1≤ j≤4.

(43)

(44)

Since the coefﬁcient matrix of the spatial derivatives is now
diagonal, a decoupling in spatial derivatives is achieved. The
characteristic speeds (29) to (32) form the diagonal because
they are the eigenvalues of ˜Jx. In addition, the same transfor-
mation is applied to the boundary conditions (22), (23), (24)

6

and (38) yielding













¯w1(0,t)
¯w2(0,t)
¯w3(0,t)

= ˆQ0 ¯w4(0,t),

(45)

¯w4(L,t) = ˆR1













¯w1(L,t)
¯w2(L,t)
¯w3(L,t)

+ ˆU(t).

(46)

The matrices are given by







ˆQ0 = −

ˆR1 = −

1
κ4

v11 v12 v13
v31 v32 v33

κ1 κ2 κ3
(cid:104)

κ1 κ2 κ3







,

v14
v34

κ4



−1 









(cid:105)

(47)

(48)

and are obtained by formulating the linearized boundary
conditions in matrix form, inserting the transformation law
to Riemann coordinates and decoupling afterwards. Besides,
in (47) and (48), the abbreviations

κi = v∗

1v1i + ρ ∗

1 v2i + v∗

2v3i + ρ ∗

2 v4i,

i = 1, 2, 3, 4,

(49)

are inserted. Furthermore, the input transformation, used
in (46), is

1
κ4
Overall, the model equations in Riemann coordinates are
given by (42), (45) and (46). Because the inverse linear state

ˆU(t) =

U(t).

(50)

transformation exists, the system expressed in Riemann co-
ordinates shares the same stability properties with the orig-
inal system. In a next step, a second transformation is per-
formed in order to complete the preparation for the control
design and obtain the control design model. The resulting
coordinates are (w1, w2, w3, w4)T . The second transforma-
tion achieves zero elements on the diagonal of ˆJ in (42) and
sorts the positive characteristic speeds (29) to (31) in as-
cending order on the diagonal of the coefﬁcient matrix of
the spatial derivatives. However, an ascending order is only
deﬁned uniquely, if it is known whether λ1 > λ2 or λ1 < λ2
holds, according to (35). In the following, it is assumed
that class 1 vehicles represent small and fast average vehi-
cles whereas class 2 describes big trucks which are large
and slow. Thus, for the equilibrium velocities v∗
2 holds
and therefore the ascending order of positive characteristic
speeds is λ2 < λ3 < λ1. Hence, the transformation law

1 > v∗

The abbreviations for the coefﬁcients of the source term,
¯Ji j(x), i, j = 1, 2, 3, 4, are:

¯J12(x) = ˆJ23e

¯J14(x) = ˆJ24e

, ¯J13(x) = ˆJ21e

(cid:18) ˆJ11
v∗
1

, ¯J21(x) = ˆJ32e

(cid:18) ˆJ22
v∗
2

¯J23(x) = ˆJ31e

¯J31(x) = ˆJ12e

(cid:18) ˆJ22
v∗
2

, ¯J24(x) = ˆJ34e

, ¯J32(x) = ˆJ13e

¯J34(x) = ˆJ14e

¯J42(x) = ˆJ43e

, ¯J41(x) = ˆJ42e

, ¯J43(x) = ˆJ41e

(cid:18) ˆJ11
v∗
1

(cid:18) ˆJ33
λ3
(cid:18) ˆJ44
λ4
(cid:18) ˆJ11
v∗
1

(cid:18) ˆJ44
λ4
(cid:18) ˆJ33
λ3

(cid:19)
x

(cid:19)
x

(cid:19)
x

(cid:19)
x

(cid:19)
x

(cid:19)
x

−

−

−

−

−

−

ˆJ22
v∗
2

ˆJ22
v∗
2

ˆJ33
λ3

ˆJ11
v∗
1

ˆJ11
v∗
1

ˆJ44
λ4

−

−

ˆJ22
v∗
2

ˆJ33
λ3

−

ˆJ33
λ3

−

−

ˆJ11
v∗
1

ˆJ44
λ4

−

ˆJ44
λ4

(cid:19)
x

(cid:19)
x

(cid:19)
x

(cid:19)
x

(cid:19)
x

(cid:19)
x

,

,

,

,

,

.

(cid:18) ˆJ44
λ4
(cid:18) ˆJ33
λ3
(cid:18) ˆJ22
v∗
2

−

w1 = e

−

w2 = e

−

w3 = e

ˆJ22
v∗
2

ˆJ33
λ3

ˆJ11
v∗
1

x

x

x

¯w2,

¯w3,

¯w1,

−

w4 = e

ˆJ44
λ4

x

¯w4

(51)

(52)

(53)

(54)

1, (29), and λ2 = v∗

The diagonal elements of Λ+ are sorted in an ascending
order and the relations λ1 = v∗
2, (30),
are inserted. In addition, Σ++(x), Σ+−(x) and Σ−+(x) are
depending on the spatial coordinate. Their entries ¯Ji j(x) are
bounded and either positive or negative on the whole domain,
depending on the sign of the corresponding ˆJi j. Applying the
transformation (51) to (54) on the boundary conditions (45)
and (46) yields

is applied to (42) yielding the transformed PDEs













w1t
w2t
w3t

+ Λ+













w1x
w2x
w3x

= Σ++(x)

w4t − Λ−w4x = Σ−+(x)

























w1
w2
w3

w1
w2
w3

+ Σ+−(x)w4, (55)

.

(56)

with

Λ+ =







v∗
2 0 0
0 λ3 0
0 0 v∗
1







,

Λ− = −λ4,


Σ++(x) =

Σ+−(x) =

Σ−+(x) =





(cid:104)

(cid:104)

0
¯J21(x)
¯J31(x) ¯J32(x)

¯J12(x) ¯J13(x)
¯J23(x)
0

0

¯J14(x) ¯J24(x) ¯J34(x)

¯J41(x) ¯J42(x) ¯J43(x)







,

,

(cid:105)T

(cid:105)

.

(57)

(58)

(59)

(60)

(61)

7













w1(0,t)
w2(0,t)
w3(0,t)

= ¯Q0w4(0,t),

(62)

w4(L,t) = ¯R1













w1(L,t)
w2(L,t)
w3(L,t)

+ ¯U(t)

(63)

with

¯Q0 =

−1







ˆQ0,







0 0 1

1 0 0

0 1 0


¯R1 = ˆR1

(cid:19)

L

ˆJ44
λ4

(cid:18) ˆJ22
v∗
e
2









0

−

0

0

0

−

(cid:19)

L

ˆJ44
λ4

(cid:18) ˆJ33
λ3

e

(cid:18) ˆJ11
v∗
e
1

(cid:19)

L

−

ˆJ44
λ4

0

0











.

(64)

In addition, the input given in (63) is deﬁned as

¯U(t) = e

−

ˆJ44
λ4

L ˆU(t).

(65)

All in all, the control design model is given by (55), (56), (62)
and (63). In Figure 3, the qualitative behavior of the control

dinate. In addition, both input transformations combined are

−
¯U(t) = e

ˆJ44
λ4

L 1
κ4

U(t)

and the inversion is given by

U(t) = κ4e

ˆJ44
λ4

L ¯U(t).

(69)

(70)

Since all transformations are invertible, the stability proper-
ties of the linearized model in density and velocity pertur-
bations and the UORM control design model are the same.

4 Full-state feedback control design

In the following, a full-state feedback control design for
the system of four coupled hyperbolic PDEs given by (55)
and (56) with boundary conditions (62) and (63) is carried
out in order to achieve ﬁnite time convergence to zero for
initial conditions wi(x, 0) ∈ L ∞[0, L]. The full-state feed-
back controller is designed by applying the backstepping
control design in [20]. The general idea is to transform the
coupled hyperbolic PDEs to a cascade target system. The
control law is chosen such that the instabilities in the sys-
tem are eliminated through the boundary conditions of the
target system. The states of the target system are denoted
as (α1, α2, α3, β )T . The kernels of the backstepping trans-
formation are denoted by K(x, ξ ) and L11(x, ξ ). Then, the
backstepping transformation is deﬁned as

α1(x,t) = w1(x,t),
α2(x,t) = w2(x,t),
α3(x,t) = w3(x,t),
β (x,t) = w4(x,t)




−

(cid:90) x

0

K(x, ξ )









where







w1(ξ ,t)
w2(ξ ,t)
w3(ξ ,t)



+ L11(x, ξ )w4(ξ ,t)





(71)
(72)
(73)

dξ ,

(74)

V −1,

(67)

(cid:104)

K(x, ξ ) =

k11(x, ξ ) k12(x, ξ ) k13(x, ξ )

(cid:105)

(75)

and L11(x, ξ ) are deﬁned on a triangular domain

T = {0 ≤ ξ ≤ x ≤ 1}.

(76)

The introduced kernels K(x, ξ ) and L11(x, ξ ) are unknown
and will be determined later on. Furthermore, the choice of
the target system is

(68)













α1t

α2t

α3t

= − Λ+













α1x

α2x

α3x

+ Σ++(x)













α1

α2

α3

8

Fig. 3. Schematic diagram of the control design model. The green
arrow indicates the location where the control input acts on the
system. The blue arrows represent the couplings between all four
states.

design model is illustrated. According to the sign of the
characteristic speeds, the propagation direction for each state
wi(x,t) is drawn in Figure 3. It shows that the control input
¯U(t) acts at the outlet of system, ﬁrst propagating upstream
and, after it is carried through the boundary condition at the
inlet of the investigated track section, affecting downstream
trafﬁc.

The summary of the two transformations is

= T −1(x)



















˜ρ1
˜v1
˜ρ2
˜v2

⇔



















˜ρ1
˜v1
˜ρ2
˜v2

= T (x)



















w1
w2
w3
w4

,

(66)



















w1
w2
w3
w4

where













T −1(x) =

T (x) = V

























ˆJ22
v∗
2

x

−
e

0

0
ˆJ11
v∗
1

x

−

e

0

0

0

0

0
ˆJ22
v∗
2

x

e

0

0

ˆJ11
v∗
1

x

e

0

0
ˆJ33
λ3

x

e

0

0

0

0

0
ˆJ33
λ3

x

−
e

0

0

0
ˆJ44
λ4

x

−

e


.











0

0

0

0

0
ˆJ44
λ4

x

e

The overall transformation law depends on the spatial coor-

+ Σ+−(x)β +

(cid:90) x

0

C+(x, ξ )







α1(ξ ,t)
α2(ξ ,t)
α3(ξ ,t)







dξ

(cid:90) x

+

0
βt =Λ−βx.

C−(x, ξ )β (ξ ,t)dξ ,

(77)

(78)

The coefﬁcients C+(x, ξ ) ∈ R3×3 and C−(x, ξ ) ∈ R3×1 are
deﬁned on the same triangular domain T and are deter-
mined later on. Besides, the boundary conditions of the tar-
get system are

kernel equations in matrix form become



















k11x
k12x
k13x
L11x










+

v∗
2 0 0 0
0 λ3 0 0
0 0 v∗
1 0
0 0 0 λ4



















k11ξ
k12ξ
k13ξ
L11ξ










=

0
− ¯J12(ξ )
− ¯J13(ξ ) − ¯J23(ξ )
− ¯J14(ξ ) − ¯J24(ξ ) − ¯J34(ξ )

− ¯J21(ξ ) − ¯J31(ξ ) − ¯J41(ξ )
− ¯J32(ξ ) − ¯J42(ξ )
− ¯J43(ξ )
0

0

0




























k11
k12
k13
L11

λ4










(87)













α1(0,t)
α2(0,t)
α3(0,t)

= ¯Q0β (0,t),

β (L,t) = 0.

(79)

(80)

with boundary condition at ξ = 0,

(cid:104)

¯Q011v∗
2

¯Q021λ3

¯Q031v∗

1 λ4

(cid:105)



















k11(x, 0)
k12(x, 0)
k13(x, 0)
L11(x, 0)

= 0,

(88)

The target system (77) to (80) converges to its equilibrium
at zero

and boundary conditions at ξ = x,

αe,i(x) ≡ βe(x) ≡ 0,

i = 1, 2, 3, t ≥ 0, x ∈ [0, L]

(81)

in the ﬁnite time

tF =

L
v∗
2

+

L
−λ4

.

(82)

The proof is given in Lemma 3.1 in [20]. It remains to com-
pute the kernels K(x, ξ ) and L11(x, ξ ), coefﬁcients C+(x, ξ )
and C−(x, ξ ) and the control input ¯U(t) such that the trans-
formation is completed and to show the existence of the ker-
nels. Deriving (74) with respect to space and time, inserting
the resulting derivatives and (62) in (78) yields the kernel
equations that determine K(x, ξ ) and L11(x, ξ ) after partial
integration. The kernel equations are given by four coupled
ﬁrst order hyperbolic PDEs as well as four boundary condi-
tions

−Λ−Kx(x, ξ ) + Kξ (x, ξ )Λ+ = − K(x, ξ )Σ++(ξ )

− L11(x, ξ )Σ−+(ξ ),

−Λ−L11x(x, ξ ) − L11ξ (x, ξ )Λ− = − K(x, ξ )Σ+−(ξ ),

K(x, 0)Λ+ ¯Q0 − L11(x, 0)Λ− = 0,

K(x, x)Λ+ + Λ−K(x, x) = − Σ−+(x).

(83)
(84)

(85)
(86)

k11(x, x) =

k12(x, x) =

k13(x, x) =

¯J41(x)
λ4 − v∗
2
¯J42(x)
λ4 − λ3
¯J43(x)
λ4 − v∗
1

,

,

.

(89)

(90)

(91)

As shown in Theorem 3.3 of [20], the kernel equations (83)
to (86) are a well-posed system of equations and thus there
exist unique solutions K(x, ξ ) and L11(x, ξ ) in L∞(T ).
Moreover, solving the equations (84) and (85) with the
method of characteristics yields

L11(x, ξ ) = −

1
λ4

K(x − ξ , 0)Λ+ ¯Q0

(cid:90) − ξ
λ4

+

0

K(λ4ν + x, λ4ν + ξ )Σ+−(λ4ν + ξ )dν.

(92)

Inserting this result in the remaining PDEs (83) reduces the
kernel equations to three coupled ﬁrst order hyperbolic PDEs
with three boundary conditions

0 =λ4Kx(x, ξ ) + Λ+Kξ (x, ξ ) + K(x, ξ )Σ++(ξ )
K(x − ξ , 0)Λ+ ¯Q0Σ−+(ξ )

−

1
λ4

(cid:90) − ξ
λ4

+

0

K(λ4ν + x, λ4ν + ξ )Σ+−(λ4ν + ξ )dνΣ−+(ξ )

Inserting expressions for Λ−, K(x, ξ ), Λ+, Σ++(ξ ), Σ−+(ξ ),
Σ+−(ξ ) and denoting the entries of ¯Q0 = (cid:8) ¯Q0i1
(cid:9)
1≤i≤3, the

0 =K(x, x)Λ+ + Λ−K(x, x) + Σ−+(x)

9

(93)
(94)

Furthermore, deriving (71) to (73) with respect to space and
time and inserting the obtained derivatives, (74) and (55)
in (77) yields

and the control law after applying the inverse input trans-
formation (70) becomes

C−(x, ξ ) = Σ+−(x)L(x, ξ ) +

(cid:90) x

C−(x, s)L(s, ξ )ds,

(95)

U(t) = −κ4e

ˆJ44
λ4

L ¯R1T −1

u

(L)

C+(x, ξ ) = Σ+−(x)K(x, ξ ) +

C−(x, s)K(s, ξ )ds.

(96)

ξ
(cid:90) x

ξ

Finally, inserting (63) and (80) in (74) evaluated at x = L
delivers

− κ4e

L (cid:90) L

ˆJ44
λ4

0

K(L, ξ )T −1

u

(ξ )



















ρ1(L,t) − ρ ∗
1
v1(L,t) − v∗
1
ρ2(L,t) − ρ ∗
2
v2(L,t) − v∗
2









ρ1(ξ ,t) − ρ ∗
1
v1(ξ ,t) − v∗
1
ρ2(ξ ,t) − ρ ∗
2
v2(ξ ,t) − v∗
2











dξ







¯U(t) = − ¯R1



w1(L,t)
w2(L,t)
w3(L,t)








+

(cid:90) L

0

K(L, ξ )









w1(ξ ,t)
w2(ξ ,t)
w3(ξ ,t)









+ L11(L, ξ )w4(ξ ,t)





dξ

(97)

and therefore determines the control input. Before the results
of the controller design are summarized in a theorem, the
control law is formulated in dependence of the original phys-
ical variables, i.e. the densities and velocities of both classes.
For that reason, the transformation matrix T −1(x), (67), is
separated in two parts

− κ4e

L (cid:90) L

ˆJ44
λ4

0

L11(L, ξ )T −1

l

(ξ )








ρ1(ξ ,t) − ρ ∗
1
v1(ξ ,t) − v∗
1
ρ2(ξ ,t) − ρ ∗
2
v2(ξ ,t) − v∗
2










dξ (101)

using the deﬁnitions of the perturbations (10) and (11). The
result is now summarized in the following theorem.

Theorem 1 Trafﬁc density and velocity perturbations
( ˜ρ1, ˜ρ2, ˜v1, ˜v2)T governed by the linearized two-class AR
trafﬁc model (12), with the boundary conditions (22) to (24)
and (38) as well as initial proﬁles

˜ρ1(x, 0), ˜v1(x, 0), ˜ρ2(x, 0), ˜v2(x, 0) ∈ L ∞ ([0, L]) ,

(102)

converge to the equilibrium at zero

˜ρe,1(x) ≡ ˜ve,1(x) ≡ ˜ρe,2(x) ≡ ˜ve,2(x) ≡ 0

(103)

T −1(x) =

(cid:34)

(cid:35)

,

T −1
u
T −1
l

(x)

(x)

(98)

in ﬁnite time tF given by (82), if the control law (101) is
applied. Thereby, the kernels K(x, ξ ) and L11(x, ξ ) are ob-
tained by solving the kernel equations (93) and (94) on the
triangular domain (76) and using (92) afterwards.

where T −1
l
of the UORM control design model can be formulated as

(x) ∈ R1×4. Hence, the states

(x) ∈ R3×4 and T −1

u

The full-state feedback law in (101) requires measurements
of the densities and velocities of both classes at every spatial
point. In practice, it is possible to measure the densities and
velocities at every spatial point by installing trafﬁc cameras,
collecting GPS data or helicopter data recordings.













w1(ξ ,t)
w2(ξ ,t)
w3(ξ ,t)

= T −1
u

(ξ )

w4(L,t) = T −1

l

(ξ )





































˜ρ1(ξ ,t)
˜v1(ξ ,t)
˜ρ2(ξ ,t)
˜v2(ξ ,t)

˜ρ1(ξ ,t)
˜v1(ξ ,t)
˜ρ2(ξ ,t)
˜v2(ξ ,t)

,

(99)

5 Anti-collocated boundary observer design

The installation of trafﬁc cameras or the gain of GPS data
in order to supply the full-state feedback control (101) with
the required in-domain measurements is expensive. There-
fore, a boundary observer design for full-state observation
is proposed. In this work, an anti-collocated boundary ob-
server is designed, i.e. the densities and velocities of both
classes are measured at the opposite of the boundary where
the control input acts. Therefore, it is assumed that only the

(100)

10

trafﬁc density and velocity of both classes at the inlet of the
track section

error system

y1(t) = ρ1(0,t),
y2(t) = v1(0,t),
y3(t) = ρ2(0,t),
y4(t) = v2(0,t)

(104)
(105)
(106)
(107)













˜w1t
˜w2t
˜w3t







= − Λ+





+ Σ++(x)

˜w1x
˜w2x
˜w3x

˜w1
˜w2
˜w3
+ Σ+−(x) ˜w4 − P+(x) ˜w4(0,t),















are measured. In terms of the control design model coordi-
nates, inserting the measurements in (66) yields that

¯y(t) = w4(0,t)

(108)

is known.

The observer states ( ˆw1, ˆw2, ˆw3, ˆw4)T are estimates of the
control design model states (w1, w2, w3, w4)T . Thus, the ob-
server equations become













ˆw1t
ˆw2t
ˆw3t







= − Λ+





+ Σ++(x)

ˆw1x
ˆw2x
ˆw3x

ˆw1
ˆw2
ˆw3
− P+(x)( ˆw4(0,t) − w4(0,t))















+ Σ+−(x) ˆw4

(109)

ˆw4t =Λ− ˆw4x + Σ−+(x)













ˆw1
ˆw2
ˆw3

− P−

11(x)( ˆw4(0,t) − w4(0,t))

(110)

where the gains of the output injections P+(x) and P−
11(x)
need to be designed. The boundary conditions of the ob-
server are













ˆw1(0,t)
ˆw2(0,t)
ˆw3(0,t)

= ¯Q0w4(0,t),

(111)

ˆw4(L,t) = ¯R1













ˆw1(L,t)
ˆw2(L,t)
ˆw3(L,t)

+ ¯U(t).

(112)













˜w1
˜w2
˜w3

˜w4t =Λ− ˜w4x + Σ−+(x)

− P−

11(x) ˜w4(0,t)

with the boundary conditions













˜w1(0,t)
˜w2(0,t)
˜w3(0,t)

= 0,

˜w4(L,t) = ¯R1







˜w1(L,t)
˜w2(L,t)
˜w3(L,t)







.

(114)

(115)

(116)

(117)

Using the backstepping method, the output injection gains
can be designed such that the error system converges to the
equilibrium at zero in a ﬁnite time. Similar to the control
design, a target system and a backstepping transformation
are deﬁned in the observer design as well. The output injec-
tions gains P+(x) and P−
11(x) are chosen such that the target
converges to its equilibrium at zero in ﬁnite time. The state
vector of the target system is denoted as ( ˜α1, ˜α2, ˜α3, ˜β )T and
the kernels introduced in the backstepping transformation
are M(x, ξ ) and N11(x, ξ ). Thus, the backstepping transfor-
mation is given by











=









˜w1(x,t)
˜w2(x,t)
˜w3(x,t)

˜α1(x,t)
˜α2(x,t)
˜α3(x,t)
˜w4(x,t) = ˜β (x,t) +

(cid:90) x

0







+

(cid:90) x

0

M(x, ξ ) ˜β (ξ ,t)dξ ,

(118)

N11(x, ξ ) ˜β (ξ ,t)dξ

(119)

As a next step, the system describing the dynamic behav-
ior of the error between the states and their estimations is
formulated. The estimation errors are deﬁned as

where

˜wi(x,t) = ˆwi(x,t) − wi(x,t),

i = 1, 2, 3, 4.

(113)

(cid:104)

M(x, ξ ) =

m11(x, ξ ) m21(x, ξ ) m31(x, ξ )

(cid:105)T

.

(120)

Subtracting the model equations of the control design
model (55), (56), (62) and (63) from the observer equa-
tions (109), (110), (111) and (112) yields the following

The kernels M(x, ξ ) and N11(x, ξ ) are deﬁned in the trian-
gular domain (76). In addition, the target system is deﬁned

11







boundary conditions at the outlet of error system and tar-
get system, (117) and (124), and inserting (118) evaluated
at x = L afterwards. Plugging in the expressions for Λ+,
M(x, ξ ), Λ−, Σ++(x), Σ+−(x) and Σ−+(x), yields the kernel
equations in matrix form:

as













˜α1t
˜α2t
˜α3t

= − Λ+













˜α1x
˜α2x
˜α3x

+ Σ++(x)







˜α1
˜α2
˜α3


+

(cid:90) x

0

D+(x, ξ )







˜α1(ξ ,t)
˜α2(ξ ,t)
˜α3(ξ ,t)




˜α1
˜α2
˜α3

dξ ,





(121)

λ4

˜βt =Λ− ˜βx + Σ−+(x)









=

+

(cid:90) x

0

D−(x, ξ )













˜α1(ξ ,t)
˜α2(ξ ,t)
˜α3(ξ ,t)

dξ

(122)

with the boundary conditions













˜α1(0,t)
˜α2(0,t)
˜α3(0,t)

= 0,

˜β (L,t) = ¯R1







˜α1(L,t)
˜α2(L,t)
˜α3(L,t)







.

(123)

(124)

It can be shown that the target system converges in ﬁnite
time tF , given by (82). Besides, the coefﬁcients D+(x, ξ ) ∈
R3×3 and D−(x, ξ ) ∈ R1×3 still need to be determined in the
following.

The equations for the output injection gains P+(x) and
P−(x),
the kernels of the backstepping transformation
M(x, ξ ) and N11(x, ξ ) and the coefﬁcients in the target sys-
tem D+(x, ξ ) and D−(x, ξ ) need to be deduced in a next
step. The kernel equations for M(x, ξ ) and N11(x, ξ ) are

Mξ (x, ξ )Λ− − Λ+Mx(x, ξ ) = − Σ++(x)M(x, ξ )

N11ξ (x, ξ )Λ− + Λ−N11x(x, ξ ) = − Σ−+(x)M(x, ξ ),

− Σ+−(x)N11(x, ξ ), (125)
(126)




























+










m11ξ (x, ξ )
m21ξ (x, ξ )
m31ξ (x, ξ )
N11ξ (x, ξ )

v∗
2 0 0 0
0 λ3 0 0
0 0 v∗
1 0
0 0 0 λ4





























m11x(x, ξ )
m21x(x, ξ )
m31x(x, ξ )
N11x(x, ξ )


0

0
¯J21(x)
¯J31(x) ¯J32(x)
¯J41(x) ¯J42(x) ¯J43(x)

¯J12(x) ¯J13(x) ¯J14(x)
¯J23(x) ¯J24(x)
¯J34(x)
0

0

















m11(x, ξ )
m21(x, ξ )
m31(x, ξ )
N11(x, ξ )

with boundary conditions at x = ξ and x = L:

m11(ξ , ξ ) =

m21(ξ , ξ ) =

m31(ξ , ξ ) =

¯J14(ξ )
v∗
2 − λ4
¯J24(ξ )
λ3 − λ4
¯J34(ξ )
v∗
1 − λ4


,

,

,

N11(L, ξ ) = ¯R1











.

m11(L, ξ )
m21(L, ξ )
m31(L, ξ )








(129)

(130)

(131)

(132)

(133)

It can be shown that
the well-posedness of the kernel
equations (125) to (128) is equivalent to the kernel equa-
tions (83) to (86). In fact, a transformation is introduced
which achieves the exact same structure as the kernel equa-
tions which are developed during the full-state feedback
design. Similar to the full-state feedback design, solving the
PDE (126) and boundary condition (128) with the method
of characteristics delivers the expression

N11(x, ξ ) = ¯R1M(L, L − (x − ξ ))

(cid:90) x−L
λ4

+

0

Σ−+(−λ4ν + x)M(−λ4ν + x, −λ4ν + ξ )dν,

(134)

M(ξ , ξ )Λ− + Λ+M(ξ , ξ ) =Σ+−(ξ ),

N11(L, ξ ) − ¯R1M(L, ξ ) =0,

(127)
(128)

in dependence of M(x, ξ ). Inserting this result in (125) re-
duces the kernel equations to three PDEs and three boundary
conditions

where (125), (126) and (127) are obtained by inserting the
transformation (118) and (119) as well as derivatives with
respect to time and space of (118) and (119) in the PDEs of
the error system (114) and (115), followed by partial inte-
gration and noticing that ˜β (0,t) = ˜w(0,t). In addition, (128)
is deduced by evaluating (119) at x = L, plugging in the

0 = − Λ−Mξ (x, ξ ) + Λ+Mx(x, ξ ) − Σ++(x)M(x, ξ )

− Σ+−(x) ¯R1M(L, L − (x − ξ ))

−Σ+−(x)

(cid:90) x−L
λ4

0

Σ−+(x − λ4ν)M(x − λ4ν, ξ − λ4ν)dν,

(135)

12

0 =M(ξ , ξ )Λ− + Λ+M(ξ , ξ ) − Σ+−(ξ )

(136)

6 Output feedback control design

Besides,
tions (125) to (127) for M(x, ξ ) and N11(x, ξ ) implies

the computation that yields the kernel equa-

D+(x, ξ ) = − M(x, ξ )Σ−+(ξ ) +

(cid:90) x

ξ

M(x, s)D−(s, ξ )ds,

D−(x, ξ ) = − N11(x, ξ )Σ−+(ξ )
(cid:90) x

+

N11(x, s)D−(s, ξ )ds,

ξ

and

P+(x) = −λ4M(x, 0),
P−
11(x) = −λ4N11(x, 0).

(137)

(138)

(139)
(140)

Since the kernels M(x, ξ ) and N11(x, ξ ) are well-posed, (137)
to (140) imply that the output injection gains as well as the
target system coefﬁcients are well-posed, too. Thus, the ob-
server design is completed and is summarized in a theorem.

Theorem 2 The error states ( ˜w1, ˜w2, ˜w3, ˜w4)T between the
observer (109) to (112) and control design model (55) to (63)
are described by (114) to (117). If the output injections gains
P+(x) and P−
11(x) are chosen as (139) and (140), where the
kernel M(x, ξ ) is obtained by the well-posed equations (135)
and (136) and N11(x, ξ ) by (134), and the initial error pro-
ﬁles are assumed to be

˜wi(x, 0) ∈ L ∞ ([0, L]) ,

i = 1, 2, 3, 4,

(141)

then the errors converge to the equilibrium at zero

˜we,i(x) ≡ 0,

i = 1, 2, 3, 4

(142)

in the ﬁnite time tF given by (82).

The estimates of the observer ( ˆw1, ˆw2, ˆw3, ˆw4)T can be trans-
formed to the estimates of the density and velocity pertur-
bations ( ˆ˜ρ1, ˆ˜v1, ˆ˜ρ2, ˆ˜v2)T of both vehicle classes according to

So far, a full-state feedback, that requires measurements of
all states at every spatial point and damps out stop-and-go
trafﬁc, and an observer, that generates estimates of all states
at every spatial point based on a measurement at the inlet
of the track section, has been designed. In a ﬁnal step, both
results are combined resulting in an output feedback control
that damps out stop-and-go trafﬁc based on a single mea-
surement at the inlet of the track section. Therefore, the con-
trol law (101) is reformulated in terms of the generated esti-
mates. This is done by replacing the densities and velocities
by their estimates yielding the output feedback controller

U(t) = −κ4e

ˆJ44
λ4

L ¯R1T −1

u

(L)










− κ4e

L (cid:90) L

ˆJ44
λ4

0

K(L, ξ )T −1

u

(ξ )










ˆρ1(L,t) − ρ ∗
1
ˆv1(L,t) − v∗
1
ˆρ2(L,t) − ρ ∗
2
ˆv2(L,t) − v∗
2









ˆρ1(ξ ,t) − ρ ∗
1
ˆv1(ξ ,t) − v∗
1
ˆρ2(ξ ,t) − ρ ∗
2
ˆv2(ξ ,t) − v∗
2











dξ

− κ4e

L (cid:90) L

ˆJ44
λ4

0

L11(L, ξ )T −1

l

(ξ )








ˆρ1(ξ ,t) − ρ ∗
1
ˆv1(ξ ,t) − v∗
1
ˆρ2(ξ ,t) − ρ ∗
2
ˆv2(ξ ,t) − v∗
2










dξ (146)

where the estimates ( ˆρ1, ˆv1, ˆρ2, ˆv2) are obtained by trans-
forming the state vector of the anti-collocated observer (109)
to (112) according to (143), (144) and (145), the transfor-
mation matrices T −1
(·) are given by (98), the
l
kernel K(x, ξ ) is the solutions of (93) and (94) and L11(x, ξ )
is given by (92). Finally, the abbreviation κ4 is introduced
in (49). This combination of the results obtained by the ﬁrst
two theorems is summarized in a ﬁnal third theorem.

(·) and T −1

u



















ˆ˜ρ1
ˆ˜v1
ˆ˜ρ2
ˆ˜v2

= T (x)










.










ˆw1
ˆw2
ˆw3
ˆw4

(143)

Theorem 3 The linearized two-class AR model is given
by (12) with the assumptions (22) to (24) and (38) as bound-
ary conditions. If the control law (146) is applied in (38),
where the estimates are generated by the anti-collocated ob-
server (109) to (112) with the transformed control law (69)
as input and transformation (143), (144) and (145) after-
wards, and the initial proﬁles satisfy

Furthermore, the estimates of the original state variables are
obtained by

˜ρ1(x, 0), ˜v1(x, 0), ˜ρ2(x, 0), ˜v2(x, 0) ∈ L ∞ ([0, L]) ,

(147)

ˆρi(x,t) = ˆ˜ρi(x,t) + ρ ∗
i ,
ˆvi(x,t) = ˆ˜vi(x,t) + v∗
i

(144)
(145)

then the perturbations converge to the equilibrium at zero

˜ρe,1(x) ≡ ˜ve,1(x) ≡ ˜ρe,2(x) ≡ ˜ve,2(x) ≡ 0

(148)

with respect to the estimates of the densities and velocities
( ˆρ1, ˆv1, ˆρ2, ˆv2).

in the ﬁnite time 2tF , where tF is given by (82). The ker-
nels K(x, ξ ) and L11(x, ξ ) are obtained by solving the well-

13

Table 1
Simulation parameters.

Name

Symbol Value Unit

posed kernel equations (93), (94) and using (92) and the ob-
server gains are given by (139) and (140), where the kernels
M(x, ξ ) represents the solution of the well-posed system of
equations (135) and (136) and N11(x, ξ ) is given by (134).

As a ﬁnal comment, the ﬁnite convergence time is twice as
large as the time proposed in the previous theorems, because
it requires tF to obtain correct state estimates and afterwards
the control needs another tF to achieve convergence of the
state variable to equilibrium state.

7 Numerical simulation

Relaxation time

Pressure exponent

Free-ﬂow velocity

Maximum AO

In the end, the performance of the full-state feedback and
output feedback control is investigated by simulation. The
linearized model equations (12) are approximated by using
an Upwind scheme. In order to achieve numerical stability,
the grid sizes for the spatial coordinate and time are chosen
such that the Courant-Friedrichs-Lewy condition,

(cid:12)
(cid:12)
(cid:12)
(cid:12)

λi∆t
∆x

(cid:12)
(cid:12)
(cid:12)
(cid:12)

≤ 1,

i = 1, 2, 3, 4,

(149)

Occupied surface per vehicle

Equilibrium density

Track width

Track length

Amount of grid points

τ1

τ2

γ1

γ2
V1
V2
AO1
AO2
a1
a2
ρ ∗
1
ρ ∗
2
W

L

N

30

60

2.5

2

80

60

0.9

0.85

10

40

150

75

6.5

1000

40

s

s

1

1
km
h
km
h
1

1
m2
m2
veh
km
veh
km
m

m

1

is satisﬁed for all four characteristic speeds. The assumed
parameter values are stated in Table 1. In addition, the type
of vehicles that are represented by the vehicle classes are de-
noted in Table 2. Typically, it holds that the larger the vehi-
cle size the larger the relaxation time which is why τ1 < τ2.
Since vehicle class 1 corresponds to smaller and faster aver-
age vehicles, the free-ﬂow velocity V1 is higher than V2 and
the highway needs to be occupied in a greater extent such
that the average vehicles become jammed, i.e. AO1 > ¯AO2.
Furthermore, it is assumed that faster and smaller vehicles
experience less trafﬁc pressure for low AO values and there-
fore γ1 > γ2. Finally, the equilibrium densities are chosen
such that the investigated trafﬁc is in the congested regime.
The equilibrium velocities are determined by the choice
of the equilibrium densities and result in v∗
h and
2 ≈ 20 km
v∗
1 and v∗
2 seem to be low, the equi-
librium velocities are realistic in case of congested trafﬁc
which is evenly distributed. The initial proﬁles represent
stop-and-go trafﬁc with oscillations in density and velocity
of sinusoidal shape. The mean value of the oscillations are
the equilibrium values. At spatial points where the densities
of both classes are increased, their velocities are decreased
and thus the proﬁles

h . Although v∗

1 ≈ 38 km

Table 2
Trafﬁc classes with length and width of each vehicle.

Name

Class number

Length Width

Average vehicle

Big trucks

1

2

5 m

10 m

2 m

4 m

density of the corresponding vehicle class, whereas the plot
on the right hand side illustrates the velocity. The values
of the states at the outlet of the track section are marked
with a red line, whereas the blue line emphasizes the initial
proﬁles (150). The four plots indicate that the stop-and-go
oscillations do not vanish without the inﬂuence of control.
Next, the Figures 6 and 7 illustrate the simulation results for
the same initial condition but with activated full-state feed-
back control. The green line marks the ﬁnite convergence
time tF ≈ 237 s. Thus, it is easy to see that the convergence
to the constant equilibrium proﬁle in tF is achieved. Finally,
Figure 8 and Figure 9 show the simulation results for the
initial proﬁles using the designed output feedback control.
Since the observer requires tF to estimate the states without
error and afterwards the controller needs tF to achieve ﬁnite
time convergence, the total ﬁnite convergence time is now
2tF ≈ 474 s and therefore green line is adjusted accordingly.

ρi(x, 0) = ρ ∗

i +

sin

vi(x, 0) = v∗

i −

sin

ρ ∗
i
4
v∗
i
4

(cid:18) 4π
L
(cid:18) 4π
L

(cid:19)

,

i = 1, 2,

(150)

x

(cid:19)

x

,

i = 1, 2

(151)

8 Concluding remarks

are assumed as initial proﬁles.
The simulation results of the open loop simulation are il-
lustrated in Figure 4 for vehicle class 1 and in Figure 5
for vehicle class 2. In each ﬁgure, the left plot shows the

This work leads to further problems that may be explored
in the future. First, it is typically preferred that the measure-
ment for the observer is at the same spot where the control
input acts on the system. Therefore, the design of the collo-
cated observer is a result of great interest. In addition, the

14

Fig. 4. Trafﬁc density and velocity of class 1 without control.

Fig. 5. Trafﬁc density and velocity of class 2 without control.

Fig. 6. Trafﬁc density and velocity of class 1 with full-state feedback control. The green line indicates tF .

15

Fig. 7. Trafﬁc density and velocity of class 2 with full-state feedback control. The green line indicates tF .

Fig. 8. Trafﬁc density and velocity of class 1 with output feedback control. The green line indicates 2tF .

Fig. 9. Trafﬁc density and velocity of class 2 with output feedback control. The green line indiciates 2tF .

16

extended AR trafﬁc model presented in [25] is formulated
for n classes and there are results for n + m heterodirectional
behaving linear PDEs in the literature which enables the ex-
tension to more than two classes and hence even more real-
istic considerations. Especially the deﬁnition of the conges-
tion boundary in case of three or more classes would be an
interesting result. Finally, a combination of the results pre-
sented in this work with the results regarding two lanes [39]
is of interest for further research.

Acknowledgements

Mark Burkhardt acknowledges ﬁnancial support through the
Baden-W¨urttemberg Stipendium of the Baden-W¨urttemberg
Stiftung. In addition, he would like to thank Professor Oliver
Sawodny for organizing the collaboration with Huan Yu
and Miroslav Krstic. Furthermore, he acknowledges Kevin
Schmidt for his help within fruitful discussions while this
work was carried out.

References

[1] Arasan, V. T., & Dhivya, G.

trafﬁc density.

(2008, December). Measuring
International
heterogeneous
Conference on Sustainable Urban Transport and Environment, World
Academy of Science, Engineering and technology, Bangkok (Vol. 36,
p. 342).

In Proceedings of

[2] Athol,

P.

(1963).

characteristics within
Surveillance Project.

Interdependence
a moving

of
trafﬁc

operational
certain
stream. Expressway

[3] Auriol, J., & Di Meglio, F. (2016). Minimum time control of
heterodirectional linear coupled hyperbolic PDEs. Automatica, 71,
300-307.

[4] Aw, A. A. T. M., & Rascle, M. (2000). Resurrection of “second
order” models of trafﬁc ﬂow. SIAM journal on applied mathematics,
60(3), 916-938.

[5] Belletti, F., Huo, M., Litrico, X., & Bayen, A. M. (2015). Prediction
of trafﬁc convective instability with spectral analysis of the Aw-
Rascle-Zhang model. Physics Letter A, 379(38), 2319-2330.

[6] Benzoni-Gavage, S., & Colombo, R. M. (2003). A $n$-populations
model for trafﬁc ﬂow. European Journal of Applied Mathematics,
14(5), 587-612.

[7] B¨urger, R., Mulet P., & Villada, L. M.

(2013). A diffusively
corrected multiclass Lighthill-Whitham-Richards trafﬁc Model with
anticipation lengths and reaction times. Advances
in Applied
Mathematics and Mechanics, 5(5), 728-758.

[8] Chaniut, S., & Buisson, C. (2003). Macroscopic model and its
numerical solution for two-ﬂow mixed trafﬁc with different speeds
and lengths. Transportation research record, 1852(1), 209-219.

[9] Daganzo, C. F.

second-order ﬂuid
(1995). Requiem for
approximations of trafﬁc ﬂow. Transportation Research Part B:
Methodological, 29(4), 277-286.

[10] Deutscher, J. (2017). Backstepping Design of Robust State Feedback
Regulators for Linear 2 × 2 Hyperbolic Systems. IEEE Transactions
on Automatic Control, 62(10), 5240-5247.

[11] Deutscher, J. (2017). Finite-time output regulation for linear 2 × 2
hyperbolic systems using backstepping. Automatica, 75, 54-62.

[12] Deutscher,

J.

for
general linear heterodirectional hyperbolic systems with spatially-
varying coefﬁcients. Automatica, 85, 34-42.

regulation

(2017).

Output

[13] Di Meglio, F., Kaasa, G. O., Petit, N., & Alstad, V. (2011, June).
Slugging in multiphase ﬂow as a mixed initial-boundary value
problem for a quasilinear hyperbolic system. In Proceedings of the
2011 American Control Conference (pp. 3589-3596). IEEE.

[14] Di Meglio, F., Vazquez, R., Krstic, M., & Petit, N. (2012, June).
Backstepping stabilization of an underactuated 3×3 linear hyperbolic
system of ﬂuid ﬂow equations. In 2012 American Control Conference
(ACC) (pp. 3365-3370). IEEE.

[15] Di Meglio, F., Vazquez, R., & Krstic, M. (2013). Stabilization of
a system of n + 1 coupled ﬁrst-order hyperbolic linear PDEs with
a single boundary input. IEEE Transactions on Automatic Control,
58(12), 3097-3111.

[16] Fan, S., & Work, D. B. (2015). A heterogeneous multiclass trafﬁc
ﬂow model with creeping. SIAM Journal on Applied Mathematics,
75(2), 813-835.

[17] Greenshields, B. D., Channing, W., & Miller, H. (1935). A study of
trafﬁc capacity. In Highway research board proceedings (Vol. 1935).
National Research Council (USA), Highway Research Board.

[18] Gupta, A. K., & Katiyar, V. K. (2007). A new multi-class continuum

model for trafﬁc ﬂow. Transportmetrica, 3(1), 73-85.

[19] Hu, L., & Di Meglio, F. (2015, July). Finite-time backstepping
boundary stabilization of 3x3 hyperbolic systems. In 2015 European
Control Conference (ECC) (pp. 67-72). IEEE.

[20] Hu, L., Di Meglio, F., Vazquez, R., & Krstic, M. (2016). Control
linear coupled
of homodirectional and general heterodirectional
hyperbolic PDEs. IEEE Transactions on Automatic Control, 61(11),
3301-3314.

[21] Jiang, R., & Wu, Q. S. (2004). Extended speed gradient model for
mixed trafﬁc. Transportation research record, 1883(1), 78-84.

[22] Lighthill, M. J., & Whitham, G. B. (1955). On kinematic waves
II. A theory of trafﬁc ﬂow on long crowded roads. Proceedings of
the Royal Society of London. Series A. Mathematical and Physical
Sciences, 229(1178), 317-345.

[23] Logghe, S. (2003). Dynamic modeling of heterogeneous vehicular
thesis, Faculty of Applied Science, Katholieke

trafﬁc. Ph.D.
Universiteit Leuven, Leuven.

[24] Mallikarjuna, C , & Rao, K. R. (2006). Area occupancy characteristics

of heterogeneous trafﬁc. Transportmetrica, 2(3), 223-236.

[25] Mohan, R., & Ramadurai, G. (2017). Heterogeneous trafﬁc ﬂow
modelling using second-order macroscopic continuum model. Physics
Letters A, 381(3), 115-123.

[26] Nair, R., Mahmassani, H. S., & Miller-Hooks, E. (2011). A porous
ﬂow approach to modeling heterogeneous trafﬁc in disordered
systems. Procedia-Social and Behavioral Sciences, 17, 611-627.

[27] Ngoduy, D., & Liu, R. (2007). Multiclass ﬁrst-order simulation
model to explain non-linear trafﬁc phenomena. Physica A: Statistical
Mechanics and its Applications, 385(2), 667-682.

[28] Payne, H. J.

(1971). Models of

freeway trafﬁc and control.

Mathematical Models of Public Systems.

[29] Richards, P. I. (1956). Shock waves on the highway. Operations

research, 4(1), 42-51.

[30] Su, L., Wang, J. M., & Krstic, M. (2018). Boundary Feedback
Stabilization of a Class of Coupled Hyperbolic Equations With
Nonlocal Terms. IEEE Transactions on Automatic Control, 63(8),
2633-2640.

[31] Tang, C. F., Jiang, R., Wu, Q. S., Wiwatanapataphee, B., & Wu,
Y. H. (2007). Mixed trafﬁc ﬂow in anisotropic continuum model.
Transportation Research Record, 1999(1), 13-22.

[32] Tang, T. Q., Huang, H. J., Zhao, S. G., & Shang, H. Y. (2009). A
new dynamic model for heterogeneous trafﬁc ﬂow. Physics Letters
A, 373(29), 2461-2466.

17

[33] Van Lint, J. W. C., Hoogendoorn, S. P., & Schreuder, M. (2008).
Fastlane: New multiclass ﬁrst-order trafﬁc ﬂow model. Transportation
Research Record, 2088(1), 177-187.

[34] Vazquez, R., Coron, J. M., Krstic, M., & Bastin, G.

(2011,
December). Local exponential H 2 stabilization of a 2 × 2 quasilinear
hyperbolic system using backstepping. In 2011 50th IEEE Conference
on Decision and Control and European Control Conference (pp.
1329-1334). IEEE.

[35] Vazquez, R., Krstic, M., & Coron, J. M.

(2011, December).
Backstepping boundary stabilization and state estimation of a 2 × 2
linear hyperbolic system. In 2011 50th IEEE Conference on Decision
and Control and European Control Conference (pp. 4937-4942).
IEEE.

[36] Whitham, G. B. (2011). Linear and nonlinear waves (Vol. 42). John

Wiley & Sons.

[37] Wong, G. C. K., & Wong, S.C. (2002). A multi-class trafﬁc ﬂow
model - an extension of LWR model with heterogeneous drivers.
Transportation Research Part A: Policy and Practice, 36(9), 827-841.

[38] Yu, H., & Krstic, M. (2018, November). Varying Speed Limit Control
of Aw-Rascle-Zhang Trafﬁc Model. In 2018 21st International
Conference on Intelligent Transportation Systems (ITSC)(pp. 1846-
1851). IEEE.

[39] Yu, H., & Krstic, M. (2018, December). Trafﬁc Congestion Control
on Two-lane Aw-Rascle-Zhang Model. In 2018 IEEE Conference on
Decision and Control (CDC) (pp. 2144-2149). IEEE.

[40] Yu, H., & Krstic, M. (2019). Trafﬁc congestion control for Aw-

Rascle-Zhang model. Automatica, 100, 38-51.

[41] Zhang, H. M. (2002). A non-equilibrium trafﬁc model devoid of
gas-like behavior. Transportation Research Part B: Methodological,
36(3), 275-290.

[42] Zhang, H. M., & Jin, W. L. (2002). Kinematic wave trafﬁc ﬂow
model for mixed trafﬁc. Transportation Research Record, 1802(1),
197-204.

[43] Zhang, L., & Prieur, C. (2017). Necessary and sufﬁcient conditions
on the exponential stability of positive hyperbolic systems. IEEE
Transactions on Automatic Control, 62(7), 3610-3617.

[44] Zhang, P., Liu, R. X., Wong, S. C., & Dai, S. Q. (2006). Hyperbolicity
and kinematic waves of a class of multi-population partial differential
equations. European Journal of Applied Mathematics, 17(2), 171-
200.

18

