Draft version August 9, 2018
Typeset using LATEX twocolumn style in AASTeX61

HARD X-RAY CONSTRAINTS ON SMALL-SCALE CORONAL HEATING EVENTS

Andrew J. Marsh,1, 2 David M. Smith,2 Lindsay Glesener,3 James A. Klimchuk,4 Stephen J. Bradshaw,5
Juliana Vievering,3 Iain G. Hannah,6 Steven Christe,4 Shin-nosuke Ishikawa,7 and S¨am Krucker8, 9

1NextEra Energy Resources, Juno Beach, FL 33408, USA
2Santa Cruz Institute for Particle Physics and Department of Physics, University of California, Santa Cruz, CA 95064, USA
3School of Physics & Astronomy, University of Minnesota Twin Cities, Minneapolis, MN 55455, USA
4NASA Goddard Space Flight Center, Solar Physics Lab., Greenbelt, MD 20771, USA
5Department of Physics and Astronomy, Rice University, Houston, TX 77005, USA
6SUPA School of Physics & Astronomy, University of Glasgow, Glasgow G12 8QQ, UK
7Institute of Space and Astronautical Science, Japan Aerospace Exploration Agency
8Space Sciences Laboratory University of California, Berkeley, CA 94720, USA
9University of Applied Sciences and Arts Northwestern Switzerland, 5210, Windisch, Switzerland

ABSTRACT

Much evidence suggests that the solar corona is heated impulsively, meaning that nanoﬂares may be ubiquitous
in quiet and active regions (ARs). Hard X-ray (HXR) observations with unprecedented sensitivity >3 keV are now
enabled by focusing instruments. We analyzed data from the Focusing Optics X-ray Solar Imager (FOXSI) rocket and
the Nuclear Spectroscopic Telescope Array (NuSTAR) spacecraft to constrain properties of AR nanoﬂares simulated
by the EBTEL ﬁeld-line-averaged hydrodynamics code. We generated model X-ray spectra by computing diﬀerential
emission measures for homogeneous nanoﬂare sequences with heating amplitudes H0, durations τ , delay times between
events tN , and ﬁlling factors f . The single quiescent AR observed by FOXSI-2 on 2014 December 11 is well ﬁt by
nanoﬂare sequences with heating amplitudes 0.02 erg cm−3 s−1 < H0 < 13 erg cm−3 s−1 and a wide range of delay
times and durations. We exclude delays between events shorter than ∼900 s at the 90% conﬁdence level for this region.
Three of ﬁve regions observed by NuSTAR on 2014 November 1 are well ﬁt by homogeneous nanoﬂare models, while
two regions with higher ﬂuxes are not. Generally, the NuSTAR count spectra are well ﬁt by nanoﬂare sequences with
smaller heating amplitudes, shorter delays, and shorter durations than the allowed FOXSI-2 models. These apparent
discrepancies are likely due to diﬀerences in spectral coverage between the two instruments and intrinsic diﬀerences
among the regions. Steady heating (tN = τ ) was ruled out with >99% conﬁdence for all regions observed by either
instrument.

Keywords: Sun: X-rays, Sun: ﬂares, Sun: corona, NuSTAR

8
1
0
2

g
u
A
8

]

R
S
.
h
p
-
o
r
t
s
a
[

1
v
0
3
6
2
0
.
8
0
8
1
:
v
i
X
r
a

Corresponding author: David M. Smith
dsmith8@ucsc.edu

 
 
 
 
 
 
2

1. INTRODUCTION

It has been known for nearly eighty years that the
solar corona is signiﬁcantly hotter than the solar pho-
tosphere (Grotrian 1939; Edl´en 1943). However, a com-
plete explanation of this temperature gap has been dif-
ﬁcult to achieve. While signiﬁcant progress has been
made in recent years, it is still unclear what the en-
ergetic contributions of diﬀerent physical mechanisms
such as waves, reconnection, and spicules are (Klimchuk
2015; Parnell & De Moortel 2012).

Two primary physical mechanisms are thought to con-
tribute to high coronal temperatures: magnetic recon-
nection of stressed ﬁeld lines and dissipation of MHD
waves. Both involve heating on timescales much smaller
than the cooling time of individual magnetic strands,
and can therefore be characterized as impulsive heat-
ing (Klimchuk 2006). Parker (1988) coined the term
“nanoﬂare” to describe magnetic reconnection between
individual ﬂux tubes, a process that can lead to subse-
quent heating and particle acceleration. However, the
term is now widely used to describe impulsive heating
events acting on individual ﬂux tubes, in which cooling
timescales are longer than heating timescales, without
any preference for physical mechanism. As pointed out
by (Klimchuk 2006), all plausible mechanisms of coronal
heating under realistic conditions predict that the heat-
ing is impulsive. This includes wave heating, whether
the waves are dissipated by resonance absorption, phase
mixing, or Alfvenic turbulence.

Nanoﬂares can be characterized by their volumetric
heating amplitude H0, duration τ , and characteristic
delay time between events tN . A signiﬁcant amount of
research has focused on the nanoﬂare heating frequency
(1/tN ) and how it compares to the characteristic cool-
ing time tcool of a loop strand. High-frequency heat-
ing occurs for tN << tcool, while low-frequency heat-
ing occurs for tN >> tcool. Steady heating is sim-
ply the limit as tN approaches 0.
If low-frequency
nanoﬂares are prevalent, they will produce hot (≥5 MK)
plasma throughout the solar corona. However, emis-
sion at these temperatures is diﬃcult to detect directly
for two reasons: only small amounts of this plasma are
predicted, and ionization non-equilibrium can prevent
the formation of spectral lines that would form at those
temperatures under equilibrium conditions (Golub et al.
1989; Bradshaw & Cargill 2006; Reale & Orlando 2008;
Bradshaw & Klimchuk 2011).

Field-aligned and ﬁeld-line-averaged hydrodynamic
simulations have been used to predict the diﬀerential
emission measure distributions DEM(T) = n2dh/dT
produced by nanoﬂares with a wide range of phys-
ical properties (Cargill 2014; Barnes et al. 2016a,b).

Here n is the plasma density, and dh/dT corresponds
to spatial variations in the temperature ﬁeld along a
particular line of sight.
In addition, the DEM dis-
tributions of active regions have been measured by
extreme ultraviolet (EUV) and soft X-ray (SXR) in-
struments including the Solar Dynamics Observatory’s
Atmospheric Imaging Assembly (AIA, Lemen et al.
2012), the Hinode X-Ray Telescope (XRT, Golub et al.
2007) and the Hinode EUV Imaging Spectrometer
In general these distri-
(EIS, Culhane et al. 2007).
butions peak close to 4 MK and fall oﬀ steeply at
higher and lower temperatures (Tripathi et al. 2011;
Warren et al. 2012; Schmelz & Pathak 2012). Cargill
(2014) and Cargill et al. (2015) found, through large
numbers of simulations, that nanoﬂare sequences with
delay times of hundreds to ∼2000 s (tN ∼ tcool) give
results that are consistent with AR observations.
In
addition, these studies found that delay times propor-
tional to the total nanoﬂare energy are required to
match the broad range of EM slopes found in previous
studies. Bradshaw & Viall (2016) created model active
regions heated by nanoﬂares and showed that the best
agreement with AR observations occurs for delay times
on the order of a loop cooling time (several thousand
seconds). Time-lag measurements of ARs at multiple
wavelengths have shown signs of widespread cooling and
are also consistent with tN values on the order of sev-
eral thousand seconds (Viall & Klimchuk 2012, 2017).
While active region observations with AIA, XRT, and
EIS can strongly constrain AR emission below ∼5 MK,
constraints are less stringent at higher temperatures
(Winebarger et al. 2012).

Hard X-ray (HXR) instruments can be used to de-
tect or constrain plasma at temperatures &5 MK. HXR
emission is not sensitive to ionization non-equilibrium
eﬀects, which can suppress line emission from high-
temperature plasmas. However, such plasma can still be
diﬃcult to detect because the temperature of a cooling,
post-nanoﬂare ﬂux tube peaks well before the luminos-
ity (which is proportional to the DEM in a given tem-
perature bin). Searches for hot plasma from nanoﬂares
have been performed during periods of low solar ac-
tivity, in order to avoid contamination from resolvable
ﬂares. Long duration, spatially-integrated observations
from the Reuven Ramaty High Energy Solar Spectro-
scopic Imager (RHESSI , Lin et al. 2002) the Solar PHo-
tometer IN X-rays (SphinX, Sylwester et al. 2008), the
X-123 spectrometer and the EUNIS rocket experiment
have all shown evidence of plasma at T >5 MK during
non-ﬂaring times (McTiernan 2009; Miceli et al. 2012;
Caspi et al. 2015; Brosius et al. 2014). The combina-
tion of XRT and RHESSI was used to set constraints

on a high-temperature component in active regions by
Reale et al. (2009) and Schmelz et al. (2009). Large un-
certainties in these analyses prevented a deﬁnitive de-
tection; although RHESSI is more responsive to high-
temperature plasma than the instruments on Hinode, it
lacks the sensitivity to reliably obtain images and spec-
tra from non-ﬂaring active regions.

Improved sensitivity and dynamic range can be ob-
tained at energies >3 keV by the use of HXR focus-
ing optics. This technology has enabled direct imag-
ing of HXR photons in place of the indirect images ob-
tained by previous instruments such as RHESSI . The
Focusing Optics X-ray Solar Imager (FOXSI) sounding
rocket payload uses focusing optics to image the Sun
with much higher sensitivity and dynamic range than
RHESSI (Glesener et al. 2016). FOXSI has ﬂown twice
(in 2012 and 2014) and is expected to ﬂy again in 2018.
The Nuclear Spectroscopic Telescope Array (NuSTAR)
is a NASA Astrophysics Small Explorer launched on
2012 June 13 (Harrison et al. 2013). While it was not
designed to observe the Sun, NuSTAR has successfully
done so on thirteen occasions without any damage to the
instrument; for a summary of the ﬁrst four solar point-
ings see Grefenstette et al. 2016. Both FOXSI and NuS-
TAR have been used to perform imaging spectroscopy
of active regions and to set limits on hot plasma in
those regions (Ishikawa et al. 2014; Hannah et al. 2016;
Ishikawa et al. 2017).

In this paper we use active region observations from
NuSTAR and FOXSI-2 to constrain the physical proper-
ties of nanoﬂares, particularly their heating amplitudes,
durations, and delay times. We utilize NuSTAR and
FOXSI-2 datasets that were analyzed in Hannah et al.
(2016) and Ishikawa et al. (2017), respectively. We de-
scribe solar observations with these instruments in §2,
discuss our analysis methods in §3, present our results
in §4, and describe our conclusions and future work in
§5.

2. SOLAR OBSERVATIONS WITH NuSTAR AND

FOXSI

NuSTAR has two co-aligned X-ray optics focused
onto two focal plane detector arrays (FPMA & FPMB),
with a ﬁeld-of-view of ∼12′×12′ and a half-power di-
ameter of ∼65′′ (Madsen et al. 2015). NuSTAR is
well calibrated over the 3–79 keV bandpass, and the
lower energy bound can be extended to 2.5 keV if
there is suﬃcient ﬂux present. NuSTAR has suc-
cessfully observed active regions (Grefenstette et al.
2016; Hannah et al. 2016; Kuhar et al. 2017), the quiet
Sun (Marsh et al. 2017), and small (GOES class <A1)
solar ﬂares (Glesener et al. 2017; Wright et al. 2017;

NuSTAR 2−4 keV
SDO/AIA 94Å

D1

3

L1

L2

D2

L3

400

600

800
X (arcsecs)

1000

1200

NuSTAR AR D1

FPMA

FPMB

EM = (3.5±1.0)x1046 cm-3
EM = (3.5±1.0)x1046 cm-3

T = 3.3±0.1 MK
T = 3.3±0.1 MK

EM = (1.9±0.5)x1046 cm-3
EM = (1.9±0.5)x1046 cm-3

T = 3.6±0.1 MK
T = 3.6±0.1 MK

2.5

3.0

3.5
Energy (keV)

4.0

4.5

5.0

)
s
c
e
s
c
r
a
(

Y

200

0

−200

−400

−600

10000

1000

100

10

1
-
V
e
k

1
-
s

s
t
n
u
o
C

1
2.0

Figure 1. (Top) Combined EUV and HXR image of ﬁve
active regions observed by NuSTAR on 2014 November 1,
with an eﬀective HXR exposure time of 3.11 s. NuSTAR 2–
4 keV ﬂux contours (5, 10, 25, 50, and 80%) from the FPMA
telescope are overlaid in yellow on a co-temporal AIA 94 ˚A
image. The NuSTAR image is co-aligned with the AIA data
′′
and smoothed (7
Gaussian smoothing). White boxes are
the areas used for this analysis. (Bottom) NuSTAR count
spectra from the FPMA and FPMB telescopes for one of the
on-disk active regions (D1) observed on 2014 November 1.
The ﬁt energy range is shown by the dashed box. Isother-
mal ﬁt parameters and uncertainties are given in the upper
right corner. As shown in this paper, there are a wide vari-
ety of energy distributions (going far beyond this isothermal
model) that can well ﬁt these data.

Kuhar et al. 2018) with unprecedented sensitivity. Sum-
mary plots of all NuSTAR observations can be found at
https://ianan.github.io/nsigh_all/. Of particular
interest to us are quiescent active region observations on
2014 November 1, described in detail by Hannah et al.

 
 
 
 
 
 
 
 
 
4

(2016). Figure 1 shows NuSTAR 2–4 keV contours
overlaid on a co-temporal AIA 94 ˚A image of ﬁve active
regions seen during this campaign. Two of the observed
regions (D1 and D2) were fully on-disk, while the other
three (L1, L2, and L3) were partially occulted. Count
spectra from both NuSTAR telescopes, as well as the
corresponding isothermal ﬁts, are shown in Figure 1 for
one of these regions (D1). The other ARs had isothermal
ﬁt temperatures from 3–4.5 MK and emission measures
from 1046–1047 cm−3.

FOXSI is a sounding rocket payload that uses focus-
ing optics to directly image solar photons between 4–
20 keV. FOXSI has ﬂown twice from White Sands, New
Mexico and has observed small solar ﬂares, active re-
gions, and the quiet Sun. We analyzed non-ﬂaring AR
data from the second FOXSI ﬂight on 2014 December
11 (Glesener et al. 2016). FOXSI-2 targeted several ar-
eas of the Sun during the course of its 6.5 minute ﬂight,
including an active region near disk center (NOAA AR
12234) that was quiescent for the duration of this ob-
servation. Figure 2 shows FOXSI-2 4–15 keV contours
integrated over the exposure time (38.5 s) and overlaid
on a co-temporal AIA 94 ˚A image. Also shown is a
FOXSI-2 count spectra of AR 12234 with 1.0 keV bins
integrated over the observing period. Data from four Si
detectors (Det 0, Det 1, Det 5, and Det 6) are included
in this ﬁgure. The spectrum from the detector with the
greatest response (Det 6) is ﬁt well by an isothermal
plasma with temperature T = 11.3 MK and emission
measure EM = 6.0×1043 cm−3, at a reduced chi-squared
value of 0.95. While the count ﬂuxes from this active
region are fairly low, there is clear evidence for the pres-
ence of plasma &10 MK within the uncertainties of the
spectral ﬁt. The iron line complex at 6.7 keV is a well-
known indicator of temperatures above 8 MK (Phillips
2004). A full diﬀerential emission measure (DEM) anal-
ysis of this active region with FOXSI-2 and Hinode has
been performed by Ishikawa et al. (2017). That paper
uses multi-wavelength observations to provide the most
direct detection to date of >10 MK plasma in a non-
ﬂaring solar active region. In this work, we attempt to
characterize the impulsive heating parameters that may
have produced this emission.

We wish to emphasize that we start with isother-
mal ﬁts only to show the traditional way of analyzing
HXR data, and to emphasize the diﬀerent sensitivities
of the two instruments.
In general, we do not expect
these active regions to contain only a single tempera-
ture, as there is a broad base of literature ﬁnding mul-
tithermal distributions in active regions. Furthermore,
the FOXSI -2 active region has been demonstrated by
Ishikawa et al. (2017) to be multithermal when consid-

)
s
c
e
s
c
r
a
(

Y

150

100

50

0

10.000

1
−
V
e
k

1
−
s

s
t
n
u
o
C

1.000

0.100

0.010

0.001

4

SDO/AIA 94Å
FOXSI 4−15 keV

−150

−100

−50

0

X (arcsecs)

FOXSI−2 AR 12234

EM = (3.0±1.7)x1043 cm−3
EM = (3.0±1.7)x1043 cm−3

T = 11.3±1.0 MK
T = 11.3±1.0 MK

6

8

10

Energy (keV)

Figure 2. (Top) FOXSI-2 4–15 keV HXR contours from
Det 6 overlaid on a co-temporal AIA image of AR 12234.
The FOXSI-2 contours have been chosen to show 30, 50, 70,
and 90% of the maximum value, and the FOXSI-2 eﬀective
exposure time is 38.5 s. (Bottom) FOXSI-2 count spectra of
AR 12234 from 4 Si detectors; the Det 6 spectrum is plotted
as a solid line and the Det 0, Det1, and Det 5 spectra are
plotted with dashed lines.
(The optic/detector pairs have
diﬀerent responses.) The best-ﬁt isothermal T, EM, and 1-
sigma uncertainties for the Det 6 spectrum are written on the
plot, and the ﬁt range is marked by the dashed box. This
spectrum was integrated over an exposure time of 38.5 s. As
shown in Ishikawa et al. (2017), a multithermal model gives
a better ﬁt than this isothermal approach when considering
FOXSI and Hinode/XRT data combined.

ering Hinode/XRT data alongside the FOXSI -2 data;
temperatures of at least 3–15 MK were found. An
isothermal ﬁt to a multithermal temperature distribu-
tion picks out the temperature to which the instrument
is the most sensitive. The very diﬀerent temperatures
found by FOXSI -2 and NuSTAR for the two active re-

 
 
 
 
 
 
 
 
gions could be due to intrinsic diﬀerences in the active
regions themselves, or in the sensitivities of the two in-
struments, which measure peak rates in diﬀerent energy
ranges (2–2.5 keV for NuSTAR; 4–5 keV for FOXSI-2 ).
In this paper, we institute no constraint on the multi-
thermal nature of the plasma and accept any nanoﬂare
distribution that can well ﬁt the observed data.

3. METHODS

3.1. Physical Parameters and Their Selection

We simulated homogeneous nanoﬂare sequences,
in which every nanoﬂare is
identical and evenly
spaced, with the Enthalpy-Based Thermal Evolution of
Loops (EBTEL) ﬁeld-line-averaged hydrodynamics code
(Klimchuk et al. 2008; Cargill et al. 2012a,b). EBTEL
is widely used in the solar physics community, and model
outputs have been benchmarked against ﬁeld-aligned
numerical codes such as HYDRAD (Bradshaw & Cargill
2013). An updated version, ebtel++1, improves upon
the original IDL code by incorporating two-ﬂuid hydro-
dynamic equations and modifying certain parameters to
produce better agreement with ﬁeld-aligned simulations
(Barnes et al. 2016a). The new code also provides an
adaptive timestep routine that ensures the timestep is
always suﬃciently small compared to the timescales of
the relevant physical processes (for more details, see
the appendices of Barnes et al. 2016a). Subsequently,
for short heating timescales and large heating rates
It also runs faster than
ebtel++ is more accurate.
the IDL code, and signiﬁcantly reduced our computing
time. When we refer to “EBTEL” hereafter we are
referring to ebtel++. In our simulations only the elec-
trons are heated; future work will include ion heating,
as in Barnes et al. (2016a).

EBTEL accepts a user-deﬁned time array, heating
function (a homogeneous nanoﬂare sequence for this
analysis), and loop half-length L as inputs, then sub-
sequently calculates the loop-averaged pressure, density,
and temperature at each time step. The input heating is
the ﬁeld-line-averaged volumetric heating rate. We note
that the spatial dependence of the heating is not gen-
erally important, since coronal thermal conduction and
ﬂows are so eﬃcient at spreading the energy along ﬁeld
lines. EBTEL also computes the diﬀerential emission
measure separately in the transition region (TR) and
corona, for a loop strand with cross-sectional area A = 1
cm2. This area is a default area for the computation and
is not the actual area of a loop or strand. We chose to
use a triangular heating function for all our simulations.

1 https://rice-solar-physics.github.io/ebtelPlusPlus/

Active Region

AR 12234

NuSTAR D1

NuSTAR D2

NuSTAR L1

NuSTAR L2

NuSTAR L3

5

Loop Half-Length (cm)
6×109
7×109
7×109
7×109
1×1010
7×109

Table 1. Table of estimated loop lengths for the ﬁve NuS-
TAR and single FOXSI-2 active regions. These lengths were
calculated from the manual selection of loop footpoints in
AIA 171 ˚A images.

The pulse height is the heating amplitude H0 in erg
cm−3 s−1 and the width is the event duration τ in sec-
onds. The delay tN is the time between the start of each
heating event. In addition, we included a constant, low-
level background heating of 3.5×10−5 erg cm−3 s−1 in
every simulation. This term prevents catastrophic cool-
ing of the loop strand at late times (Cargill & Bradshaw
2013), and is small enough that it otherwise has no ef-
fects on our results. The background heating on its own
heats the region to only <300,000 K and cannot account
for the few or several million degree temperature of the
active region.

Figure 3 shows heating functions and the correspond-
ing temperature evolution, time-averaged DEMs, and
HXR spectra for nanoﬂare sequences with tN = 500 s
(high-frequency) and tN = 5000 s (low-frequency) occur-
ing on a loop strand with a half-length L = 2×109 cm.
Low-frequency heating results in a DEM that extends
to higher temperatures and a harder photon spectrum
compared to high-frequency heating. This is because
low-frequency heating gives the loop strand more time to
cool and drain before the next event. The lower density
at the time of the next event means that the plasma can
be heated to a higher temperature. Note that, not only
do high-frequency nanoﬂares produce lower average tem-
peratures for the same average heating rate, but even for
events with the same heating amplitude and duration as
shown in Figure 5. Here the high-frequency nanoﬂare
sequence contains an order of magnitude higher average
heating rate than the low-frequency case.

The physical parameters that alter the X-ray spec-
trum are H0, τ , tN , L, and the ﬁlling factor f , a nor-
malization that reﬂects the fact that in a given volume
of the corona, only a certain fraction of loop strands may
be impulsively heated. We varied H0, τ , and tN across a
range of values for each active region to determine which
parameter combinations gave good agreement with ob-

6

)
1
−
s

3
−

m
c
g
r
e
(

e
t
a
R
g
n
i
t
a
e
H

0.06
0.05

0.04

0.03

0.02

0.01
0.00

0

2000

4000

6000

8000

10000

Time (s)

)
1
−
K
5
−

m
c
(

M
E
D

24
23

22

21

20

19
18

5.5

6.0

6.5
log T

7.0

7.5

)

K
M

(
e
r
u
t
a
r
e
p
m
e
T

25

20

15

10

5

0

0

)
1
−
V
e
k

1
−
s

2
−

m
c

h
p
(

x
u
F

l

103
102
101
100
10−1
10−2
10−3
10−4
2

2000

4000

6000

8000

10000

Time (s)

4

6
Energy (keV)

8

10

−3 s

Figure 3. EBTEL simulations of high-frequency (tN = 500 s) and low-frequency (tN = 5000 s) nanoﬂare heating in a single loop
−1, τ = 100 s, and L = 2×109 cm. Low-frequency values are indicated with solid lines and high-
strand with H0 = 0.05 erg cm
frequency values with dashed lines. Both nanoﬂare sequences were started 10000 s before the plotted times to erase the initial
plasma conditions. (Top left) Volumetric heating rate as a function of time. (Top right) Average loop temperature as a function
of time. (Bottom left) DEM distributions time-averaged over the last nanoﬂare cycle of each sequence. The discontinuity in
the high-frequency curve is the intersection of the coronal and TR DEM distributions. (Bottom right) Simulated X-ray spectra
derived from the time-averaged DEMs and integrated over a 60×60 arcsecond2 area.

servations. For each set of parameters we simulated a
sequence of ﬁve nanoﬂares and used the DEM values
from the last nanoﬂare cycle (starting with the heating
event and ending after one delay time). We used only
the last cycle in order to eliminate the initial EBTEL
plasma conditions. The shortest value of delay was set
to the longest value of duration to avoid overlapping
events; quasi-continuous heating occurs when the delay
and duration are exactly equal. In future work we will
explore the eﬀect of using non-homogeneous nanoﬂare
sequences where, for example, the delay varies as a func-
tion of nanoﬂare energy. The average loop half-length
L was estimated separately for each region with AIA
images using the following procedure.

The FOXSI-2 observation of AR 12234 took place
when this region was close to disk center. To estimate
the average coronal loop length, we measured the dis-
tances between several visible pairs of loop footpoints
in the AIA 171 ˚A channel. The regions observed by
NuSTAR on 2014 Nov 1 were near or over the solar
limb, which made it diﬃcult to measure the entire loops.
Therefore, we used AIA 171 ˚A images from 2014 Octo-

Physical Parameter
H0

τ

tN

Range of Tested Values
−1

0.005–25 erg cm

−3 s

5–500 s

500–10,000 s

Table 2. Range of physical parameters for simulated
nanoﬂare sequences.

ber 28 to calculate footpoint distances for these regions.
After we measured the average footpoint separations we
corrected for projection eﬀects by dividing each distance
by cos(λ), where λ is the central longitude of each re-
gion. We assumed semi-circular loop geometries and
determined the average half-lengths L=πd/4, where d
is the longitude-corrected average footpoint separation
for a given region. The loop length estimates for each
region are listed in Table 1.

When looking at an active region through the opti-
cally thin corona, all the loops in various stages of heat-
ing and cooling along a line-of-sight contribute to each
spatial pixel. Therefore we time-averaged the DEM dis-

 
 
 
 
 
 
 
 
 
 
 
7

response functions from either NuSTAR or FOXSI-2.
This allowed us to make straightforward comparisons
to the observed count spectra for any set of model pa-
rameters. For on-disk regions such as AR 12234 and
NuSTAR ARs D1 and D2, we expect a signiﬁcant con-
tribution from the transition region to the line-of-sight
plasma emission and therefore used the sum of DEMcor
and DEMtr. For oﬀ-limb regions such as NuSTAR ARs
L1, L2 and L3 we expect to see predominantly coronal
emission. Therefore for L1, L2, and L3 we used DEMcor
only.

We engaged in a systematic exploration of the
nanoﬂare parameter space for each active region. Pre-
vious active region observations with EUV and SXR in-
struments are consistent with nanoﬂare delay times that
range from hundreds to thousands of seconds (Cargill
2014) . In the case of reconnection-related nanoﬂares,
an event duration can be as short as the time that a
reconnecting ﬁeld line is in contact with a standing slow
shock in the Petschek model, which is of order seconds
(Klimchuk 2006).
It could also be signiﬁcantly longer
(up to hundreds of seconds) if, for example, multiple
reconnection events cluster together in space and time
(Klimchuk 2015). The heating amplitude is not well-
constrained theoretically, so we explored a wide range
of values starting from a lower limit approximately two
orders of magnitude above the background heating. The
full range of physical parameters that we chose to ex-
plore is given in Table 2. For every active region and
instrument response, we created a 4D datacube with log-
arithmically spaced values of the nanoﬂare parameters
H0, τ , and tN corresponding to the ﬁrst 3 dimensions.
The 4th dimension contained the model X-ray spectra
from the EBTEL simulations corresponding to each set
of parameter values. In order to reduce computational
overhead we generated count spectra for an 11×11×11
array of H0, τ , and tN , and then performed a 3D inter-
polation to obtain count spectra over an 101×101×101
array with the same minimum and maximum parameter
values.

We subsequently used the following procedure to gen-
erate 3D arrays containing the total likelihood for each
active region and instrument response. The total likeli-
hood is simply the product of individual likelihoods for
a particular pair of modeled and observed count spec-
tra (Bevington & Robinson 2003). For these spectra the
individual likelihoods are given by Poisson probabilities:

L =

n

Y
i=1

Li =

n

Y
i=1

e−µiµxi
i
xi!

(2)

Here µi is the number of counts in the ith energy bin
predicted by a particular nanoﬂare model and xi is the

Figure 4. This ﬁgure shows the geometry used to calculate
the number of loop strands within a particular observing
area, and subsequently to scale the simulated EBTEL DEM
from a single strand. The horizontal strand approximation
was made for the coronal portion only, and the transition
region footpoints were treated separately (as shown in Equa-
tion 1).

tributions for the last cycle of each EBTEL simulation;
this produced a superposition of every stage of heating
and cooling in that cycle, similar to what we expect
from observations. We assumed a ﬁxed coronal scale
height H = 5×109 cm in order to calculate the num-
ber of loop strands in a volume with cross-sectional area
equal to the area of a given action region. We then com-
puted model photon spectra by ﬁrst scaling each EBTEL
(time-averaged) DEM to an expected DEM observation
as follows:

DEM obs =

ℓ2H
2L

< DEM cor > +

ℓ2
2

< DEM tr > (1)

Here DEMcor and DEMtr are the EBTEL time-
averaged DEM distributions for the corona and transi-
tion region in cm−5 K−1, ℓ2 is the observing area in cm2,
H is the scale height, and L is the loop half-length for
the AR of interest. The multiplicative factors for each
term give the expected volumetric DEMobs (cm−3 K−1)
in a rectangular region of length and width ℓ, and the
spatial approximation of horizontal strands going up to
a height H is used (as shown in Figure 4) for the coronal
portion of each strand. The DEMtr is divided by a fac-
tor of two so that the footpoint emission is not doubly
counted, and is not scaled by H because the depth of
the transition region is independent of the coronal scale
height.

The HXR spectrum was derived from DEMobs by de-
termining the emission measure (EM, units of cm−3)
in each temperature bin of width log(T) = 0.01 between
log(T) = 4.0 and log(T) = 8.5, and calculating the corre-
sponding isothermal spectra. The resulting sum of every
individual spectrum was then convolved with instrument

8

)
s
(

n
o
i
t
a
r
u
D

500.0

199.1

79.2

31.5

12.6

5.0

Log(Likelihood) Map

Delay Map

)
s
(

n
o
i
t
a
r
u
D

500.0

199.1

79.2

31.5

12.6

5.0

−20

−30

−40

−50

−60

10000
4729

2236

1057
500

0.005 0.027 0.151 0.829 4.551 25.000
Heating (erg cm−3 s−1)

0.005 0.027 0.151 0.829 4.551 25.000
Heating (erg cm−3 s−1)

Log(Likelihood) Map

Duration Map

)
s
(

l

y
a
e
D

10000

5493

3017

1657

910

500

−20

−30

−40

−50

−60

)
s
(

l

y
a
e
D

10000

5493

3017

1657

910

500

500
158

50

16
5

0.005 0.027 0.151 0.829 4.551 25.000
Heating (erg cm−3 s−1)

0.005 0.027 0.151 0.829 4.551 25.000
Heating (erg cm−3 s−1)

Log(Likelihood) Map

Heating Map

)
s
(

n
o
i
t
a
r
u
D

500.0

199.1

79.2

31.5

12.6

5.0

−20

−30

−40

−50

−60

)
s
(

n
o
i
t
a
r
u
D

500.0

199.1

79.2

31.5

12.6

5.0

5.000
0.889

0.158

0.028
0.005

500

910

1657

3017

5493 10000

500

910

1657

3017

5493 10000

Delay (s)

Delay (s)

Figure 5. Parameter space results using combined data from four of the FOXSI-2 Si detectors (Det 0, Det 1, Det 5, and Det
6). (Left) 2D log likelihood intensity maps for each combination of H0, τ , and tN . (Right) Intensity maps of the optimized
third parameter corresponding to each 2D likelihood plot. Energy ﬂux constraints (Equation 4) and EUV/SXR limits from AIA
and XRT have been applied to the full parameter space. Both the likelihood and parameter maps were smoothed for display
purposes using the procedure described in the text. Solid lines in the left panels show 90% CIs and dotted lines show 99% CIs
for the case of 3 relevant parameters.

actual number of counts detected in that energy bin.
Because both NuSTAR and FOXSI-2 count individual
photons, we are free to choose our energy bins. The
energy ranges we chose for these likelihood calculations
were 2.5–5 keV for NuSTAR and 5–10 keV for FOXSI-
2, with bin widths of 0.2 and 1.0 keV respectively. We
chose to use the likelihood statistic instead of chi-square
because of the low number of counts in these ranges, in-
cluding zero counts in some energy bins. For each com-
bination of H0, τ , and tN we determined the value of
the ﬁlling factor f that resulted in the same cumulative
number of counts in the modeled and observed spectra
in the energy range of interest. This normalization of
f made it easier to determine what regions of parame-
ter space for the physical quantities of primary interest
(H0, τ , and tN ), resulted in the best agreement with
observations. We calculated µi separately for response
functions from the following instruments: the two NuS-

TAR telescopes (FPMA & FPMB) and four FOXSI-2
Si detectors (Det 0, Det 1, Det 5, and Det 6). Then we
computed total likelihood arrays for FOXSI-2 and NuS-
TAR by multiplying the individual detector arrays to-
gether. To visualize the parameter space we plotted 2D
log likelihood intensity maps for every combination of
H0, τ , and tN . For every 2D coordinate pair (e.g. heat-
ing and duration), we determined the maximum likeli-
hood in the 3rd dimension and the corresponding third
parameter value (e.g. delay).

In order to obtain parameter ranges that led to good
agreement with the observed HXR data, we generated
conﬁdence intervals (CIs) for every 2D coordinate pair
at 90% and 99% conﬁdence levels (Neyman 1937). For a
given conﬁdence level α, the CI represents values for the
population parameter(s) such that if an inﬁnite number
of CIs were constructed, a fraction α would contain the
true parameter value(s). In other words, there is an a

 
 
 
 
 
 
priori probability α that a single CI will contain the true
value of the parameter(s) of interest. Therefore a higher
conﬁdence level, e.g. 99% versus 90%, will lead to wider
conﬁdence intervals.

In our explorations of this parameter space we found
many sets of solutions that gave acceptable ﬁts to the
HXR data. This is not surprising given the multidi-
mensional nature of the parameter space and the de-
generacy between the various parameters (for example,
increasing either the heating amplitude or the event du-
ration increases the energy in a particular nanoﬂare and
also increases the predicted X-ray ﬂux). However, this
degeneracy made it critical to use as many external con-
straints as possible.

3.2. Constraints on the Nanoﬂare Parameter Space

It is generally accepted that mechanical motions in
and below the photosphere are the ultimate drivers of
coronal heating (Klimchuk 2006). The Poynting ﬂux as-
sociated with ﬂows stressing the footpoints of magnetic
ﬁelds is given by

F =

1
4π

B2

V Vhtan(θ)

erg cm

−2 s

−1

(3)

where BV is the vertical ﬁeld, Vh is the horizontal ve-
locity and θ is the ﬁeld tilt angle. Typical values ob-
served in active regions are ∼100 G and 1 km s−1.
Withbroe & Noyes (1977) calculated an average coro-
nal energy loss of 107 erg cm−2 s−1 in active regions,
which implies an average tilt angle θ ∼ 20 degrees. For
a given loop strand we do not expect the time-averaged
energy ﬂux to exceed 108 erg cm−2 s−1, as this would
imply signiﬁcantly larger photospheric velocities and/or
tilt angles, which can be ruled out observationally. This
ﬂux can be re-written in terms of the physical parame-
ters of a nanoﬂare sequence:

F =

H0τ L
2tN

erg cm

−2 s

−1

(4)

Recall that H0 is the nanoﬂare peak heating amplitude,
τ is the nanoﬂare duration, L is the loop half-length,
and tN is the delay between events. We implemented
the requirement throughout our analysis that the energy
ﬂux F < 108 erg cm−2 s−1.

We placed additional constraints on the nanoﬂare pa-
rameter space using co-temporal observations from AIA
and XRT. AIA data are available for the NuSTAR and
FOXSI-2 observations on 2014 November 1 and 2014
December 11 respectively, while XRT data is only avail-
able for the 2014 December 11 FOXSI-2 ﬂight. We ob-
tained active region ﬂuxes in DN s−1 pixel−1 for mul-
tiple AIA wavelengths (94, 131, 171, 193, 211, 335 ˚A)

9

FOXSI AR 12234
99% (Low H0)
90% (Low H0)
Max Likelihood
90% (High H0)
99% (High H0)

1
−
V
e
k

1
−
s

s
t
n
u
o
C

100.0

10.0

1.0

0.1

Energy (keV)

H0
(erg cm−3 s−1)

99% (Low H0)

90% (Low H0)

Max Likelihood

90% (High H0)

99% (High H0)

0.046

0.050

0.46

1.27

1.50

τ

(s)

50

50

50

50

50

tN

(s)

10000

10000

3611

2170

2374

10

f

0.62

0.42
3.2×10−4
8.0×10−6
5.2×10−6

Figure 6. FOXSI-2 Det 6 count spectrum of AR 12234
and predicted Det 6 spectra at ﬁve points in the optimized,
constrained heating vs. duration parameter space (Figure 5).
For a ﬁxed duration of τ = 50 s, we chose heating amplitudes
at the maximum likelihood as well as on the 90% and 99%
contours at lower and higher heating values. The heating
parameters corresponding to each curve are speciﬁed in the
table.

and multiple XRT ﬁlters (Be-thick, Al-thick, Ti-poly,
Al-mesh, Al-poly/Ti-poly, C-poly/Ti-poly, C-poly, Be-
thin, Be-med, Al-med, Al-poly). DN (datanumber) is
the native ﬂux unit of both instruments, and is propor-
tional to the number of electrons generated by photons
incident on the CCD cameras of each telescope. For
each nanoﬂare model we calculated predicted ﬂuxes for
the appropriate instrument response functions in every
waveband. We required the predicted AIA and XRT
ﬂuxes to be <3 times the spatially-averaged ﬂuxes for
the chosen AR, and if this requirement was not met for
every wavelength we excluded that model from our re-
sults. We did not set a lower limit on the EUV/SXR
ﬂuxes because additional populations of nanoﬂares (at
higher frequencies, for example) could be present at tem-
peratures below the NuSTAR and FOXSI-2 sensitivity.

4. RESULTS AND DISCUSSION

4.1. FOXSI-2 region

Figure 5 shows 2D log likelihood and parameter inten-
sity maps for FOXSI-2 observations of AR 12234, with
the nanoﬂare models subjected to physical (energy ﬂux)
and observational (EUV/SXR) constraints. For each

 
 
10

2D coordinate pair (e.g. H0, τ ), the third parameter
(e.g. tN ) was chosen such that it maximized the like-
lihood. Before this optimization, a Gaussian smooth-
ing kernel of width σ=1 pixel was applied to each 2D
slice (101x101 pixels) of the 3D likelihood array in or-
der to reduce visible interpolation artifacts. This also
resulted in a slight smoothing of the parameter maps in
the right panels. The black regions of parameter space
in the two upper left panels (H0 vs. τ and H0 vs. tN )
are regions where the combination of energy ﬂux and
AIA/XRT constraints eliminated every value in the 3D
array. The solid and dashed lines in the left panels indi-
cate the 90% and 99% CIs, relative to the maximum like-
lihood, for three relevant parameters (H0, τ , tN ). Avni
(1976) showed that for three parameters of interest the
90% (99%) signiﬁcance level is equivalent to an increase
in the unreduced chi-square value of 6.25 (11.3) relative
to the best ﬁt. Wilks (1938) provided a mapping from
chi-square to likelihood that allows us to plot likelihood
signiﬁcance levels: −2log(L/Lmax) = ∆χ2. For 90% CIs
where ∆χ2 = 6.25, the likelihood level at which we draw
contours is given by L = e−6.25/2Lmax = 0.044Lmax; for
99% CIs L = e−11.3/2Lmax = 0.0035Lmax.

Figure 6 shows the FOXSI-2 AR 12234 count spec-
trum from Det 6 compared to ﬁve spectral models taken
from the 2D heating/duration map. This ﬁgure shows
the distinctions between models taken from points in
parameter space at diﬀerent conﬁdence levels. We chose
to sample nanoﬂare models at the maximum likelihood,
as well as at lower and higher heating amplitudes on
the 90% and 99% contours, for a ﬁxed duration. The
parameters for these sampled models are shown in the
table below the spectrum.

FOXSI−2 AR 12234

No Limits
Energy Limit
AIA/XRT Limits

5•105
4•105

3•105

2•105

1•105

y
c
n
e
u
q
e
r
F

0
−10

−8

−6

−4

0
Log(Fill Factor)

−2

2

4

Figure 7. Histograms of the ﬁll factor for the FOXSI-2 AR
and three diﬀerent sets of constraints: no limits, energy ﬂux
limits, and AIA/XRT limits.

At the 99% conﬁdence level there is only a 1% a priori
probability that the parameters of interest fall outside
the corresponding CIs; therefore we used this conﬁdence

level to estimate the acceptable parameter ranges for
each active region. From the upper left panel of Fig-
ure 5, we can see that heating amplitudes between 0.02
and 13 erg cm−2 s−1 are required for good agreement
with the FOXSI-2 count spectra. The nanoﬂare du-
ration and delay are essentially unconstrained for this
AR, although delays < 900 s result in slightly poorer
ﬁts and are excluded by the 90% CIs. Steady heat-
ing (the top left corner of the delay vs. duration plot)
is ruled out by the 99% CI. The delays in the best-
ﬁt regions of parameter space for this region, while
unconstrained at long values, are consistent with pre-
vious studies of simulated emission measure distribu-
tions (Cargill 2014), observations of transient Fe XVIII
brightenings (Ugarte-Urra & Warren 2014), and time-
lag studies (Viall & Klimchuk 2017). The exclusion of
steady heating models is also consistent with these and
other studies.

Figure 7 shows histograms of the ﬁlling factor, nor-
malized for each model, with no limits, energy ﬂux lim-
its, and AIA/XRT limits applied. Without any con-
straints, there is a wide range of allowed ﬁlling factors
due to the normalization procedure described in Sec-
tion 3. When energy and observational constraints are
applied the range of acceptable ﬁlling factors is signiﬁ-
cantly reduced; most importantly, non-physical values of
f >> 1 are eliminated. Large (unphysical) ﬁlling factors
result in extremely large DEMs and predicted ﬂuxes at
EUV/SXR wavelengths, and are therefore ruled out by
AIA/XRT constraints. Extremely small ﬁlling factors
are ruled out by the energy ﬂux constraint because the
parameter combinations which require tiny normaliza-
tions are nanoﬂare sequences with extremely large en-
ergy ﬂuxes. While f is diﬃcult to constrain observa-
tionally, the range of allowed ﬁlling factors for nanoﬂare
models of this active region (10−7–1) is reasonable.

4.2. NuSTAR regions AR D1, L1

Figure 8 shows log likelihood intensity maps and the
corresponding optimized parameter maps for two of the
NuSTAR-observed active regions (D1, L1), using data
from both telescopes and with energy and EUV/SXR
constraints imposed. Unlike the FOXSI-2 results, the
NuSTAR likelihood maps were smoothed after opti-
mization using a Gaussian kernel of width σ=1 pixel
(the parameter maps are unsmoothed). Once again, the
black regions of parameter space in the two upper left
panels are regions where energy ﬂux and AIA/XRT con-
straints eliminated every parameter combination. The
shapes of the conﬁdence contours are noticeably dif-
ferent for these regions than for AR 12234.
In ad-
dition, the absolute likelihoods for the NuSTAR ARs

11

)
s
(

n
o
i
t
a
r
u
D

500.0

199.1

79.2

31.5

12.6

5.0

Log(Likelihood) Map

Delay Map

D1

−50
−100
−150
−200
−250
−300

)
s
(

n
o
i
t
a
r
u
D

500.0

199.1

79.2

31.5

12.6

5.0

D1

3000

1917

1225

783

500

0.005 0.027 0.151 0.829 4.551 25.000
Heating (erg cm−3 s−1)

0.005 0.027 0.151 0.829 4.551 25.000
Heating (erg cm−3 s−1)

Log(Likelihood) Map

Duration Map

)
s
(

l

y
a
e
D

10000

5493

3017

1657

910

500

D1

−50
−100
−150
−200
−250
−300

)
s
(

l

y
a
e
D

10000

5493

3017

1657

910

500

D1

200.0

79.5

31.6

12.6

5.0

0.005 0.027 0.151 0.829 4.551 25.000
Heating (erg cm−3 s−1)

0.005 0.027 0.151 0.829 4.551 25.000
Heating (erg cm−3 s−1)

Log(Likelihood) Map

Heating Map

500.0

199.1

79.2

31.5

12.6

5.0

−50
−100
−150
−200
−250
−300

D1

)
s
(

n
o
i
t
a
r
u
D

500.0

199.1

79.2

31.5

12.6

5.0

D1

0.500

0.158

0.050

0.016

0.005

500

910

1657

3017

5493 10000

500

910

1657

3017

5493 10000

Delay (s)

Log(Likelihood) Map

500.0

199.1

79.2

31.5

12.6

5.0

L1

−50
−100
−150
−200
−250
−300

)
s
(

n
o
i
t
a
r
u
D

500.0

199.1

79.2

31.5

12.6

5.0

Delay (s)

Delay Map

L1

3000

1917

1225

783

500

)
s
(

n
o
i
t
a
r
u
D

)
s
(

n
o
i
t
a
r
u
D

0.005 0.027 0.151 0.829 4.551 25.000
Heating (erg cm−3 s−1)

0.005 0.027 0.151 0.829 4.551 25.000
Heating (erg cm−3 s−1)

Log(Likelihood) Map

Duration Map

)
s
(

l

y
a
e
D

10000

5493

3017

1657

910

500

L1

−50
−100
−150
−200
−250
−300

)
s
(

l

y
a
e
D

10000

5493

3017

1657

910

500

L1

200.0

79.5

31.6

12.6

5.0

0.005 0.027 0.151 0.829 4.551 25.000
Heating (erg cm−3 s−1)

0.005 0.027 0.151 0.829 4.551 25.000
Heating (erg cm−3 s−1)

Log(Likelihood) Map

Heating Map

)
s
(

n
o

i
t

a
r
u
D

500.0

199.1

79.2

31.5

12.6

5.0

−50
−100
−150
−200
−250
−300

L1

)
s
(

n
o

i
t

a
r
u
D

500.0

199.1

79.2

31.5

12.6

5.0

L1

0.500

0.158

0.050

0.016

0.005

500

910

1657

3017

5493 10000

500

910

1657

3017

5493 10000

Delay (s)

Delay (s)

Figure 8. Parameter space results for two NuSTAR-observed active regions (D1 and L1) using combined data from both
telescopes (FPMA & FPMB). (Left) 2D log likelihood intensity maps for each combination of H0, τ , and tN . (Right) Intensity
maps of the optimized third parameter corresponding to each 2D likelihood plot. Energy ﬂux constraints (Equation 4) and
EUV/SXR limits from AIA and XRT have been applied to the full parameter space. The likelihood maps were smoothed for
display purposes using a Gaussian kernel of width σ=1 pixel. Solid lines in the left panels show 90% CIs and dotted lines show
99% CIs for the case of 3 relevant parameters.

 
 
 
 
 
 
 
 
 
 
 
 
12

1000

1
−
V
e
k

1
−
s

s
t
n
u
o
C

100

10

NuSTAR AR D1
99% (Low H0)
90% (Low H0)
Max Likelihood
90% (High H0)
99% (High H0)

1
2.5

3.0

3.5
4.0
Energy (keV)

4.5

5.0

H0
(erg cm−3 s−1)

99% (Low H0)

90% (Low H0)

Max Likelihood

90% (High H0)

99% (High H0)

0.025

0.027

0.039

0.13

0.14

τ

(s)

12.6

12.6

12.6

tN

(s)

500

500

617

f

0.29

0.22

0.13

12.6

2237

0.093

12.6

2237

0.069

Figure 9. NuSTAR FPMA count spectrum of AR D1 and
and simulated FPMA spectra at ﬁve points in the optimized,
constrained heating vs. duration parameter space (Figure 8).
For a ﬁxed duration τ = 12.6 s, we chose heating amplitudes
at the maximum likelihood as well as on the 90% and 99%
contours at lower and higher heating values. The heating
parameters corresponding to each curve are speciﬁed in the
table.

are smaller than the FOXSI-2 likelihoods due to higher
counts ﬂuxes and more data points. However, this does
not mean the NuSTAR ﬁts are poorer quality, just that
the data are more constraining.

Figure 9 shows the NuSTAR FPMA spectrum of D1
compared to models drawn from the heating/duration
2D parameter space, similar to Figure 6. The param-
eters for these sampled models are shown in the table
below the spectrum.

We used the 99% CI curves to determine ranges of
H0, τ and tN for ARs D1 and L1. Heating amplitudes
H0 < 0.32 erg cm−3 s−1 and H0 < 0.23 erg cm−3 s−1
were required for good agreement with the D1 and L1
count spectra, respectively. These maximum values are
almost two orders of magnitude smaller than the max-
imum heating amplitude for AR 12234, which is likely
due to the cooler temperatures of the NuSTAR ARs
(isothermal T ∼ 4 MK compared to T ∼ 11 MK). Inter-
estingly, D1 (L1) is ﬁt well by models with tN < 5000 s
(7500 s), again in contrast to AR 12234 (for which the
best ﬁts occurred at tN > 900 s). The duration is lim-
ited to τ < 415 s for D1 and τ < 275 s for L1. Even
though L1 is a limb region, its likelihood and parameter

maps look very similar to those of D1 and D2 (see next
section).

4.3. NuSTAR regions D2, L2, L3

Figure 11 shows the log likelihood intensity maps and
corresponding heat maps for AR D2, an on-disk region.
These maps and the CIs are fairly similar to those for
D1 and L1. This is an unsurprising result because of the
HXR spectral similarity between these regions, which
were ﬁt by isothermal temperatures from 3.1–4.1 MK
and maximum count ﬂux values of ∼103 counts s−1
keV−1 at 2.5 keV (see Figure 3 of Hannah et al. 2016).
For this region, heating values H0 > 0.25 erg cm−3 s−1
are outside the 99% CIs and do not yield good ﬁts for any
combination of duration and delay. Delays tN < 3300 s
are preferred, as are durations τ < 300 s. The 99% con-
tours for this region are generally thinner than the same
contours for ARs D1 and L1, which is most likely due
to spectral diﬀerences. Separate ﬁts to spectra from the
two NuSTAR telescopes gave isothermal temperatures
that diﬀered by 0.9 MK for D2, compared to tempera-
ture diﬀerences of 0.3 and 0.2 MK for D1 and L1, re-
spectively. The diﬀerences between these count spectra
placed more stringent requirements on nanoﬂare models
to give acceptable ﬁts to both telescopes simultaneously.
The large discrepancy for D2 was a result of its posi-
tion at the edge of the NuSTAR detectors and pointing
diﬀerences between FPMA and FPMB (Hannah et al.
2016).

Figure 12 shows the log likelihood intensity maps and
corresponding heat maps for L2 and L3, two limb re-
gions. In contrast to the three aforementioned regions,
ARs L2 and L3 were brighter and hotter (with isother-
mal ﬁt temperatures between 4.1 and 4.4 MK and max-
imum count ﬂux values of ∼104 counts s−1 keV−1 at
2.5 keV). The increased number of counts in these spec-
tra placed stronger constraints on the model nanoﬂare
spectra and resulted in smaller absolute likelihoods for
each model (compare the likelihood colorbars from Fig-
ures 11 and 12).
In addition, this made interpolation
eﬀects much more noticable. The gaps and other struc-
tures in Figure 12 are due to the interpolation of the
counts ﬂux arrays, and make it more diﬃcult to deter-
mine accurate parameter ranges for these regions. For-
tunately the 99% CIs are fairly smooth for both these
regions, and yield the following constraints for L2 and
L3: H0 < 0.27 erg cm−3 s−1 and H0 < 0.42 erg cm−3
s−1, tN < 1980 s and tN < 1650 s, and τ < 456 s and τ
unconstrained respectively.

Figure 10 shows ﬁll factor histograms for every NuS-
TAR AR with no constraints, energy ﬂux constraints,
and AIA constraints (no XRT data was available for

 
 
NuSTAR AR D1

No Limits
Energy Limit
AIA Limits

2.5•105
2.0•105

1.5•105

1.0•105

5.0•104

y
c
n
e
u
q
e
r
F

2.5•105
2.0•105

1.5•105

1.0•105

5.0•104

y
c
n
e
u
q
e
r
F

13

NuSTAR AR D2

No Limits
Energy Limit
AIA Limits

0
−10

−8

−6

−4

0
Log(Fill Factor)

−2

2

4

0
−10

−8

−6

−4

0
Log(Fill Factor)

−2

y
c
n
e
u
q
e
r
F

3.0•105
2.5•105
2.0•105
1.5•105
1.0•105
5.0•104
0
−10

NuSTAR AR L1

No Limits
Energy Limit
AIA Limits

−8

−6

−4

0
Log(Fill Factor)

−2

2.5•105
2.0•105

1.5•105

1.0•105

5.0•104

y
c
n
e
u
q
e
r
F

y
c
n
e
u
q
e
r
F

3.0•105
2.5•105
2.0•105
1.5•105
1.0•105
5.0•104
0
−10

NuSTAR AR L3

No Limits
Energy Limit
AIA Limits

2

4

0
−10

−8

−6

−4

0
Log(Fill Factor)

−2

NuSTAR AR L2

No Limits
Energy Limit
AIA Limits

−4

0
Log(Fill Factor)

−2

−8

−6

2

4

2

4

2

4

Figure 10. Histograms of the ﬁll factor for the 5 NuSTAR-observed ARs and three diﬀerent sets of constraints: no limits,
energy ﬂux limits, and AIA limits.

this campaign). Just as in the FOXSI-2 histograms,
large (unphysical) ﬁlling factors are ruled out by ob-
servational constraints and very small ﬁlling factors are
ruled out by the energy ﬂux constraint. The allowed
range of f for these regions is approximately 10−6–1,
values which are all physically plausible.

5. CONCLUSIONS

We modeled homogeneous sequences of nanoﬂares
with variable heating amplitudes, durations, delays, and
ﬁlling factors and compared their synthetic spectra to
HXR AR spectra from NuSTAR and FOXSI-2 ob-
servations, ﬁrst presented in Hannah et al. (2016) and
Ishikawa et al. (2017) respectively. We were able to gen-
erate good ﬁts for the FOXSI-2 HXR data, subject to
energetic and observational constraints, using homoge-
neous nanoﬂare sequences with a wide range of dura-
tions and delays. Although tN is unconstrained at the
99% level, the best ﬁts occur for tN > 900 s in agree-
ment with previous AR studies that did not utilize HXR
data. The heating amplitudes required to ﬁt the FOXSI-
2 data are relatively high (0.02–13 erg cm−2 s−1), most

likely because the count spectra correspond to the high-
temperature (∼11 MK) tail of the AR DEM. The ﬁt
quality is relatively insensitive to the nanoﬂare dura-
tion, which can vary from τ < 5 s to τ > 500 s (beyond
the range of our analysis).

For the cooler regions (characteristic temperature 3–
4 MK) observed by NuSTAR, the instrument count
ﬂuxes are higher and therefore the absolute likelihoods
are smaller. However, a fairly wide range of homoge-
neous nanoﬂare models yield good ﬁts to the data (Fig-
ure 9). The shapes of the likelihood CIs for the NuSTAR
ARs are fairly similar to each other and set limits on H0,
τ , and tN from above, not from below. The H0 vs. τ
CI contours follow an approximate power-law, just like
the FOXSI-2 CI contours but for smaller values of both
parameters. On the other hand, the CI contours for the
other NuSTAR likelihood maps (H0 vs. tN , tN vs. τ )
are distinctly diﬀerent from the corresponding FOXSI-
2 AR 12234 maps. In particular, tN is bounded from
above by both the 90% and 99% contours, as is τ . H0
has a smaller maximum value for these regions than for

14

)
s
(

n
o
i
t
a
r
u
D

500.0

199.1

79.2

31.5

12.6

5.0

Log(Likelihood) Map

Delay Map

D2

−50
−100
−150
−200
−250
−300

)
s
(

n
o
i
t
a
r
u
D

500.0

199.1

79.2

31.5

12.6

5.0

D2

3000

1917

1225

783

500

0.005 0.027 0.151 0.829 4.551 25.000
Heating (erg cm−3 s−1)

0.005 0.027 0.151 0.829 4.551 25.000
Heating (erg cm−3 s−1)

Log(Likelihood) Map

Duration Map

)
s
(

l

y
a
e
D

10000

5493

3017

1657

910

500

D2

−50
−100
−150
−200
−250
−300

)
s
(

l

y
a
e
D

10000

5493

3017

1657

910

500

D2

200.0

79.5

31.6

12.6

5.0

0.005 0.027 0.151 0.829 4.551 25.000
Heating (erg cm−3 s−1)

0.005 0.027 0.151 0.829 4.551 25.000
Heating (erg cm−3 s−1)

Log(Likelihood) Map

Heating Map

)
s
(

n
o
i
t
a
r
u
D

500.0

199.1

79.2

31.5

12.6

5.0

−50
−100
−150
−200
−250
−300

D2

)
s
(

n
o
i
t
a
r
u
D

500.0

199.1

79.2

31.5

12.6

5.0

D2

0.500

0.158

0.050

0.016

0.005

500

910

1657

3017

5493 10000

500

910

1657

3017

5493 10000

Delay (s)

Delay (s)

Figure 11. Parameter space results for NuSTAR-observed active region D2 using combined data from both telescopes (FPMA
& FPMB) and including energy ﬂux and AIA constraints. The formatting is the same as Figure 8.

AR 12234, as well as a minimum value that is below
0.005 erg cm−3 s−1 (the threshold of our analysis).

The range of acceptable parameters for each region are
consistent with the temperatures derived from isother-
mal ﬁts to each region’s HXR spectra, although these
ﬁts characterize only a limited portion of each region’s
full DEM. As mentioned above, large values of tN (low-
frequency heating) will result in hotter plasma than
small values (high-frequency heating).
It is therefore
logical that the hotter FOXSI-2 AR is ﬁt best by
nanoﬂare sequences with longer delays, and the cooler
NuSTAR ARs are ﬁt best by nanoﬂare sequences with
shorter delays.
Similar logic can be applied to H0
and τ : higher values of these parameters will produce
greater energy ﬂuxes and higher temperatures. There-
fore, higher heating amplitudes and longer durations
should be expected to produce the best ﬁts to AR 12234,
and in fact they do. Crucially, quasi-continuous heating
is excluded with >99% conﬁdence for every active region
in our sample.
In other words, there is no region for
which the delay and duration can have the same value
(500 s) within the likelihood CIs. This is a further val-
idation of the nanoﬂare model, as virtually any coronal
heating mechanism should be impulsive on the spatial
scale of a single loop strand (Klimchuk 2006, 2015).

Because FOXSI-2 and NuSTAR have limited spec-
tral range, it is diﬃcult to determine if the parame-
ter space results for each instrument are diﬀerent due
to intrinsic properties of the ARs, or because each in-
strument is sampling a diﬀerent component of each
region’s DEM distribution. According to Figure 5
of Hannah et al. (2016), the best-ﬁt parameters for
FOXSI -observed AR 12234 (Thigh = 11.6 MK, EM =
3.0×1043 cm−3) are right at the NuSTAR 2-sigma sen-
sitivity limit for this sample of active regions. There-
fore the NuSTAR-observed regions could have had high-
temperature components in their DEM distributions
with similar or lower intensities as the isothermal ﬁt to
the FOXSI -observed AR 12234. We tested the multi-
thermal nature of the FOXSI -observed region by adding
additional low-temperature components to the best-ﬁt
model. First we added a model with spectral parame-
ters roughly centered between the ﬁt parameters from
the cooler NuSTAR regions D1, D2, and L1 (Tlow1
= 3.3 MK, EM = 3.5×1046 cm−3). Next, we tried
the same procedure with spectral parameters roughly
centered between the ﬁt parameters from the hotter
NuSTAR regions L2 and L3 (Tlow2 = 4.4 MK, EM =
5.0×1046 cm−3). The ﬁrst 2-temperature model spec-
trum (Thigh plus Tlow1) resulted in approximately 15%
increased ﬂux in the lowest FOXSI-2 energy bin (4-

 
 
 
 
 
 
15

)
s
(

n
o
i
t
a
r
u
D

500.0

199.1

79.2

31.5

12.6

5.0

Log(Likelihood) Map

Delay Map

L2

−100

−150

−200

−250

−300

)
s
(

n
o
i
t
a
r
u
D

500.0

199.1

79.2

31.5

12.6

5.0

L2

3000

1917

1225

783

500

0.005 0.027 0.151 0.829 4.551 25.000
Heating (erg cm−3 s−1)

0.005 0.027 0.151 0.829 4.551 25.000
Heating (erg cm−3 s−1)

Log(Likelihood) Map

Duration Map

)
s
(

l

y
a
e
D

10000

5493

3017

1657

910

500

L2

−100

−150

−200

−250

−300

)
s
(

l

y
a
e
D

10000

5493

3017

1657

910

500

L2

200.0

79.5

31.6

12.6

5.0

0.005 0.027 0.151 0.829 4.551 25.000
Heating (erg cm−3 s−1)

0.005 0.027 0.151 0.829 4.551 25.000
Heating (erg cm−3 s−1)

Log(Likelihood) Map

Heating Map

500.0

199.1

79.2

31.5

12.6

5.0

L2

−100

−150

−200

−250

−300

)
s
(

n
o
i
t
a
r
u
D

500.0

199.1

79.2

31.5

12.6

5.0

L2

0.500

0.158

0.050

0.016

0.005

500

910

1657

3017

5493 10000

500

910

1657

3017

5493 10000

Delay (s)

Log(Likelihood) Map

Delay (s)

Delay Map

500.0

199.1

79.2

31.5

12.6

5.0

L3

−100

−150

−200

−250

−300

)
s
(

n
o
i
t
a
r
u
D

500.0

199.1

79.2

31.5

12.6

5.0

L3

3000

1917

1225

783

500

)
s
(

n
o
i
t
a
r
u
D

)
s
(

n
o
i
t
a
r
u
D

0.005 0.027 0.151 0.829 4.551 25.000
Heating (erg cm−3 s−1)

0.005 0.027 0.151 0.829 4.551 25.000
Heating (erg cm−3 s−1)

Log(Likelihood) Map

Duration Map

)
s
(

l

y
a
e
D

10000

5493

3017

1657

910

500

L3

−100

−150

−200

−250

−300

)
s
(

l

y
a
e
D

10000

5493

3017

1657

910

500

L3

200.0

79.5

31.6

12.6

5.0

0.005 0.027 0.151 0.829 4.551 25.000
Heating (erg cm−3 s−1)

0.005 0.027 0.151 0.829 4.551 25.000
Heating (erg cm−3 s−1)

Log(Likelihood) Map

Heating Map

)
s
(

n
o

i
t

a
r
u
D

500.0

199.1

79.2

31.5

12.6

5.0

L3

−100

−150

−200

−250

−300

)
s
(

n
o

i
t

a
r
u
D

500.0

199.1

79.2

31.5

12.6

5.0

L3

0.500

0.158

0.050

0.016

0.005

500

910

1657

3017

5493 10000

500

910

1657

3017

5493 10000

Delay (s)

Delay (s)

Figure 12. Parameter space results for NuSTAR-observed active regions L2 and L3 using combined data from both telescopes
(FPMA & FPMB) and including energy ﬂux and AIA constraints. The formatting is the same as Figure 8.

 
 
 
 
 
 
 
 
 
 
 
 
16

5 keV), and neglible changes above 5 keV. However,
the other 2-temperature model (Thigh plus Tlow2) gave
ﬂuxes >6 times larger in the lowest bin and ﬂuxes >2
times larger in the adjacent bin. Therefore, it is cer-
tain that AR 12234 could not be ﬁt by a 2-temperature
model in which the lower T and EM were similar to what
NuSTAR observed from ARs L2 and L3. However, a
2-temperature model with low-temperature parameters
similar to NuSTAR-observed regions D1/D2/L1 could
agree reasonably well with the FOXSI-2 AR spectrum.
Although we were able to obtain good agreement
with HXR data from homogeneous nanoﬂare se-
quences, previous work by e.g. Reep et al. (2013)
and Cargill (2014) has shown that it is diﬃcult to
produce the range of observed AR DEM slopes with
equally spaced, constant energy nanoﬂares. Cargill
(2014) and Cargill et al. (2015) showed that it is
possible to reproduce a broad range of slopes with
nanoﬂare sequences if there is a correlation between
the nanoﬂare energy and the delay between successive
events. This is a more physically motivated model,
as more magnetic free energy would presumably be
released by (and required for) larger events. Other
authors (e.g. Barnes et al. 2016b; Bradshaw & Viall
2016; L´opez Fuentes & Klimchuk 2016) have used heat-
ing amplitudes drawn from a power-law distribution
instead of equal-energy nanoﬂares. The use of power-
law distributions in energy and variable delay times is
beyond the scope of this analysis, but will be explored in
future work. Future work will also include the addition
of ion heating to the EBTEL simulations.
In addi-
tion, comparisons with ﬁeld-aligned simulations can put
additional constraints on which regions of parameter
space can model active region HXR ﬂuxes within the
constraints of low-temperature EUV/SXR observations.

Finally, NuSTAR has observed multiple active regions
since 2014 November 1, several of which were quies-
cent and therefore suitable for nanoﬂare modeling stud-
ies. Future publications will model non-homogeneous
nanoﬂares in ﬁeld-line-averaged and ﬁeld-aligned using
data from multiple NuSTAR and FOXSI ARs.

This paper made use of data from the NuSTAR mis-
sion, a project led by the California Institute of Tech-
nology, managed by the Jet Propulsion Laboratory, and
funded by the National Aeronautics and Space Admin-
istration. This research also made use of the NuSTAR
Data Analysis Software (NUSTARDAS) jointly devel-
oped by the ASI Science Data Center (ASDC, Italy)
and the California Institute of Technology (USA). We
thank the NuSTAR Operations, Software and Calibra-
tion teams for support with the execution and analysis
of these observations. The FOXSI-2 sounding rocket
was funded by NASA LCAS grant NNX11AB75G. The
FOXSI team would like to acknowledge the contribu-
tions of each member of the FOXSI experiment team
to the project, particularly our team members at ISAS
for the provision of Si and CdTe detectors and at MSFC
for the fabrication of the focusing optics. The authors
would like to thank P.S. Athiray for providing AIA data
co-temporal with the FOXSI-2 observations. Additional
thanks goes to Will Barnes for helpful discussions about
ebtel++ and the physics of small heating events. AJM
was supported by NASA Earth and Space Science Fel-
lowship award NNX13AM41H. LG was supported by
NSF grant AGS-1429512. SJB was supported in this ef-
fort by NSF CAREER award AGS-1450230. IGH was
supported by a Royal Society University Research Fel-
lowship. This work was supported by NASA grants
NNX12AJ36G and NNX14AG07G.

Facility: NuSTAR.

REFERENCES

Avni, Y. 1976, ApJ, 210, 642

Brosius, J. W., Daw, A. N., & Rabin, D. M. 2014, ApJ,

Barnes, W. T., Cargill, P. J., & Bradshaw, S. J. 2016a,

790, 112

ApJ, 829, 31

—. 2016b, ApJ, 833, 217

Bevington, P. R., & Robinson, D. K. 2003, Data Reduction

and Error Analysis for the Physical Sciences

(McGraw-Hill)

Bradshaw, S. J., & Cargill, P. J. 2006, A&A, 458, 987

—. 2013, ApJ, 770, 12

Bradshaw, S. J., & Klimchuk, J. A. 2011, ApJS, 194, 26

Cargill, P. J. 2014, ApJ, 784, 49

Cargill, P. J., & Bradshaw, S. J. 2013, ApJ, 772, 40

Cargill, P. J., Bradshaw, S. J., & Klimchuk, J. A. 2012a,

ApJ, 752, 161

—. 2012b, ApJ, 758, 5

Cargill, P. J., Warren, H. P., & Bradshaw, S. J. 2015,

Philosophical Transactions of the Royal Society of
London Series A, 373, 20140260

Caspi, A., Woods, T. N., & Warren, H. P. 2015, ApJL, 802,

Bradshaw, S. J., & Viall, N. M. 2016, ApJ, 821, 63

L2

17

Culhane, J. L., Harra, L. K., James, A. M., et al. 2007,

Marsh, A. J., Smith, D. M., Glesener, L., et al. 2017, ApJ,

SoPh, 243, 19

Edl´en, B. 1943, Zeitschrift f¨ur Astrophysik, 22, 30
Glesener, L., Krucker, S., Hannah, I. G., et al. 2017, ApJ,

845, 122

Glesener, L., Krucker, S., Christe, S., et al. 2016, in
Proc. SPIE, Vol. 9905, Society of Photo-Optical
Instrumentation Engineers (SPIE) Conference Series,
99050E

Golub, L., Hartquist, T. W., & Quillen, A. C. 1989, SoPh,

122, 245

849, 131

McTiernan, J. M. 2009, ApJ, 697, 94

Miceli, M., Reale, F., Gburek, S., et al. 2012, A&A, 544,

A139

Neyman, J. 1937, Philosophical Transactions of the Royal

Society of London Series A, 236, 333

Parker, E. N. 1988, ApJ, 330, 474

Parnell, C. E., & De Moortel, I. 2012, Philosophical

Transactions of the Royal Society of London Series A,

Golub, L., Deluca, E., Austin, G., et al. 2007, SoPh, 243, 63
Grefenstette, B. W., Glesener, L., Krucker, S., et al. 2016,

370, 3217

Phillips, K. J. H. 2004, ApJ, 605, 921

ApJ, 826, 20

Grotrian, W. 1939, Naturwissenschaften, 27, 214
Hannah, I. G., Grefenstette, B. W., Smith, D. M., et al.

2016, ApJL, 820, L14

Harrison, F. A., Craig, W. W., Christensen, F. E., et al.

2013, ApJ, 770, 103

Ishikawa, S., Glesener, L., Krucker, S., et al. 2017, Nature

Astronomy, 1, 771

Reale, F., McTiernan, J. M., & Testa, P. 2009, ApJL, 704,

L58

Reale, F., & Orlando, S. 2008, ApJ, 684, 715

Reep, J. W., Bradshaw, S. J., & Klimchuk, J. A. 2013,

ApJ, 764, 193

Schmelz, J. T., & Pathak, S. 2012, ApJ, 756, 126

Schmelz, J. T., Kashyap, V. L., Saar, S. H., et al. 2009,

Ishikawa, S., Glesener, L., Christe, S., et al. 2014, PASJ, 66,

ApJ, 704, 863

S15

Klimchuk, J. A. 2006, SoPh, 234, 41
—. 2015, Philosophical Transactions of the Royal Society of

London Series A, 373, 40256

Klimchuk, J. A., Patsourakos, S., & Cargill, P. J. 2008,

ApJ, 682, 1351

Kuhar, M., Krucker, S., Glesener, L., et al. 2018, ArXiv

e-prints, 1803, arXiv:1803.08365

Kuhar, M., Krucker, S., Hannah, I. G., et al. 2017, ApJ,

835, 6

Sylwester, J., Kuzin, S., Kotov, Y. D., Farnik, F., & Reale,

F. 2008, Journal of Astrophysics and Astronomy, 29, 339

Tripathi, D., Klimchuk, J. A., & Mason, H. E. 2011, ApJ,

740, 111

Ugarte-Urra, I., & Warren, H. P. 2014, ApJ, 783, 12

Viall, N. M., & Klimchuk, J. A. 2012, ApJ, 753, 35

—. 2017, ApJ, 842, 108

Warren, H. P., Winebarger, A. R., & Brooks, D. H. 2012,

ApJ, 759, 141

Lemen, J. R., Title, A. M., Akin, D. J., et al. 2012, SoPh,

Wilks, S. S. 1938, Ann. Math. Statist., 9, 60

275, 17

Winebarger, A. R., Warren, H. P., Schmelz, J. T., et al.

Lin, R. P., Dennis, B. R., Hurford, G. J., et al. 2002, SoPh,

2012, ApJL, 746, L17

210, 3

L´opez Fuentes, M., & Klimchuk, J. A. 2016, ApJ, 828, 86
Madsen, K. K., Harrison, F. A., Markwardt, C. B., et al.

2015, ApJS, 220, 8

Withbroe, G. L., & Noyes, R. W. 1977, ARA&A, 15, 363

Wright, P. J., Hannah, I. G., Grefenstette, B. W., et al.

2017, ApJ, 844, 132

