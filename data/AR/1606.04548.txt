MNRAS 000, 1–?? (2016)

Preprint 16 June 2016

Compiled using MNRAS LATEX style ﬁle v3.0

The Frontier Fields Lens Modeling Comparison Project

M. Meneghetti1,2(cid:63), P. Natarajan3, D. Coe4 , E. Contini5, G. De Lucia6, C. Giocoli7,
A. Acebron7, S. Borgani19,6,20, M. Bradac8, J. M. Diego9, A. Hoag8, M. Ishigaki10,17,
T. L. Johnson11, E. Jullo7, R. Kawamata18, D. Lam12, M. Limousin7, J. Liesenborgs22,
M. Oguri10,15,16, K. Sebesta13, K. Sharon11, L. L. R. Williams13, A. Zitrin14,21

1Osservatorio Astronomico di Bologna, INAF, via Ranzani 1, 40127, Bologna, Italy
2INFN, Sezione di Bologna, viale Berti Pichat 6/2, 40127, Bologna, Italy
3Department of Astronomy, Yale University, New Haven, CT 06511, USA
4Space Telescope Science Institute, Baltimore, MD, USA
5Purple Mountain Observatory, the Partner Group of MPI f¨ur Astronomie, 2 West Beijing Road, Nanjing 210008, China
6INAF - Astronomical Observatory of Trieste, via G.B. Tiepolo 11, I-34143 Trieste, Italy
7Aix Marseille Universit´e, CNRS, LAM (Laboratoire d’Astrophysique de Marseille) UMR 7326, 13388 Marseille, France
8Department of Physics, University of California, One Shields Ave, Davis, CA 95616, USA
9IFCA, Instituto de Fisica de Cantabria (UC-CSIC), Av. de Los Castros s/n, 39005 Santander, Spain
10Department of Physics, Graduate School of Science, The University of Tokyo, 7-3-1 Hongo, Bunkyo-ku, Tokyo 113-0033, Japan
11University of Michigan, Department of Astronomy, 1085 South University Avenue, Ann Arbor, MI 48109, USA
12Department of Physics, The University of Hong Kong, 0000-0002-6536-5575, Pokfulam Road, Hong Kong
13School of Physics and Astronomy, University of Min- nesota, 116 Church Street SE, Minneapolis, MN 55455, USA
14Cahill Center for Astronomy and Astrophysics, California Institute of Technology, MC 249-17, Pasadena, CA 91125, USA
15Research Center for the Early Universe, The University of Tokyo, 7-3-1 Hongo, Bunkyo-ku, Tokyo 113-0033, Japan
16Kavli Institute for the Physics and Mathematics of the Universe (Kavli IPMU, WPI), University of Tokyo, Chiba 277-8582, Japan
17Institute for Cosmic Ray Research, The University of Tokyo, 5-1-5 Kashiwanoha, Kashiwa, Chiba 277-8582, Japan
18Department of Astronomy, Graduate School of Science, The University of Tokyo, 7-3-1 Hongo, Bunkyo-ku, Tokyo 113-0033, Japan
19Astronomy Unit, Department of Physics, University of Trieste, via Tiepolo 11, I-34131 Trieste, Italy
20INFN-National Institute for Nuclear Physics, Via Valerio 2, I-34127 Trieste, Italy
21Hubble Fellow
22Expertisecentrum voor Digitale Media, Universiteit Hasselt, Wetenschapspark 2, B-3590, Diepenbeek, Belgium

16 June 2016

ABSTRACT
Gravitational lensing by clusters of galaxies oﬀers a powerful probe of their structure
and mass distribution. Deriving a lens magniﬁcation map for a galaxy cluster is a
classic inversion problem and many methods have been developed over the past two
decades to solve it. Several research groups have developed techniques independently to
map the predominantly dark matter distribution in cluster lenses. While these methods
have all provided remarkably high precision mass maps, particularly with exquisite
imaging data from the Hubble Space Telescope (HST), the reconstructions themselves
have never been directly compared. In this paper, we report the results of comparing
various independent lens modeling techniques employed by individual research groups
in the community. Here we present for the ﬁrst time a detailed and robust comparison
of methodologies for ﬁdelity, accuracy and precision. For this collaborative exercise, the
lens modeling community was provided simulated cluster images – of two clusters Ares
and Hera – that mimic the depth and resolution of the ongoing HST Frontier Fields.
The results of the submitted reconstructions with the un-blinded true mass proﬁle of
these two clusters are presented here. Parametric, free-form and hybrid techniques have
been deployed by the participating groups and we detail the strengths and trade-oﬀs
in accuracy and systematics that arise for each methodology. We note in conclusion
that lensing reconstruction methods produce reliable mass distributions that enable
the use of clusters as extremely valuable astrophysical laboratories and cosmological
probes.

Key words: clusters of galaxies — gravitational lensing – mass distributions – sim-
ulations

6
1
0
2

n
u
J

4
1

]

O
C
.
h
p
-
o
r
t
s
a
[

1
v
8
4
5
4
0
.
6
0
6
1
:
v
i
X
r
a

c(cid:13) 2016 The Authors

(cid:63) E-mail: massimo.meneghetti@oabo.inaf.it

 
 
 
 
 
 
2 M. Meneghetti et al.

1 INTRODUCTION

Gravitational lensing has become an increasingly popular
method to constrain the matter distribution in clusters.
Strong lensing, as it turns out, is particularly suited to prob-
ing the dense central regions of clusters. Constraining the
structure of the cluster cores and their density proﬁles is
critical to our understanding of structure formation; probing
the nature of dark matter and fully comprehending the inter-
play between baryons and dark matter. Lensing by massive
clusters has proved to be an invaluable tool to study their
properties, in particular the detailed dark matter distribu-
tion within the cluster, as well as the faint, distant back-
ground population of galaxies that they bring into view. The
magniﬁcation provided by lensing therefore aﬀords the de-
termination of the luminosity function of these high-redshift
sources down to faint luminosities, thus helping inventory
and identify galaxies that might have re-ionized the universe
(Vanzella et al. 2012, 2014; Bouwens et al. 2014; Robertson
et al. 2015; Bouwens et al. 2015; Vanzella et al. 2015, 2016;
Huang et al. 2016; Livermore et al. 2016).

Over the past two decades the Hubble Space Telescope
(HST) has revolutionized the study of cluster lenses; and,
with the deployment of ever more sensitive cameras from the
Wide-Field-Planetary-Camera2 (WFPC2) to the Advanced-
Camera-for-Surveys (ACS), the data have become exquisite
in terms of resolution. By 2005, mass distributions derived
from lensing data were available for about 30 clusters. More
recently, galaxy clusters were the primary targets of two
multi-cycle treasury programs of the Hubble Space Tele-
scope (HST) aiming at ﬁnding signatures of strong gravita-
tional lensing in their cores. These are the “Cluster Lensing
And Supernova survey with Hubble” (CLASH, PI M. Post-
man (GO 12065); see Postman et al. 2012)) and the ongoing
Frontier Fields Initiative (FFI, PI: Lotz).

As part of the Frontier Fields program, HST is cur-
rently collecting data of unprecedented depth on ﬁelds that
harbor six massive clusters that act as powerful gravitational
lenses. This program utilizes orbits under the Director’s Dis-
cretionary (DD) observing time. The FFI is a revolutionary
deep ﬁeld observing program aimed at peering deeper into
the universe than ever before to not only help understand
better these dramatic lenses and their properties, but also
simultaneously bring into view faint, distant background
galaxies that would otherwise remain unseen without the
magniﬁcation provided by the foreground lens. These high
redshift sources that can be accessed due to gravitational
lensing provide a ﬁrst glimpse likely of the earliest galaxies
to have formed in the universe, and oﬀer a preview of com-
ing attractions that await unveiling by the upcoming James
Webb Space Telescope. These Frontier Fields uniquely com-
bine the power of HST with that of nature’s gravitational
telescopes – the high-magniﬁcations produced by these mas-
sive clusters of galaxies.

Utilizing both the Wide Field Camera 3 (WFC3) and
ACS in parallel in this current program, HST has been pro-
ducing the deepest observations of clusters and the back-
ground galaxies that they lens; as well as observations of
ﬂanking blank ﬁelds that are located near these selected
clusters. These images have revealed the presence of distant
galaxy populations that are ∼ 10−100 times fainter than any
previously observed (Livermore et al. 2016). The magnifying

power of these clusters is proving to be invaluable in help-
ing improve our statistical understanding of early galaxies
that are likely responsible for the re-ionization of the uni-
verse, and are providing unprecedented measurements of the
spatial distribution of dark matter within massive clusters.
These six clusters span the redshift range z = 0.3 − 0.55. The
program devotes 140 orbits to each cluster / blank ﬁeld pair,
achieving a limiting AB magnitude of MAB ≈ 28.7 − 29 mag
in the optical (ACS) and near-infrared (WFC3) bands.

The fundamental ingredient for exploiting the science
outlined above is the construction of robust and reliable lens
models. The ongoing FFI is an unprecedented test-bed for
lens modeling techniques. Given the depth of these HST ob-
servations, hundreds of multiple images, covering a broad
redshift range, have been newly unveiled behind each of the
observed clusters (Jauzac et al. 2014, 2015; Grillo et al. 2015;
Diego et al. 2015b; Wang et al. 2015; Kawamata et al. 2016;
Hoag et al. 2016). In a rather unique case, even time delay
measurements from a serendipitously multiply imaged su-
pernova “Refsdal” observed by the GLASS team (Treu et al.
2015) in the FFI cluster MACSJ1149.5+2223 became avail-
able for testing and reﬁning the lens models (Kelly et al.
2015; Treu et al. 2016; Rodney et al. 2016). Most impor-
tantly, FFI data were made publicly available immediately.
Five teams were contracted by STScI to produce gravita-
tional lensing models for all six Frontier Fields clusters to
be made available to the astronomical community at large to
enable wide use of this incredible data-set. All teams share
the latest observational constraints, including positions and
redshifts of multiple images1 before working independently
to produce lensing models which are also made publicly
available.2 Several additional groups have also been work-
ing on the data and producing mass models. In short, the
whole community of strong lensing modelers has been ac-
tively collaborating to maximally exploit the FFI data.

The process of converting the observed strong lensing
constraints into matter distributions is called lens inver-
sion. Several groups have developed algorithms which per-
form the lens inversion employing diﬀerent methodologies
and using various combinations of input constraints. These
include other tracers of the cluster gravitational potential,
such as weak lensing, galaxy kinematics, and the X-ray emis-
sion from the Intra-Cluster-Medium (see e.g., Bradaˇc et al.
2005; Donnarumma et al. 2011; Medezinski et al. 2013; New-
man et al. 2013; Umetsu 2013; Umetsu et al. 2014; Merten
et al. 2015). Over the years, it has become clear that while
all methods are equally well motivated, they do not always
converge to consistent reconstructions, even when applied
to the same lens system (e.g., Zitrin & Broadhurst 2009;
Smith et al. 2009). In several cases strong-lensing masses
for the same cluster lens were found to be in tension (by
a factor 2-3) with other independent measurements, based
e.g on the modeling of the X-ray emission by the intra-
cluster gas (Ebeling et al. 2009; Richard et al. 2010; Donahue
et al. 2014). The constraints from strong lensing need to be

1 The redshifts are mainly obtained in the framework of the
GLASS and CLASH-VLT programs (Treu et al. 2015; Grillo et al.
2015) and with the intergral ﬁeld spectrograph MUSE on the VLT
(see e.g. Karman et al. 2015)
2 https://archive.stsci.edu/prepds/frontier/lensmodels/

MNRAS 000, 1–?? (2016)

The Frontier Fields Lens Modeling Comparison Project

3

combined and ﬁt simultaneously with stellar kinematic data
and with weak lensing measurements (Newman et al. 2011)
to improve accuracy. Using constraints on the mass pro-
ﬁle arising from probes other than lensing also helps break
the mass-sheet degeneracy. Finally, in several clusters, lens-
ing data alone seems unable to discriminate between var-
ious density proﬁles (Shu et al. 2008). Therefore, in some
clusters the data favors steep inner density proﬁle slopes,
while, in others it favors extremely shallow density proﬁles.
This is in contrast with the predictions from the cold-dark-
matter paradigm (Sand et al. 2005; Newman et al. 2013, but
see also Bartelmann & Meneghetti 2004; Meneghetti et al.
2005) where a universal density proﬁle is expected with mi-
nor modiﬁcation due to the aggregation of baryons in the
inner regions.

In this paper, we challenge these lens inversion meth-
ods to reconstruct synthetic lenses with known input mass
distributions. The goals of this exercise are twofold. Firstly,
we aim to provide concrete feedback to the lens modelers
on how they may improve the performance of their codes.
And secondly, we aim to provide potential users of the FFI
models and the astronomical community at large a sharper,
more quantitative view of how robustly speciﬁc properties
of lenses are recovered and the sources of error that plague
each method. Such a comparison with numerical simulations
and contrasting of lens mapping methodologies has not been
undertaken before.

The outline of the paper is as follows. In Sect. 2, we
outline the lens modeling challenge. In Sect. 3, we brieﬂy
introduce the various lens modeling techniques that were
employed by participants in this study. In Sect. 4, we dis-
cuss the results of the reconstructions. Sect. 5 is dedicated to
the detailed comparison of the independent modeling tech-
niques through suitably deﬁned metrics. Finally, in Sect. 7,
we summarize the main results of this study and present our
conclusions.

2 THE CHALLENGE

The challenge that we presented to various groups of lens
modelers comprised of analyzing simulated observations of
two mock galaxy clusters and producing magniﬁcation and
mass maps for them. In generating these simulated (mock)
clusters, we attempted to reproduce the depth, color, and
spatial resolution of HST observations of the FFI cluster
images including the gravitational lensing eﬀects. While the
comparison of lensing reconstructions of real clusters using
the same input observational constraints strongly indicate
that currently developed lens inversion techniques are ro-
bust (Grillo et al. 2015), the analysis of simulated data in-
volving a large degree of realism where the true underlying
mass distribution is known can help the lens reconstruction
community to greatly improve their understanding of the
modeling systematics. This view of using mocks to calibrate
methodologies is widely supported by a number of extensive
investigations carried out in the last few years.

There are multiple advantages to such calibration exer-
cises. First of all, we are able to produce reasonably realistic
cluster mass distributions in simulations (although up to
some limit) that can be used as lensing clusters. Building
on an extensive analysis of N-body/hydrodynamical simula-

MNRAS 000, 1–?? (2016)

tions to improve the knowledge of strong lensing clusters, we
have identiﬁed the important properties of the lenses which
need to be taken into account during the construction of a
lens model: cluster galaxies (Meneghetti et al. 2000, 2003a),
ellipticity and asymmetries (Meneghetti et al. 2003b), sub-
structures (Meneghetti et al. 2007), baryonic physics (Puch-
wein et al. 2005; Killedar et al. 2012), and the dynamical
state (Torri et al. 2004). In fact, we can simulate the lens-
ing eﬀects of galaxy clusters accounting for all these impor-
tant properties, using both state-of-the-art hydrodynamical
simulations and semi-analytic models. Second, we have de-
veloped tools to produce mock observations of these simu-
lated lenses. Our image simulator SkyLens (Meneghetti et al.
2008, 2010a) can mimic observations taken with virtually
any telescope, but here we have used it primarily to produce
simulations of HST images taken with both the ACS and the
WFC3. In a small scale realization of the experiment that
we present here, we applied the lens inversion techniques
to a limited number of simulated observations of our mock
lenses. By doing so, we highlighted some key limits of the
strong lensing methods. For example, we note that strong
lensing alone is powerful at constraining the cluster mass
within the Einstein radius (∼ 100 kpc for a massive clus-
ter) but the addition of further constraints at larger radii
are required in order to appropriately measure the shape of
the density proﬁles out to the cluster outskirts (Meneghetti
et al. 2010a; Rasia et al. 2012). In what follows, we describe
in detail how we generate the mock data-set for the chal-
lenge, and what kind of high-level products were distributed
to the participants.

2.1 Generation of mock cluster lenses

For the exercise reported here, we generated mass distribu-
tions for two massive cluster lenses. These two lenses are gen-
erated following substantially diﬀerent approaches, as out-
lined below. In order to easily distinguish them, we assigned
them names – Ares and Hera.

2.1.1 Ares

The mass distribution of the ﬁrst simulated galaxy cluster,
Ares, is generated using the semi-analytic code MOKA3 (Gio-
coli et al. 2012a). This software package builds up mock
galaxy clusters by treating them as being comprised of three
components: (i) the main dark matter halo – assumed to be
smooth, triaxial, and well ﬁt with an NFW proﬁle, (ii) clus-
ter members – subhaloes, distributed to follow the main halo
and to have a truncated Singular Isothermal Sphere proﬁle
(Hernquist 1990a) – and (iii) the brightest cluster galaxy
(BCG) modeled with a separate Hernquist (1990a) proﬁle.
The axial ratios, a/b and a/c, of the main halo ellipsoid are
randomly drawn from the Jing & Suto (2002) distributions
requiring abc = 1. We note that the observed FFI clusters
typically consist of merging sub-clusters that cause them to
be particularly eﬃcient and spectacular lenses.

In the attempt to generate a mass distribution that ade-
quately replicates the complexity of the Frontier Fields clus-
ters, Ares was produced by combining two large scale mass

3 http://cgiocoli.wordpress.com/research-interests/moka

4 M. Meneghetti et al.

= 1.32×1015h−1 M(cid:12) and M2

distributions at z = 0.5. The two clumps have virial masses
= 8.8×1014h−1 M(cid:12) and their cen-
M1
ters are separated by ∼ 400 h−1 kpc. In each of the two cases,
we start by assigning the same projected ellipticity to the
smooth component, to the stellar density and to the subhalo
spatial distribution. This is motivated by the hierarchical
clustering scenario wherein the BCG and the substructures
are related to the cluster as a whole and retain memory of
the directions of the accretion of repeated merging events
(Kazantzidis et al. 2004, 2008, 2009; Fasano et al. 2010). In
order to introduce some level of asymmetry, we then added
in a small twist to the surface density contours. The degree
of twisting adopted reproduces variations of the orientation
of iso-surface density contours measured in numerically sim-
ulated galaxy clusters (see e.g. Meneghetti et al. 2007). The
two large-scale halos combined to create Ares are nearly
aligned. The diﬀerence between the position angles of the
two clumps is ∼ 21 degrees. The central region of Ares con-
tains large baryonic concentrations to mimic the presence of
BCGs. We account for the possible adiabatic contraction of
the dark matter caused by the presence of BCGs for Ares
(altough several empirical studies ﬁnd no evidence of adi-
abatic contraction on these scales, see e.g. Newman et al.
2013; Dutton & Treu 2014). The adiabatic contraction as
described by Keeton & Madau (2001) for Hernquist (1990b)
was implemented. For further details of the MOKA code we re-
fer to Giocoli et al. (2012a,b). MOKA also takes into account
the correlation between assembly history and various halo
properties that are expected in CDM: (i) less massive haloes
typically tend to be more concentrated than the more mas-
sive ones, and (ii) at ﬁxed mass, earlier forming haloes are
more concentrated and contain fewer substructures. These
recipes have been implemented in consonance with recent re-
sults from numerical simulations. In particular, we assume
the Zhao et al. (2009) relation to link the concentration to
mass and the Giocoli et al. (2010) relation for the subhalo
abundance. When substructures are included we deﬁne the
smooth mass as Msmooth
i msub,i and its concentration
cs are deﬁned such that the total (smooth+clumps) mass
density proﬁle has a concentration cvir, equal to that of the
total virial mass of the halo.

= Mvir −(cid:80)

Throughout the paper the quoted masses and concen-
trations are evaluated at the virial radius, Mvir and cvir. For
these deﬁnitions we adopt derivations from the spherical col-
lapse model:
Mvir = 4π
3

∆vir(z)
Ωm(z)

0ρc ,

R3
vir

(1)

Ω

where ρc = 2.77 × 1011 h2 M(cid:12)/Mpc represents the critical den-
sity of the Universe, Ω
= Ωm(0) is the matter density pa-
0
rameter at the present time, ∆vir is the virial overdensity
(Eke et al. 1996; Bryan & Norman 1998) and Rvir symbolizes
the virial radius of the halo, i.e. the distance from the halo
centre that encloses the desired density contrast; and:

cvir ≡

Rvir
rs

,

(2)

with rs the radius at which the NFW proﬁle approaches
a logarithmic slope of −2. The concentrations assigned to
= 5.39 and
the two main mass components of Ares are c1
c2

= 5.46, respectively.

Ares is generated in a ﬂat ΛCDM cosmological model

with matter density parameter Ωm,0
parameter at the present epoch is H0

= 0.272. The Hubble
= 70.4 km/s/Mpc.

In the left panels of Fig. 1, we show the convergence
maps of Ares, calculated for a source redshift zs = 9. The
cluster is elongated in the SE-NW direction and contains
several massive substructures. Since Ares was generated us-
ing semi-analytical methods, the small scale substructures
of its mass distribution are very well resolved, as shown in
the bottom-left panel. The substructure mass function is
shown in the right panel of Fig. 2. As expected, this scales
as N(M) ∝ M−0.8, consistent with results of numerical simu-
lations (Giocoli et al. 2010) of the CDM model. The conver-
gence proﬁle, measured from the center of the most massive
clump, is shown in the left panel of Fig. 2.

In the image simulations described later we also include
the light emission from cluster members. MOKA populates the
dark matter sub-halos with galaxies using the Halo Occupa-
tion Distribution (HOD) technique. Stellar masses and B-
band luminosities are subsequently assigned to each galaxy
accordingly to the mass of the dark matter (sub-)halo within
which it formed, following Wang et al. (2006). The mor-
phological type and the SED of each galaxy is then deﬁned
on the basis of the stellar mass so as to reproduce the ob-
served morphology-density and morphology-radius relations
in galaxy clusters (e.g. van der Wel 2008; Ma et al. 2010).

2.1.2 Hera

The mass distribution of the second galaxy cluster, Hera,
is instead directly derived from a high-resolution N-body
simulation of a cluster-sized dark matter halo. More pre-
cisely, Hera is part of the set of simulated clusters presented
in Planelles et al. (2014). The cluster halo was ﬁrst identi-
ﬁed in a low–resolution simulation box with a periodic co-
moving size of 1 h−1 Gpc for a ﬂat ΛCDM model with
present matter density parameter Ωm,0
= 0.24 and baryon
density parameter Ωb,0
= 0.04. The Hubble constant adopted
= 72km/s/Mpc and the normalisation of the matter
was H0
= 0.8. The primordial power spectrum of
power spectrum σ8
the density ﬂuctuations is P(k) ∝ kn with n = 0.96. The parent
simulation followed 10243 collision-less particles in the box.
Hera was identiﬁed at z = 0 using a standard Friends-of-
Friends (FoF) algorithm, and its Lagrangian region was re-
simulated at higher resolution employing the Zoomed Initial
Conditions code (ZIC; Tormen et al. 1997). The resolution is
progressively degraded outside this region to save computa-
tional time while still providing a correct description of the
large–scale tidal ﬁeld. The Lagrangian region was taken to
be large enough to ensure that only high-resolution particles
are present within ﬁve virial-radii of the cluster.

The re-simulation was then carried out using the
TreePM–SPH GADGET–3 code, a newer version of the orig-
inal GADGET–2 code by Springel (2005) that adopted a
more eﬃcient domain decomposition to improve the work-
load balance. Although, the parent Hera halo exists in sev-
eral ﬂavors in various simulation runs (several assumptions
for the nature of dark matter particles), including several
baryonic processes, the simulation used in this paper uses
only the version that utilized collisionless dark matter par-
ticles. This has allowed us to increase the mass resolution
by about an order of magnitude compared to the hydro-
dynamical versions of the simulation. The particle mass

MNRAS 000, 1–?? (2016)

The Frontier Fields Lens Modeling Comparison Project

5

is mDM = 108h−1 M(cid:12). Therefore, the virial region of Hera
is resolved with ∼ 10 million particles, with a total clus-
ter mass of M = 9.4 × 1014 h−1 M(cid:12), comparable to that
inferred for observed cluster lenses. The redshift of this
halo is zl = 0.507. During the re-simulation, the Plummer–
equivalent co-moving softening length for gravitational force
in the high–resolution region is ﬁxed to (cid:15)Pl = 2.3h−1 kpc phys-
ical at z < 2 while being ﬁxed to (cid:15)Pl = 6.9h−1 kpc comoving
at higher redshift.

The properties of cluster galaxies used for creating
the simulated observations are derived from Semi-Analytic-
Methods (SAM) of galaxy formation (De Lucia & Blaizot
2007). The process starts by using the algorithm SUBFIND
(Springel et al. 2001) to decompose each FOF group previ-
ously found in the simulation into a set of disjoint substruc-
tures. These are identiﬁed as locally over-dense regions in
the density ﬁeld of the background halo. Only substructures
that retain at least 20 bound particles after a gravitational
unbinding procedure are considered to be genuine substruc-
tures. Merging histories are constructed for all self-bound
structures, using the same post-processing algorithm that
has been employed for the Millennium Simulation (Springel
et al. 2006). The merger-tree is then used to construct a
mock catalog of galaxies. The evolution of the galaxy popu-
lation is described by a modiﬁed version of the semi-analytic
model presented in De Lucia & Blaizot (2007), that included
the implementation of the generation of Intra-Cluster Light
described in Contini et al. (2014), given by the combination
of Model Tidal Radius and Merger channels presented in
that paper.

Note that, even in the case of Hera, the galaxy posi-
tions trace reasonably well the mass. Several reconstruction
methods assume that light traces the mass, a reasonable as-
sumption which is thus satisﬁed both in Ares and in Hera.
To increase the level of uncertainty, the galaxy shapes and
orientations are chosen to be uncorrelated with the under-
lying mass distribution.

The convergence map of Hera with its complex mor-
phology and the abundance of substructures is shown in the
right panels of Fig. 1. The convergence proﬁle and the sub-
structure mass function are displayed in Fig. 2. Compared
to Ares, the small scale structures of Hera are smoother as
they are less well resolved. Nevertheless, the substructure
mass function scales very similarly with halo mass. As in
the case of Ares, Hera has a bi-modal mass distribution. A
massive substructure (M ∼ 5 × 1013h−1 M(cid:12)) is located ∼ 30”
(∼ 130h−1kpc) from the cluster center, producing a secondary
peak in the convergence map and elongating the iso-density
contours in the southwest–northeasterly direction.

2.2 Ray-tracing

In order to generate lensing eﬀects in the simulated images,
it is necessary to compute the deﬂections produced by the
cluster. This allows us to then use ray-tracing methods to
map the surface-brightness distribution of the sources on
the camera of our virtual telescope, which is HST in this
case. In practice, we shoot a bundle of light rays through a
dense grid covering the ﬁeld-of-view (FOV), starting from
the position of the observer. Then, we use the computed
deﬂection angles to trace the path of the light back to the
sources. When simulating HST observations, we compute

MNRAS 000, 1–?? (2016)

the deﬂection angles on a regular grid of 2048 × 2048 points,
covering a FOV of 250” × 250” centered on the cluster.

In the case of Ares, MOKA produces a map of the conver-
gence, κ(θ). This can be converted into a map of the deﬂec-
tion angles, α(θ), by solving the Eq.
d2θ(cid:48) θ − θ(cid:48)
α(θ) = 1
|θ − θ(cid:48)|
π

κ(θ(cid:48)) .

(3)

(cid:90)

Since this is a convolution of the convergence, κ(θ), with the
kernel function
K(θ) = 1
π

θ
|θ|

(4)

,

this task can be achieved numerically by means of Fast-
Fourier-Transform (FFT) methods. To do so, we make use
of the FFT routines implemented in the gsl library.

In the case of Hera, the mass distribution of the cluster
is described by a collection of dark-matter particles. Instead
of mapping them on a grid to construct the convergence
map, we use our consolidated lensing simulation pipeline
(see e.g. Meneghetti et al. 2010b, and references therein) to
compute the deﬂections. To brieﬂy summarize, the proce-
dure involves the following steps:

• We project the particles belonging to the halo along the
desired line of sight on the lens plane. To select particles, we
deﬁne a slice of the simulated volume around the cluster,
corresponding to a depth of 10h−1Mpc;

• Starting from the position of the virtual observer, we
trace a bundle of light-rays through a regular grid of 2048 ×
2048 covering a region around the halo center on the lens
plane. In the case of strong lensing simulations (e.g. for HST
observations) we restrict our analysis to a region of of 1 ×
1 h−2Mpc2. In the case of simulations extending into the
weak lensing regime (e.g. for Subaru-like observations), the
grid or light-rays covers a much wider area (∼ 8×8 h−2Mpc2);
• Using our code GLFAST (Meneghetti et al. 2010a), we
compute the total deﬂection α(x) at each light-ray position
x, accounting for the contributions from all particles on the
lens plane. Even in the case of strong-lensing simulations,
where light rays are shot through a narrower region of the
lens plane, the deﬂections account for all particles projected
out to ∼ 4h−1Mpc from the cluster center. The code is based
on a Tree-algorithm, where the contributions to the deﬂec-
tion angle of a light ray by the nearby particles are summed
directly, while those from distant particles are calculated
using higher-order Taylor expansions of the deﬂection po-
tential around the light-ray positions.

• The resulting deﬂection ﬁeld is used to derive several
relevant lensing quantities. In particular, we use the spatial
derivatives of α(θ) to construct the shear maps, γ = (γ1, γ2),
deﬁned as:

(cid:32)

γ1(θ) = 1
2

γ2(θ) = ∂α1
∂θ2

−

∂α1
∂θ1
= ∂α2
∂θ1

∂α2
∂θ2

.

(cid:33)

,

(5)

(6)

The convergence, κ(θ), may also be reconstructed as:

κ(θ) = 1
2

(cid:32)

∂α1
∂θ1

+ ∂α2
∂θ2

(cid:33)

.

(7)

The lensing critical lines yield formally inﬁnite magni-
ﬁcation for a given source redshift. They are deﬁned as the

6 M. Meneghetti et al.

Figure 1. 2D and 3D convergence maps of Ares (left panels) and Hera (right panels). The maps are normalized to the source redshift
zs = 9

Figure 2. Key properties of Ares and Hera (blue and red colors, respectively). Left panel: Convergence proﬁles (for source redshift
zs = 9). In both cases, the center has been chosen to coincide with the most massive dark matter clump in the simulation; Right panel:
sub-halo mass function (built considering all sub-halos within 1h−1Mpc from the center of the most massive clump.

MNRAS 000, 1–?? (2016)

-150.0-75.0075.0150.0x [arcsec]-150.0-75.0075.0150.0y [arcsec]Ares - (zs=9)0.11.010.0-114.0-57.0057.0114.0x [arcsec]-114.0-57.0057.0114.0y [arcsec]Hera - (zs=9)0.11.01.010.0100.0distance from main peak [arcsec]0.11.010.0convergence [zs=9]AresHera10.010.511.011.512.012.513.013.514.0log10M[Mﬂ]0.11.010.0100.01000.0N(M)N∝M−0.8The Frontier Fields Lens Modeling Comparison Project

7

curves along which the determinant of the lensing Jacobian
is zero (e.g. Schneider et al. 1992):

det A = (1 − κ − |γ|)(1 − κ + |γ|) = 0 .

(8)

In particular, the tangential critical line is deﬁned by the
condition (1 − κ − |γ|) = 0, whereas the radial critical line
corresponds to the line along which (1 − κ + |γ|) = 0. In the
following sections, we will often use the term Einstein radius
to refer to the size of the tangential critical line. As discussed
in Meneghetti et al. (2013), there are several possible deﬁ-
nitions for the Einstein radius. Here, we adopt the eﬀective
Einstein radius deﬁnition (see also Redlich et al. 2012) given
by,

θE ≡

(cid:114)

S
π

,

1
dL

(9)

where S is the area enclosed by the tangential critical line
and dL is the angular diameter distance to the lens plane.

2.3 SkyLens

We simulate observations of galaxy cluster ﬁelds using the
code SkyLens, which is described in detail in Meneghetti
et al. (2008) and in Meneghetti et al. (2010a). The creation
of the simulated images involves the following steps:

(i) we generate a past light-cone populated with source
galaxies resembling the luminosity and the redshift distribu-
tion of the galaxies in the Hubble Ultra-Deep-Field (HUDF;
Coe et al. 2006);

(ii) we model the morphologies of the sources using
shapelet decompositions of the galaxies in the HUDF (Mel-
chior et al. 2007). Their spectral energy distributions were
obtained as part of the photometric redshift measurements
of these galaxies described in Coe et al. (2006);

(iii) the deﬂection ﬁelds of the lensing clusters are used to
trace a bundle of rays from a virtual CCD, resembling the
properties of the Advanced Camera for Surveys (ACS) or of
the Wide Field Camera3 (WFC3), back to the sources;

(iv) by associating each pixel of the virtual CCD to the
emitting elements of the sources, we reconstruct their lensed
surface brightness distributions on the CCD;

(v) we model the surface brightness distribution of the
cluster galaxies using single or double Sersic models (S´ersic
1963). These are obtained by ﬁtting real cluster galaxies in
a set of low to intermediate redshift clusters (Gonzalez et al.
2005). The Brightest Cluster Galaxies (BCGs) all include a
large scale component used to model the intra-cluster-light
produced by the BCG stellar halos and by free-ﬂoating stars;
(vi) the SEDs of the cluster galaxies are modeled accord-
ing to prescriptions from semi-analytic models or from the
Halo-Occupation-Distribution technique, as explained ear-
lier;

(vii) we convert the surface brightness distributions into
counts per pixel assuming a telescope throughput curve,
which accounts for the optics, the camera and the ﬁlter used
in carrying out the simulated observations. In each band, we
simulate the exposure times (in units of HST orbits4) used
to carry out the mock Frontier Fields observations;

Filter

n. of orbits

bkg level
[106 counts sec−1]

F435W
F606W
F814W
F105W
F125W
F140W
F160W

18
10
42
24
12
10
24

0.615
1.821
2.227
1.136
1.122
1.371
0.959

Table 1. Details of the simulated observations. First column:
ﬁlters employed; Second column: exposure time in terms of HST
orbits; Third colum: level of the background (counts/sec in circles
with radius 0.2 arcsec)

(viii) the images are then convolved with a PSF model,
obtained using the Tiny Tim HST PSF modeling software
(Krist et al. 2011). Finally, realistic noise is added mimick-
ing the appropriate sky surface brightness in the simulated
bands. The noise is assumed to have a Poisson distribution,
and it is calculated according to Meneghetti et al. (2008) Eq.
31, assuming a stack of multiple exposures, with the number
varying from band to band5.

2.4 Images and catalogs

This is the ﬁrst phase of a comparison project, and in the
next phase we intend to include additional simulations with
an even greater level of realism. For this ﬁrst exercise, we
proceed as follows.

• For both Ares and Hera, we generate simulated HST
observations in all bands that are deployed for the FFI,
mimicking the same exposure times (or number of orbits)
as the real observations. The level of the background is set
to values provided by the ACS and WFC3 exposure time
calculators in each band. The details of these simulations
are provided in Table 1. Each image covers a ﬁeld of view of
204 × 204 arcsec2. All images are co-aligned and co-rotated.
Eﬀects like gaps between chips, pixel defects, charge transfer
ineﬃciency, cosmic rays, etc. are not included. The resolu-
tion of the ACS and WFC3 simulations are 0.05 arcsec/pixel
and 0.13 arcsec/pixel, respectively. These images were made
available to the modelers.

• In addition to the images, we provided the list of all mul-
tiple images obtained from the ray-tracing procedure (see
Fig. 3, central panels). Each multiple-image system is char-
acterized by the redshift of its source, which is also provided
to the modelers. Thus, in this exercise we assume that all
images can be identiﬁed without errors and that all their red-
shifts can be measured “spectroscopically”. This is certainly
a very optimistic assumption which will never be satisﬁed in
the real world. In the next round of this comparison project,
the assumption will be relaxed, but for the moment we de-
cided to release this information because our objective is to
determine possible systematics of the various reconstruction
algorithms. Other issues related to the approaches used to
search for multiple images or the impact of redshift uncer-
tainties on the results will be studied in a future work. Some

4 We assume an orbital visibility period of 2500 sec

5 two exposures per orbit per ﬁlter

MNRAS 000, 1–?? (2016)

8 M. Meneghetti et al.

Figure 3. Color composite images of Ares and Hera (left and right panels, respectively). In the upper panels, we overlay to the optical
images the surface density iso-contours. In the central panels, we show the critical lines for zs = 1 (red) and zs = 9 (white). In addition,
we display the location of the multiple image systems (numbered yellow circles). The galaxies identiﬁed as cluster-members are indicated
by white circles in the lower panels.

MNRAS 000, 1–?? (2016)

The Frontier Fields Lens Modeling Comparison Project

9

of these systematics have already been investigated for some
lens modeling methods, i.e., Johnson & Sharon (2016, sub-
mitted).

• We also released a catalog of cluster members (circled in
the right panels of Fig. 3), containing positions and photom-
etry in all bands. Several reconstruction methods (in par-
ticular those employing the parametric approach) build the
lens model by combining smooth dark matter halos with sub-
structures associated to the cluster members akin to our con-
struction of Ares . In this simpliﬁed test, modelers are pro-
vided with the list of all cluster members with mAB,F814W < 24.
Again, this is an over-simpliﬁcation which will be removed
in the next round of simulations, and which implicitly favors
those methods which make use of this information. In reality,
such methods have to deal with the risks of misidentiﬁcation
of cluster members.

• For those groups which make use of weak-lensing mea-
surements to complement the strong-lensing constraints, we
produced a single Subaru-like R-band image of both Ares
and Hera covering a much larger FOV of 30 × 30 arcmin2.
The provided image contained only background galaxies (i.e.
lensed by the clusters) and stars, so that shape measure-
ments could be made using any weak-lensing pipeline with-
out worrying about the separation of background sources
from the cluster members or contamination by foreground
galaxies. We also use the publicly available pipeline KSBf906
(Heymans et al. 2006) based on the Kaiser, Squires and
Broadhurst method (Kaiser et al. 1995) to derive a catalog
containing galaxy positions and ellipticities. The resulting
number density of galaxies useful for the weak-lensing anal-
ysis is ∼ 14 gal/sq. arcmin. This is signiﬁcantly smaller than
the number density achievable with HST.

All these data for the mock cluster lenses were shared with
lens modelers participating in the project via a dedicated
website7. We emphasize that the input mass distributions of
the lenses and the techniques used to generate them were
initially kept blinded to all groups. The strong lensing con-
straints amounted to 242 multiple images produced by 85
sources in the case of Ares and 65 images of 19 sources in
the case of Hera.

3 LENS MODELING TECHNIQUES

3.1 Submission of the models

A large fraction of lens modelers currently working actively
on the analysis of the FFI data accepted the challenge and
participated in this project. The two cluster simulations were
not released simultaneously. We initially released only the
data for Ares, and we received reconstructed models for this
cluster from 7 groups. These groups performed a fully blind
analysis of the data-set. Two additional models were sub-
mitted by A. Zitrin after the input mass distributions were
already revealed, under the assurance that the reconstruc-
tion was actually performed blindly.

In a second stage of the comparison exercise, we released

6 http://www.roe.ac.uk/∼heymans/KSBf90/Home.html
7 http://pico.bo.astro.it/∼massimo/Public/FF

MNRAS 000, 1–?? (2016)

the simulation of Hera, and received 8 models from 6 partic-
ipating groups. Also for this cluster, we received additional
reconstructions after we revealed the input mass distribu-
tion of the lens. These models were submitted by A. Zitrin
and by D. Lam.

There are two general classes of inversion algorithms.
They comprise parametric models wherein the mass distribu-
tion is reconstructed by combining clumps of matter, often
positioned where the brightest cluster galaxies are located,
each of which is characterized by an ensemble of parame-
ters including the density proﬁle and shape. The parameter
spaces of these models are explored in an eﬀort to best re-
produce the observed positions, shapes and magnitudes of
the multiple images and arcs. The second approach is called
free-form (a.k.a. non-parametric): wherein now the cluster is
subdivided into a mesh onto which the lensing observables
are mapped, and which is then transformed into a pixelised
mass distribution following several methods to link the ob-
servable to the underlying lens potential or deﬂection ﬁeld.
Both these approaches were amply represented in the
challenge. A summary of all submitted models, with the indi-
cation of whether they are parametric or free-form and built
before or after the input mass distribution of the lenses was
revealed is given in Table 2. Each model is given a reference
name used throughout the paper. Each modeling technique
is brieﬂy described below.

3.2 SWUnited: The Bradac-Hoag model

The Bradac-Hoag model employs the method named SWU-
nited: Strong and weak lensing mass reconstruction on a
non-uniform adapted grid. This combined strong and weak
lensing analysis method reconstructs the gravitational po-
tential ψk = ψ(θk) on a set of points θk, which can be randomly
distributed over the entire ﬁeld-of-view. From the potential,
any desired gravitational lensing quantity (e.g. surface mass
density, deﬂection angle , magniﬁcation, ﬂexion, etc.) can
be readily calculated. Such an approach therefore does not
require an assumption of e.g. a particular model of the po-
tential/mass distribution. The potential is reconstructed by
maximizing a log likelihood log P which uses image positions
of multiply imaged sources and source plane minimization
(corrected by magniﬁcation); weak lensing ellipticities, and
regularization as constraints. Current implementation also
includes ﬂexion measurements, however the data was not
used in this paper.

3.2.1 Description of the method

The implementation of the method follows the algorithm
ﬁrst proposed by Bartelmann et al. (1996) and is described
in detail in Bradaˇc et al. (2005) and Bradaˇc et al. (2009).
From the set of potential values they determine all observ-
ables using derivatives. For example, the convergence κ is
related to ψ via the Poisson equation, 2κ = ∇2ψ (where the
physical surface mass density is Σ = κ Σ
crit depends
upon the angular diameter distances between the observer,
the lens, and the source). The details on how the derivatives
on an non-uniform grid are evaluated can be found in Bradaˇc
et al. (2009). By using a reconstruction grid whose pixel
scale varies across the ﬁeld, the method is able to achieve in-
creased resolution in the cluster centre (close to where we see

crit and Σ

10 M. Meneghetti et al.

Group/Author

Method

Model

Cluster

Approach

Blind

M. Bradac & A. Hoag
J. Diego
J. Diego
J. Diego
D. Lam
J. Liesenborgs, K. Sebesta & L. Williams
D. Coe
CATS
T. Johnson & K. Sharon
T. Ishigaki, R. Kawamata & M. Oguri
A. Zitrin
A. Zitrin

SWUnited
WSLAP+
WSLAP+
WSLAP+
WSLAP+
Grale
LensPerfect
Lenstool
Lenstool
GLAFIC
LTM
PIEMDeNFW

Bradac-Hoag
Diego-multires
Diego-overﬁt
Diego-reggrid
Lam
GRALE
Coe
CATS
Johnson-Sharon
GLAFIC

Ares+Hera
Hera
Hera
Ares+Hera
Hera
Ares+Hera
Ares
Ares+Hera
Ares+Hera
Ares+Hera
Zitrin-LTM-gauss Ares+Hera
Ares+Hera

Zitrin-NFW

free-form
hybrid
hybrid
hybrid
hybrid
free-form
free-form
parametric
parametric
parametric
parametric
parametric

yes
yes
yes
yes
no
yes
yes
yes
yes
yes
no
no

Table 2. Models submitted by the groups participating in the project. The table lists the name of the submitting group/author of the
reconstruction, the reference name of the model, the type of algorithm (free-form, parametric, or hybrid) and whether the model was
submitted blind, that is before the input mass distribution of the lens was revealed.

strongly lensed images), and hence the magniﬁcation map in
the regions of high magniﬁcation is more accurate. The pos-
terior peak values of the potential ψk are found by solving
the non-linear equation ∂ log P/∂ψk = 0. This set of equa-
tions is linearized and a solution is reached in an iterative
fashion (keeping the non-linear terms ﬁxed at each iteration
step). This requires an initial guess for the gravitational po-
tential; the systematic eﬀects arising from various choices
of this initial model were discussed in Bradaˇc et al. (2006).
The choice of particular grid geometry, the regularisation
parameter, and the hyper-parameters that set the relative
weighting between the contributions to log P all become crit-
ical when weak lensing data on large scales ((cid:38) 1Mpc) are
included, and we need a full-ﬁeld mass reconstruction. This
is not the case in this work, as we are only interested in the
magniﬁcation of the inner region.

The reconstruction is performed in a two-level iteration
process, outlined in Fig. 4. The inner-level iteration process
described above for solving the non-linear system of equa-
tions ∂ log P/∂ψk = 0 is solved in iterative fashion and re-
peated until convergence of κ. The outer-level iteration is
performed for the purpose of regularisation. In order to pe-
nalise small-scale ﬂuctuations in the surface mass density,
the reconstruction is started with a coarse grid (large cell
size). Then for each n2 step the number of grid points is
increased in the ﬁeld and the new reconstructed κ(n2) is com-
pared with the one from the previous iteration κ(n2−1) (or with
= 0), penalizing any large
the initial input value κ(0) for n2
deviations. The second-level iterations are performed until
the ﬁnal grid size is reached and convergence is achieved.

3.2.2 Strengths and Weaknesses of the Method

The main strength of the method as discussed above is that
instead of ﬁtting a speciﬁc set of family of models to the
data, the method is free of such an assumption. Further-
more the positions of the points where potential is recon-
structed (θk) can be chosen arbitrarily, which allows them to
use higher density of points in the regions where signal-to-
noise is the highest (i.e. where multiple images are present),
and they can employ coarser sampling in the areas where this
is not the case (e.g. at large radii from the centre). They are
also reconstructing the potential (rather than traditionally
used surface mass density), since it locally determines both

Figure 4. The outline of the method used to build the Bradac-
Hoag model and the two-level iteration process.

the lensing distortion (for weak lensing and ﬂexion) as well
as the deﬂection (for strong lensing) and there is no need to
assume the surface mass denisty values beyond the observed
ﬁeld.

The main weakness of the method on the other hand is
the fact that they are trying to maximize a function with
a large number of parameters and the method is inherently
unstable. The inversion of the matrix satisfying the equation
∂ log P/∂ψk = 0 is also very noisy. The method is therefore
very likely to diverge or land in a secondary minimum. Reg-
ularization needs to be employed, which adds an additional
parameters (relative weighting of regularization term) to the
rest of log P and a choice of regularization method itself.
The optimal choices need to be determined using simulation
data.

3.2.3 Improvements in progress

A recent improvement to the method is the addition of the
measurement of ﬂexion to the input constraints. The code
has been adapted (see also Cain et al. 2015) and tested on
simulated data. The group is currently testing it using HST

MNRAS 000, 1–?? (2016)

The Frontier Fields Lens Modeling Comparison Project

11

data. In the future they plan to port the code into python
to make the interface user friendly, at which point they plan
to release it to the community.

3.3 WSLAP+: The Diego and the Lam models

All Diego models (Diego-multires, Diego-overﬁt and Diego-
reggrid models) and the Lam model are built using
WSLAP+, a free-form or non-parametric method that in-
cludes also a compact mass component associated to the
cluster members (thus, classiﬁed as hybrid in this paper).
The main part of the code is written in fortran and com-
piles with standard compilers (like gfortran) included in the
most common linux distributions. Plotting routines written
in IDL are available to display the intermediate results as
the code runs. A script interface allows the user to deﬁne
the input and output ﬁles, select the parts of the code to be
run and control the plotting routines. A detailed description
of the code and of its features can be found in the papers
by (Diego et al. 2005, 2007; Sendra et al. 2014; Diego et al.
2016). The code is not publicly available yet but a compan-
ion code LensExplorer is available. LensExplorer allows the
user to easily explore the lens models derived for the Fron-
tier Fields clusters, search for new counter-images, compute
magniﬁcations, or predict the location and shape of multiple
images. Here we present a brief summary of the main code
WSLAP+. Note that the code includes certain features that
were not taken into account in the analysis presented in this
paper but will be included in the future “unblinded” version
of this work. Among these features, the code incorporates
spatial information about knots in resolved systems greatly
improving the accuracy and robustness of the results (see
Diego et al. 2016,
for s practical demonstration). In the
present work, only long elongated arcs were considered as
resolved systems.

3.3.1 Description of the method

The algorithm divides the mass distribution in the lens plane
into two components. The ﬁrst is a compact one and is asso-
ciated with the member galaxies. The member galaxies are
selected from the red sequence. The second component is
diﬀuse and is distributed as a superposition of Gaussians on
a regular (or adaptive) grid. For the compact component,
the mass associated to the galaxies is assumed to be pro-
portional to their luminosity. If all the galaxies are assumed
to have the same mass-to-light (M/L) ratio, the compact
component (galaxies) contributes with just one (Ng = 1) ex-
tra free-parameter which corresponds to the correction that
needs to be applied to the ﬁducial M/L ratio. In some partic-
ular cases, some galaxies (like the BCG or massive galaxies
very close to an arclet) are allowed to have their own M/L
ratio adding additional free-parameters to the lens model
but typically no more than a few (Ng ∼ O(1)). For this com-
ponent associated to the galaxies, the total mass is assumed
to follow either a NFW proﬁle (with ﬁxed concentration
and scale radius scaling with the ﬁducial halo mass) or be
proportional to the observed surface brightness. The diﬀuse
or ‘soft’ component is described by as many free parame-
ters as grid (or cell) points. This number (Nc) varies but
is typically between a few hundred to one thousand (Nc ∼

MNRAS 000, 1–?? (2016)

O(100)-O(1000)) depending on the resolution and/or use of
the adaptive grid. In addition to the free parameters describ-
ing the lens model, the method includes as unknowns the
original positions of the lensed galaxies in the source plane.
For the clusters included in the FFI program the number of
background sources, Ns, is typically a few tens (Ns ∼ O(10)),
each contributing with two unknows (βx and βy). All the
unknowns are then combined into a single array X with Nx
elements (Nx ∼ O(1000).

The observables are both strong lensing and weak lens-
ing (shear) measurements. For strong lensing data, the in-
puts are the pixel positions of the strongly lensed galax-
ies (not just the centroids). In the case of long elongated
arcs near the critical curves with no features, the entire
arc is mapped and included as a constraint. If the arclets
have individual features, these can be incorporated as semi-
independent constraints but with the added condition that
they need to form the same source in the source plane. In-
corporating this information acts as an anchor constraining
the range of possible solutions and reducing the risk of a bias
due to the minimization being carried in the source plane.
For the weak lensing, we use shear mesurements (γ1 and
γ2). The weak lensing constraints normally complement the
lack of strong lensing constraints beyond the central region
allowing for a mass reconstruction on a wider scale. When
weak lensing information is used, the code typically uses an
adaptive grid to extend the range up to the larger distances
covered by the weak lensing data (Diego et al. 2015a)

The solution, X, is obtained after solving the system of

linear equations

Θ = ΓX

(10)

where the No observations (strong lensing, weak lensing, time
delays) are included in the array Θ and the matrix Γ is known
and has dimension No x(Nc + Ng + 2Ns) In practice, X, is ob-
tained by solving the set of linear equations described in
Eq. 10 via a fast bi-conjugate algorithm, or inverted with a
singular value decomposition (after setting a threshold for
the eigenvalues) or solved with a more robust quadratic al-
gorithm (slower). The quadratic algorithm is the preferred
method as it imposes the physical constrain that the solu-
tion X must be positive. This eliminates un-physical solu-
tions with negative masses and reduces the space of possible
solutions. Errors in the solution are derived by minimizing
the quadratic function multiple times, after varying the ini-
tial conditions of the minimization process, and/or modi-
fying the grid, and/or changing the ﬁducial deﬂection ﬁeld
associated to the member galaxies.

3.3.2 Strengths and weaknesses of the method

The code implements a free-form modeling component. This
implies that no strong assumptions are necessary about the
distribution of dark matter. This is particularly useful if DM
is not linked to the galaxies or if the baryons are also dis-
sociated from the galaxies. The later seems to be the case
in the FFI clusters which are in a merging phase. Evidence
that the solution obtained by the algorithm may be sensitive
to the mass of the X-ray emitting plasma was presented in
Lam et al. (2014); Diego et al. (2015b, 2016, 2015c).

The algorithm is very fast. Several methods are imple-
mented to search for a solution. Using the bi-conjugate gra-

12 M. Meneghetti et al.

Figure 5. Diagram showing the work-ﬂow of WSLAP+

dient algorithm a solution can be obtained in seconds. Using
the slower, but more reliable, quadratic optimization ap-
proach a robust solution can be obained in minutes. Other
fast approaches have been implemented as well like singular-
value-decomposition.

An adaptive grid can be used that transforms the
method into a multiresolution code. Diﬀerent adaptive grids
can be implemented that introduce a small degree of free-
dom but also allows to explore other possible solutions and
hence constrain better the variability of the solution.

The code is prepared to combine weak and strong lens-
ing. The relative weight of the two data sets is given by
the intrinsic errors in the data sets (typically small in the
strong lensing regime and larger in the weak lensing regime).
Correlations between the lensing data can be incorporated
through a covariance matrix that naturally weights the dif-
ferent data sets.

The minimization is made in the source plane which
may result in biases towards larger magniﬁcations. To avoid
this, the minimization algorithm needs to be stopped after
a given number of iterations. Even better, including infor-
mation about the size and shape of the sources in the source
plane seems to solve this problem and the solution remains
stable and unbiased even after a very large number of it-
erations. These prior information on the size and shape of
the source galaxies is only possible when well resolved lensed
images are available and at least one of the multiple images
is not highly magniﬁed.

The compact component is pixelized usually into a
512×512 image that covers the ﬁeld of view. For the small
member galaxies this pixelization results in a loss of resolu-
tion that have a small impact on lensed images that happen
to be located near this small member galaxies. A possible
solution to alleviate this problem is to pre-compute the de-
ﬂection ﬁeld of these galaxies prior to the minimization at
higher resolution and later interpolate at the position of the
observed lensed galaxies. This approach has not been imple-
mented yet but it is expected to eliminate this problem.

The code can also predict more multiple images than ob-
served. This is not being factored in at the moment but will

be the subject of the null space implementation described
in section 3.3.3. One systematic bias is know to aﬀect the
results at large distances from the centre. The reconstructed
solution systematically underpredcits the mass (and magni-
ﬁcation) in the regions where there is no lensing constraints.
These regions are normally located beyond the correspond-
ing Einstein radius for a high redshift background source.
Addition of weak lensing to then constraints can reduce or
eliminate this problem.

3.3.3 Improvements in progress

The addition of time delays is being implemented to the
reconstruction of the solution. Time delays will be included
in a similar footing as the other observables (weak and strong
lensing observables) with a weight that is proportional to
their associated observational error.

The addition of the null space was proven to be a useful
and powerful way of improving the robustness of the derived
solution (Diego et al. 2005). This direction has not been ex-
plored fully and we plan to incorporate the null space as an
additional constraint. This will eliminate additional coun-
terimages that are predicted by the model but not observed
in the data.

3.3.4 Modeling of Ares and Hera

The Diego models use both a regular grid with 32x32=1024
grid points (Diego-reggrid model) and a multi-resolution
grid with approximately half the number of grid points
(Diego-multires model). The compact component of the de-
fection ﬁeld is constructed based on the brightest elliptical
galaxies in the cluster. We include 50 such bright ellipticals
for each cluster. The mass proﬁle for each galaxy is taken
either as an NFW with scale radius (and total mass) scal-
ing with the galaxy luminosity or directly as the observed
surface brightness. This choice plays a small role in the ﬁnal
solution.

Depending on the number of iterations, diﬀerent solu-
tions can be obtained. Earlier work based on simple simula-
tions (Sendra et al. 2014) showed how in a typical situation
(similar to the one in Ares and Hera), after 10000 iterations
of the code the solution converges to a stable point. The
code can be left iterating longer reaching a point that we
refer as ”overﬁt” where the observed constraints are repro-
duced with great accuracy but sometimes at the expense of a
model with fake structures. In the case of Hera we computed
the solution also in the overﬁt regime (90000 iterations) for
comparison purposes (Diego-overﬁt model).

The Lam model diﬀers from the Diego models as fol-
lows. A regular grid of Gaussian functions is used instead
of a multi-resolution grid (as in diego-multires). In order to
thoroughly explore the parameter space and to estimate the
statistical uncertainty, 100 individual lens models are con-
structed from random initial conditions. Also, the submitted
model is an average of these 100 individual models. With
the exception of the 10 brightest cluster galaxies, the rela-
tive masses of all cluster galaxies are ﬁxed, and are derived
using a stellar mass-dark matter mass relation found in the
EAGLE cosmological hydrodynamical simulation (Schaller
et al. 2015). The stellar masses of cluster galaxies are de-

MNRAS 000, 1–?? (2016)

  Compute Gamma MatrixTransform                  Into    quadratic function, F(X)XMin F(x)   Bi-conjugate gradient Quadratic ProgrammingSingular Value Decomp.Reconstruct MassSolution XSet GridSet input data   Predict source plane  Magnific. & Crit. Curves   Compute Time delays IterateThe Frontier Fields Lens Modeling Comparison Project

13

rived from ﬁtting synthesized spectra to the measured pho-
tometry using FAST (Kriek et al. 2009). The contribution
from cluster galaxies are parameterized by NFW halos with
scale radii derived from the dark matter mass using again a
relation found in the same simulation.

3.4 Grale: the GRALE model

The GRALE models are based on the reconstruction code
Grale8. Grale is a ﬂexible, free-form method, based on a
genetic algorithm, that uses an adaptive grid to iteratively
reﬁne the mass model. As input it uses only the informa-
tion about the lensed images, and nothing about cluster’s
visible mass (Liesenborgs et al. 2006). This last feature sets
Grale apart from many other lens mass reconstruction tech-
niques, and gives it the ability to test how well mass follows
light on small and large scales within clusters. Grale has
been used to reconstruct mass distributions in a number of
clusters (Liesenborgs et al. 2008, 2009; Mohammed et al.
2014, 2015), quantify mass/light oﬀsets in Abell 3827 (Mo-
hammed et al. 2014; Massey et al. 2015), derive projected
mass power spectra and compare to those of simulated clus-
ters (Mohammed et al. 2016), and to study the relation be-
tween mass and light in MACS0416 (Sebesta et al. 2015).
These papers used strong lensing constraints only, and so
the analysis was conﬁned to the central regions of galaxy
clusters.

3.4.1 Description of the method

Grale starts out with an initial coarse uniform grid in the
lens plane which is populated with a basis set, such as pro-
jected Plummer density spheres. A uniform mass sheet cov-
ering the whole modeling region is also added to supplement
the basis set. As the code runs the denser regions are resolved
with a ﬁner grid, with each cell given a Plummer with a pro-
portionate width. The initial trial solution, as well as all later
evolved solutions are evaluated for genetic ﬁtness, and the
ﬁt ones are cloned, combined and mutated. The ﬁnal map
consists of a superposition of a mass sheet and many Plum-
mers, typically several hundred to a couple of thousand, each
with its own size and weight, determined by the genetic al-
gorithm. Critical curves, caustics and magniﬁcations for any
given source redshift are automatically available.

Multiple ﬁtness measures are used in Grale. These are:
(a) Image positions. A successful mass map would lens
image-plane images of the same source back to the same
source location and shape. A mass map has a better ﬁtness
measure if the images have a greater fractional degree of
overlap. Using fractional overlap of extended images ensures
against over-focusing, or over-magnifying images. (b) Null
space. Regions of image plane that deﬁnitely do not contain
any lensed features belong to the null space. (c) Critical
lines. In some cases, it is known on astrophysical grounds
that a critical line cannot go through certain image regions,
but must pass between them. Grale can incorporate this

8 Grale’s description, software and installation instructions are
available at
http://research.edm.uhasselt.be/∼jori/grale

MNRAS 000, 1–?? (2016)

type of constraint, but we have not used this ﬁtness mea-
sure in the Frontier Fields work so far. (d) Time delay mea-
surements. Though not used in the present work, time de-
lays measurements can also be incorporated into the ﬁtness
(Liesenborgs et al. 2009; Mohammed et al. 2015).

Each Grale run with the same set of images will pro-
duce a somewhat diﬀerent ﬁnal map. The dispersion between
these quantiﬁes mass uncertainties which are due to mass de-
generacies present when all image information is held ﬁxed.
The best known among these, the mass sheet degeneracy,
is broken in most clusters because of the multiple redshifts
of background sources. The other, more numerous and less
known degeneracies—documented (Saha 2000; Liesenborgs
& De Rijcke 2012) and not documented—are the ones that
contribute to the uncertainties.

The clusters Ares and Hera were modeled with multiple
images as inputs, and using two ﬁtness measures: (a) im-
age positions, and (b) null space for each source (image set)
separately. For image sets where it was not entirely clear
if or where the counterimages might be present, the nulls
were allowed to have large holes corresponding to the re-
gions of possible additional images. Grale can operate in
two modes: with lensed images represented by points, or by
extended images. The present reconstruction were done us-
ing the extended image mode.

3.4.2 Strengths and weaknesses

The main advantage of Grale is its ﬂexibility, and hence
ability to explore a wide range of lensing mass degenera-
cies. Another important feature, which can be viewed as
strength, is that Grale does not use cluster galaxies, or any
information about the distribution of luminous matter to do
the mass reconstruction. This is useful if one wants to test
how well mass follows light (Mohammed et al. 2014; Sebesta
et al. 2015).

Grale’s main weakness is that it is not an optimal tool
for identifying lensed images. This is a direct consequence,
or, one may say, the ﬂip side of Grale’s ﬂexibility. A tech-
nical feature of Grale worth mentioning is that it requires
signiﬁcant computational resources: Grale runs on a super-
computer.

3.4.3 Improvements in progress

The Grale team has carried out numerous tests of the code,
to optimize the set of genetic algorithm and other code pa-
rameters. In the near future Grale will be extend to include
ﬁtness measure constraints from weak shear and ﬂexion.

3.5 LensPerfect: the Coe model

The Coe model for Ares uses LensPerfect9 (Coe et al. 2008,
2010). LensPerfect makes no assumptions about light trac-
ing mass. The lens models perfectly reproduce the input
observed positions of all strongly lensed multiple images.
Redshifts may be either ﬁxed to input spectroscopic red-
shifts or included in the model optimization based on input
photometric redshifts and uncertainties.

9 http://www.stsci.edu/∼dcoe/LensPerfect/

14 M. Meneghetti et al.

The image positions, redshifts, and estimated source po-
sitions deﬁne the lensing deﬂection ﬁeld sparsely at the mul-
tiple image positions. LensPerfect interpolates this vector
ﬁeld, obtaining a smooth model which exactly reproduces
the image deﬂections at the input image positions. Based on
this 2D deﬂection map, the mass distribution, magniﬁcation,
and all other model quantities may be derived.

3.5.1 Description of the Method

The curl-free vector interpolation scheme (Fuselier 2006;
Fuselier 2007) uses direct matrix inversion to obtain a model
composed of radial basis functions (RBFs) at the positions
of the input vectors (our multiple image locations). Each 2D
RBF has two free parameters – amplitude and rotation angle
– which are determined uniquely by the matrix inversion.

After setting the width of the RBF, the free param-
eters are the source positions and any uncertain redshifts.
LensPerfect performs an optimization routine searching for
those parameters which yield the most ˆa ˘AIJphysicalˆa ˘A˙I
mass model according to a set of criteria including positive
mass smoothly decreasing outward from the center on aver-
age with rough azimuthal symmetry. See Coe et al. (2008,
2010) for more details.

3.5.2 Strengths and Weaknesses

In high-resolution HST ACS images, strongly lensed multi-
ple image locations are observed and measured with accu-
racies of ∼1 pixel, or ∼0.05”. By fully utilizing this infor-
mation, LensPerfect is able to obtain relatively high resolu-
tion maps of galaxy cluster substructure without relying on
any assumptions about light tracing mass. Large numbers
of multiple images may be input, and the number of free
parameters is always roughly equal to the number of con-
straints. The mass model spatial resolution increases with
the density of multiple images on the sky.

Given current numbers of multiple images (up to ∼100
or so) for a single cluster (e.g., Coe et al. 2010), LensPerfect
can accurately recover cluster mass proﬁles along with some
larger subhalos. Magniﬁcations, however, are inﬂuenced by
local mass density gradients, which are not accurately re-
produced by LensPerfect given current constraints. Further-
more, LensPerfect mass models are only well constrained
within the area enclosed by the multiple images and should
generally be disregarded outside this region.

3.5.3 Future improvements

LensPerfect is well suited to future datasets such as JWST
imaging revealing still greater numbers of multiple images.
Initial tests with hundreds to a thousand multiple images
show great potential for resolving many individual cluster
galaxy halos without assuming light traces mass. The biggest
hurdle (seen in tests with up to 10,000 multiple images) may
be accounting for multiple lens plane deﬂections due to mass
along the line of sight.

One potential improvement would be to develop a hy-
brid method combining light traces mass assumptions with
LensPerfect adding deviations to the mass distribution.

3.6 Lenstool: the CATS and Johnson-Sharon

models

Lenstool as an inversion algorithm deploys both strong and
weak lensing data as input constraints. Below, we ﬁrst brieﬂy
outline the available capabilities of the tt Lenstool software
package and then describe the speciﬁc versions and assump-
tions that were used to reconstruct Ares and Hera by two
groups: CATS and Johnson-Sharon. The CATS collabora-
tion developed the Lenstool algorithm collectively over a
decade. The code utilizes the positions, magnitudes, shapes,
multiplicity and spectroscopic redshifts for the multiply im-
aged background galaxies to derive the detailed mass dis-
tribution of the cluster. The overall mass distribution in
cluster lenses is modeled in Lenstool as a super-position
of smoother large-scale potentials and small scale substruc-
ture that is associated with the locations of bright, cluster
member galaxies. Individual cluster galaxies are always de-
scribed by parametric mass models, whereas the smoother,
large-scale mass distribution can be ﬂexibly modeled non-
parametrically or with speciﬁc proﬁles. This available multi-
scale approach is optimal, in as much as the input con-
straints required for this inversion exercise are derived from
a range of scales. Further details of the methodology are
outlined in Jullo & Kneib (2009). In its current implemen-
tation in Lenstool, the optimization of the combined para-
metric and non-parametric model is computationally time
intensive. And some degeneracies persist, despite the large
number of stringent input constraints from the positions,
shapes, brightnesses, and measured spectroscopic redshifts
of several families of multiple images. However, these de-
generacies are well understood, in particular for speciﬁc pa-
rameters of models used to characterize the mass distribu-
tion. In order to tackle this challenge an iterative strategy
has been developed wherein initial models are derived with
the best-ﬁt values solely from the parametric model, which
are then optimized using the underlying multi-scale grid.
Both the multi-scale and the parametric models are adjusted
in a Bayesian way, i.e.,their posterior probability density is
probed with a MCMC sampler. This process allows an easy
and reliable estimate of the errors on derived quantities such
as the ampliﬁcation maps and the mass maps.

The CATS and the Sharon Johnson models are built
using the Lenstool public modeling software (see e.g. Jullo
et al. 2007). The public version of Lenstool deployed by
Johnson-Sharon adopts the original modeling approach de-
veloped by Natarajan & Kneib (1997) wherein a small-scale
dark-matter clump is associated with each bright cluster
galaxy and a large-scale dark-matter clump with prominent
concentrations of cluster galaxies. This technique of associ-
ating mass and light has proven to be very reliable and re-
sults in mass distributions that are in very good agreement
with theoretical predictions from high-resolution cosmologi-
cal N-body simulations. The Johnson-Sharon models follow
the methods described in Sharon et al. (2012); Johnson et al.
(2014).

3.6.1 Description of the method

Typically, cluster lenses are represented by a few cluster-
scale or group-scale halos (representing the smooth compo-
nent, with σ in the range of hundreds to ∼ 1500 km s−1), with

MNRAS 000, 1–?? (2016)

The Frontier Fields Lens Modeling Comparison Project

15

contribution from galaxy-scale halos (see below). Large scale
dark matter halos are parametrized as Pseudo-Isothermal
Elliptical Mass Distribution (PIEMD),

ρ(r) =

ρ0

(1 + r2/r2

core)(1 + r2/r2

cut)

,

(11)

where ρ0 is a normalization, and rcore and rcut deﬁne a region
rcore (cid:46) r (cid:46) rcut in which the mass distribution is isothermal,
i.e., ρ ∝ r−2. In Lenstool, PIEMD has seven free parame-
ters: x, y are the coordinates on which the halo is centered, e
and θ are the ellipticity and the position angle, respectively;
rcore; rcut; and eﬀective velocity dispersion σ0 which deter-
mines the normalization (we note that the σ0 is not exactly
the observed velocity dispersion, see El´ıasd´ottir et al. 2007).
The parameters of cluster-scale halos are kept free, with the
exception of rcut which is usually unconstrained by the strong
lensing data, and is thus ﬁxed at an arbitrary value (typi-
cally 1500 kpc).

CATS also model galaxies as PIEMD, whereas Johnson-
Sharon model galaxies as circular isothermal distributions
(see 3.6.5). To keep the number of free parameters reason-
ably small, the parameters of galaxy-scale halos are deter-
mined from their photometric properties through scaling re-
lations assuming a constant mass-to-light ratio for all galax-
ies,

σ0

= σ∗
0

(cid:17)1/4

(cid:16) L
L∗

and

rcut = r∗
cut

(cid:17)1/2

.

(cid:16) L
L∗

(12)

The positional parameters, x, y, e, and θ, are ﬁxed to their
observed values as measured from the light distribution in
the imaging data.

CATS used the simulated strong lensing catalogs and
the Lenstool software to perform a mass reconstruction of
both simulated clusters, assuming a parametric model for
the distribution of dark matter. The model is optimized with
the Bayesian Markov chain Monte-Carlo sampler, described
in detail in Jullo et al. (2007). The mass distribution is op-
timized in the image plane by minimizing the distance be-
tween the observed and predicted multiple image positions.
Weak lensing information is not taken into account. The
image-plane root mean squared (RMSi) distance of the im-
ages predicted by the model were used to compare with the
observed positions as an accuracy estimator of the model
(Limousin et al. 2007).

The CATS collaboration has modeled both clusters,
Ares andHera have been modeled as bi-modal clusters with
two smooth dark matter clumps and two BCGs lying in
the centre of those main clumps. Each smooth compo-
nent is modeled using a PIEMD proﬁle. Cluster member
galaxies are taken from the given simulated catalogs up
to a magnitude of m f 160w < 22.0 for Ares and m f 814w <
24.0 for Hera. These are modeled with PIEMD proﬁles
under the assumption that (i) their position, ellipticity
and orientation corresponds to the brightness proﬁle of
their associated galaxy, (ii) their mass is proportional to
the galaxy magnitudes in F160W band. In the provided
models, it is assumed that they all have the same M/L
ratio. All multiple images provided were used in this model.
In addition, a few (massive) cluster galaxies in both clusters
were more carefully modelled in order to improve the RMSi
of nearby multiple images. Four central cluster galaxies were
modeled in this way in Hera (of which one is considered to
be a foreground) and three, also central, galaxies in Ares.

MNRAS 000, 1–?? (2016)

These reconstructions have a resulting RMS in the image
plane of 0.87” for Ares and 0.95” for Hera.

The Johnson-Sharon models for Ares andHera were con-
structed using techniques similar to those in Johnson et al.
(2014), using the catalogs of multiple images that were pro-
vided to the lens modelers as positonal constraints. The red-
shifts of the background sources were assumed to be known
spectroscopically with no uncertainty or outliers. Both clus-
ters were modeled with two PIEMD halos, to represent the
smooth dominant dark matter components, each centered
close to the two peaks in the light distribution in the mock
HST images with their exact positions set by the MCMC
minimization process.

Individual PIEMD halos were assigned to each galaxy
in the provided catalog, with positional parameters, x, y, e,
and θ, ﬁxed to their observed values as measured from the
light distribution in the mock imaging data. The parameters
that describe the slope of the projected mass density were
scaled with the light in the F125W band assuming a constant
M/L ratio for all the galaxies, following the scaling relations
in Equation (12). As both clusters are at z 0.5, the same
scaling relations were used for the cluster member galaxies:
= 30 kpc, and
σ(cid:63)
0
m(cid:63) = 20.00, 19.87 for Ares and Hera, respectively.

= 0.15 kpc, and rcut

= 120 km s−1, rcore

A few galaxies located near constraints were modeled
independent of the scaling relations and their core radius
and velocity dispersion were left as free parameters in the
lens models. This includes the two bright cluster galaxies
lying at the centers of the gravitational well of both clumps
in the dark matter distribution in both clusters.

We note that the PIEMD functional form of the clus-
ter galaxies used in Lenstool diﬀers from the function that
was used in the simulation of Ares in the treatment of
the truncation radius. While the PIEMD proﬁle transitions
smoothly from isothermal and asymptotes to zero at large
radii, the simulated mass distribution truncates the mass
function sharply to zero at r = rcut. This discrepancy is what
causes the sharp circular residuals seen in Figure 8. We thus
do not expect the model to accurately reconstruct the mass
distribution at radii larger than the truncation radius.

In addition, the Johnson-Sharon model assumes that
the ellipticity and position angle of the light of each mock
galaxy follows the underlying mass distribution. In practice,
all the galaxies in the underlying simulated mass distribu-
tion had circular geometry (i.e., no ellipticity) and the galax-
ies were painted on with arbitrary ellipticities and position
angles. This feature of the blinded analysis contributes to
residuals on small scales in the mass reconstruction. Finally,
the Johnson-Sharon model does not use weak lensing infor-
mation and does not include cluster-scale halos outside of
the main ﬁeld of view if such halos are not required by the
strong lensing constraints alone.

3.6.2 Strength and weaknesses

Lenstool strengths and weaknesses are typical of parametric
models. This approach is useful in the sense that it directly
compares physically motivated models to data, propagating
errors in a fully consistent an Bayesian manner. It allows
direct comparison with simulation outputs and the assess-
ment of possible discrepancies. On the other hand, para-

16 M. Meneghetti et al.

metric models can signiﬁcantly diﬀer from reality and their
lack of freedom introduces biases in the estimated masses,
matter densities or errors. Regarding practical aspects, er-
rors estimation implies running MCMC sampling, which can
only be performed on supercomputer. Lenstool calculations
can last for a couple of weeks on shared memory machines
depending on the model complexity and the amount of mul-
tiple images. In the case ofHera and Ares, optimization lasts
for about 10 hours.

3.6.3 Improvements in progress

CATS is currently working actively on two improvements
that should signiﬁcantly improve the accuracy of their mass
reconstructions. First, Lenstool in its current revision does
not permit radial variation of the ellipticity for the mass dis-
tribution, and this restricts the ﬂexibility of models that can
be generated. Current code development aims to include this
additional degree of freedom in the modeling. Secondly, in
order to maximally extract information from the exquisite
image resolution aﬀorded by the HST FFI, ﬂexion measure-
ments will be included as input constraints in the model-
ing. Finally, a new MCMC engine with MPI support and
a GPU-based Lenstool are under development to decrease
the computing time.

3.7 GLAFIC: the GLAFIC models

The publicly available GLAFIC code (Oguri 2010)10 is used
for mass modeling in the GLAFIC models.

3.7.2 Strengths and weakness

An advantage of GLAFIC is a wide range of lens potential
implemented in the code, which enables ﬂexible modeling of
cluster mass distributions. For example, in addition to the
standard external shear, one can add higher-order perturba-
tions with arbitrary multipole orders (see Oguri 2010). When
necessary, in addition to observed multiple image positions,
GLAFIC can also include ﬂexible observational constraints
such as time delays and ﬂux ratios between multiple images,
and (reduced) shear and magniﬁcation values at several sky
positions measured by weak lensing and Type Ia supernovae,
respectively.

The source plane χ2 minimization is often adopted for
eﬃcient model optimizations. In doing so, GLAFIC con-
verts the distance between observed and model positions in
the source plane to the corresponding distance in the image
plane using the full magniﬁcation tensor. In Appendix 2 of
Oguri (2010) it has been shown that this source-plane χ2 is
accurate in the sense that it is very close to the image-plane
χ2 and therefore is suﬃcient for reliable mass modeling.

Of course GLAFIC supports the image plane χ2 min-
imization as well. Adaptive-meshing with increased resolu-
tion near critical curves is used for eﬃcient computations of
multiple images for a given source position. Multiple images
and critical curves are computed for the best-ﬁt model from
the source plane χ2 minimization to check the robustness of
the result.

A known limitation of GLAFIC is that it can only han-
dle single lens planes. Lens systems for which multiple de-
ﬂections at diﬀerent redshifts play a crucial role are diﬃcult
to be modeled by GLAFIC.

3.7.1 Description of the method

3.7.3 Modeling Ares and Hera

GLAFIC adopts the so-called parametric lens modeling in
which the lens mass distribution is assumed to consist of
multiple components, each of which is characterized by a
small number of parameters such as the centroid position,
mass, ellipticity, and position angle. Mass distributions of
cluster member galaxies are modeled by the pseudo-Jaﬀe
model. In order to reduce the number of parameters, the ve-
locity dispersion σ and truncation radius rtrunc of each mem-
ber galaxy are assumed to scale with the galaxy luminos-
ity L as σ ∝ L1/4 and rtrunc ∝ Lη, and the normalizations
of the scaling relations are treated as free parameters (see
e.g., Oguri 2010). Ellipticities and position angles of indi-
vidual member galaxies are ﬁxed to values measured in the
image. These parameters are optimized to reproduce posi-
tions of observed multiple images, either using the downhill
simplex method or Markov-Chain Monte Carlo. Examples
of detailed cluster mass modeling with GLAFIC are found
in Oguri (2010), Oguri et al. (2012), Oguri et al. (2013), and
Ishigaki et al. (2015); Kawamata et al. (2016). GLAFIC can
also simulate and ﬁt lensed extended sources. This function-
ality has been used to e.g, ﬁt a lensed quasar host galaxy
(Oguri et al. 2013), estimate a selection function of lensed
high-redshift galaxies (Ishigaki et al. 2015), and derive sizes
of lensed high-redshift galaxies (Kawamata et al. 2015).

10 http://www.slac.stanford.edu/˜oguri/GLAFIC/

Each halo component is modeled by the elliptical NFW pro-
ﬁle. For Ares, ﬁve halo components are included, in addi-
tion to the member galaxies modeled by the pseudo-Jaﬀe
model (see above). For Hera, two NFW halo components
are placed around two brightest galaxies. These two bright-
est galaxies are modeled by the Hernquist proﬁle, separately
from the other member galaxies. Ellipticities and position
angles of the brightest galaxies are ﬁxed to observed values.
To achieve better ﬁt, external shear and third-order multi-
pole perturbation are added for Hera. In modeling member
galaxies, η in the scaling relation of truncation radii is ﬁxed
to 0.5 for Ares and is treated as a free parameter for Hera.
Simulated F814W band images are used to measure lumi-
nosities, ellipticities, and position angles of member galaxies
with SExtractor for both Ares and Hera. Overall, more elab-
orated lens model is adopted forHera compared with Ares,
because in the initial exploration period of mass modeling it
was found that the lens potential ofHera appears to be much
more complex. The resulting best-ﬁt models reproduce im-
age positions very well, with rms of ∼ 0.(cid:48)(cid:48)27 for Ares and
∼ 0.(cid:48)(cid:48)43 for Hera .

3.8 LTM: the Zitrin-LTM models

The Zitrin light-traces-mass (LTM) method (Zitrin et al.
2009; Broadhurst et al. 2005), was designed primarily to
be a very simple, straightforward modeling method with a

MNRAS 000, 1–?? (2016)

The Frontier Fields Lens Modeling Comparison Project

17

minimal number of free parameters, relying only on the ob-
servable light distribution of cluster members (namely their
positions and relative ﬂuxes) to supply a well-guessed and
highly predictive solution to the mass distribution of the
lens and the location of multiple image systems (e.g. Zitrin
et al. 2012, 2013). Previous to the design of this method, it
had been shown that (a) cluster galaxies must be included,
typically with a mass in proportion to their luminosity, in
order the solution to have predictive power to ﬁnd multi-
ple images and that (b) a dark-matter component should be
added (see Kneib et al. 2004; Broadhurst et al. 2005). This
simple parametrization, as we detailed further below, has al-
lowed to identify systems of multiple-images in an unprece-
dented number of clusters, where the images are physically
matched also by the initially-guessed model (which is then
reﬁned), and are not only matched by eye based on their
color information as is often accustomed.

3.8.1 Description of the method

As mentioned above, this method was designed to include
both a galaxy component and a dark-matter component, yet
to successfully do so with a minimal number of free parame-
ters. To form the galaxy component, cluster galaxies (found
following the red sequence in a color-magnitude diagram) are
assigned each with a power-law mass density distribution,
where the normalization of each galaxy’s weight is propor-
tional to its (relative) ﬂux, and the exponent is the same for
all galaxies and is the ﬁrst free parameter of this method.
The superposition of all galaxy power-law mass distribu-
tion then constitutes the lumpy, galaxy component of the
model. To describe the dark-matter distribution, the galaxy
component is smoothed with either a Spline interpolation
or usually a Gaussian kernel whose degree or width, is the
second free parameter of this method. The smoothing yields
a diﬀuse, smooth dark-matter component that depends on
the initial light distribution; therefore the method is dubbed
Light-Traces-Mass as both the galaxy and dark-matter com-
ponents roughly follow simply the light distribution. Next,
the two components are added with a relative weight (typi-
cally around few to a couple dozen percents for the galaxies),
which is another free parameter in the modeling. The fourth
parameter is an overall normalization of the lens model to
a certain redshift or multiple-image system. In addition to
the four parameters, we often introduce several other pa-
rameters that add some ﬂexibility and help in reﬁning the
ﬁnal solution given the set of input multiple images. These
include a core and two-parameter ellipticity for the BCG(s),
two parameter external shear (which mimics ellipticity for
the critical curves), and chosen galaxies whose weights (or
ﬂuxes) are left free to be optimized in the modeling, meaning
that they are allowed to deviate from the adopted mass-to-
light relation. The minimization for the best-ﬁt solution and
related errors, given a set of multiple-images (often found
with the aid of the initially guessed map from this method),
is performed with a χ2 criterion comparing the positions of
multiple-images with the predicted ones, in the image plane,
via a few-dozen thousand MCMC steps with Metropolis-
Hastings algorithm.

MNRAS 000, 1–?? (2016)

3.8.2 Strengths and weaknesses

The resulting lens model from this procedure, as its name
suggests, is strongly coupled to the input light distribution of
the lens (cluster members positions and luminosities). This
entails various strengths and weaknesses. The fact that the
solution is coupled to the light distribution is what grants
this method with the unprecedented prediction power to de-
lineate the critical curves and locate multiple images in ad-
vance, even if no multiple-image system is used as constraint
(see Zitrin et al. 2012). In fact, most of the free parame-
ters in the initial solution are relatively well known, so that
as a ﬁrst step (i.e. to ﬁnd multiple images) we can reduced
these to one free parameter - namely the normalization of
the lens, and obtain a well-guessed solution, that we have
shown is not much diﬀerent that the resulting solution for
the same clusters when using many multiple images as con-
straints (Zitrin et al. 2012). This means that the method is
capable to supply a well guessed solution also in cases where
HST high quality data is lacking.

The simplistic nature of this method also means that
the solution is often faster to converge and compute than
other grid-based methods or parametrizations, allowing the
analysis of many dozens of cluster lenses in a relatively short
time.

Another advantage that this method encompasses is
that the same very simple procedure applies to all clusters
- from relaxed, small clusters and groups (such as the rel-
atively smaller cluster lenses A383, MS2137 or A611, see
Zitrin et al. 2015, for recent modeling), to the most complex
merging clusters such as M0416, M1149 or M0717 (Zitrin
et al. 2015), that often require multi-halo ﬁts in other para-
metric methods..

But the coupling to the light distribution also means
that the spatial ﬂexibility of the model is small. While our
parameterization does allow for a ﬂexible mass proﬁle in the
sense that it is not limited to a certain analytic form, the
solution is limited spatially by the light distribution. This
means that the multiple-image reproduction accuracy is of-
ten smaller than in other more ﬂexible parametric methods
that model the dark-matter independently of the light (such
as other well-known methods listed in this work including
our own second method listed below). This is manifested
usually in clusters that have a large number of multiple-
images spread across the ﬁeld; for these the LTM method
often reaches a ﬁnite rms value of ∼ 1 − 2” on which it can-
not improve further.

A second disadvantage stemming from our parameter-
ization – since we do not model the dark matter indepen-
dently of the light and since the critical curve’s ellipticity in
our modeling is for the most part generated by the external
shearshear, is that there is no ellipticity assigned directly
to the mass distribution. This creates some discrepancy be-
tween the lens and mass models: the mass distribution can
be often signiﬁcantly rounder than implied by the critical
curves, whose ellipticity comes from the external shear that
does not contribute ellipticity to the convergence map. In
simple words, this reveals a degeneracy regarding the true
ellipticity of the mass distribution - as the ellipticity of the
lens can be attributed to intrinsic ellipticity or to external
shear.

To summarize, we thus consider this method very re-

18 M. Meneghetti et al.

liable and robust, supplying especially well-guessed initial
maps for any given cluster regardless of its complexity,
and with unprecedented prediction power to ﬁnd multiple-
images, but it can also be in some cases less accurate and
spatially ﬂexible. Also, given this is a light-tracing method,
we do not expect this method to describe well numerical
simulations whose mass to light relations are not completely
representative.

3.8.3 Improvements in progress

We are always looking for ways to speed up the minimization
procedure so that a larger parameter space could be for a
reﬁned ﬁnal solution. We are also testing whether replacing
the galaxy component with the more well-behaved PIEMD
(see below), despite having a ﬁxed isothermal slope, would
be suﬃcient for our purposes. We have also implemented an
option of smoothing with an elliptical gaussian which then
introduces ellipticity into the matter distribution itself.

Note that our calculations are performed on an input
grid matching an actual image of the ﬁeld, with its native
pixel-scale. To speed the minimization procedure, we often
reduce the resolution (especially in the case of HST which
has high spatial resolution) by factors 4 to 10 on each axis.
This contributes to the ﬁnite, non-negligible rms obtained
often in this method (e.g. due to pixel coordinates round
ups etc.). We intend to investigate this further and try to
improve the resolution in the crucial places, such as near
the critical curves and when delensing to the source plane,
where this lower resolution might prevent a further improved
solution.

3.8.4 Modeling of Ares and Hera

To model Ares and Hera we use the following setting in our
LTM pipeline. We create a grid of 4080×4080 pixels cover-
ing the ﬁeld-of-view, with an angular resolution of 0.5”/pixel.
The calculation in practice is performed in two stages - ﬁrst
we run many individual random MC chains with a grid reso-
lution lower by factor 10 on each axis. From this we ﬁnd the
global minimum area and extract the covariance matrix. A
proper, long MCMC is then run with a grid of 4 times lower
resolution than the original input image. The ﬁnal solution
is then interpolated to match the original pixel scale map.
Errors were derived using 50 random models form the MC
chain, with a positional uncertainty of 1.4” for the χ2 term.
We use the input list of galaxies supplied by the simula-
tors scaled by their light. In Ares, we allow ﬁve galaxies to
deviate from the nominal mass-to-light ratio and be freely
weighted by the MC chain, and for two of them – especially
important where radial images are seen in the data – we al-
low for a free core radius as well. In the case of Hera, only
three galaxies were modeled in this way. The ellipticity (and
direction) of these bright galaxies are also left as free param-
eters. As constraints, we use the full list of multiple images.
No weak lensing constraints were used. The ﬁnal rms of the
model is 1.8” and 1.2” for Ares and Hera, respectively, which,
as we mention above, is in part limited by the ﬁnite lower
resolution of the grid we work on.

3.9 PIEMDeNFW: the Zitrin-NFW models

Zitrin et al. (2013) expanded their pipeline to also allow
for a fully parametric solution. This method in essence is
similar to the other parametric techniques mentioned here
such as Lenstool and GLAFIC. The main motivation for
adding this parametric pipeline was to (a) allow for further
ﬂexibility and improved ﬁts by having a semi independent
solution in which the dark matter is modeled independently
of the light, and (b) test for the magnitude of systematic
diﬀerences between these methods (Zitrin et al. 2015).

3.9.1 Description of the method

As is usually accustomed in parametric modeling, in order
to describe well the multiple-image positions with enough
prediction power, this method also relies on a combination
of galaxy and dark matter. The red sequence cluster galax-
ies are modeled each as PIEMDs based on the prescription
and scaling relations used in Lenstool, and typically with
a ﬁxed mass-to-light ratio. Usually two or three parameters
are left free to describe the galaxy component: the veloc-
ity dispersion, core radius and truncation radius, of an M*
galaxy, which is used as reference for the scaling relations.
The dark matter component is modeled also with an ana-
lytic, fully parametric recipe. We can choose either an ellip-
tical Navarro et al. (1996) proﬁle (eNFW), or, also PIEMD
for the cluster’s dark matter halo. Therefore, in this method,
the dark matter is modeled with a symmetric analytic form,
independent from the light distribution. Similar to our LTM
method the same minimization engine is used here: a long
MCMC with a χ2 image-plane criteria. Also here we can add
other parameters to be optimized in the minimization, such
as the ellipticities of the BCGs, their mass can be allowed
to deviate from the adopted scaling relation, and so forth.

3.9.2 Strengths and weaknesses

Compared to our LTM technique, for example, we have
found that the fully parametric technique is more spatially
ﬂexible and can thus often supply a more accurate solution
with a (somewhat) smaller image-plane rms. On the other
hand, the higher ﬂexibility reduces the prediction power for
ﬁnding multiple images (especially before the model is ini-
tially constrained), and the reliability of the results, since
they can for a wider range of (not necessarily physically vi-
able) conﬁgurations.

In a similar sense, another main disadvantage of such
parametrizations is the need to add dark matter halos to
model sub halos for complex structures (such as merging
clusters), without knowing if these are fundamental param-
eters, e.g. accounting truly for additional dark matter halos,
or just nuisance parameters that help add ﬂexibility and re-
ﬁne the ﬁt. Additionally, each such added halo adds several
(usually 4-6) free parameters to the minimization procedure
rendering it signiﬁcantly more cumbersome.

Note that since we developed this method with the same
infrastructure used for our LTM method, and in part, for
comparison with it, the solutions given by the PIEMDeNFW
method, despite being analytic in nature, are also calculated
on a grid the size of the input *.ﬁts image, similar to our

MNRAS 000, 1–?? (2016)

The Frontier Fields Lens Modeling Comparison Project

19

LTM procedure. This results in a somewhat slower proce-
dure compared, for example, to our LTM technique, and
also here to achieve higher converging speed we lower the
grid resolution by factors of a few on each axis. Again this
leads to a ﬁnite rms due to e.g. numerical round-ups in high-
magniﬁcation regions.

3.9.3 Improvements in progress

The main improvement we wish to implement is to speed up
the procedure. This for start can be achieved if part of the
calculation is done completely analytically/numerically (say,
only around the positions of multiple images) rather than
on a full-frame grid. We intend to explore such possibilities.
Also, recently we added the possibility for an external shear
to allow for further ﬂexibility.

3.9.4 Modeling of Ares and Hera

To model Ares and Hera, we use the following setting in
our PIEMDeNFW pipeline. As done withe the LTM-gauss
method, we create a grid of 4080×4080 pixels covering the
cluster. We start by running many individual random MC
chains with a grid resolution lower by factor 20 on each
axis. From this we ﬁnd the global minimum area and ex-
tract the covariance matrix. A proper, long MCMC is then
run with a grid of 4 times lower resolution than the origi-
nal input image. The ﬁnal solution is then interpolated to
match the original pixel scale map. Errors were derived us-
ing 50 random models form the MC chain, with a positional
uncertainty of 1.4” for the χ2 term. We use the input list of
galaxies, scaled by their light. The brightest galaxies are op-
timized individually as done with the LTM-gauss pipeline.
In this case, however, the ellipticity (and direction) of the
four brightest galaxies in both clusters are also left as free
parameters. In Ares, two cluster-scale DM halos in the form
of elliptical NFW mass densities are introduced, with ﬁxed
centering on the respective BCGs. In Hera, we used three
such large halos. As constraints we use the full list of mul-
tiple images. No weak lensing constraints were used. The
ﬁnal rms of the model is 1.8”, which as we mention above is
in part limited by the ﬁnite lower resolution of the grid we
work on.

4 RESULTS

In this section we describe how the diﬀerent methods per-
form at recovering several properties of the lenses.

4.1 Convergence maps

The reconstructed convergence maps of Ares and Hera are
shown for all models in Figs. 6 and 7, respectively. The maps
are all normalized to zS = 9. In both ﬁgures, the maps de-
rived from the free-form algorithms are shown ﬁrst (begin-
ning from the upper-left panel). The last panel in each ﬁgure
shows the true convergence map, for easy comparison. All
maps cover the same ﬁeld of view. This does not correspond
to the size of the simulated images that were made available
to the modelers. Indeed, for several technical reasons inher-
ent to each methodology employed, the submissions by the

MNRAS 000, 1–?? (2016)

diﬀerent groups were diﬀerent in size. To carry out a proper
comparison between the models, we restrict our analysis to
the area around each of the two lenses, which is covered by
all the reconstructions. More precisely, we used as footprints
for identifying the area of analysis the submissions by the
GLAFIC and by the GRALE teams for Ares and Hera, re-
spectively. In the ﬁrst case, the FOV is ∼ 180” × 180”. In the
second, the reconstructed area is ∼ 110” × 110” wide.

Since Ares was constructed parameterically with light
tracing mass, it is particularly well suited for reconstruction
by parametric techniques. The parametric CATS, GLAFIC,
Johnson-Sharon, and Zitrin models and the hybrid Diego
model all include mass substructure at the observed posi-
tions of cluster galaxies, recovering the Ares mass distribu-
tion with high ﬁdelity. The free-form GRALE, Bradac-Hoag,
and Coe models do not assume light traces mass, recon-
structing the mass distribution solely based on the observed
lensing. They recover the main mass peaks, but smaller
substructures are not constrained by the lensing data. The
GRALE model accurately reproduces the cluster bimodailty.
The Bradac-Hoag and Coe models are less smooth, includ-
ing noisy smaller substructure, especially outside the region
constrained by strongly lensed multiple images.

The Hera cluster, obtained from an N-body simulation,
is less ideal for being reconstructed using parametric meth-
ods. Indeed, the performance of the parametric algorithms
appears more consistent with that of the free-form ones.
Hera is constructed assuming light traces its massive sub-
structure, as assumed by the parametric and hybrid meth-
ods. The Bradac-Hoag and GRALE models do not make
that assumption and thus recover fewer small subhalos.

The major diﬀerences between the models and between
the models and the true convergence maps are found near
substructures, but also the shape of the mass distributions,
especially at large distances from the center, show inconsis-
tencies. We will discuss them in more details in the next
sections.

To better highlight the diﬀerences between the maps,
we show the ratios between the reconstructed and the true
convergence maps for Ares and Hera in Figs. 8 and 9, re-
spectively.

4.2 One dimensional mass and convergence

proﬁles

We begin discussing the results on the mass and conver-
gence (or surface density) proﬁles. Meneghetti et al. (2010a)
already showed using only one of the methods employed in
this paper (Lenstool, employed by both the CATS and the
Johnson-Sharon teams) that strong lensing can potentially
measure the mass inside the Einstein radius with an accu-
racy of the order of a few percent. In the cases of Ares and
Hera , the sizes of the Einstein radii are signiﬁcantly diﬀer-
ent. In Fig. 10, we show how θE grows as a function of the
source redshift zs. The Einstein radius of Ares is ∼ 20 arc-
sec at zs = 1. Its size at zs ∼ 2 is more than doubled and it
grows asymptotically to ∼ 55 arcsec at higher redshift. The
reason of the steep rise between zs = 1 and zs = 2 is that Ares
has a bi-modal mass distribution. For sources at low redshift
(zs ∼ 1), each of the two mass clumps have their own critical
lines. These are shown by the red curves in the upper middle
panel of Fig. 3. To draw the plot in Fig. 10, we use the center

20 M. Meneghetti et al.

Figure 6. Convergence maps (zs = 9) of Ares. The ﬁrst nine panels show the results of the reconstructions, beginning with the free-form
methods (panels 1-4) and concluding with the parametric models (panels 5-9). The lower left panel shows the true convergence map, for
comparison.

MNRAS 000, 1–?? (2016)

The Frontier Fields Lens Modeling Comparison Project

21

Figure 7. Convergence maps (zs = 9) of Hera. The ﬁrst eleven panels show the results of the reconstructions, beginning with the free-form
methods (panels 1-6) and concluding with the parametric models (panels 7-11). The lower right panel shows the true convergence map,
for comparison.
MNRAS 000, 1–?? (2016)

22 M. Meneghetti et al.

Figure 8. Ratios between the mass reconstructions and true Ares mass distribution.

of the most massive mass clump as reference, and only the
critical line enclosing this point is used to measure θE. By
increasing the source redshift, the critical lines around the
two mass clumps merge into a single, very extended critical
line (see the white line in the upper middle panel of Fig. 3,
which shows the critical line for sources at zs = 9).

In the case of Hera, the Einstein radius grows from ∼ 12
arcsec at zs = 1 to ∼ 30 arcsec at zs = 9. The critical lines

for these two source redshifts are shown in the lower central
panel of Fig. 3.

In Fig. 10 we also show the redshift distributions of the
multiple images identiﬁed in the background of the two clus-
ters (red and blue histograms). These multiple images are
marked with numbered circles in the central panels of Fig. 3.
The labels of each image are constructed as X.Y, where X is
the ID of the source and Y is the ID of of the multiple images
belonging to the same system. Being such a powerful lens,

MNRAS 000, 1–?? (2016)

The Frontier Fields Lens Modeling Comparison Project

23

Figure 9. Ratios between the mass reconstructions and true Hera mass distribution.

MNRAS 000, 1–?? (2016)

24 M. Meneghetti et al.

Figure 10. Size of the Einstein radii of Ares and Hera as a
function of the source redshift (red and blue dashed lines, re-
spectively). The histograms show the redshift distribution of the
multiple images for the two clusters.

Ares produces many more multiple images than Hera, some
of which originate from galaxies at redshift zs ∼ 6. The most
distant multiple image system in the ﬁeld of Hera is only at
zs ∼ 3.5. In both cases, however, the redshift distribution of
the multiple images overlaps with the redshift range where
the size of the Einstein radii have the strongest growth. In-
deed, the relative variation of θE between zs = 3 and zs = 9
is only (cid:46) 10%. Thus, we expect that the models constructed
using these constraints can be safely used to trace the growth
of the cluster strong lensing region up to very high redshifts.
Anologously, we expect that the mass proﬁles are recovered
with higher precision in the radial ranges 20 (cid:46) θ (cid:46) 60 arcsec
and 10 (cid:46) θ (cid:46) 30 arcsec for Ares and Hera, respectively.

This is consistent with our ﬁndings. The upper panels
of Figs. 11 and 12 show the projected enclosed mass proﬁles
of Ares and Hera, respectively. The bottom panels show the
projected mass density proﬁles in units of convergence κ for
zS = 9. The proﬁles are computed with respect to the cen-
ter of the most massive sub-clump in each cluster ﬁeld. To
facilitate the comparison between parametric and free-form
methods, we show the results for these two classes of models
separately (left and right panels).

The mass distribution of Ares is generated in a very
similar manner as used by the parametric techniques (ex-
cept Zitrin-LTM) to model the lenses – as a combination of
parametrized mass components, including subhalos at the
positions of cluster galaxies. Therefore, it is not surprising
that these methods recover the true mass proﬁle of Ares
with very good accuracy. For example, the CATS, Johnson-
Sharon, and GLAFIC proﬁles diﬀer from the true mass pro-
ﬁle by (cid:46) ±2%. Larger diﬀerences are found for the Zitrin-
LTM-gauss and the Zitrin-NFW approaches (perhaps be-
cause these are calculated on a lower resolution grid), see
discussion in Section 3.8 and 3.9), but even for these mod-
els, in the region probed by strong lensing, the deviations
from the true mass proﬁles are within ∼ ±10%.

It is noteworthy that neither the CATS nor the
Johnson-Sharon teams used the NFW density proﬁle to

model the smooth DM halos of the two main mass com-
ponents of Ares. On the contrary, they used cored isother-
mal proﬁles, which can of course be tweaked to match the
lensing properties of NFW halos. This is consistent with
the ﬁndings of Shu et al. (2008), who showed that, in sev-
eral cases, strong lensing clusters are equally well modeled
with cored-isothermal and NFW density proﬁles. The addi-
tional constraints provided by complementary analysis, such
as stellar-kinematics in the BCG could helping to break this
degeneracy (Newman et al. 2013). Moreover, the adoption
of an isothermal proﬁle with core instead of the NFW proﬁle
does not prevent several models from recovering the correct
slope of the surface mass density (i.e. convergence) proﬁle
over a relatively broad range of distances from the cluster
center. The constraints available to carry out the reconstruc-
tions include both radial and tangential features, with the
former particularly sensitive to the slope of the projected
density proﬁle.

Among the free-form methods, the reconstructed pro-
ﬁles generally deviate by (cid:46) 5 − 15% from the true mass
and convergence proﬁles. Some models (e.g. GRALE) have
a very similar performance to parametric methods. The best
agreement between the true proﬁle and the models is found
between 20” and 60” from the lens center, which nicely corre-
sponds to the size of the Einstein radius, as shown in Fig.10.
Hera is a less idealized test case for most of the para-
metric methods, but it still assumes light traces the mass
substructure. So also for this lens, the parametric models
reproduce the input mass proﬁles more closely than the free-
form methods, though the diﬀerences between the two ap-
proaches are now reduced. We ﬁnd that the mass proﬁles
obtained with the parametric methods diﬀer from the in-
put mass proﬁle by less than 10% within ∼ 80 arcsec from
the assumed center. The same level of accuracy is reached
by the free-form methods within 10 (cid:46) r (cid:46) 30 arcsec. This
radial range corresponds to the size of the region probed
by strong lensing. Both parametric and free form methods
clearly converge to the true mass proﬁles within this range
of distances, where the relative diﬀerences are of the order
of few percent.

4.3 Shape and orientation

Having quantiﬁed the performance of the methods to recon-
struct one-dimensional mass proﬁles, we discuss now their
ability to recover the two-dimensional mass distributions of
the lenses.

To be more quantitative about how well the methods
employed recover the true shape and orientation of the two
clusters, we consider the projected mass distributions of the
lenses in terms of their iso-surface-density (or convergence,
κ) contours. We use the following procedure:

(i) From the convergence maps, we extract the contours
corresponding to κ-levels in the range 0.5-3.0. Since both
Ares and Hera have bi-modal mass distributions, we use the
center of the largest mass clump as the reference center for
this analysis and we consider only the contours enclosing it.
(ii) We ﬁt an ellipse to each contour and measure its el-
lipticity and position angle. We also measure the size of each
contour by means of an equivalent radius rκ, deﬁned as
rκ =

(13)

ab ,

√

MNRAS 000, 1–?? (2016)

123456789Redshift0102030405060θE [arcsec]AresHeraThe Frontier Fields Lens Modeling Comparison Project

25

Figure 11. Mass proﬁles in the inner 100 arcsec of Ares: enclosed mass (upper panels) and mass surface density (lower panels). Results
for parametric and free-form methods are shown in the left and in the right panels, respectively. The insets on the bottom of each panel
show the ratio between the reconstructed and the true mass proﬁles. The horizontal dashed lines correspond to ±2% and ±10% diﬀerences
between lens models and input mass distribution.

Figure 12. Mass proﬁles as in Figure 11 but for Hera.

MNRAS 000, 1–?? (2016)

26 M. Meneghetti et al.

Figure 13. Ares mass iso-surface-density contours κ = 0.5, 1.0,
1.5, 2.0, 2.5, 3.0 for zs = 9 (jagged lines) and elliptical ﬁts in red.

where a and b are the semi-axes of the best ﬁtting ellipse.

(iii) Finally, we draw the radial proﬁles of both the ellip-
ticity and the position angle. The radius used to produce the
proﬁles is the equivalent radius of the iso-density contours.

The procedure outlined above is shown in Fig. 13 for the
cluster Ares.

The radial proﬁles of the ellipticity and of the position
angle for the two clusters are shown in Figs. 14 and 15. As
done in Figs. 11 and 12, the results for parametric and free-
form methods are displayed separately (left and right panels,
respectively).

In each panel, the true proﬁle is given by the black
dashed line. The two clusters investigated in this work ex-
hibit quite diﬀerent ellipticity proﬁles. Indeed, due to the
larger spatial separation between the two mass clumps, Ares
has a less elongated inner core (e = 1 − b/a ∼ 0.3) compared
to Hera (e ∼ 0.7). Ares’s ellipticity increases with radius,
while Hera shows the opposite trend.

Despite the fact that we have introduced some modest
radial variation of the ellipticity of two main mass clumps in
Ares, the largest jumps in the ellipticity proﬁle of this clus-
ter are produced by massive substructures. These variations
of ellipticity are generally well reproduced in the parametric
reconstructions, and, to some extent, also in the free-form
model of GRALE. Clearly, the parametric techniques pro-
duce better measurements of the core shapes, both in the
cases of Ares and Hera. Indeed, due to resolution limits,
the convergence maps produced by the free-form methods
are noisier, resulting in more irregular iso-density contours.
Under these circumstances, the ellipticity measurements are
more uncertain.

Among the parametric reconstructions of Ares, the
largest deviations from the true ellipticity proﬁle are found
for the Zitrin-NFW and for the Zitrin-LTM-gauss models

within ∼ 40” and ∼ 20”, respectively. Interestingly, these
same algorithms provide some of the most accurate measure-
ments of the core shape in the case of Hera. These algorithms
generally ﬁnd higher halo ellipticities compared to the other
parametric methods. Such behavior is consistent with the
results of Zitrin et al. (2015), where the Zitrin-NFW and
Zitrin-LTM-gauss methods are both employed in the recon-
struction of the galaxy clusters in the CLASH sample. As
shown in their Fig. 3, the ﬁrst of these two methods leads to
more elliptical mass distributions. The most likely interpre-
tation of this behavior is that external shear compensates
the smaller ellipticity of the LTM models.

All parametric methods except the Zitrin-LTM-gauss
tend to over-estimate the ellipticity of the mass distribution
at large radii in the case of Hera. We shall recall that all
these algorithms ﬁt the data by combining multiple mass
components, each of which has a ﬁxed ellipticity. The results
show that, within the region probed by strong lensing ((cid:46)
40” for Hera), the combination of multiple mass clumps is
eﬀective in reproducing the overall ellipticity of the cluster.
At larger radii, though, the models are unconstrained and
the ellipticity is extrapolated from the inner region. Free-
form methods do not show the same trend; their ellipticity
proﬁles are more noisy.

Also the orientation angles of the iso-density contours
in the parametric reconstructions deviate from Hera’s true
orientations at large radii. Being a numerically simulated
cluster, Hera is characterized by asymmetries and twists of
the iso-density contours that result to be much stronger than
in Ares. For example, the position angle of the iso-density
contours changes by ∼ 20 degrees between the very inner
region of the cluster and a distance of ∼ 50”.

As a result of the not perfectly reproduced shape and
orientation of the cluster at large radii, the CATS, Johnson-
Sharon, GLAFIC and Zitrin-NFW models have an excess of
mass along the major axis of the cluster with respect to the
true mass distribution of Hera (and consequently they lack
mass in the perpendicular direction). Such peculiarities can
be seen in Fig. 9, where the ratios between reconstructed
and true convergence maps of Hera are shown.

4.4 Substructure

Figs. 8 and 9 show that signiﬁcant diﬀerences exist between
the models near sub-structures. Measuring the mass of sub-
structures is an important task that several authors have
performed via strong lensing (see e.g. Natarajan et al. 2007,
2009; Grillo et al. 2015, and references therein). Therefore it
is interesting to quantify the lens model precision near these
secondary mass clumps.

From the perspective of strong lensing, substructures
are often identiﬁed as massive halos around cluster galax-
ies. This is particularly true for parametric methods: they
use the luminous galaxies as tracers of the underlying mass
distribution. Instead, free-form methods can in principle de-
tect any kind of mass substructure, even if not traced by
light. However, they cannot distinguish between the pro-
jected mass belonging to the cluster halo and bound to the
substructures.

Indeed, as part of their submissions, the groups did not
provide estimates of the masses in substructures, nor sub-
structure catalogs. Here, we perform the following analysis:

MNRAS 000, 1–?? (2016)

The Frontier Fields Lens Modeling Comparison Project

27

Figure 14. Ellipticity (upper panels) and position angle (lower panels) as a function of the equivalent radius of the convergence contours
of Ares. In each plot we show the true proﬁle as a dashed black line. The proﬁles obtained from the reconstructions are given by the
solid colored lines. The left and the right panels refer to the parametric and to the free-form methods, respectively. The vertical dotted
lines indicate the maximum radius covered by all reconstructions.

Figure 15. Ellipticity (upper panels) and position angle (lower panels) proﬁles as in Figure 14 but for Hera.

MNRAS 000, 1–?? (2016)

28 M. Meneghetti et al.

• We start from the assumption that galaxies trace the
substructures. This is not a strong assumption given the
method employed to generate the galaxy populations of Ares
and Hera. In both cases, galaxies tend indeed to coincide
with dark matter substructures. In the case of Ares there is
a one-to-one correspondence between luminous galaxies and
dark matter sub-halos. In the case of Hera, we have excluded
from the image simulations those galaxies which had their
dark matter halos stripped oﬀ in the course of the cluster
evolution.

• We create apertures centered on the cluster galaxies
with mAB,F814W < 24, with radii equal to twice the eﬀective
radius of the galaxies, and we measure the projected mass
within each aperture from both the reconstructed and the
true convergence maps.

• In the following, we will refer to these masses as sub-
structure masses, keeping in mind that these are however
the sum of the substructure mass and of the projected mass
of the underlying cluster dark-matter halo.

In Figs. 16 and 17, we show the distributions of the
ratios between measured and true substructure masses. The
two ﬁgures refer to Ares and Hera, respectively and show the
results for all the models. We characterize the distributions
of the ratios r by means of their median r and of their 25 − th
and 75 − th percentiles, p25 and p75. The analysis is carried
out on the same areas covered by the maps in Figs. 6 and
7. Therefore, the same number of substructures have been
used to build the histograms (282 and 278 for Ares and Hera,
respectively).

The results found for Ares show that several methods
recover nearly unbiased substructure masses with good ac-
curacy. For example, the inter-percentile range found for the
CATS model is only 0.21 and the median is r = 1. Similar
results are found for the Zitrin-LTM-gauss model, although
with a median slightly larger than unity. Some parametric
models, such as those of Johnson-Sharon and Zitrin-NFW,
and marginally GLAFIC, have skewed distributions with
tails extending towards ratios larger than unity. Interest-
ingly, Johnson-Sharon’s model is based on the same model-
ing software employed by the CATS group.

Among the free-form models, the distributions are gen-
erally broader than for the parametric methods. The distri-
bution for the Bradac-Hoag model has median r = 1 and
inter-percentile range 0.32. Similar or slightly larger scatter
is found for the GRALE and Coe models. The ratio dis-
tribution obtained for the Diego-reggrid model has a tail
extending towards small values and its median is r = 0.8.

The results found for Hera are quite in agreement with
those found for Ares. Parametric methods perform very sim-
ilarly among each other, providing mass measurements ac-
curate at the level of few percent. The Zitrin-LTM-gauss
model has a median r = 0.89. The dispersions of the ratio dis-
tributions, as quantiﬁed by the inter-percentile ranges, are
∼ 0.2 − 0.25. This is quite remarkable given the very diﬀerent
methods used to populate Ares and Hera with substructures
and the signiﬁcant diﬀerences between the density proﬁles
of the substructures themselves in the two simulations, as
shown in Fig. 1. This seems to indicate that the methods
are ﬂexible enough to account for even large variations in the
substructure properties, provided they are traced by light.

It is less surprising that the ﬂexible free-form methods also
behave so similarly in Hera and Ares.

4.5 Magniﬁcation maps

As one of the major goals of the Hubble Frontier Fields is to
use the lensing power of galaxy clusters to detect and char-
acterize very high redshift galaxies, we focus now on the
magniﬁcation. Of course, the results shown in this section
are not independent of those discussed earlier, since the con-
vergence is one of the two quantities entering the deﬁnition
of magniﬁcation. The other quantity is the shear, which was
not discussed so far.

In Figs. 18 and 19, we show the magniﬁcation maps for
zS = 9 obtained for Ares and Hera. As done previously, the
results for each model are displayed in diﬀerent panels. The
last panel on the bottom shows the true magniﬁcation. The
ratios between each reconstructed magniﬁcation map and
the true magniﬁcation maps are shown in Figs. 20 and 21.
The largest discrepancies between reconstructed and
true magniﬁcations appear around the lens critical lines.
These are the loci where the magniﬁcation formally diverges.
Therefore, even a small misalignment of the true and recon-
structed critical lines will result in potentially large magniﬁ-
cation diﬀerences. Most of the models recover the shape and
the size of the critical lines well. Others, as the Bradac-Hoag,
the Coe, and the Diego-multires models are characterized by
critical lines with very irregular shapes.

In Figs 22 and 23, the measured magniﬁcations are plot-
ted as a function of the true magniﬁcations. As anticipated,
the scatter around the median increases as a function of the
true magniﬁcation for all models. The scatters for paramet-
rically reconstructed models of Hera are factors of 2−3 larger
than for the corresponding models of Ares, the mock clus-
ter that was generated parametrically. Besides, we note that
Hera was inherently less well constrained as the cluster had
fewer multiple images than Ares. So a slightly lower ﬁdelity
in the reconstruction was anticipated and found as expected.
In the best scenario obtained for Hera (i.e. the GLAFIC
model, see also Fig. 24), we ﬁnd very high accuracy (a few
percent bias at most) and precision: ∼ 10% uncertainty for
µ = 3, growing to ∼ 30% at µ = 10, and increasing further at
higher magniﬁcations.

In other cases, median magniﬁcations are biased low or
high by as much as ∼ 40 − 50%. Some of these biases are due
to the models’ inability to reproduce the correct magniﬁca-
tion patterns interior to the tangential critical lines. In other
cases, the gradient of the magniﬁcation around the critical
lines is signiﬁcantly diﬀerent from that in the true magniﬁ-
cation maps, reﬂecting the incorrect shape and orientation
of the projected mass distribution or the incorrect slope of
the convergence proﬁle.

Regions around substructures sometimes are character-
ized by large uncertainties on magniﬁcation estimates. For
example, the large substructure located south of the cluster
Hera is not well constrained by any of the models, which all
systematically underestimate the magniﬁcation around it.
As shown in the lower central panel of Fig. 3, there are no
multiple images located near this substructure, which may
explain why no model is able to constrain its mass properly.
In Fig. 24, we compare the precision of the magniﬁcation
measurements over the whole map (in the case of the recon-

MNRAS 000, 1–?? (2016)

The Frontier Fields Lens Modeling Comparison Project

29

Figure 16. Distributions of the ratios between measured and true substructures masses for Ares. The total number of substructures is
282. Each panel shows the results for a mass model. In each panel, we indicate the median r and the 25 − th and 75 − th percentiles of the
distribution.

struction provided by the GLAFIC team for Hera; solid line)
and at the observed positions of the multiple images used to
build the lens model (red dots). The ﬁgure shows that the
precision achieved by the model at the location of the con-
straints is indeed higher than in other regions with similar
magniﬁcations. The horizontal error-bars indicate the sizes
of the magniﬁcation bins used to estimate the precision of
the magniﬁcation measurements.

5 RECONSTRUCTION METRICS

In order to be more quantitative in estimating the ability of
the diﬀerent methods employed in this work to measure sev-
eral relevant properties of Ares and Hera, we have deﬁned
metrics for the lens properties discussed above. More pre-
cisely, we introduce metrics for the one-dimensional radial
proﬁles of

• the 2D projected mass enclosed within radius R,
• the surface mass density, or convergence κ(R),
• the ellipticity, as ﬁt to iso-density contours,
• and the orientation, as given by the position angle of

the convergence contours.

We also deﬁne metrics to quantify the goodness of the re-
construction of the 2D convergence and magniﬁcation maps.
Finally, we deﬁne a metric for the projected subhalo masses
in apertures centered on the cluster galaxies.

Thus, we have seven metrics that can be used for a
more quantitative comparison between the lens models of
both clusters. We can also evaluate how the performance of
each algorithm changes when switching from a simulation

MNRAS 000, 1–?? (2016)

based on a lens obtained from semi-analytic methods ( Ares
) and one obtained from a fully numerical simulation (Hera)
.

The metrics are deﬁned as follows. Given a set of mea-
sured values v and a set of true values vtrue, we derive the
distribution of v/vtrue. Then, we compute the median, ζ and
the 25-th and 75-th percentiles of the distribution, p25 and
p75. The metric is ﬁnally deﬁned as

Qv = log10{[(p75 − p25)|ζ − 1|]−1} .

(14)

By adopting this deﬁnition, the metric penalizes those re-
constructions which are biased and/or aﬀected by a large
scatter.

Of course, the metrics are not fully independent. For ex-
ample, a model which is able to reproduce the convergence
proﬁle of the lens with a good accuracy will also provide a
robust measurement of the mass proﬁle. Similarly, models
whose reconstructed convergence maps show little deviation
from the true convergence maps will also have provide a
good match with the simulation in terms of converge proﬁle
or shape (ellipticity and position angle). Nevertheless, the
ranking among the models with respect to correlated lens
properties is not always the same. For example, the Johnson-
Sharon reconstruction of Hera ranks second in terms of con-
vergence proﬁles and fourth in terms of mass proﬁles. In
addition, the diﬀerent lens properties which are discussed
here are often used individually, and it may be interesting
for the reader to establish which modeling technique is bet-
ter suited to their scientiﬁc purposes.

In Fig. 25, we show radar plots which summarize the
metric values recorded by each reconstruction. The overall

30 M. Meneghetti et al.

Figure 17. Distributions of the ratios between measured and true substructures masses for Hera. The total number of substructures is
282. Each panel shows the results for a mass model. In each panel, we indicate the median r and the 25 − th and 75 − th percentiles of the
distribution.

performance of each model corresponds to the area of each
polygon. When one model is good at measuring some of the
lens properties, but less eﬀective at capturing others, the
polygon appears elongated towards one or more of the chart
vertexes.

The ﬁrst eight charts correspond to free-form or hybrid
methods. The remaining ﬁve charts refer to parametric tech-
niques. As we have pointed out several times earlier, there is
larger discrepancy between the performances of parametric
and non-parametric methods in the case of Ares than in the
case of Hera. This leads us to the conclusion that, despite our
attempts to make the Ares mass distribution less ideal for
parametric methods (e.g. by simulating adiabatic contrac-
tion or by introducing some twist of the iso-density contours,
including some radial dependence), the simple fact that this
cluster is assembled by combining mass components traced
by the cluster galaxies, consistently with the basic assump-
tions of most parametric techniques, gives a huge advantage
to these methods. The good news, in this case, is the fol-
lowing. First, these algorithms work as they are supposed
to. Second, they provide very accurate reconstructions even
if the parametrisation chosen for the lens halo density pro-

ﬁle is not fully consistent with the true proﬁle of the lens.
For example, none of the parametric techniques, except the
Zitrin-NFW method, used the NFW proﬁle for ﬁtting the
smooth dark-matter halo components of Ares. Even so, mod-
els such as those submitted by the CATS, Johnson-Sharon,
and GLAFIC teams produce an overall better ﬁt to the input
mass distribution compared to the Zitrin-NFW reconstruc-
tion. This suggests that pseudo-elliptical, cored halo models
provide the right ﬂexibility to account for most of the eﬀects
we have introduced in the simulation, such as the adiabatic
contraction, which steepens the density proﬁle in the cen-
tral region of the cluster. Alternatively, these results may
be interpreted as evidence for a lack of sensitivity of lensing
alone to the precise share of the halo density proﬁles, being
mostly sensitive to the mass enclosed within the Einstein
radius rather than the slope of the density proﬁle. Another
possible cause may be that the Zitrin’s models are calculated
on a low resolution grid and perhaps their accuracy is are
limited by this resolution compared to higher resolution or
completely analytic parametrizations.

When switching to a fully numerical simulation, the dif-
ferences between parametric and free-form methods become

MNRAS 000, 1–?? (2016)

The Frontier Fields Lens Modeling Comparison Project

31

Figure 18. Magniﬁcation maps for sources at zs = 9 lensed by each Ares reconstruction and, at bottom, the true simulated cluster.

MNRAS 000, 1–?? (2016)

32 M. Meneghetti et al.

Figure 19. Magniﬁcation maps for sources at zs = 9 lensed by each Hera reconstruction and the true simulated cluster (bottom right).

MNRAS 000, 1–?? (2016)

The Frontier Fields Lens Modeling Comparison Project

33

Figure 20. Ratios of model divided by true magniﬁcations for Ares .

weaker. At least for some of the metrics, some free-form
/ hybrid reconstructions of Hera (see e.g. the GRALE or
Lam models) appear to be as good as the best parametric
reconstructions of this cluster. This indicates that several
parametric methods still cannot fully account for deviations
of the mass distributions from a symmetric shape, which
are, instead, more naturally captured by free-form methods.
Asymmetries could be mimicked by suitable combinations
of substructures in parametric models. Indeed, a degeneracy

exists between these two properties of the mass distribu-
tion. However, the number of constraints in these simula-
tions is high enough that this degeneracy is partially bro-
ken, as shown by how well the mass is constrained around
the cluster galaxies in at least some of the parametric recon-
structions.

The model provided by the CATS team for Hera has
signiﬁcantly smaller values of all metrics (except for the
cluster orientation), compared to the model submitted by

MNRAS 000, 1–?? (2016)

34 M. Meneghetti et al.

Figure 21. Ratios of model divided by true magniﬁcations for Hera .

MNRAS 000, 1–?? (2016)

The Frontier Fields Lens Modeling Comparison Project

35

Figure 22. Model vs. true magniﬁcations (zs = 9) for Ares . The underlying 2D histograms show the distributions of the pixel values
on the µ − µtrue plane after sampling the magniﬁcation maps on a grid of 256 × 256 pixels. The black and the blue solid lines show the
median and the 25 − th and 75 − th percentiles of the measured magniﬁcations in bins of µtrue. The dashed and the dotted lines parallel to
the diagonal in each panel denote the limits of ±10% and ±30% deviations from the relation µ = µtrue.

the same team for Ares. The metrics agree with those of
other parametric reconstructions of the same cluster (e.g.
Johnson-Sharon). On the contrary, the reconstructions pro-
vided by the GLAFIC team for the two clusters have quite
consistently high metric values. One feature of GLAFIC,
which was enabled in the reconstruction of Hera, is the in-

clusion of external shear and third-order multipoles of the
mass distribution. Apparently, these additional ingredients
have provided the GLAFIC model extra degrees of freedom
to properly account for the asymmetric mass distribution of
Hera.

MNRAS 000, 1–?? (2016)

36 M. Meneghetti et al.

Figure 23. Model vs. true magniﬁcations (zs = 9) for Hera , as in Fig. 22.

MNRAS 000, 1–?? (2016)

The Frontier Fields Lens Modeling Comparison Project

37

tween matter and light in both Ares and Hera, by assigning
to the observed galaxies a shape and an orientation which is
not correlated with the underlying dark matter distribution.
Other limitations regard some observable properties of
the galaxies in the simulated observations (e.g. luminosities
and sizes) and their correlation with their halo masses. It is
known that the SAMs are not fully consistent with observa-
tions in this respect (see e.g. Gonz´alez et al. 2009; Ascaso
et al. 2015; Xie et al. 2015; Hirschmann et al. 2015), thus
the standard scaling relations adopted by some parametric
techniques to translate the light into the mass or the size of
the host halo might not equally applicable to observations
and simulations.

7 SUMMARY AND CONCLUSIONS

In this paper we used simulated observations of two syn-
thetic galaxy clusters to evaluate the performance of sev-
eral algorithms for mass reconstruction with strong lensing.
Such algorithms are currently being used to deliver to the
community the lens models for the six galaxy clusters being
observed in the Frontier Fields programme of the Hubble
Space Telescope.

The two clusters used in this study were obtained us-
ing very diﬀerent techniques. Ares was generated using the
semi-analytical code MOKA. Hera is instead the output of a
cosmological N-body simulation at high resolution. The ob-
servable properties of the cluster galaxies are modeled using
HOD and SAM techniques in Ares and Hera, respectively.
In both cases, the clusters have complex mass distributions,
characterized by disturbed and bi-modal morphology, simi-
lar to those of the FFI clusters.

We used the code SkyLens to simulate HST observa-
tions of the two mock clusters with both the ACS and the
WFC3-IR camera. We produced images in all photometric
bands used in the FFI, calibrating the exposure times such
to reach the depth of the FFI observations. These HST simu-
lated data were distributed to several groups of lens modelers
for a blind analysis, i.e. without unveiling the true mass dis-
tribution of the lenses, neither the method used to simulate
them.

The simulated observations include lensing eﬀects on a
realistic distribution of background galaxies. We identiﬁed
many strongly lensed galaxies and built a catalog of multiple
image systems, which was delivered together with the simu-
lated observations. The catalogs also include the redshift of
all the sources.

We complemented the HST simulations with a simu-
lated observation in the Rc band with the Subaru telescope.
The main purpose of this additional simulation was to allow
the inclusion of weak-lensing constraints at larger distances
from the cluster center than those probed by HST. Together
with the image, we also distributed a shear catalog obtained
by processing the Subaru simulation through a public KSB
pipeline.

We received nine reconstructions of Ares and eleven re-
constructions of Hera, submitted by ten diﬀerent groups.
Seven groups employed their techniques to reconstruct both
clusters. The remainder groups reconstructed just one of the
two clusters or submitted reconstructions based on diﬀerent
set-ups of their methods. This is the ﬁrst time that such a

Figure 24. Magniﬁcation accuracy (dashed line) and precision
(solid line) as a function of the magniﬁcation from the strong
lensing constraints for the GLAFIC reconstruction of Hera. The
precision is quantiﬁed by the diﬀerence between the 75-th and 25-
th percentiles of the distribution of µ−µtrue, sampled on a 256×256
pixel grid. The accuracy is given by the median of µ−µtrue. The red
points show the uncertainties of the magniﬁcation measurements
at the location of the multiple images. The horizontal error-bars
indicate the sizes of the magniﬁcation bins used to estimate the
precision.

The comparison between the metrics of parametric and
free-form methods also shows that the latter techniques are
generally less accurate in reconstructing the two-dimensional
maps of convergence and magniﬁcation and in measuring the
mass around substructures. In fact, the spatial resolution
that can be achieved with these methods is generally lower.
On the contrary, radial proﬁles of the convergence and of
the enclosed mass are measured by several of the free-form
methods employed in this experiment with accuracy compa-
rable to parametric techniques.

6 LIMITATIONS OF THIS TEST

We would like to remark that the tests outlined in this pa-
per suﬀer of some limitations. First of all, we make the as-
sumption that the simulations reproduce the properties of
real clusters. While some methods (e.g. the free-form ones)
do not care about the correlation between dark-matter and
baryons, other methods strongly rely on the assumption that
light-traces mass. Both Ares and Hera implement this prop-
erty, which, at least in some cases, has been questioned by
observations (Wang et al. 2015; Hoag et al. 2015). In par-
ticular, the results we report on substructures are sensitive
to this assumption. In a recent paper, Harvey et al. (2016)
have explored how assuming that light traces mass in strong
gravitational models can lead to systematic errors in the pre-
dicted positions of multiple images. They ﬁnd that images
can be shifted by up to ∼ 1”, assuming physically motivated
oﬀsets between dark-matter and stars. They quote a ∼ 0.5”
rms error in the position of the multiple images due to break-
ing the assumption that mass traces light. Note, however,
that, to some extent, we introduced some misalignment be-

MNRAS 000, 1–?? (2016)

38 M. Meneghetti et al.

Figure 25. Radar plot showing the scores of each model for all metrics discussed in the paper. Larger polygons correspond to better
overall performance. Each chart corresponds to a diﬀerent lens model (see labels on the top) and shows results for both Ares (blue) and
Hera (red), or whichever is available. The seven metrics are shown on the vertices of each chart. For each metric, the scores range from
0 (worst; plotted at the center of the chart) to 1 (best; plotted at the vertex), normalized to the maximum value recorded by all models.
A ﬁlled polygon is obtained by connecting the plotted scores of all metrics for each reconstruction.

large number of algorithms have been tested against known
mass distributions. Similar to the spirit of our experiment, in
the recent collaborative eﬀort presented in Treu et al. (2016),
several of the methods used to reconstruct the galaxy cluster
MACSJ1149.5+2223 and estimate the time-delays between
the multiple images of the SN “Refsdal” were compared. The
recent re-appearance of the SN, reported by Kelly et al.
(2016), enabled the blind test of various model predictions,
which were found to be in very accurate for several recon-
structions. In addition, (Rodney et al. 2015) compared the
magniﬁcation predictions from 17 mass models of Abell 2744
using a lensed supernova of type Ia.

The methods compared here include both paramet-
ric and free-form algorithms. We have investigated how
they perform at recovering several properties of the lenses,
namely: the radial proﬁles of the convergence and of the
enclosed mass, the mass in substructures, the maps of the
convergence and of the magniﬁcation. For each of these prop-

erties, we deﬁned a metric aimed at quantifying the perfor-
mance of the method.

The key results of this phase of the comparison exer-
cise of lens mapping methodologies can be summarized as
follows.

• Parametric methods are generally better at capturing
two-dimensional properties of the lens cores (shape, local
values of the convergence and of the magniﬁcation). The
free-form methods are as competitive as the parametric
methods to measure convergence and mass proﬁles. It is
worth mentioning, however, that, in both Ares and the Hera,
the cluster galaxies were good tracers of the cluster mass dis-
tributions.

• The accuracy and precision of strong lensing methods
to measure the mass within the Einstein radius (or more
generally within the region probed by the strong lensing con-
straints) is very high. The measured proﬁles deviate from the
true proﬁles by only a few percent at these scales. Of course,
larger deviations are found at radii larger and smaller than

MNRAS 000, 1–?? (2016)

The Frontier Fields Lens Modeling Comparison Project

39

the Einstein radius. The determination of the mass enclosed
within the Einstein radius was extremely robust for all meth-
ods.

• The largest uncertainties in the lens models are found
near substructures and around the cluster critical lines. For
some of the parametric models, the total mass around sub-
structures (identiﬁed by cluster galaxies) is constrained with
an accuracy of ∼ 10%. However, other methods have much
larger scatter. Uncertainties on the magniﬁcation grow as
a function the magniﬁcation itself and are therefore more
pronounced near the cluster critical lines. For the best per-
forming methods, the accuracy in the magniﬁcation estimate
is ∼ 10% at µtrue = 3 and degrades to ∼ 30% at µtrue = 10.

• Switching from Ares to Hera, i.e. from a purely para-
metric to a more realistic lens mass distribution, the gap be-
tween parametric and free form methods becomes smaller.
Algorithms such as that used by the GLAFIC team, which
include third order multi-poles in the lens mass distribu-
tion, have extra degrees of freedom which allow them to
better reproduce asymmetries. These asymmetries, and pos-
sible variations of the halo ellipticity as a function of radius,
seem to be the strongest limitations of parametric methods.
The adoption of an hybrid approach, where parametric and
free-form methods are combined also to describe the large-
scale component of the clusters, could lead to a signiﬁcant
improvement of the mass reconstructions.

• Some of the participating groups used the same code
but adopted diﬀerent set-ups to run them. For example,
two groups (CATS and Johnson-Sharon) use the public code
Lenstool with slight modiﬁcations. Similarly, Diego submit-
ted several models of Hera using WSLAP+, which is the
same code used by Lam et al. Despite using the same algo-
rithms and making use of the same inputs (i.e. families of
multiple images and redshifts), the reconstructions obtained
by these groups are diﬀerent, indicating that some choices
made by the modelers when ingesting the data and hence
set up priors inﬂuence the results.

This is the ﬁrst of a series of papers in which we ad-
dress the issue of the accuracy of lens modeling. In a second
paper, currently in preparation, we will discuss the results
of the unblinded modeling of Ares and Hera. The feedback
from the unblinding was used by modelers to not only tweak
their best-ﬁts to reach the best possible match to the input
mass distributions of the lenses but to also incorporate and
instigate improvements in their modeling procedure. This
will provide information on the accuracy limits achievable
by each method and will also give further hints on the steps
that need to be taken to optimize reconstructions.

Despite their complexity and the inclusion of several
observational eﬀects, the simulations used in this paper are
still idealized in many respects. For example, the lenses are
isolated and no additional lensing by matter along the line
of sight is included. In addition, we alleviated the work of
the lens modelers by identifying the strongly lensed sources
and even providing redshifts for all of them. In the case of
Ares, the number of available multiple images with known
redshifts exceeds by a factor of ∼ 3−4 what is available in any
of the frontier ﬁelds (e.g. MACSJ0416). We will include the
uncertainties due to possible mis-identiﬁcation of multiple
images and photometric redshifts as well as the noise added

MNRAS 000, 1–?? (2016)

in by the intervening matter distribution along the line of
sight in the next phase of this project in future work.

Acknowledgments

We thank T. Treu for the helpful discussion. MM
acknowledges support from the Italian Ministry of For-
eign Aﬀairs and International Cooperation, Directorate
General for Country Promotion, from INAF via PRIN-
INAF 2014 1.05.01.94.02, and from ASI via contract
ASI/INAF/I/023/12/0. This work was supported in part
by World Premier International Research Center Initia-
tive (WPI Initiative), MEXT, Japan, and JSPS KAKENHI
Grant Number 26800093 and 15H05892. AZ is supported
by NASA through Hubble Fellowship grant #HST-HF2-
51334.001-A awarded by STScI, which is operated by the As-
sociation of Universities for Research in Astronomy, Inc. un-
der NASA contract NAS 5-26555. J.M.D acknowledges sup-
port of the consolider project CSD2010-00064 and AYA2012-
39475-C02-01 funded by the Ministerio de Economia y Com-
petitividad, Spain. We acknowledge the lens modeling com-
munity for enthusiastically participating in this collaborative
project to compare and contrast mass models.

REFERENCES

Ascaso B., Mei S., Ben´ıtez N., 2015, MNRAS, 453, 2515
Bartelmann M., Meneghetti M., 2004, A&A, 418, 413
Bartelmann M., Narayan R., Seitz S., Schneider P., 1996, ApJL,

464, L115

Bouwens R. J., et al., 2014, ApJ, 793, 115
Bouwens R. J., Illingworth G. D., Oesch P. A., Caruana J., Hol-

werda B., Smit R., Wilkins S., 2015, ApJ, 811, 140

Bradaˇc M., Schneider P., Lombardi M., Erben T., 2005, AAP,

437, 39

Bradaˇc M., et al., 2006, ApJ, 652, 937
Bradaˇc M., et al., 2009, ApJ, 706, 1201
Broadhurst T., et al., 2005, ApJ, 621, 53
Bryan G. L., Norman M. L., 1998, ApJ, 495, 80
Cain B., Bradac M., Levinson R., 2015, ArXiv:1503.08218,
Coe D., Ben´ıtez N., S´anchez S. F., Jee M., Bouwens R., Ford H.,

2006, AJ, 132, 926

Coe D., Fuselier E., Ben´ıtez N., Broadhurst T., Frye B., Ford H.,

2008, ApJ, 681, 814

Coe D., Ben´ıtez N., Broadhurst T., Moustakas L. A., 2010, ApJ,

723, 1678

Contini E., De Lucia G., Villalobos ´A., Borgani S., 2014, MNRAS,

437, 3787

De Lucia G., Blaizot J., 2007, MNRAS, 375, 2
Diego J. M., Protopapas P., Sandvik H. B., Tegmark M., 2005,

MNRAS, 360, 477

Diego J. M., Tegmark M., Protopapas P., Sandvik H. B., 2007,

MNRAS, 375, 958

Diego J. M., et al., 2015a, MNRAS, 446, 683
Diego J. M., Broadhurst T., Molnar S. M., Lam D., Lim J., 2015b,

MNRAS, 447, 3130

Diego J. M., Broadhurst T., Zitrin A., Lam D., Lim J., Ford H. C.,

Zheng W., 2015c, MNRAS, 451, 3920
Diego J. M., et al., 2016, MNRAS, 456, 356
Donahue M., et al., 2014, ApJ, 794, 136
Donnarumma A., et al., 2011, AAP, 528, A73
Dutton A. A., Treu T., 2014, MNRAS, 438, 3594
Ebeling H., Ma C. J., Kneib J., Jullo E., Courtney N. J. D.,
Barrett E., Edge A. C., Le Borgne J., 2009, MNRAS, 395,
1213

Eke V. R., Cole S., Frenk C. S., 1996, MNRAS, 282

40 M. Meneghetti et al.

El´ıasd´ottir ´A., et al., 2007, preprint, (arXiv:0710.5636)
Fasano G., et al., 2010, MNRAS, 404, 1490
Fuselier E. J., 2006, PhD thesis, Texas A&M
Fuselier E., 2007, Advances in Computational Mathematics,
Giocoli C., Tormen G., Sheth R. K., van den Bosch F. C., 2010,

MNRAS, 404, 502

Massey R., et al., 2015, MNRAS, 449, 3393
Medezinski E., et al., 2013, ApJ, 777, 43
Melchior P., Meneghetti M., Bartelmann M., 2007, AAP, 463,

1215

Meneghetti M., Bolzonella M., Bartelmann M., Moscardini L.,

Tormen G., 2000, MNRAS, 314, 338

Giocoli C., Meneghetti M., Bartelmann M., Moscardini L.,

Meneghetti M., Bartelmann M., Moscardini L., 2003a, MNRAS,

Boldrin M., 2012a, MNRAS, 421, 3343

340, 105

Giocoli C., Meneghetti M., Ettori S., Moscardini L., 2012b, MN-

Meneghetti M., Bartelmann M., Moscardini L., 2003b, MNRAS,

RAS, 426, 1558

346, 67

Gonzalez A. H., Zabludoﬀ A. I., Zaritsky D., 2005, ApJ, 618, 195
Gonz´alez J. E., Lacey C. G., Baugh C. M., Frenk C. S., Benson

A. J., 2009, MNRAS, 397, 1254
Grillo C., et al., 2015, ApJ, 800, 38
Harvey D., Kneib J. P., Jauzac M., 2016, MNRAS, 458, 660
Hernquist L., 1990a, ApJ, 356, 359
Hernquist L., 1990b, ApJ, 356, 359
Heymans C., et al., 2006, MNRAS, 368, 1323
Hirschmann M., De Lucia G., Fontanot F., 2015, preprint,

Meneghetti M., Bartelmann M., Jenkins A., Frenk C., 2005,

ArXiv Astrophysics e-prints,

Meneghetti M., Argazzi R., Pace F., Moscardini L., Dolag K.,

Bartelmann M., Li G., Oguri M., 2007, AAP, 461, 25

Meneghetti M., et al., 2008, AAP, 482, 403
Meneghetti M., Rasia E., Merten J., Bellagamba F., Ettori S.,
Mazzotta P., Dolag K., Marri S., 2010a, AAP, 514, A93
Meneghetti M., Fedeli C., Pace F., Gottl¨ober S., Yepes G., 2010b,

AAP, 519, A90

(arXiv:1512.04531)

Meneghetti M., Bartelmann M., Dahle H., Limousin M., 2013,

Hoag A., et al., 2015, ArXiv:1503.02670,
Hoag A., et al., 2016, preprint, (arXiv:1603.00505)
Huang K.-H., et al., 2016, ApJL, 823, L14
Ishigaki M., Kawamata R., Ouchi M., Oguri M., Shimasaku K.,

Ono Y., 2015, ApJ, 799, 12

Jauzac M., et al., 2014, MNRAS, 443, 1549
Jauzac M., et al., 2015, MNRAS, 452, 1437
Jing Y., Suto Y., 2002, ApJ, 574, 538
Johnson T. L., Sharon K., Bayliss M. B., Gladders M. D., Coe

D., Ebeling H., 2014, ApJ, 797, 48

Jullo E., Kneib J.-P., Limousin M., El´ıasd´ottir ´A., Marshall P. J.,

Verdugo T., 2007, New Journal of Physics, 9, 447
Kaiser N., Squires G., Broadhurst T., 1995, ApJ, 449, 460
Karman W., et al., 2015, AAP, 574, A11
Kawamata R., Ishigaki M., Shimasaku K., Oguri M., Ouchi M.,

2015, ApJ, 804, 103

Kawamata R., Oguri M., Ishigaki M., Shimasaku K., Ouchi M.,

2016, ApJ, 819, 114

Kazantzidis S., Kravtsov A. V., Zentner A. R., Allgood B., Nagai

D., Moore B., 2004, ApJL, 611, L73

Kazantzidis S., Bullock J. S., Zentner A. R., Kravtsov A. V.,

Moustakas L. A., 2008, ApJ, 688, 254

Kazantzidis S., Zentner A. R., Kravtsov A. V., Bullock J. S.,

Debattista V. P., 2009, ApJ, 700, 1896
Keeton C. R., Madau P., 2001, ApJL, 549, L25
Kelly P. L., et al., 2015, Science, 347, 1123
Kelly P. L., et al., 2016, ApJL, 819, L8
Killedar M., Borgani S., Meneghetti M., Dolag K., Fabjan D.,

Tornatore L., 2012, MNRAS, 427, 533

Space Sci.Rev., 177, 31

Merten J., et al., 2015, ApJ, 806, 4
Mohammed I., Liesenborgs J., Saha P., Williams L. L. R., 2014,

MNRAS, 439, 2651

Mohammed I., Saha P., Liesenborgs J., 2015, PASJ, 67, 21
Mohammed I., Saha P., Williams L. L. R., Liesenborgs J., Sebesta

K., 2016, MNRAS,

Natarajan P., Kneib J.-P., 1997, MNRAS, 287, 833
Natarajan P., De Lucia G., Springel V., 2007, MNRAS, 376, 180
Natarajan P., Kneib J.-P., Smail I., Treu T., Ellis R., Moran S.,

Limousin M., Czoske O., 2009, ApJ, 693, 970
Navarro J., Frenk C., White S., 1996, ApJ, 462, 563
Newman A. B., Treu T., Ellis R. S., Sand D. J., 2011, ApJL, 728,

L39

Newman A. B., Treu T., Ellis R. S., Sand D. J., Nipoti C., Richard

J., Jullo E., 2013, ApJ, 765, 24

Oguri M., 2010, PASJ, 62, 1017
Oguri M., Bayliss M. B., Dahle H., Sharon K., Gladders M. D.,
Natarajan P., Hennawi J. F., Koester B. P., 2012, MNRAS,
420, 3213

Oguri M., et al., 2013, MNRAS, 429, 482
Planelles S., Borgani S., Fabjan D., Killedar M., Murante G.,
Granato G. L., Ragone-Figueroa C., Dolag K., 2014, MNRAS,
438, 195

Postman M., et al., 2012, ApJ Sup., 199, 25
Puchwein E., Bartelmann M., Dolag K., Meneghetti M., 2005,

AAP, 442, 405

Rasia E., et al., 2012, New Journal of Physics, 14, 055018
Redlich M., Bartelmann M., Waizmann J.-C., Fedeli C., 2012,

Kneib J.-P., Ellis R. S., Santos M. R., Richard J., 2004, ApJ, 607,

AAP, 547, A66

697

Kriek M., van Dokkum P. G., Franx M., Illingworth G. D., Magee

Richard J., et al., 2010, MNRAS, 404, 325
Robertson B. E., Ellis R. S., Furlanetto S. R., Dunlop J. S., 2015,

D. K., 2009, ApJL, 705, L71

ApJL, 802, L19

Krist J. E., Hook R. N., Stoehr F., 2011, in Optical Modeling and
Performance Predictions V. p. 81270J, doi:10.1117/12.892762
Lam D., Broadhurst T., Diego J. M., Lim J., Coe D., Ford H. C.,

Zheng W., 2014, ApJ, 797, 98

Liesenborgs J., De Rijcke S., 2012, MNRAS, 425, 1772
Liesenborgs J., De Rijcke S., Dejonghe H., 2006, MNRAS, 367,

Rodney S. A., et al., 2015, ApJ, 811, 70
Rodney S. A., et al., 2016, ApJ, 820, 50
Saha P., 2000, AJ, 120, 1654
Sand D. J., Treu T., Ellis R. S., Smith G. P., 2005, ApJ, 627, 32
Schaller M., et al., 2015, MNRAS, 451, 1247
Schneider P., Ehlers J., Falco E. E., 1992, Gravitational Lenses.

1209

Springer Verlag, Heidelberg

Liesenborgs J., de Rijcke S., Dejonghe H., Bekaert P., 2008, MN-

Sebesta K., Williams L. L. R., Mohammed I., Saha P., Liesenborgs

RAS, 389, 415

J., 2015, preprint, (arXiv:1507.08960)

Liesenborgs J., de Rijcke S., Dejonghe H., Bekaert P., 2009, MN-

Sendra I., Diego J. M., Broadhurst T., Lazkoz R., 2014, MNRAS,

RAS, 397, 341

437, 2642

Livermore R. C., Finkelstein S. L., Lotz J. M., 2016, preprint,

S´ersic J. L., 1963, Boletin de la Asociacion Argentina de Astrono-

(arXiv:1604.06799)

mia La Plata Argentina, 6, 41

Ma C.-J., Ebeling H., Marshall P., Schrabback T., 2010, MNRAS,

Sharon K., Gladders M. D., Rigby J. R., Wuyts E., Koester B. P.,

406, 121

Bayliss M. B., Barrientos L. F., 2012, ApJ, 746, 161

MNRAS 000, 1–?? (2016)

The Frontier Fields Lens Modeling Comparison Project

41

Shu C., Zhou B., Bartelmann M., Comerford J. M., Huang J.,

Mellier Y., 2008, ApJ, 685, 70

Smith G. P., et al., 2009, ApJL, 707, L163
Springel V., 2005, MNRAS, 364, 1105
Springel V., White S., Tormen G., Kauﬀmann G., 2001, MNRAS,

328, 726

Springel V., Frenk C. S., White S. D. M., 2006, Nature, 440, 1137
Tormen G., Bouchet F. R., White S. D. M., 1997, MNRAS, 286,

865

Torri E., Meneghetti M., Bartelmann M., Moscardini L., Rasia

E., Tormen G., 2004, MNRAS, 349, 476

Treu T., et al., 2015, ApJ, 812, 114
Treu T., et al., 2016, ApJ, 817, 60
Umetsu K., 2013, ApJ, 769, 13
Umetsu K., et al., 2014, ApJ, 795, 163
Vanzella E., et al., 2012, MNRAS, p. L474
Vanzella E., et al., 2014, ApJL, 783, L12
Vanzella E., et al., 2015, AAP, 576, A116
Vanzella E., et al., 2016, preprint, (arXiv:1602.00688)
Wang L., Li C., Kauﬀmann G., De Lucia G., 2006, MNRAS, 371,

537

Wang X., et al., 2015, ArXiv:1504.02405
Xie L., Guo Q., Cooper A. P., Frenk C. S., Li R., Gao L., 2015,

MNRAS, 447, 636

Zhao D. H., Jing Y. P., Mo H. J., B¨orner G., 2009, ApJ, 707, 354
Zitrin A., Broadhurst T., 2009, ApJL, 703, L132
Zitrin A., et al., 2009, MNRAS, 396, 1985
Zitrin A., Broadhurst T., Bartelmann M., Rephaeli Y., Oguri M.,
Ben´ıtez N., Hao J., Umetsu K., 2012, MNRAS, 423, 2308

Zitrin A., et al., 2013, ApJL, 762, L30
Zitrin A., et al., 2015, ApJ, 801, 44
van der Wel A., 2008, ApJL, 675, L13

MNRAS 000, 1–?? (2016)

