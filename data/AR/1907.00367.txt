Solar Physics
DOI: 10.1007/•••••-•••-•••-••••-•

Probing the eﬀect of cadence on the estimates of
photospheric energy and helicity injections in
eruptive active region NOAA AR 11158

E. Lumme1
G. H. Fisher3
J. Pomoell1

· M. D. Kazachenko2,3
· B. T. Welsch4,3
·
· E. K. J. Kilpua1

·

c(cid:13) Springer ••••

Abstract In this work we study how the input data cadence aﬀects the photo-
spheric energy and helicity injection estimates in eruptive NOAA active region
11158. We sample the novel 2.25-minute vector magnetogram and Dopplergram
data from the Helioseismic and Magnetic Imager (HMI) instrument onboard
the Solar Dynamics Observatory (SDO) spacecraft to create input datasets of
variable cadences ranging from 2.25 minutes to 24 hours. We employ state-of-
the-art data processing, velocity and electric ﬁeld inversion methods for deriving
estimates of the energy and helicity injections from these datasets. We ﬁnd that
the electric ﬁeld inversion methods that reproduce the observed magnetic ﬁeld
evolution through the use of Faraday’s law are more stable against variable
cadence: the PDFI (PTD-Doppler-FLCT-Ideal) electric ﬁeld inversion method
produces consistent injection estimates for cadences from 2.25 minutes up to 2
hours, implying that the photospheric processes acting on time scales below 2
hours contribute little to the injections, or that they are below the sensitivity of
the input data and the PDFI method. On other hand, the electric ﬁeld estimate
derived from the output of DAVE4VM (Diﬀerential Aﬃne Velocity Estimator
for Vector Magnetograms), which does not fulﬁl Faraday’s law exactly, produces

(cid:66) E. Lumme

erkka.lumme@helsinki.ﬁ

1 Department of Physics, University of Helsinki, P.O. Box 68, FI-00014 Helsinki,

Finland

2 Astrophysical and Planetary Sciences, University of Colorado, 2000 Colorado

Avenue, Boulder, CO 80309, USA

3

Space Sciences Laboratory, University of California, 7 Gauss Way, Berkeley, CA
94720-7450, USA

4 Natural and Applied Sciences, University of Wisconsin, Green Bay, Green Bay, WI

54311, USA

SOLA: paper_draft.tex; 24 May 2022; 0:25; p. 1

9
1
0
2

n
u
J

0
3

]

R
S
.
h
p
-
o
r
t
s
a
[

1
v
7
6
3
0
0
.
7
0
9
1
:
v
i
X
r
a

 
 
 
 
 
 
Lumme et al.

signiﬁcant variations in the energy and helicity injection estimates in the 2.25-
minute to 2-hour cadence range. We present also a third, novel DAVE4VM-based
electric ﬁeld estimate, which corrects the poor inductivity of the raw DAVE4VM
estimate. This method is less sensitive to the changes of cadence, but still faces
signiﬁcant issues for the lowest of considered cadences (≥2 hours). We ﬁnd sev-
eral potential problems in both PDFI- and DAVE4VM-based injection estimates
and conclude that the quality of both should be surveyed further in controlled
environments.

Keywords: Corona, Active; Corona, Models; Helicity, Magnetic; Helicity, Ob-
servations; Magnetic ﬁelds, Photosphere; Magnetic ﬁelds, Corona

1. Introduction

Estimates for energy and helicity injections from the photosphere to the upper
solar atmosphere in active regions are important for studying the dynamics of
ﬂux emergence (Cheung and Isobe, 2014; Liu et al., 2014), ﬂux cancellation
(Welsch, 2006; Yardley et al., 2018), and the evolution of active regions (van
Driel-Gesztelyi and Green, 2015; Cheung et al., 2016). These estimates are also
found to be particularly important for determining when and how solar erup-
tions, such as ﬂares and coronal mass ejections (CMEs), occur in active regions
(Cheung and DeRosa, 2012; Tziotziou, Georgoulis, and Liu, 2013; Kazachenko
et al., 2015; Pariat et al., 2017; Pomoell, Lumme, and Kilpua, 2019). Despite the
fact that the coronal energy and helicity budgets may be estimated via coronal
modeling (though with signiﬁcant uncertainties, e.g. DeRosa et al., 2015), there
are also less computationally intensive methods for estimating these quantities:
so-called evolutionary estimates for the energy and helicity injections are ac-
quired by integrating the photospheric Poynting and relative helicity ﬂuxes in
space and time (Kazachenko et al., 2015). These ﬂuxes, in turn, are estimated
using the photospheric electric and plasma velocity ﬁelds, which can be inverted
from the remote sensing observations of the photospheric magnetic ﬁeld and line-
of-sight (LOS) plasma velocity. Due to the often used simplifying assumption of
ideal Ohm’s law,

E = −V × B

(1)

in the photosphere, the electric and plasma velocity ﬁelds are interchangeable in
this context.

The accuracy of these estimates has progressed signiﬁcantly over the past
decade or so both due to improved remote sensing observations as well as devel-
opments in the inversion methods. Photospheric vector magnetic ﬁeld estimates
(vector magnetograms) and LOS plasma velocity estimates (Dopplergrams),
based on spectropolarimetric observations of the Zeeman and Doppler eﬀects,
are currently provided by several magnetographs (see Lagg et al., 2017, for a
review), including the Helioseismic and Magnetic Imager (HMI) (Scherrer et al.,
2012; Schou et al., 2012) onboard Solar Dynamics Observatory (SDO) (Pes-
nell, Thompson, and Chamberlin, 2012). In turn, a wide collection of inversion

SOLA: paper_draft.tex; 24 May 2022; 0:25; p. 2

Probing the eﬀect of cadence

methods have been developed for determining the photospheric plasma velocity
and/or electric ﬁeld components (see Welsch et al., 2007; Schuck, 2008; Ravindra,
Longcope, and Abbett, 2008; Kazachenko, Fisher, and Welsch, 2014; Tremblay
and Vincent, 2015; Lumme, Pomoell, and Kilpua, 2017, for further details), and
these methods have been tested using both real and synthetic input data.

The state-of-the-art inversion methods that are currently publicly available in-
clude the PDFI electric ﬁeld inversion method (Kazachenko, Fisher, and Welsch,
2014; Fisher et al., 2019) and the DAVE4VM velocity inversion method (Schuck,
2008). These methods have shown their accuracy in estimating the electric/velocity
ﬁelds and the related energy and helicity ﬂuxes in a single test case, which we
refer to as the “ANMHD test”. In the ANMHD test, synthetic magnetic ﬁeld
and LOS plasma velocity estimates from an anelastic magnetohydrodynamic
(ANMHD) simulation (Abbett et al., 2004) of an emerging ﬂux rope are used as
input to the inversion, and the inverted velocity/electric ﬁelds are compared
with the known ﬁelds in the simulation (Welsch et al., 2007; Schuck, 2008;
Kazachenko, Fisher, and Welsch, 2014). The fact that only a single simulation
test has been used potentially limits the generality of the results: for example, the
vertical emergence of ﬂux is overemphasized in the ANMHD simulation, which
causes the role of shearing motions in the in the energy and helicity injection
to be understated (Welsch et al., 2007; Kazachenko, Fisher, and Welsch, 2014).
Furthermore, the synthetic data from the simulation is also smooth both in time
and space, and does not necessarily represent well actual vector magnetogram
and Dopplergram input, which often exhibit small-scale structures, noise and
other artefacts.

Despite the limitations in the ANMHD-based validation both the PDFI and
DAVE4VM inversion methods have been used successfully with observational
input to estimate photospheric energy and helicity ﬂuxes (e.g. Liu and Schuck,
2012; Kazachenko et al., 2015; Liu et al., 2016b; Lumme, Pomoell, and Kilpua,
2017; Bi et al., 2018), to study the properties of the photospheric plasma velocity
ﬁeld (e.g. Liu et al., 2016a; Wang et al., 2017), and to constrain the data-
driven boundary conditions for coronal simulations (Fisher et al., 2015; Pomoell,
Lumme, and Kilpua, 2019). However, the use of the methods with actual ob-
servations has been mostly limited to a single type of vector magnetogram and
Dopplergram input from the SDO/HMI instrument, thus being ﬁxed to cer-
tain cadence (12 minutes), resolution (0.5” per pixel) and noise-characteristics
(σB ∼ 100 Mx cm−2) of that data. Thus, it is unclear how the PDFI and
DAVE4VM methods respond to, for example, diﬀerent cadence, resolution and
noise characteristics of the input data. It is also not known whether the possible
undersampling of the photospheric evolution (i.e. insuﬃcient temporal cadence
for capturing the photospheric motions in a given spatial resolution) in the
SDO/HMI data results in a loss of physical processes that have a signiﬁcant
contribution to the injection of energy and helicity. Moreover, Leake, Linton, and
Schuck (2017) found that undersampling may result in spurious energy ﬂuxes
into the corona.

Considering the crucial importance of energy and helicity injection estimates
as well as the variety of dataset and products available now and in the future,
an assessment of how the inversion methods respond to diﬀerent input data

SOLA: paper_draft.tex; 24 May 2022; 0:25; p. 3

Lumme et al.

is needed. In this paper we perform a comprehensive study on the response
of energy and helicity injection estimates to input data of which the temporal
resolution is varied. We sample the novel 135-second high-cadence vector magne-
togram and Dopplergram data input from the SDO/HMI instrument (Sun et al.,
2017) as well as the nominal 12-minute data (Hoeksema et al., 2014) to create
an ensemble of input datasets with variable cadence ranging from 135 seconds
all the way up to 24 hours, thus covering cadences of data products from other
instruments (see e.g. Lagg et al., 2017, for review). We invert the photospheric
velocity and electric ﬁelds from this data using the PDFI and DAVE4VM meth-
ods. We develop new self-consistent ways to optimize the inversion methods for
each cadence and discuss also the role of spatial resolution and undersampling
at the lowest cadences.

Our study focuses on an eruptive active region NOAA AR 11158, thus making
our results relevant for studies of active regions and solar eruptions. This active
region was chosen because it is located close to the disk center all the way from its
emergence to its strongest activity (X2.2 ﬂare and a halo CME), which ensures
good data quality and spatial resolution for studying the energy and helicity
injection over this period. The region has also been extensively studied oﬀering
us a baseline of results for reference and context (e.g. Schrijver et al., 2011;
Cheung and DeRosa, 2012; Liu and Schuck, 2012; Sun et al., 2012; Tziotziou,
Georgoulis, and Liu, 2013; Kazachenko et al., 2015; Fisher et al., 2015; Lumme,
Pomoell, and Kilpua, 2017; Inoue et al., 2018).

This paper is organized as follows: In Section 2 we present the used data
products, inversion methods, and the approaches we use for optimizing the
methods for use with input data of variable cadence. Section 3 details our central
ﬁndings on the eﬀect of cadence on the energy and helicity injection estimates.
Section 4 discusses the observed limitations and issues in our results as well as
the implications of our ﬁndings on the applicability of the inversion methods in
estimating the photospheric energy and helicity injections. Section 5 summarizes
our results and conclusions.

2. Data and methods

In this section we describe how we download and process the vector magnetogram
and Dopplergram data to create data series of variable cadence and spatial
resolution for NOAA AR 11158. We then discuss how we optimize and employ
optical ﬂow methods to produce additional estimates for the plasma velocity, and
then invert the photospheric electric ﬁeld from this data. Finally, we present our
method for deriving the energy and helicity injections and their error estimates.

2.1. Processing of vector magnetogram and Dopplergram data

As the input data for this work we use full-disk disambiguated vector magne-
tograms and Dopplergrams from the SDO/HMI instrument (Schou et al., 2012;
Scherrer et al., 2012), which we download from the Joint Science Operations
Center (JSOC, http://jsoc.stanford.edu/). We use both the nominal 12-minute

SOLA: paper_draft.tex; 24 May 2022; 0:25; p. 4

Probing the eﬀect of cadence

(720 s) data (Hoeksema et al., 2014) as well as the novel 2.25-minute (135 s)
data (Sun et al., 2017). Both datasets have the same spatial resolution (0.5”
per pixel in the plane of sky), but diﬀer in the methods used to process Stokes
vector data for the magnetic ﬁeld inversion, the disambiguation of the azimuth,
and in the noise levels (see Sun et al., 2017, for details). Vector magnetograms in
these datasets are disambiguated in the strong ﬁeld pixels (thresholds |B| ∼ 200
Mx cm−2 and |B| ∼ 150 Mx cm−2 for 2.25- and 12-minute data, respectively)
using the minimum energy method (Metcalf, 1994). In the weak ﬁeld pixels three
less sophisticated methods are oﬀered as user-deﬁned options (Hoeksema et al.,
2014), from which we choose to use the random disambiguation (as recommended
e.g. by Liu et al., 2017; see also discussion in Lumme, Pomoell, and Kilpua, 2017).
For Dopplergrams (i.e. LOS plasma velocity maps) we use the VInv velocity
provided by the magnetic ﬁeld inversion of the vector magnetogram datasets
above. This diﬀers from the work of Kazachenko et al. (2015), who employed
the VDop estimate based on the simpler “MDI-like algorithm” (see Hoeksema
et al., 2014 for details about the diﬀerences between VInv and VDop). Similarly to
Kazachenko et al. (2015) we calibrate the Dopplergrams using the magnetic cal-
ibration method of Welsch, Fisher, and Sun (2013), which removes the observer
motion, solar rotation and convective blueshift from the data; the convective
blueshift bias velocity is determined as the median of Dopplergram velocities
over all pixels in polarity inversion lines (PILs) suﬃciently close to the disk
center (< 60◦ in heliocentric angle). Before subtracting the constant blueshift
bias velocity from full-disk Dopplergrams we smooth these velocities in time
using a temporal smoother with a width of 4.2 hours (Kazachenko et al., 2015)
to reduce temporal noise in the bias velocities.

After downloading and processing the full-disk vector magnetograms and
Dopplergrams we reproject the magnetograms to a local Cartesian frame and
vector basis (Bx, By, Bz) using Mercator projection that tracks the NOAA active
region 11158 over its disk transit (see Figure 1 for example frames from this time
series). We use here methods described in Lumme, Pomoell, and Kilpua (2017),
and this processing includes also removal of bad pixels of the magnetic ﬁeld
inversion (Hoeksema et al., 2014) and spurious temporal ﬂips in the azimuth
disambiguation (Welsch, Fisher, and Sun, 2013), where we use identical pa-
rameters for both 2.25- and 12-minute data (see Lumme, Pomoell, and Kilpua,
2017 for details). Dopplergram data is interpolated to the same system as the
magnetograms, keeping the information about the LOS direction for each pixel.
The resulting active region patch has 547 × 527 pixels (with a projection pixel
size of 0.03◦, 0.5” at the disk center, ∼364 km on the Sun), and the series of
reprojected magnetograms spans from Feb 10 14:00 UT to Feb 17 00:00 UT.

2.2. Sampling the vector magnetogram and Dopplergram data

A direct comparison on the eﬀect of cadence between the 2.25- and 12-minute
vector magnetogram and Dopplergram datasets is problematic, as they have
diﬀerences in the Stokes vector data processing and in the noise levels of the mag-
netic ﬁeld (Sun et al., 2017). In order to mitigate the eﬀect of these diﬀerences
we created 6 datasets with variable cadence by sampling the 2.25-minute data

SOLA: paper_draft.tex; 24 May 2022; 0:25; p. 5

Lumme et al.

Figure 1. Example Bz magnetogram and VLOS Dopplergram taken from our high-cadence
2.25-minute reprojected series that tracks the NOAA active region 11158. Note that contrary
to the usual convention VLOS sign is negative for downﬂows of plasma. The frames show the
active region on Feb 14 01:48 UT, 2011 close to the central meridian passage of the active
region, and magnetogram and Dopplergram data near this time was used as a representative
input for optimization of the velocity inversion parameters (Section 2.3) as well as for deriving
the error estimates for energy and helicity injections (Section 2.6).

only. However, the 12-minute data was still included in the study as a reference
due to its general use in previous works and its better availability. The cadences
created by sampling the 2.25-minute data are: 2.25 minutes (1×2.25-min), 11.25
minutes (5×2.25-min), 2.025 hours (54×2.25-min), 6 hours (160×2.25-min), 12
hours (320×2.25-min) and 24 hours (640×2.25-min), where the cadences >2.25-
min are created from the 2.25-minute data by taking every 5th, 54th, 160th,...
frame from the 2.25-minute series. Hereafter we refer to the diﬀerent cases by
their cadence (e.g. “6 hours”), except for the 11.25-min case, which we refer
also to as “mock nominal” cadence, as it mimics the nominal 12-minute HMI
cadence, but with noise characteristics and Stokes data processing consistent
with the 2.25-min magnetogram and Dopplergram data.

It is evident that the lowest cadences (≥2 h) undersample the data signif-
icantly when considering the typical photospheric motions of Vh (cid:46) 1 km s−1,
for which we get: Vh∆t/∆x (cid:38) 20, for cadences ∆t ≥ 2 h and ∆x = 364 km
(pixel size in our vector magnetogram series). This undersampling is expected
to introduce issues particularly for the optical ﬂow velocity methods (Section
2.3) and may even introduce spurious energy and helicity ﬂuxes (see Leake,
Linton, and Schuck, 2017). In order to study this eﬀect in our results we perform
additional analysis for the lowest cadences (≥2 h), for which we create new data
series by rebinning the data by a factor of 15 to yield a projected pixel size of
0.45◦ that corresponds ∆x(cid:48) ≈ 5470 km and Vh∆t/∆x (cid:38) 1.3. (The amount of
undersampling for the rebinned data is discussed further in Appendix B.)

Finally, for the optical ﬂow velocity inversion (Section 2.3), the electric ﬁeld
inversion (Section 2.4), and for computing the energy and helicity ﬂuxes (Sec-
tion 2.5) we mask the noise-dominated pixels from the magnetograms to avoid
spurious eﬀects caused by noise (see Kazachenko et al., 2015; Lumme, Pomoell,
and Kilpua, 2017, for further discussion). For this purpose we use a constant
noise threshold of |B| = 300 Mx cm−2 for all datasets discussed above. This
threshold was used previously for 2.25-minute HMI data by Sun et al. (2017).

SOLA: paper_draft.tex; 24 May 2022; 0:25; p. 6

    0  100  200  300  400  500X pixels [364 km/pixel]    0  100  200  300  400  500Y pixels [364 km/pixel]a) Bz magnetogram100075050025002505007501000Mx cm2    0  100  200  300  400  500X pixels [364 km/pixel]    0  100  200  300  400  500Y pixels [364 km/pixel]b) VLOS Dopplergram1.000.750.500.250.000.250.500.751.00km s1Probing the eﬀect of cadence

2.3. Optical ﬂow velocity inversion

Having determined all components of the photospheric magnetic ﬁeld and one
(LOS) component of plasma velocity from the processed data products (Sec-
tions 2.1 and 2.2) we need two more velocity components to fully constrain the
electric ﬁeld from the ideal Ohm’s law (Eq. 1). We estimate (a part of) the
missing velocity components using optical ﬂow methods, which track motion of
features in the magnetograms. In this study we use two optical ﬂow methods,
each linked to a speciﬁc electric ﬁeld inversion method. The ﬁrst method is the
Fourier Local Correlation Tracking (FLCT) method (Fisher and Welsch, 2008)
that estimates the horizontal velocity components parallel to the photosphere
Vh = (Vx, Vy), which are then used as a part of the PDFI electric ﬁeld inversion
method (Section 2.4.1). The second method is the Diﬀerential Aﬃne Velocity
Estimator for Vector Magnetograms (DAVE4VM) (Schuck, 2008) that provides
the full three-component velocity ﬁeld V = (Vx, Vy, Vz), which is then used to
derive the two DAVE4VM-based electric ﬁeld estimates (Section 2.4.2).

The FLCT method determines the horizontal optical ﬂow Vh between two Bz
magnetograms (Bz(xi, yj, t1) and Bz(xi, yj, t2)) at each pixel (xi, yj) by ﬁnding a
shift (δx, δy) that maximizes the cross-correlation function C i,j(δx, δy) between
the ﬁrst image S1(x, y) and second image S2(x, y) – both windowed to include
only the neighborhood of the pixel in question:

C i,j(δx, δy) = (cid:82) (cid:82) dx dy Si,j∗

1

(−x, −y)Si,j

2 (δx − x, δy − y),

where

Si,j
k (x, y) = Bz(x, y, tk) exp

(cid:20)

−

(x − xi)2 + (y − yj)2

(cid:21)

σ2

F LCT

(2)

(3)

is the windowed subimage centered at the pixel (xi, yj); the width of the Gaussian
windowing function σF LCT is a free parameter of the method. The optimal shift
(δx, δy) is determined to subpixel accuracy (see Fisher and Welsch, 2008, for
details), and it gives the velocity:

V i,j
h ((t1 + t2)/2) = 1

∆t (δx, δy)

(cid:12)
(cid:12)
(cid:12)
(cid:12){(δx,δy)| max[Ci,j (δx,δy)]}

,

(4)

where ∆t = t2 − t1 is the temporal distance between the magnetograms.

As discussed by Schuck (2005) the velocity of Eq. 4 determined by maximizing
the correlation in Eq. 2 fulﬁlls (in a least squares sense) the advection equation:

∂Bz
∂t

+ Vh · ∇hBz = 0,

(5)

weighted by the Gaussian windowing function of Eq. 3. In the DAVE4VM
method this minimization approach is generalized for the normal (z) component
of Faraday’s law under the assumption of the ideal Ohm’s law:

∂Bz
∂t

= −[∇ × E]z = [∇ × (V × B)]z = −∇h · (BzVh − VzBh),

(6)

SOLA: paper_draft.tex; 24 May 2022; 0:25; p. 7

Lumme et al.

and the method determines a full three-component velocity ﬁeld V = (Vx, Vy, Vz)
at each pixel (xi, yi) that minimizes the deviations to the normal component of
the induction equation (Eq. 6) in a least squares sense (Schuck, 2008). The
input for this minimization consists of the time derivative of the Bz component
∂Bz/∂t and the spatial derivatives of the magnetic ﬁeld (∂lBm, l ∈ {x, y} and
m ∈ {x, y, z}) determined from a time series of vector magnetograms. The input
data are windowed similarly to Eq. 3, but instead of a Gaussian windowing
function, DAVE4VM employs a square top hat as the windowing function. The
side length of the top hat is a free parameter, which we hereafter refer to as the
“DAVE4VM window size”.

When specifying the input data for FLCT and DAVE4VM, we employ a
central diﬀerence scheme where magnetograms at times t and t ± ∆t are used to
estimate the velocity at time t (see Appendix A.1). We also remove the noise-
dominated pixels (|B| < 300 Mx cm−2) from the output (see Appendix A.2).

Similarly to the work of Schuck (2008) and Liu and Schuck (2012) we choose
the DAVE4VM window size so that the output velocity V optimally reproduces
the normal component of the induction equation (Eq. 6) over the entire magne-
togram, excluding the noise-dominated pixels |B| < 300 Mx cm−2. The optimal
σF LCT parameter is chosen in a similar fashion so that the output velocity best
optimizes the advection equation for the Bz component of the magnetic ﬁeld (Eq.
5) (as suggested by Fisher and Welsch, 2008), again excluding the masked noise-
dominated pixels (|Bz| (cid:46) 300 Mx cm−2). Further details of the optimization
and the analysis of the results are presented in Appendix B. The optimization
results for all of our input datasets are collected in Table 2.

After specifying the optimal FLCT and DAVE4VM parameters for all of
our vector magnetogram datasets (see Section 3.3), we then run the velocity
inversion codes for all input magnetogram time series of various cadence and
spatial resolution (Section 2.2) producing Vh(FLCT) and V (DAVE4VM) time
series for each to be used in the electric ﬁeld inversion.

2.4. Electric ﬁeld inversion

After producing time series of the photospheric vector magnetogram, Dopp-
lergram and optical ﬂow velocity estimates for variable cadence and spatial
resolution, we compute the photospheric electric ﬁeld using each of the input
data series and three inversion schemes: one based on the direct use of the
PDFI method and two based on the DAVE4VM velocity inversion. These are
presented in detail below. The temporal and spatial discretization used in the
inversion methods below as well as the masking of the noise-dominated pixels
(|B| < 300 Mx cm−2) are detailed in Appendix A.

2.4.1. PDFI method

The PTD-Doppler-FLCT-Ideal (PDFI) method (Kazachenko, Fisher, and Welsch,
2014; Fisher, Welsch, and Abbett, 2012) is a comprehensive, publicly available
approach for photospheric electric ﬁeld inversion, and the method employs all
established types of input data: magnetograms, Dopplergrams and optical ﬂow

SOLA: paper_draft.tex; 24 May 2022; 0:25; p. 8

Probing the eﬀect of cadence

estimates. The approach is based on the decomposition of the electric ﬁeld into
the inductive EI and non-inductive component −∇ψ:

The inductive (divergence-free) component is constrained by Faraday’s law:

E = EI − ∇ψ.

∇ × E = ∇ × EI = −

∂B
∂t

,

(7)

(8)

where ∂B/∂t may be estimated from a time series of vector magnetograms.
In the PDFI method the inductive component is solved using the Poloidal-
Toroidal Decomposition (PTD) (Fisher et al., 2010; Chandrasekhar, 1970), and
the resulting electric ﬁeld fulﬁlls the z component of the Faraday’s law exactly –
except for small numerical errors detailed in Appendix A.3. The non-inductive
(curl-free) component requires additional constraints from the data that may be
retrieved from the ideal Ohm’s law and the velocity estimates:

∇2ψ = −∇ · E = ∇ · (V × B)

(9)

In the PDFI method the Poisson equation above is not solved as such, but is
instead split into three components: the Doppler contribution (D), FLCT con-
tribution (F) and Ideal (I) contribution. The Doppler and FLCT contributions
are deduced from Dopplergram and FLCT optical ﬂow velocity estimates with
spatial weighting, whereas the ideal contribution ensures that the total electric
ﬁeld (Eq. 7) is perpendicular to the magnetic ﬁeld as implied by the ideal Ohm’s
law (see Kazachenko, Fisher, and Welsch, 2014; Fisher et al., 2019, for details).
We employ the latest version of the PDFI method, the PDFI SS software

(http://cgem.ssl.berkeley.edu/cgi-bin/cgem/PDFI SS/index), which has several changes
as compared to the original method described in Kazachenko, Fisher, and Welsch
(2014). The updates include the use of a staggered grids and spherical coordi-
nates (“SS” suﬃx stands for “spherical staggered”), and they are presented in
detail by Fisher et al. (2019) and summarized in Appendix A.3.

Since our input data patch is small (latitudinal half-width of the region ∼
8◦), distortion eﬀects caused by the use of Mercator projection remain small:
1 − cos2 8◦ ≈ 2% (see e.g. Kazachenko et al., 2015, for details). Therefore we
get little beneﬁt from using spherical coordinates in our analysis. Moreover, the
DAVE4VM velocity inversion (Section 2.3) operates on a Cartesian plane by
default, and transforming into spherical coordinates would require modiﬁcations
to the procedure. Therefore we decide to remain in the Cartesian approximation,
which however, requires modiﬁcations to the use of the PDFI SS software that
employs spherical coordinates by default. These modiﬁcations are detailed in
Appendix A.3.

2.4.2. DAVE4VM-based methods

Since DAVE4VM provides all three components of the velocity ﬁelds for the given
vector magnetogram input, the output can be used to estimate the photospheric

SOLA: paper_draft.tex; 24 May 2022; 0:25; p. 9

Lumme et al.

electric ﬁeld directly from the ideal Ohm’s law (Eq. 1), E = −VD ×B, where VD
is the DAVE4VM velocity estimate. We use this as our ﬁrst DAVE4VM-based
electric ﬁeld estimate and hereafter refer to it as “raw DAVE4VM estimate”
or “raw DAVE4VM electric ﬁeld”.

The raw DAVE4VM estimate is the easiest to acquire, but as already noted by
Schuck (2008) it is not necessarily inductive, i.e. the raw DAVE4VM electric ﬁeld
does not necessarily fulﬁll the normal component of Faraday’s law (or the normal
component of the ideal induction equation). This inconsistency arises from two
facts: First, the DAVE4VM method was intentionally formulated so that the
output velocity fulﬁlls the normal component of the induction equation (Eq. 6)
only “statistically within the window by minimizing the mean squared deviations
from the ideal induction equation” (Schuck, 2008). This is based on the idea that
real magnetograms contain noise, and therefore complete inductiveness and thus
also complete reproduction of the noise is not desired. Second, the minimization
of the deviations to the induction equation is done at each pixel over a top-
hat windowed subimage surrounding the pixel, and therefore the minimization
problem at each pixel is diﬀerent from the others. Thus, there is no guarantee
or constraint that would force the velocity ﬁelds at neighboring pixels to yield
inductivity in the chosen discretization of the induction equation.

Although the DAVE4VM estimate is inductive to high accuracy in ANMHD
tests (Schuck, 2008), as pointed out by Lumme, Pomoell, and Kilpua (2017)
the inductivity of the raw DAVE4VM estimate is, however, very poor for real
magnetogram input. As indicated by the results presented in Appendix B, a likely
explanation for this is the larger spatial and temporal noise and higher spatial
structuring in real magnetograms as compared to the very smooth ANMHD
data. The fact that the ﬁeld does not drive the magnetic ﬁeld evolution as in the
observations presents signiﬁcant problems both for the physical interpretation of
the ﬁeld and for its potential use as a data-driven boundary condition for coronal
simulations. To remedy this, we recomputed a second electric ﬁeld estimate
from the DAVE4VM output, in which the inductivity is ensured (similarly as
suggested in Section 3.2 of Schuck, 2008). We employ here the decomposition of
Eq. 7, from which the inductive component is solved using the machinery of the
PDFI method, being thus equivalent to the inductive component EI of our PDFI
estimates (Section 2.4.1, Eqs. 7 and 8), whereas the horizontal components of
the non-inductive component −∇hψ are solved from:

∇2

hψ = −∇h · E = ∇h · (VD × B)h

(10)

where E is the raw DAVE4VM electric ﬁeld and VD is the DAVE4VM velocity.
The Poisson equation is solved using the same numerical tools as in the PDFI
method (Kazachenko, Fisher, and Welsch, 2014; Fisher et al., 2019). We refer to
the total electric ﬁeld estimate,

E = EI − ∇hψ

(11)

as the “inductive DAVE4VM estimate” or “inductive DAVE4VM elec-
tric ﬁeld”. Note that ∂ψ/∂z = 0 for the non-inductive component −∇ψ =
−∇hψ of the inductive DAVE4VM estimate.

SOLA: paper_draft.tex; 24 May 2022; 0:25; p. 10

Probing the eﬀect of cadence

2.5. Estimates of the energy and relative helicity injections

Total injections of magnetic energy and relative helicity can be estimated by
integrating the photospheric vertical Poynting and relative helicity ﬂuxes both
in space and time (Berger and Field, 1984; D´emoulin, 2007; Liu and Schuck,
2012; Kazachenko et al., 2015; Lumme, Pomoell, and Kilpua, 2017):

Em(t) =

=

HR(t) =

(cid:90) t

0
1
µ0
(cid:90) t

0

dt(cid:48) dEm

dt(cid:48) =
(cid:90)

(cid:90) t

0

dt(cid:48)

(cid:90) t

(cid:90)

dt(cid:48)

0

dA Sz

dA (E × B) · ˆz,

dt(cid:48) dHR

dt(cid:48) = −2

(cid:90) t

(cid:90)

dt(cid:48)

0

dA (Ap × E) · ˆz.

(12)

(13)

We use here time discretization consistent with the electric ﬁeld inversion (see
Appendix A.1). The vector potential Ap is solved from the Bz component using
the same Poloidal-Toroidal Decomposition method as in solving the inductive
electric ﬁeld EI used in the PDFI and inductive DAVE4VM electric ﬁeld esti-
mates (Section 2.4 and Appendix A.3, Eqs. 7, 8, 10, 11). The same Ap is used to
derive the helicity ﬂux for all of our three electric ﬁeld estimates. It is also worth
noting that we do not include the zero-padding regions, which are added to the
input data maps in the inversion, to the area integrals above (the padding is
added only for numerical convenience in order to acquire more stable results for
the solutions of Poisson equations, see Kazachenko, Fisher, and Welsch, 2014).
Note that in computing the Poynting ﬂux we must mask the input magne-
togram data consistently with the electric ﬁeld inversion (Section A.2). How-
ever, when computing the helicity ﬂux, the masking is already included in the
computation of Ap and E.

2.6. Error analysis

We estimate the error in our ﬁnal total energy and helicity injection estimates
arising from the magnetogram noise following the Monte Carlo approaches of
Liu and Schuck (2012) and Kazachenko et al. (2015). We select a representative
frame from our NOAA AR 11158 time series, more speciﬁcally the frame on
Feb 14 01:48 UT close to the central meridian passage of the active region, and
perform 200 (Liu and Schuck, 2012) Monte Carlo realizations for the velocity
and electric ﬁeld inversion results for this frame and for each cadence; the ﬁrst
realization in the ensemble is the original unperturbed case. For each of the
199 additional realizations we perturb the input magnetogram data by adding
random Gaussian noise to each pixel. For the data series created from the 12-
minute HMI input data we perturb the magnetic ﬁeld components (Bx, By, Bz)
with Gaussian noise of width (σx, σy, σz) = (100, 100, 30) Mx cm−2 using the
values of Kazachenko et al. (2015) derived for SDO/HMI data in the same active
region. Although we have determined the (σx, σy, σz) values also for our own
data series by ﬁtting a Gaussian to the weak ﬁeld core (Kazachenko et al., 2015;
Welsch, Fisher, and Sun, 2013; DeForest et al., 2007), we ﬁnd that the values are

SOLA: paper_draft.tex; 24 May 2022; 0:25; p. 11

Lumme et al.

too strongly dependent on the choice of the weak ﬁeld disambiguation method
(Section 2.1). Therefore we use the values of Kazachenko et al. (2015), which
are derived from a dataset where a consistent disambiguation method is used for
all pixels. We employ larger perturbations for all data series created from the
3 Mx cm−2 to each of the
2.25-minute HMI magnetogram input, and add 50/
(σx, σy, σz) values of the 12-minute data, consistent with the 50 Mx cm−2 larger
noise level of |B| for 2.25-minute magnetograms (Sun et al., 2017).

√

Using the perturbed data from the Monte Carlo runs, we estimate the errors
for the energy dEm/dt and helicity dHR/dt injection rates (Eqs. 12 and 13) by
computing the standard deviation (σdQ/dt, Q ∈ {Em, HR}) over the 200-element
ensemble. We determine a ﬁnal relative error ¯σdQ/dt estimate by computing the
ratio:

¯σdQ/dt =

σdQ/dt
µdQ/dt

(14)

where µ is the mean over the ensemble.

The errors of the energy and helicity injection rates (σdQ/dt = ¯σdQ/dtdQ/dt)
are propagated in the time integration to yield the errors of the total injections
σQ(t) at each time t. This is done using the following scheme: First, the relative
error estimates ¯σdQ/dt above are interpreted as ﬁxed constants over the entire
time series. Second, all dQ/dt(ti) estimates in the time series are assumed to be
independent from each other, i.e. covariances cov(dQ/dt(ti), dQ/dt(tj)) vanish
for all pairs ti, tj. Using the basic properties of the variance and standard devi-
ation (e.g. Christensen, 1996) and the fact that we use the trapedzoidal rule in
the time integration of Eqs. 12 and 13,

Q(tN ) =

(cid:40)

(cid:20) dQ
dt

1
2

(t1) +

(cid:21)

(tN )

+

dQ
dt

N −1
(cid:88)

i=2

dQ
dt

(cid:41)

(ti)

∆t,

(15)

we get:

σQ(tN ) =

(cid:40)

(cid:118)
(cid:117)
(cid:117)
(cid:116)

(cid:104)

1
4

dQ/dt(t1) + σ2
σ2

(cid:105)
dQ/dt(tN )

(cid:41)

σ2
dQ/dt(ti)

∆t2

+

N −1
(cid:88)

i=2

= ¯σdQ/dt∆t

(cid:118)
(cid:117)
(cid:117)
(cid:116)

(cid:20) dQ
dt

1
4

(t1)2 +

dQ
dt

(cid:21)

+

N −1
(cid:88)

(tN )2

i=2

dQ
dt

(ti)2

(16)

where σdQ/dt = ¯σdQ/dtdQ/dt, ¯σdQ/dt is our relative error estimate for the injec-
tion rate, and ∆t = (tN − t1)/(N − 1) is the cadence of the data series.

We have collected the relative error estimates for the rate of changes (dEm/dt,
dHR/dt) over all of our input datasets in Table 1. Further validation of the results
and discussion can be found from Section 4.1.

3. Results

We employ Eqs. 12 and 13 to estimate the total photospheric energy and helicity
injection for each of our electric ﬁeld and magnetogram time series of various

SOLA: paper_draft.tex; 24 May 2022; 0:25; p. 12

Probing the eﬀect of cadence

Table 1. Relative errors ¯σdEm/dt, ¯σdHR/dt for the energy and helicity injection
rates arising from the magnetogram noise. Values are derived for a representative
frame on Feb 14 01:48 UT close to the central meridian passage of the active region
using each of our magnetogram/Dopplergram datasets, and velocity and electric
ﬁeld inversion methods.

PDFI
¯σdEm/dt, ¯σdHR/dt
[%]

raw DAVE4VM
¯σdEm/dt, ¯σdHR/dt
[%]

ind. DAVE4VM
¯σdEm/dt, ¯σdHR/dt
[%]

33, 58
17, 32
11, 14
2.4, 5.9
2.5, 11
1.4, 3.0
0.98, 4.8
1.6, 4.4
0.7, 2.7
6.5, 5.0
7.0, 8.6

30, 20
12, 6.2
6.7, 2.8
9.7, 14
4.4, 7.8
19, 6.3
4.7, 12
9.4, 12
1.4, 1100 2
17, 23
2.2, 5.1

33, 170
18, 66
10, 27
3.1, 88
2.8, 17
1.4, 56
1.2, 18
1.6, 81
0.78, 3.2
5.1, 10
7.9, 0.17

Cadence

2.25 min
11.25 min
12 min 1
2.025 h
- - (rebin 15x)
6 h
- - (rebin 15x)
12 h
- - (rebin 15x)
24 h
- - (rebin 15x)

1Diﬀerent data source, and thus diﬀerent magnetogram noise levels. See Sections
2.1, 2.2 and 2.6 for details.
2This value is spurious. See Section 4.1 for details.

cadence and spatial resolutions. Furthermore, as described in Section 2.6, we
estimate error bars for Em(t) and HR(t) at each time t. The sections below
illustrate the ﬁndings for each of our three electric ﬁeld inversion methods: PDFI
as well as the raw and inductive DAVE4VM methods.

3.1. PDFI estimates

Figures 2 and 3 illustrate the energy and helicity injections (upper panels) and
the injection rates (lower panels) derived from the PDFI electric ﬁelds (Section
2.4.1) for all cadences with full spatial resolution over the interval February
10, 14:48 – 17, 00:00 UT, 2011. The time evolution of the energy and helicity
injections in NOAA AR 11158 is discussed in detail e.g. by Liu and Schuck
(2012), Kazachenko et al. (2015) and Lumme, Pomoell, and Kilpua (2017), so
we omit most of the discussion in this work. However, we brieﬂy classify the
basic phases of the evolution within our analysis interval: the emergence of the
active region on Feb 10 22:00 UT (as deﬁned in the HMI SHARP data product,
Bobra et al., 2014), after which a time interval of slow magnetic ﬂux emergence
and energy and helicity injection continues until Feb 12 ∼18:00 UT. After this
time a period of strong ﬂux emergence begins (see Figure 4 in Lumme, Pomoell,
and Kilpua, 2017), accompanied with enhanced energy and helicity injections
that continue until an X2.2 ﬂare occurs on Feb 15 01:44 UT (dotted vertical line
in the plots). After the ﬂare the PDFI energy injection saturates, with the 11.25-
minute estimate reaching Em(t) ∼ 1 × 1033 ergs, whereas the helicity injection
continues to increase until Feb 16 ∼00:00 UT, with the 11.25-minute estimate
reaching HR(t) ∼ 8.7 × 1042 Mx2 after which it begins to steeply decrease.

SOLA: paper_draft.tex; 24 May 2022; 0:25; p. 13

Lumme et al.

Figure 2. Energy Em(t) injections (upper panel) and energy injection rates dEm/dt (lower
panel) for NOAA AR 11158 derived from the PDFI electric ﬁeld estimates with variable cadence
of the input data. Noise-related error bars of the injection estimates are shown by the shaded
regions surrounding the curves in the upper panel. Note that the injection rate curves with
cadence ≤12 minutes have been smoothed in time using a boxcar of 4 hours to better bring out
the temporal trends. Vertical dotted line indicates the strongest X2.2 class ﬂare in AR 11158,
and the horizontal solid lines indicate the zeros of the y axes. The black error bar at the time
of the ﬂare in the upper panel illustrates the combined method- and noise-related errors of the
PDFI energy injection estimate for the 11.25-minute case (see text for details).

The errors arising from the magnetogram noise, computed using the Monte
Carlo approach, are illustrated by the shaded regions around the injection curves
in Figures 2 and 3, upper panels. In many cases the error bars are vanishingly
small ((cid:46)1%, see Section 4.1 for further discussion) and thus invisible in the
ﬁgure. The error bars are visible for the highest cadence, 2.25 minutes (blue
curve), and the mock nominal HMI cadence of 11.25 minutes (black curve),
which have the largest errors also in the injection rates for the PDFI estimates
(Table 1, second column). Consequently, the energy estimates for these cadences
are consistent within error bars (±3%) at the time of the X-class ﬂare. The
diﬀerence in the 2.25- and 11.25-minute helicity injection estimates is slightly
larger, 8%, which exceeds the combined error bars by 20% (in the combined error
bars the errors of both estimates are added up in quadrature). The nominal 12-
minute estimate (purple curve) has a diﬀerent data source (Sections 2.1 and 2.2),
diﬀerent magnetogram noise characteristics (Section 2.6), as well as diﬀerent
σF LCT parameter (Table 2), and thus results in diﬀerent injections and error
bars, when compared to the mock nominal cadence of 11.25 minutes (6% and
10% larger in Em and HR at the time of the X-class ﬂare, both above noise-
related error bars). Our 12-minute PDFI estimates diﬀer slightly from the results
of Kazachenko et al. (2015), who used similar input data for this active region:
our energy and helicity injection estimates are smaller than theirs by 9% and

SOLA: paper_draft.tex; 24 May 2022; 0:25; p. 14

0.00.20.40.60.81.01.2Em(t) [1033 ergs]Em(t) 2.25-minEm(t) 11.25-minEm(t) 12-minEm(t) 2-hEm(t) 6-hEm(t) 12-hEm(t) 24-h11121314151617Feb 20110.500.250.000.250.500.751.00dEm/dt [1028 ergs/s]dEm/dt 2.25-mindEm/dt 11.25-mindEm/dt 2-hdEm/dt 6-hdEm/dt 12-hdEm/dt 24-hPDFI full resolution energy injection and injection rate estimatesProbing the eﬀect of cadence

Figure 3. Same as Figure 2, but now for the helicity injection HR(t) and the helicity injection
rate dHR/dt.

20% at the time of the X-class ﬂare, respectively. The diﬀerence arises both from
the updates in the electric ﬁeld inversion code (Section 2.4.1 and Appendix A.3),
diﬀerences in the FLCT optical ﬂow inversion (Section 2.3 and Appendices A.1
and A.2) as well as from the diﬀerences in data processing and Dopplergram
data source (Section 2.1).

Although some of the injection estimates discussed above have diﬀerences
larger than the noise-related error bars, all 2.25-min, 11.25-min and 12-min
cases are within the method-related errors of the PDFI method estimated from
the ANMHD tests (see Introduction, Section 1), which are: 25% for the energy
injection and 10% for the helicity injection (Kazachenko, Fisher, and Welsch,
2014; Kazachenko et al., 2015). The combined method- and noise-related errors
for the 11.25-minute estimates are illustrated by the black error bars in Figures 2
and 3, upper panels. However, one should note that we follow here the approach
of Kazachenko et al. (2015) and employ the maximal errors from Kazachenko,
Fisher, and Welsch (2014). Since the errors depend on the viewing angle (i.e.
the angle between the z direction and the average LOS direction over the active
region patch), at smaller viewing angles the errors are smaller: e.g. for angles
<20◦ the error in the energy ﬂux drops to 5%, while the error in helicity ﬂux
remains at 10%. Moreover, even though Kazachenko, Fisher, and Welsch (2014)
deﬁne these errors for the injection rates (dEm/dt, dHR/dt) they are not added
up in quadrature in the time integration (as in Eq. 16) since we consider these
errors to be systematic in nature, and thus use them directly also in Em(t)
and HR(t). In other words, the method-related error may result in a systematic
under/overestimation of injection rates, which would be then directly visible as
an equal relative under/overestimation in the total injections.

SOLA: paper_draft.tex; 24 May 2022; 0:25; p. 15

0.20.00.20.40.60.81.0HR(t) [1043 Mx2]HR(t) 2.25-minHR(t) 11.25-minHR(t) 12-minHR(t) 2-hHR(t) 6-hHR(t) 12-hHR(t) 24-h11121314151617Feb 20111.51.00.50.00.51.0dHR/dt [1038 Mx2/s]dHR/dt 2.25-mindHR/dt 11.25-mindHR/dt 2-hdHR/dt 6-hdHR/dt 12-hdHR/dt 24-hPDFI full resolution helicity injection and injection rate estimatesLumme et al.

When the cadence is lowered to ≥2 hours (orange, green, red and yellow
curves) we see a gradual decrease in the total energy injection as a function of ∆t
with accumulated energy at the time of the X-class ﬂare dropping monotonically
from 86% to 22% of the 11.25-minute mock nominal case over the cadences
of 2 to 24 hours. For helicity we see similar but less monotonic decrease with
accumulated helicities ranging from being 7% larger (2-hour cadence) to 60%
smaller (24-hour cadence) when compared to the 11.25-minute mock nominal
case. Interestingly, for both energy and helicity injection, the 2-hour injection
estimate is very close to the high-cadence estimates and well consistent with
the 11.25-minute estimate within the combined noise- and method-related error
bars. However, the datasets with cadences ≥6 hours underestimate the energy
and helicity injections beyond all error bars.

When we look at the rate of changes dEm/dt and dHR/dt (Figures 2 and 3,
lower panels), we see reasonably consistent trends over all cadences. For example,
the 2.25-minute to 2-hour cases are very similar, and even the 12-hour case
approximates well the trends of the higher-cadence curves (where the highest
≤12-minute cadences are smoothed using a 4-hour boxcar window to better
discern the trends). It has been reported that the highest 2.25-minute cadence
allows solar p-mode (5-minute) oscillations to pass over to the dEm/dt and
dHR/dt injection rates (X. Sun, private communication). We also conﬁrm spikes
at ∼5 minutes in the Fourier power spectra for both. However, this signal does
not propagate notably to the time-integrated quantities Em(t) and HR(t), so we
will neglect it henceforth.

As explained in Section 2.2 due to the signiﬁcant undersampling at the lowest
cadences (≥2 hours) we recomputed the energy and helicity injections also from
the 15-times rebinned magnetogram series. When it comes to the PDFI results
this rebinned version brought very little new features to the energy injection
curves of Figure 2, and produced signiﬁcant loss of helicity injection signal,
most dramatically for 2-hour data, which dropped by ∼90% (see Supplementary
Figure 16).

3.2. Raw DAVE4VM electric ﬁeld estimates

Figures 4 and 5, upper panels, illustrate the energy and helicity injections com-
puted from the raw DAVE4VM electric ﬁeld estimate (Section 2.4.2). First, we
notice that the highest 2.25-minute cadence produces a clearly higher energy
injection (blue curve) than the mock nominal 11.25-minute (black curve) and
the nominal 12-minute (purple curve, mostly hidden behind the black curve)
cases, being ∼50% larger at the time of the X-class ﬂare, whereas the latter
two diﬀer <1% from each other. When we look at the energy injection rate
dEm/dt (Figure 4, lower panel), we ﬁnd that the discrepancy between the 2.25-
minute and 11.25-minute cases in the energy injection is visible as systematically
larger dEm/dt values in the 2.25-minute case, whereas the temporal trends are
similar. When it comes to the lowest cadences (≥2 hours), the raw DAVE4VM
estimate loses practically all of the energy injection signal producing (cid:46)2% of the
high-cadence energy injection estimates at the time of the ﬂare.

SOLA: paper_draft.tex; 24 May 2022; 0:25; p. 16

Probing the eﬀect of cadence

Figure 4. Same as Figure 2 but now using the raw DAVE4VM electric ﬁeld for deriving the
energy injection estimates. The 11.25-minute PDFI estimate from Figure 2 is also plotted for
reference (red curve), and the combined method and noise-related error bars are plotted for
both 11.25-minute raw DAVE4VM and PDFI estimates (black and red bars) at the time of
the X-class ﬂare (vertical black dotted line).

Both the helicity injection and injection rate curves (Figure 5, upper and lower
panel, respectively) of the three highest cadences (2.25, 11.25 and 12 minutes)
are more consistent with each other than in the energy injection case, the 2.25-
minute total injection being “only” ∼20% larger than the 11.25-minute case
at the time of the X-class ﬂare. Similarly to the energy injection, the lowest
cadences produce very small helicity injection, the 2-hour case (orange curve)
yields 28% and ≥6 h cases (green, yellow, and magenta curves) only ≤6% of the
11.25-min injection at the time of the ﬂare.

Due to very similar data processing and inversion scheme our 12-minute raw
DAVE4VM energy and helicity injection estimates at the time of the X-class
ﬂare diﬀer (cid:46)2% from the results of Lumme, Pomoell, and Kilpua (2017) for AR
11158. Lumme, Pomoell, and Kilpua (2017) provide further comparison to other
raw 12-minute DAVE4VM estimates for AR 11158 by Liu and Schuck (2012)
and Tziotziou, Georgoulis, and Liu (2013).

The noise-related error estimates are vanishingly small (<1%) for the raw
DAVE4VM estimates (shaded regions around each curve are practically invisible
in Figures 4 and 5, upper panels), but the method-related error bars from the
ANMHD-tests are again signiﬁcantly larger: 24% and 6% for the energy and
helicity injections, respectively (Schuck, 2008; Kazachenko et al., 2015). They
are plotted for the 11.25-minute estimates in Figures 4 and 5 – combined with
the noise-related error bars – as black error bars at the time of the X-class ﬂare.
When comparing the 11.25-minute PDFI reference curve (red curve) and the
raw DAVE4VM result (black curve) for energy injection in Figure 4, we ﬁnd

SOLA: paper_draft.tex; 24 May 2022; 0:25; p. 17

0.00.51.01.52.02.5Em(t) [1033 ergs]Em(t) 2.25-minEm(t) 11.25-minEm(t) 12-minEm(t) 2-hEm(t) 6-hEm(t) 12-hEm(t) 24-hEm(t) 11.25-minPDFI11121314151617Feb 20110.250.000.250.500.751.00dEm/dt [1028 ergs/s]dEm/dt 2.25-mindEm/dt 11.25-mindEm/dt 12-mindEm/dt 2-hdEm/dt 6-hdEm/dt 12-hdEm/dt 24-hdEm/dt 11.25-minPDFIDAVE4VM full resolution energy injection and injection rate estimatesLumme et al.

Figure 5. Same as Figure 4 but now the raw DAVE4VM helicity injections HR(t) and helicity
injection rates dHR/dt are plotted.

similar evolution between the 11.25- and 12-minute DAVE4VM energy injection
curves and the PDFI case until the time of the X-class ﬂare (where the diﬀerence
is 3%). After the ﬂare the raw DAVE4VM energy injection continues to increase,
whereas the rate of change in the PDFI case becomes occasionally negative
and the total injection saturates. Consequently, the DAVE4VM estimate is 57%
larger at the end of Feb 16. When it comes to the helicity injection (Figure 5,
upper panel), the PDFI and DAVE4VM results diverge already in early Feb 14,
the 11.25-min DAVE4VM result being 45% larger than the PDFI estimate at the
time of the ﬂare, which is beyond the combined noise- and method-related error
bars. Due to the strong negative dHR/dt of the PDFI estimate after Feb 16 00:00
UT (Figure 5, lower panel) the PDFI helicity injection is approximately zero at
the end of our time series, whereas the raw DAVE4VM estimate has reached a
value of 2.6HR(tf lare). This inconsistency between the trends is discussed further
in Section 4.2.

Figure 6 illustrates the raw DAVE4VM energy and helicity injection estimates
derived from both the full resolution and the 15-times rebinned input data.
We ﬁnd a signiﬁcant increase in most of the estimates after rebinning. More
speciﬁcally, the 2-, 6- and 12-hour energy injections (blue/yellow, orange/green
and light blue/purple curves in Figure 6) are increased from approximately zero
to 53%, 29% and 17% of the 11.25-minute full resolution reference injection
(black curve) at the time of the X-class ﬂare. Similarly, the corresponding helicity
injections are increased: 2-hour estimate by a factor of 1.9 reaching 52% of the
full resolution 11.25-minute reference, 6-hour estimate by a factor of 4.4 reaching
28% of the reference, and 12-hour estimate increasing from approximately zero
to 17% of the reference. Despite the signiﬁcantly better recovery of the injection
signals in the rebinned case, none of the rebinned estimates are consistent with

SOLA: paper_draft.tex; 24 May 2022; 0:25; p. 18

0.00.51.01.52.02.53.0HR(t) [1043 Mx2]HR(t) 2.25-minHR(t) 11.25-minHR(t) 12-minHR(t) 2-hHR(t) 6-hHR(t) 12-hHR(t) 24-hHR(t) 11.25-minPDFI11121314151617Feb 20111.00.50.00.51.0dHR/dt [1038 Mx2/s]dHR/dt 2.25-mindHR/dt 11.25-mindHR/dt 12-mindHR/dt 2-hdHR/dt 6-hdHR/dt 12-hdHR/dt 24-hdHR/dt 11.25-minPDFIDAVE4VM full resolution helicity injection and injection rate estimatesProbing the eﬀect of cadence

the full resolution high-cadence reference estimates within the combined method-
and noise-related error bars (black error bars in Figure 6) at the time of the
X-class ﬂare.

Figure 6. Raw DAVE4VM energy Em(t) and helicity HR(t) injections derived from the
full-resolution and 15-times rebinned estimates for the lowest cadences of 2, 6 and 12 hours.
The 11.25-minute full resolution PDFI and raw DAVE4VM estimates are also plotted for
reference (red and black curves) with their combined method- and noise-related error bars at
the time of the X-class ﬂare (vertical black dotted line).

3.3. Inductive DAVE4VM electric ﬁeld estimates

Figures 7 and 8, upper panels, illustrate the energy and helicity injections com-
puted from the inductive DAVE4VM estimates (Section 2.4.2). Similarly to the
raw DAVE4VM estimate the 2.25-minute estimate (blue curves) overestimates
the energy injection of the 11.25- and 12-minute cases (black and purple curves,
which are again mutually consistent, the latter curve being mostly hidden behind
the former), but now clearly less, by only 16% (instead of ∼50% as in the raw
case) at the time of the X-class ﬂare. The temporal trends of both Em(t) and
dEm/dt are very similar over all three cadences. Unlike for the raw DAVE4VM
estimate now also the lowest cadences (≥2 hours; green, orange and light blue
curves) produce noticeable energy injections reaching (cid:46)50% of the 11.25-minute
estimate at the time of the X-class ﬂare. However, this arises mostly from the
inductive component of the electric ﬁeld, the DAVE4VM-based non-inductive
contribution being vanishingly small.

The 11.25-minute inductive DAVE4VM energy injection estimate (black curve)
overestimates the raw DAVE4VM estimate (orange curve) in Figure 7, upper
panel. However, the diﬀerences between the inductive and raw estimates as well
as the PDFI estimate are within the combined noise- and method-related error

SOLA: paper_draft.tex; 24 May 2022; 0:25; p. 19

0.000.250.500.751.001.251.50Em(t) [1033 ergs]0.00.20.40.60.81.0dEm/dt [1028 ergs/s]Em(t) 2-hEm(t) 2-h 15x rebinEm(t) 6-hEm(t) 6-h 15x rebinEm(t) 12-hEm(t) 12-h 15x rebinEm(t) 11.25-minEm(t) 11.25-min PDFI11121314151617Feb 20110.00.20.40.60.81.01.2HR(t) [1043 Mx2]0.00.20.40.60.81.01.2dHR/dt [1038 Mx2/s]HR(t) 2-hHR(t) 2-h 15x rebinHR(t) 6-hHR(t) 6-h 15x rebinHR(t) 12-hHR(t) 12-h 15x rebinHR(t) 11.25-minHR(t) 11.25-min PDFIDAVE4VM full res. and 15x-rebinned injection estimatesLumme et al.

Figure 7. Same as Figure 2 but now using the inductive DAVE4VM electric ﬁeld for com-
puting the energy injections. The 11.25-minute PDFI and raw DAVE4VM estimates (red and
orange curves) are also plotted for reference with their combined method- and noise-related
error bars at the time of the X-class ﬂare (dotted vertical line).

bars of the raw DAVE4VM and the PDFI estimates (red/orange bars) at the time
of the X-class ﬂare. When it comes to the helicity injections in Figure 8, upper
panel, HR(t) curves have very similar temporal trends between the raw and
inductive DAVE4VM estimates, however, with noticeable systematic diﬀerences.
The raw estimate is larger than the inductive one by (cid:46)27% for cadences ≤6 hours
at the time of the X-class ﬂare, which are above the method-related error bars
of the raw estimate. The inductive DAVE4VM helicity estimate is 18% larger
than the PDFI case, beyond all error bars.

Unlike in the raw DAVE4VM energy and helicity estimates, the noise-related
error bars (indicated by the shaded regions around the curves in Figures 7 and
8, upper panels) are not completely insigniﬁcant for the inductive DAVE4VM
estimates, particularly in the case of helicity injection. For example, the relative
error in the 2.25-minute energy estimate is 2%, and the relative errors in the
2.25-minute and 2-hour helicity estimates are 13% and 27%, respectively.

Finally, we tested the eﬀect of rebinning the data for the lowest cadences (≥2
hours) also with the inductive DAVE4VM estimate. In energy injection curves
(see Supplementary Figure 17, upper panel) we ﬁnd consistent increases ∼20–
70% over all cadences, while the temporal trends remained the same. The eﬀect
of the rebinning on the helicity injection is, however, clearly more dramatic.
As illustrated by Supplementary ﬁgure 17, lower panel, the 2-, 6- and 12-hour
estimates change their sign in the rebinning yielding negative total injections at
the time of the X-class ﬂare. This result is problematic and likely spurious and
will be discussed more in detail in Section 4.2.

SOLA: paper_draft.tex; 24 May 2022; 0:25; p. 20

0.00.51.01.5Em(t) [1033 ergs]Em(t) 2.25-minEm(t) 11.25-minEm(t) 12-minEm(t) 2-hEm(t) 6-hEm(t) 24-hEm(t) 11.25-min  raw DAVE4VMEm(t) 11.25-minPDFI11121314151617Feb 20110.20.00.20.40.60.81.0dEm/dt [1028 ergs/s]dEm/dt 2.25-mindEm/dt 11.25-mindEm/dt 6-hdEm/dt 11.25-min  raw DAVE4VMdEm/dt 11.25-minPDFIInductive DAVE4VM full resolution energy injection and injection rate estimatesProbing the eﬀect of cadence

Figure 8. Same as Figure 7 but now the inductive DAVE4VM helicity injections HR(t) and
helicity injection rates dHR/dt estimates are plotted.

4. Discussion

In this section we discuss the ﬁndings made in Section 3, their reliability and
possible issues. We also compare our results to previous works and discuss some
general implications of our results.

4.1. Further testing of the error estimates

One central ﬁnding of our study of the energy and helicity injections in Section
3 was that the error bars arising from the noise in the magnetogram data were
very small, often <1%, which is clearly less than the errors of ∼10% reported
e.g. by Kazachenko et al. (2015). The small magnitude of the errors arises from
the error propagation in the time integration, where the errors of individual
injection rates (dEm/dt and dHR/dt) – which may be substantial (see Table 1)
– are summed up in quadrature, thus reducing the error in the total injections
N , where N is the number of times
(Em(t) and HR(t)) roughly by factor of
ti ≤ t in the time series.

√

Our error estimates have, however, signiﬁcant uncertainties. One particular
issue is the use of constant relative error estimates for the injection rates over
the entire time interval, derived for a single representative frame near Feb 14
01:48 UT. Although the frame was chosen carefully, so that AR 11158 has its
central magnetic structures already emerged at this time while the region is still
experiencing strong ﬂux emergence and energy and helicity injection, there is
no guarantee that the relative error estimate is accurate when used over the
entire analysis interval. Thus, to validate this approach we conducted further
Monte Carlo tests. Instead of studying a single frame in the time series, we

SOLA: paper_draft.tex; 24 May 2022; 0:25; p. 21

0.00.51.01.52.02.53.0HR(t) [1043 Mx2]HR(t) 2.25-minHR(t) 11.25-minHR(t) 12-minHR(t) 2-hHR(t) 6-hHR(t) 24-hHR(t) 11.25-min  raw DAVE4VMHR(t) 11.25-minPDFI11121314151617Feb 20110.00.51.01.52.0dHR/dt [1038 Mx2/s]dHR/dt 2.25-mindHR/dt 11.25-mindHR/dt 6-hdHR/dt 11.25-min  raw DAVE4VMdHR/dt 11.25-minPDFIInductive DAVE4VM full resolution helicity injection and injection rate estimatesLumme et al.

perturbed the magnetic ﬁeld data with the same Gaussian noise we used for the
representative frame (Section 2.6) at all times, and computed the total energy
and helicity injections for each Monte Carlo realization. Due to our large number
of 33 data series we, however, could not aﬀord to do as many realizations as for
the representative frame, and thus we lowered the number of realizations from
199 to 10 for the full resolution cases, and 20 for the rebinned, low cadence cases.
This small number of MC realizations makes the statistical uncertainty of these
additional error estimates very high, and thus the quantitative values retrieved
should be treated only as rough estimates. However, as illustrated below the
comparison between this additional MC test and the default error estimates still
presented a reasonable test for the default errors and revealed also interesting
systematic eﬀects.

Figure 9 compares the original unperturbed curve and its default error bars
(black curves, and shaded grey region around it) to the 10 Gaussian-perturbed
Monte Carlo (MC) realizations (blue curves) and their mean (orange curve) for
the 2.25-minute inductive DAVE4VM helicity injection estimate (panel a), and
for the 2.25-minute raw DAVE4VM energy injection estimate (panel b). Panel

Figure 9. Comparison between the unperturbed energy and helicity injection curves (black
curves), their default error bars (gray shaded region around the black curves), and the 10
perturbed Monte Carlo realizations (blue curves), and the mean over the Monte Carlo real-
izations (orange curve). We have plotted also the injection rates for the unperturbed case and
the MC mean (black/orange dashed curves). Panel a) shows the results for the 2.25-minute
inductive DAVE4VM estimate. Panel b) contains the 2.25-minute raw DAVE4VM energy
injection estimates, where the smaller panels, with equal y-axis height (in ergs), zooms into
the time of the X-class ﬂare on Feb 15 01:44 UT (vertical black dotted line) to better show the
very small (cid:46)1% default error bars (upper panel) and the spread of the MC realizations (lower
panel).

a) illustrates how the relative error estimate for the injection rate gets lowered
when the error is propagated from the injection rate to the time-integrated total
injection, the largest relative error of 170% in dHR/dt (Table 1) dropping to
13% in the total injection HR(tX-f lare). We also see that the 10 MC realizations
(blue curves) have a very similar spread around the mean of the MC realizations
(orange curve). The standard deviation of the MC realizations w.r.t. the mean
is 64% smaller than the standard deviation derived from our default error bars
at the time of the X-class ﬂare, corresponding to a relative error of 6% w.r.t the
MC mean. We get similar results for the raw DAVE4VM estimate in panel b),

SOLA: paper_draft.tex; 24 May 2022; 0:25; p. 22

Probing the eﬀect of cadence

though the error bars are signiﬁcantly smaller. As the injection curves for the
additional MC realizations have no signiﬁcant outliers, we assume that it is safe
to interpret the spread around the MC mean as an approximation of the true
error despite the large statistical uncertainty arising from the small number of
only 10 MC realizations.

We ﬁnd similar results as above also for all the other time series in our study:
the default error bars and the spread of the MC realizations are mostly very
similar, the absolute value of the latter varying between 10% to 370% of the
former with median of 60%.1

Despite diﬀerences between the MC spread and the default error we still ﬁnd
our default error bars performing reasonably well when their absolute values are
compared to the spread of the MC realizations around their mean, particularly
when considering the inherent uncertainties of the default error bars and the
large statistical uncertainty in the spread of the small number of additional MC
realizations.

However, we ﬁnd also signiﬁcant systematic diﬀerences between the MC real-
izations and the default estimate. This can be seen clearly in both Figures 9a and
b; the MC realizations produce consistently lower injections, 57% smaller for the
2.25-minute raw DAVE4VM energy injection estimate, and 19% smaller for the
2.25-minute inductive DAVE4VM helicity injection estimate at the time of the
X-class ﬂare. The consistency of the underestimation over all MC realizations
implies that this is not a spurious result arising from the small number of only
10 realizations. These kind of systematic changes are observed for all of our data
series, and they are mostly clearly beyond the noise-related error bars, and in
some cases (such as Figure 9) even beyond the method-related error bars of the
DAVE4VM and PDFI methods (see Section 3).

These consistent changes across the datasets show that all of our electric
ﬁeld inversion methods and consequently the energy and helicity injection es-
timates have systematic responses to the Gaussian perturbations of the input
magnetogram data, and that these systematic diﬀerences are of a signiﬁcant
nature. In addition to the (unspeciﬁed) method-related causes for the observed
systematic responses, also the Gaussian noise perturbations that we add to the
magnetograms (Section 2.6) may introduce biases themselves, mostly because
their width is constant in time and space, and chosen to overestimate all temporal
variations in the true noise levels in the magnetic ﬁeld components (see Figure 2
in Kazachenko et al., 2015). Consequently, when perturbing the magnetograms
with Gaussian noise, we actually increase the noise levels of the data. After
recognizing this, it is not a surprise to ﬁnd systematic eﬀects, particularly eﬀects
where part of the signal seems to be lost as in the Figures 9a and b. Clearly a
more comprehensive study on the eﬀect of the noise is required so that more

1In the case of the rebinned 12-hour raw DAVE4VM helicity injection estimate our default
error estimate failed completely, giving a relative error of 1100% for the injection rate, which
then propagated to the helicity injection giving a relative error (cid:38)100%. This spurious result
arises from the very small helicity injection at the representative frame for this particular
series, which makes the µ in Eq. 14 small, and thus the ¯σdHR/dt unrealistically large. Due
to this issue error bars are omitted from the 12-hour rebinned helicity injection estimate in
Figure 6, lower panel.

SOLA: paper_draft.tex; 24 May 2022; 0:25; p. 23

Lumme et al.

realistic and time-dependent magnitudes for the perturbations are used with
larger number of MC realizations than what used here. Until the cause behind
these systematic eﬀects is unraveled, care should be taken when deriving energy
and helicity injection estimates from input datasets with variable noise levels,
as the noise may have signiﬁcant systematic eﬀects on the result.

Since the systematic eﬀects in the injections only separate the unperturbed
cases (black curves in Figure 9) from the 10–20 perturbed MC realizations (blue
curves in Figure 9), they do not negate our original ﬁnding that the error prop-
agated into the total time-integrated injections is small, which was recovered
both for the unperturbed estimate with its default error bar and for the spread
of the MC realizations around their mean. The following conclusion that the
noise-related variations in the total injections are actually often very small (<1%
for the 12-minute estimates, which are most consistent with previous studies)
clearly puts a stronger emphasis on other sources of uncertainties when com-
paring diﬀerent results. These include the method-related errors within PDFI
and DAVE4VM (Kazachenko, Fisher, and Welsch, 2014; Schuck, 2008) already
discussed in Section 3 as well as the eﬀects of data processing such as Doppler-
gram calibration (the eﬀect of which was shown to be signiﬁcant by Kazachenko,
Fisher, and Welsch, 2014) as well as tracking speed of the active region, noise
masking threshold and the azimuth disambiguation in the magnetograms (which
all were shown to produce signiﬁcant eﬀects by Lumme, Pomoell, and Kilpua,
2017).

4.2. Inductive and non-inductive contributions to the energy and

helicity injections

Recently, there have been active discussions on the importance of the non-
inductive electric ﬁeld, and many studies highlight its crucial role in realistically
producing magnetic helicity and energy injections, and the related eruptive
activity in the corona (Cheung and DeRosa, 2012; Kazachenko, Fisher, and
Welsch, 2014; Mackay, DeVore, and Antiochos, 2014; Lumme, Pomoell, and
Kilpua, 2017; Pomoell, Lumme, and Kilpua, 2019). In this section we quan-
tify the mutual importance of the inductive (constrained by Faraday’s law and
input magnetograms) and non-inductive contributions (constrained by velocity
estimates and Ohm’s law) in our injection estimates.

Figures 10 and 11, upper panels, illustrate the signiﬁcance of the 11.25-minute
inductive electric ﬁeld contribution to the energy and helicity injections (yellow
curves) with the full PDFI estimate (black curves) and inductive DAVE4VM
estimate (purple curves). First, we notice that the inductive contribution is
signiﬁcant for both inductive DAVE4VM and PDFI energy injection estimates.
At the time of the X-class ﬂare the inductive contribution is 60% of the former
and 74% of the latter. The diﬀerence between the inductive contribution and the
total PDFI energy injection is almost within the maximal method-related error
bars of the method (25%, see Section 3.1). The large inductive contribution
in the PDFI estimate for NOAA AR 11158 is in contrast with the results of
Kazachenko, Fisher, and Welsch (2014), who found that the inductive component
produced only 40% of the total PDFI energy injection rate in the ANMHD

SOLA: paper_draft.tex; 24 May 2022; 0:25; p. 24

Probing the eﬀect of cadence

synthetic data test. This highlights the diﬀerences between the properties of the
NOAA active region 11158 and the active-region-like system in the ANMHD
data, and illustrates the need for testing the electric ﬁeld inversion methods in
other cases beside these two.

Figure 10. Energy injection Em(t) (upper panel) and injection rate dEm/dt (lower panel)
for the high-cadence 2.25- and 11.25-minute cases derived only from the inductive electric
ﬁeld component, as well as the 11.25-minute estimates derived using the PDFI, inductive
DAVE4VM and PFI (PDFI estimate without the Dopplergram contribution) methods. Com-
bined method- and noise-related error estimates are plotted for the 11.25-minute PDFI estimate
(black curve) at the time of the X-class ﬂare (vertical black dashed dotted line).

When it comes to the helicity injection (Figure 11, upper panel), the inductive
component has a signiﬁcantly smaller contribution compared to the energy in-
jection: at the time of the X-class ﬂare the inductive component constitutes only
22% and 26% of the 11.25-minute inductive DAVE4VM and PDFI estimates,
respectively. Again our results are in contrast to Kazachenko, Fisher, and Welsch
(2014), who found the inductive contribution in the helicity injection rate of the
ANMHD test to be 55%, twice larger than in our case.

Since the inductive contribution constitutes only 20–60% of the injections for
the inductive DAVE4VM method, the non-inductive component extracted from
the raw DAVE4VM electric ﬁeld clearly introduces signiﬁcant contributions (40–
80%). This result is not directly obvious due to the fact that the method is based
on ﬁnding a solution that is as inductive as possible.

We plot the inductive contribution for both the 2.25- and 11.25-minute input
data in Figures 10 and 11 (blue and yellow curves) to illustrate that increasing
the cadence from 11.25 minutes to the highest 2.25-minute case has a very small
eﬀect ((cid:46)6%) on both injections. Since increasing the cadence from 11.25 to 2.25
minutes does not cause any signiﬁcant changes in the inductive energy injection,
the large increase in the DAVE4VM-based energy injection estimates between

SOLA: paper_draft.tex; 24 May 2022; 0:25; p. 25

0.000.250.500.751.001.251.50Em(t) [1033 ergs]Em(t) 2.25-min ind. onlyEm(t) 11.25-min ind. onlyEm(t) 11.25-min inductive DAVEVMEm(t) 11.25-min PFIEm(t) 11.25-minPDFI11121314151617Feb 20110.250.000.250.500.75dEm/dt [1028 ergs/s]dEm/dt 2.25-min ind. onlydEm/dt 11.25-min ind. onlydEm/dt 11.25-min inductive DAVEVMdEm/dt 11.25-min PFIdEm/dt 11.25-minPDFILumme et al.

Figure 11. Same as Figure 10, but now the role of the inductive component in the helicity
injections HR(t) and injection rates dHR/dt is illustrated.

the 11.25- and 2.25-minute cadences (Figures 4 and 7, upper panels) must arise
from contributions external to the inductive electric ﬁeld. These contributions
can be divided in two using a 2-dimensional Helmholtz decomposition of the
the horizontal electric ﬁeld (similar to Eq. 7 of Schuck, 2008) (the vertical, z
component of the electric ﬁeld does not contribute to the injections):

Eh = −∇φ × ˆz − ∇hψ = −∇ × φ ˆz − ∇hψ

(17)

We can immediately see that the curl-free part −∇hψ of this decomposition
corresponds to the horizontal components of the non-inductive electric ﬁeld
from Eq. 7. The divergence-free part −∇ × φ ˆz, on the other hand, deﬁnes the
inductivity properties of the electric ﬁeld in the z direction:

(∇ × E) · ˆz = (∇ × Eh) · ˆz = − [∇ × (∇ × φ ˆz)] · ˆz = ∇2

hφ

(cid:18)

= −

(cid:19)

∂Bz
∂t

, (18)

where the last equality is fulﬁlled only if the electric ﬁeld is perfectly inductive.
This is the case for the PDFI and inductive DAVE4VM estimates (Eqs. 7 and
11), for which the divergence-free part corresponds to the horizontal inductive
electric ﬁeld −∇ × φ ˆz = Eh
I . However, since the raw DAVE4VM estimate is
poorly inductive (as discussed already in Section 2.4.2 and as indicated by the
metrics in Appendix B, Table 2), the divergence-free component of the horizontal
raw DAVE4VM electric ﬁeld −∇×φ ˆz is diﬀerent from the inductive electric ﬁeld
and does not fulﬁll the normal component of Faraday’s law in Eq. 18.

Now we can compare the energy injection estimates derived from the divergence-

and curl-free parts of the horizontal DAVE4VM-based electric ﬁelds and how
they respond to variable cadence. First, the horizontal inductive electric ﬁeld

SOLA: paper_draft.tex; 24 May 2022; 0:25; p. 26

0.00.51.01.52.02.5HR(t) [1043 Mx2]HR(t) 2.25-min ind. onlyHR(t) 11.25-min ind. onlyHR(t) 11.25-min inductive DAVEVMHR(t) 11.25-min PFIHR(t) 11.25-minPDFI11121314151617Feb 20111.51.00.50.00.51.01.5dHR/dt [1038 Mx2/s]dHR/dt 2.25-min ind. onlydHR/dt 11.25-min ind. onlydHR/dt 11.25-min inductive DAVEVMdHR/dt 11.25-min PFIdHR/dt 11.25-minPDFIProbing the eﬀect of cadence

Eh
I , which is also the divergence-free part of the inductive DAVE4VM electric
ﬁeld in Eq. 17, produces only a minimal increase between the 11.25- and 2.25-
minute estimates (3%, 2.2 × 1031 ergs, at the time of the X-class ﬂare). Since the
2.25-minute inductive DAVE4VM estimate is 16% (1.8 × 1032 ergs) larger than
the 11.25-minute case, almost all of this (90%, 1.6 × 1032 ergs) must arise from
the curl-free, non-inductive part of the inductive DAVE4VM electric ﬁeld −∇hψ
(see Eq. 11). The horizontal raw DAVE4VM electric ﬁeld contains the same curl-
free part as the inductive DAVE4VM estimate −∇hψ, but the divergence-free
part −∇×φ ˆz is diﬀerent and poorly inductive. The 2.25-minute raw DAVE4VM
energy injection estimate is 52% (4.8 × 1032 ergs) larger than the 11.25-minute
case. This means that the curl- and divergence-free parts together introduce
4.8 × 1032 ergs diﬀerence between the 2.25- and 11.25-minute raw DAVE4VM
energy injections, whereas the curl-free part alone introduces an increase of
roughly 1.6 × 1032 ergs. The divergence-free part is thus responsible for most
((4.8 − 1.6 = 3.2) × 1032 ergs, 66%) of the diﬀerence. The increase from the curl-
free, non-inductive component alone (1.6×1032 ergs) would already be within the
combined method- and noise-related error of the 11.25-minute raw DAVE4VM
estimate (which is 2.2 × 1032 ergs, ∼24%), making the 2.25- and 11.25-minute
estimates consistent within these uncertainties. As indicated by Table 2 in Ap-
pendix B the divergence-free part of the 2.25-minute raw DAVE4VM electric
ﬁeld is clearly less inductive than that of the 11.25-minute case, which means
that the divergence-free component of the 2.25-minute raw DAVE4VM electric
ﬁeld is clearly diﬀerent from that of the 11.25-minute case. Thus, it is not a
surprise that these produce diﬀerent energy injections.

In conclusion, this analysis shows that the majority of the observed dif-
ference between the 2.25- and 11.25-minute raw DAVE4VM energy injection
estimates arises from the divergence-free part of the raw DAVE4VM electric
ﬁeld and its variable inductivity properties. The reason why the induction equa-
tion/Faraday’s law is fulﬁlled only in least-squares sense in DAVE4VM is that
when ensuring perfect inductivity, also the changes related to the noise are
reproduced, which is deemed undesirable (Schuck, 2008, see also Section 2.4.2).
However, nothing guarantees that the electric ﬁeld derived from such an approx-
imate reproduction of Faraday’s law would evolve the magnetic ﬁeld in a “mean
ﬁeld sense” so that the large scale evolution is reproduced without undesirable
noise-related evolution. Instead, the poorly inductive raw DAVE4VM electric
ﬁeld evolves the magnetic ﬁeld further and further away from the actual obser-
vations over time. Thus, we conclude that the changes in the energy injection
introduced by variable inductivity between the cadences have little physically
justiﬁable basis and arise only from the speciﬁc formulation of the method.
Consequently, we recommend ensuring the inductivity of the method not only
when using DAVE4VM-based electric ﬁelds to drive coronal simulations (as
noted already by Schuck, 2008), but also when deriving the evolutionary energy
and helicity injection estimates from the DAVE4VM electric ﬁelds. This has
not been taken into account in previous evolutionary estimates derived from
DAVE4VM velocities (e.g. Liu and Schuck, 2012; Tziotziou, Georgoulis, and
Liu, 2013; Liu et al., 2016b; Lumme, Pomoell, and Kilpua, 2017; Bi et al., 2018).

SOLA: paper_draft.tex; 24 May 2022; 0:25; p. 27

Lumme et al.

Another DAVE4VM-related ﬁnding we made in Section 3 was that the 15-
times rebinned low-cadence inductive DAVE4VM estimates produced negative
total helicity injection for NOAA AR 11158 at the time of the X-class ﬂare (Sup-
plementary Figure 17, lower panel), which is in contrast with all studies of the
active region (see Kazachenko et al., 2015, for review). As the helicity injection
estimates derived only from the inductive electric ﬁeld component were consis-
tently positive, this signal must arise from the non-inductive, DAVE4VM-based
contribution. As we could not isolate any problematic structures in the elec-
tric ﬁeld or helicity ﬂux density maps (see https://zenodo.org/record/2541961),
we conclude that the issue simply appears to be inherent to the inductive
DAVE4VM estimate. It may arise from the DAVE4VM velocity inversion and/or
from our method of extracting the non-inductive contribution from this data,
combined with the loss of information in spatial rebinning and lowering the
cadence. One particular issue in the inductive DAVE4VM estimate is that even
though the raw DAVE4VM electric ﬁeld fulﬁlls the property E · B = 0 of the
ideal Ohm’s law exactly, the inductive DAVE4VM electric ﬁeld does not.

Finally, we have also plotted a modiﬁed version of the PDFI estimate, the PFI
(PTD-FLCT-Ideal) estimate to Figures 10 and 11 (purple curves), which lacks
the contribution from Dopplergrams. We can see that this estimate has similar
trends in energy and helicity injections as the PDFI estimate until Feb 16 ∼00:00,
after which the PFI method continues to produce mostly positive injection rates,
whereas the PDFI injection rate becomes negative. This comparison reveals the
Dopplergram contribution to be the main cause of the negative helicity injection
rate after Feb 16 00:00. The Dopplergram contribution is also a likely reason
for the diﬀerences between the DAVE4VM-based and PDFI helicity injection
estimates (Figure 5), as the former do not include the Dopplergram data.

The signiﬁcant diﬀerence in the sign of the helicity injection after Feb 16 00:00
between PDFI and DAVE4VM-based estimates provides another strong distin-
guishing test for the methods. If the strong negative helicity injection rate of the
PDFI method is realistic, this would directly imply that the lack of Dopplergram
contribution in DAVE4VM is a serious issue, and the method should be updated
to include Dopplergrams (see Schuck, 2012, for work towards this direction). If
the negative injection rate is unphysical, this on the other hand, would indicate
an overemphasis or problematic formulation of the Dopplergram contribution
in the PDFI method. The Dopplergram contribution is likely overemphasized
in the emergence-driven ANMHD test used for validating and optimizing the
PDFI method (Kazachenko, Fisher, and Welsch, 2014, see also Introduction,
Section 1). Moreover, Liu et al. (2014) reported that in a set of 28 active regions
all had dominant helicity injection arising from the shear component (i.e. the
horizontal component of the DAVE4VM velocity), not the vertical emergence,
which we also reproduce for AR 11158. However, this result is derived using
the raw DAVE4VM method, and without the Dopplergram contribution. The
Dopplergram contribution in the PDFI method might be also contaminated by
the horizontal penumbral Evershed ﬂows. As these ﬂows are thought to ﬂow
mostly parallel to the magnetic ﬁeld (e.g. Borrero and Ichimoto, 2011), they
should produce no electric ﬁeld contribution in ideal Ohm’s law, but they still
can produce non-zero contribution to the Dopplergram electric ﬁeld in the PDFI

SOLA: paper_draft.tex; 24 May 2022; 0:25; p. 28

Probing the eﬀect of cadence

method. The contamination appears when the AR 11158 moves far from the disk
center (central meridian passage on Feb 14 ∼02:00 UT) where the Dopplergram
velocity VLOS becomes increasingly horizontal. Consequently, the Evershed ﬂow
contamination presents a possible reason for the strong negative helicity injection
rate in the PDFI estimates Feb 16 00:00 UT onward. An alternative version of the
PDFI method which attempts to remove the Evershed ﬂow contamination in the
Dopplergram electric ﬁeld contribution has been developed (Fisher et al., 2019),
and the signal of the negative helicity injection rate has indeed disappeared in
the preliminary tests of this method. However, the alternative method performs
worse than the original one in the synthetic ANMHD tests, and produces also
problematic artifacts when applied to observational data. Thus, the approach
still requires further development and testing.

All in all, further tests with real and synthetic data are required for both
PDFI and DAVE4VM methods to better understand and constrain the issues
of the methods discussed above as well as the mutual discrepancies such as the
opposite signs of the helicity injection rates.

4.3. General discussion

To the best of our knowledge, the eﬀect of cadence on the photospheric total
energy and helicity injections has not been studied before using real observational
input. However, there are certain simulations studies relevant for our work. For
example, Leake, Linton, and Schuck (2017) studied how well the SDO/HMI
cadence of 12 minutes is capable of capturing an idealized ﬂux emergence process
in a coronal simulation driven by photospheric data. They varied the eﬀective
cadence by changing the emergence rate and compared their data-driven sim-
ulation to a ground-truth run of the emergence process, in which the whole
emergence from the upper convection zone to the corona was captured. Most
of their simulations (7 out of 9) followed a clear trend where increasing the
eﬀective cadence produced larger total and free energy budgets in the simulation
and producing smaller errors w.r.t. the ground-truth run. This is similar to our
results that show increasing or roughly constant energy injections with increasing
cadence.

Two of 9 simulations of Leake, Linton, and Schuck (2017) produced exceptions
to the trend above resulting in signiﬁcant overestimation of the free and also the
total energy budgets in the simulations (J. Leake, 2019, private communication),
when compared to the ground-truth run. They attributed this result to arise
from the undersampling of very rapidly evolving photospheric magnetic features
(Vh ∼ 20 km s−1 in one of these simulations), which introduced spurious currents
to the coronal volume, thus increasing the free and total energy budgets. We
mostly did not ﬁnd any dramatic increases in our total energy injection estimates
(except for the 50% increase between the 2.25- and 11.25-minute raw DAVE4VM
estimates, which we however, interpreted as a method-related eﬀect, see Section
4.2). This is not surprise as we did not detect nearly as high horizontal velocities
as in the problematic simulations of Leake, Linton, and Schuck (2017), our
velocity estimates being typically <1 km s−1. However, one should note that
direct comparison between our results and the ﬁndings of Leake, Linton, and

SOLA: paper_draft.tex; 24 May 2022; 0:25; p. 29

Lumme et al.

Schuck (2017) is problematic due to the vast diﬀerences in the active regions
settings (idealized emergence simulations vs. real observations) as well as the
fact that the photospheric injections cannot be compared directly to the coronal
budgets. The latter arises both from the fact that injected photospheric energy
and helicity may be ejected from the computational domain as well as from the
limitations set by the mathematical formulation of the photospheric boundary
condition (see e.g. Kazachenko et al., 2015; Pomoell, Lumme, and Kilpua, 2019,
for further discussion).

Another simulation study relevant to our work was done by Weinzierl et al.
(2016), who ran a series of global, data-driven magnetofrictional simulations
for a reasonably active corona. They used synoptic Br magnetograms from Air
Force Data Assimilative Photospheric Flux Transport (ADAPT) model as input,
estimated the inductive electric ﬁeld consistent with Br evolution and the non-
inductive electric ﬁeld consistent with the large-scale velocity ﬁeld related to the
solar diﬀerential rotation, and drove the simulation using this total electric ﬁeld.
They varied the cadence of the input ADAPT maps between 2 and 48 hours, and
compared the eﬀect of driving cadence to the output of the simulations. They
reported reasonably consistent results for the cadences of 2 and 6 hours, lower
cadences producing notable diﬀerences between the simulations. We found the
PDFI injection estimates to be consistent within the uncertainties in a cadence
range from 2.25 minutes to 2 hours. Our 2-hour limit is smaller but still of similar
order of magnitude as the 6-hour limit of Weinzierl et al. (2016).

The consistency of our results in a certain cadence range, and the similar
ﬁndings made by Weinzierl et al. (2016), have interesting implications on the
relevant time scales. The fact that our PDFI energy and helicity injections are
consistent (within uncertainties) in the range from 2 minutes to 2 hours imply
that the photospheric processes (e.g. ﬂux emergence, cancellation, shearing mo-
tions) acting on shorter time scales than that of 2 hours contribute very little
to our estimates. This may arise from the actual small role of these processes,
or alternatively from the fact that the detection of these processes is below the
sensitivity of the SDO/HMI input data and our implementation of the PDFI
electric ﬁeld inversion scheme. One issue that may degrade the sensitivity of the
PDFI method is the fact that its perfectly inductive electric ﬁeld reproduces
all magnetogram noise in ∂B/∂t in Faraday’s law, unlike the raw DAVE4VM
electric ﬁeld that has been designed to reproduce the ∂B/∂t only in a least
squares sense (which, however, produced other issues detailed in Section 4.2).
The consistency in the range from 2 minutes to 2 hours implies also that the
novel high-cadence 2.25-minute SDO/HMI data brings little new features to
the PDFI injection estimates when compared against the nominal 12-minute
cadence, which on our study is represented by the mock nominal cadence of 11.25
minutes. Further studies are required to ascertain whether this consistency over
various cadences can be reproduced also in the context of data-driven simulations
similarly to Weinzierl et al. (2016).

SOLA: paper_draft.tex; 24 May 2022; 0:25; p. 30

Probing the eﬀect of cadence

5. Summary and conclusions

In this article we performed an extensive study on the eﬀect of input data cadence
on the total photospheric energy and helicity injections, derived from the electric
ﬁeld inversion results of three state-of-the-art methods, the PDFI method, and
two methods based on the DAVE4VM velocity inversion approach. The ﬁrst, the
raw DAVE4VM method, follows previous works (e.g. Liu and Schuck, 2012) and
derives the electric ﬁeld directly from the output velocity using ideal Ohm’s law,
whereas the second, the novel inductive DAVE4VM estimate, includes only the
horizontal curl-free (non-inductive) part of the raw DAVE4VM ﬁeld, combined
with the inductive ﬁeld component from the PDFI electric ﬁeld.

We produced 6 input magnetogram and Dopplergram data series for eruptive
active region NOAA AR 11158 by sampling the novel 2.25-minute high-cadence
SDO/HMI data (Sun et al., 2017) with cadence varying from 2.25 minutes to
24 hours. We also created one dataset from the nominal 12-minute SDO/HMI
data (Hoeksema et al., 2014), as well as additional 4 data series of cadences
2–24 hours where the data was rebinned by a factor of 15 to constrain the
eﬀect of undersampling the typical photospheric motions at these low cadences.
We optimized the FLCT and DAVE4VM optical ﬂow velocity inversion for each
cadence and spatial resolution, inverted the electric ﬁeld using our three methods
and estimated the respective energy and helicity injections. We also derived error
bars for the energy and helicity injections using a Monte Carlo approach and
the noise characteristics of the input magnetograms.

The errors arising from the magnetogram noise in the total time-integrated
injection estimates were often very small (<1%), in contrast to the previously
reported values (∼10%), which emphasizes the larger uncertainties arising from
the inversion methods and data processing. All injection estimates also produced
systematic responses when the input magnetograms were manually perturbed
with noise, which highlights the need for further tests on the noise response of
the methods in controlled environments and using larger number of Monte Carlo
statistics than used in this work. Moreover, care should be taken when comparing
the injection estimates from data products with variable noise characteristics.

Our three electric ﬁeld inversion methods produced consistent energy injection
estimates at the time of the strongest (X-class) ﬂare of NOAA AR 11158 for the
nominal 12-minute HMI cadence (similarly to Kazachenko et al., 2015), but
for helicity injections the methods diﬀered signiﬁcantly, slightly at the time of
the ﬂare, and increasingly after the ﬂare. The two DAVE4VM-based methods
and PDFI method even gave opposite signs for the helicity injection rate after
the ﬂare, and we showed that this diﬀerence arises from the Dopplergram con-
tribution in the PDFI method, a contribution not included in the DAVE4VM
estimates. This unresolved discrepancy highlights the need for further synthetic
tests for both the PDFI and DAVE4VM methods in more realistic settings than
oﬀered by the previously employed ANMHD-based tests.

The injection estimates based on the PDFI electric ﬁeld inversion method
turned out to be the most robust against variable cadence, as the cadences from
2.25 minutes to 2.025 hours produced all energy and helicity injections consistent
within the uncertainties at the time of the strongest X-class ﬂare of NOAA AR

SOLA: paper_draft.tex; 24 May 2022; 0:25; p. 31

Lumme et al.

11158. This result suggests that the PDFI method can be used ﬂexibly with data
products of variable cadence from other instruments beside SDO/HMI (see Lagg
et al., 2017, for a review), but also with the SDO/HMI data in the case of data
gaps, or when lowering the cadence in pursuit of saving computational resources.
This result also implies that the photospheric processes (e.g. ﬂux emergence,
cancellation and shearing motions) acting on time scales below 2 hours contribute
little to the energy and helicity injections, or alternatively that the detection of
these contributions is below the sensitivity of the SDO/HMI instrument and/or
our implementation of the PDFI electric ﬁeld inversion scheme. Furthermore, this
result implies that the novel high-cadence 2.25-minute SDO/HMI data brings
little new features to the total injections when compared against the nominal
12-minute cadence (in NOAA AR 11158).

The injection estimates based on the raw DAVE4VM estimates turned out to
be very sensitive to cadence: already the 2.25- and 11.25-minute cases diﬀered
signiﬁcantly, particularly in the total energy injection where the 2.25-minute
input produced roughly 50% larger injection. For the lowest cadences (≥2 h)
the raw injection estimates lost the injection signal altogether producing zero or
negligibly small injections.

The inductive DAVE4VM estimate turned out to remedy most of the large
diﬀerence between the 2.25- and 11.25-minute raw DAVE4VM energy injection
estimates proving that the diﬀerence arises mostly from the poor and variable
inductivity of the raw DAVE4VM electric ﬁeld estimate. Based on this ﬁnding,
we recommend correcting for the inductivity when deriving the evolutionary
energy and helicity injection estimates from the DAVE4VM electric ﬁelds, a
correction not included in the previous studies employing the method. The loss
of the raw DAVE4VM injection signal for the lowest cadences (≥2 h) was also
visible in the inductive DAVE4VM estimate, for which the injections were clearly
non-zero, but arose is most cases predominantly from the inductive component
of the electric ﬁeld, and still clearly underestimated the high-cadence estimates.
The correction of the severe undersampling for the lowest cadences (≥2 h)
by rebinning the input data by a factor 15, clearly improved only the raw
DAVE4VM injection estimates, rebinned input data producing about half of
the 11.25-minute raw DAVE4VM reference estimates at the time of the X-class
ﬂare in NOAA AR 11158. On the other hand, rebinned input only degraded the
inductive DAVE4VM and PDFI estimates producing spurious negative helicity
injection results for the former and signiﬁcant (up to 90%) loss of helicity signal
for the latter.

We mostly did not ﬁnd dramatic increases in the total energy injections for any
the cadences or electric ﬁeld inversion methods, but instead found the energy
injections to decrease as a function of decreasing cadence. As this holds also
when our input data clearly undersamples typical photospheric motions, we can
conclude that our results show no evidence for any spurious energy injections
arising from the undersampling of the photospheric motions, such as the ones
detected by Leake, Linton, and Schuck (2017).

Though most of the very low-cadence (≥6 h) estimates considered in this
study clearly underestimated the injections, we still ﬁnd that estimates, such as
the low-cadence full resolution PDFI estimates, and 15-times rebinned DAVE4VM

SOLA: paper_draft.tex; 24 May 2022; 0:25; p. 32

Probing the eﬀect of cadence

estimates, are capable of approximating temporal trends of the high-cadence
reference estimates reasonably well, and even giving crude (under)estimates of
the absolute values. For example, the 12-hour full resolution PDFI estimate
produced 50% and 74% of the 11.25-minute reference energy and helicity injec-
tions at the time of the X-class ﬂare. This implies that even this low cadences
are capable of capturing some of the large scale evolution in the NOAA AR
11158 (possibly related to the fact that signiﬁcant changes in the magnetic ﬁeld
structure of active regions occur over a time scale of several hours, Fisher et al.,
1998; Metcalf, 1994; Pevtsov, Canﬁeld, and Metcalf, 1994).

Movies of all the magnetogram, Dopplergram, optical ﬂow, electric ﬁeld as
well energy and helicity ﬂux maps for all of our data series can be found from
https://zenodo.org/record/2541961.

Acknowledgments All of the data download, magnetogram/Dopplergram processing steps,
FLCT velocity inversion, and PDFI electric-ﬁeld inversion are handled using the ELECTRIC
ﬁeld Inversion Toolkit, ELECTRICIT software (Lumme, Pomoell, and Kilpua, 2017). When
it comes to the Dopplergram calibration, FLCT velocity inversion and PDFI electric-ﬁeld
inversion, the toolkit acts as a wrapper for a Fortran Dopplergram calibration library by
B. T. Welsch, the FLCT code v1.06 (http://solarmuri.ssl.berkeley.edu/∼ﬁsher/public/software/
FLCT/) and the PDFI SS software (http://cgem.ssl.berkeley.edu/cgi-bin/cgem/PDFI SS). We
used the latest public version of the DAVE4VM code (https://ccmc.gsfc.nasa.gov/lwsrepository/
index.php), which was executed outside ELECTRICIT using Interactive Data Language (IDL)
scripts based on the work by Schuck (2008). This research has made use of SunPy, an open-
source and free community-developed solar data analysis package written in Python (Mumford
et al., 2015). We thank the HMI team for providing us with the vector magnetic-ﬁeld and
Dopplergram data.

E. Lumme acknowledges the doctoral program in particle physics and universe sciences
(PAPU) of the University of Helsinki, and Emil Aaltonen Foundation for ﬁnancial support. E.
Lumme, J. Pomoell and E.K.J. Kilpua acknowledge the SolMAG project (ERC-COG 724391)
funded by the European Research Council (ERC) in the framework of the Horizon 2020
Research and Innovation Programme, and the Finnish Centre of Excellence in Research of
Sustainable Space (Academy of Finland grant number 1312390). M.D. Kazachenko acknowl-
edges National Science Foundation, SHINE, AGS 1622495 award. M.D. Kazachenko, G.H.
Fisher, and B.T. Welsch acknowledge the Coronal Global Evolutionary Model (CGEM) award
by the joint NSF-National Space Weather Program / NASA-LWS Strategic Capability program
under award NSF AGS 1321474. This award supported also the development of the Doppler
and PDFI SS packages. B.T. Welsch acknowledges support from the NASA-LWS Targeted
Research & Technology under award 80NSSC19K0072.

This is a pre-print of an article published in Solar Physics. The ﬁnal authenticated version

is available online at: https://doi.org/10.1007/s11207-019-1475-x.

Appendix

A. Technical details related to the velocity and electric ﬁeld

inversions

This section discusses the technical details related to the temporal and spatial
discretization of the velocity and electric ﬁeld inversion, as well as the updates
made to the PDFI method after the description of Kazachenko, Fisher, and
Welsch (2014) and how we employ the updated version.

SOLA: paper_draft.tex; 24 May 2022; 0:25; p. 33

Lumme et al.

A.1. Time discretization in the velocity and electric ﬁeld inversions

When specifying the input data for the FLCT and DAVE4VM velocity inversions
we employ a central diﬀerence scheme where magnetograms at times t and t ±
∆t are used to estimate the velocity at time t so that the time derivatives
∂Bz/∂t and ∂B/∂t are both estimated using from B(t ± ∆t) using a central
diﬀerence scheme, and the spatial derivatives ∂lBm (l ∈ {x, y} and m ∈ {x, y, z})
required for DAVE4VM are computed from the central magnetogram B(t) at
time t (using 5-point optimized derivatives, J¨ahne, 2004; Schuck, 2008; Liu and
Schuck, 2012). The central diﬀerence scheme that employs three magnetograms
at t and t ± ∆t is preferred because it minimizes the eﬀect of correlated noise
between the estimates of temporal and spatial derivatives (Welsch et al., 2007;
Ferm¨uller, Shulman, and Aloimonos, 2001), and improves also the ﬁnal electric
ﬁeld estimates through the “staggered-in-time” approach as explained below.

As opposed to the velocity inversion, we employ a diﬀerent time discretization
in the electric ﬁeld inversion, which we refer to as “staggered-in-time” approach
(see also Fisher et al., 2019). Essentially, we use consecutive magnetograms at
time t and t + ∆t to estimate ∂B/∂t(t + 1/2∆t) at time t + 1/2∆t as follows:

∂B
∂t

(t + 1/2∆t) =

B (t + ∆t) − B(t)
∆t

,

(19)

where ∆t is the cadence of the input data series. Since the time derivative is
estimated at time t+1/2∆t, the electric ﬁeld inversion must be done at the same
temporal position, which requires (linear) interpolation (i.e. averaging of two
consecutive frames) of all required quantities (B, VLOS, V F LCT
, VDAV E4V M )
to this same position before doing the inversion. This approach is beneﬁcial as
it oﬀers simplicity for the physical interpretation of the electric ﬁeld: a perfectly
inductive electric ﬁeld E(t + 1/2∆t) drives the magnetic ﬁeld exactly from ob-
served value B(t) to the next B(t + ∆t), which does not happen for a standard
central diﬀerence discretization. Moreover, the approach partly mitigates some
of the issues caused by the noise, and the eﬀect of other artefacts such as the
spurious velocity spikes of the FLCT inversion (Appendix A.2).

h

On the other hand, this choice of discretization, combined with the central
diﬀerence scheme used in the velocity inversion means that E(t +1/2∆t) at time
t+1/2∆t depends on the input magnetograms ranging from t−∆t, t+2∆t where
the most distant magnetograms are included via the central diﬀerence scheme of
the optical ﬂow estimates. Therefore, when considering electric ﬁeld of cadence
∆t some of the input data is actually collected from an interval of length 3∆t.

A.2. Masking in the velocity and electric ﬁeld inversion

In order to remove the noise-dominated pixels from the output we employ a
noise threshold of |B| = 300 Mx cm−2 both in the DAVE4VM and FLCT ve-
locity inversions. However, as explained by Lumme, Pomoell, and Kilpua (2017)
the input to DAVE4VM cannot be masked, and therefore the masking of the
DAVE4VM estimates is performed post facto when computing the electric ﬁeld
(see below). For FLCT we employ the masking functionality implemented into

SOLA: paper_draft.tex; 24 May 2022; 0:25; p. 34

Probing the eﬀect of cadence

the method itself by setting the thr parameter to 300 Mx cm−2, in which case
pixels where |Bz(t1) + Bz(t2)|/2 < thr are excluded from the analysis and the
output velocity is set to zero (Fisher and Welsch, 2008). This choice produces
a stronger masking condition for the FLCT inversion than the |B| = 300 Mx
cm−2 threshold. We ﬁnd this, however, beneﬁcial due to the sensitivity of the
FLCT to noise, resulting for example in a larger number of spurious velocity
spikes (where velocity gets unreasonably high |Vh| > 2 km s−1) with the lower
choices of thr value.

When it comes to masking the noise-dominated pixels of the input data in
the electric ﬁeld inversion, we follow mostly the approach of Kazachenko et al.
(2015) modiﬁed to the updated spatial (Appendix A.3) and temporal (Section
A.1) discretization of the inversion procedures (see also Fisher et al., 2019).
For masking the magnetic ﬁeld input data we use a ﬁxed masking threshold of
|B| = 300 Mx cm−2, which is employed consistently with the staggered-in-time
temporal discretization. This means that the magnetic ﬁeld input B(t + 1/2∆t),
∂B/∂t(t + 1/2∆t) for the electric ﬁeld inversion at t + 1/2∆t is masked in pixels
where either of the magnetograms participating in the inversion B(t), B(t + ∆t)
is below the threshold. Since in the PDFI method the input magnetic ﬁeld data
is interpolated to staggered grid positions (following the spatial discretization
presented in Appendix A.3) the mask is interpolated consistently so that the
fractional values that arise from the interpolation of the {0, 1} mask are rounded
up in the process. Except for the independent masking of the FLCT method (see
Section 2.3) other input data are not masked in any way, since the masking of
the magnetic ﬁeld data handles this implicitly in the application of the ideal
Ohm’s law.

A.3. Use of the PDFI SS software in this study

We use the public version of the PDFI SS (“PDFI Spherical Staggered”) soft-
ware downloaded from http://cgem.ssl.berkeley.edu/cgi-bin/cgem/PDFI SS/index
on Aug 30, 2018 16:43 GMT. The software has several diﬀerences to the PDFI
version described in the latest publication by Kazachenko, Fisher, and Welsch
(2014). The diﬀerences are presented in detail by Fisher et al. (2019), but we
also brieﬂy summarize them below:

•

Instead of Cartesian geometry spherical coordinates are used consistently
throughout the electric ﬁeld inversion.

• All vectors are given in a local spherical basis (er, eθ, eφ) corresponding to
spherical coordinates on the surface of the Sun (R(cid:12), θ, φ). We employ this
coordinate system so that the center of the input data patch is assumed to
be at (θ, φ) = (90◦, 0◦).

• All spatial derivatives are computed in the spherical coordinate system
described above (see Kazachenko, Fisher, and Welsch, 2014; Fisher et al.,
2019).

• Before computing the electric ﬁeld the input data (i.e. the magnetic ﬁeld
and plasma velocity estimates) are interpolated to a staggered grid (Yee,
1966; Fisher et al., 2019) in two dimensions. As a short summary, the grid

SOLA: paper_draft.tex; 24 May 2022; 0:25; p. 35

Lumme et al.

is deﬁned so that the input data are speciﬁed in the cell corners, the output
horizontal electric ﬁeld components (Eθ, Eφ) are given at cell edges, stag-
gered w.r.t. cell centers, and the output radial component Er is speciﬁed at
the cell corners. When the software is used to compute the magnetic vector
potential the output components (Ar, Aθ, Aφ) are deﬁned at the same grid
positions as the electric ﬁeld.

• All spatial derivatives are computed consistently with the discretization of
the Poisson equations in the inversion, i.e. the fact that the 5-point stencil
assumes 1st order spatial derivatives to be deﬁned at half-grid points is
taken into account (Kazachenko, Fisher, and Welsch, 2014; Lumme, Po-
moell, and Kilpua, 2017; Fisher et al., 2019). This ensures that our electric
ﬁeld estimate is exactly inductive with respect to the magnetic ﬁeld input
interpolated into the staggered grid positions (except for small numerical
errors discussed below), where the Br component is interpolated to cell
centers.

Since we wish to employ Cartesian instead of spherical geometry in our
inversion (see Section 2.4.1), the default inversion scheme in PDFI SS must
be modiﬁed. Following the documentation in the PDFI SS library we deﬁne a
“pseudo-Cartesian” coordinate system on the surface of a very large sphere with
radius R(cid:48) (cid:29) R(cid:12), where the latitudinal extent of our patch is ﬁxed to be very
small, 10−4 radians:

Nθ∆θ(cid:48) = 10−4 rad ≈ 0.0057◦.

(20)

Here Nθ is the number of cells in our patch in latitudinal θ direction (for our
547 × 527 patch Nθ = 527 − 1 = 526), and ∆θ(cid:48) is the grid spacing in the pseudo-
Cartesian system. Now we choose the radius of this large sphere so that the
physical size of our original patch as well as the pixel size (∆y = R(cid:12)∆θ =
R(cid:12)∆φ = ∆x) remain the same (for our patch with ∆θ = ∆φ = 0.03◦, ∆y =
∆x ≈ 364 km). This gives relation for the radius of the large sphere R(cid:48):

Nθ∆y(cid:48) = Nθ∆y
NθR(cid:48)∆θ(cid:48) = NθR(cid:12)∆θ
(cid:19)
(cid:18) Nθ∆θ
Nθ∆θ(cid:48)
R(cid:48) ≈ 2750R(cid:12)

R(cid:48) =

R(cid:12)

(21)

(22)

(23)

(24)

Using the pseudo-Cartesian coordinate system (R(cid:48), θ(cid:48), φ(cid:48)) when calling the PDFI SS
software we preserve all the properties of the original input data patch – including
the grid spacing as well as the magnitudes and LOS vector directions of the
Dopplergram velocities – but the spherical corrections in the spatial derivatives
become vanishingly small and all the computations are approximately Cartesian.
Finally, the output is transformed as: (Ex, Ey, Ez) = (Eφ, −Eθ, Er) following the
deﬁnition of a local Cartesian basis from Lumme, Pomoell, and Kilpua (2017).

SOLA: paper_draft.tex; 24 May 2022; 0:25; p. 36

Probing the eﬀect of cadence

The maximum error introduced into the inductivity of the output electric

ﬁeld by the pseudo-Cartesian approximation is:

max |(∇ × E)z − (−∂Bz/∂t)|
(cid:104)|∂Bz/∂t|(cid:105)

(cid:46) 10−8,

(25)

when compared to the average magnitude of |∂Bz/∂t| (excluding the masked
noise-dominated pixels, |B| < 300 Mx cm−2). This error is much smaller than
the error introduced by the FISHPACK Poisson solver (Swarztrauber and Sweet,
1975) in the PDFI software, which removes the means of the source terms of
the Poisson equations used in solving the inductive electric ﬁeld using Poloidal-
Toroidal Decomposition (see Kazachenko, Fisher, and Welsch, 2014; Lumme,
Pomoell, and Kilpua, 2017). This produces an additional error of ∼ 10−2 to Eq.
25 above. Although it is possible to remove this additional error altogether by
using diﬀerent boundary conditions for the solutions of the Poisson equations
(Fisher et al., 2019) or alternatively post facto electric ﬁeld corrections (see
Fisher et al., 2010; Lumme, Pomoell, and Kilpua, 2017), we decided not to
employ either of these due to the fact that the error produced by this issue
remained small for the well-isolated active region NOAA 11158 used in this
study.

B. Optimization of the windowing parameters of FLCT and

DAVE4VM

As discussed in Section 2.3 we optimize the windowing parameters of FLCT
(σF LCT ) and DAVE4VM (square top hat side length) for each of our data series
of variable cadence and spatial resolution so that the output velocities fulﬁll
the advection equation (Eq. 5) and the normal component of the induction
equation (Eq. 6), respectively, as well as possible. More speciﬁcally, we measure
the success in the reproduction of these equations by the following metrics (also
used by Schuck, 2008):

ρ slope in the ﬁt: T = ρX + α

C Pearson correlation: C(T, X)

S Spearman rank order correlation: S(T, X)

(26)

(27)

(28)

where T = ∂Bz/∂t, the time derivative term in the advection/induction eq.,
and X is the spatial derivative term, Vh · ∇hBz in the advection equation (Eq.
5) and ∇h · (BzVh − VzBh) in the induction equation (Eq. 6). Since optimal
reproduction of the respective equations yields T = −X, the optimal metrics
are thus ρ = C = S = −1. Though we consider all of these metrics in our
optimization procedures, we nonetheless aim to ﬁnd a single metric for FLCT
and DAVE4VM optimizations each so that the metric works robustly across all
cadences and spatial resolutions.

For testing our optimization approach we employ synthetic magnetogram data
from the ANMHD simulation (Abbett et al., 2004; Welsch et al., 2007; Schuck,

SOLA: paper_draft.tex; 24 May 2022; 0:25; p. 37

Lumme et al.

2008, see also Introduction, Section 1), which has been used to test velocity
inversion routines. Since our optimization algorithm for the DAVE4VM window
size is essentially the same as the one used by Schuck (2008), we were able to
reproduce their optimization curves for metrics ρ, C and S above (see Schuck,
2008, Figure 1, upper right panel). σF LCT on the other hand has been previously
optimized to give the best consistency between the output FLCT velocity and the
horizontal components of the known ANMHD velocity ﬁeld (Welsch et al., 2007;
Kazachenko, Fisher, and Welsch, 2014), which is fundamentally diﬀerent from
our approach. When applied to ANMHD data our optimization algorithm gives
the optimal value σF LCT = 12 pixels from the Pearson and Spearman correlation
metrics, whereas the slope metric reaches no proper minimum in the optimization
interval (see Figure 12, left panel). The optimal value of 12 pixels is close to the
optimal value of 15 pixels by Welsch et al. (2007) and Kazachenko, Fisher, and
Welsch (2014), and the diﬀerence is acceptable considering the ﬂatness of the
C(σF LCT ) and S(σF LCT ) curves near the values σF LCT ∈ [10, 15]. Based on
this test, the correlation metrics appear to yield the most unique optimization
for σF LCT , and in the further optimizations discussed below, we found that the
Pearson correlation gives the most robust results. Thus, hereafter we deﬁne the
optimal σF LCT to be at the minimum of the Pearson correlation metric (Eq. 27)
of the advection equation.

Figure 12. Optimization of σF LCT using the synthetic magnetogram data from ANMHD
simulation. Left panel shows the optimization curves for the metrics slope, Pearson and Spear-
man correlation, where the optimal σF LCT = 12 pixel at the minimum of Pearson correlation
has been indicated by the vertical dashed line. Right panel shows the scatter plot between the
two terms of the advection equation for the optimal σF LCT = 12 pixels. The red dashed line
shows the y = −x line Vh · ∇hBz = −dBz/dt, to which the scatter plot points should fall in
the case of perfect reproduction of the advection equation.

After validating the optimization algorithm against previous ANMHD tests,
we moved onto applying the method to real magnetogram observations. We
employ a representative frame closest to the central meridian passage of our
NOAA AR 11158 series (Feb 14 01:48 UT) for the optimization, which is chosen
for its good representativeness of the active region properties (see Section 4.1 for
details). As illustrated by Figure 13 the FLCT optimization for 12-minute data
input gives a minimum Pearson correlation at σF LCT = 4 pixels (whereas the
slope and Spearman correlation metrics yield optimal σF LCT of 4 and 3 pixels,

SOLA: paper_draft.tex; 24 May 2022; 0:25; p. 38

051015202530FLCT [pix]1.000.980.960.940.920.900.880.86Correlations1.000.950.900.850.800.750.70SlopePearson corr. CSpearman corr. SSlope Opt. sigma: 124002000200400dBz/dt4002000200400VhhBz(,C,S)= (-0.81,-0.97,-0.92)Probing the eﬀect of cadence

respectively). This is similar to the σF LCT = 5 pixels used by Kazachenko et al.
(2015). Unlike the ANHMD test case where all metrics were very good (optimally
ρ, C, S = -0.81, -0.97, -0.92, see Figure 12, right panel) for real data input the
optimal correlations degrade to ∼-0.8 and the slope drops to -0.46. This is most
likely a noise-related eﬀect, since real magnetogram input is clearly more noise-
dominated both spatially and temporally than the extremely smooth ANMHD
input (see e.g. Welsch et al., 2007, for further details on the ANMHD data
properties). Table 2 lists the σF LCT optimization results for all cadences and
spatial resolutions considered in this study.

Figure 13. Same as Figure 12, but now the σF LCT optimization procedure is applied to a
representative frame at Feb 14 01:48 in our 12-minute vector magnetogram series.

Table 2. Optimization results for σF LCT and DAVE4VM window size over
all cadences and spatial resolutions considered in this study.

Opt. FLCT

Opt. DAVEVM

Dataset
cadence

σF LCT
[pix]

2.25 min
11.25 min
12 min 1
2.025 h
- - (rebin 15x)
6 h
- - (rebin 15x)
12 h
- - (rebin 15x)
24 h
- - (rebin 15x)

2
3
4
26
30 2
44
45 2
41
45 2
27
30 2

[ρCS ]
at opt. σF LCT
-0.29-0.76-0.74
-0.44-0.81-0.79
-0.46-0.83-0.79
-0.60-0.59-0.58
-0.20-0.75-0.80
-0.47-0.36-0.37
-0.37-0.77-0.67
-0.64-0.32-0.35
-0.48-0.74-0.63
-0.16-0.08-0.11
-0.26-0.44-0.41

window size
[pix]

[ρSC ]
at opt. w.size

19
19
19
29
75 2
45
75 2
39
105 2
39
1652

-0.26-0.36-0.39
-0.46-0.52-0.61
-0.52-0.56-0.65
-0.36-0.52-0.58
-0.55-0.66-0.69
-0.17-0.40-0.44
-0.51-0.68-0.74
-0.18-0.41-0.43
-0.52-0.68-0.77
-0.12-0.28-0.34
-0.17-0.50-0.41

1Diﬀerent data source, see Sections 2.1 and 2.2 for details.
2In full resolution units.

Unlike the σF LCT optimization the DAVE4VM window size case produces
clearly more ambiguous results both for ANMHD (see Schuck, 2008, Figure 1,
upper right panel) and real observations. As illustrated by the left panel of Figure

SOLA: paper_draft.tex; 24 May 2022; 0:25; p. 39

0246810FLCT [pix]1.00.90.80.70.60.50.4Correlations0.5000.4750.4500.4250.4000.3750.3500.3250.300SlopePearson corr. CSpearman corr. SSlope Opt. sigma: 47505002500250500750dBz/dt6004002000200400600VhhBz(,C,S)= (-0.46,-0.83,-0.79)Lumme et al.

14, all metrics have a clear minimum for the 12-minute magnetogram input data,
but the minima of the correlation and slope metrics are very diﬀerent (∼19 and
5 pixels, respectively). Moreover, as already noted by Schuck (2008) the slope
metric degrades as a function of the window size, whereas the correlation metrics
continue to improve (until saturating at ∼19 pixels in our case). Due to the
inconsistency between the evolution of the metrics Schuck (2008) suggests that
the optimal value is chosen as a balance between the degrading slope metric and
improving correlation metrics.

Figure 14. Optimization of the DAVE4VM window size using vector magnetogram input from
our 12-minute data series. Left panel shows the optimization curves for the slope, Pearson
and Spearman correlation metrics with the optimal window size (i.e. the local minimum
of Spearman correlation with the smallest window size) indicated by the vertical dashed
line. Right panel shows the scatter plot between the two terms of the advection equation
for the optimal window size of 19 pixels. The red dashed line shows the y = −x line
∇h · (BzVh − VzBh) = −dBz/dt, to which the scatter plot points should fall in the case
of perfect reproduction of the induction equation.

Based on a survey covering all optimization curves over all cadences and
spatial resolutions, we have chosen the optimal DAVE4VM window size to be the
one where the Spearman correlation reaches a local minimum with the smallest
window size. This approach turned out to be robust over all cadences and spatial
resolutions used in this study. More speciﬁcally, we ﬁnd that: (1) a local minimum
always existed and it was also often the global minimum, thus emphasizing
the uniqueness of the solution, and (2) the optimal window size coincided well
with the idea of Schuck (2008) that a balance between the degrading slope and
improving correlation metrics should be found. Using this method we obtained
an optimal value of 19 pixels for the 12-minute magnetogram input, which is
consistent with Liu and Schuck (2012) and Lumme, Pomoell, and Kilpua (2017).
As shown by Figures 13 and 14, and further by Table 2 the values of the
optimization metrics are in most cases clearly poorer for the DAVE4VM opti-
mization than for σF LCT case. This emphasizes the issue of poor inductiveness
of the raw DAVE4VM electric ﬁeld already discussed in Section 2.4.2 (as perfect
inductivity would mean also perfect metrics ρ = C = S = −1). The metrics
and inductivity are also clearly worse for real magnetogram input than for the
ANMHD data input, e.g. S = -0.56 for the 12-minute input, as opposed to
optimal S ∼ -0.8 for the ANMHD input (Schuck, 2008, Figure 1, upper right

SOLA: paper_draft.tex; 24 May 2022; 0:25; p. 40

0510152025303540Window size [pix]0.70.60.50.40.3Correlations and slopePearson corr. CSpearman corr. SSlope Opt. sigma: 197505002500250500750dBz/dt6004002000200400600h(BzVhVzBh)(,C,S)= (-0.52,-0.65,-0.56)Probing the eﬀect of cadence

panel). This indicates that the larger spatial and temporal noise and higher
spatial structuring of the real magnetogram data compared to the very smooth
ANMHD data is a likely cause for the degration in the inductivity. As shown by
the last column of Table 2 the inductivity also changes as a function of cadence,
e.g. the optimal Spearman correlation increases from -0.52 to -0.36 between the
mock nominal cadence of 11.25 min and highest cadence of 2.25 min. This issue
is further discussed in Section 4.2.

Figure 15 (solid curves) illustrates the results of the optimization scheme
described above for one of the lowest cadences of 2 hours. As indicated by the
ﬁgure and further by Table 2 most of the metrics become clearly worse at optimal
σF LCT /window size over the lowest cadences ≥2 h. For example, the optimal
Pearson correlation in the FLCT optimization drops from ∼-0.8 to -0.59 – -0.08
between the 12-minute and the ≥2-hour cadences. This degradation in the qual-
ity of the optimization as a function of cadence is not a surprise considering the
fact that when using the lowest cadences our central diﬀerence approximation for
the advection/induction equation compares magnetograms 2∆t ∈ [4, 48] hours
apart. FLCT tracking recovers shifts of tens of pixels over these intervals, and
such large shifts make our discretization of the advection/induction equation an
extremely poor approximation; optimally the shifts should be of subpixel mag-
nitude (e.g. Welsch et al., 2012). As already discussed in Section 2.2 we attempt
to remove this issue by creating an additional rebinned vector magnetogram
time series for the lowest cadences (≥2 h) with 15 times lower spatial resolution.
For this dataset the largest FLCT-recovered shifts over 2∆t ∈ [4, 48] hours drop
below 2–3 pixels and most of the shifts are (cid:46)1 pixels. Dashed lines in Figure
15 show the optimization curves for 15-times rebinned 2-hour input (so that
the σF LCT and DAVE4VM window size are scaled to the original full resolution
units). We can see that the optimal σF LCT values are very similar between the
full resolution and rebinned cases when the rebinned values are scaled to full
resolution units, and consistent well within the σF LCT grid spacing error of the
rebinned case (0.5 × 15 = 7.5 pixels). This same result is recovered also for other
cadences as illustrated by the second column of Table 2. Moreover, the rebinning
introduces also a clear improvement in the (C, S) metrics at the optimal σF LCT
values.

However, when it comes to the DAVE4VM window size, the optimization
results are clearly not consistent between the full resolution and the 15-times
rebinned cases, where the latter is strongly biased towards larger window sizes
(Figure 15b and Table 2, last column). This is expected considering the fact that
the smallest possible window size in the rebinned case is 3 rebinned pixels, and
thus 45 full resolution pixels. Furthermore, since we consider only symmetric
windows of odd window size in pixels, the next value in the grid is already 5
rebinned and 75 full resolution pixels. Since we employ the 5-point least-squares
optimized derivatives in the spatial discretization of Eq. 6 (J¨ahne, 2004; Schuck,
2008; Liu and Schuck, 2012), and thus our estimates for the spatial derivatives at
each pixel employ points over 5×5 pixel area, it is also expected that the optimal
results are ≥5 rebinned pixels (≥75 pixels in full resolution). Despite this issue,
we ﬁnd that, similarly to the FLCT case, the metrics at optimal window sizes
do improve after the rebinning (Figure 15 and Table 2), as expected due to the
markedly better discrete approximation of the induction equation.

SOLA: paper_draft.tex; 24 May 2022; 0:25; p. 41

Lumme et al.

Figure 15. Optimization of σF LCT (panel a) and the DAVE4VM window size (panel b) using
vector magnetogram input from our 2.025-h data series with full spatial resolution (solid lines)
and 15-times rebinned input data (dashed lines). The optimal values for each are indicated
by gray vertical lines. Note that σF LCT and DAVE4VM window size in the rebinned case are
scaled to the full resolution units.

C. Supplementary ﬁgures

Figure 16. Energy Em(t) (upper panel) and helicity HR(t) (lower panel) injections for NOAA
AR 11158 derived from PDFI electric ﬁeld estimates for the lowest cadences (≥2 h) using both
full resolution and 15-times rebinned input data (solid curves), with error bars shown by
the shaded regions surrounding the curves. The full-resolution 11.25-minute reference is also
plotted with its combined noise- and method-related error bars at the time of the X-class ﬂare
(dotted black vertical line).

SOLA: paper_draft.tex; 24 May 2022; 0:25; p. 42

020406080100FLCT [pix]0.80.70.60.50.40.3Pearson correlationa) FLCT opt. for 2-hr datafull res.Opt. 26 pix (full res.)rebin 15xOpt. 30 pix (rebin 15x)020406080100120140Window size [pix]0.70.60.50.40.30.20.1Spearman correlationb) DAVE4VM w. size opt. for 2-hr datafull res.Opt. 29 pix (full res.)rebin 15xOpt. 75 pix (rebin 15x)0.00.20.40.60.81.01.2Em(t) [1033 ergs]0.500.250.000.250.500.751.00dEm/dt [1028 ergs/s]Em(t) 2-hEm(t) 2-h 15x rebinEm(t) 6-hEm(t) 6-h 15x rebinEm(t) 12-hEm(t) 12-h 15x rebinEm(t) 24-hEm(t) 24-h 15x rebinEm(t) 11.25-min11121314151617Feb 20110.20.00.20.40.60.81.0HR(t) [1043 Mx2]1.51.00.50.00.51.01.5dHR/dt [1038 Mx2/s]HR(t) 2-hHR(t) 2-h 15x rebinHR(t) 6-hHR(t) 6-h 15x rebinHR(t) 12-hHR(t) 12-h 15x rebinHR(t) 24-hHR(t) 24-h 15x rebinHR(t) 11.25-minPDFI full res. and 15x-rebinned injection estimatesProbing the eﬀect of cadence

Figure 17. Energy Em(t) and helicity HR(t) injections for NOAA AR 11158 derived from
inductive DAVE4VM electric ﬁeld estimates for the lowest cadences (≥2 h) using both full
resolution and 15-times rebinned input data (solid curves), with error bars shown by the
shaded regions surrounding the curves. The full-resolution 11.25-minute inductive DAVE4VM
and PDFI estimates are also plotted with the combined noise- and method-related error bar
for the latter at the time of the X-class ﬂare (dotted black vertical line).

References

Abbett, W.P., Miki´c, Z., Linker, J.A., McTiernan, J.M., Magara, T., Fisher, G.H.: 2004, The
photospheric boundary of Sun-to-Earth coupled models. Journal of Atmospheric and Solar-
Terrestrial Physics 66, 1257. DOI. ADS. [Abbett2004]

Berger, M.A., Field, G.B.: 1984, The topological properties of magnetic helicity. Journal of

Fluid Mechanics 147, 133. DOI. ADS. [Berger1984]

Bi, Y., Liu, Y.D., Liu, Y., Yang, J., Xu, Z., Ji, K.: 2018, A Survey of Changes in Magnetic
Helicity Flux on the Photosphere During Relatively Low-class Flares. Astrophys. J. 865,
139. DOI. [Bi2018]

Bobra, M.G., Sun, X., Hoeksema, J.T., Turmon, M., Liu, Y., Hayashi, K., Barnes, G., Leka,
K.D.: 2014, The Helioseismic and Magnetic Imager (HMI) Vector Magnetic Field Pipeline:
SHARPs - Space-Weather HMI Active Region Patches. Solar Phys. 289, 3549. DOI. ADS.
[Bobra2014]

Borrero, J.M., Ichimoto, K.: 2011, Magnetic Structure of Sunspots. Living Reviews in Solar

Physics 8, 4. DOI. ADS. [Borrero2011]

Chandrasekhar, S.: 1970, Hydrodynamic and hydromagnetic stability 196, Clarendon Press

Oxford, ???. [Chandrasekhar1970]

Cheung, M.C.M., DeRosa, M.L.: 2012, A Method for Data-driven Simulations of Evolving

Solar Active Regions. Astrophys. J. 757, 147. DOI. ADS. [Cheung2012]

Cheung, M.C.M., Isobe, H.: 2014, Flux Emergence (Theory). Living Reviews in Solar Physics

11, 3. DOI. ADS. [Cheung2014]

Cheung, M.C.M., van Driel-Gesztelyi, L., Mart´ınez Pillet, V., Thompson, M.J.: 2016, The Life

Cycle of Active Region Magnetic Fields. Space Sci. Rev.. DOI. ADS. [Cheung2016]

SOLA: paper_draft.tex; 24 May 2022; 0:25; p. 43

0.000.250.500.751.001.251.50Em(t) [1033 ergs]0.00.20.40.60.81.0dEm/dt [1028 ergs/s]Em(t) 2-hEm(t) 2-h 15x rebinEm(t) 6-hEm(t) 6-h 15x rebinEm(t) 12-hEm(t) 12-h 15x rebinEm(t) 11.25-minEm(t) 11.25-min PDFI11121314151617Feb 20110.500.250.000.250.500.751.001.25HR(t) [1043 Mx2]0.50.00.51.0dHR/dt [1038 Mx2/s]HR(t) 2-hHR(t) 2-h 15x rebinHR(t) 6-hHR(t) 6-h 15x rebinHR(t) 12-hHR(t) 12-h 15x rebinHR(t) 11.25-minHR(t) 11.25-min PDFIInductive DAVE4VM full res. and 15x-rebinned injection estimatesLumme et al.

Christensen, R.: 1996, Analysis of Variance, Design, and Regression: Applied Statistical

Methods, CRC Press, ???. [Christensen1996]

DeForest, C.E., Hagenaar, H.J., Lamb, D.A., Parnell, C.E., Welsch, B.T.: 2007, Solar Magnetic
Tracking. I. Software Comparison and Recommended Practices. Astrophys. J. 666, 576.
DOI. ADS. [DeForest2007]

D´emoulin, P.: 2007, Recent theoretical and observational developments in magnetic helicity

studies. Adv. Space Res. 39(11), 1674. [Demoulin2007]

DeRosa, M.L., Wheatland, M.S., Leka, K.D., Barnes, G., Amari, T., Canou, A., Gilchrist,
S.A., Thalmann, J.K., Valori, G., Wiegelmann, T., Schrijver, C.J., Malanushenko, A., Sun,
X., R´egnier, S.: 2015, The Inﬂuence of Spatial resolution on Nonlinear Force-free Modeling.
Astrophys. J. 811, 107. DOI. [DeRosa2015]

Ferm¨uller, C., Shulman, D., Aloimonos, Y.: 2001, The Statistics of Optical Flow. Computer

Vision and Image Understanding 82(1), 1. [Fermuller2001]

Fisher, G.H., Welsch, B.T.: 2008, FLCT: A Fast, Eﬃcient Method for Performing Local
Correlation Tracking. In: Howe, R., Komm, R.W., Balasubramaniam, K.S., Petrie, G.J.D.
(eds.) Subsurface and Atmospheric Inﬂuences on Solar Activity, Astronomical Society of
the Paciﬁc Conference Series 383, 373. ADS. [Fisher2008]

Fisher, G.H., Welsch, B.T., Abbett, W.P.: 2012, Can We Determine Electric Fields and Poynt-
ing Fluxes from Vector Magnetograms and Doppler Measurements? Solar Phys. 277, 153.
DOI. ADS. [Fisher2012]

Fisher, G.H., Longcope, D.W., Metcalf, T.R., Pevtsov, A.A.: 1998, Coronal Heating in Active
Regions as a Function of Global Magnetic Variables. Astrophys. J. 508, 885. DOI. ADS.
[Fisher1998]

Fisher, G.H., Welsch, B.T., Abbett, W.P., Bercik, D.J.: 2010, Estimating Electric Fields from

Vector Magnetogram Sequences. Astrophys. J. 715, 242. DOI. ADS. [Fisher2010]

Fisher, G.H., Abbett, W.P., Bercik, D.J., Kazachenko, M.D., Lynch, B.J., Welsch, B.T., Hoek-
sema, J.T., Hayashi, K., Liu, Y., Norton, A.A., Dalda, A.S., Sun, X., DeRosa, M.L., Cheung,
M.C.M.: 2015, The Coronal Global Evolutionary Model: Using HMI Vector Magnetogram
and Doppler Data to Model the Buildup of Free Magnetic Energy in the Solar Corona.
Space Weather 13, 369. DOI. ADS. [Fisher2015]

Fisher, G.H., Kazachenko, M.D., Welsch, B.T., Sun, X., Lumme, E., Bercik, D.J., Cheung,
M.C.M., DeRosa, M.L.: 2019, Generalization of the PDFI electric ﬁeld inversion algorithm
to spherical coordinates. Astrophys. J.. in preparation. [Fisher2019]

Hoeksema, J.T., Liu, Y., Hayashi, K., Sun, X., Schou, J., Couvidat, S., Norton, A., Bobra, M.,
Centeno, R., Leka, K.D., Barnes, G., Turmon, M.: 2014, The Helioseismic and Magnetic
Imager (HMI) Vector Magnetic Field Pipeline: Overview and Performance. Solar Phys.
289, 3483. DOI. ADS. [Hoeksema2014]

Inoue, S., Kusano, K., B¨uchner, J., Sk´ala, J.: 2018, Formation and dynamics of a solar eruptive

ﬂux tube. Nature Communications 9, 174. DOI. ADS. [Inoue2018]

J¨ahne, B.: 2004, Practical handbook on image processing for scientiﬁc and technical applica-

tions, CRC Press, ???. [Jahne2004]

Kazachenko, M.D., Fisher, G.H., Welsch, B.T.: 2014, A Comprehensive Method of Estimating
Electric Fields from Vector Magnetic Field and Doppler Measurements. Astrophys. J. 795,
17. DOI. ADS. [Kazachenko2014]

Kazachenko, M.D., Fisher, G.H., Welsch, B.T., Liu, Y., Sun, X.: 2015, Photospheric Electric
Fields and Energy Fluxes in the Eruptive Active Region NOAA 11158. Astrophys. J. 811,
16. DOI. ADS. [Kazachenko2015]

Lagg, A., Lites, B., Harvey, J., Gosain, S., Centeno, R.: 2017, Measurements of Photospheric
and Chromospheric Magnetic Fields. Space Sci. Rev. 210, 37. DOI. ADS. [Lagg2017]
Leake, J.E., Linton, M.G., Schuck, P.W.: 2017, Testing the Accuracy of Data-driven MHD

Simulations of Active Region Evolution. Astrophys. J. 838(2), 113. [Leake2017]

Liu, C., Xu, Y., Cao, W., Deng, N., Lee, J., Hudson, H.S., Gary, D.E., Wang, J., Jing, J., Wang,
H.: 2016a, Flare diﬀerentially rotates sunspot on Sun’s surface. Nature Communications 7,
13104. DOI. [Liu2016nature]

Liu, R., Kliem, B., Titov, V.S., Chen, J., Wang, Y., Wang, H., Liu, C., Xu, Y., Wiegelmann,
T.: 2016b, Structure, Stability, and Evolution of Magnetic Flux Ropes from the Perspective
of Magnetic Twist. Astrophys. J. 818, 148. DOI. ADS. [Liu2016]

Liu, Y., Schuck, P.W.: 2012, Magnetic Energy and Helicity in Two Emerging Active Regions

in the Sun. Astrophys. J. 761, 105. DOI. ADS. [Liu2012]

Liu, Y., Hoeksema, J.T., Bobra, M., Hayashi, K., Schuck, P.W., Sun, X.: 2014, Magnetic

Helicity in Emerging Solar Active Regions. Astrophys. J. 785, 13. DOI. [Liu2014]

SOLA: paper_draft.tex; 24 May 2022; 0:25; p. 44

Probing the eﬀect of cadence

Liu, Y., Hoeksema, J.T., Sun, X., Hayashi, K.: 2017, Vector Magnetic Field Synoptic Charts
from the Helioseismic and Magnetic Imager (HMI). Solar Phys. 292, 29. DOI. ADS.
[Liu2017]

Lumme, E., Pomoell, J., Kilpua, E.K.J.: 2017, Optimization of Photospheric Electric Field
Estimates for Accurate Retrieval of Total Magnetic Energy Injection. Solar Phys. 292,
191. DOI. [Lumme2017]

Mackay, D.H., DeVore, C.R., Antiochos, S.K.: 2014, Global-scale Consequences of Magnetic-
helicity Injection and Condensation on the Sun. Astrophys. J. 784, 164. DOI. ADS.
[Mackay2014]

Metcalf, T.R.: 1994, Resolving the 180-degree ambiguity in vector magnetic ﬁeld measure-
ments: The ’minimum’ energy solution. Solar Phys. 155, 235. DOI. ADS. [Metcalf1994]
Mumford, S.J., Christe, S., P´erez-Su´arez, D., Ireland, J., Shih, A.Y., Inglis, A.R., Liedtke, S.,
Hewett, R.J., Mayer, F., Hughitt, K., Freij, N., Meszaros, T., Bennett, S.M., Malocha, M.,
Evans, J., Agrawal, A., Leonard, A.J., Robitaille, T.P., Mampaey, B., Campos-Rozo, J.I.,
Kirk, M.S.: 2015, SunPy – Python for solar physics. Computational Science and Discovery
8(1), 014009. DOI. ADS. [Mumford2015]

Pariat, E., Leake, J.E., Valori, G., Linton, M.G., Zuccarello, F.P., Dalmasse, K.: 2017, Relative
magnetic helicity as a diagnostic of solar eruptivity. A&A 601, A125. DOI. https://doi.org/
10.1051/0004-6361/201630043. [Pariat2017]

Pesnell, W.D., Thompson, B.J., Chamberlin, P.C.: 2012, The Solar Dynamics Observatory

(SDO). Solar Phys. 275, 3. DOI. ADS. [Pesnell2012]

Pevtsov, A.A., Canﬁeld, R.C., Metcalf, T.R.: 1994, Patterns of helicity in solar active regions.

Astrophys. J. Lett. 425, L117. DOI. ADS. [Pevtsov1994]

Pomoell, J., Lumme, E., Kilpua, E.: 2019, Time-dependent Data-driven Modeling of Active
Region Evolution Using Energy-optimized Photospheric Electric Fields. Solar Phys. 294,
41. DOI. ADS. [Pomoell2019]

Ravindra, B., Longcope, D.W., Abbett, W.P.: 2008, Inferring Photospheric Velocity Fields
Using a Combination of Minimum Energy Fit, Local Correlation Tracking, and Doppler
Velocity. Astrophys. J. 677, 751. DOI. ADS. [Ravindra2008]

Scherrer, P.H., Schou, J., Bush, R.I., Kosovichev, A.G., Bogart, R.S., Hoeksema, J.T., Liu, Y.,
Duvall, T.L., Zhao, J., Title, A.M., Schrijver, C.J., Tarbell, T.D., Tomczyk, S.: 2012, The
Helioseismic and Magnetic Imager (HMI) Investigation for the Solar Dynamics Observatory
(SDO). Solar Phys. 275, 207. DOI. ADS. [Scherrer2012]

Schou, J., Scherrer, P.H., Bush, R.I., Wachter, R., Couvidat, S., Rabello-Soares, M.C., Bogart,
R.S., Hoeksema, J.T., Liu, Y., Duvall, T.L., Akin, D.J., Allard, B.A., Miles, J.W., Rairden,
R., Shine, R.A., Tarbell, T.D., Title, A.M., Wolfson, C.J., Elmore, D.F., Norton, A.A.,
Tomczyk, S.: 2012, Design and Ground Calibration of the Helioseismic and Magnetic Imager
(HMI) Instrument on the Solar Dynamics Observatory (SDO). Solar Phys. 275, 229. DOI.
[Schou2012]

Schrijver, C.J., Aulanier, G., Title, A.M., Pariat, E., Delann´ee, C.: 2011, The 2011 February 15
X2 Flare, Ribbons, Coronal Front, and Mass Ejection: Interpreting the Three-dimensional
Views from the Solar Dynamics Observatory and STEREO Guided by Magnetohydrody-
namic Flux-rope Modeling. Astrophys. J. 738, 167. DOI. ADS. [Schrijver2011]

Schuck, P.W.: 2005, Local Correlation Tracking and the Magnetic Induction Equation.

Astrophys. J. Lett. 632, L53. DOI. [Schuck2005]

Schuck, P.W.: 2008, Tracking Vector Magnetograms with the Magnetic Induction Equation.

Astrophys. J. 683, 1134. DOI. ADS. [Schuck2008]

Schuck, P.W.: 2012, Tracking Vector Magnetograms with the Helioseismic and Magnetic Im-
ager. In: American Astronomical Society Meeting Abstracts #220, American Astronomical
Society Meeting Abstracts 220, 207.06. ADS. [Schuck2012]

Sun, X., Hoeksema, J.T., Liu, Y., Wiegelmann, T., Hayashi, K., Chen, Q., Thalmann, J.:
2012, Evolution of Magnetic Field and Energy in a Major Eruptive Active Region Based
on SDO/HMI Observation. Astrophys. J. 748, 77. DOI. ADS. [Sun2012]

Sun, X., Hoeksema, J.T., Liu, Y., Kazachenko, M., Chen, R.: 2017, Investigating the Magnetic
Imprints of Major Solar Eruptions with SDO/HMI High-cadence Vector Magnetograms.
Astrophys. J. 839, 67. DOI. [Sun2017]

Swarztrauber, P., Sweet, R.: 1975, Eﬃcient FORTRAN subprograms for the solution of elliptic

partial diﬀerential equations. [Swarztrauber1975]

Tremblay, B., Vincent, A.: 2015, A Minimum Energy Fit Method to Reconstruct Photospheric
Velocity and Magnetic Diﬀusivity in Active Regions from Observed Magnetograms and
Dopplergrams. Solar Phys. 290, 437. DOI. ADS. [Tremblay2015]

SOLA: paper_draft.tex; 24 May 2022; 0:25; p. 45

Lumme et al.

Tziotziou, K., Georgoulis, M.K., Liu, Y.: 2013, Interpreting Eruptive Behavior in NOAA AR
11158 via the Region’s Magnetic Energy and Relative-helicity Budgets. Astrophys. J. 772,
115. DOI. ADS. [Tziotziou2013]

van Driel-Gesztelyi, L., Green, L.M.: 2015, Evolution of Active Regions. Living Reviews in

Solar Physics 12, 1. DOI. [Van2015]

Wang, W., Liu, R., Wang, Y., Hu, Q., Shen, C., Jiang, C., Zhu, C.: 2017, Buildup of a highly
twisted magnetic ﬂux rope during a solar eruption. Nature Communications 8, 1330. DOI.
ADS. [Wang2017]

Weinzierl, M., Yeates, A.R., Mackay, D.H., Henney, C.J., Arge, C.N.: 2016, A New Technique
for the Photospheric Driving of Non-potential Solar Coronal Magnetic Field Simulations.
Astrophys. J. 823, 55. DOI. ADS. [Weinzierl2016]

Welsch, B.T.: 2006, Magnetic Flux Cancellation and Coronal Magnetic Energy. Astrophys. J.

638, 1101. DOI. ADS. [Welsch2006]

Welsch, B.T., Fisher, G.H., Sun, X.: 2013, A Magnetic Calibration of Photospheric Doppler

Velocities. Astrophys. J. 765, 98. DOI. ADS. [Welsch2013]

Welsch, B.T., Abbett, W.P., De Rosa, M.L., Fisher, G.H., Georgoulis, M.K., Kusano, K.,
Longcope, D.W., Ravindra, B., Schuck, P.W.: 2007, Tests and Comparisons of Velocity-
Inversion Techniques. Astrophys. J. 670, 1434. DOI. ADS. [Welsch2007]

Welsch, B.T., Kusano, K., Yamamoto, T.T., Muglach, K.: 2012, Decorrelation Times of

Photospheric Fields and Flows. Astrophys. J. 747, 130. DOI. ADS. [Welsch2012]

Yardley, S.L., Green, L.M., van Driel-Gesztelyi, L., Williams, D.R., Mackay, D.H.: 2018, The
Role of Flux Cancellation in Eruptions from Bipolar ARs. Astrophys. J. 866, 8. DOI. ADS.
[Yardley2018]

Yee, K.: 1966, Numerical solution of inital boundary value problems involving maxwell’s equa-
tions in isotropic media. IEEE Transactions on Antennas and Propagation 14, 302. DOI.
ADS. [Yee1966]

SOLA: paper_draft.tex; 24 May 2022; 0:25; p. 46

