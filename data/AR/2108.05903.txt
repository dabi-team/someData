1
2
0
2

g
u
A
2
1

]
T
S
.
h
t
a
m

[

1
v
3
0
9
5
0
.
8
0
1
2
:
v
i
X
r
a

On stochastic expansions of empirical distribution

function of residuals in autoregression schemes

M. V. Boldin ∗

Abstract

We consider a stationary linear AR(p) model with unknown mean. The autoregression

parameters as well as the distribution function (d.f.) G of innovations are unknown. The

observations contain gross errors (outliers). The distribution of outliers is unknown and
arbitrary, their intensity is γn−1/2 with an unknown γ, n is the sample size.

The assential problem in such situation is to test the normality of innovations.

Normality, as is known, ensures the optimality properties of widely used least squares

procedures. To construct and study a Pearson chi-square type test for normality we

estimate the unknown mean and the autoregression parameters. Then, using the estimates,

we ﬁnd the residuals in the autoregression. Based on them, we construct a kind of empirical

distribution function (r.e.d.f.) , which is a counterpart of the (inaccessible) e.d.f. of the

autoregression innovations. Our Pearson’s satatistic is the functional from r.e.d.f. Its

asymptotic distributions under the hypothesis and the local alternatives are determined

by the asymptotic behavior of r.e.d.f.

In the present work, we ﬁnd and substantiate in details the stochastic expansions of

the r.e.d.f. in two situations. In the ﬁrst one d.f. G(x) of innovations does not depend on

n. We need this result to investigate test statistic under the hypothesis. In the second

situation G(x) depends on n and has the form of a mixture G(x) = An(x) = (1
−
n−1/2)G0(x) + n−1/2H(x). We need this result to study the power of test under the local
alternatives.

Key words: autoregression, outliers, residuals, empirical distribution function,

Pearson’s chi-square test, estimators, normality, local alternatives, stochastic expansions.

∗Moscow State Lomonosov Univ., Dept. of Mech. and Math., Moscow, Russia

e-mail: boldin−m@hotmail.com

1

 
 
 
 
 
 
2010 Mathematics Subject Classiﬁcation: Primary 62G10; secondary 62M10,

62G30, 62G35.

1 Постановка задачи и результаты

В этой работе мы рассматриваем стационарную AR(p) модель с ненулевым средним

vt = β1vt−1 +

· · ·

+ βpvt−p + ν + εt,

Z.

t

∈

(1.1)

– независимые одинаково распределенные случайные величины

В (1.1)

εt}

{

(н.о.р.сл.в.) с неизвестной функцией распределения (ф.р.) G(x); Eε1 = 0, 0 < Eε2

1 <
Rp– вектор неизвестных параметров, таких что корни соот-
∞
ветствующего (1.1) характеристического уравнения по модулю меньше единицы; ν –

; β = (β1, . . . , βp)T

∈

неизвестное среднее, ν

R1.

∈

Эти условия дальше всегда предполагаются выполненными и особо не оговаривают-

ся.

Мы рассматриваем модель (1.1) с выбросами в наблюдениях. А именно, предполага-

ется, что наблюдаются величины

yt = vt + zγn

t ξt,

t = 1

p, . . . , n,

−

(1.2)

zγn
где v1−p, . . . , vn – выборка из стационарного решения
t }
н.о.р.сл.в., имеющие распределение Бернулли, т.е. принимающие значения 1 и 0, при-

уравнения (1.1);

vt}

{

{

чем вероятность единицы γn,

γn = min(1,

γ
√n

),

γ

≥

0 неизвестно.

Кроме того,

ξt}
следовательности

{

vt}
{
ξt}

{

– н.о.р.сл.в. с произвольным и неизвестным распределением Π. По-

,

,

zγ
t }

{

ξt}

{

независимы между собой.

Переменные

интерпретируются как выбросы (засорения), γn уровень засо-

рения. Для γ = 0 мы получаем модель (1.1) без засорений.

Модель (1.2) – локальный вариант хорошо известной модели засорения данных

во временных рядах, см. [1].

Перепишем уравнение (1.1) в удобном для дальнейшего рассмотрения виде. Для это-

го определим константу µ соотношеним

ν = (1

β1

−

. . .

−

βp)µ,

−

2

тогда

vt −

µ = β1(vt−1

µ) +

+ βp(vt−p −

· · ·

−

µ) + εt,

Z.

t

∈

Если положить ut := vt −

µ, то

vt = µ + ut,

ut = β1ut−1 +

+ βput−p + εt,

· · ·

Z.

t

∈

(1.3)

Последовательность

в (1.3) – авторегрессионная последовательность с нулевым

ut}

{

средним и конечной дсперсией.
yt}

Построим по наблюдениям

{

Далее Γ – любое конечноое неотрицательное число. Пусть ˆµn будет любая оценка µ,
для которой последовательнсть

из (1.2) оценки ненаблюдаемых

.

εt}

{

n1/2(ˆµn −

µ) = OP (1), n

→ ∞

, равномерно по γ

Γ.

≤

(1.4)

Например, в качестве оценки ˆµn можно взять обычную М-оценку, построенную по
yt}

так же, как строится М-оценка параметра сдвига по н.о.р. данным.

{

Положим

Пусть ˆβn = ( ˆβ1n, . . . , ˆβpn)T будет любая оценка β, для которой последовательность

ˆut = yt −

ˆµn,

t = 1, . . . , n.

n1/2( ˆβn −

β) = OP (1), n

→ ∞

, равномерно по γ

Γ.

≤

(1.5)

Примером подходящих оценок ˆβn могут служить GM-оценки, построенные по
так же, как они строятся по

ˆut}
. Асимптотические свойства таких оценок аналогич-

{

ut}

{

ны свойствам GM-оценок из Раздела 2.4 [2].

Положим

ˆεt = ˆut −

ˆβ1n ˆut−1

− · · · −

ˆβpn ˆut−p,

t = 1, . . . , n.

(1.6)

Величины

ˆεt}

{

называются остатками.

Ведем остаточную эмпирическую функцию распределения ( о.э.ф.р.)

ˆGn(x) = n−1

n

X
t=1

I(ˆεt ≤

x),

x

R1.

∈

Здесь и в дальнейшем I(
Функция ˆGn(x) – аналог гипотетической э.ф.р.

) обозначает индикатор события.

·

Gn(x) = n−1

n

X
t=1

I(εt ≤

x)

3

ненаблюдаемых величин ε1, . . . , εn.

Мы будем рассматривать две ситуации. В первой ф.р. G(x) величин

εt}

{

не

зависит от числа наблюдений n. Наша первая задача – доказать следующую теорему

1.1.

Теорема 1.1. Предположим, что ф.р. G(x) имеет дифференцируемую производную
g(x) = G′(x), и supx |
∞
при любых фиксированных x, Γ

. Пусть выполнены соотношения (1.4) – (1.5). Тогда

0 и любом δ > 0

g′(x)

<

|

≥

sup
γ≤Γ

P(

|

n1/2[ ˆGn(x)

Gn(x)]

−

g(x)δ(β)n1/2(ˆµn −

−

µ)

−

γ∆(x, Π)

> δ)

|

→

0, n

.

→ ∞

Здесь сдвиг, определяемый засорениями,

∆(x, Π) =

p

X
j=0

[EG(x + βjξ1)

G(x)], β0 =

1,

−

−

а δ(β) = 1

β1

−

−

. . .

−

βp.

Во второй ситуации относительно G(x) предполагается, что она зависит от n,

G(x) = An(x), и An(x) задается смесью

An(x) = (1

−

n−1/2)G0(x) + n−1/2H(x).

(1.7)

В (1.7) функции распределения G0(x) и H(x) удовлетворяют следующему условию.

Условие (А). Функции распределения G0(x) и H(x) имеют средние ноль, ко-

нечные дисперсии. Они дважды дифференцируемы с ограниченными вторыми при-

зводными.

Наша вторая задача – доказать в ситуации два следующую теорему.

Теорема 1.2. Предположим, что ф.р. G(x) зависит от n и задается соотношением
(1.7). Пусть выполнено Условие (А), и g0(x) = G′

0(x). Пусть выполнены соотношения

(1.4) – (1.5). Тогда при любом фиксированном x и любом δ > 0

sup
γ≤Γ

P(

|

n1/2[ ˆGn(x)

Gn(x)]

−

g0(x)δ(β)n1/2(ˆµn −

−

µ)

−

γ∆0(x, Π)

> δ)

|

→

0, n

.

→ ∞

(1.8)

Здесь сдвиг

∆0(x, Π) =

p

X
j=0

[EG0(x + βjξ1)

G0(x)], β0 =

1,

−

−

и, как в теореме 1.1, δ(β) = 1

β1

−

−

. . .

−

βp.

4

Замечание 1.1.

В разложении (1.8) формально отсутствует ф.р. H(x). Но H(x) присутствует

в (1.8) неявно, от нее зависит предельное распределение Gn(x). А именно, обозна-
чим через D[0, 1] пространство Скорохода функций без разрывов 2-го рода, опре-

деленных на [0, 1]. Пусть v(t), t
ˆvn(t) := n1/2[Gn(G−1

0 (t))

∈

−

[0, 1], будет броуновский мост. Тогда, см. [3],

t] слабо сходится в D[0, 1] к v(t) + [H(G−1

0 (t))

t], n

.

→ ∞

−

Замечание 1.2.

Теорема 1.2 была анонсирована без доказательства в [4]. Цель настоящей работы

– дать полное доказательство теорем 1.1 и 1.2. Разумеется, теорема 1.1 следует из

теоремы 1.2 при G0(x) = H(x) = G(x), но удобно сформулировать именно две тео-

ремы, т.к. доказательство теоремы 1.1 менее громоздко и на нем удобно объяснить

доказательство теоремы 1.2.

Замечание 1.3.

В силу сформулированных теорем предельное распределение о.э.ф.р. ˆGn(x) за-
висит от распределения оценки ˆµn. Предположим, что ф.р. G(x) симметрична от-
носительно нуля. Будем брать в такой ситуации оценкой G(x) симметризованную

оценку

Положим

Пусть

ˆSn(x) :=

ˆGn(x) + 1
−
2

ˆGn(

x)

−

.

∆S(x, Π) :=

∆0(x, Π)

∆0(
−
2

x, Π)

−

.

Sn(x) :=

Gn(x) + 1
−
2

Gn(

x)

−

.

Теоремы 1.1 и 1.2 прямо влекут

Следствие 1.1. При условиях теоремы 1.1 для симметричной G(x) или в условиях

теоремы 1.2 при симметричной G0(x)

sup
γ≤Γ

P(

|

n1/2[ ˆSn(x)

Sn(x)]

−

−

γ∆S(x, Π)

> δ)

|

→

0, n

.

→ ∞

Применения сформулированных теорем и следствия к построению и исследова-

нию симметризованных тестов типа хи-квадрат Пирсона для гипотез относительно

G(x) Пирсона были анонсированы в [4], [5]. В частности, там описаны тесты для

проверки нормальности G(x).

5

При этом, теорема 1.1 нужна, чтобы находить предельное распределение тесто-

вых статистик при гипотезах, а теорема 1.2 – при локальных альтернативах.

2 Доказательство теоремы 1.1.

Докажем теорему 1.1 для p = 1, доказательство в общем случае отличается лишь

громоздкими, но непринципиальными техническими детатями.

Переобозначим β1 как β, тогда

yt = µ + ut + zγn

t ξt,

ut = βut−1 + εt,

< 1,

t

β

|

|

Z,

∈

наблюдаются y0, . . . , yn. Тогда для ˆεt из (1.6) имеем:

(1

( ˆβn −

β)ut−1

ˆεt = εt −
где ради краткости мы положили αt := zγn
В силу (2.1)

ˆβn)(ˆµn −

−

−

µ) + αt −

t ξt −

( ˆβn −
βzγn

t−1ξt−1.

β)zγn

t−1ξt−1,

t = 1, . . . , n, (2.1)

ˆGn(x) =

n

X
t−1

I(εt ≤

x + ( ˆβn −

β)ut−1 + (1

ˆβn)(ˆµn −

−

µ)

αt + ( ˆβn −

−

β)zγn

t−1ξt−1) (2.2)

Свяжем с ˆGn(x) из (2.2) еще одну о.э.ф.р.

Gn(x, τ1, τ2) =

n

X
t−1

I(εt ≤

x + n−1/2τ1ut−1 + n−1/2τ2

αt + n−1/2τ1zγn

t−1ξt−1),

−

и случайный процесс un(x, τ1, τ2) :=

n

n−1/2

[I(εt ≤

X
t=1

x + n−1/2τ1ut−1 + n−1/2τ2

αt + n−1/2τ1zγn

t−1ξt−1)

−

−

G(x + n−1/2τ1ut−1 + n−1/2τ2

αt + n−1/2τ1zγn

t−1ξt−1)].

−

Пусть сигма-алгебра

Ft := σ

{

εs, s

≤

t; ξi, zγn
i

, i

t + 1

.

}

≤

Тогда слагаемы в un(x, τ1, τ2) (при фиксированном n) образуют мартингал-разность
относительно последовательности

.

{Ft}

6

Далее 0 < Θ <

фиксированно,

Θ; 0

Γ <

, Γ фиксировано, γ

τi| ≤

|

≤

∞

∞

Утверждение теоремы 1.1 следует из следующих трех утверждений:

sup
|τi|≤Θ |

un(x, τ1, τ2)

un(x, 0, 0)

|

−

= oP (1), n

,

→ ∞

Γ.

≤

(2.3)

равномерно по γ

Γ;

≤

n−1/2

sup
|τi|≤Θ |

n

X
t=1

равномерно по γ

Γ;

≤

[G(x + n−1/2τ1ut−1 + n−1/2τ2

αt + n−1/2τ1zγn

t−1ξt−1)]

−

(2.4)

−

G(x

αt)]

−

−

g(x)τ2

|

= oP (1),

,

→ ∞

n−1/2

n

X
t=1

[I(εt ≤

x

−

αt)

I(εt ≤

−

x)]

−

γ∆(x, Π)

|

= oP (1), n

,

→ ∞

(2.5)

равномерно по γ
В самом деле, имеем тождество: n1/2[ ˆGn(x)

Γ c ∆(x, Π) = P

≤

1
j=0[G(x + βjξ1)

G(x)] с β0 =

1, β1 = β.

−

un(x, n1/2( ˆβn −

β), n1/2(1

−

µ)

−

un(x, 0, 0)+

(2.6)

n

n−1/2

[G(x+( ˆβn −

X
t=1

β)ut−1 +(1

ˆβn)(ˆµn −

−

µ)

αt +( ˆβn −

−

β)zγn

t−1ξt−1)

G(x

−

−

αt)]+ (2.7)

n−1/2

n

X
t=1

[I(εt ≤

x

−

αt)

I(εt ≤

−

x)].

(2.8)

Пусть (2.3) верно. Тогда при любых положительных δ, ε

sup
γ≤Γ

P(

un(x, n1/2( ˆβn −

|

β), n1/2(1

ˆβn)(ˆµn −

−

µ))

−

un(x, 0, 0)

> δ)

|

≤

−

Gn(x)] =

−
ˆβn)(ˆµn −

sup
γ≤Γ

P(

|

sup
γ≤Γ

un(x, n1/2( ˆβn −
n1/2( ˆβn −
β)
n1/2( ˆβn −
P( sup
sup
γ≤Γ

|
P((

|

β), n1/2(1

ˆβn)(ˆµn −

−

µ))

−

un(x, 0, 0)

> δ,

|

Θ,

n1/2(1

| ≤
β)

|
> Θ) + (

−
n1/2(1

ˆβn)(ˆµn −

µ)
| ≤
ˆβn)(ˆµn −

−

|

|

Θ)+

µ)

> Θ))

|

≤

|τi|≤Θ |

un(x, τ1, τ2)

−

un(x, 0, 0)

> δ)+

|
ˆβn)(ˆµn −

> Θ/2) < ε

µ)

|

sup
γ≤Γ

P((

n1/2( ˆβn −

|

β)

> Θ/2) + sup
γ≤Γ

|

n1/2(1

P(

|

−

при достаточно большом Θ > 0 для всех n > n0.

Значит, (2.6) есть oP (1) равномерно по γ

Γ.

≤

7

Соверщенно аналогично показывается: соотношение (2.4) влечет, что (2.7) есть

g(x)τ2 + oP (1) равномерно по γ

Γ.

≤

Наконец, в [2] показано, что верно (2.5).

Значит, (2.3)–(2.5) и (2.6)–(2.8) действительно влекут утверждение теоремы 1.1.

Итак, будем доказывать (2.3)-(2.4). Начнем с (2.3) и дискретной аппроксимации

un(x, τ1, τ2). Напомним, Θ, Γ фиксированы,

Θ, γ

Γ.

τi| ≤

≤
Θn−1/2, Θn−1/2] на 3mn частей (mn - натуральные числа,

|

Разобьём отрезок [

3mn

∼

ln n при n

→ ∞

−

) точками

ηs =

Θn−1/2 + 2Θn−1/23−mns, s = 0, 1, . . . , 3mn.

−

Пусть

ˆuts = ut[1

˜uts = ut[1

−

−

2Θn−1/23−mnη−1
2Θn−1/23−mnη−1

0)],

s I(ut ≤
s I(ut > 0)].

Берем любые τ1, τ2 из отрезка [
справа к n−1/2τ1, тогда

−

Θ, Θ]. Выберем из точек

ηs}

{

точку ηj, ближайшую

0

ηj −

≤

n−1/2τ1

≤

2Θn−1/23−mn.

Из введённых определений прямо следует:

ηj ˜ut−1,j ≤
ˆuts| ≤
|

n−1/2τ1ut−1
≤
˜uts| ≤
ut|
3

3

|

|

,

ηj ˆut−1,j,
ut|

|

.

Пусть ηi будет ближайшая справа к n−1/2τ2 точка среди

0

ηi −

≤

n−1/2τ2

≤

Ради краткости положим еще

. Тогда

ηs}

(2.9)

(2.10)

(2.11)

{
2Θn−1/23−mn.

µ±
t

:=

αt ±
−

n−1/2Θzγn

t−1|

ξt−1

.

|

При

τi| ≤
справедливы неравенства:

|

Θ в силу монотонности по y I(εt ≤

y) и G(y) и силу (2.9) и (2.11)

un(x, τ1, τ2)

un(x, 0, 0)

−

≤

n

n−1/2

[I(εt ≤

X
t=1

x + ηj ˆut−1,j + ηi + µ+
t )

−

G(x + ηj ˆut−1,j + ηi + µ+
t )

−

8

x

I(εt ≤
[G(x + ηj ˆut−1,j + ηi + µ+
t )

−

αt) + G(x

αt)]+

−

G(x + ηj ˜ut−1,j + ηi−1 + µ−

t )],

−

+n−1/2

n

X
t=1

и, аналогично,

n

n−1/2

[I(εt ≤

X
t=1

un(x, τ1, τ2)

un(x, 0, 0)

−

≥

x + ηj ˜ut−1,j + ηi−1 + µ−
t )

−

G(x + ηj ˜ut−1,j + ηi−1 + µ−
t )

−

x

I(εt ≤
[G(x + ηj ˆut−1,j + ηi + µ+
t )

−

αt) + G(x

αt)]

−

−

G(x + ηj ˜ut−1,j + ηi−1 + µ−

t )].

−

n−1/2

n

X
t=1

Из последних двух неравенств следует:

sup
|τi|≤Θ |

un(x, τ1, τ2)

−

un(x, 0, 0)

| ≤

n

n−1/2

max
j,i

|

[I(εt ≤

X
t=1

x + ηj ˆut−1,j + ηi + µ+
t )

−

G(x + ηj ˆut−1,j + ηi + µ+
t )

(2.12)

−

n

n−1/2

max
j,i

|

|

X
t=1

[I(εt ≤

I(εt ≤

x

−

αt) + G(x

αt)]

+

|

−

x + ηj ˜ut−1,j + ηi−1 + µ−
t )

−

G(x + ηj ˜ut−1,j + ηi−1 + µ−
t )

(2.13)

−

x

I(εt ≤
[G(x + ηj ˆut−1,j + ηi + µ+
t )

−

αt) + G(x

αt)]

+

|

−

G(x + ηj ˜ut−1,j + ηi−1 + µ−

t )].

(2.14)

−

n−1/2

max
j,i

n

X
t=1

Дискретная аппроксимаци завершена. Для доказательства соотношения (2.3) доста-

точно показать, что выражения в (2.12)-(2.14) есть oP (1), n
γ

Γ.

≤

, равномерно по

→ ∞

Лемма 2.1. Выражения (2.12)–(2.13) есть op(1) при n

→ ∞

равномерно по γ

Γ.

≤

Доказательство. Покажем, что (2.12) есть oP (1) равномерно по γ

(2.13) рассуждения аналогичны. Положим

Γ, для

≤

νt(j, i) := I(εt ≤

x+ηj ˆut−1,j +ηi+µ+
t )

−

G(x+ηj ˆut−1,j +ηi+µ+
t )

I(εt ≤

−

x

−

αt)+G(x

αt).

−

Тогда (2.12) есть

n

max
j,i

|

X
t=1

νt(j, i)

.

|

9

Пусть, как раньше, сигма-алгебра

последовтельность

νt(j, i),

{

Ft}

t; ξi, zγn
i
, t = 1, . . . , n, образует мартингал-разность. Значит,

Ft = σ

. Очевидно,

t + 1

εs, s

, i

≤

≤

}

{

последовательность центрированных и некоррелированных величин.

νt(j, i)

}

{

Далее воспользуемся известным неравенством: при x1, x2

R1

∈

I(ε1

E
|

≤

x1)

−

G(x1)

I(ε1

−

≤

x2) + G(x2)

2

|

≤ |

G(x1)

G(x2)

.

|

−

В силу этого неравенства, формулы Тейлора и и (2.10)

Eν2

t (j, i) = EE(ν2

t (j, i)/

Ft−1)

≤

E
|

G(x + ηj ˆut−1,j + ηi + µ+
t )

G(x

αt)

−

| ≤

−

G(x + µ+
t )

E
|

G(x

−

−
G(x + µ+
t )

E
|

αt)

+ sup
x

|

g(x)E
|

ηj ˆut−1,j + ηi| ≤

G(x

αt)

|

−

−

+ cn−1/2.

Здесь через c и далее через c1, c2, . . . обозначены константы, не зависящие от

n, j, i, t, γ.

В силу формулы полной вероятности с гипотезами

H00 = (zγn

0 = zγn

1 = 0), H10 = (zγn

0 = 1, zγn

1 = 0),

H01 = (zγn

0 = 0, zγn

1 = 1), H11 = (zγn

0 = zγn

1 = 1).

получаем:

G(x + µ+

t ))

E
|

G(x

−

αt)

= X
i,j

|

−

E
{

[G(x + µ+
1 )

G(x

αt)]/Hij}

−

−

P (Hij)

≤

c1n−1/2.

Значит, Eν2

t (j, i)

c2n−1/2, и

≤

E[n−1/2

n

X
t=1

νt(j, i)]2 = n−1

n

X
t=1

Eν2

t (j, i)

≤

c2n−1/2.

Отсюда, в силу нераенства Чебышева

P(max
j,i

|

n−1/2

n

X
t=1

νt(j, i)

|

> δ)

≤

X
j,i

n−1/2

P(

|

n

X
t=1

νt(j, i)

|

> δ)

≤

δ−2E[n−1/2

X
j,i

n

X
t=1

νt(j, i)]2

≤

c2δ−2(3mn + 1)2n−1/2 = o(1)

равномерно по γ

≤

Γ в силу выбора последовательности

mn}

{

. Лемма 2.1 доказана.

Лемма 2.2. Выражение в (2.14) есть op(1) при n

→ ∞

равномерно по γ

Γ.

≤

10

Доказательство леммы 2.2 лишь несущественными техническими деталями от-

личается от доказательства леммы 3.2 в [2], а потому опущено.

Итак, соотношение (2.3) доказано.

Лемма 2.3. Утверждение (2.4) справедливо.

Доказательство. При

τi| ≤

|

Θ в силу монотонности G(y) справедливы нера-

венства:

n−1/2

n

X
t=1

n−1/2

n

X
t=1

[G(x + n−1/2τ1ut−1 + n−1/2τ2

αt + n−1/2τ1zγn

t−1ξt−1)

−

G(x

αt)]

−

≤

−

n−1/2

n

X
t=1

[G(x + n−1/2τ1ut−1 + n−1/2τ2 + µ+
t )

G(x

αt)],

−

−

(2.15)

[G(x + n−1/2τ1ut−1 + n−1/2τ2

αt + n−1/2τ1zγn

t−1ξt−1)

−

G(x

αt)]

−

≥

−

n−1/2

n

X
t=1

[G(x + n−1/2τ1ut−1 + n−1/2τ2 + µ−
t )

G(x

αt)].

−

−

(2.16)

Для доказательства леммы достаточно показать, что (2.15) и (2.16) равнмерно по

γ

Γ,

τi| ≤

|

≤

Θ есть g(x)τ2 + oP (1). Докажем это для (2.15), для (2.16) рассуждение

аналогично. Итак, в силу формулы Тейлора (2.15) есть

n−1/2

n

X
t=1

[G(x + µ+
t )

G(x

−

−

αt)] + τ1n−1

n

X
t=1

g(x + µ+

t )ut−1 + τ2n−1

n

X
t=1

g(x + µ+

t ) + oP (1)

(2.17)

равнмерно по γ
но, O(n−1/2) равномерно по γ

τi| ≤

Γ,

≤

|

Γ,

τi| ≤

|

Θ.

≤

Θ, т.к. вторые члены в разложении Тейлора есть, очевид-

Первая сумма в (2.17) неотрицательна, ее среднее в силу формулы полной веро-

ятности с гипотезами Hij издоказательства леммы 2.1 равно

n1/2E[G(x + µ+

1 ))

G(x

−

−

α1)] =

1

X
i,j=0

n1/2E
{

[G(x + µ+
1 )

G(x

α1)]/Hij}

−

−

P (Hij) =

n1/2γn(1

−

γn)E[G(x + βξ0 + n−1/2Θ

n1/2γ2
n

E[G(x

−

ξ1 + βξ0 + n−1/2Θ

ξ0

)

|

|

−

G(x

ξ0

|

−

)

G(x + βξ0)]+

−

|
ξ1 + βξ0)] = o(1),

(2.18)

(2.19)

Γ. Действительно, (2.18) есть o(1) в силу теоремы Лебега, а

равномерно по γ
≤
(2.19) есть O(n−1/2) равномерно по γ
слагаемое в (2.17) есть oP (1) равномерно по γ

≤

Γ. Значит, в силу неравенства Чебышева 1-ое

Γ при n

.

→ ∞

≤

11

Вторая сумма в (2.17) при

τ1

|

| ≤

Θ не больше

Θn−1

n

X
t=1 |

g(x + µ+
t )

g(x)

ut−1

|

||

−

+ Θg(x)

n

n−1

|

ut−1

|

X
t=1

= oP (1)

(2.20)

равномерно по γ

Θ, т.к. среднее значение первого слагаемого в
(2.20) есть O(n−1/2) в силу формулы полной вероятности, а во втором слагаемом
n−1

| ≤

Γ,

≤

τ1

|

n
t=1 ut−1 = oP (1).
P

Наконец, третья сумма в (2.17) есть

τ2n−1

n

X
t=1

[g(x + µ+
t )

−

g(x)] + τ2g(x) = τ2g(x) + oP (1), n

,

→ ∞

(2.21)

равнoмерно по γ
слагаемого в (2.21) есть O(n−1/2) в силу формулы полной вероятности.

Θ, т.к. среднее от супремума по

| ≤

| ≤

Γ,

≤

τ2

τ2

|

|

Θ модуля 1-го

Лемма 2.3 доказана.

Итак, соотношения (2.3)–(2.5) доказаны, а потому теорема 1.1 полностью дока-

зана.

3 Доказательство теоремы 1.2.

Доказательство теоремы 1.2 проводится по той же схеме, что и теоремы 1.1. Дальше
имеют ф.р. An(x) из (1.7), ˆGn(x), G(x, τ1, τ2) топределяются так же, как в

p = 1,
Разделе 2. Введм случайный процесс uA

εt}

{

n (x, τ1, τ2) :=

n

n−1/2

[I(εt ≤

X
t=1

x + n−1/2τ1ut−1 + n−1/2τ2

αt + n−1/2τ1zγn

t−1ξt−1)

−

−

An(x + n−1/2τ1ut−1 + n−1/2τ2

αt + n−1/2τ1zγn

t−1ξt−1)].

−

Аналогично доказательству теоремы 1.1 утверждение теоремы 1.2 следует из следу-

ющих трех утверждений:

sup
|τi|≤Θ |

uA
n (x, τ1, τ2)

uA
n (x, 0, 0)

|

−

= oP (1), n

,

→ ∞

(3.1)

равномерно по γ

Γ;

≤

n−1/2

sup
|τi|≤Θ |

n

X
t=1

[An(x + n−1/2τ1ut−1 + n−1/2τ2

αt + n−1/2τ1zγn

t−1ξt−1)

−

−

12

An(x

αt)]

−

−

g0(x)τ2

|

= oP (1), n

,

→ ∞

(3.2)

равномерно по γ

Γ;

≤

n−1/2

n

X
t=1

[I(εt ≤

x

−

αt)

I(εt ≤

−

x)]

−

γ∆0(x, Π)

|

= oP (1), n

,

→ ∞

(3.3)

равномерно по γ

Γ c ∆0(x, Π) = P

1
j=0[G0(x + βjξ1)

−

≤

G0(x)] и β0 =

1, β1 = β.

−

Соотношение (3.1) доказывается так же, как соотношение (2.3), надо лишь в доказа-

тельстве (2.3) везде заменить ф.р. G(x) на ф.р. An(x). Разумеется, используется тот
факт, что при Условии (А) ф.р. An(x) дважды дифференцируема и обе производные
, откуда следует для строго стационар-
ограничены по n, x. Кроме того, supn
1 <
∞
Eu2
ног решения уравнения авторегрессии: supn
Справедливость соотношения (3.3) установлена в [6]. Докажем (3.2).

Eε2

1 <

∞

.

Лемма 3.1. Утверждение (3.2) справедливо.

Доказательство. При

τi| ≤

|

Θ в силу моотонности An(y) справедливы нера-

венства:

n−1/2

n

X
t=1

n−1/2

n

X
t=1

[An(x + n−1/2τ1ut−1 + n−1/2τ2

αt + n−1/2τ1zγn

t−1ξt−1)

−

An(x

αt)]

−

≤

−

n−1/2

n

X
t=1

[An(x + n−1/2τ1ut−1 + n−1/2τ2 + µ+
t )

An(x

αt)],

−

−

(3.4)

[An(x + n−1/2τ1ut−1 + n−1/2τ2

αt + n−1/2τ1zγn

t−1ξt−1)

−

An(x

αt)]

−

≥

−

n−1/2

n

X
t=1

[An(x + n−1/2τ1ut−1 + n−1/2τ2 + µ−
t )

An(x

αt)].

−

−

(3.5)

Для доказательства леммы достаточно показать, что выражения в (3.4) и (3.5) рав-

номерно по γ

Γ,

τi| ≤

|

≤

Θ есть g0(x)τ2 + oP (1). Докажем это для (3.4), для (3.5)

рассуждение аналогично. Итак, в силу формулы Тейлора (3.4) есть

n−1/2

n

X
t=1

[An(x+µ+
t )

An(x

−

−

αt)]+τ1n−1

n

X
t=1

an(x+µ+

t )ut−1+τ2n−1

n

X
t=1

an(x+µ+

t )+oP (1)

(3.6)

равнмерно по γ

Γ,

τi| ≤

|

≤

Θ. Здесь an(x) = A′

n(x).

Первая сумма в (3.6) есть oP (1) равномерно по γ

шенно аналогично доказательству соотношения
n

Γ, это показывается совер-

≤

n−1/2

X
t=1

[G(x + µ+
t )

G(x

−

−

αt)] = oP (1), n

,

→ ∞

13

установленного в доказательстве леммы 2.3.

Вторая сумма в (3.6) не больше

Θn−1

n

X
t=1 |

an(x + µ+
t )

an(x)

ut−1

|

||

−

+ Θan(x)

n

n−1

|

ut−1

|

X
t=1

= oP (1)

(3.7)

равномерно по γ
≤
O(n−1/2), а во втором слагаемом n−1

| ≤

Γ,

τ1

|

n
t=1 ut−1 = oP (1), .

P

Θ, т.к. среднее значение первого слагаемого в (3.7) есть

Наконец, третья сумма в (3.6) есть

τ2n−1

n

X
t=1

[an(x + µ+
t )

−

an(x)] + τ2an(x) = τ2g0(x) + oP (1), n

,

→ ∞

(3.8)

Γ,

Θ модуля первого
равнoмерно по γ
слагаемого в (3.8) есть O(n−1/2) в силу формулы полной вероятности, а an(x) =
g0(x) + o(1), n

Θ, т.к. среднее от супремума по

| ≤

| ≤

≤

τ2

τ2

|

|

.

→ ∞

Лемма 3.1 доказана.

Соотношения (3.1)–(3.3) проверены. Теорема 1.2 доказана.

Список литературы

[1] Martin B.D. and Yohai V.J. Inﬂuence functionals for Time Series. The Ann. of

Statist., 1986, v. 14, p. 781 –818.

[2] Boldin M.V., Petriev M.N. On the Empirical Distribution Function of Residuals in

Autoregression with Outliers and Pearson’s Chi-Square type Tests. Math. Methods

Statist., 2018, v. 27, No. 4, p. 1–17.

[3] Чибисов Д.М. К исследованию асимптотической мощности критериев согласия.

Теория вероятн. и ее примен., 1965, т. 10, в. 3, с. 460–478.

[4] Boldin M.V. On the Power of Symmetrized Pearson’s Type Test under Local

Alternatives in Autoregression with Outliers. http://arxiv.org/abs/2003.13072.

[5] Boldin M.V. On Symmetrized Pearson’s Type Test in Autoregression with Outliers:

Robust Testing of Normality. http://arxiv.org/abs/2003.07878.

[6] Boldin M.V. On the power of Pearson’s Chi-Square Tests under Local Alternatives in

Autoregression with Outliers. Math. Methods Statist., 2019, v. 28, No. 1, p. 57–65.

14

