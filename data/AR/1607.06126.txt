8
1
0
2

t
c
O
5
1

]

O
C
.
h
t
a
m

[

3
v
6
2
1
6
0
.
7
0
6
1
:
v
i
X
r
a

TWO PROBLEMS ON MATCHINGS IN SET FAMILIES – IN THE
FOOTSTEPS OF ERD ˝OS AND KLEITMAN

PETER FRANKL AND ANDREY KUPAVSKII

Abstract. The families
disjoint F1 ∈ F1, . . . , Fs
for all values n
≥
classical result of Kleitman.

q, s

≥

s

2[n] are called q-dependent if there are no pairwise
F1, . . . ,
⊂
q. We determine max
F1 ∪
s satisfying
s
∈ F
|
2. The result provides a far-reaching generalization of an important

+. . .+

|F1|

| ≤

. . .

Fs

|F

F

∪

|

[n]
k

F ⊂

The well-known Erd˝os Matching Conjecture suggests the largest size of a family

with no s pairwise disjoint sets. After more than 50 years its full solution is still not in
(cid:1)
sight. In the present paper we provide a Hilton-Milner-type stability theorem for the Erd˝os
Matching Conjecture in a relatively wide range, in particular, for n
(2 + o(1))sk with
o(1) depending on s only. This is a considerable improvement of a classical result due to
Bollob´as, Daykin and Erd˝os.

≥

(cid:0)

We apply our results to advance in the following anti-Ramsey-type problem, proposed
by ¨Ozkahya and Young. Let ar(n, k, s) be the minimum number x of colors such that in
any coloring of the k-element subsets of [n] with x (non-empty) colors there is a rainbow
matching of size s, that is, s sets of diﬀerent colors that are pairwise disjoint. We prove
a stability result for the problem, which allows to determine ar(n, k, s) for all k
3 and
n

1). Some other consequences of our results are presented as well.

sk + (s

1)(k

≥

≥

−

−

1. Introduction

Let [n] :=

1, 2, . . . , n
}
2[n] is called a family. For 0

{

F ⊂

For a family
. Note that ν(

, let ν(
)

F

n holds, unless

F
independence number or matching number of

∅ ∈ F

≤

F
F

be the standard n-element set and 2[n] its power set. A subset
denote the family of all k-subsets of [n].
) denote the maximum number of pairwise disjoint members of
. The fundamental parameter ν(
) is called the

n let

[n]
k

≤

≤

k

(cid:0)

(cid:1)

F

Let us introduce an analogous notion for several families.

.

F

Deﬁnition 1. Suppose that
Fs
are cross-dependent if there is no choice of F1 ∈ F1, . . . , Fs ∈ Fs such that F1, . . . , Fs are
pairwise disjoint.

n. We say that

F1, . . . ,

F1, . . . ,

Fs ⊂

2[n], where 2

≤

≤

s

Note that ν(

) < s is equivalent to saying that

are cross-dependent.

F

F1, . . . ,

Fs, where

Fi :=

F

for all i

[s],

∈

Example. Let n = sm + s

ℓ for some ℓ

[s]. Deﬁne

∈

−

˜
Fi :=

F
F

{
(
{

⊂
⊂

[n] :
[n] :

F
F

|
|

| ≥
| ≥

m
,
}
m + 1

,

}

1
ℓ

i < ℓ,
s.
i

≤

≤
≤

The research of the second author was supported by the grant RNF 16-11-10014.

1

 
 
 
 
 
 
) <

F

(2)

2

PETER FRANKL AND ANDREY KUPAVSKII

Then ˜

F1, . . . , ˜

Fs are easily seen to be cross-dependent.

One of the main results of the present paper is as follows.

Theorem 1. Choose integers s, m, ℓ satisfying s
and suppose that

2[n] are cross-dependent. Then

2, m

≥

≥

0 and ℓ

F1, . . . ,

s

Fs ⊂

|Fi| ≤

1)

(l

−

n
m

(cid:18)

(cid:19)

+ s

i=1
X

s

=

n
t

t≥m+1 (cid:18)
X

(cid:19) "

i=1
X

[s]. Set n = sm + s

∈

˜
.
Fi|#

|

ℓ

−

(1)

Inequality (1) extends the following important classical result of Kleitman.

Theorem (Kleitman, [20]). Let s
s. Then for n = s(m + 1)

ℓ we have

≥

2 be an integer and

2[n] a family satisfying ν(

F ⊂

−

ℓ

1

−
s

n
m

+

|F | ≤

n
t

.
(cid:19)

In the case n = s(m + 1)

(cid:19)
1 the families ˜
Fi from the example above are all the same,
and thereby the bound (2) is best possible. It is also best possible for ℓ = s, as the following
example due to Kleitman shows:

t≥m+1 (cid:18)
X

−

(cid:18)

:=

K

[sm] :

K

|

| ≥

⊂

m + 1

∪

[sm

−
m

1]

.

(cid:19)

(cid:18)

K
= s−1
s

(cid:0)

(cid:1)

(cid:0)

(cid:1)

(Note that
easy statement was proved already by Erd˝os, Ko and Rado [6].

(cid:8)
.) In the case s = 2 the bound (2) reduces to

sm−1
m

sm
m

(cid:9)

2n−1. This

|F | ≤

Although (2) is a beautiful result, it has no matching lower bound for n

1(mod s).
For s = 3 the exact answer for the only remaining residue class was given by Quinn [25].
Recently, we made some further progress [11, 12] and in particular completely resolved the
case n

2(mod s).

0 or

6≡

−

Let us mention that, except the case s = 3 and ℓ = 2, an extension of the methods used
by Kleitman in [20] is suﬃcient to prove Theorem 1. However, for that single case it does
not seem to work. This forced us to ﬁnd a very diﬀerent proof. It is given in Section 3.
We proved related results reﬁning the method developed in the present paper, see [10, 12, 13].

≡ −

Next we discuss a generalization of the notion of cross-dependence.

s

≤

n and q

2[n]
Deﬁnition 2. Let 2
are called q-dependent if there are no pairwise disjoint F1 ∈ F1, . . . , Fs ∈ Fs satisfying
F1 ∪
|
For q = n the notion of q-dependence reduces to that of cross-dependence. Quite surpris-
for q-dependent families

[n] be ﬁxed integers. The families

F1, . . . ,

Fs| ≤

+ . . . +

Fs ⊂

. . .

≤

q.

∈

∪

ingly, one can determine the exact maximum of
F1, . . . ,
Let s

2[n] and all values of n, q, s.

[s]. If n

0 and ℓ

2, m

q := sm + s

|F1|

|Fs|
ℓ, then one can deﬁne

≥

∈

−

Fs ⊂
≥

˜
n,q
i
F

:=

F
F

{
(
{

⊂
⊂

F
F

|
|

| ≥
| ≥

m
,
}
m + 1

,

}

1
ℓ

i < ℓ,
s.
i

≤

≤
≤

(3)

≥
[n] :
[n] :

TWO PROBLEMS ON MATCHINGS IN SET FAMILIES – IN THE FOOTSTEPS OF ERD ˝OS AND KLEITMAN3

In Section 3 we prove the following generalization of Theorem 1. It follows by induction
from Theorem 1, which serves as the base case.

Theorem 2. Choose integers s, m, ℓ satisfying s
q. If
and suppose that n

0 and ℓ
2, m
2[n] are q-dependent, then

≥

≥

[s]. Put q = sm + s

∈

F1, . . . ,

≥
s

|Fi| ≤

(ℓ

−

i=1
X

Fs ⊂
n
m

(cid:18)

(cid:19)

1)

n

+ s

t=m+1 (cid:18)
X

n
t

(cid:19) "

=

s

i=1
X

˜
n,q
i
F

|

.
|#

ℓ

−

(4)

1.1. A Hilton-Milner-type result for the Erd˝os Matching Conjecture. The Kleit-
man Theorem was motivated by a conjecture of Erd˝os (see [20]). Erd˝os [4] himself studied
the uniform case, i.e., the families

. Let us make a formal deﬁnition.

[n]
k

F ⊂

Deﬁnition 3. For positive integers n, k, s satisfying s

(cid:1)

(cid:0)

2, n

≥

≥

ks, deﬁne

ek(n, s) := max

:

F ⊂

[n]
k

(cid:18)

, ν(

(cid:19)

F

) < s

.

o

|F |

n

Note that for s = 2 the quantity ek(n, s) was determined by Erd˝os, Ko and Rado.

Theorem (Erd˝os-Ko-Rado [6]).

ek(n, 2) =

n
k

−
−

(cid:18)

1
1

(cid:19)

for

n

2k > 0.

≥

(5)

3 is much harder. There are several natural examples of families
) = s for n

(s + 1)k. Following [7], for each i

A ⊂

[k] let us deﬁne the families
(cid:1)

(cid:0)

∈

≥

[n]
k

The case s
satisfying ν(
(k)
i (n, s) :

≥
A

A

(k)
i (n, s) :=

A

A

[n]
k

(cid:18)

(cid:19)

∈

Note that

(k)
1 (n, s)

=

n
k

−
(cid:1)
Conjecture 1 (Erd˝os Matching Conjecture [4]). For n

|A

(cid:0)

(cid:1)

(cid:0)

|

(cid:12)
(cid:12)

n
n−s
k

.

:

A

∩

[(s + 1)i

1]

−

≥

i

.

o

(6)

(cid:12)
(cid:12)

(s + 1)k we have

≥

ek(n, s + 1) = max

(k)
1 (n, s)

,

(k)
k (n, s)

.

|A
The conjecture (7) is known to be true for k
results of [4], [2], [17] and [15], the ﬁrst author [8] proved

|
3 (cf.

≤

(cid:8)

|A
[5], [23] and [9]). Improving earlier

(cid:9)

|

(7)

ek(n, s + 1) =

n
k

−

n

−
k

s

for

n

(2s + 1)k

s.

(8)

≥

−

(cid:18)

(cid:19)

(cid:18)

(cid:19)
In the forthcoming paper [14], we improve this bound for large s. We note that the conjecture
is related to several questions in combinatorics, probability and computer science, cf. [1, 26].
In the case s = 1, corresponding to the Erd˝os-Ko-Rado theorem, one has a very use-
ful stability theorem due to Hilton and Milner [16]. Below we discuss it and its natural
generalization to the case s > 1.

4

PETER FRANKL AND ANDREY KUPAVSKII

Let us deﬁne the following families.

H

(k)(n, s) :=

H

n

[n]
k

(cid:19)

∈

(cid:18)

: H

∩

[s]

=

∪

∅

o

[s + 1, s + k]

−

(cid:8)
[n]
k

(cid:9)
[s] =

: H

∩

, H

s

}

{

∩

[s + 1, s + k] =

H

∈

(cid:18)

n
sk and

(cid:19)

s

∅

.

o

(9)

Note that ν(

H

(k)(n, s)) = s for n

≥

(k)(n, s)

=

|

|H

n
k

−

n

−
k

+ 1

−

(cid:18)

(cid:19)
) of a family

(cid:19)

(cid:18)
is the minimum of

(cid:18)

n

s

k

−
1

.
(cid:19)
over all T

−
k

−
T

|

|

. Recall the deﬁnition (6). The equality τ (

⊂

[n] satisfying
(k)
1 (n, s)) = s for
(k)(n, s)) = s + 1 and

A

k + s, then τ (

H

≥

=

for all H

The covering number τ (
T
n
τ (

H
k + s is obvious. At the same time, if n
(k)
i (n, s)) > s for each i

∩
≥
A
Let us make the following conjecture.

H
∈ H

H

≥

2.

∅

Conjecture 2. Suppose that

[n]
k

satisﬁes ν(

) = s, τ (

F

F

F ⊂

) > s. Then

max

|F | ≤

(cid:0)
(cid:1)
(k)
i (n, s)

|

: i = 2, . . . , k

,

(k)(n, s)

|

|H

|A

.

(10)

n(cid:8)
(k)
i (n, s)

One can verify that

k. Modulo this
| ≤
(k)
,
1 (n, s)
veriﬁcation, Conjecture 2 implies Conjecture 1: indeed, we have
(cid:9)
|
and so the maximum on the right hand side of (10) is at most the maximum on the right
hand side of (7). The Hilton-Milner theorem shows that (10) is true for s = 1.

∈
(k)(n, s)

for any i

| ≤ |A

max

|H

|A

|A

|A

(cid:8)

|

|

,

(k)
1 (n, s)

(cid:9)
(k)
k (n, s)

o

Theorem (Hilton-Milner [16]). Suppose that n > 2k and let
ν(

) = 1 and τ (

2. Then

)

F

F

≥

be a family satisfying

F ⊂

[n]
k

(cid:0)

(cid:1)

|F | ≤ |H
We mention that for n > 2sk the maximum on the RHS of (10) is attained on

|

For n > 2k3s, (10) was veriﬁed by Bollob´as, Daykin and Erd˝os [2].

Our second main result is the proof of (10) in a much wider range.

(k)(n, s)

.

|

|H

(k)(n, 1)

.

Theorem 3. Suppose that k
≥
where o(1) is with respect to s

3 and either n

(s + max

. Then for any

≥

→ ∞

25, 2s + 2
}
{
[n]
with ν(
k
G

)k or n

≥

) = s < τ (
(cid:0)

G

2 + o(1)

sk,
) we have

(cid:1)

|G| ≤ |H

(k)(n, s)

.

|

G ⊂

(cid:0)

(cid:1)

We prove Theorem 3 in Section 2. We note that stability results for the Erd˝os Match-
ing Conjecture [3], as well as some important progress for a much more general class of
Turan-type problems [19] were obtained recently. However, these results deal with the case
n > f (s)
k, where f (s) is a fast growing function depending on s. Some other Hilton-
Milner-related stability results were recently proven in [21] for n > n0(s, k).

·

6
6
TWO PROBLEMS ON MATCHINGS IN SET FAMILIES – IN THE FOOTSTEPS OF ERD ˝OS AND KLEITMAN5

Let us recall the method of left shifting (or simply shifting). For a given pair of indices
2[n] we deﬁne the (i, j)-shift Si,j(A) of A in the following way.

n and a set A

i < j

1

≤

≤

∈

Si,j(A) :=

A
(A

(

if i
∈
if i /
∈

A or
A and j

j /
∈
∈

A;
A.

j

)

i
}

− {

}

∪ {
) of a family

Next, we deﬁne the (i, j)-shift Si,j(

F

2[n]:

F ⊂

We call a family

F

Si,j(

) :=

Si,j(A) : A

F

{

shifted, if Si,j(

) =

F

F

∈ F } ∪ {
for all 1

A : A, Si,j(A)

.

∈ F }

i < j

n.

≤

≤

2. Proof of Theorem 3

For s = 1 the theorem follows from the Hilton-Milner theorem, therefore we may assume

that s

≥

2. Choose an integer u such that

(u + s)(k

1) + s + 1

n < (u + s + 1)(k

1) + s + 1.

−

−
≤
satisfying the requirements of the theorem.

Consider a family

G

(11)

is shifted.
2.1. The case of shifted
G
F1, . . . ,
Following [8], we say that the families
⊃ Fs+1. The
following lemma is a crucial tool for the proof and may be obtained by a straightforward
modiﬁcation of the proof of [8, Theorem 3.1]:

. First we prove Theorem 3 in the assumption that
. . .
Fs+1 are nested if

F1 ⊃ F2 ⊃

G

Lemma 4 (Frankl [8]). Let N
F1, . . . ,

Fs+1 ⊂

[N ]
k−1

1) for some u
are cross-dependent and nested. Then

(u + s)(k

≥

−

∈

Z, u

≥

s + 1, and suppose that

(cid:0)

(cid:1)

+

|F1|

|F2|

+ . . . +

+ u

|Fs|

s

|Fs+1| ≤

(cid:18)
2[n], all p

N

1

.
(cid:19)
−
[n] and Q

(12)

[p] deﬁne

⊂

k

∈

We use the following notation. For a family

G ⊂

The ﬁrst step of the proof of Theorem 3 is the following lemma.

(cid:8)

(cid:9)

(Q, p) :=

G

Q : G

, G

∩

∈ G

\

[p] = Q

.

G

Lemma 5. Assume that
[s]. Then
x for some x

∈

|G|−|G

, s)

(

∅

| ≤

n
k

−

n−s
k

−

C for some C > 0 and that ν(

, s)) =

(

∅

G

(cid:0)

(cid:1)
n

−

(cid:18)

(cid:0)

(cid:1)

s

−
k

−

(cid:19)

n
k

(cid:19)

(cid:18)

|G| ≤

u

−

x
u

1

C.

−

Moreover, if ν(

(

∅

G

, s)) = τ (

(

∅

G

, s)) = 1, then

|G| ≤

n
k

(cid:18)

(cid:19)

n

−

(cid:18)

s

−
k

−

(cid:19)

1

C.

u

−
u

(13)

(14)

6

PETER FRANKL AND ANDREY KUPAVSKII

Proof. Recall the deﬁnition of the immediate shadow of a family

:=

H :

∂

H

, H

H ′
∃
∈ H
, s + 1) since

H ′,

H ′

|

H

|

\

⊂

(

∅

G

, s + 1)

(cid:8)
s + 1
We have ∂
author proved the inequality x
∂
|
shiftedness of
(
we get that

, we also have

⊂ G

G

G

{

(

}
H| ≥ |H|
, s + 1) =
∅

G
, valid for any
(

is shifted. In [8, Theorem 1.2] the ﬁrst
x. Due to the
)
, s)) = 1. Combining these three facts,

with ν(

if τ (

H

H

≤

(cid:9)

:

.

(15)

H
= 1

(

, s + 1)

|G

|G
, s)) > 1 and x′ = 0 if τ (

| ≤

∅

{
(

(

s + 1

, s + 1)

,

}

|

, s)) = 1. Consequently,

where x′ = x if τ (

(

∅

G

|G
Using (16) and (12), we have

, s)

(

∅

| ≤

(x′ + 1)

|G

G

∅
(

s + 1

}

, s + 1)

.

|

{

(16)

(17)

G

∅

∅

x′

s+1

i=1 |G

(

i
}

{

, s + 1)

+

G(

|

∅

|

, s + 1)

| ≤

X

For any Q

[1, s + 1],

Q

2, we have

| ≥

. We also have

⊂

|
(k)
1 (n, s)(Q, s+1)
n−s−1
k−1

.

|

1)
1)

| ≤ |A
= s
|
(cid:0)
Therefore,

s

i=1
X
s

≤

A

x′

(

i
}

{

|G

, s + 1)

|

+ (x′ + 1)

s + 1

(

{

|G

}

, s + 1)

| ≤

n

s

1

−
k

−
1

(cid:19)

−

(cid:18)
(k)
1 (n, s)(Q, s + 1)
, s+1) =

|A
(k)
1 (n, s)(

|

∅

−

=

(u

−

x′

1)

(

{

|G

−

s + 1

}

, s + 1)

.

|

[s+2,n]
k−|Q|

, and thus
|G
(k)
1 (n, s)(

s+1
(cid:1)
i=1 |A

(Q, s +

, s+

i
}

{

and
(cid:0)

∅

P
(17)

(k)
1 (n, s)

(cid:1)
|A

. On
1)
the other hand, the inequality in the assumptions of the lemma may be formulated as
. Adding these two inequalities (the second one multiplied
(cid:3)

| − |G| ≥

, s + 1)

s + 1

u−x′−1

(k)
1 (n, s)
|A
by u−x′−1

− |G
| − |G| ≥
x′+1 ), we obtain that

, s)
|
(k)
1 (n, s)

u C.

, s)

(u

|G

−

−

≥

C

∅

{

}

(

(

(

|

|

u−x′−1
x′+1 |G

∅
|A

| − |G| ≥

Now, to prove Theorem 3, it is suﬃcient to obtain good bounds on C from the formu-
lation of Lemma 5. We do that in the next two propositions. We use the following simple
observation:

Observation 6. If for some C > 0, S
S

C, then both

, s)

(

[s] and
n−s
S
k−1

⊂
≤ |

[s+1,n]
k−1

B ⊂
−

C and
(cid:0)

i
}

|

i∈S

||B| −
(cid:12)
We are going to use the next proposition and lemma for the case ν(
(cid:12)
, s) contains x pairwise disjoint sets F1, . . . , Fx for some x

|G| − |G

G
(cid:12)
(cid:12)

P

∅

{

(cid:1)

(cid:0)

(

|

G
∅
[s]. Put

P
| ≤
(

(cid:1)

that

we have
(

, s)

i∈S

G

∅

(

{
−

G
n
(cid:12)
k
(cid:12)
(cid:0)
(cid:1)
, s))
≥
Bj :=

i
}

, s)
n−s
k

∩ B
≤
C.
(cid:12)
−
(cid:12)

(cid:0)
(cid:1)
2. Assume
[s+1,n]\Fj
.
k−1

∈

(cid:1)
Proposition 7. Under the assumption above, choose a positive integer q and integers 0 =:
j=1(pj −
p0 < p1 < p2 < . . . < pq := x. Put f :=
s
n
k
1

(cid:0)
k−1 we have

pj−1). Then for u

qf + q−1

Q
s

(18)

, s)

pj+1

q−1

≥

q

i
}

Bz

−

≤

{

(

.

s

q

i=1
X

G
(cid:12)
(cid:12)

(cid:12)
(cid:12)

−
−

(cid:18)

(cid:19)

j=0(cid:16)
\

z=pj+1
[

(cid:12)
(cid:12)
(cid:12)

(cid:17)(cid:12)
(cid:12)
(cid:12)

TWO PROBLEMS ON MATCHINGS IN SET FAMILIES – IN THE FOOTSTEPS OF ERD ˝OS AND KLEITMAN7

Proof. For each i

[s] denote

∈

q−1

pj+1

(

i
}

{

I

, s) :=

(

i
}

{

G

, s)

∩

Assume that

we have

s

(

{

|I

−

q +1

, s)

|

}

= y. Then, since

Bz

z=pj+1
[
, s)

j=0(cid:16)
\
i
(
}

I

{

⊃ I

s

i=s−q+1
X

(

i
}

{

|I

, s)

| ≤

qy.

.

(cid:17)
(

{

i+1

}

, s) for any i

1],

[s

−

∈

(19)

Applying Observation 6 with S = [s

q + 1, s] and

−

=

B

q−1

q−1
j=0

T

pj+1

(cid:16)S

pj+1
z=pj+1 Bz

(cid:17)

, we get

s

i=s−q+1
X
(cid:12)
(cid:12)

Note that
pj+1

q−1

(

s

G

{

−

q + 1

, s)

}

∩ Bz

z=pj+1
[
(

j=0(cid:16)
\
Since
that there exist a choice of z′

q + 1

, s)

|I

−

}

{

s

|

(cid:12)
(cid:12)

=

(

i
}

{

G

, s)

q

≤

n
k

(cid:18)

s
1

−
−

(cid:19)

q

−

z=pj+1
[

j=0(cid:16)
(cid:12)
\
(cid:12)
(cid:12)

p1

p2

pq

. . .

+ qy.

(20)

Bz

(cid:17)(cid:12)
(cid:12)
(cid:12)
q−1

(

s

G

{

−

q + 1

, s)

}

∩ Bzj

.

(cid:17)

zq−1=pq−1+1 (cid:16)
(cid:17)
[
= y, by the pigeon-hole principle from the equality above we infer

z0=p0+1
[

z1=p1+1
[

j=0
\

[pq−1 + 1, pq], such that

0 ∈

[p0 + 1, p1], . . . , z′

q−1 ∈
q−1

s

(

{

G

−

q + 1

, s)

}

∩

Bz′

j

j=0
\

(cid:12)
(cid:12)
(cid:12)

(cid:12)
(cid:12)
(cid:12)

y
f

.

≥

(21)

s

1

}

{

}

{

Gz(

, s), . . . ,

, s), where

Next, the families

j ,
q+1
Gz(
j=0 Bz′
−
are cross-dependent and nested. Indeed, if the families are not cross-dependent, and there
, s) that are pairwise disjoint, then
, s), . . . , Gs−q+1 ∈ Gz(
exist G1 ∈ Gz(
1
}
{
G1, . . . , Gs−q+1, Fz′
0, . . . , Fz′
,
where S′ := [s + 1, n]
qk. We have
(cid:1)
∪
−
q−1
u′ := u
= (u′ + s
1). Thus, we
k−1 ≥
≥
−
q playing the roles of u, N, s, respectively. From (12) and
may apply (12) with
the inequality u′ = u

s
{
q−1 form an (s + 1)-matching in

T
j=0 Bzj =
−
−

(Fz′
. . .
q + 1 since u
S′

Fz′
), and
s + 1. Moreover,

, s
f q we get

G
= (u + s)(k

1) + 1
T
q)(k

. Note that

, s) :=

q + 1

Gz(

S′
k−1

i
}

i
}

0 ∪

, s)

S′

S′

q−1

−

−

−

−

q−1

∩

G

{

{

}

\

s

(cid:0)

(

|

|

|

|

q−1

u′
⌊
−

,
⌋
|
|
q−1
k−1 ≥

|Gz(

{

1

}

, s)

|

+ . . . +

|Gz(

{

s

, s)

q

}

|

−

+ f q

|Gz(

{

s

−

q + 1

, s)

}

| ≤

(s

−

q)

which, in view of (21), gives us

s−q

i=1
X

|Gz(

{

i
}

, s)

| ≤

(s

−

q)

q−1

j=0
\

(cid:12)
(cid:12)

qy.

Bzj

−

(cid:12)
(cid:12)

q−1

j=0
(cid:12)
\
(cid:12)
(cid:12)

Bzj

,

(cid:12)
(cid:12)
(cid:12)

(22)

(23)

8

PETER FRANKL AND ANDREY KUPAVSKII

Applying Observation 6 with S = [1, s

q] and

=

B

−

s−q

i=1
X

G
(cid:12)
(cid:12)

, s)

(

i
}

{

(s

q)

−

≤

(cid:12)
(cid:12)

q−1

j=0 Bzj , we get
s
1

qy.

−

(cid:19)

T
n
−
k
−

(cid:18)

We get the statement of the proposition by summing up (20) and (24).

(24)

(cid:3)

The main diﬃculty in using Proposition 7 directly is that it is very diﬃcult to deal with
sums/products of binomial coeﬃcients that arise when writing down the subtrahend in (18)
explicitly. The proof of the following lemma is a way to work around it. The lemma itself is
an important technical ingredient in establishing bounds on u in Theorem 3.

Lemma 8. Assume that ν

s

(cid:0)

where

(i) γ = 4
3
(iii) γ = 16
9
(v) γ = Ω(x/ log2

, s)

(

∅

G

≥

x for x

n
k

(cid:1)
, s)

(

i
}

{

s

≤

G
(cid:12)
(cid:12)

(cid:18)
i=1
X
(cid:12)
(cid:12)
for x = 2
and u
for x = 4, 5 and u

∈
s
1

−
−
3,
9,

≥
≥
2x.

2 x)

for u

≥

[s]. Then we have

n

γ

k

−
k

−
1

s

,

−

(cid:19)

(cid:18)

−
(ii) γ = 3
(iv) γ = 2 for x

(cid:19)
2 for x = 3 and u
6 and u

≥

(25)

5,
25,

≥
≥

n−s
k−1

Proof. The logic of the proofs of all ﬁve statements is similar. We combine the bounds from
Proposition 7 with diﬀerent parameters to get the bound of the form β
≤
for the smallest possible β. Then the constant γ from the statement of
βs
Lemma 8 is deﬁned as γ := x/β. Since
for any z, we get the statement, as long
|Bz|
as we can guarantee the bounds on β we claim. Therefore, we aim to ﬁnd a linear combination
(cid:0)
of equations (18) with coeﬃcients βj, which satisﬁes the following two conditions:

x
z=1 |Bz|

n−k−s
k−1

G
(cid:12)
(cid:12)

s
i=1

i
}

, s)

P

P

−

=

(cid:12)
(cid:12)

{

(cid:1)

(cid:1)

(cid:0)

(

a) the sum of the subtrahends in the RHS is at least

b) β :=

βj is as small as possible.

For any S

⊂

[x] we introduce the following notation:

X

x

z=1
X

,

|Bz|

(26)

(27)

Bj :=

Bj

\

.

Bj

(cid:17)
(Note that this deﬁnition depends on x, but the value of x will be clear from the context.)
Consider the following inclusion-exclusion-type decomposition:

(cid:17)

(cid:16) [j∈[x]\S

j∈S
(cid:16) \

j∈S
\

x

x

=

|Bz|

+

Bz

|Bz1∩Bz2|

+ 2

3
j=1Bzj

+ . . . + (x

1)

−

x
j=1Bj

. (28)

(cid:12)
(cid:12)
(cid:12)

(cid:12)
(cid:12)
(cid:12)

z=1
[

X1≤z1<z2≤x

z=1
X
The cardinalities of intersections in (28) are determined by the number of intersecting
families, but do not depend on the actual families that are intersecting. The number of
summands of the form
for any

X1≤z1<z2<z3≤x (cid:12)
\
(cid:12)
(cid:12)

, multiplied by the coeﬃcient (ℓ

1), is (ℓ

(cid:12)
\
(cid:12)
(cid:12)

1)

(cid:12)
(cid:12)
(cid:12)

(cid:12)
(cid:12)
(cid:12)

−

−

x
ℓ

ℓ
j=1Bzj

(cid:12)
(cid:12)T

(cid:12)
(cid:12)

(cid:0)

(cid:1)

TWO PROBLEMS ON MATCHINGS IN SET FAMILIES – IN THE FOOTSTEPS OF ERD ˝OS AND KLEITMAN9

ℓ

2
size by αℓ. Putting ηℓ := (ℓ

x. We call each of the families of the form
ℓ

for each 2

1)

≤

≤

ℓ

j=1Bzj an ℓ-intersection. We denote its
x, we can rewrite (28) as

x

T
≤

+

ηℓαℓ.

(29)

−

x
ℓ

x
(cid:0)

z=1
X

x

=

(cid:1)
|Bz|

≤

Bz

z=1
[

(cid:12)
(cid:12)
(cid:12)

(cid:12)
(cid:12)
(cid:12)

Xℓ=2

Each subtrahend in (18) also admits a unique decomposition into l-intersections, analogous
In the proof of each part of Lemma 8 we
to (28) (we will see some examples below).
guarantee (26) by ﬁnding the linear combination of (18) with diﬀerent parameters, such
that the resulting subtrahend has the form

x

x

Bz

z=1
[

+

η′
ℓαℓ,

(30)

Xℓ=2

ℓ

(cid:12)
(cid:12)
(cid:12)

≤

ℓ ≥

ηℓ for each 2

(cid:12)
(cid:12)
where η′
x. In particular, the term
is always “covered” by
(cid:12)
the subtrahend in (18) with q = 1, taken with coeﬃcient 1. For each member of the linear
.
combination we use the following notation:
Since the proofs of (i)–(iv) are almost identical, we present the proofs of (i) and (iv) only.
(cid:3)
. We

(cid:12)
parameters substituted in (18); the coeﬃcient
(cid:12)

We start with (i). We sum up
note that for the latter member of the linear combination (18) gives

q = 2, p1 = 1; coeﬃcient 1
2

q = 1; coeﬃcient 1

x
z=1 Bz

with

S

≤

(cid:12)
(cid:12)

(cid:2)

(cid:3)

(cid:2)

(cid:3)

G
(cid:12)
(cid:12)
Returning to the linear combination, we get the inequality

i=1
X

≤

−

(cid:19)

(cid:18)

(cid:12)
(cid:12)

{

, s)

i
}

s

n
k

s
1

−
−

2

B1 ∩ B2
(cid:12)
(cid:12)
(cid:12)

.

(cid:12)
(cid:12)
(cid:12)

s

(cid:2)

(

s

3
2

i=1
[

(cid:12)
(cid:12)
(cid:12)
3/2 = 4

, s)

(

i
}

{

G

3
2

s

n
k

(cid:18)

s
1

−
−

−

(cid:19)

≤

(cid:12)
(cid:12)
(cid:12)

−

B1 ∪ B2
(cid:12)
(cid:12)

(cid:12)
(cid:12)

B1 ∩ B2
(cid:12)
(cid:12)

(cid:12)
(cid:12)

=

3
2

s

n
k

(cid:18)

s
1

−
−

(cid:19)

− |B1| − |B2|

.

The condition on u, imposed by the application of (18), is satisﬁed for u
γ = 2
3 for this linear combination. This concludes the proof of (i).

3. It is clear that

≥

,

, and

q = 1; coeﬃcient 1

The proof of (iv) is more cumbersome.

It is suﬃcient to verify (iv) for x = 6. Take
,
the following linear combination:
q = 3, p1 = 2, p2 = 4; coeﬃcient 1
q = 6, pi = i for i = 0, . . . , 6; coeﬃcient
3
(cid:3)
(cid:2)
1
2 + 1
. First, it is clear that for this combination we have β = 1 + 3
6 = 3, and thus
6
(cid:2)
γ = x/β = 2. Moreover, it is easy to see that the condition on u, imposed by the applications
(cid:3)
of (18), is u
25 and comes from the third summand. Therefore, we are left to verify that
the corresponding η′
6.

q = 2, p1 = 3; coeﬃcient 3
2

≤
For x = 6, the value of ηℓ is 15, 40, 45, 24, 5 for ℓ = 2, . . . , 6, respectively. Next, we ﬁnd
ℓ. As it is not diﬃcult to check, the subtrahends in (18) with q = 2, p1 = 3,

the values of η′
q = 3, p1 = 2, p2 = 4 and q = 6, pi = i for i = 0, . . . , 6, respectively, have the form

ℓ satisfy η′

ηℓ for each 2

3 + 1

ℓ ≥

≤

≥

(cid:3)

(cid:3)

(cid:2)

(cid:2)

ℓ

(q = 2)

(q = 3)

(q = 6)

18α2+36α3 + 30α4 + 12α5+2α6;
24α3 + 36α4 + 18α5+3α6;
6α6.

(31)

(32)

(33)

10

PETER FRANKL AND ANDREY KUPAVSKII

6, put
Let us elaborate on how do we obtain (31). For 2
1,
ℓ=2 Cℓ. One can easily check that
ℓ = 2, . . . , 6, respectively. The subtrahend in (18) has the form

[4, 6]

and

| ≥

:=

≤

≤

C

∩

C

1

ℓ

|

6

Cℓ :=
Cℓ|
|

[6]
ℓ

C

C

:
| ≥
|
equals 9, 18, 15, 6, 1 for
(cid:8)

[3]

∩

∈

(cid:0)

(cid:1)

(cid:9)
B1 ∪ B2 ∪ B3)

2

(

|

S
B4 ∪ B5 ∪ B6)

|

(

∩

= 2

= 18α2 + 36α3 + 30α4 + 12α5 + 2α6.

Bi

C∈C (cid:12)
i∈C
(cid:12)
X
\
(cid:12)
(cid:12)
3, 1
2, 1
Summing up (31), (32), (33) with coeﬃcients 3
(cid:12)
(cid:12)
6, respectively, we get the expression
6
ℓ=2 ηℓαℓ, as claimed. The proof of
27α2 + 62α3 + 57α4 + 24α5 + 5α6, which is bigger than
(iv) is complete. (We note that the choice of the coeﬃcients, and thus the bound on γ, is
clearly not optimal. It is however suﬃcient for our purposes.)

P

The proof of (v) is the most technical. Since we can always replace x by any smaller
positive integer, we assume for simplicity that x = 2r for some positive integer r, at the
expense of factor 2 that goes into the Ω-notation. Consider the following linear combination:

Mj :=

q(j) = 2j, pi(j) = ix/q(j) for i = 0, . . . , q(j); coeﬃcient 4(j+2)

, where j = 0, . . . , r.

(cid:2)
The union of all

First we verify that the linear combination above has enough ℓ-intersections for each ℓ.

(cid:3)

Let us determine, how many diﬀerent ℓ-intersections are contained in the family

Bz is given by M0. For larger ℓ we need to do an auxiliary calculation.

q(j)−1

pi+1(j)

i=0 (cid:16)
\

[z=pi(j)+1

Bz

.

(cid:17)

(34)

≥

For ℓ
above form the family
1

q(j), the ℓ-subsets of [x] corresponding to the ℓ-intersections contained in the family

Cℓ(j) :=

C

[x]
ℓ

−
(cf. the considerations after (33)). We can bound the number of such ℓ-intersections from
q(j) log2(2q(j)) this is at
n
diﬀerent ℓ-
ℓ

−
. We conclude that the family (34) contains more than 1
2

q(j)e−ℓ/q(j)

q(j)−1
q(j)

. For ℓ

q(j)

(cid:0)
x
ℓ

(cid:1)
1

⊂

−

≥

≥

∩

(cid:17)

(cid:8)

∅

ℓ

(cid:0)

(cid:1)(cid:0)

(cid:1)

(cid:0)

(cid:1)

: C

[pi(j)+1, pi+1(j)]

=

for all i = 0, . . . , q(j)

q(j) log2(2q(j)) = 2j(j + 1).

(cid:0)

(cid:1)

ℓ). Next, for each ℓ

Since the subtrahend in Mj is the size of the family (34) multiplied by the factor 2j+2(j+2),
2j(j + 1) (see
we conclude that Mj contributes more than 2j+1(j + 2)
(30) for the deﬁnition of η′
2, ﬁnd the largest integer j such that
ℓ. It is clear that 2j+1(j + 2) > ℓ. As we have shown above, Mj contributes
2j(j + 1)
≤
at least 2j+1(j + 2)
γℓ. One
may also note that for ℓ = 2, 3 the largest j as deﬁned above is 0, and then the situation is
slightly diﬀerent since we have used the term M0 to “cover” the union in (30). However, the
“unused” coeﬃcient for M0 is 7, and it is straightforward to see that M0 contributes 7
to
η′
ℓ, which is clearly suﬃcient for ℓ = 2, 3.
Second, we calculate the sum β of the coeﬃcients of Mj. We have

> ηℓ to the coeﬃcient in front of αl. Thus, γ′

ℓ for ℓ

to η′

ℓ ≥

> ℓ

≥

≥

n
l

n
l

n
ℓ

n
ℓ

(cid:0)

(cid:1)

(cid:1)

(cid:0)

(cid:0)

(cid:1)

(cid:0)

(cid:1)

x
1
below by
(cid:9)
ℓ
x
more than 1
(cid:1)(cid:16)
2
ℓ
intersections for ℓ
(cid:0)

(cid:0)

(cid:1)

≥

r

β =

4(i + 2)

Thus, γ = x/β = Ω(x/ log2 x).

i=0
X

4

≤

r + 3
2

(cid:18)

(cid:19)

= O(log2 x).

6
TWO PROBLEMS ON MATCHINGS IN SET FAMILIES – IN THE FOOTSTEPS OF ERD ˝OS AND KLEITMAN11

Finally, we verify that the condition imposed on u is suﬃcient for the applications of
+ 2j.
1, and in that case the inequality is
1. Thus, the
(cid:3)

(18) we used. For Mj the restriction is satisﬁed for u
This expression is clearly maximized when j = r
u
condition u

2r−1+2r−1 + 2r−1. The latter expression is smaller than 22r for any r

+ 2j = 2j+(r−j)2j

22r is suﬃcient.

2r−j

2x

2j

≥

−

≥

≥

2j

(cid:1)

(cid:0)

≥

≥
In the case ν(
(
∅
sition 7. For each j
Cj :=
Proposition 9. Assume that ν(

Ej
k−1

∈

G

, where Ej := [s+1, . . . , n]

, s)) = 1 we need a proposition which is more ﬁne-grained than Propo-
and deﬁne the families
1).

[k + 1] put Dj := [s + 1, s + k + 1]

\ {
(u+s)(k

k = (u+s

}
1)+1

s + j

1)(k

Dj and

Ej| ≥
\
−
, s)) = 1 and put v := max
{

|

(

∅

G

−
1, k + 2

u

.

}

−

−

−

(cid:0)

(cid:1)
(i) If τ (

(

∅

G

, s)) > 1, then

s

(

i
}

{

G

, s)

s

≤

i=1
X
(cid:12)
(cid:12)
, s)) = 1 and for some integer t

(cid:12)
(cid:12)

(cid:18)

(ii) If τ (

(

∅

G

k+1

Cj

−

(cid:19)

j=v
[

(cid:12)
(cid:12)
(cid:12)
[v, k] we have

n
k

s
1

−
−

∈
n
k

−
−

s
1

.

(cid:12)
(cid:12)
(cid:12)
|G

.

(35)

, s)

(

∅

|

>

n−s−t
k−t

, then

(cid:0)

(cid:1)

(36)

s

(

i
}

{

G

, s)

s

≤

(cid:18)

−

(cid:19)

i=1
X
(cid:12)
(cid:12)
, s) is shifted and τ (

(cid:12)
(cid:12)

k+1

j=t
[

Cj

(cid:12)
(cid:12)
(cid:12)

(cid:12)
(cid:12)
(cid:12)
, s).
, s)) > 1, the set D1 is contained in
, s). Arguing as in the proof
∈
[v, k + 1] such
∩ G
y
u. The rest of the argument is very similar to the argument

[k + 1] Dj is contained in
(

= y. Then there is an index j

, s)

∈

G

G

G

∅

∅

{

}

∅

s

(

(

(

(

(

s

∅

G

Proof. (i) Since
Then, by shiftedness, for each j
k+1
of Proposition 7, let
j=v Cj
y
, s)
that
(cid:1)
k+2−v ≥
in Proposition 7, which we reproduce for completeness.
∩ Cj. The families
, s)
(u + s
Ej| ≥
s
1

(cid:12)
, s) :=
(cid:12)
dependent and nested. Recall that

Cj ∩ G
(cid:12)
Gj(
Put
(cid:12)

(cid:12)
(cid:0)S
≥
(cid:12)
(

+ . . . +

1
{
}
1)(k

+ u

i
}

i
}

, s)

, s)

G

(cid:12)
(cid:12)

{

{

}

{

1

|

Gj(
−
|Gj(

|Gj(
which, in view of

{

|

}
|Gj(

{
k+1

, s)

s

}

| ≥

{

|Gj(
−
}
y
u , gives us

|

s−1

, s)

+

(cid:12)
(cid:12)
(cid:16)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
Applying Observation 6 with S = [1, s

(cid:17)

j=v
[

i=1
X
1] and

Cj

(

s

∩ G

{

}

|Gj(

, s)

i
}

{

| ≤

(s

−

−

k+1
j=v

Ej
k−1

=

B
, s)

, s), . . . ,

Ej
s
k−1
}
1). From (12) we get

Gj(

, s)

⊂

{

−

are cross-

{

s

, s)

}

| ≤

(s

−

1)

|
k

(cid:18)

(cid:1)

(cid:0)
Ej|
1
−

,
(cid:19)

(ii) Similarly, since

(

, s) is shifted and

, s). Therefore, each Dj for j

G

∅

(

|G

, the set Dt must be contained
(cid:1)
|
, s), and we conclude as
[t, s + 1] is contained in
(cid:3)

>
S

G

∅

∅

(cid:0)

(cid:1)

(

n−s−t
(cid:0)
k−t

∈

(

in
∅
G
before.

We go on to the proof of Theorem 3. In the case
+ 1

stated in the theorem since
=
rest of the proof we assume that

, s)
(
∅
> 1.

|G|

|

|G| − |G
, s)
|
∅
|G

(

(
∅
n
k

, s)

|
−

|G
≤

= 1 we get exactly the bound
n−s
+ 1. Thus, for the
k

− |B1|

(cid:0)

(cid:1)

(cid:0)

(cid:1)

1)

|
k

Ej|
1
−
, we get (i).

.
(cid:19)

(cid:18)

12

PETER FRANKL AND ANDREY KUPAVSKII

n−s−k+1
1

n−k−s
k−1

+
(cid:1)

s
= n
−
n−k−s−1
k−2

−

k + 1 then
for C from

(cid:0)

(cid:1)

n−s−2
2

(cid:0)

(cid:1)

if

, s)

(

∅

|G

| ≥

4,

Case 1. ν(G(∅, s)) = τ (G(∅, s)) = 1. If 1 <

(

, s)

∅

|G
≥ |Ck ∪ Ck+1|

| ≤
=

by Proposition 9, (ii) (with t = k) we have C
4 and s
Lemma 5. For k
n

≥

2 we have
≥
s
−
k

k
2

1

s

n

(cid:18)

−

−
−
thus the theorem holds in this case. For k = 3 one can see that C
= n
and thus we have C
, s)

−
k + 1 then we use the following bound:
s
−
(cid:0)
n

n−s−3
2

|
k+1

(cid:1)
k

≥ |G

≥ G

> n

, s)

|G

−

≥

−

−

−

−

−

1.

(cid:19)

If

n

∅

∅

∅

3

1

s

s

(

(

k

(

| −

(cid:0)
(cid:0)
, s)

(cid:1)
1,

≥

+ 2

−

−

=

C

≥

Cj

(cid:12)
(cid:12)
(cid:12)

[j=k−1

(cid:12)
(cid:12)
(cid:12)

=

(cid:18)

−
k

=

1 +

−
1

−
2(k
n

−

(cid:19)

(cid:18)

n

−
k

−
k

1)
s

−

u
u−1

(cid:17)(cid:18)
n−k−s
k−1

k
k

k

s
2

s

−
−

−
1

(cid:19)
(11)

≥

The last expression is at least
u

≥
s + 2, we can apply (14) and conclude that Theorem 3 holds in this case.
(cid:1)

u+s ≥

(cid:0)

≥

(cid:19)

−
if u+s+2

(cid:16)

−
u
u−1, which holds for u

(cid:17)(cid:18)

(cid:16)

1 +

2
u + s

n

k

−
k

−
1

s

.

(37)

(cid:19)
s + 2. Since

Case 2. ν(G(∅, s)) = 1 < τ (G(∅, s)). Analogously to (37), Proposition 9 implies that

k+1

C

≥

=

1 +

min
{
u + s

k + 1, u
1

n

}

−
k

k

−

−
1

s

.
(cid:19)

j=z
[
The inequality u+s+min{k+1,u}

(cid:12)
(cid:12)
(cid:12)

u+s

(cid:16)

(cid:12)
(cid:12)
(cid:12)
u
u−2 holds for u

−

(cid:17)(cid:18)
s + 4 and k

≥

Cj

≥

3, and we can apply (13).

≥

Case 3. ν(G(∅, s)) = x ≥ 2. We make use of Lemma 8. We are done in this case as

long as, in terms of Lemma 8,

u

−

x
u

1

−

γ

·

1.

≥

(38)

max

Using Lemma 8 (i)–(iv), one can see that (38) holds provided u
let us verify this technical claim. It is clearly suﬃcient to verify it for u = max
22
25 > 1.

If x = 2, then γ = 4
If x = 3, then the LHS is at least 3
2 ·
If x = 4, then the LHS is at least 16
9 ·
If x = 5, then the LHS is at least 16
9 ·
x, the LHS is at least 2
If x
To conclude this case, we remark that the inequalities u
1) + s + 1 and k

3 and the left hand side of (38) is at least 4
3 ·
21
25 > 1.
20
25 > 1.
19
25 > 1.

}
3 are suﬃcient for all the considerations above to work.

x+1
2x+2 = 1.
max
{

6, then, using s

25, 2s + 2

•
•
•
•
•

·
≥

, n

≥

≥

≥

{

≥

25, 2s + 2

. Indeed,
.

25, 2s + 2

}

}

{

(s + u)(k

−

≥

Next, using the ﬁfth statement from Lemma 8, we obtain that (38) is satisﬁed for u =
with some δ > 0 that will
log s
s, then the argument given in the previous paragraph shows
log2 s,

s+o(s). Indeed, take suﬃciently large s and put u = s+δ s(log log s)2
be determined later. If 2x+25
that the condition u

s is suﬃcient. Thus, we may assume that x

25)/2

(s

≤

≥

−

≥

≥

TWO PROBLEMS ON MATCHINGS IN SET FAMILIES – IN THE FOOTSTEPS OF ERD ˝OS AND KLEITMAN13

where the second inequality holds for all suﬃciently large s. Then, applying the ﬁfth point
of Lemma 8 with x = log2 s (note that u > s = 2x, and thus the condition of Lemma 8 are
satisﬁed), we get

u

−

x
u

1

−

γ

·

≥

Ω

log s
(log log s)2

u

−

s
u

·

1

−

= Ω

log s
(log log s)2

δ s(log log s)2
log s
s

·

> 1,

if δ is suﬃciently large. The proof of Theorem 3 for shifted families is complete.

(cid:16)

(cid:17)

(cid:16)

(cid:17)

2.2. The case of not shifted
theorem. Since the property τ (
assume that the family
decreases τ (
either
previous subsection.

becomes shifted or τ (

G

G

G

G

G

. Consider a family

is shifted right away. However, each (i, j)-shift for 1

satisfying the requirements of the
G
) > s is not necessarily maintained by (i, j)-shifts, we cannot
n,
n) one by one until
) = s + 1. In the former case we fall into the situation of the

i < j

i < j

≤

≤

≤

≤

G

) by at most 1. Perform the (i, j)-shifts (1

G
, s + 1) for i

Now suppose that τ (

) = s + 1 and that each set from

(

{

G

i
}

family
s + 2, . . . , n by performing all possible (i, j)-shifts with s + 2
family by
τ (
)

s + 1. Each family

[s + 1] is nonempty. Make the family

, s + 1) contains the set [s + 2, s + k].

again. Since shifts do not increase the matching number, we have ν(

G
i < j

≤

≤

∈

G

(

G

intersects [s + 1]. Then each
shifted in coordinates
n. Denote the new
s and
)

G
Next, perform all possible shifts on coordinates 1, . . . , s+1 and denote the resulting family
s, and, most importantly,

≤
′. We have

, ν(

=

G

′

by

i
{
}
′)

G

≤

G

|G
′(

|
1

G

{

|G|

G

, s + 1), . . .

}

≤
′(

G

s + 1

{

}

, s + 1) are nested and non-empty.

(39)

These families are non-empty due to the fact that each of them contained the set [s + 2, s + k]
before the shifts on [s + 1].

We can actually apply the proof from the previous subsection to

′. Indeed, the main
consequence of the shiftedness we were using is (39). The other consequence of the shiftedness
′ intersects
was the bound (16), which automatically holds in this case since every set from
[s + 1] and thus

, s + 1) is empty. The proof of Theorem 3 is complete.

′(

G

G

G

∅

3. Proof of Theorems 1 and 2
F1, . . . ,

Proof of Theorem 1. Take s cross-dependent families
states that
|F2| ≤
then [n]
verify for any s, and so we assume that m

|F1|
∈ F2. Thus, we may assume that s
A /
1.
ℓ for the rest of this section. Recall that

Put n := s(m + 1)

≥

≥

+

\

2[n], which follows from the following trivial observation: if A

Fs. For s = 2 the bound (1)
∈ F1
3. Also, the case of m = 0 is very easy to

is called an up-set if
for any F
. When dealing with cross-dependent
and q-dependent families, we may restrict our attention to the families that are up-sets and
shifted (e.g. see [11, Claim 17]), which we assume for the rest of the section.

all sets that contain F are also in

∈ F

−

F

F

Let us ﬁrst treat the case ℓ = 1. This is the easiest case, and it will provide the reader
with a good overview of the technique we use. Take s pairwise disjoint sets H1, . . . , Hs of
s
i=1 Hi form
size m at random. To simplify notation, assume that the s
the set [s

1 elements of [n]

1].

−

\

−

S

14

PETER FRANKL AND ANDREY KUPAVSKII

For each i

For all i

∈

i ( . . . ( H (m)
[s

i

[s] let
j

∈
[s], 0

≤
β(j)
i =

=: H (0)
∅
m and S
≤
1 if H (j)
0 if H (j)

(

⊂
−
i ∈ Fi,
/
∈ Fi;

i

:= Hi be a randomly chosen full chain in Hi.

1] deﬁne the random variables β(j)

i

and βi(S):

(40)

βi(S) =

1 if Hi ∪
0 if Hi ∪
(

S
S /

∈ Fi,
∈ Fi.

Note that S may be the empty set and that β(m)
implies

i = βi(

∅

). The cross-dependence of

F1, . . . ,

Fs

β1(S1)β2(S2)

·

For all 0

j

≤

≤

. . .

βs(Ss) = 0 whenever S1, . . . , Ss ⊂
1] the expectations E[β(j)

·
m and S

[s

1] are pairwise disjoint. (41)

[s

−

] and E[βi(S)] satisfy

i

⊂

E[β(j)
i

] =

[n]
j

−
Fi ∩
n
(cid:0)
j

(cid:12)
(cid:12)

(cid:1)(cid:12)
(cid:12)

,

E[βi(S)] =

[n]
m+|S|
n
(cid:0)
m+|S|

Fi ∩
(cid:12)
(cid:12)

(cid:1)(cid:12)
(cid:12)

(cid:0)

(cid:1)

.

(42)

Our aim is to prove the following statement.

(cid:0)

(cid:1)

Lemma 10. For every choice of H1, . . . , Hs and the full chains one has

s

m

n
j

β(j)
i +

i=1 "
X

(cid:19)

j=0 (cid:18)
X

2 ) (cid:0)
(cid:0)
and βi(S) are as deﬁned in (40).

XS∈([s−1]

1 )∪([s−1]

where β(j)

i

n
m+1
s−1
|S|

(cid:1)

βi(S)

s

# ≤

(cid:1)

n
m + 1

(cid:18)

+ s

n
m + 2

(cid:18)

,
(cid:19)

(cid:19)

(43)

Replacing the left hand side of (43) with its expected value, it is straightforward to see

that (42) implies

s

m+2

from which (1) follows.

i=1
X

Fi ∩
j=0 (cid:12)
X
(cid:12)
(cid:12)

(cid:18)

[n]
j

(cid:19)(cid:12)
(cid:12)
(cid:12)

s

≤

(cid:18)

n
m + 1

+ s

(cid:19)

(cid:18)

n
m + 2

,
(cid:19)

[s] we have β(m)

s

∈

≤

≤

If p

i=1 β(m)

Proof of Lemma 10. If for all i
i = p for some p

1 since
[p].
2, then we proceed as follows. We have

s
1. Clearly, p
≥
W.l.o.g., we assume that β(m)
i = 1 if and only if i
P
s
−
distinct kp+1, . . . , ks ∈
at least a 1/(s
βi(
−
the sum on the right hand side of (43) is at most p
diﬀerence between the RHS and the LHS of (43) is at least D :=
to check that for n = sm+s

i = 0 then we are done. Assume that
Fs are cross-dependent.
p
ki}
1 for any
1]. Averaging over the choice of kp+1, . . . , ks, it is easy to see that
s and k
1], satisﬁes
1 such pairs. Consequently, we get that
n
and the
m+1
p
. It is easy
(cid:1)
m−1
.
j=1

) = 0. In other words, there are at least s

p)-fraction of the pairs (i, k), where p + 1

F1, . . . ,
s
i=p+1 βi(

1)
−
n
m+1

(cid:1)
(cid:0)
−
, and thus D
(cid:1)
(cid:0)

−
n
m+2
n
j
p
(cid:1)

1 we have

n
m+1

−
∈

= (s

m
j=1

+ (s

(cid:0)
n
m

P

P

1)

−

−

≤

−

−

≤

≤

[s

[s

∈

n
j

n
j

k

{

{

}

s

)

i

+ s
m
(cid:0)
j=1
n
(cid:0)
m
−

−

For n = sm + s

(cid:1)
P
≥
(cid:0)

[s] and m
(cid:0)

≥

∈

1 the following holds.
(cid:1)
(cid:0)

(cid:1)

(cid:1)

P

(cid:0)

(cid:1)

m
j
m + j + 1 ≤

−

−

1
−
1)m

m

(s

−

for

1.

j

≥

(44)

−

−
ℓ with ℓ
n
m−j−1
n
m−j

=

(cid:1)

(cid:0)

n

(cid:0)

(cid:1)

TWO PROBLEMS ON MATCHINGS IN SET FAMILIES – IN THE FOOTSTEPS OF ERD ˝OS AND KLEITMAN15

Using (44) we may obtain that

m
j=1 p

n
m−j

is at most

m

j=1
X

2)

(s

−

n

m

(cid:18)

j

(cid:19)

−

(44)
< (s

−

(cid:0)
∞

P
2)

1 +

(cid:1)
m
m(s

(cid:16)

i=1
X
1
2)

−
−

m
m(s

n

m

(cid:17)(cid:18)

1

−

−
−

1
1)i

n

=

(s

m

1

(cid:19)

−

(cid:17)(cid:18)

=

(cid:19)
s
1
−
−
1)m + s

1
m

(cid:0)
−

2)

1 +

(s

−

(cid:16)

Using (45), it is easy to conclude that D > 0 in this case.

m
ℓ + 1

n
m

.
(cid:19)

(cid:18)

(45)

(cid:1)
−

{

}

k

n
j

[s

−

−

−

≥

−
n
j

≥
1

−
n
j

m
j=1

1)
n
m+2

) = 0 for any k

is at most (s
satisﬁes D
case, we get D
(cid:0)
n = s(m + 1)

Assume now that p = s
m+2
j=1
n
(s
+
(cid:1)
(cid:0)
P
m+1
m
n
(cid:1)
(cid:1)
(cid:0)
j=0
m+2
−
2m + 3 for m
(cid:0)
P
≥
From now on, we assume that ℓ

1. Then βs(
1]. Then the LHS of (43)
∈
, and the diﬀerence D between the RHS and the LHS of (43)
. Using the calculations from the previous
since
(cid:3)

1)
. On the other hand, we have
(cid:1)
P
3. Thus, D
1 and s
(cid:1)
2. We use the same idea, however, we will average over
1
−
ℓ].
−
and βi(S)
−
analogously to how it is done in (40). Note that the analogues of (41) and (42) hold in this
case as well.

a slightly diﬀerent collection of sets. Take s pairwise disjoint sets H1, . . . , Hs of size m
at random. W.l.o.g. assume that the 2s

ℓ], deﬁne the random variables β(j)
S

s
i=1 Hi form the set [2s

ℓ elements of [n]

n
m+2
m
(cid:1)
j=0

n
m+1
> 0.
(cid:0)

For all i

1 and S

(cid:0)
P

−
[2s

n
m+1

[s], 0

≥
n
j

(cid:0)
≥

m

≥

≥

−

≤

−

≤

⊂

−

≥

∈

\

(cid:0)

(cid:1)

(cid:0)

(cid:1)

(cid:1)

(cid:0)

(cid:1)

j

i

The analogue of Lemma 10 in this case is the following statement. Once veriﬁed, the rest

of the argument is the same.

Lemma 11. For every choice of H1, . . . , Hs and the full chains one has

s

m−2

n
j

β(j)
i +

n
m−1+|S|
2s−ℓ
|S|

βi(S)

# ≤

m+2

s

n
j

(cid:19)

+ (ℓ

1)

−

n
m

(cid:18)

(cid:19)

.

(46)

i=1 "
X

XS([2s−ℓ],|S|≤3 (cid:0)
The proof of Lemma 11 uses the following proposition.

j=1 (cid:18)
X

(cid:19)

(cid:1)

(cid:1)

(cid:0)

j=m+1 (cid:18)
X

[s′] and for s′ cross-dependent families

Proposition 12. For n′
[n′]
2

′
1, . . . ,

[n′]
1

′
s′

F

⊂

∪

F

(cid:0)

(cid:1)

(cid:0)

(cid:1)

:= 2s′
we have

−

ℓ′ with ℓ

∈

s′

.
(cid:19)
Proof of Proposition 12. Fix a random ordering on [n′]. For S
and ϑi(S) = 0 otherwise. Similarly to (43), (46), it is suﬃcient to prove

i=1
X

|F

⊂

−

(cid:18)

1)n′ + s′

′
i| ≤

(ℓ′

n′
2

[n′], put ϑi(S) = 1 if S

s′

n′

n′
2

n′ϑi(

) +

i
}

{

i=1 "
X

(cid:1)n′
Xx=s′+1 (cid:0)
−
W.l.o.g., suppose that ϑi(
) = 1 if and only if i
i
}
ℓ′ = s′ then the statement of the proposition is obvious since at least one of ϑi(
to 0. Thus, we assume that ℓ′

[p]. If p

# ≤

−

−

≤

1.

(cid:18)

s′

ℓ′

∈

{

{

p

1, then we are done. If
i
) is equal
}

{

s′ ϑi(

)

i, x
}

(ℓ′

1)n′ + s′

n′
2

.
(cid:19)

≤

≤

−

(47)

′
i

∈ F

(48)

16

PETER FRANKL AND ANDREY KUPAVSKII

s′
i=p+1 ϑi(

ℓ′). For any collection of distinct elements xp+1, . . . , xs′

Recall that n′ = s′+(s′
−
i, xi}
)

[s′+1, n′]
1. By a simple averaging argument we get that at least
we have
p)-proportion of pairs (i, x), where i = p + 1, . . . , s′ and x = s′ + 1, . . . , n′, satisﬁes
a 1/(s′
P
−
ℓ′ such pairs. Therefore, the left hand
) = 0. This accounts for at least n′
i, x
ϑi(
}
−
+ n′
side of (48) in this case does not exceed (s′
, which is at most the right hand
(cid:3)

s′ = s′
n′
1)
2

−
−

−

≤

−

s′

∈

{

{

p

side of (48) since

= n′(s′

i

n′
2

(cid:1)

(cid:0)

Proof of Lemma 11. We have
[p].
) = 1 if and only if i
βi(
s
p
s
s
p
p
ℓ). Then
≤
≤
−
≤
1 for any pairwise disjoint Sp+1, . . . , Ss of cardinality two. By a
p
−
p)-proportion of all

∅
ℓ/2
Assume that ℓ/2
ℓ/2
s
s
i=p+1 βi(Si)

simple averaging argument we immediately get that at least a 1/(s
P
pairs (i, S) satisfy βi(S) = 0, where i = p + 1, . . . , s and S

P
P
P
2
2. In this case we have s
2

1. W.l.o.g. assume that

. In other words,

∈
≤
≤
≤
−

ℓ/2 = 1

2(2s

−
−
−

−

−

≤

−

−

≤

≤

≤

p

s

p

s

−

(s′

ℓ′+1
ℓ′)n′.
h(cid:0)
2 )
≥
−
s
s
s
) = p
i=1 βi(
) = p for some 0
i=1 βi(
) = p
i=1 βi(
∅
∅
∅

(cid:1)

[2s−ℓ]
2

∈
[2s
(cid:0)

ℓ]
(cid:1)

and i

[p+1, s]. (49)

∈

βi(S) = 0 for at least

2s

ℓ

pairs (i, S), where

−
2
(cid:18)
F1, . . . ,
Fs are cross-dependent, we similarly get that
2s

ℓ pairs (i, S), where

−
2

[2s

| ∈

(cid:19)

(cid:18)

(cid:19)

ℓ]

S

S

|

Since the families

βi(S) = 0 for at least

−

|

| ∈
m−1
j=0

(cid:18)
n
j

P

(cid:1)
(cid:0)
m−1

−
1

(cid:19)

n
j

and i

[s].

(50)

∈
m+1
j=m

n
j

P

(cid:0)

(cid:1)

n
m+2

.

(cid:0)

(cid:1)

(51)

Therefore, the left hand side of (46) is at most p

+ s
Consider the diﬀerence D between the RHS and the LHS of (46). Then D is at least

+ (s

1)

−

n
m + 1

n
m

.
(cid:19)
(cid:19)
Next we show that this expression is always nonnegative. We have
m(s

j=0 (cid:18)
X

1) + s

2)

(s

(s

ℓ)

−

−

−

−

(cid:18)

(cid:19)

(cid:18)

ℓ

n
m + 1

(cid:18)

−

(cid:19)

(s

ℓ)

−

n
m

(cid:18)

(cid:19)

=

(cid:16)

−
m + 1

−

(s

ℓ)

−

−

n
m

=

m(ℓ

1)

−
m + 1

n
m

(cid:18)

(cid:19)

(cid:17)(cid:18)

(cid:19)

.

(52)

It is easy to see that the right hand side of (52) is bigger than the right hand side of (45) for
both ℓ = 2 and ℓ
p = s
p = s
If p = s

3, which proves (46) in this case.
ℓ],

3. Therefore, the LHS (46) is at

[2s

≥

S

1
1, then βs(S) = 0 for all S
1
, and D is at least

m+2
j=0

n
j

−
−
−
1)

⊂

−

|

| ≤

most (s

−

P

Recall that m

≥

(cid:0)

(cid:1)
n
m + 2

+

n
m + 1

(s

ℓ)

−

−

n
m

(s

−

−

m−1

1)

n
j

(cid:18)
1. If ℓ

(cid:18)

j=0 (cid:18)
(cid:19)
X
3, then one can see from (52) and (45) that

(cid:18)

(cid:19)

(cid:19)

.
(cid:19)

(53)

≥

n
m

n
m + 1

ℓ)

(s

(s

(cid:19)

−

−

−
(cid:18)
−
which is always nonnegative. Indeed, it is easy to see for ℓ
ℓ = 3 it can be veriﬁed separately.

−
m + 1 −

j=0 (cid:18)
X

−

≥

−

(cid:19)

(cid:19)

(cid:18)

(cid:16)

1)

m(ℓ

1)

s
s

1
2 ·

(s

1)m
(s
1)m + s

−

−

−
−

4 (and thus s

≥

≥

1
ℓ + 1

n
m

,
(cid:19)
(cid:17)(cid:18)
4), and for

m−1

n
j

TWO PROBLEMS ON MATCHINGS IN SET FAMILIES – IN THE FOOTSTEPS OF ERD ˝OS AND KLEITMAN17

If ℓ = 2 then due to (52) and (45) the expression (53) is at least

ℓ

sm + 1

2m + 2 for any s
(cid:1)

(cid:0)

≥

≥

−

n
m

since n = s(m + 1)
by (45).

have
Finally,
(cid:0)

≥
>

n
m+2
n
(cid:1)
m
(cid:1)

m−1
n
(cid:0)
(cid:1)
j=0
j
p < ℓ/2
p < ℓ/2. Then again
Suppose that p < ℓ/2
(cid:1)
P
[p + 1, s], consider the family

(cid:0)
[2s
For each i
{
⊂
′
i with 2(s
families are cross-dependent. Applying (47) to
playing the roles of n′, s′ and ℓ′, respectively, we get that

′
i :=

Q

F

F

∈

S

(cid:0)

−
−

s
i=p+1 βi(Si) = 0 for any s

−
ℓ] : βi(S) = 1,
(ℓ
p)

p pairwise disjoint Si.
. These
2p

2
}
p and ℓ

S
|
2p), s

| ≤
−

−

−

−

n
m+2

m−1
n
j=0
j
3 and m
(cid:1)
P

(cid:0)

. We
1.

≥

−
≥

s

′
i| ≤

|F

(ℓ

−

2p

1)(2s

−

ℓ) + (s

p)

−

−

2s

(cid:18)

−
2

ℓ

.
(cid:19)

i=p+1
X
(Note that we tacitly use that none of the
sumption.)

′
p+1, . . . ,

F

F

′
s contain the empty set by the as-

We conclude that among the coeﬃcients βi(S), where i

[2], there are at
ℓ + p + 1) that are equal to zero. The following observation is veriﬁed by

[s] and

| ∈

∈

S

|

least (2s
−
a simple calculation.

ℓ)(s

−

Observation 13. Suppose s
≥
coeﬃcient in front of βi(S1) for
|
for

= 2. That is,

S2|

|

In the summation over S in (46), the
= 1 is not bigger than the coeﬃcient in front of βi(S2)

1.

≥

3 and m
S1|

n
m+1
2s−ℓ
2

n
m
2s−ℓ
(cid:1)
1

.

≥ (cid:0)
Using the observation and the conclusion of the paragraph above it, we get that the left
(cid:0)

(cid:1)

(cid:1)

(cid:0)

(cid:1)

(cid:0)

hand side of (46) is at most

n
j

(cid:19)

+ (ℓ

p

−

−

1)

n
m

(cid:18)

(cid:19)

+ s

n
m + 1

(cid:18)

+ s

n
m + 2

(cid:18)

.
(cid:19)

(cid:19)

m−1

p

j=0 (cid:18)
X
n
j

Since

n
m

>

m−1
j=0

, the last expression is smaller than (ℓ

1)

n
m

+ s

n
m+1

+ s

n
m+2

. (cid:3)

−

(cid:0)

(cid:1)

(cid:1)

(cid:0)

P

3.1. Proof of Theorem 2. We prove the theorem by double induction. We apply induction
on m, and for ﬁxed m we apply induction on n. The case m = 0 of (4) is very easy to verify.
The case n = q is the bound (1).
We may assume that all the

1] are

Fi are shifted. The following two families on [n
2[n]:

typically deﬁned for a family

−

(cid:1)

(cid:1)

(cid:0)

(cid:0)

(cid:0)

(cid:1)

F ⊂
(n) :=

F

A

− {
A : n /
∈

: n

n
}
A, A

∈

A, A

,

∈ F

.

(cid:8)

−

It is clear that

(¯n) :=
F
∈ F
Fs(n)
Fs(¯n) are q-dependent. Next we show that
F1(¯n), . . . ,
are (q
s)-dependent. Assume for contradiction that F1, . . . , Fs, where Fi ∈ Fi(n), are
pairwise disjoint and that H := F1 ∪
q, we have
n
s)
Fi are
−
≥
xi} ∈ Fi for i
shifted, we have Fi ∪ {
are pairwise disjoint. Their
q, contradicting the assumptions of the theorem.
H
x1, . . . , xs}
union H
has size
|
∪ {

∪
s. Therefore, we can ﬁnd distinct elements x1, . . . , xs ∈

[s], and the sets Fi ∪ {
≤

Fs has size at most q

s. Since n
[n]

F1(n), . . . ,

≥
H. Since

xi}

∈
+ s

. . .

(q

−

−

−

(cid:9)

(cid:9)

(cid:8)

|

18

PETER FRANKL AND ANDREY KUPAVSKII

Recall the deﬁnition (3). The induction hypothesis for

s

s

i=1
X

|Fi(¯n)

| ≤

˜
n−1,q
i
F

|

i=1
X
Fi(n) with n

Fi(¯n) gives
.

|

(54)

1, q

−

−

s, m

−

1 playing the roles of

|Fi(n)

| ≤

s

i=1
X

˜
n−1,q−s
i
F

|

|

.

(55)

The induction hypothesis applied to

n, q, m gives

s

Adding up (54) and (55), we get

i=1
X

We have ˜
n−1,q
i
F

s

s

s

|

=

+

|Fi|

|Fi(n)
i=1
i=1
X
X
(cid:0)
(¯n) and ˜
= ˜
n−1,q−s
n,q
i
i
F
F
˜
˜
n−1,q−s
n−1,q
i
i
F
F

+

|

|

|

|

|

|

|

+

≤

i=1
X

˜
n−1,q
i
F

|Fi(¯n)
(cid:1)
= ˜
n,q
(n). Thus, for any i
i
F
˜
n,q
i
F

˜
n,q
i
F

(¯n)

(n)

+

=

=

(cid:0)

|

|

|

|

|

|

˜
n−1,q−s
i
F

.

|

(cid:1)

[s]

∈
˜
n,q
i
F

.

|

4. Application of Theorem 3 to an anti-Ramsey problem

We call a partition

Fi an M-coloring. Let
the anti-Ramsey number ar(n, k, s) be the minimum M such that in any M-coloring there
(cid:1)
is a rainbow s-matching, that is, a set of s pairwise disjoint k-sets from pairwise distinct
Fi.
This quantity was studied by ¨Ozkahya and Young [24], who have made the following

into non-empty families

⊔ FM of

F1 ⊔

. . .

(cid:0)

[n]
k

conjecture.

Conjecture 3 ([24]). One has ar(n, k, s) = ek(n, s

1) + 2 for all n > sk.

−

−
ek(n, s
1) + 2 for any n, k, s. Indeed, consider a
1)-matching and assign a diﬀerent color to each
[n]
k

It is not diﬃcult to see that ar(n, k, s)
≥
maximum size family of k-sets with no (s
−
of these sets. Next, assign one new color to all the remaining sets. This is a coloring of
without a rainbow s-matching. In [24] the authors proved Conjecture 3 for s = 3 and for
(cid:1)
sk+(s
n
1).
−
1), which is much
is s-star-like
i
and
}
1) + 1 colors.

≥
−
stronger than Conjecture 3 in that range. We say that the M-coloring of
and a number i
[M] such that for every j
if there exists a set Y
(cid:0)
∈
F
∈ Fj, F intersects Y . Clearly, each s-star-like coloring has at most ek(n, s
For convenience, we deﬁne the quantity

2k3s. They also obtained the bound ar(n, k, s)
≥
In this section we ﬁrst state and prove a result for n

1)+s for n
1)(k

[M]
(cid:1)
−

−
sk + (s

ek(n, s

[n]
s−2

1)(k

(cid:0)
−

− {

[n]
k

−

≥

≤

∈

∈

(cid:1)

(cid:0)

h(n, k, s) := max

:

{|F |

F ⊂

, ν(

F

) < s, τ (

)

F

s

,

}

≥

[n]
k

(cid:18)

(cid:19)

which was determined for a certain range in Theorem 3.

Theorem 14. Let s
M-coloring of
h(n, k, s
M

[n]
k
1) + s.
(cid:1)

−
(cid:0)

≤

3, k

1) be some integers. Consider an
without a rainbow s-matching. Then either this coloring is s-star-like, or

2 and n

sk + (s

1)(k

−

≥

−

≥

≥

TWO PROBLEMS ON MATCHINGS IN SET FAMILIES – IN THE FOOTSTEPS OF ERD ˝OS AND KLEITMAN19

Conjecture 3 follows from Theorem 14, once we can apply Theorem 3 or an analogous

statement. Indeed, it is shown in Theorem 3 that h(n, k, s
−
1), moreover, it implies that in most cases h(n, k, s
1)+2. We
do not need an exact Hilton–Milner-type result to deduce Conjecture 3. We may use a weaker
form of Theorem 3 that was proven in [11] and is valid for a slightly wider range of parameters
than Theorem 3. In particular, [11, Theorem 5] implies that for n
1) we
have ek(n, s
3
we have 1
s

2. Thus, Theorem 14 implies Conjecture 3 for this range.

1) is much smaller than ek(n, s

1)+s is smaller than ek(n, s

1)
−
−
n−s−k+2
k−1

h(n, k, s
> s

1)(k
1) and k

sk + (s
1)(k

. For any n

≥
sk + (s

n−s−k+2
k−1

−
−

1)

≥

−

−

−

≥

−

≥

−

−

1
s

(cid:0)

(cid:1)

(cid:1)

(cid:0)

Corollary 15. We have ar(n, k, s) = ek(n, s

3.
−
Note that this is the same range in which ¨Ozkahya and Young got a weaker bound
1) + s. We remark that the case k = 2 has already been settled

ar(n, k, s)
for all values of parameters (see [24] for the history of the problem).

1) + 2 for n

1) and k

sk + (s

ek(n, s

1)(k

≥

≤

−

≥

−

−

−

Proof of Theorem 14. Arguing indirectly, ﬁx an M-coloring with M
with no rainbow s-matching. We may assume that there is a rainbow (s
F1, . . . , Fs−1 with, say, Fi ∈ FM −i+1 for each i
in new colors so that the number of colors increases and a rainbow (s
rainbow s-matching) appears.

1) + s and
−
1)-matching
1]. Otherwise, recolor some of the sets
1)-matching (but no

h(n, k, s

−

−

≥

−

[s

∈

G

−

:=

[M

For each i

∈
U
G1, . . . , GM −s+1} ⊂
either
k
Gi, or for some choice of Gi there is an (s
(cid:0)

s + 1], choose Gi ∈ Fi. Note that M
−
for a suitable U
⊂
1)-matching, say G1, . . . , Gs−1, in

1). Thus,
−
and for any choice of
.

s + 1 > h(n, k, s

In the latter case we can apply the argument used by ¨Ozkahya and Young: since the colors
Fi forms a rainbow

[n]
n−s+2

[n]
k

(cid:1)
−

s−1

−

G

{

(cid:0)

(cid:1)

(cid:0)

(cid:1)
i=1 Gi ∪

∪

=

Fs−1)

. . .
(F1 ∪
∅
S
1), and we are done provided
1) = sk + (s

1)(k
2 for all choices of G1 ∈

1).

−

−

H1, . . . ,
with Hi ∈ Hi we have τ (

HN of k-subsets of
2,
)
H

−

≤

s

\

\

s−1

S

−
−
s

of F1, . . . , Fs−1, G1, . . . , Gs−1 are all distinct, any k-set from [n]
s-matching with one of these two (s
[s
holds for each i
∈
−
Fi| ≥
i=1 Gi ∪
[n]
|
In the former case the family
F1, . . . , GM −s+1 ∈ FM −s+1.
Claim 16. Fix N > h(n, k, s
[n]. If for any set of representatives
then τ

−
s−1
(2k
Fi| ≤
i=1 Gi ∪
1]. Thus,
|
k + (2k
k, which holds for n
S
≥
must satisfy τ (
G

1)-matchings. Moreover, Gi ∩
1)(s
−
1)(s
−
)
G

1) and pairwise disjoint families
H1, . . . , HN }

N
i=1 Hi
−
Proof. Fix one choice of
assume that there is a set H ′
also satisﬁes τ (
H
all intersect T ′. Deﬁne m(T, T ′) :=
∩
for any distinct T, T ′ of size s
This contradicts the fact that H2, . . . , HN all intersect T and T ′.
T

and let T be a hitting set of size s
H
∈ H1 such that H ′
2, and so there is a set T ′
F

∅
= T ,
T
=

T ′
| ≤
= F

s
−
T ′
}

. The family

′) = s

2 for

|
∅ 6

T =

(cid:0) S

[n]
k

: F

:=

H

2.

−

−

≤

⊂

−

−

−

≤

∩

∩

(cid:12)
(cid:12)

{

{

s

(cid:0)

(cid:1)

(cid:1)

|

T

∩

<

T ′

Let us show that m(T, T ′) is maximal when
T ′, y
T
\
T
=
T ′)

1, then we may choose x
T
|
∈
Let F be an arbitrary set satisfying F
∩
that F
x
((T
)
}
− {
n−2(s−2)+t
sets F
k−1

{
n−(s−2)−1
k−1

T ′′) =
is

|
(T ′
[n]
k

, F

|−

∅
=

\
.

∪

}

y

∅

∩
−

∩
∈

(cid:0)

(cid:1)

(cid:0)

(cid:1)

(cid:0)

(cid:1)

{

H
′ :=

. Arguing indirectly,
H ′, H2, . . . , HN }
H
2, such that H2, . . . , HN
. We want to show that
1).

−

(cid:12)
(cid:12)
1 = s

|
∈
, F

|

T

=

T ′
−
| −
|
∩
T and deﬁne T ′′ := (T ′
T ′
\
T ′
=
. Setting

Indeed if
y
x
.
)
−{
}
}
. This means
∩
= t, the number of such

and F
T ′

T ′′ =

∪{

3.

∩

∅

∅
T
|

∩

|

2 the quantity m(T, T ′) is strictly smaller than h(n, k, s

6
6
6
6
6
6
20

PETER FRANKL AND ANDREY KUPAVSKII

T

∪

∩

with F

. Their number is

On the other hand, the sets F satisfying F
x
}
{
T ′
T
∩
|
n−s+2
k

T ′′) =
(T ′
Suppose now that
1)
> 0. This completes the proof of the claim.
(cid:0)

h(n, k, s
n−s+2−k
(cid:1)
k−1
Applying Claim 16 to the ﬁrst M

=
∅
∩
n−(s−2)−1
k−1
3. Then m(T, T ′) =

n
k
+ 1, we have h(n, k, s
(cid:1)

−
n−s+2−k
k−1

|
−

= s

, F

−

−

≥

∩

n
k

(cid:0)

(cid:1)

(cid:0)

(cid:1)

(cid:0)

(cid:1)

(cid:0)

=

T ′′

T ′ =
, which is clearly bigger.

, and F

∩

∅

are those

∅

n−s+3
k

n−s+1
+
k−2
m(T, T ′) >

(cid:1)

(cid:0)

−
−

1)
(cid:0)

−

. Since
n−s+1
(cid:1)
k−1
(cid:0)

−
(cid:3)

(cid:1)

2. To complete the proof, we need to show that the same holds for some M

s + 1 color classes, we get that they all intersect a set
1

−

(cid:0)
(cid:1)
T of size s
colors.

−

Note that since

has size at least

M −s+1
i=1
n−s+2
k

|Fi| ≤
.

Claim 17. In every rainbow (s

(cid:1)

1
s−1
P
(cid:0)

−

n
k

−

n−s+2
k

, one of the last s

−

1 color classes, say

(cid:1)

(cid:0)

(cid:0)
1)-matching, one of the k-sets belongs to

(cid:1)

FM .
1)-matching in colors

FM , we ﬁnd a hitting set T of size s

−

FM −s+1, . . . ,
2 for

−
FM ,

Proof. Arguing indirectly, assume that there is a rainbow (s
FM −1. Applying Claim 16 to
F1 ∪

F1, . . . ,

FM −s,

. . .

−

∪ FM −s ∪ FM . We infer
s + 2
n
s +
k

−

1

1

s

−

M

We have M

−

s

. . .

≤ |F1 ∪
n
k
−
s + 3
(cid:0)
(cid:0)
(cid:1)
−
k
s + 3

(cid:19)
1) >

n

−

n

−

(cid:18)

−

≥
n

−

(cid:18)
h(n, k, s

s + 3
k

(cid:19)

≥

k

−

−

=

(cid:18)
s + 3

∪ FM −s ∪ FM | ≤

(cid:18)
. Also, we have

n−s+3
k

n
k

(cid:19)

n

−

s + 2
k

(cid:19)

−

(cid:18)

.

(56)

n

(cid:1)
−

s + 2
k

s + 1
s

≤

n

−

s + 2
k

(cid:19)

(cid:18)

,

(cid:19)

provided n
follows.

−

sk. The inequalities above contradict (56), and so the claim
(cid:3)

We conclude that there is no rainbow (s

that there is a cover of size s
In turn, Claim 16 implies that
the coloring is s-star-like. Theorem 14 is proved.

1)-matching in

∪ FM −1, which implies
F1 ∪
2 for any set of distinct representatives of the color classes.
−
∪ FM −1 can be covered by a set T of size s
2, i.e.,
F1 ∪
(cid:3)

. . .

. . .

−

−

Next, we prove a weaker bound on ar(n, k, s), which is valid for all n > sk:

Theorem 18. We have ar(n, k, s)

ek(n, s

1) +

−

≤

(s−1)(n
k)
(n−(s−1)k
)

k

+ 1 for any n > ks.

[n]
k

with no rainbow s-matching and let G1, . . . , GM be a set of
Proof. Fix an M-coloring of
representatives of the color classes. Reordering Gi if necessary, we may assume that for some
G(T −1)(s−1)+1, . . . , GT (s−1)}
integer T the collections
{
are rainbow (s
GT (s−1)+1, . . . , GM }
does not
contain a rainbow (s

,
1)-matchings, while the remaining collection

(cid:1)
G1, . . . , Gs−1}
1)-matching. We have

Gs, . . . , G2(s−1)}

, . . . ,

−

{

{

{

(cid:0)

M

−

. . .

T (s

1)

−

≤

ek(n, s

−

G(i+1)(s−1)) for i = 0, . . . , T

1).

(57)

Set Hi := [n]

(Gi(s−1)+1 ∪

∪
of rainbow s-matchings in the coloring implies that in the coloring of
Hi
the colors of the s
k

1 sets Gi(s−1)+1, . . . , G(i+1)(s−1). Consequently,

−

−

1. The non-existence
we only used
Hj
must be
k

Hi
k
and
(cid:1)
(cid:0)

−

−

(cid:0)

(cid:1)

(cid:0)

(cid:1)

6
6
TWO PROBLEMS ON MATCHINGS IN SET FAMILIES – IN THE FOOTSTEPS OF ERD ˝OS AND KLEITMAN21

disjoint for i
ek(n, s
M

≤

= j. From this
n
1) + (s
/
(cid:0)
k
(cid:0)

1)

−

(cid:1)

(cid:0)

n
T
k
≥
n−(s−1)k
(cid:0)
(cid:1)
k
(cid:1)

−

n−(s−1)k
k

, as claimed.

(cid:1)

follows. Combining with (57), we obtain
(cid:3)

Finally, we prove a bound that is valid for n > (s + √s)k and is stronger than the previous

one in many cases.

Theorem 19. We have ar(n, k, s) < ek(n, s
(s + √s)k. In particular, if n = csk for some ﬁxed c > 1 and s
ek(n, s

1) + (1 + o(1))s c

1) +

−

c−1.

(s−1)n(n−sk)

(n−sk)2−k((2s−1)k−n) + 1 for any n >

→ ∞

, then ar(n, k, s)

≤

−

Proof. Following the notations of the previous proof, put Fi := Gi(s−1)+1 ∪
= j we have
= (s
for i = 0, . . . , T
1. Note that
|
since otherwise any k-set in [n]
forming Fi or the sets forming Fj. Thus, we have
Fj|
and

G(i+1)(s−1)
. . .
∪
k
> n
Fj|
Fi ∪
Fj) will form a rainbow s-matching with either the sets
n
< (2s
Fi| − |

1)k. Then for each i

Fi|
|
(Fi ∪
\

Fi ∪

Fi ∩

Fj|

= 2

1)k

−

−

−

−

−

|

|

Fi ∩

|

Fj|

<

T
2

(cid:18)

(cid:19)

((2s

1)k

n).

−

−

X0≤i<j≤T −1

On the other hand, if an element x is contained in dx sets Fi, then it contributes
the sum
satisﬁes d = T (s−1)k
P

to
. The average number d of sets containing an element of [n]

Fj|
. Therefore, we get

0≤i<j≤T −1 |
n

Fi ∩

(cid:0)

(cid:1)

dx
2

Fi ∩

|

Fj|

=

dx
2

≥

(cid:19)

Xx∈[n] (cid:18)

X0≤i<j≤T −1

n

d
2

.
(cid:19)

(cid:18)

Combining the two displayed formulas, we get

T (T

1)((2s

1)k

−

−

−

n)) > n

T (s

−
n

After rearranging and simplifying the expression above we get

1)k

T (s

1)k

−
n

−

1

.

(cid:17)

(cid:16)

((s

1)k)2
−
n

(2s

−

−

which is equivalent to

(cid:16)

1)k + n

T < (s

(cid:17)

1)k

(2s

−

−

−

1)k + n,

sk)2

(n

−

(2s

−

−

1)k2 + nk

T < n(n

sk).

−

(58)

(cid:0)

The left hand side is positive provided n = sk + x, where x2
x). This holds
for x = k√s. In this assumption it is clear that (58) combined with (57) implies the ﬁrst
and n = csk with c > 1, then (58) transforms into
statement of the theorem. If s
1)2T
(1 + o(1))(c
1), which, together with (57), implies the second statement of
(cid:3)
the theorem.

→ ∞

k((s

1)k

c(c

−

≤

≥

−

−

−

(cid:1)

We remark that a similar proof, applied in a more general scenario, appeared in [22].

6
6
22

PETER FRANKL AND ANDREY KUPAVSKII

5. Almost matchings

Let us say that the sets F1, . . . , Fs form an almost matching if the family

F1, . . . , Fs}
has at most one vertex of degree greater than one and that vertex has degree at most two.

:=

F

{

Deﬁne

a(n, s) := max

:

2[n],

contains no almost-matching of size s

F ⊂
sm−2
Theorem 20. The equality a(sm
t=m
Moreover, the equality is achieved only by the family

2, s) =

|F |

−

F

(cid:8)

sm−2
t

F
{
(cid:0)

⊂

holds for all s
≥
m
.
}

| ≥

2] :

−

F

|

[sm
(cid:1)

P

.

(cid:9)

2, m

1.

≥

Proof. Suppose
may suppose that
i = 1, . . . , s

2[n] contains no almost-matching of size s, where n = sm
F ⊂
is an up-set. Consider the families
F
Fs := ∂
1, and

[n]
(see (15)).
−
}
Claim 21. The families
Fs are cross-dependent.
Proof. Indeed, if F1, . . . , Fs, where Fi ∈ Fi, are pairwise disjoint then, replacing Fs by some
F,
F
that form an
(cid:3)
almost-matching.

= 1, we obtain s members F1, . . . , Fs−1, F of

F ∪ {
F1, . . . ,

Fs, where

2. We
for

−
Fi :=

F1, . . . ,

, Fs ⊂

Fs|

∈ F

F

F

F

\

|

Applying Theorem 1 yields

s

n

|Fi| ≤

m

1

−
2[n] be an up-set and suppose that for some 1

i=1
X

t=m (cid:18)
X

(cid:18)

(cid:19)

n

+ s

n
t

.
(cid:19)

Lemma 22. Let
Then ∂

satisﬁes

F ⊂

F

with equality if and only if

=

[n]
≥k

.

F

∂(

)

F

≥

n−1

Xi=k−1 (cid:18)

n
i

(cid:19)

k

≤

≤

n,

|F |

=

(59)

n
i=k

n
i

.

P

(cid:0)
(cid:1)
(60)

Let us ﬁrst deduce Theorem 20 from Lemma 22. By the lemma, if
(cid:1)
(cid:0)
then

and

>

n
t=m−1

n
t

or
|F |
, which contradicts (59). This yields
(cid:3)

P

>

(cid:0)

(cid:1)

n
t=m

n
t

|Fs|

=

n
t=m

n
[n]
t
≥m
|F |
the statement of the theorem.
(cid:1)
(cid:1)

F 6

=

(cid:0)

(cid:0)

P

P

(cid:0)

(cid:1)

Proof of Lemma 22. We apply induction on n. The cases n = 1, 2 are trivial, since
is
the only up-set of the given size. For n = 3, k = 1 we have one more shifted up-set, namely
. For this family one has strict inequality in (60).

P :

[3]

P

1

(cid:0)

(cid:1)

[n]
≥k

Suppose now that (60) is true for n and all k and let us prove it for n + 1 and all k. Note
n. First suppose that

that the cases k = 1, k = n + 1 are obvious and suppose that 1 < k

{

{

} ⊂

⊂

}

≤

is shifted.

F
Claim 23.

(1)

|F

| ≥

n+1
i=k

n
i−1

.

P

(cid:1)
Proof. The opposite would imply
(¯1)
n
hypothesis, ∂
i
F
G
, i.e., G
1
} ∈ F
the claim follows.

n+1
(cid:0)
i=k
n−1
n
i=k−1
j−1
(1). Noting that [n + 1]
(cid:1)

>
n+1
j=k

P
(cid:0)

|F
=

P
∈ F

(¯1)

∪ {

P

≥

(cid:0)

(cid:1)

|

n+1
i

(cid:0)
−
∈ F

n
i−1

=

n
i=k

n
i

−

1. By shiftedness, if G
(cid:1)
P
implies that [2, n + 1]

(cid:1)

(cid:0)

(cid:1)

(cid:0)

. By the induction
(¯1) then
∂
F
(1) as well,
(cid:3)

∈
∈ F

TWO PROBLEMS ON MATCHINGS IN SET FAMILIES – IN THE FOOTSTEPS OF ERD ˝OS AND KLEITMAN23

Applying the induction hypothesis for

(1)

∂

|

F

Together with the claim and the fact that ∂

F

(1) yields

n+1

n

| ≥

i
Xi=k (cid:18)
F ⊃ F

.

2

(cid:19)
−
(1) we infer

−
equivalent to the bound in Lemma 22.

∂

|

F | ≥

n+1

n

i
Xi=k (cid:18)

+

i

(cid:18)

1

(cid:19)

n

−

=

2
(cid:19)

n+1

Xi=k (cid:18)

n + 1
i
1

−

,
(cid:19)

In case of equality the induction hypothesis implies

for all F

. This in turn implies

∈ F

[n+1]
≥k

.

F ⊂

(1) =

[n]
≥k−1

F

(cid:0)

(cid:1)

Finally, we note that shifting does not change the size of the sets. Thus, Sij(
(cid:0)

(cid:1)

. By shiftedness,

k

|F | ≥

) =

[n+1]
≥k

F

. Therefore, the lemma is true for not necessarily shifted
(cid:1)
(cid:3)

(cid:0)

can only occur if already
families as well.

F

=

[n+1]
≥k

(cid:0)

(cid:1)

6. Conclusion

In this paper we have obtained several results related to families of sets with no s pairwise
disjoint sets. The stability results in the spirit of Theorem 3 have proven to be useful. We
have found two applications so far: to Conjecture 3 and to Erd˝os and Kleitman’s problem
on families with no matchings of size s, studied in [11].

The method we developed for the proof of Theorem 1 may be applied in diﬀerent scenarios.
Apart from the result on almost matchings, we have applied a modiﬁcation of this method
in [12] to determine the size of the largest families with no matchings of size 3 and 4, as well
as to an old problem concerning families with no partitions [13]. Similar ideas also appeared
in [10].

7. Acknowledgements

We thank the referees for carefully reading the text and pointing out numerous inaccuracies

in it. Thanks to their comments, the presentation of the paper has greatly improved.

References

[1] N. Alon, P. Frankl, H. Huang, V. R¨odl, A. Ruci´nski and B. Sudakov, Large matchings in uniform
hypergraphs and the conjectures of Erd˝os and Samuels, Journal of Combinatorial Theory, Series A 119
(2012), 1200–1215.

[2] B. Bollob´as, D.E. Daykin and P. Erd˝os, Sets of independent edges of a hypergraph, Quart. J. Math.

Oxford Ser. 27 (1976), N2, 25–32.

[3] D. Ellis, N. Keller and N. Lifshitz, Stability versions of Erd˝os-Ko-Rado type theorems, via isoperimetry,

arXiv:1604.02160

[4] P. Erd˝os, A problem on independent r-tuples, Ann. Univ. Sci. Budapest. 8 (1965) 93–95.
[5] P. Erd˝os and T. Gallai, On maximal paths and circuits of graphs, Acta Math. Acad. Sci. Hungar. 10

(1959), 337–356.

[6] P. Erd˝os, C. Ko and R. Rado, Intersection theorems for systems of ﬁnite sets, The Quarterly Journal

of Mathematics, 12 (1961) N1, 313–320.

24

PETER FRANKL AND ANDREY KUPAVSKII

[7] P. Frankl, The shifting technique in extremal set theory, Surveys in combinatorics, Lond. Math. Soc.

Lecture Note Ser. 123 (1987), 81–110, Cambridge University Press, Cambridge.

[8] P. Frankl, Improved bounds for Erd˝os’ Matching Conjecture, Journ. of Comb. Theory Ser. A 120 (2013),

1068–1072.

[9] P. Frankl, On the maximum number of edges in a hypergraph with given matching number, Discrete

Applied Mathematics 216 (2017), 562–581.

[10] P. Frankl, A. Kupavskii, New inequalities for families without k pairwise disjoint members, J. Comb.

Th. Ser. A 157 (2018), 427–434.

[11] P. Frankl and A. Kupavskii, Families with no s pairwise disjoint sets, Journal of the London Mathe-

matical Society 95 (2017), N3, 875–894.

[12] P. Frankl and A. Kupavskii, The largest families of sets with no matching of sizes 3 and 4,

arXiv:1701.04107

[13] P. Frankl and A. Kupavskii, Partition-free families of sets, arXiv:1706.00215
[14] P. Frankl and A. Kupavskii, Proof of the Erd˝os Matching Conjecture in a new range, preprint
[15] P. Frankl, T. Luczak, K. Mieczkowska, On matchings in hypergraphs, Electron. J. Combin. 19 (2012),

Paper 42.

[16] A.J.W. Hilton and E.C. Milner, Some intersection theorems for systems of ﬁnite sets, Quart. J. Math.

Oxford 18 (1967), 369–384.

[17] H. Huang, P. Loh and B. Sudakov, The size of a hypergraph and its matching number, Combin. Probab.

Comput. 21 (2012), 442–450.

[18] G. Katona, Intersection theorems for systems of ﬁnite sets, Acta Math. Acad. Sci. Hung. 15 (1964),

329–337.

[19] N. Keller and N. Lifshitz, The Junta Method for Hypergraphs and Chv´atal’s Simplex Conjecture,

arXiv:1707.02643 (2017).

[20] D.J. Kleitman, Maximal number of subsets of a ﬁnite set no k of which are pairwise disjoint, Journ.

of Comb. Theory 5 (1968), 157–163.

[21] A. Kostochka and D. Mubayi, The structure of large intersecting families, Proceedings of the American

Mathematical Society 145 (2016), N6, 2311–2321.

[22] A. Kupavskii, Explicit and probabilistic constructions of distance graphs with small clique numbers and

large chromatic numbers, Izvestiya: Mathematics 78 (2014), N1 59–89.

[23] T. Luczak and K. Mieczkowska, On Erd˝os’ extremal problem on matchings in hypergraphs, Journ. of

Comb. Theory, Ser. A 124 (2014), 178–194.

[24] L. ¨Ozkahya and M. Young, Anti-Ramsey number of matchings in hypergraphs, Discrete Mathematics

313 (2013), N20, 2359–2364.

[25] F. Quinn, PhD Thesis, Massachusetts Institute of Technology (1986).
[26] Y. Zhao, Recent advances on dirac-type problems for hypergraphs, In Recent Trends in Combinatorics,
volume 159 of the IMA Volumes in Mathematics and its Applications. Springer, New York, 2016.

R´enyi Institute, Budapest, Hungary; Email: peter.frankl@gmail.com

University of Birmingham and Moscow Institute of Physics and Technology; Email:

kupavskii@ya.ru.

