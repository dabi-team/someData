0
2
0
2
c
e
D
7
1

]
h
p
-
m
s
a
l
p
.
s
c
i
s
y
h
p
[

1
v
3
8
6
9
0
.
2
1
0
2
:
v
i
X
r
a

Draft version December 18, 2020
Typeset using LATEX manuscript style in AASTeX63

Detecting Reconnection Events in Kinetic Vlasov Hybrid Simulations Using

Clustering Techniques

Manuela Sisti

,1, 2 Francesco Finelli,2 Giorgio Pedrazzi,3 Matteo Faganello,1

Francesco Califano,2 and Francesca Delli Ponti3

1Aix-Marseille University, CNRS, PIIM UMR 7345, Marseille, France, EU

2Dipartimento di Fisica, Universit`a di Pisa, Italy, EU

3HPC Department, Cineca, Bologna, Italy, EU

(Received December 18, 2020; Revised; Accepted)

Submitted to ApJ

ABSTRACT

Kinetic turbulence in magnetized space plasmas has been extensively studied via in

situ observations, numerical simulations and theoretical models.

In this context, a

key point concerns the formation of coherent current structures and their disruption

through magnetic reconnection. We present automatic techniques aimed at detect-

ing reconnection events in large data set of numerical simulations. We make use of

clustering techniques known as K-means and DBscan (usually referred in literature as

unsupervised machine learning approaches), and other methods based on thresholds of

standard reconnection proxies. All our techniques use also a threshold on the aspect

ratio of the regions selected. We test the performance of our algorithms. We propose an

optimal aspect ratio to be used in the automated machine learning algorithm: AR=18.

Corresponding author: Manuela Sisti
manuela.sisti@univ-amu.fr

 
 
 
 
 
 
2

Sisti et al.

The performance of the unsupervised approach results to be strongly competitive with

respect to those of other methods based on thresholds of standard reconnection proxies.

Keywords: magnetic reconnection, methods: data analysis, methods: numerical, unsu-

pervised machine learning, Hybrid Vlasov Maxwell simulations

1. INTRODUCTION

Magnetic reconnection is an ubiquitous phenomenon observed in the laboratory as well as in many

space and astrophysical environments.

It is the energy driver for solar ﬂares and coronal mass

ejections (Priest 1982). It occurs routinely at the boundary between the solar wind and the Earth’s

magnetosphere (Dungey 1961; Priest & Forbes 2001), both at dayside and at magnetotail, or at the

ﬂanks induced by the presence of large-scale Kelvin-Helmholtz vortices (Faganello & Califano 2017).

An important outcome is the injection of accelerated particles into the magnetosphere. In the context

of turbulent plasmas, such as solar wind (Haynes et al. 2014; Osman et al. 2014) and magnetosheat

plasma (Retin`o et al. 2007), reconnection plays a central role representing a possible alternative path,

as compared to the usual vortex-vortex interaction, for energy transfer towards smaller and smaller

scales (Cerri & Califano 2017; Karimabadi et al. 2013; Camporeale et al. 2018). It is behind many of

the risks associated with space weather such as, for example, disturbs to Global Navigation Satellite

System signals, electronic damage to satellites or power grids (Cassak 2016).

Magnetic reconnection is probably the most known and important process in magnetized plasmas

for which Magnetohydrodynamics (MHD) accurately describe the evolution at large scales, where

the magnetic ﬁeld is frozen in the ﬂuid motion of the plasma and its topology is preserved.

In

this context, magnetic reconnection is the only process being able to rearrange the magnetic ﬁeld

topology on a global, MHD scale despite it occurs in a very narrow region of typical size of the

order of the ion kinetic scale length. The magnetic rearrangement, being on the large MHD scale,

is accompanied by a strong energy release due to the conversion of magnetic energy into plasma

ﬂow, particle acceleration, heating, and wave generation. The classical picture of reconnection is

obtained by considering a 2D domain where a large scale magnetic ﬁeld, the so called equilibrium,

3

presents an inversion line where it changes its direction. This is a 1D equilibrium conﬁguration,

since ∂x = ∂z = 0 while the inversion takes place along the y direction, that corresponds to a kinetic

equilibrium for the distribution functions known as the Harris sheet (Harris 1962). The 1D magnetic

ﬁeld can be represented as B = Bx(y) ex, directed along the x-axis and varying along the y-axis being

zero along the neutral line at a given y = y0. The corresponding out-of-plane current has a peak

and the region around is dubbed current sheet (hereafter CS) or current layer. In certain favorable

condition this layer becomes unstable to the 2D reconnection instability and the ideal MHD laws are

locally violated (Furth et al. 1963; White 1980; Priest & Forbes 2001) leading to the breaking and

reconnection of ﬁeld lines and eventually to the formation of an X-point like structures characterized

by an inﬂow/outﬂow ion and electron ﬂuid velocity advecting the magnetic ﬂux toward/away from

the reconnecting regions. Often in the laboratory but also in space, a mean out-of-plane magnetic

ﬁeld, Bgf = B0 ez, is associated to the CS. In this case the dynamics is quasi-2D and reconnecting

lines do not “cut&past” but actually slip across the CS changing their original connectivity, even

if their projection still seems to break and re-connect. This conﬁguration, the so-called guide-ﬁeld

regime, is often studied by means of 2D simulations.

In such a system, magnetic reconnection can be easily recognized. On the contrary, as soon as CSs

have more complex shapes, to ascertain the presence of reconnection is far less simple, e.g when CSs

are dynamically generated by 2D (Henri et al. 2012; Daughton et al. 2014) or 3D (Faganello et al.

2014; Borgogno et al. 2015; Sisti et al. 2019) Kelvin-Helmholtz vortices or, even worse, by magnetized

turbulence (Servidio et al. 2010; Zhdankin et al. 2013). For each of these cases a diﬀerent ad hoc

method has been developed, based on a deep knowledge of the peculiarity of each system.

For investigating the complex non-linear dynamics of such systems, numerical simulations are widely

used, providing also an important support for the understanding of satellite data. However this

approach generates an impressive amount of data to deal with, in particular when working with

kinetic simulations spanning the entire phase space. Large data sets, as well as the diﬃculty of easily

recognize reconnecting structures in these sets, suggest a possible application of machine learning

for reconnection analysis. Recently, in Dupuis et al. (2020), some machine learning techniques based

4

Sisti et al.

on signatures in the particle velocity distribution function in the phase space have been tested to

identify reconnection regions. Moreover, in Hu et al. (2020) for the same purpose to automatically

ﬁnd magnetic reconnection sites, supervised machine learning methods based on CNN (Convolutional

Neural Network) are used. In Hu et al. (2020) it has been shown that the supervised machine learning

approach turns out to perform very good and promising and that the algorithm seems to be capable

of detecting reconnection even in cases in which the human labelling has failed. However, the set

up of a large labelled training dataset is a long-term process which requires the contribution of a

number of experts in the ﬁeld. On the other hand, an unsupervised algorithm doesn’t require a

training dataset thus being more ﬂexible and quicker to be implemented (but not simpler). Here we

analyse the performances of unsupervised algorithms in order to prove that such an approach can be

an eﬃcient method to automatically detect reconnection. For this purpose, we set up an hybrid 2D-

3V (two-dimensional in space, three-dimensional in velocity space) simulation with kinetic ions and

ﬂuid electrons, describing the turbulent dynamics of a collisionless plasma where magnetic structures

and CSs, continuously generated by plasma motions, interact together and eventually coalesce or

disrupt due to magnetic reconnection. Beyond the physical interest of this simulation set on typical

solar wind turbulence parameters, it represents a good test for a machine learning approach since

reconnection occurs in a variety of diﬀerent conﬁgurations far from the idealized 1D Harris-like.

Aiming at developing an automatic procedure for the detection of physical structures of basic

interest, such as CSs and reconnecting structures, we have developed the following techniques. The

ﬁrst group relies on “standard” unsupervised machine learning techniques, such as K-means (in

particular Lloyd’s algorithm) (MacQueen 1967) and DBscan (Density Based Spatial Clustering of

Applications with Noise) (Ester et al. 1996). The second group instead is based on a number of

standard proxies used in the literature, and the deﬁnition of the corresponding thresholds, as markers

to detect and highlight the presence of a reconnection event. In particular we cite: current density,

electron vorticity and decoupling of the electron dynamics from the magnetic ﬁeld. Note that all

methods use physical quantities particularly suited to be considered as a signature of reconnection.

These quantities, extracted here from numerical simulations, are the ones usually measured by on-

5

board instruments of in-situ satellites. All methods are based on a ﬁnal fundamental step for selecting

reconnecting structures: the deﬁnition of a threhsold on the aspect ratio of the CSs. This threshold

is motivated by the physics of the reconnecting CSs whose shape (their typical lenght and width) is

not random but imposed by the development of the reconnection instability.

There exist several models of reconnection that could be used to extrapolate a reasonable value for

this threshold. The simplest one is the resistive Sweet-Parker model (Sweet 1958; Parker 1957) where

the CS length L and width δ depend on the local reconnection rate R, i.e. on the outﬂow velocity

(Cassak et al. 2017). Actually, the reconnection rate predicted from the Sweet-Parker model is too

slow to account for observations and simulations in collisionless plasmas. Other models such as the

so-called “fast reconnection” predict a reconnection rate of the order of ∼ 0.1, quite in agreement

with observations and simulation results recently found in the literature (Cassak et al. 2017). A

diﬀerent approach for the estimation of the CS aspect ratio relies on the role of the tearing mode

as a suﬃcient condition for reconnection to occur. By looking at the wavenumber km of the most

unstable mode in a CS of width δ, kmδ ∼ 2πδ/L ∼ 0.5, we get δ/L ∼ 0.08 (Karimabadi et al.

2005), not far from ∼ 0.1. In other words, there is a direct link between the aspect ratio and the

reconnection rate. Therefore, we make use of the aspect ratio to distinguish structures where most

probably reconnection is on-going using it as a threshold.

The paper is organized as follows.

In Section 2 the Hybrid Vlasov-Maxwell model (HVM) and

the 2D-3V simulation data are introduced.

In Section 3 we describe the methods developed to

automatically identify CSs and reconnecting regions. In particular in Section 3.1 we discuss about

our main method which uses the unsupervised machine learning techniques. In Section 3.2 and 3.3

we present other two alternative methods which don’t use machine learning but are still automatic

algorithms to locate reconnecting regions using standard reconnection proxies.

In Section 4 we

discuss the performances of these diﬀerent methods in ﬁnding reconnection sites. Finally, our results

are summarized in Section 5.

2. SIMULATION

6

Sisti et al.

To identify a wide panorama of reconnection sites emerging dynamically and not prepared ad-hoc,

we make use of a 2D-3V plasma turbulence simulation and use an hybrid model with kinetic ions

and ﬂuid electrons (with mass) (Valentini et al. 2007). This simulation is run using the HVM code

based on an Eulerian approach to solve the ion Vlasov equation (Mangeney et al. 2002) coupled

to the Maxwell equations but neglecting the displacement current and adopting the quasi-neutral

approximation, ni (cid:39) ne (cid:39) n. We use ion quantities to normalize the equations. These are: the
ion mass mi, the ion cyclotron frequency Ωci = e ¯B/mic, Alfv´en velocity vA = ¯B/
4πmin and so
the ion skin depth di = vAΩci. The electron skin depth reads de = (cid:112)me/mi, where me is the
electron mass. Finally ¯n, ¯B, ¯E and ¯f are the normalizing density, magnetic ﬁeld, electric ﬁeld

√

and distribution function, respectively. Then, the Vlasov equation for the ion distribution function

f = f (x, y, vx, vy, vz, t) reads:

∂f
∂t

+ v ·

∂f
∂x

+ (E + v × B) ·

∂f
∂v

= 0

The Ohm’s equation for the electron response reads:

E − d2

e∇2E = −ue × B −

1
n

∇Pe + d2

e∇ · [n (uu − ueue)]

(1)

(2)

where u = (cid:82) f v dv / (cid:82) f dv and ue are the ion and the electron ﬂuid velocities, respectively. Fur-

thermore n is given by n = (cid:82) f dv. Finally the dimensionless Faraday and Ampere laws read:

∇ × B = J ;

∂B
∂t

= −∇ × E

(3)

For the sake of simplicity, we take an isothermal closure: Pe = nT0e. In this approach electron

inertia (terms proportional to d2

e in Eq. 2) is a key ingredient since it allows for reconnection to occur

by decoupling the electrons from the magnetic ﬁeld.

We take a squared simulation box with L = Lx = Ly = 2π 50 using Nx = Ny = 3072 points. The

corresponding physics goes from the MHD ﬂuid-like behavior of the largest wavelength λ ∼ L to

the ion kinetic physics λ ∼ di (= 1 in dimensionless units) to the electron inertial scale, λ ∼ de. In

terms of the corresponding frequencies we are across the ion cyclotron physics (= 1 in dimensionless

7

Figure 1. Snapshot of the contour plots of current density |J| for two diﬀerent times of our simulation: a)

t = 247 [1/Ωci] (current sheets formed), b) t = 494 [1/Ωci] (fully-developed turbulence).

units). We set the magnitude of the initial guide ﬁeld along the z-direction equal to one. The initial

ion distribution function is given by a Maxwellian with corresponding uniform temperature. The

electron temperature is set equal to that of the ions, T0i = T0e. As a result, the plasma beta, the

ratio between the ﬂuid to the magnetic pressure, is equal to one (still in dimensionless units). We

sample the velocity space using 513 uniformly distributed grid point spanning [−5vth,i, 5vth,i] in each
direction, where vth,i = (cid:112)βi/2 is the initial ion thermal velocity. The mass ratio is mi/me = 100

allowing us to well separate the ion (di) and electron (de) skin depth. The simulation is initialized by

adding a isotropic magnetic perturbation given by the sum of sinusoidal modes with random phase.

The corresponding wave number interval is k ∈ [0.02, 0.12]. The corresponding root mean square

value of the magnetic ﬁeld is δBrms (cid:39) 0.28. In the initial phase, the initial perturbation starts to

produce a number of non interacting CSs where, later, at about one eddy turnover time ∼ 250,

associated to the largest perturbed wavelength, reconnection become eﬀective. After about two ion

turn over times the system reaches a fully developed turbulent state. Two snapshots of the current

density are shown in Fig.1 corresponding to the diﬀerent stages: when CSs are well formed (left

frame) and start to reconnect, and the fully developed turbulent state (right frame).

8

Sisti et al.

3. METHODS

In order to speed up the identiﬁcation of CSs and reconnecting structures, we develop three diﬀerent

techniques. The main one uses unsupervised machine learning, and will be addressed hereafter

as “AML”. Two other alternative algorithms, which don’t use machine learning, are developed in

order compare the performances; they will be addressed as “A1” and “A2”. A comparison between

these three methods will be presented hereafter. The physical quantities we use as variables for

detecting reconnection in AML are the current density magnitude J = |J|, the magnitude of the

in-plane electron ﬂuid velocity |ue,in−plane|, the magnitude of the in-plane magnetic ﬁeld |Bin−plane|,

the magnitude of the electron vorticity Ωe = |Ωe| = |∇ × ue|, the electron decoupling term Edec,e =

|(E + ue × B)z| and the energy conversion term J · (E + ue × B). The ﬁrst three variables are related

to the geometry of the CSs. The electron decoupling term describes the de-freezing of magnetic

ﬁeld lines from the electron ﬂuid motion. The last variable is a proxy which accounts for the energy

dissipation at the reconnection sites (Zenitani et al. 2011). In A1 and A2 we use only some of them,

in particular in A1 J, while in A2 J, Ωe and Edec,e.

The aspect ratio (hereafter AR) of reconnecting CSs is not random but it’s linked to reconnection

development, thus all our algorithms have a common step: a threshold on the AR of the CSs selected.

We deﬁne the AR as

AR =

length
width

(4)

for each structure found. We give an estimation for the CSs width and length using the automated

method explained in Califano et al. (2020) and references therein. Note that for methods A1 and

A2 the CSs are deﬁned as region where the current density J is greater than a certain thresholds, as

deﬁned in Zhdankin et al. (2013), while in AML, we make use of a diﬀerent technique to deﬁne the

CSs in the physical space (as explained in the following sections). Anyway, once a CS is deﬁned as

a collection of grid points in the 2D physical space, the automated procedure computes the Hessian

matrix H of |J| at the current peak (the local maximum of J). We look at the interpolated proﬁle of

J along the direction given by the eigenvector associated to the largest eigenvalue of H and deﬁne the

9

CS’s width as the full width at half maximum of J. A similar procedure for computing the length (i.e.

interpolating J along the direction of the eigenvector associated to the smallest eigenvalue) would

be misleading because in a turbulent system CSs are seldom “straight” along that direction. We

give an automated estimation for the length by computing the maximal distance between two points

belonging to the same structure, similarly to what done in Zhdankin et al. (2013) where, however,

the CSs are deﬁned using a threshold on the current density.

It is worth noticing that all the variables we use are available in satellite data sets. In particular |ue|

and |B| are directly measured by on-board instruments, while J = |n(u−ue)|, Edec,e = |(E+ue ×B)z|

and J · (E + ue × B) are simple algebraic combinations of measured quantities.

|ue,in−plane| and

|Bin−plane| can be computed by setting the out-of-plane direction aligned with the average (local)

magnetic ﬁeld. Finally Ωe and AR can be calculated by measured quantities and spacecrafts’ relative

positions in the case of multi-satellite missions as CLUSTER or MMS (Dunlop et al. 2002; Fadanelli

et al. 2019).

3.1. AML

The core of the ﬁrst method is constituted by two unsupervised machine learning algorithms: K-

means (Lloyd’s algorithm) and DBscan (Density Based Spatial Clustering of Applications with Noise).

These are both clustering techniques aimed at learning a grouping structure in a data-set. K-means

algorithm requires to set the parameter “K” corresponding to the number of clusters we expect to

ﬁnd in our data-set in the variable space. To ﬁx the parameter “K” we make a pre-processing step

in which we tune the best value of “K” for our data. Our approach then summarizes in the following

steps:

1) Pre-processing step for the tuning of the “K” parameter for the K-means algorithm using a cross-

validation-like approach with the Davis-Bouldin index applied to the predicted clusters as internal

cluster metric (Rhys 2020). The tuning is applied in the variable space deﬁned at the beginning

of Section 3. We choose to tune the “K” value at about one eddy-turnover time (t (cid:39) 247 [1/Ωci]),

corresponding to the phase when CSs are well formed but still not interacting one each other. The

10

Sisti et al.

Figure 2. Value of the David-Bouldin index as a function of possible “K” from K = 5 to K = 15, for

t = 247 [1/Ωci]. The David-Bouldin index has a minimum for K = 11.

result of the tuning is shown in Figure 2. The best “K” value is the one for which the David-Bouldin

index reaches its minimum, in our case it turns out to be K = 11, as shown in Fig.2.

2) K-means (Llyod’s algorithm) is applied to the chosen variables which we list here again: the

current density magnitude J = |J|, the magnitude of the in-plane electron ﬂuid velocity |Ve,in−plane|,

the magnitude of the in-plane magnetic ﬁeld |Bin−plane|, the magnitude of the electron vorticity

Ωe = |Ωe| = |∇ × Ve|, the electron decoupling term (i.e., Edec,e = |(E + Ve × B)z|) and the energy

conversion term J · (E + ue × B). These variables are normalized between 0 and 1. This is a common

requirement for many machine learning estimators, since in non-normalized data-set the presence of

outliers could alter the result. The K-means algorithm returns K = 11 clusters in the variable space,

as we show in Table 1 for time t ∼ 247 [1/Ωci].

In Table 1 we report for each cluster the mean value of our variables (in dimensionless units) and

the number of grid points which belong to it. Among these clusters we choose to analyze the one

Cluster

|J|

|Ve|

|Ωe| Edec,e10−2

|Bin−plane|

|J · (E + Ve × B)|10−3 Grid point number

11

1

2

3

4

5

6

7

8

9

10

11

0.369 0.253 1.239

0.031

0.138

0.930

0.059

0.125

0.162

0.036

0.239

0.049

0.033

0.173

0.055

0.027

0.078

0.045

0.031

0.145

0.040

0.025

0.153

0.031

0.022

0.063

0.023

0.022

0.069

0.029

0.022

0.070

0.024

0.021

0.128

0.022

0.021

0.022

0.021

0.021

0.021

0.021

0.021

0.021

0.021

0.021

0.402

0.109

0.242

0.286

0.049

0.168

0.072

0.207

0.144

0.108

0.170

0.079

0.060

0.053

0.062

0.041

0.039

0.039

0.037

0.034

37 776

160 928

593 803

660 889

685 840

813 751

1 165 723

1 243 427

1 278 303

1 325 111

1 471 633

Table 1. The eleven clusters in the variable space of our data-set which result from the application of the

K-means algorithm to t ∼ 247 [1/Ωci]. For each cluster, identiﬁed by an index, we report the mean value of

our variables and the number of grid points which belong to it. In bold the “interesting” cluster with the

highest value of mean current density.

with the highest mean value of the current density (since a necessary condition for reconnection to

occur is the presence of a peak in the current density value), which is cluster “1”. This particular

cluster in the variables space is made-up of diﬀerent structures in the physical space of our box. In

Figure 3, top panel, we draw in the simulation (x, y) space domain the shaded iso-contours of the

eleven clusters calculated by K-means (in the variables space). Cluster 1 is represented by the red

color, the others by the diﬀerent blue variations. In the same Figure, bottom panel, we draw the

shaded iso-contours of cluster 1 regions (red) superimposed to the contour shaded plots of the current

density |J|, suggesting that cluster 1 roughly corresponds to the ensemble of CSs.

It is worth noticing that other unsupervised methods are suitable for the same purpose such as,

for instance, the K-medoids technique. In particular, by applying K-medoids at t=247 we did not

observed any signiﬁcant improvement of the results. Therefore, K-means turns out to be a very good

approach in this context, a baseline for this kind of analysis.

12

Sisti et al.

Figure 3. Top panel: the regions which constitute all eleven clusters in the variable space; in red cluster

“1”, while in various shades of blue all other clusters (please note that any of the colors refers to a physical

variable). Bottom panel: the regions which constitute cluster “1” (the interesting one) in the variable space,

in red, superimposed to the contour plot of current density |J|.

13

Figure 4. Contour plot of current density |J|. In diﬀerent colors the diﬀerent structures identiﬁed through

DBscan algorithm applied to cluster “1” of Table 1.

3) DBscan. From Figure 3 we see that cluster 1 in the variable space is composed by diﬀerent

structures in physical space. Thus we need another algorithm able to distinguish diﬀerent structures

using their location in physical space. A technique which is suited for this scope is DBscan, which

takes as input the x and y-coordinates of the points belonging to cluster 1. We take as searching

radius for DBscan (cid:15) = 50 grid points which correspond to about 5di, and M in pts = 100 points, as

the minimum number of points for a single structure, where (cid:15) and M in pts are intrinsic variables

of the DBscan algorithm. The results obtained by using DBscan are shown in Figure 4 where the

diﬀerent colors represent the diﬀerent structures that are identiﬁed.

We underline the fact that DBscan is not used here for image analysis but only for “cutting” cluster

1 in diﬀerent subsets corresponding, in physical space, to diﬀerent structures. Figure 3 and 4 help

humans in visualizing the correspondence between these subsets and CSs where reconnection could

occur.

14

Sisti et al.

4) Threshold on the AR of structures found. For each structure found at step 3 we compute the

AR (see Section 3, Eq. 4). We consider diﬀerent possible thresholds for the AR to get the better

performance. In particular we have tried the following values: 10, 12.5, 20, 30, 50 and 70.

A1 is the simplest algorithm to identify structures. It is based on two step:

3.2. A1

1) A threshold on the current density |J| deﬁned as Jthr =

< J 2 > +3σ, where σ =
(cid:112)< J 4 > −(< J 2 >)2, see Zhdankin et al. (2013). More precisely, we select all regions in the physical

√

space where the current density overcomes the threshold Jthr. However, since a region of enhanced

current is a necessary condition but not a suﬃcient one for reconnection, we add a second step.

2) A threshold on the AR of the structures in order to select the most probably reconnecting

structures. As done in AML, we consider diﬀerent possible threshold values on AR: 10, 12.5, 20, 30,

50 and 70.

3.3. A2

A2 is a reﬁnement of A1. Another step is added in order to increase the precision in ﬁnding

reconnection events. The method is summarized as follows.

1) As in A1 we ﬁx a threshold on the current density and select the regions which overcome this

threshold.

2) We look at each structure and we select only the ones which include some points (at least two)

which overcome both a threshold over electron vorticity Ωe and over Edec,e.
e > +3σΩ, where σΩ = (cid:112)< Ω4
two thresholds are deﬁned as: Ωe,thr = (cid:112)< Ω2
< E4

dec,e > +3σE, where σE =

dec,e > −(< E2

Edec,e,thr =

dec,e >)2.

< E2

(cid:113)

(cid:113)

In particular these

e > −(< Ω2

e >)2, and

3) Finally, as in A1, we set a threshold on the AR of the selected structures. Also in this case, we

consider diﬀerent possible values for the AR: 10, 12.5, 20, 30, 50 and 70.

In Table 2 we give a summary of the steps of each method, while in Figure 5 we show a ﬂow-chart

to sketch the selection procedure to detect possible reconnecting structures.

4. RESULTS

15

Figure 5. Flow-chart for the three methods we are considering.

Once three sets of candidate reconnecting structures have been selected using the three diﬀerent

methods (see ﬂow-chart in Figure 5), we estimate the accuracy of these techniques by looking at

candidate sites one by one. In particular, we check if reconnection is going on in each single site

by looking if typical signatures of reconnection are present: inversion of the in-plane magnetic ﬁeld,

X-point conﬁguration of the magnetic ﬂux Ψ, converging electron inﬂows toward the X-point and

diverging outﬂows, magnetic ﬂuctuation along the guide-ﬁeld direction, peaked electron decoupling

and energy conversion terms.

Now, to compare quantitatively the performances of the three algorithms AML, A1 and A2 for

diﬀerent values of the AR threshold. We deﬁne the following quality-parameters:

16

Sisti et al.

Method Steps

AML

0) Selection of physical variables we want to use

1) pre-processing: tuning of “K” value for the K-means

2) K-means on variable space

3) DBscan on physical space

4) threshold on aspect ratio

A1

1) threshold on the current density |J| in the physical space

2) threshold on the aspect ratio

A2

1) threshold on the current density |J| in the physical space

2) request of points which overcome thresholds on |Ωe| and Edec,e

3) threshold on the aspect ratio

Table 2. Summary of the steps for each method.

Precision =

# reconnecting structures among selected structures
# selected structures

nMR-precision =

# non-reconnecting structures among excluded structures
# excluded structures

(5)

(6)

where the selected/excluded structures are all those possible reconnection regions whose ARs over-

come/don’t overcome the AR threshold as schematized in the ﬂow-chart in Figure 5.

The best algorithm performance is obtained when both precision and nMR-precision (which stands

for non-magnetic-reconnection precision) are ∼ 1. Indeed, in this case we would have at the same

time that the algorithm has selected only reconnection sites and has not excluded reconnection sites.

In Table 3, 4 and 5 we show the values of these quality-parameters for AML, A1 and A2, respectively,

and for diﬀerent AR thresholds. The results are shown at ﬁve time instants of our simulation: t1 ∼ 20

[1/Ωci] (initial phase, no evidence of CS structures, t2 ∼ 230 [1/Ωci], t3 ∼ 247 [1/Ωci], t4 ∼ 282

[1/Ωci] (CS developed regime), t5 ∼ 494 [1/Ωci] (fully developed turbulence). We will refer to these

three distinct phases as phase I, II and III. In the last two columns we list the mean value of our

quality-parameters during phase II, t = t2, t3, t4 and during phase II and III, t = t2, t3, t4, t5.

Looking at Table 3 corresponding to AML we observe: a) precision increases when AR threshold

17

increases, b) nMR-precision decreases when AR threshold increases, meaning that we are loosing

“good” (reconnecting) sites, c) precision worsen when we include in our analysis phase III (turbulent

regime). Same conclusions are drawn by looking at Table 4 and 5, corresponding to methods A1 and

A2. In order to ease the comparison for the diﬀerent performances, we plot in Figure 6 precision

(solid red, dashed orange and dotted brown lines, AML, A1 and A2, respectively) and nMR-precision

(solid blue, dashed cyan and dotted violet lines, AML, A1 and A2, respectively) averaged over phase

II (left panel) and over phase II and III (right panel) as a function of the AR threshold. By comparing

these plots, left panel, we see that the unsupervised machine learning algorithm AML turns out to

be strongly competitive with respect to the methods based on thresholds on standard proxies. In

particular precision performs better for AML rather than for A1. For what concerns A2, we see

that the precision appears to be less inﬂuenced by the AR threshold variations. In particular, the

precision of A2 (brown dotted line) turns out to be better at small AR thresholds than for AML; on

the other hand, the nMR-precision (dotted violet line) worsen, so that lots of “good” reconnection

sites are excluded. The same holds when including in the average the values at t = t5 (fully developed

turbulent phase), see the right panel of Figure 6. However, and this is a quite general result, precision

and nMR-precision worsen a bit when considering the full turbulent phase. This worsening is the

consequence of the dynamics driven by the turbulence which advects, shrinks, breaks and deforms the

CSs. This dynamics together with the merging of nearby structures typical of a 2D geometry makes

much more diﬃcult a correct estimation of the typical width and length. Moreover, turbulence also

creates regions with sharp variations in current density where, however, reconnection is not occurring

thus “confusing” the various Methods and decreasing their accuracy. Except for this worsening in

precision at the end of the simulations, all Methods perform well both during the initial phase I when,

correctly, no reconnection sites are detected, as well as during the central phase II when the CSs are

well detected. According to us, it is possible to deﬁne an optimal AR threshold for AML and A1,

which corresponds to a compromise between having a good precision and not loosing lots of good

reconnection sites. For AML, this optimal AR threshold corresponds to the one at the intersection

between the plot of precision (left panel of Figure 6, red solid line) and the plot of nMR-precision

18

Sisti et al.

Figure 6. Plots of the values of precision (red, orange and brown lines) and nMR-precision (blue, cyan and

violet lines) averaged over the three central times (left panel) and over four times (right panel), as a function

of the AR threshold, for the three diﬀerent Methods we are analyzing: solid line, AML; dashed line, A1;

dotted line, A2.

(left panel of Figure 6, blue solid line). In this case, we get AR (cid:39) 18, which gives a precision and

nMR-precision accuracy of the order of 78%. For A1, the same is obtained for AR (cid:39) 14 with a score

of (cid:39) 71%. In both cases AR values are in agreement with theoretical estimations. For A2, it is not

possible to make the same estimation of the optimal AR since the two plots do not intersect; this

is a limitation of A2. Finally, in our simulation the performance of AML method improves a bit

(reaching 80%) if we use, in the variable set, J · (E + ue × B + ∇Pe

ne ) instead of J · (E + ue × B).

This can be due to the fact that in our model we consider a scalar pressure, thus, in the absence of

oﬀ-diagonal terms in the pressure tensor, this term doesn’t contribute to the eﬀective Ohmic heating

(Birn & Hesse 2010).

5. CONCLUSIONS

Tempo [1/Ωci]

N. structures

N. structures

AR > 10

AR > 12.5

AR > 20

AR > 30

AR > 50

AR > 70

precision

AR > 10

AR > 12.5

AR > 20

AR > 30

AR > 50

AR > 70

nMR-precision AR < 10

AR < 12.5

AR < 20

AR < 30

AR < 50

AR < 70

20

35

0

0

0

0

0

0

–

–

–

–

–

–

1

1

1

1

1

1

230

247

282

494 Mean (3t) Mean (4t)

19

29

17

16

14

10

6

3

19

17

17

15

10

9

7

24

21

20

14

13

12

6

32

28

25

19

12

7

4

0.65 0.82 0.67 0.43

0.69 0.82

0.7

0.36

0.79 0.80 0.79 0.42

0.8

1

1

0.92

0.92

1

1

1

1

1

0.77 0.33

0.75 0.43

0.83 0.75

1

1

1

0.57

0.93

0.5

0.7

0.69

0.79 0.55 0.64

0.6

0.74

0.5

0.58 0.64

0.65 0.42

0.5

0.68

0.71

0.74

0.79

0.82

0.92

0.94

0.97

0.97

0.71

0.66

0.61

0.52

0.64

0.64

0.7

0.72

0.79

0.89

0.98

0.87

0.7

0.64

0.61

0.56

Table 3. Number of structures found, precision and nMR-precision for AML, for diﬀerent AR threshold

(from 10 to 70). The results are shown for ﬁve diﬀerent times of our simulation: t ∼ 20 [1/Ωci], t ∼ 230

[1/Ωci], t ∼ 247 [1/Ωci], t ∼ 282 [1/Ωci], t ∼ 494 [1/Ωci]. In the last two columns we report the mean value

of our quality-parameters for the three central times (230, 247, 282) and for four times (230, 247, 282, and

494). In the second row we list the number of structures found at the end of the third step; in rows from 3rd

to 8th we give the number of detected structures overcoming the speciﬁed AR threshold. In rows from 9th to

14th we give the values of precision for diﬀerent AR threshold computed among the structures enumerated

in rows 3-8; ﬁnally in rows 15th to 20th the same for nMR-precision.

20

Sisti et al.

Tempo [1/Ωci]

N. structures

N. structures

AR > 10

AR > 12.5

AR > 20

AR > 30

AR > 50

AR > 70

precision

AR > 10

AR > 12.5

AR > 20

AR > 30

AR > 50

AR > 70

nMR-precision AR < 10

AR < 12.5

AR < 20

AR < 30

AR < 50

AR < 70

20

11

0

0

0

0

0

0

–

–

–

–

–

–

1

1

1

1

1

1

230

247

282

494 Mean (3t) Mean (4t)

45

22

20

15

13

11

6

47

23

20

15

12

9

6

52

18

17

12

10

7

5

454

88

70

43

26

11

4

0.68 0.61 0.61 0.26

0.75

0.7

0.59 0.27

0.8

0.8

0.75 0.33

0.77 0.83

0.8

0.35

0.82

1

1

1

0.86 0.36

0.8

0.25

0.74 0.71 0.65 0.90

0.76 0.74 0.63 0.90

0.7

0.72 0.65 0.89

0.66 0.68 0.64 0.88

0.65 0.68 0.62 0.88

0.61 0.63 0.60 0.87

0.63

0.68

0.78

0.8

0.89

0.93

0.7

0.71

0.69

0.66

0.65

0.61

0.54

0.58

0.67

0.69

0.76

0.76

0.75

0.76

0.74

0.71

0.71

0.68

Table 4. Number of structures found, precision and nMR-precision for A1, for diﬀerent AR threshold (from

10 to 70). The results are shown for ﬁve diﬀerent times of our simulation: t ∼ 20 [1/Ωci], t ∼ 230 [1/Ωci],

t ∼ 247 [1/Ωci], t ∼ 282 [1/Ωci], t ∼ 494 [1/Ωci]. In the last two columns we report the mean value of our

quality-parameters for the three central times (230, 247, 282) and for four times (230, 247, 282, and 494).

In the second row we list the number of structures found at the end of the third step; in rows from 3rd to

8th we give the number of detected structures overcoming the speciﬁed AR threshold. In rows from 9th to

14th we give the values of precision for diﬀerent AR threshold computed among the structures enumerated

in rows 3-8; ﬁnally in rows 15th to 20th the same for nMR-precision.

Tempo [1/Ωci]

N. structures

N. structures

AR > 10

AR > 12.5

AR > 20

AR > 30

AR > 50

AR > 70

precision

AR > 10

AR > 12.5

AR > 20

AR > 30

AR > 50

AR > 70

nMR-precision AR < 10

AR < 12.5

AR < 20

AR < 30

AR < 50

AR < 70

20

230

247

282

494 Mean (3t) Mean (4t)

21

2

0

0

0

0

0

0

–

–

–

–

–

–

1

1

1

1

1

1

30

21

19

16

13

11

6

27

18

17

14

11

9

6

26

12

11

10

9

7

5

126

52

43

29

20

8

3

0.76 0.78 0.92 0.33

0.84 0.82 0.91 0.33

0.81 0.86

0.9

0.38

0.77 0.91 0.89

0.4

0.82

1

1

1

0.86 0.37

0.8

0.33

0.89 0.44 0.64 0.81

0.91

0.5

0.6

0.79

0.71 0.46 0.56 0.79

0.59 0.44 0.53 0.78

0.58 0.44 0.47 0.77

0.82

0.86

0.86

0.86

0.89

0.93

0.66

0.67

0.58

0.52

0.5

0.54 0.38 0.43 0.76

0.45

0.70

0.72

0.74

0.74

0.76

0.78

0.69

0.7

0.63

0.58

0.56

0.53

Table 5. Number of structures found, precision and nMR-precision for A2, for diﬀerent AR threshold (from

10 to 70). The results are shown for ﬁve diﬀerent times of our simulation: t ∼ 20 [1/Ωci], t ∼ 230 [1/Ωci],

t ∼ 247 [1/Ωci], t ∼ 282 [1/Ωci], t ∼ 494 [1/Ωci]. In the last two columns we report the mean value of our

quality-parameters for the three central times (230, 247, 282) and for four times (230, 247, 282, and 494).

In the second row we list the number of structures found at the end of the third step; in rows from 3rd to

8th we give the number of detected structures overcoming the speciﬁed AR threshold. In rows from 9th to

14th we give the values of precision for diﬀerent AR threshold computed among the structures enumerated

in rows 3-8; ﬁnally in rows 15th to 20th the same for nMR-precision.

22

Sisti et al.

Summarizing, we developed three diﬀerent Methods aimed at automatically detecting reconnecting

CSs in 2D simulation of turbulence. AML uses unsupervised machine learning techniques for the

scope, while Methods A1 and A2 use only thresholds on the standard reconnection proxies. All

Methods are based on a threshold on the structures’ AR since the AR is directly linked to the

reconnection rate and is a physical adimensional parameter independent from all simulations set up.

We have deﬁned two diﬀerent quality parameters in order to estimate quantitatively the performance

of our algorithms: precision, which gives a measure of the capability of the method to select good

reconnection sites, and nMR-precision, which gives us an information about excluded regions, in

particular how many of them are really not reconnecting sites. In other words, it is an information

about good sites excluded. AML is the one which performs the best. Moreover, although A2 has

a better precision at smallest AR threshold, for AML nMR-precision is better, and it is possible to

deﬁne for it an optimal AR (as the intersection between the plot of precision an nMR-precision) which

instead cannot be done for A2. The impossibility to deﬁne an optimal AR for A2, together with the

bad values of nMR-precision for this method (lots of good sites lost), brings us to the conclusion that

A2 is not the best method to be applied. Considering only time periods where CSs are formed but still

not interacting or signiﬁcantly aﬀected by the turbulent dynamics, we found for AML an optimal AR

of about 18, which gives both a precision and a nMR-precision of ∼ 78%. These average performances

worsen a bit if we consider also times at developed turbulence. This worsening is expected since at

the fully-developed turbulent phase the dynamics advects, shrinks, breaks and deforms the CSs.

Moreover, CS merging could lead to problems in separating diﬀerent peaks and developed turbulence

creates regions with sharp variations in current density where, however, reconnection is not occuring

thus “confusing” the automatic Methods and decreasing their accuracy. Despite this worsening during

the fully developed turbulent phase, the automatic Methods (and in particular the AML one) are

still valid supports for speeding up reconnection site identiﬁcation. In principle they could be applied

to any plasma simulation including multiple potential reconnection sites, eﬃciently providing a list

of “candidate” sites for a detailed human-based reconnection analysis.

23

These automatic Methods are not based on the analysis of images as, for instance, 2D charts of

simulation data, but use physical, measured variables as relevant signatures of reconnection. These

quantites, here taken from numerical simulations, are also available in satellite data sets. We are

presently working on adapting these methods to the analysis of data collected on 1D trajectories,

more precisely cuts in the simulation plane or temporal series in the case of a satellite surveying

plasma/magnetic structures. Such an upgrade would greatly improve the analysis of magnetic recon-

nection in satellite data, quickly highlighting interesting temporal intervals with active reconnection

randomly scattered in the huge amount of data produced by past and present missions.

We stress also the importance of setting on a threshold for the CS’s AR for better the performaces

of our Methods. Indeed the aspect ratio of a reconnecting current sheet is a physical, adimensional,

simulation independent parameter directly linked to the reconnection process. The increasing of the

precision with the AR threshold value is linked to the fact that once the characteristic length of

the reconnecting structure is ﬁxed (by the boundaries of adjacent ﬂux ropes), reconnection is able

to eﬀectively shrink its width, leading to increasing values of aspect ratio. However, by increasing

the AR threshold too much above the theoretical estimation would lead to incorrect results since an

excessive thinning corresponds to a strongly non linear phase eventually leading to to the break of

the site in smaller magnetic islands. In fact nMR-precision worsens for too large AR threshold as

reconnection itself limits the AR of the CS. As a consequence, we propose an optimal AR threshold

for which both precision and nMR-precision perform well. We conclude by saying that the AML

method, based on the machine learning approach, turns out to be the most performing one.

In the context of the EU AIDA project, we are presently working to set up a tool, namely

Unsupervised ML Reconnection,

in Python language for the AML method. This tool will be-

come available, free-to-use, in the online AIDA-repository at https://gitlab.com/aidaspace/aidapy

aimed at being of utility for the (space) plasma physics community. As for today, some prelimi-

nary scripts are available at https://gitlab.com/aidaspace/aidapy/-/tree/unsupervised reconnection/

aidapy/WIP-unsupervised reconnection, and also on Zenodo at https://doi.org/10.5281/zenodo.

24

Sisti et al.

4282289. Finally, the simulation data-set (TURB 2D) is available at Cineca AIDA-DB. In order

to access the meta-information and the link to “TURB 2D” simulation data look at the tutorial at

http://aida-space.eu/AIDAdb-iRODS.

ACKNOWLEDGMENTS

This project has received funding from the European Union’s Horizon 2020 research and innovation

programme under grant agreement No 776262 (AIDA, www.aida-space.eu). Numerical simulations

discussed here have been performed on Marconi at Cineca (Italy) under the ISCRA initiative. One of

us, FC, thank Dr. M. Guarrasi (Cineca, Italy) for his essential contribution for the implementation

of the kinetic Vlasov code on Marconi supercomputer at Cineca (Italy).

REFERENCES

Birn, J., & Hesse, M. 2010, Physics of Plasmas,

Cerri, S. S., & Califano, F. 2017, New Journal of

17, 012109, doi: 10.1063/1.3299388

Physics, 19, 025007,

Borgogno, D., Califano, F., Faganello, M., &

doi: 10.1088/1367-2630/aa5c4a

Pegoraro, F. 2015, Physics of Plasmas, 22,

Daughton, W., Nakamura, T. K. M., Karimabadi,

032301, doi: 10.1063/1.4913578

H., Roytershteyn, V., & Loring, B. 2014,

Califano, F., Cerri, S. S., Faganello, M., et al.

2020, Frontiers in Physics, 8, 317,

doi: 10.3389/fphy.2020.00317

Camporeale, E., Sorriso-Valvo, L., Califano, F., &

Retin`o, A. 2018, Physical review letters, 120,

125101

Cassak, P. A. 2016, Space Weather, 14, 186,

doi: 10.1002/2015SW001313

Physics of Plasmas, 21, 052307,

doi: 10.1063/1.4875730

Dungey, J. W. 1961, Physical Review Letters, 6,

47

Dunlop, M. W., Balogh, A., Glassmeier, K. H., &

Robert, P. 2002, Journal of Geophysical

Research (Space Physics), 107, 1384,

doi: 10.1029/2001JA005088

Dupuis, R., Goldman, M. V., Newman, D. L.,

Cassak, P. A., Liu, Y.-H., & Shay, M. 2017,

Amaya, J., & Lapenta, G. 2020, The

Journal of Plasma Physics, 83, 715830501,

doi: 10.1017/S0022377817000666

Astrophysical Journal, 889, 22,

doi: 10.3847/1538-4357/ab5524

25

Ester, M., Kriegel, H.-P., Sander, J., & Xu, X.

MacQueen, J. B. 1967, in Proceedings of 5-th

1996, in Proceedings of the Second International

Berkeley Symposium on Mathematical

Conference on Knowledge Discovery and Data

Statistics and Probability (Berkeley, University

Mining, KDD’96 (AAAI Press), 226–231

of California Press), 281–297

Fadanelli, S., Lavraud, B., Califano, F., et al.

Mangeney, A., Califano, F., Cavazzoni, C., &

2019, Journal of Geophysical Research (Space

Travnicek, P. 2002, Journal of Computational

Physics), 124, 6850, doi: 10.1029/2019JA026747

Physics, 179, 495–538,

Faganello, M., & Califano, F. 2017, Journal of

doi: 10.1006/jcph.2002.7071

Plasma Physics, 83,

doi: 10.1017/S0022377817000770

Faganello, M., Califano, F., Pegoraro, F., &

Retin`o, A. 2014, EPL (Europhysics Letters),

107, 19001, doi: 10.1209/0295-5075/107/19001

Furth, H. P., Killeen, J., & Rosenbluth, M. N.

1963, The Physics of Fluids, 6, 459,

doi: 10.1063/1.1706761

Harris, E. G. 1962, Il Nuovo Cimento, 23, 115,

doi: https://doi.org/10.1007/BF02733547

Haynes, C. T., Burgess, D., & Camporeale, E.

2014, The Astrophysical Journal, 783, 38

Henri, P., Califano, F., Faganello, M., & Pegoraro,

F. 2012, Physics of Plasmas, 19, 072908,

doi: 10.1063/1.4739234

Hu, A., Sisti, M., Finelli, F., et al. 2020, The

Astrophysical Journal, 900, 86,

doi: 10.3847/1538-4357/aba527

Karimabadi, H., Daughton, W., & Quest, K. 2005,

Journal of Geophysical Research, 110,

doi: 10.1029/2004JA010749

Osman, K., Matthaeus, W., Gosling, J., et al.

2014, Physical Review Letters, 112, 215002,

doi: 10.1103/PhysRevLett.112.215002

Parker, E. N. 1957, Journal of Geophysical

Research (1896-1977), 62, 509,

doi: 10.1029/JZ062i004p00509

Priest, E. R. 1982, Solar Magnetohydrodynamics

(Springer Netherlands),

doi: 10.1007/978-94-009-7958-1

Priest, E. R., & Forbes, T. G. 2001, Journal of

Plasma Physics, 66, 363 ,

doi: 10.1017/S0022377802221649

Retin`o, A., Sundkvist, D., Vaivads, A., et al. 2007,

Nature Physics, 3, 235–238,

doi: 10.1038/nphys574

Rhys, H. 2020, Machine Learning with R, the

tidyverse, and mlr (Manning Publications).

https:

//books.google.it/books?id=jRzYDwAAQBAJ

Servidio, S., Matthaeus, W., Shay, M., et al. 2010,

Physics of Plasmas, 17, doi: 10.1063/1.3368798

Sisti, M., Faganello, M., Califano, F., & Lavraud,

Karimabadi, H., Roytershteyn, V., Wan, M., et al.

B. 2019, Geophysical Research Letters, 46,

2013, Physics of Plasmas, 20, 012303

11597

26

Sisti et al.

Sweet, P. A. 1958, IAU Symp. 6, 123.

White, R. 1980, Resistive instabilities and ﬁeld

https://ci.nii.ac.jp/naid/10003947733/en/

line reconnection (Oﬃce of Scientiﬁc and

Technical Information (OSTI)),

doi: 10.2172/5423144

Zenitani, S., Hesse, M., Klimas, A., & Kuznetsova,

Valentini, F., Califano, F., Hellinger, P., &

Mangeney, A. 2007, Journal of Computational

Physics, 225, 753, doi: 10.1016/j.jcp.2007.01.001

M. 2011, PhRvL, 106, 195003,

doi: 10.1103/PhysRevLett.106.195003

Zhdankin, V., Uzdensky, D., Perez, J., &

Boldyrev, S. 2013, The Astrophysical Journal,

771, doi: 10.1088/0004-637X/771/2/124

