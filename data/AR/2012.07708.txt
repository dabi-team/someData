0
2
0
2
c
e
D
4
1

]

R
S
.
h
p
-
o
r
t
s
a
[

1
v
8
0
7
7
0
.
2
1
0
2
:
v
i
X
r
a

Solar Physics
DOI: 10.1007/•••••-•••-•••-••••-•

Simulating the Coronal Evolution of Bipolar Active
Regions to Investigate the Formation of Flux Ropes

· D. H. Mackay1

· L.

S. L. Yardley1
M. Green2

© Springer ••••

Abstract The coronal magnetic ﬁeld evolution of 20 bipolar active regions
(ARs) is simulated from their emergence to decay using the time-dependent
nonlinear force-free ﬁeld method of Mackay, Green and van Ballegooijen (2011).
A time sequence of cleaned photospheric line-of-sight magnetograms, that covers
the entire evolution of each AR, is used to drive the simulation. A comparison
of the simulated coronal magnetic ﬁeld with the 171 and 193 ˚A observations
obtained by the Solar Dynamics Observatory (SDO)/Atmospheric Imaging As-
sembly (AIA), is made for each AR by manual inspection. The results show
that it is possible to reproduce the evolution of the main coronal features such
as small- and large-scale coronal loops, ﬁlaments and sheared structures for
80% of the ARs. Varying the boundary and initial conditions, along with the
addition of physical eﬀects such as Ohmic diﬀusion, hyperdiﬀusion and a hori-
zontal magnetic ﬁeld injection at the photosphere, improves the match between
the observations and simulated coronal evolution by 20%. The simulations were
able to reproduce the build-up to eruption for 50% of the observed eruptions
associated with the ARs. The mean unsigned time diﬀerence between the erup-
tions occurring in the observations compared to the time of eruption onset in the
simulations was found to be ≈5 hrs. The simulations were particularly successful
in capturing the build-up to eruption for all four eruptions that originated from
the internal polarity inversion line of the ARs. The technique was less successful
in reproducing the onset of eruptions that originated from the periphery of
ARs and large-scale coronal structures. For these cases global, rather than local,
nonlinear force-free ﬁeld models must be used. While the technique has shown
some success, eruptions that occur in quick succession are diﬃcult to reproduce
by this method and future iterations of the model need to address this.

(cid:66) S. L. Yardley

sly3@st-andrews.ac.uk

1

School of Mathematics and Statistics, University of St Andrews, North Haugh, St
Andrews, Fife, KY16 9SS, UK

2 Mullard Space Science Laboratory, University College London, Holmbury St. Mary,

Dorking, Surrey, RH5 6NT, UK

SOLA: ms.tex; 15 December 2020; 2:00; p. 1

 
 
 
 
 
 
Keywords: Active Regions, Magnetic Fields; Corona, Models

S. L. Yardley et al.

1. Introduction

The solar corona is highly complex in nature. The source of its complexity is
largely due to the presence of magnetic ﬁelds that are generated in the tachocline
(Spiegel and Zahn, 1992): a region close to the base of the convection zone (Char-
bonneau, 2010, 2014). When magnetic ﬂux tubes at the base of the convection
zone become unstable to buoyancy (Parker, 1955; Zwaan, 1985) they rise and
the magnetic ﬁeld breaks through the solar surface manifesting itself as an active
region (AR) in the photosphere. The magnetic ﬂux emerges in a non-potential
state (Leka et al., 1996) and is further modiﬁed by the action of photospheric
ﬂows. This results in free magnetic energy being available to drive solar eruptive
phenomena.

ARs are the source of a wide range of atmospheric solar activity and the type
and level of activity is dependent on the evolutionary stage of the AR (for a
review on AR evolution see van Driel-Gesztelyi and Green 2015). As a result, it
is important to understand the structure and evolution of the magnetic ﬁeld of
an AR over its entire lifetime, from emergence to decay.

It is currently diﬃcult to measure the magnetic ﬁeld in the corona and extreme
ultraviolet (EUV) observations of AR coronal loops can only provide indirect and
limited information of the coronal structure of ARs. An alternative approach, for
the analysis of the coronal structure of ARs, is to construct a model of the coronal
magnetic ﬁeld by using the photospheric magnetic ﬁeld as the lower boundary
condition. This approach relies on the approximation that the corona, a low
plasma-β environment that mostly remains in equilibrium, is “force-free”. This
means that the coronal magnetic ﬁeld must satisfy the criterion of j × B = 0
where j = αB. In the case of nonlinear force-free (NLFF) ﬁelds the torsion
parameter α is a scalar function that can vary as a function of position, but
must remain constant along magnetic ﬁeld lines.

There are numerous NLFF ﬁeld techniques that can be used to generate mod-
els of the coronal magnetic ﬁeld. These NLFF ﬁeld models can be divided into
two categories: models that are static or time-dependent. Static models either
use a vector magnetogram as the lower boundary condition and extrapolate the
NLFF ﬁelds into the corona (e.g. Schrijver et al. 2006; De Rosa et al. 2009;
Canou and Amari 2010; Wiegelmann and Sakurai 2012; Jiang et al. 2014), or
they take an initial coronal ﬁeld, which is either a potential or linear force-free
(LFF), and evolve this ﬁeld into a NLFF state. The latter approach can make
use of the magnetofrictional relaxation technique (Yang, Sturrock and Antiochos,
1986) to generate a static model of the magnetic ﬁeld of an AR. Examples of
static modelling using magnetofrictional relaxation include the magnetofrictional
extrapolation method of Valori, Kliem and Keppens (2005) and the ﬂux rope
insertion method (van Ballegooijen, 2004; Bobra, van Ballegooijen and DeLuca,
2008; Savcheva et al., 2012; Yardley et al., 2019). The extrapolation methods
mentioned above produce a coronal ﬁeld model at a single snapshot in time.

SOLA: ms.tex; 15 December 2020; 2:00; p. 2

Coronal Evolution of Bipolar ARs

A series of independent, static extrapolations may be produced but there is no
direct evolution from one extrapolation to the next.

The magnetofrictional relaxation technique can also be used as a simulation
method to construct a continuous time-dependent series of NLFF ﬁelds. In this
case, the normal component of the magnetic ﬁeld is speciﬁed along with an initial
ﬁeld and a time series of horizontal boundary motions. The resulting coronal
structures are due to the applied boundary motions injecting non-potentiality
into the corona over timescales of hours or days. The coronal ﬁeld, which is in
non-equilibrium is then relaxed back to a NLFF ﬁeld equilibrium using mag-
netofrictional relaxation. This has been applied to global simulations (Mackay
and van Ballegooijen, 2006a,b) where a ﬂux transport model is applied at the
photospheric boundary or to simulate AR evolution using a time series of line-
of-sight (LoS) magetograms (Mackay, Green and van Ballegooijen, 2011; Gibb
et al., 2014) or more recently vector magnetograms (e.g. Pomoell, Lumme and
Kilpua 2019).

In the recent study by Yardley, Mackay and Green (2018b) a continuous
time-dependent series of NLFF ﬁeld models of AR 11437 were created using
the time-dependent NLFF ﬁeld method of Mackay, Green and van Ballegooijen
(2011). Photospheric LoS magnetograms from the SDO/Helioseismic Magnetic
Imager (HMI) instrument were used as lower boundary conditions to drive the
simulation and continuously evolve the coronal ﬁeld through a series of NLFF
equilibria. When the results from the simulation were compared to SDO/AIA
observations it was found that the simulation was able to capture the majority
of the characteristics of the coronal ﬁeld evolution. Flux ropes that formed in
the simulation showed signatures of eruption onset for two out of three of the
observed eruptions, approximately 1 and 10 hrs before the eruptions occurred in
the observations. A parameter study was also conducted to test whether varying
the initial condition and boundary conditions along with the inclusion of Ohmic
diﬀusion, hyperdiﬀusion, and an additional horizontal magnetic ﬁeld injection at
the photosphere aﬀect the coronal evolution and timings of the eruption onset.
The results showed that the coronal evolution and timings of eruption onset were
not signiﬁcantly changed by these variations and inclusions, indicating that the
main element in replicating the coronal ﬁeld evolution is the Poynting ﬂux from
the boundary evolution of the LoS magnetograms. AR 11437 is also included in
this current study.

In this paper, we extend the set of simulations carried out in Yardley, Mackay
and Green (2018b) of a single AR by simulating the coronal magnetic ﬁeld
evolution of 20 bipolar ARs. The observational analysis of the same set of
bipolar ARs was conducted by Yardley et al. (2018a) in order to probe the
role of ﬂux cancellation as an eruption trigger mechanism. The study of Yardley
et al. (2018a) analysed both photospheric and coronal observations taken by
SDO over the entire lifetime of the ARs. Through simulating a much larger
sample of ARs we can obtain more general results than those found in Yardley,
Mackay and Green (2018b), which only considered a single region (AR 11437).
We aim to determine whether the simulation of a series of NLFF ﬁelds using
the magnetofrictional technique can capture the coronal evolution and also the
build-up phase that brings the coronal ﬁeld to the point of eruption. The analysis

SOLA: ms.tex; 15 December 2020; 2:00; p. 3

S. L. Yardley et al.

carried out here is similar to that of Yardley, Mackay and Green (2018b) in which
the NLFF ﬁeld method was tested. However, due to the large-scale analysis of 20
ARs the results are presented in less detail than those given in Yardley, Mackay
and Green (2018b).

The outline of the paper is as follows. Section 2 outlines the observations
including the criteria for AR selection, coronal evolution and eruptions produced
by each AR. Section 3 describes the technique used to simulate the coronal ﬁeld
including the lower boundary conditions used. Results from the simulations can
be found in Section 4, which includes simulations using the simplest initial and
boundary conditions and also with the inclusion of additional eﬀects. Section 5
discusses the results and Section 6 provides a conclusion to the study.

2. Observations

2.1. AR Selection

The 20 ARs presented in Yardley et al. (2018a) are the same regions used in this
study. We now brieﬂy summarise the data selection method used by Yardley et
al. (2018a) to identify and select these ARs and refer the reader to that paper
for more details on each region. ARs were selected using the following criteria:

i) The ARs must be bipolar and have low complexity. The regions must have
two dominant photospheric magnetic polarities with no major mixing of the
opposite polarities.

ii) The ARs must be isolated with minimal interaction occurring between the

AR and other ARs or the background quiet Sun magnetic ﬁeld.

iii) The ARs must be observable from their ﬁrst emergence and form east of
central meridian. This allows the full evolution from emergence to decay to
be simulated during disk transit.

iv) The ARs ﬁrst emergence must be no more than 60◦ from central meridian
as instrumental eﬀects become increasingly signiﬁcant at large centre-to-limb
angles.

These selection criteria led to a sample of 20 ARs being chosen during the
HMI era, spanning a time period from March 2012 to November 2015. All ARs,
apart from AR 11867, were monitored during their ﬂux emergence and decay
phases, which included dispersal and ﬂux cancellation. AR 11867 remained in
its emergence phase during the time period studied and did not exhibit ﬂux
cancellation at its internal PIL.

Representative AR examples are given in Figure 1 with Supplementary Movie
1 showing the full evolution of AR 11446. Table 1 provides summary information
of AR locations, photospheric ﬂux evolution, and observed eruption times taken
from Yardley et al. (2018a). Photospheric ﬂux values were obtained using the
720 s data series (Couvidat et al., 2016) generated by the Helioseismic Magnetic
Imager (HMI) (Schou et al., 2012) on board the Solar Dynamics Observatory
(SDO); Pesnell, Thompson and Chamberlin 2012).

SOLA: ms.tex; 15 December 2020; 2:00; p. 4

Coronal Evolution of Bipolar ARs

Figure 1. SDO/HMI LoS magnetograms that show three AR examples (ARs 11437, 11446 &
11680). The images show each AR at the time of the peak unsigned magnetic ﬂux measurement,
where unsigned refers to half the total absolute positive and negative ﬂux. The saturation levels
of the images are ± 100 G with white (black) representing positive (negative) photospheric
magnetic ﬁeld. As an example, the entire photospheric ﬁeld evolution of AR 11437 can be seen
online in Supplementary Movie 1.

2.2. Coronal Evolution and Eruptive Activity

The observed coronal evolution of each AR was analysed in Yardley et al. (2018a)
in order to identify the time and location of any eruptions. These ejections are
referred to as eruptions as opposed to CMEs because the coronal signatures in
the EUV data are relatively subtle and most do not show any clear evidence of
a CME in the white-light coronagraph data. This implies that they are either
conﬁned/failed eruptions or are ejective but have a low plasma density. The
coronal evolution was monitored using both 171 and 193 ˚A images taken by
the Atmospheric Imaging Assembly (AIA; Lemen et al. 2012) on board SDO.
AIA provides full-disk observations with a high spatial and temporal resolution
of 1.5” and 12 s, respectively. At least two or more of the following coronal
signatures were used to identify the occurrence of an eruption:

i) the eruption of a ﬁlament or an EUV loop system,
ii) the rapid disappearance of coronal loops and post-eruption arcade formation

(ﬂare arcade),

iii) ﬂares and ﬂare ribbons,
iv) and/or coronal dimmings.

As detailed in Yardley et al. (2018a) the eruptions were then categorized into
the following types to investigate which eruptive structures might have formed
as a consequence of ﬂux cancellation:

i) Internal PIL events are the eruption of a low altitude structure originating

along the internal PIL of the AR.

ii) External PIL events are the eruption of a low altitude structure originating
along an external PIL that is formed between the periphery of the AR and
the magnetic ﬁeld of the quiet Sun.

iii) High altitude events are the eruption of a high altitude structure which cannot
be associated with an internal/ external PIL (which are at low altitude).

SOLA: ms.tex; 15 December 2020; 2:00; p. 5

17-Mar-2012 15:58 UT(a)24-Mar-2012 15:58 UT(b)25-Feb-2013 14:22 UT(c)AR 11437AR 11446AR 11680S. L. Yardley et al.

In total, 24 eruptions were observed, with 13 of the 20 ARs producing at least
one ejection. Eight of these ARs produced low corona events originating from
either the internal or external PIL and the other ﬁve produced high altitude
events. Two of the eruptions were observed as a CME in the LASCO/C2 coro-
nagraph data. There were also four B/C GOES class ﬂares associated with four
ARs that did not occur at the time of the eruptions.

For examples of the diﬀerent event categories see Figure 1 in Yardley et al.
(2018a). The timings of these events, which are also taken from Yardley et al.
(2018a), are given in Table 1.

3. The NLFF Field Simulation

3.1. Coronal Magnetic Field Evolution

The NLFF ﬁeld method of Mackay, Green and van Ballegooijen (2011) is ap-
plied to SDO/HMI LoS magnetograms to simulate the evolution of the coronal
magnetic ﬁeld of each AR. A key element of this method is that the magnetic
ﬁeld evolves through a continuous time series both at the photosphere and in
the coronal volume where ﬂux is preserved. Therefore, the coronal magnetic
ﬁeld evolution can be analysed. When using our method we do not apply any
additional observational constraints such as the use of EUV coronal images,
rather the solution obtained at any one time is purely based on the initial
ﬁeld, the applied boundary motions and any additional coronal physics (see
Section 4.2).

This technique has been previously tested on AR 11437 (Yardley, Mackay
and Green, 2018b), one of the ARs also included in this study. Therefore, the
quantitative analysis that has previously been carried out for AR 11437 will not
be described in this paper. Here, we present the overarching results from the
qualitative analysis of 20 bipolar ARs, where each AR has been studied using
the methodology described in Yardley, Mackay and Green (2018b).

A time series of NLFF ﬁelds is generated using HMI LoS magnetograms for
each lower boundary condition (see Section 3.2). The HMI LoS magnetograms
are cleaned and re-scaled before the simulations are carried out. The clean-up
procedure includes time-averaging, low magnetic ﬂux value removal, removal of
small-scale magnetic elements, and if required, ﬂux balancing. This procedure
ensures that the large-scale AR evolution is kept but small-scale quiet Sun
elements and random noise are removed (see Appendix A for more details).

In the simulation, the evolution of the 3D magnetic ﬁeld B is described by

∂A
∂t

= v × B,

(1)

where A represents the magnetic vector potential, B = ∇ × A is the magnetic
ﬁeld, and v is the magnetofrictional velocity. The magnetofrictional relaxation
technique of Yang, Sturrock and Antiochos (1986) is employed to ensure that

SOLA: ms.tex; 15 December 2020; 2:00; p. 6

Coronal Evolution of Bipolar ARs

the coronal ﬁeld is evolved through a series of force-free equilibria. Therefore,
the magnetofrictional velocity inside the computational box takes the form

v =

1
ν(cid:48) j × B,

(2)

where ν(cid:48) is the friction coeﬃcient and j = ∇ × B. The coeﬃcient of friction
ensures that as the magnetic ﬁeld is perturbed by motions at the boundary, the
ﬁeld remains close to a force-free equilibrium in the corona. A cartesian staggered
grid is used to carry out the computations to obtain second-order accuracy for A,
B, and j. The computational domain represents the solar corona where the pho-
tosphere is represented by the bottom of the box. The size of the computational
domain ranges from 0 < x, y, z < 6 in non-dimensionalized units, where the size
of the computational box in physical units is on the order of 105 km. The exact
domain size depends upon the dimensions of the original magnetograms and how
the magnetograms are re-scaled within the computational box (see Section 3.2).
The sides of the computational domain have closed boundary conditions whereas,
the top of the box can have either open or closed boundaries. When the top of
the computational domain is open then the magnetograms do not need to be ﬂux
balanced. However, when the top of the box is closed then the magnetograms
require ﬂux balancing to ensure that ∇ · B = 0 in the computational volume.
In this particular study, both open and closed boundary conditions are used for
the top of the box. The generation of the photospheric boundary and initial
conditions are described below.

3.2. Photospheric Boundary Conditions

To be able to simulate the full evolution of the bipolar ARs we use the full
disk HMI 720s LoS magnetograms (hmi.M 720s series). For each AR, we use a
time sequence of LoS magnetograms with a chosen cadence of 96 minutes. We
create cut-outs of the magnetograms centred on each AR and apply clean-up
processes to the time series of partial disk magnetograms (see Appendix A). We
use LoS magnetograms in this study as we want to simulate the full evolution
of ARs from emergence to decay. We would also like to quantify how well this
computationally eﬃcient modelling technique that uses the LoS magnetograms
performs in simulating the coronal evolution of a large number of ARs.

Regarding the medium cadence used, prior to the present study, we have
conducted a number of investigations varying the cadence of the HMI magne-
tograms from 12 minutes to 3 hours (Gibb, 2015) and have found very similar
results. Therefore, we have chosen to use a medium cadence of 96 minutes as it
is suﬃcient to capture the large-scale evolution of the ARs. Also, any future L5
space weather mission is likely to have a cadence more comparable to that of the
Michelson Doppler Imager (MDI) rather than the cadence presently provided by
HMI.

Initially, each simulation is run using a relatively simple set-up. That is, a
potential magnetic ﬁeld is used as the initial condition along with either a closed
or open boundary at the top of the computational volume. The simulation results
are then compared with the observations to determine whether there is a good

SOLA: ms.tex; 15 December 2020; 2:00; p. 7

S. L. Yardley et al.

agreement between the two. This is assessed by comparing the evolution of the
simulated coronal ﬁeld to the coronal evolution in SDO/AIA 171 and 193 ˚A
observations by visual inspection and using qualitative scoring criteria given in
Section 4.1. If the simulation results do not provide a good ﬁt to the observations
then the simulation is re-run varying a number of terms one-by-one. First a LFF
ﬁeld initial condition is used then a variety of additional physical eﬀects are
included in succession until a better ﬁt is achieved (see Section 4.2 and also the
method of Yardley, Mackay and Green 2018b). For the present simulations we
only use a potential or a LFF ﬁeld as the initial condition for the simulations.
The ARs modelled in this study are young ARs, with the majority emerging at a
centre-to-limb angle around 60◦ longitude. Due to the large distance from central
meridian the vector magnetograms (where they may exist) contain signiﬁcant
errors where these errors could introduce spurious results in the simulation.
Therefore, using an initial NLFF ﬁeld condition is currently beyond the scope
of this paper but this will be considered in a future study.

The simulations use the cleaned LoS magnetograms (see Appendix A), which
have a been scaled to a lower resolution of 2562, as the lower boundary conditions.
The original size of the magnetograms depends upon the size of the AR but the
LoS magnetograms are always larger than 2562. To take into account boundary
eﬀects, the magnetograms are also re-scaled to ﬁll 60–70% of the area of the
bottom of the computational box. The simulation generates a continuous series
of lower boundary conditions using the corrected LoS magnetograms that are
designed to replicate, pixel by pixel the LoS magnetograms, every 96 minutes.
The series of cleaned magnetograms give the prescribed distribution of Bz on
the base. Hence the horizontal components of the vector potential (Axb, Ayb) are
determined on the base for each discrete time interval of 96 minutes by solving
for the scalar potential φ, where A = ∇ × (φˆz). To specify the evolution of Bz
on the base in terms of Axb and Ayb between the prescribed distributions the
rate of change of the horizontal components of the magnetic vector potential and
therefore an electric ﬁeld is determined. To evolve Axb(t) and Ayb(t) to Axb(t+1)
and Ayb(t + 1) we assume that the process is linearly applied between each
discrete time interval t and t + 1, where t represents the discrete 96 minute time
index. Therefore, the horizontal components (Axb, Ayb) are linearly interpolated
between each 96 minute time interval to produce a time sequence that is contin-
uous between the observed distributions. Thus, every 96 minutes the simulated
photospheric ﬁeld identically matches that found in the cleaned observations.
By using this technique, we are eﬀectively evolving the magnetic ﬁeld from one
ﬁxed magnetogram to the next. Also, undesirable eﬀects such as the pile-up of
magnetic ﬂux at sites of ﬂux cancellation and numerical overshoot do not occur.
As the surface ﬁeld evolves in this manner it injects electric currents and free
energy into the coronal ﬁeld, which responds through Equation 1. By using this
numerical method it means that there are two timescales involved in the lower
boundary condition evolution. The ﬁrst timescale is due to the 96 minute time
cadence of the observations and the second is the linear evolution timescale. The
second timescale is introduced to advect the photospheric magnetic polarities
between the observed states, inject Poynting ﬂux into the corona and to relax
the coronal ﬁeld. The method applied to interpolate the boundary magnetic ﬁeld

SOLA: ms.tex; 15 December 2020; 2:00; p. 8

Coronal Evolution of Bipolar ARs

is very similar to Gibb et al. (2014) and Yardley, Mackay and Green (2018b)
however, to satisfy the Courant-Friedrichs-Levy (CFL) condition the timestep
is determined from the minimum cell crossing time for the magnetofrictional
velocity or the diﬀusion terms and its maximum is equal to a ﬁfth of this value.
Within the simulations the initial condition satisﬁes the Coulomb gauge. In
addition to this, during the evolution of the ﬁeld between the ﬁxed points given
by the magnetograms, we also maintain the Coulomb gauge. This is carried
out numerically by including a ∇ · A term, which does not eﬀect the value of
the magnetic ﬁeld in the simulations. The complete description of this process
can be found in Mackay and van Ballegooijen (2009), Mackay, Green and van
Ballegooijen (2011) and references therein.

4. Results

4.1. Magnetic Field Evolution

The simulated coronal ﬁeld evolution of the 20 bipolar ARs will now be discussed
for the simplest case where a potential ﬁeld is used as the initial condition and
the top boundary of the computational box is closed. To determine whether the
simulated coronal evolution is able to capture that of the real Sun in each AR, the
simulated ﬁeld is compared to the SDO/AIA 171 and 193 ˚A plasma emission
structures by manual inspection. The main coronal features that are used to
make the comparison between the observed coronal structure and simulated
coronal magnetic ﬁeld of each AR include small- and large-scale coronal loops,
ﬁlaments and sheared structures. The 171 and 193 ˚A wavebands are used for the
comparison as the evolution of coronal loops, ﬁlaments and sheared structures
are well captured in these wavebands compared to the other AIA wavebands.
These wavebands are also the primary wavebands that were analysed in the
observational study of Yardley et al. (2018a). The simulated magnetic ﬁeld and
observed coronal plasma emission structures are then compared at various times
(roughly once per day, see Figure 2) throughout the evolution of each AR.

The simulation results are also analysed to determine whether or not there
is a good agreement between the timings and location of the ejections seen
in the observations and the corresponding signatures of eruption onset in the
simulations. The following criteria are used to assign a score to quantitatively
describe the level of agreement between the simulations and observations:

i) Score 1: If the simulation is able to reproduce the main coronal features (small-
and large-scale loops, ﬁlaments and sheared structures) for the majority of
the AR evolution then there is deemed to be a good match between the
observations and simulations. If an eruption is observed to originate from the
AR, then the simulation must be able to successfully model the build-up to
the eruption within a ±12 hr time window pre- or post-observed eruption
time. If there are multiple observed eruptions then the simulation must be
able to successfully follow the build-up to eruption for the majority of the
eruptions associated with the AR.

SOLA: ms.tex; 15 December 2020; 2:00; p. 9

S. L. Yardley et al.

ii) Score 2: Some of the coronal features (small- and large-scale loops, ﬁlaments
and sheared structures) that are seen in the observations are reproduced by
the simulation for most of the AR evolution. Therefore, the match between
the coronal features present in the observations and the simulations is deemed
to be acceptable. If one or multiple eruptions are observed to originate from
the AR, the build-up phase may or may not be followed by the simulation for
any eruption.

iii) Score 3: A minority or none of the coronal features (small- and large-scale
loops, ﬁlaments and sheared structures) seen in the observations are repro-
duced for most of the AR evolution. Therefore, the evolution of the simulated
coronal ﬁeld is deemed not to match the observed coronal evolution. The
simulation fails to model the build-up to eruption for any observed eruptions
associated with the AR.

An example AR for each of the scoring criteria is shown in Figure 2, which
compares the observed coronal evolution (odd rows) to the simulated coronal
evolution (even rows). The ﬁrst example shows AR 11437 (Score 1), where the
sheared J-shaped structure, small- and large-scale coronal loops that are present
in the observations are captured by the simulation for the majority of the AR
evolution (see black arrows in Figure 2). The simulation is also able to replicate
the build-up to the point of eruption for 2 out of 3 of the observed eruptions.
The signatures of eruption onset in the simulations are discussed in the next
paragraph. The second example shows AR 12455 (Score 2), where the simulation
is able to reproduce the structure of the small- and large-scale coronal loops
although, the match to the observations is better in the northern part of the
AR compared to the south (black arrows in Figure 2). There are no eruptions
observed to be associated with this AR. Finally, for AR 12229 (Score 3) the
simulation is unable to produce the structure of the small- and large-scale loops
seen in the observations of the AR. The eruption onset signatures, which indicate
that a loss of equilibrium in the simulation has occurred, are not present for any
of the four eruptions observed to originate from this AR.

The simulations carried out, focus on modelling the build-up of non-potential
magnetic ﬁelds and ﬂux ropes within ARs. We do not try to reproduce and follow
the dynamics of the observed eruptions as full magnetohydrodynamic (MHD)
simulations are required to do this (e.g. see Rodkin et al. 2017). Therefore, to
determine whether the simulations successfully follow the build-up to eruption,
the simulated coronal ﬁeld evolution was examined for signatures of eruption
onset. The signatures present in the simulations that indicate the build-up to an
eruption include:

i) a ﬂux rope rising, which subsequently reaches the top or side boundaries of
the computational box indicating that a loss of equilibrium has occurred.
ii) Reconnection occurring underneath the ﬂux rope which leads to small, more
potential loops forming beneath the ﬂux rope similar to the post-eruption
(ﬂare) arcades that are visible in the observations.

These signatures of eruption onset in the simulations must occur at the same
location and timings as those identiﬁed in the observations. The simulation

SOLA: ms.tex; 15 December 2020; 2:00; p. 10

Coronal Evolution of Bipolar ARs

Figure 2. Example ARs shown for each scoring criteria (1, 2, and 3). The odd rows (1, 3,
and 5) show the evolution of the ARs through SDO/AIA 171 ˚A images, where the NOAA AR
number is labelled on the image in the ﬁnal column (panels d, h, and l). The even rows (2, 4, and
6) show the corresponding simulated coronal ﬁeld at the time of the coronal observation shown
directly above, where the score is labelled on the simulated coronal ﬁeld in the ﬁnal column.
The red (blue) contours shown in the images of the simulated coronal ﬁeld evolution represent
the positive (negative) photospheric magnetic ﬁeld polarities. The black arrows indicate the
observed coronal features such as sheared structures, ﬁlaments and small- and large-scale loops,
which are reproduced by the simulations.

SOLA: ms.tex; 15 December 2020; 2:00; p. 11

(1)(2)(3)AR 11437AR 12455AR 12229(a)(b)(c)(d)(e)(f)(g)(h)(i)(j)(k)(l)17-Mar-2012 00:00 UT17-Mar-2012 03:50 UT19-Mar-2012 23:28 UT20-Mar-2012 03:42 UT14-Nov-2015 13:58 UT15-Nov-2015 19:34 UT16-Nov-2015 15:58 UT17-Nov-2015 17:58 UT6-Dec-2014 04:46 UT7-Dec-2014 01:34 UT8-Dec-2014 02:46 UT9-Dec-2014 00:22 UT17-Mar-2012 00:00 UT17-Mar-2012 04:48 UT20-Mar-2012 00:00 UT20-Mar-2012 03:12 UT15-Nov-2015 19:12 UT16-Nov-2015 16:00 UT17-Nov-2015 17:36 UT6-Dec-2014 04:48 UT7-Dec-2014 01:36 UT8-Dec-2014 03:12 UT9-Dec-2014 00:00 UTY2345x123Y45xx123452345123451234534521Y1xxx12134502345x213450x213450x213450x12345x12345x1234514-Nov-2015 14:24 UTS. L. Yardley et al.

Figure 3. Sample ﬁeld lines of AR 11437 that show the presence of a ﬂux rope in the simula-
tion in the build-up to eruption in comparison to the eruption signatures in the observations.
The series of plots in the top panel show a cross-section in the x-z plane where the axis of a
ﬂux rope and a post-eruption arcade are visible. The middle panel shows the eruption onset of
the ﬂux rope in the x-y plane. In this case, the side and top boundaries of the computational
box are closed and so the ﬂux rope is unable to escape the coronal volume however, the ﬂux
rope does reach the side boundaries of the domain. The bottom panel shows the eruption
signatures present in the 171 ˚A observations. The red and blue contours represent the positive
and negative photospheric magnetic polarities, respectively.

results are analyzed in a time window of ≈12 hrs pre- and post-observed eruption
for the above signatures of eruption onset. The signatures of eruption onset in
the simulation of AR 11437 are shown in Figure 3. In this case, a ﬂux rope, which
has formed along the internal PIL, rises in the domain and reconnection occurs
underneath the ﬂux rope. This leads to small, more potential loops forming below
the ﬂux rope axis. Eventually the ﬂux rope reaches the side boundary of the
domain. A similar scenario is seen in the observations where a sheared structure
and post-eruption loops that form underneath this structure are observed at the
same location as in the simulations.

For the simplest case, where the coronal evolution of each of the 20 bipolar
ARs is simulated using a potential ﬁeld initial condition and a closed top bound-

SOLA: ms.tex; 15 December 2020; 2:00; p. 12

Flux ropepost-eruption arcadesheared structureerupting structurepost-ﬂare loopsAR 1143720-Mar-2012 13:59 UT20-Mar-2012 14:24 UT20-Mar-2012 15:00 UTz0.00.51.01.52.0x2.53.03.54.04.5x2.53.03.54.04.5x2.53.03.54.04.51234560Yx0124563x0124563x012456320-Mar-2012 03:12 UT20-Mar-2012 08:00 UT20-Mar-2012 12:48 UTCoronal Evolution of Bipolar ARs

Figure 4. The time diﬀerence in hours between the eruption onset of ﬂux ropes in the sim-
ulation of each AR compared to the eruption seen in the observations. Signatures of eruption
onset occur between two time steps in the simulation and so the values represent the time
diﬀerence taken between the observed eruptions and the central time between the two time
steps in the simulation.

ary, the results (see Table 2) are as follows. The NLFF ﬁeld method is able to
capture the majority of the coronal structure for ten ARs, a reasonable amount
of the structure for six ARs, and little or no structure for four ARs (see Table 3).
Therefore, the method is able to capture a reasonable amount of the structure
for 80% of the AR sample, and failed to capture the structure for 20% of the
ARs.

In total, the simulations are able to successfully follow the build-up to eruption
in a ≈12 hr time window prior to or post-eruption for 12 out of the 24 observed
eruptions. The time diﬀerence between eruption onset in the simulations com-
pared to the time determined from observations is given in Figure 4 for each
AR. The time of eruption onset in the simulation is determined by using the
time halfway between the time step where the signatures of eruption onset in
the simulation have been identiﬁed, and the previous time step where there are
no signatures of eruption onset. By time step we are referring to the primary
timescale of the simulation that is set by the cadence of the magnetograms, which
in this case is 96 minutes. The time of the eruption onset identiﬁed from the
simulation is then compared to the eruption time taken from the observations
to give the time diﬀerence. The mean time diﬀerence between the initiation of
the eruption in the simulations compared to the observations is ≈5 hrs with a
standard deviation of ≈4 hrs. It is possible to successfully follow the build-up to
eruption in the simulations for all four eruptions (100%), that were observed to
originate from low in the corona along the internal PIL by Yardley et al. (2018a).
This indicates that by applying the method of Mackay, Green and van Bal-
legooijen (2011) to construct a time series of NLFF ﬁelds, using the simplest

SOLA: ms.tex; 15 December 2020; 2:00; p. 13

S. L. Yardley et al.

initial and boundary conditions, it is possible to capture the key features of the
observable coronal structures in the sample of ARs. To improve on these results
the eﬀect on the simulated coronal magnetic ﬁeld of additional physical eﬀects as
well as varying the initial and boundary conditions are examined in the following
section.

4.2. Consequences of Additional Physical Eﬀects

Although it is possible to simulate the coronal ﬁeld evolution of an AR using only
the LoS magnetic ﬁeld as the lower boundary condition combined with a poten-
tial ﬁeld as the initial condition, such a simple model does not work in all cases.
There were several issues that were encountered in the simulation when using
the simplest initial and boundary conditions (an initial potential ﬁeld condition
and closed top boundary). Firstly, the presence of highly twisted ﬁeld near the
side boundaries of the box. Boundary eﬀects can be rectiﬁed by re-scaling the
magnetograms to occupy a smaller area at the bottom of the computational box
during the clean-up procedure (Appendix A). If the magnetograms contain large
amounts of small-scale magnetic ﬁeld that aﬀect the simulated coronal evolution,
these can be removed by smoothing the magnetograms with a Gaussian kernel
(see Appendix B). This process is applied in addition to the clean-up procedure
detailed in Appendix A. If the simulation runs for long time periods, twisted
magnetic ﬁeld can build-up in the computational volume. By adding coronal
diﬀusion, in the form of Ohmic diﬀusion or hyperdiﬀusion, this can help prevent
the build-up of highly twisted ﬁeld by decreasing the amount of poloidal ﬂux.
However, despite the inclusion of additional coronal diﬀusion terms, ﬂux ropes
are still able to form and reach instability in the simulation and the overall
evolution of the simulated coronal ﬁeld remains signiﬁcantly unaﬀected (Mackay
and van Ballegooijen, 2006a; Yardley, Mackay and Green, 2018b).

The energy and non-potentiality of the coronal ﬁeld in the simplest simulation
setup only originates from the Poynting ﬂux due to horizontal motions. For the
cases where the simple model is insuﬃcient to describe the observations (ARs
with a score of 2 or 3) there could be additional physical eﬀects that are acting.
For example, the initial conﬁguration of the coronal magnetic ﬁeld could be
non-potential and therefore a LFF ﬁeld initial condition could be implemented
to represent any non-potential eﬀects present before the start of the simulation.
When a LFF ﬁeld initial condition is used the force-free parameter α is assigned a
small value with a magnitude of 10−9–10−8 m−1 (see Table 2), to match the weak
shear seen in the coronal observations. The range in the force-free parameter is
constrained by the size of the computational domain which scales as 1/L, where
L varies from one AR to the next. This is due to the nature of the LFF ﬁeld
solution requiring a decaying (non-oscillatory) solution with height. The sign
of α is taken from the sense of twist from the magnetic tongues present in the
observations (Luoni et al., 2011). The sign and value of α in our simulations is
therefore selected in a similar manner to our previous study (Yardley, Mackay
and Green, 2018b).

There may also be other sources of energy or helicity injection, which are
not captured by the evolution of the normal component of the magnetic ﬁeld

SOLA: ms.tex; 15 December 2020; 2:00; p. 14

Coronal Evolution of Bipolar ARs

that have to be taken into account, such as the presence of vertical motions or
torsional Alfv´en waves. Along with these additional injection mechanisms non-
ideal processes may also have to be considered. These eﬀects are implemented
one at a time in the simulation by modifying the induction equation to include
the physical eﬀects through three additional terms:

∂A
∂t

= v × B − ηj +

B
B2 ∇ · (η4B2∇α) − ∇z(ζBz),

where

α =

B · ∇ × B
B2

.

(3)

(4)

The ﬁrst additional term is Ohmic diﬀusion, where η represents the resistive
coeﬃcient. The second additional term, is hyperdiﬀusion (Boozer, 1986; Strauss,
1988; Bhattacharjee and Yuan, 1995). This diﬀusion term is artiﬁcial and is
introduced to reduce gradients that are present in the force-free parameter α,
while total magnetic helicity remains conserved (van Ballegooijen and Mackay,
2007).

The third additional term represents the injection of a horizontal magnetic
ﬁeld or twist component at the photospheric boundary. In this term ∇z is the
vertical component of the gradient operator and ζ is an injection parameter
that has the dimensions of a diﬀusivity. The parameter ζ is only non-zero at
the photospheric boundary (z = 0) hence, the injection of the horizontal ﬁeld
only occurs at this location. This term leads to a change in Az half a grid point
into the domain, and the subsequent injection of a horizontal magnetic ﬁeld and
magnetic helicity into the corona. By applying this injection in Az leaves the
vertical component of the magnetic ﬁeld unchanged. The sign of the injection
parameter ζ determines the sign of the magnetic helicity that is injected via
the horizontal ﬁeld. A positive (negative) value of ζ leads to the injection of
negative (positive) magnetic helicity. Once injected, the horizontal ﬁeld and twist
component propagate upwards along the magnetic ﬁeld lines through the v × B
term in the induction equation above (Equation 3). This term is mathematically
equivalent to that used in Mackay, DeVore and Antiochos (2014) to model the
helicity condensation process of Antiochos (2013). For the present simulations
this term does not represent helicity condensation rather it is used to add an
additional non-potential contribution that is not captured by a potential ﬁeld
initial condition or the applied horizontal motions on the photospheric surface
alone. Additional sources of helicity may originate from the prior evolution of an
AR that is not captured from the initial potential ﬁeld, the presence of vertical
motions or the propagation of torsional Alfv´en waves from below the photosphere
into the corona. The additional injection of horizontal magnetic ﬁeld at the
photosphere, along with the Ohmic and hyperdiﬀusion terms are included in the
simulation through user-deﬁned constants.

4.2.1. Magnetic Field Evolution

We now modify the top boundary, initial condition and include non-ideal terms
in the simulations. This is to determine whether it is possible to improve the

SOLA: ms.tex; 15 December 2020; 2:00; p. 15

S. L. Yardley et al.

Figure 5. The SDO/AIA 171 ˚A images (a–d) and corresponding sample ﬁeld lines (e–l)
showing the evolution of AR 12455. The second row (e–h) shows sample ﬁeld lines from
the simulation run with closed top boundary conditions and an initial potential ﬁeld i.e. the
simplest initial and boundary conditions. The third row (i–l) shows the results when Ohmic
diﬀusion, η is added with a value of 25 km2 s−1 and small-scale ﬁeld has been removed. The
score given to each simulation is given at the bottom right of panels (h) and (l). The positive
(negative) photospheric magnetic ﬁeld is represented by the red (blue) contours.

simulation results, obtained for the ARs in Section 4.1, where only a reasonable
or minimal amount of the coronal structure was captured (ARs assigned a scoring
criteria of 2 or below).

To improve the results obtained by using the simplest initial and boundary
conditions additional physical eﬀects, Gaussian smoothing, and LFF ﬁeld initial
conditions are used. The simulations that were performed for each AR to improve
the previous results are described in the comments (ﬁnal) column of Table 2.
If the performance of the simulation improved, the new score is included in
brackets in the Score (fourth) column of Table 2. An example can be seen in
Figure 5 where AR 12455 improves from a score of 2 to 1. The original simulation
captured the evolution of the large-scale coronal loops in the north of the AR
relatively well however, failed to reproduce the large-scale loops present in the
south. It also failed to capture the bright core of the AR (see Figure 5 (a)). By
removing the small-scale magnetic ﬁeld at the AR periphery using a Gaussian
kernel and then introducing Ohmic diﬀusion the simulation is able to replicate
the small and large-scale coronal structure for the entire AR evolution including
the sheared structure present at the start of the AR evolution.

The new results are as follows. The enhanced simulations are able to capture
the majority of the coronal structure for 12 ARs, a reasonable amount of struc-

SOLA: ms.tex; 15 December 2020; 2:00; p. 16

AR 12455(a)(b)(c)(d)14-Nov-2015 13:58 UT15-Nov-2015 19:34 UT16-Nov-2015 15:58 UT17-Nov-2015 17:58 UT(1)closed, potential, η = 25 15-Nov-2015 19:12 UT16-Nov-2015 16:00 UT17-Nov-2015 17:36 UT(i)(j)(k)(l)xx1234Y(2)Y12134502345213450213450213450closed, potential(e)(f)(g)(h)14-Nov-2015 14:24 UT5xx213450213450213450213450Coronal Evolution of Bipolar ARs

ture for ﬁve ARs and little or no coronal structure for three ARs (see brackets in
Table 3). The new results show that one AR moved from scoring category 3 to 2
and two ARs moved from 2 to 1 indicating there was an overall improvement of
20% when a mix of additional physical eﬀects are included. Therefore, the NLFF
ﬁeld simulation is able to capture a reasonable amount of the structure for 85%
of the ARs and only failed to capture the structure for 15% of the ARs from the
sample. This is a slight improvement on the previous result, where the simplest
initial and boundary conditions were used. The improvement in the results is
mainly due to the use of a LFF ﬁeld initial condition. Although, the application
of Gaussian smoothing to remove additional small-scale magnetic ﬁeld near the
AR periphery and the addition of Ohmic diﬀusion also improved the results.
When considering the build-up to eruption in the simulations, no improvement
is made on the previous results as the simulations again successfully follows the
build-up to eruption for 12 out of the 24 observed eruptions.

5. Discussion

We have used the method of Mackay, Green and van Ballegooijen (2011) to
simulate the full coronal evolution of 20 bipolar ARs, from emergence to decay,
using a time series of LoS magnetograms as the lower boundary condition. To
reproduce the full coronal evolution of the ARs requires a series of magnetograms
that extends over the entire lifespan of each AR.

Numerous clean-up processes (see Appendix A) have been applied to the raw
magnetograms including time-averaging, removal of isolated features, removal
of low ﬂux values, and ﬂux balancing before carrying out the simulations. The
application of these procedures produces a series of cleaned magnetograms with
a smooth and continuous evolution of the photospheric magnetic ﬁeld. By using
a series of cleaned magnetograms as the lower boundary condition it is easier
to simulate the large-scale coronal magnetic ﬁeld evolution of the ARs as the
inclusion of small-scale magnetic elements and random noise could potentially
lead to numerical problems in the simulations.

The method has not yet been tested using vector magnetograms as the lower
boundary conditions of the simulation. However, an initial qualitative compari-
son between the vector components at the simulation boundary to the observed
vector data of one AR (AR 11561) in our sample shows a relatively good agree-
ment (see Appendix C for more details). In a follow-up study we will expand on
this qualitative comparison between the simulated and observed vector magnetic
ﬁeld components.

Initially, the ARs were simulated using the simplest initial and boundary
conditions i.e. a potential ﬁeld initial condition and closed top boundary. We
conclude, after a manual comparison with the observations, that the simulations
reproduced a reasonable amount of the coronal structure and evolution for 80% of
the ARs. This result is improved slightly to 85% by applying Gaussian smoothing
to remove additional small-scale magnetic ﬁeld in the magnetograms, using a
LFF ﬁeld initial condition, and including additional eﬀects such as non-ideal
terms in the simulations. For the ARs where the simulation failed to reproduce

SOLA: ms.tex; 15 December 2020; 2:00; p. 17

S. L. Yardley et al.

the main coronal features, particularly during the early stages of the AR evolu-
tion, a NLFF ﬁeld initial condition may be more appropriate. We will implement
the use of a NLFF ﬁeld initial condition in the future by constructing a NLFF
ﬁeld extrapolation using the technique described by Valori, Kliem and Keppens
(2005). Whereby a potential ﬁeld will be extrapolated from a magnetogram,
the horizontal ﬁeld components will be set using a vector magnetogram, and
magnetofrictional relaxation will be applied to relax the magnetic ﬁeld to a
force-free equilibrium.

We do not constrain the simulations with coronal observations therefore,
the coronal structures reproduced by the simulation are the result of the non-
potential eﬀects produced by the boundary evolution. Therefore, the accuracy
of the coronal ﬁeld models in this study has been judged qualitatively by a
manual inspection and visual comparison to the coronal observations. To make
the comparison to observations less time-consuming and to remove the subjective
nature of this analysis an optimization method could be developed to minimize
the deviation between the ﬁeld lines from the simulation and the intensity
observations. An optimization technique will be considered in future studies.

We now discuss when and where the NLFF ﬁeld simulations were able to
reproduce the build-up to eruption. By reproducing the build-up to eruption,
we are referring to the ability to identify a ﬂux rope that has formed in the
simulation that loses equilibrium or becomes unstable at the same location and
at a similar time to the eruption that occurred in the observations. We do not aim
to recreate the full dynamics of the eruptions as this requires a MHD simulation.
The simulations were able to replicate the formation and eruption onset of ﬂux
rope structures at the internal PIL of an AR where the ﬂux rope was created
by ﬂux cancellation and magnetic reconnection occurring at low atmospheric
heights. Signatures of eruption onset were found in the simulations for all four
low corona eruptions that originated from the internal PIL of ARs 11437, 11561,
11680, and 12382. The simulations were analysed within a ± 12 hr window of the
eruption occurring in the observations and the mean unsigned time diﬀerence
of eruption onset taking place in the simulations compared to the observed
eruptions in these four ARs was found to be ≈5 hrs. These simulation results
support the van Ballegooijen and Martens (1989) scenario and show that the
physical processes can be replicated on a similar timescale to that which the
Sun evolves over.

The technique failed to capture the onset of some of the eruptions that orig-
inated from low in the corona along an external PIL or at high-altitudes. There
are a number of possible reasons for this. Capturing the initiation of eruptions
that occurred during the early stages of the simulations proved challenging since
these eruptions occur during the ﬂux emergence phase of the ARs. Using an
initial potential ﬁeld condition, combined with the short time over which the
coronal ﬁeld is being evolved, means that insuﬃcient shear and free energy will
have built-up in the simulated coronal ﬁeld.

To combat this issue we can vary the initial or boundary conditions and
include additional non-ideal eﬀects in the simulation. For six of the ARs we
constructed a LFF ﬁeld initial condition to see how this aﬀected the results. We
chose the magnitude and sign of the force-free parameter to reﬂect the weak shear

SOLA: ms.tex; 15 December 2020; 2:00; p. 18

Coronal Evolution of Bipolar ARs

seen in the coronal observations. Ideally, vector data can be used to calculate the
value of α to use to construct the LFF ﬁeld initial conditions for the simulation.
In the future, we aim to use the observed α value for the LFF ﬁeld initial
condition in our simulations or use a NLFF ﬁeld initial condition when possible.
The simulation method also fails to capture the eruption onset for ejections
that occur in quick succession as it is impossible to separate them from one
another in the simulation. To recreate the dynamics of multiple eruptions over
short timescales requires the use of full MHD simulations. For example, four
eruptions from external PILs were observed to occur in quick succession during
the ﬁrst 12 hrs of the emergence phase of AR 12229. The build-up to these
eruptions was not captured by the simulation and this AR accounted for a
large number of the missed eruptions. There was also a large imbalance in the
magnetic ﬂux during emergence due to the AR emerging at ≈50◦ longitude into
negative quiet Sun magnetic ﬁeld. Additionally, eruptions that originated along
an external PIL were observationally found to occur due to ﬂux cancellation
that takes place between the periphery of the AR and quiet Sun magnetic ﬁeld
during the emergence phase (Yardley et al., 2018a). Eruptions that form at
the external PIL are harder to simulate because much of the small-scale ﬁeld is
removed during the “cleaning” process or is not included in the local simulations.
At present the simulation method is designed to capture the local and internal
evolution of the ARs.

In Yardley et al. (2018a) the origin of each high-altitude event was not studied
in detail but it was suggested that they could be the result of the formation of
a high-altitude structure during the evolution of the AR or the destabilization
of a pre-existing external structure. The build-up to the high-altitude eruptions
that were observed in ARs 11446, 11886, and 12336 were not replicated by the
simulations. This could be taken into account in future work by using a NLFF
ﬁeld initial condition on a case-by-case basis if a ﬂux rope is present at the start
or early stages of the simulation. However, if the high-altitude events are a result
of the destabilisation of pre-existing structures then this technique will not be
able to capture their formation. Therefore, to be able to capture the onset of
eruptions that arise due to the interaction of external magnetic ﬁelds or large-
scale coronal structures, non-local eﬀects need to be taken into account by using
global NLFF ﬁeld models (e.g. Mackay and van Ballegooijen 2006a) to simulate
the evolution of the large-scale corona.

Presently, we have focused on simulating the evolution of a set of relatively
simple, bipolar ARs that produce faint eruption signatures and a limited number
of CMEs. However, this is necessary to test the method before simulating larger,
more complex ARs. In the future we will simulate a broader range of ARs, in-
cluding multipolar regions and large AR complexes that produce multiple CMEs.
Given the results of the applied technique simulating larger, multipolar and
non-isolated regions should be possible but will require a larger computational
domain.

SOLA: ms.tex; 15 December 2020; 2:00; p. 19

S. L. Yardley et al.

6. Summary

In this study, the coronal evolution of 20 bipolar ARs was simulated from emer-
gence to decay. The simulations were carried out in order to test whether the
evolution of the coronal magnetic ﬁeld through a series of NLFF states driven
by boundary motions could successfully reproduce the observed coronal features
of the ARs and the onset of eruption. The coronal magnetic ﬁeld evolution
was simulated by applying the NLFF ﬁeld method of Mackay, Green and van
Ballegooijen (2011) to LoS magnetograms taken by SDO/HMI that were used
as the lower boundary conditions. The simulated coronal ﬁeld evolution for each
AR was manually compared to the 171 and 193 ˚A emission structures as seen
by SDO/AIA.

The ﬁrst simulation results were obtained using the simplest initial and bound-
ary conditions i.e. a potential ﬁeld initial condition and a closed top boundary.
By using this approach it was possible to reproduce a reasonable amount of the
coronal structure and evolution for 80% of the AR sample. In total, the build-up
to eruption was successfully followed in the simulations within a ± 12 hr window
of the eruptions occurring in the observations for 12 out of the 24 (50%) of the
observed eruptions.

To improve the simulation results we varied the boundary (from closed to
open) and initial condition (from potential to LFF) and included additional
parameters such as Ohmic diﬀusion, hyperdiﬀusion, and an additional injection
of horizontal magnetic ﬁeld and magnetic helicity in the simulations. We also
took into account boundary eﬀects by re-scaling the magnetogram at the bottom
of the computational box and removed small-scale magnetic features that aﬀect
the large-scale evolution of the coronal ﬁeld by applying Gaussian smoothing
to the magnetograms. These steps were in addition to the clean-up procedures
and were carried out one at a time. Through considering various combinations of
additional terms there was a slight improvement in the results, as one AR moved
from scoring category 3 to 2 and two ARs moved from category 2 to 1. Therefore,
by varying the boundary and initial conditions and including additional physical
eﬀects in the simulation there was an overall improvement of 20%. Overall, the
simulations were able to capture a reasonable amount of coronal structure for
85% of the AR sample, only failing to capture the structure of 15% of the regions.
Despite varying the boundary and initial conditions and including additional
global parameters the simulations are only able to successfully follow the build-
up to eruption for 50% of the observed eruptions associated with the AR sample.
For the successful cases, the key component in reproducing the coronal evolution
and build-up to eruption for the ARs is the use of LoS magnetograms, as the
lower boundary conditions to the simulations as changing the side/top boundary
conditions, initial condition and including additional physical aﬀects had an
insigniﬁcant eﬀect on the simulated coronal ﬁeld evolution.

The unsigned mean time diﬀerence between the signatures of eruption onset
in the simulations compared to the observed eruptions was ≈5 hrs. The sim-
ulations were carried out over a time period of roughly 96–120 hrs therefore,
a mean time diﬀerence between eruption onset occurring in the observations
compared to the simulations of ≈5 hrs is a very favourable result (within 3

SOLA: ms.tex; 15 December 2020; 2:00; p. 20

Coronal Evolution of Bipolar ARs

applied magnetograms). As current space weather forecasting methods can only
provide a warning post-eruption and 1–3 days before the arrival of a CME at
Earth with an uncertainty of 12 hrs, our results are well within the present time
error. Also, as our approach is computationally eﬃcient we can reproduce the
coronal magnetic ﬁeld evolution of ARs over several days within a few hours of
computation time on a desktop machine.

In fact, Pagano, Mackay and Yardley (2019a,b) have demonstrated how erup-
tion metrics based on the NLFF ﬁeld simulations may be used to distinguish
eruptive from non-eruptive ARs. This work has also demonstrated how it is
possible to provide near-real time alerts of eruptions using the observed LoS
magnetograms, the NLFF ﬁeld simulations and the projection of the simulations
forward in time. The analysis carried out in these studies includes four ARs taken
from our AR sample in this paper. The initial results from Pagano, Mackay
and Yardley (2019a,b) are promising but additional work is required, including
addressing the issues outlined in Section 5, before the method can identify the
exact eruption time and be implemented for CME forecasting purposes.

In summary, the full coronal magnetic ﬁeld evolution of 20 bipolar ARs was
simulated using the time-dependent NLFF ﬁeld method of Mackay, Green and
van Ballegooijen (2011). Using this method, it was possible to reproduce the
main coronal features present in the observations for 85% of the AR sample.
The simulations were also able to successfully follow the build-up to and onset
of eruption within a ±12 hr window for 12 out of the 24 eruptions (50%) that
were identiﬁed in the observations. The mean unsigned time diﬀerence between
the eruptions occurring in the observations compared to the time of eruption
onset in the simulations was found to be ≈5 hrs. It is important to acknowledge
that for all four eruptions that took place along the internal PIL of the ARs,
the simulations were able to model the timings of eruption onset with a mean
unsigned time diﬀerence of ≈7 hrs. Therefore, the simulations were able to
successfully reproduce the local evolution for the majority of the ARs in the
sample.

Acknowledgments The authors would like to thank SDO/HMI and AIA consortia for the
data, and also for being able to browse this data through JHelioviewer (http://jhelioviewer.org,
M¨uller et al. 2017). The analysis in this paper has made use of SunPy, which is an open-source

and free community-developed solar data analysis package written in Python (SunPy Com-
munity et al., 2015). S.L.Y. would like to acknowledge STFC for support via the Consolidated
Grant SMC1/YST025. D.H.M. would like to thank STFC, the Leverhulme Trust and the
ERC under the Synergy Grant: The Whole Sun, grant agreement no. 810218 for ﬁnancial
support. L.M.G. is thankful to the Royal Society for a University Research Fellowship and the
Leverhulme Trust.

Disclosure of Potential Conﬂicts of Interest The authors declare that

they have no conﬂicts of interest.

SOLA: ms.tex; 15 December 2020; 2:00; p. 21

Table 1.: The 20 bipolar ARs simulated in this study. The table includes the NOAA number assigned to the AR and the heliographic coordinates of the
AR at the time of emergence. The value of peak unsigned ﬂux (half the total absolute positive and negative ﬂux), the start of emergence, peak unsigned
ﬂux and end of observation times are also given. The timings of the events that originate from low altitude along the internal PIL, along external PILs,
and from high altitude are listed in the ﬁnal columns. The time and GOES class of four ﬂares and the timings of the two CMEs that are observed in
LASCO/C2 that are associated with the ARs are given in the footnotes. The AR properties in this Table have been taken from the previous study of
Yardley et al. (2018a).

NOAA
AR
No.
11437

Hel.
Coords.
(θ,φ)
S29 E33

Magnetic
Flux
(1021 Mx)
0.6

Emergence Start
Time
(UT)
16-Mar-12 12:46

Peak Flux
Time
(UT)
17-Mar-12 15:58

End
Time
(UT)
21-Mar-12 01:34

114461 N31 E20
S14 E26
11480
S18 E34
11561
11680
S25 E52
118082 N12 E66

118133
11867
11881

S19 E22
N17 E05
S25 E52

11886
12086
12119

N10 E14
N03 E49
S26 E38

1.0
0.8
1.5
2.2
3.9

2.7
3.3
1.4

2.3
0.9
2.5

22-Mar-12 15:58
09-May-12 11:10
29-Aug-12 19:10
24-Feb-13 14:22
29-Jul-13 01:34

24-Mar-12 15:58
11-May-12 04:46
31-Aug-12 04:46
25-Feb-13 14:22
30-Jul-13 01:34

26-Mar-12 23:58
13-May-12 23:58
01-Sep-12 23:58
03-Mar-13 17:34
07-Aug-13 23:58

06-Aug-13 01:34
11-Oct-13 07:58
24-Oct-13 01:34

08-Aug-13 17:34
13-Oct-13 15:58
26-Oct-13 15:58

11-Aug-13 23:58
14-Oct-13 04:46
29-Oct-13 23:58

28-Oct-13 09:34
08-Jun-14 15:58
18-Jul-14 04:46

30-Oct-13 17:34
09-Jun-14 23:58
21-Jul-14 06:22

01-Nov-13 22:22
11-Jun-14 23:58
23-Jul-14 23:58

Internal PIL
Event Timings
(UT)
20-Mar-12 14:46
17-Mar-12 10:53
-
-
01-Sep-12 23:37
03-Mar-13 17:27
-

-
-
-
-
-
-
-
-
-
-

External PIL
Event Timings
(UT)
17-Mar-12 05:14
-
-
-
-
-
-

-
-
-
-
-
-
10-Jun-14 14:49
18-Jul-14 10:40
22-Jul-14 21:02
23-Jul-14 07:305

High Altitude
Event Timings
(UT)
-

24-Mar-12 00:42
-
-
-
30-Jul-13 04:04
31-Jul-13 15:10
-
-
24-Oct-13 08:104
27-Oct-13 19:45
29-Oct-13 02:58
29-Oct-13 12:57
-
-
-
-

1GOES B4.0 class ﬂare, 26-Mar-12 13:17 UT
2GOES B8.7 class ﬂare, 30-Jul-13 20:49 UT
3GOES B5.5 class ﬂare, 08-Aug-13 16:14 UT
4LASCO/C2 CME, 24-Oct-13 09:12 UT
5LASCO/C2 CME, 23-Jul-14 08:12 UT

S

.

L

.

Y
a
r
d
l
e
y

e
t

a
l
.

S
O
L
A
:

m
s
.
t
e
x
;

1
5

D
e
c
e
m
b
e
r

2
0
2
0
;

2
:
0
0
;

p
.

2
2

12168
12229

N10 E08
S23 E50

122736 N02 E21
N03 E09
12274
N17 E49
12336

12382
12453
12455

S08 E29
N04 E29
N14 E61

2.2
0.8

2.7
0.4
2.9

0.6
1.7
1.4

16-Sep-14 12:46
04-Dec-14 20:46

18-Sep-14 11:10
5-Dec-14 22:22

23-Sep-14 23:58
09-Dec-14 12:46

25-Jan-15 15:58
25-Jan-15 17:34
01-May-15 14:22

27-Jan-15 19:10
26-Jan-15 15:58
05-May-15 20:46

31-Jan-15 01:34
28-Jan-15 17:34
08-May-15 23:58

04-Jul-15 03:10
12-Nov-15 07:58
13-Nov-15 04:46

05-Jul-15 20:46
15-Nov-15 15:58
16-Nov-15 03:10

09-Jul-15 12:46
16-Nov-15 23:58
18-Nov-15 23:58

-
-
-
-
-
-
-
-
-
09-Jul-15 02:29
-
-

-
05-Dec-14 03:46
05-Dec-14 08:12
05-Dec-14 10:39
05-Dec-14 12:35
-
25-Jan-15 20:00
-
-
-
-
-

-
-
-
-
-
-
-
05-May-15 01:29
05-May-15 09:24
-
-
-

C
o
r
o
n
a
l

E
v
o
l
u
t
i
o
n

o
f

i

B
p
o
l
a
r
A
R
s

S
O
L
A
:

m
s
.
t
e
x
;

1
5

D
e
c
e
m
b
e
r

2
0
2
0
;

2
:
0
0
;

p
.

2
3

6GOES C2.4 class ﬂare, 27-Jan-15 05:43 UT

Table 2.: Results of the NLFF ﬁeld simulations. The table includes the NOAA AR number, the number of time steps or
magnetograms used to simulate the coronal evolution, and whether there was a ﬂux imbalance present between the positive and
negative photospheric polarities of the AR. This is followed by the agreement between the simulations and observations, the number
of observed eruptions the simulation can follow the build-up to eruption for, and the time diﬀerence between the signatures of
ﬂux rope eruption onset that occurred in the simulations and the eruptions in the observations. The ﬁnal column gives additional
information such as the location of the AR during emergence if close to 60◦, as well as the surrounding magnetic ﬁeld environment
the region emerges into. It also gives the initial conditions, boundary conditions and additional global parameters that were used
to improve the performance of the simulation. If improvements were made, the new score is given in brackets in column four.

NOAA
AR
11437
11446

No. of
timesteps
62
62

Flux
Imbalance
small
large

11480

69

11561
11680
11808

50
109
60 (48)

small

small
small
small

Score
1
2

2

1
1
3(2)

11813

90

small

1

-

No. of

Time
Eruptions Diﬀ. (hrs) Comments
-1, -10
-

2/3
0/1

-

1/1
1/1
1/2

-

-4
-9
12

-

-
Region dominated by positive quiet Sun magnetic
ﬁeld. Re-scaled boundary condition. LFF ﬁeld initial
condition is used with α = 1.18 × 10−8 m−1.
Re-scaled boundary condition. Gaussian smoothing
applied to remove small-scale ﬁeld.
-
-
Emerges before 60◦, started simulation at a later
time. LFF ﬁeld initial condition is used with α =
7.98 × 10−9 m−1.
Re-scaled boundary condition. LFF ﬁeld initial con-
dition is used with α = −6.42 × 10−9 m−1. Gaussian
smoothing applied to remove small-scale ﬁeld.

S

.

L

.

Y
a
r
d
l
e
y

e
t

a
l
.

S
O
L
A
:

m
s
.
t
e
x
;

1
5

D
e
c
e
m
b
e
r

2
0
2
0
;

2
:
0
0
;

p
.

2
4

11867

43

large

2(1)

-

-

11881
11886

86
69

small
small

12086

66 (51)

small

12119
12168
12229

85
107
71

small
large
large

12273

79

small

12274

46

large

12336

111

small

1
2

3

1
1
3

3

1

2

2/3
0/1

0/1

3/3
-
0/4

-

1/1

0/2

2, 1
-

-

6, -1, 0
-
-

-

5

-

C
o
r
o
n
a
l

E
v
o
l
u
t
i
o
n

o
f

i

B
p
o
l
a
r
A
R
s

Emerges into positive quiet sun magnetic ﬁeld. LFF
ﬁeld initial condition used with α = −5.64 ×
10−9 m−1. Gaussian smoothing applied to remove
small-scale ﬁeld.
-
Emerges into negative quiet Sun magnetic ﬁeld. LFF
ﬁeld condition is used with α = −8.91 × 10−9 m−1.
Emerged into negative quiet Sun magnetic ﬁeld. Re-
scaled boundary condition. Stopped simulation at an
earlier time step due to emergence.
-
Emerges into negative quiet Sun magnetic ﬁeld.
Emerged into negative quiet Sun magnetic ﬁeld.
Hard to compare to observations as limited coro-
nal loops are visible. Gaussian smoothing applied to
remove small-scale ﬁeld.
Large negative sunspot, with highly twisted struc-
ture along the internal PIL. Ohmic diﬀusion was
applied where η = 25 km2 s−1 and Gaussian smooth-
ing was applied to remove small-scale ﬁeld. An
additional injection of magnetic helicity was applied
where ζ =[-1,-10] km2 s−1.
Emerged into negative quiet Sun magnetic ﬁeld.
Hard to compare to observations as limited coronal
loops are visible.
LFF ﬁeld initial condition used with α = −8.89 ×
10−9 m−1. Gaussian smoothing applied to remove
small-scale ﬁeld.

S
O
L
A
:

m
s
.
t
e
x
;

1
5

D
e
c
e
m
b
e
r

2
0
2
0
;

2
:
0
0
;

p
.

2
5

12382
12453

78
70

small
large

1
1

1/1
-

12455

86

small

2(1)

-

-5
-

-

-
Emerged into negative quiet Sun magnetic ﬁeld. Very
twisted structure present at the end of the evo-
lution due to small-scale magnetic ﬁeld. Gaussian
smoothing applied to remove small-scale ﬁeld.
Emerged close to 60◦. Very twisted structure present
at the end of evolution. Re-scaled and coronal diﬀu-
sion added.

S
O
L
A
:

m
s
.
t
e
x
;

1
5

D
e
c
e
m
b
e
r

2
0
2
0
;

2
:
0
0
;

p
.

2
6

S

.

L

.

Y
a
r
d
l
e
y

e
t

a
l
.

Coronal Evolution of Bipolar ARs

Table 3. The simulation performance results.
The number and percentage of ARs in each scor-
ing category when using the simplest initial and
boundary conditions in the simulation are given.
The results for the simulations where additional
global parameters, Gaussian smoothing and LFF
ﬁeld conditions are used are given in brackets.

Score

1

2

3

No. of ARs
Percentage (%)

10 (12)
50 (60)

6 (5)
30 (25)

4 (3)
20 (15)

Appendix

A. Clean-up Processes

To analyse the coronal evolution of the 20 bipolar ARs magnetogram data taken
from the SDO/HMI instrument were utilised. Full-disk LoS magnetograms were
used from the 720 s data series (hmi.M 720s), which have a pixel size and a noise
level of 0.5” and 10 G, respectively. The number of magnetograms used to study
the evolution of each AR varied depending upon the ARs lifetime and selection
criteria. We apply the following cosine correction before the clean-up procedures
are implemented to estimate the radial magnetic ﬁeld component:

BR =

BLOS
cos θ cos φ

,

(5)

where BLOS is the line-of-sight magnetic ﬁeld and θ and φ are expressed in
heliocentric coordinates (see Section 2.3 of Yardley et al. (2018a) for further
details). Each corrected magnetogram is then diﬀerentially rotated to account
for area foreshortening that occurs at large distances from central meridian.
Cut-outs of the corrected, de-rotated magnetograms are taken, centred on the
AR. This is a relatively simple correction however, this method has been used
in previous studies (for example see Yardley, Mackay and Green 2018b).

The clean-up procedure described in this section is comparable to the pro-
cedure that is used in both Gibb et al. (2014) and Yardley, Mackay and Green
(2018b). The noise level in the raw magnetograms is high, particularly in the
early and late stages of AR evolution when the AR is located far from central
meridian. Therefore, before the magnetograms are used as the lower boundary
conditions of the simulation a number of clean-up processes are implemented.
First, the magnetograms are time-averaged by applying the following Gaussian
kernel

Ci =

(cid:80)n

j=1 exp(−[i − j]/τ )2Fj
j=1 exp(−[i − j]/τ )2 ,
(cid:80)n

(6)

SOLA: ms.tex; 15 December 2020; 2:00; p. 27

S. L. Yardley et al.

Figure 6. The raw and cleaned magnetograms for AR 11867 taken at 15:59 UT on 2013
October 13 when the region reaches its maximum unsigned magnetic ﬂux. The saturation
level of both the magnetograms is ±100 G. The ﬂux-weighted central coordinates for the
positive and negative photospheric magnetic polarities are represented by the red and green
asterisks, respectively.

where Ci is the ith cleaned frame and takes values between 1 to n where n
is the number of magnetograms in the sequence. FJ is the jth raw frame, and
τ represents the frame separation where the weighting decreases by 1/e. In this
study, the frame separation is set to two meaning that each cleaned frame is a
linear combination of the total number of raw frames where the two frames before
and after the current frame are weighted the highest. This procedure removes
random noise and retains the large-scale features of the ARs. As previously
stated, this study focuses on the large-scale evolution of the AR magnetic ﬁeld
and not small-scale elements of the quiet Sun.

The next step in the clean-up process includes the removal of small-scale
isolated ﬁeld pixel-by-pixel by evaluating the eight nearest neighbours of each
pixel. When fewer than four of the neighbouring pixels have the same sign
of magnetic ﬂux then the value of magnetic ﬂux of that pixel is set to zero.
Therefore, the pixels at the edge of the magnetogram also have their values set
to zero as they have less than four nearest neighbours. In addition, any pixels
that have a magnetic ﬂux value below a 25 Mx cm−2 threshold are part of the
background magnetic ﬁeld of the quiet Sun and are also set to zero. At this
point the user can choose how to place the magnetograms within the box i.e. the
magnetograms can be scaled up/down to ﬁt the computational box or a custom
scaling can be applied. In this study, to avoid boundary eﬀects, we rescale the
magnetograms to ﬁll 60–70% of the computational box.

The last clean-up process is implemented when the top boundary condition in
the simulation is set to closed and the magnetograms need to be ﬂux balanced.
To ﬂux balance the magnetograms the signed magnetic ﬂux of each frame is
calculated. The pixels of non-zero value are summed for each frame and the
signed magnetic ﬂux is divided by this total. From every pixel that has a non-
zero value the imbalanced magnetic ﬂux per pixel is deducted. As the maximum
correction is less than 25 Mx cm−2 no pixels change sign during the balancing

SOLA: ms.tex; 15 December 2020; 2:00; p. 28

Coronal Evolution of Bipolar ARs

Figure 7. The raw and cleaned magnetograms for simulation frame 35 taken on 2013 October
13 when AR 11867 is at its maximum unsigned magnetic ﬂux value. A Gaussian kernel is used to
remove small-scale magnetic ﬁeld surrounding the AR before the clean-up processes described
in Section A are applied. For both magnetograms the saturation levels of the photospheric
magnetic ﬁeld are ±100 G. The ﬂux-weighted central coordinates for the positive and negative
photospheric magnetic polarities are represented by the red and green asterisks, respectively.

of magnetic ﬂux. This is the same threshold that is used to set pixels that form
part of the background quiet Sun magnetic ﬁeld to zero.

B. Gaussian Smoothing

In some cases the small-scale magnetic ﬁeld at the periphery of the AR is removed
before the clean-up procedure is applied (Figure 7). This is achieved by using a
method similar to Yardley et al. (2016). Firstly, a Gaussian ﬁlter is applied with
a standard deviation (width) of 7 pixel units to smooth the data. Secondly, the
weighted average of the value of magnetic ﬂux density of the neighbouring pixels
must exceed a 40 G cut-oﬀ. Then, the largest regions that are identiﬁed that
make up at least 60% of the selected area are kept whereas, smaller features at
large distances from the AR are discarded. This procedure removes small-scale
quiet Sun features that are not part of the AR, and does not aﬀect the coronal
evolution as we are only interested in the large-scale coronal evolution of the
AR.

C. Comparison to Vector Magnetic Field Observations

The method used to simulate the coronal evolution of our AR sample uses a
time series of LoS magnetograms as the photospheric boundary condition. This
boundary condition injects electric currents into the coronal magnetic ﬁeld which
then evolves through a time series of NLFF ﬁelds using the magnetofrictional
relaxation process. At no point in the simulation do we constrain the solution
using the observed vector magnetic ﬁeld or with coronal observations. Therefore
we allow the boundary evolution to self-consistently produce the horizontal ﬁeld

SOLA: ms.tex; 15 December 2020; 2:00; p. 29

S. L. Yardley et al.

and subsequently the coronal structures. The reproduced coronal structures are
therefore due to non-potential eﬀects produced by the horizontal evolution of
the LoS magnetic ﬁelds along with any ﬂux emergence or cancellation.

To show that our magnetic ﬁeld at the photosphere is consistent with the
observations and that the simulated coronal structures can be compared with
the observed ones we have included a comparison of our simulated vector ﬁeld at
the boundary with the observed vector ﬁeld. Figure 8 shows the vector magnetic
ﬁeld components from the simulation on the base compared to the observed
vector data for AR 11561 where the comparison is carried out midway through
its evolution. To produce the observed vector ﬁeld components we have used
the space weather HMI active region patches (SHARPS, Bobra et al. 2014) data
that have been projected to the Lambert cylindrical equal-area (CEA) Cartesian
coordinate system i.e. the hmi.sharp cea 720s series. The ﬁgure shows that there
is a relatively good agreement between the simulated horizontal ﬁeld components
and the observed horizontal ﬁeld, particularly in the strong ﬁeld regions where
the signal-to-noise ratio is high. To determine quantitatively whether there is a
close correspondence between the horizontal components derived from the base
of the simulation and the observed vector components we will conduct an in-
depth comparison in a follow-up study. This will include a detailed comparison
of the sign and distribution of the three magnetic ﬁeld components for both the
vector ﬁeld of the simulation and observed vector data.

References

Antiochos, S.K.: 2013, Astrophys. J. 772, 72. DOI.
Arge, C.N., Luhmann, J.G., Odstrcil, D., Schrijver, C.J., and Li, Y.: 2004, J. Atmos. Solar-

Terr. Phys. 66, 1295. DOI.

Arge, C.N., and Pizzo, V.J.: 2000, jgr 105, 10465. DOI.
Bhattacharjee, A., and Yuan, Y.: 1995, Astrophys. J. 449, 739. DOI.
Bobra, M.G., Sun, X., Hoeksema, J.T., Turmon, M., Liu, Y., Hayashi, K., Barnes, G., and

Leka, K.D.: 2014, Solar Physics 289, 3549. DOI.

Bobra, M.G., van Ballegooijen, A.A., and DeLuca, E.E.: 2008, Astrophys. J. 672, 1209. DOI.
Boozer, A.H.: 1986, Journal of Plasma Physics 35, 133. DOI.
Canou, A., and Amari, T.: 2010, Astrophys. J. 715, 1566. DOI.
Charbonneau, P.: 2010, Living Reviews in Solar Physics 7, 3. DOI.
Charbonneau, P.: 2014, Annual Review of Astronomy and Astrophysics 52, 251. DOI.
Couvidat, S., Schou, J., Hoeksema, J.T., Bogart, R.S., Bush, R.I., Duvall, T.L., Liu, Y., Norton,

A.A., and Scherrer, P.H.: 2016, Solar Phys. 291, 1887. DOI.

De Rosa, M.L., Schrijver, C.J., Barnes, G., Leka, K.D., Lites, B.W., Aschwanden, M.J., Amari,
T., Canou, A., McTiernan, J.M., R´egnier, S., Thalmann, J.K., Valori, G., Wheatland, M.S.,
Wiegelmann, T., Cheung, M.C. M., Conlon, P.A., Fuhrmann, M., Inhester, B. and Tadesse,
T.: 2009, The Astrophysical Journal, 696, 1780. DOI.

Eastwood, J. P., Biﬃs, E., Hapgood, M. A., Green, L. M., Bisi, M. M., Bentley, R. D., Wicks,

R., McKinnel, L.-A., Gibbs, M., and Burnett, C.: 2017, Risk Analysis, 37, 206. DOI.

Finn, J.M., Guzdar, P.N., and Usikov, D.: 1994, Astrophys. J. 427, 475. DOI.
Forbes, T.G.: 2000, J. Geophys. Res. 105, 23153. DOI.
Forbes, T.G., and Isenberg, P.A.: 1991, Astrophys. J. 373, 294. DOI.
Gosling, J.T.: 1993, J. Geophys. Res. 98, 18937. DOI.
Gibb, G.P.S.: 2015, The Formation and Eruption of Magnetic Flux Ropes in Solar and Stellar

Coronae, PhD Thesis.DOI.

Gibb, G.P.S., Mackay, D.H., Green, L.M., and Meyer, K.A.: 2014, Astrophys. J. 782, 71. DOI.
Green, L.M., T¨or¨ok, T., Vrˇsnak, B., Manchester, W., and Veronig, A.: 2018, Space Sci. Rev.

214, 46. DOI.

SOLA: ms.tex; 15 December 2020; 2:00; p. 30

Coronal Evolution of Bipolar ARs

Figure 8. The vertical and horizontal components of the magnetic ﬁeld of AR 11561 taken
from the simulation (top panel) and the corresponding observed vector data (bottom panel).
The vertical component of the magnetic ﬁeld is shown where the positive (negative) pho-
tospheric polarities of the AR are represented by the black (white) contours saturated at
500 G. The red arrows represent the magnitude and direction of the horizontal magnetic ﬁeld
components.

Jiang, C., Wu, S.T., Feng, X., and Hu, Q.: 2014, Astrophys. J. Lett. 786, L16. DOI.
Kliem, B., Lin, J., Forbes, T.G., Priest, E.R., and T¨or¨ok, T.: 2014, Astrophys. J. 789, 46.

DOI.

Kliem, B., and T¨or¨ok, T.: 2006, Phys. Rev. Lett. 96, 255002. DOI.
Leka, K.D., Canﬁeld, R.C., McClymont, A.N., and van Driel-Gesztelyi, L.: 1996, Astrophys.

J. 462, 547. DOI.

Lemen, J.R., Title, A.M., Akin, D.J., Boerner, P.F., Chou, C., Drake, J.F., Duncan, D.W.,
Edwards, C.G., Friedlaender, F.M., Heyman, G.F., Hurlburt, N.E., Katz, N.L., Kushner,
G.D., Levay, M., Lindgren, R.W., Mathur, D.P., McFeaters, E.L., Mitchell, S. Rehse, R.A.,
Schrijver, C.J., Springer, L. A., Stern, R.A., Tarbell, T.D., Wuelser, J., Wolfson, C.J.,

SOLA: ms.tex; 15 December 2020; 2:00; p. 31

S. L. Yardley et al.

Yanari, C. Bookbinder, J.A., Cheimets, P.N., Caldwell, D., Deluca, E.E., Gates, R., Golub,
L., Park, S., Podgorski, W.A., Bush, R.I., Scherrer, P.H., Gummin, M. A., Smith, P., Auker,
G., Jerram, P., Pool, P., Souﬂi, R., Windt, D.L., Beardsley, S., Clapp, M., Lang, J., and
Waltham, N.: 2012, Solar Phys. 275, 17. DOI.

Longbottom, A.: 1998, IAU Colloq. 167: New Perspectives on Solar Prominences, 274.
Luoni, M.L., D´emoulin, P., Mandrini, C.H., and van Driel-Gesztelyi, L.: 2011, Solar Phys.

270, 45. DOI.

Mackay, D.H., DeVore, C.R., and Antiochos, S.K.: 2014, Astrophys. J. 784, 164. DOI.
Mackay, D.H., Green, L.M., and van Ballegooijen, A.: 2011, Astrophys. J. 729, 97. DOI.
Mackay, D.H., and van Ballegooijen, A.A.: 2006a, Astrophys. J. 641, 577. DOI.
Mackay, D.H., and van Ballegooijen, A.A.: 2006b, Astrophys. J. 642, 1193. DOI.
Mackay, D.H., and van Ballegooijen, A.A.: 2009, Solar Phys. 260, 321. DOI.
Mays, M.L., Taktakishvili, A., Pulkkinen, A., MacNeice, P.J., Rast¨atter, L., Odstrcil, D., Jian,
L.K., Richardson, I.G., LaSota, J.A., Zheng, Y., and Kuznetsova, M.M.: 2015, Solar Phys.
290, 1775. DOI.

Moore, R.L., Sterling, A.C., Hudson, H.S., and Lemen, J.R.: 2001, Astrophys. J. 552, 833.

DOI.

M¨uller, D., Nicula, B., Felix, S., Verstringe, F., Bourgoignie, B., Csillaghy, A., Berghmans,
D., Jiggens, P., Garc´ıa-Ortiz, J.P., Ireland, J., Zahniy, S., and Fleck, B.: 2017, Astron.
Astrophys. 606, A10. DOI.

Odstrcil, D., Riley, P., and Zhao, X.P.: 2004, J.Geophys. Res. A 109, A02116. DOI.
Pagano, P., Mackay, D.H., and Yardley, S.L.: 2019a, The Astrophysical Journal 883, 112. DOI.
Pagano, P., Mackay, D.H., and Yardley, S.L.: 2019b, The Astrophysical Journal 886, 81. DOI.
Parker, E.N.: 1955, Astrophys. J. 121, 491. DOI.
Pesnell, W.D., Thompson, B.J., and Chamberlin, P.C.: 2012, Solar Phys. 275, 3. DOI.
Pomoell, J., Lumme, E., and Kilpua, E.: 2019, Solar Physics 294, 41. DOI.
Rodkin, D., Goryaev, F., Pagano, P., Gibb, G., Slemzin, V., Shugay, Y., Veselovsky, I., and

Mackay, D.H.: 2017, Solar Phys. 292, 90. DOI.

Savcheva, A.S., Green, L.M., van Ballegooijen, A.A., and DeLuca, E.E.: 2012, Astrophys. J..

759, 105. DOI.

Schou, J., Scherrer, P.H., Bush, R.I., Wachter, R., Couvidat, S., Rabello-Soares, M.C., Bogart,
R.S., Hoeksema, J.T., Liu, Y., Duvall, T.L., Akin, D.J., Allard, B.A., Miles, J.W., Rairden,
R., Shine R.A., Tarbell, T.D., Title, A.M., Wolfson, C.J., Elmore D.F.,Norton A.A., and
Tomczyk S.: 2012, Solar Phys. 275, 229. DOI.

Schrijver, C.J., De Rosa, M.L., Metcalf, T.R., Liu, Y., McTiernan, J., R´egnier, S., Valori, G.,

Wheatland, M.S., and Wiegelmann, T.: 2006, Solar Phys. 235, 161. DOI.

Spiegel, E.A., and Zahn, J.-P.: 1992, Astron. Astrophys. 265, 106.
Strauss, H.R.: 1988, Astrophys. J. 326, 412. DOI.
Su, Y., van Ballegooijen, A., Lites, B.W., Deluca, E.E., Golub, L., Grigis, P.C., Huang, G.,

and Ji, H.: 2009, Astrophys. J. 691, 105. DOI.

SunPy Community, Mumford, S.J., Christe, S., P´erez-Su´arez, D., Ireland, J., Shih, A.Y., Inglis,
A.R., Liedtke, S., Hewett, R.J., Mayer, F., Hughitt, K., Freij, N., Meszaros, T., and, ...:
2015, Computational Science and Discovery 8, 14009. DOI.

T¨or¨ok, T., and Kliem, B.: 2005, Astrophys. J. Lett. 630, L97. DOI.
Valori, G., Kliem, B., and Keppens, R.: 2005, Astron. Astrophys. 433, 335. DOI.
van Ballegooijen, A.A.: 2004, The Astrophysical Journal 612, 519. DOI.
van Ballegooijen, A.A., and Mackay, D.H.: 2007, Astrophys. J. 659, 1713. DOI.
van Ballegooijen, A.A., and Martens, P.C.H.: 1989, Astrophys. J. 343, 971. DOI.
van Ballegooijen, A.A., Priest, E.R., and Mackay, D.H.: 2000, Astrophys. J. 539, 983. DOI.
van Driel-Gesztelyi, L. and Green, L.M.: 2015, Living Reviews in Solar Physics 12, 1. DOI.
Wiegelmann, T., and Sakurai, T.: 2012, Living Reviews in Solar Physics 9, 5. DOI.
Yang, W.-H., Sturrock, P.A., and Antiochos, S.K.: 1986, Astrophys. J. 309, 383. DOI.
Yardley, S.L., Green, L.M., van Driel-Gesztelyi, L., Williams, D.R., and Mackay, D.H.: 2018a,

Astrophys. J. 866, 8. DOI.

Yardley, S.L., Green, L.M., Williams, D.R., van Driel-Gesztelyi, L., Valori, G., and Dacie, S.:

2016, The Astrophysical Journal 827, 151. DOI.

Yardley, S.L., Mackay, D.H., and Green, L.M.: 2018b, Astrophys. J. 852, 82. DOI.
Yardley, S.L., Savcheva, A., Green, L.M., van Driel-Gesztelyi, L., Long, D., Williams, D.R.,

and Mackay, D.H.: 2019, The Astrophysical Journal 887, 240. DOI.

Yeates, A.R., Mackay, D.H., and van Ballegooijen, A.A.: 2007, Solar Phys. 245, 87. DOI.
Zwaan, C.: 1985, Solar Phys. 100, 397. DOI.

SOLA: ms.tex; 15 December 2020; 2:00; p. 32

