Draft version September 14, 2018
Typeset using LATEX twocolumn style in AASTeX61

SIMULATING THE CORONAL EVOLUTION OF AR 11437 USING SDO/HMI MAGNETOGRAMS

Stephanie L. Yardley,1 Duncan H. Mackay,1 and Lucie M. Green2

1School of Mathematics and Statistics, University of St Andrews, North Haugh, St Andrews, Fife, KY16 9SS, UK
2Mullard Space Science Laboratory, University College London, Holmbury St. Mary, Dorking, Surrey, RH5 6NT, UK

ABSTRACT

The coronal magnetic ﬁeld evolution of AR 11437 is simulated by applying the magnetofrictional relaxation technique
of Mackay et al. (2011). A sequence of photospheric line-of-sight magnetograms produced by SDO/HMI are used to
drive the simulation and continuously evolve the coronal magnetic ﬁeld of the active region through a series of non-
linear force-free equilibria. The simulation is started during the ﬁrst stages of the active region emergence so that
its full evolution from emergence to decay can be simulated. A comparison of the simulation results with SDO/AIA
observations show that many aspects of the active region’s observed coronal evolution are reproduced. In particular,
it shows the presence of a ﬂux rope, which forms at the same location as sheared coronal loops in the observations.
The observations show that eruptions occur on 2012 March 17 at 05:09 UT and 10:45 UT and on 2012 March 20 at
14:31 UT. The simulation reproduces the ﬁrst and third eruption, with the simulated ﬂux rope erupting roughly 1 and
10 hours before the observed ejections, respectively. A parameter study is conducted where the boundary and initial
conditions are varied along with the physical eﬀects of Ohmic diﬀusion, hyperdiﬀusion and an additional injection of
helicity. When comparing the simulations, the evolution of the magnetic ﬁeld, free magnetic energy, relative helicity
and ﬂux rope eruption timings do not change signiﬁcantly. This indicates that the key element in reproducing the
coronal evolution of AR 11437 is the use of line-of-sight magnetograms to drive the evolution of the coronal magnetic
ﬁeld.

Keywords: Sun: activity — Sun: corona — Sun: coronal mass ejections (CMEs) — Sun: evolution —

Sun: magnetic ﬁelds — Sun: photosphere

7
1
0
2
c
e
D
1

]

R
S
.
h
p
-
o
r
t
s
a
[

1
v
6
9
3
0
0
.
2
1
7
1
:
v
i
X
r
a

Corresponding author: Stephanie L. Yardley
sly3@st-andrews.ac.uk

 
 
 
 
 
 
2

Simulating the coronal evolution of AR 11437

1. INTRODUCTION

Coronal mass ejections (CMEs) are the largest erup-
tive phenomenon in the Solar System, sending ∼1012
kg of magnetised plasma into interplanetary space at
speeds up to a few 1000 km s−1. These eruptions are
magnetically driven and approximately 1032 ergs of free
magnetic energy is initially built up in the non-potential
coronal magnetic ﬁeld. At the time of eruption a critical
point is reached and equilibrium is lost, resulting in the
energy stored being released as a CME (Forbes 2000).

Currently, all theoretical CME models involve the for-
mation of a ﬂux rope, which is composed of helical mag-
netic ﬁeld lines. However, the models diﬀer in when the
magnetic ﬂux rope forms. One set of models requires
the ﬂux rope to be present prior to the eruption with
CMEs being a result of an ideal instability or loss of
equilibrium (Forbes & Isenberg 1991; T¨or¨ok & Kliem
2005; Kliem & T¨or¨ok 2006; Mackay & van Ballegooijen
2006a,b; van Ballegooijen & Mackay 2007). In the other
scenario the ﬂux rope forms in-situ, during the eruption,
as a product of magnetic reconnection (Antiochos et al.
1999; Moore et al. 2001).

There is increasing observational evidence provided by
soft X-ray and EUV emission in the corona that ﬂux
ropes form prior to the eruption of CMEs (Green &
Kliem 2009; Green et al. 2011; Patsourakos et al. 2013).
The ﬁrst model of a ﬂux rope was proposed by Kuperus
& Raadu (1974) and consisted of a ﬁlament embedded
in a current sheet. This was advanced by van Balle-
gooijen & Martens (1989) with a model that focuses on
how the coronal ﬁeld evolves in response to the shearing
and convergence of photospheric magnetic ﬁeld. These
photospheric motions drive ﬂux cancellation and associ-
ated magnetic reconnection at the polarity inversion line
(PIL), transforming the sheared magnetic arcade into a
ﬂux rope conﬁguration.

As it is currently very diﬃcult to measure the coronal
magnetic ﬁeld directly, an alternative approach, such as
simulations or extrapolations of the photospheric mag-
netic ﬁeld, must be used to infer the pre-eruptive mag-
netic structure of CMEs. These numerical methods,
which use observational constraints, rely on the corona
being approximated as “force-free”. Therefore, the coro-
nal magnetic ﬁeld satisﬁes the force-free criterion of
j × B = 0, where j = αB. The torsion parameter
α = α(r) is a scalar function that remains constant along
ﬁeld lines, but is allowed to vary as a function of posi-
tion. If α = 0, this is the lowest energy case where the
magnetic ﬁeld is potential. While potential ﬁelds can
provide an approximate description of the coronal mag-
netic ﬁeld, they cannot be used to model active regions
or ﬁlaments as the free magnetic energy needed to drive

eruptions is not included. The most realistic description
is provided by a non-linear force-free (NLFF) magnetic
ﬁeld where α = α(r) is allowed to vary as a function of
position.

static or time-dependent models.

A number of NLFF magnetic ﬁeld methods have been
recently developed. The techniques that are used to gen-
erate NLFF magnetic ﬁelds can be split into two main
categories:
Static
models, which use a single ﬁxed lower boundary condi-
tion for the normal ﬁeld component, either extrapolate
the NLFF magnetic ﬁeld into the corona using vector
magnetograms (R´egnier et al. 2002; Schrijver et al. 2006;
Canou & Amari 2010; Jiang et al. 2014) or evolve the
initial potential or LFF coronal ﬁeld into a NLFF state.
The latter approach uses the magnetofrictional method
(Yang et al. 1986) to produce static NLFF magnetic ﬁeld
models at diﬀerent snapshots during the evolution of an
active region. This can be achieved by taking the po-
tential ﬁeld extrapolation of a magnetogram, setting the
photospheric magnetic ﬁeld to equal that found in the
vector magnetogram (Valori et al. 2005) or by inserting a
ﬂux rope into the potential ﬁeld (Bobra et al. 2008; Su et
al. 2009; Savcheva et al. 2012). In both cases the coronal
ﬁeld is then relaxed to a NLFF state. Although these
methods can produce a series of NLFF magnetic ﬁeld
models by changing the lower boundary condition, each
model is independent and therefore cannot be used to
study the dynamical, quasi-static evolution of the coro-
nal magnetic ﬁeld with time.

It is possible to use the magnetofrictional relaxation
technique to construct a continuous time-dependent se-
ries of NLFF magnetic ﬁelds by evolving the initial coro-
nal ﬁeld through changing the photospheric boundary
conditions. The coronal ﬁeld evolution can either be
driven using a continuous time series of artiﬁcial (van
Ballegooijen et al. 2000; van Ballegooijen & Mackay
2006; Mackay & van Ballegooijen 2009) or observed
(Yeates et al. 2007; Mackay et al. 2011; Gibb et al. 2014)
magnetograms. By using this method the memory of
the previous magnetic ﬁeld connectivities can be main-
tained along with the global conserved quantities. Gibb
et al. (2014) applied the method of Mackay et al. (2011)
to simulate the coronal evolution of AR 10977 using
SOHO/MDI line-of-sight (LoS) magnetograms as lower
boundary conditions and compared the simulated evo-
lution to Hinode/XRT observations. They were able to
reproduce the main coronal features and time-evolution
of the active region up until the single eruption of a
sigmoid. We extend this study by simulating the coro-
nal evolution of a diﬀerent active region to determine
if the simulation can reproduce multiple eruptions that
originate from the active region. The timings of the sim-

Coronal Evolution of AR 11437

3

ulated ﬂux rope eruptions and the observed ejections in
the SDO/AIA data will be compared. We also conduct
a parameter study where non-ideal terms and an addi-
tional injection of helicity are included in the simulation
to determine how the results of the simulation vary.

The active region to be simulated in this study is AR
11437. The evolution of AR 11437 has previously been
studied by Yardley et al. (2017), where 20 bipolar ac-
tive regions were analysed in order to investigate the role
of ﬂux cancellation in the production of CMEs. They
found that a combination of shear, convergence and can-
cellation is required to build a pre-eruptive magnetic
structure. This is consistent with the van Ballegooijen
& Martens (1989) scenario. AR 11437 produced three
eruptions during the time period studied. Two of the
ejections occurred during the active region emergence
phase, originating from an external PIL formed by the
active region periphery and quiet Sun magnetic ﬁeld.
The ﬁnal eruption occurred during the decay phase and
was produced at the internal PIL of the active region.
All three eruptions took place after ﬂux cancellation
had occurred either along the internal or external PIL.
The three eruptions that were observed in the 193 ˚A
SDO/AIA channel had no observable signatures in the
white-light coronograph data, therefore it remains un-
certain whether the material was ejected into interplan-
etary space.

This paper is structured as follows. Section 2 describes
the photospheric and coronal observations of AR 11437,
Section 3 details the properties of the AR including the
evolution of magnetic ﬂux and tilt angle. Section 4 out-
lines the simulation method including the photospheric
boundary conditions used. Section 5 gives the results
and a comparison of the simulations when global pa-
rameters are varied and ﬁnally Section 6 discusses the
results and concludes the study.

2. OBSERVATIONS

2.1. Photospheric Magnetic Field Evolution

The photospheric magnetic ﬁeld evolution of AR
11437 is studied during the time period beginning 2012
March 16 12:46 UT until 2012 March 21 01:34 UT using
the 720 s data series (Couvidat et al. 2016) produced
by the Helioseismic Magnetic Imager (HMI: Schou et al.
2012) on board the Solar Dynamics Observatory (SDO:
Pesnell et al. 2012). The time period captures the full
evolution of the AR allowing AR 11437 to be analysed
from emergence to decay (see Figure 1).

AR 11437 emerges on 2012 March 16 into the Sun’s
southern hemisphere. The AR has a simple bipolar
conﬁguration where the polarities are initially aligned
north-south (Figure 1 (a)). The leading positive polar-

ity is further from the equator than the following po-
larity, such that the bipole is anti-Joy’s Law. During
the ﬁrst two days of observations the AR remains in it’s
emergence phase and rotates counter-clockwise. The ro-
tation continues until the bipole is aligned east-west with
a Hale orientation. This aspect of rotation has also been
seen in ﬂux emergence simulations (Syntelis et al. 2017).
The region reaches its peak unsigned magnetic ﬂux on
2012 March 17 at 15:58 UT (Figure 1 (b)), where the
unsigned magnetic ﬂux is deﬁned as half the sum of the
total positive and negative ﬂux. The AR then enters its
decay phase, starts to disperse and small-scale magnetic
features converge towards the internal PIL. This leads
to ﬂux cancellation along the PIL between March 17–
19 (Figure 1 (b–d)). On 2012 March 18 the AR starts
to exhibit a strong counter-clockwise rotation (Figure 1
(d)). AR 11437 then crosses central meridian on 2012
March 19 at 09:00 UT. Small episodes of emergence are
observed during the ﬁnal two days of the evolution on
2012 March 19 at 10:00 UT and March 20 at 14:00 UT
(red arrows in Figure 1 (d–e)). The AR continues to dis-
perse until the leading positive polarity is more diﬀuse
than the following negative polarity (Figure 1 (f)).

2.2. Coronal Evolution

The coronal evolution of AR 11437 is analysed us-
ing EUV images taken by the Atmospheric Imaging As-
sembly (AIA: Lemen et al. 2012) on board SDO, which
provides full-disk, high-resolution observations in three
UV continuum wavelengths and seven EUV bandpasses.
These observations have a spatial and temporal resolu-
tion of 1.5” and 12 s, respectively. We focus on the 304
and 171 ˚A passbands, which are dominated by plasma
emission at temperatures of approximately 0.05 and 0.6
MK.

During the early stages of evolution the coronal loops,
observed using the 171 ˚A passband, evolve quickly from
a potential (not shown) to a highly sheared conﬁgura-
tion. The sheared coronal loops are highlighted by white
arrows in Figure 2 (a). These sheared loops periodi-
cally brighten as emergence continues and a system of
dark loops form at the periphery of the positive polar-
ity sunspot (Figure 2 (b)). On 2012 March 17 there
are two eruptions that take place in quick succession
during the emergence phase. There are no soft X-ray
ﬂares associated with these eruptions although, small
brightenings accompany both ejections. While there are
signatures present in the low corona that suggest these
ejections are CMEs, there is no clear evidence of any
of these eruptions in the white-light coronograph data.
This suggests that the CMEs may have a low density or
that they may be conﬁned or failed eruptions. There-

4

Simulating the coronal evolution of AR 11437

Figure 1. The photospheric ﬁeld evolution of AR 11437 as shown by a time sequence of SDO/HMI LoS magnetograms from
2012 March 16–21. The white (black) contours represent the positive (negative) polarities corresponding to saturation levels of
±500 G. The red arrows indicate the two sites of small-scale ﬂux emergence. The magnetograms have been de-rotated to disk
centre (2012 March 19 at 09:00 UT).

fore, we will refer to these events as either eruptions or
ejections rather than CMEs.

The ﬁrst eruption occurs on 2012 March 17 at ap-
proximately 05:09 UT when the dark loop system that
is located to the west of the positive polarity sunspot
erupts (Figure 2 (b)). A ﬁlament is observed to form in
304 ˚A (white arrow in Figure 3 (a)) which erupts a few
hours later on 2017 March 17 at approximately 10:45
UT. On 2012 March 18 the coronal loops slowly start
to reform. Two ﬁlaments form in 304 ˚A located in the
north-west and south-east of the AR (white arrows in
Figure 3 (b)). In the coronal emission a J-shaped struc-
ture becomes visible on 2012 March 19 (Figure 2 (c)).
This structure, which is best observed in 171 ˚A, is not
always seen. The J-shaped loops disappear and diﬀer-
ent loops that are part of the same structure become
visible (Figure 2(d)). The third and ﬁnal ejection from
this region occurs on 2012 March 20 at 14:31 UT when
the J-shaped loop system erupts and post-reconnection
loops are observed.

3. AR PROPERTIES

The coronal ﬁeld evolution of AR 11437 is simulated
using a continuous time sequence of lower boundary con-
ditions that are generated from photospheric LoS mag-
netograms (as discussed in Section 4.2). Before the sim-

ulations are carried out a clean-up process is applied
to the magnetograms, which is described in Appendix
A. The cleaning procedure includes time-averaging, re-
moval of low ﬂux values and small magnetic features
along with ﬂux balancing. This is to remove quiet sun
magnetic features whilst ensuring that the large-scale
evolution of the AR is retained. This section describes
the properties of AR 11437 that are derived from the
cleaned magnetograms.

3.1. Magnetic Flux Evolution

The magnetic ﬂux variation and the absolute ﬂux im-
balance for AR 11437 is shown in Figure 4 for the time
period beginning 2012 March 16 12:46 UT until 2012
March 21 01:34 UT. The evolution of the magnetic ﬂux
after the cleaning process is applied remains the same as
in the raw data. There is a ﬂux imbalance present during
both the emergence and decay phase of the AR. During
these two phases ﬁrst negative and then positive mag-
netic ﬂux dominates. This is a geometric eﬀect caused
by the presence of an east-west horizontal component
in the magnetic ﬁeld that links the two AR polarities
(Green et al. 2003). The strong horizontal component
has an additional contribution to the LoS magnetic ﬂux
with the imbalance increasing with distance from cen-
tral meridian. The ﬂux increases in the polarity closest

Coronal Evolution of AR 11437

5

Figure 2. The coronal evolution of AR 11437 observed using high-resolution 171 ˚A images taken from SDO/AIA. The LoS
magnetic ﬁeld from SDO/HMI is shown at a saturation of ±100 G with the red (blue) contours corresponding to positive
(negative) magnetic ﬂux, respectively. The white arrows in panel (a) indicate the presence of non-potential coronal loops, which
during the time period analysed evolve to become more sheared as seen in panel (b). In the later stages of the coronal evolution
J-shaped loops are observed to develop, shown in panels (c) and (d).

to the solar limb and so this eﬀect reverses when the
AR crosses central meridian. While this eﬀect exists
the ﬂux imbalance is small compared to the total ﬂux
throughout the time period considered.

AR 11437 emerges onto the disk on 2012 March 16 into
a region of relatively evenly distributed quiet Sun posi-
tive and negative polarity magnetic ﬁeld in the southern
hemisphere. The magnetic ﬂux continues to increase for
the ﬁrst two days of observations. During the ﬂux emer-
gence phase two eruptions occur on 2012 March 17 at
05:09 UT and 10:45 UT, which are represented by the
green dashed lines in Figure 4. The region reaches a
peak unsigned magnetic ﬂux of 4.7 × 1020 Mx on 2012
March 17 at 15:58 UT. The magnetic ﬂux is observed
to decrease between 2012 March 17 at 15:59 UT un-
til 2012 March 19 03:11 UT as ﬂux cancellation occurs
along the internal PIL. Approximately, 1.3 × 1020 Mx of
magnetic ﬂux is cancelled, calculated using the cleaned
magnetograms, which amounts to 27 % of the total un-
signed AR magnetic ﬂux. This can be compared to the
results of a study by Yardley et al. (2017), which found
a total of 1.7 × 1020 Mx is cancelled during this time
period, amounting to 31 % of the total unsigned active
region ﬂux. The diﬀerence between these two values is
due to the diﬀerent clean-up processes that have been

applied to the magnetograms along with the area that
is used to calculate the magnetic ﬂux in each study. In
the present study the magnetograms are treated with a
number of processes including time-averaging, low ﬂux
removal and isolated feature removal. All processes are
carried out so that the magnetograms can be used as
lower boundary conditions in the coronal ﬁeld simula-
tions. In contrast, only smoothing is applied in the ob-
servational study so that magnetic features that are not
part of the active region are disregarded. Therefore, the
only contribution to the calculation of magnetic ﬂux is
from the active region magnetic features. However, in
the simulation the magnetic ﬂux is calculated from the
reduction in magnetic ﬂux using the entire ﬁeld of view
of the magnetograms.

On 2012 March 19 at 10:00 UT and 2012 March 20 at
14:00 UT there are two small episodes of emergence at
the internal PIL. Shortly after the ﬁnal episode of ﬂux
emergence there is a third eruption at around 14:31 UT
on 2012 March 20.

3.2. Tilt Angle

The variation in tilt angle with time is calculated dur-
ing the same time period as the evolution of the mag-
netic ﬂux (2012 March 16 12:46 UT – 2012 March 21

6

Simulating the coronal evolution of AR 11437

Figure 4. Positive (red dot-dashed line), negative (blue
dashed line) and unsigned (black solid line) magnetic ﬂux of
AR 11437 between 2012 March 16 12:46 UT and 2012 March
21 01:34 UT. The black dashed line is the absolute value of
the ﬂux imbalance of the AR as a function of time. The
green dot-dashed lines show the times of the eruptions (E,
2012 March 17 05:09 UT, 2012 March 17 10:45 UT and 2012
March 20 at 14:21 UT) and the red dashed line represents
the central meridian passage time (2012 March 19 at 08:00
UT).

Figure 3. Filament formation in AR 11437 observed using
high-resolution 304 ˚A images from SDO/AIA. The ﬁlament
that forms in the north-west of the AR, shown in panel (a),
is observed to erupt but reforms after the eruption. Panel
(b) shows that a second ﬁlament forms in the south-east of
the active region, which extends out into the quiet Sun. The
white arrows in both panels show the locations of the two
ﬁlaments.

01:34 UT). The tilt angle of an active region is deﬁned
as the angle between the east-west direction on the Sun
and the line that connects the centre of ﬂux of the pos-
itive and negative AR polarities. Appendix B describes
how the tilt angle of the AR is calculated. Figure 5
shows that the evolution of the tilt angle before (red
dashed line) and after (red solid line) the clean-up pro-
cess is applied does not change.

At the start of the emergence phase the AR polarities
have a tilt angle of roughly 80◦ as the line that connects
the ﬂux-weighted centres of the active region polarities
is almost aligned north-south. As AR 11437 continues
to emerge the polarities rotate counter-clockwise until
the active region is aligned east-west with a tilt angle of

Figure 5. The evolution of the tilt angle as a function of
time for AR 11437. The red dashed (solid) line represents
the raw (clean) tilt angle of the AR.

approximately 30◦ on 2012 March 18. During the decay
phase, the active region polarities rotate clockwise, with
the tilt angle increasing to around 65◦ on 2012 March
20. On the ﬁnal day of observations, when the mag-
netic ﬁeld is more dispersed, the active region begins
to rotate counter-clockwise again and the tilt angle de-
creases slightly. The variation of the tilt angle is due to
the forces that are generated during the emergence and
decay of the active region and are opposite in nature to
that expected from diﬀerential rotation.

4. THE SIMULATION

Coronal Evolution of AR 11437

7

4.1. Coronal Field Evolution

The coronal magnetic ﬁeld evolution of AR 11437 is
simulated by using a magnetofrictional relaxation tech-
nique to generate a continuous time series of NLFF mag-
netic ﬁelds from a time sequence of photospheric LoS
magnetograms. The method of magnetofrictional relax-
ation was originally proposed by Yang et al. (1986) and
has since been successfully applied in numerous stud-
ies of ﬁlaments (van Ballegooijen et al. 2000; Mackay
& Gaizauskas 2003; Mackay & van Ballegooijen 2005,
2009), and magnetic ﬂux rope formation (Mackay &
van Ballegooijen 2006a; Gibb et al. 2014). As these
simulations evolve the coronal magnetic ﬁeld through
a continuous series of NLFF equilibria, magnetic con-
nectivity and ﬂux are preserved. This allows the injec-
tion of magnetic energy and helicity into the corona to
be analysed. When using independent coronal ﬁeld ex-
trapolations this type of analysis is not possible as with
independent extrapolations these quantities are not pre-
served from one time to the next.

To analyse the coronal ﬁeld evolution of AR 11437,
we use the same coronal modelling technique as Mackay
et al. (2011). The evolution of the 3D magnetic ﬁeld
B, where B = ∇ × A, is governed by the induction
equation,

∂A
∂t

= v × B,

(1)

where A is the magnetic vector potential and v is the
In the model, an artiﬁcial
magnetofrictional velocity.
frictional term known as the frictional coeﬃcient ν
, is
included in the equation of motion, which under the
force-free approximation (steady state, neglecting any
external forces) reduces to

(cid:48)

j × B − ν(cid:48)v = 0,

(2)

where j = ∇ × B. Hence, the magnetofrictional velocity
v, can be expressed as

v =

1
ν(cid:48) j × B,

(3)

where the frictional coeﬃcient takes the form ν(cid:48) = νB2.
The magnetofrictional velocity acts to ensure that the
magnetic ﬁeld remains close to a force-free equilibrium
as the ﬁeld is perturbed via boundary motions. The
frictional coeﬃcient is set such that, ν = 3000 km2 s−1,
as this value has produced the best match between the
simulated coronal ﬁeld and the coronal observations in
previous studies. A staggered grid is used in the compu-
tations to calculate the variables A, B and j to second-
order accuracy. The computational domain represents
the solar corona and the bottom of the box represents

the photosphere. The lower boundary conditions are
provided by the observed LoS magnetograms, which
undergo various clean-up processes (see Appendix A),
namely time-averaging, removal of isolated features and
low ﬂux values. Closed boundary conditions are used for
the sides of the box whereas, the top of the domain may
have either open or closed boundaries. If open bound-
ary conditions are selected then the magnetograms need
not be ﬂux balanced.
In contrast, if closed boundary
conditions are used then the magnetograms have to be
ﬂux balanced to ensure that ∇ · B = 0 is satisﬁed in
the coronal volume. In this study, simulations are car-
ried out using both open and closed top boundaries to
determine the relative eﬀect on the evolution of the coro-
nal ﬁeld (see Section 5.2). The generation of the lower
boundary conditions and initial condition are discussed
in the following section.

4.2. Photospheric Boundary Conditions and Initial

Condition

To simulate the evolution of AR11437, 62 LoS magne-
tograms from the HMI 720 s data series are used with a
cadence of 96 minutes. The medium cadence represents
a middle ground between the cadence available from cur-
rent space-borne and ground-based missions and future
instruments, which may have limited telemetry or tem-
poral resolution. The magnetograms span a 4.5 day pe-
riod around the central meridian passage of the AR and
are cleaned using the clean-up process described in Ap-
pendix A.

A number of simulations have been carried out with a
variety of parameters and open or closed top boundary
conditions as described in Section 5.2. The simulations
have a lower resolution than the LoS magnetograms as
the 278 × 279 pixel magnetograms are interpolated onto
a grid size of 2562. A continuous time sequence of lower
boundary conditions are generated from the corrected
magnetograms, which are designed to match the cleaned
LoS magnetograms, pixel by pixel, every 96 minutes.

To model the coronal ﬁeld evolution of AR 11437, the
horizontal components (Axb, Ayb) of the magnetic vector
potential A on the base corresponding to each magne-
togram must be determined. This process is carried out
as follows

1. Each of the observed LoS magnetograms, Bz(x, y, k)
for k = 1 → 62 are taken, where k represents the
discrete 96 minute time index.

2. The horizontal components of the vector potential
A at the base (z = 0) are expressed in the form

Axb(x, y, k) =

∂Φ
∂y

,

(4)

8

Simulating the coronal evolution of AR 11437

Ayb(x, y, k) = −

∂Φ
∂x

,

(5)

where Φ is a scalar potential.

3. For each discrete time index k, the following equa-

tion

then becomes

Bz =

∂Ayb
∂x

−

∂Axb
∂y

,

∂2Φ
∂x2 +

∂2Φ
∂y2 = −Bz,

(6)

(7)

which is solved using a multigrid numerical technique
(Finn et al. 1994; Longbottom 1998 and references
therein). In the construction of Ax and Ay from Bz in
the 2D plane identical boundary conditions are chosen
from one time to the next based on the Coulomb gauge.
This ensures that the change in Ax and Ay used to drive
the simulation is minimised within the Coulomb gauge.
Full details and be found in the papers of Mackay & van
Ballegooijen (2009); Mackay et al. (2011), based upon
the paper of Finn et al. (1994). In the recent paper of
Yeates (2017) a new localised technique for determining
the boundary condition at the level of the photosphere
has been put forward. Future studies will consider the
consequences of this.

By solving Equation 7 for the scalar potential Φ, the
horizontal components of the vector potential on the
base (Axb, Ayb) can be determined for each discrete time
interval, 96 minutes apart. For a continuous time se-
quence between each of the observed distributions to
be produced, the horizontal components Axb and Ayb
are linearly interpolated between each time interval k
and k + 1. The ﬁelds are interpolated using 500 in-
terpolation steps. This eﬀectively evolves the magnetic
ﬁeld from one observed photospheric ﬁeld to the next.
Through using this process, additional numerical tech-
niques, such as local correlation tracking, are not re-
quired as the horizontal velocity does not need to be
determined. Furthermore, the removal of undesirable
eﬀects such as numerical overshoot or magnetic ﬂux pile
up at cancellation sites is not necessary as these numer-
ical eﬀects do not occur.

Due to the numerical technique described above, there
are two timescales involved in the evolution of the lower
boundary condition. The ﬁrst is the 96 minute timescale
between observations, the second is a timescale of 11.52
introduced to produce the advection of the mag-
s,
netic polarities between observed states by interpola-
tion, along with the relaxation of the coronal ﬁeld.
The process described above reproduces the cleaned LoS

Figure 6. A selection of magnetic ﬁeld lines (black) that
illustrate the initial potential ﬁeld condition. The red (blue)
contours represent the positive (negative) photospheric mag-
netic ﬁeld.

magnetograms with a discrete time interval of 96 min-
utes, providing a description of the magnetogram obser-
vations that is highly accurate.

5. RESULTS

5.1. Magnetic Field Line Evolution

The evolution of the simulated coronal magnetic ﬁeld
will now be discussed for the simplest case where closed
boundary conditions are used at the top of the computa-
tional box. The results found for both open and closed
top boundary conditions were very similar and will be
discussed in Section 5.2. Therefore the nature of the
upper boundary condition does not have a signiﬁcant
eﬀect on the evolution of the ﬁeld.

The initial potential ﬁeld condition for the coronal
ﬁeld is constructed from the ﬁrst LoS magnetogram
taken on 2012 March 16 at 12:46 UT and is shown in
Figure 6. The AR has a simple, bipolar conﬁguration
where the ﬁeld lines that connect between the positive
(red contours) and negative (blue contours) polarities
consist of semi-circular loops. The simulated ﬁeld lines
match well with the coronal loops observed at this time.
Figure 7 shows a series of ﬁeld line plots taken from the
simulation that approximately correspond to the times
of the 171 ˚A AIA observations in Figure 2. A selection
of ﬁeld lines are displayed to demonstrate that within
the simulation many of the observable features are also
present. For example, in panel (a) of Figure 7, the sim-

Coronal Evolution of AR 11437

9

Figure 7. A series of ﬁeld line plots taken from the simulation that roughly correspond to the timings of the AIA observations
shown in Figure 2. The positive and negative polarities are represented by the red and blue contours, respectively.

ulated magnetic ﬁeld lines that are located along the in-
ternal PIL in the north of the active region are S-shaped,
indicating the presence of shear. A similar sheared fea-
ture is also present in the coronal observations (see Fig-
ure 2 (a)). While there is a good agreement between the
observations and simulations there are however some dif-
ferences. One key diﬀerence is that in the coronal emis-
sion observations the S-shaped feature appears as one
continuous structure that extends to the south of the
active region with its eastern footpoint located at the
periphery of the negative polarity. This is not the case
for the simulation as the S-shaped structure only par-
tially extends along the internal PIL and the endpoints
are ﬁxed in the center of the negative polarity sunspot.
However, care must be taken in the direct comparison
between the observed coronal loops and ﬁeld lines as the
loops may represent integrated structures along the LoS
rather than single ﬁeld lines. The simulated ﬁeld lines
that are located to the south of the S-shaped structure
have a potential conﬁguration, most likely due to using
a potential ﬁeld initial condition.

In panel (b) of Figure 7 the S-shaped ﬁeld lines have
evolved into a ﬂux rope conﬁguration at the same lo-
cation as the sheared coronal loops visible in Figure 2
(b). As found in the previous panel the simulated ﬂux

rope does not extend as far south as the sheared coronal
loops. The arcade ﬁeld lines that are situated directly
west of the simulated ﬂux rope are in good agreement
with the dark loop system present in the observations.
The rapid evolution of the magnetic ﬁeld in the sim-
ulation at this time suggests that the ﬂux rope starts
to rise and erupt between the current and previous
time steps. Signatures of the eruption in the simula-
tion include the deformation of the ﬂux rope and post-
reconnection ﬁeld lines forming below the rope. The
magnetofrictional simulation does not capture the full
dynamics of the eruption as the ﬂux rope is conﬁned in
the low corona. The ﬂux rope does not rise to the top
of the box even when open top boundary conditions are
used, suggesting that the eruption may be conﬁned. The
eruption takes place approximately 1 hour before the
ejection of the dark loop system that is seen in the 171
˚A observations. It is important to note that there are
no white-light signatures associated with the eruption.
While in the simulation the eruption occurs roughly 1
hour before that found in the observations, we note that
to drive the evolution of the coronal ﬁeld, magnetogram
data with a 96 minute cadence is used. Therefore, the
eruption occurs within the time resolution of the bound-
ary data. A more detailed comparison between the tim-

(a)(b)(c)(d)2012.03.16 23:59:57 UT2012.03.17 04:47:58 UT2012.03.19 23:59:58 UT2012.03.20 03:11:58 UT10

Simulating the coronal evolution of AR 11437

ings of the ﬂux rope eruptions in the simulation and the
observations of ejections will be discussed in the Section
5.2.1. Also, the ﬁeld lines that are located in the south
of the active region, below the ﬂux rope, are now rela-
tively similar to the loops seen in the coronal emission.
Figure 7 panel (c) shows the ﬂux rope three days after
the ﬁrst two eruptions are observed. The ﬁeld lines of
the simulated ﬂux rope have grown in length resulting in
a larger structure. This is consistent with the J-shaped
loop structure observed in Figure 2 (c). The footpoints
of the simulated ﬂux rope that are rooted in the center
of the negative polarity are shifted to the west and are
closer to the internal PIL compared to the footpoints
of the J-shaped loops in the 171 ˚A observations. The
simulated loops in the south of the active region are in
good agreement with the observations. In Figure 7 (d)
some of the footpoints of the simulated ﬂux rope are
situated further south, along the periphery of the posi-
tive polarity magnetic ﬁeld. This is consistent with the
evolution of the J-shaped emission in the observations
(Figure 2 (d)). At this time the simulated ﬂux rope is in
the process of erupting again. The eruption in the simu-
lation occurs roughly 10 hours before the third eruption
is observed (see Section 5.2).

The simulated ﬁeld lines in Figure 7 are in good agree-
ment with the 171 ˚A observations. This suggests that
by using the magnetofrictional relaxation technique of
Mackay et al. (2011) to produce a continuous time se-
ries of NLFF magnetic ﬁelds, driven by photospheric
LoS magnetograms, it is possible capture observable fea-
tures of AR 11437. This is particularly true in the north
of the active region where the formation, evolution and
eruption of the simulated ﬂux rope agrees well with the
coronal observations. However, the ﬁeld lines located in
the south of the active region deviate from the observed
coronal emission during the early phases of active region
evolution. This deviation may be due to the choice of
the initial potential condition and closed top boundary
conditions. The discrepancy between the simulation and
observations improves during the later stages of active
region evolution. The eﬀect of additional global param-
eters, the initial condition and an open top boundary on
the simulated coronal ﬁeld are explored in Section 5.2.

5.2. Parameter Study

In the simulation there are three additional terms that
can be implemented by modifying the induction equa-
tion as follows

∂A
∂t

= v × B − ηj +

B
B2 ∇ · (η4B2∇α) + H,

(8)

where α is given by

α =

B · ∇ × B
B2
The second term on the right-hand-side represents
Ohmic diﬀusion, which simply originates from the re-
sistive form of the induction equation, where η is the
resistive coeﬃcient.

(9)

.

The third term is known as hyperdiﬀusion (Boozer
1986; Strauss 1988; Bhattacharjee & Yuan 1995) and
includes the coeﬃcient of hyperdiﬀusion η4. Hyperdif-
fusion is an artiﬁcial diﬀusion that is used to smooth out
gradients present in the force-free parameter α, whilst
allowing the conservation of total magnetic helicity (van
Ballegooijen & Mackay 2007). The ﬁnal term represents
an additional injection of helicity at the photosphere.
In particular, the injection of magnetic helicity could
be due to torsional Alfv´en waves propagating into the
corona from below the surface or as a result of small-
scale vortical motions that are associated with granular
or supergranular cells (Antiochos et al. 2013). This he-
licity injection H, can be expressed through the source
term

(10)

H = −∇z(ζBz),
where ζ is the helicity injection parameter and pa-
rameterises the rate and scale of helicity injection at the
photospheric surface. Helicity injection can introduce
strongly sheared ﬁeld when horizontal motions in the
photosphere do not inject enough helicity into the coro-
nal ﬁeld. For a more detailed description and derivation
of this term refer to Mackay et al. (2014).

5.2.1. Magnetic Field Evolution

We now conduct a parameter study where the top
boundary, initial condition and non-ideal terms are var-
ied in the simulation. This is to analyse the eﬀect that
these conditions have on the coronal ﬁeld evolution de-
scribed in Section 5.1. In total, ten simulations are per-
formed (see Table 1) using either closed or open bound-
ary conditions.
If the top boundary is closed a LFF
initial condition can be used where the force-free pa-
rameter α can take a range of values between [-1.6, 1.6]
× 10−7m−1. Additional global parameters are also in-
cluded such as Ohmic diﬀusion, hyperdiﬀusion and he-
licity injection. We ﬁnd that the addition of these pa-
rameters does not signiﬁcantly aﬀect the overall coro-
nal evolution of the simulated magnetic ﬁeld. However,
when Ohmic diﬀusion is included the simulated ﬁeld has
less twist than in the other cases. When the value of
this term is increased the magnetic twist decreases fur-
ther. This is expected as by adding coronal diﬀusion into
the simulation this decreases the twist by decreasing the
amount of poloidal ﬂux.

Coronal Evolution of AR 11437

11

Table 1. Parameter Study

Simulation

Boundary &

Additional

No.

Initial Conditions

Terms

1

2

3

4

5

6

7

8

9

10

Closed

Open
Closed, α = 4.9 × 10−8

-

-

-

Closed

Closed

Closed

Closed

Closed

Closed

Closed

η = 25

η = 50

η = 100

η4 = 100

η4 = 200

ζ = −1

ζ = −10

Note—The boundary conditions,

initial conditions
and additional terms that are used to conduct the
simulations. The top boundary conditions of the
simulation can either be open or closed. Depend-
ing on the boundary conditions the simulations can
have either a potential or linear force-free initial con-
dition where the force-free parameter α is given in
units of m−1. Ohmic diﬀusion and helicity injection
are included using η and ζ, which both have units
of km2s−1, whereas, the coeﬃcient of hyperdiﬀusion
has units of km4s−1.

The comparison between the timings of the simulated
ﬂux rope eruptions to the ejections that occur in the ob-
servations is now discussed. As previously stated, there
are three eruptions that are observed to take place on
2012 March 17 at 05:09 UT, 2012 March 17 at 10:45 UT
and 2012 March 20 at 14:31 UT. The ﬁrst and second
eruptions are less than 6 hours apart making it impos-
sible for the simulation to disentangle them. Therefore,
we focus on the timings of the ﬁrst and third ejections
only. Figure 8 shows the time diﬀerence for each simu-
lation between the eruptions of the simulated ﬂux ropes
and the observed eruptions. The time diﬀerence between
the eruptions occurring in the simulations and the obser-
vations is calculated by using the central time between
the time step where the eruption has already occurred
and the previous time step where there is no sign of
eruption. Signatures of eruption in the simulation in-
clude kinked shaped ﬁeld lines and post-reconnection
loops, which form underneath the ﬁeld lines of the ﬂux
rope as it rapidly rises. This time is then compared to
the time of the eruption in the observations.

For the ﬁrst observed eruption, the ﬂux rope in seven
of the simulations erupts on 2012 March 17 at 04:00
UT. This is approximately 1 hour before the eruption
in the observations and is within the time resolution
of the photospheric boundary data. We note that when
open boundary conditions are applied at the top bound-

Figure 8. The time diﬀerence in hours between the two
ﬂux rope eruptions that occur in the ten simulations and the
eruptions seen in the 171 ˚A observations on 2012 March 17
at 05:09 UT (blue) and 2012 March 20 at 14:31 UT (green).
As the ﬂux rope eruptions occur between two time steps in
the simulation the points represent the time diﬀerence taken
between the observed eruptions and the central time between
the two time steps. The error bars represent the error in time
diﬀerence due to the resolution of the boundary data.

ary (Simulation 2) the simulated ﬂux rope erupts in the
same manner as in the closed case as it does not leave
the computational box. This again suggests that this is
a conﬁned eruption. In the three remaining simulations,
all of which use Ohmic diﬀusion, the ﬂux rope erupts at
07:12 UT, 10:24 UT and 12:00 UT, which is roughly 2,
5 and 7 hours after the eruption in the observations, re-
spectively. The latter times are due to Ohmic diﬀusion
decreasing the rate of build up of twist in the ﬂux rope.
For the third and ﬁnal eruption the ﬂux rope in eight
of the simulations erupts on 2012 March 20 at 04:00
UT, which is roughly 10 hours before the eruption in
the observations. In the ﬁnal two simulations the ﬂux
rope erupts at 00:48 UT on 2012 March 20 and 16:48
UT on 2012 March 19. This is approximately 13 and
21 hours before the observed eruption. In these simula-
tions, where the time of the ﬂux rope eruption deviates
signiﬁcantly from the other simulations, Ohmic diﬀusion
is large taking values of 50 and 100 km2 s−1, respectively.

5.2.2. Magnetic Energy

The total magnetic energy that is stored in the coro-
nal ﬁeld with time for each simulation is shown in Figure
9. The grey dotted line shows the total magnetic en-
ergy evolution of the potential ﬁeld calculated from the
same photospheric boundary conditions that are used
in simulation 1 (see Table 1), which has a closed top
boundary. The simulations and the potential ﬁeld all
start with ∼ 2 × 1030 ergs of total magnetic energy in
the system and have the same evolution throughout the
time period studied. The evolution of the total mag-
netic energy follows that of the magnetic ﬂux directly
i.e. when there is an increase or decrease in magnetic

12

Simulating the coronal evolution of AR 11437

Figure 9. The evolution of total magnetic energy as a func-
tion of time between 2012 March 16 12:46 UT and 2012
March 21 01:34 UT for the simulations in Table 1. The red
dashed line indicates when AR 11437 crosses central merid-
ian (CM). The blue dashed and green dot dashed lines rep-
resent the times of the simulated ﬂux rope eruptions (FRE)
and the eruptions in the observations (E), respectively.

Figure 10. The evolution of the free magnetic energy as
a function of time for each simulation in Table 1 calculated
between 2012 March 16 12:46 UT and 2012 March 21 01:34
UT. The red dashed line shows the central meridian (CM)
passage of AR 11437. The blue dashed and green dot dashed
lines represent the times of the simulated ﬂux rope eruptions
(FRE) and of the observed eruptions (E), respectively.

ﬂux due to emergence or cancellation the magnetic en-
ergy increases/decreases accordingly. While the energy
evolution follows a similar trend for each simulation the
total magnetic energy is systematically higher than the
potential ﬁeld. This is due to small-scale convective mo-
tions that evolve the magnetic elements at the photo-
sphere and inject energy into the corona, causing the
coronal ﬁeld to become non-potential. For the simula-
tions where Ohmic diﬀusion is incorporated the values
of total magnetic energy are consistently lower.

5.2.3. Free Magnetic Energy

We also investigate the evolution of the free magnetic

energy E, which is given by

E =

(cid:90)

1
8π

(B2 − B2

p)dτ,

(11)

where B is the magnetic ﬁeld of the NLFF ﬁeld sim-
ulation and Bp is the potential magnetic ﬁeld that is
extrapolated from the same boundary conditions as the
simulated coronal ﬁeld (Mackay et al. 2011). The evo-
lution of the free magnetic energy with time for each
simulation is shown in Figure 10.

The general evolution of the free magnetic energy will
now be discussed. A similar trend in the free magnetic
energy is seen for all ten simulations, apart from the
three simulations that include the Ohmic diﬀusion term,
where the free magnetic energy is systematically lower.
Initially, there is an increase of free magnetic energy
corresponding to the emergence of ﬂux and the counter-
clockwise rotation of the bipole. The ﬁrst simulated ﬂux
rope eruption occurs during this period. On 2012 March
18 at 11:12 UT the free magnetic energy reaches a max-
imum value of ∼ 1.8 × 1030 ergs and remains roughly

constant until 2012 March 20. This mostly corresponds
to the decay phase of the AR when ﬂux cancellation is
taking place and the AR rotates clockwise. The free
magnetic energy then starts to decrease and the erup-
tion of the second simulated ﬂux rope occurs. At the
end of the evolution a small increase in magnetic ﬂux
occurs due to the emergence of a small bipole and the
AR rotates counter-clockwise. This results in the small
and ﬁnal increase in the free magnetic energy.

The timings of the simulated ﬂux rope eruptions coin-
cide with changes in the evolution of the free magnetic
energy. Around the time of the ﬁrst simulated ﬂux rope
eruption the free magnetic energy is increasing. The
rate at which the free magnetic energy increases slows
after the ﬁrst eruption has occurred. Similarly, the free
magnetic energy starts to decrease prior to the eruption
of the second simulated ﬂux rope. This variation is more
apparent in the rate of change of free magnetic energy,
which is shown in Figure 11. The rate of change of the
free magnetic energy decreases by 9.2 × 1024 erg s−1
and 1.5 × 1025 ergs s−1 around the times of the ﬁrst
and second simulated ﬂux rope eruptions, respectively.
The decrease in the rate of change of free magnetic en-
ergy around the timings of the eruption is small due to
the evolution of the applied boundary and the continual
injection of a Poynting ﬂux at the base of the computa-
tional box.

5.2.4. Relative Helicity

Small-scale random motions at the photospheric sur-
face inject magnetic helicity along with free magnetic
energy into the coronal magnetic ﬁeld. Magnetic helic-
ity is a topological measure of the twist and linkage of
magnetic ﬁeld lines and is approximately conserved dur-

Coronal Evolution of AR 11437

13

The relative helicity in each simulation shows a sim-
ilar evolutionary behaviour throughout the time period
studied. At the beginning of the evolution the relative
helicity for the majority of the simulations initially in-
creases to ∼ 2.3×1039 Mx2 as positive helicity is injected
into the corona. For the case where the force-free pa-
rameter α = 4.9 × 10−8 m−1 the initial relative helicity
is ∼ 3.5 × 1039 Mx2 due to the LFF ﬁeld initial condi-
tion. While the value is initially higher it follows the
same trend as the other simulations. By introducing an
additional injection of helicity, particularly in the case
ζ = 10 km2 s−1, the helicity increases as expected. For
the majority of the simulations the helicity is positive
during the ﬁrst half of the evolution, which follows the
hemispheric rule of positive helicity being dominant in
the southern hemisphere Pevtsov et al. (1995). How-
ever, once the active region crosses central meridian the
helicity sign is negative. The evolution of helicity is
very similar to that of the tilt angle suggesting that the
dominant source of helicity injection is the large scale
rotation of the active region.

6. SUMMARY & DISCUSSION

In this study, we have simulated the coronal evolution
of AR 11437 during its entire lifetime, from emergence
to decay (2012 March 16 12:46 UT to 2012 March 21
01:34 UT). The coronal ﬁeld has been simulated using
the magnetofrictional relaxation technique of Mackay et
al. (2011) with SDO/HMI LoS magnetograms as lower
boundary conditions. By applying this method it was
possible to replicate the main coronal features and evolu-
tion of the active region. Observations from SDO/AIA
show that the coronal ﬁeld of the active region becomes
sheared and three eruptions occur, two take place in
the emergence phase and one in the decay phase. The
simulation was able to reproduce the sheared coronal
structure and two out of the three observed eruptions.
We also conducted a parameter study to include global
parameters such as Ohmic diﬀusion, hyperdiﬀusion and
helicity injection in the simulation. The addition of
these terms in the simulations does not eﬀect the over-
all coronal evolution. Therefore, the magnetofrictional
relaxation technique of Mackay et al. (2011) using LoS
magnetograms as lower boundary conditions is very ef-
fective in simulating the coronal evolution of AR 11437
and its eruptions.

The technique was particularly successful in capturing
the formation and evolution of a sheared coronal struc-
ture present in the observations. In the simulation a ﬂux
rope forms in the north of the active region at the same
location as the sheared coronal structure. In the early
stages of the coronal evolution there are some discrepan-

Figure 11. The rate of change of free magnetic energy as a
function of time for closed boundary conditions (simulation 1
in Table 1) between 2012 March 16 12:46 UT and 2012 March
21 01:34 UT. The red dashed line indicates when AR 11437
crosses central meridian (CM). The blue dashed and green
dot dashed lines represent the timings of the simulated ﬂux
rope eruptions (FRE) and the eruptions in the observations
(E), respectively.

Figure 12. Relative helicity evolution as a function of
time between 2012 March 16 12:46 UT and 2012 March 21
01:34 UT. The red dashed line indicates when AR 11437
crosses central meridian (CM). The blue dashed and green
dot dashed lines represent the timings of the simulated ﬂux
rope eruptions (FRE) and the eruptions in the observations
(E), respectively.

ing the process of magnetic reconnection (Berger 1999).
To study the injection and evolution of helicity in the
simulations the relative helicity HR is calculated as fol-
lows

(cid:90)

HR =

(cid:90)

(A · B)dτ −

(Ap · Bp)dτ,

(12)

where A is the magnetic vector potential and B is
the magnetic ﬂux density of the simulation (see Mackay
et al. 2011). The vector potential and magnetic ﬂux
density of the potential ﬁeld with the same normal ﬁeld
component and boundary conditions is given by Ap and
Bp, respectively. The evolution of the relative helicity
of the simulations is shown in Figure 12.

14

Simulating the coronal evolution of AR 11437

cies between the simulated ﬁeld and coronal observations
in the south of the AR. The simulated ﬂux rope struc-
ture does not extend as far south as the coronal loops.
The deviation between the observations and simulation
decreases with time and both are in good agreement dur-
ing the later stages of evolution. This variation is most
likely caused by the potential ﬁeld initial condition of
the simulation. These ﬁndings are very similar to that
of Gibb et al. (2014), where the simulated ﬁeld captures
the formation and evolution of an active region sigmoid.
During the emergence phase, AR 11437 rotates
counter-clockwise and a dark loop system that is lo-
cated to the west of the active region erupts on 2012
March 17 at 05:09 UT. The simulated ﬂux rope at this
location starts to rise and is found to erupt roughly 1
hour before the ejection of the dark loop system in the
observations. As the dark loop system is located directly
next to the ﬂux rope in the simulation it could therefore
be a part of this pre-eruptive structure. Signatures of
eruption include the formation of kinked ﬁeld lines and
post-reconnection loops below the simulated ﬂux rope
as it rises. The evolution of the coronal ﬁeld is driven
with LoS magnetograms that have a cadence of 96 min-
utes and therefore, the eruption occurs within the time
resolution of the data.
In the observations there are
no white-light signatures associated with this eruption
and when the simulated ﬂux rope erupts it does not rise
to the upper section nor leave the computational box
even when open top boundary conditions are applied.
In the AIA 171 ˚A observations there is an expansion
of coronal loops and a small brightening. This suggests
that the observed eruption could be conﬁned or that
only a partial eruption of the sheared structure occurs.
A ﬁlament then forms and erupts on 2012 March 17 at
10:45 UT. The second eruption is not captured in the
simulations as it occurs only 3 time steps (6 hours) after
the previous eruption making it hard to distinguish.

As the active region enters its decay phase ﬂux can-
cellation occurs at the internal PIL. Approximately 1.3
×1020 Mx of magnetic ﬂux cancels during a time pe-
riod of 1.5 days. This amounts to 27 % of the peak
active region ﬂux being cancelled. The amount of ﬂux
cancelled is very similar to that found in Yardley et al.
(2017) despite the diﬀerence in methods used to cal-
culate the magnetic ﬂux. This is also consistent with
previous studies such as (Green et al. 2011; Baker et al.
2012; Yardley et al. 2016). The active region also rotates
clockwise during this period. In the simulations the ﬂux
rope, which formed along the internal PIL, has expanded
and grown in length, resulting in a larger structure that
is consistent with the J-shaped structure in the coronal
observations. The expansion and growth of the sim-

ulated ﬂux rope provides additional evidence that the
ﬁrst eruption was likely to be conﬁned. The large ﬂux
rope structure forms during the decay phase of the ac-
tive region evolution suggesting that the process of ﬂux
cancellation and associated reconnection at the internal
PIL was responsible. Hence, the evolutionary sequence
of this structure is consistent with the model of van Bal-
legooijen & Martens (1989). The ﬁnal eruption of the
simulated ﬂux rope structure occurs roughly 10 hours
before the eruption of the observed J-shaped coronal
structure. Furthermore, the ﬂux rope rises once again
but does not leave the computational box.

When varying the boundary and initial conditions and
including additional parameters such as Ohmic diﬀu-
sion, hyperdiﬀusion and helicity injection in the simula-
tions, the evolution of the coronal ﬁeld does not change
considerably. This suggests that a key element in re-
producing the main evolutionary features of the active
region is using the normal component of the magnetic
ﬁeld from LoS magnetograms to drive the simulations.
However, when including Ohmic diﬀusion the simulated
ﬁeld has less twist than the other cases. This is expected
as Ohmic diﬀusion acts to decrease poloidal ﬂux in the
simulation and therefore decreases the twist of the sim-
ulated ﬁeld.

For the majority of the simulations conducted the ﬂux
rope erupts roughly 1 and 10 hours before the ﬁrst and
third eruptions in the observations, respectively. The in-
clusion and increased values of the Ohmic diﬀusion term
causes the timings of the eruptions of the simulated ﬂux
rope to diﬀer to the other cases. When Ohmic diﬀusion
takes values of 25, 50 and 100 km2 s−1 the simulated
ﬂux rope erupts roughly 2, 5 and 7 hours after the ﬁrst
observed eruption, respectively. This is due to the fact
that the ﬂux rope structure is less twisted than in the
other cases. For the ﬁnal eruption, the simulated ﬂux
rope erupts roughly 13 and 21 hours before the observed
eruption for η values of 50 and 100 km2 s−1. At this
point in the simulation the ﬂux rope twist is still small
but the rope is more inﬂated compared to the other sim-
ulations. The early eruption of the ﬂux rope is due to
the eruption taking place during the later stages of the
simulation. This allows a continual build-up of stress
to occur over a longer period as the simulation fails to
capture the second observed eruption. When Ohmic dif-
fusion is included the overlying ﬁeld remains more po-
tential, the restoring forces acting on the ﬂux rope are
weaker, and as a result, the eruption occurs even earlier
in the simulation.

The free magnetic energy was calculated as a func-
tion of time and in all ten simulations followed the same
evolutionary trend. Although, the values of free mag-

Coronal Evolution of AR 11437

15

netic energy were systematically lower for the simula-
tions that included Ohmic diﬀusion. Initially, the free
magnetic energy increases due to ﬂux emergence. The
rate of change of free magnetic energy is seen to decrease
by 9.2 × 1024 erg s−1 but remains positive after the ﬁrst
simulated eruption. The free magnetic energy continues
to increase after the emergence phase. This is due to
the injection of energy through small-scale convective
motions which inject a Poynting ﬂux into the corona
(Mackay et al. 2011). Finally, during the ﬁnal eruption
the rate of change of free magnetic energy decreases by
-1.5 × 1025 erg s−1 as the energy overall decreases.

We also study the injection and evolution of the rel-
ative helicity with time for each simulation. As for
the free magnetic energy, the relative helicity shows the
same trend in all ten simulations apart from in two cases
that have consistently higher values of helicity. Firstly,
in the case where a LFF ﬁeld initial condition is used and
the force-free parameter α is 4.9 × 10−8 m−1. Secondly,
when there is a large helicity injection of 10 km2 s−1.
The helicity is initially increasing and positive, which
agrees with the hemispheric rule that states positive he-
licity dominates in the southern hemisphere (Pevtsov et
al. 1995). The helicity then decreases and as the ac-
tive region crosses central meridian becomes negative.
This is because the active region rotates clockwise and
the evolution of helicity follows the same trend as the
evolution of the active region tilt angle. This suggests
that active region rotation is a large source of helicity
injection in the corona (Gibb et al. 2014).

In this study, we have used the magnetofrictional tech-
nique of Mackay et al. (2011) to successfully simulate
the coronal evolution of AR 11437 along with two out
of three observed eruptions from the active region. This
technique uses a time series of SDO/HMI LoS magne-
tograms as lower boundary conditions. When including
additional global parameters such as Ohmic diﬀusion,
hyperdiﬀusion and an injection of helicity the overall
coronal evolution of the simulated ﬁeld and eruption
times did not change signiﬁcantly. This shows that the
technique of Mackay et al. (2011) only requires the nor-
mal component of the magnetic ﬁeld from LoS mag-
netograms as lower boundary conditions to successfully
reproduce the coronal evolution and the build-up to the
eruption of an active region.

The authors would like to thank SDO/HMI and AIA
consortia for the data, and also being able to browse
data through JHelioviewer (http://jhelioviewer.org/).
This research has made use of SunPy, an open-source
and free community-developed solar data analysis pack-
age written in Python (SunPy Community et al. 2015).
S.L.Y. would like to acknowledge STFC for support via
the Consolidated Grant SMC1/YST025. D.H.M. would
like to thank STFC and the Levehulme Trust for ﬁnan-
cial support. L.M.G. is grateful to the Royal Society for
a University Research Fellowship and the Leverhulme
Trust.

APPENDIX

A. MAGNETOGRAM CLEAN-UP PROCESS

This study used magnetograms taken from the 720s data series made available by the Helioseismic and Magnetic
Imager (HMI) on board the Solar Dynamics Observatory (SDO). The full-disk LoS magnetograms are computed from
ﬁltergrams, which are recorded by the vector camera, have a pixel size of 0.5” and a noise level of 10 G. In total, 62
magnetograms are used with a 96 minute cadence during the time period beginning 2012 March 16 12:46 UT until 2012
March 21 01:34 UT. A cosine correction is applied to the magnetic ﬁeld values to estimate the radial component of the
magnetic ﬁeld. Each magnetogram, which contains the corrected radialised ﬁeld values, is de-rotated to account for
area foreshortening eﬀects at large centre-to-limb angles. Cut-out images are taken from the corrected and de-rotated
magnetograms centred on the AR with a size of 278 × 279 pixels.

The cleaning procedure that will now be described is very similar to that in Gibb et al. (2014). It is apparant in
Figures 1 and 3 that the noise level is high in the raw magnetograms. This is particularly evident in the magnetograms
taken during the early and late phase of the active region evolution when the distance from central meridian is large.
To be able to use the magnetograms as boundary conditions in the simulation several clean-up procedures were applied.
Firstly, time-averaging is applied to the magnetograms using a Gaussian kernel as follows

Ci =

(cid:80)62

j=1 exp(−[i − j]/τ )2Fj
(cid:80)62
j=1 exp(−[i − j]/τ )2

,

(A1)

where Ci represents the ith cleaned frame and ranges from 1 to 62, Fj is the jth raw frame, and τ is the separation
of frames where the weighting falls by 1/e. In this case we set the separation to be two frames so τ = 2. Therefore,

16

Simulating the coronal evolution of AR 11437

each of the cleaned frames is a linear combination of the 62 raw frames however, the two frames previous and after
the current frame have the highest weighting. This procedure is used to retain large scale active region features and
remove random noise.

Figure 13. The raw and cleaned magnetograms for frame 15 of the simulation taken on 2012 March 17 at 15:59 UT when AR
11437 is at peak unsigned magnetic ﬂux. The saturation levels of the magnetic ﬁeld for both magnetograms is set to ±100 G.
The ﬂux-weighted central coordinates for the positive (negative) polarity is represented by the red (green) asterisk.

In this study we are only interested in analysing the evolution of the large scale magnetic ﬁeld of the active region
and not small-scale features such as network elements or quiet Sun magnetic ﬁeld. Therefore, small-scale isolated
magnetic features are removed pixel-by-pixel by considering the eight nearest neighbours of each pixel. If less than
four of the nearest neighbours had the same sign of magnetic ﬂux then the ﬂux value of that pixel would be set to
zero. This means that as the pixels at the edges of the magnetograms had less than eight neighbouring pixels their
values were also set to zero. Additionally, the pixels that had magnetic ﬂux values that were below the threshold of
25 Mx cm−2 were assigned a value of zero as these pixels form part of the quiet Sun background magnetic ﬁeld.

The ﬁnal clean-up procedure was applied to ensure that the magnetograms were ﬂux balanced. This procedure
is required if the top boundary conditions of the simulation are closed. The magnetograms were ﬂux balanced by
calculating the signed magnetic ﬂux of each frame. For each frame the pixels of non-zero value were counted and the
signed magnetic ﬂux was divided by this total. The imbalanced magnetic ﬂux per non-zero valued pixel was subtracted
from every pixel of non-zero value. No pixels changed sign during the procedure of ﬂux balancing as the maximum
correction was less than the threshold of 25 Mx cm−2. This was the threshold used to set the value of pixels that
formed part of the background ﬁeld to zero.

Figure 13 shows the raw and cleaned magnetograms taken at the time of the peak unsigned magnetic ﬂux of AR
11437 (2012 March 17 at 15:59 UT). The ﬁgure shows that the large scale magnetic features of the active region in
the raw magnetogram are still present in the cleaned magnetogram but the small-scale magnetic features and noise
has been removed.

Several clean-up procedures have been applied including time-averaging, isolated feature removal, low ﬂux value
removal, and ﬂux balancing to produce a series of cleaned magnetograms that show a smooth, continuous photospheric
ﬁeld evolution. Using these magnetograms as photospheric boundary conditions makes it easier to simulate the
evolution of the coronal magnetic ﬁeld as random noise and small-scale magnetic features can cause numerical problems
in the magnetofrictional simulation.

To determine the tilt angle of an AR the centers of ﬂux for the positive and negative polarity must be calculated as

a function of time using

B. TILT ANGLE CALCULATION

Coronal Evolution of AR 11437

(cid:18)(cid:90)

r± =

(cid:19) (cid:18)(cid:90)

rB±dA

(cid:19)

B±dA

,

17

(B2)

where r is a position vector, ± represents the positive and negative polarity ﬂux, and A is the area. The angle θ can

then be calculated by

where the x, y subscripts are the x and y components of r±, respectively. This follows the method outlined in Gibb
et al. (2014) however, we take the tilt angle to be 180 − θ in this case following a similar deﬁnition to Tian et al. (2001).

θ = arctan

(cid:18) (r− − r+)y
(r− − r+)x

(cid:19)

,

(B3)

REFERENCES

Antiochos, S. K., DeVore, C. R., & Klimchuk, J. A. 1999,

Mackay, D. H. & van Ballegooijen, A. A. 2006a, ApJ, 641,

ApJ, 510 485

577

Antiochos, S. K. 2013, ApJ, 772, 72
Baker, D., van Driel-Gesztelyi, L. & Green, L. M. 2012,

SoPh, 276, 219

Berger, M. A. 1999, Plasma Phys. Control. Fusion, 41, B167
Bhattacharjee, A., & Yuan, Y. 1995, ApJ, 449, 739
Bobra, M. G., van Ballegooijen, A. A., & and DeLuca,

E. E. 2008, ApJ, 672, 1209

Boozer, A. H. 1986, J. Plasma Phys., 35, 133
Canou, A., & Amari, T. 2010, ApJ, 715, 1566
Couvidat, S., Schou, J., Hoeksema, J. T., et al. 2016, SoPh,

291, 1887

Mackay, D. H. & van Ballegooijen, A. A. 2006b, ApJ, 642,

1193

Mackay, D. H. & van Ballegooijen, A. A. 2009, SoPh, 260,

321

Mackay, D. H., Green, L. M., & van Ballegooijen, A. A.

2011, ApJ, 729, 97

Mackay, D. H., DeVore, C. R. & Antiochos, S. K. 2014,

ApJ, 784, 164

Moore, R. L., Sterling, A. C., Hudson, H. S., & Lemen,

J. R. 2001, ApJ, 552, 833

Patsourakos, S., Vourlidas, A., & Stenborg, G. 2013, ApJ,

Finn, J. M., Guzdar, P. N., & Usikov, D. 1994, ApJ, 427,

764, 125

475

Forbes, T. G., & Isenberg, P. A. 1991, ApJ, 373, 294
Forbes, T. G. 2000, J. Geophys. Res., 105, 23153
Gibb, G. P. S., Mackay, D. H., Green, L. M. et al. 2014,

ApJ, 782, 71

Green, L. M., D´emoulin, P., Mandrini, C. H., et al. 2003,

SoPh, 215, 307

Green, L. M., & Kliem, B. 2009, ApJL, 700, L83
Green, L. M., Kliem, B., & Wallace, A. J. 2011, A&A, 526,

A2

Jiang, C., Wu, S. T., Feng, X., & Hu, Q. 2014, ApJL, 786,

L16

Kliem, B., & T¨or¨ok, T. 2006, Phys. Rev. Lett., 96, 255002
Kuperus, M., & Raadu, M. A. 1974, A&A, 31, 189
Lemen, J. R., Title, A. M., Akin, D. J., et al. 2012, SoPh,

275, 17

Longbottom, A. 1998, in ASP Conf. Ser. 150, IAU Colloq.
167: New Perspectives on Solar Prominences, ed. D. F.
Webb, B. Schmieder, & D. M. Rust (San Francisco, CA:
ASP), 274

Mackay, D. H., & Gaizauskas, V. 2003, SoPh, 216, 121
Mackay, D. H. & van Ballegooijen, A. A. 2005, ApJL, 621,

L77

Pesnell, W. D., Thompson, B. J., & Chamberlin, P. C.

2012, SoPh, 275, 3

Pevtsov, A. A., Canﬁeld, R. C., & Metcalf, T. R. 1995,

ApJL, 440, L109

R´egnier, S., Amari, T., & Kersal´e, E. 2002, A&A, 392, 1119

Savcheva, A., Pariat, E., van Ballegooijen, A., Aulanier, G.,

& and DeLuca, E. 2012, ApJ, 750, 15

Schou, J., Scherrer, P. H., Bush, R. I., et al. 2012, SoPh,

275, 229

Schrijver, C. J., De Rosa, M. L., & Metcalf, T. R. et al.

2006, SoPh, 235, 161

Strauss, H. R. 1988, ApJ, 326, 412

Su, Y., van Ballegooijen, A., Lites, B. W. et al. 2009, ApJ,

691, 105

SunPy Community, Mumford, S. J., & Christe, S. et al.
2015, Computational Science & Discovery, 8, 014009

Syntelis, P., Archontis, V., & Tsinganos, K. 2017, ApJ, 850,

95

Tian, L., Bao, S., Zhang, H., & Wang, H. 2011, A&A, 374,

294

T¨or¨ok, T., & Kliem, B. 2005, ApJL, 630, L97

Valori, G., Kliem, B., & Keppens, R. 2005, A&A, 433, 335

18

Simulating the coronal evolution of AR 11437

van Ballegooijen, A. A., & Martens, P. C. H. 1989, ApJ,

Yardley, S. L. et al. 2017, ApJ, submitted

343, 971

van Ballegooijen, A. A., Priest, E. R., & Mackay, D. H.

Yardley, S. L., Green, L. M., & Williams, D. R. 2016, ApJ,

2000, 539, 983

827, 151

Mackay, D. H., & van Ballegooijen, A. A. 2006, ApJ, 641,

577

Yeates, A. R., Mackay, D. H., & van Ballegooijen, A. A.

van Ballegooijen, A. A., & Mackay, D. H. 2007, ApJ, 659,

2007, SoPh, 245, 87

1713

Yang, W. H., Sturrock, P. A., & Antiochos, S. K. 1986,

ApJ, 309, 383

Yeates, A. R. 2017, ApJ, 836, 131

