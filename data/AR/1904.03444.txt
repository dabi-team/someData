Bus Travel Time Prediction: A log-normal Auto-Regressive
(AR) Modeling Approach

B. Dhivyabharathi1 B. Anil Kumar2, Avinash Achar3, Lelitha Vanajakshi4*

ABSTRACT

Providing real-time arrival time information of the transit buses has become inevitable in ur-
ban areas to improve the efﬁciency of the public transportation system. However, accurate
prediction of arrival time of buses is still a challenging problem in dynamically varying trafﬁc
conditions especially under heterogeneous trafﬁc condition without lane discipline. One broad
approach researchers have adopted over the years is to divide the entire bus route into sections
and model the correlations of section travel times either spatially or temporally. The proposed
study adopts this approach of working with section travel times and developed two predictive
modelling methodologies namely (a) classical time-series approach employing a seasonal AR
model with possible integrating non-stationary effects and (b) linear non-stationary AR ap-
proach, a novel technique to exploit the notion of partial correlation for learning from data to
exploit the temporal correlations in the bus travel time data. Many of the reported studies did
not explore the distribution of travel time data and incorporated their effects into the modelling
process while implementing time series approach. The present study conducted a detailed anal-
ysis of the marginal distributions of the data from Indian conditions (that we use for testing in
this paper). This revealed a predominantly log-normal behaviour which was incorporated into
the above proposed predictive models. Towards a complete solution, the study also proposes
a multi-section ahead travel time prediction algorithm based on the above proposed classes
of temporal models learnt at each section to facilitate real time implementation. Finally, the
predicted travel time values were corroborated with the actual travel time values. From the re-
sults, it was found that the proposed method was able to perform better than historical average,
exponential smoothing, ARIMA, and ANN methods and the methods that considered either
temporal or spatial variations alone.

Keywords: Travel time prediction, time-series analysis, partial correlation, non-stationary, log-
normal distribution, multi-section ahead prediction.

1Doctoral Student, Department of Civil Engineering, Indian Institute of Technology Madras, Chennai, INDIA

600036, E-mail: gebharathi@gmail.com

2Senior Project Ofﬁcer, Department of Civil Engineering, Indian Institute of Technology Madras, Chennai,

INDIA 600036, E-mail: raghava547@gmail.com

3Research Scientist, TCS Innovation Labs, Chennai, INDIA 600113, E-mail: achar.avinash@tcs.com
4*Corresponding Author, Professor, Department of Civil Engineering, Indian Institute of Technology Madras,

Chennai, INDIA 600036, E-mail: lelitha@iitm.ac.in

9
1
0
2

r
p
A
6

]
P
A

.
t
a
t
s
[

1
v
4
4
4
3
0
.
4
0
9
1
:
v
i
X
r
a

1

 
 
 
 
 
 
1

INTRODUCTION

Real-time bus arrival information is highly sought-after information in recent years to enhance
the efﬁciency and competitiveness of public transport [1]. However, uncertainties in arrival time
are quite common in public transit due to dynamic trafﬁc conditions, particularly for highly
varying heterogeneous trafﬁc condition, contributed by various factors such as lack of lane
discipline, ﬂuctuating travel demand, incidents, signal timing and delay, bus stop dwell times,
seasonal and cyclic variations, etc. In countries such as India in particular, public transport
buses scarcely stick to any predeﬁned schedule while bus commuters hardly have any real-time
information of the likely arrival time of the bus they are expecting. Given the lack of this crucial
real-time information, commuters may end up taking private vehicles to reach their respective
destinations. This may lead to reduction in modal share of public transport and increase in
composition of private vehicles contributing towards the raise in congestion and other related
negative impacts. Hence, prediction of travel/arrival time and informing the same to passengers
is inevitable to make public transport more attractive, efﬁcient, and competitive especially in
urban areas. Such real-time information can also be used to assist commuters in making better
trip-related decisions ahead of the journey, which signiﬁcantly reduces anxiety levels while
waiting for a bus [2, 3, 4]. Thus, it is evident that the negative impacts associated with lack of
reliability of the existing public transportation system can be reduced to an extent by predicting
accurate arrival time of buses and communicating it to the passengers in advance.

The travel time prediction methodologies can be broadly grouped into data driven and traf-
ﬁc ﬂow theory based methods. With the advent and implementation of diverse modern sensing
technologies that generate large amount of data, data-driven techniques are getting more pop-
ularity. For example, these days, many urban public transportation systems deploy Automated
Vehicle Location (AVL) systems like Global Positioning System (GPS) to monitor the position
of buses in real time, which can provide a constantly growing database of location and tim-
ing details [5]. Such data can rightly be used for developing a Bus Arrival Time Prediction
(BATP) system , as the collected data inherently capture the nature and patterns of trafﬁc in
real time. Many researchers have explored the modelling and prediction of bus travel time,
but only a few studies have considered exploiting the temporal correlations in the AVL data
systematically while also taking into consideration the statistical distributions followed by the
travel time data. This work tries to bridge this gap in existing literature appropriately using
linear statistical models.

The dynamic bus travel time prediction problem considered in this paper is to accurately
predict the travel times at sections ahead from the current position of the bus as the trip is in
progress in real time. To achieve this, exploiting the information of the travel times experienced
by the previous buses in the subsequent sections is a promising choice. This means utilizing
the temporal dependencies in the spatio-temporal AVL data of all the buses. Hence, the travel
times experienced at different time intervals of the day at a particular section were chosen as

2

observations of our time series or univariate sequential data. A statistical sequential predic-
tive model using a novel linear, non-stationary approach that performs learning exploiting the
notion of partial correlation is developed. This study also proposes a time-series approach em-
ploying a seasonal AR model with possible integrating non-stationary effects for the prediction
of bus travel time. Both the temporal predictive modelling approaches predict ahead in time
at each segment independently. To appropriately and correctly utilize these temporal predic-
tions available at each section, the present study additionally formulated a multi sections ahead
prediction framework to facilitate real time implementation of the developed BATP system.

The present study also carried out a detailed analysis of the marginal distributions of the
travel time data collected from typical Indian conditions (that we use for testing in this paper)
which revealed a predominantly log-normal behaviour. The lognormal nature of the data is
incorporated into both the above predictive models and statistically optimal prediction schemes
in the lognormal sense are utilized for all predictions. Our experiments clearly revealed superior
predictions in favor of prediction models which explicitly utilized the lognormal nature of the
data.

2 Literature Review

Various studies have been reported on prediction of travel times and the methods used can be
broadly classiﬁed into trafﬁc ﬂow-theory based and data-driven methods.

Trafﬁc ﬂow theory based methods establish a mathematical relationship between appro-
priate variables that tries to capture the system characteristics. Such methods develop models
based on trafﬁc ﬂow theory, which is mostly based on the ﬁrst principles of physics. Such
theory-based approaches usually focus on recreating the trafﬁc conditions in the future time
intervals and then deriving travel times from the predicted trafﬁc state [6]. Such theory based
models can be classiﬁed as a) Macroscopic, b) Microscopic, and c) Mesoscopic, based on
the level of detail it captures [7, 8, 9, 10]. Majority of the studies under this category used
the conservation of vehicle principle to predict travel time under homogenous trafﬁc condition
[11, 6] and a few studies developed simulation approaches [12], dynamic trafﬁc assignment
based methods [13] for the same. However, all of the above studies predicted travel times from
ﬂow/speed measurements under homogenous trafﬁc conditions. It is very standard to use a
suitable estimation/prediction tool to predict the trafﬁc state variables recursively in real time,
when model based methods are implemented. Most of the studies for travel time prediction
used Kalman Filtering Technique (KFT) as the estimation tool [14, 15, 16, 17, 18, 19]. A few
studies have explored some non-linear estimation tools such as Particle Filtering, Extended
Kalman Filtering, Unscented Kalman Filtering, etc. for the purpose of travel time prediction
[7, 20]. Due to the non-linearity, complexity, and uncertainty of contributing factors of the
trafﬁc conditions, trafﬁc ﬂow theory based methods needs highly complex and sophisticated
models and recursive techniques to capture the system dynamics under high variation condi-

3

tion.

Data driven approaches use larger databases to develop statistical/empirical relations to
predict the future travel time without really representing the physical behavior of the modelled
system [21]. In a way, these methods exploit the available data to extract the system charac-
teristics. Various data driven approaches reported in the literature include historical averaging
methods, empirical methods, statistical methods, and machine learning methods.

Historic averaging methods [22, 23] predict the current and future travel time by averaging
the historical travel time of previous journeys. These methods assume that trafﬁc patterns are
cyclical and the projection ratio (the ratio of the historical travel time in a particular link to the
current travel time) will remain constant. Hence, historic averaging methods are not suitable
for highly varying trafﬁc conditions, where travel times experience large variations.

Empirical models are based on intuitive empirical relation or mathematical concepts. A few
studies [24, 25, 26, 27, 28, 29, 30] have explored and showed the superiority of the empirical
model combined with recursive ﬁltering over the other methodologies. However, the efﬁciency
of the method is highly dependent on the presumed relationship or assumptions.

Machine learning techniques such as Artiﬁcial Neural Network (ANN) and Support Vector
Machine (SVM) are some of the most commonly reported prediction techniques for travel
time prediction because of their ability to solve complex relationships [31, 32]. A few studies
[24, 33, 34, 35] combined the machine learning techniques such as SVM, ANN with ﬁltering
algorithms such as Kalman Filtering to predict travel time. [36] and [37] have compared the
performance of ANN and SVM and reported that SVM outperforms ANN in the prediction of
arrival times and also it was reported that SVM is not susceptible to the over ﬁtting problem
unlike traditional ANN, as it could be trained through a linear optimization process. Many
studies [33, 36, 38, 39, 40] have reported better performance of machine learning techniques
compared to other existing methods. However, machine learning techniques require a large
amount of data for training and calibration, and are computationally expensive, restricting their
usage for wide real time applications.

Statistical methods such as regression and time series predicts the future values by devel-
oping relationship among the variables affecting travel time or from the series of data points
listed in time order. A few studies have implemented regression methods [41, 42, 43, 44, 45,
46, 47, 48, 49, 50] for arrival time prediction. [51] integrated regression methods with adaptive
algorithms to make it suitable for real time implementations. However, the accuracy of the pre-
diction using this approach highly depends on identifying and applying suitable independent
variables. This requirement limits the applicability of the regression model to the transportation
areas as variables in transportation systems are highly inter-correlated [52]. However, the effect
of multicollinearity can be reduced by two approaches – by calculating the value of Variance
Inﬂation Factor (VIF), or use robust regression analysis instead of ordinary least squares regres-
sion, such as ridge regression [53], lasso regression [54], and principal component regression
[55]. Statistical learning regression methods such as regression tree [56], bagging regression

4

[57], and random forest regression [54] are also used.

Time series models (or data-driven approaches in general) are based on the assumption that
the current and future patterns in data largely follow patterns similar to historically observed
[58] stated that this method greatly depends on historic data to develop relations for
data.
forecasting future time variations. Travel time prediction domain has seen numerous time
series works with various modelling strategies and techniques. Earlier studies [59, 60, 61,
62, 63] estimated travel time from other trafﬁc ﬂow variables such as trafﬁc volume, speed, and
occupancy collected from location-based sensors such as loop detectors and implementations
reported were mainly on freeways.

Literature has also seen time series appraoches for travel time prediction by modelling
several other related variables such as delays [64], headways [65], dwell time [66], running
speed [67], etc. Only a few studies modelled the travel time observations directly for a BATP
problem. In addition, most of those studies considered either entire trip travel time [68] or bus
stop to bus stop travel time [64], which eventually may not capture the variations in travel time,
if the considered stretch is very long. The present study adopted an effective way of segmenting
the entire route into smaller sections of uniform length. The time-series observations in the
proposed method are different from all these existing time series approaches for analysing bus
travel time data. At each section, the travel times experienced at different times of the day are
modelled as a separate time series. Hence, the proposed approach can potentially capture the
variations in travel time better than earlier methods.

In a trafﬁc system, the travel times also exhibit patterns which are mostly cyclical with
variations in magnitude depending on the spatial and geometric features of the location. For
example, presence of a signal at a particular location mostly results in higher travel times and
therefore, this trend/pattern would clearly reﬂect in the historical travel time data. Hence,
the present study adopted a time series (or sequential modelling) framework on travel time
observations at different times of the day for bus arrival time prediction. For each section, the
proposed methodology models the temporal correlations between travel times experienced at
different times of the day. These temporal correlations are learnt using two approaches: (i)
based on a novel application of the notion of partial correlation and (ii) using a seasonal AR
time-series approach.

Studies under Heterogeneous Trafﬁc Conditions: A few methodologies were developed to
predict bus travel time under heterogeneous lane-less trafﬁc condition and are discussed here
[45, 17, 18]. Majority of the above studies used a space discretization approach to predict bus
arrival times [17, 69]. Here, the route was spatially discretized into smaller sections and hy-
pothesized a relation in travel time between neighbouring sections, i.e., the travel time of a bus
in a particular section can be predicted using the travel time of the same bus in the previous
section. This was adopted mainly due to the lack of availability of a good historic data base.
[18] extended the work by separating dwell times and running time from total travel time and

5

modelled their characteristics independently. They found that considering dwell times does not
bring a signiﬁcant improvement in overall prediction accuracy. However, such a method may
not be able to capture correlations meaningfully in all scenarios. For example, the travel times
in neighbouring sections may not be dependent on each other if one had a signal and the other
is not inﬂuenced by that signal. In such cases, prior travel time information from the same
section may be a better input for prediction than the neighbouring section’s travel time. [19]
hypothesized a relation based on temporal evolution of travel time and [10] developed a model
based approach to explore the spatio-temporal evolutions in travel time. Irrespctive of the mod-
elling nature, the aforementioned studies neither analysed nor incorporated the distributional
aspects of travel time into predictive modelling. The current study incorporates this feature
into the predictive model by exploiting the predominantly lognormal nature of the data before
exploring two sequential modelling approaches to model travel time evolutions across the day
to predict bus arrival times.

This paper is organized as follows. First, the details of study site and data processing
are presented. Next, the section on data analysis discusses the various analysis conducted
to assess the characteristics and variations of travel time. This is followed by methodology
section that explains the travel time prediction schemes developed to incorporate the identiﬁed
characteristics of the data using the concepts of time series analysis. Results section is presented
next discussing the evaluation of the proposed approaches using real-world data. Finally, the
study is concluded by summarizing the ﬁndings.

3 DATA COLLECTION

Probe vehicles ﬁtted with GPS units are commonly used to collect data for advanced public
transportation system applications. In the present study, data were collected using permanently
ﬁxed GPS units in Metropolitan Transport Corporation (MTC) buses in the city of Chennai,
India. In this study, MTC bus route 19B was considered, which has a route length of around 30
km as shown in Figure 1. The selected route has 25 bus stops and 14 signalized intersections,
many of which are severely congested and oversaturated. The study stretch represents typical
heterogeneous, lane-less Indian trafﬁc and includes varying geometric characteristics, volume
levels, and land use characteristics. The selected route covers both urban and rural areas and
has both four-lane and six-lane roads. The Average Daily Trafﬁc (ADT) at one location with
a counting station in the selected route was measured to be around 40,000 vehicles. Because
of lack of availability of any other counting stations along the route, this number can be con-
sidered as a representative value. The vehicle composition in this stretch is reported to be 47%
two-wheelers, 7.3% three-wheelers, 43.7% light motor vehicles (LMVs), and 2% heavy motor
vehicles (HMVs) [70]. In the test bed identiﬁed, there are no exclusive lanes for the public
transport buses. They share the road space with all other vehicle modes. The average headway
between successive buses is around 20 minutes for the selected route. While overtaking of

6

buses is feasible, overtaking of a bus by the next bus of the same bus route is very rare.

Figure 1: Study stretch considered (19B bus route).

In this study, 34 days of GPS data collected at every 5 seconds was used. Out of these
34 days, the last one week’s data were kept for corroboration purpose while the remaining 27
days’ data were use for model building. The collected GPS data included the ID of the GPS
unit, time stamp, and the location details of the bus in terms of latitude and longitude at every
5 seconds. The raw data obtained from GPS were then sorted and checked for quality. This
included trip identiﬁcation, data processing and data cleaning. Trip identiﬁcation is the process
through which multiple trips made by a bus in a particular day were separated. This process
also involved the separation of onward and return journeys of the same trip. Data processing
involved conversion of the raw location details (latitude and longitude) into distance, using
Haversine formula [71]. The difference between time stamps of two consecutive GPS data
points gives the travel time for the distance between the selected two points. After this process,
the data consisted of travel times and the corresponding distance between consecutive locations
for all the trips. In this study, the entire route was divided into smaller sections of 500 m length
as it is the average distance found between two successive bus stops and analyses were carried
out. Data cleaning was carried out to remove outliers from the data. The outliers were identiﬁed
by assuming free ﬂow speed of 60 km/h as the maximum speed leading to the lower bound of
travel time as 30 s for a 500 m section. The upper bound was kept as 95th percentile travel time
for sections. Travel times less than lower bound and more than upper bound were replaced with
its bound permissible values. After all these steps, the ﬁnal data set consisted of the date, time,
and 500 m section travel times for every trip.

7

4 PRELIMINARY DATA ANALYSIS

In this study, at each section, the travel times observed at different times of the day are viewed
as sequential data or a time series. The entire 24 hr time window is divided into one hour slots.
Due to absence of data for about 5 hours in the night, we have 19 active slots per day. The
data is pre-processed such that at each time slot there is only one travel time observation. It
was assumed that there are correlations between travel times of adjacent time slots and our
proposed predictive modelling strategies to be explained in the next section precisely capture
this.

Understanding the underlying data distribution is a key step before applying any statistical
modelling approach [72]. The processed data observations were grouped section-wise and dis-
tribution ﬁtting was carried out for each section. An analysis of travel time distribution was
carried out and a few sample histograms are shown in Figure 2. From Figure 2 it can be seen
that the distribution is skewed to the right, which indicate a positively skewed distribution. The
present study used the data distribution ﬁtting software “Easyﬁt” to check the possible distri-
butions to be tested. In the next level, codes were written in MATLAB to check the distribution
ﬁtting and the subsequent analysis conﬁrmed the selection of lognormal distribution as the best
ﬁt distribution for the considered dataset. In order to check the log-normality of the data, a
Kolmogorov-Smirnov test (K-S test) was conducted at 5% signiﬁcance level. The null hypoth-
esis assumed for this test is that the data follows log-normal distribution. For majority of cases,
the test failed to reject null hypothesis by showing p-values greater than 0.05, indicating that the
data sets can be approximated by log-normal distribution. Figure 3 shows the results obtained
from K-S test, i.e., p-values for various sections along the route across all hours and days and
Figure 4 shows sample plots of the best log-normal ﬁt for the respective empirical distributions
of Figure 2.

8

(a) Section 13

(b) Section 20

(c) Section 31

(d) Section 45

Figure 2: Histogram for sample sections.

Figure 3: p-values obtained from K-S test for each section across the route.

9

(a) Section 13

(b) Section 20

(c) Section 31

(d) Section 45

Figure 4: Distribution ﬁtting results for sample sections.

As the analysis results showed that the marginal distribution of data is mostly log-normal,
the next stage was to model this data, incorporating its log-normal characteristics. The present
study adopts concepts of time series to design prediction schemes under log normal data distri-
bution assumption, which is described in the next section.

5 METHODOLOGY

As described in the previous section, a KS test showed lognormal distribution as the best ﬁt
among a set of standard distributions for modelling the marginal distribution of the data. The
pdf of a univariate lognormal random variable Y with parameters µ and σ is deﬁned as

fY (y) =

1
√

2π

xσ

e− (ln(y)−µ)2

2σ 2

,

(1)

where ln(Y ) is a Gaussian random variable with mean µ and variance σ 2. Accordingly, the
travel time observations are assumed to follow a lognormal process. Prediction schemes, which
exploit the lognormality exhibited by the data and make statistically optimal predictions are
proposed. This study explores temporal modelling and prediction in primarily two ways. In the
ﬁrst approach (Seasonal AR modelling), the non-stationarity of the data is tackled by removing

10

0.4 0.36 0.32 0.28 0.24 � 0.2-0.16-0.12-0.08 0.04 0 60 80 100 120 140 160 180 Travel time (x), seconds ID Histogram -Lognormal I0.32 0.28 0.24 0.2 x0.16-..__.. . 0.12-0.08 0.04 0 30 32 34 36 38 40 42 44 46 48 50 52 Travel time (x), seconds ID Histogram -Lognormal I0.36 0.32 0.28 0.24 x 0.2-0.16-0.12-0.08 0.04 0 32 36 40 44 48 52 56 60 64 Travel time (x), seconds ID Histogram -Lognormal I0.32 0.28 0.24 0.2 X �0.16-0.12-0.08 0.04 0 40 60 80 100 120 Travel time (x), seconds ID Histogram -Log normal I 140 160 180 200 possible deterministic trends and seasonality in the data before applying standard stationary
model ﬁts. In the second approach (Non-stationary method), a general non-stationary data-
driven model with a principled method to estimate the time-varying parameters of the non-
stationary model is proposed. In these proposed approaches, both the Gaussian and log-normal
assumptions on the data are explored and are disscussed below.

5.1 Seasonal AR Modelling with Possible Integrating Effects

A classical (Gaussian distribution based) time series approach for modelling and learning based
on historical data and subsequent prediction is explained here. Towards the end of the section,
we discuss how the lognormality of the data can be incorporated into the approach based on
Gaussian assumptions. Data from about 27 days was used for training or model ﬁtting. Each
day’s travel time observations (19 of them) at each section were concatenated together (in the
order of dates) to form a single long time series.

Compensating for standard non-stationarities, if any: In time series analysis, it is a standard
practice to ﬁrst ﬁlter out deterministic non-stationarities like (polynomial) trends and periodic-
ities (also refered to as seasonality sometimes) from the data (which is usually non-stationary)
before applying standard stationary model ﬁts. On visual inspection, it was observed that there
are no linear or higher order trends in the time series of any section. Further, on inspection of
the Auto Correlation Function (ACF) (sample plots shown in Figure 5), no abnormally slow
decay of the ACF was found at consecutive lags. Presence of polynomial trends in the data
typically manifests in a slowly decaying ACF which is not the case in our data. Figure 6 shows
the ACF values at lag 1 (which are all signiﬁcantly less than 1) in all the sections to ascertain
this. Please observe that the lag 1 ACF values at all sections are signiﬁcantly less than 1, which
rules out the presence of polynomial trends. Further, since the data has been constructed by
stringing together short time series segments of a ﬁxed length (19 in this case), it is natural to
check for periodic (seasonal) trends of period one day. The presence of a deterministic seasonal
component can manifest itself in the ACF again with a slow decaying trend at the seasonal lags.
Figure 7 shows the ACF values at seasonal lag and it can be seen that the values are signif-
icantly less than 1 in all the sections. Hence, there was no evidence of presence of periodic
(seasonal) trends in our data and it was concluded overall that deterministic non-stationarities
are absent in the data.

Among the stochastic types of non-stationarity, the well-known integrating type effect was
checked using the ADF unit-root test. We have conducted the ADF test at the optimal lag
length to ascertain the presence of unit-root stochastic non-stationarities in the data. First, the
maximum lag length for the sample was obtained using Schwert’s thumb rule [73] and ADF
test was conducted for all lag lengths. Then, lag length with lowest BIC value is identiﬁed
as optimal lag length and the corresponding ADF test results were considered for the decision
making. In the present study, the ADF test rejected the null hypothesis for all the sections. The

11

integrating type stochastic non-stationarity can occur at a seasonal level too. The ACF decay
at seasonal lags being signiﬁcantly less than 1 is one clear evidence to rule out the presence of
seasonal unit roots. Figure 7 which shows the ACF values at the ﬁrst seasonal lag demonstrates
that the decay factor is signiﬁcantly less than 1 in all the sections. This rules out the presence
of seasonal unit roots.

(a) Section 12

(b) Section 45

Figure 5: Sample ACF plots for selected sections of the route

Figure 6: ACF values at ﬁrst lag for all the sections.

Seasonal AR model ﬁt: On the conditionally (if the unit-root test detected integrating effects)
differenced data, the ACF and Partial Auto Correlation Function (PACF) is computed. It was
observed that in all cases PACF decayed quickly (shown in Figure 8). This condition is an ideal
candidate for a pure AR model ﬁt [74]. Moreover, prediction is a very simple process under
AR model ﬁts. Even though the ACF decays considerably after a couple of initial lags, it again
picks up (statistically) signiﬁcant magnitude at the intial seasonal lags (speciﬁcally at 19 here).
This indicates that even though there are no deterministic seasonal components that repeat in a
ﬁxed fashion, there do seem signiﬁcant correlations (stochastic) between travel times exactly a
day apart (19 ticks here). To incorporate this expected and important feature of the ACF, this
study propose to use a seasonal AR model with an appropriately identiﬁed model order using

12

Figure 7: ACF values at ﬁrst seasonal lag for all the sections.

(a) Section 12

(b) Section 45

Figure 8: Sample PACF plots for selected sections of the route.

its PACF. It is standard in time series to ﬁx the AR-model order based on the signiﬁcant PACF
co-efﬁcients. This study explores the usage of (a) Multiplicative Seasonal AR Model and (b)
Additive Seasonal AR Model. A multiplicative seasonal AR model for a process y(t) is of the
form

(1 − φ1L − φ2L2 − · · · − φpLp)(1 − Φ1Ls − Φ2L2s − · · · − ΦkLPs)y(t) = e(t),

(2)

where, e(t) is a white noise process with unknown variance, Lp is the one-step delay operator
applied p times i.e. Lpy(t) = y(t − p). As the name multiplicative suggests, the AR term in the
stationary process is a multiplication of two lag polynomials: (a) ﬁrst capturing the standard
lags of order upto p, (b) second capturing the inﬂuence of the seasonal lags at multiples of the
period s and order upto P. For instance, for the PACF shown in Fig 8a, the choice of order
parameters would be p = 2, P = 1, and s = 19. An additive seasonal AR model on the other
hand is a conventional AR model (1 − φ1L − φ2L2 − · · · − φpLp)y(t) = e(t) with co-efﬁcients
corresponding to the insigniﬁcant values in the PACF constrained to be zero. For instance,
for the PACF shown in Figure 8a, an AR model of order 19 is chosen with co-efﬁcients φ3 to
φ18 forced to zero. Both the multiplicative and additive seasonal AR models are learnt using

13

maximum likelihood estimation [75]. We ﬁnally choose the model with the higher AIC between
these two for prediction. Figure 9 shows the order p of the learnt AR model at every section.
Also, this study stuck to one seasonal lag (P = 1) for building the overall SAR model.

Figure 9: Seasonal AR model order (p) across all the sections.

Incorporate log-normality: Our ﬁrst proposed scheme is based on stationary log-normal
AR modelling [76]. A log-normal stationary AR process (Y1,Y2, . . . ) is one whose transformed
process (X1, X2, . . . ) obtained by applying log on each of its random variables is a stationary
Gaussian AR process. This means (Xi = ln(Yi)), ∀ i. As shown in [76], if one is predicting Yn
based on its past values Y1,Y2 . . .Yn−1, then the conditional distribution of Yn is also log-normal
with parameters µ = ∑k
i=1 wi ∗ Xn−i and σ 2. Here wi, i = 1, . . . k are the AR parameters and σ 2
is the variance of the input noise, both in the associated Gaussian AR process. Accordingly
we apply a log transformation on all the travel time observations ﬁrst, and then ﬁt an AR
model as explained above. While predicting, in case the data is differenced due to presence of
integrating type effects, one needs to do linear prediction on the differenced data and ﬁnally
undo the differencing after linear prediction. We ﬁnally apply the exponential transformation to
obtain the actual travel time prediction. Applying an exponential transformation is equivalent to
choosing the median of the conditional log-normal distribution as the ﬁnal point estimate which
is statistically optimal under the mean absolute error loss function [77]. Log-normal modelling
(unlike Gaussian modelling) gives us the ﬂexibility of trying out the mean and mode (which are
optimal under the mean square error and ε-insensitive loss functions [77] as well apart from the
median (all three of which are distinct) for the ﬁnal point estimates. Both these point estimates
additionally would need the conditional variance of the prediction in the Gaussian domain.

14

5.2 Linear Non-Stationary Approach

The classical time series approach discussed before assumes the data to be a sum of possi-
ble trend and periodic (deterministic) non-stationarities plus a stochastic stationary component
(with possible integrating type stochastic non-stationarities). The next approach that is dis-
cussed here, on the other hand models the data in a non-stationary fashion directly. The con-
ventional time-series approach (discussed before) assumes one long realization of a random
process. It assumes ergodicity of the process for estimating ensemble averages using time aver-
ages [75]. However, the non-stationary model we now consider involves a ﬁxed ﬁnite number
of random variables. The number of random variables in this random vector will be equal to the
number of slots we bin the 24 hr axis into, at each section. To learn the statistics of these ﬁnite
set of random variables, one needs independent and identically distributed (i.i.d.) realizations
of this ﬁnite-dimensional random vector. The travel time vector (at a ﬁxed section) of a partic-
ular day which consists of observations from different time-bins of the day can be regarded as
one realization of this random vector. The collection of all such travel time vectors across all
training days constitute i.i.d. realizations of this random vector.

Recall from Figure 6 of the previous (SAR) subsection that we did not ﬁnd any trend in the
travel time sequential (time-series) vector which was obtained by concatenating all the daywise
travel time training vectors in order. This justiﬁes our assumption to regard the daywise travel
time vectors at a particular section to be identically distributed. However, this joint distribution
can change from section to section. Presence of a trend in the day-wise concatenated time series
would nullify our assumption that these day-wise travel time vectors are identically distributed.
Hence, it can be assumed that these 27 travel time vectors as i.i.d and estimate the joint
distribution of these 19-dimensional random vector at each section separately. Before we pro-
ceed to ﬁt a predictive model, we ﬁrst look at the empirical mean of each of these 19 random
variables at every section. We provide the mean variation plot at two randomly chosen sections
across the 19 time bins in Figure 10. We further provide a box plot of the mean travel times
in a day across all the 56 sections in Figure 11. This overall justiﬁes the evidence for (mean)
non-stationarity at each section amongst these 19 random variables.

15

(a) Section 27

(b) Section 47

Figure 10: Variation of mean travel time across time intervals of the day

Figure 11: Box plot of mean travel time across sections.

Motivated from this observation, the proposed approach tries to ﬁt a general Gaussian/ log-
normal model to aid real-time predictions based on the travel-time of the past time-bins of
the same day. We propose to use a non-stationary auto-regressive modelling approach, which
makes prediction a straightforward and computationally inexpensive task. Firstly, the non-
stationary AR-model is explained under the Gaussian assumption. Extending it further under a
log-normal joint distribution is similar to the stationary log-normal AR case.

As the name auto-regressive suggests, the proposed model assumes that any travel time ob-
servation can be obtained by linearly regressing a ﬁnite set of preceding past values. In partic-
ular, any travel time observation Xn (at time-bin n) can be written as a linear combination (with
a bias) of a set of its k(n) immediately preceding values plus some independent Gaussian noise
with an unknown time-varying (n-dependent) variance. This form of non-stationarity brings
in two levels of generality as opposed to a stationary Gaussian AR process: (a) The regressing
weights now would be a function of n, (b) The number of immediately preceding past (travel-
time) values that inﬂuence at time-bin n can also vary with n i.e. the weight vector length k(n)

16

is now a function of n. We denote the weight vector at time bin n as wn = [wn
Figure 12 illustrates these non-stationarity inﬂuences.

0, wn

1, wn

2, . . . wn

k(n)].

Figure 12: Illustration of non-stationary model: Inﬂuences on to a particular time bin indicated
via arcs of the same color and associated weights wn
0) at time bin 5, 6 and 7. k(5) = 3,
k(6) = 2, k(7) = 3.

i (except wn

1, wn

0, wn

2, . . . wn

At each section, the sequence of travel time observations of each historical day is consid-
ered a realization of the above non-stationary process. For each section, the entire collection
of all historical (27) days is treated as (27) i.i.d realizations from this process. The availability
of i.i.d. data from many days in the historical past makes estimation of the time-varying re-
gression weight vectors wn = [wn
k(n)] feasible for each time-bin n. The estimation
process can be a little tricky given that the length of the weight vector is not known apriori.
The problem boils down to solving the following statistical conditional independence question:
Given the recent past k values upto time n − k, are the current and the past beyond time (n − k)
conditionally independent? If this is the case, the main advantage is as follows. To predict the
current travel time Xn, knowledge of only its k past values are necessary and one can forget
about the past beyond (or before) Xn−k. We are in particular interested in the least such k for
which this holds. Checking this conditional independence for general distributions can be com-
plicated or even infeasible. However for Gaussian distributions, the notion of partial correlation
(PC), comes to our aid here, which is deﬁned as follows.

Partial correlation as the name suggests captures the correlation between those parts of A
and B that are not explainable by C. Interestingly, for multi-variate Gaussian distributions,
it turns out that the conditional independence between A and B given C holds if and only if
the associated PC between A and B given C is 0 [78], as stated next. This crucial relation
is what facilitates a method to ascertain the necessary conditional independence to build our
non-stationary auto-regressive model.

Deﬁnition 1. [79, 80] Given random variables A and B and a random vector C = (C1,C2, . . .Cn),
the partial correlation between A and B given C is deﬁned as the correlation coefﬁcient between
residual errors eA = (A − f1(C)) and eB = (B − f2(C)), where f1(C) is the optimal linear pre-
dictor (in the mean square sense) of A given C and f2(C) is the optimal linear predictor (in the
mean square sense) of B given C.

17

TimeBinIndex1234567X5X1X2X3X4X6X7w51w52w53w61w62w71w72w73Property 1. Consider random variables X and Y and a random vector Z such that (X,Y, Z)
are jointly Gaussian. X and Y are conditionally independent given Z if and only if the partial
correlation between X and Y is zero.

Proof. For Gaussian joint distributions, all conditional distributions are also Gaussian with
mean being a linear function of the conditioning random variables while the variance is con-
stant and independent of the values assumed by the conditioning random variables [81]. This
means the joint distribution of X and Y (conditioned on Z) would be Gaussian. It is an ele-
mentary fact that independence of two jointly Gaussians is equivalent to their covariance being
zero. Hence, checking for conditional independence of X and Y is equivalent to checking for
their conditional covariance being zero. Checking for conditional variance being zero for every
value of the conditioning random variables is in general computationally infeasible. However,
in the joint Gaussian case, one can show that the conditional variances and conditional cor-
relation co-efﬁcients are independent of the speciﬁc values the conditioning random variables
can assume [82]. This means that the conditional covariance which is the product of condi-
tional variance and conditional correlation co-efﬁcient will be independent of the conditioning
random variables.

The linear regressor of X w.r.t. Z i.e. the best linear approximation of X in terms of Z in
the mean-square error (MSE) sense is E(X/Z) when X and Z are jointly Gaussian. For similar
reasons, the linear regressor of Y w.r.t Z is E(Y /Z). Hence in the multi-dimensional Gaussian
setting, the partial correlation can be written as

E [(X − E(X/Z))(Y − E(Y /Z))]

(3)

E [(X − E(X/Z))(Y − E(Y /Z))/Z = z] fZ(z)dz

E [(X − E(X/Z = z))(Y − E(Y /Z = z))/Z = z] fZ(z)dz,

=

=

(cid:90)

(cid:90)

the ﬁrst term in the above integral is the conditional covariance between X and Y which is
independent of z as explained above. Hence this constant term can come out of the integral and
PC is now equal to this constant conditional covariance. Hence the property follows.

Algorithm 1 gives a detailed explanation of computing the order and values of auto-regression

and the additive noise variance for a speciﬁc time bin n. The algorithm basically computes the
sample partial correlation (PC) between Xn and Xwin−1 given all the intermediate random vari-
ables namely (Xn−1, Xn−2, . . . Xwin) for win varied progressively from n − 1 to 2 (line 2). For a
particular win, it performs a forward regression to compute wf, the optimal linear predictor of
Xn in terms of (Xn−1, Xn−2, . . . Xwin) (line 3). Similarly, it performs a backward regression to
compute wb, the optimal linear predictor of Xn in terms of (Xn−1, Xn−2, . . . Xwin) (line 4). The
associated residual errors of both the forward and backward linear regressions are computed
next (lines 5 to 7). As per deﬁnition 1, sample PC is computed by calculating the correla-
tion coefﬁcient of the rf and rb (line 10). To statistically ascertain if the computed sample PC

18

Algorithm 1: Learn/Estimate AR Co-efﬁcients and Noise Variance at Each Time Bin
n for a Fixed Section.

Input: Historical Data D = [x1 x2 . . . xT](d×S), S - total no. of time bins in the day. d -

number of days for training, xi(d×1) - travel time observation vector at the ith
time bin of the day.
1, wn

2, . . . wn

k(n)], σ 2
n .

0, wn

Output: wn = [wn
1 Initialize Flag = 1;
2 for win ← (n − 1) to 2 do
3

Linearly regress Xn w.r.t (Xn−1, Xn−2, . . . Xwin) to obtain wf with INPUT =
(xn−1, xn−2, . . . xwin), OUTPUT = (xn).
Linearly regress Xwin−1 w.r.t (Xn−1, Xn−2, . . . Xwin) to obtain wb with INPUT =
(xn−1, xn−2, . . . xwin), OUTPUT = (xwin−1).
From wf and wb, compute the respective sample residuals rf and rb, as below:
∀i, rf(i) ← xn(i) − ∑n−win
∀i, rb(i) ← xwin(i) − ∑n−win
j=1 wb( j) ∗ xn−j(i) + wb(0), i - day index.
Compute ParCor, sample correlation coefﬁcient between rf and rb.
/* The above computes partial Correlation between Xn & Xwin−1 given the
intermediate random variables (Xn−1, Xn−2, . . . Xwin). */
Compute test statistic t∗ ← ParCor
standard t-test ([82]).
if p-value of t∗ > 0.05 then

j=1 wf( j) ∗ xn−j(i) + wf(0), i - day index.

to assess if ParCor == 0 based on a

d−2
1−ParCor2

√

4

5

6

7

8

9

10

11

12

Flag = 0 ;
break;

13
14 if Flag == 1 then
15

16
17 σ 2
n ← Sample variance of rf ;
18 return (wf, σ 2
n )

Linearly regress Xn w.r.t (Xn−1, Xn−2, . . . X1) to obtain wf with INPUT =
(xn−1, xn−2, . . . x1), OUTPUT = (xn).
Compute sample residual rf from wf.

√

d−2
1−ParCor2

is zero or not, we use hypothesis testing. In particular, our null hypothesis used is PC equal
to zero. We employ a standard t-test [82] for assessing zero correlation coefﬁcient with test
statistic ParCor
(line 10) which is known to follow a t-distribution with d − 2 degrees of
freedom. If the p-value of the test statistic is less than 0.05 (signiﬁcance level), we reject the
null-hypothesis. Note that the test is 2-sided with the test statistic possibly taking both positive
and negative values. We stop at the earliest instance of win where p-value is greater than 0.05
(line 11 to 13). This means we retain the null hypothesis and the partial correlation is assessed
to be zero. This would give us the order of autoregression, k(n) = (n − win) at time bin n. This
is also the minimum number of previous travel times conditioned on which the current Xn and
the past (Xwin−1 and beyond) are independent. If the PC is not signiﬁcantly close to zero for
any win, then Xn is dependent on the entire past (lines 16 and 17).

Incorporating lognormality: A lognormal non-stationary AR process can be deﬁned as
one whose log-transformed process is a Gaussian non-stationary AR process. Learning under

19

this model, can be readily achieved by ﬁrst taking the log of all the observations and then ﬁtting
a gaussian non-stationary AR model as explained above.

0 + ∑

0 + ∑

k(n)
i=1 wn

k(n)
i=1 wn

The optimal prediction for the Gaussian non-stationary AR model at time tick n given
the current past (X1, X2 . . . Xn−1) is carried out as ˆX(n) = wn
i ∗ Xn−i. In the lognor-
mal case, the original current observations (Y1,Y2 . . .Yn−1) are log transformed ﬁrst to obtain
(X1, X2 . . . Xn−1). The optimal linear combination in the Gaussian domain is computed like ear-
lier ˆX(n) = wn
i ∗ Xn−i and the ﬁnal optimal point estimate in the lognormal domain
is ˆY (n) = exp ˆX(n). This point estimate turns out to be the median of the conditional distribution
P(Yn/Yn−1,Yn−2 . . .Y1), which is also lognormal. One can also use the mean and mode of this
conditional lognormal distribution for a point estimate in which case we would additionally
n (in addition to ˆX(n)). However for the purposes of the current paper
need information of σ 2
we stick to the median which translates to the use of a simple exponentiation of the prediction
in the Gaussian domain.

5.3 Real-time prediction across multiple sections ahead

In the previous two subsections, linear statistical models (with lognormality incorporated while
not necessarily stationary) which capture temporal correlations in the bus travel time data were
proposed. The temporal prediction models built at each section need to be ultimately used for
real-time predictions of travel times for a bus whose trip is currently active. The constructed
models can predict temporally ahead into the future at every section. However, what we need
is predicting travel times of a currently plying bus over a couple of sections ahead of its current
position. It is not immediately clear how the sequential prediction models developed in the
previous sections could be used for travel-time prediction over a subroute of arbitrary sections
ahead from the current position of an active bus.

We illustrate the method via an example as shown in the space-time diagram of Figure 13.
We assume that the time bins are all of the same duration of one hour even though our proposed
methodologies can be used for general non-uniform time bin durations. The bus is currently on
the verge of leaving current section i (i = 2 here). The current time is 2 : 30 PM with the current
time bin j = 11 in this example. We assme that the current real-time information is available
on these various subsequent sections upto the previous time bin ( j − 1 = 10). The current (or
observed) real-time travel time information at a subsequent section a and time bin b is denoted
as T a,ob
. In the
b
example, it is further assumed that the learnt models are simple autoregressive models of order
2 for ease of illustration. This means we need real-time data from only the previous two time
bins as the shaded region of the ﬁrst two rows of the space-time diagram indicates. Prediction
of travel time on one section ahead of the bus’s current position (section 3 in the example) is
pretty straight forward.

, while the predicted travel time at a section a and time bin b is denoted as

(cid:91)
T a,pr
b

Given that the bus is currently just leaving section i at time bin j ( j = 11 in the example), to

20

Figure 13: Illustration of the multi-section ahead travel time prediction.

predict the bus’s travel time on section i + 1, one needs to use the current real-time travel time
information on section i + 1 (from all previous buses) upto previous time bin j − 1. One needs
to perform a one-step temporal prediction at section i + 1 to predict the bus’s travel time one
section ahead as shown in Figure 13.

To extend this to an arbitrary number of sections ahead in a principled way, one would need
to potentially perform a multi-step temporal prediction (using either of the sequential models
previously discussed) at the subsequent sections. For a subsequent section (cid:96), the larger the
difference between (cid:96) and current section i, the number of temporal steps ahead we need to
predict at section (cid:96) will proportionately go up. The fundamental idea of the algorithm is as
follows. It sequentially goes through the sections ahead starting from section i + 1. We predict
the travel times based on the temporal model learnt at that section by performing a one-step
prediction to start with. For every travel time predicted at a subsequent section k, we update
the expected exit time of the bus from section k by adding this prediction time. The exit time
thus calculated for section k is also the expected entry time into section k + 1. The ﬁrst instance
when the expected exit time enters the next time bin (namely j + 1), the temporal prediction
from the next section onwards has to be 2-step ahead. Note that this happens at section 5 in the
illustration of Fig. 13 upto which a single-step prediction is performed to calculate the estimates
(cid:91)
T 4,pr
as clearly indicated via the quantities
. A 2-step temporal prediction is
11
adopted from the next section because the current real-time data we have from the previous

(cid:91)
T 5,pr
11

(cid:91)
T 3,pr
11

and

,

21

1-STEPPREDICTION(Temporal)2-STEPPREDICTION(Temporal)SectionNumberTimeBinIndex123456789101PM92PM103PM114PM125PM13Tcur=2:30PMT3,ob10T3,ob9dT3,pr11T4,ob10T4,ob9dT4,pr11dT4ex<3PMT5,ob10T5,ob9dT5,pr11dT5ex>3PMT6,ob10T6,ob9dT6,pr11dT6,pr12dT7ex<4PMT7,ob10T7,ob9dT7,pr11dT7,pr12dT8ex<4PMT8,ob10T8,ob9dT8,pr11dT8,pr12dT9ex>4PMT9,ob10T9,ob9dT9,pr11dT9,pr12dT10ex<5PMT10,ob10T10,ob9dT10,pr11dT10,pr12dT10,pr13Algorithm 2: Travel-Time Prediction Across k-sections Ahead

Input: Current Real Time Data of all previous buses, Current position of the current

bus at the end of some section i, Current Time Tcur.

Output: Predicted Travel Times to travel k sections ahead from section i + 1 starting at

time Tcur.

1 Compute the current time bin, j within which Tcur falls ;
Tex = Tcur ;
2 Initialize
3 Initialize TimeStepAheadInd = 1 ;
4 Initialize ExpTimeBin = j ;
5 for k = 1, 2, . . . K do
6

(cid:99)

Do TimeStepAheadInd-step temporal linear prediction at section i + k using either
the seasonal AR model OR the non-stationary AR model in the Gaussian domain
(using the log transformed raw data) to obtain T (i+k),pr.
/* Predict Travel time at section i + k using the current real time data at section
i + k upto time bin j - 1. */
/* In other words, predict travel time for time bin j - 1 + (TimeStepAheadInd) at
section i + k.*/
Tex =
if
(cid:99)

Tex falls outside ExpTimeBin then

Tex + exp(T (i+k),pr).

(cid:99)

TimeStepAheadInd = TimeStepAheadInd + 1;
ExpTimeBin = ExpTimeBin + 1;

7

8

9

10

11

(cid:99)
12
13 return TravelTime

buses is only upto time bin j − 1, while the bus would reach this subsequent section only in
time bin j + 1. Accordingly from now on, for a consecutive block of sections one performs a
two-step prediction till the ﬁrst instance the expected exit time moves into time bin j + 2 and
the process continues. In the example, the next such block of sections where 2-step prediction
is carried out ranges from 6 to 9.

(cid:99)

Algorithm 2 presents a pseudocode for achieving this. Current time, Tcur happens to fall
in the current timebin, j, numbered 11 with duration 2 pm to 3 pm (line 1).
Tex captures the
dynamically predicted exit time from a section as the algorithm iterates sequentially through
subsequent sections. TimeStepAheadInd captures the number of time-steps ahead that the tem-
poral models should predict as the algorithm proceeds. TimeStepAheadInd starts with 1 (line
3). ExpTimeBin captures the time bin in which the bus is expected to be as the prediction pro-
ceeds forward sequentially in space. It is as expected initialized to j, the current time bin (line
Tex falls beyond the
4). TimeStepAheadInd gets incremented suitably whenever the exit time
ExpTimeBin (line 11). ExpTimeBin also gets incremented under the same condition as shown
in line 12. At the kth subsequent section (from section i), we make a TimeStepAheadInd-step
ahead prediction of the temporal model pre-learnt at section i + k (line 6). Fig. 13 clearly
illustrates how the number of temporal steps ahead prediction needed at a section i + k is pro-
portional to k. It starts with a consecutive block of sections on which the temporal models
perform a 1-step temporal prediction followed by the next consecutive block of sections, in

(cid:99)

22

each of which a 2-step temporal prediction is carried out and so on.

6 RESULTS

The proposed methodologies were implemented in MATLAB for both single step prediction
and multi step prediction and the performance was evaluated in terms of Mean Absolute Per-
centage Error (MAPE) and Mean Absolute Error (MAE). Testing was carried out for a period
of seven days and results are discussed below.

6.1 Performance Evaluation

The present study evaluated the predicted travel time values with the actual measured travel
time values. The evaluation was done at three stages to highlight the observations and contri-
butions of the present study. First part of the study evaluates the log-normal assumptions of
the data by comparing the results of Seasonal AR method and Non-stationary method under
both Gaussian and log-normal assumptions at an aggregate level. Next, the proposed methods
were compared with each other and the inferences were made at section level and trip level to
know the superiority amongst them. Finally, the performance of the multi-step ahead predic-
tion framework was evaluated and compared between the Seasonal AR and the non-stationary
method.

6.1.1 Single step prediction

Exploiting Log-normality assumptions: To begin with, the performance of the proposed
methods under Gaussian and log-normal assumptions were analyzed to check the validity of
log-normal properties of the data by incorporating the same in prediction scheme. Figure 14
show the MAPE values obtained when the proposed methods were implemented under Gaus-
sian and log-normal assumption. Figures clearly show that the predictions are better under
log-normal assumption compared to Gaussian. Hence, it can be concluded that incorporating
log-normal nature of the travel time data in to the modeling process did improve the prediction
accuracy of the proposed methods and hence for further evaluation, the performance of the
methods was analyzed only under log-normal domain.

In the next stage, performance was compared at an aggregate level of the seasonal AR and
non-stationary method with the measured travel times from ﬁeld. Sample plot of actual and
predicted travel time values for a given trip (during test period) are shown in Figure 15. Figure
clearly shows that the predicted travel time values are closely matching with the actual travel
time values. Though, the performance of both the proposed methods are comparable, it can be
observed that the peak travel time values around are better captured by non-stationary method.

23

(a) Seasonal AR method

(b) Non-Stationary method

Figure 14: Performance comparison of the proposed methods under Gaussian and log-normal
assumptions.

Figure 15: Predicted and measured travel times for a sample trip.

In the next level, comparisons at different levels like section level, and trip level are ex-
plored. For section level comparison, MAPE of predicted values of all trips for every section
were aggregated and compared between the proposed methods. Figure 16 shows the MAPE
values for all trips for every sections. For trip level comparison, MAPE of predicted travel time

24

12345670510152025MAPEDay Index NS (Gaussian)  NS (Lognormal)Figure 16: MAPE values obtained for all sections across the route.

Figure 17: MAPE values obtained for all trips on a sample day.

values were aggregated over sections for every trip that happened on a sample day. Figure 17
shows the MAPE values obtained for all trips on a sample day. From Figure 16 and 17, it can
be observed that the performance of both the proposed methods are comparable with a slight
upper-hand in accuracy by seasonal AR.

6.1.2 Multi-step prediction

The performance of the proposed methods while predicting multiple sections ahead was evalu-
ated next, as a complete BATP system is expected to give prediction updates to the passengers
waiting at the bus stop. The proposed methodologies learnt separate temporal models at each
section and integrating these various learnt models for performing (the ﬁnal) spatial multi-step
prediction accurately. As the users experience the errors in terms of actual deviations, the eval-
uation of the proposed methods were checked in terms of MAE, i.e., absolute deviation of the

25

3691215182124273033363942450102030MAPETrip Index Classical SAR  Non Stationary ARpredicted travel time from the actual travel time.

The multi-step prediction algorithm predicts the travel time in all upcoming sections (56-m)
from the current section (m) i.e. if the bus is at mth section, the multi-step prediction algorithm
can predict travel time for all remaining sections till destination. The predicted values of all
the upcoming sections were used to calculate the Estimated Arrival Time (ETA) of a bus to
any given bus stop that is located at section n. In particular, (n-1) times ETA can be calculated
and predictions can be updated for any bus stop located at section n. Figure 18a shows the
comparison of MAE values obtained by predicting the arrival times at Navallur bus stop for
its current positions at every preceding section. This bus stop is located at 7.52 km from the
origin, which is at 16th section. Hence, the arrival time predictions were made for 15 different
current positions of the bus starting from section 1 to section 15. Similarly, 22 predictions were
made for Semmencheri bus stop that is located at 11.03 km from origin and a comparison of
MAE values are presented in Figure 18b. From the Figure 18, it can be seen that the proposed
non-stationary method is performing better than the seasonal AR in all the cases. Overall, the
above shown comparisons gives fair insights about the contributions of the proposed work.

(a) Navallur (7.52 km from origin)

(b) Semmancheri (11.03 km from origin)

Figure 18: Errors obtained from various multi-step predictions for selected bus stops.

26

6.2 Performance Comparison

Further, the performance of the proposed prediction method was compared with space dis-
cretization [17], time series approaches: exponential smoothing [83] and ARIMA [68], ma-
chine learning approach: ANN [84] and historical average methods. To keep them all com-
parable with the proposed method, 27 days data were used for model building and one-week
data to test the performance. In the space discretization approach [17], travel time of a bus
in an upcoming section was predicted using the travel time in the previous section alone i.e.
the model hypothesized a relation in travel time between neighbouring subsections. As part of
implementation, the space discretization approach uses the travel time data obtained from pre-
vious two buses to predict the travel time of the next bus. An ANN based data-driven approach
[84] was trained with four independent variables i.e. previous four signiﬁcant trips travel time
on the same segment, to predict the next bus travel time. For training the neural network model,
a multi-layer feed-forward network with the Leveberg-Marquardt back propagation algorithm
was used. Exponential smoothing predicts the travel time of the next bus using the most recent
observation and the most recent estimate from the previous bus. Another time series approach,
ARIMA predicted route travel time and then segment travel times using segment-speciﬁc coef-
ﬁcients, which were established using historic database [68]. The errors obtained from all these
methods are presented in terms of MAPE. Figure 19 shows the comparison of MAPE values
obtained by aggregating all trips at all section at day level for all the methods.

Figure 19: Comparison of MAPE values of various approaches for all days during test period.

From Figure 19, it can be observed that both the proposed methods outperforms existing
methods on all test days. Amongst the proposed methods, seasonal AR performance can be
found to be slightly better than non-stationary method. Such marginally lower performance of
the NS method can be attributed to the lack of sufﬁcient quality data. In this paper, we used 27
days data for training. The non-stationary model essentially tries to learn a linear regressor at

27

every time bin with 27 data points. Hence, it can be expected that the performance in this case
will improve with more quality data. However, the classical approach learns only one common
linear regressor at every section and hence more data may not affect the performance. Thus, it
can be concluded that the proposed methods in this study are viable for the prediction of bus
arrival times under mixed trafﬁc condition.

7 SUMMARY AND CONCLUSIONS

Providing information about bus arrival times/travel times at bus stops helps in reducing the
uncertainties and waiting time of commuters. Bus travel times are often affected by diverse
factors such as weather, incidents, signals, bus stops, bottlenecks etc., making the bus arrival
time prediction complex in an urban trafﬁc environment. The present work developed a bus
arrival time prediction exploiting the temporal correlations of the AVL data. The unique aspects
and main contributions of the study include:

• The choice of observations in modelling the time series is very different from existing
approaches. The travel times experienced at different times of the day at a particular
section constitute the observations of our time series. This choice of observations is
motivated from the necessity to learn the temporal correlations in the AVL data.

• We explored the SAR time series approach using both multiplicative and additive sea-
sonal model and ﬁnally chose the best among them (based on the AIC criteria) at each
section.

• We proposed a novel sequential non-stationary model for learning temporal correlations.
This model and its associated learning is not standard from a statistics OR time series
analysis perspective and we believe is a novel contribution.

• Further, utilizing the above two class of sequential models (learnt at each section) for
solving the ﬁnal multi-section ahead bus travel time prediction is not straightforward.
We discussed the issues involved and proposed a prediction framework to achieve this,
which makes our method viable for real-time implementation. This framework is general
enough to be used in conjunction with any of the proposed temporal prediction models.

• Lastly, we exploit the log-normal nature of the travel time distributions into the pre-
dictions to obtain statistically optimal predictions under log-normal assumptions. Our
experiments on real data clearly vindicate this choice by revealing superior predictions
(under log-normal assumptions) in comparison with Gaussian assumptions on the pre-
dictive model.

Our experiments clearly demonstrated the superior performance of the proposed methods in
comparison with the existing approaches. Hence, this study concludes that the proposed meth-

28

ods are viable to implement for a bus arrival time prediction system under heterogeneous trafﬁc
condition with a good data base availability.

A natural future work would be to explore non-linear models to capture the temporal cor-
relations and then use our proposed multi-step prediction framework for the ﬁnal ETA predic-
tion. In this work we fully exploited only the temporal correlations in the AVL data. Another
potential direction for future research would be to exploit the more general spatio-temporal
correlations in the data using space-time ARIMA models.

8 ACKNOWLEDGMENTS

The authors acknowledge the support for this study as a part of the project RB/16-17/CIE/001/
TATC/LELI under the Development of a Dynamic Trafﬁc Congestion Prediction System for
Indian Cities, funded by Tata Consultancy Services.

References

[1] Ceder.

Public transit planning and operation: Theory, modeling and practice.

Butterworth-Heinemann, Boston, 2007.

[2] Kari Edison Watkins, Brian Ferris, Alan Borning, G. Scott Rutherford, and David Layton.
Where is my bus? impact of mobile real-time information on the perceived and actual wait
time of transit riders. Transportation Research Part A: Policy and Practice, 45(8):839–
848, 2011.

[3] Candace Brakewood, Sean Barbeau, and Kari Watkins. An experiment evaluating the
impacts of real-time transit information on bus riders in tampa, ﬂorida. Transportation
Research Part A: Policy and Practice, 69:409–422, 2014.

[4] O Cats and G. Loutus. Real-time bus arrival information system – an empirical evaluation.

Journal of Intelligent Transportation Systems, 2015.

[5] M Gentili and P. B. Mirchandani. Review of optimal sensor location models for travel time
estimation. Transportation Research Part C: Emerging Technologies, 90:74–96, 2018.

[6] J Van Lint. Reliable travel time prediction for freeways. PhD thesis, Delft University of

Technology, Delft, The Netherlands, 2004.

[7] L. Mihaylova and R. Boel. A particle ﬁlter for freeway trafﬁc estimation. In 43rd IEEE

Conference on Decision and Control. IEEE, 2004.

[8] C. P. I. J. van Hinsbergen, J.W. C. van Lint, and F. M. Sanders. Short term trafﬁc prediction

models. In 14th World Congress on Intelligent Transport Systems (ITS), 2007.

29

[9] M. P. Miska, Theo H. J. Muller, and H. J. van Zuylen. Online travel time prediction with
real-time microscopic simulation. In 84th Annual meeting of the Transportation Research
Board, 2005.

[10] B. Anil Kumar, Lelitha Vanajakshi, and Shankar C. Subramanian. Bus travel time predic-
tion using a time-space discretization approach. Transportation Research Part C, 79:308–
332, 2017.

[11] D. H. Nam and D. R. Drew. Trafﬁc dynamics: methods for estimating freeway travel
Journal of Transportation Engineering,

times in real-time from ﬂow measurements.
122(3):185–191, 1996.

[12] Hilmi Berk Celikoglu. Flow-based freeway travel-time estimation: Dynamic path loading.

IEEE Transactions on Intelligent Transportation Systems, 14(2):772–781, 2013.

[13] J. Long, G. Ziyou, and W. Y. Szeto. Discretised link travel time models based on cumula-
tive ﬂows: Formulations and properties. Transportation Research Part-B, 45(1):232–254,
2011.

[14] Z Wall and D. J. Dailey. An algorithm for predicting the arrival time of mass transit vehi-
cles using automatic vehicle location data. In 78th Annual Meeting of the Transportation
Research Board, Washington D.C., USA, 1999. National Research Council.

[15] Chumchoke Nanthawichit, Takashi Nakatsuji, and Hironori Suzuki. Application of probe-
vehicle data for real-time trafﬁc-state estimation and short-term travel-time prediction on
a freeway. Transportation Research Record: Journal of the Transportation Research
Board, 1855:49–59, jan 2003.

[16] L. Y Chu, J.S. Oh, and W. Recker. Adaptive kalman ﬁlter based freeway travel time
estimation. In 84th Annual Meeting of the Transportation Research Board, Washington
D.C., USA, 2005. National Research Council.

[17] L Vanajakshi, S. C. Subramanian, and R. Sivanandan. Travel time prediction under hetero-
geneous trafﬁc conditions using global positioning system data from buses. IET Intelligent
Transporation Systems, 3(1):1–9, 2009.

[18] R. P. S Padmanaban, L. Vanajakshi, and S. C. Subramanian. Estimation of bus travel
time incorporating dwell time for APTS applications. In Intelligent Vehicles Symposium,
volume 1931-0587, pages 955–959, 2009.

[19] B. Anil Kumar, Lelitha Vanajakshi, and Shankar C. Subramanian. Pattern-based time-
discretized method for bus travel time prediction. Journal of Transportation Engineering,
Part A: Systems, 143(6):04017012, 2017.

30

[20] B. Dhivyabharathi, E. S. Hima, and L. Vanajakshi. Stream travel time prediction using
particle ﬁltering approach. Transportation Letters: The International Journal of Trans-
portation Research, 10(2):75–82, 2018.

[21] Z Zhang, Y. Wang, P. Chen, Z. He, and G. Yu. Probe data-driven travel time forecasting
for urban expressways by matching similar spatiotemporal trafﬁc patterns. Transportation
Research Part C: Emerging Technologies, 85:476–493, 2017.

[22] W. H Lin and J. Zeng. Experimental study on real-time bus arrival time prediction with
GPS data. Transportation Research Record: Journal of the Transportation Research
Board, 1666:101–109, 1999.

[23] C.M. Kuchipudi and S. I. Chien. Development of a hybrid model for dynamic travel-
time prediction. Transportion Research Record, Journal of Transportation reseach Board,
1885(1):22–31, 2003.

[24] H. Van Lint, S. P. Hoogendoorn, and H. J. V. Zuylenv. State space neural networks for
freeway travel time prediction. Artiﬁcial Neural networks - ICANN 2002 Lecture Notes
in Computer Science, 2415:1043–1048, 2002.

[25] A Shalaby and A. Farhan. Bus travel time prediction for dynamic operations control and
passenger information systems. In 83rd Annual Meeting of the Transportation Research
Board, Washington D.C., USA, 2004. National Research Council.

[26] R. Boel and L. Mihaylova. A compositional stochastic model for real time freeway trafﬁc

simulation. Transportation Research Part B, 40:319–334, 2006.

[27] X Fei, C. C. Lu, and K. Liu. A bayesian dynamic linear model approach for real-time
short-term freeway travel time prediction. Transportation Research Part C, Emerging
Technologies, 19(6)(6):1306–1318, dec 2011.

[28] R.M. Hage, B. David., F. Peyret., and D. Meizel. Unscented kalman ﬁlter for urban
In Proceedings of EWGT2012 - 15th Meeting of the

network travel time estimation.
EURO Working Group on Transportation, 2012.

[29] H Chen and H. Rakha. Real-time travel time prediction using particle ﬁltering with a non-
explicit state-transition model. Transportation Research Part C: Emerging Technologies,
43(1):112–126, 2014.

[30] M Celana and M. Lep. Bus arrival time prediction based on network model. In Procedia

Computer Science, volume 113, pages 138–145, 2017.

[31] C.H Wu, D. C. Su, J. Chang, C. C. Wei, J. M. Ho, K. J. Lin, and D. Lee. An ad-
vanced traveler information system with emerging network technologies. In Proceedings

31

of 6thAsia-Paciﬁc Conference Intelligent Transportation Systems Forum, pages 230–231,
Taipei, Chinese-Taipei., 2003.

[32] S.I J Chien, Y. Ding, and C. Wei. Dynamic bus arrival time prediction with artiﬁcial

neural networks. ASCE Journal of Transportation Engineering, 128(5):429–438, 2002.

[33] M Chen, X. B. Liu, and J. X. Xia. A dynamic bus arrival time prediction model based on
APC data. Computer Aided Civil and Infrastructure Engineering, 19:364–376, 2004.

[34] H. Liu, H. VanLint, H. VanZuylen, and K. Zhang. Two distinct ways of using kalman
In IEEE Intelligent Transportation Systems

ﬁlters to predict urban arterial travel time.
Conference, volume Toronto, Canada, 2006.

[35] J.W.C Van Lint. Incremental and online learning through extended kalman ﬁltering with
constraint weights for freeway travel time prediction. In IEEE Intelligent Transport Sys-
tems Conference (ITSC), pages 1041–1046, 2006.

[36] Y Bin, Y. Zhinzhen, and Y. Baozhen. Bus arrival time prediction using support vector

machines. Journal of Intelligent Transportation Systems, 10(4):151–158, 2006.

[37] L. Vanajakshi and L.R. Rilett. A comparison of the performance of artiﬁcial. neural net-
works and support vector machines for the prediction of trafﬁc speed. In IEEE Intelligent
Vehicles Symposium, 2004. Institute of Electrical and Electronics Engineers (IEEE), 2004.

[38] B Yu, W. H. K. Lam, and M. L. Tam. Bus arrival time prediction at bus stop with multiple

routes. Transportation Reserach Part - C, 19(6):1157–1170, 2011.

[39] N Julio, R. Giesen, and P. Lizana. Real-time prediction of bus travel speeds using trafﬁc
shockwaves and machine learning algorithms. Research in Transportation Economics,
59:250–257, 2016.

[40] T Yin, G. Zhong, J. Zhang, S. He, and B. Ran. A prediction model of bus arrival time at
stops with multi-routes. Transportation Research Procedia, 25:4623–4636, 2017.

[41] A. M Abdelfattah and A. M. Khan. Models for predicting bus delays. Transportation

Research Record, Journal of Transportation Research Board, 1623:8–15, 1998.

[42] J Patnaik, S. Chein, and A. Bladihas. Estimation of bus arrival times using APC data.

Journal of Public Transportation, 7(1):1–20, 2004.

[43] C.C. Schrader, A.L. Kornhauser., and L.M. Friese. Using historical information in fore-
casting travel times. In Proceedings of the 83rd Annual Transportation Research Board
Meeting, Washington, D.C., USA, 2004. National Research Council.

32

[44] J. Kwon and K. Petty. A travel time prediction algorithm scalable to freeway networks
with many nodes with arbitrary travel routes. In Proceedings of the 84th Annual Trans-
portation Research Board Meeting, Washington, D.C., USA, 2005. Natinal Research
Council.

[45] Y Ramakrishna, P. Ramakrishna, and R. Sivanandan. Bus travel time prediction using

GPS data. In Proceedings Map India, 2006.

[46] J. Kwon, B. Coifman, and P. Bickel. Day-to-day travel-time trends and travel-time pre-
diction from loop-detector data. Transportation Research Record: Journal of the Trans-
portation Research Board, 1717(15):120–129, 2000.

[47] R. Logendran and L. Wang. Dynamic travel time estimation using regression trees. Tech-
nical Report FHWA-OR-RD-09-09, Oregon Department of Transportation, Salem, Ore-
gon, USA, 2008.

[48] Z Yu, J.S. Wood, and V.V. Gayah. Using survival models to estimate bus travel times
and associated uncertainties. Transportation Research Part C: Emerging Technologies,
74:366–382, 2017.

[49] A Tirachini. Estimation of travel time and the beneﬁts of upgrading the fare payment tech-
nology in urban bus services. Transportation Research Part C: Emerging Technologies,
30:239–256, 2017.

[50] Y Zhou, L. Yao, Y. Chen, Y. Gong, and J. Lai. Bus arrival time calculation model based
on smart card data. Transportation Research Part C: Emerging Technologies, 74:81–96,
2017.

[51] B Yu, B. Yu, J. Lu, and Z. Yang. An adaptive bus arrival time prediction model.

In

Proceedings of the Eastern Asia Society for Transportation Studies, 2009.

[52] S Bae. Dynamic estimation of travel time on arterial roads by using automatic vehicle
location (AVL) bus as a vehicle probe. PhD thesis, Dept. Civil Eng., Virginia Polytechnic
Institute and State University, Blacksburg, VA., USA, 1995.

[53] J Haworth, J. Shawetaylor, T. Cheng, and J. Wang. Local online kernel ridge regression
for forecasting of urban travel times. Transportation Research Part C: Emerging Tech-
nologies, 46:151–178, 2014.

[54] 2010. Hamner, B. Predicting travel times with context-dependent random forests by mod-
eling local and aggregate trafﬁc ﬂow. In Proceedings of the ICDMW, Sydney, Australia,,
December 2010.

33

[55] S.H Park. Collinearity and optimal restrictions on regression parameters for estimating

responses. Technometrics, 23(3):289–295, 1981.

[56] W.N. Venables and B.D. Ripley. Modern Applied Statistics. Springer, New York, 2002.

[57] T Wolff. Travel time prediction: A comparison study on a common data set. Master’s

thesis, Norwegian University of Science and Technology, Norway, 2015.

[58] G. Chen, X. Yang, J. An, and D. Zhang. Bus-arrival-time prediction models: link-based

and section-based. Jouranl of Transportation Engineering, 138(1):60–66, 2012.

[59] T. Oda. An algorithm for prediction of travel time using vehicle sensor data.

In 3rd

International Conference on Road Trafﬁc Control, pages 40–44, 1990.

[60] B.V. Arem, M.J.M. Vlist., and M.R. Muste. Travel time estimation in the GERDIEN

project. International Journal of Forecasting, 13:73–85, 1997.

[61] S. Lee and D. B. Fambro. Application of subset autoregressive moving average model for
short-term freeway trafﬁc volume forecasting. Transportation Research Record: Journal
of the Transportation Research Board, 1678:179–188, 1999.

[62] M.P.D. Angelo, H.M. Al Deek., and M.C. Wang. Travel time prediction for freeway
corridors. In Proceedings of the 78th Annual Transportation Research Board Meeting.
National Research Council, 1999.

[63] A. Guin. Travel time prediction using a seasonal autoregressive integrated moving av-
erage time series model. In Proceedings of the IEEE Intelligent Transportation Systems
Conference, pages 493–498, 2006.

[64] R. R Bhandari. Bus arrival time prediction using stochastic time series and markov
chains. PhD thesis, Dept. Civil Eng., New Jersey Institute of Technology, Newark, USA,
2005.

[65] M. Andres and R. Nair. A predictive-control framework to address bus bunching. Trans-

portation Research Part B: Methodological, 104:123–148, 2017.

[66] S. Rashidi and P. Ranjitkar. Estimation of bus dwell time using univariate time series

models. Journal of Advanced Transportation, 49(1):139–152, 2015.

[67] S Xinghao, T. Jing, C. Guojun, and S. Qichong. Predicting bus real-time travel time basing
on both GPS and RFID data. Procedia - Social and Behavioral Sciences, 96:2287–2299,
2013.

[68] R. Jairam, B. Anil Kumar, Shriniwas S. Arkatkar, and Lelitha Vanajakshi. Performance
comparison of bus travel time prediction models across indian cities. Transportation
Research Record: Journal of the Transportation Research Board, 2672(31):87–98, 2018.

34

[69] S. V Kumar and Lelitha Vanajakshi. Pattern identiﬁcation based bus arrival time predic-
tion. Proceedings of the Institution of Civil Engineers-Transport, 167(3):194–203, 2012.

[70] Asha Anand, Gitakrishnan Ramadurai, and Lelitha Vanajakshi. Data fusion based trafﬁc
density estimation and prediction. Journal of Intelligent Transportation Systems: Tech-
nology, Planning, and Operations, 18(4):367–378, 2014.

[71] R.G. Chamberlain. Great circle distance between two points, 2014.

[72] M Rahman, S.C. Wirasinghe, and L. Kattan. Analysis of bus travel time distributions for
varying horizons and real-time applications. Transportation Research Part C: Emerging
Technologies, 86:453–466, 2018.

[73] G William Schwert. Why does stock market volatility change over time? The Journal of

Finance, 44(5):1115–1153, 1989.

[74] George Edward Pelham Box and Gwilym Jenkins. Time Series Analysis, Forecasting and

Control. Holden-Day, Incorporated, 1990.

[75] Peter J. Brockwell and Richard A. Davis. Introduction to Time Series and Forecasting.

Springer, 2nd edition, March 2002.

[76] P. Stoica. Prediction of autoregressive lognormal processes. IEEE Transactions on Auto-

matic Control, 25(2):292–293, Apr 1980.

[77] Steven M. Kay. Fundamentals of Statistical Signal Processing: Estimation Theory.

Prentice-Hall, Inc., Upper Saddle River, NJ, USA, 1993.

[78] Kunihiro Baba, Ritei Shibata, and Masaaki Sibuya. Partial correlation and conditional
correlation as measures of conditional independence. Australian & New Zealand Journal
of Statistics, 46(4):657–664, 2004.

[79] T.W. Anderson. An Introduction to Multivariate Statistical Analysis. Wiley Series in

Probability and Statistics. Wiley, 2003.

[80] Robert H. Shumway and David S. Stoffer. Time Series Analysis and Its Applications

(Springer Texts in Statistics). Springer-Verlag, Berlin, Heidelberg, 2005.

[81] Vijay K. Rohatgi and A. K. Md. Ehsanes Saleh. Random Variables and their Probability

Distributions. John Wiley & Sons, Inc, 2015.

[82] M. Kendall and A. Stuart. The advanced theory of statistics, volume 2: Inference and

Relationship. Charles Grifﬁn, London, 4th edition, 1977.

35

[83] B. Anil Kumar, Lelitha Vanajakshi, and Shankar C. Subramanian. A hybrid model based
method for bus travel time estimation. Journal of Intelligent Transportation Systems:
Technology, Planning, and Operations, 22(5), 2018.

[84] Vivek Kumar, B. Anil Kumar, Lelitha Vanajakshi, and S.C. Subramanian. Comparison
of model based and machine learning approaches for bus arrival time prediction. In Pro-
ceedings of the 93rd Annual Transportation Research Board Meeting, Washington D.C.,
USA, 2014. National Research Council, Transportation Research Board.

36

