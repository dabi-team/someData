Towards breaking the curse of dimensionality in (ro)vibrational

computations of molecular systems with multiple large-amplitude

motions

Gustavo Avila∗ and Edit M´atyus†

Institute of Chemistry, ELTE, E¨otv¨os Lor´and University

P´azm´any P´eter s´et´any 1/A 1117 Budapest, Hungary

(Dated: 26 March 2019)

Abstract

Methodological progress is reported in the challenging direction of a black-box-type variational

solution of the (ro)vibrational Schr¨odinger equation applicable to ﬂoppy, polyatomic systems with

multiple large-amplitude motions. This progress is achieved through the combination of (i) the

numerical kinetic-energy operator (KEO) approach of [E. M´atyus, G. Czak´o, and A. G. Cs´asz´ar, J.

Chem. Phys. 130, 134112 (2009)] and (ii) the Smolyak non-product grid method of [G. Avila and

T. Carrington, Jr., J. Chem. Phys. 131, 174103 (2009)]. The numerical representation of the KEO

makes it possible to choose internal coordinates and a body-ﬁxed frame best suited for the molecular

system. The Smolyak scheme reduces the size of the direct-product grid representation by orders

of magnitude, while retaining some of the useful features of it. As a result, multi-dimensional

(ro)vibrational states are computed with system-adapted coordinates, a compact basis- and grid-

representation, and an iterative eigensolver. Details of the methodological developments and the

ﬁrst numerical applications are presented for the CH4·
dimensionality.

Ar complex treated in full (12D) vibrational

9
1
0
2

r
p
A
9

]
h
p
-
m
e
h
c
.
s
c
i
s
y
h
p
[

1
v
8
8
5
4
0
.
4
0
9
1
:
v
i
X
r
a

∗ Gustavo Avila@telefonica.net
† matyus@chem.elte.hu

1

 
 
 
 
 
 
I.

INTRODUCTION

Molecular systems with many vibrational degrees of freedom, including multiple ﬂuxional

modes have been challenging for nuclear motion theory (also known as quantum dynamics)

for decades. These systems are diﬃcult to handle because 1) they require a curvilinear

coordinate representation, for which we might not have an analytic kinetic energy operator

(KEO) readily available; 2) their wave functions are spread over multiple wells of the po-

tential energy surface (PES); and 3) assume the evaluation of high-dimensional (sometimes

singular) integrals due to the multiple, coupled (curvilinear) internal degrees of freedom.

There are important, high-dimensional molecular systems with multiple, large-amplitude

motions. For example, molecular complexes belong to this class. Molecular complexes are

prototypes for molecular interactions and they can be probed in high-resolution spectroscopy

experiments. Weakly-bound complexes have a shallow PES valley, so they exhibit only a few,

low-energy transitions between bound states, but they usually have a rich predissociation

spectrum which can be probed in overtone spectroscopy experiments.

The theory of molecular complexes has been restricted to the explicit quantum mechanical

description of the inter-monomer modes, while the monomers were held ﬁxed, described with

some rigid, eﬀective structure [1, 2]. An explicit consideration of monomer-ﬂexibility eﬀects

[3, 4] has come to the focus only in recent years [5–7]. This is not surprising: adding

the monomer degrees of freedom to the quantum dynamics treatment rapidly increases the

vibrational dimensionality, while in molecular complexes, monomer ﬂexibility eﬀects are

usually small, so they can be averaged upon a ﬁrst look at the system. At the same time,

the ﬂexibility of monomers, through the kinetic and the potential energy couplings, plays

a central role in the energy transfer between the inter- and the intra-molecular degrees of

freedom during the (ro)vibrational and collision dynamics.

Motivation for the present work is provided by these ideas, but we hope that the

methodological developments described in this article will become useful for solving the

(ro)vibrational Schr¨odinger equation of (high-dimensional, ﬂoppy) molecular systems, in

general.

2

II. CURSE OF DIMENSIONALITY IN VIBRATIONAL COMPUTATIONS

We focus in the present work on the variational solution of the Schr¨odinger equation including

the (ro)vibrational Hamiltonian of D vibrational degrees of freedom, ξ = (ξ1, . . . , ξD),

ˆHvibΨi(ξ1, . . . , ξD) = EiΨi(ξ1, . . . , ξD) ,

(1)

where the vibrational wave function is as a linear combination of Nbas orthogonal basis

functions

Ψi(ξ1, . . . , ξD) =

Nbas

n=0
X

C i

nψn(ξ1, . . . , ξD),

(2)

and the expansion coeﬃcients C i

n are obtained as the elements of the eigenvectors of the

Hamiltonian matrix. The Hamiltonian matrix elements are computed with some appropriate

(multi-dimensional) integration scheme.

If the basis set is well chosen in this ﬁnite basis

representation (FBR) scheme, the lowest eigenvalues of the Hamiltonian matrix converge to

the exact energies by increasing Nbas. The most common way to build the multi-dimensional

basis functions is to use a direct-product ansatz

ψn(ξ1, . . . , ξD) =

ψ(χ)

nχ (ξχ)

D

χ=1
Y

(3)

constructed from the ψ(χ)

nχ (ξχ) orthogonal basis functions.

A. Curse of dimensionality due to the multi-dimensional vibrational basis

By adopting a direct-product basis set, the vibrational wave functions are represented as

a linear combination

N max
1

N max
D

D

Ψi(ξ1, . . . , ξD) =

. . .

C i

n1,...,nD

ψ(χ)

nχ (ξχ) ,

(4)

n1=0
X

nD=0
X

χ=1
Y

the vibrational dimensionality, Nbas =

in which the number of terms (multi-dimensional basis functions) scales exponentially with
D
χ=1(N max
is not a problem, but many challenging systems are high dimensional. Our example system,
CH4·
we pick 10 basis functions per coordinate (a reasonable starting point if the coordinates are

Ar has twelve vibrational degrees of freedom. For a 12-dimensional (12D) problem, if

χ + 1). For low-dimensional systems this

Q

equally coupled), the number of product basis functions will be 1012. In this representation,

3

we would need to store a vector with 1012 elements to represent a single vibrational state,

which would require ca. 7.3 TB of memory in double precision arithmetics. For this reason,

beyond ca. 9 vibrational dimensions, it is necessary to develop and use methods which

attenuate the curse of dimensionality in the basis set.

There are diﬀerent strategies for breaking the exponential growth of the vibrational basis.

The ﬁrst option is to improve the quality of the basis functions in order to decrease the num-

ber of functions per coordinate, at least for a subset of the coordinates. The second option

is to ﬁnd a way to identify and discard the basis functions from the direct-product basis

set, which have little eﬀect on the accuracy of the computed eigenvalues. The ﬁrst alter-

native is eﬃciently realized by the multi-conﬁguration time-dependent Hartree (MCTDH)

method [8, 9], the canonical polyadic (CP) approach [10–12] or in a contracted basis rep-

resentation obtained by solving reduced-dimensionality eigenproblems [13–15]. The second

alternative is achieved by ﬁnding physically motivated restrictions on the basis set indices.

These restrictions can be as simple as the selection of an appropriate multi-polyad [16, 17],

f (n1, . . . , nD)

≤

b, for which the wave-function expansion reads as

Ψi(ξ1, . . . , ξD) =

D

C i

n1,...,nD

ψ(χ)

nχ (ξχ) ,

(5)

Xf (n1,...,nD)≤b

χ=1
Y

This basis-pruning strategy will be used later in this work. More elaborate basis-pruning

restrictions are used, for example, in the MULTIMODE program [18, 19].

B. Curse of dimensionality due to multi-dimensional integrals

Reducing the number of the multi-dimensional basis functions solves only half of the

problem. In (ro)vibrational computations, multi-dimensional integrals must be evaluated to

construct the Hamiltonian matrix.

There are two common ways to cope with the integrals problem. The ﬁrst option is

to expand the Hamiltonian in a Sum-of-Products form (SOP). For example, the potential

energy in a SOP form is

M max
1

M max
D

ˆV (ξ) =

. . .

Am1,...,mD

m1=0
X

mD=0
X

(χ)
mχ (ξχ) .

D

V

χ=1
Y

(6)

Using the SOP form, multi-dimensional integrals are obtained as the sum of products of

4

1-dimensional (1D) integrals,

ψ(χ)
n′
χ | V

(χ)
mχ |

h

ψ(χ)
nχ i

=

ψ(χ)
n′
χ

(ξχ)

Z
Kquad

V

(χ)

mχ (ξχ)ψ(χ)

nχ (ξχ) dξχ

wχ,kχψ(χ)
n′
χ

(ξχ,kχ)

V

≈

Xkχ=1

(χ)

mχ (ξχ,kχ)ψ(χ)

nχ (ξχ,kχ) ,

(7)

which is evaluated with a 1D numerical quadrature using the wχ,kχ and ξχ,kχ quadrature

weights and points, respectively, deﬁned for the ξχ coordinate (in this work, we account

for the Jacobian in the wave function). The integrals converge to their exact value upon

the increase of the number of quadrature points, Kquad. The SOP form is useful when a

small number of terms is suﬃcient in Eq. (6) to represent the Hamiltonian. This form

is usually employed in MCTDH and in the CP method [8–12]. There are methods which

can ﬁnd an excellent ‘basis set’ for the SOP representation of the Hamiltonian [20]. If the

SOP representation, however, requires an excessive number of function evaluations over a

multi-dimensional grid of the vibrational coordinates, the exponential scale up with the

dimension is re-introduced. This feature is related to the fact that a SOP representation of

the Hamiltonian can be as expensive as the representation of the multi-dimensional wave

function. In any case, an eﬀective way for attenuating this type of curse of dimensionality

was proposed in Ref. [20].

As an alternative to a sum-of-product representation of the Hamiltonian, one can ap-

proximate it with a truncated multi-mode expansion of nth-order terms [12, 18, 19, 21]. For

example, a ﬁve-mode expansion of the the potential energy is

V (ξ1, . . . , ξD) =

V i(ξi)

D

i=1
X
D

D

+

+

+

+

V i,j(ξi, ξj)

i=1
X
D

j=i
X
D

D

V i,j,k(ξi, ξj, ξk)

i=1
X
D

j=i
X
D

Xk=j
D

D

V i,j,k,l(ξi, ξj, ξk, ξl)

i=1
X
D

j=i
X
D

Xk=j
D

Xl=k
D

D

i=1
X

j=i
X

Xk=j

Xl=k

Xm=l

5

V i,j,k,l,m(ξi, ξj, ξk, ξl, ξm) .

(8)

This expansion is exact if n = D, but under certain circumstances (also depending on the

ξ1, . . . ξD coordinates) it is very well converged with n < D. Using this approximation, the

integrals are evaluated using a D = 1, 2, . . . , n dimensional direct-product Gauss quadrature,

and thereby, the curse of dimensionality is attenuated.

If we want to use the Hamiltonian directly, without approximating or expanding it, we

have to tackle the direct evaluation of multi-dimensional integrals by multi-dimensional

quadrature. In this case, the integral of the potential energy over a multi-dimensional basis

set is evaluated as

D

. . .

Z

Z
Kquad

Yχ′=1

D

≈

K=1
X

wK

Yχ′=1

ψ(χ′)
n′
χ′

ψ(χ′)
n′
χ′

(ξχ′)V (ξ1, . . . , ξD)

D

χ=1
Y

(ξχ′,kχ′ )V (ξ1,k1, . . . , ξD,kD)

ψ(χ)

nχ (ξχ) dξ1 . . . dξD

ψ(χ)

nχ (ξχ,kχ) ,

(9)

D

χ=1
Y

where wk is the multi-dimensional quadrature weight for the ξχ,kχ points, we used the con-

densed summation index K

↔

(k1, k2, . . . , kD). The integral approaches its exact value as

the Kquad number of points is increased. The most common multi-dimensional quadrature

is the multi-dimensional direct-product quadrature

. . .

Z

Z

F (ξ1, . . . , ξD) dξ1 . . . dξD ≈

K max
1

K max
D

. . .

w1,k1 . . . wD,kDF (ξ1,k1, . . . , ξD,kD) , (10)

Xk1=1

XkD=1

where wχ,kχ and qχ,kχ (χ = 1, . . . , D) are the 1D quadrature weights and points for the χth

coordinate. 1D quadrature rules are most often Gauss (G) quadrature rules, which integrate

exactly

w(ξ)F (ξ) dξ =

Z
and d = 2(K G

quad −

K G

quad

Xk=1

wG

k F (ξG

k ),

2(K G

quad−1)

for any F (ξ) =

Anξn ,

(11)

n=0
X

1) is called the (1D) accuracy of the Gauss quadrature.

A multi-dimensional direct-product quadrature integration suﬀers from a similar curse

of dimensionality problem as a multi-dimensional direct-product basis set: the number of

quadrature points, Kquad =

D
χ=1 K max

χ

, increases exponentially with the vibrational dimen-

sionality. To continue the 12D example from the previous section in which we had 10 basis

Q

functions per coordinate, we choose 13 quadrature points per coordinate (a reasonable value)

to evaluate the integrals. Then, the number of points in a direct-product grid is 2.33

1013.

×

Storage of this many double-precision numbers would require 170 TB.

6

As it was explained earlier, the curse of dimensionality in the basis set can be attenuated

by identifying and discarding the product basis functions, which are not necessary for the

desired precision of the vibrational states. Then, we may think about attenuating the curse

of dimensionality in the quadrature grid by using grids which have a non-product structure.

In general terms, the application of non-product quadrature grids can be justiﬁed, if the

integrand I(ξ1, . . . , ξD) is smooth, i.e., it can be expanded with respect to a pruned, product

basis set:

I(ξ1, . . . , ξD) =

In1,...,nD

Xf (n1,...,nD)≤b

Φ(χ)

nχ (ξχ) .

D

χ=1
Y

(12)

For smooth functions, it makes sense to distinguish between necessary product basis func-

tions:

D

χ=1
Y

Φ(χ)

nχ (ξχ) with f (n1, . . . , nD)

b

≤

and non-necessary product basis functions:

Φ(χ)

nχ (ξχ) with f (n1, . . . , nD) > b .

D

χ=1
Y

(13)

(14)

The total number of necessary and non-necessary product basis functions scales exponen-

tially with the dimension and this is the reason why the total number of product quadrature

grid points, which integrate the overlap of all these functions exactly, also scales exponen-

tially with the dimension. If we need to integrate accurately only the necessary product

basis functions, the number of which does not grow exponentially with the dimensionality,

it is possible to ﬁnd a multi-dimensional quadrature, which integrates exactly only the nec-

essary basis functions and which does not grow exponentially with the dimension. In such

an approach, the curse of dimensionality in the integration grid can be attenuated, i.e.,

. . .

Z

Z

F (ξ1, . . . , ξD) dξ1 . . . dξD ≈

with Kquad ≪

K max
χ

D

χ=1
Y

Kquad

m=1
X

wmF (ξ1,m1, . . . , ξD,mD)

(15)

during the course of the evaluation of the Hamiltonian terms (without approximating by

some expansion). Optimal non-product quadratures exist for special cases, two of them are

explained in the following paragraphs.

7

1. An optimal, two-dimensional, non-product quadrature

The most popular non-product quadrature grid is probably the Lebedev quadrature de-

signed to integrate spherical harmonics [22]. Lebedev grids are used in density functional

theory [23] and they have been used also in rovibrational computations [24]. In particular,

if we want to obtain the exact value of all integrals, related to the overlap of the spherical

harmonics functions, by numerical integration

π

2π

dθ

dφ Yl,m(θ, φ)Yl′,m′(θ, φ) sin(θ)

(16)

0
Z

0
Z
with l, l′

lmax

and m, m′

lmax,

≤

≤

we would need to use a total number of 2(lmax + 1)2 grid points in the two-dimensional

direct-product grid composed of Gauss–Legendre quadrature points for the θ and Gauss–

Chebyshev (ﬁrst kind) quadrature points for the φ coordinate. Note that in the expansion

of the Yl,m(θ, φ)Yl′,m′(θ, φ) sin(θ) integrand in terms of the product-basis functions, one has
l′. By taking into account these two re-
l and m′

to comply with the two restrictions, m

≤

≤

strictions, a (smaller) non-product quadrature grid, called Lebedev grid, can be constructed

for the numerical integration which includes only

NLeb ∼

4
3

(lmax + 1)2

(17)

points, instead of the 2(lmax + 1)2 points of the 2D direct-product grid. For example for

lmax = 5, there are a total number of 36 spherical harmonics functions. The calculate exactly

the overlap of these functions, we would need 2(5 + 1)2 = 72 points in the 2D direct-product

grid, whereas it is suﬃcient to use 50 (

4/3

(5 + 1)2 = 48) Lebedev points [22]. Note that

·
there is not any general formula for the Lebedev quadrature, but the weights and points are

∼

tabulated for several two-dimensional maximum accuracy values.

2. An optimal, three-dimensional, non-product quadrature

Our next example is about the calculation of the exact value of the overlap integrals in

a numerical integration scheme, for products of harmonic oscillator functions,

∞

∞

∞

Hl(q1)Hl′(q1)Hm(q2)Hm′(q2)Hn(q3)Hn′(q3) e−q2

1−q2

2−q2

3 dq1 dq2 dq3

−∞ Z
Z

−∞

−∞ Z
with the restrictions l + n + m

4 and l′ + n′ + m′

5 ,

≤

≤

8

(18)

(19)

where Hn is the nth Hermite polynomial. The smallest, 3D Gauss–Hermite direct-product

grid, which recovers the exact value for all these integrals contains 53 = 125 points. By

explicitly considering the restrictions in Eq. (19), we may realize that there are only 35

diﬀerent product functions in the integrand. The smallest non-product grid (for a maximum

multi-dimensional accuracy of 9), which recovers the exact value of the integrals for the

possible integrands consists of only 77 points [25]. We note that the corresponding Smolyak

grid consists of 93 points, which is less than the direct-product grid, but more than the

optimal non-product grid.

In spite of the fact that the optimal multi-dimensional, non-product quadratures use the

smallest number of points, they have some handicaps. First, the construction of optimal,

non-product quadratures may be cumbersome. There are only a limited number of cases for

which the optimal multi-dimensional quadrature is tabulated in the literature (in practice,

limited to D = 2 or 3 for the available cases) [25]: the points and weights are available only

for certain types of polynomials and for limited values of a maximum multi-dimensional

accuracy. Second, optimal non-product quadratures lack any structure, which is a serious

disadvantage in rovibrational applications [24]. If a non-product grid has some structure

(reminiscent of a direct-product grid), then it can be used to compute sums over the 1D

quadrature points sequentially, which is an important algorithmic element in eﬃcient vari-

ational vibrational approaches.

3. The Smolyak scheme for non-product grids with a structure

There is a simple way to construct non-product quadrature grids, ﬁrst proposed by the

Russian mathematician Sergey A. Smolyak. The Smolyak grid may be slightly larger than

the optimal non-product grid but it retains some useful features of direct-product grids.

The Smolyak scheme was ﬁrst adopted for solving the (ro)vibrational Schr¨odinger equation

by Avila and Carrington in 2009 [16, 17] who exploited that the Smolyak grid is built

from a sequence of quadrature rules, and its special structure makes it possible to compute

the potential and kinetic energy matrix-vector products by doing sums sequentially. It is

possible to combine the Smolyak algorithm with optimal non-product grids of Stroud [25],

i.e., non-product Smolyak quadrature grids of high-dimensional systems can be constructed

from sequences of Stroud-kind non-product quadratures (if the desired Stroud quadrature

9

is available). Although the Stroud–Smolyak grids have less structure, they require fewer

points than Smolyak quadratures built from 1D quadrature rules. This direction has been

pursued in (ro)vibrational computations by Lauvergnat since 2014 [26].

III. DEFINITION OF THE (RO)VIBRATIONAL HAMILTONIAN IN GENIUSH

The GENIUSH protocol, as it was proposed in 2009 [27], aimed for the development of

a universal and exact procedure for the (near-)variational solution of the (ro)vibrational

Schr¨odinger equation. Its central part is the numerical construction of the kinetic energy

terms over a grid—thereby, the burdensome derivation and implementation of the kinetic

energy operator for various molecular and coordinate choices was eliminated. The GENIUSH

program was developed using the discrete variable representation (DVR) [28], and it suﬀered

from the curse of dimensionality (Section II). The present work aims for the elimination of

this bottleneck, both in respect of the basis and the grid representations, using the ideas

ﬁrst described by Avila and Carrington in 2009 [16].

A. Numerical representation of the kinetic-energy operator

The GENIUSH program determines the KEO coeﬃcients numerically, over a grid, from

the user’s deﬁnition of the vibrational coordinates, ξi (i = 1, 2, . . . , D) (and body-ﬁxed frame

deﬁnition, which is relevant for rovibrational computations). Arbitrary coordinates and

frames can be deﬁned by writing down the Cartesian coordinates (in the body-ﬁxed frame)

in terms of the vibrational coordinates, ξi (i = 1, 2, . . . , D). From this coordinate conversion

subroutine (written by the user if not yet available in the code), the program numerically
R(D+3)×(D+3), from the vibrational and the

evaluates the mass-weighted metric tensor, g

∈
rotational t vectors over the coordinate grid. The vibrational t vectors are obtained by

two-sided ﬁnite diﬀerences, for which a step size of 10−5

10−7 atomic units has been used.

−

In principle, the numerical but exact diﬀerentiation scheme of Yachmenev and Yurchenko

[29] (using chain rule sequences and the derivatives of ‘all’ possible elementary functions and

thereby extending Ref. [30]) could also be used to eliminate the numerical diﬀerentiation

step.

The G matrix is calculated by inverting g, G = g−1

R(D+3)×(D+3), over the grid points

∈

10

of the vibrational coordinates. In this notation the last three rows and columns of g and

G correspond to the rotational coordinates. The vibrational kinetic-energy operator has

usually been written in the Podolsky form [31]

ˆT v
Pod =

1
2

−

D

D

i=1
X

j=1
X

˜g−1/4 ∂
∂ξi

Gi,j ˜g1/2 ∂
∂ξj

˜g−1/4

(20)

with ˜g = detg, because it requires the calculation of only ﬁrst coordinate derivatives. The

volume element for this Hamiltonian [27, 31, 32], and for all its rearranged variants, Eqs. (21),

(24), (51) appearing later in this article, is dV =

D
i=1 dξi. Ref. [27] also used a general but

“rearranged” form of the (ro)vibrational Hamiltonian

Q

ˆT v
rearr =

1
2

−

∂
∂ξi

Gi,j

∂
∂ξj

+ U

with U =

=

1
32

1
32

which can be further rearranged to

∂˜g
∂ξk

∂˜g
∂ξl

+ 4

Gkl
˜G2

∂ ˜G
∂ξk

∂ ˜G
∂ξl −

4

∂
∂ξk (cid:18)
∂
∂ξk  

Gkl
˜g

Gkl
˜G

,

∂˜g
∂ξl (cid:19)(cid:21)
∂ ˜G
∂ξl !#

,

D

D

i=1
X
D

j=1
X
Gkl
˜g2

Xkl=1 (cid:20)

D

Xkl=1 "

ˆT v
frearr =

with Bj =

1
2

−

D

i=1
X

Gi,j

∂
∂ξi

∂
∂ξj −

1
2

Bj

∂
∂ξj

+ U

D

j=1
X

D

D

j=1
X

Gi,j ,

i=1
X
∂
∂ξi

(21)

(22)

(23)

(24)

(25)

This last form was used by Lauvergnat and Nauts in their numerical KEO approach [30].

Eqs. (21)–(23) and (24)–(25) require third-order derivatives of the coordinates, which are

obtained in GENIUSH by using quadruple precision arithmetic to ensure numerical stabil-

ity for the ﬁnite diﬀerences. All functions appearing next to the diﬀerential operators in

Eqs. (20)–(25) have been available from the original implementation [27], so we were able

to change between diﬀerent KEO representations, which has turned out to be necessary for

this work (vide infra).

As a ﬁrst step for implementing the Smolyak algorithm, we had to replace the original

DVR implementation with FBR, because we wanted to discard functions from the direct

product using simple, physical arguments, e.g., to restrict the basis to a certain (multi)

polyad, Eq. (5).

11

It is important to notice that the application of the Podolsky form, Eq. (20), assumes the

insertion of multiple (truncated) resolutions of identities in the basis during the construction

of the KEO representation. In our earlier DVR applications, this did not cause any problem,

but since we are aiming for a compact FBR, an accurate representation of the Podolsky form

could be ensured only if an auxiliary basis set was introduced to converge the completeness

relation

ˆI

≈

Naux

n=0
X

n

ih

n

.

|

|

For example, in a 3D FBR computation with a basis set

n1, n2, n3i

|

, 0

n1 ≤

≤

N max
1

, 0

n2 ≤

≤

N max
2

, 0

n3 ≤

≤

N max
3

,

the matrix-vector products

v1 = ˜g−1/4v0

v2 = Gi,j ˜g1/2 ∂
∂ξj

v1

(26)

(27)

(28)

would have to be expanded with respect to a larger, basis

|

n1, n2, n3i
n1 ≤
0

≤

:

N max

1 + m, 0

n2 ≤

≤

N max

2 + m, 0

n3 ≤

≤

N max

3 + m ,

(29)

where m is determined by the coordinate-dependence of the ˜g−1/4 and Gi,j ˜g1/2 multi-

dimensional functions. For the example of the H2O molecule, m = 4 was found to be

suﬃcient to compute the ﬁrst ﬁfty vibrational states. So, in this 3D problem, the use of

an auxiliary basis set introduces only a modest increase in the computational cost. For a

12D problem, however, an m = 4 choice would increase the basis space by two orders of

magnitude!

For this reason, we will use (the rearranged and) the fully rearranged form of the KEO,

Eqs. (21)–(24), which did not require the introduction of any additional (auxiliary) functions

in an FBR computation. Further details concerning the matrix representation of the KEO,

including a pragmatic ‘treatment’ of the KEO singularities, ubiquitous in ﬂoppy systems,

will be explained in Section IV D.

12

1. Deﬁnition of the coordinates for the example of CH4·

Ar

), ξ2 = θ

The vibrational dynamics of the CH4·
∞

[0, +
∈
normal coordinates of the isolated CH4 molecule, ξ3+i = qi ∈
At the reference structure (necessary to deﬁne the normal coordinates), the methane was

∈
[0, 2π) spherical coordinates, and the nine dimensionless

Ar complex was described using the ξ1 = R

) (i = 1, . . . , 9).

[0, π], ξ3 = φ

−∞

, +

∞

∈

(

oriented in the most symmetric fashion in the Cartesian space with the C atom is at the

origin (this orientation also ensured that the KEO singularity is not at the equilibrium

structure of the complex):

H1 : ceq

1 = (r, r, r) ,

H2 : ceq

2 = (r,

r,

H3 : ceq

3 = (

H4 : ceq

4 = (

r) ,

−
r, r) ,

−
r,

−
r, r,

−

−

r) ,

−

(30)

and r = req

CH = 2.052 410 803 bohr was the equilibrium C–H distance corresponding to the
PES of Ref. [33]. The GENIUSH program evaluates functions appearing in the KEO from a

coordinate conversion routine in which the instantaneous (body-ﬁxed) Cartesian coordinates

must be speciﬁed in terms of the internal coordinates. The Cartesian positions of the carbon

and the hydrogen atoms were calculated from the q1, . . . , q9 normal coordinate values as

9

ǫi = ceq

iǫ +

lǫi,jqj

j=1
X

(31)

where ǫ = x, y, z and i = 1, 2, . . . 5, and the Cartesian coordinates of the Ar atom, ǫ6

(ǫ = x, y, z), were measured from the center of mass of the methane moiety and were

obtained as

x6 = R sin θ cos φ

y6 = R sin θ sin φ

z6 = R cos θ .

(32)

In the last step of the calculation of the Cartesian coordinates, the center of mass of the

complex was shifted to the origin. The orientetation of the body-ﬁxed frame corresponding

to the coordinates just described corresponds to the orientation of the frame used to deﬁne

the methane’s normal coordinates. A more sophisticated choice of the body-ﬁxed frame

can be useful to make rovibrational computations eﬃcient. In the present work however,

we focus on the computation of the vibrational states. We used the atomic masses [34]

13

m(H) = 1.007 825 032 23 u, m(C) = 12 u, and m(Ar) = 39.962 383 123 7 u throughout this

work.

2. Potential energy surface

Due to the lack of any full-dimensional methane-argon potential energy surface, we used

the sum of the 3D intermolecular potential energy surface of Ref. [35, 36] and the 9D

methane PES from Wang and Carrington [33]. This setup allows us to study the kinetic

coupling of this weakly bound complex. Should a full-dimensional PES become available,

the computations can be adapted to it.

IV.

IMPLEMENTATION OF THE SMOLYAK SCHEME IN GENIUSH

A. Pruning the basis functions

For the example of the CH4·

Ar complex described with the (R, θ, φ, q1, . . . , q9) vibrational

coordinates deﬁned in Section III A 1, we chose the following 1D basis functions:

(α) gen-

L

eralized Laguerre basis functions (with α = 2) or tridiagonal Morse basis functions for R;

Legendre basis functions (and variants of them) or Jacobi associated basis functions for θ;

Fourier functions, composed of cos(nφφ), sin(nφφ), for φ; and harmonic oscillator functions

for the q1, . . . , q9 methane normal coordinates. As a result, the direct-product expansion of

the vibrational wave function can be written as

Ψi(R, θ, φ, q1, . . . , q9) =
N max
φ

N max
R

N max
θ

b

b

. . .

C i

nR,nθ,nφ,nq1 ,...,nq9

nR=0
X

nθ=0
X

nφ=0
X

nq1 =0
X

nq9 =0
X

nR (R)ψ(θ)
ψ(R)

nθ (θ)ψ(φ)

nφ (φ)ψ(q1)
nq1

(q1) . . . ψ(q9)
nq9

(q9) .

(33)

This direct-product basis representation, for the typical values of N max

θ > 20,
107 functions. To reduce the basis set size, we

R > 10, N max

N max

φ > 15, and b > 2, would include > 5.90

·

14

prune the basis representation of the methane fragment

Ψi(R, θ, φ, q1, . . . , q9) =
N max
φ

N max
θ

N max
R

nR=0
X

nθ=0
X

nφ=0
X

Xnq1 +...+nq9 ≤b

C i

nR,nθ,nφ,nq1 ,...,nq9

nR (R)ψ(θ)
ψ(R)

nθ (θ)ψ(φ)

nφ (φ)ψ(q1)
nq1

(q1) . . . ψ(q9)
nq9

(q9) .

(34)

by replacing the 0 and b lower and upper summation limits of each normal coordinate with

the basis-pruning condition

nq1 + . . . + nq9 ≤

b

(b

∈

N0) ,

(35)

which we call ‘standard’ pruning. This condition is a natural choice for normal coordinates

and harmonic oscillator basis functions, which provide a good ‘zeroth-order’ model. This

standard pruning, equivalent to choosing a big polyad of states, allows us to discard basis

functions, for which the coupling between the intramolecular basis functions (through the full

Hamiltonian) is small and for which the zeroth-order energies are very diﬀerent. The larger

the b value in Eq. (35), the more accurate (higher excited) vibrational states of methane

are obtained. (If we focused on the computation of highly excited methane states, it would

be better to use a more sophisticated pruning condition.) For the intermolecular basis set

ψR,nR(R)ψθ,nθ(θ)ψφ,nφ(φ) we do not introduce any pruning, because the selected functions

are not close to any zeroth-order approximate basis set for this system, so we cannot discard

any of the functions based on simple arguments. Nevertheless, standard pruning of the

methane part already reduces the basis set substantially. The storage of one vector in the

direct-product basis set with 10 basis functions per coordinate would require ca. 8 TB of

memory, while using standard pruning, Eq. (35), reduces this value to 0.39 GB.

B. Pruning the grid with the Smolyak scheme

The GENIUSH program computes the values of the Gi,j, Bi, and U multi-dimensional

functions of the KEO at multi-dimensional points of the vibrational coordinates. Since we

do not use any interpolation procedure to ﬁt Gi,j, Bi, and V +U to special analytic functions,

a multi-dimensional quadrature grid is necessary to obtain the integrals.

It is straightforward to design non-product quadrature grids for the evaluation of the

multi-dimensional integrals of the Hamiltonian operator with the standard basis-pruning

15

condition, Eq. (35). For the example of the CH4·
nate deﬁnition and Sec. IV A for the basis set and the pruning condition), the 12D Smolyak

Ar complex (see Sec. III A 1 for the coordi-

integration operator of order H [16, 17], is

12

∆ ˆQiχ
χ

ˆQ(12, H) =

=

Xσg(i)≤H

Xσg(i)≤H

⊗

χ
Y
∆ ˆQiR

∆ ˆQiθ

θ ⊗

∆ ˆQiφ

φ ⊗

∆ ˆQiq1

q1 ⊗

. . .

⊗

∆ ˆQiq9

q9 ,

(36)

R ⊗

with iχ = 1, 2, 3, 4, . . .

and χ = 1(R), 2(θ), . . . , 12(q9) ,

and the general grid-pruning condition is

σg(i)

≤

H : gR(iR) + gθ(iθ) + gφ(iφ) + gq1(iq1) + . . . + gq9(iq9)

H .

≤

(37)

The iχth incremental operator is deﬁned as

∆ ˆQiχ

χ = ˆQiχ

χ −

ˆQiχ−1
χ

(38)

with ˆQ0

χ = 0. The action of the iχth operator, ˆQiχ

χ , on an f function is its (numerical,

quadrature) integral:

ˆQiχ

χ f (ξχ) =

mχ(iχ)

m=1
X

wiχ

χ,mf (ξiχ

χ,m)

(39)

corresponding to the wiχ

χ,m quadrature weights and qiχ

χ,m quadrature points, m = 1, . . . , mχ(iχ)

within the iχth grid.

We also note that Eq. (36) can be written as a linear combination of the 1D integration

operators (instead of using the incremental operators) as

ˆQ(12, H) =

Ci

12

ˆQiχ
χ

⊗

Xσg(i)≤H

=

χ=1
Y
CiR,iθ,iφ,iq1 ,...,iq9

Xσg(i)≤H
with iχ = 1, 2, 3, 4, . . .

ˆQiR

R ⊗

ˆQiθ

θ ⊗

ˆQiφ

φ ⊗

ˆQiq1

q1 ⊗

. . .

⊗

ˆQiq9
q9

and χ = 1(R), 2(θ), . . . , 12(q9) ,

(40)

which allows us to better understand the structure of the Smolyak grid. The Smolyak

quadrature grid is a linear combination of product quadrature grids with diﬀerent 1D ac-

curacies, while it has a smaller number of points than the product grid

16

12
iχ=1

ˆQ

imax
χ
χ =

⊗

Q

ˆQimax

R

R ⊗

ˆQimax

θ

θ ⊗

ˆQ

imax
φ
φ ⊗

ˆQ

imax
q1
q1 ⊗

. . .

⊗

imax
ˆQ
q9
q9

, where imax

χ = H

χ′6=χ gχ′

−

(1) is determined by

the smallest value of the pruning function for the other coordinates, Eq. (42). If a product
nq1 (q1) . . . f (q9)
basis function, f (R)
nθ (θ)f (φ)
nφ (φ)f (q1)
nq9 (q9), can be integrated exactly by the
ˆQiq1
ˆQiφ
product quadrature grid ˆQiR
ˆQiθ
. . .
q9 , that product basis function is
also exactly integrated by the Smolyak quadrature grid ˆQ(12, H), because it comprises this

nR (R)f (θ)

q1 ⊗

ˆQiq9

R ⊗

φ ⊗

θ ⊗

P

⊗

smaller product grid [37].

To ensure accurate integration, we have to tune three factors: a) the pruning function,

gχ(iχ) (which must be a monotonic increasing function); b) the value of H (the larger, the

better); and b) the number of grid points, mχ(iχ), in the 1D grids determined by the smallest

possible Smolyak grid which integrates accurately the Hamiltonian for a selected, pruned,

multi-dimensional basis set.
For the case of CH4·

Ar, the basis-set pruning condition was (Section IV A)

N max
R

0

0

≤

≤

N max
θ

nR ≤
nθ ≤
nφ ≤
nq1 + nq2 + nq3 + nq4 + nq5 + nq6 + nq7 + nq8 + nq9 ≤
i.e., the intermolecular basis was retained in its product form and pruning was introduced

N max
φ

(41)

≤

≤

b,

0

0

for the methane fragment. The corresponding non-product grid includes the intermolecular

grid in its product form, and a pruned intramolecular grid implemented using following

grid-pruning functions:

gχ(iχ) =

1 , for χ = R, θ, φ




i ,

for χ = q1, . . . , q9 ,

i = 1, 2, 3, . . .

The corresponding ˆQiχ

χ integration operators are chosen as



M max
ˆQ
χ
,
χ
ˆQmχ(iχ)
χ

for χ = R, θ, φ

, for χ = q1, . . . , q9 ,

with mχ(iχ) = 1, 3, 3, 7, 9, 9, 9, 9, 17, 19, 19, 19, 31, 33, 41, 41, . . .

for iχ = 1, 2, 3, . . . , respectively.

ˆQiχ

χ = 



(42)

(43)

This choice of the integration operators allowed us to use the 12D Smolyak operator for the

special case when the ﬁrst three degrees of freedom are described with a direct-product grid.

17

ˆQM max

R

R

, ˆQM max

θ

θ

M max
, and ˆQ
φ
φ

label the integration operators corresponding to the spherical

degrees of freedom, and each of them is constructed with a Gauss quadrature rule with

points and dχ = 2M max

1 maximum accuracy.

χ −

M max
χ
The ˆQmχ(iχ)
χ

(χ = q1, . . . , q9) operators, corresponding to the normal coordinates, are

constructed using a nested Hermite quadrature with a maximum degree of dχ(iχ)

2iχ −

1,

≥

and dχ(iχ) = 1, 5, 5, 7, 15, 15, 15, 15, 17, 29, 29, 29, 31, 33, 61, 61, . . . for the iχ = 1, 2, 3 . . .

sequence of Eq. (43) (also note that the same quadrature is used for each dimensionless
normal coordinate). Nesting means that all quadrature points of the quadrature rule ˆQj
χ
also appear in the quadrature rule ˆQj+1
χ . It is important that we need to have nested grids to

be able to use a Smolyak quadrature eﬃciently. For this reason, we always use the smallest

grid which is nested, e.g., for iχ = 2 we use a three-point quadrature, mχ(2) = 3, in Eq. (43),

because there is not any nested, two-point Hermite quadrature. Nested Hermite grids are

listed in tables, see for example Ref. [38].

In this paragraph, we compare the orders of magnitudes for a direct-product and for a

Smolyak grid just deﬁned for the example of CH4·
product basis set with 0
≤
b = 3 for the methane’s degrees of freedom. The smallest 12D
nq1 . . . + nq9 ≤

9 functions for the spherical degrees of freedom,

Ar. Let us assume, that we have a direct-

nR, nθ, nφ ≤

and 0

≤

product Gauss grid which gives correctly the overlap integrals for this basis set includes

103

49 = 2.62

108 points. To integrate the overlap for this basis set exactly, we need to

·

·

choose H = 15 for the 12D Smolyak grid, which includes 103

871 = 8.71

·

×

105 points, almost

three orders of magnitude less than the 12D direct-product Gauss grid. Certainly, an even

more signiﬁcant reduction in the grid size (in comparison with a direct-product grid) can be

achieved, if a larger number of degrees of freedom is included in the pruning [39].

The smallest necessary value of H can be calculated from the basis-pruning condition and

the value of b as follows. To compute exactly an overlap integral of 2b polynomial degree,
it is necessary to have a maximum degree of 2iχ −
the grid-pruning condition, Eq. (43) and the fact that iχ ≥
which makes H

3 + 12 = 15 for a 12D problem with b = 3. In the numerical applications,

2b, i.e., iχ ≥

b + 1/2. Then, using

1, we must have H

b + D,

≥

≥

1

≥

we choose an H value slightly larger than this minimal necessary value: H = b + D + 2

was usually found to be suﬃcient to converge the results for the example computations

(Section V).

It is important that the Smolyak algorithm uses nested sequences of quadrature rules.

18

i
; kmax
3

Nesting ensures that the non-product grid has a special structure. By exploiting this struc-

ture, a multi-dimensional integral of a multi-variable function, F (x1, . . . , xD), can be re-

written as

. . .

F (ξ1, . . . , ξD) dξ1 . . . dξD

Z

Z
N max

=

=

WN F (ξ1,k1, . . . , ξD,kD)

XN =1
kmax
1

kmax
D

. . .

W S(k1, . . . , kD)F (ξ1,k1, . . . , ξD,kD) ,

(44)

Xk1=1

XkD=1

where the structure of the Smolyak grid appears in the second equation through the kmax

upper summation indexes [16, 17]: kmax

1

depends on H; kmax

2

depends on H and kmax

1

depends on H and kmax

1

, kmax
2

, etc.

It is important to notice that the multi-dimensional

integral, Eq. (44), can be written in a sequential sums form (second equation in Eq. (44))

only for structured grids, otherwise only the ﬁrst, computationally more demanding, form

is applicable.

C. An eﬃcient matrix-vector product algorithm for computing eigenvalues and

eigenvectors with an iterative eigensolver

We develop a method to compute (ro)vibrational states of polyatomic molecules with mul-

tiple large-amplitude motions. Probably, the most common way to tackle (ro)vibrational

problems is to compute the Hamiltonian matrix elements in FBR, and then diagonalize the

Hamiltonian matrix following the pioneering work of Whitehead and Handy [40]. For poly-

atomic molecules and complexes, the size of the basis set, even if we use a pruned, product

basis, may be larger than 100 000 (105), and a corresponding non-product quadrature grid

would consists of more than 10 000 000 (107) points. Unless the Hamiltonian matrix is very

sparse and the system has a high permutation-inversion symmetry, the ‘traditional’ route of

using a direct eigensolver is not feasible for time and memory reasons.

Using iterative eigensolvers is a practical alternative [41, 42], which allows us to compute

eigenvalues and eigenvectors without storing or even explicitly computing the Hamiltonian

matrix elements. The key algorithmic element in relation with iterative eigensolvers, is the

eﬃcient multiplication of an input vector with the Hamiltonian matrix.

19

In this section, we develop an eﬃcient matrix-vector products algorithm in relation with

the numerical KEO approach (Section III) and the Smolyak scheme (Section IV B). The

multiplication is made eﬃcient by exploiting the structure of the pruned basis set and the

structure of the non-product Smolyak grid. Multiplication with the potential energy matrix

is carried out as

vout
N ′

1...D

=

kmax
1

Xk1=1

kmax
D

T (1)
n′
1

(ξ1,k1) . . .

T (D)
n′
D

(ξD,kD)

XkD=1
K1...D V (ξK1...D )

W S
nmax
D

nmax
1

T (D)
nD (ξD,kD) . . .

T (1)
n1 (ξ1,k1)

nD=0
X
vin
N1...D

n1=0
X

(45)

×

×

×

with the condensed indexing of the basis labels, grid labels, and multi-dimensional grid

points:

(n1, n2, . . . , nD) , K1...D ↔

N1...D ↔
respectively. Tn(xk) is the value of the basis function with index n at point xk and W S

(ξ1,k1, ξ2,k2, . . . , ξD,kD),

(k1, k2, . . . , kD) ,

ξK1...D ↔

collects the multi-dimensional quadrature weights. In the Fortran implementation we use
two condensed indexes for the intermediate vectors, labelled with K1...∆ ↔
‘partial’ grid and the corresponding N∆+1,...,D ↔
operations are performed in parallel using the OpenMP protocol. The nmax

(n∆+1, . . . , nD) ‘partial’ basis index. The

(k1, . . . , k∆)

and kmax

values

χ

χ

for each coordinate, i.e., the structure of the basis and the grid, are determined from the

basis and the grid pruning conditions.

For our present numerical example, CH4·

Ar, D = 12 and ξ = (R, c, φ, q1, . . . , q9) (hence-

forth, we use the short labelling c = cos θ). According to the basis pruning condition,

Eq. (41), the upper summation indexes for the basis labels are

χi = N max
nmax

χi

nmax
q9−i = b

−

,
i−1

j=0
P

for i(χi) = 1(R), 2(c), 3(φ)

nq9−j ,

for i = 0, 1, . . . , 8 .

(46)

The grid pruning condition in Eq. (42) determines the structure of the quadrature indexes

according to

χi = K max
kmax
kmax
qi = mqi(H

χi

,

for

i(χi) = 1(R), 2(θ), 3(φ)

(12

i)

−

−

−

i−1
j=1 S(kqj)) ,

for

i = 1, 2, . . . , 9

.

(47)

P

20

where S(k) is the index of the smallest quadrature rule in the nested sequence of Hermite

quadratures that contains k points. For the Hermite sequence used in the present work, the

S(k) values are obtained from Eq. (43):

S(1) = 1, S(2) = 2, S(3) = 2, S(4) = 4, S(5) = 4, S(6) = 4, S(7) = 4, S(8) = 5,

S(9) = 5, . . . , S(17) = 9, S(18) = 10, S(19) = 10, S(20) = 16, . . . , S(31) = 16,

S(32) = 17, S(33) = 17, S(34) = 18, S(35) = 18, S(36) = 19, S(37) = 19,

S(38) = 20, S(39) = 20, S(40) = 21, S(41) = 21

(48)

If the FBR method is used for the intermolecular coordinates R, c, or φ, we use more

grid points than basis functions K max > N max in order to get exact integrals (typically,

K max

N max

−

≈

5 was suﬃcient to achieve convergence). If the DVR scheme is used (due

to the reasons explained in Section IV D), then we have the same number of points and

functions, so K max = N max + 1.

D. Singularity concerns and a hybrid DVR-FBR solution

We have numerically identiﬁed that KEO we use to describe the CH4·

Ar complex has

singularities along the θ spherical angle (also related to φ). These singularities appear at

θ = 0 and θ = π (c = cos θ =

1), and they represent a considerable challenge for a

±

non-analytic KEO representation, especially because two kinds of singularities appear:

1

−

1

c2

and

1

−

.

c2

√1

(49)

This singular property can be discerned from numerical tests with the numerical KEO coef-
Rj terms using an associated

ﬁcients and by calculating matrix elements for the Gi,j∂2/∂
Jacobi basis set, J α,β

n (c), for example.

Ri∂

An obvious way to avoid these types of singular integrals for analytic KEOs would be

to use the 2D spherical harmonics functions for θ and φ. This option is the way to go

for tailor-made approaches, but it would destroy the simplicity and generality of a universal

(ro)vibrational approach we are developing, especially if there are several groups of spherical

coordinates (θi, φi) i = 1, 2, . . . in the system [24]. In particular, the application of spherical

harmonics would require the development of special matrix-vector product routines for each

i = 1, 2, . . . values.

21

Another possibility would be to use Jacobi associated functions, J α,β

n (c), with α and
β close to zero. We could follow this alternative, if an analytic KEO and analytic KEO

integrals were available.

Since we develop a universal method for numerical KEO representations, we need to

ﬁnd a multi-dimensional quadrature which allows us to evaluate all the diﬀerent kinds of

integrals appearing in the KEO without knowing its exact, analytic form, but knowing only

the characteristic singular behavior, Eq. (49). Let us use Jacobi associated functions with

α = β = 0.001 for c. Then, we have to ﬁnd a quadrature rule which integrates exactly the

following types of integrals simultaneously

1

−1

Z
1

J α,β
n′ (c)

c2 J α,β

n (c) dc

1

1

−
1

J α,β
n′ (c)

−1

Z

J α,β
n (c) dc

√1
1

c2

−
J α,β
n′ (c)J α,β

n (c) dc

−1

Z

(50)

with 0

n, n′

≤

≤

N. Gauss-quadrature rules exist for each integral in Eq. (50) separately, but

there is not any single Gauss quadrature that integrates exactly all three types of integrals,

whereas in the numerical KEO, it is not possible to separate diﬀerent terms of diﬀerent

singular behavior (which we know again from numerical test calculations). Then, the next

logical step is to ﬁnd a (non-Gauss) quadrature rule of M points that gives exactly all the

integrals in Eq. (50) at the same time. We determined such a quadrature using a two-

step procedure. First, we optimized the quadrature points with a simplex algorithm and

calculated the quadrature weights by solving an overdetermined set of equations; this set

of points and weights was reﬁned by optimizing both the quadrature points and weights

with the simplex algorithm. Unfortunately, this (non-Gauss) quadrature includes a large

number of points (K

≫

N) (three times as many as a single Gauss-quadrature rule) and

some of the points come extremely close to the singular points at c =

1 and c = 1.

−

Since GENIUSH calculates the Gi,j elements through ﬁnite diﬀerences, the ﬁnite step size

will place limitations on increasing the number of quadrature points. Due to the large

number of points and their accumulation near the singular values, we cannot accept this

special quadrature as a practical solution for the problem, but we will use this (non-Gauss)

quadrature rule to check the practical ideas we explain in the following paragraphs.

Since we do not have analytic integral expressions, and it is not possible to ﬁnd any com-

22

pact (Gauss) numerical integration scheme which ensures exact integration, let us consider

approximate integrals (which become accurate at the limit of a large number of points). First

of all, non-exact integration, due to the singularities, manifests itself in a non-symmetric ma-

trix representation of the KEO in Eq. (24). Then, instead of aiming for exact integrals (with

a compact grid), let’s aim for a symmetric matrix representation at the ﬁrst place. Con-

struction of a symmetric matrix representation is straightforward by using Legendre-DVR

(or the variants of it discussed below) and the inherently more symmetric general KEO in

Eq. (21) for c = cos(θ). We will ensure a symmetric representation in the same way, as in

the original DVR-based GENIUSH implementation [27] (see also Ref. [43] concerning the

Legendre polynomials) and in its applications to ﬂoppy systems [44–49], which did not suﬀer

from the present singularity problems but which did suﬀer from the curse of dimensionality.

So, we handle the singular coordinate c as we would do it in GENIUSH-DVR, for the rest

of the coordinates, we use FBR.

So, instead of using the fully rearranged KEO, Eq. (24), for which we obtain a non-

symmetric matrix representation due to inexact integration (the oﬀ-diagonal elements with

diﬀerent basis indexes of c fail to be equal unless they are exactly integrated), we re-write

the KEO for the c coordinate into the more symmetric form

∂
∂c

Gc,j

∂
∂ξj −

1
2

12

j=1
X

12

12

Xi=16=2

j=1
X

Gi,j

∂
∂ξi

∂
∂ξj −

1
2

Bi

∂
∂ξi

12

i=1
X

+ U,

(51)

−

1
2

12

ˆT v =

Bi =

Xk=1,6=2

∂
∂ξk

Gk,i .

Using this KEO and a hybrid DVR(c)-FBR representation, the Hamiltonian matrix is real,

symmetric by construction and the matrix elements for functions with the same c index are

the same as the ones we get using the fully rearranged KEO, Eq. (24). We have carried out

an additional test for this hybrid DVR-FBR approach. First, we performed a fully FBR

computation with the fully rearranged KEO, Eq. (24), using a Jacobi associated basis set for

c with α = 0.01, β = 0.01 and a (non-Gauss) quadrature developed to calculate accurately

the integrals of Eq. (50). This non-Gauss quadrature included a very large number of points

for c, so we could aﬀord only a small basis and grid for the other degrees of freedom. We

repeated the computation using the same, small basis set for the non-c coordinates and

DVR with the symmetric KEO, Eq. (51), for c. The two computations resulted in the

same eigenvalues, which provides a numerical test for our practical DVR-FBR approach (of

23

course, the eigenvalues obtained in this way were diﬀerent from the converged values due

to the smallness of the non-c basis set). So, in this sense, using DVR(c)-FBR and the KEO

in Eq. (51) has the correct “limiting” (convergence) behavior, while it ensures a symmetric

matrix representation by construction.

E. Matrix-vector products in the hybrid DVR-FBR

The matrix-vectors products in the hybrid DVR-FBR are carried out similarly to Eq. (45).

In what follows we list the necessary changes in comparison with the fully FBR PES mul-

tiplication, Eq. (45) to accommodate the hybrid FBR-DVR representation for the KEO of

Eq. (51). We also note that in the hybrid DVR-FBR scheme, the W S

K1...D Smolyak weights

were obtained using a quadrature rule for the c coordinate with weights equal to one.

1. The matrix-vector product for the potential (and the U pseudo-potential) term is

carried out as in Eq. (45), but for the c coordinate, we make the following replacements:

T (c)
n′
c

(ξc,kc)

→

δn′

c,kc−1

and T (c)

nc (ξc,kc)

δnc,kc−1 .

→

(52)

2. The matrix-vector product for the ∂

∂c Gc,c

∂
∂c term is calculated as in Eq. (45), but for

the c coordinate, we make the following replacements:

(53)

(54)

V (ξK1...D )
T (c)
n′
c

(ξc,kc)

with

Gc,c(ξK1...D ) ,

→

Mkc−1,n′

c ,

→ −

1

and

T (c)
nc (ξc,kc)

Mkc−1,nc

→

Mn′

c,nc =

Θn′

c(c)

Θnc(c) dc ,

d
dc

Z
where Θnc(c) is the ncth (cot-, sincot-)Legendre-DVR function with K max

−1

c = N max

c + 1

quadrature points (vide infra).

3. The matrix-vector product for the ∂

∂
∂R term, where
calculated as in Eq. (45) with the following replacements:

∂cGc,R

R

is not the c coordinate, is

Gc,R(ξK1...D ) ,

→

V (ξK1...D)
T (c)
n′
c

(ξc,kc)

→ −

T (R)
nR (ξR,kR)

→

c

Mkc−1,n′
d
d

T (R)
nR (

R

24

and T (c)

nc (ξc,kc)

δnc,kc−1 ,

→

.

R=ξR,kR

)
R

(cid:12)
(cid:12)
(cid:12)

(55)

4. The matrix-vector product for the ∂

∂
∂c term, where
calculated as in Eq. (45) with the following replacements:

∂RGR,c

R

is not the c coordinate, is

V (ξK1...D )
T (c)
n′
c

(ξc,kc)

→
(ξR,kR)

T (R)
n′
R

GR,c(ξK1...D) ,

→

δn′

c,kc−1
d
d

R

→

T (R)
n′
R

(

)
R

R=ξR,kR
(cid:12)
(cid:12)
(cid:12)

and T (c)

nc (ξc,kc)

Mkc−1,nc ,

→

.

(56)

5. The matrix-vector product for the GR,R

∂2
∂R2 term, where
calculated as in Eq. (45) with the following replacements:

R

is not the c coordinate, is

GR,R(ξK1...D ) ,

V (ξK1...D )
T (c)
n′
c

(ξc,kc)

→

→

δn′

T (R)
nR (ξR,kR)

→

2 T (R)
nR (

)
R

c,kc−1
d2
d

R

and T (c)

nc (ξc,kc)

δnc,kc−1 ,

→

R=ξR,kR
(cid:12)
(cid:12)
(cid:12)
∂
∂R term, where

.

(57)

is not the c coordinate, is

R

6. The matrix-vector product for the BR

calculated as in Eq. (45) with the following changes

V (ξK1...D )
T (c)
n′
c

(ξc,kc)

→
T (R)
nR (ξR,kR)

BR(ξK1...D ) ,

→

δn′

c,kc−1
d
d

R

→

T (R)
nR (

)
R

and T (c)

nc (ξc,kc)

δnc,kc−1 ,

→

.

(58)

R=ξR,kR

(cid:12)
(cid:12)
∂2
(cid:12)
∂R2 term, where

7. The matrix-vector product for the GRs,Rt

Rs and

Rt are not the c

coordinate, is calculated as in Eq. (45) with the replacements

GRs,Rt(ξK1...D ) ,

→

V (ξK1...D )
T (c)
n′
c

(ξc,kc)

→
(ξRs,kRs )

T (Rs)
nRs

δn′

c,kc−1
d

→

d

Rs

and T (c)

nc (ξc,kc)

δnc,kc−1 ,

→

T (Rs)
nRs

(

)
R

Rs=ξRs,kRs

(cid:12)
(cid:12)
(cid:12)

and T (Rt)
nRt

(ξRt,kRt )

d

Rt

→

d

T (Rt)
nRt

(

)
R

.

Rt=ξRt,kRt
(59)

(cid:12)
(cid:12)
(cid:12)

F. Analysis and improvements for the intermolecular representation

To test the convergence properties, and to determine the optimal basis set and grid sizes

for our example system, CH4·
molecular (3D) computations were performed with a ﬁxed methane structure corresponding

Ar, we performed reduced-dimensionality computations. Inter-

25

to the eﬀective rotational constant, Bv=0 = 5.246 981 98 cm−1 (and an eﬀective C–H distance
iv=0 = 1.107 117 44 bohr) obtained with the ground-state vibrational wavefunction
of CH4 with pruning condition b = 8 (see Section IV G) and using the isolated methane’s

R(CH)

of

h

PES [33].

1.

Intermolecular angular representation: Legendre, cot-Legendre and sincot-Legendre DVRs

Since regions near the singularities, Eq. (49), are dynamically relevant for the CH4·
plex, using Legendre DVR for the coordinate c = cos θ is an ineﬃcient choice: more than 120
points are needed to converge all vibrational bound states of CH4·

Ar (3D) within 0.01 cm−1.

Ar com-

In 2010, Schiﬀel and Manthe [50] proposed more eﬃcient alternatives to Legendre DVR

to be used for the type of singularities we have to tackle. First of all, the quadrature is

improved by selecting the quadrature points, diﬀerent from the Legendre points, as the

inverse cotangent of the eigenvalues (wi) of the following matrix

1

Pn,m =

Ln(c)

−1

Z

c

−

1

ǫi = arccot(wi),

c2 Lm(c) dc, n, m = 0, . . . , N max
i = 1, . . . , N max

c −

c

1

(60)

where Ln(c) is the nth normalized Legendre function. These integrals are calculated exactly

using the Gauss–Chebyshev quadrature with a suﬃciently large number of points. Using

the eigenvectors, A, of P the cot-Legendre DVR basis functions are deﬁned as

Nc−1

Θn(c) =

m=0
X

Am,nLm(c), n = 0, . . . , N max

c −

1 ,

and the ﬁrst derivative matrix, M , for the cot-Legendre DVR functions is

1

Mn′,n =

Θn′(c)

−1

Z

d
dc

Θn(c) dc .

(61)

(62)

In our test calculations, it was suﬃcient to use 50 cot-Legendre DVR points to converge all
bound states of the CH4·

Ar in 3D (within 0.01 cm−1) (see also Table I).

Schiﬀel and Manthe [50] continued and proposed further improvements by extending the

basis set. They have noticed that some eigenfunctions of the KEO in spherical coordinates

have a sin(θ) ‘component’ close to the singularities, so they extended the Legendre basis

set with sine functions. Their new basis set included Ln(c), n = 0, . . . , N max

c −

s and

sin(θ), . . . , sin(sθ), where s = 2 was suﬃcient (and stable without any over-completeness

26

problems, which would occur for larger s values) in most applications. A corresponding

DVR basis set, called ‘sincot-Legendre DVR basis’, is obtained in the following procedure:

1. Orthogonal basis functions are created from the set

c −
by diagonalizing the corresponding overlap matrix Ssin−cos. The or-

{

Ln(x), (n = 0, . . . , N max

2), sin θ, sin 2θ

}

thogonal basis functions, Lsin−cos

n

(c), are calculated using the eigenvectors of the

overlap matrix.

2. A P sin−cos matrix is introduced with the elements

P sin−cos
n,m

=

1

−1

Z

c

Lsin−cos

n

1

(c)

c2 Lsin−cos
−
n, m = 0, . . . , N max

m

c

(c) dc,

.

(63)

The DVR points are the inverse cotangent of the wi eigenvalues of P sin−cos. The
sincot-Legendre DVR basis functions are obtained from the eigenvectors of the P sin−cos
matrix, collected in Asin−cos, as

N max
c

Θsin−cos
n

(c) =

Asin−cos

m,n Lsin−cos

m

(c), n = 0, . . . , N max

c

.

(64)

m=0
X
3. The ﬁrst derivative matrix, M sin−cos, for sincot-Legendre DVR is

M sin−cos

n′,n =

1

−1

Z

Θsin−cos
n′

(c)

d
dc

Θsin−cos
n

(c) dc .

(65)

The integrals for the Ssin−cos, P sin−cos, and M sin−cos matrices can be calculated analytically

using elementary properties of trigonometric functions and they were tabulated in Ref. [50].

We used the sincot-Legendre DVR points and the corresponding ﬁrst derivative matrix

elements (as an alternative to Legendre DVR) in the matrix-vector multiplication procedure

described in Section IV D. Our 3D test computations show that it is suﬃcient to use 21

sincot-Legendre DVR points for coordinate c to converge all the bound states within 0.01
cm−1 for CH4·
which required more than 120 points. The performance of a few diﬀerent representations

Ar, which is a signiﬁcant reduction compared to the original Legendre DVR

α
for the c coordinate is compared in Table I. In all computations, we used the
n generalized
Laguerre polynomials (with α = 2) for R, scaled to the [2.64, 30] ˚A interval, and Fourier

L

functions for φ. The number of points used for the R, cos θ, and φ degrees of freedom in the

three test sets of the table is

27

A3D: (K max

R , K max

c

B3D: (K max

R , K max

c

, K max
φ

, K max
φ

) = (81, 101(L), 101) using Legendre (L) DVR for c

) = (61, 21(SCL), 17) using sincot-Legendre (SCL) DVR for c

C3D: (K max

R , K max

c

, K max
φ

) = (61, 31(SCL), 31) using sincot-Legendre (SCL) DVR for c

•

•

•

It is important to observe in Table I that the vibrational states are not perfectly converged

even with a very large number (more than 100) of Legendre DVR points. On the contrary,

almost perfect results are obtained with less than 30 sincot-Legendre DVR points. Another

important observation (relevant for the 12D applications in Section V) is that we can use

fewer Fourier basis functions for φ, than (sincot-Legendre) functions for θ to converge the

3D vibrational energies.

TABLE I: Convergence tests for the bound-state vibra-

tional energies of CH4·
(R, cos θ, φ). The vibrational energies, ˜ν in cm−1 and ref-

Ar (3D) using spherical coordinates,

erenced to the ZPVE, were computed with GENIUSH-DVR

and the PES of Ref. [35, 36]. The vibrational states are la-

belled with the (approximate) j methane angular momentum

quantum number, the nR radial excitation index, and the

Γ Td(M) irrep label. The R and φ degrees of freedom are

described using generalized Laguerre basis functions (

L

α=2
n

)

scaled to [2.64, 30] ˚A, and Fourier functions deﬁned over the

[0, 2π) interval, respectively. Legendre or sincot-Legendre

DVR is used for cos θ. The number of basis functions and

grid points is given for each set as (K max

R , K max

c

, K max
φ

). The

test sets, i = A3D, B3D, and C3D are compared with the “ﬁ-

nal”, benchmark values of F3D, ∆˜νi = ˜νi −

˜νF3D.

cos θ: Legendre-DVR

cos θ: sincot-Legendre

A3D : (111,111,31) B3D : (111,21,17) C3D : (111,31,31) F3D : (151,31,31)

n

j nR

Γ

˜νA3D

∆˜νA3D

˜νB3D ∆˜νB3D

˜νC3D

∆˜νC3D

ZPVE 0 0 A1

51.200

0.000

51.200

0.000

51.200

0.000

˜νF3D

51.200

28

1

2

3

4

5

6

7

8

9

10

11

12

13

14

15

16

17

18

19

20

21

22

23

24

25

26

27

28

TABLE I Continued

n

j nR

Γ

A3D

A3D −

F3D

1 0 F2

1 0 F2

1 0 F2

9.107

9.107

9.109

0 1 A1

29.188

2 0 F2

31.384

2 0 F2

31.384

−

−

−

−

B3D B3D −
0.000
9.109

F3D C3D C3D −
0.000
9.109

F3D

0.002

0.002

9.109

0.000

9.109

0.000

0.000

9.109

0.000

9.109

0.000

0.000

29.188

0.000

29.188

0.000

0.004

31.388

0.000

31.388

0.000

0.004

31.388

0.000

31.388

0.000

2 0 F2

31.388

0.000

31.388

0.000

31.388

0.000

2 0 E

31.942

0.000

31.942

0.000

31.942

0.000

2 0 E

31.942

0.000

31.942

0.000

31.942

0.000

1 1 F2

44.570

1 1 F2

44.570

1 1 F2

44.573

0 2 A1

53.036

2 1 F2

56.228

2 1 F2

56.228

0.004

44.573

0.000

44.573

0.000

0.004

44.573

0.000

44.573

0.000

0.000

44.573

0.000

44.573

0.000

0.000

53.036

0.000

53.036

0.000

0.004

56.232

0.000

56.232

0.000

0.004

56.232

0.000

56.232

0.000

−

−

−

−

2 1 F2

56.232

0.000

56.232

0.000

56.232

0.000

2 1 E

64.046

0.000

64.046

0.000

64.046

0.000

2 1 E

64.046

0.000

64.046

0.000

64.046

0.000

3 0 F2

65.825

3 0 F2

65.825

3 0 F2

65.837

1 2 F1

66.066

1 2 F1

66.066

0.013

65.837

0.000

65.837

0.000

0.013

65.837

0.000

65.837

0.000

0.000

65.837

0.000

65.837

0.000

0.004

66.070

0.000

66.070

0.000

0.004

66.070

0.000

66.070

0.000

−

−

−

−

1 2 F1

66.070

0.000

66.070

0.000

66.070

0.000

0 3 A1

70.313

0.000

70.313

0.000

70.313

0.000

3 0 A1

73.497

0.000

73.497

0.000

73.497

0.000

2 2 F2

75.340

2 2 F2

75.340

−

−

0.007

75.347

0.000

75.347

0.000

0.007

75.347

0.000

75.347

0.000

29

F3D

9.109

9.109

9.109

29.188

31.388

31.388

31.388

31.942

31.942

44.573

44.573

44.573

53.036

56.232

56.232

56.232

64.046

64.046

65.837

65.837

65.837

66.070

66.070

66.070

70.313

73.497

75.347

75.347

TABLE I Continued

n

j nR

Γ

A3D

A3D −

F3D

2 2 F2

75.347

0.000

B3D B3D −
0.000
75.347

F3D C3D C3D −
0.000
75.347

F3D

29

30

31

32

33

34

35

36

37

38

39

1 3 F2

80.280

1 3 F2

80.280

1 3 F2

80.283

0 4 A1

83.085

1 4 F2

88.186

1 4 F2

88.186

0.003

80.283

0.000

80.283

0.000

0.003

80.283

0.000

80.283

0.000

0.000

80.283

0.000

80.283

0.000

0.000

83.085

0.000

83.085

0.000

0.003

88.189

0.000

88.189

0.000

0.003

88.189

0.000

88.189

0.000

−

−

−

−

1 4 F2

88.189

0.000

88.189

0.000

88.189

0.000

2 4 E

88.826

0.000

88.826

0.000

88.826

0.000

2 4 E

88.826

0.000

88.826

0.000

88.826

0.000

0 5 A1

89.427

0.000

89.427

0.000

89.427

0.000

F3D

75.347

80.283

80.283

80.283

83.085

88.189

88.189

88.189

88.826

88.826

89.427

2.

Intermolecular radial representation: Laguerre and Morse-tridiagonal basis sets

If we choose the

L

(α)
n generalized Laguerre basis functions (with α = 2) for the R radial

coordinate, we have to use a large number, more than 30, basis functions to converge the

vibrational bound states. Since in the present work we focus on the computation of bound

states, it is better to use tridiagonal Morse basis set [51–53]. The parameters of Morse

function functions were determined according to the equations in Ref. [51] with D = 143.49

cm−1, α = 0.65, and γ = 0.00033. These parameters were adjusted to obtain 13 functions

that recover the exact vibrational energies for the bound states of the radial Hamiltonian

ˆHR =

1
2µCH4,Ar

−

∂2
∂R2 + V (R, θeq, φeq)

(66)

where µCH4,Ar is the reduced mass of methane and argon, and θeq and φeq are the equilibrium
values of the 3D PES. Since the CH4·
and the radial basis set determined in this way should be useful over the entire range of the

Ar complex is a very isotropic system, the parameters

[0, π] and φ

θ

∈

∈

[0, 2π) coordinates.

30

G. Analysis of the intramolecular representation: vibrational states of CH4

The vibrational basis set used to describe the intramolecular vibrational dynamics, i.e.,

vibrations of the methane molecule, was constructed from the harmonic oscillator basis set
k=1 nqk ≤

b in Eq. (41), and the Smolyak quadrature

with the standard pruning condition,

9

with

9
k=1 gqk(iqk)

H in Eq. (42). Table II shows the convergence of the lowest vibrational

P

≤

states by increasing b and H.

P

As to the 12D computation of CH4·

Ar, the bound states correspond to the zero-point

vibrational state (ZPV) of CH4, we focused on the lowest-energy states of CH4. Of course,

more accurate results for the isolated methane molecule can be obtained by increasing the

size of the Smolyak grid, which is perfectly feasible for a 9D computation.

In a minimalistic setup (to be transferred for the 12D computations), we chose a represen-

tation which allowed us to converge the fundamental vibrational energies within 1 cm−1. In

this representation the 9D Smolyak grid includes more than 100 000 points, which is approx-

imately an order of magnitude larger than what is necessary for a meaningful representation

of the zero-point vibration.

TABLE II: Deviation of the vibrational energies, cm−1, of

the CH4 molecule obtained with GENIUSH-Smolyak with a

pruned basis and grid, from the tightly converged results of

Ref. [33], with increasing the b and H values in the basis and

the grid pruning conditions, Eqs. (41) and (42), respectively.

In general, H = b+D+2

≥

b+D was found to be suﬃcient to

converge the results (note that D = 9 for isolated methane).

The corresponding number of Smolyak points, NSmol, is also

shown.

n

Deviation from Ref. [33]

Ref. [33]

b:

2

H9D:

13

3

14

4

15

5

16

6

17

7

18

8

19

NSmol: 3 481 11 833 35 929 97 561 241 201 556 707 1 202 691

ZPV 41.18 2.51

0.66

0.57

0.07

0.02

0.02

9651.29

31

1

2

3

4

5

6

7

8

9

10

11

12

13

14

15

16

17

18

19

20

21

47.81 44.46

3.03

0.81

0.65

47.81 44.45

3.03

0.81

0.65

47.82 44.45

3.03

0.81

0.65

45.91 42.46

2.97

0.75

0.61

45.93 42.47

2.97

0.75

0.61

81.12 57.35 46.15

4.79

1.23

75.65 55.48 48.12

4.18

1.14

75.73 55.48 48.11

4.17

1.14

76.42 55.48 48.11

4.17

1.13

65.82 53.24 47.43

3.49

1.00

65.85 53.24 47.43

3.49

1.00

78.12 53.43 43.26

3.87

1.03

78.77 53.48 43.26

3.88

1.03

78.77 53.48 43.27

3.87

1.03

72.37 51.38 45.63

3.57

0.93

72.37 51.38 45.65

3.56

0.94

73.08 51.44 45.65

3.57

0.94

83.68 72.76 15.82

2.88

1.76

86.04 74.55 16.18

2.89

1.79

86.07 74.56 16.18

2.89

1.79

86.07 74.56 16.18

2.89

1.79

0.09

0.09

0.09

0.08

0.08

0.74

0.77

0.77

0.77

0.72

0.72

0.66

0.66

0.66

0.69

0.69

0.69

0.47

0.48

0.48

0.48

0.03

10961.76

0.03

10961.76

0.03

10961.76

0.03

11184.76

0.03

11184.76

0.14

12238.29

0.13

12265.12

0.13

12265.13

0.13

12265.13

0.11

12275.73

0.11

12275.74

0.11

12481.49

0.11

12481.49

0.11

12481.49

0.10

12497.25

0.10

12497.25

0.10

12497.26

0.12

12568.47

0.12

12670.73

0.12

12670.73

0.12

12670.73

V. FULL-DIMENSIONAL (12D) RESULTS FOR METHANE-ARGON

All bound-state vibrational energies were computed for the CH4·

Ar complex in full (12D)

vibrational dimensionality (Table IV). The basis and the grid representations are selected

based on the convergence tests carried out for the inter- and intra-molecular representations

(Sections IV F and IV G). Concerning the intermolecular representation, it is composed of

Morse-tridiagonal basis functions with N max

R = 12, sincot-Legendre-DVR basis functions

32

was K max

with N max

c = 20, and Fourier functions with N max
c = 21, and K max
R = 15, K max

φ = 17. The number of quadrature points
φ = 20. As to the methane fragment, we used four
diﬀerent intramolecular representations, with b = 0, 1, 2, and 3 values, which allowed us

to check the convergence of the ZPVE and the vibrational energies in the full-dimensional

treatment.

Table III gives an overview of the orders of magnitudes of the basis and the grid repre-

sentations employed in the ﬁnal 12D computations. The largest computation (set D in the

table) includes 82 002 690 (8.20

·

107) quadrature points and 1 021 020 (1.02

106) basis func-

·

tions. The numerical KEO terms, Eq. (51), and the PES are stored as double precision reals

(in Fortran) at every grid point, which amounts to a (12

13/2 + 12 + 1)

·

8.20

·

·

107 = 60 GB

memory usage. The dimensionality of the Lanczos vectors are determined by the number of

basis functions, so one Lanczos vector occupies a negligible amount of 8 MB of memory. To

multiply a trial vector with the Hamiltonian matrix took ca. 230 seconds on 51 processor

cores, and we had to perform ca. 10 000 matrix-vector multiplications to obtain the 40 states

reported in Table IV using an in-house Lanczos implementation (it might be possible to re-

duce the number of matrix-vector products with a Lanczos and a pre-conditioning algorithm

optimized for the present system).

Based on the isolated-methane test computations (Table II) the error in the ZPVE for

b = 2 and 3 is 41 and 2.5 cm−1, respectively. The vibrational energies of the complex

(referenced to the ZPVE) change less than 0.01 cm−1 by increasing the b value from 2 to 3,

hence we may accept them as converged for b = 3. The ZPVE of the complex is probably

accurate within a few cm−1 with b = 3 similarly to the case of the isolated methane (Table II).

We only note that a full 12D computation with b = 4 would also be feasible with the current

implementation, but it would only change the ZPVE, since the vibrational energies were

converged already with b = 3.

We also show the b = 0 results, which correspond to a single harmonic oscillator function

for methane (the product of the zeroth harmonic oscillator basis functions for q1, . . . , q9).

Since the present model includes only kinetic coupling (the PES coupling is also probably

very small), the deviation of ˜νA (b = 0) and ˜νA (b = 3) is due to the structural diﬀerences

of methane: the eﬀective structure for the b = 0 ground-state harmonic oscillator basis

function is the equilibrium structure, whereas b > 0 accounts for structural distortions

due to anharmonicity eﬀects. This change is related to the common wisdom in reduced-

33

TABLE III. Intramolecular (methane, “Met”) basis set and grid choices used in the 12D CH4·
vibrational computations with the basis and grid pruning conditions nq1 + . . . + nq9 ≤
iq1 + . . . + iq9 ≤
the results (D = 12). The number of basis functions, N , and grid points, K, are also given for the

b + D was found to be suﬃcient to converge

H, respectively. H = b + D + 2

b and

Ar

≥

methane (“Met”, “Smol”), for the intermolecular (“Inter”), and for the full (12D) computations.

Intramolecular (CH4, 9D)

Intermolecular (3D)

CH4·

Ar (12D)

Label

b H NMet KSmol/103 NInter/103 KInter/103 N12D/105 K12D/107

A

B

C

D

0

1

2

3

14

15

16

17

1

10

55

220

0.163

0.871

3.48

11.8

4.28

4.28

4.28

4.28

6.30

6.30

6.30

6.30

0.0464

0.113

0.464

0.604

2.55

10.2

2.41

8.20

dimensionality computations of weakly-bound complexes that it is better to use eﬀective

(vibrationally averaged) monomer structures than equilibrium monomer structures [54]. In

agreement with this prescription, the 3D computation (column F3D in Table III) performed

with an eﬀective methane structure corresponding to the (isolated) ground-state vibration

very well reproduces the 12D result (remember that only kinetic coupling is included in the

present computation, due to the lack of a 12D fully coupled PES).

34

TABLE IV: Vibrational bound-state energies, ˜ν in cm−1, ref-

erenced to the ZPVE of CH4·
brational dimensionality using the GENIUSH program ex-

Ar computed in full (12D) vi-

tended with the Smolyak algorithm in the present work.

The potential energy was approximated with the sum of the

molecule-atom interaction PES of Ref. [35, 36] and the iso-

lated methane PES of Ref. [33]. The A, B, C, and D basis

and grid representations deﬁned in Table III correspond to

an increasing b = 0, 1, 2, and 3 value in the methane basis

functions’ pruning condition, Eq. (41). Convergence of the

results can be estimated based on the deviation from compu-

tation D, ∆˜νi = ˜νi −
the benchmark 3D computation with a ﬁxed, eﬀective (v = 0)

˜νD (see also Table II). For comparison,

methane geometry (F3D) is also shown (taken from Table I).

12D

3D

Label

A (b = 0)

B (b = 1)

C (b = 2)

D (b = 3) (Table I)

˜νA

∆˜νA

˜νB

∆˜νB

˜νC

∆˜νC

˜νD

˜νF3D

ZPV 9695.262 132.242

9604.164 41.144

9600.706 37.686

9563.019

51.200

1

2

3

4

5

6

7

8

9

9.398

0.285

9.139

0.026

9.398

0.285

9.139

0.026

9.398

0.285

9.139

0.026

9.112

9.112

9.112

29.275

0.086

29.197

0.008

29.189

31.970

0.575

31.447

0.052

31.392

31.970

0.575

31.447

0.052

31.392

31.970

0.574

31.447

0.052

31.392

32.687

0.736

32.016

0.066

31.946

32.687

0.736

32.017

0.066

31.946

10

45.042

0.463

44.620

0.041

44.576

0.002

0.002

0.002

0.000

0.003

0.003

0.003

0.004

0.004

0.003

−

−

−

−

−

−

−

−

−

−

9.113

9.109

9.113

9.109

9.113

9.109

29.189

29.188

31.395

31.388

31.395

31.388

31.395

31.388

31.950

31.942

31.950

31.942

44.579

44.573

35

TABLE IV Continued

˜νA

∆˜νA

˜νB

∆˜νB

˜νC

∆˜νC

˜νD

˜νF3D

11

12

13

14

15

16

17

18

19

20

21

22

23

24

25

26

27

28

29

30

31

32

33

34

35

36

37

38

45.042

0.463

44.620

0.041

44.577

45.042

0.463

44.620

0.041

44.577

53.156

0.119

53.048

0.011

53.036

57.039

0.799

56.313

0.073

56.236

57.039

0.799

56.313

0.073

56.236

57.039

0.799

56.313

0.073

56.236

64.807

0.753

64.122

0.068

64.050

64.807

0.753

64.122

0.068

64.050

66.819

0.970

65.989

0.141

65.839

66.819

0.971

65.989

0.141

65.839

66.819

0.970

65.989

0.141

65.839

67.414

1.337

66.143

0.066

66.072

67.414

1.337

66.143

0.067

66.072

67.414

1.337

66.143

0.067

66.072

70.705

0.388

70.360

0.043

70.314

74.623

1.118

73.597

0.092

73.499

76.276

0.920

75.438

0.081

75.351

76.276

0.920

75.438

0.081

75.351

76.276

0.920

75.442

0.086

75.351

80.808

0.517

80.338

0.047

80.287

80.808

0.517

80.338

0.047

80.288

80.808

0.517

80.337

0.047

80.288

83.156

0.067

83.093

0.004

83.088

88.844

0.647

88.255

0.057

88.194

88.844

0.647

88.254

0.056

88.194

88.844

0.647

88.254

0.056

88.194

89.588

0.753

88.903

0.068

88.830

89.588

0.753

88.902

0.067

88.830

0.003

0.003

0.001

0.005

0.005

0.005

0.004

0.004

0.009

0.009

0.009

0.004

0.004

0.004

0.003

0.006

0.005

0.005

0.005

0.003

0.003

0.003

0.000

0.004

0.004

0.004

0.004

0.004

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

−

36

44.579

44.573

44.579

44.573

53.037

53.036

56.240

56.232

56.240

56.232

56.240

56.232

64.055

64.046

64.055

64.046

65.848

65.837

65.848

65.837

65.848

65.837

66.076

66.070

66.076

66.070

66.077

66.070

70.317

70.313

73.505

73.497

75.356

75.347

75.356

75.347

75.356

75.347

80.290

80.283

80.291

80.283

80.291

80.283

83.088

83.085

88.197

88.189

88.198

88.189

88.198

88.189

88.835

88.826

88.835

88.826

TABLE IV Continued

˜νA

∆˜νA

˜νB

∆˜νB

˜νC

∆˜νC

˜νD

˜νF3D

39

89.505

0.017

89.431

0.057

−

89.488

0.000

89.488

89.427

VI. SUMMARY, CONCLUSIONS, AND OUTLOOK

The numerical kinetic-energy operator (KEO) approach as implemented in the GENIUSH

program [27] has been extended with the Smolyak algorithm [16, 17], which opens a promis-

ing route towards variational (ro)vibrational computations for polyatomic systems with mul-

tiple large-amplitude motions.

A direct, variational solution of the (ro)vibrational Schr¨odinger equation of polyatomic

systems (without imposing constraints on the coordinates) is diﬃcult due to the high vi-

brational dimensionality, which generates an exponential growth in the direct-product basis

used to represent the wave functions, and an exponential growth in the direct-product grid

necessary to calculate integrals of multi-dimensional operator terms in the Hamiltonian.

If coordinates well-suited for the motions in the system and good zeroth-order basis

functions can be found for each coordinate, it is not necessary to use a direct-product

basis, but a much smaller, ‘pruned’ basis can be deﬁned, the size of which does not scale

exponentially with the number of vibrational degrees of freedom. If it is possible to prune a

direct-product basis, it is also possible to ﬁnd a pruned product grid to calculate integrals.

The Smolyak scheme of Avila and Carrington [16, 17] makes it possible to deﬁne non-product

(Smolyak) grids, which are orders of magnitude smaller than a direct-product grid but which

retain some of the practical features of a direct-product grid. Most importantly, Smolyak

grids can be eﬃciently used in computing matrix-vector products and eﬃcient matrix-vector

products allow us to compute eigenvalues and eigenfunctions with an iterative (Lanczos)

eigensolver without storing or even explicitly computing the Hamiltonian matrix elements.

In the present work, the combination of these ideas with the numerical KEO approach

of GENIUSH were elaborated and explained for all stages of the vibrational computation
of the ﬂoppy CH4·
ﬂuxional nature of this system, regions of the curvilinear coordinate domains above which

Ar complex treated in full vibrational dimensionality. Due to the highly

37

the KEO has singularities are dynamically important.

In a fully ﬁnite basis representation (FBR) treatment of the numerical KEO, the Hamilto-

nian matrix fails to be Hermitian due to inaccurate integration of the singularities in general

coordinates. As a practical way to avoid these singularity problems in FBR, we proposed to

use (eﬃcient) DVRs and an inherently symmetric form of the general KEO for the singular

coordinate(s), which ensures a symmetric matrix representation by construction and cor-

rect limiting (convergence) behavior at the same time. In practice, this hybrid DVR-FBR
treatment allows us to converge all bound vibrational states of CH4·

Ar.

In general, this hybrid DVR-FBR approach makes it possible to continue using 1) numer-

ical KEOs; and 2) a general and simple starting product basis sets and grids (both pruned

according to physically motivated restrictions) for systems with multiple large-amplitude

motions; and ultimately, to (further) develop a universal, black-box-type (ro)vibrational

procedure practical for polyatomic systems. Extension of the algorithm for J > 0 rotational

quantum number is straightforward, limitations might be set by the memory requirements

and the computational time.

We can foresee future possible improvements of the present procedure to (at least par-

tially) eliminate the current bottlenecks in terms of memory usage (storage of the numerical

KEO terms over the grid, see for example Ref. [55]) and perhaps also in terms of the com-

putational cost. Furthermore, the present developments, in particular the fact that the

Smolyak grid is several orders of magnitude smaller than the direct product grid, can be

combined with the basis-set contraction idea [7, 13, 56]. With these or other developments,

it will become possible to directly access the predissociation spectral range corresponding

to the molecule’s fundamental (and lowest overtone) vibrations in weakly or more strongly
bound complexes of the size of CH4·
In general, a careful choice of the coordinate set, the basis, and the grid representation are

Ar, i.e., with D = 12 or perhaps beyond this value.

required to make full use of the ideas combined, developed, and described in the present

work. We hope that these ideas will ﬁnd applications, also beyond the realm of molec-

ular complexes, among high-dimensional molecular systems with multiple large-amplitude

motions.

38

Supplementary Material

Deﬁnition of the normal coordinates used for the methane fragment is provided in the

Supplementary Material.

Acknowledgment

Financial support of the Swiss National Science Foundation through a PROMYS Grant (no.

IZ11Z0 166525) is gratefully acknowledged. We thank PRACE for a Preparatory Access

Grant during 2017–2018, and NIIFI for allocating computer time at The Hungarian Com-

puting Infrastructure (Miskolc node). Xiao-Gang Wang and Tucker Carrington helped us

to get through a diﬃcult stage of the development work by sharing their well-tested sincot-

Legendre-DVR implementation (codvr.f90) with us [57]. We are indebted to our colleagues

and co-authors, in particular Tucker Carrington, Attila Cs´asz´ar, and G´abor Czak´o, with

whom we worked together on Refs. [16] and [27], and also the colleagues who later con-

tributed to the further developments and successful applications of the initial methods over

the past 10 years.

[1] X. Huang, B. J. Braams, J. M. Bowman, R. E. A. Kelly, J. Tennyson, G. C. Groenenboom,

and A. van der Avoird, J. Chem. Phys. 128, 034312 (2008).

[2] A. van der Avoird, R. Podeszwa, K. Szalewicz, C. Leforestier, R. van Harrevelt, P. R. Bunker,

M. Schnell, G. von Helden, and G. Meijer, Phys. Chem. Chem. Phys. 12, 8219 (2010).

[3] J. Tennyson and B. T. Sutcliﬀe, J. Chem. Phys. 79, 43 (1983).

[4] D. Zhang, Q. Wu, J. Z. H. Zhang, M. Von Dirke, and Z. Bacic, J. Chem. Phys. 102, 2315

(1995).

[5] C. Leforestier, K. Szalewicz, and A. van der Avoird, J. Chem. Phys. 137, 014305 (2012).

[6] X.-G. Wang and T. Carrington, Jr., J. Chem. Phys. 146, 104105 (2017).

[7] X.-G. Wang and T. Carrington, Jr., J. Chem. Phys. 148, 074108 (2018).

[8] H.-D. Meyer, F. Gatti, and G. A. Worth, “MCTDH for Density Operator,” in Multidimen-

sional Quantum Dynamics (Wiley-Blackwell, 2009) Chap. 7, pp. 57–62.

[9] M. Beck, A. Jackle, G. Worth, and H.-D. Meyer, Phys. Rep. 324, 1 (2000).

[10] A. Leclerc and T. Carrington, J. Chem. Phys. 140, 174111 (2014).

39

[11] P. S. Thomas and T. Carrington, J. Chem. Phys. 146, 204110 (2017).

[12] J. M. Bowman, S. Carter, and X. Huang, Int. Rev. Phys. Chem. 22, 533 (2003).

[13] Z. Bacic and J. C. Light, Ann. Rev. of Phys. Chem. 40, 469 (1989).

[14] J. R. Henderson and J. Tennyson, Chemical Physics Letters 173, 133 (1990).

[15] M. Mladenovic, Spectrochim. Acta A 58, 795 (2002).

[16] G. Avila and T. Carrington, Jr., J. Chem. Phys. 131, 174103 (2009).

[17] G. Avila and T. Carrington, Jr., J. Chem. Phys. 134, 054126 (2011).

[18] T. Halverson and B. Poirier, J. Phys. Chem. A 119, 12417 (2015).

[19] J. Brown and T. Carrington, J. Chem. Phys. 145, 144104 (2016).

[20] A. Jackle and H.-D. Meyer, J. Chem. Phys. 104, 7974 (1996).

[21] B. Ziegler and G. Rauhut, Mol. Phys. (2019), 10.1080/00268976.2018.1522004.

[22] V. I. Lebedev and D. Laikov, in Doklady Mathematics, Vol. 59 (Pleiades Publishing, 1999) pp.

477–481.

[23] C. W. Murray, N. C. Handy, and G. J. Laming, Mol. Phys. 78, 997 (1993).

[24] X.-G. Wang and T. Carrington, J. Chem. Theory Comput. 2, 599 (2003).

[25] A. H. Stroud, Approximate Calculation of Multiple Integrals (Prentice-Hall, Englewood Cliﬀs,

NJ, 1971).

[26] D. Lauvergnat and A. Nauts, Spectrochim. Acta A 119, 18 (2014).

[27] E. M´atyus, G. Czak´o, and A. G. Cs´asz´ar, J. Chem. Phys. 130, 134112 (2009).

[28] J. C. Light and T. Carrington Jr., “Discrete-variable representations and their utilization,” in

Adv. Chem. Phys. (John Wiley & Sons, 2007) pp. 263–310.

[29] A. Yachmenev and S. N. Yurchenko, J. Chem. Phys. 143, 014105 (2015).

[30] D. Lauvergnat and A. Nauts, J. Chem. Phys. 116, 8560 (2002).

[31] B. Podolsky, Phys. Rev. 32, 812 (1928).

[32] E. M´atyus, J. Chem. Phys. 149, 194111 (2018).

[33] X.-G. Wang and T. Carrington Jr, J. Chem. Phys. 141, 154106 (2014).

[34] J. S. Coursey, D. J. Schwab, J. J. Tsai, and R. A. Dragoset, Atomic Weights and Isotopic

Compositions (version 4.1): http://physics.nist.gov/Comp [last accessed on 12 May 2018].

National Institute of Standards and Technology, Gaithersburg, MD (2015).

[35] M. Geleijns, N. Halberstadt, J. Millan, P. E. S. Wormer, and A. van der Avoird, Faraday

Discuss. 118, 143 (2001).

40

[36] M. Geleijns, P. E. S. Wormer, and A. van der Avoird, J. Chem. Phys. 117, 7551 (2002).

[37] R. Cools, E. Novak, and K. Ritter, Computing 62, 147 (1999).

[38] The webpages https://people.sc.fsu.edu/

∼

jburkardt/f src/sparse grid hermite/sparse grid hermite.html

and http://sparse-grids.de were last accessed on 16 January 2019.

[39] G. Avila and T. Carrington, Jr., J. Chem. Phys. 134, 064101 (2011).

[40] R. J. Whitehead and N. C. Handy, J. Mol. Spectrosc. 55, 356 (1975).

[41] J.-P. Brunet, R. A. Friesner, R. E. Wyatt, and C. Leforestier, Chem. Phys. Lett. 153, 425

(1988).

[42] M. J. Bramley and T. Carrington, Jr., J. Chem. Phys. 101, 8494 (1994).

[43] H. Wei and T. Carrington, Jr., J. Chem. Phys. 101, 1343 (1994).

[44] C. F´abri, A. G. Cs´asz´ar, and G. Czak´o, J. Phys. Chem. A 117, 6975 (2013).

[45] E. M´atyus, T. Szidarovszky, and A. G. Cs´asz´ar, J. Chem. Phys. 141, 154111 (2014).

[46] C. F´abri, J. Sarka, and A. G. Cs´asz´ar, J. Chem. Phys. 140, 051101 (2014).

[47] J. Sarka and A. G. Cs´asz´ar, J. Chem. Phys. 144, 154309 (2016).

[48] J. Sarka, A. G. Cs´asz´ar, S. C. Althorpe, D. J. Wales, and E. M´atyus, Phys. Chem. Chem.

Phys. 18, 22816 (2016).

[49] J. Sarka, A. G. Cs´asz´ar, and E. M´atyus, Phys. Chem. Chem. Phys. 2, 15335 (2017).

[50] G. Schiﬀel and U. Manthe, Chem. Phys. 374, 118 (2010).

[51] H. Wei and T. Carrington, Jr., J. Chem. Phys. 97, 3029 (1992).

[52] B. R. Johnson and W. P. Reinhardt, J. Chem. Phys. 85, 4538 (1986).

[53] J. Tennyson and B. T. Sutcliﬀe, J. Chem. Phys. 77, 4061 (1982).

[54] M. Jeziorska, P. Jankowski, K. Szalewicz, and B. Jeziorski, J. Chem. Phys. 113, 2957 (2000).

[55] A. Nauts and D. Lauvergnat, Mol. Phys. 116, 3701 (2018).

[56] S. N. Yurchenko, R. J. Barber, A. Yachmenev, W. Thiel, P. Jensen, and J. Tennyson, J.

Phys. Chem. A 113, 11845 (2009).

[57] X.-G. Wang and T. Carrington, Jr., Mol. Phys. 110, 825 (2012).

41

