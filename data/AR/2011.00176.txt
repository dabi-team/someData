Reliability of Power System Frequency
on Times-Stamping Digital Recordings

Guang Hua, Qingyi Wang, Dengpan Ye, and Haijian Zhang,

0
2
0
2

t
c
O
1
3

]

R
C
.
s
c
[

1
v
6
7
1
0
0
.
1
1
0
2
:
v
i
X
r
a

Abstract—Power system frequency could be captured
by digital recordings and extracted to compare with a ref-
erence database for forensic time-stamp veriﬁcation. It is
known as the electric network frequency (ENF) criterion,
enabled by the properties of random ﬂuctuation and intra-
grid consistency. In essence, this is a task of matching a
short random sequence within a long reference, and the
reliability of this criterion is mainly concerned with whether
this match could be unique and correct. In this paper, we
comprehensively analyze the factors affecting the reliability
of ENF matching, including length of test recording, length
of reference, temporal resolution, and signal-to-noise ratio
(SNR). For synthetic analysis, we incorporate the ﬁrst-order
autoregressive (AR) ENF model and propose an efﬁcient
time-frequency domain (TFD) noisy ENF synthesis method.
Then, the reliability analysis schemes for both synthetic
and real-world data are respectively proposed. Through
a comprehensive study we reveal that while the SNR is
an important external factor to determine whether time-
stamp veriﬁcation is viable, the length of test recording is
the most important inherent factor, followed by the length
of reference. However, the temporal resolution has little
impact on the matching process.

Index Terms—Digital

forensics, electric network fre-
quency (ENF) criterion, power system frequency, power
system signal processing, time-stamp veriﬁcation.

I. INTRODUCTION

P OWER system frequency, as an important parameter for

grid monitoring, operation, and control, has also been
widely exploited in security and forensic applications for its
special properties [1]. First, due to the imbalance between
generation and load, the frequency could not stay precisely
at the nominal value of 50 or 60 Hz, and it instead exhibits
as a random process ﬂuctuating around the nominal value.
Besides, the synchronization within an interconnected grid
makes the ﬂuctuations consistent among different nodes in
the grid. These properties make the power system frequency
a unique grid-speciﬁc and time-dependent signature.

Meanwhile, the voltage signal from electric network could
be captured unintentionally by digital audio and video [2]
recordings if the device is directly connected to a power main
or is in the proximity of electric activities. The instantaneous
frequency of the captured electric network voltage signal is the

G. Hua, Q. Wang, and H. Zhang are with the School of
430072,
wqywqy@whu.edu.cn;

Information, Wuhan

University, Wuhan

ghua@whu.edu.cn;

Electronic
China
(e-mail:
haijian.zhang@whu.edu.cn).

D. Ye is with the School of Cyber Science and Engineering, Wuhan

University, Wuhan 430072, China (e-mail: yedp@whu.edu.cn).

Fig. 1. Demonstration of frequency data collection from power socket.

so-called electric network frequency (ENF). To authenticate
or verify the time-stamp of a suspect recording based on the
ENF criterion, one could extract the captured ENF and match
it to the corresponding frequency reference database, and the
matched location indicates the true time-stamp. This implies
that the availability of a long-range and high-quality frequency
database is essential for such an application.

One representative example of power frequency reference
database is the wide-area frequency monitoring network
(FNET) [3] deployed north America, consisting of multiple
frequency disturbance recorders (FDRs). This network collects
high ﬁdelity time-stamped frequency and other measurements,
enabling tasks such as frequency prediction [4], grid data pro-
cessing [5], monitoring and control [6], etc., besides serving
as the forensic reference [7]. Alternatively, according to intra-
grid consistency, one may directly collect electric signal from
an arbitrary power main using a step-down transformer and a
PC, and the reference ENF could be obtained by estimating the
signal?s instantaneous frequencies. A demonstrative example
of such a lightweight reference ENF collection system is
depicted in Fig. 1, which could be deployed in any place with
power supply. Over the past decade, the ENF criterion has
been extensively used in security-related applications includ-
ing time-stamp veriﬁcation [7]–[9], tampering detection [10]–
[13], region of recording estimation [14], [15], and camera
forensics [16], while ENF extraction from suspect recordings
has been the main technical challenge [17]–[19]. Recently,
research focus has been put on practical issues, including
factors affecting ENF capture in audio [20] and video [21].

A. Problem Statement and Motivation

Recall the two important properties that enable the power
system frequency to be a forensic criterion, i.e., intra-grid
consistency and random ﬂuctuation, the former has been well
studied by Grigoras [22] in three different cities of Romania
and then further addressed in subsequent works from other
parts of the world. It is also possible to design robust ENF

 
 
 
 
 
 
TABLE I
LIST OF COMMONLY USED RECORDING LENGTHS

Paper

[7]
[8]
[9]
[10]–[12]
[13]
[17]
[18]
[19]
[20]
[25]
[26]

Topic

Ref.?

LT

Time-Stamp
Time-Stamp
Time-Stamp
Tampering Detection
Tampering Detection
Frequency Estimation
Frequency Estimation
Frequency Estimation
ENF Capture
Video Forensics
Time-Stamp

Yes
Yes
Yes
No
Yes
No
Yes
Yes
No
Yes
Yes

> 10 min
2 ∼ 15 min
30 min
19 ∼ 35 s
6 ∼ 20 min
≤ 2 min
30 min
50 min
> 10 min
> 10 min
> 40 min

Note: “Ref.?” means whether reference ENF is needed.

reference databases [23]. For the latter, it has been discovered
that the frequency ﬂuctuation is approximately Gaussian dis-
tributed [24], and Garg et al. [24], [25] have shown that the
ENF could be modeled as a piecewise wide sense stationary
(WSS) process.

Exploiting the ENF properties, a time-stamp veriﬁcation
process is considered successful if the extracted ENF from a
suspect recording is uniquely and correctly matched to a piece
of reference frequency segment, where the reference corre-
sponds to a time interval (match scope) potentially containing
the true time-stamp of test recording. By uniquely it means
that the matching process should yield a single best match
via some measurements, e.g., mean squared error (MSE) or
correlation coefﬁcient (CC). By correctly it means that the
best match should indicate that the extracted test ENF and
the reference segment are similar enough for us to make a
decision, e.g., minimum MSE (MMSE) small enough to a
certain satisfaction or CC close to one.

Bearing this in mind, there naturally arises a question of
how reliable is the time-stamp veriﬁcation result given a test
recording and a match scope. The conﬁrmation of frequency
random ﬂuctuation and intra-grid consistency is a prerequisite
condition while the answer to this question is somewhat
more complicated. It is implicitly agreed among the existing
works that the length of recording should be more than 10
min to ensure reliable matching [27] (see summary in Table
I). However, in real-world situations a recording could have
any length, and there lacks both theoretical and experimental
support for 10 min to be an appropriate threshold. This has
given rise to a more speciﬁc question that till how short of a
test recording will the ENF matching become unreliable. In
fact, ENF reliability is determined not by a single factor, but
by the combination of multiple factors including

• length of test recording (LT);
• length of reference signal (match scope) (LR);
• ENF estimation temporal resolution (δ);
• signal-to-noise ratio (SNR).
In this paper, we comprehensively investigate the above
reliability-related factors. We concretize the concept of ENF
reliability by answering the question of how would these
factors affect the time-stamp matching result. We ﬁrst study

the AR modeling of the ENF, revealing its ultra low frequency
(“frequency of frequency”) nature and the ambiguity of ENF
temporal resolution. Then, we propose an efﬁcient AR(1)
model-based noisy ENF signal synthetic method directly in
time-frequency domain (TFD), which could effectively avoid
the unwanted inﬂuence of imperfect instantaneous frequency
(IF) estimators. Real-world reference electric network signals
of China Central Grid (recorded using the system depicted in
Fig. 1) are also used for the matching analysis. In addition,
white Gaussian processes, whose ﬂuctuation over time is
strictly random, are considered for performance benchmark.
Two analysis schemes are designed for real-world and syn-
thetic test data respectively. Through a comprehensive and
quantitative study, we discover the relationships among factors
affecting ENF matching. Note that in [28], ENF-based time-
stamp matching in video recordings has been analyzed. It
focused speciﬁcally on light sources, video compression, and
encoding methods. Our work differs from [28] by considering
the above-mentioned inherent factors applicable to any form
of recording media as long as the ENF is captured. In
addition, our analysis is conducted in a more comprehensive
and systematic manner.

The paper is organized as follows. ENF modeling and the
proposed noisy ENF synthesis method are detailed in Section
II. Performance metrics and the analysis schemes for synthetic
and real-world data are proposed in Section III respectively.
In Section IV, quantitative analysis results of ENF reliability
are presented, and the impacts of the considered factors are
evaluated and summarized. Section V concludes the paper.

II. ENF MODELING AND SYNTHESIS

A. AR Modeling of the ENF

1) The AR(1) Model: All the involved signals in this paper
are in discrete domain. The IF of electric network signal,
i.e., the ENF, denoted by f [n], is generated by passing a
white Gaussian noise (WGN) denoted by x[n], also termed
as innovation signal, through an M -order inﬁnite impulse
response (IIR) ﬁlter. This is equivalent to an AR(M ) process.
In the existing works, Garg et al. [24] have set M = 1 to
study time-stamp veriﬁcation, Hajj-Ahmad et al. [15] have set
M = 2 for ENF feature extraction, while Hajj-Ahmad et al.
[29] have set M = 1 for a synthetic model. In this paper, we
adopt the AR(1) synthetic model, which is given by

f [n] = af [n − 1] + x[n],

(1)

where a is the unknown coefﬁcient, and x[n] ∼ N (0, σ2
x).
Note that the mean value of the ENF is removed during
ENF modeling [24], thus f [n] is a zero-mean process. For
notation simplicity, we still use f [n] to denote the ENF after
the mean value is added back to it. The coefﬁcient a could
be neatly solved via Levinson-Durbin recursion, with the use
of the ground-truth frequency data. Our collection of the
frequencyreference data from Central China Grid (for about
3 years) is used for ENF modeling.

The model coefﬁcient is determined together with the study
of the temporal resolution of f [n], denoted by δ second per

Hajj-Ahmad et al. [29]

Garg et al. [24]

0.1

0.2

0.4

1

2

5

10

50

0

-10

-20

-30

-40

1.1

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

10

0

-10

-20

-30

-40

-50

-60

-70

-80

250

200

150

100

50

0

0

200

400

600

800

1000

0

0.005

0.01

Fig. 3. Elapsed time of TAD synthesis versus ENF length

0

0.02

0.04

0.06

0.08

0.1

0.12

0.14

0.16

0.18

0.2

Fig. 2. ENF modeling results. Upper: a versus δ. Lower: Energy density
spectrum of a 2-hour ENF reference, where δ = 1 spp.

point (spp). Consider the ENF f [n] as a sampled discrete-
time signal, then its sampling frequency is equal to 1/δ Hz,
which is the reciprocal of the temporal resolution. One should
distinguish between the sampling frequency of time-amplitude
domain (TAD) electric network signal and that of the TFD:

• TAD sampling frequency: fS Hz;
• TFD sampling frequency: 1/δ Hz, 1/δ ≤ fS .

To solve for a and reveal the impact of δ, we ﬁrst randomly
select a 1-day (and 1-month) TAD reference electric network
signal. Then, a 1-hour segment is randomly selected from the
1-day (and 1-month) reference, and the corresponding f [n] is
obtained with a resolution of δ spp. After that, f [n] is fed
into model (1) to solve for a. The above process is repeated
100 times, and the averaged values of a as a function of δ are
shown in Fig. 2 upper plot. It can be seen when the temporal
resolution is sufﬁciently high, i.e., δ < 5 spp, the AR(1) model
yields a = 1. However, if δ > 10 spp, then it is unable to
resolve the ENF and a starts to drop rapidly. For the model
to be stable (pole inside unit circle), we set a = 0.99.

2) Frequency of the ENF: The ENF is expected to be a very
low frequency signal for its slowly-varying nature. To verify
this, the energy density spectrum of a 2-hour ENF reference
segment is presented in Fig. 2 lower plot, where δ = 1 spp. We
observe that the energy concentrates at exteame low frequency
region and becomes weaker than −20 dB when frequency is
higher than 0.01 Hz. Based on the two plots in Fig. 2, the
frequency of the ENF in Central China Grid is approximately
less than 1/20 Hz, thus, the common setting δ = 1 spp is
sufﬁcient to sample the ENF (no aliasing). Note that Garg et
al. [24] have used δ = 16 spp, indicating the frequency of the
ENF in the speciﬁc USA grid is less than 1/32 Hz.

3) Temporal Resolution Ambiguity of AR(1): In the upper
plot of Fig. 2 it can be seen that if δ < 2 spp, then a → 1.
This indicates that we are unable to deduce 1/δ or equivalently
the TFD sampling frequency of the ENF given a synthetic
f [n] using (1) with a = 0.99. We refer to this phenomenon
as the temporal resolution ambiguity of AR(1) model for the
ENF. The reasons are twofold. First, AR(1) may not be the
optimal ENF model embodying all of its important statistical
properties. This leads us to more in-depth study of ENF
modeling, which is not in the scope of this paper. Second, high
temporal resolution for ENF estimation may be a redundant
setting, since the ENF is slowly varying and its frequency is
very low as indicated by Fig. 2.

B. Synthesis of Noisy Electric Network Signal

To reveal the inherent properties of the ENF, we exclude
factors affecting ENF capture and base our analysis on the
best situation in which the captured ENF is identical to the
corresponding reference segment. Therefore, SNR-unrelated
analysis is carried out by extracting a segment of the reference,
considering it as the ENF extracted from a recording, and
then matching it with a long reference signal. For SNR-related
analysis, noise is added to the electric network signal before
IF estimation. This requires us to synthesize noisy ENFs.

1) TAD Synthesis: An intuitive way to synthesize a noisy
ENF signal is to ﬁrst synthesize the TAD waveform of the
electric network signal, then add noise to the waveform, and
ﬁnally perform IF estimation. The TAD electric network signal
is modeled by a cosine wave with an unknown initial phase φ
and time-varying amplitudes A[n] > 0 and IFs, i.e.,

s[n] = A[n] cos

2πT

f [i] + φ

,

(2)

n

i=0

(cid:16)

X

(cid:17)

where n = 0, 1, . . . , N − 1, the IFs f [n] is the ENF, and
T = 1/fS is the sampling interval. Denote the additive white
Gaussian noise (AWGN) by v[n], then we deﬁne the SNR by
s2[n]

v2[n].

SNR =

(3)

The synthetic noisy ENF is then obtained by the estimation
of f [n] from the noisy observation s[n] + v[n] where the

n

X

n

.X

TABLE II
SCHEME 1 – SYNTHETIC DATA ANALYSIS

1. Assign values to the factors:

· ENF temporal resolution δ, 1/δ ≤ fS,
· Search scope and reference length LR,
· Test recording length LT,
· SNR;
Synthesize fR[n] using (1), a = 0.99;
2.
3. Obtain fT[n] as a random segment of fR[n];
4. Record ground truth location k0;
5.
6. Match fT[n] with fR[n] using (7) or (8);
7. Determine the tolerance parameter ǫ;
8. Decide if the matching is successful using (9).

Synthesize noisy test ENF using (4) and (5);

TABLE III
SCHEME 2 – REAL-WORLD DATA ANALYSIS

1.

Assign values to the factors:
· ENF temporal resolution δ, 1/δ ≤ fS,
· Search scope and reference length LR,
· Test recording length LT,
· SNR;
Obtain TAD reference ENF from database;
2.
Select TAD test ENF randomly from reference;
3.
Record and convert ground truth location to k0;
4.
Add noise to the test signal according to SNR;
5.
Estimate fT[n] and fR[n] based on STFT;
6.
7. Match fT[n] with fR[n] using (7) or (8);
Determine the tolerance parameter ǫ;
8.
Decide if the matching is successful using (9).
9.

variance of v[n] is determined by a given SNR. Based on the
slowly varying nature of the ENF, the observed noisy signal
is partitioned into overlapping frames and for each frame it is
assumed the IF is constant within the frame interval. A single
tone frequency estimator is then applied for each frame to
extract the IF. However, this process has two limiations.

• The summation in (2) introduces a heavy computational
burden, especially when N is large. Speciﬁcally, to gener-
ate a single sample s[n] at time n, the current and all the
previous samples of f [n] are summed. The total number
of additions in (2) is N (N + 1)/2. This is veriﬁed by
Fig. 3. The common synthesis of 1 week or longer noisy
ENF thus becomes unrealistic even under current state-
of-the-art computation power.

• The imperfection of IF estimators prevents us from dis-
covering the inherent properties of the ENF. It is known
that Fourier analysis based normal resolution estimators
are only asymptotically optimal, while high resolution
estimators (e.g., MUSIC, ESPRIT) are very sensitive to
noise. As a result, the inaccuracy of ENF matching may
be caused not only by the said factors in Section I-B,
but also by the gap between the selected estimator and a
minimum variance unbiased estimator (MVUE).

2) TFD Synthesis: To reduce the computational load and
avoid the limitation of imperfect IF estimators, we propose a
method to directly generate noisy ENF in the TFD. The vari-
ance of estimation errors caused by noise could be described
by the Cramer-Rao lower bound (CRLB) given by [30]

CRLBf =

12

SNR × NF (N 2

F − 1)

2

fS
2π (cid:19)

,

×

(cid:18)

(4)

where NF is the number of samples per frame. Assuming
stationarity, the local SNR in (4) is approximated by the global
SNR in (3). Based on (4), the adding noise process, denoted
by g(f [n], SNR), is given by

g(f [n], SNR) = f [n] + e[n],

(5)

where e[n] ∼ N (0, CRLBf ). We could think of g(f [n], SNR)
as an MVUE of the ENF, because its mean and variance are

E {g(f [n], SNR)} = f [n],
var {g(f [n], SNR)} = CRLBf .

(cid:26)

(6)

The proposal of (5) for the synthesis of noisy ENF is much
more efﬁcient and accurate than ﬁrst generating s[n] followed
by estimating the IFs from (s[n] + v[n]).

III. RELIABILITY ANALYSIS SCHEME

A. Performance Metrics

We denote the test ENF by fT[n] and the reference ENF by

fR[n], then the matched location, denoted by ˆk, is given by

(7)

,

ˆk = arg min

k X

(fT[n] − fR,k[n])

2

,

n

and

n [(fT[n] − µT) (fR,k[n] − µR,k)]

ˆk = arg max

k

P
n (fT[n] − µT)
qP

2

2
n (fR,k[n] − µR,k)

P

(8)
based on the MSE and CC respectively, where fR,k[n] =
fR[n + k], µT is the sample mean of fT[n], and µR,k is the
sample mean of fR,k[n]. In most situations the two metrics
yield very similar results. The former is more computationally
efﬁcient while the latter is slightly more accurate. In our
study, the two metrics are used alternatively where appropriate.
Further, let the ground truth matched location be k0, then the
absolute matching error is given by |ˆk − k0|. We consider the
matching result to be successful if

ˆk − k0
(cid:12)
where ǫ is a toleration parameter. This means that matching
(cid:12)
errors within ǫδ seconds are acceptable in practice.

< ǫ,

(9)

(cid:12)
(cid:12)

B. Proposed Analysis Schemes

The analysis schemes are summarized in Tables II and III
for synthetic data (Scheme 1) and real-world data (Scheme
2) respectively. The schemes are parameterized by the factors
under investigation. Note that Scheme 1 directly operates in
TFD, thus time-frequency analysis is not needed. However,
time-frequency analysis is need in Scheme 2 to transform the
real-world data from TAD to TFD. We adopt the widely used
frequency estimator which combines the short-time Fourier
transform (STFT) and an interpolation mechanism [29], for its
balance among time/frequency resolution, robustness against
AWGN, and computational complexity.

2.5

2

1.5

1

0.5

0

)

%

(

o
i
t
a
R

0.1

0.2

0.3

0.5

0.4
0.7
Correlation Coefficient

0.6

106

105

104

103

102

101

0

0.8

0.9

1

2

4

6

8

10

Fig. 4. Ratio of different CC values for ENF matching in noise-free
situation, averaged from 100 random realizations, where fS = 400 Hz,
δ = 1 spp, and length of reference LR = 168 h (1 week).

Fig. 5. Counts of similar matches versus LT in noise-free situation,
averaged from 100 random realizations where fS = 400 Hz, δ = 1
spp, and LR = 168 h (1 week).

In both schemes, the same factors are initialized in Step 1. In
Step 2 of Scheme 1, δ is the sampling interval of the innovation
signal x[n], while in Step 6 of Scheme 2, δ is the STFT frame
step-size. Besides, the test ENF is in fact a random segment of
the reference ENF, where the reference is either synthesized
in TFD from the AR(1) model or obtained in TAD from the
reference database. In this way, one can exclude unwanted
factors, e.g., potential problems caused by test recording
devices, non-stationary noise, clock desynchronization, etc.,
and focus on the inherent factors affecting ENF matching.

In addition, to gain more insights about the reliability of
the frequency ﬂuctuation as a forensic criterion, we also use
independent and identically distributed (i.i.d.) Gaussian signal
as the ENF. It represents the case of the most random ﬂuc-
tuation. Since such a signal is strictly random in which even
consecutive samples are uncorrelated, the temporal resolution
δ becomes a trivial factor. This analysis is realized by replacing
Step 2 of Scheme 1 with a white Gaussian distributed sequence
of a length deﬁned by the match scope.

IV. RESULTS AND DISCUSSIONS

This section presents the analysis results on the factors
affecting forensic ENF matching, i.e., LT, LR, δ, and SNR,
respectively. Experiments using synthetic data are carried out
via Scheme 1 while those using real-world reference ENF data
are carried out via Scheme 2.

A. Length of Test Recording

We ﬁrst consider the ideal noise-free case, in which we
choose an arbitrary 168-hour (1 week) reference ENF and
extract a small segment as the test data. Due to the random
there would be exactly one matched
ﬂuctuation property,
location corresponding to zero MSE. However, there would
exist similar matches in other locations. This is illustrated
in Fig. 4, where CC is used as the metric and the region
CC ∈ [−1, −0.1) is not presented for clarity. It can be seen
that for short recordings, e.g., LT = 1 or 2 min, there exist

100

90

80

70

60

50

40

30

20

10

0

0

2

4

6

8

10

Fig. 6. Analysis results on the factor of length of test ENF, i.e., LT,
averaged from 100 random realizations, where fS = 400 Hz, ǫ = 10 s,
δ = 1 spp, and LR = 168 h (1 week).

a large ratio of reference segments having CC values close
to 1. This indicates that in practical situations where noise
is inevitable, those similar segments would introduce false
matches. As the length of test recording increases, the amount
of similar matches is reduced rapidly. Noticeably, for white
and Gausian distributed benchmark signal, it exhibits high
uniqueness property as there is almost no match yielding a CC
value greater than 0.5 even when LT = 1 min. The averaged
counts of similar ENF matches quantiﬁed by CC ≥ 0.8, 0.9,
and 0.99 respectively are presented in Fig. 5 for different
values of LT. It shows that for a match scope spanning 1
week, even for long test recordings of 10 min, there exist about
1000 reference segments yielding CC ≥ 0.8, 200 yielding
CC ≥ 0.9, and 30 yielding CC ≥ 0.99. As LT reduces,
the numbers of similar matches increase signiﬁcantly. When
LT < 3 min, even the number of similar matches with
CC ≥ 0.99 increases rapidly.

We now consider noisy situations with AWGN, and results

 
100

90

80

70

60

50

40

30

20

10

0

100

90

80

70

60

50

40

30

20

10

0

0

100

200

300

400

500

0.5

1

2

4

8

16

32

Fig. 7. Analysis results on the factor of length of reference ENF, i.e., LR,
averaged from 100 random realizations, where fS = 400 Hz, ǫ = 10 s,
δ = 1 spp, and SNR = −25 dB.

Fig. 8. Analysis results on the inﬂuence of LT/LR on matching accuracy,
averaged from 100 random realizations, where fS = 400 Hz, ǫ = 10 s,
δ = 1 spp, and SNR = −25 dB.

are shown in Fig. 6. Due to the weakness of the electric
network signal compared to recorded audio content and noise,
we consider relatively low SNR situations here. We note from
this ﬁgure that SNR = −30 dB leads to the failure of ENF
matching, while the synthetic signal does not suffer from this.
Further, the accuracies increase rapidly when LT > 2 min,
indicating that when the match scope is 1 week, the length of
test recording is preferred to be greater than 2 min for reliable
forensic matching. However, in high SNR situations, one may
still successfully work with reduced test recording lengths.

B. Length of Reference ENF (Match Scope)

We consider a wide range of match scopes from 1 to 496
h (≈ 3 weeks). The matching accuracies versus the match
scope is presented in Fig. 7 using real-world reference, AR(1)
synthetic data, and white Gaussian signals respectively. When
LT = 1 and 2 min, the accuracy curves of the real-world
and AR(1) synthetic data are very close to each other. They
both decrease rapidly when LR increases from 1 to 50 h. This
indicates that when dealing with very short recordings, it is
necessary to narrow down the match scope to be less than 2
days to ensure reliable matching. For 1-min test recordings
and under −25 dB SNR, the accuracy only reaches 50% even
when LR = 1 h. The only way to improve matching accuracy
for this challenging case may be trying to suppress the noise
and improve the SNR condition, as indicated in Fig. 6. We
further note from Fig. 7 that the accuracies are substantially
improved for longer test recordings. When LT = 5 min, the
accuracies of real-world and AR(1) data reach the levels of
90% and 100% respectively. For white Gaussian signal, the
length of reference data is not an issue as we can see that the
accuracies are constantly 100% across the values of LR even
when the duration of test ENF is only 2 min.

To provide more insights, we further look into the effects
of the ratio LT/LR, and the results are presented in Fig.
8. Intuitively, for short test recordings, one may work to
narrow down the match scope so that the test ENF is more
likely to be correctly matched to the reference data; for long

100

80

60

40

20

0

0.1 1 2

5

10

15

20

Fig. 9. Analysis results on the factor of ENF temporal resolution δ using
real-world data, averaged from 100 random realizations, where fS =
400 Hz, ǫ = 10 s, and LR = 168 h (1 week).

test recordings, the match scope could be reasonably longer.
However, it can be seen from Fig. 8 that the accuracies are
not a constant for a ﬁxed ratio of LT/LR. It is observed that
for a 0.5-min real-world test ENF, the accuracy is only 70%
even if LR = 5 min. If LR = 5 is increased to 50 min, i.e.,
LT/LR = 1/100, the accuracy becomes only 20%. On the
other side, if LT ≥ 8 min, the matching accuracies become
100% for both real-world and white Gaussian data even if
LT/LR = 1/1000. For a 32-min test ENF, the accuracy is
100% even if the match scope spans 23 days.

C. Temporal Resolution δ

We now investigate the inﬂuence of ENF temporal res-
olution δ on the matching accuracy. Due to the temporal
resolution ambiguity of synthetic data, results shown in this
subsection are based on real-world data only. The matching
accuracies under different values of δ are presented in Fig. 9. It
can be seen that the accuracies are generally not very sensitive
to δ as we observe that the curves do not intersect. Noticeably,

-50

-40

-30

-20

-10

0

10

(a) Real-world data.

100

90

80

70

60

50

40

30

20

10

0

100

90

80

70

60

50

40

30

20

10

0

-50

-40

-30

-20

-10

0

10

(b) Synthetic data.

Fig. 10. Analysis results on the factor of SNR using real-world and
synthetic data, averaged from 100 random realizations, where fS = 400
Hz, ǫ = 10 s, δ = 1 spp, and LR = 168 h (1 week).

when SNR = −20 dB and LT = 5 min, the degradation is
minimal (< 5%) even if δ = 20 spp. This result is generally
consistent with the analysis of the frequency of the ENF
presented in Section II-A-2). Meanwhile, it is important to note
that using very high temporal resolution (e.g., δ = 0.1 spp)
may also cause performance degradation. Another drawback
of using very high temporal resolution is the linearly increased
computational burden. Therefore, a sound choice of δ should
ensure no loss of ENF detail while maintaining a reasonable
computational complexity. According to Fig. 9, a sound choice
of ENF temporal resolution could be δ = 1 to 5 spp.

D. SNR

Matching accuracies under different SNR values are shown
in Figs. 10. We observe that for real-world data, SNR = −30
dB is again seen as the boundary under which none of the
settings could work. However, this boundary reduces to −40
dB for the AR(1) and white Gaussian models. In Fig. 10
(a), the test ENF exhibits consistently high uniqueness when
LT > 5 min. LT is thus again seen to be the most important
factor in ENF matching. Besides, for the 1-min test recording,

TABLE IV
SUMMARY OF FACTORS AFFECTING ENF RELIABILITY (RANKED)

Rank
1
2
3
4

Nature
External
Inherent
Inherent
Inherent

Factor
SNR
LT
LR
δ
Impact Relationship: SNR > LT ≫ LR ≫ δ

Preferable Condition
SNR > −25 dB
LT > 5 min, longer the better
LR > LT, shorter the better
1 ≤ δ ≤ 5 spp

increasing the temporal resolution by 10 times did not offer
any performance gain, while increasing LR from 1 week to
1 month resulted in noticeable degradation. However, reliable
ENF matching could still be expected if SNR > 10 dB. In
Fig. 10 (b), both the curves using AR(1) and white Gaussian
signals could serve as the performance bounds, but they are
somewhat loose as compared with the curves in Fig. 10 (a).

E. Summary and Discussion

In summary, the four factors determining ENF-reliability
are ranked according to their impacts in descending order, as
shown in IV. Among these factors, SNR is an external one,
while the others reﬂect inherent ENF properties. If the SNR
prevents us from extracting the ENF from the recording (e.g.,
SNR < −30 dB), then ENF analysis becomes inapplicable.
If the SNR permits ENF-based forensic analysis,

then
among the other factors, the length of test ENF] LT has the
most signiﬁcant impact. Based on results shown in Figs. 6-8
and 10 (a), if LT < 5 min, then it simultaneously requires a
high SNR condition and a narrow match scope for us to have
a successful match. It is important to specially note for very
short recordings with LT < 1 min, which requires a very high
SNR and an extremely narrow match scope. However, if the
test ENF is sufﬁciently long, e.g., LT > 10 min, then it is
highly possible to correctly match the time-stamp even if LR
is longer than 1000 times of LT, as seen from Figs. 7-10.

While LT is solely determined by who made the recording,
it
is possible to work by various means to narrow down
the match scope LR. If LR. contains the true time-stamp
information, then a smaller LR generally yields improved
matching accuracy. However, the matching accuracy is not a
constant for a ﬁxed test-reference ratio LT/LR, as shown in
Fig. 8. Therefore, if LT is the primary factor that determines
how successful it could be matched to the reference data,
then LR serves as a secondary one, reducing it could further
improve matching accuracy.

For the temporal resolution δ, we have found that it has little
impact on the matching accuracy. On the one hand, the slowly
varying nature of the ENF yields its frequency to be lower
than 1/20 Hz in Central China Grid, as discussed in Section
II-A-2). This indicates that as long as the TFD ENF sampling
frequency 1/δ > 1/10 Hz, i.e., δ < 10 spp, there is no loss
of ENF information according to Nyquist theorem. On the
other hand, a too granular ENF signal, e.g., δ = 0.1 spp, may
cause negative effect, as shown in Fig. 9. Ultra high temporal
resolution may be redundant in forensic ENF matching, which
is somewhat opposite to our intuition.

V. CONCLUSION

Power system frequency could be utilized to forensically
time-stamping audio recordings, but there is a lack of re-
search to answer under what conditions could the time-
stamp matching be uniquely and accurately performed. This
paper has answered this question in a comprehensive manner,
considering a set of four factors. We have proposed a TFD
noisy ENF synthesis method which is more accurate and com-
putationally efﬁcient than the direct TAD synthesis. Using the
proposed analysis schemes for both real-world and synthetic
data, we have come to the conclusion that the SNR is the
most important external factor. Among the other three inherent
factors, the length of test recording is the most important
factor, followed by the length of reference ENF (search scope).
In addition, the ENF matching process has been found to be
insensitive to ENF temporal resolution. This paper reveals the
challenge in dealing with very short recordings (e.g., LT < 1
min). Besides, the AR(1) model may not fully characterize
the statistical properties of the ENF. Note that AR(1) with
a → 1 is approximately a random walk model, which is non-
stationary. However, the ENF is in fact seen to be a stationary
process. Therefore, it is worthy to carry out in-depth research
on ENF modeling for future work.

REFERENCES

[1] R. C. Maher, “Audio forensic examination: authenticity, enhancement,
and interpretation,” IEEE Signal Process. Mag., vol. 2, no. 2, pp. 84–94,
Mar. 2009.

[2] S. Vatansever, A. E. Dirik, and N. Memon, “Detecting the presence of
ENF signal in digital videos: A superpixel-based approach,” IEEE Signal
Process. Lett., vol. 24, no. 10, pp. 1463–1467, Oct. 2017.

[3] Y. Zhang, P. Markham, T. Xia, L. Chen, Y. Ye, Z. Wu, Z. Yuan, L. Wang,
J. Bank, J. Burgett, R. W. Conners, and Y. Liu, “Wide-area frequency
monitoring network (FNET) architecture and applications,” IEEE Trans.
Smart Grid, vol. 1, no. 2, pp. 159–167, Sep. 2010.

[4] J. Dong, X. Ma, S. M. Djouadi, H. Li, and Y. Liu, “Frequency prediction
of power systems in FNET based on state-space approach and uncertain
basis functions,” IEEE Trans. Power Systems, vol. 29, no. 6, pp. 2602–
2612, Nov. 2014.

[5] Y. Yao, S. Xiong, H. Qi, Y. Liu, L. M. Tolbert, and Q. Cao, “Efﬁcient
histogram estimation for smart grid data processing with the loglog-
bloom-ﬁlter,” IEEE Trans. Smart Grid, vol. 6, no. 1, pp. 199–208, Jan.
2015.

[6] Y. Liu, L. Zhan, Y. Zhang, P. N. Markham, D. Zhou, J. Guo, Y. Lei,
G. Kou, W. Yao, J. Chai, and Y. Liu, “Wide-area-measurement system
development at the distribution level: an FNET/GridEye example,” IEEE
Trans. Power Del., vol. 31, no. 2, pp. 721–731, Apr. 2016.

[7] Y. Liu, Z. Yuan, P. N. Markham, R. W. Conners, and Y. Liu, “Application
of power system frequency for digital audio authentication,” IEEE Trans.
Power Del., vol. 27, no. 4, pp. 1820–1828, Oct. 2012.

[8] G. Hua, J. Goh, and V. L. L. Thing, “A dynamic matching algorithm
for audio timestamp identiﬁcation using the ENF criterion,” IEEE Trans.
Inf. Forensics Security, vol. 9, no. 7, pp. 1045–1055, Jul. 2014.

[9] L. Zheng, Y. Zhang, C. E. Lee, and V. L. L. Thing, “Time-of-recording
estimation for audio recordings,” in Proceedings of Digital Forensic
Research Conference (DFRWS US), pp. 1–11, 2017.

[12] P. M. G. I. Reis, J. P. C. Lustosa da Costa, R. K. Miranda, and G. Del
Galdo, “ESPRIT-Hilbert-based audio tampering detection with SVM
classiﬁer for forensic analysis via electrical network frequency,” IEEE
Trans. Inf. Forensics Security, vol. 12, no. 4, pp. 853–864, Apr. 2017.

[10] D. P. N. Rodr´ıguez, J. A. Apolinario, and L. W. P. Biscainho, “Audio
authenticity: Detecting ENF discontinuity with high precision phase
analysis,” IEEE Trans. Inf. Forensics Security, vol. 5, no. 3, pp. 534–543,
Sep. 2010.

[11] P. Esquef, J. A. Apolinario, and L. Biscainho, “Edit detection in speech
recordings via instantaneous electric network frequency variations,”
IEEE Trans. Inf. Forensics Security, vol. 9, no. 12, pp. 2314–2326, Dec.
2014.

[13] G. Hua, Y. Zhang, J. Goh, and V. L. L. Thing, “Audio authentication
by exploring the absolute-error-map of ENF signals,” IEEE Trans. Inf.
Forensics Security, vol. 11, no. 5, pp. 1003–1016, May. 2016.

[14] C. W. Wong, A. Hajj-Ahmad, and M. Wu, “Invisible geo-location
signature in a single image,” in Proc. 2018 IEEE Int. Conf. Acoustics
Speech and Signal Processing (ICASSP), pp. 1987–1991, Apr. 2018.

[15] A. Hajj-Ahmad, R. Garg, and M. Wu, “ENF-based region-of-recording
identiﬁcation for media signals,” IEEE Trans. Inf. Forensics Security,
vol. 10, no. 6, pp. 1125–1136, Jun. 2015.

[16] A. Hajj-Ahmad, A. Berkovich, and M. Wu, “Exploiting power signatures
for camera forensics,” IEEE Signal Processing Lett., vol. 23, no. 5, pp.
713–717, May. 2016.

[17] L. Fu, P. N. Markham, R. W. Conners, and Y. Liu, “An improved
discrete fourier transform-based algorithm for electric network frequency
extraction,” IEEE Trans. Inf. Forensics Security, vol. 8, no. 7, pp. 1173–
1181, Jul. 2013.

[18] X. Lin and X. Kang, “Robust electric network frequency estimation with
rank reduction and linear prediction,” ACM Trans. Multimedia Comput.
Commun. Appl., vol. 14, no. 4, pp. 84:1–84:13, Oct. 2018.

[19] A. Hajj-Ahmad, R. Garg, and M. Wu, “Spectrum combining for ENF
signal estimation,” IEEE Signal Process. Lett., vol. 20, no. 9, pp. 885–
888, Sep. 2013.

[20] A. Hajj-Ahmad, C. Wong, S. Gambino, Q. Zhu, M. Yu, and M. Wu,
“Factors affecting ENF capture in audio,” IEEE Trans. Inf. Forensics
Security, vol. 14, no. 2, pp. 277–288, Feb. 2019.

[21] S. Vatansever, A. E. Dirik, and N. Memon, “Analysis of rolling shutter
effect on ENF based video forensics,” IEEE Trans. Inf. Forensics
Security, vol. 14, no. 9, pp. 2262–2275, Sep. 2019.

[22] C. Grigoras, “Applications of ENF criterion in forensic audio, video,
computer and telecommunication analysis,” Forensic Sci. Int., vol. 167,
no. 2-3, pp. 136–145, Apr. 2007.

[23] M. M. Elmesalawy and M. M. Eissa, “New forensic ENF reference
database for media recording authentication based on harmony search
technique using GIS and wide area frequency measurements,” IEEE
Trans. Inf. Forensics Security, vol. 9, no. 4, pp. 633–644, Apr. 2014.

[24] R. Garg, A. L. Varna, and M. Wu, “Modeling and analysis of electric
network frequency signal for timestamp veriﬁcation,” in Proc. IEEE int.
WIFS, pp. 67–72, Dec. 2012.

[25] R. Garg, A. L. Varna, A. Hajj-Ahmad, and M. Wu, “Seeing ENF: Power
signature based timestamp for digital multimedia via optical sensing and
signal processing,” IEEE Trans. Inf. Forensics Security, vol. 8, no. 9, pp.
1417–1432, Sep. 2013.

[26] Y. Liu, Z. Yuan, P. N. Markham, R. W. Conners, and Y. Liu, “Wide-
area frequency as a criterion for digital audio recording authentication,”
in Proc. IEEE Power and Energy Soc. General Meeting, pp. 1–7, Jul.
2011.

[27] M. Huijbregtse and Z. Geradts, “Using the ENF criterion for determining
the time of recording of short digital audio recordings,” in Proc. 3rd
IWCF, vol. 1, pp. 116–124, Aug. 2009.

[28] S. Vatansever, A. E. Dirik, and N. Memon, “Factors affecting ENF
based time-of-recording estimation for video,” in IEEE International
Conference on Acoustics, Speech and Signal Processing (ICASSP), pp.
2497–2501, 2019.

[29] A. Hajj-Ahmad, R. Garg, and M. Wu, “Instantaneous frequency estima-
tion and localization for ENF signals,” in Proceedings of The 2012 Asia
Paciﬁc Signal and Information Processing Association Annual Summit
and Conference (APSIPA 2012), pp. 1–10, Dec. 2012.

[30] S. M. Kay, Fundamentals of Statistical Signal Processing: Estimation

Theory. Upper Saddle River, NJ, USA: Prentice Hall, 1993.

