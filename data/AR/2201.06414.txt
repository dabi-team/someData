2
2
0
2

n
a
J

7
1

]

C
O
.
h
t
a
m

[

1
v
4
1
4
6
0
.
1
0
2
2
:
v
i
X
r
a

Almost-Riemannian Structures on nonnilpotent, solvable 3D Lie
groups

V´ıctor Ayala∗
Instituto de Alta Investigaci´on
Universidad de Tarapac´a, Arica, Chile
Danilo A. Garc´ıa Hern´andez† and Adriano Da Silva‡
Instituto de Matem´atica
Universidade Estadual de Campinas, Brazil

January 19, 2022

Abstract

In this paper we study Almost-Riemannian Structures (ARS) on the class of nonnilpotent, solvable,
conneted 3D Lie groups. The nice structures present in such groups allow us to show that the singular locus
of ARS’s are always embedded submanifolds and that isometries between rank two ARS’s are always group
automorphisms.

Keywords: Almost-Riemannian geometry, solvable Lie groups, isometries

Mathematics Subject Classiﬁcation (2010): 22E15, 22E25, 53C17, 53C15.

1 Introduction

Almost-Riemannian Structures (ARS’s) appears in the literature as a part of sub-Riemannian geometry.
Roughly speaking, an ARS on a diﬀerentiable manifold can be seen, at least locally, as a smooth orthonormal
frame that degenerates on a singular set, called the singular locus. They appear naturally when studying limits
of Riemmanian metrics or even in the study of certain class of hypoelliptic operators [14]. Such concept appeared
ﬁrst in the work [19] but has aroused interest more recently as shown in the works [2, 3, 7, 8, 9, 10, 11, 12, 13].

On a connected n-dimensional Lie group G, an ARS is naturally obtained by considering n − 1 left-invariant
vector ﬁelds and one linear vector ﬁeld. These family of vector ﬁelds are assumed to have full rank at a nonempty
subset of G and to satisfy the Lie algebra rank condition. The singular locus is the set of points were these
vector ﬁelds fail to be linearly independent. It is an analytic set, but in general is neither a Lie subgroup nor a
submanifold as showed in [6].

In this paper we study the ARS’s on connected 3D solvable nonnilpotent Lie groups. By general results presented
in the Appendices, our task is reduced to the simply connected case. For this class of groups, our work can be
divided in two main parts: The ﬁrst one is the study of the singular locus. We show that the singular locus of
simple ARS’s on theses groups are always submanifolds. We also analyze connectedness of the singular locus
and how do exponential curves crosses it. The second part is concerned with isometries between ARS’s. Our
main result shows that isometries between the class of rank two ARS’s are always group automorphisms. As a
consequence, a classiﬁcation by isometries of ARS’s on the 3D groups under consideration is obtained.

∗Supported by Proyecto Fondecyt n◦ 1190142. Conicyt, Chile.
†Supported by Capes Finance Code 001
‡Supported by Fapesp grant no 2020/12971-4 and CNPq grant no 309820/2019-7

1

 
 
 
 
 
 
The paper is divided as follows: Section 2 is used to set some preliminaries needed on the paper. We deﬁne
here the class of 3D groups and algebras we are interested and obtain algebraic expressions for the algebra of
derivations and the group of automorphisms at algebra and group level. In Section 3 we deﬁne simple ARS’s
on Lie groups. By using the nice structures present on our class of 3D Lie groups, we are able to show that the
singular locus of simple ARS on these groups are always submanifolds. Moreover, a suﬃcient condition for the
connectedness of the singular locus is obtained. We ﬁnish the section with an analysis of how the exponential
curves crosses the singular locus. Such study is very important in our main result about isometries, since we
do not have (a priori)) any condition concerning the regularity of the isometry on points of the singular locus.
Section 4 is devoted to the study of isometries between simple ARS’s. Our main result shows that isometries
between rank two ARS’s are group automorphisms. Such result allow us to classify the class of rank two ARS’s
on any 3D solvable nonnilpotent Lie group. We ﬁnish the paper with two Appendix, the ﬁrst one containing
some results about the dynamics of 2 × 2 matrices and the second one showing that simple ARS’s on connected
Lie groups can be lifted to its simply connected lift. As a consequence, all the results contained in Sections 3
and 4 are true for any 3D connected nonnilpotent solvable Lie groups.

2 Preliminaries

In this section we discuss 3D Lie groups and algebras. Our aim here is to introduce and prove some preliminares
results concerning automorphisms of algebra and group, invariant and linear vector ﬁelds.

2.1 Solvable nonnilpotent 3D Lie algebras

By [18, Chapter 7] any solvable, nonnilpotent 3D Lie algebra is isomorphic to a semi-direct product of the form
g(θ) = R ×θ R2 with bracket determined by the relation

and θ a 2 × 2 matrix of one of the following types:

[(a, 0), (0, w)] = (0, aθw),

(a, w) ∈ R × R2,

(cid:18) 1 1
0 1

(cid:19)

,

(cid:19)

(cid:18) 1

0
0 λ

, λ ∈ [−1, 1]

or

(cid:19)

(cid:18) λ −1
λ
1

, λ ∈ R.

Let us remember that an automorphism and a derivation of a Lie algebra g are, respectively, linear maps
φ ∈ Gl(g) and D ∈ gl(g) satisfying

∀X, Y ∈ g, φ[X, Y ] = [φX, φY ]

and D[X, Y ] = [DX, Y ] + [X, DY ].

Let M ∈ gl(g(θ)) and assume that M R2 ⊂ R2. Then, M can be written as

M =

(cid:19)

(cid:18) ε

0
η P

, η ∈ R2, ε ∈ R and P ∈ gl(2, R).

Since {0} × R2 is the nilradical of g(θ), it is invariant by automorphism and derivations. Hence, if φ ∈ Aut(g(θ))
the relation

φ[(a, 0), (0, v)] = [φ(a, 0), φ(0, v)], ∀(a, v) ∈ R × R2,

implies that

φ =

(cid:19)

(cid:18) ε

0
η P

∈ Aut(g(θ))

if and only if P θ = εθP.

Similarly, if D ∈ Der(g(θ)) the relation

D[(a, 0), (0, v)] = [D(a, 0), (0, v)] + [(a, 0), D(0, v)], ∀(a, v) ∈ R × R2

2

gives us that we get that

D =

(cid:19)

(cid:18) ε

0
η A

∈ Der(g) ⇐⇒ Aθ − θA = εθ.

The previous calculations imply the following:

2.1 Proposition: It holds that:

and

Der(g(θ)) =

(cid:19)

(cid:26)(cid:18) 0

0
ξ A

Aut(g(θ)) =

(cid:26)(cid:18) ε

0
η P

(cid:19)

, ξ ∈ R2, A ∈ gl(2, R), with Aθ = θA

, η ∈ R2, P ∈ Gl(R2), with P θ = εθP

(cid:27)

,

(cid:27)

,

where ε = 1 when tr(θ) (cid:54)= 0 or ε ∈ {−1, 1} if tr θ = 0.

Proof: By our previous calculations,

φ =

(cid:19)

(cid:18) ε

0
η P

∈ Aut(g(θ))

if and only if P θ = εθP.

Moreover, the fact that φ is invertible implies that ε det P = det φ (cid:54)= 0 and hence,

P θ = εθP ⇐⇒ εθ = P θP −1.

Assuming tr θ (cid:54)= 0 gives us that

ε tr(θ) = tr(P θP −1) = tr(θ) =⇒ ε = 1 and P θ = θP.

On the other hand, tr(θ) = 0 implies necessarily

θ =

(cid:19)

(cid:18) 1

0
0 −1

or

θ =

(cid:18) 0 −1
0
1

(cid:19)

,

and in both cases det(θ) (cid:54)= 0. Therefore,

ε = 1 and P θ = θP or ε = −1 and P θ = −θP.

For a derivation D ∈ Der(g(θ)) we have that

D =

(cid:19)

(cid:18) ε

0
ξ A

∈ Der(g(θ))

if and only if Aθ − θA = εθ.

Hence, tr θ (cid:54)= 0 gives us

ε tr θ = tr(Aθ − θA) = 0 =⇒ ε = 0.

On the other hand, if tr θ = 0 then necessarily det θ (cid:54)= 0 and

Aθ − θA = εθ =⇒ ε idR2 = A − θAθ−1 =⇒ 2ε = tr(A − θAθ−1) = 0,

showing that, in any case, ε = 0 and Aθ = θA, concluding the proof.

(cid:3)

2.2 Solvable nonnilpotent simply connected connected 3D Lie group

Up to isomorphisms, the connected, simply connected Lie group associated with the 3D Lie algebra g(θ) is the
semi-direct product G(θ) = R ×ρ R2, where ρt = etθ and the product satisﬁes

(t1, v1)(t2, v2) = (t1 + t2, v1 + ρt1 v2),

(t1, v1), (t2, v2) ∈ R ×ρ R2.

3

As for the algebras g(θ), the group of automorphisms of G(θ) can be expressed in terms of 3 × 3 matrices. In
order to do that we introduce the following operator: Let A be a 2 × 2 and deﬁne

ΛA : R × R2 → R2,

(t, w) (cid:55)→ ΛA

t w :=

(cid:90) t

0

esAw ds.

The operator ΛA is well deﬁned and, for any t, s ∈ R, it satisﬁes

1. ΛA

0 = 0;

4. etA − AΛA

t = idR2

7. A =

2.

d
dt

ΛA

t = etA

3. ΛA

t+s = ΛA

t + etAΛA
s

t = ΛA

t esA

5. esAΛA
(cid:19)

, λ (cid:54)= 0 =⇒ ΛA

s =

(cid:18) λ 0
0
0

6. ΛA
(cid:18) 1

t = (etA − idR2 )A−1 if det A (cid:54)= 0
λ (esλ − 1)
0

0
s

(cid:19)

.

Using the previous operator and Proposition 2.1 we have the following:

2.2 Proposition: For the 3D Lie group G(θ), it holds that:

Aut(G(θ)) = (cid:8)φ(t, v) = (cid:0)εt, P v + εΛθ

εtη(cid:1) , η ∈ R2, P ∈ Gl(R2), with P θ = εθP (cid:9) ,

where ε = 1 if tr θ (cid:54)= 0 or ε ∈ {−1, 1} if tr θ = 0.

Proof: If φ ∈ Aut(G(θ)) we have that (dφ)(0,0) ∈ Aut(g(θ)). Therefore, we can write

(dφ)(0,0) =

(cid:19)

(cid:18) ε

0
η P

, with P θ = εθP and ε2 = 1.

The map ψ(t, v) = (cid:0)εt, P v + εΛθ
ψ ∈ Aut(G(θ)), the equality ψ = φ follows by general results. For any (t1, v1), (t2, v2) ∈ G(θ) it holds that

εtη(cid:1) satiﬁes (dψ)(0,0) = (dφ)(0,0) and, since G(θ) is connected, if we show that

ψ((t1, v1)(t2, v2)) = ψ(t1 + t2, v1 + ρt1 v2) =

(cid:16)

ε(t1 + t2), P (v1 + ρt1 v2) + εΛθ

ε(t1+t2)η

(cid:17)

= (cid:0)εt1 + εt2, P v1 + ρεt1P v2 + εΛθ

εt1

η(cid:1) = (cid:0)εt1 + εt2, P v1 + εΛθ
εt1

η + ρεt1

(cid:0)P v2 + εΛθ
εt2

η(cid:1)(cid:1)

= (εt1, P v1 + εΛθ

η) = ψ(t1, v1)ψ(t2, v2),

η + ερεt1Λθ
t2
η)(εt2, P v2 + εΛθ

εt1

εt2

where for the second equality we used that P θ = εθP and for the third equality a property of Λθ
ψ ∈ Aut(G(θ)) and consequently ψ = φ as stated.

t . Therefore,
(cid:3)

2.3 Deﬁnition: A vector ﬁeld X on G(θ) is said to be linear if it is complete and its ﬂow {ϕs}s∈R is a
1-parameter subgroup of Aut(G(θ)).

Since by diﬀerentiation, {(dϕs)(0,0)}s∈R is a 1-parameter subgroup of Aut(g(θ)), there exists a derivation D ∈
Der(g(θ)) such that

However,

∀s ∈ R.

(dϕs)(0,0) = esD.

D =

(cid:19)

(cid:18) 0

0
ξ A

=⇒ esD =

(cid:18) 1
ΛA
s ξ

(cid:19)

,

0
esA

and hence, by the previous calculations, we get that

ϕs(t, v) = (cid:0)t, esAv + Λθ

t ΛA

s ξ(cid:1) , ξ ∈ R2, A ∈ gl(2, R), with Aθ = θA.

Also, the linear vector ﬁeld X can be written as

X (t, v) = (0, Av + Λθ

t ξ),

ξ ∈ R2, A ∈ gl(2, R), with Aθ = θA.

4

By the fact that the vector ξ ∈ R2 and the matrix A ∈ gl(2, R), together with the previous properties, determine
X , we will usually write X = (ξ, A) to denote the linear vector ﬁeld X .

We denote by ZX the set of the singularities of a linear vector ﬁeld X , that is,

It is well know that ZX is a closed subgroup with Lie algebra given by ker D.

ZX = {(t, v) ∈ G(θ); X (t, v) = 0}.

We ﬁnish this section with the explicity expression for the exponential map of a 3D Lie group and the diﬀerential
of the left and right translations which will be needed ahead. The details in how to obtain such formulas can
be found in [4, Section 3].

(cid:26)

exp(a, w) =

(0, w)
a Λθ

aw(cid:1) ,

(cid:0)a, 1

if a = 0
if a (cid:54)= 0

.

Also, for any (ti, vi) ∈ G(θ), i = 1, 2 and (a, w) ∈ g(θ) the left and right translations satisﬁes

(dL(t1,v1))(t2,v2)(a, w) = (a, ρt1 w) and (dR(t1,v1))(t2,v2)(a, w) = (a, w + aθρt2v1),

implying that the left and right invariant vector ﬁeld associated with Y = (a, w) ∈ g(θ) are given, respectively,
by

Y L(t, v) = (a, ρtw)

and

Y R(t, v) = (a, w + aθv).

2.4 Remark: Using the properties of the operator ΛA and the formula of the exponential above, it is easy to
obtain that if (a, w) (cid:54)= (0, 0),

exp s1(a, w) = exp s2(a, w) =⇒ s1 = s2.

3 Simple ARS’s on G(θ)

In this section we deﬁne simple ARS’s on the connected simply connected 3D Lie groups G(θ) associated with
the Lie algebras g(θ).

3.1

Invariant distributions and ARS’s on G(θ)

A 2D left-invariant distribution on G(θ) is the map ∆L : G(θ) → T G(θ) given by

∆L(t, v) = (dL(t,v))(0,0)∆,

where ∆ ⊂ g(θ) is a 2D vector subspace. We can endow ∆L with a left-invariant Euclidean metric by considering
on ∆ an inner product (cid:104)·, ·(cid:105) and deﬁning

∀X, Y ∈ ∆L(t, v),

(cid:104)X, Y (cid:105)(t,v) := (cid:104)(dL(t,v)−1)(t,v)X, (dL(t,v)−1)(t,v)Y (cid:105).

Let X be a linear vector ﬁeld and consider the family of vector ﬁelds Σ = {X , ∆L}. We say that Σ satisﬁes the
Lie algebra rank condition (LARC) if at least one of the following conditions is satisﬁed:

(i) ∆ is not a subalgebra of g(θ);

(ii) ∆ is a subalgebra of g(θ) and D∆ (cid:54)⊂ ∆,

where D is the derivation associated with X .

5

3.1 Remark: Note that the family Σ = {X , ∆L}, with ∆ = {0} × R2, does not satisﬁes the LARC. In fact, in
this case ∆ is a subalgebra and

D(0, w) =

(cid:18) 0

0
ξ A

(cid:19) (cid:18) 0
w

(cid:19)

(cid:18) 0
Aw

=

(cid:19)

= (0, Aw) =⇒ D∆ ⊂ ∆.

Therefore, if Σ = {X , ∆L} satisﬁes the LARC the subspace ∆ admits a basis

{(σ1, u1), (σ2, u2)}, with

1 + σ2
σ2

2 (cid:54)= 0.

Moreover, the intersection ∆ ∩ ({0} × R2) is one-dimensional. Let us denote by l∆ the line in R2 satisfying

{0} × l∆ = ∆ ∩ ({0} × R2).

3.2 Deﬁnition: A simple ARS Σ on the 3D Lie group G(θ) is deﬁned by the family Σ = {X , ∆L}, where X is
a linear vector ﬁeld and ∆L is a 2D left-invariant distribution ∆ endowed with a left-invariant Euclidean metric
satisfying

(i) The set {(t, v) ∈ G(θ); X (t, v) /∈ ∆L(t, v)} is nonempty;

(ii) Σ satisﬁes the LARC.

The metric on G(θ) associated with Σ is deﬁned by declaring that X is unitary and orthogonal to ∆L at every
point.

The singular points Z is the set of points (t, v) ∈ G(θ) where the previous metric fails to be Riemannian,
that is

Z := {(t, v) ∈ G(θ); X (t, v) ∈ ∆L(t, v)}.

In particular, the set of singularities ZX of X is contained in Z.
The almost-Riemannian norm deﬁned by Σ on T(t,v)G(θ) is deﬁned by

(cid:107)X(cid:107)Σ,(t,v) = min

(cid:26)(cid:113)

α2
0 + α2

1 + α2

2; α0X (t, v) + α1Y L

1 (t, v) + α2Y L

2 (t, v) = X

(cid:27)

,

where {Y1, Y2} is an orthonormal basis of ∆. It holds that (cid:107)X(cid:107)Σ,(t,v) = ∞ when (t, v) ∈ Z and X /∈ ∆(t, v).
A diﬀeomorphism ψ : G(θ) → G(θ) between two ARS’s Σ1 and Σ2 on a 3D Lie group G(θ) is an isometry if

∀(t, v) ∈ G(θ), Z ∈ T(t,v)G(θ)

(cid:107)(dψ)(t,v)Z(cid:107)Σ2,φ(t,v) = (cid:107)Z(cid:107)Σ1,(t,v).

Let us denote by Isoθ(Σ1; Σ2) the group of isometries between the ARS’s Σ1 and Σ2. Following [15, Theorem 1],
any isometry ψ ∈ Isoθ(Σ1; Σ2) can be decomposed as ψ = L(t,v) ◦ ψ0, where (t, v) ∈ Z2 and ψ0 ∈ Isoθ(Σ1; Σ2)0,
with

Isoθ(Σ1; Σ2)0 = {ψ0 ∈ Isoθ(Σ1; Σ2); ψ0(0, 0) = (0, 0)} .

Therefore, in order to understand the isometries the group Isoθ(Σ1; Σ2) it is enough to analyze the singular
locus Z2 of Σ2 and the subgroup Isoθ(Σ1; Σ2)0.
Moreover, for any isometry ψ ∈ Isoθ(Σ1; Σ2)0 it holds that

ψ∗∆L

1 = ∆2(ψ)

and ψ ◦ ϕ1

s = ϕ2

±s ◦ ψ,

(1)

where {ϕi

s}s∈R is the ﬂow associated with Xi (see [15, Theorem 2]). Consequently,

ψ(Z1) = Z2

and ψ(ZX1 ) = ZX2.

Since outside the singular locus the metric is Riemannian, the restriction

ψ : G(θ) \ Z1 → G(θ) \ Z2,

6

is an isometry between Riemannian manifolds. By Myers-Steenrod Theorem [17] such restriction is of class C∞
on the connected components of G(θ) \ Z1.

Next we analyze some properties of the singular locus of ARS’s on the groups G(θ).

3.3 Proposition: For the ARS Σ = {X = (ξ, A), ∆L} on G(θ), it holds:

1. ∆ is a subalgebra if and only if l∆ is an eigenspace of θ;

2. If (1, 0) ∈ ∆, then Σ satisﬁes the LARC if and only if ∆ is not a subalgebra or ∆ is a subalgebra and

Al∆ (cid:54)⊂ l∆ or ξ /∈ l∆;

Proof: 1. Let {(σ1, u1), (σ2, u2)} be a basis of ∆. Then,

∆ (cid:51) −σ2(σ1, u1) + σ1(σ2, u2) = (0, −σ2u1 + σ1u2) ∈ {0} × R2,

is a nonzero vector, implying that l∆ = R(σ1u2 − σ2u1). On the other hand,

∆ is a subalgebra ⇐⇒ [(σ1, u1), (σ2, u2)] ∈ ∆.

However, by deﬁnition

implying that

[(σ1, u1), (σ2, u2)] = (0, σ1θu2 − σ2θu1) = (0, θ(σ1u2 − σ2u1)),

∆ is a subalgebra ⇐⇒ l∆ is an eigenspace of θ.

If Let {(σ1, u1), (σ2, u2)} be an orthonormal basis of ∆.

If ∆ is not a subalgebra, then necessarily
2.
[(σ1, u1), (σ2, u2)] /∈ ∆ and the LARC is satisﬁed. On the other hand, if ∆ is a subalgebra, then by the previous
lemma, l∆ is an eigenspace of θ. Since by hypothesis (1, 0) also belongs to ∆ we have that ∆ = R(1, 0) ⊕ l∆.
Therefore, if D is the derivation associated with X , the LARC is satisﬁed if and only

D({0} × l∆) (cid:54)⊂ ∆ or D(1, 0) /∈ ∆.

However, the fact that
(cid:18) 0

D =

0
ξ A

(cid:19)

gives us that D({0} × l∆) = {0} × Al∆ and D(1, 0) = (0, ξ),

showing that D∆ (cid:54)⊂ ∆ if and only if Al∆ (cid:54)⊂ l∆ or ξ /∈ l∆, concluding the proof.

(cid:3)

3.4 Remark: It is important to notice that if θ (cid:54)= idR2, the fact that Aθ = θA gives us that

Consequently, in this case, if (1, 0) ∈ ∆ the LARC holds if and only if ξ /∈ l∆.

θl∆ ⊂ l∆ =⇒ Al∆ ⊂ l∆.

The next result shows that elements in Aut(G(θ)) can be seen as isometries between ARS’s.

3.5 Proposition: Let Σ = {X = (ξ, A), ∆L} be an ARS on G(θ) and

ψ(t, v) = (εt, P v + εΛθ

εtη) an automophism of G(θ).

The family

Σψ = (cid:8)Xψ = (cid:0)P −1(εξ + Aη), P −1AP (cid:1) , ∆L

ψ := (ψ∗)−1∆L(cid:9) ,

is an ARS and ψ is an isometry between Σψ and Σ, where the left-invariant metric on ∆ψ is the one that makes
(dφ)(0,0)

an isometry.

(cid:12)
(cid:12)∆φ

7

Proof: By deﬁnition, we have that

(dψ)(t,v)Xψ(t, v) =

(cid:19) (cid:18)

(cid:18) ε

0
η P

0
t P −1(εξ + Aη)
P −1AP v + Λθ

(cid:19)

(cid:18)

=

AP v + P Λθ

0
t P −1(εξ + Aη)

(cid:19)

(cid:18)

=

0
AP v + εΛθ
εt(εξ + Aη)

(cid:19)

(cid:18)

=

0
εtη) + Λθ
A(P v + εΛθ

εtξ

(cid:19)

= X (εt, P v + εΛθ

εtη) = X (ψ(t, v)),

where in the third equality we used that

P θ = εθP

=⇒ P etθ = eεtθP

and

P Λθ

t P −1 = εΛθ
tε,

and in the fourth equality that Aθ = θA, showing that Xψ and X are ψ-conjugated. Since automorphisms
preserves left-invariant vector ﬁelds, it holds that Σψ is in fact an ARS on G(θ). Moreover, if we deﬁne the left-
an isometry, we get that (dψ)(t,v) carries orthonormal frames
invariant metric on ∆ψ that makes (dψ)(0,0)
in ∆ψ(t, v) onto orthonormal frames in ∆(ψ(t, v)) implying that ψ is in fact an isometry between Σψ and Σ.
(cid:3)

(cid:12)
(cid:12)∆ψ

3.6 Remark: Let ψ ∈ Isoθ(Σ1; Σ2)0 and consider ˆψ ∈ Aut(G(θ)). By the previous proposition there exist an
ARS’s Σ ˆψ such that ˆψ ∈ Isoθ(Σ ˆψ; Σ1). As a consequence, the composition ψ ◦ ˆψ is an isometry between Σ ˆψ and
Σψ2.
In particular, the maps

if det A1 (cid:54)= 0,

ψ1(t, v) = (cid:0)t, v − Λθ

t (A−1

1 ξ1)(cid:1) ,

and

if (σ, u) ∈ ∆1 with σ (cid:54)= 0,

ψ2(t, v) =

t, v −

(cid:18)

(cid:19)

,

Λθ

t u

1
σ

are automorphisms of G(θ) and their induced ARS’s satisﬁes Xψ1 = (0, A1) and (1, 0) ∈ ∆ψ2. Therefore, up to
automorphisms we can assume that (1, 0) ∈ ∆1 or ξ1 = 0 if det A1 = 0.

3.2 The singular locus

In this section we analyze the singular locus of the ARS’s on G(θ). As showed in [6, Theorem 1], the singular
locus of a simple ARS Σ = {X , ∆L} such that ∆ is a subalgebra, is a submanifold. In this section we show
that for the class of groups in question the same holds independent of any condition on the distribution. Such
property is not true, for instance, on the Heisenberg group as showed in [6, Section 3.5.3].
Let Σ = {X = (ξ, A), ∆L} be a simple ARS on G(θ) wich associated singular locus

Using the expression for X gives us that

Z := {(t, v) ∈ G(θ); X (t, v) ∈ ∆(t, v)}.

X (t, v) = (0, Av + Λθ

t ξ) ∈ ∆L(t, v) ⇐⇒ (0, Av + Λtξ) ∈ ∆L(t, v) ∩ ({0} × R2) = {0} × ρt(l∆).

Therefore, if u is a vector normal to l∆, it holds that

Z = {(t, v) ∈ G(θ);

(cid:104)ρ−t(Av + Λθ

t ξ), u(cid:105)R2 = 0}.

Deﬁning

gives us that Z = F −1(0). Moreover, a simple calculation shows that

Fu : G(θ) → R,

Fu(t, v) = (cid:104)ρ−t(Av + Λθ

t ξ), u(cid:105)R2 ,

(2)

∂1Fu(t, v) = (cid:104)ρ−t (ξ − θAv) , u(cid:105)R2

and

∂2Fu(t, v)w = (cid:104)ρ−tAw, u(cid:105)R2 .

(3)

8

3.7 Theorem: The singular locus of any ARS on a G(θ) is an embedded submanifold.

Proof: Let us consider an ARS Σ = {X , ∆L}. Since the image of a submanifolds by a diﬀeomorphism is also
a submanifold, Lemma 3.5 allows us to assume w.l.o.g. that (1, 0) ∈ ∆.

Assume ﬁrst that A ≡ 0. By deﬁnition, in this case, the singular locus is given by

Z = X × R2, where X = {t ∈ R;

(cid:104)ρ−t(Λθ

t ξ), u(cid:105)R2 = 0}.

However,

(cid:104)ρ−t(Λθ

t ξ), u(cid:105)R2 = −(cid:104)Λθ

−tξ, u(cid:105)R2 =

(cid:26)

ξ1u1(1 − e−t) + ξ2u2t,
−(cid:104)ρ−tθ−1ξ, u(cid:105)R2 + (cid:104)θ−1ξ, u(cid:105)R2,

if det θ = 0

if det θ (cid:54)= 0

,

where ξ = (ξ1, ξ2) and u = (u1, u2) in the canonical basis.
By the LARC we get that ξ /∈ l∆ and hence, diﬀerentiation of the ﬁrst equation shows that t (cid:55)→ ξ1u1(1 − e−t) +
ξ2u2t has at most one critical point implying by Rolle’s Theorem that X has at most two points if det θ = 0.
Now, if det θ (cid:54)= 0, we get by Lemma A.2, that X is an enumerable subset of R with cardinality depending on
the eigenvalues of θ. In any case, the singular locus of Σ is an enumerable union of planes on G(θ), and hence
a submanifold as stated.

Let us now consider the case where A (cid:54)≡ 0. In order to show that the singular locus Z of Σ is a submanifold, it
is enough to assure that 0 ∈ R is a regular value of the map Fu deﬁned previously.
By equation (3), 0 ∈ R is not a regular value of F if and only if there exists (t, v) ∈ Z such that

∂1Fu(t, v) = (cid:104)ρ−t (ξ − θAv) , u(cid:105)R2 = 0

and

∀w ∈ R2 ∂2Fu(t, v)w = (cid:104)ρ−tAw, u(cid:105)R2 = 0.

From the previous, it holds that

∀w ∈ R2, ∂2Fu(t, v)w = (cid:104)ρ−tAw, u(cid:105)R2 = 0 =⇒ ImA ⊂ l∆,

and

0 = (cid:104)ρ−t (ξ − θAv) , u(cid:105)R2 = (cid:104)ρ−tξ, u(cid:105)R2 − (cid:104)ρ−tAθv, u(cid:105)R2
(cid:125)

(cid:124)

(cid:123)(cid:122)
=0

= (cid:104)ρ−tξ, u(cid:105)R2,

where we used that Aθ = θA. Since A (cid:54)≡ 0 we have that ImA = l∆ implying, in particular, that Al∆ ⊂ l∆ and
∆ is a subalgebra.

On the other hand,

(cid:104)ρ−tξ, u(cid:105)R2 = 0 =⇒ ρ−tξ ∈ l∆ =⇒ ξ ∈ ρt(l∆) = l∆,

which by Proposition 3.3 implies that Σ does not satisﬁes the LARC. Therefore, 0 is a regular value of the map
(cid:3)
Fu showing that Z is in fact an embedded submanifold.

The next result studies the connectedness of the singular locus.

3.8 Theorem: If Σ = {X = (ξ, A), ∆L} is an ARS and A (cid:54)≡ 0, then Z is connected. Moreover, G(θ) \ Z has
two connected components given by

C− := F −1

u (−∞, 0) and C+ := F −1

u (0, +∞),

where Fu is the function deﬁne in (2).

Proof: Assume ﬁrst that det A (cid:54)= 0 and consider

The map H is a homeomorphism with inverse given by

H : G(θ) → G(θ), H(t, v) = (t, A−1(ρtv − Λθ

t ξ)).

H −1(t, v) = (t, ρ−t(Av + Λθ

t ξ)).

9

Moreover,

(t, v) ∈ Z ⇐⇒ (cid:104)ρ−t(Av + Λθ

t ξ), u(cid:105)R2 = 0 ⇐⇒ ∃s ∈ R; ρ−t(Av + Λθ

t ξ) = su

⇐⇒ v = A−1(sρtu − Λtξ) ⇐⇒ (t, v) = H(t, su),
showing that Z is the homeomorphic image of the plane R × l∆. In particular, Z is connected and G(θ) \ Z has
two connected components. Also,

Fu(H(t, v)) = Fu

(cid:0)t, A−1(ρtv − Λθ

t ξ)(cid:1) = (cid:104)ρ−t

(cid:0)A (cid:0)A−1(ρtv − Λθ

t ξ)(cid:1) + Λθ

t ξ(cid:1) , u(cid:105)R2 = (cid:104)v, u(cid:105)R2 ,

implying that F −1

u (−∞, 0) and F −1

u (0, +∞) are (pathwise) connected. Since
u (R \ {0}) = G(θ) \ Z,
F −1

we get that C− and C+ are in fact the connected components of G(θ) \ Z.

Let us now consider the case where dim ImA = 1 and assume w.l.o.g. that (1, 0) ∈ ∆. Since ker A has also
dimension one and Aθ = θA, we can easily construct an orthonormal basis {w1, w2} of R2 such that

Let (t, v) ∈ Z and write v = (cid:104)v, w1(cid:105)R2w1 + (cid:104)v, w2(cid:105)R2w2. Then,

Aw1 (cid:54)= 0, Aw2 = 0

and

θAw1 = βAw1.

0 = (cid:104)ρ−t(Av + Λθ

t ξ), u(cid:105)R2 = (cid:104)v, w1(cid:105)R2 (cid:104)ρ−tAw1, u(cid:105)R2 + (cid:104)ρ−tΛθ

t ξ, u(cid:105)R2 =⇒

Since Aw1 is a nonzero eigenvector of θ we have that

(cid:104)v, w1(cid:105)R2 (cid:104)ρ−tAw1, u(cid:105)R2 = (cid:104)Λθ

−tξ, u(cid:105)R2.

(cid:104)ρ−tAw1, u(cid:105)R2 = e−βt(cid:104)Aw1, u(cid:105)R2,

where β is an eigenvalue of θ. In particular, if (cid:104)Aw1, u(cid:105)R2 = 0 we get by orthogonality that Aw1 ∈ l∆, implying
that l∆ = ImA and hence Al∆ ⊂ l∆. Also, in this case,

∀t ∈ R, 0 = e−βt(cid:104)Aw1, u(cid:105)R2 = (cid:104)ρ−tAw1, u(cid:105)R2 = (cid:104)Λθ

−tξ, u(cid:105)R2 =⇒ ∀t ∈ R, Λθ

−tξ ∈ l∆,

and since det Λθ

−t (cid:54)= 0 for some t ∈ R we get by the properties of the operator Λθ that ξ ∈ l∆. Therefore,

(cid:104)Aw1, u(cid:105)R2 = 0 =⇒ Al∆ ⊂ l∆ and ξ ∈ l∆,

which together with the assumption (1, 0) ∈ ∆ contradicts the LARC (see Proposition 3.3). Therefore,
(cid:104)Aw1, u(cid:105)R2 (cid:54)= 0 and consequently

By the previous, the map

(cid:104)v, w1(cid:105)R2 =

(cid:18)

(cid:18)

I : G(θ) → G(θ), (t, v) (cid:55)→ I(t, v) =

t,

(cid:104)v, w1(cid:105)R2 +

(cid:104)Λθ

−tξ, u(cid:105)R2
(cid:104)ρ−tAw1, u(cid:105)R2

.

(cid:104)Λθ

−tξ, u(cid:105)R2
(cid:104)ρ−tAw1, u(cid:105)R2

(cid:19)

w1 + (cid:104)v, w2(cid:105)R2w2

,

(cid:19)

is well deﬁned, continuous and a simple calculation shows that its inverse in given by

I −1(t, v) =

(cid:18)

(cid:18)

t,

(cid:104)v, w1(cid:105)R2 −

(cid:104)Λθ

−tξ, u(cid:105)R2
(cid:104)ρ−tAw1, u(cid:105)R2

(cid:19)

w1 + (cid:104)v, w2(cid:105)R2w2

.

(cid:19)

Moreover, by the previous calculations, I(R × Rw2) = Z, showing that Z is connected. Also,

(cid:28)

(cid:18)(cid:18)

Fu(I(t, v)) =

ρ−tA

(cid:104)v, w1(cid:105)R2 +

(cid:104)Λθ

−tξ, u(cid:105)R2
(cid:104)ρ−tAw1, u(cid:105)R2
(cid:19)

(cid:19)

(cid:19)

w1 + (cid:104)v, w2(cid:105)R2w2

(cid:29)

+ ρ−tΛθ

t ξ, u

R2

(cid:18)

=

(cid:104)v, w1(cid:105)R2 +

(cid:104)Λθ

−tξ, u(cid:105)R2
(cid:104)ρ−tAw1, u(cid:105)R2

(cid:104)ρ−tAw1, u(cid:105)R2 + (cid:104)ρ−tΛθ

t ξ, u(cid:105)R2

= (cid:104)v, w1(cid:105)R2(cid:104)ρ−tAw1, u(cid:105)R2 + (cid:104)Λθ

−tξ, u(cid:105)R2 − (cid:104)Λθ

−tξ, u(cid:105)R2

which as previously implies that C− and C+ are the connected components of G(θ) \ Z.

(cid:3)

= e−βt(cid:104)v, w1(cid:105)R2(cid:104)Aw1, u(cid:105)R2,

10

3.3 Crossing the singular locus

In this section we analyze how the exponential curves crosses the singular locus. Such analysis will be necessary
in the proof of the Fundamental Lemma ahead.
Let us ﬁx a simple ARS Σ = {X = (ξ, A), ∆L} with A (cid:54)= 0 and consider, as previously, the function Fu, where u
is a normal vector to the line l∆. Let (t, v) ∈ G(θ) and consider the exponential curve s ∈ R (cid:55)→ (t, v) exp s(a, w).
By Theorem 3.8 in order to see how such curve behaves with relation to the singular locus, it is enough to
analyze the zeros of the function

s ∈ R (cid:55)→ Fu((t, v) exp s(a, w)).

Using the formula for the exponential and for the operator Λθ is easy to see that

Fu((t, v) exp s(a, w)) =

(cid:26) Fu(t, v) + s(cid:104)Aw, u(cid:105)R2
−asu(t, v) − 1

FρT

a (cid:104)Λ−as(Aw + aξ), u(cid:105)R2

if a = 0
if a (cid:54)= 0 ,

(4)

where for simplicity we FρT

−asu(t, v) = (cid:104)ρ−t(Av + Λtξ), ρT
The following lemma states what happens with the previous function when (t, v) ∈ Z.

−asu(cid:105)R2 = (cid:104)ρ−t−as(Av + Λtξ), u(cid:105)R2.

3.9 Lemma: Let (t, v) ∈ Z and consider the function

s (cid:55)→ Fu((t, v) exp s(a, w)).

Then, Fu((t, v) exp s(a, w)) ≡ 0 or there exists δ > 0 such that Fu((t, v) exp s(a, w)) (cid:54)= 0 for all s ∈ (−δ, δ) \ {0}.

Proof: Let us ﬁrst consider the case where a = 0. By equation (4), if (t, v) ∈ Z,

Fu((t, v) exp s(a, w)) = Fu(t, v)
(cid:124) (cid:123)(cid:122) (cid:125)
=0

+s(cid:104)Aw, u(cid:105)R2 = s(cid:104)Aw, u(cid:105)R2.

Therefore, if Aw ∈ l∆ we get that Fu((t, v) exp s(a, w)) = 0 for all s ∈ R and if Aw /∈ l∆ we get that
Fu((t, v) exp s(a, w) (cid:54)= 0 for all s ∈ R \ {0}.
Assume now that a (cid:54)= 0 and ﬁx 0 (cid:54)= u ∈ l∆. By equation (4) we have that

Fu((t, v) exp s(a, w)) = FρT

−asu(t, v) −

1
a

(cid:104)Λ−as(Aw + aξ), u(cid:105)R2.

Since (t, v) ∈ Z, there exists µ = µ(t, v) ∈ R such that ρ−t(Av + Λtξ) = µu. In particular,

FρT

−asu(t, v) = (cid:104)ρ−t(Av + Λtξ), ρT

−asu(cid:105)R2 = µ(cid:104)u, ρT

−asu(cid:105)R2 = µ(cid:104)ρ−asu, u(cid:105)R2 ,

and so,

Fu((t, v) exp s(a, w)) = µ(cid:104)ρ−asu, u(cid:105)R2 −

1
a

(cid:104)Λ−as(Aw + aξ), u(cid:105)R2 .

We have the following cases:

1. Aw + aξ − aµθu ∈ l∆.

In this case, there exists τ ∈ R such that Aw + aξ − aµθu = τ u and hence

µρ−asu −

1
a

Λθ

−as(Aw + aξ) = µ(ρ−asu − Λθ

−asθu) −

τ
a

Λθ

−asu = µu −

τ
a

Λθ

−asu,

where for the last equality we used property 4. of the operator Λθ. Hence,

Fu((t, v) exp s(a, w)) = µ(cid:104)ρ−asu, u(cid:105)R2 −

(cid:104)Λ−as(Aw + aξ), u(cid:105)R2

= µ(cid:104)u, u(cid:105)R2 −

τ
a

(cid:104)Λθ

−asu, u(cid:105)R2 = −

(cid:104)Λθ

−asu, u(cid:105)R2 .

1
a
τ
a

11

Therefore, if τ = 0 or ∆ is a subalgebra, − τ
Now, if τ (cid:54)= 0 and ∆ is not a subalgebra, we have that

a (cid:104)Λθ

−asu, u(cid:105)R2 = 0, implying that Fu((t, v) exp s(a, w)) ≡ 0.

d
ds

Fu((t, v) exp s(a, w)) = τ (cid:104)ρ−asu, u(cid:105)R2.

In particular, since ∆ is not a subalgebra, u is not an eigenvalue of θ and hence, there exists δ > 0 such
that

d
ds

Fu((t, v) exp s(a, w)) = τ (cid:104)ρ−asu, u(cid:105)R2 (cid:54)= 0, s ∈ (−δ, δ) \ {0},

showing that 0 ∈ R is an isolated critical point. In particular, Fu((t, v) exp s(a, w)) (cid:54)= 0 in s ∈ (−δ, δ) \ {0}
as desired.

2. Aw + aξ − aµθu /∈ l∆

In this case,

d
ds

Fu((t, v) exp s(a, w)) =

1
a

(cid:104)ρ−as (Aw + aξ − aµθu) , u(cid:105)R2 .

Since

d
ds |s=0
we get by continuity that there exists δ > such that

Fu((t, v) exp s(a, w)) =

1
a

(cid:104)Aw + aξ − aµθu, u(cid:105)R2 (cid:54)= 0,

d
ds

Fu((t, v) exp s(a, w)) (cid:54)= 0, ∀s ∈ (−δ, δ),

and hence Fu((t, v) exp s(a, w)) is strictly increasing or strictly decreasing the interval (−δ, δ). In partic-
ular,

Fu((t, v) exp s(a, w)) (cid:54)= 0,

for all s ∈ (−δ, δ) \ {0},

proving the result.

Using the previous lemma we have the following.

3.10 Theorem: Let Σ = {X = (ξ, A), ∆L} be a simple ARS on G(θ) with A (cid:54)= 0 and (a, w) ∈ g(θ).
(t, v) ∈ G(θ) \ Z the exponential curve s (cid:55)→ (t, v) exp s(a, w) satisﬁes:

(cid:3)

If

1. s (cid:55)→ (t, v) exp s(a, w) remains in the same component that contains (t, v) or

2. s (cid:55)→ (t, v) exp s(a, w) intersects Z discretely.

Proof: Let us assume that for s0 ∈ R it holds that (t, v) exp s0(a, w) ∈ Z. Since

(t, v) exp(s0 + s)(a, w) = ((t, v) exp s0(a, w))
(cid:125)

(cid:124)

(cid:123)(cid:122)
∈Z

exp s(a, w),

the previous lemma implies the following:

1. For all s ∈ R it holds that Fu((t, v) exp(s0 + s)(a, w)) ≡ 0;

If this condition holds, we would have that (t, v) exp(s0 + s)(a, w) ∈ Z, ∀s ∈ R and consequently, (t, v) ∈
G(θ) \ Z ∩ Z = ∅ which is not possible. Therefore, s (cid:55)→ (t, v) exp s(a, w) remains in the same component
that contains (t, v).

2. There exists δ > 0 such that Fu((t, v) exp(s0 + s)(a, w)) (cid:54)= 0 for all s ∈ (−δ, δ) \ {0}.

In this case, (t, v) exp(s0 + s)(a, w) intersects Z at the point (t, v) exp s0(a, w) and (t, v) exp(s0 + s)(a, w)
remains in the same component if Fu((t, v) exp(s0 + s)(a, w)) (cid:54)= 0 does not changes sign for all s ∈
(−δ, δ) \ {0} or {(t, v) exp(s0 + s)(a, w), s ∈ (−δ, 0)} and {(t, v) exp(s0 + s)(a, w), s ∈ (0, δ)} belongs to
diﬀerent components if the sign of Fu((t, v) exp(s0 + s)(a, w)) (cid:54)= 0 changes in (−δ, δ) \ {0}.

12

3.11 Remark: By a simple calculation, it is easy to verify that
Fu(ϕs(t, v)) = (cid:104)esA (cid:0)Av + Λθ

t ξ(cid:1) , u(cid:105)R2.

Consequently, for a ﬁxed (t, v) ∈ G(θ) \ ZX the values of s ∈ R such that ϕs(t, v) ∈ Z are zeros of the function

s ∈ R (cid:55)→ (cid:104)esA (cid:0)Av + Λθ

t ξ(cid:1) , u(cid:105)R2.

(cid:3)

By Lemma A.2 we conclude that

(i) The line l∆ is an eigenspace of A and

{ϕs(t, v), s ∈ R} ⊂ Z ⇐⇒ ϕs(t, v) ∈ Z,

for some s ∈ R;

(ii) The set {s ∈ R; ϕs(t, v) ∈ Z} is discrete.

The next example shows that if the matrix A associated with a linear vector ﬁeld X = (ξ, A) is trivial, the
singular locus is not connected.

3.12 Example: Consider the 3D Lie group G(θ) and the simple ARS Σ = {X , ∆L}, where

θ =

(cid:19)

(cid:18)0 −1
0

1

,

X = (ξ, 0)

and

α = {(1, 0), (0, e1)},

is an orthonormal basis of ∆. Since [(1, 0), (0, e1)] = (0, e2), the subspace ∆ is not a subalgebra and consequently
Σ satisﬁes the LARC. Moreover, the fact that

Λθ

t = (ρt − idR2 )θ−1 =

(cid:18) sin t

1 − cos t

cos t − 1
sin t

(cid:19)

,

gives us that, in coordinates,

X (t, (x, y)) = (0, a sin t + b(cos t − 1), a(1 − cos t) + b sin t), where

ξ = (a, b).

Therefore, we obtain

Z = {(t, (x, y)); b sin t + a cos t = a}.

We claim that Z has an inﬁnite number of connected components. In fact, if γ is the angle between the vectors
ξ and e1 we can write

cos γ =

and

sin γ =

a
a2 + b2

b
a2 + b2 ,

and hence,

As a consequence, the singular locus Z is given by

b sin t + a cos t = a ⇐⇒ cos γ = cos(t − γ).

Z = X × R2, where Γ = {2(γ − πk) k ∈ Z} ∪ {2πk k ∈ Z},

(5)

showing it has an inﬁnite enumerable union of parallel planes (see Figure 1a).

3.13 Example: Consider now G(θ) and the simple ARS Σ = {X , ∆L}, where

θ =

(cid:19)

(cid:18)0 −1
0

1

(cid:18)

,

X =

(1, 3),

(cid:19)(cid:19)

(cid:18) 2
0

1
2

and

α = {(1, 0), (0, e1)},

is an orthonormal basis of ∆. In this case, [(1, 0), (0, e1)] = (0, e1), implying that ∆ is a subalgebra. However,
(1, 3) /∈ ∆ implying that the LARC is satisﬁed. By straightforward calculations, we get that, in coordinates,

X (t, (x, y)) = (0, 2x + y + 3tet − 2et + 2, 2y + 3(et − 1)),

and hence,

Z = {(t, (x, y)); 2y = 3(1 − et)}.

(6)

13

(a) The singular locus of Example 3.12

(b) The singular locus of Example 3.13

4

Isometries of rank two ARS’s

In this section we introduce the class of rank two ARS’s and prove that the only isometries between elements
of such class are automorphisms of the group. This result allow us to classify, up to automorphisms, the only
possible rank two ARS on the Lie groups G(θ) under consideration.

4.1 Deﬁnition: Let Σ = {X = (A, ξ), ∆L} to be a simple ARS on G(θ). We say that Σ is a rank two ARS if

R2 = ImA + Rξ.

(7)

Note that relation (7) is equivalent to say that the derivation D =

(cid:19)

(cid:18) 0

0
ξ A

associated with the linear vector

ﬁeld X = (A, ξ) is a rank two matrix. By the conjugation formula (1) and previous discussion, rank two ARS’s
are preserved by isometries.

4.2 Remark: The expression of D shows that the rank of D is at most two and consequently, the set of rank
two derivations of g(θ) is open and dense in Der(g(θ)). By [5, Theorem 2.2] the set of linear vector ﬁelds is
isomorphic to Der(g(θ)), which allow us to conclude that the set of rank two linear vector ﬁeld is dense in the
set of the linear vector ﬁelds of G(θ). In particular, one can show that the set of rank two simple ARS’s on
G(θ) is generic.

Let ψ : G(θ) → G(θ) be an isometry between rank two ARS’s Σ1 and Σ2 and consider f : G(θ) → R and
g : G(θ) → R2 the coordinate functions of ψ. Write, on the canonical basis,

ψ∗ =

(cid:18) ∂1f
∂1g

(∂2f )T
∂2g

(cid:19)

,

where for (t, v) ∈ G(θ), ∂2f (t, v) is the gradient vector of the map partial map v ∈ R2 (cid:55)→ f (t, v) ∈ R.
If {ϕi

s}t∈R is the ﬂow associated with the linear vector ﬁelds of Σi, we have by (1) that

ψ ◦ ϕ1

s = ϕ2

s ◦ ψ,

where we consider only the positive case, since the negative is analogous. Using the expression for the ﬂows of
Xi, allow us to obtain

f (cid:0)t, esA1v + ΛA1

s Λθ

t ξ1

(cid:1) = f (t, v),

and

g (cid:0)t, esA1 v + ΛA1

s Λθ

t ξ1

Next we state our main result.

14

(cid:1) = esA2g(t, v) + ΛA2

s Λθ

f (t,v)ξ2.

(8)

4.3 Theorem: The only isometries between rank two ARS’s on G(θ) that ﬁxes the identity element are the
automorphisms.

The proof of Theorem 4.3 is divided in the next three sections. First we show that, if ψ preserves a left-
invariant vector ﬁeld of the associated distribution, then ψ is in fact an automorphism of G(θ). This result
simpliﬁes our problem to search for vectors which are preserved by the isometry. In the second part, we show
that the diﬀerential of any rank two isometry let the nilradical {0} × R2 of g(θ) invariant, or equivalently, if
ψ = (f, g) then ∂2f ≡ 0. In the third and last section, we show that if ψ∗ keeps the nilradical invariant, then
it preserves any left-invariant vector ﬁeld in the intersection of the nilradical with the distribution of the ARS.
As a consequence, ψ is an automorphism by the ﬁrst section.

The next example shows that Theorem 4.3 is not true if the ARS has rank less than two.

4.4 Example: Consider now G(θ) and the simple ARS Σ = {X , ∆L}, where

θ =

(cid:18)1
0

(cid:19)
0
0

,

(cid:18)

X =

(0, 0),

(cid:19)(cid:19)

(cid:18) 0
0

1
0

and

α = {(1, 0), (0, e2)},

is an orthonormal basis of ∆. By Proposition 3.3 we have that Σ satisﬁes the LARC and it is direct to see that
it is not a rank two ARS. Note also that, for any (t, v) ∈ G(θ), it holds

(dL(t,v))(0,0)(1, 0) = (1, 0)

and

(dL(t,v))(0,0)(0, e2) = (0, e2).

Let us consider the diﬀeormophism

and note that, by Proposition 2.2, it holds that ψ /∈ Aut(G(θ)). On the other hand,

ψ : G(θ) → G(θ),

(t, v) (cid:55)→ (−t, v),

ψ (X (t, v)) = ψ (0, Av) = (0, Av) = X (−t, v) = X (ψ(t, v)),

ψ(1, 0) = (−1, 0)

and ψ(0, e2) = (0, e2),

and since ψ∗ = ψ, we conclude that ψ carries the orthonormal frame {X , (1, 0), (0, e2)} onto the orthonormal
frame {X , −(1, 0), (0, e2)} showing that ψ ∈ Isoθ(Σ; Σ).

4.1 The fundamental lemma

We use this section to prove a technical lemma which gives us a suﬃcient condition for an isometry between
ARS to be a group automorphism.

4.5 Lemma: (Fundamental Lemma) Let Σi = {Xi = (ξi, Ai), ∆L
and assume that A1 (cid:54)≡ 0. If ψ ∈ Isoθ (Σ1; Σ2)0 satisﬁes

i }, i = 1, 2 be simple ARS’s on the G(θ)

∀(t, v) ∈ G(θ); (dψ)(t,v)X L(t, v) = (dLψ(t,v))(0,0)(dψ)(0,0)X,

(9)

for some nonzero vector X ∈ ∆1, then ψ ∈ Aut(G(θ)).

Proof: Let us assume w.l.o.g. that (1, 0) ∈ ∆1. The lemma proved in four steps:

Step 1: For all Z ∈ ∆1 it holds that

∀(t, v) ∈ G(θ); (dψ)(t,v)Z L(t, v) = (dLψ(t,v))(0,0)(dψ)(0,0)Z.

Let us consider Y ∈ ∆1 such that

{X, Y } is an orthogonal basis of ∆1 with

(cid:107)Y (cid:107)Σ1,(0,0) = (cid:107)X(cid:107)Σ1,(0,0).

15

By linearity, it is enough to show that relation (9) holds for Y .
From the left-invariance of the metric in ∆L
also satisfying

1 , we get that {X L(t, v), Y L(t, v)} is an orthogonal basis of ∆L

1 (t, v)

(cid:107)Y L(t, v)(cid:107)Σ1,(t,v) = (cid:107)Y (cid:107)Σ1,(0,0) = (cid:107)X(cid:107)Σ1,(0,0) = (cid:107)X L(t, v)(cid:107)Σ1,(t,v).

Using that ψ is an isometry, it holds that (dψ)(t,v)Y L(t, v) ∈ ∆L

2 (ψ(t, v)) is orthogonal to (dψ)(t,v)X L(t, v) and

(cid:107)(dψ)(t,v)Y L(t, v)(cid:107)Σ2,ψ(t,v) = (cid:107)Y L(t, v)(cid:107)Σ1,(t,v) = (cid:107)Y (cid:107)Σ1,(0,0).

On the other hand, the left-invariance of the metric in ∆L
is orthogonal to (dLψ(t,v))(0,0)(dψ)(0,0)X and

2 implies that (dLψ(t,v))(0,0)(dψ)(0,0)Y ∈ ∆2(ψ(t, v))

(cid:107)(dLψ(t,v))(0,0)(dψ)(0,0)Y (cid:107)Σ2,ψ(t,v) = (cid:107)(dψ)(0,0)Y (cid:107)Σ2,(0,0) = (cid:107)Y (cid:107)Σ1,(0,0).

Since by hypothesis,

(dψ)(t,v)X L(t, v) = (dLψ(t,v))(0,0)(dψ)(0,0)X,

the fact that dim(∆L

2 (ψ(t, v)) = 2 forces that

(dψ)(t,v)Y L(t, v) = ε(t, v)(dLψ(t,v))(0,0)(dψ)(0,0)Y, where

ε(t, v) = ±1.

(10)

Moreover, by orthogonality, we obtain that

ε(t, v) =

(cid:10)(dψ)(t,v)Y L(t, v), (dLψ(t,v))(0,0)(dψ)(0,0)Y (cid:11)

(cid:107)X(cid:107)Σ1,(0,0)

Σ2,ψ(t,v)

,

showing that ε is a continuous function on G(θ) \ Z1 and hence, ε is constant on the connected components of
G(θ) \ Z1. Since A1 (cid:54)≡ 0, Theorem 3.8 implies that G(θ) \ Z1 has two connected C+
1 . Let us consider
ε+ := ε|C+
If for some (t, v) ∈ G(θ) \ Z the curve s (cid:55)→ (t, v) exp sY intersects Z1, then by Theorem 3.10 such intersection
is a discrete set. Assume w.l.o.g. that (t, v) ∈ C+

and ε− := ε|C−

1 and C−

1 and consider the sets

.

1

1

I + := {s ∈ R; (t, v) exp sY ∈ C+
1 }

and

I − := {s ∈ R; (t, v) exp sY ∈ C−

1 }.

These sets are open and their union is, by Theorem 3.10, dense in R. The curves

are diﬀerentiable and by equation (10) satisﬁes

γ± : I ± → G,

γ±(s) := ψ ((t, v) exp sY ) .

d
ds

γ±(s) = (dψ)(t,v) exp sY Y L((t, v)) exp sY ) = (ε±Z)L(ψ((t, v) exp sY )) = (ε±Z)L(γ±(s)),

where for simplicity Z := (dψ)(0,0)Y . Therefore, γ±(s) coincides with the solution of the ODE deﬁned by the
vector ﬁeld ε±Z L on the open set I ± × C±
1 . By uniqueness we get that

ψ((t, v) exp sY ) = ψ(t, v) exp sε±Z,

for all s ∈ I ±.

Since R \ I + ∪ I − are the points where the curve s (cid:55)→ (t, v) exp s(Y ) intersects Z1, we have by Theorem 3.10
that R \ I + ∪ I − is discrete. Let us assume that I − (cid:54)= ∅. In this case, there exists s0 ∈ R \ I + ∪ I − and δ > 0
such that

(t, v) exp s(Y ) ∈ C+

1 , s ∈ (s0, s0 + δ) and (t, v) exp s(Y ) ∈ C−

1 , s ∈ (s0 − δ, s0).

By continuity, we get that

ψ(t, v) exp s0ε+Z = ψ((t, v) exp s0Y ) = ψ(t, v) exp s0ε−Z =⇒ exp s0ε+Z = exp s0ε−Z,

which by Remark 2.4 gives us that ε+ = ε−.

16

On the other hand, if I − = ∅, let us consider an open set (t, v) ∈ U ⊂ C+
U exp s0Y intersects Z1 at the point (t, v) exp s0Y and, since Z1 is a 2D embedded manifold, we have that

1 and s0 ∈ R \ I +. The open set

U exp s0 ∩ C−

1 (cid:54)= ∅.

In particular, there exists (ˆt, ˆv) ∈ C+

1 such that (ˆt, ˆv) exp s0Y ∈ C−

1 . As a consequence, both of the sets

ˆI + := {s ∈ R; (ˆt, ˆv) exp sY ∈ C+
1 }

and

ˆI − := {s ∈ R; (ˆt, ˆv) exp sY ∈ C−

1 },

are nonempty. By doing the previous analysis with (ˆt, ˆv) instead of (t, v) allows us to conclude that ε+ = ε−.
Now, if for all (t, v) ∈ G(θ) \ Z1 and s ∈ R we have that (t, v) exp s(a, w) ∈ G(θ) \ Z1, then as previously for all
(t, v) ∈ C±

1 we get

ψ((t, v) exp sY ) = ψ(t, v) exp sε±Z,

for all s ∈ R.

Again by the fact that Z1 is an embedded 2D manifold, there exists γ : (−δ, δ) → G(θ) satisfying

and hence, for all s ∈ R it holds that

γ(0) ∈ Z, γ(−δ, 0) ⊂ C−
1

and

γ(0, δ) ⊂ C+
1 ,

ψ(γ(τ ) exp sY ) = ψ(γ(τ )) exp sε+Z, τ ∈ (0, δ) and ψ(γ(τ ) exp sY ) = ψ(γ(τ )) exp sε−Z, τ ∈ (−δ, 0).

By considering the limit τ → 0 we get by continutity that

ψ(γ(0)) exp sε+Z = ψ(γ(0) exp sY ) = ψ(γ(0)) exp sε−Z, ∀s ∈ R,

implying that ε+ = ε− and concluding the proof of Step 1.

Step 2: It holds that f (t, v) = at and g(t, v) = g(0, v) + Λaθ

t ∂1g(0, 0).

Since (dL(t,v))(0,0)(1, 0) = (1, 0) we have that

(cid:16)

∂1f (t, v), ∂1g(t, v)

(cid:17)

= (dψ)(t,v)(1, 0) = (dLψ(t,v))(dψ)(0,0)(1, 0)

= (dLψ(t,v))

(cid:16)

∂1f (0, 0), ∂1g(0, 0)

(cid:17)

(cid:16)

=

∂1f (0, 0), ρf (t,v)∂1g(0, 0)

(cid:17)

,

implying that

∂1f (t, v) = ∂1f (0, 0)

and

∂1g(t, v) = ρf (t,v)∂1g(0, 0).

(11)

Analogously, for (0, u) ∈ ∆ ∩ {0} × R2

((cid:104)∂2f (t, v), ρtu(cid:105)R2, ∂2g(t, v)ρtu) = (dψ)(t,v)(0, ρtu) = (dLψ(t,v))(0,0)(dψ)(0,0)(0, u)

= (dLψ(t,v))(0,0)

(cid:16)

(cid:104)∂2f (0, 0), u(cid:105)R2, ∂2g(0, 0)u

(cid:17)

(cid:16)

=

(cid:104)∂2f (0, 0), u(cid:105)R2, ρf (t,v)∂2g(0, 0)u

(cid:17)

,

implying that

(cid:104)∂2f (t, v), ρtu(cid:105)R2 = (cid:104)∂2f (0, 0), u(cid:105)R2

and

∂2g(t, v)ρtu = ρf (t,v)∂2g(0, 0)u.

(12)

By integration, equation (11) implies that

f (t, v) = at + h(v),

a = ∂1f (0, 0) and h(v) = f (0, v).

Therefore, from equation (12) we get that

(cid:104)∇h(v), ρtu(cid:105)R2 = (cid:104)∇h(0), u(cid:105)R2 =⇒ (cid:104)∇h(v), ρtu(cid:105)R2 = (cid:104)∇h(v), u(cid:105)R2 =⇒ (cid:104)∇h(v), (ρtu − u)(cid:105)R2 = 0.

17

On the other hand, f ◦ ϕ1

s = f implies that

h(esA1v + Λθ

t ΛA1

s ξ1) = h(v),

(13)

and so,

Hence,

h(esA1 v) = h(v) =⇒ ∇h(esA1v) = e−sAT

1 ∇h(v).

(cid:104)∇h(v), u(cid:105)R2 = (cid:104)∇h(esA1 v), u(cid:105)R2 = (cid:104)e−sAT

1 ∇h(v), u(cid:105)R2 = (cid:104)∇h(v), e−sA1 u(cid:105)R2 =⇒ (cid:104)∇h(v), (e−sA1 u−u)(cid:105)R2 = 0.

Now, derivation of (13) ﬁrst at t = 0 and then at s = 0, gives us

(cid:104)∇h(v), ξ1(cid:105)R2 = 0,

which together with the previous equations imply that {ξ1, esA1u − u, ρtu − u,
line if ∇h(v) (cid:54)= 0 for some v ∈ R2.
t, s ∈ R} belongs to the same line we necessarily have that u is a common
However, if {ξ1, esA1u − u, ρtu − u,
eigenvalue of θ and A1 which gives us that ∆1 is a subalgebra containing (1, 0), A1l∆ ⊂ l∆ and ξ1 ∈ l∆1, which
by Proposition 3.3 contradicts the LARC. Therefore,

t, s ∈ R} belongs to the same

∇h(v) = 0

for all

v ∈ R2 =⇒ f (t, v) = at,

as stated.

Now, since f (t, v) = at, equation (11) implies that

which by integration gives us

∂1g(t, v) = ρat∂1g(0, 0)

g(t, v) − g(0, v) =

(cid:90) t

0

∂1g(s, v)ds =

(cid:90) t

0

ρas∂1g(0, 0)ds = Λaθ

t ∂1g(0, 0),

showing the assertion for g.

Step 3: For all (t, v) ∈ G(θ) and s ∈ R, it holds that

∂2g(0, v)ρtξ1 = ρat∂2g(0, 0)ξ1

and

∂2g(0, v)ρte−sA1u = ρat∂2g(0, 0)e−sA1 u

(14)

Since ψ commutes the ﬂows of the linear vector ﬁelds of Σ1 and Σ2, it holds that

g (cid:0)t, esA1v + ΛA1

s Λθ

t ξ1

(cid:1) = esA2g(t, v) + ΛA2

s Λθ

atξ2,

and by Step 2,

g (cid:0)0, esA1v + ΛA1

s Λθ

t ξ1

(cid:1) + Λθ

atη = esA2g(0, v) + esA2Λθ

atη + ΛA2

s Λθ

atξ2,

where η = ∂1g(0, 0). Therefore,

g (cid:0)0, esA1 v + ΛA1

s Λθ

t ξ1

(cid:1) − esA2g(0, v) = (esA2 − idR2 )Λθ

atη + ΛA2

s Λθ

atξ2 = ΛA2

s Λθ

at (ξ2 + A2η) .

(15)

Derivation of equation (15) on t gives us, by the chain rule, that

∂2g (cid:0)0, esA1v + ΛA1

s Λθ

t ξ1

(cid:1) ρtΛA1

s ξ1 = ρatΛA2
s

(ξ2 + A2η) .

Since the previous equations is true for any s ∈ R and any (t, v) ∈ G, we can substitute v by e−sA1 (cid:0)v − ΛA1
in order to obtain

s Λθ

t ξ1

(cid:1)

∂2g(0, v)ρtΛA1

s ξ1 = ρatΛA2
s

(ξ2 + A2η) .

18

Derivating now the last equation at s = 0 gives us

∂2g(0, v)ρtξ1 = ρat (ξ2 + A2η) = ρat∂2g(0, 0)ξ1,

proving the ﬁrst equality. For the second equality, let us notice that the right-hand side of equation (15) does
not depends on v and hence

v ∈ R2 (cid:55)→ g (cid:0)0, esA1v + ΛA1

s Λθ

t ξ1

(cid:1) − esA2g(0, v),

has diﬀerential zero. By the chain rule, we obtain
∂2g (cid:0)0, esA1v + ΛA1

s Λθ

t ξ1

(cid:1) esA1 = esA2∂2g(0, v).

On the other hand, by Step 2.

∀(t, v) ∈ G(θ), ∂2g(t, v) = ∂2g(0, v)

and

f (t, v) = at,

which by equation (12) gives us that

Therefore, for any (t, v) ∈ G(θ) and s ∈ R we get

∂2g(0, v)ρtu = ρat∂2g(0, 0)u.

∂2g(0, v)ρte−sA1 u = ∂2g(0, v)e−sA1ρtu = e−sA2 ∂2g (cid:0)0, esA1v + ΛA1

s Λθ

t ξ1

(cid:1) ρtu

(12)
= e−sA2ρat∂2g(0, 0)u = ρate−sA2 ∂2g(0, 0)u = ρat∂2g(0, 0)e−sA1u,

showing the assertion.

Step 4: ψ ∈ Aut(G(θ))

We have to analyze the following possibilities:

1. ∆1 is not a subalgebra:

In this case, u (cid:54)= 0 is not an eigenvalue of θ. Since, for t = s = 0 the second equation in (14) implies that

∂2g(0, v)ρtu = ∂2g(0, 0)u,

it holds that

∀v ∈ R2,

∂2g(0, v)ρtu = ρat∂2g(0, 0)u = ρat∂2g(0, v)u.

Since a∂2g(0, v) = det(dψ)(t,v) (cid:54)= 0 we have necessarily that ∂2g(0, v) ∈ Gl(2, R). Applying Lemma A.1 to
the linear maps ∂2g(0, v) gives us that,

∀v ∈ R2, ∂2g(0, v) = ∂2g(0, 0)

and

∂2g(0, 0) ◦ θ = aθ ◦ ∂2g(0, 0),

where a = 1 if tr θ (cid:54)= 0 or a ∈ {−1, 1} if tr θ = 0.

2. ∆1 is a subalgebra and θ (cid:54)= idR2:

In this case, the fact that A1θ = θA1 implies that u is also an eigenvector of A1. Since we are assuming
(1, 0) ∈ ∆1, the LARC implies by Lemma 3.3 that {ξ1, u}1 is linearly independent.
Considering t = s = 0 in equations (14) gives us that

∂2g(0, v)u = ∂2g(0, 0)u and ∂2g(0, v)ξ1 = ∂2g(0, v)ξ1,

which by linearity implies that,

∀v ∈ R2

∂2g(0, v) = ∂2g(0, 0)

and

∂2g(0, v) ◦ ρt = ρat ◦ ∂2g(0, v).

By diﬀerentiation, we get that ∂2g(0, 0) ◦ θ = aθ ◦ ∂2g(0, 0) implying that a = 1 if tr θ (cid:54)= 0 or a ∈ {−1, 1}
if tr θ = 0.

1See also Remark after the Lemma.

19

3. ∆1 is a subalgebra and θ = idR2 :

In this case,

et∂2g(0, v)u = et∂2g(0, v)ρtu = ρat∂2g(0, 0)u = eat∂2g(0, v)u,

implying that a = 1. If {ξ, u} is linearly independent, we can conclude as in the previous item that

∀v ∈ R2, ∂2g(0, v) = ∂2g(0, 0).

On the other hand, if {ξ1, u} is linearly dependent, the LARC implies necessarily that u cannot be an
eigenvector of A1 (see Lemma 3.3). In particular, for some s0 ∈ R, {u, e−s0A1 u} is a basis of R2 and by
Step 3. the linear maps ∂2g(0, v) and ∂2g(0, 0) coincides on such basis, implying that ∂2g(0, v) = ∂2g(0, 0)
for all v ∈ R2.

In any case, we get that

f (t, v) = εt

and

g(t, v) = P v + εΛεθ

t η,

where η = ∂1g(0, 0), P = ∂2g(0, 0) and P θ = εθP with ε = 1 if tr θ (cid:54)= 0 or ε ∈ {−1, 1} if tr θ = 0. Moreover, by
deﬁnition,

(cid:90) t

(cid:90) εt

∆εt

t η =

eεsθηds = ε

eµθηdµ = εΛθ

εtη,

0

0

implying that ψ ∈ Aut(G(θ)) and concluding the proof.

(cid:3)

4.2 Invariance of the nilradical

In this section we show that for an isometry ψ ∈ Isoθ(Σ1; Σ2)0 between rank two ARS’s with ψ = (f, g), the
coordinate function f only depends on the ﬁrst variable of G(θ) or equivalently, it satisﬁes ∂2f ≡ 0.
Let us consider {Xi, Yi} ⊂ ∆i to be orthonormal basis. Since ψ∗∆L
2 ◦ ψ, we can write uniquely

1 = ∆L

ψ∗X L

1 = α1X L

2 (ψ) + α2Y L

2 (ψ),

where

1 + α2
α2
and each αi can be recovered from the orthonormality of the basis as

2 = (cid:107)ψ∗X L

= (cid:107)X L

1 (cid:107)2
Σ2

1 (cid:107)2
Σ1

= (cid:107)X1(cid:107)2
Σ1

= 1,

2 (ψ)(cid:105)Σ2 and α2 = (cid:104)ψ∗X L
showing that αi : G(θ) \ Z1 → R are C∞ functions. The fact that {X L
ψ is an isometry allow us to write

α1 = (cid:104)ψ∗X L

1 , X L

1 , Y L

2 (ψ)(cid:105)Σ2 ,

1 , Y L

1 } is an orthonormal basis of ∆L

1 and

ψ∗Y L

1 = (cid:15) (cid:0)−α2X L

2 (ψ) + α1Y L

2 (ψ)(cid:1) ,

where (cid:15) = ±1 is constant on the connected components of G(θ) \ Z1. Since all the calculations will be taking
into account the connected components of G(θ) \ Z1 we will assume that (cid:15) = 1. As one can easily see, such
assumption bears no loss of generality and avoids cumbersome notation.

Let us consider an orthonormal basis of ∆i satisfying

Xi = (0, ui) and Yi = (σi, wi), with σiwi (cid:54)= 0.

By writting ψ = (f, g) and ψ∗ =

(cid:18) ∂1f
∂1g

(∂2f )T
∂2g

(cid:19)

, the previous considerations imply that

ψ∗(0, ρtu1) = α1(0, ρf u2) + α2(σ2, ρf w2)

and ψ∗(σ1, ρtw1) = −α2(0, ρf u2) + α1(σ2, ρf w2),

or equivalently

(cid:26) (cid:104)∂2f, ρtu1(cid:105)R2 = α2σ2

σ1∂1f + (cid:104)∂2f, ρtw1(cid:105)R2 = α1σ2

and

(cid:26) ∂2gρtu1 = ρf (α1u2 + α2w2)

σ1∂1g + ∂2gρtw1 = ρf (−α2u2 + α1w2)

.

(16)

20

Now,

and consequently, by diﬀerentiation,

ψ ◦ ϕ1

s = ϕ2

s ◦ ψ =⇒ f ◦ ϕ1

s = f,

(cid:104)∂2f, A1v + Λθ

t ξ1(cid:105)R2 = 0;

∂1f = ∂1f (ϕ1

s) + (cid:104)∂2f (ϕ1

s), ρtΛA1

s ξ1(cid:105)R2

and

Now, using again the equations in (16) we get that

∂2f (ϕ1

s) = e−sAT

1 ∂2f.

(17)

2 = (σ2α2(ϕ1
σ2

s))2 + (σ2α1(ϕ1

s))2 = (cid:104)∂2f (ϕ1

s), ρtu1(cid:105)2

R2 + (cid:0)σ1∂1f (ϕ1

s) + (cid:104)∂2f (ϕ1

s), ρtw1(cid:105)R2

(cid:1)2

= (cid:104)e−sAT

1 ∂2f, ρtu1(cid:105)2

R2 +

(cid:16)

(cid:16)

σ1

∂1f − (cid:104)e−sAT

1 ∂2f, ρtΛA1

s ξ1(cid:105)R2

(cid:17)

+ (cid:104)e−sAT

1 ∂2f, ρtw1(cid:105)R2

(cid:17)2

= (cid:104)∂2f, e−sA1ρtu1(cid:105)2

R2 +

(cid:16)

σ1

(cid:16)
∂1f + (cid:104)∂2f, ρtΛA1

−sξ1(cid:105)R2

(cid:17)

+ (cid:104)∂2f, e−sA1ρtw1(cid:105)R2

(cid:17)2

,

where in the second parenthesis we used that e−sA1 ΛA1

s = −ΛA1
−s.

Derivation at s = 0 gives us

0 = 2 (cid:104)∂2f, ρtu1(cid:105)R2
(−σ1(cid:104)∂2f, ρtξ1(cid:105)R2 + (cid:104)∂2f, −A1ρtw1(cid:105)R2)
((cid:104)∂2f, −A1ρtu1(cid:105)R2 + 2 (σ1∂1f + (cid:104)∂2f, ρtw1(cid:105)R2)
(cid:125)
(cid:125)
(cid:124)

(cid:124)

(cid:123)(cid:122)
=α2σ2

(cid:123)(cid:122)
=α1σ2

showing that

= −2 (cid:104)∂2f, ρt (σ1σ2α1ξ1 + σ2A1(α2u1 + α1w1))(cid:105)R2 ,

∂2f

is orthogonal to ρt (σ1σ2α1ξ1 + σ2A1(α2u1 + α1w1))

on G(θ) \ Z1.

Using the third equation in (17), allow us to conclude that, on G(θ) \ Z1,

∂2f (cid:54)= 0 =⇒ {A1v + Λθ

t ξ1, ρt(σ1σ2α1ξ1 + σ2A1(α2u1 + α1w1)} is LD}.

(18)

We show that ∂2f ≡ 0 by analyzing the possibilities for the eigenvalues of A1 in the next propositions.

4.6 Proposition: If A1 has only eigenvalues with nonzero real parts, ∂2f ≡ 0.

Proof: According to Proposition 3.5 (see also Remark 3.6) we can assume w.l.o.g. that (1, 0) ∈ ∆1. Under this
assumption, we have that w1 = cu1 and equations (16) gives us that

(cid:104)∂2f, ρtu1(cid:105)R2 = α2σ2 and ∂1f =

σ2
σ1

(α1 − cα2).

Using equations (16) allows us to obtain that,

α2(ϕ1

s)σ2 = (cid:104)∂2f (ϕ1

s), ρtu1(cid:105)R2 = (cid:104)e−sAT

1 ∂2f, ρtu1(cid:105)R2

is bounded for s ∈ R 2. However, if A1 has only eigenvalues with nonzero real parts, the fact that u1 (cid:54)= 0 implies
by Lemma A.2 that α2 ≡ 0 and α1 = 1 showing that ∂1f is constant on G \ Z1. Using the continuity of f and
the fact that G(θ) \ Z1 is an open and dense subset of G(θ) allow us to conclude that

∀(t, v) ∈ G(θ),

f (t, v) = at + h(v), where a = σ2/σ1 and h(v) = f (0, v).

The same analysis as in Step 2. of Lemma 4.5 allow us to conclude that under the LARC and rank two
(cid:3)
assumptions it holds that h ≡ 0 showing that ∂2f ≡ 0 as stated.

4.7 Proposition: If A1 has a pair of pure imaginary eigenvalues, ∂2f ≡ 0.

2See Remark 3.11

21

Proof: Let us here assume that ξ1 = 0 and consider the set

The ﬁrst to notice is that

A := {(t, v) ∈ G(θ); ∂2f (t, v) (cid:54)= 0}.

∂2f (ϕ1

s) = e−sAT

∂2f =⇒ ϕ1

s(A) ⊂ A.

Also, the fact that A1 has a pair of imaginary eigenvalues and that A1θ = θA1 imply that, on the canonical

basis, A1 =

, for some µ (cid:54)= 0.

(cid:19)

(cid:18) 0 −µ
0
µ

The assumption that ξ1 = 0 implies

Z1 = {(t, sρtA−1

1 u1), t, s ∈ R}

and ZX1 = R × {0}.

Consequently, for any (t, v) ∈ Z1 \ ZX1 there exists s0 ∈ R such that ϕs0(t, v) ∈ G(θ) \ Z1. In particular we get
that

Let us consider (t0, v0) ∈ A ∩ G \ Z1. By relation (18) we get that

A \ ZX1 (cid:54)= ∅ =⇒ A ∩ G(θ) \ Z1 (cid:54)= ∅.

α2(t0, v0)ρt0 u1 + α1(t0, v0)ρt0w1 ∈ Rv0 =⇒ α2(t0, v0)(cid:104)ρt0u1, v∗

0(cid:105)R2 + α1(t0, v0)(cid:104)ρt0w1, v∗

0(cid:105)R2 = 0,

and since α2

1 + α2

2 = 1 we obtain

α1(t0, v0)2 =

(cid:104)ρt0 u1, v∗
0(cid:105)2

0(cid:105)2
R2
R2 + (cid:104)ρt0 w1, v∗

0(cid:105)2
R2

(cid:104)ρt0 u1, v∗

and

α2(t0, v0)2 =

(cid:104)ρtw1, v∗
0(cid:105)2

0(cid:105)2
R2
R2 + (cid:104)ρt0w1, v∗

0(cid:105)2
R2

(cid:104)ρt0u1, v∗

.

(19)

With the previous we will show that A ⊂ ZX1 by considering two cases:

1. u1 and w1 are not orthogonal vectors;

Let (t, v) ∈ A \ ZX1 . The fact that esA1v is a circunference around the origin gives us that

{esA1v, s ∈ R} ∩ {(t, sρtw1), s ∈ R} (cid:54)= ∅ =⇒ ∃s0, s1 ∈ R∗; es0A1 v = s2ρtw1.

In particular, if u1 and w1 are not orthogonal vectors, A1w1 /∈ Ru1 implying that (t, s1ρtw1) ∈ G(θ) \ Z1
and hence

A (cid:51) ϕs0 (t, v) = (t, es0A1v) = (t, s1ρtw1) ∈ G(θ) \ Z1.

By formula (19) we get

(cid:104)ρtw1, (ρtw1)∗(cid:105)R2 = 0 =⇒ α2(t, s1ρtw1) = 0

(16)
=⇒ (cid:104)∂2f (t, s1ρtw1), ρtu1(cid:105)R2 = 0.

On the other hand, by the ﬁrst equation in (17) we get that

(cid:104)∂2f (t, s1ρtw1), A1(s1ρtw1)(cid:105)R2 = 0 =⇒ (cid:104)∂2f (t, s1ρtw1), ρtA1w1(cid:105)R2 = 0.

Since A1w1 /∈ Ru1, the set {ρtu1, ρtA1w1} is a basis of R2, which by the previous equalities imply
∂2f (t, s1ρtw1) = 0, contradicting the fact that (t, v) ∈ A \ ZX1. Therefore, if u1 and w1 are not orthogonal
vectors we must have that A \ ZX1 = ∅.

2. u1 and w1 are orthogonal vectors;

Let (t, v) ∈ A \ ZX1. As previously,

∃s0, s1 ∈ R∗; A (cid:51) ϕ1
s0

(t, v) = (t, s1ρtu1) ∈ G(θ) \ Z1

(19)
=⇒ α1(t, s1ρtu1) = 0.

Since u1 and w1 orthogonal are equivalent to A1u1 ∈ Rw1, the ﬁrst equation in (17) gives us that

(cid:104)∂2f (t, s1ρtu1), A1(s1ρtu1)(cid:105)R2 = 0 =⇒ (cid:104)∂2f (t, s1ρtw1), ρtw1(cid:105)R2 = 0,

22

and hence,

∂1f (t, s1ρtu1) = ∂1f (t, s1ρtu1) + (cid:104)∂2f (t, s1ρtu1), ρtw1(cid:105)R2
(cid:125)

(cid:124)

(cid:123)(cid:122)
=0

= α1(t, s1ρtu1)σ2 = 0.

Since ξ1 = 0, the second equation in (17) implies ∂1f (ϕ1

s) = ∂1f for all s ∈ R. In particular,

∂1f (t, v) = ∂1f (ϕ1
s0

(t, v)) = ∂1f (t, s1ρtu1) = 0,

and by the arbitrariness of (t, v) ∈ A \ ZX1 we conclude that

A \ ZX1 ⊂ {(t, v) ∈ G(θ) \ ZX1; ∂1f (t, v) = 0}.

Now, if (t0, v0) ∈ (A \ A) ∩ G(θ) \ Z1, the fact that f restrict to G(θ) \ Z1 is C∞ implies that

∂1f (t0, v0) = 0

and

∂2f (t0, v0) = 0,

which is a contradition to the fact that ψ is a diﬀeomorphism. Therefore, A ∩ (G(θ) \ Z1) is open and
closed in G(θ) \ Z1 and so, A contains any connected component of G(θ) \ Z1 that it intersects. However,
by Theorem 3.8 the set G \ Z1 has two connected components and, since A1 has a pair of imaginary
eigenvalues, any point (t, v) ∈ G(θ) \ Z1 crosses the singular locus by the action of the ﬂow of X1 (see
Remark 3.11). Consequently, the invariance ϕs(A) ⊂ A implies that

A \ ZX1 (cid:54)= ∅ =⇒ A ∩ (G(θ) \ Z1) (cid:54)= ∅ =⇒ G(θ) \ Z1 ⊂ A.

From that, we conclude that ∂1f |G(θ)\Z1 ≡ 0 and by the continuity of f we get actually

f (t, v) = f (0, v) =⇒ ∂1f ≡ 0.

However, since det A1 (cid:54)= 0, we have that

∂2f (ϕ1

s) = e−sAT

∂2f =⇒ ∂2f (0, 0) = 0,

which together with ∂1f ≡ 0 is a contradiction with the fact that ψ is a diﬀeomorphism.

Therefore, in both cases, we conclude that A \ ZX1 = ∅ or equivalently A ⊂ ZX1. By considering the comple-
mentary, we get that

As in the previous cases, by integration we get that

∂2f |G(θ)\ZX1

≡ 0.

∀(t, v) ∈ G(θ) \ ZX1,

f (t, v) = at, where a = σ2/σ1 ∈ R∗,

and by continuity f (t, v) = at for all (t, v) ∈ G(θ) implying that ∂2f ≡ 0 and concluding the proof.

(cid:3)

4.8 Proposition: If R2 = ImA1 ⊕ Rξ1 then ∂2f ≡ 0.

Proof: Let us as previously assume that (1, 0) ∈ ∆1. In this case, w1 = cu1 and from equations (16) we get
that

∂1f = (α1 − cα2)σ2 =⇒ ∂1f is bounded on G(θ) \ Z1.

On the other hand, by our hypothesis dim ImA1 = 1 and so we have the following possibilities:

1. A1 has a pair of distinct eigenvalues: Since A1θ = θA1 we have that, on the canonical basis,

A1 =

(cid:19)

(cid:18) β 0
0
0

or A1 =

(cid:19)

(cid:18) 0

0
0 β

and

θ =

(cid:18) 1

0
0 λ

(cid:19)

.

23

Let us assume that the ﬁrst case holds for A1 since the analysis of the second case is analogous. By our
hypothesis, we can write ξ1 = ae1 + be2 with b (cid:54)= 0, and hence

ρtΛA1

−sξ1 = aet 1
β

(e−sβ − 1)e1 − bsetλe2.

Also, from the second and third equations in (17) we have that

∂1f = ∂1f (ϕ1

s) + (cid:104)∂2f (ϕ1

s), ρtΛA1

s ξ1(cid:105)R2 = ∂1f (ϕ1

s) − (cid:104)∂2f, ρtΛA1

−sξ1(cid:105)R2,

implying by Remark 3.11 that

(cid:104)∂2f, ρtΛA1

−sξ1(cid:105)R2 = ∂1f (ϕ1

s) − ∂1f,

is bounded for s ∈ R. As a consequence,

(cid:104)∂2f, ρtΛA1

−sξ1(cid:105)R2 = aet 1
β

(e−sβ − 1)(cid:104)∂2f, e1(cid:105)R2 − bsetλ(cid:104)∂2f, e2(cid:105)R2,

is bounded and hence

a(cid:104)∂2f, e1(cid:105)R2 = 0

and

If a = 0 we get that ξ1 ∈ ker A1 = Re2. In particular, Λθ

(cid:104)∂2f, e2(cid:105)R2 = 0.
t ξ1 ∈ ker A1 and

(cid:104)∂2f, e2(cid:105)R2 = 0 =⇒ (cid:104)∂2f, Λθ

t ξ(cid:105)R2 = 0.

Using the ﬁrst equation in (17) we get that

0 = (cid:104)∂2f, A1v + Λθ

t ξ(cid:105)R2 = (cid:104)∂2f, A1v(cid:105)R2,

which gives us that

∀(t, v) ∈ G(θ) \ ({0} × ker A1),

(cid:104)∂2f, e1(cid:105)R2 = 0,

and in particular ∂2f ≡ 0 on G(θ) \ Z1. Therefore, ∂1f = σ2/σ1 =: a on G(θ) \ Z1 implying, by the
continuity of f that f (t, v) = at on G(θ) which implies the result.

2. A1 is nilpotent: As in the previous case, the fact that A1 and θ commutes gives us that, on the canonical

basis,

A1 =

(cid:19)

(cid:18) 0 β
0
0

and

θ =

(cid:18) 1
0

(cid:19)

δ
1

, δ ∈ {0, 1}

or A1 =

(cid:19)

(cid:18) 0

0
β 0

and

θ =

(cid:18) 1
0

(cid:19)

.

0
1

Let us as previously treat the ﬁrst case. By the rank two assumption we have that ξ1 = ae1 + be2 with
b (cid:54)= 0. Therefore,

ρtΛA1

−sξ1 = et

− (a + bδt)s

e1 − etbse2,

(cid:19)

(cid:18)
b

s2
2

and, as previously, ∂1f bounded on G(θ) \ Z1 implies
(cid:104)∂2f, ρtΛA1

∀s ∈ R,

−sξ1(cid:105)R2

is bounded.

Therefore,

(cid:104)∂2f, ρtΛA1

−sξ1(cid:105)R2 = et

(cid:18)

b

s2
2

(cid:19)

− (a + bδt)s

(cid:104)∂2f, e1(cid:105)R2 − etbs(cid:104)∂2f, e2(cid:105)R2

is bounded for s ∈ R implying that

etb
2

(cid:104)∂2f, e1(cid:105)R2 = 0

and

et ((a + bδt)(cid:104)∂2f, e1(cid:105)R2 + b(cid:104)∂2f, e2(cid:105)R2) = 0.

Since by assumption b (cid:54)= 0, the previous is equivalenty to

showing that ∂2f ≡ 0 on G(θ) \ Z1 and, as in the previous case, f (t, v) = at.

(cid:104)∂2f, e1(cid:105)R2 = (cid:104)∂2f, e2(cid:105)R2 = 0,

24

(cid:3)

4.3 Proof of Theorem 4.3

By the previous section, if ψ = (f, g) is an isometry between rank two ARS’s Σ1 and Σ2, then ∂2f ≡ 0. As a
consequence, if

X = (0, u) ∈ ∆1 ∩ (cid:0){0} × R2(cid:1) , with

(cid:107)X(cid:107)Σ1,(0,0) = 1,

we have that

showing that

On other hand,

(dψ)(t,v)X L(t, v) =

(cid:18) ∂1f (t, v)

0

∂1g(t, v) ∂2g(t, v)

(cid:19)

(cid:19) (cid:18) 0
ρtu

= (0, ∂2g(t, v)ρtu),

(dψ)(t,v)X L(t, v) ∈ ∆2(ψ(t, v)) ∩ (cid:0){0} × R2(cid:1) .

(dψ)(0,0)X ∈ ∆2(0, 0) =⇒ (dLψ(t,v))(0,0)(dψ)(0,0)X ∈ ∆2(ψ(t, v)) ∩ (cid:0){0} × R2(cid:1) .

Since ψ is an isometry and the metrics on ∆1 and ∆2 are left-invariant, we get that

(cid:107)(dψ)(t,v)X L(t, v)(cid:107)Σ2,(ψ(t,v)) = (cid:107)X L(t, v)(cid:107)Σ1,(t,v) = (cid:107)X(cid:107)Σ1,(0,0) = 1,

and

(cid:107)(dLψ(t,v))(0,0)(dψ)(0,0)X(cid:107)Σ2,(ψ(t,v)) = (cid:107)(dψ)(0,0)X(cid:107)Σ2,(0,0) = (cid:107)X(cid:107)Σ1,(0,0) = 1.

The fact that dim(∆2(ψ(t, v))) ∩ (cid:0){0} × R2(cid:1) = 1 implies

(dψ)(t,v)X L(t, v) = ±(dLψ(t,v))(0,0)(dψ)(0,0)X,

where the sign is constant on any connected component of G(θ) \ Z1. An analogous analysis as the one done
in the proof of Step 1 of the Fundamental Lemma implies that the sign is constant on the whole G(θ) and
consequently

(dψ)(t,v)X L(t, v) = (dLψ(t,v))(0,0)(dψ)(0,0)X.

By the Fundamental Lemma (4.5) we conclude that ψ is an automorphism of G(θ), concluding the proof.

4.4 A classiﬁcation result for rank two ARS’s

The results in the previous sections allow us to obtain a classiﬁcation result for rank two simple ARS’s.
For any σ ∈ R+ we consider the subsets of g(θ) given by

α1 = {(1, 0), (σ, e1)}, α2 = {(1, 0), (σ, e2)} and α3 = {(1, 0), (σ, e1 + e2)}.

Deﬁne the simple ARS’s of rank two Σi

X ,σ = {X , ∆L

i,σ} on G(θ), where

1. X is a rank two linear vector ﬁeld on G(θ);

2. αi is an orthonormal basis of ∆i,σ.

Denote by Eθ the set of all rank two simple ARS on G(θ) and consider the sets

θ = {Σ ∈ Eθ; Iso(Σ; Σi
E i

X ,σ)0 (cid:54)= ∅ for some Σi

X ,σ},

that is, E i

θ is the set of rank two ARS’s on G(θ) that are isometric to some of the ARS’s Σi

X ,σ.

4.9 Theorem: Up to a reescaling, it holds that

(i) Eθ = E 1

θ if θ ∈

(cid:26)(cid:18) 1
0

(cid:19)

,

(cid:18) λ −1
λ
1

0
1

(cid:19)

, λ ∈ R

(cid:27)

;

25

(ii) Eθ = E 1
θ

˙∪ E 3

θ if θ ∈

(iii) Eθ = E 1
θ

˙∪ E 2
θ

˙∪ E 3

θ if θ ∈

(cid:26)(cid:18) 1
1
0
1
(cid:26)(cid:18) 1

(cid:19)

(cid:18) 1

0
0 −1

,

(cid:19)(cid:27)
;

(cid:19)

(cid:27)

, λ ∈ (−1, 1)

.

0
0 λ

θ = ∅ if θ is in the cases (ii) or (iii).

Proof: Since, by Theorem 4.3, the only isometries between rank two ARS are automorphisms, we only have
to show that any given ARS Σ is isometric to some ARS in E i
θ for i = 1, 2, 3 and that for i (cid:54)= j we have that
θ ∩ E j
E i
Let us consider Σ = {X , ∆L} be a rank two ARS. By Proposition 3.5 (see also Remark 3.6) the ARS Σ is
isometric to an ARS whose distribution contains (1, 0). Consequently, we can assume w.l.o.g. that (1, 0) ∈ ∆.
By reescaling the norm on ∆ if necessary we can assume that (cid:107)(1, 0)(cid:107)Σ,(0,0) = 1. Choose (σ, u) ∈ ∆ such that
σ > 0 and {(1, 0), (σ, u)} is an orthonormal basis of ∆. Note that, in this case

(0, u) = −σ(1, 0) + (σ, u) =⇒ l∆ = Ru.

Write u = (x, y) and consider the following cases:

Case 1: θ ∈

(cid:26)(cid:18) 1
0

(cid:19)

,

(cid:18) λ −1
λ
1

0
1

(cid:19)

, λ ∈ R

(cid:27)

.

In this case, by considering P =

(cid:19)

(cid:18) x −y
x
y

we have that

P θ = θP,

det P = x2 + y2 (cid:54)= 0

and

P e1 = u.

The automorphism φ(t, v) = (t, P v) is an isometry between Σ1

Xφ,σ and Σ.

Case 2: θ =

(cid:18) 1
0

(cid:19)
.

1
1

In this case, by considering

P1 =

(cid:19)

(cid:18) x 0
0 x

if

y = 0

or P3 =

(cid:18) y x − y

(cid:19)

0

y

if y (cid:54)= 0,

we get that Piθ = θPi, det Pi (cid:54)= 0 and

P1e1 = u if y = 0 and P3(e1 + e2) = u if y (cid:54)= 0.

Therefore, if y = 0 the automorphism φ1(t, v) = (t, P1v) is an isometry between Σ1
automorphism φ3(t, v) = (t, P3v) is an isometry between Σ3

Xφ3 ,σ and Σ.

Xφ1 ,σ and Σ, and if y (cid:54)= 0 the

Case 3: θ =

(cid:18) 1

0
0 −1

(cid:19)

.

In this case, we consider

P1 =

(cid:19)

(cid:18) x 0
0 x

if

y = 0, P2 =

(cid:18) 0
y

(cid:19)

y
0

if

x = 0

or P3 =

(cid:19)

(cid:18) x 0
y
0

if xy (cid:54)= 0.

It holds that Piθ = θPi for i = 1 or 3 and P2θ = −θP2, det Pi (cid:54)= 0 and

P1e1 = u if y = 0, P2e1 = u if y = 0 and P3(e1 + e2) = u if xy (cid:54)= 0.

As in the previous case, if y = 0 the automorphism φ1(t, v) = (t, P1v) (resp.
φ2(t, v) = (−t, P2v)) is an isometry between Σ1
between Σ3

if x = 0 the automorphism
Xφ2 ,σ) and Σ, and φ3(t, v) = (t, P3v) is an isometry

Xφ1 ,σ (resp. Σ1

Xφ3 ,σ and Σ if xy (cid:54)= 0.

26

Case 4: θ =

(cid:19)

(cid:18) 1

0
0 λ

In this case, we consider

, λ ∈ (1, −1).

P1 =

(cid:19)

(cid:18) x 0
0 x

if

y = 0, P2 =

(cid:18) y
0

(cid:19)

0
y

if

x = 0

or P3 =

(cid:19)

(cid:18) x 0
y
0

if xy (cid:54)= 0.

Again by construction Piθ = θPi, det Pi (cid:54)= 0 and

P1e1 = u if y = 0, P2e2 = u if x = 0 and P3(e1 + e2) = u if xy (cid:54)= 0,

and the respectivel automorphisms φi(t, v) = (t, Piv) are isometries between ΣXφi ,,σ and Σ, for i = 1, 2, 3.
Since the previous cases cover all the possibilities, we have that E is in fact decomposed by the classes E i
θ as
given in items (i), (ii) and (iii). The only thing that remains to show is that, in cases (ii) and (iii) we have that
θ ∩ E j
E i
Since both cases are analogous, let us show case (ii). In this case, if E 1
vector ﬁelds X1, X3 and positive real numbers σ1, σ2 such that Σ1
Σ1

θ (cid:54)= ∅, there exists rank two linear
are isometrics. However, since
X3,σ3
are, by deﬁnition, rank two ARS’s, Theorem 4.3 implies that

θ = ∅ for i (cid:54)= j.

θ ∩ E 3
and Σ3

and Σ3

X1,σ1

X1,σ1

X3,σ3

Therefore, any ψ ∈ Iso (cid:0)Σ1

X1,σ1

; Σ3

X3,σ3

(cid:1)

0

satisﬁes

Iso (cid:0)Σ1

X1,σ1

; Σ3

X3,σ3

(cid:1)

0

⊂ Aut(G(θ)).

(dψ)(0,0) =

(cid:19)

(cid:18) ε

0
η P

, with P θ = εθP,

which implies, in particular, that In particular,

(dψ)(0,0)

(cid:0)∆1,σ ∩ {0} × R2(cid:1) = ∆3,σ ∩ {0} × R2 and hence P e1 ∈ R(e1 + e2).

However, by the hypothesis on θ, the subspace Re1 is a one dimensional eigenspace of θ. Since P θ = εθP we
get that

P e1 ∈ Re1 if ε = 1
which contradicts P e1 ∈ R(e1 + e2). Therefore, E 1

and P e1 ∈ Re2 if ε = −1,

θ ∩ E 3

θ = ∅ as stated.

(cid:3)

4.10 Remark: In the notation of the previous result, let us note that

(0, u) = −σ(1, 0) + (σ, u) =⇒ (cid:107)(0, u)(cid:107)Σ,(0,0) = 1 + σ2.

In particular, (cid:107)(0, u)(cid:107)Σ,(0,0) = 1 if and only if σ = 0. Consequently, the metric on ∆ is Euclidean if and only if
σ = 0.

A Dynamics of 2 × 2 matrices

A.1 Lemma: Let T ∈ Gl(2, R) and u ∈ R2 \ {(0, 0)}. If u is not an eigenvalue of θ and there exists a ∈ R∗
such that

then

T ρtu = ρatT u, ∀ t ∈

T ◦ θ = aθ ◦ T,

and a = 1 if tr θ (cid:54)= 0 or a ∈ {−1, 1} if tr θ = 0. Moreover, if S ∈ Gl(2, R) also satisﬁes 1. and 2. and T u = Su
then T = S.

27

Proof: If ρtu · u∗ = 0 for all t ∈ R then, by derivation at t = 0, θu · u∗ = 0 implying that θu ∈ span{u} and
hence u is an eigenvector of θ. Therefore, if u is not an eigenvalue of θ there exist t0, t1 ∈ R such that {u, ρt0u}
is linearly independent. Hence, for any w ∈ R2 there exists γ1, γ2 ∈ R such that w = γ1ρt0u + γ2ρt1u and so
T ρtw = T ρt(γ1ρt0 u + γ2ρt1u) = γ1T ρt+t0u + γ2T ρt+t1u 2.= γ1ρa(t+t0)T u + γ2ρa(t+t1)T u
ρt(γ1ρt0 T u + γ2ρt1T u) 2.= ρt(γ1T ρt0 + γ2T ρt1u) = ρtT (γ1ρt0u + γ2ρt1 u) = ρtT w,

showing that T ◦ ρt = ρat ◦ T .
Derivation at t = 0 gives us that

which implies the result.

T ◦ θ = aθ ◦ T,

Now, if S also satisﬁes 1. and 2. we have as previously that S ◦ ρt = ρat ◦ S. Therefore, if T u = Su we get that
∀t ∈ R, T ρtu = ρatT u = ρatSu = Sρtu.

Since {u, ρt0 u} is a basis of R2 for some t0 ∈ R, linearity of S and T implies T = S.

(cid:3)

Let a, b, c, θ, λ, λ1, λ2 ∈ R, with λ1 (cid:54)= 0 (cid:54)= λ2 and consider the functions

γ1(t) = aetλ1 + betλ2 + c, γ2(t) = eλt(at + b) + c

and χ(t) = etλ cos(t + θ) + c.

(20)

It is straightforward to see that the following properties holds:

1. a = b = 0 and γi ≡ c;

2. ab = 0 with a2 + b2 (cid:54)= 0 then γi is unbounded and has at most one zero;

3. ab (cid:54)= 0 then γ is unbounded and has at most two zeros;

4. χ has a ﬁnite number of zeros if |c| > 1;

5. The zeros of χ form an inﬁnite discrete subset of R if |c| ≤ 1.

A.2 Lemma: Let A ∈ gl(2, R), τ ∈ R and u, v ∈ R2 nonzero vectors. For the function

γ : R → R,

γ(t) = etAu · v + τ,

it holds:

1. The eigenvalues of A are real and

1.1. γ is an unbouded function with at most two zeros or

1.2. γ ≡ τ , u · v = 0 and u is an eigenvalue of A.

2. The eigenvalues of A are complex and

2.1. γ is unbounded with an enumerable discrete set of zeros if tr A (cid:54)= 0 or

2.2. γ is bounded with an enumerable discrete set of zeros if tr A = 0.

Proof: By considering an appropriated orthonormal basis α of R2 and writing [u]α = (a, b) and [v]α = (c, d) it
holds that

γ(t) = acetλ1 + bdetλ2 + τ,

if

[A]α =

γ(t) = eλt (u · v + εbct) + τ

if

[A]α =

(cid:18) λ1
0
λ2
0
(cid:18) λ ε
0 λ

(cid:19)

,

(cid:19)

,

or

γ(t) = eλt(cid:107)u(cid:107)(cid:107)v(cid:107) cos(µt + θ0) + τ,

if

[A]α =

(cid:18) λ −µ
λ
µ

(cid:19)

,

where θ0 is the angle between u and v. In particular, the assertions follows from the analysis of the maps γ1, γ2
(cid:3)
and χ commented previously.

28

B Lifting ARS’s to simply connected groups

In this section we prove some results relating simple ARS on general connected groups and their simply connected
coverings.

Let G be a connected n-dimensional Lie group with Lie algebra g. A vector ﬁeld X on G is said to be linear
if it is complete and its associated ﬂow {ϕs}s∈R is a 1-parameter subgroup of automorphisms of G. Any linear
vector ﬁeld is induces a derivation D ∈ Der(g) deﬁned by

DY = −[X , Y ], Y ∈ g and satisfying (dϕs)e = esD, s ∈ R.

A simple ARS Σ on G is a pair Σ = {X , ∆L}, where X is a linear vector ﬁeld and ∆L is a left-invariant
distribution, endowed with a left-invariant Riemannian metric, satisfying:

(i) The set {X (g) ∈ ∆L(g)} is nonempty;

(ii) Σ satisﬁes the LARC, that is, D∆ (cid:54)⊂ ∆ or [∆, ∆] (cid:54)⊂ ∆, where ∆ = ∆L(e).

As in the 3D case, the metric on G associated with Σ is deﬁned by declaring that X is unitary and orthogonal
to ∆L at every point of G. The singular set Z is the set where the metric fail to be Riemannian and is given as

The almost-Riemannian norm is deﬁned as

Z = {g ∈ G; X (g) ∈ ∆L(g)}.

(cid:107)X(cid:107)Σ,g = min






(cid:118)
(cid:117)
(cid:117)
(cid:116)

n−1
(cid:88)

j=0

i ; α0X (g) + α1Y L
α2

1 (g) + · · · + αn−1Y L

n−1(g) = X






,

where {Y1, . . . , Yn−1} is an orthonormal basis of ∆.
If Σ1 and Σ2 are simple ARS’s on G we denote by
IsoG(Σ1; Σ2) the group of isometries between Σ1 and Σ2, that is, ψ ∈ IsoG(Σ1; Σ2) if and only if ψ : G → G is
a diﬀeomorphism satisfying

We also deﬁne the set of isometries ﬁxing the identity as

∀g ∈ G, v ∈ TgG;

(cid:107)(dψ)gv(cid:107)Σ2,ψ(g) = (cid:107)v(cid:107)Σ1,g.

IsoG(Σ1; Σ2)0 = {ψ ∈ IsoG(Σ1; Σ2); ψ(e) = e} .

Let us denote by (cid:101)G the connected simply connected covering of G and by π : (cid:101)G → G the canonical homomor-
phism. For a simple ARS Σ = {X , ∆L} on G we deﬁne the lift of Σ to be the unique simple ARS (cid:101)Σ = { (cid:101)X , (cid:101)∆L}
on (cid:101)G satisfying

π∗ (cid:101)X = X ◦ π

and

π∗ (cid:101)∆L = ∆ ◦ π,

(21)

where the invariant metric in (cid:101)∆L is the one that turns the restriction

(dπ)g|

(cid:101)∆L(g) : (cid:101)∆(g) → ∆L(π(g)), ∀ g ∈ G,

into an isometry.
The existence of (cid:101)X is guaranteed in by [5, Theorem 2.2] and the existence of the distribution (cid:101)∆L comes from
the fact that π is a homomorphism and a local diﬀeomorphism. Moreover, the same properties of π implies
that (cid:101)Σ satisﬁes conditions (i) and (ii) in the deﬁnition of simple ARS’s.
Next we show some relations between a simple ARS and its lift.

B.1 Proposition: Let Σ be a simple ARS and (cid:101)Σ its lift. If Z and (cid:101)Z stands for the singular locus of Σ and (cid:101)Z,
respectively, then

π( (cid:101)Z) = Z and

π−1( (cid:101)Z) = Z.

29

Proof: In fact, since π is a local diﬀeomorphism, relation (21) implies that

g ∈ (cid:101)Z ⇐⇒ (cid:101)X (g) ∈ (cid:101)∆L(g) ⇐⇒ (dπ)g (cid:101)X (g) ∈ (dπ)g (cid:101)∆L(g) ⇐⇒ X (π(g)) ∈ ∆L(π(g)) ⇐⇒ π(g) ∈ Z

(cid:3)

Let us notice that the previous result implies that Z is a submanifold of G if and only if (cid:101)Z is a submanifold of
(cid:101)G. The next result relates isometries of a simple ARS and its lift.

B.2 Proposition: Let Σ1, Σ2 be a simple ARS’s on G and (cid:101)Σ1, (cid:101)Σ2 their respective lifts. For any ψ ∈ Iso(Σ1; Σ2)0
there exists a unique (cid:101)ψ ∈ Iso((cid:101)Σ1; (cid:101)Σ2)0 satisfying

π ◦ (cid:101)ψ = ψ ◦ π.

(22)

Moreover, if (cid:101)ψ ∈ Aut( (cid:101)G) then ψ ∈ Aut(G).

s}s∈R and { (cid:101)ϕi
π ◦ ( (cid:101)ψ ◦ (cid:101)ϕ1
(ϕ2

ψ∈Iso(Σ1;Σ2)0
=

Proof: Since π : (cid:101)G → G is the simply connected covering of G, there exists a unique map (cid:101)ψ with (cid:101)ψ(e) = e and
satisfying (22) and we only have to show that (cid:101)ψ ∈ Iso((cid:101)Σ1; (cid:101)Σ2)0.
Let {ϕi

s}s∈R to be the ﬂows of Xi and (cid:101)Xi, respectively. For any s ∈ R it holds that

s) = (π ◦ (cid:101)ψ) ◦ (cid:101)ϕ1

s

= (ψ ◦ π) ◦ (cid:101)ϕ1

(22)

s ◦ ψ) ◦ π = ϕ2

s ◦ (ψ ◦ π) =

(22)
= ϕ2

s = ψ ◦ (π ◦ (cid:101)ϕ1
s)
s ◦ (π ◦ (cid:101)ψ) = (ϕ2

(21)
= ψ ◦ (ϕ1

s ◦ π) = (ψ ◦ ϕ1

s) ◦ π

s ◦ π) ◦ (cid:101)ψ

(21)

= (π ◦ (cid:101)ϕ2

s) ◦ (cid:101)ψ = π ◦ ( (cid:101)ϕ2

s ◦ (cid:101)ψ).

As a consequence, for any g ∈ (cid:101)G we have the continuous curve

s ∈ R (cid:55)→ (cid:101)ψ( (cid:101)ϕ1

s(g))

(cid:16)

(cid:17)−1

(cid:101)ϕ2
s( (cid:101)ψ(g))

∈ ker π.

Since ker π is discrete, we have conclude that

(cid:101)ψ ◦ (cid:101)ϕ1

s = (cid:101)ϕ2

s ◦ (cid:101)ψ =⇒ π∗ ◦ (cid:101)X = X ◦ π.

On the other hand, it holds that

(dπ)

(cid:101)ψ(g)(d (cid:101)ψ)g (cid:101)∆1(g)

(22)
= (dψ)π(g)(dπ)g (cid:101)∆1(g)

(21)
= (dψ)π(g)∆1(π(g))

2 (ψ(π(g))) = ∆L
and since π is a local diﬀeomorphism, we conclude that

∆L

ψ∈Iso(Σ1;Σ2)0
=

2 (π( (cid:101)ψ(g))) = (dπ)

(cid:101)ψ(g) (cid:101)∆L

2 ( (cid:101)ψ(g)),

(cid:101)ψ∗ (cid:101)∆1 = (cid:101)∆L

2 ◦ (cid:101)ψ.

Therefore, in order to show that (cid:101)ψ ∈ Iso((cid:101)Σ1; (cid:101)Σ2)0 it is enough to assure that the restriction

(d (cid:101)ψ)g|

(cid:101)∆1

: (cid:101)∆1(g) → (cid:101)∆2( (cid:101)ψ(g),

is, for all g ∈ (cid:101)G, an isometry. However, for any X ∈ (cid:101)∆1, the fact that π is an isometry between (cid:101)∆i and ∆i,
i = 1, 2, implies that

(cid:107)(d (cid:101)ψ)gX(g)(cid:107)

(cid:102)Σ2, (cid:101)ψ(g) = (cid:107)(dπ)

(cid:101)ψ(g)(d (cid:101)ψ)gX(g)(cid:107)Σ2,π( (cid:101)ψ(g))

(22)
= (cid:107)(dψ)π(g)(dπ)X(g)(cid:107)Σ2,ψ(π(g))

which implies that (cid:101)ψ ∈ Iso((cid:101)Σ1; (cid:101)Σ2)0.

ψ∈Iso(Σ1;Σ2)0
=

(cid:107)(dπ)X(g)(cid:107)Σ1,π(g) = (cid:107)X(g)(cid:107)

(cid:101)Σ1,g,

For the second assertion, let us assume that (cid:101)ψ ∈ Aut( (cid:101)G) and consider g1, g2 ∈ G. By writting gi = π(hi),
i = 1, 2 we have that

ψ(g1g2) = ψ(π(h1)π(h2)) = ψ(π(h1h2))

(22)
= π( (cid:101)ψ(h1h2))

(cid:101)ψ∈Aut( (cid:101)G)
=

π( (cid:101)ψ(h1) (cid:101)ψ(h2)) = π( (cid:101)ψ(h1))π( (cid:101)ψ(h2))

(22)
= ψ(π(h1))ψ(π(h2)) = ψ(g1)ψ(g2),

showing that ψ ∈ Aut(G) and concluding the proof.

(cid:3)

30

B.3 Remark: Applying the previous results to the 3D solvable nonnilpotent case allow us to conclude that as
the main results obtained in Sections 3 and 4 are also true in the case where the group is not necessarely simply
connected.

References

[1] A. Agrachev, D. Barilari and U. Boscain, A comprehensive introduction to sub-Riemannian geometry,

Cambridge University Press, 2019.

[2] A. Agrachev, U. Boscain, and M. Sigalotti, A Gauss-Bonnet like formula on twodimensional almost-

Riemannian manifolds, Discrete Contin. Dyn. Syst., 20 (2008), pp. 801–822.

[3] A. Agrachev, U. Boscain, G. Charlot, R. Ghezzi, and M. Sigalotti, Two dimensional almost-Riemannian
structures with tangency points, Ann. Inst. H. Poincar´e. Anal. Non Lin´eaire, 27 (2010), pp. 793–807.

[4] V. Ayala and A. Da Silva, On the characterization of the controllability property for linear control systems
on nonnilpotent, solvable threedimensional Lie groups. Journal of Diﬀerential Equations, 266 No 12 (2019),
8233-8257

[5] V. Ayala and J. Tirao, Linear control systems on Lie groups and Controllability, Eds. G. Ferreyra et al.,

Amer. Math. Soc., Providence, RI, 1999.

[6] V. Ayala and P. Jouan. Almost-Riemannian Geometry on Lie groups SIAM Journal on Control and

Optimization 54 No 5 (2016), 2919-2947.

[7] B. Bonnard, J.-B. Caillau, R. Sinclair, and M. Tanaka. Conjugate and cut loci of a two-sphere of revolution
with application to optimal control Ann. Inst. H. Poincar´e Anal. Non Lin´eaire, 26 (2009), pp. 1081–1098.

[8] B. Bonnard, G. Charlot, R. Ghezzi, and G. Janin. The sphere and the cut locus at a tangency point in

two-dimensional almost-Riemannian geometry, J. Dyn. Control Syst., 17 (2011), pp. 141–161.

[9] U. Boscain and M. Sigalotti. High-order angles in almost-Riemannian geometry, S´emin. Th´eor. Spectr.

G´eom. 25, Universit´e Grenoble I, 2008, pp. 41–54.

[10] U. Boscain, G. Charlot, M. Gaye, and P. Mason. Local Properties of Almost-Riemannian Structures in

Dimension 3, Discrete Contin. Dyn. Syst., 35 (2015), pp. 4115-4147.

[11] U. Boscain, G. Charlot, R. Ghezzi, and M. Sigalotti. Lipschitz classiﬁcation of almost-Riemannian distances

on compact oriented surfaces, J. Geom. Anal., 23 (2013), pp. 438–455.

[12] U. Boscain, G. Charlot, and R. Ghezzi. Normal forms and invariants for 2-dimensional almost-Riemannian

structures, Diﬀerential Geom. Appl., 31 (2013), pp. 41–62.

[13] U. Boscain, and C. Laurent. The Laplace-Beltrami operator in almost-Riemannian Geometry, Ann. Inst.

Fourier, 63 (2013), pp. 1739–1770.

[14] V. V. Grushin, A certain class of hypoelliptic operators, Mat. Sb.(N.S.), 83 (1970), pp. 456–473.

[15] P. Jouan, G. Zsigmond and V. Ayala. Isometries of almost-Riemannian structures on Lie groups. Diﬀer-

ential Geometry and its Applications 61 (2018), 59 - 81.

[16] R. Montgomery, A tour of subriemannian geometries, their geodesics and applications, American Mathe-

matical Soc. 91, 2002.

[17] S. B. Myers and N. E. Steenrod, The Group of Isometries of a Riemannian Manifold, Annals of Mathe-

matics 40, No.2 (1939), 400-416.

[18] A. L. Onishchik and E. B. Vinberg, Lie groups and Lie algebras III - Structure of Lie groups and Lie

algebras, Springer Verlag, Berlin, 1994.

[19] T. Takasu, Generalized Riemannian geometry I, J. Yokohama Municipal Univ. Ser. D, Vol. 5, (1956).

31

