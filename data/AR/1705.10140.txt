Electronic Journal of Statistics
Vol. 0 (0) 1–29
ISSN: 1935-7524

Non-parametric estimation of time
varying AR(1)–processes with local
stationarity and periodicity

Jean-Marc Bardet1,* and Paul Doukhan2,**

1SAMM EA4543, University Panth´eon-Sorbonne, 90, rue de Tolbiac, 75634, Paris, France.
e-mail: *bardet@univ-paris1.fr

2AGM-UMR8088, University Cergy-Pontoise, France, and CIMFAV, Valparaiso, Chile.
e-mail: **doukhan@u-cergy.fr

Abstract: Extending the ideas of [7], this paper aims at providing a ker-
nel based non-parametric estimation of a new class of time varying AR(1)
processes (Xt), with local stationarity and periodic features (with a known
period T ), inducing the deﬁnition Xt = at(t/nT )Xt−1 + ξt for t ∈ N and
with at+T ≡ at. Central limit theorems are established for kernel estima-
tors (cid:98)as(u) reaching classical minimax rates and only requiring low order
moment conditions of the white noise (ξt)t up to the second order.

AMS 2000 subject classiﬁcations: Primary 62G05, 62M10; secondary
60F05.
Keywords and phrases: Local stationarity, Nonparametric estimation,
Central limit theorem.

This paper is dedicated to the memory of Jean Bretagnolle

1. Introduction

Since the seminal paper [5], the local-stationarity property provides new models
and approaches for introducing non-stationarity in times series. The recently
published handbook [7] gives a complete survey about new results obtained
since 20 years on this topics.
An interesting new kind of models is obtained from a natural extension of usual
ARMA processes, so called tvARMA(p, q)–processes deﬁned in [8], as:

p
(cid:88)

j=0

αj

(cid:17)

(cid:16) t
n

X (n)

t−j =

q
(cid:88)

k=0

βk

(cid:17)

(cid:16) t
n

ξt−k,

1 ≤ t ≤ n,

(1.1)

8
1
0
2

v
o
N
2
1

]
T
S
.
h
t
a
m

[

3
v
0
4
1
0
1
.
5
0
7
1
:
v
i
X
r
a

where αj and βk are bounded functions. This is a special case of locally station-
ary linear process deﬁned by X (n)
ξt−j. Such models have been
studied in many papers, especially concerning the parametric, semi-parametric
or non-parametric estimations of functions αj, βk or γj, or other functions de-
pending on these functions; see, for instance references [6], [8], [7], or [12], [3],

t = (cid:80)∞

j=0 γj

(cid:16) t
n

(cid:17)

imsart-ejs ver. 2014/10/16 file: nonstationarity28062018.tex date: November 24, 2021

1

 
 
 
 
 
 
Bardet and Doukhan/Local periodic time varying AR(1)–processes

2

[11], [17] or [2].

For simplicity, we restrict in this ﬁrst work to time-varying AR(1)–processes
(X (n)
t

) including a periodic component:

X (n)

t = at

(cid:19)

(cid:18) t
nT

X (n)

t−1 + ξt, with at+T ≡ at, for any

(cid:26) 1 ≤ t ≤ nT
n ∈ N∗

, (1.2)

where T ∈ N∗ is a ﬁxed and known integer number, and (ξt) a white noise. Note
that given the functions a1, . . . , aT , one may even build a periodic sequence
(at)t∈Z through the relation at+T = at.
The choice of such extension of the tvAR(1) processes is relative to modelling
considerations: for instance, in the climatic framework, [4] considered models
of air temperatures where the function of interest writes as the product of a
periodic sequence by a locally varying function. This choice provide an interest-
ing extension of more classical periodic models of air temperature such as those
proposed in [14].
Other periodic representation for locally stationary processes can also be found
in for instance in the paper [19], but the seasonal component is treated as an
additive deterministic trend and is not included in the dynamic of the process,
which is the case for model (1.2).

1

We then study non-parametric estimators (cid:98)as(u), for s = 1, 2, . . . , T , u ∈ (0, 1)
from an observed trajectory (X (n)
, . . . , X (n)
nT ). We consider kernel-based estima-
tors which are naturally induced from covariance relationships satisﬁed by the
process (see Section 2). Central limit theorems are established for these estima-
tors under some regularity conditions on the functions as(·) for s = 1, 2, . . . , T .
The results are only obtained by assuming second-order moments on the white
noise (ξt). This is a main improvement with respect to usual limit theorems on
locally-stationary processes which are obtained with the assumption that any
moment exists for (ξt). This is due to the new ideas developed in our proof
which combines a central limit theorem for martingale increment arrays as well
as an embedding in an Orlicz space (see details in Section 4).
The obtained convergence rate is optimal with respect to the minimax rate up
to a logarithmic term. Simulations based on Monte-Carlo experiments illustrate
the accuracy of the estimators. An application to real-life data, i.e. monthly
average temperature readings in London from 1659 to 1998, shows the interest
of using our new model (1.2).

This paper is also a ﬁrst step concerning new results for new class of non-
stationary processes. Indeed, we can extend the deﬁnition (1.2) to processes
(X (n)
t

) such as:

X (n)
t

= Ft

(cid:18) t
n

, ξt, Zt; X (n)

t−1, X (n)

t−2, . . .

(cid:19)

,

1 ≤ t ≤ n,

(1.3)

where (Zt) is a sequence of i.i.d. random vectors modelling for instance exoge-

imsart-ejs ver. 2014/10/16 file: nonstationarity28062018.tex date: November 24, 2021

Bardet and Doukhan/Local periodic time varying AR(1)–processes

3

nous inputs. This more tough case is deferred to forthcoming papers.
Other time-varying models with an inﬁnite memory may also be processed as
GARCH-type models (see for instance [9]). Remark also that [10] introduced
INGARCH-models. Those models are GLM models; non-stationary versions of
which also may be considered. They will be considered in further works.

The structure of the paper is as follows. In Section 2, we deﬁne and study
asymptotic properties of non-parametric estimators for the process (1.2). Sec-
tion 3 provides the results of some Monte-Carlo experiments and real-life data
application, while the proofs are reported in Section 4.

2. Asymptotic normality of a non-parametric estimator for periodic

tvAR(1) processes

2.1. Deﬁnition and ﬁrst properties of the process

Denote classically N = {0, 1, . . .} and N∗ = {1, 2, . . .}. Here we consider T ∈ N∗
a ﬁxed and known period. We will write s ≡ t[T ] if t − s is a multiple of T .
The paper is dedicated to the simplest case X = (X (n)
)1≤t≤nT, n∈N, of a T −periodic
locally stationary AR(1)−process, deﬁned in (1.2) where X (n)
0 = X0 with E(X 2
0 ) <
∞. Here (ξt)t∈N is a sequence of i.i.d. r.v.s satisfying E(ξt) = 0 and Var (ξt) = σ2
for any t ∈ N∗, with (ξt)t independent of X (n)
The functions (as(·))1≤s≤T , [0, 1] → R are supposed to satisfy some regularity.
Hence, we provide the forthcoming deﬁnition usually made in a non-parametric
framework:

0

.

t

Deﬁnition 2.1. For ρ > 0, we denote (cid:100)ρ(cid:101) ∈ N the largest integer such that
(cid:100)ρ(cid:101) < ρ. A function f : x ∈ R (cid:55)→ f (x) ∈ R is said to belong to the class
Cρ(Vu) where Vu is a neighbourhood of u ∈ R, if f ∈ C(cid:100)ρ(cid:101)(Vu) and if f ((cid:100)ρ(cid:101)) is a
(ρ − (cid:100)ρ(cid:101))-H¨olderian function, i.e. there exists Cf ≥ 0 such as

(cid:12)f ((cid:100)ρ(cid:101))(u1) − f ((cid:100)ρ(cid:101))(u2)(cid:12)
(cid:12)

(cid:12) ≤ Cf |u1 − u2|ρ−(cid:100)ρ(cid:101),

for any u1, u2 ∈ Vu.

In case ρ is an integer we simply assume that f (ρ) exists and is a continuous
and bounded function on the neighbourhood of u. As a consequence we specify
the assumptions on functions (at) using a ﬁxed positive real number ρ > 0:

Assumption (A(ρ)): The functions {at(·); t ∈ N} are such as:

1. (Periodicity) There exists T ∈ N∗ such that at(v) = at+T (v) for any

(t, v) ∈ Z × [0, 1].

2. (Contractivity) There exists α = sup{t∈Z, v∈[0,1]} |at(v)| < 1.
3. (Regularity) For any t ∈ Z, assume that at ∈ Cρ.

Remark 2.1. Quote that T = 1 corresponds to a non-periodic case and (X (n)
is then a usual tvAR(1) process deﬁned in (1.1).

t

)

imsart-ejs ver. 2014/10/16 file: nonstationarity28062018.tex date: November 24, 2021

Bardet and Doukhan/Local periodic time varying AR(1)–processes

4

First it is clear that the conditions on functions (as) ensure the existence of a
causal linear process (X (n)
)1≤t≤nT for any n ∈ N satisfying (1.2). More precisely,
t
we obtain the following moment relationships:

Proposition 2.1. Let X = (X (n)
t
(A(ρ)) with ρ ≥ 1. Then for some convenient constant c > 0,
(cid:12)E(X0)(cid:12)
(cid:12).

(cid:12) ≤ αt (cid:12)
(cid:1)(cid:12)
1. For any n ∈ N∗ and 1 ≤ t ≤ nT , (cid:12)
2. Let s ∈ {1, . . . , T }. There exists functions γ(2)

(cid:12)E(cid:0)X (n)

t

)1≤t≤nT, n∈N∗ satisfy (1.2) under Assumption

s ∈ Cρ([0, 1]) such as if

t ∈ {[c log n], . . . , nT } and t ≡ s [T ]:

E(cid:0)(X (n)

t

)2(cid:1) = γ(2)
s (

t
nT

with

(cid:1),

) + O(cid:0) 1
n



s (v) = σ2 1 + (cid:80)T −2
γ(2)
βs,i(v) = (cid:81)i

j=0 a2

1 − βs,T −1(v)

i=0 βs,i(v)

s−j(v) ≤ α2i < 1.



,

(2.1)

3. Assume E(ξ4

0) = µ4 < ∞ and E(ξ3

0) = 0 (this holds e.g. if ξ0 admits a

symmetric distribution).
For s ∈ {1, . . . , T }, there exist functions γ(4)
t ∈ {[c log n], . . . , nT } with t ≡ s [T ],

s ∈ Cρ([0, 1]) such as, for

t
nT

) + O(cid:0) 1
n

(cid:1),

E(cid:0)(X (n)

t

with

)4(cid:1) = γ(4)
s (



s (v) = (cid:0)µ4 + 6σ2γ(2)
γ(4)
δs,i(v) = (cid:81)i

j=0 a4



s−j(v) ≤ α4i < 1.

s (v) − 6σ4(cid:1) 1 + (cid:80)T −2

i=0 δs,i(v)

,

1 − δs,T −1(v)

(2.2)

Moreover, for any (t, t(cid:48)) ∈ {[c log n], . . . , nT }2 with t > t(cid:48),

Cov (cid:0)(X (n)

t

)2, (X (n)

t(cid:48) )2(cid:1) =

(cid:16)

γ(4)
s(cid:48)

(cid:0) t(cid:48)
nT

(cid:1) + O(cid:0) 1
n

(cid:1)(cid:17) t−t(cid:48)
(cid:89)

i=1

a2
t(cid:48)+i(

t(cid:48) + i
n

).

(2.3)

We will now assume X0 = 0.
In addition of the previous proposition, another relation can be easily estab-
lished. Indeed, for t ∈ {1, 2, . . . , nT }, with s = t [T ], by multiplying (1.2) by
X (n)

t−1 and taking the expectation:

(cid:17)

at

(cid:16) t
nT

= as

(cid:16) t
nT

(cid:17)

=

E(cid:0)XtXt−1
E(cid:0)X 2

(cid:1)
(cid:1) .

t−1

(2.4)

The relation (2.4) is at the origin of the deﬁnition of the following non-parametric
estimators of the functions as(·).

imsart-ejs ver. 2014/10/16 file: nonstationarity28062018.tex date: November 24, 2021

Bardet and Doukhan/Local periodic time varying AR(1)–processes

5

2.2. Asymptotic normality of the estimator

Assume that the sample (X1, . . . , XnT ) is observed for some n ≥ 1; this con-
dition entails a reasonable loss of at most T data and allows us for a more
comprehensive study.
For each s ∈ {1, . . . , T }, we deﬁne In,s = (cid:8)s, s + T, . . . , s + (n − 1)T (cid:9), a set with
#In,s = n. Now (2.4) writes:

as

(cid:16) t
nT

(cid:17)

=

E(cid:0)XtXt−1
E(cid:0)X 2

(cid:1)
(cid:1) ,

∀t ∈ In,s.

t−1
A convolution kernel K : R → R will be required in the sequel and it satisﬁes
one of both the following assumptions:

Assumption (K): Let K : R → R be a Borel bounded function such that:

•

(cid:90)

R

K(t)dt = 1 and K(−x) = K(x) for any x ∈ R;

• there exists β > 0 such as lim|t|→+∞ eβ |t|K(t) = 0.

Assumption ( (cid:101)K): Let K : R → R be a Borel bounded function such that:

•

(cid:90)

R

K(t)dt = 1 and K(−x) = K(x) for any x ∈ R;

• there exists some B > 0 such as K(t) = 0, if |t| > B.

Typical examples of kernel functions are K(t) = (2π)−1/2e−t2/2 and K(t) =
1
2 I1[−1,1](t) satisfying respectively Assumptions (K) and ( (cid:101)K). Note also the
K ≥ 0 would exclude dealing with a regularity ρ > 2.

For r ≥ 1, we also specify another condition satisﬁed by such a function:

Assumption ker(r): Let K : R → R be a Borel bounded function such that:

R(|x|r +1) |K(x)| dx < ∞ and (cid:82)

• (cid:82)
• (cid:107)K(cid:107)∞ = supx∈R |K(x)| < ∞ and Lip (K) = supx(cid:54)=y

R xpK(x) dx = 0, if p ∈ {1, 2, . . . , (cid:100)r(cid:101)−1};

|K(x)−K(y)|
|x−y|

< ∞.

Assume that a sequence of positive bandwidths (bn)n∈N is chosen in such a way
that

lim
n→∞

bn = 0,

lim
n→∞

nbn = ∞.

Now, keeping in mind the expression (2.4) and following the same ideas as with
Nararaya-Watson estimator (see [18] and [22]), for s ∈ {1, . . . , T } and u ∈ (0, 1),
we set

(cid:98)a(n)

s

(u) =

s

(cid:98)N (n)
(cid:98)D(n)

s

(u)

(u)

, with






(cid:98)N (n)
s
(cid:98)D(n)
s

(u) = 1
nbn
(u) = 1
nbn

(cid:80)

j∈In,s

(cid:80)

j∈In,s

K

K

(cid:16) j

(cid:16) j

nT −u
bn
nT −u
bn

(cid:17)

(cid:17)

XjXj−1,

X 2

j−1.

(2.5)

imsart-ejs ver. 2014/10/16 file: nonstationarity28062018.tex date: November 24, 2021

Bardet and Doukhan/Local periodic time varying AR(1)–processes

6

Since extremities are omitted we avoid the corresponding edge eﬀects due to the
fact that at the extremities, summations are not considered over a symmetric
interval of times containing nu. The case u = 0 does not make any contribution
while the case u = 1 corresponds with simple periodic behaviours and such re-
sults should be found in [14].

Using essentially a martingale central limit theorem (the steps of the proofs
are precisely detailed in Section 4), we obtain:

Theorem 2.1. Let 0 < ρ ≤ 2 and Assumption (A(ρ)), let K satisfy Assumption
(K) or ( (cid:101)K) as well as Assumption ker(ρ ∨ 1). Then, for a sequence (bn)n∈N of
positive real numbers such as limn→∞ bn n

1+2(ρ∧1) = 0,

1

(cid:112)

nbn

(cid:98)as(u) − as(u)(cid:1)
(cid:0)

L−→
n→+∞

(cid:16)

0 ,

N

σ2
γ(2)
s (u)

(cid:90)

R

K 2(x) dx

(cid:17)

,

(2.6)

for any u ∈ (0, 1), s ∈ {1, . . . , T }, with γ(2)

s (u) = σ2 1 + (cid:80)T −2

i=0 βs,i(u)

.

1 − βs,T −1(u)

Note that for ρ ≤ 1 the classical optimal semi-parametric minimax rate is
reached.
This is not the case if ρ ∈ (1, 2]. In that case, another moment condition is
needed in order to improve the convergence rate of (cid:98)as(u).
Theorem 2.2. Let 1 ≤ ρ ≤ 2 and Assumption (A(ρ)), let K satisfy Assumption
(K) or ( (cid:101)K) as well as Assumption ker(ρ). Moreover, suppose that E|ξ0|β < ∞
with β = 4 −
(Note that β = 2 if ρ = 2) and that ξ0 admits a

2,

∈

(cid:104)

(cid:105)

2ρ
5ρ − 4

10
3

symmetric distribution. Then (2.6) holds for a sequence (bn)n∈N of positive real
numbers such as bn n
Moreover in case ρ = 2 and if bn = c n− 1
the limit distribution is now non-centred:

5 then the central limit still holds but

2ρ+1 −→

n→+∞

0.

1

(cid:16)

N

µ(u) ,

σ2
γ(2)
s (u)

(cid:90)

R

K 2(x) dx

(cid:17)

with µ(u) =

2

c 5
γ(2)
s (u)

(cid:16) 1
2

s (u)γ(2)
a(cid:48)(cid:48)

s (u) + a(cid:48)

s(u)(γ(2)

s )(cid:48)(u)

(cid:17) (cid:90)

R

z2K(z) dz.

Remark 2.2. Optimal window widths write as bn ∼ cn− 1
2ρ+1 thus the above re-
sult holds with a suboptimal window width. Moreover the symmetry assumption
is discussed in Remark 4.2. Now for the case ρ = 2 in case the derivatives of as
are regular around the point u, then the optimal window width actually may be
used and the central limit theorem again holds with a non-centred Gaussian limit.
Quote that the proposed normalisation yields the standard minimax rates n− ρ
2ρ+1 ,
in the case of compactly supported symmetric kernel (a (log n)−loss is observed
for the Gaussian kernel); the obtained rates are in probability and further work

imsart-ejs ver. 2014/10/16 file: nonstationarity28062018.tex date: November 24, 2021

Bardet and Doukhan/Local periodic time varying AR(1)–processes

7

is needed to prove that this is the minimax L2−rate.
Moreover for large T the convergence rate is degraded with a factor T
the sample size is N = nT and thus n = N/T .

ρ

2ρ+1 since

Remark 2.3. Of course, if T = 1, Theorems 2.1 and 2.2 hold, which provide
another minimax estimation of the function u (cid:55)→ a1(u) (u ∈ [0, 1]) requiring
sharper moment and regularity conditions than the ones proposed in Theorem
4.1 of [8].

Remark 2.4. If T is unknown we better consider an N -sample and set n =
[N/T ], the proof of previous central limit theorem 2.1 provides an approach for
estimating this period T . First ﬁx Tmax ≥ 2 (typically Tmax = 12 for monthly
data). Then, for each 1 ≤ τ ≤ Tmax, we deﬁne an estimator (cid:98)a(τ )
s (u) for any
1 ≤ s ≤ τ and u ∈ (0, 1). It is clear that when τ is not a multiple of T , then
the sums in (2.5) that are done on the set In,s, which depends on τ , is now a
sum involving other ak with k (cid:54)= s. As a consequence, (cid:98)as(u) is not a convergent
estimator of as(u).
Then, using a classical cross-validation, for each 1 ≤ τ ≤ Tmax, we compute

(cid:100)CV (τ ) =

N
(cid:88)

j=2

(cid:16)
j − (cid:98)a(τ )
X (n)

j

(cid:0) j
N

(cid:1)X (n)

j−1

(cid:17)2

.

Finally, deﬁne (cid:98)T as the smallest value such as

(cid:98)T = Arg min

(cid:100)CV (τ ).

1≤τ ≤Tmax
Remark 2.5. The central limit theorem 2.1 naturally provides a test statistics
(cid:98)As for solving the test problem: H0 : as(u) = ca versus H0 : as(u) (cid:54)= ca, where
ca ∈ (0, 1). Indeed, from (2.6) and Slutsky Lemma we deduce:

(cid:115)

nbn

(cid:90)

R

(cid:118)
(cid:117)
(cid:117)
(cid:116)

K 2(x) dx

Then if we consider

(cid:81)i

1 + (cid:80)T −2
i=0
1 − (cid:81)T −1

j=0 (cid:98)a2

s−j(u)

j=0 (cid:98)a2

s−j(u)

(cid:17)
(cid:16)
(cid:98)as(u) − as(u)

L−→
n→+∞

N (cid:0)0 , 1(cid:1).

(cid:115)

(cid:98)As =

nbn

(cid:90)

R

(cid:118)
(cid:117)
(cid:117)
(cid:116)

K 2(x) dx

(cid:81)i

1 + (cid:80)T −2
i=0
1 − (cid:81)T −1

j=0 (cid:98)a2

s−j(u)

j=0 (cid:98)a2

s−j(u)

(cid:16)
(cid:98)as(u) − ca

(cid:17)
,

this provides a natural statistics test with usual standard Gaussian quantile as
asymptotic threshold.

3. Monte-Carlo experiments and an application to climatic data

3.1. Monte-Carlo experiments

In this section, numerous Monte-Carlo experiments have been made for studying
the accuracy of the new non-parametric estimator (cid:98)as(·).

imsart-ejs ver. 2014/10/16 file: nonstationarity28062018.tex date: November 24, 2021

Bardet and Doukhan/Local periodic time varying AR(1)–processes

8

Fig 1. Graph of the function a(2)

1

and an example of its estimation (for n = 1000).

Firstly, we considered 3 typical functions [0, 1] → [−1, 1], a(ρ)
and such as supu∈[0,1],s∈N |a(ρ)

s (u) ∈ Cρ([0, 1])

s (u)| ≤ α < 1:
s (u) = 0.9 cos (cid:0)2π

(cid:1) cos(3u). Figure 1 exhibits

ns
T

and an example of its estimation (for n =

• For ρ = 2, we choose a(2)

the graph of the function a(2)
1
1000);

s

(cid:1)

ns
T

where

(u) = 0.9 cos (cid:0)2π

• For ρ = 1.5, we choose a(1.5)

• For ρ = 0.8, we choose a(0.8)

(cid:82) u
0 Wt(ω) dt
supx∈[0,1] |Wx(ω)|
(Wt)t∈[0,1] is an observed trajectory of a Wiener Brownian motion;
B0.8(ω, u)
supx∈[0,1] |B0.8(ω, x)|
where BH (ω, t))t∈[0,1] is an observed trajectory of a fractional Brownian
motion with Hurst exponent H = 0.8 (Figure 2 exhibits the graph of this
chosen function a(0.8)
). It is well known that a trajectory of a fractional
Brownian motion with Hurst exponent H ∈ (0, 1) is almost surely α-
H¨oderian for any α < H;
• For ρ = 0.5, we choose a(0.5)

(u) = 0.9 cos (cid:0)2π

(u) = 0.9 cos (cid:0)2π

where

ns
T

(cid:1)

(cid:1)

1

s

ns
T

Wu(ω)
supx∈[0,1] |Wx(ω)|

s

(Wt(ω))t∈[0,1] is an observed trajectory of a Wiener Brownian motion.

We also consider two “typical” kernels:

• A bounded supported kernel, the well-known Epanechnikov kernel deﬁned
4 (1−x2) I1{|x|≤1}, which is known to minimize the asymptotic

by KE(x) = 3
MISE in the kernel density estimation frame;

• The unbounded supported Gaussian kernel with KG(x) = 1√
2π

exp (cid:0)− x2

2

(cid:1).

We considered the cases n = 100, 200, 500 and 1000, and we ﬁxed T = 2. Finally

imsart-ejs ver. 2014/10/16 file: nonstationarity28062018.tex date: November 24, 2021

0.00.20.40.60.81.0−0.50.00.5uaBardet and Doukhan/Local periodic time varying AR(1)–processes

9

Fig 2. Graph of the chosen function a(0.8)

1

.

1000 independent replications of (X (n)) are generated with two diﬀerent cases
of innovations (ξt):

• Firstly, the case where the probability distribution of ξ0 is a Gaussian
N (0, 4) distribution, then E|ξ0|4 < ∞ and therefore Theorem 2.1 holds
for ρ = 0.5 and Theorem 2.2 holds for ρ = 1.5 and ρ = 2.

• Secondly, the case where the probability distribution of ξ0 is a Student
t(3) (with 3 degrees of freedom) distribution implying E|ξ0|β < ∞ for any
β < 3 but E|ξ0|3 = ∞. Then if ρ = 0.5, Theorem 2.1 holds but if ρ = 1.5
and ρ = 2, Theorem 2.2 does not hold.

Finally, for each n, each functions a(ρ)
and kernel K, and each probability
s
distributions of ξ0, we present the results computed from 1000 replications and
the following methodology:

1. For each replication j, we deﬁned bn = n−λ with λ = 0.10, 0.11, . . . , 0.80,
(ui)1≤i≤99 = 0.01, 0.02, . . . , 0.99, s = 1, 2, . . . , T , and the estimators (cid:98)as(ui)
are computed.

2. For each replication j and each λ = 0.10, 0.11, . . . , 0.80, an estimator of

the M ISE is computed:

(cid:92)M ISEs(λ) =

1
99

99
(cid:88)

i=1

(cid:98)as(ui) − as(ui)(cid:1)2
(cid:0)

.

3. For each replication j, we minimised an estimator of the global square

root of MISE:

(cid:98)λj = Argmin

0.1≤λ≤0.8

T
(cid:88)

(cid:113)

s=1

(cid:92)M ISEs(λ)

4. Then we computed λ = 1

1000

(cid:80)1000

j=1 (cid:98)λj over all the replications.

imsart-ejs ver. 2014/10/16 file: nonstationarity28062018.tex date: November 24, 2021

0.00.20.40.60.81.0−1.0−0.50.00.51.0ta08Bardet and Doukhan/Local periodic time varying AR(1)–processes

10

Fig 3. Histograms of (cid:98)a(2)

s (u) for u = 0.25, 0.5 and 0.75 from 10000 independent replications

5. Finally, we computed the estimator of the minimal global square root of

MISE,

M ISE

1/2

=

1
1000

1000
(cid:88)

T
(cid:88)

j=1

s=1

(cid:113)

(cid:92)M ISEs((cid:98)λj).

1/2

As a consequence, λ and M ISE
are two interesting estimators relative to
Theorems 2.1 and 2.2. The ﬁrst one speciﬁes the link between the choice of an
optimal bandwidth bn qnd the regularity ρ of the functions as(·). The second
one measures the optimal convergence rate of the estimators (cid:98)as(·) to as(·). All
the results are printed in Tables 1 and 2.
Moreover, for exhibiting the asymptotic normality of the estimators provided in
the central limit theorem (2.6), we draw in Figure the histograms of (cid:98)a(2)
s (u) for
u = 0.25, 0.5 and 0.75 from 10000 independent replications for n = 5000. We
also used a Jarque-Bera test to conﬁrm the Gaussian asymptotic distribution
since the p-values of this test are successively: p − value = 0.105, 0.927 and
0.345. Hence, the asymptotic normality of the estimator seems to be attested
by Monte-Carlo experiments.

Conclusions of the simulations: Firstly, and as it should be deduced from
Theorem 2.1 and 2.2, we observed the larger the regularity ρ, the smaller λ
and therefore the larger the optimal bandwidth bn = n−λ, and the faster the
convergence rate of (cid:98)as. Secondly, even if the choice of the optimal bandwidth
is signiﬁcantly diﬀerent following the choice of the kernel (clearly smaller with
the Epanechnikov kernel), the optimal convergence rate is almost the same for
both the kernel. Finally, according also with Theorem 2.2, the convergence rate
is clearly slower with a heavy tail distribution (t(3)) than with a Gaussian
distribution, and this phenomenon increases when ρ increases.

imsart-ejs ver. 2014/10/16 file: nonstationarity28062018.tex date: November 24, 2021

Histogram of a025a025Frequency−0.75−0.70−0.65−0.600200400600800Histogram of a050a050Frequency−0.15−0.10−0.050.000.050200400600800100012001400Histogram of a075a075Frequency0.500.550.600.650200400600800Bardet and Doukhan/Local periodic time varying AR(1)–processes

11

Table 1
Results of the Monte Carlo experiments providing the accuracy of (cid:98)as for the three chosen
functions the three chosen functions with ξ0 following a N (0, 4) distribution, 1000
independent replications are generated.

a(ρ)
Kernel

n = 100

λ

M ISE

1/2

n = 200

λ

M ISE

1/2

n = 500

λ

M ISE

1/2

n = 1000

λ

M ISE

1/2

a(2)
s

a(1.5)
s

a(0.8)
s

a(0.5)
s

KE
0.243

0.248
0.227

0.185
0.234

0.129
0.240

0.098

KG
0.407

0.239
0.363

0.175
0.320

0.119
0.321

0.093

KE
0.283

0.286
0.278

0.219
0.276

0.154
0.270

0.124

KG
0.450

0.282
0.429

0.219
0.399

0.156
0.384

0.122

KE
0.172

0.230
0.256

0.232
0.321

0.213
0.373

0.207

KG
0.322

0.234
0.392

0.232
0.431

0.210
0.476

0.202

KE
0.235

0.354
0.250

0.308
0.287

0.256
0.328

0.226

KG
0.392

0.353
0.386

0.303
0.406

0.254
0.438

0.221

Table 2
Results of the Monte Carlo experiments providing the accuracy of (cid:98)as for the three chosen
functions with ξ0 following a t(3) distribution, 1000 independent replications are generated.

a(ρ)
Kernel

n = 100

λ

M ISE

1/2

n = 200

λ

M ISE

1/2

n = 500

λ

M ISE

1/2

n = 1000

λ

M ISE

1/2

a(2)
s

a(1.5)
s

a(0.8)
s

a(0.5)
s

KE
0.226

0.341
0.207

0.261
0.194

0.214
0.193

0.166

KG
0.394

0.320
0.343

0.258
0.304

0.201
0.321

0.093

KE
0.267

0.350
0.259

0.281
0.252

0.213
0.246

0.172

KG
0.430

0.340
0.402

0.287
0.373

0.217
0.342

0.181

KE
0.161

0.311
0.231

0.296
0.286

0.269
0.346

0.258

KG
0.295

0.309
0.355

0.293
0.383

0.261
0.450

0.250

KE
0.220

0.418
0.225

0.353
0.239

0.302
0.258

0.262

KG
0.360

0.405
0.362

0.346
0.360

0.296
0.368

0.275

imsart-ejs ver. 2014/10/16 file: nonstationarity28062018.tex date: November 24, 2021

Bardet and Doukhan/Local periodic time varying AR(1)–processes

12

Fig 4. Monthly average temperature readings in London from 1659 to 1998: correlogram of
residual data

Fig 5. Monthly average temperature readings in London from 1659 to 1998: (cid:98)as(u) estimator
for u = 0.25 (black), u = 0.50 (red) and u = 0.75 (blue) in terms of s = 1, . . . , 12

3.2. Numerical application on climatic data

We also applied our model and its estimator to an example of real data, specif-
ically the monthly average temperature readings in London from 1659 to 1998,
or 340 years. Obviously in such a case one can expect that T = 12.
First, we removed an additive seasonal and trend component (estimated by
LOESS) from these data and considered the residual data. On these, a global
correlogram (see Figure 4) conﬁrms a modelling by a process of type AR(1) and
also the presence of a periodic phenomenon of period 12. As a consequence we
may assume that these residual data can be modelled by the model (1.2). We
then applied the (cid:98)as(u) estimator for u = 0.25, 0.50 and 0.75 and s = 1, . . . , 12.
Figure 5 summarizes these results and shows:

• The crucial interest of taking a pseudo-periodic model as we deﬁned it in

(1.2);

• The relatively small but not negligible change in the coeﬃcient at(t) as a

function of t.

imsart-ejs ver. 2014/10/16 file: nonstationarity28062018.tex date: November 24, 2021

05101520253035−0.20.00.20.40.60.81.0LagACFSeries  Xsas(0.25),as(0.50),as(0.75)246810120.00.10.20.30.4Bardet and Doukhan/Local periodic time varying AR(1)–processes

13

4. Proofs

We ﬁrst provide the proof of Proposition 2.1.

Proof of Proposition 2.1.

1. We have EX (n)

1 = a1

(cid:17)

(cid:16) 1
nT

E(X0) and EX (n)

t = at

relation (1.2). From Assumption (A(ρ)) and since
deduce the ﬁrst item of Proposition 2.1.

(cid:17)

(cid:16) t
nT
(cid:12)
(cid:12)
(cid:12)a1

EX (n)
t−1) from the
(cid:17)(cid:12)
(cid:12)
(cid:12) ≤ α < 1, we

(cid:16) 1
nT

2. Below, for ease of reading, we will omit the exponent n. Set vt = E(cid:0)X 2

(cid:1),

t

and v = sups vs ∈ [0, +∞]; also write αt = a2
t

(cid:0) t
nT

(cid:1). We have:

vt = αt vt−1 + σ2 ≤ α2vt−1 + σ2 ≤ α2 sup
s

vs + σ2,

t > 0

(4.1)

thus

vs ≤

sup
s

σ2 + v0
1 − α

< ∞.

Moreover, with δt = vt − vt−T for any t > T , we have

δt = αtδt−1 + (αt − αt−T )vt−T −1,
(cid:12) ≤ α(cid:12)
(cid:12)

(cid:12)
(cid:12) + C|αt − αt−T |, with C > 0,

(cid:12)δt−1

(cid:12)
(cid:12)δt

from (4.2) and since for some constant C > 0,

(cid:12)
(cid:12)αt − αt−T

(cid:12)
(cid:12) =

(cid:12)
(cid:12)a2
(cid:12)

t

(cid:0) t
nT

(cid:1) − a2

t−T

(cid:1)(cid:12)
(cid:0) t − T
(cid:12)
(cid:12)
nT
(cid:0) t − T
nT

(cid:1)(cid:12)
(cid:12)
(cid:12)

(cid:1) − at−T

(cid:0) t
nT

≤ 2α |at

≤

C
nρ∧1

(4.2)

(4.3)

(4.4)

from Assumption (A(ρ)). As a consequence of (4.3), we also obtain:

(cid:12)
(cid:12)δt

(cid:12)
(cid:12) ≤

C
1 − α

·

1
nρ∧1 + δT +1αt−T +1.

Thus for other constants C, c > 0 we derive

(cid:12)
(cid:12)δt

(cid:12) ≤ C (cid:48) 1
(cid:12)

nρ∧1 ,

∀t ≥ c log n.

(4.5)

From now on, assume that ρ ≥ 1.
Now use again the deﬁnition (1.2) of the model, and by iterating (4.1), we

imsart-ejs ver. 2014/10/16 file: nonstationarity28062018.tex date: November 24, 2021

Bardet and Doukhan/Local periodic time varying AR(1)–processes

14

derive:

vt = σ2 + αt
= · · ·
= σ2(cid:16)

1 +

= σ2(cid:16)

1 +

(cid:0)σ2 + αt−1vt−2

(cid:1)

(cid:17)

(cid:17)

αt · · · αt−i

αt · · · αt−i

T −2
(cid:88)

i=0

T −2
(cid:88)

i=0

+ αt · · · αt−T +1 vt−T

+ αt · · · αt−T +1 vt + O(cid:0) 1
n

(cid:1)

from (4.5).
Hence,

vt = σ2 1 + (cid:80)T −2

i=0 αt · · · αt−i

1 − αt · · · αt−T +1

+ O(cid:0) 1
n

(cid:1).

(4.6)

Now quoting that αt−j = a2
j < T , then since ρ ≥ 1 and from (4.6) we derive

t−j

(cid:1) we set (cid:101)αt−j = a2

(cid:0) t − j
nT

t−j

(cid:0) t
nT

(cid:1) for 1 ≤

vt = σ2 1 + (cid:80)T −2

i=0 (cid:101)αt · · · (cid:101)αt−i

1 − (cid:101)αt · · · (cid:101)αt−T +1

+ O(cid:0) 1
n

(cid:1) = γ(2)
s (

t
nT

) + O(cid:0) 1
n

(cid:1).

(4.7)

The conclusion follows.

3. The proof mimics the case of E(X 2
for k = 1, 2, 3, 4. Then µ1 = 0 and

t ). Denote qt = a4
t

(cid:0) t
nT

(cid:1), and µk = E(ξk
0 ),

wt = E(X 4

t ) = E(AtXt−1+ξt)4 = qt wt−1+4 µ3 At EXt−1+6 σ2 A2

t vt−1+µ4.

Since µ3 = 0, we have:

wt = qtwt−1 + 6σ2vt + µ4 − 6σ4 ≤ α4 wt−1 + r(t),

(4.8)

with r(t) = 6 σ2 vt + µ4 − 6σ4 and this implies as previously supt wt < ∞.
We also obtain for constants again denoted C (cid:48), C (cid:48)(cid:48) > 0:

(cid:12)
(cid:12)wt − wt−T

(cid:12)
(cid:12) ≤

C (cid:48)
n

,

∀t ≥ c log n.

(4.9)

Finally by iterating (4.8), we obtain:

wt = qt · · · qt−T +1 wt−T +

(cid:16)

r(t) +

T −2
(cid:88)

i=0

(cid:0)qt · · · qt−i

(cid:1)r(t − i − 1)

(cid:17)

= qt · · · qt−T +1 wt + O(cid:0) 1
n

(cid:16)

(cid:1) +

r(t) +

T −2
(cid:88)

i=0

(cid:0)qt · · · qt−i

(cid:17)
(cid:1)r(t − i − 1)

imsart-ejs ver. 2014/10/16 file: nonstationarity28062018.tex date: November 24, 2021

Bardet and Doukhan/Local periodic time varying AR(1)–processes

15

from (4.9). Hence, always following the previous case

wt =

=

(cid:0)qt · · · qt−i
r(t) + (cid:80)T −2
i=0
1 − qt · · · qt−T +1
(cid:0)qt · · · qt−i
r(t) + (cid:80)T −2
i=0
1 − qt · · · qt−T +1

(cid:1)r(t − i − 1)

(cid:1)r(t − i − 1)

+ O(cid:0) 1
n
+ O(cid:0) 1
n

(cid:1)

(cid:1),

for t ≥ C (cid:48)(cid:48) log n, and this implies (2.2) from using again the regularity of
the functions (ai)1≤i≤T .
Finally, for any t > t(cid:48) such that t, t(cid:48) ∈ {[c log n], . . . , nT }, since (Xt) is a
causal process and by iteration,

Cov (X 2

t , X 2

t(cid:48)) = αt Cov (X 2
= αt Cov (X 2

t , X 2
t(cid:48))

t−1, X 2
t(cid:48)) + 0 + Cov (ξ2
t−1, X 2
t(cid:48))
(cid:1) + O(cid:0) 1
n

αt(cid:48)+i,

t−t(cid:48)
(cid:89)

(cid:1)(cid:1)

i=1

= (cid:0)γ(4)
s(cid:48)

(cid:0) t(cid:48)
nT

where s(cid:48) ≡ t(cid:48) [T ] and

(cid:12)
(cid:12)
(cid:12)

t−t(cid:48)
(cid:89)

i=1

αt(cid:48)+i

(cid:12)
(cid:12) ≤ α2|t−t(cid:48)|.
(cid:12)

This completes the proof.

Now we establish a technical lemma, which we were not able to ﬁnd in the
past literature (even if variants of this result may be found) and that will be
extremely useful in the sequel. For a bounded continuous function c deﬁned on
[0, 1], and a kernel function H (see details below), an approximation of integral
by appropriate Riemann sums yields (as for [20]’s estimator, see [21] for further
developments):

lim
n→∞

1
nbn

(cid:88)

H

j∈In,s

(cid:33)

(cid:32) j

nT − u
bn

(cid:17)

(cid:16) j
c
nT

= c(u),

where u ∈ (0, 1), In,s = (cid:8)s, s + T, . . . , s + (n − 1)T } with s ∈ {1, . . . , T } and
T ∈ N∗. More precisely we would like to provide expansions of

∆n =

1
nbn

(cid:88)

H

j∈In,s

(cid:33)

(cid:32) j

nT − u
bn

(cid:17)

c

(cid:16) j
nT

− c(u).

(4.10)

Lemma 4.1. Let u ∈ (0, 1), ρ > 0, c ∈ Cρ([0, 1]) a bounded function. Let
H satisfy ker(ρ ∨ 1). Consider also a sequence of positive real numbers (bn)n
satisfying limn→∞ bn = 0. Then, there exists C > 0 depending only on (cid:107)H(cid:107)∞,
(cid:107)c(cid:107)∞ and Lip (H) such that for n large enough

(cid:12)
(cid:12)∆n

(cid:12)
(cid:12) ≤ C

(cid:16) An
nbn

(cid:17)

+ bρ
n

, with

(cid:110) An = 1

under Assumption ( (cid:101)K),
An = log(n) under Assumption (K).

(4.11)

imsart-ejs ver. 2014/10/16 file: nonstationarity28062018.tex date: November 24, 2021

Bardet and Doukhan/Local periodic time varying AR(1)–processes

16

Finally, if ρ ∈ N∗ we have:

∆n = bρ
n ·

c(ρ)(u)
ρ!

(cid:90)

R

zρH(z) dz (cid:0)1 + o(1)(cid:1) + O

Proof of Lemma 4.1. In the sequel we will denote hn(v) = 1
bn
v ∈ R. Then hn is a Lipschitz function with Lip hn = 1
Lip H.
b2
n

.

(cid:17)

(cid:16) An
nbn
H(cid:0)b−1

(4.12)

n (v − u)(cid:1) for

• First assume that the function c ≡ 1 is a constant. Set vi = i(nT )−1 for

i ∈ Z. For 1 ≤ s ≤ T , we consider the sets

Kn,s = (cid:8)j ∈ N, |vs+jT − u| ≤ Anbn, 1 ≤ j ≤ n(cid:9)

= N ∩ [1, n]

(cid:92) (cid:104)

(u − Anbn)n −

s
T

, (u + Anbn)n −

(cid:105)

,

s
T

and Ln,s = In,s \ Kn,s. Then, for n large enough,

∆n =

=

=

+

1
n

1
n

(cid:88)

i∈In,s

(cid:88)

i∈Kn,s

hn(vi) −

hn(vi) −

(cid:90)

R

(cid:90)

R

hn(v) dv

hn(v) dv +

1
n

(cid:88)

i∈Ln,s

hn(vi)

[(u+Anbn)n− s
T ]
(cid:88)

(cid:90) vs+(j+1)T

j=[(u−Anbn)n− s

T ]+1

vs+jT

(cid:0)hn(vs+jT ) − hn(v)(cid:1)dv

1
n

(cid:88)

j∈Ln,s

hn(vs+jT ) −

(cid:90) ∞

(u+Anbn)+ 1
n

hn(v) dv −

(cid:90) (u−Anbn)+1/n

−∞

hn(v) dv.

But |hn(vs+jT )| ≤ C
from Assumption (K) and
bn
using the usual comparison between sums and integrals for monotonic
functions, we obtain:

j/n−u+s/nT
bn

− β

exp

(cid:16)

(cid:12)
(cid:12)
(cid:12)

(cid:17)

(cid:12)
(cid:12)
(cid:12)

(cid:12)
(cid:12)
(cid:12)

1
n

(cid:88)

j∈Ln,s

(cid:12)
(cid:12)
(cid:12) ≤
hn(vs+jT )

C
bn

(cid:90) ∞

|v−u|≥Anbn

(cid:16)

exp

− β

(cid:17)

|v − u|
bn

dv

≤ 2 C exp(−β An).

Thus

(cid:12)
(cid:12)∆n

(cid:12)
(cid:12) ≤ Lip (hn)

[(u+Anbn)n− s
T ]
(cid:88)

(cid:90) vs+(j+1)T

j=[(u−Anbn)n− s

T ]+1

vs+jT

(v − vs+jT )dv

+2 C exp(−β An) +

(cid:90) ∞

u+Anbn

(cid:12)
(cid:12)hn(v)(cid:12)

(cid:12) dv +

(cid:90) u−Anbn

−∞

(cid:12)
(cid:12)hn(v)(cid:12)

(cid:12) dv

≤

Lip (H)
b2
n

≤ Lip (H)

2Anbnn

2n2 + 4 C exp(−β An)

An
nbn

+ 4 C exp(−β An).

imsart-ejs ver. 2014/10/16 file: nonstationarity28062018.tex date: November 24, 2021

Bardet and Doukhan/Local periodic time varying AR(1)–processes

17

because since u ∈ (0, 1), the above indices remain in the index set [−n, n]
for n large enough.
Then, if An ≥ β−1 log n then exp(−β An) ≤ 1/n and we deduce (4.11).
• We now turn to the case of a non-constant function c. First, if ρ > 0, for

(u, v) ∈ (0, 1)2 the Taylor-Lagrange formula implies:

c(v) − c(u) = (v − u)c(cid:48)(u) + · · · +

(v − u)(cid:96)
(cid:96)!

c((cid:96))(cid:0)u + λ(v − u)(cid:1),

with (cid:96) = (cid:100)ρ(cid:101) and λ ∈ (0, 1). Since c ∈ Cρ([0, T ]),

(cid:12)c((cid:96))(cid:0)u + λ(v − u)(cid:1) − c((cid:96))(u)(cid:12)
(cid:12)

(cid:12) ≤ Cρ

(cid:12)λ(v − u)(cid:12)
(cid:12)
(cid:12)

ρ−(cid:96)

≤ Cρ

(cid:12)v − u(cid:12)
(cid:12)
(cid:12)

ρ−(cid:96)

.

Therefore,

c(v) − c(u) = (v − u)c(cid:48)(u) + · · · +

(v − u)(cid:96)
(cid:96)!

c((cid:96))(u) + R(u, v),

(4.13)

with |R(u, v)| ≤ Cρ |u − v|ρ. Then for any u ∈ (0, 1), using Assumption
ker(ρ ∨ 1) and especially the relation (cid:82) zpH(z)dz = 0 for p = 1, . . . , (cid:96),

(cid:12)
(cid:12)
(cid:12)

(cid:90)

R

hn(v) c(v) dv − c(u)

(cid:90)

R

hn(v) dv

(cid:12)
(cid:12)
(cid:12) =

=

(cid:12)
(cid:12)
(cid:12)

(cid:12)
(cid:12)
(cid:12)

(cid:90) ∞

−∞
(cid:90) ∞

−∞

H(z)(cid:0)c(u + bnz) − c(u)(cid:1) dz

(cid:12)
(cid:12)
(cid:12)

H(z)R(u, u + bnz)dz

(cid:12)
(cid:12)
(cid:12) (4.14)

(cid:90) ∞

−∞

≤ Cρ bρ

n C

≤ C (cid:48) bρ
n

e−β|z||z|ρdz

(4.15)

with C (cid:48) > 0. Here we denote kn(v) = hn(v)c(v) for v ∈ [0, 1].
Now, if ρ ∈ (0, 1), we have

|kn(v1) − kn(v2)| ≤ (cid:107)c(cid:107)∞ Lip (hn) |v1 − v2| +

(cid:107)H(cid:107)∞
bn

Cρ |v1 − v2|ρ,

and therefore using the previous results:

(cid:12)
(cid:12)∆n

(cid:12)
(cid:12) ≤

[(u+Anbn)n− s
T ]
(cid:88)

(cid:90) vs+(j+1)T

(cid:16)

C

Lip (hn) |v − vs+jT |

j=[(u−Anbn)n− s

+

1
bn

vs+jT

T ]+1
|v − vs+jT |ρ(cid:17)
(cid:90)

(cid:12)
(cid:12)
(cid:12)

+

R

dv + C (cid:107)c(cid:107)∞ exp(−βAn)

hn(v) c(v) dv − c(u)

(cid:90)

R

hn(v) dv

(cid:12)
(cid:12)
(cid:12)

≤ C

(cid:16) An
nbn

+

An
nρ + exp(−βAn) + bρ

n

(cid:17)

.

imsart-ejs ver. 2014/10/16 file: nonstationarity28062018.tex date: November 24, 2021

Bardet and Doukhan/Local periodic time varying AR(1)–processes

18

from (4.15) and this implies (4.11) since nbn → ∞ and therefore n−ρ is
negligible with respect from bρ
n.
Now, if ρ ≥ 1 and since H and c are bounded continuous Lipschitz func-
tions, we obtain the inequality

Lip (kn) ≤ (cid:107)c(cid:107)∞Lip (hn) +

1
bn

(cid:107)H(cid:107)∞Lip (c) < ∞.

Then, using the same computations than previously (replace hn by hn ×c),

|∆n| ≤

[(u+Anbn)n− s
T ]
(cid:88)

(cid:90) vs+(j+1)T

(cid:12)kn(vs+jT ) − kn(v)(cid:12)
(cid:12)

(cid:12) dv

j=[(u−Anbn)n− s

T ]+1

+ C (cid:107)c(cid:107)∞ exp(−βAn) +

vs+jT
(cid:90)

(cid:12)
(cid:12)
(cid:12)

hn(v) c(v) dv − c(u)

(cid:90)

R

hn(v) dv

(cid:12)
(cid:12)
(cid:12)

R

≤ C

(cid:16)

An
nbn

(cid:107)c(cid:107)∞Lip (H) + bn Lip (c)(cid:107)H(cid:107)∞

(cid:17)

+ C(cid:107)c(cid:107)∞e−βAn + C (cid:48)bρ
n,

from (4.15) and this completes the ﬁrst item since bn is supposed to con-
verge to 0. The proof is now easily completed.

• Finally, in the case ρ ∈ N∗, we can use the previous case an a Taylor-
(cid:12)u − v(cid:12)
(cid:12)
ρ
(cid:12)

Lagrange expansion of the function c, implying R(u, v) =

c(ρ)(θ)
ρ!

with θ = λu + (1 − λ)v and λ ∈ [0, 1].

Then, using (4.14) and with µu(z) ∈ [0, 1], and ζn =

c(u)

(cid:90)

R

hn(v) dv

(cid:90)

R

hn(v) c(v) dv −

ζn =

=

bρ
n
ρ!
bρ
n
ρ!

(cid:90) ∞

−∞

H(z)zρc(ρ)(cid:0)u + µu(z)bnz(cid:1) dz

c(ρ)(u)

(cid:90) ∞

−∞

H(z)zρ dz (cid:0)1 + o(1)(cid:1)

from Lebesgue theorem on dominated convergence.

In the sequel we will denote the σ-algebra

t = σ(cid:0)(ξi)i≤s+(t−1)T
F (s)

(cid:1).

(4.16)

Lemma 4.2. Let H satisfy Assumption ker(1) and (X (n)
) be a solution of
(1.2) under Assumption (A(ρ)) with ρ > 0. Then for any u ∈ (0, 1), and s ∈
{1, . . . , T },

t

1
nbn

n
(cid:88)

j=1

H

(cid:16) s+(j−1)T
nT
bn

− u

(cid:17)(cid:0)X (n)

s+(j−1)T −1

(cid:1)2

P
−→
n→+∞

σ2 1 + (cid:80)T −2

i=0 βs,i(u)

1 − βs,T −1(u)

.

imsart-ejs ver. 2014/10/16 file: nonstationarity28062018.tex date: November 24, 2021

Bardet and Doukhan/Local periodic time varying AR(1)–processes

19

Proof of Lemma 4.2. We use here a limit theorem for L1-mixingales established
in [1]. Indeed, for u ∈ (0, 1), s ∈ {1, . . . , T }, let

Zn,t =

1
bn

H

(cid:16) s+(t−1)T
nT
bn

− u

(cid:17)(cid:16)(cid:0)X (n)

s+(t−1)T −1

(cid:1)2

− E(cid:0)X (n)

s+(t−1)T −1

(cid:1)2(cid:17)

.

(4.17)

Then, set

c0(t) = 1,

and

ck(t) =

k
(cid:89)

i=1

at+1−i

(cid:16) t + 1 − i
nT

(cid:17)

,

for k ≥ 1,

we have:

X (n)

t =

∞
(cid:88)

k=0

ck(t) ξt−k.

(4.18)

Therefore, with (F (s)

n,t ) deﬁned in (4.16),

E(cid:2)Zn,t|F (s)

n,t−m

(cid:3) =

1
bn

H

(cid:16) s+(j−1)T
nT
bn

− u

(cid:17)

(cid:104)(cid:16) ∞
(cid:88)

(cid:110)

E

×

ck(s + (t − 1)T − 1) ξs+(t−1)T −1−k

(cid:17)2

(cid:105)

| F (s)

n,t−m

k=0

∞
(cid:88)

− σ2

c2
k(s + (t − 1)T − 1)

(cid:111)

=

1
bn

H

(cid:16) s+(j−1)T
nT
bn

k=0
(cid:17)(cid:110)(cid:16) ∞
(cid:88)

− u

k=mT −1

ck(s + (t − 1)T − 1) ξs+(t−1)T −1−k

(cid:17)2

∞
(cid:88)

− σ2

k=mT −1

c2
k(s + (t − 1)T − 1)

(cid:111)
.

But for any t ∈ N, we have |ck(t)| ≤ αk from Assumption (A(ρ)). Then,

(cid:13)
E(cid:2)Zn,t | F (s)
(cid:13)
(cid:13)

n,t−m

(cid:3)(cid:13)
(cid:13)
(cid:13)1

≤

1
bn

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

H

(cid:16) s+(j−1)T
nT
bn

− u

(cid:17)

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

(cid:104)(cid:16) ∞
(cid:88)

(cid:110)

E

×

k=mT −1

ck(s + (t − 1)T − 1) ξs+(t−1)T −1−k

(cid:17)2(cid:105)

+ σ2

∞
(cid:88)

α2k(cid:111)

k=mT −1

≤

2 σ2
bn

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

H

(cid:16) s+(j−1)T
nT
bn

− u

(cid:17)

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

×

α2mT −2
1 − α2 .

Thus, using the notations of Deﬁnition 2 in [1], it is easy to derive that (Zn,t)
is a triangular array such that φm = α2mT −2(cid:107)H(cid:107)1 → 0 (as m → ∞) since

imsart-ejs ver. 2014/10/16 file: nonstationarity28062018.tex date: November 24, 2021

Bardet and Doukhan/Local periodic time varying AR(1)–processes

20

0 ≤ α < 1 and:

1
n

n
(cid:88)

t=1

|cnt| −→
n→+∞

2 σ2
(1 − α2)

As a consequence,

(cid:107)H(cid:107)1 < ∞, with cnt =

2 σ2
(1 − α2)bn

H

(cid:16) s+(j−1)T
nT
bn

− u

(cid:17)

.

1
n

n
(cid:88)

t=1

Zn,t

P
−→
n→+∞

0,

implies

1
nbn

n
(cid:88)

j=1

H

(cid:16) s+(j−1)T
nT
bn

− u

(cid:17)(cid:16)(cid:0)X (n)

s+(j−1)T −1

(cid:1)2

− E(cid:0)(cid:0)X (n)

s+(j−1)T −1

(cid:1)2(cid:1)(cid:17)

P
−→
n→+∞

0.

Now, we collect the above relations. Lemma 4.1 and Proposition 2.1 with the
ρ−regularity of the function c(v), together conclude the proof.

Lemma 4.3. Under the conditions of Theorem 2.1, with (Yn,i)1≤i≤n, n∈N deﬁned
in (4.28), for any ε > 0,

n
(cid:88)

j=1

E(cid:0)Y 2

n,j I1{|Yn,j |≥ε}| F (s)

j−1

(cid:1)

P
−→
n→+∞

0.

(4.19)

Proof of Lemma 4.3. Since Eξ2
sequence (ck)k with

0 = σ2 < ∞ this is easy to exhibit an increasing

c0 = 1, c1 = 2 and ck+1 ≥ c2

k, where E(cid:0)ξ2

0 I1{|ξ0|≥ck}

(cid:1) ≤

1
k3 ,

for all k ∈ N∗.

Deﬁne g(·) as the piecewise aﬃne function such that g(ck) = k for k ∈ N and
g(0) = 0. Then the function ψ deﬁned by ψ(x) = x2g(x) for x ≥ 0 satisﬁes
ψ(0) = 0 and it is a continuous and non-decreasing function (for almost all
x > 0, ψ(cid:48)(x) = x2g(cid:48)(x) + 2xg(x) > 0) and convex function (indeed, for almost
all x > 0, ψ(cid:48)(cid:48)(x) = 4xg(cid:48)(x) + 2g(x) > 0). Hence, we have:

∞
(cid:88)

(cid:16)

E

k=1

ξ2
0g(|ξ0|) I1{ck≤|ξ0|<ck+1}

(cid:17)

≤

∞
(cid:88)

(cid:16)

E

k=0

ξ2
0g(|ξ0|) I1{k≤g(|ξ0|)<k+1}

(cid:17)

∞
(cid:88)

≤

(k + 1)E(cid:0)ξ2

0 I1{ck≤|ξ0|}

(cid:1) ≤

k=1

∞
(cid:88)

k=1

k + 1
k3 < ∞.

Therefore,

Eψ(|ξ0|) ≤ E(cid:0)ξ2

0g(|ξ0|) I1{0≤|ξ0|<2}

(cid:1) +

∞
(cid:88)

k=0

E(cid:0)ξ2

0g(|ξ0|) I1

{ck≤|ξ0|(cid:1)<ck+1}

< ∞.(4.20)

imsart-ejs ver. 2014/10/16 file: nonstationarity28062018.tex date: November 24, 2021

Bardet and Doukhan/Local periodic time varying AR(1)–processes

21

The construction of (ck)k and the relation ck+1 ≥ c2

k together imply:

ψ(xy) ≤ ψ(x)ψ(y).

(4.21)

Indeed, this relationship is equivalent to

g(xy) ≤ g(x)g(y),

for any 0 ≤ x ≤ y.

(4.22)

But if 0 ≤ x ≤ 1 and y ≥ x, then xy ≤ y: therefore g(xy) ≤ g(y) ≤ g(x)g(y)
since g is an increasing function and g(x) ≥ 1 for any x ≥ 0. Moreover, if
1 < x ≤ y, there exists 0 ≤ k and λ ∈ [0, 1] such as y = λck + (1 − λ)ck+1. But
h : [0, ∞) → R+ deﬁned by x (cid:55)→ h(x) = g(x2) is a convex function since h(cid:48)(cid:48) ≥ 0
a.e. As a consequence,

g(y2) = h(λck + (1 − λ)ck+1) ≤ λg(c2

k) + (1 − λ)g(c2

k+1)

≤ λg(ck+1) + (1 − λ)g(ck+2) ≤ λ(k + 1) + (1 − λ)(k + 2) = k + 2 − λ,

from the construction of (ck). Since g(y) = λg(ck) + (1 − λ)g(ck+1) = k + 1 − λ
because g is a piecewise function, we ﬁnally obtain g(y2) ≤ g(y)+1. We conclude
with g(xy) ≤ g(y2) for any 1 ≤ x ≤ y and g(x) ≥ 2 (since c1 = 2).
Hence the function ψ is a Orlicz function and (cid:107)ξ0(cid:107)ψ < ∞ with

(cid:107)V (cid:107)ψ = inf

(cid:110)

z > 0; Eψ

(cid:16) |V |
z

(cid:17)

(cid:111)
,

≤ 1

Now Theorem 1.1 in [16] implies:

for any random variable V.

(4.23)

(cid:107)V (cid:107)ψ ≤ inf
z>0

1
z

(cid:0)1 + E(cid:2)ψ(z|V |)(cid:3)(cid:1) ≤ 2 (cid:107)V (cid:107)ψ.

(4.24)

Therefore (cid:107)V (cid:107)ψ ≤ 1 + Eψ(|V |), and 1
z
from convexity

Eψ(z|V |) ≤ 2(cid:107)V (cid:107)ψ for any z > 0 since

Eψ(|V |) ≤

z − 1
z

· Eψ(0) +

1
z

· Eψ(z|V |) ≤ 2(cid:107)V (cid:107)ψ

and ψ(0) = 0. Then, from the deﬁnition of (X (n)

t

) and the triangular inequality

(cid:107)X (n)

t (cid:107)ψ ≤ α(cid:107)X (n)

t−1(cid:107)ψ + (cid:107)ξt(cid:107)ψ ≤

t−1
(cid:88)

j=0

αj(cid:107)ξt−j(cid:107)ψ

for any t ∈ N∗,

with 0 ≤ α < 1. Since (cid:107)ξs(cid:107)ψ = (cid:107)ξ0(cid:107)ψ for any s ∈ N, we ﬁnally obtain

(cid:8)(cid:107)X (n)

t (cid:107)ψ

(cid:9) ≤

sup
t∈N

1
1 − α

(cid:107)ξ0(cid:107)ψ < ∞.

Thus (4.21) implies with the independence of ξt and X (n)

t−1 that:

Eψ(|ξtX (n)

t−1|) ≤ Eψ(|ξt|) · Eψ(|X (n)

t−1|).

imsart-ejs ver. 2014/10/16 file: nonstationarity28062018.tex date: November 24, 2021

Bardet and Doukhan/Local periodic time varying AR(1)–processes

22

Now relation (4.24) with z = 1 entails

(cid:8)(cid:107)ξtX (n)

t−1(cid:107)ψ

(cid:9) < ∞.

sup
t∈N∗

Thus with t = s + (j − 1)T we have from (4.24),

(cid:107)Yn,j(cid:107)ψ ≤

√

1
nbn

(cid:12)
(cid:12)
(cid:12)K

(cid:16) t

nT − u
bn
(cid:16) t

(cid:17)(cid:12)
(cid:12)(cid:107)ξt(cid:107)ψ(cid:107)X (n)
(cid:12)
(cid:17)

nT −u
bn

,

t−1(cid:107)ψ < ∞.

Again using (4.21) and with Kt = K

E(cid:0)(KtξtX (n)

t−1)2 I1(cid:110)

√

(cid:111)(cid:1)

nbn)

t−1|)≥g(ε

g(|KtξtX (n)
g(|KtξtX (n)
√
nbn)

t−1|)

(cid:16)

E

(KtξtX (n)

t−1)2 ·

E(cid:0)ψ(KtξtX (n)

g(ε
t−1)(cid:1)

I1(cid:110)

g(|KtξtX (n)

t−1|)≥g(ε

√

nbn)

(cid:17)

(cid:111)

E(cid:0)Y 2

j I1{|Yj |≥ε}

(cid:1) =

≤

1
nbn

1
nbn

≤

1
√
ψ(ε
nbn)
2ψ(|Kt|)
√
nbn)
ψ(ε
As a consequence, for any ε > 0,

≤

(cid:107)ξtX (n)

t−1(cid:107)ψ.

sup
t∈N∗

(cid:16) n
(cid:88)

E

j=1

E(cid:0)Y 2

n,j I1{|Yn,j |>ε}|F (s)

j−1

(cid:1)(cid:17)

≤

supt∈N∗ (cid:107)ξtX (n)
nbn)

ε2 g(ε

√

t−1(cid:107)ψ

×

1
nbn

n
(cid:88)

j=1

(cid:16)(cid:12)
(cid:12)
(cid:12)K

ψ

(cid:16) s+(j−1)T
nT
bn

− u

(cid:17)(cid:12)
(cid:17)
(cid:12)
(cid:12)

≤ 2 ×

supt∈N∗ (cid:107)ξtX (n)
nbn)

ε2 g(ε

√

t−1(cid:107)ψ

(cid:90)

R

ψ(|K(x)|) dx

if n is large enough, from Lemma 4.1. As a consequence, for any ε > 0, since
E(cid:0)Y 2
0. Since Y 2
g(ε

∞, then E

n,j I1{|Yn,j |>ε}|F (s)

nbn) −→

(cid:16) (cid:80)n

(cid:1)(cid:17)

√

j−1

j=1

n,j I1{|Yn,j |>ε}

−→
n→+∞

n→+∞

is a non-negative triangular array, the proof of Lemma 4.3 is complete.

Proof of Theorem 2.1. Using (1.2), write

(cid:98)N (n)
s

(u) =

1
nbn

(cid:88)

j∈In,s

K

(cid:16) j

nT − u
bn

(cid:17)

X (n)
j−1

(cid:17)

(cid:16)

as

(cid:16) j
nT

X (n)

j−1 + ξj

(cid:17)

we decompose it as: (cid:98)N (n)

s

(u) = (cid:101)N (n)

s

M (n)
s

(u) =

(cid:101)N (n)
s

(u) =

1
nbn

1
nbn

j∈In,s

(cid:88)

j∈In,s

(u) + M (n)
(cid:16) j

s

nT − u
bn

(cid:88)

K

(u), with

(cid:17)

ξjX (n)
j−1,

K

(cid:16) j

nT − u
bn

(cid:17)

as

(cid:0) j
nT

(cid:1)(X (n)

j−1)2

imsart-ejs ver. 2014/10/16 file: nonstationarity28062018.tex date: November 24, 2021

Bardet and Doukhan/Local periodic time varying AR(1)–processes

23

Therefore we obtain:

(cid:112)

nbn

(cid:98)as(u) − as(u)(cid:1) =
(cid:0)

(cid:112)

nbn

M (n)
s
(cid:98)D(n)

s

(u)

(u)

with

(cid:98)D(n)
s

(u) =

1
nbn

(cid:88)

j∈In,s

K

(cid:16) j

nT − u
bn

(cid:17)

X 2

j−1,

+

Jn
(cid:98)D(n)

s

(u)

,

(4.25)

(4.26)

Jn

=

√

1
nbn

(cid:88)

j∈In,s

K

(cid:16) j

nT − u
bn

(cid:17)

(X (n)

j−1)2(cid:16)

as

(cid:0) j
nT

(cid:17)
(cid:1) − as(u)

. (4.27)

We are going to derive the consistency of the estimator (cid:98)as(u) of as(u), in two
parts.

1/ We ﬁrst prove that

√

nbnM (n)

s

(cid:46)

(u)

(cid:98)D(n)

s

(u)

L−→
n→+∞

N (cid:0)0, C(cid:1) for some con-

venient constant C > 0.
Let s ∈ {1, . . . , T } and u ∈ (0, 1). For n ∈ N∗ and j ∈ {1, . . . , n}, we
denote

Yn,j =

√

1
nbn

K

(cid:16) s+(j−1)T
nT
bn

− u

(cid:17)

ξs+(j−1)T X (n)

s+(j−1)T −1.

(4.28)

This is clear that (Yn,j)≤j≤n, n∈N∗ is a triangular array of martingale in-
(cid:1). Indeed
crements with respect to the σ-algebra F (s)
(X (n)
)t≥0 is a process, causal with respect to (ξt)t≥0. This implies that ξt
t
is independent of (X (n)
)i≤t−1 and that E(ξ0) = 0. We are going to use a
central limit theorem for triangular arrays of martingale increments, see
for example [13] and more recently [15].
Denote

t = σ(cid:0)(ξi)i≤s+(t−1)T

i

n,j = E(cid:0)Y 2
σ2

n,j| F (s)

j−1

(cid:1) =

1
nbn

K 2(cid:16) s+(j−1)T
bn

nT

− u

(cid:17)(cid:0)X (n)

s+(j−1)T −1

(cid:1)2

,

since E(ξ2

0) = 0. Using Lemma 4.2, we obtain:
n
(cid:88)

1 + (cid:80)T −2

i=0 βs,i(u)

σ2
n,j

P
−→
n→+∞

σ2 ·

1 − βs,T −1(u)

j=1

(cid:90)

·

R

K 2(x)dx,

(4.29)

(cid:98)D(n)

s

(u) is deﬁned from (4.26) and satisﬁes

(cid:98)D(n)
s

(u)

P
−→
n→+∞

σ2 1 + (cid:80)T −2

i=0 βs,i(u)

1 − βs,T −1(u)

≡ γ(2)

s (u).

(4.30)

Moreover, from Lemma 4.3, then for any ε > 0,

n
(cid:88)

j=1

E(cid:0)Y 2

n,j I1{|Yn,j |≥ε}| F (s)

j−1

(cid:1)

P
−→
n→+∞

0.

imsart-ejs ver. 2014/10/16 file: nonstationarity28062018.tex date: November 24, 2021

Bardet and Doukhan/Local periodic time varying AR(1)–processes

24

As a consequence, the conditions of the central limit theorem for triangular
arrays of martingale increments, in [15]), are satisﬁed and this implies that

(cid:80)n
(cid:113)(cid:80)n

j=1 Yn,j
j=1 σ2
n,j

L−→
n→+∞

N (cid:0)0, 1(cid:1).

Therefore from Slutsky lemma entails:

(cid:112)

nbn

(u)

(u)

s

M (n)
s
(cid:98)D(n)
(cid:80)n
(cid:113)(cid:80)n

=

j=1 Yn,j
j=1 σ2
n,j

×

1
nbn
(cid:32)

L−→
n→+∞

N

0, σ2

(cid:113)(cid:80)n

j=1 σ2
n,j

(cid:80)n

j=1 K

(cid:16) s+(j−1)T
nT

bn

−u

1 − βs,T −1(u)

1 + (cid:80)T −2

i=0 βs,i(u)
√

R

(cid:17)(cid:0)X (n)
(cid:90)

s+(j−1)T −1
(cid:33)

K 2(x) dx

(cid:1)2

.

(4.31)

s

2/ The second term Jn/ (cid:98)D(n)

(cid:98)as(u) − as(u)(cid:1) de-
(cid:0)
(u) in the expansion of
pends on the non-martingale term Jn, see (4.27), and the consistent term
(cid:98)D(n)
(u), see (4.26) and (4.30). The asymptotic behavior of this second
term can be ﬁrst obtained following two steps.
a. A ﬁrst step consists in establishing an expansion of EJn. Using Propo-

nbn

s

sition 2.1 and with γ(2)

s ∈ Cρ([0, 1]) deﬁned in (2.1), we have

EJn =

(cid:112)

nbn

1
nbn

(cid:88)

j∈In,s

K

(cid:16) j

nT − u
bn

(cid:17)

(cid:16)

×

γ(2)
s (

j
nT

) + O(cid:0) 1
n

(cid:1)(cid:17)(cid:16)

as

(cid:0) j
nT

(cid:17)
(cid:1) − as(u)

.

Using twice Lemma 4.1, with ﬁrstly c(x) = γ(2)
and secondly c(x) = (as(x) − as(u)), we deduce:

s (x)(as(x) − as(u)),

(cid:12)
(cid:12)EJn

(cid:12)
(cid:12) ≤ C

(cid:112)

nbn

(cid:16) An
nbn

+ bρ
n

(cid:17)(cid:16)

1 + O(cid:0) 1
n

(cid:1)(cid:17)

.

(4.32)

As a consequence, if bn = o(cid:0)n−1/(1+2ρ)(cid:1), then EJn −→
In the case ρ ∈ {1, 2}, we also obtain from (4.12) and with ds(v) =
(as(v) − as(u))γ(2)

s (v) ∈ Cρ([0, 1]),

n→+∞

0.

EJn =

(cid:112)

nbn

(cid:16)

O(cid:0) An
nbn

(cid:1) + bρ

n

d(ρ)
s (u)
ρ!

(cid:90)

R

zρK(z) dz (cid:0)1 + o(1)(cid:1)(cid:17)

=

=

zρK(z) dz

(cid:90)

d(ρ)
s (u)
ρ!
o((cid:112)nb3
Bs(u) (cid:112)nb5

R

(cid:40)

n) + O(cid:0) An√

(cid:1),
n + o((cid:112)nb5

nbn

(cid:113)

nb2ρ+1
n

(cid:113)

+ o(

nb2ρ+1
n

) + O(cid:0) An√
nbn

(cid:1)

n) + O(cid:0) An√

nbn

if ρ = 1,
if ρ = 2.

(cid:1),

(4.33)

imsart-ejs ver. 2014/10/16 file: nonstationarity28062018.tex date: November 24, 2021

Bardet and Doukhan/Local periodic time varying AR(1)–processes

25

with Bs(u) =

d(cid:48)(cid:48)
s (u)
2

(cid:90)

R

z2K(z) dz.

b. Now we are going to prove a ﬁrst consistency result for Jn/ (cid:98)D(n)

s

(u)

using the Markov Inequality. Indeed,

E|Jn| ≤

≤

√

1
nbn

√

C
nbn

(cid:88)

j∈In,s

(cid:88)

j∈In,s

(cid:12)
(cid:12)
(cid:12)K

(cid:16) j

nT − u
bn

(cid:17)(cid:12)
(cid:12)
(cid:12)

(cid:12)
(cid:12)as

(cid:0) j
nT

(cid:1) − as(u)(cid:12)

(cid:12)Var (X (n)
j−1)

(cid:12)
(cid:12)
(cid:12)K

(cid:16) j

nT − u
bn

(cid:17)(cid:12)
(cid:12)
(cid:12)

(cid:12)
(cid:12)as

(cid:0) j
nT

(cid:1) − as(u)(cid:12)
(cid:12).

Now using Lemma 4.1 with c(v) = |as(v) − as(u)| which also belongs
in Cρ([0, 1]) (this is clear if ρ < 1 and, for ρ = 1 the Lipschitz property
of z (cid:55)→ |z| allows to conclude), and c(u) = 0, we derive:

E|Jn| ≤

(cid:112)

nbn

(cid:16) An
nbn

+ bρ∧1
n

(cid:17)

.

(4.34)

Therefore, if bn = o(cid:0)n−

1

1+2(ρ∧1 (cid:1), then EJn −→

implying from Markov Inequality, Jn
lishes the consistency of (cid:98)D(n)

s

(u), from Slutsky lemma, we deduce

0 and E|Jn| −→
n→+∞

n→+∞
0. Finally, since (4.30) estab-

0,

P
−→
n→+∞

Jn
(cid:98)D(n)

s

(u)

P
−→
n→+∞

0.

(4.35)

As a consequence, the proof of the Theorem results by using the decom-
position (4.25), the consistency results (4.31) and (4.35).

Proof of Theorem 2.2. We restrict to the case ρ ∈ (1, 2].
a. Case E(cid:0)ξ4

(cid:1) < ∞.

0

Denote again Kt = K

(cid:16) t

nT − u
bn

(cid:17)

, for t ∈ Z. First remark that the symme-

imsart-ejs ver. 2014/10/16 file: nonstationarity28062018.tex date: November 24, 2021

Bardet and Doukhan/Local periodic time varying AR(1)–processes

26

try assumption on ξ0’s distribution implies E(cid:0)ξ0

(cid:1) = E(cid:0)ξ3

0

(cid:1) = 0.

Var (Jn) =

=

+

1
nbn

1
nbn

1
nbn

(cid:88)

(cid:88)

KtKt(cid:48) Cov (X 2

t , X 2

t(cid:48)) ×

t∈In,s

t(cid:48)∈In,s
(cid:16)

×

(cid:88)

(t,t(cid:48))∈Ln,s,α

as

(cid:1) − as(u)

(cid:0) t
nT
KtKt(cid:48) Cov (X 2

t , X 2

t(cid:48)) ×

(cid:17)(cid:16)

as

(cid:0) t
nT

(cid:1) − as(u)

(cid:17)

(cid:16)

×

as

(cid:0) t
nT

(cid:1) − as(u)

(cid:17)(cid:16)

as

(cid:0) t(cid:48)
nT

(cid:1) − as(u)

(cid:17)

(cid:88)

KtKt(cid:48)Cov (X 2

t , X 2

t(cid:48)) ×

(t,t(cid:48))∈I 2

n,s\Ln,s,α
(cid:16)

×

as

(cid:0) t
nT

(cid:1) − as(u)

(cid:17)(cid:16)

as

(cid:0) t(cid:48)
nT

(cid:1) − as(u)

(cid:17)

(cid:9).

n,s,

t ) = γ(2)

s ∈ Cρ([0, 1]).

with Ln,s,α = (cid:8)(t, t(cid:48)) ∈ I 2
|t − t(cid:48)| ≤ log n
log α
Firstly, consider the ﬁrst left side term of the last inequality. If t ∈ In,s then
Proposition 2.1 entails Var (X 2
s (t/(nT )) + O(1/n) for an adequate
function γ(2)
Hence we also have Var (X 2
Here the fact that (z (cid:55)→ z2) is a function in Cρ, implies that the function
deﬁned from b(v) = (cid:0)as(v)−as(u)(cid:1)2
is in Cρ([0, 1]) too, and again b(u) = 0
and (cid:82) xH 2(x)dx = 0.
Therefore, we use Lemma 4.1 to derive:

s (t/(nT )) + O(log(n)/n).

t ) = γ(2)

imsart-ejs ver. 2014/10/16 file: nonstationarity28062018.tex date: November 24, 2021

Bardet and Doukhan/Local periodic time varying AR(1)–processes

27

(cid:88)

t,t(cid:48)∈Ln,s,α

KtKt(cid:48)Cov (X 2

t , X 2
t(cid:48))

(cid:16)

as

(cid:0) t
nT

(cid:1) − as(u)

(cid:17)(cid:16)

as

(cid:0) t(cid:48)
nT

(cid:17)
(cid:1) − as(u)

(cid:88)

=

KtKt(cid:48)

|t−t(cid:48)|
(cid:89)

a2
s+i

t,t(cid:48)∈Ln,s,α

(cid:16)

×

i=1
(cid:0) t
nT

as

(cid:0) t
nT

(cid:1)(cid:16)

γ(4)
s

(cid:0) t + i
nT

(cid:1) + O(cid:0) 1
n

(cid:1)(cid:17)

(cid:1) − as(u)

(cid:17)(cid:16)

as

(cid:0) t(cid:48)
nT

(cid:1) − as(u)

(cid:17)

log n
log α
(cid:88)

(cid:88)

=

j=0

t∈In,s

Kt

(cid:16)

Kt + O(cid:0) log n
nb2
n

j
(cid:89)

(cid:1)(cid:17)

i=1

a2
s+i

(cid:0) t
nT

(cid:1)(cid:16)

γ(4)
s

(cid:0) t
nT

(cid:1) + O(cid:0) log n
n

(cid:1)(cid:17)

(cid:16)

as

×

(cid:0) t
nT

(cid:1) − as(u)

(cid:17)(cid:16)

as

(cid:0) t(cid:48)
nT

(cid:1) − as(u)

(cid:17)

≤

log n
log α
(cid:88)

j=0

α2j(cid:16) (cid:88)

K 2
t

t∈In,s

j
(cid:89)

i=1

γ(4)
s

(cid:0) t
nT

(cid:1) ×

(cid:16)

as

(cid:0) t
nT

(cid:1) − as(u)

(cid:17)2

+ O(cid:0) log n
nb2
n

(cid:1)(cid:17)(cid:17)

≤ 2

∞
(cid:88)

j=0

α2j (cid:88)

K 2
t

t∈In,s

j
(cid:89)

i=1

γ(4)
s

(cid:0) t
nT

(cid:1) ×

(cid:16)

as

(cid:0) t
nT

(cid:1) − as(u)

(cid:17)2

≤ 2nbn

∞
(cid:88)

j=0

α2j 1
nbn

(cid:88)

t∈In,s

K 2(cid:16) t

nT − u
bn

(cid:17)

gj

(cid:0) t
nT

(cid:1),

with gj(x) = (cid:0)as(x) − as(u)(cid:1)2

j
(cid:89)

(cid:0)γ(4)

s (x), since for n large enough the

above expression satisﬁes (cid:12)
H = K 2 and c = gj with gj ∈ Cρ([0, 1]) (quote that maxi≤j
Lip (gi)(cid:1) = O(j)), we ﬁnally obtain:

i=1
(cid:1)(cid:12)
(cid:12) ≤ 1. Using Lemma 4.1, with functions
(cid:0)(cid:107)gi(cid:107) ∨

(cid:12)O(cid:0) log n

nb2
n

(cid:12)
(cid:12)
(cid:12)

1
nbn

(cid:88)

t,t(cid:48)∈Ln,s,α

KtKt(cid:48)Cov (X 2

t , X 2

t(cid:48))(cid:0)as

(cid:0) t
nT

(cid:1) − as(u)(cid:1)(as

(cid:0) t(cid:48)
nT

(cid:1) − as(u)(cid:1)(cid:12)
(cid:12)
(cid:12)

≤ C

(cid:16) An
nbn

(cid:17)

.

+ bρ
n

(4.36)

Secondly, from Proposition 2.1, for t, t(cid:48) ∈ I 2

n,s \ Ln,s,α, we have

|Cov (X 2

t , X 2

t(cid:48))| ≤ C α2 |t−t(cid:48)| ≤

C
n2 .

imsart-ejs ver. 2014/10/16 file: nonstationarity28062018.tex date: November 24, 2021

Bardet and Doukhan/Local periodic time varying AR(1)–processes

28

Thus,

(cid:12)
(cid:12)
(cid:12)

1
nbn

(cid:88)

KtKt(cid:48)Cov (X 2

t , X 2
t(cid:48))

(cid:16)

as

(cid:0) t
nT

(cid:1) − as(u)

(cid:17)(cid:16)

as

(cid:0) t(cid:48)
nT

(cid:1) − as(u)

(cid:17)(cid:12)
(cid:12)
(cid:12)

t,t(cid:48)∈I 2

≤

nbn
n2

n,s\Ln,s,α
(cid:16) 1
nbn

(cid:88)

t∈In,s

(cid:0)as

Kt

(cid:0) t
nT

(cid:1) − as(u)(cid:1)(cid:17)2

≤ C

bn
n

(cid:16) An
nbn

(cid:17)

,

+ bρ
n

(4.37)

from Lemma 4.1. Then, (4.36) and (4.37) provide

Var (cid:0)Jn

(cid:1) ≤ C

(cid:16) An
nbn

(cid:17)

+ bρ
n

(4.38)

implying Var (cid:0)Jn

(cid:1) −→

n→+∞

0 for any (bn) such as

max(bn, An(n bn)−1) −→
n→+∞

0.

b. Case E(cid:0)|ξ0|β(cid:1) < ∞, for some β ∈ [2, 4].

From its expression given in (4.27), Jn is a quadratic form of (Xt) and
therefore, as Xt is a linear process with innovations (ξt), Jn is also a
quadratic form of (ξt). As a consequence, the fourth order moment can be
injected such as there exists a sequence zn ↓ 0 (as n ↑ ∞) satisfying:

Var (Jn) ≤ zn

(cid:0)E(ξ4

0) ∨ 1(cid:1) = zn

(cid:0)µ4 ∨ 1(cid:1), and zn = O(cid:0) An
nbn

+ bρ
n

(cid:1). (4.39)

Now, assume only that E(ξ2
at level M , and write

0) < ∞. The innovations (ξt) can be truncated

ξt,M = ξt I1|ξt|≤M

for any t ∈ N.

Note that the symmetry assumption entails E(ξj,M ) = 0. Deﬁne also De-
ﬁne also

X (n)

t,M = at

and Jn,M =

√

(cid:0) t
nT
1
nbn

(cid:1)X (n)

t−1,M + ξt,M ,
(cid:16) j

nT − u
bn

K

(cid:88)

j∈In,s

1 ≤ t ≤ nT, n ∈ N

(cid:17)

(X (n)

j−1)2(cid:16)

as

(cid:0) j
nT

(cid:17)
(cid:1) − as(u)

.

A consequence of (4.39) is:

Var (Jn,M ) ≤ zn E(ξ4

0,M ) ≤ zn M 2h(M ),
(cid:1) which satisﬁes limM→∞ h(M ) = 0.

(4.40)

with h(M ) = E(cid:0)|ξ0|2 I1{|ξ0|>M }
Moreover,

(cid:12)
(cid:12)Jn − Jn,M

(cid:12)
(cid:12) =

√

1
nbn

(cid:88)

j∈In,s

K

(cid:16) j

nT − u
bn

(cid:17)

× (cid:12)

(cid:12)(X (n)

j−1)2 − (X (n)

j−1,M )2(cid:12)
(cid:12)

(cid:12)
(cid:12)as

(cid:0) j
nT

(cid:1) − as(u)(cid:12)
(cid:12).

(4.41)

imsart-ejs ver. 2014/10/16 file: nonstationarity28062018.tex date: November 24, 2021

Bardet and Doukhan/Local periodic time varying AR(1)–processes

29

But

X (n)

j−1,M − X (n)
j−1,M − X (n)

j−1 = aj−1
(cid:12) ≤ α (cid:12)
(cid:12)

j−1

(cid:12)
(cid:12)X (n)

(cid:0) j − 1
nT

(cid:1)(cid:0)X (n)

j−2,M − X (n)

j−2

(cid:1) + (cid:0)ξj−1,M − ξj−1

(cid:1),

(cid:12)X (n)

j−2,M − X (n)

j−2

(cid:12)
(cid:12) + |ξj−1| I1{|ξj−1|>M }.

(4.42)

E(cid:0)(cid:12)

(cid:12)(X (n)
j−1 − X (n)

j−1)2 − (X (n)
j−1,M |2(cid:1).

We ﬁrst remark from Proposition 2.1 that E(X (n)
j−1,M )2 ≤ c
for some constant c > 0. Hence, Cauchy-Schwartz Inequality shows that,
for each j:

j−1)2 + E(X (n)

j−1,M )2(cid:12)
(cid:12)

(cid:1) ≤ (cid:112)cδj−1,M ,

(4.43)

with δj−1,M = E(cid:0)|X (n)
We are going to bound δj−1,M . A ﬁrst simple bound is clearly δj−1,M ≤ 2 c
and we use it together with (4.42), and Cauchy-Schwartz inequality in
order to derive
δj−1,M ≤ α2δj−2,M + 2α E(cid:0)|X (n)

j−2||ξj−1| I1{|ξj−1|>M }|(cid:1)

j−2,M − X (n)
(cid:1)

+E(cid:0)|ξj−1|2 I1{|ξj−1|>M }
√

(cid:113)

≤ α2δj−2,M + 2α

2c

≤ α2δj−2,M + H(M )
≤ α4δj−3,M + (1 + α2)H(M )
≤ · · ·
≤ α2(j−1)δ0,M + (1 + · · · + α2(j−2))H(M )

E|ξj−1|2 I1{|ξj−1|>M } + E|ξj−1|2 I1{|ξj−1|>M }
√
2c (cid:112)h(M ) + h(M ))

(with H(M ) = 2α

≤

2

1 − α2 H(M )

since δ0,M ≤ h(M ) ≤ H(M ).
Now, from (4.43), we obtain for M large enough:

E(cid:12)
(cid:12)(X (n)

j−1)2 − (X (n)

j−1,M )2(cid:12)

(cid:12) ≤

(cid:114) 2c

1 − α2

(cid:112)H(M ) ≤ C h1/4(M )

(4.44)

with C > 0 and always with h(M ) = E(cid:0)|ξ0|2 I1{|ξ0|>M }
of (4.34) and (4.41) entails:

(cid:1). Now a careful use

E|Jn − Jn,M | ≤ C

(cid:112)

nbn

(cid:16) An
nbn

(cid:17)

+ bn

h1/4(M )

(4.45)

since x → |a(x)−a(u)| is a C1 function (in the above deﬁned sense). Finally,
using Cauchy-Schwartz inequality in (4.40), we obtain for M large enough,

(cid:113)

Var (Jn,M )

E|Jn| ≤ E|Jn − Jn,M | +
(cid:16) An
nbn

≤ C

(cid:16)(cid:112)

(cid:17)

+ bn

nbn
(cid:16)(cid:112)nb3

≤ C

n h1/4(M ) + bρ/2

h1/4(M ) + (cid:0) An
nbn
(cid:17)
n M h1/2(M )

(cid:1)1/2

+ bρ
n

M h1/2(M )

(cid:17)

(4.46)

imsart-ejs ver. 2014/10/16 file: nonstationarity28062018.tex date: November 24, 2021

Bardet and Doukhan/Local periodic time varying AR(1)–processes

30

n ) i.e. (n/An)−2/(2+ρ) = o(bn) (and note that

assuming An/nbn = o(bρ/2
−2/(2 + ρ) ≤ 1/(1 + 2ρ)).
Now, if E(cid:0)|ξ0|β(cid:1) < ∞ with β ∈ (2, 4], then using H¨older and Markov
Inequalities, there exists Cβ > 0 such as
h(M ) = E(cid:0)|ξ0|2 I1{|ξ0|>M }

(cid:1) ≤ Cβ M 2−β.

Since here bn = o(cid:0)n−1/(1+2ρ)(cid:1), does not yields the minimax rates, we
deduce that






(cid:112)nb3
n h1/4(M ) −→
n→+∞
bρ/2
n M h1/2(M ) −→
n→+∞

0 when M 1+2ρ ≥ n(4ρ−4)/(β−2)

0 when M 1+2ρ ≤ nρ/(4−β)

.

Thus, from inequality (4.46), we deduce that the optimal choice is obtained
when

4ρ − 4
β − 2

=

ρ
4 − β

, which entails β = 4 − 2 ·

ρ
5ρ − 4

.

d. Case ρ = 2.

The expression of the non-central limit for the case of optimal window
widths and the expansion of the bias (4.33) now the asymptotic expression
for (4.35) yields the proposed non-centred Gaussian limit, see Remark 4.1.
The same truncation step as above is also needed.

The proof is now complete.

Remark 4.1. Using the previous bound (4.32) of EJn and Bienaym´e-Tchebychev
inequality, we deduce that if bn = o(cid:0)n−1/(1+2ρ)(cid:1) then Jn
Moreover, if ρ = 2 and bn = c n−1/5, using the expansion (4.33) of EJn and
again Bienaym´e-Chebychev inequality, then Jn

Bs(u) c5/2.

P
−→
n→+∞

0.

P
−→
n→+∞

Therefore with the consistency result (4.30), for any u ∈ (0, 1) and s ∈ {1, . . . , T },

Jn
(cid:98)D(n)

s

(u)

P
−→
n→+∞

Bs(u)

2

c 5
σ2

1 + (cid:80)T −2

i=0 βs,i(u)

1 − βs,T −1(u)

.

Remark 4.2. For the general case with maybe ξ0 non symmetric and Eξ0 = 0,
the item 3. of Proposition 2.1 needs some improvements. Denote w(k)
t = E(X k
t )
for k = 1, 3, then w(4)

t = vt, then (4.8) turns to be written

t = wt and w(2)

wt = qtwt−1 + 4EAtEXt−1µ3 + 6σ2vt + µ4 ≤ α4wt−1 + r(t),

(4.47)

as previously supt wt < ∞.
We need to derive suitable equivalents of w(k)

t

if k = 1. Firstly

t = EAtw(1)
w(1)

t−1 = · · · = EAt · · · EA1 · EX0,

imsart-ejs ver. 2014/10/16 file: nonstationarity28062018.tex date: November 24, 2021

Bardet and Doukhan/Local periodic time varying AR(1)–processes

31

and in fact this term is negligible and the proof of Proposition 2.1 and Lemma
3. remains unchanged.
In this case the proof of the above point 2/ c. needs a simple improvement and

ξj,M = ξj ∧ M ∨ (−M ) − E (ξj ∧ M ∨ (−M )) .

In this truncated setting, inequality (4.42) writes:

|X (n)

j−1,M − X (n)

j−1| ≤ α|X (n)

j−2,M − X (n)
j−2|

+ |ξj−1| I1{|ξj−1|>M } + E(|ξj−1| I1{|ξj−1|>M })

so that the end of the proof is unchanged by only setting C = 2cEξ2
Remark 4.3. Secondly, in case we even omit the condition Eξ0 = 0 one needs to
also express an asymptotic expansion for w(3)
t−1σ2 + µ3 ∼
EA3
t−1 + µ3; an analogue expansion to Proposition 2.1 and Lemma 3. may
) + O(cid:0) 1
thus be derived. Namely w(3)
n

t−1 + 3EAtw(1)

t = γ(3)
s (

t = EA3

0/(1 − α).

(cid:1),, with

t w(3)

t w(3)

t
nT

γ(3)
s (v) = µ3 ·

1 + (cid:80)T −2

i=0 ζs,i(v)

1 − ζs,T −1(v)

,

ζt,i(v) =

i−1
(cid:89)

j=0

t−j(v) ≤ α3i < 1,
a3

for

1 ≤ i ≤ T,

v ∈ (0, 1).

Then the expression of the equivalent of wt is also adequately transformed up to
the above relations.

Aknowledgement. This work has been developed within the “MME-DII cen-
tre of excellence” (ANR-11-LABEX-0023-01) and with the help of PAI- CONI-
CYT MEC Nr. 80170072.
The authors thank the referees for their fruitful comments and suggestions,
which notably improved the quality of the paper. The second author wishes
to thank Rainer Dahlhaus for many interesting discussions. As well, numerous
discussions with Karine Bertin were extremely useful.

References

[1] Andrews, D. Laws of large numbers for dependent non-identically dis-
tributed random variables. Econometric Theory 4, 3 (1988), 458–467.
[2] Azrak, R. and M´elard, G. Asymptotic properties of quasi-maximum
likelihood estimators for ARMA models with time-dependent coeﬃcients.
Statistical Inference for Stochastic Processes 9 (2006), 279–330.

[3] Bibi, A. and Francq, C. Consistent and asymptotically normal estima-
tors for cyclically time-dependent linear models. Annals of the Institute of
Statistical Mathematics 55 (2003), 41–68.

imsart-ejs ver. 2014/10/16 file: nonstationarity28062018.tex date: November 24, 2021

Bardet and Doukhan/Local periodic time varying AR(1)–processes

32

[4] Dacunha-Castelle, D., Huong Hoang, H. T. and Parey, S. Model-
ing of air temperatures: preprocessing and trends, reduced stationary pro-
cess, extremes, simulation. Journal de la Soci´et´e Fran¸caise de Statistique
156, 2 (2015), 138–168.

[5] Dahlhaus, R. On the Kullback-Leibler information divergence of locally
stationary processes. Stochastic Processes and Applications 62 (1996), 139–
168.

[6] Dahlhaus, R. Fitting time series models to nonstationary processes. An-

nals of Statistics 25 (1997), 1–37.

[7] Dahlhaus, R. Locally Stationary Processes, vol. 30. Time Series Analysis:

Methods and Applications, Elsevier, 2012.

[8] Dahlhaus, R. and Polonik, W. Empirical spectral processes for locally

stationary time series. Bernoulli 15 (2009), 1–39.

[9] Doukhan, P., Grublyt´e, I. and Surgailis, D. A nonlinear model for
long memory conditional heteroscedasticity. Lithuanian Journal of Mathe-
matic 56 (2016), 164–188.

[10] Fokianos, K. and Tjøstheim, D. Log-linear Poisson autoregression.

Journal of Multivariate Analysis 102 (2011), 563–578.

[11] Francq, C. and Gautier, E. Large sample properties of parameter least
squares estimates for time-varying ARMA models. Journal of Time Series
Analysis 25 (2004), 765–783.

[12] Grenier, E. ARMA models with time-dependent coeﬃcients: estimators

and applications. Traitement du Signal 3 (1986), 219–233.

[13] Hall, P. and Heyde, C. C. Martingale Limit Theory and Its Application.

Academic Press, 1980.

[14] Lund, R., Hurd, H., Bloomfield, P. and Smith, R. Climatological
time series with periodic correlation. Journal of Climat 8 (1995), 2787–
2809.
[15] Major,

for martingales.

theorems

Central

limit

P.

http://www.math-inst.hu/ major/probability/martingale.pdf
(2016), 1–22.

[16] Maligranda, L. Orlicz spaces and interpolation. In Seminars in Math.
5, B. Campinas Sao Paulo, Ed., vol. 5 of IMS Lecture Notes-Monograph
Series. 1989, pp. 127–140.

[17] Moulines, E., Priouret, P. and Roueff, F. On recursive estima-
tion for locally stationary time varying autoregressive processes. Annals of
Statistics 33 (2005), 2610–2654.

[18] Nadaraya, E. On estimating regression. Theory of Probability and Ap-

plications 9 (1964), 1411-1412.

[19] Paraschakisa, K. and Dahlhaus, R. Frequency and phase estimation
in time series with quasi periodic components. Journal of Time Series
Analysis 33 (2012), 13–31.

[20] Priestley, M. E., and Chao, M. T. Nonparametric function ﬁtting.
Journal of The Royal Statistical Society, Series B 34 (1972), 385–392.
[21] Rosenblatt, M. Stochastic curve estimation, vol. 3. NSF-CBMS Regional

Conference Series in Probability and Statistics, 1991.

imsart-ejs ver. 2014/10/16 file: nonstationarity28062018.tex date: November 24, 2021

Bardet and Doukhan/Local periodic time varying AR(1)–processes

33

[22] Watson, G. Smooth regression analysis. Sankhy¨a Ser. A 26 (1964), 359–

372.

imsart-ejs ver. 2014/10/16 file: nonstationarity28062018.tex date: November 24, 2021

