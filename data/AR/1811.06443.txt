9
1
0
2

n
u
J

6

]
c
q
-
r
g
[

2
v
3
4
4
6
0
.
1
1
8
1
:
v
i
X
r
a

Comparison of various methods to extract ringdown frequency from gravitational
wave data

Hiroyuki Nakano,1, ∗ Tatsuya Narikawa,2, 3, † Ken-ichi Oohara,4, ‡ Kazuki Sakai,5, § Hisa-aki Shinkai,6, ¶ Hirotaka
Takahashi,7, 8, ∗∗ Takahiro Tanaka,3, 9, †† Nami Uchikata,2, 4, ‡‡ Shun Yamamoto,6 and Takahiro S. Yamamoto3, §§
1Faculty of Law, Ryukoku University, Kyoto 612-8577, Japan
2Institute for Cosmic Ray Research, The University of Tokyo, Chiba 277-8582, Japan
3Department of Physics, Kyoto University, Kyoto 606-8502, Japan
4Graduate School of Science and Technology, Niigata University, Niigata 950-2181, Japan
5Department of Electronic Control Engineering, National Institute of Technology, Nagaoka College, Niigata 940-8532, Japan
6Faculty of Information Science & Technology, Osaka Institute of Technology,
Kitayama, Hirakata City, Osaka 573-0196, Japan
7Department of Information and Management Systems Engineering,
Nagaoka University of Technology, Niigata 940-2188, Japan
8Earthquake Research Institute, The University of Tokyo, Tokyo 113-0032, Japan
9Center for Gravitational Physics, Yukawa Institute for Theoretical Physics, Kyoto University, Kyoto 606-8502, Japan
(Dated: June 7, 2019)

The ringdown part of gravitational waves in the ﬁnal stage of merger of compact objects tells us
the nature of strong gravity and hence can be used for testing theories of gravity. The ringdown
waveform, however, fades out in a very short time with a few cycles, and hence it is challenging to
extract the ringdown frequency and its damping time scale. We here propose to build up a suite of
mock data of gravitational waves to compare the performance of various approaches developed to
detect the dominant quasi-normal mode from an excited black hole after merger. In this paper we
present our initial results of comparisons of the following ﬁve methods; (1) plain matched ﬁltering
with ringdown part (MF-R) method, (2) matched ﬁltering with both merger and ringdown parts
(MF-MR) method, (3) Hilbert-Huang transformation (HHT) method, (4) autoregressive modeling
(AR) method, and (5) neural network (NN) method. After comparing the performances of these
methods, we discuss our future projects.

PACS numbers: 04.20.-q, 04.40.-b, 04.50.-h

I.

INTRODUCTION

Both in the year 2016 and 2017, physics commu-
nity was really got excited by the reports of direct de-
tections of gravitational waves (GWs) by LIGO/Virgo
collaborations[1–6].
The direct detections deﬁnitely
prove the correctness of the fundamental idea of gen-
eral relativity (GR), together with that of the direction
of eﬀorts of theoretical and experimental researches of
gravity.

LIGO/Virgo collaboration so far performed their ob-
servations twice [Observing runs 1 (O1), Sep. 12, 2015
– Jan. 19, 2016 (48.6 days); O2, Nov. 30, 2016 – Aug.
25, 2017 (118 days)], and oﬃcially reported [7, 8] that
they detected eleven events; ten binary black hole (BH)
events and one event of the merger of binary neutron
stars (GW170817 [6]). Both types of sources gave us

∗Electronic address: hinakano@law.ryukoku.ac.jp
†Electronic address: narikawa@tap.scphys.kyoto-u.ac.jp
‡Electronic address: oohara@astro.sc.niigata-u.ac.jp
§Electronic address: k-sakai@nagaoka-ct.ac.jp
¶Electronic address: hisaaki.shinkai@oit.ac.jp
∗∗Electronic address: hirotaka@kjs.nagaokaut.ac.jp
††Electronic address: t.tanaka@tap.scphys.kyoto-u.ac.jp
‡‡Electronic address: uchikata@astro.sc.niigata-u.ac.jp
§§Electronic address: yamamoto@tap.scphys.kyoto-u.ac.jp

certain advances not only to physics, but also to astro-
physics.

In late 2019, another ground-based GW detector, KA-
GRA, will join the network of GW observation [9–11].
This will make the source localization more precise, and
we also expect to detect the polarization of GWs for each
event. By accumulating observations, we will be able to
investigate new aspects of physics and astronomy, such
as the distribution of binary parameters, formation his-
tory of binaries, equation of state of the nuclear matter,
and cosmological parameters.

Among such possibilities, our interest lies in testing
various gravity theories. GR has passed all the tests in
the past century, and nobody doubts gravity is basically
described by GR. However, almost of the tests so far
have been performed in the weak gravity regime (tests
around the Earth, in the Solar System, or using binary
pulsars) [12], and we still require tests in the strong grav-
ity regime, which is relevant to describe, say, BH mergers.
Observations of GWs from binary BHs will enable us to
test the gravity theories in this extreme regime.

The previous detections of BH mergers have shown
that the inspiral phase (pre-merger phase) is well de-
scribed by post-Newtonian approximation. But it is not
entirely clear whether or not the ringdown phase (post-
merger phase), which is expected to be well described by
BH perturbation theory, was detected in the GW data.

 
 
 
 
 
 
This is because identifying ringdown modes of a BH from
noisy data is a quite challenging task for data analysis.
Ringdown modes decay quite rapidly for a typical BH
described by GR. For example, for a typical BH formed
after merger with the total mass M = 60M(cid:12) and the an-
gular momentum (normalized Kerr parameter) χ = 0.75,
the dominant ringdown mode ((cid:96) = m = 2) has the char-
acteristic frequency fR = 300 Hz and the damping time
τ = 3.7 msec, which indicates that the amplitude is re-
duced to about 40% after one-cycle of oscillation.

One way to give a clear evidence of detection of the
ringdown mode would be just to improve the detector
sensitivity. However, it will also give a similar impact
if we can improve the signiﬁcance of detection by im-
plementing an optimized data analysis method. There
have been already several technical proposals of method
to identify the ringdown mode (see, e.g., Refs. [13–16]
or reviews, e.g., Refs. [17, 18]), but we think that fair
comparison of the performance of diﬀerent methods has
not been presented yet. To ﬁnd out the optimal method,
we organize mock-data tests. The idea is to extract the
information of the ringdown part [its frequency fR and
damping time τ (imaginary part of frequency fI or qual-
ity factor Q)] independently of the other parts of the
waveform. In order not to allow to identify the proper-
ties of mergers from the inspiral waveform using relations
valid in GR, we prepare a set of blind data each of which
has randomly chosen fR and fI diﬀerent from the GR
predicted value (see Sec. II A).

In general, the ringdown part includes not only the
dominant mode but also subdominant modes. The anal-
ysis of various modes (BH spectroscopy) is also important
for test of gravity theories (e.g., Ref. [19]). But, the am-
plitudes of these subdominant modes are small compared
with the one of the dominant mode [16]. Thus, in this
work, we focus on the case existing only single mode.

We present our comparisons of the following ﬁve meth-
ods; (1) matched ﬁltering with ringdown part (MF-R)
method, (2) matched ﬁltering with both merger and ring-
down parts (MF-MR) method, (3) Hilbert-Huang trans-
formation (HHT) method, (4) autoregressive modeling
(AR) method, and (5) neural network (NN) method.
Each method will be explained separately in Sec. III.

In Sec. IV, we compare the results together with fu-
ture directions for improvement and we also discuss some
issues for the application to the real data. The mock
data we used in this article are available from our web-
page [20].

II. BUILDING MOCK DATA

A. Quasi-Normal Modes

The waveform of the ringdown gravitational waves

emitted from an excited BH is modeled as

h(t) = Ae−(t−t0)/τ cos(2πfR(t − t0) − φ0) ,

(2.1)

2

where fR is the oscillation frequency, and τ is the damp-
ing time, and t0 and φ0 are the initial time and its phase,
respectively. The waveform, Eq. (2.1), is then written as

h(t) = (cid:60)[Ae−2πifqnm(t−t0)] ,

(2.2)

where we call fqnm = fR − ifI the quasi-normal mode
(QNM, or ringdown) frequency (fI > 0 means decaying
mode).
(Nakano et al. [21] uses diﬀerent signature on
fI .) The parameter τ is also expressed using a quality
factor Q, or fI

Q = πfRτ,

or

fI =

1
2πτ

=

fR
2Q

.

(2.3)

In GR, the set of (fR, fI) is determined by the (remnant
BH) mass, Mrem, and angular momentum, M 2
remχ, of
the black hole. QNM is obtained from the perturbation
analysis of BHs, and its ﬁtting formulas are given by [22]

fR =

Q =

1
2πMrem
fR
2fI

{f1 + f2(1 − χ)f3} ,

= q1 + q2(1 − χ)q3 ,

(2.4)

(2.5)

where fi and qi are the ﬁtting coeﬃcients. For the most
fundamental mode, which is of the spherical harmonic
index (cid:96) = 2, m = 2, the ﬁtting parameters are f1 =
1.5251, f2 = −1.1568, f3 = 0.1292, q1 = 0.7000, q2 =
1.4187, and q3 = −0.4990.
If we recover the units,

fR(M, χ) [Hz] =

c3
2πGMrem

{f1 + f2(1 − χ)f3 } ,

(2.6)

where c and G are the speed of light and the gravitational
constant, respectively. From this equation, at linear or-
der, the uncertainties in fR and Q are related to those in
mass and angular momentum as

∆fR
fR

= −

∆Mrem
Mrem

+

f2f3(1 − χ)f3−1
f1 + f2(1 − χ)f3

∆χ .

(2.7)

Similarly, from Eq. (2.5), we get

∆Q =

(cid:18) ∆fR
fR

−

∆fI
fI

(cid:19)

Q

= q2q3(1 − χ)q3−1∆χ .

(2.8)

(2.9)

In modiﬁed gravity theories the ﬁnal fate of binary
mergers may not be a black hole. There are various pos-
sibilities of modiﬁcation of gravity. The most generic
test for the deviation from general relativity would be
just checking the consistency between the observed data
and the predicted waveform based on general relativity.
However, such a generic test will not be very sensitive.
If we focus on some class of modiﬁcation, we would be
able to perform a much better test. Here, we assume
that even if the gravity is modiﬁed the ringdown wave-
form is characterized by the set of (fR, fI). For the same

inspiral/merger waveform, which predicts the formation
of a black hole with M and χ in GR, however, the val-
ues of (fR, fI) may be diﬀerent. Under this assumption,
one can test GR by comparing (fR, fI) predicted from
the data in the inspiral/merger phase in GR with those
directly extracted from the data in the ringdown phase.
For this purpose, we wish to minimize the error in the
determination of (fR, fI) from the data in the ringdown
phase independently of the information contained in the
inspiral/merger phase.

B. Mock data

The fundamental question we raise here is whether
or not one can detect the deviation from the GR pre-
diction, in case only the ringdown frequency is modi-
ﬁed.
If the breakdown of GR occurs only in the ex-
tremely strong gravity regime such as the region close
to the BH event horizon, modiﬁcation of gravity might
be completely irrelevant to the evolution during the in-
spiral/merger phases. Even in such cases, the deviation
from the GR prediction may show up in the ringdown
waveform. This gives a good motivation to develop a
method to identify the ringdown frequency without refer-
ring to the information from the inspiral/merger phases.
There are many proposals for the method to extract
the ringdown frequency and its damping time scale. In
order to compare the performance of various methods
by a blind test, we construct some test data which have
artiﬁcially modiﬁed ringdown frequency.

We adopt the following strategy for preparing the data.
We take the inspiral/merger waveform from SXS Gravi-
tational Waveform Database [24, 25] (there are also avail-
able catalogs for BBH GWs in Refs. [26–29]), and the
ringdown waveform modiﬁed from GR case is merged.
Then, noise is added so as to reproduce the ideal LIGO
noise curve (with the signal-to-noise ratio (SNR) = 20,
30 or 60).
In doing so, we focus on the fact that the
time evolution of the amplitude and the frequency of the
GR waveform is rather smooth if the spin precession can
be neglected. Our basic assumption is that this smooth-
ness is maintained even if we consider modiﬁcation of the
complex QNM frequencies. Then, the modiﬁed waveform
cannot have a large variety.

We deﬁne a normalized time coordinate x = (t−tp)/M ,
where tp denotes the time that the GW amplitude has
its peak, and just modify the GW strain after the peak
time. This is a reasonable assumption because, if the
inspiral/merger parts are also modiﬁed, we can detect the
deviation from GR even in case when we cannot extract
the QNM frequency from the gravitational wave data.
Note that M is the initial total mass of the binary, and
we will specify it later to generate the mock data set. In
the following, we take the simpliﬁcation of considering
only the ((cid:96) = 2, m = 2) GW mode.

To create the mock data, the total mass M is ran-
domly selected from the range between 50M(cid:12) – 70M(cid:12)

3

with uniform probability. The parameters characteriz-
ing the ringdown waveform, fR and and fI, are modiﬁed
from the GR value within ±30% and ±50%, respectively.
Uniform probability distribution is assumed for both pa-
rameters. We present two independent ways to generate
the mock data below.

1. Set A

In the case of set A, the modiﬁcation is strictly limited
to the time domain after the peak of the GW amplitude.
First, as for the GW amplitude A22 = r|h22|/M , we in-
troduce the following ﬁtting function

A22(t) =

AGR

22 (tp) + a0 x + a1 x2

1 − (cid:0)M ωI − a0/AGR
× exp(−M ωI x) ,

22 (tp)(cid:1) x + a2 x2

(2.10)

where we have three ﬁtting parameters a0, a1 and a2,
which are chosen to reproduce the amplitude of the SXS
waveform AGR
22 (t) when the adjustable parameter ωI =
fI/(2π) is set to the GR value ωGR
calculated from the
I
remnant BH mass and spin by using Refs. [22, 23] (In
the following, the QNM frequency will often be written
using angular frequency ω = 2πf ). For example, for
SXS:BBH:0174 [25], we have

a0 = 0.0183650 ,
a2 = 0.00184509 ,

a1 = 0.000998244 ,

(2.11)

22 (tp) = 0.286987 and M ωGR

with AGR
I = 0.0815196. The
above ﬁtting function is chosen as such that the ﬁrst
derivative of the amplitude is zero at the peak (x = 0).
By changing ωI, we can create a mock data.

Second, as for the GW frequency ω22(t), which is de-
ﬁned by the time derivative of the GW phase and sup-
posed to be positive, we use the ﬁtting function

M ω22(t) = (cid:0)M ωGR
22 (tp) − M ωR + b0 x + b1 x2 + b2 x3(cid:1)
(cid:20)
(cid:21)

× exp

(b0 + b3) x
M (ωR − ω22(tp))

+M ωR ,

(2.12)

where ωGR(t) is the frequency extracted from the phase
of the numerically determined GR template. With this
ﬁtting function, the smoothness of GW phase is C 2 at
the peak time. The three ﬁtting parameters are, again
for SXS:BBH:0174,

b0 = −0.0507805 ,
b2 = −0.000479913 ,

b1 = −0.00276104 ,

b3 = −0.00492361 , (2.13)

with M ωGR
22 (tp) = 0.375598. The mock data is created
by changing the input ωR = fR/(2π) from the GR value
calculated from the remnant BH mass and spin, e.g.,
M ωGR

R = 0.582652 for SXS:BBH:0174.

2. Set B

The modiﬁcation of the second set is not strictly re-
stricted to the time period after the peak of the ampli-
tude. As another smooth interpolation, we adopt the
following modiﬁed amplitude

A22(t) =

22 (t)

AGR
1 + e4M ωGR
I x

+

22 (t)

ARD
1 + e−4M ωGR
I x

,

(2.14)

with

ARD

22 (t) =

A22
1 + e−M ωGR
I x + eM ωI x

,

(2.15)

and the overall amplitude A22 determined so that the
GR case ﬁts well.

The frequency is also given in a similar simple manner

by

ω22(t) =

ωGR
22 (t)
1 + e4M ωGR
I x

+

ωRD
22 (t)
1 + e−4M ωGR
I x

,

(2.16)

with the GR frequency ωGR

22 (t) and

22 (t) = ωGR(tp) +
ωRD

ωR − ωGR(tp)
1 + e−2M ωI x .

(2.17)

For the generation of the set B mock data, we used
SXS:BBH:0002, 0004 and 0007.

In Fig. 1, we show examples of the set A and B with
a same ringdown frequency. It is noted that the binary
parameters are diﬀerent between SXS:BBH:0174 (set A)
and SXS:BBH:0002 (set B) in Fig. 1.

III. VARIOUS METHODS FOR IDENTIFYING
RINGDOWN MODE

4

FIG. 1: Examples of the set A and B. The inset shows
the ringdown part.
Here, a set A ((red) thick) with
SXS:BBH:0174 and a set B ((blue) thin) with SXS:BBH:0002
are shown. The solid lines denote the modiﬁed ampli-
tude A22(t), and the dashed lines are the GW frequency
ω22(t)/(2π). The total mass is M = 60M(cid:12), and the real
and imaginary parts of the ringdown frequency are 300 Hz
and 40 Hz, respectively. The real frequency is obtained by
multiplying by 538.609 Hz, and the real amplitude of the set
A is derived by dividing by 1.37903. The large diﬀerence in
the inspiral phase is due to the diﬀerence of the binary pa-
rameters.

∗ denotes the complex conjugate. We consider to maxi-
mize the inner product between the GW data s(t), which
contains the signal and the noise, and the template h(t)
over the parameters ωR, ωI, t0 and φ0. The SNR against
the initial phase of the template can be maximized by
rewriting the template in the following form,

h(t) =

1
N

(hc cos φ0 + hs sin φ0) ,

(3.3)

A. Matched ﬁltering with ringdown part (MF-R)

where

We perform the matched ﬁltering analysis using simple

damped sinusoidal templates, which are given by

ˆh(t) =






0 (t < t0)
1
N e−ωI(t−t0) cos[ωR(t − t0) − φ0]

(t ≥ t0) ,

(3.1)
where t0 and φ0 are the starting time and the initial
phase of the template, respectively. The normalization
constant N is chosen so as to satisfy (ˆh|ˆh) = 1, where
the inner product is deﬁned by

(h1|h2) = 2

(cid:90) ∞

0

1(f )˜h2(f ) + ˜h1(f )˜h∗
˜h∗
Sn(f )

2(f )

df .

(3.2)

hc = e−ωI(t−t0) cos[ωR(t − t0)] ,
hs = e−ωI(t−t0) sin[ωR(t − t0)] .

(3.4)

Then, the maximum of the SNR against the initial phase
φ0 can be given as [30],

ρ2|maxφ0 =

(s|ˆhc)2 + (s|ˆhs)2 − 2(s|ˆhc)(s|ˆhs)(ˆhc|ˆhs)
1 − (ˆhc|ˆhs)2

,

where

ˆhc =

hc
(cid:112)(hc|hc)

,

ˆhs =

hs
(cid:112)(hs|hs)

.

(3.5)

(3.6)

The phase φ0 that gives the maximum ρ is given by

Here, Sn(f ) is the noise spectral density and the Fourier
transform of h(t) is deﬁned by ˜h(f ) = (cid:82) dt e2πif th(t), and

tan φ0 =

(hc|hs)(h|hc) − (hc|hc)(h|hs)
(hc|hs)(h|hs) − (hs|hs)(h|hc)

.

(3.7)

-0.2-0.100.1t [s]00.10.20.30.40.500.010.020.0300.20.4Then, we are left with three parameters to explore. Since
the best choice of the starting time of QNM is unknown,
we vary t0 from the merger time tc to tc+ something.
Then, we search for the best ﬁt values of the parameters
(f, Q) for each t0. Finally, we calculate median values
of {f (t0), Q(t0)} which we regard as our estimate of the
QNM frequency.

by

and

5

ˆs(t) = W (t)

(cid:90)

df e−2πif t

˜s(f )
(cid:112)Sn(f )

,

(3.9)

B. Matched ﬁltering with both merger and
ringdown parts (MF-MR)

The plain matched ﬁltering using the damped sinu-
soidal waveform, which was introduced in the preceding
subsection, has the diﬃculty in choosing the appropriate
starting time, t0. On one hand, if t0 is chosen to be too
early, we pick up lower frequency oscillations before the
QNM starts to dominate. On the other hand, if t0 is
chosen to be too late, the signal has already become very
faint and is buried in noise. Therefore, it is likely that
this method is not the optimal method to determine the
QNM frequency from the data.

The basic idea for the improvement of matched ﬁltering
If we know the modiﬁed
is as discussed in Ref. [31].
ringdown waveform in advance, we can construct the best
linear ﬁlter that produces the largest SNR by using it. As
in the construction of our mock data in Sec. II A, here we
also assume that this smoothness is maintained even for
the modiﬁed waveform. Then, the variety of the possible
waveforms would be eﬀectively limited well.

To obtain a better ﬁt, one may think it would be nec-
essary to introduce, at least, two more parameters in ad-
dition to (ωR, ωI), i.e., the amplitude of QNM relative to
that of the inspiral/merger phases, and the transition ra-
pidity to reach the ﬁnal QNM frequency. It might be rea-
sonable to perform the matched ﬁltering using this gener-
alized waveform including the inspiral/merger phases. To
ﬁnd the best ﬁt parameter values in the four parameter
space is doable. However, we adopt the simpliﬁcations
of neglecting these additional parameters here, in order
to reduce the computational cost in the present analy-
sis, leaving this possible extension to our future work.
To reduce the impact of neglecting the relative ampli-
tude of the QNM, we make use of the fact that the in-
spiral/merger parts are basically unchanged for all modi-
ﬁed templates. Namely, we introduce the following sharp
window function

W (t) =

1
1 + e−50(t−tc)ωGR

I

,

(3.8)

to make the relative amplitude between the inspiral-
merger phase and the ringdown phase almost irrelevant,
instead of introducing one additional model parameter.
The procedure is summarized as follows. We ﬁrst cal-
culate the whitened signal and template multiplied by
the window function, which are more explicitly deﬁned

ˆh(t) = N W (t)

(cid:90)

df e−2πif t

˜h(f )
(cid:112)Sn(f )

,

(3.10)

where N is the normalization factor that is determined
so as to satisfy (ˆh, ˆh)(w) = 1, where (∗, ∗)(w) is the inner
product in Eq. (3.2) with Sn(f ) replaced with unity. Af-
ter this preprocessing, the correlations between the data
and templates are calculated as in the case of the stan-
dard matched ﬁltering, besides the point that the inner
product (∗, ∗)(w) is used instead of (∗, ∗). Here, we sim-
ply choose the phase such that maximize the signal to
noise ratio ρ for each template, instead of marginalizing
over these parameters. The origin of the time coordinate
is not varied. To obtain the distribution of the parame-
ters ωR and ωI, we simply used the probability given by
∝ exp(ρ2/2), which corresponds to the posterior distri-
bution for the ﬂat prior ansatz. [47]

To perform the correlation analysis, we also need to
specify a template waveform which includes the real and
imaginary part of the QNM frequency as free parameters.
To obtain the necessary template waveform, we shall use
the same prescription as set B that is used to generate a
half of the mock data. We understand that this makes
the comparison for set B unfair, but one purpose of test-
ing the improved matched ﬁltering method arranged in
this manner is to give a relevant standard to evaluate the
eﬃciency of the other methods. The standard matched
ﬁltering using the damped sinusoidal wave as templates
might be too naive to use it as the standard reference to
assess the performance of the other methods. This im-
proved matched ﬁltering method is actually guaranteed
to give the best linear ﬁltering. Therefore, we think that
the results obtained by this method oﬀers a good refer-
ence to evaluate the performance of the other methods.

C. Hilbert-Huang transformation (HHT) method

1. Basic idea

The Hilbert-Huang transform (HHT)

is a time-
frequency analysis method [32], which is constructed un-
der the aim to manipulate non-stationary and/or non-
linear system. Some applications of the HHT to the data
analysis of gravitational waves have been proposed [33–
37]. The HHT is based on a signal analysis by the Hilbert
transform. We describe the concept of the signal analysis
by the Hilbert transform and its diﬃculty to be applied to
real-world signals, and then explain how the HHT over-
comes the diﬃculty.

Letting ˇs(t) be the Hilbert transform of a signal s(t),

it is deﬁned by

ˇs(t) =

(cid:90)

PV

1
π

dt(cid:48) s(t(cid:48))
t − t(cid:48) ,

(3.11)

where PV denotes the Cauchy principal value. The com-
plex signal z(t), which is deﬁned by z(t) = s(t) + iˇs(t),
can be represented by the exponential form:

z(t) = a(t)eiφ(t) ,

(3.12)

where a(t) and φ(t) are deﬁned by

a(t) = (cid:112)s(t)2 + ˇs(t)2 ,
(cid:19)

(cid:18) ˇs(t)
s(t)

.

φ(t) = arctan

Therefore,

(3.13)

(3.14)

s(t) = a(t) cos φ(t)

(3.15)

is established. Only when the signal s(t) is monochro-
matic over short periods of time, z(t) is an analytic signal
of s(t), in other words, the Fourier components of z(t) are
the same as s(t) in the positive frequency range, and zero
in the negative frequency range [38], and then a(t) and
φ(t) are called instantaneous amplitude (IA) and instan-
taneous phase (IP) of s(t), respectively. The monochro-
maticity of s(t) over short periods of time means that
a(t) has only lower frequency components than cos φ(t),
or a(t) and cos φ(t) are the modulator and the carrier of
the signal s(t), respectively. In that case, the local mean
m(t) of s(t), which is deﬁned by

m(t) =

u(t) + l(t)
2

,

(3.16)

where u(t) and l(t) are the upper and lower envelopes
of s(t), respectively, is zero at any point. We call this
feature zero-mean. An instantaneous frequency (IF) of
s(t) is deﬁned by

f (t) =

1
2π

dφ(t)
dt

.

(3.17)

This analysis to estimate the IA and IF from a signal
is called the Hilbert spectral analysis (HSA). The HSA
has an advantage of higher resolution than the other
time-frequency analysis such as the short-time Fourier
transform and the Wavelet transform. However, it can-
not be applied to most real-world signals, because they
are basically composites of some components and are not
monochromatic. Huang et al. [32] overcame the diﬃculty
by combining a mode decomposition part with the HSA,
and the method of combination of them is the HHT.

Huang et al. developed a method to decompose an
input data x(t) into zero-mean components and a non-
oscillatory component. They named the method em-
pirical mode decomposition (EMD) and also named the

6

decomposed zero-mean components intrinsic mode func-
tions (IMFs) of the input data. Algorithm 1 shows the
procedure of the EMD, where ci(t) and r(t) are the ith
IMF and a non-oscillatory component of x(t), respec-
tively. The ﬁrst step is forming the upper envelope ui,j(t)
and the lower envelope li,j(t), connecting the maxima
and the minima of the data by cubic splines. Then, the
mean mi,j(t) of these envelope is subtracted from the in-
put data to obtain the residual xi,(j+1). When the mean
mi,j(t) becomes approximately zero after several itera-
tions, xi,j is adopted as the IMF ci(t), since it can be
considered to be zero-mean. This criteria (cid:15)e is a param-
eter of the EMD. After all oscillatory components are
extracted, the residual r(t) is a non-oscillatory compo-
nent of x(t). Letting NIMF be the number of IMFs of
x(t), x(t) is recovered by

x(t) =

NIMF(cid:88)

n=1

cn(t) + r(t) .

(3.18)

IMFs, c1(t), c2(t), . . . , cNIMF(t), are in order from the
highest to the lowest frequency components. After the
above decomposition, the IA and IP of each IMF can be
estimated by the HSA. Consequently, letting an(t) and
φn(t) be the IA and IP of nth IMF, the data can be
expressed as

x(t) =

NIMF(cid:88)

n=1

an(t) cos φn(t) + r(t) .

(3.19)

Algorithm 1 Empirical mode decomposition

j = 1, xi,1(t) = xi(t)
while the local mean of xi,j(t) is not zero do
ui,j(t) = (the upper envelope of xi,j(t)).
li,j(t) = (the lower envelope of xi,j(t)).
mi,j(t) = (ui,j(t) + li,j(t))/2.
xi,(j+1)(t) = xi,j(t) − mi,j(t).
j = j + 1

1: i = 1, x1(t) = x(t).
2: while xi(t) contains oscillatory components do
3:
4:
5:
6:
7:
8:
9:
10:
11:
12:
13:

end while
ci(t) = xi,j(t)
xi+1(t) = xi(t) − ci(t).
i = i + 1.

14: end while
15: r(t) = xi(t)

In this study, we used the ensemble EMD (EEMD) as
the mode decomposition method.
In the beginning of
the EEMD, Ne white noises {w(m)(t)} with the standard
deviation being σe are created, and then the IMFs of the
noise-added data x(m)(t) = x(t) + w(m)(t) are calculated
by the EMD:

x(m)(t) = x(t) + w(m)(t)
NIMF(cid:88)

=

n (t) + r(m).
c(m)

n=1

(3.20)

(3.21)

The IMFs of an input data x(t) are estimated as the
mean of the corresponding IMFs of {x(m)(t)}:

The optimal N is determined as the transition point of a
slope of N –e(N ) plot:

7

cn(t) =

1
Ne

Ne(cid:88)

m=1

c(m)
n (t).

(3.22)

The EEMD has two parameters (σe, (cid:15)e). σe is a standard
deviation of added white noise, and (cid:15)e is a convergence-
condition constant. The details of EEMD is shown in
Refs. [36, 39].

The basic concept of HHT for the QNM is as follows.
If the QNM is perfectly extracted in the jth IMF, the IA
and IP of the IMF must be expressed by

aj(t) = Ae−(t−t0)/τ ,
φj(t) = 2πfR(t − t0) + φ0 .

(3.23)
(3.24)

Therefore, we can estimate the QNM frequency by ﬁtting
the IA and IP individually.

In reality, the IMF also contains other modes before
the QNM starts, and noise components become dominant
after the QNM is suﬃciently damped. Equations (3.23)
and (3.24) do not hold in the merger phase and the noise-
dominant segment. Therefore, to estimate the QNM fre-
quency with Eqs. (3.23) and (3.24), we need to estimate
the segment where IA and IP most properly ﬁts the equa-
tions. We constructed a method to estimate the segment,
named QNM-dominant segment (QDS), and the QNM
frequency [37]. In the method, a bandpass ﬁlter, whose
higher cutoﬀ frequency is properly conﬁgurated, will be
applied as a preprocessing to extract a QNM into the 1st
IMF.

2. QDS estimation

Here, we brieﬂy describe how to estimate QDS
[ˆn0, ˆn0 + ˆN ]. Note that we represent discrete sequences
with brackets, such as t[n] and a1[n]. Assuming the QNM
is extracted in the 1st IMF, and its merger time t[nm] is
known, we ﬁrst search for the longest segment [nb, ne]
after nm where the a1[n] decreases monotonically. For
every possible subsegments [n0, n0+N ] of [nb, ne], where
Nmin ≤ N ≤ ne − nb, we calculate root mean squared
errors RMSE(n0, N ) of ﬁtting ln a1[n] with bt[n] + c:

RMSE(n0, N ) = min
b,c

(cid:118)
(cid:117)
(cid:117)
(cid:116)

1
N

n0+N −1
(cid:88)

(ln a1[n] − bt[n] − c)2 .

n=n0

(3.25)

We set Nmin to 5, the same conﬁguration with Ref. [37].
The optimal n0 for each N is determined by

ˆn0(N ) = argmin

n0

RMSE(n0, N ) ,

(3.26)

and we deﬁne e(N ) as

e(N ) = RMSE(ˆn0(N ), N ) .

(3.27)

ˆN = argmin

N

[Err(Nmin, N ) + Err(N + 1, ne − nb)] ,

(3.28)

where Err(N1, N2) is an error of the ﬁtting e(N ) with
aN + b:

Err(N1, N2) = min
a,b

(cid:115) (cid:80)N2

N =N1

(e(N ) − aN − b)2
N2 − N1

.

(3.29)

Consequently, by letting ˆn0 = ˆn0( ˆN ), the QDS [ˆn0, ˆn0 +
ˆN ] is estimated. Then, the QNM frequency fqnm can be
estimated by ﬁtting the IA and IP with Eqs. (3.23) and
(3.24) in the QDS.

3. Method

Here, we brieﬂy explain the whole method to estimate
QNM frequency from observed strain data h[n]. The out-
line of the method is described in Algorithm 2.

First, we have to determine a candidate sets F , E,
Σ, which are sets of a higher cutoﬀ frequency fH of a
bandpass ﬁlter, a convergence criteria (cid:15)e of the EEMD,
and a standard deviation σe of the added-noise in the
EEMD, respectively.
In this study, we determined the
sets as follows:

F = {220, 225, 230, . . . , 500} Hz,
E = {1 × 10−1, 4 × 10−2, 2 × 10−2, . . . , 1 × 10−3} .

(3.30)

(3.31)

Σ = {1 × 10−3, 4 × 10−4, 2 × 10−4, . . . , 1 × 10−5} ,

(3.32)

and fL is set to 20 Hz. For each parameter candidates
(fH, (cid:15)e, σe), a series of processing, including a bandpass
ﬁlter with cutoﬀ frequency (fL, fH), the HHT and the
search of QDS, is applied to the input strain data h[n].
After that, the optimal set of the parameters will be
selected under an objective function O. We used the
slope of the linear function obtained by ﬁtting f1[n] in
the range of the searched QDS as the objective function
O, since the IF must be ﬂat in the QDS if a QNM is
properly extracted.

D. Autoregressive modeling (AR) method

1. Basic idea

Autoregressive (AR) method is well-known time-
sequence analysis method which are used in, e.g., acoustic
signal processing [40]. Suppose we have the signal data
of a segment, xn = x(n∆t), (n = 1, 2, · · · , N ). The main

Algorithm 2 Estimation method of the QNM
frequency with the HHT
Require: Strain h[n] contains a BBH signal and merger time

tm is known

1: for all (fH, (cid:15)e, σe) ∈ F ⊗ E ⊗ Σ do
2:

h[n] → hﬁltered[n]:

3:

4:

5:

apply a bandpass ﬁlter with cutoﬀ freq. (fL, fH)

hﬁltered[n] → a1[n], φ1[n]:

apply the HHT with parameters ((cid:15)e, σe).

[ˆn0, ˆn0 + ˆN ]:

search the QNM dominant segment (QDS) in a1[n]

ˆfqnm(fH, ˆ(cid:15)e, ˆσe):

estimate the QNM freq. by ﬁtting a1[n] , φ1[n] in

the QDS

6: end for
7: ( ˆfH, ˆ(cid:15)e, ˆσe) = argmin
fH,(cid:15)e,σe

O(fH, ˆ(cid:15)e, ˆσe):

select the set of the parameters that optimizes an ob-

jective function O.
8: ˆfqnm = ˆfqnm( ˆfH, ˆ(cid:15)e, ˆσe):

the value of the selected combination is the estimated

value of this method.

idea is to express the signal xn with its previous M (< N )
data,

xn =

M
(cid:88)

j=1

ajxn−j + ε ,

(3.33)

where aj and M are the coeﬃcients and the order of
AR model, respectively, and ε is the residual treated as
white-noise in this modeling. If the data xn is damped
sinusoidal wave without noise, then we analytically can
express xn with M = 2. Even when the data includes
noise, we expect to extract the actual signals by tun-
ing N and M . There are various methods proposed to
determine aj and M . In this article, we present the re-
sults using Burg method for aj and ﬁnal prediction error
(FPE) method for M . The details and other trials are in
Ref. [41].

Once the model (3.33) is ﬁxed, we then reconstruct
wave signal from Eq. (3.33) and analyze it. By setting
z(f ) = e2πif ∆t, the power spectrum of the wave signal
can be expressed as

p(f ) = σ2

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

1 −

M
(cid:88)

j=1

ajz−j

−2

,

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

(3.34)

where σ is the variance of ε. The resolution of frequency
in Eq. (3.34) is not limited by the length of the original
data set, so that AR method is expected to identify sig-
nal frequency more precisely than the standard (short-)
Fourier decomposition.

From Eq. (3.33), the (local) maximums of the spec-

8

trum, p(f ), are given at

F (z) = 1 −

M
(cid:88)

j=1

ajz−j ≈ 0.

(3.35)

This is a M -th order polynomial equation. The solu-
tions of the characteristic equation, F (z) = 0, also ex-
press the fundamental modes which consist the data seg-
ment. By interpreting the M solutions as zk = e2πifk∆t
(k = 1, · · · , M ), we get the fundamental frequencies from
the real part of fk, and damping rates from the imaginary
part of fk. (Actually, |zk| ≤ 1 is expected for the expres-
sion (3.33) to be stable.) Therefore, AR method can
determine the frequencies and damping rates of quasi-
normal modes from the data themselves.

2. Method

We divided the given mock data into segments of the
length of ∆T = 1/128 sec (N = 32). The neighboring
segments are largely overlapping shifted only by 4 points.
For each segment, we modeled the data with Eq. (3.33)
with Burg and FPE methods. Normally M falls into the
range 2–5.

We then get the power-spectrum p(f ) from Eq. (3.34)
at each segment, and locate its local maximums f1, f2, · · ·
with their one-sigma widths. We also solve Eq. (3.35) at
each segment (which is at most 5-th order polynomial
equation), and identify the solution zk of which real part
of frequency is the closest to f1, f2, · · · .

We list these solutions zk of each segment, and check
whether they remain almost unchanged over several seg-
ments.
If the successive segments has a common fre-
quency mode within one-sigma width, then we make a
short list as the candidates for ring-down modes.

We see sometimes a segment is full of noises and shows
quite diﬀerent numbers from neighboring segments. Most
cases, however, after the time of black hole merger, we
can identify one common frequency which overlaps within
one-sigma width for several data segments.

E. Neural network (NN) method

1. Convolutional Neural Network

In this challenge, we use a “convolutional neural net-
work” (CNN) which can extract local patterns of the
data. CNNs are often used for the image recognition
and we expect CNNs can be applied to the GW data
analysis [42]. We try various CNNs which have diﬀerent
structure, layers, neurons and ﬁlters. The ﬁnal conﬁgu-
ration of the CNN which is used here is shown in Table I.
In general, the input and output data of a convolu-
tional layer have multi channel. The data with multi
channel have multi values in each pixel (e.g., RGB com-
ponents of images). In a convolutional layer, convolutions

of the data containing L channels and the L(cid:48) ﬁlters h,

z(cid:48)
i,l(cid:48) =

L
(cid:88)

H
(cid:88)

l=1

p=1

zi+p,lhl

p,l(cid:48) + bi,l(cid:48) ,

(3.36)

are calculated to extract the local patterns. Here, z and
z(cid:48) are the input and output vectors of the layer, respec-
tively. The number and the length of the ﬁlters, L(cid:48) and
H, are ﬁxed before training and the coeﬃcients h and
biases b are optimized in the training procedure. In this
work, we use four convolutional layers. The lengths of
the ﬁlters are 32, 16, 8, 8, and the numbers of the ﬁlters
are 64, 128, 256, 512, respectively.

A pooling layer, often placed after a convolutional
layer, compresses information, combining a few pixels
into one pixel. In this work, we use the max pooling,

z(cid:48)
i = max

k=1,...,p

zsi+k .

(3.37)

Here, s is the stride, and p is the size of the pooling ﬁlter.
We set s = p = 2.

In most cases, dense layers, which are linear transfor-

mations,

z(cid:48)
i =

N
(cid:88)

j=1

wijzj + bi ,

(3.38)

with N being the number of input values, are located
after convolutional layers. The weights w and biases b
are optimized in training.

An activation function plays an important role to carry
out nonlinear transformations. In this work, we use the
rectiﬁed linear unit (ReLU),

z(cid:48) = h(z) = max(z, 0) ,

(3.39)

as activation functions.

For an accurate estimation, weights and biases in dense
layers and ﬁlters in the convolutional layers need to be
optimized using training data.
In the case of super-
vised learning, each training data is a pair of input data
and a target vector. In our work, the input data is the
time series of a gravitational wave signal with noise and
the target vector is composed of the QNM frequency,
(f (inj)
). For an input, the neural network returns
an estimated vector (f (pred)
, f (pred)
) and compares it
I
with a target vector. The loss function is computed to
evaluate the error between the estimated and target vec-
tors. In batch learning, a group of data, called “batch”
with its size Nb ﬁxed before training, is used to deﬁne the
loss function. As the loss function, we adopt the mean
relative error,

R , f (inj)

R

I

J =

1
Nb

Nb(cid:88)

(cid:88)

n=1

A∈{R,I}

|f (pred)

n,A − f (inj)
n,A |
f (inj)
n,A

(3.40)

We set Nb = 64. As an optimization method, we use the
Adam (Adaptive Moment Estimation) [43]. The hierar-
chical training, proposed in Ref. [42], is adopted. The

9

TABLE I: The conﬁguration of the CNN we use. (x, y) means
that the data each layer returns has x points and y channels.
Each input data has only 1 channels, h+, which are composed
of 512 points. A ”Flatten” layer reshapes a 2-dimensional
data to a 1-dimensional data.

layer dimension
Input
Conv

(512, 1)
(481, 64)
Pooling (240, 64)
ReLU (240, 64)
Conv (225, 128)
Pooling (112, 128)
ReLU (112, 128)
Conv (105, 256)
Pooling (52, 256)
ReLU (52, 256)
(45, 512)
Conv
Pooling (22, 512)
ReLU (22, 512)
Flatten 16×512
Dense
ReLU
Dense
Output

256
256
2
2

training starts from using the injected data whose peak
SNR [48] is 20.0 and gradually decreasing the peak SNR.
At the ﬁnal stage of training, we use the signal of which
peak SNR is ranged from 10.0 to 3.0.

We use the PyTorch [44]. For accelerating learning
with NVIDIA GPU, we employ the CUDA deep neural
network library (cuDNN) [45].

2. Training Dataset

First, we construct the template bank for the training
using the modiﬁed waveform which is based on the same
method as Eqs. (2.14) and (2.16). For template bank, fR
and fI are uniformly placed in the range 209–378 Hz and
23–69 Hz. The template bank contains 21×21 waveforms.

Next, each waveform is whitened using the aLIGO’s de-
sign sensitivity (aLIGOZeroDetHighPower). From each
signal, we pick up the segment that consists of 512 points
starting from the coalescence time. And these whitened
waveforms are injected into the white Gaussian noises.
The realization of noises are varied for each training step
in order to prevent that the neural network is overﬁtted
with some particular noise patterns. Finally, we normal-
ize each segment to have mean 0.0 and variance 1.0.

IV. COMPARISON AND SUMMARY

1. Overview

We prepare 120 mock data in total by using the method
described in Sec. II B. A half of them are generated using
Eqs. (2.10) and (2.12), and the others are generated using
Eqs. (2.14) and (2.16). We refer to the former as set A
and the latter as set B. For both sets, we generated 20
mock data, respectively, with overall SNR, ρall = 60, 30
and 20. The SNR for the ringdown part, ρrd, turned out
to be roughly 1/5 ∼ 1/3 of ρall. We listed the details of a
part of mock data in Table II. We calculated ρrd by the
standard inner product for the injected waveform after
the peak of the amplitude without noise.

I

R , f (inj)

The ﬁve challenging groups received 120 data-ﬁles of
h(t), together with rough information of the merger time,
t0, for each data, but not with the frequency of the in-
jected ringdown waveform, (f (inj)
). The mock data
itself is provided with both + mode and × mode, but
this time we used only + mode. Since (f (inj)
) are
randomly shifted from the values in general relativity, the
challengers cannot use the information of inspiral part for
their estimation of (fR, fI). Some methods (MF-R/MR,
AR) can derive the estimation value (fR, fI) with their
error bars, while some (HHT, NN) cannot. Therefore
we simply compare the results of the estimated (central)
values.

R , f (inj)

I

2. Results and Comparison

For 120 data, each challenging group handed in (fR, fI)
as the result of their blind analyses. In order to compare
ﬁve methods, we introduce the logarithmic average and
variance deﬁned by

δ log Q =





σ(Q) =

(cid:32)

log

(cid:32)

log

1
N

1
N

N
(cid:88)

n=1

N
(cid:88)

n=1

Q(estimate)
n
Q(inj)
n

(cid:33)

,

Q(estimate)
n
Q(inj)
n

1/2

(cid:33)2


, (4.1)

as indicators of the bias and the average magnitude of
the parameter estimation error, where Q(estimate)
is the
estimated value of the quantity Q for the nth data and
Q(inj)
is the corresponding injected values. In Table III,
n
we show the values of δ log fR, σ(fR), δ log fI and σ(fI)
for the methods we tried. We show the results limited to
set A on the ﬁrst law and those limited to set B on the
second law.

n

We should recall that in the actual implementation of
the MF-MR described in Sec. III B we adopt the same
modiﬁed template that is used to generate the set B mock
data. Also, the NN method introduced in Sec. III E uses
the template bank generated in the same way as the set
B mock data to train the network.

10

TABLE II: A partial list of mock data. Set A was gen-
erated using Eqs. (2.10) and (2.12), while set B was from
Eqs. (2.14) and (2.16). The overall SNR ρall, SNR of the
ringdown part ρrd, and injected value of the ringdown wave-
form (f (inj)

) are shown.

R , f (inj)
data

I

SNR
ρrd
11.87
12.82
13.31
12.49
14.25
6.18
6.07
6.05
6.75
6.08
4.59
3.85
4.01
3.98
4.09
15.93
15.62
15.31
18.34
15.92
8.55
6.78
7.03
7.68
7.81
5.79
5.76
4.46
5.62
5.99

ρall
60.0
60.0
60.0
60.0
60.0
30.0
30.0
30.0
30.0
30.0
20.0
20.0
20.0
20.0
20.0
60.0
60.0
60.0
60.0
60.0
30.0
30.0
30.0
30.0
30.0
20.0
20.0
20.0
20.0
20.0

injected

f (inj)
f (inj)
R
I
260.68 44.58
345.16 50.49
382.53 32.58
284.18 44.73
346.20 23.07
272.85 33.40
272.85 44.54
301.89 42.24
324.60 27.25
282.55 37.45
314.24 30.58
382.10 48.60
249.36 47.97
299.32 41.88
319.42 31.55
352.56 36.20
210.78 42.77
258.83 48.42
271.13 25.40
291.99 34.20
411.57 29.48
295.78 59.38
312.39 59.24
198.34 57.91
323.32 37.86
208.80 39.75
246.66 27.85
323.71 62.51
215.15 33.15
335.20 25.11

A-01
A-02
A-03
A-04
A-05
A-06
A-07
A-08
A-09
A-10
A-11
A-12
A-13
A-14
A-15
B-01
B-02
B-03
B-04
B-05
B-06
B-07
B-08
B-09
B-10
B-11
B-12
B-13
B-14
B-15

The error of MF-R using the simple damped sinusoidal
waveform is relatively large as expected. In fact, the er-
ror of the estimates of fR and fI are the largest among
ﬁve methods. The results of HHT method are not so
good, either. At least, the current way of using MF-R
or HHT for the estimate of imaginary part of QNM fre-
quency does not seem to be competitive compared with
the other methods. The performances of the other three
methods, i.e., MF-MR, AR and NN methods, are almost
comparable for the imaginary part, while the determina-
tion of the real part by AR looks better than the other
two methods. Here we should recall that the comparison
with MF-MR and NN is not fair in the case of the set
B mock data, since their base templates are constructed
from the set B data. The results of MF-MR and NN are

TABLE III: We show the values of δ log fR, σ(fR), δ log fI and
σ(fI) for various methods. The results limited to set A are
given on the ﬁrst law of each method while those limited to
set B on the second.

HHT

MF-R A
B
MF-MR A
B
A
B
A
B
A
B

NN

AR

δ log fR(%)

σ(fR)(%)

δ log fI(%)

σ(fI)(%)

-12.88
-0.82
6.25
2.47
-13.38
-8.08
0.2
1.91
-6.64
-6.65

28.36
27.53
17.27
10.41
21.91
19.81
9.93
8.57
16.48
11.97

-71.51
-46.11
-12.62
7.18
-44.11
-28.78
4.88
6.2
-15.23
9.96

97.79
75.48
37.9
27.61
61.58
49.61
38.75
34.64
33.96
23.76

better for set B, as expected.

The variance might be determined by a small number
of data with a large error. To check if it is the case or
not, we give plots of the absolute magnitude of the error
| log(Q(estimate)
)| sorted in the ascending order for
n
each method in Fig. 2. Although the number of data
is small, these ﬁgures tell that the tendencies mentioned
above are not the ones that hold only for the data with
a large error.

/Q(inj)
n

To show how the errors depend on SNR, we present
several plots of the averaged values within each level of
SNR, high, middle and low, i.e., ρall = 60, 30 and 20. The
variances of the diﬀerences δ log fR = log fR − log f (inj)
R ,
and δ log fI = log fI − log f (inj)
are shown in Fig. 3, re-
I
spectively. The solid lines denote the results for the real
part while the dashed lines those for the imaginary part.
The estimations of fI are generally about 0.5-order worse
than those of fR. This tells us the diﬃculty of identify-
ing the damping rate. As expected, the diﬀerences are
smaller for larger ρall, with some exceptions. The main
message we can read from Fig. 3 combined with Table II
is that we would be able to estimate fR within 7% (8 %)
from the injected value for the data ρrd ∼ 15 (8), if we
adopt an appropriate method. On the other hand, the
estimate of fI has an error at least of O(30%) even for
the data with ρrd ∼ 15.

The averages of δ log fR and δ log fI are also shown
in Fig. 4. For all ﬁve methods, we see the estimated
values of fR are roughly distributed around the injected
R , while there are some tendencies that f (inj)
one f (inj)
is
over or underestimated, depending on the method. These
results would be suggestive in the interpretation of the
future application of each method to real data.

I

11

3. Error estimate

MF-MR and AR methods give the error estimates as
explained in Sec. III. The consistency of these error esti-
mates is brieﬂy checked below.

In the case of MF-MR method for set B data, the ex-
pected result is obtained. Namely, there are 120 guesses
in the present test (60 real parts and 60 imaginary parts).
The 90% conﬁdence interval is given by cutting 5% prob-
ability regions on both small and large value sides. This
estimate of the conﬁdence interval just take into account
the statistical error. The true value fell outside of the
conﬁdence interval 27 times out of 120. This is slightly
worse than the expectation. The estimate of the conﬁ-
dence interval may need modiﬁcation. For set A data,
this happened 45 times, which means that the contribu-
tion of the systematic bias is signiﬁcantly large.

For AR method, the true value becomes outside the
90% conﬁdence interval 21 times out of 120 guesses for
the imaginary part while it happened 51 times for the
real part.

V. CONCLUDING REMARKS

We implemented ﬁve methods for extracting ringdown
waves solely, and tested them with mock data by a
method of “blind analysis”.

Comparison tells that AR method, which can pick up
the frequency of ringdown wave fR with 10% root mean
square diﬀerence from the injected one for the SNR of
the ringdown part greater than 7 or so, showed the best
performance in determining the real part. AR method
is superseded by NN or MF-MR method for Set B data
with high SNR of the ringdown part greater than 12 or
so. The same template as the Set B data is used as the
training data for NN method and as the template to be
matched for MF-MR method. On the other hand, the
imaginary part of the frequency fI (related to the damp-
ing period) is rather diﬃcult to determine, and AR, NN
and MF-MR methods showed comparable performance.
The data tells that the root mean square diﬀerence of
fI from the injected one for high SNR data can be less
than about 30%, although the result would apply only
in modiﬁcations of the ringdown waveform limited to the
one smoothly connected to the merger phase. We believe
that the possibility and the limitation of independent es-
timation of ringdown mode was shown in this paper, and
this opens a way of testing gravity theories.

When the error circles derived by using some combina-
tion of several methods are overlapping, we might be able
to more conﬁdently claim that the QNM frequency is de-
termined by the observational data. However, currently
only two of our analysis methods (MF-MR, AR) reported
error circles, and the estimated error circles also contain
some errors. Once we have various methods whose er-
ror estimate is reliable, there might be a possibility to
combine the estimates properly.

12

(a) Real part for Set A

(b) Real part for Set B

(c) Imaginary part for Set A

(d) Imaginary part for Set B

FIG. 2: Plots of the base 10 logarithm of the error in the estimate for each test data. The data number is sorted for each
method in the ascending order of the magnitude of the error.

Through the mock data challenges, we also learned the

directions of further improvements of each methods.

since the instantaneous frequency of the QNM is
constant.

• The MF methods do not have much room for fur-
ther improvement. As for MF-MR, one possible ex-
tension is to adopt a little wider class of templates
which depend on parameters other than the QNM
frequency. However, the preliminary trial calcula-
tions suggest that the extension in this direction
will not be so successful.

• The AR method, presented here, used the Burg
method for ﬁtting data and ﬁnal prediction error
method for ﬁxing length of data sequence. We
think that it will be interesting to compare with
similar but slightly diﬀerent approaches, such as
those proposed by Berti et al. [14].

• In the HHT method, there exists the mode-splitting
problem of the EMD [46]. We are planning to re-
solve the problem by taking into account the spar-
sity in the frequency domain to the EMD. It may
improve the accuracy of the extraction of a QNM

• First, the neural network is trained with waveforms
generated by the same method as the set B. So,
the results for the set A seems to contain bias in
high SNR regime. The improvement of the training
algorithm or preparing the dataset will reduce the
bias. Second, the NN method can give only the
central value for the current estimation. We need
to ﬁnd a method to estimate the prediction errors.

After implementations of such improvements, we are
planning to apply our methods to the real GW data, to
discuss the validity of general relativity.

Acknowledgments

This research made use of data generated by the Simu-
lating eXtreme Spacetimes. This work was supported by
JSPS KAKENHI Grant Number JP17H06358 (and also

13

(a) Both Set A and B

(b) Set A only

FIG. 3: The root mean square error in percent of each method for three levels of SNR. The solid and dashed lines represent
the real and imaginary parts, respectively.

(c) Set B only

JP17H06357), A01: Testing gravity theories using gravi-
tational waves, as a part of the innovative research area,
“Gravitational wave physics and astronomy: Genesis”.
H. N. acknowledges support from JSPS KAKENHI Grant
No. JP16K05347. T. N.’s work was also supported in
part by a Grant-in-Aid for JSPS Research Fellows. H. S.

acknowledges also supports from JSPS KAKENHI Grant
Nos. JP18K03630 and 19H01901. H. T. acknowledges
support from JSPS KAKENHI Grant No. JP17K05437.
T. T. acknowledges support from JSPS KAKENHI Grant
Nos. JP26287044 and JP15H02087.

[1] B. P. Abbott et al. [LIGO Scientiﬁc and Virgo Col-
laborations], Phys. Rev. Lett. 116, 061102 (2016)
[arXiv:1602.03837 [gr-qc]].

[2] B. P. Abbott et al. [LIGO Scientiﬁc and Virgo Col-
laborations], Phys. Rev. Lett. 116, 241103 (2016)
[arXiv:1606.04855 [gr-qc]].

[3] B. P. Abbott et al. [LIGO Scientiﬁc and Virgo Col-
laborations], Phys. Rev. Lett. 118, 221101 (2017)
[arXiv:1706.01812 [gr-qc]].

[4] B. P. Abbott et al. [LIGO Scientiﬁc and Virgo Collabora-
tions], Astrophys. J. 851, L35 (2017) [arXiv:1711.05578
[astro-ph.HE]].

[5] B. P. Abbott et al. [LIGO Scientiﬁc and Virgo Col-
laborations], Phys. Rev. Lett. 119, 141101 (2017)
[arXiv:1709.09660 [gr-qc]].

[6] B. P. Abbott et al. [LIGO Scientiﬁc and Virgo Col-
laborations], Phys. Rev. Lett. 119, 161101 (2017)
[arXiv:1710.05832 [gr-qc]].

[7] B. P. Abbott et al. [LIGO Scientiﬁc and Virgo Collabo-

rations], arXiv:1811.12907 [gr-qc].

[8] B. P. Abbott et al. [LIGO Scientiﬁc and Virgo Collabo-

rations], arXiv:1811.12940 [gr-qc].

[9] T. Akutsu et al. (KAGRA Collaboration) Nature Astron-

omy, 3 (2019) 35.

14

FIG. 4: The averaged error in percent of each method for three levels of SNR. The solid and dashed lines represent the real
and imaginary parts, respectively.

[10] T. Akutsu et al. (KAGRA Collaboration), Class. Quant.

Grav. (2019) to be published, arXiv:1901.03569.

[11] B. P. Abbott et al. [LIGO Scientiﬁc, Virgo, and KAGRA

Collaborations], Liv. Rev. Rel. 21, 3 (2018).
Living Rev. Rel. 17,

[12] C. M. Will,

4

(2014)

[30] H. Nakano, H. Takahashi, H. Tagoshi and M. Sasaki,
Phys. Rev. D 68, 102003 (2003)
[gr-qc/0306082];
H. Nakano, H. Takahashi, H. Tagoshi and M. Sasaki,
Prog. Theor. Phys. 111, 781 (2004) [gr-qc/0403069].
[31] W. Del Pozzo and A. Nagar, Phys. Rev. D 95, 124034

[arXiv:1403.7377 [gr-qc]].

[13] E. Berti, J. Cardoso, V. Cardoso, and M. Cavagli´a, Phys.

Rev. D 76, 104044 (2007).

[14] E. Berti, V. Cardoso, J. A. Gonz´ales and U. Sperhake,

Phys. Rev. D 75, 124017 (2007) [gr-qc/0701086].

(2017) [arXiv:1606.03952 [gr-qc]].

[32] N. E. Huang, Z. Shen, S. R. Long, M. C. Wu, H. H. Shih,
Q. Zheng, N. C. Yen, C. C. Tung and H. H. Liu, Proc.
Roy. Soc. Lond. A, 454, 903–995 (1998).

[33] J. B. Camp, J. K. Cannizzo and K. Numata, Phys. Rev.

[15] T. Damour and A. Nagar, Phys. Rev. D 90, 024054

D 75, 061101 (2007) [gr-qc/0701148 [GR-QC]].

(2014).

[16] L. London, D. Shoemaker and J. Healy, Phys. Rev. D 90,

124032 (2014).

[17] E. Berti, V. Cardoso, and A. O. Starinets, Class. Quant.

Grav. 26, 163001 (2009) [arXiv:0905.2975].

[18] V. Cardoso and L. Gualtieri, Class. Quant. Grav. 33,

174001 (2016) [arXiv:1607.03133].

[19] E. Berti, K. Yagi, H. Yang and N. Yunes, Gen. Rel. Grav.

50, 49 (2018) [arXiv:1801.03587 [gr-qc]].

[20] http://www.oit.ac.jp/is/shinkai/
mockdatachallenge/index.html

[21] H. Nakano, T. Tanaka and T. Nakamura, Phys. Rev. D
92, 064003 (2015) [arXiv:1506.00560 [astro-ph.HE]].
[22] E. Berti, V. Cardoso and C. M. Will, Phys. Rev. D 73,

[34] A. Stroeer, J. K. Cannizzo, J. B. Camp and N. Gagarin,
[arXiv:0903.4616

Phys. Rev. D 79, 124022 (2009)
[physics.data-an]].

[35] H. Takahashi, K. Oohara, M. Kaneyama, Y. Hiranuma
and J. B. Camp, Adv. Adapt. Data Anal. 05, 1350010
(2013) [arXiv:1306.5365 [gr-qc]].

[36] M. Kaneyama, K. Oohara, H. Takahashi, Y. Sekiguchi,
H. Tagoshi and M. Shibata, Phys. Rev. D 93, 123010
(2016).

[37] K. Sakai, K. Oohara, H. Nakano, M. Kaneyama
and H. Takahashi, Phys. Rev. D 96, 044047 (2017)
[arXiv:1705.04107 [gr-qc]].

[38] L. Cohen, “Time Frequency Analysis: Theory and Ap-

plications” , Prentice-Hall (1995).

064030 (2006) [gr-qc/0512160].

[39] Z. Wu and N. E. Huang, Adv. Adapt. Data Anal. 01, 1

[23] http://www.phy.olemiss.edu/~berti/ringdown/
[24] A. H. Mroue et al., Phys. Rev. Lett. 111, 241104 (2013)

(2009).

[40] S. L. Marple, Jr, Digital Spectral Analysis (Prentice Hall,

[arXiv:1304.6077 [gr-qc]].

1987).

[25] https://www.black-holes.org/waveforms/
[26] K. Jani, J. Healy, J. A. Clark, L. London, P. Laguna and
D. Shoemaker, Class. Quant. Grav. 33, 204001 (2016)
[arXiv:1605.03204 [gr-qc]].

[27] http://www.einstein.gatech.edu/catalog/
[28] J. Healy, C. O. Lousto, Y. Zlochower and M. Campanelli,
Class. Quant. Grav. 34, 224001 (2017) [arXiv:1703.03423
[gr-qc]].

[29] https://ccrg.rit.edu/~RITCatalog/

[41] H. Shinkai, in preparation.
[42] D. George & E. A. Huerta, Phys. Rev. D 97, 044039

(2018) [arXiv:1701.00008 [astro-ph.IM]].

[43] D. P. Kingma & J. Ba, arXiv:1412.6980 (2014).
[44] P. Adam et al, in NIPS 2017 Workshop (2017).
[45] S. Chetlur et al. arXiv:1410.0759 (2014).
[46] J. Yeh, J. Shieh, and N. E. Huang, Adv. Adapt. Data

Anal. 02, 135 (2010).

[47] The Likelihood function would be deﬁned by the prob-

ability of the model parameters θ when a data D is
provided, P (θ|D). Using the Bayes’ theorem, we can
write P (θ|D) as P (θ|D) = P (D|θ)P (θ)
. When we as-
sume a ﬂat prior distribution, i.e., P (θ) =constant, we
have P (θ|D) ∝ P (D|θ). The probability that a data
D is described by a normalized template ˆh(θ) and the
noise n as ρˆh + n would be given by P (D|ρ, θ) ∝
exp[−(n|n)/2] = exp[−(D − ρˆh(θ)|D − ρˆh(θ))/2].
Marginalizing this probability with respect to ρ, we ﬁnd

P (D)

P (D|θ) ∝ exp[(D|ˆh(θ))2/2]. When we have some unfo-
cused extra parameters, we need to marginalize the prob-
ability over these extra parameters. Here the coalescence
time, the overall phase are such parameters. For the coa-
lescence time, we just adopt the maximum value, in place
of the marginalization, which we expect will not cause
any signiﬁcant error.

[48] The deﬁnition of peak SNR is

(peak SNR) =

(maximum amplitude of template)/(variance of noise).

15

