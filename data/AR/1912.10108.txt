JOURNAL OF LATEX CLASS FILES, VOL. 14, NO. 8, AUGUST 2015

1

AoA-aware Probabilistic Indoor Location
Fingerprinting using Channel State Information

Luan Chen, Iness Ahriz, and Didier Le Ruyet, Senior Member, IEEE

9
1
0
2

c
e
D
0
2

]
P
S
.
s
s
e
e
[

1
v
8
0
1
0
1
.
2
1
9
1
:
v
i
X
r
a

Abstract—With expeditious development of wireless commu-
nications, location ﬁngerprinting (LF) has nurtured considerable
indoor location based services (ILBSs) in the ﬁeld of Internet of
Things (IoT). For most pattern-matching based LF solutions, pre-
vious works either appeal to the simple received signal strength
(RSS), which suffers from dramatic performance degradation
due to sophisticated environmental dynamics, or rely on the ﬁne-
grained physical layer channel state information (CSI), whose in-
tricate structure leads to an increased computational complexity.
Meanwhile, the harsh indoor environment can also breed similar
radio signatures among certain predeﬁned reference points (RPs),
which may be randomly distributed in the area of interest, thus
mightily tampering the location mapping accuracy. To work
out these dilemmas, during the ofﬂine site survey, we ﬁrst
adopt autoregressive (AR) modeling entropy of CSI amplitude
as location ﬁngerprint, which shares the structural simplicity of
RSS while reserving the most location-speciﬁc statistical channel
information. Moreover, an additional angle of arrival (AoA)
ﬁngerprint can be accurately retrieved from CSI phase through
an enhanced subspace based algorithm, which serves to further
eliminate the error-prone RP candidates. In the online phase, by
exploiting both CSI amplitude and phase information, a novel
bivariate kernel regression scheme is proposed to precisely infer
the target’s location. Results from extensive indoor experiments
validate the superior localization performance of our proposed
system over previous approaches.

Index Terms—Internet of things, location ﬁngerprinting, chan-

nel state information, entropy, angle of arrival.

I. INTRODUCTION

nication and ubiquitous computing,

W ITH the wide-scale proliferation of wireless commu-

indoor location
based service (ILBS) has emerged as a key enabler for myriad
cutting-edge applications in the domain of Internet of Things
(IoT) [1]–[4]. Such examples include autonomous navigation
for visually-impaired individuals, logistic monitoring in smart
warehouse, proximity marketing at commercial hub, intruder
tracking in sensitive facilities, etc.. Due to the pervasive
availability and the low-cost deployment, Wi-Fi based location
awareness stands out as one of the most appealing solutions
in lieu of many other wireless techniques, e.g., Bluetooth
[5], radio frequency identiﬁcation (RFID) [6], ultrasound [7],
infrared [8], visible light [9] and so forth. In general, con-
ventional Wi-Fi based indoor positioning systems (IPS) either
adopt geometric mapping approach or resort to location ﬁnger-
printing (LF) [10]. For geometric mapping, spatial properties
like time of ﬂight (ToF) [11] or angle of arrival (AoA) [12]

The authors are with CEDRIC/LAETITIA Laboratory, Conservatoire Na-

tional des Arts et M´etiers (CNAM), 75003 Paris, France.

Luan Chen is also with School of Electronic Information, Wuhan University,

430072 Wuhan, China. (e-mail: luan.chen@whu.edu.cn).

are ﬁrst derived from physical communication signals. Target’s
position determination is then conducted through geometric
algorithms (e.g., trilateration or triangulation), which however
heavily rely on the line-of-sight (LoS) condition. This makes
geometric mapping less eligible for the sophisticated indoor
environment with rich hindrances and room partitions. As an
emerging alternative for indoor positioning, location ﬁnger-
printing beneﬁts from a pattern-matching mechanism, which
comprises ofﬂine training phase and online location estimation
phase. Speciﬁcally, in the ofﬂine phase, wireless signatures are
collected at a set of geo-tagged reference points (RPs) in the
area of interest to construct the ﬁngerprint database (a.k.a.
radio map). During the online phase, the measured signature
at an unknown position is matched with the ofﬂine radio map
to return the best-ﬁtted location estimation.

Although the mainstream Wi-Fi ﬁngerprinting systems take
the simple received signal strength (RSS) as the indicator of
medium access control (MAC) layer’s link quality, it suffers
dramatic performance degradation due to small-scale multipath
fading and temporal dynamics indoors. In virtue of the break-
through technology of multiple-input multiple-output orthogo-
nal frequency division multiplexing (MIMO-OFDM) in IEEE
802.11 n/ac standard, the ﬁne-grained physical (PHY) layer
channel state information (CSI) is capable of depicting the
channel characterization for each transmit-receive (TX-RX)
antenna pair on the level of multiple orthogonal subcarriers
[10], [13]. Different from coarse-grained RSS, CSI captures
the amplitude attenuation and phase shift of every subcarrier
and thus can serve as a preferable geo-signature to bring richer
location-speciﬁc information for numerous Wi-Fi ﬁngerprint-
ing systems.

In principle, Wi-Fi ﬁngerprinting algorithms can be cate-
gorized into deterministic and probabilistic ones [3]. Deter-
ministic approaches enjoy the easy implementation but fail to
fully exploit environmental ﬂuctuations, which consequently
renders the location estimation error-prone. In contrast, prob-
abilistic methods embrace the channel variation by inferring
a signal distribution based statistical model, thus obtaining
more robust and accurate positioning performance than its
deterministic adversary. Nevertheless, there still exists three
underlying challenges for probabilistic Wi-Fi ﬁngerprinting
systems: (i) The accurate approximation of probability dis-
tribution function (PDF) is largely driven by massive storage
of signal measurements [14], which in turn brings huge system
burden and computational requirement. (ii) Most probabilistic
location-aware solutions are well established on the assump-
tion of Gaussian-distributed measurements [15], [16]. How-
ever, due to the complex nature of indoor environment and the

 
 
 
 
 
 
JOURNAL OF LATEX CLASS FILES, VOL. 14, NO. 8, AUGUST 2015

2

imperfection of wireless devices, some practical measurements
appear to be non-Gaussian distributed or even do not ﬁt
any known distribution [17]–[19]. This then complicates the
ﬁngerprinting process and incurs severe ambiguity for location
estimation. (iii) When it comes to multivariate ﬁngerprint
structure (e.g. multi-subcarrier CSI), traditional probabilistic
methods turn powerless since existing statistical tools only
work for measurements with identiﬁable distributions [20].
Accordingly, it would be highly desirable for a ﬁngerprint
which shares the simplicity of RSS (scalar) and meanwhile
conserves rich statistical location-speciﬁc information.

To address the aforementioned substantial challenges, in
this paper, we resort to autoregressive (AR) modeling based
Shannon entropy metric [21], which equals a direct transfor-
mation from the original PDF of CSI amplitudes. Unlike tradi-
tional data-adaptive histogram estimator which entails a slow
convergence rate, AR modeling approach provides a feasible
parametric workaround to accurately infer the PDF in the form
of power spectral density (PSD) [22]. Despite its structural
simplicity, this novel entropy ﬁngerprint embodies the whole
statistical information of CSI amplitudes. Through extensive
experiments conducted in realistic testbeds, we demonstrate
that our proposed AR entropy metric outperforms its original
CSI or RSS ﬁngerprint [23]. However, since CSI phases
of one subcarrier are generally uniformly distributed [24],
this quantiﬁes each RP location with an equally maximized
entropy value (a.k.a. Gibbs’ inequality), thereby hampering
the location distinction to a great extend. How to properly
exploit CSI phase information in our entropy-based location
ﬁngerprinting system still remains open.

Inspired by the recent advancement of phased array signal
processing [12], leveraging AoA as supplementary ﬁngerprint
enables us to revisit CSI phase exploitation with a fresh
horizon. As illustrated in Fig. 1, our AoA embedded solution
adopts the methodological concept of the well-known k-
nearest neighbors (kNN) and unveils two heuristic insights:
(i) For some ofﬂine surveying receivers at the corresponding
RP positions, whether they are in the vicinity (blue ones) of
the online receiver (red one) or in the distance (green one),
their CSI measurements may share the similar entropy values.
(ii) These neighboring receivers also record the similar AoAs
from parallel incident paths with this online receiver, whether
it is for direct paths in LoS scenario or reﬂected paths in NLoS
condition. Hence, the remote receiver can be selectively ruled
out in accordance with the distinct AoA difference, which
further improves the location estimation accuracy.

On this basis, we design AngLoc, an AoA-aware proba-
bilistic indoor localization system using commercial off-the-
shelf Wi-Fi device. To remove the noisy component from
the raw CSI measurements, we ﬁrst introduce a power-based
tap ﬁltering scheme to preserve the most informative CSI
signatures. For the purpose of precise AoA estimation, a set
of phase calibration techniques are then employed to mitigate
dramatic phase drifts. Subsequently, for the ofﬂine radio map
construction, the pre-processed CSIs are simultaneously fed to
two independent ﬁngerprint generators, namely AR modeling
based entropy estimator for CSI amplitude and the enhanced
AoA-ToF estimator driven by joint angle and delay estimation

Fig. 1. An illustrative example of the system mechanism

multiple signal classiﬁcation (JADE-MUSIC) algorithm [25].
It is worth noting that ToF is utilized here to create measurable
phase shift across subcarriers, by which realizes virtual an-
tenna extension to overcome the antenna number restriction for
classical MUSIC algorithm [12]. The other trick of ToF here is
to identify the ﬁrst incoming path (not necessarily the direct
path) as the angular ﬁngerprint benchmark, which serves to
guarantee similar AoA recordings around closely-spaced RPs.
Moreover, in the online phase, due to the simple structure of
the radio map, the succinct Manhattan distance and Euclidean
distance can be fully competent as the similarity metrics for
AR entropy and AoA ﬁngerprints, respectively. Afterwards,
we propose an optimal bivariate kernel regression scheme
to accurately infer the target’s physical location. The entire
experiments are conducted on the lightweight HummingBoard
platform, which tremendously facilitates the time-consuming
and labor-intensive ﬁngerprinting implementation. Experimen-
tal results validate the superior performance of our proposed
system over previous location ﬁngerprinting approaches.

In a nutshell, the main contributions of this paper can be

laid out below:

• As far as we are aware of, this is the ﬁrst work to con-
structively incorporate angular signature in CSI entropy-
based indoor location ﬁngerprinting system, fertilizing
the opportunity to achieve a decimeter-level accuracy.
• We propose a power-based tap-ﬁltering program along-
with several phase calibration pre-processing techniques
to effectively mitigate CSI noisy component and sanitize
CSI phase errors, respectively.

• We design a feasible bivariate kernel regression scheme
for the online location estimation stage, which organi-
cally combines the weighting factors for both amplitude-
based entropy and phase-based AoA ﬁngerprints.

• We build and implement extensive experiments on the
lightweight Hummingboard device for different testbeds.
In addition to the superior performance, our mobile pro-
totype remarkably enhances the ﬁngerprinting efﬁciency.

The remainder of this paper is organized as follows. In
Section II, we review the state-of-the-art related works. The
relevant preliminaries are introduced in Section III. The overall
architecture design of our proposed system is elaborated in
Section IV. We provide experimental results and analyses in
Section V and dig some insightful perspectives in Section VI.

 (cid:17)(cid:22)(cid:20)(cid:18)(cid:19)(cid:24)(cid:1)(cid:4)(cid:12)(cid:10)(cid:22)(cid:1)(cid:6)(cid:10)(cid:19)(cid:2)(cid:20)(cid:12)(cid:10)(cid:1)(cid:18)(cid:13)(cid:1)(cid:5)(cid:17)(cid:22)(cid:12)(cid:20)(cid:12)(cid:21)(cid:22)(cid:8)(cid:20)(cid:10)(cid:17)(cid:21)(cid:16)(cid:14)(cid:22)(cid:22)(cid:12)(cid:20)(cid:7)(cid:12)(cid:11)(cid:12)(cid:14)(cid:23)(cid:12)(cid:20)(cid:9)(cid:10)(cid:15)(cid:15)JOURNAL OF LATEX CLASS FILES, VOL. 14, NO. 8, AUGUST 2015

3

Conclusions are drawn in Section VII.

II. RELATED WORK

The popularization of mobile computing triggers a thriving
trend in the domain of wireless indoor location determination.
The general localization approaches fall into two categories:
geometrical mapping and ﬁngerprinting.

Geometric mapping based techniques: The geometric mod-
eling of the RF propagation is fundamental to the ranging or
direction based positioning systems. Wu et al. explored the
frequency diversity of PHY layer CSI information to reﬁne
distance estimation and pinpoint the target’s location through
trilateration in FILA system [26], which achieved median ac-
curacy of 1.2 m in the multi-room environment. Alternatively,
ArrayTrack [27] embraced the trend of MIMO technology
and exploited increased number of antennas at commodity
access points (APs) to obtain high-resolution AoAs, which
were further aggregated to infer the client location within
23 centimeters median accuracy. Unlike ArrayTrack which
requires dedicated hardware modiﬁcations, Kotaru et al. de-
signed SpotFi [12], an accurate indoor localization system ca-
pable of identifying direct path AoAs with only three physical
RX antennas. Moreover, after incorporating the observed RSS
information for an optimization processing, SpotFi was able
to achieve the median accuracy of 40 cm. More recently, the
researchers of Chronos [28] leveraged a novel Chinese remain-
der theorem based algorithm to compute sub-nanosecond ToF
with a single Wi-Fi access point. This distance-related metric
was then formulated into a quadratic optimization problem for
accurately locating clients within tens of centimeters.

Fingerprinting based techniques: Regardless of measure-
ments’ geometric relation, the pattern-matching based ﬁnger-
printing techniques have attracted a large body of research
interests for the last decades. Pioneering works such as
RADAR [29] carried out comprehensive site surveys for the
ﬁrst time and generated the RSS based ﬁngerprint radio map.
Subsequently, the deterministic kNN algorithm was utilized
to determine the target’s location with an average precision
of 3 meters. Contrastively, in Horus system [15], Youssef et
al. resorted to the Bayes based probabilistic method and a
joint clustering algorithm to achieve an accuracy improve-
ment of 2.1 m, which outperformed RADAR even with less
computational complexity. Aside from FILA, the authors of
FIFS [16] also explored the spatial and frequency diversity of
CSI for Wi-Fi ﬁngerprinting localization. Additionally, FIFS
took the power summation for all independent subcarriers as
location ﬁngerprint and adopted maximum a posteriori (MAP)
approach to yield an improved performance compared with
RSS based Horus system. Meanwhile, for PinLoc [17], the
whole location-aware platform was established on a set of
1m × 1m spots. The underlying observation of PinLoc was
that the CSIs on a single subcarrier were illustrated to be
clustered distributed on the complex plane. The Gaussian
mixture distribution was then introduced to properly model
the channel measurements for the purpose of accurate lo-
calization. Experimental result validated PinLoc’s impressive
performance with an 89% mean accuracy for 100 spots.

Fig. 2. MIMO-OFDM transceiver architecture

Wang et al. designed DeepFi [30], a deep learning based
indoor location ﬁngerprinting system using CSI amplitude
information. In the ofﬂine phase, DeepFi enabled a deep
network to train all the weights as location ﬁngerprints, and
harnessed the radial basis function (RBF) based probabilistic
scheme to accomplish the position estimation in the online
phase. It outperformed FIFS system with 20% accuracy im-
provement. Recently, authors in [23] proposed EntLoc, an AR
entropy based indoor location ﬁngerprinting system using CSI
amplitude information. Compared with PinLoc, the EntLoc’s
structural simplicity and the strong location-dependency of
AR entropy based CSI ﬁngerprint remarkably enhanced the
location ﬁngerprinting performance with an average precision
improvement of 27.3%.

III. PRELIMINARIES

In this section, we present some relevant technical back-
grounds on the MIMO-OFDM mechanism and the channel
state information.

A. MIMO-OFDM Mechanism

Fig. 2 depicts the holistic structure of the end-to-end
MIMO-OFDM wireless transceiver for IEEE 802.11 n/ac. It
consists of two major functionality blocks: signal transmitter
block and RF receiver block. In the transmitter block, the
scrambler and forward error correction (FEC) encoder ﬁrst
convert the input data into high-rate bit stream(s). The stream
parser is then applied on bit stream(s) to generate Nss spatial
streams, whose number is determined by the parameter of
modulation and coding scheme (MCS). After interleaving and
constellation mapping (e.g. QAM), Nss spatial streams are
modulated as stream of symbols, which may be spread into
Nsts space-time streams in the sequel when space-time block
coding (STBC) is used. Next, a mechanism named cyclic
shift diversity (CSD) is applied to insert cyclic shifts into
space-time streams, thus creating extra frequency diversity
to avoid unintentional beamforming. Spatial mapping then
proceeds to map fewer number of Nsts space-time streams into
larger number of Nt transmit chains through spatial mapping
matrix (SMM). Afterwards, the frequency domain samples are

ScramblerEncoder ParserFEC EncoderStream ParserInterleaverConstellationMapperSpace-Time Block CodingSpatial MappingIFFTGI / WindowDAC and RFFEC EncoderInterleaverInterleaverConstellationMapperConstellationMapperIFFTIFFTGI / WindowGI / WindowDAC and RFDAC and RFRFRFRFADCADCADCFFTFFTFFTDemod.Demod.Demod.Channel EstimationCSDCSDCSDTransmitter BlockTX/RX Antenna ArrayReceiver BlockJOURNAL OF LATEX CLASS FILES, VOL. 14, NO. 8, AUGUST 2015

4

converted into time domain ones by the inverse fast Fourier
transform (IFFT). The RF signals are then simultaneously sent
from all transmit antennas after the insertion of guard interval
(GI), windowing operation and digital-to-analog converting
(DAC).

In reverse, upon receiving the signals, the receiver block
ﬁrst samples them and digitizes them through analog-to-digital
converters (ADCs). Subsequently, a forward FFT procedure is
conducted to convert the data samples back to the frequency
domain. The desired channel estimation then becomes achiev-
able after the signal demodulation process.

B. Channel State Information

In wireless communication systems,

the signal receiver
operates channel estimation by virtue of channel sounding
mechanism. Speciﬁcally, for the packet-based IEEE 802.11n
system, the transmitter sends training sequences, including
high throughput long training ﬁelds (HT-LTF) in the preamble.
Once receiver detects the starting position of the ﬁrst HT-LTF,
it commences to derive channel state information immediately.
As aforementioned in Section I, CSI portrays the PHY layer
channel properties in the frequency domain and reveals the
combined effects of signal multipath propagation including
amplitude attenuation and phase shift. The channel frequency
response (CFR) is represented by each CSI entry. It can be
expressed by

H(f ) = |H(f )|ej∠H(f )

(1)

where H(f ) is the complex value of CFR at the subcarrier
with central frequency of f . |H(f )| and ∠H(f ) denote its
amplitude and phase, respectively.

In order to fully characterize the indoor multipaths, the time
domain counterpart of CFR, also termed as channel impulse
response (CIR), is able to model the wireless propagation
channel as a temporal linear ﬁlter. Mathematically, it can be
denoted as

h(τ ) =

L
(cid:88)

i=1

αie−jϕiδ(τ − τi)

(2)

where αi, ϕi and τi are the amplitude, phase and time delay
spread of the ith path, respectively. L is the total number of
multipaths and δ(·) is the Dirac delta function.

In practice, it is worth mentioning that, all of our experi-
ments are implemented on the basis of Linux CSI tool [31],
whose off-the-shelf Intel 5300 network interface card (NIC)
reports 30 out of 56 OFDM subcarriers for 20 MHz bandwidth
CFR. After applying IFFT on the recorded CFR, we can
acquire the time domain CIR with an equivalent number of
30 channel ﬁlter taps.

IV. SYSTEM DESIGN

In this section, we lay out

the detailed design of our

proposed ﬁngerprint localization system.

Fig. 3. The overall AngLoc system architecture

A. Overview

As illustrated in Fig. 3, the overall architecture of our pro-
posed AngLoc system has a block-wise design. To be speciﬁc,
in the ofﬂine radio map construction block, once recording the
raw CSI measurements through war-driving, we ﬁrst introduce
a tap ﬁltering scheme to extract the most informative location-
speciﬁc component from noisy CSIs. For the purpose of
accurate AoA estimation, several phase calibration techniques
are then leveraged to compensate the corresponding phase
offsets, which exist in prevalent commodity WiFi devices.
Subsequently, for CSI amplitudes, we statistically model them
as the simply structural AR entropy metric. The JADE-MUSIC
algorithm is then adopted for CSI phases to infer the angular
estimates. Hence,
the entire ofﬂine database can be fully
embodied by the integration of entropy and AoA ﬁngerprints,
making full use of both CSI amplitude and phase information.
For the online location estimation block, when a mobile
target enters the area of interest, it executes the same pre-
processing protocols to obtain the entropy and AoA estimates.
The following location estimation task then consists of two
major steps. (i) The online entropy vector is ﬁrst matched
with ofﬂine database to ﬁnd the most likely candidates from
nearest RP positions. (ii) Among these candidate locations, a
novel bivariate kernel regression scheme is proposed to further
narrow down the number of error-prone RPs, thus tackling the
target’s location determination with an improved accuracy.

In the sequel, we will take an in-depth structural dissection

for each block of our proposed AngLoc system.

B. Problem Formulation

First of all, we start to elaborate our location ﬁngerprinting
methodology with the presentation of the problem formulation.
In the ofﬂine phase, M reference points are predeﬁned and
properly marked in the area of interest. The coordinate of
each RP location can be denoted as (cid:96)m = (xm, ym), where
xm and ym are the respective X- and Y-coordinate of the mth
RP, m ∈ [1, M ]. Considering that we have S access points as
signal transmitters, each of which has Nt TX antennas. One
mobile user equipped with Nr RX antennas is regarded as
the RF receiver. Thus each TX-RX antenna pair is capable
of generating up to Nt · Nr radio links. As for the channel
state information, each CSI packet shares the same number
of K OFDM subcarriers. So the dimensionality of one CSI

EntropyEstimationAoAEstimation War-DrivingTap FilteringPhase CalibrationRadio MapRP Candidates Refining Bivariate Kernel RegressionEstimated LocationCSI MatrixOnlineDataOfflinePhaseOnlinePhasePreprocessingPacketsSubcarriersJOURNAL OF LATEX CLASS FILES, VOL. 14, NO. 8, AUGUST 2015

5

packet measured at one RP location from a single AP can be
expressed by R = Nt · Nr · K. Moreover, at each RP position,
we propose to concatenate CSI packets from S available APs
to form the raw CSI signature, whose total dimensionality
then extends to be S · R. Mathematically, this ofﬂine radio
signature measured at the mth RP location from all S APs is
given by the set Hm = {H1
m}, s ∈ [1, S].
m ∈ CN ×R contains N consecutive 1 × R
Speciﬁcally, Hs
dimensional CSI samples which are adequately acquired at
the RP location (cid:96)m from the sth AP. This CSI matrix can be
presented by the following equation.

m, . . . , HS

m, . . . , Hs

Hs

m =

H s










H s

m(1, 1)
...
m(n, 1)
...
m(N, 1)

H s

· · · H s
. . .
· · · H s
. . .
· · · H s

m(1, r)
...
m(n, r)
...
m(N, r)

· · · H s
. . .
· · · H s
. . .
· · · H s

m(1, R)
...
m(n, R)
...
m(N, R)










(3)

where n ∈ [1, N ] and r ∈ [1, R].

During the online stage, the mobile user at an unknown
position (cid:96)o = (xo, yo) records the same structural CSI matrix
from the sth AP. We denote this matrix as Gs
o, which also
shares the same dimension with Hs
m. Likewise, the online
measured CSI signature at the location (cid:96)o can be expressed by
the set Go = {G1
o, . . . , GS
o }. Accordingly, the mobile
user’s location can be then estimated as (cid:98)(cid:96)o = ((cid:98)xo, (cid:98)yo) by
exploiting these online CSIs and the stored ofﬂine database.

o, . . . , Gs

C. CSI Pre-Processing

In this part, we focus on some technical details of CSI pre-
processing techniques which serve as the precondition to attain
superior localization performance.

1) CSI Noise Removal: Due to the bandwidth limitation for
the existing Wi-Fi networks, CSI ﬁngerprint based IPS cannot
resolve enough multipath components in the environment,
which may incur severe ambiguity for location ﬁngerprint-
ing [32]. For instance, from a commodity Wi-Fi with 20
MHz bandwidth, the time resolution of CIR can only reach
1/20MHz = 50 ns. Since typical indoor maximum excess delay
is smaller than 500 ns, given a time resolution of 50 ns, just
the ﬁrst 10 out of the 30 accessible CIR time taps are relevant
to multipath propagation [33]. In other words, the remaining
20 taps are less related for localization purpose. In addition,
when exposed in a low signal-to-noise ratio (SNR) scenario,
the receiver’s additive white Gaussian noise at these time taps
will even make the accuracy worse.

Therefore, a reasonable number of CIR taps should be
carefully selected for the sake of precise positioning. On this
basis, we design a power-based tap ﬁltering scheme to preserve
the most informative location dependency. Speciﬁcally, for the
simplicity of expression, we deﬁne an individual raw CFR
signature as H ∈ C1×K. Through IFFT, we ﬁrst convert
H into the same dimensional CIR vector h. Next, we cal-
culate the average channel power of each tap, denoted by
U = (u1, . . . , uk, . . . , uK), k ∈ [1, K], where uk = |hk|2 and

hk indicates the kth complex tap value of the CIR vector. Then,
a cumulative contribution rate of the ﬁrst k taps is deﬁned as

Ck =

k
(cid:88)

i=1

ui

(cid:30) K
(cid:88)

ui.

i=1

(4)

If the cumulative contribution rate of the ﬁrst T taps, i.e.,
CT , is greater than a predeﬁned threshold C, we then apply a
simple rectangular window with length T to truncate the other
(K − T ) taps. At last, FFT is further employed on the ﬁltered
CIR to yield a smoothed version of CFR [23].

2) CSI Phase Calibration: Due to the inherent OFDM
baseband operations and the hardware’s imperfect signal pro-
cessing, the CSI obtained from the commodity Wi-Fi devices
is distorted with various errors [11], [34], [35], rendering the
accurate AoA and ToF estimation much more challenging.
For a transmission chain, the phase measurement ∠ (cid:98)Hfk for
subcarrier k with carrier frequency fk can be presented as
∠ (cid:98)Hfk = ∠Hfk +2πfδk(ζcsd +ξsfo)+ϕsto +ϕcfo +ϕcpo +Z
(5)
where ∠Hfk denotes the true phase from wireless propagation.
fδ is the OFDM subcarrier spacing. ζcsd, ξsfo, ϕsto, ϕcfo
and ϕcpo are the phase errors caused by cyclic shift diversity
(CSD), sampling frequency offset (SFO), symbol timing offset
(STO), carrier frequency offset (CFO) and carrier phase offset
(CPO), respectively. Z signiﬁes the additive measurement
noise. In the following, we will address these deep-rooted CSI
phase issues in a divide-and-conquer manner.

• CSD: As described in Section III-A, CSD is operated by
sending cyclically shifted OFDM symbols over different
TX antennas so that unintended beamforming is avoided.
But this incurs an additive phase shift for each TX
antenna in CSI matrix which potentially degrades the
localization performance. SignFi [36] compensated the
CSD errors by applying a multiple linear regression
scheme. However, as a easier alternative suggested in
[11], CSD can always be removed by the receiver when
direct mapping takes place, under which the SMM
equals an unitary matrix. Hence, in our data acquisition
process, we can conﬁgure the Intel 5300 shipset to make
Nss = Nt, thus yielding the CSD-free CSIs.

• SFO: In OFDM transceiver system, SFO occurs when
the receiver’s ADC sampling rate differs from the trans-
mitter’s synthesization rate. Consequently, SFO mani-
fests itself as an additive phase shift proportional to
the subcarrier index, which gives rise to the ﬁrst-order
channel linearity (e.g. Fig. 4). We then resort to a simple
linear regression method to remove the residual SFO. It
can be mathematically expressed as follows.
(cid:88)

(ϕk

nt,nr

+ 2πfδkρ + ω)2

(6)

(cid:98)ξsfo = argmin

ρ

k,nt,nr

where ρ and ω are curve ﬁtting variables and ϕk
nt,nr
denotes the unwrapped CSI phase for one packet at the
kth subcarrier from nth
r RX antenna,
nt ∈ [1, Nt] and nr ∈ [1, Nr].

t TX antenna to nth

• STO: In general, the receiver utilizes the auto/cross-
the presence of the

correlator to capture and detect

JOURNAL OF LATEX CLASS FILES, VOL. 14, NO. 8, AUGUST 2015

6

Fig. 4. The CFR phase (Row 1) and CIR amplitude (Row 2) changes after SFO, STO and CFO removal.

OFDM symbol header, which starts with short training
ﬁelds (STFs). However, the length limitation of these
STFs brings great uncertainty to determine the symbol
boundary. This results in the irreversible STO. Fortu-
nately, given that any frequency domain phase shift due
to STO leads to the same amount of circular rotation
in time domain, STO can be embodied as peaks at
the far end of power delay proﬁle (PDP) owing to the
CIR’s cyclic-shifting property. On this basis, in order
to estimate STO, we ﬁrst derive the PDP from the
CIR vector, i.e. {hk(n)}1≤k≤K of the nth packet. The
corresponding tap index Nsto(n) of the shifted PDP
peak due to STO can be identiﬁed as

Nsto(n) = argmax

k

|hk(n)|2, 1 < k ≤ K

(7)

After applying (7) for multiple packets, the most fre-
quent value of Nsto is then determined to ﬁnally shape
the estimated STO as (cid:98)ϕsto = −2πkNsto/K.

• CFO/CPO: Due to the residual errors in receiver’s phase
locked loop (PLL), CFO emerges when the receiver’s
carrier frequency for down-conversion mismatches with
the transmitted carrier frequency. Meanwhile, since each
time when the synthesizer restarts, a random initial phase
will be generated by the receiver’s voltage controlled
oscillator and PLL cannot fully compensate for this
phase difference, CPO is then experienced. According
to [11], after the PDP-based STO removal, the ToF esti-
mation becomes naturally immune to CPO. Additionally,
during our site survey, we only initiate the transceiver
devices for once, which makes CPO negligible in our
ﬁngerprinting system. As CFO is also an accumulative
error that has to be compensated by the receiver, we
then employ a non-overlapping moving window with
length Np for geometric averaging to further smooth out
CFO. Speciﬁcally, we ﬁrst obtain K-dimensional ¯H by
conducting element-wise multiplication for Np packets.
¯H = H(1) ◦ · · · H(np) · · · H(Np), np ∈ [1, Np]

(8)

where ◦ denotes the Hadamard product operator and
H(np) is the nth
p CFR packet. The sanitized CFR can
be then acquired by (cid:98)H = {( ¯Hk)

Np }1≤k≤K.

1

As illustrated in Fig. 4, the above adopted phase calibration
techniques have effectively compensated CSI phase errors after
the respective SFO, STO and CFO removal.

D. Ofﬂine Radio Map Construction

After the noise removal and phase sanitization, the pre-
processed CSIs then proceed readily to establish a self-
contained ﬁngerprint database which involves both amplitude
and phase information.

1) AR Entropy Estimation using CSI Amplitude: Recall
that the entropy metric is deemed as a desired location ﬁnger-
print due to its structural simplicity as well as its statistical
embodiment of rich location-speciﬁc information. In reality,
it is intractable to directly derive Shannon entropy from real
data [21]. The reason behind this dilemma is twofold: (i)
Given that fact that the true PDF is normally unknown, entropy
approximation is only reachable from the mere data samples.
(ii) Conventional Shannon entropy calculation requires cum-
bersome numerical integration since a closed-form substitute
does not exist.

To address the above challenges, in this paper, we propose to
accurately estimate the entropy by leveraging AR modeling ap-
proach, whose core principle is to estimate the PDF-equivalent
PSD of an unit variance AR process. This unit variance
constraint is imported to meet the basic requirements of PDF
(i.e. positive function that
integrates to one). Speciﬁcally,
we deﬁne a general notation of CSI amplitude β from one
subcarrier and the entire PDF-PSD relations is presented by

σ2
(cid:15)

|1 + (cid:80)p

p(β) = SW (β) =

i=1 aie−j2πiβ|2 , β ∈ [−0.5, 0.5]
(9)
where p(β) and SW (β) are the PDF and PSD of amplitude β,
respectively. The set of {ai}1≤i≤p are the AR coefﬁcients of

0102030Subcarrier Index-20-15-10-50Unwrapped PhaseOriginal CFR0102030Subcarrier Index-3-2-10Unwrapped PhaseSFO Removal0102030Subcarrier Index-8-6-4-2Unwrapped PhaseSFO+STO Removal0102030Subcarrier Index-0.4-0.200.20.4Unwrapped PhaseSFO+STO+CFO Removal0102030Tap Index0510AmplitudeOriginal CIR0102030Tap Index02468AmplitudeSFO Removal0102030Tap Index02468AmplitudeSFO+STO Removal0102030Tap Index0510AmplitudeSFO+STO+CFO RemovalJOURNAL OF LATEX CLASS FILES, VOL. 14, NO. 8, AUGUST 2015

7

2) Enhanced AoA Estimation using CSI Phase: For con-
siderable wireless location-aware applications, accurate AoA
measurement is non-trivial on commodity devices. In view of
the super-resolution advantage, the classical subspace-based
MUSIC algorithm is of the greatest appeal. The basic idea
of standard MUSIC algorithm is that incident signals from
different bearings give rise to different phase changes on each
antenna at the receiver [39].

Assume that there are L incoming signals γ1, . . . , γL arriv-
ing from directions θ1, . . . , θL at Nr RX antennas of a linear
array. The RX antennas are evenly-spaced with a distance d,
which is about half of the signal’s wavelength. As shown in
Fig. 5, for the lth signal (l ∈ [1, L]), a phase difference of
−2πf dsin(θl)/c is introduced at two adjacent antennas, where
f is the signal frequency and c denotes the speed of light. For
the whole antenna array, we can thereby deﬁne these phase
shifts relative to the ﬁrst antenna as the following steering
vector.

Ψ(θl) = [1, e−j2πf d sin(θl)/c, . . . , e−j2π(Nr−1)f d sin(θl)/c](cid:62)

(13)
where (·)(cid:62) is the transpose operator. Given all L incident
signal paths, the Nr ×L steering matrix is then constructed by
Q = [Ψ(θ1), Ψ(θ2), . . . , Ψ(θL)]. Thus, the received signal x
at each RX antenna can be expressed as the superposition of
all L signal paths.

[x1, x2, . . . , xNr ](cid:62) = Q[γ1, γ2, . . . , γL](cid:62) + W

or

X = QΓ + W

(14)

Note that there is an inherent constraint when applying the
conventional MUSIC algorithm to Eq. (14), which requires
array antennas should outnumber the resolvable incident multi-
paths (i.e. Nr > L). However, in typical indoor environments,
there are about 5-10 dominant multipath clusters [40] while
our commodity Intel 5300 NIC only supports up to Nr = 3
antennas. This means it can merely capture 2 incident paths
through MUSIC, thus largely limiting the AoA resolution and
severely deteriorating the ﬁdelity of the MUSIC outcome. To
overcome this bottleneck, we leverage the fact that alongside
AoA-related phase shifts across physical antennas, the incom-
ing signals also invite phase differences across equispaced
OFDM subcarriers due to ToF [12], [25]. Therefore, we further
extend the Nr-antenna physical array to a virtual sensor array
with the size of K · Nr, by which JADE-MUSIC algorithm
can be readily employed to exploit CSI phase information in
two dimensions. Speciﬁcally, the second steering vector which
contains phase shifts relative to the ﬁrst subcarrier can be
deﬁned as follows.

Ω(τl) = [1, e−j2πfδτl , . . . , e−j2π(K−1)fδτl ](cid:62)

(15)

where τl is the time delay of the lth path and fδ is the two
adjacent subcarrier spacing. Accordingly, the combined AoA-
ToF steering vector can be updated by

a(θl, τl) = Ψ(θl) ⊗ Ω(τl)

(16)

(10)

where W is the noise vector.

Fig. 5. An incident signal arrives at an antenna array with an angle θ

an order p AR process and σ2
(cid:15) is the model prediction error
which is chosen so that (cid:82) 0.5
−0.5 SW (β)dβ = 1. It is notable
that since the law is modeled as the spectrum restriction on
the interval of [−0.5, +0.5] [37], the amplitude data has to be
ﬁrst rescaled on this interval.

For solving Equation (9), a proper model order p should be
ﬁrst chosen since a low order leads to inadequate resolution
and a high order incurs spurious peaks (excessive variance).
We thereby adopt the exponentially embedded family (EEF)
technique [38] to determine the AR model order due to
its superior performance through our extensive experiments.
Subsequently, both the AR coefﬁcients and its corresponding
model prediction error can be estimated by solving the well-
known Yule-Walker equations using Levinson-Durbin recur-
sion [23]. Once the AR PDF is determined from (9), the
entropy computation can be then expressed by the following
form:

(cid:98)φβ = −

= −

(cid:90) 0.5

−0.5
(cid:90) 0.5

−0.5

(cid:98)p(β) log (cid:98)p(β)dβ

(cid:98)SW (β) log (cid:98)SW (β)dβ

Besides, by applying Plancherel-Parseval formula to the right
hand side of (10), a feasible closed-form alternative without
any numerical integration can be yielded as

(cid:98)φβ = −

∞
(cid:88)

i=−∞

RW (i)Z ∗

W (i)

(11)

where (·)∗ is the conjugate operator and ZW (i) denotes the
ith component of the AR process’s cepstrum, which can
be obtained by applying the IFFT to log (cid:98)SW (β). RW (i)
represents the autocorrelation function of the amplitude data.
In addition, as reported in [23], the AR entropy estimates
from two endpoint subcarriers cause the most ambiguity for
location distinction. We accordingly remove these subcarriers
to further enhance the ﬁngerprinting efﬁciency. Thus, when
combining the total R-dimensional CSI measurements from
all Nt · Nr antenna pairs, the ﬁnal estimated AR entropy
ﬁngerprint in the ofﬂine phase can be restored as
, . . . , (cid:98)φr

(12)
where R(cid:48) = R − 2NtNr is the reduced ﬁngerprint dimension-
ality in this case. Likewise, the online estimated AR entropy
vector can be denoted by (cid:98)ΦGs
].
Next, we will separately infer the AoA-based ﬁngerprint by
exploiting the CSI phase information.

, . . . , (cid:98)φR(cid:48)
Hs
m

, . . . , (cid:98)φR(cid:48)
Gs
o

], r ∈ [1, R(cid:48)]

= [ (cid:98)φ1
Hs
m

, . . . , (cid:98)φr

= [ (cid:98)φ1

(cid:98)ΦHs

Hs
m

Gs
o

Gs
o

m

o

…123Nr𝜃𝜃𝑑𝑑𝑑𝑑Incident SignalAntenna ArrayJOURNAL OF LATEX CLASS FILES, VOL. 14, NO. 8, AUGUST 2015

8

Fig. 6. The mechanism of forward-backward smoothing for the case K = 30
and Nr = 3.

where ⊗ denotes the Kronecker product. After aggregating
all L signal multipaths, the corresponding KNr × L steering
matrix is thereby presented as

A = [a(θ1, τ1), . . . , a(θl, τl), . . . , a(θL, τL)]

(17)

Hence, the received signals at RX antennas in Equation (14)
can be rewritten by

¯X = AΓ + ¯W

(18)

Next, we then move to apply JADE-MUSIC by ﬁrst deriving
the covariance matrix RX of the received signal, which is
calculated as

W I

(19)

RX = E{ ¯X ¯XH } = ARSAH + σ2
where (·)H and E{·} demotes the Hermitian transpose and
expectation operator, respectively. RS is the noise-free covari-
ance matrix of the complex signal vector and σ2
W indicates
the noise variance. Among K · Nr eigenvalues of RX , the
smallest (KNr − L) eigenvalues represent the noise and the
remaining L eigenvalues correspond to L incident signals. The
eigenvectors corresponding to these smallest eigenvalues then
form the noise subspace EN . Since the signal subspace and
noise subspace are orthogonal, the spatial pseudo-spectrum
function can be expressed as follows.

P (θ, τ ) =

aH (θ, τ )a(θ, τ )

aH (θ, τ )EN EH

N a(θ, τ )

(20)

By searching on the 2-D angle and delay continua, the sharp
peaks in P (θ, τ ) will occur at the bearings of incident signals
with their corresponding time delays.

a) Forward-Backward Spatial Smoothing: In practice, sub-
space techniques like MUSIC also require the signal covari-
ance matrix RS has full rank. However, our stacked CSI
measurements ¯X from all the subcarriers at all RX antennas is
just a single column unit rank matrix. Due to the coherence of
multiple signals, all subspace based methods suffer complete
failure from the rank deﬁciency of RS. To address this issue,
we propose to apply forward-backward spatial smoothing to
mitigate the random noise and further improve the joint AoA-
ToF estimation performance [41]. As shown in Fig. 6, after
reshaping the single measurement vector to the Nr × K
CSI matrix, we ﬁrst partition the CSI matrix into uniformly
overlapping subarrays with the size of K (cid:48)N (cid:48)
r, where K (cid:48) and
N (cid:48)
r are the number of subcarriers and antennas in the subarray,
respectively. To ensure measurable phase shifts across RX
antennas, here N (cid:48)
r is ﬁxed as 2 in our case. The total number of
overlapping subarrays is then TKTN , where TK = K −K (cid:48) +1

Fig. 7. Optimal smoothing length selection through AoA spectrum

and TN = Nr − N (cid:48)
r + 1. In the sequel, a hardened spatially
smoothed covariance matrix can be derived by averaging
across those subarrays’ covariance matrices with a forward
direction (blue arrow). It is deﬁned as follows.

Rf =

1
TKTN

TK TN(cid:88)

i=1

Ri
s

(21)

s is the covariance matrix of the ith subarray. This
where Ri
covariance hardening processing achieves an improved rank,
thus closer to the true source covariance matrix. Moreover, the
invariant structure of CSI also enables a backward directional
smoothing (red arrow) to further enhance the accuracy of MU-
SIC estimator. This averaged forward-backward covariance
matrix can be expressed as

Rf b =

1
2

(Rf + JR∗

f J) =

1
2

(Rf + Rb)

(22)

where J is the K (cid:48) × K (cid:48) exchange matrix with only ones on its
anti-diagonal and Rb denotes the backward covariance matrix.
b) Optimal Smoothing Length Selection: Note that SpotFi
only treats smoothed CSI matrix with a ﬁxed smoothing
length of K (cid:48)N (cid:48)
r = 30, which fails to dig deeper into the
optimal selection of the smoothing length. As the smoothing
length decreases, the noise level in estimated AoA spectrum
gets lower, which helps to narrow the peak and improve the
accuracy. But in the meantime, this also reduces the effective
antenna sensors, which increases the risk of eliminating the
peak from the direct path. To carefully cope with this trade-
off problem, we perform a micro-benchmark which computes
AoA spectra in a near LoS scenario (so the direct path bearing
dominates) with different smoothing lengths. As observed in
Fig. 7, the smoothing length of 16 (K (cid:48) = 8) shows a good
compromise during our experiments and thus is chosen for the
performance evaluation in Section V. It is also worth noting
that since subcarrier index k = 0 is null due to the large
direct current (DC), in addition to making smoothing length
larger than the number of multipaths indoors (say 10), we also
need to ensure that no partitioned subarray contains k = 0
subcarrier, which avoids 2fδ error for AoA estimation.

c) Augmented Multi-Packet Smoothing: Considering that
we only perform the forward-backward smoothing in the
frequency domain, to fully acquire the empirical covariance

CFR(1,1)     CFR(1,2)     CFR(1,3)     CFR(1,4)    … CFR(1,27)     CFR(1,28)     CFR(1,29)     CFR(1,30) CFR(2,1)     CFR(2,2)     CFR(2,3)     CFR(2,4)    … CFR(2,27)     CFR(2,28)     CFR(2,29)     CFR(2,30) CFR(3,1)     CFR(3,2)     CFR(3,3)     CFR(3,4)    … CFR(3,27)     CFR(3,28)     CFR(3,29)     CFR(3,30)Forward SmoothingBackward Smoothing030609012015018000.51No Smoothing0.5030609012015018000.51Smoothing Length 400.5030609012015018000.51Smoothing Length 300.5030609012015018000.51Smoothing Length 160.5JOURNAL OF LATEX CLASS FILES, VOL. 14, NO. 8, AUGUST 2015

9

ancy between the ofﬂine ((cid:98)θs
m, (cid:98)τ s
S APs. It can be then deﬁned as
(cid:114)

Dm =

(cid:88)S

s=1

m) and online ((cid:98)θs

o, (cid:98)τ s

o ) from all

(((cid:98)θs

m − (cid:98)θs

o)2 + ((cid:98)τ s

m − (cid:98)τ s

o )2)

(26)

Fig. 8. The comparison of AoA-ToF estimation with and without multi-packet
smoothing.

matrix, different packet snapshots are also needed to imple-
ment the time-domain averaging, which can be denoted by

Rmp =

1
Nmp

Nmp
(cid:88)

i=1

Ri
f b

(23)

where Nmp is the number of multiple CSI packets. We can
observe in Fig. 8 that the joint AoA and ToF estimation
is further reﬁned after the process of multi-packet sample
smoothing.

As a result, along with AR entropy ﬁngerprints, the ﬁnal
estimated AoA with the smallest ToF at the mth RP location
from the sth AP is determined and stored as ((cid:98)θs
m) for
the following online position estimation. Likewise, the online
acquired ﬁngerprint can be expressed by ((cid:98)θs

m, (cid:98)τ s

o, (cid:98)τ s
o ).

E. Online Location Estimation

In the online location estimation phase, the mobile target
is required to be accurately mapped with the pre-deﬁned
ﬁngerprint database. In order to quantify the similarity between
the ofﬂine stored ﬁngerprints and the online measured CSIs,
we manage to independently adopt two simple distance metrics
for the respective AR entropy and AoA ﬁngerprints. For
amplitude based AR entropy, the Manhattan distance (a.k.a.
taxicab metric) [42] is employed to measure the gap between
two vectors through the summation of the absolute differences
of their corresponding components. Given the ofﬂine and
online entropy ﬁngerprints (cid:98)ΦHs
o, the Manhattan
distance between them is represented as

m and (cid:98)ΦGs

D s

m = (cid:107) (cid:98)ΦHs

m

− (cid:98)ΦGs

o

(cid:107)1 =

R(cid:48)
(cid:88)

i=1

(cid:12)
(cid:12) (cid:98)φi
(cid:12)

Hs
m

− (cid:98)φi

Gs
o

(cid:12)
(cid:12)
(cid:12)

(24)

where (cid:107) · (cid:107)1 denotes the (cid:96)1 norm. Moreover, by following the
chain rule for Shannon entropy [43], it can be proved that a
joint entropy difference for multiple independent variables is
equal to the sum of all these variable’s entropy differences.
Under the S independent AP assumption, we therefore have
the Manhattan distance for all available APs as follows.

Dm =

S
(cid:88)

s=1

D s
m

(25)

For the estimated 2-D AoA and ToF ﬁngerprints, we naturally
resort to the simple Euclidean distance to capture the discrep-

In general, both of the two metrics are fully capable of
concisely reﬂecting the spatial proximity between the ofﬂine
learned traits at the mth RP and the online measurements
from an uncharted position. For the design of AngLoc, the
remaining location estimation process consists of two main
steps. First, by adopting the classical kNN theory, we can
claim Mc out of M RP locations which signify Mc smallest
AR entropy differences among {Dm}1≤m≤M . Then, a novel
bivariate kernel regression scheme is further proposed to infer
the ﬁnal target’s location by exploiting the distance based
kernel function and the selected set of Mc reference points.
The estimated location (cid:98)(cid:96)o is expressed by

(cid:98)(cid:96)o =

(cid:80)Mc

mc=1 Kmc (cid:96)mc
(cid:80)Mc
mc=1 Kmc

(27)

where mc ∈ [1, Mc] and Kmc denotes the probability kernel of
the mth
c RP location which is obtained by exponentiating and
weighting its corresponding entropy and AoA based distances.
It can be mathematically presented as follows:

Kmc = we exp(−ρeDmc ) + wa exp(−ρaDmc)

(28)

Here we and wa are the weighting factors for the respective
AR entropy and AoA based kernel function and wa + we = 1.
ρe and ρa are their corresponding kernel coefﬁcients which are
chosen to optimally minimize the ﬁngerprinting error by leave-
one-out cross-validation in the ofﬂine phase. It is noteworthy
that this bivariate kernel Kmc equals to one if the given two
ﬁngerprints are identical and decays to zero as the dissimilarity
of two ﬁngerprints increases. Simply put, this bivariate kernel
provides a ﬂexible way to naturally harness the CSI data and
therefore makes full use of our probabilistic AR entropy and
AoA information, thus leading to an improved localization
performance.

The performance of our AngLoc ﬁngerprinting system will

be evaluated in the following section.

V. PERFORMANCE EVALUATION

In this section, we carry out the experimental evaluation
of our proposed localization system. We will begin with the
experimental setup introduction and the detailed results of
localization performance will be discussed in the sequel.

A. Experimental Setup

1) Test Environments: To evaluate the performance of our
AngLoc system, the entire experiments are implemented at
two different indoor testbeds in CNAM. As exhibited in Fig.
9a, the ﬁrst testbed is a 15m × 15m laboratory ofﬁce in a
multistorey building, which is comprised of a main corridor
alongside several ofﬁce and meeting rooms. Many desks,
chairs, computers and shelves are furnished inside to form
a complex indoor radio propagation environment. The second
testbed in Fig. 9d is an ample classroom scenario with an

0153045607590105120135150165180050100Time of Flight (ns)50100Without Sample SmoothingWith Sample SmoothingJOURNAL OF LATEX CLASS FILES, VOL. 14, NO. 8, AUGUST 2015

10

(b) TX: Laptop with Intel 5300 NIC

(a) Testbed #1: CNAM lab scenario

(c) RX: HummingBoard Pro

(d) Testbed #2: Classroom scenario

Fig. 9. Two testbeds both with dedicated laptop as signal Transmitter (TX) and HummingBoard Pro as Receiver (RX): (a) CNAM laboratory scenario (Testbed
#1); (b) TX: Laptop with Intel 5300 NIC; (c) RX: HummingBoard Pro; (d) CNAM classroom scenario (Testbed #2).

Fig. 10. Floor plan of the laboratory (Testbed #1)

Fig. 11. Floor plan of the classroom (Testbed #2)

area of around 100 m2. It lays out less obstacles within the
ﬁngerprinting area which presents a relative LoS scenario. It
can then serve as a supplementary contrast with testbed #1.

2) Hardware Descriptions: For both testbeds, all the real
experiments are conducted on the commodity-ready off-the-
shelf Wi-Fi devices with a modiﬁed ﬁrmware [31]. To be
speciﬁc, as shown in Fig. 9b and Fig. 9c, by tuning into the
IEEE 802.11n monitor mode with 5 GHz band, we deploy
an HP Elitebook 8530w laptop as the signal transmitter and
an Hummingboard Pro (HMB) device as the mobile receiver,
both of which are equipped with Intel Wi-Fi Link (IWL) 5300
NIC and run 64-bit Ubuntu 14.04 OS and Debian 8.0 OS,
respectively. In addition, as for the antenna settings, each
wireless NIC-compatible device is capable of installing up
to three omni-directional antennas so that the 3 × 3 MIMO
conﬁguration can be supported.

3) Data Acquisition: As aforementioned in the beginning,
we implement the CSI data collections in both laboratory
and classroom environments. Fig. 10 and Fig. 11 display
the detailed ﬂoor plans and experimental
layouts for our
laboratory and classroom testbeds, respectively. First of all,
for both testbeds, the laptop serves as signal transmitter whose

placement is ﬁxed on the table and known a priori. Under
packet injection mode, it is designated to intermittently send at
the rate of 100 packets per second using only one transmitting
antenna. It is notable that such antenna setting means to meet
the requirement of direct spatial mapping, which can yield
CSD-free CSI data. Meanwhile, the localization accuracy can
be also guaranteed with the lowest computational cost. For
the two experimental layouts, the blue dots shown in Fig.
10 and Fig. 11 denote the 70(40) training RP locations with
one meter spacing and the 30(28) testing positions are marked
as red stars. During the ofﬂine training phase, roughly 5000
CSI packets are collected and stored by the lightweight HMB
at each reference point to build up the raw CSI radio map.
In the online phase, we proceed to move this HMB receiver
among all the testing locations to acquire the same size of CSI
packets for the localization purpose. Moreover, every receiver
end is operated at the same height, constructing a simple 2-D
platform for the precise indoor position estimation.

4) Benchmarks and Performance Metrics: In this section,
we establish the whole benchmark program for the perfor-
mance evaluation of our AngLoc system, which is compared
with aforementioned systems like Horus [15], FIFS [16] and

Intel 5300 NICAntenna Stand with HummingBoardPro15m3m7m15m3m5mTXTableRX12.6m7.8mPC TableTXRXJOURNAL OF LATEX CLASS FILES, VOL. 14, NO. 8, AUGUST 2015

11

Fig. 12. AR entropy variance changes with different CSI packet numbers.

Fig. 13. AoA estimation errors by using different number of CSI packets.

PinLoc [17]. We also compare it with our previously proposed
EntLoc system [23], which only exploits the CSI amplitude
based entropy metric for indoor ﬁngerprint localization. Be-
sides, considering that the original PinLoc system conduct the
war-driving procedure in a set of predeﬁned 1m × 1m grids,
known as spots, in order to provide a fair comparison, we
modify PinLoc to use the same training set that we use in
the proposed AngLoc system. Particularly, for AoA accuracy
evaluation, we take SpotFi [12] as the comparative rival due
to its representativeness among recent AoA based IPSs.

As for the performance metrics, we deﬁne the localization
error as Euclidean distance between the estimated location and
the mobile user’s actual position, which is presented as (cid:107)(cid:98)(cid:96)o −
(cid:96)o(cid:107) = (cid:112)((cid:98)xo − xo)2 + ((cid:98)yo − yo)2. When there are Na testing
locations, we evaluate the localization performance by using
the Mean Error (ME) metric which can be calculated as

M E =

1
Na

Na(cid:88)

i=1

(cid:112)((cid:98)xi − xi)2 + ((cid:98)yi − yi)2

(29)

where (xi, yi) and ((cid:98)xi, (cid:98)yi) are the actual and estimated coor-
dinates at the ith testing location, respectively.

B. Experimental Results

Prior to exhibiting the localization results of our proposed
system, we ﬁrst reveal the effects of different system parame-
ters which play a deﬁning role for our AngLoc’s performance.
In addition, some other experimental factors will also be
evaluated at the end of this section.

1) Impact of Packet Number Selection for Entropy Esti-
mation: Since the AR entropy estimation process requires
sufﬁcient CSI samples, larger number of samples can provide
more accurate entropy estimation but the computational cost
ramps up. How to determine the CSI packet number for
entropy calculation becomes a trade-off problem which needs
to be balanced in our localization system. Accordingly, we
put forward a variance based scheme to optimally select
the number of CSI packets for AR entropy estimation. The
motive lies in the fact that if the entropy variance is small
enough, which is fairly stable to guarantee a good accuracy,
there is no need to import more CSI samples to increase

computational burden. Concretely, by changing the packet
number ranging from 10 to 5000, we can observe in Fig. 12
that using 50 CSI packets can already provide stable enough
AR entropy estimates, thus leading to the robust ﬁngerprinting
performance. So we select and ﬁx this packet number for all
entropy estimations in our indoor location implementations.

2) Impact of Packet Number Selection for AoA Estimation:
Due to the spatial-temporal diversity of CSI measurements,
one CSI packet is able to derive the AoA estimate at one
time. Likewise, the excess usage of CSI packets increases the
unnecessary computational complexity while fewer number
of CSIs risks generating more error-prone AoA estimations.
On this basis, we devise an accuracy based packet number
selection scheme to efﬁciently conduct AoA calculation. Con-
sidering that the multi-packet smoothing is required in our
AngLoc system, we begin the testing packet number from 5
packets and extend it to 10, 15 and 40 packets, respectively. In
addition, since the LoS-friendly classroom is more convenient
and can provide a clear ground truth (direct path) to compare
the AoA estimation errors. It is thus chosen as the experimental
environment in this part. As shown in Fig. 13, we can observe
that even with 15 packets, our AngLoc system works well
and accurately identiﬁes the true AoA with a mean error
of 5 degrees, which shares the similar performance with 40
packets. The underlying explanation lies in the fact that once
we determine the ﬁrst arrival path through the smallest ToF,
more CSI packets will not bring further improvement with
regard to the AoA estimation accuracy.

3) Impact of Kernel Regression Parameters: Recall that
in the online location estimation phase, we ﬁrst ﬁnd Mc
closest RP locations in accordance with the amplitude’s AR
entropy. Then, a weighted bivariate kernel regression scheme
is proposed to accurately calculate the target’s location by
exploiting both entropy and AoA informations. As a result,
a proper selection of the relevant kernel regression parame-
ters in the ofﬂine phase is of great importance in the ﬁnal
localization outcome. As listed in Table I, by leveraging
leave-one-out cross-validation, we optimally choose the Mc,
weighting factors we, wa and kernel coefﬁcients ρe, ρa for
both testbeds. It is interesting to observe that in the larger and
more NLoS laboratory scenario, the AoA-driven RP reﬁning

1050100200500100020005000Number of CFR Packets00.020.040.060.08AR Entropy Variance01020304050AoA Errors (degree)00.20.40.60.81CDF 40 packets15 packets10 packets  5 packetsJOURNAL OF LATEX CLASS FILES, VOL. 14, NO. 8, AUGUST 2015

12

(a) Testbed #1

Fig. 15. Localization accuracy for the laboratory (Testbed #1)

(b) Testbed #2

Fig. 14. Optimal neighbor number selection for both (a) Testbed #1 and (b)
Testbed #2.

TABLE I
SUMMARY OF PARAMETERS FOR BOTH TESTBEDS

Parameters Mc

wa

we

ρa

ρe

Testbed #1

Testbed #2

12

8

0.57

0.43

0.14

0.23

0.38

0.62

0.33

0.17

scheme outweighs the AR entropy factor (i.e. wa > we), which
indicates the fact that the entropy metric tends to bring more
ambiguities in more complex environment. On the contrary,
the more LoS classroom testbed renders the AR entropy
competent enough to differentiate locations since the channel
property in such case appears to be more stable.

Furthermore, we also lay out the training results for choos-
ing parameter Mc in Fig. 14a and Fig. 14b from both labo-
ratory and classroom environments. Given a respective range
of [1, 20] and [1, 10], we can identify the optimal selection of
Mc for both testbeds as 12 and 8, under which the localization
mean errors reach minimum. It is fair to state that for the
larger and multipath-richer room, a greater number of RP
candidates should be required in order to well perform the
position determination.

4) Localization Accuracy in Both Testbeds: In this part, by
using the same parameters for all competing IPSs, we then
move forward to evaluate the localization performance and
present numerical results with relevant discussions.

By virtue of cumulative distribution function (CDF), we ﬁrst
evaluate the localization accuracy of our proposed AngLoc
system in comparison with the state-of-the-art. As can be
observed in Fig. 15, for the laboratory environment, our
proposed system is able to achieve the 90th percentile error
of 2.27m, which outperforms EntLoc, PinLoc-like, FIFS and

Fig. 16. Localization accuracy for the classroom (Testbed #2)

Horus systems with the same error level of 2.69m, 4.15m,
5.56m and 5.64m, respectively. Similarly, in the classroom
scenario, we can notice in Fig. 16 that AngLoc still precedes
other rivals in terms of 90th percentile error. Concretely, it
can ensure 90% of test locations have a positioning error
under 1.99m, surpassing EntLoc, PinLoc-like, FIFS and Horus
systems with the same error percentage of 82.1%, 64.3%,
57.1% and 28.6%, respectively.

Moreover, since the classroom environment is relatively
smaller and exposes more LoS radio propagation than the labo-
ratory testbed, a superior localization performance is expected
under the same conditions. We further display the mean error
bar plot in Fig. 17 to provide an intuitive comparison within
the ﬁve candidate systems. As expected, our proposed AngLoc
system shows a mean error of 1.18m in the lab and 0.95m
in the classroom, which even achieves the decimeter-level
localization accuracy, outperforming other counterparts in both
testbeds. Meanwhile, for all the competing IPSs, we can also
observe that the mean error performance in the classroom is
generally better than that in the laboratory scenario, which
further validates our previous assumption.

In order to provide an in-depth and comprehensive com-
parison for these localization systems, we also enumerate the
respective maximum error (Max. err.), minimum error (Min.

05101520Number of Closest Training Neighbors0123Mean Error (m)0246810Number of Closest Training Neighbors0123Mean Error (m)0246810Localization Error (m)00.20.40.60.81CDF AngLocEntLocPinLoc-likeFIFSHorus0123456Localization Error (m)00.20.40.60.81CDF AngLocEntLocPinLoc-likeFIFSHorusJOURNAL OF LATEX CLASS FILES, VOL. 14, NO. 8, AUGUST 2015

13

Fig. 17. Bar plot of localization mean error comparison for both testbeds.

Fig. 18. AoA estimation errors in LoS condition

TABLE II
LOCALIZATION ACCURACY FOR THE LAB SCENARIO

Methods

Max. err. Min. err. Mean err.

Acc. at 90%

AngLoc

EntLoc

PinLoc-like

FIFS

Horus

2.67m

3.20m

5.85m

7.70m

9.77m

0.16m

0.23m

0.46m

0.15m

0.55m

1.18m

1.84m

2.53m

2.83m

3.50m

2.27m

2.69m

4.15m

5.56m

5.64m

TABLE III
LOCALIZATION ACCURACY FOR THE CLASSROOM SCENARIO

Methods

Max. err. Min. err. Mean err.

Acc. at 90%

AngLoc

EntLoc

PinLoc-like

FIFS

Horus

2.14m

2.62m

2.99m

3.38m

4.67m

0.07m

0.04m

0.27m

0.51m

0.24m

0.95m

1.33m

1.72m

1.98m

2.44m

1.99m

2.20m

2.56m

2.94m

3.54m

err.), mean error (Mean err.) and the 90th percentile accuracy
(Acc. at 90%) in Table II and Table III for the laboratory
and classroom, respectively. As can be observed, apart from
the minimum error, our AngLoc system broadly dominates the
general accuracy evaluation for the maximum error, mean error
and 90th percentile accuracy. When it comes to the particular
minimum error, AngLoc only falls behind FIFS and EntLoc
with 0.01m and 0.03m in the respective testbed #1 and #2,
which can be reasonably neglected in both realistic indoor
environments.

5) AoA Estimation Accuracy in LoS Condition: In compar-
ison with our previous EntLoc system, the most productive
advancement for AngLoc is that CSI phase based AoA infor-
mation is organically combined to facilitate the improvement
of localization performance. Since one of SpotFi’s key insights
is to identify the direct path AoA for geometric mapping, even
in strong NLoS case, it still needs multiple APs to achieve
this through a likelihood scheme. In contrast, the inherent

Fig. 19. The box plot for AoA differences between 20 test locations and their
corresponding 4 neighboring RP locations.

the physical direct path
difference of our AngLoc is that
AoA is not necessary for ﬁngerprinting as long as the test
target’s AoA reading (i.e. the ﬁrst arrival path) is similar with
those of its neighboring RP locations. In order to create a fair
competition, we only compare the AoA estimation errors with
SpotFi under the LoS condition. For the NLoS scenario, we
design a different evaluation mechanism for the comparison
purpose, which will be discussed in the next part.

In practice, for the LoS classroom illustrated in Fig. 11, by
applying our AngLoc’s enhanced AoA estimation approach as
well as the SpotFi’s method, we record the AoA readings at all
40 RP locations and compare them with their corresponding
ground truth. Here it is worth mentioning that after obtain-
ing several AoA-ToF estimates (clusters) from multiple CSI
packets, SpotFi declares the direct path AoA from the cluster
with the highest likelihood value. For a fair comparison, we
modify the last part of SpotFi to determine the AoA from
the ﬁrst arrival path, which is exactly what we adopt in the
AngLoc system. As shown in Fig. 18, our AngLoc’s AoA
estimation method can yield the 90th percentile error of 17
degrees, outperforming SpotFi’s 26 degrees error in the LoS
condition. The total gain of nearly 10 degrees validates the
superior performance of our super-resolution JADE-MUSIC

AngLocEntLocPinLoc-likeFIFSHorus01234Mean Error (m)Testbed #1Testbed #201020304050AoA Errors (degree)00.20.40.60.81CDF AngLoc MethodSpotFi Method12341234Neighbor Index (AngLoc)      Neighbor Index (SpotFi)010203040506070AoA Difference (degree)JOURNAL OF LATEX CLASS FILES, VOL. 14, NO. 8, AUGUST 2015

14

algorithm.

6) Impact of AoA Proximity in NLoS Condition: For NLoS
environment such as the laboratory shown in Fig. 10, we
design and implement a dedicated experiment to manifest the
AoA based ﬁngerprinting feasibility of our AngLoc system.
Speciﬁcally, we ﬁrst choose 20 test locations which are in the
obvious NLoS conditions from the transmitter. Each of them is
surrounded by four predeﬁned RPs. After acquiring the AoA
estimates from all these test positions and their neighboring
RP locations, we then calculate the AoA differences between
location and its corresponding four RPs in the
each test
vicinity. As displayed in Fig. 19, compared with SpotFi’s
method, the box plot shows that our AngLoc’s AoA estimation
method is capable of deriving the overall lower level of AoA
differences with the four RP neighbors, which nicely indicates
the similar AoA estimations around the neighboring locations.
This advantage further promotes our AngLoc-derived AoA to
be a well-qualiﬁed position ﬁngerprint for the accurate indoor
location determination.

VI. DISCUSSION
In this section, we discuss several unsolved issues in this
paper and propose some possible solutions, which could
further enhance the performance of our proposed localization
system.

A. Device Orientation Calibration

During the ﬁngerprint site survey, we frequently move the
HummingBoard embedded antenna stand among all the RP
locations to collect CSI data. In principle, to achieve preferable
AoA estimations, one should always maintain the same device
orientation when moving the antenna stand from place to
place. Otherwise, it may incur additional manual operational
error for AoA estimates. To address this potential problem, the
commodity smart robot can be leveraged in our future work,
by which we can plan the moving path in advance and ﬁx the
device orientation automatically, thus further improving AoA
based location ﬁngerprinting accuracy.

B. Alternative Hardware Implementation

As aforementioned in Section V, our entire experimental
framework is established on the basis of commodity wireless
IWL 5300 NIC chipset, which provides IEEE 802.11n CSI
in a format of 30 subcarrier groups for both 20 MHz and 40
MHz bandwidth. In practice, this sets the limitation for some
CSI based applications which demand higher resolution of CSI
subcarriers. Such examples include human activity recognition
[44], indoor distance ranging [45] and so forth. Recently,
some other CSI tools like Atheros CSI tool [35] is getting
prevalent in the academic domain due to its non-grouping and
non-compressed CSI reporting. Unlike Intel’s 5300 NIC, the
Qualcomm Atheros NIC chipset is able to report CSI value
for each subcarrier, i.e., 56 subcarriers for 20MHz channel
and 114 subcarriers for a 40MHz channel. Furthermore, it can
also display detailed payload records and retrieve rich status
information about the received packet. These additional CSI
information can be of great value to help further enhance the
localization performance of our AngLoc ﬁngerprinting system.

VII. CONCLUSION

In this paper, we presented AngLoc, an AoA-aware proba-
bilistic indoor location ﬁngerprinting system using CSI infor-
mation. In AngLoc, a tap ﬁltering scheme was ﬁrst proposed to
remove the noisy component in raw CSI measurements. Mean-
while, for achieving accurate AoA estimation, we employed
several phase calibration techniques to further compensate CSI
phase errors. In the ofﬂine phase, we adopted AR modeling
entropy as the amplitude based ﬁngerprint since it captures
the most informative statistical information of CSI amplitude
while maintaining a simple structure. In addition, an enhanced
JADE-MUSIC algorithm was leveraged to derive AoA es-
timates as the CSI phase based ﬁngerprint. A robust radio
map containing both CSI amplitude and phase information is
then readily constructed. In the online phase, for a mobile
target, we ﬁrst narrowed down the candidate RP locations
by ﬁnding RPs with the smallest AR entropy differences. A
novel bivariate kernel regression method was then adopted
to precisely infer the target’s location. In comparison with
our previous EntLoc system, experimental results from the
lightweight HummingBoard device showed a superior local-
ization performance of our proposed AngLoc system with
an average accuracy improvement of 35.9% and 28.6% in
both laboratory and classroom testbeds. Additionally, we also
examined the impacts of several parameters on AngLoc’s
performance in different indoor scenarios, which empowers us
with deepening insights to efﬁciently and productively conduct
our indoor location ﬁngerprinting.

REFERENCES

[1] S. Kuutti, S. Fallah, K. Katsaros, M. Dianati, F. Mccullough, and
A. Mouzakitis, “A Survey of the State-of-the-Art Localization Tech-
niques and Their Potentials for Autonomous Vehicle Applications,”
IEEE Internet Things J., vol. 5, no. 2, pp. 829–846, 2018.

[2] F. Zafari, A. Gkelias, and K. K. Leung, “A Survey of Indoor Localization
Systems and Technologies,” IEEE Commun. Surveys Tuts., 2019.
[3] S. He and S.-H. G. Chan, “Wi-Fi Fingerprint-based Indoor Positioning:
Recent Advances and Comparisons,” IEEE Commun. Surveys Tuts.,
vol. 18, no. 1, pp. 466–490, 2015.

[4] D. Dardari, P. Closas, and P. M. Djuri´c, “Indoor Tracking: Theory,
Methods, and Technologies,” IEEE Trans. Veh. Technol., vol. 64, no. 4,
pp. 1263–1278, 2015.

[5] S. Liu, Y. Jiang, and A. Striegel, “Face-to-Face Proximity Estimation
using Bluetooth on Smartphones,” IEEE Trans. Mobile Comput., vol. 13,
no. 4, pp. 811–823, 2013.

[6] L. M. Ni, Y. Liu, Y. C. Lau, and A. P. Patil, “LANDMARC: Indoor
Location Sensing using Active RFID,” in Proc. IEEE PerCom, 2003,
pp. 407–415.

[7] A. Ward, A. Jones, and A. Hopper, “A New Location Technique for the
Active Ofﬁce,” IEEE Personal Commun., vol. 4, no. 5, pp. 42–47, 1997.
[8] R. Want, A. Hopper, V. Falcao, and J. Gibbons, “The Active Badge
Location System,” ACM Trans. Inf. Syst., vol. 10, no. 1, pp. 91–102,
1992.

[9] P. H. Pathak, X. Feng, P. Hu, and P. Mohapatra, “Visible Light Commu-
nication, Networking, and Sensing: A Survey, Potential and Challenges,”
IEEE Commun. Surveys Tuts., vol. 17, no. 4, pp. 2047–2077, 2015.
[10] Z. Yang, Z. Zhou, and Y. Liu, “From RSSI to CSI: Indoor Localization
via Channel Response,” ACM Comput. Surv., vol. 46, no. 2, p. 25, 2013.
[11] N. Tadayon, M. T. Rahman, S. Han, S. Valaee, and W. Yu, “Decimeter
Ranging with Channel State Information,” IEEE Trans. Wireless Com-
mun., 2019.

[12] M. Kotaru, K. Joshi, D. Bharadia, and S. Katti, “SpotFi: Decimeter
Level Localization using WiFi,” ACM SIGCOMM Comput. Commun.
Rev., vol. 45, no. 4, pp. 269–282, 2015.

JOURNAL OF LATEX CLASS FILES, VOL. 14, NO. 8, AUGUST 2015

15

[41] S. U. Pillai and B. H. Kwon, “Forward/Backward Spatial Smoothing
Techniques for Coherent Signal Identiﬁcation,” IEEE Trans. Acoust.,
Speech, Signal Process., vol. 37, no. 1, pp. 8–15, 1989.

[42] E. F. Krause, Taxicab Geometry: An Adventure in Non-Euclidean

Geometry. Courier Corporation, 1986.

[43] T. M. Cover and J. A. Thomas, Elements of Information Theory.

John

Wiley & Sons, 2012.

[44] J. Yang, H. Zou, H. Jiang, and L. Xie, “Device-free Occupant Activity
Sensing using WiFi-enabled IoT Devices for Smart Homes,” IEEE
Internet Things J., vol. 5, no. 5, pp. 3991–4002, 2018.

[45] H. Zhu, Y. Zhuo, Q. Liu, and S. Chang, “π-splicer: Perceiving accurate
csi phases with commodity wiﬁ devices,” IEEE Trans. Mobile Comput.,
vol. 17, no. 9, pp. 2155–2165, 2018.

[13] K. Wu, J. Xiao, Y. Yi, D. Chen, X. Luo, and L. M. Ni, “CSI-based
Indoor Localization,” IEEE Trans. Parallel Distrib. Syst., vol. 24, no. 7,
pp. 1300–1309, 2012.

[14] N. Alsindi, Z. Chaloupka, N. AlKhanbashi, and J. Aweya, “An Empirical
Evaluation of A Probabilistic RF Signature for WLAN Location Finger-
printing,” IEEE Trans. Wireless Commun., vol. 13, no. 6, pp. 3257–3268,
2014.

[15] M. Youssef and A. Agrawala, “The Horus WLAN Location Determina-

tion System,” in Proc. ACM MobiSys, 2005, pp. 205–218.

[16] J. Xiao, K. Wu, Y. Yi, and L. M. Ni, “FIFS: Fine-grained Indoor

Fingerprinting System,” in Proc. IEEE ICCCN, 2012, pp. 1–7.

[17] S. Sen, B. Radunovic, R. R. Choudhury, and T. Minka, “You are Facing
the Mona Lisa: Spot Localization using PHY Layer Information,” in
Proc. ACM MobiSys, 2012, pp. 183–196.

[18] Z. Zhou, Z. Yang, C. Wu, L. Shangguan, and Y. Liu, “Omnidirectional
Coverage for Device-Free Passive Human Detection,” IEEE Trans.
Parallel Distrib. Syst., vol. 25, no. 7, pp. 1819–1829, 2013.

[19] P. Mirowski, H. Steck, P. Whiting, R. Palaniappan, M. MacDonald,
and T. K. Ho, “KL-Divergence Kernel Regression for Non-Gaussian
Fingerprint based Localization,” in Proc. IEEE IPIN, 2011, pp. 1–10.

[20] L. Chen, I. Ahriz, D. Le Ruyet, and H. Sun, “Probabilistic Indoor
Position Determination via Channel Impulse Response,” in Proc. IEEE
PIMRC, 2018, pp. 829–834.

[21] J.-F. Bercher and C. Vignat, “Estimating the Entropy of a Signal with
Applications,” IEEE Trans. Signal Process., vol. 48, no. 6, pp. 1687–
1694, 2000.

[22] S. Kay, “Model-based Probability Density Function Estimation,” IEEE

Signal Process. Lett., vol. 5, no. 12, pp. 318–320, 1998.

[23] L. Chen, I. Ahriz, and D. Le Ruyet, “CSI-based Probabilistic Indoor
Position Determination: An Entropy Solution,” IEEE Access, vol. 7, pp.
170 048–170 061, 2019.

[24] A. F. Molisch, Wireless Communications.
John Wiley & Sons, 2012.
[25] M. C. Vanderveen, C. B. Papadias, and A. Paulraj, “Joint Angle and
Delay Estimation (JADE) for Multipath Signals Arriving at an Antenna
Array,” IEEE Commun. Lett., vol. 1, no. 1, pp. 12–14, 1997.

[26] K. Wu, J. Xiao, Y. Yi, M. Gao, and L. M. Ni, “FILA: Fine-grained
Indoor Localization,” in Proc. IEEE INFOCOM, 2012, pp. 2210–2218.
[27] J. Xiong and K. Jamieson, “ArrayTrack: A Fine-Grained Indoor Location

System,” in Proc. USENIX NSDI 13, 2013, pp. 71–84.

[28] D. Vasisht, S. Kumar, and D. Katabi, “Decimeter-Level Localization
with a Single WiFi Access Point,” in Proc. USENIX NSDI 16, 2016, pp.
165–178.

[29] P. Bahl and V. N. Padmanabhan, “RADAR: An In-Building RF-based
User Location and Tracking System,” in Proc. IEEE INFOCOM, vol. 2,
2000, pp. 775–784.

[30] X. Wang, L. Gao, S. Mao, and S. Pandey, “CSI-based Fingerprinting
for Indoor Localization: A Deep Learning Approach,” IEEE Trans. Veh.
Technol., vol. 66, no. 1, pp. 763–776, 2016.

[31] D. Halperin, W. Hu, A. Sheth, and D. Wetherall, “Tool Release: Gather-
ing 802.11n Traces with Channel State Information,” ACM SIGCOMM
Comput. Commun. Rev., vol. 41, no. 1, p. 53, Jan. 2011.

[32] C. Chen, Y. Chen, Y. Han, H.-Q. Lai, and K. R. Liu, “Achieving
Centimeter-Accuracy Indoor Localization on WiFi Platforms: A Fre-
quency Hopping Approach,” IEEE Internet Things J., vol. 4, no. 1, pp.
111–121, 2016.

[33] Z. Zhou, Z. Yang, C. Wu, L. Shangguan, H. Cai, Y. Liu, and L. M. Ni,
“WiFi-based Indoor Line-of-Sight Identiﬁcation,” IEEE Trans. Wireless
Commun., vol. 14, no. 11, pp. 6125–6136, 2015.

[34] Y. Ma, G. Zhou, and S. Wang, “WiFi Sensing with Channel State
Information: A Survey,” ACM Comput. Surv., vol. 52, no. 3, p. 46, 2019.
[35] Y. Zhuo, H. Zhu, H. Xue, and S. Chang, “Perceiving Accurate CSI
Phases with Commodity WiFi Devices,” in Proc. IEEE INFOCOM,
2017, pp. 1–9.

[36] Y. Ma, G. Zhou, S. Wang, H. Zhao, and W. Jung, “SignFi: Sign
Language Recognition using WiFi,” Proc. ACM Interact. Mob. Wearable
Ubiquitous Technol., vol. 2, no. 1, p. 23, 2018.

[37] S. M. Kay, Fundamentals of Statistical Signal Processing.

Prentice

Hall PTR, 1993.

[38] S. Kay, “Exponentially Embedded Families-New Approaches to Model
Order Estimation,” IEEE Trans. Aerosp. Electron. Syst., vol. 41, no. 1,
pp. 333–345, 2005.

[39] R. Schmidt, “Multiple Emitter Location and Signal Parameter Estima-
tion,” IEEE Trans. Antennas Propag., vol. 34, no. 3, pp. 276–280, 1986.
[40] N. Czink, M. Herdin, H. ¨Ozcelik, and E. Bonek, “Number of Multipath
Clusters in Indoor MIMO Propagation Environments,” Electron. Lett.,
vol. 40, no. 23, pp. 1498–1499, 2004.

