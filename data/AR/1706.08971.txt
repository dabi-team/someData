Astronomy & Astrophysics manuscript no. paper
September 8, 2021

c(cid:13)ESO 2021

7
1
0
2

n
u
J

7
2

]

O
C
.
h
p
-
o
r
t
s
a
[

1
v
1
7
9
8
0
.
6
0
7
1
:
v
i
X
r
a

Bayesian power-spectrum inference with foreground and target
contamination treatment

J. Jasche1 and G. Lavaux2, 3

1 Excellence Cluster Universe, Technische Universität München, Boltzmannstrasse 2, 85748 Garching, Germany
2 CNRS & Sorbonne Universités, UPMC Univ Paris 06, UMR7095, Institut d’Astrophysique de Paris, F-75014, Paris, France
3 Sorbonne Universités, Institut Lagrange de Paris (ILP), 98 bis bd Arago, 75014 Paris, France

Accepted 24/05/2017

ABSTRACT

This work presents a joint and self-consistent Bayesian treatment of various foreground and target contaminations when inferring cos-
mological power-spectra and three dimensional density ﬁelds from galaxy redshift surveys. This is achieved by introducing additional
block sampling procedures for unknown coeﬃcients of foreground and target contamination templates to the previously presented
ARES framework for Bayesian large scale structure analyses. As a result the method infers jointly and fully self-consistently three
dimensional density ﬁelds, cosmological power-spectra, luminosity dependent galaxy biases, noise levels of respective galaxy distri-
butions and coeﬃcients for a set of a priori speciﬁed foreground templates. In addition this fully Bayesian approach permits detailed
quantiﬁcation of correlated uncertainties amongst all inferred quantities and correctly marginalizes over observational systematic
eﬀects. We demonstrate the validity and eﬃciency of our approach in obtaining unbiased estimates of power-spectra via applica-
tions to realistic mock galaxy observations subject to stellar contamination and dust extinction. While simultaneously accounting for
galaxy biases and unknown noise levels our method reliably and robustly infers three dimensional density ﬁelds and corresponding
cosmological power-spectra from deep galaxy surveys. Further our approach correctly accounts for joint and correlated uncertainties
between unknown coeﬃcients of foreground templates and the amplitudes of the power-spectrum. An eﬀect amounting up to 10
percent correlations and anti-correlations across large ranges in Fourier space.

Key words. large scale – reconstruction – Bayesian inference

1. Introduction

In recent years the cosmological community has witnessed
great improvements in our understanding of the Universe. This
progress is particularly due to the spectacular results of the
Planck satellite mission and deep galaxy observations such as
the ones provided by the Baryon Oscillation Sky Survey (Planck
Collaboration et al. 2011; Dawson et al. 2013; Planck Collabora-
tion et al. 2016). These results put high standards for future anal-
yses of cosmological data with an ever increasing need to control
uncertainties and systematic eﬀects in observations in order not
to misinterpret data when searching for cosmological signals. To
address these needs, data science is challenged to provide ever
more robust data models accounting for complex systematic ef-
fects and allowing for accurate marginalization over unknowns
when interpreting cosmological data.

A particular challenge in existing and coming deep galaxy
redshift surveys arises from the need to properly understand se-
lection processes of galaxies from which cosmological surveys
are constructed (see e.g. Huterer et al. 2013). Such identiﬁcation
was conducted for mitigating star-galaxy contamination of the
ﬁrst SDSS photometric galaxy catalogue (Scranton et al. 2002).
The problem is further exacerbated by our lack of understanding
of galaxies as tracers of the underlying dark matter ﬁeld when
performing cosmological inference. In particular all our indi-
cators for completeness rely on the relative slow, homogeneous
and isotropic evolution of galaxy densities relative to dark matter
densities. If the observation is further hindered by instrumental

and/or terrestrial eﬀect, this leads to a complex and challenging
analysis problem.

In particular, Ross et al. (2011) and Ho et al. (2012) have
identiﬁed that contamination by bright stars alter signiﬁcantly
the intrinsic clustering signal of the observed photometric galaxy
sample at large scales. The last SDSS release based on DR12
photometry still shows this problems in the measured correlation
function (Ross et al. 2017). Eﬀects due to foreground stars, dust,
seeing, sky background intensity have the greatest potential to
cause systematic deviations in the clustering signal (see e.g. Ho
et al. 2015; Leistedt & Peiris 2014). Selection of spectroscopic
galaxies is not aﬀected immediately by the same eﬀect, but it is
subject to other systematics, such as ﬁbre collisions, target pri-
ority conﬂicts and ﬁbre plate ﬁxations. All these data contami-
nations constitute a particular nuisance, since foreground aﬀects
are also aﬀecting the noise properties of observed galaxy sam-
ples via varying attenuation or target contamination across the
sky.

In the large scale structure community, foreground eﬀects
are traditionally treated by weighting observed galaxies to ho-
mogenize the distribution of the traced density ﬁeld across the
sky (see e.g. Ross et al. 2011; Sánchez et al. 2013; Ross et al.
2017). This approach neglects possible and sometimes counter
intuitive correlations between contamination eﬀects and power-
spectrum amplitudes across large ranges in Fourier space. It also
ignores the eﬀects of modiﬁed observational noise properties due
to target contamination. There have also been several methods
proposed to account for additive contributions from unknown
foregrounds in photometric and spectroscopic galaxy observa-

Article number, page 1 of 15

 
 
 
 
 
 
A&A proofs: manuscript no. paper

data
d1, d2

new δ sample

b-1-1
b-1-1

density sampling
δ

b-1+1

new ¯N samples

P(k) sampling

b0-4

b0-3

b0-2

b0-1

b00

b0+1

b0+2

b0+3

b0+4

¯N sampling
¯N1, ¯N2

data
d1, d2

new P(k) sample

b1-4

b1-3

b1-2

b1-1

b10

b1+1

b1+2

b1+3

b1+4

new b samples

foreground
sampling

b2-1

new foreground
sample

bias sampling
b1, b2

data
d1, d2

data
d1, d2

Fig. 1. Flow chart depicting the multi-step iterative block sampling procedure exempliﬁed for two data sets. In the ﬁrst step a three dimensional
density ﬁeld will be realized conditional on the galaxy observations. In subsequent steps foreground template coeﬃcients, the bias parameters, the
power spectrum and the normalization parameters for the galaxy distribution are sampled conditional on respective previous samples. Iteration of
this process yields samples from the full joint posterior distribution.

tions (see e.g. Tegmark et al. 1998; Leistedt & Peiris 2014;
Ho et al. 2015). Also the literature on cosmic microwave back-
ground analyses provides a plenitude of approaches to account
for linear additive foreground contributions (see e.g. Tegmark &
Efstathiou 1996; Hinshaw et al. 2007; Eriksen et al. 2008; Sude-
van et al. 2016; Vansyngel et al. 2016; Elsner et al. 2017).

However, all these approaches do not properly account for
multiplicative foreground and target contaminations which also
aﬀect the noise. In this work we expand on the idea that fore-
ground eﬀects are more closely related to multiplicative rather
than additive contributions. This is similar to the discussion pre-
sented in Huterer et al. (2013), who used a multiplicative correc-
tion in observed galaxy densities.

In this work we seek to account for these eﬀects when infer-
ring cosmological power-spectra from observations. Literature
provides a plenitude of various statistically more or less rigorous
approaches to measure power-spectra. Several of these methods
rely on Fourier transform based methods or exploit Karhunen-
Loève or spherical harmonics decompositions (see e.g. Feldman
et al. 1994; Tegmark 1995; Hamilton 1997a; Yamamoto 2003;
Percival et al. 2004; Tegmark et al. 1997, 2004; Pope et al. 2004;
Fisher et al. 1994; Heavens & Taylor 1995; Tadros et al. 1999;
Percival et al. 2004; Percival 2005). Other approaches aim at in-
ferring the real space power spectrum via likelihood methods
(Ballinger et al. 1995; Hamilton 1997a,b; Tadros et al. 1999; Per-
cival 2005).

In the Bayesian community several approaches have been
proposed to jointly infer three dimensional density ﬁelds and
their corresponding cosmological power-spectra (see e.g. Jasche
et al. 2010; Granett et al. 2012; Alsing et al. 2016). Also note,
that similar approaches explored for analyses of cosmic mi-
crowave background data (see e.g. Wandelt et al. 2004; O’Dwyer
et al. 2004; Eriksen et al. 2004; Jewell et al. 2004; Larson et al.
2007; Eriksen et al. 2007; Jewell et al. 2009).

To account for such eﬀects of foreground and target contam-
ination in a statistically rigorous fashion, we propose a hierarchi-

Article number, page 2 of 15

cal Bayesian approach to jointly and self-consistently infer three
dimensional density ﬁelds, corresponding power-spectra and co-
eﬃcients of a set of diﬀerent foreground templates. In partic-
ular this work builds upon our previously developed Bayesian
inference algorithm ARES (Algorithm for REconstruction and
Sampling) (see e.g. Jasche et al. 2010; Jasche & Wandelt 2013;
Jasche & Lavaux 2015; Lavaux & Jasche 2016).

The manuscript is structured as follows. In Section 2 we give
a brief overview of the statistical model that we propose. First
we remind in Section 2.1 the hierarchical Bayesian inference ap-
proach on which our code, ARES, is based. Then we describe in
Section 2.2 the necessary modiﬁcations of the model for fore-
ground eﬀects and in Section 2.3 the modiﬁcation to the origi-
nal inference algorithm. In Section 3 we describe the generation
of artiﬁcial data used to test the performance of the sampling
framework in section 4. Finally we discuss our results and give
an outlook on future applications in Section 5.

2. The Bayesian inference model

This section provides a brief overview over our previously pre-
sented Bayesian inference framework ARES (see e.g. Jasche et al.
2010; Jasche & Wandelt 2013; Jasche & Lavaux 2015). We will
also give a detailed description of the modiﬁcations enabling
us to account for foreground and target contamination in deep
galaxy observations.

2.1. The ARES framework

As discussed in the introduction, the current work builds upon
the previously developed Algorithm for Reconstruction and
Sampling ARES (see e.g. Jasche et al. 2010; Jasche & Wandelt
2013; Jasche & Lavaux 2015). This full Bayesian large scale
structure inference method aims at precision inference of cos-
mological power-spectra from galaxy redshift surveys. Specif-
ically it performs joint inferences of three dimensional density

J. Jasche and G. Lavaux: Bayesian power-spectrum inference with foreground and target contamination treatment

Fig. 2. We show here the foreground templates (top row) and the observed sky completenesses (bottom row) used to generate and analyse the
mock catalogue in this work. The upper left panel shows the reddening map derived from the data of Schlegel et al. (1998). The upper right panel
is a star map count obtained as detailed in Section 3. The lower left panel gives the observed completeness for the mock CMASS survey and the
lower right panel for the mock LOW-Z survey. These maps have been generated from SDSS-DR12 data (Eisenstein et al. 2011).

ﬁelds, cosmological power spectra as well as luminosity depen-
dent galaxy biases and corresponding noise levels for diﬀerent
galaxy populations in the survey (Jasche et al. 2010; Jasche &
Wandelt 2013; Lavaux & Jasche 2016).

In particular the ARES algorithm addresses a large scale data
interpretation problem involving many millions of parameters.
In the following, for the sake of clarity, we will describe the
corresponding data model in case of a single galaxy population.
The generalization of this data model to account for an arbitrary
number of galaxy populations with respective stochastic and sys-
tematic uncertainties has been described in our previous works
(Jasche & Wandelt 2013; Lavaux & Jasche 2016). In case of a
single galaxy population the data model is given as:
Ni = ¯NRi(1 + bDiδi) + (cid:15)i,
(1)
where Ni is the number of galaxies in the i-th grid element, ¯N
is the mean density of the galaxy population, Ri is the overall
linear response operator of the survey, describing redshift and
target completeness, b is the galaxy population bias, Di is the
cosmic growth factor at the position of i-th grid element, δi is
the density contrast at a reference redshift in this same grid el-
ement and (cid:15)i denotes random but structured instrumental noise.
Also, as described in our previous work, the observational noise
will be assumed to be a Gaussian approximation to Poissonian
noise, neglecting the inﬂuence of the signal itself. This assump-
tion yields the corresponding noise covariance matrix as:
(cid:104)(cid:15)i(cid:15) j(cid:105) = ¯NRiδK
i, j,

(2)
i, j being the Kronecker-Delta (i.e. equal to one if i = j
with δK
and zero otherwise). Finally, we assume a homogeneous and

isotropic Gaussian prior for density contrast amplitudes δi. For
further details please consult our previous work Jasche & Wan-
delt (2013).

In order to provide full Bayesian uncertainty quantiﬁca-
tion the algorithm explores the joint parameter space of density
ﬁelds, power-spectra, galaxy biases and noise parameters via an
eﬃcient block sampling scheme. We show in Figure 1 a visual-
ization of this iterative sampling procedure including the fore-
ground sampling method presented in this work. Iterative execu-
tion of these respective sampling steps provides us with a valid
Markov chain and a numerical representation of the full joint
target posterior distribution. Also note, we use here an upgraded
version of the ARES algorithm for which we employ the messen-
ger method discussed in Elsner & Wandelt (2013). This particu-
lar implementation of the Wiener posterior sampling method has
been demonstrated to improve upon the statistical eﬃciency of
previous implementations (Jasche & Lavaux 2015).

2.2. The foreground and target contamination model

Spectroscopic completeness is generally computed by the ratio
of the number of observed spectra and the number of all photo-
metric targets for a given area in the sky. This ratio is assumed
to hold for any pointing of this area. However besides galaxies
also a number of unknown contamination can contribute or aﬀect
observed photometric targets, artiﬁcially increasing or depleting
their local number density. This contamination may include e.g.
foreground stars, dust absorption or eﬀects due to seeing. Naive
estimate of the spectroscopic completeness from data therefore
does not reﬂect the actual probability of obtaining a galaxy spec-

Article number, page 3 of 15

Dust map¡2:71:8log10(E(B¡V))Star density map06(£106 stars/steradian)CMASS completeness01completenessLOWZ completeness01completenessA&A proofs: manuscript no. paper

trum at a given position in the sky. From observations we can
build an estimate of the completeness by calculating the ratio of
the number of observed galaxy spectra Ng
i,spectro and the number
of target galaxies Ng
i,targets, both in the direction of the pixel i in
the sky:

Ci,obs =

Ng
i,spectro
Ng

i,targets

=

Ng
i,spectro
Ng

i,photo

Ng
Ng

i,photo

i,targets

= Ci M−1
i

,

(3)

with Ng
i,photo being the actual true number of galaxies that should
have been identiﬁed by photometry and Mi is the ratio of all
the observed photometric targets Ng
i,targets to the true sample of
target galaxies Ng
i,photo. Equation (3) demonstrates the dilemma,
that given some spectroscopic information (for which objects
can clearly be identiﬁed as galaxies) there is no immediate way
to decide how many galaxies were in the actual target sam-
ple. In Equation (3) this mismatch is quantiﬁed by the ratio
Mi = Ng
i,photo between the number of real photometric
targets that should have been chosen vs the actual but unknown
number of all galaxy targets.

i,targets/Ng

We expect two possible contributions to Mi: either there is an
excess in the number of targets because the photometric infor-
mation was insuﬃcient to separate galaxies from stars or other
objects in the sky, or there is a lack of galaxies that have not
been detected due to, e.g., low surface brightness or dust absorp-
tion. Assuming such foreground contributions to be mild per-
turbations, the corresponding contamination map M on the sky
can be expressed as a product of small contaminants (greater or
lesser than one). Individual contaminations can then be modelled
via respective foreground templates. Note that this approach has
also been adopted by the BOSS collaboration to correct their
measurement of the cosmological power-spectrum (Ross et al.
2011; Ho et al. 2012; Anderson et al. 2012). Given this assump-
tion we can express individual Mi as:

Nfg
(cid:89)

(1 − αnFn,i),

Mi =

n=0

(4)

where Fn,i is the foreground template of the n-th contribution at
the i-th pixel of the map, αn is the amplitude of respective fore-
ground templates, Nfg is the total number of foreground maps.
We note that diﬀerent surveys or even diﬀerent sub-samples of
observed galaxies may be subjected to diﬀerent foreground ef-
fects. To consistently account for all these foreground eﬀects
when jointly analysing individual or several data sets the orig-
inal data model implemented in ARES needs to be modiﬁed by
a multiplicative correction of the survey response operator Rc
i .
Speciﬁcally, we model the observed number of galaxies Nc
i in a
survey as:

Nc
i

= ¯Nc Mi({αc

n})Rc

i (1 + bcDiδi) + (cid:15)c
i ,

(5)

where the additive noise contribution (cid:15)c
Gaussian distribution with covariance matrix given as:

i drawn from a zero mean

i (cid:15)c(cid:48)
(cid:104)(cid:15)c

j (cid:105) = ¯Nc Mi({αc

n})Rc

i δK

i, jδK

c,c(cid:48) .

(6)

The superscript c indicates diﬀerent considered catalogues.
These modiﬁcations render the posterior distribution of δi more

Article number, page 4 of 15

Fig. 3. The plot gives the radial selection functions for the CMASS and
LOW-Z sample that we have used to generate the mock data to closely
resemble the actual SDSS3 BOSS data. The CMASS selection is given
in thick solid (North Galactic Cap) and dashed line (South Galactic
Cap). The LOWZ selection is given in thin dash-dotted (North Galactic
Cap) and dotted lines (South Galactic Cap).

complex. By construction the likelihood is given as:

Nc
(cid:89)

Nv
(cid:89)

(cid:16)

c=0

i=0

¯Nc Mi({αc

n})Rc
i

(cid:17)−1/2

L({Nc

i }|{δi}, { ¯Nc}, {bc}) ∝

(cid:40)

exp

−

1
2

1

¯Nc Mi({αc

n})Rc
i
(cid:104)

c − ¯Nc Mi({αc
Ni

n})Rc

i (1 + bcDiδi)

(cid:105)2(cid:27)

.

(7)

It should be remarked that foreground contributions, as modelled
here, are not just mere additive contributions to the signal to in-
fer, but they also have pronounced impact on the varying noise
properties across the survey. Hence, as can be seen from Equa-
tion (7) inferring the foreground coeﬃcients {αn} is a highly non-
linear analysis task.

2.3. Sampling foreground coefﬁcients

As described by the likelihood distribution given in Equation (7)
foregrounds of diﬀerent catalogues as labelled by the superscript
c can be sampled independently. For this reason and without loss
of generality here we provide the sampling procedure for a single
galaxy catalogue only. Then the conditional posterior distribu-
tion for the coeﬃcients {αn} of respective foreground templates
can be written as:

(cid:16)

(cid:17)
{αn}|{Ni}, {δi}, { ¯N}, {b}

P

∝

(8)
where P ({αn}) is the prior of foreground coeﬃcients and
L({Ni}|{δi}, { ¯N}, {b}, {αn}) is the likelihood for a single catalogue

P ({αn}) L({Ni}|{δi}, { ¯N}, {b}, {αn}) ,

0500100015002000Comoving Distance (h¡1 Mpc)0.00.20.40.60.81.01.2Normalized selection rateCMASS NGCCMASS SGCLOWZ NGCLOWZ SGCJ. Jasche and G. Lavaux: Bayesian power-spectrum inference with foreground and target contamination treatment

as given by Equation (7). In the absence of any further infor-
mation on the amplitudes of foreground coeﬃcients αn we fol-
low the maximal agnostic approach by using a uniform prior
P ({αn}) = 1. It can be seen from Equations (8) and (7) that
conditional posterior distribution does not factorize in the coef-
ﬁcients αn for respective foreground templates. To correctly ac-
count for the conditional dependencies between the coeﬃcients
{αn}, we propose to use a block sampling procedure to sequen-
tially draw random variates of αn with respect to all other val-
ues. This is achieved by introducing the following sequence of
sequential sampling steps to the full ARES framework:

α0 ∼ P

α1 ∼ P

α2 ∼ P
...
αN f g−1 ∼ P

(cid:16)
α0|{αn} \ α0, {Ni}, {δi}, { ¯N}, {b}
(cid:16)
α1|{αn} \ α1, {Ni}, {δi}, { ¯N}, {b}
(cid:16)
α2|{αn} \ α2, {Ni}, {δi}, { ¯N}, {b}

(cid:17)

(cid:17)

(cid:17)

(cid:16)

(cid:17)
αN f g−1|{αn} \ αN f g−1, {Ni}, {δi}, { ¯N}, {b}

where the symbol "∼" indicates a random draw from respective
distributions. This sampling procedure integrates well into the
ARES framework as indicated in Fig. 1. Despite the fact that
drawing respective realizations of the foreground coeﬃcients
{αn} is a non-linear process, there exists a direct sampling proce-
dure. The detailed derivation of the foreground coeﬃcient sam-
pler is presented in Appendix A. The detailed algorithm for gen-
erating respective random variates is given in Algorithm 1.

3. Generation of Gaussian mock data

To test the validity and performance of the modiﬁed ARES sam-
pling framework we follow a similar approach as discussed in
our previous works (Jasche et al. 2010; Jasche & Wandelt 2013;
Jasche & Lavaux 2015). These mock catalogues are generated
in accordance with the data model described in Equation (7), in-
cluding various foreground eﬀects. We generate artiﬁcial galaxy
data on a cubic equidistant grid of side length 4000 h−1Mpc con-
sisting of 2563 grid nodes.

First a realization of a cosmic density contrast ﬁeld δi is
drawn from a zero-mean normal distribution with covariance
matrix corresponding to a cosmological power-spectrum. This
spectrum, including baryon acoustic oscillations, is calculated
according to the prescription described in Eisenstein & Hu
(1998) and Eisenstein & Hu (1999). For numerical evaluation
we assume a ΛCDM cosmology with the set of parameters given
as (Ωm = 0.3089, ΩΛ = 0.6911, Ωb = 0.0485, h = 0.6774,
σ8 = 0.8159, ns = 0.9667), as determined by Cosmic Mi-
crowave Background observations of the Planck satellite mission
(Planck Collaboration et al. 2016).

Following a similar description as discussed in Jasche &
Wandelt (2013), we intent to create a realistic scenario to jointly
analyse the SDSS DR7 main, the CMASS and the LOW-Z
galaxy sample while accounting for their respective systematic
eﬀects. Corresponding artiﬁcial data sets are then drawn from
the distribution given in Equation (7). These artiﬁcial data sets
include the eﬀects of noise, galaxy bias, survey geometries, se-
lection and foreground eﬀects. For the sake of this work we re-
strict our tests to accounting for the dominant foreground eﬀects
of dust extinction and stellar contamination. The templates for
these two eﬀects are presented in the upper panels of Fig. 2 the
lower panels show the completeness masks for the respective
surveys.

Fig. 4. The plot shows the sequence of posterior power-spectrum real-
izations during the initial sampling steps of the Markov chain as indi-
cated by the colour-bar in the plot. As can be seen the Markov chain
performs a coherent drift from an over-disperse initial state towards the
preferred region in parameter space. This initial burn-in phase lasts for
∼ 2000 Markov transitions.

The map describing dust extinction has been generated
straightforwardly from the SFD maps (Schlegel et al. 1998). In
particular we constructed a HEALPix map of the reddening at
Nside = 2048 by linearly interpolating the values of the SFD map
(Górski et al. 2005). The star map is built from diﬀerent pieces of
information. The ﬁrst component consists in computing a MAN-
GLE description1 of the geometry of the spectroscopic plates.
We then count the number of stars with apparent magnitudes
20.3 < iPSF < 20.6 present in each single non-overlapping poly-
gon. We convert these MANGLE description into an HEALPix
map and divide the value in each pixel by the area of the overlap-
ping polygon. This results in a map for which each pixel has an
estimated star count by steradians, thus a star density. We have
chosen to average by spectroscopic plates to reduce shot-noise in
the estimate. A better estimate would have been obtained from
the geometrical description of the photometric tiling but at the
cost of increased noise.

Further, for the SDSS DR7 main sample component of the
mock data we assume a radial selection function following from
a standard Schechter luminosity function with standard r-band
parameters (α = −1.05, M∗ − 5log10(h) = −20.44), and we limit
the survey to only include galaxies within an apparent Petrosian
r-band magnitude range 13.5 < r < 17.6 and within the absolute
magnitude ranges Mmin = −17.0 to Mmax = −23.0. As usual,
the radial selection function f (z) is then given by the integral
of the Schechter luminosity function over the range in absolute
magnitude.

For the CMASS and LOW-Z component we have used nu-
merical estimates of the selection functions by computing a his-
togram of the corresponding N(d) in the actual data sets (e.g. for
DR12 Ross et al. 2017) (d being the co-moving distance from

1 MANGLE software is originally provided by Swanson et al. (2008).

Article number, page 5 of 15

10-210-1k (h Mpc¡1)103104105106107108109P(k) (h3 Mpc¡3)040080012001600MCMC stepA&A proofs: manuscript no. paper

Fig. 5. Correlation length of the sampler for diﬀerent modes as indicated by the colour bar on the left. As can be seen most of the modes have
typical correlation lengths on the order of xxx samples. Some large scale modes exhibit longer correlation length as explained in the text.

the observer). To account for the diﬀerent selection eﬀects in
the northern and southern galactic plane we also split our mock
data sets into the CMASS and LOW-Z catalogues correspond-
ingly. The respective radial selection functions are presented in
Fig. 3. The average of the product of the two dimensional survey
geometry Cc( ˆx) = Cc
i( ˆx) and the selection function f (x) at each
grid element in the three dimensional volume yields the survey
response operator:

Rc
i

= 1
|Vi|

(cid:90)

Vi

d3x Cc( ˆx) f c(x) ,

(9)

with |V| the volume of the set V, Vi indicating the volume rep-
resented by the i-th grid element.

Given these deﬁnitions and a realization of the three dimen-
sional density ﬁeld δi, realizations of artiﬁcial galaxy observa-
tions for respective catalogues labelled with c can be obtained
by evaluating:

Nc
i

= ¯Nc Rc

i Mc

i (1 + bcδi) +

(cid:113)

¯Nc Rc

i Mc

i (cid:15)i ,

(10)

where (cid:15)i is a white-noise ﬁeld drawn from zero-mean and unit
variance normal distribution.

4. Results

In this section we discuss results obtained by applying the mod-
iﬁed ARES algorithm to artiﬁcial mock data. In particular in this
work we focus on the validity and statistical eﬃciency of the
algorithm.

Jasche et al. 2010; Jasche & Wandelt 2013; Jasche & Lavaux
2015). In particular we test the initial burn-in phase by starting
the sampler from an over dispersed state and monitoring transi-
tions in parameter space as a sequence of steps in the Markov
chain. Typically this test reveals a coordinated drift of inference
parameters towards their target values. Once the chain moved to
a preferred region in parameter space it starts to correctly explore
the target posterior distribution via the random walk Gibbs sam-
pling approach. At this stage it is assumed that the sampler has
passed the initial burn-in phase and we start recording samples
of the Markov chain. In Fig. 4 we show the sequence of sampled
posterior power-spectra during the burn-in phase. For this test
we started from an over dispersed state by multiplying the initial
guess of a Gaussian random density contrast ﬁeld by a factor of
0.1. Fig. 4 nicely demonstrates the initial drift towards the pre-
ferred region in parameter space. As can be seen the initial burn
in phase consists of about ∼ 2000 Markov steps. As a side re-
mark we note that generation of individual samples require an
investment of ∼ 1.87 CPU-hours per sample for the present sce-
nario of dealing with ﬁve diﬀerent galaxy sub-catalogues and
two foregrounds.

To further test the statistical eﬃciency of the Gibbs sampling
procedure we estimated its eﬃciency in generating independent
Markov samples. Generally subsequent samples in a Markov
chain are correlated and do not qualify for independent samples
of the target posterior distribution. To estimate how many inde-
pendent samples can be drawn from a Markov chain with a given
number of transition steps one has to determine the length over
which sequential samples are correlated. This correlation length
characterizes the statistical eﬃciency of generating independent
realizations of a parameter θ as follows:

4.1. Statistical efﬁciency of the sampler
To test the statistical eﬃciency of our sampler we follow a stan-
dard test procedure as described in previous works (see e.g.

C(θ)n =

1
N − n

N−n(cid:88)

i=0

θi − (cid:104)θ(cid:105)
√
Var (θ)

θi+n − (cid:104)θ(cid:105)
√
Var (θ)

,

(11)

Article number, page 6 of 15

0100200300400500600Distance along the chain−0.20.00.20.40.60.81.0Correlation0.000.120.240.36k (h Mpc¡1)0100200300400500600Distance along the chain−0.20.00.20.40.60.81.00.000.120.240.36k (h Mpc¡1)J. Jasche and G. Lavaux: Bayesian power-spectrum inference with foreground and target contamination treatment

Fig. 6. Marginalized 2d probability distributions for foreground contamination coeﬃcients of the ﬁve mock catalogues used in this analysis. Green
lines indicate the true values of foreground coeﬃcients as used for the generation of the artiﬁcial mock galaxy survey. As can be seen diﬀerent
panels show various degrees of correlation between inferred coeﬃcients that are correctly accounted for by our Markov chain.

where n is the distance in the chain measured in iterations,
(cid:104)θ(cid:105) = 1/N (cid:80)
i θi and Var (θ) = 1/N (cid:80)
and N is the
total number of samples in the chain.

θi − (cid:104)θ(cid:105)

(cid:17)2

(cid:16)

i

As an illustration in Fig. 5 we show the correlation length
for the power-spectrum amplitudes of diﬀerent modes in Fourier
space, as indicated in the plot. It can be seen that the typical cor-
relation length for a BOSS like survey analysis is on the order of
∼ 100 Markov transitions. These results demonstrate the numer-
ical feasibility of complex full Bayesian analyses of present and
next generation surveys.

4.2. Inference of template coefﬁcients

As discussed above the proposed hierarchical Bayesian infer-
ence machine aims to account for the uncertainties of systematic
eﬀects arising from foreground eﬀects. In particular the ARES
framework correctly accounts for all joint and correlated uncer-
tainties of diﬀerent inference parameters and even across the ﬁve
diﬀerent mock galaxy surveys as used in this work. To illustrate
this fact in Fig. 6 we present two dimensional marginal posterior
distributions for the corresponding foreground template coeﬃ-
cients. As can be seen, diﬀerent panels indicate various degrees
of correlation between diﬀerent foreground coeﬃcients across

Article number, page 7 of 15

1.71.92.12.3®C0;F10.00.20.40.60.81.01.71.81.92.02.12.22.3®C0;F11.71.81.92.02.12.22.3®C1;F11.71.92.12.3®C1;F10.00.20.40.60.81.01.71.81.92.02.12.22.3®C0;F11.71.81.92.02.12.22.3®C2;F11.71.81.92.02.12.22.3®C1;F11.71.81.92.02.12.22.3®C2;F11.71.92.12.3®C2;F10.00.20.40.60.81.01.71.81.92.02.12.22.3®C0;F11.71.81.92.02.12.22.3®C3;F11.71.81.92.02.12.22.3®C1;F11.71.81.92.02.12.22.3®C3;F11.71.81.92.02.12.22.3®C2;F11.71.81.92.02.12.22.3®C3;F11.71.92.12.3®C3;F10.00.20.40.60.81.01.71.81.92.02.12.22.3®C0;F11.71.81.92.02.12.22.3®C4;F11.71.81.92.02.12.22.3®C1;F11.71.81.92.02.12.22.3®C4;F11.71.81.92.02.12.22.3®C2;F11.71.81.92.02.12.22.3®C4;F11.71.81.92.02.12.22.3®C3;F11.71.81.92.02.12.22.3®C4;F11.71.92.12.3®C4;F10.00.20.40.60.81.0A&A proofs: manuscript no. paper

Fig. 7. Ensemble mean of the eﬀective survey response operator (left panel) and corresponding standard deviation map (right panel). The ensemble
mean is renormalized by the largest pixel value, as the absolute value does not have an meaning independent of the mean density ¯N and the radial
selection function. The two above maps should be compared to the north galactic cap of the map in the lower right panel of Figure 2. The ensemble
mean is quite diﬀerent ought to the introduced star contamination which could introduce contamination in targets. This manifests itself by an
over-completeness on the edge of the map. The right map shows a similar trend but touching the uncertainty on the selection this time.

Fig. 8. Slices through three dimensional ensemble mean (left panels) and variance ﬁelds (right panels). Top panels show results obtained with
foreground correction while bottom panels show results without any foreground correction. As for the power-spectrum, we ﬁnd an excessive large
scale power when foreground corrections are not applied. Computing the foreground self consistently results in a non contaminated reconstruction.
The variance ﬁelds are also aﬀected as it is possible to see that the bottom is notably darker in average compared to the top slice, which indicates
higher variance.

Article number, page 8 of 15

Mock LOWZ reconstructed completeness01completenessMock LOWZ completeness uncertainty00.003completeness−1800−6006001800Equatorial X (Mpc/h)−1800−6006001800Equatorial Y (Mpc/h)−1.0−0.50.00.51.01.52.02.53.0±−1800−6006001800Equatorial X (Mpc/h)−1800−60060018000.40.60.81.01.21.41.61.82.0¾±−1800−6006001800−1800−6006001800Equatorial Y (Mpc/h)−1.0−0.50.00.51.01.52.02.53.0±−1800−6006001800−1800−60060018000.40.60.81.01.21.41.61.82.0¾±J. Jasche and G. Lavaux: Bayesian power-spectrum inference with foreground and target contamination treatment

Fig. 9. Univariate posterior distributions of power-spectrum amplitudes for a test without (left panel) and with (right panel) foreground corrections
over the full range of Fourier modes considered in this work. Red lines correspond to the true underlying cosmological power-spectrum from which
mock data sets were generated. The left panel clearly shows that uncorrected foreground eﬀects yield excessive power for large scale modes and
also introduces an overall biased result. In contrast the right panel shows results obtained from our test with foreground corrections. It can be
clearly seen, that detailed treatment of all foreground eﬀects permits us to obtain an unbiased measurement of power-spectrum amplitudes over
the full range of Fourier modes.

the ﬁve mock catalogues. We would also like to point out that
generally, distributions for foreground template coeﬃcients are
highly non-Gaussian, and can have sharp transitions due to the
requirement that eﬀective contamination templates are required
to have a positive sign.

As an interesting by-product of our sampling procedure we
are able to provide eﬀective survey response maps which account
for the a priori unknown systematics due to foreground and tar-
get contamination. In particular mean and standard deviations of
such maps can be estimated by evaluating Equation (4) for every
foreground template parameter coeﬃcient in the Markov chain
and multiplying it with the estimated completeness map Ci,obs.
The result is demonstrated in Fig. 7. It can be seen that most
corrections appear at the boundary of the mask. These are the
regions most aﬀected by foreground stars in our test scenario.
Note, that corresponding standard deviations, as shown in the
right panel of Fig. 7, also show increased uncertainty in these
regions. This demonstrates that the algorithm accounts for larger
uncertainty for more unreliable portions of the data, and opti-
mally extracts cosmological information from observations, as
discussed in the following.

two Markov chains we can calculate the ensemble mean density
and corresponding variance ﬁelds. Results are presented in Fig.
8. As can be seen, the analysis without a detailed treatment of
foreground contaminations shows residual large scale features
and erroneous power particularly close to the survey boundaries.
These regions are aﬀected the most by stellar contamination as
indicated by the corresponding foreground map shown in Fig. 2.
In contrast our ARES run with detailed Bayesian foreground
treatment shows a homogeneous density distribution throughout
the entire observed domain. Also note that variance maps of the
corrected and uncorrected ARES run look very similar. Appar-
ently the erroneous features in the uncorrected ARES analysis
do not aﬀect the corresponding variance map. Since for the un-
corrected run, the data model does not account for the system-
atic uncertainties associated to foreground contaminations, the
reconstructed erroneous large scale power in the ﬁeld will be
fully attributed to the inferred large scale structure. From Fig. 8
it is visually evident that our data model including the treatment
of foreground contaminations is much more robust against such
misinterpretations. In the following we will have a closer look at
inferred cosmological power-spectra.

4.3. Inferred three dimensional density ﬁelds

4.4. Inferred cosmological power-spectra

Although this work focusses primarily on the inference of cos-
mological power-spectra it is instructive to also look at inferred
three dimensional density ﬁelds. In particular we would like to
highlight the impact of foreground contaminations on the infer-
ence of density ﬁelds from galaxy redshift surveys. To do so
we compare two ARES analyses of the generated mock galaxy
catalogue, with and without foreground treatment. From these

One of the most important features of the ARES algorithm is its
ability to jointly infer three dimensional density ﬁelds, corre-
sponding cosmological power-spectra, galaxy biases, noise lev-
els and coeﬃcients of several foreground templates including a
detailed treatment of all joint and correlated uncertainties. Since
the ARES framework yields proper Markov chains we are able to
correctly marginalize over all joint uncertainties, when focussing

Article number, page 9 of 15

10-210-1k (h Mpc¡1)10210310410510610-210-1k (h Mpc¡1)102103104105106P(k) (Mpc3 h¡3)0246810Counts (£103)0246810Counts (£103)A&A proofs: manuscript no. paper

Fourier space. In particular we calculated the cross correlation
matrix between the foreground coeﬃcients of the ﬁve mock cat-
alogues and power-spectrum amplitudes from the posterior sam-
ples of the corresponding Markov chain. Results are presented in
Fig. 10. It can be seen that correlations and anti-correlations can
amount of up to ten percent across all modes in Fourier space.

Additionally we tested whether the sampler correctly ac-
counts for the combined eﬀects of foreground contaminations,
galaxy biases and unknown noise amplitudes by estimating the
co-variance matrix of inferred power-spectra from the ARES
runs. As can be seen in Fig. 11 the co-variance matrix for both
runs exhibit strong diagonal shape indicating that the algorithm
correctly accounted for the otherwise erroneous mode coupling
introduced by survey geometry and foreground eﬀects. Residual
oﬀ-diagonal contributions amount to less than ten percent.

These results clearly demonstrate the feasibility of dealing
with strong but unknown foreground contaminations when infer-
ring cosmological power-spectra from deep galaxy observations.

5. Summary and Conclusion

Major challenges for the analysis of next generation deep galaxy
redshift surveys arise from the requirement to account for an in-
creasing amount of systematic and stochastic uncertainties. In
particular foreground eﬀects and target contaminations due to
e.g. stars and dust, can greatly aﬀect the observation of galaxies.
If not accounted for properly, these eﬀects can yield erroneous
modulations of galaxy number counts across the sky, which hin-
ders the immediate inference of power-spectra and three dimen-
sional density ﬁelds from such galaxy samples.

To address this issue, in this work we have described a
fully Bayesian treatment of unknown foreground contamina-
tion in the process of inferring cosmological power-spectra from
deep galaxy surveys. In particularly we build upon the previ-
ously presented Bayesian inference framework ARES (for de-
tails see Jasche et al. 2010; Jasche & Wandelt 2013; Jasche &
Lavaux 2015). The ARES algorithm aims to jointly infer three
dimensional density ﬁelds, corresponding cosmological power-
spectrum, luminosity dependent galaxy biases and unknown
noise levels. Being a full Bayesian inference engine ARES fur-
ther correctly provides joint and correlated uncertainties for all
target quantities by performing an eﬃcient Markov chain Monte
Carlo sampling within a block sampling scheme as indicated in
Fig. 1.

In this work we extend this hierarchical Bayesian framework
by also including an additional sampling procedure to account
for foreground and target contamination eﬀects. As discussed in
Section 2.2 such contaminating eﬀects particularly aﬀect the es-
timation of the spectroscopic completeness of a given galaxy sur-
vey. Naive estimation of the probability of acquisition of galaxy
spectra at given positions in the sky, by calculating ratios of ob-
served galaxy spectra and all observed photometric targets, ig-
nores the possibility that photometric targets are contaminated
by foreground stars or dust extinction. Such eﬀects are likely to
artiﬁcially increase or decrease the estimated number of galaxy
targets in observations. In consequence these eﬀects introduce an
artiﬁcial modulation of observed galaxy number densities across
the sky, which in turn yields erroneous large scale power in in-
ferred cosmological power-spectra.

As demonstrated in Section 2.2, foreground and target con-
taminations can be accounted for by describing the mismatch be-
tween actual galaxies and observed photometric targets as multi-
plicative correction factors to estimated spectroscopic complete-
ness maps. These correction factors can be described as com-

Fig. 10. Cross correlation between power-spectrum amplitudes at dif-
ferent Fourier modes and negative (labelled F0) as well as positive (la-
belled F1) foreground coeﬃcients for the ﬁve respective catalogues (la-
belled C0 to C4).

on the analysis of speciﬁc target quantities such as the cosmolog-
ical power-spectrum. Speciﬁcally in our previous work Jasche &
Wandelt (2013) we have already demonstrated that the ARES al-
gorithm reveals and correctly treats the anti-correlation between
bias amplitudes and power spectrum, a 20% eﬀect across large
ranges in Fourier space. Here we also take into account the un-
known coeﬃcients of several foreground templates.

To study the impact of foreground contamination on the anal-
yses of cosmological power-spectra in deep galaxy surveys we
compare inference results obtained from our two ARES runs with
and without corresponding corrections. The results for inferred
power-spectra are presented in Fig. 9 where we show the univari-
ate marginal posterior distribution for power-spectrum ampli-
tudes at diﬀerent modes in Fourier space. For the Markov chain
without foreground treatment one can clearly observe excessive
power at the largest scales. This observation corresponds to the
excessive large scale power observed in corresponding inferred
three dimensional density ﬁelds, as discussed above. In addition
one can observe a slight bias with respect to the true underlying
power-spectrum from which mock observations were generated.
This can easily be understood by inspecting the data model de-
scribed in Equation (5), where one can see that there is a cer-
tain potential for a degeneracy between foreground coeﬃcients
and galaxy biases. If foreground eﬀects are not treated correctly,
then some of the foreground contributions will erroneously be
compensated by sampled galaxy bias amplitudes, introducing
the oﬀset between true and recovered power-spectra shown in
Fig. 9. In contrast inferred power-spectra for the run with fore-
ground treatment are unbiased with respect to the true underlying
power-spectrum over the full domain of Fourier modes consid-
ered in this work. In particular the shape of the recovered power-
spectrum at the largest scales is in excellent agreement with the
true ﬁducial model.

We further studied the impact of diﬀerent foreground co-
eﬃcients on power-spectrum amplitudes at diﬀerent scales in

Article number, page 10 of 15

0.050.100.150.200.250.300.35k (h Mpc¡1)C0, F0C0, F1C1, F0C1, F1C2, F0C2, F1C3, F0C3, F1C4, F0C4, F1-0.08-0.05-0.02 0.00 0.02 0.05 0.08 0.10J. Jasche and G. Lavaux: Bayesian power-spectrum inference with foreground and target contamination treatment

Fig. 11. We provide in the two above panels the correlation matrix of power-spectrum amplitudes with respect to their mean value in the case of
unaccounted foregrounds (left panel) and modelled foregrounds (right panel). The correlation matrix is normalized using the variance of the power
spectrum amplitudes. We note that the colour-map is truncated at a correlation level of 5 10−2. We estimate that all values below this threshold are
too noisy to be cleanly represented and discard them.

binations of various templates for foreground eﬀects, such as
introduced by stars or dust, and corresponding unknown tem-
plate coeﬃcients. The aim of this work is to jointly infer these
template coeﬃcients together with the three dimensional density
ﬁeld, corresponding cosmological power-spectra, galaxy biases
and unknown noise levels. This goal can be achieved by sim-
ply adding an additional sampling scheme for foreground coef-
ﬁcients to the block sampling framework of the ARES algorithm.
Interestingly, as discussed in section 2.3 and Appendix A, we
were able to derive a direct sampling scheme by introducing
auxiliary random ﬁelds and marginalizing over them. The cor-
responding algorithm to generate random realizations of fore-
ground template coeﬃcients is given in Algorithm 1.

We test the performance of improved ARES algorithms via
applications to mock galaxy observations. To further evaluate
the impact of foreground and target contamination eﬀects on the
inference of cosmological power-spectra we compare two test
scenarios, with and without treatment of foreground eﬀects. Cor-
responding artiﬁcial galaxy observations were self-consistently
generated according to the data model described in Section 3. In
particular, these artiﬁcial observations seek to emulate realistic
features of the SDSS DR7 main, the LOW-Z and the CMASS
galaxy sample. Eﬀectively this results in ﬁve artiﬁcial galaxy
surveys that are jointly handled by the ARES framework, while
self-consistently accounting for their respective systematic and
stochastic uncertainties, including survey geometries, selection
eﬀects, galaxy biasing and foregrounds.

This artiﬁcial data was then used to test the statistical per-
formance of our sampling framework. In particular we tested the
burn-in behaviour of the algorithm by starting the Markov chain
from an over-dispersed state. As described in Section 4.1, we
start the chain with an initial power-spectrum scaled by a factor
0.1. The following burn-in behaviour then manifested itself by
a coherent drift of sequential power-spectrum samples towards
preferred regions in parameter spaces. We estimated the burn-in
phase to be completed after ∼ 2000 sampling transitions. The
statistical eﬃciency of the sampler was estimated by measur-
ing the correlation length between subsequent posterior power-
spectrum samples. As demonstrated in section 4.1 the sampler

exhibits a correlation length of a few hundred samples. This
leaves us with a numerically eﬃcient sampling framework to
explore cosmological power-spectra in deep galaxy surveys. It
should be remarked that there exist various possibilities to fur-
ther improve statistical eﬃciencies but details are left to future
publications.

Results for inferring foreground and target contamination
template coeﬃcients are described in section 4.2. In particular
we have used two realistic foreground templates describing fore-
ground stars in the galaxy and dust extinction. Furthermore, our
implementation is general enough to account for an arbitrary
amount of foreground templates. To demonstrate the feasibil-
ity of inferring these parameters jointly with the cosmological
power-spectrum, three dimensional density ﬁelds, galaxy biases
and noise levels, we presented two dimensional marginalized
distributions for template coeﬃcients. These results show that
diﬀerent contamination contributions can be recovered within
≤ 2.3 sigma of their input values. Given inferred foreground co-
eﬃcients it is further possible to reconstruct an eﬀective com-
pleteness mask and corresponding uncertainties. As expected, in
the example tested in this work, uncertainties in recovered com-
pleteness masks are largest in regions where stellar contamina-
tions of the target distribution are also large.

In Section 4.3, we have studied the impact of foreground and
target contaminations on the inference of three dimensional den-
sity ﬁelds from galaxy surveys. To do that we have contrasted a
run with and without foreground treatment. Ignoring foreground
eﬀects when inferring density ﬁelds yields excessive large scale
power particularly in regions most aﬀected by such contamina-
tions. In contrast detailed Bayesian treatment of foreground sys-
tematics yields inferred density ﬁelds showing a homogeneous
distribution of power across the inference domain. It must be re-
marked that if foreground contaminations are not explicitly mod-
elled within the data model, then their eﬀects will be attributed
to a real signal.

This result is also in agreement with inferred cosmological
posterior power-spectra, as presented in section 4.4. The inferred
power-spectrum of the run without foreground treatment agrees
with the visual impression obtained from corresponding three

Article number, page 11 of 15

0.050.150.250.35k (h Mpc¡1)0.050.150.250.35k (h Mpc¡1)10-11000.050.150.250.35k (h Mpc¡1)0.050.150.250.35k (h Mpc¡1)10-1100A&A proofs: manuscript no. paper

Huterer, D., Cunha, C. E., & Fang, W. 2013, MNRAS, 432, 2945
Jasche, J., Kitaura, F. S., Wandelt, B. D., & Enßlin, T. A. 2010, MNRAS, 406,

60

Jasche, J. & Lavaux, G. 2015, MNRAS, 447, 1204
Jasche, J. & Wandelt, B. D. 2013, ApJ, 779, 15
Jewell, J., Levin, S., & Anderson, C. H. 2004, ApJ, 609, 1
Jewell, J. B., Eriksen, H. K., Wandelt, B. D., et al. 2009, ApJ, 697, 258
Larson, D. L., Eriksen, H. K., Wandelt, B. D., et al. 2007, ApJ, 656, 653
Lavaux, G. & Jasche, J. 2016, MNRAS, 455, 3169
Lavaux, G. & Jasche, J. 2017, in prep.
Leistedt, B. & Peiris, H. V. 2014, MNRAS, 444, 2
O’Dwyer, I. J., Eriksen, H. K., Wandelt, B. D., et al. 2004, ApJ, 617, L99
Percival, W. J. 2005, MNRAS, 356, 1168
Percival, W. J., Burkey, D., Heavens, A., et al. 2004, MNRAS, 353, 1201
Planck Collaboration, Ade, P. A. R., Aghanim, N., et al. 2011, A&A, 536, A1
Planck Collaboration, Ade, P. A. R., Aghanim, N., et al. 2016, A&A, 594, A13
Pope, A. C., Matsubara, T., Szalay, A. S., et al. 2004, ApJ, 607, 655
Ross, A. J., Beutler, F., Chuang, C.-H., et al. 2017, MNRAS, 464, 1168
Ross, A. J., Ho, S., Cuesta, A. J., et al. 2011, MNRAS, 417, 1350
Sánchez, A. G., Kazin, E. A., Beutler, F., et al. 2013, MNRAS, 433, 1202
Schlegel, D. J., Finkbeiner, D. P., & Davis, M. 1998, ApJ, 500, 525
Scranton, R., Johnston, D., Dodelson, S., et al. 2002, ApJ, 579, 48
Sudevan, V., Aluri, P. K., Yadav, S. K., Saha, R., & Souradeep, T. 2016, ArXiv

e-prints [arXiv:1612.03401]

Swanson, M. E. C., Tegmark, M., Hamilton, A. J. S., & Hill, J. C. 2008, MNRAS,

387, 1391

Tadros, H., Ballinger, W. E., Taylor, A. N., et al. 1999, MNRAS, 305, 527
Tegmark, M. 1995, ApJ, 455, 429
Tegmark, M., Blanton, M. R., Strauss, M. A., et al. 2004, ApJ, 606, 702
Tegmark, M. & Efstathiou, G. 1996, MNRAS, 281, 1297
Tegmark, M., Hamilton, A. J. S., Strauss, M. A., Vogeley, M. S., & Szalay, A. S.

1998, ApJ, 499, 555

Tegmark, M., Taylor, A. N., & Heavens, A. F. 1997, ApJ, 480, 22
Vansyngel, F., Wandelt, B. D., Cardoso, J.-F., & Benabed, K. 2016, A&A, 588,

A113

Wandelt, B. D., Larson, D. L., & Lakshminarayanan, A. 2004, Phys. Rev. D, 70,

083511

Yamamoto, K. 2003, ApJ, 595, 577

dimensional density ﬁelds. In particular it reﬂects the observed
excess in large scale power. Ignoring foreground eﬀects may
further lead to an overall bias across the entire Fourier domain
with respect to the true underlying power-spectrum. In contrast
detailed Bayesian foreground treatment yields inferred power-
spectra in agreement with respect to the underlying ﬁducial truth
over the entire range of Fourier modes, as considered in this
work.

We have further tested the impact of diﬀerent foreground
eﬀects on the inference of power-spectrum amplitudes by esti-
mating their correlations with foreground template coeﬃcients
throughout the full Fourier range. These results show that cor-
relations and anti-correlations can amount up to ten percent
throughout large ranges in Fourier space.

The ARES algorithm also accounts for artiﬁcial mode cou-
pling between power-spectrum amplitudes as introduced by sur-
vey geometries and completeness masks. To demonstrate that
fact we have estimated the correlation matrix of power-spectrum
amplitudes from our Markov runs. These tests show that residual
artiﬁcial mode coupling is typically much less than ten percent.
These results indicate the validity of the algorithm in scenarios
with heavily masked data. We are currently using our method to
process the actual BOSS data, which will presented in our com-
panion paper (Lavaux & Jasche 2017).

As demonstrated in this work detailed treatment of fore-
ground and target contamination is essential to recover unbiased
estimates of three dimensional density ﬁelds and corresponding
cosmological power-spectra from present and next generation
surveys. The proposed ARES algorithm provides a joint and sta-
tistically rigorous Bayesian inference framework to achieve this
goal and prevent misinterpretation of observations.

Acknowledgements. This research was supported by the DFG cluster of excel-
lence "Origin and Structure of the Universe" (www.universe-cluster.de). This
work made in the ILP LABEX (under reference ANR-10-LABX-63) was sup-
ported by French state funds managed by the ANR within the Investissements
d’Avenir programme under reference ANR-11-IDEX-0004-02. The Parkes tele-
scope is part of the Australia Telescope which is funded by the Commonwealth of
Australia for operation as a National Facility managed by CSIRO. We acknowl-
edge ﬁnancial support from "Programme National de Cosmologie and Galaxies"
(PNCG) of CNRS/INSU, France. This work was supported in part by the ANR
grant ANR-16-CE23-0002.

References
Alsing, J., Heavens, A., Jaﬀe, A. H., et al. 2016, MNRAS, 455, 4452
Anderson, L., Aubourg, E., Bailey, S., et al. 2012, MNRAS, 427, 3435
Ballinger, W. E., Heavens, A. F., & Taylor, A. N. 1995, MNRAS, 276, L59
Dagpunar, J. 1988, Principles of Random Variate Generation (Oxford University

Press)

Dawson, K. S., Schlegel, D. J., Ahn, C. P., et al. 2013, AJ, 145, 10
Eisenstein, D. J. & Hu, W. 1998, ApJ, 496, 605
Eisenstein, D. J. & Hu, W. 1999, ApJ, 511, 5
Eisenstein, D. J., Weinberg, D. H., Agol, E., et al. 2011, AJ, 142, 72
Elsner, F., Leistedt, B., & Peiris, H. V. 2017, MNRAS, 465, 1847
Elsner, F. & Wandelt, B. D. 2013, A&A, 549, A111
Eriksen, H. K., Huey, G., Banday, A. J., et al. 2007, ApJ, 665, L1
Eriksen, H. K., Jewell, J. B., Dickinson, C., et al. 2008, ApJ, 676, 10
Eriksen, H. K. et al. 2004, ApJS, 155, 227
Feldman, H. A., Kaiser, N., & Peacock, J. A. 1994, ApJ, 426, 23
Fisher, K. B., Scharf, C. A., & Lahav, O. 1994, MNRAS, 266, 219
Górski, K. M., Hivon, E., Banday, A. J., et al. 2005, ApJ, 622, 759
Granett, B. R., Guzzo, L., Coupon, J., et al. 2012, MNRAS, 421, 251
Hamilton, A. J. S. 1997a, MNRAS, 289, 285
Hamilton, A. J. S. 1997b, MNRAS, 289, 295
Heavens, A. F. & Taylor, A. N. 1995, MNRAS, 275, 483
Hinshaw, G., Nolta, M. R., Bennett, C. L., et al. 2007, ApJS, 170, 288
Ho, S., Agarwal, N., Myers, A. D., et al. 2015, J. Cosmology Astropart. Phys.,

5, 040

Ho, S., Cuesta, A., Seo, H.-J., et al. 2012, ApJ, 761, 14

Article number, page 12 of 15

J. Jasche and G. Lavaux: Bayesian power-spectrum inference with foreground and target contamination treatment

Appendix A: Sampling foreground coefﬁcients
In this appendix, we derive the sampling procedure for a single foreground template coeﬃcient αk. As described in Section 2.3, the
full joint distribution of all template coeﬃcients may be sampled by performing a sequential iterative block sampling procedure. In
the absence of any a priori information on the foreground coeﬃcient αk we follow a maximally conservative approach by assuming
a uniform prior distribution. Using Equation (8)), the logarithm of the conditional posterior distribution for a foreground coeﬃcient
in a single galaxy catalogue can then be written as:

(cid:16)

log P

αk|{αn} \ αk, {Ni}, {δi}, { ¯N}

(cid:17) = −

(cid:104)

1
2

v(cid:88)

i=0

Ni − ¯N Mi ({αn}) Ri (1 + Di b δi)
¯N Mi ({αn}) Ri

(cid:105)2

(cid:16)

log

−

1
2

¯N Mi ({αn}) Ri

(cid:17)

.

(A.1)

We can simplify notation by noting that diﬀerent foreground templates contribute multiplicatively an eﬀective survey response
operator. We can therefore collapse all multiplicative foreground contributions, except the one currently under consideration, into
the eﬀective survey response operator given as:

˜Ri = ¯NRi

(cid:89)

(1 − αnFn,i) ,

n\k

(A.2)

where k labels the currently considered foreground template and we have used Equation (4) to factorize foreground contributions.
We further introduce the vector:

Ai = ˜Ri(1 + Di b δi) .

Given this notation the conditional posterior distribution for αk simpliﬁes to:

(cid:16)

log P

αk|{αn} \ αk, {Ni}, {δi}, { ¯N}

(cid:17) = −

1
2

v(cid:88)

i=0

(cid:2)Ni − (1 − αkFk,i) Ai
(1 − αkFk,i) ˜Ri

(cid:3)2

−

1
2

(cid:104)
(1 − αkFk,i) ˜Ri

(cid:105)

.

log

The expression can be further compressed by introducing the following indexed quantities:

Bi = Ni − Ai,
Ck,i = Ai Fk,i, and
γk,i = Fk,i ˜Ri .

Consequently the conditional posterior distribution can be expressed as:

(cid:16)

P

(cid:16)
αk|{αn} \ αk, {Ni}, {δi}, { ¯N},

(cid:17)(cid:17) = −

log

1
2

v(cid:88)

i=0

(cid:0)Bi + αkCk,i
(cid:16)
˜Ri − αkγk,i

(cid:1)2
(cid:17) −

1
2

(cid:16)
˜Ri − αkγk,i

(cid:17)

.

log

(A.3)

(A.4)

(A.5)
(A.6)

(A.7)

(A.8)

In order for Equation (A.8) to represent a proper probability distribution the following positivity requirement for the variances needs
to hold:

∀i, ˜Ri − αkγk,i > 0

Similarly it is required that:

∀i, ˜Ri > 0,

(A.9)

(A.10)

which states that the survey response operator should be positive deﬁnite. To ensure these requirements we split the eﬀective survey
response operator ˜Ri as follows:

˜Ri = ˜R(cid:48)
i,k

+ ωγk,i .

By also requiring ˜R(cid:48)

i,k > 0 we yield the following requirement for the scalar quantity ω:

˜R(cid:48)
i,k

= ˜Ri − ωγk,i > 0, which brings to

ω <

˜Ri
γk,i

∀i .

We therefore choose ω to be:
(cid:33)

ω = min

i

(cid:32) ˜Ri
γk,i

.

(A.11)

(A.12)

(A.13)

(A.14)

Article number, page 13 of 15

A&A proofs: manuscript no. paper

Algorithm 1 Algorithm derived in Appendix A to sample the values of αk, the multiplicative coeﬃcient attached the k-th foreground.
1: function sample_one_α (αk, ˜R(cid:48), B, C, γ, ω, k)
2:
3:
4:
5:
6:

ξ ← ω − αk
wk ← 0
zk ← 0
for i = 0 → (Length(B) − 1) do

(cid:46) Here we generate a new value for the messenger ﬁeld ti.

(cid:46) we loop over all grid elements of B

ti ∼ G(µi,k, σ2

i,k)

It is a simple normally distributed value centred on µi,k with a
variance σ2

i,k.

(cid:46) Accumulate wk and zk.

(cid:46) We sample ξ from a GIG distribution.
(cid:46) at that point we have generated a new αk from the conditional probability distribution in Equation (A.4).

wk ← wk + (Bi − Ck,iω − ti)2/γk,i
zk ← zk + (Ck,i)2/γk,i

7:
8:
end for
9:
ξ ∼ GIG(wk, zk)
10:
αk ← ω − ξ
11:
return αk
12:
13: end function

Given these deﬁnitions one can express the conditional posterior distribution as:

(cid:16)

P

(cid:16)
αk|{αn} \ αk, {Ni}, {δi}, { ¯N},

(cid:17)(cid:17) = −

log

1
2

v(cid:88)

i=0

(cid:1)2

(cid:0)Bi + αkCk,i
+ (ω − αk) γk,i

˜R(cid:48)
i,k

−

1
2

(cid:16)

˜R(cid:48)
i,k

log

+ (ω − αk) γk,i

(cid:17)

.

Note that this distribution can be described conveniently as the marginalization over a set of auxiliary ﬁelds {ti}:

(cid:16)

P

αk|{αn} \ αk, {Ni}, {δi}, { ¯N},

(cid:17)

∝

(cid:90) ∞

(cid:89)

−∞

i

dti

− 1
2
e
(cid:112)

(cid:80)v

i=0

(Bi

+αkCk,i −ti)2
(ω−αk)γk,i

2π (ω − αk) γk,i

− 1
2

t2
i
˜R(cid:48)
i,k

e
(cid:113)

2π ˜R(cid:48)
i,k

.

(A.15)

(A.16)

This approach therefore follows a similar line of reasoning as discussed in our previous work when presenting a messenger ﬁeld
Gibbs sampler (Jasche & Lavaux 2015). Here we propose to jointly sample the template coeﬃcient parameter αk with the auxiliary
messenger ﬁeld ti via a two step block sampling procedure. First we generate realizations of the messenger ﬁeld ti conditional on
the current value of αk and then we draw a new value of αk conditional on the given realization of ti. We loop over this small block
ten times to ensure a minimal mixing of the variables. To simplify notation we introduce the following change of variable:

ξ = ω − αk .

This yields the joint distribution:

(cid:16)

P

ξ, {ti}|{αn} \ αk, {Ni}, {δi}, { ¯N},

(cid:89)

− 1
e
2

(cid:17)

∝

i

(cid:80)v

i=0
(cid:112)

(Bi

+(ξ−ω)Cki−ti)2
ξγk,i

2π ξγk,i

,

(A.17)

(A.18)

t2
i
˜R(cid:48)
ik

− 1
2
e
(cid:113)

2π ˜R(cid:48)
i,k

As can be easily conﬁrmed, sampling the messenger ﬁeld ti amounts to simply generating normal random variates with following

means and variances:
˜R(cid:48)
i,k
ξγk,i + ˜R(cid:48)
i,k

µi,k =

(cid:0)Bi + (ξ − ω) Ck,i

(cid:1) ,

and

σi,k =

˜R(cid:48)
i,k ξγk,i
ξγk,i + ˜R(cid:48)
i,k

.

To generate realizations of the ξ values, we introduce the following quantities:

wk =

and

zk =

(cid:0)Bi − Ck,i ω − ti
γk,i

(cid:1)2

(cid:88)

i

(cid:88)

=

i

wk,i(ti)

(cid:1)2

(cid:0)Ck,i
γki

(cid:88)

i

(cid:88)

=

i

zk,i(ti) .

Article number, page 14 of 15

(A.19)

(A.20)

(A.21)

(A.22)

J. Jasche and G. Lavaux: Bayesian power-spectrum inference with foreground and target contamination treatment

With this deﬁnition the conditional distribution to sample ξ turns into a generalized inverse Gaussian (GIG) distribution given as:

(cid:16)

P

ξ|{ti}, {αn} \ αk, {Ni}, {δi}, { ¯N},

(cid:17)

∝

1

Nv
2

(ξ)

e− 1

2

(cid:16) wk
ξ

(cid:17)

+ξzk

,

(A.23)

where Nv is the number of observed grid elements. The GIG distribution can be conveniently sampled with standard approaches
as described in the literature (see e.g. Dagpunar 1988). Finally to obtain a sample for the foreground coeﬃcient αk we invert the
transformation in Equation (A.17):

αk = ω − ξ .

(A.24)

The respective realizations of the ti ﬁeld are not longer required and are immediately discarded, which amounts to a marginalization
over the ti values. An eﬃcient sampling algorithm that avoids storing the full ti vector is proposed in Algorithm 1.

Article number, page 15 of 15

