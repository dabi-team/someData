0
2
0
2

r
a

M
7

]
T
S
.
h
t
a
m

[

1
v
5
1
6
3
0
.
3
0
0
2
:
v
i
X
r
a

Local Power of Tests of Fit for Normality of

Autoregression

M.V. Boldin ∗

We consider a stationary AR(p) model. The autoregression parameters are unknown

as well as the distribution of innovations. Based on the residuals from the parameter

estimates, an analog of empirical distribution function is deﬁned and the tests of
Kolmogorov’s and ω2 type is constructed for testing hypotheses on the normality of

innovations. We obtain the asymptotic power of these tests under local alternatives.

Key words: autoregression, residuals, empirical distribution function, Kolmogorov’s

and omega-square tests, local alternatives, testing for normality.

AMS 2010 Subject Classiﬁcation: Primary 62C10; secondary 62M10, 62G30.

1 Введение

В этой работе мы изучаем асимптотическую локальную мощность критериев типа

Колмогорова-Смирнова и Крамера-Мизеса-Смирнова омега-квадрат (далее кратко

критериев Колмогорова и омега-квадрат) для проверки нормальности линейной ста-

ционарной авторегрессионной модели. Параметры модели неизвестны, так что инно-

вации, порождающие авторегрессионную последовательность, ненаблюдаемы. Упо-

мянутые тесты основываются на эмпирической функции распределения остатков от

подходящих оценок параметров. Эта функция строится по остаткам аналогично то-

му, как строится (гипотетически) эмпирическая функция распределения по самим

инновациям.

∗Dept. Mech. Math., Moscow State Lomonosov Univ., Moscow, Russia

e-mail:boldin−m@ hotmail.com

1

 
 
 
 
 
 
Подобные остаточные э.ф.р. изучались во многих работах для различных авто-

регрессионных моделей. В частности, в [4] для стационарной AR(p) модели с нулевым

средним, в [1] для линейной регрессии с авторегрессионными ошибками, в [12] для

взрывающейся авторегрессии, в [13] для AR(∞), в [5] для ARCH(p) модели и т.д.

В упомянутых работах на остаточной эмпирической функции распределения

сновываются статистики типа Колмогорова и омега-квадрат для проверки гипотез о

распределении инноваций, найдены предельные распределения этих статистик при

гипотезах. Мощность соответствующих тестов при локальных альтернативах до са-

мого последнего времени была неизвестна и это было пробелом в упомянутых при-

влекательных фактах.

(Строго говоря, термин ”локальная мощность” подразумевает наличие регуляр-

ной последовательности стохастических экспериментов, см., например, [10]. Мы та-

кую последовательность определять не будем. Под локальной мощностью мы пони-

маем далее мощность при близких альтернативах, сходящихся к гипотезе со скоро-
стью O(n1/2), n – объем данных.)

В недавней работе [6] для линейной стационарной AR(p) модели с нулевым сред-

ним удалось найти асимптотическую локальную мощность тестов типа Колмогорова

и омега-квадрат для проверки простых гипотех о распределении инноваций. Ока-

залось, что эта асиптотическая мощность такая же, как в классической ситуации

независимых одинаково распределенных наблюдений. Напомним, в этой классиче-

ской ситуации локальные мощности критериев согласия были найдены впервые в

[8].

В настоящей заметке мы делаем следующий шаг в сравнении с [6]. Мы рас-

сматриваем линейную стационарную AR(p) авторегрессию с ненулевым средним и

проверяем гипотезу о нормальности инноваций. Мы находим асимптотическую ло-

кальную мощность соответствующих тестов типа Колмогорова и омега-квадрат.

Напомним, в линейной авторегрессии нормальность инноваций эквивалентна

нормальности самой авторегрессионной последовательности и обеспечивает опти-

мальность общеупотребительных процедур наименьших квадратов. См., например,

[3], гл. 5 и 6. Это объясняет теоретический и прикладной интерес к рассматриваемой

далее задаче.

Мы описываем модель и приводим некоторые предварительные результаты в

Разделе 2, формально ставим задачу и формулируем основной результат в Разделе

2

3. Доказательства весьма кропотливы и будут опубликованы в отдельной работе.

2 Описание модели и тестовых статистик

Рассмотрим стационарную AR(p) модель с ненулевым средним

vt = β1vt−1 + · · · + βpvt−p + ν + εt, t ∈ Z.

(1)

В (1) {εt} – независимые одинаково распределенные случайные величины (н.о.р.сл.в.)
с неизвестной функцией распределения (ф.р.) G(x); Eε1 = 0, 0 < Eε2
1 < ∞; β =
(β1, . . . , βp)T - вектор неизвестных параметров, таких что корни соответствующего (1)
характеристического уравнения по модулю меньше единицы; неизвестная константа
ν ∈ R, порядок уравнения p известен.
Пусть наблюдения v1−p, . . . , vn - выборка из стационарного решения {ut} уравнения
(1).

Построим тесты типа Колмогорова и омега-квадрат для проверки гипотезы

H0 : G(x) ∈ {Φ(x/σ), σ > 0}, Φ(x) − ф.р. стандартной гауссовской величины.

Сначала перепишем уравнение (1) в удобном для дальнейшего рассмотрения виде.

Введем константу µ соотношением ν = (1 − β1 − . . . − βp)µ, тогда

vt − µ = β1(vt−1 − µ) + · · · + βp(vt−p − µ) + εt.

Полагая ut := vt − µ, получаем:

vt = µ + ut,

ut = β1ut−1 + · · · + βput−p + εt, t ∈ Z.

(2)

(3)

Соотношения (2) – (3) эквивалентны (1), при этом (3) – авторегрессия с нулевым

средним. Вспоминая вид стационарного решения (3), см., например, [3], гл. 5, полу-

чаем строго стационарное решение (2) –(3) в виде

vt = µ +

γjεt−j.

Xj≥0

(4)

Ряд в (4) сходится в L2, последовательность {γj} определяется рекуррентным соот-
ношением

γj = β1γt−1 + · · · + βpγt−p, j ≥ 1, γ0 = 1, γj = 0 для j < 0,

3

|γj| ≤ cλj, 0 < λ < 1, константы c, λ от j и вектора β не зависят.

Соотношение (4) влечет: последовательность {vt} из (4) является гауссовской

тогда и только тогда, когда верна H0.

Вернемся к построению тестов для H0. Возьмем оценкой µ в (2) эмпирическое
n
t=1 vt, а оценками ненаблюдаемых {ut} величины

среднее µ := n−1

P

ˆut := vt − ˆv,

t = 1 − p, . . . , n.

Пусть ˆβn = ( ˆβ1n, . . . , ˆβpn)T - любая n1/2 - состоятельная оценка вектора β, построен-
ная по этим {ˆut}. Например, годится оценка наименьших квадратов (о.н.к.), посколь-
ку она асимптотически нормальна при сделанных предположениях, см., например,

[3], гл. 5. Величины

ˆεt = ˆut − ˆβ1n ˆut−1 − · · · − ˆβpn ˆut−p,

t = 1, . . . , n,

называются отстатками, это оценки ненаблюдаемых инноваций {εt}, а функция

ˆGn(x) = n−1

n

Xt=1

I(ˆεt ≤ x), x ∈ R,

называется остаточной эмпирической функцией распределения (о.э.ф.р). (Здесь и
далее I(·) означает индикатор события.) ˆGn(x) есть подобие эмпирической функции
распределения

Gn(x) = n−1

n

Xt=1

I(εt ≤ x)

ненаблюдаемых сл.в. ε1, . . . , εn.

Асимптотические свойства ˆGn(x) характеризует следующее стохастическое раз-

ложение, см. [1]:

если G(x) дважды дифференцируема с g(x) = G′(x) и supx |g′(x)| < ∞, то

|n1/2[ ˆGn(x) − Gn(x + ε)]| P−→ 0, n → ∞,

ε := n−1

sup
x

n

εt

Xt=1

(5)

Неизвестную дисперсию инноваций при H0 обозначим σ2
0. Таким образом, гипотеза
H0 эквивалентна тому, что G(x) = Φ(x/σ0) для некоторой неизвестной дисперсии
0 > 0. Оценкой σ2
σ2

0 возьмем

n

n := n−1
ˆs2

ˆε2
t .

Xt=1

4

Введем остаточный эмпирический процесс (о.э.п.)

ˆun(x) := n1/2[ ˆGn(x) − Φ(x/ˆsn)].

Разложение (5) позволяет указать слабый предел процесса ˆun(ˆsnΦ−1(t)), t ∈ [0, 1], в
пространстве Скорохода D[0, 1] функций без разрывов второго рода в предположе-

нии, что гипотеза H0 верна.
А именно, пусть u(t), t ∈ [0, 1], будет гауссовский процесс со средним ноль и ковари-

ацией

min{t, s} − ts − ϕ(Φ−1(t))ϕ(Φ−1(s)) −

Φ−1(t)ϕ(Φ−1(t))Φ−1(s)ϕ(Φ−1(s)),

1
2

ϕ(x) := Φ′(x), Φ−1(t) – обратная к Φ(x) функция. В [1] показано: при H0

ˆun(ˆsnΦ−1(t))

D[0,1]
−−−→ u(t), n → ∞.

(6)

Статистики типа Колмогорова и омега-квадрат для H0 имеют вид:

ˆDn := sup
t

|ˆun(ˆsnΦ−1(t))| = sup
x

|ˆun(x)|,

ˆω2

n =

1

Z
0

[ˆun(ˆsnΦ−1(t))]2dt =

∞

Z

−∞

[ˆun(x))]2dΦ(x/ˆsn).

В силу (6 ) при H0

P ( ˆDn ≤ λ) → P (sup
t

|u(t)| ≤ λ) := ˆK(λ),

P (ˆω2

n ≤ λ) → P (

1

Z
0

[u(t)]2dt ≤ λ) := ˆS(λ), n → ∞.

Квантили ф.р. ˆK(λ), оцененные методом Монте-Карло, приведены в таблицах [14],
а квантили ф.р. ˆS(λ) вычислены в [11].
Таким образом, статистики ˆDn и ˆω2
n так же, как обычные статистики Колмогорова и омега-квадрат.

n можно применять для проверки H0 при больших

Упомянутые факты (в частности, соотношение (6)) были установлены только
при гипотезе H0, поведение о.э.п. ˆun(ˆsnΦ−1(t)) и основанных на нем тестовых стати-
стик при локальных альтернативах не рассматривалось. В следующем разделе мы

устраним этот пробел.

5

3 Постановка задачи и основной результат

Цель настоящей работы – установить слабый предел в D[0, 1] о.э.п. ˆun((ˆsnΦ−1(t)) и
основанных на нем статистик ˆDn и ˆω2
А именно, далее предполагается, что {εt} в (2) – (3) – н.о.р.сл.в. с ф.р. в виде смеси:

n при локальных альтернативах.

G(x) = An(x) := (1 − n−1/2)Φ(x/σ0) + n−1/2H(x), H(x) − ф.р.

(7)

Предположение (7) будем понимать как локальную альтернативную к H0 гипо-
тезу и обозначать H1n. Разумеется, при H(x) = Φ(x/σ0)альтернатива H1n и гипотеза
H0 совпадают.
При H1n вектор β остается постоянным и от n не зависит. Авторегрессионное среднее
µ от n может зависеть и вот почему. Пусть среднее значение ф.р. H(x) будет, скажем,

νH 6= 0. Тогда уравнения (2) – (3) можно переписать в эквивалентном виде, заменив
последовательность {εt} на последовательность с нулевым средним {εt − n−1/2νH },
а µ на µn := (1 − β1 − . . . − βp)−1(ν + n−1/2νH ). Значит, без ограничения общности
среднее инноваций при альтернативе H1n можно считать нулевым.

Сказанное делает естественным следующее предположение.

Условие (i). Случайная величина с функцией распределения H(x) имееет ну-

левое среднее и конечную дисперсию σ2
H .

Отметим, что остатки {ˆεt} , определенные в Разделе 2, ни при гипотезе ни при
альтернативе от среднего авторегрессионной схемы µ вовсе не зависят. Потому сво-
бодны от этого среднего и процесс ˆun(x) и статистики ˆDn, ˆω2
n.

Условие (ii). Функция распределения H(x) дифференцируема с производной,

удовлетворяющей условию Липшица.

Условия (i) и (ii) позволяют использовать результаты [6] об асимптотическом

поведении о.э.ф.р. при локальных альтернативах.

Пусть ˆβn будет любая n1/2 – состоятельная при H1n оценка β. Например, при H1n
и единственном Условии (i) годится о.н.к. ˆβn,LS, построенная по {ˆut}. Она остается
асимптотически гауссовской при H1n с теми же параметрами, как при H0. А именно,

n1/2( ˆβn,LS − β) d−→ N(0, σ2

0K −1), n → ∞.

Здесь ковариационная матрица K = (ki,j) > 0. i, j = 1, . . . , p , ki,j = Eu0
стационарное решение уравнения (3) с {εt}, имеющими ф.р. Φ(x/σ0).

0u0

i−j ,{u0

t } –

6

Доказательство этого факта такое же, как в авторегрессии с нулевым средним,

см. [6], а потому опущено.

Вот наш основной результат.

Теорема 1. Пусть верна альтернатива H1n. Пусть выполнены Условия (i) и (ii).
Положим

δ(t) := H(σ0Φ−1(t)) − t +

Φ−1(t)ϕ(Φ−1(t))(

1
2

σ2
H
σ2
0

− 1),

t ∈ [0, 1].

Тогда

ˆun(ˆsnΦ−1(t)) = n1/2[ ˆGn(ˆsnΦ−1(t)) − t]

D[0,1]
−−−→ u(t) + δ(t),

n → ∞.

Теорема 1 прямо влечет

Следствие 1. В условиях теоремы 1 справедлива сходимость по распределению:

ˆDn

d−→ sup
t

|u(t) + δ(t)|,

ˆω2
n

d−→

1

Z
0

[u(t) + δ(t)]2dt, n → ∞.

Выделим в нашем рассмотрении важный частный случай н.о.р. наблюдений. Он

получается при β = 0, и в этом случае последовательность {vt} имеет вид

Полагая ˆβn = 0, получим остатки ˆεt = εt − ε, t = 1, . . . , n. Для таких остатков

vt = ν + εt,

t ∈ Z.

ˆGn(x) = Gn(x + ε), ˆs2

n = s2

n := n−1

n

Xt=1

(εt − ε)2,

ˆun(ˆsnΦ−1(t)) = un(t) := n1/2[Gn(ε + snΦ−1(t)) − t],

ˆDn = Dn := sup
t

|un(t)|,

n = ω2
ˆω2

n :=

1

Z
0

[un(t)]2dt.

Статистики Dn и ω2
n – обычные статистики Колмогорова и омега-квадрат с оцененны-
ми параметрами, предназначеные для проверки нормальности н.о.р.сл.в. v1, . . . , vn.

Теорема 1 и Следствие 1 прямо влекут

Следствие 2. Пусть верна альтернатива H1n и выполнены Условия (i) и (ii). Тогда

un(t)

D[0,1]
−−−→ u(t) + δ(t),

Dn

d−→ sup
t

|u(t) + δ(t)|,

ω2
n

d−→

1

Z
0

7

[u(t) + δ(t)]2dt, n → ∞.

Заметим, что Условие (ii) в Следствии 2 излишне. Анализируя доказательство
Теоремы 1 в Разделе 4 легко увидеть, что в частном случае β = ˆβ = 0 достаточно
потребовать непрерывности H(x).

В силу Следствия 2 слабые пределы при H1n процесса ˆun(ˆsnΦ−1(t)) и cтатистик
n в общем случае те же, что у un(t), Dn и ω2
n, построенных по н.о.р.сл.в. Весьма

ˆDn, ˆω2
примечательный факт.

Отметим, что утверждения Следствия 2 известны давно, их можно получить

из общих результатов [9], где для н.о.р. наблюдений изучалась слабая сходимость в

D[0, 1] эмпирического процесса с оцененными параметрами.

Список литературы

[1] М. В. Болдин , Проверка гипотез в авторегрессионных схемах критериями Кол-
могорова и ω2, ДАН СССР 273 (1), 19–22 (1983). English transl., Soviet Math.

Dokl. 28 (1983).

[2] И. И. Гихман, Ф.В. Скороход, Теория случайных процессов. т.1. (М., Наука,

1971).

[3] T.V. Anderson, The Statistical Analysis of Time Series ( Wiley and Sons, Inc., New

York, 1971).

[4] M.V. Boldin, Estimation of the Distribution of Noise in an Autoregression Scheme,

Theory Probab. Appl. 27 (4), 866–871 (1983).

[5] M. V. Boldin, On empirical processes in heteroscedastic time series and their use for

hypothesis testing and estimation, Math. Methods Statist. 9 (2), 65 –89 (2000).

[6] Boldin M.V. On the Assymptotic Power of Tests of Fit under Local Alternatives in

Autoregression, Math. Methods Statist. 28(2), 144 –154 (2019).

[7] Boldin M.V. On the Power of Pearson’s Test under Local Alternatives in

Autoregression with Outliers, Math. Methods Statist. 28(1), 57 –65 (2019).

[8] D. M. Chibisov, An Investigation of the Asymptotic Power of the Tests of Fit, Theory

Probab. Appl. 10 (3), 421–437 (1965).

[9] J. Durbin, Weak convergence of the sample distribution function when parameters

are estimated, Ann Statist 1, 279–290, (1973).

8

[10] L. Le Cam, Asymptotic Methods in Statistical Decision Theory ( New York, Springer-

Verlag, 1986).

[11] G. V. Martynov, Omega-squared tests ( Moscow, Nauka, 1978). (Russia)

[12] H.L. Koul and S. Levental, Weak convergence of the residual empirical process in

explosiue autoregression, Ann. Statist. 17 (4), 1784–1794 (1989).

[13] J.P. Kreiss, Estimation of the distribution function of noise in stationary processes,

Metrica 38, 285–297 (1991).

[14] E.S. Pearson and H.O. Hartley, Biometrika tables for statisticians, ii (Cambrige Univ.

Press, Cambridge, 1972).

9

