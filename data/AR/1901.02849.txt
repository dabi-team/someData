XRF element localization with a triple GEM detector using resistive charge
division

Geovane G. A. de Souza∗, Hugo Natal da Luz

Instituto de Física, Universidade de São Paulo
Rua do Matão 1371, 05508-090 Cidade Universitária, São Paulo, Brasil

9
1
0
2

y
a
M
0
2

]
t
e
d
-
s
n
i
.
s
c
i
s
y
h
p
[

2
v
9
4
8
2
0
.
1
0
9
1
:
v
i
X
r
a

Abstract

In this work we show the operation and results of an X-ray ﬂuorescence imaging system using a cascade of

three gas electron multipliers (GEM) and a pinhole assembly. The detector operates in Ar/CO2 (90/10)

at atmospheric pressure, with resistive chains applied to the strip readout, which allow to use only ﬁve

electronic channels: two for each dimension and a ﬁfth for energy and trigger. The corrections applied to

the energy spectra to compensate for small changes in the signal amplitude and also diﬀerences in gain

throughout the sensitive area are described and the clear improvement of the energy resolution is shown.

To take advantage of the simultaneous sensitivity to the energy and to the position of interaction, a color

scale matching the energy spectrum to the RGB range was applied, resulting in images where the color has

a direct correspondence to the energy in each pixel and the intensity is reﬂected by the brightness of the

image. The results obtained with four diﬀerent color pigments are shown.

Keywords: Gas Electron Multiplier, X-ray ﬂuorescence imaging, Position sensitive detectors, resistive

charge division

1. Introduction

The Gas Electron Multiplier (GEM) [1] is a Micropattern Gaseous Detector (MPGD) that has undergone

a steady development and maturity process over the last two decades. Thanks to its well studied proper-

ties such as high counting rate capability, fair energy resolution, good ion backﬂow suppression and good

stability against electrical discharges, allied to the possibility of building detection areas of the order of the

square meter, it has been selected to operate in major Particle Physics experiments, such as LHCb [2] and

COMPASS [3] and its use is also foreseen for upgrades in ALICE [4] and CMS [5].

∗Corresponding author
Email address: geovane.souza@usp.br (Geovane G. A. de Souza)

Preprint submitted to Nuclear Instruments and Methods A

May 21, 2019

 
 
 
 
 
 
It consists on a kapton foil, typically 50 µm thick, coated on both sides with copper layers. A triangular

matrix of biconical holes is etched through the copper and the foil (70 µm in the copper layer and 60 µm

diameter in the kapton substrate). The centers of the holes are at a distance of 140 µm from their nearest

neighbors. When the GEM foil is immersed in a gas mixture and suitable voltage diﬀerences are applied

between two electrodes to deﬁne the electric ﬁelds above, below and inside the holes of the GEM, the very

high electric ﬁeld inside the holes focuses free electrons generated by the interaction of ionizing radiation

with the atoms of the gas. When these electrons penetrate the holes, Townsend avalanches are generated

multiplying the primary charge. The possibility of cascading several GEMs, where each GEM multiplies

the charge from the preceding one increases signiﬁcantly the gain in charge of the detector, as well as its

stability.

Applications in low energy Physics, namely in X-ray imaging have been developed towards very high

resolutions, often at a cost of the detection areas. In fact, the newest room temperature solid state detectors

achieve remarkable energy and position resolutions in the µm range. This high resolution spans small areas

that range a few cm2 at most. In the study of historical artifacts or art pieces by X-ray Fluorescence, usually

areas in the order of hundreds of cm2 must be studied, with a resolution around 1 mm. This is usually done

with small solid state detectors without position sensibility, that are scanned through the whole area that

must be studied. GEM-based detectors can present an advantage, reconstructing elemental distributions

over large areas in a much shorter time, sparing the need of long and tedious scans. This approach has

been gaining some space, with diﬀerent groups using diﬀerent MPGD and presenting promising results with

GEM [6], Micro-Hole & Strip Plate (MHSP) [7] and Thick-Cobra[8]. Reference [9] makes a review on some

of the work done by diﬀerent research groups using MPGD with this technique.

The energy resolution limitations of this type of detector with respect to the solid state ones is obvious.

Nevertheless, by applying corrections related to variations of the signal amplitude during acquisitions and

also to local gain variations throughout the sensitive areas improve very much its performance, promising a

very valuable tool in X-ray Fluorescence Imaging.

2. Experimental setup

The detector consists on a cascade of three GEMs immersed in a mixture of Ar/CO2 (90/10) at atmo-

spheric pressure. The detector window consists of a kapton foil 50 µm thick. The gas passes through 4 mm

tubes and the ﬂow is set to 6 l/h. The triple-GEM geometry can be seen in ﬁgure 1, where the dimensions

and typical electric ﬁelds and voltages are also depicted.

2

Figure 1: The triple-GEM setup.

The hole pitch of the GEMs is 140 µm. The readout system is segmented in 256 strips in each dimen-

sion (ﬁg.2), which are interconnected through resistive chains. By collecting the charge at both ends of each

resistive chain, it is possible to calculate the projection of the primary X-ray ionization on the X–Y plane

for each coordinate through eq. 1.

x = l

XL − XR
A

,

y = l

YL − YR
A

(1)

where XL, XR, YL and YR are the signal amplitudes for the left and right ends of the X and Y resistive

chains according to ﬁgure 2, l is the length/width of the detector and A is given either by the sum of the

amplitudes of all four channels or by the amplitude of the signal collected from the bottom electrode of the

last GEM. This signal also served as the global trigger of the electronic system.

The charge collected by each channel is integrated by a standard charge sensitive pre-ampliﬁer with a

charge sensitivity around 1 V/pC and a rise time around 50 ns, and shaped by diﬀerentiating the signals,

resulting in a gaussian peak with a width of around 3 µs, which is suitable for the counting rates used

throughout this work. After application of simple logic, it is sampled by a standard 12 bit peaking ADC.

Figure 2: Scheme of the strip readout system using resistive chains.

As X-ray source we used the Amptek Mini-X [10] with a silver target, operating at a high voltage of

3

typically 15 kV and ﬁlament current around 15 µA. We also used a 55Fe radioactive source, which decays

into manganese by electron capture emitting 5.9 keV (Kα) and 6.4 keV (Kβ) characteristic X-rays, for energy

calibration and to determine the energy resolution. A framework for data processing, image reconstruction

and analysis was developed using the ROOT framework developed by CERN [11] and other C++ libraries.

To characterize the detector in terms of intrinsic position resolution, diﬀerent masks were imaged in

transmission mode, with the object placed between the detector and the X-ray source, directly on the

detector window, ensuring that there was no magniﬁcation in the transmission images obtained.

For the X-ray ﬂuorescence imaging, a stainless steel pinhole with diameter and thickness of 1mm was

placed between the sample and the detector window, at 10 cm from both, leading to a magniﬁcation of 1.

The sample object was irradiated with the high intensity X-ray source. The ﬂuorescence X-rays crossed the

pinhole before entering the detector, as shown in ﬁgure 3. The pinhole assures that the photons arriving at

each point in the sensitive area of the detector correspond univocally to one position in the sample, thus

allowing to accurately reconstruct the elemental distribution in the sample. To test this capability, a set of

four diﬀerent pigments was irradiated and imaged.

Figure 3: The pinhole setup used in this work for X-ray ﬂuorescence imaging.

3. Results and discussion

3.1. Energy resolution — signal amplitude corrections

The energy resolution was measured using a 55Fe radioactive source. The full window area was irradiated

with the source, which was placed about 10 cm above the detector window. During the irradiation time,

4

which in the ﬁnal application is expected to be 3 to 4 hours long, small drifts in the detector’s gain and

consequently in the amplitude of the signals are expected reﬂecting the changes in environmental conditions

of the detector surroundings, such as the temperature or atmospheric pressure. The study of the mech-

anisms of this inﬂuence is beyond the scope of this work, however, gain changes were forced by changing

the temperature of the room and test the algorithms for corrections of temporal variations of the signal

amplitude.

Figure 4 shows how a change in the gain of the detector can be induced by changing the environment

temperature.

Figure 4: Detector’s gain and room temperature measured over three hours, while varying the temperature of the lab.

The correction applied to the signal amplitude was done oﬄine and consisted in dividing the acquired

data in time slices, each one containing enough events to allow a correct determination of the center of

the main peak. A number of 105 events in each time slice was considered more than suﬃcient for this

correction and can be reduced in case of large and fast changes. After this, the position of the main peak

is normalized between all the time slices, eliminating the temporal diﬀerences of the signal amplitudes, as

shown in ﬁgure 5. This correction can be done to every set of data, regardless of the reason that made the

signal amplitudes drift.

Besides the corrections due to drifts of the amplitude in time, a second oﬄine correction was done

to compensate for the gain non-uniformity across the detector area.

It is know that many factors such

diﬀerences of the dielectric thickness, diﬀerent hole diameters or even slight staggering of the GEM foils

may locally aﬀect the detector gain and, consequently, the energy resolution. To overcome this issue the

eﬀective area of detection was divided into 1024 diﬀerent sectors and, again, the center of the main peak was

determined. The correction factor is calculated by dividing the correspondent position of the peak in ADC

5

Figure 5: Left: Distribution of the signal amplitude obtained with the 55Fe radioactive source over time. The color scale
indicates the number of counts. The bright part of the spectrum is the main peak of the energy spectrum. In this example, the
amplitude of the signals increased slowly during 140 minutes. Right: The distribution on the top, with the signal amplitude
corrected. The variations in the amplitude over time were corrected for the whole energy spectrum, including adjacent peaks,
such as the scape peak.

channels by the average of all 1024 sectors. Figure 6 shows the main peak position relative to the average

of the 1024 sectors. The gain variations have a standard deviation of 7 % and could be as high as 20%.

Figure 6: Left: the amplitude of the signals across the detector normalized to the average. Right: the amplitudes show a
standard deviation of 7 % throughout the sensitive area of the detector.

The spectra before each step of correction and the ﬁnal one can be seen in ﬁgure 7. As we can see, the

energy resolution improves signiﬁcantly with each correction, achieving in the end 6.8% energy resolution (σ),

after ﬁtting the two gaussian curves corresponding to the Kα and Kβ lines of manganese. The argon escape

peak can also be seen at around 2.9 keV in the energy distribution. This peak is related to argon ﬂuorescence

X-rays from the K shell that escape the detector, a well-known eﬀect (see [12] for example). The presence

of this escape peak is inevitable in detectors using argon mixtures and will be discussed further ahead.

6

Figure 7: Left: Green — The raw energy spectrum; Blue — after temporal correction; Red — both temporal and spatial
corrections applied. Right: The energy resolution obtained after the corrections is 6.8% (σ).

Figure 8: The Modulation Transfer Function obtained by imaging a sharp edge. Left: a sharp edge proﬁle in the image is
the Edge Spread Function (ESF). The ESF is derivated resulting in the Line Spread Function (LSF). Right: The Fast Fourier
Transform of the LSF results in the Modulation Transfer Function (MTF). The red curve is not a ﬁt, it is placed to guide the
eye. The position resolution is usually taken from the MTF at 10 % (marked in the plot), which is around 1.8 mm( 1
0.56 lp/mm),
consistent with the width of the LSF.

3.2. Position resolution

The imaging capability of the detector was characterized using X-ray transmission through diﬀerent

masks that allowed to calculate its performance in terms of resolution and contrast as a function of the

spatial resolution. One of the most reliable methods for estimating the performance of an imaging system

is calculated from the image of a sharp edge. The edge intensity proﬁle is a step function, where its slope

is a measure of the position resolution. The width of its derivative is used to quantify this slope and by

application of a Fourier Transform, the contrast of the imaging system as a function of the spacial frequencies,

i.e., the Modulation Transfer Function (MTF) can be estimated. Figure 8 shows process of obtaining the

MTF obtained for this detector, when the full energy spectrum from a silver target X-ray source was used.

The distances in the image were calibrated by using the known distance between the two edges.

One of the features of this type of detector is the dependence of the spatial resolution on the X-ray

energy. Figure 9 shows that dependency in this speciﬁc detector. It is directly related to the range of the

photo-electrons, that in Argon, above the K-absorption edge at 3 keV, increases monotonically. Since the

7

Figure 9: The position resolution of the detector as a function of the X-ray energy (red line). The position resolution worsens
for higher energies due to the higher range of the photo-electrons. For the lower energy, its deterioration is related with the
poorer signal-to-noise ratio. The blue line indicates the resolution limit for pure Argon as simulated in [14].

data was collected event-by-event, it was possible to measure resolutions of images only for certain energy

range. With this, it was possible to study the dependence of the position resolution with the energy. For

lower energies the position resolution also worsens due to the smaller signal-to-noise ratio. This has been

studied for this detector and reported in [13]. The best result in terms of position resolution is 1.2 mm,

achieved for the 8–9 keV range.

To address the image distortions caused by the resistive chain either due to resistor inaccuracies or to

imperfections in the mounting of the components, not only the resistors, but also the 128 pin connector,

a study of the diﬀerential non-linearity was carried out. The diﬀerential non-linearity is deﬁned here in

analogy to the analog to digital converters, and is the deviation between the distances measured by the

detector, relatively to their correct value. For this, a 1 mm thick steel plate perforated with a square matrix

of 1 mm holes at a pitch of 10 mm was placed on the detector window and imaged with the X-ray source

at a reasonable distance to keep the magniﬁcation negligible. Figure 10 shows the imaged plate on the left,

with the real position of the holes marked with black dots. A histogram of the distance between the pairs

of holes in the image, normalized by the real one (10 mm) is shown in the left side of ﬁg. 10 for the x and

y directions. The DNL is given by the standard deviations of the distributions and is 3.4 % and 6.2 % for x

and y, respectively.

3.3. X-Ray ﬂuorescence imaging

The X-ray Fluorescence Imaging capability of the system was tested by irradiating a set of four diﬀerent

ink pigments. The pigments were chrome yellow, cadmium yellow, cerulean blue and cobalt blue. The

pigments may also contain zinc white ink in their composition [15]. Figure 11 shows the pigments used.

They spanned an area around 50 cm2. The sample was irradiated during 4 hours with a ﬁlament current of

8

Figure 10: Left: the image of a square matrix of 1 mm holes with a pitch of 10 mm. Right: Histogram of the distance between
each pair of holes as measured by the detector, normalized by the real distance of 10 mm. The standard deviation of these
distributions is the diﬀerential non-linearity which is 3.4 % and 6.2 % for x and y, respectively.

200 µA.

The reconstructed total energy distribution after the corrections described in subsection 3.3.1, and el-

emental map of the sample is shown in ﬁgure 12. The color scale in the image does not reﬂect the X-ray

intensity, but the average energy of the spectrum in each pixel, as shown by the RGB rainbow (built from

the red, green and blue palletes) in the energy spectrum. The X-ray intensity is given by the brilliance.

To match the energies with the color scale, each ADC value is weighted by the correspondent amount

of each of the three primary colors as ﬁgure 13 shows. Based on this weight, tree diﬀerent images — one

for each primary color — are reconstructed. After a trivial leveling of the colors for white balancing, the

images are merged, resulting in an image that has information of both the intensity and the energy of the

X-rays. This makes an automatic color separation of the diﬀerent elements in the sample.

From the energy spectra of the four regions corresponding to the four pigments, it is possible to extract

information of the elements present in each one. The energy distributions are shown in ﬁgure 14, where the

main peaks are identiﬁed.

As mentioned before, one feature of this type of detector, using argon-based mixtures is the presence of an

argon escape peak associated to every major peak, appearing at an energy 3 keV smaller. The interpretation

of the energy spectra must take this into account. Some of the argon escape peaks are identiﬁed in the

spectra of ﬁgure 14 with a red scale, showing how they can overlap other peaks or the background, making

the identiﬁcation of elements somehow more complex.

The diﬀerences between the two spectra of the yellow pigments are very clear. Where the cadmium

yellow shows zinc and cadmium in its composition, the chromium yellow pigment contains copper and lead,

9

Figure 11: The pigments used to test the X-ray Fluorescence Imaging system. Top-left: Cadmium yellow. Bottom-left:
Chromium yellow. Top-right: Cerulean blue. Bottom-right: Cobalt blue.

Figure 12: Top: The energy spectrum for the total area. Bottom: XRF image generated for the four pigments. The colors
indicate the mean energy deposited in each pixel.

besides chromium. The leftmost peak at around 3 keV and the traces of zinc evident by the small shoulder in

the copper peak, suggest a small contamination of this pigment with cadmium yellow. In the blue pigments,

it is interesting to note that both were composed of cobalt and zinc, but in clearly diﬀerent concentrations.

It is important to notice that this analysis is qualitative. In the case of the blue pigments, it is possible

to conclude that the cerulean blue has a higher concentration of zinc, when compared with the cobalt blue.

However, the determination of the absolute concentration of each one of the elements must take into account

the X-ray emission yields and the eﬃciency of the detector for each X-ray energy range. This eﬃciency drops

for higher energies due to the small thickness of the absorption region, which is 8 mm. For the lower energies,

the kapton window and cathode, with a total thickness of 100 µm, and the distance the X-rays must travel

in air before entering the detector also limit the eﬃciency.

10

Figure 13: Left: the colors at the limit of the RGB spectrum are adjusted to the maximum and minimum energies of the X-ray
energy spectrum. Right: the intensity of each X-ray energy is given by the brightness: more dark for lower intensities and
more bright for higher intensities.

The eﬃciency calculated by taking into account the fraction of X-ray photons hitting the detector that

are actually detected is shown in ﬁgure 15. This calculation is done from the absorption coeﬃcients from

the argon-based mixture and the transmission of the kapton and the layer of air, according to the geometry

of the system, and using the X-ray interaction tables from [16]. The detection eﬃciency peaks around 7 keV

and drops very sharply for lower energies. The eﬃciency for lower energies can be increased by changing

the materials of the window and the cathode. For higher energies, the drop in eﬃciency is less steep. On

this side, the eﬃciency can be increased by increasing the depth of the drift region.

4. Conclusion and outlook

The position sensitive gaseous detector prototype for X-ray ﬂuorescence imaging using a pinhole described

in this work is capable of mapping elemental distributions in space with a position resolution close to 1 mm.

Its large sensitive area (100 cm2) and simultaneous sensitivity to both energy and position make it suitable

to study large distributions, such as those seen in paintings or other cultural and archaeological artifacts.

The elemental distribution in space is reconstructed with a single data acquisition, without the need of

scanning the detector or the X-ray source through the object. The gain in time and system simplicity is

an advantage that can make this concept competitive, even with the disadvantages of limited energy and

position resolutions. The corrections done to the energy distributions to compensate for small drifts in the

gain during the acquisition and for the spacial non-uniformities of the detector kept the energy resolution

at the same value as when only a small area of the detector is used. This gives very good perspectives for

scaling the sensitive area, to obtain even larger images, eventually with geometries that take advantage of

magniﬁcation, to image smaller objects with higher position resolution.

The aim of this paper is to describe the performance of the detector, therefore, the practical example

shown does not make a quantitative elemental analysis of the pigments. However, by applying corrections to

11

Figure 14: Energy spectrum for each pigment. The dotted black lines show the expected elements for each sample. The dotted
red rules mark an energy diﬀerence of 3 keV to each peak, showing the expected position of the argon escape peaks.

12

Figure 15: The detection eﬃciency taking into account the transmission of X-rays through the two layers of kapton in the
detector and 20 cm of air and absorption in the 8 mm of Ar/CO2 in the drift region. The axis in the left refers to the transmission
and absorption of the X-rays (red and blue curves) and the axis on the right refers to the detection eﬃciency (black curve).

the X-ray yield of each element, the self absorption and the detector and geometry eﬃciency as a function

of the energy, it would be possible to estimate absolute concentrations in the diﬀerent regions of the image.

The electronic system is very simple, with only ﬁve electronic channels. This has the advantage of cost

eﬀectiveness when the energies are above 6 keV. Below these values, the signal-to-noise ratio becomes a

problem and the loss of position resolution is inevitable. To solve this problem, the replacement of the

acquisition system is foreseen. The new system will consist of discrete electronics, with 512 electronic

channels readout via an ASIC. The elimination of the resistive chains will dramatically reduce the noise at

a small cost, signiﬁcantly improving the resolution of the images for low X-ray energies.

Other major improvements are planned for the detector itself, related to the improvement of the eﬃciency

for lower and higher energies, by replacing the window by a thinner kapton foil and the cathode foil by a

1.5 µm thick aluminized polypropylene foil and by increasing the thickness of the drift region to around

20 mm. Finally, a new 100 µm pinhole in a thin(200 µm) gold foil will also be tested, to make sure the

improvements of this system in terms of position resolution will not be limited by geometrical features or

by contamination of the spectra with ﬂuorescences that do not occur in the sample.

Acknowledgments

This work was supported by grants 2016/05282-2 and 2017/00426-9 from Fundação de Amparo à Pesquisa

do Estado de São Paulo, Brasil.

References

[1] F. Sauli, GEM: A new concept for electron amplication in gas detectors, Nucl. Instr. Meth. A 386 (1997) 531–534.

13

[2] A. Cardini, G. Bencivenni, P. De Simone, The Operational Experience of the Triple-GEM Detectors of the LHCb Muon

System: Summary of 2 Years of Data Taking, Tech. Rep. LHCb-PROC-2012-060. CERN-LHCb-PROC-2012-060, CERN,

Geneva (Nov 2012).

[3] C. Altunbas et al., Construction, test and commissioning of the triple-GEM tracking detector for COMPASS, Nucl. Instr.

Meth. A 490 (2002) 177.

[4] Upgrade of the ALICE Time Projection Chamber, Tech. Rep. CERN-LHCC-2013-020. ALICE-TDR-016 (Oct 2013).

[5] A. Colaleo, A. Safonov, A. Sharma, M. Tytgat, CMS Technical Design Report for the Muon Endcap GEM Upgrade, Tech.

Rep. CERN-LHCC-2015-012. CMS-TDR-013 (Jun 2015).

[6] A. Zielińska, W. Dąbrowski, T. Fiutowski, B. Mindur, P. Wiącek, P. Wróbel, X-ray ﬂuorescence imaging system for fast

mapping of pigment distributions in cultural heritage paintings, Journal of Instrumentation 8 (10) (2013) P10011–P10011.

doi:10.1088/1748-0221/8/10/p10011.

[7] A. Silva, C. Azevedo, C. Oliveira, J. D. Santos, M. Carvalho, J. Veloso, Characterization of an energy dispersive x-ray

ﬂuorescence imaging system based on a micropattern gaseous detector, Spectrochimica Acta B 66 (2011) 308–313.

[8] A. L. M. Silva, C. D. R. Azevedo, L. F. N. D. Carramate, T. Lopes, I. F. Castro, R. de Oliveira, J. F. C. A. Veloso, X-ray

imaging detector based on a position sensitive THCOBRA with resistive line, Journal of Instrumentation 8 (05) (2013)

P05016–P05016. doi:10.1088/1748-0221/8/05/p05016.

[9] J. Veloso, A. Silva, Gaseous detectors for energy dispersive x-ray ﬂuorescence analysis, Nucl. Instr. Meth. A 878 (2018)

24–39.

[10] AMPTEK - mini-x x-ray tube system for xrf, access in: 23-03-2019.

URL http://amptek.com/products/mini-x-ray-tube/2016/

[11] R. Brun, F. Rademakers, ROOT - An Object Oriented Data Analysis Framework, in: N. I. . M. in Phys. Res. A (Ed.),

Proceedings AIHENP’96 Workshop, Vol. 389, Lausanne, 1996, pp. 81–86, see also http://root.cern.ch/.

[12] J. Heintze, Die Röntgen-K-Fluoreszenzausbeute des Neon, Argon, Krypton und Xenon, Z. Physik 143 (1955) 153.

[13] G. Souza, H. N. da Luz, Characterization of a triple-GEM position sensitive detector for X-ray ﬂuorescence imaging, in:

X-Ray Spectrometry (Wiley on-line Library), 2018, submitted to the Proceedings of the European Conference on X-Ray

Spectrometry.

[14] C. Azevedo, S. Biagi, R. Veenhof, P. Correia, A. Silva, L. Carramate, J. Veloso, Position resolution limits in pure noble

gaseous detectors for X-ray energies from 1 to 60 keV, Physics Letters B 741 (2015) 272–275.

[15] N. F. Aguero, Study of degradation processes of blue and yellow pigments, Master’s thesis, University of São Paulo -

Institute of Physics, Brazil, access in: 04-04-2019 (2017).

URL http://www.teses.usp.br/teses/disponiveis/43/43134/tde-21062017-204330

[16] B. Henke, E. Gullikson, J. Davis, X-ray interactions: photoabsorption, scattering, transmission, and reﬂection at E=50-

30000 eV, Z=1-92, Atomic Data and Nuclear Data Tables 54 (2) (1993) 181–342.

14

