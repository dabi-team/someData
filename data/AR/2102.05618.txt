Draft version February 11, 2021
Typeset using LATEX preprint style in AASTeX63

1
2
0
2

b
e
F
0
1

]

R
S
.
h
p
-
o
r
t
s
a
[

1
v
8
1
6
5
0
.
2
0
1
2
:
v
i
X
r
a

Variations in Finite Diﬀerence Potential Fields
Ronald M. Caplan,1 Cooper Downs,1 Jon A. Linker,1 and Zoran Mikic1, 2

1Predictive Science Inc., 9990 Mesa Rim Road, Suite 170, San Diego, CA 92121, USA
2Retired

ABSTRACT
The potential ﬁeld (PF) solution of the solar corona is a vital modeling tool for a
wide range of applications, including minimum energy estimates, coronal magnetic ﬁeld
modeling, and empirical solar wind solutions. Given its popularity, it is important to
understand how choices made in computing a PF may inﬂuence key properties of the
solution. Here we study PF solutions for the global coronal magnetic ﬁeld on 2012
June 13, computed with our high-performance ﬁnite diﬀerence code POT3D. Solutions
are analyzed for their global properties and locally around NOAA AR 11504, using the
net open ﬂux, open ﬁeld boundaries, total magnetic energy, and magnetic structure as
metrics. We explore how PF solutions depend on 1) the data source, type, and pro-
cessing of the inner boundary conditions, 2) the choice of the outer boundary condition
height and type, and 3) the numerical resolution and spatial scale of information at the
lower boundary. We discuss the various qualitative and quantitative diﬀerences that
naturally arise by using diﬀerent maps as input, and illustrate how coronal morphology
and open ﬂux depend most strongly on the outer boundary condition. We also show
how large-scale morphologies and the open magnetic ﬂux are remarkably insensitive
to model resolution, while the surface mapping and embedded magnetic complexity
vary considerably. This establishes important context for past, current, and future
applications of the PF for coronal and solar wind modeling.

Keywords: Solar corona (1483); Solar coronal holes(1484); Solar surface(1527); Astron-

omy software(1855); Astronomy data analysis(1858)

1. INTRODUCTION

The simplest description of the coronal magnetic ﬁeld, based on a photospheric boundary radial
magnetic ﬁeld, is a potential (current-free) ﬁeld model. These solutions have been used for many
years to understand and interpret a wide variety of solar and heliospheric phenomena, including the
behavior of the interplanetary magnetic ﬁeld (e.g., Hoeksema et al. 1983; Wang & Sheeley 1994), the
structure and evolution of coronal hole boundaries (e.g., Wang et al. 1996; Wang & Sheeley 2004),
the source locations of solar energetic particles (e.g., Nitta et al. 2006), coronal heating and X-ray
emission (Schrijver et al. 2004), coronal magnetic ﬁeld topology (e.g., Antiochos et al. 2007; Titov

Corresponding author: Ronald M. Caplan
caplanr@predsci.com

 
 
 
 
 
 
2

et al. 2011), and as initial conditions for coronal MHD simulations (e.g., Linker et al. 1999). Empirical
solar wind models, derived from the properties of potential ﬁeld solutions (e.g., Wang & Sheeley 1990;
Arge et al. 2003; Riley et al. 2015), are used to predict solar wind properties in interplanetary space.
In particular, the Wang-Sheeley-Arge (WSA) model (Arge et al. 2004) is an element of NOAA Space
Weather Prediction Center’s operational solar wind model (Pizzo et al. 2011).

The most common versions of PF models are the potential ﬁeld source-surface (PFSS, Altschuler
& Newkirk 1969; Schatten et al. 1969) and potential ﬁeld current-sheet (PFCS) models (Schatten
1971). In the PFSS model, the ﬁeld at the upper radial boundary (the source-surface) is assumed
to be fully radial. The PFCS model is used to extend the ﬁeld from the source surface to 20-30 R(cid:12)
and reproduce the latitudinally independent behavior of the magnitude of the radial component of
magnetic ﬁeld (|Br|) observed by Ulysses (Smith & Balogh 1995, 2008).

PF solutions have been frequently calculated using low resolution input data and spherical harmonic
expansion algorithms (e.g, Schrijver & DeRosa 2003). The PFSS package in SolarSoftWare (Freeland
& Handy 1998) is frequently used. These solutions are adequate for many purposes. However, with
the availability of higher resolution data and modern computing techniques, much higher resolution
solutions can now be computed rapidly. Thus far, relatively little attention has been paid to how
commonly inferred physical properties of the solutions change with increasing resolution. The nature
of the boundary data (i.e. the source map) and model parameters (e.g. source-surface radius) can
also aﬀect the solutions.

In this paper, we explore these diﬀerences using our ﬁnite diﬀerence PF solver code POT3D. A ﬁnite
diﬀerence approach can be preferable to the harmonic approach, because mismatches between the
order of the harmonics and the resolution of the data can lead to ringing of harmonic solutions (T´oth
et al. 2011). It also allows localized higher resolution to be implemented. POT3D utilizes a non-
uniform logically-rectangular spherical grid and is designed for high performance parallelization using
the Message Passing Interface (MPI) with a three-dimensional decomposition, and GPU-acceleration
using OpenACC (see Sec. 2 for more details). POT3D can compute PFSS, PFCS, and the closely
related Open Field (Barnes & Sturrock 1972) solutions for an input magnetic ﬂux distribution.

To demonstrate coronal solutions, we select a nominal date of 2012 June 13 near 13:11:36 TAI,
which is part of Carrington Rotation (CR) 2124. We examine how global coronal properties change
between each solution, as well as a local region centered on NOAA active region (AR) 11504. Fig. 1
shows a synchronic extreme ultraviolet (EUV) map using data near the targeted time. This map
gives an instantaneous snapshot of the corona’s morphological appearance over the full sun. For each
solution we compute quantities such as the total magnetic energy and open magnetic ﬂux, and others
based on ﬁeld line mappings, including maps of the open ﬁeld and the generalized squashing factor,
Q (Titov 2007). Q maps are a useful tool for visualizing magnetic topology and complexity on large
and small scales.

A comparison of ﬁnite-diﬀerence PF solutions for CR2144 (approximately a year and a half from
our target date) was performed in Hayashi et al. (2016) using various observatory data, ﬂux balancing
methods, and smoothing ﬁlters, with a constant resolution and boundary condition. Their focus was
on comparisons to observations, such as EUV coronal holes to the open ﬁeld, and OMNI magnetic
In contrast, here we vary the resolution, boundary conditions, and data
data to the open ﬂux.
source, and focus on the inherent diﬀerences between solutions, as well as both global and localized
comparisons.

3

Figure 1. Synchronic EUV composite map for 2012 June 13 12:00 UT (from Caplan et al. 2016, www.
predsci.com/chd). The map is constructed from STEREO A/B EUVI 195 and SDO AIA 193 images, and
the targeted region around AR 11504 is highlighted.

We note that a number of PF ﬁnite diﬀerence solver codes have been developed over the years. Two
presently publicly available solvers are the FDIPS1 Fortran code (T´oth et al. 2011) and the recently
released PFSSPY2 python package (Stansby et al. 2020). While both these packages work very well
for their intended use cases, in this study we require higher performance and more grid ﬂexibility
than either tool currently oﬀers.

The paper is outlined as follows: In Sec. 2 we describe how global coronal PF solutions are computed
with the POT3D code. Sec. 3 describes how we prepare the photospheric magnetic ﬁeld data needed
for the model. Our standard setup and comparison metrics are described in Sec. 4. Variations of
input data, boundary conditions, and resolutions are described in Secs. 5, 6, and 7 respectively. We
discuss these results and conclude in Sec. 8.

2. POTENTIAL FIELD SOLUTIONS WITH POT3D

POT3D is a Fortran code that computes potential ﬁeld solutions to approximate the solar coronal
magnetic ﬁeld using observed photospheric magnetic ﬁelds as a boundary condition. It is also used for
computing Open Field and PFCS models (see Appendix A for details). It has been (and continues to
be) used for numerous studies of coronal structure and dynamics (e.g., Linker et al. 2016; Titov et al.
2012) and is the potential ﬁeld solver for the WSA model in the CORHEL software suite publicly
hosted at NASA’s Community Coordinated Modeling Center (CCMC)3. The POT3D source code is
available as part of the Standard Performance Evaluation Corporation’s (SPEC) beta version of the
SPEChpcTM 2021 benchmark suites4 and, with publication of this paper, as an open-source release
on GitHub5.

A potential ﬁeld (PF) is a force-free and current-free magnetic ﬁeld. Setting the current in Maxwell’s
equation (∇ × B = µ0 J) to zero (J = 0) leads to solutions of the form B = ∇Φ, where Φ is the scalar

2.1. Model description

1 http://csem.engin.umich.edu/tools/FDIPS
2 https://pfsspy.readthedocs.io
3 https://ccmc.gsfc.nasa.gov/
4 https://www.spec.org/hpc2021
5 https://github.com/predsci/POT3D

4

potential. Combined with the divergence-free condition (∇ · B = 0), this yields a Laplace equation
for Φ:

∇2Φ = 0.

(1)

We use spherical coordinates, and the lower boundary condition at r = R(cid:12) (the solar surface) is set
based on a surface-map of the radial magnetic ﬁeld, Br, as

∂Φ
∂r

(cid:12)
(cid:12)
(cid:12)
(cid:12)R(cid:12)

= Br|R(cid:12)

.

(2)

Depending on the needs of the application, the upper boundary (r = r1) can be set to either a ‘closed
= 0) condition as depicted in Fig. 2. The φ direction uses
wall’ (Br|Rr1

= 0) or ‘source surface’ ( Φ|r1

Figure 2. Field lines of a potential ﬁeld solution using ‘closed wall’ (left) and ’source surface’ (right) outer
boundary conditions in POT3D.

a periodic boundary ( Φ|φ=0 = Φ|φ=2 π), while polar boundary conditions are set using the average

Φ|θ0/π

=

1
2 π

(cid:90) φ=2 π

φ=0

Φ|θ0/π±(cid:15) dφ,

(3)

where (cid:15) is a small distance to the pole. Once Eq. (1) is solved, we set B = ∇Φ to get the magnetic
ﬁeld.

2.2. Numerical methods

POT3D solves Eq. 1 globally using ﬁnite diﬀerences on a non-uniform logically-rectangular spherical
grid. After solving for Φ, each component of the resulting ﬁeld B is saved on a staggered grid. The
ﬁnite-diﬀerence current derived from this ﬁeld is identically zero-valued (J = 0), while the ﬁeld’s
divergence-free condition (∇ · B = 0) is satisﬁed to the level of the solver tolerance.

POT3D uses a second-order ﬁnite-diﬀerence method (Veldman & Rinzema 1992) in which Eq. (1)

takes the form

∇2Φi,j,k ≈

(cid:34)

1
∆ri

Φi+1,j,k − Φi,j,k
∆ri+ 1
(cid:34)
sin θi,j+ 1

2

2

(cid:35)

−

Φi,j,k − Φi−1,j,k
∆ri− 1

2

Φi,j+1,k − Φi,j,k
∆θj+ 1

2

− sin θi,j− 1

2

Φi,j,k+1 − Φi,j,k
∆φk+ 1

2

−

Φi,j,k − Φi,j,k−1
∆φk− 1

2

+

+

1
sin θj ∆θj

(cid:34)

1
sin2 θj ∆φk

(4)

(cid:35)

Φi,j,k − Φi,j−1,k
∆θj− 1

2

= 0.

(cid:35)

Eq. 4 can be represented in matrix form as

A Φ = 0.

5

(5)

In POT3D, the sparse symmetric matrix A is stored in a custom DIA sparse format (Bell & Garland
2008) for the inner grid points, while the boundary conditions are implemented matrix-free. The sys-
tem is solved using the Preconditioned Conjugate Gradient (PCG) method with two communication-
free preconditioners: 1) A point-Jacobi/diagonal-scaling (PC1) which uses the inverse of the diagonal
of A, and 2) A non-overlapping domain decomposition with zero-ﬁll incomplete LU factorization
(PC2) Saad (2003). PC1 has a computationally inexpensive formulation and application, but it is
limited in its eﬀectiveness at reducing iterations. PC2 is more computationally expensive to formulate
and apply, but is also much more eﬀective at reducing iterations. In some cases, it is possible for PC1
to outperform PC2 (e.g. when solving problems requiring very few iterations, when using hardware
that is very eﬃcient for vectorizable algorithms, or when the ILU0 suﬀers ‘breakdown’ (Chow & Saad
1997)). For PC2, the LU matrix is stored in a memory-optimized CSR format (Smith & Zhang 2011),
and solved with the standard backward-forward algorithm. The PCG solver’s convergence criteria is
chosen to be when |rp|/|bp| < (cid:15), where |rp| is the norm of the preconditioned residual and |bp| is the
norm of the preconditoned right-hand-side (whose values are set by the boundary conditions). For
the solutions performed in this work, we set (cid:15) = 10−9.

2.3. Parallelization

POT3D is parallelized using MPI and can scale to thousands of CPU cores. Each MPI rank
takes one subsection of the grid (as cubed as possible) and treats it as its own local domain for all
operations. The only MPI communication needed are point-to-point messages for the local boundaries
in the matrix-vector product, and collective operations for the inner products and polar boundary
conditions. Initial and ﬁnal collectives are also used to decompose the domain and collect the solution
for output.

POT3D is GPU-accelerated using the OpenACC directive-based API (Chandrasekaran & Juckeland
2017). This allows the code to be compiled for either CPU or GPU systems using a single source
code. The code can scale to multiple GPU accelerators across multiple compute nodes.

Performance results for a selection of solutions computed in this paper are shown in Appendix B.

3. MAP PREPARATION

For all input maps, several steps are taken to prepare them for use in POT3D. The details of each

step are beyond the current scope, but are summarized here.

We require full-Sun maps of the surface radial magnetic ﬁeld (Br). These are commonly provided
by observatories, often with Br inferred from the line-of-sight ﬁeld, under the assumption that the
ﬁeld is radial where it is measured in the photosphere (Wang & Sheeley 1992). Since all current
magnetic imagers are situated on the Sun-Earth line, multiple images over time are combined in
some way to form a full map. Therefore, our ﬁrst step is to use either a publicly available full-Sun
data product (such as a ‘Carrington’ map), or manually combine data from these and various other
sources. Sometimes the full-sun products are not as high-resolution as the original measurements,
In these cases we ‘stitch’ various data products together.
or have incomplete data at the poles.
For example, to resolve an AR at a high resolution closest to a desired time, we might insert high-
resolution data into an otherwise prepared full map. The polar regions also present a unique challenge

6

as they are always poorly observed and often need to be extrapolated. Numerous pole-ﬁlled data
products are now available, but if needed/desired, we utilize our own polar ﬁlling procedure.

Since the magnetic ﬁeld data for a map is constructed from data taken over time, the map is
generally not ﬂux-balanced (i.e. ∇ · B (cid:54)= 0). We therefore calculate the total ﬂux imbalance and
modify the map through multiplication to obtain a ﬂux-balanced input at the inner boundary. The
use of a multiplicative method instead of a simple additive approach preserves the location and
structure of neutral lines (see (Hayashi et al. 2016) where additive ﬂux balancing resulted in very
diﬀerent PF solutions).

Once a fully speciﬁed, ﬂux-balanced, full-Sun map is constructed, we interpolate it to the desired
resolution for the POT3D code. This is done in a ﬂux-preserving way by projecting the source
pixel grid onto the destination grid and integrating the contained or fractionally overlapped portions
cell-by-cell.

Finally, we smooth the map in order to allow the ﬁnite-diﬀerence representation to resolve any
small structures. In order to maintain ﬂux balance and avoid aliasing issues, we use a time-dependent
spherical-surface diﬀusion equation integrator. The spatially-variant diﬀusivity is set based on the
local grid size in order to only smooth the minimum amount needed for resolvablility.
An example of applying the interpolation and smoothing steps are shown in Fig. 3.

Figure 3. Depiction of magnetic map processing. A full-Sun, ﬂux-balanced composite map is shown on the
left. The map interpolated to a non-uniform grid is shown in the center. The ﬁnal map after smoothing is
shown on the right.

4. COMPARISON METHOD AND DEFAULT PARAMETERS

To compare the PF solutions, we compute several derived quantities. By tracing ﬁeld lines through
the solutions, we generate open ﬁeld and squashing factor, Q, maps (Titov 2007) both globally and
locally near the AR. We compute the total open ﬂux, and display it as an extrapolated IMF value
at 1AU as

(cid:18) r1
r1au
and the area of open ﬁeld regions at the surface as

|Φopen|
4π r2

|Br1au| =

1
4

=

1au

(cid:19)2 (cid:90) 4π

0

|Br(r1, θ, φ)|dΩ,

Aopen =

(cid:90) 4π

0

OF(r0, θ, φ)dΩ,

where at each pixel, OF = 1 if the ﬁeld is open, and OF = 0 if it is closed. We also compute the
magnetic energy within both the AR region and full computational domain as

W =

1
8 π

(cid:90) φ1

(cid:90) θ1

(cid:90) r1

φ0

θ0

r0

|B|2 r2 sin θ dr dθ dφ.

(6)

7

In order to account for the truncated radial domain for global calculations, we add the average of an-
alytic approximated upper and lower bounds of the magnetic energy out to inﬁnity (see Appendix C).
The AR 11504 region is taken to be bounded by r ∈ [1.0, 2.0] R(cid:12), θ ∈ [1.79, 1.93], and φ ∈

[1.37, 1.65]. This region is depicted as the magenta contour in Fig. 1.

All solutions use a radial non-uniform grid which coarsens towards the outer radial boundary. The
non-uniformity is set such that the grid cells are as ‘square’ as possible at the outer boundary. To
achieve this with our choice of radial non-uniformity, we set the number of r grid points to be 1/6.67
of the number of φ grid points. The default Nφ × Nθ resolution is set to 360 × 180. The default radial
domain is set to have an outer radii of 2.5 R(cid:12) and the boundary condition is set to the source-surface
condition described in Sec. 2.1. The default input Br map is the one designated as map (PSI) below
in Sec. 5.

In all comparisons, any parameters not explicitly mentioned conform to the defaults described in

this section.

5. VARIATIONS IN INPUT DATA

Although it is well known that diﬀerent map sources/products will lead to diﬀerent solutions
(Hayashi et al. 2016; Linker et al. 2017), it is still illustrative to compare some of the more common
data products in use today. This serves to provide a baseline for the sections that follow, in order
to assess how the level of variation seen there compare to the variations seen here. We also compare
the standard map products with our custom map created from multiple data sources, as we will use
the custom map in the rest of the paper as described in Sec. 4.

For all maps (except the custom map) we limit ourselves to publicly available, pole-ﬁlled maps.
These maps come from data obtained from the National Solar Observatory’s Global Oscillation
Network Group (GONG) (Harvey et al. 1996) and the Helioseismic Magnetic Imager (HMI) aboard
the Solar Dynamics Observatory (Scherrer et al. 2012). Our time of interest is 2012 June 13 (part
of CR2124), and we use the following maps (ﬁlenames of the publicly available data from the Joint
Science Operations Center 6 are indicated):

(GS) – GONG Pole-ﬁlled Synoptic CR2124
(mrmqs120608t0040c2124 000.fits)

(GH) – GONG Pole-ﬁlled Hourly 2012/06/13 11:54
(mrbqs120613t1154c2124 047.fits)

(GJ) – GONG Pole-ﬁlled Janis 2012/06/13 11:54
(mrbqj120613t1154c2124 047.fits)

(HS) – HMI Pole-ﬁlled Synoptic CR2124
(hmi.synoptic mr polfil 720s.2124.Mr polfil.fits)

(HD) – HMI Pole-ﬁlled Daily 2012/06/13 12:00
(hmi.mrdailysynframe polfil 720s.20120613 120000 TAI.Mr polfil.fits)

(PSI) – (HS) + SHARP + Pole-ﬁlling (see text)

6 http://jsoc.stanford.edu

8

We note that maps (GH), (GJ), and (HD) are not provided in Carrington coordinates. In order
to have all maps in equivalent coordinates for comparison, we apply a shift in φ (−47◦ for (GH) and
(GJ), and −47.40796◦ for (HD) (Sun 2018)) to place these maps into Carrington coordinates.

Map (PSI), is our ‘best’ map for the time period and AR of interest in this paper. To generate this
map, we take vector Br data from the Spaceweather HMI Active Region Patch (SHARP) database
(Bobra et al. 2014). We insert patches 118, 112, and 106 into the synoptic HMI map (HS). Although
the poles are already ﬁlled in the (HS) data product, we reﬁll the poles ourselves by inserting
a random distribution of parasitic polarities whose net ﬂux matches the pole-ﬁlled map in these
regions (similar to Miki´c et al. 2018).

In Fig 4 we show both the original data product for each map, as well as the resulting default
resolution map. We see that all maps appear similar after processing. The (PSI) map stands out as
its poles have parasitic polarities and therefore exhibit more polar structure than the other maps.

In Fig 5 we show the maps of the open ﬁeld at the surface or ‘open ﬁeld maps’, derived by tracing
ﬁeld lines through the PF solution for each Br map. The open regions are segmented and colored
to indicate each region’s percentage contribution to the total open ﬂux. All maps yield somewhat
similar open ﬁeld maps, but with multiple small diﬀerences throughout. A key observation is that
a non-trivial amount of open ﬂux is contained in scattered small regions of the open ﬁeld. If these
small open ﬁeld regions are ubiquitous on the actual Sun, they may not be visible as coronal holes,
and may contribute to the missing open ﬂux identiﬁed by Linker et al. (2017).

In Fig 6 we show maps of the squashing factor at the inner boundary and source surface. Although
Q appears similar in all maps, on close inspection, there exists small structural changes between
the maps both at the surface and the outer radial boundary. For example, the GONG Janis and
HMI Daily maps at the outer radial boundary have a noticeably diﬀerent Q structure near φ = π/3,
cos θ = 1/2 when compared to the rest of the maps. As these magnetograms are the data source
for many coronal and solar wind models (empirical or MHD), these variations may be an important
consideration.

In Fig 7 we show the comparison quantities computed for each map as described in Sec. 4. We
see a clear grouping of the maps using GONG- or HMI data, with GONG-based maps exhibiting
larger open ﬁeld areas and smaller magnetic energies compared to HMI-derived maps. However, the
open ﬂux for all maps are similar (within 10%). We also ﬁnd that the magnetic energy (especially
within the AR region) is highly variable even within the same instrument source. This is likely due
to the maps incorporating data in this region at diﬀerent times (such as hourly vs. CR), and inherent
diﬀerences between the observatories (Riley et al. 2014). Therefore if one is interested in a region
at a speciﬁc time, it is important to use data taken as close to that time as possible as the local
properties can change signiﬁcantly in a short amount of time due to surface evolution.

6. VARIATIONS IN BOUNDARY CONDITIONS

Here we investigate how changing the outer boundary condition eﬀects the results. We compare a

closed-wall outer boundary to a source surface boundary at various radii. The selected options are

(CW2.5) Closed-wall with r1 = 2.5R(cid:12)

(SS1.5) Source-surface with rss = 1.5R(cid:12)

(SS2.0) Source-surface with rss = 2.0R(cid:12)

9

c
i
t
p
o
n
y
S
G
N
O
G

y
l
r
u
o
H
G
N
O
G

s
i
n
a
J
G
N
O
G

c
i
t
p
o
n
y
S

I

M
H

y
l
i
a
D

I

M
H

)
a
t
a
d

I

M
H
(

I
S
P

Original Map

Processed Map

Figure 4. Surface Br maps (original map on left, processed map at default 360×180 resolution on right)
used for data source comparison. Original maps (GH), (GJ), and (HD) are shown after shifting their φ
axis into Carrington coordinates. Other details of the map sources are given in the text.

10

c
i
t
p
o
n
y
S
G
N
O
G

y
l
r
u
o
H
G
N
O
G

s
i
n
a
J
G
N
O
G

c
i
t
p
o
n
y
S

I

M
H

y
l
i
a
D

I

M
H

)
a
t
a
d

I

M
H
(

I
S
P

Figure 5. Open ﬁeld maps from PF solutions for various input maps. Details of the map sources are given
in the text.

11

c
i
t
p
o
n
y
S
G
N
O
G
y
l
r
u
o
H
G
N
O
G

s
i
n
a
J
G
N
O
G

c
i
t
p
o
n
y
S

I

M
H

y
l
i
a
D

I

M
H

)
a
t
a
d

I

M
H
(

I
S
P

Q at r = R(cid:12)

Q at r = rss

Figure 6. Squashing factor from PF solutions for various input maps. The squashing factor at the solar
surface (left) and at the rss outer radial boundary (right) are shown. Details of the map sources are given
in the text.

(SS2.5) Source-surface with rss = 2.5R(cid:12)

In Fig 8 we show the open ﬁeld regions and the squashing factor at the upper radial boundary from
the PF solution for each boundary condition option (excluding closed-wall, as it results in no open
ﬁeld). As expected, the open ﬁeld maps vary signiﬁcantly as the source-surface radius is changed,
with an increase in open ﬁeld area as the source-surface radius is lowered. The Q maps show a
number morphological diﬀerences between them and even altered topology at some locations. For

12

Figure 7. Diagnostics (described in Sec. 4) of potential ﬁelds varying the input surface magnetic map.
Descriptions of the map sources for each label is given in the text.

(cid:12)
R
5
.
1
=

s
s
r

(cid:12)
R
0
.
2
=

s
s
r

(cid:12)
R
5
.
2
=

s
s
r

Figure 8. Open ﬁeld maps (left) and outer radial boundary squashing factor (right) from PF solutions for
various source-surface radii.

(GS)(GH)(GJ)(HS)(HD)(PSI)012345Open Field Area (1021cm2)3.153.023.552.893.002.64GONGHMI(GS)(GH)(GJ)(HS)(HD)(PSI)0.00.20.40.60.81.0Extrapolated IMF@1AU (nT)0.670.680.690.720.730.68GONGHMI(GS)(GH)(GJ)(HS)(HD)(PSI)051015202530Magnetic E ergy (Total) (1032 erg)12.4411.8812.6417.1716.4018.37GONGHMIExtrapolated (rss⇒()(GS)(GH)(GJ)(HS)(HD)(PSI)012345Magnetic Energy (AR) (1032 erg)1.701.121.623.172.293.38GONGHMIexample, at the lowest radius tested, opposite-polarity islands appear within uni-polar regions that
are missing for the higher radii cases (i.e. new open ﬁeld regions, new topological linkages).

In Fig 9, we show the squashing factor at the lower radial boundary for each upper-boundary
condition option. Here we see that all maps that use a source-surface radial boundary exhibit similar

13

(cid:12)
R
5
.
2
=

1
r

)

W
C
(

(cid:12)
R
5
.
1
=

s
s
r

)
S
S
(

(cid:12)
R
0
.
2
=

s
s
r

)
S
S
(

(cid:12)
R
5
.
2
=

s
s
r

)
S
S
(

Figure 9. Squashing factor at the solar surface of PF solutions for various upper radial boundary conditions.

features and morphology. This is true even for the closed-wall case, diﬀering substantially only in
places that would otherwise be open in a source-surface calculation.

In Fig 10 we show the derived quantities described in Sec. 4. We see an expected increase in open
ﬁeld area and open ﬂux as the source-surface radius is lowered. Both the global magnetic energy and
AR energy is very similar across all cases. This is perhaps not surprising but worth noting, as these
numbers are strongly dependent on the inner boundary (Secs. 5 & 7) but not on the outer boundary
condition, even for the closed wall case. Related to this, we also ﬁnd that the extrapolated magnetic

14

Figure 10. Diagnostics of potential ﬁelds (described in Sec. 4) varying the upper radial boundary condition.
Details of each boundary condition label is given in the text.

energy outside of the source-surface radius is very small compared to that within the domain (red
bars, bottom left). Even with a low source-surface of rss = 1.5R(cid:12), it accounts for only 6.5% of the
total energy. For higher rss, this rapidly decreases to less than 0.5%.

7. VARIATIONS IN RESOLUTION

Here we investigate how the PF solutions change based on the resolution of the magnetogram
and the corresponding 3D domain. Using our HMI-derived custom magnetogram (map (PSI) in
Sec. 5), we compute PF solutions at increasing map resolutions up the native (full) resolution of a
HMI synoptic map (3600 × 1440 in longitude/sin-latitude). As mentioned in Sec. 4, for each map
resolution, we set the number of radial grid points to be Nr = Nφ/6.67. The map resolutions we
chose are listed below, showing the resolution of each dimension (Nφ × Nθ × (Nr)) and the resulting
total number of grid cells.

• (TNY) Tiny: 180 × 90 × (27) ≈ 0.4 million cells (uniform in θ, φ)

• (SML) Small: 360 × 180 × (54) ≈ 3.5 million cells (uniform in θ, φ)

• (MED) Medium: 900 × 450 × (135) ≈ 54.7 million cells (uniform in θ, φ)

• (LRG) Large: 1800 × 900 × (207) ≈ 335.3 million cells (uniform in θ, φ)

(CW2.5)(SS1.5)(SS2.0)(SS2.5)02468Open Field Area (1021cm2)0.008.074.142.64(CW2.5)(SS1.5)(SS2.0)(SS2.5)0.00.51.01.52.0Extrapolated IMF@1AU (nT)0.001.871.040.68(CW2.5)(SS1.5)(SS2.0)(SS2.5)051015202530Magnetic Energy (Total) (1032 erg)18.3418.8918.2618.37Com uted Domain (r<rss)Extra olated (rss⇒∞)(CW2.5)(SS1.5)(SS2.0)(SS2.5)012345Magnetic Energy (AR) (1032 erg)3.383.273.313.3815

• (NAT) Native: 3973 × 2012 ×(827) ≈ 6.6 billion cells

(non-uniform in θ, φ ranging from the native resolution of SHARP to that of HMI Synoptic)

• (PSI) 1095 × 742 ×(216) ≈ 175.5 million cells

(non-uniform in θ, φ ranging from the native resolution of SHARP to that of (SML))

As shown, maps (TNY) through (LRG) use a uniform resolution in co-latitude (θ) and longitude
(φ). Resolution (NAT) is non-uniform in θ and φ in order to achieve high resolution equivalent to
the native (full) resolution of the HMI SHARP data product near the AR (∆φ = 5.6×10−4). We then
coarsen the grid to the native HMI synoptic map resolution outside the AR. Our mesh in (PSI) is
very non-uniform in order to achieve the same high resolution near the AR, but coarsen dramatically
outside the AR to the level of the (SML) map. This is useful for high-resolution studies of a small
region, while maintaining a global solution around it, eliminating the needs for ad-hoc or complicated
boundary conditions in a localized ‘box’ domain. A depiction of the non-uniformity of the grid is
shown in Fig. 11.

Figure 11. Depiction of the non-uniformity of the grid for map resolution (PSI). Top row, left to right:
∆r, ∆θ, ∆φ. Bottom row: dv = r2 sin(θ) ∆r ∆θ ∆φ in the θ–φ plane at r = R(cid:12) (left) and the r–φ plane at
θ = π/2 (right).

In Fig 12 we show the processed (PSI) magnetic ﬁeld map for each resolution along with a zoomed-
in view of the AR. The AR goes from being overly smooth and featureless at (TNY) resolution, to
having a large amount of structure at higher resolutions. The highly non-uniform resolution map
(PSI) retains the high-ﬁdelity structure the AR even though it is quite coarse in the rest of the
domain.

In Fig 13 we show the squashing factor at the solar surface for each PF solution. Once again, in
order to obtain high-resolution structure in the AR, one must use a high resolution map. Also, even
though Q can be non-local (it is based on mappings), the Q values in the AR for the non-uniform

1.001.251.501.752.002.252.50r (R⊙⊙012Δr (105 Δm⊙0π/4π/23π/4πColatitude (θ)0.000.010.020.03Δθ0π/2π3π/22πϕ0.000.010.02Δϕ16

)
0
9
×
0
8
1
(

Y
N
T

)
0
8
1
×
0
6
3
(
L
M
S

)
0
5
4
×
0
0
9
(

D
E
M

)
0
0
9
×
0
0
8
1
(

G
R
L

)
2
1
0
2
×
3
7
9
3
(

T
A
N

)
2
4
7
×
5
9
0
1
(

I
S
P

Figure 12. Processed surface Br maps used for each resolution test. Both the full map (left) and a zoomed
view near the AR (right) are shown. The φ × θ resolution is indicated. Additional details of each resolution
are given in the text.

17

)
0
9
×
0
8
1
(

Y
N
T

)
0
8
1
×
0
6
3
(
L
M
S

)
0
5
4
×
0
0
9
(

D
E
M

)
0
0
9
×
0
0
8
1
(

G
R
L

)
2
1
0
2
×
3
7
9
3
(

T
A
N

)
2
4
7
×
5
9
0
1
(

I
S
P

Figure 13. Squashing factor from PF solutions for various resolutions. Left: Full Q-map at the solar
surface, Right: Zoomed Q-map near the AR. The φ × θ resolution is indicated. Additional details of each
resolution are given in the text.

18

resolution (PSI) are nearly identical to the native resolution (NAT). This is perhaps not surprising
because the mapping still involves high-resolution ﬁeld on one side and will largely be localized to
the AR. On the other hand it conﬁrms that multi-scale resolution calculations can reproduce such
structure in a given region of interest.

In Fig 14 we show the open ﬁeld areas along with the squashing factor at the outer radial boundary.
We see that the higher resolution open ﬁeld maps contain many small-scale parasitic polarities within
the open ﬁeld regions. This creates sort of a ‘Swiss cheese’ eﬀect where each low-lying closed-ﬁeld
dome leaves a hole in the open ﬁeld map with the bounding footprint of the closed-open separatrix.
This implies that open ﬂux-regions should not necessarily be considered monolithic entities with a
smooth mapping in their interior. Since empirical solar wind models rely on the distance to the open
ﬁeld boundary (Riley et al. 2001; Arge et al. 2003; Riley et al. 2015), this might be an important
consideration or potential pitfall as models naturally move towards higher resolution.

In Fig 15 we show the derived quantities described in Sec. 4. Here we see that due to the increased
detail in the open ﬁeld areas, the total open ﬁeld area reduces as the resolution increases. However,
the total open ﬂux remains nearly constant at all resolutions (even with the very coarse (TNY)
resolution). This is a key result as it demonstrates that one can rely on lower resolution magne-
togram/PF solutions when calculating open ﬂux. We also see that the magnetic energy (both global
and near the AR) increases as the resolution increases. This is not surprising but emphasizes that
absolute values of energy depend strongly on map/model resolution.

We check the convergence of the magnetic energy near the AR as we approach HMI SHARP
resolution by plotting the energy versus the ∆φ−1 used in each resolution in Fig. 16. We see that
the magnetic energy of the AR is still increasing at the highest resolution available, but does seem to
be saturating. This trend makes sense on an intuitive level considering the perspective of spherical
harmonics: the higher-order scales not currently present in the highest-resolution HMI data will
decay more quickly in height. In this way the integrated energy should eventually asymptote, even
if higher resolution structure is present.

We also ﬁnd that the non-uniform resolution case (PSI) yields the same magnetic energy for the
AR as the native resolution case (NAT). Given that case (PSI) is nearly forty times smaller, the
computation is considerably faster than (NAT) (see Appendix B). This demonstrates how useful non-
uniform grid capabilities are when studying ARs at high-resolution within global coronal domains.

The PF solution for resolution (NAT) is still quite interesting though. This calculation is likely
the largest resolution PF ever computed for the solar corona, and it is worth examining the inherent
complexity present in such a high-resolution, high-ﬁdelity calculation. In Fig 17 we show a composite
map of several quantities. The squashing factor is shown in a signed-log color scale (+ in green, −
in purple) while the magnetic ﬁeld is overlaid as proportionally scaled, semi-transparent orange (+)
and cyan (−) colors. The signed open ﬁeld is also indicated in semi-transparent red (+) and blue
(−) overlays. The combined image illustrates how all areas of the surface map exhibit extreme
amounts of complexity. This is particularly true where the magnetic ﬁeld is weak, and the random
network ﬂux dominates. Here myriad topological boundaries are formed by each fragmented, small-
scale ﬂux system. This inherent complexity of the magnetic ﬁeld mapping may also have important
consequences for coronal heating and plasma structuring, as is explored in a related paper (Downs

19

)
0
9
×
0
8
1
(

Y
N
T

)
0
8
1
×
0
6
3
(
L
M
S

)
0
5
4
×
0
0
9
(

D
E
M

)
0
0
9
×
0
0
8
1
(

G
R
L
)
2
1
0
2
×
3
7
9
3
(

T
A
N
)
2
4
7
×
5
9
0
1
(

I
S
P

Figure 14. Left: Open ﬁeld maps from PF solutions for various resolutions. Right: Squashing factor at
the rss outer radial boundary. The φ × θ resolution is indicated. Additional details of each resolution are
given in the text.

et al. 2021). To convey the extent of structural detail present, we provide the full resolution image
(16000 × 8000) online7.

8. DISCUSSION

7 http://www.predsci.com/papers/pot3d

20

Figure 15. Diagnostics of potential ﬁelds (described in Sec. 4) varying the resolution of the input map and
resulting potential ﬁeld. A description of each resolution label is given in the text.

We have computed potential ﬁeld solutions for 2012 June 13, varying the source and type of
In doing so, we
input magnetic data, the outer radial boundary condition, and the resolution.
took advantage of the high-performance, ﬂexible grid, multi-platform (GPUs and CPUs) aspects of
POT3D and our magnetogram preparation pipeline to explore PFs in ways that were not previously
possible, including at extreme resolution (6.6 billion points). For each solution, we looked at maps
of the open ﬁeld, squashing factor, magnetic energies, open ﬁeld area, and open interplanetary ﬂux.
We found that variations in the source magnetogram had only a minor eﬀect on the total open ﬂux,
with a more noticeable, but small eﬀect on the magnetic energy and ﬁeld topology, especially near
the AR of interest. On the other hand, changing the outer radial boundary condition and source
surface height had nearly no eﬀect on the magnetic energy (both global and near the AR), but a very
large eﬀect on the open ﬂux and open ﬁeld structure. The lower the source-surface radius, the larger
the open ﬁeld area and open ﬂux. Since the source-surface radius is a free parameter in PF models,
its large eﬀect on both the open ﬂux and open ﬁeld suggests the need to ﬁnd independent sources
of validation (such as correlating in-situ magnetic ﬁeld comparisons with comparisons between open
ﬁeld and coronal hole structure).

Varying the resolution of the PF solutions from very coarse to very ﬁne was quite illuminating. Our
experiments show how model resolution has essentially no eﬀect on the open ﬂux. This is because the
unsigned ﬂux might change considerably with resolution, but the net ﬂux in a given region does not.

(TNY)(SML)(MED)(LRG)(NAT)(PSI)01234Open Field Area (1021cm2)3.392.641.881.371.052.64(TNY)(SML)(MED)(LRG)(NAT)(PSI)0.00.20.40.60.81.0Extrapolated IMF@1AU (nT)0.670.680.680.680.680.68(TNY)(SML)(MED)(LRG)(NAT)(PSI)01020304050Magnetic Energy (Total) (1032 erg)8.4918.3733.3641.7247.5734.99Extrapolated (rss)∞)(TNY)(SML)(MED)(LRG)(NAT)(PSI)0.02.55.07.510.012.515.0Magnetic Energy (AR) (1032 erg)0.743.388.6411.4313.5213.5221

Figure 16. Magnetic energy near the AR for multiple resolutions plotted as a function of 1/∆φ. The
highest resolution is that of the HMI SHARP data product.

However the open ﬁeld area decreased signiﬁcantly as resolution increased. Here the same net-ﬂux is
captured over ever-smaller ﬂux concentrations (stronger ﬁelds) at high resolution, emphasizing that
ﬂux, not area, is an essential quantity when studying coronal holes. Most importantly our results
conﬁrm that modest resolution potential ﬁelds can do a ﬁne job of capturing the overall open ﬂux
and morphology, provided that the data is smoothed and averaged properly.

The resolution experiments and Q maps also illustrate how magnetic complexity changes as function
of resolution. By capturing more detail at the surface, the complexity of the surface mapping shows
new information at commensurate scales. This may be crucially important when studying active
regions or coronal heating within a global model, where the solution properties (energies, mapping,
unsigned ﬂux) are inherently connected to both the smoothing of the input data and model resolution.
This complexity is also increasing and present in all regions of the coronal base, particularly in the
weak-ﬁeld quiet-sun and open ﬂux regions.

These experiments have also served to show the value the feature set of the POT3D code is for high-
resolution, high-performance PF calculations. For example, the use of a non-uniform grid allows us
to capture an AR of interest at the highest resolution of the data source within a global model, while
keeping the total problem size reasonable. In this case, the grid size was nearly forty times smaller
than a comparable calculation with uniform resolution, enabling a fast-computation with nearly
identical results within the AR. Additionally, the scalability of the code allows extreme resolution
PFs to be computed quickly using large HPC systems. An earlier version of POT3D is presently
available for runs on demand as part of the WSA model in CORHEL hosted at the Community
Coordinated Modeling Center8. The version used in this paper is currently released as part the

8 https://ccmc.gsfc.nasa.gov

255010020040080016001/Δϕ0.5124816MagneticΔEnergyΔ(AR)Δ(1032Δerg)22

Figure 17. Composite image of Br, the squashing factor, and the open ﬁeld regions from the PF solution
using the very high resolution (NAT). The squashing factor is shown in a signed-log color scale (green and
purple), while the magnetic ﬁeld is colored by orange and cyan. The signed open ﬁeld is also indicated using
a blue-red color table.

23

Standard Performance Evaluation Corporation’s beta version of the SPEChpcTM 2021 benchmark
suites9, and, with the publication of this paper, as an open-source release on GitHub10.

Overall, the experiments in this work emphasize how much can still be learned from PF calcula-
tions, particularly now that high resolution, high-quality data is routinely available. They also show
that caution should be taken when deriving conclusions using PF solutions; that the resolution is
appropriate, the boundary conditions are validated, and solution variations between magnetic ﬁeld
input sources is considered.

All of the processed maps and POT3D input ﬁles used to generate the results in this paper are

available at http://www.predsci.com/papers/pot3d.

ACKNOWLEDGMENTS

This work was supported by the NASA Heliophysics Guest Investigator program (grants
NNX17AB78G and 80NSSC19K0273), AFOSR (contract # FA9550-15-C-0001),
the NSF
PREEVENTS program (grant ICER1854790)), the NSF/NASA SWQU program (grants AGS
2028154, NNX12AB30G), and the NASA HSR program (grant 80NSSC18K0101). Computational
resources were provided by NASA’s NAS (Pleiades) and NSF’s XSEDE (TACC & SDSC). We also
wish to thank the organizers (KD Leka, Graham Barnes, and James McAteer), and participants of a
2019 SHINE session dedicated to PF modeling for stimulating discussion and prompts that helped
precipitate some of this work.

APPENDIX

A. ADDITIONAL MODEL CAPABILITIES OF POT3D

This paper has focused on source surface potential ﬁelds (PFSS). Here we brieﬂy detail additional

uses of the POT3D code, namely the PFCS and Open Field (OF) models.

The PFCS model is used to extend a PFSS model farther out into the corona (typically to 20-30 R(cid:12))
while reproducing the latitudinally independent behavior of the radial magnetic ﬁeld magnitude
observed by Ulysses. To do this, the magnitude of the outer (source-surface) boundary magnetic
ﬁeld of a PFSS solution (|Br(r = rss)|) is used as the lower boundary condition of the potential ﬁeld
solver, with a source-surface outer boundary condition (see Sec. 2.1). The resulting ﬁeld is unsigned.
To obtain a signed ﬁeld, we can post-process the ﬁeld through tracing ﬁeld lines from each point in
the domain to the lower boundary, and setting the sign at that point according to the sign of Br
where the ﬁeld line mapped to.

It is well known that the combination of the PFSS ﬁeld and PFCS ﬁeld is discontinuous at the
source-surface boundary (e.g., McGregor et al. 2008). This occurs because the PFSS ﬁeld is forced to
be radial at the source-surface (upper boundary of the PFSS), while in general the resulting solution
for the PFCS will have small non-radial components at its lower boundary. McGregor et al. (2008)
describe a procedure for reducing the magnitude of this discontinuity by using the radial ﬁeld from

9 https://www.spec.org/hpc2021
10 https://github.com/predsci/POT3D

24

the PFSS at a slightly lower height than the source surface for the PFCS boundary condition. While
this is not an explicit option in POT3D, it is easily implementable.

The Open Field (OF) for a given boundary magnetic ﬂux distribution is the ﬁeld where all the
ﬁeld lines are open, connected to the solar surface, and stretch to inﬁnity (Barnes & Sturrock 1972).
It has important theoretical signiﬁcance, as the Aly-Sturrock “theorem” (Aly 1984, 1991; Sturrock
1991) identiﬁes the OF as the upper energy bound for simply connected force-free magnetic ﬁelds.
While a rigorous proof of the theorem has not been shown, the results are consistent with a number
of simulation studies (e.g., Miki´c & Linker 1994; Amari et al. 1996; Antiochos et al. 1999; Amari
et al. 2000; Linker et al. 2003; Hu 2004). The OF model is computed using the same procedure as
the PFCS model, but with the lower boundary at the photosphere, using the observational radial
magnetic ﬁeld boundary conditions (Br(r = R(cid:12)) ← |Br(r = R(cid:12))|). The resulting solution yields a
fully open unsigned ﬁeld which can be signed through ﬁeld tracing as in the PFCS case.

B. COMPUTATIONAL PERFORMANCE OF POT3D

A key advantage of using PF models is that they are computationally eﬃcient compared to MHD
models. However, in this work, we have computed very large PF solutions up to 6.6 billion points.
At this size, such calculations can still be quite computationally expensive, especially when using
script-based or non-optimal solvers. POT3D is designed to be a high-performance PF solver. Here we
show its performance on the high-resolution PF solutions from Sec. 7 and highlight the computational
advantage of its ability to use non-uniform grids. For solutions computed on CPUs, we use the dual-
socket Xeon Platinum 8160 CPU nodes (48 cores per node) on the Stampede 2 system at TACC. For
solutions computed on GPUs, we use the GPU nodes of the NASA NAS HECC Pleiades machine
which contain 4 NVIDIA V100 GPUs per node.

In Fig. 18, we show wall clock times for computing PF solutions for the resolutions described in
Sec. 7 on a single CPU or GPU compute node/server (except for (NAT) as it does not ﬁt into the
memory of a single node). We see that resolutions (TNY) and (SML) compute very quickly and

Figure 18. Single-server timing results for PF solutions using POT3D for the resolutions described in
Sec. 7. The total number of grid cells for each resolution is indicated.

are too small for the GPU to exhibit speedup. For resolution (MED) through (PSI), we see that

(TNY)0.4×106(SML)3.5×106(MED)54.7×106(LRG)335.3×106(PSI)175.5×106020040060080010001200Wall Clock Time (seconds)4.56.348.8577.1381.90.22.5102.31102.1785.6GPU (PC1): 4xV100CPU (PC2): 2x24-core Platinum 816025

the GPU computes the PF about twice as fast as the CPU. This speedup (while very beneﬁcial)
may appear lower than expected considering the hardware capabilities of the GPUs versus the CPU.
However, this is because when running on the CPU, POT3D can use the much more eﬃcient PC2
preconditioner described in Sec. 2.1, while when running on GPUs, it can only currently utilize the
less eﬃcient PC1 algorithm (see Caplan et al. (2017) for details). Running POT3D on GPUs still
has a great advantage in this case since one can conﬁgure a relatively inexpensive workstation with
multiple GPUs, allowing for fast ‘in-house’ PF computations.

For the largest resolution PF (resolution (NAT), yielding 6.6 billion points), we used 120 CPU
nodes (5760 total CPU cores), yielding a solution time of 14.5 minutes (including all setup and
I/O). The non-uniform resolution (PSI) has the same resolution as (NAT) near the active region
of interest, but coarsens greatly outside the region, resulting in a resolution ∼ 40 times smaller (175
million cells). Running this on the same number of CPUs ﬁnds the solution in only 18 seconds (50x
faster). These results demonstrate both the large scalability of POT3D, as well as the advantage of
its ability to use non-uniform grids in cases where a localized region needs to be highly resolved.

C. ESTIMATION OF MAGNETIC ENERGY OUTSIDE OF THE SOURCE-SURFACE RADIUS

To estimate the magnetic energy outside of a source-surface potential ﬁeld model, we assume that
the radial magnetic ﬁeld falls oﬀ as 1/r2. This reﬂects the fact that from the source surface to
the inner heliosphere (∼ 30 R(cid:12)) the variations in Br relax away from the HCS, with Br becoming
essentially independent of latitude the farther out one goes. We can bound the excess energy then by
integrating the surface ﬁeld at the outer boundary to inﬁnity, ﬁrst by keeping the spatial dependence
of Br(rss, θ, φ) and second by integrating the mean ﬂux only (|Br(rss)|). The former is an upper
bound on the open ﬁeld energy (from r = rss to inﬁnity) while the latter is a lower bound.

The magnetic energy (in CGS units) from r = rss to r = r1 is deﬁned as

W r1

rss =

1
8 π

(cid:90) 2 π

(cid:90) π

(cid:90) r1

|B|2 r2 sin θ dr dθ dφ.

(C1)

rss
Assuming a purely radial ﬁeld at the source-surface boundary (Br(rss)) with a 1/r2 fall-oﬀ of the
ﬁeld strength, we have

0

0

Inserting this into Eq. C1 and letting r1 → ∞ yields

Br(r, θ, φ) = Br(rss, θ, φ)

r2
ss
r2 .

W ∞

rss ≈

r3
ss
8 π

(cid:90) 2 π

(cid:90) π

0

0

|Br(rss, θ, φ)|2 sin θ dθ dφ.

(C2)

For the upper bound estimate, we use Br(rss, θ, φ) directly from the model. For the lower bound
estimate, we use |Br(rss)| in place of Br(rss, θ, φ), where

|Br(rss)| =

1
4 π r2
ss

(cid:90) 2 π

(cid:90) π

0

0

|Br(rss, θ, φ)| r2

ss sin θ dθ dφ,

which simpliﬁes Eq. C2 to

W ∞

rss ≈

r3
ss
2

2
|Br(rss)|

.

REFERENCES

(C3)

Altschuler, M. D., & Newkirk, G. 1969, SoPh, 9,

Aly, J. J. 1984, ApJ, 283, 349, doi: 10.1086/162313

131

26

—. 1991, ApJL, 375, L61, doi: 10.1086/186088
Amari, T., Luciani, J. F., Aly, J. J., & Tagger, M.

1996, ApJL, 466, L39, doi: 10.1086/310158
Amari, T., Luciani, J. F., Mikic, Z., & Linker, J.
2000, ApJL, 529, L49, doi: 10.1086/312444

Antiochos, S. K., DeVore, C. R., Karpen, J. T., &

Miki´c, Z. 2007, ApJ, 671, 936,
doi: 10.1086/522489

Antiochos, S. K., DeVore, C. R., & Klimchuk,

J. A. 1999, ApJ, 510, 485, doi: 10.1086/306563

Arge, C. N., Luhmann, J. G., Odstrcil, D.,

Schrijver, C. J., & Li, Y. 2004, Journal of
Atmospheric and Solar-Terrestrial Physics, 66,
1295, doi: 10.1016/j.jastp.2004.03.018

Arge, C. N., Odstrcil, D., Pizzo, V. J., & Mayer,
L. R. 2003, in American Institute of Physics
Conference Series, Vol. 679, Solar Wind Ten,
ed. M. Velli, R. Bruno, F. Malara, & B. Bucci,
190–193, doi: 10.1063/1.1618574

Barnes, C. W., & Sturrock, P. A. 1972, ApJ, 174,

659, doi: 10.1086/151527

Bell, N., & Garland, M. 2008, Eﬃcient sparse

matrix-vector multiplication on CUDA, Tech.
rep., Nvidia Technical Report NVR-2008-004,
Nvidia Corporation

Bobra, M. G., Sun, X., Hoeksema, J. T., et al.

2014, Solar Physics, 289, 3549

Caplan, R. M., Downs, C., & Linker, J. A. 2016,

ApJ, 823, 53, doi: 10.3847/0004-637X/823/1/53

Caplan, R. M., Miki´c, Z., & Linker, J. A. 2017,

ArXiv e-prints.
https://arxiv.org/abs/1709.01126

Chandrasekaran, S., & Juckeland, G. 2017,

OpenACC for Programmers Concepts and
Strategies (Addison-Wesley Professional)

Chow, E., & Saad, Y. 1997, Journal of

Computational and Applied Mathematics, 86,
387

Downs, C., Linker, J. A., M., C. R., & Titov,

V. S. 2021, in prep for ApJL

Freeland, S., & Handy, B. 1998, Solar Physics,

182, 497

Harvey, J., Hill, F., Hubbard, R., et al. 1996,

Science, 272, 1284

Hayashi, K., Yang, S., & Deng, Y. 2016, Journal of
Geophysical Research: Space Physics, 121, 1046
Hoeksema, J. T., Wilcox, J. M., & Scherrer, P. H.

1983, J. Geophys. Res., 88, 9910,
doi: 10.1029/JA088iA12p09910

Hu, Y. Q. 2004, ApJ, 607, 1032,

doi: 10.1086/383517

Linker, J., Caplan, R., Downs, C., et al. 2017, The

Astrophysical Journal, 848, 70

Linker, J. A., Miki´c, Z., Lionello, R., et al. 2003,

Phys. of Plasmas, 10, 1971

Linker, J. A., Miki´c, Z., Biesecker, D. A., et al.
1999, Journal of Geophysical Research: Space
Physics, 104, 9809

Linker, J. A., Caplan, R. M., Downs, C., et al.

2016, in Journal of Physics: Conference Series,
Vol. 719, IOP Publishing, 12012–12023

McGregor, S. L., Hughes, W. J., Arge, C. N., &
Owens, M. J. 2008, Journal of Geophysical
Research (Space Physics), 113, A08112,
doi: 10.1029/2007JA012330

Miki´c, Z., & Linker, J. A. 1994, Ap. J., 430, 898
Miki´c, Z., Downs, C., Linker, J. A., et al. 2018,

Nature Astronomy, 2, 913,
doi: 10.1038/s41550-018-0562-5

Nitta, N. V., Reames, D. V., De Rosa, M. L.,

et al. 2006, ApJ, 650, 438, doi: 10.1086/507442
Pizzo, V., Millward, G., Parsons, A., et al. 2011,

Space Weather, 9, 3004,
doi: 10.1029/2011SW000663

Riley, P., Linker, J. A., & Arge, C. N. 2015, Space
Weather, 13, 154, doi: 10.1002/2014SW001144

Riley, P., Linker, J. A., & Miki´c, Z. 2001, J.

Geophys. Res., 106, 15889

Riley, P., Ben-Nun, M., Linker, J. A., et al. 2014,
SoPh, 289, 769, doi: 10.1007/s11207-013-0353-1
Saad, Y. 2003, Iterative methods for sparse linear

systems (Siam)

Schatten, K. H. 1971, Cosmic Electrodynamics, 2,

232

Schatten, K. H., Wilcox, J. M., & Ness, N. F.

1969, SoPh, 6, 442

Scherrer, P. H., Schou, J., Bush, R., et al. 2012,

Solar Physics, 275, 207

Schrijver, C. J., & DeRosa, M. L. 2003, Solar

Physics, 212, 165

Schrijver, C. J., Sandman, A. W., Aschwanden,
M. J., & De Rosa, M. L. 2004, ApJ, 615, 512,
doi: 10.1086/424028

Smith, B., & Zhang, H. 2011, International
Journal of High Performance Computing
Applications, 25, 386

Smith, E. J., & Balogh, A. 1995, Geophysical

research letters, 22, 3317

—. 2008, Geophysical research letters, 35

27

Stansby, D., Yeates, A., & Badman, S. 2020,

Veldman, A., & Rinzema, K. 1992, Journal of

Journal of Open Source Software, 5

Sturrock, P. A. 1991, ApJ, 380, 655,

doi: 10.1086/170620

Sun, X. 2018, arXiv preprint arXiv:1801.04265
Titov, V., Mikic, Z., T¨or¨ok, T., Linker, J., &

Panasenco, O. 2012, The Astrophysical Journal,
759, 70

Titov, V. S. 2007, The Astrophysical Journal, 660,

863

Titov, V. S., Miki´c, Z., Linker, J. A., Lionello, R.,

& Antiochos, S. K. 2011, ApJ, 731, 111,
doi: 10.1088/0004-637X/731/2/111

T´oth, G., Van der Holst, B., & Huang, Z. 2011,

The Astrophysical Journal, 732, 102

engineering mathematics, 26, 119

Wang, Y.-M., Hawley, S. H., & Sheeley, Neil R.,

J. 1996, Science, 271, 464,
doi: 10.1126/science.271.5248.464

Wang, Y. M., & Sheeley, N. R., J. 1990, ApJ, 355,

726, doi: 10.1086/168805

—. 1994, J. Geophys. Res., 99, 6597,

doi: 10.1029/93JA02105

—. 2004, ApJ, 612, 1196, doi: 10.1086/422711
Wang, Y.-M., & Sheeley, Jr., N. R. 1992, ApJ,

392, 310, doi: 10.1086/171430

