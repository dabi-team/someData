8
1
0
2

r
a

M
6
1

]
E
M

.
t
a
t
s
[

1
v
3
8
3
6
0
.
3
0
8
1
:
v
i
X
r
a

A prediction criterion for working correlation structure selection in
GEE

Gul Inana, Mahbub A.H.M. Latifb and John Preisserc
a Middle East Technical University, Ankara, Turkey; bInstitute of Statistical Research and
Training, University of Dhaka, Dhaka, Bangladesh; cDepartment of Biostatistics, University
of North Carolina, Chapel Hill, U.S.A.

ARTICLE HISTORY

Compiled March 20, 2018

ABSTRACT
Generalized estimating equations (GEE) is one of the most commonly used meth-
ods for marginal regression analysis of longitudinal data, especially with discrete
outcomes. The GEE method models the association among the responses of a sub-
ject through a working correlation matrix and correct speciﬁcation of the working
correlation structure ensures eﬃcient estimation of the regression parameters. This
study proposes a predicted residual sum of squares (PRESS) statistic as a working
correlation selection criterion in GEE. An extensive simulation study is designed to
assess the performance of the proposed GEE PRESS criterion and to compare its
performance with well-known existing criteria in the literature. The results show
that the GEE PRESS criterion has better performance than the weighted error sum
of squares SC criterion in all cases and is comparable with that of other existing cri-
teria when the true working correlation structure is AR(1) or exchangeable. Lastly,
the working correlation selection criteria are illustrated with the Coronary Artery
Risk Development in Young Adults study.

KEYWORDS
Correlation structure; Deletion diagnostics; Longitudinal discrete responses; Press
statistic; Unbalanced longitudinal data; Unequally spaced longitudinal data;
Unstructured working correlation

1. Introduction

Longitudinal studies arise from repeated measurements on a given response for the
same subjects over time. Longitudinal studies are conducted in diﬀerent ﬁelds such
as clinical trials, epidemiology, behavioural sciences, econometrics and so on. General-
ized estimating equations (GEE) [12] is one of the most commonly used methods for
marginal analysis of longitudinal data, especially with discrete responses. In particu-
lar, GEE, which does not require speciﬁcation of a joint distribution for the repeated
measurements of a subject, estimates a generalized linear model for the marginal mean
of each measurement of the subject. The method of GEE further models the correla-
tion within the repeated measurements of the response of a subject through a working
correlation matrix, such as ﬁrst-order autoregressive (AR(1)), exchangeable (Exch),
and unstructured (UN) correlation matrices.

CONTACT Gul Inan. Email: ginan@metu.edu.tr

 
 
 
 
 
 
Irrespective of whether or not the working correlation structure type is correctly
speciﬁed, the GEE approach produces consistent estimates for regression parameters,
with a correctly speciﬁed marginal mean model [12]. However, correct speciﬁcation
of the working correlation structure ensures eﬃcient estimation of the regression pa-
rameters within the class of linear unbiased estimating equations. For this reason,
developing methods for working correlation structure selection in GEE analysis, con-
ditional on the correctly speciﬁed marginal mean model, has been an active area of
research and, in turn, several criteria for working correlation structure selection in
GEE analysis have been proposed.

Pan [14] proposed the quasi-likelihood information criterion (QIC), an extension of
the most commonly used model selection criterion for classical linear regression, the
Akaike’s information criterion. Hin and Wang [7] modiﬁed QIC to propose the cor-
relation information criterion (CIC) and found that it improves correlation structure
selection relative to the QIC. QIC and CIC contrast the empirical covariance matrix
for the regression parameters to the model-based covariance matrix that assumes in-
dependence. Rotnitzky and Jewell [21] introduced the criterion labeled RJ and Gosho
et al. [5] found that neither RJ criterion or QIC is superior to the other. Shults and
Chaganty [22] proposed a criterion named SC for working correlation structure selec-
tion that minimizes the weighted residual sum of squares of the response vector. Shults
et al. [23] found that RJ criterion performed better than SC criterion in selecting the
correlation structure in analyzing correlated binary responses. Gosho et al. [5] pro-
posed a criterion that is a function that contrasts the unweighted sum of squares, or
empirical covariance matrix of the response vector, with the model-based covariance
of the responses. In their simulation study, their criterion was compared with CIC,
QIC, RJ, and SC criteria and none was found best for all cases considered.

The aim of this study is twofold. First, we propose a predicted residual sum of
squares (PRESS) statistic for selection of working correlation structure in GEE anal-
ysis, where the particular form of the proposed PRESS criterion is similar to the SC
criterion, with a diﬀerent weight matrix. Afterwards, we design an extensive simula-
tion study and compare the performance of the proposed PRESS criterion with several
existing criteria such as CIC, QIC, RJ, and SC for balanced and unbalanced longitu-
dinal data with discrete responses (e.g., binary and Poisson outcomes) under several
working correlation structures such as Exch, AR(1), and UN.

The subsequent sections of the paper are organized as follows. In Section 2, GEE
analysis and existing working correlation structure selection criteria are brieﬂy re-
viewed. In Section 3, a PRESS statistic for GEE is introduced and its connections to
prediction error and cluster-deletion diagnostics are presented. Section 4 contains the
simulation study evaluating the performance of the PRESS statistic relative to other
criteria in selecting the working correlation structure for balanced and unbalanced lon-
gitudinal data with discrete responses in marginal regression models estimated with
GEE. Section 5 presents the application of PRESS statistic to analysis of smoking
trends within the Coronary Artery Risk Development in Young Adults (CARDIA)
study. Finally, Section 6 states limitations of the current work, and proposes future
research.

2

2. Overview of GEE and existing working correlation structure selection

criteria in GEE

In this section, we give a brief overview of the GEE method and several commonly
used working correlation structure selection criteria in the literature.

2.1. Overview of GEE

Suppose that there are N subjects (i = 1, . . . , N ) in a longitudinal study and each
subject is observed at times t = 1, . . . , ni. For the ith subject, let yi = (yi1, . . . , yini)′
be the ni-dimensional response vector and Xi be the corresponding covariate matrix
of order ni × p. Let the marginal mean response vector for the ith subject be given
iβ, where β = (β1, . . . , βp)′ is vector of regression
by E(yi|Xi) = µi and g(µi) = X
parameters and g(·) is the link function (e.g., logit and log link functions are used
for binary and Poisson responses, respectively). Assume that the ni × ni-dimensional
working covariance matrix of response vector for the ith subject is deﬁned as:

′

Vi = φA1/2

i RiA1/2

i

,

where φ is a positive-valued scale parameter and is equal to 1 when there is no over-
dispersion in the response, Ai = diag{h(µi1), . . . , h(µini)} is a diagonal matrix, h(·) is
the variance function (e.g., for binary responses h(µit) = µit(1 − µit) and for Poisson
responses h(µit) = µit), and Ri = Ri(α) is the working correlation matrix representing
the association between the repeated measurements of the outcome for a subject, which
is completely speciﬁed by the ﬁnite-dimensional parameter vector α.

The estimate of the regression parameters β can be obtained by solving the gener-

alized estimating equations:

N

Xi=1

D′

iV−1
i

(yi − µi) = 0,

where Di = ∂µi/∂β is a matrix of order ni ×p. Given the method of moment estimates
of α and φ, the iterative Fisher-Scoring (F-S) algorithm for estimating β can be deﬁned
as follows:

βr+1 = βr +

N

(cid:16)

Xi=1

′

D

iV−1

i Di

N

−1

(cid:17)

(cid:16)

Xi=1

D

′

iV−1
i

(yi − µi)
(cid:17)

,

where r is the iteration number. Note that α and φ are estimated through the method
of moments using Pearson residuals repeatedly within the iterative F-S algorithm. For
large N , the estimator ˆβ follows an asymptotic p-variate normal distribution with
mean vector β and covariance matrix:

Cov(ˆβ) = M−1JM−1,

where M =

N
i=1 Mi with Mi = D′

iV−1

i Di and J =

N
i=1 D′

iV−1

i Cov(yi)V−1

i Di. The

P

P

3

sandwich (which is also named as robust or empirical) covariance estimator for ˆβ is
obtained by replacing Cov(yi) by (yi − µi)(yi − µi)

in J such that:

′

Σ = M−1

N

(cid:18)

Xi=1

D′

iV−1

i (yi − µi)(yi − µi)

′

V−1

i Di(cid:19)

M−1.

It is well-known that the consistency and asymptotic normality of ˆβ hold even if Ri
is mis-speciﬁed. However, when Ri is correctly speciﬁed, then Cov(yi) = Vi and Σ
reduces to the model-based (which is also named as naive) covariance estimator M−1.

2.2. Overview of existing GEE working correlation structure selection

criteria

The quasi-likelihood information criterion (QIC) [14] can be deﬁned as follows:

QIC = −2QL(ˆβ, ˆφ) + 2trace( ˆMI ˆΣ),

N
where QL(ˆβ, ˆφ) is the quasi-likelihood function (e.g., it is ˆφ
yi log(ˆµi/(1 − ˆµi) +
i
N
log(1− ˆµi)
yi log(ˆµi)− ˆµi
for binary and Poisson outcomes, respectively)
i
−1
′
(cid:1)
(cid:0)
and ˆMI =
ˆDi. The terms QL(ˆβ, ˆφ), ˆMI , and ˆΣ are evaluated at the
ˆA
ˆD
P
i
i
values of ˆβ, ˆα, and ˆφ under the assumed working correlation matrix.

and ˆφ
N
i=1

P

(cid:1)

(cid:0)

P

The correlation information criterion (CIC) [7], which uses the trace term of QIC

only, can be deﬁned as follows:

CIC = trace( ˆMI ˆΣ),

where ˆMI and ˆΣ are evaluated at the values of ˆβ, ˆα, and ˆφ under the assumed working
correlation matrix.

On the other hand, Rotnitzky and Jewell [21] used the expression Q = ˆM ˆΣ to

deﬁne three criteria for selecting the true correlation structure:

RJ1 = trace(Q)/p
RJ2 = trace(Q2)/p,
DBAR = RJ2-2RJ1+1,

and

where p is the dimension of the regression parameter β. The terms ˆM and ˆΣ correspond
to M and Σ evaluated at the values of ˆβ, ˆα, and ˆφ under the assumed working
correlation matrix.

Finally, the SC criterion [22] can be expressed as follows:

N

SC =

Xi=1

(yi − ˆµi)

′ ˆV

−1
i (yi − ˆµi),

(1)

4

where ˆµi and ˆVi are evaluated at the values of ˆβ, ˆα, and ˆφ under the assumed working
correlation matrix. Working correlation structure selection is based on the premise that
smaller values of QIC, CIC, SC, | RJ1-1 |, | RJ2 − 1 |, and | DBAR | lead to a better
working correlation structure.

3. A PRESS statistic for working correlation selection in GEE

i

P

i e′

A second class of working correlation structure selection criterion in GEE analysis is
iWiei, where ei = yi − µi and Wi
based on the weighted error sum of squares
is a weight matrix. Shults and Chaganty [22] deﬁned Wi = V−1
to propose the SC
criterion in equation 1, hypothesizing that the correct working correlation structure
should minimize the error sums of squares weighted by the inverse of the working
covariance structure. However, the reason for its poor performance relative to other
criteria [23] is because Vi is a biased estimator of Cov(ei); a better estimator is
Cov(ei) ≈ (I − Hi)Vi(I − H′
i), where Hi = DiM−1D′
. The cluster-level leverage
matrix Hi has an important role in GEE inference appearing in formulae for bias-
corrected covariance estimators for ˆβ [13], where (I − Hi)−1eie′
i)−1 replaces
eie′
in Σ. Furthermore, Hi appears in GEE regression diagnostics
that approximate the change in ˆβ due to cluster-deletion [6, 17].

i = (yi−µi)(yi −µi)

i(I − H′

iV−1
i

Using the weight matrix Wi = (I − H′

i (I − Hi)−1, a GEE PRESS
Criterion (GPC) for working correlation structure selection, which approximates

i)−1V−1

′

N
i ˆe′
i{

Cov(ˆei)}−1ˆei, is given as follows:

P

d

GPC =

N

Xi=1

′
i(I − ˆH
i)−1 ˆV
ˆe′

−1
i

(I − ˆHi)−1ˆei,

(2)

where ˆei = (yi − ˆµi), and ˆµi, ˆHi, and ˆVi are evaluated at the values of ˆβ, ˆα, and ˆφ
under the assumed working correlation matrix.

(i){

N
i ˆe′

Appendix A provides further rationale for GPC as a working correlation selec-
Cov(ˆe(i))}−1ˆe(i), where
tion criterion by showing that it also approximates
ˆe(i) = yi − g−1(Xi ˆβ(i)) is the corrected PRESS residual vector corresponding to the
ith cluster with ˆβ(i) being the estimate of β that is estimated without the ith cluster,
i.e. with (N − 1) clusters/subjects. The GPC shares the attractive feature of GEE
cluster-deletion diagnostics DBETA (deﬁned in the appendix) in that they are com-
putationally fast formula not requiring further iteration beyond convergence of the
usual iterative reweighted least squares algorithm [18]. For independent observations
(equivalently, ni = 1 for all i), the identity link (i.e., Li = 1), and constant variance
(i.e., h(µi) = 1), GPC reduces to the PRESS statistic for multiple linear regression

d

P

N
i=1(yi − ˆy(i))2 =

N
i=1 e2

i /(1 − hi)2, where hi = X′

i(X′

iXi)−1Xi.

P

P

4. Simulation study

In this section, we carry out an extensive simulation study to compare performance
of the proposed GPC with several working correlation selection criteria (CIC, DBAR,
QIC, RJ1, RJ2, and SC) in terms of proportion of selecting the true working correlation
structure in longitudinal data under diﬀerent scenarios and we discuss the results of

5

the simulation study.

4.1. Simulation design

Speciﬁcally, we evaluate the criteria in four main simulation scenarios:

S1. Longitudinal binary data with equal number of time points,
S2. Longitudinal binary data with unequal number of time points,
S3. Longitudinal count data with equal number of time points, and
S4. Longitudinal count data with unequal number of time points.

For scenarios 1 and 2, we assume that the response yit, corresponding to the tth
observation of the ith subject, follows a Bernoulli distribution with marginal mean
µit, which depends on the covariates x1 and x2 via a logit link function according to
the following model:

log

µit
1 − µit (cid:19)

(cid:18)

= β0 + β1x1i + β2x2it,

i = 1, . . . , N,

t = 1, . . . , ni,

(3)

where the covariates x1i and x2it are both binary, generated from Bernoulli(0.5). In
deﬁning the mean function, x1 is a subject-speciﬁc covariate, i.e., it takes the same
value for all the observations within a subject, and x2 is a time-speciﬁc covariate, i.e., it
takes diﬀerent values over the observations of a subject. In other words, x1 and x2 can
be considered as time-independent and time-dependent covariates, respectively. True
values of the regression parameters used in the simulation are β0 = 1, β1 = 0.38, and
β2 = 0.35. The true values of the regression coeﬃcients are selected so that proportion
of ones in the response variable is around 50%.

For scenarios 3 and 4, we assume that the response yit, corresponding to the tth
observation of the ith subject, follows a Poisson distribution with marginal mean µit,
which depends on the covariates x1 and x2 via a log link function according to the
following model:

log

µit

= β0 + β1x1i + β2x2it,

i = 1, . . . , N,

t = 1, . . . , ni,

(4)

(cid:0)

(cid:1)

where the covariates x1i and x2it are as deﬁned in equation 3. True values of the
regression parameters used in the simulation are β0 = 1, β1 = 0.20, and β2 = 0.40.
The true values of the regression coeﬃcients are selected so that overall mean of counts
is 3.5.

Under each scenario, two diﬀerent sample sizes (N = 50 and 100) are investigated.
For the scenarios with equal number of time points, ni is equal to 5 for all subjects.
For the scenarios with unequal number of time points, ni for each subject randomly
takes a value from the set {3, 4, 5} with corresponding probabilities {0.15, 0.15, 0.7}.
This approach assumes that every subject has measurements observed at ﬁrst three
time points (e.g., 1, 2, and 3) and 70% of the subjects are fully observed at ﬁve
time points, 15% of the subjects are fully observed at ﬁrst four time points, and
15% of the subjects are fully observed at ﬁrst three time points. Furthermore, for
each scenario, three diﬀerent true working correlation structures, AR(1), Exch, and
UN are investigated with two diﬀerent degree of within-subject correlation values
(α = 0.2 and 0.4). For the UN correlation structure, the correlation between the
observations at t and t′ time points is deﬁned as α|t−t′|λ
, which reduces to AR(1)

6

and Exch structures for λ = 1 and λ = 0, respectively, and λ = 0.5 is used for the
UN structure. The over-dispersion parameter φ is set to 1 for each case. Under each
of 48 diﬀerent scenarios, 1000 longitudinal replicate data sets are generated via R [19]
package PoisBinNonNor [9]. Note that R package PoisBinNonNor also allows to check if
there are range violations among pair-wise correlations of binary-binary variables and
Poisson-Poisson variables given the true value of the marginal mean and correlation
based on the methodology proposed in Demirtas and Hedeker [4].

For each of the true correlation structures considered (i.e. AR(1), Exch, and UN),
the method of GEE is ﬁtted with four diﬀerent working correlation structures, namely,
independence (Indep), AR(1), Exch, and UN via assuming there is no over-dispersion
φ = 1 in the outcomes. User deﬁned R codes, which can handle unequally spaced and
unbalanced longitudinal data (automatically covers equally spaced unbalanced longi-
tudinal data and balanced longitudinal data), are used to ﬁt all the models considered
in the simulation.

4.2. Simulation results

Under each of 48 diﬀerent scenarios, the proportion of times the true working cor-
relation structure is selected by CIC, DBAR, GPC, QIC, RJ1, RJ2, and SC criteria
among the candidate working correlation structures Indep, AR(1), Exch, and UN are
summarized in Tables 1-8. The bold values in Tables 1-8 show the highest score within
that true correlation structure and sample size combination. Furthermore, the results
for the mean squared error values of parameters for each scenario are presented in
Appendix B.

Overall, the pattern of results can be described according to three groups among
the seven working correlation selection criteria deﬁned in terms of their functional
(mathematical) form: {CIC, QIC}, {DBAR, RJ1, RJ2}, and {GP C, SC}, respec-
tively. The ﬁrst main result is that CIC always selects the UN correlation structure as
the best structure in all 48 scenarios, with a value greater than 80%, where QIC does
so 40% − 65% of the time. Hence, regardless of the true correlation structure, these
two criteria are likely to pick UN as the best structure which calls for caution when
using them.

The other main result is that the performance of GPC is always better than that of
(I−

SC in all 48 scenarios indicating that use of the weight matrix Wi = (I−H′
Hi)−1 results in a better performance than use of V−1

i)−1V−1

.

i

Notably, when the true working correlation structure is AR(1), GPC always gives the
highest score among all criteria (Tables 1-8). When the within-subject association level
increases from α = 0.2 to α = 0.4, proportion of correct selections by GPC increases
(e.g., in Table 1 under AR(1) true working correlation structure and N = 50, GPC
has a value of 0.364, whereas in Table 2 under the same settings it is value is 0.421).
The performance of GPC also depends on the response type. GPC has slightly better
performance for Poisson responses compared to binary responses (e.g., in Table 4
under AR(1) true working correlation structure and N = 50, GPC has a value of
0.407, whereas in Table 8 under the same settings it is value is 0.452).

i

With respect to identifying the true Exch structure, GPC performs nearly as well
as DBAR, RJ1, and RJ2 criteria. In fact, the performance of GPC exceeds 60% in
scenarios with Poisson responses, whereas the performance of RJ2 is around 70% in
the same cases (e.g., please see Tables 5 and 7).

When the true working correlation structure is UN, drawing conclusions from the

7

simulation results is not straightforward. As mentioned earlier, regardless of the true
structure, the criteria CIC and QIC are very likely to select UN as the best structure.
On the other hand, the RJ criteria more often correctly select the unstructured corre-
lation matrix than GPC does. Indeed, the performance of GPC is between 5% − 25%.
Actually, the results in Tables B1-B8 in the Appendix also show that even if the true
correlation structure is UN, ﬁtting a marginal model via GEE with an UN structure
results in higher mean squared error values compared to a model with a simple cor-
relation structure. This implies that the most preferred criteria are the ones with a
tendency to pick correlation types with simple structures. This is because the inﬂation
in the number of correlation parameters to be estimated in a model results in a loss
of eﬃciency in regression parameter estimates.

At this point we would like to point that authors of similar studies on selection
of working correlation structure in marginal analysis of longitudinal data via GEE
either do not consider the UN structure as a candidate structure [15] or they specify
a large number of candidate structures so that the inﬂuence of the UN structure on
the simulation results is decreased [11].

To assess the eﬀect of omitting UN as a candidate working correlation structure,
we present limited simulation results showing the proportion of times the criteria
select the true correlation structure among Indep, AR(1), and Exch (excluding UN)
structures, for balanced longitudinal binary data with diﬀerent sample sizes when the
true within-subject correlation level is α = 0.2. The results in Table 9 show that CIC
is very good at selecting the true correlation structure and GPC performs nearly as
well as CIC (and better in the Exch and N = 50 scenario) while incorrectly choosing
the Indep structure less often than CIC.

5. Illustration of working correlation structure selection with the

coronary artery risk development in young adults (CARDIA) study

In this section, binary outcomes for smoking status in a longitudinal cohort of 5, 077
subjects in the Coronary Artery Risk Development in Young Adults (CARDIA) study
are considered to illustrate the choice of working correlation structure selection in
marginal analysis of longitudinal data with GEE. In the CARDIA study, the cigarette
smoking status of participants (yes, no) was ascertained at six study visits beginning
in 1986 (year 0) and continuing in follow-up years 2, 5, 7, 10, and 15 (resulting in
unequally spaced longitudinal binary data). The age at baseline (ranges between 18 −
30 years), attained education status by the end of study (no college attended, some
college, college degree), sex (female, male), and race (black, white) information were
also gathered from each participant.

Perin et al. [16] analyzed the CARDIA study data with GEE where smoking status
was the response variable with follow-up year treated as a categorical variable and a
working correlation structure with an Exch type was assumed. The GEE analysis of
these data indicated that smoking rates signiﬁcantly declined from baseline (year 0)
to year 15 with greater declines for females than males and for whites compared to
blacks. The choice of working correlation structure was based on exploratory analysis
rather than any objective criterion. In particular, the Exch type of correlation structure
appeared to adequately characterize the within-subject correlation of smoking status
over time for CARDIA study participants, where smoking initiation and quitting occur
infrequently.

In this study, we re-visit the 15-year CARDIA study data using cubic polynomial

8

models for time with adjustment for participant age, age-squared, and attained edu-
cation status. Several GEE with diﬀerent working correlation structures for smoking
status (yes, no) with a logit link function are applied to the longitudinal binary data
on four subgroups of sex and race, i.e., black females (N = 1473, ¯n = 4.90), black
males (N = 1145, ¯n = 4.66), white females (N = 1299, ¯n = 5.29), and white males
(N = 1160, ¯n = 5.29), respectively, with N denoting the number of participants in the
subgroup and ¯n denoting the average number of visits per participant in the subgroup
(i.e., where ni is between 1 − 6 for each participant).

Speciﬁcally, let the response yit = 1 if the ith young adult at the tth time point was
a smoker and 0 otherwise and µit = E[yit], the probability that the ith young adult
at the jth time point was a smoker (i = 1, . . . , N , t = 1, . . . , ni), can be described by
the following model:

log

µit
1 − µit (cid:19)

(cid:18)

= β0+β1x1i+β2x2it+β3x3i+β4x4i+βLyeart+βQyear2

t +βC year3

t , (5)

where x1i = age in years divided by 10, x2i = x2
1i, x3i = 1 if attained education is
some college without degree and 0 otherwise, x4i = 1 if attained education is college
degree and 0 otherwise, and yeart is years since the ﬁrst study exam in 1986 divided
by 10. As a primary question of interest, we investigate whether smoking rates among
young adults changed over time. Secondarily, we examine whether the smoking rate
at the ﬁrst study exam (year1 = 0) diﬀers from the smoking rate ﬁfteen years later
(year6 = 1.5 decades).

Table 10 shows the values of the various working correlation selection criteria for
each race and sex group. The GPC identiﬁes the AR(1) working correlation as the best
structure for black females, black males, and white males groups and Exch working
correlation as the best structure for white females group. SC also agrees with GPC on
all cases. Conversely, the CIC, DBAR, RJ1, and RJ2 criteria almost always identify
the unstructured correlation as the best structure for all groups.

Application of GEE with the correlation structures suggested by GPC criterion are
presented in Table 11. The results indicate a strong eﬀect of education where smoking
rates are signiﬁcantly greatest among those without college attendance compared to
those with at least some college and those with a college degree. For example, while
the odds of smoking for a black male without college attendance is 1/exp(−0.964) =
2.622 times higher than that for a black male with a some college attendance, it is
1/exp(−1.787) = 5.972 times higher compared to that for a black male with a college
degree. Based on the results in Table 12, the empirical score test for trend is signiﬁcant
for every group (e.g., P-values are less than 0.001, 0.05, 0.001, and 0.001, respectively)
suggesting that the smoking rate changes over time. However, when the year 1986 (year
0) smoking rate is compared to the year 2001 (year 1.5) smoking rate, the diﬀerence
in rates is not statistically signiﬁcant for black males (e.g., P-value is 0.580).

Fig. 1 shows the smoking trends based on the model applied to the four race and
sex subgroups separately when using an AR(1) correlation structure for black females,
black males, and white males and an Exch correlation for white females. Fig. 1 shows
model-adjusted trends in smoking for each of the three education groups for each
race/sex group of young adults and indicates that smoking rates are higher in par-
ticipants with high school education or less and is much more pronounced in black
participants compared to white participants.

9

6. Conclusion

This study proposed and evaluated a PRESS statistic for selection of the working cor-
relation structure in marginal analysis of longitudinal data by generalized estimating
equations. The simulation results showed that the proposed PRESS statistic has bet-
ter performance than the SC criterion in all cases, is better than several other existing
criteria when the true working correlation structure is AR(1), and is comparable with
other criteria when the true working correlation structure is exchangeable. However,
the simulation studies showed that GPC performs somewhat poorly with respect to
identifying an unstructured correlation structure. This is not necessarily an undesir-
able result as marginal models with a UN structure ﬁtted with GEE results in higher
mean squared error compared to a model with a simpler correlation structure.

Correctly discriminating between an exchangeable (or AR(1)) versus UN correlation
matrices is challenging owing to the number of correlation parameters to be estimated
in the UN case. Indeed, Westgate [24, 26] showed the estimation of a large number of
correlation parameters in the UN structure leads to an increase in the sampling vari-
ances of the regression parameters. Westgate [25] proposed a penalization approach to
the estimation of the sandwich covariance matrix of the regression parameters in the
UN structure which results in higher selection accuracy. Westgate’s penalty is appli-
cable to any working correlation selection criteria involving the sandwich covariance
estimator of the regression parameters. Since our proposed criterion does not involve
the sandwich variance estimator of the regression parameters, the penalty cannot be
applied to the GPC criterion. Nonetheless, the GPC criterion needs further develop-
ment to result in better accuracy in selection of an UN correlation structure.

We focused on selection of the working correlation matrix under the assumption
that the marginal mean model is correctly speciﬁed. Future investigations of the GPC
statistic may include its evaluation for selection of covariates in the linear predic-
tor when correct selection of the correlation matrix is assumed in a GEE analysis.
A special case of the GPC statistic for independent responses warrants investigation
for variable selection in generalized linear models. For the regression analysis of clus-
tered data with marginal models using GEE, a generalized version of Mallow’s Cp was
shown to perform well relative to variable selection based on Wald and score tests [2].
Other problems that could be addressed include the simultaneous selection of working
covariance matrix and the linear predictor in GEE.

As a ﬁnal note, we should also note that R codes used for ﬁtting marginal models
through GEE in this study are adapted from the codes of the R package PGEE [10] which
implements penalized generalized estimating equations for analysis of longitudinal data
with large number of covariates. The R codes used in this study are extended for the
analysis of unequally spaced unbalanced longitudinal data via the method of GEE.

Finally, we would like to draw the attention of authors using R package geepack
[8], R package gee [3], and SAS GENMOD procedure [20] in working correlation structure
selection problems in GEE to the following remarks: 1) Our small-scale simulation
studies show that R package geepack, which uses another set of estimating equations
for correlation parameters, estimates the correlation parameter under AR(1) correla-
tion structure with a considerable bias; 2) The R package gee reports an error under
AR(1) correlation structure when one of the subjects has only one time point, although
it is possible to estimate the correlation parameter; 3) The R package gee cannot han-
dle unequally spaced longitudinal data (whether it is balanced or unbalanced) under
AR(1) and UN correlation structures since there is not any input argument taking
the spacing between time points as in the waves argument in R package geepack and

10

withinsubject option in repeated statement of SAS GENMOD procedure; and 4) The R
package gee and SAS GENMOD procedure estimate the over-dispersion parameter, φ,
even if it is set to 1.

Acknowledgment

This study was presented at the 38th Annual Conference of the International Soci-
ety for Clinical Biostatistics (ISCB) in Vigo, Spain in 2017 through a travel grant
programme of the ISCB conference.

References

[1] D.A. Belsey, E. Kuh, and R.E. Welsch, Regression diagnostics: Identifying inﬂuential data

and sources of collinearity, John Wiley & Sons, New York, 2005.

[2] E. Cantoni, J.M. Flemming, and E. Ronchetti, Variable selection for marginal longitudinal

generalized linear models, Biometrics 61 (2005), pp. 507–514.

[3] V.J.
tion
https://cran.r-project.org/web/packages/gee/.

T.
solver, R package

Carey,
equation

Lumley,

version

and

B.

Ripley,

gee: Generalized

4.13-19,

2015. Available

estima-
at

[4] H. Demirtas and D. Hedeker, A practical way for computing approximate lower and upper

correlation bounds, Am. Stat. 65 (2011), pp. 104–109.

[5] M. Gosho, C. Hamada, and Yoshimura, Criterion for the selection of a working correlation
structure in the generalized estimating equation approach for longitudinal balanced data,
Commun. Stat. Theory Methods 40 (2011), pp. 3839–3856.

[6] B.G. Hammill and J.S. Preisser, A SAS/IML software program for GEE and regression

diagnostics, Comput. Stat. Data Anal. 51 (2006), pp. 1197–1212.

[7] L.Y. Hin and Y.G. Wang, Working-correlation-structure identiﬁcation in generalized es-

timating equations, Stat. Med. 28 (2009), pp. 642–658.
Yan,

Hojsgaard,

and

U.

[8] S.

Halekoh,
R

J.
version

timating
https://cran.r-project.org/web/packages/geepack.

equation,

package

1.2-0.1,

geepack: Generalized
Available

2016.

es-
at

[9] G.

Inan and H. Demirtas, PoisBinNonNor: Data generation with Poisson, bi-
nary and continuous components, R package version 1.1, 2016. Available at
https://cran.r-project.org/web/packages/PoisBinNonNor.
and L. Wang, PGEE: Penalized

estimat-
in high-dimension, R package version 1.5, 2017. Available at

[10] G.
ing
https://cran.r-project.org/web/packages/PGEE.

Inan,
equations

generalized

J. Zhou,

[11] A. Jaman, M. Latif, W. Bari, and A.S. Wahed, A determinant based criterion for working
correlation structure selection in generalized estimating equations, Stat. Med. 35 (2015),
pp. 1819-1833.

[12] K.Y. Liang and S.L. Zeger, Longitudinal data analysis using generalized linear models,

Biometrika 73 (1986), pp. 13–22.

[13] L.A. Mancl and T.A. DeRouen, A covariance estimator for gee with improved small-

sample properties, Biometrics 57 (2001), pp. 126–134.

[14] W. Pan, Akaike’s information criterion in generalized estimating equations, Biometrics

57 (2001) pp. 120–125.

[15] M.C. Pardo and R. Alonso, Working correlation structure selection in GEE analysis, Stat.

Pap. (2017), pp. 1–21, doi: 10.1007/s00362-017-0881-0.

[16] J. Perin, J.S. Preisser, and R.J. Rathouz, Semiparametric eﬃcient estimation for incom-
plete longitudinal binary data, with application to smoking trends, J. Am. Stat. Assoc. 104
(2009), pp. 1373–1384.

11

[17] J.S. Preisser and B.F. Qaqish, Deletion diagnostics for generalised estimating equations,

Biometrika 83 (1996), pp. 551–562.

[18] J.S. Preisser, B.F. Qaqish, and J. Perin, A note on deletion diagnostics for estimating

equations, Biometrika 95 (2008), pp. 509–513.

[19] R Core Team, R: A Language and Environment for Statistical Computing, R Foundation

for Statistical Computing, Vienna, Austria, 2013.

[20] SAS Institute Inc., SAS/STAT 9.4 User’s Guide, Cary, NC: SAS Institute Inc., 2013.
[21] A. Rotnitzky and N.P. Jewell, Hypothesis testing of regression parameters in semipara-
metric generalized linear models for cluster correlated data, Biometrika 77 (1990), pp.
485–497.

[22] J. Shults and N.R. Chaganty, Analysis of serially correlated data using quasi-least squares,

Biometrics 54 (1998), pp. 1622–1630.

[23] J. Shults, W. Sun, X. Tu, H. Kim, J. Amsterdam, J.M. Hilbe, and T. Ten-Have T, A
comparison of several approaches for choosing between working correlation structures in
generalized estimating equation analysis of longitudinal binary data, Stat. Med. 28 (2009),
pp. 2338–2355.

[24] P.M. Westgate, A bias correction for covariance estimators to improve inference with
generalized estimating equations that use an unstructured correlation matrix, Stat. Med.
32 (2013), pp. 2850–2858.

[25] P.M. Westgate, Improving the correlation structure selection approach for generalized es-
timating equations and balanced longitudinal data, Stat. Med. 33 (2014), pp. 2222–2237.
[26] P.M. Westgate, A covariance correction that accounts for correlation estimation to im-
prove ﬁnite-sample inference with generalized estimating equations: A study on its ap-
plicability with structured correlation matrices. J. Stat. Comput. Simul. 86 (2016), pp.
1891–1900.

12

Tables and Figures

Table 1.: Proportion of selecting the true correlation structure
by the competing selection criteria for balanced longi-
tudinal binary data with diﬀerent sample sizes when
true within-subject correlation level is α = 0.2.

True

N = 50

N = 100

correlation

Selection

Working corr. structure

Working corr. structure

structure

criteria

Indep AR(1) Exch

UN

Indep AR(1) Exch

UN

AR(1)

Exch

UN

CIC
DBAR
GPC
QIC
|RJ1 − 1|
|RJ2 − 1|
SC
CIC
DBAR
GPC
QIC
|RJ1 − 1|
|RJ2 − 1|
SC
CIC
DBAR
GPC
QIC
|RJ1 − 1|
|RJ2 − 1|
SC

0.028
0.030
0.040
0.115
0.087
0.050
0.259
0.018
0.002
0.028
0.156
0.014
0.007
0.305
0.029
0.008
0.034
0.152
0.049
0.025
0.289

0.089
0.181
0.364
0.238
0.240
0.270
0.327
0.038
0.026
0.218
0.109
0.099
0.048
0.335
0.077
0.120
0.342
0.188
0.258
0.222
0.348

0.028
0.366
0.397
0.108
0.393
0.391
0.213
0.076
0.541
0.582
0.218
0.535
0.585
0.209
0.042
0.443
0.447
0.138
0.398
0.467
0.192

0.859
0.474
0.199
0.547
0.309
0.295
0.203
0.868
0.452
0.172
0.519
0.360
0.372
0.152
0.856
0.471
0.178
0.526
0.308
0.296
0.172

0.017
0.006
0.031
0.105
0.051
0.027
0.268
0.013
0.000
0.038
0.126
0.000
0.000
0.250
0.017
0.003
0.046
0.121
0.011
0.007
0.274

0.062
0.165
0.324
0.225
0.269
0.277
0.298
0.026
0.002
0.314
0.076
0.028
0.010
0.386
0.050
0.089
0.327
0.204
0.231
0.171
0.320

0.025
0.421
0.417
0.105
0.343
0.343
0.209
0.043
0.555
0.489
0.212
0.544
0.566
0.228
0.017
0.492
0.411
0.125
0.411
0.454
0.195

0.90
0.500
0.228
0.570
0.361
0.363
0.227
0.924
0.496
0.159
0.588
0.450
0.432
0.136
0.918
0.481
0.216
0.556
0.375
0.376
0.212

13

Table 2.: Proportion of selecting the true correlation structure
by the competing selection criteria for balanced longi-
tudinal binary data with diﬀerent sample sizes when
true within-subject correlation level is α = 0.4.

True
correlation
structure

AR(1)

Exch

UN

Selection
criteria
CIC
DBAR
GPC
QIC
|RJ1 − 1|
|RJ2 − 1|
SC
CIC
DBAR
GPC
QIC
|RJ1 − 1|
|RJ2 − 1|
SC
CIC
DBAR
GPC
QIC
|RJ1 − 1|
|RJ2 − 1|
SC

N = 50
Working corr. structure

N = 100
Working corr. structure

Indep AR(1) Exch
0.027
0.209
0.009
0.471
0.234
0.002
0.421
0.448
0.030
0.111
0.330
0.105
0.452
0.299
0.009
0.469
0.292
0.001
0.195
0.387
0.318
0.180
0.053
0.021
0.663
0.011
0.000
0.558
0.309
0.041
0.331
0.086
0.150
0.623
0.058
0.000
0.703
0.013
0.000
0.219
0.343
0.356
0.071
0.140
0.016
0.583
0.094
0.000
0.500
0.385
0.025
0.181
0.232
0.130
0.513
0.215
0.001
0.599
0.144
0.000
0.217
0.379
0.322

UN
0.757
0.317
0.102
0.457
0.250
0.245
0.100
0.750
0.338
0.092
0.438
0.320
0.285
0.082
0.776
0.342
0.090
0.460
0.279
0.259
0.082

Indep AR(1) Exch
0.007
0.134
0.002
0.468
0.205
0.000
0.412
0.446
0.039
0.119
0.320
0.068
0.414
0.274
0.000
0.437
0.278
0.000
0.223
0.389
0.284
0.105
0.019
0.003
0.651
0.000
0.000
0.515
0.366
0.057
0.327
0.044
0.158
0.601
0.011
0.000
0.640
0.001
0.000
0.228
0.361
0.361
0.038
0.101
0.002
0.597
0.049
0.000
0.501
0.374
0.055
0.203
0.210
0.094
0.526
0.145
0.000
0.585
0.099
0.000
0.238
0.368
0.334

UN
0.861
0.375
0.104
0.495
0.332
0.295
0.104
0.874
0.386
0.062
0.475
0.405
0.361
0.050
0.861
0.387
0.070
0.493
0.344
0.326
0.060

14

Table 3.: Proportion of selecting the true correlation structure
by the competing selection criteria for unbalanced lon-
gitudinal binary data with diﬀerent sample sizes when
true within-subject correlation level is α = 0.2.

True

N = 50

N = 100

correlation

Selection

Working corr. structure

Working corr. structure

structure

criteria

Indep AR(1) Exch

UN

Indep AR(1) Exch

UN

AR(1)

Exch

UN

CIC
DBAR
GPC
QIC
|RJ1 − 1|
|RJ2 − 1|
SC
CIC
DBAR
GPC
QIC
|RJ1 − 1|
|RJ2 − 1|
SC
CIC
DBAR
GPC
QIC
|RJ1 − 1|
|RJ2 − 1|
SC

0.040
0.032
0.087
0.127
0.099
0.060
0.237
0.039
0.005
0.092
0.167
0.015
0.011
0.297
0.043
0.012
0.095
0.164
0.066
0.032
0.283

0.095
0.181
0.355
0.249
0.243
0.288
0.287
0.047
0.032
0.261
0.118
0.134
0.073
0.258
0.094
0.148
0.306
0.198
0.233
0.206
0.273

0.043
0.398
0.346
0.104
0.398
0.413
0.250
0.117
0.558
0.493
0.238
0.544
0.587
0.296
0.039
0.441
0.403
0.133
0.414
0.471
0.252

0.827
0.434
0.214
0.524
0.278
0.247
0.226
0.798
0.429
0.155
0.481
0.316
0.331
0.149
0.828
0.438
0.196
0.507
0.300
0.297
0.192

0.012
0.007
0.123
0.101
0.048
0.033
0.269
0.011
0.000
0.145
0.114
0.001
0.000
0.317
0.018
0.001
0.128
0.129
0.020
0.008
0.280

0.069
0.169
0.317
0.218
0.248
0.248
0.264
0.023
0.005
0.306
0.113
0.056
0.014
0.281
0.035
0.098
0.320
0.161
0.228
0.189
0.284

0.017
0.440
0.365
0.109
0.386
0.416
0.271
0.066
0.538
0.416
0.231
0.526
0.581
0.287
0.026
0.487
0.366
0.123
0.418
0.465
0.258

0.904
0.477
0.195
0.575
0.336
0.314
0.196
0.902
0.493
0.134
0.549
0.448
0.414
0.115
0.923
0.483
0.186
0.591
0.363
0.353
0.179

15

Table 4.: Proportion of selecting the true correlation structure
by the competing selection criteria for unbalanced lon-
gitudinal binary data with diﬀerent sample sizes when
true within-subject correlation level is α = 0.4.

True
correlation
structure

AR(1)

Exch

UN

N = 50

Selection Working correlation structure
UN
criteria
0.708
CIC
0.332
DBAR
0.106
GPC
0.406
QIC
0.245
|RJ1 − 1|
0.230
|RJ2 − 1|
0.110
SC
0.736
CIC
0.309
DBAR
0.081
GPC
0.404
QIC
0.270
|RJ1 − 1|
0.259
|RJ2 − 1|
0.070
SC
0.741
CIC
0.331
DBAR
0.096
GPC
0.438
QIC
0.258
|RJ1 − 1|
0.244
|RJ2 − 1|
0.082
SC

Indep AR(1) Exch
0.047
0.235
0.015
0.432
0.262
0.001
0.407
0.395
0.092
0.101
0.345
0.151
0.482
0.270
0.013
0.482
0.285
0.007
0.279
0.342
0.269
0.183
0.059
0.024
0.674
0.024
0.000
0.546
0.264
0.109
0.293
0.127
0.176
0.646
0.093
0.000
0.719
0.027
0.000
0.364
0.280
0.287
0.081
0.160
0.020
0.556
0.130
0.000
0.458
0.342
0.104
0.165
0.244
0.155
0.507
0.245
0.004
0.589
0.174
0.000
0.310
0.310
0.298

N = 100
Working correlation structure
UN
Indep AR(1) Exch
0.831
0.017
0.152
0.002
0.324
0.480
0.247
0.000
0.363
0.079
0.407
0.151
0.460
0.109
0.325
0.109
0.284
0.444
0.291
0.000
0.260
0.436
0.309
0.000
0.075
0.313
0.330
0.282
0.788
0.185
0.023
0.007
0.370
0.663
0.002
0.000
0.056
0.467
0.311
0.166
0.400
0.368
0.080
0.153
0.365
0.634
0.013
0.000
0.670
0.332
0.002
0.000
0.052
0.344
0.264
0.340
0.836
0.057
0.105
0.007
0.386
0.563
0.087
0.000
0.086
0.420
0.333
0.162
0.462
0.193
0.225
0.122
0.324
0.524
0.171
0.000
0.319
0.586
0.103
0.000
0.074
0.304
0.292
0.330

16

Table 5.: Proportion of selecting the true correlation structure
by the competing selection criteria for balanced lon-
gitudinal count data with diﬀerent sample sizes when
true within-subject correlation level is α = 0.2.

True

N = 50

N = 100

correlation

Selection

Working corr. structure

Working corr. structure

structure

criteria

Indep AR(1) Exch

UN

Indep AR(1) Exch

UN

AR(1)

Exch

UN

CIC
DBAR
GPC
QIC
|RJ1 − 1|
|RJ2 − 1|
SC
CIC
DBAR
GPC
QIC
|RJ1 − 1|
|RJ2 − 1|
SC
CIC
DBAR
GPC
QIC
|RJ1 − 1|
|RJ2 − 1|
SC

0.020
0.072
0.042
0.137
0.226
0.159
0.348
0.022
0.006
0.087
0.138
0.048
0.025
0.347
0.033
0.028
0.044
0.140
0.122
0.088
0.367

0.086
0.213
0.358
0.222
0.263
0.306
0.281
0.050
0.065
0.136
0.100
0.217
0.153
0.209
0.073
0.180
0.247
0.176
0.267
0.241
0.268

0.034
0.392
0.422
0.085
0.320
0.337
0.187
0.059
0.550
0.610
0.158
0.481
0.556
0.290
0.039
0.435
0.524
0.127
0.376
0.425
0.199

0.863
0.369
0.179
0.558
0.201
0.204
0.186
0.871
0.409
0.167
0.607
0.265
0.268
0.155
0.856
0.394
0.185
0.558
0.246
0.252
0.167

0.018
0.034
0.061
0.118
0.119
0.085
0.386
0.008
0.000
0.155
0.117
0.003
0.002
0.400
0.017
0.012
0.108
0.113
0.060
0.039
0.378

0.073
0.210
0.354
0.193
0.311
0.309
0.276
0.018
0.014
0.143
0.076
0.124
0.070
0.176
0.056
0.147
0.235
0.158
0.319
0.277
0.253

0.016
0.424
0.402
0.080
0.331
0.357
0.153
0.036
0.561
0.543
0.151
0.537
0.556
0.289
0.041
0.449
0.437
0.134
0.366
0.390
0.169

0.895
0.399
0.183
0.616
0.251
0.261
0.185
0.941
0.487
0.159
0.659
0.361
0.384
0.136
0.887
0.46
0.220
0.599
0.280
0.303
0.200

17

Table 6.: Proportion of selecting the true correlation structure
by the competing selection criteria for balanced lon-
gitudinal count data with diﬀerent sample sizes when
true within-subject correlation level is α = 0.4.

True
correlation
structure

AR(1)

Exch

UN

Selection
criteria
CIC
DBAR
GPC
QIC
|RJ1 − 1|
|RJ2 − 1|
SC
CIC
DBAR
GPC
QIC
|RJ1 − 1|
|RJ2 − 1|
SC
CIC
DBAR
GPC
QIC
|RJ1 − 1|
|RJ2 − 1|
SC

N = 50
Working corr. structure

N = 100
Working corr. structure

Indep AR(1) Exch
0.026
0.194
0.010
0.481
0.241
0.008
0.452
0.364
0.106
0.133
0.288
0.098
0.433
0.313
0.059
0.447
0.310
0.034
0.161
0.424
0.336
0.074
0.063
0.011
0.617
0.049
0.000
0.623
0.140
0.175
0.211
0.075
0.152
0.589
0.201
0.004
0.669
0.125
0.000
0.429
0.177
0.335
0.057
0.107
0.009
0.504
0.169
0.002
0.460
0.300
0.141
0.164
0.160
0.116
0.423
0.378
0.023
0.500
0.300
0.009
0.215
0.357
0.355

UN
0.773
0.288
0.078
0.481
0.205
0.214
0.079
0.853
0.344
0.063
0.567
0.214
0.211
0.059
0.830
0.347
0.100
0.562
0.182
0.197
0.074

Indep AR(1) Exch
0.017
0.105
0.003
0.499
0.220
0.000
0.428
0.315
0.188
0.097
0.297
0.073
0.441
0.337
0.006
0.447
0.347
0.003
0.148
0.413
0.379
0.041
0.020
0.004
0.598
0.011
0.000
0.527
0.155
0.271
0.194
0.054
0.122
0.625
0.082
0.000
0.680
0.036
0.000
0.401
0.169
0.386
0.022
0.047
0.002
0.570
0.079
0.000
0.365
0.322
0.242
0.147
0.151
0.113
0.470
0.255
0.002
0.529
0.189
0.000
0.211
0.342
0.387

UN
0.878
0.346
0.069
0.534
0.229
0.212
0.060
0.937
0.443
0.047
0.631
0.319
0.288
0.044
0.929
0.394
0.071
0.590
0.291
0.286
0.060

18

Table 7.: Proportion of selecting the true correlation structure
by the competing selection criteria for unbalanced lon-
gitudinal count data with diﬀerent sample sizes when
true within-subject correlation level is α = 0.2.

True

N = 50

N = 100

correlation

Selection

Working corr. structure

Working corr. structure

structure

criteria

Indep AR(1) Exch

UN

Indep AR(1) Exch

UN

AR(1)

Exch

UN

CIC
DBAR
GPC
QIC
|RJ1 − 1|
|RJ2 − 1|
SC
CIC
DBAR
GPC
QIC
|RJ1 − 1|
|RJ2 − 1|
SC
CIC
DBAR
GPC
QIC
|RJ1 − 1|
|RJ2 − 1|
SC

0.041
0.065
0.041
0.135
0.203
0.136
0.306
0.031
0.010
0.070
0.157
0.066
0.032
0.331
0.034
0.041
0.051
0.155
0.152
0.087
0.323

0.109
0.235
0.393
0.197
0.269
0.303
0.311
0.064
0.077
0.138
0.112
0.274
0.191
0.183
0.089
0.193
0.314
0.157
0.277
0.284
0.297

0.031
0.388
0.410
0.118
0.318
0.322
0.229
0.067
0.532
0.641
0.173
0.432
0.519
0.347
0.065
0.468
0.485
0.152
0.367
0.406
0.240

0.823
0.366
0.156
0.553
0.226
0.241
0.154
0.841
0.407
0.152
0.561
0.241
0.264
0.140
0.813
0.351
0.150
0.539
0.213
0.233
0.142

0.019
0.033
0.089
0.117
0.134
0.092
0.314
0.015
0.000
0.142
0.130
0.013
0.006
0.366
0.017
0.017
0.090
0.118
0.075
0.048
0.332

0.075
0.228
0.362
0.196
0.299
0.308
0.301
0.026
0.039
0.172
0.068
0.175
0.120
0.190
0.063
0.153
0.279
0.162
0.329
0.293
0.269

0.022
0.418
0.388
0.089
0.343
0.353
0.221
0.046
0.553
0.547
0.161
0.493
0.539
0.320
0.036
0.443
0.450
0.112
0.364
0.384
0.243

0.888
0.402
0.162
0.604
0.238
0.256
0.164
0.916
0.470
0.139
0.648
0.342
0.346
0.124
0.885
0.451
0.181
0.611
0.256
0.286
0.157

19

Table 8.: Proportion of selecting the true correlation structure
by the competing selection criteria for unbalanced lon-
gitudinal count data with diﬀerent sample sizes when
true within-subject correlation level is α = 0.4.

True
correlation
structure

AR(1)

Exch

UN

Selection
criteria
CIC
DBAR
GPC
QIC
|RJ1 − 1|
|RJ2 − 1|
SC
CIC
DBAR
GPC
QIC
|RJ1 − 1|
|RJ2 − 1|
SC
CIC
DBAR
GPC
QIC
|RJ1 − 1|
|RJ2 − 1|
SC

N = 50
Working corr. structure

N = 100
Working corr. structure

Indep AR(1) Exch
0.050
0.206
0.015
0.466
0.291
0.013
0.452
0.378
0.100
0.134
0.280
0.141
0.428
0.326
0.069
0.424
0.375
0.034
0.205
0.433
0.295
0.132
0.072
0.015
0.601
0.066
0.000
0.672
0.142
0.126
0.254
0.085
0.164
0.490
0.300
0.010
0.606
0.189
0.003
0.487
0.193
0.264
0.073
0.146
0.013
0.514
0.210
0.003
0.474
0.327
0.124
0.196
0.180
0.142
0.421
0.400
0.022
0.492
0.316
0.011
0.276
0.344
0.317

UN
0.735
0.257
0.071
0.448
0.190
0.174
0.068
0.784
0.357
0.062
0.500
0.212
0.208
0.058
0.768
0.299
0.076
0.485
0.167
0.184
0.063

Indep AR(1) Exch
0.013
0.149
0.002
0.484
0.262
0.001
0.422
0.326
0.195
0.122
0.300
0.080
0.428
0.345
0.014
0.440
0.345
0.005
0.197
0.391
0.356
0.079
0.029
0.004
0.629
0.020
0.000
0.537
0.175
0.259
0.245
0.058
0.117
0.601
0.128
0.000
0.655
0.076
0.000
0.418
0.189
0.368
0.040
0.071
0.003
0.558
0.103
0.000
0.426
0.295
0.223
0.150
0.161
0.115
0.452
0.314
0.005
0.533
0.238
0.001
0.289
0.314
0.351

UN
0.841
0.311
0.057
0.501
0.232
0.219
0.056
0.891
0.400
0.030
0.584
0.286
0.276
0.026
0.887
0.381
0.056
0.577
0.242
0.233
0.046

20

Table 9.: Proportion of selecting the true correlation structure
among the candidate working correlation structures In-
dep, AR(1), Exch by the competing selection criteria
for balanced longitudinal binary data with diﬀerent
sample sizes when true within-subject correlation level
is α = 0.2.

True

N = 50

N = 100

correlation

Selection Working corr. structure

Working corr. structure

structure

AR(1)

Exch

criteria
CIC
DBAR
GPC
QIC
|RJ1 − 1|
|RJ2 − 1|
SC
CIC
DBAR
GPC
QIC
|RJ1 − 1|
|RJ2 − 1|
SC

Indep AR(1)
0.705
0.116
0.360
0.057
0.487
0.049
0.564
0.221
0.303
0.110
0.331
0.068
0.453
0.300
0.246
0.151
0.054
0.003
0.274
0.035
0.216
0.290
0.124
0.017
0.071
0.009
0.391
0.363

Exch
0.196
0.648
0.464
0.226
0.599
0.605
0.250
0.607
0.951
0.691
0.500
0.861
0.920
0.247

Indep AR(1)
0.790
0.078
0.359
0.016
0.467
0.042
0.598
0.188
0.324
0.064
0.340
0.033
0.437
0.310
0.190
0.071
0.006
0.000
0.349
0.049
0.172
0.216
0.041
0.000
0.012
0.000
0.418
0.303

Exch
0.139
0.695
0.491
0.221
0.620
0.632
0.255
0.743
0.995
0.602
0.615
0.960
0.989
0.279

21

Table 10.: Values of selection criteria (CIC, DBAR, GPC, QIC,
RJ1, RJ2, and SC) under diﬀerent working correla-
tion structures (Indep, AR(1), Exch, and UN) for the
analysis of the CARDIA study.

Race/Gender

Selection
criteria
CIC
DBAR
GPC
Black females QIC

Black males

|RJ1 − 1|
|RJ2 − 1|
SC
CIC
DBAR
GPC
QIC
|RJ1 − 1|
|RJ2 − 1|
SC
CIC
DBAR
GPC
White females QIC

|RJ1 − 1|
|RJ2 − 1|
SC
CIC
DBAR
GPC
QIC
|RJ1 − 1|
|RJ2 − 1|
SC

White males

Working correlation structure

Indep
22.259
6.582
7217.867
8228.186
1.782
10.147
7173.059
21.576
5.936
5367.099
6532.317
1.697
9.330
5323.583
21.233
5.632
6918.060
6498.943
1.654
8.941
6875.203
22.169
6.448
6157.361
5949.163
1.771
9.990
6112.547

AR(1)
20.580
0.083
6834.430
8226.052
0.045
0.174
6817.624
19.703
0.056
5101.026
6531.367
0.027
0.109
5084.500
20.147
0.129
6620.616
6498.869
0.098
0.325
6602.925
20.973
0.103
5321.125
5950.807
0.045
0.193
5304.263

UN
Exch
20.408
20.699
0.006
0.033
7100.406
6900.614
8226.345
8226.733
0.007
0.056
0.008
0.144
7084.452
6883.653
19.343
19.705
0.003
0.095
5214.248
5337.206
6530.689 6530.804

0.069
0.234
5197.047
20.235
0.037

0.000
0.004
5321.113
19.861
0.012

6392.052 6655.366
6499.063
6500.929
0.014
0.052
0.016
0.141

6375.116 6639.486
20.788
0.017
5592.362
5949.231
0.016
0.015
5576.505

21.048
0.072
5411.959
5950.156
0.058
0.189
5394.906

Note that: The smaller value of each criterion leads to a better working
correlation structure.

22

Table 11.: GEE estimates (emp. se’s) for the CARDIA study.

Variable
Intercept
Age/10
Age-square
Some collegea
College degreea
Year (Yr/10)
Year-square
Year-cubic
Within-subject
association

Parameter
β0
β1
β2
β3
β4
βL
βQ
βC

Black

White

Females
-0.011 (0.111)
0.327* (0.157)
-0.593 (0.430)
-0.693* (0.117)
-1.769* (0.170)
0.468* (0.220)
-0.935* (0.388)
0.353* (0.174)

Males
0.164 (0.110)
0.648* (0.176)
0.319 (0.467)
-0.964* (0.125)
-1.787* (0.177)
0.449 (0.248)
-0.451 (0.429)
0.089 (0.191)

Females
0.164 (0.147)
-0.244 (0.186)
-0.305 (0.512)
-0.590* (0.161)
-1.871* (0.161)
-0.713* (0.266)
0.516 (0.475)
-0.203 (0.215)

Males
0.295 (0.155)
-0.079 (0.193)
-0.692 (0.573)
-0.987* (0.169)
-2.005* (0.167)
0.022 (0.248)
-0.290 (0.437)
0.068 (0.195)

α

0.779

0.790

0.617

0.737

Note that: Ar(1) structure is used for black females, black males, and white males
and Exch structure is for white females.
∗ P-value < 0.05.
aNo college attended is the reference category.

Table 12.: Test for any trend and Yr 0 vs Yr 1.5.

Black

White

Females Males

Females Males

Score test:
Trend

χ2
28.49
3
P-value < 0.001 < 0.050

13.66

63.86

37.99

< 0.001 < 0.001

Score test:

χ2
1
Yr 0 vs Yr 1.5 P-value < 0.001

13.06

0.31
0.580

58.43

34.23

< 0.001 < 0.001

23

Black Females

Black Males

White Females

White Males

l

e
c
n
e
a
v
e
r
p

i

g
n
k
o
m
S

0.5

0.4

0.3

0.2

0.1

0.5

0.4

0.3

0.2

0.1

1990

1995

2000

1990

1995

2000

Year

Figure 1.: Model predicted trends in smoking among a cohort of young adults, the
CARDIA study; solid line indicates those who attained a college degree,
long dashes indicates some college, and short dashes indicates high school
education or less.

24

 
Appendix A. Details of the GPC statistic

Theorem A.1. Deﬁne ˆr(i) = Zi − Xi ˆβ(i) as the linearized PRESS residual vec-
(i){ ˆCov(ˆr(i))}−1ˆr(i) and
tor for the ith cluster. The GPC statistic approximates
(i){ ˆCov(ˆe(i))}−1ˆe(i), where ˆe(i) = yi − g−1(Xi ˆβ(i)).

N
i ˆe′

N
i ˆr′

P

iV−1

P
Proof. The relation ˆr(i) = Xi(ˆβ − ˆβ(i)) + Liˆei follows by substitution of Zi = Xi ˆβ +
Liˆei. Next, deﬁne Ci = M−1D′
i (I − Hi)−1ˆei, which is a one-step approximation of
ˆβ − ˆβ(i) [18] and reduces to DBETA for multiple linear regression [1]. Note that Di =
L−1
L−1
i XiM−1D′
i Xi. By substitution, ˆr(i) ≈ Li
Hi(I −
ˆei = Li(I − Hi)−1ˆei. It follows that Cov(ˆr(i)) ≈ Li(I − Hi)−1Cov(ˆei)(I −
Hi)−1 + I
H′

i)−1Li ≈ LiViLi. Thus
Next, a ﬁrst-order linear Taylor series expansion of g−1(Xi ˆβ(i)) about ˆβ is

(i){ ˆCov(ˆr(i))}−1ˆr(i) ≈ GPC.

i (I − Hi)−1 + Ini

ˆei = Li

iV−1

N
i ˆr′

P

(cid:2)

(cid:2)

(cid:3)

(cid:3)

g−1(Xi ˆβ(i)) ≈ g−1(Xi ˆβ) − L−1

i Xi(ˆβ − ˆβ(i)).

Applying Ci and algebra yields ˆe(i) ≈ ˆei + Hi(I − Hi)−1ˆei = (I − Hi)−1ˆei.
(i){ ˆCov(ˆe(i))}−1ˆe(i)
Thus,
≈ GPC.

ˆCov(ˆe(i)) ≈ (I − Hi)−1 ˆCov(ˆei)(I − H′

i)−1 ≈ ˆVi and

N
i ˆe′

P

25

Appendix B. Mean squared error values

Appendix provides the results for mean squared error values of regression parameters
for each 48 diﬀerent scenario above via Tables B1-B8 given below.

Table B1.: Mean squared error values of parameters for the case of balanced longi-
tudinal binary data with diﬀerent sample sizes when true within-subject
correlation level is α = 0.2.

True
correlation Param.
structure

AR(1)

Exch

UN

β0
β1
β2
β0
β1
β2
β0
β1
β2

N = 50
Working corr.
Indep AR(1) Exch
0.084
0.083
0.084
0.150
0.148
0.150
0.102
0.100
0.103
0.110
0.113
0.113
0.198
0.199
0.199
0.099
0.105
0.107
0.094
0.094
0.094
0.169
0.167
0.169
0.099
0.098
0.103

UN
0.093
0.154
0.116
0.124
0.214
0.112
0.105
0.182
0.112

N = 100
Working corr. structure

Indep AR(1) Exch
0.042
0.041
0.040
0.068
0.067
0.070
0.049
0.047
0.050
0.052
0.053
0.054
0.090
0.091
0.090
0.045
0.047
0.049
0.048
0.048
0.049
0.084
0.083
0.083
0.050
0.050
0.053

UN
0.042
0.070
0.049
0.056
0.097
0.048
0.050
0.086
0.052

Table B2.: Mean squared error values of parameters for the case of balanced longi-
tudinal binary data with diﬀerent sample sizes when true within-subject
correlation level is α = 0.4.

True
correlation Param.
structure

AR(1)

Exch

UN

β0
β1
β2
β0
β1
β2
β0
β1
β2

N = 50
Working corr. structure

N = 100
Working corr. structure

Indep AR(1) Exch
0.104
0.098
0.109
0.202
0.198
0.204
0.105
0.089
0.116
0.149
0.156
0.157
0.293
0.300
0.296
0.079
0.090
0.108
0.135
0.134
0.139
0.240
0.238
0.241
0.095
0.090
0.115

UN
0.109
0.215
0.101
0.164
0.317
0.084
0.155
0.265
0.104

Indep AR(1) Exch
0.051
0.048
0.050
0.100
0.096
0.100
0.043
0.038
0.050
0.070
0.071
0.073
0.132
0.135
0.134
0.040
0.045
0.057
0.057
0.056
0.058
0.117
0.115
0.117
0.042
0.041
0.051

UN
0.052
0.102
0.041
0.079
0.14
0.042
0.059
0.124
0.043

26

Table B3.: Mean squared error values of parameters for the case of unbalanced lon-
gitudinal binary data with diﬀerent sample sizes when true within-subject
correlation level is α = 0.2.

True
correlation Param.
structure

AR(1)

Exch

UN

β0
β1
β2
β0
β1
β2
β0
β1
β2

N = 50
Working corr.
Indep AR(1) Exch
0.100
0.094
0.101
0.160
0.164
0.159
0.114
0.120
0.115
0.108
0.111
0.111
0.203
0.206
0.205
0.121
0.128
0.129
0.104
0.104
0.106
0.182
0.183
0.182
0.110
0.111
0.115

UN
0.113
0.171
0.128
0.119
0.209
0.136
0.112
0.196
0.118

N = 100
Working corr. structure

Indep AR(1) Exch
0.047
0.046
0.050
0.081
0.080
0.080
0.052
0.052
0.050
0.052
0.054
0.054
0.095
0.095
0.094
0.050
0.052
0.055
0.049
0.049
0.050
0.087
0.087
0.087
0.052
0.050
0.054

UN
0.049
0.085
0.055
0.056
0.101
0.053
0.051
0.091
0.052

Table B4.: Mean squared error values of parameters for the case of unbalanced lon-
gitudinal binary data with diﬀerent sample sizes when true within-subject
correlation level is α = 0.4.

True
correlation Param.
structure

AR(1)

Exch

UN

β0
β1
β2
β0
β1
β2
β0
β1
β2

N = 50
Working corr. structure

N = 100
Working corr. structure

Indep AR(1) Exch
0.131
0.126
0.135
0.227
0.219
0.231
0.105
0.097
0.119
0.145
0.149
0.159
0.300
0.311
0.310
0.084
0.093
0.117
0.124
0.122
0.130
0.249
0.245
0.252
0.095
0.094
0.115

UN
0.136
0.237
0.108
0.158
0.322
0.090
0.129
0.255
0.103

Indep AR(1) Exch
0.054
0.052
0.060
0.106
0.104
0.110
0.055
0.049
0.060
0.069
0.072
0.075
0.133
0.140
0.140
0.042
0.049
0.059
0.062
0.063
0.065
0.109
0.110
0.110
0.046
0.044
0.057

UN
0.055
0.108
0.053
0.076
0.148
0.048
0.068
0.115
0.045

Table B5.: Mean squared error values of parameters for the case of balanced longi-
tudinal count data with diﬀerent sample sizes when true within-subject
correlation level is α = 0.2.

True
correlation Param.
structure

AR(1)

Exch

UN

β0
β1
β2
β0
β1
β2
β0
β1
β2

N = 50
Working corr. structure

N = 100
Working corr. structure

Indep AR(1) Exch
0.008
0.009
0.005
0.006
0.006
0.006
0.005
0.005
0.005
0.007
0.020
0.006
0.008
0.008
0.008
0.005
0.007
0.005
0.007
0.019
0.006
0.006
0.007
0.006
0.005
0.006
0.005

UN
0.005
0.007
0.005
0.007
0.008
0.005
0.006
0.007
0.005

Indep AR(1) Exch
0.002
0.002
0.000
0.003
0.003
0.000
0.002
0.002
0.000
0.004
0.003
0.003
0.004
0.004
0.004
0.002
0.002
0.002
0.003
0.003
0.003
0.003
0.003
0.003
0.002
0.002
0.002

UN
0.002
0.003
0.002
0.003
0.004
0.002
0.003
0.003
0.002

27

Table B6.: Mean squared error values of parameters for the case of balanced longi-
tudinal count data with diﬀerent sample sizes when true within-subject
correlation level is α = 0.4.

True
correlation Param.
structure

AR(1)

Exch

UN

β0
β1
β2
β0
β1
β2
β0
β1
β2

N = 50
Working corr. structure

N = 100
Working corr. structure

Indep AR(1) Exch
0.012
0.026
0.006
0.008
0.009
0.008
0.005
0.007
0.004
0.010
0.030
0.008
0.011
0.012
0.012
0.004
0.007
0.004
0.009
0.029
0.008
0.011
0.011
0.011
0.004
0.007
0.004

UN
0.006
0.009
0.004
0.009
0.013
0.004
0.008
0.011
0.004

Indep AR(1) Exch
0.005
0.006
0.000
0.004
0.004
0.000
0.002
0.002
0.000
0.005
0.014
0.004
0.006
0.006
0.006
0.002
0.003
0.002
0.004
0.005
0.004
0.005
0.005
0.005
0.002
0.002
0.002

UN
0.003
0.004
0.002
0.004
0.006
0.002
0.004
0.005
0.002

Table B7.: Mean squared error values of parameters for the case of unbalanced lon-
gitudinal count data with diﬀerent sample sizes when true within-subject
correlation level is α = 0.2.

True
correlation Param.
structure

AR(1)

Exch

UN

β0
β1
β2
β0
β1
β2
β0
β1
β2

N = 50
Working corr. structure

N = 100
Working corr. structure

Indep AR(1) Exch
0.005
0.012
0.006
0.006
0.007
0.006
0.005
0.006
0.005
0.009
0.020
0.006
0.009
0.009
0.009
0.004
0.006
0.004
0.007
0.026
0.006
0.007
0.008
0.007
0.005
0.007
0.005

UN
0.006
0.008
0.006
0.007
0.009
0.005
0.006
0.008
0.005

Indep AR(1) Exch
0.003
0.005
0.000
0.003
0.003
0.000
0.002
0.002
0.000
0.003
0.010
0.003
0.004
0.004
0.004
0.002
0.004
0.003
0.003
0.004
0.003
0.004
0.004
0.004
0.002
0.002
0.002

UN
0.003
0.003
0.002
0.003
0.004
0.003
0.003
0.004
0.003

Table B8.: Mean squared error values of parameters for the case of unbalanced lon-
gitudinal count data with diﬀerent sample sizes when true within-subject
correlation level is α = 0.4.

True
correlation Param.
structure

AR(1)

Exch

UN

β0
β1
β2
β0
β1
β2
β0
β1
β2

N = 50
Working corr. structure

N = 100
Working corr. structure

Indep AR(1) Exch
0.010
0.029
0.007
0.008
0.009
0.008
0.005
0.007
0.005
0.013
0.029
0.009
0.012
0.013
0.012
0.004
0.007
0.005
0.010
0.034
0.008
0.011
0.011
0.011
0.004
0.008
0.005

UN
0.008
0.009
0.005
0.009
0.013
0.004
0.008
0.012
0.005

Indep AR(1) Exch
0.004
0.012
0.000
0.004
0.004
0.000
0.002
0.003
0.000
0.009
0.015
0.005
0.006
0.006
0.006
0.003
0.004
0.002
0.004
0.007
0.004
0.005
0.005
0.005
0.002
0.002
0.002

UN
0.003
0.004
0.002
0.004
0.006
0.002
0.004
0.005
0.002

28

