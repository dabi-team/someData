1
2
0
2

l
u
J

8
2

]

O
C
.
h
t
a
m

[

1
v
6
9
1
3
1
.
7
0
1
2
:
v
i
X
r
a

Anti-Ramsey numbers for trees in complete multi-partite graphs

Meiqiao Zhang∗and Fengming Dong†
National Institute of Education, Nanyang Technological University, Singapore

Abstract

Let G be a complete multi-partite graph of order n. In this paper, we consider the anti-
Ramsey number ar(G, Tq) with respect to G and the set Tq of trees with q edges, where
2 ≤ q ≤ n − 1. For the case q = n − 1, the result has been obtained by Lu, Meier and Wang.
We will extend it to q < n − 1. We ﬁrst show that ar(G, Tq) = ℓq(G) + 1, where ℓq(G) is the
maximum size of a disconnected spanning subgraph H of G with the property that any two
components of H together have at most q vertices. Using this equality, we obtain the exact
values of ar(G, Tq) for n − 3 ≤ q ≤ n − 1. We also compute ar(G, Tq) by a simple algorithm
when (4n − 2)/5 ≤ q ≤ n − 1.

1 Introduction

In this article, we consider simple graphs only. Given any graph G, let V (G) and E(G)

denote the vertex set and edge set of G, and let com(G) denote the number of its components.
If G1, G2, · · · , Gs are the components of G, where s = com(G), with |V (G1)| ≥ · · · ≥ |V (Gs)|,
let ori(G) = |V (Gi)| for all i = 1, 2, · · · , s. Thus, or1(G) ≥ or2(G) ≥ · · · ≥ ors(G) and
or1(G) + or2(G) + · · · + ors(G) = |V (G)|. Let Kp1,p2,··· ,pk denote the complete k-partite graph
whose partite sets’ sizes are p1, p2, · · · , pk respectively. For any 1 ≤ r ≤ |V (G)|, let Pr(G) be
the family of r-element subsets of V (G). For any vertex v ∈ V (G), let EG(v) be the set of
edges in G which are incident with v, NG(v) be the set of vertices in G which are adjacent to
v and dG(v) be the degree of v in G, i.e., the cardinality of NG(v). For any S ⊆ V (G), let
EG(S) =

v∈S EG(v) and let G[S] be the subgraph of G induced by S.

For a positive integer t, a t-edge-coloring of G is a surjective map from E(G) to {1, 2, · · · , t}.

S

Note that an edge coloring here is actually a partition of E(G), and it is probably not a proper

edge coloring of G. In an edge coloring of G, a subgraph H of G is called a rainbow subgraph

if the colors assigned to the edges in H are pairwise distinct.

For a graph G and a family C of graphs, the anti-Ramsey number with respect to G and

C, denoted by ar(G, C), is the maximum integer t such that there is a t-edge-coloring of G in

which every rainbow subgraph is not isomorphic to any graph in C. If no such edge coloring

∗Corresponding author. Email: nie21.zm@e.ntu.edu.sg and meiqiaozhang95@163.com.
†Email: fengming.dong@nie.edu.sg (expired on 24/03/2027) and donggraph@163.com.

1

 
 
 
 
 
 
exists, deﬁne ar(G, C) to be zero. The study of anti-Ramsey numbers was initiated by Erd˝os,

Simonovits and S´os [2]. Since then, a lot of research papers on this topic have been published.

See [4] for a survey and [1, 3, 10, 11] for some recent development on speciﬁc G or C.

In particular, a common type of C is related to trees. For example, the anti-Ramsey number

for edge disjoint spanning trees has been studied thoroughly, the exact value of which has been

obtained when G is a complete graph [5], a complete bipartite graph [6], and a complete multi-

partite graph in [9] very recently. Moreover, the anti-Ramsey number for edge disjoint spanning

trees in general graphs has also been determined in [9].

From a diﬀerent perspective, we will focus on another class of trees in the following.

This paper is motivated by the known results of ar(G, Tq) (see [7, 8]), where G is a complete
graph Kn or a complete bipartite graph Kp1,p2 and Tq is the set of subtrees in G with exactly q
edges. In [7], Jiang and West determined and obtained the exact value of ar(Kn, Tq) by proving
the equality that for 2 ≤ q ≤ n − 1,

ar(Kn, Tq) = ℓq(Kn) + 1,

(1.1)

where ℓq(G) is the maximum size of a disconnected spanning subgraph H of G in which every
two components together have at most q vertices (i.e., or1(H) + or2(H) ≤ q). A result similar
to (1.1) for ar(Kp1,p2, Tq) was obtained by Jin and Li [8], accompanying with exact values for
certain cases.

As a generalization, we consider the anti-Ramsey number ar(G, Tq), where G is a complete
k
i=1 pi and 2 ≤ q ≤ n − 1. Note that the exact value of
multi-partite graph Kp1,p2,··· ,pk, n =
ar(G, Tn−1) can be obtained as a corollary of the result in [9]. We will study the problem in a
diﬀerent approach. We ﬁrst extend the result (1.1) to ar(G, Tq) for any complete multi-partite
graph G and 2 ≤ q ≤ n − 1:

P

ar(G, Tq) = ℓq(G) + 1,

(1.2)

transforming the study of ar(G, Tq) to that of ℓq(G), which is a seemingly more numerical
invariant.

In this article, we calculate ar(G, Tq) via determining ℓq(G) for the two cases n−3 ≤ q ≤ n−1

and (4n − 2)/5 ≤ q ≤ n − 1. For both cases, we show that

ℓq(G) = |E(G)| −

min
S∈Pn−q+1(G)

|EG(S)|,

unless (G, q) is one of the ordered pairs below in the ﬁrst case:

(K3,3, 4), (K4,3, 4), (K3,3,3, 6).

(1.3)

(1.4)

The equality of (1.2) is established in Section 2. Let Sq(G) be the set of disconnected spanning
subgraphs H of G such that every two components of H together have at most q vertices and
Sq(G) be the subset of graphs in Sq(G) with the maximum size (i.e., ℓq(G)). In Section 3, we

2

show that Sq(G) contains a graph H with or1(H) + or2(H) = q and or2(H) = or3(H).
Section 4, we consider the case n − 3 ≤ q ≤ n − 1 and prove that (1.3) holds, unless (G, q) is an
|EG(S)| can be determined

ordered pair in (1.4). In Section 5, we get a conclusion that min

In

S∈Pr(G)

by a simple algorithm (i.e., Algorithm A in Section 5) of repeatedly choosing vertices with

the minimum degree. Applying the results obtained in Sections 4 and 5, we explicitly express
ar(G, Tq) for the case n − 3 ≤ q ≤ n − 1 in Section 6. The case (4n − 2)/5 ≤ q ≤ n − 1 is studied
in the last section (i.e. Section 7). For this case, ℓq(G) can be determined by (1.3) and thus it
can be calculated by Algorithm A.

Let χ(G) denote the chromatic number of graph G and δ(G) be the minimum degree among

all vertices of G. If H is a proper subgraph of G, write G \ H for G[V (G) \ V (H)]. Especially,
write G \ x for G[V (G) \ {x}]. Given a subset E′ of E(G), let G \ E′ be the spanning subgraph
of G with edge set E(G) \ E′. If E′ = {e′}, write G \ e′ for G \ E′.

2 The anti-Ramsey number ar(Kp1,··· ,pk, Tq)

In this section, we show that ar(Kp1,··· ,pk, Tq) = ℓq(Kp1,··· ,pk) + 1. We ﬁrst introduce three

lemmas.

Lemma 2.1. Let G be any connected graph of order n ≥ 3. For any q with 2 ≤ q ≤ n − 1,

ar(G, Tq) ≥ ℓq(G) + 1.

(2.1)

Proof. Let H ∈ Sq(G), i.e., H ∈ Sq(G) and |E(H)| = ℓq(G). Consider an (ℓq(G) + 1)-edge-
coloring of G which assigns distinct colors to all edges in H and a new color to all the edges in

E(G) \ E(H). We will show that it is an edge coloring without any rainbow subtree of q edges.

Let T be a subtree of G with q edges and q + 1 vertices. By the deﬁnition of Sq(G), for any
two components H1 and H2 of H, |V (H1)| + |V (H2)| ≤ q. Then T contains vertices from at
least three components of H, thus |E(T ) ∩ (E(G) \ E(H))| ≥ 2 and T is not rainbow.

As there is no rainbow subtree of q edges in this coloring, the conclusion holds.

✷

Given a t-edge-coloring c of a graph G, for any edge e ∈ E(G), denote the color of e by c(e).

A representing graph of the t-edge-coloring c is a rainbow spanning subgraph of G with precisely

t edges.

Lemma 2.2. Let G be any connected graph and c be a t-edge-coloring of G. Assume that H is
a representing graph of coloring c such that H has a component H1 with |V (H1)| ≥ or1(H ′) for
every representing graph H ′ of this coloring. If com(H) ≥ 2, then H1 has a bridge b.

Proof. Let H1, · · · , Hs be all the components of H, where s ≥ 2.

Since G is connected, there exists an edge e ∈ E(G) \ E(H) such that e joins a vertex u in
H1 to a vertex v in Hi, where 2 ≤ i ≤ s. As e is not in H and H is a representing graph of

3

coloring c, there must be a unique edge b in E(H) such that c(b) = c(e). We will show b is a
bridge of H1.

Let H ′ be the spanning subgraph of G obtained from H by removing edge b and adding edge
e. H ′ is also a representing graph for coloring c. If either b is not in H1 or b is in H1 but b is not
a bridge of H1, then H ′ has a component including vertex v and all the vertices of H1, whose
order is strictly larger than |V (H1)|, a contradiction to the selection of H.

Hence H1 has a bridge b.

✷

The following result due to Jiang and West [7] will also be applied in the proof of Theorem 2.4.

Lemma 2.3 ([7]). Every connected graph G contains a vertex w such that for each e ∈ E(G),
the component of G − e containing w has at least |V (G)|/2 vertices.

Now we can prove the main result in this section.

Theorem 2.4. For any positive integers k, p1, p2, · · · , pk, q with k ≥ 2 and 2 ≤ q ≤

ar(Kp1,··· ,pk, Tq) = ℓq(Kp1,··· ,pk) + 1.

k
i=1 pi − 1,

P

(2.2)

k
i=1 pi and X1, X2, · · · , Xk be the partite sets of Kp1,··· ,pk with |Xi| = pi for
Proof. Let n =
all i = 1, 2, · · · , k. According to Lemma 2.1, ar(Kp1,··· ,pk, Tq) ≥ ℓq(Kp1,··· ,pk) + 1. Thus, we only
need to prove ar(Kp1,··· ,pk , Tq) ≤ ℓq(Kp1,··· ,pk) + 1.

P

Let t = ar(Kp1,··· ,pk , Tq) and G denote Kp1,··· ,pk. We will show that for any t-edge-coloring

of G, if there is no rainbow subtree of q edges, then t ≤ ℓq(G) + 1.

Now let c be any t-edge-coloring of G without rainbow trees of q edges and choose a repre-
senting graph H of coloring c such that or1(H) ≥ or1(H ′) for every representing graph H ′ of
this coloring.

Let H1 be a component of H with |V (H1)| = or1(H). By Lemma 2.1, |E(H)| = t ≥ 1, thus
|V (H1)| ≥ 2. Moreover, since there is no rainbow tree of q edges in coloring c, |V (H1)| ≤ q ≤
n − 1, implying that H has more than one component. Let H2, · · · , Hs be the components of
H other than H1, with |V (Hi)| = ori(H) for i = 2, · · · , s, where s ≥ 2.

We will show t ≤ ℓq(G) + 1 by the following two cases.

Claim 1: If |V (H2)| = 1, then t ≤ ℓq(G) + 1.

Proof. As G is connected, there must be an edge e = xz ∈ E(G) \ E(H), where z ∈ V (H1) and
x ∈ V (G) \ V (H1).

components of H1 \ b by H (1)
1

By Lemma 2.2, there is a bridge b ∈ E(H1) with c(e) = c(b). Denote the two connected
1 , as shown in Figure 1.
Let H ∗ be the spanning subgraph of G obtained from H by deleting edge b. Note that the

and H (2)

components of H ∗ are H (1)

1 , H (2)

1 , H2, · · · , Hs.

Since or2(H) = |V (H2)| = 1, we have |V (Hp)| = 1 for all p = 2, 3, · · · , s. Thus,

or1(H ∗) + or2(H ∗) = |V (H (1)

1 )| + |V (H (2)

1 )| = |V (H1)| ≤ q.

(2.3)

4

H (1)
1

b

H (2)
1

z

e

x

Figure 1: H (1)

1

and H (2)

1

are the components of H1 \ b, and x ∈ V (G) \ V (H1)

Hence H ∗ ∈ Sq(G) and t = |E(H)| = |E(H ∗)| + 1 ≤ ℓq(G) + 1. Claim 1 holds.

♮

Claim 2: If |V (H2)| ≥ 2, then t ≤ ℓq(G) + 1.

Proof. By Lemma 2.3, H1 contains a vertex u, such that for each e ∈ E(H1), the component of
H \ e containing u has at least |V (H1)|/2 vertices. Assume u ∈ V (H1) ∩ Xi for some i, where
1 ≤ i ≤ k.

Since H2 is connected and |V (H2)| ≥ 2, we have V (H2) 6⊆ Xi. Let w ∈ V (H2) \ Xi. Then

uw ∈ E(G).

By Lemma 2.2, there is a bridge b ∈ E(H1) with c(uw) = c(b). Denote the two connected

components of H1 \ b by H (1)
1

and H (2)

1 with u ∈ H (1)

1 , as shown in Figure 2.

H (1)
1

u

b

w

H (2)
1

Figure 2: H (1)

1

and H (2)

1

are the components of H1 \ b, and w ∈ V (H2)

Let H ′ be the graph obtained from H by deleting edge b and adding edge uw. H ′ is also a
and

representing graph of coloring c with a component which consists of vertices in both H (1)
H2. By the assumptions of H and H1, we have

1

|V (H (1)

1 )| + |V (H2)| ≤ |V (H1)| = |V (H (1)

1 )| + |V (H (2)

1 )|,

implying that |V (H (2)

1 )| ≥ or2(H).

Let H ∗ be the spanning subgraph of G obtained from H by deleting edge b. Note that H ∗

has components H (1)

1 , H (2)

1 , H2, · · · , Hs.

1 )| ≥ |V (H (2)
Due to the choice of u, |V (H (1)
1 )|. Together with the fact that |V (H (1)

|V (H (2)
H ∗ ∈ Sq(G). Hence t = |E(H)| = |E(H ∗)| + 1 ≤ ℓq(G) + 1 and Claim 2 holds.

1 )|. Hence or1(H ∗) = |V (H (1)
1 )| + |V (H (2)

1 )| and or2(H ∗) =
1 )| = |V (H1)| ≤ q, we conclude that
♮

By Claims 1 and 2, ar(Kp1,··· ,pk, Tq) ≤ ℓq(Kp1,··· ,pk) + 1, and thus the result holds.

✷

5

3 Preparation work

To get the exact value of ℓq(Kp1,··· ,pk ), we shall give some lemmas based on the properties of

multi-partite graphs and ℓq(G) in this section.

Lemma 3.1. Let G be a complete multi-partite graph, and let V1 and V2 be disjoint subsets of
V (G). If |V1| ≥ |V2| and V1 ∪ V2 is not an independent set of G, then there exists a vertex u ∈ V2
such that |NG(u) ∩ V1| ≥ |NG(u) ∩ V2|, where the inequality is strict when either |V1| > |V2| or
χ(G[V2]) < χ(G[V1 ∪ V2]).

Proof. Since G is a complete multi-partite graph, G′ := G[V1 ∪ V2] is also a complete multi-
partite graph. Assume that X1, X2, · · · , Xk are the partite sets of G′, where k = χ(G′), and
Yi = V1 ∩ Xi and Zi = V2 ∩ Xi for all i = 1, 2, · · · , k. Since V1 ∪ V2 is not an independent set of
G′, k ≥ 2.

Let r := χ(G′[V2]). We may assume that Zi 6= ∅ for all i = 1, 2, · · · , r. Then Zi = ∅ and

Yi = Xi for all r + 1 ≤ i ≤ k.

If r = 1, then for each u ∈ V2, |NG′(u) ∩ V2| = 0 and |NG′(u) ∩ V1| = |V1 \ X1| > 0, and the

result is trivial. Now assume that r ≥ 2. Note that

1
r − 1

r

r

(|V2 \ Zi|) =

|Zi| = |V2|

i=1
X

i=1
X
≤ |V1|

r

k

|Yi| +

|Yi|

=

=

≤

i=1
X
1
r − 1

1
r − 1

i=r+1
X

r

(|V1 \ Yi|) −

i=1
X
r

(|V1 \ Yi|),

i=1
X

1
r − 1

k

|Yi|

i=r+1
X

(3.1)

where the inequality above is strict when either |V1| > |V2| or r < k. Thus, there exists
i : 1 ≤ i ≤ r such that

|V1 \ Yi| ≥ |V2 \ Zi|,

where the inequality is strict when either |V1| > |V2| or r < k. Let u ∈ Zi. Observe that

|NG′(u) ∩ V1| − |NG′(u) ∩ V2| = |V1 \ Yi| − |V2 \ Zi| ≥ 0,

(3.2)

where the inequality is strict when either |V1| > |V2| or r < k.

The result holds.

✷

Lemma 3.2. Let G be a complete multi-partite graph. For disjoint subsets V1 and V2 of V (G),
if χ(G[V2]) = r and χ(G[V1 ∪ V2]) = k, then there exists u ∈ V2 such that |NG(u) ∩ V1| ≥
(r−1)|V1|+k−r
r

≥ (r−1)|V1|
r

.

6

Proof. Note that G′ := G[V1 ∪ V2] is a complete k-partite graph. Assume that X1, X2, · · · , Xk
are the partite sets of G′. Let Yi := V1 ∩ Xi and Zi := V2 ∩ Xi for all i = 1, 2, · · · , k. Since
χ(G[V2]) = r, we may assume that Zi 6= ∅ for all i = 1, 2, · · · , r. Then Zi = ∅ and Yi = Xi for
r + 1 ≤ i ≤ k. Note that

k

r

|V1| =

|Yi| ≥ (k − r) +

|Yi|,

i=1
X

i=1
X

by which |Yi| ≤ |V1|−k+r
holds for some i with 1 ≤ i ≤ r. Let u ∈ Zi. As G′ is a complete
k-partite graph with partite sets X1, X2, · · · , Xk and u ∈ Xi, u is adjacent to all vertices in
V1 \ Yi, implying that

r

|NG(u) ∩ V1| = |V1| − |Yi| ≥ |V1| −

|V1| − k + r
r

.

The result holds.

✷

Lemma 3.3. For any graph Q with components Q1, Q2, · · · , Qs, if χ(Q) = t, then there exists
one vertex ui in Qi for each i ∈ [s] such that

dQ(ui) ≤

t − 1
t

|V (Q)|.

s

i=1
X

(3.3)

Proof. We ﬁrst show it for s = 1. Let U1, U2, · · · , Ut be the color classes of a proper t-coloring
with |U1| ≥ |U2| ≥ · · · ≥ |Ut|. Then, for each vertex u ∈ U1, we have

t

dQ(u) ≤

|Ui| ≤

i=2
X

t − 1
t

|V (Q)|.

(3.4)

By (3.4), there exists vertex ui in Qi for all i ∈ [s] such that

s

i=1
X

s

dQ(ui) =

dQi(ui) ≤

i=1
X

s

i=1
X

χ(Qi) − 1
χ(Qi)

|V (Qi)| ≤

t − 1
t

s

i=1
X

|V (Qi)| ≤

t − 1
t

|V (Q)|.

(3.5)

✷

Lemma 3.4. Let G be a connected graph of order n ≥ 3 and q be an integer with 2 ≤ q ≤ n − 1.
For any H ∈ Sq(G), com(H) ≥ 3 holds, and if H ∈ Sq(G), then

(i) each component of H is a vertex-induced subgraph of H; and

(ii) when or1(H) ≥ or1(H ′) for every graph H ′ ∈ Sq(G), then either or1(H) + or3(H) = q or
|NG(u)∩V (H2)| > |NG(u)∩V (H1)| for each u ∈ V (H2), where H1 and H2 are components
of H with |V (Hi)| = ori(H) for i = 1, 2.

Proof. Let s = com(H) and H1, H2, · · · , Hs be the components of H with |V (Hi)| = ori(H) for
i = 1, 2, · · · , s. As H ∈ Sq(G), |V (H1)| + |V (H2)| ≤ q < n, implying that s ≥ 3.

Now assume that ℓq(G) = |E(H)|. (i) is trivial.

7

(ii). Assume |V (H1)| ≥ or1(H ′) for every H ′ ∈ Sq(G). Suppose (ii) fails. Then |V (H1)| +

|V (H3)| < q and |NG(u) ∩ V (H1)| ≥ |NG(u) ∩ V (H2)| for some u ∈ V (H2).

Note that |NG(u) ∩ V (H2)| ≥ 1, i.e., |V (H2)| ≥ 2. Otherwise, |V (H2)| = |V (H3)| = 1,
|V (H1)| ≤ q − 2 and |E(H)| = |E(H1)|. Since G is connected, there exists an edge uv ∈ E(G),
where u ∈ V (H1) and v ∈ V (G) \ V (H1). Let H ′ be a spanning subgraph of G with edge set
E(G[V (H1) ∪ {v}]). Then or1(H ′) ≤ q − 1 and or2(H ′) = 1, thus H ′ ∈ Sq(G), a contradiction
to the assumption of H ∈ Sq(G) as |E(H ′)| > |E(H)|.

Let H ′

1 denote the subgraph G[V (H1)∪{u}] and H ′ be the graph obtained from H by adding
all edges in {uv : v ∈ NG(u) ∩ V (H1)} and deleting all edges in {uv : v ∈ NG(u) ∩ V (H2)}. Since
|NG(u) ∩ V (H1)| ≥ |NG(u) ∩ V (H2)| ≥ 1, H ′
1)| = |V (H1)| + 1.
Moreover,

1 is connected and or1(H ′) = |V (H ′

|E(H ′)| − |E(H)| = |NG(u) ∩ V (H1)| − |NG(u) ∩ V (H2)| ≥ 0,

and or2(H ′) ≤ max{|V (H2)| − 1, |V (H3)|}. Thus,

or1(H ′) + or2(H ′) ≤ max{|V (H1)| + |V (H2)|, |V (H1)| + 1 + |V (H3)|} ≤ q,

implying that H ′ ∈ Sq(G). As |E(H ′)| ≥ |E(H)| = ℓq(G), we have H ′ ∈ Sq(G), a contradiction
to the assumption of H as or1(H ′) > or1(H).

(ii) holds.

✷

For any two ﬁnite sequences (a1, a2, · · · , as) and (b1, b2, · · · , bt), write (a1, a2, · · · , as) (cid:23)
(b1, b2, · · · , bt) if either s = t and ai = bi for all i = 1, 2, · · · , s, or there exists i : 1 ≤ i ≤ min{s, t}
such that ai > bi and aj = bj for all 1 ≤ j < i. If a1+a2+· · ·+as = b1+b2+· · ·+bt and all ai’s and
bj’s are positive, then either (a1, a2, · · · , as) (cid:23) (b1, b2, · · · , bt) or (b1, b2, · · · , bt) (cid:23) (a1, a2, · · · , as).

For any graph H, let Seq−or(H) denote the sequence (or1(H), or2(H), · · · , ors(H)), where
s = com(H). If H and H ′ are spanning subgraphs of G, then either Seq−or(H) (cid:23) Seq−or(H ′)
or Seq−or(H ′) (cid:23) Seq−or(H). Obviously, if Seq−or(H) (cid:23) Seq−or(H ′), then or1(H) ≥ or1(H ′).

Theorem 3.5. Let G be a complete multi-partite graph of order n with at least two partite sets.
Assume that 2 ≤ q ≤ n − 1 and H is a graph in Sq(G) such that or1(H) ≥ or1(H ′) for every
H ′ ∈ Sq(G). The following hold:

(i) or1(H) + or3(H) = q; and

(ii) if Seq−or(H) (cid:23) Seq−or(H ′) holds for every H ′ ∈ Sq(G), then Seq−or(H) is a sequence of

the following form:

(h1, h2, · · · , h2

, h3)

t

where t ≥ 1, h1 ≥ h2 ≥ h3, and h3 = h2 when t = 1; or a sequence of the following form:
{z

}

|

(h1, h2, · · · , h2

, 1, · · · , 1

)

t2

}

| {z }

|

t1

{z
8

where t1, t2 ≥ 2 and h1 ≥ h2 ≥ 2.

Proof. Let s = com(H) and H1, H2, · · · , Hs be the components of H with |V (Hi)| = ori(H) for
i = 1, 2, · · · , s, where s ≥ 3 by Lemma 3.4.

(i). The result is trivial when q = 2. Assume q ≥ 3 in the following.

Suppose that or1(H) + or3(H) < q. Then, Lemma 3.4 (ii) implies that |NG(u) ∩ V (H2)| >
|NG(u) ∩ V (H1)| for each u ∈ V (H2). But, as |V (H1)| ≥ |V (H2)|, due to Lemma 3.1, V (H1) ∪
V (H2) is an independent set in G. Thus |V (H1)| = |V (H2)| = 1 and for u ∈ V (H2), |NG(u) ∩
V (H2)| = |NG(u) ∩ V (H1)| = 0, a contradiction. (i) holds.

(ii). We ﬁrst prove the following claim.

Claim 1: for any 5 ≤ b ≤ s, if orb−1(H) < or2(H), then orb−1(H) = 1.

Proof. Suppose the claim fails. Then, there exists b with 5 ≤ b ≤ s such that 2 ≤ orb−1(H) <
or2(H), i.e., 2 ≤ |V (Hb−1)| < |V (H2)|.

By Lemma 3.1, there exists u ∈ V (Hb) such that |NG(u) ∩ V (Hb)| ≤ |NG(u) ∩ V (Hb−1)|.
Let H ′ be the graph obtained from H by adding all edges in {uv : v ∈ NG(u) ∩ V (Hb−1)} and
deleting all edges in {uv : v ∈ NG(u) ∩ V (Hb)}. Obviously, |E(H ′)| ≥ |E(H)|.

Let H ′

b−1 be the subgraph G[V (Hb−1) ∪ {u}]. Since |V (Hb−1)| ≥ 2 and G is a complete

k-partite graph, H ′

b−1 is connected.

Thus, the components of H ′ are H1, H2, · · · , Hb−2, H ′
ponents of Hb \ {u}, implying that Seq−or(H) 6(cid:23) Seq−or(H ′).

b−1, Hb+1, · · · , Hs together with com-

By the given condition, |V (H ′

b−1)| = |V (Hb)| + 1 ≤ |V (H2)|. Thus, H ′ ∈ Sq(G). As
|E(H ′)| ≥ |E(H)|, H ∈ Sq(G). However, Seq−or(H) 6(cid:23) Seq−or(H ′), a contradiction to the
assumption of H.

Hence Claim 1 holds.

♮

Let ori(H) = hi for i = 1, 2. By the result in (i), we have or3(H) = h2. If ors−1(H) = h2,
If ors−1(H) < h2, then

, h3), where h3 = ors(H) ≤ h2.

then Seq−or(H) = (h1, h2, · · · , h2

t

s ≥ 5 and there exists 5 ≤ b ≤ s such that orb(H) ≤ orb−1(H) < or2(H) = h2 and
orb−2(H) = or2(H). In this case, due to Claim 1, orb−1(H) = 1, implying that Seq−or(H) =
(h1, h2, · · · , h2

), where t1, t2 ≥ 2.

, 1, 1, · · · , 1

{z

}

|

}

}

|

t1

{z

{z

t2
Hence (ii) holds.
|
For a complete multi-partite graph G of order n and 2 ≤ q ≤ n − 1, let H be a member
in Sq(G) such that Seq−or(H) (cid:23) Seq−or(H ′) holds for every H ′ ∈ Sq(G). By Theorem 3.5,
h1 + h2 = q and h1 + 2h2 ≤ n, thus 1 ≤ h2 ≤ min{q/2, n − q} and we can express all the
possible sequences according to the value of h2. For example, if n = 13 and q = 8, then,
1 ≤ h2 ≤ min{8/2, 13 − 8} = 4, and Seq−or(H) is one of the sequences below:

✷

(4, 4, 4, 1), (5, 3, 3, 2), (5, 3, 3, 1, 1), (6, 2, 2, 2, 1), (6, 2, 2, 1, 1, 1), (7, 1, 1, 1, 1, 1, 1).

9

4 To ﬁnd ℓq(Kp1,··· ,pk) for n − 3 ≤ q ≤ n − 1

In this section, we consider the case n − 3 ≤ q ≤ n − 1, and show that (1.3) holds unless

(G, q) is an ordered pair in (1.4).

Let G be a connected graph of order n and q be an integer with 2 ≤ q ≤ n − 1. Recall that

for any S ⊆ V (G), EG(S) =

v∈S EG(v). Clearly,

S
|E(G)| − min

S0∈Pr(G)

|EG(S0)| = max

S∈Pn−r(G)

|E(G[S])|.

(4.1)

For any S ∈ Pq−1(G), the spanning subgraph H of G with edge set E(G[S]) has at least n−q +2
components, i.e., G[S] and n − q + 1 trivial components, and thus it belongs to Sq(G). Hence

ℓq(G) ≥ max

S∈Pq−1(G)

|E(G[S])| = |E(G)| −

min
S0∈Pn−q+1(G)

|EG(S0)|

(4.2)

It can be veriﬁed that the inequality of (4.2) is strict when (G, q) is one of the following ordered

pairs:

(K3,3, 4), (K4,3, 4), (K3,3,3, 6).

(4.3)

For example, if G = K3,3,3 and q = 6, then ℓq(G) ≥ 9, as Sq(G) has a graph consisting of three
components each of which is isomorphic to K3, while each 5-vertex subgraph of G has at most
8 edges. Similarly, if G = K3,3 or K4,3 and q = 4, each 3-vertex subgraph of G has at most 2
edges, while Sq(G) has a graph containing 3 edges.

Now we shall show that if G is a complete multi-partite graph of order n and max{2, n−3} ≤

q ≤ n − 1, then the equality of (4.2) holds if and only if (G, q) is not an ordered pair in (4.3).
Thus, by applying Theorem 2.4, ar(G, Tq) can be determined.

Theorem 4.1. Let G denote Kp1,p2,··· ,pk and n = p1 + p2 + · · · + pk, where k ≥ 2 and p1 ≥ p2 ≥
· · · ≥ pk ≥ 1. For n − 3 ≤ q ≤ n − 1, if q ≥ 2 and (G, q) is not an ordered pair in (4.3), then

ℓq(G) = |E(G)| −

min
S∈Pn−q+1(G)

|EG(S)|.

(4.4)

Proof. Suppose that (4.4) is not true. Then, the inequality of (4.2) is strict.

Assume that (G, q) is not one of the ordered pairs in (4.3) and H is a graph in Sq(G) such
that or1(H) ≥ or1(H ′) for every H ′ ∈ Sq(G). Let H1, H2, · · · , Hs be the components of H with
|V (Hi)| = ori(H) for i = 1, 2, · · · , s, where s ≥ 3 by Lemma 3.4.

Let r = n − q. Then 1 ≤ r ≤ 3.

Claim 1: |E(H)| > |E(H0)| holds for every subgraph H0 of G with |V (H0)| ≤ q −1 (= n−r−1).

Proof. As |E(H)| = ℓq(G) and (4.4) fails, the inequality of (4.2) is strict, and thus the claim
♮
follows.

Claim 2: |V (H2)| ≥ 2.

Proof. Suppose that |V (H2)| = 1. Observe that |E(H1)| = |E(H)|. As H ∈ Sq(G), we have

10

|V (H1)| ≤ q − |V (H2)| = q − 1. It contradicts Claim 1. Claim 2 holds.

Claim 3: |V (H1)| + |V (H2)| = q and |V (H2)| = |V (H3)| ≤ r.

Proof. Claim 3 follows from Theorem 3.5 (i).

Claim 4: r > 1.

♮

♮

Proof. If r = 1, then by Claim 3, |V (H2)| = 1, a contradiction to Claim 2, thus Claim 4 holds. ♮

Claim 5: r 6= 2.

Proof. Suppose that r = 2. By Claims 2 and 3, |V (H2)| = |V (H3)| = 2 and |V (H1)| + |V (H2)| +
|V (H3)| = n, thus s = 3, both H2, H3 are isomorphic to K2 and |E(H)| = |E(H1)| + 2.

We are now going to show that |V (H1)| = 2. Suppose that |V (H1)| > |V (H2)|. As |V (H2)| =
2, by Lemma 3.1, there exists a vertex u ∈ V (H2) such that |NG(u) ∩ V (H1)| ≥ 1 + |NG(u) ∩
V (H2)| = 2.

Let H0 be the subgraph G[V (H1) ∪ {u}]. Observe that |V (H0)| = |V (H1)| + 1 = n − 3 =

n − r − 1 and

a contradiction to Claim 1.

|E(H0)| ≥ |E(H1)| + 2 = |E(H)|,

Hence |V (H1)| = 2, implying that |E(H)| = 3 and n = |V (H)| = 6. Thus, n − r − 1 = 3. If
k ≥ 3, then G contains a subgraph H0 isomorphic to K3, a contradiction to Claim 1. Thus k = 2.
The three edges in H form a perfect matching of G, implying that G ∼= K3,3, a contradiction to
the assumption of G.

Claim 5 holds.

Claim 6: If r = 3, then s ≤ 3.

♮

Proof. Suppose that r = 3 and s ≥ 4. By Claims 2 and 3, 2 ≤ |V (H2)| = |V (H3)| ≤ 3 and
n − |V (H1)| − |V (H2)| = r = 3, implying s ≤ 4. Thus s = 4, |V (H2)| = |V (H3)| = 2 and
|V (H4)| = 1.

We are now going to show that |V (H1)| = 2. Suppose that |V (H1)| ≥ 3 > |V (H2)|.

As |V (H2)| = 2, by Lemma 3.1, there exists a vertex u ∈ V (H2) such that |NG(u)∩V (H1)| ≥
1 + |NG(u) ∩ V (H2)| = 2. Let H0 be the subgraph G[V (H1) ∪ {u}]. Observe that |V (H0)| =
|V (H1)| + 1 = n − 4 = n − r − 1 and

|E(H0)| ≥ |E(H1)| + 2 = |E(H)|,

a contradiction to Claim 1.

Hence |V (H1)| = 2, implying that |E(H)| = 3 and n = 7.

Suppose that k ≥ 3. Let H0 be a subgraph isomorphic to K3. Observe that |E(H0)| = 3 =

|E(H)| and |V (H0)| = 3 = n − 4 = n − r − 1, a contradiction to Claim 1.

Thus, k = 2. As H has a matching of size 3 and n = 7, G is isomorphic to K4,3, a

contradiction to the assumption of G.

Claim 6 holds.

♮

11

Claim 7: r 6= 3.

Proof. Suppose that r = 3. By Claim 6, s = 3 and |V (H2)| = |V (H3)| = 3 by Claims 2 and 3,
implying that Hi is isomorphic to K3 or P3 (the path of order 3) for i = 2, 3.

We ﬁrst show that |V (H1)| = 3. Suppose that |V (H1)| ≥ 4.

For 2 ≤ i ≤ 3, as |V (H1)| > |V (Hi)| = 3, by Lemma 3.1, there exists a vertex ui ∈ V (Hi)
such that |NG(ui) ∩ V (H1)| ≥ 1 + |NG(ui) ∩ V (Hi)| ≥ |E(Hi)|. Let H0 = G[V (H1) ∪ {u2, u3}].
Observe that

|E(H0)| = |E(H1)| +

|NG(ui) ∩ V (H1)| ≥ |E(H1)| + |E(H2)| + |E(H3)| = |E(H)|

3

i=2
X

and |V (H0)| = |V (H1)| + 2 = n − 4 = n − r − 1, a contradiction to Claim 1.

Hence |V (H1)| = 3, implying that n = 9 and 6 ≤ |E(H)| ≤ 9.

If k ≥ 4, then G must have a subgraph H0 isomorphic to K5 − e, the graph obtained from K5
by removing one edge. Note that |V (H0)| = 5 = n − 4 = n − r − 1 and |E(H0)| = 9 ≥ |E(H)|,
a contradiction to Claim 1.

Thus, k ≤ 3. If p2 = 1, then p3 = 1, a contradiction to the fact that H has three vertex-

disjoint paths of length 2. Hence p2 ≥ 2.

If |E(H)| = 9, then Hi ∼= K3 for all i = 1, 2, 3, implying that k = 3 and G ∼= K3,3,3, a

contradiction to the assumption of G.

Now assume that |E(H)| ≤ 8. If k = 3, as p2 ≥ 2, G has a subgraph H0 isomorphic to K2,2,1,
implying that |E(H0)| ≥ 8 ≥ |E(H)|. But, |V (H0)| = 5 = n − 4 = n − r − 1, a contradiction to
Claim 1.

Hence k = 2, and each Hi is isomorphic to P3 (i.e., the path graph of length 2), implying
that |E(H)| = 6. As p2 ≥ 2, G has a subgraph H0 isomorphic to K3,2, implying that |E(H0)| =
6 = |E(H)| and |V (H0)| = 5 = n − 4 = n − r − 1, a contradiction to Claim 1.

Claim 7 holds.

As r = n − q, the result follows from Claims 4, 5, 6 and 7.

♮

✷

5 To ﬁnd min

S∈Pr(G)

|EG(S)| for a complete multi-partite graph G

In this section, we shall show that for a complete multi-partite graph G, min

|EG(S)| is
equal to |EG(S0)| for every set S0 ∈ Pr(G) obtained by a simple algorithm (i.e. Algorithm A).

S∈Pr(G)

For any graph G of order n and any integer r with 1 ≤ r ≤ n, let P ∗

r (G) denote the family
of subsets S ∈ Pr(G) obtained by the following “greedy” algorithm. Note that this algorithm
chooses one vertex by one vertex and always chooses a vertex of the minimum degree in the

remaining graph.

Algorithm A:

12

Step 1 Set i := 1, S := ∅ and G1 := G;

Step 2 Choose a vertex u from Gi of degree δ(Gi);

Step 3 Set S := S ∪ {u};

Step 4 If i = r, then output S and STOP; otherwise, set i := i + 1 and Gi := Gi−1 \ {u}, and

return to Step 2.

In the following, we shall show that if G is a complete multi-partite graph, then P ∗

r (G) is

exactly the set of elements S0 ∈ Pr(G) such that

|EG(S0)| = min

S∈Pr(G)

|EG(S)|.

(5.1)

We ﬁrst establish the following conclusion.

Lemma 5.1. Let G be a complete k-partite graph of order n with partite sets X1, X2, · · · , Xk,
where k ≥ 2. Assume that T0 ∈ Pb(G), where 1 ≤ b ≤ n. Then, |E(G[T0])| ≥ |E(G[T ])| holds
for every T ∈ Pb(G) if and only if for each pair of distinct numbers i, j ∈ {1, 2, · · · , k}, if
|Xi ∩ T0| ≥ |Xj ∩ T0| + 2, then Xj ⊆ T0.

Proof. Let pi = |Xi| for all i = 1, 2, · · · , k. Assume that p1 ≥ p2 ≥ · · · ≥ pk ≥ 1. Let a0 = 0,
and for j = 1, 2, · · · , p1, let aj = max{1 ≤ i ≤ k : pi ≥ j}. For example, if k = 3, p1 = 4, p2 = 3
and p3 = 1, then, a1 = 3, a2 = 2, a3 = 2 and a4 = 1. In order to complete the proof, we shall
show the equivalence of the following three statements for any T0 ∈ Pb(G):

(i) |E(G[T0])| ≥ |E(G[T ])| holds for every T ∈ Pb(G);

(ii) for each pair of distinct numbers i, j ∈ {1, 2, · · · , k}, if |Xi ∩ T0| ≥ |Xj ∩ T0| + 2, then

Xj ⊆ T0.

(iii) let h be the unique number in {1, 2, · · · , p1} determined by the inequality: a1 + a2 + · · · +
ah−1 < b ≤ a1 + a2 + · · · + ah−1 + ah. Then, G[T0] is isomorphic to Kq1,q2,··· ,qk, where
qi = pi when pi ≤ h − 2, and h − 1 ≤ qi ≤ h otherwise. Furthermore, there are exactly
b − (a1 + · · · + ah−1) indices i : 1 ≤ i ≤ k such that qi = h.

(i) ⇒ (ii). Assume that T0 ∈ Pb(G) such that |E(G[T0])| ≥ |E(G[T ])| holds for every
T ∈ Pb(G). As G is a complete k-partite graph, for any U ⊆ V (G), G[U ] is also a complete
multi-partite graph, and its size is

|E(G[U ])| =

|U |
2 å

Ç

−

k

i=1 Ç
X

|U ∩ Xi|

.
2 å

(5.2)

Suppose that there is a pair of distinct numbers i, j ∈ {1, 2, · · · , k}, such that Xj 6⊆ T0 and
|Xj ∩ T0| ≤ |Xi ∩ T0| − 2. Let v ∈ Xj \ T0 and v′ ∈ Xi ∩ T0. For T ′ = (T0 \ {v′}) ∪ {v} ∈ Pb(G),

13

by (5.2),

|E(G[T ′])| − |E(G[T0])| =

|T0 ∩ Xi|
2

+

|T0 ∩ Xj|
2

|T0 ∩ Xi| − 1
2

å

−

Ç

Ç

å
= |T0 ∩ Xi| − |T0 ∩ Xj| − 1 > 0,

å

Ç

−

Ç

|T0 ∩ Xj| + 1
2

å
(5.3)

a contradiction to the given condition. Thus, (i) ⇒ (ii) holds.

(ii) ⇒ (iii). Without loss of generality, assume that h := |X1 ∩ T0| ≥ |Xj ∩ T0| for all
j = 2, 3, · · · , k. By the given condition, for any 2 ≤ j ≤ k, |Xj ∩ T0| ≥ |X1 ∩ T0| − 1 = h − 1,
unless Xj ⊆ T0. Thus, if pj ≤ h − 2, then Xj ⊆ T0. Obviously, h is the unique number satisfying
the inequality below:

a1 + a2 + · · · + ah−1 < b ≤ a1 + a2 + · · · + ah−1 + ah,

and

|{1 ≤ j ≤ k : |Xj ∩ T0| = h}| = b − (a1 + a2 + · · · + ah−1).

(5.4)

Note that G[T0] is a complete multi-partite graph with partite sets T0 ∩ Xi for i = 1, 2, · · · , k,
where |T0 ∩ Xi| = |Xi| = pi whenever pi ≤ h − 2, and h − 1 ≤ |T0 ∩ Xi| ≤ h otherwise.
Furthermore, by (5.4), G[T0] has exactly b − (a1 + a2 + · · · + ah−1) partite sets T0 ∩ Xj of size
h. Thus (iii) holds.

(iii) ⇒ (i). Assume that condition (iii) is satisﬁed for T0. Assume that T ′ ∈ Pb(G) such
that |E(G[T ′])| ≥ |E(G[T ])| holds every T ∈ Pb(G). As (iii) follows from (i), condition (iii) is
satisﬁed for T ′. As both T0 and T ′ satisfy condition (iii), we have G[T ′] ∼= G[T0], implying that
|E(G[T ′])| = |E(G[T0])|, and thus |E(G[T0])| ≥ |E(G[T ])| holds for every T ∈ Pb(G). Hence
(iii) ⇒ (i) holds.

Therefore (i) ⇔ (ii) holds, and the result is proven.

✷

Theorem 5.2. Let G be a complete multi-partite graph of order n with at least two partite sets.
For any 1 ≤ r ≤ n and S0 ∈ Pr(G), S0 ∈ P ∗

r (G) if and only if

|EG(S0)| = min

S∈Pr(G)

|EG(S)|.

(5.5)

Proof. Let X1, X2, · · · , Xk be the partite sets of G, where k ≥ 2.

We need only to show that the following statements are equivalent for any S ∈ Pr(G):

(i) S ∈ P ∗

r (G);

(ii) for each pair of distinct numbers i, j in {1, 2, · · · , k}, if |Xi \ S| ≥ 2 + |Xj \ S|, then

Xj ∩ S = ∅;

(iii) |E(G \ S)| ≥ |E(G[T ])| for each T ∈ Pn−r(G); and

(iv) |EG(S)| ≤ |EG(S′)| for each S′ ∈ Pr(G).

14

The equivalence of (ii) and (iii) follows from Lemma 5.1 by taking T0 = V (G) \ S, while (iii)
and (iv) are equivalent by (4.1). It remains to prove that (i) and (ii) are equivalent.

Assume that S = {u1, u2, · · · , ur} ∈ P ∗

r (G), where us is the s-th vertex in S selected by

Algorithm A for s = 1, 2, · · · , r, and let Ss := {u1, u2, · · · , us} and Gs := G \ {u1, · · · , us−1}.

Suppose that (ii) fails. Then, there exist distinct numbers i, j in {1, 2, · · · , k} such that
Xj ∩ S 6= ∅ and |Xi \ S| ≥ 2 + |Xj \ S|. As Xj ∩ S 6= ∅, there exists uq ∈ S ∩ Xj. If |Xj ∩ S| ≥ 2,
we assume uq is chosen with the largest possible value of q.

As q is the largest number in {1, 2, · · · , r} such that uq ∈ Xj,

|Xi \ Sq−1| ≥ |Xi \ S| ≥ 2 + |Xj \ S| = 1 + |Xj \ Sq−1|.

Thus, for any u ∈ Xi \ Sq−1, we have

dGq (uq) = |V (Gq)| − |Xj \ Sq−1| ≥ |V (Gq)| − |Xi \ Sq−1| + 1 = dGq (u) + 1,

a contradiction to the condition that uq has the minimum degree in Gq. Thus (i) ⇒ (ii) holds.
Assume that condition (ii) is satisﬁed. Then for each pair of distinct numbers j, j′
in
{1, 2, · · · , k} such that Xj ∩ S 6= ∅ and Xj′ ∩ S 6= ∅, the diﬀerence between |Xj \ S| and
|Xj′ \ S| is at most one. Moreover, if Xi ∩ S = ∅ for some i ∈ {1, 2, · · · , k}, then

|Xi| = |Xi \ S| ≤ 1 + min{|Xj \ S| : Xj ∩ S 6= ∅, 1 ≤ j ≤ k}.

Note that the vertices in S can be determined by the following Algorithm.

Algorithm B:

Step 1. Set t := r and St := S;

Step 2. choose j : 1 ≤ j ≤ k such that Xj ∩ St 6= ∅ and |Xj \ St| ≤ |Xj′ \ St| for each j′ 6= j with

Xj′ ∩ St 6= ∅;

Step 3. let ut be a vertex in St ∩ Xj;

Step 4. if t = 1, then STOP; otherwise, set t := t − 1, St := St+1 \ {ut+1}, and go to Step 2.

Assume that u1, u2, · · · , ur are vertices in S determined by Algorithm B. Note that for each
t = 1, 2, · · · , r, St = {u1, · · · , ut} and ut has the minimum degree in G \ St−1, where S0 = ∅.
Hence, S ∈ P ∗

r (G) and (ii) ⇒ (i) holds.

The result is proven.

✷

Corollary 5.3. Let G denote Kp1,p2,··· ,pk and n = p1 + p2 + · · · + pk, where k ≥ 2. For
2 ≤ q ≤ n − 1, if ℓq(G) = |E(G)| − minS∈Pn−q+1(G) |EG(S)| , then,

ar(G, Tq) = 1 +

pipj − |EG(S0)|,

(5.6)

X1≤i<j≤k

15

where S0 ∈ P ∗

n−q+1(G).

Proof. The result follows from Theorems 2.4 and 5.2.

✷

6 To determine ar(Kp1,··· ,pk, Tq) for n − 3 ≤ q ≤ n − 1

In this section, we shall give an explicit expression for ar(Kp1,··· ,pk, Tq) when max{2, n − 3} ≤

q ≤ n − 1, where n = p1 + · · · + pk.

If (G, q) is an ordered pair in (4.3), ar(G, Tq) can be determined by applying Theorems 2.4

and 3.5 (ii) that

ar(G, Tq) = 1 + ℓq(G) =

4,

(

10,

if (G, q) = (K3,3, 4) or (K4,3, 4);
if (G, q) = (K3,3,3, 6).

(6.1)

For example, if (G, q) = (K4,3, 4) and H is a member in S4(K4,3) such that Seq−or(H) (cid:23)
Seq−or(H ′) for every H ′ ∈ S4(K4,3), then, by Theorem 3.5 (ii), Seq−or(H) is either (2, 2, 2, 1)
or (3, 1, 1, 1, 1), implying that ℓ4(K4,3) = 3. Similarly, if (G, q) = (K3,3,3, 6) and H is a member
in S6(K3,3,3) such that Seq−or(H) (cid:23) Seq−or(H ′) for every H ′ ∈ S6(K3,3,3), then, by Theo-
rem 3.5 (ii), Seq−or(H) is one of the sequences (3, 3, 3), (4, 2, 2, 1) or (5, 1, 1, 1, 1), implying that
ℓ6(K3,3,3) = 9.

In the following, we consider the case that G is a complete multi-partite graph of order n

and max{2, n − 3} ≤ q ≤ n − 1 such that (G, q) is not an ordered pair in (4.3).

Note that for any complete multi-partite graph G and u ∈ V (G), dG(u) = δ(G) if and only if
u is contained in a partite set with the largest cardinality. Now let G = Kp1,p2,··· ,pk with partite
sets X1, X2, · · · , Xk and n = |V (G)|, where k ≥ 2, p1 ≥ p2 ≥ · · · ≥ pk ≥ 1 and |Xi| = pi for all
i = 1, 2, · · · , k. Clearly, for any S = {x1, x2, · · · , xs} ⊆ V (G), if xi ∈ Xji for all i ∈ [s], then

s

s

|EG(S)| =

(n − pji) −

σ(ji2 − ji1 ) = sn −

pji −

σ(ji2 − ji1),

(6.2)

i=1
X

X1≤i1<i2≤s

i=1
X

X1≤i1<i2≤s

where σ(x) is the function deﬁned by σ(0) = 0 and σ(x) = 1 when x 6= 0. Then, for S ∈ P ∗
t (G),
where 2 ≤ t ≤ 4, |EG(S)| can be determined by applying Algorithm A and (6.2) as follows. If
S ∈ P ∗

2 (G),

|EG(S)| =

2n − 2p1,
2n − p1 − p2 − 1,

(

if p1 > p2;
if p1 = p2.

If S ∈ P ∗

3 (G),

3n − 3p1,
3n − 2p1 − p2 − 2,
3n − p1 − p2 − p3 − 3,

if p1 ≥ p2 + 2;
if p2 + 1 ≥ p1 ≥ p3 + 1;
if p1 = p2 = p3.

|EG(S)| = 




16

(6.3)

(6.4)

If S ∈ P ∗

4 (G),

|EG(S)| =

4n − 4p1,
4n − 3p1 − p2 − 3,
4n − 2p1 − 2p2 − 4,
4n − 2p1 − p2 − p3 − 5,

if p1 ≥ p2 + 3;
if p1 = p2 + 2 or p1 = p2 + 1 ≥ p3 + 2;
if p1 = p2 ≥ p3 + 1;
if p4 + 1 ≤ p1 ≤ p2 + 1 = p3 + 1;

(6.5)

4

4n −

pi − 6,

i=1
P

if p1 = p2 = p3 = p4.






Theorem 6.1. Let G denote Kp1,p2,··· ,pk and n = p1 + p2 + · · · + pk, where k ≥ 2 and p1 ≥ p2 ≥
· · · ≥ pk ≥ 1. For max{2, n − 3} ≤ q ≤ n − 1, if (G, q) is an ordered pair in (4.3), then ar(G, Tq)
is given in (6.1); otherwise,

ar(G, Tq) = 1 +

pipj − |EG(S0)|,

(6.6)

X1≤i<j≤k

where S0 ∈ P ∗
n − 1, n − 2 and n − 3.

n−q+1(G) and |EG(S0)| is given in (6.3), (6.4) and (6.5) respectively for q =

Proof. As G = Kp1,p2,··· ,pk and (G, q) is not an ordered pair in (4.3), where max{2, n − 3} ≤ q ≤
n − 1, by Theorem 4.1 and Corollary 5.3, we have

ar(G, Tq) = 1 + E(G) − |E(G[S0])|,

where S0 ∈ P ∗

n−q+1(G). Thus, the result follows from (6.3), (6.4) and (6.5).

(6.7)

✷

7 To determine ar(Kp1,··· ,pk, Tq) for (4n − 2)/5 ≤ q ≤ n − 1

Let G denote Kp1,··· ,pk. In this section, we consider the case when (4n − 2)/5 ≤ q ≤ n − 1,
where n = p1 + p2 + · · · + pk. We shall show that in this case, ar(G, Tq) can be calculated by
|E(G)| − |EG(S0)| + 1 for any S0 ∈ P ∗
n−q+1(G) in Theorem 7.2. Moreover, we give the explicit
expression for ar(Kp1,··· ,pk , Tq) in Corollary 7.3 with a further condition that p1 − p2 ≥ (n + 2)/5.

Lemma 7.1. Let H be a spanning subgraph of a complete multi-partite graph G of order n
and let r be a positive integer such that n ≥ 5r − 2. If com(H) ≥ 2, or2(H) ≤ r and n −
(or1(H) + or2(H)) ≤ r, then there exists S ⊆ V (H) \ V (H1) with |S| ≤ or2(H) − 1 such that
|E(G[V (H1) ∪ S])| ≥ |E(H)|, where H1 is a largest component of H.

Proof. We prove this result by induction on or2(H). It is trivial if or2(H) = 1. Assume that it
holds when or2(H) < d, where d ≥ 2. Now consider the case that or2(H) = d.

Let H2, H3, · · · , Hs be the components of H diﬀerent from H1 and let W denote the sub-
graph H \ V (H1). Clearly, W consists of components H2, H3, · · · , Hs and |V (W )| = |V (H2)| +
(|V (H3)| + · · · + |V (Hs)|) ≤ or2(H) + r ≤ 2r, implying that |V (H1)| ≥ n − 2r ≥ 3r − 2.

17

Claim 1: There exist u and U with u ∈ U ⊆ V (W ) such that |U ∩ V (Hi)| = 1 for each
i ∈ [s] \ {1} and

|NG(u) ∩ V (H1)| ≥

dW (v).

v∈U
X

Proof. Let t = χ(W ). If t = 1, then W is an empty graph and Claim 1 is trivial. Now assume

that t ≥ 2. By Lemma 3.2, there exists u ∈ V (W ) such that

|NG(u) ∩ V (H1)| ≥

t − 1
t

× |V (H1)|.

(7.1)

Assume that u ∈ V (Hb), where 2 ≤ b ≤ s. Clearly, dW (u) ≤ |V (Hb)| − 1. By Lemma 3.3,

there exists ui ∈ V (Hi) for each i ∈ [s] \ {1, b} such that

dW (ui) ≤

t′ − 1
t′

|V (W ) \ V (Hb)| ≤

t − 1
t

(|V (W )| − |V (Hb)|),

(7.2)

2≤i≤s
X
i6=b

where t′ = χ(W \ V (Hb)). Let U = {u} ∪ {ui : 2 ≤ i ≤ s, i 6= b}. Since |V (Hb)| ≤ r and
|V (W )| ≤ 2r, we have

v∈U
X

dW (v) ≤ |V (Hb)| − 1 +

t − 1
t

(|V (W )| − |V (Hb)|)

≤

≤

=

t − 1
t
t − 1
t

|V (W )| +

1
t

|V (Hb)| − 1

(2r) +

1
t

r − 1

r(2t − 1)
t

− 1.

(7.3)

Since |V (H1)| ≥ 3r − 2,

r(2t − 1)
t

− 1 =

t − 1
t

(3r − 2) −

(t − 2)(r − 1)
t

≤

t − 1
t

(3r − 2) ≤

t − 1
t

|V (H1)|.

(7.4)

Thus, Claim 1 follows from (7.1), (7.3) and (7.4).

♮

By Claim 1, there exist u and U with u ∈ U ⊆ V (W ) such that the properties in Claim 1
hold. Let H ′ be the spanning subgraph of G obtained from H by adding all edges in {uv : v ∈
NG(u) ∩ V (H1)} and deleting all edges in

v∈U EW (v).
As d ≥ 2, it is clear that or2(H ′) = or2(H) − 1 ≤ r − 1 and or3(H ′) + · · · + orcom(H ′)(H ′) =

S

or3(H) + · · · + ors(H) ≤ r.

As |V (H ′

1)| ≥ or2(H) ≥ 2, H ′

1 := G[V (H1) ∪ {u}] is connected and the largest component of
H ′. Since or2(H ′) = or2(H)−1 = d−1, by inductive assumption, there exists S′ ⊆ V (H ′)\V (H ′
1)
with |S′| ≤ or2(H ′) − 1 = or2(H) − 2 such that |E(G[V (H ′
Let S = S′ ∪ {u}. Then |S| ≤ or2(H) − 1 and V (H ′

1) ∪ S′ = V (H1) ∪ S. By Claim 1, we

1) ∪ S′])| ≥ |E(H ′)|.

18

have |E(H ′)| ≥ |E(H)|. Thus,

|E(G[V (H1) ∪ S])| = |E(G[V (H ′

1) ∪ S′])| ≥ |E(H ′)| ≥ |E(H)|.

The result follows.

✷

Theorem 7.2. Let G be a complete multi-partite graph of order n with at least two partite sets.
If q is an integer with (4n − 2)/5 ≤ q ≤ n − 1, then

ar(G, Tq) = |E(G)| + 1 − |EG(S0)|,

(7.5)

where S0 is a member in P ∗

n−q+1(G).

Proof. Let H ∈ Sq(G) such that or1(H) ≥ or1(H ′) holds for every H ′ ∈ Sq(G).
Claim 1: or2(H) = 1.

Proof. Suppose that or2(H) ≥ 2. Let r = n − q. As (4n − 2)/5 ≤ q, we have n ≥ 5r − 2. Let
s = com(H), then s ≥ 3 by Lemma 3.4.

By Theorem 3.5 (i), or1(H) + or2(H) = q and or2(H) = or3(H). Clearly,

or3(H) + · · · + ors(H) = n − (or1(H) + or2(H)) = n − q = r

and 2 ≤ or2(H) = or3(H) ≤ r.

Let H1 be the largest component of H. Since n ≥ 5r − 2, by Lemma 7.1, there exists
S ⊆ V (H) \ V (H1) with |S| ≤ or2(H) − 1 such that |E(G[V (H1) ∪ S])| ≥ |E(H)|. Since
or2(H) ≥ 2, |E(G[V (H1) ∪ S])| ≥ |E(H)| implies that |S| ≥ 1. Note that G[V (H1) ∪ S] is
connected as |V (H1)| ≥ or2(H) ≥ 2, and

|V (H1)| + |S| ≤ or1(H) + or2(H) − 1 = q − 1,

by which the spanning subgraph H ′ of G with edge set E(G[V (H1) ∪ S]) belongs to Sq(G).
As |E(G[V (H1) ∪ S])| ≥ |E(H)|, H ′ ∈ Sq(G), while or1(H ′) = |V (H1)| + |S| > |V (H1)|, a
contradiction to the assumption that or1(H) ≥ or1(H ′). Hence or2(H) = 1.
♮

By Theorem 3.5 (i) and Claim 1, |V (H1)| = q − or2(H) = q − 1 and

ℓq(G) = |E(H)| = |E(H1)| = |E(G)| − |EG(S0)|

where S0 = V (H)\V (H1) ∈ Pn−q+1(G). By (4.2), |EG(S0)| ≤ |EG(S)| for each S ∈ Pn−q+1(G),
thus by Theorem 5.2, S0 ∈ P ∗

n−q+1(G).

Due to Theorem 2.4, ar(G, Tq) = ℓq(G) + 1. The result then follows.

✷

Corollary 7.3. Let G denote Kp1,p2,··· ,pk and n = p1 + p2 + · · · + pk, where k ≥ 2 and p1 ≥ p2 ≥
· · · ≥ pk ≥ 1. If (4n − 2)/5 ≤ q ≤ n − 1 and p1 − p2 ≥ (n + 2)/5, then

ar(G, Tq) = |E(G)| + 1 − (n − q + 1)(n − p1).

19

Proof. By Theorem 7.2, ar(G, Tq) = 1 + |E(G)| − |EG(S)| for any S ∈ P ∗
p1 − p2 ≥ (n + 2)/5 = n − (4n − 2)/5 ≥ n − q, by Algorithm A, there exists S0 ∈ P ∗
with S0 ⊆ X1, where X1 is the partite set of G with |X1| = p1.

n−q+1(G). Since
n−q+1(G)

Since S0 ⊆ X1 and |S0| = n − q + 1, we have |EG(S0)| = (n − p1)(n − q + 1). Thus, the result
✷

holds.

Remark. Note that the ordered pairs (K3,3, 4) and (K3,3,3, 6) in (4.3) imply that the condition
q ≥ (4n − 2)/5 in Theorem 7.2 cannot be improved into q ≥ ⌊(4n − 2)/5⌋, but we guess it may

be true when q ≥ (2n + 1)/3. In addition, when q ≤ n − 4 and q is close to n, the value of
ar(Kp1,··· ,pk, Tq) might also be obtained by applying Corollary 5.3. However, the exact values of
ar(Kp1,··· ,pk, Tq) for all q are generally hard to compute, even for complete bipartite graphs, as
also mentioned in [8].

References

[1] J. Ding, H. Bian and H. Yu, Anti-Ramsey numbers in complete k-partite graphs, Mathe-

matical Problems in Engineering, vol. 2020, Article ID 5136104, 5 pages, 2020.

[2] P. Erd˝os, M. Simonovits and V.T. S´os, Anti-Ramsey theorems, Colloq. Math. Soc. Janos.

Bolyai, Vol. 10, Inﬁnite and Finite Sets, Keszthely (Hungary), 1973, pp. 657 - 665.

[3] C. Fang, E. Gy˝ori, C. Xiao and J. Xiao, Tur´an numbers and anti-Ramsey numbers for short

cycles in complete 3-partite graphs, arXiv:2011.13715, 2020.

[4] S. Fujita, C. Magnant and K. Ozeki, Rainbow generalizations of Ramsey theory - a dynamic

survey, Theo. Appl. Graphs, 0(1), 2014.

[5] S. Jahanbekam and D.B. West, Anti-Ramsey problems for t edge-disjoint rainbow spanning

sub-graphs: cycles, matchings, or trees, J Graph Theory 82(1) (2016), 75-89.

[6] Y. Jia, M. Lu and Y. Zhang, Anti-Ramsey Problems in Complete Bipartite Graphs for t
Edge-Disjoint Rainbow Spanning Trees. Graphs and Combinatorics 37, 409–433 (2021).

[7] T. Jiang and D.B. West, Edge-colorings of complete graphs that avoid polychromatic trees,

Discrete Math. 274 (2004), 137-145.

[8] Z. Jin and L. Li, Edge-colorings of complete bipartite graphs without large rainbow trees,

Ars Combin. 111, 75-84, (2013).

[9] L. Lu, A. Meier and Z. Wang, Anti-Ramsey number of edge-disjoint rainbow spanning trees

in all graphs, arXiv:2104.12978, 2021.

[10] T. Xie and L. Yuan, On the anti-Ramsey numbers of linear forests, Discrete Math. 343

(2020), 112-130.

[11] L. Yuan, The anti-Ramsey number for paths, arXiv:2102.00807, 2021.

20

