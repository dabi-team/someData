MARLow: A Joint Multiplanar Autoregressive
and Low-Rank Approach for Image Completion

Mading Li1, Jiaying Liu1, Zhiwei Xiong2, Xiaoyan Sun2, Zongming Guo1

1Institute of Computer Science and Technology, Peking University
2Microsoft Research Asia

Abstract. In this paper, we propose a novel multiplanar autoregressive
(AR) model to exploit the correlation in cross-dimensional planes of a
similar patch group collected in an image, which has long been neglected
by previous AR models. On that basis, we then present a joint multipla-
nar AR and low-rank based approach (MARLow) for image completion
from random sampling, which exploits the nonlocal self-similarity within
natural images more eﬀectively. Speciﬁcally, the multiplanar AR model
constraints the local stationarity in diﬀerent cross-sections of the patch
group, while the low-rank minimization captures the intrinsic coherence
of nonlocal patches. The proposed approach can be readily extended
to multichannel images (e.g. color images), by simultaneously consid-
ering the correlation in diﬀerent channels. Experimental results demon-
strate that the proposed approach signiﬁcantly outperforms state-of-the-
art methods, even if the pixel missing rate is as high as 90%.

Keywords: Image completion, multiplanar autoregressive model, low-
rank minimization

6
1
0
2

n
u
J

6
1

]

V
C
.
s
c
[

2
v
5
1
1
1
0
.
5
0
6
1
:
v
i
X
r
a

1 Introduction

Image restoration aims to recover original images from their low-quality observa-
tions, whose degradations are mostly generated by defects of capturing devices or
error prone channels. It is one of the most important techniques in image/video
processing, and low-level computer vision. In our work, we mainly focus on an
interesting problem: image completion from random sampling, which has at-
tracted many researchers’ attention [1,2,3,4,5,6,7,8]. The problem is to recover
the original image from its degraded observation, which has missing pixels ran-
domly distributed. Such problem is a typical ill-posed problem, and diﬀerent
kinds of image priors have been employed.

One of the most commonly used image priors is the nonlocal prior [9], also
known as the self-similarity property of natural images. Such prior reﬂects the
fact that there are many similar contents frequently repeated in the whole image,
which can be well utilized in image completion. A classic way is to process
the collected similar patch groups. The reason is that similar degraded patches
contain complementary information for each other, which contributes to the

 
 
 
 
 
 
Fig. 1. The framework of the proposed image completion method MARLow. After ob-
taining an initialization of the input image, similar patches are collected. Then, the
joint multiplanar autoregressive and low-rank approach is applied on grouped patches.
After all patches are processed, overlapped patches are aggregated into a new interme-
diate image, which can be used as the input for the next iteration.

completion. According to the manipulation scheme applied to the patch group,
there are generally two kinds of methods in the literature:

Cube-based methods stack similar patches directly, and then manipulate
the data cube. The well-known denoising method Block-Matching and 3D ﬁlter-
ing (BM3D) algorithm [10] is one of the most representative cube-based methods,
which performs a 1D transform on each dimension of the data cube. The idea has
been widely studied, and many extensions have been presented [11,12,7]. These
methods perform a global optimization on the data cube, neglecting the local
structures inside the cube. Also, they process the data cube along each dimen-
sion, failing to consider the correlation that exists in cross-dimensional planes
of the data cube. In this paper, we propose a multiplanar autoregressive (AR)
model to address these problems. Speciﬁcally, the multiplanar AR model is to
constrain the local stationarity in diﬀerent sections of the data cube. Nonethe-
less, the multiplanar AR model is not good at smoothing the intrinsic structure
of similar patches.

Matrix-based methods stretch similar patches into vectors, which are spliced

to form a data matrix. Two popular approaches, sparse coding and low-rank
minimization, can be applied to such matrices. For sparse coding, the sparse
coeﬃcients of each vector in the matrix should be similar. This amounts to re-
stricting the number of nonzero rows of the sparse coeﬃcient matrix [13,14].
Zhang et al. [15] presented a group-based sparse representation method, which
regards similar patch groups as its basic units. For low-rank minimization, since
the data matrix is constructed by similar vectors, the rank of its underlying
clean matrix to be recovered should be low. By minimizing the rank of the ma-
trix, inessential contents (e.g. the noise) of the matrix can be eliminated [16,4].
However, in image completion from random samples, such methods may exces-
sively smooth the result, since they only consider the correlation of pixels at the
same location of diﬀerent patches. Also, unlike stacking similar patches directly,
representing image patches by vectors shatters the local information stored in
image patches.

Upon these analyses, these two kinds of methods seem to be relatively com-
plemented. Thus, motivated by combining the merits of cube-based and matrix-
based methods, we present a joint multiplanar autoregressive and low-rank ap-

MultiplanarAR modelingLow-rank minimizationInitializationInputOutputproach (MARLow) for image completion (Figure 1). Instead of performing a
global optimization on the data cube grouped by similar patches, we propose the
concept of the multiplanar autoregressive model to exploit the local stationarity
on diﬀerent cross-sections of the data cube. Meanwhile, we jointly consider the
matrix grouped by stretched similar patches, in which the intrinsic content of
similar patches can be well recovered by low-rank minimization. In summary,
our contributions lie in three aspects:

– We propose the concept of multiplanar autoregressive model, to characterize

the local stationarity of cross-dimensional planes in the patch group.

– We present a joint multiplanar autoregressive and low-rank approach (MAR-
Low) for image completion from random sampling, along with an eﬃcient
alternating optimization method.

– We extend our method to multichannel images by simultaneously considering
the correlation in diﬀerent channels, presenting encouraging performance.

2 Related Work

In this section, we brieﬂy review and discuss the existing literature that closely
relates to the proposed method, including approaches associated with the au-
toregressive model and low-rank minimization.
Autoregressive model The autoregressive (AR) model has been extensively
studied in the last decades. AR model refers to modeling a pixel as the linear
combination of its supporting pixels, usually its known neighboring pixels. Based
on the assumption that natural images have the property of local stationarity,
pixels in a local area share the same AR parameters, i.e. the weight for each
neighbor. AR parameters are often estimated from the low-resolution image
[17,18]. Dong et al. proposed a nonlocal AR model [19] using nonlocal pixels as
supporting pixels, which is taken as a data ﬁdelity constraint. The 3DAR model
has been proposed to detect and interpolate the missing data in video sequences
[20,21]. Since video sequences have the property of temporal smoothness, AR
model can be extended to temporal space by combining the local statistics in the
single frame. Diﬀerent from approaches mentioned above, we focus on diﬀerent
cross-sections of the data cube grouped by similar nonlocal patches in a single
image and constrain the local stationarity inside diﬀerent planes in the data cube
simultaneously (Figure 2).
Low-rank minimization As a commonly used tool in image completion, low-
rank minimization aims to minimize the rank of an input corrupted matrix. It can
be used for recovering/completing the intrinsic content of a degraded potentially
low-rank matrix. The original low-rank minimization problem is NP-hard, and
cannot be solved eﬃciently. Cand`es and Recht [22] proposed to relax the problem
by using nuclear norm of the matrix, i.e. the sum of singular values, which has
been widely used in low-rank minimization problems since then. As proposed
in [16,4], similar patches in images/videos are collected to form a potentially
low-rank matrix. Then, the nuclear norm of the matrix is minimized. Zhang
et al. further presented the truncated nuclear norm [6], minimizing the sum of

small singular values. Ono et al. [23] proposed the block nuclear norm, leading
to a suitable characterization of the texture component. Low-rank minimization
can also be used on tensor completion. Liu et al. [5] regarded the whole input
degraded color image as a potentially low-rank tensor, and deﬁned the trace norm
of tensors by extending the nuclear norm of matrices. However, most general
natural images are not potentially low-rank. Thus, Chen et al. [24] attempted to
recover the tensor while simultaneously capturing the underlying structure of it.
In our work, we apply the nuclear norm of matrices, and we use singular value
thresholding (SVT) method [25] to solve the low-rank minimization problem.
Jointly combined with our multiplanar model (as elaborated in Section 3), our
method produces encouraging image completion results.

3 The Proposed Image Completion Method

As discussed in previous sections, cube-based methods and matrix-based meth-
ods have their drawbacks, and they complement each other in some sense. In
this section, we introduce the proposed multiplanar AR model to utilize informa-
tion from cross-sections of the data cube grouped by similar patches. Moreover,
combined with low-rank minimization, we present the joint multiplanar autore-
gressive and low-rank approach (MARLow) for image completion. At the end of
this section, we extend the proposed method to multichannel images. For an in-
put degraded image, we ﬁrst conduct a simple interpolation-based initialization
on it (see Figure 1), to provide enough information for patch grouping.

3.1 Multiplanar AR Model

Considering a reference patch of size n×n, we collect its similar nonlocal patches.
For a data cube grouped by similar patches, we observe its diﬀerent cross-sections
(cross-dimensional planes). As shown in Figure 2 (a), diﬀerent cross-sections of
the data cube possess local stationarity. Since AR models can measure the local
stationarity of image signals, we naturally extend the conventional AR model to
the multiplanar AR model to measure cross-dimensional planes.

Generally, the conventional AR model is deﬁned as

X(i, j) =

(cid:88)

(m,n)∈N

X(i + m, j + n) · ϕ(m, n) + σ(i, j),

(1)

where X(i, j) represents the pixel located at (i, j). X(i + m, j + n) is the sup-
porting pixel with spatial oﬀset (m, n), while ϕ(m, n) is the corresponding AR
parameter. N is the set of supporting pixels’ oﬀsets and σ(i, j) is the noise.

In our work, the multiplanar AR model consists supporting pixels from dif-
ferent cross-dimensional planes (as illustrated in Figure 2 (b)). For a data cube
grouped by similar patches of an image patch located at i, the multiplanar AR
model of pixel Xi(j, k, l) with oﬀset (j, k, l) in the data cube is deﬁned as

Xi(j, k, l) =

(cid:88)

(cid:88)

m∈N1

(p, q)
∈ N2

Yi(j + m, k + p, l + q) · ϕi(m, p, q) + σi(j, k, l),

(2)

(a) Cross-sections of a data cube

(b) A multiplanar AR model

Fig. 2. (a) Diﬀerent cross-sections of a data cube grouped by similar patches also
possess local stationarity, which can be well processed by AR models. (b) White dots
represent pixels (i.e. small rectangles in 6 × 6 image patches). Black arrows connect
the center pixel of a multiplanar AR model with its supporting pixels.

where N1 represents the set of supporting pixels’ planar oﬀsets and N2 represents
the set of supporting pixels’ spatial oﬀsets (assuming the order of the multiplanar
AR model Norder = |N1| × |N2|). Yi(j + m, k + p, l + q) is the supporting pixel
with oﬀset (m, p, q) in the data cube and ϕi(m, p, q) is the corresponding AR
parameter. σi(j, k, l) is the noise. Y is the initialization of the input image X.
The reason we use Y here is that it is diﬃcult to ﬁnd enough known pixels to
support the multiplanar AR model under high pixel missing rate.

For an n × n patch, assuming N patches are collected, the aforementioned

multiplanar AR model can be transformed into a matrix form, that is,

Xi = Ti(Y ) · ϕi + σi,

(3)

where Xi ∈ R(n2×N )×1 is a vector containing all modeled pixels. Ti(·) repre-
sents the operation that extract supporting pixels for Xi. Each row of Ti(Y ) ∈
R(n2×N )×Norder contains values of supporting pixels of each pixel and ϕi ∈
RNorder×1 is the multiplanar AR parameter vector.

Thus, the optimization problem for Xi and ϕi can be formulated as follows,

argmin
Xi,ϕi

(cid:107)Xi − Ti(Y ) · ϕi(cid:107)2
F .

(4)

where (cid:107) · (cid:107)F is the Frobenius norm. In order to enhance the stability of the
solution, we introduce the Tikhonov regularization to solve this problem. Specif-
ically, a regularization term is included in the minimization problem, forming
the following regularized least-square problem

argmin
Xi,ϕi

(cid:107)Xi − Ti(Y ) · ϕi(cid:107)2

F + (cid:107)Γ · ϕi(cid:107)2
F ,

(5)

where Γ = αI and I is an identity matrix.

3.2 MARLow

Since the multiplanar AR model is designed to constrain a pixel with its sup-
porting pixels on diﬀerent cross-sections of the patch group, it can deal more

…eﬃciently with local image structures. For instance, assume there is an edge
on an image that is severely degraded, with only a few pixels on it. After col-
lecting similar patches, low-rank minimization or other matrix-based methods
may regard the remaining pixels as noises and remove them. However, with the
multiplanar AR model, these pixels can be used to constrain each other and
strengthen the underlying edge. Nevertheless, AR models are not suitable for
smoothing the intrinsic structure, while low-rank minimization methods special-
ize in it. So we propose to combine the multiplanar AR model with low-rank
minimization (MARLow) as follows,

argmin
Xi,ϕi

(cid:107)Xi − Ti(Y ) · ϕi(cid:107)2

F + (cid:107)Γ · ϕi(cid:107)2

F

+ µ

(cid:16)
(cid:107)Ri(X) − Ri(Y )(cid:107)2

F + (cid:107)Ri(X)(cid:107)∗

(cid:17)

,

(6)

where the last part is the low-rank minimization term restricting the ﬁdelity
while minimizing the nuclear norm (i.e. (cid:107) · (cid:107)∗) of the data matrix. Ri(·) is an
extraction operation that extracts similar patches of the patch located at i.
Ri(X) = [Xi1 , Xi2, ..., XiN ] ∈ Rn2×N is similar patch group of the reference
patch Xi1 , and Ri(Y ) = [Yi1 , Yi2, ..., YiN ] ∈ Rn2×N represents the corresponding
patch group extracted from Y .

Figure 3 presents the completion results by using only low-rank without the
multiplanar AR model, and by MARLow. From the ﬁgure, we can see that
MARLow can eﬀectively connect fractured edges.

(a) Low-rank

(b) MARLow

Fig. 3. (a) Completion result by low-rank without our multiplanar AR model (19.48
dB/0.8933); (b) Completion result generated by MARLow (19.95 dB/0.8980).
Clearly, the result obtained by MARLow has higher visual quality, which can be ob-
served in marked regions.

3.3 Multichannel Image Completion

For multichannel images, instead of applying the straightforward idea, that is,
the separate procedure (i.e. processing diﬀerent channels separately and combin-
ing the results afterward), we present an alternative scheme to simultaneously
process diﬀerent channels. At ﬁrst, we collect similar patches of size n × n × h
(where h represents the number of channels) in a multichannel image. After that,
each patch group is processed by simultaneously considers all channels. Speciﬁ-
cally, the collected patches can be formed into h data cubes by stacking slices (of
size n × n × 1) in the corresponding channel of diﬀerent patches. For multiplanar

AR model, the minimization problem in Equation (5) turns into

argmin
i ,ϕk
X k
i

(cid:88)

1≤k≤h

(cid:16)(cid:13)
(cid:13)X k

i − T k

i (Y ) · ϕk
i

F + (cid:13)
(cid:13)
2
(cid:13)

(cid:13)Γ · ϕk
i

(cid:13)
2
(cid:13)

F

(cid:17)

(7)

For low-rank minimization, N collected patches are formed into a potentially
low-rank data matrix of size (n2 × h) × N by representing each patch as a vector.
Taking an RGB image for an example, in patch grouping, we search for
similar patches using reference patches with the size n × n × 3. The multichannel
image completion problem can be solved by minimizing

(cid:17)

,

(8)

(cid:13)
(cid:13)X C

i − T C

i (Y C) · ϕC
i

F + (cid:13)
(cid:13)
2
(cid:13)

(cid:13)Γ · ϕC
i

(cid:13)
2
(cid:13)
F

argmin
i ,ϕC
X C
i

(cid:16)(cid:13)
(cid:13)RC

i (X C) − RC

F + (cid:13)
i (Y C)(cid:13)
2
(cid:13)

(cid:13)RC

i (X C)(cid:13)
(cid:13)∗

X C

i =

ϕC

i =


 ∈ R(n2×N ×3)×1,





X R
i
X G
i
X B
i


 ∈ R(Norder×3)×1,





ϕR
i
ϕG
i
ϕB
i

+ µ

where

i (Y C) =
T C



Ti(Y R) 0

0
Ti(Y G) 0



0
0

0 Ti(Y B)


 ∈ R(n2×N ×3)×(Norder×3),

RC

i (X C) =

RC

i (Y C) =





X R
i1
X G
i1
X B
i1





Y R
i1
Y G
i1
Y B
i1

X R
i2
X G
i2
X B
i2

· · · X R
iN
· · · X G
iN
· · · X B
iN


 ∈ R(n2×3)×N ,

Y R
i2
Y G
i2
Y B
i2

· · · Y R
iN
· · · Y G
iN
· · · Y B
iN


 ∈ R(n2×3)×N .

The notations are given similarly as the preceding deﬁnitions. By utilizing
the information in multichannel images, the patch grouping can be more precise.
Furthermore, rich information in diﬀerent channels can compensate for each
other and constrain the completion result. Figure 4 illustrates the diﬀerence
between processing diﬀerent channels separately and simultaneously (with 80%
pixels missing). Compared with the separate procedure, the multichannel image
completion approach can signiﬁcantly improve the performance of our method.
Thus, in Section 5, for those methods dedicated to gray-scale image completion,
we do not apply the separate procedure to them to obtain color image completion
results since it may be unfair. Instead, we compare our multichannel image
completion method with other state-of-the-art color image completion methods.

(a) 25.77 dB (b) 30.36 dB (c) 26.66 dB

(d) 34.38 dB

Fig. 4. (a) and (c) are obtained by the separate procedure. (b) and (d) are obtained
by our multichannel image completion method.
4 Optimization

In this section, we present an alternating minimization algorithm to solve the
minimization problems in Equation (6) and (8). Take Equation (6) for an ex-
ample. We address each of the variable Xi and ϕi separately and present an
eﬃcient optimization algorithm.

When ﬁxing Xi, the problem turns into

argmin
ϕi

(cid:107)Xi − Ti(Y ) · ϕi(cid:107)2

F + (cid:107)Γ · ϕi(cid:107)2
F ,

(9)

which is a standard regularized linear least square problem, and can be solved
by ridge regression. The closed-form solution is given by

ϕi =

(cid:16) ˆY T ˆY + Γ T Γ

(cid:17)−1

ˆY Xi,

where ˆY = Ti(Y ).

With ϕi ﬁxed, the problem for updating Xi becomes

argmin
Xi

(cid:107)Xi − Ti(Y ) · ϕi(cid:107)2
F

(cid:16)

+ µ

(cid:107)Ri(X) − Ri(Y )(cid:107)2

F + (cid:107)Ri(X)(cid:107)∗

(cid:17)

.

(10)

(11)

Here we notice that Xi and Ri(X) contain the same elements. Their only
diﬀerence is the formation: Xi is a vector and Ri(X) is a matrix. Since we use
Frobenius norm here, the value of the norm does not change if we reform the
vector into a matrix form. So we reform Xi into a matrix Mi corresponding
to Ri(X) (in this way, Ri(X) does not need to be reformed, and it can be
represented by Mi directly). The vector Ti(Y ) · ϕi is also reformed into a matrix
form, represented by Y1i. By denoting Y2i = Ri(Y ), we can get the simpliﬁed
version of Equation (11):

(cid:107)Mi − Y1i (cid:107)2

F + µ

(cid:16)

(cid:107)Mi − Y2i(cid:107)2

F + (cid:107)Mi(cid:107)∗

(cid:17)

.

(12)

argmin
Mi

It is a modiﬁed low-rank minimization problem and can be transformed into

the following formation

argmin
Mi

(cid:107)Mi − Y (cid:48)

i (cid:107)2

F + λ(cid:107)Mi(cid:107)∗,

(13)

where Y (cid:48)
i = (1 − λ)Y1i + λY2i and λ = µ/(µ + 1). The problem now turns into a
standard low-rank minimization problem [25]. Its closed-form solution is given
as

Mi = Sτ (Y (cid:48)

i ),

(14)

where Sτ (·) represents the soft shrinkage process.

With the input random sampled image Y and the mask matrix Mmask in-
dicating known pixels (0s for missing pixels and 1s for known pixels), our alter-
nating minimization algorithm for image completion from random sampling can
be summarized in Algorithm 1.

Algorithm 1 A Joint Multiplanar Autoregressive and Low-Rank Approach for
Image Completion

Input: Y and Mmask.
X 0 = Bilinear(Y, Mmask).
for i = 1 to maxIter do

Patch grouping.
for each image patch group Xk in X (i−1) do
Estimate ϕk according to Equation (9).
Estimate Xk according to Equation (11).

end for
Estimate X (i) by aggregating all overlapped patches.
X (i)(Mmask) = Y (Mmask).
Y = X (i).

end for
Output: The restored image X (i).

5 Experimental Results

Experimental results of compared methods are all generated by the original au-
thors’ codes, with the parameters manually optimized. Both objective and sub-
jective comparisons are provided for a comprehensive evaluation of our work.
Peak Signal to Noise Ratio (PSNR) and structural similarity (SSIM) index are
used to evaluate the objective image quality. In our implementation, if not spe-
cially stated, the size of each image patch is set to 8×8 (5×5×3 in color images)
with four-pixel (one-pixel in color images) overlap. The number of similar patches
is set to N = 64 for gray-scale image and N = 75 for color image. Other param-
10, µ = 10. Please see the
eters in our algorithm are empirically set to α =
electronic version for better visualization of the subjective comparisons. More
results can be found in the supplementary materials.

√

5.1 Gray-Scale Image Completion

For gray-scale images, we compare our method with state-of-the-art gray-scale
image completion methods BPFA [14], BNN [23], ISDSB [2], and JSM [7]. Table 1

Table 1. PSNR (dB) and SSIM results of gray-scale image completion from diﬀerent
methods under 80% missing rate. The best result in each case is highlighted in bold.

BNN

ISDSB

Image
House
Lena

BPFA
25.61/0.8052 27.76/0.8381 30.19/0.8717 33.00/0.8944 34.70/0.9070
27.31/0.8142 28.58/0.8416 30.95/0.8794 31.49/0.8836 32.84/0.9043
Cameraman 21.72/0.7584 22.65/0.7867 24.04/0.8082 25.18/0.8439 25.49/0.8581
27.06/0.8205 27.87/0.8389 29.85/0.8529 31.75/0.8664 32.59/0.8781
Average 25.42/0.7996 26.72/0.8263 28.76/0.8530 30.35/0.8721 31.41/0.8869

Proposed

Pepper

JSM

Table 2. PSNR (dB) and SSIM results of color image completion from diﬀerent meth-
ods under 80% and 90% missing rates. The best result in each case is highlighted in
bold.

Image Ratio

FoE

ST-NLTV

GSR

BPFA

Proposed

Castle

Woman

Soldier

80% 25.71/0.8424 26.60/0.8414 25.66/0.8588 29.22/0.9099 30.36/0.9124
90% 23.38/0.7655 23.39/0.7507 22.99/0.7771 25.09/0.8189 26.55/0.8509
80% 19.83/0.7948 21.37/0.7992 31.71/0.9460 30.33/0.9363 34.38/0.9561
90% 17.16/0.6520 16.79/0.5973 20.02/0.8016 24.20/0.8640 30.12/0.9179
80% 23.95/0.8434 25.10/0.8320 25.54/0.8963 28.92/0.9352 30.78/0.9473
90% 21.03/0.7237 20.44/0.6911 21.82/0.7922 24.09/0.8368 26.34/0.8893
21.84/0.7703 22.28/0.7520 24.62/0.8453 26.98/0.8835 29.76/0.9123

Average

shows PSNR/SSIM results of diﬀerent methods on test images with 80% pixels
missing. From Table 1, the proposed method achieves the highest PSNR and
SSIM in all cases, which fully demonstrates the eﬀectiveness of our method.
Speciﬁcally, the improvement on PSNR is 1.06 dB and that on SSIM is 0.0148
on average compared with the second best algorithm (i.e. JSM).

Figure 5 compares the visual quality of completion results for test images
(with 80% pixels missing). From Figure 5, ISDSB and BNN successfully recover
the boundaries of the image, but fail to restore rich details. BPFA performs
better completion on image details. Nonetheless, there are plenty of noises along
edges recovered by BPFA. At the ﬁrst glance, the completion results of JSM
and our method are both of high quality. However, if we get a closer look, it can
be observed that there are isolated noises on image details (such as structures
on Lena’s hair and her hat) in the result generated by JSM. JSM also cannot
recover tiny structures. Our method presents the best visual quality, especially
on image details and edges.

5.2 Color Image Completion

We compare our method with state-of-the-art color image completion methods
FoE [26], BPFA [14], GSR [15] and ST-NLTV [1]. Table 2 lists PSNR/SSIM
results of diﬀerent methods on color images with 80% and 90% pixels missing. It
is clear that the proposed method achieves the highest PSNR/SSIM in all cases.
Compared with gray-scale images, our image completion method performs even
better on color images judging from the average PSNR and SSIM. The proposed
method outperforms the second best method (i.e. BPFA) by 2.78 dB on PSNR

Fig. 5. Comparison of completion results of diﬀerent methods with 80% pixels missing.
From left to right: the degraded image, results of ISDSB, BNN, BPFA, JSM, our
method, and the ground truth. The second and third rows show the corresponding
close-ups.

and 0.0288 on SSIM. Note that, when tested on image Woman with 90% pixels
missing, the PSNR and SSIM improvements achieved by our method over BPFA
are 5.92 dB and 0.0539, respectively.

Figure 6 shows the visual quality of color image completion results for test
images (with 90% pixels missing). Apparently, all the comparing methods are
doing great on ﬂat regions. However, FoE and ST-NLTV cannot restore ﬁne
details. GSR is better on recovering details, but it generates noticeable artifacts
around edges and fails to connect fractured edges. BPFA produces sharper edges,
but its performance under higher missing rate is not satisfying. The result of our
method is of the best visual quality, especially under higher missing rate.

We also compare our method with state-of-the-art low-rank matrix/tensor
completion based methods TNNR [6], LRTC [5] and STDC [24]. Since these
methods regard the whole image as a potentially low-rank matrix, the input
image should have strong correlations between its columns or rows. Thus, to be
fair, we also test this kind of images to evaluate the performance of our method.
From Figure 7, TNNR and LRTC tends to erase tiny objects of the image, such
as the colorful items (see the close-ups in Figure 7). STDC imports noticeable
noises into the whole image. The proposed method presents not only accurate
completion on sharp edges, but also high-quality textures, exhibiting the best
visual quality.

5.3 Text Removal

Text removal is one of the classic case of image restoration. The purpose of text
removal is to recover the original image from a degraded version by removing the
text mask. We have compared our method with four state-of-the-art algorithms:
KR [27], FoE [28], JSM [7] and BPFA [14]. Our experimental settings of text
removal are the same with those in color image restoration. Tab. 3 shows the
PSNR and SSIM results of diﬀerent methods. Fig. 8 presents visual comparison
of diﬀerent approaches, which further illustrates the eﬀectiveness of our method.

Fig. 6. Comparison of color image completion results of diﬀerent methods with 90%
pixels missing. From left to right: the degraded image, results of FoE, ST-NLTV, GSR,
BPFA and our method, the ground truth.

Fig. 7. Visual quality comparison of low-rank based methods. (a) The degraded image
(with 90% pixels missing, 6.12 dB/0.0292); (b) - (e) Completion results by TNNR (17.58
dB/0.7276), LRTC (19.78 dB/0.8226), STDC (17.65 dB/0.7839), and the proposed
method (21.71 dB/0.9021). (f) The ground truth image.

Table 3. PSNR (dB) and SSIM results of text removal from diﬀerent methods. The
best result in each case is highlighted in bold.

KR

FoE

BPFA

Image
Barbara 29.59/0.9578 30.18/0.9585 32.91/0.9647 36.56/0.9839 37.81/0.9862
Parthenon 29.69/0.9374 31.87/0.9535 31.90/0.9506 33.07/0.9631 33.27/0.9656
Butterﬂy 30.22/0.9717 30.04/0.9713 30.07/0.9595 31.85/0.9797 33.18/0.9844
Foreman 40.51/0.9848 38.81/0.9863 38.53/0.9733 39.70/0.9870 43.30/0.9887
Average 32.50/0.9629 32.73/0.9674 33.35/0.9620 35.30/0.9784 36.89/0.9812

Proposed

JSM

Fig. 8. Visual quality comparison of text removal for image Barbara and Parthenon.
(a) The degraded image with text mask; (b) - (d) Restoration results by FoE, BPFA,
and the proposed method. (e) The ground truth image.

5.4

Image Interpolation

The proposed method can also be applied on basic image processing problems,
such as image interpolation. In fact, image interpolation can be regarded as a
special circumstance of image restoration from random samples. To be more spe-
ciﬁc, locations of the known/missing pixels in image interpolation are ﬁxed. Since
our method is designed to deal with image restoration from random samples, we
do not utilize this feature in our current implementation. Even so, we evaluate
the performance of the proposed method with respect to image interpolation
by comparing with other state-of-the-art interpolation methods. The compared
methods including AR model based interpolation algorithms NEDI [17] and SAI
[18], and a directional cubic convolution interpolation DCC [29]. Objective re-
sults are given in Tab. 4 and subjective comparisons are demonstrated in Fig.
9, showing that proposed method is competitive with other methods.

Table 4. PSNR (dB) and SSIM results of interpolation from diﬀerent methods. The
best result in each case is highlighted in bold.

BC

SAI

Lena

NEDI

Images

Proposed
Cameraman 25.37/0.8629 25.42/0.8626 25.88/0.8709 25.92/0.8731 25.36/0.8664
33.94/0.9149 33.78/0.9142 34.71/0.9193 34.50/0.9197 34.90/0.9225
Lighthouse 26.93/0.8436 26.37/0.8386 26.65/0.8445 27.19/0.8483 27.22/0.8462
Monarch
31.86/0.9561 31.78/0.9555 33.02/0.9623 32.92/0.9623 33.16/0.9640
Average 29.52/0.8944 29.33/0.8927 30.07/0.8992 30.13/0.9009 30.16/0.8998

DCC

6 Conclusion

In this work, we introduce the new concept of the multiplanar model, which
exploits the cross-dimensional correlation in similar patches collected in a single
image. Moreover, a joint multiplanar autoregressive and low-rank approach for

Fig. 9. Subjective comparison of interpolation for image Lena. Results of (a) Bicubic,
(b) NEDI, (c) SAI, (d) DCC, (e) the proposed method, and (e) the ground truth image.

image completion from random sampling is presented, along with an alternat-
ing optimization algorithm. Our image completion method can be extended to
multichannel images by utilizing the correlation in diﬀerent channels. Extensive
experiments on diﬀerent applications have demonstrated the eﬀectiveness of our
method. Future works include the extensions on more other applications, such
as video completion and hyperspectral imaging. We are also interested in adap-
tively choosing the size of the processing image patch since it might improve the
completion result.

References

1. Chierchia, G., Pustelnik, N., Pesquet-Popescu, B., Pesquet, J.C.: A nonlocal struc-
ture tensor-based approach for multicomponent image recovery problems. Image
Processing, IEEE Transactions on 23(12) (Dec 2014) 5531–5544

2. He, L., Wang, Y.:

Iterative support detection-based split bregman method for
wavelet frame-based image inpainting. Image Processing, IEEE Transactions on
23(12) (Dec 2014) 5470–5485

3. Heide, F., Heidrich, W., Wetzstein, G.: Fast and ﬂexible convolutional sparse
coding. In: Computer Vision and Pattern Recognition (CVPR), IEEE Conference
on. (June 2015) 5135–5143

4. Ji, H., Liu, C., Shen, Z., Xu, Y.: Robust video denoising using low rank matrix
completion. In: Computer Vision and Pattern Recognition (CVPR), IEEE Con-
ference on. (June 2010) 1791–1798

5. Liu, J., Musialski, P., Wonka, P., Ye, J.: Tensor completion for estimating missing
In: Computer Vision, IEEE International Conference on.

values in visual data.
(Sept 2009) 2114–2121

6. Zhang, D., Hu, Y., Ye, J., Li, X., He, X.: Matrix completion by truncated nuclear
norm regularization. In: Computer Vision and Pattern Recognition (CVPR), IEEE
Conference on. (June 2012) 2192–2199

7. Zhang, J., Zhao, D., Xiong, R., Ma, S., Gao, W.: Image restoration using joint
statistical modeling in a space-transform domain. Circuits and Systems for Video
Technology, IEEE Transactions on 24(6) (June 2014) 915–928

8. Zhang, Z., Ely, G., Aeron, S., Hao, N., Kilmer, M.: Novel methods for multilinear
data completion and de-noising based on tensor-svd.
In: Computer Vision and
Pattern Recognition (CVPR), 2014 IEEE Conference on. (June 2014) 3842–3849
9. Buades, A., Coll, B., Morel, J.M.: A review of image denoising algorithms, with a

new one. Multiscale Modeling & Simulation 4(2) (2005) 490–530

10. Dabov, K., Foi, A., Katkovnik, V., Egiazarian, K.: Image denoising by sparse 3-D
transform-domain collaborative ﬁltering. Image Processing, IEEE Transactions on
16(8) (Aug 2007) 2080–2095

11. Dabov, K., Foi, A., Egiazarian, K.: Video denoising by sparse 3D transform-
domain collaborative ﬁltering. In: Signal Processing Conference, European. (Sept
2007) 145–149

12. Maggioni, M., Boracchi, G., Foi, A., Egiazarian, K.: Video denoising, deblock-
ing, and enhancement through separable 4-D nonlocal spatiotemporal transforms.
Image Processing, IEEE Transactions on 21(9) (Sept 2012) 3952–3966

13. Mairal, J., Bach, F., Ponce, J., Sapiro, G., Zisserman, A.: Non-local sparse models
for image restoration. In: Computer Vision, IEEE International Conference on.
(Sept 2009) 2272–2279

14. Zhou, M., Chen, H., Paisley, J., Ren, L., Li, L., Xing, Z., Dunson, D., Sapiro, G.,
Carin, L.: Nonparametric bayesian dictionary learning for analysis of noisy and
incomplete images.
Image Processing, IEEE Transactions on 21(1) (Jan 2012)
130–144

15. Zhang, J., Zhao, D., Gao, W.: Group-based sparse representation for image restora-
tion. Image Processing, IEEE Transactions on 23(8) (Aug 2014) 3336–3351
16. Dong, W., Shi, G., Li, X.: Nonlocal image restoration with bilateral variance
estimation: A low-rank approach. Image Processing, IEEE Transactions on 22(2)
(Feb 2013) 700–711

17. Li, X., Orchard, M.: New edge-directed interpolation. Image Processing, IEEE

Transactions on 10(10) (Oct 2001) 1521–1527

18. Zhang, X., Wu, X.: Image interpolation by adaptive 2-d autoregressive modeling
and soft-decision estimation. Image Processing, IEEE Transactions on 17(6) (June
2008) 887–896

19. Dong, W., Zhang, L., Lukac, R., Shi, G.: Sparse representation based image inter-
polation with nonlocal autoregressive modeling. Image Processing, IEEE Transac-
tions on 22(4) (April 2013) 1382–1394

20. Goh, W., Chong, M., Kalra, S., Krishnan, D.: Bi-directional 3D auto-regressive
model approach to motion picture restoration. In: Acoustics, Speech, and Signal
Processing, IEEE International Conference on. Volume 4. (May 1996) 2275–2278
vol. 4

21. Kokaram, A., Rayner, P.: Detection and interpolation of replacement noise in
In: Circuits and

motion picture sequences using 3D autoregressive modelling.
Systems, IEEE International Symposium on. Volume 3. (May 1994) 21–24 vol.3

22. Cand`es, E., Recht, B.: Exact matrix completion via convex optimization. Foun-

dations of Computational Mathematics 9(6) (2009) 717–772

23. Ono, S., Miyata, T., Yamada, I.: Cartoon-texture image decomposition using
blockwise low-rank texture characterization. Image Processing, IEEE Transactions
on 23(3) (March 2014) 1128–1142

24. Chen, Y.L., Hsu, C.T., Liao, H.Y.: Simultaneous tensor decomposition and comple-
tion using factor priors. Pattern Analysis and Machine Intelligence, IEEE Trans-
actions on 36(3) (March 2014) 577–591

25. Cai, J.F., Cands, E.J., Shen, Z.: A singular value thresholding algorithm for matrix

completion. SIAM Journal on Optimization 20(4) (2010) 1956–1982

26. Roth, S., Black, M.: Fields of experts: a framework for learning image priors. In:
Computer Vision and Pattern Recognition (CVPR), IEEE Conference on. Vol-
ume 2. (June 2005) 860–867 vol. 2

27. Takeda, H., Farsiu, S., Milanfar, P.: Robust kernel regression for restoration and
reconstruction of images from sparse noisy data. In: IEEE International Conference
on Image Processing. (2006) 1257–1260

28. Roth, S., Black, M.J.: Fields of experts. International Journal of Computer Vision

82(2) (2009) 205–229

29. Zhou, D., Shen, X., Dong, W.: Image zooming using directional cubic convolution

interpolation. Image Processing, IET 6(6) (2012) 627–634

