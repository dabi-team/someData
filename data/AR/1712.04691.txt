Draft version May 28, 2022
Preprint typeset using LATEX style emulateapj v. 04/20/08

7
1
0
2
c
e
D
3
1

]

R
S
.
h
p
-
o
r
t
s
a
[

1
v
1
9
6
4
0
.
2
1
7
1
:
v
i
X
r
a

STUDYING THE TRANSFER OF MAGNETIC HELICITY IN SOLAR ACTIVE REGIONS
WITH THE CONNECTIVITY-BASED HELICITY FLUX DENSITY METHOD
K. Dalmasse1, ´E. Pariat2, G. Valori3, J. Jing4, and P. D´emoulin2
1 CISL/HAO, National Center for Atmospheric Research, P.O. Box 3000, Boulder, CO 80307-3000, USA
2 LESIA, Observatoire de Paris, PSL Research University, CNRS, Sorbonne Universit´e, UPMC Univ. Paris 06, Univ. Paris Diderot, Sorbonne Paris cit´e,
F-92190 Meudon, France
3 Mullard Space Science Laboratory, University College London, Holmbury St. Mary, Dorking, Surrey, RH5 6NT, UK and
4 Space Weather Research Laboratory, Center for Solar Terrestrial Research, New Jersey Institute of Technology, 323 Martin Luther King Blvd., Newark, NJ
07102-1982, USA
Draft version May 28, 2022

ABSTRACT
In the solar corona, magnetic helicity slowly and continuously accumulates in response to plasma ﬂows
tangential to the photosphere and magnetic ﬂux emergence through it. Analyzing this transfer of magnetic
helicity is key for identifying its role in the dynamics of active regions (ARs). The connectivity-based he-
licity ﬂux density method was recently developed for studying the 2D and 3D transfer of magnetic helicity
in ARs. The method takes into account the 3D nature of magnetic helicity by explicitly using knowledge of
the magnetic ﬁeld connectivity, which allows it to faithfully track the photospheric ﬂux of magnetic helicity.
Because the magnetic ﬁeld is not measured in the solar corona, modeled 3D solutions obtained from force-
free magnetic ﬁeld extrapolations must be used to derive the magnetic connectivity. Diﬀerent extrapolation
methods can lead to markedly diﬀerent 3D magnetic ﬁeld connectivities, thus questioning the reliability of the
connectivity-based approach in observational applications. We address these concerns by applying this method
to the isolated and internally complex AR 11158 with diﬀerent magnetic ﬁeld extrapolation models. We show
that the connectivity-based calculations are robust to diﬀerent extrapolation methods, in particular with regards
to identifying regions of opposite magnetic helicity ﬂux. We conclude that the connectivity-based approach can
be reliably used in observational analyses and is a promising tool for studying the transfer of magnetic helicity
in ARs and relate it to their ﬂaring activity.
Subject headings: magnetic ﬁelds - Sun: photosphere - Sun: corona - Sun: ﬂares

1. INTRODUCTION
Magnetic helicity is a signed scalar quantity that measures
the three-dimensional complexity of a magnetic ﬁeld in a
volume (e.g., Finn & Antonsen 1985). Moﬀatt (1969) and
Berger & Field (1984) showed that magnetic helicity has a
well-deﬁned geometrical interpretation in terms of the entan-
glement, or braiding, of magnetic ﬁeld lines. Magnetic he-
licity thus generalizes more local properties such as magnetic
twist and shear.

The emergence of twisted/sheared magnetic ﬁelds from the
convection zone into the solar corona (e.g., Leka et al. 1996;
Moreno-Insertis 1997; Longcope & Welsch 2000; D´emoulin
et al. 2002b; Green et al. 2002; Georgoulis et al. 2009; Pevtsov
2012; Poisson et al. 2015), and the stressing of the coronal
magnetic ﬁeld by plasma ﬂows along the photosphere (e.g.,
van Ballegooijen & Martens 1989; Klimchuk & Sturrock
1992; Chae et al. 2001; Moon et al. 2002; Liu & Schuck 2012;
Zhang et al. 2012; Vemareddy 2015), slowly and continuously
build up magnetic helicity in the solar atmosphere. Because of
its conservation property in highly conducting plasmas (e.g.,
Woltjer 1958; Taylor 1974, 1986; Berger 1984; Pariat et al.
2015), magnetic helicity is thus believed to be a fundamen-
tal component for understanding the dynamics of the coronal
magnetic ﬁeld (e.g., Zhang et al. 2006, 2008; Kazachenko
et al. 2012; Tziotziou et al. 2012; Romano et al. 2014).

Magnetic helicity is hence at the heart of several MHD the-
ories of coronal processes including, but not limited to, coro-
nal heating through the relaxation of braided magnetic ﬁelds

Electronic address: dalmasse@ucar.edu

(e.g., Heyvaerts & Priest 1984; Russell et al. 2015; Yeates
et al. 2015), the formation of ﬁlament channels through the
inverse cascade of magnetic helicity (e.g., Antiochos 2013;
Knizhnik et al. 2015), the existence of CMEs as the mean for
the Sun to expel its magnetic helicity excess (e.g., Rust 1994;
Low 1996), and the production of very high-energy ﬂares
via magnetic helicity annihilation (Linton et al. 2001; Ku-
sano et al. 2004). Recently, Pariat et al. (2017) even showed
that speciﬁc quantities derived from magnetic helicity have a
strong potential for greatly improving the prediction of solar
eruptions.

Methods to estimate magnetic helicity in the solar context
are reviewed by Valori et al. (2016). Among these methods,
analyzing the temporal evolution of the helicity ﬂux through
the photosphere provides valuable information about the he-
licity content of ARs and is one of the means for better un-
derstanding the role of magnetic helicity in their dynamics
(see review by e.g., D´emoulin & Pariat 2009, and references
therein). When an AR is followed from the beginning of its
emergence, the temporal integration of the photospheric he-
licity ﬂux gives an estimate of its coronal helicity (e.g., Chae
2001; Kusano et al. 2003; Mandrini et al. 2004; Jeong & Chae
2007; LaBonte et al. 2007; Yang et al. 2009; Guo et al. 2013).
On the other hand, the photospheric distribution of helicity
ﬂux during the early stages of AR formation reﬂects the sub-
photospheric distribution of magnetic helicity in the associ-
ated emerging magnetic ﬁeld (e.g., Kusano et al. 2003; Chae
et al. 2004; Yamamoto et al. 2005; Pariat et al. 2006; Jing
et al. 2012; Park et al. 2013; Vemareddy & D´emoulin 2017).
This, in turn, gives constraints on the processes generating the
magnetic ﬁeld in the solar interior (e.g., Kusano et al. 2002;

 
 
 
 
 
 
2

Dalmasse et al.

Pariat et al. 2007). Later on during the lifetime of an AR, the
distribution of the helicity ﬂux allows to track where magnetic
helicity is being locally accumulated in response to additional
magnetic ﬂux emergence and photospheric ﬂows (e.g., Chan-
dra et al. 2010; Vemareddy et al. 2012b).

Studying the distribution of the helicity ﬂux in ARs is not
straightforward because it requires the use of a surface den-
sity of a quantity which is inherently 3D and not local. While
magnetic helicity density per unit volume is an unphysical
quantity, Russell et al. (2015) recently showed that it is pos-
sible to construct and study a magnetic helicity density per
unit surface from the recent developments of Yeates & Hornig
(2011, 2013, 2014). Previously, Pariat et al. (2005) had shown
that it was possible to deﬁne a useful proxy of surface density
of helicity ﬂux by explicitly expressing magnetic helicity in
terms of magnetic ﬁeld lines linkage. Such an approach is
achieved by including the connectivity of magnetic ﬁeld lines
in the deﬁnition of the total helicity ﬂux, leading to the con-
struction of a so-called connectivity-based surface density of
helicity ﬂux (further details are provided in Section 2.1).

Dalmasse et al. (2014) recently developed a method for the
practical computation of the connectivity-based helicity ﬂux
density to be used in observational studies. Using analytical
case-studies and numerical simulations, they showed that the
connectivity-based calculations provide a reliable and faithful
mapping of the helicity ﬂux. In particular, the method is suc-
cessful in revealing real mixed signals of helicity ﬂux in mag-
netic conﬁgurations, as well as in relating the local transfer
of magnetic helicity with the location of regions favorable to
magnetic reconnection. The former makes the method partic-
ularly interesting for testing the very high-energy ﬂare model
of Kusano et al. (2004) in observational surveys of solar ARs,
while the latter provides a new way for analyzing the role of
magnetic helicity accumulation in ﬂaring activity.

For analytical models and numerical MHD simulations, the
3D magnetic ﬁeld is known in the entire volume of the mod-
eled solar atmosphere and can be readily used to integrate
magnetic ﬁeld lines. In observational studies, however, po-
larimetric measurements in the corona are not as numerous
and routinely made as the photospheric and chromospheric
ones. And as the latters, coronal polarimetric measurements
are also 2D and, thus, cannot lead to magnetic ﬁeld data in
the full coronal volume without the use of some 3D model-
ing. On top of this, their inversion into magnetic ﬁeld data
is a very challenging task (e.g., Rachmeler et al. 2012; Kra-
mar et al. 2014; Plowman 2014; Dalmasse et al. 2016; Gibson
et al. 2016, and references therein). Hence, one must rely
on the approximate 3D solution of, e.g., nonlinear force-free
ﬁeld (NLFFF) models (e.g., Wheatland et al. 2000; Wiegel-
mann 2004; Amari et al. 2006; Valori et al. 2007; Inoue et al.
2012; Malanushenko et al. 2012) to extrapolate the coronal
magnetic ﬁeld from the photospheric maps of the magnetic
ﬁeld (vector magnetograms). Unfortunately, diﬀerent meth-
ods and assumptions can lead to markedly diﬀerent 3D mag-
netic ﬁeld solutions. These strong diﬀerences between recon-
structed magnetic ﬁelds aﬀect all subsequently derived quan-
tities. For instance, DeRosa et al. (2009, 2015) reported varia-
tions between extrapolation methods that can reach up to 30%
in free magnetic energy and 200% in magnetic helicity.

The analyses of DeRosa et al. (2009, 2015) raise con-
cerns about the reliability and relevance of the connectivity-
based helicity ﬂux density approach in observational appli-
cations. In this paper, we address these concerns by apply-
ing the connectivity-based method to observations of an AR

with diﬀerent magnetic ﬁeld extrapolation models and imple-
mentations. The selected AR is internally complex but ex-
ternally simple (i.e., no neighboring large-ﬂux systems). The
connectivity-based helicity ﬂux density method is reviewed
in Section 2. Section 3 describes the dataset and the approach
taken to estimate uncertainties in the helicity ﬂux intensity.
The magnetic ﬁeld extrapolations are discussed in Section 4.
Section 5 presents the results of our analysis. A discussion
and interpretation of our results is provided in Section 6. Our
conclusions are summarized in Section 7.

2. METHOD
2.1. Magnetic Helicity Flux Densities
Under ideal conditions, the transfer of magnetic helicity
through the photosphere, S, and into the solar atmosphere is
(e.g., D´emoulin et al. 2002a; Pariat et al. 2005)

(cid:90)

=

dH
dt

Gθ(x) dS .

(1)

S
Gθ(x) is a surface-density of magnetic helicity ﬂux deﬁned as

Gθ(x) = −

Bn(x)
2π

(cid:90)

S(cid:48)

dθ(x − x(cid:48))
dt

Bn(x(cid:48)) dS(cid:48) .

where

dθ(x − x(cid:48))
dt

= ((x − x(cid:48)) × (u − u(cid:48))) |n
|x − x(cid:48)|2

,

(2)

(3)

is the relative rotation rate (or relative angular velocity) be-
tween pairs of photospheric magnetic polarities located at x
and x(cid:48) and moving on the photospheric plane S with ﬂux-
transport velocity u = u(x) and u(cid:48) = u(x(cid:48)). The ﬂux-transport
velocity u is (D´emoulin & Berger 2003)

u = vt −

vn
Bn

Bt .

(4)

where subscript “t” and “n” respectively denote the tangential
and normal components of photospheric vector ﬁelds, v and
B are the photospheric plasma velocity and magnetic ﬁelds.

Equations (1) – (4) show that the total ﬂux of magnetic he-
licity through the photosphere, S, can be expressed as the
summation of the net rotation of all pairs of photospheric el-
ementary magnetic polarities around each other, weighted by
their magnetic ﬂux. It further shows that, at any given time, t,
the total ﬂux of magnetic helicity can be solely derived from
photospheric quantities, i.e., from a timeseries of vector mag-
netograms from which the ﬂux-transport velocity can also be
derived (Schuck 2008).

The surface-density of helicity ﬂux, Gθ, measures the varia-
tion of magnetic helicity in an AR only from the relative mo-
tions of its photospheric magnetic polarities. However, we
recall that magnetic helicity describes the global linkage of
magnetic ﬁeld lines in the volume. Therefore, what eﬀec-
tively modiﬁes the magnetic helicity of an AR is the rela-
tive re-orientation of magnetic ﬁeld lines, i.e., the variation
of their mutual helicity, in response to the motions of their
photospheric footpoints. Such a global, 3D nature of mag-
netic helicity and its variation is not taken into account in the
deﬁnition of Gθ. As a consequence, Gθ has a tendency to mis-
represent the local variation of magnetic helicity in ARs by
hiding the subtle eﬀects of the mutual helicity variation be-
tween magnetic ﬁeld lines, and by overestimating the local
helicity ﬂux when an AR is associated with opposite helicity
ﬂuxes (e.g., Dalmasse et al. 2014).

Studying the transfer of magnetic helicity in solar active regions

3

Pariat et al. (2005) showed that it is possible to remedy this
issue by explicitly re-arranging those terms in Equation (1)
that are related to the connectivity of elementary magnetic
ﬂux tubes. That allows to express the total ﬂux of magnetic
helicity in terms of the sum of the magnetic helicity variation
of each individual elementary ﬂux tube of the magnetic ﬁeld,
such that

dH
dt

(cid:90)

=

dhΦ
dt

Φ

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)c

dΦc ,

(5)

where hΦ is the magnetic helicity of the elementary magnetic
ﬂux tube, c, and dΦc its elementary magnetic ﬂux. hΦ is the
magnetic helicity density and describes how any elementary
ﬂux tube is linked/winded around all other elementary ﬂux
tubes (e.g., Berger 1988; Aly 2014; Yeates & Hornig 2014).
It can be shown that

dhΦ
dt

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)c

=

+

Gθ(xc+)
|Bn(xc+)|

Gθ(xc−)
|Bn(xc−)|
= ˙ΘB(xc+) − ˙ΘB(xc− ) ,

(6)

(7)

where xc+ (resp. xc− ) is the positive (resp. negative), pho-
tospheric, magnetic polarity of the elementary magnetic ﬂux
tube c (see Figure 1 of Dalmasse et al. 2014, for a generic
sketch of elementary ﬂux tubes and their photospheric con-
nectivity), and

˙ΘB(x) = −

1
2π

(cid:90)

S(cid:48)

dθ(x − x(cid:48))
dt

Bn(x(cid:48)) dS(cid:48) .

(8)

Note that the advantage of using Equation (7) over Equa-
tion (6) is to avoid artiﬁcial numerical singularities when
Bn(x) is very small.

Then, Pariat et al. (2005) deﬁned a new surface density
of helicity ﬂux by redistributing dhΦ/dt at each photospheric
footpoint of the elementary magnetic ﬂux tube, c, to map the
photospheric ﬂux of magnetic helicity

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)c

(9)

(cid:12)(cid:12)(cid:12)Bn(xc±)
(cid:12)(cid:12)(cid:12) .

GΦ(xc±) = 1
2

dhΦ
dt
Note that the factor 1/2 in Equation (9) assumes that both
photospheric footpoints of an elementary ﬂux tube contribute
equally to the variation of its magnetic helicity (a more gen-
eral case is described in Pariat et al. 2005). Note also that the
calculations of dhΦ/dt and GΦ require one signiﬁcant addi-
tional information as compared with Gθ, i.e., the connectivity
of the magnetic ﬁeld.

Finally, we stress here that both Gθ and GΦ are instanta-
neous estimations of injected helicity at particular location on
the photosphere, and not the total helicity content in the asso-
ciated ﬁeld line.

2.2. Numerical Method
Dalmasse et al. (2014) introduced a method to compute the
connectivity-based helicity ﬂux density proxy, GΦ. Using var-
ious analytical case studies and numerical MHD simulations,
they showed that GΦ properly tracks the site(s) of magnetic
helicity variations.

Their method is based on ﬁeld line integration to derive
the magnetic connectivity required to compute GΦ. For ob-
servational studies, routine magnetic ﬁeld measurements are
mostly realized at the photospheric level (cf. Section 1). We
thus perform force-free ﬁeld extrapolations to obtain the coro-
nal magnetic ﬁeld of the studied AR (see Section 4) and com-

pute the photospheric distribution of magnetic helicity ﬂux
from Equations (7) and (9).

Each pixel of the photospheric vector magnetogram is iden-
tiﬁed as the cross-section of an elementary magnetic ﬂux tube
with the photosphere. Each of these elementary ﬂux tubes
is associated with one magnetic ﬁeld line that is integrated to
obtain the connectivity. For any closed magnetic ﬁeld line, we
thus obtain a pair (xc+ ; xc− ) of photospheric footpoints, where
xc+ is the positive magnetic polarity of the elementary ﬂux
tube and xc− is its negative magnetic polarity at the photo-
sphere (z = 0). We then introduce a slight modiﬁcation to
Instead of
the method proposed in Dalmasse et al. (2014).
computing GΦ from Equation (6), which can lead to artiﬁcial
numerical singularities when Bn(x) is very small, we com-
pute dhΦ/dt and GΦ from Equations (7) and (9). Hence, once
the conjugate footpoint of a ﬁeld line is found, we compute
(cid:16) ˙ΘB(xc+) ; ˙ΘB(xc−)
using bilinear interpolation. Finally, ﬁeld
lines for which the conjugate footpoint reaches the top or lat-
eral boundaries are treated as open ﬁeld lines and both dhΦ/dt
and GΦ are simply set to zero. This is a second modiﬁcation to
the method of Dalmasse et al. (2014) justiﬁed by the fact that,
in this paper, we focus on comparing dhΦ/dt and GΦ com-
puted using diﬀerent magnetic ﬁeld extrapolations, i.e., two
quantities that are only deﬁned for closed ﬁeld lines.

(cid:17)

2.3. Metrics for Validation and Quantiﬁcation of GΦ Maps
In the connectivity-based helicity ﬂux density approach,
half the total helicity ﬂux computed from Gθ over the en-
semble of positive magnetic polarities is redistributed over
the ensemble of negative magnetic polarities, and vice-versa.
For this redistribution to be perfect, the total magnetic ﬂux
summed over the magnetic polarities where GΦ is computed
must vanish. If, for instance, the magnetic ﬂux from the neg-
ative magnetic polarities is smaller than that of the positive
ones, then a fraction of the total helicity ﬂux computed from
Gθ over the positive magnetic polarities is not redistributed in
the negative ones. This means that part of the total helicity
ﬂux computed with Gθ for the entire magnetic conﬁguration
is missing from that computed with GΦ. We thus introduce a
ﬁrst metric to validate GΦ maps, i.e., the percentage of mag-
netic ﬂux imbalance, τΦimb., for the closed magnetic ﬂux where
GΦ is computed

τΦimb.

=

(cid:18)(cid:82)

min

(cid:82)
Scl.

Bn(x) dS
(cid:12)(cid:12)(cid:12)(cid:12)

(cid:82)
Scl.(Bn<0) Bn(x) dS

(cid:19) .
(cid:12)(cid:12)(cid:12)(cid:12)

Scl.(Bn>0) Bn(x) dS ;

(10)
where SΦcl. is the part of the photosphere associated with the
closed magnetic ﬂux, Φcl..

By deﬁnition, the ﬂuxes measured by GΦ are simply a re-
distribution of the ﬂuxes measured by Gθ at both footpoints
of each elementary magnetic ﬂux tube in the closed magnetic
ﬁeld. Thus, the intensity of the magnetic helicity ﬂux in one
pixel can be diﬀerent for GΦ and Gθ. However, the total ﬂux
of magnetic helicity integrated over the closed magnetic ﬂux
from GΦ must be the same as that integrated from Gθ because
Equation (5) is equal to Equation (1) for the closed magnetic
ﬁeld. The second metric we deﬁned for the validation of GΦ
maps is thus

(cid:82)
SΦ

cl.

CSΦ

cl.

=

(GΦ(x) − Gθ(x)) dS
(cid:82)

Gθ(x) dS

SΦ

cl.

.

(11)

4

Dalmasse et al.

cl.

In theory, CSΦ
should be strictly equal to 0. In practice, how-
ever, its value depends on departures of τΦimb. from 0. Accu-
racy and validation of the GΦ map requires both that τΦimb. and
CSΦ

be close to 0.

Finally, we deﬁne two quantiﬁcation indices to compare the
signal intensity between GΦ and Gθ within the closed mag-
netic ﬁeld

cl.

C+ =

C− =

(cid:82)
Scl.(Gθ>0) Gθ(x) dS
(cid:82)
Scl.(GΦ>0) GΦ(x) dS
(cid:82)
Scl.(Gθ<0) Gθ(x) dS
(cid:82)
Scl.(GΦ<0) GΦ(x) dS

,

.

(12)

(13)

C+ and C− respectively compare the total positive and total
negative magnetic helicity ﬂuxes derived from Gθ with those
derived from GΦ in the closed magnetic ﬂux. Pariat et al.
(2005) and Dalmasse et al. (2014) showed that the helicity
ﬂux density proxy Gθ hides the true local helicity ﬂux and
tends to exhibit larger and spurious helicity ﬂux intensities as
compared with the GΦ proxy when opposite helicity ﬂuxes are
present in an AR. C+ and C− allow to quantify the intensity
of the spurious signals in Gθ, thus providing an idea of the
global improvement of the GΦ maps relatively to the Gθ ones.
In particular, large departures of C± from 1 are indicative of
strong spurious signals in Gθ.

3. OBSERVATIONS AND ERROR ANALYSIS
3.1. Data
We test the robustness of the connectivity-based helicity
ﬂux density method against diﬀerent magnetic ﬁeld extrap-
olation models of the internally complex AR 11158. This AR
appeared on the solar disk at the heliographic coordinates S19
E42 on 2011 February 10. The AR was the result of fast and
strong magnetic ﬂux emergence that produced two large-scale
bipoles, a northern and a southern one, in close proximity (see
Figure 1; e.g., Schrijver et al. 2011). The complex, quadrupo-
lar magnetic ﬁeld of this AR produced several C-/M-/X-class
ﬂares and CMEs during its on-disk passage (e.g., Toriumi
et al. 2014). A large fraction of this ﬂaring activity was as-
sociated with the collision between the negative magnetic po-
larity of the northern bipole, NN, and the positive magnetic
polarity of the southern bipole, SP, which led to a strong and
continuous shearing of their polarity inversion line. More de-
tails on the conﬁguration, evolution, and ﬂaring activity of the
AR can be found in e.g., Sun et al. (2012), Jiang et al. (2012),
Vemareddy et al. (2012a) and Inoue et al. (2013).

The coronal models of AR 11158 are computed using vec-
tor magnetograms taken by the Helioseismic and Magnetic
Imager (HMI, e.g., Schou et al. 2012) onboard the So-
lar Dynamics Observatory (SDO, e.g., Pesnell et al. 2012).
SDO/HMI provides full-disk vector magnetograms of the Sun
with a pixel size of 0.5(cid:48)(cid:48). For the purpose of this paper, we
re-use part of the data from Dalmasse et al. (2013) who had
applied the connectivity-based approach to AR 11158 with an
NLFFF extrapolation without addressing the possible depen-
dency of the results on the choice of extrapolation method. In
particular, vector magnetograms at 06:22 UT and 06:34 UT on
2011 February 14 from the HMI-SHARP data series, HARP
number 377 (Hoeksema et al. 2014) are re-used.

These two vector magnetograms are used to derive the
photospheric ﬂux transport velocity ﬁeld with the diﬀer-
ential aﬃne velocity estimator for vector magnetograms

Fig. 1.— Top: SDO/HMI photospheric vector-magnetogram at ∼ 06:28 UT.
The gray scale displays the vertical component, Bz (in Gauss), while the yel-
low/blue arrows show the transverse component of the magnetic ﬁeld. Bot-
tom: vertical magnetic ﬁeld overplotted with the ﬂux transport velocity ﬁeld
(green/orange arrows). Pink and cyan solid lines show Bz = ±500 Gauss
isocontours.

(DAVE4VM; Schuck 2008), using a window size of 19 pix-
els as suggested by Liu et al. (2013). The computed ﬂux
transport velocity ﬁeld eﬀectively represents an instantaneous
ﬂux transport velocity ﬁeld at ∼ 06:28 UT. The two vector
magnetograms taken at 06:22 UT and 06:34 UT are averaged
to construct an instantaneous vector magnetogram associated
with the ﬂux transport velocity ﬁeld at ∼ 06:28 UT. The con-
structed vector magnetic ﬁeld is then used both to compute Gθ
and as the photospheric boundary condition for the diﬀerent
FFF extrapolations presented Section 4. The vector magnetic
ﬁeld and ﬂux transport velocity ﬁeld at ∼ 06:28 UT are shown
in Figure 1.

3.2. Estimation of Helicity-Flux Uncertainties
As part of testing the reliability of the connectivity-based
helicity ﬂux density method, we also wish to evaluate un-
certainties in Gθ and GΦ maps caused by those in the pho-
tospheric magnetic ﬁeld. In particular, our error analysis in-
cludes both the eﬀect of photon noise (≈ 10 Gauss) and sev-
eral sources of systematic errors. Hoeksema et al. (2014)
recently performed an extensive analysis of the uncertain-
ties in the measurements of the magnetic ﬁeld strength by
SDO/HMI. In particular, they focused on the uncertainty anal-
ysis for NOAA 11158. Among several sources of system-

Studying the transfer of magnetic helicity in solar active regions

5

Fig. 2.— Selected closed ﬁeld lines of the 3D extrapolated magnetic ﬁeld for the potential ﬁeld (labelled POT; left), the NLFFF from the magneto-frictional
relaxation method (labelled NLFFF-R; middle), and the NLFFF from the optimization method (labelled NLFFF-O; right). The magnetic ﬁeld lines were integrated
from the same -randomly selected- photospheric footpoints for all three extrapolations (the same colour is used for the same footpoint). The gray scale displays
the photospheric vertical magnetic ﬁeld, Bz, with ±500 Gauss isocontours (purple and cyan solid lines).

atic errors, including those related with the inversion code,
they found that the dominant contribution of uncertainty in
SDO/HMI magnetic ﬁeld measurements is coming from the
daily variation of the radial velocity of the spacecraft along
its geosynchronous orbit. Their analysis concludes that the
typical uncertainty in SDO/HMI measurements of the mag-
netic ﬁeld strength is about 100 Gauss. The latter can be
easily checked from the estimated ﬁeld-strength error map of
NOAA 11158 provided by the SDO/HMI pipeline and which
can be downloaded from JSOC1. We also want to compare
these errors with those related with the choice of magnetic
ﬁeld extrapolation used to compute GΦ.

For that purpose, we conduct a Monte Carlo experiment
as proposed by Liu & Schuck (2012) for error estimation of
the total helicity ﬂux. Random noise with a Gaussian dis-
tribution having a width (σ) of 100 Gauss is added to all
three components of the magnetic ﬁeld for both vector mag-
netograms taken at 06:22 UT and 06:34 UT. 100 Gauss is the
≈ 1σ uncertainty in the total magnetic ﬁeld strength from
HMI data estimated by Hoeksema et al. (2014) and further
reported in Bobra et al. (2014). The uncertainty is then prop-
agated through the chain of helicity ﬂux density calculations
to the ﬂux transport velocity ﬁeld at the photosphere derived
from DAVE4VM, the corresponding vector magnetogram at
∼ 06:28 UT, and ﬁnally to the Gθ and GΦ maps.

Although they did not perform a full parametric analysis,
Wiegelmann et al. (2006) showed that extrapolations with
the optimization method were not signiﬁcantly aﬀected by
modest noise in the photospheric vector magnetogram. They
found that the preprocessing of the photospheric data towards
a more force-free state (see e.g., Section 4.2) strongly helps
in that matter. This may be expected considering that the ran-
dom noise on the photospheric vector magnetic ﬁeld acts as
a source of non-force-free signals on high spatial frequencies
while the preprocessing ﬁlters such signals out. Even if FFF
reconstructions would likely be diﬀerently aﬀected by noise
in the photospheric data, its global eﬀect on the extrapola-
tions should be limited by the preprocessing stage. On the
other hand, FFF extrapolations are more likely to be aﬀected
by more global eﬀects including, but not limited to, large-
scale non-force-free regions not suppressed by the prepro-
cessing, magnetic ﬂux imbalance, and lateral boundary con-

1 http://jsoc.stanford.edu/ajax/lookdata.html

ditions. Then, as far as GΦ is concerned, the eﬀect of random
noise on the extrapolation results is to introduce uncertainties
in the connectivity of the magnetic ﬁeld. In this regard, we
believe that the choice of extrapolation method and prepro-
cessing level is more fundamental and has a stronger impact
on the magnetic connectivity, and hence, on GΦ. For these
reasons, we decided not to propagate the noise to the FFF ex-
trapolations.

The noise propagation experiment is repeated 100 times,
producing 100 noise-added Gθ and GΦ maps for all three FFF
extrapolations considered in this paper. For each scalar quan-
tity, F , the 1σ estimated error, σF , is computed as the mean,
over all the n pixels of the map, of the root mean square of the
N = 100 noise-added F -maps, F i
, compared with the
no-noise F -map, Fn.n.

x j

x j

n.a.

(cid:17)

(cid:16)

(cid:16)

(cid:17)

σF = 1
n





1
N

n(cid:88)

j=1

N(cid:88)

i=1

(cid:16)

(cid:16)
F i

n.a.

x j

(cid:17)

− Fn.n.

(cid:17)(cid:17)2

(cid:16)

x j

1
2





.

(14)

4. FORCE-FREE MAGNETIC FIELD EXTRAPOLATIONS
We perform three force-free ﬁeld extrapolations using dif-
ferent assumptions and methods: (1) the potential magnetic
ﬁeld, (2) a nonlinear FFF (NLFFF) reconstruction using the
magneto-frictional method of Valori et al. (2010), and (3) an
NLFFF generated with the optimization method of Wiegel-
mann (2004). The extrapolations and setup used to produce
them are described hereafter.

At this stage, we wish to emphasize that many more ex-
trapolation assumptions, methods, and implementations, ex-
ist in the literature. These diﬀerent methods are further dis-
tinguished in terms of the physical information that they ex-
tract from the photospheric vector magnetograms and use as
boundary conditions. For instance, some NLFFF codes use
vector magnetograms as boundary conditions, as is the case of
the magneto-frictional relaxation implemented by, e.g., Val-
ori et al. (2010), or the optimization method implemented
by, e.g., Wiegelmann & Inhester (2010). Others built on the
Grad-Rubin approach (Grad & Rubin 1958) use the normal
component of the photospheric magnetic ﬁeld and the force-
free parameter – derived from the vector magnetograms –
as boundary conditions (e.g., Amari et al. 2006; Wheatland
2007). Recently, Malanushenko et al. (2012) also proposed

6

Dalmasse et al.

a Quasi-Grad-Rubin method that only uses the photospheric
normal magnetic ﬁeld, but combined with coronal loops ﬁt-
ting to constrain the coronal distribution of the force-free pa-
rameter. Finally, several codes haven been recently developed
to perform a full MHD relaxation using photospheric vector
magnetograms, thus distinguishing them from NLFFF models
through the inclusion of plasma forces in the reconstruction of
the 3D magnetic ﬁeld of ARs (e.g., Inoue & Morikawa 2011;
Jiang & Feng 2012; Zhu et al. 2013). All these diﬀerent codes
and methods can be used to model the coronal magnetic ﬁeld
of ARs from which we can derive the magnetic connectiv-
ity required to use the connectivity-based helicity ﬂux density
approach to map the helicity ﬂux in ARs.

Several of these methods have been compared with each
others in e.g., DeRosa et al. (2009, 2015), including the two
NLFFF methods used in this paper. From these studies, it
appears that the three extrapolation methods considered here
generally produce diﬀerences in ﬁeld-lines distribution that
are representative of the diﬀerences that can be expected be-
tween the coronal magnetic ﬁelds reconstructed with other
FFF methods. We thus expect the diﬀerences in the dhΦ/dt
and GΦ calculations presented in this paper to be representa-
tive of the diﬀerences that would be obtained when computing
the connectivity-based helicity ﬂux density with other extrap-
olation methods. For this reason, we limit ourselves to the
analysis of helicity ﬂux density calculations with the three ex-
trapolations described below.

The extrapolation presented hereafter are performed on a ﬁ-
nite ﬁeld of view with open side and top boundaries, but with-
out assuming magnetic ﬂux balance. Magnetic ﬂux is thus
free to leave the extrapolation domain as open-like magnetic
ﬁeld. Such open-like magnetic ﬁeld may represent truly open
magnetic ﬁeld and/or connections with the very distant quiet
Sun and surrounding ARs. Helicity ﬂux density calculations
are not performed for open-like ﬁeld lines because GΦ and
dhΦ/dt are not deﬁned for open magnetic ﬂux tubes (cf. Sec-
tion 2.2). For that reason, open ﬁeld lines are not plotted in
any of the ﬁeld-line plots presented throughout the paper.

Working with a ﬁnite ﬁeld of view may be a strong limita-
tion to reconstruct the magnetic ﬁeld of ARs. Not only is the
entire photosphere always populated with quiet Sun magnetic
ﬂux, but there are also often more than one AR on the Sun at
a given time (e.g., Schrijver et al. 2013). The eﬀect of using a
limited ﬁeld of view is to remove large-scale connections with
the distant quiet Sun and surrounding ARs that are outside
the ﬁeld of view considered for the extrapolation. Such dis-
tant connections may inﬂuence the results of the helicity ﬂux
density calculations with the connectivity-based method. To
test such an inﬂuence, one needs to compare the connectivity-
based helicity ﬂux density computed from a global, full-Sun
magnetic ﬁeld reconstruction in spherical geometry vs. from
a local magnetic ﬁeld extrapolation. However, current global
reconstructions of the solar magnetic ﬁeld are limited by the
fact that there is no full-Sun vector magnetograms at any sin-
gle time, and hence, no proper data for the boundary condi-
tions of full-Sun extrapolation codes. A proper analysis of the
eﬀect of distant ARs on the helicity ﬂux density calculations
would therefore require numerical modeling. Such a study
is not the goal of the present work. The vast majority of in-
vestigations relying on NLFFF extrapolations are focusing on
single ARs with the same type of limited ﬁeld of view and in-
herent hypotheses that are also used in the present manuscript.
We are presently testing the reliability of connectivity-based
helicity ﬂux density calculations with regard to such NLFFF

modeling, i.e., we aim to determine if and to which extent dif-
ferent choices of NLFFF computation schemes applied to a
compact active region can impact the distribution of the helic-
ity ﬂux density.

4.1. Potential Field
The current-free magnetic ﬁeld is the minimal-energy pos-
sible state for the given distribution of magnetic ﬁeld at the
boundaries of the considered volume. In addition, the poten-
tial ﬁeld is often used as an initial state of numerical methods
that build the more complex NLFFF models (see review by,
e.g., Wiegelmann & Sakurai 2012). It is therefore an impor-
tant candidate to consider for testing the connectivity-based
helicity ﬂux density method, despite its limitation in repro-
ducing nonlinear features of the coronal ﬁeld.

The potential ﬁeld can be directly computed using the po-
tential theory and the reﬂection principle to solve the Laplace
equation for the scalar potential in terms of the ﬂux through
the photospheric boundary (Schmidt 1964). However, in or-
der to speed up the calculation, such a method is actually used
only to compute the scalar potential on all six boundaries of
the considered volume. The magnetic scalar potential in the
volume is then computed solving the Laplace equation, sub-
jected to the obtained Dirichlet boundary conditions, using
a fast Helmholtz solver from the Intel Mathematical Kernel
Library. For the required vertical component of the ﬁeld on
the lower boundary, the same vertical component as for the
NLFFF extrapolation described Section 4.2 is used. The po-
tential ﬁeld extrapolation is referred to as POT in the follow-
ing and selected ﬁeld lines for this extrapolation are shown in
the leftmost panel of Figure 2.

4.2. NLFFF from Magneto-Frictional Relaxation
NLFFF extrapolations are models of the coronal magnetic
ﬁeld that assume the corona to be static on the time scale of
interest, and to be dominated by magnetic forces that are dis-
tributed in a way such that the resulting Lorentz force is every-
where vanishing. Such assumptions are supposed to be valid
in the entire volume of interest, boundaries included. The
magneto-frictional relaxation method implements numerical
relaxation and multi-grid techniques to solve the correspond-
ing equations (see Valori et al. 2007, 2010; DeRosa et al.
2015, for more details).

The remapped and disambiguated vector magnetograms
from the HMI-SHARP data series were interpolated to 1(cid:48)(cid:48)-
resolution and averaged to construct the vector magnetogram
at 06:28 UT (cf. Section 3.1) used for the NLFFF extrapo-
lation. Vector magnetograms are inferred from spectropolari-
metric measurements taken at photospheric heights, where the
plasma is non-force-free. Therefore, in order to use the vector
magnetogram as a boundary condition for the NLFFF extrap-
olation code, the forces acting on the magnetogram need to be
reduced (preprocessing). To this purpose we use the method
of Fuhrmann et al. (2007, 2011). In this application, only the
horizontal components of the ﬁeld are preprocessed, yield-
ing a reduction of the forces from 0.035 to 0.002 in the non-
dimensional units used in Metcalf et al. (2008). Since smooth-
ing is not necessarily facilitating the extrapolation (Valori
et al. 2013), no smoothing was applied. The resulting mag-
netogram was then extrapolated using the magneto-frictional
code into a volume of about 208 × 202 × 145 Mm3.

The resulting extrapolated ﬁeld has solenoidal errors that
can be quantiﬁed using the formula by Valori et al. (2013)

Studying the transfer of magnetic helicity in solar active regions

7

TABLE 1
Metrics for validation and quantification of GΦ maps

TABLE 2
Error estimations from Monte Carlo experiment

FFF model

C+

C−

τΦimb.
1.2 × 10−3
−7.6 × 10−3
2.6 × 10−3

cl.

CSΦ
4.2 × 10−4
4.7 × 10−2
3.2 × 10−2

1.32
1.21
1.23

1.71
1.67
1.57

POT
NLFFF-R
NLFFF-O
Note. — The table presents the validation and quantiﬁcation metrics for
the maps displayed in Figure 3. All metrics are dimensionless ratios deﬁned
by Equations (10) – (13).
into 9% of the total magnetic energy. The fraction of the total
current that is perpendicular to the ﬁeld is σJ = 0.48 (Wheat-
land et al. 2000), a rather high value that is not uncommon for
extrapolation of HMI vector magnetograms with the magneto-
frictional method (see Valori et al. 2012, for an application to
Hinode/SP magnetogram with a much lower σJ). Selected
ﬁeld lines of the NLFFF obtained in this way, and referred to
as NLFFF-R in the following, are shown in the central panel
of Figure 2.

4.3. NLFFF from Optimization Method
For the second NLFFF model considered in this paper, we
use the weighted optimization method (Wiegelmann 2004),
which is an implementation and modiﬁcation of the origi-
nal optimization algorithm of Wheatland et al. (2000). The
optimization method minimizes an integrated joint measure,
which comprises the normalized Lorentz force, the magnetic
ﬁeld divergence, and treatment of the measurement errors,
over the computational domain (see Wiegelmann & Inhester
2010; Wiegelmann et al. 2012, for more details).

To perform the extrapolation, the vector magnetogram (Fig-
ure 1) is ﬁrst rebinned to 1(cid:48)(cid:48) per pixel and preprocessed to-
wards the force-free condition using the method of Wiegel-
mann et al. (2006). The extrapolation is ﬁnally performed
on a uniform grid of 256 × 256 × 200 points covering ∼
185 × 185 × 144 Mm3. We ﬁnd a solenoidal error of 1%
of the total magnetic energy and a fraction of total current
perpendicular to the magnetic ﬁeld σJ = 0.20. These values
are lower than for the NLFFF-R model (Section 4.2), which is
due both to diﬀerent preprocessing and extrapolation methods
and strategies.

In the following, the NLFFF model built with the optimiza-
tion method is referred to as NLFFF-O. A set of selected mag-
netic ﬁeld lines is shown in the rightmost panel of Figure 2.

5. RESULTS
In this section, we analyze the results from the connectivity-
based helicity ﬂux density calculations. The validation of
the maps, error estimations, and qualitative comparisons are
brieﬂy presented in Section 5.1. The one-to-one quantitive
comparisons are discussed in Section 5.2.

5.1. Helicity-Flux Density Distribution
Table 1 presents the validation metrics for the GΦ maps
computed from the three FFF extrapolation models described
Section 4. For all three GΦ maps, we obtain τΦimb. below 1%
and CSΦ
below 5%. This allows us to verify that the mag-
netic ﬂux over which the connectivity-based helicity ﬂux den-
sity is computed is very well balanced and that the calculation
of dhΦ/dt and GΦ well preserves the total helicity ﬂux in that
region in the closed magnetic ﬂux. Together, these numbers
enable us to conﬁrm the accuracy of the GΦ and dhΦ/dt cal-
culations discussed in the following.

cl.

Gθ

3.7

σ

GΦ(POT)

GΦ(NLFFF-R)

GΦ(NLFFF-O)

2.6

2.2

3.0

Note. — The errors are in units of 105 Wb2 m−2 s−1, i.e., ∼ 10 − 100
times smaller than the typical values displayed by the Gθ and GΦ maps from
Figure 3. See Section 3.2 for a description of error calculations.

Figure 3 presents the surface density of helicity ﬂux from
the purely photospheric proxy, Gθ, and the connectivity-based
proxy, GΦ, computed from all three FFF extrapolations. The
mean of the absolute value of the helicity ﬂux signal in most
of the AR (i.e., |Bz| ≥ 100 G) is 2.8 × 106 Wb2 m−2 s−1 for the
Gθ map and 1.7 × 106 Wb2 m−2 s−1 for the GΦ maps, while
a large fraction of the maps is associated with local helicity
ﬂuxes of 107 Wb2 m−2 s−1. As shown in Table 2, the errors
for Gθ and GΦ estimated from our Monte Carlo experiment
are 3.7 × 105 Wb2 m−2 s−1 for Gθ and lower than 3 × 105 Wb2
m−2 s−1 for GΦ. The signal intensity of the surface density
maps in Figure 3 is thus well above the estimated noise level.
Figure 3 shows that the largest diﬀerences in helicity ﬂux
density maps are between Gθ and the three GΦ maps. In par-
ticular, the strongest diﬀerences are associated with magnetic
ﬂux systems that connect footpoints of opposite Gθ signs, i.e.,
footpoints of NN connected to NP, footpoints of SN connected
to SP, and footpoints of SN connected to NP. On the other
hand, the Gθ map is relatively similar to the three GΦ maps
for the ﬂux system connecting NN to SP, because magnetic
ﬁeld lines are connecting footpoints with similar values of
Gθ(x)/|Bn(x)|. This is consistent with the work of Pariat et al.
(2005) and Dalmasse et al. (2014) who showed that Gθ hides
the true helicity ﬂux signal when simultaneous opposite helic-
ity ﬂuxes are present in a magnetic conﬁguration. This eﬀect
is inherent to the deﬁnition of Gθ that does not acknowledge
the fact that the variation of magnetic helicity in an elemen-
tary magnetic ﬂux tube comes from the motions of its two
photospheric footpoints with respect to the other elementary
ﬂux tubes of the entire magnetic conﬁguration. As a result, the
comparison of the total positive helicity ﬂux and total nega-
tive helicity ﬂux from Gθ in the closed magnetic ﬂux with the
same quantities computed for each one of the GΦ maps leads
values of C+ > 1.2 and C− > 1.5 (see Table 1). Such values
indicate that Gθ is aﬀected by moderate spurious positive sig-
nals and rather high spurious negative helicity ﬂuxes that are
corrected for by the use of GΦ (cf. Section 2.3). Figure 3 thus
highlights the fact that the redistribution of helicity ﬂux oper-
ated by GΦ is crucial to the photospheric mapping of helicity
ﬂux in ARs, regardless of the coronal magnetic ﬁeld model-
ing.

All three GΦ maps in Figure 3 are in very good qualita-
tive agreement, showing (i) a negative helicity ﬂux in SN, (ii)
a strong positive helicity ﬂux in NN and SP, and (iii) strong
positive and negative helicity ﬂuxes with a strongly marked
interface in NP. The GΦ maps from the two NLFFF models
are very similar. Setting aside the white signal in SN, which
is due to open ﬁeld-lines where GΦ is not computed, and fo-
cusing on the common areas where all three extrapolations
have closed magnetic ﬂux, we ﬁnd that the helicity ﬂux den-
sity map derived from the potential ﬁeld is also similar to the
GΦ maps derived from the two NLFFF models. The most no-
ticeable diﬀerence is in the south-east part of NN that does
not show any signiﬁcant helicity ﬂux for GΦ(POT), contrary

8

Dalmasse et al.

Fig. 3.— Surface densities of helicity ﬂux for AR 11158 at ∼ 06:28 UT on 2011/02/14 (in units of 107 Wb2 m−2 s−1) computed from the purely photospheric
proxy (Gθ; top left) and the connectivity-based proxy (GΦ) derived using the three FFF extrapolations (top right, and bottom row). Purple and cyan solid lines
show Bz = ±500 Gauss isocontours from the original photospheric vector magnetogram of SDO/HMI. The presence of strong white (i.e., zero) signals in the left
part of SN and north-right part of NP for all three GΦ maps is due to open-like magnetic ﬂux where dhΦ/dt and GΦ are not deﬁned, and hence, not computed.

to both GΦ(NLFFF-R) and GΦ(NLFFF-O).

Finally,

the good qualitative agreement between the
connectivity-based helicity ﬂux density calculations from the
three FFF extrapolations is further emphasized by the 3D rep-
resentation of dhΦ/dt in Figure 4. They all show that the inner
part of the AR is dominated by strong positive helicity ﬂuxes
and is embedded within a magnetic ﬁeld region dominated by
strong negative helicity ﬂuxes. The core results of Dalmasse
et al. (2013) are thus conﬁrmed with a weak dependance on
the extrapolation method.

5.2. Quantitative Analysis
We now focus on the quantitative comparison of the helicity
ﬂux density calculations obtained from the three FFF models.
We restrict our analysis to the pixels of the GΦ maps that are
above the noise level (diﬀerent for each map) estimated from
the Monte Carlo experiment. The error levels are given in
Table 2.

Figure 5 displays the three maps of sign agreement. The re-
gions where our analysis can be carried out (white and black)
is mostly associated with the strong magnetic ﬁeld of AR
11158, i.e., where |Bz| (cid:38) 500 Gauss. These regions corre-
spond to the area where most of the helicity ﬂux (at least 88%
of the total unsigned helicity ﬂux) computed with GΦ is com-
ing from. This is because the helicity ﬂux intensity outside
these regions is below the noise level of the respective GΦ
maps. Despite the presence of some relatively small areas of
disagreement (black patches), we ﬁnd that these regions are
dominated by agreement (white signal) over the sign of he-

licity ﬂux derived using diﬀerent FFF extrapolations. In par-
ticular, the percentage of surface area for which pairs of GΦ
maps agree is always larger than 85%, which translates into
more than ≈ 84% in terms of magnetic ﬂux. Therefore, the lo-
cal sign of helicity ﬂux computed from the connectivity-based
helicity ﬂux density method is very robust to the diﬀerent FFF
models and assumptions used for calculations.

Figure 6 displays the linear correlation plots of GΦ values in
each pixel, for diﬀerent pairs of FFF extrapolations. For com-
parisons between GΦ from the potential ﬁeld model and one
of the two NLFFFs, the points are colored according to the
strength of the photospheric electric current density, | jz|, from
the diﬀerent preprocessed boundary employed in the NLFFF
model under consideration. For the plot comparing GΦ from
the two NLFFF extrapolations, the points are colored accord-
ing to (| jz(NLFFF-R)|·| jz(NLFFF-O)|)1/2. Such a color coding
was introduced in order to investigate the dependency of the
scatter on the electric current density of magnetic ﬁeld lines
where GΦ is computed.

In each scatter plot, we ﬁnd that the spatial distribution
of points exhibits a clear ellipsoidal shape aligned along the
y = x diagonal line. Each one of these distributions display a
moderate dispersion. The three standard deviations computed
from each scatter plot of Figure 6 are ≤ 2.6 × 106 Wb2 m−2
s−1, which is 5 to 10 times smaller than most of the signal in
the four main magnetic polarities. These standard deviations
are ≈ 10 times larger than the GΦ errors estimated from the
Monte Carlo experiment (Table 2). As anticipated, it means
that, despite the substantial agreement on the sign of the in-

Studying the transfer of magnetic helicity in solar active regions

9

Fig. 4.— 3D representation of the connectivity-based helicity ﬂux density for each FFF extrapolation. The magnetic ﬁeld lines were integrated from the same
-randomly selected- photospheric footpoints for all three extrapolations. They are colored according to their dhΦ/dt value. Purple and cyan solid lines show
Bz = ±500 Gauss isocontours from the FFF extrapolation.

TABLE 3
Scatter plots dispersion vs. electric current density

jz

]0, 0.2]

]0.2, 3.1]

]3.1, 15.6]

]15.6, 50.0]

[1.5, 1.8]

[2.6, 3.6]

[1.8, 2.0]

σGΦ
Note. — The interval for the standard deviation, σGΦ , is derived from the
values obtained for the three scatter plots of Figure 6. The electric current
density is in units of mA m−2 and the dispersion in units of 106 Wb2 m−2
s−1. From left to right, the ﬁve ranges of electric current density correspond
to ]black; dark blue], ]dark blue; green], ]green; yellow], and ]yellow; red]
of the color-scale in Figure 6.

[3.0, 4.1]

jected helicity between diﬀerent extrapolations, a signiﬁcant
uncertainty in the connectivity-based calculations is coming
from the choice of extrapolation model used to derive the ﬁeld
line connectivity.

Figure 6 further shows that the ellipsoidal pattern of the
distribution of points is present independently of the electric
current density, i.e., of the color of the points. We also no-
tice that the scattering of points away from the y = x line
presents some relatively weak dependance on the electric cur-
rent density of the ﬁeld lines used for the connectivity-based
calculations. In particular, we ﬁnd a dispersion in the range
≈ [1.5, 2.0] × 106 Wb2 m−2 s−1 for black to green points, and
≈ [2.6, 4.1]×106 Wb2 m−2 s−1 for green to red points (ﬁner de-
tails are provided in Table 3). In addition, the number of pix-
els with average-to-strong electric current density (i.e., green
to red points) is sensibly the same as the number of pixels
with very weak-to-average electric current density (i.e., black
to green points). This implies that the correlation coeﬃcients,
displayed in Figure 6 and discussed below, are not dominated
by the diﬀerences in GΦ values from nearly-potential mag-

10

Dalmasse et al.

as the NLFFF-O (whose extrapolation domain is common
to all three models) using trilinear interpolation. We ﬁnd
Cvec(BNLFFF−R, BPOT) = 0.84, Cvec(BNLFFF−O, BPOT) = 0.90,
and Cvec(BNLFFF−O, BNLFFF−R) = 0.90. Such values for the
vector correlation metric of the magnetic ﬁelds are very high
even though the 3D distributions of the magnetic ﬁeld lines
are relatively diﬀerent when comparing the three extrapola-
tions, as inferred from Figure 2. We thus ﬁnd that the vector
correlation metric for the magnetic ﬁelds is higher than the
Pearson and Spearman correlation coeﬃcients found when
comparing the helicity ﬂux density calculations.

6. DISCUSSION
At this point, we wish to emphasize that the robustness
of the connectivity-based method against diﬀerent magnetic
ﬁeld extrapolations does not mean that the extrapolations are
very much alike. On the contrary, all three extrapolations
considered here produce 3D magnetic ﬁelds that are diﬀerent
from each other as shown in Figure 2. So, what does it mean
that the connectivity-based helicity ﬂux density calculations
are robust against diﬀerent extrapolation methods?

First of all, we remind the reader that the surface-density
of helicity ﬂux, GΦ, only explicitly depends on the connectiv-
ity of magnetic ﬁeld lines and not on their 3D geometry; the
latter only has an implicit eﬀect on GΦ by aﬀecting the mag-
netic connectivity. Secondly, expanding Equation (9) using
Equation (7) leads to

GΦ(x+) =

|Bn(x+)|
2

(cid:16) ˙ΘB(x+) − ˙ΘB(x−)

(cid:17)

.

(15)

Equation (15) shows that, for a given footpoint x+, the helic-
ity ﬂux density GΦ from diﬀerent extrapolation models will
be exactly the same (1) if they have the exact same magnetic
ﬁeld connectivity, or (2) if they have a diﬀerent connectivity,
the ﬁrst extrapolation links x+ to x1− and the second links x+
(cid:44) x1−, but ˙ΘB(x2− ) = ˙ΘB(x1−). The same type of con-
to x2−
clusion can be drawn for GΦ(x−) by simply exchanging x+ and
x−. Note that condition (2) relates to the spatial smoothness
of ˙ΘB(x) and, by extension, Gθ(x).

In general, GΦ can distinguish two magnetic ﬁelds that have
diﬀerent photospheric magnetic connectivities. This is ev-
ident from the connectivity-based ﬂux density maps shown
Figure 3 and the clear dispersion shown in the scatter plots
of Figure 6. However, we argue that as long as two diﬀerent
3D magnetic ﬁelds have, on average, a similar magnetic con-
nectivity, then the GΦ maps computed from these magnetic
ﬁelds should display a good overall agreement. Note that, al-
though not discussed, this was already observed by Dalmasse
et al. (2014) for the models analyzed in their Figures 8, 10,
11, and 12. The strongest diﬀerences would then be expected
in localized regions where the magnetic connectivity from the
extrapolations is markedly diﬀerent, typically in the close sur-
roundings of quasi-separatrix layers (QSLs) which are regions
of strong gradients of the magnetic connectivity that are favor-
able to magnetic reconnection (e.g., D´emoulin et al. 1996;
Titov et al. 2002; Aulanier et al. 2006; Janvier et al. 2013).
This is indeed what we ﬁnd in our analysis of AR 11158, e.g.,
at the interface of positive and negative helicity ﬂuxes in NP
(see Figure 3) that coincides with a large-scale QSL that sep-
arates ﬁeld-lines connecting NP to NN and NP to SN.

Then, we recall that GΦ is only a 2D representation of the
physical, 3D, deﬁnition of local magnetic helicity variation,
dhΦ/dt. dhΦ/dt is only deﬁned for elementary magnetic ﬂux

Fig. 5.— Maps of GΦ-sign agreement between the surface-density maps ob-
tained with the three FFF models. For each map, [white; black] = [agree;
disagree], while gray corresponds to pixels that are either associated with
open-like ﬁeld-lines (where GΦ is not computed) or where GΦ is below the
noise level for at least one of the two models being compared. Purple and
cyan solid lines show Bz = ±500 Gauss isocontours from the original photo-
spheric magnetogram of SDO/HMI.

netic ﬁeld lines.

For all three scatter plots, we ﬁnd that the Pearson, cP, and
Spearman, cS , correlation coeﬃcients are such that cP ≥ 0.75
and cS ≥ 0.72. We checked that these values are statistically
signiﬁcant by conducting a null hypothesis test (details and
results of this test are provided in Appendix A). We therefore
conclude that the calculations of the connectivity-based helic-
ity ﬂux density derived from diﬀerent FFF extrapolations are
highly correlated and consistent with each other.

For further comparison, we compute the vector correla-
tion metric, Cvec, comparing the three 3D magnetic ﬁeld
extrapolations as deﬁned by Equation (28) of Schrijver
et al. (2006).
the POT and NLFFF-
R 3D magnetic ﬁelds are interpolated on the same grid

For that purpose,

Studying the transfer of magnetic helicity in solar active regions

11

Fig. 6.— Scatter plots of pixel-to-pixel comparison of the surface-density of helicity ﬂux. The black solid line shows the y = x line. “Pearson”, “Spearman”, and
“Stand. dev.” respectively are the Pearson correlation coeﬃcient, the Spearman correlation coeﬃcient, and the standard deviation. The standard deviation is in
units of 107 Wb2 m−2 s−1. From the left to the right panel, the color scale corresponds to | jz(NLFFF-R)|, | jz(NLFFF-O)|, and
| jz(NLFFF-R)| · | jz(NLFFF-O)|.
Notice the color scale for the current density is not linear, but was instead chosen as (cid:107) · (cid:107)1/4 with saturation at 50 mA m−2 for dynamic range optimization.

(cid:112)

tubes. Its 3D representation thus requires to plot individual
ﬁeld lines. Since diﬀerent magnetic ﬁeld extrapolation meth-
ods and assumptions generally produce 3D magnetic ﬁelds
that can diﬀer signiﬁcantly in the details of individual ﬁeld
lines (e.g., DeRosa et al. 2009), then, diﬀerently from GΦ,
dhΦ/dt can always diﬀerentiate two magnetic ﬁelds. This is
indeed what we see in Figure 4 where the three plots of dhΦ/dt
are easily distinguishable because of the diﬀerent 3D geom-
etry of magnetic ﬁeld lines. Thus, the robustness of dhΦ/dt
against diﬀerent extrapolation models should be understood
in terms of average or global distribution of helicity ﬂux den-
sity over the diﬀerent magnetic ﬂux systems of an AR, and
not in terms of a one-to-one ﬁeld-line and dhΦ/dt correspon-
dence. For AR 11158, this means looking at the AR in terms
of the four ﬂux systems NN-NP, NN-SP, SN-SP, and SN-NP.
While the actual distribution of the magnetic ﬁeld-lines and
dhΦ/dt in these four ﬂux systems vary from one extrapolation
to the other (see Figure 4), the sign and average helicity ﬂux
intensities agree very well, hence the robustness of the calcu-
lations.

local diﬀerences exist

On the other hand,

in the
connectivity-based helicity ﬂux density calculations per-
formed with diﬀerent extrapolations. Such local diﬀerences
can be signiﬁcant and are extremely important for physically
interpretating the local helicity ﬂux, i.e., at the scale of a par-
ticular ﬁeld line. This is illustrated in Figure 7 that shows
dhΦ/dt for ﬁve ﬁeld-lines that have been integrated from the
same photospheric starting footpoints for all three extrapola-
tions of AR 11158. The connectivity and 3D geometry of
these ﬁeld lines strongly diﬀer from one extrapolation to the
other, which results in diﬀerent helicity ﬂux intensities and
signs. For instance, ﬁeld-line 5 links SN to a small-scale pos-
itive magnetic polarity on the north of SN with a strong neg-
ative helicity ﬂux for POT, while it links SN to NP with a
medium negative helicity ﬂux for NLFFF-R, and links SN to
SP with a medium positive helicity ﬂux for NLFFF-O. When
comparing the three extrapolations, the ﬁve ﬁeld-lines dis-
played in Figure 7 are so diﬀerent in geometry and orientation
with respect to each other that the physical interpretation of
their helicity ﬂux density – based on ﬁeld-lines reorientation

in response to the motions of their photospheric footpoints (cf.
Section 5 and Figure 9 of Dalmasse et al. 2014), is entirely ex-
trapolation dependent.

Considering the current limitations of magnetic ﬁeld ex-
trapolations, we conclude that the physical interpretation of
the connectivity-based helicity ﬂux density calculations in ob-
servational analyses will be robust at the scale of the diﬀerent
ﬂux systems forming an AR, but not necessarily at the ex-
tremely local scale of individual magnetic ﬁeld lines for which
interpretation of the signal should be taken with a lot of cau-
tion.

Finally, we recall that the analysis presented in this paper
was conducted using NLFFF extrapolations performed with a
ﬁnite ﬁeld of view. As mentioned Section 4.1, this is a limita-
tion since it disregards the eﬀect of the distant quiet Sun and
surrounding ARs that are outside the ﬁeld of view considered
for the extrapolation. Such eﬀects would need another study
with large-scale magnetic ﬁeld extrapolations, or even with
full-Sun numerical simulations.

7. CONCLUSION
Thanks to the conservation properties of magnetic helic-
ity in the solar atmosphere, studying the photospheric ﬂux
of magnetic helicity appears to be a key element for improv-
ing our understanding of how this fundamental quantity af-
fects the dynamics of solar active regions (ARs). For that pur-
pose, a connectivity-based helicity ﬂux density method, built
upon the work of Pariat et al. (2005), was recently developed
and tested on various analytical case-studies and numerical
magnetohydrodynamics (MHD) simulations (Dalmasse et al.
2014). The ability of this method to correctly capture the lo-
cal transfer of magnetic helicity relies on its exploitation of
the connectivity of magnetic ﬁeld lines, which enables it to
embrace the 3D and global nature of magnetic helicity.
application of
atmosphere,

the
connectivity-based helicity ﬂux density method relies
on approximate 3D solutions obtained from force-free ﬁeld
(FFF) extrapolations of the photospheric magnetic ﬁeld to
derive the connectivity of magnetic ﬁeld lines.
In general,
such FFF models provide reconstructed magnetic ﬁelds
whose 3D distribution strongly depends on the extrapola-

solar

For

the

the

12

Dalmasse et al.

11158 using the vector magnetogram data from SDO/HMI.
Three FFF extrapolations, i.e., a potential ﬁeld, a nonlin-
ear FFF (NLFFF) extrapolation using the magneto-frictional
method of Valori et al. (2010), and a second NLFFF from the
optimization method of Wiegelmann (2004), were performed
to reconstruct the coronal magnetic ﬁeld of AR 11158 and ap-
ply the connectivity-based approach. Our analysis indicates
that the helicity ﬂux density calculations derived from dif-
ferent FFF extrapolations are highly correlated (with Pearson
and Spearman correlation coeﬃcients larger than ≈ 0.72) and
consistent with each other, showing a very good agreement
over identifying the local sign of helicity ﬂux (i.e., for more
than ≈ 85% of the surface where they were compared). We
thus conclude that the connectivity-based helicity ﬂux density
method can be reliably used in observational analyses of ARs.
The results presented in this paper also enable us to propose
a procedure for estimating uncertainties in the connectivity-
based helicity ﬂux density calculations applied to solar obser-
vations, as follows:

1. Perform a Monte Carlo experiment, as described in
Section 3.2 and proposed by Liu & Schuck (2012), by
adding random noise with a Gaussian distribution to the
photospheric vector magnetic ﬁelds used for computa-
tion and propagate it through the chain of helicity ﬂux
density calculations. This allows to estimate uncertain-
ties related with magnetic ﬁeld measurement errors for
the ﬂux transport velocity, Gθ, and dhΦ/dt and GΦ from
the NLFFF method chosen for the analysis.

2. Apply the connectivity-based calculations with the
NLFFF and the potential ﬁeld to derive the standard
error from the comparison of GΦ computed with each
magnetic ﬁeld model. This allows to derive the error
contribution related with the uncertainty in the mag-
netic ﬁeld connectivity due to the choice of magnetic
ﬁeld extrapolation method.

3. Sum the squared errors of GΦ to estimate the overall

uncertainty in helicity ﬂux density calculations.

This procedure, and in particular step 2, is motivated by the
fact that our analysis indicates that comparing the calculations
with the potential ﬁeld and one of the two NLFFF models
gives a standard error that is extremely close to the standard
error obtained from comparing the helicity ﬂux density calcu-
lations from the two NLFFF models. Computing the potential
ﬁeld is relatively inexpensive as compared with computing an
NLFFF model and, in fact, is already part of most NLFFF al-
gorithms (see e.g., review by Wiegelmann & Sakurai 2012)
that use it as an initial state.

The reliability of the connectivity-based helicity ﬂux den-
sity calculations against diﬀerent FFF models oﬀers several
interesting perspectives for analyzing the 2D and 3D transfer
of magnetic helicity in solar ARs. During the early stages of
AR formation, the connectivity-based method provides infor-
mation on the distribution of magnetic helicity in the emerg-
ing magnetic ﬁeld, which is an important constraint for mod-
els of generation and transport of magnetic ﬂux in the solar
convection zone (e.g., Berger & Ruzmaikin 2000; Pariat et al.
2007; Vemareddy & D´emoulin 2017).

On the other hand, the study of the helicity ﬂux distribution
at later stages of ARs evolution allows to track the sites where
magnetic helicity is transferred to the corona, probing in this
way the relationships between magnetic helicity accumulation

Fig. 7.— 3D representation (top view) of the connectivity-based helicity ﬂux
density, as in Figure 4, illustrating local diﬀerences between dhΦ/dt from the
diﬀerent FFF extrapolations. The magnetic ﬁeld lines are labelled accord-
ing to the common photospheric footpoint from which they were integrated
and which is indicated by the yellow disk. The color scale for the vertical
magnetic ﬁeld (gray scale) and its isocontours are the same as in Figure 4.

tion method used (e.g., DeRosa et al. 2009, 2015). As a
consequence, the values of subsequently derived quantities,
such as free magnetic energy and magnetic helicity, exhibit
large variations from one FFF model to another. Since the
magnetic connectivity also depends on the 3D distribution
of the extrapolated magnetic ﬁeld,
the connectivity-based
helicity ﬂux density calculations may be strongly aﬀected by
the choice of FFF reconstruction method. In this paper, we
addressed this concern by applying the connectivity-based
approach to solar observations with diﬀerent magnetic ﬁeld
extrapolation models and implementations.

To assess the reliability and relevance of the connectivity-
based helicity ﬂux density method to solar observations, we
considered the internally complex (several bipoles) and ex-
ternally simple (i.e., no neighboring large-ﬂux system) AR

Studying the transfer of magnetic helicity in solar active regions

13

and the energetics of solar ﬂares and coronal mass ejections
(CMEs). The connectivity-based approach may further be
used to test the very high-energy ﬂare model of Kusano et al.
(2004) based on magnetic helicity annihilation. Such a ﬂare
model requires the prior transfer and accumulation of mag-
netic helicity of opposite signs in diﬀerent magnetic ﬂux sys-
tems of an AR that would later reconnect together. Identifying
AR candidates for hosting such a ﬂare model requires reliable
maps that are not polluted by false helicity ﬂux signals of op-
posite signs. The present study shows that the connectivity-
based helicity ﬂux density method is very well suited for that
purpose.

In summary, the connectivity-based helicity ﬂux density
method is a very promising tool for helping us unveil the role
of magnetic helicity in the dynamics of the solar corona.

We thank the anonymous referee for helpful comments that
improved the paper. K.D. thanks D. Nychka for his help on
the Monte Carlo experiment, and R. Centeno Elliott and A.
Gri˜n´on Mar´ın for their insights on HMI noise characteriza-

tion. K.D. acknowledges funding from the Advanced Study
Program, the High Altitude Observatory, and the Computa-
tional and Information Systems Laboratory. E.P. acknowl-
edges the support of the French Agence Nationale pour la
Recherche through the HELISOL project, contract n◦ ANR-
15-CE31-0001. G.V. acknowledges the support of the Lev-
erhulme Trust Research Project Grant 2014-051. J.J. is sup-
ported by NASA grant NNX16AF72G and 80NSSC17K0016.
The data used here are courtesy of the NASA/SDO and the
HMI science team. This work used the DAVE4VM code
written and developed by P. Schuck at the Naval Research
Laboratory. The helicity ﬂux calculations were performed
partly on the high-performance computing system Yellow-
stone (ark:/85065/d7wd3xhc) provided by NCAR’s Compu-
tational and Information Systems Laboratory, sponsored by
the National Science Foundation, and partly on the multi-
processors TRU64 computer of the LESIA. The National
Center for Atmospheric Research is sponsored by the Na-
tional Science Foundation.

REFERENCES

Aly, J.-J. 2014, in Journal of Physics Conference Series, Vol. 544, Journal of

Inoue, S., Hayashi, K., Shiota, D., Magara, T., & Choe, G. S. 2013, ApJ,

Physics Conference Series, 012003

Amari, T., Boulmezaoud, T. Z., & Aly, J. J. 2006, A&A, 446, 691
Antiochos, S. K. 2013, ApJ, 772, 72
Aulanier, G., Pariat, E., D´emoulin, P., & DeVore, C. R. 2006, Sol. Phys.,

238, 347

Berger, M. A. 1984, Geophysical and Astrophysical Fluid Dynamics, 30, 79
Berger, M. A. 1988, A&A, 201, 355
Berger, M. A. & Field, G. B. 1984, Journal of Fluid Mechanics, 147, 133
Berger, M. A. & Ruzmaikin, A. 2000, J. Geophys. Res., 105, 10481
Bobra, M. G., Sun, X., Hoeksema, J. T., et al. 2014, Sol. Phys., 289, 3549
Chae, J. 2001, ApJ, 560, L95
Chae, J., Moon, Y.-J., & Park, Y.-D. 2004, Sol. Phys., 223, 39
Chae, J., Wang, H., Qiu, J., et al. 2001, ApJ, 560, 476
Chandra, R., Pariat, E., Schmieder, B., Mandrini, C. H., & Uddin, W. 2010,

Sol. Phys., 261, 127

Cox, D. R. 2006, Principles of Statistical Inference (Cambridge University

Press), iSBN 9780521685672

770, 79

Inoue, S., Magara, T., Watari, S., & Choe, G. S. 2012, ApJ, 747, 65
Inoue, S. & Morikawa, Y. 2011, Plasma and Fusion Research, 6, 2401067
Janvier, M., Aulanier, G., Pariat, E., & D´emoulin, P. 2013, A&A, 555, A77
Jeong, H. & Chae, J. 2007, ApJ, 671, 1022
Jiang, C. & Feng, X. 2012, ApJ, 749, 135
Jiang, Y., Zheng, R., Yang, J., et al. 2012, ApJ, 744, 50
Jing, J., Park, S.-H., Liu, C., et al. 2012, ApJ, 752, L9
Kazachenko, M. D., Canﬁeld, R. C., Longcope, D. W., & Qiu, J. 2012,

Sol. Phys., 277, 165

Klimchuk, J. A. & Sturrock, P. A. 1992, ApJ, 385, 344
Knizhnik, K. J., Antiochos, S. K., & DeVore, C. R. 2015, ApJ, 809, 137
Kramar, M., Airapetian, V., Miki´c, Z., & Davila, J. 2014, Sol. Phys., 289,

2927

Kusano, K., Maeshiro, T., Yokoyama, T., & Sakurai, T. 2002, ApJ, 577, 501
Kusano, K., Maeshiro, T., Yokoyama, T., & Sakurai, T. 2004, ApJ, 610, 537
Kusano, K., Yokoyama, T., Maeshiro, T., & Sakurai, T. 2003, Advances in

Dalmasse, K., Nychka, D., Gibson, S., Flyer, N., & Fan, Y. 2016, Frontiers

Space Research, 32, 1931

in Astronomy and Space Sciences, 3, 24

Dalmasse, K., Pariat, E., D´emoulin, P., & Aulanier, G. 2014, Sol. Phys., 289,

LaBonte, B. J., Georgoulis, M. K., & Rust, D. M. 2007, ApJ, 671, 955
Leka, K. D., Canﬁeld, R. C., McClymont, A. N., & van Driel-Gesztelyi, L.

107

Dalmasse, K., Pariat, E., Valori, G., D´emoulin, P., & Green, L. M. 2013,

A&A, 555, L6

D´emoulin, P. & Berger, M. A. 2003, Sol. Phys., 215, 203
D´emoulin, P., Mandrini, C. H., Van Driel-Gesztelyi, L., Lopez Fuentes,

M. C., & Aulanier, G. 2002a, Sol. Phys., 207, 87

D´emoulin, P., Mandrini, C. H., van Driel-Gesztelyi, L., et al. 2002b, A&A,

382, 650

D´emoulin, P. & Pariat, E. 2009, Advances in Space Research, 43, 1013
D´emoulin, P., Priest, E. R., & Lonie, D. P. 1996, J. Geophys. Res., 101, 7631
DeRosa, M. L., Schrijver, C. J., Barnes, G., et al. 2009, ApJ, 696, 1780
DeRosa, M. L., Wheatland, M. S., Leka, K. D., et al. 2015, ApJ, 811, 107
Finn, J. M. & Antonsen, T. M., J. 1985, Comments Plasma Phys. Controlled

Fusion, 9, 111

Fuhrmann, M., Seehafer, N., & Valori, G. 2007, A&A, 476, 349
Fuhrmann, M., Seehafer, N., Valori, G., & Wiegelmann, T. 2011, A&A, 526,

A70

Georgoulis, M. K., Rust, D. M., Pevtsov, A. A., Bernasconi, P. N., &

Kuzanyan, K. M. 2009, ApJ, 705, L48

Gibson, S., Kucera, T., White, S., et al. 2016, Frontiers in Astronomy and

Space Sciences, 3, 8

Grad, H. & Rubin, H. 1958, in Proc. of the Second UN International Atomic

Energy Conf. 31, Peaceful Uses of Atomic Energy

Green, L. M., L´opez fuentes, M. C., Mandrini, C. H., et al. 2002, Sol. Phys.,

208, 43

Guo, Y., Ding, M. D., Cheng, X., Zhao, J., & Pariat, E. 2013, ApJ, 779, 157
Heyvaerts, J. & Priest, E. R. 1984, A&A, 137, 63
Hoeksema, J. T., Liu, Y., Hayashi, K., et al. 2014, Sol. Phys., 289, 3483

1996, ApJ, 462, 547

Linton, M. G., Dahlburg, R. B., & Antiochos, S. K. 2001, ApJ, 553, 905
Liu, Y. & Schuck, P. W. 2012, ApJ, 761, 105
Liu, Y., Zhao, J., & Schuck, P. W. 2013, Sol. Phys., 287, 279
Longcope, D. W. & Welsch, B. T. 2000, ApJ, 545, 1089
Low, B. C. 1996, Sol. Phys., 167, 217
Malanushenko, A., Schrijver, C. J., DeRosa, M. L., Wheatland, M. S., &

Gilchrist, S. A. 2012, ApJ, 756, 153

Mandrini, C. H., D´emoulin, P., van Driel-Gesztelyi, L., et al. 2004, Ap&SS,

290, 319

Metcalf, T. R., De Rosa, M. L., Schrijver, C. J., et al. 2008, Sol. Phys., 247,

269

Moﬀatt, H. K. 1969, Journal of Fluid Mechanics, 35, 117
Moon, Y.-J., Chae, J., Choe, G. S., et al. 2002, ApJ, 574, 1066
Moore, D. S. & McCabe, G. P. 2003, Introduction to the Practice of

Statistics (Freeman, W. H.), iSBN 9780716796572

Moreno-Insertis, F. 1997, Mem. Soc. Astron. Italiana, 68, 429
Neyman, J. & Pearson, E. S. 1933, Philosophical Transactions of the Royal
Society of London A: Mathematical, Physical and Engineering Sciences,
231, 289

Pariat, E., D´emoulin, P., & Berger, M. A. 2005, A&A, 439, 1191
Pariat, E., D´emoulin, P., & Nindos, A. 2007, Advances in Space Research,

39, 1706

Pariat, E., Leake, J. E., Valori, G., et al. 2017, A&A, 601, A125
Pariat, E., Nindos, A., D´emoulin, P., & Berger, M. A. 2006, A&A, 452, 623
Pariat, E., Valori, G., D´emoulin, P., & Dalmasse, K. 2015, A&A, 580, A128
Park, S.-H., Kusano, K., Cho, K.-S., et al. 2013, ApJ, 778, 13

14

Dalmasse et al.

Pesnell, W. D., Thompson, B. J., & Chamberlin, P. C. 2012, Sol. Phys., 275,

3

Pevtsov, A. A. 2012, Astrophysics and Space Science Proceedings, 30, 83
Plowman, J. 2014, ApJ, 792, 23
Poisson, M., Mandrini, C. H., D´emoulin, P., & L´opez Fuentes, M. 2015,

Sol. Phys., 290, 727

Rachmeler, L. A., Casini, R., & Gibson, S. E. 2012, in Astronomical Society
of the Paciﬁc Conference Series, Vol. 463, Second ATST-EAST Meeting:
Magnetic Fields from the Photosphere to the Corona., ed. T. R. Rimmele,
A. Tritschler, F. W¨oger, M. Collados Vera, H. Socas-Navarro,
R. Schlichenmaier, M. Carlsson, T. Berger, A. Cadavid, P. R. Gilbert,
P. R. Goode, & M. Kn¨olker, 227

Romano, P., Zuccarello, F. P., Guglielmino, S. L., & Zuccarello, F. 2014,

ApJ, 794, 118

Russell, A. J. B., Yeates, A. R., Hornig, G., & Wilmot-Smith, A. L. 2015,

Physics of Plasmas, 22, 032106

Rust, D. M. 1994, Geophys. Res. Lett., 21, 241
Schmidt, H. U. 1964, NASA Special Publication, 50, 107
Schou, J., Borrero, J. M., Norton, A. A., et al. 2012, Sol. Phys., 275, 327
Schrijver, C. J., Aulanier, G., Title, A. M., Pariat, E., & Delann´ee, C. 2011,

ApJ, 738, 167

Schrijver, C. J., De Rosa, M. L., Metcalf, T. R., et al. 2006, Sol. Phys., 235,

161

Schrijver, C. J., Title, A. M., Yeates, A. R., & DeRosa, M. L. 2013, ApJ,

773, 93

Schuck, P. W. 2008, ApJ, 683, 1134
Sun, X., Hoeksema, J. T., Liu, Y., et al. 2012, ApJ, 748, 77
Taylor, J. B. 1974, Physical Review Letters, 33, 1139
Taylor, J. B. 1986, Reviews of Modern Physics, 58, 741
Titov, V. S., Hornig, G., & D´emoulin, P. 2002, J. Geophys. Res., 107, 1164
Toriumi, S., Iida, Y., Kusano, K., Bamba, Y., & Imada, S. 2014, Sol. Phys.,

289, 3351

Tziotziou, K., Georgoulis, M. K., & Raouaﬁ, N.-E. 2012, ApJ, 759, L4
Valori, G., D´emoulin, P., Pariat, E., & Masson, S. 2013, A&A, 553, A38

Valori, G., Green, L. M., D´emoulin, P., et al. 2012, Sol. Phys., 278, 73
Valori, G., Kliem, B., & Fuhrmann, M. 2007, Sol. Phys., 245, 263
Valori, G., Kliem, B., T¨or¨ok, T., & Titov, V. S. 2010, A&A, 519, A44
Valori, G., Pariat, E., Anﬁnogentov, S., et al. 2016, Space Sci. Rev., 201, 147
van Ballegooijen, A. A. & Martens, P. C. H. 1989, ApJ, 343, 971
Vemareddy, P. 2015, ApJ, 806, 245
Vemareddy, P., Ambastha, A., & Maurya, R. A. 2012a, ApJ, 761, 60
Vemareddy, P., Ambastha, A., Maurya, R. A., & Chae, J. 2012b, ApJ, 761,

86

Vemareddy, P. & D´emoulin, P. 2017, A&A, 597, A104
Wheatland, M. S. 2007, Sol. Phys., 245, 251
Wheatland, M. S., Sturrock, P. A., & Roumeliotis, G. 2000, ApJ, 540, 1150
Wiegelmann, T. 2004, Sol. Phys., 219, 87
Wiegelmann, T. & Inhester, B. 2010, A&A, 516, A107
Wiegelmann, T., Inhester, B., & Sakurai, T. 2006, Sol. Phys., 233, 215
Wiegelmann, T. & Sakurai, T. 2012, Living Reviews in Solar Physics, 9, 5
Wiegelmann, T., Thalmann, J. K., Inhester, B., et al. 2012, Sol. Phys., 281,

37

Woltjer, L. 1958, Proceedings of the National Academy of Science, 44, 489
Yamamoto, T. T., Kusano, K., Maeshiro, T., Yokoyama, T., & Sakurai, T.

2005, ApJ, 624, 1072

Yang, S., Zhang, H., & B¨uchner, J. 2009, A&A, 502, 333
Yeates, A. R. & Hornig, G. 2011, Physics of Plasmas, 18, 102118
Yeates, A. R. & Hornig, G. 2013, Physics of Plasmas, 20, 012102
Yeates, A. R. & Hornig, G. 2014, in Journal of Physics Conference Series,

Vol. 544, Journal of Physics Conference Series, 012002

Yeates, A. R., Russell, A. J. B., & Hornig, G. 2015, Proceedings of the

Royal Society of London Series A, 471

Zhang, M., Flyer, N., & Low, B. C. 2006, ApJ, 644, 575
Zhang, Y., Kitai, R., & Takizawa, K. 2012, ApJ, 751, 85
Zhang, Y., Tan, B., & Yan, Y. 2008, ApJ, 682, L133
Zhu, X. S., Wang, H. N., Du, Z. L., & Fan, Y. L. 2013, ApJ, 768, 119

APPENDIX

NULL HYPOTHESIS TESTING
To determine whether the values of correlation coeﬃcients reported in Section 5.2 are statistically signiﬁcant, we perform a null
hypothesis test (e.g., Neyman & Pearson 1933; Moore & McCabe 2003; Cox 2006). The null hypothesis states that an observed
result, or relationship between two variables, is due to random processes alone. The null hypothesis test is an argumentum ad
absurdum approach. The goal is to show that an observed relationship or result is very unlikely to occur under the null hypothesis,
in which case the null hypothesis can be rejected and the alternative accepted. In the context of this paper, they can be formulated
as follows

- Null hypothesis: the values of GΦ computed from diﬀerent FFF models are not correlated.

- Alternative hypothesis: the values of GΦ computed from diﬀerent FFF models are correlated.

To test this null hypothesis, we perform a permutation test. Let X = {x1, x2, ..., xn} and Y = {y1, y2, ..., yn} be two datasets.
= cS (X, Y) is the Spearman correlation coeﬃcient of the two original datasets X and Y, and for which we want to determine

c(0)
S
the statistical signiﬁcance. The permutation test consists in the following steps

1. Create a new dataset Y (k) by randomly permuting the elements of Y; for instance, Y (k) = {y4, yn−10, ..., y2}.

2. Compute the Spearman correlation coeﬃcient, c(k)
S

= cS (X, Y (k)).

3. Repeat steps (1) and (2) N times, where N is large (typically larger than 1000). This leads to N sets of random permutations

of Y, and hence, N + 1 Spearman correlation coeﬃcients, {c(0)

S , c(2)
S , i.e., the probability of obtaining the Spearman correlation coeﬃcient, c(0)

S , ..., c(N)
S }.

S , c(3)

S , c(1)

We then determine the p-value of c(0)
original datasets, X and Y, if the null hypothesis were true. The p-value associated with c(0)
test is the fraction of c(k={0,1,...,n})

that are larger than the Spearman correlation coeﬃcient from the two original datasets, c(0)

S , between the two
S and estimated from the permutation
S , i.e.,

S

where m is the number of c(k={0,1,...,n})
S . The same method is applied with the Pearson correlation coeﬃcient.
We reject the null hypothesis and accept the alternative if the estimated p-value for both the Pearson and Spearman correlation
coeﬃcients is strictly smaller than 0.001, i.e., the level below which we consider the correlation coeﬃcients from the two original
dataset to be statistically signiﬁcant.

that are ≥ c(0)

S

p = m
N + 1

,

(A1)

Studying the transfer of magnetic helicity in solar active regions

15

TABLE 4
Permutation tests for the Spearman correlation coefficient of GΦ(POT) vs. GΦ(NLFFF-R)

N

104
105
106

µS

8.8 × 10−5
−6.3 × 10−6
−5.4 × 10−6

σS

1.0 × 10−2
7.4 × 10−3
7.1 × 10−3

c(0)
S

0.72
0.72
0.72

(cid:17)

p

(cid:16)
c(0)
S
1.0 × 10−4
1.0 × 10−5
1.0 × 10−6

Note. — µS and σS are the mean and standard deviation of c(k={0,1,...,n})
correlation coeﬃcient computed from the original pair of datasets and p
value given the null hypothesis.

S

. c(0)
S
(cid:17)
(cid:16)
c(0)
S

is the Spearman
its estimated p-

S

The results from the permutation tests are summarized in Table 4 for the Spearman correlation coeﬃcient of GΦ(POT) vs.
GΦ(NLFFF-R) only, because we obtained very similar results for both the Pearson and Spearman correlation coeﬃcients of
all three scatter plots from Figure 6. For all permutation tests reported in Table 4, the distribution of Spearman correlation
coeﬃcients (not shown here), c(k={0,1,...,n})
, exhibits a Gaussian-like proﬁle with a mean, µ ≈ 0 (|µ| < 10−4), and a very small
standard deviation, σ ≤ 10−2. We varied the number of random permutations and veriﬁed that the mean and standard deviation
of the resulting distributions are not strongly dependent on the number of permutations as long as this number is large enough
(typically N ≥ 104). Table 4 shows that the p-value of c(0)
is at most 10−6 (as taken from the test with N = 106) for all permutation
S
tests. This is only an upper bound for the p-value as suggested by their N−1 dependency visible in Table 4 and the comparison
between c(0)
S at an ≈ 100σ distance from the mean in the tail of the distribution of
c(k={0,1,...,n})
for all k > 0 for all permutation tests, leading to
S
m = 1 in Equation (A1). The correlation coeﬃcients reported in Figure 6 are thus statistically signiﬁcant. We thus reject the null
hypothesis and accept the alternative hypothesis. We therefore conclude that the calculations of the connectivity-based helicity
ﬂux density derived from diﬀerent FFF extrapolations are highly correlated and consistent with each other.

S and the standard deviation which places c(0)
. Note that the N−1 dependency occurs because we obtain c(k)

S < c(0)

S

