Draft version January 11, 2022
Typeset using LATEX preprint style in AASTeX631

Quantitative Characterization of Magnetic Flux Rope Properties for Two Solar
Eruption Events

Wen He ,1 Qiang Hu ,2 Chaowei Jiang ,3 Jiong Qiu,4 and Avijeet Prasad 5, 6

2
2
0
2

n
a
J

0
1

]

R
S
.
h
p
-
o
r
t
s
a
[

1
v
9
4
1
3
0
.
1
0
2
2
:
v
i
X
r
a

1Department of Space Science,
The University of Alabama in Huntsville,
Huntsville, AL 35805, USA
2Department of Space Science,
and Center for Space Plasma and Aeronomic Research (CSPAR),
The University of Alabama in Huntsville,
Huntsville, AL 35805, USA
3Institute of Space Science and Applied Technology,
Harbin Institute of Technology,
Shenzhen, China
4Physics Department, Montana State University, Bozeman, MT 59717, USA
5Institute of Theoretical Astrophysics,
University of Oslo, Postboks 1029 Blindern, 0315 Oslo, Norway
6Rosseland Centre for Solar Physics,
University of Oslo, Postboks 1029 Blindern, 0315 Oslo, Norway

Submitted to ApJ

ABSTRACT
In order to bridge the gap between heliospheric and solar observations of coronal
mass ejections (CMEs), one of the key steps is to improve the understanding of their
corresponding magnetic structures like the magnetic ﬂux ropes (MFRs). But it remains
a challenge to conﬁrm the existence of a coherent MFR before or upon the CME eruption
on the Sun and to quantitatively characterize the CME-MFR due to the lack of direct
magnetic ﬁeld measurement in the corona.
In this study, we investigate the MFR
structures, originating from two active regions (ARs), AR 11719 and AR 12158, and
estimate their magnetic properties quantitatively. We perform the nonlinear force-free
ﬁeld extrapolations with preprocessed photospheric vector magnetograms. In addition,
remote-sensing observations are employed to ﬁnd indirect evidence of MFRs on the Sun
and to analyze the time evolution of magnetic reconnection ﬂux associated with the
ﬂare ribbons during the eruption. A coherent “pre-existing” MFR structure prior to
the ﬂare eruption is identiﬁed quantitatively for one event from the combined analysis
of the extrapolation and observation. Then the characteristics of MFRs for two events
on the Sun before and during the eruption, forming the CME-MFR, including the axial

Corresponding author: Qiang Hu
qh0001@uah.edu

 
 
 
 
 
 
2

He et al.

magnetic ﬂux, ﬁeld-line twist, and reconnection ﬂux, are estimated and compared with
the corresponding in situ modeling results. We ﬁnd that the magnetic reconnection
associated with the accompanying ﬂares for both events injects signiﬁcant amount of
ﬂux into the erupted CME-MFRs.

Keywords: Solar coronal mass ejections (310); Solar ﬂares (1496); Solar active region

magnetic ﬁelds (1975); Solar magnetic ﬁelds (1503)

1. INTRODUCTION

Coronal mass ejections (CMEs) are spectacular eruptions of plasma often accompanied with rapid
release of magnetic energy from solar atmosphere. When CMEs propagate away from the Sun to the
interplanetary space, they are often called interplanetary CMEs (ICMEs) which exhibit a distinct set
of observational signatures from in situ measurements. They are recognized as drivers of major space
weather events which could severely impact human activities in modern society. Erupted ﬂares have a
close relationship with CMEs and strong ﬂares are often observed along with CMEs (Chen 2011). In
the past few decades, a lot of eﬀorts have been made on the development of the ﬂare-CME model in
order to explain the underlying physical mechanism(s). Among them, the standard two-dimensional
(2D) ﬂare and CME model, so-called CSHKP model (developed by Carmichael 1964; Sturrock 1966;
Hirayama 1974; Kopp & Pneuman 1976), has successfully explained the morphological evolution of
eruptive two-ribbon ﬂares. One of the essential components in the model is a CME magnetic ﬂux rope
(MFR). Upon its ejection, ﬁeld lines below the erupting rope reconnect and form an arcade of ﬂare
loops observed in the X-ray and extreme ultraviolet (EUV) wavelengths, and two ribbons observed
in optical and ultraviolet (UV) wavelengths demarcating the feet of the arcade. In the 2D model, the
same amount of magnetic ﬂux encompassed by the ﬂare loops is also turned into the poloidal ﬂux
of the erupting MFR, and this amount of ﬂux can be measured from ﬂare ribbons sweeping through
photospheric magnetic ﬁeld (Forbes & Priest 1984; Qiu et al. 2004, 2007). Since MFRs are generally
believed to be the core magnetic structure of CMEs and ICMEs (e.g., Gibson et al. 2006; Hu et al.
2014; Gopalswamy et al. 2017, 2018; Liu 2020), studies of MFR properties related to their formation
and evolution remain an important topic to be explored. We note that hereafter we use “MFR” for
a more generic reference to a magnetic ﬂux rope at diﬀerent stages of evolution, and “CME-MFR”
for the speciﬁc reference of a magnetic ﬂux rope at the ﬁnal stage of a CME eruption (i.e., when the
MFR has well formed after the ﬂare reconnection).

Nowadays, the study of evolution and propagation of CMEs/ICMEs between Sun and Earth is
greatly advanced with the help of multiple measurements from multi-spacecraft missions. The large-
scale magnetic clouds (MCs) in ICMEs which are commonly detected in situ provide direct evidence
for the existence of erupted CME-MFRs that come from the Sun (Burlaga 1992; Qiu et al. 2007;
In addition, there are also remote-sensing observations available throughout the
Hu et al. 2014).
interplanetary space. For example, the twin spacecraft, Solar TErrestrial RElations Observatory
(STEREO, Kaiser et al. 2008), can trace CMEs from the high corona to the inner heliosphere via
coronagraphic observations. The STEREO mission provides two more viewpoints towards the Sun, in
addition to the viewpoint from Earth provided by the Solar and Heliospheric Observatory (SOHO),
in the past decades. There are also various signatures for MFRs on the Sun from remote-sensing
observations, including ﬁlaments, coronal cavities, sigmoids, and hot channels (Cheng et al. 2017).

Quantitative Study of CME Magnetic Flux Rope Topology

3

These solar phenomena can be uniﬁed into one framework as distinct manifestations of MFRs (Liu
2020). Most of the latest recognized observational features are attributed to the observations from the
Solar Dynamics Observatory (SDO, Pesnell et al. 2012). Recent development of large ground-based
solar telescopes also becomes an indispensable way to reveal the ﬁne-scale structures and dynamics
of MFR formation in the low corona (e.g., Wang et al. 2015).

Compared to various studies based on in situ measurements of MFR structures after the eruption,
the origination of CME-MFRs before and during eruptions still remains elusive due to the complex
environment in the solar source region and limited observations. At the present time, there are certain
hypotheses on the formation process of MFRs. Some studies indicate that MFRs could exist prior
to the eruption. For example, both Fan (2001) and Magara (2004) reported magnetohydrodynamic
(MHD) simulation results that a twisted MFR initially formed below the photosphere can partially
emerge into the low corona by magnetic buoyancy. While some studies suggest that the presence
of pre-eruptive MFRs is not necessary and MFRs could be built up in the corona via magnetic
reconnection processes associated with ﬂares (Amari et al. 2003; Moore et al. 2001; Antiochos et al.
1999; Jiang et al. 2021a,b). To understand the physical processes more precisely for the ﬂare-CME
events, extensions of the standard 2D ﬂare model have been proposed to account for much broader
ranges of quantitative measurements with three-dimensional (3D) features intrinsic to realistic solar
eruptions (Longcope et al. 2007; Aulanier et al. 2012; Priest & Longcope 2017; Aulanier & Dud´ık
2019). For example, quasi-3D models have been developed with a non-vanishing magnetic ﬁeld
component along the axis of the MFR and to illustrate a scenario that sequential reconnection along
magnetic polarity inversion line (PIL) forms the MFR in the ﬁrst place (van Ballegooijen & Martens
1989; Longcope et al. 2007; Schmieder et al. 2015). This scenario has been widely applied to infer and
interpret the magnetic reconnection properties based on the observed ﬂare ribbon morphology (Qiu
et al. 2002, 2004, 2010; Hu et al. 2014; Kazachenko et al. 2017; Zhu et al. 2020). From such analyses,
Qiu et al. (2004) illustrated that there is a temporal correlation between the magnetic reconnection
rate and the acceleration of the CME (considered as the eruptive MFR) in the low corona. Such
a correlation has been further established by Zhu et al. (2020) based on a statistical study of ∼
60 events. In addition, Qiu et al. (2007) and Hu et al. (2014) showed the correlation between the
magnetic reconnection ﬂux and the ﬂux contents of the corresponding ICME/MC ﬂux ropes based on
modeling results employing in situ spacecraft measurements. These results support the hypothesis,
especially concerning CME-MFRs, that the CME-MFR can be formed by magnetic reconnection
during the corresponding ﬂare process. And recent simulation results also indicate clearly that the
reconnection ﬂux contributes to the axial (toroidal) ﬂux of the CME-MFR in the early stage (Jiang
et al. 2021a; Inoue et al. 2018).

For the quantitative MFR identiﬁcation in the solar source region, numerical models can be applied
to ﬁnd MFRs in addition to observations. For the topological analysis of a solar MFR, the 3D mag-
netic ﬁeld conﬁguration is commonly obtained through coronal magnetic ﬁeld extrapolation based on
photospheric magnetograms. A number of high resolution extrapolation results employing diﬀerent
numerical schemes has been compared to observations to study the properties of MFRs in the mag-
netically dominant environment on the Sun (Schrijver et al. 2008; Thalmann et al. 2008; Wheatland
& R´egnier 2009; De Rosa et al. 2009; Wiegelmann et al. 2012; Sun et al. 2012; Jiang et al. 2014; Guo
et al. 2016). Among many extrapolation studies, the force-free approximation is commonly adopted
for the case of low plasma β (the ratio between the plasma pressure and magnetic pressure) over

4

He et al.

certain heights in the solar atmosphere above the photosphere (Gary 2001). Under this assumption,
the non-magnetic forces including the inertial force can be ignored for a static and time stationary
equilibrium. Therefore, the Lorentz force should be self-balanced, and it should satisfy the equation,
J × B = 0, which means that the electric current density J is parallel to the magnetic ﬁeld B, with
J = αB (α is the so-called force-free parameter). The simplest case is the potential ﬁeld when α ≡ 0.
If α is not zero, there are two situations depending on whether α is constant or varying in space.
One is the linear force-free ﬁeld (LFFF) for α ≡ const and the other is the nonlinear force-free ﬁeld
(NLFFF). Since our interest lies in the magnetic structure in the ARs on a local scale with high
spatial resolution, the most common and practical way to reconstruct the coronal magnetic ﬁeld is
the NLFFF extrapolation method.

There are a variety of numerical methods proposed to reconstruct the NLFFF for an AR from
boundary conditions and sometimes pseudo-initial conditions,
including the upward integration,
Grad-Rubin iteration, MHD relaxation, optimization approach, and so on (see a review by Wiegel-
mann & Sakurai 2021). The computation speed and accuracy of diﬀerent numerical methods can
vary signiﬁcantly given the diﬀerences in algorithms and their speciﬁc realizations in many aspects.
We apply a kind of MHD-relaxation method with a conservation-element/solution-element (CESE)
solver (Jiang et al. 2011). The so-called CESE-MHD-NLFFF code (Jiang & Feng 2013) has been
tested by diﬀerent benchmark cases (Low & Lou 1990; van Ballegooijen & Mackay 2007; Metcalf
et al. 2008). And it has also been widely applied to the extrapolation of realistic solar magnetic ﬁeld
data (Jiang & Feng 2013; Jiang et al. 2014; Duan et al. 2017, 2019).

The understanding towards the formation and evolution process of the CME-MFRs will ultimately
help us make a deﬁnitive and physical connection between the origin of solar MFRs (including the
MFR before and after the eruption) and their interplanetary counterparts. Such a connection can be
pursued through a quantitative study of MFR’s physical characteristics (e.g., magnetic ﬂux, ﬁeld-line
twist, and electric current). Speciﬁcally, one critical step is the detailed analysis of available solar
observations in order to determine whether an MFR exists or how one can form prior to and during
the eruption. Characterization of MFR properties not only plays a major role in understanding the
physical mechanisms underlying solar eruption and the subsequent evolution, but also contributes to
the improvement of the forecast ability in space weather.

In this paper, we carry out the coronal magnetic ﬁeld extrapolation based on the method developed
by Jiang & Feng (2013) for two events to obtain 3D magnetic ﬁeld topology of the AR prior to
eruption. In addition to the magnetic ﬁeld extrapolation, we estimate the possible locations of the
MFR’s footpoints prior to eruption and measure a number of magnetic ﬁeld parameters (including
the magnetic reconnection ﬂux derived from ﬂare ribbons) in the corresponding AR during the
eruption process from diﬀerent observations. Then the results from extrapolation and observation
are combined to identify whether there is a coherent pre-existing MFR before the eruption and to
interpret how such a structure may evolve during and following the corresponding ﬂare and CME
eruption process. The magnetic properties of the CME-MFR will be further analyzed and compared
with the in situ ICME/MC modeling results which are obtained separately.

This article is organized as follows. The two selected events and extrapolation method are intro-
duced in Section 2. Then we describe the identiﬁcation methods and analyze results associated with
the MFRs on the Sun in Section 3. The magnetic properties of MFRs are estimated quantitatively

Quantitative Study of CME Magnetic Flux Rope Topology

5

and presented in Section 4 based on results from both the solar source region and in situ modeling.
The conclusion is given in Section 5.

2. EVENTS SELECTION AND EXTRAPOLATION METHOD

2.1. Events Overview

For the purpose of performing a quantitative study of the CME-MFR, we search for appropriate
event candidates from a list of reconstructed MFRs based on photospheric magnetograms before the
eruption by Duan et al. (2019). They extrapolated the 3D magnetic ﬁeld in the active regions for 45
major ﬂare eruption events employing the NLFFF extrapolation code by Jiang & Feng (2013). With
a set of criteria similar to those by Jing et al. (2018), all major ﬂares that are above GOES-class M5
and occurred within 45◦ of the solar disk center from 2011 January to 2017 December are selected.
Moreover, we also examine the associations between ﬂare and CME, and between CME and ICME to
ensure that there exists a well-established one-to-one connection among a ﬂare, an associated CME
and an ICME based on the work by Zhu et al. (2020). Two events are selected for this study as
shown in Table 1. Both ARs related to the two events located near the disk center. The CMEs
associated with the corresponding ﬂares in these two events have been both observed by SOHO and
STEREO spacecraft close to the peak times of the corresponding ﬂares (Vemareddy & Zhang 2014;
Cheng et al. 2015; Cheng & Ding 2016; Joshi et al. 2017). And the associated ICME/MC events
were also observed by the WIND and ACE spacecraft at 1 au, which have been reported by Hu et al.
(2021a) and Kilpua et al. (2021), respectively.

In event 1, an M6.5 ﬂare was produced at ∼ 6:55 UT on 2013 April 11 (N07E13). Then a halo
CME appeared in the ﬁeld of view of SOHO/LASCO after 07:24 UT, and the same CME was also
observed simultaneously by both STEREO A and B spacecraft after ∼ 07:39 UT. The corresponding
ICME/MC passing Earth was detected about three days later (Hu et al. 2021a). Similar examination
is conducted for the second event, which started with an X1.6 ﬂare peaking at ∼ 17:45 UT on 2014
September 10. There was also a halo CME following the ﬂare based on the observations from
SOHO/LASCO and the coronagraph of STEREO B (data from STEREO A was unavailable during
event 2). After two days, the WIND spacecraft encountered the subsequent ICME/MC structure at
Earth (Kilpua et al. 2021). Therefore, the connections of CME-MFRs from the Sun to Earth are well
established for these two events. We will mainly present the quantitative study of the CME-MFR
before the eruption hereafter.

2.2. CESE-NLFFF-MHD Extrapolation Method

The CESE-MHD-NLFFF code solves the MHD momentum equation and the magnetic induction
equation iteratively until a stationary magnetic ﬁeld solution is reached, similar to a magnetofrictional
approach. As a special case of the MHD relaxation method, the magnetofrictional method includes an
artiﬁcial dissipative term D(v) to balance the momentum equation with ﬂow velocity v. Speciﬁcally,
in the CESE-MHD-NLFFF code, D(v) is written in a frictional form νρv (see below, and Jiang &
Feng 2012) along with some modiﬁcations in order to utilize the existing CESE-MHD solver. The
modiﬁed momentum equation and the induction equation are written as (Jiang & Feng 2012, 2013),

∂(ρv)
∂t

= (∇ × B) × B − νρv, ρ = |B|2 + ρ0.

∂B
∂t

= ∇ × (v × B) − v∇ · B + ∇(µ∇ · B).

(1)

(2)

6

He et al.

Here the (pseudo) mass density ρ also contains the constant µ0 for simplicity and is assumed to be
largely proportional to |B|2 in order to roughly equalize the speed of the evolution of the entire ﬁeld
with nearly uniform Alfv´en speed (vA = |B|
ρ ≈ const). To enhance the ability of handling noisy data
√
in realistic solar magnetograms, a small value ρ0 is added, e.g., ρ0 = 0.1 (in the same unit as |B|2), to
the original pseudo density ρ. Two extra terms are added to control the divergence of the magnetic
ﬁeld in the induction equation. More details can be found in Jiang & Feng (2012, 2013).

2.3. Data Preprocessing and Grid Initialization

Passing across the inhomogeneous plasma environment, the plasma β could vary from β > 1 in the
photosphere to β (cid:28) 1 in the low and middle corona, and to β > 1 again in the upper corona (Gary
1989, 2001). So the force-free condition may not be always satisﬁed especially at the photosphere
(Metcalf et al. 1995). One way to get a more consistent boundary condition for NLFFF extrapolation
is to modify the raw photospheric magnetogram to mimic a force-free chromospheric magnetogram,
by the so called preprocessing, which was ﬁrst proposed by Wiegelmann et al. (2006). We use the
preprocessing code developed by Jiang & Feng (2014) which is consistent with the CESE-MHD-
NLFFF extrapolation code by adopting an optimal magnetic ﬁeld splitting form. Such a procedure
is designed to improve the quality of the raw magnetogram to make it closer to the force-free condition
and smooth the raw data to help reduce the measurement uncertainties and numerical errors from
the computation.

The high-resolution vector magnetograms are routinely observed by SDO/Helioseismic and Mag-
netic Imager (HMI; Schou et al. 2012). Speciﬁcally, the Space-weather HMI Active Region Patches
(SHARPs, Bobra et al. 2014) vector magnetogram data product, hmi.sharp_cea_720s, provided by
SDO/HMI, is used as the input for the extrapolation. The SHARP data series provide maps following
each patch of signiﬁcant solar magnetic ﬁeld for its entire lifetime and the data is also de-rotated to
the disk center and remapped using the cylindrical equal area (CEA) Cartesian coordinates. Pho-
tospheric vector magnetograms are included with a cadence of 720 s and a spatial resolution of 0.5(cid:48)(cid:48)
(∼ 0.36 Mm). For the two selected events, vector magnetograms from the ARs at least 10 minutes
before the ﬂare onset times (estimated from the soft X-ray measurement of the GOES satellite) are
preprocessed to get necessary boundary conditions and derive the initial conditions from a potential
ﬁeld solver for the NLFFF extrapolations. The original magnetograms are rebinned from 0.5(cid:48)(cid:48) per
pixel to 1(cid:48)(cid:48) per pixel for the preprocessing procedure and the subsequent extrapolations. Figures 1
and 2 show the overall smoothing eﬀect as a result of preprocessing for the two events by comparing
the raw and preprocessed maps of magnetograms and current density Jz distributions. Random noise
is obviously suppressed in the Jz maps.

For the consideration of the speed and accuracy of the computation in terms of high-resolution
and large ﬁeld-of-view solar magnetograms, a non-uniform grid structure within a block-structured
parallel computation framework is adopted with the help of PARAMESH software package (MacNeice
et al. 2000) for the CESE-MHD-NLFFF code. For the grid initialization, the whole computation
domain includes the pre-set main computation region and the surrounding buﬀer zones to reduce
the inﬂuence of the side boundaries (Jiang & Feng 2013) since the magnetic ﬁeld at these numerical
boundaries are simply ﬁxed as their initial values (i.e., those of the potential ﬁeld). Then the whole
computational domain is divided into blocks with diﬀerent spatial resolutions and all blocks have
identical logical structures which are evenly distributed among processors. As we vary the grid size
only in height (the z dimension) for this study, the grid resolution matches the resolution of the

Quantitative Study of CME Magnetic Flux Rope Topology

7

magnetogram at the bottom boundary and decreases by four times at the top of the computational
domain. After the grid initialization, the initial condition of the whole computation domain is
assigned by a potential ﬁeld solution derived from the input magnetogram by using the Green’s
function method (Chiu & Hilton 1977; Metcalf et al. 2008).

2.4. Convergence Study

Before we start our analysis for the two events, we also examine the relaxation process by several
metrics to obtain converged extrapolation results. These include the residual of the ﬁeld between
two successive iteration steps, the force-freeness of the numerical result CWsin, the divergence-free
condition (cid:104)|fi|(cid:105) (Wheatland et al. 2000; Metcalf et al. 2008) and the total magnetic energy Etot (see
their deﬁnitions in the Appendix).

For event 1, we carry out the extrapolation based on the whole SHARP vector magnetogram
(540(cid:48)(cid:48) × 344(cid:48)(cid:48)) and then calculate the convergence metrics for every 200 iteration steps as shown in
the ﬁrst column of Figure 3 with the ﬁnest grid size 1(cid:48)(cid:48). As shown in Figure 3, the residual goes
through a gradual increase before ∼ 6500 iteration steps because the bottom boundary condition
drives the system away from the initial potential ﬁeld (Jiang & Feng 2012). Even though obvious
ﬂuctuations appear after the initial driving process, the overall trend of the residual toward the
end is decreasing, accompanied by small oscillations. After ∼ 30,000 iteration steps, the residual is
reduced to ∼ 10−5 and still maintains a declining trend. Other metrics also display a trend with little
variation and both CWsin and (cid:104)|fi|(cid:105) reach relatively small values. Thus the extrapolation result can
be considered as a converged solution. It is noticed that there are some oscillations in the convergence
process, which may be caused by the broad distribution of the weak ﬁeld and random noise from
the input magnetogram. The total computation time (to converge until 40,000 iteration steps) took
about 95 hours with 19 cores on a 24-core local desktop with 48 GB memory.

For event 2, the size of the SHARP magnetogram is 282(cid:48)(cid:48) × 266(cid:48)(cid:48). One run is carried out with the
smallest grid size 1(cid:48)(cid:48) and the full size magnetogram. The second column of Figure 3 shows a smooth
convergence process. The residual converges very fast after an initial rise exceeding 10−4 to an order
of magnitude smaller, < 10−5, within 11,000 iterations. All the other metrics show clear monotonic
decreases and stabilize after ∼ 11,000 iterations, which is consistent with an optimal convergence
pattern in the previous tests of this code (Jiang & Feng 2012; Jiang et al. 2012; Jiang & Feng 2013).
This convergence process is relatively smooth without any spurious oscillations, so a ﬁnal solution
with good indication of convergence is readily obtained for subsequent analysis. It took about 23
hours with 19 cores on the same local desktop for the extrapolation result to converge (after 20,000
iteration steps).

3. CHARACTERIZATION OF MFRS ON THE SUN

3.1. MFR Identiﬁcation Method

Both extrapolation and observation results are critical for the MFR identiﬁcation on the Sun. As
for the observational analysis of MFRs, we analyze the data from Atmospheric Imaging Assembly
(AIA, Lemen et al. 2012) and HMI on board the SDO spacecraft to study the evolution of the
corresponding ﬂares for the two events. SDO/AIA provides full-disk images in 7 extreme ultraviolet
(EUV) and 2 ultraviolet (UV) wavelength channels with a high spatial resolution (0.6(cid:48)(cid:48) per pixel and
a total of 4096 × 4096 pixels per image) and a moderate time cadence (12 s in EUV channels and
24 s in UV channels).

8

He et al.

To provide additional support for the MFR identiﬁcation and characterization of the corresponding
CME-MFRs at a diﬀerent stage besides the extrapolation, we also analyze the evolution of ﬂare
ribbons and the corresponding magnetic reconnection properties. Flare ribbons map the footpoints
of reconnected ﬁeld lines. Magnetic reconnection beneath the erupting MFR forms ﬂare loops, and
the same amount of reconnected magnetic ﬂux is injected into the MFR. Reconnection may also take
place between the erupting MFR and the ambient magnetic ﬁeld, although this is not the main focus
of this study. Therefore, magnetic reconnection ﬂux associated with ﬂare ribbons is useful to establish
a quantitative connection between MFRs on the Sun (both before and after the ﬂare eruption) and
their interplanetary counterparts. The amount of accumulative magnetic reconnection ﬂux can be
measured by summing up the magnetic ﬂux in newly brightened UV pixels within ﬂare ribbons. In
this study, we employ 1600 ˚A data from SDO/AIA and vector magnetograms from SDO/HMI to
measure the magnetic reconnection ﬂux and magnetic reconnection rate from the brightening pixels,
following the automated approach developed by Qiu et al. (2002, 2004). The brightening pixels are
chosen when the intensity of a pixel is greater than ∼ 6 times the median intensity which is ﬁxed
and determined from the average of a 6-minute time period (for the region of interest before the
eruption).

While an MFR is generally considered as a group of coherent winding ﬁeld lines, it has not been
quantitatively deﬁned in a universal way. Identifying a coherent MFR based on the reconstructed
coronal magnetic ﬁeld derived from the real magnetogram can be diﬃcult, given the complex magnetic
topology. Liu et al. (2016) suggested that the magnetic twist number Tw can serve as a good proxy
for ﬁnding the axis of an MFR. The twist number Tw measures how many turns two inﬁnitesimally
close ﬁeld lines wind about each other (see Berger & Prior 2006), and is deﬁned by

Tw =

=

(cid:90)

L
1
4π

µ0J||
4πB
(cid:90)

L

dl =

1
4π

(cid:90)

L

(∇ × B) · B
B2

dl,

(3)

α dl, if ∇ × B = αB.

Here α is the force-free parameter and the integral is taken along one magnetic ﬁeld line with path
length L, starting from one end point of the ﬁeld line on the boundary to the other. For both events,
extrapolation results are generated utilizing magnetograms that are chosen at least 10 minutes before
the ﬂare onset times. We calculate the twist number Tw at each grid point in the whole volume with
the same grid size as the resolution of the input magnetogram, i.e., 1(cid:48)(cid:48). Then we start the topology
analysis with the deﬁnition of Liu et al. (2016) that an MFR has a bundle of ﬁeld lines spiraling
around the same axis or each other by more than one turn (|Tw| (cid:62) 1, see also Duan et al. 2019).
Combined with the ﬁeld-line topology, one may also require that such constrained MFR volume be a
single tube without multiple bifurcations. In addition, the footpoints of MFRs should be restricted
within or close to main ﬂare ribbon areas identiﬁed from AIA observations, given the general relation
between the magnetic reconnection process during ﬂares and the formation of erupting CME-MFRs
(Moore et al. 2001; Qiu et al. 2004; Qiu 2009; Zhu et al. 2020).

3.2. Results for AR 11719

For event 1 in AR 11719, simultaneous observations of the ﬂare’s time evolution in SDO/AIA 94,
131 and 1600 ˚A wavelength channels before and during the ﬂare eruption are given in Figure 4.
From the EUV observations in 94 ˚A and 131 ˚A, some curved structures are present near the center

Quantitative Study of CME Magnetic Flux Rope Topology

9

before the ﬂare eruption, which were recognized as hot channels in Cheng & Ding (2016). But such a
sigmoid-like structure based on emission-line images does not necessarily yield a similarly continuous
magnetic ﬁeld-line conﬁguration (Titov & D´emoulin 1999; Schmieder et al. 2015; Cheng & Ding
2016; Duan et al. 2017), i.e., that of an MFR. Instead, these brightened features may correspond
to groups of short sheared arcades which are discontinuous, based on the extrapolation result as to
In the bottom panels of Figure 4 for the 1600 ˚A UV observation, there
be demonstrated below.
is a typical ﬂare morphology with two brightening ribbons lying nearly in parallel with each other,
expanding and then drifting away from each other during the time evolution. The contours of ﬂare
ribbons coincide with the curved brightening structures in 131 ˚A observation at the central region,
especially towards the “hooked” ends, which gives us a rough estimation of possible positions for the
MFR footpoints for this event.

The time evolution of the ﬂare ribbons in the corresponding SDO/HMI magnetograms which are
remapped to the sub areas in SDO/AIA’s ﬁeld of view is shown in Figure 5, the left column. Be-
sides, we add the X-ray ﬂux measurement of the whole Sun provided by the GOES satellite for the
wavelengths of soft X-ray (1 - 8 ˚A) during the same time period in the right column, together with
the concurrent measurements of accumulative magnetic reconnection ﬂux and magnetic reconnection
rate by the approach of Qiu et al. (2002). This M6.5 ﬂare eruption starts at ∼ 06:55 UT according
to the rapid change of the soft X-ray ﬂux curve, which is consistent with the onset of the magnetic
reconnection ﬂux increase shown in the second panel in the right column. Based on the average of the
total unsigned magnetic ﬂux in each enclosed ribbon area with one dominant polarity (either positive
or negative, Kazachenko et al. 2017), the ﬁnal accumulative magnetic reconnection ﬂux reaches the
magnitude of 17 ± 2.8 × 1020 Mx after the eruption. Given the association between the magnetic
reconnection ﬂux and the ﬂux content of the corresponding ICME/MC ﬂux ropes (e.g., Qiu et al.
2007; Hu et al. 2014), such ﬂux measurement from ﬂare ribbons can be helpful for making further
connections of MFRs on the Sun and their in situ counterparts, as to be laid out in Section 4.

In Figure 6a, some sample ﬁeld lines are drawn over the corresponding AIA 94 ˚A image to give a
qualitative comparison between the extrapolation result and the observation. Several loop structures
are recovered overlapping with selected ﬁeld lines, and a set of twisted ﬁeld lines lying around the
PIL takes the shape resembling the middle of the inverse “S” sigmoid as seen in 94 ˚A channel (see
also Figure 6c). Among the comparisons with the 1600 ˚A observation in Figure 6b, footpoints of the
twisted ﬁeld lines locating close to the ﬂare ribbons are associated with grid points with negative
Tw values. On a plane near the bottom layer (at z = 2(cid:48)(cid:48) above the photosphere), we pick all the
points with Tw (cid:54) −1 around the central sigmoidal structure, and plot ﬁeld lines passing through
this set of seed points. We eliminate open ﬁeld lines which only have one end point attached to the
bottom boundary thus not “closed”, and also ill-deﬁned Tw values. As a result shown in Figure 6b,
four groups of ﬁeld lines are distinguished starting with the selected seed points. Compared to the
locations of the ﬂare ribbons, three groups of ﬁeld lines are excluded since a part of their footpoints
extends out of the ribbon sites. Therefore the remaining bundle of ﬁeld lines shown in Figure 6c is
identiﬁed to be the most likely candidate MFR for the 2013 April 11 event before the ﬂare eruption.
After determining the MFR, we can ﬁnd the axial ﬁeld line with the maximum |Tw| of the MFR. The
axis of the identiﬁed MFR in event 1 possesses Tw = −1.5 which lies close to the bottom boundary
and reaches a maximum height at z ∼ 19(cid:48)(cid:48). The time sequence of ﬂare ribbons after 6:42 UT is then
co-aligned with the bottom boundary magnetogram and overplotted in the usual way, color coded

10

He et al.

by elapsed time in Figure 6d. It shows that two groups of footpoints from the identiﬁed MFR locate
on the opposite sides of the ﬂare ribbons near the far ends, consistent with the scenario proposed by
Moore et al. (2001).

To further conﬁrm the existence of the MFR, we also check diﬀerent topological properties from a
side view. In Figure 7, the coherent MFR structure is still maintained with a diﬀerent |Tw| threshold
as seen in Figure 7a and 7b. The distribution of the quantity |J|/|B| as a proxy to current density is
displayed in Figure 7c and 7d on a cross section plane nearly perpendicular to the MFR. The current
density |J| itself also shows a similar distribution. Based on the current density distribution at the
intersections between the identiﬁed MFR ﬁeld lines and the vertical slice in Figure 7c, the ﬂux rope
goes through a region with relatively high current density. The geometric boundary of an MFR can
also be estimated by the location of a quasi-separatrix layer (QSL), a very thin layer where there
is a strong gradient of the ﬁeld line connectivity (Demoulin et al. 1996). Such a feature is typically
deﬁned mathematically by the high squashing factor Q (Titov et al. 2002; Vemareddy 2021). As
shown in Figure 7e and 7f, the identiﬁed group of ﬁeld lines with small Q values is surrounded indeed
by a clear boundary with high squashing degree Q.

3.3. Results for AR 12158

Observations of the ﬂare ribbon evolution before and during the ﬂare eruption for event 2 in AR
12158 are shown in Figure 8. Event 2 also exhibits a two-ribbon ﬂare morphology, with two ribbon
areas co-located near the two ends of an inverse “S” shape sigmoidal structure. The southward ribbon
has a more dominant swept area in size than the other. Similarly, we use the overlapping regions
between the ﬂare ribbon areas and the curved brightening sigmoidal structures in 131 ˚A observation
to approximate the possible locations of MFR footpoints in this event.

In Figure 9, we show the same set of panels for event 2, as in Figure 5. We ﬁnd that the initial
enhancement of the X-ray ﬂux is earlier than the signiﬁcant increase of the magnetic reconnection
ﬂux. After a slow rise phase with small reconnection rate, a strong ﬂare is produced quickly after
∼17:20 UT. The ﬁnal accumulative magnetic reconnection ﬂux reaches the magnitude of 47±7.5×1020
Mx for event 2. The ﬂare ribbon morphology still exhibits general features for a “two ribbon” ﬂare,
albeit asymmetry of the spatial distributions is more pronounced, indicating perhaps more signiﬁcant
deviation from a “standard” 2D geometry.

For event 2, the conﬁguration of magnetic ﬁeld lines from the extrapolation result has a good visual
correspondence with the AIA observations as shown in Figure 10a and 10b. There is a clear inverse
“S” sigmoid structure near the center imaged by AIA 94 ˚A passband. However, the core ﬁeld in our
extrapolation result mainly consists of several groups of sheared arcades structure over-arched by
higher coronal loops, rather than one continuous inverse “S” structure (see also Duan et al. 2017).
Based on the long-term evolution before the eruption, Cheng et al. (2015) found that there was a
central sigmoid structure initially appearing in the AIA 94 ˚A passband at ∼15:10 UT and then it had
gone through repetitive disappearance and re-appearance processes. So they suggested that a nascent
MFR was under formation prior to the major eruption by tether-cutting reconnection. After ∼16:55
UT, the sigmoid develops quickly and produces an X1.6 ﬂare and a CME. In order to ﬁnd a possible
MFR structure prior to the ﬂare, we take a look at the Tw distribution and ﬁnd that the majority
of the core ﬁeld region has a negative and relatively small twist number such that |Tw| < 1. This
indicates the absence of a twisted coherent MFR according to the criterion we are using (Liu et al.
2016; Duan et al. 2019). In Figure 10c and 10d, we show the isosurfaces of Tw = −1 and Tw = −0.8

Quantitative Study of CME Magnetic Flux Rope Topology

11

in the central volume. There is no coherent structure under the Tw = −1 criterion, though several
coherent structures appear for a lower threshold in magnitude Tw = −0.8. Comparing these ﬁeld line
bundles with the locations of the ﬂare ribbons, there are two coherent weakly twisted ﬁeld line groups
as presented in Figure 10e. The left group has a maximum |Tw| ∼ 0.82 but extends to a relatively far
away location from the ribbon (also to a height of z ∼ 50(cid:48)(cid:48)). It also appears to be nearly perpendicular
to the local PIL. Another group of ﬁeld lines lies close to the bottom boundary and has a maximum
|Tw| ∼ 0.97, which still, strictly speaking, fails to satisfy the MFR criterion. In addition, the current
density distribution in Figure 10f at the intersections of a vertical slice with two ﬁeld line bundles
also shows less clearly-deﬁned concentrations in those ﬁeld-line regions. So diﬀerent from the NLFFF
extrapolation result by Zhao et al. (2016) and the time-dependent magnetofrictional modeling result
by Kilpua et al. (2021), which demonstrated the existence of a strongly twisted MFR, we do not
produce such a pre-existing MFR prior to the ﬂare eruption for event 2.

4. ESTIMATION OF MAGNETIC PROPERTIES OF MFRS

After the identiﬁcation of MFRs on the Sun for the two events, we look further into the magnetic
properties of MFRs at diﬀerent stages or locations and try to ﬁnd a potential correlation among them.
For example, the total magnetic ﬂux (generally considered conserved) is one of the most important
quantitative properties of MFRs that can be measured or derived to make a connection between
CME-MFR and the corresponding ICME/MC (Qiu et al. 2007; Hu et al. 2014).

Speciﬁcally, for the identiﬁed pre-existing MFR in event 1, we give below a quantitative description
of its magnetic properties. The axial magnetic ﬂux enclosed by the pre-existing MFR’s footpoints
is calculated for further analysis. Regions of footpoints are obtained by extracting the intersection
points between ﬁeld lines from the MFR and a slice parallel to the bottom boundary (photosphere).
We choose a slice at a height of 1.0(cid:48)(cid:48) where two well-separated groups of footpoints are obtained. In
general, more grid points are included under a smaller |Tw| threshold value for the MFR criterion, i.e.,
more points with |Tw| exceeding such a value. Here we denote the region dominated by the positive
magnetic ﬁeld in the MFR footpoints as ‘F P+’ and the region taken up mainly by the negative
magnetic ﬁeld in the MFR footpoints as ‘F P−’. The total axial (or toroidal) magnetic ﬂux for both
regions is calculated based on Φz = (cid:82)(cid:82) BzdS, where Bz is the vertical magnetic ﬁeld component.
The integration is obtained by summing up the magnetic ﬂux from all grid points (pixels) within the
identiﬁed footpoints regions on the slice.

Table 2 shows the result of ﬂux calculations of the identiﬁed MFR. The diﬀerences of Φz between
F P+ and F P− are within one order of magnitude for diﬀerent Tw criteria, though they get smaller
for a larger |Tw| threshold. Given that the largest Φz in magnitude is still signiﬁcantly smaller than
the reconnection ﬂux measured from the ﬂare ribbons after the eruption, especially for the typical
criterion |Tw| > 1.0, we believe that the MFR found from the extrapolation is likely a seed MFR
before the eruption. It should be noted that one group of footpoints (F P−) locates closer to one
main negative polarity of the magnetogram than the other group of footpoints (F P+) to any main
positive polarity. And F P− takes up a rather smaller area compared to F P+, but the latter has much
smaller average magnetic ﬁeld (cid:104)Bz(cid:105), current density (cid:104)Jz(cid:105) and total current Iz.

A summary of quantitative results for MFRs in two events is given in Table 3. The corresponding in
situ modeling results for the two events are provided by Hu et al. (2021a) by applying two magnetic
cloud reconstruction methods. One of the modeling methods is the Grad-Shafranov reconstruction
technique yielding a 2D conﬁguration of the MFR (Hu & Sonnerup 2002; Hu 2017). The other

12

He et al.

method is the optimization approach based on a more general linear force free formulation to obtain
a more complex quasi-3D structure (Hu et al. 2021a,b). For event 1, the twist of the MFR identiﬁed
in the source region is relatively consistent with the in situ modeling results of the MFR structure,
considering the uncertainty of the total twist numbers. The axial magnetic ﬂux calculated from
the in situ modeling results is signiﬁcantly larger than the seed MFR identiﬁed in the source region
before the eruption, while the reconnection ﬂux measured from the source region after the eruption
is generally larger than the axial ﬂux from the in situ modeling results. The poloidal magnetic ﬂux,
obtained from the in situ modeling results, appears to agree better with the reconnection ﬂux, subject
to the uncertainty in the axial length. Speciﬁcally if one assumes an axial length ∈ [1, 2] au typically
(see Hu et al. 2015) for an MC ﬂux rope, this amounts to the total poloidal ﬂux in the range 9.2 -
18×1020 Mx for event 1, based on the 2D MC modeling result.

For event 2, the axial (toroidal) ﬂux content from the in situ 3D model agrees with the reconnec-
tion ﬂux within their respective uncertainty ranges. Other parameters in the source region are not
available (marked by “...”) since we did not ﬁnd a pre-existing MFR structure before the eruption.
The 2D MC model also failed to yield an acceptable solution. The twist of the MFR from the in
situ modeling is generally larger than the twist we found in the groups of ﬁeld lines in Figure 10
(the maximum |Tw| ∼ 0.97). The CME-MFR containing signiﬁcant amount of ﬂux was likely formed
during the eruption through dynamic evolution process in the solar atmosphere. Recently it was
demonstrated by unique observational analysis and data-inspired numerical simulation (Xing et al.
2020; Jiang et al. 2021a) the “increase-to-decrease” behavior in the toroidal ﬂux of the CME-MFR.
However the applicability of such analysis to our events is beyond the scope of the current study. To
study such a process usually requires discerning multiple ﬂux systems with complex and constantly
evolving topologies. And it remains a challenge to separate the toroidal and poloidal ﬂux contents
from the reconnection ﬂux, although one pioneering approach developed by Qiu (2009) for detailed
analysis of the reconnection sequence can help in future studies.

5. CONCLUSIONS

In this paper, we have identiﬁed the MFR structures in the solar source regions and established the
connection between MFRs on the Sun and their in situ counterparts quantitatively for two selected
events. One event began on 2013 April 11 (event 1, AR 11719) and the other on 2014 Septem-
ber 10 (event 2, AR 12158), respectively. Each event exhibits a sequence of ﬂare, CME and the
corresponding ICME observed by multiple space-borne instruments. We perform coronal magnetic
ﬁeld extrapolations for each AR by the CESE-NLFFF-MHD method, which utilizes the preprocessed
photospheric magnetograms and the results are also examined through a set of convergence metrics.
Remote-sensing observations from SDO are analyzed to ﬁnd evidence of MFRs and trace the evolu-
tion of the associated ﬂares. Speciﬁcally we measure the amount of magnetic reconnection ﬂux by
analyzing the temporal and spatial evolution of ﬂare ribbons. We combine the extrapolation results
with observations to identify MFRs on the Sun before the eruption and estimate their magnetic
properties. The main results of our study are summarized as follows.

1. Observational evidence of MFR footpoints and associated magnetic reconnection ﬂux during the
ﬂare eruption are inferred from multi-wavelength observations. From the comparison among
EUV observations, there are signs of MFRs for the two events. Based on the ﬂare ribbon
measurements, the total magnetic reconnection ﬂux reaches 17 ± 2.8 × 1020 Mx for event 1, and

Quantitative Study of CME Magnetic Flux Rope Topology

13

47 ± 7.5 × 1020 Mx for event 2, respectively, which corresponds to the amount of available ﬂux
to be injected into the ﬁnal CME-MFRs.

2. From the combination of extrapolation and observation results, a coherent MFR structure
before the ﬂare eruption is identiﬁed for event 1. However, there is no pre-existing MFR found
for event 2, based on the same set of MFR criteria, including the requirement for the ﬁeld-line
twist number |Tw| > 1.0 and also both regions of the MFR ﬁeld-line footpoints close to the
main ﬂare ribbons. For event 1, a coherent pre-eruption MFR is determined, which carries a
maximum Tw = −1.5 and its two ends are located near the opposite ends of the respective ﬂare
ribbons across the PIL.

3. The magnetic properties of MFRs on the Sun are summarized and compared with their cor-
responding in situ modeling results from Hu et al. (2021a) in Table 3. For event 1, the axial
magnetic ﬂux from in situ modeling results is in the order of 1020 ∼ 1021 Mx, while the total
magnetic reconnection ﬂux after the eruption from the source region is in the order of ∼ 1021
Mx. Both are signiﬁcantly larger than the ﬂux in the identiﬁed pre-existing MFR’s footpoints
area which is in the order of 1019 ∼ 1020 Mx (see Table 2).

4. For event 2, there is no pre-existing MFR identiﬁed. The amount of the magnetic reconnection
ﬂux, 47 ± 7.5 × 1020 Mx, agrees with the corresponding ICME MFR toroidal ﬂux, ∼ 16 - 81
×1020 Mx, within the limits of the uncertainty ranges.

These results for the two events indicate the dynamic and complex nature of the MFR formation
during its evolution process while some properties (like magnetic ﬂux and twist) are useful for making
connections between the formation of MFRs on the Sun and their in situ characteristics in a quan-
titative manner. Based on these quantitative results, we conclude that the magnetic reconnection
process, manifested during solar ﬂares, injects signiﬁcant amount of magnetic ﬂux into the ensuing
CME-MFR. For event 1, the identiﬁed pre-existing (or pre-eruption) MFR from the NLFFF extrap-
olation is likely a seed MFR before the eruption and additional ﬂux is injected through the magnetic
reconnection process associated with the ﬂare. Furthermore, based on the comparison among various
inter-related magnetic ﬂux contents and the corresponding ﬂare ribbon morphology for each event, we
conclude that for event 1, a quasi-2D conﬁguration of the MFR is largely valid for which the poloidal
ﬂux is more meaningfully deﬁned and compared more favorably with the corresponding reconnection
ﬂux than the axial ﬂux. For event 2, however, we believe that the MFR topology deviates more
from a 2D conﬁguration, but is better described by a quasi-3D model for which the axial ﬂux agrees
with the reconnection ﬂux. In this case, the poloidal ﬂux is not readily deﬁned geometrically because
there does not exist a straight ﬁeld line representing the central axis of a ﬂux rope (see Hu et al.
2021a). Therefore, for the 3D model, we choose to approximate the poloidal ﬂux by the product of
the average ﬁeld-line twist and the axial ﬂux (see, e.g., Hu et al. 2014).

This study represents an eﬀort to make a physical connection between a solar MFR (including the
MFR before and after the eruption) and the corresponding ICME/MC by the quantitative compari-
son of the magnetic properties under diﬀerent scenarios through extrapolations and observations. It
is usually not easy to envisage the existence of a coherent pre-existing MFR, reconstruct it before the
eruption in the solar source region for a CME event and make one-to-one connection with its inter-
planetary counterpart. Eﬀorts have been made continuously on the quantitative description of the

14

He et al.

MFR conﬁguration with more advanced observations and improved numerical simulation techniques,
which is helpful for further understanding the formation and evolution processes of the CME-MFRs.
Future studies including more events will be carried out for a deeper understanding of CME-MFRs,
where improvements to the extrapolation method and use of high-resolution ground-based data can
be implemented.

1

2

3

4

5

6

7

8

9

10

W.H. and Q.H. acknowledge the support by NSF grants AGS-1954503 and AGS-1650854, and
the NSO/DKIST Ambassador Program. C.W.J. acknowledges the support from National Natu-
ral Science Foundation of China (NSFC 42174200, 41822404), the Fundamental Research Funds
for the Central Universities (Grant No. HIT.OCEF.2021033), and Shenzhen Technology Project
JCYJ20190806142609035. A.P. would like to acknowledge the support by the Research Coun-
cil of Norway through its Centres 458 of Excellence scheme, project number 262622, as well as
through the Synergy Grant number 810218 459 (ERC-2018-SyG) of the European Research Coun-
cil. Data for solar observations are provided by GOES, and the HMI and AIA instruments onboard
SDO (http://jsoc.stanford.edu/). The Wind spacecraft measurements are accessed via the NASA
CDAWeb: https://cdaweb.gsfc.nasa.gov/index.html/.

APPENDIX

CONVERGENCE METRICS

The metrics for the convergence study of the computation during the iteration process are deﬁned
below. These include the residual of the ﬁeld between two successive iteration steps n and n − 1
(n > 1),

resn(B) =

(cid:118)
(cid:117)
(cid:117)
(cid:116)

1
3

(cid:80)

(cid:88)

δ=x,y,z

i(Bn
(cid:80)

iδ − Bn−1
iδ
i(Bn
iδ)2

)2

,

(1)

where the subscript i refers to the linear indices of grid points and runs over all grid points in the
computational volume. We also estimate the force-freeness of the numerical result by a current-
weighted metric, CWsin, which is deﬁned by (equivalent to the weighted sine of the angle between J
and B),

CWsin =

(cid:80)
(cid:80)

i |Ji|σi
i |Ji|

; σi =

|Ji × Bi|
|Ji||Bi|

.

(2)

Other important parameters including the total magnetic energy Etot and the divergence-free con-

dition (cid:104)|fi|(cid:105) (Wheatland et al. 2000; Metcalf et al. 2008) are deﬁned by,

Etot =

(cid:88)

B2

i ∆Vi,

(cid:104)|fi|(cid:105) =

i
1
M

(cid:88)

i

(∇ · B)i
6|Bi|/(∆x)i

,

(3)

where ∆x is the grid spacing and M refers to the total number of grid points contained, and ∆Vi =
(∆x)i × (∆y)i × (∆z)i representing a volume element.

Quantitative Study of CME Magnetic Flux Rope Topology

15

Amari, T., Luciani, J. F., Aly, J. J., Mikic, Z., &

Gibson, S. E., Fan, Y., T¨or¨ok, T., & Kliem, B.

REFERENCES

Linker, J. 2003, ApJ, 585, 1073,
doi: 10.1086/345501

Antiochos, S. K., DeVore, C. R., & Klimchuk,

J. A. 1999, ApJ, 510, 485, doi: 10.1086/306563
Aulanier, G., & Dud´ık, J. 2019, A&A, 621, A72,

doi: 10.1051/0004-6361/201834221

Aulanier, G., Janvier, M., & Schmieder, B. 2012,

A&A, 543, A110,
doi: 10.1051/0004-6361/201219311

Berger, M. A., & Prior, C. 2006, Journal of

Physics A Mathematical General, 39, 8321,
doi: 10.1088/0305-4470/39/26/005

Bobra, M. G., Sun, X., Hoeksema, J. T., et al.

2014, SoPh, 289, 3549,
doi: 10.1007/s11207-014-0529-3

Burlaga, L. F. 1992, J. Geophys. Res., 97, 4283,

doi: 10.1029/91JA03027

Carmichael, H. 1964, A Process for Flares,

Vol. 50, 451

Chen, P. F. 2011, Living Reviews in Solar Physics,

8, 1, doi: 10.12942/lrsp-2011-1

Cheng, X., & Ding, M. D. 2016, ApJS, 225, 16,

doi: 10.3847/0067-0049/225/1/16

Cheng, X., Ding, M. D., & Fang, C. 2015, ApJ,
804, 82, doi: 10.1088/0004-637X/804/2/82
Cheng, X., Guo, Y., & Ding, M. 2017, Science

China Earth Sciences, 60, 1383,
doi: 10.1007/s11430-017-9074-6

Chiu, Y. T., & Hilton, H. H. 1977, ApJ, 212, 873,

doi: 10.1086/155111

De Rosa, M. L., Schrijver, C. J., Barnes, G., et al.

2009, ApJ, 696, 1780,
doi: 10.1088/0004-637X/696/2/1780

Demoulin, P., Henoux, J. C., Priest, E. R., &

Mandrini, C. H. 1996, A&A, 308, 643

Duan, A., Jiang, C., He, W., et al. 2019, ApJ, 884,

73, doi: 10.3847/1538-4357/ab3e33

Duan, A., Jiang, C., Hu, Q., et al. 2017, ApJ, 842,

119, doi: 10.3847/1538-4357/aa76e1

Fan, Y. 2001, ApJL, 554, L111,

doi: 10.1086/320935

Forbes, T. G., & Priest, E. R. 1984, SoPh, 94,

315, doi: 10.1007/BF00151321
Gary, G. A. 1989, ApJS, 69, 323,

doi: 10.1086/191316
—. 2001, SoPh, 203, 71,

doi: 10.1023/A:1012722021820

2006, SSRv, 124, 131,
doi: 10.1007/s11214-006-9101-2

Gopalswamy, N., Akiyama, S., Yashiro, S., & Xie,

H. 2018, Journal of Atmospheric and
Solar-Terrestrial Physics, 180, 35,
doi: 10.1016/j.jastp.2017.06.004

Gopalswamy, N., Yashiro, S., Akiyama, S., & Xie,

H. 2017, SoPh, 292, 65,
doi: 10.1007/s11207-017-1080-9

Guo, Y., Xia, C., & Keppens, R. 2016, ApJ, 828,

83, doi: 10.3847/0004-637X/828/2/83

Hirayama, T. 1974, SoPh, 34, 323,

doi: 10.1007/BF00153671

Hu, Q. 2017, Sci. China Earth Sciences, 60, 1466,

doi: doi:10.1007/s11430-017-9067-2

Hu, Q., He, W., Qiu, J., Vourlidas, A., & Zhu, C.

2021a, Geophys. Res. Lett., 48, e90630,
doi: 10.1029/2020GL090630

Hu, Q., He, W., Zhao, L., & Lu, E. 2021b,

Frontiers in Physics, 9, 407,
doi: 10.3389/fphy.2021.706056

Hu, Q., Qiu, J., Dasgupta, B., Khare, A., &

Webb, G. M. 2014, ApJ, 793, 53,
doi: 10.1088/0004-637X/793/1/53

Hu, Q., Qiu, J., & Krucker, S. 2015, Journal of
Geophysical Research (Space Physics), 120,
5266, doi: 10.1002/2015JA021133

Hu, Q., & Sonnerup, B. U. ¨O. 2002, Journal of
Geophysical Research (Space Physics), 107,
1142, doi: 10.1029/2001JA000293

Inoue, S., Kusano, K., B¨uchner, J., & Sk´ala, J.

2018, Nature Communications, 9, 174,
doi: 10.1038/s41467-017-02616-8

Jiang, C., Chen, J., Duan, A., et al. 2021a,

Frontiers in Physics, 9, 575,
doi: 10.3389/fphy.2021.746576

Jiang, C., Cui, S., & Feng, X. 2012, Computers &

Fluids, 54, 105, doi: https:
//doi.org/10.1016/j.compﬂuid.2011.10.006

Jiang, C., & Feng, X. 2012, ApJ, 749, 135,

doi: 10.1088/0004-637X/749/2/135

—. 2013, ApJ, 769, 144,

doi: 10.1088/0004-637X/769/2/144

—. 2014, SoPh, 289, 63,

doi: 10.1007/s11207-013-0346-0

16

He et al.

Jiang, C., Feng, X., Fan, Y., & Xiang, C. 2011,

Moore, R. L., Sterling, A. C., Hudson, H. S., &

ApJ, 727, 101,
doi: 10.1088/0004-637X/727/2/101

Lemen, J. R. 2001, ApJ, 552, 833,
doi: 10.1086/320559

Jiang, C., Wu, S. T., Feng, X., & Hu, Q. 2014,

Pesnell, W. D., Thompson, B. J., & Chamberlin,

ApJL, 786, L16,
doi: 10.1088/2041-8205/786/2/L16

P. C. 2012, SoPh, 275, 3,
doi: 10.1007/s11207-011-9841-3

Jiang, C., Feng, X., Liu, R., et al. 2021b, Nature

Priest, E. R., & Longcope, D. W. 2017, SoPh, 292,

Astronomy, 5, 1126,
doi: 10.1038/s41550-021-01414-z

Jing, J., Liu, C., Lee, J., et al. 2018, ApJ, 864,

138, doi: 10.3847/1538-4357/aad6e4

Joshi, B., Kushwaha, U., Veronig, A. M., et al.

2017, ApJ, 834, 42,
doi: 10.3847/1538-4357/834/1/42

Kaiser, M. L., Kucera, T. A., Davila, J. M., et al.

2008, SSRv, 136, 5,
doi: 10.1007/s11214-007-9277-0

Kazachenko, M. D., Lynch, B. J., Welsch, B. T.,

& Sun, X. 2017, ApJ, 845, 49,
doi: 10.3847/1538-4357/aa7ed6

Kilpua, E. K. J., Pomoell, J., Price, D., Sarkar,

R., & Asvestari, E. 2021, Frontiers in
Astronomy and Space Sciences, 8, 35,
doi: 10.3389/fspas.2021.631582

Kopp, R. A., & Pneuman, G. W. 1976, SoPh, 50,

85, doi: 10.1007/BF00206193

Lemen, J. R., Title, A. M., Akin, D. J., et al. 2012,
SoPh, 275, 17, doi: 10.1007/s11207-011-9776-8

Liu, R. 2020, Research in Astronomy and

Astrophysics, 20, 165,
doi: 10.1088/1674-4527/20/10/165

Liu, R., Kliem, B., Titov, V. S., et al. 2016, ApJ,
818, 148, doi: 10.3847/0004-637X/818/2/148
Longcope, D., Beveridge, C., Qiu, J., et al. 2007,
SoPh, 244, 45, doi: 10.1007/s11207-007-0330-7

Low, B. C., & Lou, Y. Q. 1990, ApJ, 352, 343,

doi: 10.1086/168541

MacNeice, P., Olson, K. M., Mobarry, C., de

Fainchtein, R., & Packer, C. 2000, Computer
Physics Communications, 126, 330,
doi: 10.1016/S0010-4655(99)00501-9

Magara, T. 2004, ApJ, 605, 480,

doi: 10.1086/382148

Metcalf, T. R., Jiao, L., McClymont, A. N.,

Canﬁeld, R. C., & Uitenbroek, H. 1995, ApJ,
439, 474, doi: 10.1086/175188

Metcalf, T. R., De Rosa, M. L., Schrijver, C. J.,

et al. 2008, SoPh, 247, 269,
doi: 10.1007/s11207-007-9110-7

25, doi: 10.1007/s11207-016-1049-0

Qiu, J. 2009, ApJ, 692, 1110,

doi: 10.1088/0004-637X/692/2/1110

Qiu, J., Hu, Q., Howard, T. A., & Yurchyshyn,

V. B. 2007, ApJ, 659, 758, doi: 10.1086/512060

Qiu, J., Lee, J., Gary, D. E., & Wang, H. 2002,

ApJ, 565, 1335, doi: 10.1086/324706

Qiu, J., Liu, W., Hill, N., & Kazachenko, M. 2010,

ApJ, 725, 319,
doi: 10.1088/0004-637X/725/1/319

Qiu, J., Wang, H., Cheng, C. Z., & Gary, D. E.
2004, ApJ, 604, 900, doi: 10.1086/382122

Schmieder, B., Aulanier, G., & Vrˇsnak, B. 2015,

SoPh, 290, 3457,
doi: 10.1007/s11207-015-0712-1

Schou, J., Scherrer, P. H., Bush, R. I., et al. 2012,
SoPh, 275, 229, doi: 10.1007/s11207-011-9842-2
Schrijver, C. J., DeRosa, M. L., Metcalf, T., et al.

2008, ApJ, 675, 1637, doi: 10.1086/527413

Sturrock, P. A. 1966, Nature, 211, 695,

doi: 10.1038/211695a0

Sun, X., Hoeksema, J. T., Liu, Y., et al. 2012,

ApJ, 748, 77, doi: 10.1088/0004-637X/748/2/77

Thalmann, J. K., Wiegelmann, T., & Raouaﬁ,

N. E. 2008, A&A, 488, L71,
doi: 10.1051/0004-6361:200810235

Titov, V. S., & D´emoulin, P. 1999, A&A, 351, 707
Titov, V. S., Hornig, G., & D´emoulin, P. 2002,

Journal of Geophysical Research (Space
Physics), 107, 1164, doi: 10.1029/2001JA000278

van Ballegooijen, A. A., & Mackay, D. H. 2007,

ApJ, 659, 1713, doi: 10.1086/512849

van Ballegooijen, A. A., & Martens, P. C. H. 1989,

ApJ, 343, 971, doi: 10.1086/167766

Vemareddy, P. 2021, Frontiers in Physics, 9, 605,

doi: 10.3389/fphy.2021.749479

Vemareddy, P., & Zhang, J. 2014, ApJ, 797, 80,

doi: 10.1088/0004-637X/797/2/80

Wang, H., Cao, W., Liu, C., et al. 2015, Nature

Communications, 6, 7008,
doi: 10.1038/ncomms8008

Wheatland, M. S., & R´egnier, S. 2009, ApJL, 700,

L88, doi: 10.1088/0004-637X/700/2/L88

Quantitative Study of CME Magnetic Flux Rope Topology

17

Wheatland, M. S., Sturrock, P. A., & Roumeliotis,
G. 2000, ApJ, 540, 1150, doi: 10.1086/309355
Wiegelmann, T., Inhester, B., & Sakurai, T. 2006,
SoPh, 233, 215, doi: 10.1007/s11207-006-2092-z

Wiegelmann, T., & Sakurai, T. 2021, Living

Reviews in Solar Physics, 18, 1,
doi: 10.1007/s41116-020-00027-4

Xing, C., Cheng, X., & Ding, M. D. 2020, The

Innovation, 1, 100059,
doi: 10.1016/j.xinn.2020.100059

Zhao, J., Gilchrist, S. A., Aulanier, G., et al. 2016,
ApJ, 823, 62, doi: 10.3847/0004-637X/823/1/62

Zhu, C., Qiu, J., Liewer, P., et al. 2020, ApJ, 893,

Wiegelmann, T., Thalmann, J. K., Inhester, B.,

141, doi: 10.3847/1538-4357/ab838a

et al. 2012, SoPh, 281, 37,
doi: 10.1007/s11207-012-9966-z

18

He et al.

Table 1. Timelines of two Flare-CME-ICME events observed by multiple spacecraft (all
times are in UT).

Flare peak time Magnitude Location

STEREO SOHO/LASCO WIND/ICME

2013-04-11T07:16
2014-09-10T17:45

M6.5
X1.6

N07E13
N11E05

07:39
17:54

07:24
18:00

04-14T17:00
09-12T22:00

CME time

CME time

arrival time

Figure 1. First row (from the left to right panels): the three components Bx, By, and Bz of the raw
magnetogram and the derived vertical current density Jz distribution for event 1, AR11719, at 06:36 UT on
2013 April 11. Second row: the corresponding maps from the preprocessed magnetogram. The size of each
map is 540(cid:48)(cid:48) × 344(cid:48)(cid:48).

Figure 2. The raw and preprocessed maps for event 2, AR 12158, at 17:00 UT on 2014 September 10.
Format is the same as Figure 1. The size of each map is 282(cid:48)(cid:48) × 266(cid:48)(cid:48).

010020030040050005010015020025030001002003004005000501001502002503000501001502002503000501001502002503000100200300400500010020030040050001002003004005000100200300400500-1000-50005001000Bx, By, Bz(G)-200-1000100200Jz (G/arcsec)050100150200250050100150200250050100150200250050100150200250050100150200250050100150200250050100150200250050100150200250050100150200250050100150200250-1000-50005001000Bx, By, Bz(G)-200-1000100200Jz (G/arcsec)Quantitative Study of CME Magnetic Flux Rope Topology

19

Figure 3. Two sets of convergence metrics of two extrapolation runs for AR11719 (event 1, left column) and
AR12158 (event 2, right column). The top three rows show the metrics of CWsin, the total magnetic energy
Etot (arbitrary unit), and (cid:104)|fi|(cid:105), respectively. Panels in the bottom row show the evolution of residuals for
the two events.

01002003004000.00.20.40.60.8Evolution of CWsin010020030040002468Evolution of Etot01002003004000.00000.00020.00040.00060.00080.0010Evolution of <|fi|>10020030040010-610-510-410-3Evolution of ResidualSteps/100 0501001502002500.30.40.50.60.70.8Evolution of CWsin0501001502002508910111213Evolution of Etot0501001502002500.00000.00020.00040.00060.0008Evolution of <|fi|>5010015020025010-610-510-4Evolution of ResidualSteps/100 20

He et al.

Figure 4. Observations from SDO/AIA in 94 ˚A, 131 ˚A and 1600 ˚A (from top to bottom row) wavelength
channels at three diﬀerent times as marked in each panel (from left to right) of AR11719 for event 1.
Contours of ﬂare ribbons in red as observed in 1600 ˚A are also overlaid on 94 ˚A and 131 ˚A plots which are
observed at the same times.

SDO/AIA 1600Å 04/11T06:39SDO/AIA 1600Å 04/11T06:57SDO/AIA 1600Å 04/11T07:05SDO/AIA 0131Å 04/11T06:39SDO/AIA 0131Å 04/11T06:57SDO/AIA 0131Å 04/11T07:05SDO/AIA 0094Å 04/11T06:39SDO/AIA 0094Å 04/11T06:57SDO/AIA 0094Å 04/11T07:05Quantitative Study of CME Magnetic Flux Rope Topology

21

Figure 5. Left column: observation of ﬂare ribbons in 1600 ˚A passband (top panel) and the time evolution
of ﬂare ribbons overplotted on the co-aligned HMI magnetogram for event 1 (bottom panel), where the areas
swept by ﬂare ribbons are colored by the elapsed time in minutes as denoted by the colorbar. The thick
red curve lying in the middle of the lower panel marks the PIL. Right column: GOES soft X-ray (1-8 ˚A)
ﬂux measurement for the ﬂare in event 1 (top panel), the magnetic reconnection ﬂux measured from 1600 ˚A
observation (middle panel) for both positive (red) and negative (blue) ﬂux measurements with uncertainty
limits based on diﬀerent background removal criteria, while the unsigned mean ﬂux is shown in black with
the standard deviation represented by the errorbars, and the corresponding magnetic reconnection rates for
event 1 (bottom panel). The dashed lines in all three panels indicate the ﬂare onset time of event 1.

06:3006:4507:0007:1507:3007:4508:00   10-610-510-4Soft X-ray flux (Watt/m2)06:3006:4507:0007:1507:3007:4508:0005.0×10201.0×10211.5×10212.0×1021Reconnection flux (Mx)positivenegativemean&stdev06:3006:4507:0007:1507:3007:4508:0005.0×10171.0×10181.5×10182.0×10182.5×10183.0×1018Reconnection rate (Mx/s)Time of 2013 Apr 11 (hh:mm)positive ratenegative ratemean rate22

He et al.

(a)

(b)

(c)

(d)

Figure 6. Identiﬁcation of an MFR for event 1: (a) the overall ﬁeld line conﬁguration superimposed on an
AIA 94 ˚A image which is observed at 06:36 UT, (b) ﬁeld line groups identiﬁed from the extrapolation result
based on the criterion of |Tw| > 1 overplotted on an AIA 1600 ˚A image observed at 06:59 UT, (c) the ﬁeld
lines of the identiﬁed MFR, and the underlying PIL in red drawn over the corresponding line-of-sight HMI
magnetogram, and (d) the same as (c) except for the additional superimposed ﬂare ribbons, which are color
coded by elapsed time in the same way as Figure 5.

Quantitative Study of CME Magnetic Flux Rope Topology

23

(a)

(c)

(e)

(b)

(d)

(f)

Figure 7. The enlarged and side views of the identiﬁed MFR in Figure 6b for the criteria of (a) |Tw| > 1,
and (b) |Tw| > 0.8, respectively, and similarly for Figure 6c: (c) the distribution of |J|/|B| as indicated by
the colorbar on a vertical slice across the identiﬁed MFR for |Tw| > 1 with the MFR ﬁeld-line intersection
points colored by the corresponding values according to the colorbar, (d) same as (c) but overplotted with
the MFR ﬁeld lines, and (e-f) the distributions of the squashing degree Q on the same slices as (c) and (d).

24

He et al.

Figure 8. Observations from SDO/AIA in 94 ˚A, 131 ˚A and 1600 ˚A (from top to bottom row) wavelength
channels of AR12158 for event 2. The format is the same as Figure 4.

SDO/AIA 1600Å 09/10T16:55SDO/AIA 1600Å 09/10T17:23SDO/AIA 1600Å 09/10T17:29SDO/AIA 0131Å 09/10T16:55SDO/AIA 0131Å 09/10T17:23SDO/AIA 0131Å 09/10T17:29SDO/AIA 0094Å 09/10T16:55SDO/AIA 0094Å 09/10T17:23SDO/AIA 0094Å 09/10T17:29Quantitative Study of CME Magnetic Flux Rope Topology

25

Figure 9. The observations of ﬂare ribbons and measurements of the reconnection ﬂux for event 2. Format
is the same as Figure 5.

16:3016:5517:2017:4518:1018:3519:00   10-610-510-4Soft X-ray flux (Watt/m2)16:3016:5517:2017:4518:1018:3519:0001×10212×10213×10214×10215×1021Reconnection flux (Mx)positivenegativemean&stdev16:3016:5517:2017:4518:1018:3519:0002×10184×10186×10188×1018Reconnection rate (Mx/s)Time of 2014 Sep 10 (hh:mm)positive ratenegative ratemean rate26

He et al.

(a)

(c)

(e)

(b)

(d)

(f)

Figure 10. Magnetic ﬁeld topology analysis for event 2: (a-b) selected ﬁeld lines superimposed on the Bz
map, and an AIA 131 ˚A image at 17:00 UT, respectively, the isosurfaces of (c) Tw = −1 and (d) Tw = −0.8
over the background of the AIA 1600 ˚A observation at 17:23 UT, (e) selected ﬁeld line bundles based on the
threshold condition |Tw| > 0.8 with a composite background of Bz map and color-coded ﬂare ribbons (the
same as the bottom left panel in Figure 9), and (f) the distribution of |J|/|B| on a vertical slice intersecting
two ﬁeld line bundles in (e).

Quantitative Study of CME Magnetic Flux Rope Topology

27

Table 2. Magnetic properties of MFR footpoints in AR11719
for event 1 with diﬀerent criteria at z = 1.0(cid:48)(cid:48): Φz, the sum of
normal magnetic ﬂux over all associated grids for each group of
identiﬁed footpoints; the fourth column shows the number of grids
on the chosen slice containing the identiﬁed footpoints; (cid:104)Bz(cid:105), the
average vertical magnetic ﬁeld for each group of footpoints; (cid:104)Jz(cid:105),
the average current density in the z direction for each group of
footpoints, Jz = (∇×B)z
, and Iz = Σ(JzdS), the total current in
the z direction for each group. (+): positive ﬂux; (−): negative
ﬂux.

µ0

Φz

# of
(1020 Mx) Grids

(cid:104)Bz(cid:105)
(G)

(cid:104)Jz(cid:105)
(10−3 A·m−2)

Iz
(1010 A)

F P+ (+)
(−)
F P− (+)
(−)

F P+ (+)
(−)
F P− (+)
(−)

F P+ (+)
(−)
F P− (+)
(−)

0.510
0
0
-1.34

0.385
0
0
-0.934

0.283
0
0
-0.638

|Tw| > 0.8
58.2
165

-0.79

64

-394

5.8

|Tw| > 0.9
63.6
114

-0.60

48

-367

5.8

-6.9

20

-3.6

15

|Tw| > 1.0
78.5
68

-0.19

-0.68

35

-343

5.8

11

28

He et al.

Table 3. Summary of magnetic properties for the MFRs in two events.

Parameter
(all ﬂux in 1020 Mx)

Axial ﬂux Φz
Twist τ
Reconnection ﬂuxc
Poloidal ﬂux

Source Region Results

in situ Modeling Resultsa

2D

3D

Event 1: 2013-04-11

0.3 - 1.3 b
∼ 1.5b (axis)
17 ± 2.8
...

5.7
1.6 /au
...
9.2 /au

8.9 - 14
0.84 - 1.1 /au
...
10 - 12 /au

Event 2: 2014-09-10

Axial ﬂux Φz
Twist τ
Reconnection ﬂuxc
Poloidal ﬂux

...
...
47 ± 7.5
...
aIn situ modeling results of magnetic clouds cited from Hu et al. (2021a). For the 3D model, the poloidal
ﬂux is approximated by τ Φz.
bParameters for identiﬁed “pre-existing” MFR only.
cThe reconnection ﬂux is estimated based on Figures 5 and 9.

16 - 81
1.0 - 2.4 /au
...
38 - 81 /au

...
...
...
...

