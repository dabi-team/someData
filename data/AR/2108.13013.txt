MNRAS 000, 1–9 (2015)

Preprint 31 August 2021

Compiled using MNRAS LATEX style ﬁle v3.0

Atomic data and the density structures of planetary nebulae

Leticia Juan de Dios★ and Mónica Rodríguez,
Instituto Nacional de Astrofísica Óptica y Electrónica, Luis Enrique Erro 1, Tonantzintla 72840, Puebla, Mexico

1
2
0
2

g
u
A
0
3

]

A
G
.
h
p
-
o
r
t
s
a
[

1
v
3
1
0
3
1
.
8
0
1
2
:
v
i
X
r
a

Accepted XXX. Received YYY; in original form ZZZ

ABSTRACT
We study the density structures of planetary nebulae implied by four diagnostics that sample diﬀerent regions within the nebulae:
[S ii] 𝜆6716/𝜆6731, [O ii] 𝜆3726/𝜆3729, [Cl iii] 𝜆5518/𝜆5538, and [Ar iv] 𝜆4711/𝜆4740. We use a sample of 46 objects
with deep spectra that allow the calculation of the electron density from these four diagnostics, and explore the impact that
diﬀerent atomic data have on the results. We compare the observational results with those obtained from photoionization models
characterized by three diﬀerent density structures. We conclude that the atomic data used in the calculations of electron density
fully determine the density structures that are derived for the objects. We illustrate this by selecting three combinations of atomic
data that lead to observational results that are compatible with each of the three diﬀerent density structures explored with the
models.

Key words: atomic data – planetary nebulae: general

1 INTRODUCTION

Reliable chemical abundances of planetary nebulae (PNe) can pro-
vide fundamental information on the evolution of low and interme-
diate mass stars and on how they enrich the interstellar medium
of galaxies (see, e.g., Delgado-Inglada et al. 2015). For these abun-
dances to be reliable, it is critical to obtain good determinations of the
physical conditions, the electron density and electron temperature,
which can be estimated using the relative intensities of collisionally
excited lines. The electron density is especially important at the high
densities found in many PNe, where the use of diﬀerent density di-
agnostics or diﬀerent atomic data introduces signiﬁcant changes in
the derived chemical abundances (Delgado Inglada et al. 2009; Juan
de Dios & Rodríguez 2017).
In the optical range,

the most used density diagnostics are
[S ii] 𝜆6716/𝜆6731, [O ii] 𝜆3726/𝜆3729, [Cl iii] 𝜆5518/𝜆5538, and
[Ar iv] 𝜆4711/𝜆4740. These diagnostics provide information on the
density structure in the objects, since they are produced by ions that
sample diﬀerent regions of the nebulae. That PNe are not neces-
sarily homogeneous can be appreciated in the multiple images that
have been obtained of these objects, where knots and condensations
are usually observed. Thus, the discrepancies between the electron
densities obtained from diﬀerent diagnostics can be indicating the
presence of density variations inside PNe. However, the interpreta-
tion of the results is not straightforward. One must take into account
that the lines used in the diagnostics have diﬀerent critical densities
(Rubin 1989), and this can introduce a bias in the results. Lines with
relatively low critical densities, as the ones used by the [S ii] and
[O ii] diagnostics, are suppressed in high density regions by colli-
sional de-excitation. Thus, in a highly stratiﬁed nebula containing
dense ionized clumps, the emission of the lines used in these di-
agnostics will be biased towards regions of low density. Besides,

★ E-mail: leticiajd@inaoep.mx

© 2015 The Authors

observational errors and uncertainties in the atomic data used in the
calculations will have diﬀerent eﬀects on the results, depending on
the density regime and on the density diagnostic.

Several works, such as those of Saraph & Seaton (1970);
Stanghellini & Kaler (1989); Copetti & Writzl (2002), and Wang
et al. (2004), have studied the density structure of PNe using the
four density diagnostics listed above, ﬁnding a variety of results. The
four studies ﬁnd that the [S ii] densities are higher than those de-
rived from [O ii], and most of the authors conclude that there is good
agreement between the densities obtained with [S ii] and [Cl iii], but
Stanghellini & Kaler (1989) ﬁnd that the electron densities obtained
with [Cl iii] are higher than the ones obtained with [S ii]. Saraph &
Seaton (1970) and Wang et al. (2004) ﬁnd that the densities obtained
for [Ar iv] are usually higher than the ones implied by the other di-
agnostics, but Copetti & Writzl (2002) argue that [Cl iii] and [Ar iv]
lead to similar results, and Stanghellini & Kaler (1989) ﬁnd that the
density obtained with [Ar iv] is lower than the ones obtained with the
other diagnostics. This last result was used by Stanghellini & Kaler
(1989) to suggest that the Ar+3 spectral lines might be produced in
regions whose densities are lower than those where the other ions are
located.

Since the observational samples used in these studies are large,
the diﬀerent results they ﬁnd about the density stratiﬁcation cannot
be attributed to observational errors, but should be due to diﬀerences
in the methodology, in particular the atomic data, adopted in each
work. In fact, Copetti & Writzl (2002) and Wang et al. (2004) argue
that the systematically lower densities obtained with [O ii] arise from
uncertainties in the transition probabilities used for [O ii]. Wang et al.
(2004) explore the eﬀect of changing the atomic data for O+ and ﬁnd
a set of transition probabilities that lead to a better agreement in the
densities of [O ii] and [S ii]. However, the eﬀects of using diﬀerent
atomic data have been barely explored, and might explain most of the
discrepancies and the diﬀerences between the diﬀerent studies (Juan
de Dios & Rodríguez 2017).

 
 
 
 
 
 
2

Juan de Dios & Rodríguez

In Juan de Dios & Rodríguez (2017), we explored the uncertainties
introduced by diﬀerent atomic data in nebular abundance determi-
nations using diﬀerent combinations of the available atomic data to
calculate physical conditions and chemical abundances in a sample
of 36 PNe and eight H ii regions. We found that atomic data introduce
uncertainties that can exceed 0.6–0.8 dex at densities above 104cm−3
and that the atomic data related to the determination of electron den-
sity are the ones that have the largest impact. Previous works, such
as those listed above, have mentioned the bias that the selection of
atomic data introduce in the determination of the electron density,
but a systematic analysis of how the diﬀerent atomic datasets aﬀect
the density structure determined for PNe has not been made.

In this work, we compare the electron densities estimated from
diﬀerent ions using photoionization models and observations. By
assuming diﬀerent density structures in the models, we determine the
type of patterns that can be expected for the densities derived from
the [S ii], [O ii], [Cl iii], and [Ar iv] diagnostics. We also explore
the eﬀects of introducing ‘observational errors’ in the line ratios
predicted by the models. We compare the results from the models
with those obtained for a sample of PNe using diﬀerent combinations
of atomic data. The purpose is to explore what we can know about the
density structures of PNe and about the atomic data used to determine
these structures.

2 OBSERVATIONAL SAMPLE

Our sample consists of 46 Galactic PNe with published deep spec-
tra of relatively high spectral resolution. The objects in the sam-
ple have the lines required to deﬁne the four most used den-
sity diagnostics, [S ii] 𝜆6716/𝜆6731, [O ii] 𝜆3726/𝜆3729, [Cl iii]
𝜆5518/𝜆5538, and [Ar iv] 𝜆4711/𝜆4740, and the two most used
temperature diagnostics, [N ii] 𝜆5755/(𝜆6548 + 𝜆6583) and [O iii]
𝜆4363/(𝜆4959 + 𝜆5007). The objects cover a wide range of degrees
of excitation: there are PNe where He ii lines are not detected along
with objects where the intensities of He ii 𝜆4686 and H𝛽 are very
similar. On the other hand, the electron densities are in the range
log(𝑛e) (cid:39) 2.0–4.5 cm−3. Hence the sample can be considered rep-
resentative of the population of ionized nebulae, or at least of those
objects where the lines listed above are not too weak to be measured.
The 46 PNe and the references for their spectra are: IC 2165
(Hyung 1994), NGC 2440 (Hyung & Aller 1998), NGC 6153 (Liu
et al. 2000), IC 4846 (Hyung et al. 2001a), IC 5217 (Hyung et al.
2001b), M 1-42, M 2-36 (Liu et al. 2001), Hu 1-2 (Pottasch et al.
2003), IC 418 (Sharpee et al. 2003), NGC 6302 (Tsamis et al. 2003),
Hu 1-2, NGC 6210, NGC 6572, NGC 6720, NGC 6741, NGC 6826,
NGC 6884, NGC 7662 (Liu et al. 2004), NGC 6543 (Wesson &
Liu 2004), IC 2003, NGC 6803 (Wesson et al. 2005), Cn 2-1,
H 1-50, He 2-118, M 1-20, M 2-4, M 3-21, M 3-32, NGC 6439,
NGC 6567, NGC 6620 (Wang & Liu 2007), DdDm1 (Otsuka et al.
2009), NGC 2867 (García-Rojas et al. 2009), NGC 7009 (Fang &
Liu 2011), Hb 4, Cn 1-5, He 2-86, M 1-61, M 3-15, NGC 5189,
NGC 6369, PC 14, Pe 1-1 (García-Rojas et al. 2012), H4-1 (Ot-
suka & Tajitsu 2013), NGC 6210 (Bohigas et al. 2015), and H 1-50
(García-Rojas et al. 2018).

3 MODELS

default in Cloudy, identiﬁed as ‘PN abundances’ and ‘ISM dust’, re-
spectively. The parameters that vary for each model are the eﬀective
temperature, 𝑇eﬀ, the luminosity of the ionizing source, 𝐿, the inner
nebular radius, 𝑅0, and the density of hydrogen in the gas, 𝑛H, as a
function of the distance to the star, 𝑅.

The models are ionized by blackbody spectra characterized by
𝑇eﬀ = 30, 35, 40, 50, 75, 100, 125, 150, 180, 210, 240 × 103 K and
𝐿 = 200, 1000, 3000, 6000, 10000, 15000 L(cid:12). The distance from
the central star to the gas is given by 𝑅0 = 5 × 1015, 1016, 5 × 1016,
3 × 1017, 3 × 1018, and 1019 cm. The hydrogen density at 𝑅0 is in
the range 102–105 cm−3 and varies in steps of 0.2 dex.

The density structures we are considering are: constant hydrogen
density, a power law (𝑛H ∝ 𝑅 𝛼, where 𝛼 varies from −1.5 to 4 in
steps of 0.5), and combined structures. All the models are ionization
bounded.

The combined models are constructed by adding the line intensities
relative to H𝛽 of the spectra of two constant-density models. With this
approach, each model contributes 50 per cent to the total intensity of
H𝛽. The combined models have the same eﬀective temperature and
luminosity for the ionizing star but have diﬀerent hydrogen densities
and can have diﬀerent initial radii. There is a large number of possible
combinations of models, 26700, and we just calculate a random
sample of 5000. The maximum contrast in density between the two
combined models is a factor of ten. Some of the computed models,
and those that we initially calculated for higher density contrasts, lead
to densities from the [Cl iii] diagnostic that are more than 0.2 dex
higher than the density from [O ii] at 𝑛e ≤ 5600 cm−3, a result that
is not found in our sample PNe for any combination of atomic data.
Hence, these models are not included in the ﬁnal sample.

For the power-law models, some combinations of the parameters
do not return a feasible model. For example, combinations of a high
density at 𝑅0 with a low eﬀective temperature. If the initial hydrogen
density is too high or if it increases extremely fast, there are not
enough photons to ionize the gas and the models fail. Those failed
models are excluded from the analysis that follows.

We have changed the transition probabilities and collision
strengths that come by default in Cloudy for the ions used to de-
termine the physical conditions.1 The models have been computed
using two sets of atomic data, A and B. Further details are provided
below in Section 4.

We use pyCloudy (Morisset 2013) to extract for each model the
line intensities needed to use the four density diagnostics and the
two temperature diagnostics mentioned in Section 2 above: 𝑛e[S ii],
𝑛e[O ii], 𝑛e[Cl iii], 𝑛e[Ar iv], 𝑇e[N ii], and 𝑇e[O iii]. We only take into
account models where the intensities of the diagnostic lines relative
to H𝛽 are equal or higher than the faintest ones measured in the
objects. With this restriction, around 50–60 per cent of the models of
each type of density structure are discarded. The most critical lines
to ﬁlter the models in this way are the [Ar iv] lines.

In some cases, the density diagnostics are near the limits of their
validity, and roundoﬀ errors lead to line ratios that do not return a
density value. These models are also rejected from our analysis.

Initial calculations are performed for 4050, 1000, and 5000 models
of constant, power-law, and combined-density structure. After all the
rejection processes described above, we are left with 833 (dataset
A) and 662 (dataset B) models of constant hydrogen density, 387
(dataset A) and 341 (B) power-law models, and 1260 (A) and 1648
(B) combined models. We note that the exact number of models is

We have constructed a grid of spherical models using the photoion-
ization code Cloudy (version c17.00, Ferland et al. 2017). The input
chemical abundances and dust properties are the ones that come by

1 This was done by creating new stout format dataﬁles that contain the atomic
data of interest (https://www.nublado.org/wiki/StoutData).

MNRAS 000, 1–9 (2015)

not very important for our purposes, since we are just illustrating the
kind of density structures that can be obtained with these assumed
density structures.

Table 1. Atomic data used in the analysis. The atomic datasets used in the
computation and analysis of the models are identiﬁed with letters ‘A’ and ‘B’.
Letter ‘R’ identiﬁes the datasets that have been rejected.

Atomic data and electron density in PNe

3

4 ANALYSIS AND ATOMIC DATA

We calculate the electron densities and temperatures for both obser-
vations and models using Pyneb (v1.1.1), a code for the analysis of
nebular emission lines developed by Luridiana et al. (2015). Pyneb
solves the equations of statistical equilibrium for the lower-lying
energy levels of the ions we are considering here (see, e.g., Oster-
brock & Ferland 2006). These equations require the use of transition
probabilities and collision strengths that are obtained from quantum
mechanical calculations (see, e.g., Aggarwal & Keenan 2013).

Since we want to compare the results obtained from the observa-
tions with those implied by the models, for each model we extract
the values of the line intensities necessary to obtain the electron
density and electron temperature, and the analysis of these lines is
performed in the same way for both observations and model. We
calculate for each object and model 𝑛e[S ii], 𝑛e[O ii], 𝑛e[Cl iii] and
𝑛e[Ar iv]. We also derive an average density from the logarithmic
values of these densities, (cid:104)log(𝑛e)(cid:105), and use this average density to
determine 𝑇e[N ii] and 𝑇e[O iii]. We use 𝑇e[N ii] to calculate 𝑛e[S ii]
and 𝑛e[O ii], and 𝑇e[O iii] for 𝑛e[Cl iii] and 𝑛e[Ar iv].

We start by considering the atomic data shown in Table 1. This
database is a compilation of transition probabilities and collision
strengths for the ions that we use in our analysis, N+, O+, O++, S+,
Cl++, and Ar3+. The eﬀects of most of these atomic datasets on the
derived physical conditions have been previously explored in Juan
de Dios & Rodríguez (2017), but we have added sets of transition
probabilities for [S ii] (Kisielius et al. 2013), [Ar iv] (Czyzak &
Krueger 1963), and [O iii] (Tachiev & Fischer 2001), which are the
ones used by default in CLOUDY, a set of collision strenghts for
[Cl iii] (Sossah & Tayal 2012), and the recent determinations of
transition probabilities of Rynkun et al. (2019) for [S ii], [Cl iii] and
[Ar iv]. All these sets of atomic data are available in recent versions
of Pyneb (Morisset et al. 2020).

In Juan de Dios & Rodríguez (2017), we argue that four of the
atomic datasets listed in Table 1 should not be used. Three of them
lead to densities that diﬀer signiﬁcantly from those inferred from
the other density diagnostics in most objects, or that fail to return a
valid electron density for several objects. These data are the transi-
tion probabilities of Tayal & Zatsarinny (2010) for S+, the transition
probabilities of Wiese et al. (1996) for O+, and the collision strengths
of Mendoza (1983) for Ar+3. The fourth dataset to be excluded con-
tains the collision strengths of Palay et al. (2012) for O+3, whose
values could not be reproduced by Storey et al. (2014). These four
datasets are not used in any of the calculations that follow, and are
classiﬁed as rejected and identiﬁed with an ‘R’ in Table 1.

We have studied the behaviour of the added atomic datasets listed
above before including them in further parts of the analysis. We
have compared the results obtained using these new sets with those
implied by all other datasets for the sample of PNe. We ﬁnd that for
20 of the 46 objects in the sample, we cannot obtain a value of 𝑛e[S ii]
using the transition probabilities of Kisielius et al. (2014). On the
other hand, some of the values of 𝑛e[Ar iv] implied by the transition
probabilities of Czyzak & Krueger (1963) diﬀer by more than 0.5 dex
from the ones obtained for 𝑛e[S ii], 𝑛e[O ii] and 𝑛e[Cl iii]. The values
of 𝑛e[Ar iv] obtained with this set of atomic data tend to be very
high, and higher than the ones obtained using the set of collision
strengths of Mendoza (1983), which has been rejected for leading to

𝐴𝑖 𝑗

Set

Υ𝑖 𝑗

Set

Ion

N+

O+

O++

S+

GMZ97-WFD96
FFT04
NR79-WFD96
Z82-WFD96
FFT04
WFD96

SZ00-WFD96
FFT04
GMZ97-WFD96
TFF01
PKW09
TZ10-PKW09
VVF96-KHOC93
VVF96-MZ82a
KKFLB14
RGJ19

Cl++ M83-KS86
Fal99
M83
RGJ19
Ar3+ MZ82a

MZ82a-KS86
CK63
RGJ19

T11
HB04
LB94
P06-T07
Kal09
P76-McLB93-v1
P76-McLB93-v2
T07
AK99
LB94
Pal12-AK99
SSB14
TZ10
RBS96

BZ89
M83
ST12
RBK01
RB97
M83
ZBL87

A, B

R

A, B

A, B

A, B
R

B
A
R

A
R

B
R

B
A

A
B
R

References for the atomic data: AK99: Aggarwal & Keenan (1999), BZ89:
Butler & Zeippen (1989), CK63: Czyzak & Krueger (1963), Fal99: Fritzsche
et al. (1999), FFT04: Fischer & Tachiev (2004), GMZ97: Galavis et al. (1997),
HB04: Hudson & Bell (2004), Kal09: Kisielius et al. (2009), KHOC93:
Keenan et al. (1993), KKFLB14: Kisielius et al. (2014), KS86: Kaufman
& Sugar (1986), LB94: Lennon & Burke (1994), M83: Mendoza (1983),
McLB93: McLaughlin & Bell (1993), MZ82a: Mendoza & Zeippen (1982a),
MZ82b: Mendoza & Zeippen (1982b), NR79: Nussbaumer & Rusca (1979),
P06: Pradhan et al. (2006), P76: Pradhan (1976), Pal12: Palay et al. (2012),
PKW09: Podobedova et al. (2009), RB97: Ramsbottom & Bell (1997),
RBK01: Ramsbottom et al. (2001), RBS96: Ramsbottom et al. (1996),
RGJ19: Rynkun et al. (2019), SSB14: Storey et al. (2014), ST12: Sossah
& Tayal (2012), SZ00: Storey & Zeippen (2000), T07: Tayal (2007), T11:
Tayal (2011), TZ10: Tayal & Zatsarinny (2010), VVF96: Verner et al. (1996),
WFD96: Wiese et al. (1996), Z82: Zeippen (1982), ZBL87: Zeippen et al.
(1987).

very high densities. Since we think that these transition probabilities
for S+ and Ar+3 are not providing reliable results, we place them
in the list of rejected atomic data and we will not use them in the
analysis that follows. We have identiﬁed with the letter ‘R’ these and
the previously rejected atomic datasets in Table 1.

In the case of the observed objects, the calculations of physical
conditions are performed using all combinations of those sets of
atomic data that have not been rejected. The total number of com-
binations is 622,608. In the case of the models, we use two sets of
atomic data, marked as ‘A’ and ‘B’ in Table 1, to explore how the de-
rived density structures change with atomic data. These sets have the
same collision strengths but diﬀerent transition probabilities, since

MNRAS 000, 1–9 (2015)

4

Juan de Dios & Rodríguez

the latter are the most critical atomic data in the determination of the
electron density.

Besides, for each type of model we use Monte Carlo simulations
to estimate the eﬀects of 3 and 5 per cent Gaussian errors in the line
ratios used to determine the physical conditions. These uncertainties
are similar to those generally reported in the literature for these line
ratios. We use 500 calculations per model since the distributions of
the results do not change signiﬁcantly beyond that number.

5 RESULTS

Fig. 1 shows the resulting density structures for the models. In each
panel, the diﬀerences between the electron density implied by each
diagnostic and the average density, (cid:104)log(𝑛e)(cid:105) (the average of the log-
arithmic values of 𝑛e[S ii], 𝑛e[O ii], 𝑛e[Cl iii] and 𝑛e[Ar iv]), are plot-
ted as a function of the average density for the models with constant,
power-law and combined hydrogen densities. The upper and middle
panels of Fig. 1 show the results calculated with atomic datasets A
and B, respectively. These results do not include uncertainties in the
model-predicted line intensity ratios. Fig. 1 illustrates that the density
structures derived for the models computed with atomic datasets A
and B are very similar, as expected. The small diﬀerences that can
be seen are due to the diﬀerent sensitivity introduced by atomic data
to either roundoﬀ errors in the line intensities or small changes in
temperature. The lower panels of Fig. 1 show the median values of
the density diﬀerences derived with each diagnostic as a function of
the average density for the models calculated with atomic dataset B.
The median diﬀerences are calculated in the density intervals deﬁned
by the shaded and unshaded areas in Fig. 1.

The left panels of Fig. 1 show that in the models of constant hy-
drogen density, where the ionization introduces a gradient in electron
density, the densities implied by the diﬀerent diagnostics are ordered
according to the ionization potential of each ion, from S+, to O+,
Cl++ and Ar+3. The combined models show similar results but with
more dispersion, which is introduced by combinations of models
with very diﬀerent degrees of ionization because of their diﬀerent
densities and distances to the ionizing source. In fact, the combined
models can lead to cases where most of the [Ar iv] emission arises
from the lower density region, making the [Ar iv] diagnostic the one
that implies the lowest density. We note that the number of combined
models calculated for sets A and B is the same, but the number of
displayed models diﬀers because more of the models analysed with
set A fail to return a valid density for the four diagnostics and are
excluded from the plots.

On the other hand, the density structure displayed by the power-
law models is diﬀerent to the ones obtained with the other models.
The results plotted in Fig. 1 show that the densities implied by the
[Ar iv] diagnostic in the power-law models are usually lower than
those obtained with [O ii] and [Cl iii], and similar to those obtained
with [S ii]. Thus the observed structure for these models is: 𝑛e[S ii]
(cid:39) 𝑛e[Ar iv] < 𝑛e[O ii] (cid:39) 𝑛e[Cl iii]. The diﬀerent patterns introduced
by the diﬀerent assumed structures can thus be compared with those
derived for the observational sample, and this comparison might pro-
vide some insight into the density structure of the observed objects.
The density structures derived for the sample of PNe using atomic
datasets A and B are shown in Fig. 2, where it can be seen that the
two datasets lead to very diﬀerent density structures for the observed
objects. This eﬀect is especially clear in the case of the [O ii] di-
agnostic, which leads to some of the highest densities when atomic
dataset A is used, and to some of the lowest densities when dataset B
is used. Besides, none of the structures depicted in Fig. 2 look like the

MNRAS 000, 1–9 (2015)

ones obtained with the models. The observational results are aﬀected
by uncertainties, but we can compare them with the results calcu-
lated for the models by assuming that the predicted line ratios have
uncertainties. This is shown in Fig. 3 for the models calculated with
atomic dataset B and uncertainties equal to 5 per cent. A comparison
of Figs. 1 and 3 shows that the uncertainties increase the spread in the
results but do not change in a signiﬁcant way the structures obtained
with the models.

As a matter of fact, when other sets of atomic data are used to
calculate densities for the PNe, they change the derived density struc-
ture. This means that the combination of atomic data used for the
calculations determines what density structure we obtain. In order
to illustrate this, we have interchanged the atomic datasets used to
perform the analysis for the models of constant hydrogen density, so
that the models computed with set A are analysed with set B and
vice versa. The results are shown in Fig. 4, where it can be seen
that the change of atomic data in the analysis of the models leads to
density structures similar to those derived for the objects using the
same atomic data. The structure observed in the left panels of Fig. 4 is
similar to the one obtained with dataset A for the objects, whereas the
results of the right panels are similar to those obtained with dataset
B for the objects. Thus, the density structures derived for the objects
depend strongly on the atomic data used in the calculations: atomic
data are shaping the derived density pattern.

5.1 Associating atomic datasets and density structures

Since the choice of atomic data determines the density structure
derived for the observed objects, and since not all density structures
are possible, one might wonder if we can constrain the structure of
the real objects or determine which atomic data are working better
by comparing the results implied by realistic structures with those
derived for the observational sample using diﬀerent combinations of
atomic data.

The density structures we have used here to construct the photoion-
ization models are not comprehensive and might be unrealistic, but
we can use them to explore this matter. In order to do so, we want to
compare the patterns observed in the models with the results obtained
with diﬀerent atomic data for the objects. We can see in Fig. 1 that
the densities obtained with [O ii] and [Cl iii] lead to similar values
for models with diﬀerent density structures. On the other hand, the
[Ar iv] and [S ii] diagnostics are distributed in diﬀerent ways around
the positions deﬁned by [O ii] and [Cl iii] for diﬀerent structures. We
can use these results to look for combinations of atomic data that
reproduce these diﬀerent patterns in the objects.

Hence, for each set of observational results calculated with one
speciﬁc combination of atomic data, we calculate: the median value
of the diﬀerence log(𝑛e[Cl iii]) − log(𝑛e[O ii]); the median of the
diﬀerence between log(𝑛e[Ar iv]) and the average density of chlo-
rine and oxygen, log(𝑛e[Ar iv]) − (cid:104)log(𝑛e[Cl iii]), log(𝑛e[O ii])(cid:105); and
the median of the diﬀerence between log(𝑛e[S ii]) and the aver-
age density of chlorine and oxygen, log(𝑛e[S ii]) − (cid:104)log(𝑛e[Cl iii]),
log(𝑛e[O ii])(cid:105). These quantities are also calculated for all the model
results based on atomic datasets A or B, including the results with
no ‘observational uncertainties’ along with the results that consider
variations introduced by 3 and 5 per cent uncertainties in the line
ratios. Fig. 5 shows the distributions of diﬀerences obtained for the
objects in the sample using all the combinations of atomic data, with
the vertical lines representing the values obtained for each type of
density structure in the models.

The ﬁrst thing that one might notice in Fig. 5 is that the lines rep-
resenting the median values of the models are all in regions covered

Atomic data and electron density in PNe

5

Figure 1. Diﬀerences between the density obtained from each diagnostic and the average density plotted against the average density for models with diﬀerent
density structures and that have been calculated using atomic datasets A (upper panels) and B (middle panels). The lower panels show the median diﬀerences for
atomic dataset B, calculated for the density ranges shown by the shaded and unshaded regions. The error bars in these lower panels indicate the mean deviations,
and the symbols have been displaced slightly in the horizontal direction to avoid overlapping.

Figure 2. Diﬀerences between the density obtained from each diagnostic and the average density as a function of the average density for the observational
sample. The results are calculated using atomic datasets A (left panels) and B (right panels). The lower panels show the median diﬀerences for the density
intervals deﬁned by the shaded and unshaded areas. The error bars show the mean deviations, and the symbols have been shifted to avoid overlapping.

MNRAS 000, 1–9 (2015)

2.02.53.03.54.04.55.00.60.40.20.00.20.40.6log(ne)  <log(ne)>Set AConstant[S II][O II][Cl III][Ar IV]2.02.53.03.54.04.50.60.40.20.00.20.40.6Set APower law2.02.53.03.54.04.50.60.40.20.00.20.40.6Set ACombined2.02.53.03.54.04.55.00.60.40.20.00.20.40.6log(ne)  <log(ne)>Set BConstant2.02.53.03.54.04.55.00.60.40.20.00.20.40.6Set BPower law2.02.53.03.54.04.50.60.40.20.00.20.40.6Set BCombined2.02.53.03.54.04.55.0<log(ne)> [cm3]0.60.40.20.00.20.40.6median [log ne - <log ne>]Set BConstant2.02.53.03.54.04.55.0<log(ne)> [cm3]0.60.40.20.00.20.40.6Set BPower law2.02.53.03.54.04.55.0<log(ne)> [cm3]0.60.40.20.00.20.40.6Set BCombined2.02.53.03.54.04.55.00.60.40.20.00.20.40.6log(ne)  <log(ne)>Set A[S II][O II][Cl III][Ar IV]2.02.53.03.54.04.55.00.60.40.20.00.20.40.6log(ne)  <log(ne)>Set B2.02.53.03.54.04.55.0<log(ne)> [cm3]0.60.40.20.00.20.40.6median [log(ne)  <log(ne)>]Set A2.02.53.03.54.04.55.0<log(ne)> [cm3]0.60.40.20.00.20.40.6median [log(ne)  <log(ne)>]Set B6

Juan de Dios & Rodríguez

Figure 3. Diﬀerences between the densities obtained from each diagnostic and the average density plotted against the average density for each type of model
calculated with set B. The results are a random selection of a Monte Carlo simulation that propagates errors assuming that the diagnostic line ratios of the
density and temperature diagnostics have uncertainties of 5 per cent. The error bars in the lower panels show the mean deviations of the median diﬀerences, and
the symbols have been shifted to avoid overlapping.

Figure 4. Diﬀerences between the density obtained from each diagnostic and the average density as a function of the average density for models with constant
density structure. The left panels show models computed with atomic dataset B and analysed with set A; the right panels show models computed with atomic
dataset A and analysed with set B. The error bars in the lower panels show the mean deviations of the median diﬀerences, and the symbols have been shifted to
avoid overlapping.

by the histograms of the observational results, which are based on
diﬀerent combinations of atomic data. Note that all regions covered
by the histograms are in principle equally valid: if the model predic-
tions are located at the tail of the distribution, this only means that
a low number of combinations lead to a result similar to that found
in the models, it does not mean that the density structure of these
models is inadequate or unlikely. The question is then if there are
combinations of atomic data that cover the three regions in Fig. 5
deﬁned by each density structure in the models.

In order to answer this question, we consider the median values
of log(𝑛e[Cl iii]) − log(𝑛e[O ii]), shown in the ﬁrst panel of Fig. 5,

and ﬁnd all combinations of atomic data that lead to results in the
range of log(𝑛e[Cl iii]) − log(𝑛e[O ii]) covered by all the median
values associated with each modeled density structure. This includes
the model results calculated with both atomic datasets A and B
(whose range of variation can provide some indication of the eﬀect
of changing the atomic data) and with and without uncertainties
of 3 and 5 per cent in the diagnostic line ratios. The three sets of
combinations are then required to cover the results shown in the
other two panels of Fig. 5. We ﬁnd combinations of atomic data that
satisfy all the restrictions for each type of density structure.

In the case of the power law models, there is a single combination

MNRAS 000, 1–9 (2015)

2.02.53.03.54.04.55.00.60.40.20.00.20.40.6log(ne)  <log(ne)>Set BConstant[S II][O II][Cl III][Ar IV]2.02.53.03.54.04.55.00.60.40.20.00.20.40.6Set BPower law2.02.53.03.54.04.55.00.60.40.20.00.20.40.6Set BCombined2.02.53.03.54.04.55.0<log(ne)> [cm3]0.60.40.20.00.20.40.6median [log(ne)  <log(ne)>]Set BConstant2.02.53.03.54.04.55.0<log(ne)> [cm3]0.60.40.20.00.20.40.6Set BPower law2.02.53.03.54.04.55.0<log(ne)> [cm3]0.60.40.20.00.20.40.6Set BCombined2.02.53.03.54.04.55.00.60.40.20.00.20.40.6log(ne)  <log(ne)>Models: set BAnalysis: set A[S II][O II][Cl III][Ar IV]2.02.53.03.54.04.55.00.60.40.20.00.20.40.6log(ne)  <log(ne)>Models: set AAnalysis: set B2.02.53.03.54.04.55.0<log(ne)> [cm3]0.60.40.20.00.20.40.6median [log(ne)  <log(ne)>]Models: set BAnalysis: set A2.02.53.03.54.04.55.0<log(ne)> [cm3]0.60.40.20.00.20.40.6median [log(ne)  <log(ne)>]Models: set AAnalysis: set BAtomic data and electron density in PNe

7

Figure 5. Distributions of the median values of several diﬀerences between density diagnostics. The histograms show the values obtained for the observational
sample with diﬀerent combinations of atomic data; the vertical lines show the values for models with constant hydrogen density (continuous lines), a power-law
density structure (dashed lines), and combined structures (dotted lines). The diﬀerent vertical lines include the results calculated with atomic datasets A and B
and those calculated assuming uncertainties of 3 per cent in the line ratios (in red, blue, or green in the online version of this ﬁgure) and 5 per cent (in gray).

of transition probabilities and collision strengths for the ions used
to determine electron density that satisfy the diﬀerent criteria. On
the other hand, in the case of the constant density and combined
models, there are several combinations of atomic data that fall into the
regions limited by each type of density structure. We have selected
a combination of atomic datasets from the ﬁltered combinations
and plot the resulting density structures obtained for the objects in
Fig. 6. Table 2 shows the sets of transition probabilities and collision
strengths used for each type of model. We see that the selected
combinations of atomic data roughly reproduce the structure derived
in the models. This is especially noticeable for the atomic data that
lead to density structures similar to the ones implied by the combined
models. Hence, the results of Fig. 5 imply that, given the available
atomic data, none of the density structures explored with the models
can be ruled out.

We note that given one density structure, we can only choose
the combinations of atomic data that lead to a similar structure,
not the individual datasets corresponding to the collision strengths
or transition probabilities of each ion. Besides, each single set of
atomic data is distributed along most of the range covered by the
histograms in Fig. 5, and we cannot reject any set by considering that
it lies outside any of the regions that are covered by the models. This
is specially true for the atomic data used to determine the electron
temperature, since all of these sets are evenly distributed across the
histograms in Fig. 5. Therefore, given the density structures explored
here, no other set of atomic data can be rejected with this analysis.

PNe could have density structures more complex than the ones
we have explored here, arising from all the physical processes that
take place during their formation and evolution. Besides, diﬀerent
objects could have diﬀerent structures. The density structures we are
considering in this work might be too simplistic representations of
the possible structures that can be present in these objects. Still, we
consider them useful for exploring the eﬀects of atomic data. We
have seen that atomic data have a big impact on the results, shaping
the density structures that are derived. Besides, we have shown that
by choosing diﬀerent combinations of the available atomic data we
can obtain in principle any of the density structures studied here.

6 SUMMARY AND CONCLUSIONS

We have explored the density structures of PNe by constructing a
grid of CLOUDY photoionization models that have diﬀerent hydro-
gen density structures: a constant density, a power-law dependence

on the radius, and combined models of diﬀerent constant hydrogen
densities. The results are calculated with two sets of atomic data,
labelled as A and B in Table 1, which are then used to derive the
physical condition of the models using their predicted line intensity
ratios and the same analysis that we use for the observational data.

The observational sample contains 46 PNe with published spec-
tra that have measurements of the lines needed to estimate the
electron density and temperature from the four most used den-
sity diagnostics, [S ii] 𝜆6716/𝜆6731, [O ii] 𝜆3726/𝜆3729, [Cl iii]
𝜆5518/𝜆5538, and [Ar iv] 𝜆4711/𝜆4740, and the two most used
temperature diagnostics, [N ii] 𝜆5755/(𝜆6548 + 𝜆6583) and [O iii]
𝜆4363/(𝜆4959 + 𝜆5007). These spectra are analysed using all possi-
ble combinations of atomic data for these ions.

The atomic datasets used in the calculations have been selected
from those available after rejecting six datasets that lead to dicrepan-
cies. Four of the datasets were rejected in Juan de Dios & Rodríguez
(2017); and we argue that the the transition probabilities of Kisielius
et al. (2014) for [S ii] and Czyzak & Krueger (1963) for [Ar iv],
which are used by default in CLOUDY, should also be rejected. The
data of Kisielius et al. (2014) cannot be used to derive 𝑛e[S ii] in 20
of the 46 PNe in the sample, whereas the data of Czyzak & Krueger
(1963) for [Ar iv] lead to densities which are larger than the ones
implied by the other diagnostics by factors above 3.

As expected, the models analysed with the same atomic dataset
used to calculate the models lead to very similar results for the two
data sets, A and B, for all types of density structures. However, the
density structures obtained for the objects change with the atomic
data and diﬀer from the ones determined for the models with the
same atomic data. If we interchange the atomic data for the analysis
of the models so that the models computed with atomic dataset A
are analysed with set B and vice versa, we ﬁnd a large change in the
density structure derived for the models, which is then similar to the
structure found in the objects when they are analysed with the same
set of data. This illustrates the fact that, even after ﬁltering the most
extreme datasets, the derived density structures vary signiﬁcantly
depending on the atomic data used: diﬀerent combinations of atomic
data lead to very diﬀerent density structures.

We have selected three combinations of atomic data that reproduce
the three density structures explored with the models. The fact that we
have been able to do so indicates that we cannot determine both what
density structures are predominant in PNe and which atomic data
are working better. This degeneracy might be broken by considering
more sophisticated models that try to reproduce a larger number of
characteristics of the objects, like their temperature structure.

MNRAS 000, 1–9 (2015)

0.60.40.20.00.20.40.6log(ne[Cl III])log(ne[O II])0.000.050.100.150.200.250.30NConstantPower lawCombined0.60.40.20.00.20.40.6log(ne[Ar IV])  <log(ne[Cl III]), log(ne[O II])>0.60.40.20.00.20.40.6log(ne[S II])  <log(ne[Cl III]), log(ne[O II])>8

Juan de Dios & Rodríguez

Figure 6. Diﬀerences between the density diagnostics and the average density plotted against the average density for the sampled objects. The results are
calculated with the atomic data presented in Table 2, which have been selected to reproduce the density structures explored with the models. These results can
be compared with those presented in Figs. 1 and 3. The error bars in the lower panels show the mean deviations of the median diﬀerences, and the symbols have
been shifted in the horizontal direction to avoid overlapping.

Table 2. Examples of atomic data that reproduce each type of density structure. The references are deﬁned in Table 1.

Set 1 (constant)

Set 2 (power law)

Set 3 (combined)

Ion

𝐴𝑖 𝑗

Υ𝑖 𝑗

𝐴𝑖 𝑗

Υ𝑖 𝑗

𝐴𝑖 𝑗

N+
FFT04
O+
FFT04
O++
FFT04
S+
VVF96-MZ82a
Cl++
Fal99
Ar3+ MZ82a-KS86

T11
P76-McLB93-v1
AK99
RBS96
M83
RB97

FFT04
FFT04
SZ00-WFD96
RGJ19
RGJ19
RGJ19

HB04
P76-McLB93-v2
SSB14
RBS96
M83
RB97

FFT04
Z82-WFD96
SZ00-WFD96
PKW09
Fal99
MZ82a

Υ𝑖 𝑗

HB04
Kal09
SSB14
RBS96
BZ89
ZBL87

We have performed this analysis using a large sample of atomic
data. New determinations of atomic data could be included in the
future, but this will not change our main result: the density structure
derived for the objects will still depend on the atomic data used in
the analysis.

DATA AVAILABILITY

The data underlying this article will be shared on reasonable re-
quest to the corresponding author. Other datasets were obtained from
sources of public domain stated in the references.

ACKNOWLEDGEMENTS

We thank the anonymous referee for useful comments. We also thank
I. Aretxaga and M. Richer for their useful suggestions. We acknowl-
edge support from Mexican CONACYT grant CB-2014-240562.
LJdD acknowledges support from CONACYT grant 298356.

REFERENCES

Aggarwal K. M., Keenan F. P., 1999, ApJS, 123, 311

MNRAS 000, 1–9 (2015)

Aggarwal K., Keenan F., 2013, Fusion Science and Technology, 63, 3
Bohigas J., Escalante V., Rodríguez M., Dufour R. J., 2015, MNRAS, 447,

817

Butler K., Zeippen C. J., 1989, A&A, 208, 337
Copetti M. V. F., Writzl B. C., 2002, A&A, 382, 282
Czyzak S. J., Krueger T. K., 1963, MNRAS, 126, 177
Delgado Inglada G., Rodríguez M., Mampaso A., Viironen K., 2009, ApJ,

694, 1335

Delgado-Inglada G., Rodríguez M., Peimbert M., Stasińska G., Morisset C.,

2015, MNRAS, 449, 1797

Fang X., Liu X.-W., 2011, MNRAS, 415, 181
Ferland G. J., et al., 2017, Rev. Mex. Astron. Astroﬁs., 53, 385
Fischer C. F., Tachiev G., 2004, At. Data and Nucl. Data Tables, 87, 1
Fritzsche S., Fricke B., Geschke D., Heitmann A., Sienkiewicz J. E., 1999,

ApJ, 518, 994

Galavis M. E., Mendoza C., Zeippen C. J., 1997, A&AS, 123
García-Rojas J., Peña M., Peimbert A., 2009, A&A, 496, 139
García-Rojas J., Peña M., Morisset C., Mesa-Delgado A., Ruiz M. T., 2012,

A&A, 538, A54

García-Rojas J., Delgado-Inglada G., García-Hernández D. A., Dell’Agli F.,
Lugaro M., Karakas A. I., Rodríguez M., 2018, MNRAS, 473, 4476

Hudson C. E., Bell K. L., 2004, MNRAS, 348, 1275
Hyung S., 1994, ApJS, 90, 119
Hyung S., Aller L. H., 1998, PASP, 110, 466
Hyung S., Aller L. H., Lee W.-b., 2001a, PASP, 113, 1559
Hyung S., Aller L. H., Feibelman W. A., Lee W.-B., 2001b, AJ, 122, 954

2.02.53.03.54.04.55.00.60.40.20.00.20.40.6log(ne)  <log(ne)> Set 1 (constant)[S II][O II][Cl III][Ar IV]2.02.53.03.54.04.55.00.60.40.20.00.20.40.6Set 2 (power law)2.02.53.03.54.04.55.00.60.40.20.00.20.40.6Set 3 (combined)2.02.53.03.54.04.55.0<log(ne)> [cm3]0.60.40.20.00.20.40.6median [log(ne)  <log(ne)>] Set 1 (constant)2.02.53.03.54.04.55.0<log(ne)> [cm3]0.60.40.20.00.20.40.6Set 2 (power law)2.02.53.03.54.04.55.0<log(ne)> [cm3]0.60.40.20.00.20.40.6Set 3 (combined)Juan de Dios L., Rodríguez M., 2017, MNRAS, 469, 1036
Kaufman V., Sugar J., 1986, Journal of Physical and Chemical Reference

Data, 15, 321

Keenan F. P., Hibbert A., Ojha P. C., Conlon E. S., 1993, Phys. Scr., 48, 129
Kisielius R., Storey P. J., Ferland G. J., Keenan F. P., 2009, MNRAS, 397,

903

Kisielius R., Kulkarni V. P., Ferland G. J., Bogdanovich P., Lykins M. L.,

2013, The Astrophysical Journal, 780, 76

Kisielius R., Kulkarni V. P., Ferland G. J., Bogdanovich P., Lykins M. L.,

2014, ApJ, 780, 76

Lennon D. J., Burke V. M., 1994, A&AS, 103
Liu X.-W., Storey P. J., Barlow M. J., Danziger I. J., Cohen M., Bryce M.,

2000, MNRAS, 312, 585

Liu X.-W., Luo S.-G., Barlow M. J., Danziger I. J., Storey P. J., 2001, MNRAS,

327, 141

Liu Y., Liu X.-W., Luo S.-G., Barlow M. J., 2004, MNRAS, 353, 1231
Luridiana V., Morisset C., Shaw R. A., 2015, A&A, 573, A42
McLaughlin B. M., Bell K. L., 1993, ApJ, 408, 753
Mendoza C., 1983, in Flower D. R., ed., Proc. IAU Symp. 103 Planetary

Nebulae, p. 143.

Mendoza C., Zeippen C. J., 1982a, MNRAS, 198, 127
Mendoza C., Zeippen C. J., 1982b, MNRAS, 199, 1025
Morisset C., 2013, pyCloudy: Tools to manage astronomical Cloudy pho-

toionization code (ascl:1304.020)

Morisset C., Luridiana V., García-Rojas J., Gómez-Llanos V., Bautista M.,

Mendoza Claudio 2020, Atoms, 8, 66
Nussbaumer H., Rusca C., 1979, A&A, 72, 129
Osterbrock D. E., Ferland G. J., 2006, Astrophysics of Gaseous Nebulae and
Active Galactic Nuclei, second edn. Vol. 1, University Science Brooks

Otsuka M., Tajitsu A., 2013, ApJ, 778, 146
Otsuka M., Hyung S., Lee S.-J., Izumiura H., Tajitsu A., 2009, ApJ, 705, 509
Palay E., Nahar S. N., Pradhan A. K., Eissner W., 2012, MNRAS, 423, L35
Podobedova L. I., Kelleher D. E., Wiese W. L., 2009, Journal of Physical and

Chemical Reference Data, 38, 171

Pottasch S. R., Hyung S., Aller L. H., Beintema D. A., Bernard-Salas J.,

Feibelman W. A., Klöckner H. R., 2003, A&A, 401, 205

Pradhan A. K., 1976, MNRAS, 177, 31
Pradhan A. K., Montenegro M., Nahar S. N., Eissner W., 2006, MNRAS,

366, L6

Ramsbottom C. A., Bell K. L., 1997, At. Data and Nucl. Data Tables, 66, 65
Ramsbottom C. A., Bell K. L., Staﬀord R. P., 1996, At. Data and Nucl. Data

Tables, 63, 57

Ramsbottom C., Bell K., Keenan F., 2001, Atomic Data and Nuclear Data

Tables, 77, 57

Rubin R. H., 1989, The Astrophysical Journal Supp. Ser., 69, 897
Rynkun P., Gaigalas G., Jönsson P., 2019, A&A, 623, A155
Saraph H. E., Seaton M. J., 1970, MNRAS, 148, 367
Sharpee B., Williams R., Baldwin J. A., van Hoof P. A. M., 2003, ApJS, 149,

157

Sossah A. M., Tayal S. S., 2012, ApS, 202, 12
Stanghellini L., Kaler J. B., 1989, ApJ, 343, 811
Storey P. J., Zeippen C. J., 2000, MNRAS, 312, 813
Storey P. J., Sochi T., Badnell N. R., 2014, MNRAS, 441, 3028
Tachiev G., Fischer C., 2001, Canadian Journal of Physics, 79, 955
Tayal S. S., 2007, ApJS, 171, 331
Tayal S. S., 2011, ApJS, 195, 12
Tayal S. S., Zatsarinny O., 2010, ApJS, 188, 32
Tsamis Y. G., Barlow M. J., Liu X. W., Danziger I. J., Storey P. J., 2003,

MNRAS, 345, 186

Verner D. A., Verner E. M., Ferland G. J., 1996, At. Data and Nucl. Data

Tables, 64, 1

Wang W., Liu X.-W., 2007, MNRAS, 381, 669
Wang W., Liu X.-W., Zhang Y., Barlow M. J., 2004, A&A, 427, 873
Wesson R., Liu X. W., 2004, MNRAS, 351, 1026
Wesson R., Liu X.-W., Barlow M. J., 2005, MNRAS, 362, 424
Wiese W. L., Fuhr J. R., Deters T. M., 1996, Journal of Physical and Chemical

Reference Data, Monograph 7, 403
Zeippen C. J., 1982, MNRAS, 198, 111

Atomic data and electron density in PNe

9

Zeippen C. J., Butler K., Le Bourlot J., 1987, A&A, 188, 251

This paper has been typeset from a TEX/LATEX ﬁle prepared by the author.

MNRAS 000, 1–9 (2015)

