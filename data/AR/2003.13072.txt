0
2
0
2

r
a

M
9
2

]
T
S
.
h
t
a
m

[

1
v
2
7
0
3
1
.
3
0
0
2
:
v
i
X
r
a

On the Power of Symmetrized Pearson’s Type Test

under Local Alternatives in Autoregression with

Outliers

M. V. Boldin ∗

Abstract

We consider a stationary linear AR(p) model with observations subject to gross

errors (outliers). The autoregression parameters are unknown as well as the distribution

function G of innovations. The distribution of outliers Π is unknown and arbitrary, their
intensity is γn−1/2 with an unknown γ, n is the sample size. We test the hypothesis
H0 : G = G0 with simmetric G0. We ﬁnd the power of the test under local alternatives
ρn−1/2)G0+ρn−1/2H. Our test is the special symmetrized Pearson’s type
H1n(ρ) : G = (1
test. Namely, ﬁrst of all we estimate the autoregression parameters and then using the

−

residuals from the estimated autoregression we construct a kind of empirical distribution

function (e.d.f.), which is a counterpart of the (inaccessible) e.d.f. of the autoregression

innovations. We obtain a stochastic expansion of this e.d.f. and its symmetrized variant

under H1n(ρ) , which enables us to construct and investigate our symmetrized test of
Pearson’s type for H0. We establish qualitative robustness of this test in terms of uniform

equicontinuity of the limiting power (as functions of γ, ρ and Π) with respect to γ in a

neighborhood of γ = 0.

Key words: autoregression, outliers, residuals, empirical distribution function,

Pearson’s chi-square test, robustness, estimators.

2010 Mathematics Subject Classiﬁcation: Primary 62G10; secondary 62M10,

62G30, 62G35.

∗Moscow State Lomonosov Univ., Dept. of Mech. and Math., Moscow, Russia

e-mail: boldin−m@hotmail.com

1

 
 
 
 
 
 
1 Введение и постановка задачи

В этой работе мы рассматриваем стационарную AR(p) модель с ненулевым средним

vt = β1vt−1 +

· · ·

+ βpvt−p + ν + εt,

Z.

t

∈

(1.1)

– независимые одинаково распределенные случайные величины

В (1.1)

εt}

{

(н.о.р.сл.в.) с неизвестной функцией распределения (ф.р.) G(x); Eε1 = 0, 0 < Eε2

1 <
Rp– вектор неизвестных параметров, таких что корни соот-
∞
ветствующего (1.1) характеристического уравнения по модулю меньше единицы; ν –

; β = (β1, . . . , βp)T

∈

неизвестное среднее, ν

R1.

∈

Эти условия дальше всегда предполагаютя выполненными и особо не оговариваются.

Мы рассматриваем модель (1.1) с выбросами в наблюдениях. А именно, предполага-

ется, что наблюдаются величины

yt = vt + zγn

t ξt,

t = 1

p, . . . , n,

−

где v1−p, . . . , vn – выборка из стационарного решения
н.о.р.сл.в., принимающие значения 1 и 0, причем вероятность единицы γn,

уравнения (1.1);

vt}

{

(1.2)

zγn
t }

{

γn = min(1,

γ
√n

),

γ

≥

0 неизвестно.

Кроме того,

ременные

– н.о.р.сл.в. с произвольным и неизвестным распределением Π. Пе-

ξt}
интерпретируются как выбросы (засорения), γn уровень засорения.

{
ξt}

{

Для γ = 0 мы получаем модель (1.1) без засорений.

Модель (1.2) – локальный вариант хорошо известной модели засорения данных

во временных рядах, см. [8].

В настоящей работе мы рассматриваем гипотезу

H0 : G(x) = G0(x) с известной функцией распределения G0(x).

В качестве альтернативы к H0 берется предположение о том, что

εt}

{

в (1.1) –

н.о.р.сл.в. с ф.р.

An(x) = (1

−

ρn)G0(x) + ρnH(x),

(1.3)

H(x)

−

ф.р., ρn = min(1,

ρ
√n

), ρ

0.

≥

Предположение (1.3) будем понимать как локальную альтернативу к H0 и обозна-

чать H1n(ρ).

2

vt}

{

Мы хотим построить тест типа хи-квадрат Пирсона для проверки H0 иисследовать

асимптотическую мощность этого теста при H1n(ρ). В частности, мы хотим устано-
вить качественную робастность асимпттической локальной мощности.

Для решения этой задачи мы строим оценку ф.р. G(x), она называется остаточной

эмпирической функцией распределения (о.э.ф.р.). Мы получаем стохастическое раз-

ложение о.э.ф.р. при H1n(ρ). Этот результат имеет самостоятельное значение и вот
почему.

В [4] был построен тест для проверки нормальности инноваций в схеме (1.1)–(1.2),

т.е. гипотезы HΦ : G(x)

}
Напомним, кстати, что гипотеза HΦ эквивалентна нормальности самой стационар-

∈ {

Φ(x/θ), θ > 0

, где Φ(x) – стандартная нормальная ф.р.

ной последовательности

. Нормальность инноваций обеспечивает оптимальность

многих процедур оценивания и проверки гипотез в авторегрессии, см., например,

[1],[6]. Поэтому проверка HΦ – содержательная задача. В [4] была построена стати-

стика типа хи-квадрат Пирсона для HΦ в схеме (1.1) –(1.2) и найдено ее распреде-

ление при гипотезе. Необходимый следующий шаг – найти мощность построенного

теста при локальных альтернативах и исследовать устойчивость мощности к выбро-

сам. Настоящая работа – шаг в этом напрвлении, окончательный результат будет

опубликован в отдельной заметке.

Отметим, что недавно в [2],[5] были получены результаты о проверке H0 и HΦ

в схеме (1.1)–(1.2) при ν = 0. Нулевое среднее – существенное предположение. В на-

шей ситуации при неизвестном и, быть может, ненулевом ν, использовать статистики

типа хи квадрат из [2], [5] не удается, т.к. их предельное распределение зависит от
оценок β и ν даже при γ = 0 .

Мы преодолеваем эту трудность в случае симметричной G0(x), строя специальную

симметризованную статистику Пирсона, она является функционалом от симметри-

зованной о.э.ф.р. Асимптотические распределения симметризованных статистик при

H0 и γ = 0 свободны. Кроме того, симметризованный тест Пирсона оказывается ка-

чественно робастным.

Все определения и результаты (основные, это Теоремы 2.1–2.2) представлены в

Разделе 2.

3

2 Основные результаты

2.1 Стохастическое разложение о.э.ф. р.

Относительно альтернативы H1n(ρ) из (1.3) нам потребуется сделать два предполо-
жения. Напомним, при H1n(ρ) ф.р. инноваций есть смесь вида

An(x) = (1

−

ρn)G0(x) + ρnH(x),

H(x)

−

ф.р., ρn = min(1,

ρ
√n

), ρ

0.

≥

Условие (i). Случайные величины с функциями распределения G0(x) и H(x)

имеют нулевые средние и конечные дисперсии.

Условие (ii). Функции распределения G0(x) и H(x) дважды дифференцируемы

с ограниченными вторыми производными.

Перепишем уравнение (1.1) в удобном для дальнейшего рассмотрения виде. Для

этого определим константу µ соотношеним

ν = (1

β1

−

−

. . .

−

βp)µ,

тогда

vt −

µ = β1(vt−1

µ) +

+ βp(vt−p −

· · ·

−

µ) + εt,

Z.

t

∈

Если положить ut := vt −

µ, то

vt = µ + ut,

ut = β1ut−1 +

+ βput−p + εt,

· · ·

Z.

t

∈

(2.1)

Последовательность

в (2.1) – авторегрессионная последовательность с нулевым

ut}

{

средним и конечной дсперсией.
yt}

Построим по наблюдениям

{

Далее Γ, R –любые конечные неотрицательные числа. Пусть ˆµn будет любая после-
довательность, для которой при H1n(ρ) последовательнсть

из (1.2) оценки ненаблюдаемых

.

εt}

{

n1/2(ˆµn −

µ) = OP (1), n

→ ∞

, равномерно по γ

Γ, ρ

R.

≤

≤

(2.2)

Положим

ˆut = yt −

ˆµn,

t = 1, . . . , n.

4

Пусть ˆβn = ( ˆβ1n, . . . , ˆβpn)T будет любая последовательность, для которой при H1n(ρ)
последовательность

n1/2( ˆβn −

β) = OP (1), n

→ ∞

, равномерно по γ

Γ, ρ

R.

≤

≤

(2.3)

Примеров подходящих оценок ˆµn, ˆβn много, широкий класс составляют, например,
аналогично тому, как они строятся по неза-
М-оценки, построенные по

и

yt}

{

ˆut}

{

соренным данным, см., например, [7]. Результаты для М-оценок при альтернативе

H1n(ρ) в схеме (1.1)–(1.2) вполне аналогичны изложенным в Разделе 2.4 [2].
Положим

ˆεt = ˆut −

ˆβ1n ˆut−1

− · · · −

ˆβpn ˆut−p,

t = 1, . . . , n.

(2.4)

Величины

ˆεt}
тотические свойства о.э.ф.р.

{

называются остатками. Наша ближайшая цель – исследовать асимп-

ˆGn(x) = n−1

n

X
t=1

I(ˆεt ≤

x),

x

R1.

∈

Здесь и в дальнейшем I(
Функция ˆGn(x) – аналог гипотетической э.ф.р.

) обозначает индикатор события.

·

Gn(x) = n−1

n

X
t=1

I(εt ≤

x)

ненаблюдаемых величин ε1, . . . , εn.
Легко проверить, что

ˆεt = εt −

( ˆβn −

β)T ˜ut−1

ˆδn(ˆµn −

−

µ) + αtn −

p

X
j=1

( ˆβjn −

βj)zγn

t−jξt−j.

(2.5)

В (2.5)

˜ut−1 := (ut−1, . . . , ut−p)T , αtn := zγn

t ξt −

p

X
j=1

βjzγn

t−jξt−j, ˆδn := 1

ˆβ1

−

. . .

−

−

ˆβp.

В силу 2.5)

ˆGn(x) = n−1

n

X
t=1

I(εt ≤

x+( ˆβn −

β)T ˜ut−1+ ˆδn(ˆµn−

µ)

−

αtn +

p

X
j=1

( ˆβjn−

βj)zγn

t−jξt−j). (2.6)

Пусть τ1 = (τ1, . . . , τp)T

Rp, τ0

∈

∈

R1. Свяжем с ˆGn(x) из (2.6) функцию

Gn(x, τ0, τ1) = n−1

n

X
t=1

I(εt ≤

x + n−1/2τ T

1 ˜ut−1 + n−1/2τ0

αtn +

−

p

X
j=1

n−1/2τjzγn

t−jξt−j).

5

Очевидно, при γ = 0 Gn(x, 0, 0) = Gn(x).
С помощью тех же аргументов, что при доказательстве Теоремы 2.1 в [2] устанавли-

вается следующая Теорема 2.1. В ней и далее

или матрицы.

означает Евклидову норму вектора

| · |

Теорема 2.1. Предположим, что верна альтернатива H1n(ρ). Пусть выполнены
Условия (i) – (ii), и g0(x) есть производная G0(x). Пусть Γ
0

0 and Θ

0, R

≥

≥

≥

будут любые конечные числа. Тогда для любого δ > 0

sup
γ≤Γ,ρ≤R

P(

sup
|τ0|≤Θ,|τ1|≤Θ |

n1/2[Gn(x, τ0, τ1)

Gn(x)]

−

−

g0(x)τ0

−

γ∆(x, Π)

> δ)

|

→

0, n

.

→ ∞

Здесь сдвиг

∆(x, Π) =

p

X
j=0

[EG0(x + βjξ1)

G0(x)], β0 =

1.

−

−

Теорема 2.1 и соотношения (2.2) –(2.3) стандартным образом (см. доказательство

Следствия 2.1 в [2]) влекут

Следствие 2.1. При условиях Теоремы 2.1

sup
γ≤Γ,ρ≤R

P(

|

n1/2[ ˆGn(x)

Gn(x)]

−

g0(x)ˆδnn1/2(ˆµn −

−

µ)

−

γ∆0(x, Π)

> δ)

|

→

0, n

.

→ ∞

В связи с проверкой гипотезы H0 нас особо интересует ситуация, когда ф.р.

G0(x) симметрична относительно нуля. В этом случае будем брать оценкой G(x)

симметризованную оценку

Положим

Пусть

ˆSn(x) :=

ˆGn(x) + 1
−
2

ˆGn(

x)

−

.

∆S(x, Π) :=

∆0(x, Π)

∆0(
−
2

x, Π)

−

.

Sn(x) :=

Gn(x) + 1
−
2

Gn(

x)

−

.

(2.7)

(2.8)

(2.9)

Следствие 2.1 прямо влечет

Следствие 2.2. При условиях Теоремы 2.1 в случае симметричной относительно

нуля G0(x)

sup
γ≤Γ,ρ≤R

P(

|

n1/2[ ˆSn(x)

Sn(x)]

−

−

γ∆S(x, Π)

> δ)

|

→

0, n

.

→ ∞

6

2.2 Тест типа хи-квадрат Пирсона для H0

В этом разделе мы построим тест типа хи-квадрат Пирсона для гипотезы

H0 : G(x) = G0(x), G0(x) известная симметричная относительно нуля ф.р.

Мы найдем асимптотическую мощность этого теста при локальных альтернативах

H1n(ρ).

Будем также предполагать H(x) симметричной относительно нуля. Это предпо-

ложение о симметрии H(x) не обязательно, но позволяет удобно записать ответы в

Теореме 2.2 далее.

Для полуинтервалов

B+

j = (xj−1, xj],

j = 1, . . . , m, m > 1, 0 = x0 < x1 < . . . < xm =

,

∞

:= G0(xj)

пусть p+
j
Если ввести еще симметричные полуинтервалы B−

G0(xj−1) > 0. Тогда при H0 P(ε1
∈
j = (

−

j ) = p+
B+
j .
xj−1], то
xj,

−

−

при H0 P(ε1

B+

j ∪

∈

B−

j ) = 2p+

j

:= p0

j , p0

j > 0.

m

X
j=1

p0
j = 1.

Пусть ˆν+
попавших в B+

j обозначает число остатков (они определены в (2.4)) среди

j , а ˆν−

j обозначает число остатков, попавших в B−

ˆεt, t = 1, . . . , n
}

,

{
j . Пусть

ˆνj = ˆν+

j + ˆν−
j .

Интересующая нас тестовая статистика типа хи-квадрат для H0 имеет вид
(ˆνj −
np0
j

ˆχ2
n =

np0

j )2

m

.

X
j=1

Статистика ˆχ2

n является простым функционалом от ˆSn(x). Действительно,

n[ ˆSn(xj)

−

ˆSn(xj−1)] =

1
2 {

n[ ˆGn(xj)

ˆGn(xj−1)] + n[ ˆGn(

−
j + ˆν−
j )/2) = ˆνj/2.

(ˆν+

xj−1)

−

−

ˆGn(

xj)]

−

=

}

(2.10)

n симметризованной статистикой Пирсона.

Будем называть ˆχ2
Чтобы описать асимптотические свойства ˆχ2
ния. Введем диагональную матрицу

n нам понадобятся некоторые обозначе-

P0 = diag

1, . . . , p0
p0

m}

,

{

7

и вектора

p0 = (p0

1, . . . , p0

m)T ; pH = (pH

1 , . . . , pH

m)T c pH

j = 2(H(xj)

H(xj−1));

−

pA = (pA

1 , . . . , pA

m)T , pA

j = An(xj)

An(xj−1).

−

Нам понадобится еще вектор

δ(Π) = (δ1(Π), . . . , δm(Π))T

с компонентами δj(Π) = 2[∆S(xj, Π)

∆S(xj−1, Π)],

−

сдвиг ∆S(x, Π) определен в (2.8).

Пусть ν+
j . Пусть νj = ν+

j обозначает число
j + ν−
j .

B−

εt, t = 1, . . . , n
}

{

, попавших в B+

j , а ν−

j попавших в

Из определения Sn(x) и νj следует:

n[Sn(xj)

−

Sn(xj−1)] = νj/2.

(2.11)

В силу соотношений (2.10) –(2.11), Следствия 2.2 и определения вектора δ(Π) имеем

при H1n(ρ):

n1/2(

ˆνj
n −

p0
j )

−

n1/2(

νj
n −

j ) = n1/2(
p0

ˆνj
n −

νj
n

) =

2n1/2

{

[ ˆSn(xj)

−

ˆSn(xj−1]

[Sn(xj)

Sn(xj−1]
}

−

−

= γδj(Π) + oP (1), n

.

(2.12)

→ ∞

Здесь и далее oP (1) обозначает величину, сходящуюся к нулю по вероятности равно-
мерно по γ

Γ, ρ

R.

Введем вектора

≤

≤

ˆν = (ˆν1, . . . , ˆνn)T , ν = (ν1, . . . , νn)T .

В силу (2.12) при H1n(ρ) имеем:

n1/2(

n1/2(

ˆν
n −
ν
n −

p0) = n1/2(

ν
n −

p0) + γδ(Π) + oP (1) =

pA) + n1/2(pA

−

p0) + γδ(Π) + oP (1) =

n1/2(

ν
n −

pA) + ρ(pH

−

p0) + γδ(Π) + oP (1), n

.

→ ∞

(2.13)

Напомним еще известный факт относительно слабой сходимости вектора ν (см. [3],

доказательство Теоремы 2.1):

n1/2(

ν
n −

pA)

→

N (0, P0

−

p0(p0)T ), n

.

→ ∞

(2.14)

Слабая сходимость в (2.14) равномерна по ρ

R.

≤

8

Соотношений (2.13) –(2.14) достаточно, чтобы следуя схеме доказательства

Теоремы 2.3 в [3] доказать наше основное утверждение – Теорему 2.2. В ней
Fm−1(x, ˆλ2(ρ, γ, Π)) означает ф.р. нецентрального хи-квадрата с m
боды и параметром нецентральности ˆλ2(ρ, γ, Π).

1 степенями сво-

−

Теорема 2.2. Пусть альтернатива H1n(ρ) верна. Пусть выполнены Условия (i)–
(ii) с симметричными G0 и H. Тогда для любых конечных неотрицательных Γ, R

sup
x∈R1,γ≤Γ,ρ≤R |

P( ˆχ2

n ≤

x)

−

Fm−1(x, ˆλ2(ρ, γ, Π))

0, n

.

→ ∞

| →

Параметр нецентральности равен

ˆλ2(ρ, γ, Π) =

P −1/2
0

[ρ(pH

|

−

p0) + γδ(Π)]

2.

|

В силу Теоремы 2.2 при H0 и γ = 0 предельное распределение нашей тесто-

вой статистики ˆχ2
степенями свободы.

n будет обычное (центральное) распределение хи-квадрат с m

1

−

Для заданного 0 < α < 1 ( α –асимптотический уровень в схеме без засорений),

мы будем отвергать H0, когда

ˆχ2
n > χm−1(1

α),

−

α) – квантиль уровня 1

χm−1(1
свободы. Мощность такого теста равна

−

−

α распределения хи-квадрат с m

(2.15)

1 степенью

−

Wn(ρ, γ, Π) = P ( ˆχ2

n > χm−1(1

α)).

−

В силу Теоремы 2.2 эта мощность сходится при n

к асимптотической мощности

→ ∞

равномерно по γ

Γ, ρ

R

≤

≤

W (ρ, γ, Π) = 1

Fm−1(χm−1(1

−

−

α), ˆλ2(ρ, γ, Π)), W (0, 0, Π) = α.

Используя простое неравенство

Fk(x, λ2
1)

|

−

Fk(x, λ2
2)

2 sup
x∈R1

φ(x)

λ1

|

λ2

,

|

−

| ≤

φ(x) стандартная гауссовская плотность, и определение ˆλ2(γ, Π)), получаем:

sup
Π,ρ≥0 |

W (ρ, γ, Π)

W (ρ, 0, Π)

0,

γ

0.

→

| →

−

(2.16)

Соотношение (2.16) означает асимптотическую качественную робастность теста

(2.15). Такая робастность означает, что H0 для малых γ можно проверять примерно

с асимптотическим уровнем α, и тест будет иметь примерно такую же асимптотиче-

скую мощность при H1n(ρ) c ρ > 0, как в схеме без засорений. И все это независимо
от распределения засорений Π.

9

Список литературы

[1] Anderson T.V. The Statistical Analysis of time series. Wiley and Sons, Inc., New

York, 1971.

[2] Boldin M.V., Petriev M.N. On the Empirical Distribution Function of Residuals in

Autoregression with Outliers and Pearson’s Chi-Square type Tests. Math. Methods

Statist., 2018, v. 27, No. 4, p. 294–311.

[3] Boldin M.V. On the power of Pearson’s test under local alternatives in autoregression

with outliers. Math. Methods Statist., 2019, v. 28, No. 1, p. 57–65.

[4] Boldin M.V. On Symmetrized Pearson’s Type Test in Autoregression with Outliers:

Robust Testing of Normality. http://arxiv.org/abs/2003.07878.

[5] Болдин М.В. О проверке нормальности авторегрессии с засорениями критерием

Пирсона. Теория вероятн. и ее применения, 2020, т. 65, No 1, с. 126–137.

[6] Brockwell P.J. and Daviis R.A. Time Series: Theory and Methods. Springer-Verlag,

1987.

[7] Koul H. L. Weighted Ampiricals and Linear Models. MSU, Hayward, California, 1992.

[8] Martin B.D. and Yohai V.J. Inﬂuence functionals for Time Series. The Ann. of

Statist., 1986, v. 14, p. 781 –818.

10

