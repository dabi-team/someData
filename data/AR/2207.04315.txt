2
2
0
2

l
u
J

9

]
T
S
.
h
t
a
m

[

1
v
5
1
3
4
0
.
7
0
2
2
:
v
i
X
r
a

Testing of symmetry of innovations in autoregression

M. V. Boldin, A. R. Shabakaeva ∗

Abstract

We consider a stationary linear AR(p) model with zero mean. The autoregression

parameters as well as the distribution function (d.f.) G(x) of innovations are unknown.

We consider two situations.

In the ﬁrst situation the observations are a sample from a stationary solution of

AR(p). Interesting and essential problem is to test symmetry of G(x) with respect to zero.

If hypothesis of symmetry is valid then it is possible to construct nonparametric estimators

of AR(p) parameters, for example, GM-estimators, minimum distance estimators and

others.

First of all we estimate unknown parameters of autoregression and ﬁnd residuals.

Based on them we construct a kind of empirical d.f., which is a counterpart of empirical

d.f of the unobservable innovations. Our test statistic is the functional of omega-square

type from this residual empirical d.f. Its asymptotic d.f. under the hypothesis and the

local alternatives are found.

In the second situation the observations subject to gross errors (outliers). The
distribution of outliers is unknown, their intensity is O(n−1/2), n is the sample size. We
test the symmetry of innovations again but by constructing the Pearson’s type statistic.

Its asymptotic d.f. under the hypothesis and the local alternatives are found. We establish

the asymptotic robustness of this test as well.

Key words: autoregression, outliers, residuals, empirical distribution function,

Pearson’s chi-square test, estimators, local alternatives, omega-square test, robustness.

2010 Mathematics Subject Classiﬁcation: Primary 62G10; secondary 62M10,

62G30, 62G35.

∗Moscow State Lomonosov Univ., Dept. of Mech. and Math., Moscow, Russia

e-mail: boldin−m@hotmail.com,

shabakaevalmira@gmail.com

1

 
 
 
 
 
 
1 Введение и постановка задачи

Рассмотрим линейную AR(p) модель

ut = β1ut−1 + · · · + βput−p + εt,

t ∈ Z.

(1.1)

В (1.1) инновации {εt} - независимые одинаково распределенные случайные ве-
личины (н.о.р.сл.в.) с неизвестной функцией распределения (ф.р.) G(x); Eε1 = 0,
1 < ∞; β = (β1, . . . , βp)T – вектор неизвестных параметров, для которых со-
0 < Eε2
ответствующее характеристическое уравнение имеет корни, лежащие в единичном

круге; размерность модели p предполагается известной.

Эти требования считаются выполненными всегда и далее особо не оговариваются.

Мы будем рассматривать две ситуации. В первой наблюдения u1−p, u2−p, . . . , un
суть выборка из стационарного решения (1.1). По этим наблюдениям хотим прове-

рить гипотезу

S : ε1

d= −ε1, т.е. G(x) симметрична относительно нуля.

(1.2)

Для проверки S мы построим тест типа омега-квадрат со статистикой ˆω2
асимптотическое при n → ∞ распределение ˆω2

n, найдем
n при гипотезе и локальных альтерна-
тивах. Чтобы описать эти альтернативы, будем предполагать, что ф.р. G(x) зависит

от числа наблюдений n и представляется смесью симметричной относительно нуля

ф.р. P (x) и несимметричной ф.р. Q(x) :

G(x) = An(x) := (1 − ρn)P (x) + ρnQ(x).

(1.3)

В (1.3) ф.р. P (x) и Q(x) неизвестны, ρn = min {1, ρ n−1/2}, ρ ≥ 0, ρ неизвестно.
Если выполнено (1.3), будем говорить, что верна гипотеза An(ρ). При ρ > 0 An(ρ)
будем понимать как локальную альтернативу к S, ф.р. An(x) при ρ > 0 несимметрич-
на. При ρ = 0, разумеется, An(0) и S совпадают. В в этом случае (т.е. при гтпотезе S)
будем писать P (x) вместо G(x). Асимптотические распределения ˆω2
n будут найдены
при An(ρ) сразу для всех ρ ≥ 0, что позволяет изучить тест одновременно и при
гипотезе, и при локальных альтернативах.

Отметим, что симметрия инноваций – одно из основных предположений, позво-
ляющих строить непараметрические ценки для β. Например, GM−оценки, оценки

минимального расстояния, знаковые и т.д., см. [1]. Кроме того, для симметричной

G(x) можно строить симметризованные оценки G(x) и основывать на них симметри-

зованные тесты для гипотез о виде G(x), см. [2]. Строить такие тесты, как и тесты

2

для S, нетривиальная и содержательная задача, поскольку инновации {εt} ненаблю-
даемы.

Соответствующие первой ситуации результаты представлены в Разделе 2.

Во второй ситуации наблюдения за авторегрессией содержат грубые ошибки. А

именно, наблюдаются

yt = ut + zγn

t ξt, t = 1 − p, . . . , n.

(1.4)

t } – н.о.р. сл.в., распределенные по закону Бернулли, zγn
В (1.4) {zγn
1 ∼ Br(γn),
γn = min{1, γn−1/2}, γ ≥ 0, γ неизвестно; {ξt} – н.о.р. сл.в. с неизвестным и про-
извольным распределением Π; {ut} – выборка из стационарного решения (1.1); по-
следовательности {ut}, {zγn
t }, {ξn} независимы. Последовательность {ξt} интерпрети-
руется как последовательность грубых ошибок (засорений). Схема (1.4) – локальный

вариант известной схемы засорений для временных рядов, см. [3].

Задачей ставится опять проверка гипотезы S из (1.2) по наблюдениям {yt}. Мы
построим тест типа хи-квадрат для S, изучим асимптотическое поведение тестовой
статистики при An(ρ) из (1.3), установим асимптотическую качественную робаст-
ность теста. Эти результаты приведем в Разделе 3.

2 Проверка симметриии в схеме без засорений

Пусть наблюдения u1−p, . . . , un – выборка из стационарного решения уравнения (1.1).
Построим по этим наблюдениям тест для проверки гипотезы S из (1.2).

Пусть ˆβn = ( ˆβ1n, . . . , ˆβpn)T – оценка вектора β, требования к ней уточним далее.

Оценками ненаблюдаемых инноваций ε1, . . . , εn возьмем остатки

ˆεt := ut − ˆβ1nut−1 − · · · − ˆβpnut−p,

t = 1, . . . , n;

оценкой ф.р. G(x) – остаточную эмпирическую ф.р.

ˆGn(x) = n−1

n

Xt=1

I(ˆεt ≤ x), x ∈ R1, I(·) − −индикатор события.

Тестоввой статистикой для S возьмем

ˆω2

n = n

∞

Z

−∞

[ ˆGn(x) + ˆGn(−x) − 1]2d ˆGn(x).

Вычислять ˆω2

n удобно по формуле

ˆω2

n =

n

Xt=1

ˆGn(−ˆε(t)) −
(cid:20)

n − t + 1
n

2

,

(cid:21)

3

где ˆε(1) ≤ · · · ≤ ˆε(n) – упорядоченные остатки.

Статистика ˆω2

n – аналог статистики ω2
можно было бы построить по самим ε1, . . . , εn. А именно,

n для проверки симметрии, см. [4], которую

ω2

n = n

∞

Z

−∞

[Gn(x) + Gn(−x) − 1]2dGn(x),

I(εt ≤ x) – эмпирическая ф.р. ε1, . . . , εn.

где Gn(x) = n−1

n

Pt=1

Пусть v(t), t ∈ [0, 1], – броуновский мост, т.е. гауссовский процесс с нулевым

средним и ковариацией min {t, s} − ts. Для An(ρ) из (1.3) положим

δ(t) := ρ [Q (P −1 (t) ) − t],

где P −1(·) – обратная к P (·) функция. Из результатов [4] следует:
при гипотезе S для непрерывной G(x)

ω2
n

d−−→

1

Z
0

[v(t) + v(1 − t)]2dt, n → ∞,

а при альтернативе An(ρ) с ρ > 0 для непрерывных An(x) и δ(t)

ω2
n

d−−→

1

Z

0

[v(t) + v(1 − t) + δ(t) + δ(1 − t)]2dt, n → ∞.

Нам понадобятся следующие условия.

Условие (i). Ф.р. P (x) и Q(x) имеют нулевые средние и конечные дисперсии.
Условие (ii). Ф.р. P (x) и Q(x) дважды дифференцируемы с ограниченными вто-
рыми производными.
Условие (iii). ˆβn – такая оценка β, что для фиксированного ρ ≥ 0 при An(ρ)

n1/2( ˆβn − β) = OP (1), n → ∞.

(2.1)

Если выполнено Условие (i), то оценка наименьших квадратов ˆβn,LS , построенная
по u1−p, . . . , un, удовлетворяет (2.1), см.[5]. Более того,

1

2 ( ˆβn,LS − β)

n

d−−→ N (0, E(ε0

1)2 K−1), n → ∞.

(2.2)

В (2.2) E(ε0
{u0

1)2 – дисперсия ф.р. P (x), K = (kij), kij = E(u0

t } – стационарное решение (1.1) с инновациями {ε0

0 u0

i−j), i, j = 1, . . . , p,
t }, имеющими ф.р. P (x).

Далее нам понадобится результат из [5]:

4

если выполнены Условия (i) - (iii), то при An(ρ) с любым ρ ≥ 0

|n1/2[ ˆGn(x) − Gn(x)]| = oP (1), n → ∞.

(2.3)

sup
x∈R1

В силу (2.3) асимптотическое распределение ˆω2

n при An(ρ), ρ ≥ 0, совпадает с

асимптотическим распределением ω2

n, т.е. верна

Теорема 2.1. 10. Пусть верна гипотеза S. Пусть для ф.р. P (x) выполнены Условия
(i) – (ii) и Условие (iii) c ρ = 0 для ˆβn. Тогда

ˆω2
n

d−−→

1

Z
0

[v(t) + v(1 − t)]2dt, n → ∞.

20. Пусть при некотором ρ > 0 верна альтернатива An(ρ). Пусть выполнены

Условия (i) - (iii), и фукция δ(t), t ∈ [0, 1], непрерывна. Тогда

ˆω2
n

d−−→

1

Z
0

[v(t) + v(1 − t) + δ(t) + δ(1 − t)]2dt, n → ∞.

Для 0 < α < 1 критическое множество возьмем в виде

ˆω2

n > c1−α,

(2.4)

где c1−α – (1 − α)-квантиль предельной ф.р. ω2
[6]. Асимптотический уровень теста (2.4) равен α.

n. Эта предельная ф.р. табулирована в

Замечание 2.1. При фиксированной альтернативе к гипотезе S ф.р. инноваций
несимметрична относительно нуля. Пусть она, кроме того, имеет нулевое сред-
нее, конечную дисперсию и ограниченную вторую производную. Пусть n1/2( ˆβn−β) =
OP (1), n → ∞.- Тогда статистика ˆω2
n расходится по вероятности к бесконечно-
сти. Это означает, что тест (2.4) состоятелен против такой фиксированной

альтернативы.

Замечание 2.2. Помимо ˆω2

n можно строить аналоги и других статистик, упо-

мянутых в [4]. Например,

ˆDn = sup
x∈R1

|n1/2[ ˆGn(x) − ˆGn(−x) − 1]|.

Асимптотическое распределение ˆDn при An(ρ), ρ ≥ 0, такое же, как у статистики

Dn = sup
x∈R1

|n

1

2 [Gn(x) + Gn(−x) − 1]|.

5

3 Проверка симметрии в схеме с засорениями

Пусть наблюдаются y1−p, . . . , yn, определенные в (1.4). Построим по этим наблюде-
ниям тест для проверки гипотезы S из (1.2).

Прежде всего построим по {yt} оценку ˆβy
R ≥ 0, Γ ≥ 0 – произвольные конечные числа.
Условие (iv). ˆβy
ρ ≤ R, γ ≤ Γ выполнено

n – такая оценка β, для которой при An(ρ) равномерно по

n = ( ˆβy

1n, . . . , ˆβy

pn)T вектора β. Далее

n1/2( ˆβy

n − β) = OP (1), n → ∞.

(3.1)

Если Eε4

1 < ∞, то соотношение (3.1) выполнено, например, для о.н.к. ˆβy

n,LS, по-

скольку

n1/2( ˆβy

n,LS − β)

d−−→ N (−γ K−1 β, E(ε0

1)2K−1), n → ∞,

(3.2)

и сходимость по распределению равномерная по ρ ≤ R, γ ≤ Γ.

Найдем остатки ˆεy

t = yt − ˆβy

1n yt−1 − · · · − ˆβy

pn yt−p,

t = 1, . . . , n,

и построим по ним остаточную эмпирическую ф.р. ˆGy

n(x) = n−1

I(ˆεy

t ≤ x).

n

Pt=1

Справедливо следующее утверждение ( [7], Теорема 2.1, Следствие 2.1):
Если выполнены Условия (i), (ii), (iv), то при An(ρ), ρ ≥ 0, для фиксированного
x ∈ R1

n1/2[ ˆGy

n(x) − Gn(x) ] − γ∆(x, Π) = oP (1), n → ∞,

(3.3)

равномерно по ρ ≤ R, γ ≤ Γ. В (3.3)

p

∆(x, Π) =

[EP (x + βjξ1) − P (x)], β0 = −1.

Xj=0

Разложение (3.3) для ˆGy

n справеливо только при каждом фиксированном x, по-
тому его недостаточно для исследования основанных на ˆGy
n и
ˆDn из Раздела 2. Однако достаточно для построения и исследования статистики типа
хи-квадрат для проверки S. Вот как она строится.

n(x) статистик типа ˆω2

Введем полуинтервалы

B+

j = (xj−1, xj],

j = 1, . . . , m, m ≥ 1,

0 = x0 < x1 < · · · < xm = ∞.

6

Пусть {xj} таковы, что p+
j
ные полуинтервалы B−
p−
j

:= P (−xj−1) − P (−xj) = p+
j ,

j = 1, . . . , m.

:= P (xj) − P (xj−1) > 0. Если ввести симметрич-
j = (−xj, −xj−1], то при гипотезе S для непрерывной P (x)

Пусть ˆν+

j обозначает число остатков среди ˆεy

j –
j . Интересующая нас тестовая статистика для S имеет

n, попавших в B+

1, . . . , ˆεy

j , а ˆν−

число остатков, попавших в B−
вид

ˆχ2

n =

m

Xj=1

(ˆν+

j )2

j − ˆν−
2ˆν+
j

Очевидно,

ˆν+
j
n

= ˆGy

n(xj) − ˆGy

n(xj−1),

ˆν−
j
n

= ˆGy

n(−xj−1) − ˆGn(−xj).

(3.4)

Пусть ν±

j обозначает число инноваций ε1, . . . , εn, попавших в B±

j . Поскольку

ˆχ2

n =

m

Xj=1

{n1/2 (

ˆν+
j
n

−

ˆν−
n

)}2/(2ˆp+

j ), ˆp+

j =

ˆν+
j
n

,

получаем в силу (3.3) и (3.4):

ˆχ2

n =

m

{n1/2 (

Xj=1

ν+
j
n

−

ν−
n

) + δj(Π)}2/(2ˆp+

j ) + oP (1), n → ∞.

(3.5)

δj(Π) := ∆(xj, Π) − ∆(xj−1, Π) − [∆(−xj−1, Π) − ∆(−xj, Π)].

В (3.5) oP (1) обозначает величину, стремящуюся по вероятности к нулю при n → ∞
равномерно по γ ≤ Γ, ρ ≤ R.

Соотношение (3.5) сводит асимптотическое исследование статистики ˆχ2

n к ана-

лизу главного члена в правой части (3.5). Результат дается Теоремой 3.1. В ней

j = Q(xj) − Q(xj−1), q−
q+

j = Q(−xj−1) − Q(−xj), q± = (q±

1 , . . . , q±

m)T ,

δ(Π) = (δ1(Π), . . . , δm(Π))T ,

P– диагональная матрица, P = diag{2p+

1 , . . . , 2p+

m}.

Через Fk(x, λ2) мы обозначаем ф.р. нецентрального хи-квадрат распределения с k
степенями свободы и параметром нецентральности λ2, а через | · | – евклидову норму

вектора.

Теорема 3.1. 10. Пусть верна гипотеза S. Пусть для ф.р. P (x) выполнены Условия
(i) – (ii) и Условие (iv) c ρ = 0 для ˆβy
n. Тогда

sup
x∈R1, γ≤Γ

|P ( ˆχ2

n ≤ x) − Fm(x, λ2)| → 0, n → ∞,

(3.6)

7

где λ2 = γ2 | P − 1

2 δ(Π) |2;

20.Пусть верна альтернатива An(ρ), ρ > 0. Пусть выполнены Условия (i) -

(ii), (iv). Тогда

где

sup
x∈R1, γ≤Γ, ρ≤R

|P ( ˆχ2

n ≤ x) − Fm(x, λ2)| → 0, n → ∞,

λ2 = |P −1/2[ρ(q+ − q−) + γδ(Π)]|2.

Критическое множество для S возьмем в виде

ˆχ2

n > χ1−α(m),

(3.7)

(3.8)

(3.9)

где для 0 < α < 1 χ1−α(m) – (1 − α)-квантиль ф.р. хи-квадрат с m степенями
свободы. В силу (3.9) и Теоремы 3.1 асимптотическая мощность нашего теста есть

W (ρ, γ, Π, P, Q) = 1 − Fm(χ1−α(m), λ2),

где λ2 = λ2(ρ, γ, Π, P, Q) задается формулой (3.8). Известно, что

|Fk(x, λ2

1) − Fk(x, λ2

2)| ≤

2
π

r

|λ1 − λ2|,

(3.10),

так что из (3.8), (3.10) и определения вектора δ(Π) получаем:

|W (ρ, γ, Π, P, Q) − W (ρ, 0, Π, P, Q)| ≤

sup
Π,ρ,Q

2
π

r

γ sup
Π

|P −1/2δ(Π)| → 0, γ → 0.

(3.11)

Соотношение (3.11) качественно означает, что при малых γ равномерно по Π (а также

по ρ и Q) асимптотические мощности в схемах с засорениями и без засорений близки.

Это свойство означает асимптотическую качественную робастность теста.

Сделаем несколько замечаний.

Замечание 3.1. Если γ = ρ = 0, то асимптотическое распределение для ˆχ2
n
есть обычное (центральное) распределение хи-квадрат с m степенями свободы,

W (0, 0, Π, P, Q) = α.

Если же распределение Π симметрично, т.е. ξ1

d= −ξ1, то δ(Π) = 0, и асимп-
тотическая мощность W (ρ, γ, Π, P, Q) вовсе от Π не зависит и совпадает с асимп-

тотической мощностью теста в случае схемы без засорений: для ρ ≥ 0 при сим-

метричном распределении Π и любых γ ≥ 0, ρ ≥ 0

W (ρ, γ, Π, P, Q) = W (ρ, 0, Π, P, Q).

8

Замечание 3.2. Рассмотрим фиксированную альтернативу для S c дополнитель-
ными предположениями как в Замечании 2.1. Если при каком-нибудь j P (ε1 ∈
P−→ ∞, n → ∞. Т.е. тест (3.9) состоятелен против
B+
такой фиксированной альтернативы.

j ) 6= P (ε1 ∈ B−

j ), то ˆχ2
n

Замечание 3.3. Если вместо Условия (iv) потребовать лишь, чтобы выполнялось

(3.1) при фиксированных ρ и γ, то утверждение типа Теоремы 3.1 останется вер-
ным. Надо только в (3.6) и (3.7) заменить супремум по x ∈ R1, ρ ≤ R, γ ≤ Γ на
супремум по x ∈ R1. Например, о.н.к. ˆβy
n,LS удовлетворяет (3.2) (а значит, и (3.1))
при фиксированных ρ и γ при минимальном условии Eξ2

1 < ∞.

Список литературы

[1] Koul H.L. Weighted Empiricals and Linear Models. Michigan State University,

Hayward, 1992.

[2] Boldin M.V. On Symmetrized Pearson’s Type Test in Autoregression with Outliers:

Robust Testing of Normality., https://arxiv.org/abs/2003.07878.

[3] Martin R.D., Yohai V.J. Inﬂuence Functionals for Time Series. Ann. Statist., 1986,

Vol. 14, p. 781-818.

[4] Орлов А.И. О проверке симметриии распределения. Теория вероятностей и её

применения, 1972, т. XVII, в.2, с. 372 - 377.

[5] Boldin M.V. On the Asymptotic Power of Fit under Local Alternatives in

Autoregression, Math. Methods of Statist., 2019, Vol. 28(2), p. 144 - 154.

[6] Мартынов Г.В. Критерии омега-квадарат. Москва, "Наука”, 1978.

[7] Boldin M.V. On the Power of Pearson’s Test under

local Alternatives

in

Autoregression with Outliers. Math. Methods of Statist., 2019, Vol. 28(1), p. 57-65.

9

