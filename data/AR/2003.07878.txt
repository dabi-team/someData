0
2
0
2

r
a

M
7
1

]
T
S
.
h
t
a
m

[

1
v
8
7
8
7
0
.
3
0
0
2
:
v
i
X
r
a

On Symmetrized Pearson’s Type Test in

Autoregression with Outliers: Robust Testing of

Normality

M. V. Boldin ∗

Abstract

We consider a stationary linear AR(p) model with observations subject to gross

errors (outliers). The autoregression parameters are unknown as well as the distribution

and moments of innoovations. The distribution of outliers Π is unknown and arbitrary,
their intensity is γn−1/2 with an unknown γ, n is the sample size. The autoregression
parameters are estimated by any estimator which is n1/2-consistent uniformly in γ
Γ <

≤
. Using the residuals from the estimated autoregression, we construct a kind of

empirical distribution function (e.d.f.), which is a counterpart of the (inaccessible) e.d.f.

∞

of the autoregression innovations. We obtain a stochastic expansion of this e.d.f., which

enables us to construct the symmetrized test of Pearson’s chi-square type for the normality

of distribution of innovations. We establish qualitative robustness of these tests in terms

of uniform equicontinuity of the limiting levels (as functions of γ and Π) with respect to

γ in a neighborhood of γ = 0.

Key words: autoregression, outliers, residuals, empirical distribution function,

Pearson’s chi-square test, robustness, estimators, normality.

2010 Mathematics Subject Classiﬁcation: Primary 62G10; secondary 62M10,

62G30, 62G35.

∗Moscow State Lomonosov Univ., Dept. of Mech. and Math., Moscow, Russia

e-mail: boldin−m@hotmail.com

1

 
 
 
 
 
 
1 Введение и постановка задачи

В линейных и нелинейных регрессионных и авторегрессионных моделях при гауссов-

ских ошибках (инновациях) обычно можно построить оптимальные или асимптоти-

чески оптимальные процедуры оценивания параметров и проверки гипотез относи-

тельно этих парамтров. Удается так же оптимально решать некоторые задачи типа

change-point и разладки. Вот некоторые примеры.

Классические результаты об оценивании и проверке гипотез в линейных AR, MA,

ARMA моделях можно найти в [1], [5]; результаты о GM-процедурах и процедурах
минимального расстояния – в [7] ; об оценивании в AR(1) с коэффициентом из R1
и последовательных оценках максимального правдоподобия – в [9]; результыты для

задачи типа change-point о дрейфе параметров в AR и ARCH моделях – в [3].

В связи со сказанным содержательной является задача проверки гипотезы о

гауссовости инноваций в авторегрессионных моделях. Подобная и родственые за-

дачи проверки гипотез о распределении инноваций критериями типа Колмогорова-

Смирнова, Крамера-Мизеса-Смирнова омега-квадрат, хи-квадрат Пирсона рассмат-

ривались для разных моделей, ссылки можно найти, нпример, в [2], [6].

В этой работе мы рассматриваем стационарную AR(p) модель с ненулевым сред-

ним

В (1.1)

εt}

{

vt = β1vt−1 +

· · ·

+ βpvt−p + ν + εt,

Z,

t

∈

(1.1)

– независимые одинаково распределенные случайные величины

(н.о.р.сл.в.) с неизвестной функцией распределения (ф.р.) G(x); Eε1 = 0, 0 < Eε2

1 <
; β = (β1, . . . , βp)T – вектор неизвестных параметров, таких что корни соответству-
∞
ющего (1.1) характеристического уравнения по модулю меньше единицы; ν – неиз-
вестное среднее (константа из R1).
Эти условия дальше всегда предполагаютя выполненными и особо не оговариваются.

В этой работе мы рассматриваем модель (1.1) с выбросами в наблюдениях. А именно,

предполагается, что наблюдаются величины

yt = vt + zγn

t ξt,

t = 1

p, . . . , n,

−

где v1−p, . . . , vn – выборка из стационарного решения
н.о.р.сл.в., принимающие значения 1 и 0, причем вероятность единицы γn,

уравнения (1.1);

vt}

{

(1.2)

zγn
t }

{

γn = min(1,

γ
√n

),

γ

≥

0 неизвестно.

2

Кроме того,

ременные

– н.о.р.сл.в. с произвольным и неизвестным распределением Π. Пе-

ξt}
интерпретируются как выбросы (засорения), γn уровень засорения.

{
ξt}

{

Для γ = 0 мы получаем модель (1.1) без засорений.

Модель (1.2) – локальный вариант хорошо известной модели засорения данных

во временных рядах, см. [8].

Сформулируем цель настоящей работы. Мы хотим проверить гипотезу о ноор-

мальности инноваций

где Φ(x) – стандартная нормальная ф.р.

HΦ : G(x)

Φ(x/θ), θ > 0

,

}

∈ {

Напомним, кстати, что гипотеза HΦ эквивалентна нормальности самой стацио-

нарной последовательности

itself.

vt}

{

Подобная задача для авторегрессии с нулевым средним (т.е. схемы (1.1) с ν = 0) и

yt}

сначала строилась подходящая равномерно по γ

засорениями в наблюдениях вида (1.2) рассматривалась в [2]. Для такой сиуации в [2]
n1/2-состоятельная
по
оценка вектора β. Затем с ее помощью находились оценки ненаблюдаемых ε1, . . . , εn,
они называются остатками. По ним строилась эмпирическая функция распределе-

Γ <

∞

≤

{

ния остатков (о.э.ф.р.). Наконец, спомощью о.э.ф.р. строилась подходящая стати-

стика типа хи-квадрат Пирсона для HΦ. Эта статистика – функционал о.э.ф.р. ,

это аналог обычной статистики Пирсона, построенной (гипотетически) по ε1, . . . , εn
и предназначенной для проверки нормальности при неизвестной дисперсии. Было

найдено предельное распределение этой статистики при гипотезе. В схеме без засо-

рений при γ = 0 оно такое же, как у классической статистики Пирсона в теореме

Фишера, построенной по ε1, . . . , εn. При γ
ответствующего теста есть α(γ, Π), α(0, Π) = α. Показано, что семейство

0 предельный уровень значимости со-

≥

α(γ, Π)

}

{

равностепенно непрерывно по γ в точке γ = 0, т.е.

α(γ, Π)

sup
Π |

α

−

| →

0,

γ

0.

→

Последнее соотношение означает асимптотическую качествнную робастность теста

относительно засорений.

Недавно в [4] была найдена асимптотическая локальная мощность теста из [2] и уста-

новлена ее качественная робастность.

3

Упомянутые результаты из [2]-[4] получены при ν = 0 и это существенное пред-

положение. В нашей ситуации (1.1) при неизвестном и, быть может, ненулевом ν,

использовать статистику хи квадрат из [2]-[4] не удается, т.к. ее предельное распре-
деление зависит от оценок β и ν даже при γ = 0 .

Мы преодолеваем эту трудность, строя специальную симметризованную статистику

Пирсона, она является функционалом от симметризованной эмпирической функции

распределения остатков. Асимптотические распределения симметризованных стати-

стик при HΦ и γ = 0 свободны. Показано, что асимптотический уровень значимости

нашего теста качественно робастен.

Все определения и результаты (основные, это Теоремы 2.1–2.2) представлены в

Разделе 2.

2 Основные результаты

2.1 Стохастическое разложение о.э. ф. р.

Перепишем уравнение (1.1) в удобном для дальнейшего рассмотрения виде. Для это-

го определим константу µ соотношеним

ν = (1

β1

−

−

. . .

−

βp)µ,

тогда

vt −

µ = β1(vt−1

µ) +

+ βp(vt−p −

· · ·

µ)εt,

−

Z.

t

∈

Если положить ut := vt −

µ, то

vt = µ + ut,

ut = β1ut−1 +

+ βput−p + εt,

· · ·

Z.

t

∈

(2.1)

Последовательность

средним.

ut}

{

в (2.1) – авторегрессионная последовательность с нулевым

Построим по наблюдениям

из (1.2) оценки ненаблюдаемых

в (2.1).

Пусть ˆµn будет любая последовательность, для которой последовательнсть

yt}

{

εt}

{

n1/2(ˆµn −

µ) = OP (1), n

→ ∞

, равномерно по γ

Γ <

.

∞

≤

Положим

ˆut = yt −

ˆµn,

t = 1, . . . , n.

4

Пусть ˆβn = ( ˆβ1n, . . . , ˆβpn)T будет любая последовательность, для которой последова-
тельность

n1/2( ˆβn −

β) = OP (1), n

, равномерно по γ

Γ.

→ ∞
Примеров подходящих оценок ˆµn, ˆβn много, широкий класс составляют, например,
М-оценки. Результаты для них аналогичны изложенным в Разделе 2.4 [2].

≤

Положим

ˆεt = ˆut −

ˆβ1n ˆut−1

− · · · −

ˆβpn ˆut−p,

t = 1, . . . , n,

Наша ближайшая цель – исследовать асимптотические свойства остаточной эмпири-

ческой ф.р.

ˆGn(x) = n−1

n

X
t=1

I(ˆεt ≤

x),

x

R1,

∈

Здесь и в дальнейшем I(
Функция ˆGn(x) – аналог гипотетической э.ф.р.

) обозначает индикатор события.

·

Gn(x) = n−1

n

X
t=1

I(εt ≤

x)

ненаблюдаемых величин ε1, . . . , εn.

Теорема 2.1. Предположим, что ф.р. G(x) дифференцируема с производной (плот-
g′(x)
ностью) g(x). Предположим, что supx |
любое действительное число. Тогда для любого δ > 0

. Пусть Γ

0 будут

0 and Θ

∞

≥

≥

<

|

sup
γ≤Γ

P(

|

n1/2[ ˆGn(x)

Gn(x)]

−

g(x)(1

−

β1

−

. . .

−

βp)n1/2(ˆµn−
µ)
−

γ∆(x, Π)

−

> δ)

|

→

0, n

.

→ ∞

Здесь сдвиг

∆(x, Π) =

p

X
j=0

[EG(x + βjξj)

G(x)], β0 =

1.

−

−

Доказательство Теоремы 2.1 проводится по той же схеме, что доказательство

Теореы 2.1 в [2].

В связи с проверкой гипотезы HΦ нас особо интересует ситуация, когда ф.р. G(x)

симметрична относительно нуля. В этом случае будем брать оценкой G(x) симмет-

ризованную оценку

Положим

ˆSn(x) :=

ˆGn(x) + 1
−
2

ˆGn(

x)

−

.

∆S(x, Π) :=

∆(x, Π)

∆(
−
2

x, Π)

−

.

5

(2.2)

Пусть

Теорема 2.1 влечет

Sn(x) :=

Gn(x) + 1
−
2

Gn(

x)

−

.

Следствие 2.1. При условиях Теоремы 2.1 в случае симметричной относительно

нуля G(x)

sup
γ≤Γ

P(

|

n1/2[ ˆSn(x)

Sn(x)]

−

−

γ∆S(x, Π)

> δ)

|

→

0, n

.

→ ∞

2.2 Тест типа хи-квадрат Пирсона для HΦ

В этом разделе мы построим тест типа хи-квадрат Пирсона для проверки

HΦ : G(x)

Φ(x/θ), θ > 0

,

}

∈ {

где Φ(x) стандартная нормальная ф.р. Как отмечалось во Введении, такая гипотеза

эквивалентна гауссовости стационарного решения (1.1).

Обозначим через θ0 истинное значение θ при HΦ, тогда при HΦ G(x) = Φ(x/θ0).

Для полуинтервалов

B+

j = (xj−1, xj],

j = 1, . . . , m, m > 2, 0 = x0 < x1 < . . . < xm =

,

∞

пусть

При HΦ P(ε1

∈

p+
j (θ) = Φ(xj/θ)

Φ(xj−1/θ).

−

B+

j ) = p+

j (θ0). Если ввести еще симметричные полуинтервалы

B−

j = (

xj,

−

xj−1], то при HΦ

−

P(ε1

B+

j ∪

∈

B−

j ) = 2p+

j (θ0) := pj(θ0).

Пусть ˆν+
j обозначает число остатков среди
обозначает число остатков, попавших в B−

ˆεt, t = 1, . . . , n
}

{
j . Пусть

, попавших в B+

j , а ˆν−

j

Оценкой θ0 мы возьмем n1/2-состоятельное решение уравнения

ˆνj = ˆν+

j + ˆν−
j .

m

X
j=1

ˆνj
pj(θ)

p

′

j(θ) = 0,

6

(2.3)

в котором штрих означает производную относительно θ. Такое уравнение – аналог

обычного уравнения модифицированного метода хи-квадрат, в котором ненаблюда-

емые частоты ν1, . . . , νm инноваций, попавших в B1, . . . , Bm, заменены их оценками
ˆν1, . . . , ˆνm.

Интересующая нас тестовая статистика типа хи-квадрат для HΦ имеет вид

ˆχ2
n =

m

X
j=1

npj(ˆθn))2

(ˆνj −

npj(ˆθn)

.

(2.5)

Статистика ˆχ2

n является простым функционалом от ˆSn(x). Действительно,

n[ ˆSn(xj)

−

ˆSn(xj−1)] =

1
2 {

ˆGn(xj−1)] + n[ ˆGn(

xj−1)

−

−

ˆGn(

xj)]

−

=

}

n[ ˆGn(xj)

−
j + ˆν−

(ˆν+

j )/2) = ˆνj/2.

(2.4)

n симметризованной статистикой Пирсона.

Будем называть ˆχ2
Чтобы описать асимптотические свойства ˆχ2
ния. Введем диагональную матрицу

n нам понадобятся некоторые обозначе-

P (θ) = diag

{

p1(θ), . . . , pm(θ)

}

и вектора

p(θ) = (p1(θ), . . . , pm(θ))T , p′(θ) = (p′

1(θ), . . . , p′

m(θ))T ,

b(θ) = P −1/2(θ)p′(θ), α(θ) = b(θ)/

b(θ)

.

|

|

Здесь и далее

означает евклидову норму вектора или матрицы.

|
Нам понадобится еще вектор

.
|

δ(Π) = (δ1(Π), . . . , δm(Π))T

с компонентами δj(Π) = 2[∆S(xj, Π)

∆S(xj−1, Π)],

−

∆S(x, Π) определена в (2.2), где следует положить G(x) = Φ(x/θ0).

Из определения Sn(x) и νj следует:

В силу соотношений (2.4) –(2.5), Следствия 2.1 и определения вектора δ(Π) имеем

n[Sn(xj)

−

Sn(xj−1)] = νj/2.

(2.5)

при HΦ:

2n1/2

{

[ ˆSn(xj)

−

n1/2(

pj(θ0))

n1/2(

pj(θ0)) = n1/2(

ˆνj
n −
ˆSn(xj−1]

−
[Sn(xj)

−

−

νj
n −
Sn(xj−1]
}

7

ˆνj
n −

νj
n

) =

= γδj(Π) + oP (1), n

.

(2.6)

→ ∞

Здесь oP (1) обозначает величину, сходящуюся к нулю по вероятности равномерно по
γ

Γ.

≤

Введем вектора

ˆν = (ˆν1, . . . , ˆνn)T , ν = (ν1, . . . , νn)T .

В силу (2.6) при HΦ

n1/2(

ˆν
n −

p(θ0)) = n1/2(

ν
n −

p(θ0)) + γδ(Π) + oP (1), n

.

→ ∞

(2.7)

Напомним еще общеизвестный факт относительно слабой сходимости вектора ν:

n1/2(

ν
n −

p(θ0))

→

N (0, P (θ0)

−

p(θ0)p(θ0)T ), n

.

→ ∞

(2.8)

Соотношений (2.7) –(2.8) достаточно, чтобы следуя схеме доказательства Теоремы
2.3 в [2] доказать наше основное утверждение – Теорему 2.2. В ней Em означает
единичную матрицу порядка m.

Теорема 2.2. Пусть HΦ верна. Тогда для любого конечного 0

Γ <

≤

∞

sup
x∈R1,γ≤Γ |

P( ˆχ2

n ≤

x)

−

Fm−2(x, ˆλ2(γ, Π))

0, n

.

→ ∞

| →

Параметр нецентральности равен

ˆλ2(γ, Π) = γ2

(Em −

|

α(θ0)α(θ0)T )P −1/2(θ0)δ(Π)

2.

|

Мы будем отвергать HΦ, когда

ˆχ2
n > χm−2(1

α),

−

(2.9)

χm−2(1
−
свободы.

α) – квантиль уровня 1

−

α распределения хи-квадрат с m

2 степенями

−

В силу Теоремы 2.2 уровень такого теста сходится при n

к асимптотическому уровню

→ ∞

равномерно по γ

Γ

≤

ˆα(γ, Π) = 1

−

Fm−2(χm−2(1

−

α), ˆλ2(γ, Π)),

ˆα(0, Π) = α.

Легко проверить, что

ˆα(γ, Π)

sup
Π |

α

−

| →

0,

γ

0.

→

(2.10)

Соотношение (2.10) означает асимптотическую качественную робастность теста (2.9).

Такая робастность означает, что HΦ для малых γ можно проверять примерно с асимп-

тотическим уровнем α независимо от распределения засорений Π.

8

Список литературы

[1] Anderson T.V. The Statistical Analysis of time series. Wiley and Sons, Inc., New

York, 1971.

[2] Boldin M.V., Petriev M.N. On the Empirical Distribution Function of Residuals in

Autoregression with Outliers and Pearson’s Chi-Square type Tests. Math. Methods

Statist., 2019, v. 27, No. 4, p. 1–17.

[3] Boldin M.V., Erlikh I. Testing hypotheses on the drift of parameters in ARMA and

ARCH models. Math. Methods Statist., 2009, v. 18, No. 3, p. 1–20.

[4] Болдин М.В. О проверке нормальности авторегрессии с засорениями критерием

Пирсона. Теория вероятн. и ее применения, 2020, т. 65, No 1, с. 126–137.

[5] Brockwell P.J. and Daviis R.A. Time Series: Theory and Methods. Springer-Verlag,

1987.

[6] Boldin M.V., Simonova G.I., Tyurin Yu.N. Sign-based Methods in Linear Statistical

Models. AMS, Providence, 1997.

[7] Koul H. L. Weighted Ampiricals and Linear Models. MSU, Hayward, California, 1992.

[8] Martin B.D. and Yohai V.J. Inﬂuence functionals for Time Series. The Ann. of

Statist., 1986, v. 14, p. 781 –818.

[9] Shiryaev A.N. and Spokoiny V.G. Statistical Experiments and Decisions. World

Scientiﬃc Publishing Co Pte. Ltd., 2000.

9

