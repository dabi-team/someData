1
2
0
2

v
o
N
6
2

]

M
E
.
n
o
c
e
[

1
v
4
7
7
3
1
.
1
1
1
2
:
v
i
X
r
a

Robust Permutation Tests in Linear Instrumental

Variables Regression∗

Purevdorj Tuvaandorj†

York University

This draft: November 30, 2021

Abstract

This paper develops permutation versions of identiﬁcation-robust tests in linear instrumental

variables (IV) regression. Unlike the existing randomization and rank-based tests in which inde-

pendence between the instruments and the error terms is assumed, the permutation Anderson-

Rubin (AR), Lagrange Multiplier (LM) and Conditional Likelihood Ratio (CLR) tests are asymp-

totically similar and robust to conditional heteroskedasticity under standard exclusion restriction

i.e. the orthogonality between the instruments and the error terms. Moreover, when the instru-

ments are independent of the structural error term, the permutation AR tests are exact, hence

robust to heavy tails. As such, these tests share the strengths of the rank-based tests and the

wild bootstrap AR tests. Numerical illustrations corroborate the theoretical results.

Keywords: Anderson-Rubin statistic, Asymptotic validity, Conditional likelihood ratio statis-

tic, Exact test, Heteroskedasticity, Identiﬁcation, Lagrange Multiplier statistic, Permuta-

tion test, Randomization test

1

Introduction

This paper proposes randomization (permutation) test versions of heteroskedasticity-robust Ander-

son and Rubin (1949)’s AR, Kleibergen (2002)’s LM and Andrews and Guggenberger (2019a)’s

∗First version: January 25, 2020; Second version: December 14, 2020.

I thank Dmitry Arkhangelsky, Xavier

D’Haultfœuille, Antoine Djogbenou, Hiroyuki Kasahara, Uros Petronijevic and the participants of the Econometric

Society European Winter Meeting 2019, and the 37th Canadian Econometrics Study Group (CESG) Meeting 2021

for helpful comments.

I gratefully acknowledge ﬁnancial support from the LA&PS Minor Research Grant, York

University. All errors are my own.

†tpujee@yorku.ca

1

 
 
 
 
 
 
CLR tests in IV regression. These tests are asymptotically similar (in a uniform sense) and

heteroskedasticity-robust under the usual exogeneity condition i.e.

the orthogonality (or uncor-

relatedness) between the error terms and the instruments. When the latter assumption is replaced

by independence of the instruments and the error term in the structural equation, the permutation

AR tests become exact hence robust to heavy tails.

Permutation inference is attractive because of its exactness when relevant assumptions hold. It

also bears a natural connection to IV methods since IVs provide an exogenous variation independent

of the unobserved confounders for the endogenous regressor in the IV regression and the permutation

inference typically seeks to exploit independence of two sets of variables by permuting the elements

of one variable holding the other ﬁxed to replicate the distribution of a test statistic at hand.

Despite the link, the literature on randomization inference in IV models is scarce.

Imbens

and Rosenbaum (2005) develop exact permutation tests in the IV model where the instruments are

assigned randomly.1 Their test statistic takes the form of an inner product between the instruments

(or transformations thereof e.g. ranks) and the structural error terms evaluated under the null

hypothesis. Exact permutation tests are obtained by permuting the former while holding the latter

ﬁxed. Given the advantage of the permutation method in an IV setting as shown by Imbens and

Rosenbaum (2005), we broaden its scope by proposing the permutation versions of the commonly

used identiﬁcation-robust AR, LM and CLR test statistics.

Recently, DiCiccio and Romano (2017) propose permutation tests for correlation between a

pair of random vectors and regression coeﬃcients. DiCiccio and Romano (2017) show that using an

appropriate studentization argument, one can obtain tests that are asymptotically pivotal under the

assumption of zero correlation between the two random variables instead of the usual independence

assumption. The results are then generalized to heteroskedastic linear regression where the error

term is conditionally mean-independent of the regressors.

We extend the result of DiCiccio and Romano (2017) to the IV setting and propose two per-

mutation AR (PAR) statistics, denoted as PAR1 and PAR2 respectively. The PAR1 statistic is

based on permuting the rows of instrument matrix that shifts endogenous regressors, and the PAR2

statistic is based on permuting the null-restricted residuals in the structural equation. We establish

the ﬁnite sample validity of the permutation AR tests under an independence assumption akin to

the one used in Andrews and Marmer (2008). We then show their asymptotic validity under the

1This leads to what is referred to as the design-based approach by Abadie et al. (2020) who make an explicit

distinction between design-based and sampling-based uncertainties and propose robust standard errors to account for

each uncertainty in a regression model.

2

usual exogeneity condition allowing for conditional heteroskedasticity. Thus, our result diﬀers from

that of Imbens and Rosenbaum (2005) who maintain the independence between the error terms and

the instruments and do not deal with heteroskedasticity.

In addition, we consider permutation LM (PLM) and CLR (PCLR) statistics. Following Freed-

man and Lane (1983), we permute the residuals from the ﬁrst-stage estimation of the reduced-form

equation and generate a permutation right-hand side endogenous variables. Based on the latter

and the permuted null-restricted residuals in the structural equation, the permutation LM statistic

is then constructed.

In the PCLR tests, we condition on the nuisance parameter estimates and

permute the null-restricted residuals of the structural equation only as in the PAR2 test to generate

the conditional permutation distribution.

We compare the robust permutation tests to both the identiﬁcation-robust rank-based tests

of Andrews and Marmer (2008) and Andrews and Soares (2007), and the wild bootstrap tests of

Davidson and MacKinnon (2012) through simulations.

In terms of the control of type I error,

we ﬁnd that the robust permutation tests outperform the rank-based tests under the standard

exclusion restriction, and perform on par with or have an edge over the wild bootstrap tests in the

heteroskedastic designs considered.

As a main technical contribution, we show the uniform asymptotic similarity of the proposed

permutation tests which, to our best knowledge, has not been shown before in the context of

bootstrap and randomization inference in the IV model.

In doing so, we adapt the results of

Andrews and Guggenberger (2017a,b, 2019a,b) and Andrews et al. (2020) in a nontrivial way.

Discussion of the related literature

The literature on linear IV model is vast. Earlier surveys on this topic are provided by Stock et al.

(2002), Dufour (2003), and Andrews and Stock (2007), and recent contributions include Moreira

and Moreira (2019), Young (2020) and the survey of Andrews et al. (2019).

Andrews and Marmer (2008) develop a rank-based AR statistic under the independence assump-

tion between the instruments and the structural error term. Under their assumption, the PAR1

test proposed here is exact while the PAR2 test is so when there are no included non-constant

exogenous variables. Andrews and Soares (2007) consider a rank-version of the CLR statistic of

Moreira (2003). The latter test employs asymptotic critical value after conditioning on a rank-based

nuisance parameter estimate and is robust to heavy-tailed errors but not to heteroskedasticity.

A strand of literature that focuses on bootstrap inference in the linear IV model include, among

others, Davidson and MacKinnon (2008), Moreira et al. (2009), and Davidson and MacKinnon

3

(2012) where they document an improved performance of bootstrap inference over asymptotic in-

ference. The results of this paper complement these studies.

The key for our results is the fact that the identiﬁcation-robust PAR, PLM and PCLR statistics

are studentized. The use of studentization to obtain an improved test is not new; a well-known exam-

ple is the higher-order accuracy of the bootstrap-t conﬁdence interval, as opposed to the percentile

bootstrap, in the one-sample problem, see, for instance, Chapter 15.5 of Lehmann and Romano

(2005). So and Shin (1999) develop a persistence-robust test for autoregressive models based on a

Cauchy estimator and a studentized statistic. In the context of permutation tests, Neuhaus (1993)

proposes a studentized permutation statistic in a two-sample problem with randomly censored

data. For further extensions and applications of permutation tests based on studentized statistic,

see Janssen (1997), Neubert and Brunner (2007), Pauly (2011) and Chung and Romano (2013,

2016).

For several recent papers that consider randomization inference, see Chernozhukov et al. (2009)

for ﬁnite sample inference in quantile regression with and without endogeneity, Canay et al. (2017)

for randomization inference under approximate symmetry condition with applications to diﬀerences-

in-diﬀerence and regression models with clustered errors, Canay and Kamat (2018) and Ganong and

J¨ager (2018) for permutation tests in regression discontinuity and kink designs, respectively, and

Dufour et al. (2019) for permutation tests for inequality measures.

The paper is organized as follows. Section 2 introduces the model and the identiﬁcation-robust

test statistics and develops the permutation tests. Simulation results comparing the performance of

alternative test procedures are provided in Section 3. Section 4 presents two empirical applications.

Section 5 brieﬂy concludes. The proofs are collected in Appendix A.

2 Robust permutation tests

2.1 Model setup

We develop permutation-based tests for a restriction on the d × 1 vector of structural coeﬃcients

in the linear IV regression model:

H0 : θ = θ0,

y = Y θ + Xγ + u,

Y = W Γ + XΨ + V,

4

(2.1)

(2.2)

where y = [y1, . . . , yn](cid:48) is n × 1 vector of endogenous variables, Y = [Y1, . . . , Yn](cid:48) is n × d matrix
of right-hand side endogenous variables, X = [X1, . . . , Xn](cid:48) is n × p matrix of right-hand side
exogenous variables whose ﬁrst column is the n × 1 vector of ones ι = [1, . . . , 1](cid:48), W = [W1, . . . , Wn](cid:48)

is n × k (k ≥ d) matrix of instrumental variables that does not include ι and the exogenous

variables in X, u = [u1, . . . , un](cid:48) is n × 1 vector of structural error terms, V = [V1, . . . , Vn](cid:48) with
Vi = [Vi1, . . . , Vid](cid:48), is n × d matrix of reduced-form error terms; γ is p × 1 parameter vector, and Γ

and Ψ are k × d and p × d matrices of reduced-form coeﬃcients, respectively.

Let Xi = [Xi1, . . . , Xip](cid:48), Wi = [Wi1, . . . , Wik](cid:48), Yi = [Yi1, . . . , Yid](cid:48) and Z = [Z1, . . . , Zn](cid:48) ≡
MX W , where MA ≡ In − PA ≡ In − A(A(cid:48)A)−1A(cid:48) for a matrix A of full column rank. Rewrite the

equations (2.1)-(2.2) as

y = Y θ + Xγ + u,

Y = ZΓ + Xξ + V,

(2.3)

(2.4)

where ξ ≡ (X (cid:48)X)−1X (cid:48)W Γ + Ψ . Let Y = [Y, 1, . . . , Y, d], where Y, s = [Y1s, . . . , Yns](cid:48) denotes the s-th
column of Y , s = 1, . . . , d. Deﬁne ˜ui(θ) ≡ yi − Y (cid:48)
i(X (cid:48)X)−1X (cid:48)(y − Y θ), ˜u(θ) = MX (y − Y θ) =
[˜u1(θ), . . . , ˜un(θ)](cid:48), ˜Y = [ ˜Y1, . . . , ˜Yn](cid:48) ≡ MX Y , and

i θ − X (cid:48)

ˆm(θ) ≡ n−1Z(cid:48) ˜u(θ) = n−1Z(cid:48)(y − Y θ),

ˆGs(θ) ≡ n−1Z(cid:48)Y, s, ˆCs(θ) ≡ n−1

n
(cid:88)

i=1

ZiZ(cid:48)
i

˜Yis ˜ui(θ),

ˆΣ(θ) ≡ n−1

n
(cid:88)

i=1

ZiZ(cid:48)

i ˜ui(θ)2, ˆJ(θ) = [ ˆJ1(θ), . . . , ˆJd(θ)],

ˆJs(θ) ≡ ˆGs(θ) − ˆCs(θ) ˆΣ(θ)−1 ˆm(θ), s = 1, . . . , d,

(2.5)

(2.6)

(2.7)

(2.8)

where ˜Yis is the s-th element of ˜Yi. The heteroskedasticity-robust AR and Kleibergen (2002)’s LM

statistics are

LM = LM(Z, ˜u(θ0), Y ) ≡ n ˆm(θ0)(cid:48) ˆΣ(θ0)−1 ˆJ(θ0)

AR = AR(W, X, ˜u(θ0)) ≡ n ˆm(θ0)(cid:48) ˆΣ(θ0)−1 ˆm(θ0),
(cid:17)−1

(cid:16) ˆJ(θ0)(cid:48) ˆΣ(θ0)−1 ˆJ(θ0)

ˆJ(θ0)(cid:48) ˆΣ(θ0)−1 ˆm(θ0).

(2.9)

The LM statistic may also be deﬁned as

LM ≡ (y − Y θ0)(cid:48)Z ˜Γ

˜Γ (cid:48)

(cid:32)

n
(cid:88)

i=1

(cid:33)−1

ZiZ(cid:48)

i ˜ui(θ0)2 ˜Γ

˜Γ (cid:48)Z(cid:48)(y − Y θ0),

(2.10)

5

where ˜Γ = [˜Γ1, . . . , ˜Γd] with ˜Γs ≡ (Z(cid:48)Z)−1Z(cid:48)Y, s − (Z(cid:48)Z)−1 ˆCs(θ0) ˆΣ(θ0)−1Z(cid:48)(y − Y θ0), s = 1, . . . , d.

In this paper, we focus on the statistic in (2.9). Finally, we consider the CLR-type statistics. Deﬁne

ˆS ≡ ˆΣ(θ0)−1/2n1/2 ˆm(θ0) ∈ Rk,

T ( ˆΣ(θ0), ˆJ(θ0), ˜V) ≡ ˆΣ(θ0)−1/2n1/2 ˆJ(θ0)

(cid:16)

(θ0, Id)Ω(cid:15)( ˆΣ(θ0), ˜V)−1(θ0, Id)(cid:48)(cid:17)1/2

∈ Rk×d,

(2.11)

(2.12)

where Ω(cid:15)(·, ·) ∈ R(d+1)×(d+1) is an eigenvalue-adjusted version of the matrix deﬁned as

Ω( ˆΣ(θ), ˜V) = {Ωij}1≤i,j≤d+1 ∈ R(d+1)×(d+1), Ωij ≡ tr(Kij( ˜V)(cid:48) ˆΣ(θ)−1)/k ∈ R, 2

(2.13)

and the k × k matrix Kij( ˜V) is the (i, j) submatrix of K( ˜V) given by


K( ˜V) ≡ (B(θ0)(cid:48) ⊗ Ik) ˜V (B(θ0) ⊗ Ik) ∈ Rk(d+1)×k(d+1), B(θ) ≡




 ∈ R(d+1)×(d+1).

1

01×d

−θ −Id

The CLR-type statistics proposed by Andrews and Guggenberger (2019a,b) are

CLRa = CLR( ˆS, ˆTa) ≡ ˆS (cid:48) ˆS − λmin

CLRb = CLR( ˆS, ˆTb) ≡ ˆS (cid:48) ˆS − λmin

(cid:105)
(cid:104)
( ˆS, ˆTa)(cid:48)( ˆS, ˆTa)
(cid:105)

( ˆS, ˆTb)(cid:48)( ˆS, ˆTb)

(cid:104)

,

,

where λmin(·) denotes the smallest eigenvalue of a matrix, and

ˆTa = T ( ˆΣ(θ0), ˆJ(θ0), ˆVa(θ0)), ˆVa(θ) ≡

ˆC(θ) ≡ [ ˆC1(θ), . . . , ˆCd(θ)] ∈ Rk×kd,





ˆΣ(θ)
ˆC(θ)(cid:48)


 ∈ Rk(d+1)×k(d+1),

ˆC(θ)
ˆΣG

(2.14)

(2.15)

(2.16)

(2.17)

ˆΣG = { ˆΣG

st}1≤s,t≤d ∈ Rkd×kd, ˆΣG

st ≡ n−1

n
(cid:88)

i=1

ZiZ(cid:48)
i

˜Yis ˜Yit − (n−1

n
(cid:88)

i=1

Zi ˜Yis)(n−1

n
(cid:88)

i=1

Zi ˜Yit)(cid:48) ∈ Rk×k,

ˆTb = T ( ˆΣ(θ0), ˆJ(θ0), ˆVb(θ0)),

ˆVb(θ) ≡ n−1

n
(cid:88)

(cid:2)(εi(θ) − ˆεin(θ))(εi(θ) − ˆεin(θ))(cid:48)(cid:3) ⊗ (ZiZ(cid:48)

i) ∈ Rk(d+1)×k(d+1),

(cid:104)

i=1
˜ui(θ), − ˜Y (cid:48)
i

(cid:105)(cid:48)

εi(θ) ≡

∈ Rd+1, ˜Y = [ ˜Y1, . . . , ˜Yn](cid:48) = MX Y ∈ Rn×d,

ˆεin(θ) ≡ ε(θ)(cid:48)Z(Z(cid:48)Z)−1Zi ∈ Rd+1, ε(θ) ≡ [ε1(θ), . . . , εn(θ)](cid:48) ∈ Rn×(d+1).

(2.18)

(2.19)

(2.20)

The CLRa and CLRb statistics are denoted as QLR and QLRP , respectively, in Andrews and
Guggenberger (2019b), and diﬀer only in their deﬁnitions of ˆVa(θ0) and ˆVb(θ0). Andrews and

2The eigenvalue-adjustment of Andrews and Guggenberger (2019b) is as follows. Let A be a nonzero positive

6

Guggenberger (2019b) show that the CLRb statistic is asymptotically equivalent to Moreira (2003)’s

CLR statistic in the homoskedastic linear IV regression with ﬁxed instruments and multiple endoge-

nous variables under all strengths of identiﬁcation while the CLRa statistic has the same property

under only certain strengths of identiﬁcation but its general version is more broadly applicable.

2.2 Main results

We begin by recalling the basic notion of randomization tests from Chapter 15.2 of Lehmann and

Romano (2005). Let Gn be the set of all permutations π = [π(1), . . . , π(n)] of {1, . . . , n}, and denote
a permutation version of a generic test statistic R by PR = Rπ. The corresponding permutation

distribution function is

ˆF PR

n (x) ≡

(cid:88)

1(Rπ ≤ x),

1
n!

π∈Gn
(1) ≤ · · · ≤ Rπ

where 1(·) is the indicator function. Let Rπ

(n!) be the order statistics of {Rπ : π ∈ Gn},

and for a nominal signiﬁcance level α ∈ (0, 1), deﬁne

r ≡ n! − I(n!α),

N + ≡ |{j = 1, . . . , n! : Rπ

N 0 ≡ |{j = 1, . . . , n! : Rπ

(j) > Rπ
(j) = Rπ

(r)}|,

(r)}|,

aPR ≡ (n!α − N +)/N 0,

(2.21)

(2.22)

where I(·) denotes the integer part of a number. Clearly, N + and N 0 are the number of values

Rπ

(j), j = 1, . . . , n!, that are greater than Rπ

(r) and equal to Rπ

(r), respectively. A randomization test

is then deﬁned as

φPR
n ≡


1




0

if R > Rπ

(r),

aPR if R = Rπ

(r),

if R < Rπ

(r).

(2.23)

The robust permutation test statistics are described below. Let Wπ = [Wπ(1), . . . , Wπ(n)](cid:48) and
˜uπ(θ) = [˜uπ(1)(θ), . . . , ˜uπ(n)(θ)](cid:48) be an instrument matrix and a residual vector obtained by per-

muting the rows of W and the elements of ˜u(θ), respectively, for a uniformly chosen permutation

semi-deﬁnite matrix of dimension p × p that has a spectral decomposition A = N ∆N (cid:48), where ∆ = diag(λ1, . . . , λp),

λ1 ≥ · · · ≥ λp ≥ 0, is the diagonal matrix that consists of the eigenvalues of A, and N is an orthogonal matrix of the

corresponding eigenvectors. Given a constant (cid:15) > 0, the eigenvalue adjusted matrix is deﬁned as A(cid:15) ≡ N ∆(cid:15)N (cid:48), where

∆(cid:15) ≡ diag(max{λ1, λ1(cid:15)}, . . . , max{λp, λ1(cid:15)}). Andrews and Guggenberger (2019a) recommend (cid:15) = 0.01. We refer to

Andrews and Guggenberger (2019a) for further properties of the eigenvalue-adjustment procedure.

7

π ∈ Gn. Set

˜Σu(θ) ≡ diag(˜u1(θ)2, . . . , ˜un(θ)2), ˆmπ(θ) ≡ n−1Z(cid:48) ˜uπ(θ), ˆΣπ(θ) ≡ n−1

n
(cid:88)

i=1

ZiZ(cid:48)

i ˜uπ(i)(θ)2.

We consider two heteroskedasticity-robust permutation AR statistics deﬁned as:

PAR1 ≡ AR(Wπ, X, ˜u(θ0)) = ˜u(θ0)(cid:48)MX Wπ(W (cid:48)

πMX ˜Σu(θ0)MX Wπ)−1W (cid:48)

πMX ˜u(θ0),

PAR2 ≡ AR(W, X, ˜uπ(θ0)) = n ˆmπ(θ0)(cid:48) ˆΣπ(θ0)−1 ˆmπ(θ0).

(2.24)

(2.25)

The PAR1 statistic is based on the permutation of the rows of the instrument matrix W , and the

PAR2 statistic uses the permutation of the null-restricted residuals ˜u(θ0). The ﬁnite sample validity

of these tests are shown under the following condition.

Assumption 1. {(W (cid:48)

i , X (cid:48)

i, ui)(cid:48)}n

i=1 are i.i.d., and Wi and [X (cid:48)

i, ui](cid:48) are independently distributed.

Andrews and Marmer (2008) develop exact rank-based AR tests under assumptions similar to

Assumption 1. When W is independent of X and u, W (cid:48)MX ˜u(θ0) and W (cid:48)

πMX ˜u(θ0) have the same

distribution under H0 : θ = θ0, so the PAR1 test is exact. On the other hand, the PAR2 test is
not, in general, exact because W (cid:48)MX ˜u(θ0) and W (cid:48)MX ˜uπ(θ0) may not have identical distributions.
However, when X = ι in Assumption 1, Z and uπ are independent, Z(cid:48) ˜u(θ0) and Z(cid:48) ˜uπ(θ0) are

identically distributed, and consequently, the PAR2 test is exact. The following result summarizes

the ﬁnite sample validity of the PAR tests.

Proposition 2.1 (Finite sample validity). Under Assumption 1 and H0 : θ = θ0, E[φPAR1
α ∈ (0, 1). If X = ι in Assumption 1, then E[φPAR2

] = α.

n

n

] = α for

Even if [X (cid:48)

i, ui](cid:48) and Wi are not distributed independently but satisfy the orthogonality condi-
i)(cid:48)ui] = 0, we show that the permutation AR tests are asymptotically similar and

tion E[(W (cid:48)

i , X (cid:48)
heteroskedasticity-robust.

The argument for permutation LM statistic is more involved because it is diﬃcult to construct an

estimator of the reduced-form coeﬃcients Γ whose (asymptotic) distribution remains invariant to a

permutation of the data. The OLS estimators of the reduced-form coeﬃcients and the corresponding

residuals are

ˆΓ = (Z(cid:48)Z)−1Z(cid:48)Y,

ˆξ = (X (cid:48)X)−1X (cid:48)Y,

ˆV = Y − Z ˆΓ − X ˆξ = [ ˆV1, . . . , ˆVn](cid:48) = [ ˆV, 1, . . . , ˆV, d],

where ˆV, s = [ ˆV1s, . . . , ˆVns](cid:48) is the s-th column of ˆV , s = 1, . . . , d. Now permute the residuals
ˆVπ = [ ˆV (cid:48)

π(1), . . . , ˆV (cid:48)

π(n)](cid:48), and let

Y π = [Y π

, 1, . . . , Y π

, d] ≡ Z ˆΓ + X ˆξ + ˆVπ,

8

where Y π

, s = [Y π

ns](cid:48) denotes the s-th column of Y π. The idea of permuting the residuals to
obtain asymptotically valid randomization tests appears in Freedman and Lane (1983) and DiCiccio

1s, . . . , Y π

and Romano (2017).

One may also permute the null restricted residuals ˜V = Y − Z ˜Γ − X ˜ξ = [ ˜V1, . . . , ˜Vn](cid:48), where
˜Γ and ˜ξ are the restricted estimators of the reduced form parameters given θ = θ0, and obtain
Y π = [Y π

, d] = Z ˜Γ + X ˜ξ + ˜Vπ, where ˜Vπ = [ ˜V (cid:48)
π(n)](cid:48).
The Jacobian estimator used in the permutation LM statistic is

π(1), . . . , ˜V (cid:48)

, 1, . . . , Y π

ˆJ π(θ) = [ ˆJ π

1 (θ), . . . , ˆJ π
, s − ˆCπ

d (θ)],
s (θ) ˆΣπ(θ)−1 ˆmπ(θ),

ˆJ π
s (θ) ≡ n−1Z(cid:48)Y π

ˆCπ

s (θ) ≡ n−1

n
(cid:88)

i=1

ZiZ(cid:48)
i

ˆVπ(i)s ˜uπ(i)(θ),

s = 1, . . . , d.

(2.26)

(2.27)

(2.28)

It is not diﬃcult to see that in strongly identiﬁed models where Γ is a ﬁxed matrix of full rank,
ˆJ π(θ0) − n−1Z(cid:48)ZΓ

pπ
−→ denotes the convergence in probability with

pπ
−→ 0 in probability, where

respect to the probability measure induced by the random permutation π uniformly distributed

over Gn. The permutation LM statistic is then deﬁned as

PLM ≡ LM(Z, ˜uπ(θ0), Y π) = n ˆmπ(θ0)(cid:48) ˆΣπ(θ0)−1/2P ˆΣπ(θ0)−1/2 ˆJ π(θ0)

ˆΣπ(θ0)−1/2 ˆmπ(θ0).

(2.29)

The permutation LM statistic that corresponds to (2.10) may be deﬁned as

PLM ≡ ˜uπ(θ0)(cid:48)Z ˜Γ π

˜Γ π(cid:48)

(cid:32)

n
(cid:88)

i=1

(cid:33)−1

ZiZ(cid:48)

i ˜uπ(i)(θ0)2 ˜Γ π

˜Γ π(cid:48)Z(cid:48) ˜uπ(θ0),

where ˜Γ π = [˜Γ π

1 , . . . , ˜Γ π

d ] with ˜Γ π

s ≡ (Z(cid:48)Z)−1Z(cid:48)Y π

, s − (Z(cid:48)Z)−1 ˆCπ

s (θ0) ˆΣπ(θ0)−1Z(cid:48) ˜uπ(θ0), s = 1, . . . , d.

Finally, we deﬁne the permutation CLR statistics as follows:

PCLRa ≡ CLR( ˆS π, ˆTa) = ˆS π(cid:48) ˆS π − λmin

PCLRb ≡ CLR( ˆS π, ˆTb) = ˆS π(cid:48) ˆS π − λmin

(cid:104)

where ˆTa and ˆTb are as deﬁned in (2.17) and (2.19), and

(cid:104)

(cid:105)
( ˆS π, ˆTa)(cid:48)( ˆS π, ˆTa)
(cid:105)
( ˆS π, ˆTb)(cid:48)( ˆS π, ˆTb)

,

,

(2.30)

(2.31)

ˆS π ≡ n1/2 ˆΣπ(θ0)−1/2 ˆmπ(θ0) =

(cid:33)−1/2

ZiZ(cid:48)

i ˜uπ(i)(θ0)2

Z(cid:48) ˜uπ(θ0).

(2.32)

(cid:32) n
(cid:88)

i=1

(x, ˆT ) ≡ (n!)−1 (cid:80)

1(CLR( ˆS π, ˆT ) ≤ x) denote the permutation distribution of the
Let ˆF PCLR
n
statistic PCLR = CLR( ˆS π, ˆT ) ∈ {PCLRa, PCLRb} given ˆT ∈ { ˆTa, ˆTb}, respectively. The nominal

π∈Gn

level α PCLR test rejects when

CLR( ˆS, ˆT ) > PCLR(r)( ˆT ),

(2.33)

9

where PCLR(r)( ˆT ) is the r-th order statistic of {CLR( ˆS π, ˆT ) : π ∈ Gn} for r deﬁned in (2.21), and
randomizes when CLR( ˆS, ˆT ) = PCLR(r)( ˆT ).

Let P denote the distribution of the vector (W (cid:48)

i , X (cid:48)

i, ui, V (cid:48)

i )(cid:48) and we shall index the relevant

quantities by P in the sequel. Deﬁne



ei ≡ [ui, V (cid:48)

i ](cid:48), Σe

P ≡ VarP [ei] =

Z∗
i ≡ Wi − EP [WiX (cid:48)

i](EP [XiX (cid:48)

i])−1Xi ∈ Rk,



σ2
P ΣuV
P
ΣV
P

ΣV u
P


 ∈ R(d+1)×(d+1),

(2.34)

VP,a ≡ VarP





Z∗

i ui
i Γ + V (cid:48)
i (Z∗(cid:48)

i ))

vec(Z∗





 =



ΣP CP
P ΣG
P

C(cid:48)


 ∈ Rk(d+1)×k(d+1), ΣP ≡ EP [Z∗

i Z∗(cid:48)

i u2

i ] ∈ Rk×k,

CP = [CP 1, . . . , CP d] ∈ Rk×kd, CP s ≡ EP [Z∗

i Z∗(cid:48)

i ui(Z∗(cid:48)

i Γs + Vis)] ∈ Rk×k, s = 1, . . . , d,

ΣG

P = {ΣG

P,st}, ΣG

P,st ≡ EP [Z∗

i Z∗(cid:48)

i (Z∗(cid:48)

i Γs + Vis)(Z∗(cid:48)

i Γt + Vit)] − EP [Z∗

i Z∗(cid:48)

i Γs] EP [ZiZ∗(cid:48)

i Γt](cid:48),

s, t = 1, . . . , d,

with Γs denoting the s-th column of Γ , and

VP,b ≡ EP









u2
i

−uiVi


 ⊗ (Z∗

i Z∗(cid:48)
i )


 ∈ Rk(d+1)×k(d+1).

−uiV (cid:48)
i
ViV (cid:48)
i

(2.35)

(2.36)

We maintain the following assumptions to develop the asymptotic results.

Assumption 2. For some δ, δ1 > 0 and M0 < ∞,

(a) {(W (cid:48)

i , X (cid:48)

i, ui, V (cid:48)

i )(cid:48)}n

i=1 are i.i.d. with distribution P ,

(b) EP [ui(W (cid:48)

i , X (cid:48)

i)] = 0,

(c) EP [(cid:107)(W (cid:48)

i , X (cid:48)

i, ui)(cid:48)(cid:107)4+δ] < M0,

(d) λmin(A) ≥ δ1 for A ∈ (cid:8) EP [(W (cid:48)

i , X (cid:48)

i)(cid:48)(W (cid:48)

i , X (cid:48)

i)], EP [Z∗

i Z∗(cid:48)

i ], ΣP , σ2

P },

(e) EP [Vi(W (cid:48)

i , X (cid:48)

i)] = 0,

(f) EP [(cid:107)Vi(cid:107)4+δ] < M0,

(g) λmin(A) ≥ δ1 for A ∈ (cid:8)ΣV

P − ΣV u

P (σ2

P )−1ΣuV

P , VP,a}.

10

Next we deﬁne the parameter space for the permutation tests.

P PAR1
0

= P PAR2
0

≡ {P : Assumption 2(a)-(d) hold},

P PLM
0

P PCLR
0

≡ {P : Assumption 2 holds},

≡ {P : Assumption 2(a)-(f) hold}, PCLR ∈ {PCLRa, PCLRb}.

(2.37)

(2.38)

(2.39)

The distribution P in Assumption 2(a) is allowed to vary with the sample size i.e. P = Pn. For

simplicity, we suppress the dependence on n. Assumption 2(c) and (f) impose ﬁnite 4 + δ moment

on the error terms and the exogenous variables, and are slightly stronger than the cross moment

restrictions used in Andrews and Guggenberger (2019a). For pointwise asymptotic results or when

P does not vary with n, weaker restrictions would be suﬃcient.

The independence assumption between the instruments and the error terms, which is typically

made in the randomization test literature (see, for example, Imbens and Rosenbaum (2005)), is not

maintained here; the instruments are only assumed to satisfy the standard exogeneity conditions

in Assumption 2(b) and (e). If independence assumptions are maintained, as shown in Proposition

2.1, the PAR tests are exact and do not require the ﬁnite 4 + δ moment assumptions.

Assumption 2(d) and (g) require that the second moment matrix of the instruments and ex-

ogenous covariates, and covariance matrices are (uniformly) nonsingular, and are similar to the as-

sumptions employed by Andrews and Guggenberger (2017a, 2019a) and Andrews et al. (2020) when

developing identiﬁcation-robust (but not singularity-robust) AR, LM and CLR tests. The condition

λmin(VP,a) ≥ δ1 in Assumption 2(g) plays an important role for showing the asymptotic similarity
of the LM test, and it can be substituted by the condition λmin(EP [(eie(cid:48)
Section 3.2 of Andrews and Guggenberger (2017a). The condition λmin(ΣV

i )]) ≥ δ1, see
P )−1ΣuV

i) ⊗ (Z∗
P − ΣV u

i Z∗(cid:48)
P (σ2

P ) ≥ δ1

is used in the asymptotic distribution of the PLM statistic.

The main result of this paper is given in the following theorem which establishes the asymptotic

validity of the robust permutation tests.

Theorem 2.2 (Asymptotic similarity). Let H0 : θ = θ0 hold. Then, for α ∈ (0, 1) and the

permutation statistics

PR ∈ {PAR1, PAR2, PLM, PCLRa, PCLRb}

with the corresponding parameter spaces P0 ∈ {P PAR1

0

, P PAR2
0

, P PLM
0

, P PCLRa
0

, P PCLRb
0

}, respec-

tively,

lim sup
n→∞

sup
P ∈P0

EP [φPR

n ] = lim inf
n→∞

inf
P ∈P0

EP [φPR

n ] = α.

11

Theorem 2.2 shows the asymptotic validity of the permutation tests. Thus, the advantage of

the PAR1 and PAR2 tests relative to the existing tests is that they inherit the desirable properties

of both the exact and asymptotic AR tests (including other simulation-based tests that are asymp-

totically valid); the PAR tests are exact under the same assumptions as the rank-based tests are,

and asymptotically pivotal and heteroskedasticity-robust under the assumptions used to show the

validity of the asymptotic tests.

The main technical tools for the asymptotics of the permutation statistics are the Hoeﬀding’s

combinatorial CLT (Hoeﬀding (1951), Motoo (1956) and Lemma A.1 in Appendix A) and a variance

formula (the equation (10) of Hoeﬀding (1951) and Lemma S.3.4 of DiCiccio and Romano (2017))

for the sums

n−1/2

n
(cid:88)

i=1

Zi ˜uπ(i)(θ0), n−1/2

n
(cid:88)

i=1

Zi ˆVπ(i)s, s = 1, . . . , d.

The proof of asymptotic similarity of the permutation tests uses the generic method of Andrews et al.

(2020) for establishing the asymptotic size of tests; in particular, the derivation of the asymptotic

distribution of the PCLR statistics relies extensively on Theorems 9.1 and 16.6 of Andrews and

Guggenberger (2019a,b).

Next, we shall derive the asymptotic distribution of the permutation statistics under the local

alternatives θn = θ0 +hθn−1/2 with hθ ∈ Rd ﬁxed, assuming strong identiﬁcation. Let χ2
l (η2) denote
noncentral chi-square random variable with degrees of freedom l and noncentrality parameter η2.

Proposition 2.3 (Local asymptotic power under strong identiﬁcation). Let Assumption 2 hold,

P GP ((θ0, Id)Ω(cid:15)(ΣP , VP )−1(θ0, Id)(cid:48))1/2, where GP ≡ EP [Z∗

and assume that the model is strongly or semi-strongly identiﬁed in the sense that the smallest
singular value τdn of Σ−1/2
i Z∗(cid:48)
{VP,a, VP,b}, satisﬁes n1/2τdn → ∞. Then, under H1 : θn = θ0 + hθn−1/2, AR d−→ χ2
d(η2), CLRa
χ2
and Σ = limn→∞ ΣP , and

i ]Γ and VP ∈
k(η2), LM d−→
θG(cid:48)Σ−1Ghθ, G = limn→∞ GP

d(η2), where η2 ≡ limn→∞ h(cid:48)

d(η2) and CLRb

d−→ χ2

d−→ χ2

| ˆF PAR1
n

(x) − P [χ2

k ≤ x]|

p

−→ 0,

| ˆF PAR2
n

(x) − P [χ2

k ≤ x]|

p

−→ 0,

| ˆF PLM
n

(x) − P [χ2

d ≤ x]|

p

−→ 0,

| ˆF PCLRa

n

(x, ˆTa) − P [χ2

d ≤ x]|

p

−→ 0,

| ˆF PCLRb
n

(x, ˆTb) − P [χ2

d ≤ x]|

p

−→ 0.

sup
x∈R

sup
x∈R

sup
x∈R

sup
x∈R

sup
x∈R

12

(2.40)

(2.41)

(2.42)

(2.43)

(2.44)

It follows that the asymptotic local power of the PAR tests is equal to that of the asymptotic

AR test given by P [χ2

k random variable.
Moreover, under strong identiﬁcation, the PLM and PCLR tests, and the asymptotic LM and CLR

k) is the 1 − α quantile of χ2

k)], where r1−α(χ2

k(η2) > r1−α(χ2

tests have the same asymptotic local power equal to P [χ2

d(η2) > r1−α(χ2

d)].

3 Simulations

This section presents a simulation evidence on the performance of the proposed permutation tests.

The data were generated according to

yi = Yiθ + γ1 + X (cid:48)

2iγ2 + ui,

Yi = W (cid:48)

i Γ + ψ1 + X (cid:48)

2iΨ2 + Vi,

i = 1, . . . , n,

where θ = 0, d = 1, Γ = (1, . . . , 1)(cid:48)(cid:112)λ/(nk) (k × 1) and λ ∈ {0.1, 4, 20}, X2i is (p − 1) × 1
vector of non-constant included exogenous variables with p ∈ {1, 5}, and Vi = ρui + (cid:112)1 − ρ2(cid:15)i
with ρ = 0.5. The parameters γ1, γ2, ψ1, and Ψ2 are set equal to 0. As speciﬁed below, Wi has

zero mean and unit covariance matrix except for the ﬁrst part of simulations in Section 3.1, hence

λ = nΓ (cid:48) E[WiW (cid:48)

i ]Γ ≈ Γ (cid:48)W (cid:48)W Γ . We consider the values λ ∈ {0.1, 4, 20} which correspond to very

weak, weak and strong identiﬁcation. The tested restriction is H0 : θ = θ0 = 0.

We implement the heteroskedasticity-robust asymptotic tests denoted as AR, LM, CLRa, CLRb,

their permutation versions PAR1, PAR2, PLM, PCLRa, PCLRb, the normal score and Wilcoxon

score rank-based AR tests of Andrews and Marmer (2008) denoted as RARn and RARw, respec-

tively, the normal score and Wilcoxon score rank-based CLR statistics of Andrews and Soares (2007)

denoted as RCLRn and RCLRw, respectively, and the wild bootstrap AR and LM tests of David-

son and MacKinnon (2012) denoted as WAR and WLM, respectively. For both the asymptotic and

permutation CLR-type tests, we do not make the eigenvalue-adjustment (i.e. (cid:15) = 0 in footnote 2).

In all simulations, the rejection probabilities of the tests (including CLR, PCLR, the rank-based

and the wild bootstrap tests considered below) are computed using 2000 replications with 999

simulated samples for each replication. We consider the following three cases in turn.

3.1 Heavy tails

To examine the ﬁnite sample validity, we consider heavy-tailed observations where each element of

the random vector (W (cid:48)

i , X (cid:48)

2i, ui, (cid:15)i)(cid:48) is drawn independently from standard Cauchy distribution, and

set k ∈ {5, 10} n ∈ {50, 100}, and λ = 4.

13

Table 1 presents the null rejection probabilities. The asymptotic tests all underreject. The PAR1

test has nearly correct levels as predicted by Theorem 2.1 in all cases, and the PAR2 test, which is

exact only when p = 1, has more accurate rejection rates in the case p = 1 than in the case p = 5.

The RARn, RARw, RCLRn and RCLRw tests are all robust against heavy-tailed errors when the

IV’s, the exogenous covariates and the error terms are independent as stated in Assumption 2.1.

The RARn and RARw tests are exact and this is borne out in the simulation results. The RCLRn

and RCLRw tests slightly underreject which may be attributed to their asymptotic nature.

Note, however, that, under the independence assumption and heavy-tailed errors, the rank-based

tests have better power properties than the asymptotic tests, see Andrews and Soares (2007) and

Andrews and Marmer (2008). In such cases, the permutation tests are likely to be dominated by the

rank-based tests in terms of power given the local asymptotic equivalence between the permutation

tests and the asymptotic tests under strong identiﬁcation established in Proposition 2.3.

3.2 Independence vs. standard exclusion restriction

The next set of simulations examines the role of studentization for obtaining valid permutation

tests and highlights the diﬀerence between the independence and the standard exclusion restriction

assumption in homoskedastic setting. Two cases are considered:

1. (W (cid:48)

i , X (cid:48)

2i, ui, (cid:15)i)(cid:48) ∼ t5[0, Ik+p+1], where t5[0, Ik+p+1] stands for (k + p + 1)-variate t-distribution
with degrees of freedom 5 and covariance matrix Ik+p+1. Under this setting, these random
2i)(cid:48) satisﬁes the standard exclusion restriction
i , X (cid:48)

variables have ﬁnite fourth moments, and (W (cid:48)

in Assumption 2: E[(ui, V (cid:48)

i )(cid:48)(W (cid:48)

i , X (cid:48)

i)] = 0 but (ui, (cid:15)i)(cid:48) and (W (cid:48)

i , X (cid:48)

i)(cid:48) are dependent;3

2i, ui, (cid:15)i)(cid:48) ∼ N [0, Ik+p+1]. Clearly, in this case the instruments and the error terms are

2. (W (cid:48)

i , X (cid:48)
independent.

In addition to the previous tests, for the just-identiﬁed design with k = 1, we additionally consider

a non-studentized randomization test, labelled as PNS, that rejects when W (cid:48) ˜u(θ0), ˜u(θ0) = Mι(y −
Y θ0), is below 0.25 or above 0.975 quantiles of the permutation distribution of W (cid:48) ˜uπ(θ0).

Table 2 reports the empirical level of the tests in the case with k = 1 across diﬀerent sample sizes.

When the error terms and the instruments satisfy the exogeneity condition but are dependent, the

PNS test overrejects; somewhat unexpectedly, the overrejection becomes more severe as the sample

size grows. The rank-type tests also show some size distortions and it does not improve as the sample

3Because the distribution is ﬁxed i.e. does not vary with the sample size, the permutation tests remain asymptot-

ically valid under the ﬁnite fourth moment assumption.

14

size increases. The right panel of Table 2 shows that when the instruments and the error terms

are independent, the empirical level of the asymptotic, permutation and the rank-based CLR-type

tests are close to the nominal signiﬁcance level.

The result for the overidentiﬁed models with n = 100 and k = 5 is reported in Table 3. The

permutation tests perform better than the asymptotic tests regardless of whether the instruments

and the error terms are independent or not. The rank-based tests, displayed in the bottom part of

Table 3, have nearly correct level in the independent case but overreject in the dependent case.

3.3 Conditional heteroskedasticity

The next part of the simulations considers designs with conditional heteroskedasticity. The data

are generated according to (2.1) and (2.2) with

ui = Wi1υi,

Vi = ρui +

(cid:112)

1 − ρ2(cid:15)i,

where Wi1 is the ﬁrst element of Wi, and similarly to the previous case

1. (W (cid:48)

i , X (cid:48)

2i, υi, (cid:15)i)(cid:48) ∼ t5[0, Ik+p+1];

2. (W (cid:48)

i , X (cid:48)

2i, υi, (cid:15)i)(cid:48) ∼ N [0, Ik+p+1].

The sample size and the number of instruments are n = 100 and k ∈ {2, 5, 10}. The results are

displayed in Table 4-6. The asymptotic AR test tends to underreject and performs poorly compared

to the LM statistic. The permutation tests perform better than their asymptotic counterparts in

most cases, and on par with the wild bootstrap in the independent case. However, when the

instruments satisfy the standard exogeneity condition, and there are included exogenous variables,

the permutation tests appear to have an edge over the wild bootstrap AR test which overrejects.

Qualitatively, the same observations made in the homoskedastic case for the rank-based tests are

also observed in the heteroskedastic case as the rank-based tests reject by a substantial margin in

the dependent case.

4 Empirical applications

4.1 Becker and Woessmann (2010)

Becker and Woessmann (2010) study the eﬀect of Protestantism on education before the Indus-

trialization using using counties and towns-level data from 1816 Prussia. To unravel the direction

15

Table 1: Null rejection probabilities at 5% level. Cauchy distributed IV’s, controls and error terms.

λ = 4

n = 50

n = 100

p = 1

p = 5

p = 1

p = 5

k = 5

k = 10

k = 5

k = 10

k = 5

k = 10

k = 5

k = 10

AR

LM

CLRa

CLRb

PAR1

PAR2

RARn

RARw

RCLRn

RCLRw

0.95

2.35

1.45

2.10

4.40

4.40

4.25

4.10

3.15

2.35

0.55

4.25

1.70

3.60

5.30

5.45

4.55

4.85

3.75

3.25

0.85

2.05

1.15

1.60

4.70

3.40

4.10

4.30

4.20

3.35

0.25

3.10

0.75

2.60

5.60

3.50

4.15

4.55

5.10

4.25

0.50

2.10

0.75

1.75

4.05

3.95

5.10

5.15

4.55

3.50

1.05

4.45

1.95

3.85

4.95

4.75

4.05

3.95

3.50

2.80

0.25

1.85

0.55

1.25

4.45

3.25

4.90

4.55

3.85

3.25

0.40

3.45

1.30

3.25

4.70

3.05

3.75

3.60

4.00

3.45

Note: AR, LM, and CLR are the heteroskedasticity-robust asymptotic tests, PAR1 and PAR2 denote the robust

permutation AR tests, RARn and RARw denote the normal score and Wilcoxon score rank-based AR tests of Andrews

and Marmer (2008), and RCLRn and RCLRw denote the normal score and Wilcoxon score rank-based CLR statistics

of Andrews and Soares (2007) respectively. The number of replications is 2000, and the number of permutation

samples for each replication is N = 999.

16

Table 2: Null rejection probabilities at 5% level. Just-identiﬁed model with k = p = 1.

λ = 4

t5[0, Ik+p+1]

N [0, Ik+p+1]

n

AR

LM

CLRa

CLRb

PAR1

PAR2

PLM

PCLRa

PCLRb

50

100

200

400

50

100

200

400

3.75

3.75

3.55

3.55

4.50

4.25

4.25

4.25

4.60

5.00

5.00

4.75

4.75

5.05

5.40

5.40

5.40

5.40

4.55

4.55

4.75

4.75

4.75

4.90

4.90

4.90

4.90

4.25

4.25

4.30

4.30

4.40

4.30

4.30

4.30

4.30

4.60

5.50

4.85

5.80

4.60

5.50

4.85

5.80

4.55

5.50

4.70

5.65

4.55

5.50

4.70

5.65

4.75

5.70

5.05

5.85

4.75

5.65

4.90

5.90

4.75

5.65

4.90

5.90

4.75

5.65

4.90

5.90

4.75

5.65

4.90

5.90

RARn

10.35

11.15

12.35

12.00

4.90

5.45

4.90

6.05

RARw

RCLRn

RCLRw

WAR

WLM

7.65

8.10

7.10

4.65

4.65

9.30

9.65

8.95

6.00

6.00

8.70

8.35

4.60

5.35

4.85

5.65

11.40

11.65

3.45

4.45

4.25

5.50

8.65

8.10

4.55

5.20

5.05

5.75

5.35

5.35

4.80

4.80

4.40

5.45

4.85

5.60

4.40

5.45

4.85

5.60

PNS

15.30

16.90

17.80

19.40

5.20

6.00

5.55

6.20

Note: In the left panel, (W (cid:48)

orthogonal but dependent. In the right panel, (W (cid:48)

i , ui, (cid:15)i)(cid:48) ∼ t5[0, Ik+p+1] and the single instrument Wi and the structural error term ui are
i , ui, (cid:15)i)(cid:48) ∼ N [0, Ik+p+1] and Wi and ui are independent. PLM and

PCLR denote the robust permutation LM and CLR tests, WAR and WLM are the wild bootstrap AR and LM tests

of Davidson and MacKinnon (2012), PNS denotes the non-studentized permutation test, and the remaining tests are

as in Table 1.

17

Table 3: Null rejection probabilities at 5% level. Over-identiﬁed homoskedastic model with k = 5,

n = 100.

λ = 0.1

λ = 4

λ = 20

n = 100

t5[0, Ik+p+1]

N [0, Ik+p+1]

t5[0, Ik+p+1]

N [0, Ik+p+1]

t5[0, Ik+p+1]

N [0, Ik+p+1]

k = 5

p = 1

p = 5

p = 1

p = 5

p = 1

p = 5

p = 1

p = 5

p = 1

p = 5

p = 1

p = 5

AR

LM

CLRa

CLRb

PAR1

PAR2

PLM

PCLRa

PCLRb

3.15

2.90

2.90

2.80

5.00

5.05

5.10

4.80

6.20

4.50

4.30

3.95

3.95

5.55

6.85

5.60

6.25

7.25

RARn

18.65

15.70

RARw

12.40

10.20

RCLRn

13.85

14.55

RCLRw 10.40

12.90

WAR

WLM

5.30

4.65

7.45

5.85

4.50

4.15

4.00

4.05

5.45

5.60

5.40

5.20

5.35

5.25

5.35

3.35

4.45

5.35

4.95

4.25

4.25

4.05

4.05

4.75

5.45

5.15

4.85

5.10

4.45

4.10

3.70

4.55

4.10

4.80

3.15

3.20

3.20

3.20

5.00

5.05

5.00

4.30

6.30

4.50

4.05

4.15

4.10

5.55

6.85

6.05

5.50

6.70

18.65

15.70

12.40

10.20

13.15

14.50

10.20

11.90

5.30

4.20

7.45

6.40

4.50

3.70

3.30

3.35

5.45

5.60

5.05

4.20

4.65

5.25

5.35

3.15

4.20

5.35

4.40

4.25

3.70

3.55

3.45

4.75

5.45

5.05

4.30

4.75

4.45

4.10

3.75

4.65

4.10

4.05

3.15

3.00

2.95

2.55

5.00

5.05

4.70

4.25

5.80

4.50

4.10

4.25

4.00

5.55

6.85

6.15

5.20

7.00

18.65

15.70

12.40

10.20

11.10

12.65

9.15

10.90

5.30

4.50

7.45

5.95

4.50

3.25

3.45

3.30

5.45

5.60

4.95

3.70

4.30

5.25

5.35

4.00

4.55

5.35

4.30

4.25

3.85

3.75

3.95

4.75

5.45

5.45

4.15

5.00

4.45

4.10

3.50

4.35

4.10

4.35

Note: t5[0, Ik+p+1] and N [0, Ik+p+1] correspond to (W (cid:48)

i , X (cid:48)
2i, ui, (cid:15)i)(cid:48) ∼ N [0, Ik+p+1] (independent), respectively. The remaining part is as in Tables 1 and 2.

2i, ui, (cid:15)i)(cid:48) ∼ t5[0, Ik+p+1] (dependent but uncorrelated) and

i , X (cid:48)

(W (cid:48)

18

Table 4: Null rejection probabilities at 5% level. Conditionally heteroskedastic design with weak

identiﬁcation (λ = 0.1).

n = 100

p = 1

p = 5

t5[0, Ik+p+1]

N [0, Ik+p+1]

t5[0, Ik+p+1]

N [0, Ik+p+1]

Tests

k = 2

k = 5

k = 10

k = 2

k = 5

k = 10

k = 2

k = 5

k = 10

k = 2

k = 5

k = 10

AR

LM

CLRa

CLRb

PAR1

PAR2

PLM

PCLRa

PCLRb

2.35

2.95

2.40

2.45

3.60

3.35

4.45

3.60

3.65

1.75

4.35

2.05

2.25

5.15

4.85

5.95

5.20

6.40

0.60

3.55

0.80

1.25

4.35

4.35

6.20

4.80

8.45

4.05

4.90

4.05

4.10

4.85

4.90

5.45

5.50

5.50

2.90

4.30

3.65

3.60

5.60

5.30

5.80

5.45

5.65

RARn

22.30

27.30

32.55

13.45

10.20

RARw

14.35

17.90

20.10

10.40

RCLRn

19.75

25.70

32.30

11.40

RCLRw 14.35

18.05

21.95

9.75

WAR

WLM

4.50

4.65

5.80

3.90

5.55

3.95

4.75

5.65

8.85

8.30

8.20

5.20

4.20

1.40

4.30

2.00

2.20

5.20

5.00

6.35

4.35

5.15

8.05

6.65

6.40

6.60

4.90

6.30

4.30

5.25

4.10

4.25

7.40

6.35

6.80

6.65

6.80

2.40

3.35

2.40

2.60

7.55

5.50

4.65

4.70

5.20

1.15

2.85

1.35

1.25

8.85

4.95

5.05

4.10

7.55

5.25

6.00

5.30

5.25

5.95

6.40

6.50

6.35

6.35

3.25

4.30

3.30

3.45

4.70

5.30

5.60

5.25

5.50

23.55

24.80

29.85

13.75

10.10

15.95

16.00

17.55

10.40

32.25

33.75

44.75

13.20

27.00

27.55

38.65

11.15

8.65

7.00

10.80

12.60

6.80

7.00

5.75

5.25

8.25

8.75

8.55

4.40

4.30

2.60

3.85

3.00

3.00

4.70

5.35

5.95

5.70

6.85

8.70

7.35

7.85

8.60

4.95

5.45

Note: As in Table 3.

19

Table 5: Null rejection probabilities at 5% level. Conditionally heteroskedastic design with weak

identiﬁcation (λ = 4).

n = 100

p = 1

p = 5

t5[0, Ik+p+1]

N [0, Ik+p+1]

t5[0, Ik+p+1]

N [0, Ik+p+1]

Tests

k = 2

k = 5

k = 10

k = 2

k = 5

k = 10

k = 2

k = 5

k = 10

k = 2

k = 5

k = 10

AR

LM

CLRa

CLRb

PAR1

PAR2

PLM

PCLRa

PCLRb

2.35

3.10

2.45

2.40

3.60

3.35

4.20

3.70

3.80

1.75

3.95

2.10

2.25

5.15

4.85

5.35

5.55

6.20

0.60

3.70

1.00

1.50

4.35

4.35

5.80

4.15

8.75

4.05

4.55

4.15

4.10

4.85

4.90

5.15

4.90

5.05

2.90

3.85

3.20

3.15

5.60

5.30

4.90

4.70

5.20

RARn

22.30

27.30

32.55

13.45

10.20

RARw

14.35

17.90

20.10

10.40

RCLRn

19.45

22.40

29.95

11.05

RCLRw 13.70

17.50

19.55

9.40

WAR

WLM

4.50

3.20

5.80

3.50

5.55

4.15

4.75

4.00

8.85

7.50

7.45

5.20

4.05

1.40

3.80

1.55

1.85

5.20

5.00

5.05

4.05

5.40

8.05

6.65

6.05

6.35

4.90

4.90

4.30

4.50

4.25

4.15

7.40

6.35

6.20

6.05

6.20

2.40

2.80

2.55

2.45

7.55

5.50

3.90

4.65

5.80

1.15

2.50

1.25

1.30

8.85

4.95

4.60

3.90

7.85

5.25

6.00

5.70

5.65

5.95

6.40

6.30

6.45

6.85

3.25

3.60

2.85

3.00

4.70

5.30

4.45

4.55

5.05

23.55

24.80

29.85

13.75

10.10

15.95

16.00

17.55

10.40

29.25

31.25

41.50

11.85

25.00

26.20

36.00

10.10

8.65

6.60

10.80

12.60

5.85

7.00

5.75

5.55

8.25

8.50

8.25

4.40

3.90

2.60

4.00

3.15

3.45

4.70

5.35

6.10

5.65

7.10

8.70

7.35

7.15

7.55

4.95

5.30

Note: As in Table 3.

20

Table 6: Null rejection probabilities at 5% level. Conditionally heteroskedastic design with strong

identiﬁcation (λ = 20).

n = 100

p = 1

p = 5

t5[0, Ik+p+1]

N [0, Ik+p+1]

t5[0, Ik+p+1]

N [0, Ik+p+1]

Tests

k = 2

k = 5

k = 10

k = 2

k = 5

k = 10

k = 2

k = 5

k = 10

k = 2

k = 5

k = 10

AR

LM

CLRa

CLRb

PAR1

PAR2

PLM

PCLRa

PCLRb

2.35

3.05

2.25

2.45

3.60

3.35

4.35

4.35

4.50

1.75

3.20

2.00

2.40

5.15

4.85

4.35

4.55

6.00

0.60

2.40

0.95

1.35

4.35

4.35

4.50

3.55

8.25

4.05

4.90

4.60

4.65

4.85

4.90

5.45

4.95

5.00

2.90

3.00

2.80

2.95

5.60

5.30

4.20

3.40

3.90

RARn

22.30

27.30

32.55

13.45

10.20

RARw

14.35

17.90

20.10

10.40

RCLRn

16.75

17.90

23.45

RCLRw 12.80

13.80

16.75

WAR

WLM

4.50

3.60

5.80

3.85

5.55

3.70

9.80

8.85

4.75

4.90

8.85

7.05

7.05

5.20

4.75

1.40

3.15

1.85

2.20

5.20

5.00

4.75

3.20

4.65

8.05

6.65

5.85

5.95

4.90

4.55

4.30

4.55

4.55

4.70

7.40

6.35

5.95

5.85

6.00

2.40

3.10

2.70

2.80

7.55

5.50

4.40

4.10

5.35

1.15

2.10

1.45

1.75

8.85

4.95

4.20

3.30

7.25

5.25

5.65

5.70

5.80

5.95

6.40

6.45

6.35

6.50

3.25

3.95

3.50

3.55

4.70

5.30

4.95

4.10

4.90

23.55

24.80

29.85

13.75

10.10

15.95

16.00

17.55

10.40

25.35

24.15

33.65

11.60

22.05

21.15

28.75

9.85

8.65

6.15

10.80

12.60

5.25

7.00

5.75

5.80

8.25

6.25

6.25

4.40

3.65

2.60

3.90

3.20

3.25

4.70

5.35

5.90

4.60

6.65

8.70

7.35

6.95

6.90

4.95

4.95

Note: As in Table 3.

21

of causation between a better education of Protestants and industrialization in 1870s, the authors

estimate IV regressions where the dependent variable is a number of primary schools per 1000 in-

habitants, and the endogenous regressor is a fraction of Protestants instrumented by the distance

to Wittenberg, the city from which Protestantism were spread in a roughly concentric manner in

Martin Luther’s times.

The authors consider several diﬀerent speciﬁcations which diﬀer in terms of the exogenous

controls used: for the counties-level data,

• Speciﬁcation 1: constant;

• Speciﬁcation 2: latitude, longitude, a product of latitude and longitude, percentage of popu-

lation living in towns;

• Speciﬁcation 3: latitude, longitude, a product of latitude and longitude, percentage of pop-

ulation living in towns, percentage of population younger than 15 years of age, percentage

of population older than 60 years of age, number of horses per capita, number of bulls per

capita, looms per capita, share of farm laborers in total population and tonnage of transport

ships;

and for the towns-level data,

• Speciﬁcation 4: latitude, longitude, a product of latitude and longitude, percentage of pop-

ulation younger than 15 years of age, percentage of population older than 60 years of age,

looms per capita, buildings w/massive walls, businesses per capita and retailers per capita.

For further details of the study and the arguments underlie the use of the distance instrument, see

Becker and Woessmann (2010).

Since there is a single instrument, all speciﬁcations are just-identiﬁed. The sample sizes are 293

for the counties-level data and 156 for the towns-level data in the sample for 1816 Prussia. We

construct conﬁdence intervals for the coeﬃcient on the share of protestants using 1999 simulated

samples for the asymptotic CLR, wild bootstrap, permutation and rank-based conﬁdence intervals.

We include conﬁdence intervals from the homoskedastic two-stage least squares t test, t2sls, and
a non-studentized permutation test, PNS, based on W (cid:48) ˜u(θ0), ˜u(θ0) = MX (y − Y θ0), that rejects
when it is in the lower or upper tails of the permutation distribution of W (cid:48) ˜uπ(θ0) in all of the

speciﬁcations.

The 95% conﬁdence intervals and their lengths based on inverting diﬀerent tests are reported

in Table 8. In all of the speciﬁcations, the heteroskedasticity-robust asymptotic, permutation and

22

wild bootstrap conﬁdence intervals are nearly identical.

Interestingly, they are shorter than the

homoskedastic AR, RARn and RARw conﬁdence intervals. The RCLRn and RCLRw conﬁdence

intervals are comparable to the permutation conﬁdence intervals for the counties-level data, and

shorter for the towns-level data, however these tests do not guard against heteroskedasticity. As the

Breusch-Pagan test for heteroskedasticity in the reduced-form regression of the dependent variable

and the endogenous regressor on the instrument and the exogenous covariates have p-values 0.01366

and 2.22 × 10−16 for Speciﬁcation 1, 1.0916 × 10−6 and 0.0033 for Speciﬁcation 2, 5.3147 × 10−7 and

6.8536 × 10−6 for Speciﬁcation 3, and 0.14162 and 7.0197 × 10−5 for Speciﬁcation 4, there is a strong

evidence of heteroskedasticity and so the heteroskedasticity-robust methods should be more reliable.

The non-studentized permutation test which is exact under independence (Assumption 2.1) and does

not account for conditional heteroskedasticity yields a conﬁdence interval considerably wider than

the one based on the robust permutation tests.

Using the heteroskedasticity and identiﬁcation-robust conﬁdence intervals, we conﬁrm the ﬁnd-

ings of Becker and Woessmann (2010) that there is a signiﬁcant eﬀect of the share of Protestants

on the school supply in the counties-level data.

4.2 Bazzi and Clemens (2013)

Bazzi and Clemens (2013) reexamines cross-sectional IV regression results about the eﬀect of foreign

aid on economic growth from several published studies. The variables in the “aid-growth” IV

regressions estimated by Rajan and Subramanian (2008) and Bazzi and Clemens (2013) are

• yi : the average annual growth of per capita GDP;

• Yi : the foreign-aid receipts to GDP ratio (Aid/GDP);

• Wi1 : a variable constructed from aid-recipient population size, aid-donor population size,

colonial relationship, and language traits (see Appendix A of Bazzi and Clemens (2013));

• Xi : constant, initial per capita GDP, initial level of policy, initial level of life expectancy,

geography, institutional quality, initial inﬂation, initial M2/GDP, initial budget balance/GDP,

Revolutions, and Ethnic fractionalization.

The data cover the period 1970-2000 and the sample size is n = 78. Bazzi and Clemens (2013)

consider the following four speciﬁcations (Table 1, Columns 1-4 therein):

• Speciﬁcation 1: The baseline speciﬁcation of Rajan and Subramanian (2008) (Table 4, Column

2) with the variables as above;

23

Table 7: Conﬁdence intervals for the coeﬃcient on the share of Protestants in Becker and Woessmann

(2010) data.

Counties, n = 293

Towns, n = 156

Spec. 1

Spec. 2

Spec. 3

Spec. 4

Test statistics

95% CI

Length

95% CI

Length

95% CI

Length

95% CI

Length

t2sls

Hom. AR

RARn

RARw

RCLRn

RCLRw

AR

PAR1

PAR2

PNS

WAR

[0.24, 1.27]

[0.21, 1.25]

[0.35, 1.28]

[0.46, 1.31]

[0.32, 1.28]

[0.45, 1.32]

1.03

1.04

0.93

0.85

0.96

0.87

[0.94, 1.80]

[0.95, 1.80]

[0.83, 2.04]

[0.79, 1.81]

[0.99, 1.78]

[1.03, 1.68]

0.86

0.85

1.21

1.02

0.79

0.65

[0.98, 1.94]

[0.98, 1.95]

[0.86, 2.14]

[0.81, 1.97]

[1.07, 1.89]

[1.11, 1.83]

0.96

0.97

1.28

1.16

0.82

0.72

[−0.48, 1.03]

[−0.48, 1.05]

[−0.49, 1.06]

[−0.51, 0.98]

[−0.29, 0.73]

[−0.26, 0.68]

1.51

1.53

1.55

1.49

0.93

0.94

[0.27, 1.22]

0.95

[1.07, 1.69]

0.62

[1.10, 1.86]

0.76

[−0.51, 0.97]

1.48

[0.28, 1.21]

[0.27, 1.23]

0.93

0.96

[1.07, 1.69]

[1.07, 1.70]

0.62

0.63

[1.07, 1.87]

[1.10, 1.86]

0.80

0.76

[−0.53, 0.98]

[−0.51, 0.95]

1.51

1.46

[0.22, 1.25]

1.03

[0.77, 2.03]

1.26

[0.72, 2.22]

1.50

[−0.89, 1.59]

2.48

[0.25, 1.23]

0.98

[1.07, 1.69]

0.62

[1.10, 1.88]

0.78

[−0.56, 0.98]

1.54

F -statistic

80.78

174.65

143.78

79.50

Breusch-Pagan p-values

{0.01, 0.00}

{0.00, 0.00}

{0.00, 0.00}

{0.14, 0.00}

Note: The number of permutation samples is N = 1999. t2sls and Hom. AR are the homoskedastic two-stage least

squares t and AR tests, PNS denotes the non-studentized permutation test, and the remaining tests are as in Tables

1 and 2. The Breusch-Pagan test p-values are computed using the ﬁtted values in the reduced-form regressions of yi

and Yi on the instrument and exogenous covariates respectively.

24

• Speciﬁcation 2: log population is included in the second stage of Speciﬁcation 1;

• Speciﬁcation 3: Wi2 = log population replaces the instrument Wi1 in Speciﬁcation 1;

• Speciﬁcation 4: An instrument, Wi3, constructed from the colonial ties indicators only replaces

Wi1 in Speciﬁcation 1.

Speciﬁcations 1-4 are just-identiﬁed as there is a single instrument for the single endogenous regres-

sor, hence we only consider the AR and PAR test results. In addition, we consider Speciﬁcations

5-7 with IV’s (Wi1, Wi2)(cid:48), (Wi2, Wi3)(cid:48) and (Wi1, Wi2, Wi3)(cid:48), respectively, to examine whether the

over-identiﬁed speciﬁcations could have any instrumentation power. Wi2 is included in the latter

three cases because it is the strongest instrument as reported in Bazzi and Clemens (2013). We also

include the conﬁdence interval based on the two-stage least squares t-test, denoted as t2sls.

Tables 8 and 9 report the 95% conﬁdence intervals for the coeﬃcient on Aid/GDP. In all spec-

iﬁcations, the Breusch-Pagan test p-values from the two separate reduced-form regressions of the

endogenous variables on the exogenous variables show an evidence of heteroskedasticity.

The results for Speciﬁcations 1-4 in Table 8 qualitatively agree with the homoskedastic CLR

conﬁdence intervals reported in Bazzi and Clemens (2013). The permutation conﬁdence intervals

are nearly identical but slightly shorter than the asymptotic and wild bootstrap conﬁdence intervals

in Speciﬁcations 1 and 3. The inﬁnite conﬁdence intervals in Speciﬁcations 2 and 4 that do not use

log population or the instruments based on it indicate that the population size instrument used in

the other speciﬁcations has indeed the most identifying power.

The above results also extend to Table 9. Some noteworthy ﬁndings are as follows. The WAR

conﬁdence intervals are wider than the AR and PAR conﬁdence intervals. The PLM conﬁdence

intervals are shorter than the LM and WLM conﬁdence intervals, but still wider than the other

conﬁdence intervals. Somewhat surprisingly, in Speciﬁcation 6, the AR, CLRa, PAR and PCLR

conﬁdence intervals exclude 0 thereby pointing towards borderline signiﬁcant eﬀect of the foreign aid

on growth despite the rather small value of the ﬁrst-stage F -statistic 17.90. Also, in Speciﬁcation 7,

the PCLR conﬁdence intervals exclude 0 while the opposite holds for the asymptotic CLR conﬁdence

intervals which underscore the utility of the proposed tests.

However, these results should be interpreted with caution because the population size might

aﬀect the growth through multiple channels as argued by Bazzi and Clemens (2013). Overall, the

uncertainty regarding the eﬀect of foreign aid in the sample data may be expressed more accurately

by the permutation and the wild bootstrap conﬁdence intervals as the unobserved confounders in

25

the “aid-growth” regression are more likely to be orthogonal to, rather than independent of the

population size.

Table 8: Conﬁdence intervals for the coeﬃcient on Aid/GDP in Rajan and Subramanian (2008)

and Bazzi and Clemens (2013) data.

t2sls

Hom. AR

RARn

RARw

RCLRn

RCLRw

AR

PAR1

PAR2

PNS

WAR

Test statistics

95% CI

Length

95% CI

95% CI

Length

Spec. 1

Spec. 2

Spec. 3

[−0.05, 0.24]

[−0.02, 0.28]

[−0.05, 0.29]

[−0.06, 0.20]

[−0.03, 0.26]

[−0.04, 0.18]

[−0.01, 0.29]

[−0.01, 0.30]

[−0.01, 0.28]

0.29

0.30

0.34

0.26

0.29

0.22

0.30

0.31

0.29

[−5.14, 6.96]

[−0.06, 0.21]

(−∞, ∞)

[−0.03, 0.25]

(−∞, ∞)

[−0.06, 0.28]

(−∞, ∞)

[−0.07, 0.16]

(−∞, ∞)

[−0.04, 0.22]

(−∞, ∞)

[−0.05, 0.16]

(−∞, ∞)

[−0.02, 0.25]

(−∞, ∞)

[−0.03, 0.27]

(−∞, ∞)

[−0.02, 0.25]

0.27

0.28

0.34

0.23

0.26

0.21

0.27

0.30

0.27

Spec. 4

95% CI

[−973.38, 941.49]

(−∞, ∞)

(−∞, ∞)

(−∞, ∞)

(−∞, ∞)

(−∞, ∞)

(−∞, ∞)

(−∞, ∞)

(−∞, ∞)

[−0.04, 0.37]

0.41

(−∞, ∞)

[−0.05, 0.30]

0.35

(−∞, ∞)

[−0.02, 0.32]

0.34

(−∞, ∞)

[−0.03, 0.28]

0.31

(−∞, ∞)

F -statistic

31.63

0.13

36.30

0.00

Breusch-Pagan p-values

{0.03, 0.00}

{0.03, 0.00}

{0.02, 0.00}

{0.01, 0.00}

Note: The number of permutation samples is N = 1999. The sample size is 78. Speciﬁcations 1-4 are just-identiﬁed.

t2sls and Hom. AR are the homoskedastic two-stage least squares t and AR tests, PNS denotes the non-studentized

permutation test, and the remaining tests are as in Tables 1 and 2. The Breusch-Pagan test p-values are computed

using the ﬁtted values in the reduced-form regressions of yi and Yi on the instrument and exogenous covariates

respectively.

5 Conclusion

This paper studies randomization inference in the linear IV model. The proposed permutation tests

are analogs of the linear IV identiﬁcation-robust tests, and share the strengths of the rank/permutation

tests and the wild bootstrap tests. In particular, these tests allow for conditional heteroskedastic-

ity, do not require the instruments to be independently distributed of the error terms unlike most

26

Table 9: Conﬁdence intervals for the coeﬃcient on Aid/GDP in Rajan and Subramanian (2008)

and Bazzi and Clemens (2013) data.

Test statistics

95% CI

Length

95% CI

Length

95% CI

Length

Spec. 5

Spec. 6

Spec. 7

t2sls

Hom. AR

Hom. LM

Hom. CLR

RARn

RARw

RCLRn

RCLRw

AR

LM

CLRa

CLRb

PAR1

PAR2

PLM

PCLRa

PCLRb

PNS

WAR

WLM

[−0.06, 0.22]

[−0.05, 0.31]

[−0.63, 0.26]

[−0.03, 0.26]

[−0.08, 0.41]

[−0.08, 0.29]

[−0.03, 0.24]

[−0.05, 0.17]

[−0.04, 0.34]

[−0.43, 0.27]

[−0.03, 0.28]

[−0.02, 0.28]

[−0.04, 0.35]

[−0.04, 0.34]

[−0.43, 0.25]

[−0.03, 0.27]

[−0.02, 0.27]

[−0.04, 0.39]

[−0.05, 0.44]

[−0.64, 0.30]

0.28

0.36

0.89

0.29

0.49

0.37

0.27

0.22

0.38

0.70

0.31

0.30

0.39

0.38

0.68

0.30

0.29

0.43

0.49

0.94

[−0.06, 0.21]

[−0.02, 0.26]

[−0.63, 0.28]

[−0.03, 0.28]

[−0.06, 0.32]

[−0.06, 0.23]

[−0.03, 0.25]

[−0.03, 0.17]

[0.04, 0.32]

[−0.61, 0.36]

[0.02, 0.36]

[0.00, 0.36]

[0.04, 0.34]

[0.04, 0.31]

[−0.60, 0.33]

[0.02, 0.34]

[0.02, 0.34]

[−0.06, 0.32]

[0.00, 0.33]

[−0.66, 0.30]

0.27

0.28

0.91

0.31

0.38

0.29

0.28

0.20

0.28

0.97

0.34

0.36

0.30

0.27

0.93

0.32

0.32

0.38

0.33

0.96

[−0.06, 0.21]

[−0.04, 0.32]

[−0.63, 0.28]

[−0.03, 0.28]

[−0.09, 0.40]

[−0.09, 0.27]

[−0.03, 0.25]

[−0.04, 0.17]

[0.01, 0.42]

[−0.69, 0.35]

[0.00, 0.35]

[−0.03, 0.34]

[0.01, 0.43]

[0.02, 0.38]

[−0.65, 0.33]

[0.01, 0.35]

[0.01, 0.35]

[−0.04, 0.35]

[−0.04, 0.48]

[−0.66, 0.33]

0.27

0.36

0.91

0.31

0.49

0.36

0.28

0.21

0.41

1.04

0.35

0.37

0.42

0.36

0.98

0.34

0.34

0.39

0.52

0.99

F -statistic

Sargan p-value

17.98

0.42

17.90

0.08

11.86

0.21

Breusch-Pagan p-values

{0.03, 0.00}

{0.02, 0.00}

{0.02, 0.00}

Note: The number of permutation samples is N = 1999. The sample size is 78. Speciﬁcations 5-7 are over-identiﬁed.

t2sls, Hom. AR, Hom. LM and Hom. CLR are the homoskedastic two-stage least squares t, AR, LM and CLR

tests, PNS denotes the non-studentized permutation test, and the remaining tests are as in Tables 1 and 2. The

Breusch-Pagan test p-values are computed using the ﬁtted values in the reduced-form regressions of yi and Yi on the

instrument and exogenous covariates respectively.

27

rank-based or permutation tests currently available in the literature, and could be robust to heavy

tails in certain cases.

We plan to address the important issue of cluster and identiﬁcation-robust inference in IV models

in another work.

28

References

Abadie, A., Athey, S., Imbens, G. W. and Wooldridge, J. M. (2020). Sampling-based vs.

Design-based Uncertainty in Regression Analysis. Econometrica, 88 265–296.

Anderson, T. W. and Rubin, H. (1949). Estimation of the Parameters of a Single Equation in

a Complete System of Stochastic Equations. Annals of Mathematical Statistics, 20 46–63.

Andrews, D. W. and Guggenberger, P. (2019a). Identiﬁcation-and Singularity-Robust Infer-

ence for Moment Condition Models. Quantitative Economics, 10 1703–1746.

Andrews, D. W. K., Cheng, X. and Guggenberger, P. (2020). Generic Results for Establish-

ing the Asymptotic Size of Conﬁdence Sets and Tests. Journal of Econometrics, 218 496–531.

Andrews, D. W. K. and Guggenberger, P. (2017a). Asymptotic Size of Kleibergen’s LM and

Conditional LR Tests for Moment Condition Models. Econometric Theory, 33 1046–1080.

Andrews, D. W. K. and Guggenberger, P. (2017b). Supplemental material to ”Asymptotic

Size of Kleibergen’s LM and Conditional LR Tests for Moment Condition Models”. Econometric

Theory, 33.

Andrews, D. W. K. and Guggenberger, P. (2019b). Supplemental material to “Identiﬁcation-

and Singularity-Robust Inference for Moment Condition Models”. Quantitative Economics, 10.

Andrews, D. W. K. and Marmer, V. (2008). Exactly Distribution-Free Inference in Instrumental

Variables Regression with Possibly Weak Instruments. Journal of Econometrics, 142 183–200.

Andrews, D. W. K. and Soares, G. (2007). Rank Tests for Instrumental Variables Regression

with Weak Instruments. Econometric Theory, 23 1033–1082.

Andrews, D. W. K. and Stock, J. H. (2007). Inference with Weak Instruments. In Advances

in Econometrics: Proceedings of the Ninth World Congress of the Econometric Society, vol. 3.

Andrews, I., Stock, J. H. and Sun, L. (2019). Weak Instruments in Instrumental Variables

Regression: Theory and Practice. Annual Review of Economics, 11 727–753.

Bazzi, S. and Clemens, M. A. (2013). Blunt Instruments: Avoiding Common Pitfalls in Identi-

fying the Causes of Economic Growth. American Economic Journal: Macroeconomics, 5 152–86.

Becker, S. O. and Woessmann, L. (2010). The Eﬀect of Protestantism on Education before the

Industrialization: Evidence from 1816 Prussia. Economics Letters, 107 224–228.

29

Canay, I. A. and Kamat, V. (2018). Approximate Permutation Tests and Induced Order Statistics

in the Regression Discontinuity Design. The Review of Economic Studies, 85 1577–1608.

Canay, I. A., Romano, J. P. and Shaikh, A. M. (2017). Randomization Tests under an

Approximate Symmetry Assumption. Econometrica, 85 1013–1030.

Chernozhukov, V., Hansen, C. and Jansson, M. (2009). Finite Sample Inference for Quantile

Regression Models. Journal of Econometrics, 152 93–103.

Chung, E. and Romano, J. P. (2013). Exact and Asymptotically Robust Permutation Tests.

Annals of Statistics, 41 484–507.

Chung, E. and Romano, J. P. (2016). Multivariate and Multiple Permutation Tests. Journal of

Econometrics, 193 76–91.

Davidson, R. and MacKinnon, J. G. (2008). Bootstrap Inference in a Linear Equation Estimated

by Instrumental Variables. The Econometrics Journal, 11 443–477.

Davidson, R. and MacKinnon, J. G. (2012). Wild Bootstrap Tests for IV Regression. Journal

of Business & Economic Statistics, 28 128–144.

DiCiccio, C. J. and Romano, J. P. (2017). Robust Permutation Tests for Correlation and

Regression Coeﬃcients. Journal of the American Statistical Association, 112 1211–1220.

Dufour, J.-M. (2003). Identiﬁcation, Weak Instruments and Statistical Inference in Econometrics.

Canadian Journal of Economics, 36 767–808.

Dufour, J.-M., Flachaire, E. and Khalaf, L. (2019). Permutation Tests for Comparing

Inequality Measures. Journal of Business & Economic Statistics, 37 457–470.

Freedman, D. and Lane, D. (1983). A Nonstochastic Interpretation of Reported Signiﬁcance

Levels. Journal of Business & Economic Statistics, 1 292–298.

Ganong, P. and J¨ager, S. (2018). A Permutation Test for the Regression Kink Design. Journal

of the American Statistical Association, 113 494–504.

Hansen, B. E. (2021). Econometrics. Manuscript.

Hoeffding, W. (1951). A Combinatorial Central Limit Theorem. Annals of Mathematical Statis-

tics, 22 558–566.

30

Hu, T.-C., Moricz, F. and Taylor, R. L. (1989). Strong Laws of Large Numbers for Arrays of

Rowwise Independent Random Variables. Acta Mathematica Hungarica, 54 153–162.

Imbens, G. W. and Rosenbaum, P. R. (2005). Robust, Accurate Conﬁdence Intervals with a

Weak Instrument: Quarter of Birth and Education. Journal of the Royal Statistical Society:

Series A (Statistics in Society), 168 109–126.

Janssen, A. (1997). Studentized Permutation Tests for Non-IID Hypotheses and the Generalized

Behrens-Fisher Problem. Statistics & Probability letters, 36 9–21.

Kleibergen, F. (2002). Pivotal Statistics for Testing Structural Parameters in Instrumental Vari-

ables Regression. Econometrica, 70 1781–1803.

Lehmann, E. L. and Romano, J. P. (2005). Testing Statistical Hypotheses. 3rd ed. Springer.

Moreira, H. and Moreira, M. J. (2019). Optimal Two-Sided Tests for Instrumental Variables

Regression with Heteroskedastic and Autocorrelated Errors. Journal of Econometrics, 213 398–

433.

Moreira, M. J. (2003). A Conditional Likelihood Ratio Test for Structural Models. Econometrica,

71 1027–1048.

Moreira, M. J., Porter, J. R. and Suarez, G. A. (2009). Bootstrap Validity for the Score

Test When Instruments May be Weak. Journal of Econometrics, 149 52–64.

Motoo, M. (1956). On the Hoeﬀding’s Combinatorial Central Limit Theorem. Annals of the

Institute of Statistical Mathematics, 8 145–154.

Neubert, K. and Brunner, E. (2007). A Studentized Permutation Test for the Non-Parametric

Behrens–Fisher Problem. Computational Statistics & Data Analysis, 51 5192–5204.

Neuhaus, G. (1993). Conditional Rank Tests for the Two-Sample Problem under Random Cen-

sorship. Annals of Statistics, 21 1760–1779.

Pauly, M. (2011). Discussion about the Quality of F-Ratio Resampling Tests for Comparing

Variances. Test, 20 163–179.

Rajan, R. G. and Subramanian, A. (2008). Aid and Growth: What Does the Cross-Country

Evidence Really Show? The Review of Economics and Statistics, 90 643–665.

31

Schneller, W. (1988). A Short Proof of Motoo’s Combinatorial Central Limit Theorem using

Stein’s Method. Probability Theory and Related Fields, 78 249–252.

So, B. S. and Shin, D. W. (1999). Cauchy Estimators for Autoregressive Processes with Appli-

cations to Unit Root Tests and Conﬁdence Intervals. Econometric Theory, 15 165–176.

Stock, J. H., Wright, J. H. and Yogo, M. (2002). A Survey of Weak Instruments and Weak

Identiﬁcation in Generalized Method of Moments. Journal of Business and Economic Statistics,

20 518–529.

Young, A. (2020). Consistency without Inference: Instrumental Variables in Practical Application.

Tech. rep., London School of Economics.

32

A Proofs

In the sequel, d= denotes distributional equality. We use the abbrevations SLLN for the strong law of large of

numbers, WLLN for the weak law of large numbers for independent L1+δ-bounded random variables, CLT

for the central limit theorem, CMT for the continuous mapping theorem, and SV and SVD for “singular

value” and “singular value decomposition”, respectively.

Let (Ω0, F, P ) be the probability triplet underlying the observations (y, Y, W, X), and P π denote the

probability measure induced by a random permutation π uniformly distributed over Gn.
the convergence in probability and convergence in distribution with respect to P π. Also, oa.s.(·) and Oa.s.(·)

−→ denote

pπ
−→ and dπ

stand for o(·) P -almost surely and O(·) P -almost surely, respectively.

Proof of Proposition 2.1. Since ˜Σu(θ0) = diag(˜u1(θ0)2, . . . , ˜un(θ0)2) and ˜ui(θ0) = ui − X (cid:48)
H0 : θ = θ0, we may write ˜Σu(θ0) = ˜Σu(u, X). Then

i(X (cid:48)X)−1X (cid:48)u under

PAR1 = u(cid:48)MX Wπ(W (cid:48)

πMX ˜Σu(u, X)MX Wπ)−1W (cid:48)

πMX u

d= u(cid:48)MX W (W (cid:48)MX ˜Σu(u, X)MX W )−1W (cid:48)MX u

= AR,

(A.1)

where the equality in distribution follows from Assumption 1. Then, letting φPAR1

n

= φPAR1
n

(Wπ, X, ˜u(θ0))

E[φPAR1
n

] =

=

(cid:34)

E

(cid:88)

φPAR1
n

(Wπ, X, ˜u(θ0))

(cid:35)

π∈Gn

(cid:20)
N + +

E

n!α − N +
N 0

(cid:21)

N 0

1
n!

1
n!

= α,

where the ﬁrst equality uses (A.1), and the second equality follows from the deﬁnitions of φPAR1

n

(Wπ, X, ˜u(θ0)),

N + and N 0. The proof of the PAR2 test is similar, thus is omitted.

A.1 Outline of the asymptotic results

The proof of the asymptotic results is organized as follows. In Section A.2, we provide some asymptotic results

for triangular arrays of random variables which will be used later in the proof of asymptotic similarity. In

Section A.3, following Andrews and Guggenberger (2019b) we deﬁne the drifting sequences of parameters for

establishing the uniform validity of the permutation tests, and state two lemmas pertaining to the conditional

critical value of the CLR-type statistics. Section A.4 provides some asymptotic results for quantities that

depend on the sample data only. Section A.5 presents the main results about the asymptotic distribution of

key permutation quantities (Lemma A.6) and the PCLR statistics under the drifting parameter sequences.

The uniform asymptotic similarity is proved in Section A.6. The asymptotic distributions of the test statistics

under strong or semi-strong identiﬁcation, and local alternatives are derived in Section A.7. Finally, Section

A.8 presents the proof of Lemma A.8 used in the derivation of the asymptotic distribution of the PCLR

statistics.

33

A.2 Supplementary results

We use the following auxiliary results in the proof of asymptotic results. The ﬁrst result is a version of the

Hoeﬀding (1951)’s combinatorial CLT established by Motoo (1956) (see also Schneller (1988)) which is based

on a Lindeberg-type condition.

Lemma A.1 (Combinatorial CLT). For n2, n > 1, real scalars cn(i, j), i, j = 1, . . . , n, and a random permu-
tation π uniformly distributed over Gn, consider the sum

with EP π [Sn] = n−1 (cid:80)n

i=1

(cid:80)n

j=1 cn(i, j) and VarP π [Sn] = 1
n−1

(cid:80)n

i=1

Sn ≡

n
(cid:88)

i=1

cn(i, π(i))

(cid:80)n

j=1 g2

n(i, j), where

gn(i, j) = cn(i, j) − n−1

n
(cid:88)

i=1

cn(i, j) − n−1

n
(cid:88)

j=1

cn(i, j) + n−2

n
(cid:88)

n
(cid:88)

i=1

j=1

cn(i, j).

If gn(i, j) (cid:54)= 0 for some (i, j), so that VarP π [Sn] > 0, and for any (cid:15) > 0

lim
n→∞

1
n

n
(cid:88)

n
(cid:88)

i=1

j=1

1
n−1

then as n → ∞

g2
n(i, j)
(cid:80)n

(cid:80)n

i=1

j=1 g2

n(i, j)



1




|gn(i, j)|

(cid:16) 1
n−1

(cid:80)n

i=1

(cid:80)n

j=1 g2

n(i, j)

(cid:17)1/2



> (cid:15)


 = 0,

(A.2)

Sn − EP π [Sn]
(cid:112)VarP π [Sn]

dπ
−→ N [0, 1] P -almost surely.

The next result is a triangular array SLLN.

Lemma A.2 (Corollary to Theorem 1 of Hu et al. (1989)). Let {Znk : k = 1, . . . , n; n = 1, 2, . . . } be an array
of i.i.d. random variables such that E[|Znk|2p] < ∞ for some 1 ≤ p < 2. Then,

n
(cid:88)

n−1/p

(Znk − E[Znk]) a.s.−→ 0.

k=1

(A.3)

Proof of Lemma A.2. By the cr inequality, E[(Znk −E[Znk])2p] ≤ 22p−1(E[Z 2p
Theorem 1 of Hu et al. (1989) with Xnk = Znk − E[Znk] yields that n−1/p (cid:80)n
to 0 i.e. for any ε > 0

nk]+(E[Znk])2p) < ∞. Applying
k=1 Xnk converges completely

∞
(cid:88)

P

(cid:34)
|n−1/p

n
(cid:88)

(cid:35)

Xnk| > ε

< ∞.

(A.4)

k=1
From Borel-Cantelli lemma, it follows that n−1/p (cid:80)n

n=1

k=1 Xnk

a.s.−→ 0.

We will also use the following fact.

Lemma A.3. If {Xi}n

i=1 and X are deﬁned on the probability space (Ω0, F, P ) and Xn

p

−→ X, then Xn

pπ
−→

X in P -probability.

Proof of Lemma A.3. This proof is analogous to the bootstrap version of the result, see Hansen (2021),

Theorem 10.1.

34

A.3 Drifting sequences of parameters

Following Andrews and Guggenberger (2019b), we ﬁrst introduce some notations, and deﬁne the DGP’s.

Henceforth, we shall suppress the argument θ0 in some quantities, and write, for example, ˆm(θ0) = ˆm,
ˆΣ(θ0) = ˆΣ, ˆJ(θ0) = ˆJ, ˆmπ(θ0) = ˆmπ, ˆΣπ(θ0) = ˆΣπ, ˆJ π(θ0) = ˆJ π.
(cid:16)

Deﬁne GP ≡ EP [Z ∗

i Z ∗(cid:48)

i ]Γ , ˆH ≡ ˆΣ−1/2, HP ≡ Σ−1/2

P

, ˆU ≡

(θ0, Id)Ω(cid:15)( ˆΣ, ˜V)−1(θ0, Id)(cid:48)(cid:17)1/2

and

UP ≡ (cid:0)(θ0, Id)Ω(cid:15)(ΣP , VP )−1(θ0, Id)(cid:48)(cid:1)1/2
, where ˜V = ˆVa(θ0), VP = VP,a (deﬁned in (2.17) and (2.35)) and
˜V = ˆVb(θ0), VP = VP,b (deﬁned in (2.19) and (2.36)) for the CLRa, PCLRa and CLRb, PCLRb statistics,

respectively.

The SVD of HP GP UP is given as follows. Let κ1P ≥ · · · ≥ κdP and BP denote the ordered eigenvalues,

and a d × d orthogonal matrix of corresponding eigenvectors, respectively, of

U (cid:48)

P G(cid:48)

P HP H (cid:48)

P GP UP ,

(A.5)

and κ1P ≥ · · · ≥ κkP and AP denote the ordered eigenvalues, and a k × k orthogonal matrix of corresponding

eigenvectors, respectively, of

HP GP UP U (cid:48)

P G(cid:48)

P H (cid:48)
P .

Let τ1P ≥ · · · ≥ τdP ≥ 0 denote the singular values of

HP GP UP .

Deﬁne

λ1,P ≡ (τ1P , . . . , τdP )(cid:48) ∈ Rd,

λ2,P ≡ BP ∈ Rd×d,

λ3,P ≡ AP ∈ Rk×k,

i Z ∗(cid:48)
λ4,P ≡ GP = EP [Z ∗



i ]Γ ∈ Rk×d,

λ5,P ≡ VP,a = EP





Z ∗

i ui
i Γ + V (cid:48)
i (Z ∗(cid:48)

i ))









Z ∗

i ui
i Γ + V (cid:48)
i (Z ∗(cid:48)

i ))

vec(Z ∗





(cid:48)
 ∈ R(d+1)k×(d+1)k,

vec(Z ∗

λ6,P ≡ [λ6,1P , . . . , λ6,(d−1)P ](cid:48) =

(cid:20) τ2P
τ1P

, . . . ,

(cid:21)(cid:48)

τdP
τ(d−1)P

∈ [0, 1]d−1,

λ7,P ≡ EP [(W (cid:48)

i , X (cid:48)

i)(cid:48)(W (cid:48)

i , X (cid:48)

i)] ∈ R(k+p)×(k+p),

λ8,P ≡ Σe = VarP [(ui, V (cid:48)

i )(cid:48)] ∈ R(d+1)×(d+1),

λ9,P = (ΣP , K(VP )) ∈ (Rk×k, R(d+1)k×(d+1)k), VP ∈ {VP,a, VP,b},

λ10,P ≡ P,

λP ≡ (λ1,P , . . . , λ10,P )(cid:48).

35

(A.6)

(A.7)

(A.8)

(A.9)

(A.10)

(A.11)

(A.12)

(A.13)

(A.14)

(A.15)

(A.16)

(A.17)

(A.18)

As in Andrews and Guggenberger (2019b), the drifting parameters λ1,P , . . . , λ6,P , λ9,P , λ10,P are used in the

asymptotic results for the AR, LM, CLR statistics. The parameter vector λ1,P characterizes the identiﬁ-

cation strength. The sequences λ7,P and λ8,P are needed additionally for the asymptotic properties of the

permutation statistics.

Deﬁne

Λ ≡ {λP : P ∈ P PCLR

0

},

hn(λP ) ≡ [n1/2λ1,P , λ2,P , λ3,P , λ4,P , λ5,P , λ6,P , λ7,P , λ8,P , λ9,P ],

and

H ≡{h ∈ (R ∪ {±∞})dim(hn(λPn )) : hwn (λPwn

) → h for some subsequence {wn} of {n}

and some sequence {λPwn

∈ Λ : n ≥ 1}}.

The following assumption corresponds to Assumption B∗ of Andrews and Guggenberger (2019b) which is key

for establishing the asymptotic similarity of the tests.

Assumption 3. For any subsequence {wn} of {n} and any sequence {λPwn
hwn(λPwn

] → α for some α ∈ (0, 1).

) → h ∈ H, EPwn

[φP R
wn

Let {λPn ∈ Λ : n ≥ 1} be a sequence such that hn(λPn ) → h ∈ H, and

n1/2τjPn → h1,j ≥ 0,

j = 1, . . . , d,

λj,Pn → hj,

j = 2, . . . , 8,

λ5,mPn = EPn [Z ∗

i Z ∗(cid:48)

i u2

i ] → h5,m = Σ,

λ6,jPn → h6,j,

j = 1, . . . , d − 1,

λ7,Pn → h7 ≡





Qww Qwx

Qwx Qxx


σ2



 ,

ΣuV

ΣV u ΣV



 ,

λ8,Pn → h8 ≡ Σe =



λ9,Pn → h9 ≡ (Σ, K(V)),

∈ Λ : n ≥ 1} for which

(A.19)

(A.20)

(A.21)

(A.22)

(A.23)

(A.24)

(A.25)

where λ5,mPn ∈ Rk×k is the upper-left sub-matrix of λ5,Pn with the corresponding limit h5,m = Σ, h7 and h8
are partitioned conformably with λ7,Pn and λ8,Pn , respectively, and for both (ΣP , K(VP,a)) and (ΣP , K(VP,b)),

the limit is denoted by the same variable h9 with V in (A.25) denoting the limit of VP ∈ {VP,a, VP,b} deﬁned

in (A.16).

Consider q = qh ∈ {0, . . . , d} such that

h1,j = ∞ for

1 ≤ j ≤ q,

h1,j < ∞ for

q + 1 ≤ j ≤ d.

36

The normalization matrices used to derive the limiting distribution of the test statistics are deﬁned as follows:

SPn ≡ diag

(cid:16)

(cid:17)
(n1/2τ1Pn )−1, . . . , (n1/2τqPn )−1, 1, . . . , 1

∈ Rd×d,

TPn ≡ BPn SPn ∈ Rd×d.

(A.26)

(A.27)

In the sequel, we index the quantities indexed by P = Pn by n, for example, write ΣP = EP [Z ∗
GP = EP [Z ∗

i ]Γ = Gn, λwn = λPwn

and λn = λPn .

i Z ∗(cid:48)

i Z ∗(cid:48)

i u2

i ] = Σn,

Let ˆκ1 ≥ · · · ≥ ˆκd ≥ 0 denote the eigenvalues of

n ˆU (cid:48) ˆJ (cid:48) ˆH ˆH (cid:48) ˆJ ˆU .

Partition

An = [An,q, An,k−q], An,q ∈ Rk×q, An,k−q ∈ Rk×(k−q),

Bn = [Bn,q, Bn,d−q] , Bn,q ∈ Rd×q, Bn,d−q ∈ Rd×(d−q),

h2 = [h2,q, h2,d−q], h2,q ∈ Rd×q, h2,d−q ∈ Rd×(d−q),

h3 = [h3,q, h3,k−q], h3,q ∈ Rk×q, h3,k−q ∈ Rk×(k−q).

Deﬁne



Υn ≡






Υn,q

0q×(d−q)

0(d−q)×q

Υn,d−q

0(k−d)×q

0(k−d)×(d−q)








∈ Rk×d, Υn,q ≡ diag(τ1n, . . . , τqn) ∈ Rq×q,

Υn,d−q ≡ diag(τ(q+1)n, . . . , τdn) ∈ R(d−q)×(d−q).

For a non-random matrix J ∈ R(k−q)×(d−q), let rk,d,q(J , 1 − α) denote the 1 − α quantile of

Z ∗(cid:48)Z ∗ − λmin[(J , Z ∗

2 )(cid:48)(J , Z ∗

2 )], Z ∗ = [Z ∗(cid:48)

1 , Z ∗(cid:48)

2 ](cid:48) ∼ N [0k×1, Ik], Z ∗

1 ∈ Rq, Z ∗

2 ∈ Rk−q.

(A.28)

(A.29)

(A.30)

(A.31)

(A.32)

(A.33)

The following results due to Andrews and Guggenberger (2019b) will be used in the proof of the asymptotic

similarity of the PCLR tests.

Lemma A.4 (Lemma 27.3 of Andrews and Guggenberger (2019b)). Let Z = [Z (cid:48)
Rq, Z2 ∈ Rk−q, and Υ(τ c) ≡ [diag(τ c), 0(d−q)×(k−d)] ∈ R(k−q)×(d−q), where τ c ≡ (τ c
with τ c

d ≥ 0, and k ≥ d ≥ 1 and 0 ≤ q ≤ d. Then, the distribution function of

q+1 ≥ . . . , τ c

1, Z (cid:48)

2](cid:48) ∼ N [0k×1, Ik], Z1 ∈
d )(cid:48) ∈ Rd−q
(q+1), . . . , τ c

CLR∞(τ c) ≡ Z (cid:48)Z − λmin[(Υ(τ c), Z2)(cid:48)(Υ(τ c), Z2)]

(A.34)

is continuous and strictly increasing at its 1 − α quantile rk,d,q(Υ(τ c), 1 − α) for all α ∈ (0, 1).

Lemma A.5 (Lemma 16.2 of Andrews and Guggenberger (2019b)). Let J c be a (k − q) × (d − q) matrix with

the singular value decomposition AcΥcBc(cid:48), where Ac is a (k − q) × (k − q) orthogonal matrix of eigenvectors

of J cJ c(cid:48), Bc is a (d − q) × (d − q) orthogonal matrix of eigenvectors of J c(cid:48)J c, and Υc is the (k − q) × (d − q)

37

matrix with the d − q singular values τ c

q+1 ≥ · · · ≥ τ c
elsewhere. Then, for rk,d,q(·, 1 − α) deﬁned in (A.33)

d of J c as its ﬁrst d − q diagonal elements and zeros

rk,d,q(J c, 1 − α) = rk,d,q(Υc, 1 − α),

and the distribution of the random variable in (A.34) is identical to that of (A.33) with J c in place of J .

A.4 Probability limits of some key sample quantities

The proof of the asymptotic similarity of the permutation tests involves the derivation of the asymptotic

distributions of the AR, LM, CLRa and CLRb statistics under the drifting sequences of parameters given

above which can be derived following Andrews and Guggenberger (2017a,b, 2019a,b) based on the moment

i (θ) = Z ∗

function m∗
function ˆm∗(θ) ≡ n−1 (cid:80)n

i (θ), where u∗
i=1 Z ∗

i (θ) ≡ Z ∗(cid:48)

i Γ (θ−θ0)+ui+V (cid:48)

i (θ−θ0), and the corresponding sample moment
i (θ). Note here that the test statistics are based on ˆm(θ) ≡ n−1Z (cid:48)(y − Y θ) =

i u∗

i u∗

n−1Z (cid:48)ZΓ (θ − θ0) + n−1Z (cid:48)u + n−1Z (cid:48)V (θ − θ0) rather than ˆm∗(θ). Therefore, since

ˆm∗(θ) = n−1Z ∗(cid:48)Z ∗Γ (θ − θ0) + n−1Z ∗(cid:48)u + n−1Z ∗(cid:48)V (θ − θ0),

where Z ∗ ≡ W − X(EP [XiX (cid:48)
i ], one needs to account for the randomness that results when
Z ∗ is replaced by Z in order to derive the asymptotic distributions. Since the latter does not entail any

i])−1 EP [XiW (cid:48)

substantial change in the proof of Andrews and Guggenberger (2017a,b, 2019a,b), we do not provide them

here to avoid overlap.

However, following Andrews and Guggenberger (2019b), we shall determine the probability limits of

certain sample random quantities that appear in the permutation statistics but do not depend on the random

permutation π, under the drifting parameter sequences.

We also remark that the proof of the asymptotic distributions of the permutation test statistics are similar

to that of the asymptotic test statistics and so one can derive the asymptotic distributions of the AR, LM,

CLRa and CLRb statistics proceeding similarly to the derivation of the asymptotic distributions of the robust

permutation statistics provided below by replacing the permutation quantities by their sample counterparts.

The limits of ˆVa(θ0), ˆVb(θ0) and ˆJ. By the triangular array WLLN and the CMT, for s = 1, . . . , d,
n−1 (cid:80)n

i=1 Zi ˜Yis = n−1Z (cid:48) ˜Y, s = n−1Z (cid:48)ZΓs + n−1Z (cid:48)V, s = EP [Z ∗

i ]Γs + op(1),

i Z ∗(cid:48)

D ≡ EP [WiX (cid:48)

i](EP [XiX (cid:48)

i])−1 − W (cid:48)X(X (cid:48)X)−1

(X (cid:48)X)−1X (cid:48)V, s

p

−→ 0,

p

−→ 0,

n−1X (cid:48)u

p

−→ 0.

(A.35)

(A.36)

(A.37)

We may rewrite Zi = Wi −W (cid:48)X(X (cid:48)X)−1Xi = Wi −EP [WiX (cid:48)
Z (cid:48)

i(X (cid:48)X)−1X (cid:48)V, s = Z ∗(cid:48)

i](EP [XiX (cid:48)
i(D(cid:48)Γs−(X (cid:48)X)−1X (cid:48)V, s). Note that (cid:107)Z ∗
i (cid:107)(cid:107)Xi(cid:107)2(cid:107)Vi(cid:107), (cid:107)Z ∗
i (cid:107)(cid:107)Xi(cid:107)3, (cid:107)Z ∗

i])−1Xi +DXi = Z ∗

i (cid:107)4, (cid:107)Z ∗

i (cid:107)3(cid:107)Vi(cid:107),
i (cid:107)(cid:107)Xi(cid:107)(cid:107)Vi(cid:107)2, (cid:107)Xi(cid:107)3(cid:107)Vi(cid:107), (cid:107)Xi(cid:107)2(cid:107)Vi(cid:107)2,

i +DXi, and ˜Yis =
i (cid:107)3(cid:107)Xi(cid:107), (cid:107)Z ∗

i Γs+Vis+X (cid:48)
i (cid:107)2(cid:107)Vi(cid:107)2, (cid:107)Z ∗

iΓs+Vis−X (cid:48)
i (cid:107)2(cid:107)Xi(cid:107)(cid:107)Vi(cid:107), (cid:107)Z ∗

(cid:107)Z ∗

i (cid:107)2(cid:107)Xi(cid:107)2, (cid:107)Z ∗

38

have ﬁnite 1 + δ/4 moments by the Cauchy-Schwarz inequality. By (A.35), (A.36), (A.37), the triangular

array WLLN and the CMT, for s, t = 1, . . . , d

n−1

n
(cid:88)

i=1

ZiZ (cid:48)
i

˜Yis ˜Yit = n−1

n
(cid:88)

i=1

(Z ∗

i + DXi)(Z ∗

i + DXi)(cid:48)(Z ∗(cid:48)

i Γs + Vis + X (cid:48)

i(D(cid:48)Γs − (X (cid:48)X)−1X (cid:48)V, s))

(Z ∗(cid:48)

i Γt + Vit + X (cid:48)

i(D(cid:48)Γt − (X (cid:48)X)−1X (cid:48)V, t))

n
(cid:88)

= n−1

Z ∗

i Z ∗(cid:48)

i (Z ∗(cid:48)

i Γs + Vis)(Z ∗(cid:48)

i Γt + Vit) + op(1)

i=1
i Z ∗(cid:48)

= EP [Z ∗

i (Z ∗(cid:48)

i Γs + Vis)(Z ∗(cid:48)

i Γt + Vit)] + op(1).

(A.38)

Similarly,

ˆCs = n−1

= n−1

= n−1

n
(cid:88)

i=1
n
(cid:88)

i=1
n
(cid:88)

i=1

and

ZiZ (cid:48)
i

˜Yis ˜ui(θ0)

(Z ∗

i + DXi)(Z ∗

i + DXi)(cid:48)(Z ∗(cid:48)

i Γs + Vis + X (cid:48)

i(D(cid:48)Γs − (X (cid:48)X)−1X (cid:48)V, s))(ui − X (cid:48)

i(X (cid:48)X)−1X (cid:48)u)

Z ∗

i Z ∗(cid:48)

i (Z ∗(cid:48)

i Γs + Vis)ui + op(1) = EP [Z ∗

i Z ∗(cid:48)

i (Z ∗(cid:48)

i Γs + Vis)ui] + op(1) = Cns + op(1),

(A.39)

(A.40)

n
(cid:88)

ˆΣ = n−1

ZiZ (cid:48)

i ˜ui(θ0)2 = n−1

n
(cid:88)

i=1

(Z ∗

i + DXi)(Z ∗

i + DXi)(cid:48)(ui − X (cid:48)

i(X (cid:48)X)−1X (cid:48)u)2

i=1
i Z ∗(cid:48)

i u2

= EP [Z ∗

i ] + op(1) = Σn + op(1) = h5,m + op(1).

By (A.38), (A.39), (A.40) and the CMT (see also the equations (27.73) and (27.74) of Andrews and Guggen-

berger (2019b))

ˆVa(θ0) = Vn,a + op(1) = h5 + op(1),

K( ˆVa(θ0)) = K(Vn,a) + op(1) = K(h5) + op(1),

( ˆΣ, K( ˆVa(θ0))) = (h5,m, K(h5)) + op(1),

Ω(cid:15)( ˆΣ, K( ˆVa(θ0))) = Ω(cid:15)(h5,m, K(h5)) + op(1) = Ω(cid:15)(h9) + op(1),

(A.41)

where the last equality holds by the continuity of the eigenvalue-adjusted matrix, see Andrews and Guggen-
berger (2019a), p.1717. To determine the limit of ˆVb(θ0) in (2.19), note that εi(θ0) = [˜ui(θ0), −Y (cid:48)
X (cid:48)

i(X (cid:48)X)−1X (cid:48)Y ](cid:48) and

i +

εi(θ0) −





01×k

−Γ (cid:48)



 Zi =





ui − u(cid:48)X(X (cid:48)X)−1Xi
−Vi + V (cid:48)X(X (cid:48)X)−1Xi


 = vi − U (cid:48)X(X (cid:48)X)−1Xi,

(A.42)

where vi ≡ [ui, −V (cid:48)

i ](cid:48) and U ≡ [u, −V ]. Letting ˜Q ≡ (Z (cid:48)Z)−1Z (cid:48)U , we have

ˆεin(θ0) − [0k×1, −Γ ](cid:48)Zi = ε(θ0)(cid:48)Z(Z (cid:48)Z)−1Zi − [0k×1, −Γ ](cid:48)Zi = ˜Q(cid:48)Zi.

(A.43)

39

Note here that ˜Q = Op(n−1/2) because n−1Z (cid:48)Z = n−1W (cid:48)W − n−1W (cid:48)X(X (cid:48)X)−1X (cid:48)W a.s.−→ Qzz which follows
from EP [Z ∗

xx Qxw ≡ Qzz, the WLLN and the CMT, and

i ] → Qww − QwxQ−1

i Z ∗(cid:48)

n−1/2Z (cid:48)U = n−1/2W (cid:48)U − n−1W (cid:48)X(n−1X (cid:48)X)−1n−1/2X (cid:48)U = Op(1)

which holds due to the triangular array CLT, the WLLN and the CMT. Rewrite

ˆVb(θ0) = n−1

= n−1

n
(cid:88)

(cid:26)

i=1
n
(cid:88)

(cid:26)

i=1

(εi(θ0) − ˆεin(θ0))(εi(θ0) − ˆεin(θ0))(cid:48)

(cid:27)

⊗ (ZiZ (cid:48)
i)

(εi(θ0) − [0k×1, −Γ ](cid:48)Zi)(εi(θ0) − [0k×1, −Γ ](cid:48)Zi)(cid:48)

(cid:27)

⊗ (ZiZ (cid:48)
i)

+ n−1

+ n−1

+ n−1

n
(cid:88)

(cid:26)

(cid:26)

(cid:26)

i=1
n
(cid:88)

i=1
n
(cid:88)

i=1

(εi(θ0) − [0k×1, −Γ ](cid:48)Zi)([0k×1, −Γ ](cid:48)Zi − ˆεin(θ0))(cid:48)

([0k×1, −Γ ](cid:48)Zi − ˆεin(θ0))(εi(θ0) − [0k×1, −Γ ](cid:48)Zi)(cid:48)

(cid:27)

(cid:27)

⊗ (ZiZ (cid:48)
i)

⊗ (ZiZ (cid:48)
i)

([0k×1, −Γ ](cid:48)Zi − ˆεin(θ0))([0k×1, −Γ ](cid:48)Zi − ˆεin(θ0))(cid:48)

(cid:27)

⊗ (ZiZ (cid:48)

i).

Using (A.42), the term (A.44) can be rewritten as

n−1

n
(cid:88)

(cid:26)

i=1

(εi(θ0) − [0k×1, −Γ ](cid:48)Zi)(εi(θ0) − [0k×1, −Γ ](cid:48)Zi)(cid:48)

(cid:27)

⊗ (ZiZ (cid:48)
i)

(A.44)

(A.45)

(A.46)

(A.47)

= n−1

= n−1

n
(cid:88)

i=1
n
(cid:88)

i=1

(vi − U (cid:48)X(X (cid:48)X)−1Xi)(vi − U (cid:48)X(X (cid:48)X)−1Xi)(cid:48) ⊗ (ZiZ (cid:48)
i)

(cid:18)

viv(cid:48)

i − U (cid:48)X(X (cid:48)X)−1Xiv(cid:48)

i − viX (cid:48)

i(X (cid:48)X)−1X (cid:48)U

+ U (cid:48)X(X (cid:48)X)−1XiX (cid:48)

i(X (cid:48)X)−1X (cid:48)U

(cid:19)

⊗ (ZiZ (cid:48)

i).

Let vij and vil denote the j and l-th elements of vi, j, l = 1, . . . , d + 1. By the Cauchy-Schwarz inequality
i(cid:107)1+δ/2] < ∞
i Z ∗(cid:48)
EP [(cid:107)vijvilZ ∗
and EP [(cid:107)vijvilZ ∗

i (cid:107)4+δ])1/2 < ∞. Similarly, EP [(cid:107)vijvilXiX (cid:48)

i(cid:107)1+δ/4] < ∞. Then, the WLLN and (A.35) yield

i (cid:107)1+δ/2] ≤ (EP [(cid:107)vi(cid:107)4+δ])1/2(EP [(cid:107)Z ∗

i X (cid:48)

n−1

n
(cid:88)

i=1

viv(cid:48)

i ⊗ (ZiZ (cid:48)

i) − EP [viv(cid:48)

i ⊗ (Z ∗

i Z ∗(cid:48)

i )]

= n−1

n
(cid:88)

i=1

viv(cid:48)

i ⊗ ((Z ∗

i + DXi)(Z ∗

i + DXi)(cid:48)) − EP [viv(cid:48)

i ⊗ (Z ∗

i Z ∗(cid:48)

i )]

p

−→ 0.

(A.48)

Using the Cauchy-Schwarz inequality again,

EP [(cid:107)XijvilZ ∗

i Z ∗(cid:48)

i (cid:107)1+δ/4] ≤ (EP [(cid:107)Z ∗

i (cid:107)4+δ])1/2(EP [X 4+δ

ij

])1/4(EP [(cid:107)vi(cid:107)4+δ])1/4 < ∞,

for j = 1, . . . , p and l = 1, . . . , d + 1. Similarly, EP [(cid:107)XijvilXiZ ∗(cid:48)

i (cid:107)1+δ/4] < ∞ and EP [(cid:107)XijvilXiX (cid:48)

i(cid:107)1+δ/4] <

∞. Therefore, by the WLLN and (A.35)

n−1

n
(cid:88)

i=1

XijvilZiZ (cid:48)

i − EP [XijvilZ ∗

i Z ∗(cid:48)
i ]

= n−1

n
(cid:88)

i=1

Xijvil(Z ∗

i + DXi)(Z ∗

i + DXi)(cid:48) − EP [XijvilZ ∗

i Z ∗(cid:48)
i ]

p

−→ 0,

40

and

n−1

n
(cid:88)

i=1

viX (cid:48)

i(X (cid:48)X)−1X (cid:48)U

p

−→ 0.

(A.49)

By the Cauchy-Schwarz inequality EP [(cid:107)XijXilZ ∗

i Z ∗(cid:48)

i (cid:107)1+δ/2] ≤ EP [(cid:107)Xi(cid:107)4+δ])1/2(EP [(cid:107)Z ∗

i (cid:107)4+δ])1/2 < ∞ and

similarly

EP [(cid:107)XijXilXiZ ∗(cid:48)

i (cid:107)1+δ/4] < ∞ and EP [(cid:107)XijXilXiX (cid:48)

i(cid:107)1+δ/2] < ∞.

Then, by the WLLN and (A.35)

n−1

n
(cid:88)

i=1

U (cid:48)X(X (cid:48)X)−1XiX (cid:48)

i(X (cid:48)X)−1X (cid:48)U ⊗ (ZiZ (cid:48)
i)

= n−1

n
(cid:88)

i=1

U (cid:48)X(X (cid:48)X)−1XiX (cid:48)

i(X (cid:48)X)−1X (cid:48)U ⊗ ((Z ∗

i + DXi)(Z ∗

i + DXi)(cid:48))

p

−→ 0.

(A.50)

Combining (A.48), (A.49) and (A.50), we obtain

n−1

n
(cid:88)

(cid:26)

i=1

(εi − [0k×1, −Γ ](cid:48)Zi)(εi − [0k×1, −Γ ](cid:48)Zi)(cid:48)

(cid:27)

⊗ (ZiZ (cid:48)

i) − EP [(viv(cid:48)

i) ⊗ (Z ∗

i Z ∗(cid:48)

i )]

p

−→ 0.

(A.51)

We consider the term in (A.45) next. Since by the Cauchy-Schwarz inequality

EP [(cid:107)vijZ ∗

ilZ ∗

i Z ∗(cid:48)

i (cid:107)1+δ/4] ≤ (EP [v4+δ

ij

])1/4(EP [Z ∗4+δ

il

])1/4(EP [(cid:107)Z ∗

i (cid:107)4+δ])1/2 < ∞,

EP [(cid:107)XijZ ∗

ilZ ∗

i Z ∗(cid:48)

i (cid:107)1+δ/4] ≤ (EP [X 4+δ

ij

])1/4(EP [Z ∗4+δ

il

])1/4(EP [(cid:107)Z ∗

i (cid:107)4+δ])1/2 < ∞

and the above moment bounds hold when Z ∗

i Z ∗(cid:48)
i

is replaced by XiZ ∗(cid:48)

i and XiX (cid:48)

i. Using ˜Q = Op(n−1/2),

(A.35), the WLLN and the CMT, the terms in (A.45) and (A.46) are op(1):

n−1

n
(cid:88)

(cid:26)

i=1

(εi − [0k×1, −Γ ](cid:48)Zi)([0k×1, −Γ ](cid:48)Zi − ˆεin)(cid:48)

(cid:27)

⊗ (ZiZ (cid:48)
i)

n
(cid:88)

i=1

= −n−1

p

−→ 0.

(vi(Z ∗

i + DXi)(cid:48) ˜Q − U (cid:48)X(X (cid:48)X)−1Xi(Z ∗

i + DXi)(cid:48) ˜Q) ⊗ ((Z ∗

i + DXi)(Z ∗

i + DXi)(cid:48))

(A.52)

Finally, consider the last term in (A.47). Since E[(cid:107)Z ∗

i Z ∗(cid:48)
i(cid:107)1+δ/4] < ∞, by (A.35) and the WLLN

ijZ ∗

ilZ ∗

∞, and E[(cid:107)Z ∗

ijZ ∗

ilXiX (cid:48)

i (cid:107)1+δ/4] ≤ E[(cid:107)Z ∗

i (cid:107)4+δ] < ∞, E[(cid:107)Z ∗

ijZ ∗

ilXiZ ∗(cid:48)

i (cid:107)1+δ/4] <

n−1

n
(cid:88)

(cid:26)

i=1

([0k×1, −Γ ](cid:48)Zi − ˆεin)([0k×1, −Γ ](cid:48)Zi − ˆεin)(cid:48)

(cid:27)

⊗ (ZiZ (cid:48)
i)

= n−1

n
(cid:88)

i=1

˜Q(cid:48)ZiZ (cid:48)
i

˜Q ⊗ (ZiZ (cid:48)

i) = n−1

n
(cid:88)

i=1

˜Q(cid:48)((Z ∗

i + DXi)(Z ∗

i + DXi)(cid:48)) ˜Q ⊗ ((Z ∗

i + DXi)(Z ∗

i + DXi)(cid:48))

p

−→ 0.

(A.53)

41

Therefore, (A.51), (A.52), (A.53) and the CMT together with the continuity of the eigenvalue-adjusted matrix

give

ˆVb(θ0) = Vn,b + op(1),

K( ˆVb(θ0)) = K(Vn,b) + op(1),

( ˆΣ, K( ˆVb(θ0))) = (h5,m, K(V)) + op(1) ≡ h9 + op(1),

Ω(cid:15)( ˆΣ, K( ˆVb(θ0))) = Ω(cid:15)(h9) + op(1).

(A.54)

Next we determine the limit of n1/2( ˆJ − Gn). Rewrite

n1/2( ˆGn − Gn) = n−1/2(n−1Z (cid:48)Y − EP [Z ∗

i Z ∗(cid:48)

i ]Γ )

= n−1/2Z (cid:48)ZΓ − n1/2 EP [Z ∗

i Z ∗(cid:48)

i ]Γ + n−1/2Z (cid:48)V

= n−1/2Z (cid:48)V + (n−1/2W (cid:48)W − n1/2 EP [WiW (cid:48)

i ])Γ

(cid:17)

(X (cid:48)X)−1X (cid:48)W Γ

−

(cid:16)
n−1/2W (cid:48)X − n1/2 EP [WiX (cid:48)
i]
i](n−1X (cid:48)X)−1 (cid:16)
(cid:16)

− EP [WiX (cid:48)

− EP [WiX (cid:48)
i]

n−1/2X (cid:48)W − n1/2 EP [WiX (cid:48)
i]
i])−1(cid:17)

n1/2(n−1X (cid:48)X)−1 − n1/2(EP [XiX (cid:48)

(cid:17)

Γ

EP [XiW (cid:48)

i ]Γ .

(A.55)

On noting that n−1/2Z (cid:48)V = n−1/2W (cid:48)V − n−1W (cid:48)X(n−1X (cid:48)X)−1X (cid:48)V = n−1/2Z ∗(cid:48)V + op(1), n−1/2Z (cid:48)u =
n−1/2W (cid:48)u − n−1W (cid:48)X(n−1X (cid:48)X)−1X (cid:48)u = n−1/2Z ∗(cid:48)u + op(1), by the multivariate triangular array Lyapunov

CLT













n1/2vec(n−1W (cid:48)W − EP [WiW (cid:48)
n1/2vec(n−1W (cid:48)X − EP [WiX (cid:48)
n1/2vec(n−1X (cid:48)X − EP [XiX (cid:48)
n−1/2vec(Z (cid:48)V )

i ])
i])
i])

n1/2vec(n−1W (cid:48)W − EP [WiW (cid:48)
n1/2vec(n−1W (cid:48)X − EP [WiX (cid:48)
n1/2vec(n−1X (cid:48)X − EP [XiX (cid:48)
n−1/2vec(Z ∗(cid:48)V )

i ])
i])
i])














=














n−1/2Z (cid:48)u

n−1/2Z ∗(cid:48)u














+ op(1)

d−→



























vec(Zww)

vec(Zwx)

vec(Zxx)

vec(Zzv)

Zzu

, (A.56)

where Z ∗ = W − X(EP [XiX (cid:48)

i])−1 EP [XiW (cid:48)

i ] and

Zww ≡ [Zww,1, . . . , Zww,k], Zww,j ∼ N [0, lim
n→∞

VarP [WiWij]],

j = 1, . . . , k,

Zwx ≡ [Zwx,1, . . . , Zwx,p], Zwx,l ∼ N [0, lim
n→∞

VarP [WiXil]],

l = 1, . . . , p,

Zxx ≡ [Zxx,1, . . . , Zxx,p], Zxx,s ∼ N [0, lim
n→∞

VarP [XiXis]],

s = 1, . . . , p,

Zzv ≡ [Zzw,1, . . . , Zzv,d], Zzv,r ∼ N [0, lim
n→∞

EP [Z ∗

i Z ∗(cid:48)

i V 2

ir]],

r = 1, . . . , d,

Zzu ∼ N [0, lim
n→∞

By the triangular array WLLN,

EP [Z ∗

i Z ∗(cid:48)

i u2

i ]].

n−1W (cid:48)W

p
−→ Qww, n−1W (cid:48)X

p
−→ Qwx, n−1X (cid:48)X

p

−→ Qxx.

(A.57)

Next we derive the asymptotic distribution of n1/2((n−1X (cid:48)X)−1 − (EP [XiX (cid:48)
i])−1). Let f : vec(A) →
vec(A−1), where A ∈ Rp×p is positive deﬁnite. The Jacobian of the mapping evaluated at vec(A) = vec(Qxx)

42

is ˙f = −(A−1)(cid:48) ⊗ A−1|A=Qxx = −Q−1
the delta method

xx ⊗ Q−1

xx . Since n1/2(vec(n−1X (cid:48)X) − vec(EP [XiX (cid:48)

i]))

d−→ vec(Zxx), by

n1/2((n−1X (cid:48)X)−1 − (EP [XiX (cid:48)

i])−1)

d−→ vec−1

p,p( ˙f vec(Zxx))

= −vec−1

p,p((Q−1

xx ⊗ Q−1

xx )vec(Zxx))

= −Q−1

xx ZxxQ−1
xx ,

(A.58)

where vec−1

(EP [XiX (cid:48)

p,p denotes the inverse vec operator with the property that vec−1
i])−1) = −Q−1

xx n1/2(n−1X (cid:48)X − EP [XiX (cid:48)

i])Q−1

xx + op(1) by (A.56) and (A.58), the convergence in

p,p(vec(A)) = A. Since n1/2((n−1X (cid:48)X)−1−

(A.58) holds jointly with (A.56). Using (A.56)-(A.58) in (A.55) and invoking the Slutsky’s lemma,

n1/2( ˆG − Gn)

d−→ Gh ≡ (Zww − ZwxQ−1

xx Qxw − QwxQ−1

xx Zxw + QwxQ−1

xx ZxxQ−1

xx Qxw)Γ + Zzv.

Then, from (A.39), (A.40), (A.56), (A.59) and the CMT

n1/2vec( ˆJ − Gn) = n−1/2

n
(cid:88)

i=1

vec(ZiY (cid:48)

i − EP [Z ∗

i Z ∗(cid:48)

i ]Γ ) − [ ˆC (cid:48)

1, . . . , ˆC (cid:48)

d](cid:48) ˆΣ−1n1/2 ˆm

= vec (cid:0)(Zww − ZwxQ−1

xx Qxw − QwxQ−1

xx Zxw + QwxQ−1

xx ZxxQ−1

xx Qxw)Γ + Zzv

− [C (cid:48)

P 1, . . . , C (cid:48)

P d](cid:48)Σ−1

= vec(Gh) − [C (cid:48)

P 1, . . . , C (cid:48)

P Zzu + op(1).

P Zzu + op(1),
P d](cid:48)Σ−1

A further result in Lemma 16.4 of Andrews and Guggenberger (2019b) is as follows:

n1/2[ ˆm, ˆJ − Gn, Hn ˆJUnTn] dπ

−→ [mh, Jh, ∆h],

where (Jh, ∆h) and mh are independent,





mh

vec(Jh)







 ∼ N

0k×(d+1),



h5,m 0k×dk

0k×dk

Φh







 , Φh ≡ lim
n→∞

(ΣG

n − C (cid:48)

nΣ−1

n Cn)

(A.59)

(cid:1)

(A.60)

(A.61)

whenever the limit exists, and

∆h ≡ [∆h,q, ∆h,d−q] ∈ Rk×d, ∆h,q ≡ h3,q ∈ Rk×q, ∆h,d−q ≡ h3

˜h1,d−q + h−1/2

5,m Jhh91h2,d−q ∈ Rk×(d−q),

˜h1,d−q ≡

diag(h1,q+1, . . . , h1,d)

,

h91 ≡ ((θ0, Id)Ω(cid:15)(h9)(θ0, Id)(cid:48))1/2, Ω = Ω(Σ, K(V)).

(A.62)








0q×(d−q)

0(k−d)×(d−q)








A.5 Asymptotic distributions of key permutation quantities

In this section, we derive the asymptotic distributions of key quantities that underlie the permutation test

statistics under the drifting sequence of parameters.

43

Conditioning events. We ﬁrst describe the events on which we condition when deriving the asymptotic
results for the permutation tests. From (A.60), for any (cid:15) > 0 we can ﬁnd a constant U0 and n0 ∈ N such

that for all n ≥ n0.

Ω1 ≡ {ω ∈ Ω0 : (cid:107)n1/2( ˆJ − Gn)(cid:107) < U0}, P [Ωc

1] < (cid:15)/2.

We shall establish that for PR ∈ {PAR1, PAR2, PLM, PCLRa, PCLRb} and all ω ∈ Ω1

|P π[PR ≤ x] − P [PR∞ ≤ x]|

p

−→ 0,

sup
x∈R

(A.63)

(A.64)

where PR∞ is the limiting random variable. When (A.64) holds, for any (cid:15), (cid:15)1 > 0, there exists n1 ∈ N
such that P [supx∈R |P π[PR ≤ x] − P [PR∞ ≤ x]| > (cid:15)1] ≤ (cid:15)/2 for all ω ∈ Ω1 and n ≥ n1. Then, by the
Boole-Bonferroni inequality, for all n ≥ max{n0, n1}

P [ω ∈ Ω0 : |P π[PR ≤ x] − P [PR∞ ≤ x]| > (cid:15)1]

≤ P [ω ∈ Ω1 : |P π[PR ≤ x] − P [PR∞ ≤ x]| > (cid:15)1] + P [Ωc
1]

≤ (cid:15).

Since (cid:15) > 0 is arbitrary, it will follow that

|P π[PR ≤ x] − P [PR∞ ≤ x]|

p

−→ 0.

sup
x∈R

(A.65)

(A.66)

This means that we can use the distributional results such as that in (A.60) in the conditioning events to

obtain the convergence in P π-distribution in P -probability.

The following lemma is a permutation analog of Lemma 16.4 (see also (A.61)) of Andrews and Guggen-

berger (2019b).

Lemma A.6. Under all sequences {λn ∈ Λ : n ≥ 1},

n1/2[ ˆmπ, ˆJ π − ˆG, Hn ˆJ πUnTn] dπ

−→ [mπ

h, J π

h , ∆π
h]

in P -probability,

where

(a)

(b)





mπ
h

vec(J π
h )







 ∼ N

0k×(d+1),



σ2Qzz

0k×dk

0k×dk

Φπ
h






 , Φπ

h ≡ (ΣV − ΣV u(σ2)−1ΣuV ) ⊗ Qzz,

∆π

h ≡ [∆π

h,d−q] ∈ Rk×d, ∆π

h,q ≡ h3,q ∈ Rk×q,

∆π

h,d−q ≡ h3

5,m (Gh + J π

h )h91h2,d−q ∈ Rk×(d−q),

h,q, ∆π
˜h1,d−q + h−1/2

where Gh is deﬁned in (A.59), and ˜h1,d−q and h91 are deﬁned in (A.62),

(c) (J π

h , ∆π

h) and mπ

h are independent,

44

(d) When Un ≡ Id (as opposed to UP ≡ (cid:0)(θ0, Id)Ω(cid:15)(ΣP , VP )−1(θ0, Id)(cid:48)(cid:1)1/2

deﬁned in Section A.3) with the

eigenvalues, the orthogonal eigenvectors and the SV’s of the matrices (A.5)-(A.7) deﬁned accordingly

as in Section A.3, the above results also hold with ∆π
h,d−q ≡ h3
Gh is as deﬁned in (A.59), and ˜h1,d−q is as deﬁned in (A.62),

˜h1,d−q + h−1/2

5,m (Gh + J π

h )h2,d−q where

(e) Under all subsequences {wn} and all sequences {λwn,n : n ≥ 1} ∈ Λ, the convergence results above hold

with n replaced with wn.

Proof of Lemma A.6. The proof is divided into three main steps. In the ﬁrst step, we prove the multivariate

normality of some key permutation quantities. In the second step, we prove the consistency of the covariance

matrix estimates. The ﬁnal step shows the desired result of the lemma.

Step 1: Multivariate normality. By the triangular array SLLN (Lemma A.2), n−1W (cid:48)W −EP [WiW (cid:48)
0, n−1X (cid:48)W − EP [XiW (cid:48)
EP [XiW (cid:48)

i] a.s.−→ 0, and by (A.23) EP [WiW (cid:48)

i ] a.s.−→ 0 and n−1X (cid:48)X − EP [XiX (cid:48)

i ] → Qxw, and EP [XiX (cid:48)

i] → Qxx. Thus,

i ] → Qww,

i ] a.s.−→

EP [Z ∗

i Z ∗(cid:48)

i ] → Qww − QwxQ−1

xx Qxw ≡ Qzz,

and by the CMT

n−1Z (cid:48)Z = n−1W (cid:48)W − n−1W (cid:48)X(X (cid:48)X)−1X (cid:48)W a.s.−→ Qzz.

(A.67)

(A.68)

s − n−1Z (cid:48)Z ˆΓs) = n1/2Z (cid:48) ˆVπ,s − ˆC π
Note that n1/2( ˆJ π
ˆVπ,s is the s-th column of ˆVπ. Next we will show that

s

ˆΣπn1/2 ˆmπ, s = 1, . . . , d, where ˆΓs = (Z (cid:48)Z)−1Z (cid:48)Y, s and



n−1/2Z (cid:48)Mι ˜uπ(θ0)


n−1/2vec(Z (cid:48)Mι ˆVπ)



dπ
−→





mπ
h
Gπ
h


 ∼ N [0, Σe ⊗ Qzz] P -almost surely.

(A.69)

Using the Cram´er-Wold device, it suﬃces to prove that for any [t(cid:48)

0, t(cid:48)

1, . . . , t(cid:48)

d](cid:48) with tl ∈ Rk, l = 0, . . . , d





t(cid:48)

n−1/2Z (cid:48)Mι ˜uπ(θ0)


n−1/2vec(Z (cid:48)Mι ˆVπ)

dπ
−→ N [0, t(cid:48) (Σe ⊗ Qzz) t] P -almost surely.

(A.70)

Rewrite

t(cid:48)



n−1/2Z (cid:48)Mι ˜uπ(θ0)

n−1/2vec(Z (cid:48)Mι ˆVπ)


 = n−1/2

n
(cid:88)

(cid:16)

0Zi ˜uπ(i)(θ0) + t(cid:48)
t(cid:48)

1Zi ˆVπ(i)1 + · · · + t(cid:48)

dZi ˆVπ(i)d

(cid:17)

= n−1/2

= n−1/2

i=1

n
(cid:88)

i=1
n
(cid:88)

i=1

i[t0, t1, . . . , td][˜uπ(i)(θ0), ˆVπ(i)1, . . . , ˆVπ(i)d](cid:48)
Z (cid:48)

Z (cid:48)

iζπ(i),

45

where ζi ≡ [t0, t1, . . . , td][˜ui(θ0), ˆVi1, . . . , ˆVid](cid:48), i = 1, . . . , n. We verify the condition (A.2) of Lemma A.1 with
cn(i, j) ≡ n−1/2Z (cid:48)

iζj. Since

(cid:34)

EP π

n−1/2

n
(cid:88)

i=1

t(cid:48)
0Zi ˜uπ(i)(θ0)|y, Y, W, X

(cid:35)

(cid:35)

(cid:32)

= n1/2

n−1

(cid:32)

0Zi ˆVπ(i)l|y, Y, W, X
t(cid:48)

= n1/2

n−1

(cid:34)

EP π

n−1/2

n
(cid:88)

i=1

we have

(cid:34)

EP π

n−1/2

n
(cid:88)

i=1

t(cid:48)
0Zi ˜uπ(i)(θ0)|y, Y, W, X

(cid:35)

(cid:35)

(cid:32)

= n1/2

n−1

(cid:32)

0Zi ˆVπ(i)l|y, Y, W, X
t(cid:48)

= n1/2

n−1

(cid:34)

EP π

n−1/2

n
(cid:88)

i=1

(cid:33) (cid:32)

t(cid:48)
0Zi

n−1

(cid:33) (cid:32)

t(cid:48)
0Zi

n−1

(cid:33) (cid:32)

t(cid:48)
0Zi

n−1

(cid:33) (cid:32)

t(cid:48)
0Zi

n−1

n
(cid:88)

i=1
n
(cid:88)

i=1

n
(cid:88)

i=1
n
(cid:88)

i=1

n
(cid:88)

i=1
n
(cid:88)

i=1

n
(cid:88)

i=1
n
(cid:88)

i=1

(cid:33)

˜ui(θ0)

= 0,

(cid:33)

ˆVil

= 0,

l = 1, . . . , d,

(cid:33)

˜ui(θ0)

= 0,

(cid:33)

ˆVil

= 0,

l = 1, . . . , d,

and gn(i, j) = cn(i, j) in Lemma A.1. Next we will show that

n−1˜e(cid:48)˜e = n−1

n
(cid:88)

i=1

˜ei˜e(cid:48)

i = n−1

or equivalently





˜u(θ0)(cid:48) ˜u(θ0)
ˆV (cid:48) ˜u(θ0)

n−1 ˆV (cid:48) ˆV a.s.−→ ΣV ,

n−1 ˆV ˜u(θ0) a.s.−→ ΣV u,

n−1

n
(cid:88)

i=1

˜ui(θ0)2 a.s.−→ σ2.





˜u(θ0)(cid:48) ˆV
ˆV (cid:48) ˆV

a.s.−→ Σe,

(A.71)

(A.72)

(A.73)

(A.74)

By the SLLN (Lemma A.2), n−1W (cid:48)V − EP [WiV (cid:48)
Combining these with n−1W (cid:48)X a.s.−→ Qwx and n−1X (cid:48)X a.s.−→ Qxx, and using the CMT,

i ] a.s.−→ 0, hence n−1W (cid:48)V a.s.−→ 0 and similarly n−1X (cid:48)V a.s.−→ 0.

n−1Z (cid:48)V = n−1W (cid:48)V − n−1W (cid:48)X(n−1X (cid:48)X)−1n−1X (cid:48)V a.s.−→ 0.

(A.75)

Thus, on noting that ˆV = Y − Z ˆΓ − X ˆξ = (In − PZ − PX )V , by the SLLN and CMT

n−1 ˆV (cid:48) ˆV − EP [ViV (cid:48)

i ] = n−1V (cid:48)V − n−1V (cid:48)PZV − n−1V (cid:48)PX V − EP [ViV (cid:48)

i ] a.s.−→ 0

i ] → ΣV , we have n−1 ˆV (cid:48) ˆV a.s.−→ ΣV which veriﬁes (A.72). Analogously to (A.75), n−1Z (cid:48)u a.s.−→ 0

and EP [ViV (cid:48)
and n−1X (cid:48)u a.s.−→ 0. Then, (A.73) follows using (A.68) and on noting that

n−1 ˆV ˜u(θ0) − EP [Viui] = n−1V (cid:48) ˜u(θ0) − n−1V (cid:48)PZ ˜u(θ0) − n−1V (cid:48)PX ˜u(θ0) − EP [Viui]

= n−1V (cid:48)u − n−1V (cid:48)X(X (cid:48)X)−1X (cid:48)u − EP [Viui] − n−1V (cid:48)Z(Z (cid:48)Z)−1Z (cid:48)u

a.s.−→ 0,

46

and EP [Viui] → ΣV u. (A.74) holds because n−1 (cid:80)n
0 by the SLLN and CMT, and σ2

i=1 ˜ui(θ0)2−EP [u2
i ] → σ2. Furthermore, note that

n ≡ EP [u2

i ] = n−1u(cid:48)u−EP [u2

i ]−n−1u(cid:48)X(X (cid:48)X)−1X (cid:48)u a.s.−→

ˆD ≡

1
n − 1

n
(cid:88)

n
(cid:88)

g2
n(i, j)

i=1

j=1
n
(cid:88)

n
(cid:88)

iZjZ (cid:48)
ζ (cid:48)

jζi

=

1
n(n − 1)

=

1
n − 1

=

=

=

=

1
n − 1

1
n − 1

1
n − 1

1
n − 1

n
(cid:88)

i=1

n
(cid:88)

i=1
n
(cid:88)

i=1
n
(cid:88)

i=1
n
(cid:88)

i=1

i=1

j=1

n−1

ζ (cid:48)
i



ZjZ (cid:48)
j

 ζi

n
(cid:88)

j=1

ζ (cid:48)
i(Qzz + oa.s.(1))ζi

ζ (cid:48)
iQzzζi +

1
n − 1

n
(cid:88)

i=1

ζ (cid:48)
iζioa.s.(1)

t(cid:48)(˜ei ⊗ Ik)Qzz(˜e(cid:48)

i ⊗ Ik)t +

1
n − 1

n
(cid:88)

i=1

ζ (cid:48)
iζioa.s.(1)

t(cid:48)(˜ei˜e(cid:48)

i ⊗ Qzz)t + oa.s.(1)

= t(cid:48)(Σe ⊗ Qzz)t + oa.s.(1),

(A.76)

where the third equality follows from (A.68), the second to the last equality uses (A.71) and the fact that
n−1 (cid:80)n
i ⊗ Ik)t a.s.−→ t(cid:48)(Σe ⊗ Ik)t which follows from (A.71) and the Slutsky’s lemma.

iζi = n−1 (cid:80)n

i=1 t(cid:48)(˜ei˜e(cid:48)

i=1 ζ (cid:48)

By the triangular array SLLN,

n−1

n−1

n
(cid:88)

i=1
n
(cid:88)

i=1

(cid:107)Vi(cid:107)2+δ = Oa.s.(1), n−1

n
(cid:88)

i=1

(cid:107)Xi(cid:107)2+δ = Oa.s.(1), n−1

n
(cid:88)

i=1

(cid:107)Wi(cid:107)2+δ = Oa.s.(1),

(A.77)

(cid:32)

(cid:107)Zi(cid:107)2+δ ≤ 21+δ

n−1

n
(cid:88)

i=1

(cid:107)Wi(cid:107)2+δ + (cid:107)Xi(cid:107)1+δ(cid:107)(X (cid:48)X)−1X (cid:48)W (cid:107)2+δ

= Oa.s.(1).

(A.78)

(cid:33)

By the cr inequality and the triangular array SLLN,

n−1

n
(cid:88)

i=1

|˜ui(θ0)|2+δ ≤ 21+δn−1

n
(cid:88)

i=1

|ui|2+δ + 21+δn−1

n
(cid:88)

i=1

(cid:107)Xi(cid:107)2+δ(cid:107)(X (cid:48)X)−1X (cid:48)u(cid:107)2+δ

= Oa.s.(1).

(A.79)

Since ˆV = (In − PZ − PX )V , ˆVi = Vi − Z (cid:48)
i(Z (cid:48)Z)−1Z (cid:48)V − X (cid:48)
with the function f (x) = x2+δ, x > 0), (A.77) and (A.78)

i(X (cid:48)X)−1X (cid:48)V , and by Jensen’s inequality (applied

n−1

n
(cid:88)

i=1

(cid:107) ˆVi(cid:107)2+δ ≤ 31+δ

(cid:18)

n−1

n
(cid:88)

i=1

(cid:107)Vi(cid:107)2+δ + n−1

n
(cid:88)

i=1

(cid:107)Zi(cid:107)2+δ(cid:107)(n−1Z (cid:48)Z)−1n−1Z (cid:48)V (cid:107)2+δ

+ n−1

n
(cid:88)

i=1

(cid:107)Xi(cid:107)2+δ(cid:107)(n−1X (cid:48)X)−1n−1X (cid:48)V (cid:107)2+δ

(cid:19)

= Oa.s.(1).

(A.80)

47

By the cr inequality, (A.79) and (A.80)

n−1

n
(cid:88)

i=1

(cid:107)ζi(cid:107)2+δ ≤ 21+δ(cid:107)t0(cid:107)2+δn−1

n
(cid:88)

i=1

= Oa.s.(1).

|˜ui(θ0)|2+δ + 21+δ(cid:107)[t1, . . . , td](cid:107)2+δn−1

n
(cid:88)

i=1

(cid:107) ˆVi(cid:107)2+δ

We show that for ˆD deﬁned in (A.76) and any (cid:15) > 0

lim
n→∞

n−2

n
(cid:88)

n
(cid:88)

i=1

j=1

iζj|2
|Z (cid:48)
ˆD

1

(cid:18) n−1|Z (cid:48)
ˆD

iζj|2

(cid:19)

> (cid:15)2

= 0.

Note that

n−2

n
(cid:88)

n
(cid:88)

i=1

j=1

iζj|2
|Z (cid:48)
ˆD

1

(cid:18) n−2|Z (cid:48)
ˆD

iζj|2

(cid:19)

> (cid:15)2

= n−2 ˆD−1

n
(cid:88)

n
(cid:88)

i=1

j=1

iζj|2+δ
|Z (cid:48)
iζj|δ 1
|Z (cid:48)

(cid:16)

iζj|δ > (cid:15)δ ˆDδ/2nδ/2(cid:17)

|Z (cid:48)

≤ n−δ/2(cid:15)−δ ˆD−1−δ/2n−2

n
(cid:88)

n
(cid:88)

|Z (cid:48)

iζj|2+δ

j=1

(cid:107)Zi(cid:107)2+δn−1

i=1
n
(cid:88)

i=1

n
(cid:88)

i=1

(cid:107)ζi(cid:107)2+δ

≤ n−δ/2(cid:15)−δ ˆD−1−δ/2n−1

a.s.−→ 0,

(A.81)

(A.82)

(A.83)

where the convergence uses (A.78) and (A.81). Thus, the Lindeberg-type condition in (A.2) is satisﬁed.

Lemma A.1 and (A.76) yield (A.70).

Step 2: Consistency of the covariance matrix estimates. Next we determine the limits of
s , s = 1, . . . , d, and ˆΣπ. Note ﬁrst that by Lemma S.3.4 of DiCiccio and Romano (2017) (see also Hoeﬀding
ˆC π
(1951)),

EP π [ ˆΣπ|y, Y, W, X] = EP π

n−1

(cid:34)

ZiZ (cid:48)

i ˜uπ(i)(θ0)2|y, Y, W, X

(cid:35)

n
(cid:88)

i=1

= (n−1Z (cid:48)Z)(n−1

n
(cid:88)

i=1

˜ui(θ0)2) a.s.−→ σ2Qzz,

(A.84)

p

−→ 0 and

where the convergence follows from the CMT, (A.68) and (A.74). On noting that n−1X (cid:48)u
n−1 (cid:80)n

−→ 0, by Minkowski’s inequality, the triangular array WLLN and the CMT,

p

i=1 u4

i − EP [u4
i ]

n−1

n
(cid:88)

i=1

(cid:107)Zi(cid:107)4 = n−1

n
(cid:88)

(cid:107)Wi − W (cid:48)X(X (cid:48)X)−1Xi(cid:107)4

i=1
n
(cid:88)

≤ 8n−1

i=1

= Op(1),

(cid:107)Wi(cid:107)4 + (cid:107)W (cid:48)X(X (cid:48)X)−1(cid:107)48n−1

n
(cid:88)

i=1

(cid:107)Xi(cid:107)4

n−1

n
(cid:88)

i=1

˜ui(θ0)4 ≤ 8n−1

n
(cid:88)

i=1

i + 8n−1
u4

n
(cid:88)

i=1

(cid:107)Xi(cid:107)4(cid:107)(X (cid:48)X)−1X (cid:48)u(cid:107)4 = Op(1),

(A.85)

(A.86)

hence

n−1

n
(cid:88)

i=1

Z 2

ijZ 2

il ≤

(cid:32)

n−1

n
(cid:88)

i=1

Z 4
ij

(cid:33)1/2

n
(cid:88)

i=1

Z 4
il

(cid:33)1/2 (cid:32)

n−1

48

= Op(1)

j, l = 1, . . . , k.

(A.87)

Therefore, letting ˆΣπ

jl denote the (j, l), j, l = 1, . . . , k, element of ˆΣπ, (A.86) and (A.87) give

VarP π [ ˆΣπ

jl|y, Y, W, X] = VarP π

=

≤

1
n − 1

1
n − 1

p

−→ 0,

(cid:34)
n−1

n
(cid:88)

(cid:32)

n−1

(cid:32)

n−1

i=1
n
(cid:88)

i=1
n
(cid:88)

i=1

ZijZil ˜uπ(i)(θ0)2|y, Y, W, X

(cid:35)

Z 2

ijZ 2

il − (n−1

(cid:33) (cid:32)

Z 2

ijZ 2
il

n−1

(cid:33) (cid:32)

ZijZil)2

n−1

n
(cid:88)

i=1

(cid:33)

˜ui(θ0)4

n
(cid:88)

i=1
n
(cid:88)

i=1

˜ui(θ0)4 − (n−1

(cid:33)

˜ui(θ0)2)2

n
(cid:88)

i=1

(A.88)

where the second equality follows from Lemma S.3.4 of DiCiccio and Romano (2017). Combining (A.84) and
(A.88), and using Chebyshev’s inequality, P π[| ˆΣπ
0. Thus ˆΣπ − EP π [ ˆΣπ|y, Y, W, X]
inequality, (cid:107) ˆΣπ −σ2Qzz(cid:107) ≤ (cid:107) EP π [ ˆΣπ|y, Y, W, X]−σ2Qzz(cid:107)+(cid:107) ˆΣπ −EP π [ ˆΣπ|y, Y, W, X](cid:107)

pπ
−→ 0 in P -probability. Combining this with (A.84) and using the triangle

jl − EP π [ ˆΣjl|y, Y, W, X]| > (cid:15)] ≤ VarP π [ ˆΣπ

pπ
−→ 0 in P -probability,

jl|y, Y, W, X]/(cid:15)2

p
−→

hence

n−1

n
(cid:88)

i=1

ZiZ (cid:48)

i ˜uπ(i)(θ0)2 pπ

−→ σ2Qzz

in P -probability.

(A.89)

Furthermore, by (A.68), (A.73) and the CMT, for s = 1, . . . , d

EP π [ ˆC π

s |y, Y, W, X] = EP π

(cid:34)
n−1

n
(cid:88)

i=1

ZiZ (cid:48)
i

ˆVπ(i)s ˜uπ(i)(θ0)|y, Y, W, X

= (n−1Z (cid:48)Z)(n−1

(cid:35)

n
(cid:88)

i=1

ˆVis ˜ui(θ0)) a.s.−→ QzzΣV u

s

,

(A.90)

denotes the s-th element of ΣV u. Since ˆVi = Vi − Z (cid:48)

where ΣV u
Minkowski’s inequality twice and using n−1 (cid:80)n

s

i=1 (cid:107)Vi(cid:107)4 = Op(1) and n−1 (cid:80)n

i(Z (cid:48)Z)−1Z (cid:48)V − X (cid:48)

i(X (cid:48)X)−1X (cid:48)V , applying
i=1 (cid:107)Xi(cid:107)4 = Op(1) which hold

by the triangular array WLLN,

n−1

n
(cid:88)

i=1

(cid:107) ˆVi(cid:107)4 ≤ 8n−1

n
(cid:88)

i=1

(cid:107)Vi(cid:107)4 + 64n−1

n
(cid:88)

i=1

(cid:107)Zi(cid:107)4(cid:107)(n−1Z (cid:48)Z)−1n−1Z (cid:48)V (cid:107)4

+ 64n−1

n
(cid:88)

i=1

(cid:107)Xi(cid:107)4(cid:107)(n−1X (cid:48)X)−1n−1X (cid:48)V (cid:107)4 = Op(1).

(A.91)

Then,

VarP π [ ˆC π
s |y, Y, W, X]
(cid:34)

n
(cid:88)

= VarP π

n−1

ZijZil ˆVπ(i)s ˜uπ(i)(θ0)|y, Y, W, X

(cid:35)


n−1

i=1

n
(cid:88)

i=1

=

1
n − 1

p

−→ 0,

Z 2

ijZ 2

il −

(cid:32)

n−1

n
(cid:88)

i=1

(cid:33)2



n−1

ZijZil

(cid:32)

ˆV 2
is ˜ui(θ0)2 −

n−1

n
(cid:88)

i=1

ˆVis ˜ui(θ0)

(cid:33)2


n
(cid:88)

i=1

(A.92)

where the convergence follows from (A.68), (A.73), (A.87), and

n−1

n
(cid:88)

i=1

(cid:32)

ˆV 2
is ˜ui(θ0)2 ≤

n−1

n
(cid:88)

i=1

ˆV 4
is

(cid:33)1/2 (cid:32)

n−1

n
(cid:88)

i=1

(cid:33)1/2

˜ui(θ0)4

= Op(1),

(A.93)

49

which in turn holds by (A.86) and (A.91). Therefore, from (A.90), (A.92) and Chebyshev’s inequality

ˆC π

s = n−1

n
(cid:88)

i=1

ZiZ (cid:48)
i

ˆVπ(i) ˜uπ(i)(θ0)

pπ
−→ QzzΣV u

s

in P -probability.

(A.94)

Step 3: Completing the proof. Let Gπ

h = [Gπ

h,1, . . . , Gπ

h,d]. Using (A.69), (A.89) and (A.94) along

with the CMT, for s = 1, . . . , d

n1/2 ˆJ π

s − n−1/2Z (cid:48)Z ˆΓs
(cid:32)

= n−1/2Z (cid:48)Mι ˆVπ,s −

n−1

ZiZ (cid:48)
i

ˆVπ(i)s ˜uπ(i)(θ0)

n−1

(cid:33) (cid:32)

n
(cid:88)

i=1

n
(cid:88)

i=1

(cid:33)−1

ZiZ (cid:48)

i ˜uπ(i)(θ0)2

n−1/2Z (cid:48) ˜uπ(θ0)

dπ
−→ Gπ

h,s − ΣV u

s

(σ2)−1mπ
h

in P -probability.

(A.95)

This proves the part (a). Next we determine the limit of Hn ˆJ πUnTn following Andrews and Guggenberger

(2019b). Write

n1/2Hn ˆJ πUnTn = n1/2HnGnUnTn + n1/2Hn( ˆG − Gn)UnTn + n1/2Hn( ˆJ π − ˆG)UnTn.

(A.96)

Using (A.26), (A.27), (A.28), (A.29), (A.32) and the SVD HnGnUn = AnΥnB(cid:48)

n, the ﬁrst term on the

right-hand side of the equation (A.96) can be expressed as

n1/2HnGnUnTn = n1/2HnGnUnBnSn

= n1/2HnGnUn(Bn,q, Bn,d−q)





Υ−1

n,qn−1/2
0(d−q)×q





0q×(d−q)

Id−q

= [HnGnUnBn,qΥ−1

n,q, n1/2HnGnUnBn,d−q]

= [AnΥnB(cid:48)

nBn,qΥ−1

n,q, n1/2HnGnUnBn,d−q]

= [An,q, n1/2HnGnUnBn,d−q],

(A.97)

where we used ΥnB(cid:48)

nBn,qΥ−1

n,q = ΥnB(cid:48)

nBn[Iq, 0q×(d−q)](cid:48)Υ−1

n,q = [Iq, 0q×(d−q)](cid:48). For the second sub-matrix in

(A.97),

n1/2HnGnUnBn,d−q = n1/2AnΥnB(cid:48)

nBn,d−q

= n1/2AnΥn[0(d−q)×q, Id−q](cid:48)

= An[0(d−q)×q, n1/2Υn,d−q, 0(d−q)×(k−d)](cid:48)

→ h3[0(d−q)×q, diag(h1,q+1, . . . , h1,d), 0(d−q)×(k−d)](cid:48)

= h3

˜h1,d−q,

(A.98)

where ˜h1,d−q is deﬁned in (A.62). Furthermore,

n1/2Hn( ˆG − Gn)UnTn = n1/2Hn( ˆG − Gn)UnBnSn

= n1/2Hn( ˆG − Gn)Un[Bn,q, Bn,d−q]





Υ−1

n,qn−1/2
0(d−q)×q





0q×(d−q)

Id−q

= [Hn( ˆG − Gn)UnBn,qΥ−1

n,q, n1/2Hn( ˆG − Gn)UnBn,d−q].

(A.99)

50

Using Hn → Σ−1/2, (A.59), Un → h91 where h91 is deﬁned in (A.62), Bn,q → h3,q, and n1/2τjn → ∞ for all

j ≤ q,

Hn( ˆG − Gn)UnBn,qΥ−1

n,q = Hnn1/2( ˆG − Gn)UnBn,q(n1/2Υn,q)−1 = op(1).

(A.100)

Since Bn,d−q → h2,d−q,

n1/2Hn( ˆG − Gn)UnBn,d−q

d−→ Σ−1/2Ghh91h2,d−q.

Using (A.100) and (A.101) in (A.99),

n1/2Hn( ˆG − Gn)UnTn

d−→ [0k×q, Σ−1/2Ghh91h2,d−q].

Moreover, rewrite the the third term on the right-hand side of the equation (A.96) as

n1/2Hn( ˆJ π − ˆG)UnTn = n1/2Hn( ˆJ π − ˆG)UnBnSn

= n1/2Hn( ˆJ π − ˆG)Un[Bn,q, Bn,d−q]





Υ−1

n,qn−1/2
0(d−q)×q





0q×(d−q)

Id−q

(A.101)

(A.102)

(A.103)

= [Hn( ˆJ π − ˆG)UnBn,qΥ−1

n,q, n1/2Hn( ˆJ π − ˆG)UnBn,d−q].

(A.104)

In addition, by the part (a) of Lemma A.6, n1/2( ˆJ π − ˆG) dπ

−→ J π

h in P -probability. Using an argument

analogous to those in (A.100) and (A.101) and Lemma A.3,

Hn( ˆJ π − ˆG)UnBn,qΥ−1

in P -probability,

n,q = opπ (1)
dπ
−→ Σ−1/2J π

n1/2Hn( ˆJ π − ˆG)UnBn,d−q

h h91h2,d−q

in P -probability.

(A.105)

(A.106)

Using (A.105) and (A.106) in (A.104),

n1/2Hn( ˆJ π − ˆG)UnTn

dπ
−→ [0k×q, Σ−1/2J π

h h91h2,d−q]

in P -probability.

(A.107)

Combining (A.97), (A.98), (A.102), (A.107), and using An,q → h3,q = ∆π

h,q and an argument similar to that

in (A.66) in (A.96), we obtain

n1/2Hn ˆJ πUnTn

dπ
−→ (∆h,q, h3

˜h1,d−q + Σ−1/2(Gh + J π

h )h91h2,d−q)

in P -probability.

This proves the part (b). Since ∆π

h,d−q is a deterministic function of J π
follows similarly to (c). The part (e) is also analogous to the parts above.

h , the part (c) follows. The part (d)

Deﬁne

ˆJ + ≡ [ ˆJ, ˆH −1 ˆΣπ−1/2 ˆmπ] ∈ Rk×(d+1),

 ∈ R(d+1)×(d+1), U +

ˆU + ≡

0d×1

ˆU









h+
91 ≡

01×d

01×d

1

1

h91

0d×1


 ∈ R(d+1)×(d+1), B+

n ≡

51







Un

0d×1

n ≡



01×d

1

1

Bn

0d×1

01×d


 ∈ R(d+1)×(d+1),


 ∈ R(d+1)×(d+1),

(A.108)

(A.109)

(A.110)

where h91 is as deﬁned in (A.62). Also, let

B+

n = [B+

n,q, B+

n,d+1−q], B+

n,q ∈ R(d+1)×q, B+

n,d+1−q ∈ R(d+1)×(d+1−q),

n ≡ [Gn, 0k×1] ∈ Rk×(d+1), Υ+
J +

n ≡ [Υn, 0k×1] ∈ Rk×(d+1),

n ≡ diag((n1/2τ1n)−1, . . . , (n1/2τqn)−1, 1, . . . , 1) =
S+

Let ˆκ+

1 ≥ · · · ≥ ˆκ+

d+1 ≥ 0 denote the eigenvalues of





Sn

0d×1

01×d

1


 ∈ R(d+1)×(d+1).

n ˆU +(cid:48) ˆJ +(cid:48) ˆH (cid:48) ˆH ˆJ + ˆU +.

(A.111)

Next we state a result analogous to Theorem 16.6 of Andrews and Guggenberger (2019b).

Theorem A.7 (Asymptotic distribution of the PCLR statistic). Under all sequences {λn,h : n ≥ 1} with

λn,h ∈ Λ,

PCLR dπ

−→ PCLR∞ ≡ Z π(cid:48)Z π − λmin

(cid:2)(∆h,d−q, Z π)(cid:48)h3,k−qh(cid:48)

3,k−q(∆h,d−q, Z π)(cid:3)

in P -probability,

where Z π ≡ (σ2Qzz)−1/2mπ
If q = d, PCLR∞ = Z π(cid:48)h3,dh(cid:48)

h ∼ N [0, Ik], and the convergence holds jointly with the convergence in Lemma A.6.
d. Under all subsequences {wn} and all sequences {λwn,h : n ≥ 1}

3,dZ π ∼ χ2

with λwn,h ∈ Λ, the above results hold with n replaced with wn.

Proof of Theorem A.7. By Lemma A.6, n1/2 ˆmπ dπ
ˆΣπ pπ

−→ σ2Qzz in P -probability. Thus, by Slutsky’s lemma

−→ mπ

h ∼ N [0k×1, σ2Qzz] in P -probability and by (A.89)

PAR2

dπ
−→ mπ(cid:48)

h (σ2Qzz)−1mπ

h = Z π(cid:48)Z π ∼ χ2
k

in P -probability.

(A.112)

By deﬁnition, ˆH ˆJ + ˆU + = [ ˆH ˆJ ˆU , ˆΣπ−1/2 ˆmπ]. As deﬁned in (A.111), the eigenvalues of n ˆU +(cid:48) ˆJ +(cid:48) ˆH (cid:48) ˆH ˆJ + ˆU +
are ˆκ+

1 , . . . , ˆκ+

d+1. Then,

d+1 = λmin[n( ˆH ˆJ ˆU , ˆΣπ−1/2 ˆmπ)(cid:48)( ˆH ˆJ ˆU , ˆΣπ−1/2 ˆmπ)] = λmin[n ˆU +(cid:48) ˆJ +(cid:48) ˆH (cid:48) ˆH ˆJ + ˆU +].
ˆκ+

Now premultiply the determinantal equation

|n ˆU +(cid:48) ˆJ +(cid:48) ˆH (cid:48) ˆH ˆJ + ˆU + − κId+1| = 0

by |S+(cid:48)

n B+(cid:48)

n U +(cid:48)

n ( ˆU +)−1(cid:48)| and postmultiply by |( ˆU +)−1U +

n B+

n S+

n | to obtain

|Q+(κ)| = 0, Q+(κ) ≡ nS+(cid:48)

n B+(cid:48)

n U +(cid:48)
n

ˆJ +(cid:48) ˆH (cid:48) ˆH ˆJ +U +

n B+

n S+

n − κS+(cid:48)

n B+(cid:48)

n U +(cid:48)

n ( ˆU +)−1(cid:48)( ˆU +)−1U +

n B+

n S+
n .

Since |S+

n |, |B+

n |, |U +

(A.113)
n | > 0 and | ˆU +| > 0 with P π-probability approaching 1 (wppa 1), the eigenvalues

{ˆκ+

j , 1 ≤ j ≤ d + 1} above also solve |Q+(κ)| = 0 wppa 1.
Letting Sn,q ≡ diag((n1/2τ1n)−1, . . . , (n1/2τqn)−1) = (n1/2Υn,q)−1 ∈ Rq×q,

B+

n S+

n = [B+

n,qSn,q, B+

n,d+1−q].

(A.114)

52

n B+

Thus, ˆH ˆJ +U +

n = [ ˆH ˆJ +U +

n B+
n S+
and by the SVD, HnJnUn = AnΥnB(cid:48)
Rk×q, An,k−q ∈ Rk×(k−q),

n,qSn,q, ˆH ˆJ +U +
n, where Υn = [diag(τ1n, . . . , τdn), 0d×(k−d)](cid:48). Since An = [An,q, An,k−q], An,q ∈

n,qSn,q = n1/2Hn ˆJUnBn,qSn,q,

n,d+1−q], n1/2Hn ˆJ +U +

n B+

n B+

n1/2 ˆH ˆJ +U +

n B+

n,qSn,q = n1/2 ˆHH −1
= n1/2 ˆHH −1

n Hn ˆJUnBn,qSn,q
n HnGnUnBn,qSn,q + n1/2 ˆHH −1

n Hn( ˆJ − Gn)UnBn,qSn,q

= ˆHH −1

n AnΥnB(cid:48)

nBn[Iq, 0q×(d−q)](cid:48)Υ−1

n,q + n1/2 ˆHH −1

n Hn( ˆJ − Gn)UnBn,q(n1/2Υn,q)−1

= An[Iq, 0q×(d−q)](cid:48) + opπ (1)

= An,q + opπ (1)
pπ
−→ h3,q = ∆h,q

in P -probability,

(A.115)

where the third equality holds by the deﬁnitions of Sn,q, Υn and Υn,q, the fourth equality holds by B(cid:48)
nBn = Id,
p
ˆJ − Gn = Op(n−1/2) (shown in (A.60)), ˆHH −1
−→ Ik which in turn holds by (A.40), Hn → Σ−1/2 and
n
the CMT, (cid:107)Hn(cid:107) < ∞, Un = O(1) by deﬁnition, Bn = O(1) by the orthogonality of Bn, and n1/2τjn → ∞

for all j ≤ q, and the convergence uses the deﬁnition of ∆h,q and Lemma A.3. Using (A.60), (A.98),
Bn,d−q → h2,d−q, Hn → h−1/2

5,m and Un → h91,

n1/2Hn ˆJUnBn,d−q = n1/2HnGnUnBn,d−q + n1/2Hn( ˆJ − Gn)UnBn,d−q

d−→ h3

˜h1,d−q + h−1/2

5,m Jhh91h2,d−q = ∆h,d−q.

(A.116)

Then, under H0 : θ = θ0, using (A.116) and an argument analogous to that in (A.65)

n1/2Hn ˆJ +U +

n B+

n,d+1−q = [n1/2Hn ˆJUn, Hn ˆH −1 ˆΣπ−1/2 ˆmπ]B+

n,d+1−q

= [n1/2Hn ˆJUnBn,d−q, n1/2Hn ˆH −1 ˆΣπ−1/2 ˆmπ]
dπ
−→ [∆h,d−q, Z π]

in P -probability,

where the convergence holds by Slutsky’s lemma, ˆΣπ−1/2 ˆmπ dπ

−→ Z π in P -probability, ˆHH −1
n

P -probability and (A.116). Deﬁne

ˆE+ =





E+

1 E+
2
E+
3

E+(cid:48)
2


 ≡ B+(cid:48)

n U +(cid:48)

n ( ˆU +)−1(cid:48)( ˆU +)−1U +

n B+

n − Id+1,

(A.117)

pπ
−→ Ik in

(A.118)

2 ∈ Rq×(d+1−q) and E+

1 ∈ Rq×q, E+
where E+
p
−→ 0 with Un positive deﬁnite, hence ( ˆU +)−1U +
ˆU − Un
n
n B+
with B+(cid:48)

n = Id+1, we have ˆE+ p

−→ 0(d+1)×(d+1) and by Lemma A.3

3 ∈ R(d+1−q)×(d+1−q). By the CMT, (A.41) and (A.54),
−→ Id+1. Using the CMT again in conjunction

p

ˆE+ pπ

−→ 0(d+1)×(d+1)

in P -probability.

(A.119)

Using (A.115), (A.117), (A.118) and the fact that ∆(cid:48)

h,q∆h,q = h(cid:48)

3,qh3,q = limn→∞ A(cid:48)

n,qAn,q = Iq in (A.113)

53

yields

Q+(κ)


=

=







nS(cid:48)

n,qU +(cid:48)
n,qB+(cid:48)
n
n,d+1−qU +(cid:48)
n

ˆJ +(cid:48) ˆH (cid:48) ˆH ˆJ +U +
ˆJ +(cid:48) ˆH (cid:48) ˆH ˆJ +U +

n B+
n B+

nS(cid:48)
n,qSn,q
n,qSn,q nB+(cid:48)

n,qU +(cid:48)
n,qB+(cid:48)
n
n,d+1−qU +(cid:48)
n

ˆJ +(cid:48) ˆH (cid:48) ˆH ˆJ +U +
ˆJ +(cid:48) ˆH (cid:48) ˆH ˆJ +U +

n B+
n B+

nB+(cid:48)

n,d+1−q

n,d+1−q


 − κS+(cid:48)

n ( ˆE+ + Id+1)S+

n

Iq + opπ (1) − κSn,qE+
n,d+1−qU +(cid:48)
n
n = B+

n,d+1−q and

If q = 0, B+

1 Sn,q − κS2
n,q

n1/2B+(cid:48)

ˆJ +(cid:48)HnAn,q + opπ (1) − κE+(cid:48)

2 Sn,q nB+(cid:48)

n1/2A(cid:48)
n,d+1−qU +(cid:48)
n

n,qHn ˆJ +U +
ˆJ +(cid:48)H (cid:48)

n B+

n,d+1−q + opπ (1) − κSn,qE+

nHn ˆJ +U +

n B+

n,d+1−q − κE+



 .

2
3 − κ

nB+(cid:48)
n

ˆU +(cid:48) ˆJ + ˆH (cid:48)
n

ˆHn ˆJ +
n

ˆU +B+

n )−1(cid:48)B+(cid:48)

n U +(cid:48)
n

ˆJ +(cid:48)H (cid:48)

n( ˆHH −1
n )(cid:48)

n )−1 ˆU +)(cid:48)(B+

n = nB+(cid:48)
( ˆHH −1

n ((U +
n )(Hn ˆJ +U +

n B+

n )(B+

n )−1((U +

n )−1 ˆU +)B+

n

where the convergence uses (A.117), (U +

dπ
−→ (∆h,d−q, (σ2Qzz)−1/2mπ
n )−1 ˆU + pπ

−→ Id+1 and ˆHH −1
n

h)(cid:48)(∆h,d−q, (σ2Qzz)−1/2mπ

h),

pπ
−→ Ik in P -probability. Using the

CMT in conjunction with the fact that the smallest eigenvalue of a matrix is a continuous function of the

matrix, and h3,k−qh(cid:48)

3,k−q = h(cid:48)

3h3 = Ik, we obtain the result stated in the theorem.

Next, we consider the case q ≥ 1. Using the formula of partioned matrix determinant and provided

Q+

1 (κ) is nonsingular, |Q+(κ)| = |Q+

1 (κ)||Q+

2 (κ)|, where

Q+

1 (κ) ≡ Iq + opπ (1) − κSn,qE+

Q+

2 (κ) ≡ nB+(cid:48)

n,d+1−qU +(cid:48)

n

ˆJ +(cid:48)H (cid:48)

− [n1/2B+(cid:48)

n,d+1−qU +(cid:48)
n B+

n,qHn ˆJ +U +

n

[n1/2A(cid:48)

n,q,

1 Sn,q − κS2
nHn ˆJ +U +
n,d+1−q − κE+
ˆJ +(cid:48)HnAn,q + opπ (1) − κE+(cid:48)

n B+

n,d+1−q + opπ (1) − κSn,qE+
2 ].

Moreover, by Lemma A.8 and E+

1 = opπ (1),

ˆκ+
j S2

n,q = opπ (1), ˆκ+

j Sn,qE+

1 Sn,q = opπ (1),

in P -probability. Thus,

3 − κId+1−q + opπ (1)

2 Sn,q](Iq + opπ (1) − κSn,qE+

1 Sn,q − κS2

n,q)−1

(A.120)

j = q + 1, . . . , d + 1,

(A.121)

Q+

1 (ˆκj) = Iq + opπ (1) − ˆκ+

j Sn,qE+

1 Sn,q − ˆκ+

j S2

n,q = Iq + opπ (1),

in P -probability, and so

|Q+

1 (ˆκj)| (cid:54)= 0,

j = q + 1, . . . , d + 1, wppa 1 in P -probability.

(A.122)

Furthermore,

E+

3 = opπ (1),

n1/2Hn ˆJ +U +

n B+

n,d+1−q = Opπ (1),

Sn,q = o(1),

E+

2 = opπ (1),

j E+(cid:48)
ˆκ+

2 Sn,q(Iq + opπ (1))Sn,qE+

2 = ˆκ+

j E+(cid:48)

2 S2

n,qE+

2 + ˆκ+

d+1E+(cid:48)

2 S2

n,qE+

2 opπ (1) = opπ (1),

54

(A.123)

(A.124)

(A.125)

(A.126)

(A.127)

where (A.123) and (A.126) follow from (A.119), (A.124) holds by (A.117), and (A.127) uses (A.121) and

(A.126). Therefore, using the results in the previous display

n,d+1−qU +(cid:48)

− [n1/2B+(cid:48)
(cid:20)
Id+1−q + E+

− ˆκ+
j

n

Q+

2 (ˆκ+

j ) = nB+(cid:48)

n,d+1−qU +(cid:48)

n

ˆJ +(cid:48)H (cid:48)

n B+

nHn ˆJ +U +
n,d+1−q + opπ (1)
ˆJ +(cid:48)HnAn,q + opπ (1)](Iq + opπ (1))[n1/2A(cid:48)

n,qHn ˆJ +U +

n B+

n,d+1−q + opπ (1)]

3 − (n1/2B+(cid:48)

n,d+1−qU +(cid:48)

n

ˆJ +(cid:48)HnAn,q + opπ (1))(Iq + opπ (1))Sn,qE+
2

− E+(cid:48)

2 S(cid:48)

n,q(Iq + opπ (1))(n1/2A(cid:48)

n,qHn ˆJ +U +

n B+

n,d+1−q + opπ (1)) + ˆκ+

j E+(cid:48)

2 Sn,q(Iq + opπ (1))Sn,qE+
2

(cid:21)

= nB+(cid:48)

n,d+1−qU +(cid:48)

n

ˆJ +(cid:48)H (cid:48)

− [n1/2B+(cid:48)

n,d+1−qU +(cid:48)

n

n B+

nHn ˆJ +U +
n,d+1−q + opπ (1)
ˆJ +(cid:48)HnAn,q + opπ (1)](Iq + opπ (1))[n1/2A(cid:48)

n,qHn ˆJ +U +

n B+

n,d+1−q + opπ (1)]

− ˆκ+

j (Id+1−q + opπ (1))
d+1−q − ˆκ+

= M +

j (Id+1−q + opπ (1)),

where

M +

d+1−q ≡ nB+(cid:48)

n,d+1−qU +(cid:48)

n

ˆJ +(cid:48)H (cid:48)

nh3,k−qh(cid:48)

3,k−qHn ˆJ +U +

n B+

n,d+1−q + opπ (1).

(A.128)

(A.129)

From (A.113), (A.122) and |Q+(κ)| = |Q+

2 (κ)|, |Q+
j (Id+1−q + opπ (1))| = 0, j =
q + 1, . . . , d + 1, wppa 1 in P -probability. Therefore, {ˆκj : j = q + 1, . . . , d + 1} are the d + 1 − q eigenvalues
of (Id+1−q + opπ (1))−1/2M +

d+1−q(Id+1−q + opπ (1))−1/2 wppa 1 in P -probability. Using (A.117) in (A.129),

d+1−q − ˆκ+

j )| = |M +

1 (κ)||Q+

2 (ˆκ+

(Id+1−q + opπ (1))−1/2M +

d+1−q(Id+1−q + opπ (1))−1/2 dπ

−→ (∆h,d−q, Z π)(cid:48)(∆h,d−q, Z π)

in P -probability.

(A.130)

On noting that the vector of eigenvalues of a matrix is continuous function of the matrix elements, invoking

the CMT yields the convergence in P π-distribution of {ˆκj : j = q + 1, . . . , d + 1} to the vector of eigenvalues
of (∆h,d−q, Z π)(cid:48)(∆h,d−q, Z π) in P -probability, and so

λmin[n ˆU +(cid:48) ˆJ +(cid:48) ˆH (cid:48) ˆH ˆJ + ˆU +] dπ

−→ λmin[(∆h,d−q, Z π)(cid:48)(∆h,d−q, Z π)]

in P -probability.

(A.131)

Combining (A.131) with (A.112) completes the proof of the asymptotic distribution of the PCLR statistic.

When q = d, U +

n B+

n,d+1−q = [01×d, 1](cid:48) and

n1/2Hn ˆJ +U +

n B+

n,d+1−q = n1/2Hn[ ˆJ, ˆH −1 ˆΣπ−1/2 ˆmπ][01×d, 1](cid:48) = n1/2Hn ˆH −1 ˆΣπ−1/2 ˆmπ dπ

−→ Z π

(A.132)

in P -probability. Therefore, using (A.132) in (A.129), (A.130) and (A.131) gives

λmin[n ˆU +(cid:48) ˆJ +(cid:48) ˆH (cid:48) ˆH ˆJ + ˆU +] dπ

−→ Z π(cid:48)h3,k−qh(cid:48)

3,k−qZ π ∼ χ2

k−d.

Since h3h(cid:48)

3 = Ik, PCLR∞ = Z π(cid:48)Z π − Z π(cid:48)h3,k−qh(cid:48)

d. The proof for subsequences
follows similarly. Also, the convergence holds jointly with Lemma A.6 because we only used the convergence
of the permutation quantity ˆS π ≡ n1/2 ˆΣπ−1/2 ˆmπ conditional on the convergence of other quantities computed
from the observed data e.g. n1/2( ˆJ − Gn) as shown in Lemma A.6.

3,k−qZ π = Z π(cid:48)h3,dh(cid:48)

3,dZ π ∼ χ2

55

The following lemma is a permutation analog of Lemma 26.1 of Andrews and Guggenberger (2019b).

Lemma A.8 (Rates of convergence of sample eigenvalues). Under all sequences {λn,h : n ≥ 1} with λn,h ∈ Λ

and q ≥ 1,

(a) ˆκ+
j

pπ
−→ ∞ in P -probability for all j ≤ q,

(b) ˆκ+

j = opπ ((n1/2τln)2) in P -probability for all l ≤ q and j = q + 1, . . . , d + 1,

Under all subsequences {wn} and all sequences {λwn,h : n ≥ 1} with λwn,h ∈ Λ, the same results hold with n

replaced with wn.

The proof of Lemma A.8 is essentially the same as the proofs of Lemma 26.1 of Andrews and Guggen-

berger (2019b) and Lemma 17.1 of Andrews and Guggenberger (2017b) with only minor (mostly notational)

modiﬁcations. For completeness, we reproduce the arguments but defer the proof to Section A.8.

A.6 Asymptotic similarity

Proof of Theorem 2.2. The (uniform) asymptotic similarity of the permutation tests are established using

Proposition 16.3 of Andrews and Guggenberger (2019b).

PAR1 test: Let ¯W = [ ¯W1, . . . , ¯Wn](cid:48) ≡ MιW . Since ι is a column of X, MιMX = MX . Write

W (cid:48)

πMX ˜ΣuMX Wπ = W (cid:48)

πMι ˜ΣuMιWπ − W (cid:48)

πMιX(X (cid:48)X)−1X (cid:48) ˜ΣuMιWπ − W (cid:48)

πMι ˜ΣuX(X (cid:48)X)−1X (cid:48)MιWπ

+ W (cid:48)

πMιX(X (cid:48)X)−1X (cid:48) ˜ΣuX(X (cid:48)X)−1X (cid:48)MιWπ.

(A.133)

Consider the ﬁrst term n−1W (cid:48)

πMι ˜ΣuMιWπ = n−1 ¯W (cid:48)

π

˜Σu ¯Wπ = n−1 (cid:80)n

i=1

¯Wπ(i)

¯W (cid:48)

side of the expression above. Proceeding similarly to (A.89) and noting that VarP [Wi] − (Qww − QwQ(cid:48)

π(i) ˜ui(θ0)2 on the right-hand
w) → 0,

where Qw denotes the column of Qwx corresponding to the element 1 of Xi for Qww and Qwx deﬁned in

(A.23), we obtain

n−1

n
(cid:88)

i=1

¯Wπ(i)

¯W (cid:48)

π(i) ˜ui(θ0)2 − (Qww − QwQ(cid:48)

w)σ2 pπ

−→ 0

in P -probability.

(A.134)

Next we determine the limit of n−1W (cid:48)
Wij − ¯Wj, ¯Wj ≡ n−1 (cid:80)n

i=1 Wij, and ¯Xi = [ ¯Xi1, . . . , ¯Xip](cid:48),
(cid:33) (cid:32)
(cid:32)

n
(cid:88)

EP π [n−1W (cid:48)

πMιX|y, Y, W, X] =

n−1

¯Wi

n−1

(cid:33)

n
(cid:88)

¯Xi

= 0,

πMιX. Note that letting [ ¯X1, . . . , ¯Xn](cid:48) ≡ MιX, ¯Wi = [ ¯Wi1, . . . , ¯Wik](cid:48), ¯Wij =

VarP π

(cid:34)
n−1

n
(cid:88)

i=1

¯Wπ(i)j

¯Xil|y, Y, W, X

=

(cid:35)

i=1
(cid:32)

n−1

n
(cid:88)

i=1

1
n − 1

i=1
(cid:33) (cid:32)

¯W 2
ij

n−1

(cid:33)

¯X 2
il

n
(cid:88)

i=1

→ 0,

j = 1, . . . , k, l = 1, . . . , p,

where the convergence uses n−1 (cid:80)n
il] −
(EP [Xil])2) a.s.−→ 0, which, in turn, hold by the triangular array SLLN and the CMT. By Chebyshev’s inequal-
ity, we obtain

ij] − (EP [Wij])2) a.s.−→ 0 and n−1 (cid:80)n

ij − (EP [W 2

il − (EP [X 2

¯W 2

¯X 2

i=1

i=1

n−1W (cid:48)

πMιX

pπ
−→ 0

a.s.

(A.135)

56

Consider the part n−1X (cid:48) ˜ΣuMιWπ = n−1 (cid:80)n
Cauchy-Schwarz inequality twice,

i=1 Xi ¯W (cid:48)

π(i) ˜ui(θ0)2 in the second term of (A.133). Using the

(cid:107)n−1X (cid:48) ˜ΣuMιWπ(cid:107) ≤

n−1

(cid:32)

n
(cid:88)

i=1

(cid:107)Xi(cid:107)4

(cid:33)1/4 (cid:32)

n−1

n
(cid:88)

i=1

(cid:107) ¯Wi(cid:107)4

(cid:33)1/4 (cid:32) n
(cid:88)

i=1

(cid:33)1/2

˜ui(θ0)4

= Op(1),

(A.136)

i=1 (cid:107)Xi(cid:107)4 = Op(1) and (cid:80)n

where we used (cid:80)n
triangular array WLLN, and (A.86). Furthermore, note that n−1 (cid:80)n
and n−1 (cid:80)n
i=1 XijXilXiX (cid:48)
(EP [(cid:107)Xi(cid:107)4+δ])1/2(EP [u4+δ

i − EP [XijXiluiX (cid:48)
i]
p
i(cid:107)1+ δ
−→ 0, j, l = 1, . . . , p, by the WLLN, EP [(cid:107)XijXiluiX (cid:48)

i − EP [XijXilXiX (cid:48)
i]
])1/4(EP [(cid:107)Xi(cid:107)4+δ])1/4 < ∞ by the Cauchy-Schwarz inequality, and E[(cid:107)Xi(cid:107)4+δ] <

i=1(8(cid:107)Wi(cid:107)4 + 8(cid:107) ¯W (cid:107)4) = Op(1) which hold by the
p
−→ 0

i=1 (cid:107) ¯Wi(cid:107)4 ≤ (cid:80)n

i=1 XijXiluiX (cid:48)

4 ] ≤

i

∞. Therefore, we have

n−1X (cid:48) ˜ΣuX − EP [XiX (cid:48)

iu2

i ] = n−1

= n−1

n
(cid:88)

i=1
n
(cid:88)

i=1

XiX (cid:48)

i ˜ui(θ0)2 − EP [XiX (cid:48)

iu2
i ]

XiX (cid:48)

i(ui(θ0)2 − 2uiX (cid:48)

i(X (cid:48)X)−1X (cid:48)u + u(cid:48)X(X (cid:48)X)−1XiX (cid:48)

i(X (cid:48)X)−1X (cid:48)u)

− EP [XiX (cid:48)

iu2
i ]

p

−→ 0,

(A.137)

where the last line uses the WLLN, CMT, EP [(cid:107)XiX (cid:48)
0 and (X (cid:48)X)−1 − (EP [XiX (cid:48)

i (cid:107)1+δ/4] ≤ (EP [(cid:107)Xi(cid:107)4+δ])1/2(EP [u4+δ
−→ 0 which follow from the WLLN and the CMT. Using (A.134), (A.135),

])1/2, n−1X (cid:48)u

iu2

p

i

i])−1

p
−→

(A.136), (A.137), and the CMT in (A.133), we obtain

n−1W (cid:48)

πMX ˜ΣuMX Wπ − (Qww − QwQ(cid:48)

w)σ2

p
−→ 0

in P -probability.

(A.138)

Next, we determine the limit of n−1/2 ¯W (cid:48)

π ˜u(θ0). By the cr inequality and the triangular array SLLN,

n−1

n
(cid:88)

i=1

˜ui(θ0)2+δ − 21+δ EP [u2+δ

i

] ≤ 21+δ(n−1

n
(cid:88)

i=1

i − EP [u2+δ
u2+δ

i

] + n−1

n
(cid:88)

i=1

(cid:107)Xi(cid:107)2+δ(cid:107)(X (cid:48)X)−1X (cid:48)u(cid:107)2+δ)

a.s.−→ 0,

(A.139)

and for any t ∈ Rk

n−1

n
(cid:88)

i=1

(cid:107)t(cid:48) ¯Wi(cid:107)2+δ ≤ (cid:107)t(cid:107)2+δn−1

(cid:107) ¯Wi(cid:107)2+δ ≤ (cid:107)t(cid:107)2+δ21+δ

n−1

(cid:32)

n
(cid:88)

i=1

n
(cid:88)

i=1

(cid:107)Wi(cid:107)2+δ + (cid:107)n−1

(cid:33)

Wi(cid:107)2+δ

= Oa.s.(1),

n
(cid:88)

i=1

(A.140)

˜D ≡

1
n − 1

n
(cid:88)

n
(cid:88)

i=1

j=1

g2
n(i, j) =

1
n(n − 1)

n
(cid:88)

n
(cid:88)

i=1

j=1

(t(cid:48) ¯Wi ˜uj(θ0))2 =

1
n − 1

n
(cid:88)

i=1

˜ui(θ0)2n−1

n
(cid:88)

i=1

(t(cid:48) ¯Wi)2

= σ2t(cid:48) VarP [Wi]t + oa.s.(1).

(A.141)

57

Note that by (A.138), (A.140) and (A.141), for any (cid:15) > 0

n−2

n
(cid:88)

n
(cid:88)

i=1

j=1

= n−2 ˜D−1

(t(cid:48) ¯Wi ˜ui(θ0))2
˜D

1

(cid:18) n−1(t(cid:48) ¯Wi ˜ui(θ0))2
˜D

(cid:19)

> (cid:15)2

n
(cid:88)

n
(cid:88)

i=1

j=1

|t(cid:48) ¯Wi ˜ui(θ0)|2+δ
|t(cid:48) ¯Wi ˜ui(θ0)|δ
n
(cid:88)

n
(cid:88)

≤ n−δ/2(cid:15)−δ ˜D−1−δ/2n−2

|t(cid:48) ¯Wi ˜ui(θ0)|2+δ

(cid:16)

|t(cid:48) ¯Wi ˜ui(θ0)|δ > (cid:15)δ ˜Dδ/2nδ/2(cid:17)

1

j=1

(cid:107)t(cid:48) ¯Wi(cid:107)2+δn−1

i=1
n
(cid:88)

i=1

n
(cid:88)

i=1

|˜ui(θ0)|2+δ

≤ n−δ/2(cid:15)−δ ˜D−1−δ/2n−1

a.s.−→ 0.

Thus,

lim
n→∞

n−2

n
(cid:88)

n
(cid:88)

i=1

j=1

(t(cid:48) ¯Wi ˜ui(θ0))2
˜D

1

(cid:18) n−1(t(cid:48) ¯Wi ˜ui(θ0))2
˜D

(cid:19)

> (cid:15)2

= 0.

(A.142)

(A.143)

On noting that we may write n−1/2W (cid:48)
uniformly distributed over Gn, Lemma A.1 gives

πMX ˜u(θ0) = n−1/2 ¯W (cid:48)

π ˜u(θ0) = n−1/2 ¯W (cid:48) ˜u˜π(θ0) for a permutation ˜π

n−1/2t(cid:48) ¯W (cid:48)

π ˜u(θ0) dπ

−→ N [0, t(cid:48)(Qww − QwQ(cid:48)

w)tσ2] P -almost surely.

Using the Cram´er-Wold device

n−1/2 ¯W (cid:48)

π ˜u(θ0) dπ

−→ N [0, (Qww − QwQ(cid:48)

w)σ2] P -almost surely.

(A.144)

(A.145)

Finally, from the Slutsky’s lemma, (A.138), (A.145) followed by the Polya’s theorem (Theorem 11.2.9 of

Lehmann and Romano (2005)), we obtain PAR1

d−→ PAR1,∞ ∼ χ2

k in P -probability, and

| ˆF PAR1
n

(x) − P [χ2

k ≤ x]|

p

−→ 0.

sup
x∈R

The above result holds for any subsequence {wn} of {n}. Let r1−α(χ2
distribution. Since χ2

k) denote the 1 − α quantile of χ2
k
k distribution function is continuous and strictly increasing at its 1 − α quantile, we
k) by Lemma 11.2.1 of Lehmann and Romano (2005). By deﬁnition, EP [φPAR1
] =

p
−→ r1−α(χ2

n

have PAR1(r)
P [AR > PAR1(r)] + aPAR1P [AR = PAR1(r)], hence

P [AR > PAR1(r)] ≤ EP [φPAR1

n

] ≤ P [AR ≥ PAR1(r)].

By Theorem 16.6 of Andrews and Guggenberger (2019b), AR d−→ AR∞ ∼ χ2
11.2.3 of Lehmann and Romano (2005)), we have limn→∞ P [AR > PAR1(r)] = limn→∞ P [AR ≥ PAR1(r)] =
P [AR∞ > r1−α(χ2

k distribution function at its 1 − α quantile. Therefore,

k)] because of the continuity of the χ2

k. By Slutsky’s lemma (Corollary

lim
n→∞

EP [φPAR1
n

] = P [AR∞ > r1−α(χ2

k)] = α.

Thus, Assumption 3 is veriﬁed for the PAR1 statistic. By Proposition 16.3 of Andrews and Guggenberger

(2019b), we obtain the desired result.

58

PAR2 test: By (A.112), we have PAR2

dπ
−→ χ2

k in P -probability, and by the Polya’s theorem

| ˆF PAR2
n

(x) − P [χ2

k ≤ x]|

p

−→ 0.

sup
x∈R

The remaining argument is analogous to the PAR1 test.

PLM test: Note ﬁrst that because Σn and Tn are nonsingular

PLM = n ˆmπ(cid:48) ˆΣπ−1/2P ˆΣπ−1/2 ˆJ π

ˆΣπ−1/2 ˆmπ

= n ˆmπ(cid:48) ˆΣπ−1/2P( ˆΣπ−1/2Σ1/2

n )n1/2Σ−1/2

n

ˆΣπ−1/2 ˆmπ.

ˆJ πTn

dπ
−→ ∆π

n

ˆJ πTn

h = [∆π

By Lemma A.6(d), n1/2Σ−1/2
h,d−q] = [h3,q, h3
h5,m = Σ. The only random term conditional on the data is h−1/2
5,m J π
Andrews and Guggenberger (2017b) with p = d, q∗ = q, ∆q∗ = h3,q ∈ Rk×q, ∆p−q∗ = ∆π
3 ∈ Rk×k, M1 = h(cid:48)
M = h(cid:48)
ξ2 ∈ Rd−q with (cid:107)ξ2(cid:107) = 1,

h )h2,d−q], where
h h2,d−q. We apply Corollary 16.2 of
h,d−q ∈ Rk×(d−q),
h ∈ Rk×d. Note that for

3,k−q ∈ R(k−q)×k, ξ2 ∈ Rd−q and ∆ = ∆π

3,q ∈ Rq×k, M2 = h(cid:48)

˜h1,d−q +h−1/2

5,m (Gh +J π

h,q, ∆π

VarP π (h(cid:48)

3,k−qΣ−1/2J π

h h2,d−qξ2)

= VarP π (vec(h(cid:48)

3,k−qΣ−1/2J π

h h2,d−qξ2))

(cid:16)

= VarP π
(cid:16)

((h2,d−qξ2)(cid:48) ⊗ (h(cid:48)

3,k−qΣ−1/2))(vec(J π

(cid:17)

h ))
(cid:16)

=

(h2,d−qξ2)(cid:48) ⊗ (h(cid:48)

(cid:17)
3,k−qΣ−1/2)

(cid:16)

=

(h2,d−qξ2)(cid:48) ⊗ (h(cid:48)

3,k−qΣ−1/2)

VarP π (vec(J π
h ))
(cid:17) (cid:0)(ΣV − ΣV u(σ2)−1ΣuV ) ⊗ Qzz

(cid:17)
(h2,d−qξ2) ⊗ (Σ−1/2h3,k−q)
(cid:1) (cid:16)

(cid:17)
(h2,d−qξ2) ⊗ (Σ−1/2h3,k−q)

,

= (ξ(cid:48)

2h(cid:48)

2,d−q(ΣV − ΣV u(σ2)−1ΣuV )h2,d−qξ2)(h(cid:48)

3,k−qΣ−1/2QzzΣ−1/2h3,k−q),

where the second equality uses the formula vec(ABC) = (C (cid:48) ⊗ A)vec(B) and the fourth equality uses Lemma

A.6(a). Observe that ξ(cid:48)

2h2,d−q(ΣV − ΣV u(σ2)−1ΣuV )h2,d−qξ2 is scalar, and

2h(cid:48)
ξ(cid:48)

2,d−q(ΣV − ΣV u(σ2)−1ΣuV )h2,d−qξ2
2,d−qh2,d−qξ2

ξ(cid:48)
2h(cid:48)

≥ λmin(ΣV − ΣV u(σ2)−1ΣuV ) > 0.

Moreover, using h(cid:48)

3,k−qh3,k−q = Ik−q

λmin(h(cid:48)

3,k−qΣ−1/2QzzΣ−1/2h3,k−q) = min

η∈Rk−q\{0}

= min

η∈Rk−q\{0}

η(cid:48)h(cid:48)

3,k−qΣ−1/2QzzΣ−1/2h3,k−qη

η(cid:48)η

η(cid:48)h(cid:48)

3,k−qΣ−1/2QzzΣ−1/2h3,k−qη
3,k−qh3,k−qη

η(cid:48)h(cid:48)

≥ min

a∈Rk\{0}

a(cid:48)Σ−1/2QzzΣ−1/2a
a(cid:48)a

≥ λmin(Σ−1)λmin(Qzz)

> 0.

Therefore, rank(VarP π (h(cid:48)
Guggenberger (2017b), P π[rank(∆π

3,k−qΣ−1/2J π

h h2,d−qξ2)) = k − q ≥ d − q, and by Corollary 16.2 of Andrews and
h) = d] = 1 in P -probability. Since (Σπ)−1/2Σ1/2 = (σ2Qzz)−1/2Σ1/2 is

59

nonsingular, P π[rank((Σπ)−1/2Σ1/2∆π

h) = d] = 1 in P -probability. As shown in the proof of Theorem 11.1
of Andrews and Guggenberger (2017b), the mapping deﬁned as f : Rk×d → Rk×k, f (D) = D(D(cid:48)D)−1D(cid:48) is

continuous at D ∈ Rk×d that has full column rank with probability one. Then,

PLM = n ˆmπ(cid:48) ˆΣπ−1/2P( ˆΣπ−1/2Σ1/2

n )n1/2Σ−1/2

n

ˆΣπ−1/2 ˆmπ

ˆJ πTn

dπ
−→ mπ(cid:48)

h Σπ−1/2P(Σπ)−1/2Σ1/2∆π

Σπ−1/2mπ
h

h

∼ χ2
d

in P -probability,

where the convergence follows from the CMT, Lemma A.6 and the full column rank property established

above, and the last line holds because using the independence between ∆π

h, the full column rank
h ∼ N [0, Ik], the equality in distribution holds conditional on ∆π
h, hence also holds
unconditionally. The null asymptotic distribution of the sample LM statistic follows from Theorem 4.1 of

h and Σπ−1/2mπ

h and mπ

of ∆π

Andrews and Guggenberger (2017a) because the parameter space assumptions in the equations (3.3), (3.9)

and (3.10) of Andrews and Guggenberger (2017a) are implied by Assumption 2. The asymptotic similarity

of the PLM test is similar to the PAR tests, thus is omitted.

PCLR tests: By Theorem A.7,

PCLR dπ

−→ PCLR∞ = Z π(cid:48)Z π − λmin

(cid:2)(∆h,d−q, Z π)(cid:48)h3,k−qh(cid:48)

3,k−q(∆h,d−q, Z π)(cid:3)

in P -probability.

Denote the SV’s of h(cid:48)

3,q∆h,d−q by ¯τ (2)

h = [¯τ(q+1)n, . . . , ¯τdn](cid:48). Then, rk,d,q(h(cid:48)
h , 1−
α) and the distribution of PCLR∞ is continuous and strictly increasing at its 1 − α quantile by Lemma A.4
and A.5 because conditional on the data (e.g. ω ∈ Ω1 with Ω1 deﬁned in (A.63)), h(cid:48)

3,k−q∆h,d−q, 1−α) = rk,d,q(¯τ (2)

3,q∆h,d−q is nonrandom.

It follows from Lemma 11.2.1 of Lehmann and Romano (2005) (see also Theorem 15.2.3 therein) that

ˆrk,d( ˆT , 1 − α)

p
−→ rk,d,q(h(cid:48)

3,k−q∆d−q, 1 − α).

(A.146)

By Lemma 16.6 of Andrews and Guggenberger (2019b),

CLR d−→ CLR∞ ≡ Z (cid:48)Z − λmin

(cid:2)(∆h,d−q, Z)(cid:48)h3,k−qh(cid:48)

3,k−q(∆h,d−q, Z)(cid:3) , Z ∼ N [0k×1, Ik].

(A.147)

By the CMT, (A.146) and (A.147)

CLR − ˆrk,d( ˆT , 1 − α)

d−→ CLR∞ − rk,d,q(h(cid:48)

3,k−q∆h,d−q, 1 − α).

(A.148)

As shown in Andrews and Guggenberger (2019b) p.72,

P [CLR∞ = rk,d,q(h(cid:48)

3,k−q∆h,d−q, 1 − α)] = 0.

(A.149)

Then,

P [CLR > PCLR(r)] → P [CLR∞ > rk,d,q(h(cid:48)

3,k−q∆h,d−q, 1 − α)]

= E (cid:2)P [CLR∞ > rk,d,q(h(cid:48)

3,k−q∆h,d−q, 1 − α)|∆h,d−q](cid:3)

= α,

60

where the convergence follows from (A.148) and (A.149), the ﬁrst equality holds by the law of total expec-

tations, and the last equality holds because the conditional rejection probability is α. (A.149) also implies

that limn→∞ P [CLR ≥ PCLR(r)] = α. Since EP [φPCLR

n

] = P [CLR > PCLR(r)] + aPCLRP [CLR = PCLR(r)],

P [CLR > PCLR(r)] ≤ EP [φPCLR

n

] ≤ P [PCLR ≥ PCLR(r)].

By the sandwich rule,

lim
n→∞

EP [φPCLR
n

] = α.

The above result holds for any subsequence {wn} of {n}. Thus, Assumption 3 holds for the PCLR statistic.

Using Proposition 16.3 of Andrews and Guggenberger (2019b), we obtain the desired result.

A.7 Local power under strong identiﬁcation

Proof of Proposition 2.3. Under H1 : θn = θ0 + hθn−1/2,

˜ui(θ0) = (W (cid:48)

i Γ + V (cid:48)

i )hθn−1/2 − X (cid:48)

i(X (cid:48)X)−1X (cid:48)(W Γ + V )hθn−1/2 + ui − X (cid:48)

i(X (cid:48)X)−1X (cid:48)u.

Note that (cid:107)Z ∗

i (cid:107)2(cid:107)Wi(cid:107)2, (cid:107)Z ∗

i (cid:107)2(cid:107)Xi(cid:107)2, (cid:107)Z ∗

(cid:107)Z ∗

i (cid:107)2(cid:107)Xi(cid:107)(cid:107)Vi(cid:107), (cid:107)Z ∗

i (cid:107)2(cid:107)Xi(cid:107)|ui|, (cid:107)Z ∗
The same moment bounds are also obtained when (cid:107)Z ∗

i (cid:107)2u2

i , (cid:107)Z ∗

i (cid:107)2(cid:107)Vi(cid:107)2, (cid:107)Z ∗

i (cid:107)2(cid:107)Wi(cid:107)|ui|,
i (cid:107)2(cid:107)Wi(cid:107)(cid:107)Xi(cid:107), (cid:107)Z ∗
i (cid:107)2(cid:107)Vi(cid:107)|ui| have ﬁnite 1+δ/2 moments by the Cauchy-Schwarz inequality.
i (cid:107)2 in the previous quantities is replaced by (cid:107)Xi(cid:107)2 and

i (cid:107)2(cid:107)Wi(cid:107)(cid:107)Vi(cid:107), (cid:107)Z ∗

(cid:107)Z ∗

i (cid:107)(cid:107)Xi(cid:107). By the triangular array WLLN, CMT and the fact that D

p

−→ 0 in (A.35),

n
(cid:88)

ˆΣ = n−1

ZiZ (cid:48)

i ˜ui(θ0)2 = n−1

n
(cid:88)

i=1

(Z ∗

i + DXi)(Z ∗

i + DXi)(cid:48)

i=1
i Γ + V (cid:48)

((W (cid:48)

i )hθn−1/2 − X (cid:48)

i(X (cid:48)X)−1X (cid:48)(W Γ + V )hθn−1/2 + ui − X (cid:48)

i(X (cid:48)X)−1X (cid:48)u)2

= EP [Z ∗

i Z ∗(cid:48)

i u2

i ] + op(1) = Σn + op(1) = h5,m + op(1).

Proceeding similarly to the argument in (A.150),

ˆCs = n−1

= n−1

n
(cid:88)

i=1
n
(cid:88)

ZiZ (cid:48)
i

˜Yis ˜ui(θ0)

(Z ∗

i + DXi)(Z ∗

i + DXi)(cid:48)(Z ∗(cid:48)

i Γs + Vis + X (cid:48)

i(D(cid:48)Γs − (X (cid:48)X)−1X (cid:48)V, s))

i=1
i Γ + V (cid:48)
n
(cid:88)

((W (cid:48)

i )hθn−1/2 − X (cid:48)

i(X (cid:48)X)−1X (cid:48)(W Γ + V )hθn−1/2 + ui − X (cid:48)

i(X (cid:48)X)−1X (cid:48)u)

= n−1

Z ∗

i Z ∗(cid:48)

i (Z ∗(cid:48)

i Γs + Vis)ui + op(1) = EP [Z ∗

i Z ∗(cid:48)

i (Z ∗(cid:48)

i Γs + Vis)ui] + op(1) = Cns + op(1).

i=1

The limit in (A.38) remains unchanged under the local alternatives. Thus, from (A.150) and (A.151), we

have

ˆVa(θ0) = Vn,a + op(1).

(A.152)

Next to determine limit of ˆVb(θ0), note ﬁrst that






εi(θ0) −



 Zi =



01×k

−Γ (cid:48)

(W (cid:48)

i Γ + V (cid:48)

i )hθn−1/2 − X (cid:48)

i(X (cid:48)X)−1X (cid:48)(W Γ + V )hθn−1/2 + ui − X (cid:48)

i(X (cid:48)X)−1X (cid:48)u

−Vi + V (cid:48)X(X (cid:48)X)−1Xi

61

(A.150)

(A.151)





and

Hence,

where

ˆεin(θ0) −





01×k

−Γ (cid:48)



 Zi =





n−1/2h(cid:48)

θΓ (cid:48)Zi + n−1/2h(cid:48)

θV (cid:48)Z(Z (cid:48)Z)−1Zi + u(cid:48)Z(Z (cid:48)Z)−1Zi

−V (cid:48)Z(Z (cid:48)Z)−1Zi



 .

εi(θ0) − ˆεin(θ0) =





ai

0d×1



 +





ui − X (cid:48)

i(X (cid:48)X)−1X (cid:48)u − u(cid:48)Z(Z (cid:48)Z)−1Zi
−Vi + V (cid:48)X(X (cid:48)X)−1Xi + V (cid:48)Z(Z (cid:48)Z)−1Zi



 ,

(A.153)

ai ≡ (W (cid:48)

i Γ +V (cid:48)

i )hθn−1/2−X (cid:48)

i(X (cid:48)X)−1X (cid:48)(W Γ +V )hθn−1/2+n−1/2h(cid:48)

θΓ (cid:48)Zi+n−1/2h(cid:48)

θV (cid:48)Z(Z (cid:48)Z)−1Zi. (A.154)

Next we show that n−1 (cid:80)n

i=1 a2

i ZiZ (cid:48)
i

p

−→ 0. For Di ∈ {Wi, Xi, Vi} and j + l ≤ 4, j ≥ 0, l ≥ 2, by the cr

inequality, and the WLLN,

n−1

n
(cid:88)

i=1

(cid:107)Di(cid:107)j(cid:107)Zi(cid:107)l ≤ n−1

n
(cid:88)

i=1

(cid:107)Di(cid:107)j2l−1((cid:107)Wi(cid:107)l + (cid:107)W (cid:48)X(X (cid:48)X)−1(cid:107)l(cid:107)Xi(cid:107)l) = Op(1).

(A.155)

Therefore, using (A.155) and n−1X (cid:48)X = Op(1), n−1X (cid:48)W = Op(1), n−1Z (cid:48)Z = Op(1), n−1Z (cid:48)V = Op(1),
n−1X (cid:48)V = Op(1) which hold by the WLLN and the CMT,

(cid:107)n−1

n
(cid:88)

i=1

i ZiZ (cid:48)
a2

i(cid:107) ≤ (cid:107)hθ(cid:107)2n−1

(cid:18)

n−1

n
(cid:88)

i=1

(cid:107)W (cid:48)

i Γ + V (cid:48)

i (cid:107)2(cid:107)Zi(cid:107)2 + (cid:107)(X (cid:48)X)−1X (cid:48)(W Γ V )(cid:107)2n−1

n
(cid:88)

i=1

(cid:107)Xi(cid:107)2(cid:107)Zi(cid:107)2

+ (cid:107)Γ (cid:107)2n−1

n
(cid:88)

i=1

(cid:107)Zi(cid:107)3 + (cid:107)V (cid:48)Z(Z (cid:48)Z)−1(cid:107)2n−1

n
(cid:88)

i=1

(cid:107)Zi(cid:107)3

+ 2(cid:107)(X (cid:48)X)−1X (cid:48)(W Γ + V )(cid:107)n−1

n
(cid:88)

i=1

(cid:107)Xi(cid:107)(cid:107)Zi(cid:107)2 + 2(cid:107)Γ (cid:107)n−1

n
(cid:88)

i=1

+ 2(cid:107)V (cid:48)Z(Z (cid:48)Z)−1(cid:107)n−1

n
(cid:88)

i=1

(cid:107)W (cid:48)

i Γ + V (cid:48)

i (cid:107)(cid:107)Zi(cid:107)3

(cid:107)W (cid:48)

i Γ + V (cid:48)

i (cid:107)(cid:107)Zi(cid:107)3

+ 2(cid:107)(X (cid:48)X)−1X (cid:48)(W Γ + V )(cid:107)(cid:107)Γ (cid:107)n−1

n
(cid:88)

i=1

(cid:107)Xi(cid:107)(cid:107)Zi(cid:107)3

+ 2(cid:107)V (cid:48)Z(Z (cid:48)Z)−1(cid:107)(cid:107)(X (cid:48)X)−1X (cid:48)(W Γ + V )(cid:107)n−1

+ 2(cid:107)V (cid:48)Z(Z (cid:48)Z)−1(cid:107)(cid:107)Γ (cid:107)n−1

(cid:19)

(cid:107)Zi(cid:107)4

n
(cid:88)

i=1

n
(cid:88)

i=1

(cid:107)Xi(cid:107)(cid:107)Zi(cid:107)3

Similarly, we have

p

−→ 0.

n−1

n−1

n
(cid:88)

i=1
n
(cid:88)

i=1

ai(ui − X (cid:48)

i(X (cid:48)X)−1X (cid:48)u − u(cid:48)Z(Z (cid:48)Z)−1Zi) ⊗ (ZiZ (cid:48)
i)

p

−→ 0,

ai(−Vi + V (cid:48)X(X (cid:48)X)−1Xi + V (cid:48)Z(Z (cid:48)Z)−1Zi) ⊗ (ZiZ (cid:48)
i)

p

−→ 0.

(A.156)

(A.157)

(A.158)

62

ui − X (cid:48)

i(X (cid:48)X)−1X (cid:48)u − u(cid:48)Z(Z (cid:48)Z)−1Zi
−Vi + V (cid:48)X(X (cid:48)X)−1Xi + V (cid:48)Z(Z (cid:48)Z)−1Zi









ui − X (cid:48)

i(X (cid:48)X)−1X (cid:48)u − u(cid:48)Z(Z (cid:48)Z)−1Zi
−Vi + V (cid:48)X(X (cid:48)X)−1Xi + V (cid:48)Z(Z (cid:48)Z)−1Zi


(cid:48)



⊗ (ZiZ (cid:48)
i)

As shown in (A.51)

n
(cid:88)

n−1





i=1




− EP





u2
i

−uiVi

−uiV (cid:48)
i
ViV (cid:48)
i


 ⊗ (Z ∗

i Z ∗(cid:48)
i )



p

−→ 0.



By (A.153), (A.156), (A.157), (A.158), (A.159) and the CMT, we have

ˆVb(θ0) − Vn,b

p

−→ 0.

AR and PAR statistics: Since, under H1 : θn = θ0 + hθn−1/2, y − Y θ0 = Y hθn−1/2 + Xγ + u, using
n−1W (cid:48)MX W a.s.−→ Qzz and n−1W (cid:48)MX V a.s.−→ 0, the convergence in Lemma 16.4 of Andrews and Guggenberger
(2019b) and Slutsky’s lemma we obtain

n1/2 ˆm(θ0) = n−1/2W (cid:48)MX (y − Y θ0)

= n−1/2W (cid:48)MX (Y hθn−1/2 + Xγ + u)

= n−1W (cid:48)MX W Γ hθ + n−1W (cid:48)MX V hθ + n−1/2W (cid:48)MX u
d−→ N [Ghθ, Σ] ,

(A.161)

where Σ = limn→ EP [Z ∗
yield AR d−→ χ2

k(η2).

i Z ∗(cid:48)

i u2

i ] and G = limn→∞ EP [Z ∗

i Z ∗(cid:48)

i ]Γ = h4. (A.150), (A.161) and the CMT together

Next we derive the asymptotic distribution of the permutation statistics. Since n−1W (cid:48)MX W a.s.−→ Qzz,
n−1V (cid:48)MX W a.s.−→ 0, n−1W (cid:48)MX u a.s.−→ 0, n−1V (cid:48)MX V a.s.−→ ΣV , n−1u(cid:48)MX V a.s.−→ ΣuV and n−1u(cid:48)MX u a.s.−→ σ2,
by the SLLN and CMT

n−1 ˜u(θ0)(cid:48) ˜u(θ0) = n−1 (cid:16)
a.s.−→ σ2.

MX W Γ hθn−1/2 + MX V hθn−1/2 + MX u

(cid:17)(cid:48) (cid:16)

(cid:17)
MX W Γ hθn−1/2 + MX V hθn−1/2 + MX u

By Jensen’s inequality, the WLLN, CMT, and (A.86)

n−1

n
(cid:88)

i=1

˜ui(θ0)4 − EP [u4
i ]

≤ 27n−1

n
(cid:88)

i=1

(cid:107)W (cid:48)

i Γ + V (cid:48)

i (cid:107)4(cid:107)hθ(cid:107)4n−2 + 27n−1

n
(cid:88)

i=1

(cid:107)Xi(cid:107)4(cid:107)(X (cid:48)X)−1X (cid:48)(W Γ + V )(cid:107)4(cid:107)hθ(cid:107)4n−2

+ 27n−1

n
(cid:88)

i=1

p

−→ 0,

(ui − X (cid:48)

i(X (cid:48)X)−1X (cid:48)u)4 − EP [u4
i ]

where for the ﬁrst term we used n−1 (cid:80)n

i=1((cid:107)Wi(cid:107)4(cid:107)Γ (cid:107)4 + (cid:107)Vi(cid:107)4) = Op(1) which
holds by the cr inequality and the WLLN. (A.134) holds by (A.162), (A.163) and an argument analogous to

i (cid:107)4 ≤ 8n−1 (cid:80)n

i Γ + V (cid:48)

i=1 (cid:107)W (cid:48)

63

(A.159)

(A.160)

(A.162)

(A.163)

the consistency of ˆΣπ in (A.89). (A.136) holds by (A.163). (A.137) holds by an argument similar to (A.150).

Combining these and following an argument analogous to that in (A.138) then give

n−1W (cid:48)

πMX ˜ΣuMX Wπ − (Qww − QwQ(cid:48)

w)σ2

p
−→ 0

in P -probability.

(A.164)

Furthermore, the convergence in (A.89) holds here using (A.162) and (A.163) in (A.84) and (A.88), respec-

tively:

ˆΣπ pπ

−→ σ2Qzz

in P -probability.

(A.165)

(A.141) holds by (A.162). A bound analogous to (A.139) is obtained by an argument similar to (A.163).

Thus, (A.142) and (A.143) hold. Therefore, by Theorem A.1

n−1/2W (cid:48)

πMX (y − Y θ0) = n−1/2W (cid:48)Mι ˜u˜π(θ0) dπ
n1/2 ˆmπ(θ0) = n−1/2Z (cid:48) ˜uπ(θ0) dπ

−→ N (cid:2)0, (Qww − QwQ(cid:48)

w)σ2(cid:3) P -almost surely,

−→ N (cid:2)0, Qzzσ2(cid:3) P -almost surely.

(A.166)

Finally, by (A.164), (A.165), (A.166) and Slutsky’s lemma, we obtain that PAR1

dπ
−→ χ2

k and PAR2

dπ
−→ χ2
k

in P -probability.

LM and PLM statistics: By deﬁnition, q = d if and only if n1/2τdn → ∞. Decompose n1/2Hn ˆJUnTn =
n1/2HnGnUnTn + n1/2Hn( ˆJ − Gn)UnTn. By an analogous argument to that in (A.97) (see also Lemma 16.4

and the equations (25.5)-(25.6) of Andrews and Guggenberger (2019b)),

n1/2HnGnUnTn

d−→ h3,q

(A.167)

because the second term involving Bn,d−q in (A.97) drops out when q = d. The asymptotic distribution of
n1/2( ˆG − Gn) remains invariant under H1 : θn = θ0 + hθn−1/2. This combined with (A.150), (A.151) and

(A.161) yields

n1/2( ˆJ − Gn) = Op(1).

(A.168)

Therefore, n1/2Hn( ˆJ − Gn)UnTn = Hnn1/2( ˆJ − Gn)UnBn,qn−1/2Υ−1

n,q = op(1) because n1/2τdn → ∞, and

Using ˆΣ−1/2H −1
n

p

−→ Ik which holds by (A.150) and the CMT, (A.150), (A.169) and the CMT

n1/2Hn ˆJUnTn

d−→ h3,q.

LM = n ˆm(cid:48) ˆΣ−1/2P ˆΣ−1/2 ˆJ
d(η2),

d−→ χ2

ˆΣ−1/2 ˆm = n ˆm(cid:48) ˆΣ−1/2P ˆΣ−1/2H−1

n Hn ˆJUnTn

ˆΣ−1/2 ˆm

(A.169)

(A.170)

where we used P ˆΣ−1/2H−1
has full column rank d.

n Hn ˆJUnTn

p

−→ Ph3,q , and the fact that Un and Tn are nonsingular, and h3,q = h3,d

Next consider the PLM statistic. To see that (A.79) holds under the local alternatives, note that by

64

Jensen’s inequality, the SLLN and (A.79),

n−1

n
(cid:88)

i=1

|˜ui(θ0)|2+δ/2 ≤ 31+δ/2n−1

+ 31+δn−1

n
(cid:88)

i=1
n
(cid:88)

i=1

(cid:107)W (cid:48)

i Γ + V (cid:48)

i (cid:107)2+δ/2(cid:107)hθn−1/2(cid:107)2+δ/2

(cid:107)Xi(cid:107)2+δ/2(cid:107)(X (cid:48)X)−1X (cid:48)(W Γ + V )(cid:107)2+δ/2(cid:107)hθn−1/2(cid:107)2+δ/2

+ 31+δ/2n−1

n
(cid:88)

i=1

= Oa.s.(1),

|ui − X (cid:48)

i(X (cid:48)X)−1X (cid:48)u|2+δ/2

(A.171)

where n−1 (cid:80)n

i=1((cid:107)Wi(cid:107)2+δ/2(cid:107)Γ (cid:107)2+δ/2 + (cid:107)Vi(cid:107)2+δ/2) = Oa.s.(1) by the cr
inequality and the triangular array SLLN. (A.81) holds by (A.171), hence (A.82) holds. Also, by the SLLN

i (cid:107)2+δ/2 ≤ 21+δ/2n−1 (cid:80)n

i Γ + V (cid:48)

i=1 (cid:107)W (cid:48)

and the CMT

n−1 ˜u(θ0)(cid:48) ˆV

(A.172)

= n−1(MX W Γ hθn−1/2 + MX V hθn−1/2 + MX u)(cid:48)(In − PZ − PX )V,

= n−1/2h(cid:48)

θn−1V (cid:48)(MX − MX W (W (cid:48)MX W )−1W (cid:48)MX )V + n−1u(cid:48)(MX − MX W (W (cid:48)MX W )−1W (cid:48)MX )V

a.s.−→ ΣuV .

(A.173)

Hence, (A.76) holds. By (A.82) and Lemma A.1, we then obtain (A.70). Note that (A.92) holds because

(A.93) holds by (A.163). Also, (A.90) holds by (A.173). This veriﬁes (A.94). Combining the latter with

(A.70) and (A.165), we obtain

n1/2( ˆJ π − ˆG) = Opπ (1)

in P -probability.

(A.174)

Thus, following the proof of Lemma A.6, noting that the term involving Bn,d−q in (A.97) evacuates when

q = d, and using (A.168) and (A.174), we obtain

n1/2Hn ˆJ πUnTn = n1/2HnGnUnTn + n1/2Hn( ˆG − Gn)UnTn + n1/2Hn( ˆJ π − ˆG)UnTn

pπ
−→ ∆π

h = h3,d

in P -probability,

where ∆π

h = h3,q = h3,d = ∆h has full column rank. Since (Σπ)−1/2Σ1/2 = (σ2Qzz)−1/2Σ1/2 is nonsingular,

P π[rank((Σπ)−1/2Σ1/2∆π

h) = d] = 1 with P -probability one. Then,

PLM = n ˆmπ(cid:48) ˆΣπ−1/2P ˆΣπ−1/2 ˆJ π

ˆΣπ−1/2 ˆmπ

= n ˆmπ(cid:48) ˆΣπ−1/2P( ˆΣπ−1/2Σ1/2
dπ
−→ mπ(cid:48)

h Σπ−1/2P(Σπ)−1/2Σ1/2∆π

Σπ−1/2mπ
h

h

n )n1/2Σ−1/2

n

ˆΣπ−1/2 ˆmπ

ˆJ πUnTn

∼ χ2
d

in P -probability,

(A.175)

where the second equality holds because Σn and Tn are nonsingular, the convergence follows from the CMT,

the full column rank property veriﬁed above, and the last line uses (A.166) and the fact that P(Σπ)−1/2Σ1/2∆π

h

is idempotent with rank d.

65

CLR and PCLR statistics: The asymptotic distributions of the CLR and PCLR statistics under the

sequence of local alternatives and strong or semi-strong identiﬁcation with n1/2τdn → ∞, are derived pro-

ceeding similarly to Proposition A.7 and Lemma 28.1 of Andrews and Guggenberger (2019b). By deﬁnition,
q = d if and only if n1/2τdn → ∞ in which case Q+
2 (κ) deﬁned in (A.120) is scalar. From (A.128) which
also holds under the local alternatives because ˆJ − Gn = Op(n−1/2) as veriﬁed in (A.168), all the remaining
quantities n1/2 ˆΣπ−1/2 ˆmπ, ˆΣ, ˆV ∈ { ˆVa(θ0), ˆVb(θ0)} have the same limits as under the null as shown in (A.150),

(A.152), (A.160), (A.165), (A.166), and

where

Q+

2 (ˆκ+

j ) = M +

d+1−q − ˆκ+

j (Id+1−q + opπ (1)),

M +

d+1−q ≡ nB+(cid:48)

n,d+1−qU +(cid:48) ˆJ +(cid:48)H (cid:48)

nh3,k−qh(cid:48)

3,k−qHn ˆJ +U +

n B+

n,d+1−q + op(1).

(A.176)

(A.177)

Since |Q+

2 (ˆκ+
probability, we obtain

d+1)| = |M +

d+1−q − ˆκ+

d+1(Id+1−q + opπ (1))| = 0 with P π-probability approaching 1,

in P -

d+1 = nB+(cid:48)
ˆκ+

n,d+1−qU +(cid:48)
= n ˆmπ(cid:48) ˆΣπ−1/2h3,k−qh(cid:48)

ˆJ +(cid:48)H (cid:48)

n

nh3,k−qh(cid:48)

3,k−qHn ˆJ +U +
ˆΣπ−1/2 ˆmπ + opπ (1)

n B+

3,k−q

n,d+1−q(1 + opπ (1)) + opπ (1),

in P -probability.

(A.178)

When q = d and under the local alternatives H1 : θn = θ0+hθn−1/2, as shown in (A.169), n1/2 ˆH ˆJ πUnBnSn
∆π

h = h3,q as the term ∆π

h,d−q evacuates. Then,

dπ
−→

PCLR = n ˆmπ(cid:48) ˆΣπ−1 ˆmπ − ˆκ+

d+1

(A.179)

= n ˆmπ(cid:48) ˆΣπ−1/2(Ik − h3,k−qh(cid:48)

3,k−q) ˆΣπ−1/2 ˆmπ + opπ (1)

ˆΣπ−1/2 ˆmπ + opπ (1)

3,q
ˆΣπ−1/2 ˆmπ + opπ (1)

= n ˆmπ(cid:48) ˆΣπ−1/2h3,qh(cid:48)

= n ˆmπ(cid:48) ˆΣπ−1/2Ph3,q
= n ˆmπ(cid:48) ˆΣπ−1/2P( ˆΣπ−1/2Σ1/2
dπ
−→ χ2
d

in P -probability,

n )n1/2Σ−1/2

n

ˆΣπ−1/2 ˆmπ + opπ (1)

ˆJ πUnTn

where the second equality uses (A.178), the third and the fourth equalities use Pn1/2 ˆH ˆJ πUnBnSn
op(1) = h3,q(h(cid:48)

3,q + op(1) and (A.161) since h(cid:48)

3,q + op(1) = h3,qh(cid:48)

3,qh3,q)−1h(cid:48)

3,qh3,q = Id, and the convergence

= Ph3,q +

follows from (A.175).

Recall that by (A.167) (see also Lemma A.6, Lemma 10.3 of Andrews and Guggenberger (2017b) and
d−→ h3,q. By replacing ˆΣπ−1/2 ˆmπ in
Lemma 16.4 of Andrews and Guggenberger (2019b)), n1/2 ˆH ˆJUnBnSn
(A.178) and (A.179) with ˆΣ−1/2 ˆm and using (A.161), the asymptotic distribution of the CLR statistic is

obtained similarly:

CLR = n ˆm(cid:48) ˆΣ−1/2h3,qh(cid:48)

3,q

ˆΣ−1/2 ˆm + op(1)

= n ˆm(cid:48) ˆΣ−1/2P ˆΣ−1/2H−1
= n ˆm(cid:48) ˆΣ−1/2P ˆΣ−1/2 ˆJ
d−→ χ2
d(η2),

ˆΣ−1/2 ˆm

n Hn ˆJUnTn
ˆΣ−1/2 ˆm + op(1)

66

where the second and the third equalities use P ˆΣ−1/2 ˆJ = Pn1/2 ˆH ˆJUnBnSn
op(1) = h3,qh(cid:48)
3,q + op(1) and the convergence uses (A.170).

A.8 Proof of Lemma A.8

= Ph3,q +op(1) = h3,q(h(cid:48)

3,qh3,q)−1h(cid:48)

3,q+

Proof of Lemma A.8. In view of Lemma A.3, op(1) terms are opπ (1) in P -probability. For simplicity, we
suppress the qualiﬁer in P -probability. Also, whenever we use the convergence result n1/2( ˆJ − Gn) = Op(1)

given in (A.60), we are conditioning on the event ω ∈ Ω1 as discussed in Section A.4. The result for

subsequences follow similarly, thus we provide only the full sequence result.

Recall that by deﬁnition, h6,j ≡ limn→∞ τ(j+1)n/τjn, j = 1, . . . , d, and h6,q = 0 if q < d + 1. Deﬁne

h6,q = 0 if q = d + 1. Because τ1n ≥ · · · ≥ τ(d+1)n ≥ 0, h6,j ∈ [0, 1]. When h6,j = limn→∞ τ(j+1)n/τjn > 0,

{τjn : n ≥ 1} and {τ(j+1)n : n ≥ 1} have the same orders of magnitude.

Next divide the ﬁrst q SV’s τ1n ≥ · · · ≥ τqn into groups such that the SV’s within each group have the same

orders of magnitude. Denote the number of groups by Gh with q ≥ Gh ≥ 1, and the ﬁrst and last indices
of the SV’s in the g-th group by rg and r∗
the deﬁnition rGh+1 ≡ q + 1. By construction, h6,j > 0 for all j = rg, . . . , r∗
limn→∞ τj(cid:48)n/τjn = 0 for any j ∈ g and j(cid:48) ∈ g(cid:48) with g (cid:54)= g(cid:48). When d = 1, Gh = 1 and r1 = r∗

g respectively. Thus, r1 = 1, r∗

g − 1, g = 1, . . . , Gh. Also,

g = rg+1 − 1 and r∗
Gh

= q with

1 = 1.

Step 1: The ﬁrst group of eigenvalues. Recall that the eigenvalues of n ˆU +(cid:48) ˆJ +(cid:48) ˆH (cid:48) ˆH ˆJ + ˆU + are
denoted as ˆκ+

1 , . . . , ˆκ+

d+1. Then,

d+1 = λmin[n( ˆH ˆJ ˆU , ˆΣπ−1/2 ˆmπ)(cid:48)( ˆH ˆJ ˆU , ˆΣπ−1/2 ˆmπ)] = λmin[n ˆU +(cid:48) ˆJ +(cid:48) ˆH (cid:48) ˆH ˆJ + ˆU +].
ˆκ+

Now premultiply the determinantal equation

|n ˆU +(cid:48) ˆJ +(cid:48) ˆH (cid:48) ˆH ˆJ + ˆU + − κId+1| = 0

by |τ −2

r1nn−1B+(cid:48)

n U +(cid:48)

n ( ˆU +)−1(cid:48)| and postmultiply by |( ˆU +)−1U +

n B+

n | to obtain

|τ −2

r1nB+(cid:48)

n U +(cid:48)
n

ˆJ +(cid:48) ˆH (cid:48) ˆH ˆJ +U +

n B+

n − (n1/2τr1n)−2κB+(cid:48)

n U +(cid:48)

n ( ˆU +)−1(cid:48)( ˆU +)−1U +

n B+

n | = 0.

(A.180)

n |, |U +

Since |B+
given n1/2τr1n → ∞ for r1 ≤ q, the eigenvalues {ˆκ+
{(n1/2τr1n)−2ˆκ+
j : 1 ≤ j ≤ d + 1} solve

n | > 0 and | ˆU +| > 0 with P π-probability approaching 1 (wppa 1), and τr1n > 0 for n large
j , 1 ≤ j ≤ d + 1} above also solve (A.180) wppa 1. Thus,

|τ −2

r1nB+(cid:48)

n U +(cid:48)
n

ˆJ +(cid:48) ˆH (cid:48) ˆH ˆJ +U +

n B+

n − κ(Id+1 + ˆE+)| = 0,

where

ˆE+ =





ˆE+
1
ˆE+(cid:48)
2


 = B+(cid:48)

n U +(cid:48)

n ( ˆU +)−1(cid:48)( ˆU +)−1U +

n B+

n − Id+1,

ˆE+
2
ˆE+
3

(A.181)

(A.182)

1 ∈ Rr∗

where ˆE+
[ ˆH ˆJUnBn, ˆΣπ−1/2 ˆmπ] and ˆHJ +

2 ∈ Rr∗
n U +

1 , ˆE+

1 ×r∗

1 ×(d+1−r∗

1 ) and ˆE+

1 ).4 Note that ˆH ˆJ +U +
n = [ ˆHGnUnBn, 0k×1], and by the SVD, HnGnUn = AnΥnB(cid:48)

3 ∈ R(d+1−r∗

1 )×(d+1−r∗

n B+

n B+

n =

n. Let

4 ˆE+

j , j = 1, 2, 3, and E+

j , j = 1, 2, 3, in (A.118) are diﬀerent matrices because they have diﬀerent dimensions.

67

O(τr2n/τr1n)d1×d2 denote a d1 × d2 matrix with O(τr2n/τr1n) elements on the main diagonal and zeros else-

where. Thus,

τ −1
r1n

ˆH ˆJ +U +

n B+
n

ˆHJ +

n U +

n B+

= τ −1

n )U +

ˆH( ˆJ + − J +

n + τ −1
r1n

= τ −1
n B+
n ,
r1n
r1n[ ˆHGnUnBn, 0k×1] + (n1/2τr1n)−1[ ˆHn1/2( ˆJ − Gn)UnBn, n1/2 ˆΣπ−1/2 ˆmπ]
r1n[ ˆHH −1
r1n(Ik + opπ (1))AnΥ+

nBn, 0k×1] + Opπ ((n1/2τr1n)−1),

n + Opπ ((n1/2τr1n)−1),

n AnΥnB(cid:48)

= τ −1

= τ −1

= (Ik + opπ (1))An








h∗

6,r∗
1

+ o(1)

0(d−r∗

1 )×r∗
1
0(k−d)×r∗

1

0r∗
1 ×(d−r∗
1 )
1 )×(d−r∗
O(τr2n/τr1n)(d−r∗
1 )
0(k−d)×(d−r∗
1 )

0r∗

1 ×1
0(d−r∗

1 )×1
0(k−d)×1








+ Opπ ((n1/2τr1n)−1),

(A.183)

pπ
−→ h3





h∗

6,r∗
1

0(k−r∗

1 )×r∗
1

0r∗

1 ×(d+1−r∗
1 )

0(k−r∗

1 )×(d+1−r∗
1 )



 ,

h∗
6,r∗
1

≡ diag(1, h6,1, h6,1h6,2, . . . ,

r∗
1 −1
(cid:89)

l=1

h6,l),

nBn = Id, ˆJ − Gn = Op(n−1/2) as shown in (A.60), n1/2 ˆΣπ−1/2 ˆmπ =
where the third equality holds by B(cid:48)
Opπ (1) as shown in Lemma A.6, ˆHH −1
−→ Ik, (cid:107)Hn(cid:107) < ∞, Un = O(1) by deﬁnition, and Bn = O(1) by the
n
orthogonality of Bn, the ﬁfth equality uses τjn/τr1n = (cid:81)j−1
l=1 h6,l + o(1), j = 2, . . . , r∗
1,
and τjn/τr1n = O(τjn/τr1n), j = r2, . . . , d + 1, which holds by τ1n ≥ . . . τ(d+1)n, and the convergence uses
An → h3, τr2n/τr1n → 0 and n1/2τr1n → ∞ since r1 ≤ q. Therefore, using h(cid:48)

l=1 (τ(l+1)n/τln) = (cid:81)j−1

3h3 = Ik

p

r1nB+(cid:48)
τ −2

n U +(cid:48)
n

ˆJ +(cid:48) ˆH (cid:48) ˆH ˆJ +U +

n B+
n

pπ
−→







h∗

6,r∗
1

0(k−r∗

1 )×r∗
1

0r∗

1 ×(d+1−r∗
1 )

0(k−r∗

1 )×(d+1−r∗
1 )


(cid:48)



h(cid:48)
3h3





h∗

6,r∗
1

0(k−r∗

1 )×r∗
1

0r∗

1 ×(d+1−r∗
1 )

0(k−r∗

1 )×(d+1−r∗
1 )





=



h∗2

6,r∗
1

0r∗

1 ×(d+1−r∗
1 )

0(d+1−r∗

1 )×r∗
1

0(d+1−r∗

1 )×(d+1−r∗
1 )



 .

Since ˆU −Un
and using the CMT in conjunction with B+(cid:48)

p
−→ 0 and Un → h91 positive deﬁnite, ˆU +−U +
n

n B+

n = Id+1, we have

p

−→ 0 and U +

n → h+

91. Thus, ( ˆU +)−1U +

n

ˆE+ = B+(cid:48)

n U +(cid:48)
n

ˆU +(cid:48)−1 ˆU +−1U +

n B+

n − Id+1

pπ
−→ 0(d+1)×(d+1).

p

−→ Id+1

(A.184)

Thus, {(n1/2τr1n)−2ˆκ+
j
1. Then, since the ordered vector of eigenvalues of a matrix is a continuous function of the matrix, using

: j = 1, . . . , d + 1} solve |τ −2

n − κId+1| = 0 with wppa

ˆJ +(cid:48) ˆH (cid:48) ˆH ˆJ +U +

r1nB+(cid:48)

n U +(cid:48)
n

n B+

Slutsky’s lemma

(n−1ˆκ+

1 , . . . , n−1ˆκ+
r∗
1

)

pπ
−→ (1, h2

6,1, h2

6,1h2

6,2, . . . ,

n−1ˆκ+
j

pπ
−→ ∞,

j = 1, . . . , r∗
1,

r∗
1 −1
(cid:89)

l=1

h2
6,l),

(A.185)

(A.186)

because n1/2τr1n → ∞ given r1 ≤ q and h6,l > 0 for all l = 1, . . . , r∗
the remaining d+1−r∗

1 eigenvalues {(n1/2τr1n)−2ˆκ+

j : j = r∗

1 − 1. The same argument also yields that

1 +1, . . . , d+1} of |τ −2

r1nB+(cid:48)

n U +(cid:48)
n

ˆJ +(cid:48) ˆH (cid:48) ˆH ˆJ +U +

n B+

n −

68

κId+1| = 0 satisfy

(n1/2τr1n)−2ˆκ+
j

pπ
−→ 0,

j = r∗

1 + 1, . . . , d + 1.

(A.187)

Let B+

n,j1,j2

denote the (d + 1) × (j2 − j1) matrix that consists of j1 + 1, . . . , j2 columns of B+

n for 0 ≤ j1 <

j2 ≤ d + 1. Thus, we may write B+

n = [B+

n,0,r∗
1

, B+

n,r∗

τ −1
r1n

ˆH −1 ˆJ +U +

n B+

n,0,r∗
1

= (Ik + op(1))An



1 ,d+1]. Proceeding similarly to (A.183),



 + Opπ ((n1/2τr1n)−1),

h6,r∗

1

+ o(1)

0(k−r∗

1 )×r∗
1

τ −1
r1n

ˆH −1 ˆJ +U +

n B+

n,r∗

1 ,d+1 = (Ik + op(1))An





O

1 ×(d+1−r∗
1 )
(cid:17)(k−r∗
1 )×(d+1−r∗
1 )

0r∗
(cid:16) τr2n
τr1n


 + Opπ ((n1/2τr1n)−1).

From the last two expressions,

=

=







(cid:37)n ≡ τ −2

r1nB+(cid:48)


n,0,r∗
1

ˆJ +(cid:48) ˆH (cid:48) ˆH ˆJ +U +
U +(cid:48)
n

(cid:48)

n B+

n,r∗
1 ,d+1


h6,r∗

1

+ o(1)

0(k−r∗

1 )×r∗
1



A(cid:48)

n(Ik + op(1))An



O

0r∗
(cid:16) τr2n
τr1n

1 ×(d+1−r∗
1 )
(cid:17)(k−r∗
1 )×(d+1−r∗
1 )


 + Opπ ((n1/2τr1n)−1)



(cid:48) 



h6,r∗

1

+ o(1)

0(k−r∗

1 )×r∗
1

Ir∗

1

+ opπ (1)


opπ (1)(k−r∗

1 )×r∗

1

opπ (1)r∗

1 ×(k−r∗
1 )

Ik−r∗

1

+ opπ (1)









O

1 ×(d+1−r∗
1 )
(cid:17)(k−r∗
1 )×(d+1−r∗
1 )

0r∗
(cid:16) τr2n
τr1n


 + Opπ ((n1/2τr1n)−1)

= opπ (τr2n/τr1n) + Opπ ((n1/2τr1n)−1).

(A.188)

Deﬁne

U +(cid:48)
n

ˆJ +(cid:48) ˆH (cid:48) ˆH ˆJ +U +

n B+

n,0,r∗
1

− κ(Ir∗

1

+ ˆE+

1 ) ∈ Rr∗

1 ×r∗
1 ,

r1nB+(cid:48)

ˆξ1(κ) ≡ τ −2

n,0,r∗
1
ˆξ2(κ) ≡ (cid:37)n − κ ˆE+

ˆξ3(κ) ≡ τ −2

r1nB+(cid:48)
n,r∗

2 ∈ Rr∗
1 ,d+1U +(cid:48)

n

1 ×(d+1−r∗

1 ),

ˆJ +(cid:48) ˆH (cid:48) ˆH ˆJ +U +

n B+

n,r∗

1 ,d+1 − κ(Id+1−r∗

1

+ ˆE+

1 ) ∈ Rd+1−r∗

1 ×(d+1−r∗

1 ).

Next we verify that (n1/2τr1n)−2ˆκ+
with wppa 1. First, note that

j , j = r∗

1 + 1, . . . , d + 1, cannot solve the determinantal equation | ˆξ1(κ)| = 0

r1nB+(cid:48)
τ −2

n,0,r∗
1

U +(cid:48)
n

ˆJ +(cid:48) ˆH (cid:48) ˆH ˆJ +U +

n B+

n,0,r∗
1

pπ
−→ h2

6,r∗
1

.

(A.189)

Then, using (A.184), (A.187) and (A.189), for j = r∗

1 + 1, . . . , d + 1,

˜ξj1 ≡ ˆξ1((n1/2τr1n)−2ˆκ+
j )

= τ −2

r1nB+(cid:48)

n,0,r∗
1

U +(cid:48)
n

ˆJ +(cid:48) ˆH (cid:48) ˆH ˆJ +U +

n B+

n,0,r∗
1

− (n1/2τr1n)−2ˆκ+

j (Ir∗

1

= h∗2

6,r∗
1

= h∗2

6,r∗
1

+ opπ (1) − opπ (1)(Ir∗

1

+ opπ (1))

+ opπ (1).

Note that λmin(h∗2
6,r∗
1

) > 0 because h6,l > 0 for all l = 1, . . . , r∗

1 − 1. Hence,

| ˆξ1((n1/2τr1n)−2ˆκ+

j )| (cid:54)= 0

69

+ ˆE+
1 )

(A.190)

(A.191)

wppa 1. Using the determinant formula for partitioned matrices,

n U +(cid:48)
n

ˆJ +(cid:48) ˆH (cid:48) ˆH ˆJ +U +

n B+

n − κ(Id+1 + ˆE+)(cid:12)
(cid:12)

0 = (cid:12)
(cid:12)τ −2
r1nB+(cid:48)
(cid:12)

ˆξ1(κ)
(cid:12)
(cid:12)
(cid:12)

ˆξ2(κ)(cid:48)
(cid:12)
(cid:12)

=

(cid:12)

(cid:12)
(cid:12)
(cid:12)

(cid:12)
(cid:12)
= | ˆξ1(κ)|| ˆξ3n(κ) − ˆξ2(κ)(cid:48) ˆξ1(κ)−1 ˆξ2(κ)|

ˆξ2(κ)
ˆξ3(κ)

= | ˆξ1(κ)||τ −2

r1nB+(cid:48)
1 ,d+1U +(cid:48)
n,r∗
ˆξ1(κ)−1 ˆE+
2 + κ ˆE+(cid:48)

n

2

− (cid:37)(cid:48)
n

ˆξ1(κ)−1 ˆE+
2

(cid:1)|,

ˆJ +(cid:48) ˆH (cid:48) ˆH ˆJ +U +

n B+

n,r∗

1 ,d+1 − (cid:37)(cid:48)

n

(A.192)

ˆξ1(κ)−1(cid:37)n

(A.193)

ˆξ1(κ)−1(cid:37)n − κ(cid:0)Id+1−r∗

1

+ ˆE+

3 − ˆE+(cid:48)

2

for κ equal to any solution (n1/2τr1n)−2ˆκ+
j
1 + 1, . . . , d + 1, solve | ˆξ3(κ) − ˆξ2(κ)(cid:48) ˆξ1(κ)−1 ˆξ2(κ)| = 0. Thus,
r∗

to the equation (A.192). From (A.191), (n1/2τr1n)−2ˆκ+

j , j =

r1nB+(cid:48)
1 ,d+1U +(cid:48)
|τ −2
n,r∗
− (n1/2τr1n)−2ˆκ+

n

ˆJ +(cid:48) ˆH (cid:48) ˆH ˆJ +U +

n,r∗

n B+
+ ˆEj2)| = 0,

j (Id+1−r∗

1

1 ,d+1 − o((τr2n/τr1n)2) + Opπ ((n1/2τr1n)−2)

where ˆEj2 ≡ ˆE3 − ˆE(cid:48)
2
equation in the previous display by τ −2

˜ξ−1
j1 (cid:37)n − (cid:37)(cid:48)
n

˜ξj1 ˆE2 + (n1/2τr1n)−2ˆκ+

1 ). Multiplying the
r1n and using Opπ ((n1/2τr1n)−2) = opπ (1) which follows from

ˆE2 ∈ R(d+1−r∗

1 )×(d+1−r∗

˜ξ−1
j1

ˆE(cid:48)
2

r2n/τ −2

j

r2 ≤ q and n1/2τjn → ∞ for all j ≤ q,

r2nB+(cid:48)
|τ −2
n,r∗

1 ,d+1U +(cid:48)

n

ˆJ +(cid:48) ˆH (cid:48) ˆH ˆJ +U +

n B+

n,r∗

1 ,d+1 + opπ (1) − (n1/2τr2n)−2ˆκ+

j (Id+1−r∗

1

+ ˆEj2)| = 0,

(A.194)

Thus, {(n1/2τr2n)−2ˆκ+

j : j = r∗

1 + 1, . . . , d + 1} solve

r2nB+(cid:48)
|τ −2
n,r∗

1 ,d+1U +(cid:48)

n

ˆJ +(cid:48) ˆH (cid:48) ˆH ˆJ +U +

n B+

n,r∗

1 ,d+1 + opπ (1) − κ(Id+1−r∗

1

+ ˆEj2)| = 0.

(A.195)

On noting that ˆE2 = opπ (1) and ˆE3 = opπ (1) by (A.184), ˜ξ−1
(A.188), τr2n ≤ τr1n, n1/2τr1n → 0, and (n1/2τr1n)−2ˆκ+

j1 = Opπ (1) by (A.190), and (cid:37)n = opπ (1) using

j = opπ (1) for j = r∗

1 + 1, . . . , d + 1 by (A.187),

Now the same argument is repeated for the subsequent groups of indices. Speciﬁcally, replace (A.181) and

ˆEj2 = opπ (1).

(A.196)

(A.184) by (A.195) and (A.196), and replace j = r∗

1 + 1, . . . , d + 1, ˆE, B+

h∗

6,r∗
1

n,0,r∗
1

, B+

, and B+

n,r∗
1 +2, . . . , (cid:81)r∗
h∗
1 +1, h6,r∗
6,r∗
2
tively. Moreover, ˆEj2 is partitioned further as

1 ,d+1 by j = r∗
1 +1h6,r∗

≡ diag(1, h6,r∗

2 + 1, . . . , d + 1, ˆEj2, B+
2 −r∗
1 +1 h6,l) ∈ R(r∗

2 −1
l=r∗

n,d+1−r∗
1
2 −r∗
1 )×(r∗

n , τr1n, τr2n, r∗
2 − r∗
, and B+

, τr2n, τr3n, r∗
1 ), B+

n,r∗

1 ,r∗
2

1, d + 1 − r∗
1,
1, d + 1 − r∗
2,
2 ,d+1, respec-

n,r∗

ˆEj2 =


ˆE1j2

ˆE(cid:48)

2j2

ˆE2j2
ˆE3j2


 , ˆE1j2 ∈ Rr∗

2 ×r∗

2 , ˆE2j2 ∈ Rr∗

2 ×(d+1−r∗

1 −r∗

2 ), ˆE3j2 ∈ R(d+1−r∗

1 −r∗

2 )×(d+1−r∗

1 −r∗

2 ).

The analog of (A.195) is that {(n1/2τr3n)−2ˆκ+

j : j = r∗

2 + 1, . . . , d + 1} solve

r3nB+(cid:48)
|τ −2
n,r∗

2 ,d+1U +(cid:48)

n

ˆJ +(cid:48) ˆH (cid:48) ˆH ˆJ +U +

n B+

n,r∗

2 ,d+1 + opπ (1) − κ(Id+1−r∗

2

+ ˆEj3)| = 0,

(A.197)

70

where

ˆEj3 ≡ ˆE3j2 − ˆE(cid:48)

2j2

˜ξ−1
1j2(cid:37)2n − (cid:37)(cid:48)
2n

˜ξ−1
1j2

ˆE2j2 + (n1/2τr2n)−2ˆκ+

j

ˆE(cid:48)

2j2

˜ξ−1
1j2

ˆE2j2,

˜ξ1j2 ≡ ˆξ1j2((n1/2τr2n)−2ˆκ+
j )

= τ −2

r2nB+(cid:48)
n,r∗

1 ,r∗
2

U +(cid:48)
n

ˆJ +(cid:48) ˆH (cid:48) ˆH ˆJ +U +

n B+

n,r∗

1 ,r∗
2

− (n1/2τr2n)−2ˆκ+

j (Ir∗

2 −r∗
1

+ ˆE1j2)

= h∗2

6,r∗
2

= h∗2

6,r∗
2

+ opπ (1) − opπ (1)(Ir∗

2 −r∗
1

+ opπ (1))

+ opπ (1),

(cid:37)2n ≡ τ −2

r2nB+(cid:48)
n,r∗

1 ,r∗
2

U +(cid:48)
n

ˆJ +(cid:48) ˆH (cid:48) ˆH ˆJ +U +

n B+

n,r∗

2 ,d+1.

Analogously to (A.185), (A.186) and (A.187), it then follows that

pπ
−→ ∞,

ˆκ+
j

j = r2, . . . , r∗
2,

(n1/2τr2n)−2ˆκ+

j = opπ (1),

j = r∗

2 + 1, . . . , d + 1.

Then, repeating the previous steps Gh − 2 more times gives (as veriﬁed below)

pπ
−→ ∞,

ˆκ+
j

j = 1, . . . , r∗

Gh

,

(n1/2τrgn)−2ˆκ+

j = opπ (1),

j = r∗

g + 1, . . . , d + 1,

g = 1, . . . , Gh.

(A.198)

(A.199)

(A.200)

(A.201)

Since r∗

Gh

= q, the part (a) of the lemma follows from (A.199). Setting g = Gh in (A.201) and noting that

r∗
Gh

= q yield

(n1/2τrGh n)−2ˆκ+

j = opπ (1),

j = q + 1, . . . , d + 1.

If rGh = r∗
Gh
h6,l > 0 for all l = rGh , . . . , r∗
Gh

= q, from (A.202) (n1/2τqn)−2ˆκ+

j = opπ (1) for j = q + 1, . . . , d + 1. If rGh < r∗
Gh

− 1,

lim
n→∞

τqn
τrGh n

= lim
n→∞

τr∗
n
Gh
τrGh n

=

−1

r∗
Gh
(cid:89)

j=rGh

h6,j > 0.

(A.202)

= q, using

(A.203)

Combining (A.202) and (A.203), (n1/2τqn)−2ˆκ+

j = opπ (1) for j = q + 1, . . . , d + 1. On noting that τln ≥ τqn
for l ≤ q, the part (b) of the lemma follows. The result for all subsequences {wn} and {λwn,h ∈ Λ : n ≥ 1}

holds analogously. The formal induction proof of (A.200) and (A.201) are provided next.

Step 2: Using induction to complete the proof. Denote ogp denote a symmetric (d + 1 −
g−1) × (d + 1 − r∗
r∗
Opπ ((n1/2τrgn)−1). ogp = opπ (1) because r∗
n1/2τrgn → ∞ for g = 1, . . . , Gh. The goal is to show that {(n1/2τrgn)−2ˆκ+

rgn) +
g−1 + l ≥ rg for l ≥ 1 as τjn’s are nonincreasing in j, and

g−1) matrix whose (l, m), l, m = 1, . . . , d + 1 − r∗

g−1, element is opπ (τ(r∗

g−1 + 1, . . . , d + 1} solve

g +l)n/τ 2

g +l)nτ(r∗

j : j = r∗

rgnB+(cid:48)
|τ −2
n,r∗

g−1,d+1U +(cid:48)

n

ˆJ +(cid:48) ˆH (cid:48) ˆH ˆJ +U +

n B+

n,r∗

g−1,d+1 + ogp − κ(Id+1−r∗

g−1

+ ˆEjg)| = 0,

(A.204)

for some (d+1−r∗
over g = 1, . . . , Gh. For g = 1, the above holds upon noting that ˆEjg = ˆE, ogp = 0, r∗

g−1) symmetric matrices ˆEjg = opπ (1) and ogp. This is shown using induction
0 ≡ 0 and

g−1)×(d+1−r∗

g−1 = r∗

71

B+

n,rg−1,d+1 = B+

n,0,d+1 = B+

n . Now suppose that (A.197) holds for g with ˆEjg = opπ (1) and ogp. Proceeding

similarly to the argument in (A.183)

τ −1
rgn

ˆH ˆJ +U +

n B+

n,r∗

g−1,d+1



= τ −1

rgn(Ik + opπ (1))An








g −r∗

g−1)

0r∗

g−1×(r∗
h∗

6,r∗
g

0(k−r∗

g )×(r∗

g −r∗

g−1)

pπ
−→ h3

and h∗
r∗
g

0r∗

g−1×(d+1−r∗
g )
diag(τrgn, . . . , τ(d+1)n)






0(k−d−1)×(d+1−r∗

g−1)

0r∗

g−1×(d+1−r∗
g )

0(r∗

g −r∗
0(k−r∗

g−1)×(d+1−r∗
g )

g )×(d+1−r∗
g )








+ Opπ ((n1/2τrgn)−1),

(A.205)








, h∗

6,r∗
g

≡ diag(1, h6,rg , . . . ,

r∗
g −1
(cid:89)

l=1

h6,l) ∈ R(r∗

g −r∗

g−1)×(r∗

g −r∗

g−1),

≡ 1 for r∗

g = 1. From (A.205) and h(cid:48)

3h3 = Ik = limn→∞ A(cid:48)

nAn,

rgnB+(cid:48)
τ −2
n,r∗

g−1,d+1U +(cid:48)

n

ˆJ +(cid:48) ˆH (cid:48) ˆH ˆJ +U +

n B+

n,r∗

g−1,d+1

pπ
−→





h∗2

6,r∗
g

0(d+1−r∗

g )×(r∗

g −r∗

g−1)

0(r∗

g −r∗
0(d+1−r∗

g−1)×(d+1−r∗
g )

g )×d+1−r∗
g )



 .

(A.206)

Using (A.197) which is assumed to hold in the induction step and ogp = opπ (1), wppa 1, {(n1/2τrgn)−2ˆκj :
j = r∗

g−1 + 1, . . . , d + 1} solve

|(Id+1−r∗

g−1

+ ˆEjg)−1τ −2

rgnB+(cid:48)
n,r∗

g−1,d+1U +(cid:48)

n

ˆJ +(cid:48) ˆH (cid:48) ˆH ˆJ +U +

n B+

n,r∗

g−1,d+1 + opπ (1) − κId+1−r∗

g−1

| = 0.

(A.207)

By the same arguments that led to (A.185)-(A.187), (A.206), (A.207) and the induction assumption that
ˆEjg = opπ (1),

pπ
−→ ∞,

ˆκ+
j

j = r∗

g−1, . . . , r∗
g,

(n1/2τrgn)−2ˆκ+

j = opπ (1),

j = r∗

g + 1, . . . , d + 1.

(A.208)

(A.209)

Let o∗

gp denote an (r∗

g − r∗

g−1) × (d + 1 − r∗

are opπ (τ(r∗

g +j)n/τrgn) + Opπ ((n1/2τrgn)−1). Then o∗

g) matrix whose elements in column j, j = 1, . . . , d + 1 − r∗
g,
g−1,d+1 in (A.183) with

gp = opπ (1). Next replacing B+

n,r∗

Bn,r∗

g ,d+1 and Bn,r∗

g−1,r∗
g

, and multiplying the resulting matrices give

(cid:37)gn ≡ τ −2

rgnB+(cid:48)
n,r∗


g−1,r∗
g

U +(cid:48)
n

ˆJ +(cid:48) ˆH (cid:48) ˆH ˆJ +U +
n B+

(cid:48)

n,r∗

g ,d+1



0r∗

g−1×(r∗

g−1)
diag(τ(rg−1+1)n, . . . , τr∗

g −r∗

=






0(k−r∗

g )×(r∗

g −r∗

g−1)

= o∗

gp ∈ R(r∗

g −r∗

g−1)×(d+1−r∗

g ),

g n)/τrgn






A(cid:48)

n(Ik + opπ (1))An






0r∗

g−1×(r∗

g−1)
diag(τ(rg−1+1)n, . . . , τr∗

g −r∗

g n)/τrgn

0(k−r∗

g )×(r∗

g −r∗

g−1)








+ Opπ ((n1/2τrgn)−1)

(A.210)

where diag(τ(rg−1+1)n, . . . , τr∗
Partition the (d + 1 − r∗

g n)/τrgn = h∗
g−1) × (d + 1 − r∗


6,r∗
g
g−1) matrices ogp and ˆEjg as:


+o(1), and the last equality uses A(cid:48)

n(Ik+opπ (1))An = Ik+opπ (1).

 ,

ˆEjg =

 ,

o1gp, ˆE1jg ∈ R(r∗

g −r∗

g−1)×(r∗

g −r∗

g−1),

ogp =





o1gp

o(cid:48)
2gp

o2gp

o3gp


ˆE1jg

ˆE(cid:48)

2jg

ˆE2jg
ˆE3jg

72

o2gp, ˆE2jg ∈ R(r∗

g −r∗

g−1)×(d+1−r∗

g ), o3gp, ˆE3jg ∈ R(d+1−r∗

g )×(d+1−r∗

g ), j = r∗

g−1 + 1, . . . , d + 1 and g = 1, . . . , Gh.

Deﬁne

ˆξ1jg(κ) ≡ τ −2

r1nB+(cid:48)
n,r∗

g−1,r∗
g

U +(cid:48)
n

ˆJ +(cid:48) ˆH (cid:48) ˆH ˆJ +U +

n B+

n,r∗

g−1,r∗
g

+ o1gp − κ(Ir∗

g −r∗

g−1

+ ˆE1jg) ∈ R(r∗

g −r∗

g−1)×(r∗

g −r∗

g−1),

ˆξ2jg(κ) ≡ (cid:37)gn + o2gp − κ ˆE2jg ∈ R(r∗

g −r∗

g−1)×(d+1−r∗

g ),

ˆξ3jg(κ) ≡ τ −2

rgnB+(cid:48)
n,r∗

g ,d+1U +(cid:48)

n

ˆJ +(cid:48) ˆH (cid:48) ˆH ˆJ +U +

n B+

n,r∗

g ,d+1 + o3gp − κ(Id+1−r∗

g

+ ˆE3jg) ∈ Rd+1−r∗

g ×(d+1−r∗

g ).

From (A.197), {(n1/2τrgn)−2ˆκj : j = r∗

g−1 + 1, . . . , d + 1} solve

n

ˆH (cid:48)
n

n U +

n B+

ˆHn ˆJ +

0 = (cid:12)
rgnB+(cid:48)
(cid:12)τ −2
n,r∗
(cid:12)

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

ˆJ +(cid:48)
g−1,d+1U +(cid:48)
n
(cid:12)

ˆξ2jg(κ)
(cid:12)
(cid:12)
(cid:12)

ˆξ3jg(κ)
(cid:12)
(cid:12)
= | ˆξ1jg(κ)|| ˆξ3jg(κ) − ˆξ2jg(κ)(cid:48) ˆξ1jg(κ)−1 ˆξ2jg(κ)|

ˆξ1jg(κ)

ˆξ2jg(κ)(cid:48)

n,r∗

=

g−1,d+1 + ogp − κ(Id+1−r∗

g−1

+ ˆEjgn)(cid:12)
(cid:12)

(A.211)

ˆJ +(cid:48) ˆH (cid:48) ˆH ˆJ +U +

n B+

n,r∗

g ,d+1 + o3gp − ((cid:37)gn + o2gpπ )(cid:48) ˆξ1jgn(κ)−1((cid:37)gn + o2gp)

= | ˆξ1jg(κ)||τ −2

rgnB+(cid:48)
n,r∗

g ,d+1U +(cid:48)
+ ˆE3jg − ˆE(cid:48)

n

− κ(cid:0)Id+1−r∗
− ((cid:37)gn + o2gp)(cid:48) ˆξ1jg(κ)−1 ˆE2jg + κ ˆE(cid:48)

2jg

g

ˆξ1jg(κ)−1((cid:37)gn + o2gpπ )

ˆξ1jg(κ)−1 ˆE2jg

(cid:1)|,

(A.212)

2jg

where the second equality holds by the formula of partitioned matrix determinant provided

(cid:16)

ˆξ1jg

(n1/2τrgn)−2ˆκj

(cid:17)

, j = r∗

g−1 + 1, . . . , d + 1}

is nonsingular wppa 1, a fact that is veriﬁed below. By the same argument as in (A.190), ˆE1jg = opπ (1)

which holds by deﬁnition, and ogp = opπ (1),

˜ξ1jg ≡ ˆξ1jg((n1/2τrgn)−2ˆκj) = h∗2
6,r∗
g

+ opπ (1).

(A.213)

Since λmin(h∗2
6,r∗
g

) > 0, ˆξ1jgn

(cid:0)(n1/2τrgn)−2ˆκj

(cid:1) , j = r∗

g−1 + 1, . . . , d + 1, is nonsingular wppa 1. Therefore,

0 =|τ −2

rgnB+(cid:48)
n,r∗

g ,d+1U +(cid:48)
+ (n1/2τrgn)−2ˆκ+

n

j (Id+1−r∗

g

+ ˆEj(g+1)n)|,

ˆJ +(cid:48) ˆH (cid:48) ˆH ˆJ +U +

n B+

n,r∗

g ,d+1 + o3gp − ((cid:37)gn + o2gp)(cid:48) ˜ξ−1

1jg((cid:37)gn + o2gpπ )

where

Furthermore,

ˆEj(g+1) ≡ ˆE3jg − ˆE(cid:48)

2jg

˜ξj1g((cid:37)gn + o2gp) − ((cid:37)gn + o2gp)(cid:48) ˜ξj1g ˆE2jg
ˆE2jg ∈ R(d+1−r∗

g )×(d+1−r∗

ˆE(cid:48)

g ).

˜ξ−1
1jg

2jg

+ (n1/2τrgn)−2ˆκ+
j

o3gp − ((cid:37)gn + o2gp)(cid:48) ˜ξ−1

1jg((cid:37)gn + o2gp) = o3gp − (o∗

gp + o2gp)(cid:48)(h∗−2
6,r∗
g

+ opπ (1))(o∗

gp + o2gp)

= o3gp − o∗(cid:48)

gpo∗
gp

= (τ 2

rg+1n/τ 2

rgn)o(g+1)p,

where

73

(A.214)

(A.215)

(A.216)

1. the ﬁrst equality follows from (A.210) and (A.213);

2. the second equality uses o2gp = o∗

gp. The latter holds because the (j, m), j = 1, . . . , r∗

g − r∗

g−1, m =

1, . . . , d + 1 − r∗

g element is

opπ (τ(r∗

g−1+j)nτ(r∗

g +m)n/τ 2

rgn) + Opπ ((n1/2τrgn)−1) = opπ (τ(r∗

g +m)n/τrgn) + Opπ ((n1/2τrgn)−1)

since r∗

g−1 + j ≥ rg and (h∗−2
6,r∗
g

λmin(h∗2
6,r∗
g

) > 0;

+ opπ (1))o∗

gp = o∗

gp which in turn holds because h∗

6,r∗
g

is diagonal and

3. the third equality uses the fact that the (j, m), j, m = 1, . . . , d + 1 − r∗

g, of (τ 2

rgn/τ 2

rg+1n)o3gp is of order

opπ (τ(r∗

g +j)nτ(r∗

g +m)n/τ 2

rgn)(τ 2

= opπ (τ(r∗

g +j)nτ(r∗

g +m)n/τ 2

rgn/τ 2

rg+1n) + Opπ ((n1/2τrgn)−1)(τ 2

rgn/τ 2
rg+1n) + Opπ ((n1/2τrg+1n)−1)(τrgn/τrg+1n)

rg+1n)

which is the same order as the (j, m) element of o(g+1)p using τrgn/τrg+1n ≤ 1;

4. the third equality also uses the fact that the (j, m), j, m = 1, . . . , d + 1 − r∗

g, is of (τ 2

rgn/τ 2

rg+1n)o∗(cid:48)

gpo∗
gp

is the sum of two terms that are of orders

g +m)n/τ 2

rgn)(τ 2

rgn/τ 2

rg+1n) = opπ (τ(r∗

g +j)nτ(r∗

g +m)n/τ 2

rg+1n),

opπ (τ(r∗

g +j)nτ(r∗
Opπ ((n1/2τrgn)−2)(τ 2

rgn/τ 2

rg+1n) = Opπ ((n1/2τrg+1n)−2),

respectively. Thus, (τ 2

rgn/τ 2

rg+1n)o∗

gpo∗

gp is o(g+1)p.

For j = r∗

g + 1, . . . , d + 1, since ˆE2jg = opπ (1) and ˆE3jg = opπ (1) by (A.197), ˜ξ1jg = Opπ (1) by (A.213),
gp = opπ (1) and (n1/2τrgn)−2ˆκ+
j = opπ (1) by (A.199), it follows

(cid:37)gn + o2gp = opπ (1) by (A.210) and since o∗

that

Using (A.216) and (A.217) in (A.214),

ˆEj(g+1) = opπ (1).

(A.217)

rg+1nB+(cid:48)
|τ −2
n,r∗

g ,d+1U +(cid:48)

n

ˆJ +(cid:48) ˆH (cid:48) ˆH ˆJ +U +

n B+

n,r∗

g ,d+1 + o(g+1)p − (n1/2τrg+1n)−2ˆκ+

j (Id+1−r∗

g

+ ˆEj(g+1))| = 0,

(A.218)

Thus, wppa 1 {(n1/2τrg+1n)−2ˆκ+

j : j = rg+1, . . . , d + 1} solve

rg+1nB+(cid:48)
|τ −2
n,r∗

g ,d+1U +(cid:48)

n

ˆJ +(cid:48) ˆH (cid:48) ˆH ˆJ +U +

n B+

n,r∗

g ,d+1 + o(g+1)p − κ(Id+1−r∗

g

+ ˆEj(g+1))| = 0.

(A.219)

This completes the induction step and (A.197) holds for all g = 1, . . . , Gh.

74

