Draft version July 26, 2022
Typeset using LATEX preprint style in AASTeX631

2
2
0
2

l
u
J

3
2

]

R
S
.
h
p
-
o
r
t
s
a
[

2
v
4
5
2
7
0
.
7
0
2
2
:
v
i
X
r
a

Relationship between Successive Flares in the Same Active Region and Space-Weather
HMI Active Region Patch (SHARP) Parameters

Hao Ran,1, 2 Ying D. Liu,1, 2 Yang Guo,3 and Rui Wang1

1State Key Laboratory of Space Weather, National Space Science Center, Chinese Academy of Sciences, Beijing
100190, China; liuxying@swl.ac.cn
2University of Chinese Academy of Sciences, Beijing 100049, China
3School of Astronomy and Space Science, Nanjing University, Nanjing 210023, China

ABSTRACT
A solar active region (AR) may produce multiple notable ﬂares during its passage
across the solar disk. We investigate successive ﬂares from ﬂare-eruptive active regions,
and explore their relationship with solar magnetic parameters. We examine six ARs
in this study, each with at least one major ﬂare above X1.0. The Space-Weather HMI
Active Region Patch (SHARP) is employed in this study to parameterize the ARs.
We aim to identify the most ﬂare-related SHARP parameters and lay foundation for
future practical ﬂare forecasts. We ﬁrst evaluate the correlation coeﬃcients between
the SHARP parameters and the successive ﬂare production. Then we adopt a Natural
Gradient Boost (NGBoost) method to analyze the relationship between the SHARP
parameters and the successive ﬂare bursts. Based on the correlation analysis and the
importance distribution returned from NGBoost, we select 8 most ﬂare-related SHARP
parameters. Finally, we discuss the physical meanings of the 8 selected parameters and
their relationship with ﬂare production.

1. INTRODUCTION

As one of the most prominent eruptive phenomena, solar ﬂares can produce signiﬁcant space weather
eﬀects including energetic particles. In ﬂare-eruptive active regions (ARs), ﬂares may occur succes-
sively. Since solar ﬂares are often accompanied by coronal mass ejections (CMEs), successive ﬂare
bursts may appear with successive CMEs, the interaction between which may result in extreme
space weather (Liu et al. 2014b, 2019). Establishing a practical ﬂare forecast system, especially
for successive ﬂare bursts in the same AR, is thus of importance for space weather. Since the
vector magnetic ﬁeld can only be mapped directly in the photosphere, using photospheric mag-
netic ﬁeld data to parameterize ARs has been widely adopted in studies about ﬂare prediction(e.g.,
Yang et al. 2013; Bobra & Couvidat 2015; Wang et al. 2019, 2020; Cicogna et al. 2021; Yi et al. 2021;
Ribeiro & Gradvohl 2021). Due to the complex current distribution (T¨or¨ok et al. 2014) and the mag-
netic ﬁeld evolution, it is diﬃcult to derive a single parameter that governs ﬂare production in the
same AR. Therefore, identifying parameters that are the most relevant to ﬂare productivity is of
great importance.

The Helioseismic and Magnetic Imager (HMI; Schou et al. 2012), aboard the Solar Dynamics
Observatory (SDO), continuously maps the full-disk photospheric vector magnetic ﬁeld since 2010

 
 
 
 
 
 
2

Ran et al.

May 1 every 12 minutes. It also provides a data product named Space-Weather HMI Active Region
Patch (SHARP), which oﬀers a series of key parameters derived from the magnetic ﬁeld in ARs
(Bobra et al. 2014; Hoeksema et al. 2014). Lee et al. (2018) applied I8d, the sum of the GOES soft
X-ray peak ﬂuxes of ﬂares in the same AR for 8 days, to investigate the correlation between SHARP
parameters and ﬂare productivity in time-series, concluding that the SHARP parameters are to some
extent related to ﬂare productivity. Wang et al. (2019) calculated the SHARP parameters in the
polarity inversion line area of an AR, and employed a Support Vector Machine (SVM) algorithm to
perform ﬂare prediction with the modiﬁed SHARP parameters. Many of the previous ﬂare prediction
studies focus on determining if an AR is ﬂare-eruptive or ﬂare-quiet, instead of looking into the
successive ﬂare bursts along with the evolution of the AR (e.g., Yang et al. 2013; Bobra & Couvidat
2015; Wang et al. 2019; Cicogna et al. 2021; Yi et al. 2021; Ribeiro & Gradvohl 2021). Some studies
considered the successive ﬂare production, but focused on only limited parameters such as the degree
of current neutralization (e.g., Kontogiannis et al. 2017). Here our approach is diﬀerent. We consider
all the ﬂares above C1.0 in the same AR, and study the relationship between the successive ﬂare
bursts and SHARP parameters.

The polarity inversion line (PIL), where the polarity of the magnetic ﬁeld is reversed, has
been proved to have strong relationships with solar ﬂares and CMEs (e.g., Falconer et al. 2002;
Mason & Hoeksema 2010; Welsch et al. 2011; Georgoulis et al. 2012; Moore et al. 2012; T¨or¨ok et al.
2014; Liu et al. 2017a; Wang et al. 2018, 2022). Parameters, such as the shear angle and the emerg-
ing magnetic ﬂux, have been proved to have a proportional relationship with ﬂare productivity, if
narrowed to the PIL area (Moore et al. 1987; Schrijver 2007). Previous works suggest that the PIL
modiﬁed SHARP parameters perform better than original SHARP parameters with respect to ﬂare
prediction(e.g., Wang et al. 2019; Cicogna et al. 2021). In our study, we also employ similar methods
to see the eﬀect of PIL modiﬁcation when studying the successive ﬂares in the same ARs.

In this paper, we evaluate the relationship between SHARP parameters and successive ﬂare pro-
duction in two ways. The ﬁrst method is the calculation of correlation coeﬃcients. The second
method is based on a machine learning algorithm named Natural Gradient Boost (NGBoost), which
is a gradient boost algorithm that can be easily used without time-consuming hyperparameter tuning
(Duan et al. 2020). This algorithm returns a probability distribution for the target and an impor-
tance distribution of the input parameters.
In this study, the input parameters are the SHARP
parameters. With the correlation result and the importance distribution returned from NGBoost,
we could identify the most ﬂare-related SHARP parameters, and make a physical analysis.

The paper is organized as follows. In Section 2, we describe the data and the methodology that are
employed in this paper. In Section 3, we show the correlation results, the importance distribution of
the SHARP parameters, and the test of the selection. The underlying physics analysis of the selected
parameters is also discussed in Section 3. The conclusion is given in Section 4.

2. DATA AND METHODOLOGY

2.1. Active Region Selection

We have selected 6 ARs, which all have at least one major ﬂare above level X1.0. Table 1 lists the
index, start and end time, number of ﬂares, maximum ﬂare, and the number of groups of SHARP
data that we have employed for the ARs.

AASTeX v6.3.1 Sample article

3

Table 1. List of active regions in our study.

AR

Start time

End time

11158 2011-02-13 11:58:12 2011-02-18 11:46:12
11166 2011-03-08 23:58:14 2011-03-11 23:46:15
11283 2011-09-05 23:58:22 2011-09-10 23:46:21
11429 2012-03-04 15:58:14 2012-03-12 13:58:15
12017 2014-03-26 23:58:16 2014-03-31 23:46:17
12673 2017-09-01 23:58:42 2017-09-07 18:46:41

Number of ﬂares Maximum ﬂare Groups of data
X2.2
X1.5
X2.1
X5.4
X1.0
X9.3

600
357
599
900
588
620

41
12
13
45
15
42

Since the ARs are at diﬀerent latitudes, and the longitudes of them are also diﬀerent when they
are formed, the time durations for them to stay on the visible side of the Sun are diﬀerent, resulting
in diﬀerences in the eﬀective observation times.

The ARs have been studied widely from many aspects, such as the energy release process (e.g.,
Tarr et al. 2013; Feng et al. 2013; Wang et al. 2014, 2018, 2022), the structure of the nonlinear force-
free ﬁeld (e.g., Feng et al. 2013; Wang et al. 2013; Vemareddy & Wiegelmann 2014), and the CMEs
associated with the major ﬂares (e.g., Liu et al. 2013, 2014a).

2.2. Flare “Envelope” Curve

The intensity of ﬂares is deﬁned by GOES Soft X-ray (SXR) ﬂux, and we only select the ﬂares
bigger than C1.0 that has a peak ﬂux of 1 × 10−6 W/m2. We ignore the temporal evolution of an
individual ﬂare, and deﬁne its time tag as the ﬂare peak time. The curve “enveloping” successive
ﬂares is calculated from:

fi = log10(Φi) + 6,

(1)

where fi is the deﬁned ﬂare index in the ﬂare “envelope”, and Φi is the corresponding peak ﬂux. The
ﬂare data and the GOES SXR data are obtained from the SolarﬂareDatabase 1. An example of the
ﬂare “envelope” of AR 12673 is shown in Figure 1b.

The use of the ﬂare envelope allows us to derive the ﬂare data in a speciﬁc AR instead of the whole
solar disk, and set a threshold for the ﬂares conveniently. Flares from other ARs can be readily
eliminated. It also allows us to easily adjust the temporal resolution of the ﬂare curve to match the
temporal resolution of SHARP. The main disadvantage of the envelope curve is that it is obtained
from discrete ﬂare bursts. Temporal details of individual ﬂares are ignored when the ﬂare “envelope”
curve is employed.

Note that the ﬂare envelope curve is less zigzag than the curves derived from the original GOES
SXR ﬂux curve. For example, we have tried another curve that is directly derived from the GOES
SXR ﬂux curve (see Figure 1a). The GOES SXR data points are kept if they are within the timespan
of the ﬂares from the selected AR. The removed data points are ﬁlled by a linear interpolation.
Compared to the ﬂare envelope curve, the new curve is not signiﬁcantly diﬀerent in shape but much
more zigzag. A more zigzag curve of ﬂares will increase the diﬃculty for correlation analysis and
further NGBoost analysis.

1 https://solarﬂare.njit.edu/datasources.html

4

Ran et al.

GOES SXR Curve

Flare Envelope Curve

3.0

a

2.5

2.0

1.5

l

e
u
a
V
e
p
o
e
v
n
E

l

1.0

e
r
a
F

l

0.5

0.0

b

3.0

2.5

2.0

1.5

1.0

0.5

0.0

02

03

04
05
September 2017

06

07

08

02

03

04
05
September 2017

06

07

08

Figure 1. The original GOES SXR curve and the ﬂare “envelope” of AR 12673. Panel “a” refers to the
original GOES SXR curve, and panel “b” represents the corresponding ﬂare “envelope”. The temporal
resolution of both panels is 720s, which is the same as that of the SHARP data.

2.3. Space-Weather HMI Active Region Patch (SHARP)
SHARP2 provides a series of key parameters derived from photospheric magnetic ﬁelds. We have
selected 16 typical SHARP parameters (Bobra et al. 2014). Table 2 lists the keywords, the descrip-
tions and the calculation formulas for all the SHARP parameters we have used in this study. The
parameters are generally adopted from Leka & Barnes (2003a).

2.4. Correlation and NGBoost Analysis

First, we look at the SHARP parameters for the whole AR, and calculate the correlation coeﬃcients
between the SHARP curves and the ﬂare envelope. We also look at the SHARP parameters in the PIL
area to study how PIL modiﬁcation aﬀects the correlation results. The method to identify the PIL
initially comes from Schrijver (2007). To be speciﬁc, we set a threshold of 2σ (200G) (Hoeksema et al.
2014), any positive ﬁeld pixel with Br > 200G is set to 1 and the rest are 0 to make the positive
bitmap, and any negative ﬁeld pixel with Br < −200G is set to -1 and the rest are 0 to make
the negative bitmap. Then we adopt a cluster algorithm called Density-Based Spatial Clustering of
Applications with Noise (DBSCAN; Ester et al. 1996) to remove the noise data points and leave
only the main parts of the positive and negative bitmaps. We ﬁnally multiply the two bitmaps after
convolving them with a Gaussian kernel to generate the PIL mask.

We also adopt a Natural Gradient Boost (NGBoost) method3 (Duan et al. 2020) to analyze the
relationship between ﬂare production and SHARP parameters and obtain the importance distribu-
tion. The NGBoost method is a gradient boosting algorithm for probabilistic regression problems,
which returns a possibility distribution of the target. The possibility distribution is deﬁned by two
parameters, “location” and “scale”. The “location” parameter represents the location of the max-

2 http://jsoc.standford.edu/ajax/lookdata.html
3 https://stanfordmlgroup.github.io/projects/ngboost

 
 
Table 2. Brief descriptions and corresponding formulas of the SHARP parameters (Bobra et al. 2014).

AASTeX v6.3.1 Sample article

5

Keyword
TOTUSJH
TOTPOT
TOTUSJZ
ABSNJZH
SAVNCPP
USFLUX
MEANPOT
R VALUE
MEANSHR

MEANGAM
MEANGBT

MEANGBZ

MEANGBH

MEANJZH
MEANJZD

MEANALP

Description
Total unsigned current helicity
Total photospheric magnetic free energy density
Total unsigned vertical current
Absolute value of net current helicity
Sum of modulus of the net current per polarity
Total unsigned ﬂux
Mean photospheric magnetic free energy
Sum of ﬂux near PIL
Mean shear angle

Mean angle of ﬁeld from radial
Mean gradient of total ﬁeld

Mean gradient of vertical ﬁeld

Mean gradient of horizontal ﬁeld
Mean current helicity (Bz contribution)
Mean vertical current density
Mean characteristic twist parameter: α

Calculation formula
Hctotal ∝ P |Bz · Jz|
ρtot ∝ P(Bobs − Bpot)2dA
Jztotal = P |Jz|dA
Bz · Jz|
Hcabs ∝ | P
JzdA| + | PB

−
z

Φ = P |BzdA|
N P(Bobs − Bpot)2

ρ ∝ 1

Jzsum ∝ | PB+

z

JzdA|

|∇Btot| = 1
|∇Bz| = 1
|∇Bh| = 1

Bz

Φ = P |Bz|dA within R mask
N P cos−1( Bobs·Bpot
Γ = 1
|Bobs||Bpot| )
N P tan−1 Bh
γ = 1
∂x )2 + ( ∂Btot
N P[( ∂Btot
∂x )2 + ( ∂Bz
N P[( ∂Bz
N P[( ∂Bh
∂x )2 + ( ∂Bh
Hc ∝ 1
Bz · Jz
N P
N P( ∂By
∂x − ∂Bx
∂y )
α ∝ P Jz·Bz
P B2
z

Jz ∝ 1

∂y )2](1/2)
∂y )2](1/2)
∂y )2](1/2)

imum point of the distribution. It shifts the graph, relative to the normal probability distribution
function (PDF), left or right on the horizontal axis depending on if its value is negative or positive.
The “scale” parameter deﬁnes the width of the distribution. It expands or shrinks the graph, relative
to the normal PDF, depending on whether its value is larger or smaller than 1.

We apply the NGBoost method to SHARP parameters as follows. We discard the ﬁrst 2 hours of
ﬂare envelope data, and match the remaining ﬂare envelope data to the original SHARP parameters,
in order to establish a 2-hour time diﬀerence between the ﬂare envelope and the SHARP curve. This
is to explore whether the SHARP parameters before the ﬂares can reﬂect ﬂare productivity. Then,
we take the ﬁrst 10 groups of data, which includes the ﬁrst 10 groups of SHARP parameters and the
ﬁrst 10 ﬂare envelope points, to be the initial training set. We start the calculation from the 11th
groups of the SHARP parameters. With the training of the ﬁrst 10 groups of data ﬁnished, we input
the feature vector of the 11th group of SHARP parameters to the trained model, and obtain the
corresponding “ﬂare envelope” point calculated from NGBoost. An importance distribution of the
SHARP parameters in this training step is returned from NGBoost as well. In the next step, we take
the ﬁrst 11 groups of data as the training set, input the 12th SHARP parameters to the trained model,
and obtain the next calculated “ﬂare envelope” point along with a new importance distribution. This
operation is conducted to the last group of data. Finally, we attain a new “ﬂare envelope” calculated
from NGBoost and the importance distributions for all the steps. The ﬁnal importance distribution
of each SHARP parameter is the average value of all the importance distributions that we have
It is worth
obtained. The explanation of the NGBoost method can be found in the Appendix.
mentioning that the 2-hour diﬀerence between the ﬂare envelope and the SHARP parameters is only

6

Ran et al.

Figure 2. The 16 SHARP parameters and the ﬂare envelope for AR 12673. The black curve shows diﬀerent
SHARP parameters and the green curve is the ﬂare envelope. The left y-axises represent the values of the
SHARP parameters, and the right y-axises represent the ﬂare index. The correlation coeﬃcients (CCs) are
shown at the top of each panel. The SHARP parameters are normalized.

used in the “NGBoost Analysis” section (Section 3.2). In the other two sections of Section 3, the
SHARP parameters and the ﬂare envelope are simultaneous.

3. RESULTS

3.1. Correlation Analysis

As mentioned above, we ﬁrst look at the SHARP parameters in the whole AR and calculate their
correlation coeﬃcients with the ﬂare envelope to estimate how each SHARP parameter is related to
the ﬂare envelope. We take the AR 12673 as an example in Figure 2. As can be seen in Figure 2, in
AR 12673, the range of the correlation coeﬃcients (CCs) is wide for diﬀerent SHARP parameters. For
example, the CC for “TOTPOT” is over 0.8, while the absolute value of the CC for “MEANGBH”
is only 0.104, which suggests that “MEANGBH” is much less relevant to the ﬂare envelope than
“TOTPOT” in this AR.

AASTeX v6.3.1 Sample article

7

Figure 3. Scatter plot of the average and variance of the correlation coeﬃcients between the SHARP
parameters and the ﬂare envelope. The left panel refers to the whole AR case, and the right panel refers
to the PIL-modiﬁed case. The x-axis represents the average value, and y-axis represents the variance value.
A parameter has a better performance if it is closer to the lower right corner of the ﬁgure. Inside the blue
ellipse are the parameters that we think have the best performance in correlation.

We calculate the CCs for all the SHARP parameters, in the whole AR and in the PIL area, for all the
ARs that we have selected. Then we plot the average and variance of the CCs for SHARP parameters
in Figure 3. Figure 3 consists of two panels, referring to the SHARP parameters in the whole AR
and the SHARP parameters in the PIL area. We mark the parameters that we think have the
best performance in correlation with the blue ellipse in the left panel, which includes “MEANJZH”,
“MEANGBH”, “MEANALP”, “USFLUX”, “MEANPOT”, “MEANSHR” and “MEANGAM”.

Our results in Section 3.3 present that, in agreement with previous studies (e.g., Schrijver 2007;
Wang et al. 2019), the SHARP parameters that are believed to be more related to successive ﬂare
occurrence do show more signiﬁcant changes in the PIL area when major ﬂares happen. However, the
two panels in Figure 3 suggest that the average values of some SHARP parameters in the PIL area,
such as “MEANPOT” and “MEANJZH”, are lower than those in the whole AR. This is due to sharper
ﬂuctuations of the SHARP curves in the PIL area. The value of the correlation coeﬃcient between
the two curves is not only aﬀected by their overall shapes, but also their smoothness. Therefore,
the SHARP curves in the PIL area may ﬁt the ﬂare envelope better in the overall shape, but the
correlation coeﬃcients may be lower due to their stronger oscillation. The more intense ﬂuctuations
of the SHARP curves in the PIL area can be attributed to two reasons: (i) During the evolution of
a big AR, the coverage of the PIL area varies, which results in ﬂuctuations in SHARP parameters
calculated in the PIL area. (ii) Some ARs have more than one PIL at one time, while some other
ARs may have no obvious PIL. Even in the same AR, such as AR 12673, the quantity of PILs may
change with evolution. Figure 4 presents the evolution of the PILs in AR 12673. AR 12673 starts
with no obvious PIL (see Figure 4a). However, as it becomes more active, it has more than one PIL
and the coverage of the PILs increases signiﬁcantly (see Figure 4 (b-c)). Panel “d” in Figure 4 also
shows that the coverage of the PILs ﬂuctuates strongly when the AR gets complicated, which may

8

Ran et al.

Figure 4. Illustration of the change in the coverage and the number of PILs in AR 12673. Panel (a), panel
(b) and panel (c) are the composite maps of the Br map and their PILs at diﬀerent times. The PIL area is
marked by the purple lines. Panel (d) shows the change in the number of pixels of PILs in AR 12673. The
three vertical lines in panel (d) correspond to the times of panels (a-c).

cause severe ﬂuctuations in the SHARP curve. Similar features about the change in the coverage
and the number of PILs can be found in all the ARs that we select.

3.2. NGBoost Analysis

Since the correlation coeﬃcients between the ﬂare envelope and the SHARP in the whole AR are
usually higher, we only apply the NGBoost method to the SHARP parameters in the whole AR.
The result is shown in Figure 5. The blue curve is the “ﬂare envelope” we calculated from NGBoost,
and the green curve is the original ﬂare envelope. The NGBoost curves show good ﬁts to the ﬂare
envelopes in all the ARs we select.

With the importance distributions of the SHARP parameters returned from NGBoost, we calculate
the ranking of diﬀerent SHARP parameters as shown in Figure 6. It contains the ranking average and
corresponding variance of all the SHARP parameters in the 6 ARs. The x-axis stands for the ranking
average and the y-axis stands for the ranking variance, both of which are better when smaller. Thus,
if a parameter is closer to the bottom left corner, it is of more importance. As Figure 6 suggests,
we can derive “TOTPOT”, “MEANPOT”, “USFLUX” and “MEANGAM” out of the 16 parameters

AASTeX v6.3.1 Sample article

9

Figure 5. The original ﬂare envelope and the corresponding “ﬂare envelope” calculated from NGBoost for
the 6 selected ARs. The green curves are the original ﬂare envelopes, and the blue curves are from NGBoost.

as the good performance group. Combining the correlation analysis in Figure 3, we put another 4
SHARP parameters into the good performance group. The 4 SHARP parameters are “MEANJZH”,
“MEANGBH”, “MEANALP”, “MEANSHR”. All the selected parameters have been marked by the
blue ellipses.

Before we start to analyze the 8 parameters separately, we have veriﬁed the reliability of the 8
parameters by applying the NGBoost method once more to the 8 parameters instead of all the
SHARP parameters. The result is shown in Figure 7. We have also conducted the same operation
with fewer SHARP parameters, and the ﬁtting of the two curves is not as good as the eight-element
result. This suggests that the selection is successful and convincing.

3.3. Underlying physics of the selected SHARP parameters

We analyze the 8 selected SHARP parameters in this section. Figure 8 shows an example for the
evolution of the selected SHARP parameters in the whole AR and the PIL area for AR 11283. Two
adjacent panels, such as the panel “a” and panel “b”, represent the same parameter. The left panel
shows the SHARP in the whole AR, and the right one shows the SHARP in the PIL area. Here
we include the PIL-modiﬁed SHARP parameters to study how the SHARP parameters evolve in the
PIL area during ﬂares.

The ﬁrst two parameters are “TOTPOT” and “MEANPOT”, which have similar physical meanings
but are derived in diﬀerent ways. “TOTPOT” is the total value of the magnetic free energy, and
“MEANPOT” is the average value. Free energy is highly related to the nonlinear-force-free ﬁeld.
According to previous studies, a great amount of accumulated magnetic free energy is released within
a short time to provide the energy for ﬂares and CMEs (e.g., Antiochos et al. 1999; Amari et al. 2000;

10

Ran et al.

Figure 6. Scatter diagrams for the ranking of diﬀerent SHARP parameters calculated from NGBoost.
The left panel shows the ranking for the parameter “location” in the possibility distribution, and the right
one shows the ranking for the parameter “scale”. Inside the blue ellipse are the parameters of the greatest
importance.

Figure 7. Comparison between the original ﬂare envelope and the “ﬂare envelope” curve calculated from
NGBoost with the selected 8 SHARP parameters only.

Chen & Shibata 2000; Wang et al. 2014). Guo et al. (2008) analyzed the ﬂare in December 2006 by
extrapolating its 3D magnetic ﬁeld conﬁguration. They calculated the free energy and the shear
angle of the AR, studied the energy release process throughout the evolution of the magnetic ﬁeld,
and explained the energy release process during a ﬂare. Schrijver et al. (2008) also explained the free

AASTeX v6.3.1 Sample article

11

energy release process by extrapolating the nonlinear-force-free ﬁeld, and found that a free energy
drop of ∼ 1032 erg happened as the X ﬂare occurred. In our study, the two SHARP parameters about
the free energy are also considered as two of the most related parameters for ﬂare occurrence.

In Figure 8, panel “a” and panel “b” represent “TOTPOT”, and panel “c” and panel “d” represent
“MEANPOT”. We can see in the panels that, comparing to the two parameters in the whole AR,
“TOTPOT” and “MEANPOT” show a more obvious increase in the PIL area when big ﬂares happen.
The absolute value of “MEANPOT” is much higher than that in the whole AR. These features
are found in all the ARs we select, which suggests that the storing and releasing process of free
energy is more obvious in the PIL area. This conclusion is in agreement with previous studies (e.g.,
Cicogna et al. 2021; Wang et al. 2019).

The next parameter that we look into is “USFLUX”, which represents the total unsigned ﬂux.
“USFLUX” is shown in panels (e-f) in Figure 8. The correlation between the total unsigned ﬂux
and ﬂare productivity has been revealed by previous studies (e.g., Schrijver 2007; Vasantharaju et al.
2018; Bobra & Couvidat 2015; Kazachenko et al. 2017). Vasantharaju et al. (2018) made a statistical
study of some magnetic imprints and their correspondence with ﬂare productivity. Following the
results of previous studies (e.g., Schrijver 2007; Kazachenko et al. 2017), they took three kinds of
total unsigned magnetic ﬂux into consideration, the ﬂux of the whole AR, the ﬂux along the PIL,
and the ﬂux in the ﬂare ribbon area. Comparing to the total unsigned ﬂux in the whole AR, a slight
and a strong increase in correlation with ﬂares are found along with the PIL and in the ﬂare ribbon
area, respectively.

The two parameters of “MEANGAM” and “MEANGBH” are both related to the horizontal mag-
netic ﬁeld. In Figure 8, panel “g” and panel “h” represent “MEANGAM”, and panel “i” and panel “j”
represent “MEANGBH”. The main ﬁnding about the horizontal magnetic ﬁeld is that the horizontal
ﬁeld tends to increase signiﬁcantly in the PIL area after ﬂare eruptions, indicating that the vector
magnetic ﬁeld tends to be more horizontal after ﬂares (Petrie 2012a,b; Sun et al. 2012; Wang et al.
2014). This is consistent with our conclusion drawn from Figure 8. Compared to panel “g” and
panel “i”, the SHARP curves in panel “h” and panel “j” show more obvious increases in the PIL area
when big ﬂares happen. This feature of these two parameters is also found in all the ARs we select.
Previous studies suggest that a rapid and irreversible increase appears in the horizontal magnetic
ﬁeld after an eruption, and it becomes more aligned with the PIL as well. Song & Zhang (2016)
performed a detailed study by considering the continuum intensity. They compared the continuum
intensity and the horizontal magnetic ﬁeld in 5 ARs, and revealed that the diﬀerences of the contin-
uum intensity and the horizontal magnetic ﬁeld before and after the major ﬂares (above X1.0) are
strongly correlated both spatially and temporally in the outer penumbra of the sunspot. A similar
conclusion has been drawn by Lu et al. (2019) through a statistical analysis of 20 X-class ﬂares. All
these works indicate that the horizontal magnetic ﬁeld is of great importance for successive ﬂares in
the same AR.

The parameter ”MEANJZH”, shown in panels (k-l) in Figure 8, stands for the mean current helicity
with Bz contribution. Current helicity is crucial to magnetic energy build-up. An explanation for
the relationship between ﬂares and current helicity is the “α−eﬀect”, indicating that the energy
of small-scale ﬂuctuations of magnetic and velocity ﬁelds could be transferred into the energy of
large-scale currents (Seehafer 1990). The necessary condition for such eﬀect may be the presence of
the predominant sign of the electric helicity over the whole AR. Abramenko et al. (1996) conducted

12

Ran et al.

3.8e+23

CC = 0.513

1.00

a
AR

9.1e+22

CC = 0.442

0.75

0.50

t
o
p
t
o
t

0.25

0.00

1.00

2.6e+22

CC = 0.749

0.75

0.50

x
u
l
f
s
u

0.25

0.00

1.00

72.0

CC = 0.84

h
b
g
n
a
e
m

0.75

0.50

0.25

0.00

1.00

45.0

CC = 0.791

r
h
s
n
a
e
m

0.75

0.50

0.25

0.00

2

1

0

2

1

0

2

1

0

2

1

0

e
AR

i
AR

m
AR

t
o
p
t
o
t

2.1e+21

CC = -0.554

x
u
l
f
s
u

180.0

CC = 0.805

h
b
g
n
a
e
m

79.0

CC = 0.754

r
h
s
n
a
e
m

11000.0

CC = 0.853

t
o
p
n
a
e
m

55.0

CC = 0.796

m
a
g
n
a
e
m

0.019

CC = 0.727

h
z
j
n
a
e
m

0.043

CC = 0.726

l

p
a
n
a
e
m

b
PIL

f
PIL

j
PIL

n
PIL

2

1

0

2

1

0

2

1

0

2

1

0

c
AR

g
AR

k
AR

o
AR

2

1

0

2

1

0

2

1

0

2

1

0

57000.0

CC = 0.759

t
o
p
n
a
e
m

81.0

CC = 0.778

m
a
g
n
a
e
m

0.18

CC = 0.631

h
z
j
n
a
e
m

0.47

CC = 0.726

l

p
a
n
a
e
m

d
PIL

h
PIL

l
PIL

p
PIL

2

1

0

2

1

0

2

1

0

2

1

0

06 07 08 09 10 11

06 07 08 09 10 11

06 07 08 09 10 11

06 07 08 09 10 11

September 2011

September 2011

September 2011

September 2011

Figure 8. The 8 parameters in the whole AR and in the PIL area for AR 11283. Two adjacent panels,
such as panel “a” and “b”, belong to a group of the same SHARP. In the same group, the left panel is the
SHARP in the whole AR, and the right one is the SHARP in the PIL area. Counting from left to right and
up to down, the 8 groups are: “TOTPOT”, “MEANPOT”, “USFLUX”, “MEANGAM”, “MEANGBH”,
“MEANJZH”, “MEANSHR” and “MEANALP”. Each panel is labeled with a letter from “a” to “p”. The
SHARP parameters are normalized. The corresponding correlation coeﬃcient (CC) is at the top of each
panel. The maximum value of each SHARP parameter is also at the top. Similar format to Figure 2.

a statistical study involving 40 ARs and suggested that the condition of the “α−eﬀect” worked in
over 90% of all the cases. Yeates et al. (2008) performed a simulation to study the current helicity.
They discussed the sources of the current helicity and suggested that ﬁeld lines are skewed as they
cross the PIL. Similar to current helicity, magnetic helicity is also believed to be closely related to
the mechanisms that drive solar activities. “MEANALP”, shown in panels “o” to “p” in Figure
8, represents the mean characteristic twist parameter. The method used to calculate this SHARP
parameter was introduced by Hagino & Sakurai (2004) and adopted by Bobra et al. (2014) in the
SHARP package. Wang et al. (2022) studied the 4 homologous events (all are eruptive ﬂares) in AR

AASTeX v6.3.1 Sample article

13

11283. They analyzed the buildup process of the magnetic ﬂux ropes (MFRs), especially the evolution
of the magnetic helicity and the energy during the 4 eruptions. Their results show that the MFRs,
which are built up along the collisional polarity inversion lines (cPILs), store a large amount of energy
and magnetic helicity. The buildup process is involved with magnetic cancellation along the cPIL
via collisional shearing, which may contribute to solar eruptions (Chintzoglou et al. 2019). Li et al.
(2022) proposed several new parameters and investigated their ability in distinguishing eruptive and
conﬁned solar ﬂares. They found that the ratio between the “MEANALP” in the ﬂaring PILs and
the total unsigned ﬂux in the whole AR (αF P IL/ΦAR) is the most capable parameter to distinguish
ARs that can produce eruptive ﬂares. In our work, as shown in Figure 8, the values of the parameters
“MEANJZH” and “MEANALP” in the PIL area are about ten times the values in the whole AR,
indicating that both current and magnetic helicities accumulate in the PIL area. This is in agreement
with the mentioned studies.

The last parameter we select is “MEANSHR”, which stands for the mean shear angle. The shear
angle is deﬁned as the angle between the potential ﬁeld and the observed ﬁeld in the photosphere. It is
commonly accepted that a more strongly sheared magnetic ﬁled stores more free energy. Kusano et al.
(2012) conducted a simulation work to interpret the types of magnetic ﬁeld structures that can
drive solar eruptions. Their simulation results show that the shear angles of large-scale eruptions
accurately indicate the kinetic energy produced by eruptions. More sheared magnetic ﬁelds favor
the onset of large-scale eruptions. A lot of studies have been published to reveal the relationship
between shear angles and ﬂare production, suggesting that the shear angle is important in studying
ﬂare bursts (e.g., Moore et al. 1987; Zhang 2001; Leka & Barnes 2007; Guo et al. 2008; Wang et al.
2022; Li et al. 2022).

4. SUMMARY AND CONCLUSIONS

This paper has identiﬁed the SHARP parameters that are most related to successive ﬂare bursts
in the same AR. For this purpose, we adopt the envelope of the successive ﬂare bursts to represent
discrete individual events, and calculate the correlation coeﬃcients between the envelope and the
SHARP parameters. The NGBoost method (Duan et al. 2020) is also employed to obtain the im-
portance distribution of the SHARP parameters. With the importance distribution from NGBoost
and the correlation results, we have selected 8 parameters. A time diﬀerence of 2 hours between
the SHARP parameters and the ﬂare envelope is established in the NGBoost section, which is for
exploring if the SHARP parameters before ﬂares could reﬂect ﬂare productivity. In fact, we have
conducted the NGBoost analysis 10 times with time diﬀerences varying from 12 minutes to 2 hours,
and the selections of SHARP parameters are almost the same. By comparing our results with pre-
vious works, we analyze the physical meanings of the 8 parameters and their relationships with ﬂare
productivity. The major conclusions are summarized below.

1. The most relevant SHARP parameters to the successive ﬂare productivity in the same AR
are “TOTPOT”, “MEANPOT”, “USFLUX”, “MEANGAM”, “MEANGBH”, “MEANJZH”,
“MEANSHR”, and “MENAALP”. These parameters are related to the free energy, unsigned
magnetic ﬂux, horizontal magnetic ﬁelds, current and magnetic helicity, and shear angles, all
of which are conﬁrmed to have strong connections with ﬂares.

2. The PIL is important in studying successive ﬂares in the same AR. We do see more signiﬁcant
changes in the selected parameters in the PIL area, in particular during big ﬂares. A signiﬁcant

14

Ran et al.

store and release process of the free energy before and after ﬂares can be found in both the
PIL area and the whole AR, but it is more concentrated in the PIL area. The horizontal
ﬁeld becomes more dominant after ﬂare eruptions in the PIL area, and the magnetic ﬁeld is
also more twisted in the PIL area. However, during the evolution of an AR, the coverage and
number of PILs may vary signiﬁcantly. This would increase the diﬃculty of investigating the
mechanisms that drive successive solar eruptions.

3. The establishment of a practical ﬂare forecast system requires full understanding of the physical
mechanism of ﬂare bursts. A time diﬀerence between the parameters and the ﬂare indexes may
help us to explore the trigger of ﬂares. We have made an example with time diﬀerence of two
hours, which seems promising, but more work is needed in the future.

A lot of work has been put into identifying the parameters that carry the most information for ﬂare
bursts in order to lay foundation for a practical prediction scheme. Leka & Barnes (2007) conducted
a study on distinguishing the photospheric magnetic ﬁeld properties that are important for ﬂare
production. Their work shows that the properties related to free energy, total unsigned ﬂux, vertical
currents and shear angles are strongly related to ﬂare production. Bobra & Couvidat (2015) found
that the magnetic energy, vertical current and current helicity are the most useful physical quantities
in ﬂare prediction, in agreement with Leka & Barnes (2003a) and our result here. Ahmed et al.
(2013) employed a Solar Monitor Active Region Tracker (SMART) to estimate the eﬃciency of such
parameters in ﬂare prediction, and selected 6 physical quantities, which are believed to carry the
most information for ﬂare bursting, out of 21 parameters. Unlike the previous studies, we focus
on successive ﬂare bursts in the same AR, and identify the most ﬂare-related SHARP parameters
with a time diﬀerence of 2 hours. It still remains a problem to give a practical ﬂare forecasts in the
continuously evolving ARs with a high accuracy. Interactions between adjacent ﬂares have highly
increased the diﬃculty of establishing a precise prediction method. More work about the physical
mechanisms of the ﬂares is needed to establish a truly reliable ﬂare forecast system.

ACKNOWLEDGEMENTS

This research was supported by the National Key R&D Program of China No.2021YFA0718600,
NSFC (41774179, 12073032, 42004145, 42150105), the Strategic Priority Research Program of Chinese
Academy of Sciences (XDA15018500), and the Specialized Research Fund for State Key Laboratories.
Y.G. was supported by NSFC (11773016, 11961131002, and 11533005) and 2020YFC2201201. H.R.
acknowledges helpful discussions with Dr. Huidong Hu. We acknowledge the work of the Sunpy team
(The SunPy Community et al. 2020). We are grateful to the work of Glogowski et al. (2019), whose
Python package drms has oﬀered us a convenient tool to access the SDO data. The data used here
are courtesy of NASA/SDO and the HMI science team, as well as the Geostationary Satellite System
(GOES ) team.

APPENDIX

THE NGBOOST METHOD

NGBoost is a gradient boosting algorithm that aims at estimating the parameters of a probability
distribution Pθ(y|x), where x is the feature vector of observation, and y is the target variable. In

AASTeX v6.3.1 Sample article

15

location

scale

r
e
t
e
m
a
r
a
p

P
R
A
H
S

usflux
meanpot
totpot
totusjh
absnjzh
meangam
meangbh
meanalp
savncpp
totusjz
r_value
meanshr
meangbz
meanjzh
meanjzd
meangbt

0.00

0.02

0.04

0.06
importance feature

0.08

usflux
absnjzh
meanpot
totusjh
totpot
totusjz
savncpp
meangam
meanjzh
meanalp
meangbh
r_value
meanshr
meanjzd
meangbz
meangbt

0.10

0.00

0.05

0.10

0.15

0.20

0.25

importance feature

Figure 9. The importance feature of the SHARP parameters in AR 12673. The left panel refers to
the importance feature distribution of “location”, and the right panel refers to the importance feature
distribution of “scale”.

our work, x is the vector of SHARP parameters and y is the corresponding ﬂare envelope value.
E[y|x] from the
NGBoost can also be applied to point estimation by extracting point expectations
b
Pθ(y|x) (Duan et al. 2020). There are three main modules in NGBoost: (i)
estimated distribution
b
the base learner f , (ii) the probability distribution Pθ, and (iii) a proper scoring rule. Figure 2
in Duan et al. (2020) shows the schematic illustration of NGBoost. The base learners are crucial in
gradient boosting algorithms. In general, gradient boosting algorithms rely on the sequential training
of the base learners to form an additive ensemble. The ensemble of the previous learners estimates a
current residual, which will then be applied to optimize the new learner. The output of that learner
is scaled by a learning rate, and it is then appended to the current ensemble. In our work, we employ
the decision tree that is suggested in Duan et al. (2020) as the base learner.

Regarding the probability distribution, we choose the normal probability distribution. It is deﬁned
by θ, which is a vector composed of “location” and “scale”. The next step is to determine a proper
scoring rule. A proper scoring rule generates a rating between the estimated distribution and the
observation, then returns the rating to the base learner such that the distribution of the outcomes
gets the best score in expectation. The most commonly used scoring rule, which is also applied in
this context, is the logarithmic score:

L(θ, y) = −log(Pθ(y)).

(1)

Another important part of NGBoost is the natural gradient ˜▽θ. The natural gradient is motivated
by information geometry. It makes the optimization problem invariant to the parameterization, and
it also makes the learning more stable and eﬀective (Amari 1998).
To be speciﬁc, assuming that we have a dataset D = {xi, yi}M

i=1, where M is the number of the
training examples. The algorithm ﬁrst establishes an initial predicted parameter θ(0), which is deﬁned
as:

M

θ(0) = argminθ

L(θ, yi).

X
i=1

(2)

 
16

Ran et al.

The initial predicted parameter is a standard set of parameters that aims at minimizing the sum of
the scoring rule L. Next, for each iteration n, we estimate the individual natural gradient for each
example i as:

i = IL(θ(n−1)
g(n)

i

)−1 · ▽θL(θ(n−1)

i

, yi),

(3)

where the IL(θ) is the Fisher Information carried by an observation about Pθ. For logarithmic score,
the Fisher Information is deﬁned as:

IL(θ) = Ey∼Pθ[▽θL(θ, y) ▽θ L(θ, y)T ].

(4)

After being established, the natural gradient and the input vectors xxxi are used to train the base
learners of iteration f (n). The training process returns a ﬁtted base learner that is the projection of
the natural gradient. A scale factor ρ(n) is needed to scale the projected gradient. It is computed as:

ρ(n) = argminρ

M

X
i=1

L(θ(n−1)
i

− ρ · f (n)(xi), yi),

where ρ starts from ρ = 1. Then the parameters θ(n)

i

are updated by:

θ(n)
i = θ(n−1)

i

− η(ρ(n)f (n)(xi)),

(5)

(6)

where η denotes a usual learning rate (typically 0.1 or 0.01).

The use of NGBoost in this context is explained in Section 2.4. We focus on the importance feature
of each SHARP parameter. The SHARP parameter that has higher importance feature value in the
NGBoost analysis is believed to be more responsible for successive ﬂare occurrence. An example of
the importance feature distribution is shown in Figure 9. The NGBoost method can be conveniently
used and interpreted 4 with the python package ngboost 5.

4 https://stanfordmlgroup.github.io/ngboost/intro.html
5 https://github.com/stanfordmlgroup/ngboost

AASTeX v6.3.1 Sample article

17

REFERENCES

Abramenko, V. I., Wang, T., & Yurchishin, V. B.

1996, SoPh, 168, 75

Ahmed, O. W., Qahwaji, R., Colak, T., et al.

2013, SoPh, 283, 157

Amari, S.-I. 1998, Neural computation, 10, 251
Amari, T., Luciani, J. F., Mikic, Z., & Linker, J.

2000, ApJ, 529, L49

Leka, K. D., & Barnes, G. 2003a, ApJ, 595, 1277
—. 2007, ApJ, 656, 1173
Li, T., Sun, X., Hou, Y., et al. 2022, ApJL, 926,

L14

Liu, C., Deng, N., Wang, J. T. L., & Wang, H.

2017a, ApJ, 843, 104

Liu, Y. D., Luhmann, J. G., Lugaz, N., et al.

Antiochos, S. K., DeVore, C. R., & Klimchuk,

2013, ApJ, 769, 45

J. A. 1999, ApJ, 510, 485

Bobra, M. G., & Couvidat, S. 2015, ApJ, 798,

135, doi: 10.1088/0004-637x/798/2/135

Bobra, M. G., Sun, X., Hoeksema, J. T., et al.

2014, SoPh, 289, 3549,
doi: 10.1007/s11207-014-0529-3

Chen, P. F., & Shibata, K. 2000, ApJ, 545, 524
Chintzoglou, G., Zhang, J., Cheung, M. C. M., &

Kazachenko, M. 2019, ApJ, 871, 67

Cicogna, D., Berrilli, F., Calchetti, D., et al. 2021,

arXiv preprint arXiv:2105.00897

Duan, T., Avati, A., Ding, D. Y., et al. 2020,

PMLR, 2690

Ester, M., Kriegel, H.-P., Sander, J., & Xu, X.

1996, Int. Conf. Knowledge Discovery and Data
Mining, 240, 6

Falconer, D. A., Moore, R. L., & Gary, G. A.

2002, ApJ, 569, 1016

Feng, L., Wiegelmann, T., Su, Y., et al. 2013,

ApJ, 765, 37

Georgoulis, M. K., Titov, V. S., & Miki´c, Z. 2012,

ApJ, 761, 61

Glogowski, K., Bobra, M. G., Choudhary, N.,
Amezcua, A. B., & Mumford, S. J. 2019,
Journal of Open Source Software, 4, 1614,
doi: 10.21105/joss.01614

Guo, Y., Ding, M. D., Wiegelmann, T., & Li, H.

2008, ApJ, 679, 1629

Hagino, M., & Sakurai, T. 2004, PASJ, 56, 831
Hoeksema, J. T., Liu, Y., Hayashi, K., et al. 2014,

SoPh, 289, 3483

Liu, Y. D., Richardson, J. D., Wang, C., &
Luhmann, J. G. 2014a, ApJL, 788, L28
Liu, Y. D., Zhao, X., Hu, H., Vourlidas, A., &

Zhu, B. 2019, ApJS, 241, 15

Liu, Y. D., Luhmann, J. G., Kajdiˇc, P., et al.

2014b, NatCo, 5, 3481

Lu, Z., Cao, W., Jin, G., et al. 2019, ApJ, 876, 133
Mason, J. P., & Hoeksema, J. T. 2010, ApJ, 723,

634

Moore, R. L., Falconer, D. A., & Sterling, A. C.

2012, ApJ, 750, 24

Moore, R. L., Hagyard, M. J., & Davis, J. M.

1987, SoPh, 113, 347

Petrie, G. J. D. 2012a, ApJ, 759, 50
—. 2012b, in Solar Dynamics and Magnetism from

the Interior to the Atmosphere (Springer),
415–440

Ribeiro, F., & Gradvohl, A. 2021, Astronomy and

Computing, 35, 100468

Schou, J., Scherrer, P. H., Bush, R. I., et al. 2012,

SoPh, 275, 229

Schrijver, C., DeRosa, M., Metcalf, T., et al. 2008,

ApJ, 675, 1637

Schrijver, C. J. 2007, ApJ, 655, L117,

doi: 10.1086/511857

Seehafer, N. 1990, SoPh, 125, 219
Song, Y. L., & Zhang, M. 2016, ApJL, 826, 173
Sun, X., Hoeksema, J. T., Liu, Y., et al. 2012,

ApJ, 748, 77

Tarr, L., Longcope, D., & Millhouse, M. 2013,

Kazachenko, M. D., Lynch, B. J., Welsch, B. T.,

ApJ, 770, 4

& Sun, X. 2017, ApJ, 845, 49

Kontogiannis, I., Georgoulis, M. K., Park, S.-H.,

& Guerra, J. A. 2017, SoPh, 292, 159,
doi: 10.1007/s11207-017-1185-1

Kusano, K., Bamba, Y., Yamamoto, T. T., et al.

2012, ApJ, 760, 31

The SunPy Community, Barnes, W. T., Bobra,

M. G., et al. 2020, ApJ, 890, 68,
doi: 10.3847/1538-4357/ab4f7a

T¨or¨ok, T., Leake, J. E., Titov, V. S., et al. 2014,

ApJL, 782, L10,
doi: 10.1088/2041-8205/782/1/l10

Lee, E.-J., Park, S.-H., & Moon, Y.-J. 2018, SoPh,

Vasantharaju, N., Vemareddy, P., Ravindra, B., &

293, 159, doi: 10.1007/s11207-018-1381-7

Doddamani, V. H. 2018, ApJ, 860, 58

18

Ran et al.

Vemareddy, P., & Wiegelmann, T. 2014, ApJ, 792,

Wang, R., Yan, Y., & Tan, B. 2013, SoPh, 288,

40

507

Wang, J., Liu, S., Ao, X., et al. 2019, ApJ, 884,

Welsch, B. T., Christe, S., & McTiernan, J. M.

175, doi: 10.3847/1538-4357/ab441b

2011, SoPh, 274, 131

Wang, J., Zhang, Y., Webber, S. A. H., et al. 2020,
ApJ, 892, 140, doi: 10.3847/1538-4357/ab7b6c
Wang, R., Liu, Y. D., Hoeksema, J. T., Zimovets,

I. V., & Liu, Y. 2018, ApJ, 869, 90

Yang, X., Lin, G., Zhang, H., & Mao, X. 2013,

ApJL, 774, L27

Yeates, A. R., Mackay, D. H., & van Ballegooijen,

A. A. 2008, ApJ, 680, L165

Wang, R., Liu, Y. D., Yang, S., & Hu, H. 2022,

Yi, K., Moon, Y.-J., Lim, D., Park, E., & Lee, H.

ApJ, 925, 202

2021, ApJ, 910, 8

Wang, R., Liu, Y. D., Yang, Z., & Hu, H. 2014,

Zhang, H. 2001, ApJ, 557, L71

ApJ, 791, 84

