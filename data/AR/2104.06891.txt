1
2
0
2

r
p
A
4
1

]
h
p
-
m
e
h
c
.
s
c
i
s
y
h
p
[

1
v
1
9
8
6
0
.
4
0
1
2
:
v
i
X
r
a

Symmetry-adapted perturbation theory based
on multiconﬁgurational wave function
description of monomers

Michał Hapka,∗,†,‡ Michał Przybytek,‡ and Katarzyna Pernal†

†Institute of Physics, Lodz University of Technology, ul. Wolczanska 219, 90-924 Lodz,
Poland
‡Faculty of Chemistry, University of Warsaw, ul. L. Pasteura 1, 02-093 Warsaw, Poland

E-mail: michal.hapka@uw.edu.pl

Abstract

We present a formulation of the multiconﬁgurational (MC) wave function symmetry-
adapted perturbation theory (SAPT). The method is applicable to noncovalent interactions
between monomers which require a multiconﬁgurational description, in particular when the
interacting system is strongly correlated or in an electronically excited state. SAPT(MC) is
based on one- and two-particle reduced density matrices of the monomers and assumes the
single-exchange approximation for the exchange energy contributions. Second-order terms are
expressed through response properties from extended random phase approximation (ERPA)
equations. SAPT(MC) is applied either with generalized valence bond perfect pairing (GVB)
or with complete active space self consistent ﬁeld (CASSCF) treatment of the monomers. We
discuss two model multireference systems: the H2 · · · H2 dimer in out-of-equilibrium geome-
tries and interaction between the argon atom and excited state of ethylene.
In both cases
SAPT(MC) closely reproduces benchmark results. Using the C2H *4 · · · Ar complex as an ex-
ample, we examine second-order terms arising from negative transitions in the linear response
function of an excited monomer. We demonstrate that the negative-transition terms must be
accounted for to ensure qualitative prediction of induction and dispersion energies and de-
velop a procedure allowing for their computation. Factors limiting the accuracy of SAPT(MC)
are discussed in comparison with other second-order SAPT schemes on a data set of small
single-reference dimers.

1 Introduction

Quantum chemistry oﬀers two complementary
approaches to study noncovalent interactions—
the supermolecular approach and energy de-
composition methods. The former is concep-
tually simple and capable of providing most
accurate potential energy surfaces, e.g.,
for
interpretation of experiments carried out in
the cold- and ultracold regimes. 1–3 Decompo-
sition methods allow insight into the nature
of the interaction by partitioning the inter-
action energy into well-deﬁned contributions.

Both approaches have been extensively devel-
oped and benchmarked for systems which can
be adequately described with single determi-
nants. 4,5 With the supermolecular method it
is now possible to reach even submicro- or mi-
crohartree accuracy for small systems. 6–10 At
the same time performing realistic energy de-
composition for enzymes exceeding 3,000 atoms
is also within reach. 11 Energy decomposition
schemes are not only interpretative tools, but
can also provide potentials for quantitative pre-
dictions. The symmetry adapted perturbation

1

 
 
 
 
 
 
theory (SAPT) 12,13 has been applied to gener-
ate potential energy surfaces for scattering cross
sections calculations, predictions of spectra and
bulk matter properties, as well as the develop-
ment of force ﬁelds for biomolecules (see, e.g.,
Refs. 14–18).

In contrast to the rich toolbox dedicated to
single-determinantal wave functions, describing
intermolecular interactions in complexes which
demand multiconﬁgurational (MC) wave func-
tions remains a challenge. The multiconﬁgura-
tional treatment is often mandatory for transi-
tion metal complexes, open-shell systems, elec-
tronically excited states or systems dominated
by static correlation eﬀects. From the stand-
point of weak intermolecular forces, proper rep-
resentation of static correlation warranted by
expansion in multiple electron conﬁgurations
is not suﬃcient. The main diﬃculty lies in
the recovery of the remaining dynamic corre-
lation both within and between the interacting
molecules. The latter eﬀect, giving rise to the
attractive dispersion interaction, poses a par-
ticular challenge due to its highly nonlocal and
long-ranged nature. Although many multirefer-
ence methods restoring dynamic correlation ef-
fects have been developed, neither has yet man-
aged to combine the accuracy and eﬃciency
required for noncovalent interactions. For in-
stance, the popular multireference conﬁgura-
tion interaction (MRCI) approach 19 and mul-
tireference perturbation theories 20,21 are lim-
ited by the lack of triple excitations and trun-
cation of the perturbation series at the second
order, respectively, and their application to in-
teractions is not trivial. First, MRCI is not size-
consistent and requires approximate corrections
added a posteriori. 22,23 In perturbation theories
the fulﬁlment of the strict separability condi-
tion depends on the choice of the zeroth-order
Hamiltonian. 24,25 Second, perturbation theo-
ries, including complete active space (CAS) per-
turbation theory (CASPT2) 20 and multirefer-
ence variants of the Møller-Plesset perturbation
theory, 26 suﬀer from intruder states 27 which
have to be removed using one of the available
shift techniques. 28 Intruder states are also a
signiﬁcant problem in the development of mul-
tireference coupled-cluster theories, 29,30 next to

numerical instabilities and algebraic complex-
ity. Single-reference coupled-cluster (CC) ap-
proaches introduced by Piecuch and co-workers,
e.g. the CC(P ; Q) formalism, 31,32 may be a
viable alternative, as indicated by studies of
interactions involving stretched intramonomer
covalent bonds. 33,34 Encouraging results have
recently been obtained for strongly correlated
interacting systems from multiconﬁgurational
random phase approximation theory combined
with generalized valence bond method. 34–36
The multiconﬁguration density functional the-
ory (MC DFT) 37,38 methods corrected to in-
clude long-range dynamic correlation via per-
turbation theory, 39 the adiabatic connection
formalism 40 or semi-empirical dispersion mod-
els 41 are also worth mentioning, but their accu-
racy for noncovalent interations remains to be
rigorously investigated.

A separate challenge, parallel to advanc-
is the develop-
ing supermolecular methods,
ment of energy decomposition schemes ap-
plicable to multireference systems. 42 On that
front, the SAPT formalism oﬀers several im-
portant advantages which make it one of
the most widely used and actively developed
decomposition approaches. 18 The interaction
energy components in SAPT have a clear
physical
interpretation and the most accu-
rate variants of the method predict interaction
energies closely matching the coupled-cluster
singles-and-doubles with perturbative triples
[CCSD(T) 43,44] results. Compared to the su-
permolecular approach, SAPT avoids the ba-
sis set superposition error, since the interac-
tion energy is computed directly based only on
monomer properties. Moreover, the interaction
energy represented as a sum of energy contri-
butions is per se size-consistent.

In more than forty years spanning the de-
velopment of SAPT, applications going beyond
the single-reference treatment of the monomers
are scarce. Exact full conﬁguration interac-
tion (FCI) wave functions are feasible only for
model, few-electron dimers and have been em-
ployed in studies of SAPT convergence. 14,45–48
Reinhardt 49 used valence bond (VB) wave
functions to represent the electrostatic inter-
action between monomers of a multireference

2

character and proposed an approximate, VB-
based approach for dispersion energy calcu-
lations. The spin-ﬂip SAPT (SF-SAPT) 50,51
formalism introduced by Patkowski and co-
workers opened the possibility to treat mul-
tireference, low-spin states based on single ref-
erence description of the subsystems. First-
order spin-ﬂip exchange energy expressions
for high-spin restricted open-shell Hartree-Fock
(ROHF) wave function have already been de-
rived and implemented, 50,51 while extension to
the second-order is under way. 18

The purpose of the present paper is to present
a complete SAPT formalism applicable to inter-
actions involving multireference systems. First
steps in this directions have been already taken.
Recently, we have devised multiconﬁgurational
approaches for second-order dispersion 52 and
exchange-dispersion 53 energy calculations.
In
this work we complement these eﬀorts and pro-
pose a variant of SAPT based on MC wave
functions, which we refer to as SAPT(MC).
The method includes energy contributions up
to the second-order in the intermolecular inter-
action operator and can be applied with any
wave function model which gives access to one-
and two-electron reduced density matrices of
the monomers. Following the developments of
Ref. 52 and 53, the linear response properties
required for second-order terms are accessed by
solving extended random phase approximation
(ERPA) 54,55 equations. Both ﬁrst- and second-
order exchange terms are derived assuming the
single-exchange approximation, 56 also known as
the S2 approximation. We discuss the perfor-
mance of SAPT(MC) combined either with gen-
eralized valence bond perfect pairing (GVB)
or complete active space self consistent ﬁeld
(CASSCF) description of the monomers.

This work is organized in ﬁve sections. In Sec-
tion 2 we present formulas for ﬁrst- and second-
order energy contributions in the ERPA-based
variant of multiconﬁgurational SAPT. Special
attention is given to calculations of induction
and dispersion energies for complexes involving
electronically excited molecules. Section 3 con-
tains details of our implementation and com-
putations. Results for the model multirefer-
ence and single-reference dimers are presented

in Section 4.
ﬁndings.

In Section 5 we summarize our

2 Theory

Consider a weakly interacting dimer AB which
dissociates into monomer A in state I described
with the |ΨA
I (cid:105) wave function and monomer B in
state J described with the |ΨB
J (cid:105) wave function
(I and J refer either to ground or excited states
of the monomers). When the unperturbed
Hamiltonian is chosen as the sum of Hamiltoni-
ans of the isolated monomers, ˆH0 = ˆHA + ˆHB,
the zeroth-order wave function takes a product
form |Ψ(0)(cid:105) = |ΨA
J (cid:105). In this work we assume
that |Ψ(0)(cid:105) is nondegenerate.

I ΨB

The intermolecular interaction operator, ˆV ,
represents the perturbation and gathers all
Coulombic interactions between electrons and
nuclei of the interacting partners

(cid:88)

(cid:88)

ˆV =

i∈A
(cid:88)

j∈B
(cid:88)

α∈A
(cid:88)

β∈B
(cid:88)

i∈A

j∈B

+

=

(cid:88)

(cid:88)

i∈A

β∈B

Zβ
rβi

−

(cid:88)

(cid:88)

j∈B

α∈A

Zα
rαj

1
rij

−

ZαZβ
rαβ

1
rij

(cid:88)

+

i∈A

vB(ri) +

(cid:88)

j∈B

vA(rj) + V AB

(1)

where i and j run over NA and NB electrons in
monomers A and B, respectively, vA and vB are
one electron potentials, and V AB is the nuclear-
nuclear repulsion term.

In the symmetrized Rayleigh-Schrödinger
(SRS) formulation 57 of SAPT the interaction
energy is expanded with respect to ˆV while
enforcing the antisymmetry of |ΨA
I (cid:105) and |ΨB
J (cid:105)
wave function products. The general expres-
sion for energy contribution in the n-th order
in ˆV takes the form

E(n)

SRS =

−

J | ˆV ˆAΨ(n−1)
(cid:104)ΨA
I ΨB
(cid:105)
RS
J | ˆAΨA
I ΨB
I ΨB
(cid:104)ΨA
J (cid:105)
(cid:80)n−1
J | ˆV ˆAΨ(n−k)
k=1 E(k)
I ΨB
SRS (cid:104)ΨA
J | ˆAΨA
I ΨB
I ΨB
(cid:104)ΨA
J (cid:105)

RS

(cid:105)

(2)

where ˆA is the antisymmetrizer exchanging

3

electrons between the monomers; |Ψ(n)
RS (cid:105) denotes
n-th order component of the wave function ex-
pansion, which is identical in both SRS and
in the conventional Rayleigh-Schrödinger (RS)
perturbation theory, i.e., the expansion is based
only on simple products of zero-order functions.
The diﬀerence between the SRS and RS energy
is deﬁned as the exchange energy. The RS en-
ergy contributions are often referred to as po-
larization components. For convenience, we use
the SAPT acronym when referring to SRS.

The SAPT(MC) formalism presented in this
work includes interaction energy components
through the second-order in ˆV

ESAPT

int = E(1)
+ E(2)

elst + E(1)
disp + E(2)

exch−disp

exch + E(2)

ind + E(2)

exch−ind

(3)

ind and E(2)

elst and E(1)

where E(1)
exch are ﬁrst-order electro-
static and exchange energy contributions, re-
spectively, E(2)
exch−ind are the second-
order induction and exchange-induction ener-
gies, respectively, and E(2)
exch−disp de-
note the dispersion energy and its exchange
counterpart, respectively.

disp and E(2)

All formulas are in the natural-orbitals (NOs)
representation. We use the following index con-
vention: greek µ and ν indices denote electronic
states of monomers, pσqσrσsσ denote natural
spinorbitals, while pqrs pertain to natural or-
bitals denoted by ϕ(r). Throughout the work
the NOs are assumed to be real-valued. In the
representation of natural spinorbitals the one-
electron reduced density matrix (1-RDM) is di-
agonal

(cid:68)

(cid:69)

(4)

Ψ|ˆa†

γpq =

ˆapβ |Ψ

= npδpq

qαˆapα + ˆa†
qβ

1
2
where (cid:8)ˆa†
(cid:9) and {ˆapσ } are creation and annihi-
pσ
lation operators, respectively, and np are natu-
ral occupation numbers from the (cid:104)0, 1(cid:105) range,
summing up to half a number of electrons,
(cid:80)

p np = N/2.
All presented SAPT(MC) energy contribu-
tions are given in a spin-summed form. The
expressions for the polarization energy compo-
nents are valid for arbitrary spin states of the
monomers. The exchange energy contributions

are presented assuming singlet spin states of the
monomers which implies that αα and ββ blocks
of 1-RDM are equal.

2.1 First-order energy contribu-

tions

The polarization component of the ﬁrst-order
SAPT energy is the electrostatic energy, E(1)
elst =
(cid:104)ΨA
J (cid:105). This energy contribution
expressed in terms of 1-RDMs takes the form

J | ˆV |ΨA

I ΨB

I ΨB

E(1)

elst = 2

+ 4

(cid:88)

p∈A
(cid:88)

p∈A
q∈B

npvB

pp + 2

(cid:88)

nqvA
qq

q∈B
pq + V AB

npnqvpq

(5)

pq

where vA(B)
ments of one-electron potentials and vrs
regular two-electron Coulomb integrals vrs
(cid:104)ϕp(r1)ϕq(r2)|r−1

= (cid:104)ϕp|vA(B)|ϕq(cid:105) are matix ele-
pq denote
pq =

12 |ϕr(r1)ϕs(r2)(cid:105).
Evaluation of the exact expression for the

ﬁrst-order exchange energy

E(1)

exch =

(cid:104)ΨA
(cid:104)ΨA

I ΨB
I ΨB

J | ˆV ˆAΨA
J | ˆAΨA

I ΨB
J (cid:105)
I ΨB
J (cid:105)

− E(1)
elst

(6)

requires access to many-particle density ma-
trices of the monomers.
For the Hartree-
Fock wave function many-particle density ma-
trices are readily available as antisymmetrized
products of the one-particle density matrix. 58
At the SAPT(DFT) level of theory one uses
approximate 1-RDMs of the monomers based
on the Kohn-Sham determinants and employs
the same exchange expression as in the wave-
function SAPT. 59,60

It is possible to signiﬁcantly simplify the
structure of Eq. (6) by allowing only for single-
exchange of electrons between the monomers in
the antisymmetrizer 56,61

E(1)

exch(S2) = (cid:104)ΨA

I ΨB
J |

(cid:16) ˆV − E(1)

elst

(cid:17) ˆP|ΨA

I ΨB
J (cid:105)

(7)
where the single-exchange operator ˆP collects
all permutations, ˆPij, interchanging the coordi-

4

nates of electrons i and j

ˆP = −

(cid:88)

(cid:88)

ˆPij

i∈A

j∈B

(8)

Neglecting multiple exchange of electrons is
known as the S2 approximation and allows one
to express the ﬁrst-order exchange energy using
only 1-RMDs and two-electron reduced density
matrices (2-RDMs) of the monomers. 62 Follow-
ing the density-matrix-based formulation of Ref.
62 we obtain

E(1)

exch(S2) = 2

(cid:16)

E(1)

elst − VAB

(cid:17) (cid:88)

npnq

(cid:1)2

(cid:0)Sq

p

the interacting monomers. The induction and
dispersion energies involve transition energies
and one-electron reduced transition densities
(1-TRDMs). The SRS components, exchange-
induction and exchange-dispersion energies, re-
quire both 1-TRDMs and two-electron reduced
transition densities (2-TRDMs).

In this work we approximate the transition
properties of the interacting monomers by solv-
ing the Extended Random Phase Approxima-
tion 52,54,63 equations (independently for each
monomer)

(cid:88)

−2

npnq

(cid:0)vA

p∈A
q∈B
p + vB
pqSq

(cid:18) A B
B A

(cid:19) (cid:18) Xν
Yν

(cid:19)

= ων

(cid:18) −N 0
0 N

(cid:19)

(cid:19) (cid:18) Xν
Yν
(11)

,

qpSq

p + vqp
pq

(cid:1)

with a diagonal metric matrix

−4

−4

−8

p∈A
q∈B
(cid:88)

pqr∈A
t∈B
(cid:88)

pqr∈B
t∈A
(cid:88)

pqr∈A
sut∈B

nt N A

pqrt (vB

pr St

q + vrt
pq)

nt N B

pqrt (vA

pr St

q + vrt
pq)

N A

pqru N B

tusq vrs
pt

(9)

where Sq
p = (cid:104)ϕp|ϕq(cid:105) denotes the overlap in-
tegral, and we have introduced intermedi-
ates containing contractions of the 2-RDM,
rσ(cid:48)(cid:48) ˆa†
Γpσqσ(cid:48) rσ(cid:48)(cid:48) sσ(cid:48)(cid:48)(cid:48) = (cid:104)Ψ|ˆa†
sσ(cid:48)(cid:48)(cid:48) ˆaqσ(cid:48) ˆapσ |Ψ(cid:105), with the
overlap integrals

N A

tuvw =

(cid:88)

a∈A

¯ΓA
tuvaSw
a ,

N B

tuvw =

¯ΓB
tuvbSb
w

(cid:88)

b∈B

is

(10)
where ¯Γpqrs
spin-summed 2-RDM,
¯Γpqrs = Γpαqαrαsα + Γpβ qαrβ sα. Since we assume
monomers in singlet states, the ββββ+αβαβ
block is equal to its αααα+βαβα counterpart.

the

2.2 Second-order energy contri-

butions

2.2.1 Transition properties from Ex-
tended Random Phase approxi-
mation

Second-order SAPT energy components may
be expressed through transition properties of

5

∀p>q
r>s

Npq,rs = (np − nq)δprδqs

(12)

The ERPA equations may be formed as a sym-
metric real eigenproblem using electronic Hes-
sian matrices, A + B and A − B. For ground
state calculations the Hessian matrices are pos-
itive deﬁnite (see, e.g., Refs. 64 and 65 for ex-
plicit ERPA equations in the GVB and CAS
frameworks, respectively).
In the case of ex-
cited state wave functions the Hessian matrices
may have negative eigenvalues corresponding to
de-excitation modes in the ERPA propagator 66
(see a more detailed discussion in section 2.2.3).
Apart from transition energies ων which cor-
respond to the poles of the ERPA eigenproblem,
two quantities that are required in second-order
SAPT are 1- and 2-TRDM of the monomers.
The 1-TRDM is deﬁned as
pσqσ = (cid:10)Ψ|ˆa†
γν

qσ ˆapσ |Ψν

(13)

(cid:11)

Note that for singlet states αα and ββ blocks
are equal: γν
pq. The general
deﬁnition of 2-TRDM reads

pαqα = γν

= γν

pβ qβ

pσqσ(cid:48) rσ(cid:48)(cid:48) sσ(cid:48)(cid:48)(cid:48) = (cid:104)Ψ|ˆa†
Γν

rσ(cid:48)(cid:48) ˆa†

sσ(cid:48)(cid:48)(cid:48) ˆaqσ(cid:48) ˆapσ |Ψν(cid:105)

(14)

The 1-TRDM are expressed through the ERPA

eigenvectors as 65,67

ing partner, the latter deﬁned as

∀p>q
∀q>p

γν
qp = (np − nq) [Yν]pq
γν
qp = (np − nq) [Xν]qp

(15)

(16)

and the formula for the half of spin-summed
2-TRDM reads 53

¯Γν
pqrs = Γν
pαqαrαsα + Γν
(cid:88)
[Xν]pt
=

¯Γtqrs +

pβ qαrβ sα
(cid:88)

[Xν]qt

¯Γptrs

−

+

−

t<p
(cid:88)

[Xν]tr

¯Γpqts −

t<q
(cid:88)

[Xν]ts

¯Γpqrt

t>r
(cid:88)

[Yν]tp

¯Γtqrs +

t>s
(cid:88)

[Yν]tq

¯Γptrs

t>p
(cid:88)

t<r

[Yν]rt

¯Γpqts −

t>q
(cid:88)

t<s

[Yν]st

¯Γpqrt

(17)

2.2.2

Induction and dispersion energies

The polarization components of SAPT in the
second order are the induction and dispersion
energies. The induction energy is given as

ˆΩB(r) = vB(r) +

(cid:90) ρB(r(cid:48))
|r − r(cid:48)|

dr(cid:48)

(20)

where ρB is the one-electron density of the
monomer B (analogous expression holds for
ˆΩA). The total induction energy formula is now
conveniently expressed as

E(2)

ind = −

(cid:88)

µ(cid:54)=I

(cid:16) (cid:80)

(cid:17)2

pq ΩB
pq

pq∈A γA,µ
ωA
µ

(cid:17)2

(cid:16) (cid:80)

rs ΩA
rs

rs∈B γB,ν
ωB
ν

−

(cid:88)

ν(cid:54)=J

where Ωpq = (cid:104)ϕp| ˆΩ|ϕq(cid:105).

In

the ERPA-approximation

summed formula for E(2)

the
ind takes the form

(21)

spin-

E(2)

ind = −4

(cid:88)

µ∈A

(cid:17)2

µ ]pqΩB
pq

(cid:16) (cid:80)

p>q∈A[ZA
ωA
µ

E(2)

ind = −

(cid:88)

(cid:12)
(cid:12)
(cid:12)(cid:104)ΨA

I ΨB

(cid:12)
(cid:12)
µ ΨB
J (cid:105)
(cid:12)

J | ˆV |ΨA
ωA
µ

2

− 4

(cid:88)

ν∈B

(cid:16) (cid:80)

ν ]rsΩA
rs

r>s∈B[ZB
ωB
ν

(cid:17)2

(22)

µ(cid:54)=I
(cid:12)
(cid:12)
(cid:12)(cid:104)ΨA

I ΨB

(cid:12)
(cid:12)
I ΨB
ν (cid:105)
(cid:12)

J | ˆV |ΨA
ωB
ν

(cid:88)

−

ν(cid:54)=J
= E(2)

ind(A ← B) + E(2)

ind(B ← A)

2

(18)

where ωA
state I (J for the monomer B) to µ (ν)

ν ) are transition energies from the

µ (ωB

µ = EA
ωA

µ − EA
I

(19)

The E(2)
ind(A ← B) term arises from the per-
manent multipole moments on B changing the
wave function of monomer A. The E(2)
ind(B ←
A) term describes a corresponding change in
monomer B due to the perturbing ﬁeld of A.

Eq. (18) may be recast using contractions be-
tween 1-TRDMs of one monomer and the elec-
trostatic potential of its unperturbed interact-

where

∀p>q∈A [ZA

µ ]pq = Npq

∀r>s∈B [ZB

ν ]rs = Nrs

µ

(cid:16) (cid:2)YA
(cid:16) (cid:2)YB

ν

µ

(cid:3)

− (cid:2)XA
pq
rs − (cid:2)XB
(cid:3)

ν

(cid:17)

(cid:17)

(cid:3)
pq
(cid:3)

rs

(23)

The pertinent expression for the dispersion

energy is 68,69

(cid:18)

(cid:80)

pq∈A
rs∈B

(cid:19)2

pq γB,ν
γA,µ

rs vqs
pr

ωA

µ + ωB
ν

(24)

E(2)

disp = −

(cid:88)

µ(cid:54)=I,ν(cid:54)=J

6

which in the ERPA form reads 52

E(2)

disp = −16

(cid:88)

µ∈A,ν∈B

(cid:18)

(cid:80)

p>q∈A
r>s∈B

[ZA

µ ]pq[ZB

ν ]rsvqs
pr

(cid:19)2

ωA

µ + ωB
ν

(25)

2.2.3 Excited state case: explicit contri-
butions to dispersion and induc-
tion energies from de-excitations

Consider a dimer AIB0 in an excited state,
which dissociates into a monomer A in the state
I > 0 denoted in this section as AI (for simplic-
ity it is assumed that states of A are not degen-
erate) and a monomer B in the ground state,
denoted as B0. While all transition energies, cf.
Eq. (19), corresponding to B0 are positive

∀ν>0 ωB0

ν > 0

(26)

for the monomer A they take either negative or
positive values for transitions to states lower or
higher than I, respectively

∀µ<I ωAI
∀µ>I ωAI

µ < 0
µ > 0

(27)

(28)

In Eqs. (29) and (30) signs of the transition en-
ergies in the denominators are written explic-
itly.

Approximate methods which are based on
single-excitation operators, and for which the
linear response is directly related to an orbital
Hessian matrix, are likely to miss de-excitations
in the linear response function computed for the
excited state of interest. 70 Consequently, the
second term in Eq. (29) would not be accounted
for. Since this term involves transitions to the
low-lying states, it is anticipated to give a non-
negligible contribution to the dispersion energy.
A viable way to account for the de-excitations
from the AI state in dispersion energy calcula-
tions is by considering linear response proper-
ties of states J lower than I. After exploiting
the relations connecting response properties of
the states I and J

ωAI
J = EA

J − EA
I
I − EA
J

= − (cid:0)EA

(cid:1) = −ωAJ

I

pq = (cid:10)ΨI|ˆa†
γAI ,J
= (cid:10)ΨJ |ˆa†

qˆap|ΨJ
pˆaq|ΨI

(cid:11)

(cid:11)∗

= (cid:0)γAJ ,I

qp

(cid:1)∗

(31)

(32)

one immediately writes the µ = J component
of Eq. (29) as

Let us rewrite the dispersion energy expression,
Eq. (24), in a form in which we explicitly iso-
late terms involving negative transitions (de-
excitations)

(cid:88)

−

ν>0

(cid:18)

(cid:80)

pq∈AJ
rs∈B0
− (cid:12)

(cid:12)ωAJ

I

pq γB0,ν
γAJ ,I
(cid:12) + (cid:12)
(cid:12)

rs vqs
pr
(cid:12)
(cid:12)

(cid:12)ωB0
ν

(cid:19)2

≡ εI→J

disp (AJ B0)

(33)
The dispersion energy for the AIB0 dimer can
now be written as

(cid:19)2

disp(AIB0) = E(2)
E(2)

disp+

(AIB0)
(cid:18)

(cid:80)

(cid:88)

−

µ<I,ν>0

pq∈A
rs∈B

− (cid:12)

(cid:12)ωAI

µ

γAI ,µ
pq γB0,ν
(cid:12) + (cid:12)
(cid:12)

rs vqs
pr
(cid:12)
(cid:12)

(cid:12)ωB0
ν

(29)

where by E(2)
(AIB0) we denote the disper-
sion energy arising from the positive part of the
monomer A linear response function spectrum

disp+

(cid:18)

E(2)

disp+

(AIB0) = −

(cid:88)

µ>I,ν>0

(cid:80)

pq∈A
rs∈B
(cid:12)
(cid:12)ωAI

µ

rs vqs
pq γB0,ν
γAI ,µ
pr
(cid:12) + (cid:12)
(cid:12)
(cid:12)
(cid:12)
(30)

(cid:12)ωB0
ν

(cid:19)2

7

disp(AIB0) = E(2)
E(2)

disp+

(AIB0) +

I−1
(cid:88)

εI→J
disp (AJ B0)

J=0

(34)
It should be emphasized that Eq. (34) is fully
equivalent to Eq. (24) if exact response proper-
ties are employed. The crucial diﬀerence be-
tween the expressions in Eqs. (29) and (34)
is that in the former contributions to the dis-
persion energy from negative excitations follow
from the linear response of the state AI, while in
the latter they are obtained from the response
of states AJ which are lower in energy than AI.
The ERPA model applied to excited-state

function either

reference wave
completely
misses negative excitations or reproduces them
As a result, ERPA-
with poor accuracy.
approximated dispersion energy, Eq. (25), com-
puted for the excited-state dimer AIB0 will
lack important contributions from dexcitations.
The way around this problem is to employ the
alternative formula for the dispersion energy
presented in Eq. (34) in the ERPA approxima-
tion. This requires computing the E(2)
(AIB0)
term according to Eq. (25) and expressing
the approximated εI→J
disp (AJ B0) terms through
ERPA transition properties

disp+

εI→J
disp (AJ B0) =

(cid:18)

(cid:80)

p>q∈AJ
r>s∈B0
− (cid:12)

I

(cid:3)
pq

(cid:2)ZAJ
(cid:12) + (cid:12)
(cid:12)

(cid:12)ωAJ

(cid:2)ZB0
(cid:12)
(cid:12)

(cid:12)ωB0
ν

ν

I

(cid:3)
rs vqs

pr

− 16

(cid:88)

ν>0

(cid:19)2

(35)

ogous manner

ind(AIB0) = E(2)
E(2)

ind+

(AIB0) +

I−1
(cid:88)

εI→J
ind (AJ B0)

J=0

(38)
The E(2)
(AIB0) term is obtained from Eq. (22)
ind+
where the sum with respect to µ runs through
positive transitions (ωA
ind (AJ B0)
terms are given as

µ > 0). The εI→J

εI→J
ind (AJ B0) = 4

(cid:16) (cid:80)

p>q∈AJ

(cid:17)2

(cid:3)

pq ΩB0

pq

(cid:2)ZAJ
I
|ωAJ
I

|

(39)
and follow from solving ERPA equations for the
monomer A in states lower than I (from the
ground state, J = 0, up to J = I − 1). Ev-
idently, contributions to the induction energy
from negative excitations always take a positive
sign.

2.2.4 Second-order
contributions

exchange

energy

We begin with the general expressions for
the
induction and exchange-
dispersion energies in the S2 approximation 71,72

second-order

E(2)

exch−ind(S2) = (cid:104)ΨA
− E(1)
− E(2)
exch−disp(S2) = (cid:104)ΨA
− E(1)
− E(2)

I ΨB
elst (cid:104)ΨA
ind (cid:104)ΨA
I ΨB
elst(cid:104)ΨA
disp(cid:104)ΨA

J | ˆV ˆPΨ(1)
ind(cid:105)
J | ˆPΨ(1)
I ΨB
ind(cid:105)
J | ˆP|ΨA
I ΨB
I ΨB
J (cid:105)
J | ˆV ˆPΨ(1)
disp(cid:105)
J | ˆPΨ(1)
I ΨB
J | ˆPΨA
I ΨB

disp(cid:105)
I ΨB
J (cid:105)

E(2)

(40)

where |Ψ(1)
disp(cid:105) are the ﬁrst order in-
duction and dispersion wave functions, respec-

ind(cid:105) and |Ψ(1)

and ωAJ

The ZAJ
are the I-th eigenvector and
I
eigenvalue, respectively, of the ERPA equations
solved for the monomer A in the J-th state

I

I = ZAJ
ZAJ
I = ωAJ
ωAJ

I (ΨA
J )
I (ΨA
J )

(36)

(37)

To reiterate,
the negative-energy transition
I → J, which is either absent or erroneous
in ERPA, is easily accessed through a positive-
energy transition J → I computation carried
out for the states J < I. A similar ap-
proach has recently been applied to improve
the description of the correlation energy for
excited states within the adiabatic connection
ERPA method. 70 Notice that for the lowest ex-
cited states, which are usually of interest, the
εI→J
disp (AJ B0) terms have a negative sign, but
could in principle be positive for highly excited
state I.

The second-order induction energy for a
dimer in the excited state, obtained with the
ERPA approximation, Eq. (22), has to be cor-
rected for the missing de-excitations in an anal-

8

tively

Ψ(1)

ind = −

(cid:88)

µ(cid:54)=I

J | ˆV ΨA

I ΨB
J (cid:105)

|ΨA

µ ΨB

J (cid:105) (cid:104)ΨA
EA

µ ΨB
µ − EA
I
ν | ˆV ΨA

ν (cid:105) (cid:104)ΨA
EB

I ΨB
ν − EB
J

|ΨA

I ΨB

I ΨB
J (cid:105)

−

(cid:88)

ν(cid:54)=J

Ψ(1)

disp = −

(cid:88)

µ(cid:54)=I,ν(cid:54)=J

|ΨA

µ ΨB
EA

ν (cid:105) (cid:104)ΨA
µ + EB

µ ΨB
ν − EA

ν | ˆV |ΨA

I ΨB
J (cid:105)
I − EB
J

(41)

First calculations of second-order exchange
contributions in the single exchange approxima-
tion for many-electron systems were perfomed
by Chałasiński and Jeziorski. 72 The authors de-
rived general expressions in the form of a many-
orbital cluster expansion based on the induc-
tion and dispersion pair functions. Expressions

in terms of one-electron orbital basis set were
given in Ref. 73 for the exchange-dispersion en-
ergy and in Ref. 74 for the exchange-induction
During the development of
contributions.
the SAPT(CCSD) approach, Korona presented
the density-matrix formulation of both second-
order exchange components. 75,76

For ground-state single-determinant wave
function or Kohn-Sham determinant is it pos-
sible to calculate second-order exchange terms
through all orders in the intermolecular overlap,
as proven by Schäﬀer and Jansen. 77,78 Recently,
Waldrop and Patkowski have derived expres-
sions for the third-order exchange-induction. 79
The exchange-induction energy written in
terms of density matrices and transition ener-
gies reads (the S2 notation is dropped for conve-
nience)

E(2)

exch−ind(A ← B) = −

(cid:88)

µ(cid:54)=I,ν=0

(cid:68)(cid:16)

˜υ(r, r(cid:48)) + VAB
NANB

(cid:17)

γA,µ
int (x, x(cid:48))

(cid:69) (cid:10)γA,µ(x, x) |r − r(cid:48)|−1 γB(x(cid:48), x(cid:48))(cid:11)
ωA
µ

− E(1)
elst

(cid:88)

µ(cid:54)=I,ν=0

(cid:10)γA,µ(x, x(cid:48))γB(x(cid:48), x)(cid:11) (cid:10)γA,µ(x, x) |r − r(cid:48)|−1 γB(x(cid:48), x(cid:48))(cid:11)
ωA
µ

+ E(2)
ind

(cid:10)γA(x, x(cid:48))γB(x(cid:48), x)(cid:11)

where ˜υ(r, r(cid:48)) is the generalized interaction po-
tential

The 1- and 2-TRDMs in the position represen-
tation are deﬁned as

˜υ(r, r(cid:48)) = |r − r(cid:48)|−1 +

υB(r)
NB

+

υA(r(cid:48))
NA

(42)
int stands for the interaction density ma-

∀ r∈A
r(cid:48)∈B

and γA,µ
trix 62,75

γA,µ
int (x, x(cid:48)) =
− γA,µ(x(cid:48), x)γB(x, x(cid:48))

(43)

(cid:90)

(cid:90)

ΓA,µ(x, x(cid:48); x, x(cid:48)(cid:48))γB(x(cid:48)(cid:48), x(cid:48))dx(cid:48)(cid:48)

γA,µ(x(cid:48)(cid:48), x)ΓB(x(cid:48), x; x(cid:48), x(cid:48)(cid:48))dx(cid:48)(cid:48)

(cid:90) (cid:90)

ΓA,µ(x, x(cid:48)(cid:48)(cid:48); x, x(cid:48)(cid:48))ΓB(x(cid:48), x(cid:48)(cid:48); x(cid:48), x(cid:48)(cid:48)(cid:48))dx(cid:48)(cid:48)dx(cid:48)(cid:48)(cid:48)

−

−

−

(44)

9

γA,µ(x1, x(cid:48)
(cid:90)

1) =

NA

ΨA

I (x1, . . .)∗ΨA

µ (x(cid:48)

1, . . .)dx2dx3 . . . dxNA

(45)

and
ΓA,µ(x1, x2; x(cid:48)
1, x(cid:48)
(cid:90)

NA(NA − 1)

2) =

ΨA

I (x1, x2, ...)∗ΨA

µ (x(cid:48)

1, x(cid:48)

2, ...)dx3...dxNA

(46)

The pertinent expressions for the E(2)
exch−ind(B ←
A) component follow by interchanging A and
B indices.

In Ref. 53 we have derived the density-
matrix formula for the exchange-dispersion en-
ergy based on transition properties in the

(cid:0)[YB

ν ]rs − [XB

ν ]rs

(cid:1) (nr − ns)ΩA

rs

(a ϕp orbital may belong either to monomer
Xp = A or Xp = B).

ERPA framework. The corresponding expres-
sion for the exchange-induction energy compo-
nent takes the form

E(2)

exch−ind =
µ uA
V A
(cid:88)
µ
ωA
µ

µ∈A

4

+ 4

(cid:88)

ν∈B

ν uB
V B
ν
ωB
ν

− 4

(cid:16)

elst − V AB(cid:17)
E(1)

(cid:32)

(cid:88)

µ∈A

uA
µ tA
µ
ωA
µ

+

(cid:88)

ν∈B

uB
ν tB
ν
ωB
ν

(cid:33)

+ 2E(2)
ind

(cid:88)

p∈A
q∈B

npnq(Sq

p)2

The intermediates in Eq. (47) read

(cid:0)[YA

µ ]pq − [XA

µ ]pq

(cid:1) (np − nq)ΩB

pq

uA
µ =

uB
ν =

(cid:88)

p>q∈A
(cid:88)

r>s∈B

(cid:88)

tA
µ =

tB
ν =

p>q∈A
r∈B
(cid:88)

r>s∈B
p∈A

(cid:0)[YA

µ ]pq − [XA

µ ]pq

(cid:0)[YB

ν ]rs − [XB

ν ]rs

(48)

(cid:1) (np − nq)nrSr

pSr
q

(cid:1) (nr − ns)npSp

r Sp
s

(49)

and

V A
µ =

(cid:88)

pq∈A
r∈B

nrγA,µ

pq ˜vrr

qp +

(cid:88)

nr

¯ΓA,µ
pqaa(cid:48)Sr

a(cid:48) ˜var
pq

+

+

pqaa(cid:48)∈A
r∈B
p ˜vsr
qb

¯ΓB
rsbb(cid:48)Sb(cid:48)

(cid:88)

γA,µ
pq

pq∈A
rsbb(cid:48)∈B
(cid:88)

pqaa(cid:48)∈A
rsbb(cid:48)∈B

pqaa(cid:48) ¯ΓB
¯ΓA,µ

rsbb(cid:48)Sb(cid:48)

q Ss

a(cid:48) ˜vab
pr

(cid:88)

V B
ν =

npγB,ν

rs ˜vrs

pp +

(cid:88)

np

¯ΓB,ν
rsbb(cid:48)Sb(cid:48)

p ˜vsr
pb

+

+

p∈A
rs∈B
(cid:88)

p∈A
rsbb(cid:48)∈B
a(cid:48) ˜vas
pq

¯ΓA
pqaa(cid:48)Sr

γB,ν
rs

pqaa(cid:48)∈A
rs∈B
(cid:88)

pqaa(cid:48)∈A
rsbb(cid:48)∈B

¯ΓA
pqaa(cid:48) ¯ΓB,ν

rsbb(cid:48)Sb(cid:48)

q Ss

a(cid:48) ˜vab
pr

where the eﬀective two-electron potential,
Eq. (42) in the matrix representation is

(51)

(cid:28)

˜vrs
pq =

(47)

ϕp(r)ϕq(r(cid:48))|˜v(r, r(cid:48))|ϕr(r)ϕs(r(cid:48))

(cid:29)

= vrs
+ N −1

B (cid:104)ϕp|vB|ϕr(cid:105) (cid:0)δqsδXqXs + Ss

pq + N −1
A (cid:104)ϕq|vA|ϕs(cid:105) (cid:0)δprδXpXr + Sr

q (1 − δXqXs)(cid:1)

p(1 − δXpXr)(cid:1)
(52)

,

When 1- and 2-TRDMs in Eqs. (50)-(51)
are expanded according to Eqs. (15)-(16) and
Eq. (17), respectively, one arrives at the matrix
representation of the V A

terms

µ and V B
ν

V A
µ = −

(cid:88)

[XA

µ ]pq

(cid:104)
(np − nq)

(cid:88)

nr˜vrr
pq

p>q∈A
(cid:88)

r∈B
pqrr + (np − nq)QB

nrP A

pq − RAB
pq

(cid:105)

r∈B
(cid:88)

(cid:104)

[YA

µ ]pq

− (np − nq)

(cid:88)

nr˜vrr
pq

p>q∈A
(cid:88)

nrP A

qprr − (np − nq)QB

r∈B
qp − RAB
qp

(cid:105)

+

−

+

r∈B

(53)

V B
ν = −

(cid:88)

[XB

ν ]rs

(cid:104)
(nr − ns)

(cid:88)

np˜vrs
pp

r>s∈B
(cid:88)

p∈A
pprs + (nr − ns)QA

npP B

rs − RBA
rs

(cid:105)

p∈A
(cid:88)

(cid:104)

[YB

ν ]rs

− (nr − ns)

(cid:88)

np˜vrs
pp

r>s∈B
(cid:88)

npP B

ppsr − (nr − ns)QA

p∈A
sr − RBA
sr

(cid:105)

p∈A

(54)

+

−

+

(50)

10

where

P A

pqrs =

(cid:88)

(cid:0)N A

aa(cid:48)pr˜vas

qa(cid:48) − N A

qa(cid:48)ar˜vas

pa(cid:48) − N A

aqa(cid:48)r˜vas
a(cid:48)p

aa(cid:48)∈A
psSr
+ OA
q
(cid:88)

P B

pqrs =

(cid:0)N B

bb(cid:48)rp˜vb(cid:48)s

qb − N B

sb(cid:48)bp˜vb(cid:48)r

qb − N B

bsb(cid:48)p˜vrb(cid:48)

qb

(cid:1)

bb(cid:48)∈B
rqSs
+ OB
p
(cid:88)
OA

asSr
a

QA

rs =

a∈A
(cid:88)

OB

bqSb
p

QB

pq =

b∈B
(cid:88)

RAB

pq =

Tqabb(cid:48) ˜vab

pb(cid:48) − Tapbb(cid:48) ˜vqb(cid:48)

ab + Waqb(cid:48)bSb(cid:48)

p Sb
a

a∈A
bb(cid:48)∈B
− Wpab(cid:48)bSb(cid:48)
(cid:88)

a Sb
q
Taa(cid:48)sb˜vba

RBA

rs =

ra(cid:48) − Taa(cid:48)br˜vsa(cid:48)

ba + Wa(cid:48)absSr

a(cid:48)Sb
a

aa(cid:48)∈A
b∈B
− Wa(cid:48)arbSb

a(cid:48)Ss
a

(55)

with N A and N B intermediates given in
Eq. (10), and the remaining intermediates de-
ﬁned as

OA

tu =

OB

tu =

(cid:88)

¯ΓA
taa(cid:48)a(cid:48)(cid:48) ˜va(cid:48)(cid:48)u
aa(cid:48)

aa(cid:48)a(cid:48)(cid:48)∈A
(cid:88)

¯ΓB
tbb(cid:48)b(cid:48)(cid:48) ˜vb(cid:48)b
ub(cid:48)(cid:48)

bb(cid:48)b(cid:48)(cid:48)∈B

Ttuvw =

=

(cid:88)

aa(cid:48)∈A
bb(cid:48)∈B
(cid:88)

taua(cid:48) ¯ΓB
¯ΓA

bvb(cid:48)wSb

a(cid:48)Sb(cid:48)

a

(cid:18) (cid:88)

¯ΓA
taua(cid:48)Sb(cid:48)

a Sb
a(cid:48)

(cid:19)

¯ΓB
bvb(cid:48)w

bb(cid:48)∈B
(cid:88)

Wtuvw =

aa(cid:48)∈A
bb(cid:48)∈B
(cid:88)

=

aa(cid:48)∈A
taua(cid:48) ¯ΓB
¯ΓA

bvb(cid:48)w˜va(cid:48)b(cid:48)

ab

(cid:18) (cid:88)

¯ΓA
taua(cid:48) ˜va(cid:48)b(cid:48)

ab

(cid:19)

¯ΓB
bvb(cid:48)w

(56)

(57)

(58)

bb(cid:48)∈B

aa(cid:48)∈A

Both induction and exchange-induction terms
in SAPT are routinely calculated in the cou-
pled approximation, 80 so that the response
of monomer orbitals due to the perturbation
ﬁeld of
its interacting partner is accounted
for. The uncoupled approach, which neglects

(cid:1)

the inﬂuence of the perturbing ﬁeld,
is used
in calculations of the dispersion and exchange
dispersion energies in wave-function SAPT 13
including the popular SAPT0 model. 81,82 In
both SAPT(DFT) and SAPT(CCSD) the cou-
pled level of theory has been shown to give
highly accurate second-order energy contribu-
tions. 60,75,76,83–86

SEC

OCCn3

Evaluation of the exchange-induction energy
requires construction of the T and W inter-
mediates, Eq. (57) and Eq. (58), respectively,
which has the n6
OCC scaling (nOCC are orbitals
with non-zero occupancy). Since the 2-RDM
matrix elements factorize unless all four indices
correspond to fractionally occupied orbitals, the
formal scaling with the sixth power is only with
respect to the number of such orbitals. In com-
parison, the exchange-dispersion energy is more
expensive, as it requires steps with a n3
scaling (nSEC = Ms2 + Ms3). 53 It should also be
noted that the bottleneck step in evaluation of
the ﬁrst-order exchange energy, Eq. (9), engages
three four-index quantities (the NA, NB inter-
mediates and integrals) which amounts to M 6
s2
scaling. Note that for GVB the 2-RDMs fac-
torize also in the active block 54 which results in
identical scaling as in the SAPT(HF) method.
Recently, we have demonstrated that the un-
coupled approximation in the ERPA framework
combined either with CASSCF or GVB descrip-
tion of the monomers leads to a poor qual-
ity of the second-order dispersion energy. 52,53 A
more accurate dispersion energy is obtained if
the monomer response properties are expanded
up to the ﬁrst order in the coupling parameter,
which we refer to as the semicoupled approxi-
mation. 52 The fully coupled ERPA scheme gives
best results for both dispersion and exchange-
dispersion energies.
In this work all second-
order energy components were obtained with
the coupled approximation.

The multiconﬁgurational SAPT method,
comprising ﬁrst- and second-order energy com-
ponents, is based on the chosen wave function
theory applied to description of monomers. It
is important to notice that computation of all
SAPT terms requires only knowledge of the
corresponding one- and two-electron reduced
In the rest of
density matrices of monomers.

11

this work we use the notation SAPT(MC) for
the proposed method, where MC indicates the
underlying multiconﬁgurational wave function
model employed to obtain reduced density ma-
trices. The results will be presented for two
multiconﬁgurational wave funcitons: CASSCF
and GVB approximations. For comparison,
we also include the SAPT results following
from the single-determinantal description of
monomers, denoted as SAPT(HF).

3 Computational details

The ERPA equations applied to GVB or CAS
wave functions require dividing the orbital
space of each monomer into three disjoint sub-
sets referred to as s1, s2 and s3. The cardi-
nalities of the subsets are represented by the
Ms1, Ms2 and Ms3 notation. For wave func-
tions of the CAS type the s1 set contains all
inactive orbitals, whereas s2 and s3 correspond
to the active and virtual orbitals, respectively.
When ERPA is applied with the GVB refer-
ence, the s1 set is deﬁned as all orbitals which
occupation numbers fulﬁl the np > 0.992 con-
dition. The s2 set includes all active orbitals,
i.e., strongly occupied orbitals with occupation
numbers 0.992 ≥ np ≥ 0.5 and their weakly oc-
cupied partners from the same geminal. The
remaining orbitals are grouped in the s3 set.
The p, q indices of the [Xν]pq and [Yν]pq vectors
span the following range

p ∈ s2 ∧ q ∈ s1
p ∈ s3 ∧ q ∈ s1
p ∈ s2 ∧ q ∈ s2
p ∈ s3 ∧ q ∈ s2

(59)

(analogous range is assumed for the pq and rs
indices of Apq,rs ± Bpq,rs).

In ERPA the presence of degeneracies and
near-degeneracies in the p ∈ s2 ∧ q ∈ s2
space, cf. Eq. (59), may lead to numerical in-
stabilities. To circumvent this, we discarded
pairs of orbitals [in practical terms, it means
discarding corresponding rows and columns in
the ERPA matrices, see Eq. (11)] applying the
|np−nq|/np < 10−2 condition for the GVB wave
function and |np − nq|/np < 10−6 for the CAS

12

wave function.

The results obtained with CASSCF and GVB
treatment of the monomers are denoted as
SAPT(CAS), and SAPT(GVB), respectively.
Pertinent calculations were performed in the
locally developed code. The necessary inte-
grals, 1- and 2-RDMs for CASSCF wave func-
tions were obtained from a developer version of
the Molpro program. 87 The GVB calculations
were carried out in the locally modiﬁed Dalton
program 88 and interfaced with our code. The
MP2 natural orbitals were used as the starting
guess in both CASSCF and GVB calculations.
For the H2· · · H2 dimer, discussed in Sec-
tion 4.1, we carried out reference calculations
exact up to second-order in SAPT, using an
in-house code developed for interactions be-
tween two-electron monomers and based on di-
rect projection onto irreducible representations
of the symmetric S4 group. 89 The pertinent re-
sults are denoted as SAPT(FCI) in this work.
The augmented correlation-consistent orbital
basis sets of double- and triple-zeta quality
(aug-cc-pVXZ, X = D,T) 90,91 were employed
throughout the work. Monomer calculations
were carried out in the dimer-centered basis set.
of
SAPT(GVB) and SAPT(CAS) calculations for
benchmark data set of noncovalently bound
complexes introduced by Korona 92 which we
refer to as the TK21 data set. The accu-
racy of individual SAPT energy components
and interaction energies is veriﬁed against
the SAPT(CCSD) benchmark.
All CCSD
calculations were performed with frozen core
electrons. The SAPT(HF), SAPT(DFT) and
SAPT2+(CCD) results are also reported. The
exchange-correlation PBE0 93,94 functional em-
ployed in SAPT(DFT) was asymptotically-
corrected using the GRAC scheme 95 applied
with the experimental values of the ionization
potentials. The SAPT(HF), SAPT(DFT) and
SAPT(CCSD) calculations were performed in
Molpro. 87 The SAPT2+(CCD) results were
obtained with the Psi4 96 program. In the lat-
ter variant of SAPT, the interaction energy is

In Section 4.3 we present

results

represented as

elst + E(12)

elst,resp

= E(10)
exch + E(12)

ESAPT2+(CCD)
int
+ E(10)
+ E(20)
+ E(2)

exch + E(11)
ind,resp + E(22)
disp,CCD + E(20)

exch−disp

exch

ind + E(20)

exch−ind,resp + E(22)

exch−ind

dataset are given in the Supporting Informa-
tion.

4 Results

4.1 Multi-reference ground-state

(60)

system: H2-H2

where the (ij) superscript refers to the ith- and
jth-order expansion in the intermolecular inter-
action operator and intramolecular correlation
operator, respectively; the energy terms marked
with the “resp” index account for the orbital re-
laxation eﬀects. Except for the E(2)
disp,CCD term,
the interaction energy components grouped in
Eq. (60) are identical to the SAPT2 97 approach.
The “+(CCD)” notation indicates that the dis-
persion energy is obtained in the coupled pair
approximation including noniterative contribu-
tions from single and triple excitations, here re-
ferred to as CCD+ST(CCD) 98,99 approach.

The accuracy of SAPT interaction energies
discussed in Section 4.3 is veriﬁed against
counterpoise-corrected 100 (CP) supermolecular
CCSD(T) results. To this end, we approx-
imate higher-order induction contributions at
the Hartree-Fock level of theory 101,102

δHF = EHF
int
elst + E(10)
E(10)

−

(cid:16)

exch + E(20)

ind,resp + E(20)

exch−ind,resp

(cid:17)

(61)

where EHF
is the supermolecular Hartree-Fock
int
interaction energy. The δHF component was
added to the SAPT interaction energy provided
that the ratio of the sum of the induction and
exchange-induction energies to the total inter-
action energy was larger than 12.5%, in agree-
ment with the criterion selected in Ref. 103.
Note that in Section 4.3 error statistics for to-
tal interaction energies are reported for the S2
subset of the TK21 dataset which excludes six
largest dimers (see Refs. 92 and 104).

As an additional test, we performed SAPT
calculations for the A24 dataset 105 of Řezáč and
Hobza. Since we observed the same qualitative
trends as in the TK21 case, results for the A24

13

We begin the analysis of multiconﬁgurational
SAPT with a model H2· · · H2 dimer. We
monitor the change of the interaction energy
upon bond dissociation in one of the hydro-
gen molecules. A quantitative description of
this system is challenging as it has to capture
the balance between long-range dynamic cor-
relation and increasing nondynamic correlation
eﬀects. 34,106

We examine the T-shaped structure of the
H2· · · H2 complex in which one the covalent
H-H bonds is stretched from 1.37 a0 to 7.2 a0
(see Figure 1 for a detailed description).
In
SAPT(CAS) calculations each monomer is de-
scribed with a CAS(2,5) wave function. Note
that for two-electron monomers SAPT(GVB) is
equivalent to SAPT(CAS) based on CAS(2,2)
wave functions.

SAPT schemes based either on Hartree-Fock
or Kohn-Sham description of the monomers fail
to predict the behavior of individual interaction
energy components as the H−H bond is elon-
gated and the complex gains a multireference
character (Figure 1). The SAPT(CSSD) ap-
proach initially remains in excellent agreement
with the SAPT(FCI) benchmark. The largest
relative percent errors in SAPT(CCSD) near
the equilibrium geometry (RH−H = 1.41 a0) oc-
cur for the exchange-induction and exchange-
dispersion energies which are overestimated
by ca. 4% and 7%, respectively. These dis-
crepancies in the single-reference regime re-
sult from exclusion of certain cumulant con-
tributions in the second-order exchange expres-
sions. 75,76 After the H−H bond length exceeds
3.0 a0, the XCCSD-3 approximation underlying
SAPT(CCSD) 107,108 starts to break down which
translates into qualitative errors in all interac-
tion energy components. 34

Both SAPT(GVB) and SAPT(CAS) predict

e
h
t

r
o
f

y
r
o
e
h
t

f
o

s
l
e
v
e
l

I

C
F

d
n
a

T
F
D

,

D
S
C
C

,
)
S
A
C
(

F
C
S
S
A
C

,

B
V
G

,
)
F
H
(

k
c
o
F
-
e
e
r
t
r
a
H

e
h
t

t
a

n
o
i
t
u
b
i
r
t
n
o
c

y
g
r
e
n
e

T
P
A
S

:
1

e
r
u
g
i
F

s
i

e
c
n
a
t
s
i
d

H
−
H
R
e
h
t

s
r
e
m
o
n
o
m
e
h
t

f
o

e
n
o

n
I

.
0
a
1
2
.
6

t
a

d
e
x
ﬁ

s
i

e
c
n
a
t
s
i
d

r
a
l
u
c
e
l
o
m
r
e
t
n
i

e
h
T

.
n
o
i
t
a
r
u
g
ﬁ
n
o
c

d
e
p
a
h
s
-
T
e
h
t

n

i

r
e
m
i
d

2

H

·

·

·
2

H

.

Z
T
V
p
-
c
c
-
g
u
a

s
i

t
e
s

s
i
s
a
b

e
h
T

.
0
a
4
4
.
1

f
o

e
c
n
a
t
s
i
d

d
e
x
ﬁ

a

t
a

t
p
e
k

s
i

d
n
o
b
H
–
H
e
h
t

r
e
m
o
n
o
m

r
e
h
t
o

e
h
t

n

i

e
l
i

h
w

0
a
0
2
.
7

o
t

7
3
.
1
m
o
r
f

d
e
i
r
a
v

14

-100-90-80-70-60-50-40-3012345678ELSTE(n)RS/ µEhRH-H/ a0HFGVBCASDFTCCSDFCI-11-10-9-8-7-6-5-412345678IND RH-H/ a0-260-240-220-200-180-16012345678DISPRH-H/ a06010014018022026012345678EXCHE(n)SRS/ µEhRH-H/ a0123456712345678EXCH-IND RH-H/ a06810121416182012345678EXCH-DISPRH-H/ a0RH-Hd=6.21 a.u.the correct shape of the interaction energy
curves (Figures 1-2). The GVB-based vari-
ant systematically underestimates the magni-
tude of all SAPT contributions and SAPT in-
teraction energy. The exchange-induction en-
ergy deviates most from the benchmark with
relative percent errors in the 10 − 20% range.
Errors for the remaining components stay below
12% near the equilibrium and the accuracy im-
proves together with the increasing share of the
nondynamic correlation in the system (see also
Tables S1-S3 in the Supporting Information).
SAPT(CAS) is more accurate—errors with re-
spect to the SAPT(FCI) benchmark do not ex-
ceed 3% not only in individual components, but
also in the total interaction energy. The error
of the SAPT(FCI) interaction energy with re-
spect to supermolecular FCI (denoted as EFCI
int
in Figure 2) increases from 1.1% in the equilib-
rium geometry to 15% at RH−H =7.2 a0.

As we discussed in Ref. 52, further extension
of the active space in SAPT(CAS) is of little
beneﬁt for this system. Instead, to reach higher
accuracy one needs to move beyond the ERPA
scheme and solve full linear response equations,
i.e., include response not only from the orbitals,
but also the wave function expansion coeﬃ-
cients.

4.2 Excited-state system: C2H∗
4-

Ar

In this section we present SAPT(CAS) calcu-
lations for the C2H4· · · Ar dimer in which the
ethylene molecule is either in the ground or
electronically excited state. We focus on the
singlet excitation of a valence character with
the largest contribution from the π → π∗ tran-
sition. 109 The C2H4· · · Ar complex is kept in
the C2v symmetry with the Ar atom located
on the axis perpendicular to the C2H4 plane
and bisecting its C-C bond (see also Table S4 in
the Supporting Information for geometry of the
C2H4 molecule). The interaction energy curves
presented in Figure 3 and Table 1 are obtained
by varying the distance R between the Ar atom
and the center of the mass of ethylene. Counter-
poise correction 100 has been applied to all su-
permolecular interaction energies presented in

this section.

To access the excited states wave functions
of both the dimer and the ethylene molecule,
we carried out three-state state-averaged CAS
calculations (SA-CAS) in the CAS(2,3) active
space, i.e., two active electrons distributed on
π, σ, and π∗ active orbitals.
In these calcu-
lations the targeted π → π∗ state is the third
state in the SA ensemble. Note that in both
SAPT(CAS) and supermolecular CASSCF cal-
culations the Ar atom is represented with a sin-
gle determinant.

For ground state calculations we used super-
molecular CCSD(T) results as benchmark. To
obtain reference values for excited states, we
adopted the procedure of Ref. 110 which com-
bines the CCSD(T) description of the ground
state with excitation energies calculated at the
EOM-CCSD 111 level of theory

(C2H∗

E

Est. EOM-CCSD(T)
int
CCSD(T)
E
int
− ωEOM−CCSD(C2H∗
4)

4 · · · Ar) =

(C2H4 · · · Ar) + ωEOM−CCSD(C2H∗

4 · · · Ar)

where the asterisk indicates a molecule in ex-
cited state, ωEOM−CCSD denotes the pertinent
is
EOM-CCSD excitation energy and E
a ground state interaction energy.

CCSD(T)
int

In Figure 3 we compare SAPT(CAS) in-
teraction energy curves with supermolecular
CAS(2,3) results and a coupled-cluster bench-
mark. As it has been rigorously shown in
Ref. 104, supermolecular CAS interaction en-
ergy misses dispersion contributions if active
orbitals are assigned only to one monomer,
which is the case here. The CAS+DISP curves
in Figure 3 represent CAS interaction energy
supplemented with the dispersion component
taken from SAPT(CAS) calculations, E(2)
DISP =
disp + E(2)
E(2)
exch−disp. For the π → π∗ state both
SAPT(CAS) and CAS+DISP interaction en-
ergies were computed by explicitly accounting
for the de-excitation-energy terms according to
Eq. (34) and Eq. (38). The SAPT(CAS)∗ and
CAS+DISP∗ curves were obtained by neglect-
ing the εI→J

disp and εI→J
ind

terms.

Inspection of Figure 3 and Table 1 shows that
the C2H4· · · Ar complex in the ground state is

15

Figure 2: SAPT interaction energy for the H2· · · H2 dimer in the T-shaped conﬁguration (see
Figure 1 for geometry description). EFCI
int denotes the supermolecular FCI interaction energy. The
basis set is aug-cc-pVTZ.

bound by the dispersion forces. The CAS in-
teraction curve is mainly repulsive and features
only a shallow minimum located at ca. 5.0 Å
and 0.03 mEh deep. Addition of the disper-
sion energy in CAS+DISP builds up a van
der Waals minimum 0.56 mEh deep localized at
4.0 Å, which is in reasonable agreement with the
CCSD(T) reference (0.48 mEh at Req = 4.0 Å).
The performance of SAPT(CAS) is excellent.
The total SAPT(CAS) interaction energy at
the optimal monomer separation is equal to
−0.49 mEh and the entire interaction curve al-
most coincides with the benchmark. The dis-
persion energy is clearly the dominating attrac-
tive contribution amounting to −1.03 mEh in
the minimum (see Table 1).

Computation of the second-order SAPT com-
ponents in the proposed SAPT(CAS) approach
involves solving the ERPA equations. When
the monomer reduced density matrices enter-
ing ERPA equations correspond to an unstable
CAS solution, either near-instabilities or insta-
bilities may occur in the linear response.
In
general, the SA-CAS calculation in a small ac-
tive space bears the risk that wave functions
describing higher excited states are not sta-

Table 1: Components of interaction energy for
the C2H4· · · Ar dimer in the ground (g.s.) and
excited states. ESAPT
are the total
interaction energies with and without, respec-
tively, the inclusion of contributions from the
negative-energy transitions εI→J
disp/ind deﬁned in
Eqs (35) and (39). All values in mEh.

and ESAPT∗
int

int

g.s.

π → π∗

−0.257

Component R=4.00 Å R=3.30 Å
E(1)
elst
E(1)
exch
E(2)
ind+
(cid:80)
J εI→J
ind

−2.486

−3.987

−0.474

0.000

6.054

0.000

0.723

0.457

−1.026

0.000

0.090

−0.487

−0.487

4.434

−4.561

−1.087

0.844

0.298

−0.789

E(2)
E(2)
(cid:80)

exch−ind

disp+
J εI→J
disp

exch−disp

E(2)
ESAPT∗
int
ESAPT
int

16

-250-225-200-175-150-125-100-75-50-25 1 2 3 4 5 6 7 8Eint / µEhRH-H / a0HFGVBCASDFTCCSDFCIEintFCIESAPTeintFigure 3: Interaction energy curves for the C2H4· · · Ar dimer in the ground state (left) and in the
π → π∗ state (right). The basis set is aug-cc-pVTZ.

ble in ERPA. This is what we have encoun-
tered for the SA-CAS π → π∗ state of the
studied C2H4· · · Ar dimer (see Figures S1-S3).
To avoid instabilities in the ERPA equations,
which manifest in discontinuous interaction en-
ergy curves, we applied a three-point cubic
extrapolation of second-order energy contribu-
tions based on the Dyall partitioning of the
monomer Hamiltonian 112,113 and expansion of
the ERPA response properties in the coupling
parameter. 52,114 The details on the cubic ex-
trapolation model are provided in the Support-
ing Information.

The interaction energy curves for the π → π∗
state are shown in Figure 3. At the CASSCF
level of theory the interaction has a purely
repulsive character. The CAS+DISP model
gives a binding curve which remains in excellent
agreement with the coupled-cluster reference.
The employed CC method [Eq. (62)] predicts a
1.61 mEh deep minimum at the intermonomer
separation of 3.3 Å. The CAS+DISP minimum
occurs at a slightly shorter distance of 3.2 Å and
is 1.60 mEh deep. Note that the nearly per-
fect agreement with CC has to rest partially
on error cancellation, since CAS+DISP neglects
contributions from negative excitations in the
second-order exchange-dispersion energy (only
εI→J
disp terms are included in the model). The
interaction energy curve from SAPT(CAS) cal-
culations deviates from both CAS+DISP and
CC results at the intermediate and short range.
SAPT(CAS) localizes the minimum at 3.6 Å

and underbinds by as much as 0.8 mEh com-
pared to the CC reference (Table 1). The large
discrepancy between second-order SAPT and
the hybrid CAS+DISP approach reﬂects that
higher-order induction terms, present in the su-
permolecular CAS and absent in SAPT, become
important already for the low lying π → π∗ va-
lence state.

Contributions from the negative-energy tran-
sitions in the linear response are essential for a
quantitative description of the C2H∗
4 · · · Ar in-
teraction. Neglecting the εI→J terms in SAPT
reduces the well depth by a factor of two, cf.
SAPT(CAS)* results in Figure 3. Similarly,
comparing CAS+DISP with CAS+DISP* re-
veals that a good agreement of CAS+DISP
with the coupled-cluster reference is possible
only after inclusion of the de-excitation part of
the spectrum. The observed energy lowering
comes solely from the εI→J
disp terms, as the induc-
tion counterparts vanish due to symmetry (Ta-
ble 1). In the van der Waals minimum, the two
dispersion terms [ε2→0
disp , cf. Eq. (34)]
sum up to −1.9 mEh which is a sizeable ef-
fect considering that positive-energy transitions
amount to −4.6 mEh.

disp and ε2→1

4.3 Single-reference systems

In this section we analyze the performance
of the multiconﬁgurational SAPT schemes for
many-electron dimers of the TK21 dataset of
Korona 92 against benchmark SAPT(CCSD) re-

17

-0.6-0.4-0.20.00.20.40.60.8 3 4 5 6 7 8 9 10Eint / mEhR / AngstromCAS SAPT(CAS)CAS+DISPCCSD(T)-2.0-1.5-1.0-0.50.00.51.01.52.0 2 3 4 5 6 7 8 9 10R / AngstromCAS SAPT(CAS)*SAPT(CAS) CAS+DISP*CAS+DISP Est. EOM-CCSD(T)sults. Additionally, we present SAPT(PBE0)
and SAPT2+(CCD) results. Although TK21
includes systems governed by the dynamic
rather than static correlation eﬀects, our aim
is to determine the level accuracy which could
be expected of the studied mulitconﬁgurational
SAPT if applied to multireference systems.
Note that in all SAPT calculations the ex-
change terms were obtained in the S2 ap-
proximation. The ﬁrst-order exchange and
second-order exchange-induction contributions
in SAPT(CCSD) include the cumulant contri-
butions. 75,115

in the 6-8% range.

Figure 4 shows relative percent errors of
the individual SAPT energy components with
respect to the SAPT(CCSD) reference (see
also Tables S8-S11 in the Supporting Informa-
tion). Let us begin with the ﬁrst-order energy
terms. Both SAPT(GVB) and SAPT(CAS)
recover the electrostatic and exchange en-
ergies with similar accuracy—the mean ab-
solute errors (∆abs) for these contributions
fall
In contrast to the
electrostatic energy, the ﬁrst-order exchange
is systematically underestimated with mean
errors of −6.4% and −5.4% obtained with
GVB and CAS wavefunctions,
respectively.
SAPT(GVB) aﬀords smaller spread of errors
compared to SAPT(CAS), in particular for the
E(1)
elst component. The multireference treatment
of the monomers constitutes an improvement
over the Hartree-Fock (single-determinantal)
description, (the ∆abs values from the Hartree-
Fock-based SAPT calculations amount to ca.
13% for both components) but it remains infe-
rior to both SAPT(DFT) and SAPT2+(CCD).
The second-order SAPT energy contributions
obtained with the SAPT(CAS) variant are con-
sistently more accurate than their SAPT(GVB)
counterparts. In the TK21 dataset the largest
diﬀerence occurs for the induction energy,
where SAPT(GVB) deviates from the bench-
mark by 14.6% and 20.1% in terms of ∆abs
and standard deviation, respectively, whereas
the respective errors for SAPT(CAS) amount
to 7.8% and 9.5%. This conﬁrms that the CAS-
based ERPA provides better approximation for
both transition density matrices and transition
energies than when GVB density matrices are

ind and E(2)

used. 52,53 Similar as in the ﬁrst-order, the po-
larization terms (E(2)
disp) from multi-
conﬁgurational SAPT compare favorably with
SAPT(HF), but do not match the quality of
SAPT(DFT) or SAPT2+(CCD) results. The
discrepancy is more pronounced for the disper-
sion energy where mean absolute errors from
CCD+ST(CCD) and SAPT(DFT) calculations
are equal to 2.2% and 2.9%, respectively, com-
pared to 6.4% obtained with SAPT(CAS) and
9.9% at the SAPT(GVB) level of theory.

The second-order exchange-induction and
exchange-dispersion energies are more challeng-
ing than the polarization terms. SAPT(DFT)
performs best recovering the E(2)
exch−ind and
E(2)
exch−disp contributions with the ∆abs val-
ues of 7.5% and 4.3%, respectively. Both
SAPT(GVB) and SAPT(CAS) tend to under-
estimate second-order exchange (∆abs values
fall in the 10-14% range). It is worthwhile to
note that in the SAPT2+(CCD) scheme the
exchange-dispersion energy is calculated using
the uncoupled formula which leads to the mean
absolute error as large as 24% with respect to
the coupled SAPT(CCSD) reference.

In Table 2 we examine the accuracy of to-
tal SAPT interaction energies with respect to
the SAPT(CCSD) reference evaluated for the
S2 subset of the TK21 dataset. Error statis-
tics is given in terms of the mean error ∆,
the standard deviation σ, the mean absolute
error ∆abs, and the maximum absolute error
∆max. Both multiconﬁgurational SAPT ap-
proaches reach similar accuracy. With ∆abs =
6.0% and σ = 7.4%, SAPT(GVB) remains in
slightly better agreement with the benchmark
than SAPT(CAS) (the respective values for the
latter are ∆abs = 6.9% and σ = 8.9%). The
error statistics for multiconﬁgurational SAPT
matches SAPT(DFT) results where ∆abs and σ
amount to 5.6% and 7.5%, respectively. This
indicates a systematic error cancellation be-
tween attractive and repulsive energy contribu-
tions in the ERPA-based SAPT, since for the
individual energy components SAPT(DFT) is
clearly closest to SAPT(CCSD).

It is interesting to compare SAPT interaction
energies against the supermolecular CCSD(T)

18

Figure 4: Box plots of relative percent errors (∆) in the polarization SAPT components (top:
electrostatic, induction and dispersion energies) and in the exchange SAPT components (bottom:
exchange, exchange-induction and exchange-dispersion, all in the S2 approximation) for dimers of
the TK21 data set. HF, GVB and CAS denote wave function description of the monomers. PBE0
stands for the asymptotically-corrected PBE0 functional. Relative percent errors are calculated
according to the ∆i = Ei−Ei,ref
· 100% formula. Errors are given with respect to the SAPT(CCSD)
|Ei,ref |
reference. Errors for the E(2)
outer fences encompass 50% and 95% of the distribution, respectively.

exch−disp energy are reported for the S2 subset of TK21. The box and

19

-40-30-20-10 0 10 20 30 40HFGVBCASPBE0SAPT2+∆ [%]E(1)elst-70-60-50-40-30-20-10 0 10 20 30 40HFGVBCASPBE0SAPT2+E(2)ind-10-5 0 5 10 15 20HFGVBCASPBE0CCD+STE(2)disp-30-20-10 0 10 20 30 40HFGVBCASPBE0SAPT2+∆ [%]E(1)exch-50-40-30-20-10 0 10 20 30 40 50HFGVBCASPBE0SAPT2+E(2)exch-ind-40-30-20-10 0 10 20 30 40HFGVBCASPBE0SAPT2+E(2)exch-dispTable 2: Summary of error statistics (in percent) for the SAPT interaction energy for dimers
of the TK21/S2 dataset. Errors of the SAPT interaction energy (ESAPT
) are given with respect
to SAPT(CCSD) results. Errors of the SAPT interaction energies corrected for the δHF term
) are given with respect to CP-corrected 100 supermolecular CCSD(T) results calculated
(ESAPT+δHF
in the same basis set. The 2+(CCD) notation refers to the SAPT2+(CCD) scheme. All exchange
energy components are computed in the S2 approximation. The basis set is aug-cc-pVTZ.

int

int

†ESAPT
int
∆
σ
∆abs
∆max

HF
−9.87
14.94
12.66
33.66

GVB
CAS
−0.80 −0.44
8.87
6.89
14.74

7.41
5.95
12.32

PBE0
2.72
7.54
5.60
16.93

2+(CCD)
−6.95
5.71
7.93
14.78

int

‡ESAPT+δHF
HF
∆
−10.00
σ
10.38
∆abs
11.33
∆max
27.64
† errors with respect to SAPT(CCSD)
‡ errors with respect to supermolecular CCSD(T)

CAS
GVB
−2.71 −1.59
7.44
6.40
15.69

PBE0
0.86
7.09
4.72
17.24

6.22
5.89
12.08

2+(CCD) CCSD
−1.78
3.57
3.22
7.96

−7.91
5.48
8.74
16.46

less, the observed eﬀect is small and relatively
large errors compared to fully correlated SAPT
schemes persist. This is best exempliﬁed by
ﬁrst-order energies which probe the quality of
the monomers density (E(1)
elst) and density ma-
trices (E(1)
exch). In the second order the accuracy
of SAPT(MC) is aﬀected both by the missing
intramonomer correlation and approximations
in the ERPA response equations (see also dis-
cussion in Refs. 52 and 53). For the TK21
dataset we observed that both SAPT(GVB)
and SAPT(CAS) tend to underestimate second-
order contributions which leads to a fortuitous
error cancellation in the total interaction en-
ergy. When both TK21 and A24 datasets
are considered (Table S24), SAPT(MC) pre-
dicts interaction energies with mean absolute
errors and standard deviation below 8% and
10% , respectively, which is signiﬁcantly bet-
ter than Hartree-Fock based SAPT (∆abs ≤
18% and σ ≤ 20%) and comparable to the
SAPT2+(CCD) model (∆abs ≤ 10% and σ ≤
10%).

reference. To this end, we approximate higher-
order induction eﬀects with the δHF term,
Eq. (61).
As expected, SAPT(CCSD) is
the front runner (∆abs = 3.2%) followed by
SAPT(DFT) with mean absolute error of 4.7%
(lower section of Table 2). Both SAPT(GVB)
and SAPT(CAS) are less accurate—the ∆abs
value for the former reaches 5.9%, while for
the latter it amounts to 6.4%. Still, the multi-
conﬁgurational SAPT variants outperform not
only the Hartree-Fock-based scheme (∆abs =
11.3%), but also the SAPT2 model with the
CCD+ST(CCD) dispersion (∆abs = 8.7%).
The relatively large errors of SAPT2+(CCD)
can be traced to poor representation of the
second-order exchange components. Recall that
the presented SAPT results neglect exchange
eﬀects beyond the S2 approximation which
is expected to worsen the agreement between
SAPT and CCSD(T) interaction energies.

To summarize, the examined SAPT(GVB)
and SAPT(CAS) methods beneﬁt from a par-
tial recovery of the intramonomer correlation
eﬀects by the underlying multiconﬁgurational
wave function, as evidenced by a systematic
improvement of all energy components with
respect to the SAPT(HF) results. Neverthe-

20

5 Conclusions

We have proposed a SAPT(MC) formalism ap-
plicable to dimers in which at least one of the
monomers warrants a multireference descrip-
tion.
In the approach the interaction energy
is expanded through the second-order terms in
the intermolecular interaction operator. For-
mulas for the exchange energy contributions
are given in the single-exchange approxima-
tion (the S2 approximation) and are valid for
ground and nondegenerate excited states of the
monomers in spin singlet states. While singlet
states require spin-free reduced density matri-
ces, extension to higher spin states is straight-
forward and involves spin-resolved components
of RDMs. Response properties which enter the
density-matrix-based SAPT formulas are ob-
tained by solving the extended random phase
approximation (ERPA) eigenproblems for each
subsystem. Combined with ERPA equations,
the presented variant of SAPT requires access
only to one- and two-electron reduced density
matrices of the monomers. Note that, contrary
to the supermolecular method,
in SAPT the
dimer wave function is never computed which is
advantageous for multiconﬁgurational systems.
In this work we applied SAPT(MC) either with
CASSCF or GVB wave functions.

Based on the model H2· · · H2 dimer in which
one of the monomers undergoes dissociation,
we have veriﬁed that SAPT(MC) is capable of
describing interactions in systems dominated
by nondynamic correlation. The interaction
energy curve from SAPT(GVB) calculations
has the correct shape and the largest devia-
tion from the FCI benchmark does not exceed
13%. In the H2· · · H2 dimer several active or-
bitals are suﬃcient to recover both intra- and
intermonomer correlation eﬀects. SAPT(CAS),
with only 5 active orbitals per monomer, pre-
dicts total interaction energy as well as indi-
vidual energy contributions with errors below
3% with respect to the FCI results.
In con-
trast, SAPT schemes based on single-reference
description of the monomers, SAPT(HF) and
SAPT(DFT), fail dramatically when entering
the strongly-correlated regime.

The proposed multiconﬁgurational SAPT

method is the only one among the existing
SAPT approaches that oﬀers the analysis of
noncovalent interactions in systems involv-
ing electronically excited molecules in singlet
states.
In this work we examined the role
of negative transitions in the linear response
function of an excited subsystem in the de-
scription of the second order components of
SAPT. In Section 2.2.3 a general protocol for
direct evaluation of negative-transition terms
has been proposed and its implementation in
the ERPA-approximation framework has been
presented. As an example of an excited-state
complex, we have selected the C2H4· · · Ar dimer
and described it with a small CAS wave func-
tion. While for the ground state of the system
SAPT(CAS) remains in excellent agreement
with supermolecular CCSD(T) results, the ex-
cited π → π∗ state of ethylene poses a signif-
icant challenge. First, we have demonstrated
that second-order energy contributions related
to negative excitation energies are sizeable and
must be accounted for in SAPT. Second, even
for the low-lying valence state of ethylene the
lack of higher-order induction terms and restric-
tion to the S2 approximation signiﬁcantly limit
the accuracy of SAPT(CAS) results. To illus-
trate this, we have presented interaction energy
curves obtained in a hybrid approach which re-
covers induction terms up to inﬁnite order in
ˆV .
Indeed, a combination of supermolecular
CASSCF and second-order dispersion energy
from SAPT(CAS) calculations, which we refer
to as the CAS+DISP approach, 104 outperforms
SAPT for the π → π∗ state, and remains in
excellent agreement with the coupled-cluster
reference.

The CAS+DISP hybrid can be viewed as
SAPT(CAS) supplemented with a CASSCF
analogue of the δHF term, i.e., the δCAS correc-
tion. These two methods become equivalent if
the δCAS term is computed from formula simi-
lar to Eq. (61) with CAS supermolecular energy
and SAPT(CAS) energy components. While
there is no advantage of SAPT(CAS)+δCAS
procedure over CAS+DISP when both employ
the same CAS wave functions, using CAS func-
tions of diﬀerent levels could be beneﬁcial. Such
an approach would employ CAS in the mini-

21

mal active space to evaluate the δCAS term and
higher level CAS for description of monomers in
SAPT(CAS). Similar to δHF correction, 116–118
addition of δCAS would be recommended not
only for excited-state complexes but also for
ground state polar systems.

To better characterize the performance of
SAPT(MC) for many-electron systems, we
compared diﬀerent SAPT schemes against a
standard single-reference data set of nonco-
valently bound dimers. The individual en-
ergy components from both SAPT(GVB) and
SAPT(CAS) calculations are more accurate
than their SAPT(HF) counterparts. This holds
also for total
interaction energies, where we
observe a partial error cancellation between
polarization and exchange terms in the sec-
ond order. The correlated SAPT schemes in-
cluded in the comparison, i.e., SAPT(DFT) and
SAPT2+(CCD), are systematically better than
our multiconﬁgurational SAPT which should be
attributed to two factors. One is that ERPA-
based SAPT misses the majority of dynamical
correlation within the monomers as a result of
employing GVB or CAS wave functions with
small active spaces. Second is the quality of re-
sponse properties (exitation energies and tran-
sition density matrices) from ERPA equations.
Unlike the full linear response (LR-MCSCF, 119
equivalent to MCRPA 120), ERPA includes re-
sponse of the orbitals only.

The proposed formulation of multirefer-
ence SAPT can be applied with wave func-
tion methods capable of handling large active
spaces, such as density-matrix renormalization
group (DMRG), 121,122 generalized active space
(GAS) 123,124 or v2RDM-driven CAS. 125 An ef-
ﬁcient alternative is oﬀered by range-separated
multiconﬁgurational DFT. 126,127

Without additional approximations SAPT(MC)

scales with the sixth power of the molecu-
lar size. The computational bottlenecks are
the solution of the full ERPA eigenproblem
and evaluation of the exchange-dispersion en-
ergy formula, 53 both involving steps with a
n3
OCCn3
SEC cost, where nOCC = Ms1 + Ms2 and
nSEC = Ms2 + Ms3.

A feasible path to reduce the scaling and in-
crease the eﬃciency of the method with no

22

damage to the accuracy involves density ﬁt-
ting or Cholesky decomposition techniques rou-
tinely applied in single-reference SAPT ap-
proaches. 81,85,97,128–131

Acknowledgement The authors would like
to thank Grzegorz Chałasiński for helpful dis-
cussions and commenting on the manuscript.
K. P. and M. H. were supported by the Na-
tional Science Centre of Poland under Grant
No. 2016/23/B/ST4/02848.

References

(1) Balakrishnan, N. Perspective: Ultracold
molecules and the dawn of cold controlled
chemistry. J. Chem. Phys. 2016, 145,
150901.

(2) Dulieu, O., Osterwalder, A., Eds. Cold
Chemistry; Theoretical and Computa-
tional Chemistry Series; The Royal So-
ciety of Chemistry, 2018; pp P001–670.

(3) Pawlak, M.;

P.

Żuchowski,

S.;
Jankowski, P. Kinetic Isotope Eﬀect
in Low-Energy Collisions between Hy-
drogen Isotopologues and Metastable
Helium Atoms: Theoretical Calculations
Including the Vibrational Excitation of
the Molecule. J. Chem. Theory Comput.
2021, 17, 1008–1016.

(4) Řezáč, J.; Hobza, P. Benchmark Calcula-
tions of Interaction Energies in Noncova-
lent Complexes and Their Applications.
Chem. Rev. 2016, 116, 5038–5071.

(5) Patkowski, K. In Chapter One - Bench-
mark Databases of Intermolecular Inter-
action Energies: Design, Construction,
and Signiﬁcance; Dixon, D. A., Ed.;
Annu. Rep. Comput. Chem.; Elsevier,
2017; Vol. 13; pp 3–91.

(6) Patkowski,

K.;

Cencek, W.;
Jankowski, P.; Szalewicz, K.; Mehl, J. B.;
Garberoglio, G.; Harvey, A. H. Potential
energy surface for interactions between
two hydrogen molecules. J. Chem. Phys.
2008, 129, 094304.

(7) Jankowski, P.; McKellar, A.;

Sza-
lewicz, K. Theory untangles the high-
resolution infrared spectrum of the ortho-
H2-CO van der Waals complex. Science
2012, 336, 1147–1150.

(15) Szalewicz, K.; Bukowski, R.; Jeziorski, B.
In Theory and Applications of Computa-
tional Chemistry; Dykstra, C. E., Frenk-
ing, G., Kim, K. S., Scuseria, G. E., Eds.;
Elsevier: Amsterdam, 2005; pp 919–962.

(8) Bakr, B. W.;

Smith, D. G. A.;
Patkowski, K. Highly accurate potential
energy surface for the He–H2 dimer. J.
Chem. Phys. 2013, 139, 144305.

(16) Szalewicz, K. Symmetry-adapted pertur-
bation theory of intermolecular forces.
Wiley Interdiscip. Rev.: Comput. Mol.
Sci. 2012, 2, 254–272.

(9) Thibault, F.;

Patkowski, K.;

Żu-
chowski, P. S.; Jóźwiak, H.; Ciuryło, R.;
Wcisło, P. Rovibrational line-shape pa-
rameters for H2 in He and new H2-He
potential energy surface. J. Quant. Spec-
trosc. Radiat. Transf. 2017, 202, 308–
320.

(10) Przybytek, M.; Cencek, W.; Jeziorski, B.;
Szalewicz, K. Pair Potential with Submil-
likelvin Uncertainties and Nonadiabatic
Treatment of the Halo State of the He-
lium Dimer. Phys. Rev. Lett. 2017, 119,
123401.

(11) Parrish, R. M.; Thompson, K. C.;
Martínez, T. J. Large-Scale Functional
Group Symmetry-Adapted Perturbation
Theory on Graphical Processing Units. J.
Chem. Theory Comput. 2018, 14, 1737–
1753.

(12) Szalewicz, K.; Jeziorski, B. Symmetry-
adapted double-perturbation analysis of
intramolecular correlation eﬀects in weak
intermolecular interactions. Mol. Phys.
1979, 38, 191–208.

(13) Jeziorski, B.; Moszynski, R.;

Sza-
lewicz, K. Perturbation theory approach
to intermolecular potential energy sur-
faces of van der Waals complexes. Chem.
Rev. 1994, 94, 1887–1930.

(14) Szalewicz,

K.;

Patkowski,

K.;
Jeziorski, B. In Intermolecular Forces
and Clusters II ; Wales, D. J., Ed.;
Springer Berlin Heidelberg:
Berlin,
Heidelberg, 2005; pp 43–117.

(17) Jansen, G. Symmetry-adapted perturba-
tion theory based on density functional
theory for noncovalent interactions. Wi-
ley Interdiscip. Rev.: Comput. Mol. Sci.
2014, 4, 127–144.

(18) Patkowski, K. Recent developments in
symmetry-adapted perturbation theory.
Wiley Interdiscip. Rev.: Comput. Mol.
Sci. 2020, 10, e1452.

(19) Werner, H.; Knowles, P. J. An eﬃ-
cient internally contracted multiconﬁg-
uration–reference conﬁguration interac-
tion method. J. Chem. Phys. 1988, 89,
5803–5814.

(20) Andersson, K.; Malmqvist, P. A.;
Roos, B. O.; Sadlej, A. J.; Wolinski, K.
Second-order perturbation theory with
a CASSCF reference function. J. Chem.
Phys. 1990, 94, 5483–5488.

(21) Angeli, C.; Cimiraglia, R.; Malrieu, J.-
P. n-electron valence state perturbation
theory: A spinless formulation and an
eﬃcient implementation of the strongly
contracted and of the partially con-
tracted variants. J. Chem. Phys. 2002,
117, 9138–9153.

(22) Langhoﬀ, S. R.; Davidson, E. R. Con-
ﬁguration interaction calculations on the
nitrogen molecule. Int. J. Quant. Chem.
1974, 8, 61–72.

(23) Pople,

J. A.;

Seeger, R.; Krish-
nan, R. Variational conﬁguration interac-
tion methods and comparison with per-
turbation theory. Int. J. Quant. Chem.
1977, 12, 149–163.

23

(24) van Dam, H. J. J.; van Lenthe, J. H.;
Ruttink, P. J. A. Exact size consistency
of multireference Møller–Plesset pertur-
bation theory. Int. J. Quant. Chem.
1999, 72, 549–558.

(25) Rintelman,

J. M.;

Adamovic,

I.;
Varganov, S.; Gordon, M. S. Mul-
tireference
second-order perturbation
theory: How size consistent is “almost
size consistent”. J. Chem. Phys. 2005,
122, 044105.

(26) Hirao, K. Multireference Møller-Plesset
method. Chem. Phys. Lett. 1992, 190,
374–380.

(27) Camacho,

C.;

Cimiraglia,

R.;
Witek, H. A. Multireference pertur-
bation theory can predict a false ground
state. Phys. Chem. Chem. Phys. 2010,
12, 5058–5060.

(28) Chang, S.-W.; Witek, H. A. Choice of
Optimal Shift Parameter for the Intruder
State Removal Techniques in Multirefer-
ence Perturbation Theory. J. Chem. The-
ory Comput. 2012, 8, 4053–4061.

(29) Jeziorski, B. Multireference

coupled-
cluster Ansatz. Mol. Phys. 2010, 108,
3043–3054.

(30) Evangelista, F. A. Perspective: Multiref-
erence coupled cluster theories of dynam-
ical electron correlation. J. Chem. Phys.
2018, 149, 030901.

(31) Shen, J.; Piecuch, P. Biorthogonal mo-
ment expansions in coupled-cluster the-
ory: Review of key concepts and merg-
ing the renormalized and active-space
coupled-cluster methods. Chem. Phys.
2012, 401, 180–202, Recent advances in
electron correlation methods and appli-
cations.

(32) Shen, J.; Piecuch, P. Combining active-
space coupled-cluster methods with mo-
ment energy corrections via the CC(P;Q)

24

methodology, with benchmark calcula-
tions for biradical transition states. J.
Chem. Phys. 2012, 136, 144104.

(33) Chipman, D. M. Stretching of hydrogen-
bonded OH in the lowest singlet excited
electronic state of water dimer. J. Chem.
Phys. 2006, 124, 044305.

Interactions

(34) Pastorczak, E.; Shen, J.; Hapka, M.;
Piecuch, P.; Pernal, K. Intricacies of
van der Waals
in Sys-
tems with Elongated Bonds Revealed by
Electron-Groups Embedding and High-
Level Coupled-Cluster Approaches. J.
Chem. Theory Comput. 2017, 13, 5404–
5419.

(35) Pastorczak, E.; Jensen, H. J. A.; Kowal-
ski, P. H.; Pernal, K. Generalized Va-
lence Bond Perfect-Pairing Made Versa-
tile Through Electron-Pairs Embedding.
J. Chem. Theory Comput. 2019, 15,
4430–4439.

(36) Pastorczak, E.; Pernal, K. Molecular in-
teractions in electron-groups embedding
generalized valence bond picture. Theor.
Chem. Acc. 2018, 137, 1–10.

(37) Stoll, H.; Savin, A. In Density Func-
tional Methods in Physics; Dreizler, R.,
da Providencia, J., Eds.; Plenum, New
York, 1985; pp 177–207.

(38) Savin, A. In Recent Developments of
Modern Density Functional Theory;
Seminario, J. M., Ed.; Elsevier: Amster-
dam, 1996; pp 327–357.

(39) Fromager, E.; Cimiraglia, R.; Jensen, H.
J. A. Merging multireference perturba-
tion and density-functional theories by
means of range separation: Potential
curves for Be2, Mg2, and Ca2. Phys. Rev.
A 2010, 81, 024502.

(40) Hapka,

M.;

Pastorczak,

E.;
Krzemińska, A.; Pernal, K. Long-
range-corrected
multiconﬁguration
density functional with the on-top pair

density. J. Chem. Phys. 2020, 152,
094102.

(41) Stein, C. J.; Reiher, M. Semiclassical Dis-
persion Corrections Eﬃciently Improve
Multiconﬁgurational Theory with Short-
Range Density-Functional Dynamic Cor-
relation. J. Phys. Chem. A 2020, 124,
2834–2841.

Joubert,

(42) Andrés, J.; Ayers, P. W.; Boto, R. A.;
Carbó-Dorca, R.;
Chermette, H.;
Cioslowski, J.; Contreras-García, J.;
Cooper, D. L.; Frenking, G.; Gatti, C.;
Heidar-Zadeh,
L.;
F.;
Martín Pendás, Á.; Matito, E.; Mayer, I.;
Misquitta, A. J.; Mo, Y.; Pilmé, J.;
Popelier, P. L. A.; Rahm, M.; Ramos-
Cordoba, E.; Salvador, P.; Schwarz, W.
H. E.; Shahbazian, S.; Silvi, B.; Solà, M.;
Szalewicz, K.; Tognetti, V.; Wein-
hold, F.; Zins, E.-L. Nine questions on
energy decomposition analysis. J. Comp.
Chem. 2019, 40, 2248–2283.

(43) Raghavachari, K.; Trucks, G. W.;
Pople, J. A.; Head-Gordon, M. A ﬁfth-
order perturbation comparison of elec-
tron correlation theories. Chem. Phys.
Lett. 1989, 157, 479–483.

(44) Bartlett, R. J.; Watts, J.; Kucharski, S.;
Noga, J. Non-iterative ﬁfth-order triple
and quadruple excitation energy correc-
tions in correlated methods. Chem. Phys.
Lett. 1990, 165, 513–522.

(45) Korona, T.;

Jeziorski, B.; Moszyn-
ski, R.; Diercksen, G. H. F. Degener-
ate symmetry-adapted perturbation the-
ory of weak interactions between closed-
and open-shell monomers: application to
Rydberg states of helium hydride. Theor.
Chem. Acc. 1999, 101, 282–291.

(46) Patkowski, K.; Korona, T.; Jeziorski, B.
Convergence behavior of the symmetry-
adapted perturbation theory for states
submerged in Pauli forbidden continuum.
J. Chem. Phys. 2001, 115, 1137–1152.

(47) Patkowski, K.;

Jeziorski, B.;

Sza-
lewicz, K. Uniﬁed treatment of chem-
forces via
ical and van der Waals
symmetry-adapted perturbation expan-
sion. J. Chem. Phys. 2004, 120, 6849–
6862.

(48) Przybytek, M.;

Patkowski,

K.;
behavior
Jeziorski, B. Convergence
of
perturbation
symmetry-adapted
expansions for excited states. A model
study of interactions involving a triplet
helium atom. Collect. Czech. Chem.
Commun. 2004, 69, 141–176.

(49) Reinhardt, P. A possible valence-bond
approach to symmetry-adapted pertur-
bation theory. Comput. Theor. Chem.
2017, 1116, 174 – 183, Understanding
Chemistry and Biochemistry Using Com-
putational Valence Bond Theory.

(50) Patkowski, K.;

Żuchowski, P.

S.;
Smith, D. G. A. First-order symmetry-
adapted perturbation theory for multi-
plet splittings. J. Chem. Phys. 2018,
148, 164110.

(51) Waldrop, J. M.; Patkowski, K. Spin
splittings
symmetry-
from ﬁrst-order
adapted perturbation theory without
single-exchange approximation. J. Chem.
Phys. 2019, 150, 074109.

(52) Hapka, M.;

Przybytek, M.;

Per-
nal, K. Second-Order Dispersion Energy
Based on Multireference Description of
Monomers. J. Chem. Theory Comput.
2019, 15, 1016–1027.

(53) Hapka, M.; Przybytek, M.; Pernal, K.
Second-Order Exchange-Dispersion En-
ergy Based on a Multireference Descrip-
tion of Monomers. J. Chem. Theory
Comput. 2019, 15, 6712–6723.

(54) Chatterjee, K.; Pernal, K. Excitation en-
ergies from extended random phase ap-
proximation employed with approximate
one- and two-electron reduced density
matrices. J. Chem. Phys. 2012, 137,
204109.

25

(55) Pernal, K.; Chatterjee, K.; Kowal-
ski, P. H. How accurate is the strongly or-
thogonal geminal theory in predicting ex-
citation energies? Comparison of the ex-
tended random phase approximation and
the linear response theory approaches. J.
Chem. Phys. 2014, 140, 014101.

(56) Murrell, J. N.; Randić, M.; Williams, D.
The theory of intermolecular forces in the
region of small orbital overlap. Proc. Roy.
Soc. A. 1965, 284, 566–581.

(57) Jeziorski,

Szalewicz,

Symmetry

K.;
B.;
Chałasiński, G.
forcing
and convergence properties of perturba-
tion expansions for molecular interaction
energies. Int. J. Quant. Chem. 1978, 14,
271–287.

(58) Jeziorski, B.; Bulski, M.; Piela, L. First-
the
Order perturbation treatment of
short-range repulsion in a system of
many closed-shell atoms or molecules.
Int. J. Quant. Chem. 1976, 10, 281–297.

(59) Heßelmann, A.; Jansen, G. First-order
intermolecular interaction energies from
Kohn-Sham orbitals. Chem. Phys. Lett.
2002, 357, 464 – 470.

(60) Misquitta, A. J.; Szalewicz, K. Inter-
molecular forces from asymptotically cor-
rected density functional description of
monomers. Chem. Phys. Lett. 2002, 357,
301 – 306.

(61) Bulski, M.; Chałasiński, G.; Jeziorski, B.
Many-orbital cluster expansion for the
exchange-repulsion energy in the inter-
action of closed-shell systems. Theor.
Chim. Acta 1979, 52, 93–101.

(62) Moszynski, R.; Jeziorski, B.; Rybak, S.;
Szalewicz, K.; Williams, H. L. Many-
body theory of exchange eﬀects in inter-
molecular interactions. Density matrix
approach and applications to He-F−, He-
HF, H2-HF, and Ar-H2 dimers. J. Chem.
Phys. 1994, 100, 5080–5092.

26

(63) Rowe, D.

J.

Equations-of-Motion
Method and the Extended Shell Model.
Rev. Mod. Phys. 1968, 40, 153–166.

(64) Pastorczak, E.; Pernal, K. ERPA-APSG:
a
geminal-
computationally eﬃcient
based method for accurate description
of chemical systems. Phys. Chem. Chem.
Phys. 2015, 17, 8622–8626.

(65) Pastorczak, E.; Pernal, K. Correlation
Energy from the Adiabatic Connection
Formalism for Complete Active Space
Wave Functions. J. Chem. Theory Com-
put. 2018, 14, 3493–3503.

(66) Golab, J. T.; Yeager, D. L.; Jørgensen, P.
Proper characterization of MC SCF sta-
tionary points. Chem. Phys. 1983, 78,
175 – 199.

(67) Pernal, K. Intergeminal Correction to the
Antisymmetrized Product of Strongly
Orthogonal Geminals Derived from the
Extended Random Phase Approxima-
tion. J. Chem. Theory Comput. 2014,
10, 4332–4341.

(68) McWeeny, R. The density matrix in
many-electron quantum mechanics
I.
Generalized product functions. Factor-
ization and physical interpretation of the
density matrices. Proc. R. Soc. A 1959,
253, 242–259.

(69) Jaszunski, M.; McWeeny, R. Time-
dependent Hartree-Fock calculations of
dispersion energy. Mol. Phys. 1985, 55,
1275–1286.

(70) Drwal, D.; Pastorczak, E.; Pernal, K.
Excited states in the adiabatic connec-
tion ﬂuctuation-dissipation theory: Re-
covering missing correlation energy from
the negative part of the density response
spectrum. J. Phys. Chem. 2021, 154,
XXX.

(71) Chałasiński,

G.;

Jeziorski,

B.;
Andzelm, J.; Szalewicz, K. On the
multipole structure of exchange disper-
sion energy in the interaction of two

helium atoms. Mol. Phys. 1977, 33,
971–977.

bation theory. J. Chem. Phys. 2021, 154,
024103.

(72) Chałasiński, G.; Jeziorski, B. Exchange
polarization eﬀects in the interaction of
closed-shell systems. Theor. Chem. Acc.
1977, 46, 277–290.

(73) Rybak, S.; Jeziorski, B.; Szalewicz, K.
Many-body symmetry-adapted pertur-
bation theory of intermolecular interac-
tions. H2O and HF dimers. J. Chem.
Phys. 1991, 95, 6576–6601.

(74) Jeziorski,

B.;

Moszynski,

R.;
Ratkiewicz, A.; Rybak, S.; Szalewicz, K.;
Williams, H. L. SAPT: A program for
many-body symmetry-adapted perturba-
tion theory calculations of intermolecular
interaction energies. Methods and Tech-
niques
in Computational Chemistry:
METECC 1993, 94, 79.

(75) Korona, T. Second-order

of

energy

exchange-
intermolecular
induction
interactions from coupled cluster den-
sity matrices
cumulants.
Phys. Chem. Chem. Phys. 2008, 10,
6509–6519.

and their

(76) Korona, T. Exchange-Dispersion Energy:
A Formulation in Terms of Monomer
Properties and Coupled Cluster Treat-
ment of Intramonomer Correlation. J.
Chem. Theory Comput. 2009, 5, 2663–
2678.

(77) Schäﬀer, R.; Jansen, G. Intermolecu-
lar exchange-induction energies without
overlap expansion. Theor. Chem. Acc.
2012, 131, 1235.

(78) Schäﬀer, R.;

Jansen, G.

Single-
symmetry-adapted
determinant-based
perturbation theory without
single-
exchange approximation. Mol. Phys.
2013, 111, 2570–2584.

(79) Waldrop, J. M.; Patkowski, K. Nonap-
proximated third-order exchange induc-
tion energy in symmetry-adapted pertur-

27

(80) Jaszuński, M. Coupled Hartree-Fock cal-
culation of the induction energy. Mol.
Phys. 1980, 39, 777–780.

(81) Hohenstein, E. G.; Sherrill, C. D. Density
ﬁtting and Cholesky decomposition ap-
proximations in symmetry-adapted per-
Implementation and
turbation theory:
application to probe the nature of π − π
interactions in linear acenes. J. Chem.
Phys. 2010, 132, 184111.

(82) Parker, T. M.; Burns, L. A.; Par-
rish, R. M.; Ryno, A. G.; Sherrill, C. D.
Levels of symmetry adapted perturba-
tion theory (SAPT). I. Eﬃciency and
performance for interaction energies. J.
Chem. Phys. 2014, 140, 094106.

(83) Heßelmann, A.; Jansen, G. Intermolec-
ular induction and exchange-induction
energies from coupled-perturbed Kohn-
Sham density functional theory. Chem.
Phys. Lett. 2002, 362, 319 – 325.

(84) Heßelmann, A.; Jansen, G. Intermolec-
from time-
ular dispersion energies
dependent density functional
theory.
Chem. Phys. Lett. 2003, 367, 778 – 784.

(85) Misquitta, A. J.; Jeziorski, B.; Sza-
lewicz, K. Dispersion Energy from
Density-Functional Theory Description
of Monomers. Phys. Rev. Lett. 2003, 91,
033201.

(86) Korona, T.; Jeziorski, B. Dispersion en-
ergy from density-ﬁtted density suscep-
tibilities of singles and doubles coupled
cluster theory. J. Chem. Phys. 2008,
128, 144107.

(87) Werner, H.-J.; Knowles, P. J.; Knizia, G.;
Manby, F. R.; Schütz, M. Molpro: a
general-purpose quantum chemistry pro-
gram package. Wiley Interdiscip. Rev.:
Comput. Mol. Sci. 2012, 2, 242–253.

Ligabue, A.;

(88) Aidas, K.; Angeli, C.; Bak, K. L.;
Bakken, V.; Bast, R.; Boman, L.; Chris-
tiansen, O.; Cimiraglia, R.; Coriani, S.;
Dahle, P.; Dalskov, E. K.; Ekström, U.;
Enevoldsen, T.; Eriksen, J. J.; Etten-
huber, P.; Fernández, B.; Ferrighi, L.;
Fliegl, H.; Frediani, L.; Hald, K.;
Halkier, A.; Hättig, C.; Heiberg, H.; Hel-
gaker, T.; Hennum, A. C.; Hettema, H.;
Hjertenæs, E.; Høst, S.; Høyvik, I.-M.;
Iozzi, M. F.; Jansík, B.; Jensen, H.
J. A.; Jonsson, D.; Jørgensen, P.; Kauc-
zor, J.; Kirpekar, S.; Kjærgaard, T.;
Klopper, W.; Knecht, S.; Kobayashi, R.;
Koch, H.; Kongsted, J.; Krapp, A.;
Kristensen, K.;
Lut-
næs, O. B.; Melo, J. I.; Mikkelsen, K. V.;
Myhre, R. H.; Neiss, C.; Nielsen, C. B.;
Norman, P.; Olsen, J.; Olsen, J. M. H.;
Osted, A.; Packer, M. J.; Pawlowski, F.;
Pedersen, T. B.; Provasi, P. F.; Reine, S.;
Rinkevicius, Z.; Ruden, T. A.; Ruud, K.;
Rybkin, V. V.; Sałek, P.; Samson, C.
C. M.; de Merás, A. S.; Saue, T.;
Sauer, S. P. A.; Schimmelpfennig, B.;
Sneskov, K.; Steindal, A. H.; Sylvester-
Hvid, K. O.; Taylor, P. R.; Teale, A. M.;
Tellgren, E. I.; Tew, D. P.; Thorvald-
sen, A. J.; Thøgersen, L.; Vahtras, O.;
Watson, M. A.; Wilson, D. J. D.; Zi-
olkowski, M.; Ågren, H. The Dalton
quantum chemistry program system. Wi-
ley Interdiscip. Rev.: Comput. Mol. Sci.
2013, 4, 269–284.

(89) Korona, T.; Moszynski, R.; Jeziorski, B.
In Convergence of Symmetry-Adapted
Perturbation Theory for the Interac-
tion between Helium Atoms and be-
tween a Hydrogen Molecule and a He-
lium Atom; Löwdin, P.-O., Sabin, J. R.,
Zerner, M. C., Karwowski, J., Karel-
son, M., Eds.; Adv. Quantum Chem.;
Academic Press, 1997; Vol. 28; pp 171
– 188.

(90) Dunning Jr, T. H. Gaussian basis sets for
use in correlated molecular calculations.
I. The atoms boron through neon and hy-

28

drogen. J. Chem. Phys. 1989, 90, 1007–
1023.

(91) Kendall, R. A.; Dunning Jr, T. H.; Har-
rison, R. J. Electron aﬃnities of the ﬁrst-
row atoms revisited. Systematic basis
sets and wave functions. J. Chem. Phys.
1992, 96, 6796–6806.

(92) Korona, T. A coupled cluster treat-
ment of intramonomer electron correla-
tion within symmetry-adapted perturba-
tion theory: benchmark calculations and
a comparison with a density-functional
theory description. Mol. Phys. 2013,
111, 3705–3715.

(93) Perdew, J. P.; Burke, K.; Ernzer-
hof, M. Generalized gradient approxima-
tion made simple. Phys. Rev. Lett. 1996,
77, 3865.

(94) Adamo, C.; Barone, V. Toward reliable
density functional methods without ad-
justable parameters: The PBE0 model.
J. Chem. Phys. 1999, 110, 6158–6170.

(95) Grüning, M.; Gritsenko, O. V.; van Gis-
bergen, S. J. A.; Baerends, E. J. Shape
corrections to exchange-correlation po-
tentials by gradient-regulated seamless
connection of model potentials for inner
and outer region. J. Chem. Phys. 2001,
114, 652–660.

Simmonett, A. C.;

(96) Parrish, R. M.; Burns, L. A.; Smith, D.
G. A.;
De-
Prince, A. E.; Hohenstein, E. G.;
Bozkaya, U.; Sokolov, A. Y.; Di Remi-
gio, R.; Richard, R. M.; Gonthier, J. F.;
James, A. M.; McAlexander, H. R.;
Kumar, A.; Saitow, M.; Wang, X.;
Pritchard, B. P.; Verma, P.; Schae-
fer, H. F.; Patkowski, K.; King, R. A.;
Valeev, E. F.; Evangelista, F. A.;
Turney, J. M.; Crawford, T. D.; Sher-
rill, C. D. Psi4 1.1: An Open-Source
Electronic Structure Program Empha-
sizing Automation, Advanced Libraries,
and Interoperability. J. Chem. Theory
Comput. 2017, 13, 3185–3197.

(97) Hohenstein, E. G.; Sherrill, C. D. Den-
sity ﬁtting of intramonomer correlation
eﬀects in symmetry-adapted perturba-
tion theory. J. Chem. Phys. 2010, 133,
014101.

(104) Hapka, M.; Krzemińska, A.; Pernal, K.
How Much Dispersion Energy Is Included
in the Multiconﬁgurational Interaction
Energy?
J. Chem. Theory Comput.
2020, 16, 6280–6293.

(98) Williams, H. L.; Szalewicz, K.; Moszyn-
ski, R.; Jeziorski, B. Dispersion energy
in the coupled pair approximation with
noniterative inclusion of single and triple
excitations. J. Chem. Phys. 1995, 103,
4586–4599.

(105) Řezáč, J.; Hobza, P. Describing Nonco-
valent Interactions beyond the Common
Approximations: How Accurate Is the
“Gold Standard,” CCSD(T) at the Com-
plete Basis Set Limit? J. Chem. Theory
Comput. 2013, 9, 2151–2155.

(99) Parrish, R. M.; Hohenstein, E. G.;
Sherrill, C. D. Tractability gains
in
symmetry-adapted perturbation theory
including coupled double excitations:
CCD+ST(CCD) dispersion with natu-
ral orbital truncations. J. Chem. Phys.
2013, 139, 174102.

(100) Boys, S.; Bernardi, F. The calculation of
small molecular interactions by the dif-
ferences of separate total energies. Some
procedures with reduced errors. Mol.
Phys. 1970, 19, 553–566.

(101) Jeziorska, M.; Jeziorski, B.; Čížek, J. Di-
the Hartree-Fock
rect calculation of
interaction
exchange-
energy
perturbation expansion. The He-He
interaction. Int. J. Quant. Chem. 1987,
32, 149–164.

via

(102) Moszynski, R.; Heijmen, T.; Jeziorski, B.
Symmetry-adapted perturbation theory
for the calculation of Hartree-Fock in-
teraction energies. Mol. Phys. 1996, 88,
741–758.

(103) Taylor, D. E.; Ángyán, J. G.; Galli, G.;
Zhang, C.; Gygi, F.; Hirao, K.;
Song, J. W.; Rahul, K.; Anatole von
Lilienfeld, O.; Podeszwa, R.; Bu-
lik, I. W.; Henderson, T. M.; Scuse-
ria, G. E.; Toulouse, J.; Peverati, R.;
Truhlar, D. G.; Szalewicz, K. Blind test
of density-functional-based methods on
intermolecular interaction energies. J.
Chem. Phys. 2016, 145, 124105.

(106) Brzęk, F.; Boguslawski, K.; Tecmer, P.;
Żuchowski, P. S. Benchmarking the ac-
curacy of
seniority-zero wavefunction
methods for non-covalent interactions. J.
Chem. Theory Comput. 2019, 15, 4021–
4035.

(107) Korona, T.; Jeziorski, B. One-electron
properties and electrostatic interaction
energies from the expectation value ex-
pression and wave function of singles and
doubles coupled cluster theory. J. Chem.
Phys. 2006, 125, 184109.

(108) Korona, T.; Przybytek, M.; Jeziorski, B.
Time-independent coupled cluster the-
ory of the polarization propagator. Im-
plementation and application of the sin-
gles and doubles model to dynamic polar-
izabilities and van der Waals constants.
Mol. Phys. 2006, 104, 2303–2316.

(109) Briggs, E. A.; Besley, N. A. Modelling ex-
cited states of weakly bound complexes
with density functional theory. Phys.
Chem. Chem. Phys. 2014, 16, 14455–
14462.

(110) Ikabata, Y.; Nakai, H. Extension of
response dispersion method to
local
excited-state calculation based on time-
dependent density functional theory. J.
Chem. Phys. 2012, 137, 124106.

(111) Monkhorst, H. J. Calculation of proper-
ties with the coupled-cluster method. Int.
J. Quant. Chem. 1977, 12, 421–432.

29

(112) Dyall, K. G. The choice of a zeroth-order
Hamiltonian for second-order perturba-
tion theory with a complete active space
self-consistent-ﬁeld reference function. J.
Chem. Phys. 1995, 102, 4909.

(113) Rosta, E.; Surján, P. R. Two-body ze-
roth order Hamiltonians in multirefer-
ence perturbation theory: The APSG
reference state. J. Chem. Phys. 2002,
116, 878–890.

(114) Pernal, K. Electron Correlation from the
Adiabatic Connection for Multireference
Wave Functions. Phys. Rev. Lett. 2018,
120, 013001.

(115) Korona, T. First-order exchange energy
of intermolecular interactions from cou-
pled cluster density matrices and their
cumulants. J. Chem. Phys. 2008, 128,
224104.

(116) Patkowski,

K.;

Szalewicz,

K.;
Jeziorski, B. Third-order interactions in
symmetry-adapted perturbation theory.
J. Chem. Phys. 2006, 125, 154107.

(117) Patkowski,

K.;

Szalewicz,

K.;
relaxation and
Jeziorski, B. Orbital
the
induction energy in
third-order
symmetry-adapted perturbation theory.
2010, 127, 211–221.

(118) Lao, K. U.; Schäﬀer, R.; Jansen, G.; Her-
bert, J. M. Accurate Description of In-
termolecular Interactions Involving Ions
Using Symmetry-Adapted Perturbation
Theory. J. Chem. Theory Comput. 2015,
11, 2473–2486.

(119) Olsen, J.; Jørgensen, P. Linear and non-
linear response functions for an exact
state and for an MCSCF state. J. Chem.
Phys. 1985, 82, 3235–3264.

(120) Oddershede, J.; Jørgensen, P.; Yea-
ger, D. L. Polarization propagator meth-
ods in atomic and molecular calculations.
Comput. Phys. Rep. 1984, 2, 33 – 92.

30

(121) Legeza, Ö.; Noack, R.; Sólyom, J.;
Tincani, L.
In Computational Many-
Particle Physics; Fehske, H., Schnei-
der, R., Weiße, A., Eds.; Springer Berlin
Heidelberg: Berlin, Heidelberg, 2008; pp
653–664.

(122) Chan, G. K.-L.; Sharma, S. The Density
Matrix Renormalization Group in Quan-
tum Chemistry. Ann. Rev. Phys. Chem.
2011, 62, 465–481.

(123) Olsen, J.; Roos, B. O.; Jørgensen, P.;
Jensen, H. J. A. Determinant based
conﬁguration interaction algorithms for
complete and restricted conﬁguration in-
teraction spaces. J. Chem. Phys. 1988,
89, 2185–2192.

(124) Ma, D.; Li Manni, G.; Gagliardi, L. The
generalized active space concept in multi-
conﬁgurational self-consistent ﬁeld meth-
ods. J. Chem. Phys. 2011, 135, 044128.

(125) Fosso-Tande, J.; Nascimento, D. R.;
III, A. E. D. Accuracy of two-particle
N-representability conditions for describ-
ing diﬀerent spin states and the singlet-
triplet gap in the linear acene series. Mol.
Phys. 2016, 114, 423–430.

(126) Savin, A.; Flad, H.-J. Density functionals
for the Yukawa electron-electron inter-
action. Int. J. Quant. Chem. 1995, 56,
327–332.

(127) Fromager, E.; Knecht, S.; Jensen, H.
time-
J.
dependent
theory
based on range separation. J. Chem.
Phys. 2013, 138, 084101.

A. Multi-conﬁguration
density-functional

(128) Heßelmann, A.; Jansen, G.; Schütz, M.
theory-symmetry-
Density-functional
adapted
perturbation
theory with density ﬁtting: A new
eﬃcient method to study intermolecular
interaction energies. J. Chem. Phys.
2005, 122, 014103.

intermolecular

(129) Bukowski, R.; Podeszwa, R.;

Sza-
lewicz, K. Eﬃcient calculation of coupled

Kohn-Sham dynamic susceptibility func-
tions and dispersion energies with den-
sity ﬁtting. Chem. Phys. Lett. 2005, 414,
111–116.

(130) Podeszwa, R.; Bukowski, R.;

Sza-
lewicz, K. Density-Fitting Method in
Symmetry-Adapted Perturbation The-
ory Based on Kohn-Sham Description of
Monomers. J. Chem. Theory Comput.
2006, 2, 400–412.

(131) Garcia, J.; Podeszwa, R.; Szalewicz, K.
inter-
SAPT codes for calculations of
molecular interaction energies. J. Chem.
Phys. 2020, 152, 184109.

31

