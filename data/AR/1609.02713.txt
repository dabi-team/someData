6
1
0
2

p
e
S
9

]

R
S
.
h
p
-
o
r
t
s
a
[

1
v
3
1
7
2
0
.
9
0
6
1
:
v
i
X
r
a

Investigating Energetic X-Shaped Flares on the

Outskirts of A Solar Active Region

Rui Liu1,2,∗, Jun Chen1, Yuming Wang1,3, Kai Liu1,4

1CAS Key Laboratory of Geospace Environment, Department of Geophysics and Planetary Sci-

ences,UniversityofScienceandTechnologyofChina,Hefei230026,China
2CollaborativeInnovationCenterofAstronauticalScienceandTechnology,Hefei230026,China
3SynergeticInnovationCenterofQuantumInformation&QuantumPhysics,UniversityofScience

andTechnologyofChina,Hefei230026,China
4Mengcheng National Geophysical Observatory, School of Earth and Space Sciences, University

ofScienceandTechnologyofChina,Hefei230026,China

Typical solar ﬂares display two quasi-parallel, bright ribbons on the chromosphere. In be-

tween is the polarity inversion line (PIL) separating concentrated magnetic ﬂuxes of opposite

polarity in active regions (ARs). Intriguingly a series of ﬂares exhibiting X-shaped ribbons

occurred at the similar location on the outskirts of NOAA AR 11967, where magnetic ﬂuxes

were scattered, yet three of them were alarmingly energetic. The X shape, whose center coin-

cided with hard X-ray emission, was similar in UV/EUV, which cannot be accommodated in

the standard ﬂare model. Mapping out magnetic connectivities in potential ﬁelds, we found

that the X morphology was dictated by the intersection of two quasi-separatrix layers, i.e., a

hyperbolic ﬂux tube (HFT), within which a separator connecting a double null was embed-

ded. This topology was not purely local but regulated by ﬂuxes and ﬂows over the whole AR.

The nonlinear force-free ﬁeld model suggested the formation of a current layer at the HFT,

where the current dissipation can be mapped to the X-shaped ribbons via ﬁeld-aligned heat

1

 
 
 
 
 
 
conduction. These results highlight the critical role of HFTs in 3D magnetic reconnection

and have important implications for astrophysical and laboratory plasmas.

Solar ﬂares are the most powerful events in the solar system. A large ﬂare can release ∼ 1032

erg of energy (the equivalent of over 20 million 100-megaton hydrogen bombs) in tens of min-

utes, emitting radiation across the entire electromagnetic spectrum and ejecting relativistic parti-

cles into interplanetary space, which may jeopardize space-borne and ground-based technological

systems [1]. It is well known that such an energy is gradually accumulated in the corona via emer-

gence of magnetic ﬂux through the photosphere and small- and large-scale convective motions in

the photospheric layers that shufﬂe around the footpoints of coronal magnetic ﬁeld lines [2]. These

processes feed magnetic energy and helicity into the solar atmosphere, the latter of which mea-

sures the twist and linkage of magnetic ﬁeld lines [3]. There is mounting observational evidence

supporting that magnetic reconnection is the key process in the sudden conversion of the accu-

mulated magnetic free energy into thermal and kinetic energies [4]. In particular, the morphology

and dynamics of ﬂare ribbons on the chromosphere, which are produced by ﬁeld-aligned acceler-

ated electrons and heat conduction, provide valuable diagnosis on the reconnection process in the

corona [5].

Magnetic reconnection tends to occur at the so-called structural skeletons [6,7] of magnetic

ﬁeld. Topological skeletons [8], where the ﬁeld-line mapping from one footpoint to another is dis-

continuous, include null points, where the magnetic ﬁeld vanishes, and separatrix surfaces, which

deﬁne the boundary of topologically distinct domains. Quasi-skeletons, where the ﬁeld-line map-

ping has a steep yet ﬁnite gradient, are also known as quasi-separatrix layers (QSLs) [9]. With

magnetic connectivity mapped out by the squashing factor Q, QSLs can be deﬁned as high-Q struc-

tures, whereas Q → ∞ at topological skeletons [10]. This indicates a close relation between QSLs

and topological skeletons, and a conversion between them under certain conditions is possible [11].

Two separatrix surfaces or QSLs may intersect at a separator or a quasi-separator, respectively. A

combination of two intersecting QSLs is termed as a hyperbolic ﬂux tube (HFT) [10], because of its

X-type cross section. Nulls, separators and HFTs are considered to be preferential locations for

the concentration of strong currents and the subsequent rapid dissipation [12–14]. Structural skele-

2

tons provide a robust and powerful tool to understand complex observations, and also a solid base

for the investigation on dynamics and energetics [8,15,16].

Major ﬂares almost always occur in the neighborhood of PILs separating strong magnetic

ﬁelds of opposite polarity in ARs. Only a small fraction of ﬂares occur in plages with only small or

no sunspot, which are often associated with ﬁlament eruptions [17–21] and hence fall into the category

of the classical “two-ribbon” ﬂares, with only a few exceptions in the literature [22]. Typically the

two ribbons are connected by ﬂare loops across the PIL, and move away from each other as the ﬂare

progresses. This can be well explained by the “standard” ﬂare model [23–26]. In this two-dimensional

model, a rising magnetic ﬂux rope above the PIL stretches the overlying ﬁeld lines, resulting in

a vertical current sheet underneath the rope, where magnetic reconnection occurs successively at

an increasingly higher altitude, as a positive feedback is established between the reconnection

and the rising of the rope. The two parallel ribbons hence correspond to the footpoints of newly

reconnected ﬁeld lines, because of the assumed symmetry along the PIL.

Recently, ﬂares exhibiting a circular ribbon have received a lot of attention [27–33]. These ﬂares

cannot be accommodated by the classical two-dimensional model, but can well ﬁt into the fan-spine

topology of a three-dimensional null point. The circular ribbon is interpreted as the intersection

of a dome-shaped separatrix surface, known as the fan surface of the null, with the chromosphere,

while the spine ﬁeld line threading the fan at the null may anchor at a central ribbon inside the

circular ribbon and a remote ribbon outside [27].

Here, we present the rare observations of a series of ﬂares exhibiting X-shaped ribbons (also

referred to hereafter as X-shaped ﬂares). These ﬂares did not occur in the neighborhood of internal

PILs, but repeatedly in the same place on the outskirts of the active region. However, three of

them were alarmingly energetic, ranked as M class. These observations demonstrate that even the

outskirts of solar active regions has the potential to produce high-level space weather events, and

the X-shaped ribbons highlight the three-dimensional nature of magnetic reconnection in ﬂares. As

the ﬂares occurred not far away from the solar disk center, the magnetic ﬁeld measurements were

reliable, providing a precious opportunity to study the magnetic topology as well as the evolution,

3

including creation and destruction, of the relevant structural skeletons.

Results

Instruments and Datasets

The ﬂares with X-shaped ribbons occurred in NOAA AR 11967, which was monitored by vector

magnetograms obtained by the Helioseismic and Magnetic Imager (HMI [34]) onboard the Solar Dy-

namics Observatory (SDO [35]). The vector magnetograms used in this study were disambiguated

and deprojected to the heliographic coordinates with a Lambert (cylindrical equal area; CEA) pro-
jection method, resulting in a pixel scale of 0.03◦ (or 0.36 Mm) [36]. Note that the Carrington system

was adopted so that the longitude of a solar feature remains approximately constant.

The ﬂares produced by AR 11967 were observed with the Atmospheric Imaging Assembly

(AIA [37]) onboard SDO. AIA includes seven EUV passbands, i.e., 131 ˚A (primarily Fe XXI for

ﬂare plasma, peak response temperature log T = 7.05; primarily Fe VIII for ARs, log T = 5.6 [38]),

94 ˚A (Fe XVIII, log T = 6.85), 335 ˚A (Fe XVI, log T = 6.45), 211 ˚A (Fe XIV, log T = 6.3),

193 ˚A (Fe XXIV for ﬂare plasma, log T = 7.25; Fe XII for ARs, log T = 6.2) and 171 ˚A (Fe IX,

log T = 5.85), 304 ˚A (He II, log T = 4.7), and two UV passbands, i.e., 1600 ˚A (C IV, log T = 5.0)

and 1700 ˚A (continuum). The instrument takes full-disk images with a spatial scale of 0.6 arcsec
pixel−1 and a cadence of 12 s for EUV and 24 s for UV passbands. Two of the ﬂares (Figure 1

and Supplementary Figure 1) were also observed in hard X-rays (HXRs) by the Reuven Ramaty

High-Energy Solar Spectroscopic Imager (RHESSI [39]).

It is well known that ﬂare emission in 1600 ˚A forms the ﬂare ribbons, or the feet of ﬂare
loops, since this passband is dominated by C IV line emission, an optically thin line formed at 105
K in the upper chromosphere and transition region. The 1700 ˚A passband is dominated by UV con-

tinuum emission formed at the temperature minimum region (4400–4700 K). Flare enhancement

4

in this passband reﬂects also footpoint emission, typically attributed to photoionization excited by

UV emission from above [40,41].

Flare Observation

Three ﬂares on 2014 February 2 (Figure 1, Supplementary Figures 1 and 2) were outliers among

the 11 major ﬂares (Table 1; M-class and above; marked by arrows in Figure 2(a)) that occurred in

AR 11967 from the beginning of 2014 January 31 till the end of February 5, when the AR crossed
the solar disk from about 45◦E to 45◦W. These three outliers (peak times marked by vertical lines

in Figure 2) had unique X-shape ribbons and occurred in a facular (or plage) region of AR 11967,

where the magnetic ﬁeld is typically weaker (∼ 100 G), concentrated in much smaller bundles
(∼ 1′′) than in sunspots (∼ 1000G; ∼ 100′′), while all the other non-X-shaped major ﬂares took

place near the internal PILs separating sunspots of opposite polarity (cf. Figure 3(b)). Here the X-

shaped major ﬂare (XMF) occurring at 18:11 UT (soft X-ray peak) is taken as an exemplary event

(Figure 1; Supplementary Movie 1), as the other two XMFs taking place at 08:20 and 09:31 UT

exhibited almost the same features (Supplementary Figures 1 and 2 and Supplementary Movies 6

and 7). Besides the three XMFs, there were many other weaker ﬂaring activities in this region, as

shown by the time series of 131 and 1600 ˚A emission (Figure 2(b)) integrated over a rectangular

region Ra (Figure 3(b)) centered on the XMFs, using co-registered AIA images at 5-min cadence,

as compared to the integrated 131 ˚A emission over the whole AR. Most of the X-shaped ﬂares in Ra

(marked by red solid arrows at the top of Figure 2(b)) occurred on February 2 and early February

3, while most of non-X-shaped ﬂares in Ra (black hollow arrows) happened before February 2

and after late February 4. One can also see that some of the non-X-shaped ﬂares did not cause

signiﬁcant response in 1600 ˚A, while for almost all the X-shaped ﬂares the 131 ˚A and 1600 ˚A

emission in Ra were highly correlated (Figure 2(b)). There were even weaker activities missing in

this approach, such as the event reported by Yang et al. [42], which exhibited an X morphology in

both Hα and EUV and was interpreted in terms of the classic X-type reconnection. All of these

X-shaped ﬂares or ﬂaring activities were conﬁned, without being associated with a coronal mass

5

ejection (CME) or a jet.

It is extraordinary that the ﬂare emission during the impulsive phase had a similar X shape

in AIA’s all 9 UV/EUV passbands (Figure 1). Usually the six EUV passbands excluding 304 ˚A

feature ﬂare loops in the corona, whereas 304, 1600 and 1700 ˚A passbands feature ﬂare ribbons

in the chromosphere. The observed X-shaped emission in EUV, however, must originate from

the feet of the ﬂare loops due to the similarity with UV ribbons.

It was recently noticed that

plasma in ﬂare ribbons can be heated to ∼ 10 MK during the early impulsive phase before ﬂare

loops are ﬁlled with evaporated chrompospheric plasma, which indicates intense heating of the

lower atmosphere [43–45]. The heating mechanism, however, is still under debate. In contrast to

UV/EUV emissions, the HXR emission is concentrated at the center of the X shape (Figure 1), for

both the thermal (6–15) and nonthermal (25–50 keV) energy ranges (see Supplementary Figure 3),

indicating the projected location where accelerated electrons were interacting with plasma. Two

weak, compact nonthermal HXR sources, as compared to the major source at the center of the X

shape, were co-located with the most intense UV/EUV patches along the northwestern arm of the

X shape. It is clear that this X morphology was not produced by a single classic X-type magnetic

reconnection, or reconnections between two crossing, current-carrying loops [46], either of which

would have produced four ﬂare kernels in UV and/or HXRs. Instead, we observed extended X-

shaped ﬂare ribbons in UV/EUV and a compact HXR source at the center of the X shape. The

analysis of photospheric magnetic ﬁelds will shed light on the nature of the reconnection.

Superimposing the contours of the line-of-sight (LOS) component of the photospheric mag-

netic ﬁeld onto the UV 1700 ˚A image, one can see that the adjacent endpoints of the X shape were

associated with opposite polarities (Figures 1; Supplementary Figures 1 and 2). These four ﬂux

concentrations are labeled P1-N1 and p-n. P1 and N1 were associated with two sunspots, whereas

p and n with sporadic patches of weak ﬁeld in the facular region (see also Figure 3(a)). A third

sunspot (labeled P2) was also involved, with the northwestern “arm” of the X shape extending to

the immediate neighborhood of P2.

6

Evolution of Active Region

Immediately prior to the three XMFs (07:58 UT), the AR was characterized by six major sunspots

(Figure 3(a)), four of them were associated with positive polarity (labeled P1–P4) and two (labeled

N1 and N2) with negative polarity. P2 and P4 decayed and became diffused by February 5, while
other sunspots were relatively stable. Figure 3(b–d) show the maps of photospheric ﬂows [km s−1],
helicity ﬂux density hm [Mx2 cm−2 s−1] and Poynting ﬂux density pm [erg cm−2 s−1], which are

averaged over a time interval of about 11 hrs covering the XMFs (see Methods). These maps

reveal a persistent evolutionary pattern starting in the late January 31 until the mid February 4 (see

Supplementary Movie 2), viz., a signiﬁcant ﬂux of negative polarity emerged to the east of P3,

and then migrated eastward into N1 (Figure 3(b)), forming a channel of negative magnetic ﬂuxes

(labeled Nc in Figure 3(a)) and also a channel of intense negative hm (Figure 3(c)) and positive

pm (Figure 3(d)) between N1 and P3 and to the south of P2. As they approached P1, the ﬂows

bifurcated, some were diverted northward, integrated with the moat ﬂows [47] of P1 and N1, into

the facular region where the three XMFs occurred (olive star symbols in Figure 3(b)), and others

were diverted southeastward along the PIL between P1 and N2. Of the 8 non-X-shaped major

ﬂares (see also Table 1), 5 occurred along Nc and 3 along the PIL between P1 and N2.

It is also remarkable that there was signiﬁcant ﬂux cancellation ongoing in the facular region

to the north of P1-N1, which might be driven by the moat ﬂows of P1 and N1 (see Supplementary

Movie 2). Positive and negative ﬂuxes integrated in an irregular region Rb (Figure 3(b)) are shown

in Figure 2(c). Rb was so selected as to avoid the sunspots P1, N1, and P2. The cancellation started

from the beginning of January 31 until mid February 3. After that it appeared to be dominated by

the emergence of positive ﬂuxes in Rb and the migration of negative ﬂuxes from N1 into Rb with

these ﬂux elements being detached from N1. Studies have argued for the association between ﬂux

cancellation and magnetic reconnection [48].

7

Magnetic Topology

To understand the magnetic connectivities in AR 11967, we performed the extrapolation of the

coronal potential ﬁeld on an hourly cadence from January 31 to February 5 (see Methods). Po-

tential ﬁeld maintains the basic topology although it can only be regarded as a zero-order approx-

imation of the real coronal ﬁeld. The robustness of structural skeletons has been demonstrated

by earlier studies employing various coronal ﬁeld models [15,16,49], and also in the present study by

switching on and off a “pre-processing” procedure on the photospheric boundary (see Methods).

However, current-carrying structures, e.g., twisted ﬂux tubes, cannot be recovered in the potential

ﬁeld, and the assumption adopted by the null-locating algorithm [50,51] (see also Methods), that the

magnetic ﬁeld approaches zero linearly toward nulls, might break down with the presence of strong

currents.

For each potential ﬁeld, we sought for magnetic null points within a box volume, whose

bottom was the rectangular region indicated in Figure 3(a). Most of the identiﬁed nulls were

located in the facular region to the north of P1 and N1 (see Methods and Supplementary Figures 4

and 5), and sometimes an interesting double-coronal-null conﬁguration was present, i.e., two nulls

were separated in heights but have similar X-Y positions. One can see from Figure 2(d) that double

nulls started to appear in late February 1, disappeared in early February 3, and reappeared in the

middle of February 4. It is noteworthy that most of the X-shaped ﬂares occurred when the double-

null conﬁguration was present and when there was signiﬁcant ﬂux cancellation in the facular region

of interest (Figure 2). Field lines traced in the neighborhood of the double null just prior to the

XMF at 18:11 UT on 2014 February 2 are shown in Figure 4(a, e and f) with fan (spine) ﬁeld lines

in magenta (blue). The upper null was located at Z = 20.08 Mm and the lower null at Z = 3.55

Mm (marked by green crosses in Figure 4(e and f)) .

We also calculated the squashing factor Q in the same box volume (see Methods). The

isosurfaces of log10 Q = 5 (Figure 5) consist of two major intersecting QSLs, labeled ‘S1’ and

‘S2’, whose footprints on the photosphere correspond to the high-Q lines in Figure 4(a and b).

8

The intersection of S1 and S2 is a quasi-separator by deﬁnition. It is well deﬁned immediately

above the lower null, as demonstrated by the X-shaped morphology in horizontal cutting planes

of log10 Q (Figure 4(c and d); see also Supplementary Movie 3), the characteristic of an HFT. The

center of X was visually determined and plotted as black dots in Figure 4(e and f), showing that

the two nulls are located along the quasi-separator. Viewing the QSLs from different perspectives

(Figure 5 and Supplementary Movie 4), one can see that the fan (spine) ﬁeld lines of the upper null,

partially visible through the isosurfaces, are embedded within S1 (S2), while the reverse is true for

the lower null. The fan plane of the upper null is hence bounded by the spine of the lower null

from below within S1, while the fan plane of the lower null is bounded by the spine of the upper

null from above within S2. The intersection of the two fan planes hence determines a separator

connecting the two nulls [52], which in our case is embedded within the quasi-separator. The quasi-

separator extends beyond the upper null, up to as high as about 60 Mm, inclining southward above

the upper null and northward below it (Figure 5(b and c) and Supplementary Movie 4). With or

without the nulls, the overall conﬁguration of the HFT remained almost the same as in Figure 5 (see

also Supplementary Figure 6) during the time period investigated, due presumably to the relatively

slow evolution of AR 11967 (see Supplementary Movie 2). Apparently, the recurrence of X-shaped

ﬂares in this region owed its origin to the relatively stable presence of this HFT.

The double null’s fans and spines yield an X shape, but its mismatch with the ﬂare ribbons is

not negligible (Figure 4(a)). In particular, the southwestern arm of the X shape is left unaccounted

for, as the upper null’s fan is bounded by the lower null’s spine from below. Hence, the double null

and the separator cannot be solely responsible for the observed ﬂare ribbons. On the other hand,

it was found that the X-shaped ribbons are better matched by high-Q lines on the photosphere

(Figure 4(a); see also Methods), which delineate the footprints of S1 and S2. The ﬂare ribbons are

hence suggested to be mainly energized by the magnetic reconnection at the HFT.

However, to produce the ﬂare, the conﬁguration must carry a substantial electric current. We

built a nonlinear force-free ﬁeld (NLFFF) with the “weighted optimization” method to model the

coronal ﬁeld [2,53]. The vector magnetogram at 17:58 UT was “pre-processed” [54] to minimize the

9

net force and torque in the observed photospheric ﬁeld before being taken as the boundary. By

obtaining the squashing factor Q for this NLFFF in the same box volume as above, we found that

the basic topology can still be interpreted as two intersecting QSLs, yet the intersection was no

longer a 3D curve as in the potential ﬁeld, but a very complex structure (Figure 6(d) and Supple-

mentary Movie 5), with the concentration of electric currents (Figure 6(c)), yet with no null being

identiﬁed numerically. However, the overall morphology of the intersection retains the X shape,

the basic characteristic of an HFT. We hence determined that the HFT in the NLFFF is equivalent

in topology to, but much more complex in geometry than, its counterpart in the potential ﬁeld. Its

footprints at the photosphere also compare favorably with the X-shaped ﬂare ribbons (Figure 6(a)),

which strengthens our conclusion that the ﬂare ribbons are closely associated with the HFT. Similar

results were found for the other two XMFs.

Discussion

A comparison with an idealized quadrupole ﬁeld consisting of two oppositely directed dipoles

with different magnitudes (see Methods) may shed light on the observed topology, which appeared

to involve mostly a local quadrupole ﬁeld as represented by P1-N1 and p-n. An HFT inclining

towards the weaker dipole was identiﬁed at the intersection of two high-Q surfaces in this idealized

quadrupole ﬁeld (Supplementary Figures 7–9). When the two dipoles are strictly anti-parallel, a

null line was found to be coincident with the HFT. Each point along the null line is associated

with two spines, whose footpoints collectively match the X-shaped footprint of the HFT. The HFT

persists while the null line perishes when the two dipoles are not perfectly anti-parallel. However,

the arms of this X shape diverge toward the stronger dipole and converge toward the weaker one,

and the strength of the two dipoles has to be comparable to yield a symmetric X shape. In contrast,

the observed ﬂare ribbons were more extended at the weak ﬁeld side p-n than at the strong side P1-

N1 (Figure 1 and Supplementary Figures 1 and 2). The separator in observation can be regarded as

a generalized form of the null line and did incline toward the weak ﬁeld as the null line, but above

10

the upper null, the quasi-separator inclined backwards toward the strong ﬁeld. This suggests that

the production of the X-shaped ﬂare ribbons was not just dictated by the local quadrupole ﬁeld, but

must be regulated by all the other ﬂux concentrations as well as photospheric ﬂows within the AR.

The above analysis converges to a self-consistent physical scenario: the ﬂux emergence and

ﬂows associated with the channel Nc energize the AR by injecting magnetic helicity and Poynting

ﬂuxes into the solar atmosphere, which results in the accumulation of magnetic free energy and

stress in the neighborhood of the internal PILs, as well as in the facular region of interest, above

which the HFT is probably pinched into a current layer, as suggested by the NLFFF model as well

as studies with a broad variety of photospheric motions applied to its feet [12–14]. When magnetic

reconnections occur at this current layer, the ﬁeld-aligned heat conduction channels out the energy

released at the HFT and produces the UV/EUV ﬂare ribbons residing at the high Q-lines that

delineate the HFT footprints. In contrast, the HXR emission was concentrated at the center of the X

shape, which suggests that most of the HXR-producing electrons were thermalized at the HFT, with

only a fraction of them leaking out to produce sporadic HXR emission at the ﬂare ribbons (Figure 1

and Supplementary Figures 1 and 3). How the electrons were accelerated and trapped at the HFT

is beyond the scope of this study, but certainly an important area to pursue for future research.

The homologousness of these X-shaped ﬂares can be attributed to the repetitive energization and

relaxation of the HFT, which proved to be persistent during the time period investigated. These

results provide insight into the nature of 3D magnetic reconnection in solar ﬂares, which could be

constructive in the efforts of ﬂare forecasting, and may also have important implications for other

astrophysical as well as laboratory plasmas.

11

Methods

Helicity and Poynting Flux

The ﬂow ﬁeld in Figure 3(b) was obtained by applying the Differential Afﬁne Velocity Estima-

tor for Vector Magnetograms (DAVE4VM) [55] to the time-series of deprojected, registered vector

magnetograms. The window size used in DAVE4VM was chosen to be 19 pixels, following Liu et

al. [56].

With the ﬂow ﬁeld, we were able to calculate the relative helicity ﬂux across its photospheric

boundary S with the following formula [3,56,57]:

dH
dt (cid:12)
S
(cid:12)
(cid:12)
(cid:12)

dP
dt (cid:12)
(cid:12)
(cid:12)
(cid:12)

= 2

ZS

(Ap · Bt)V⊥n dS − 2

(Ap · V⊥t)Bn dS,

ZS

(1)

where Ap is the vector potential of the reference potential ﬁeld Bp that shares the same Bz on

the photospheric boundary as the observation; t and n refer to the tangential and normal direc-
tions, respectively. V⊥ is the photospheric velocity perpendicular to magnetic ﬁeld lines, which is
obtained by subtracting the ﬁeld-aligned plasma ﬂow (V · B)B/B2 from the velocity derived by

DAVE4VM [57]. The two terms on the right hand side of Eq. 1 describe helicity injection due to
ﬂux emergence (V⊥n) and photospheric motions (V⊥t) that shear and braid ﬁeld lines, respectively.

Similarly, both ﬂux emergence and tangential motions contribute to the Poynting ﬂux across the

photospheric boundary [58],

1
4π ZS

=

S

B2

t V⊥n dS −

1
4π ZS

(Bt · V⊥t)Bn dS.

(2)

Here our error analysis follows Appendix B in Liu et al. [59]. The typical errors of helicity and
Poynting ﬂuxes are of order 1036 Mx2 s−1 and 1025 erg s−1, respectively, less than 1 part in 10. For

AR 11967 as a whole (Supplementary Figure 10), we found no signiﬁcant injection of magnetic
ﬂux [Mx], helicity ﬂux [Mx2 s−1], or Poynting ﬂux [erg s−1] during the time period of interest.

An injection of helicity and Poynting ﬂuxes started from the early February 5, but apparently it

was not related with any major ﬂares. On the other hand, examining the ﬂux density maps in

12

detail (Figure 3(c–d)), we found a signiﬁcant local injection of negative helicity ﬂux and positive

Poynting ﬂux, associated with the eastward ﬂows in the channel Nc.

Extrapolation of Coronal Potential Field

We calculated the potential ﬁeld with both the Fourier transformation [60] and the Green function

method. Both the original and a “pre-processed” Bz was adopted as the photospheric boundary of

the extrapolation. The aim of the pre-processing, as applied to the 2 × 2 rebinned Space-Weather

HMI Active Region Patches data, was to make the vector magnetograms best suit the force-free

condition [54].

The calculation was carried out within a box of 720 × 344 × 256 uniformly spaced grid

points, corresponding to 524.5 × 250.6 × 186.5 Mm, whose photospheric FOV spanned [86.6,

129.8] in Carrington longitudes, and [-23.4, -2.7] in latitudes. Magnetic ﬂux was roughly balanced

within the FOV, the ratio between positive and (absolute) negative ﬂux was 1.07 at the beginning

of January 31, increasing more or less monotonously toward 1.36 by the end of February 5. The

results shown in Figures 4 and 5 were given by the potential ﬁeld constructed with the Fourier

method and the pre-processed boundary. Other potential ﬁelds yielded very similar results as far

as magnetic topology is concerned (Supplementary Figures 4 and 5).

Map of Magnetic Connectivities

We investigated magnetic connectivities within the extrapolated ﬁeld by tracing ﬁeld lines point-

wise with a fourth-order Runge-Kutta method to ensure high precision. The mapped footpoints

of ﬁeld lines were used to calculate the squashing factor Q of elemental magnetic ﬂux tubes [10].
Basically, for a mapping through the two footpoints of a ﬁeld line Π12 : r1(x1, y1) 7→ r2(x2, y2),

13

the squashing factor Q associated with the ﬁeld line is [10]

Q ≡

a2 + b2 + c2 + d2
|det D|

,

where a, b, c, d are elements of the Jacobian matrix

D =

∂r2
∂r1 (cid:21)

(cid:20)

∂x2
∂x1
∂y2
∂x1

= 



∂x2
∂y1
∂y2
∂y1






a b

c d

≡ 



(3)

(4)



.



Quasi-separatrix layers (QSLs) as deﬁned by high-Q values are often complex three-dimensional

structures, hence their visualization can be facilitated by calculating Q in a 3D volume box. This

was done by stacking up Q-maps in uniformly spaced cutting planes [59]. In Figure 5, the original

grids were reﬁned by 4 times in the calculation of Q.

Identiﬁcation of Null Points

To locate null points in a 3D magnetic ﬁeld with uniform grids, we assume that within each cell the

ﬁeld is linear or trilinear, following Haynes & Parnell [51]. Under this assumption, a cell is excluded

in the further analysis if any of the three magnetic ﬁeld components [Bx, By, Bz] is nonzero and

of the same sign at each corner of the cell. More cells can be excluded by checking whether the

intersection curves of the isosurfaces Bx = 0, By = 0, and Bz = 0 pierce the cell faces in pair [51].

Two methods are used to locate the null position to subgrid precision. One may conduct a brute-

force search for min B in each candidate cell. First the cell is uniformly divided into (say 1000)

miniature cells. The miniature cell centered on the grid point with min B is further divided and

a new min B is located. This is done recursively until the number of recursion exceeds, say, 3
times, or, min B < 10−4 G. A null point is located if the latter condition is satisﬁed. Alternatively,
one may solve B = 0 with the iterative Newton-Raphson method [51]. We conﬁrmed that null

points detected in both methods are consistent within the limits of numerical accuracy. However,

the Newton-Raphson method is generally more efﬁcient and has the potential to identify multiple

nulls within a candidate cell, e.g., in the case of a null line (see below), if one initiates the iteration

from a sufﬁciently large number of subgrid points.

14

The local magnetic structure in the vicinity of a null point is determined by the tensor Mij =
[50]. The structure is relatively simple for potential ﬁelds, since without currents M is

∂Bi/∂xj

symmetric and has three real eigenvalues, whose sum is zero. For an isolated null, there is one

eigenvalue of opposite sign to the other two, and its associated eigenvector determines the spine

while the other two eigenvectors deﬁne the fan plane. This differs for a non-isolated null, as

exempliﬁed by a null line in an idealized quadrupole ﬁeld (see below).

There are subtle differences for nulls identiﬁed in the potential ﬁeld constructed with differ-

ent methods (Green function vs. Fourier transform) and different boundary conditions (original vs.

pre-processsed), but the time period when the double-null conﬁguration was present and the loca-

tions of these nulls are essentially the same (Supplementary Figures 4 and 5). This demonstrates

the robustness of such topological skeletons.

Idealized Quadruple Field

Here an idealized quadrupole ﬁeld, similar to Sun et al. [29], was employed to shed light on the

magnetic topology involved in the X-shaped ﬂares. For simplicity, two dipoles were placed in an

opposite direction below a Cartesian computation domain (−255.5 ≤ x, y ≤ 255.5, 0 ≤ z ≤ 511):
m1 = 1.024 ×109 ×(−1, 0, 0)T at d1 = (0, −60, −80)T , and m2 = α ×1.024 ×109 ×(1, 0, 0)T
at d2 = (0, 60, −80)T , where α is a fraction number between 0 and 1. The sum of the two dipole

ﬁelds yields a potential ﬁeld with a magnitude of 2000 G at the photosphere (z = 0),
2

B(r) =

Xi=1

3(mi · ri)ri
r5
i

mi
r3
i

−

,

(5)

where ri = r − di. With this setup, mi · ri = 0 and By = Bz = 0 at the plane x = 0. A null line
along which B = 0 was found to be a circular curve within this plane of symmetry, i.e.,

where

|r − C(α, d1, d2)| = |R(α, d1, d2)|,

C =

d2 − α2/3d1
1 − α2/3

and R =

α1/3
1 − α2/3 (d2 − d1).

15

When α = 1, however, it degenerates into a line within the same plane,

(d2 − d1) · r +

1
2

(d2

2 − d2

1) = 0.

We have tested our null-locating code with this quadrupole ﬁeld and found that all the nulls iden-

tiﬁed are located along the analytical null line within the limits of numerical accuracy.

Since B is potential, we again have three real eigenvalues for M = [∂B/∂r] given an arbi-

trary point on the null line, but one of the eigenvalues is precisely zero, say, λ1 > 0, λ2 < 0, λ3 =
0, and λ1 + λ2 = 0. Formally, a position vector r on a ﬁeld line near the null can be written as [50]

r(k) = c1eλ1kv1 + c2eλ2kv2 + c3eλ3kv3,

(6)

where vi are eigenvectors, k is an arbitrary parameter and ci are constant along the ﬁeld line, whose

behavior near the null is determined as follows,

dr(k)
dk

= M · r(k).

(7)

Hence, when one traces a ﬁeld line forward (k → ∞) or backward (k → −∞) away from the
null, the v3 term in Eq. 6 becomes irrelevant, and all the ﬁeld lines are either directed away from

the null along v1 or toward the null along v2. Thus, each point on the null line owns two spines.

Supplementary Figure 7 gives three examples with α = [0.2, 0.5, 0.8]. One can see that the null

line inclines toward the weaker dipole and that the footpoints of all the spines collectively produce

an X shape, if the magnitudes of the two dipoles are comparable.

Mapping out the magnetic connectivities (Supplementary Figure 8), one can see that the null

line corresponds to the intersection of two high-Q surfaces, whose footprints are coincident with

the footpoints of the spines. This again demonstrates the intimate relation between topological
skeletons and QSLs [10,11]. However, a slight rotation of m2 about the z-axis breaks the symmetry

and the null line disappears completely. Only one single null is identiﬁed, when the rotational
angle is within about ±20◦, beyond which no null is found within the computational domain. In

contrast, the HFT structure is stable; it again leans toward the weaker dipole, and its footprint

leaves a skewed X shape on the surface when α approaches unit (Supplementary Figure 9).

16

[1] Schwenn, R. Space Weather: The Solar Perspective. Living Reviews in Solar Physics 3

(2006).

[2] Wiegelmann, T. et al. How Should One Optimize Nonlinear Force-Free Coronal Magnetic

Field Extrapolations from SDO/HMI Vector Magnetograms? Solar Phys. 281, 37–51 (2012).

[3] Berger, M. A. Rigorous new limits on magnetic helicity dissipation in the solar corona.

Geophysical and Astrophysical Fluid Dynamics 30, 79–104 (1984).

[4] Priest, E. R. & Forbes, T. G. The magnetic nature of solar ﬂares. Astron. Astrophys. Rev. 10,

313–377 (2002).

[5] Fletcher, L. et al. An Observational Overview of Solar Flares. Space Sci. Rev. 159, 19–106

(2011).

[6] Titov, V. S. Generalized Squashing Factors for Covariant Description of Magnetic Connec-

tivity in the Solar Corona. Astrophys. J. 660, 863–873 (2007).

[7] Titov, V. S., Forbes, T. G., Priest, E. R., Miki´c, Z. & Linker, J. A. Slip-Squashing Factors

as a Measure of Three-Dimensional Magnetic Reconnection. Astrophys. J. 693, 1029–1044

(2009).

[8] Longcope, D. W. Topological Methods for the Analysis of Solar Magnetic Fields. Living

Reviews in Solar Physics 2 (2005).

[9] Priest, E. R. & D´emoulin, P. Three-dimensional magnetic reconnection without null points.

1. Basic theory of magnetic ﬂipping. J. Geophys. Res. 100, 23443–23464 (1995).

[10] Titov, V. S., Hornig, G. & D´emoulin, P. Theory of magnetic connectivity in the solar corona.

Journal of Geophysical Research (Space Physics) 107, 1164 (2002).

[11] Restante, A. L., Aulanier, G. & Parnell, C. E. How skeletons turn into quasi-separatrix layers

in source models. Astron. Astrophys. 508, 433–443 (2009).

[12] Titov, V. S., Galsgaard, K. & Neukirch, T. Magnetic Pinching of Hyperbolic Flux Tubes. I.

Basic Estimations. Astrophys. J. 582, 1172–1189 (2003).

17

[13] Galsgaard, K., Titov, V. S. & Neukirch, T. Magnetic Pinching of Hyperbolic Flux Tubes. II.

Dynamic Numerical Model. Astrophys. J. 595, 506–516 (2003).

[14] Aulanier, G., Pariat, E. & D´emoulin, P. Current sheet formation in quasi-separatrix layers

and hyperbolic ﬂux tubes. Astron. Astrophys. 444, 961–976 (2005).

[15] D´emoulin, P. Extending the concept of separatrices to QSLs for magnetic reconnection.

Advances in Space Research 37, 1269–1282 (2006).

[16] D´emoulin, P. Where will efﬁcient energy release occur in 3-D magnetic conﬁgurations?

Advances in Space Research 39, 1367–1377 (2007).

[17] Dodson, H. W. & Hedeman, E. R. Major Hα Flares in Centers of Activity with very Small or

no Spots. Solar Phys. 13, 401–419 (1970).

[18] Harvey, K., Sheeley, N., Jr. & Harvey, J. HE I 10830 A Observations of Two-Ribbon Flare-

Like Events Associated with Filament Disappearances.

In Simon, P. A., Heckman, G. &

Shea, M. A. (eds.) Solar-Terrestrial Predictions, 198 (1986).

[19] Rausaria, R. R., Aleem, S. M. & Sundara Raman, K. On the triggering of a spotless double-

ribbon ﬂare. Solar Phys. 142, 131–141 (1992).

[20] Li, K. J., Zhong, S. H., Ding, Y. J., Bai, J. M. & Li, Q. Y. The sunspotless ﬂare on April 12,

1991 and the evolution of the neighboring ﬁlaments. Astron. Astrophys. Suppl. 109 (1995).

[21] Borovik, A. V. & Myachin, D. Y. The spotless ﬂare of 16 March 1981 - I. Pre-Flare Activa-

tions of the Chromospheric Fine Structure. Solar Phys. 205, 105–116 (2002).

[22] Sersen, M. & Valnicek, B. Spotless ﬂares and type II radio bursts. Solar Phys. 145, 339–345

(1993).

[23] Carmichael, H. A Process for Flares. NASA Special Publication 50, 451 (1964).

[24] Sturrock, P. A. Model of the High-Energy Phase of Solar Flares. Nature 211, 695–697

(1966).

18

[25] Hirayama, T. Theoretical Model of Flares and Prominences. I: Evaporating Flare Model.

Solar Phys. 34, 323–338 (1974).

[26] Kopp, R. A. & Pneuman, G. W. Magnetic reconnection in the corona and the loop prominence

phenomenon. Solar Phys. 50, 85–98 (1976).

[27] Masson, S., Pariat, E., Aulanier, G. & Schrijver, C. J. The Nature of Flare Ribbons in Coronal

Null-Point Topology. Astrophys. J. 700, 559–578 (2009).

[28] Wang, H. & Liu, C. Circular Ribbon Flares and Homologous Jets. Astrophys. J. 760, 101

(2012).

[29] Sun, X. et al. Hot Spine Loops and the Nature of a Late-phase Solar Flare. Astrophys. J.

778, 139 (2013).

[30] Jiang, C., Wu, S. T., Feng, X. & Hu, Q. Formation and Eruption of an Active Region Sigmoid.

I. A Study by Nonlinear Force-free Field Modeling. Astrophys. J. 780, 55 (2014).

[31] Vemareddy, P. & Wiegelmann, T. Quasi-static Three-dimensional Magnetic Field Evolution

in Solar Active Region NOAA 11166 Associated with an X1.5 Flare. Astrophys. J. 792, 40

(2014).

[32] Joshi, N. C. et al. The Role of Erupting Sigmoid in Triggering a Flare with Parallel and

Large-scale Quasi-circular Ribbons. Astrophys. J. 812, 50 (2015).

[33] Liu, C. et al. A Circular-ribbon Solar Flare Following an Asymmetric Filament Eruption.

Astrophys. J. Lett. 812, L19 (2015).

[34] Hoeksema, J. T. et al. The Helioseismic and Magnetic Imager (HMI) Vector Magnetic Field

Pipeline: Overview and Performance. Solar Phys. 289, 3483–3530 (2014).

[35] Pesnell, W. D., Thompson, B. J. & Chamberlin, P. C. The Solar Dynamics Observatory

(SDO). Solar Phys. 275, 3–15 (2012).

19

[36] Bobra, M. G. et al. The Helioseismic and Magnetic Imager (HMI) Vector Magnetic Field

Pipeline: SHARPs - Space-Weather HMI Active Region Patches. Solar Phys. 289, 3549–

3578 (2014).

[37] Lemen, J. R., Title, A. M., Akin, D. J. et al. The Atmospheric Imaging Assembly (AIA) on

the Solar Dynamics Observatory (SDO). Solar Phys. 275, 17–40 (2012).

[38] O’Dwyer, B., Del Zanna, G., Mason, H. E., Weber, M. A. & Tripathi, D. SDO/AIA response

to coronal hole, quiet Sun, active region, and ﬂare plasma. Astron. Astrophys. 521, A21

(2010).

[39] Lin, R. P., Dennis, B. R., Hurford, G. J. et al. The Reuven Ramaty High-Energy Solar

Spectroscopic Imager (RHESSI). Solar Phys. 210, 3–32 (2002).

[40] Machado, M. E. & Henoux, J.-C. Chromospheric effects of XUV radiation emitted during

solar ﬂares. Astron. Astrophys. 108, 61–68 (1982).

[41] Doyle, J. G. & Phillips, K. J. H. Excitation of the solar ﬂare far-ultraviolet continuum by line

irradiation. Astron. Astrophys. 257, 773–776 (1992).

[42] Yang, S., Zhang, J. & Xiang, Y. Magnetic Reconnection between Small-scale Loops Ob-

served with the New Vacuum Solar Telescope. Astrophys. J. Lett. 798, L11 (2015).

[43] Fletcher, L., Hannah, I. G., Hudson, H. S. & Innes, D. E. Flare Ribbon Energetics in the

Early Phase of an SDO Flare. Astrophys. J. 771, 104 (2013).

[44] Sim˜oes, P. J. A., Graham, D. R. & Fletcher, L. Impulsive Heating of Solar Flare Ribbons

Above 10 MK. Solar Phys. 290, 3573–3591 (2015).

[45] Polito, V. et al. Simultaneous IRIS and Hinode/EIS Observations and Modelling of the 2014

October 27 X2.0 Class Flare. Astrophys. J. 816, 89 (2016).

[46] Aschwanden, M. J., Kosugi, T., Hanaoka, Y., Nishio, M. & Melrose, D. B. Quadrupolar Mag-

netic Reconnection in Solar Flares. I. Three-dimensional Geometry Inferred from Yohkoh

Observations. Astrophys. J. 526, 1026–1045 (1999).

20

[47] Solanki, S. K. Sunspots: An overview. Astron. Astrophys. Rev. 11, 153–286 (2003).

[48] Zwaan, C. Elements and patterns in the solar magnetic ﬁeld. Ann. Rev. Astron. Astrophys.

25, 83–111 (1987).

[49] Liu, R. et al. An Unorthodox X-Class Long-duration Conﬁned Flare. Astrophys. J. 790, 8

(2014).

[50] Parnell, C. E., Smith, J. M., Neukirch, T. & Priest, E. R. The structure of three-dimensional

magnetic neutral points. Physics of Plasmas 3, 759–770 (1996).

[51] Haynes, A. L. & Parnell, C. E. A trilinear method for ﬁnding null points in a three-

dimensional vector space. Physics of Plasmas 14, 082107–082107 (2007).

[52] Priest, E. Magnetohydrodynamics of the Sun (Cambridge University Press, 2014), 1st edn.

[53] Wiegelmann, T. Optimization code with weighting function for the reconstruction of coronal

magnetic ﬁelds. Solar Phys. 219, 87–108 (2004).

[54] Wiegelmann, T., Inhester, B. & Sakurai, T. Preprocessing of Vector Magnetograph Data for

a Nonlinear Force-Free Magnetic Field Reconstruction. Solar Phys. 233, 215–232 (2006).

[55] Schuck, P. W. Tracking Vector Magnetograms with the Magnetic Induction Equation. As-

trophys. J. 683, 1134–1152 (2008).

[56] Liu, Y. et al. Magnetic Helicity in Emerging Solar Active Regions. Astrophys. J. 785, 13

(2014).

[57] Liu, Y. & Schuck, P. W. Magnetic Energy and Helicity in Two Emerging Active Regions in

the Sun. Astrophys. J. 761, 105 (2012).

[58] Kusano, K., Maeshiro, T., Yokoyama, T. & Sakurai, T. Measurement of Magnetic Helicity

Injection and Free Energy Loading into the Solar Corona. Astrophys. J. 577, 501–512 (2002).

[59] Liu, R. et al. Structure, Stability, and Evolution of Magnetic Flux Ropes from the Perspective

of Magnetic Twist. Astrophys. J. 818, 148 (2016).

21

[60] Alissandrakis, C. E. On the computation of constant alpha force-free magnetic ﬁeld. Astron.

Astrophys. 100, 197–200 (1981).

Acknowledgments We thank the SDO team for the vector magnetic ﬁeld and EUV imaging data, P.W.

Schuck for the ﬂow tracking code, T. Wiegelmann for the NLFFF code, X. Cheng for helpful comments.

R.L. acknowledges the support from the Thousand Young Talents Program of China and NSFC 41474151.

Y.W. acknowledges the support from NSFC 41131065 and 41574165. This work was also supported by

NSFC 41421063, CAS Key Research Program KZZD-EW-01-4, and the fundamental research funds for the

central universities.

Correspondence Correspondence and requests for materials should be addressed to R.L. (rliu@ustc.edu.cn).

22

Table 1: List of Major Flares (M-class and above) in AR 11967

Date

Class

Peak Carr Lon Carr Lat

Instrument

2014/02/01 M1.0

01:25

113.987

-10.463

AIA

2014/02/01 M3.0

07:23

113.759

-11.086

RHESSI

2014/02/02 M2.2 08:20

109.400

-10.995

RHESSI

2014/02/02 M4.4 09:31

109.602

-10.641

AIA

2014/02/02 M3.1 18:11

109.325

-10.898

RHESSI

2014/02/02 M1.3

22:04

116.584

-10.625

RHESSI

2014/02/04 M3.8

01:23

114.536

-10.355

RHESSI

2014/02/04 M5.2

04:00

106.954

-14.215

AIA

2014/02/04 M1.4

09:49

107.728

-13.806

RHESSI

2014/02/04 M1.5

16:02

107.377

-14.291

RHESSI

2014/02/05 M1.3

16:20

114.830

-10.301

AIA

The Carrington longitudes and latitudes of the ﬂare locations are

given by the peak emission loci of RHESSI HXR sources at 6–12

keV or by the peak 131 ˚A emission loci in the ﬂaring regions when

RHESSI data were not available. The three X-shaped ﬂares are shown

in boldface. All the events were ‘conﬁned’ without being associated

with a coronal mass ejection (CME).

23

AIA 131 18:09:23

AIA 94 18:09:25

AIA 193 18:09:21

)
c
e
s
c
r
a
(

Y
−
r
a
o
S

l

0

−50

−100

−150

AIA 335 18:09:26

AIA 211 18:09:27

AIA 171 18:09:25

6−15 keV
25−50 keV

Bz = 100, 800
Bz = −800, −100

n

p

P2

P1

N1

AIA 304 18:09:22

AIA 1600 18:09:28

AIA 1700 18:09:18

−200

−150

−100

−50

Solar−X (arcsec)

Figure 1: Snapshots of the X-shaped M3.1 ﬂare at 18:11 UT on 2014 February 2 in AIA’s nine UV/EUV

passbands. Heliocentric-cartesian coordinates are adopted so that X (Y ) increases towards the solar west

(north). The AIA 1600 ˚A image is superimposed by RHESSI HXR contours at 6–12 (red) and 25–50 (blue)

keV, with the contour levels set at 50 and 90 percent of the maximum intensity. The AIA 1700 ˚A image is

superimposed by the contours of the line-of-sight component of the photospheric magnetic ﬁeld. The green

and blue colors indicate positive and negative polarities, respectively, with the contour levels set at ±100

and ±800 Gauss. An animation of AIA images is provided in Supplementary Movie 1.

24

 
)
2
−

m
W

(

Å
8
−
1
S
E
O
G

)
1
−
s
N
D

(

Å
1
3
1
A
A

I

Major flare in AR 11967

10−5

10−6

(a)

M

C

01−Feb

02−Feb

03−Feb

04−Feb

05−Feb

31−Jan
108

AR
Ra (131)
Ra (1600)

107

106

X−shaped flare
Non−X−shaped flare

31−Jan

2.5•1021

01−Feb

02−Feb

03−Feb

04−Feb

05−Feb

)
x
M

(

l

x
u
F
g
a
M
b
R

2.0•1021

1.5•1021

1.0•1021

5.0•1020

Positive flux
Negative flux (abs)

06−Feb
107

(b)

)
1
−
s
N
D

(

Å
0
0
6
1
A
A

I

106

06−Feb
(c)

31−Jan

01−Feb

02−Feb

03−Feb

04−Feb

05−Feb

06−Feb

Upper Null
Lower Null
Single Null

)

m
M

(

t
h
g
e
H

i

l
l

u
N

40

30

20

10

0

31−Jan

01−Feb

02−Feb

03−Feb
Start Time (31−Jan−14 00:00:00)

04−Feb

(d)

05−Feb

06−Feb

Figure 2: Flares in relation to AR 11967. a) GOES 1–8 ˚A light curve. Arrows on the top mark the peak

times of major ﬂares (M-class and above) in this AR from the beginning of January 31 till end of February 5,
during which the AR crossed the solar disk from about 45◦E to 45◦W. b) Integrated emission over the whole

AR in 131 ˚A (black) and the regional emission integrated over Ra (rectangle in Figure 3(b)) in 131 ˚A (red)

and 1600 ˚A (blue). X-shaped ﬂares are marked by red arrows while non-X-shaped ﬂares by black arrows.

c) Magnetic ﬂuxes in Rb (Figure 3(b)). Positive ﬂuxes and absolute values of negative ﬂuxes are denoted in

red and blue, respectively. d) Heights of the detected magnetic null points. The lower null is marked with a

triangle and the upper null with a diamond when a double null is present. A single null is marked by a ‘+’

symbol. The peak times of the three XMFs are denoted by vertical dotted lines.

25

 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
X (Mm)

100

150

200

250

0

50

X (Mm)

100

150

200

250

0

-6
-6

-8
-8

-10
-10

-12
-12

-14
-14

-16
-16

)
g
e
d
(

e
d
u
t
i
t
a
L

P1

2000

1000

0

-1000

-2000

n

N2

P2

p

Nc

N1

P3

P4

Ra

50

Rb

Feb 5

Feb 4

Feb 3

Feb 2

Feb 1

Jan 31

-18
-18

2000 G

a) HMI vecB  2014-02-02T07:58:10

0.5 km/s

b) V (km s-1; 07:58 - 18:58)

105
105

110
110

115
115

120
120

Carrington Longitude (deg)

105
105

110
110

115
115

120
120

Carrington Longitude (deg)

0

50

X (Mm)

100

150

200

250

0

50

X (Mm)

100

150

200

250

)
g
e
d
(
e
d
u
t
i
t
a
L

-6
-6

-8
-8

-10
-10

-12
-12

-14
-14

-16
-16

-18
-18

c) hm (109Mx2 cm-2 s-1; 07:58 - 18:58)

d) pm (104erg cm-2 s-1; 07:58 - 18:58)

105
105

110
110

115
115

120
120

Carrington Longitude (deg)

105
105

110
110

115
115

120
120

Carrington Longitude (deg)

-4

-2

0

2

4

-1.5

-1.0

-0.5

0.0

0.5

1.0

1.5

150

100

50

0

150

100

50

0

)

m
M

(

Y

)

m
M

(

Y

Figure 3: HMI observation of AR 11967. (a) Vector magnetogram of AR 11967 immediately before the

occurrence of the ﬁrst XMF at 08:20 UT on 2014 February 2. White and black colors refer to positive and

negative Bz, respectively, which are scaled to ±2000 G (see the color bar). Red (blue) arrows represent the

tangential ﬁeld components that originate from negative (positive) Bz elements. (b–d) Maps of photospheric

ﬂows, helicity and Poynting ﬂux density averaged over a time period of 11 hrs covering the three XMFs. In

Panel (b) the locations of all the major ﬂares from January 31 to February 5, as given in Table 1, are marked

with star symbols. The colors and sizes of the symbols indicate different times (see the color bar) and ﬂare

magnitudes, respectively. The largest size corresponds to the M5.2 ﬂare at 03:57 UT on 2014 February

4. The evolution of the vector magnetic ﬁeld, ﬂow ﬁeld, helicity and Poynting ﬂux density is provided in

Supplementary Movie 2.

26

 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Figure 4: Magnetic topology prior to the XMF at 18:11 UT on 2014 February 2. a) A UV 1600 ˚A image

taken during the impulsive phase of the ﬂare (same as in Figure 1) and remapped with the CEA projection is

blended with the log Q map on the photosphere in Panel (b), which is calculated with the HMI magnetogram

at 17:58 UT. Panels (c) and (d) show two cuts of log Q at different heights just above the lower null and

below the upper null, respectively. Field lines traced in the neighborhood of the double null, with fan (spine)

ﬁeld lines in magenta (blue), are projected in X-Y (Panel a), X-Z (Panel e), and Y-Z (Panel f) planes. The
27
black dots in (e) and (f) indicate the visually determined center of the X shape in log Q at different heights.

The X shape is complicated below the lower null, hence its central position is not shown here. An animation

of log Q at different heights is provided in Supplementary Movie 3.

Figure 5: QSLs prior to the XMF at 18:11 UT on 2014 February 2. a) Isosurfaces of log Q = 5, superim-

posed by ﬁeld lines traced in the neighbourhood of the double null, with fan (spine) ﬁeld lines in magenta

(blue). Bottom panels show two side views of the isosurfaces from the east (b) and the southwest (c), re-

spectively. The null locations are roughly indicated by red arrows. A 360 deg side view of the isosurfaces is

provided in Supplementary Movie 4.

28

Figure 6: Magnetic topology as revealed by a NLFFF model for the XMF at 18:11 UT on 2014 February

2. Panel (a) shows a blend of UV 1600 ˚A image and the photospheric log Q map, the latter of which is

shown in Panel (b). Panels (c) and (d) show a horizontal cut of the electric current and log Q at Z = 29 Mm,

respectively. An animation of log Q at different heights is provided in Supplementary Movie 5.

29

Supplementary Notes

Supplementary Figures 1 (Supplementary Movie 6) and 2 (Supplementary Movie 7) show the AIA

observations of the other two XMFs occurring at 08:20 UT and 09:31 UT on 2014 February 2,

respectively. The magnetic topology relevant to the X-shaped ribbons in these two ﬂares was

similar to the ﬂare at 18:11 UT (Figures 4–6), with a double null embedded in the intersection of

two high-Q surfaces (Supplementary Figure 6 and Supplementary Movies 8 and 9).

The XMFs at 08:20 UT (Supplementary Figure 1) and 18:11 UT (Figure 1) were observed

in HXRs by RHESSI. In both ﬂares, we integrated the HXR spectra over 40 s around the peak of

the nonthermal HXR bursts (Supplementary Figure 3) and found that they can be well ﬁtted with

an exponential thermal function (red) and a nonthermal power-law function (blue).

30

Supplementary Figures

AIA 131 08:18:11

AIA 94 08:18:13

AIA 193 08:18:09

AIA 335 08:18:14

AIA 211 08:18:13

AIA 171 08:18:13

6−12 keV
25−50 keV

Bz = 100, 800
Bz = −800, −100

AIA 304 08:18:09

AIA 1600 08:18:16

AIA 1700 08:18:06

−300

−250

−200

−150

X (arcsecs)

n

P2

p

P1

N1

)
s
c
e
s
c
r
a
(

Y

0

−20

−40

−60

−80

−100

−120

−140

Supp. Fig. 1: A snapshot of the M2.2 ﬂare at 08:20 UT on 2014 Feburary 2 in AIA’s nine UV/EUV

passbands. The spine (blue) and fan (magenta) ﬁeld lines of two coronal null points are projected onto the

AIA 94 ˚A image. The AIA 1600 ˚A image is superimposed by RHESSI HXR contours at 6–12 (red) and

25–50 (blue) keV, with the contour levels set at 50 and 90 percent of the maximum intensity. The AIA

1700 ˚A image is superimposed by the contours of the LOS component of the photospheric magnetic ﬁeld.

The red and blue colors indicate positive and negative polarities, respectively, with the contour levels set at

±100 and ±800 Gauss. An animation of AIA images is provided in Supplementary Movie 6.

31

 
AIA 131 09:29:23

AIA 94 09:29:25

AIA 193 09:29:21

AIA 335 09:29:26

AIA 211 09:29:26

AIA 171 09:29:25

Bz = 100, 800
Bz = −800, −100

n

p

P2

P1

N1

AIA 304 09:29:21

AIA 1600 09:29:28

AIA 1700 09:29:18

−300

−250

−200

X (arcsecs)

−150

)
s
c
e
s
c
r
a
(

Y

0

−20

−40

−60

−80

−100

−120

−140

Supp. Fig. 2: A snapshot of the M4.4 ﬂare at 09:31 UT on 2014 Feburary 2 in AIA’s nine UV/EUV pass-

bands. The spine (blue) and fan (magenta) ﬁeld lines of two coronal null points are projected onto the AIA

94 ˚A image. The AIA 1700 ˚A image is superimposed by the contours of the LOS component of the photo-

spheric magnetic ﬁeld. The red and blue colors indicate positive and negative polarities, respectively, with

the contour levels set at ±100 and ±800 Gauss. An animation of AIA images is provided in Supplementary

Movie 7.

32

 
08:16:52−08:17:32 UT
EM = 0.16±0.02x1049 cm−3
T = 21.9±0.7 MK
Eb = 17.8±0.4 keV
γ = 5.98±0.05
χ2 = 0.96

104

102

100

)
1
−
V
e
k

2
−

m
c

1
−
s

s
n
o
t
o
h
p
(

x
u
F

l

10−2
3
2
1
0
−1
−2
−3

d
e
z

i
l

a
m
r
o
N

l

e
u
d
s
e
R

i

18:09:16−18:09:56 UT
EM = 0.12±0.01x1049 cm−3
T = 22.1±0.6 MK
Eb = 16.5±0.9 keV
γ = 4.75±0.06
χ2 = 1.57

104

103

102

101

100

10−1

6
4
2
0
−2
−4

10

Energy (keV)

100

10

Energy (keV)

100

Supp. Fig. 3: Flare spectroscopy for the M2.2 ﬂare at 08:20 UT and M3.1 ﬂare at 18:11 UT on 2014

February 2. RHESSI spectra at the ﬂare peak are ﬁtted in an energy range of 6–100 keV (denoted by dotted

lines) with an exponential thermal function (red) and a broken power-law function (blue) with the spectral

index γ below the broken energy Eb being ﬁxed at 1.5. The background is shown in gray.

33

 
 
 
 
 
 
 
 
)
g
e
d
(

e
d
u
t
i
t
a
L

)
g
e
d
(
e
d
u
t
i
t
a
L

−6
−6

−8
−8

−10
−10

−12
−12

−14
−14

−16
−16

−18
−18

−6
−6

−8
−8

−10
−10

−12
−12

−14
−14

−16
−16

−18
−18

a) Green

b) Green − preprocessed

−6
−6

−8
−8

−10
−10

−12
−12

−14
−14

−16
−16

−18
−18

105
105

110
110

115
115

120
120

105
105

110
110

115
115

120
120

c) FFT

d) FFT − preprocessed

−6
−6

−8
−8

−10
−10

−12
−12

−14
−14

−16
−16

−18
−18

Feb 5
Feb 4
Feb 3
Feb 2
Feb 1
Jan 31

105
105
Carrington Longitude (deg)

115
115

110
110

120
120

105
105
Carrington Longitude (deg)

110
110

115
115

120
120

Supp. Fig. 4: Null locations projected on the photospheric boundary used for the potential ﬁeld extrapola-

tion. The nulls are identiﬁed in potential ﬁelds constructed with different methods (Green function vs. fast

Fourier transform) and different boundary conditions (original vs. pre-processsed). Same as in Figure 2, the

lower (upper) null is marked with a triangle (diamond) for double nulls, while a single null is marked by a

‘+’ symbol. The color of symbols indicates the time when the null was present (see the color bar).

34

 
 
 
 
)

m
M

(

t
h
g
e
H

i

l
l

u
N

)

m
M

(

t
h
g
e
H

i

l
l

u
N

)

m
M

(

t
h
g
e
H

i

l
l

u
N

)

m
M

(

t
h
g
e
H

i

l
l

u
N

a) Green

40

30

20

10

0

31−Jan

01−Feb

02−Feb

03−Feb

04−Feb

05−Feb

06−Feb

b) Green − preprocessed

40

30

20

10

0

31−Jan

01−Feb

02−Feb

03−Feb

04−Feb

05−Feb

06−Feb

c) FFT

40

30

20

10

0

31−Jan

01−Feb

02−Feb

03−Feb

04−Feb

05−Feb

06−Feb

d) FFT − preprocessed

40

30

20

10

0

31−Jan

01−Feb

02−Feb

03−Feb
Start Time (31−Jan−14 00:00:00)

04−Feb

05−Feb

06−Feb

Supp. Fig. 5: Null heights with time. The nulls are identiﬁed in potential ﬁelds constructed with different

methods (Green function vs. fast Fourier transform) and different boundary conditions (original vs. pre-

processsed). Vertical dotted lines indicate the peak times of three XMFs. Same as in Figure 2, the lower

(upper) null is marked with a triangle (diamond) for double nulls, while a single null is marked by a ‘+’

symbol.

35

 
 
 
 
 
 
 
 
Supp. Fig. 6: Magnetic topology relevant to the M2.2 ﬂare at 08:20 UT and M4.4 ﬂare at 09:31 UT on

2014 February 2. Left column: A UV 1600 ˚A image taken during the impulsive phase of the ﬂare and

remapped with the CEA projection is blended with the log Q map calculated for the HMI magnetogram

acquired at approximately the same time. Right column: Isosurfaces of log Q = 5, overplotted by ﬁeld lines

traced in the neighborhood of the double null, with ‘fan’ lines in magenta and ‘spine’ lines in blue. A 360

deg side view of the log Q = 5 isosurfaces in Panels (b) and (d) is provided in Supplementary Movies 8 and

9, respectively.

36

Supp. Fig. 7: Idealized quadrupole ﬁeld. Panels (a–c) show the map of Bz at z = 0 with different α. The

null lines for α = 0.2, 0.5, 0.8 are shown in black, gray, and light gray colors, respectively, with decreasing

thickness, in bottom panels. Exemplary spine ﬁeld lines threading the middle of each null line are also

projected in X-Y (a–c), X–Z (d, e), and Y–Z (f, g) planes. The spines resulting from tracing ﬁeld lines

toward the null are shown in maroon (α = 0.2), red (α = 0.5), and orange (α = 0.8), whose footpoints are

shown in white in top panels, while those resulting from tracing ﬁeld lines away from the null are shown in

blue (α = 0.2), cyan (α = 0.5), and green (α = 0.8), whose footpoints are shown in black.

37

Supp. Fig. 8: Magnetic topology of the quadruple ﬁeld with different α. The left column shows the maps

of log10 Q at z = 0. The corresponding isosurfaces of log10 Q = 4 in a 3D perspective are shown on the

right column.

38

Supp. Fig. 9: Magnetic topology of the quadrupole ﬁeld when m2 = α × 1.024 × 109 × (cos θ, sin θ, 0)T .
Top panels show the maps of log10 Q at z = 0 when θ = −15◦ (a) and 15◦ (c). The corresponding

isosurfaces of log10 Q = 4 are shown in (b) and (d), respectively. The crosses in the top panels mark the

null locations with different θ values (color coded). The inset in (a) shows the null locations in the X-Z

plane.

39

Unsigned flux
Positive flux
Negative flux (abs)

2.0•1023

1.5•1023

1.0•1023

5.0•1022

)
x
M

(

l

x
u
F
g
a
M
R
A

31−Jan

1.0•1038

5.0•1037

01−Feb

02−Feb

03−Feb

04−Feb

05−Feb

0

−5.0•1037

−1.0•1038

−1.5•1038

Total helicity flux
Helicity shear term
Helicity emergence term

)
1
−
s
2
x
M

(

l

x
u
F
y
t
i
c

i
l

e
H

31−Jan

01−Feb

02−Feb

03−Feb

04−Feb

05−Feb

Total Poynting Flux
Poynting shear term
Poynting emergence term

)
1
−
s

g
r
e
(

l

x
u
F
g
n
i
t
n
y
o
P

4•1027
3•1027
2•1027
1•1027
0
−1•1027
−2•1027

06−Feb

6•1042
5•1042
4•1042
3•1042
2•1042
1•1042
0
−1•1042

06−Feb

1•1032

5•1031

0

−5•1031

)
2
x
M

(

y
t
i
c

i
l

e
H
m
u
c
c
A

)
g
r
e
(

y
g
r
e
n
E
m
u
c
c
A

31−Jan

01−Feb

02−Feb

03−Feb
Start Time (31−Jan−14 00:00:00)

04−Feb

05−Feb

06−Feb

Supp. Fig. 10: Helicity and energy injection into AR 11967. From top to bottom we show the time series
of magnetic ﬂuxes [Mx], helicity ﬂuxes [Mx2 s−1], and Poynting ﬂuxes [erg s−1]. The helicity [Mx2] and

magnetic energy [erg] accumulated in the active region are displayed in green in the corresponding panel,

scaled by the right y-axis.

40

 
 
 
 
 
 
 
 
 
 
 
 
Supplementary Movies

Supplementary Movie 1 AIA observation of the X-shaped major ﬂare (XMF) at 18:11 UT on 2014

February 2 (cf. Figure 1)

Supplementary Movie 2 Evolution of NOAA AR 11967 from January 31 to February 5 (Figure 3)

Supplementary Movie 3 log Q at different heights for the potential ﬁeld at 17:58 UT on 2014 February 2

(cf. Figure 4(b–d))

Supplementary Movie 4 360 deg side view of the isosurfaces of log Q = 5 for the potential ﬁeld at 17:58

UT on 2014 February 2, superimposed by ﬁeld lines traced in the neighbourhood of two nulls, with fan

(spine) ﬁeld lines in magenta (blue) (cf. Figure 5).

Supplementary Movie 5 log Q at different heights for the NLFFF at 17:58 UT on 2014 February 2 (cf.

Figure 6(c and d))

Supplementary Movie 6 AIA observation of the XMF at 08:20 UT on 2014 February 2 (cf. Supplemen-

tary Figure 1)

Supplementary Movie 7 AIA observation of the XMF at 09:31 UT on 2014 February 2 (cf. Supplemen-

tary Figure 2)

Supplementary Movie 8 360 deg side view of the isosurfaces of log Q = 5 for the potential ﬁeld at 07:58

UT on 2014 February 2, superimposed by ﬁeld lines traced in the neighbourhood of two nulls, with fan

(spine) ﬁeld lines in magenta (blue) (cf. Supplementary Figure 6(b)).

Supplementary Movie 9 360 deg side view of the isosurfaces of log Q = 5 for the potential ﬁeld at 08:58

UT on 2014 February 2, superimposed by ﬁeld lines traced in the neighbourhood of two nulls, with fan

(spine) ﬁeld lines in magenta (blue) (cf. Supplementary Figure 6(d))

41

