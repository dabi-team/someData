0
2
0
2

l
u
J

9
1

]

V

I
.
s
s
e
e
[

1
v
0
5
5
9
0
.
7
0
0
2
:
v
i
X
r
a

Predicting risk of late age-related macular degeneration using
deep learning
Yifan Peng, PhD1,†, Tiarnan D. Keenan, BM BCh, PhD2,†, Qingyu Chen, PhD1, Elvira Agr´on,
MA2, Alexis Allot, PhD1, Wai T. Wong, MD2, Emily Y. Chew, MD2,∗, Zhiyong Lu, PhD1,∗
1. National Center for Biotechnology Information (NCBI), National Library of Medicine (NLM),
National Institutes of Health (NIH), Bethesda, Maryland, United States;
2. National Eye Institute (NEI), National Institutes of Health (NIH), Bethesda, Maryland, United
States;
† These authors contributed equally to this work.
* To whom correspondence should be addressed: echew@nei.nih.gov;
zhiyong.lu@nih.gov.

Abstract

By 2040, age-related macular degeneration (AMD) will affect approximately 288 million people worldwide.
Identifying individuals at high risk of progression to late AMD, the sight-threatening stage, is critical for
clinical actions, including medical interventions and timely monitoring. Although deep learning has shown
promise in diagnosing/screening AMD using color fundus photographs, it remains difﬁcult to predict indi-
viduals risks of late AMD accurately. For both tasks, these initial deep learning attempts have remained
largely unvalidated in independent cohorts. Here, we demonstrate how deep learning and survival analysis
can predict the probability of progression to late AMD using 3,298 participants (over 80,000 images) from
the Age-Related Eye Disease Studies AREDS and AREDS2, the largest longitudinal clinical trials in AMD.
When validated against an independent test dataset of 601 participants, our model achieved high prognostic
accuracy (ﬁve-year C-statistic 86.4 (95% conﬁdence interval 86.2-86.6)) that substantially exceeded that of
retinal specialists using two existing clinical standards (81.3 (81.1-81.5) and 82.0 (81.8-82.3), respectively).
Interestingly, our approach offers additional strengths over the existing clinical standards in AMD prognosis
(e.g., risk ascertainment above 50%) and is likely to be highly generalizable, given the breadth of training
data from 82 US retinal specialty clinics. Indeed, during external validation through training on AREDS and
testing on AREDS2 as an independent cohort, our model retained substantially higher prognostic accuracy
than existing clinical standards. These results highlight the potential of deep learning systems to enhance
clinical decision-making in AMD patients.
Keywords
AMD, Deep Learning, Survival Analysis, Progression Prediction

Introduction

Age-related macular degeneration (AMD) is the leading cause of legal blindness in developed countries.1
Through global demographic changes, the number of people with AMD worldwide is projected to reach 288
million by 2040.2 The disease is classiﬁed into early, intermediate, and late stages.3 Late AMD, the stage
associated with severe visual loss, occurs in two forms, geographic atrophy (GA) and neovascular AMD
(NV). Making accurate time-based predictions of progression to late AMD is clinically critical. This would
enable improved decision-making regarding: (i) medical treatments, especially oral supplements known to
decrease progression risk, (ii) lifestyle interventions, particularly smoking cessation and dietary changes,

1

 
 
 
 
 
 
and (iii) intensity of patient monitoring, e.g., frequent reimaging in clinic and/or tailored home monitoring
programs.4–8 It would also aid the design of future clinical trials, which could be enriched for participants
with a high risk of progression events.9

Color fundus photography (CFP) is the most widespread and accessible retinal imaging modality used
worldwide; it is the most highly validated imaging modality for AMD classiﬁcation and prediction of pro-
gression to late disease.10, 11 Currently, two existing standards are available clinically for using CFP to predict
the risk of progression. However, both of these were developed using data from the AREDS only; now, an
expanded dataset with more progression events is available following the completion of the AREDS2.5 Of
the two existing standards, the most commonly used is the ﬁve-step Simpliﬁed Severity Scale (SSS).10 This
is a points-based system whereby an examining physician scores the presence of two AMD features (macular
drusen and pigmentary abnormalities) in both eyes of an individual. From the total score of 0-4, a ﬁve-year
risk of late AMD is then estimated. The other standard is an online risk calculator.12 Like the SSS, its in-
puts include the presence of macular drusen and pigmentary abnormalities; however, it can also receive the
individuals age, smoking status, and basic genotype information consisting of two SNPs (when available).
Unlike the SSS system, the online risk calculator predicts the risk of progression to late AMD, GA, and NV
at 1-10 years.

Both existing clinical standards face limitations. First, the ascertainment of the SSS features from CFP
or clinical examination requires signiﬁcant clinical expertise, typical in retinal specialists, but remains time-
consuming and error-prone,13 even when performed by expert graders in a reading center.11 Second, the SSS
relies on two hand-crafted features and cannot receive other potentially risk-determining features. Recent
work applying deep learning (DL)14 has shown promise in the automated diagnosis and triage of conditions
including cardiac, pediatric, dermatological, and retinal diseases,13, 15–26 but not in predicting the risk of
AMD progression on a large scale or at the patient level.27 Speciﬁcally, Burlina et al reported on the use
of DL for estimating the AREDS 9-step severity grades of individual eyes, based on CFP in the AREDS
dataset.?, 27, 29 However, this approach relied on previously published 5-year risk estimates at the severity
class level,30 rather than using the ground truth of actual progression/non-progression at the level of indi-
vidual eyes, or the timing and subtype of any progression events. In addition, no external validation using
an independent dataset was performed in that study. Babenko et al. proposed a model to predict risk of
progression to neovascular AMD only (i.e. not late AMD or GA).? Importantly, the model was designed to
predict 1-year risks only, i.e. at one ﬁxed and very short interval only. Schmidt-Erfurth et al. proposed to use
OCT images to predict progression to late AMD.29 Speciﬁcally, they used a dataset (495 eyes, containing
only 159 eyes that progressed to late AMD) with follow-up of 2 years. Their dataset was annotated by two
retinal specialists (rather than uniﬁed grading by reading center experts using a published protocol).

Here, we developed a DL architecture to predict progression with improved accuracy and transparency
in two steps: image classiﬁcation followed by survival analysis (Figure 1). The model is developed and
clinically validated on two datasets from the Age-Related Eye Disease Studies (AREDS31 and AREDS232),
the largest longitudinal clinical trials in AMD (Figure 2). The framework and datasets are described in detail
in the Methods section.

Our framework has several important strengths. First, it performs progression predictions directly from
CFP over a wide time interval (1-12 years). Second, training and testing were based on the ground truth
of reading center-graded progression events at the level of individuals. Both training and testing beneﬁtted
from an expanded dataset with many more progression events, achieved by using data from the AREDS2
alongside AREDS, for the ﬁrst time in DL studies. Third, our framework can predict the risk not only
of late AMD, but also of GA and NV separately. This is important since treatment approaches for the two
subtypes of late AMD are very different: NV needs to be diagnosed extremely promptly, since delay in access

2

Figure 1: The two-step architecture of the framework. (a) Raw color fundus photographs (CFP; ﬁeld
2, i.e., 30° imaging ﬁeld centered at the fovea).
(b) Deep classiﬁcation network, trained with CFP (all
manually graded by reading center human experts). (c) Resulting deep features or deep learning grading. (d)
Survival model, trained with imaging data and participant demographic information, with/without genotype
information: ARMS2 rs10490924, CFH rs1061170, and 52-SNP Genetic Risk Score. (e) Late age-related
macular degeneration survival probability.

Figure 2: Creation of the study data sets. To avoid cross-contamination between the training and test
datasets, no participant was in more than one group.

3

Color fundus photographs from both eyes Over 80,000 manually annotated images in AREDS/AREDS2DemographicsGenotypeabClassification networkde3,298 participants with demographics and genotypic information.Survival model…………c1.Deep features2.Deep learning grading scores of drusen and pigmentary abnormalities of both eyes4,203potentially eligible participantsAREDS8,960potentially eligible participantsExcluded1.late AMD in either eye at baseline 2.genotype not available 3.not fully graded by reading center / retinal specialists3,298eligible participantsAREDS:   2,177 participantsAREDS2: 1,121 participants2,364participantsAREDS:   1,580 participantsAREDS2:    784 participantsAREDS24,757potentially eligible participants333participantsAREDS:   221 participantsAREDS2: 112 participants601participantsAREDS:   376 participantsAREDS2: 225 participantsTraining setDevelopment setTest setTable 1: Characteristics of AREDS and AREDS2 participants. The AREDS contained a wide spectrum of
baseline disease severity, from no age-related macular degeneration (AMD) to high-risk intermediate AMD.
The AREDS2 contained a high level of baseline disease severity, i.e., high proportion of eyes at high risk of
progression to late AMD.

Characteristicss

AREDSs

AREDS2

Participants characteristics
Number of participants
Age, mean (SD), y
Smoking history (never, former, current), %
CFH rs1061170 (TT/CT/CC), %
ARMS2 rs10490924 (GG/GT/TT), %
AMD Genetic Risk Score, mean (SD)
Follow-up, Median (IQR), y

Progression to late AMD (classiﬁed by Reading Center)

Late AMD: % of participants at year 1/2/3/4/5/all years
GA: % of participants at year 1/2/3/4/5/all years
NV: % of participants at year 1/2/3/4/5/all years

2,177
68.4 (4.8)
49.6/45.6/4.8
33.3/46.4/20.3
55.2/36.5/8.3
14.2 (1.4)
10.0 (3.0)

1,121
70.9 (7.9)
45.9/48.5/5.5
17.8/41.7/40.5
40.5/42.8/16.7
15.2 (1.3)
5.0 (2.0)

1.5/3.9/6.68/8.6/10.7/18.5
0.6/1.5/2.8/4.0/5.1/10.1
0.9/2.4/4.0/4.6/5.5/8.4

9.1/16.2/23.8/32.6/38.1/38.8
4.8/9.0/13.0/17.8/20.8/21.0
4.3/7.2/10.8/14.7/17.3/17.8

SD - standard deviation. y - year. IQR - interquartile range. AMD - Age-related Macular Degeneration.

to intravitreal anti-VEGF injections is usually associated with very poor visual outcomes,33 while various
therapeutic options to slow GA enlargement are under investigation.34, 35 Finally, the two-step approach has
important advantages. By separating the DL extraction of retinal features from the survival analysis, the
ﬁnal predictions are more explainable and biologically plausible, and error analysis is possible. By contrast,
end-to-end black-box DL approaches are less transparent and may be more susceptible to failure.36

Results

Deep learning models trained on the combined AREDS/AREDS2 training sets and validated on the
combined AREDS/AREDS2 test sets

The characteristics of the participants are shown in Table 1. The characteristics of the images are shown in
Supplementary Table S1. The overall framework of our method is shown in Figure 1 and described in detail
in the Methods section. In short, ﬁrst, a deep convolutional neural network (CNN) was adapted to (i) extract
multiple highly discriminative deep features, or (ii) estimate grades for drusen and pigmentary abnormalities
(Figure 1 b to c). Second, a Cox proportional hazards model was used to predict probability of progression
to late AMD (and GA/NV, separately), based on the deep features (deep features/survival) or the DL grading
(DL grading/survival) (Figure 1 d and e). In this step, additional participant information could be added, such
as age, smoking status, and genetics. Separately, all of the baseline images in the test set were graded by
88 (AREDS) and 192 (AREDS2) retinal specialists. By using these grades as input to either the SSS or the
online calculator, we computed the prediction results of the two existing standards: retinal specialists/SSS
and retinal specialists/calculator.

The prediction accuracy of the approaches was compared using the ﬁve-year C-statistic as the primary
outcome measure. The ﬁve-year C-statistic of the two DL approaches met and substantially exceeded
that of both existing standards (Table 2). For predictions of progression to late AMD, the ﬁve-year C-
statistic was 86.4 (95% conﬁdence interval 86.2-86.6) for deep features/survival, 85.1 (85.0-85.3) for DL

4

Table 2: The C-statistic (95% conﬁdence interval) of the survival models in predicting risk of progression to
late age-related macular degeneration on the combined AREDS/AREDS2 test sets (601 participants).

Models

Late AMD

1

2

3

4

5

All years

Deep features/survival
DL grading/survival
Retinal specialists/calculator
Retinal specialists/SSS

87.8(87.5,88.1)
84.9(84.6,85.3)
-
-

85.8(85.4,86.2)
84.1(83.8,84.4)
78.3(77.9,78.8)
-

86.3(86.1,86.6)
84.8(84.5,85.0)
81.8(81.5,82.1)
-

86.7(86.5,86.9)
84.8(84.6,85.0)
82.7(82.4,82.9)
-

86.4(86.2,86.6)
85.1(85.0,85.3)
82.0(81.8,82.3)
81.3(81.1,81.5)

86.7(86.5,86.8)
84.9(84.6,85.3)
-
-

Geographic atrophy

Deep features/survival
DL grading/survival
Retinal specialists/calculator
Retinal specialists/SSS

89.2(88.9,89.6)
88.6(88.3,88.9)
-
-

91.0(90.7,91.2)
86.6(86.4,86.9)
77.5(76.9,78.0)
-

88.7(88.4,88.9)
87.6(87.4,87.9)
81.2(80.8,81.6)
-

89.1(88.9,89.3)
88.1(87.9,88.3)
82.0(81.6,82.3)
-

89.6(89.4,89.8)
87.8(87.6,88.0)
82.6(82.3,82.9)
-

89.2(89.1,89.4)
88.6(88.3,88.9)
-
-

Neovascular AMD

Deep features/survival
DL grading/survival
Retinal specialists/calculator
Retinal specialists/SSS1

85.4(84.9,85.9)
78.0(77.4,78.6)
-
-

77.9(77.3,78.5)
78.4(77.9,78.9)
75.5(74.8,76.2)
-

81.7(81.3,82.1)
79.2(78.8,79.6)
81.7(81.2,82.1)
-

81.7(81.4,82.1)
79.0(78.7,79.4)
81.4(81.0,81.8)
-

81.1(80.8,81.4)
80.2(79.8,80.5)
80.0(79.7,80.4)
-

82.1(81.8,82.4)
78.0(77.4,78.6)
-
-

Retinal specialists/SSS makes predictions at one ﬁxed interval of ﬁve years and for late AMD only (i.e., not by disease
subtype); unlike all other models, for SSS, late AMD is deﬁned as NV or central GA (instead of NV or any GA);
Please refer to the Supplementary Table S2 for results using genotype information, and Supplementary Table S3 for
multivariate analysis. AMD - age-related macular degeneration; DL - deep learning; SSS - Simpliﬁed Severity Scale.

grading/survival, 82.0 (81.8-82.3) for retinal specialists/calculator, and 81.3 (81.1-81.5) for retinal special-
ists/SSS. For predictions of progression to GA, the equivalent results were 89.6 (89.4-89.8), 87.8 (87.6-88.0),
and 82.6 (82.3-82.9), respectively; these are not available for retinal specialists/SSS, since the SSS does not
make separate predictions for GA or NV. For predictions of progression to NV, the equivalent results were
81.1 (80.8-81.4), 80.2 (79.8-80.5), and 80.0 (79.7-80.4), respectively.

Similarly, for predictions at 1-4 years, the C-statistic was higher in all cases for the two DL approaches
than the retinal specialists/calculator approach. Of the two DL approaches, the C-statistics of deep fea-
tures/survival were higher in most cases than those of DL grading/survival. Predictions at these time intervals
were not available for retinal specialists/SSS, since the SSS does not make predictions at any interval other
than ﬁve years. Regarding the separate predictions of progression to GA and NV, deep features/survival also
provided the most accurate predictions at most time intervals. Overall, DL-based image analysis provided
more accurate predictions than those from retinal specialist grading using the two existing standards. For
deep feature extraction, this may reﬂect the fact that DL is unconstrained by current medical knowledge and
not limited to two hand-crafted features.

In addition, the prediction calibrations were compared using the Brier score (Figure 3). For ﬁve-year
predictions of late AMD, the Brier score was lowest (i.e., optimal) for deep features/survival. We also
split the data into 5 groups based on the AREDS SSS at baseline. We compared calibration plots for deep
features/survival, DL grading/survival, and retinal specialist/survival with the actual progression data for
the 5 groups (Supplement Figure S1). The actual progression data for the ﬁve groups are shown in lines
(KaplanMeier curves) and the predictions of our models are shown in lines with markers. The ﬁgure shows
that the predictions of the deep features/survival model correspond better to the actual progression data than
those of the other two models.

5

Figure 3: Prediction error curves. Prediction error curves of the survival models in predicting risk of
progression to late age-related macular degeneration on the combined AREDS/AREDS2 test sets (601 par-
ticipants), using the Brier score (95% conﬁdence interval).

Deep learning models trained separately on individual cohorts (either AREDS or AREDS2) and
validated on the combined AREDS/AREDS2 test sets

Models trained on the combined AREDS/AREDS2 cohort (Table 2) were substantially more accurate than
those trained on either individual cohort (Table 3), with the additional advantage of improved generalizabil-
ity. Indeed, one challenge of DL has been that generalizability to populations outside the training set can
be variable. In this instance, the widely distributed sites and diverse clinical settings of AREDS/AREDS2
participants, together with the variety of CFP cameras used, help provide some assurance of broader gener-
alizability.

Deep learning models trained on AREDS and externally validated on AREDS2 as an independent
cohort

In separate experiments, to externally validate the models on an independent dataset, we trained the mod-
els on AREDS (2,177 participants) and tested them on AREDS2 (1,121 participants). Table 4 shows that
deep features/survival demonstrated the highest accuracy of ﬁve-year predictions in all scenarios, and DL
grading/survival also had higher accuracy than retinal specialists/calculator.

Survival models with additional input of genotype

For all approaches possible, the predictions were tested with the additional input of genotype (Table 5).
Interestingly, adding the genotype data, even the 52 SNP-based Genetic Risk Score (GRS; see Methods)
available only in rare research contexts,37 did not improve the accuracy for deep features/survival or DL
grading/survival; by contrast, adding just two SNPs (the maximum handled by the calculator) did improve
the accuracy modestly for the retinal specialists/calculator approach. Multivariate analysis (Supplementary
Table S2) demonstrated that deep features/DL grading, age, and AMD GRS contributed signiﬁcantly to the
survival models. The non-reliance of the DL approaches on genotype information favors their accessibil-
ity, as genotype data are typically unavailable for patients currently seen in clinical practice. It suggests

6

0123450.050.100.15Late AMDyearbrier score0123450.020.040.060.080.10GAyearbrier score0123450.020.040.060.08NVyearbrier scoreDeep features/survivalDL grading/survivalRetinal specialists/calculatorRetinal specialists/SSSTable 3: The 5-year C-statistic (95% CI) results of models trained on only AREDS or only AREDS2, and
validated on the combined AREDS/AREDS2 test sets (601 participants), without using genotype informa-
tion.

Models

Late AMD

Trained on AREDS Trained on AREDS2

Deep features/survival
DL grading/survival

85.7 (85.5, 85.9)
84.7 (84.5, 84.9)

83.9 (83.7, 84.1)
82.1 (81.8, 82.3)

Geographic atrophy

Deep features/survival
DL grading/survival

89.3 (89.1, 89.5)
90.2 (90.0, 90.4)

84.7 (84.4, 85.0)
85.2 (84.9, 85.5)

Neovascular AMD

Deep features/survival
DL grading/survival

79.6 (79.3, 80.0)
76.6 (76.2, 76.9)

74.0 (73.6, 74.5)
75.5 (75.1, 75.9)

Table 4: The 5-year C-statistic (95% CI) results of models trained on the entire AREDS and tested on the
entire AREDS2 (1,121 participants), without using genotype information.

Models

Late AMD

Deep features/survival
DL grading/survival
Retinal specialists/calculator
Retinal specialists/SSS1

Geographic atrophy

Deep features/survival
DL grading/survival
Retinal specialists/calculator
Retinal specialists/SSS

Neovascular AMD

Deep features/survival
DL grading/survival
Retinal specialists/calculator
Retinal specialists/SSS1

Tested on the entire AREDS2

71.0 (70.2, 71.7)
69.7 (68.9, 70.5)
63.9 (63.2, 64.6)
62.5 (62.3, 62.7)

75.3 (74.5, 76.0)
75.0 (74.0, 76.0)
64.4 (63.6, 65.2)
-

62.8 (61.9, 63.8)
61.8 (61.0, 62.7)
61.8 (60.8, 62.9)
-

Retinal specialists/SSS makes predictions at one ﬁxed interval of ﬁve years and for late AMD only (i.e., not
by disease subtype); unlike all other models, for SSS, late AMD is deﬁned as NV or central GA (instead of
NV or any GA);

7

Table 5: The accuracy (C-statistic, 95% conﬁdence interval) of the three different approaches in predicting
risk of progression to late AMD on the combined AREDS/AREDS2 test sets (601 participants), with the
inclusion of accompanying genotype information. a, Use of CFH rs1061170 and ARMS2 rs10490924 status
only. b, use of CFH/ARMS2 and the 52 SNP-based AMD Genetic Risk Score. The AMD online calculator
is able to receive only CFH rs1061170 and ARMS2 rs10490924 status, not the 52 SNP-based AMD Genetic
Risk Score.

a

b

Models

Late AMD

1

2

3

4

5

All years

Deep features/survival
DL grading/survival
Retinal specialists/calculator

88.8(88.0,89.7) 85.4(84.4,86.4)
89.4(88.2,90.6) 83.8(82.4,85.1)
78.7(78.3,79.1)

-

86.1(85.2,86.9)
84.0(83.0,85.1)
82.4(82.1,82.7)

86.9(86.1,87.6)
85.0(84.2,85.8)
83.6(83.3,83.8)

86.6(85.8,87.4)
84.9(84.2,85.6)
83.1(82.8,83.3)

86.8(86.1,87.6)
85.5(84.9,86.2)
-

Geographic atrophy

Deep features/survival
DL grading/survival
Retinal specialists/calculator

89.5(88.4,90.5) 90.7(89.9,91.5)
87.0(86.0,88.0) 86.5(85.6,87.5)
77.6(77.1,78.1)

-

88.6(87.3,89.8)
85.9(85.0,86.8)
81.8(81.5,82.2)

89.0(88.0,89.9)
87.0(86.3,87.7)
83.0(82.7,83.3)

89.5(88.7,90.3)
87.6(87.0,88.2)
83.2(83.0,83.5)

89.4(88.7,90.2)
87.5(87.0,88.0)
-

Neovascular AMD

Deep features/survival
DL grading/survival
Retinal specialists/calculator

85.8(84.6,87.0) 79.1(77.0,81.2)
87.3(86.3,88.3) 77.3(75.1,79.5)
77.3(76.6,77.9)

-

81.9(80.6,83.3)
77.3(75.6,79.0)
82.0(81.5,82.4)

82.4(81.2,83.6)
78.7(77.1,80.2)
82.4(82.1,82.8)

81.7(80.7,82.7)
78.8(77.4,80.1)
80.9(80.6,81.3)

82.6(81.7,83.5)
80.0(78.8,81.3)
-

Models

Late AMD

1

2

3

4

5

All years

Deep features/survival
DL grading/survival

87.9(87.6,88.2)
84.2(83.8,84.6)

84.8(84.4,85.2)
84.3(84.0,84.6)

85.9(85.6,86.2)
84.9(84.7,85.2)

86.2(86.0,86.4)
84.9(84.7,85.1)

86.0(85.8,86.2)
85.4(85.2,85.6)

86.4(86.2,86.6)
84.2(83.8,84.6)

Geographic atrophy

Deep features/survival
DL grading/survival

89.9(89.6,90.1)
87.0(86.6,87.3)

90.1(89.8,90.4)
86.2(85.9,86.5)

88.5(88.2,88.8)
86.7(86.5,87.0)

88.5(88.2,88.7)
87.1(86.9,87.3)

89.0(88.8,89.2)
87.0(86.8,87.2)

88.7(88.5,88.9)
87.0(86.6,87.3)

Neovascular AMD

Deep features/survival
DL grading/survival

83.7(83.2,84.2)
77.6(77.0,78.3)

77.6(77.0,78.3)
78.7(78.2,79.2)

81.5(81.0,81.9)
79.9(79.5,80.3)

81.9(81.6,82.3)
79.9(79.5,80.2)

81.3(80.9,81.6)
81.0(80.7,81.4)

82.3(82.1,82.6)
77.6(77.0,78.3)

that adding genotype information may partially compensate for the inferior accuracy obtained from human
gradings, but contributes little to the accuracy of DL approaches, particularly deep feature extraction.

Research software prototype for AMD progression prediction

To demonstrate how these algorithms could be used in practice, we developed a software prototype that al-
lows researchers to test our model with their own data. The application (shown in Figure 4) receives bilateral
CFP and performs autonomous AMD classiﬁcation and risk prediction. For transparency, the researcher is
given (i) grading of drusen and pigmentary abnormalities, (ii) predicted SSS, and (iii) estimated risks of late
AMD, GA, and NV, over 1-12 years. This approach allows improved transparency and ﬂexibility: users
may inspect the automated gradings, manually adjust these if necessary, and recalculate the progression
risks. Following further validation, this software tool may potentially augment human research and clinical
practice.

8

Figure 4: A screenshot of our research prototype system for AMD risk prediction. (a) Screenshot of
late AMD risk prediction. 1, Upload bilateral color fundus photographs. 2, Based on the uploaded images,
the following information is automatically generated separately for each eye: drusen size status, pigmentary
abnormality presence/absence, late AMD presence/absence, and the Simpliﬁed Severity Scale score. 3, Enter
the demographic and (if available) genotype information, and the time point for prediction. 4, The probability
of progression to late AMD (in either eye) is automatically calculated, along with separate probabilities of
geographic atrophy and neovascular AMD. (b) Four selected color fundus photographs with highlighted
areas used by the deep learning classiﬁcation network (DeepSeeNet). Saliency maps were used to represent
the visually dominant location (drusen or pigmentary changes) in the image by back-projecting the last layer
of neural network.

9

1234abDiscussion

We developed, trained, and validated a framework for predicting individual risk of late AMD by combining
DL and survival analysis. This approach delivers autonomous predictions of a higher accuracy than those
from retinal specialists using two existing clinical standards. Hence, the predictions are closer to the ground
truth of actual time-based progression to late AMD than when retinal specialists are grading the same bilat-
eral CFP and entering these grades into the SSS or the online calculator. In addition, deep feature extraction
generally achieved slightly higher accuracy than DL grading of traditional hand-crafted features.

Table 4 shows that the C-statistic values were lower for AREDS2, as expected, since the majority of its
participants were at higher risk of progression;38 though more difﬁcult, predicting progression for AREDS2
participants is more representative of a clinically meaningful task. When compared to the results in Table 2,
the accuracy of our models decreased less than retinal specialists/calculator and retinal specialists/SSS. This
demonstrates the relative generalizability of our models. Furthermore, this suggests the ability of deep
features/survival to differentiate individuals with relatively similar SSS more accurately than existing clinical
standards (since nearly all AREDS2 participants had SSS ≤2 at baseline). It is also worth noting that it
was possible to improve further the performance of our models on the AREDS2 dataset, if the models had
been modiﬁed to accommodate the unique characteristics of the AREDS2. Since the AREDS is enriched for
participants with milder baseline AMD severity, it may be possible to improve the performance of our models
on the AREDS2 dataset by either training the models on progressors only or decreasing the prevalence of
non-progressors. However, for fair comparisons to other results in this study, we kept our models unchanged.
In addition, unlike the SSS, whose ﬁve-year risk prediction becomes saturated at 50%10, the DL models
enable ascertainment of risk above 50%. This may be helpful in justifying medical and lifestyle interven-
tions,4, 5, 8 vigilant home monitoring,6, 7 and frequent reimaging,33 and in planning shorter but highly powered
clinical trials.9 For example, the AREDS-style oral supplements decrease the risk of developing late AMD by
approximately 25%, but only in individuals at higher risk of disease progression.4, 5 Similarly, if subthresh-
old nanosecond laser treatment is approved to slow progression to late AMD8, accurate risk predictions may
be very helpful for identifying eyes that may beneﬁt most.

Considering that the DL grading model is better at detecting drusen and pigmentary changes, we also
took the grades from the DL grading model and used these as input to the SSS and the Casey calculator, to
generate predictions (Supplementary Table S3). We found that the accuracy of the predictions was higher
when using the grades from the DL grading than from the retinal specialists. Hence, it is the combination of
the DL grading and the survival approach that provides accurate and automated predictions.

In addition, we compared C-statistic results on three DL models: nnet-survival,39 DeepSurv,40 and
CoxPH (Supplementary Table S4). CoxPH had the best calibration performance using either the deep fea-
tures or DL grading, though the differences were fairly small.

For all approaches, the accuracy was substantially higher for predictions of GA than NV. The DL-based
approaches improved accuracy for both subtypes, but, for NV, insufﬁciently to reach that obtained for GA.
Potential explanations include the partially stochastic nature of NV and/or higher suitability of predicting
GA from en face imaging.

Error analysis (i.e., examining the reasons behind inaccurate predictions) was facilitated more easily by
our two-step architecture, unlike in end-to-end, black-box DL approaches. This revealed that the survival
model accounted for most errors, since (i) classiﬁcation network accuracy was relatively high (Supplemen-
tary Figure S2), and (ii) when perfect classiﬁcation results (i.e., taken from the ground truth) were used as
input to the survival model, the ﬁve-year C-statistic of DL grading/survival on late AMD improved only
slightly, from 85.1 (85.0,85.3) to 85.8 (85.6-86.0). Supplementary Figure S3 demonstrates two example
cases of progression. In the ﬁrst case, both participants were the same age (73 years) and had the same

10

smoking history (current), and AREDS SSS scores (4) at baseline. The retinal specialist graded the SSS
correctly. However, participant 1 progressed to late AMD at year 2 (any GA at right eye), but participant 2
progressed to late AMD at year 5 (any GA at left eye). Hence, both the retinal specialist/calculator and reti-
nal specialist/SSS approaches incorrectly assigned the same risk of progression to both participants (0.413).
However, the deep feature/survival approach correctly assigned a higher risk of progression to participant 1
(0.751) and a lower risk to participant 2 (0.591). In the second case, both participants were the same age
(73 years) and had the same smoking history (former). Their AREDS SSS scores at baseline were 3 and 4,
respectively. The retinal specialist graded the SSS correctly. However, participant 3 progressed to late AMD
at year 2 (NV at right eye), while participant 4 had still not progressed to late AMD by ﬁnal follow-up at year
11. Hence, both the retinal specialist/calculator and retinal specialist/SSS approaches incorrectly assigned
a lower risk of progression to participant 3 (0.259) and a higher risk to participant 4 (0.413). However, the
deep feature/survival approach correctly assigned a higher risk of progression to participant 4 and a lower
risk to participant 3 (0.569 vs 0.528).

The strengths of the study include the application of combining DL image analysis and deep feature ex-
traction with survival analysis to retinal disease. Survival analysis has been used widely in AMD progression
research;4, 38 in this study, it made best use of the data, speciﬁcally the timing and nature of any progression
events at the individual level. Deep feature extraction has the advantages that the model is unconstrained
by current medical knowledge and not limited to two features. It allows the model to learn de novo what
features are most highly predictive of time-based progression events, and to develop multiple (e.g., 5, 10, or
more) predictive features. Unlike shallow features that appear early in CNNs, deep features are potentially
complex and high-order features, and might even be relatively invisible to the human eye. However, one
limitation of deep feature extraction is that predictions based on these features may be less explainable and
biologically plausible, and less amenable to error analysis, than those based on DL grading of traditional risk
features.36 Additional strengths include the use of two well-characterized cohorts, with detailed time-based
knowledge of progression events at the reading center standard. By pooling AREDS and AREDS2 (which
has not been used previously in DL studies), we were able to construct a cohort that had a wide spectrum
of AMD severity but was enriched for cases of higher baseline severity. In addition, in other experiments,
keeping the datasets separate enabled us to perform external validation using AREDS2 as an independent
cohort.

In terms of limitations, as in the two existing clinical standards, AREDS/AREDS2 treatment assignment
was not considered in this analysis10,12. Since most AREDS/AREDS2 participants were assigned to oral
supplements that decreased risk of late AMD, the risk estimates obtained are closer to those for individuals
receiving supplements. However, this seems appropriate, given that AREDS-style supplements are consid-
ered the standard of care for patients with intermediate AMD.33 Another limitation is that this work relates
to CFP only. DL approaches to optical coherence tomography (OCT) datasets hold promise for AMD diag-
nosis,41, 42 but no highly validated OCT-based tools exist for risk prediction. In the future, we plan to apply
our framework to multi-modal imaging, including fundus autoﬂuorescence and OCT data.

In conclusion, combining DL feature extraction of CFP with survival analysis achieved high prognostic
accuracy in predictions of progression to late AMD, and its subtypes, over a wide time interval (1-12 years).
Not only did its accuracy meet and surpass existing clinical standards, but additional strengths in clinical
settings include risk ascertainment above 50% and without genotype data.

11

Methods

Datasets

For model development and clinical validation, two datasets were used: the AREDS31 and the AREDS232
(Figure 2). The AREDS was a 12-year multi-center prospective cohort study of the clinical course, prog-
nosis, and risk factors of AMD, as well as a phase III randomized clinical trial (RCT) to assess the effects
of nutritional supplements on AMD progression.31 In short, 4,757 participants aged 55 to 80 years were
recruited between 1992 and 1998 at 11 retinal specialty clinics in the United States. The inclusion criteria
were wide, from no AMD in either eye to late AMD in one eye. The participants were randomly assigned to
placebo, antioxidants, zinc, or the combination of antioxidants and zinc. The AREDS dataset is publicly ac-
cessible to researchers by request at dbGAP (https://www.ncbi.nlm.nih.gov/projects/gap/
cgi-bin/study.cgi?study_id=phs000001.v3.p1).

Similarly, the AREDS2 was a multi-center phase III RCT that analyzed the effects of different nutritional
supplements on the course of AMD32. 4,203 participants aged 50 to 85 years were recruited between 2006
and 2008 at 82 retinal specialty clinics in the United States. The inclusion criteria were the presence of
either bilateral large drusen or late AMD in one eye and large drusen in the fellow eye. The participants
were randomly assigned to placebo, lutein/zeaxanthin, docosahexaenoic acid (DHA) plus eicosapentaenoic
acid (EPA), or the combination of lutein/zeaxanthin and DHA plus EPA. AREDS supplements were also
administered to all AREDS2 participants, because they were by then considered the standard of care.33 We
will make the AREDS2 dataset publicly accessible upon publication.

In both studies, the primary outcome measure was the development of late AMD, deﬁned as neovascular
AMD or central GA. Institutional review board approval was obtained at each clinical site and written in-
formed consent for the research was obtained from all study participants. The research was conducted under
the Declaration of Helsinki and, for the AREDS2, complied with the Health Insurance Portability and Ac-
cessibility Act. For both studies, at baseline and annual study visits, comprehensive eye examinations were
performed by certiﬁed study personnel using a standardized protocol, and CFP (ﬁeld 2, i.e., 30° imaging
ﬁeld centered at the fovea) were captured by certiﬁed technicians using a standardized imaging protocol.
Progression to late AMD was deﬁned by the study protocol based on the grading of CFP,31, 32 as described
below.

As part of the studies, 2,889 (AREDS) and 1,826 (AREDS2) participants consented to genotype analysis.
SNPs were analyzed using a custom Illumina HumanCoreExome array.37 For the current analysis, two SNPs
(CFH rs1061170 and ARMS2 rs10490924, at the two loci with the highest attributable risk of late AMD),
were selected, as these are the two SNPs available as input for the existing online calculator system. In
addition, the AMD GRS was calculated for each participant according to methods described previously.37
The GRS is a weighted risk score based on 52 independent variants at 34 loci identiﬁed in a large genome-
wide association study37 as having signiﬁcant associations with risk of late AMD. The online calculator
cannot receive this detailed information.

The eligibility criteria for participant inclusion in the current analysis were: (i) absence of late AMD
(deﬁned as NV or any GA) at study baseline in either eye, since the predictions were made at the participant
level, and (ii) presence of genetic information (in order to compare model performance with and without
genetic information on exactly the same cohort of participants). Accordingly, the images used for the pre-
dictions were those from the study baselines only.

In the AREDS dataset of CFPs, information on image laterality (i.e., left or right eye) and ﬁeld status
(ﬁeld 1, 2, or 3) were available from the Reading Center. However, these were not available in the AREDS2
dataset of CFPs. We therefore trained two Inception-v3 models, one for classifying laterality and the other

12

for identifying ﬁeld 2 images. Both models were ﬁrst trained on the gold standard images from the AREDS
and ﬁne-tuned on a newly created gold standard AREDS2 set manually graded by a retinal specialist (TK).
The AREDS2 gold standard consisted of 40 participants with 5,164 images (4,097 for training and 1,067 for
validation). The models achieved 100% accuracy for laterality classiﬁcation and 97.9% accuracy (F1-score
0.971, precision 0.968, recall 0.973) for ﬁeld 2 classiﬁcation.

Gold standard grading

The ground truth labels used for both training and testing were the grades previously assigned to each CFP
by expert human graders at the University of Wisconsin Fundus Photograph Reading Center. The reading
center workﬂow has been described previously.30
In brief, a senior grader performed initial grading of
each photograph for AMD severity using a 4-step scale and a junior grader performed detailed grading
for multiple AMD-speciﬁc features. All photographs were graded independently and without access to the
clinical information. A rigorous process of grading quality control was performed at the reading center,
including assessment for inter-grader and intra-grader agreement.30 The reading center grading features
relevant to the current study, aside from late AMD, were: (i) macular drusen status (none/small, medium
(diameter ≤63m and <125m), and large (≤125m)), and (ii) macular pigmentary abnormalities related to
AMD (present or absent).

In addition to undergoing reading center grading, the images at the study baseline were also assessed
(separately and independently) by 88 retinal specialists in AREDS and 196 retinal specialists in AREDS2.
The responses of the retinal specialists were used not as the ground truth, but for comparisons between
human grading as performed in routine clinical practice and DL-based grading. By applying these retinal
specialist grades as input to the two existing clinical standards for predicting progression to late AMD, it was
possible to compare the current clinical standard of human predictions with those predictions achievable by
DL.

Development of the algorithm

The overall framework of our method is shown in Figure 1. First, a CNN was adapted to (i) extract multiple
highly discriminative deep features, or (ii) estimate grades for drusen and pigmentary abnormalities (Figure 1
a to c). Second, a Cox proportional hazards model was used to predict probability of progression to late
AMD (and GA/NV, separately), based on the deep features (deep features/survival) or the DL grading (DL
grading/survival) (Figure 1 e and e). In this step, additional participant information could be added, such as
age, smoking status, and genetics.

As the ﬁrst stage in the workﬂow, the DL-based image analysis was performed using two different adap-
tations of DeepSeeNet.13 DeepSeeNet is a CNN framework that was created for AMD severity classiﬁcation.
It has achieved state-of-the-art performance for the automated diagnosis and classiﬁcation of AMD sever-
ity from CFP; this includes the grading of macular drusen, pigmentary abnormalities, the SSS,13 and the
AREDS 9-step severity scale.43 In particular, using reading center grades as the ground truth, we have re-
cently demonstrated that DeepSeeNet performs grading with accuracy that was superior to that of human
retinal specialists (Supplementary Figure S1). The two different adaptations are described here:

Deep features. The ﬁrst adaptation was named deep features. This approach involved using DL to derive
and weight predictive image features, including high-dimensional hidden features.44 Deep features were ex-
tracted from the second to last fully-connected layer of DeepSeeNet (the highlighted part in the classiﬁcation
network in Figure 1). In total, 512 deep features could be extracted for each participant in this way, com-
prising 128 deep features for each of the two models (drusen and pigmentary abnormalities) in each of the

13

two images (left and right eyes). After feature extraction, all 512 deep features were normalized as standard-
scores. Feature selection was required at this point, to avoid overﬁtting and to improve the generalizability,
because of the multi-dimensional nature of the features. Hence, we performed feature selection to group
correlated features and pick one feature for each group.45 Features with non-zero coefﬁcients were selected
and applied as input to the survival models described below.

Deep learning grading. The second adaptation of DeepSeeNet was named DL grading, i.e., referring to
the grading of drusen and pigmentary abnormalities, the two macular features considered by humans most
able to predict progression to late AMD. In this adaptation, the two predicted risk factors were used directly.
In brief, one CNN was previously trained and validated to estimate drusen status in a single CFP, according
to three levels (none/small, medium, or large), using reading center grades as the ground truth.13 A second
CNN was previously trained and validated to predict the presence or absence of pigmentary abnormalities in
a single CFP.

Survival model. The second stage of our workﬂow comprised a Cox proportional hazards model46 to
estimate time to late AMD (Fig1. D and E). The Cox model is used to evaluate simultaneously the effect
of several factors on the probability of the event, i.e., participant progression to late AMD in either eye.
Separate Cox proportional hazards models were created to analyze time to late AMD and time to subtype of
late AMD (i.e., GA and NV). In addition to the image-based information, the survival models could receive
three additional inputs: (i) participant age; (ii) smoking status (current/former/never), and (iii) participant
AMD genotype (CFH rs1061170, ARMS2 rs10490924, and the AMD GRS).

Experimental design

In both of the DeepSeeNet adaptations described, the DL CNNs used Inception-v3 architecture,47 which is
a state-of-the-art CNN for image classiﬁcation; it contains 317 layers, comprising a total of over 21 million
weights that are subject to training. Training was performed using two commonly used libraries: Keras
(https://keras.io) and TensorFlow.48 All images were cropped to generate a square image ﬁeld encompassing
the macula and resized to 512 x 512 pixels. The hyperparameters were learning rate 0.0001 and batch size
32. The training was stopped after 5 epochs once the accuracy on the development set no longer increased.
All experiments were conducted on a server with 32 Intel Xeon CPUs, using a NVIDIA GeForce GTX 1080
Ti 11Gb GPU for training and testing, with 512Gb available in RAM memory. We ﬁtted the Cox proportional
hazard model using the deep features as covariates. Speciﬁcally, we selected the 16 features with the highest
weights (i.e. the features found to be most predictive of progression to late AMD, with their inclusion as
covariates in the Cox model). We performed feature selection using the glmnet package45 in R version 3.5.2
statistical software.

Training and testing

For training and testing our framework, we used both the AREDS and AREDS2 datasets. In the primary
set of experiments, eligible participants from both studies were pooled to create one broad cohort of 3,298
individuals that combined a wide spectrum of baseline disease severity with a high number of progression
events. The combined dataset was split at the participant level in the ratio 70%/10%/20% to create three sets:
2,364 participants (training set), 333 participants (development set), and 601 participants (hold-out test set).
Separately, all of the baseline images in the test set were graded by 88 (AREDS) and 192 (AREDS2)
retinal specialists. By using these grades as input to either the SSS or the online calculator, we computed the
prediction results of the two existing standards: retinal specialists/SSS and retinal specialists/calculator.

For three of the four approaches (deep features/survival, DL grading/survival, and retinal special-

14

ists/calculator), the input was bilateral CFP, participant age, and smoking status; separate experiments were
conducted with and without the additional input of genotype data. For the other approach (retinal special-
ists/SSS), the input was bilateral CFP only.

In addition to the primary set of experiments where eligible participants from the AREDS and AREDS2
were combined to form one dataset, separate experiments were conducted where the DL models were: (i)
trained separately on the AREDS training set only, or the AREDS2 training set only, and tested on the
combined AREDS/AREDS2 test set, and (ii) trained on the AREDS training set only and externally validated
by testing on the AREDS2 test set only.

Statistical analysis

As the primary outcome measure, the performance of the risk prediction models was assessed by the C-
statistic49 at ﬁve years from study baseline. Five years from study baseline was chosen as the interval for the
primary outcome measure since this is the only interval where comparison can be made with the SSS, and
the longest interval where predictions can be tested using the AREDS2 data.

For binary outcomes such as progression to late AMD, the C-statistic represents the area under the
receiver operating characteristic curve (AUC). The C-statistic is computed as follows: all possible pairs of
participants are considered where one participant progressed to late AMD and the other participant in the pair
progressed later or not at all; out of all these pairs, the C-statistic represents the proportion of pairs where the
participant who had been assigned the higher risk score was the one who did progress or progressed earlier.
A C-statistic of 0.5 indicates random predictions, while 1.0 indicates perfectly accurate predictions. We used
200 bootstrap samples to obtain a distribution of the C-statistic and reported 95% conﬁdence intervals. For
each bootstrap iteration, we sampled n patients with replacement from the test set of n patients.

As a secondary outcome measure of performance, we calculated the Brier score from prediction error
curves, following the work of Klein et al.12 The Brier score is deﬁned as the squared distances between
the models predicted probability and actual late AMD, GA, or NV status, where a score of 0.0 indicates a
perfect match. The Wald test was used to assess the statistical signiﬁcance of each factor in the survival
models.50 It corresponds to the ratio of each regression coefﬁcient to its standard error. The survival package
in R version 3.5.2 was used for Cox proportional hazards model evaluation. Finally, saliency maps were
generated to represent the image locations that contributed most to decision-making by the DL models (for
drusen or pigmentary abnormalities). This was done by back-projecting the last layer of the neural network.
The Python package keras-vis was used to generate the saliency map.51

Acknowledgements

The work was supported by the intramural program funds and contracts from the National Center for
Biotechnology Information/National Library of Medicine/National Institutes of Health, the National Eye
Institute/National Institutes of Health, Department of Health and Human Services, Bethesda Maryland (Con-
tract HHS-N-260-2005-00007-C; ADB contract NO1-EY-5-0007; Grant No 4R00LM013001). Funds were
generously contributed to these contracts by the following National Institutes of Health: Ofﬁce of Dietary
Supplements, National Center for Complementary and Alternative Medicine; National Institute on Aging;
National Heart, Lung, and Blood Institute; and National Institute of Neurological Disorders and Stroke.

15

References

[1] Quartilho A, Simkiss P, Zekite A, Xing W, Wormald R, Bunce C. Leading Causes of Certiﬁable Visual
Loss in England and Wales during the Year Ending 31 March 2013. Eye (London, England). 2016
Apr;30(4):602–607.

[2] Wong WL, Su X, Li X, Cheung CMG, Klein R, Cheng CY, et al. Global Prevalence of Age-Related
Macular Degeneration and Disease Burden Projection for 2020 and 2040: A Systematic Review and
Meta-Analysis. The Lancet Global health. 2014 Feb;2(2):e106–e116.

[3] Ferris FL, Wilkinson CP, Bird A, Chakravarthy U, Chew E, Csaky K, et al. Clinical Classiﬁcation of

Age-Related Macular Degeneration. Ophthalmology. 2013;120(4):844–851.

[4] Age-Related Eye Disease Study Research Group. A Randomized, Placebo-Controlled, Clinical Trial of
High-Dose Supplementation with Vitamins C and E, Beta Carotene, and Zinc for Age-Related Macular
Degeneration and Vision Loss: AREDS Report No. 8. Arch Ophthalmol. 2001 Oct;119(10):1417–36.

[5] Age-Related Eye Disease Study 2 Research Group. Lutein + Zeaxanthin and Omega-3 Fatty Acids for
Age-Related Macular Degeneration: The Age-Related Eye Disease Study 2 (AREDS2) Randomized
Clinical Trial. JAMA. 2013 May;309(19):2005–2015.

[6] Domalpally A, Clemons TE, Bressler SB, Danis RP, Elman M, Kim JE, et al. Imaging Characteristics of
Choroidal Neovascular Lesions in the AREDS2-HOME Study: Report Number 4. Ophthalmol Retina.
2019 Apr;3(4):326–335.

[7] Areds Home Study Research Group, Chew EY, Clemons TE, Bressler SB, Elman MJ, Danis RP, et al.
Randomized Trial of a Home Monitoring System for Early Detection of Choroidal Neovascularization
Home Monitoring of the Eye (HOME) Study. Ophthalmology. 2014 Feb;121(2):535–44.

[8] Guymer RH, Wu Z, Hodgson LAB, Caruso E, Brassington KH, Tindill N, et al. Subthreshold Nanosec-
ond Laser Intervention in Age-Related Macular Degeneration: The LEAD Randomized Controlled
Clinical Trial. Ophthalmology. 2019 Jun;126(6):829–838.

[9] Calaprice-Whitty D, Galil K, Salloum W, Zariv A, Jimenez B. Improving Clinical Trial Participant
Prescreening With Artiﬁcial Intelligence (AI): A Comparison of the Results of AI-Assisted vs Standard
Methods in 3 Oncology Trials. Ther Innov Regul Sci. 2019 Jan:2168479018815454.

[10] Ferris FL, Davis MD, Clemons TE, Lee LY, Chew EY, Lindblad AS, et al. A Simpliﬁed Severity Scale
for Age-Related Macular Degeneration: AREDS Report No. 18. Archives of ophthalmology (Chicago,
Ill : 1960). 2005 Nov;123(11):1570–1574.

[11] Davis MD, Gangnon RE, Lee LY, Hubbard LD, Klein BEK, Klein R, et al. The Age-Related Eye
Disease Study Severity Scale for Age-Related Macular Degeneration: AREDS Report No. 17. Archives
of ophthalmology (Chicago, Ill : 1960). 2005 Nov;123(11):1484–1498.

[12] Klein ML, Francis PJ, Ferris FL, Hamon SC, Clemons TE. Risk Assessment Model for Development
of Advanced Age-Related Macular Degeneration. Archives of ophthalmology (Chicago, Ill : 1960).
2011 Dec;129(12):1543–1550.

16

[13] Peng Y, Dharssi S, Chen Q, Keenan TD, Agr´on E, Wong WT, et al. DeepSeeNet: A Deep Learning
Model for Automated Classiﬁcation of Patient-Based Age-Related Macular Degeneration Severity from
Color Fundus Photographs. Ophthalmology. 2018 Nov;126(4):565–575.

[14] Ching T, Himmelstein DS, Beaulieu-Jones BK, Kalinin AA, Do BT, Way GP, et al. Opportunities and
Obstacles for Deep Learning in Biology and Medicine. Journal of the Royal Society, Interface. 2018
Apr;15(141).

[15] Grassmann F, Mengelkamp J, Brandl C, Harsch S, Zimmermann ME, Linkohr B, et al. A Deep Learn-
ing Algorithm for Prediction of Age-Related Eye Disease Study Severity Scale for Age-Related Mac-
ular Degeneration from Color Fundus Photography. Ophthalmology. 2018 Sep;125(9):1410–1420.

[16] Liang H, Tsui BY, Ni H, Valentim CCS, Baxter SL, Liu G, et al. Evaluation and Accurate Diagnoses

of Pediatric Diseases Using Artiﬁcial Intelligence. Nat Med. 2019 Mar;25(3):433–438.

[17] Hannun AY, Rajpurkar P, Haghpanahi M, Tison GH, Bourn C, Turakhia MP, et al. Cardiologist-Level
Arrhythmia Detection and Classiﬁcation in Ambulatory Electrocardiograms Using a Deep Neural Net-
work. Nat Med. 2019 Jan;25(1):65–69.

[18] Gulshan V, Peng L, Coram M, Stumpe MC, Wu D, Narayanaswamy A, et al. Development and Val-
idation of a Deep Learning Algorithm for Detection of Diabetic Retinopathy in Retinal Fundus Pho-
tographs. JAMA. 2016 Dec;316(22):2402–2410.

[19] Poplin R, Varadarajan AV, Blumer K, Liu Y, McConnell MV, Corrado GS, et al. Prediction of Car-
diovascular Risk Factors from Retinal Fundus Photographs via Deep Learning. Nature biomedical
engineering. 2018 Mar;2(3):158–164.

[20] Kermany DS, Goldbaum M, Cai W, Valentim CCS, Liang H, Baxter SL, et al. Identifying Medical Di-
agnoses and Treatable Diseases by Image-Based Deep Learning. Cell. 2018 Feb;172(5):1122–1131.e9.

[21] Esteva A, Kuprel B, Novoa RA, Ko J, Swetter SM, Blau HM, et al. Dermatologist-Level Classiﬁcation

of Skin Cancer with Deep Neural Networks. Nature. 2017 Feb;542(7639):115–118.

[22] Ting DSW, Cheung CYL, Lim G, Tan GSW, Quang ND, Gan A, et al. Development and Validation
of a Deep Learning System for Diabetic Retinopathy and Related Eye Diseases Using Retinal Images
From Multiethnic Populations With Diabetes. JAMA. 2017 Dec;318(22):2211–2223.

[23] Ting DSW, Cheung CY, Nguyen Q, Sabanayagam C, Lim G, Lim ZW, et al. Deep Learning in Estimat-
ing Prevalence and Systemic Risk Factors for Diabetic Retinopathy: A Multi-Ethnic Study. NPJ Digit
Med. 2019;2:24.

[24] Raumviboonsuk P, Krause J, Chotcomwongse P, Sayres R, Raman R, Widner K, et al. Deep Learn-
ing versus Human Graders for Classifying Diabetic Retinopathy Severity in a Nationwide Screening
Program. NPJ Digit Med. 2019;2:25.

[25] Arcadu F, Benmansour F, Maunz A, Willis J, Haskova Z, Prunotto M. Deep Learning Algorithm

Predicts Diabetic Retinopathy Progression in Individual Patients. NPJ Digit Med. 2019;2:92.

[26] Abramoff MD, Lavin PT, Birch M, Shah N, Folk JC. Pivotal Trial of an Autonomous AI-Based
Diagnostic System for Detection of Diabetic Retinopathy in Primary Care Ofﬁces. NPJ Digit Med.
2018;1:39.

17

[27] Burlina PM, Joshi N, Pacheco KD, Freund DE, Kong J, Bressler NM. Use of Deep Learning for
Detailed Severity Characterization and Estimation of 5-Year Risk among Patients with Age-Related
Macular Degeneration. JAMA ophthalmology. 2018 Sep;136(12):1359–1366.

[28] Babenko A, Lempitsky V. Aggregating Deep Convolutional Features for Image Retrieval. 2015 Oct.

[29] Schmidt-Erfurth U, Sadeghipour A, Gerendas BS, Waldstein SM, Bogunovi´c H. Artiﬁcial Intelligence

in Retina. Progress in retinal and eye research. 2018 Nov;67:1–29.

[30] Age-Related Eye Disease Study Research Group. The Age-Related Eye Disease Study System
for Classifying Age-Related Macular Degeneration from Stereoscopic Color Fundus Photographs:
The Age-Related Eye Disease Study Report Number 6. American journal of ophthalmology. 2001
Nov;132(5):668–681.

[31] Group AREDSR. The Age-Related Eye Disease Study (AREDS): Design Implications. AREDS Report

No. 1. Controlled clinical trials. 1999 Dec;20(6):573–600.

[32] Group AR, Chew EY, Clemons T, SanGiovanni JP, Danis R, Domalpally A, et al. The Age-Related Eye
Disease Study 2 (AREDS2): Study Design and Baseline Characteristics (AREDS2 Report Number 1).
Ophthalmology. 2012 Nov;119(11):2282–2289.

[33] Flaxel CJ, Adelman RA, Bailey ST, Fawzi A, Lim JI, Vemulakonda GA, et al. Age-Related Macular

Degeneration Preferred Practice Pattern®. Ophthalmology. 2020 Jan;127(1):P1–P65.

[34] Liao DS, Grossi FV, El Mehdi D, Gerber MR, Brown DM, Heier JS, et al. Complement C3 Inhibitor
Pegcetacoplan for Geographic Atrophy Secondary to Age-Related Macular Degeneration. Ophthal-
mology. 2020 Feb;127(2):186–195.

[35] Fleckenstein M, Mitchell P, Freund KB, Sadda S, Holz FG, Brittain C, et al. The Progression
of Geographic Atrophy Secondary to Age-Related Macular Degeneration. Ophthalmology. 2018
Mar;125(3):369–390.

[36] Ting DSW, Peng L, Varadarajan AV, Keane PA, Burlina PM, Chiang MF, et al. Deep Learning in
Ophthalmology: The Technical and Clinical Considerations. Progress in Retinal and Eye Research.
2019 Sep;72:100759.

[37] Fritsche LG, Igl W, Bailey JNC, Grassmann F, Sengupta S, Bragg-Gresham JL, et al. A Large Genome-
Wide Association Study of Age-Related Macular Degeneration Highlights Contributions of Rare and
Common Variants. Nature genetics. 2016 Feb;48(2):134–143.

[38] Ding Y, Liu Y, Yan Q, Fritsche LG, Cook RJ, Clemons T, et al. Bivariate Analysis of Age-Related
Macular Degeneration Progression Using Genetic Risk Scores. Genetics. 2017 May;206(1):119–133.

[39] Gensheimer MF, Narasimhan B. A Scalable Discrete-Time Survival Model for Neural Networks. PeerJ.

2019;7:e6257.

[40] Katzman JL, Shaham U, Cloninger A, Bates J, Jiang T, Kluger Y. DeepSurv: Personalized Treat-
ment Recommender System Using a Cox Proportional Hazards Deep Neural Network. BMC medical
research methodology. 2018 Feb;18(1):24.

18

[41] De Fauw J, Ledsam JR, Romera-Paredes B, Nikolov S, Tomasev N, Blackwell S, et al. Clinically
Applicable Deep Learning for Diagnosis and Referral in Retinal Disease. Nature medicine. 2018
Sep;24(9):1342–1350.

[42] Lee CS, Baughman DM, Lee AY. Deep Learning Is Effective for the Classiﬁcation of OCT Images of
Normal versus Age-Related Macular Degeneration. Ophthalmology Retina. 2017;1(4):322–327.

[43] Chen Q, Peng Y, Keenan T, Dharssi S, Agro N E, Wong WT, et al. A Multi-Task Deep Learning Model
for the Classiﬁcation of Age-Related Macular Degeneration. AMIA Joint Summits on Translational
Science proceedings AMIA Joint Summits on Translational Science. 2019;2019:505–514.

[44] Lao J, Chen Y, Li ZC, Li Q, Zhang J, Liu J, et al. A Deep Learning-Based Radiomics Model for

Prediction of Survival in Glioblastoma Multiforme. Sci Rep. 2017 Sep;7(1):10353.

[45] Simon N, Friedman J, Hastie T, Tibshirani R. Regularization Paths for Cox’s Proportional Hazards

Model via Coordinate Descent. Journal of Statistical Software. 2011;39(5).

[46] Cox DR. Regression Models and Life-Tables.

In: Kotz S, Johnson NL, editors. Breakthroughs in

Statistics. New York, NY: Springer New York; 1992. p. 527–541.

[47] Szegedy C, Vanhoucke V, Ioffe S, Shlens J, Wojna Z. Rethinking the Inception Architecture for Com-
puter Vision. In: The IEEE Conference on Computer Vision and Pattern Recognition (CVPR); 2016.
p. 2818–2826.

[48] Abadi M, Agarwal A, Barham P, Brevdo E, Chen Z, Citro C, et al. TensorFlow: Large-Scale Machine

Learning on Heterogeneous Distributed Systems. arXiv preprint. 2016 Mar.

[49] Pencina MJ, D’Agostino RB. Overall C as a Measure of Discrimination in Survival Analysis:
Model Speciﬁc Population Value and Conﬁdence Interval Estimation. Statistics in medicine. 2004
Jul;23(13):2109–2123.

[50] Rosner B. Fundamentals of Biostatistics. Cengage Learning; 2015.

[51] Simonyan K, Vedaldi A, Zisserman A. Deep inside Convolutional Networks: Visualising Image Clas-

siﬁcation Models and Saliency Maps. arXiv preprint. 2013 Dec.

19

Supplementary information

Figure S1: Survival model predictions for the 5 groups. The participants were split into 5 groups based
on the AREDS simpliﬁed severity scores at the baseline. Actual survival for the 5 groups is shown in
lines (Kaplan-Meier curves). The deep features/survival, DL grading/survival, and retinal specialist/survival
model predictions for the ﬁve groups are shown in lines with markers. The deep features/survival predictions
corresponded better to actual progression data than those of the other two models.

20

Figure S2: Receiver operating characteristic curves for the deep neural networks to grade drusen size
and pigmentary abnormalities presence/absence on the combined AREDS/AREDS2 test sets (601 par-
ticipants). The AUC was used to evaluate the performance of deep neural networks in image classiﬁcation
(as opposed to predictions of progression), and for comparison with the retinal specialists (with reference to
the Reading Center grades as the ground truth).

21

Figure S3: Example cases of progression to late age-related macular degeneration (AMD) where deep
features/survival made more accurate predictions than retinal specialist/calculator or retinal special-
ist/Simpliﬁed Severity Scale (SSS). a. Both participants were the same age (73 years) and had the same
smoking history (current) and AREDS SSS scores (4) at baseline. The retinal specialist graded the SSS
correctly. However, participant 1 progressed to late AMD at year 2 (GA in the right eye), but participant 2
progressed to late AMD at year 5 (GA in the left eye). Hence, both the retinal specialist/calculator and reti-
nal specialist/SSS approaches incorrectly assigned the same risk of progression to both participants (0.413).
However, the deep feature/survival approach correctly assigned a higher risk of progression to participant
1 (0.751) and a lower risk to participant 2 (0.591). b. Both participants were the same age (73 years) and
had the same smoking history (former). Their AREDS SSS scores at baseline were 3 and 4, respectively.
The retinal specialist graded the SSS correctly. However, participant 3 progressed to late AMD at year 2
(neovascular AMD in the right eye), while participant 4 had still not progressed to late AMD by ﬁnal follow-
up at year 11. Hence, both the retinal specialist/calculator and retinal specialist/SSS approaches incorrectly
assigned a lower risk of progression to participant 3 (0.259) and a higher risk to participant 4 (0.413). How-
ever, the deep feature/survival approach correctly assigned a higher risk of progression to participant 4 and
a lower risk to participant 3 (0.569 vs 0.528).

22

Table S1: Number of images used to develop the classiﬁcation network.

AREDS AREDS2

17,658
12,391
1,738
3,529

191
921
16,546

3,855
13,803

Image characteristics

Number of images

Training
Development
Test

AMD drusen feature, by image, as classiﬁed by Reading Center

57,375
40,455
5,535
11,385

No drusen or small drusen, No. (%)
Medium drusen, No. (%)
Large drusen, No. (%)

24,290
15,464
17,621
AMD pigmentary abnormalities, by image, as classiﬁed by Reading Center
40,738
16,637

absent, No. (%)
present, No. (%)

23

Table S2: Multivariate Association of Phenotypic, Demographic, and Genetic Variables and Progression to
late AMD. Deep features with p value < 0.05 are shown.

Variable

DL grading/survival
Hazard
ratio

95% CI

p-value Variable

Deep Feature/survival
Hazard
ratio

95% CI

Age
Smoking status
CFH rs1061170
ARMS2 rs10490924
AMD GRS
drusen score (LE)
drusen score (RE)
pig abn (LE)
pig abn (RE)

1.05
1.17
0.95
0.95
1.35
2.26
1.89
2.28
1.72

1.04-1.07 <.001
0.017
1.03-1.32
0.382
0.83-1.07
0.83-1.09
0.490
1.24-1.47 <.001
1.84-2.78 <.001
1.56-2.28 <.001
1.88-2.76 <.001
1.42-2.08 <.001

Age
Smoking status
CFH rs1061170
ARMS2 rs10490924
AMD GRS
feature335
feature79
feature449
feature234

1.05
1.14
0.89
0.90
1.38
0.14
0.24
0.56
9.41

1.04-1.06
1.00-1.30
0.77-1.04
0.77-1.04
1.25-1.52
0.05-0.37
0.09-0.66
0.35-0.91
1.04-85.11

p-value

<.001
0.055
0.085
0.161
<.001
<.001
0.005
0.020
0.046

LE-left eye, RE-right eye, pig abn-pigmentary abnormality, GRS-Genetic Risk Score.

24

Table S3: The C-statistic (95% conﬁdence interval) of the survival models in predicting risk of progression
to late age-related macular degeneration on the combined AREDS/AREDS2 test sets (601 participants).

Models

Late AMD

DL grading/calculator
DL grading/SSS*
Geographic atrophy

DL grading/calculator
DL grading/SSS*

Neovascular AMD

DL grading/calculator
DL grading/SSS*

1

-
-

-
-

-
-

2

3

4

5

82.2 (81.8, 82.6)
-

82.6 (82.3, 83.0)
-

83.4 (83.1, 83.6)
-

83.5 (83.3, 83.7)
82.3 (82.1, 82.5)

84.7 (84.4, 85.1)
-

83.4 (83.1, 83.7)
-

84.2 (83.9, 84.4)
-

83.7 (83.4, 83.9)
-

78.2 (77.4, 79.0)
-

80.1 (79.5, 80.6)
-

78.7 (78.3, 79.1)
-

79.4 (79.1, 79.7)
-

25

Table S4: The C-statistic (95% conﬁdence interval) of three models in predicting risk of progression to late
age-related macular degeneration on the combined AREDS/AREDS2 test sets (601 participants).

DL grading

DL features

Nnet-survival
DeepSurv
COX PH

0.803 (0.799, 0.808)
0.842 (0.837, 0.847)
0.849 (0.846, 0.853)

0.851 (0.846, 0.856)
0.859 (0.854, 0.865)
0.867 (0.865, 0.868)

26

