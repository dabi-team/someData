IEEE , VOL. XX, NO. XX, JANUARY 2021

1

Optimal Sensor Placement in Lithium-Ion Battery
Pack for Fault Detection and Isolation

Ye Cheng, Student Member, IEEE, Matilde D’Arpino, Member, IEEE, Giorgio Rizzoni, Fellow, IEEE,

1
2
0
2

b
e
F
9
1

]

Y
S
.
s
s
e
e
[

3
v
3
3
5
0
1
.
8
0
0
2
:
v
i
X
r
a

Abstract—Energy storage systems for transportation and grid
applications, and in the future for aeronautical applications, re-
quire the ability of providing accurate diagnosis to insure system
availability and reliability. In such applications, battery packs
may consist of hundreds or thousands of interconnected cells,
and of the associated electrical/electronic hardware. This paper
presents a systematic methodology for approaching some aspects
of the design of battery packs, and in particular understanding
the degree of analytical redundancy (AR) in the system that can
be used for diagnostic strategies. First, the degree of AR that is
intrinsic in the battery system is determined. Then, structural
analysis tools are used to study how different measurements
(current, voltage, and temperature) may improve the ability of
monitoring and diagnosis of a battery system. Possible sensor
placement strategies that would enable the diagnosis of individual
sensor faults and individual cell faults for different battery pack
topologies are analyzed as well. The work presented in this
paper illustrates how to achieve the required fault detection and
isolation (FDI) capabilities using a minimal or optimal sensor
set, which is a critical step in the design of a large battery pack.

Index Terms—Energy storage system, Lithium-ion battery,

sensor placement, fault diagnosis, structural analysis

I. INTRODUCTION

A MONG the energy storage technologies, lithium-ion bat-

teries (LIB) have demonstrated great capability in im-
proving system efﬁciency, emissions, management of uncon-
trollable sources (e.g. renewable resources, regenerative brak-
ing), controllability and power quality, system level reliability,
delay system expansion/investments, weight, ﬂexibility and
modularity in several energy applications. Major automotive
companies around the world are researching and launching
electric vehicles [1]. The aircraft industry and federal agencies,
such as NASA, have also invested in the research on electriﬁed
aircraft
that can transport both people and cargo [2]–[4].
Similarly, electric utilities are seeking to use energy storage as
a cost-effective way of supporting renewable power production
and distribution [5], [6]. The integration of LIB in a system
usually requires that battery cells are connected in series and/or
in parallel to form modules, which then are assembled into

This work has been submitted to the IEEE for possible publication.
Copyright may be transferred without notice, after which this version may
no longer be accessible.

This work is supported by NASA ULI program Electric Propulsion:
Challenges and Opportunities under Grant NNX17AJ92A. (Corresponding
author: Ye Cheng)

Y. Cheng, M. D’Arpino and G. Rizzoni are with the Center for Automotive
Research, The Ohio State University, Columbus, OH 43212 USA. Y. Cheng,
and G. Rizzoni are also with the Department of Electrical and Computer
Engineering, The Ohio State University, Columbus, OH, 43210 USA. (e-mail:
cheng.1316@osu.edu; darpino.2@osu.edu; rizzoni.1@osu.edu).

Fig. 1: (a) Parallel-Series topology (PS or mPnS), (b) Series-
Parallel topology (SP or nSmP)

battery packs to meet the energy and power requirements of
vehicles or grid applications, resulting in systems that are
large-dimensional and that have complex interconnections [7].
One of the open problems is the ability to properly monitor
the operation of such complex systems, and to diagnose their
health. When designing a large battery pack, two fundamental
topologies are commonly used and according to the standard
IEC 60050, they are named as parallel-series (PS), and series-
parallel (SP), as shown in Fig.1, where i is the series index
and j is the parallel index. A battery pack is composed of
n × m cells, where n indicates the number of elements in
series and m the number of elements in parallel. The behavior
of a battery pack cannot be modeled by understanding the
behavior of a single cell, as the complex interconnections
of cells and modules causes interactions that may limit the
system performance. Because of differences in cell electrical
and thermal characteristics and in cell aging, the energy/power
density and the durability and safety of the battery packs
will be reduced to a certain extent compared with individual
cell [8], [9]. It is therefore very important to understand the
behavior of large battery pack systems, which are deﬁned by
their electrical topology, by their cooling system architecture,
and by the design of their battery management system. Among
them, efﬁcient sensing and fault tolerant design are important
elements in the design of a battery pack. In this paper we focus
on one particular aspect of the battery pack system design: the
ability to diagnose faults and failures.

Methods for fault diagnosis for lithium-ion battery systems
can be classiﬁed into model-based, knowledge-based, and
data-driven ones [10]. The most widely used knowledge-

 
 
 
 
 
 
IEEE , VOL. XX, NO. XX, JANUARY 2021

2

based methods include graph theory-based (fault tree analysis)
[11], expert system [12], and fuzzy logic-based [13]. These
diagnostic methods employ the basic knowledge and real-time
observation of the battery system. Although the principle is
easy to understand, before the fault diagnosis decision is made,
further research is needed on the fault mechanism, knowl-
edge acquisition and knowledge representation. Data-driven
methods include signal processing [14]–[17], machine learning
[18]–[20], and information fusion [21]. The advantage of these
methods is that they can directly analyze and process operating
data to detect failures without relying on models. The limita-
tion in these methods is the need for large amounts of historical
data, high computational costs, and training complexity. Model
based methods can be divided into three categories, including
state estimation [22]–[26], parameter estimation [27]–[30],
and structural analysis theory [31]–[33]. The development of
battery models, including electrical models, thermal models
and electrochemical models, provides the basis for model-
based fault diagnosis. Due to the deeper insights afforded
by physically based methods, these approaches can not only
detect faults, but also locate faults and estimate their size. It
should be noted that all of these model-based methods may
be affected by model uncertainty, interference and noise.

Although much work has been done in fault diagnosis
for lithium-ion battery, little can be found in the literature
covering the topic of redundancy exploration for a battery or
a battery pack. Most fault diagnosis schemes that have been
proposed are based on the assumption that there are sufﬁcient
sensors providing cell information including current, voltage
and temperature. For instance, in [34], a sensor fault diagnosis
method is presented for a lithium-ion battery pack in electric
vehicles (two cells in series, which is in fact not a realistic
conﬁguration for a battery pack). This highly simpliﬁed battery
pack is equipped with a voltage sensor and a temperature
sensor for each cell and a current sensor. While the simplicity
of this conﬁguration with this sensor set permits experimental
studies,
in
industrial applications that might see hundreds or thousands
of cells in a battery pack. In this paper, the problem of a
minimal (or otherwise optimal) sensor selection to guarantee
effective FDI in a realistic battery pack is addressed.

it must be recognized that

is not practical

it

A traditional approach to achieving fault tolerance may
include two steps: 1) detect speciﬁc faults through limit
checking or some other form of signal analysis; 2) if a
failure is detected, a controller or management system will
use existing redundancy to replace the faulty component or
function [35]. This approach to fault tolerance is based on
physical redundancy, where critical elements of the system
are realized multiple times, with attendant increases in both
system cost and complexity. However, this approach may not
be always feasible in large-scale systems. In this paper, the
methodology used for fault tolerance is based on understand-
ing and exploiting system analytical redundancy (AR) using a
graphical approach known as “structural analysis” [35]–[38].
Structural analysis is based on the systematic study of the
AR inherent in a mathematical model of the system, and is
especially suitable for large and nonlinear systems because
is founded on structural system properties. The system
it

structural model is represented by a bipartite graph (usually
visualized through an incidence matrix), and permits studying
the AR inherent in the system with the aim of identifying FDI
strategies in a systematic way. One of the outcomes of this
approach is that it allows evaluation of the diagnosability of
the system as a function of employing different sensor sets,
and also to assist in sensor placement [38]–[40].

The method of using structural analysis to study the FDI
attributes of the system has been applied to several ﬁelds, for
example automotive systems [41]–[43], engines [44], [45], fuel
cells [46], transmissions [47]–[50], anti-lock brakes [51], drive
systems of electric vehicles, [52], and pneumatic systems [53].
The idea of applying structural analysis for battery diagnosis is
not novel [31]–[33], but while the results available in literature
they are quite limited and not
are useful and interesting,
generalized to large battery packs, system faults, and sensor
placement.

The contributions made in this paper may be summarized
as follows: i) for the ﬁrst time the tools of structural analysis
are applied in a general and systematic way to a battery
pack to understand the intrinsic degree of AR contained in
mathematical models of the battery cells assembled in packs
with two different topologies; ii) we develop general models,
which include fault models, to determine the intrinsic AR of
the system, in the absence of measurements; iii) the structural
models are used to assess the degree of diagnosability that can
be achieved for each topology by incorporating sensors in the
battery pack design. In summary, the analysis conducted in
this paper and the methods developed in it permit evaluating
trade-offs among different sensor placement strategies for the
purpose of diagnosis. The principal contribution of this paper
is a systematic methodology to understand the diagnostic
implications of sensor selections in battery packs. While the
complete design of a battery pack, including sensor selection
to enable battery electrical, thermal and health management,
is a complex process that involves many other design aspects,
nonetheless we believe that the work presented in this paper
is an important step in this direction.

This paper is organized as follows. Section II presents both
mathematical model and structural model of battery. In section
III, the tools of structural analysis for diagnosis are introduced
for battery. Section IV discusses the sensors placement for
faults detectability and isolability of different pack topologies.
Section V reports comments and remarks. Finally conclusion
is drawn in Section VI.

II. INTRODUCTION TO STRUCTURAL MODEL OF BATTERY

A. Battery pack modeling

The subject of battery pack modeling is complex, as it may
require consideration of electrochemistry, electrical system,
thermal behavior, and control (BMS that is responsible for
charge equalization, thermal management, safety etc.) [7], [8],
[54]. In this paper we are focused on describing the systems
aspects of the battery pack, and in particular the interaction
between the electrical and thermal behavior of the elements
with sensing and monitoring systems. Equivalent electrical
circuit models (ECMs) and lumped-parameter thermal models

IEEE , VOL. XX, NO. XX, JANUARY 2021

3

[55], [56] are usually adopted for system level fault diagnosis,
thanks to the possibility of locating voltage, current and
temperature sensors. For simplicity, a zeroth order ECM is
employed as the basis of the analysis of this paper. Note that
the methodology proposed in this paper can be extended to
higher order ECMs. The equations below describe a basic
electrothermal model of the generic ij battery cell. The model
is composed of 4 equations (e1, e2, e3, e4).

e1 : Vij = Voc,ij − RijIij

e2 :

dSoCij
dt

= −

Iij
Qij

e3 : Voc,ij = f (SoCij)

e4 : mcp

dTij
dt

= Rij(Iij)2 − QT M Sij

(1)

(2)

(3)

(4)

where, V represents the cell terminal voltage, I represents the
input current. Eq.(1) describe the zeroth order ECM. Eq.(2) is
the calculation of state of charge (SoC) using the Coulomb
counting method where, Q is the cell capacity. The open
circuit voltage (Voc) is a function of the SoC, as shown in
Eq.(3). Based conservation of energy, Eq.(4) correlates the
temperature T to the heat generation (RI 2) and the heat
extracted by the thermal management (QT M S). m in Eq.(4)
represents cell mass and cp the speciﬁc heat capacity at
constant pressure. For the purpose of structural analysis, we
assume that the R and Q are constant and not dependent on
SoC and T .

For the battery pack architectures shown in Fig. 1, an
electrical model can be derived applying Kirchhoff’s Laws
and including a load current IBP [7].

For mPnS topology:

m
(cid:88)

j=1

Iij = I M

i = IBP

(i = 1 . . . n)

(5)

Vi1 = · · · = Vij = · · · = Vim = V M

i

(∀i = 1 . . . n)

(6)

and V M

where, I M
represent the current and voltage of the
i
ith module. n indicates the number of elements in series and
m the number of elements in parallel.

i

For nSmP topology:

m
(cid:88)

j=1

I M
j = IBP

(Iij = I M
j

∀i = 1 . . . n)

(7)

Vi1 = · · · =

n
(cid:80)
i=1
(∀j = 1 . . . m)

n
(cid:80)
i=1

Vij = · · · =

n
(cid:80)
i=1

Vim = V M

j = VBP

(8)

where, I M
j
jth module.

and V M

j

represent the current and voltage of the

Fig. 2: Bipartite graph for a single cell system.

TABLE I: Incidence matrix for a single cell system

Equations

Unknown variables

e1
e2
e3
e4

V11
1
0
0
0

Voc,11
1
0
1
0

I11
1
1
0
1

SoC11
0
1
1
0

T11
0
0
0
1

B. Structural model of battery

i.e.,

Structural analysis investigates the model constraint struc-
the connections between known variables,
ture [35],
unknown variables, and faults. No matter what type of model
is used, one can generate a corresponding structural model in
the form of a bipartite graph. These mathematical equations
can be a set of algebraic or differential equations that describe
the relationships among variables. A structural representation
is a bipartite graph with a set of system equations, variables
and edges (E, Z, and ε, respectively). The set of variables (Z)
include unknown variables (X) and known variables (K).

The equations

for a single cell are listed in Eq.s
(1)-(4), where i = 1, j = 1. The model has 4
equations E ={e1, e2, e3, e4} and 5 unknown variables
X ={V11, I11, Voc,11, SoC11, T11}. The bipartite graph of the
single cell system is shown in Fig. 2, where variables are
represented by circles while the equations are represented by
bars. An edge connects a variable and an equation and it is
not oriented. A structural model may also be represented by
a corresponding incidence matrix in which the rows represent
system equations and the columns represent variables. The
elements of the incidence matrix are deﬁned as follows: if a
variable appears in an equation, the element is 1, otherwise
0. The incidence matrix of the single cell system is shown in
Table I.

C. mPnS versus nSmP

The mPnS and nSmP topologies are shown in Fig. 1(a)
and Fig. 1(b), respectively. The system equations are listed in
Eq.(1)-(8). Based on the battery pack model, the calculation
of SoC, Voc and T for one cell is isolated from another cell.
There are only current and voltage connections between cells,
and it is reasonable to condense the structural graph of each
single cell to one node, as shown in Fig. 3. With the simpliﬁed
graph structure, it is possible to obtain a generalized structural
model of the mPnS and nSmP topologies as shown in Fig.
4 and 5, respectively, where the color coding represents the

IEEE , VOL. XX, NO. XX, JANUARY 2021

4

Fig. 3: Simpliﬁcation of structural model for one cell

Fig. 4: Structural model for mPnS topology battery pack

Fig. 6: Structural methodology for fault diagnosis

1 . Then the change of I M
j , · · · , I M
1 , · · · , I M

the nSmP topology, the current in each module is equal to the
individual cell current, and the pack current is the summation
of all the module currents (see Eq. 7). The variation of cell11
will affect I11 and I M
1 will cause
unbalance between I M
m . The inﬂuence of
a defective cell will therefore spread to the whole battery
pack, as shown in Fig. 5. This is a very important intrinsic
property of the two battery pack topologies, and it motivates
the analysis and models presented in the following section.
Note that, we only apply the simpliﬁcation shown in Fig. 3
to the bipartite graphs of mPnS and nSmP topologies. The
sensor placement analysis in the following section is based on
using the system incidence matrix without any simpliﬁcation.

III. STRUCTURAL ANALYSIS FOR FAULT DIAGNOSIS

The process of structural analysis for fault diagnosis is
illustrated in Fig. 6. Generating the structural model of a
system based on its mathematical model is the ﬁrst step. Then,
a Dulmage-Mendelsohn (DM) decomposition rearranges the
system incidence matrix and divides the structural model into
three subsystems [36] (as shown in Fig.7):

1) under-determined part (M −), where there are fewer

Fig. 5: Structural model for nSmP topology battery pack

equations than unknown variables;

entity of the deviation between the variable of the cells. These
generalized structural models can help analyze the effect of a
faulty cell (for example a short circuit), or the effect of cell-
to-cell variation (for example due to uneven aging of cells).
Suppose that cell11 in Module 1 has an anomalous behavior
compared to the other cells (again, due to a fault or to a
change in some physical parameter) and a ﬁxed load current
is considering. For the mPnS topology, all module currents
equal the pack current (see Eq. 5) and remain unchanged. As
shown in Fig. 4, any defect in cell11 will result in an imbalance
between I11, · · · , I1j, · · · , I1m, in Module 1. The impact of
the defective cell is limited to the module it belongs to and
the other modules will not be affected by the defective cell. In

2) just-determined part (M 0), where there are equal equa-

tions as unknown variables;

3) over-determined part (M +), where there are more equa-

tions than unknown variables.

Based on the DM decoposition of the system incidence matrix,
fault detectability and isolability are stated as follows [38]:

fault detectability : A fault is said to be structurally de-
tectable if the equation containing the fault exists in the over-
determined portion of the structural model decomposition:
ef ∈ {M }+.

fault isolability : A fault fi is said to be structurally isolable
from fault fj, if the equation containing fi exists in the over-
determined part of the structural model excluding the equation
that fj is contained: fi ∈ (cid:8)M \efj
. In other words, the
equations containing these two faults must be in different

(cid:9)+

IEEE , VOL. XX, NO. XX, JANUARY 2021

5

Fig. 7: Dulmage-Mendelsohn decomposition of a model [44]

equivalence classes of the over-determined subsystem. A more
detailed explanations of equivalence classes may be found in
[44].

If the system structural model has a sufﬁcient degree of
redundancy to meet the requirements of FDI, different proper
Minimal Structurally Over-determined (MSO) subsystems can
be found and used to design diagnostic tests, that is, algorithms
that are capable of verifying the consistency of the equations.
Any inconsistency could be attributed to the presence of a
fault, but could of course also be due to noise and uncertainty.
A diagnosis test
is an over-determined subsystem of the
complete system model where one (or more) fault(s) is (are)
structurally detectable [44]. A MSO set is a proper over-
determined set of model equations such that its degree of
redundancy is one, i.e: |E| − |X| = 1. Within each MSO
set, by ﬁnding proper matching, a residual can be found that
is only sensitive to a certain subset of faults. A residual is a
signal used as a fault indicator that is sensitive to these faults.
Mapping the residuals to each corresponding fault results in
a fault signature matrix; solutions can then be found to make
every fault detectable or uniquely isolable from other faults as
required.

If the system structural model has no over-determined
subsystem, then it is not possible to detect or isolate any faults.
Utilizing the deﬁnitions of detection and isolation, we can
create a sensor installation guide that allows us to generate
the desired degree of redundancy to develop FDI algorithms
based on the system diagnostic speciﬁcations.

A. Analytical redundancy (AR) in a battery system

When no measurement is considered, a single cell system
of Eq.s (1)-(4) has ﬁve unknown variables (X = 5) and four
equations (E = 4). The system is under-determined and cannot
be solved to calculate the ﬁve unknown variables. Thus, the
intrinsic analytical redundancy (IAR) of a single cell is −1.

IARsingle cell = −1

(9)

In the same way, the IAR of the battery system is also −1 for
both mPnS and nSmP topologies, when no sensors and faults
are considered because the number of equations is always 1
less than the number of unknown variables.

IARbattery pack = −1

(10)

Fig. 8: Two complete matchings (a) , (b) and an incomplete
matching (c)

To increase the degree of AR and provide the ability to
design diagnostic algorithms, sensors are needed in the battery
system. In the following subsections, we use graph-theoretic
tools to understand how different measurements (current,
voltage, and temperature) can add analytical redundancy to
the system, and how this analytical redundancy is linked to
system diagnosability.

The addition of a sensor to measure an unknown variable
increases the number of known variables and equations, how-
ever it introduces the possibility of a fault, as shown in the
following equation:

yu = u + fyu

(11)

where y denotes the real time sensor reading and is a known
variable, fyu denotes the sensor fault (f (cid:54)= 0 indicates that
the sensor failed). u is the actual value of the sensed current,
voltage or temperature.

B. Matching on a structural model

that

The basic principle of structural analysis is to ﬁnd match-
ings,
is, causal assignments between X and E in a
structural model. If an X is matched with a E, it can be
calculated from this equation. If an X is not matched, it cannot
be calculated. A more detailed deﬁnition of matching can be
found in [35]. Basically, if we employ bipartite graph as the
structural model, a matching is a subset of ε. Any two edges in
a matching do not share common node (E or Z), which means
it associates one equation (E) with one speciﬁc variable (Z).
Matching is not unique, as different matchings may be found
for a system. Fig. 8 lists three possible matchings for the single
cell system Eq.s (1)-(4). The black thinner lines represent
unmatched edges, while the red bold lines represent matched
edges. A matching can be further deﬁned as a complete
matching based on the number of edges (|ε|), equations (|E|),
and variables (|Z|) contained in the matching. A matching is
said to be : i) complete with respect to E if |ε| = |E|; ii)
complete with respect to Z if |ε| = |Z|; iii) if only unknown
variables (X) are considered, a matching is said to be complete
if |ε| = |X|. In Fig. 8, (a) and (b) are two complete matchings
with respect to equations; (c) is an incomplete matching. When
no measurement is considered, a single cell system has less
equations than unknown variables, thus a complete matching
can be ﬁnd only with respect to equations.

As example, a complete matching of the system of Eq.s (1)-
(4) with respect to X can be achieved by adding the following
sensor equations to measure current and voltage of the single

IEEE , VOL. XX, NO. XX, JANUARY 2021

6

Fig. 9: (a) an example of complete matching, (b) matching in
the bipartite graph

cell:

e5 : yI11 = I11 + fyI11

e6 : yV11 = V11 + fyV11

(12)

(13)

where yI11 and yV11 denotes the real
time current and
voltage sensor reading and are known variables, fyI11
and
fyV11
denotes the sensor faults. The single cell model with
includes 6 equa-
a current and a voltage measurement
tions E ={e1, e2, e3, e4, e5, e6} and 5 unknown variables
X ={V11, I11, Voc,11, SoC11, T11}. There are more equations
than unknown variables. The degree of AR in this case is 1,
indicating that the single cell system with a current sensor and
a voltage sensor has an over-determined subset of equations
and it is therefore possible to design a diagnostic test.

ARsingle cell = 1 when ∃ yI11 and yV11

(14)

A MSO set M SO ={e1, e2, e3, e5, e6} can be found from the
6 equations. A complete matching with respect to unknown
variables can be found in this MSO set, as shown in Fig.
9(a). The bipartite graph of Fig. 9(b) shows this matching. The
red lines represent the matched edges, blue circles represent
known variables and red circles represent faults.

C. Oriented graph

An oriented graph is a matching that assigns orientation of
some edges. For a matched equation, the edge that connects the
matched variable and the equation is called a matched edge
directed from the equation to the variable. Other edges that
connect non-matched variables and equations are called non-
matched edges with an orientation from non-matched variables
to the equation. For equations that are not matched, all edges’
orientations are from variables to the equation. The non-
matched equation generates a zero output, which represents
an analytic redundant relation (ARR) of the model. ARRs are
used to generate residuals as fault indicators for the purpose
of fault diagnosis. Fig. 10 shows the oriented structural graph
for the MSO set found in a single cell system with a current
and a voltage measurement.

The oriented graph deﬁnes a set of computational sequences

S = {S1, S2} to calculate the unknown variables:
S1 = {(e5, I11) , (e2, SoC11) , (e3, Voc,11)}
S2 = {(e6, V11)}

Fig. 10: Oriented graph for single cell system with a current
and a voltage measurement

where, the pair (e, x) means variable x is computed from
equation e. The order of the pairs deﬁnes a computational
sequence. Note that e2 is a differential equation, and when we
use their integral causalities, the knowledge of initial values
are required. The oriented graph results in an alternated chain
that starts from the known variables and alternates successively
between two nodes [35]. For the oriented graph shown in Fig.
10, the alternated chain based on the computational sequence
S1 can be expressed as:

yI11 → e5 → I11 → e2 → SOC11 → e3 → Voc,11

(15)

Based on the alternated chain, the structural reachability is
deﬁned as [35]: a variable z2 is reachable from a variable
z1 if there exists an alternated chain from z1 to z2 . The
circle in gray with a ‘zero’ in it represents the ARR of the
model. In Fig. 10, e1 is the ARR in this MSO with the
matching we choose in Fig. 9. A residual based on the sensor
set {yI11 , yV11} that is capable of detecting the two faults
{fyI11

, fyV11

} is

r = yV11 − f [SoC11,0 − 1
Q
= fyV11
+ RfyI11

(cid:82) t
0 yI11 (t)dt] + RyI11

(16)

where, SoC11,0 represents the initial value of SoC11. The
residual r in Eq.(16) is obtained by substituting all matched
equations to c1 to eliminate unknown variables and make it
only contains known variables. A violation of any equation
that is used to generate the residual will result in a non-zero
residual indicating a fault. In fact, the residual in Eq.(16) is
the only residual generator for a single cell with current and
voltage measurements for the matching of Fig. 9. When there
isn’t a fault, r should be 0. Notice that this residual is sensitive
to both fyI11

and fyV11

.

D. Oriented graph of a single cell with different measurements

The structural model of a single cell represented by a bipar-
tite graph is shown in Fig. 2. Without sensing, we cannot solve
for the unknown variables. If we have a current measurement
for a single cell, the resulting structural graph is shown in
Fig. 11(a). Every unknown variable is easily reachable from
a measurement (known) because an alternated chain can be
found to exist and this is always true when higher order

IEEE , VOL. XX, NO. XX, JANUARY 2021

7

Fig. 11: Oriented structural graph of a single cell (a) with one
current measurement (b) with one voltage measurement, (c)
with one temperature measurement

ECM is employed. If we introduce a voltage measurement
for a single cell, then the structural graph is as shown in Fig.
11(b). Notice that in this case, the three equations {e1, e2, e3}
form a loop which requires the three equations to be solved
simultaneously and this is always true when higher order ECM
is employed. If we have a temperature measurement for a
single cell, the resulting structural graph is shown in Fig. 11(c).
There is an alternated chain to make every unknown variable
reachable from the measurement but this is true when we use
zeroth order ECM. If a higher order ECM is employed to
represent the battery, adding a temperature measurement will
result in a loop as in the case of adding a voltage measurement.
This can be proved by listing the model equations using
higher order ECM and drawing its corresponding bipartite
graph. Due to the limitation of paper length, the proof is
not presented here. While it is true that in the case of a
voltage or temperature measurement, the redundancy of single
cell system is increased by 1 (becomes 0 from −1) as well
and we can still calculate all unknown variables, it is not
as easy to compute these variables as was the case with a
current measurement. This indicates that, in principle, current
sensors allow us to implement residual generators with lower
computational burden compared to voltage and temperature
sensors. This property is useful to select a sensor at the cell
level in the next section, when we develop sensor placement
strategies for a battery pack to achieve FDI.

IV. SENSOR PLACEMENT FOR FAULT DETECTABILITY AND
ISOLABILITY ANALYSIS

In this section, we develop a systematic methodology to
ﬁnd the minimal sensor sets that can potentially provide the
two common battery topologies with enough ARRs to develop
diagnostic algorithms that can achieve complete fault isolation.
In other words, with the sensor installation guide developed
in this section, it is possible to design algorithms to ﬁnd MSO
sets and generate residuals, each sensitive to a unique fault.

As discussed in Section III-A, if sensors are not included
in a battery system (whether consisting of a single cell or of

Fig. 12: Diagram of internal and external short circuit in a cell

mPnS and nSmP topologies), the system is under-determined
(Eqs. (9) and (14)), and there is no analytical redundancy
in it to permit diagnosis. It is clear, then, that sensors are
necessary to achieve analytical redundancy in a battery pack.
As example, by adding two sensors the system will have an
over-determined subsystem. The addition of different sensor
types in different locations will result in the generation of
different over-determined subsystems. Different combinations
of sensors and the presence of different faults will give rise to
different fault detectability properties, and it may take more
than two sensors to insure detectability of all faults. If faults
are detectable by adding the appropriate sensors, it will then
possible to generate a residual. Based on the residual, the
fault isolability can be deﬁned in another way [57]: fault fi is
isolable from fault fj, if there exists a residual that is sensitive
to fi but not fj. Indeed from Eq.(16), it can be found that in
a single cell instrumented with a current sensor and a voltage
sensor, the two sensor faults are detectable but are not isolable
from each other.

Detectability and isolability analysis can be easily per-
formed using the Structural Analysis Toolbox developed by
Frisk et al. [45]. In the next subsection, the faults considered
in this study are introduced and a fault detectability and isola-
bility analysis is performed for a single cell, the generalized
mPnS and nSmP topologies.

A. Battery modeling with faults

A battery pack can exhibit anomalous behavior due to many
reasons, including short circuit (internal or external to the cell),
resistance increase and/or capacity fade due to accelerated
aging, sensor fault, or BMS fault [58]. In this work, two types
of faults are considered: sensor fault and short circuit faults;
these may occur at the cell or module level in the battery pack.
Short circuit faults are especially important because, unlike
other anomalies that would still permit the system to operate
(e.g. battery degradation), a short circuit may lead to thermal
runaway and result in a catastrophic failure.

Internal and external short circuit faults are depicted in
the circuit diagram of Fig. 12. The internal short circuit is
represented by a parallel resistance (RscI ) connected to the
cell [28]. The external short circuit is similarly represented by
a parallel resistance (RscE) externally connected to a cell or
a module. The fault model for internal short circuit is given

IEEE , VOL. XX, NO. XX, JANUARY 2021

8

by:

(cid:19)

fscI,ij

IscI,ij =

(cid:18) Vij
RscI
where, fscI,ij represents the internal short circuit current fault
and is a binary variable with value 1 when the fault is present,
and IscI,ij the internal short circuit current. The model for a
fault free battery is depicted by Eq.s (1)-(4). In the case of an
internal short circuit, Eq. (3) remains the same while Eq.s (1),
(2),and (4) result in the following equations (18)-(20).

(17)

Vij = Voc,ij − Rij(Iij + IscI,ij)

dSoCij
dt

= −

(Iij + IscI,ij)
Qij

mcp

dTij
dt

= Rij(Iij + IscI,ij)2 − QT M Sij

(18)

(19)

(20)

(cid:19)

(21)

fscE

IscE =

The fault model for the external short circuit is:
(cid:18) VE
RscE
where, fscE (a binary variable) represent the external short
circuit fault, and IscE the external short circuit current. When
we consider a module, that is the composition of multiple
cells, then the voltage VE across the short circuit resistance
RscE depends on how many cells are shorted by the external
short circuit. For example, as shown in Fig. 14 and 15 later,
if we consider the external short circuit at the module level,
for the external short circuit in Module i in mPnS topology,
VE,i = Vi1 = · · · = Vij = · · · = Vim; for the external short
circuit in Module j in nSmP topology, VE,j = V1j + · · · +
Vij + · · · + Vnj. IscE will appear in the KCL equations, (Eq.
(7) or (5)). For example, for a single cell system as shown in
Fig.12, the external short circuit fault can be modeled as:
(cid:18) V11
RscE

IscE,11 =

fscE,11

(22)

(cid:19)

I11 = IBP + IscE,11

(23)

The redundancy of the battery system model with short
circuit faults remains −1, because the addition of an unknown
variable to the system is balanced by the introduction of a new
equation.

ARmodel with f aults = −1

(24)

Sensor faults modeling was introduced in Section Section

III-A see Eq.11.

B. Fault detectabilty and isolability analysis and sensor place-
ment for single cell

The mathematical model of a single cell system with faults
is shown in Eq.s (3), (17)-(20), (22) and (23) with i = 1, j = 1.
The set of short circuit faults that are included in the model
is {fscI,11, fscE,11}. The set of sensor faults depends on what
sensors are added to the battery system. For the single cell
system, the possible sensor positions are {IBP , I11, V11, T11}.

TABLE II: Fault detectability and isolability matrix for a single
cell without sensor and with one sensor (ND=Non Detectable;
NA=Non Applicable)

fscI,11

fscE,11

fyIBP

fyI11

fyV11

fyT11

no sensor
{yIBP }
{yI11 }
{yV11 }
{yT11 }

ND
ND
ND
ND
ND

ND
ND
ND
ND
ND

NA
ND
NA
NA
NA

NA
NA
ND
NA
NA

NA
NA
NA
ND
NA

NA
NA
NA
NA
ND

TABLE III: Fault detectability and isolability matrix for a sin-
gle cell with two sensors (ND=Not Detectable; D=Detectable;
NI=Not Isolable; NA=Not Applicable; )

fscI,11

fscE,11

fyIBP

fyI11

fyV11

fyT11

{yI11 , yV11 }
{yI11 , yT11 }
{yV11 , yT11 }
{yIBP , yI11 }
{yIBP , yV11 }
{yIBP , yT11 }

D,NI
D,NI
D,NI
D,NI
D,NI
D,NI

ND
ND
ND
D,NI
D,NI
D,NI

NA
NA
NA
D,NI
D,NI
D,NI

D,NI
D,NI
ND
D,NI
NA
NA

D,NI
NA
D,NI
NA
D,NI
NA

NA
D,NI
D,NI
NA
NA
D,NI

Table II shows the fault detectability and isolability matrix
for the single cell system without sensors, and with only one
sensor. It can be seen that all faults cannot be detectable with
a single sensor. The DM decomposition shown in Fig. 13(a)
and (b) show that without any sensor, the system is under-
determined (7 equations and 8 unknowns) and with one sensor
(choose sensor {yIBP } as an example), the system becomes
just-determined.

Table III shows the fault detectability and isolability matrix
for the single cell system with 2 sensors. There are 6 pos-
sible sensor sets. With sensor sets {yI11, yV11 }, {yI11, yT11 },
{yV11, yT11 }, all the internal short circuit faults and sensor
faults are detectable, while the external short circuit fault
is not. As shown in the DM-decomposition result (choose
sensor set {yI11, yV11} as an example, shown in Fig. 13(c)):
the equation containing the external short circuit fault sig-
nal (fscE,11) is in the just-determined part, which means
fscE,11 is not detectable. Equations containing fault signals
fscE,11, fyI11
are in the over-determined part and in the
same equivalence class (gray box). Thus, these three faults are
detectable but not isolable from each other. Table III shows that
with the other three sensor sets {yIBP , yI11}, {yIBP , yV11 },
{yIBP , yT11} all faults can be detectable, but are also not
isolable. The DM-decomposition results of one of these sensor
set illustrates this as well (choose sensor set {yIBP , yV11} as
an example, shown in Fig. 13(d)): all the equations containing
fault signals are in the over-determined part, which indicates
all faults can be detectable. However, all equations containing
fault signals are in the same equivalence class, which indicates
that these faults are not isolable from each other.

, fyV11

Table IV shows the fault detectability and isolability
matrix for the 1S1P system with 3 sensors. With sensor
set {yI11 , yV11, yT11 }, all faults can be detectable except
sets
for

fault. With sensor

short circuit

the external

IEEE , VOL. XX, NO. XX, JANUARY 2021

9

Fig. 13: DM decompositions of a single cell system (1S1P or 1P1S) (a) without sensor or with sensor set: (b) {yIBP }, (c)
{yI11 , yV11}, (d) {yIBP , yV11}, (e) {yI11 , yV11, yIBP ,}, (f) {yI11, yV11 , yIBP 1 , yIBP 2 }

TABLE IV: Fault detectability and isolability matrix for a single cell with three sensors (ND=Not Detectable; D=Detectable;
NI=Not Isolable; I=Isolable; UI=Uniquely Isolable; NA=Not Applicable; )

fscI,11

fscE,11

fyIBP

fyI11

fyV11

fyT11

{yI11 , yV11 , yT11 }
{yI11 , yV11 , yIBP }
{yI11 , yT11 , yIBP }
{yV11 , yT11 , yIBP }

D,UI

D,UI

D,UI

D,UI

ND

D,I

D,I

D,I

NA

D,I

D,I

D,I

D,UI

D,UI

D,UI

NA

D,UI

D,UI

NA

D,UI

D,UI

NA

D,UI

D,UI

{yI11 , yV11, yIBP },{yI11, yT11 , yIBP },{yV11 , yT11 , yIBP },
all
faults are detectable. The internal short circuit fault and all
sensor faults can be uniquely isolable, while the external
short circuit fault and the load current sensor fault can be
isolable from other faults but
these two faults cannot be
isolated from one another. From the DM-decomposition result
(choose sensor set {yI11, yV11 , yIBP } as an example, shown
in Fig. 13(e)), it can be seen that: all faults are located in the
over-determined part. The equations containing fault signals
fscE,11 and fyIBP
are in the same equivalence class, which
means they are not isolable from each other but they are
isolable from other faults. The equations containing fault
signals fscI,11, fyI11
are in the different equivalence
classes which means these faults can be uniquely isolable.

, fyV11

Table V shows the fault detectability and isolability
the single cell system with 4 sensors. With
be

{yI11 , yV11, yT11, yIBP },

matrix for
set
sensor

faults

can

all

{yI11, yV11 , yIBP 1 , yIBP 2},

fault and the load current sensor

detectable. The internal short circuit fault and all sensor
faults can be uniquely isolable, while the external short
circuit
fault can be
these two faults cannot be
isolable from other faults but
isolated from each other. From the table it can be seen
{yI11, yT11 , yIBP 1 , yIBP 2 },
that
{yV11, yT11 , yIBP 1 , yIBP 2 } are minimal sensor sets achieving
fault isolability. From the DM-decomposition result (choose
sensor set {yI11, yV11 , yIBP 1 , yIBP 2 } as an example, shown
in Fig. 13(f)),
it can be seen that all faults are in the
over-determined part and each fault is in a unique equivalence
class, which means every fault is uniquely isolable from other
faults.

In this section, we have illustrated the fault detectability
and isolability for a single cell system with all possible sensor
combinations. In the following subsections, we focus on the
minimal sensor set that can achieve complete fault isolability

IEEE , VOL. XX, NO. XX, JANUARY 2021

10

TABLE V: Fault detectability and isolability matrix for a single cell with four sensors (ND=Not Detectable; D=Detectable;
NI=Not Isolable; UI=Uniquely Isolable; NA=Not Applicable; )

fscI,11

fscE,11

fyIBP 1

fyI11

fyV11

fyT11

fyIBP 2

{yI11 , yV11 , yT11 , yIBP }
D,UI
{yI11 , yV11 , yIBP 1 , yIBP 2 } D,UI
{yI11 , yT11 , yIBP 1 , yIBP 2 } D,UI
{yV11 , yT11 , yIBP 1 , yIBP 2 } D,UI

D,I
D,UI
D,UI
D,UI

D,I
D,UI
D,UI
D,UI

D,UI
D,UI
D,UI
NA

D,UI
D,UI
NA
D,UI

D,UI
NA
D,UI
D,UI

NA
D,UI
D,UI
D,UI

for a battery pack.

C. Minimal sensor set for generalized mPnS topology

The generalized diagram including internal and external
short circuit faults for the mPnS topology is shown in Figs. 14.
Note that, for the mPnS we only discuss cases when m > 1,
which means in each module there are at least two cells in
parallel. In general, the set of sensor faults that needs to be
diagnosed depends on the selected sensor set. Further, every
single cell has the possibility of suffering from an internal
short circuit. To represent internal short circuit faults at the
cell level, every cell is modeled with an internal short circuit
fault signal in it. The set of internal short circuit faults we
seek to diagnose is {fscI,11, · · · , fscI,ij, · · · , fscI,nm,}.

to

the

has

that

short

faults

circuit

Every module

of
diagnosed

possibility
set
be

suffer
external
from external
circuit. The
is
to
short
needs
{fscE,1, fscE,2, · · · , fscE,i, · · · , fscE,n,}.
possible
sensor positions are {IBP , u11, · · · , uij, · · · , unm}, where u
represents current, voltage or temperature of each cell. Table
VI lists the minimal sensor set to achieve fault isolability
for mPnS topology obtained using the sensor placement
toolbox. In order to uniquely isolate each fault, the sensor
set
installation needs to meet both of the following two
requirements:

The

1) each cell should be equipped with a sensor Z which can

measure current or temperature;

2) two sensors to measure the load current IBP when n =
1; one sensor to measure the load current when n = 2;
no sensor is needed to measure the battery pack current
when n > 2.

The number of load current sensor varies with n. This is true
because as the battery pack scales up, the variable IBP will
be contained in a greater number of equations (instances of
KCL), see Appendix A.A. As a result, the redundancy of IBP
increases automatically without the need of sensor.

D. Minimal sensor set for generalized nSmP topology

The generalized diagram including internal and external
short circuit faults for the nSmP topology is shown in Figs.
15. Note that we only consider cases when n > 1, which
means in each module there are at least two cells in series.
The set of sensor faults that needs to be diagnosed depends on
the selected sensor set. Every single cell has the possibility of
suffering from an internal short circuit. To represent internal
short circuit faults at the cell level, every cell in this battery

Fig. 14: Diagram of internal and external short circuit for
mPnS battery pack topology

Fig. 15: Diagram of internal and external short circuit for
nSmP battery pack topology

IEEE , VOL. XX, NO. XX, JANUARY 2021

11

TABLE VI: Summary of the minimal sensor set to achieve fault isolability for mPnS topology (n > 0, m > 1) (Z represents
current or temperature)

# of module Topology

Sensor set

# of sensors # of choices

n=1

n=2

n>2

2P1S
3P1S
.
.
.
mP1S

2P2S
.
.
.
mP2S

2P3S
.
.
.
mP3S
.
.
.
mPnS

{yIBP 1 , yIBP 2 , yZ11 , yZ12 }
{yIBP 1 , yIBP 2 , yZ11 , yZ12 , yZ13 }
.
.
.
{yIBP 1 , yIBP 2 , yZ11 , · · · , yZ1j , · · · , yZ1m }

{yIBP , yZ11 , yZ12 , yZ21 , yZ22 }
.
.
.
{yIBP , yZ11 , · · · , yZij , · · · , yZ2m }

{yZ11 , yZ12 , yZ21 , yZ22 , yZ31 yZ32 }
.
.
.
{yZ11 , · · · , yZij , · · · , yZ3m }
.
.
.
{yZ11 , · · · , yZij , · · · , yZnm }

2 + 1 × 2
2 + 1 × 3
.
.
.
2 + 1 × m

1 + 2 × 2
.
.
.
1 + 2 × m

3 × 2
.
.
.
3m
.
.
.
nm

22
23
.
.
.
2m

22m
.
.
.
22m

23m
.
.
.
23m
.
.
.
2nm

pack topology is modeled with an internal short circuit fault
signal in it. The set of internal short circuit faults we seek
to diagnose is {fscI,11, · · · , fscI,ij, · · · , fscI,nm,}. For nSmP
topology, if more than one module suffers from an external
short circuit, it is not possible to isolate these external short
circuits from one other. So, when the sensor placement for
fault isolability is performed, only one external short circuit
is considered in the pack, and therefore only one external
short circuit fault {fscE,j} is to be diagnosed. If Module j is
suffering from an external short circuit, all cells in this faulty
module are shorted by this fault as shown in Fig. 15. Since
every module has the possibility of experiencing an external
short circuit, we ﬁnd the minimal sensor set that can achieve
faults isolability regardless the location of external short cir-
cuit. For the nSmP topology, the possible sensor positions are
{IBP , u11, · · · , uij, · · · , unm}. u represents current, voltage
or temperature.

Table VII lists the minimal sensor set

to achieve fault
isolability for nSmP topology regardless the location of ex-
ternal short circuit fault signal. To uniquely isolate each fault,
the sensor set installation needs to meet the following two
requirements at the same time:

1) when m = 1, each cell should be equipped with one
sensor Y which can measure voltage or temperature;
when m > 1, in each module, n − 1 cells should be
equipped with a sensor Y which can measure voltage or
temperature. These n − 1 cells can be chosen arbitrarily
from the n cells in each module;

2) duplicate sensors to measure the load current IBP .
As explained for the case of nSmP topology, the need of
multiple load current measurements depends on how many
times the variable IBP appears in equations. Since in the
equations of the nSmP topology, IBP appears only once (see
Appendix A.B), two load current sensors are needed to achieve
complete fault isolation. If two nSmP packs are connected in
series, only one load current sensor is needed. If more than
two nSmP packs are connected in series, a load current sensor
is no longer necessary because of the redundancy of IBP

intrinsically contained in the equations (instances of KCL).

In this section, the minimal sensor sets obtained using the
sensor placement toolbox for two generalized battery pack
topologies are illustrated. The minimal sensor set is the least
among all sensor sets that can provide the system with a
sufﬁcient degree of AR to isolate every fault. A sufﬁcient
degree of AR permits ﬁnding different MSO subsystems,
and each MSO subsystem can then generate a residual after
choosing a proper matching, as illustrated in Section III. Each
residual is sensitive to a certain set of faults. With the fault
signature matrix, solutions can be found to make every fault
uniquely isolable from other faults.

Note that the process of ﬁnding the minimal sensor set using
sensor placement toolbox doesn’t consider whether there is a
loop or not that needs to be solved to compute the unknown
variables and generate the residuals in a matching (if no loop
is present, then the solution can be derived from a alternated
chain). The presence of loops will increase the computational
effort and may limit the implementation of FDI scheme in
practical application. Thus, we deﬁne an optimal sensor set to
be one that satisﬁes the isolability requirement and that has
minimal computational effort. If a system is equipped with the
minimal sensor set and there is not any computational loops
in the residual generation, then, this minimal sensor set is also
the optimal one. Otherwise, additional sensors are needed to
form the optimal sensor set that results in no computational
loops. The optimal sensor sets for two generalized battery pack
topologies are discussed in Section V-A

V. FINAL COMMENTS AND REMARKS
The methodology for battery pack fault diagnosis illustrated
in this paper is based on understanding and exploiting the an-
alytical redundancy in the system. The analytical redundancy
required for fault diagnosis is in part inherently present in
the analytical equations of the system, and in part added by
installing sensors, which, in the context of structural analysis,
convert unknown variables into known variables and help
us determine which variables play a key role in diagnosing

IEEE , VOL. XX, NO. XX, JANUARY 2021

12

TABLE VII: Summary of the minimal sensor set to achieve fault isolability for nSmP topology (n > 1, m > 0) (Y represents
voltage or temperature)

# of module Topology

Sensor set

# of sensors

# of choices

m=1

2S1P
3S1P
.
.
.
nS1P

{yIBP 1 , yIBP 2 , yY11 , yY21 }
{yIBP 1 , yIBP 2 , yY11 , yY21 , yY31 }
.
.
.
{yIBP 1 , yIBP 2 , yY11 , · · · , yYi1 , · · · , yYn1 }

2 + 1 × 2
2 + 1 × 3
.
.
.
2 + 1 × n

m>1

nSmP

{yIBP 1 , yIBP 2 ,

m
(cid:80)
j=1

Aj }

Bj = {Yij }, i = 1, · · · , n
Aj ⊆ Bj and there are (n − 1) elements in Aj

22
23
.
.
.
2n

(cid:32)

2 + m × (n − 1)

2n−1 ×

(cid:33)(cid:33)m

(cid:32)

n − 1
n

the faults. The minimal sensor set to achieve internal short
circuit fault isolation is an intrinsic characteristics of each
topology. For the mPnS topology, the cells in each module
are in parallel so they share the same voltage. Thus only by
adding current or temperature sensor can the fault isolation at
the cell level be achieved. For nSmP topology, the cells in
each module are in series so there is only one current. Thus,
only voltage or temperature sensors can add redundancy to
permit fault isolation at the cell level. This duality is a natural
consequence of series vs. parallel circuits. On the other hand,
temperature sensors can be effective in both topologies, as
they are in principle sensitive to the heat generation caused
by an internal short circuit. On the contrary, in our models,
the external short circuit does not play a role in the heat
balance equation. While temperature sensors could in principle
be very useful, it is not practical to install temperature sensors
in each cell due to: i) their slow dynamic response; ii) their
cost; and iii) the difﬁculty in physically mounting the sensors
at the manufacturing stage. From the perspective of practical
application, when adding a current or voltage sensor can
provide the same FDI capability to a battery as adding a
temperature sensor, current or voltage sensor is a preferred
choice.

A. Optimal sensor set for FDI

According to the structural analysis for a single cell with
different measurements illustrated in Section III-D, see Fig. 11,
the addition of a voltage or a temperature sensor at the cell
level will create computational loops. Only by adding a current
sensor is it possible to express the solution in the form of
alternated chains that allow solving for the unknown variables
without the need to solve simultaneous equations (loops), and
therefore resulting in lower computational effort. Thus, the
minimal sensor set for each battery pack topology for FDI
obtained in IV-C and IV-D is further optimized by considering
both FDI capability and computational effort.
The optimal sensor set for mPnS battery pack topology is
listed below:

1) each cell should be equipped with a current sensor,
preferred to a temperature sensor which would result
in computational loops in residual generation and which
also has some practical limitations as explained earlier;
2) two sensors to measure the load current IBP when n =
1; one sensor to measure the load current when n = 2;

no sensor is needed to measure the battery pack current
when n > 2.

The optimal sensor set for nSmP battery pack topology is:

1) when m = 1, each cell should be equipped with a
voltage sensor; when m > 1, in each module, n − 1
cells should be equipped with a voltage sensor. These
n − 1 cells can be chosen arbitrarily from the n cells
in each module; While in theory a temperature sensor
could be used in place of a voltage sensor, in the optimal
set we remove this option for the practical reasons stated
earlier.

2) each module should be equipped with a current sensor
since when each cell’s current is known, computational
loops are avoided in residual generation.

3) duplicate sensors to measure the load current IBP .

B. Traditional sensor set evaluation

Today, the most common sensor set for battery packs used

in automotive applications includes [59]:

1) a load current sensor to measure IBP ;
2) voltage sensors for each cell to permit voltage balancing
and over-charge/over-discharge protection functions in
the BMS (in the mPnS topology cells that are in parallel
share a single voltage sensor, in the nSmP topology each
cell has its own voltage sensor);
3) a temperature sensor per module.

In this paper, we refer to this sensor set as the traditional
one. To evaluate the diagnosability for traditional sensor set,
thermal model at module level is needed to provide a module
temperature variable (T M ) to permit place a temperature sen-
sor per module for monitoring any over-temperature conditions
and thus correctly managing the cooling system..
Thermal model for Module i in mPnS topology:

T M
i =

1
m

m
(cid:88)

j=1

kijTij

Thermal model for Module j in nSmP topology:

T M
j =

1
n

n
(cid:88)

i=1

kijTij

(25)

(26)

Where kij represents the weighted average temperature of the
module and it depends on the distance between the ijth cell

IEEE , VOL. XX, NO. XX, JANUARY 2021

13

Fault

isolability matrix

16:
battery

Fig.
ogy
{yIBP , yV M

1

, yV M

2

pack
, yV M

3

with

, yT M

1

, yT M

2

of
traditional
, yT M

}

3

3P3S
sensor

topol-
set

Fault

17:
battery

Fig.
ogy
{yIBP , yT M
, yT M
yV13 , yV23, yV33 }

2

1

isolability matrix

3S3P
of
sensor
traditional
, yV11 , yV21, yV31, yV12 , yV22, yV32 ,

with

pack
, yT M

3

topol-
set

and the temperature sensor. This model assumes that thermal
connections among cells follow the same architecture of the
electrical connections within the module, and that there is no
thermal interaction between modules.

the cell

An mPnS battery pack with a traditional sensor set has
the ability to detect all faults. As for isolability, a traditional
sensor set can isolate faults in a module from faults in another
module while it fails to isolate every fault within the module
(at
level). For example, Fig. 16 shows the fault
isolability matrix of a 3P3S topology battery pack with a
traditional sensor set. It can be seen that the battery pack
current sensor fault can be uniquely isolated from the other
faults, while faults in Modules 1, 2 and 3 are isolable from
each other but faults within the module cannot be uniquely
isolated. In each module, module voltage sensor fault, module
temperature sensor fault and external short circuit fault are
isolated from each other, while they are all not isolated from
the three internal short circuit. The three internal short circuit
faults are not isolable from each other. If the 3P3S topol-
ogy battery pack were equipped with the optimal sensor set
{yI11 , yI12, yI13, yI21 , yI22, yI23, yI31 , yI32, yI33} resulting from
the analysis done in this paper, all faults could be uniquely
isolated from each other. However, the optimal sensor set does
not include voltage sensors, which suggests that in a mPnS
battery pack equipped with only the optimal sensor set for
FDI, the BMS would not be able to perform voltage balancing.
Likewise, a mPnS battery pack equipped with only a voltage
sensor in each module for balancing would not achieve FDI.
For a nSmP topology battery pack with the traditional
sensor set, the faults in each cell can be uniquely isolated. The
battery pack current sensor fault and the external short circuit
fault cannot be isolated from each other, but can be isolated
from the other faults. In each module, the temperature sensor
fault
isolable from the internal short circuit faults.
Similarly, 3S3P is chosen as an example and assume that the
external short circuit is in Module 1. Fig. 17 shows the fault
isolability matrix of 3S3P topology with the traditional sensor
set. It can be seen that the load current sensor fault and
external short circuit fault fall in the same equivalent class and
cannot be isolated from each other. Internal short circuit fault
in each cell are isolated from each other while in each module,
isolable from
the module temperature sensor fault

is not

is not

3

2

1

, yIM

, yIM

the three internal short circuit faults. If the 3S3P topology
battery pack were equipped with the optimal sensor set
, yV11 , yV12, yV21 , yV22 , yV31, yI32}
{yIBP 1 , yIBP 2 , yIM
derived in this paper, all faults could be uniquely isolated
from each other. Note that in the optimal sensor set for nSmP
topology, although a current sensor needs to be added in each
module, two instead of three voltage sensors are sufﬁcient
isolation,
for each module (series string) to achieve fault
no matter in which module the external short circuit fault
occurs. This indicates that for nSmP battery pack topology,
the voltage sensor that has been already installed in each cell
for balancing can be also used as a part of the optimal sensor
set for FDI.

Finally, it should be pointed out that as long as the sensor
set selected in a pack design includes as a subset the optimal
diagnostic sensor set for isolability derived in this paper,
multiple design objectives can be met.

VI. CONCLUSION
The work presented in this paper uses the tools of structural
analysis for diagnosis to derive some fundamental character-
istics of two principal battery pack topologies from a diag-
nostic perspective. The equivalent circuit models and lumped-
parameter thermal models used to represent each cell permit
the determination of the analytical redundancy that is intrinsic
in the battery system (always -1 regardless of pack topology
and number of cells). The methods developed in this work
are ﬁrst applied to the simplest representation (a single cell)
to illustrate how one can select a minimal/optimal sensor set
to achieve detectability and isolability of faults, and are then
generalized to the mPnS and nSmP topologies to yield results
that are generally applicable to either topology regardless of
cell number. Further, the model and methods applied to a
single cell can be applied in exactly the same way at the
module level, regardless of the module internal conﬁguration,
thus making this approach completely scalable - a property
that is very important when one considers applications with
hundreds or thousands of individual cells, such as in automo-
tive, aerospace and grid support applications. For future work,
we are interested in exploring a distributed FDI scheme for a
battery pack installed with an optimal sensor set presented in
this work.

IEEE , VOL. XX, NO. XX, JANUARY 2021

14

A. Model for mPnS topology battery pack with faults:

APPENDIX A

n > 0; m > 1; i = 1, · · · , n; j = 2, · · · , m
e1 : Vij = Voc,ij − Rij(Iij + IscI,ij)
dt = − (Iij +IscI,ij )
e2 : dSoCij
Qij
e3 : Voc,ij = f (SoCij)
dTij
e4 : mcp
e5 : IscI,ij =

dt = Rij((Iij + IscI,ij))2 − QT M Sij

fscI,ij

(cid:17)

e6 : IscE,i =
e7 : Ii1 + Ii2 + · · · + Iij = IBP + IscE,i
e8 : Vi1 = Vi2 = · · · = Vij

fscE,i

(cid:16) Vij
RscI
(cid:16) Vi1
RscE

(cid:17)

B. model for nSmP topology battery pack with faults:

dt = Rij((Iij + IscI,ij))2 − QT M Sij

m > 0; n > 1; i = 2, · · · , n; j = 1, · · · , m
e1 : Vij = Voc,ij − Rij(Iij + IscI,ij)
dt = − (Iij +IscI,ij )
e2 : dSoCij
Qij
e3 : Voc,ij = f (SoCij)
dTij
e4 : mcp
e5 : IscI,ij =
e6 : V1j + · · · + Vij + · · · + Vnj = V M
j
e7 : I1j = · · · = Iij = · · · = Inj = I M
j
e8 : I M
m = IBP
e9 : V M
If Module j suffers from the external short circuit as shown

j + · · · + I M
j = · · · = V M

1 + · · · + I M
1 = · · · = V M

m = VBP

(cid:16) Vij
RscI

fscI,ij

(cid:17)

in Fig.15, e7 should be substituted by e10 and e11.
(cid:16) V1j +···+Vij +···+Vnj
RscE

e10 : IscE,j =
e11 : I1j = · · · = Iij = · · · = Inj = I M

fscE,j
j + IscE,j

(cid:17)

REFERENCES

[1] E. Chemali, M. Preindl, P. Malysz, and A. Emadi, “Electrochemical
and electrostatic energy storage and management systems for electric
drive vehicles: State-of-the-art review and future trends,” IEEE Journal
of Emerging and Selected Topics in Power Electronics, vol. 4, no. 3, pp.
1117–1134, 2016.

[2] M. Tariq, A. I. Maswood, C. J. Gajanayake, and A. K. Gupta, “Aircraft
batteries: current trend towards more electric aircraft,” IET Electrical
Systems in Transportation, vol. 7, no. 2, pp. 93–103, 2016.

[3] R. Jansen, C. Bowman, A. Jankovsky, R. Dyson, and J. Felder,
“Overview of nasa electriﬁed aircraft propulsion (eap) research for
large subsonic transports,” in 53rd AIAA/SAE/ASEE Joint Propulsion
Conference, 2017, p. 4701.

[4] C. Perullo, A. Alahmad, J. Wen, M. D’Arpino, M. Canova, D. N. Mavris,
and M. J. Benzakein, “Sizing and performance analysis of a turbo-
hybrid-electric regional jet for the nasa uli program,” in AIAA Propulsion
and Energy 2019 Forum, 2019, p. 4490.

[5] M. Faisal, M. A. Hannan, P. J. Ker, A. Hussain, M. B. Mansor,
and F. Blaabjerg, “Review of energy storage system technologies in
microgrid applications: Issues and challenges,” Ieee Access, vol. 6, pp.
35 143–35 164, 2018.

[6] U. Abronzini, C. Attaianese, M. D’Arpino, M. Di Monaco, and
G. Tomasso, “Cost minimization energy control including battery aging
for multi-source ev charging station,” Electronics, vol. 8, no. 1, p. 31,
2019.

[7] Y. Cai, M. Cancian, M. D’Arpino, and G. Rizzoni, “A generalized
equivalent circuit model for large-scale battery packs with cell-to-cell
variation,” in NAECON 2019-IEEE National Aerospace and Electronics
Conference. IEEE, 2019.

[8] A. Cordoba-Arenas, S. Onori, and G. Rizzoni, “A control-oriented
lithium-ion battery pack model for plug-in hybrid electric vehicle cycle-
life studies and system design with consideration of health management,”
Journal of Power Sources, vol. 279, pp. 791–808, 2015.

[9] X. Shu, W. Yang, Y. Guo, K. Wei, B. Qin, and G. Zhu, “A reliability
study of electric vehicle battery from the perspective of power supply
system,” Journal of Power Sources, vol. 451, p. 227805, 2020.

[10] X. Hu, K. Zhang, K. Liu, X. Lin, S. Dey, and S. Onori, “Advanced fault
diagnosis for lithium-ion battery systems: A review of fault mechanisms,
fault features, and diagnosis procedures,” IEEE Industrial Electronics
Magazine, vol. 14, no. 3, pp. 65–91, 2020.

[11] M. Held and R. Br¨onnimann, “Safe cell, safe battery? battery ﬁre in-
vestigation using fmea, fta and practical experiments,” Microelectronics
Reliability, vol. 64, pp. 705–710, 2016.

[12] F. Filippetti, M. Martelli, G. Franceschini, and C. Tassoni, “Development
of expert system knowledge base to on-line diagnosis of rotor electrical
faults of induction motors,” in Conference Record of the 1992 IEEE
Industry Applications Society Annual Meeting.
IEEE, 1992, pp. 92–99.
[13] V. K. Muddappa and S. Anwar, “Electrochemical model based fault di-
agnosis of li-ion battery using fuzzy logic,” in ASME 2014 International
Mechanical Engineering Congress and Exposition. American Society
of Mechanical Engineers Digital Collection, 2014.

[14] Y. Zheng, X. Han, L. Lu, J. Li, and M. Ouyang, “Lithium ion battery
pack power fade fault identiﬁcation based on shannon entropy in electric
vehicles,” Journal of Power Sources, vol. 223, pp. 136–146, 2013.
[15] M. Dubarry, C. Truchot, and B. Y. Liaw, “Cell degradation in commer-
cial lifepo4 cells with high-power and high-energy designs,” Journal of
Power Sources, vol. 258, pp. 408–419, 2014.

[16] B. Xia, Y. Shang, T. Nguyen, and C. Mi, “A correlation based fault
detection method for short circuits in battery packs,” Journal of power
Sources, vol. 337, pp. 1–10, 2017.

[17] X. Kong, Y. Zheng, M. Ouyang, L. Lu, J. Li, and Z. Zhang, “Fault
diagnosis and quantitative analysis of micro-short circuits for lithium-
ion batteries in battery packs,” Journal of Power Sources, vol. 395, pp.
358–368, 2018.

[18] R. Yang, R. Xiong, H. He, and Z. Chen, “A fractional-order model-based
battery external short circuit fault diagnosis approach for all-climate
electric vehicles application,” Journal of cleaner production, vol. 187,
pp. 950–959, 2018.

[19] Y. Zhao, P. Liu, Z. Wang, L. Zhang, and J. Hong, “Fault and defect
diagnosis of battery for electric vehicles based on big data analysis
methods,” Applied Energy, vol. 207, pp. 354–362, 2017.

[20] T. Kim, D. Makwana, A. Adhikaree, J. S. Vagdoda, and Y. Lee,
“Cloud-based battery condition monitoring and fault diagnosis platform
for large-scale lithium-ion battery energy storage systems,” Energies,
vol. 11, no. 1, p. 125, 2018.

[21] J. Huber, C. Tammer, S. Krotil, S. Waidmann, X. Hao, C. Seidel, and
G. Reinhart, “Method for classiﬁcation of battery separator defects using
optical inspection,” Procedia CIRP, vol. 57, pp. 585–590, 2016.
[22] W. Gao, Y. Zheng, M. Ouyang, J. Li, X. Lai, and X. Hu, “Micro-short-
circuit diagnosis for series-connected lithium-ion battery packs using
mean-difference model,” IEEE Transactions on Industrial Electronics,
vol. 66, no. 3, pp. 2132–2142, 2018.

[23] A. Sidhu, A. Izadian, and S. Anwar, “Adaptive nonlinear model-based
fault diagnosis of li-ion batteries,” IEEE Transactions on Industrial
Electronics, vol. 62, no. 2, pp. 1002–1011, 2014.

[24] H. M. Khalid, Q. Ahmed, and J. C.-H. Peng, “Health monitoring of li-
ion battery systems: A median expectation diagnosis approach (meda),”
IEEE Transactions on Transportation Electriﬁcation, vol. 1, no. 1, pp.
94–105, 2015.

[25] X. Feng, Y. Pan, X. He, L. Wang, and M. Ouyang, “Detecting the internal
short circuit in large-format lithium-ion battery using model-based fault-
diagnosis algorithm,” Journal of Energy Storage, vol. 18, pp. 26–39,
2018.

[26] S. Dey, H. E. Perez, and S. J. Moura, “Model-based battery thermal fault
diagnostics: Algorithms, analysis, and experiments,” IEEE Transactions
on Control Systems Technology, vol. 27, no. 2, pp. 576–587, 2017.
[27] X. Feng, C. Weng, M. Ouyang, and J. Sun, “Online internal short circuit
detection for a large format lithium ion battery,” Applied Energy, vol.
161, pp. 168–180, 2016.

[28] M. Ouyang, M. Zhang, X. Feng, L. Lu, J. Li, X. He, and Y. Zheng,
“Internal short circuit detection for battery pack using equivalent pa-
rameter and consistency method,” Journal of Power Sources, vol. 294,
pp. 272–283, 2015.

[29] M. Seo, T. Goh, M. Park, G. Koo, and S. W. Kim, “Detection of internal
short circuit in lithium ion battery using model-based switching model
method,” Energies, vol. 10, no. 1, p. 76, 2017.

[30] H. Zhang, L. Pei, J. Sun, K. Song, R. Lu, Y. Zhao, C. Zhu, and T. Wang,
“Online diagnosis for the capacity fade fault of a parallel-connected
lithium ion battery group,” Energies, vol. 9, no. 5, p. 387, 2016.

IEEE , VOL. XX, NO. XX, JANUARY 2021

15

[53] B. M. Rahman, “Sensor placement for diagnosis of large-scale, complex
systems: Advancement of structural methods,” Ph.D. dissertation, The
Ohio State University, 2019.

[54] A. Fotouhi, D. J. Auger, K. Propp, S. Longo, and M. Wild, “A review
on electric vehicle battery modelling: From lithium-ion toward lithium–
sulphur,” Renewable and Sustainable Energy Reviews, vol. 56, pp. 1008–
1021, 2016.

[55] G. L. Plett, Battery management systems, Volume I: Battery modeling.

Artech House, 2015, vol. 1.

[56] D. Freudiger, M. D’Arpino, and M. Canova, “A generalized equivalent
circuit model for design exploration of li-ion battery packs using data
analytics,” IFAC-PapersOnLine, vol. 52, no. 5, pp. 568–573, 2019.
[57] D. Jung, Y. Dong, E. Frisk, M. Krysander, and G. Biswas, “Sensor
selection for fault diagnosis in uncertain systems,” International Journal
of Control, vol. 93, no. 3, pp. 629–639, 2020.

[58] R. Bubbico, V. Greco, and C. Menale, “Hazardous scenarios identiﬁca-
tion for li-ion secondary batteries,” Safety science, vol. 108, pp. 72–88,
2018.

[59] H. Rahimi-Eichi, U. Ojha, F. Baronti, and M.-Y. Chow, “Battery
management system: An overview of its application in the smart grid
and electric vehicles,” IEEE Industrial Electronics Magazine, vol. 7,
no. 2, pp. 4–16, 2013.

[31] Z. Liu, Q. Ahmed, G. Rizzoni, and H. He, “Fault detection and
isolation for lithium-ion battery system using structural analysis and
sequential residual generation,” in ASME 2014 Dynamic Systems and
Control Conference. American Society of Mechanical Engineers Digital
Collection, 2014.

[32] Z. Liu, H. He, Q. Ahmed, and G. Rizzoni, “Structural analysis based
fault detection and isolation applied for a lithium-ion battery pack,”
IFAC-PapersOnLine, vol. 48, no. 21, pp. 1465–1470, 2015.

[33] Z. Liu, Q. Ahmed, J. Zhang, G. Rizzoni, and H. He, “Structural analysis
based sensors fault detection and isolation of cylindrical lithium-ion
batteries in automotive applications,” Control Engineering Practice,
vol. 52, pp. 46–58, 2016.

[34] R. Xiong, Q. Yu, W. Shen, C. Lin, and F. Sun, “A sensor fault
diagnosis method for a lithium-ion battery pack in electric vehicles,”
IEEE Transactions on Power Electronics, vol. 34, no. 10, pp. 9709–
9718, 2019.

[35] M. Blanke, M. Kinnaert, J. Lunze, M. Staroswiecki, and J. Schr¨oder,

Diagnosis and fault-tolerant control. Springer, 2006, vol. 2.

[36] A. L. Dulmage and N. S. Mendelsohn, “Coverings of bipartite graphs,”
Canadian Journal of Mathematics, vol. 10, pp. 517–534, 1958.
[37] A. L. Dulmage, “A structure theory of bipartite graphs of ﬁnite exterior
dimension,” The Transactions of the Royal Society of Canada, Section
III, vol. 53, pp. 1–13, 1959.

[38] M. Krysander and E. Frisk, “Sensor placement for fault diagnosis,” IEEE
Transactions on Systems, Man, and Cybernetics-Part A: Systems and
Humans, vol. 38, no. 6, pp. 1398–1410, 2008.

[39] M. Meyer, J. Le Lann, B. Koehret, and M. Enjalbert, “Optimal selection
of sensor location on a complex plant, using a graph oriented approach,”
Computers & Chemical Engineering, vol. 18, pp. S535–S540, 1994.

[40] T. Carpentier, R. Litwak, and J.-P. Cassar, “Criteria for the evaluation of
fdi systems application to sensors location,” IFAC Proceedings Volumes,
vol. 30, no. 18, pp. 1081–1086, 1997.

[41] C. Svard and M. Nyberg, “Residual generators for fault diagnosis
using computation sequences with mixed causality applied to automotive
systems,” IEEE Transactions on Systems, Man, and Cybernetics-Part A:
Systems and Humans, vol. 40, no. 6, pp. 1310–1328, 2010.

[42] C. Sundstr¨om, E. Frisk, and L. Nielsen, “Selecting and utilizing se-
quential residual generators in fdi applied to hybrid vehicles,” IEEE
Transactions on Systems, Man, and Cybernetics: Systems, vol. 44, no. 2,
pp. 172–185, 2013.

[43] J. Zhang, A. Amodio, T. Li, B. Aksun-G¨uvenc¸, and G. Rizzoni,
“Fault diagnosis and fault mitigation for torque safety of drive-by-wire
systems,” IEEE Transactions on Vehicular Technology, vol. 67, no. 9,
pp. 8041–8054, 2018.

[44] M. Krysander, J. ˚Aslund, and M. Nyberg, “An efﬁcient algorithm for
ﬁnding minimal overconstrained subsystems for model-based diagnosis,”
IEEE Transactions on Systems, Man, and Cybernetics-Part A: Systems
and Humans, vol. 38, no. 1, pp. 197–206, 2007.

[45] E. Frisk, M. Krysander, and D. Jung, “A toolbox for analysis and
design of model based diagnosis systems for large scale models,” IFAC-
PapersOnLine, vol. 50, no. 1, pp. 3287–3293, 2017.

[46] P. Polverino, E. Frisk, D. Jung, M. Krysander, and C. Pianese, “Model-
based diagnosis through structural analysis and causal computation for
automotive polymer electrolyte membrane fuel cell systems,” Journal of
Power Sources, vol. 357, pp. 26–40, 2017.

[47] Q. Chen, Q. Ahmed, and G. Rizzoni, “Sensor placement analysis for
fault detectability and isolability of an automated manual transmission,”
in HRI 2014, 2014.

[48] S. J. Trask, G. J. Jankord, A. A. Modak, B. M. Rahman, G. Rizzoni,
S. W. Midlam-Mohler, and G. R. Guercioni, “System diagnosis and fault
mitigation strategies for an automated manual transmission,” in ASME
2017 Dynamic Systems and Control Conference. American Society of
Mechanical Engineers Digital Collection, 2017.

[49] Q. Ahmed, M. Arasu, J. Zhang, and G. Rizzoni, “Sensors instal-
lation guide to monitor automatic transmission performance,” IFAC-
PapersOnLine, vol. 49, no. 11, pp. 736–741, 2016.

[50] Q. Chen, Q. Ahmed, G. Rizzoni, and M. Qiu, “Design and evaluation
of model-based health monitoring scheme for automated manual trans-
mission,” Journal of Dynamic Systems, Measurement, and Control, vol.
138, no. 10, 2016.

[51] Q. Chen, W. Tian, W. Chen, Q. Ahmed, and Y. Wu, “Model-based
fault diagnosis of an anti-lock braking system via structural analysis,”
in Sensors, 2018.

[52] J. Zhang, H. Yao, and G. Rizzoni, “Fault diagnosis for electric drive
systems of electriﬁed vehicles based on structural analysis,” IEEE
Transactions on Vehicular Technology, vol. 66, pp. 1027–1039, 2017.

