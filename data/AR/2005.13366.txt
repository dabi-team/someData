Weakly Supervised Vessel Segmentation in X-ray Angiograms by Self-Paced
Learning from Noisy Labels with Suggestive Annotation

Jingyang Zhanga,d,e, Guotai Wangb, Hongzhi Xiec,‚àó, Shuyang Zhangc, Ning Huange, Shaoting Zhange, Lixu Gua,d,‚àó

aSchool of Biomedical Engineering, Shanghai Jiao Tong University, Shanghai, China
bSchool of Mechanical and Electrical Engineering, University of Electronic Science and Technology of China, Chengdu, China
cDepartment of Cardiothoracic Surgery, Peking Union Medical College Hospital, Beijing, China
dInstitute of Medical Robotics, Shanghai Jiao Tong University, Shanghai, China
eSenseTime Research, Shanghai, China

0
2
0
2

y
a
M
7
2

]

V
C
.
s
c
[

1
v
6
6
3
3
1
.
5
0
0
2
:
v
i
X
r
a

Abstract

The segmentation of coronary arteries in X-ray angiograms by convolutional neural networks (CNNs) is promising yet
limited by the requirement of precisely annotating all pixels in a large number of training images, which is extremely
labor-intensive especially for complex coronary trees. To alleviate the burden on the annotator, we propose a novel weakly
supervised training framework that learns from noisy pseudo labels generated from automatic vessel enhancement, rather
than accurate labels obtained by fully manual annotation. A typical self-paced learning scheme is used to make the
training process robust against label noise while challenged by the systematic biases in pseudo labels, thus leading to
the decreased performance of CNNs at test time. To solve this problem, we propose an annotation-reÔ¨Åning self-paced
learning framework (AR-SPL) to correct the potential errors using suggestive annotation. An elaborate model-vesselness
uncertainty estimation is also proposed to enable the minimal annotation cost for suggestive annotation, based on not only
the CNNs in training but also the geometric features of coronary arteries derived directly from raw data. Experiments
show that our proposed framework achieves 1) comparable accuracy to fully supervised learning, which also signiÔ¨Åcantly
outperforms other weakly supervised learning frameworks; 2) largely reduced annotation cost, i.e., 75.18% of annotation
time is saved, and only 3.46% of image regions are required to be annotated; and 3) an eÔ¨Écient intervention process,
leading to superior performance with even fewer manual interactions.

Keywords: Convolutional neural network, weakly supervised learning, self-paced learning, suggestive annotation,
vessel segmentation

1. Introduction

Coronary artery disease (CAD) is one of the leading
causes of death globally [1]. It is primarily caused by ob-
structive atherosclerotic plaque [2], which narrows the in-
ner wall of coronary artery and decreases normal myocar-
dial perfusion, leading to symptoms such as angina and
even myocardial infarction [3]. Percutaneous coronary in-
tervention (PCI) is a minimally invasive surgery to eÔ¨Äec-
tively treat CAD in clinical practice. In such a procedure,
a cardiologist delivers a catheter with a premounted stent
through coronary arteries to the stenosis lesion. Once the
lesion is reached, the stent is deployed against the nar-
row coronary wall by inÔ¨Çating the delivery balloon. Since
target vessels are not directly visible, PCI is performed
under image guidance by using X-ray angiography to vi-
sualize coronary arteries for the injection of radiopaque
contrast agent. The accurate segmentation of vessels in

‚àóCorresponding author
Email addresses: xiehongzhi@medmail.com.cn (Hongzhi Xie),

gulixu@sjtu.edu.cn (Lixu Gu)

Preprint submitted to Elsevier

X-ray angiograms (XAs) enables the quantitative analy-
sis of coronary trees [4] and is fundamental for the safe
navigation of intervention devices for PCI surgery.

Deep learning with convolutional neural networks
(CNNs) has achieved the state-of-the-art performance for
medical image segmentation [5, 6, 7], including vessel seg-
mentation in XA [8, 9]. Following the fully supervised
learning framework, its success relies heavily on a large
amount of precise annotations for all pixels in training im-
ages to improve generalization capability for unseen test-
ing images. However, precisely annotating coronary ar-
teries is costly and requires special expertise, especially
for thin branches with tubular appearance and low con-
trast in XA. To alleviate such heavy annotation burden
on the annotator, reducing the amount of precise manual
annotations is highly demanded in clinical practice [10].
In contrast, obtaining noisy pseudo labels appears to be
less expensive. SpeciÔ¨Åcally, vessel enhancement [11] au-
tomatically extracts vascular structures based on hand-
craft priors [12], providing a feasible method for generat-
ing pseudo labels for training CNNs without any manual
interaction. This can largely reduce the manual annota-

May 28, 2020

 
 
 
 
 
 
commonly based on the widely used model uncertainty
[23], i.e., the entropy of CNNs. The required annotation
cost can be successfully reduced owing to the eÔ¨Äective ex-
ploration of potential errors. However, model uncertainty
fails to exploit geometric features derived directly from
training images, resulting in redundancy among queries
[24, 25] and a low eÔ¨Éciency for manual interaction.
In
contrast, considering the vesselness of pixels is expected
to lead to more context-aware uncertainty estimation as it
takes advantage of vascular geometric features. Since the
model uncertainty and vesselness uncertainty are comple-
mentary, we believe that their combination would provide
more reliable uncertainty estimation that eÔ¨Éciently guides
user interaction in suggestive annotation.

To solve these problems, this paper develops a novel
weakly supervised vessel segmentation framework, which
learns from cost-free but noisy pseudo labels generated
from automatic vessel enhancement. SpeciÔ¨Åcally, to over-
come noisy pseudo labels with systematic biases, we pro-
pose to progressively guide the naive self-paced learn-
ing with auxiliary sparse manual annotations, which is
called annotation-reÔ¨Åning self-paced learning (AR-SPL).
AR-SPL not only exploits the available knowledge from
noisy pseudo labels, but also corrects potential errors us-
ing their corresponding manual annotations. These man-
ual annotations, even when sparse in training images, play
an important role in hedging the risk of learning from noisy
pseudo labels. Furthermore, to enable a minimal set of an-
notations, we propose a model-vesselness uncertainty esti-
mation for suggestive annotation, which dynamically and
compactly takes into account the trained CNN and the
geometric features of coronary arteries in XAs.

1.1. Contributions

The contributions of this work are three-fold.

‚Ä¢ First, we propose a novel weakly supervised learning
framework in the context of vessel segmentation, aim-
ing to safely learn from noisy pseudo labels generated
by vessel enhancement without performance deterio-
ration at test time.

‚Ä¢ Second, to deal with the biased label noise, we develop
online guidance for the naive self-paced learning based
on sparse manual annotations, which is crucial for a
signiÔ¨Åcant segmentation performance boost.

‚Ä¢ Third, towards minimal manual intervention, we pro-
pose a customized vesselness uncertainty based on
vascular geometric feature, and then couple it with
the widely used model uncertainty by a dynamic
tradeoÔ¨Ä for more eÔ¨Écient suggestive annotation.

Experiments demonstrate the eÔ¨Äectiveness and eÔ¨É-
ciency of the proposed framework, where only a very small
set of manual annotations can lead to an accurate segmen-
tation result that is comparable to the fully supervised
learning.

Figure 1: Noisy pseudo labels generated from vessel enhancement,
where the systematic errors are highlighted by yellow arrows.

tions required for model training, while leading to noise
with systematic biases in pseudo labels for structures, such
as bifurcation points and thin vessels with small scales,
as shown in Fig. 1. These noisy pseudo labels challenge
the learning process and cause performance degradation
of CNNs at test time [13].
It is desirable to develop a
robust training framework against systematic label noise
and facilitate segmentation performance close to the fully
supervised learning framework.

Aimed at robustly learning from noisy labels, some pre-
vious weakly supervised training frameworks model label
noise explicitly as an additional network layer [14, 15, 16]
or implicitly using prior knowledge [17, 18]. Among
them, researchers have shown that the self-paced learning
paradigm can be substantially eÔ¨Äective and scalable [19],
owing to its predeÔ¨Åned self-paced regularizer [20]. This
learning paradigm typically assumes a plain distribution
of label noise without systematic biases to speciÔ¨Åc seg-
mentation regions and semantic categories. An iterative
optimization process is used to facilitate noise robustness
In each iteration, the self-paced regular-
of the model.
izer progressively selects only easy pixels while excluding
diÔ¨Écult pixels with potential label noise from model train-
ing. Noisy labels are modiÔ¨Åed automatically by updating
the segmentation results of training images based on the
current model. They are expected to contain fewer er-
rors than those in previous iterations, providing improved
supervision for the next iteration. Unfortunately, this self-
paced learning paradigm may make the model overÔ¨Åt on
easy pixels, leading to a poor generalization performance
at test time. Moreover, the noise in pseudo labels often
contains speciÔ¨Åc biases due to the inherent limitations of
vessel enhancement-based generation process. Using this
naive self-paced learning paradigm alone has only the lim-
ited ability to correct the erroneous pseudo labels.

Manually detecting and correcting potentially erroneous
pseudo labels is a practical way to avoid the self-paced
learning being corrupted by systematic errors, while it is
still labor-intensive and time-consuming. Suggestive anno-
tation [21] has been shown to be a more eÔ¨Écient method
for interactive reÔ¨Ånement by intelligently selecting a small
number of the most valuable pixels and then querying their
labels. It suggests the annotator accurately label only the
most uncertain pixels with potentially incorrect labels [22],

2

X-ray AngiogramPseudo Label1.2. Related Works
1.2.1. Vessel Segmentation in XA

In the past two decades, a wide range of methods have
been proposed to segment coronary arteries in XAs, in-
cluding the active contour model [26], level set [27] and
random walker [28]. Most of these methods are semi-
automatic and sensitive to the initialization of interac-
tion, leading to the lack of robustness and accuracy when
faced with nununiform illumination and opaque back-
ground structures. Recently, vessel segmentation in XAs
has been dominated by deep learning with CNNs, such as
a multiscale CNN architecture [8] with fully convolutional
connections and a multistage framework [9] to reduce mo-
tion artifacts in the background. However, they all follow
the fully supervised learning scheme, which requires pre-
cise annotations for all pixels in a large number of training
images. To the best of our knowledge, in the context of
vessel segmentation, there is no previous perspective that
focuses on weakly-supervised learning from noisy labels,
i.e., generated by vessel enhancement [11].

1.2.2. Learning from Noisy Labels

For deep learning with CNNs, noise in training labels
inevitably leads to performance degradation at test time
[13]. How to improve robustness of CNNs when learn-
ing from noisy labels is worthy of exploration. This chal-
lenge is especially signiÔ¨Åcant yet under-studied for medi-
cal image analysis. An explicit noise model is constructed
in [14] to overcome the unreliable noisy annotations for
breast lesion, which uses a constrained linear layer [15]
and a noise adaptation layer [16]. Some other works im-
plicitly treat noisy labels as statistical outliers based on
prior knowledge. For example, perceptual consistency
proposed in bootstrapping [17] is used to augment and
modify noisy labels to mitigate their potential degrada-
tion. This consistency-based prior knowledge further in-
spires the label-noise-robust method [29] for cardiac and
glioma segmentation in MRI, where model updating is only
performed on data samples with inconsistent predictions
in the two-stream module. Learning diÔ¨Éculty is another
prior knowledge to identify noisy samples and then down-
weight them during training. Pixel-wise down-weighting
strategy shows robustness for highly inaccurate annota-
tions for skin lesion segmentation [18] and thoracic organ
segmentation [30]. Towards higher eÔ¨Äectiveness and scal-
ability, self-paced learning [20, 19, 31] uses a curriculum
setting (also called self-paced regularizer), where learning
diÔ¨Éculty is updated in parallel with network parameters
via alternating optimization. Despite an elegant theoret-
ical proof, these methods fail to Ô¨Åt the intractable label
noise in vessel enhancement, which exhibits more compli-
cated and systematic characteristics.

1.2.3. Suggestive Annotation with Uncertainty Estimation
Suggestive annotation [21] is proposed to choose partial
training data for labeling, aimed at a better model perfor-
mance given a limited annotation budget. In general, there

are two main types: geometry sampling and uncertainty
sampling. Geometry sampling queries samples based on
the geometric distribution of training data, such as repre-
sentativeness [32] among unlabeled samples and diversity
[33] from labeled samples. However, these distribution
measures are challenged by the highly imbalanced fore-
ground and background in XAs. In addition, uncertainty
sampling queries the most uncertain samples for their la-
bels commonly based on model uncertainty [23], which is
also called epistemic uncertainty for CNNs. The accu-
rate estimation of model uncertainty relies on the com-
putationally infeasible Bayesian networks, which can be
approximated using Monte Carlo sampling with dropout
at test time [23]. Model uncertainty proves a strong rela-
tionship with prediction errors [22] and thus a promising
ability to reduce manual annotations, while it is limited
by redundant queries especially during an early training
stage [24, 25]. To the best of our knowledge, to overcome
this drawback, this paper is the Ô¨Årst work to take into
account the geometric vascular feature for uncertainty es-
timation, which acts as an auxiliary cue for the commonly
used model uncertainty.

2. Method

The proposed weakly supervised training framework is
depicted in Fig. 2. It consists of three major parts: (A)
pseudo label generation based on automatic vessel en-
hancement; (B) an annotation-reÔ¨Åning self-paced learn-
ing framework (AR-SPL) that learns from pseudo labels
with online manual reÔ¨Ånement based on sparse annota-
tions; and (C) suggestive annotation with model-vesselness
uncertainty estimation to enable minimal annotation cost
for sparse annotations. Our framework is Ô¨Çexible because
it imposes few assumptions on network structure and can
be compatible with any popular CNN-based segmentation
backbone. Once this training process is completed, a test-
ing process obtains segmentation prediction by performing
forward-propagation without human interactions.

2.1. Pseudo Label Generation

Although precise labels are fundamental for training a
CNN for vessel segmentation, it is highly laborious to ob-
tain them by manually annotating all pixels in a large
number of training images. Vessel enhancement provides
a cost-free but noisy alternative for precise labels, called
pseudo labels, so as to largely reduce annotation cost as
compared with fully manual annotation. It extracts coro-
nary arteries automatically yet coarsely from background,
returning a vesselness map that quantitatively measures
vascular structures.

Towards a comprehensive leverage of temporal and ap-
pearance priors of coronary arteries, layer separation [11]
is a promising method for vessel enhancement, which sep-
arates the original XA into three independent layers, such
as a large-scale structure layer, a quasi-static background

3

Figure 2: Flow chart of the proposed weakly supervised training framework, which consists of three modules: (A) pseudo label generation; (B)
annotation-reÔ¨Åning self-paced learning framework (AR-SPL); and (C) suggestive annotation with model-vesselness uncertainty estimation.

layer and a vessel layer that contains coronary arteries.
SpeciÔ¨Åcally, we Ô¨Årst subtract the large-scale structure layer
from the original XA by a morphological closing operation,
and obtain a diÔ¨Äerence image containing the target coro-
nary arteries and residual quasi-static background struc-
tures with small scales. Then, robust principle component
analysis (RPCA) [12] is used to further separate the dif-
ference image into a quasi-static background layer and a
vessel layer based on the quasi-static motion constraint
and sparse appearance constraint, respectively. For each
training image xi, in order to take advantage of the ben-
eÔ¨Åcial temporal cue, layer separation is performed oÔ¨Ñine
on the entire temporal sequence Xi, which contains xi as
a contrast-Ô¨Ålled frame1. The decomposition of the vessel
layer sequence Si and background layer sequence Li via
RPCA is formulated as follows:

min
Li,Si

(cid:107)Li(cid:107)‚àó + Œæ (cid:107)Si(cid:107)1

s.t. DIi = Li + Si

(1)

where DIi is the sequence of diÔ¨Äerence images acquired by
the morphological closing operation on Xi. (cid:107)¬∑(cid:107)‚àó and (cid:107)¬∑(cid:107)1
are the nuclear norm and l1 norm, respectively. The regu-
larization parameter Œæ controls the tradeoÔ¨Ä between them,
indicating the capability of extracting candidate coronary
arteries in the separated vessel layers. Objective function
Eq. 1 has proven to be convex and can be solved by an
inexact augmented Lagrange multiplier method [34].

1During PCI, a cardiologist commonly acquires an XA sequence
rather than one single XA frame, recording the inÔ¨Çow and fade of
contrast agent through coronary arteries. However, only the key
frame with the contrast-Ô¨Ålled vessels is used for segmentation in this
study.

4

Figure 3: An example of pseudo label generated from layer separation
on the original XA.

After the RPCA decomposition, the separated vessel
layer si is treated as the vesselness map for xi by select-
ing the corresponding frame from Si. Finally, we apply
the Otsu thresholding to si, generating the pseudo label
yi (an example is shown in Fig. 3) that will be used in the
following AR-SPL to train a CNN for vessel segmentation.

2.2. Annotation-ReÔ¨Åning Self-Paced Learning (AR-SPL)

Pseudo labels are obtained automatically by vessel en-
hancement based on handcrafted priors in layer separa-
tion, which leads to inevitable noise due to complex back-
ground and inhomogeneous contrast inÔ¨Çow. These system-
atic rather than random label noise may deteriorate the
training of CNN for vessel segmentation if no additional
strategies are applied.

2.2.1. Naive Self-Paced Learning Scheme

We adopt a self-paced learning scheme [20] to overcome
the negative eÔ¨Äect of label noise on model training. It is
inspired by the cognitive processes of humans and animals,
where a CNN is learned gradually from pixels ranked in
descending order of learning diÔ¨Éculty while excluding dif-
Ô¨Åcult pixels with potentially noisy labels. This progressive

Vesselness UncertaintyModel UncertaintyModel-Vesselness UncertaintyQueried RegionTraining ImageLayer SeparationVesselness MapPseudo Label(A)Pseudo Label Generation(C)Suggestive Annotation with Model-VesselnessUncertainty EstimationSparse AnnotationTraining ImageSelf-Paced LabelLatent WeightSegmentation Model(B)Annotation-Refining Self-PacedLearning Framework (AR-SPL)ForegroundBackgroundSelf-Paced Learning Manual RefinementOriginal XALarge-Scale Structure LayerQuasi-Static Background Layer Vessel LayerPseudo Labelterm in Eq. 2. This involvement of the awareness of learn-
ing diÔ¨Éculty in model training improves the robustness
against label noise. Finally, we impose an l2 regulariza-
tion on W weighted by Œª to avoid model overÔ¨Åtting, as
shown by the third term in Eq. 2.

Objective function Eq. 2 can be minimized by alternat-
ing minimization strategy [20], where W , Y and V are
alternatively minimized one at a time, while the other two
are Ô¨Åxed. The minimization in iteration k consists of the
following steps:

W (k) = argmin

W

m
(cid:88)

i

v(k‚àí1)
i

L

(cid:16)

y(k‚àí1)
i

, Œ¶ (xi|W )

(cid:17)

+ Œª(cid:107)W (cid:107)2

Y (k) = argmin

m
(cid:88)

(cid:16)

L

yi, Œ¶

xi|W (k)(cid:17)(cid:17)
(cid:16)

Y ‚àà{0,1}n√óm

i

(3)

(4)

V (k) = argmin

V ‚àà[0,1]n√óm

m
(cid:88)

viL

(cid:16)

y(k)
i

, Œ¶

(cid:16)

xi|W (k)(cid:17)(cid:17)

‚àí œÑ (cid:107)vi(cid:107)1

i
‚àí Œ≥ (cid:107)vi(cid:107)2

(5)

The superscript (k) represents the iteration index in alter-
nating minimization. When Y and V are Ô¨Åxed, the opti-
mization of W (Eq. 3) is converted to the minimization of
the sum of a weighted loss function and a regularization
term, which can be typically solved by back-propagation.
When W and V are Ô¨Åxed, the optimization of Y (Eq. 4)
is regarded as a model prediction problem and is solved by
forward-propagation on the CNN with the optimal param-
eter W (k) derived from Eq. 3. When W and Y are Ô¨Åxed,
the optimization of V (Eq. 5) can be accomplished by
SPLD algorithm [35]: pixels in each image are Ô¨Årst sorted
in ascending order of their losses and then assigned latent
o ‚àí 1) with
weights based on a threshold œÑ + Œ≥/(
respect to œÑ , Œ≥ and rank index o. SpeciÔ¨Åcally, pixel j in
xi with loss less than the threshold is selected as an easy
pixel and is involved in training via assigning v(k)
i,j = 1.
Otherwise, it will not be included via assigning v(k)
i,j = 0.
The CNN is further trained in the next iteration k + 1
using only the selected easy pixels by weighting the loss
function with V (k). Fig. 4 shows some examples of self-
paced labels and latent weights, i.e., in iteration 1, 2 and
3 of alternating minimization.

o +

‚àö

‚àö

2.2.2. Sparse Annotation-based Manual ReÔ¨Ånement

Naive self-paced learning scheme demonstrates the ro-
bustness for random label noise [20], while it is hampered
by systematic errors from vessel enhancement with speciÔ¨Åc
biases to structures, such as thin and terminal branches
with attenuated inÔ¨Çow of contrast agent. Focusing only
on easy pixels, the weighted loss function Eq. 3 may have
a risk of ignoring systematic biases in noisy labels and
thus lose crucial pixels for improving essential generaliza-
tion capability. This leads to a poor segmentation model

Figure 4: Examples of self-paced labels and latent weights in itera-
tions 1, 2 and 3 of alternating minimization for the naive self-paced
learning. Note that the systematic errors are maintained and even
ampliÔ¨Åed, as highlighted by the orange arrows.

training paradigm enables the model training to focus on
easy pixels whose labels have a higher chance to be cor-
rect. Formally, consider the vessel segmentation task in
XAs with a training set {(x1, y1) , ¬∑ ¬∑ ¬∑ , (xm, ym)}, where
xi ‚àà Rn denotes training image xi with n total pixels and
yi ‚àà {0, 1}n denotes its corresponding binary noisy pseudo
labels obtained from vessel enhancement. We formulate
the self-paced learning scheme as a minimization problem:

argmin
V ,Y ,W

(cid:80)m

i viL (yi, Œ¶ (xi|W )) + f (V ; œÑ, Œ≥) + Œª(cid:107)W (cid:107)2

s.t. V ‚àà [0, 1]n√óm

(2)
where W denotes the model parameters of the CNN.
V = [v1, v2, . . . , vm] represents the latent weights for all
m training images, in which vi ‚àà [0, 1]n is related to pixel-
wise learning diÔ¨Éculty for xi. It is empirically initialized
based on the obtained vesselness maps, as described in
Section 3.2. Intuitively, the easier a pixel is, the less likely
it is to have label noise: a higher latent weight should be
assigned in this case. This relationship is formulated as a
2,
self-paced regularizer f (V ; œÑ, Œ≥) = ‚àíœÑ (cid:107)V (cid:107)1 ‚àí Œ≥(cid:107)V (cid:107)2,1
where the easiness term (the negative l1 norm: ‚àí(cid:107)V (cid:107)1 =
‚àí (cid:80)m
i (cid:107)vi(cid:107)1) implicitly models the relationship between
learning diÔ¨Éculty and latent weight, and the diversity term
[35] (the negative l2,1 norm ‚àí(cid:107)V (cid:107)2,1 = ‚àí (cid:80)m
i (cid:107)vi(cid:107)2) im-
proves diversity between latent weights for more compre-
hensive knowledge. œÑ and Œ≥ are hyperparameters imposed
on these two terms, which control the learning pace dur-
ing model training. In addition, Y = [y1, y2, . . . , ym] are
called self-paced labels, where yi is initialized by the orig-
inal noisy pseudo label yi and acts as an online modiÔ¨Åed
version for noise reduction. Œ¶ (xi|W ) denotes a proba-
bility segmentation prediction of xi by a discriminative
function, i.e., the softmax layer of the CNN parameterized
by W . The cross-entropy loss between it and yi is denoted
by L (yi, Œ¶ (xi|W )), and it is weighted by vi as the Ô¨Årst

2It exhibits better performance than other state-of-the-art self-

paced regularizers, as shown in Supplementary Materials.

5

Self-Paced LabelLatent WeightTraining ImageIteration 1Iteration 2Iteration 3Systematic Errortematic label noise. However, there is still a problem re-
maining: how to determine the sparse annotations that
concentrate on a small number of valuable pixels with po-
tentially incorrect labels, in order to minimize manual in-
tervention as much as possible. This can be solved by
suggestive annotation with model-vesselness uncertainty
estimation, as introduced in Section 2.3.

2.2.3. Convergence Discussion

Under some suitable assumptions, we show in Theo-
rem 1 that the proposed AR-SPL with manual reÔ¨Ånement
can converge stably to a stationary point. The theoretical
proof is appended in Supplementary Materials. We show a
detailed characterization of the stability of model param-
eters during training since it is the only relevant variable
at test time. The experimental results in Section 3.4 also
demonstrate that when manual annotations are gradually
involved, the model achieves a higher segmentation per-
formance and Ô¨Ånally reaches a convergent result. In ad-
dition, following a similar argument, Theorem 1 can be
easily extended to imply the stability of latent weight and
self-paced label, respectively.

Theorem 1. Denote the objective function in Eq. 2 as
F (W , Y , V ). Let a uniÔ¨Åed optimization method,
i.e.,
scholastic gradient descent with learning step Œ±k, be used
to solve Eq. 3, 4, 5 in iteration k of alternating minimiza-
tion. Let Œ±k satisfy (cid:80)‚àû
k=0 Œ±k = ‚àû and (cid:80)‚àû
k=0 Œ±2
k < ‚àû.
(cid:104)(cid:13)
W (k), Y (k), V (k)(cid:17)(cid:13)
(cid:16)
(cid:105)
(cid:13)‚àáW F
(cid:13)
(cid:13)
Then, limk‚Üí‚àû E
= 0.
(cid:13)2

2.3. Suggestive Annotation with Model-Vesselness Uncer-

tainty Estimation

In each iteration of AR-SPL, suggestive annotation is
performed in two steps to achieve sparse annotations for
manual reÔ¨Ånement: i) intelligently querying a small num-
ber of valuable pixels for their labels from a large pool of
unlabeled pixels; and ii) mixing the newly labeled pixels
with the previously labeled ones.

2.3.1. Batch-Mode Suggestive Annotation

In principle, classical suggestive annotation chooses one
single unlabeled sample each time [24, 25], such as a pixel
for the segmentation task, to query its label. However, it
is not feasible enough in our work since one single queried
pixel may not make a statistically signiÔ¨Åcant impact on
model updating. Moreover, labeling pixels in isolated po-
sitions one-by-one is intractable for the annotator as com-
pared with labeling them in a localized image patch, i.e., a
superpixel. Therefore, we perform suggestive annotation
in batch mode at superpixel level for interaction eÔ¨Éciency.
For each training image, a small number of unlabeled su-
perpixels with the highest uncertainties are queried. Then
the annotator only needs to provide pixel-wise labels for
these queried superpixels rather than the entire image.
Therefore, these annotator-provided pixel-wise labels for

Figure 5: Illustration of sparse annotation-based manual reÔ¨Ånement.
(a) depicts the sparse annotations for a small number of pixels
bounded by purple dash lines, where foreground and background
annotations are colored in red and green, respectively. (b)‚Üí(c) and
(d)‚Üí(e) depict the manual reÔ¨Ånement for self-paced labels and la-
tent weights. The reÔ¨Ånement is performed only for the annotated
region, where self-paced labels are updated with sparse annotations,
and latent weights are updated with a constant œâ.

with suboptimal W and ruins the following alternating
In particular, based on the current
minimization steps.
model, Eq. 4 is dominated by easy pixels previously se-
lected by the self-paced regularizer, maintaining and even
amplifying systematic errors in the self-paced labels, as
shown in Fig. 4. These systematic errors further misguide
the model training in the next iteration, leading to irre-
versible performance deterioration at test time. Following
the naive self-paced learning scheme, systematic errors are
hardly explored and corrected if no auxiliary reÔ¨Ånement
strategy is applied.

Manual proofreading over the whole image is a prac-
tical way to detect and correct errors, while it leads to
substantial labor costs for a large number of nonerror re-
gions. DiÔ¨Äerent from this labor-intensive process, we pro-
pose a cost-eÔ¨Äective AR-SPL framework that performs an
online local manual reÔ¨Ånement based on sparse annota-
tions to guide the naive self-paced learning, i.e., only a
small number of valuable pixels with potentially incorrect
labels are annotated and then manually reÔ¨Åned in each it-
eration of alternating minimization during model training.
SpeciÔ¨Åcally, given sparse annotations for a small portion
of pixels in training image (Fig. 5(a)), manual reÔ¨Ånement
is performed only for the annotated region while the non-
annotation region remains unchanged. In the annotated
region, self-paced labels are updated with sparse annota-
tions, as depicted in Fig. 5(b)‚Üí(c). Moreover, the latent
weights in the annotated region are increased to a constant
œâ > 1, as depicted in Fig. 5(d)‚Üí(e), since sparse man-
ual annotations are expected to more substantially impact
model updating. Owing to the paired manual reÔ¨Ånements,
the proposed AR-SPL provides a promising way to guide
the naive self-paced learning to eÔ¨Äectively overcome sys-

6

e(a) Sparse Manual AnnotationForeground AnnotationNo AnnotationBackground AnnotationAnnotated Regione(b) Self-Paced Label(c)  Refined Self-Paced LabelForegroundBackgroundManual Refinement for Latent Weight(d) Latent WeightWeight = 1Weight = 0Weight = ùúî(e) Refined Latent WeightManual Refinement for Self-Paced LabelUpdateUpdateManual Annotationqueried superpixels are regarded as sparse annotations and
used for manual reÔ¨Ånement, as depicted in Fig. 5.

Formally, let image xi be separated into a large number
of superpixels that are denoted by a universal set P i. In
iteration k of AR-SPL, let Q(k)
denote a set of superpixels
i
that need to be queried and annotated. Only Nb super-
pixels (the query batch size) from the unlabeled pool with
the highest uncertainties should be included in Q(k)
for
sparse annotation:

i

(cid:110)

Q(k)

i =

q|q ‚àà P i ‚àí Q‚àó

i , U (k)

i,q ‚â• Œì (Nb)

(6)

(cid:111)

i

i = Q(1)

i ‚à™ Q(2)

i ‚à™ ¬∑ ¬∑ ¬∑ ‚à™ Q(k‚àí1)

. Furthermore, U (k)

where Q‚àó
represents the la-
beled superpixels in the total previous k ‚àí 1 iterations.
P i ‚àí Q‚àó
i is the unlabeled pool obtained by excluding Q‚àó
i
from P i, and we select superpixel q from it to generate
Q(k)
i,q measures the uncertainty for q
i
in xi. Œì (Nb) is the Nb-th highest uncertainty among all
superpixels. The selected q should also have the top Nb un-
certainty in xi, which satisÔ¨Åes U (k)
i,q ‚â• Œì (Nb). Finally, all
pixels in Q(k)
are labeled as sparse annotations and then
added to the previously labeled Q‚àó
i for manual reÔ¨Ånement
in AR-SPL, in order to avoid catastrophic forgetting [36]
of CNNs. Uncertainty estimation U (k)
i,q is regarded as a key
for the selection of Q(k)
and will be described in the next
subsection.

i

i

2.3.2. Model-Vesselness Uncertainty Estimation

Towards manual reÔ¨Ånement speciÔ¨Åc for errors in cur-
rent self-paced labels, uncertainty estimation is desired
to indicate potential mis-segmentations [22], which can
be achieved with a widely used model uncertainty using
Monte Carlo sampling with dropout (MCDO) [23]. For
this, in iteration k of AR-SPL, we Ô¨Årst activate the dropout
operation in model inference and perform D times forward-
propagations, leading to D-fold binary prediction results.
Then, the model posterior expectation is obtained by av-
eraging over them:

E(k)

i,j =

1
D

D
(cid:88)

d

Àúy(k)
i,j

(7)

(cid:16)

where E(k)
i,j denotes the model expectation for xi,j (pixel j
in xi). Àúy(k)
i,j = ÀúŒ¶
is the binary prediction for
xi,j, where W (k)
d denotes the model parameter W (k) after
applying dropout in MCDO pass d. Furthermore, model
uncertainty M (k)
i,j

is estimated as the entropy over E(k)
i,j :

(cid:12)
(cid:12)W (k)
(cid:12)

xi,j

(cid:17)

d

M (k)

i,j = ‚àí

1
ÀáZi

i,j log E(k)
E(k)

i,j

(8)

where ÀáZi = max
eter to make M (k)

j

i,j range from 0 to 1.

i,j log E(k)
E(k)

i,j

is the normalization param-

Despite the strong relationship with potential mis-
segmentations, model uncertainty leads to redundant
queries which limit the intervention eÔ¨Éciency, especially
for the model training at early stages, due to the ab-
sence of geometric features of coronary arteries. Vesselness
measure generated from vessel enhancement is regarded
as a customized geometric feature for vascular structures,
which can be used to deÔ¨Åne vesselness uncertainty Gi,j:

Gi,j = ‚àí

1
ÀÜZi

si,j (1 ‚àí si,j)

(9)

j

where si,j represents the vesselness measure from Section
2.1, and ÀÜZi = max
si,j (1 ‚àí si,j) is the normalization pa-
rameter. Eq. 9 is formulated as a quadratic function [37]
rather than a widely used entropy term, considering the
distribution diÔ¨Äerence between si,j and E(k)
i,j .

To leverage the complementary strengths of these
two uncertainty estimations, we propose a novel model-
vesselness uncertainty that is a combination of them. It is
formulated at superpixel level for the batch-mode sugges-
tive annotation in iteration k of AR-SPL:

U (k)

i,q =

(cid:16)

max

1
Nq

(cid:88)

j‚ààq

Œ∑Gi,j, (1 ‚àí Œ∑) M (k)
i,j

(cid:17)

(10)

where U (k)
i,q denotes the proposed model-vesselness uncer-
tainty for superpixel q in xi, and Nq represents the total
number of pixels in it. This hybrid uncertainty calculates
a weighted maximization of model uncertainty and vessel-
ness uncertainty and then averages over all pixels in q. The
weight Œ∑ controls a tradeoÔ¨Ä between them, which requires
an elaborate design for the best combination. SpeciÔ¨Å-
cally, vesselness uncertainty provides a context-aware cue
for suggestive annotation. It exhibits more advantages for
an early training stage where model uncertainty is unre-
liable due to the inaccurate predictions based on a coarse
segmentation model. However, vesselness uncertainty can-
not discover which pixels are actually essential for further
model Ô¨Åne-tuning, leading to decreased convergent perfor-
mance. In contrast, model uncertainty indicates ambigu-
ous regions with respect to the segmentation model.
It
allows for better exploration of potentially incorrect la-
bels [22], leading to an accurate and stable segmentation
performance for model convergence. Motivated by these
observations, we design a dynamic time-dependent weight
Œ∑, regarded as a soft switching strategy between these two
uncertainties during the entire training process:

(cid:40)

Œ∑ =

1 ‚àí Œ∏ (k ‚àí 1), k < 1 + (1/Œ∏)
0,

otherwise

(11)

where Œ∏ denotes the decay rate and k is the training it-
eration index. With this dynamic tradeoÔ¨Ä, the proposed
model-vesselness uncertainty emphasizes vesselness uncer-
tainty more in the early training stage for a fast perfor-
mance improvement, while biasing to model uncertainty
in the later stage for an accurate convergent performance.

7

3. Experiments and Results

3.1. Dataset and Evaluation Metrics

We collected 191 clinical XA sequences of 30 patients
with frame rate 15 f ps, frame size 512 √ó 512 and pixel
size 0.3 √ó 0.3 mm2 using a Philips UNIQ FD10 C-arm
system from Peking Union Medical College Hospital in
China. Among them, multiple sequences were acquired for
each patient from multiple viewing angles to overcome the
foreshortening of angiographic projection. XA sequences
recorded the whole vessel angiography procedure from the
inÔ¨Çow to the wash-out of the injected contrast agent, with
total frames 41 to 74. During the angiography proce-
dure, only the key frame depicted the entire structure
of coronary tree by Ô¨Ålling the vessel lumen with contrast
agent [38]. Therefore, we selected one contrast-Ô¨Ålled key
frame from each sequence and obtained a total of 191 XAs
of 30 patients for the following segmentation experiments.
Data splitting was performed at the patient level. We used
112 XAs of 17 patients for training, 25 XAs of 4 patients
for validation and 54 XAs of 9 patients for testing.

We developed a PyQT GUI for elaborate vessel annota-
tion. All of the XAs can be enlarged up to 5√ó for clear
visualization of even thin branches, and vessel regions were
annotated by a laser mouse. The annotator was an expe-
rienced researcher who can accurately identify coronary
arteries, and the annotation quality was further checked
by an expert radiologist for PCI surgery. The annotator
not only labeled superpixels that were queried in training
images, but also provided the vessel ground truth for vali-
dation and testing images. To quantitatively evaluate the
segmentation performance, we measured recall, precision
and dice score (which is equal to F1-score):

Recall = T P/ (T P + F N )

Precision = T P/ (T P + F P )

Dice Score = 2T P/ (2T P + F N + F P )

(12)

(13)

(14)

where T P , F N and F P are the numbers of true positives,
false negatives and false positives of segmentation results,
respectively. Considering the high class imbalance in XA,
dice score provides a relatively more comprehensive eval-
uation than recall and precision.

3.2. Implementation Details

The proposed weakly supervised learning framework
was implemented in TensorFlow3 with a 4-core 2.6GHz
Intel Xeon Silver processor, an NVIDIA Titan X (Pascal)
GPU and 128 GB RAM.
Pseudo Label Generation. We followed the suggestions
from [11] to generate pseudo labels, e.g., a structural disk
element with 20 pixel diameter and regularization param-
n, where n is the number of pixels in a
eter Œæ = 0.8/
training image.

‚àö

3https://www.tensorÔ¨Çow.org

8

Annotation-ReÔ¨Åning Self-Paced Learning. Without
loss of generality, we chose the widely used U-Net [5] as
the segmentation model. Dropout with rate 0.2 was used
in the expanding path of U-Net to reduce overÔ¨Åtting and
acted as Monte Carlo sampling for model uncertainty es-
timation. Note that the dropout was applied only for
model training Eq. 3 and MCDO Eq. 7 rather than in
the testing process, where it would cause multiplied in-
ference time. Sparse annotation-based manual reÔ¨Ånement
was performed in each iteration of AR-SPL and Ô¨Ånally
stopped at iteration 13 when a convergence threshold was
satisÔ¨Åed, i.e., the increment of dice score on the valida-
tion dataset is less than 0.05%. During the training pro-
cess, we Ô¨Årst initialized the self-paced label with the noisy
pseudo label obtained from vessel enhancement. Moreover,
a soft threshold was empirically imposed on vesselness map
to initialize the latent weight vi = max (4 |si ‚àí 0.5| , 1).
Then, Eq. 3 was optimized with Œª = 10‚àí4 by stochastic
gradient descent with momentum 0.9, batch size 16, max-
imal number of iterations 5000 and initial learning rate
0.01 that was decayed exponentially with power 0.9. For
the optimization of Eq. 5, we synchronously logarithmi-
cally decreased œÑ and Œ≥ from diÔ¨Äerent initial values œÑ0 and
Œ≥0 with the same rate ¬µ, i.e.
œÑ = ‚àílog (œÑ0 ‚àí ¬µk) and
Œ≥ = ‚àílog (Œ≥0 ‚àí ¬µk), so as to maintain the stability and
scalability of the selection threshold for cross-entropy loss.
The analysis of parameter sensitivity is appended in Sup-
plementary Materials. It suggests œÑ0 = 0.75, Œ≥0 = 0.20 and
¬µ = 0.01 based on a grid search for the best performance
on the validation dataset. Following a similar grid search
manner, we chose œâ = 5 to emphasize manual reÔ¨Ånement
for latent weight.
Suggestive Annotation with Model-Vesselness Un-
certainty Estimation. We utilized the SLIC algorithm
[39] to separate each training image into 3000 superpixels.
The query batch size Nb was set to 8 due to its best trade-
oÔ¨Ä between human-related annotation cost and model per-
formance, as shown in Supplementary Materials. Model
uncertainty was estimated by 20-fold MCDO and then dy-
namically combined with vesselness uncertainty with de-
cay rate Œ∏ = 0.4, which was selected based on a grid search
for the best validation performance.

3.3. Ablation Study

In this section, we conduct an ablation study to investi-
gate the contribution of each component in the proposed
AR-SPL: the pseudo label generation, the self-paced learn-
ing scheme and the spare annotation-based manual reÔ¨Åne-
ment. We compare three baselines and several model vari-
ants that use diÔ¨Äerent components in AR-SPL.

‚Ä¢ Pseudo label prediction,

i.e., a baseline that pre-
dicts pseudo labels (Baseline-PL) based on vessel
enhancement for test images. These pseudo labels
are directly regarded as the Ô¨Ånal segmentation results
without further fed to deep learning-based training
framework.

Figure 6: Three examples of segmentation results in blue bounding boxes obtained by diÔ¨Äerent counterparts in the ablation study. The true
positives, false negatives and false positives are visualized in green, red and orange, respectively. We zoom in on the challenging regions
bounded by yellow and pink boxes, and append them below each case to highlight the segmentation details.

‚Ä¢ Noisy supervision-based training framework [40], i.e.,
a baseline that treats pseudo labels as noisy super-
vision (Baseline-NS) and then learns directly from
them without further reÔ¨Ånement strategies.

‚Ä¢ Automatic modiÔ¨Åcation of pseudo labels based on the
naive self-paced learning scheme without manual re-
Ô¨Ånement, i.e., deactivation of sparse annotation-based
manual reÔ¨Ånement in AR-SPL (AR-SPL-NoAR).
‚Ä¢ Manual substitution of pseudo labels with sparse an-
notations that are suggested by model-vesselness un-
certainty. Only these sparse annotations are used in
model training, which is accomplished without the
self-paced learning for exploiting pseudo labels on the
Ô¨Çy, i.e., deactivation of the self-paced learning scheme
in AR-SPL (AR-SPL-NoSPL)4.

‚Ä¢ Fully supervision-based training framework [8], i.e., a
baseline that learns from fully supervision (Baseline-
FS) with manual annotations for all pixels in each
training image.

Fig. 6 visualizes the segmentation results on test im-
ages obtained by diÔ¨Äerent methods in the ablation study,

4For a fair comparison, to avoid additional annotations for ini-
tialization [41, 42], we only use noisy pseudo labels as a warm-start
to obtain the initial segmentation model and uncertainty map.

zooming in on the challenging regions for vessels (yellow
bounding boxes) and background with potential distur-
bance (pink bounding boxes). Baseline-PL predicts pseudo
label as the segmentation result, which exhibits the obvi-
ous false negatives for thin vessel branches and bifurcation
points (in the yellow bounding boxes), as well as the false
positives scattered in semi-transparent background struc-
tures (in the pink bounding boxes). This poor perfor-
mance indicates that pseudo labels contain noise with sys-
tematic biases, challenging the other components in AR-
SPL for learning an accurate segmentation model. For
example, Baseline-NS directly learns from pseudo labels
while shows even worse performance than Baseline-PL
due to the overÔ¨Åtting on label noise. AR-SPL-NoAR and
AR-SPL-NoSPL exhibit limited noise robustness, where
false negatives are reduced as compared to Baseline-PL
and Baseline-NS, yet background disturbance seems to be
intractable with false positives even ampliÔ¨Åed especially
for curvilinear background structures, such as ribs, ster-
nums and vertebrae. Owing to the incorporation of all
proposed components, AR-SPL can eÔ¨Äectively avoid the
model training being corrupted by noise in pseudo labels,
leading to the accurate extraction of contrast-Ô¨Ålled coro-
nary arteries as highlighted in yellow bounding boxes and
the least false positives for background disturbance in pink

9

Test ImageGround TruthBaseline-PLBaseline-NSAR-SPL-NoARAR-SPL-NoSPLBaseline-FSAR-SPLFalse NegativeTrue PositiveFalse PositiveVisualized RegionCase 1Case 2Case 3Table 1: Quantitative evaluations for training cost and segmentation performances of all methods that use diÔ¨Äerent components in the
ablation study, such as the fully supervision (FS), the pseudo label generation (PLG), the naive self-paced learning scheme (SPL) and the
sparse annotation-based manual reÔ¨Ånement (AR). The best performance is highlighted in bold, and its comparable performance is denoted
by superscript c based on a two-sided Wilcoxon signed-rank test (p-value>0.05).

Component

Training Cost

Segmentation Performance

FS

PLG SPL AR

# Annotated
Superpixels (k)

Annotation
Time (h)

Optimization
Time (h)

Recall
(%)

Precision
(%)

Dice
(%)

Baseline-PL

Baseline-NS

AR-SPL-NoAR

AR-SPL-NoSPL

Baseline-FS

AR-SPL

"

"
"
" "
"

"

" " "

0

0

0

11.64

336.00

11.64

0

0

0

16.32

65.11

16.16

0

3.26

11.57

11.74

3.24

11.81

77.37¬±9.58

56.57¬±11.48

61.64¬±10.42

83.56¬±7.28

43.60¬±10.86

56.19¬±9.60

86.86¬±5.84

49.89¬±7.27

63.09¬±6.58

82.07¬±3.93

81.53¬±5.49

81.72¬±4.14

81.44¬±4.26

82.58¬±5.35c

82.01¬±4.21c

81.64¬±4.11

82.69¬±5.31

82.09¬±4.08

bounding boxes.
Its performance is signiÔ¨Åcantly better
than other counterparts that use one single component,
and even is visually similar to Baseline-FS that relies on
tedious fully manual annotation.

We show in Table 1 the quantitative evaluations of train-
ing cost and segmentation performance. Training cost con-
sists of the human-related annotation cost (i.e., the num-
ber of annotated superpixels and their required annota-
tion time for all images in the entire training process) and
the human-free optimization cost (i.e., the optimization
time for updating operations in alternating minimization
Eq. 3, 4, 5). Baseline-PL is an unsupervised method based
on pseudo label generation without training process, which
thus requires no annotation cost and optimization cost
for model training. Its low dice score demonstrates that
pseudo labels are highly noisy and would challenge other
components in AR-SPL. SpeciÔ¨Åcally, Baseline-NS shows
even worse performance than Baseline-PL, indicating the
overÔ¨Åtting nature of CNNs for label noise. AR-SPL-NoAR
is completely free of manual annotation while has limited
improvement over Baseline-PL and Baseline-NS, which
highlights that using only the naive self-paced learning
scheme tends to be limited by highly noisy pseudo labels.
It increases the recall yet has a much lower precision due
to the lack of discrimination capability for false-positive
ambiguous structures. AR-SPL-NoSPL prominently pro-
motes the segmentation performance over Baseline-PL and
Baseline-NS via abandoning all pseudo labels and learning
only from sparse annotations suggested by uncertainty es-
timation. It requires the similar training cost to AR-SPL
yet has an inferior segmentation performance due to the
absence of the self-paced learning for leveraging potentially
clean pseudo labels with low learning diÔ¨Éculties on the Ô¨Çy.
Compared with other counterparts, AR-SPL integrates all
proposed components and achieves the best segmentation
performance, which is statistically comparable to Baseline-
FS and even exhibits a slight superiority without signiÔ¨Å-
cant diÔ¨Äerence. This is because that when the uncertainty
is used to guide sparse annotation-based manual reÔ¨Åne-
ment, more attention with a large weight œâ would be paid

Figure 7: Normalized joint histogram of uncertainty and error rate.
The average error rate is depicted as a function of uncertainty by the
red curve.

to these diÔ¨Écult regions during model training. Moreover,
compared with Baseline-FS, AR-SPL signiÔ¨Åcantly reduces
the annotation cost, i.e., only 24.82% annotation time is
required to label 3.46% image regions. Although it costs
more optimization time for alternating minimization, such
increase of optimization time is fairly slight considering the
largely reduced annotation time, and it is also acceptable
since no human-related labor is involved in optimization
procedure. These advantages of AR-SPL demonstrate the
contribution of each component for the safety (without
performance deterioration) and eÔ¨Éciency (with minimal
annotation cost) when dealing with noisy pseudo labels.

Manual reÔ¨Ånement is performed by precisely annotat-
ing only superpixels with high uncertainties, rather than
extensively proofreading the entire image which is a slow
and labor-intensive process. To investigate the feasibility
of this uncertainty-based suggestive annotation for local
manual reÔ¨Ånement, we show in Fig. 7 the relationship be-
tween the adopted model-vesselness uncertainty and seg-
mentation error. At diÔ¨Äerent uncertainty levels, we mea-
sure error rates of segmentation results for all images, ob-
taining a normalized joint histogram of uncertainty and

10

0.90.10.011e-31e-41e-51e-61e-7Uncertainty Levelsegmentation error rate. Then, we also calculate the aver-
age error rate with respect to diÔ¨Äerent uncertainty levels
and present the error rate as a function of uncertainty, i.e.,
the red curve in Fig. 7. The results demonstrate that the
majority of pixels have correct segmentation predictions
(low error rate) with low uncertainties. The error rate be-
comes gradually higher with the increase of uncertainty,
indicating that the segmentation error can be captured
by a higher uncertainty value. Therefore, the uncertainty-
based suggestive annotation enables a reliable local manual
reÔ¨Ånement for potential segmentation errors, providing a
cost-eÔ¨Äective alternative for whole-image proofreading.

3.4. Comparison with Other Uncertainty Estimations in

Suggestive Annotation

To demonstrate the advantage of the proposed adap-
tive model-vesselness uncertainty (MVU-ada) for a more
eÔ¨Écient manual intervention, we compare it with other
uncertainty estimations in the same AR-SPL framework:

‚Ä¢ Model uncertainty (MU) [23], which is estimated by

MCDO, as shown in Eq. 8.

‚Ä¢ Vesselness uncertainty (VU), which is derived based
on the vesselness map generated from vessel enhance-
ment, as shown in Eq. 9.

‚Ä¢ Model-vesselness uncertainty with a Ô¨Åx tradeoÔ¨Ä
(MVU-Ô¨Åx), which is a hybrid uncertainty estimated
as the weighted maximization of model uncertainty
and vesselness uncertainty, as shown in Eq. 10. Un-
like MVU-ada, it adopts a Ô¨Åxed weight Œ∑ = 0.2 rather
than the dynamic weight formulated in Eq. 11, which
is chosen by a grid search for the best validation per-
formance.

Fig. 8 shows diÔ¨Äerent uncertainty maps and their cor-
responding queried regions in iteration 1 and iteration
8 during the training process. For iteration 1 (i.e., the
early training stage), MU and MVU-Ô¨Åx show noticeably
high uncertainties for curvilinear background structures
and thus cause biased querying operations for them, espe-
cially for ribs as highlighted by white arrows. In contrast,
MVU-ada is similar to VU in iteration 1 and performs a
direct querying for target coronary arteries that occupy
only a small set of pixels in XA. Such direct querying for
sparse vessels is expected to be more essential in the early
training stage for rapidly improving model discrimination
capability. For iteration 8 (i.e., the later training stage),
VU generates the uncertainty map that is independent of
the callbacks from model updating. It queries even highly
conÔ¨Ådent regions with respect to a relatively mature seg-
mentation model, challenging the model Ô¨Åne-tuning to-
wards a higher convergent accuracy. Owing to the pro-
posed dynamic tradeoÔ¨Ä, MVU-ada consistently achieves
the appropriate uncertainty maps and thus enables the ef-
Ô¨Åcient manual intervention throughout the entire training
process. Its corresponding querying operations also focus
on challenging regions such as bifurcations, thin branches

Figure 8: Visual comparison of diÔ¨Äerent uncertainty maps and their
corresponding queried regions in iterations 1 and 8 of AR-SPL. The
uncertainty maps are visualized by heatmaps, and the queried regions
are visualized in green. The white arrow highlights the biases of the
MU and MVU-Ô¨Åx to the curvilinear ribs in iteration 1.

and terminal vessels with attenuated contrast, eÔ¨Äectively
correcting the systematic biases of noisy pseudo labels.

To investigate interaction eÔ¨Éciency of suggestive anno-
tation with diÔ¨Äerent uncertainties, as shown in Fig. 9,
we evaluate the segmentation performance on test im-
ages with respect to the incremental annotated superpix-
els in each training image. The segmentation performance
is gradually improved with the increase of annotations,
providing an incremental training process rather than the
typical fully supervised framework without manual inter-
vention. Vesselness uncertainty and model uncertainty
show the complementary strengths. SpeciÔ¨Åcally, VU has
a more rapid performance improvement than MU in the
early training stage, as shown in Fig. 9(b), indicating that
vesselness uncertainty provides the context-aware cue that
is more eÔ¨Écient to guide model updating in an early stage.
In contrast, MU converges to a higher dice score than
VU, as shown in Fig. 9 (c), owing to the model uncer-
tainty for facilitating model Ô¨Åne-tuning towards a higher
convergent accuracy level. MVU-ada and MVU-Ô¨Åx com-
bine both of these uncertainties, exhibiting higher conver-
gent accuracy than VU and faster convergence rate than
MU. Among all counterparts, MVU-ada beneÔ¨Åts from the
dynamic tradeoÔ¨Ä between model uncertainty and vessel-
ness uncertainty, leading to the best convergent accuracy

11

Training ImageMUMVU-fixVUIteration 1 0.20.40.60.8Uncertainty MVU-adaQueried RegionIteration 8 Ground TruthUncertainty MapQueried RegionUncertainty MapQueried RegionFigure 9: Evolution of dice score with respect to the annotated superpixels that are queried based on diÔ¨Äerent uncertainty estimations and
involved incrementally in model training. SubÔ¨Ågure (a) shows the whole training process while subÔ¨Ågure (b) and (c) focus on the early stage
and the Ô¨Ånal model convergence, as bounded by the yellow and purple box, respectively.

els. VU costs slightly less annotation time than MU and
MVU-Ô¨Åx when model accuracy is fairly low in the early
training stage, i.e., 77% Dice, yet it signiÔ¨Åcantly degener-
ates when the model accuracy is improved. It even cannot
Ô¨Ånally converged to 82% Dice, as highlighted by the blue
arrow. Among all counterparts, the proposed MVU-ada
consistently requires the least annotation time for diÔ¨Äer-
ent dice scores, indicating its fastest convergence rate, i.e.,
the most eÔ¨Écient manual interaction, during model train-
ing. Especially for the convergent result 82% Dice, MVU-
ada shows noticeably less annotation time than MU and
MVU-Ô¨Åx owing to the proposed dynamic tradeoÔ¨Ä between
model uncertainty and vesselness uncertainty.

3.5. Comparison with Other Weakly Supervised Learning

Frameworks

We further validate the signiÔ¨Åcance of manual reÔ¨Åne-
ment when learning from noisy pseudo labels. The pro-
posed AR-SPL is compared with noisy supervision-based
training framework (Baseline-NS), fully supervision-based
training framework (Baseline-FS), and the other state-of-
the-art weakly supervised learning frameworks that deal
with noisy labels without the sparse annotations-based
manual reÔ¨Ånement proposed in this work:

‚Ä¢ Simple noise layer (Simple-NL) [15], which reduces
label noise via an explicit noise model, i.e., a linear
layer on the top of the softmax output.

‚Ä¢ Complex noise layer (Complex-NL) [16], which im-
proves the explicit noise model in Simple-NL by an
additional dependence on feature vectors.

‚Ä¢ Bootstrapping [17], which augments noisy labels
with a notion of perceptual consistency by a convex
combination with the current prediction of the model.

Figure 10: A comparison of annotation time per image with respect
to diÔ¨Äerent desired dice scores. The blue arrow illustrates that VU
cannot converge to 82% dice score.

and the fastest convergence rate during model training.
Its convergent accuracy is even comparable to Baseline-
FS that relies on tedious fully manual annotation. More-
over, the fastest convergence rate of MVU-ada not only
enables a minimal set of annotations to reach the conver-
gence accuracy (as shown in Fig. 9(c)), but also maintains
the most eÔ¨Écient manual interaction before model conver-
gence (as shown in Fig. 9(a)), i.e., higher dice score with
even fewer annotations.
It further provides a promising
application of this incremental training process in a more
cost-eÔ¨Äective interactive scenario, where once the desired
accuracy is reached even before model convergence, MVU-
ada requires the minimal annotation cost and the training
process can be early stopped without more annotations
further involved.
Furthermore,

for diÔ¨Äerent uncertainty estimations,
Fig. 10 provides a detailed comparison for their required
annotation times with respect to diÔ¨Äerent accuracy lev-

12

(a)(c)(b)Figure 11: Visual comparison of diÔ¨Äerent weakly supervised learning frameworks and baselines for vessel segmentation in XAs bounded by
blue bounding boxes. Except for AR-SPL and Baseline-FS, which respectively utilize sparse and fully manual annotations, the other weakly
supervised methods lead to obvious false negatives (highlighted in red) and false positives (highlighted in orange).

Table 2: The performances of diÔ¨Äerent weakly supervised methods
and baselines. The best performance is highlighted in bold, and
its comparable performance is denoted by superscript c based on a
two-sided Wilcoxon signed-rank test (p-value>0.05).

Method

Recall (%)

Precision (%) Dice (%)

Baseline-NS
Simple-NL
Complex-NL

Bootstrapping
SPFTN
Baseline-FS
AR-SPL

83.56¬±7.28
83.20¬±7.42
83.37¬±7.75

83.21¬±6.81
85.80¬±6.08
81.44¬±4.26
81.64¬±4.11

43.60¬±10.86
49.97¬±12.13
50.84¬±13.48

53.81¬±9.82
51.51¬±7.34
82.58¬±5.35c
82.69¬±5.31

56.19¬±9.60
61.04¬±11.01
61.40¬±12.16

64.66¬±7.90
64.10¬±6.57
82.01¬±4.21c
82.09¬±4.08

‚Ä¢ Self-paced Ô¨Åne-tuning network (SPFTN) [19], which
label noise by a predeÔ¨Åned

excludes potential
diversity-based self-paced regularizer.

Fig. 11 shows the segmentation results of CNNs trained
in the diÔ¨Äerent frameworks. Compared with Baseline-NS
that applies no noise-robust training strategy, Simple-NL
and Complex-NL achieve fewer false positives for semi-
transparent background structures owing to their adopted
noise models. Bootstrapping and SPFTN further reduce
false positives while leaving intractable false negatives for
coronary arteries. When introducing sparse annotations
in training images, AR-SPL prominently improves the seg-
mentation performance and approaches Baseline-FS. It en-
ables the Ô¨Åne extraction of the complete coronary trees
without increasing false positives in the background.

A quantitative comparison is presented in Table 2.
The very limited advantage of classical weakly supervised
frameworks can be observed for their small superiorities
over Baseline-NS. Despite a slightly higher recall, they all
suÔ¨Äer from signiÔ¨Åcantly lower precision and dice score than
Baseline-FS by a large margin. This performance gap can

be bridged when sparse annotation-based manual reÔ¨Åne-
ment is involved in the way proposed by AR-SPL, leading
to a comparable performance to Baseline-FS without sta-
tistically signiÔ¨Åcant diÔ¨Äerence.

4. Discussion

Precisely annotating coronary arteries in XAs is ex-
tremely labor-intensive and time-consuming to train CNNs
for vessel segmentation. Noisy pseudo labels generated
from vessel enhancement provide an imprecise alternative
that is free of manual interaction, yet challenging the ac-
curate segmentation performance at test time. A prac-
tical problem is raised: how to learn from these noisy
pseudo labels safely without performance deterioration.
Our work oÔ¨Äers the Ô¨Årst attempt to solve this problem
from a novel weakly supervised perspective using ‚Äúinaccu-
rate‚Äù supervision (i.e., noisy pseudo labels generated from
vessel enhancement) together with ‚Äúincomplete‚Äù supervi-
sion (i.e., sparse manual annotations suggested by model-
vesselness uncertainty). These two types of weak super-
vision are leveraged compactly via the proposed AR-SPL,
where noisy pseudo labels are Ô¨Årst obtained by vessel en-
hancement, and then reÔ¨Åned simultaneously based on self-
paced learning and sparse annotations, in order to train
an accurate segmentation model with minimal manual in-
tervention. The experimental results indicate that, de-
spite the very limited annotation cost, our AR-SPL ac-
complishes the precise vessel extraction and the eÔ¨Äective
suppression of background disturbance, which is even com-
parable to the fully supervised learning.

Under a standard weakly supervised learning paradigm,
some works use only pseudo labels, and then reÔ¨Åne la-
bel noise without human interaction by leveraging noise-
robust prior knowledge, such as the learning diÔ¨Éculty

13

Test ImageGround TruthBaseline-NSSimple-NLComplex-NLBootstrappingSPFTNBaseline-FSAR-SPLFalse NegativeTrue PositiveFalse PositiveVisualized Region[31, 19] and perceptual consistency [17]. However, the
experimental results in Section 3.5 demonstrate that us-
ing such prior knowledge alone causes noticeable perfor-
mance deterioration at test time. The reasons are two-
fold. On one hand, noise-robust prior knowledge would
lead to a biased training process and cause overÔ¨Åtting of
CNNs on pixels selected by the predeÔ¨Åned criterion. On
the other hand, pseudo labels generated by vessel enhance-
ment contain inevitable systematic errors, which imply the
intractable knowledge defect [25] and hamper the accurate
model training. Our proposed AR-SPL provides a simple
but powerful solution by using sparse annotations. Sparse
manual annotations act as an additional cue to progres-
sively enrich the training variety and compensate knowl-
edge defect in noisy pseudo labels, eÔ¨Äectively improving
the segmentation performance to a level comparable to
fully supervised learning.

In addition, some other similar works [41, 42] follow
the self-paced learning under an active learning paradigm,
which accepts only sparse manual annotations instead of
exploiting noisy pseudo labels. These annotations are
suggested by the classical model uncertainty without a
context-awareness of vascular geometric features in XAs.
DiÔ¨Äerently from this active learning perspective, the pro-
posed AR-SPL additionally leverages pseudo labels gener-
ated from vessel enhancement, and guides sparse manual
annotations with a well-designed model-vesselness uncer-
tainty. Our framework oÔ¨Äers several advantages. First,
pseudo labels help avoid the challenge of collecting ini-
tial annotations that would be labor-intensive and time-
consuming. They provide a noisy set of initial annotations
and thus can be used as a warm-start in the active learn-
ing paradigm, which is free of manual intervention and
empirical settings. Second, our AR-SPL framework can
reduce the requirement for human-provided ground truth
by exploiting prior knowledge in pseudo labels such as the
intensity distribution and scale information. This knowl-
edge can be obtained by vessel enhancement without la-
bor cost, leading to a beneÔ¨Åcial feature representation for
coronary arteries in CNNs. Third, the adopted model-
vesselness uncertainty takes a customized consideration of
vessel structures and facilitates a more eÔ¨Écient manual in-
tervention than the classical model uncertainty, as shown
in Section 3.4.

To ensure the cost-eÔ¨Äective manual intervention, we fur-
ther investigate the opportunities to alleviate the user‚Äôs
annotation burden using a suggestive annotation strategy
with the proposed model-vesselness uncertainty. One sin-
gle uncertainty cannot maintain the best interaction eÔ¨É-
ciency during model training. For example, model uncer-
tainty contributes to the cautious model Ô¨Åne-tuning for a
higher convergent accuracy, while hampered by a slow con-
vergence rate due to query redundancy, especially for an
early training stage.
In contrast, vesselness uncertainty
provides a context-aware cue for model updating, con-
tributing to solving query redundancy and rapidly improv-
ing segmentation performance in the early stage. However,

it fails to achieve an eÔ¨Äective model Ô¨Åne-tuning and thus
leads to poor convergent accuracy due to its independence
from the online training process. The proposed model-
vesselness uncertainty incorporates these complementary
strengths by leveraging a dynamic time-dependent trade-
oÔ¨Ä. SpeciÔ¨Åcally, we assign a higher weight to vesselness
uncertainty in the early stage for rapid convergence, and
then increase the weight for model uncertainty in the later
training stage for a better convergent result. This well-
designed combination strategy consistently minimizes the
annotation cost across the entire training process, enabling
a cost-eÔ¨Äective interactive scenario.

The inÔ¨Çow of contrast agent is substantially aÔ¨Äected
by lumen diameters and topological variations,
leading
to attenuated contrast and thus large uncertainty regard-
ing bifurcation points and thin vessels. Manual reÔ¨Åne-
ment is suggested for these regions as shown in Fig. 8,
indicating a relatively concentrated distribution instead of
scattering over the complete coronary tree. SpeciÔ¨Åcally,
queried annotations focus more on terminal branches with
small lumen diameters and topologically varying bifurca-
tion points. This concentrated distribution potentially
simpliÔ¨Åes manual interaction and exhibits higher eÔ¨Éciency
versus extensive proofreading over the whole image.

Our method focuses on the vessel segmentation task in
a speciÔ¨Åc medical application, i.e., the PCI surgical plan-
ning for coronary artery disease. In the experiments, we
have successfully tested our method on the clinical X-ray
angiograms during PCI procedure. Nonetheless, applica-
tion of our method to other vessels may need application-
speciÔ¨Åc modiÔ¨Åcations. For example, for retinal vessel seg-
mentation in color fundus images, the adopted layer sep-
aration for pseudo label generation in our method would
be highly limited due to the indistinct motion cue of reti-
nal vessels. A topology constraint [43] concerning branch
length and lumen diameter would be promising to improve
pseudo label generation for retinal vessels. Moreover, the
suggestive annotation with model-vesselness uncertainty
requires additional designs since vascular features vary
widely for diÔ¨Äerent organs and imaging protocols. It would
be of interest in the further to investigate the feasibility
of adopting our method to vessels from other organs and
modalities.

In the experiments, we have validated our proposed
method on a clinical X-ray angiogram dataset, where the
size is relatively small as compared with many large-scale
datasets of natural images such as PASCAL VOC [44],
COCO [45] and ImageNet [46]. For the segmentation of
coronary arteries in XA, it is especially diÔ¨Écult to collect a
very large dataset, since pixel-wise manual annotations are
highly labor-intensive and require special expertise regard-
ing the thin tubular lumen and complex topology of vessel
tree. Therefore, our relatively small dataset is feasible to
investigate annotation eÔ¨Éciency, which Ô¨Åts well with our
motivation of reducing annotation cost in clinical practice.
Nonetheless, it may be unclear whether the generalization
capability of the proposed AR-SPL would be aÔ¨Äected by

14

the size of dataset. The further work would validate our
method on a larger dataset, including more patients, more
angiographic viewing angles and diÔ¨Äerent concentrations
of injected contrast agent. In addition, despite the incre-
mental Ô¨Åne-tuning, the proposed AR-SPL is still limited
by a considerable time interval between two manual inter-
ventions since the updating of model parameters in Eq. 3
requires relatively long time. In the further, it also would
be of interest to develop a continuous workÔ¨Çow for sug-
gestive annotation by scholastic gradient partial descent
(SPADE) [47] and online learning scheme [48].

5. Conclusions

In this work, we propose a novel weakly supervised
training framework for vessel segmentation in XAs in or-
der to safely and eÔ¨Éciently learn from noisy pseudo la-
bels generated by vessel enhancement. Towards the safety
of learning without performance deterioration, label noise
is handled eÔ¨Äectively by the proposed AR-SPL, where
sparse manual annotations provide online guidance for the
naive self-paced learning. Furthermore, towards interven-
tion eÔ¨Éciency with minimal annotation cost, we propose a
model-vesselness uncertainty with a dynamic tradeoÔ¨Ä for
suggestive annotation, based on the geometric vesselness
and the CNN trained on the Ô¨Çy. Experiments show that
compared with fully supervised learning, the proposed AR-
SPL achieves very similar segmentation accuracy, and only
costs 24.82% of the annotation time to label 3.46% of the
image regions. Such highly reduced annotation cost re-
liably alleviates the burden on the annotator and brings
about potential advantages in clinical applications for PCI
surgical planning, such as a segmentation-based stenosis
detection and reconstruction.

6. Acknowledgment

This

research is partially supported by the Na-
tional Key research and development program(No.
2016YFC0106200), Beijing Municipal Natural Science
Foundation (No. L192006) , and the funding from In-
stitute of Medical Robotics of Shanghai Jiao Tong Uni-
versity as well as the 863 national research fund (No.
2015AA043203).

References

[1] T. Vos, C. Allen, M. Arora, R. M. Barber, Z. A. Bhutta,
A. Brown, A. Carter, D. C. Casey, F. J. Charlson, A. Z. Chen,
et al., Global, regional, and national incidence, prevalence, and
years lived with disability for 310 diseases and injuries, 1990‚Äì
2015: a systematic analysis for the global burden of disease
study 2015, The Lancet 388 (10053) (2016) 1545‚Äì1602.

[2] G. Sangiorgi, J. A. Rumberger, A. Severson, W. D. Edwards,
J. Gregoire, L. A. Fitzpatrick, R. S. Schwartz, Arterial calciÔ¨Åca-
tion and not lumen stenosis is highly correlated with atheroscle-
rotic plaque burden in humans: a histologic study of 723 coro-
nary artery segments using nondecalcifying methodology, Jour-
nal of the American College of Cardiology 31 (1) (1998) 126‚Äì133.

15

[3] G. W. Reed, J. E. Rossi, C. P. Cannon, Acute myocardial in-

farction, The Lancet 389 (10065) (2017) 197‚Äì210.

[4] S.-Y. Chen, J. D. Carroll, J. C. Messenger, Quantitative analysis
of reconstructed 3-d coronary arterial tree and intracoronary
devices, IEEE transactions on medical imaging 21 (7) (2002)
724‚Äì740.

[5] O. Ronneberger, P. Fischer, T. Brox, U-net: Convolutional
networks for biomedical image segmentation, in: International
Conference on Medical image computing and computer-assisted
intervention, Springer, 2015, pp. 234‚Äì241.

[6] H. Chen, X. Qi, L. Yu, P.-A. Heng, Dcan: deep contour-aware
networks for accurate gland segmentation, in: Proceedings of
the IEEE conference on Computer Vision and Pattern Recog-
nition, 2016, pp. 2487‚Äì2496.

[7] R. McKinley, R. Wepfer, T. Gundersen, F. Wagner, A. Chan,
R. Wiest, M. Reyes, Nabla-net: a deep dag-like convolutional
architecture for biomedical image segmentation, in:
Interna-
tional Workshop on Brainlesion: Glioma, Multiple Sclerosis,
Stroke and Traumatic Brain Injuries, Springer, 2016, pp. 119‚Äì
128.

[8] E. Nasr-Esfahani, S. Samavi, N. Karimi, S. R. Soroushmehr,
K. Ward, M. H. Jafari, B. Felfeliyan, B. Nallamothu, K. Najar-
ian, Vessel extraction in x-ray angiograms using deep learning,
in: 2016 38th Annual international conference of the IEEE en-
gineering in medicine and biology society (EMBC), IEEE, 2016,
pp. 643‚Äì646.

[9] S. Yang, J. Yang, Y. Wang, Q. Yang, D. Ai, Y. Wang, Au-
tomatic coronary artery segmentation in x-ray angiograms by
multiple convolutional neural networks, in: Proceedings of the
3rd International Conference on Multimedia and Image Pro-
cessing, ACM, 2018, pp. 31‚Äì35.

[10] J. De Fauw, J. R. Ledsam, B. Romera-Paredes, S. Nikolov,
N. Tomasev,
S. Blackwell, H. Askham, X. Glorot,
B. ODonoghue, D. Visentin, et al., Clinically applicable
deep learning for diagnosis and referral
in retinal disease,
Nature medicine 24 (9) (2018) 1342.

[11] J. Zhang, G. Wang, H. Xie, S. Zhang, Z. Shi, L. Gu, Vesselness-
constrained robust pca for vessel enhancement in x-ray coro-
nary angiograms, Physics in Medicine & Biology 63 (15) (2018)
155019.

[12] E. J. Cand`es, X. Li, Y. Ma, J. Wright, Robust principal com-
ponent analysis?, Journal of the ACM (JACM) 58 (3) (2011)
11.

[13] C. Zhang, S. Bengio, M. Hardt, B. Recht, O. Vinyals, Under-
standing deep learning requires rethinking generalization, arXiv
preprint arXiv:1611.03530 (2016).

[14] Y. Dgani, H. Greenspan, J. Goldberger, Training a neural net-
work based on unreliable human annotation of medical images,
in: 2018 IEEE 15th International Symposium on Biomedical
Imaging (ISBI 2018), IEEE, 2018, pp. 39‚Äì42.

[15] S. Sukhbaatar, R. Fergus, Learning from noisy labels with deep
neural networks, arXiv preprint arXiv:1406.2080 2 (3) (2014) 4.
[16] J. Goldberger, E. Ben-Reuven, Training deep neural-networks

using a noise adaptation layer, in: ICLR, 2017.

[17] S. Reed, H. Lee, D. Anguelov, C. Szegedy, D. Erhan, A. Ra-
binovich, Training deep neural networks on noisy labels with
bootstrapping, arXiv preprint arXiv:1412.6596 (2014).

[18] Z. Mirikharaji, Y. Yan, G. Hamarneh, Learning to segment
skin lesions from noisy annotations, in: Domain Adaptation
and Representation Transfer and Medical Image Learning with
Less Labels and Imperfect Data, Springer, 2019, pp. 207‚Äì215.

[19] D. Zhang, J. Han, L. Yang, D. Xu, Spftn: a joint learning frame-
work for localizing and segmenting objects in weakly labeled
videos, IEEE transactions on pattern analysis and machine in-
telligence (2018).

[20] M. P. Kumar, B. Packer, D. Koller, Self-paced learning for latent
variable models, in: Advances in Neural Information Processing
Systems, 2010, pp. 1189‚Äì1197.

[21] L. Yang, Y. Zhang, J. Chen, S. Zhang, D. Z. Chen, Suggestive
annotation: A deep active learning framework for biomedical
International conference on medical
image segmentation, in:

[41] L. Lin, K. Wang, D. Meng, W. Zuo, L. Zhang, Active self-
paced learning for cost-eÔ¨Äective and progressive face identiÔ¨Åca-
tion, IEEE transactions on pattern analysis and machine intel-
ligence 40 (1) (2017) 7‚Äì19.

[42] W. Wang, Y. Lu, B. Wu, T. Chen, D. Z. Chen, J. Wu, Deep ac-
tive self-paced learning for accurate pulmonary nodule segmen-
tation, in: International Conference on Medical Image Com-
puting and Computer-Assisted Intervention, Springer, 2018, pp.
723‚Äì731.

[43] Z. Shi, H. Xie, J. Zhang, J. Liu, L. Gu, Vessel enhancement
based on length-constrained hessian information, in: 2018 24th
International Conference on Pattern Recognition (ICPR), 2018,
pp. 2869‚Äì2874.

[44] M. Everingham, L. Van Gool, C. K. Williams, J. Winn, A. Zis-
serman, The pascal visual object classes (voc) challenge, Inter-
national journal of computer vision 88 (2) (2010) 303‚Äì338.
[45] T.-Y. Lin, M. Maire, S. Belongie, J. Hays, P. Perona, D. Ra-
manan, P. Doll¬¥ar, C. L. Zitnick, Microsoft coco: Common ob-
jects in context, in: European conference on computer vision,
Springer, 2014, pp. 740‚Äì755.

[46] J. Deng, W. Dong, R. Socher, L.-J. Li, K. Li, L. Fei-Fei, Ima-
genet: A large-scale hierarchical image database, in: 2009 IEEE
conference on computer vision and pattern recognition, Ieee,
2009, pp. 248‚Äì255.

[47] L. Jiang, Z. Zhou, T. Leung, L.-J. Li, L. Fei-Fei, Mentornet:
Learning data-driven curriculum for very deep neural networks
on corrupted labels, arXiv preprint arXiv:1712.05055 (2017).

[48] D. Sahoo, Q. Pham, J. Lu, S. C. Hoi, Online deep learn-
ing: Learning deep neural networks on the Ô¨Çy, arXiv preprint
arXiv:1711.03705 (2017).

image computing and computer-assisted intervention, Springer,
2017, pp. 399‚Äì407.

[22] G. Wang, W. Li, M. Aertsen, J. Deprest, S. Ourselin, T. Ver-
cauteren, Aleatoric uncertainty estimation with test-time aug-
mentation for medical image segmentation with convolutional
neural networks, Neurocomputing 338 (2019) 34‚Äì45.

[23] Y. Gal, Z. Ghahramani, Dropout as a bayesian approximation:
interna-

Representing model uncertainty in deep learning, in:
tional conference on machine learning, 2016, pp. 1050‚Äì1059.
[24] S.-J. Huang, R. Jin, Z.-H. Zhou, Active learning by querying
informative and representative examples, in: Advances in neural
information processing systems, 2010, pp. 892‚Äì900.

[25] J. Zhang, D. Chen, H. Xie, S. Zhang, L. Gu, I don‚Äôt know:
Double-strategies based active learning for mammographie mass
classiÔ¨Åcation, in: 2017 IEEE Life Sciences Conference (LSC),
IEEE, 2017, pp. 182‚Äì185.

[26] M. T. Dehkordi, A. M. D. Hoseini, S. Sadri, H. Soltanianzadeh,
Local feature Ô¨Åtting active contour for segmenting vessels in
angiograms, IET Computer Vision 8 (3) (2013) 161‚Äì170.
[27] J. Brieva, E. Gonzalez, F. Gonzalez, A. Bousse, J. Bellanger, A
level set method for vessel segmentation in coronary angiogra-
phy, in: 2005 IEEE Engineering in Medicine and Biology 27th
Annual Conference, IEEE, 2006, pp. 6348‚Äì6351.

[28] F. M‚Äôhiri, L. Duong, C. Desrosiers, M. Cheriet, Vessel-
walker: Coronary arteries segmentation using random walks and
hessian-based vesselness Ô¨Ålter, in: 2013 IEEE 10th International
Symposium on Biomedical Imaging, IEEE, 2013, pp. 918‚Äì921.
[29] S. Min, X. Chen, Z.-J. Zha, F. Wu, Y. Zhang, A two-stream
mutual attention network for semi-supervised biomedical seg-
mentation with noisy labels, in: Proceedings of the AAAI Con-
ference on ArtiÔ¨Åcial Intelligence, Vol. 33, 2019, pp. 4578‚Äì4585.
[30] H. Zhu, J. Shi, J. Wu, Pick-and-learn: Automatic quality
evaluation for noisy-labeled image segmentation, in: Interna-
tional Conference on Medical Image Computing and Computer-
Assisted Intervention, Springer, 2019, pp. 576‚Äì584.

[31] D. Zhang, J. Han, L. Zhao, D. Meng, Leveraging prior-
knowledge for weakly supervised object detection under a col-
laborative self-paced curriculum learning framework, Interna-
tional Journal of Computer Vision 127 (4) (2019) 363‚Äì380.
[32] S.-J. Huang, R. Jin, Z.-H. Zhou, Active learning by querying
informative and representative examples, in: Advances in neural
information processing systems, 2010, pp. 892‚Äì900.

[33] O. Sener, S. Savarese, Active learning for convolutional neural
networks: A core-set approach, arXiv preprint arXiv:1708.00489
(2017).

[34] Z. Lin, M. Chen, Y. Ma, The augmented lagrange multiplier
method for exact recovery of corrupted low-rank matrices, arXiv
preprint arXiv:1009.5055 (2010).

[35] L. Jiang, D. Meng, S.-I. Yu, Z. Lan, S. Shan, A. Hauptmann,
Self-paced learning with diversity, in: Advances in Neural In-
formation Processing Systems, 2014, pp. 2078‚Äì2086.

[36] Z. Li, D. Hoiem, Learning without forgetting, IEEE Transac-
tions on Pattern Analysis and Machine Intelligence 40 (2018)
2935‚Äì2947.

[37] S.-J. Huang, J.-W. Zhao, Z.-Y. Liu, Cost-eÔ¨Äective training of
deep cnns with active model adaptation, in: Proceedings of the
24th ACM SIGKDD International Conference on Knowledge
Discovery & Data Mining, ACM, 2018, pp. 1580‚Äì1588.

[38] T. Syeda-Mahmood, D. Beymer, F. Wang, A. Mahmood,
R. J. Lundstrom, N. Shafee, T. Holve, Automatic selection of
keyframes from angiogram videos, in: 2010 20th International
Conference on Pattern Recognition, IEEE, 2010, pp. 4008‚Äì4011.
[39] R. Achanta, A. Shaji, K. Smith, A. Lucchi, P. Fua, S. S¬®usstrunk,
Slic superpixels compared to state-of-the-art superpixel meth-
ods, IEEE transactions on pattern analysis and machine intel-
ligence 34 (11) (2012) 2274‚Äì2282.

[40] H. Hao, H. Ma, T. van Walsum, Vessel layer separation in x-ray
angiograms with fully convolutional network, in: Medical Imag-
ing 2018: Image-Guided Procedures, Robotic Interventions, and
Modeling, Vol. 10576, International Society for Optics and Pho-
tonics, 2018, p. 105761V.

16

