On the asymptotic behavior of bubble date estimators∗

Eiji Kurozumia, Anton Skrobotovb,c
a Hitotsubashi University
b Russian Presidential Academy of National Economy and Public Administration
c Saint Petersburg University (Center for Econometrics and Business Analytics)

February 22, 2022
Revised; September 1, 2022

Abstract

In this study, we extend the three-regime bubble model of Pang et al. (2021) to
allow the forth regime followed by the unit root process after recovery. We provide the
asymptotic and ﬁnite sample justiﬁcation of the consistency of the collapse date estimator
in the two-regime AR(1) model. The consistency allows us to split the sample before and
after the date of collapse and to consider the estimation of the date of exuberation and
date of recovery separately. We have also found that the limiting behavior of the recovery
date varies depending on the extent of explosiveness and recovering.

Keywords:

rational bubble; change points; explosive autoregression; time-varying

volatility; right-tailed unit root testing; mildly explosive; mildly integrated.

JEL Codes: C12, C22

2
2
0
2

p
e
S
1

]

M
E
.
n
o
c
e
[

3
v
0
0
5
4
0
.
0
1
1
2
:
v
i
X
r
a

∗We thank the participants at the Center for Econometrics and Business Analytics (CEBA, St. Petersburg
State University) seminar series and the transdisciplinary econometrics and data science seminar (TEDS) for
helpful discussions and comments. Anton Skrobotov’ research for this paper was supported in part by a grant
from the Russian Science Foundation (Project No. 20-78-10113). Eiji Kurozumi’s research was supported
by JSPS KAKENHI Grant Number 19K01585 and 22K01422. Address correspondence to Eiji Kurozumi,
Department of Economics, Hitotsubashi University, 2-1 Naka, Kunitachi, Tokyo 186-8601, Japan; e-mail:
kurozumi@stat.hit-u.ac.jp

1

 
 
 
 
 
 
1 Introduction

The estimation of the dates of regime changes has a long history in the econometric literature

(see, e.g., Casini and Perron (2019) for a recent review). In this study, we address the issue of

estimating the break dates in explosive bubble model. Such a bubble model is often generated

(see Phillips et al. (2011)) as a unit root process followed by explosive process, which in turn

followed by a unit root regime (with possible stationary recovering regime after the collapse

of the bubble). For estimation of bubble dates, Phillips et al. (2015a,b) (PSY hereinafter)

proposed the recursive algorithm based on the right-tailed ADF test. Generally speaking,

the origination of the bubble is taken at the date for which the test statistic begins to exceed

the critical value, and the date of collapse is taken at the date for which the test statistic

subsequently falls below the critical value (see Skrobotov (2021) for review).

However, as demonstrated in Harvey et al. (2017), the bubble dates estimates are more

accurate if they are obtained by minimizing the sum of the squared residuals over all possible

dates. For the model with only two regimes, Chong (2001) investigated consistency and the

limiting distribution of the break date estimator for the AR(1) model with a break in the

coeﬃcient. The break date estimator is based on minimizing the sum of the squared residuals

(SSR) over all possible break dates. The results depend on the direction of the coeﬃcient

change. Chong (2001) considered three cases, both regimes are stationary, the ﬁrst regime

is a unit root regime, and the second regime is stationary and vice versa. Pang et al. (2018)

extended the result of Chong (2001), allowing the AR(1) coeﬃcient to be dependent on the

sample size. They also considered the case with change in persistence from a unit root to

moderately explosive and vice versa. Pang et al. (2021) (PDC hereinafter) considered the

model with three regimes that reﬂect the explosive ﬁnancial bubble model: the ﬁrst regime

is a unit root regime, followed by an explosive regime and then by a stationary collapsing

regime. PDC investigated the sample splitting strategy: The ﬁrst break date is estimated

for the two regime AR(1) model. Results indicate that the break date estimator is consistent

for the date of collapse (i.e., the second break). Then, one could consider the sample before

the date of collapse and investigate the asymptotic behavior of the date of origination of the

bubble – the results are the same as that in Pang et al. (2018). From a diﬀerent perspective,

the estimation procedure used by PDC is the same as that in Chong (1995) and Bai (1997),

in which multiple breaks are estimated one at a time in the regime-wise stationary model

with level shifts.

In this study, we extend the results of PDC by allowing the forth unit root regime. The

advantage of this extension is that we can investigate not only the emerging and collapsing

2

dates of the bubble but also the recovering date to the normal market. As a result, we

can totally investigate the abnormal market behavior. In our procedure, we ﬁrst prove the

consistency of the collapse date estimator by minimizing the sum of the squared residuals

using the two-regime model, allowing nonstationary volatility. Second, as the estimated break

date is consistent with the collapsing date, one could split the sample at the estimated break

date and consider the estimator of the market recovery date (i.e., the date of change from

stationary collapsing regime to unit root regime) using the subsample after the break date
detected in the ﬁrst step.1 Third, we allow a weak dependence in the innovation errors.
Our approach closely resembles that of Harvey et al. (2017) by minimizing the full SSR

based on the four regimes model. However, Harvey et al. (2017) estimated all the break

dates simultaneously, while we use the sample-splitting approach. As demonstrated in PDC,

this performs better in three-regime case and computationally less involved (we perform the

three SSR minimization with one break each with O(T ) computations, while Harvey et al.

(2017) requires minimizing the three break model over all possible combinations of these

breaks). Interestingly, the limiting behaviour of the market recovery date estimator depends

on the relationship between the extent of the explosive regime and the stationary collapsing

(recovering) regime.

It should be noted that our approach can be easily extended to the multiple bubbles

context. Harvey et al. (2020) proposed to initially identify the bubble regimes based on PSY

approach and then obtain more precise bubble date estimates during each bubble episode.

Subsequently, one can use our approach in the second step.

The remainder of this paper is organized as follows. Section 2 formulates the model and

assumptions. In Section 3, we deﬁne the main procedure and provide the limiting behaviors of

the break date estimators. The model with serially correlated shocks is considered in Section

4. The ﬁnite sample performance of the estimated break dates is demonstrated in Section 5,

and the empirical example is given in Section 6. Section 7 concludes the paper. All proofs

are collected in the appendix.

1The asymptotics for the date of the beginning of the explosive regime were considered in PDC.

3

2 Model and Assumptions

Let us consider the following bubble’s emerging and collapsing model for t = 1, 2, . . . , T :

yt =






c0T −η0 + yt−1 + εt
φayt−1 + εt
φbyt−1 + εt
c1T −η1 + yt−1 + εt

: 1 ≤ t ≤ ke,
: ke + 1 ≤ t ≤ kc,
: kc + 1 ≤ t ≤ kr,
: kr + 1 ≤ t ≤ T,

(1)

where y0 = op(T 1/2), c0 ≥ 0, η0 > 1/2, φa := 1 + ca/T a with ca > 0 and 0 < a < 1,
φb := 1 − cb/T b with cb > 0 and 0 < b < 1, c1 ≥ 0, and η1 > 1/2. In this model, the process
evolves up to time ke as a unit root process with a possibly positive drift shrinking to zero,
and then yt behaves mildly explosive and next starts collapsing at t = kc + 1. Thereafter,
the adjustment (collapsing and recovering) period lasts up to kr and then returns to a unit
root process. We denote the mildly explosive regime with φa := 1 + ca/T a and the mildly
stationary regime with φb := 1 − cb/T b for ease of exposition. However, we can also consider
these AR(1) parameters in more general forms, such as φa := 1 + ca/hT and φb := 1 − cb/kT ,
where hT + T /hT → ∞ and kT + T /kT → ∞. The break points ke, kc, and kr are unknown,
and the corresponding break fractions are deﬁned as τe := ke/T , τc := kc/T , and τr := kr/T ,
respectively. Note that PDC considered a model up to kr. Thus, our model is an extension
of theirs to include the normal market behavior. Note that the result on the estimator of kr
is new to the existing literature.

For model (1), we make the following assumption.

Assumption 1 0 < τe < τc < τr < 1.

Assumption 2 εt := σtet, where {et} ∼ i.i.d.(0, 1) with E[e4

t ] < ∞ and σt := ω(t/T ) where

ω(·) is a nonstochastic and strictly positive function on [0, 1] satisfying ω < ω(·) < ω < ∞.

Assumption 1 implies that break dates are distinct and not quite close each other, which

is typically assumed in the existing literature. Assumption 2 is general enough to allow for

nonstationary unconditional volatility.

Following Cavaliere and Taylor (2007a,b), the functional central limit theorem (FCLT)

holds for the partial sum process of {εt} under Assumption 2:

1
√
T

(cid:98)τ T (cid:99)
(cid:88)

t=1

εt ⇒ ˜ωW (κ(τ )) =: W κ(τ ),

(2)

4

for 0 ≤ τ ≤ 1, where ⇒ signiﬁes weak convergence of associated probability measures, W (·)
is a standard Brownian motion, κ(τ ) := (cid:82) τ
0 ω2(s)ds is called the variance proﬁle,
and ˜ω2 := (cid:82) 1
0 ω2(s)ds. Note that, when σt is constant, W κ(τ ) reduces to a constant volatility
times a standard Brownian motion.

0 ω(s)ds/ (cid:82) 1

Assumption 2 is used mainly for the estimation of the collapsing date kc and the market
recovering date kr for a < b. For the estimation of the emerging date of a bubble ke and the
last break point kr for a > b, we impose the following stronger assumption:

Assumption 3 {εt} ∼ i.i.d.(0, σ2) with E[ε4

t ] < ∞.

Under Assumption 3, the FCLT in (2) becomes simpler and is given by

1
√
T

(cid:98)τ T (cid:99)
(cid:88)

t=1

εt ⇒ σW (τ ).

(3)

This result is used for deriving the limiting distributions of the estimators of ke and kr for
a > b in Theorems 2(iii) and 3(ii), respectively.

3

Individual Estimation of Break Dates

Following PDC, we estimate the model with a one-time break. Note that model (1) can be

expressed as

yt =





φ0yt−1 + ut
φayt−1 + ut
φbyt−1 + ut
φ1yt−1 + ut

where

φ0 := 1
φa := 1 + ca/T a
φb := 1 − cb/T b
φ1 := 1

,

ut :=





c0/T η0 + εt
εt
εt
c1/T η1 + εt.

For a given 1 ≤ k ≤ T − 1, we denote the sum of the squared residuals as

SSR(k/T ) :=

k
(cid:88)

(cid:16)

1

yt − ˆφa(k/T )yt−1

T
(cid:88)

(cid:16)

(cid:17)2

+

yt − ˆφb(k/T )yt−1

(cid:17)2

k+1

(4)

(5)

where (cid:80)m

t=(cid:96) is abbreviated just as (cid:80)m

(cid:96) and

ˆφa(k/T ) =

(cid:80)k

1 yt−1yt
1 y2

t−1

(cid:80)k

and

ˆφb(k/T ) =

(cid:80)T

k+1 yt−1yt
k+1 y2

t−1

(cid:80)T

.

Deﬁning the break point estimator as ˆk := arg mink SSR(k/T ), we have the following theo-
rem.

5

Theorem 1 Suppose that Assumptions 1 and 2 hold. Then, we have limT →∞ P (ˆk = kc) = 1.

Theorem 1 is the same as Theorem 3(a) in PDC and implies that, even if the last regime

with a unit root process is additionally included in the sample period, we can consistently

estimate the bubble collapsing date. This may not be a surprising result because the explosive

behavior in the second regime is quite diﬀerent from those in the other regimes. Therefore,

even if we estimate only a one time break date, the estimator is consistent with the collapsing

date of the bubble. We also note that we allow nonstationary volatility in {εt}, general enough
to apply our method to practical analyses. It might be possible to estimate the break dates

by minimizing the weighted sum of the squared residuals using the volatility estimated by

Harvey et al. (2022), but this is beyond the scope of this paper.

The consistency of the collapsing date is intuitively explained as follows. As given in the

proof of Lemma 2, during the emergence of the bubble in the second regime, the process can

be expressed as

yk = φk−ke

a

yke +

k
(cid:88)

j=ke+1

φ(k−j)
a

uj ∼a φk−ke

a

yke

√

for ke + 1 ≤ k ≤ kc, where yke/
motion. Therefore, the process evolves monotonically at a geometric rate (noting that φa > 1)
and attains its peak at k = kc. Conversely, the process collapses at a geometrically decaying
rate (noting that φb < 1) because it can be expressed as

T weakly converges to a (time-transformed) Brownian

yk = φ(k−kc)
b

ykc +

k
(cid:88)

j=kc+1

φ(k−j)
b

uj,

(6)

for kc + 1 ≤ k ≤ kr, where the ﬁrst term on the right hand side can be shown to dominate
the second term, at least, when k is relatively close to kc. These geometric explosive and
collapsing behaviors help us identify the collapsing date kr consistently.

After we obtained the consistent estimator ˆk of kc, we decompose the whole sample into
two sub-samples for t = 1, . . . , ˆk and ˆk + 1, . . . , T and estimate ke and kr from the ﬁrst and
second sub-samples, respectively. Because ˆk is a consistent estimator of kc, we can treat kc
as a known break point. Thus, we use kc, instead of ˆk, in the following.

Estimation of ke is based on the minimization of the sum of the squared residuals using

the ﬁrst sub-sample, and the estimator is deﬁned as

ˆke := arg min

τ e≤k/T ≤¯τe

SSR1(k/T )

6

where 0 < τ e < τe < ¯τe < τc and

SSR1(k/T ) :=

k
(cid:88)

(cid:16)

1

with

ˆφc(k/T ) =

yt − ˆφc(k/T )yt−1

kc(cid:88)

(cid:16)

(cid:17)2

+

yt − ˆφd(k/T )yt−1

(cid:17)2

(cid:80)k

1 yt−1yt
1 y2

t−1

(cid:80)k

k+1

and

ˆφd(k/T ) =

(cid:80)kc

k+1 yt−1yt
k+1 y2

t−1

(cid:80)kc

.

The corresponding break fraction estimator is deﬁned by ˆτe := ˆke/T .

The consistency of the ˆτe has been already established in Theorem 1.3 of Pang et al.

(2018) and stated in the next theorem.

Theorem 2 (Pang et al. (2018)) Suppose that Assumptions 1 and 3 hold. Then,
(i) when a < 1/2, limT →∞ P (ˆke = ke) = 1 .
(ii) when a = 1/2, |ˆke − ke| = Op(1).
(iii) when a > 1/2,

(1 − φa)2T 2(ˆτe − τe) ⇒ arg max
v∈R

(cid:26) W ∗(v)
W1(τe)

−

(cid:27)

,

|v|
2

where W ∗(v) is a two-sided Brownian motion on R deﬁned to be W ∗(v) = W1(−v) for v ≤ 0
and W ∗(v) = W2(v) for v > 0 with W1(·) and W2(·) being two independent Brownian motion
on R+.

On the other hand, for the estimation of kr, we minimize the sum of the squared residuals

using the second sub-sample, and the estimator is deﬁned as

ˆkr := arg min

τ r≤k/T ≤¯τr

SSR2(k/T )

where τc < τ r < τr < ¯τr < 1 and

SSR2(k/T ) :=

k
(cid:88)

(cid:16)

kc+1

yt − ˆφe(k/T )yt−1

T
(cid:88)

(cid:16)

(cid:17)2

+

yt − ˆφf (k/T )yt−1

(cid:17)2

with

ˆφe(k/T ) =

(cid:80)k

kc+1 yt−1yt
(cid:80)k
kc+1 y2

t−1

k+1

and

ˆφf (k/T ) =

(cid:80)T

k+1 yt−1yt
k+1 y2

t−1

(cid:80)T

.

The corresponding break fraction estimator is deﬁned by ˆτr := ˆkr/T .

To investigate the asymptotic property of ˆkr, we must distinguish the two cases: a < b and
a > b. In the case of a < b, the explosive behavior is faster than the collapsing (recovering)

7

speed, and we continue to make Assumption 2. On the other hand, to derive the limiting

distribution, we need to impose stronger restrictions on the shocks given by Assumption 3

in the case of a > b, in which the process recovers relatively faster than the evolution of the

bubble.

The following theorem reveals that the convergence order of ˆτr depends on whether a < b

or a > b.

Theorem 3 Suppose that Assumptions 1 and 3 hold. (i) When a < b,

P (ˆkr = kr) = 1.

lim
T →∞

(ii) When a > b,

(1 − φb)T (ˆτr − τr) ⇒ arg max
v∈R

(cid:26)

C∗
cb

(v) −

(cid:27)

,

|v|
2

(v) := 2 (cid:82) |v|
0

˜Bcb(s)dB1(s) − cb
0 B2(s)dB2(s)/ ˜Bcb(0) + cb

where C∗
cb
(cid:110)
B2(v) + (cid:82) v
−
0 with ˜Bcb(s) := (cid:82) ∞
dent standard Brownian motions on R+.

(cid:16) ˜B2
(s) − 1/(2cb)
B2(s)/(2 ˜Bcb(0)) + 1
s exp (−cb(t − s)) dB1(t) for s ≥ 0 and B1(·) and B2(·) being two indepen-

ds for v < 0 and C∗
cb
(cid:111)
(cid:17)
/(cb ˜Bcb(0)) for v ≥

(cid:82) |v|
0
(cid:82) v
0

B2(s)ds

(v) :=

(cid:17)

(cid:16)

cb

Remark 1 Evidently, Theorems 2 and 3 hold under Assumptions 1 and 2, except for the

derivation of the limiting distributions. That is, the same convergence orders of the break

date estimators will be obtained with independent and heteroskedastic errors. We made As-

sumption 3 to derive the limiting distributions in Theorems 2(iii) and 3(ii), which are the

same as those obtained in the existing literature.

From Theorem 3, we can observe that the break date from the collapsing (recovering)

regime to the normal market can be consistently estimated if a < b; that is, the explosive

speed of the process is faster than the collapsing speed. In this case, as given in (6), the

process decays at geometric rate for kc + 1 ≤ k ≤ kr (because the ﬁrst term of (6) dominates
the second one) and reaches at

ykr = φ(kr−kc)

b

ykc +

kr(cid:88)

j=kc+1

φ(k−j)
b

uj

∼a φ(kc−ke)
a

φ(kr−ke)
b

yke.

8

Note that φ(kc−ke)

a

φ(kr−ke)
b

→ ∞ when the explosive speed is faster (a < b) because

(cid:16)

log

φ(kc−ke)
a

φ(kr−ke)
b

(cid:17)

= (τc − τe)T log

(cid:16)

1 +

(cid:17)

ca
T a

+ (τr − τc)T log

1 −

(cid:18)

(cid:19)

cb
Tb

= (τc − τe)caT 1−a (1 + o(1)) − (τr − τc)cbT 1−b (1 + o(1)))

(7)

→ ∞

because a < b. That is, the explosive eﬀect induced by φa remains in the process during the
whole collapsing (recovering) regime, after which the process evolves as

yk = ykr + c1

k − kr
T η1

+

k
(cid:88)

j=kr+1

εj ∼a ykr

because we can observe from (7) that T −αφ(kc−ke)
tonically geometrical decay during the collapsing regime followed by the asymptotically ﬂat
behavior makes ˆkr consistent.

→ ∞ for any α > 0. This mono-

φ(kr−kc)
b

a

On the other hand, when the collapsing speed is faster (a > b), the eﬀect of the explosive

φ(kr−kc)
b

component in yk in the recovering regime diminishes to zero as k approaches kr because
φ(kc−ke)
→ 0 when a > b, as can be observed in (7). That is, the initial value eﬀect
a
by ykc in the recovering regime gradually disappears and the process behaves as if it started
from the small initial value. Therefore, we obtain the same result as Theorem 1 of Pang et al.

(2018).

The asymptotically diﬀerent convergence orders in Theorem 3 reﬂect the ﬁnite sample

performance of ˆkr, as presented in Section 5.

Remark 2 It is possible to consider the case where a = b. As is seen from the expansion

given by (7), the case where (τc − τe)ca > (τr − τc)cb will have the same result as the case

of a < b and the reverse relation corresponds to the case of a > b. We can also consider the

knife edge case in which (τc − τe)ca = (τr − τc)cb. In this case, the asymptotic behavior of
φ(kc−ke)
a

depends on the higher order expansion of the logarithms as well as the values

φ(kr−ke)
b

of a = b. Because this knife edge case will make our analysis complicated, we do not pursue

this case and concentrate on the two cases where a < b or a > b to clearly state our main

results.

9

4 Serially Correlated Case

In this section, we extend model (1) with {εt} being serially correlated. We consider the case
where {εt} is a linear process given by

εt =

∞
(cid:88)

j=0

ψjvt−j where

∞
(cid:88)

j=0

j3/2|ψj| < ∞

(8)

For the innovations {vt}, we make the following assumption.

Assumption 4 {vt} ∼ i.i.d.(0, σ2) with E|vt|γ < ∞ for some γ where γ > max(4, 2/a, 2/b).

Linear process (8) can be expressed as, by the BN decomposition,

εt = ψvt + ˜vt−1 − ˜vt where

˜vt :=

∞
(cid:88)

(cid:96)=0

˜ψ(cid:96)vt−(cid:96) with

˜ψ(cid:96) :=

∞
(cid:88)

ψk

k=(cid:96)+1

(9)

and ψ = (cid:80)∞
(cid:80)∞

j=0 ψj.

(cid:96)=0 | ˜ψ(cid:96)| < ∞. In this case, we have the following corollary.

It is also well known that the summability condition in (8) implies

Corollary 1 Suppose that we estimate kc, ke, and kr as in the previous section and that

Assumptions 1 and 4 holds. Then, we obtain the same results as given in Theorems 1, 2, and

3(i), while Theorem 3(ii) holds with the limiting distribution replaced by.

(1 − φb)T (ˆτr − τr) ⇒ arg max
v∈R

(cid:26)

C∗
cb

(v) −

(cid:27)

,

ψ∗

|v|
2

where ψ∗ depends on whether v < 0 or v ≥ 0 and is deﬁned in Appendix C.

By Corollary 1, we can estimate the three break dates by using the misspeciﬁed AR(1)

model with the same convergence orders of the estimators as before, although we may expect

that the ﬁnite sample accuracy of the estimators would be improved by correctly specifying

the correlation structure by considering the ADF type regression with an additional lag

structure.

5 Monte-Carlo Simulations

In this section, we examine the performance of the estimates of the bubble regimes dates

in ﬁnite samples. Our purpose is to demonstrate how the ﬁnite sample properties of the

estimated break dates reﬂect the asymptotic results obtained in the previous section.

10

The Monte-Carlo simulations reported in this section are based on the series generated by

(1) with y0 = 0 and {εt} ∼ IIDN (0, 1). Data were generated from this DGP for samples of
T = (400, 800) with 50, 000 replications.2 We set the drift terms in the ﬁrst and fourth regimes
to c0T −η0 = 1/800 and c1T −η0 = 1/800, respectively, following PDC. In this experiment, we
focus on two cases. In the ﬁrst case, the explosive coeﬃcient φa changes with a ﬁxed φb; φb is
set to 0.96 while φa takes values among (1.01, 1.05, 1.09). In the second case, the collapsing
coeﬃcient φb varies with a ﬁxed φa; φa is set to 1.05 while φb varies among (0.98, 0.96, 0.94).
We set the localising parameters ca = cb = 1; then, the values of a and b are uniquely
determined based on the deﬁnitions given by φa = 1 + 1/T a and φb = 1 − 1/T b. For the dates
of bubble regimes, we use (τe, τc, τr) to be equal to (0.4,0.6,0.7).3

Further, in the minimization of SSR(k/T ), SSR1(k/T ), and SSR2(k/T ), we excluded
the ﬁrst and last 5% observations from the permissible break date k. For example, when
estimating kr based on SSR2(k/T ), the permissible break date k ranges from ˆkc + 0.05T + 1
to 0.95T . If the break date estimate ˆkc exceeds 0.95T , then we cannot estimate kr; we do not
include such a case in any bins of the histogram and thus the sum of the heights of the bins
does not necessarily equal one for ˆkr in some cases. Similarly, we cannot estimate ˆke when
ˆkc < 0.05T . In the following, we investigate only ˆkc and ˆkr because, once ˆkc is obtained, the
estimate of ke in the four regime model is the same as that in the three regime model, which
has been already investigated by PDC.

Figure 1 presents the histograms of ˆkc when φb = 0.96 and φa = (1.01, 1.05, 1.09). As
expected, when φa becomes larger and/or the sample size increases, the ˆkc becomes more
accurate. When a > b (|φa − 1| < |φb − 1| in our setting) as in Figures 1(a) and 1(b), the
frequency of selecting the true break date is not very high (it is around 30% for T = 400 and

65% for T = 800), but it increases to almost 100% as in Figures 1(c)–1(f).

In the second case (Figure 2) where φa = 1.05 and φb varies among (0.98, 0.96, 0.94),
the estimate ˆkc is quite accurate for all the three cases with the almost 100% frequency of
selecting the true break date.

Figure 3 demonstrates the histograms of ˆkr for the ﬁxed value of φb = 0.96 and the
diﬀerent values of φa. For the small value of φa = 1.01, as shown in Figures 3(a) and 3(b),
which corresponds to the case of a > b, we can observe that the accuracy of ˆkr deteriorates,
while for a < b (φa = 1.05 and φa = 1.09) the estimate becomes more accurate. In particular,

2All simulations were programmed in R with rnorm random number generator.
3To compare the estimator of kc with that of PDC, we also set (τe, τc, τr) to be equal to (0.4,0.6,1), that is,

without the last unit root regime (the normal market behavior after the collapse and recovering). The results

are entirely similar and omitted for brevity.

11

for the large sample size of T = 800, the frequency of selecting the true break date is very

close to 100%.

In the case where φa is ﬁxed at 1.05 and φb varies, we can observe the good performance
of the estimate ˆkr even for the case of a > b (φa = 1.05, φb = 0.94) as shown in Figures
4(e) and 4(f). Reﬂecting the result in Theorem 3, the estimate ˆkr is most accurate when
φa = 1.05 and φb = 0.98; the frequency of selecting the true break date is approximately 75%
and 100% for T = 400 and 800, respectively.

We next consider the case where the explosive and collapsing regimes are shorter such

as (τe, τc, τr) = (0.5, 0.55, 0.6), which is relatively close to NASDAQ data in empirical appli-
cation. Figures are collected in the appendix and, as expected, the ﬁnite sample properties

deteriorate in most case, although they improve as T gets larger and/or the explosive speed

gets relatively faster (Figures D.1–D.4).

We also experiment with shorter minimum separation periods; we exclude the ﬁrst and

last 1% samples from the permissible break date k. The results provided in the appendix

demonstrate that there is virtually no signiﬁcant diﬀerence between two trimming parameters

by comparing Figures 1–4 with D.5–D.8.

Finally, we investigate the ﬁnite sample behavior of the break date estimates when the

volatility process σt follows the single shift model, ω(s) = σ0 + (σ1 − σ0)1(s > τσ), where
τσ = 0.5 and σ1/σ0 ∈ {1/3, 3}. Note that σ1/σ0 = 1 corresponds to the case of constant
unconditional volatility.

For σ1/σ0 = 1/3, with which the volatility in the ﬁrst half of the sample is higher than
in the later sample, ˆkc and ˆkr perform similarly to the case of the constant unconditional
volatility; the frequency of correctly selecting the true collapsing date kc is relatively high,
whereas the performance of ˆkr is not satisfactory when φa = 1.01 and φb = 0.96 (Figures
D.9–D.12).

In the case where the low volatility regime shifts to the high volatility one at the middle of

the sample (σ1/σ0 = 3), it becomes more diﬃcult to select the true collapsing and recovering
dates than in the case of σ1/σ0 = 1/3, in particular, when φa = 1.01 and φb = 0.96. The
possible reason is that both kc and kr are in the volatile regime when σ1/σ0 = 3 and thus it
would be diﬃcult to distinguish between the shifts in the parameters and the large shocks.

However, the performance of the estimates improves for the larger values of φa and/or as T
gets larger (Figures D.13–D.16).

12

6 Empirical Application

In this section, we demonstrate the application of the bubble dates estimation method for

the four regime model investigated in the previous sections to two time series data sets. It is

worth noticing that even though we may detect emergence and collapse of a bubble by some

tests, we are not sure whether the ﬁnal observation available for estimation is included in the

collapsing regime or the unit root regime. Therefore, before estimating the break dates, we

need to determine whether the three or four regime model is appropriate. Following Harvey

et al. (2017), we implement the BIC with the penalty term given by the number of estimated

parameters plus the number of breaks to determine the model. In the following, we deﬁne

by BIC2 the BIC obtained from the model without the collapsing regime; by BIC3 the BIC
obtained from the model without the recovering regime; by BIC4 the BIC obtained from the
full four-regime model.

The ﬁrst example is the close prices of monthly data from January 1985 to August 2013
of NASDAQ Composite Index.4 First, we select the model using the BICs; BIC2, BIC3, and
BIC4 equals 3409.296, 3404.268, and 3387.727, respectively. Thus, the four regime model
has the minimum BIC and is selected. As explained in the previous section, we ﬁt the AR(1)

model with two regimes and the estimated break date corresponds to the collapsing date,

which is February 2000, as depicted in Figure 5. Next, by splitting the whole sample at the

estimated collapsing date, the date of origination of the bubble is detected at August 1998

from the ﬁrst subsample, while the date of recovery is estimated at September 2001 from the

seconod subsample. As is observed in Figure 5, our method can detect the explosive and

collapsing behavior very well.

The second example is an application of our method to the logarithm of the U.S. house

price index from January 1991 to December 2012, provided by the Federal Housing Finance
Agency, adjusted by the consumer price index.5 Again, because the BIC selects the four
regime model (BIC2, BIC3, and BIC4 equal −2809.591, −2895.905, and −2918.223, respec-
tively), we ﬁrst estimate the collapsing date, which is estimated at November 2006. As is

seen in Figure 6, the explosive behavior becomes mild around early in 2006 but the collaps-

ing date is estimated just before the series staring crashing. By splitting the whole sample

at the estimated collapsing date, the emergence date of the explosive behavior is estimated

at September 1997, while the recovering date is at May 2011. These estimated dates are

4The data was downloaded from https://ﬁnance.yahoo.com
5The house price index and the CPI are available from https://www.fhfa.gov/DataTools/Downloads/pages/house-

price-index.aspx and https://fred.stlouisfed.org/

13

consistent with the visual inspection and the proposed method works very well.

7 Concluding Remarks

In this paper, we considered the four regime bubble model and investigated the break date

estimators using the sample splitting approach; the break dates are estimated one at a time.

We showed that the break date estimated initially is consistent with the collapsing date of

the bubble. We used the second subsample after the ﬁrst estimated break date to estimate

the break date returning to the normal market. The results revealed that this estimator is

consistent with the recovering date if the explosive speed of the process during the bubble

period is faster than the collapsing (recovering) speed, whereas in the case where the explosive

speed is relatively slower, only the corresponding break fraction estimator is consistent. We

need further investigation when the two speeds are the same.

Although we considered the case where the bubble occurred only once, we can extend

our approach to the multiple bubble model in conjunction with the approach used by Harvey

et al. (2020). In this case, we ﬁrst identify the bubble regimes based on the PSY approach

and then implement our method to each estimated regime.

References

Bai, J. (1997). Estimating multiple breaks one at a time. Econometric Theory, 13(3):315–352.

Casini, A. and Perron, P. (2019). Structural Breaks in Time Series. Oxford Research Ency-

clopedia of Economics and Finance. Oxford University Press.

Cavaliere, G. and Taylor, A. M. R. (2007a). Testing for unit roots in time series models with

non-stationary volatility. Journal of Econometrics, 140(2):919–947.

Cavaliere, G. and Taylor, A. M. R. (2007b). Time-transformed unit root tests for models

with non-stationary volatility. Journal of Time Series Analysis, 29(2):300–330.

Chong, T. T.-L. (1995). Partial parameter consistency in a misspeciﬁed structural change

model. Economics Letters, 49(4):351–357.

Chong, T. T.-L. (2001). Structural change in AR (1) models. Econometric Theory, 17(1):87–

155.

14

Harvey, D., Leybourne, S., and Sollis, R. (2017). Improving the accuracy of asset price bubble

start and end date estimators. Journal of Empirical Finance, 40:121–138.

Harvey, D., Leybourne, S., and Whitehouse, E. (2020). Date-stamping multiple bubble

regimes. Journal of Empirical Finance, 58:226–246.

Harvey, D. I., Leybourne, S. J., and Zu, Y. (2022). Estimation of the variance function in

structural break autoregressive models with non-stationary and explosive segments. Jour-

nal of Time Series Analysis. DOI: 10.1111/jtsa.12660.

Lin, Z. and Bai, Z. (2010). Probability Inequalities. Springer, New York.

Pang, T., Chong, T. T.-L., Zhang, D., and Liang, Y. (2018). Structural change in nonsta-

tionary AR(1) models. Econometric Theory, 34(5):985–1017.

Pang, T., Du, L., and Chong, T. T.-L. (2021). Estimating multiple breaks in nonstationary

autoregressive models. Journal of Econometrics, 221(1):277–311.

Phillips, P. C. B. and Magdalinos, T. (2007). Limit theory for moderate deviations from unity

under weak dependence, volume in The Reﬁnement of Econometric Estimation and Test

Procedures: Finite Sample and Asymptotic Analysis, pages 123–162. Cambridge University

Press, Cambridge.

Phillips, P. C. B., Shi, S., and Yu, J. (2015a). Testing for multiple bubbles: Historical

episodes of exuberance and collapse in the S&P 500.

International Economic Review,

56(4):1043–1078.

Phillips, P. C. B., Shi, S., and Yu, J. (2015b). Testing for multiple bubbles: Limit theory of

real-time detectors. International Economic Review, 56(4):1079–1134.

Phillips, P. C. B., Wu, Y., and Yu, J. (2011). Explosive behavior in the 1990s NASDAQ: When

did exuberance escalate asset values? International Economic Review, 52(1):201–226.

Skrobotov, A. (2021). Testing for explosive bubbles: A review. https://papers.ssrn.com/

sol3/papers.cfm?abstract_id=3779111.

15

Appendix

In Appendix A, we provide the proof of theorems. All the lemmas related to these proofs

are given in Appendix B, while Appendix C gives the proof in the case of the serially correlated

errors. The additional ﬁgures are collected in Appendix D. In the appendices, we denote C

a generic constant that may diﬀer all over and aT ∼a bT implies aT /bT

p

−→ 1 as T → ∞.

A. Proofs of Theorems

Let MT be some positive and increasing sequence such that MT → ∞ and MT /T min(a,b) → 0.
We use the following relations repeatedly:

Op(T α1M α2

T ) = op(φα3T

a

)

and Op(T α1M α2

T φα3T

b

) = op(1)

(A.1)

for any values of α1, α2 and α3 > 0. These relations hold because

log(T α1M α2

T /φα3T
a

log(T α1M α2

T φα3T

b

) = α1 log(T ) + α2 log(MT ) − α3T log
= −α3caT 1−a(1 + o(1)) → −∞.

) = α1 log(T ) + α2 log(MT ) + α3T log

= −α3cbT 1−b(1 + o(1)) → −∞.

(cid:16)

1 +

(cid:17)

ca
T a

(cid:16)

1 −

(cid:17)

cb
T b

We also note that, in the proofs, the orders of the terms of our interest may depend on
φ(kc−ke)
a

in some places, which diverges to inﬁnity when a < b, because

φ(kr−kc)
b

log(φ(kc−ke)
a

φ(kr−ke)
b

) = (kc − ke) log

(cid:16)

1 +

ca
T a
T a + Op

(cid:17)

+ (kr − ke) log

(cid:16)

1 −

(cid:19)(cid:19)

(cid:18) 1
T 2a

− (τr − τc)T

(cid:17)

cb
T b
(cid:18) cb

T b + Op

(cid:19)(cid:19)

(cid:18) 1
T 2b

(cid:18) ca

= (τc − τe)T

→ ∞

when a < b, but it goes to −∞ when a > b. This implies that the following relations similar

to (A.1) hold:

Op(T α1M α2

T ) = op(φα3T

a φα4T
b

) when a < b and Op(T α1M α2

T φα3T

a φα4T
b

) = op(1) when a > b

for any values of α1, α2, α3, and α4 > 0.
Proof of Theorem 1: To prove the consistency of ˆk, we ﬁrst show that ˆk − kc = Op(1).
Similarly to Chong (2001), we prove this by the contradiction argument. Suppose that ˆk − kc

16

is not Op(1), which implies that, for some increasing sequence MT such that MT → ∞ and
MT /T → 0,

lim
T →∞

inf P

(cid:16)

|ˆk − kc| ≥ MT

(cid:17)

≥ α

(A.2)

holds for some 0 < α ≤ 1. We shall prove that (A.2) does not occur as T → ∞. For

this purpose, we decompose the whole sample into ﬁve subsamples such that D0T = {k :
kc − MT + 1 ≤ k ≤ kc + MT }, D1T = {k : 1 ≤ k ≤ ke}, D2T = {k : ke + 1 ≤ k ≤ kc − MT },
D3T = {k : kc + MT + 1 ≤ k ≤ kr}, D4T = {k : kr + 1 ≤ k ≤ T }. Because

(cid:16)

P

|ˆk − kc| ≥ MT

(cid:17)

= P

(cid:32)

(cid:33)

inf
i=1DiT

k∈∪4

SSR(k/T ) < inf

k∈D0T

SSR(k/T )

(cid:32)

≤ P

inf
i=1DiT

k∈∪4

≤

4
(cid:88)

i=1

P

(cid:18)

inf
k∈DiT

(cid:33)

SSR(k/T ) < SSR(kc/T )

SSR(k/T ) < SSR(τc)

,

(cid:19)

we show that

(cid:18)

P

inf
k∈DiT

SSR(k/T ) < SSR(τc)

→ 0

(A.3)

(cid:19)

for i = 1, . . . , 4, which contradict (A.2).

To derive the asymptotic order of SSR(τc), we decompose it into

SSR(τc) =

ke(cid:88)

(cid:16)

yt − ˆφa(kc/T )yt−1

kc(cid:88)

(cid:16)

(cid:17)2

+

yt − ˆφa(kc/T )yt−1

(cid:17)2

1

+

kr(cid:88)

(cid:16)

kc+1

yt − ˆφb(kc/T )yt−1

ke+1

T
(cid:88)

(cid:16)

(cid:17)2

+

kr+1

yt − ˆφb(kc/T )yt−1

(cid:17)2

= S1T + S2T + S3T + S4T , say.

Since

ˆφa(kc/T ) =

(cid:80)kc

1 yt−1ut + (cid:80)ke
1 y2
(cid:80)kc
1 y2

t−1

t−1 + φa

(cid:80)kc

ke+1 y2

t−1

,

(A.4)

17

we have

S1T =

ke(cid:88)

(cid:16)

ut + yt−1 − ˆφa(kc/T )yt−1

(cid:17)2

(cid:80)ke

1 y2

t−1 + (cid:80)kc
(cid:80)kc
1 y2

t−1

ke+1 y2

t−1

yt−1 −

(cid:80)kc

1 yt−1ut + (cid:80)ke
1 y2
(cid:80)kc
1 y2

t−1

t−1 + φa

(cid:80)kc

ke+1 y2

t−1

(cid:33)2

yt−1

(cid:80)kc

1 yt−1ut + (φa − 1) (cid:80)kc
(cid:80)kc

ke+1 y2

t−1

1 y2

t−1

(cid:33)2

yt−1

1

(cid:32)

ke(cid:88)

1

(cid:32)

ke(cid:88)

ut +

ut −

1

ke(cid:88)

1

=

=

=

(ut − ϕ1T yt−1)2 , say.

To investigate the order of ϕ1T , we can observe from (B.3) and (B.9) that

kc(cid:88)

1

yt−1ut =

ke(cid:88)

1

yt−1ut +

kc(cid:88)

ke+1

yt−1ut

= Op(T ) + Op(T (a+1)/2φ(kc−ke)

a

) = Op(T (a+1)/2φ(kc−ke)

a

),

while from (B.7),

(φa − 1)

kc(cid:88)

ke+1

t−1 = Op(T φ2(kc−ke)
y2

a

)

and thus, the second term in the numerator of ϕ1T dominates the ﬁrst term. Because

kc(cid:88)

1

y2
t−1 =

ke(cid:88)

1

y2
t−1 +

kc(cid:88)

ke+1

t−1 = Op(T 2) + Op(T a+1φ2(kc−ke)
y2

a

) = Op(T a+1φ2(kc−ke)

a

)

from (B.2) and (B.7), the second term in the denominator of ϕ1T dominates the ﬁrst term.
Therefore, we can observe that

ϕ1T ∼a

Using this result, we have

S1T =

=

=

ke(cid:88)

1

ke(cid:88)

1

ke(cid:88)

1

(φa − 1) (cid:80)kc
(cid:80)kc
ke+1 y2

t−1

ke+1 y2

t−1

= Op

(cid:18) 1
T a

(cid:19)

.

u2
t − 2ϕ1T

ke(cid:88)

1

yt−1ut + ϕ2
1T

ke(cid:88)

1

y2
t−1

t + Op(T −a)Op(T ) + Op(T −2a)Op(T 2)
u2

t + Op(T 2(1−a))
u2

(A.5)

18

from (B.2) and (B.3).

Similarly, for S2T , we can observe that

S2T =

(cid:32)

kc(cid:88)

ut −

(cid:80)kc

1 yt−1ut + (1 − φa) (cid:80)ke
(cid:80)kc
1 y2

t−1

1 y2

t−1

(cid:33)2

yt−1

ke+1
kc(cid:88)

ke+1

=

(ut − ϕ2T yt−1)2 , say.

From (B.2), (B.3),(B.7) and (B.9), we can observe that

ϕ2T =

Then, we have

Op(T (a+1)/2φ(kc−ke)

a

) + Op(T 2−a)
)

(cid:32)

= Op

1
T (a+1)/2φ(kc−ke)

a

(cid:33)

.

Op(T a+1φ2(kc−ke)

a

S2T =

=

u2
t − 2ϕ2T

kc(cid:88)

ke+1

u2
t + Op(1)

kc(cid:88)

ke+1
kc(cid:88)

ke+1

yt−1ut + ϕ2
2T

kc(cid:88)

ke+1

y2
t−1

from (B.7) and (B.9).

For S3T and S4T , we ﬁrst note that

ˆφb(kc/T ) =

Then, we have

(cid:80)T

kc+1 yt−1ut + φb

(cid:80)kr

kc+1 y2

t−1 + (cid:80)T

kr+1 y2

t−1

(cid:80)T

kc+1 y2

t−1

(A.6)

.

(A.7)

S3T =

=

kr(cid:88)

kc+1
kr(cid:88)

kc+1

(cid:32)

ut −

(cid:80)T

kc+1 yt−1ut + (1 − φb) (cid:80)T
(cid:80)T

kc+1 y2

t−1

kr+1 y2

t−1

(cid:33)2

yt−1

(ut − ϕ3T yt−1)2 , say.

We investigate the order of ϕ3T . From (B.22), (B.32), (B.34), (B.37), and (B.38), we can
observe that

T
(cid:88)

kc+1

yt−1ut + (1 − φb)

T
(cid:88)

kr+1

t−1 = Op(T (b+1)/2φ(kc−ke)
y2

a

)

+

(cid:40)

=

(cid:40)

Op(T φ(kc−ke)
a
Op(T ) + Op(T 2−b)

φ(kr−kc)
b

) + Op(T 2−bφ2(kc−ke)

a

φ2(kr−kc)
b

)

Op(T 2−bφ2(kc−ke)
φ2(kr−kc)
a
b
Op(T (b+1)/2φ(kc−ke)

)

a

)

(a < b)
(a > b),

19

while from (B.19), (B.32), and (B.37),

T
(cid:88)

kc+1

y2
t−1 =

kr(cid:88)

kc+1

y2
t−1 +

T
(cid:88)

kr+1

y2
t−1

= Op(T b+1φ2(kc−ke)

a

) +

= Op(T b+1φ2(kc−ke)

a

)

(cid:40)

Op(T 2φ2(kc−ke)
a
Op(T 2)

φ2(kr−kc)
b

)

(a < b)
(a > b)

because T αφ(kr−kc)

b

→ 0 for any value of α. Then, we have

(cid:40)

ϕ3T =

Using this result, we have

Op(T 1−2bφ2(kr−kc)
b
Op(T −(b+1)/2φ−(kc−ke)

)

a

(a < b)
(a > b)

.

)

S3T =

=

kr(cid:88)

kc+1
kr(cid:88)

kc+1

u2
t − 2ϕ3T

kr(cid:88)

kc+1

yt−1ut + ϕ2
3T

(cid:40)

u2
t +

Op(T 3(1−b)φ2(kc−ke)
Op(1)

a

kr(cid:88)

y2
t−1

kc+1
φ4(kr−kc)
b

)

(a < b)
(a > b)

(A.8)

from (B.19) and (B.22).

Similarly, we have

S4T =

(cid:32)

T
(cid:88)

ut −

(cid:80)T

kc+1 yt−1ut + (φb − 1) (cid:80)kr
(cid:80)T

kc+1 y2

t−1

kc+1 y2

t−1

(cid:33)2

yt−1

kr+1
T
(cid:88)

kr+1

=

(ut − ϕ4T yt−1)2 , say.

From (B.19), (B.22), (B.34), and (B.38), we can observe that the second term of the nu-
merator of ϕ4T dominates the ﬁrst term, and it is Op(T φ2(kc−ke)
is Op(T b+1φ2(kc−ke)
result, we have

), while the denominator
) as shown previously. As a result, we have ϕ4T = Op(T −b). Using this

a

a

S4T =

=

T
(cid:88)

kr+1
T
(cid:88)

kr+1

u2
t − 2ϕ4T

T
(cid:88)

kr+1

yt−1ut + ϕ2
4T

(cid:40)

u2
t +

Op(T 2(1−b)φ2(kc−ke)
Op(T 2(1−b))

a

T
(cid:88)

y2
t−1

kr+1
φ2(kr−kc)
b

)

(a < b)
(a > b)

.

(A.9)

20

Combining (A.5), (A.6), (A.8), and (A.9), we can observe that

SSR(τc) =

(cid:40)

u2
t +

T
(cid:88)

1

Op(T 2(1−b)φ2(kc−ke)
Op(T 2(1−b))

a

φ2(kr−kc)
b

)

(a < b)
(a > b)

.

(A.10)

We next show that (A.3) holds for i = 1, . . . , 4. Let us ﬁrst consider the case where

k ∈ D1T . Because

SSR(k/T ) =

k
(cid:88)

(yt − ˆφa(k/T )yt−1)2 +

ke(cid:88)

k+1

(yt − ˆφb(k/T )yt−1)2

1

+

kc(cid:88)

(yt − ˆφb(k/T )yt−1)2 +

kr(cid:88)

(yt − ˆφb(k/T )yt−1)2 +

T
(cid:88)

(yt − ˆφb(k/T )yt−1)2

ke+1

kc+1

kr+1

kc(cid:88)

≥

(yt − ˆφb(k/T )yt−1)2,

ke+1

it is suﬃcient to show that the last term diverges to inﬁnity faster than SSR(τc) uniformly
over k ∈ D1T . From the deﬁnition of ˆφb, we can observe that

kc(cid:88)

(yt − ˆφb(k/T )yt−1)2 =

ke+1

kc(cid:88)

ke+1

(ut − ϕT yt−1)2 , say,

where

ϕT :=

(cid:80)T

k+1 yt−1ut + (1 − φa) (cid:80)ke

k+1 y2

t−1 + (φb − φa) (cid:80)kr
k+1 y2

(cid:80)T

t−1

kc+1 y2

t−1 + (1 − φa) (cid:80)T

kr+1 y2

t−1

.

The order of each term of the denominator becomes

yt−1ut = Op(T ) + Op(T (a+1)/2φ(kc−ke)

a

) + Op(T (b+1)/2φ(kc−ke)

a

) +

(cid:40)

Op(T φ(kc−ke)
a
Op(T )

φ(kr−kc)
b

)

(a < b)
(a > b)

T
(cid:88)

k+1

= Op(T (max(a,b)+1)/2φ(kc−ke)

a

)

uniformly over k ∈ D1T from (B.5), (B.9), (B.22), (B.34), and (B.38),

|1 − φa|

ke(cid:88)

k+1

y2
t−1 ≤ (φa − 1)

ke(cid:88)

1

t−1 = Op(T 2−a)
y2

from (B.2),

|φb − φa|

kr(cid:88)

kc+1

y2
t−1 =

(cid:16) cb
T b +

ca
T a

(cid:17)

Op(T b+1φ2(kc−ke)

a

) = Op(T b+1−min(a,b)φ2(kc−ke)

a

)

21

from (B.19), and

|1 − φa|

y2
t−1 =

(cid:40)

ca
T a ×

T
(cid:88)

kr+1

Op(T 2φ2(kc−ke)
a
Op(T 2) = Op(T 2−a)

φ2(kr−kc)
b

) = Op(T 2−aφ2(kc−ke)

a

φ2(kr−kc)
b

)

(a < b)
(a > b)

from (B.32) and (B.37). Then, in the numerator of ϕT , the third term dominates the others
and it is Op(T b+1−min(a,b)φ2(kc−ke)

). Similarly, the order of the denominator of ϕT is

a

T
(cid:88)

k+1

y2
t−1 =

ke(cid:88)

k+1

y2
t−1 +

kc(cid:88)

ke+1

y2
t−1 +

kr(cid:88)

kc+1

y2
t−1 +

ke(cid:88)

kr+1

y2
t−1

= Op(T 2) + Op(T a+1φ2(kc−ke)

a

) + Op(T b+1φ2(kc−ke)

a

) +

= Op(T max(a,b)+1φ2(kc−ke)

a

)

(cid:40)

Op(T 2φ2(kc−ke)
a
Op(T 2)

φ2(kr−kc)
b

)

(a < b)
(a > b)

uniformly over k ∈ D1T from (B.2), (B.7), (B.19), (B.32), and (B.37). Therefore, we have

ϕT = Op(T b−min(a,b)−max(a,b)) = Op(T −a),

uniformly over k ∈ D1T . Then, we obtain

kc(cid:88)

ke+1

(ut − ϕT yt−1)2 =

kc(cid:88)

u2
t − 2ϕT

kc(cid:88)

yt−1ut + ϕ2
T

ke+1

ke+1
= Op(T 1−aφ2(kc−ke)

),

a

kc(cid:88)

ke+1

y2
t−1

(A.11)

uniformly over k ∈ D1T , where we note that the dominant term is positive and thus (A.11)
diverges to inﬁnity. This implies that

inf
k∈D1T

SSR(k/T ) ≥ Op(T 1−aφ2(kc−ke)

a

),

which is strictly faster than (A.10). Therefore, (A.3) is proved for i = 1.

For k ∈ D2T , we have

SSR(k/T ) ≥

kr(cid:88)

(yt − ˆφb(k/T )yt−1)2.

kc+1

Allowing for an abuse of notation, we repeatedly redeﬁne ϕT in the following. Similarly, we
can observe that

kr(cid:88)

(yt − ˆφb(k/T )yt−1)2 =

kc+1

kc(cid:88)

ke+1

(ut − ϕT yt−1)2 , say,

22

where

(cid:80)T

k+1 yt−1ut + (φa − φb) (cid:80)kc

k+1 y2
k+1 y2
The order of the ﬁrst term of the numerator becomes

ϕT :=

(cid:80)T

t−1

t−1 + (1 − φb) (cid:80)T

kr+1 y2

t−1

.

yt−1ut = Op(T (a+1)/2φ(kc−ke)

a

) + Op(T (b+1)/2φ(kc−ke)

a

) +

(cid:40)

Op(T φ(kc−ke)
a
Op(T )

φ(kr−kc)
b

)

(a < b)
(a > b)

T
(cid:88)

k+1

= Op(T (max(a,b)+1)/2φ(kc−ke)

a

)

uniformly over k ∈ D2T from (B.11), (B.22), (B.34), and (B.38), while the third term is

(1 − φb)

y2
t−1 =

(cid:40)

cb
T b ×

T
(cid:88)

kr+1

Op(T 2φ2(kc−ke)
a
Op(T 2) = Op(T 2−b)

φ2(kr−kc)
b

) = Op(T 2−bφ2(kc−ke)

a

φ2(kr−kc)
b

)

(a < b)
(a > b)

from (B.32) and (B.37). For the second term, note that

kc(cid:88)

kc−MT +1

y2
t−1 ≤

kc(cid:88)

k+1

y2
t−1 ≤

kc(cid:88)

ke+1

y2
t−1

over k ∈ D2T ; thus, using (B.7) and (B.8), the following relation holds.

Op(T 1−min(a,b)MT φ2(kc−ke)

a

) ≤ (φa − φb)

kc(cid:88)

k+1

t−1 ≤ Op(T a+1−min(a,b)φ2(kc−ke)
y2

a

).

(A.12)

Thus, in the numerator of ϕT , the second term, which is always positive, dominates the
others, and its order is bounded from below and above, as in (A.12). On the other hand, the

order of the denominator of ϕT is bounded below by

T
(cid:88)

k+1

y2
t−1 ≥

kr(cid:88)

kc+1

t−1 = Op(T b+1φ2(kc−ke)
y2

a

),

(A.13)

from (B.19) and bounded above by

T
(cid:88)

k+1

y2
t−1 ≤

kc(cid:88)

ke+1

y2
t−1 +

kr(cid:88)

kc+1

y2
t−1 +

ke(cid:88)

kr+1

y2
t−1

= Op(T a+1φ2(kc−ke)

a

) + Op(T b+1φ2(kc−ke)

a

) +

= Op(T max(a,b)+1φ2(kc−ke)

a

)

(cid:40)

Op(T 2φ2(kc−ke)
a
Op(T 2)

φ2(kr−kc)
b

)

(a < b)
(a ≥ b)

(A.14)

23

from (B.7), (B.19), (B.32), and (B.37). By combining (A.12), (A.13), and (A.14), we can

observe that ϕT is asymptotically positive and

Op(T −(a+b)MT ) =

Op(T 1−min(a,b)MT φ2(kc−ke)
Op(T max(a,b)+1φ2(kc−ke)
)

a

)

a
Op(T a+1−min(a,b)φ2(kc−ke)
Op(T b+1φ2(kc−ke)

)

a

a

)

≤ ϕT ≤

Using this result, we obtain

= Op(T a−b−min(a,b)).

(A.15)

kr(cid:88)

kc+1

(ut − ϕT yt−1)2 =

kr(cid:88)

kc+1

u2
t − 2ϕT

kr(cid:88)

yt−1ut + ϕ2
T

kr(cid:88)

y2
t−1

≥ Op(T −2(a+b)M 2
= Op(T 1−2a−bM 2

kc+1
kc+1
T )Op(T b+1φ2(kc−ke)
T φ2(kc−ke)
),

)

a

a

(A.16)

uniformly over k ∈ D2T from (B.19), (B.22), and (A.15), where the inequality holds because
the third term dominates the others in the ﬁrst equality. This implies that

inf
k∈D2T

SSR(k/T ) ≥ Op(T 1−2a−bM 2

T φ2(kc−ke)

a

),

which is strictly faster than (A.10). Therefore, (A.3) is proved for i = 2.

For k ∈ D3T , we have

SSR(k/T ) ≥

kc(cid:88)

(yt − ˆφa(k/T )yt−1)2.

ke+1

Then, we can observe that

kc(cid:88)

(yt − ˆφa(k/T )yt−1)2 =

ke+1

kc(cid:88)

ke+1

(ut − ϕT yt−1)2 , say,

where

ϕT :=

(cid:80)k

1 yt−1ut + (1 − φa) (cid:80)ke
1 y2
(cid:80)k
1 y2

t−1

t−1 + (φb − φa) (cid:80)k

kc+1 y2

t−1

.

The order of the ﬁrst term of the numerator becomes

k
(cid:88)

1

yt−1ut = Op(T ) + Op(T (a+1)/2φ(kc−ke)

a

) + Op(T (b+1)/2φ(kc−ke)

a

)

= Op(T (max(a,b)+1)/2φ(kc−ke)

a

)

24

uniformly over k ∈ D3T from (B.3), (B.9), and (B.23), while the second term is

(1 − φa)

ke(cid:88)

1

t−1 = Op(T 2−a)
y2

from (B.2). For the third term, note that

kc+MT(cid:88)

kc+1

y2
t−1 ≤

k
(cid:88)

kc+1

y2
t−1 ≤

kr(cid:88)

kc+1

y2
t−1

over k ∈ D3T ; thus, using (B.19) and (B.20), the following relation holds.

Op(T 1−min(a,b)MT φ2(kc−ke)

a

) ≤ |φb − φa|

k
(cid:88)

kc+1

t−1 ≤ Op(T b+1−min(a,b)φ2(kc−ke)
y2

a

).

(A.17)

Thus, in the numerator of ϕT , the third term, which is always negative, dominates the others,
and its order is bounded from below and above, as in (A.17). On the other hand, the order

of the denominator of ϕT is bounded below by

k
(cid:88)

1

y2
t−1 ≥

kc(cid:88)

ke+1

t−1 = Op(T a+1φ2(kc−ke)
y2

a

),

(A.18)

from (B.7) and bounded above by

k
(cid:88)

1

y2
t−1 ≤

ke(cid:88)

1

y2
t−1 +

kc(cid:88)

ke+1

y2
t−1 +

kr(cid:88)

kc+1

y2
t−1

= Op(T max(a,b)+1φ2(kc−ke)

a

)

(A.19)

from (B.2), (B.7), and (B.19). By combining (A.17), (A.18), and (A.19), we can observe that

ϕT is asymptotically negative and

Op(T −(a+b)MT ) =

≤ |ϕT | ≤

Using this result, we obtain

Op(T 1−min(a,b)MT φ2(kc−ke)
Op(T max(a,b)+1φ2(kc−ke)
)

a

)

a
Op(T b+1−min(a,b)φ2(kc−ke)
Op(T a+1φ2(kc−ke)

)

a

a

)

= Op(T b−a−min(a,b)).

(A.20)

kc(cid:88)

ke+1

(ut − ϕT yt−1)2 =

kc(cid:88)

ke+1

u2
t − 2ϕT

kc(cid:88)

yt−1ut + ϕ2
T

kc(cid:88)

y2
t−1

≥ Op(T −2(a+b)M 2
= Op(T 1−a−2bM 2

ke+1
ke+1
T )Op(T a+1φ2(kc−ke)
T φ2(kc−ke)
),

a

a

)

(A.21)

25

uniformly over k ∈ D3T from (B.7), (B.9), and (A.20), where the inequality holds because
the third term asymptotically dominates the others. This implies that

inf
k∈D3T

SSR(k/T ) ≥ Op(T 1−a−2bM 2

T φ2(kc−ke)

a

),

which is strictly faster than (A.10). Therefore, (A.3) is proved for i = 3.

For k ∈ D4T , we have

SSR(k/T ) ≥

kc(cid:88)

(yt − ˆφa(k/T )yt−1)2.

ke+1

We can see that

kc(cid:88)

(yt − ˆφa(k/T )yt−1)2 =

ke+1

kc(cid:88)

ke+1

(ut − ϕT yt−1)2 , say,

where

ϕT :=

(cid:80)k

1 yt−1ut + (1 − φa) (cid:80)ke

1 y2

t−1 + (φb − φa) (cid:80)kr
(cid:80)k
1 y2

t−1

kc+1 y2

t−1 + (1 − φa) (cid:80)k

kr+1 y2

t−1

.

The order of each term of the numerator becomes

k
(cid:88)

1

yt−1ut = Op(T ) + Op(T (a+1)/2φ(kc−ke)

a

) + Op(T (b+1)/2φ(kc−ke)

a

)

(cid:40)

+

Op(T φ(kr−kc)
a
Op(T )

φ(kr−kc)
b

)

(a < b)
(a > b)

(cid:41)

= Op(T (max(a,b)+1)/2φkc−ke

a

)

uniformly over k ∈ D4T from (B.3), (B.9), (B.22), (B.35), and (B.39),

(1 − φa)

ke(cid:88)

1

t−1 = Op(T 2−a)
y2

(φb − φa)

kr(cid:88)

kc+1

t−1 = Op(T b+1−min(a,b)φ2(kc−ke)
y2

a

)

from (B.2),

from (B.19), and

|1 − φa|

k
(cid:88)

kr+1

y2
t−1 ≤ |1 − φa|

(cid:40)

y2
t−1 =

T
(cid:88)

kr+1

Op(T 2−aφ2(kc−ke)
Op(T 2−a)

a

φ2(kr−kc)
b

)

(a < b)
(a > b)

26

from (B.32) and (B.37); thus, the third term of the numerator of ϕT , which takes negative
values, dominates the others, and it is Op(T b+1−min(a,b)φ2(kc−ke)
). On the other hand, the
order of the denominator is given by

a

k
(cid:88)

1

t−1 = Op(T 2) + Op(T a+1φ2(kc−ke)
y2

a

) + Op(T b+1φ2(kc−ke)

a

)

(cid:40)

+

Op(T 2φ2(kc−kr)
a
Op(T 2)

φ2(kr−kc)
b

)

(a < b)
(a > b)

(cid:41)

= Op(T max(a,b)+1φ2(kc−ke)

a

)

from (B.2), (B.7), (B.19), (B.32), and (B.37). Then, we have

ϕT = Op(T b−min(a,b)−max(a,b)) = Op(T −a)

uniformly over k ∈ D4T . Therefore, we obtain
kc(cid:88)

kc(cid:88)

kc(cid:88)

(ut − ϕT yt−1)2 =

u2
t − 2ϕT

yt−1ut + ϕ2
T

kc(cid:88)

y2
t−1

ke+1

ke+1

ke+1
= Op(T ) + Op(T −a)Op(T (a+1)/2φ(kc−ke)
= Op(T 1−aφ2(kc−ke)

ke+1

),

a

a

) + Op(T −2a)Op(T a+1φ2(kc−ke

a

))

(A.22)

uniformly over k ∈ D4T from (B.7) and (B.9). This implies that

inf
k∈D4T

SSR(k/T ) ≥ Op(T 1−aφ2(kc−ke)

a

),

which is strictly faster than (A.10). Therefore, (A.3) is proved for i = 4.

As we established ˆk − kc = Op(1), there exists a positive integer M for any given (cid:15) such
that P (|ˆk − kc| > M ) < (cid:15) for all suﬃciently large T . In the same manner as Pang et al.
(2021), we can observe that

P (ˆk (cid:54)= kc) = P (|ˆk − kc| > M ) + P (|ˆk − kc| ≤ M, ˆk (cid:54)= kc)

M
(cid:88)

m=1
M
(cid:88)

≤ (cid:15) +

= (cid:15) +

m=1
M
(cid:88)

P

m=1

+

P (SSR(τc − m/T ) − SSR(τc) < 0) +

M
(cid:88)

m=1

P (SSR(τc + m/T ) − SSR(τc) < 0)

P

(cid:32)

(cid:32)

1
T (φa − φb)2φ2(kc−ke)

a

{SSR(τc − m/T ) − SSR(τc)} < 0

(cid:33)

1
T (φa − φb)2φ2(kc−ke)

a

{SSR(τc + m/T ) − SSR(τc)} < 0

.

(cid:33)

We show that the probabilities on the right-hand side go to 0. Note that the diverging

order of SSR(kc) has been already obtained in (A.10), which is strictly smaller than T (φa −
φb)2φ2(kc−kr)
a

; thus, we can ignore SSR(τc) divided by the scaling term.

27

We ﬁrst focus on SSR(τc − m/T ). Let k = (τc − m/T )T = kc − m. Then, allowing an

abuse of notation, SSR(τc − m/T ) is decomposed into

SSR(τc − m/T ) =

ke(cid:88)

(yt − ˆφayt−1)2 +

k
(cid:88)

(yt − ˆφayt−1)2

1

+

kc(cid:88)

k+1

ke+1
kr(cid:88)

(yt − ˆφbyt−1)2 +

(yt − ˆφbyt−1)2 +

T
(cid:88)

(yt − ˆφbyt−1)2

kc+1

kr+1

= S1T + S2T + S3T + S4T + S5T , say.

We investigate each of Sit for i = 1, . . . , 5.

For S1T , we can observe that

ke(cid:88)

(ut + yt−1 − ˆφayt−1)2 =

S1T =

1

ke(cid:88)

1

(ut − ϕ1T yt−1)2,

where ϕ1T =

(cid:80)k

1 yt−1ut + (φa − 1) (cid:80)k
(cid:80)k

ke+1 y2

t−1

= Op(T −a),

1 y2
which is obtained by using (B.2), (B.3), (B.7), and (B.9) because m is a ﬁxed integer value

t−1

(k = kc − m). Then, we obtain

S1T =

ke(cid:88)

(u2

t − 2ϕ1T yt−1ut + ϕ2

1T y2

t−1) = Op(T ) + Op(T 1−a) + Op(T 2(1−a))

1

from (B.2) and (B.3), which is smaller order than T (φa − φb)2φ2(kc−kr)
the scaling term is negligible.

a

; thus, S1T divided by

For S2T , we can observe that

k
(cid:88)

S2T =

(ut + φayt−1 − ˆφayt−1)2 =

ke+1

k
(cid:88)

(ut − ϕ2T yt−1)2,

ke+1

where ϕ2T =

(cid:80)k

1 yt−1ut + (1 − φa) (cid:80)ke
(cid:80)k
1 y2

t−1

1 y2

t−1

= Op(T −(a+1)/2φ−(kc−ke)

a

),

which is obtained by using (B.2), (B.3), (B.7), and (B.9). Then, we obtain

k
(cid:88)

S2T =

(u2

t − 2ϕ2T yt−1ut + ϕ2

2T y2

t−1) = Op(T ) + Op(1) + Op(1)

ke+1

from (B.7) and (B.9), which is smaller order than T (φa − φb)2φ2(kc−ke)
the scaling term is negligible.

a

; thus, S2T divided by

28

For S3T ,

S3T =

kc(cid:88)

k+1

(ut + φayt−1 − ˆφbyt−1)2 =

kc(cid:88)

(ut − ϕ3T yt−1)2,

where ϕ3T =

(cid:80)T

k+1 yt−1ut + (φb − φa) (cid:80)kr
(cid:80)T

t−1 + (1 − φa) (cid:80)T

kr+1 y2

t−1

.

k+1
kc+1 y2
k+1 y2

t−1

As k = kc − m and m is a ﬁxed integer, we can observe from (B.6), (B.11), (B.19), (B.22),
(B.32), (B.34), (B.37), and (B.38) that the second term in the numerator dominates the

others, whereas

T
(cid:88)

k+1

y2
t−1 ∼a

kr(cid:88)

kc+1

y2
t−1.

Therefore, we can observe that

ϕ3T ∼a

Using this result, we have

(φb − φa) (cid:80)kr
(cid:80)kr
kc+1 y2

t−1

kc+1 y2

t−1

= (φb − φa).

1
T (φa − φb)2φ2(kc−ke)

a

S3T =

1
T (φa − φb)2φ2(kc−ke)

a

∼a

∼a

1
T (φa − φb)2φ2(kc−ke)
1
T (φa − φb)2φ2(kc−ke)

a

a

yt−1ut + ϕ2
3T

(cid:33)

y2
t−1

kc(cid:88)

k+1

(cid:32) kc(cid:88)

k+1

u2
t − 2ϕ3T

kc(cid:88)

k+1

ϕ2
3T

kc(cid:88)

y2
t−1

kc−m+1

(φb − φa)2mφ2(kc−ke)

a

y2
ke

⇒ m(W κ(τe))2

from (B.1) and (B.6).

For S4T ,

kr(cid:88)

S4T =

(ut + φbyt−1 − ˆφbyt−1)2 =

kc+1
(cid:80)T

where ϕ3T =

k+1 yt−1ut + (φa − φb) (cid:80)kc

t−1 + (1 − φb) (cid:80)T

kr+1 y2

t−1

.

k+1 y2
k+1 y2

t−1

(cid:80)T

ke(cid:88)

1

(ut − ϕ4T yt−1)2,

From (B.6), (B.11), (B.22), (B.32), (B.34), (B.37), and (B.38), we can see that the second
term of the numerator is the dominant term, which is Op(T 1−min(a,b)φ2(kc−ke)
denominator is Op(T b+1φ2(kc−ke)
). Then, we have

), while the

a

a

ϕ4T = Op(T −b−min(a,b)).

29

Thus,

kr(cid:88)

S4T =

(u2

t − 2ϕ4T yt−1ut + ϕ2

4T y2

t−1)

kc+1

= Op(T ) + Op(T (1−b)/2−min(a,b)φkc−ke

a

) + Op(T 1−b−2 min(a,b)φ2(kc−ke)

a

)

from (B.19) and (B.22), which is smaller order than T (φa − φb)2φ2(kc−ke)
by the scaling term is negligible.

a

; thus, S4T divided

For S5T ,

T
(cid:88)

S5T =

(ut + yt−1 − ˆφbyt−1)2 =

ke(cid:88)

1

(ut − ϕ5T yt−1)2,

kr+1
(cid:80)T

where ϕ5T =

k+1 yt−1ut + (φa − 1) (cid:80)kc
(cid:80)T

k+1 y2
k+1 y2

t−1

t−1 + (φb − 1) (cid:80)kr

kc+1 y2

t−1

.

From (B.6), (B.11), (B.19), (B.22), (B.32), (B.34), (B.37), and (B.38), we can observe that
the third term of the numerator is the dominant term, which is Op(T φ2(kc−ke)
denominator is Op(T b+1φ2(kc−ke)

). Then, we have ϕ5T = Op(T −b) and thus,

), while the

a

a

T
(cid:88)

S5T =

(u2

t − 2ϕ5T yt−1ut + ϕ2

5T y2

t−1)

kr+1

(cid:40)

= Op(T ) +

φ(kr−kc)
Op(T 1−bφ(kc−ke)
b
Op(T 1−b) + Op(T 2(1−b))

a

) + Op(T 2(1−b)φ2(kc−ke)

a

φ2(kr−kc)
b

)

(a < b)
(a > b)

from (B.32), (B.34), (B.37), and (B.38), which is smaller order than T (φa − φb)2φ2(kc−ke)
thus, S5T divided by the scaling term is negligible.

a

;

To summarize the result, we have, for a given positive integer value of m,

1
T (φa − φb)2φ2(kc−ke)

a

(SSR(τc − m/T ) − SSR(τc)) ⇒ m(W κ(τe))2,

which implies that

(cid:32)

P

1
T (φa − φb)2φ2(kc−ke)

a

{SSR(τc − m/T ) − SSR(τc)} < 0

→ 0.

(cid:33)

A similar result is obtained for SSR(τc + m/T ). Let k = (τc + m/T )T = kc + m. Then,

in exactly the same manner, we can show that

1
T (φa − φb)2φ2(kc−ke)

a

(SSR(τc + m/T ) − SSR(τc)) ⇒ m(W κ(τe))2.

30

Thus, for a given positive integer value of m,

(cid:32)

P

1
T (φa − φb)2φ2(kc−ke)

a

{SSR(τc + m/T ) − SSR(τc)} < 0

→ 0.(cid:4)

(cid:33)

Proof of Theorem 3: (i) We ﬁrst show that ˆkr − kr = Op(1). That is,

lim
T →∞

inf P

(cid:16)

|ˆkr − kr| ≥ MT

(cid:17)

≥ α

(A.23)

does not hold for any 0 < α ≤ 1 where MT → ∞ and MT /T → 0 For this purpose,
we decompose the range of the permissible break dates into three sub-samples such that
E0T = {k : kr − MT + 1 ≤ k ≤ kr + MT }, E1T = {k : kr + 1 ≤ k ≤ kr − MT }, and
E2T = {k : kr + MT + 1 ≤ k ≤ kr}, where kr := τ rT and kr := τ rT . Because
(cid:18)

(cid:19)

(cid:16)

P

|ˆkr − kr| ≥ MT

(cid:17)

= P

inf
k∈E1T ∪E2T

SSR2(k/T ) < inf
k∈E0T

SSR2(k/T )

(cid:18)

≤ P

inf
k∈E1T ∪E2T

SSR2(k/T ) < SSR2(kr/T )

(cid:19)

≤

2
(cid:88)

i=1

P

(cid:18)

inf
k∈EiT

SSR2(k/T ) < SSR2(τr)

,

(cid:19)

we will show that, for i = 1 and 2,

(cid:18)

P

inf
k∈EiT

SSR2(k/T ) < SSR2(τr)

→ 0.

(A.24)

(cid:19)

We ﬁrst consider the case where k ∈ E1T . Following (B.2) in Chong (2001), we have

SSR2(k/T ) − SSR2(τr) = 2(1 − φb)

+(1 − φb)2

(cid:32) (cid:80)kr

k+1 y2

(cid:80)T

kr+1 yt−1ut

t−1
(cid:80)T

k+1 y2
(cid:80)kr

t−1
k+1 y2

t−1

(cid:80)T

kr+1 y2
(cid:80)T

t−1
k+1 y2

t−1

−

(cid:80)T

(cid:80)kr

kr+1 y2
t−1
(cid:80)T
k+1 y2

t−1

k+1 yt−1ut

(cid:33)

+ ΛT (k/T ),

(A.25)

where

ΛT (k/T ) =

(cid:16)(cid:80)kr

kc+1 yt−1ut
(cid:80)kr
kc+1 y2

t−1

(cid:17)2

−

(cid:16)(cid:80)k

kc+1 yt−1ut
(cid:80)k
kc+1 y2

t−1

(cid:17)2

+

(cid:16)(cid:80)T

kr+1 yt−1ut
(cid:80)T
kr+1 y2

t−1

(cid:17)2

−

(cid:16)(cid:80)T

(cid:17)2

.

k+1 yt−1ut
(cid:80)T
k+1 y2

t−1

(A.26)

Thus, as explained in Appendix C on page 122 of Chong (2001), it is suﬃcient to show that
A1 = op(λ), A2 = op(λ), and A3 = op(λ2), where λ = 1 − φb = cb/T b,

A1 =

(cid:80)T

kr+1 yt−1ut
(cid:80)T
kr+1 y2

t−1

, A2 = max
k∈E1T

(cid:80)kr

k+1 yt−1ut
(cid:80)kr
k+1 y2

t−1

, A3 = max
k∈E1T

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

31

(cid:80)T

k+1 y2
t−1
(cid:80)kr
k+1 y2

t−1

t−1

(cid:80)T

kr+1 y2

(cid:12)
(cid:12)
(cid:12)
ΛT (k/T )
(cid:12)
(cid:12)

.

Using (B.32) and (B.34), we have, for a < b,

A1 = Op

(cid:32)

1
T φ(kc−ke)
a

φ(kr−kc)
b

(cid:33)

= op

(cid:19)

,

(cid:18) 1
T b

while using (B.21) and (B.24),

|A2| ≤

maxk∈E1T | (cid:80)kr
(cid:80)kr

kr−MT +1 y2

t−1

k+1 yt−1ut|

(cid:32)

= Op

1

T (1−b)/2MT φ(kc−ke)

a

φ2(kr−kc)
b

(cid:33)

= op

(cid:19)

.

(cid:18) 1
T b

To derive the order of A3, we expand it, as given in Appendix C of Chong (2001),

A3 ≤

(cid:32)

×

(cid:80)T



+

1
kr+1 y2
t−1
(cid:12)
(cid:16)(cid:80)kr
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:16)(cid:80)T


 max
k∈E1T

+ max
k∈E1T

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

(cid:33)

1
kr−MT +1 y2

(cid:80)kr

t−1

kc+1 yt−1ut
(cid:80)kr
kc+1 y2

t−1

(cid:17)2

−

(cid:16)(cid:80)k

kc+1 yt−1ut
(cid:80)k
kc+1 y2

t−1

kr+1 yt−1ut
(cid:80)T
kr+1 y2

t−1

(cid:17)2

(cid:17)2

(cid:16)(cid:80)T

k+1 yt−1ut
(cid:80)T
k+1 y2
(cid:32)

t−1

−

(cid:33)

(cid:17)2

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

(cid:12)
(cid:12)

(cid:12)
(cid:12)

(cid:12)
(cid:12)

1

(A.27)

(cid:33)(cid:33)

=

(cid:32)

(cid:32)

Op

(cid:32)

1
T 2φ2(kc−ke)
a

φ2(kr−kc)
b

+ Op

(cid:32)

×

Op(1) + Op(1) + Op(1) + Op

(cid:32)

= Op

1

(cid:33)

T 2−bMT φ2(kc−ke)

a

φ4(kr−kc)
b

1
T 1−bφ2(kr−kc)
b
(cid:18) 1
T 2b

(cid:19)

= op

T MT φ2(kc−ke)
a
(cid:33)(cid:33)

φ2(kr−kc)
b

using Lemmas 3 and 4, where the second terms in the two maxima are evaluated as

(cid:16)(cid:80)k

kc+1 yt−1ut
(cid:80)k
kc+1 y2

t−1

(cid:17)2

≤

max
k∈E1T

by (B.26) and (B.23), and

maxk∈E1T

(cid:16)(cid:80)k

kc+1 yt−1ut

(cid:17)2

(cid:80)kr

kc+1 y2

t−1

=

Op(T b+1φ2(kc−ke)
Op(T b+1φ2(kc−ke)

a

a

)

)

= Op(1)

(cid:16)(cid:80)T

k+1 yt−1ut
(cid:80)T
k+1 y2

t−1

max
k∈E1T

(cid:17)2

(cid:16)

maxk∈E1T | (cid:80)kr

(cid:17)2

kr+1 yt−1ut|

k+1 yt−1ut| + | (cid:80)T
kr+1 y2
)

(cid:80)T

t−1

(cid:32)

= Op

Op(T b+1φ2(kc−ke)

a
Op(T 2φ2(kc−ke)
a

φ2(kr−kc)
b

)

(cid:33)

1
T 1−bφ2(kr−kc)
b

≤

=

32

by (B.24), (B.32), and (B.34), respectively. Then, we obtained (A.24) for i = 1.

In the case of k ∈ E2T , we have, following (B.4) in Chong (2001),

SSR2(k/T ) − SSR2(τr) = 2(1 − φb)

+(1 − φb)2

(cid:80)k

kr+1 y2
(cid:80)k

kc+1 y2
(cid:80)kr

t−1
kc+1 y2

t−1

t−1
kc+1 y2

t−1

(cid:32) (cid:80)k

kr+1 yt−1ut
(cid:80)k

(cid:80)kr

kc+1 y2

t−1

(cid:80)kr

kc+1 yt−1ut
(cid:80)k

−

(cid:80)k

kr+1 y2

t−1

(cid:33)

kc+1 y2

t−1

+ ΛT (k/T ).

(A.28)

Thus, as explained in Appendix C on page 124 of Chong (2001), it is suﬃcient to show that
A4 = op(λ), A5 = op(λ), and A6 = op(λ2), where λ = 1 − φb = cb/T b,

(cid:80)kr

A4 =

kc+1 yt−1ut
(cid:80)kr
kc+1 y2

kr+1 yt−1ut
(cid:80)k
kr+1 y2
Using (B.19) and (B.22), we have, for a < b,

, A5 = max
k∈E2T

t−1

t−1

(cid:80)k

, A6 = max
k∈E2T

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

(cid:80)k

kc+1 y2
t−1
(cid:80)kr
kc+1 y2

t−1

t−1

(cid:80)k

kr+1 y2

ΛT (k/T )

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

.

(cid:32)

A4 = Op

1
T (b+1)/2φ(kc−ke)

a

(cid:33)

= op

(cid:19)

,

(cid:18) 1
T b

while using (B.33) and (B.35),
maxk∈E2T | (cid:80)k
(cid:80)kr+MT
kr+1

|A5| ≤

kr+1 yt−1ut|
y2
t−1

(cid:32)

= Op

1
MT φ(kc−ke)
a

φ(kr−kc)
b

(cid:33)

= op

(cid:19)

.

(cid:18) 1
T b

To derive the order of A6, we expand it, as given in Appendix C of Chong (2001),

+

(cid:33)

1
(cid:80)kr+MT
kr+1

y2
t−1

kc+1 yt−1ut
(cid:80)kr
kc+1 y2

t−1

(cid:17)2

−

(cid:17)2

(cid:16)(cid:80)k

kc+1 yt−1ut
(cid:80)k
kc+1 y2

t−1

A6 ≤

×

t−1
(cid:16)(cid:80)kr

(cid:32)



(cid:80)kr


 max
k∈E2T

1
kc+1 y2
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

+ max
k∈E2T

(cid:16)(cid:80)T

kr+1 yt−1ut
(cid:80)T
kr+1 y2

t−1

(cid:17)2

(cid:16)(cid:80)T

(cid:17)2

−

(cid:33)

k+1 yt−1ut
(cid:80)T
k+1 y2

t−1

= op

(cid:19)

(cid:18) 1
T 2b

(cid:32)

= Op

1

T MT φ2(kc−ke)
a

φ2(kr−ke)
b

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

(cid:12)
(cid:12)

(cid:12)
(cid:12)

(cid:12)
(cid:12)

(A.29)

using Lemmas 3 and 4, where the second terms in the two maxima are evaluated as
(cid:17)2

(cid:17)2

(cid:16)

| (cid:80)kr

kc+1 yt−1ut| + maxk∈E2T

kr+1 yt−1ut|

(cid:80)k

(cid:16)(cid:80)k

kc+1 yt−1ut
(cid:80)k
kc+1 y2

t−1

max
k∈E2T

≤

=

(cid:80)kr

kc+1 y2

t−1

Op(T b+1φ2(kc−ke)
Op(T b+1φ2(kc−ke)

a

a

)

)

= Op(1)

33

by (B.19), (B.22), and (B.35), and

(cid:16)(cid:80)T

k+1 yt−1ut
(cid:80)T
k+1 y2

t−1

max
k∈E2T

(cid:17)2

≤

=

maxk∈E2T

(cid:16)(cid:80)T

k+1 yt−1ut

(cid:17)2

(cid:80)T

kr+1 y2

Op(T 2φ2(kc−ke)
a
Op(T 2φ2(kc−ke)
a

t−1
φ2(kr−kc)
b
φ2(kr−kc)
b

)

)

= Op(1),

by (B.40) and (B.36), respectively. Then, we obtained (A.24) for i = 2.

As we established ˆkr − kr = Op(1), there exists a positive integer M for any given (cid:15) such
that P (|ˆkr − kr| > M ) < (cid:15) for all suﬃciently large T . In the same manner as PDC, we have

P (ˆkr (cid:54)= kr)

= P (|ˆkr − kr| > M ) + P (|ˆkr − kr| ≤ M, ˆkr (cid:54)= kr)

(cid:32)

P

(cid:32)

M
(cid:88)

≤ (cid:15) +

m=1
M
(cid:88)

P

m=1

+

1

T (1 − φb)2φ2(kc−ke)

a

φ2(kr−kc)
b

1

T (1 − φb)2φ2(kc−ke)

a

φ2(kr−kc)
b

(SSR2 (τr − m/T ) − SSR(τr)) < 0

(cid:33)

(cid:33)

(SSR2 (τr + m/T ) − SSR(τr)) < 0

.(A.30)

From expression (A.25) with k replaced by kr − m, we can show that the second term of
(A.25) dominates the ﬁrst and third terms using Lemmas 3 and 4. By focusing the second

term, we can observe that, for a given ﬁxed m,

1
T φ2(kc−ke)

a

φ2(kr−kc)
b

(cid:80)T

kr+1 y2
(cid:80)T

(cid:80)kr

kr−m+1 y2

t−1

t−1
kr−m+1 y2

t−1

a

=

φ2(kr−kc)
b

1
T φ2(kc−ke)
my2
kr
T φ2(kc−ke)
φ2(kr−kc)
a
b
⇒ m(W κ(τe))2

∼a

((cid:80)T

kr+1 y2
(cid:80)T

t−1)my2
kr

(1 + op(1))

kr+1 y2

t−1(1 + op(1))

using (B.1) and (B.26), which implies that

(cid:32)

P

1

T (1 − φb)2φ2(kc−ke)

a

φ2(kr−kc)
b

(SSR2 (τr − m/T ) − SSR(τr)) < 0

→ 0.

(cid:33)

Similarly, from expression (A.28) with k replaced by kr + m, we can show that the second
term of (A.28) dominates the ﬁrst and third terms using Lemmas 3 and 4. By focusing on

34

the second term, we can observe that, for a given ﬁxed m,

1
T φ2(kc−ke)

a

φ2(kr−kc)
b

(cid:80)kr

kc+1 y2

(cid:80)kr+m

kr+1 y2

t−1

t−1
(cid:80)kr+m
kc+1 y2

t−1

((cid:80)kr

kc+1 yt−1)2my2
kr
(cid:80)kr
kc+1 y2
t−1(1 + op(1))

(1 + op(1))

a

=

φ2(kr−kc)
b

1
T φ2(kc−ke)
my2
kr
φ2(kr−kc)
T φ2(kc−ke)
a
b
⇒ m(W κ(τe))2

∼a

using (B.1) and (B.26) and thus, for a given positive integer value of m,

(cid:32)

P

1

T (1 − φb)2φ2(kc−ke)

a

φ2(kr−kc)
b

(SSR2 (τr + m/T ) − SSR(τr)) < 0

→ 0.

(cid:33)

In case (ii), we ﬁrst prove (A.23) with MT replaced by MbT does not hold, where MbT →
∞ and T b+(cid:15)/MbT → 0 for a given (cid:15) > 0. That is, for any given (cid:15) > 0, the objective
function cannot be minimized outside the T b+(cid:15) neighborhood of kr. Let, for a given (cid:15),
Eb0T = {k : kr − MbT + 1 ≤ k ≤ kr + MbT }, Eb1T = {k : kr + 1 ≤ k ≤ kr − MbT }, and
Eb2T = {k : kr + MbT + 1 ≤ k ≤ kr}, where we suppress the dependence on (cid:15) for notational
simplicity. Then, as in case (i), it is suﬃcient to prove that
(cid:18)

(cid:19)

P

inf
k∈EbiT

SSR2(k/T ) < SSR2(τr)

→ 0

(A.31)

for i = 1 and 2 when a > b.

In exactly the same manner as in case (i), the diﬀerence in the sums of the squared

residuals is expressed as (A.25) for k ∈ Eb1T and (A.28) for k ∈ Eb2T . Thus, it is suﬃcient
to prove that A1 = op(1/T b), Ab2 = op(1/T b), and Ab3 = op(1/T 2b), A4 = op(1/T b), Ab5 =
op(1/T b), and Ab6 = op(1/T 2b), where Ab2, Ab3, Ab5, and Ab6 are deﬁned as A2, A3, A5, and
A6 with EiT replaced by EbiT for i = 1 and 2, respectively.

For k ∈ Eb1T , A1 = Op(1/T ) = op(1/T b) by (B.37) and (B.38), while Ab2 = op(1/T b) is
obtained by (B.41). As in the proof in case (i), Ab3 is bounded above, as given in (A.27) with
MT and E1T replaced by MbT and Eb1T , respectively. Using (B.26), we have

kr(cid:88)

y2
t−1 ∼a

kr(cid:88)





t−1
(cid:88)

kr−MbT +1

kr−MbT +1

j=kc+1



2

φt−j−1
b

uj



= Op(T bMbT )

because E[

(cid:16)(cid:80)t

j=kc+1 φt−j

b uj

(cid:17)2

] = O(T b) for k ∈ Eb1T . Thus, with (B.37), we can observe

that

(cid:32)

1
kr+1 y2

t−1

(cid:80)T

+

1
kr−MbT +1 y2

(cid:80)kr

t−1

(cid:33)

= Op

(cid:19)

(cid:18) 1
T 2

+ Op

(cid:18) 1

(cid:19)

T bMbT

= Op

(cid:18) 1

T bMbT

(cid:19)

.

35

For the ﬁrst maximum in (A.27), the ﬁrst term can be observed Op(1) by (B.19) and (B.22),
while for the second term,

k
(cid:88)

kc+1

t−1 = Op(T b+1φ2(kc−ke)
y2

a

)

uniformly over k ∈ Eb1T by using (B.18). Therefore, we can observe with (B.23) that the
second term is Op(1) uniformly over k ∈ Eb1T . Similarly, for the second maximum in (A.27),
the ﬁrst term can be observed Op(1) by (B.37) and (B.38), while for the second term, we can
observe that

T
(cid:88)

k+1

t−1 = T b(kr − k)
y2

(cid:32)

1
T b(kr − k)

kr(cid:88)

k+1

(cid:33)

y2
t−1

+

T
(cid:88)

kr+1

y2
t−1

= T b(kr − k)Op(1) + Op(T 2) = Op(T 2)

uniformly over k ∈ Eb1T , where the second equality holds by (B.37) and because the term
in the parentheses uniformly converges in probability to σ2/(2cb), as shown in the proof of
Lemma 5, while the last equality is obtained by noting that T b(kr − k) ≤ CT b+1 for k ∈ Eb1T .
For the numerator of the second term, we have

T
(cid:88)

k+1

yt−1ut = (kr − k)

(cid:32)

1
kr − k

kr(cid:88)

k+1

(cid:33)

yt−1ut

+

T
(cid:88)

kr+1

yt−1ut

= op(T ) + Op(T ) = Op(T )

uniformly over k ∈ Eb1T , where the second equality holds by (B.38) and because the term
in the parentheses is uniformly op(1), as shown in the proof of Lemma 5. Therefore, we can
observe that the second term in the second maximum in (A.27) is Op(1) uniformly over Eb1T .
Summarizing these results, we can observe that Ab3 = Op(1/(TbMbT )) = op(1/T 2b).

For k ∈ Eb2T , A4 = Op(1/(T (b+1)/2φ(kc−ke)

)) = op(1/T b) by (B.19) and (B.22), while
Ab5 = op(1/T b) is obtained by (B.42). As in the proof in case (i), Ab6 is bounded above, as
given in (A.29) with MT and E2T replaced by MbT and Eb2T , respectively. Using (B.40), we
have

a

kr+MbT(cid:88)

kr+1

kr+MbT(cid:88)

y2
t−1 ∼a





t−1
(cid:88)


2

εj



= Op(M 2

bT ).

kr+1

j=kr+1

Thus, with (B.19), we can observe that

(cid:32)

1
kc+1 y2

(cid:80)kr

t−1

+

1

(cid:80)kr+MbT
kr+1

y2
t−1

(cid:33)

(cid:32)

= Op

1
T b+1φ2(kc−ke)
a

(cid:33)

+ Op

(cid:19)

(cid:18) 1
M 2
bT

= Op

(cid:19)

.

(cid:18) 1
M 2
bT

36

For the ﬁrst maximum in (A.29), the ﬁrst term is Op(1) as shown above for Ab3, while for
the second term,

k
(cid:88)

kc+1

y2
t−1 ≥

kr(cid:88)

kc+1

t−1 = Op(T b+1φ2(kc−ke)
y2

a

)

by (B.19) and

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

k
(cid:88)

kc+1

yt−1ut

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

≤

kr(cid:88)

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
kc+1

yt−1ut

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

+

k
(cid:88)

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
kr+1

yt−1ut

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

(cid:16)

= Op

T (b+1)/2φ(kc−ke)

a

(cid:17)

+ Op(T )

by (B.22) and (B.39). Thus, the second term is Op(1) uniformly over k ∈ Eb2T . Similarly,
for the second maximum in (A.29), the ﬁrst term Op(1) as shown above for Ab3, while for
the second term, we have

T
(cid:88)

k+1

y2
t−1 ≥

T
(cid:88)

kr+1

t−1 = Op(T 2)
y2

and the numerator is uniformly Op(T 2) by (B.39). Thus, the second term is Op(1) uniformly
over k ∈ Eb2T . Summarizing these results, we can observe that Ab6 = Op(1/(M 2
bT )) =
op(1/T 2b).

To derive the limiting distribution of (1 − φb)T (ˆτr − τr), let k = kr + vT b where v is a
ﬁnite constant, and consider the O(T b) order neighborhood of kr. We ﬁrst derive the limiting
distribution when v < 0 (k = kr − |v|T b) using (A.25), in which ΛT (k/T ) can be shown to
be op(1) using the same technique as before. Because time is measured in 1/T b units rather
than 1/T in this case, we note that

1
T b/2

kr(cid:88)

k+1

εt =

1
T b/2

|v|T b−1
(cid:88)

i=0

εkr−i ⇒ σB1(|v|),

(A.32)

by the FCLT, where B1(·) is a standard Brownian motion on R+. Then, we can observe that

1
T b/2

yk−1 =

1
T b/2

φ(k−kc−1)
b

ykc +

1
T b/2

k−1
(cid:88)

j=kc+1

φ(k−j−1)
b

εj

(A.33)

= Op(T (1−b)/2φ(kc−ke)

a

φ(kr−|v|T b−kc)
b

) +

1
T b/2

kr−kc−1
(cid:88)

i=|v|T b+1

φi−|v|T b−1
b

εkr−i

= op(1) +

1
T b/2

kr−kc−1
(cid:88)

(cid:16)

i=|v|T b+1

1 −

cb
T b

(cid:17)T b(i/T b−|v|−1/T b)

εkr−i

(A.34)

⇒ σ

(cid:90) ∞

|v|

exp (−cb(s − |v|)) dB1(s) =: σ ˜Bcb(|v|).

(A.35)

37

Using these results, each term in (A.25) becomes, by noting that (cid:80)T
op(1)) in this case,

k+1 y2

t−1 = (cid:80)T

kr+1 y2

t−1(1+

2(1 − φb)

(cid:80)kr

k+1 y2

(cid:80)T

kr+1 yt−1ut

t−1
(cid:80)T

k+1 y2

t−1

=

2cb
T b

Op(T 2b)Op(T )
Op(T 2)

= Op(T b−1) = op(1),

(A.36)

−2(1 − φb)

(cid:80)T

(cid:80)kr

kr+1 y2
t−1
(cid:80)T
k+1 y2

t−1

k+1 yt−1ut

= −

2cb
T b

kr(cid:88)

kr−|v|T b+1

yt−1εt(1 + op(1))

|v|T b−1
(cid:88)

= −2cb

i=0
(cid:90) |v|

⇒ −2σ2cb

0

ykr−i−1
T b/2

εkr−i
T b/2

˜Bcb(s)dB1(s)

(A.37)

by (A.35), and

(1 − φb)2

(cid:80)T

kr+1 y2
(cid:80)T

t−1
k+1 y2

t−1

(cid:80)kr

k+1 y2

t−1

=

=

c2
b
T 2b

c2
b
T 2b

⇒ σ2c2
b

= σ2c2
b

kr(cid:88)

kr−|v|T b+1

y2
t−1(1 + op(1))

|v|T b−1
(cid:88)

y2
kr−i−1(1 + op(1))

i=0
(cid:90) |v|

0
(cid:90) |v|

0

˜B2
cb

(s)ds

(cid:18)

˜B2
cb

(s) −

(cid:19)

1
2cb

ds +

σ2cb|v|
2

, (A.38)

where we note that E[ ˜B2
cb

(s)] = 1/(2cb) for any s ≥ 0 in the last equality. Then, we have

SSR2(k/T ) − SSR2(τr) ⇒ −σ2cb

(cid:90) |v|

(cid:32)
2

0

˜Bcb(s)dB1(s) − cb

(cid:90) |v|

(cid:18)

0

˜B2
cb

(s) −

(cid:19)

1
2cb

ds −

(cid:33)

|v|
2

for v < 0. Because argmin{SSR2(k/T ) − SSR2(τr)} = argmax{−(SSR2(k/T ) − SSR2(τr))},
we obtain the limiting distribution given in the theorem.

Similarly, for k = kr + vT b with v ≥ 0, it can be shown that ΛT (k/T ) = op(1) in (A.28).

Note that

1
T b/2

k
(cid:88)

kr+1

ut =

1
T b/2

kr+vT b
(cid:88)

kr+1

εt + op(1)

⇒ σB2(v)

38

(A.39)

(A.40)

where B2(·) is a standard Brownian motion on R+ independent of B1(·). Then, each term in
(A.28) becomes, noting that (cid:80)k

t−1(1 + op(1)) in this case,

t−1 = (cid:80)kr

kc+1 y2

kc+1 y2
(cid:80)kr

kc+1 y2

t−1

2(1 − φb)

(cid:80)k

kr+1 yt−1ut
(cid:80)k

kc+1 y2


t−1

ykr +

c1(t − kr − 1)
T η1

=

2cb
T b

kr+vT b
(cid:88)

kr+1

(cid:16) c1
T η1

(cid:17)

+ εt

(1 + op(1))



εj





t−1
(cid:88)

j=kr+1

t−1
(cid:88)

+





= 2cb






⇒ 2σ2cb

kr+vT b
(cid:88)

1
T b ykr
(cid:90) v

εt +

1
T b
(cid:17)
(cid:16) ˜Bcb(0) + B2(s)

kr+1

kr+vT b
(cid:88)

kr+1

j=kr+1

dB2(s),

εj

 εt + op(1)






(1 + op(1))

(A.41)

0
where we used ykr /T b/2 ⇒ σ ˜Bcb(0) by (A.35),

2(1 − φb)

and

(1 − φb)2

(cid:80)k

kr+1 y2
(cid:80)k

(cid:80)kr

kc+1 y2

t−1

t−1
kc+1 y2

t−1

Then, we have

(cid:80)kr

kc+1 yt−1ut
(cid:80)k

kc+1 y2

t−1

(cid:80)k

kr+1 y2

t−1

= op(1),

(A.42)

=

=

c2
b
T 2b

c2
b
T 2b

⇒ σ2c2
b

kr+vT b
(cid:88)

kr+1

kr+vT b
(cid:88)

kr+1
(cid:90) v

0

y2
t−1(1 + op(1))



ykr +

c1(t − kr − 1)
T η1

+

t−1
(cid:88)

j=kr+1


2

εj



(1 + op(1))

(cid:16) ˜Bcb(0) + B2(s)

(cid:17)2

ds.

(A.43)

SSR2(k/T ) − SSR2(τr)

⇒ σ2

(cid:20)

2cb

(cid:90) v

0

= −2σ2c2
b

˜B2
cb

(0)

−

(cid:16) ˜Bcb(0) + B2(s)
(cid:40)

(cid:34)

(cid:17)

dB2(s) + c2
b

(cid:90) v

0

B2(v)
cb ˜Bcb(0)

+

(cid:82) v
0 B2(s)dB2(s)

cb ˜B2
cb

(0)

(cid:21)

ds

(cid:17)2

(cid:16) ˜Bcb(0) + B2(s)
(cid:40)
(cid:41)
(cid:82) v
0 B2
2 ˜B2
cb

v
2

+

−

2(s)ds
(0)

2 (cid:82) v
0

+

˜Bcb(0)B2(s)ds
2 ˜B2
(0)
cb

(cid:41)(cid:35)

.

Because the last two terms in the second braces can be expressed as

(cid:82) v
0 B2
2 ˜B2
cb

2(s)ds
(0)

2 (cid:82) v
0

+

˜Bcb(0)B2(s)ds
2 ˜B2
(0)
cb

=

=

1
˜Bcb(0)
1
˜Bcb(0)

(cid:32)

(cid:90) v

0

(cid:32)

(cid:90) v

0

B2(s)B2(s)
2 ˜Bcb(0)
B2(s)
2 ˜Bcb(0)

+ 1

(cid:33)

+ B2(s)

ds

(cid:33)

B2(s)ds,

39

the limiting distribution can be expressed as

SSR2(k/T ) − SSR2(τr)

(cid:40)

⇒ −2σ2c2
b

˜B2
cb

(0)

−

(cid:34)

1
cb ˜Bcb(0)

B2(v) +

(cid:90) v

0

B2(s)
˜Bcb(0)

dB2(s) + cb

(cid:32)

(cid:90) v

0

B2(s)
2 ˜Bcb(0)

(cid:33)

(cid:35)

+ 1

B2(s)ds

−

(cid:41)

,

v
2

for v ≥ 0. Then, we obtain the limiting distribution for v ≥ 0 given in the theorem.(cid:4)

40

B. Lemmas

Lemma 1 Under Assumption 2, for 1 ≤ k ≤ ke,

1
√
T
ke(cid:88)

yke ⇒ W κ(τe).

t−1 = Op(T 2).
y2

1

ke(cid:88)

1
k
(cid:88)

1

ke(cid:88)

k+1

yt−1ut = Op(T ).

yt−1ut = Op(T ) uniformly over 1 ≤ k ≤ ke.

yt−1ut = Op(T ) uniformly over 1 ≤ k ≤ ke − 1.

(B.1)

(B.2)

(B.3)

(B.4)

(B.5)

Proof of Lemma 1: From (4), we have

yt = y0 + c0

t
T η0

t
(cid:88)

+

εj.

1

Then, by the FCLT (2) and the continuous mapping theorem (CMT), we obtain (B.1) and

(B.2). For (B.3)–(B.5), we note that

and

1
T

k
(cid:88)

1

yt−1ut =

(cid:32)

1
2T

k − y2
y2

0 −

(cid:33)

k
(cid:88)

1

u2
t

k
(cid:88)

1

u2
t =

c2
0
T 2η0

+

2c0
T η0

k
(cid:88)

1

εt +

k
(cid:88)

1

ε2
t .

Thus, we can observe that (B.3) and (B.4) hold. (B.5) holds from (B.4) because (cid:80)ke
(cid:80)ke

1 yt−1ut − (cid:80)k

1 yt−1ut.(cid:4)

k+1 yt−1ut =

Lemma 2 Under Assumption 2, for ke + 1 ≤ k ≤ kc,

yk ∼a φk−ke

a

yke uniformly over ke + 1 ≤ k ≤ kc.

kc(cid:88)

ke+1

kc(cid:88)

kc−MT +1

t−1 = Op(T a+1φ2(kc−ke)
y2

a

).

t−1 = Op(T MT φ2(kc−ke)
y2

a

).

41

(B.6)

(B.7)

(B.8)

kc(cid:88)

ke+1
k
(cid:88)

ke+1
kc(cid:88)

k+1

kc(cid:88)

kc−MT +1

yt−1ut = Op(T (a+1)/2φ(kc−ke)

a

).

(B.9)

yt−1ut = Op(T (a+1)/2φ(kc−ke)

a

) uniformly over ke + 1 ≤ k ≤ kc.

(B.10)

yt−1ut = Op(T (a+1)/2φ(kc−ke)

a

) uniformly over ke + 1 ≤ k ≤ kc − 1. (B.11)

yt−1ut = Op(T 1/2M 1/2

T φ(kc−ke)
a

).

(B.12)

Proof of Lemma 2: For ke + 1 ≤ k ≤ kc, yk is expressed as

yk = φ(k−ke)

a

yke +

k
(cid:88)

j=ke+1

φ(k−j)
a

uj

= φ(k−ke)
a

yke + φ(k−ke)
a

k
(cid:88)

j=ke+1

φ(ke−j)
a

uj



= φ(k−ke)
a

yke +



φ−j(cid:48)
a uke+j(cid:48)

 .

k−ke(cid:88)

j(cid:48)=1

(B.13)

Because {φ−j(cid:48)
Haj´eck-R´enyi inequality (HRI) for martingale diﬀerences (6.6b in Lin and Bai (2010)),

is a martingale diﬀerence sequence (MDS), we have, from the

a uke+j(cid:48)}kc−ke
j(cid:48)=1



P



max
1≤k−ke≤kc−ke

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

k−ke(cid:88)

j(cid:48)=1

φ−j(cid:48)
a uke+j(cid:48)



≥ N

 ≤

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

¯ω2
N 2

kc−ke(cid:88)

φ−2j(cid:48)
a

=

≤

j(cid:48)=1
1 − φ−2(kc−ke)
a
φ2
a − 1

¯ω2
N 2
C
N 2 T a
(cid:12)
(cid:12) = Op(T a/2). As yke =
(cid:12)

(cid:12)
(cid:80)k−ke
(cid:12)
(cid:12)

j(cid:48)=1 φ−j(cid:48)

a uke+j(cid:48)

for any given N > 0. This implies that max
Op(T 1/2) by (B.1) in Lemma 1, we have (B.6).

Using (B.6), we can observe that

kc(cid:88)

ke+1

t−1 ∼a y2
y2
ke

kc(cid:88)

φ2(t−ke−1)
a

ke+1
1 − φ2(kc−ke)
a
1 − φ2
a

= y2
ke

42

= Op(T a+1φ2(kc−ke)

a

)

and thus we obtain (B.7).

Similarly, for (B.8), we have

kc(cid:88)

kc−MT +1

t−1 ∼a y2
y2
ke

φ2(kc−ke−MT )
a

− φ2(kc−ke)
a

1 − φ2
a

∼a y2
ke

T a
2ca

φ2(kc−ke)
a

(cid:0)1 − φ−2MT
a

(cid:1) .

In general, when x → 0, y → ∞ (or y → −∞), and xy → 0, (1 + x)y can be expanded as

(B.14)

(B.15)

(1 + x)y = exp (y log(1 + x))

= exp (cid:0)y(x + O(x2))(cid:1)
= 1 + xy + O(x2y2).

By applying (B.14) to φ−2MT

a

, we have

1 − φ−2MT
a

= 1 −

ca
T a

(cid:16)

1 +

(cid:18)

(cid:17)−2MT

= 1 −

1 − 2MT

ca
T a + O

(cid:18) M 2
T
T 2a

(cid:19)(cid:19)

= 2ca

MT
T a (1 + o(1)).

We thus obtain

kc(cid:88)

kc−MT +1

t−1 ∼a y2
y2
ke

T a
2ca

φ2(kc−ke)
a

× 2ca

MT
T a = Op(T MT φ2(kc−ke

a

).

(B.9) is obtained by noting that

from (B.6) and that

kc(cid:88)

ke+1

yt−1ut ∼a yke

kc(cid:88)

ke+1

φ(t−ke−1)
a

ut

V ar





kc(cid:88)

ke+1

φ(t−ke−1)
a

ut


 = O(T aφ2(kc−ke)

a

).

Similarly, by using (B.6), we can observe that

k
(cid:88)

ke+1

yt−1ut ∼a yke

k
(cid:88)

ke+1

φt−ke−1
a

ut.

(B.16)

43

Again, by the HRI for any ﬁxed value of N > 0,



P

 max

ke+1≤k≤kc

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

k
(cid:88)

ke+1

φ(t−ke−1)
a

ut

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)





≥ N

 = P



max
1≤k−ke≤kc−ke

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

k−ke(cid:88)

j(cid:48)=1

φj(cid:48)−1
a

uke+j(cid:48)



≥ N



(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

≤

≤

¯ω2
N 2

kc−ke(cid:88)

j(cid:48)=1

φ2(j(cid:48)−1)
a

C
N 2 T aφ2(kc−ke)

a

,

which implies (cid:80)k
bining this with (B.16), we have (B.10).

ke+1 φ(t−ke−1)

a

ut = Op(T a/2φ(kc−ke)

a

) uniformly over ke + 1 ≤ k ≤ kc. Com-

(cid:80)k

(B.11) is obtained using (B.9) and (B.10) by noting that (cid:80)ke
ke+1 yt−1ut.
Similarly to (B.9), we have, for (B.12),

k+1 yt−1ut = (cid:80)kc

ke+1 yt−1ut −

kc(cid:88)

yt−1ut ∼a yke

kc(cid:88)

φ(t−ke−1)
a

ut,

kc−MT +1

kc−MT +1

and





V ar

kc(cid:88)

kc−MT +1

φ(t−ke−1)
a

ut



 ≤ ¯ω2 φ2(kc−ke−MT )

a

− φ2(kc−ke)
a

1 − φ2
a

≤ CT aφ2(kc−ke)
a
≤ CMT φ2(kc−ke)

a

,

(1 − φ−2MT
a

)

where the last inequality is obtained by using (B.15). Thus, we obtain (B.12).(cid:4)

Lemma 3 Under Assumption 2, for kc + 1 ≤ k ≤ kr,

k
(cid:88)

kc+1
kr(cid:88)

kc+1
kc+MT(cid:88)

kc+1
kr(cid:88)

kr−MT +1

ykr = Op(T 1/2φ(kc−ke)

a

φ(kr−kc)
b

) + Op(T b/2).

(B.17)

t−1 = y2
y2
kc

k
(cid:88)

kc+1

φ2(t−kc−1)
b

(1 + op(1)) uniformly over kc + 1 ≤ k ≤ kr.(B.18)

t−1 = Op(T b+1φ2(kc−ke)
y2

a

).

t−1 = Op(T MT φ2(kc−ke)
y2

a

).

t−1 = Op(T MT φ2(kc−ke)
y2

a

φ2(kr−kc)
b

) when a < b.

44

(B.19)

(B.20)

(B.21)

kr(cid:88)

kc+1
k
(cid:88)

kc+1
kr(cid:88)

k+1

kc+MT(cid:88)

kc+1

yt−1ut = Op(T (b+1)/2φ(kc−ke)

a

).

(B.22)

yt−1ut = Op(T (b+1)/2φ(kc−ke)

a

) uniformly over kc + 1 ≤ k ≤ kr.

(B.23)

yt−1ut = Op(T (b+1)/2φ(kc−ke)

a

) uniformly over kc + 1 ≤ k ≤ kr − 1.

(B.24)

yt−1ut = Op(T 1/2M 1/2

T φ(kc−ke)
a

).

Proof of Lemma 3: For kc + 1 ≤ k ≤ kr, yk is expressed as

yk = φ(k−kc)
b

ykc +

k
(cid:88)

j=kc+1

φ(k−j)
b

uj.

(B.25)

(B.26)

In particular, when k = kr, (B.26) becomes

ykr ∼a φ(kr−kc)

b

φ(kc−ke)
a

yke +

kr(cid:88)

j=kc+1

φ(kr−j)
b

uj = Op(T 1/2φ(kc−kr)

a

φ(kr−kc)
b

) + Op(T b/2).

Note that the dominant order depends on the behavior of φkc−ke

a

φkr−kc
b

.

For (B.18),

k
(cid:88)

kc+1

t−1 = y2
y2
kc

k
(cid:88)

kc+1

φ2(t−kc−1)
b

+ 2ykc

k
(cid:88)

t−1
(cid:88)

kc+1

j=kc+1

φ(2t−kc−j−2)
b

uj +

k
(cid:88)





t−1
(cid:88)

kc+1

j=kc+1


2

φ(t−j−1)
b

uj



.

(B.27)

From the deﬁnition of φb, we can observe that the ﬁrst term on the right-hand side of (B.27)
) = Op(T φ2(kc−ke)
is at least Op(y2
) (when
kc
k = kr). For the third term, we can observe that


) (when k is ﬁnite) and at most Op(T b+1φ2(kc−ke)


2





a

a

2

k
(cid:88)

t−1
(cid:88)



φ(t−j−1)
b

uj



≤

kr(cid:88)

t−1
(cid:88)



φ(t−j−1)
b

uj



kc+1

j=kc+1

kc+1

j=kc+1

and





E

kr(cid:88)





t−1
(cid:88)

kc+1

j=kc+1

φ(t−j−1)
b

uj





2
 ≤ ¯ω2

kr(cid:88)

t−1
(cid:88)

kc+1

j=kc+1

φ2(t−j−1)
b

= O(T b+1).

Therefore, the ﬁrst term on the right hand side of (B.27) dominates the third term for all

kc + 1 ≤ k ≤ kr. We can also see that the former dominates the second term by Cauchy-
Schwarz inequality; thus, we obtain (B.18).

45

(B.19) and (B.20) are easily obtained by (B.18) with k = kr and k = kc+MT , respectively,

using (B.14).

For (B.21), we have, similarly to (B.27),

kr(cid:88)

t−1 = y2
y2
kc

kr(cid:88)

kr−MT +1

kr−MT +1

φ2(t−kc−1)
b

+ 2ykc

kr(cid:88)

t−1
(cid:88)

kr−MT +1


2

j=kc+1

φ(2t−kc−j−2)
b

uj

φ(t−j−1)
b

uj



.

(B.28)

kr(cid:88)

+





t−1
(cid:88)

kr−MT +1

j=kc+1

The order of the ﬁrst term of (B.28) is given by

kr(cid:88)

y2
kc

kr−MT +1

φ2(t−kc−1)
b

= Op(T φ2(kc−ke)

a

)

φ2(kr−kc−MT )
b

− φ2(kr−kc)
b

1 − φ2
b

a

)

∼a Op(T φ2(kc−ke)

T b
2cb
T b
2cb
= Op(T MT φ2(kc−ke)

∼a Op(T φ2(kc−ke)

)

a

a

φ2(kr−kc)
b

(φ−2MT
b

− 1)

φ2(kr−kc)
b

2cb

MT
T b

φ2(kr−kc)
b

),

where the second last relation holds because

φ−2MT
b

− 1 =

cb
T b

(cid:16)

1 −

(cid:18)

(cid:17)−2MT

− 1

=

1 − 2MT

−cb
T b + O

(cid:18) M 2
T
T 2b

(cid:19)(cid:19)

− 1

= 2cb

MT
T b (1 + o(1))

(B.29)

by applying (B.14). For the third term of (B.28), we have





E

kr(cid:88)





t−1
(cid:88)

kr−MT +1

j=kc+1



φ(t−j−1)
b

uj



2
 ≤ ¯ω2

kr(cid:88)

t−1
(cid:88)

kr−MT +1

j=kc+1

φ2(t−j−1)
b

= Op(T bMT ),

which is the smaller order than the ﬁrst term when a < b. Because the second term of (B.28)

is shown to be dominated by the ﬁrst term using Cauchy-Schwarz inequality, we have (B.21).

For (B.22), we have, by (B.26),

kr(cid:88)

kc+1

yt−1ut = ykc

kr(cid:88)

kc+1

φ(t−kc−1)
b

ut +

kr(cid:88)





t−1
(cid:88)

kc+1

j=kc+1



φ(t−j−1)
b

uj

 ut.

(B.30)

46

From direct calculation, we obtain

V ar





kr(cid:88)

kc+1

φ(t−kc−1)
b

ut


 ≤ ¯ω2

kr(cid:88)

kc+1

φ2(t−kc−1)
b

= O(T b),

which implies that the ﬁrst term on the right-hand side of (B.30) is (Op(T (b+1)/2φ(kc−ke)
On the other hand, the variance of the second term becomes

a

).





kr(cid:88)





t−1
(cid:88)

V ar

kc+1

j=kc+1



φ(t−j−1)
b

uj

 ut


 ≤ ¯ω4

kr(cid:88)

t−1
(cid:88)

φ2(t−j−1)
b

= ¯ω4

kc+1
kr(cid:88)

kc+1

j=kc+1
1 − φ2(t−kc−1)
b
1 − φ2
b

≤ CT b+1.

Then, the second term on the right-hand side of (B.30) is Op(T (b+1)/2) and dominated by
the ﬁrst term. We then have (B.22).

Similarly to (B.22), we have, for (B.23),

k
(cid:88)

kc+1

yt−1ut = ykc

k
(cid:88)

kc+1

φ(t−kc−1)
b

ut +

k
(cid:88)





t−1
(cid:88)

kc+1

j=kc+1



φ(t−j−1)
b

uj

 ut.

The ﬁrst term is at least Op(ykc) = Op(T 1/2φ(kc−kr)

a

) whereas, by the HRI,



P

 max

kc+1≤k≤kr

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

k
(cid:88)





t−1
(cid:88)

kc+1

j=kc+1



φ(t−j−1)
b

uj

 ut



≥ N

 ≤

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

¯ω4
N 2

kr(cid:88)

t−1
(cid:88)

kc+1

j=kc+1

φ2(t−j−1)
b

≤

C
N 2 T b+1

and thus, the ﬁrst term is dominant for all kc + 1 ≤ k ≤ kr. In addition, we have, again using
the HRI,



P

 max

kc+1≤k≤kr

k
(cid:88)

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
kc+1

φ(t−kc−1)
b

ut



≥ N

 ≤

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

≤

¯ω2
N 2

kr(cid:88)

kc+1

C
N 2 T b.

φ2(t−kc−1)
b

Then, because ykc = Op(T 1/2φ(kc−ke)

a

), we obtain (B.23).

(B.24) is proved in the same manner as (B.11).

47

(B.25) is obtained by noting that

kc+MT(cid:88)

kc+1

yt−1ut ∼a ykc

kc+MT(cid:88)

kc+1

φt−kc−1
b

ut

and by evaluating the variance of the second term.(cid:4)

Lemma 4 For kr + 1 ≤ k ≤ T ,

yT = Op(T 1/2φ(kc−ke)

a

φ(kr−kc)
b

) + Op(T 1/2).

When a < b,

T
(cid:88)

kr+1
kr+MT(cid:88)

t−1 = Op(T 2φ2(kc−ke)
y2

a

φ2(kr−kc)
b

).

t−1 = Op(T MT φ2(kc−ke)
y2

a

φ2(kr−kc)
b

).

kr+1
T
(cid:88)

yt−1ut = Op(T φ(kc−ke)

a

φ(kr−kc)
b

).

(B.31)

(B.32)

(B.33)

(B.34)

kr+1
k
(cid:88)

kr+1
T
(cid:88)

k+1

When a > b,

yt−1ut = Op(T φ(kc−ke)

a

φ(kr−kc)
b

) uniformly over kr + 1 ≤ k ≤ T .

(B.35)

yt−1ut = Op(T φ(kc−ke)

a

φ(kr−kc)
b

) uniformly over kr + 1 ≤ k ≤ T .

(B.36)

T
(cid:88)

t−1 = Op(T 2).
y2

kr+1
T
(cid:88)

yt−1ut = Op(T ).

(B.37)

(B.38)

kr+1
k
(cid:88)

kr+1

yt−1ut = Op(T ) uniformly over kr + 1 ≤ k ≤ T .

(B.39)

Proof of Lemma 4: We ﬁrst note that for kr + 1 ≤ k ≤ T ,

yk = ykr + c1

k − kr
T η1

+

k
(cid:88)

εj.

j=kr+1

48

(B.40)

In particular, we have yT = ykr + c1(T − kr)/T η1 + (cid:80)T
(B.17).

j=kr+1 εj; thus, we obtain (B.31) using

When a < b, the ﬁrst term on the right-hand side of (B.40) dominates the second and

third terms uniformly over kr + 1 ≤ k ≤ T and thus using (B.17),

T
(cid:88)

kr+1

t−1 ∼a (T − kr)y2
y2

kr = Op(T 2φ2(kc−ke)

a

kr+MT(cid:88)

t−1 ∼a MT y2
y2

kr = Op(T MT φ2(kc−ke)

a

φ2(kr−kc)
b

)

φ2(kr−kc)
b

)

and

kr+1

T
(cid:88)

kr+1

yt−1ut ∼a ykr

T
(cid:88)

kr+1

ut = Op(T φ(kc−ke)

a

φ(kr−kc)
b

).

(B.35) and (B.36) are obtained similarly by the FCLT.

When a > b,

t−1 = (T − kr)y2
y2

kr + c2
1

T
(cid:88)

kr+1

(cid:18) t − kr − 1
T η1

(cid:19)2

+

+2c1ykr

T
(cid:88)

kr+1

t − kr − 1
T η1

+ 2ykr

T
(cid:88)





kr+1

j=kr+1

j=kr+1


εj

 + 2c1

T
(cid:88)

kr+1

t − kr − 1
T η1





t−1
(cid:88)



εj



j=kr+1

= Op(T b+1) + Op(T 3−2η1) + Op(T 2) + Op(T b/2+2−η1) + Op(T (b+3)/2) + Op(T 3/2−η1)
= Op(T 2),





t−1
(cid:88)



2

εj



T
(cid:88)

kr+1

t−1
(cid:88)

T
(cid:88)

kr+1

and

yt−1ut = ykr

T
(cid:88)

ut + c1

T
(cid:88)

T
(cid:88)

kr+1

t − kr − 1
T η1

T
(cid:88)





t−1
(cid:88)



uj

 ut

ut +

kr+1

j=kr+1
= Op(T (b+1)/2) + Op(T 3/2−η1) + Op(T ) = Op(T ).

kr+1

kr+1

(B.39) is obtained similarly by the FCLT.(cid:4)

Lemma 5 Under Assumption 3, we have for a > b,

max
k∈Eb1T

max
k∈Eb2T

(cid:80)kr

k+1 yt−1ut
(cid:80)kr
k+1 y2
t−1
kr+1 yt−1ut
(cid:80)k
kr+1 y2

t−1

(cid:80)k

= op

= op

(cid:19)

(cid:19)

,

.

(cid:18) 1
T b
(cid:18) 1
T b

(B.41)

(B.42)

49

Proof of Lemma 5: We ﬁrst note that, from (B.26), we can observe that

yk ∼a φ(kc−ke)
a

φ(k−kc)
b

yke +

k
(cid:88)

φ(k−j)
b

uj =

k
(cid:88)

j=kc+1

j=kc+1

φ(k−j)
b

uj + op(1),

(B.43)

uniformly over k ∈ Eb1T because

(cid:12)
(cid:12)φ(kc−ke)
(cid:12)

a

φ(k−kc)
b

yke

(cid:12)
(cid:12) ≤ φ(kc−ke)
(cid:12)

a

φ(kr−kc)
b

√

|Op(

T )| = op(1)

max
k∈Eb1T

for a > b. Thus, to prove (B.41), it is suﬃcient to show that

max
k∈Eb1T

T b

(cid:80)kr

k+1 yt−1ut
(cid:80)kr
k+1 y2

t−1

∼a max
k∈Eb1T

1
(kr − k)

1
Tb(kr − k)

kr(cid:88)

t−1
(cid:88)

φt−j−1
b

ujut

k+1

kr(cid:88)

j=kc+1


t−1
(cid:88)



k+1

j=kc+1

2 = op(1).



(B.44)

φt−j−1
b

uj



We ﬁrst show that the denominator converges to σ2/(2cb) uniformly over k ∈ Eb1T . Note
that

kr(cid:88)





t−1
(cid:88)

k+1

j=kc+1



2

φt−j−1
b

uj



=

kr(cid:88)

t−1
(cid:88)

k+1

j=kc+1

φ2(t−j−1)
b

u2
j + 2

kr(cid:88)

t−2
(cid:88)

t−1
(cid:88)

k+1

j=kc+1

(cid:96)=j+1

φt−j−1
b

φt−(cid:96)−1
b

uju(cid:96).

(B.45)

The ﬁrst term on the right-hand side of (B.45) is further decomposed into

k
(cid:88)

kr(cid:88)

φ2(t−j−1)
b

u2
j +

kr−1
(cid:88)

kr(cid:88)

j=kc+1

t=k+1

j=k+1

t=j+1

φ2(t−j−1)
b

u2
j =: D1 + D2

(B.46)

by changing the order of the summations. Note that

φ2(k−j)
b

− φ2(kr−j)
b
1 − φ2
b

u2
j

φ2(k−j)
b
1 − φ2
b

u2
j

k
(cid:88)

j=kc+1

k
(cid:88)

j=kc+1

σ2

T b
2cb

D1 =

≤

∼a

∼a

k
(cid:88)

φ2(k−j)
b

+

k
(cid:88)


j − σ2)


(u2

φ2(k−j)
b

T b
2cb

j=kc+1


O(T b) +

j=kc+1

k
(cid:88)


j − σ2)


(u2

φ2(k−j)
b

j=kc+1

50

uniformly over k ∈ Eb1T . Because

k
(cid:88)

j=kc+1

φ2(k−j)
b

(u2

j − σ2) = φ2(k−kc)

b

k−kc(cid:88)

j(cid:48)=1

φ−2j(cid:48)
b

(u2

kc+j(cid:48) − σ2),

and φ2(k−kc)
b
of k − kc for all suﬃciently large T , we have, using the HRI,

/(kr −k) = φ2(k−kc)

b

/[(kr −kc)−(k −kc)] can be shown to be a decreasing function

φ−2j(cid:48)
b

(u2

(cid:12)
(cid:12)
(cid:12)
kc+j(cid:48) − σ2)
(cid:12)
(cid:12)
(cid:12)



≥ N



φ2(k−kc)
b
kr − k

(cid:12)
(cid:12)
k−kc(cid:88)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
φ4(kr−kc)
b
(kr − kr)2

j(cid:48)=1





kr−kc
(cid:88)

j(cid:48)=1



P

 max
k∈Eb1T

≤

≤

C
N 2

C
N 2

kr−kc−MbT(cid:88)

φ−4j(cid:48)
b +

1

(kr − kc − j(cid:48))2 φ4j(cid:48)

b φ−4j(cid:48)

b









φ4(kr−kc)
b
(kr − kr)2

1 − φ−4(kr−kc)
b
φ4
b − 1

j(cid:48)=kr−kc+1
kr−kr(cid:88)

+

l=MbT



 ≤

(cid:20)

O

C
N 2

(cid:18) 1

(cid:19)

T 2−b

+ O

(cid:18) 1
MbT

(cid:19)(cid:21)

,

1
l2

l=MbT

because kr − kc ≤ k − kc ≤ kr − kc − MbT for k ∈ Eb1T , where we used the relation of
(cid:80)M (cid:48)
1/l2 = O(1/MbT ) for M (cid:48) > MbT . Thus, the second term in the last expression of D1
divided by kr − k is op(1) uniformly over k ∈ Eb1T . Because kr − k ≥ MbT for k ∈ Eb1T , we
can observe that

max
k∈Eb1T

1
Tb(kr − k)

(cid:20)

D1 ≤

O

(cid:19)

(cid:18) T b
MbT

(cid:21)

+ op(1)

= op(1).

(B.47)

On the other hand, D2 is decomposed into

kr−1
(cid:88)

D2 =

1 − φ2(kr−j)
b
1 − φ2
b

u2
j

j=k+1

σ2(kr − k − 1) +

T b
2cb

∼a

kr−1
(cid:88)

(u2

j − σ2) − σ2

j=k+1

kr−1
(cid:88)

j=k+1

φ2(kr−j)
b

−

kr−1
(cid:88)

j=k+1

φ2(kr−j)
b


j − σ2)

 .

(u2

Clearly, the ﬁrst term in the brackets divided by kr − k goes to σ2, while the third term is
O(T b) uniformly over k ∈ Eb1T . For the second term, by applying the HRI in the reverse
order, we have



P

 max
k∈Eb1T

1
kr − k

kr−1
(cid:88)



(u2

j − σ2) ≥ N

 ≤

j=k+1





C
N 2

MbT − 1
M 2
bT

+



 ≤

1
j2

kr−kr(cid:88)

j=MbT

C
N 2

1
MbT

and thus the second term divided by kr − k uniformly converges in probability to zero.
Similarly, the fourth term in the brackets divided by kr − k is show to be op(1) uniformly by

51

applying the HRI in the reverse order. As a result,

1
T b(kr − k)

D2

p
−→

σ2
2cb

(B.48)

uniformly over k ∈ Eb1T . By (B.47) and (B.48), for the ﬁrst term on the right hand side of
(B.45), we have

1
T b(kr − k)

kr(cid:88)

t−1
(cid:88)

k+1

j=kc+1

φ2(t−j−1)
b

u2
j

p
−→

σ2
2cb

uniformly over k ∈ Eb1T .

Next, we will show that the second term on the right-hand side of (B.45) divided by
T b(kr − k) converges in probability to 0 uniformly. By changing the order of the summations,
we can observe that

kr(cid:88)

t−2
(cid:88)

t−1
(cid:88)

t=k+1

j=kc+1

(cid:96)=j+1

φt−j−1
b

φt−(cid:96)−1
b

uju(cid:96)

=

=

k−1
(cid:88)

kr(cid:88)

t−1
(cid:88)

j=kc+1

t=k+1

(cid:96)=j+1

k−1
(cid:88)

k
(cid:88)

kr(cid:88)

j=kc+1

(cid:96)=j+1

t=k+1

kr−2
(cid:88)

kr−1
(cid:88)

kr(cid:88)

+

j=k

(cid:96)=j+1

t=(cid:96)+1

φ2t−j−(cid:96)−2
b

uju(cid:96) +

kr−2
(cid:88)

kr(cid:88)

t−1
(cid:88)

φ2t−j−(cid:96)−2
b

uju(cid:96)

j=k

t=j+2

(cid:96)=j+1

k−1
(cid:88)

kr−1
(cid:88)

kr(cid:88)

j=kc+1

(cid:96)=k+1

t=(cid:96)+1

φ2t−j−(cid:96)−2
b

uju(cid:96)

φ2t−j−(cid:96)−2
b

uju(cid:96) +

φ2t−j−(cid:96)−2
b

uju(cid:96).

(B.49)

The ﬁrst term on the right-hand side of (B.49) becomes

k−1
(cid:88)

k
(cid:88)

kr(cid:88)

j=kc+1

(cid:96)=j+1

t=k+1

φ2t−j−(cid:96)−2
b

uju(cid:96)

=

∼a

k−1
(cid:88)

k
(cid:88)

(cid:96)=j+1

k
(cid:88)

j=kc+1


T b
2cb



φ2k−j−(cid:96)
b

− φ2kr−j−(cid:96)
b
1 − φ2
b

uju(cid:96)

φ2k−(cid:96)
b

u(cid:96)

(cid:96)−1
(cid:88)

φ−j
b uj −

k
(cid:88)

φkr−(cid:96)
b

u(cid:96)

(cid:96)−1
(cid:88)



φkr−j
b

uj

 ,

(B.50)

(cid:96)=kc+2

j=kc+1

(cid:96)=kc+2

j=kc+1

where the last relation is obtained by changing the order of the summations. By letting
ξ1(cid:96) := u(cid:96)
b uj, the ﬁrst term in the brackets can be expressed as

j=kc+1 φ−j

(cid:80)(cid:96)−1

k
(cid:88)

(cid:96)=kc+2

φ2k−(cid:96)
b

ξ1(cid:96) = φ2(k−kc)

b

k−kc−1
(cid:88)

(cid:96)(cid:48)=1

φkc−(cid:96)(cid:48)−1
b

ξ1kc+1+(cid:96)(cid:48).

52

Noting that φkc−(cid:96)(cid:48)−1
kr − kc − MbT for k ∈ Eb1T , we have

b

ξ1kc+(cid:96)(cid:48) forms a martingale diﬀerence sequence and that kr −kc ≤ k −kc ≤

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)








(cid:32)

P

max
k∈Eb1T

≤

≤

≤

1
N 2

C
N 2

C
N 2

φ2(k−kc)
b
kr − k

k−kc−1
(cid:88)

φkc−(cid:96)(cid:48)−1
b

ξ1kc+1+(cid:96)(cid:48)

(cid:33)

≥ N

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

(cid:96)(cid:48)=1
kr−kc−1
(cid:88)

(cid:96)(cid:48)=1

kr−kc−1
(cid:88)

φ4(kr−kc)
b
(kr − kr)2

φ4(kr−kc)
b
(kr − kr)2

φ2(kc−(cid:96)(cid:48)−1)
b

E[ξ2

kc+1+(cid:96)(cid:48)] +

kr−kc−MbT(cid:88)

(cid:96)(cid:48)=kr−kc

φ4(cid:96)(cid:48)
b

(kr − kc − (cid:96)(cid:48))2 φ2(kc−(cid:96)(cid:48)−1)

b

E[ξ2

1kc+1+(cid:96)(cid:48)]





φ2(kc−(cid:96)(cid:48)−1)
b

T bφ−2(kc+(cid:96)(cid:48)+1)

b

+

kr−kc−MbT(cid:88)

(cid:96)(cid:48)=kr−kc

φ4(cid:96)(cid:48)
b

(kr − kc − (cid:96)(cid:48))2 φ2(kc−(cid:96)(cid:48)−1)

b

T bφ−2(kc+(cid:96)(cid:48)+1)

b





(cid:20)

T 2b
(kr − kr)2 +

(cid:96)(cid:48)=1
T b
MbT

(cid:21)

= o(1),

where the ﬁrst inequality follows by the HRI by noting that φ2(k−kc)
/[(kr −
kc) − (k − kc)] is a decreasing function of k − kc for all suﬃciently large T and the second
inequality holds because E[ξ2
. This implies that the ﬁrst term
b
in the brackets in (B.50) divided by kr − k converges in probability to zero uniformly over
k ∈ Eb1T . By a similar argument, the second term divided by kr − k is shown to be op(1).
As a result, for the ﬁrst term on the right hand side of (B.49), we have

kc+1+(cid:96)(cid:48)] ≤ CT bφ−2(kc+(cid:96)(cid:48)+1)

/(kr −k) = φ2(k−kc)

b

b

1
T b(kr − k)

k−1
(cid:88)

k
(cid:88)

kr(cid:88)

j=kc+1

(cid:96)=j+1

t=k+1

φ2t−j−(cid:96)−2
b

uju(cid:96)

p
−→ 0

uniformly over k ∈ E1T .

We next investigate the second term of (B.49). Note that

k−1
(cid:88)

kr−1
(cid:88)

kr(cid:88)

j=kc+1

(cid:96)=k+1

t=(cid:96)+1

φ2t−j−(cid:96)−2
b

uju(cid:96) ∼a

Tb
2cb





k−1
(cid:88)

kr−1
(cid:88)

φ(cid:96)−j
b uju(cid:96) −

k−1
(cid:88)

kr−1
(cid:88)



φ2kr−j−(cid:96)
b

uju(cid:96)

 .

j=kc+1

(cid:96)=k+1

j=kc+1

(cid:96)=k+1

(B.51)

We ﬁrst show that the ﬁrst term on the right hand side of the brackets divided by kr − k is
uniformly op(1) outside of the T 2b neighborhood of kr, and then reﬁnement will be performed.

53

Let Mb1T → ∞ with T 2b/Mb1T → 0. Then, we can observe that

k−1
(cid:88)

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
j=kc+1

1
kr − k
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
j=kc+1

k−1
(cid:88)

1
kr − k

1
(kr − k)2 T 2b



P



max
kr+1≤k≤kr−Mb1T



P



kr−Mb1T(cid:88)

k=kr+1

C
N 2

C
N 2

kr−Mb1T(cid:88)

k=kr+1
T 2b
Mb1T

≤

≤

≤

= o(1).

kr−1
(cid:88)

(cid:96)=k+1

φ(cid:96)−j
b uju(cid:96)



≥ N



(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

kr−1
(cid:88)

(cid:96)=k+1

φ(cid:96)−j
b uju(cid:96)

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)



≥ N



(B.52)

j=kc+1 φ−j

Next, let Vk := (cid:80)k
(cid:96)=k φ(cid:96)
bu(cid:96). Because we obtained (B.52), we focus
on the rage of k given by kr − C2T 2b ≤ k ≤ kr − Mb2T for a suﬃciently large C2 where
Mb2T → ∞ and T 3b/2/Mb2T → 0. Then,

b uj and Wk = (cid:80)kr−1

k−1
(cid:88)

kr−1
(cid:88)

φ(cid:96)−j
b uju(cid:96)

j=kc+1

(cid:96)=k+1
= Vk−1Wk+1

= Vk−1(Wk+1 − Wk) + (Vk−1 − Vk−2)Wk + Vk−2Wk

k−1
(cid:88)

=

kr−C2T 2b−1

Vt(Wt+2 − Wt+1) +

k−1
(cid:88)

(Vt − Vt−1)Wt+1 + Vkr−C2T 2b−2Wkr−C2T 2b.

kr−C2T 2b−1

The ﬁrst term becomes, by noting that Wt+2 − Wt+1 = −φ(t+1)

b

k−1
(cid:88)

Vt(Wt+2 − Wt+1) = −

k−1
(cid:88)

ut+1(

ut+1,

t−1
(cid:88)

φt+1−j
b

uj)

kr−C2T 2b−1

kr−C2T 2b−1

j=kc+1

and thus by the HRI,



P



max
kr−C2T 2b≤k≤kr−Mb2T

k−1
(cid:88)

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
kr−C2T 2b−1

This implies that

Vt(Wt+2 − Wt+1)



≥ N

 ≤

C
N 2

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

kr−Mb2T(cid:88)

kr−C2T 2b−1

T b ≤

C
N 2 T 3b.

max
kr−CT 2b≤k≤kr−Mb2T

1
kr − k

k−1
(cid:88)

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
kr−CT 2b−1

Vt(Wt+2 − Wt+1)

= Op

(cid:33)

(cid:32)

T 3b/2
Mb2T

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

= op(1).

54

Similarly, because

max
kr−C2T 2b≤k≤kr−Mb2T

≤

kr−Mb2T −1
(cid:88)

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
kr−C2T 2b−1
and Vt − Vt−1 = φ−t

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

k−1
(cid:88)

(Vt − Vt−1)Wt+1

kr−C2T 2b−1

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

(Vt − Vt−1)Wt+1

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

+

max
kr−C2T 2b≤k≤kr−Mb2T

(cid:12)
kr−M2bT −1
(cid:12)
(cid:88)
(cid:12)
(cid:12)
(cid:12)

k

(Vt − Vt−1)Wt+1

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

b ut, we can show that, by using the HRI in the reverse order,

max
kr−C2T 2b≤k≤kr−Mb2T

1
kr − k

k−1
(cid:88)

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
kr−C2T 2b−1

(Vt − Vt−1)Wt+1

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

= op(1).

On the other hand, from the deﬁnitions of Vt and Wt, we can easily show that
(cid:104)(cid:0)Vkr−C2T 2b−2Wkr−C2T 2b

= O(T 2b)

(cid:1)2(cid:105)

E

and thus Wkr−C2T 2b−2Wkr−C2T 2b/MbT = op(1). Therefore, by combining these results with
(B.52), we have

max
kr+1≤k≤kr−Mb2T

1
k − kr

k−1
(cid:88)

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
j=kc+1

kr−1
(cid:88)

(cid:96)=k+1

φ(cid:96)−j
b uju(cid:96)

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

= op(1).

(B.53)

Next, we focus on the rage of k given by kr − C3T 3b/2 ≤ k ≤ kr − Mb3T for a suﬃciently
large C3, where Mb3T → ∞ and T 5b/4/Mb3T → 0. Then, by using the same argument, we can
observe that (B.53) holds with Mb2T replaced by Mb3T . By repeating the same argument, we
can observe that

max
k∈Eb2T

1
k − kr

k−1
(cid:88)

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
j=kc+1

kr−1
(cid:88)

(cid:96)=k+1

φ(cid:96)−j
b uju(cid:96)

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

= op(1).

(B.54)

where MbT → ∞ and T b+(cid:15)/MbT → 0 for a given (cid:15) > 0.

On the other hand, the order of the second term of (B.51) is shown to be op(1) because

1
kr − k
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

1
kr − k

1
(kr − k)2

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

k−1
(cid:88)

kr−1
(cid:88)

j=kc+1

(cid:96)=k+1

φ2kr−j−(cid:96)
b

uju(cid:96)

k−1
(cid:88)

kr−1
(cid:88)

φ2kr−j−(cid:96)
b

uju(cid:96)

j=kc+1

(cid:96)=k+1
φ2(kr−k+1)
b

− φ2(kr−kc)
b

1 − φ2
b



≥ N



(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)





≥ N

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
b − φ2(kr−k)
φ2
b
1 − φ2
b



P



max
kr+1≤k≤kr−MbT



P



kr−MbT(cid:88)

k=kr+1

kr−MbT(cid:88)

C
N 2

C
N 2

k=kr+1
T 2b
MbT

φ2MbT
b

≤

≤

≤

= o(1).

55

Therefore, for the second term on the right hand side of (B.49),

1
T b(kr − k)

k−1
(cid:88)

kr−1
(cid:88)

kr(cid:88)

j=kc+1

(cid:96)=k+1

t=(cid:96)+1

φ2t−j−(cid:96)−2
b

uju(cid:96)

p
−→ 0

uniformly over k ∈ E1T .

The third term on the right hand side of (B.49) becomes

kr−2
(cid:88)

kr−1
(cid:88)

kr(cid:88)

j=k

(cid:96)=j+1

t=(cid:96)+1

φ2t−j−(cid:96)−2
b

uju(cid:96)

=

∼a

kr−2
(cid:88)

kr−1
(cid:88)

(cid:96)=j+1


kr−2
(cid:88)



j=k

T b
2cb

b − φ2kr−j−(cid:96)
φ(cid:96)−j
b
1 − φ2
b

uju(cid:96)

kr−1
(cid:88)

φ(cid:96)−j
b uju(cid:96) −

kr−2
(cid:88)

kr−1
(cid:88)



φ2kr−j−(cid:96)
b

uju(cid:96)

 .

(B.55)

j=k

(cid:96)=j+1

j=k

(cid:96)=j+1

We express the ﬁrst term in the brackets as

kr−2
(cid:88)

kr−1
(cid:88)

j=k

(cid:96)=j+1

φ(cid:96)−j
b uju(cid:96) =

=:

kr−k−1
(cid:88)

t=1

kr−k−1
(cid:88)

t=1

ukr−t−1(φbukr−t + φ2

b ukr−t+1 + · · · + φt

bukr−1)

˜ξ1t.

Because ˜ξ1t is a martingale diﬀerence sequence with the ﬁltration in the reserve order and
E[ ˜ξ2

1t] ≤ CT b, by the HRI, we have

(cid:32)

P

max
MbT ≤kr−k≤kr−kr

1
kr − k

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

kr−k−1
(cid:88)

t=1

˜ξ1t

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

(cid:33)

≥ N

≤





C
N 2

1
M 2
bT

MbT −1
(cid:88)

t=1

T b +





T b
t2

kr−kr(cid:88)

t=MbT

≤ C

T b
MbT

= o(1).

A similar result can be obtained for the second term in the brackets, and thus, for the third

term on the right-hand side of (B.49),

1
T b(kr − k)

kr−2
(cid:88)

kr−1
(cid:88)

kr(cid:88)

j=k

(cid:96)=j+1

t=(cid:96)+1

φ2t−j−(cid:96)−2
b

uju(cid:96)

p
−→ 0

uniformly over k ∈ E1T . By combining these result, we can observe that the denominator of
(B.44) converges to σ2/(2cb) uniformly over k ∈ Eb1T .

56

The numerator of (B.44) is expressed as, by changing the order of the summations,

kr(cid:88)

t−1
(cid:88)

φt−j−1
b

ujut =

k
(cid:88)

kr(cid:88)

φt−j−1
b

ujut +

k+1

j=kc+1

j=kc+1

t=k+1

kr−1
(cid:88)

kr(cid:88)

j=k+1

t=j+1

φt−j−1
b

ujut.

The ﬁrst term on the right-hand side has the same structure as the ﬁrst term in the brackets

of (B.51), and we have shown (B.54). On the other hand, the second term on the right-hand

side is essentially the same as the ﬁrst term in the brackets in (B.55), which, divided by

kr − k, is op(1) uniformly. Therefore, the numerator of (B.44) is op(1) uniformly and thus we
obtain (B.44).

To prove (B.42), note that

max
k∈Eb2T

(cid:80)k

kr+1 yt−1ut
(cid:80)k
kr+1 y2

t−1

= max
k∈Eb2T

1
(k − kr)2

k
(cid:88)

yt−1ut

1
(k − kr)2

kr+1
k
(cid:88)

kr+1

.

y2
t−1

(B.56)

From (B.40), we can observe that, for a > b,

yk ∼a

k
(cid:88)

uj

j=kc+1

uniformly over k ∈ Eb2T because ykr = Op(T b/2) by (B.17) for a > b. Thus, the denominator
of (B.56) becomes

1
(k − kr)2

k
(cid:88)

kr+1

y2
t−1 ∼a

1
(k − kr)2

k−1
(cid:88)





t
(cid:88)

kr+1

j=kr+1


2

uj



=: ˜Uk ≥ 0.

The tedious but direct calculation shows that

(cid:105)

(cid:104) ˜Uk

E

=

σ2
2

+ o(1)

and E

(cid:105)

(cid:104) ˜U 2

k

≤ C < ∞,

(B.57)

where the o(1) term is uniform over k ∈ Eb2T . In this case, the following relation holds:

min
k∈Eb2T

˜Uk ≥ Op(1).

(B.58)

To prove this, we use the contradiction argument. Suppose that (B.58) does not hold. Then,
there exists ˜k ∈ Eb2T such that ˜U˜k
−→ 0. This implies that, because ˜U˜k is uniformly
integrable by (B.57),

p

lim
T →∞

E[ ˜U˜k] = E

lim
T →∞

˜U˜k

(cid:21)

= 0,

(cid:20)

57

which contradicts E[ ˜U˜k] = σ2/2 + o(1) > 0. Thus, (B.58) must hold. This implies that

1
˜Uk

≤ Op(1)

(B.59)

uniformly over k ∈ Eb2T . We next investigate the numerator of (B.56). Note that

1
(k − kr)2

k
(cid:88)

kr+1

yt−1ut ∼a

1
2(k − kr)2

From (B.40), we have


y2

k − y2

kr −



u2
t

 .

k
(cid:88)

kr+1

1
k − kr

yk =

1
k − kr

ykr +

c1
T η1

+

1
k − kr

k
(cid:88)

εj.

j=kr+1

By noting that for a > b,

max
k∈Eb2T

1
k − kr

|ykr | ≤ Op

(cid:33)

(cid:32)

T b/2
MbT

= op

(cid:18) 1
T b/2

(cid:19)

,

c1/T η1 = o(1/T b/2) because 0 < b < 1 and η > 1/2, and



P

 max
k∈Eb2T

1
k − kr

k
(cid:88)

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
kr+1

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

εt



≥ N

 ≤





C
N 2

1
M 2
bT

MbT(cid:88)

1

σ2 +





σ2
t2

T −kr(cid:88)

MbT +1

we can observe that

≤

C
N 2

1
MbT

,

max
k∈Eb2T

1
k − kr

|yk| = op

(cid:18) 1
T b/2

(cid:19)

.

Thus, (B.56) is bounded by

sup
k∈E2T

Therefore, we obtain (B.42)(cid:4).

1
(k−kr)2

1
(k−kr)2

(cid:80)k

kr+1 yt−1ut
(cid:80)k
kr+1 y2

t−1

≤ op

(cid:19)

.

(cid:18) 1
T b

58

C. Proofs in the Serially Correlated Case

In this appendix, we ﬁrst show that Lemmas 1–4 hold for model (8) under Assumption 4. As

a result, we obtain the same result as Theorem 1.

It is well known in the econometric literature that Lemma 1 holds for a linear process

with (B.1) replaced by

and we omit the details.

1
√
T

yke ⇒ ψW (τe)

To prove (B.6) in Lemma 2, from (B.13) it is suﬃcient to prove that

k−ke(cid:88)

j(cid:48)=1

φ−j(cid:48)
a uke+j(cid:48) =

k−ke(cid:88)

j(cid:48)=1

φ−j(cid:48)
a εke+j(cid:48)

k−ke(cid:88)

= ψ

φ−j(cid:48)
a vke+j(cid:48) +

j(cid:48)=1
= op(T 1/2).

k−ke(cid:88)

j(cid:48)=1

φ−j(cid:48)
a

(˜vke+j(cid:48)−1 − ˜vke+j(cid:48))

(C.1)

(C.2)

The ﬁrst term of (C.1) is Op(T a/2) uniformly as proved in (B.6), while the second term can
be expanded as
k−ke(cid:88)

k−ke−1
(cid:88)

φ−j(cid:48)
a

(˜vke+j(cid:48)−1 − ˜vke+j(cid:48)) = φ−1

a ˜vke +

(φ−j(cid:48)−1
a

− φ−j(cid:48)
a

)˜vke+j(cid:48) − φ−(k−ke)

a

˜vk.

j(cid:48)=1

j(cid:48)=1

The ﬁrst term is Op(1) while the third terms are op(T a/2) because φ−(k−ke)
< 1 and maxk |˜vk| =
op(T a/2) as proved in Proposition A3 in Phillips and Magdalinos (2007). Similarly, the second
term is

a

(cid:12)
(cid:12)
k−ke−1
(cid:88)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

j(cid:48)=1

(φ−j(cid:48)−1
a

− φ−j(cid:48)
a

)˜vke+j(cid:48)

≤

φ−j(cid:48)−1
a

max
k

|˜vk|

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

k−ke−1
(cid:88)

ca
T a

j(cid:48)=1
= op(T a/2).

Thus, we obtain (C.2).

(B.7) and (B.8) follow because (B.6) holds.

For (B.10), we note that

k
(cid:88)

ke+1

yt−1ut ∼a yke

= yke

φ(t−ke−1)
a

ut

k
(cid:88)

ke+1



ψ

k
(cid:88)



ke+1

φ(t−ke−1)
a

vt +

k
(cid:88)

ke+1

φ(t−ke−1)
a

59

(˜vt−1 − ˜vt)






.

(C.3)

The ﬁrst term in the parentheses is Op(T a/2φ(kc−ke)
whereas the second term of (C.3) becomes

a

) uniformly as proved in Appendix B,

k
(cid:88)

ke+1

φ(t−ke−1)
a

(˜vt−1 − ˜vt) = ˜vke +

ca
T a

k−1
(cid:88)

ke+1

φ(t−ke−1)
a

˜vt − φ(k−ke−1)
a

˜vk.

Because maxt |˜vt| = op(T a/2), we can see that the second term of (C.3) is op(T a/2φ(kc−ke)
uniformly and thus (B.10) holds.

a

)

(B.9), (B.11), and (B.12) can be proved similarly and we omit the details.

In exactly the same manner, Lemmas 3 and 4 hold for the model with serially correlated

shocks using the BN decomposition given by (9).

Theorem 2 in the serially correlate case is obtained in Pang et al. (2018).
For the proof of ˆkr, let k = kr + vT b for a given v and we proceed with the proof in the
same way as Theorem 3 but we need to deal with the serially correlated shocks carefully.

First, consider the case where v < 0 with (A.25). Using (9), it can be shown that ΛT (k/T )
is op(1) and that (A.36) holds, whereas we need to modify (A.37) and (A.38). Note that

yk = φ(k−ke)

b

ykc +

k
(cid:88)

j=kc+1

φ(k−j)
b

(ψvj + ˜vj−1 − ˜vj)

∼a ψ

= ψ

k
(cid:88)

j=kc+1

k
(cid:88)

j=kc+1

φ(k−j)
b

vj +

k
(cid:88)

j=kc+1

φ(k−j)
b

(˜vj−1 − ˜vj)

φ(k−j)
b

vj + φ(k−kc−1)
b

˜vkc + (1 − φb)

k−1
(cid:88)

j=kc+1

φ(k−j−1)
b

˜vj − ˜vk.

(C.4)

Then, we have

1
T b

kr(cid:88)

k+1

yt−1ut ∼a

ψ
T b

kr(cid:88)





t−1
(cid:88)



φ(t−1−j)
b

vj

 (ψvt + ˜vt−1 − ˜vt)

kr−|v|T b+1
kr(cid:88)

+˜vkc

1
T b

j=kc+1

φ(t−2−kc)
b

(ψvt + ˜vt−1 − ˜vt)



φ(t−2−j)
b

˜vj

 (ψvt + ˜vt−1 − ˜vt)

t−2
(cid:88)

j=kc+1

˜vt−1 (ψvt + ˜vt−1 − ˜vt)

kr−|v|T b+1

kr(cid:88)

cb
T b



kr−|v|T b+1
kr(cid:88)

+

1
T b

−

1
T b

kr−|v|T b+1
I + II + III + IV.

=:

60

For I, we have, as derived in the proof of Theorem 3,

ψ
T b

kr(cid:88)





t−1
(cid:88)

φ(t−1−j)
b

vj


 ψvt ⇒ σ2ψ2

(cid:90) |v|

0

˜Bcb(s)dB1(s),

kr−|v|T b+1
while, by letting Gt := (cid:80)t
j=kc+1 φt−j


j=kc+1

b vj,



ψ
T b

kr(cid:88)

t−1
(cid:88)



kr−|v|T b+1

j=kc+1

φ(t−1−j)
b

vj

 (˜vt−1 − ˜vt)

=

=

ψ
T b

ψ
T b

kr(cid:88)

Gt−1(˜vt−1 − ˜vt)

kr−|v|T b+1





Gkr−|v|T b ˜vkr−|v|T b +

kr−1
(cid:88)

(Gt − Gt−1)˜vt + Gkr−1˜vkr

kr−|v|T b+1






.

Because Gt − Gt−1 = vt − (cb/T b) (cid:80)t−1
j=kc+1 φt−1−j
that the ﬁrst and third terms in the curly braces are op(T b), we have, by the WLLN,

vj = vt + Op(1/T b/2) while it can be shown

b

ψ
T b

kr(cid:88)

kr−|v|T b+1

Gt−1(˜vt−1 − ˜vt) =

ψ
T b

kr(cid:88)

kr−|v|T b+1

vt˜vt + op(1)

p
−→ σ2ψ ˜ψ0|v|.

These results yield

I ⇒ σ2ψ2

(cid:90) |v|

0

˜Bcb(s)dB1(s) + σ2ψ ˜ψ0|v|.

Similarly, it can be shown that II and III are op(1). For IV , we have, by the WLLN,

IV

p

−→ −|v|(E[˜v2

t−1] − E[˜vt−1˜vt]) = −σ2|v|

These results imply that

(cid:80)T

(cid:80)kr

kr+1 y2
t−1
(cid:80)T
k+1 y2

t−1

k+1 yt−1ut

= −

2cb
T b





∞
(cid:88)

j=0

˜ψ2

j −

∞
(cid:88)

j=0



˜ψj ˜ψj+1

 .

kr(cid:88)

yt−1ut(1 + op(1))

kr−|v|T b+1
(cid:32)

(cid:90) |v|

⇒ −σ2ψ2cb

2

˜Bcb(s)dB1(s) +

(cid:33)

,

ˇψ|v|
2

0

−2(1 − φb)

where


ψ ˜ψ0 −

ˇψ :=

4
ψ2

∞
(cid:88)

j=0

˜ψ2

j +

∞
(cid:88)

j=0



˜ψj ˜ψj+1

 .

(C.5)

61

Similarly, it is shown using (C.4) that

(1 − φb)2

(cid:80)T

kr+1 y2
(cid:80)T

t−1
k+1 y2

t−1

(cid:80)kr

k+1 y2

t−1

=

c2
b
T 2b

kr(cid:88)

y2
t−1(1 + op(1))

kr−|v|T b+1
(cid:40)

(cid:90) |v|

⇒ σ2ψ2cb

cb

(cid:18)

˜B2
cb

(s) −

(cid:19)

1
2cb

ds +

(cid:41)

.

|v|
2

These results yield

0

SSR2(k/T ) − SSR2(τr)
(cid:90) |v|

⇒ −σ2ψ2cb

(cid:32)
2

0

˜Bcb(s)dB1(s) − cb

(cid:90) |v|

0

(cid:18)

˜B2
cb

(s) −

(cid:19)

1
2cb

ds −

(cid:33)

(1 − ˇψ)|v|
2

for v < 0. We obtain the result in the theorem by deﬁning ψ∗ := 1 − ˇψ.

For k = kr + vT b with v > 0, it can be shown in expression (A.28) that ΛT (k/T ) is
op(1) and that (A.42) holds, whereas we need to modify (A.41) and (A.43). Note that
uk = c1/T η1 + ψvk + ˜vk−1 − ˜vk and that

yk−1 = ykr + c1

k − kr − 1
T η1

+ ψ

k−1
(cid:88)

j=kr+1

vj + ˜vkr − ˜vk−1.

Then, it can be shown that

2(1 − φb)

=

=

2cb
T b

cb
T b

(cid:80)k

kr+1 yt−1ut
(cid:80)k

kc+1 y2

t−1

(cid:80)kr

kc+1 y2

t−1

kr+vT b
(cid:88)

yt−1ut(1 + op(1))

kr+1


y2

kr+vT b − y2

kr −



u2
t

 (1 + op(1))

kr+vT b
(cid:88)

kr+1

⇒ cb



σ2ψ2 (cid:16) ˜Bcb(0) + B2(v)


(cid:17)2

− σ2ψ2 ˜B2
cb

(0) − vσ2

∞
(cid:88)

ψ2
j




= 2σ2ψ2c2
b

(cid:40)

1
cb

(cid:90) v

0

(cid:17)
(cid:16) ˜Bcb(0) + B2(s)

dB2(s) +

On the other hand, we can observe that

j=0
(cid:32)

1 −

v
2cb


(cid:80)∞
j=0 ψ2
j
ψ2

(cid:33)(cid:41)

.

(1 − φb)2

(cid:80)k

kr+1 y2
(cid:80)k

(cid:80)kr

kc+1 y2

t−1

t−1
kc+1 y2

t−1

=

c2
b
T 2b

kr+vT b
(cid:88)

y2
t−1(1 + op(1))

⇒ σ2ψ2c2
b

(cid:16) ˜Bcb(0) + B2(s)

(cid:17)2

ds.

kr+1
(cid:90) v

0

62

Combining these results, we have

SSR2(k/T ) − SSR2(τr) ⇒ −2σ2ψ2c2
b

˜B2
cb

(0)

C∗
cb

(v) −

(cid:40)

(cid:32)

1 +

v
2

(cid:33)(cid:41)

1 − (cid:80)∞
cb ˜B2
cb

j=0 ψ2
(0)

j /ψ

for v ≥ 0. By deﬁning ψ∗ := 1 + (1 − (cid:80)∞

j=0 ψ2

j /ψ2)/(cb ˜B2
cb

(0)), we obtain the result.(cid:4)

63

D. Additional Figures

(a) T = 400, φa = 1.01, φb = 0.96

(b) T = 800, φa = 1.01, φb = 0.96

(c) T = 400, φa = 1.05, φb = 0.96

(d) T = 800, φa = 1.05, φb = 0.96

(e) T = 400, φa = 1.09, φb = 0.96

(f) T = 800, φa = 1.09, φb = 0.96

Figure D.1: Histograms of ˆkc for (τe, τc, τr) = (0.5, 0.55, 0.6)

64

0.000.020.040.060.080.00.10.20.30.40.50.60.70.80.91.00.000.050.100.150.200.00.10.20.30.40.50.60.70.80.91.00.00.10.20.30.40.50.00.10.20.30.40.50.60.70.80.91.00.00.20.40.60.80.00.10.20.30.40.50.60.70.80.91.00.00.20.40.60.80.00.10.20.30.40.50.60.70.80.91.00.000.250.500.751.000.00.10.20.30.40.50.60.70.80.91.0(a) T = 400, φa = 1.05, φb = 0.98

(b) T = 800, φa = 1.05, φb = 0.98

(c) T = 400, φa = 1.05, φb = 0.96

(d) T = 800, φa = 1.05, φb = 0.96

(e) T = 400, φa = 1.05, φb = 0.94

(f) T = 800, φa = 1.05, φb = 0.94

Figure D.2: Histograms of ˆkc for (τe, τc, τr) = (0.5, 0.55, 0.6)

65

0.00.10.20.30.40.00.10.20.30.40.50.60.70.80.91.00.00.20.40.60.80.00.10.20.30.40.50.60.70.80.91.00.00.10.20.30.40.50.00.10.20.30.40.50.60.70.80.91.00.00.20.40.60.80.00.10.20.30.40.50.60.70.80.91.00.00.20.40.00.10.20.30.40.50.60.70.80.91.00.00.20.40.60.80.00.10.20.30.40.50.60.70.80.91.0(a) T = 400, φa = 1.01, φb = 0.96

(b) T = 800, φa = 1.01, φb = 0.96

(c) T = 400, φa = 1.05, φb = 0.96

(d) T = 800, φa = 1.05, φb = 0.96

(e) T = 400, φa = 1.09, φb = 0.96

(f) T = 800, φa = 1.09, φb = 0.96

Figure D.3: Histograms of ˆkr for (τe, τc, τr) = (0.5, 0.55, 0.6)

66

0.000.010.020.030.040.00.10.20.30.40.50.60.70.80.91.00.000.020.040.060.00.10.20.30.40.50.60.70.80.91.00.000.050.100.150.200.00.10.20.30.40.50.60.70.80.91.00.00.10.20.30.40.00.10.20.30.40.50.60.70.80.91.00.00.10.20.30.40.50.00.10.20.30.40.50.60.70.80.91.00.00.20.40.60.80.00.10.20.30.40.50.60.70.80.91.0(a) T = 400, φa = 1.05, φb = 0.98

(b) T = 800, φa = 1.05, φb = 0.98

(c) T = 400, φa = 1.05, φb = 0.96

(d) T = 800, φa = 1.05, φb = 0.96

(e) T = 400, φa = 1.05, φb = 0.94

(f) T = 800, φa = 1.05, φb = 0.94

Figure D.4: Histograms of ˆkr for (τe, τc, τr) = (0.5, 0.55, 0.6)

67

0.000.050.100.150.00.10.20.30.40.50.60.70.80.91.00.00.10.20.30.40.00.10.20.30.40.50.60.70.80.91.00.000.050.100.150.200.00.10.20.30.40.50.60.70.80.91.00.00.10.20.30.40.00.10.20.30.40.50.60.70.80.91.00.000.050.100.150.200.250.00.10.20.30.40.50.60.70.80.91.00.00.10.20.30.00.10.20.30.40.50.60.70.80.91.0(a) T = 400, φa = 1.01, φb = 0.96

(b) T = 800, φa = 1.01, φb = 0.96

(c) T = 400, φa = 1.05, φb = 0.96

(d) T = 800, φa = 1.05, φb = 0.96

(e) T = 400, φa = 1.09, φb = 0.96

(f) T = 800, φa = 1.09, φb = 0.96

Figure D.5: Histograms of ˆkc for (τe, τc, τr) = (0.4, 0.6, 0.7) with 1% trimming

68

0.00.10.20.00.10.20.30.40.50.60.70.80.91.00.00.20.40.60.00.10.20.30.40.50.60.70.80.91.00.000.250.500.751.000.00.10.20.30.40.50.60.70.80.91.00.000.250.500.751.000.00.10.20.30.40.50.60.70.80.91.00.000.250.500.751.000.00.10.20.30.40.50.60.70.80.91.00.000.250.500.751.000.00.10.20.30.40.50.60.70.80.91.0(a) T = 400, φa = 1.05, φb = 0.98

(b) T = 800, φa = 1.05, φb = 0.98

(c) T = 400, φa = 1.05, φb = 0.96

(d) T = 800, φa = 1.05, φb = 0.96

(e) T = 400, φa = 1.05, φb = 0.94

(f) T = 800, φa = 1.05, φb = 0.94

Figure D.6: Histograms of ˆkc for (τe, τc, τr) = (0.4, 0.6, 0.7) with 1% trimming

69

0.000.250.500.751.000.00.10.20.30.40.50.60.70.80.91.00.000.250.500.751.000.00.10.20.30.40.50.60.70.80.91.00.000.250.500.751.000.00.10.20.30.40.50.60.70.80.91.00.000.250.500.751.000.00.10.20.30.40.50.60.70.80.91.00.000.250.500.751.000.00.10.20.30.40.50.60.70.80.91.00.000.250.500.751.000.00.10.20.30.40.50.60.70.80.91.0(a) T = 400, φa = 1.01, φb = 0.96

(b) T = 800, φa = 1.01, φb = 0.96

(c) T = 400, φa = 1.05, φb = 0.96

(d) T = 800, φa = 1.05, φb = 0.96

(e) T = 400, φa = 1.09, φb = 0.96

(f) T = 800, φa = 1.09, φb = 0.96

Figure D.7: Histograms of ˆkr for (τe, τc, τr) = (0.4, 0.6, 0.7) with 1% trimming

70

0.000.010.020.030.00.10.20.30.40.50.60.70.80.91.00.0000.0050.0100.00.10.20.30.40.50.60.70.80.91.00.00.20.40.60.00.10.20.30.40.50.60.70.80.91.00.000.250.500.751.000.00.10.20.30.40.50.60.70.80.91.00.000.250.500.751.000.00.10.20.30.40.50.60.70.80.91.00.000.250.500.751.000.00.10.20.30.40.50.60.70.80.91.0(a) T = 400, φa = 1.05, φb = 0.98

(b) T = 800, φa = 1.05, φb = 0.98

(c) T = 400, φa = 1.05, φb = 0.96

(d) T = 800, φa = 1.05, φb = 0.96

(e) T = 400, φa = 1.05, φb = 0.94

(f) T = 800, φa = 1.05, φb = 0.94

Figure D.8: Histograms of ˆkr for (τe, τc, τr) = (0.4, 0.6, 0.7) with 1% trimming

71

0.00.20.40.60.80.00.10.20.30.40.50.60.70.80.91.00.000.250.500.751.000.00.10.20.30.40.50.60.70.80.91.00.00.20.40.60.00.10.20.30.40.50.60.70.80.91.00.000.250.500.751.000.00.10.20.30.40.50.60.70.80.91.00.00.20.40.60.00.10.20.30.40.50.60.70.80.91.00.000.250.500.750.00.10.20.30.40.50.60.70.80.91.0(a) T = 400, φa = 1.01, φb = 0.96

(b) T = 800, φa = 1.01, φb = 0.96

(c) T = 400, φa = 1.05, φb = 0.96

(d) T = 800, φa = 1.05, φb = 0.96

(e) T = 400, φa = 1.09, φb = 0.96

(f) T = 800, φa = 1.09, φb = 0.96

Figure D.9: Histograms of ˆkc for (τe, τc, τr) = (0.4, 0.6, 0.7) with σ1/σ0 = 1/3

72

0.00.20.40.00.10.20.30.40.50.60.70.80.91.00.00.20.40.60.80.00.10.20.30.40.50.60.70.80.91.00.000.250.500.751.000.00.10.20.30.40.50.60.70.80.91.00.000.250.500.751.000.00.10.20.30.40.50.60.70.80.91.00.000.250.500.751.000.00.10.20.30.40.50.60.70.80.91.00.000.250.500.751.000.00.10.20.30.40.50.60.70.80.91.0(a) T = 400, φa = 1.05, φb = 0.98

(b) T = 800, φa = 1.05, φb = 0.98

(c) T = 400, φa = 1.05, φb = 0.96

(d) T = 800, φa = 1.05, φb = 0.96

(e) T = 400, φa = 1.05, φb = 0.94

(f) T = 800, φa = 1.05, φb = 0.94

Figure D.10: Histograms of ˆkc for (τe, τc, τr) = (0.4, 0.6, 0.7) with σ1/σ0 = 1/3

73

0.000.250.500.751.000.00.10.20.30.40.50.60.70.80.91.00.000.250.500.751.000.00.10.20.30.40.50.60.70.80.91.00.000.250.500.751.000.00.10.20.30.40.50.60.70.80.91.00.000.250.500.751.000.00.10.20.30.40.50.60.70.80.91.00.000.250.500.751.000.00.10.20.30.40.50.60.70.80.91.00.000.250.500.751.000.00.10.20.30.40.50.60.70.80.91.0(a) T = 400, φa = 1.01, φb = 0.96

(b) T = 800, φa = 1.01, φb = 0.96

(c) T = 400, φa = 1.05, φb = 0.96

(d) T = 800, φa = 1.05, φb = 0.96

(e) T = 400, φa = 1.09, φb = 0.96

(f) T = 800, φa = 1.09, φb = 0.96

Figure D.11: Histograms of ˆkr for (τe, τc, τr) = (0.4, 0.6, 0.7) with σ1/σ0 = 1/3

74

0.000.050.100.00.10.20.30.40.50.60.70.80.91.00.000.020.040.060.00.10.20.30.40.50.60.70.80.91.00.000.250.500.750.00.10.20.30.40.50.60.70.80.91.00.000.250.500.751.000.00.10.20.30.40.50.60.70.80.91.00.000.250.500.751.000.00.10.20.30.40.50.60.70.80.91.00.000.250.500.751.000.00.10.20.30.40.50.60.70.80.91.0(a) T = 400, φa = 1.05, φb = 0.98

(b) T = 800, φa = 1.05, φb = 0.98

(c) T = 400, φa = 1.05, φb = 0.96

(d) T = 800, φa = 1.05, φb = 0.96

(e) T = 400, φa = 1.05, φb = 0.94

(f) T = 800, φa = 1.05, φb = 0.94

Figure D.12: Histograms of ˆkr for (τe, τc, τr) = (0.4, 0.6, 0.7) with σ1/σ0 = 1/3

75

0.000.250.500.750.00.10.20.30.40.50.60.70.80.91.00.000.250.500.751.000.00.10.20.30.40.50.60.70.80.91.00.000.250.500.750.00.10.20.30.40.50.60.70.80.91.00.000.250.500.751.000.00.10.20.30.40.50.60.70.80.91.00.000.250.500.750.00.10.20.30.40.50.60.70.80.91.00.000.250.500.751.000.00.10.20.30.40.50.60.70.80.91.0(a) T = 400, φa = 1.01, φb = 0.96

(b) T = 800, φa = 1.01, φb = 0.96

(c) T = 400, φa = 1.05, φb = 0.96

(d) T = 800, φa = 1.05, φb = 0.96

(e) T = 400, φa = 1.09, φb = 0.96

(f) T = 800, φa = 1.09, φb = 0.96

Figure D.13: Histograms of ˆkc for (τe, τc, τr) = (0.4, 0.6, 0.7) with σ1/σ0 = 3

76

0.000.020.040.060.00.10.20.30.40.50.60.70.80.91.00.00.10.20.30.00.10.20.30.40.50.60.70.80.91.00.000.250.500.750.00.10.20.30.40.50.60.70.80.91.00.000.250.500.751.000.00.10.20.30.40.50.60.70.80.91.00.000.250.500.751.000.00.10.20.30.40.50.60.70.80.91.00.000.250.500.751.000.00.10.20.30.40.50.60.70.80.91.0(a) T = 400, φa = 1.05, φb = 0.98

(b) T = 800, φa = 1.05, φb = 0.98

(c) T = 400, φa = 1.05, φb = 0.96

(d) T = 800, φa = 1.05, φb = 0.96

(e) T = 400, φa = 1.05, φb = 0.94

(f) T = 800, φa = 1.05, φb = 0.94

Figure D.14: Histograms of ˆkc for (τe, τc, τr) = (0.4, 0.6, 0.7) with σ1/σ0 = 3

77

0.000.250.500.750.00.10.20.30.40.50.60.70.80.91.00.000.250.500.751.000.00.10.20.30.40.50.60.70.80.91.00.000.250.500.750.00.10.20.30.40.50.60.70.80.91.00.000.250.500.751.000.00.10.20.30.40.50.60.70.80.91.00.000.250.500.750.00.10.20.30.40.50.60.70.80.91.00.000.250.500.751.000.00.10.20.30.40.50.60.70.80.91.0(a) T = 400, φa = 1.01, φb = 0.96

(b) T = 800, φa = 1.01, φb = 0.96

(c) T = 400, φa = 1.05, φb = 0.96

(d) T = 800, φa = 1.05, φb = 0.96

(e) T = 400, φa = 1.09, φb = 0.96

(f) T = 800, φa = 1.09, φb = 0.96

Figure D.15: Histograms of ˆkr for (τe, τc, τr) = (0.4, 0.6, 0.7) with σ1/σ0 = 3

78

0.000.020.040.0601002003004000.000.010.020.030.00.10.20.30.40.50.60.70.80.91.00.00.10.20.30.40.00.10.20.30.40.50.60.70.80.91.00.000.250.500.750.00.10.20.30.40.50.60.70.80.91.00.000.250.500.751.000.00.10.20.30.40.50.60.70.80.91.00.000.250.500.751.000.00.10.20.30.40.50.60.70.80.91.0(a) T = 400, φa = 1.05, φb = 0.98

(b) T = 800, φa = 1.05, φb = 0.98

(c) T = 400, φa = 1.05, φb = 0.96

(d) T = 800, φa = 1.05, φb = 0.96

(e) T = 400, φa = 1.05, φb = 0.94

(f) T = 800, φa = 1.05, φb = 0.94

Figure D.16: Histograms of ˆkr for (τe, τc, τr) = (0.4, 0.6, 0.7) with σ1/σ0 = 3

79

0.00.10.20.30.40.00.10.20.30.40.50.60.70.80.91.00.000.250.500.751.000.00.10.20.30.40.50.60.70.80.91.00.00.10.20.30.40.00.10.20.30.40.50.60.70.80.91.00.000.250.500.750.00.10.20.30.40.50.60.70.80.91.00.000.050.100.150.200.250.00.10.20.30.40.50.60.70.80.91.00.00.20.40.60.80.00.10.20.30.40.50.60.70.80.91.0(a) T = 400, φa = 1.01, φb = 0.96

(b) T = 800, φa = 1.01, φb = 0.96

(c) T = 400, φa = 1.05, φb = 0.96

(d) T = 800, φa = 1.05, φb = 0.96

(e) T = 400, φa = 1.09, φb = 0.96

(f) T = 800, φa = 1.09, φb = 0.96

Figure 1: Histograms of ˆkc for (τe, τc, τr) = (0.4, 0.6, 0.7)

80

0.00.10.20.00.10.20.30.40.50.60.70.80.91.00.00.20.40.60.00.10.20.30.40.50.60.70.80.91.00.000.250.500.751.000.00.10.20.30.40.50.60.70.80.91.00.000.250.500.751.000.00.10.20.30.40.50.60.70.80.91.00.000.250.500.751.000.00.10.20.30.40.50.60.70.80.91.00.000.250.500.751.000.00.10.20.30.40.50.60.70.80.91.0(a) T = 400, φa = 1.05, φb = 0.98

(b) T = 800, φa = 1.05, φb = 0.98

(c) T = 400, φa = 1.05, φb = 0.96

(d) T = 800, φa = 1.05, φb = 0.96

(e) T = 400, φa = 1.05, φb = 0.94

(f) T = 800, φa = 1.05, φb = 0.94

Figure 2: Histograms of ˆkc for (τe, τc, τr) = (0.4, 0.6, 0.7)

81

0.000.250.500.751.000.00.10.20.30.40.50.60.70.80.91.00.000.250.500.751.000.00.10.20.30.40.50.60.70.80.91.00.000.250.500.751.000.00.10.20.30.40.50.60.70.80.91.00.000.250.500.751.000.00.10.20.30.40.50.60.70.80.91.00.000.250.500.751.000.00.10.20.30.40.50.60.70.80.91.00.000.250.500.751.000.00.10.20.30.40.50.60.70.80.91.0(a) T = 400, φa = 1.01, φb = 0.96

(b) T = 800, φa = 1.01, φb = 0.96

(c) T = 400, φa = 1.05, φb = 0.96

(d) T = 800, φa = 1.05, φb = 0.96

(e) T = 400, φa = 1.09, φb = 0.96

(f) T = 800, φa = 1.09, φb = 0.96

Figure 3: Histograms of ˆkr for (τe, τc, τr) = (0.4, 0.6, 0.7)

82

0.000.010.020.030.00.10.20.30.40.50.60.70.80.91.00.0000.0050.0100.0150.00.10.20.30.40.50.60.70.80.91.00.00.20.40.60.00.10.20.30.40.50.60.70.80.91.00.000.250.500.751.000.00.10.20.30.40.50.60.70.80.91.00.000.250.500.751.000.00.10.20.30.40.50.60.70.80.91.00.000.250.500.751.000.00.10.20.30.40.50.60.70.80.91.0(a) T = 400, φa = 1.05, φb = 0.98

(b) T = 800, φa = 1.05, φb = 0.98

(c) T = 400, φa = 1.05, φb = 0.96

(d) T = 800, φa = 1.05, φb = 0.96

(e) T = 400, φa = 1.05, φb = 0.94

(f) T = 800, φa = 1.05, φb = 0.94

Figure 4: Histograms of ˆkr for (τe, τc, τr) = (0.4, 0.6, 0.7)

83

0.00.20.40.60.80.00.10.20.30.40.50.60.70.80.91.00.000.250.500.751.000.00.10.20.30.40.50.60.70.80.91.00.00.20.40.60.00.10.20.30.40.50.60.70.80.91.00.000.250.500.751.000.00.10.20.30.40.50.60.70.80.91.00.00.20.40.60.00.10.20.30.40.50.60.70.80.91.00.000.250.500.750.00.10.20.30.40.50.60.70.80.91.0Figure 5: The bubble origination, collapse and recovery dates of the NASDAQ vomposite

index

84

Figure 6: The bubble origination, collapse and recovery dates of U.S. house price index

85

