Free energy calculations along entropic pathways: I.

Homogeneous vapor-liquid nucleation for atomic and molecular

systems.

Caroline Desgranges and Jerome Delhommelle

Department of Chemistry, University of North Dakota, Grand Forks ND 58202

(Dated: March 1, 2022)

Abstract

Using the entropy S as a reaction coordinate, we determine the free energy barrier associated

with the formation of a liquid droplet from a supersaturated vapor for atomic and molecular ﬂuids.

For this purpose, we develop the µV T − S simulation method that combines the advantages of the

grand-canonical ensemble, that allows for a direct evaluation of the entropy, and of the umbrella

sampling method, that is well suited to the study of an activated process like nucleation. Applying

this approach to an atomic system such as Ar allows us to test the method. The results show that

the µV T − S method gives the correct dependence on supersaturation of the height of the free

energy barrier and of the size of the critical droplet, when compared to predictions from classical

nucleation theory and to previous simulation results.

In addition, it provides insight into the

relation between entropy and droplet formation throughout this process. An additional advantage

of the µV T − S approach is its direct transferability to molecular systems, since it uses the entropy

of the system as the reaction coordinate. Applications of the µV T − S simulation method to N2

and CO2 are presented and discussed in this work, showing the versatility of the µV T −S approach.

1
2
0
2

g
u
A
3
2

]
h
c
e
m

-
t
a
t
s
.
t
a
m
-
d
n
o
c
[

1
v
8
6
3
0
1
.

8
0
1
2
:
v
i
X
r
a

1

 
 
 
 
 
 
I.

INTRODUCTION

In recent years, computer simulations have considerably advanced our knowledge on phase

transitions and molecular assembly processes by shedding light on the microscopic mecha-

nisms underlying these phenomena1–34. Simulations have allowed to identify key parameters

for these activated processes, which allow to measure and analyze the progress of the system

towards the formation of a new phase. These parameters, which are often complex func-

tions of e.g. the coordinates of the atoms or of some features of their collective behavior, are

known as order parameters or reaction coordinates (RCs)35–47. RCs are generally tailored

to a type of system or to a type of phenomenon under study. This is the case, for instance,

for vapor-liquid nucleation, a process of great interest for many applications such as for

atmospheric nucleation. Possible choices of RCs are e. g. the radius of the incipient droplet

or its size (in terms of numbers of atoms within the droplet)35,48–53, and the analysis of the

underlying pathway is generally made through the determination of the free energy barrier

of nucleation and of the critical size of the nucleus beyond which spontaneous growth occurs.

The entropy of the system S is an especially appealing choice for a RC since it is, by

deﬁnition, directly connected to the onset of order (i.e. S decreases as order increases).

It also has the additional advantage of being very general and, as such, can be used for

a wide range of systems and phenomena, regardless of the geometry, structure and phases

involved. In the ﬁrst part of this series, our goal is to establish the use of S as a RC for the

homogeneous vapor-liquid nucleation of atomic and molecular systems. For this purpose,

we develop a simulation method that allows to vary the entropy of the system and, as a

result, to drive the formation of the liquid droplet. We then calculate the free energy barrier

associated with this process. The simulations carried out in this work therefore allow us

to identify the entropic pathway underlying the nucleation process, which starts with the

metastable supersaturated vapor and ends at the top of the free energy barrier, when a liquid

droplet of a critical size has formed. By varying the conditions of nucleation, we are also able

to analyze the impact of the supersaturation on the nucleation process and to rationalize the

interplay between the free energy of nucleation, the size of the liquid droplet and the range

of entropies spanned during the nucleation process. The validity of the results is assessed

through a comparison with the predictions from the classical nucleation theory54,55, which

provides a relation between the free energy of nucleation and the supersaturation, and with

2

prior simulation work35,56. Results are presented for both atomic (Ar) as well as molecular

(N2 and CO2) systems to demonstrate the versatility and the transferability of the method

to molecular systems.

The paper is organized as follows. In the next section, we present the simulation method

and discuss how the entropy of the system is used as a RC. We also explain how we calculate

the free energy proﬁle for the the nucleation process. We then present the molecular force

ﬁelds used to model the three systems studied in this work, before discussing the technical

details. In particular, we give an account of how we obtain and choose the input parameters

for the simulations to control the extent of supersaturation during the nucleation process.

Then, we discuss the results obtained here on the three systems considered in this work,

Ar, N2 and CO2 and focus on quantifying the impact of supersaturation on the height of

the free energy barrier, as well as on the size of the liquid droplet and on the entropy of the

system at the top of the free energy barrier. We ﬁnally draw the min conclusions from this

work in the last section.

II. SIMULATION METHOD

A. Sampling entropic pathways

The µV T −S approach is based on the grand-canonical ensemble, where µ is the chemical

potential, V the volume, T the temperature and S the entropy of the system. Having µ

as an input parameter for the simulations leads to a direct comparison with the theoretical

predictions from the classical nucleation theory (CNT)54,55. CNT analyzes the nucleation

process, and the free energy barrier that the system has to overcome during this process, as

a competition between two contributions, which cancel out when a droplet of a critical size

has formed, i.e. when the system has reached the top of the free energy barrier. The ﬁrst

contribution, the surface term, is energetically unfavorable and is the predominant term for

small droplets. It results from the cost of creating the interface between the liquid droplet

and the vapor and can be evaluated as the product of the area of the incipient spherical

droplet by the surface tension. The second contribution, the volume term, is energetically

favorable and becomes predominant for larger droplets. The volume term corresponds to the

energetic gain in ’converting’ the parent phase, the metastable supersaturated vapor, into a

3

droplet of the stable phase, the liquid phase. In the CNT approach54,55, the volume term, and

hence the free energy of nucleation, is proportional to the supersaturation ∆µ = µ−µv, which

is the diﬀerence between the chemical potential of the liquid (µ) and the chemical potential

of the supersaturated vapor µv at the same pressure as the liquid. Carrying out simulations

in the grand-canonical ensemble allows us to choose µ and hence the supersaturation ∆µ

for the nucleation event.

Working in the grand-canonical ensemble also has additional advantages. Since the num-

ber of atoms/molecules is allowed to ﬂuctuate, this ensemble provides a direct acces to

thermodynamic quantities that are diﬃcult to calculate in other ensembles, as e.g.

in the

N V T or N P T ensemble. This is the case, for instance, for the entropy S of the system.

In the grand-canonical ensemble, in which the chemical potential µ, the temperature T and

volume V are ﬁxed during the simulations, it is straightforward to evaluate S during the

simulations through

S =

¯U − µ
T

(1)

where ¯U is the internal energy per atom/molecule, obtained by calculating the potential

energy due to the interactions between atoms/molecules and by adding the kinetic (ideal

gas) contribution to the internal energy of kBT /2 per degree of freedom.

This means that, in the grand-canonical ensemble, S can be used as the reaction coordi-

nate to measure the onset of order in the system and, in the case of nucleation, its progress

towards the formation of a liquid droplet of a critical size. To achieve this, we carry out

µV T − S simulations by taking advantage of the well-known umbrella sampling method57

to allow the system to follow the RC, in this case S. From a practical standpoint, we add a

bias potential energy, function of the entropy of the system, Ubias(S), to the total potential

energy of the system. In this work, we use the following harmonic function of S as the bias

potential energy

Ubias =

1
2

k(S − S0)2

(2)

where k is a spring constant and S0 is the target value for the entropy of the system.

µV T − S simulations are carried out within the Monte Carlo (MC) framework, with the

usual Metropolis criteria used to accept/reject the diﬀerent types of MC moves attempted

on the atoms/molecules of the system. More speciﬁcally, since these simulations are rooted

in the grand-canonical ensemble, the conventional Metropolis criteria, as obtained e.g. by

4

Allen and Tildesley58 in the grand-canonical ensemble, are used in µV T − S simulations.

For instance, for the MC steps involving the translation of single atom/molecule, as well as

for the rotation of a molecule, we use the following Metropolis criterion

acc(o → n) = min [1, exp(−β∆U ]

(3)

with ∆U denoting the change in the total potential energy (interaction energy+bias poten-

tial) corresponding to the move from the old (o) conﬁguration to the new (n) conﬁguration.

Similarly, for the MC moves involving the insertion of a new atom/molecule, we use the

following criterion:

acc(o → n) = min

1, exp(−β∆U ) + ln

(cid:20)

(cid:19)(cid:21)

(cid:18) N
zV

(4)

where z is the activity z = exp(βµ)/Λ3, where Λ is the de Broglie wavelength and N is the

current number of atoms/molecules in the system. In the case of molecular ﬂuids, one also

needs to take into account the terms related to the other degrees of freedom. For linear

molecules like N2 and CO2, we include for the rotation a factor of 8πIkBT /2h2, where I is

the moment of inertia of the linear molecule, kB is the Boltzmann constant and h is Planck’s

constant.

For all systems (Ar, CO2 and N2), we carry out µV T − S simulations in cubic cells
with an edge of 100 ˚A and apply the usual 3D periodic boundary conditions. To simulate

the entire nucleation process, we carry out a series of umbrella sampling simulations with

decreasing values for the target entropy S0. This allows us to sample the underlying entropic

pathway, which goes from the high entropy parent phase (supersaturated vapor) to the low

entropy phase (liquid). During the course of the simulation, we collect histograms for the

number of times each entropy interval is visited. These histograms are then used to build

the free energy proﬁle of nucleation using the techniques developed to analyze the results

from umbrella sampling simulations (more details can be found in previous work57–61). For

each value of the target entropy S0, simulations are ﬁrst run for 100 × 106 M C steps to allow
the system to relax. Then, a second run, the production run, is performed for 200 × 106

M C steps during which the data are collected and the calculation of average properties

is carried out. The diﬀerent types of M C steps are attempted with the following rates.

In the case of of Ar, 75 % of the M C steps consist in the translation of a single atom,

while the 25 % remaining moves are equally split between the M C steps corresponding to

5

the insertion and deletion of Ar atoms.

In terms of computational eﬃciency, working in

the grand-canonical ensemble allows the number of atoms to vary, which means that the

simulations for the higher S values will be performed on systems with few atoms. This

is advantageous when compared to methods based on the NPT ensemble, which simulate

systems with a constant number of atoms. Furthermore, calculating the reaction coordinate

S through Eq. 1 after every time step is very fast. The CPU time for a µV T − S run is

therefore very close to a conventional grand-canonical run. For instance, a production run

carried out on systems containing an Ar droplet of a critical size (i.e. the largest systems sizes

during nucleation) takes 30 CPU hours (CPU time given for a single Intel Xeon processor

clocked at 3.2 GHz). For CO2 and N2, we take into account the M C steps for the rotation of

a single molecule (37.5 %), in addition to the translation (37.5 %) and the insertion/deletion

(25 %). Throughout the simulations, we check that we have suﬃciently large acceptance

rates for the insertion/deletion steps to ensure an eﬃcient sampling. For all systems and all

target entropies S0, we obtain acceptance rates greater than 40 % for the insertion/deletion

steps.

B. Models

We model Argon with a Lennard-Jones (LJ) potential

φ(r) = 4(cid:15)

(cid:20)(cid:16) σ
r

(cid:17)12

−

(cid:16)σ
r

(cid:17)6(cid:21)

(5)

where (cid:15) = 117.05 K is the depth of the potential well, σ = 3.4 ˚A is the atom diameter

and r is the distance between two interacting atoms. The interactions between Ar atoms
are calculated for all distances up to 13.6 ˚A and neglected beyond that cutoﬀ distance. We

use this large cutoﬀ distance (4σ) and do not apply tail corrections, as in previous work on

vapor-liquid nucleation35. We add that an alternative approach, relying on the calculation

of long-range corrections as a function of the local density, has been developed in recent

years for inhomogeneous systems62.

For N2 and CO2, we consider both molecules to be rigid and model the interactions with a

distribution of point charges to account for the molecular quadrupole and with a distribution

of LJ sites to model the dispersion-repulson interactions. For N2, we consider two LJ sites

per N2 molecule (one on each atom) and three point charges (one negative charge on each

6

atom and one positive charge at the center of the N − N bond) to model the quadrupole of

the N2 molecule. We use the following parameters63 for the LJ sites, (cid:15)N N /kB = 36 K and
σN N = 3.30 ˚A, and for the point charges, qcenter = 0.966 e and qN = −qcenter/2. The N − N
bondlength is set to 0.549 ˚A, and use a spherical cutoﬀ set to 4σN N = 13.2 ˚A for the LJ
part of the potential and to 15 ˚A for the quadrupole-quadrupole interactions.

For CO2, we use the TraPPE force ﬁeld64 which is based on a distribution of three LJ

sites (located on the atoms of the molecule) and of three atomic charges, with the following
parameters: (cid:15)CC/kB = 27 K,(cid:15)OO/kB = 79 K, σCC = 2.80 ˚A and σOO = 3.05 ˚A, qc = 0.7 e

and qO = −0.35 e. The parameters for the LJ interactions between unlike atoms are given
by the Lorentz-Berthelot mixing rules. The bondlength is set to 1.16 ˚A as in the original
paper64. We use a spherical cutoﬀ set to 4σOO = 12.2 ˚A for the LJ part of the potential and
to 14.6 ˚A for the quadrupole-quadrupole interactions.

C. Setting up the simulations

1. Argon

µV T − S simulations for Ar are carried out at T = 128.76 K. We present in Table I the

conditions for the three supersaturations studied in this work. They are obtained through

the Expanded Wang-Landau (EWL) simulation method we recently developed65–68 (other

methods can also be used to determine this information64,69–80). EWL simulations provide

the grand-canonical partition function and the probability distribution for the number of Ar

atoms in the system for any value of µ. From there, the value of the chemical potential at the

vapor-liquid coexistence can be directly obtained by ﬁnding the value of µ leading to equal

probabilities for the vapor and liquid phases (more details are provided in previous work65).

The EWL simulations also give access to all other thermodynamic properties, including the

pressure P and entropies at coexistence, Sl and Sv, also given in Table I. This provides an

estimate for the range of entropies that needs to be sampled during the µV T −S simulations

to cover the entire vapor→liquid transition. We also give in Table I the supersaturation ∆µ

that we apply to obtain the supersaturated vapors, which serve as parent phases for the

nucleation processes. Increasing the value of the chemical potential by ∆µ (∆µ > 0) pushes

the system further into the domain of the phase diagram where the liquid phase is stable.

7

We add that µv that appears in the deﬁnition of the supersaturation ∆µ is very close to
µcoex for the low pressures studied here (of the order of 10−3 kJ/kg). Here, we consider 3

diﬀerent supersaturations and label each set of conditions as system 1, 2 and 3.

TABLE I: Ar at 128.76 K: Input parameters for the three supersaturations studied in this work

(systems 1, 2 and 3).

µ

∆µ

P P/Pcoex

Sl

Sv

(kJ/kg) (kJ/kg) (bar)

(kJ/kg/K) (kJ/kg/K)

coex

-300.19

0.00

21.58

system 1 -298.12

2.07

43.16

system 2 -297.72

2.47

47.48

system 3 -297.35

2.84

51.80

1.0

2.0

2.2

2.4

1.856

1.834

1.831

1.830

2.701

-

-

-

The µV T − S simulations are initiated from a very low density vapor, obtained e.g. by

placing an Ar atom in the simulation cell. We then carry out a series of umbrella sampling

simulations for decreasing values of the target entropy S0,i, where i is an index labeling

the ith umbrella sampling simulation. A reasonable estimate for the starting value for the

target entropy is provided by Sv, the value of the vapor at coexistence. We show in Fig. 1

the histograms pi(S) for the number of times a given entropy interval is visited during the

µV T − S simulations for system 2. For each umbrella sampling simulation, comparing the

relative values of Smax,i, the entropy for which the histogram pi(S) reaches its maximum, to
the target entropy S0,i, imposed during the ith umbrella sampling simulation, provides a great

deal of insight into the nucleation process. For instance, at the beginning of the nucleation

process, the system tries to overcome the free energy barrier of nucleation. This means

that increasing the size of the liquid droplet (achieved here by decreasing the entropy of the

system) is associated with the large cost, in terms of free energy, due to the predominant

surface term. As a result, the histogram pi(S) for the entropy of the system lags behind the

target value for the entropy and that Smax,i > S0,i. On the other hand, when the system is

past the top of the free energy barrier, the droplet has a larger probability to keep growing

and we have the reverse situation with Smax,i < S0,i. The same applies to very low density

vapors, when the target value for the entropy is greater than the entropy of the metastable

supersaturated vapor. Therefore, the entropies Smax,i and S0,i only coincide when the system

8

FIG. 1: Ar at T = 128.76 K. Entropy histograms pi(S) for successive sampling windows for system

2.

reaches a point corresponding to an extremum of the free energy proﬁle, This extremum can

be either a maximum (i.e. the top of the free energy barrier, when a liquid droplet of a

critical size has formed) or a minimum (i.e. the metastable supersaturated vapor or the

stable liquid).

Looking at the ﬁrst umbrella sampling window, starting from the right of Fig. 1, we

ﬁnd that Smax,1 (2.494 kJ/kg/K) is lower than S0,1 (2.5 kJ/kg/K). This shows that, at this

stage, the entropy of the system is greater than the entropy of the metastable supersaturated

vapor, or, in other words, that the density of the system has not yet reached the density

of the supersaturated vapor. Decreasing the target entropy allows us to identify the ﬁrst

value of the entropy for which Smax,i = S0,i, where we have the metastable supersaturated

vapor for an entropy of 2.49 kJ/kg/K. Then, during the next umbrella sampling simulations

for decreasing S0,i, the system climbs up the free energy barrier of nucleation and we have

Smax,i < S0,i, until we observe again the coincidence of Smax,i with S0,i for an entropy of

2.3 kJ/kg/K. This occurs when the system reaches the top of the free energy barrier and a

liquid droplet of a critical size has formed. These results show that the µV T − S method

allows us to explore the entropic pathway underlying the nucleation process and identify

the extrema of the free energy proﬁle. We also show in Fig. 2 the impact of changing the

9

FIG. 2: Ar at T = 128.76 K. Potential energy (top) and number of atoms (bottom) for system 2

and target entropies of 2.43 kJ/kg/K (black) and 2.38 kJ/kg/K (red).

target entropy on the properties of the system. Comparing the results for target entropies

of 2.43 kJ/kg/K and 2.38 kJ/kg/K shows a decrease in the potential energy of the system

by close to 30 % and an increase in the number of Ar atoms in the system by about 10 %.

Both results can be accounted for by the increase in the density of the system, triggered by

the decrease in target entropy, which leads to an increased number of attractive interactions

between Ar atoms. This shows that the decrease in entropy achieved through the µV T − S

simulations results in a transition towards the liquid phase. We leave the detailed discussion

of the energetics and characteristics of the liquid droplet to the ’Results’ section.

2. Nitrogen

The formation of a liquid droplet of N2 from a supersaturated vapor is studied at T =

100 K. As for Ar, we use the EWL simulation method to obtain the properties at coexistence

(coex) and at three supersaturations (systems 4, 5 and 6), which are increasingly deeper

inside the liquid domain of the phase diagram of N2. We list in Table II the data for these

points, from which we simulate the nucleation process.

10

TABLE II: N2 at 100 K: Conditions for vapor-liquid coexistence (coex) and for three supersatura-

tions (systems 4, 5 and 6).

µ

∆µ

P P/Pcoex

Sl

Sv

(kJ/kg) (kJ/kg) (bar)

(kJ/kg/K) (kJ/kg/K)

coex

-403.97

0.00

10.12

system 4 -402.16

1.81

21.84

system 5 -401.86

2.11

23.85

system 6 -401.57

2.40

25.86

1.0

2.2

2.4

2.6

3.374

3.352

3.349

3.345

4.912

-

-

-

3. Carbon dioxide

In line with the two previous systems, we start from the conditions for vapor-liquid

coexistence (coex) provided by the EWL simulations. We then deﬁne three supersaturations,

for increasing ∆µ, leading to systems 7, 8 and 9. The thermodynamic data at coexistence

and for the three supersaturations are given in Table III.

TABLE III: CO2 at 260 K: Thermodynamic data at the vapor-liquid coexistence (coex) and for 3

supersaturations (systems 7, 8 and 9).

µ

∆µ

P P/Pcoex

Sl

Sv

(kJ/kg) (kJ/kg) (bar)

(kJ/kg/K) (kJ/kg/K)

coex

-894.03

0.00

30.22

system 7 -890.84

3.19

60.28

system 8 -890.20

3.83

66.53

system 9 -889.61

4.42

72.31

1.0

2.0

2.2

2.4

2.962

2.944

2.940

2.937

3.946

-

-

-

III. RESULTS AND DISCUSSION

A. Argon

We start by discussing the results obtained for the free energy proﬁles of nucleation for

Argon at T = 128.76 K. We show in Fig. 3 the free energy barriers obtained from the

11

FIG. 3: Ar at T = 128.76 K: Free energy proﬁles of nucleation for system 1 (black), system 2 (red)

and system 3 (green).

µV T − S simulations for systems 1, 2 and 3 against the entropy of the system, which

serves as the reaction coordinate for the nucleation process. Two main trends appear in

this plot. First, the height of the free energy barrier increases as the supersaturation ∆µ

decreases. When ∆µ = 2.84 kJ/kg (system 3), we obtain a free energy barrier of nucleation of

26±2 kBT , while for ∆µ = 2.47 kJ/kg (system 2), we have a free energy barrier of 41±3 kBT .

Moreover, as the supersaturation further decreases to ∆µ = 2.04 kJ/kg (system 1), the free

energy barrier becomes 62 ± 5 kBT . This behavior is consistent with the predictions from

classical nucleation theory and with the ﬁndings from previous simulation work. Changing

the supersaturation ∆µ has a direct impact on the volume term, which is the gain, in free

energy, resulting from the formation of the thermodynamically stable liquid phase from the

metastable vapor phase. This volume term is proportional to ∆µ and it therefore follows

that for a small ∆µ (system 1), the top of the free energy barrier is reached later, for a larger

liquid droplet, leading to a higher free energy barrier. The values obtained in this work for

the free energy barriers of nucleation are also in good agreement with those predicted by the

classical nucleation theory54,55 and with those found for the Lennard-Jones system35. For

instance, CNT leads to the following free energy of nucleation54,55 W = 16πγ3/(3ρ2

l ∆µ2),
where γ is the surface tension for a ﬂat interface and ρl is the density of the (bulk) liquid.

12

Applying this to e.g. System 1 with γ = 3.535 × 10−10kJ/cm2 (determined from the EWL

simulations65) and ρl = 1.0882 g/cm3 leads to a free energy barrier of 70 kBT , in reasonably

good agreement with the barrier found here of 62 ± 5 kBT . Our results are also consistent
with ten Wolde and Frenkel35 who reported free energy barriers of nucleation 5 − 15 kBT

lower than the CNT predictions for the Lennard-Jones system. The second main trend is the

following. The entropic pathway spanned during nucleation covers a range of entropy that

depends on the supersaturation. More speciﬁcally, for a large supersaturation, the entropy

range becomes narrower. This is due to the fact that for a low supersaturation (i.e. not

too deep into the liquid domain of the phase diagram), the metastable supersaturated vapor

is less dense. This means that the starting point for the nucleation process is associated

with a larger entropy. Furthermore, at low supersaturation, the size of the critical nucleus

is larger. This implies that, when the supersaturation is low, the entropy of the system at

the top of the free energy barrier is smaller. Both factors account for the extended range of

entropy spanned during the nucleation process at low supersaturation. We ﬁnally add that

the range of entropy spanned during nucleation is, for all supersaturations, well within the

interval deﬁned by the entropies of the vapor (2.701 kJ/kg/K) and liquid (1.856 kJ/kg/K)

at coexistence. This is the expected behavior, since the metastable supersaturated vapors

are more dense, with a smaller entropy, than the vapor at coexistence, and since systems

containing a critical liquid droplet are considerably less dense, with a larger entropy, than a

uniform liquid phase like the liquid at coexistence.

The plots in Fig. 3 also allow us to characterize the state of the system at the top of the

free energy barrier of nucleation in terms of the critical entropy associated with the formation

of a critical nucleus. This critical entropy Sc is shown to depend on supersaturation, with

the largest value for Sc being obtained for the lowest supersaturation Sc = 2.21 ± 0.02 kJ/kg

(system 1) and the smallest value Sc = 2.35 ± 0.01 kJ/kg for the highest supersaturation

(system 3). To analyze further the characteristics of the liquid droplet, we examine the

relation between the entropy and the size of the liquid droplet. Starting from the approach

developed by ten Wolde and Frenkel35, we ﬁrst determine the distribution for the number of

neighbors in the vapor and in the liquid. Here, neighboring particles are deﬁned as particles

that are less than 1.6σ apart. This distance of 1.6σ corresponds to the ﬁrst minimum of the

radial pair distribution function of the liquid. Fig 4(a) shows the distribution so obtained

for the vapor and for the liquid phases. The two distributions show little overlap, with the

13

(a)

(b)

FIG. 4: Ar at T = 128.76 K: (a) Distribution for the number of neighbors in the vapor (dashed

line) and in the liquid (solid line) and (b) Correspondence between the entropy and the number of

liquid-like atoms along the nucleation (system 2).

vast majority of the liquid atoms having at least 6 neighbors, while atoms in the vapor

phase very rarely have more than 5 neighbors. This allows us to deﬁne liquid-like atoms as

having at least 6 neighbors and vapor-like atoms having fewer than 6 neighbors and to follow

the variations of the number of liquid-like atoms during nucleation. Applying this analysis

during the µV T − S simulations leads us to draw a correspondence between the value of

the entropy and the number of liquid-like atoms of the system as nucleation proceeds. We

present in Fig. 4(b) the result for this correspondence for system 2. The number of liquid-

like atoms increases steadily with entropy as the nucleation process advances, implying that

the size of the liquid droplet steadily increases as the entropy of the system decreases. This

can best be seen by examining snapshots of the conﬁgurations of the system during the

nucleation process. Fig. 5 shows the formation and development of the liquid droplet along

the entropic pathway. As can be seen on the snapshots, the droplet size steadily increases

with entropy and reaches a critical size of 1715±50 atoms for system 1. The snapshots for the

other 2 supersaturations reveal a similar behavior, and critical sizes of 980 ± 25 and 649 ± 15

atoms are found for the two other supersaturations systems 2 and 3, respectively. We obtain

the expected correlation between the height of the free energy barrier of nucleation and the

size of the critical nucleus, as the size of the critical droplet decreases with the free energy

14

(a)

(b)

(c)

FIG. 5: Ar at T = 128.76 K: Snapshots for system 1 during the nucleation process for decreasing

values of the entropy: (a) S = 2.43 kJ/kg/K, (b) S = 2.38 kJ/kg/K, (c) S = 2.31 kJ/kg/K

of nucleation as we go from system 1 to system 2 and ﬁnally to system 3.

B. Nitrogen

We now turn to the assessment of the versatility of the method and test it on a molecular

ﬂuid. We apply the µV T − S approach to study the nucleation of a liquid droplet of

N2 at 100 K. We follow the same procedure as for Ar and perform a series of umbrella

sampling simulations spanning the entropic pathway underlying the formation of the droplet.

We present in Fig. 6 the free energy proﬁles of nucleation of N2 at T = 100 for three

supersaturations (systems 4, 5 and 6). The results show features that are qualitatively

similar to those found for Ar. In terms of entropy range, the entropies sampled during the

15

FIG. 6: N2 at T = 100 K: Free energy proﬁles of nucleation along S for system 4 (black), system

5 (red) and system 6 (green).

process lie within the wider interval deﬁned by the entropy of the liquid and of the vapor

at coexistence (from Sliq = 3.374 kJ/kg/K to Svap = 4.912 kJ/kg/K). For instance, for the

lowest supersaturation (system 4), the nucleation starts from a supersaturated vapor with

S = 4.6 kJ/kg/K (lower than the entropy of the coexisting vapor, that has a lower density)

and ends with conﬁgurations containing a critical nucleus at S = 4.08 kJ/kg/K (higher than

the entropy of the liquid at coexistence, which has a much a higher density). The same

reasoning applied to systems 5 and 6, for which the nucleation process is associated to an

even narrower entropy range due to the higher supersaturations involved for these systems.

In particular, the entropy Sc for which a liquid droplet of a critical size has formed is shown to

increase as the supersaturation decreases, starting from Sc = 4.08 ± 0.02 kJ/kg/k (system 4)

and increasing to Sc = 4.16±0.02 kJ/kg/K (system 5) and ﬁnally to Sc = 4.20±0.02 kJ/kg/K

(system 6) for the highest supersaturation. The free energy barriers of nucleation for N2

are also shown to decrease gradually as the supersaturation is increased. The free energy

barrier of nucleation reaches 73 ± 5 kBT for system 4 (lowest supersaturation), 60 ± 4 kBT

for system 5 and 52 ± 4 kBT for system 6 (highest supersaturation).

We further reﬁne our analysis by determining the size of the droplet during the nucleation

process. For this purpose, we adopt a similar procedure to that followed for Argon. We

16

(a)

(b)

FIG. 7: N2 at T = 100 K: (a) Distribution for the number of neighbors in the vapor (dashed

line) and in the liquid (solid line) and (b) Correspondence between the entropy and the number of

liquid-like molecules during the nucleation process (system 6).

compute the distributions for the number of neighbors for N2 molecules in the supersaturated

vapor and in the liquid, using the ﬁrst minimum of the pair distribution function (based on
the distance between the centers-of-mass of 2 N2 molecules) at 5.7 ˚A as a cutoﬀ distance used

to deﬁne neighbors. The results plotted in Fig. 7(a) show that these distributions allow us

to identify vapor-like molecules (with less than 6 neighbors) and liquid-like molecules (with

6 or more neighbors). The variation of the number of liquid-like molecules in the system as

a function of entropy during the nucleation process is shown in Fig. 7(b). As with Ar,the

number of liquid-like molecules exhibits a steady increase with entropy, corresponding to the

increase in the size of the droplet as nucleation proceeds. An examination of the snapshots

(see Fig. 8) obtained during the µV T − S simulations sheds light on the formation of the

liquid droplet as the entropy of the system decreases. This allows us to identify the size of the

critical droplet, which contains 1006 ± 30 N2 molecules for system 4, 735 ± 25 molecules for

system 5 and 638 ± 20 molecules for system 6. We observe the expected correlation between

the size of the critical droplet and the height of the free energy barrier of nucleation, with

the lowest supersaturation of system 4 leading to the largest free energy of nucleation and

to the biggest critical droplet, that are reached for the lowest critical entropy. This set of

results show that S can be used as the reaction coordinate for the nucleation process in a

17

(a)

(b)

(c)

FIG. 8: N2 at T = 100 K: Snapshots of system 6 during the nucleation process for decreasing

values of the entropy: (a) S = 4.5 kJ/kg/K, (b) S = 4.36 kJ/kg/K, (c) S = 4.2 kJ/kg/K

molecular ﬂuid, and that no adjustment or redeﬁnition of the RC is necessary.

C. Carbon dioxide

We now apply the µV T − S method to a second molecular ﬂuid and study the nucleation

of a liquid droplet in CO2 at 260 K. CO2 is similar to N2 in many respects, having a similar

shape and exhibiting similar types of intermolecular interactions (with a quadrupole moment

for CO2 more than 6 times greater than for N2). Carrying out the µV T − S simulations for

the formation of the liquid droplet at 260 K allows us to draw a comparison with the results

on N2. This is because the conditions of temperature for N2 and CO2 can be considered

as similar, if one considers reduced temperatures, with respect to the critical temperature,

18

FIG. 9: CO2 at T = 260 K: Free energy proﬁles of nucleation along S for system 7 (black), system

8 (red) and system 9 (green).

for each compounds (0.85 for CO2 and 0.83 for N2). As for Ar and N2, we perform a series

of µV T − S simulations to sample the entropic pathway leading towards the formation of

a liquid droplet of CO2 of a critical size for 3 supersaturations. We show in Fig. 9 the free

energy proﬁles of nucleation so obtained. Similarly to the nucleation of liquid droplet in N2,

the proﬁles show that decreasing the entropy of the system during the µV T − S simulations

allows the system to overcome the free energy barrier and that S can be reliably used to

drive the nucleation process in the molecular ﬂuid of CO2.

The range of entropies sampled along the entropic pathway is shown to depend on the ex-

tent of supersaturation. As for Ar and N2, the entropy for the starting point, the metastable

supersaturated vapor, decreases at high supersaturations as the supersaturated vapor be-

comes more dense. The entropy for which the top of the free energy barrier is reached

also decreases as the supersaturation becomes high, as a result of the smaller size of the

critical droplet. Both factors account for the reduced range of entropies sampled for sys-

tem 9 (high supersaturation) when compared to system 7 (low supersaturation). This leads

to the following values for the entropies Sc corresponding to systems containing a liquid

droplet of a critical size, with Sc = 3.55 ± 0.02 kJ/kg/k (system 7) and decreasing to

Sc = 3.59 ± 0.02 kJ/kg/K (system 8) and ﬁnally to Sc = 3.61 ± 0.02 kJ/kg/K (system 9) for

19

(a)

(b)

FIG. 10: CO2 at T = 260 K: (a) Distribution for the number of neighbors in the vapor (dashed

line) and in the liquid (solid line) and (b) Correspondence between the entropy and the number of

liquid-like molecules during nucleation (system 7).

the highest supersaturation. This increase in Sc at high supersaturations is correlated with

a decrease in the height of the free energy barrier of nucleation which reaches 26 ± 3 kBT

for system 7 (lowest supersaturation), 21 ± 4 kBT for system 8 and 14 ± 2 kBT for system 9

(highest supersaturation). Since the reduced temperatures and the supersaturations for the

nucleations of N2 and CO2 are similar, we attribute the much smaller free energy barriers of

nucleation, when compared to those found for N2, to the stronger intermolecular interactions

in CO2.

We now analyze the nucleation process in terms of the number of liquid-like molecules

in the system. Closely following the process used to deﬁne this order parameter for the

other systems, we determine the distributions for the number of neighbors in the supersat-
urated vapor and in the liquid using a cutoﬀ distance of 5.85 ˚A to characterize neighboring

molecules. The distributions plotted in Fig. 10(a) allow us to distinguish between vapor-like

molecules (6 neighbors or less) and liquid-like molecules (7 neighbors or more). Using this

criterion, we determine the number of liquid-like molecules during the nucleation process

as the entropy changes along the nucleation pathway. The results are plotted in Fig. 10(b)

for system 7 and show a smooth increase in the number of liquid-like molecules as a func-

tion of the entropy during the formation of the liquid droplet. The formation of the liquid

20

(a)

(b)

(c)

FIG. 11: CO2 at T = 260 K: Snapshots of the system during the nucleation process for decreasing

values of the entropy: (a) S = 3.66 kJ/kg/K, (b) S = 3.6 kJ/kg/K, (c) S = 3.54 kJ/kg/K

droplet can be best captured by looking at the snapshots of Fig. 11, which show the sys-

tem for ddecreasing values of the entropy during the nucleation process. These snapshots

show the increase in the size of the nucleus and reveal that the critical droplet contains

395 ± 33 molecules for system 7. The critical sizes obtained for the other systems are the

following: 290 ± 28 molecules for system 8 and 242 ± 20 molecules for system 9. As for

Ar and N2, the critical sizes are correlated with the free energy barriers of nucleation, with

the highest barrier of system 7 corresponding to the biggest critical droplet and the lowest

supersaturation.

21

IV. CONCLUSION

In this work, we develop the µV T − S simulation method to calculate the free energy

of nucleation of atomic and molecular ﬂuids along entropic pathways. We achieve this by

working in the grand-canonical ensemble, which allows for the direct evaluation of entropy

during the simulations and for the study of the nucleation process at a given supersaturation

∆µ, thereby providing a direct connection with the predictions from the classical nucleation

theory. The simulation protocol for µV T − S consists of performing a series of umbrella

sampling simulations that use S as the reaction coordinate for the nucleation process. The

results presented here show that the method provides a picture of the nucleation process

that is consistent with the classical nucleation theory and with that found in previous work,

including e.g. the dependence of the height of the free energy barrier and of the size of the

critical nucleus on supersaturation. They also establish that the µV T − S approach can be

applied to atomic as well as molecular systems without any modiﬁcation. Furthermore, our

simulations reveal the correlation between the entropy of the system and the droplet size,

and show how supersaturation impacts the entropic pathway visited during the nucleation

process, with a narrowing of the range of entropy visited at high supersaturation. Our ﬁnd-

ings also allow us to identify the critical value for the entropy associated with the formation

of a nucleus of a critical size. Further work presented in the next two papers of the series will

focus on the development of the method for multi-component systems and for heterogeneous

nucleation processes.

Acknowledgements Partial funding for this research was provided by NSF through

CAREER award DMR-1052808.

1 K. Yasuoka and M. Matsumoto, J. Chem. Phys. 109, 8451 (1998).

2 D. W. Oxtoby, J. Phys. Condens. Matt. 4, 7627 (1992).

3 V. K. Shen and P. G. Debenedetti, J. Chem. Phys. 111, 3581 (1999).

4 C. L. Weakliem and H. Reiss, J. Chem. Phys. 99, 5374 (1993).

5 G. K. Schenter, S. M. Kathmann, and B. C. Garrett, Phys. Rev. Lett. 82, 3484 (1999).

6 X. C. Zeng and D. W. Oxtoby, J. Chem. Phys. 94, 4472 (1991).

22

7 P. Yi, D. Poulikakos, J. Walther, and G. Yadigaroglu, Int. J. Heat Mass Transfer 45, 2087

(2002).

8 T. Kinjo, K. Ohguchi, K. Yasuoka, and M. Matsumoto, Comput. Mat. Sci. 14, 138 (1999).

9 S. Toxvaerd, J. Chem. Phys. 115, 8913 (2001).

10 I. Ford, J. Chem. Phys. 105, 8324 (1996).

11 V. Talanquer and D. Oxtoby, J. Phys. Chem. 99, 2865 (1995).

12 H. Reiss, A. Tabazadeh, and J. Talbot, J. Chem. Phys. 92, 1266 (1990).

13 V. Kalikmanov and M. Van Dongen, J. Chem. Phys. 103, 4250 (1995).

14 M. Horsch, J. Vrabec, and H. Hasse, Phys. Rev. E 78, 011603 (2008).

15 A. V. Neimark and A. Vishnyakov, J. Chem. Phys. 122, 054707 (2005).

16 D. W. Oxtoby and R. Evans, J. Chem. Phys. 89, 7521 (1988).

17 J. F. Lutsko, J. Chem. Phys. 129, 244501 (2008).

18 Z.-J. Wang, C. Valeriani, and D. Frenkel, J. Phys. Chem. B 113, 3776 (2008).

19 P. R. Ten Wolde, M. J. Ruiz-Montero, and D. Frenkel, J. Chem. Phys. 110, 1591 (1999).

20 M. A. Gonzalez, J. L. Abascal, C. Valeriani, and F. Bresme, J. Chem. Phys. 142, 154903 (2015).

21 T. D. Loeﬄer, A. Sepehri, and B. Chen, J. Chem. Theory Comput. 11, 4023 (2015).

22 G. C. Sosso, J. Chen, S. J. Cox, M. Fitzner, P. Pedevilla, A. Zen, and A. Michaelides, Chem.

Rev. 116, 7078 (2016).

23 W. Xu, Z. Lan, B. Peng, R. Wen, and X. Ma, J. Chem. Phys. 142, 054701 (2015).

24 S. J. Keasler and J. I. Siepmann, J. Chem. Phys. 143, 164516 (2015).

25 Ø. Wilhelmsen, T. T. Trinh, S. Kjelstrup, and D. Bedeaux, J. Phys. Chem. C 119, 8160 (2015).

26 J. van Meel, Y. Liu, and D. Frenkel, Mol. Phys. 113, 2742 (2015).

27 B. N. Hale, Phys. Rev. A 33, 4156 (1986).

28 B. N. Hale, J. Chem. Phys. 122, 204509 (2005).

29 B. N. Hale and M. Thomason, Phys. Rev. Lett. 105, 046101 (2010).

30 D. Yuhara, B. C. Barnes, D. Suh, B. C. Knott, G. T. Beckham, K. Yasuoka, D. T. Wu, and

A. K. Sum, Faraday Discuss. 179, 463 (2015).

31 M. Lauricella, S. Meloni, S. Liang, N. J. English, P. G. Kusalik, and G. Ciccotti, J. Chem. Phys.

142, 244503 (2015).

32 J. K. Singh and F. M¨uller-Plathe, Appl. Phys. Lett. 104, 021603 (2014).

33 R. Ni and M. Dijkstra, Soft Matter 9, 365 (2013).

23

34 A. Reinhardt and J. P. Doye, J. Chem. Phys. 141, 084501 (2014).

35 P. R. Ten Wolde and D. Frenkel, J. Chem. Phys. 109, 9901 (1998).

36 B. Chen, J. I. Siepmann, K. J. Oh, and M. L. Klein, J. Chem. Phys. 115, 10903 (2001).

37 K. Oh and X. C. Zeng, J. Chem. Phys. 110, 4471 (1999).

38 B. Chen, J. I. Siepmann, K. J. Oh, and M. L. Klein, J. Chem. Phys. 116, 4317 (2002).

39 D. Zhukhovitskii, J. Chem. Phys. 103, 9401 (1995).

40 K. Nishi, S. Inoue, and Y. Matsumura, Chem. Phys. Lett. 634, 194 (2015).

41 L. Lupi, B. Peters, and V. Molinero, J. Chem. Phys. 145, 211910 (2016).

42 E. E. Santiso and B. L. Trout, J. Chem. Phys. 143, 174109 (2015).

43 J. T. Berryman, M. Anwar, S. Dorosz, and T. Schilling, J. Chem. Phys. 145, 211901 (2016).

44 N. E. Zimmermann, B. Vorselaars, D. Quigley, and B. Peters, J. Am. Chem. Soc. 137, 13352

(2015).

45 J. Lam, D. Amans, C. Dujardin, G. Ledoux, and A.-R. Allouche, J. Phys. Chem. A 119, 8944

(2015).

46 K. Kratzer and A. Arnold, Soft Matter 11, 2174 (2015).

47 P. Bolhuis and C. Dellago, Eur. Phys. J. Special Topics 224, 2409 (2015).

48 K. K. Tanaka, K. Kawamura, H. Tanaka, and K. Nakazawa, J. Chem. Phys. 122, 184514 (2005).

49 T. Kraska, J. Chem. Phys. 124, 054507 (2006).

50 K. Oh and X. C. Zeng, J. Chem. Phys. 112, 294 (2000).

51 B. Senger, P. Schaaf, D. Corti, R. Bowles, D. Pointu, J.-C. Voegel, and H. Reiss, J. Chem.

Phys. 110, 6438 (1999).

52 G. V. Lau, P. A. Hunt, E. A. M¨uller, G. Jackson, and I. J. Ford, J. Chem. Phys. 143, 244709

(2015).

53 S. Toxvaerd, J. Chem. Phys. 144, 164502 (2016).

54 R. McGraw and A. Laaksonen, Physical Rev. Lett. 76, 2754 (1996).

55 R. McGraw and A. Laaksonen, J. Chem. Phys. 106, 5284 (1997).

56 K. Koga and X. C. Zeng, J. Chem. Phys. 110, 3466 (1999).

57 G. M. Torrie and J. P. Valleau, J. Comput. Phys. 23, 187 (1977).

58 M. P. Allen and D. J. Tildesley, Computer Simulation of Liquids (Clarendon Press, Oxford,

1987).

59 C. Desgranges and J. Delhommelle, J. Chem. Phys. 127, 144509 (2007).

24

60 C. Desgranges and J. Delhommelle, J. Phys. Chem. C 113, 3607 (2009).

61 C. Desgranges and J. Delhommelle, J. Am. Chem. Soc. 136, 8145 (2014).

62 A. Ghouﬁ, P. Malfreyt, and D. J. Tildesley, Chem. Soc. Rev. 45, 1387 (2016).

63 J. Delhommelle, Ph.D. thesis, Universite Paris XI-Orsay (2000).

64 J. J. Potoﬀ, J. R. Errington, and A. Z. Panagiotopoulos, Mol. Phys. 97, 1073 (1999).

65 C. Desgranges and J. Delhommelle, J. Chem. Phys. 136, 184107 (2012).

66 C. Desgranges and J. Delhommelle, J. Chem. Phys. 136, 184108 (2012).

67 C. Desgranges and J. Delhommelle, J. Chem. Phys. 140, 104109 (2014).

68 C. Desgranges and J. Delhommelle, J. Chem. Phys. 144, 124510 (2016).

69 G. Gazenm¨uller and P. J. Camp, J. Chem. Phys. 127, 154504 (2007).

70 Y. Liu, A. Z. Panagiotopoulos, and P. G. Debenedetti, J. Phys. Chem. B 115, 6629 (2011).

71 I. Nezbeda and J. Kolafa, Molec. Simul. 5, 391 (1991).

72 J. K. Singh and J. R. Errington, J. Phys. Chem. B 110, 1369 (2006).

73 N. Rai, J. I. Siepmann, N. E. Schultz, and R. B. Ross, J. Phys. Chem. C 111, 15634 (2007).

74 K. S. Rane, S. Murali, and J. R. Errington, J. Chem. Theory Comput. 9, 2552 (2013).

75 F. Escobedo and J. J. de Pablo, J. Chem. Phys. 105, 4391 (1996).

76 W. Shi and E. J. Maginn, J. Chem. Theory Comput. 3, 1451 (2007).

77 H. Eslami and F. M¨uller-Plathe, J. Comput. Chem. 28, 1763 (2007).

78 P. S. Vogt, R. Liapine, B. Kirchner, A. J. Dyson, H. Huber, G. Marcelli, and R. J. Sadus, Phys.

Chem. Chem. Phys. 3, 1297 (2001).

79 B. Widom, J. Chem. Phys. 39, 2808 (1963).

80 J. Siepmann and D. Frenkel, Mol. Phys. 75, 59 (1992).

25

