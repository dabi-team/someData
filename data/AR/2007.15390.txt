Sampling-based 3-D Line-of-Sight PWA Model Predictive Control for
Autonomous Rendezvous and Docking with a Tumbling Target

Dongting Liâˆ—, Ruiqi Dong

Harbin Institute of Technology (Shenzhen), Shenzhen 518055, P. R. China

A R T I C L E I N F O

A B S T R A C T

0
2
0
2

g
u
A
1

]

Y
S
.
s
s
e
e
[

2
v
0
9
3
5
1
.
7
0
0
2
:
v
i
X
r
a

Keywords:
Sampling-based
Novel constructions of constraints
Singularity-free
PWA model predictive control
3-D LOS dynamics
Pose tracking

In this paper, a model predictive control (MPC) framework is employed to realize autonomous ren-
dezvous and docking (AR&D) with a tumbling target, using the piecewise aï¬ƒne (PWA) model of
the 3-D line-of-sight (LOS) dynamics and Euler attitude dynamics. Consider the error between the
predictions obtained by the approximate linear model and the actual states of nonlinear dynamics, a
sampling-based PWA MPC is proposed to sample the predictions in the closer neighborhood of the
actual states. Besides, novel constructions of constraints are presented to reduce the on-board com-
putation cost and time-delay. Furthermore, a singularity-free strategy is provided to realize crossing
the singularity of angle states smoothly. Then, the mission is achieved by continuous 6-DOF pose
(position and attitude) tracking of the targetâ€™s docking port, with the coupling between the position
and attitude of the targetâ€™s docking port is taken into account. Finally, numerical results are presented
to demonstrate the above theories.

1. Introduction

With rapid development of aerospace technology, au-
tonomous rendezvous and docking (AR&D) has attracted
growing interest of researchers. In recent years, impressive
achievements have been acquired in the studies of AR&D
with a cooperative target ( e.g., [1][2][3]), which requires the
target spacecraft is attitude stable. However, due to the in-
crease of malfunctioning satellites and space debris, AR&D
with a tumbling target is required, which is more compli-
cated but closer to the practical applications.

Since MPC [4] [5] can achieve optimal performance and
respond to various constraints, several excellent works ( [6]
[7][8][9], etc.) have been proposed by using MPC in the
AR&D missions. Firstly, coordinates in the orbital frame
are adopted to describe the relative position, by employing
the C-W or T-H equations. Consequently, the navigation in-
formation has to be transformed into the orbital frame, which
can cause the increase of computation eï¬€orts and time-delay.
To address this drawback, the in-plane LOS dynamics was
used to control a spacecraft to rendezvous with an attitude
stable target in [10], by controlling the states which can be
measured directly.

Besides, the modeling of constraints are complex and
need linear approximation in existing papers. The distance
between two spacecrafts was calculated by the 2-norm of the
coordinates in [6], which caused the collision avoidance con-
straint was quadratic and cannot be taken into the optimiza-
tion index directly. The azimuth angle in [9] was calculated
by the trigonometric functionâ€™s operation. The entry cone
in [8]-[9] was linearized by an inscribed pyramid, the con-
straint was achieved by keeping the inner product of the posi-
tion vector and the normal external vectors of the pyramidâ€™s
side is negative.

âˆ—Corresponding author

dongting_li@126.com (D. Li)

ORCID(s):

Furthermore, since the states in LOS dynamics and Eu-
ler dynamics can be measured directly, to the best knowl-
edge of the authors, there is no paper adopt the 3-D LOS
dynamics and Euler attitude dynamics together to realize 6-
DOF pose tracking, by using MPC. However, since the non-
linear dynamics is coupling, the real time performance can
not be guaranteed if solving a coupling nonlinear optimaza-
tion problem in a standard nonlinear MPC. The existing ap-
proach to deal with this kind of model is to utilize approxi-
mate linear models, e.g., linearize the nonlinear model with
Taylor expansion at each sampling instant [11]; adopting the
multi-model predictive control [12]; using the neural net-
works to approximate the nonlinear characteristics [13][14].
Consider the linearization needs to calculate the covariance
matrix of the states in real time which will increase the com-
putation cost and time-delay, the PWA model is adopted in
[15] and [10]. However, there exist error between the pre-
dictions obtained by the approximate linear model and the
actual states of nonlinear dynamics, which can inï¬‚uence the
control performance of MPC.

Moreover, there exists singularity of angle states, which
means two diï¬€erent values represent a same position physi-
cally. For instance, an angle state is set within [âˆ’ğœ‹, ğœ‹] , âˆ’ğœ‹
and ğœ‹ represent the same position physically but diï¬€er by 2ğœ‹.
Consider a tracking problem, the desired states will jump
from ğœ‹ to âˆ’ğœ‹ once it reaches the singular point ğœ‹. However,
it is impossible for an input-constraint system to track the
mutation signal in an extraordinarily short time. The phe-
nomenon extremely limits the application of the LOS dy-
namics and Euler attitude dynamics in AR&D.

In this paper, the piecewise aï¬ƒne (PWA) systems based
on the 3-D LOS dynamics and the Euler attitude dynamics
are ï¬rstly adopted together to realize AR&D with a tum-
bling target. To reduce the error between the predictions
made by the PWA model and the actual nonlinear states,
this paper provides a sampling-based PWA MPC strategy
to realize sampling the predictions which describe the ac-

D. Li et al.: Preprint submitted to Elsevier

Page 1 of 14

 
 
 
 
 
 
D. Li, R. Dong

tual states more accurately. Since the time-varying position
of the docking port is coupled with the targetâ€™s rotation, this
problem is also considered and solved in this study. In addi-
tion, based on the adopted united models, novel construction
strategy of constraints is proposed, which is more suitable for
practical space missions for the advantages of more concise
and without any approximation. Furthermore, a singularity-
free strategy is proposed, which can simultaneously real-
ize continuous pose tracking by crossing the singular points
smoothly.

The rest of this paper is arranged as follows. Section 2
provides the control model and the novel modeling of con-
straints. In section 3, the sampling-based PWA MPC is pro-
posed. Section 4 illustrates the AR&D and the singularity-
free strategies. In section 5, numerical simulations are pre-
sented to demonstrate the eï¬€ectiveness of proposed strate-
gies. Finally, the conclusions are given in section 6.

Figure 1: The coordinate frames

2. Problem formulation

In this paper, the control objective is to design a position
and an attitude MPC controller separately to track the pose
of the tumbling targetâ€™s docking port. Before introducing
the LOS dynamics and the Euler dynamics, the following
coordinate frames are deï¬ned and illustrated in Fig. 1,

â§
âª
âª
â¨
âª
âª
â©

ÌˆğœŒâˆ’ğœŒ Ì‡ğœ€2 âˆ’ğœŒ( Ì‡ğ›½ âˆ’ ğœ”)2 cos2 ğœ€ = âˆ’ğœ‡
ğ‘…3
ğ‘¡
ğœŒ Ìˆğœ€+2 Ì‡ğœŒ Ì‡ğœ€+ğœŒ( Ì‡ğ›½ âˆ’ğœ”)2 sin ğœ€ cos ğœ€ = âˆ’3ğœ‡
ğ‘…3
ğ‘¡
ğœŒ( Ìˆğ›½ âˆ’ Ì‡ğ‘¤) cos ğœ€+2 Ì‡ğœŒ( Ì‡ğ›½ âˆ’ğœ”) cos ğœ€âˆ’2ğœŒ Ì‡ğœ€( Ì‡ğ›½ âˆ’ğœ”) sin ğœ€

(ğœŒâˆ’3ğœŒ cos2 ğœ€ sin2 ğ›½)+ğ‘¢ğœŒ,

ğœŒ sin ğœ€ cos ğœ€ sin2 ğ›½ +ğ‘¢ğœ€,

= 3ğœ‡
ğ‘…3
ğ‘¡

ğœŒ cos ğœ€ sin ğ›½ cos ğ›½ âˆ’ğ‘¢ğ›½,
(1)

â€¢ îˆ²

-axis points towards the Earthâ€™s center, Ì‚ğ‘¦ğ‘™

ğ‘™ = {ğ‘‚ğ‘¡, Ì‚ğ‘¥ğ‘™, Ì‚ğ‘¦ğ‘™, Ì‚ğ‘§ğ‘™}: the local-vertical-local-horizontal
(LVLH) frame, its origin is ï¬xed at the center of the target,
-axis is along
Ì‚ğ‘§ğ‘™
the direction of the orbital angular rate, Ì‚ğ‘¥ğ‘™
-axis completes
the triad.
ğ‘ğ‘¡ = {ğ‘‚ğ‘¡, Ì‚ğ‘¥ğ‘ğ‘¡, Ì‚ğ‘¦ğ‘ğ‘¡, Ì‚ğ‘§ğ‘ğ‘¡} and îˆ²
the body-ï¬xed coordinate frames of the target and the chaser.

ğ‘ğ‘ = {ğ‘‚ğ‘, Ì‚ğ‘¥ğ‘ğ‘, Ì‚ğ‘¦ğ‘, Ì‚ğ‘§ğ‘ğ‘}:

â€¢ îˆ²

.

Ì‚ğ‘¦ğ‘ ,

Ì‚ğ‘¥ğ‘ ,

â€¢ îˆ²

, Ì‚ğ‘§ğ‘ 

Ì‚ğ‘§ğ‘ }:

the LOS frame, its origin is
-axis points towards the
-axis is along the direction of angular momen-
completes the triad. Denote
and its projection on
plane, ğ›½ as the azimuth angle between the projec-

ğ‘  = {ğ‘‚ğ‘¡,
ï¬xed at the center of the target, Ì‚ğ‘¥ğ‘ 
chaser, Ì‚ğ‘¦ğ‘ 
tum of the rotation of Ì‚ğ‘¥ğ‘ 
ğœ€ as the elevation angle between ğ‘¥ğ‘ 
ğ‘‚ğ‘¡ Ì‚ğ‘¥ğ‘™ Ì‚ğ‘§ğ‘™
tion and ğ‘¥ğ‘™
In this study, the 3-D LOS dynamics is described in frame
îˆ²
with 3 ğœ€ -2 ğ›½
, which is obtained by the Euler rotation of îˆ²
sequence. It should be noted that ğœ€ is set within (âˆ’ğœ‹âˆ•2, ğœ‹âˆ•2)
to avoid the gimbal lock phenomenon. The attitude of tar-
get (chaser) is deï¬ned by the Euler rotation from frame îˆ²
ğ‘™
to frame îˆ²
) with 3-2-1 sequence. Therefore, it is eas-
ier to solve the coupling between the position and attitude of
the tumbling target, by deï¬ning the same rotation sequence
to îˆ²
from îˆ²

and from îˆ²

to îˆ²

(îˆ²

ğ‘ğ‘

ğ‘ğ‘¡

.

ğ‘ 

ğ‘™

ğ‘™

ğ‘ 

ğ‘™

ğ‘ğ‘¡

2.1. Relative motion dynamics
2.1.1. 3-D Line-of-sight dynamics

The relative translation between the chaser and the target
formulated in the LOS frame is described as follows [16][17],

where ğ‘…ğ‘¡ = ğ‘(1 âˆ’ ğ‘’2)âˆ•(1 + ğ‘’ cos ğ‘“ ) denotes the distance be-
tween the target and the Earth, ğ‘ denotes the semi-major axis
of the orbit plane, ğ‘’ is the eccentricity, ğ‘“ is the true anomaly,
ğœ‡ denots the gravity constant, ğœ” =
de-
ğœ‡ğ‘(1 âˆ’ ğ‘’2)âˆ•ğ‘…2
ğ‘¡
notes the time derivative of ğ‘“ ,
is the
time derivation of ğœ”, ğœŒ is the LOS range, angle ğœ€ and ğ›½ are
shown in Fig 1. It should be noted that ğœŒ, ğœ€, and ğ›½ can be
measured by the guidance system directly without any coor-
dinate transformation in practice.

Ì‡ğœ” = âˆ’2ğœ‡ğ‘’ğ‘ ğ‘–ğ‘›ğ‘“ âˆ•ğ‘…3
ğ‘¡

âˆš

Denote ğ‘¥ğ‘¥ğ‘¥ğ‘

= [ğœŒ, ğœ€, ğ›½,

Ì‡ğœŒ, ğœŒ Ì‡ğœ€, ğœŒ Ì‡ğ›½]T, then (1) can be re-

duced to the following ï¬rst-order diï¬€erential equation,

Ì‡ğ‘¥Ì‡ğ‘¥Ì‡ğ‘¥ğ‘(ğ‘¡) = ğ´c
where ğ‘¢ğ‘¢ğ‘¢ğ‘
scribed by

ğ‘(ğ‘¥ğ‘¥ğ‘¥ğ‘)ğ‘¥ğ‘¥ğ‘¥ğ‘(ğ‘¡) + ğµc
denotes the control input acting on the chaser, de-

ğ‘(ğ‘¥ğ‘¥ğ‘¥ğ‘)ğ‘¢ğ‘¢ğ‘¢ğ‘(ğ‘¡),

(2)

ğ‘¢ğ‘¢ğ‘¢ğ‘ = [ğ‘¢ğ‘,ğœŒ, ğ‘¢ğ‘,ğœ€, ğ‘¢ğ‘,ğ›½]T.
ğ‘(ğ‘¥ğ‘¥ğ‘¥ğ‘) and ğµc
ğ´c
ces with

ğ‘(ğ‘¥ğ‘¥ğ‘¥ğ‘) are time-varying state-dependent matri-

(3)

0
0

0

ğ‘41
ğ‘51
ğ‘61

0
0

0

0

0

0

0
0

0

0

0

0

1
0

0

0
âˆ’ğ‘¥ğ‘5
ğ‘¥ğ‘1
2ğœ”âˆ’

ğ‘¥ğ‘6
ğ‘¥ğ‘1

0
1
ğ‘¥ğ‘1
0
ğ‘¥ğ‘5
ğ‘¥ğ‘1
0

2 tan ğ‘¥ğ‘2(âˆ’ğœ”+

ğ‘¥ğ‘6
ğ‘¥ğ‘1

)

0
0
1
ğ‘¥ğ‘1
ğ‘46
ğ‘56
0

,

â
âŸ
âŸ
âŸ
âŸ
âŸ
âŸ
âŸ
âŸ
âŸ
â 

ğ´c

ğ‘ =

â›
âœ
âœ
âœ
âœ
âœ
âœ
âœ
âœ
âœ
â
where

D. Li et al.: Preprint submitted to Elsevier

Page 2 of 14

ğ‘41 = ğœ”2 cos2 ğ‘¥ğ‘2 âˆ’ ğœ‡

ğ‘…3 (1 âˆ’ 3 cos2 ğ‘¥ğ‘2 sin2 ğ‘¥ğ‘3),

EarthTargetChaserğ‘¦ğ‘     ğ‘¥ğ‘  ğ‘§ğ‘  ğ‘§ğ‘ğ‘ ğ‘¦ğ‘ğ‘ ğ‘¥ğ‘ğ‘ ğ‘§ğ‘ğ‘¡ ğ‘¦ğ‘ğ‘¡ ğ‘¥ğ‘ğ‘¡ ğ‘¥ğ‘™ ğ‘§ğ‘™ ğ‘¦ğ‘™ Î² Îµ Orbit planeProjectionD. Li, R. Dong

Denote ğ‘¥ğ‘¥ğ‘¥ğ‘ =

]T, then (4)-(7)
[ğœ™, ğœƒ, ğœ“, ğœ”ğ‘,1, ğœ”ğ‘,2, ğœ”ğ‘,3
can be reduced to the following ï¬rst-order diï¬€erential equa-
tion,

ğ‘51 =

cos2 ğ‘¥ğ‘2,
)

cos ğ‘¥ğ‘2 sin ğ‘¥ğ‘2,

(

)

ğ‘46 =
(

âˆ’2ğœ” +

âˆ’ğœ”2 âˆ’ 3 ğœ‡
(

ğ‘¥ğ‘6
ğ‘¥ğ‘1
ğ‘…3 sin2 ğ‘¥ğ‘3
)
ğ‘¥ğ‘6
ğ‘¥ğ‘1
ğ‘61 = Ì‡ğœ” + 3ğœ‡

2ğœ” âˆ’

ğ‘56 =

cos ğ‘¥ğ‘2 sin ğ‘¥ğ‘2,

ğ‘…3 sin ğ‘¥ğ‘3 cos ğ‘¥ğ‘3,

and

ğµc

ğ‘ =

0
0 0
0
0 0
0
0 0
0
1 0
0
0 1
0 0 âˆ’ 1

cos ğ‘¥ğ‘2

â›
âœ
âœ
âœ
âœ
âœ
âœ
â

.

â
âŸ
âŸ
âŸ
âŸ
âŸ
âŸ
â 

2.1.2. Euler attitude dynamics

The attitude kinematics of the chaser is described by

Ì‡ğœ™ğ‘
Ì‡ğœƒğ‘
Ì‡ğœ“ğ‘

â›
âœ
âœ
â

â
âŸ
âŸ
â 

=

1
ğ‘(ğœƒ)

ğ‘(ğœƒ)
0
0

â›
âœ
âœ
â

ğ‘ (ğœ™)ğ‘ (ğœƒ)
ğ‘(ğœ™)ğ‘ (ğœƒ)
ğ‘(ğœ™)ğ‘(ğœƒ) âˆ’ğ‘ (ğœ™)ğ‘(ğœƒ)

ğ‘ (ğœ™)

ğ‘(ğœ™)

ğœ”ğ‘,1
ğœ”ğ‘,2
ğœ”ğ‘,3

â
âŸ
âŸ
â 

â›
âœ
âœ
â

,

â
âŸ
âŸ
â 
(4)

where ğ‘ (â‹…) â‰œ sin(â‹…), ğ‘(â‹…) â‰œ cos(â‹…); ğœ™ğ‘(ğ‘¡), ğœƒğ‘(ğ‘¡), and ğœ“ğ‘(ğ‘¡) (rad)
denote the chaserâ€™s roll, pitch and yaw angles, respectively;
ğœ”ğ‘,1(ğ‘¡), ğœ”ğ‘,2(ğ‘¡), and ğœ”ğ‘,3(ğ‘¡) (radâˆ•s) denote the chaserâ€™s an-
gular velocities. To avoid the gimbal lock phenomenon, the
pitch angle of both the chaser and the target are set within
(âˆ’ğœ‹âˆ•2, ğœ‹âˆ•2), roll and yaw angles are set within [âˆ’ğœ‹, ğœ‹].
The attitude dynamics is formulated as follows,

(5)

ğ½1 Ì‡ğ‘¤ğ‘,1 = (ğ½2 âˆ’ ğ½3)ğœ”ğ‘,2ğœ”ğ‘,3 + ğ‘€1,
ğ½2 Ì‡ğ‘¤ğ‘,2 = (ğ½3 âˆ’ ğ½1)ğœ”ğ‘,1ğœ”ğ‘,3 + ğ‘€2,
ğ½3 Ì‡ğ‘¤ğ‘,3 = (ğ½1 âˆ’ ğ½2)ğœ”ğ‘,1ğœ”ğ‘,2 + ğ‘€3,

â§
âª
â¨
âª
â©
where ğ½1
of the chaser, ğ‘€1

, ğ½2

, and ğ½3

denote the principal moments of inertia
, and ğ‘€3

are the input moments.

, ğ‘€2

Consider the reaction wheels equipped along each prin-
cipal body axis as the actuators, the relation between the
wheelsâ€™ dynamics and the moments of the chaser is deï¬ned
as

ğ‘€1 = âˆ’ Ìƒğ½1( Ì‡ğœ”ğ‘,1 + Ìˆğ›¼1 + Ì‡ğ›¼3ğœ”ğ‘,2 âˆ’ Ì‡ğ›¼2ğœ”ğ‘,3) â‹ âˆ’ Ìƒğ½1( Ì‡ğœ”ğ‘,1 + Ìˆğ›¼1),
â§
âª
ğ‘€2 = âˆ’ Ìƒğ½2( Ì‡ğœ”ğ‘,2 + Ìˆğ›¼2 + Ì‡ğ›¼1ğœ”ğ‘,3 âˆ’ Ì‡ğ›¼3ğœ”ğ‘,1) â‹ âˆ’ Ìƒğ½2( Ì‡ğœ”ğ‘,2 + Ìˆğ›¼2),
â¨
ğ‘€3 = âˆ’ Ìƒğ½3( Ì‡ğœ”ğ‘,3 + Ìˆğ›¼3 + Ì‡ğ›¼2ğœ”ğ‘,1 âˆ’ Ì‡ğ›¼1ğœ”ğ‘,2) â‹ âˆ’ Ìƒğ½3( Ì‡ğœ”ğ‘,3 + Ìˆğ›¼3),
âª
â©
(6)

, Ìƒğ½2
, Ì‡ğ›¼2

, and Ìƒğ½3
, and Ì‡ğ›¼3

where Ìƒğ½1
denote the moments of inertia of the
denote the speed of wheels. Consider
wheels, Ì‡ğ›¼1
the following linearized relationship between the chaserâ€™s
angular velocities and the wheelsâ€™ acceleration,

Ì‡ğ‘¥ğ‘¥ğ‘¥ğ‘(ğ‘¡) = ğ´c
where ğ‘¢ğ‘¢ğ‘¢ğ‘
scribed by

ğ‘(ğ‘¥ğ‘¥ğ‘¥ğ‘)ğ‘¥ğ‘¥ğ‘¥ğ‘(ğ‘¡) + ğµc
denotes the control input acting on the chaser, de-

ğ‘ğ‘¢ğ‘¢ğ‘¢ğ‘(ğ‘¡),

(8)

[ğ‘¢ğ‘,ğœ™, ğ‘¢ğ‘,ğœƒ, ğ‘¢ğ‘,ğœ“

ğ‘¢ğ‘¢ğ‘¢ğ‘ =
ğ‘(ğ‘¥ğ‘¥ğ‘¥ğ‘) is a time-varying state-dependent matrix with
ğ´c

]T .

(9)

ğ´c

ğ‘ =

and

ğµc

ğ‘ =

0

0
0

0

0

0

0

0
0

0

0

0

0

0
0

0

0

0

( Ìƒğ½ 2
1

Ìƒğ½1)

0
0
0
âˆ’ğ½1
2
ğ½1
0

0

â›
âœ
âœ
âœ
âœ
âœ
âœ
âœ
âœ
âœ
â

â›
âœ
âœ
âœ
âœ
âœ
âœ
âœ
âœ
âœ
â

1

0
0

0

0
ğ‘¥5(ğ½1âˆ’ğ½2)
ğ½3

0
0
0

0

Ìƒğ½2)

( Ìƒğ½ 2
2

âˆ’ğ½2
2
ğ½2
0

ğ‘ (ğ‘¥1)ğ‘ (ğ‘¥2)
ğ‘(ğ‘¥2)
ğ‘(ğ‘¥1)
ğ‘ (ğ‘¥1)
ğ‘(ğ‘¥2)
ğ‘¥6(ğ½2âˆ’ğ½3)
ğ½1
0

0

0
0
0

0

0

Ìƒğ½3)

( Ìƒğ½ 2
3

âˆ’ğ½3
2
ğ½3

ğ‘(ğ‘¥1)ğ‘ (ğ‘¥2)
ğ‘(ğ‘¥2)
âˆ’ğ‘ (ğ‘¥1)
ğ‘(ğ‘¥1)
ğ‘(ğ‘¥2)
0
ğ‘¥4(ğ½3âˆ’ğ½1)
ğ½2
0

,

â
âŸ
âŸ
âŸ
âŸ
âŸ
âŸ
âŸ
âŸ
âŸ
â 

.

â
âŸ
âŸ
âŸ
âŸ
âŸ
âŸ
âŸ
âŸ
âŸ
â 

2.2. Novel construction strategy of constraints

By employing the 3-D LOS dynamics and Euler dynam-
ics in this study, an advantage is the constraints can be put
on the states directly without any transformation, which have
more practical application signiï¬cance.

2.2.1. Control input constraints

In practical space missions, the torque generated by the
actuators are limited. The constraints of the thrusters and the
reaction wheels are described by

,

|ğ‘¢ğ‘¢ğ‘¢ğ‘| â©½ ğ‘¢ğ‘¢ğ‘¢max
and

ğ‘

(10)

,

and ğ‘¢ğ‘¢ğ‘¢ğ‘

|ğ‘¢ğ‘¢ğ‘¢ğ‘| â©½ ğ‘¢ğ‘¢ğ‘¢max
ğ‘
,
= [ğ‘¢max
where ğ‘¢ğ‘¢ğ‘¢ğ‘
ğ‘,ğœŒ
= [ğ‘¢max
ğ‘,ğœ“ ]T denote the
ğ‘,ğœ€ , ğ‘¢max
ğ‘¢max
maximum control force of the thrusters and reaction wheels,
respectively.

are described in (3) and (9), ğ‘¢ğ‘¢ğ‘¢max
ğ‘,ğœ™ , ğ‘¢max

ğ‘,ğ›½ ]T and ğ‘¢ğ‘¢ğ‘¢max

ğ‘,ğœƒ , ğ‘¢max

(11)

ğ‘

ğ‘

2.2.2. Collision avoidance constraint

For safe docking, collision avoidance is realized by main-
taining the chaser outside a keep-out zone around the tum-
bling target. The keep-out zone is described by a sphere with
a ï¬xed radius,

Ì‡ğœ”ğ‘,ğ‘– = âˆ’

Ìƒğ½ğ‘–
ğ½ğ‘–

Ìˆğ›¼ğ‘–, ğ‘– = 1, 2, 3.

D. Li et al.: Preprint submitted to Elsevier

(7)

ğœŒ â©¾ ğ‘Ÿsafe,

(12)

Page 3 of 14

D. Li, R. Dong

where ğœŒ is the LOS range, ğ‘Ÿsafe
of the keep-out sphere.

denotes the minimum radius

2.2.3. Entry cone constraints

ğ‘ğ‘¡

-axis in îˆ²

As shown in Fig. 2(a), the chaser should be kept in an ap-
proaching cone around the targetâ€™s docking port during the
ï¬nal phase of docking. In this paper, we give the follow-
ing assumptions: (1) the targetâ€™s docking port is ï¬xed at the
; (2) the attitude of the target is described by
Ì‚ğ‘¥ğ‘ğ‘¡
Euler rotation from îˆ²
with 3-2-1 sequence; (3) half
to îˆ²
ğ‘ğ‘¡
. By deï¬ning the same rotation
of the entry cone angle is ğ›¾e
sequence from îˆ²
, it can be drawn
and from îˆ²
that the desired elevation angle is equal to the targetâ€™s pitch
angle, and the desired azimuth angle is the equal to the tar-
getâ€™s yaw angle. Then the entry cone constraint is described
by

to îˆ²

to îˆ²

ğ‘ğ‘¡

ğ‘ 

ğ‘™

ğ‘™

ğ‘™

,

,

ğœƒğ‘¡(ğ‘¡) âˆ’ ğ›¾e â©½ ğœ€ â©½ ğœƒğ‘¡(ğ‘¡) + ğ›¾e
âˆ’ğœ‹âˆ•2 < ğœ€ < ğœ‹âˆ•2,
âˆ’ğœ“ğ‘¡(ğ‘¡) âˆ’ ğ›¾e â©½ ğ›½ â©½ âˆ’ğœ“ğ‘¡(ğ‘¡) + ğ›¾e
âˆ’ğœ‹ â©½ ğ›½ â©½ ğœ‹,

â§
âª
â¨
âª
â©
where ğœ€ and ğ›½ have been shown in Fig. 1. The above rela-
tions can be rewritten as
{ ğœ€min(ğ‘¡) < ğœ€ < ğœ€max(ğ‘¡),
ğ›½min(ğ‘¡) â©½ ğ›½ â©½ ğ›½max(ğ‘¡),

(14)

(13)

where ğœ€min(ğ‘¡) = max{âˆ’ğœ‹âˆ•2, ğœƒğ‘¡(ğ‘¡)âˆ’ğ›¾e}, ğœ€max(ğ‘¡) = min{ğœ‹âˆ•2,
ğœƒğ‘¡(ğ‘¡) + ğ›¾e}, ğ›½min(ğ‘¡) = max{âˆ’ğœ‹, âˆ’ğœ“ğ‘¡(ğ‘¡) âˆ’ ğ›¾e}, and ğ›½max(ğ‘¡) =
min{ğœ‹, âˆ’ğœ“ğ‘¡(ğ‘¡) + ğ›¾e} are time-varying fuctions.

(a) Entry cone

(b) Field of view

Figure 2: Entry cone and the ï¬eld of view

2.2.4. Field of view constraint

As shown in Fig. 2(b), for an active chaser spacecraft
equipped with vision sensors, it should be guaranteed that
the vision sensors can obtain the information of the target.
The ï¬eld of view constraint is realized by limiting the atti-
tude angles of the chaser on the condition of accurate attitude
tracking. Consider the coupling, the ï¬eld of view constraint
is expressed as follows,

ğ‘

(ğ‘¡),
(ğ‘¡) < ğœƒğ‘ < ğœƒmax
(ğ‘¡) â©½ ğœ“ğ‘ â©½ ğœ“ max
ğ‘

âˆ’ğœ‹ â©½ ğœ™ğ‘ â©½ ğœ‹,
ğœƒmin
ğ‘
ğœ“ min
ğ‘

â§
âª
â¨
âª
â©
where ğœ™ğ‘, ğœƒğ‘, ğœ“ğ‘
= max{âˆ’ğœ‹âˆ•2, ğœ€(ğ‘¡) âˆ’ ğ›¾f }, ğœƒmax

(ğ‘¡),

ğ‘

are the attitude angles of the chaser, ğœƒmin

(ğ‘¡)
(ğ‘¡) = min{ğœ‹âˆ•2, ğœ€(ğ‘¡) + ğ›¾f },

ğ‘

(15)

ğ‘

(ğ‘¡) = max{âˆ’ğœ‹, ğ›½(ğ‘¡) âˆ’ ğ›¾f }, ğœ“ max
ğœ“ min
(ğ‘¡) = min{ğœ‹, ğ›½(ğ‘¡) +
ğ‘
ğ›¾f } are time-varying functions, and ğ›¾f
denotes half of the
angle of the ï¬eld of view. For understanding convenience,
the constraint of the pitch angle ğœƒğ‘
is taken as an example to
illustrate detailed. As shown in Fig. 3, the following relation
should be guaranteed, i.e.,

ğœƒğ‘ âˆ’ ğ›¾f â©½ ğœ€(ğ‘¡) â©½ ğœƒğ‘ + ğ›¾f .

The above relation can be rewritten as

ğœ€(ğ‘¡) âˆ’ ğ›¾f â©½ ğœƒğ‘ â©½ ğœ€(ğ‘¡) + ğ›¾f .

The construction of constraint on ğœ“ğ‘
process.

is similar to the above

Figure 3: Field of view constraint on the pitch angle

From the above process of modeling, the novel construc-
tions in this paper are more concise and without any lin-
ear approximation. Since the constraints are imposed on the
states directly, the on-board computational eï¬€orts and time-
delay are reduced without losing any control precision.

3. Sampling-based PWA model predictive

control
Model predictive control (MPC) is widely employed for
achieving optimal performance and treating various constraints.
At each sampling instant, the prediction is made by the plant
model, the basic idea of MPC is to take the prediction into
a constrained optimization index, converting the index to a
convex quadratic programming (QP) problem and minimiz-
ing it online to obtain a sequence of control input. Subse-
quently, only the control input related to the sampling instant
is applied, according to the receding horizon strategy.

To apply the above idea in a nonlinear system, one exist-
ing practice is to convert the continuous nonlinear model to
a pseudo linear form with the state matrix and control input
matrix are state-dependent, discretize it at each sampling in-
stant to get a linear time-invariant (LTI) model correspond-
ing to each interval of states, the set of discrete models is
the piecewise aï¬ƒne (PWA) model. By this way, we can

D. Li et al.: Preprint submitted to Elsevier

Page 4 of 14

TargetChaserğ›¾ğ‘’ TargetChaserğ›¾ğ‘“ TargetChaserğœ€(ğ‘¡1) ğœƒğ‘¡ Orbit planeğ›¾ğ‘“ ğœƒğ‘ ğœƒğ‘+ğ›¾ğ‘“  ğœƒğ‘âˆ’ğ›¾ğ‘“  ğœ€(ğ‘¡2) D. Li, R. Dong

utilize linear models corresponding to diï¬€ernet interval of
states to approximate the nonlinear model, then the control is
completed by a standard MPC. However, the error between
the predictions made by the approximate linear model and
the actual states cannot be neglected, especially with the in-
crease of prediction horizon. In this study, a method of re-
ducing this error is provided by an additional sampling con-
trol input. By determining the sampling direction from the
actual nonlinear model and adjusting the value of sampling
input, the proposed method can sample the predictions in the
closer neighborhood of the actual states.

3.1. Basic idea

The general process of nonlinear MPC based on the lin-
ear approximate model is given in Algorithm 1. Obviously,
the control performance depends on the accuracy of the pre-
dictions describing the actual states. Denote the ğ‘› step ahead
prediction obtained by the linear approximate model at ğ‘¡ğ‘˜+ğ‘›
as ğ‘¥l(ğ‘˜ + ğ‘›) (ğ‘› = 1, 2, â‹¯), and the actual state as ğ‘¥(ğ‘˜ + 1),
there exist error between ğ‘¥(ğ‘˜+ğ‘›) and ğ‘¥l(ğ‘˜+ğ‘›). Consider the
relation between the linear approximate model and the actual
nonlinear model at each sampling state, even if the speciï¬c
value of the error is unknown, the symbol of the error can
be obtained from the information of the nonlinear model.
Therefore, an addition sampling control input is introduced
as follows,

(16)

ğ‘¢s = ğ‘¤ssign( Ìˆğ‘¥) |ğ‘¢(ğ‘˜)| rand(1),
where ğ‘¤s âˆˆ [0, 1] is the sampling factor to control the
value of sampling input, sign( Ìˆğ‘¥) = Â±1 is an auxiliary item
of the actual nonlinear model to control the sampling direc-
, rand(â‹…)
tion, ğ‘¢(ğ‘˜) denotes the predictive control input at ğ‘¥ğ‘˜
is a random value. Since the optimal predictions made by
the linear approximate model that describe the actual states
are unknown, the random valueâ€™s eï¬€ect is to reduce the mean
error of all predictions. If the model is concave at ğ‘¥(ğ‘˜), the
predictive state ğ‘¥l(ğ‘˜+1) is lower than ğ‘¥(ğ‘˜+1) , the positive ğ‘¢ğ‘ 
can help to decrease the error. On the contrary, if the model
is convex at ğ‘¥(ğ‘˜), the predictive state ğ‘¥l(ğ‘˜ + 1) is larger than
ğ‘¥(ğ‘˜ + 1), the negative ğ‘¢ğ‘ 
can help to decrease the error. If
adopting the sampling control input at each sampling instant,
the proposed method can realize sampling the predictions in
the closer neighborhood of the actual nonlinear states.
Remark 1. Both the PWA model and linearized model (e.g.,
Taylor expansion) are belong to the way of approximating
nonlinear characteristics with linear model, it should be noted
that the approximating accuracy of Taylor expansion is higher
than the employed PWA model in this study. However, con-
sider the on-board computation eï¬€orts and real time per-
formance, it is enough for the PWA model to complete the
AR&D well. It should also be noted that the proposed strat-
egy is also applicable to cases of employing the model of
Taylor expansion, if the computaion cost are not considered
ï¬rstly.

Algorithm 1 General process of MPC
1: Denote the initial instant as ğ‘¡ğ‘˜
2: Make the prediction:

, the initial state as ğ‘¥(ğ‘˜).

forforfor ğ‘– = 1 âˆ¶ ğ‘ğ‘ƒ

endendend

update the linear approximate model ğ‘¡ğ‘˜+ğ‘–âˆ’1
compute the prediction ğ‘¥(ğ‘˜ + ğ‘–|ğ‘˜),

,

3: Optimization:

take the predictions [ğ‘¥(ğ‘˜ + 1), â‹¯ , ğ‘¥(ğ‘˜ + ğ‘ğ‘)]T
into the following optimization index to compute
[ğ‘¢(ğ‘˜), â‹¯ , ğ‘¢(ğ‘˜ + ğ‘ğ‘ âˆ’ 1)]T, with the constraints are sat-
isï¬ed,

ğ‘ğ‘
âˆ‘

ğ½ =

ğ‘–=1

[ğ‘¥(ğ‘˜ + ğ‘–|ğ‘˜) âˆ’ ğ‘¥d(ğ‘˜ + ğ‘–)]Tğ‘„ğ‘˜[ğ‘¥(ğ‘˜ + ğ‘–|ğ‘–) âˆ’ ğ‘¥d(ğ‘˜+
ğ‘ğ‘ âˆ’1
âˆ‘

ğ‘¢(ğ‘˜ + ğ‘–)Tğ‘ƒğ‘˜ğ‘¢(ğ‘˜ + ğ‘–).

ğ‘–)]+

ğ‘–=0
4: Receding horizon control:

adopt the ï¬rst element ğ‘¢(ğ‘˜) as the actual control input,
compute actual ğ‘¥(ğ‘˜ + 1).

5: Repeat step 2-4 at the next instants.
- prediction horizon; ğ‘ğ‘
- weight matrices; ğ‘¥d

Note:Note:Note: ğ‘ğ‘
and ğ‘ƒğ‘˜
ğ‘„ğ‘˜

- control horizon;

- the desired state.

corresponding to the state at ğ‘¡ğ‘˜
is obtained by helding the
system matrix and the control input matrix are constant dur-
ing each sampling interval.

Denote ğ‘¥ğ‘¥ğ‘¥l

ğ‘(ğ‘˜ + 1) as the one step ahead prediction of po-

sition state made by the PWA model,

(17)

ğ‘’ğ´c

ğ‘¥ğ‘¥ğ‘¥l
ğ‘(ğ‘˜ + 1) = ğ´ğ‘(ğ‘˜)ğ‘¥ğ‘¥ğ‘¥ğ‘(ğ‘˜) + ğµğ‘(ğ‘˜)ğ‘¢ğ‘¢ğ‘¢ğ‘(ğ‘˜),
where ğ´ğ‘(ğ‘˜) = ğ‘’ğ´c
ğ‘ğ‘‡ğ‘ , ğµğ‘(ğ‘˜) = (âˆ« ğ‘‡ğ‘ 
is
the sampling interval. In view of the sampling-based idea in
ğ‘(ğ‘˜ + 1) is obtained by
Section 3.1, the sampling prediction ğ‘¥ğ‘¥ğ‘¥s
applying the addition sampling input ğ‘¢ğ‘¢ğ‘¢s,p
ğ‘¥ğ‘¥ğ‘¥s
ğ‘(ğ‘˜ + 1) = ğ´ğ‘(ğ‘˜)ğ‘¥ğ‘¥ğ‘¥ğ‘(ğ‘˜) + ğµğ‘(ğ‘˜)ğ‘¢ğ‘¢ğ‘¢ğ‘(ğ‘˜) + ğµğ‘(ğ‘˜)ğ‘¢ğ‘¢ğ‘¢s,p(ğ‘˜),
where

ğ‘ğœ ğ‘‘ğœ)ğµc
ğ‘

, and ğ‘‡ğ‘ 

(18)

0

,

ğ‘¢ğ‘¢ğ‘¢s,p(ğ‘˜) = [ğ‘¢s,ğœŒ(ğ‘˜), ğ‘¢s,ğœ€(ğ‘˜), ğ‘¢s,ğ›½(ğ‘˜)]T,
with

(19)

ğ‘¢ğ‘,ğœŒ(ğ‘˜) |
ğ‘¢s,ğœŒ(ğ‘˜) = ğ‘¤s,ğœŒsign[ ÌˆğœŒ(ğ‘˜)] |
|
|
|
|
ğ‘¢ğ‘,ğœ€(ğ‘˜) |
ğ‘¢s,ğœ€(ğ‘˜) = ğ‘¤s,ğœ€sign[ Ìˆğœ€(ğ‘˜)] |
|
|
|
|
ğ‘¢s,ğ›½(ğ‘˜) = ğ‘¤s,ğ›½sign[ Ìˆğ›½(ğ‘˜)] |
ğ‘¢ğ‘,ğ›½(ğ‘˜) |
|
|
|
|

â§
âª
â¨
âª
â©
Combining (18) and (19), yields

rand(1),
rand(1),
rand(1).

ğ‘¥ğ‘¥ğ‘¥s
ğ‘(ğ‘˜ + 1) = ğ´ğ‘(ğ‘˜)ğ‘¥ğ‘¥ğ‘¥ğ‘(ğ‘˜) + ğµğ‘(ğ‘˜)ğ‘¢ğ‘¢ğ‘¢ğ‘(ğ‘˜) + ğµğ‘(ğ‘˜)ğ‘Šğ‘(ğ‘˜)ğ‘¢ğ‘¢ğ‘¢p(ğ‘˜),
(20)

where

3.2. Controller design

Consider the continous LOS dynamics (2), and discrete
(2) at each sampling instant, the approximate PWA model

ğ‘Šğ‘(ğ‘˜) = rand(1)

ğ‘¤s,ğœŒ
0
0

â›
âœ
âœ
â

0
ğ‘¤s,ğœ€
0

0
0
ğ‘¤s,ğ›½

â
âŸ
âŸ
â 

D. Li et al.: Preprint submitted to Elsevier

Page 5 of 14

sign[ ÌˆğœŒ(ğ‘˜)]
0
0

0
sign[ Ìˆğœ€(ğ‘˜)]
0

sign[ğ‘¢ğ‘,ğœŒ(ğ‘˜)]
0
0

0
sign[ğ‘¢ğ‘,ğœ€(ğ‘˜)]
0

0
0
sign[ Ìˆğ›½(ğ‘˜)]

â
âŸ
âŸ
â 
0
0
sign[ğ‘¢ğ‘,ğ›½(ğ‘˜)]

â‹…

â‹…

â›
âœ
âœ
â

â›
âœ
âœ
â

D. Li, R. Dong

Rewritting (24) in a compact form,

ğ‘¢ğ‘¢ğ‘¢âˆ—
ğ‘(ğ‘˜) = Î›ğ‘¢ğ‘¢ğ‘¢ğ‘(ğ‘˜ âˆ’ 1) + Î“Î”Ìƒğ‘¢ğ‘¢ğ‘¢ğ‘(ğ‘˜),

(25)

â
âŸ
âŸ
â 

(21)

ğ‘–=0 Î”ğ‘¢ğ‘¢ğ‘¢ğ‘(ğ‘˜+ğ‘–)|ğ‘–âŸ© âˆˆ â„3ğ‘ğ‘ , Î› = âˆ‘ğ‘ğ‘

where Î”Ìƒğ‘¢ğ‘¢ğ‘¢ğ‘(ğ‘˜) = âˆ‘ğ‘ğ‘ âˆ’1
ğ¼3|ğ‘–âŸ©
âˆˆ â„3ğ‘ğ‘ Ã—3, and Î“ âˆˆ â„3ğ‘ğ‘ Ã—3ğ‘ğ‘ is a lower triangular matrix
with Î“(ğ‘–, ğ‘—) = ğ¼3 (ğ‘– > ğ‘—). By adopting the control horizon as
ğ‘ğ‘

, rewritting (23) as

ğ‘–=1

where sign[ğ‘¢ğ‘,ğœŒ(ğ‘˜)], sign[ğ‘¢ğ‘,ğœ€(ğ‘˜)], sign[ğ‘¢ğ‘,ğ›½(ğ‘˜)] are obtained
from the relation between the current states and the next de-
sired states. If the next desired state is larger than the cur-
rent state, then the value of the symbolic function is 1, con-
versely, the symbol is âˆ’1.

By introducing an augmented vector ğ‘¥ğ‘¥ğ‘¥âˆ—
ahead predictions of ğ‘¥ğ‘¥ğ‘¥ğ‘(ğ‘˜) can be described as

ğ‘(ğ‘˜) âˆˆ â„6ğ‘ğ‘, the

ğ‘ğ‘

ğ‘(ğ‘˜) = [ğ‘¥ğ‘¥ğ‘¥s
ğ‘¥ğ‘¥ğ‘¥âˆ—
ğ‘

T(ğ‘˜ + 1|ğ‘˜), ğ‘¥ğ‘¥ğ‘¥s

ğ‘

T(ğ‘˜ + 2|ğ‘˜), â‹¯ , ğ‘¥ğ‘¥ğ‘¥s

ğ‘

T(ğ‘˜ + ğ‘ğ‘|ğ‘˜)]T.
(22)

By iteration, rewritting the above predictions in a compact
form, i.e.,

ğ‘(ğ‘˜) = ğ´âˆ—
ğ‘¥ğ‘¥ğ‘¥âˆ—

ğ‘ğ‘¥ğ‘¥ğ‘¥ğ‘(ğ‘˜) + Ì„ğµâˆ—

ğ‘ğ‘¢ğ‘¢ğ‘¢âˆ—

ğ‘ + Ì„ğµâˆ—

ğ‘

Ì„ğ‘Š âˆ—

ğ‘ (ğ‘˜)Ì„ğ‘¢ğ‘¢ğ‘¢âˆ—
p,

(23)

ğ‘ğ‘âˆ’1
where Ì„ğ‘Š âˆ—
ğ‘–=0
direct sum notation), ğ‘ğ‘

ğ‘ (ğ‘˜) = âŠ•

ğ‘Šğ‘(ğ‘˜ + ğ‘–) âˆˆ â„3ğ‘ğ‘Ã—3ğ‘ğ‘ (âŠ• is the
is the prediction horizon,

ğ´ğ‘(ğ‘˜)
ğ´ğ‘(ğ‘˜ + 1)ğ´ğ‘(ğ‘˜)
â‹®
ğ´ğ‘(ğ‘˜ + ğ‘–)

âˆğ‘ğ‘âˆ’1
ğ‘–=0

â
âŸ
âŸ
âŸ
âŸ
â 

âˆˆ â„6ğ‘ğ‘Ã—6,

ğµğ‘(ğ‘˜)
ğ´ğ‘(ğ‘˜+1)ğµğ‘(ğ‘˜)
â‹®

â‹¯
â‹±
â‹±
ğ´ğ‘(ğ‘˜+ğ‘–)ğµğ‘(ğ‘˜) â‹¯ ğµğ‘(ğ‘˜+ğ‘ğ‘ âˆ’1)

0
â‹®
â‹®

â
âŸ
âŸ
âŸ
âŸ
â 
âˆˆ â„6ğ‘ğ‘Ã—3ğ‘ğ‘,

âˆğ‘ğ‘âˆ’1
ğ‘–=1

â›
âœ
âœ
âœ
âœ
â

â›
âœ
âœ
âœ
âœ
â

ğ´âˆ—

ğ‘(ğ‘˜) =

Ì„ğµâˆ—

ğ‘ (ğ‘˜) =

and

p = [ğ‘¢ğ‘¢ğ‘¢ğ‘(ğ‘˜)T, ğ‘¢ğ‘¢ğ‘¢ğ‘(ğ‘˜ + 1)T, â‹¯ , ğ‘¢ğ‘¢ğ‘¢ğ‘(ğ‘˜ + ğ‘ğ‘ âˆ’ 1)T] âˆˆ â„3ğ‘ğ‘.
Ì„ğ‘¢ğ‘¢ğ‘¢âˆ—
However, in practical space missions, it will occupy too much
control inputs
on-board computing resource if adopting ğ‘ğ‘
to predict. In existing papers, the control horizon ğ‘ğ‘
is al-
ways lower than ğ‘ğ‘

Consider the response of the system is smoother if con-
trolling the increment of the input rather than the total in-
put [10]. Deï¬ne the recurive equation of ğ‘ğ‘
control inputs
ğ‘ âˆˆ â„3ğ‘ğ‘ as
ğ‘¢ğ‘¢ğ‘¢âˆ—

.

â§
ğ‘¢ğ‘¢ğ‘¢ğ‘(ğ‘˜) = Î”ğ‘¢ğ‘¢ğ‘¢ğ‘(ğ‘˜) + ğ‘¢ğ‘¢ğ‘¢ğ‘(ğ‘˜ âˆ’ 1),
âª
ğ‘¢ğ‘¢ğ‘¢ğ‘(ğ‘˜ + 1) = Î”ğ‘¢ğ‘¢ğ‘¢ğ‘(ğ‘˜ + 1) + Î”ğ‘¢ğ‘¢ğ‘¢ğ‘(ğ‘˜) + ğ‘¢ğ‘¢ğ‘¢ğ‘(ğ‘˜ âˆ’ 1),
âª
â¨
âª
ğ‘¢ğ‘¢ğ‘¢ğ‘(ğ‘˜ + ğ‘ğ‘ âˆ’ 1) = âˆ‘ğ‘ğ‘ âˆ’1
âª
â©

â‹®
ğ‘–=0 Î”ğ‘¢ğ‘¢ğ‘¢ğ‘(ğ‘˜ + ğ‘–) + ğ‘¢ğ‘¢ğ‘¢ğ‘(ğ‘˜ âˆ’ 1).

(24)

ğ‘(ğ‘˜) = ğ´âˆ—
ğ‘¥ğ‘¥ğ‘¥âˆ—

ğ‘ğ‘¥ğ‘¥ğ‘¥ğ‘(ğ‘˜) + ğµâˆ—

ğ‘ ğ‘Š âˆ—

ğ‘ ğ‘¢ğ‘¢ğ‘¢âˆ—

ğ‘ + ğµâˆ—

ğ‘ğ‘¢ğ‘¢ğ‘¢âˆ—
ğ‘,

(26)

where ğµâˆ—
, ğ‘Š âˆ—
ğ‘
ğ‘Šğ‘(ğ‘˜ + ğ‘–). Substituting (25) into (26), yields

columns of Ì„ğµâˆ—
ğ‘

is the ï¬rst 3ğ‘ğ‘

ğ‘ (ğ‘˜) = âŠ•ğ‘ğ‘ âˆ’1

ğ‘–=0

ğ‘(ğ‘˜) = ğ´âˆ—
ğ‘¥ğ‘¥ğ‘¥âˆ—

ğ‘ğ‘¥ğ‘¥ğ‘¥ğ‘(ğ‘˜)+(ğµâˆ—

ğ‘+ğµâˆ—

ğ‘ ğ‘Š âˆ—

ğ‘ )Î›ğ‘¢ğ‘¢ğ‘¢ğ‘(ğ‘˜âˆ’1)+(ğµâˆ—

ğ‘+ğµâˆ—

ğ‘ ğ‘Š âˆ—

ğ‘ )Î“Î”Ìƒğ‘¢ğ‘¢ğ‘¢ğ‘.
(27)

Deï¬ne the optimazation index as

min ğ½ (ğ‘˜) =

ğ‘ğ‘
âˆ‘

ğ‘–=1

â€–ğ‘¥ğ‘¥ğ‘¥ğ‘(ğ‘˜+ğ‘–)âˆ’ğ‘¥ğ‘¥ğ‘¥ğ‘‘,ğ‘(ğ‘˜+ğ‘–)â€–

2
ğ‘„+

ğ‘ğ‘ âˆ’1
âˆ‘

ğ‘–=0

â€–Î”ğ‘¢ğ‘¢ğ‘¢ğ‘(ğ‘˜+ğ‘–)â€–

2
ğ‘ƒ ,

(28)

where ğ‘¥ğ‘¥ğ‘¥ğ‘‘,ğ‘
denotes the desired state, ğ‘ƒ and ğ‘„ are the positive-
deï¬nite and semi-positive deï¬nite weight matrices, respec-
tively. Converting the above optimation index to the com-
pact form, i.e.,

min ğ½ ğ‘(ğ‘˜) = [ğ‘¥ğ‘¥ğ‘¥âˆ—

ğ‘(ğ‘˜)âˆ’ğ‘¥ğ‘¥ğ‘¥âˆ—

d,p(ğ‘˜)]ğ‘‡ Ìƒğ‘„[ğ‘¥ğ‘¥ğ‘¥âˆ—

ğ‘(ğ‘˜)âˆ’ğ‘¥ğ‘¥ğ‘¥âˆ—

d,p(ğ‘˜)]+Î”Ìƒğ‘¢ğ‘¢ğ‘¢ğ‘‡

ğ‘

Ìƒğ‘ƒ Î”Ìƒğ‘¢ğ‘¢ğ‘¢ğ‘,
(29)

where ğ‘¥ğ‘¥ğ‘¥âˆ—

d,p(ğ‘˜) = âˆ‘ğ‘ğ‘
ğ‘–=1
desired states, Ìƒğ‘„ = âŠ•

Deï¬ne

ğ‘¥ğ‘¥ğ‘¥d,p(ğ‘˜ + ğ‘–)|ğ‘–âŸ©
ğ‘ğ‘
ğ‘–=1

ğ‘„ and Ìƒğ‘ƒ = âŠ•ğ‘ğ‘
ğ‘–=1

ğ‘ƒ .

denotes the augmented

ğ¸ğ¸ğ¸ğ‘ = ğ‘¥ğ‘¥ğ‘¥âˆ—

d,p(ğ‘˜) âˆ’ ğ´âˆ—

ğ‘ğ‘¥ğ‘¥ğ‘¥ğ‘(ğ‘˜) âˆ’ (ğµâˆ—

ğ‘ + ğµâˆ—

ğ‘ ğ‘Š âˆ—

ğ‘ )Î›ğ‘¢ğ‘¢ğ‘¢ğ‘(ğ‘˜ âˆ’ 1),

(30)

and substitute (30) into (29), yields

minğ½ğ‘(ğ‘˜) = [(ğµâˆ—
âˆ’ğ¸ğ¸ğ¸ğ‘
Î”Ìƒğ‘¢ğ‘¢ğ‘¢ğ‘‡

ğ‘ +ğµâˆ—
]

ğ‘ )Î“Î”Ìƒğ‘¢ğ‘¢ğ‘¢ğ‘ âˆ’ğ¸ğ¸ğ¸ğ‘]ğ‘‡ Ìƒğ‘„
ğ‘ ğ‘Š âˆ—
Ìƒğ‘ƒ Î”Ìƒğ‘¢ğ‘¢ğ‘¢ğ‘
+Î”Ìƒğ‘¢ğ‘¢ğ‘¢ğ‘‡
ğ‘
ğ‘ ğ»ğ‘Î”Ìƒğ‘¢ğ‘¢ğ‘¢ğ‘ + ğ‘“ğ‘“ğ‘“ ğ‘‡

ğ‘ Î”Ìƒğ‘¢ğ‘¢ğ‘¢ğ‘‡

ğ‘ + ğ¸ğ¸ğ¸ğ‘‡
ğ‘

= 1
2

[

(ğµâˆ—

ğ‘ +ğµâˆ—

ğ‘ ğ‘Š âˆ—

ğ‘ )Î“Î”Ìƒğ‘¢ğ‘¢ğ‘¢ğ‘

Ìƒğ‘„ğ¸ğ¸ğ¸ğ‘,

(31)

ğ‘ ğ‘Š âˆ—

ğ‘ + ğµâˆ—

ğ‘ )Î“ + Ìƒğ‘ƒ ] and

ğ‘ + ğµâˆ—
ğ‘ ğ‘Š âˆ—

ğ‘ ğ‘Š âˆ—
ğ‘ )T Ìƒğ‘„ğ¸ğ¸ğ¸ğ‘

where ğ»ğ‘ = 2[Î“ğ‘‡ (ğµâˆ—
ğ‘ + ğµâˆ—
ğ‘“ğ‘“ğ‘“ ğ‘ = âˆ’2Î“T(ğµâˆ—

ğ‘ )T Ìƒğ‘„(ğµâˆ—
.
The process of applying the sampling-based PWA MPC
to the attitude dynamics is similar to the above process. Con-
sider the attitude dynamics (8), introduce an augmented state
vector ğ‘¥ğ‘¥ğ‘¥âˆ—
ahead prediction
states of ğ‘¥ğ‘¥ğ‘¥ğ‘(ğ‘˜). According to the iterative relation, rewrite
the prediction states ğ‘¥ğ‘¥ğ‘¥âˆ—

ğ‘(ğ‘˜) âˆˆ â„6ğ‘ğ‘, which represent ğ‘ğ‘

ğ‘(ğ‘˜) in a compact form such that,
ğ‘ ğ‘Š âˆ—

ğ‘ + ğµâˆ—

ğ‘ğ‘¢ğ‘¢ğ‘¢âˆ—
ğ‘,

ğ‘ ğ‘¢ğ‘¢ğ‘¢âˆ—

(32)

ğ‘(ğ‘˜) = ğ´âˆ—
ğ‘¥ğ‘¥ğ‘¥âˆ—

ğ‘ğ‘¥ğ‘¥ğ‘¥ğ‘(ğ‘˜) + ğµâˆ—

D. Li et al.: Preprint submitted to Elsevier

Page 6 of 14

D. Li, R. Dong

Ìƒğ‘Ÿğ‘Ÿğ‘Ÿsafe = âˆ‘ğ‘ğ‘
described in (12).

ğ‘–=1

ğ‘Ÿğ‘Ÿğ‘Ÿsafe|ğ‘–âŸ© âˆˆ â„ğ‘ğ‘ is the augmented vector of ğ‘Ÿğ‘Ÿğ‘Ÿsafe

Substituting (27) into (39), yields

ğºğ‘Î”Ìƒğ‘¢ğ‘¢ğ‘¢ğ‘ â©½ ğ‘”ğ‘”ğ‘”ğ‘,

where

ğºğ‘ = âˆ’ Ìƒğ‘“ğ‘“ğ‘“ 1(ğµâˆ—
ğ‘ + ğµâˆ—
ğ‘”ğ‘”ğ‘”ğ‘ = âˆ’Ìƒğ‘Ÿğ‘Ÿğ‘Ÿsafe + Ìƒğ‘“ğ‘“ğ‘“ 1ğ´âˆ—

ğ‘ ğ‘Š âˆ—
ğ‘ )Î“,
ğ‘ğ‘¥ğ‘¥ğ‘¥ğ‘(ğ‘˜)+ Ìƒğ‘“ğ‘“ğ‘“ 1(ğµâˆ—

ğ‘ +ğµâˆ—

ğ‘ ğ‘Š âˆ—

ğ‘ )Î›ğ‘¢ğ‘¢ğ‘¢ğ‘(ğ‘˜âˆ’1).

3.3.3. Entry Cone Constraint

The entry cone constraint is described by

Ìƒğ‘„ğ¸ğ¸ğ¸ğ‘,

(35)

Ìƒğœ€ğœ€ğœ€max(ğ‘˜) â©½ Ìƒğ‘“ğ‘“ğ‘“ 2ğ‘¥ğ‘¥ğ‘¥âˆ—

ğ‘(ğ‘˜) â©½ Ìƒğœ€ğœ€ğœ€max(ğ‘˜),

(40)

(41)

(42)

(ğ‘˜) =

(43)

and

Ìƒğ›½ğ›½ğ›½max

(ğ‘˜) â©½ Ìƒğ‘“ğ‘“ğ‘“ 3ğ‘¥ğ‘¥ğ‘¥âˆ—

ğ‘(ğ‘˜) â©½ Ìƒğ›½ğ›½ğ›½max

(ğ‘˜),

with ğ‘“ğ‘“ğ‘“ 2 = [0, 1, 0, 0, 0, 0],
with ğ‘“ğ‘“ğ‘“ 3 = [0, 0, 1, 0, 0, 0]. Ìƒğœ€ğœ€ğœ€min(ğ‘˜) =
is the augmented vector of ğœ€min(ğ‘˜) shown

âŠ— ğ‘“ğ‘“ğ‘“ 2

where Ìƒğ‘“ğ‘“ğ‘“ 2 = ğ¸ğ‘ğ‘
Ìƒğ‘“ğ‘“ğ‘“ 3 = ğ¸ğ‘ğ‘
âŠ— ğ‘“ğ‘“ğ‘“ 3
âˆ‘ğ‘ğ‘
ğœ€min(ğ‘˜+ğ‘–)|ğ‘–âŸ©
ğ‘–=1
in (15). Similarly, Ìƒğœ€ğœ€ğœ€max(ğ‘˜) = âˆ‘ğ‘ğ‘
ğ‘–=1
âˆ‘ğ‘ğ‘
(ğ‘˜) = âˆ‘ğ‘ğ‘
ğ‘–=1
ğ‘–=1

ğ›½min(ğ‘˜ + ğ‘–)|ğ‘–âŸ©

, Ìƒğ›½ğ›½ğ›½max
Substituting (27) into (41) and (42), i.e.,

ğœ€max(ğ‘˜ + ğ‘–)|ğ‘–âŸ©

, Ìƒğ›½ğ›½ğ›½min
.
ğ›½max(ğ‘˜ + ğ‘–)|ğ‘–âŸ©

ğºğ‘’1Î”Ìƒğ‘¢ğ‘¢ğ‘¢ğ‘ â©½ ğ‘”ğ‘”ğ‘”ğ‘’1,

where

ğºğ‘’1 =

ğ‘”ğ‘”ğ‘”ğ‘’1 =

and

)

( Ìƒğ‘“ğ‘“ğ‘“ 2(ğµâˆ—
ğ‘ +ğµâˆ—
âˆ’ Ìƒğ‘“ğ‘“ğ‘“ 2(ğµâˆ—
ğ‘ +ğµâˆ—
( Ìƒğœ€ğœ€ğœ€max(ğ‘˜)âˆ’ Ìƒğ‘“ğ‘“ğ‘“ 2[ğ´âˆ—
âˆ’Ìƒğœ€ğœ€ğœ€min(ğ‘˜)+ Ìƒğ‘“ğ‘“ğ‘“ 2[ğ´âˆ—

ğ‘ ğ‘Š âˆ—
ğ‘ )Î“
ğ‘ ğ‘Š âˆ—
ğ‘ )Î“
ğ‘ğ‘¥ğ‘¥ğ‘¥ğ‘(ğ‘˜)+(ğµâˆ—
ğ‘ğ‘¥ğ‘¥ğ‘¥ğ‘(ğ‘˜)+(ğµâˆ—

,

ğ‘ +ğµâˆ—
ğ‘ +ğµâˆ—

ğ‘ ğ‘Š âˆ—
ğ‘ ğ‘Š âˆ—

ğ‘ )Î›ğ‘¢ğ‘¢ğ‘¢ğ‘(ğ‘˜âˆ’1)]
ğ‘ )Î›ğ‘¢ğ‘¢ğ‘¢ğ‘(ğ‘˜âˆ’1)]

)

.

where the form of ğ´âˆ—
ğ‘
ğ‘Š âˆ—
ğ‘

, and ğ‘Š âˆ—
, ğµâˆ—
ğ‘
ğ‘
in (26). Consider the following optimazation index,

are similar to ğ´âˆ—
ğ‘

, ğµâˆ—
ğ‘

and

min ğ½ ğ‘(ğ‘˜) = [ğ‘¥ğ‘¥ğ‘¥âˆ—

ğ‘(ğ‘˜)âˆ’ğ‘¥ğ‘¥ğ‘¥âˆ—

d,a(ğ‘˜)]T Ìƒğ‘„[ğ‘¥ğ‘¥ğ‘¥âˆ—

ğ‘(ğ‘˜)âˆ’ğ‘¥ğ‘¥ğ‘¥âˆ—

d,a(ğ‘˜)]+Î”Ìƒğ‘¢ğ‘¢ğ‘¢T

ğ‘

Ìƒğ‘ƒ Î”Ìƒğ‘¢ğ‘¢ğ‘¢ğ‘,
(33)

d,a(ğ‘˜) = âˆ‘ğ‘ğ‘
where ğ‘¥ğ‘¥ğ‘¥âˆ—
ğ‘–=1
desired states. Deï¬ne

ğ‘¥ğ‘¥ğ‘¥d,a(ğ‘˜ + ğ‘–)|ğ‘–âŸ©

denotes the augmented

d,a(ğ‘˜) âˆ’ ğ´âˆ—

ğ‘ + ğµâˆ—
ğ¸ğ¸ğ¸ğ‘ = ğ‘¥ğ‘¥ğ‘¥âˆ—
and substitute (34) into (33), yields

ğ‘ğ‘¥ğ‘¥ğ‘¥ğ‘(ğ‘˜) âˆ’ (ğµâˆ—

ğ‘ ğ‘Š âˆ—

ğ‘ )Î›ğ‘¢ğ‘¢ğ‘¢ğ‘(ğ‘˜ âˆ’ 1),

(34)

minğ½ğ‘(ğ‘˜) =

1
2

Î”Ìƒğ‘¢ğ‘¢ğ‘¢T

ğ‘ ğ»ğ‘Î”Ìƒğ‘¢ğ‘¢ğ‘¢ğ‘ + ğ‘“ğ‘“ğ‘“ T

ğ‘ Î”Ìƒğ‘¢ğ‘¢ğ‘¢T

ğ‘ + ğ¸ğ¸ğ¸T
ğ‘

where ğ»ğ‘ = 2[Î“ğ‘‡ (ğµâˆ—
ğ‘“ğ‘“ğ‘“ ğ‘ = âˆ’2Î“T(ğµâˆ—
ğ‘ + ğµâˆ—

ğ‘ )T Ìƒğ‘„(ğµâˆ—
ğ‘ + ğµâˆ—
ğ‘ ğ‘Š âˆ—
ğ‘ )T Ìƒğ‘„ğ¸ğ¸ğ¸ğ‘
.
ğ‘ ğ‘Š âˆ—

ğ‘ + ğµâˆ—

ğ‘ ğ‘Š âˆ—

ğ‘ )Î“ + Ìƒğ‘ƒ ],

3.3. Constraints reconï¬guration

Based on Section 2.3, the constraints related with the
ğ‘(ğ‘˜) which are employed in
augmented vectors ğ‘¥ğ‘¥ğ‘¥âˆ—
the convex QP problem are reconï¬gured in this subsection.

ğ‘(ğ‘˜) and ğ‘¥ğ‘¥ğ‘¥âˆ—

3.3.1. Control input constraints

The control input constraint of thrusters is described as,

âˆ’Ìƒğ‘¢ğ‘¢ğ‘¢max

ğ‘ â©½ Î›ğ‘¢ğ‘¢ğ‘¢ğ‘(ğ‘˜ âˆ’ 1) + Î“Î”Ìƒğ‘¢ğ‘¢ğ‘¢ğ‘ â©½ Ìƒğ‘¢ğ‘¢ğ‘¢max

ğ‘

,

(36)

ğ‘ = âˆ‘ğ‘ğ‘
ğ‘¢ğ‘¢ğ‘¢max
ğ‘
deï¬ned in (10).

where Ìƒğ‘¢ğ‘¢ğ‘¢max
of ğ‘¢ğ‘¢ğ‘¢max
ğ‘
Converting (36) to the following form,

ğ‘–=1

|ğ‘–âŸ© âˆˆ â„3ğ‘ğ‘ is the augmented vector

ğºğ‘Î”Ìƒğ‘¢ğ‘¢ğ‘¢ğ‘ â©½ ğ‘”ğ‘”ğ‘”ğ‘,ğ‘

where

(37)

ğºğ‘ =

(

)

Î“
âˆ’Î“

, ğ‘”ğ‘”ğ‘”ğ‘,ğ‘ =

( Ìƒğ‘¢ğ‘¢ğ‘¢max
ğ‘ âˆ’ Î›ğ‘¢ğ‘¢ğ‘¢ğ‘(ğ‘˜ âˆ’ 1)
Ìƒğ‘¢ğ‘¢ğ‘¢max
ğ‘ + Î›ğ‘¢ğ‘¢ğ‘¢ğ‘(ğ‘˜ âˆ’ 1)

)

.

Similarly, the control input constraint on the reaction wheels

is given by

ğºğ‘Î”Ìƒğ‘¢ğ‘¢ğ‘¢ğ‘ â©½ ğ‘”ğ‘”ğ‘”ğ‘,ğ‘

where

ğºğ‘ =

(

)

Î“
âˆ’Î“

, ğ‘”ğ‘”ğ‘”ğ‘,ğ‘ =

( Ìƒğ‘¢ğ‘¢ğ‘¢max
ğ‘ âˆ’ Î›ğ‘¢ğ‘¢ğ‘¢ğ‘(ğ‘˜ âˆ’ 1)
Ìƒğ‘¢ğ‘¢ğ‘¢max
ğ‘ + Î›ğ‘¢ğ‘¢ğ‘¢ğ‘(ğ‘˜ âˆ’ 1)

)

.

(38)

ğºğ‘’2Î”Ìƒğ‘¢ğ‘¢ğ‘¢ğ‘ â©½ ğ‘”ğ‘”ğ‘”ğ‘’2,

(44)

where

ğºğ‘’2 =

( Ìƒğ‘“ğ‘“ğ‘“ 3(ğµâˆ—
âˆ’Ìƒğ‘“ğ‘“ğ‘“ 3(ğµâˆ—

)

,

ğ‘ +ğµâˆ—
ğ‘ ğ‘Š âˆ—
ğ‘ +ğµâˆ—
ğ‘ ğ‘Š âˆ—
(ğ‘˜)âˆ’ Ìƒğ‘“ğ‘“ğ‘“ 3[ğ´âˆ—
(ğ‘˜)+ Ìƒğ‘“ğ‘“ğ‘“ 3[ğ´âˆ—

ğ‘ )Î“
ğ‘ )Î“
ğ‘ğ‘¥ğ‘¥ğ‘¥ğ‘(ğ‘˜)+(ğµâˆ—
ğ‘ğ‘¥ğ‘¥ğ‘¥ğ‘(ğ‘˜)+(ğµâˆ—

( Ìƒğ›½ğ›½ğ›½max
âˆ’Ìƒğ›½ğ›½ğ›½min

ğ‘ +ğµâˆ—
ğ‘ +ğµâˆ—

ğ‘ ğ‘Š âˆ—
ğ‘ ğ‘Š âˆ—

ğ‘ )Î›ğ‘¢ğ‘¢ğ‘¢ğ‘(ğ‘˜âˆ’1)]
ğ‘ )Î›ğ‘¢ğ‘¢ğ‘¢ğ‘(ğ‘˜âˆ’1)]

)

.

where Ìƒğ‘¢ğ‘¢ğ‘¢max
of ğ‘¢ğ‘¢ğ‘¢max
ğ‘

ğ‘ = âˆ‘ğ‘ğ‘
ğ‘¢ğ‘¢ğ‘¢max
ğ‘
described in (11).

ğ‘–=1

|ğ‘–âŸ© âˆˆ â„3ğ‘ğ‘ is the augmented vector

ğ‘”ğ‘”ğ‘”ğ‘’2 =

3.3.2. Collision avoidance constraint

The collision avoidance constraint is reconï¬gurated as

follows,

3.3.4. Field of view constraints
The constraint on the ğ‘ğ‘

reconï¬gurated as

predictions of the roll angle is

Ìƒğ‘“ğ‘“ğ‘“ 1ğ‘¥ğ‘¥ğ‘¥âˆ—

ğ‘(ğ‘˜) â‰¥ Ìƒğ‘Ÿğ‘Ÿğ‘Ÿsafe,
where Ìƒğ‘“ğ‘“ğ‘“ 1 = ğ¸ğ‘ğ‘
necker product of two matrices, ğ¸ğ‘ğ‘
tity matrix with ğ‘ğ‘

âŠ— ğ‘“ğ‘“ğ‘“ 1 âˆˆ â„ğ‘ğ‘Ã—6ğ‘ğ‘ with âŠ— being the Kro-
âˆˆ â„ğ‘ğ‘Ã—ğ‘ğ‘ is an iden-
dimention, ğ‘“ğ‘“ğ‘“ 1 = [1, 0, 0, 0, 0, 0], and

D. Li et al.: Preprint submitted to Elsevier

(39)

âˆ’ Ìƒğœ‹ğœ‹ğœ‹ â©½ Ìƒğ‘“ğ‘“ğ‘“ 1ğ‘¥ğ‘¥ğ‘¥âˆ—

ğ‘(ğ‘˜) â©½ Ìƒğœ‹ğœ‹ğœ‹,

(45)

where Ìƒğœ‹ğœ‹ğœ‹ = âˆ‘ğ‘ğ‘
ğ‘–=1

ğºğ‘“ 1Î”Ìƒğ‘¢ğ‘¢ğ‘¢ğ‘ â©½ ğ‘”ğ‘”ğ‘”ğ‘“ 1,

. Substituting (32) into (45), yields

ğœ‹|ğ‘–âŸ©

(46)

Page 7 of 14

D. Li, R. Dong

where ğºâˆ—
ğ‘’2]T.
ğ‘”ğ‘”ğ‘”T

where

ğºğ‘“ 1 =

ğ‘”ğ‘”ğ‘”ğ‘“ 1 =

)

,

( Ìƒğ‘“ğ‘“ğ‘“ 1(ğµâˆ—
âˆ’ Ìƒğ‘“ğ‘“ğ‘“ 1(ğµâˆ—
( Ìƒğœ‹ğœ‹ğœ‹ âˆ’ Ìƒğ‘“ğ‘“ğ‘“ 1[ğ´âˆ—
âˆ’Ìƒğœ‹ğœ‹ğœ‹ + Ìƒğ‘“ğ‘“ğ‘“ 1[ğ´âˆ—

ğ‘ + ğµâˆ—
ğ‘ ğ‘Š âˆ—
ğ‘ )Î“
ğ‘ + ğµâˆ—
ğ‘ ğ‘Š âˆ—
ğ‘ )Î“
ğ‘ğ‘¥ğ‘¥ğ‘¥ğ‘(ğ‘˜)+(ğµâˆ—
ğ‘ğ‘¥ğ‘¥ğ‘¥ğ‘(ğ‘˜)+(ğµâˆ—

The constraint on the ğ‘ğ‘

is reconï¬gurated as

)

ğ‘ ğ‘Š âˆ—
ğ‘ ğ‘Š âˆ—

ğ‘ +ğµâˆ—
ğ‘ )Î›ğ‘¢ğ‘¢ğ‘¢ğ‘(ğ‘˜âˆ’1)]
ğ‘ +ğµâˆ—
ğ‘ )Î›ğ‘¢ğ‘¢ğ‘¢ğ‘(ğ‘˜âˆ’1)]
predictions of the pitch angle

.

Ìƒğœƒğœƒğœƒmin
ğ‘

(ğ‘˜) â©½ Ìƒğ‘“ğ‘“ğ‘“ 2ğ‘¥ğ‘¥ğ‘¥âˆ—

ğ‘(ğ‘˜) â©½ Ìƒğœƒğœƒğœƒmax

ğ‘

(ğ‘˜),

(47)

where Ìƒğœƒğœƒğœƒmin
of ğœƒmin
ğ‘
(ğ‘˜ + ğ‘–)|ğ‘–âŸ©

(ğ‘˜) = âˆ‘ğ‘ğ‘
ğ‘–=1

ğœƒmin
ğ‘
ğ‘
(ğ‘˜) described in (15). Similarly, Ìƒğœƒğœƒğœƒmax
. Substituting (32) into (47), yields

is the augmented vector
(ğ‘˜) = âˆ‘ğ‘ğ‘
ğ‘–=1

(ğ‘˜+ğ‘–)|ğ‘–âŸ©

ğœƒmax
ğ‘

ğ‘

ğºğ‘“ 2Î”Ìƒğ‘¢ğ‘¢ğ‘¢ğ‘ â©½ ğ‘”ğ‘”ğ‘”ğ‘“ 2,

(48)

where

ğºğ‘“ 2 =

ğ‘”ğ‘”ğ‘”ğ‘“ 2 =

( Ìƒğ‘“ğ‘“ğ‘“ 2(ğµâˆ—
âˆ’ Ìƒğ‘“ğ‘“ğ‘“ 2(ğµâˆ—

)

,

ğ‘ + ğµâˆ—
ğ‘ + ğµâˆ—
(ğ‘˜)âˆ’ Ìƒğ‘“ğ‘“ğ‘“ 2[ğ´âˆ—
(ğ‘˜)+ Ìƒğ‘“ğ‘“ğ‘“ 2[ğ´âˆ—

ğ‘ ğ‘Š âˆ—
ğ‘ )Î“
ğ‘ ğ‘Š âˆ—
ğ‘ )Î“
ğ‘ğ‘¥ğ‘¥ğ‘¥ğ‘(ğ‘˜)+(ğµâˆ—
ğ‘ğ‘¥ğ‘¥ğ‘¥ğ‘(ğ‘˜)+(ğµâˆ—

( Ìƒğœƒğœƒğœƒmax
ğ‘
âˆ’Ìƒğœƒğœƒğœƒmin
ğ‘

ğ‘ +ğµâˆ—
ğ‘ +ğµâˆ—

ğ‘ ğ‘Š âˆ—
ğ‘ ğ‘Š âˆ—

ğ‘ )Î›ğ‘¢ğ‘¢ğ‘¢ğ‘(ğ‘˜âˆ’1)]
ğ‘ )Î›ğ‘¢ğ‘¢ğ‘¢ğ‘(ğ‘˜âˆ’1)]

)
.

The constraint on the ğ‘ğ‘

reconï¬gurated as follows,

predictions of the yaw angle is

Ìƒğœ“ğœ“ğœ“ min
ğ‘

(ğ‘˜) â©½ Ìƒğ‘“ğ‘“ğ‘“ 3ğ‘¥ğ‘¥ğ‘¥âˆ—

ğ‘(ğ‘˜) â©½ Ìƒğœ“ğœ“ğœ“ max

ğ‘

(ğ‘˜),

(49)

where Ìƒğœ“ğœ“ğœ“ min
ğœ“ max
ğ‘

ğ‘
(ğ‘˜ + ğ‘–)|ğ‘–âŸ©

(ğ‘˜) = âˆ‘ğ‘ğ‘
ğ‘–=1

(ğ‘˜ + ğ‘–)|ğ‘–âŸ©
. Substituting (32) into (49), gives,

, and Ìƒğœ“ğœ“ğœ“ max

ğœ“ min
ğ‘

ğ‘

(ğ‘˜) = âˆ‘ğ‘ğ‘
ğ‘–=1

ğºğ‘“ 3Î”Ìƒğ‘¢ğ‘¢ğ‘¢ğ‘ â©½ ğ‘”ğ‘”ğ‘”ğ‘“ 3,

(50)

where

ğºğ‘“ 3 =

ğ‘”ğ‘”ğ‘”ğ‘“ 3 =

( Ìƒğ‘“ğ‘“ğ‘“ 3(ğµâˆ—
âˆ’ Ìƒğ‘“ğ‘“ğ‘“ 3(ğµâˆ—

)

,

ğ‘ + ğµâˆ—
ğ‘ + ğµâˆ—
(ğ‘˜)âˆ’ Ìƒğ‘“ğ‘“ğ‘“ 3[ğ´âˆ—
(ğ‘˜)+ Ìƒğ‘“ğ‘“ğ‘“ 3[ğ´âˆ—

ğ‘ ğ‘Š âˆ—
ğ‘ )Î“
ğ‘ ğ‘Š âˆ—
ğ‘ )Î“
ğ‘ğ‘¥ğ‘¥ğ‘¥ğ‘(ğ‘˜)+(ğµâˆ—
ğ‘ğ‘¥ğ‘¥ğ‘¥ğ‘(ğ‘˜)+(ğµâˆ—

( Ìƒğœ“ğœ“ğœ“ max
ğ‘
âˆ’Ìƒğœ“ğœ“ğœ“ min
ğ‘

ğ‘ +ğµâˆ—
ğ‘ +ğµâˆ—

ğ‘ ğ‘Š âˆ—
ğ‘ ğ‘Š âˆ—

ğ‘ )Î›ğ‘¢ğ‘¢ğ‘¢ğ‘(ğ‘˜âˆ’1)]
ğ‘ )Î›ğ‘¢ğ‘¢ğ‘¢ğ‘(ğ‘˜âˆ’1)]

)

.

3.4. Implement of sampling-based PWA MPC

Consider the optimization index (31) and (35) derivated
by the sampling-based PWA MPC strategy, and the recon-
ï¬guration of constraints on the relative position states and
the attitude states, the optimal control problem over the pre-
dictive horizon can be converted to the following standard
QP problems,

Î”Ìƒğ‘¢ğ‘¢ğ‘¢ğ‘ = argÎ”ğ‘¢ğ‘¢ğ‘¢ğ½ğ‘(ğ‘˜),

s.t.

ğ‘¥ğ‘¥ğ‘¥ğ‘(ğ‘˜|ğ‘˜) = ğ‘¥ğ‘¥ğ‘¥ğ‘(ğ‘˜),
â§
âª
ğ‘¥ğ‘¥ğ‘¥âˆ—
ğ‘(ğ‘˜) = ğ´âˆ—
ğ‘ğ‘¥ğ‘¥ğ‘¥ğ‘(ğ‘˜) + ğµâˆ—
â¨
ğ‘ƒ Î”Ìƒğ‘¢ğ‘¢ğ‘¢ğ‘ â©½ ğ‘”ğ‘”ğ‘”âˆ—
ğºâˆ—
âª
ğ‘ƒ ,
â©

ğ‘ ğ‘Š âˆ—

ğ‘ ğ‘¢ğ‘¢ğ‘¢âˆ—

ğ‘ + ğµâˆ—

ğ‘ğ‘¢ğ‘¢ğ‘¢âˆ—
ğ‘,

(51)

ğ‘ƒ = [ğºT

ğ‘,ğ‘, ğºT

ğ‘ , ğºT
ğ‘’1

, ğºT

ğ‘’2]T, ğ‘”ğ‘”ğ‘”âˆ—

ğ‘ƒ = [ğ‘”ğ‘”ğ‘”T

ğ‘,ğ‘, ğ‘”ğ‘”ğ‘”T

ğ‘ , ğ‘”ğ‘”ğ‘”T
ğ‘’1

,

For the attitude controller, the optimal control problem

is converted to the following standard QP problem,

Î”Ìƒğ‘¢ğ‘¢ğ‘¢ğ‘ = argÎ”ğ‘¢ğ‘¢ğ‘¢ğ½ğ‘(ğ‘˜),

s.t.

ğ‘¥ğ‘¥ğ‘¥ğ‘(ğ‘˜|ğ‘˜) = ğ‘¥ğ‘¥ğ‘¥ğ‘(ğ‘˜),
â§
âª
ğ‘¥ğ‘¥ğ‘¥âˆ—
ğ‘(ğ‘˜) = ğ´âˆ—
ğ‘ğ‘¥ğ‘¥ğ‘¥ğ‘(ğ‘˜) + ğµâˆ—
â¨
ğ´Î”Ìƒğ‘¢ğ‘¢ğ‘¢ğ‘ â©½ ğ‘”ğ‘”ğ‘”âˆ—
ğºâˆ—
âª
ğ´,
â©

ğ‘ ğ‘Š âˆ—

ğ‘ ğ‘¢ğ‘¢ğ‘¢âˆ—

ğ‘ + ğµâˆ—

ğ‘ğ‘¢ğ‘¢ğ‘¢âˆ—
ğ‘,

(52)

ğ‘,ğ‘, ğºT
ğ‘“ 1

ğ´ = [ğºT

where ğºâˆ—
, ğºT
,
ğ‘“ 3]T. Then the optimal control input in the optimization
ğ‘”ğ‘”ğ‘”T
problem can be solved by a QP solver.

ğ‘“ 3]T, ğ‘”ğ‘”ğ‘”âˆ—

ğ´ = [ğ‘”ğ‘”ğ‘”T

ğ‘,ğ‘, ğ‘”ğ‘”ğ‘”T
ğ‘“ 1

, ğºT
ğ‘“ 2

, ğ‘”ğ‘”ğ‘”T
ğ‘“ 2

4. Rendezvous and docking strategy
4.1. AR&D strategy

Ì‡ğœŒğ‘‘(ğ‘¡),

Ì‡ğœƒğ‘¡(ğ‘¡),

Ì‡ğœƒğ‘¡(ğ‘¡),

Ì‡ğœ™ğ‘¡(ğ‘¡),

In this paper, the control objective is to track the time-
varying position and attitude of the targetâ€™s docking port.
Consider the coupling between the position and attitude, the
desired state of relative position is described by [ğœŒğ‘‘(ğ‘¡), ğœƒğ‘¡(ğ‘¡),
Ì‡ğœ“ğ‘¡(ğ‘¡)]T, the desired state of relative posi-
ğœ“ğ‘¡(ğ‘¡),
tion is described by [ğœ™ğ‘¡(ğ‘¡), ğœƒğ‘¡(ğ‘¡), ğœ“ğ‘¡(ğ‘¡),
Ì‡ğœ“ğ‘¡(ğ‘¡)]T
with the ï¬eld of view constraint being related with the az-
imuth and angle and the elevation angle. In practical space
missions, the AR&D mission is divided into a rendezvous
phase and a docking phase.
In the rendezvous phase, the
chaser is driven to a safe position around the target, approach-
ing rapidity is mainly concerned. Subsequently, the chaser
is controlled to track the targetâ€™s docking port. More focus
is put on the safe-docking, which is realized through con-
straining the approach velocity, entry cone, and the keep-out
zone. Besides, since there exist sensor uncertainty in prac-
tice, existing paper [18] has stated that the uncertainty can
be described by Guassian distributions with certain standard
deviation, the Kalman ï¬lter can be combined with the pro-
posed sampling-based PWA MPC framework. To focus on
the eï¬€ect of proposed sampling-based PWA MPC and con-
strains construction, this study directly control the chaser to
track the targetâ€™s docking port without a two-phase AR&D
process.

4.2. Singularity-free strategy

As shown in Fig. 4, the singularity of the angle states
means two values represent a same position physically but
diï¬€er widely in mathematics. Once the desired tracking state
reaches the singularity, the actual state can not track the next
jump desired state immediately, which greatly limit the ap-
plication of the LOS dynamics and Euler dynamics in the
6-DOF pose tracking. In this subsection, a singularity-free
strategy is provided. Denote a control period as the period
before the state reaches the singular point, the basic idea is to
design a mechanism which can automatically reset the con-
troller to a new control period. The speciï¬c practice is to

D. Li et al.: Preprint submitted to Elsevier

Page 8 of 14

D. Li, R. Dong

choose the correct value from diï¬€erent singular values ac-
cording to the continuity of motion, and reset the mathemat-
ical expression of the state (doesnâ€™t change physically) once
it reaches the singular point. The previous tracking error in
the ï¬nal instant of the previous period is regarded as the ini-
tial error of the new period.

Figure 4: Singularity of angle state

There exist two situations in a tracking problem as fol-
lows. Assume that the desired state is monotonic and wonâ€™t
repeatedly switch in the neighbourhood of the singuar point.
One situaton is the desired state reaches the singualr point
but the actual state doesnâ€™t. The other is the actual state
reaches the singular point but the desired state doesnâ€™t. For
the ï¬rst situation, we reset the mathematical expression of
the desired state temporarily to ensure the actual state moves
in the original direction until the actual state reaches the sin-
gularity. For the second situation, we reset the actual state
ï¬rstly, and change the mathematical expression of the de-
sired state temporarily to ensure the actual state moves in
the original direction until desired state reaches the singu-
larity. The detailed strategy of singularity-free is presented
in Algorithm 2.

It should be noted that the discrete state canâ€™t always
reach the singular point precisely. Our method is to set a
neighborhood ï¬eld near the singular point, once the state
reaches the neighborhood, we consider the state reaches the
In this way, there exists in-
singular point approximatly.
evitable error, our approach is to calculate the previous error
in the ï¬nal instant of the previous period and take it as the
initial error of the new period.

5. Numerical simulations

To illustrate the advantages of the proposed strategies,
numerical simulations of diï¬€erent AR&D scenarios are pre-
sented. Consider diï¬€erent conditions of the targetâ€™s motion,
we investigate two cases. In case 1, the rotation of the tum-
bling target is assumed to be uncontrolled. In case 2, we
consider a more general situation that the angular velocity
of the tumbling target changes regularly under control. The
absolute position of the target is considered not change, since
the whole process wonâ€™t take long time.

Assuming the target is running in an elliptical orbit, with
the eccentricity ğ‘’ is 0.3, semi-major axis ğ‘ is 10000 km,
initial true anomaly ğ‘“ is 0 deg, and the initial position of
the target is assumed at the perigee. The dimension of the
target is 6 m Ã— 6 m Ã— 6 m. The coordinate of the targetâ€™s
docking port is assumed [0.5, 0, 0]Tm in the body frame

or 1

is increasing} then

Algorithm 2 Singularity-free strategy
Ensure: ğ‘¥ âˆˆ [âˆ’ğ‘›ğ‘¥ğœ‹, ğ‘›ğ‘¥ğœ‹] with ğ‘›ğ‘¥ = 1
2
1: if {ğ‘¥d
2:
3:
4:
5:

ğ‘– = 1
repeat

ğ‘¥d(ğ‘˜ + ğ‘–) â‡ ğ‘¥d(ğ‘˜ + ğ‘–) + 2ğ‘›ğ‘¥ğœ‹
ğ‘– â‡ ğ‘– + 1

if { ğ‘¥d(ğ‘˜) = ğ‘›ğ‘¥ğœ‹ && ğ‘¥(ğ‘˜) < ğ‘›ğ‘¥ğœ‹ } then

until ğ‘¥(ğ‘˜ + ğ‘) = ğ‘›ğ‘¥ğœ‹
ğ‘¥(ğ‘˜ + ğ‘ + 1) â‡ âˆ’ğ‘›ğ‘¥ğœ‹

else { ğ‘¥d(ğ‘˜) < ğ‘›ğ‘¥ğœ‹ && ğ‘¥(ğ‘˜) = ğ‘›ğ‘¥ğœ‹ }

ğ‘¥(ğ‘˜ + 1) = âˆ’ğ‘›ğ‘¥ğœ‹
ğ‘– = 1
repeat

ğ‘¥d(ğ‘˜ + ğ‘–) â‡ ğ‘¥d(ğ‘˜ + ğ‘–) âˆ’ 2ğ‘›ğ‘¥ğœ‹
ğ‘– â‡ ğ‘– + 1

until ğ‘¥d(ğ‘˜ + ğ‘) = ğ‘›ğ‘¥ğœ‹

is decreasing}

if { ğ‘¥d(ğ‘˜) = âˆ’ğ‘›ğ‘¥ğœ‹ && ğ‘¥(ğ‘˜) > ğ‘›ğ‘¥ğœ‹ } then

12:
13:
14:
15:
16:
end if
17: else {ğ‘¥d
18:
19:
20:
21:
22:

ğ‘– = 1
repeat

ğ‘¥d(ğ‘˜ + ğ‘–) â‡ ğ‘¥d(ğ‘˜ + ğ‘–) âˆ’ 2ğ‘›ğ‘¥ğœ‹
ğ‘– â‡ ğ‘– + 1

until ğ‘¥(ğ‘˜ + ğ‘) = âˆ’ğ‘›ğ‘¥ğœ‹
ğ‘¥(ğ‘˜ + ğ‘ + 1) â‡ ğ‘›ğ‘¥ğœ‹

else { ğ‘¥d(ğ‘˜) > âˆ’ğ‘›ğ‘¥ğœ‹ && ğ‘¥(ğ‘˜) = âˆ’ğ‘›ğ‘¥ğœ‹ }

ğ‘¥(ğ‘˜ + 1) = ğ‘›ğ‘¥ğœ‹
ğ‘– = 1
repeat

ğ‘¥d(ğ‘˜ + ğ‘–) â‡ ğ‘¥d(ğ‘˜ + ğ‘–) + 2ğ‘›ğ‘¥ğœ‹
ğ‘– â‡ ğ‘– + 1

until ğ‘¥d(ğ‘˜ + ğ‘) = âˆ’ğ‘›ğ‘¥ğœ‹

28:
29:
30:
31:
32:
33: end if

end if

6:
7:
8:
9:
10:
11:

23:
24:
25:
26:
27:

ğ‘ğ‘¡

ğ‘ğ‘¡

ğ‘ğ‘¡

ğ‘ğ‘¡

is 30, the control horizon ğ‘ğ‘

îˆ²
is
. The chaserâ€™s inertia matrix in the body frame îˆ²
diag(50, 35, 40) kg â‹… m2. The wheelsâ€™ inertia matrix in the
is diag(5, 5, 5) kg â‹… m2. The dimension of
body frame îˆ²
the chaser is 6 m Ã— 6 m Ã— 6 m. The coordinate of the chaserâ€™s
docking port is assumed [âˆ’0.5, 0, 0]Tm in the body frame
îˆ²

.
For the parameters in the sampling-based PWA MPC, the
prediction horizon ğ‘ğ‘
is 15, the
sampling factor is (0.4, 0.25, 0.25). The simulation dura-
tion is set as 500 s and the sampling interval ğ‘‡ğ‘ 
is 0.1 s. The
weight matrices ğ‘ƒ and ğ‘„ in the relative position controller is
set as diag(100, 100, 100) and diag(1000, 30000, 30000,
1000âˆ•ğœŒ, 3000âˆ•ğœŒ, 3000âˆ•ğœŒ). The weight matrices ğ‘ƒ and ğ‘„
in the relative attitude controller are set diag(100, 100, 100)
and diag (30000, 30000, 30000, 3000, 3000, 3000). In this
study, the neighbourhood of the singularity is set as [âˆ’90ğ‘–,
âˆ’90ğ‘– + 0.5] deg and[90ğ‘– âˆ’ 0.5, 90ğ‘–] deg for ğ‘– = 1, 2. The
state is considered reaches the singularity once it is within
the neighbourhood. The AR&D conditions are shown in Ta-
ble 1.

D. Li et al.: Preprint submitted to Elsevier

Page 9 of 14

 180 deg-180 deg0 deg180 deg0 deg-180 degDesired stateActual state without singularity-freeActual state with singularity-freeDesired stateD. Li, R. Dong

(a) Tracking performance of elevation and azimuth

(b) Detailed performance of elevation

(c) Detailed performance of azimuth

(d) The LOS range

Figure 5: Elevation and azimuth racking performance of the position of the uncontrolled target

(a) The error in LVLH frame

(b) The RV&D process

Figure 6: Position tracking shown in the LVLH frame

5.1. Case 1: AR&D with an uncontrolled tumbling

target

In this case, the chaser is driven to track the pose of an
uncontrolled tumbling target, the angular velocity of which
is set as [0.02, 0.015, 0.02]T radâˆ•s in this case. The sampling-
based PWA MPC is employed to complete this mission, and
the performance of sampling-based PWA MPC is compared
with that of the standard NMPC based on the approximate
PWA model.

As shown in Fig. 5, the performance of relative position
tracking of the targetâ€™s docking port is presented. Both the

standard NMPC and sampling-based PWA MPC can track
the time-varying signals in about 10 s of the 500 s simu-
lation time. However, the sampling-based PWA MPC can
realize smaller overshoot and faster convergence rate, on the
condition of all constraints are satisï¬ed. Fig. 6 shows the
AR&D process of employing sampling-based NMPC in the
LVLH frame, Fig. 6a presents that the tracking error of the
time-varying docking port is less than 2 Ã— 10âˆ’3 (m), and Fig.
6b shows the 3-D process of the tracking. It can be seen that
the proposed controller can achieve better rendezvous per-
formance.

Fig. 7 shows the attitude tracking performance without

D. Li et al.: Preprint submitted to Elsevier

Page 10 of 14

050100150200250300350400450500-40-20020406080Elevation (deg)Sampling-based PWA MPCDesired stateStandard PWA MPC050100150200250300350400450500Time (s)-100-500Azimuth (deg)Sampling-based PWA MPCDesired stateStandard NMPC0510152025Time (s)010203040Elevation (deg)Sampling-based PWA MPCDesired stateStandard PWA MPC0510152025Time (s)-30-20-1001020304050Azimuth (deg)Sampling-based PWA MPCDesired stateStandard PWA MPC0100200300400500Time (s)020406080LOS range (m)Sampling-based PWA MPCDesired stateStandard PWA MPC0100200300400500Time (s)-1-0.500.51Error of position (m)Error-XError-YError-Z202530-20210-3D. Li, R. Dong

Figure 7: Attitude tracking without singularity-free

Figure 8: Attitude tracking with singularity-free

singularity-free strategy, it can be seen that the tracking can
not be achieved once the desired state reaces the singular-
ity. Fig. 8 shows the tracking performance by adopting the
singularity-free strategy, the result shows that the proposed
strategy can cross the singularity smoothly, and the tracking
takes less than 5 s of the 500 s simulation time. In addition,

Fig. 9 presents the tracking error of the attitude, however,
since we reset the controller to a new control period, the ini-
tial error is inevitable. It can be seen that the tracking er-
ror ï¬‚uctuates once the state reaches the singular point, the
tracking error can realize lower than 0.05 deg in one control
period, and less than 0.6 deg when the controller is reset to a

(a) Tracking error of roll

(b) Tracking error of pitch

(c) Tracking error of yaw

Figure 9: The tracking error of the attitude with an uncontrolled target

D. Li et al.: Preprint submitted to Elsevier

Page 11 of 14

50100150200250300350400450500-1000100Roll (deg)Actual stateDesired state50100150200250300350400450500-200204060Pitch (deg)Actual stateDesired state50100150200250300350400450500Time (s)-150-100-500Yaw (deg)Actual stateDesired state50100150200250300350400450500-1000100Roll (deg)70717273-180-17550100150200250300350400450500-200204060Pitch (deg)50100150200250300350400450500Time (s)-100-500Yaw (deg)Actual stateDesired state050100150200250300350400450500Time (s)-1-0.8-0.6-0.4-0.200.20.40.60.81Error of roll (deg)Actual stateDesired state050100150200250300350400450500Time (s)-1-0.8-0.6-0.4-0.200.20.40.60.81Error of pitch (deg)Actual stateDesired state0100200300400500Time (s)-1-0.500.51Error of yaw (deg)Actual stateDesired stateD. Li, R. Dong

(a) Attitude control input

(c) The control input

Figure 10: The control inputs

(a) Tracking performance of elevation and azimuth

(b) Detailed performance of elevation

(c) Detailed performance of azimuth

(d) The LOS range

Figure 11: Tracking performance of the position of a controlled target

new period. Fig. 10 shows that the input constrains on both
the position and the attitude are satisï¬ed.

5.2. Case 2: AR&D with a controlled tumbling

target

In this case, a more general scenario is considered, i.e.,
the tumbling target is under controlled. The target â€™s angular
velocity is set as [0.04ğ‘ ğ‘–ğ‘›( ğœ‹ğ‘¡
)]T
100
radâˆ•s in this case. As shown in Fig. 11, the performance of
relative position tracking of the targetâ€™s docking port is pre-

) , 0.04ğ‘ ğ‘–ğ‘›( 2ğœ‹ğ‘¡
100

) , 0.04ğ‘ ğ‘–ğ‘›( 3ğœ‹ğ‘¡
100

sented. Both the standard NMPC and sampling-based PWA
MPC can track the time-varying signals in less than 15 s
of the 500 s simulation time. However, the sampling-based
PWA MPC can realize smaller overshoot and faster conver-
gence rate, on the condition of all constraints are satisï¬ed.
Fig. 12 shows the AR&D process of employing sampling-
based PWA MPC in the LVLH frame, it can be seen that
the proposed strategy can realize better rendezvous. The
tracking error of the time-varying docking port is less than
4 Ã— 10âˆ’3 (m). Fig. 13 shows the tracking performance of

D. Li et al.: Preprint submitted to Elsevier

Page 12 of 14

0100200300400500Time (s)-1.5-1-0.500.511.5Control input (N)0100200300400500Time (s)-4-3-2-101234Control input (N)050100150200250300350400450500-50050Elevation (deg)Sampling-based PWA MPCDesired stateStandard PWA MPC050100150200250300350400450500Time (s)-50050100Azimuth (deg)Sampling-based PWA MPCDesired stateStandard NMPC0510152025Time (s)010203040Elevation (deg)Sampling-based PWA MPCDesired stateStandard PWA MPC0510152025Time (s)-30-20-1001020304050Azimuth (deg)Sampling-based PWA MPCDesired stateStandard PWA MPC0100200300400500Time (s)020406080LOS range (m)Sampling-based PWA MPCDesired stateStandard PWA MPCD. Li, R. Dong

(a) The error in LVLH frame

(b) The RV&D process

Figure 12: Position tracking shown in the LVLH frame

Figure 13: Attitude tracking of a controlled target

the controlled attitude. Fig.14 shows the attitude tracking
error, the result shows that the controller can track the time-
varying signals in less than 5 s of the 500 s simulation time.
In addition, the tracking error can realize lower than about
0.05 deg of tracking the controlled target. Fig. 15 shows that
the input constrains on both the position and the attitude are
satisï¬ed.

6. Conclusion

This paper proposes a sampling-based PWA predictive
control strategy to control a chaser spacecraft to dock with
a tumbling target. To reduce the on-board computation ef-
forts and directly use the output of the navigation system, the
3-D LOS dynamics and the Euler attitude dynamics are em-
ployed together to realize the 6-DOF pose tracking. It has
been shown that the novel constructions of the constraints
based on the adopted states are more concise and without

(a) Tracking error of roll

(b) Tracking error of pitch

(c) Tracking error of yaw

Figure 14: The tracking performance of the attitude

D. Li et al.: Preprint submitted to Elsevier

Page 13 of 14

0100200300400500Time (s)-1-0.500.51Error of position (m)Error-XError-YError-Z455055-4-202410-3501001502002503003504004505000204060Roll (deg)Actual stateDesired state50100150200250300350400450500-2002040Pitch (deg)50100150200250300350400450500Time (s)020406080Yaw (deg)050100150200250300350400450500Time (s)-1-0.8-0.6-0.4-0.200.20.40.60.81Error of roll (deg)Actual stateDesired state050100150200250300350400450500Time (s)-1-0.8-0.6-0.4-0.200.20.40.60.81Error of pitch (deg)Actual stateDesired state0100200300400500Time (s)-1-0.500.51Error of yaw (deg)Actual stateDesired stateD. Li, R. Dong

(a) Attitude control input

(c) The control input

Figure 15: The control inputs

Table 1
AR&D conditions

Parameters

Value

Initial attitude state

Initial position state

ğœŒ = 80 m, ğœ€ = 25 deg, ğ›½ = âˆ’10 deg
Ì‡ğœ€ = Ì‡ğ›½ = 0 degâˆ•s
Ì‡ğœŒ = 0 mâˆ•s,
ğœ™ğ‘ = 20 deg, ğœƒğ‘ = 25 deg, ğœ“ğ‘ = âˆ’10 deg
Ì‡ğœ™ğ‘ = Ì‡ğœƒğ‘ = Ì‡ğœ“ğ‘ = 0 degâˆ•s
ğ‘¢ğ‘¢ğ‘¢max
ğ‘ = [3, 3, 3]T, ğ‘¢ğ‘¢ğ‘¢max
Control input
ğ‘Ÿsafe = 6 m
Keep-out zone
Entry cone constraint ğ›¾ğ‘’ = 30 deg
Field of view constraintğ›¾ğ‘“ = 30 deg

ğ‘ = [1, 1, 1]T

any linear approximation. It can be seen from the simulation
results that: (1) compared with the standard NMPC frame-
work, the sampling-based PWA MPC strategy can realize
faster tracking and less overshoot in the continuous pose track-
ing, while satisfying the constraints; (2) the proposed AR&D
strategy can complete 6-DOF pose tracking well; (3) the con-
troller can realize singularity-free.

Future work based on this paper may include: (1) im-
provement of the robustness of the sampling-based PWA MPC;
(2) consider the position-attitude coupling in the AR&D and
take corresponding measures to deal with it.

References
[1] Thomas M. Davis and David Melanson. Xss-10 microsatellite ï¬‚ight
demonstration program results.
In Jr. Peter Tchoryk and Melissa
Wright, editors, Spacecraft Platforms and Infrastructure. SPIE, aug
2004.

[2] Isao Kawano, Masaaki Mokuno, Toru Kasai, and Takashi Suzuki.
Result of autonomous rendezvous docking experiment of engineer-
ing test satellite-vii. Journal of Spacecraft and Rockets, 38:105â€“111,
2001.

[3] David A. Whelan, E. A. Adler, Samuel B. Wilson III, and Jr. Gordon
M. Roesler. Darpa orbital express program: eï¬€ecting a revolution in
space-based systems. In Brian J. Horais and Robert J. Twiggs, editors,
Small Payloads in Space. SPIE, nov 2000.

[4] Mayne and Q. David. Model predictive control: Recent developments

and future promise. Automatica, 50(12):2967â€“2986, 2014.

[5] D Q Mayne, James B Rawlings, Christopher V Rao, and P O M

Scokaert. Survey constrained model predictive control: Stability and
optimality. Automatica, 36(6):789â€“814, 2000.

[6] Qi Li, Jianping Yuan, Bo Zhang, and Chen Gao. Model predictive
control for autonomous rendezvous and docking with a tumbling tar-
get. Aerospace Science and Technology, 69:700â€“711, 2017.

[7] Peng Li and Zheng H Zhu. Model predictive control for spacecraft
rendezvous in elliptical orbit. Acta Astronautica, 146:339â€“348, 2018.
[8] Francisco Gavilan, Rafael Vazquez, and E F Camacho. Chance-
constrained model predictive control for spacecraft rendezvous with
disturbance estimation. Control Engineering Practice, 20(2):111â€“
122, 2012.

[9] Avishai Weiss, Morgan Baldwin, R S Erwin, and Ilya Kolmanovsky.
Model predictive control for spacecraft rendezvous and docking:
Strategies for handling constraints and case studies. IEEE Transac-
tions on Control Systems and Technology, 23(4):1638â€“1647, 2015.

[10] Peng Li and Zheng H Zhu. Line-of-sight nonlinear model predictive
control for autonomous rendezvous in elliptical orbit. Aerospace Sci-
ence and Technology, 69:236â€“243, 2017.

[11] N.L. Ricker and J.H. Lee. Nonlinear model predictive control of the
tennessee eastman challenge process. Computers & Chemical Engi-
neering, 19(9):961â€“981, sep 1995.

[12] Jing Zeng, Ding Yu Xue, and De Cheng Yuan. Multi-model predic-
tive control of nonlinear systems. Journal of Northeastern University,
30(1):26â€“29, 2009.

[13] Vincent A. Akpan and George D. Hassapis. Nonlinear model identi-
ï¬cation and adaptive model predictive control using neural networks.
Isa Transactions, 50(2):177â€“194, 2011.

[14] S Piche and B Sayyar-Rodsari. Nonlinear model predictive control

using neural networks. IEEE Control Systems, 20(3):53â€“62, 2000.

[15] Unsik Lee and Mehran Mesbahi. Constrained autonomous precision
landing via dual quaternions and model predictive control. Journal of
Guidance Control and Dynamics, 40(2):292â€“308, 2017.

[16] Hyungjoo Yoon and Brij N. Agrawal. Novel expressions of equations
of relative motion and control in keplerian orbits. Journal of Guid-
ance, Control, and Dynamics, 32(2):664â€“669, mar 2009.

[17] Yu Wang and Haibo Ji. Integrated relative position and attitude con-
trol for spacecraft rendezvous with iss and ï¬nite-time convergence.
Aerospace Science and Technology, 85:234â€“245, 2019.

[18] Lichao Ma, Xiuyun Meng, Zaozhen Liu, and Lifu Du. Suboptimal
power-limited rendezvous with ï¬xed docking direction and collision
avoidance. Journal of Guidance Control and Dynamics, 36(1):229â€“
239, 2013.

D. Li et al.: Preprint submitted to Elsevier

Page 14 of 14

0100200300400500Time (s)-1.5-1-0.500.511.5Control input (N)0100200300400500Time (s)-4-2024Control input (N)