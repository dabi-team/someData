1
2
0
2

c
e
D
0
1

]
E
M

.
t
a
t
s
[

1
v
8
6
4
5
0
.
2
1
1
2
:
v
i
X
r
a

TAKING ADVANTAGE OF SAMPLING DESIGNS IN BAYESIAN
SPATIAL SMALL AREA SURVEY STUDIES.

A PREPRINT

Carlos Vergara-Hernández
Vaccine research area
FISABIO foundation
Valencia (Spain)
vergara_car@gva.es

Marc Marí-Dell’Olmo
Environmental Quality and Intervention Service
Agència de Salut Pública de Barcelona
Barcelona (Spain)
mmari@aspb.cat

Laura Oliveras
Environmental Quality and Intervention Service
Agència de Salut Pública de Barcelona
Barcelona (Spain)
lolivera@aspb.cat

Miguel A. Martinez-Beneito
Department of Statistics and Operations Research.
University of Valencia.
Burjassot (Spain).
and
Joint research unit FISABIO-UV for the analysis of biomedical data
miguel.a.martinez@uv.es

December 13, 2021

ABSTRACT

Spatial small area estimation models have become very popular in some contexts, such as disease
mapping. Data in disease mapping studies are exhaustive, that is, the available data are supposed to
be a complete register of all the observable events. In contrast, some other small area studies do not
use exhaustive data, such as survey based studies, where a particular sampling design is typically
followed and inferences are later extrapolated to the entire population. In this paper we propose a
spatial model for small area survey studies, taking advantage of spatial dependence between units,
which is the key assumption used for yielding reliable estimates in exhaustive data based studies.
In addition, and in contrast to most spatial survey studies, we take the approach of also considering
information on the sampling design and additional supplementary variables in order to yield small
area estimates. This makes it possible to merge spatial and sampling based approaches into a common
proposal.

Keywords small area estimation · spatial statistics · Bayesian hierarchical models · survey studies

1

Introduction

Spatial statistics has historically devoted considerable effort to deriving reasonable statistical estimates which take
into account the geographic nature of the units of study. When sparse information is available, or simply when
spatial dependence is strong, spatial models usually yield substantially improved estimates, which overcome many
of the estimation problems that non-spatial small area methods entail. Unfortunately, spatial methods have usually
focused on the modeling of outcome variables, as for example in the disease mapping literature [1], rather than on

 
 
 
 
 
 
A PREPRINT - DECEMBER 13, 2021

covariates that could be used in subsequent regression models, which could explain the variability found in some spatial
outcome variable. This limits the use of ecological regression models that could explain outcomes due to the scarcity of
covariates with important potential explanatory capabilities. A clear example of this setting is lifestyle habits covariates
in ecological regression problems, for which exhaustive population information rarely exists and these can be known at
best throughout sampling-based health surveys. In this regard, taking advantage of spatial information in health surveys,
or sampling-based surveys in general, becomes an important applied and methodological problem.

Frequently, survey studies follow particular sampling designs in order to achieve a desired precision for their estimates
over the entire region of study or for some geographic/demographic groups. Nevertheless, if small area inference is
pursued, these groups rarely coincide with those small areas since this would typically require huge sample sizes in
order to achieve the desired precisions. This produces several problems when these surveys are used for inference at a
small area level (smaller than that used for the sampling design), such as areas without any sampled unit or areas with
unacceptably high variability on (direct) estimates of interest. In this context the use of spatial models is crucial.

In addition, when a sampling design has been followed, ignoring that design for inference seems a questionable
choice since the available sample (and estimates) may thus no longer be representative of the overall population,
over- or under-representing some population groups and thereby producing potentially biased or misleading results.
As a solution, sampling theory proposes alternative estimates that take the followed sampling scheme into account.
Therefore, taking the sampling design into account seems, in principle, as important as considering spatial dependence
in small area studies; thus, model proposals which consider both features would be very welcome. However, regretfully,
sampling designs in small area studies are typically planned for coarser spatial units than those considered, so most of
the available sampling theory in the literature does not apply, at least in a direct manner, to small area studies.

Small area estimation literature has already dealt with sampling-based estimates for that geographical level. "This
problem has been studied by many authors, albeit without much reference to the spatial nature of the geographical
problem" (Lawson (2018) [2], page 197), in addition to the evident beneﬁts that spatial dependence brings in the small
area context, as evidenced in the disease mapping literature. The small area estimation literature can be divided into two
main approaches: design-based and model-based estimates. Design-based estimates rely on the inclusion probability of
each individual in the sample, taking this factor into account by means of sampling weights (see for example Hansen
and Hurwitz (1943)[3] or Horvitz and Thompson (1952) [4]). In contrast, model-based estimates use some kind of
model in order to take the sampling design into account [5]. Nevertheless, spatial approaches to survey-based small
area estimation usually follow hybrid approaches where (non-spatial) design-based estimates are derived, which take
the sampling design followed into account, and spatial dependence is later induced on these estimates by means of a
(spatial) smoothing model [6, 7, 8]. Although the uncertainty in the ﬁrst stage of these models is usually considered for
the second stage, the different processes modelled in both phases could interact; however, that interaction can hardly
be corrected in these two-phase proposals. On the other hand, pure model-based estimates have also been proposed
for survey-based small area estimation. From the Bayesian point of view, these models make use of hierarchical
models in order to shrink group estimates that are based on a small number of statistical units [9, 10, 11]. Even though
the ﬂexibility of this approach makes it a very natural framework for inducing spatial dependence, at the same time
that survey design issues could also be taken into account, while at the same time also taking survey design issues
into account, spatial dependence has rarely been considered within this approach. In this paper we will follow the
model-based approach, with the particular goal of including both survey design information and spatial dependence, at
the same time, in our estimates.

Our general goal with this paper is to derive some sensible inference procedure for small area survey studies. As speciﬁc
goals, we also intend to take spatial dependence and the sampling design into account in order to take advantage of these
important features for our estimates. Furthermore, as a second speciﬁc goal, we also aim for such a procedure to allow
inferences to be made at a small area level, smaller than that originally planned for the sampling design. Speciﬁcally,
we will try to take advantage of the information used for the sampling plan and, if possible, all the related additional
information that allowed us to yield enhanced estimators, including as much information as possible. In this paper we
will focus on the speciﬁc, but frequently observed, case of estimating proportions of a binary variable in a collection
of geographical units. Additionally, we will also assume that we will have some categorical auxiliary variables that
will be helpful, or that simply should be considered by sampling design in order to improve those proportion estimates.
The case of numerical output variables or covariates is left for future work, although the studied setting covers a high
proportion of real settings in practice.

The paper in organized as follows. Section 2 introduces our approach in the trivial case of simple random sampling,
where no particular sampling design is used to draw the survey sample. This section includes a real case study where
several estimation proposals are compared. This will be the cornerstone for more complex sampling designs. Section 3
generalizes the simple framework introduced in Section 2 to more complex sampling designs. In particular, we show
how to proceed in the very common setting of having a stratiﬁed random sample or if we wanted to use additional

2

A PREPRINT - DECEMBER 13, 2021

auxiliary variables for our inference. Section 3 also ends with a reanalysis of the case study analyzed in Section 2,
incorporating the complexities considered in this new section. Finally, the paper concludes in Section 4 with a summary
of some conclusions.

2 Small area inference under simple random sampling

Let us assume I (small) spatial units of study, neighborhoods of a city from now on, for example, in accordance with
the following case studies. Let Y ∈ {0, 1} be a random variable, whose mean (proportion of 1s in the corresponding
population) we would be interested to know for each of the I mentioned spatial units. Let us also assume that Y has
been observed for just a sample of individuals for each spatial unit, sampled under simple random sampling (SRS) for
all these neighborhoods. We will denote the corresponding sample size for each neighborhood as ni (i = 1, . . . , I) of
a total of Ni (i = 1, . . . , I) individuals living in each of those neighborhoods. In that case, under a sampling theory
perspective, we would like to know, or estimate from our sample, the proportions πi = E(Yi) = N −1
j=1 Yij where
Yij stands for the observed value of Y for the j-th individual of neighborhood i.
Under SRS, those proportions may be estimated as simply the sample mean ˆπSRS
Yij of Y
at each neighborhood, where ∂i indexes the set of individuals of neighborhood i which have been sampled. This
elemental result can be found, for example, on page 35 of Lohr (2010) [12], among many other sampling theory books.
Nevertheless, we will reference sampling theory results according to Lohr’s book (adding the corresponding book page)
to be more precise about our citations. The sample mean in that scenario can be shown to be an unbiased estimator of
each πi (see page 52 of Lohr (2010) [12]), with variance:

= ¯Yi· = (ni)−1 (cid:80)

(cid:80)Ni

j∈∂i

i

i

(cid:100)V ar(ˆπSRS

i

) =

ˆπSRS
i

(1 − ˆπSRS

i

)

ni

(1 −

ni
Ni

),

(1)

where the second term in this product takes into account the ﬁnite population nature of each neighborhood (page 36 of
Lohr (2010) [12]). Additionally, motivated by the hypothetical Normality of sample means for large sample sizes, a
100(1 − α)% conﬁdence interval for πi is frequently derived as simply ˆπSRS
is the 1 − α/2 quantile of a t distribution with ni − 1 degrees of freedom (page 43 of Lohr (2010) [12]).
The ˆπSRS = (ˆπSRS
example, it can be easily shown that ˆπSRS
model:

) estimator may also be justiﬁed from other points of view beyond sampling theory. For
is also the maximum likelihood estimator (MLE) of πi for the frequentist

), where t1−α/2

(cid:100)V ar(ˆπSRS

, . . . , ˆπSRS

± t1−α/2

(cid:113)

1

I

i

i

i

and is also the MLE for the abridged version of this model:

Yij ∼ Bernoulli(πi), i = 1, . . . , I; j ∈ ∂i,

Oi ∼ Binomial(πi, ni), i = 1, . . . , I,

where Oi = (cid:80)ni
j=1 Yij. In addition, under a Bayesian perspective, ˆπSRS may be also viewed as the posterior mode of
the models with either of the two previous data likelihoods and with πi, i = 1, . . . , I, independently distributed with
U nif orm(0, 1) prior distributions. This is a consequence of the equivalence of the frequentist MLE and the Bayesian
posterior mode when independent uniform prior distributions are used for the components of π. These results further
support the convenience and use of ˆπSRS as an (unbiased) estimator of π under SRS.
According to all this, ˆπSRS may be considered an unquestionable estimator of π under SRS. Nevertheless, this estimate
may sometimes not be so well suited. Speciﬁcally, when the spatial units of study are small, ˆπSRS may become
unreliable (excesive variance) and yield inappropriate estimates. This is something similar to what happens in disease
mapping studies where the most common risk estimator, Standardized Mortality Ratio (SMR), given by Oi/Ei where
Oi and Ei are the corresponding observed and expected deaths for unit i, is discouraged for small area studies. SMRs
also coincide with the MLE of λ for the model:

Oi ∼ P oisson(λiEi), i = 1, . . . , I,

or the mode of the Bayesian model assuming that same data likelihood and λi ∼ U nif orm(0, ∞), i = 1, . . . , I (page
111 of [1]). This illustrates the parallelism between the small area estimation problems of ˆπSRS and those of SMRs in
their different contexts.

A large body of literature has been published in the disease mapping area that tries to ﬁx the small area estimation
problems described. The main proposals to overcome the problems inherent in that approach come from Bayesian
hierarchical models, where the independent uniform prior distributions for the components of λ are susbtitued by a
spatial prior distribution. That distribution shares information between neighboring units and therefore uses neighbors’

3

A PREPRINT - DECEMBER 13, 2021

information for each area as a secondary information source, therebore yielding more reliable risk estimates. Different
conditional auto-regressive (CAR) distributions have been proposed for this purpose, such as the intrinsic CAR [13] or
lCAR distributions [14], or even the combination of spatial and non-spatial processes [15].

Something similar could be proposed to estimate π in survey sampling contexts, as introduced above, to improve the
ˆπSRS traditional estimates. Being more precise, we could estimate the proportions π as the estimates arising from the
following Bayesian hierarchical model:

Yij ∼ Bernoulli(π∗
i ) = µ + θi

logit(π∗

i ), i = 1, . . . , I; j ∈ ∂i

. . .

where θ = (θ1, . . . , θI ) is a vector of spatially structured random effects following, for example, one of the CAR-based
spatial processes mentioned. For this spatial model the population proportions πi could be estimated as:

ˆπSpatial
i

=

ni
Ni

( ¯Ysampled)i +

Ni − ni
Ni

( ¯Yunsampled)i,

(2)

where ( ¯Ysampled)i and ( ¯Yunsampled)i correspond, respectively, to the mean for the sampled and unsampled populations
for the i-th spatial unit. The ﬁrst term on the right hand side of this expression is known for each neighborhood and the
second term can be sampled from the corresponding predictive distribution of the model for each step of the MCMC
process. This estimator takes into account the ﬁnite sample feature of each proportion since when the sample size grows,
the ﬁrst component of the previous expression, which has no uncertainty, increases its weight, reducing therefore the
variability of ˆπSpatial
. In any event, if the sampled population fraction (ni/Ni) is small, ˆπSpatial
will be very similar
to the model parameters π∗

i , so these values could alternatively be used as πi estimates for simplicity.

i

i

In principle, this model could ﬁx the small area estimation problems that ˆπSRS display, similarly to how SMRs
estimates are typically improved in disease mapping studies. Unfortunately, in contrast to ˆπSRS, the proportion
estimates arising from this model will no longer be unbiased, since these proportion estimates will be shrunk toward
those of their neighbors. Nevertheless, the more efﬁcient use of information in spatial models, which is shared between
nearby units, should yield more accurate proportion estimates than raw sample means, which will compensate for the
bias introduced by these estimators.

2.1 Estimating the proportion of low- and middle-income countries population for Barcelona neighborhoods:

A real case study

In this case study, which will be revisited afterwards, we are going to compare different estimates assuming SRS,
or simply ignoring the sampling design, to the estimation of the proportion of people from low- and middle-income
countries (LMIC for short from now on) for neighborhoods in the city of Barcelona, Spain. Thus, the outcome variable
Y for this study is equal to 1 if the surveyed person was born in a LMIC, and 0 otherwise. Barcelona is divided into
73 neighborhoods with populations varying from 631 to 58,054 inhabitants, with a median of 20,533 people. The
survey data used for this case study corresponds to the 2016 Barcelona Health Survey, with a sample size of around
4000 people. This survey was designed to achieve a given precision level for each of the 10 districts of the city, so
our units of study are smaller than those corresponding to the originally planned design. The sample size for the
different neighborhoods of the city vary between 1 and 226, with a median value of 46, yielding a surveyed population
of 2.4 people for each 1,000 city inhabitants. Interestingly, also for 2016, the Barcelona register of inhabitants, which
collects population information for the entire city (not just a sample) contains information on the birth country of the
city inhabitants. Therefore, we could alternatively obtain from this source the proportion of LMIC people for each
neighborhood throughout this exhaustive sample, which could be used as a gold standard (the *gold standard* π from
now on) for assessing the quality of the different survey estimates. All the details (Rmarkdown document with the R
code run) of the following and subsequent analyses in this paper can be found in the supplementary material of the
paper (https://www.uv.es/mamtnez/Sampling.html).

By using the survey data, we have derived four different estimates of the proportion of LMIC population at the
neighborhood level π = (π1, . . . , πI ). First, we have derived a frequentist SRS estimate of those proportions, ˆπSRS as
deﬁned above, which is simply the sample mean of {Yij : j ∈ ∂i}. Variance estimates ( (cid:100)V ar( ˆπSRS)) and 95
(Oi + 1) − 1
(Oi + 1) + (ni − Oi + 1) − 2

Oi
ni

=

,

4

A PREPRINT - DECEMBER 13, 2021

which could be used once again as proportion estimates for this model. This Bayesian point estimate coincides with
ˆπSRS
. Nevertheless, for the Bayesian case, credible intervals for πi may be derived from those posterior distributions,
i
which would avoid the Normality assumption of the frequentist estimators not so suited, possibly, for small areas. These
credible intervals would take into account the Binomial nature of the outcome variable, which could yield, in principle,
some advantages. Finally, we have derived two spatial proportion estimates corresponding to the Bayesian spatial
model introduced previously, which considers those proportions as dependent quantities in contrast to the other two
alternatives. Speciﬁcally, we consider the spatial estimate accounting for the ﬁnite population character of the sample
( ˆπSpatial in expression 2) and, as an alternative, the proportion estimates which ignore that character (θ∗). As point
estimates we use the posterior distribution of those variables. An lCAR distribution, as introduced by Leroux et al.
(1999) [14], is used to induce spatial dependence (vector θ) in the proportion estimates for this model.

Table 1 shows several statistics for these proportion estimates. To assess their accuracy we have calculated the correlation
with the gold standard, drawn from the Barcelona register of inhabitants, and (the square root of) the mean squared error
for each proportion estimate. Furthermore, we have assessed the precision of those estimates by means of their 95%
conﬁdence/credible interval (CI) lengths. Additionally, we have also assessed the empirical coverage of those CIs as the
proportion of those 73 intervals that contained the corresponding gold standard proportion πi, which we would expect
to be around 0.95. We have also measured the spatial dependence of the estimates by means of the Moran’s I statistic
[16], which should be compared with the gold standard’s (π) Moran’s I, equal to 0.202. Finally, we have assessed
the divergence of the Moran’s I statistics for these estimates with that of the gold standard π. We have done this by
evaluating the posterior probability of the Moran’s I of these statistics being lower than the Moran’s I of π. For the
Bayesian cases, this has been done by drawing samples of the proportions posterior distributions and then calculating
the Moran’s I posterior distribution from these. For the frequentist case, we have repeatedly sampled independent
values of a t distribution with ni − 1 degrees of freedom of mean ˆπSRS
), the distribution
implicitly assumed for deriving CIs. For these samples we have calculated the corresponding Moran’s I, which have
been used to estimate the probability of that statistic being lower than the Moran’s I of π.

and variance (cid:100)V ar(ˆπSRS

i

i

Table 1: Assessment criteria for each proportion estimate assuming simple random sampling

√

Statistic
Cor(π, ˆπ)
M SE
95% CI length
95% CI Coverage
Moran’s I
P(estimated I<real I)

ˆπSRS
0.612
0.083
0.271
0.808
0.129
0.986

Bayes SRS
0.612
0.083
0.252
0.959
0.129
0.969

ˆπSpatial
0.747
0.049
0.172
0.945
0.233
0.671

ˆπ∗
0.746
0.049
0.172
0.945
0.235
0.663

The ﬁrst two lines of Table 1 show how the point estimates (posterior means) of the spatial model ( ˆπSpatial and ˆπ∗)
outperform those of the independent SRS estimates in terms of both correlation and MSE with respect to π. This
illustrates how sharing information between spatial units improves point estimates when dealing with small areas and
how that increase in the information used outperforms the potential bias of those estimates. The beneﬁts of spatial
estimates are also evident in the CI lengths, as the CIs for this model are substantially narrower than for the other two
alternatives. Despite the enhanced precision of the spatial estimates, their 95% CI coverage is substantially better than
that of the frequentist SRS, which is lower than it ought to be. Interestingly, the Bayes SRS estimate already shows an
evident improvement in the CI coverage, similar to that of the spatial estimates. We could conclude therefore that the
coverage problems of the frequentist SRS estimates come from the Normality assumption, which, for low/moderate
sample sizes, such as those typically arising from small areas, does not hold in practice. Finally, the last two lines
of Table 1 summarize the spatial dependence of the proportion estimates. As shown, the spatial model shows a clear
increase in the spatial dependence of the estimates, with its Moran’s I being nearly twice that of its alternatives and
much closer to the gold standard Moran’s I (0.202). Moreover, for the spatial estimates the gold standard Moran’s I falls
around the 67% percentile of the posterior distribution, which highlights the compatibility of the spatial dependence of
those estimates with that of π. In contrast, the gold standard Moran’s I falls around the 97% percentile of the estimates
for the other two non-spatial alternatives, suggesting that these estimates display weaker spatial dependence than they
ought to. Finally, Table 1 points out the equivalence in practice of the ﬁnite population ( ˆπSpatial) and general ( ˆπ∗)
spatial estimates, which suggests that for the sampling fraction in this study (2.4 sampled individuals for each 1,000
inhabitants) no ﬁnite population correction is really needed.

5

A PREPRINT - DECEMBER 13, 2021

3 Small area inference for more complex sampling designs

In the following, we will consider the inclusion of auxiliary variable(s) information in survey based inference, regardless
of whether or not this information is used for designing the sample of the study (stratiﬁed sampling).

3.1 Small area inference for stratiﬁed sampling designs

Despite the simplicity of SRS, which is the simplest scheme followed for collecting survey samples, this is not such a
common sampling scheme in practice. Instead, more complex designs are usually followed for these studies. Stratiﬁed
sampling, for example, is a much more frequent choice, where samples are divided into several population groups and
their estimates are then merged in order to derive compound indicators with a given precision. This process could be
done for either the whole population or particular population groups, such as speciﬁc geographical areas. Unfortunately,
when a sample is planned, it will rarely be planned for a small area division of the region of study but rather for a
coarser spatial division, or even the whole region, since otherwise the required sample size will typically be unattainable.
Our goal will now be to use those stratiﬁed samples to make inferences at a higher spatial disaggregation level than that
originally planned (small areas), taking into account the speciﬁc stratiﬁed sampling scheme followed.

The main goal of stratiﬁcation is to reduce the variance of the estimates by combining the information of several
homogeneous groups that, in principle, should have low variance. From this point on, we will consider that a stratiﬁed
sampling design has been used to gather a survey sample and a SRS scheme has been used in order to collect the
corresponding sample within each stratum. More speciﬁcally, and without loss of generality, we will assume that
the sampling strata correspond to age groups. This framework generalizes the previous SRS scheme to a much more
common and general setting in practice. Additionally, from now on we assume that the stratiﬁed sample was originally
collected for the whole region of study in order to estimate one proportion for that whole region with a given precision,
but we want to now use that sample to estimate that same proportion, as accurately as possible, for the units of a small
area division of the region of study. If an intermediate spatial division, coarser than the small areas of interest, was
considered for the sampling design, all the following would remain valid; nevertheless, for clarity we will focus on the
simplest case of a single stratiﬁed sample for the whole population. That is, the following is valid regardless of the
spatial division considered, if any, to design the sample of the study.

Sampling theory states (see page 73 of Lohr (2010) [12]) that under stratiﬁed sampling, with SRS within each age
group k(= 1, . . . , K), an unbiased estimate of π = E(Y ) = N −1 (cid:80)N
j=1 Yj, the overall proportion of Y = 1 over the
whole population, could be derived as:

ˆπStr = N −1

(cid:33)

¯Y Str=kN Str=k

,

(cid:32) K
(cid:88)

k=1

(3)

where ¯Y Str=kis the sample mean of Y on age group k and N Str=k the population size of that same age group, with
N = N Str=1 + . . . + N Str=K. Note that each of the terms in the sum on the right-hand-side of this expression
(N Str=k ¯Y Str=k) can be seen as a ratio estimator (See Chapter 4 of Lohr (2010) [12]) for the total of Y for each
stratum, where that ratio ( ¯Y Str=k) compares the total people with Y = 1 against the total sampled people in that
stratum. Afterwards, this ratio is combined with the auxiliary design information (population size N Str=k) in order
to derive a ratio estimate (page 119 of Lohr2010) of the total of people with Y = 1 in the corresponding age group.
Therefore, the stratiﬁed estimator (3) may be considered as a particular case of the ratio estimator, which will soon be
important below.

Unfortunately, stratiﬁed sampling on small areas poses additional estimation problems. On the one hand, stratiﬁed
sampling collects several samples (strata) for each unit of analysis, instead of a single sample, so this increases the
sample size requirements to derive estimates of this kind. Furthermore, when a stratiﬁed sampling scheme is used to
derive areal estimates, the spatial units originally considered for the sampling design (let us say US states) are frequently
larger than the small areas of interest (let us say counties), since otherwise the required sample size to achieve the
desired precision would not be attainable. Having a sampling design at a coarser spatial level than the small areas
of interest, could easily lead to some o the age groups not being sampled in some of those small areas, which would
make the direct estimation of the parameter of interest ˆπStr unfeasible for those areas. Additionally, when small area
inference is undertaken in that setting, the original stratiﬁcation weights, which were initially planned for larger units,
may no longer be valid for deriving estimates for those small areas, so the available sample could seem useless for
maiking inferences about those small areas. Our goal will now be to solve these problems when small area inference is
pursued on a stratiﬁed sample designed for a broader (if any) geographical division.
In that case, let us denote N Str=k
and k-th age group, i = 1, . . . , I; k = 1, . . . , K. Note that N Str=k

the total and sampled populations, respectively, for the i-th neighborhood
will generally be known in advance of the sample

and nStr=k
i

i

i

6

A PREPRINT - DECEMBER 13, 2021

selection, since the sampling design is organized according to these values, but not nStr=k
, which will depend on the
sample drawn. Let us also denote Y Str=k
; k = 1, . . . , K, the observed value for
the binary variable Y of interest, for the j-th individual of the k-th age group on the i-th neighborhood. Let us also
assume that our goal will now be to estimate πi = E(Yi) = N −1
), which is equivalent to
N −1
j=1 Yij if the stratiﬁed design/notation is ignored.
i

; i = 1, . . . , I; j = 1, . . . , nStr=k

k=1((cid:80)N Str=k

Y Str=k

(cid:80)Ni

(cid:80)K

i
j=1

ij

ij

i

i

i

Expression (3) establishes how to use information on the stratiﬁcation variable to compound estimates for the whole
population. Unfortunately, that expression would in principle be useless for deriving areal estimates for a small area
division of the region of study which does not coincide with that used for the sampling design. Nevertheless, we
mentioned that Expression (3) can be viewed simply as a combination of ratio estimators, beyond its stratiﬁed nature,
and that combination could now be used now as a post-stratiﬁcation procedure to derive stratiﬁed small area estimators.
Thus, let ¯Y Str=k
= (nStr=k
be the sample mean for stratum k and the (small) spatial unit i. That
i
estimate can be also expressed as: ((cid:80)N Str=k
= 1 if individual
j of stratum k and spatial unit i is included in the sample, and 0 otherwise. For this last expression the denominator is
also stochastic, since SRS is used over an upper geographical level and we do not know how many of the elements of
the k-th age group in the sample will correspond to spatial unit i. Therefore, ¯Y Str=k
would simply be a ratio
estimator, supported by sampling theory, of the Y total for age group k. Therefore, the sum of these ratio estimators
over all the age groups (cid:80)K
could be used to estimate the total of Y over the entire spatial unit i, and:

Y Str=k
ij
j=1 X Str=k

j=1 X Str=k

) , where X Str=k

)−1 (cid:80)nStr=k

)/((cid:80)N Str=k

N Str=k

N Str=k

Y Str=k

i
j=1

ij

ij

ij

ij

i

i

i

i

i

¯Y Str=k
i

i

k=1

i = N −1
ˆπStr

K
(cid:88)

k=1

¯Y Str=k
i

N Str=k

i

,

(4)

could be used as a combined ratio estimator, or stratiﬁed estimator, of πi = E(Yi) suitable for a different (small area)
spatial division than that considered for the stratiﬁed sampling design. This makes the available sample, originally
planned for a coarser spatial division, also useful for a small area division of the region of study.

Although Expression (4) allows πi to be estimated for any division of the region of the study, taking the stratiﬁed nature
of the sample into account, it does not solve the small area estimation problems that the size of the units of study could
pose. These problems should be similar to, or possibly worse than, those illustrated in Section 2. If independence was
assumed at the inference stage for each age group and spatial unit, then ¯Y Str=k
in Expression (4) may sometimes not
be computed if no sampled units were available for that particular age group and spatial unit combination. Additionally,
if the number of sampled units for that combination was simply small, although greater than 0, which could occur
frequently in practice, this would make ¯Y Str=k
. Thus,
small area modeling becomes much more necessary in stratiﬁed sampling schemes than for SRS survey samples. In
SRS, small area problems were alleviated by the modeling of the vector θ, considering their components as spatially
dependent variables. Now we have a matrix E(Y) = (E(Y Str=k
i,k=1 to estimate, instead of a single vector, which
we could model in several different manners, possibly considering spatial dependence among its cells.

inaccurate, and that variability would also be transferred to ˆπstr

))I,K

i

i

i

i

Being more precise, let us denote the outcome variable for the j-th sampled individual of spatial unit i and age group k
as Y Str=k
i , where that probability could be
ij
modeled, for example, as:

as a Bernoulli variable of probability (π∗)k

. We could then model Y Str=k

ij

logit((π∗)Str=k

i

) = µ + ψi + φk.

In this model proposal, age (φ) and spatial (ψ) effects could be modeled as usual, thus φ1 could be ﬁxed to 0 while an
improper uniform prior could be considered for φ2, . . . , φK and a spatial CAR pior, such as the Leroux et al.’s lCAR,
could be used to induce spatial dependence on ψ. Once this model has been ﬁtted, we could estimate the probabilities
ˆπStr=k
for each neighborhood and stratum, either taking a ﬁnite sample correction into account, or not, like for SRS.
Therefore, the overall probability for each neighborhood could be deﬁned as:

i

ˆπStrSmall
i

= N −1

K
(cid:88)

k=1

ˆπStr=k
i

N Str=k

i

,

(5)

which sums the estimated totals for every stratum. We could use ˆπStrSmall
i
principle, could solve the small area estimation problems that the direct stratiﬁed estimator could exhibit.
Note that the modeling of logit((π∗)Str=k
) proposed above is just a simple proposal supposedly solving the original
i
small area estimation problems of ˆπStr
. Clearly, that model induces strong assumptions about π that could alternatively
be relaxed by considering for example a multivariate CAR process [17] for the age groups used to stratify the sample.
This would be less restrictive than the proposal above as it would allow age-neighborhood interactions to be reproduced

as an alternative estimate to ˆπStr

, which, in

i

i

7

A PREPRINT - DECEMBER 13, 2021

if these were required. Nevertheless, the above proposal would in principle be more parsimonious than estimating a
different spatial pattern per age group; therefore, for this reason and to save space, we will limit this work to exploring
the beneﬁts of the additive effects proposal of age and neighborhood mentioned above. However, if age-neighborhood
interactions were suspected, an alternative multivariate CAR modeling of the age and neighborhood effects could be
preferred over our proposal.

It is also worth mentioning that an abridged version of the model above could alternatively be proposed, as already
mentioned for the SRS case, with important computational beneﬁts if computation was an issue due to the dimensions of
the data set of study. Thus, the Bernoulli likelihood of the model above could be substituted by a Binomial distribution
on the number of observed people OStr=k
age group and neighborhood as follows:

) for the corresponding

= 1 (i.e. OStr=k

with Y Str=k
ij

= (cid:80)nStr=k

Y Str=k

i
j=1

ij

i

i

OStr=k

i

∼ Binomial((π∗)Str=k

i

, nStr=k
i

), i = 1, . . . , I, k = 1, . . . , K

and once again:

logit((π∗)Str=k

i

) = µ + ψi + φk.

In this case, φ and ψ could be modeled in the same manner as for the previous model. Both models can be shown to
have the same data likelihood and thus their equivalence. Although this abridged model could be more convenient from
a computational point of view, the consideration of additional auxiliary variables (as for the example below) would
mean a major change in the formulation of this model since OStr=k
would need to be recomputed for all
the groups of the auxiliary variables. In contrast, considering an additional auxiliary variable for the original Bernoulli
implementation would pose no particular problems in terms of the model implementation, so in that case the original
model could be more convenient in practice. In fact, that model will be used for the case study developed below. In
any event, both formulations should be borne in mind and used depending on their appropiateness for each particular
problem.

and nStr=k
i

i

3.2 Small area inference with auxiliary variables

In addition to stratiﬁed sampling, a similar proposal to that above could be used to take into account the information of
additional auxiliary variables, even though these were not originally used to design the sample. In fact, as mentioned,
stratiﬁcation is just a particular case of the use of auxiliary variables, speciﬁcally in the sampling design phase of the
survey. We have seen that poststratiﬁcation has been the key to deriving stratiﬁed estimators for units of study that were
not originally considered in the survey design. This same idea can also be used to include auxiliary variables in the
inference, it also being possible to consider spatial dependence in that case.

Let us now assume that our survey collected, in addition to our variable of interest Y , a second categorical variable
Z ∈ {1, . . . , K} for each individual in the sample. Let us also assume that we knew, from a second information source,
the population N Z=k
belonging to each of the K categories of Z for each of the small areas i that make up the region
of study, i.e. N Z=k
j=1 1Zij =k; i = 1, . . . , I; k = 1, . . . , K, where 1Zij =k is equal to 1 if Z = k for individual
j of spatial unit i, and 0 otherwise. In that case, similarly to the stratiﬁed setting, we could use a ratio estimator to
estimate the population with Y = 1 for each spatial unit and group of the auxiliary variables as follows:

= (cid:80)Ni

i

i

(ˆτY )Z=k
i

=

(cid:32) (cid:80)ni

j=1(Y k
(cid:80)ni

ij · 1Zij =k)

j=1 1Zij =k

(cid:33)

N Z=k
i

= ( ¯Y |Zij = k)N Z=k

i

.

In addition, we could also estimate πi = N −1

i

(τY )i, the percentage of people with Y = 1 in spatial unit i as:

ˆπRatio
i

= N −1
i

(ˆτY )i = N −1

i

(cid:32) K
(cid:88)

k=1

(cid:33)

(ˆτY )Z=k
i

= N −1
i

K
(cid:88)

( ¯Y |Zij = k)N Z=k

i

.

k=1

(6)

This estimator would take advantage of the information on the total population for each value of Z, N Z=k
, that we know
for each spatial unit. Once again, this estimator allows us to include auxiliary variables information on our estimates in
a similar manner to how Expression (4) did it with the stratiﬁcation variable. Nevertheless, this new estimate would
pose the same small area estimation problems as those posed by the estimator in Expression (4). Luckily, they could
be solved in exactly the same way as done there, by means of small area hierarchical modeling that considers spatial
dependence. Thus, the hierarchical model proposed to take advantage of stratiﬁed sampling would one again be valid
also for the poststratiﬁcation of auxiliary variables by simply changing the N Str=k
used in Expression (4) to the totals
N Z=k
i

of each group for the auxiliary variable.

i

i

8

A PREPRINT - DECEMBER 13, 2021

3.3 Small area inference with stratiﬁcation and auxiliary variables

We have just seen that accounting for stratiﬁed designs in spatial divisions unplanned during the sampling design and
using auxiliary variables, also ignored in the sampling design, does not pose any difference in terms of their statistical
analysis. We are now going to consider how to combine these two tools in order to obtain enhanced estimators of use in
many real settings. We will consider the case of having two auxiliary variables, regardless of whether or not they are
used to design the sample (stratiﬁcation variables), since the case of considering more than two variables would be
closely similar.

Let us consider that we have two auxiliary variables, Z1 with values in {1, . . . , K1} and Z2 with values in {1, . . . , K2}.
In that case, our quantities of interest will be:

πi = N −1

i

Ni(cid:88)

j=1

Yij = N −1

i

Ni(cid:88)

K1(cid:88)

K2(cid:88)

j=1

k1=1

k2=1

Yij1(Z1)ij =k11(Z2)ij =k2 =

K1(cid:88)

K2(cid:88)

= N −1
i

πZ1=k1,Z2=k2
i

N Z1=k1,Z2=k2

i

,

(7)

k1=1
= (N Z1=k1,Z2=k2

k2=1
)−1 (cid:80)Ni

i

i

where πZ1=k1,Z2=k2
j=1 Yij1(Z1)ij =k1 1(Z2)ij =k2 stands for the proportion of times that
i
Y = 1 in neighborhood i when Z1 = k1 and Z2 = k2 and N Z1=k1,Z2=k2
is the population corresponding to those
values of the auxiliary variables. As introduced in the case of a single stratiﬁcation or auxiliary variable, πZ1=k1,Z2=k2
for k1 = 1, . . . , K1 and k2 = 1, . . . , K2 could be estimated by the corresponding means ¯Y Z1=k1,Z2=k2
in the available
sample. In that case, Expression (7) would produce an estimate ˆπi that would take into account both auxiliary variables.
Nevertheless, that choice would show clear small area problems, similarly to the same problems mentioned above. As a
consequence, πZ1=k1,Z2=k2
could be estimated instead by means of a spatial hierarchical model that would solve the
small area problems that these indicators could exhibit.
The problem in practice with the estimator in Expression (7) is that N Z1=k1,Z2=k2
will not be so frequently available in
population databases when two or more auxiliary variables are combined. In that case, if the distribution of Z1 and Z2
in the population are reasonably independent, that is:

i

i

i

i

then that estimator could be restated as:

N Z1=k1,Z2=k2

i

≈

N Z1=k1

i

· N Z2=k2
i
Ni

,

N −1
i

K1(cid:88)

K2(cid:88)

k1=1

k2=1

πZ1=k1,Z2=k2
i

N Z1=k1

i

· N Z2=k2
i
Ni

= N −1
i

K1(cid:88)

(cid:32)

N −1
i

K2(cid:88)

k1=1

k2=1

πZ1=k1,Z2=k2
i

N Z2=k2

i

· N Z1=k1
i

.

(8)

(cid:33)

The term within the parenthesis in this expression reproduces, for each value of Z1, a ratio estimator for Z2 conditioned
to that particular value of Z1. Similarly, the rest of that expression provides a second ratio estimator, in this case for Z1,
which combines, according to this variable, the conditional ratio estimators previously calculated for Z2. Therefore,
this estimator may be viewed as a sequential ratio estimator of each of the auxiliary variables considered, where the
information on each of the auxiliary variables is progressively included into the full estimator. Clearly, the order of the
sums in Expression (8) could be reversed, thus the order used to include the auxiliary variables into the full estimator
does not have any impact on it.

Both estimators in Expressions (7) and (8) are two separate alternatives, although the suitability of the second depends
on the adequacy of the independence assumption for Z1 and Z2. Using one or the other in practice will depend
on the availability of population information for the combination of both auxiliary variables, N Z1=k1,Z2=k2
; i =
1, . . . , I; k1 = 1, . . . , K1; k2 = 1, . . . , K2 and/or the validity of the independence hypothesis between Z1 and Z2, if
this may be assessed, otherwise it will just have just to be assumed if population information on their combination is
not available.

i

3.4 Estimating the proportion of LMIC people for Barcelona neighborhoods: A reanalysis

We are going to resume now the study of the estimation of LMIC population for Barcelona neighborhoods, already
examined in the previous section. The survey sampling used in the Barcelona health survey originally followed a
stratiﬁed design, with strata corresponding to ﬁve age groups ({0 − 19, 20 − 39, 40 − 59, 60 − 79, 80 − . . .}) and
sex, which was ignored in the previous case study. Additionally, the total sample size was divided into 10 groups of

9

A PREPRINT - DECEMBER 13, 2021

Table 2: Assessment criteria for the stratiﬁed, ratio and full proportion estimates

Statistic

√

Cor(π, ˆπ)
M SE
95% CI length
95% CI Coverage
Moran’s I
P(estimated I<real I)

ˆπSRS
(13 missing)
0.741
0.061
0.206
0.867
0.048
1

ˆπStr

0.724
0.062
0.101
0.600
0.044
1

ˆπSRS
(4 missing)
0.699
0.069
0.232
0.826
0.158
0.838

ˆπRatio

ˆπF ull

0.727
0.062
0.115
0.667
0.150
0.806

0.796
0.043
0.141
0.959
0.305
0.643

around 400 people corresponding to the 10 Barcelona districts, a city division coarser than that of neighbourhoods.
This design was followed in order to achieve given precision levels for the city districts. Our goal is now to take
that sampling design into account for inference. In addition, although it was ignored when designing the sample,
we have an additional auxiliary variable that could be taken into account for inference. This binary variable collects
whether or not each individual owns their place of residence. The Barcelona health survey speciﬁcally asks this
question in each survey and the city census contains the total of this same variable for each neighborhood of the
city ({N home=k
, i = 1, . . . , 73, k = 1, 2}). Thus, this variable could be used to derive a ratio estimator that
i
includes information on the ownership of the homes and its relationship with the birth country of Barcelona inhabitants.
Additionally, a combined estimator could be also derived that takes into account the age stratiﬁcation design of the
sample, the home ownership information available and spatial dependence and integrates it all into a single model. This
is the main goal of this case study. For simplicity, and due to the mild association found between sex and the LMIC
origin in Barcelona residents, we will ignore the sex stratiﬁcation of the sampling design throughout the following
analysis.

We have derived and compared three estimators in this case study. First, we have developed stratiﬁed estimates of
the proportion of LMIC people for each neighborhood ˆπStr (see Expression (3)), taking the age stratiﬁcation design
into account and ignoring both spatial dependence and home ownership information. Second, we have developed a
ratio estimator ˆπRatio (see Expression (6)), ignoring both spatial dependence and age stratiﬁcation, but considering
the home ownership information available from both information sources (Barcelona health survey and register of
inhabitants (for the totals of the variable)). Finally, we have developed a third estimator ˆπF ull considering age strata,
home ownership information and spatial dependence. This estimator has been derived by ﬁtting a Bayesian hierarchical
model which assumes:

Y age=k1 home=k2
ij
logit((π∗)age=k1 home=k2

i

∼ Bernoulli((π∗)age=k1 home=k2

)

i

) = µ + ψi + φk1 + ϕk2,

for i = 1, . . . , 73, j = 1, . . . , ni, k1 = 1, . . . , 5 and k2 = 1, 2. In this case, ψ models the spatial variability between
neighborhoods,φ the effect of the age group and ϕ the effect of home ownership. Once this model has been ﬁtted we
could add all these probabilities for the different levels of the auxiliary variables into a single estimate per neighborhood
(ˆπF ull), taking into account (or not) ﬁnite sample corrections, as described above (Expression (7)). Speciﬁcally, given
the limited impact of the ﬁnite sample correction in the previous case study, we have not considered that correction when
deriving ˆπF ull in this new study. Additionally, we have used Expression (8), which assumed independence between
both auxiliary variables for deriving ˆπF ull since the population register of Barcelona does not publish population data
for the combination of these variables at the neighborhood level, just the separate frequencies (by neighborhood) for
each of them. The comparison of the standardized, ratio and full estimates, among them and against the estimates
derived in the previous section, will allow their particular advantages to be assessed. The R code used for this analysis is
also supplied as annex supplementary material to the paper.

As an initial consequence of using auxiliary variables for inference in our case study, we ﬁnd that some combinations of
these variables with the neighborhood are not present in the sample. Therefore, the proportions of LMIC may not be
estimated in those neighborhoods for the ˆπStr and ˆπRatio estimators. Speciﬁcally, for the age-stratiﬁed estimator ˆπStr
we ﬁnd that 6.6

Table 2 contains the same statistics as those shown in Table 1 but for the new models developed in this section. In
addition, this table also contains two columns corresponding to the ˆπSRS estimator of the previous section, but
considering as missing values those positions where ˆπStr (13 missing values) and ˆπRatio (4 missing values) are also
missing, respectively. This allows the stratiﬁed and ratio estimators to be compared with those that considered sampling
random sampling over the same set of spatial units.

The comparison of the second and third columns of Table 2 shows that there is hardly any difference between the
stratiﬁed estimator and SRS in terms of the correlation and MSE with respect to π. Thus, although SRS estimates were

10

A PREPRINT - DECEMBER 13, 2021

in principle biased due to ignoring the stratiﬁed sample design followed, the effect of ignoring that design in ˆπSRS
does not seem to yield a high bias. In contrast, differences are more evident in terms of conﬁdence intervals since the
lengths of the stratiﬁed estimates are substantially shorter than those assuming SRS. Although seems like good news,
this increased precision also reduces the proportion of times that the ICs contain the real values π from 0.867 to 0.600,
far lower than expected. This could be a consequence of the small size of the units of study, which, under stratiﬁed
sampling, means that many combinations of age groups and neighborhoods have really low sample sizes. Speciﬁcally,
28.5
Columns 4 and 5 of Table 2 show a similar performance of the ratio estimator to that of ˆπStr, although the ratio
estimator displays slight improvements. Thus, ˆπRatio estimates π similarly to ˆπSRS, though it is slightly better in
terms of Cor(π, ˆπ) and MSE. Once again the CI lengths are reduced in comparison to SRS, but that reduction is lower
(and, correspondingly, the CI coverages are higher) than for the stratiﬁed estimators. This could be explained by the 8.9
Finally, the 6th column of Table 2 illustrates ˆπF ull results. This estimator is clearly better than ˆπStr and ˆπRatio for
all the criteria considered, except perhaps the CI lengths (which are wider), which, as shown, seems to be superior
in terms of the CI coverage. According to the Moran’s I statistic, ˆπF ull also appears to have a spatial dependence
comparable to that of π. Additionally, ˆπF ull also seems to display signiﬁcant advantages in comparison to the SRS
spatial estimator (Table 1) for all the criteria considered. Therefore, merging the advantages of stratiﬁed, ratio and small
areas modeling into a single proposal appears to yield a clear reward for small area modeling, which is made possible
by the use of Bayesian hierarchical models.

Figure 1 shows several choropleth maps with some of the estimated proportions in this work, as well as with the census
gold standard. This ﬁgure illustrates the evident noise of the SRS estimates when no speciﬁc small area methods are
used to estimate the LMIC population proportions. This noise is ﬁltered out for the spatial and full estimates where the
proportion estimates show, in addition, a similar spatial dependence to that displayed by the gold standard geographical
pattern. Differences between the spatial and full estimators are visually more subtle, indicating that the greatest beneﬁt
of the full estimator may come from the modeling of the spatial dependence. In any event, the main advantage of
taking auxiliary variables into account could be the increase in the precision of the proportion estimates, which seems
conﬁrmed by the CI lengths of the spatial and full models in Tables 1 and 2. These different precision estimates cannot
be directly noticed in Figure 1.

4 Conclusions

This paper proposes merging both survey sampling and spatial small area approaches in order to derive sensible
estimates from a survey sample over a collection of small areas. Our approach describes how to include information
from auxiliary variables for making inference on the outcome of interest, whether these were used for the sampling
design (stratiﬁcation variables) or not (ratio estimators). We also propose merging sampling theory with spatial methods
in order to yield improved estimates which enjoy the advantages of both approaches. We propose combining the
theoretical estimates from sampling theory corresponding to these two settings (stratiﬁed and ratio estimators) with
spatial methods which yield dependent estimates of the underlying group-speciﬁc proportions for each small area. The
use of spatial methods to avoid the independence assumption of those underlying probabilities is the key to deriving
sensible estimates in survey-based small area studies since that independence assumption, widespread for classical
sampling theory estimators, could clearly be harmful in the small area context. As shown, the potential bias introduced
by spatial dependence has many more advantages than drawbacks when dealing with small areas. Nevertheless,
beyond the spatial stratiﬁed and ratio estimators derived in this paper, our main goal in this work is to merge sampling
theory estimation with spatial statistics methods into a single proposal. Following our proposal, similar approaches
could be undertaken for different or more complex sampling designs in small area studies, such as for proportional
to size sampling, regression estimators ... These settings would deserve similar attention to that paid in our paper to
stratiﬁcation or ratio estimators and, in principle, could be successfully modeled following similar procedures.

Typically, when a sampling design has been followed, the main goal of inference methods is to take that design into
account in order to yield appropriate estimates. Nevertheless, the latest of our case studies shows that the use of auxiliary
variables that were not used for sampling design (home ownership status in our case) could be even more advantageous
in practice than the control of sampling design variables (age group). In addition, we have also shown that spatial
dependence could also yield substantial beneﬁts, even greater than the control of sampling design variables, since in our
case the spatial estimates clearly outperform stratiﬁed and ratio estimates. Evidently, this would probably depend on
each speciﬁc data set, in particular on whether the design variable is closely related, or not, to the outcome variable.
However, a clear message seems to arise here: when dealing with small areas, the modeling of the outcome variable,
in particular its dependence structure, could be as important as taking the sampling design into account. Therefore,
sampling theory alone does not appear to be sufﬁcient in and of itself to derive appropriate estimates in small areas

11

A PREPRINT - DECEMBER 13, 2021

Figure 1: Estimated spatial patterns for the percentage of low- and middle-income countries population for several of
the models in this paper, and that same percentage according to the Barcelona census gold standard.

12

<5%5%−9%10%−14%15%−19%20%−24%>=25%SRSSpatial SRSFull estimatorGold standardstudies. In those cases, modeling resources, such as including spatial dependence or auxiliary variables which were
not used for the sampling design, are important tools that should be used whenever possible in order to yield sensible
estimates.

A PREPRINT - DECEMBER 13, 2021

i

i

In this paper we propose modeling the underlying probabilities for each area and group of the auxiliary variable(s) by
considering them as spatially dependent, which in principle seems to solve small area estimation problems. Nevertheless,
more elaborate spatial modeling could be used in order to yield more ﬂexible estimates for these probabilities. Thus, in
the previous section, we proposed modeling those speciﬁc group-area probabilities as logit((π∗)Z=k
) = µ + ψi + φk,
which cannot reproduce interactions between age groups and spatial units. We could alleviate this constraint by
modeling logit((π∗)Z=k
) = µi + ξik, where the rows of ξ are modeled by means of a spatiotemporal [18] or a
multivariate CAR process [19], which allows the spatial patterns for the different age groups to be different, though
dependent. In a similar manner, if two (or more) auxiliary variables were used for inference, such as for the second
of our case studies, multidimensional spatial modeling [20] could be used in order to model (π∗)Z1=k1 Z2=k2
as
logit((π∗)Z1=k1 Z2=k2
) = µ + ξik1k2. In this expression, ξik1k2 will be now a three-dimensional array, with a different,
i
but dependent, spatial pattern for the different values of k1 and k2. Clearly, these models would yield more ﬂexible
estimates of the underlying group-area speciﬁc probabilities, which would make the area-speciﬁc estimates ˆπF ull
less constrained, while taking advantage of spatial dependence, which has been shown to be so advantageous. That
enhancement of our current proposal is beyond the scope of this paper and should possibly be explored in the future. In
any event, the current proposal in this paper, although perhaps somewhat restrictive in comparison to the multivariate
and multidimensional alternatives, has been proven to be interesting in and of itself, with quite promising results in
practice. As shown, when dealing with small areas, spatial modeling, such as that introduced in this paper, seems to
be the most advisable option, much more advisable than the use of traditional direct estimates supported by sampling
theory.

i

References

[1] Miguel A. Martinez-Beneito and P. Botella Rocamora. Disease mapping from foundations to multidimensional

modeling. CRC Press, 2019.

[2] Andrew B. Lawson. Bayesian Disease Mapping: Hierarchical Modeling in Spatial Epidemiology (3rd edition).

CRC Press, 2018.

[3] Morris H. Hansen and William N. Hurwitz. On the theory of sampling from ﬁnite populations. The Annals of

Mathematical Statistics, 14(4):333–362, 1943.

[4] D. G. Horvitz and D. J. Thompson. A generalization of sampling without replacement from a ﬁnite universe.

47(260):663–685.

[5] Bengt Swensson, Carl-Erik Särndal, and Jan Wretman. Model Assisted Survey Sampling. Springer New York,

2003.

[6] Cici Chen, Jon Wakeﬁeld, and Thomas Lumely. The use of sampling weights in bayesian hierarchical models for

small area estimation. 11:33–43.

[7] Laina D. Mercer, Fred Lu, and Joshua L. Proctor. Sub-national levels and trends in contraceptive prevalence,

unmet need, and demand for family planning in nigeria with survey uncertainty. 19(1).

[8] John Paige, Geir-Arne Fuglstad, Andrea Riebler, and Jon Wakeﬁeld. Design- and model-based approaches to

small-area estimation in a low- and middle-income country context: Comparisons and recommendations.

[9] R. J. A. Little. Post-stratiﬁcation: A modeler's perspective. 88(423):1001–1012.

[10] David K. Park, Andrew Gelman, and Joseph Bafumi. Bayesian multilevel estimation with poststratiﬁcation:

State-level estimates from national polls. 12(4):375–385.

[11] Andrew Gelman. Struggles with survey weighting and regression modeling. 22(2).
[12] Sharon L. Lohr. Sampling: design and analysis (2nd edition). Brooks/Cole, Cengage Learning, 2010.

[13] Hans R Kunsch.

Intrinsic autoregressions and related models on the two-dimensional lattice. Biometrika,

74:517–524, 1987.

[14] Brian G. Leroux, Xingye Lei, and Norman Breslow. Estimation of disease rates in small areas: a new mixed
model for spatial dependence. In M E Halloran and D Berry, editors, Statistical Models in Epidemiology, the
Environment and Clinical Trials. Springer, Berlin Heidelberg New York, 1999.

[15] Julian Besag, Jeremy York, and Annie Mollié. Bayesian image restoration, with two applications in spatial

statistics. Annals of the Institute of Statistical Mathemathics, 43:1–21, 1991.

13

A PREPRINT - DECEMBER 13, 2021

[16] P. A. P. Moran. The interpretation of statistical maps. 10:243–251.
[17] Ying C. MacNab. Some recent work on multivariate Gaussian Markov random ﬁelds. TEST, 27(3):497–541, 2018.
[18] Miguel A. Martinez-Beneito, Antonio López-Quílez, and Paloma Botella-Rocamora. An autoregressive approach

to spatio-temporal disease mapping. Statistics in Medicine, 27:2874–2889, 2008.

[19] Paloma Botella-Rocamora, Miguel A. Martinez-Beneito, and Sudipto Banerjee. A unifying modeling framework

for highly multivariate disease mapping. Statistics in Medicine, 34(9):1548–1559, 2015.

[20] Miguel A Martinez-Beneito, Paloma Botella-Rocamora, and Sudipto Banerjee. Towards a multidimensional

approach to Bayesian disease mapping. Bayesian Analysis, 12:239–259, 2017.

14

