MNRAS 000, 1â€“23 (2021)

Preprint 13 July 2022

Compiled using MNRAS LATEX style ï¬le v3.0

Inner cusps of the ï¬rst dark matter haloes:
Formation and survival in a cosmological context

M. Sten Delos,1â˜… Simon D. M. White1
1Max Planck Institute for Astrophysics, Karl-Schwarzschild-Str. 1, 85748 Garching, Germany

Accepted XXX. Received YYY; in original form ZZZ

2
2
0
2

l
u
J

1
1

]

O
C
.
h
p
-
o
r
t
s
a
[

1
v
2
8
0
5
0
.
7
0
2
2
:
v
i
X
r
a

ABSTRACT
We use very high resolution cosmological zoom simulations to follow the early evolution of twelve ï¬rst-generation haloes formed
from gaussian initial conditions with scale-free power spectra truncated on small scales by a gaussian. Initial collapse occurs with
a diverse range of sheet- or ï¬lament-like caustic morphologies, but in almost all cases it gives rise to a numerically converged
density cusp with ğœŒ = ğ´ğ‘Ÿ âˆ’3/2 and total mass comparable to that of the corresponding peak in the initial linear density ï¬eld. The
constant ğ´ can be estimated to within about 10 per cent from the properties of this peak. This outcome agrees with earlier work
on the ï¬rst haloes in cold and warm dark matter universes. Within central cusps, the velocity dispersion is close to isotropic, and
equidensity surfaces tend to align with those of the main body of the halo at larger radii. As haloes grow, their cusps are often
(but not always) overlaid with additional material at intermediate radii to produce proï¬les more similar to the Einasto or NFW
forms typical of more massive haloes. Nevertheless, to the extent that we can resolve them, cusps survive at the smallest radii.
Major mergers can disturb them, but the eï¬€ect is quite weak in the cases that we study. The cusps extend down to the resolution
limits of our simulations, which are typically a factor of several larger than the cores that would be produced by phase-space
conservation if the initial power spectrum cutoï¬€ arises from free streaming.

Key words: methods: numerical â€“ cosmology: theory â€“ dark matter

1 INTRODUCTION

In the idealized cold dark matter (CDM) picture, density variations
are present at all scales within the initial mass distribution. These den-
sity variations seed gravitationally collapsed haloes that form hierar-
chically through accretion and mergers of smaller haloes. Numerical
simulations of this scenario have found that the spherically averaged
density proï¬les ğœŒ(ğ‘Ÿ) of these haloes are remarkably universal as a
function of the radius ğ‘Ÿ. Navarro et al. (1996, 1997) showed that all
CDM haloes are well described by a functional form â€“ now called the
Navarroâ€“Frenkâ€“White (NFW) proï¬le â€“ that approaches ğœŒ âˆ ğ‘Ÿâˆ’1 at
small radii and steepens towards ğœŒ âˆ ğ‘Ÿâˆ’3 as the outer "virial" radius
of the halo is approached. Navarro et al. (2004) later found that the
Einasto density proï¬le (Einasto 1965), in which the logarithmic den-
sity slope varies with radius as d log ğœŒ/d log ğ‘Ÿ âˆ âˆ’ğ‘Ÿ ğ›¼ with ğ›¼ âˆ¼ 0.17,
supplies a slightly better ï¬t. This proï¬leâ€™s density slope becomes
even shallower at small radii than the NFW asymptotic limit of âˆ’1
(Navarro et al. 2010).

This picture is incomplete, however. Most models of particle dark
matter possess some thermal motion in the initial conditions. This
motion smooths out the primordial density ï¬eld on a characteristic,
free-streaming scale. For example, if the dark matter is the lightest
neutralino in a supersymmetric extension of the Standard Model with
a mass of order 100 GeV, then the free-streaming scale corresponds
to roughly an Earth mass, and the ï¬rst haloes form at about this mass
(e.g. Green et al. 2005). For warm dark matter (WDM) models, the

â˜… E-mail: sten@mpa-garching.mpg.de

Â© 2021 The Authors

free-streaming mass scale could be as large as âˆ¼ 108 M(cid:12) (e.g. Enzi
et al. 2021). The ï¬rst haloes form via the direct monolithic collapse of
smooth density peaks at this scale. Compared to the NFW or Einasto
density proï¬les associated with idealized CDM haloes, the density
proï¬les of these ï¬rst haloes tend to be steeper at small radii, with
slopes approaching d log ğœŒ/d log ğ‘Ÿ = âˆ’3/2 (Diemand et al. 2005;
Ishiyama et al. 2010; Anderhalden & Diemand 2013; Ishiyama 2014;
Polisensky & Ricotti 2015; Angulo et al. 2017; Ogiya & Hahn 2018;
Delos et al. 2018a,b; Ishiyama & Ando 2020).1

Yet the relevance of these ğœŒ âˆ ğ‘Ÿâˆ’3/2 cusps to cosmological haloes
remains uncertain. The central density slope tends to be shallower
for more massive haloes (Ishiyama 2014; Angulo et al. 2017), which
suggests that steep inner cusps may relax into shallower NFW or
Einasto forms over time as haloes grow. Moreover, a separate body
of work (Huss et al. 1999; Avila-Reese et al. 2001; Busha et al.
2007; Wang & White 2009; Lovell et al. 2014; Wang et al. 2020)
continues to ï¬nd no evidence of steep central cusps in even the
smallest haloes, instead concluding that these haloes possess the same
NFW or Einasto density proï¬les as their idealized CDM counterparts.
It is also noteworthy that simulations that resolve the free-streaming
scale are polluted by smaller-scale structures that arise artiï¬cially
from discreteness noise (e.g. Wang & White 2007), an issue that

1 Dark matter halo density proï¬les that approach ğœŒ âˆ ğ‘Ÿ âˆ’3/2 at small radii
were suggested earlier by Moore et al. (1999) in the context of idealized
CDM, but later works (e.g. Navarro et al. 2004) found that this behaviour did
not hold as simulation resolution improved.

 
 
 
 
 
 
2 M. S. Delos & S. D. M. White

could cast doubt on the numerical robustness of the density proï¬les
in these simulations.

The present study is aimed at clarifying the extent to which
ğœŒ âˆ ğ‘Ÿâˆ’3/2 central density cusps arise and persist in a cosmologi-
cal context. We carry out very high resolution zoom simulations of
twelve ï¬rst-generation haloes, grown from three diï¬€erent initial lin-
ear power spectra, and we track the structure and the density proï¬les
of these haloes through their formation and early evolution. The de-
tails of the initial collapse diï¬€er dramatically in the twelve cases, as
does the degree of artiï¬cial structuring present during the formation
process. Our ï¬rst objective is to test whether these diverse formation
sequences all result in haloes with ğœŒ âˆ ğ‘Ÿâˆ’3/2 in their inner regions.
Our second goal is to explore the survival of these cusps. Appealing
to the results of idealized simulations, Ogiya et al. (2016) and Angulo
et al. (2017) argued that major mergers drive the transition of ğœŒ âˆ
ğ‘Ÿâˆ’3/2 cusps toward the shallower NFW or Einasto forms found in
larger haloes. On the other hand, studies of CDM haloes by Dalal
et al. (2010) and Ludlow et al. (2013), among others, found the
overall mass accretion history of a halo, which is usually dominated
by minor mergers and diï¬€use accretion rather than by major mergers
(e.g. Angulo & White 2010), to be a good predictor of its density
proï¬le. Our halo sample exhibits a variety of accretion and merger
histories, the range of which is enhanced by our sampling of very
diï¬€erent initial power spectra. We explore how the later-time density
proï¬les of our haloes vary with accretion and merger history, and we
investigate how this aï¬€ects their initial central cusps.

If they survive, ğœŒ âˆ ğ‘Ÿâˆ’3/2 central cusps might have signiï¬cant
observational implications. Subhaloes with steeper central cusps are
substantially more resistant to tidal disruption (PeÃ±arrubia et al. 2010;
StÃ¼cker et al. 2022a), so ğœŒ âˆ ğ‘Ÿâˆ’3/2 cusps could boost the abundance
of the lowest-mass subhaloes in the haloes of the Milky Way and other
large galaxies. Steeper cusps are also associated directly with stronger
observational signatures. For instance, prospects for the detection of
dark subhaloes using annihilation radiation are enhanced because the
annihilation luminosity diverges logarithmically towards ğ‘Ÿ = 0 for
a proï¬le with ğœŒ âˆ ğ‘Ÿâˆ’3/2. This behaviour illustrates the importance
of understanding the range of radii encompassed by the cusps of
the ï¬rst haloes. Our ï¬nal aim is thus to explore this question. Our
simulations can determine the maximum radii of the cusps, but they
do not resolve the minimum radius. However, if the initial density
ï¬eld was smoothed by free streaming of the dark matter particles, then
these same motions must tame the central cusp by imposing a core
at the maximum phase-space density allowed by Liouvilleâ€™s theorem
(Tremaine & Gunn 1979). We study the phase-space structure of the
inner cusp analytically to determine the radius at which it must give
way to a core.

Our main results support the robustness of ğœŒ âˆ ğ‘Ÿâˆ’3/2 cusps in
the ï¬rst haloes. We ï¬nd that such cusps arise for haloes with wildly
diï¬€erent formation sequences and are well converged with respect to
simulation resolution. As our haloes grow, rapid accretion is the main
eï¬€ect leading to shallower density proï¬les, but this process works
by building up the density at intermediate radii without substantially
altering the inner cusp. Consequently, haloes can develop apparently
shallow Einasto-like density proï¬les at large and intermediate radii
while retaining the initial ğœŒ âˆ ğ‘Ÿâˆ’3/2 cusp at the smallest radii. Major
merger events can disturb this central cusp, but their impact is rela-
tively minor in the cases that we have studied. Finally, the radius at
which phase-space constraints force a cusp to give way to a core is
suï¬ƒciently small in realistic models that the ğœŒ âˆ ğ‘Ÿâˆ’3/2 cusp can span
several decades in radius. These ï¬ndings suggest that ğœŒ âˆ ğ‘Ÿâˆ’3/2 cen-
tral cusps may survive long enough to be observationally relevant,

MNRAS 000, 1â€“23 (2021)

Figure 1. The power spectra from which we draw our simulation initial
conditions. We show the dimensionless form P (ğ‘˜) â‰¡ [ğ‘˜3/(2 ğœ‹2) ] ğ‘ƒ (ğ‘˜). The
length units are ï¬xed such that (cid:104)ğ‘˜2 (cid:105) = 1, so the gaussian cutoï¬€ scale is ğ‘˜cut =
âˆšï¸2/(3 + ğ‘›). These spectra are normalized so that the rms density contrast
is ğœ = 0.03. The vertical cyan lines indicate the fundamental frequency
associated with the box employed for simulations with each power spectrum.

although studies involving larger halo samples and longer time spans
(and hence larger growth factors) are needed to be certain.

This article is organized as follows. In Section 2, we discuss our
simulation setup and the properties of our simulated haloes. In Sec-
tion 3, we explore halo formation mechanisms and the density cusps
that emerge. In Section 4, we explore how and why halo density pro-
ï¬les evolve over time, and we study the extent to which the ğœŒ âˆ ğ‘Ÿâˆ’3/2
cusps survive this process. In Section 5, we use analytic arguments to
evaluate the radius at which an inner density cusp must give way to
a core with ï¬nite central density. We summarize our results in Sec-
tion 6. Finally, Appendices A and B validate the numerical robustness
of our simulation results, while Appendix C presents mathematical
details relating to the calculation of the core size in Section 5.

2 SIMULATION SETUP

2.1 Power spectra and units

To explore scenarios in which density variations are cut oï¬€ at small
scale, we consider Einstein-de Sitter cosmologies with initial power
spectra taking the form

ğ‘ƒ(ğ‘˜) âˆ ğ‘˜ ğ‘› exp[âˆ’(ğ‘˜/ğ‘˜cut)2],

(1)

i.e. power laws multiplied by a gaussian of scale ğ‘˜ = ğ‘˜cut.2 Specif-
ically, we consider the three power-law indices ğ‘› = 1, ğ‘› = âˆ’2, and
ğ‘› = âˆ’2.67. These power spectra are depicted in Fig 1; we show the
dimensionless form P (ğ‘˜) â‰¡ [ğ‘˜3/(2ğœ‹2)]ğ‘ƒ(ğ‘˜), indicating the typical
(squared) relative amplitude of density variations as a function of
their scale. Generally, power spectra with ğ‘› close to âˆ’3 are associ-
ated with the presence of signiï¬cant density variations over a broad
range of scales. In contrast, the ğ‘› = 1 power spectrum has signiï¬-
cant support only within a narrow range. In standard cosmological
scenarios, cold dark matter is associated with ğ‘› âˆ¼ âˆ’3 at scales close
to the cutoï¬€ while warmer dark matter is associated with ğ‘› farther
from âˆ’3. For instance, we will see later that the power spectrum
associated with 3.5-keV warm dark matter (e.g. Bode et al. 2001)
lies somewhere between the ğ‘› = âˆ’2.67 and ğ‘› = âˆ’2 power laws near

2 A cutoï¬€ of exactly this form arises from free streaming if the thermal
velocity distribution is Maxwell-Boltzmann (e.g. Bertschinger 2006).

10âˆ’210âˆ’1100101k10âˆ’610âˆ’510âˆ’410âˆ’3P(k)â‰¡[k3/(2Ï€2)]P(k)n=1n=âˆ’2n=âˆ’2.67Table 1. The units that we employ in this study. We specify comoving units
here; for physical units the scale factor ğ‘ is deï¬ned such that ğ‘ = ğœ in linear
theory.

quantity

unit

length
density
mass

(cid:104)ğ‘˜2 (cid:105)âˆ’1/2
Â¯ğœŒ
Â¯ğœŒ (cid:104)ğ‘˜2 (cid:105)âˆ’3/2

the cutoï¬€. Substantially larger power-law indices are not observa-
tionally viable in this context, although they arose in the original hot
dark matter models (e.g. White et al. 1983) and are also found for
cold dark matter for some nonstandard cosmological initial condi-
tion scenarios (e.g. Erickcek & Sigurdson 2011). In this paper, we do
not aim to reproduce any particular cosmology but rather to explore
the formation of ï¬rst-generation objects using idealized initial power
spectra.

The power spectra in Fig. 1 are normalized so that the (unï¬ltered)

rms density contrast is ğœ = 0.03, where

ğœ2 =

âˆ« âˆ

0

dğ‘˜
ğ‘˜

P (ğ‘˜).

We also ï¬x our length units so that (cid:104)ğ‘˜2(cid:105) = 1, where
(cid:104)ğ‘˜2(cid:105) = ğœâˆ’2 âˆ« âˆ

ğ‘˜2P (ğ‘˜),

dğ‘˜
ğ‘˜

0

(2)

(3)

which leads to ğ‘˜cut = âˆšï¸2/(3 + ğ‘›) and puts the peak of P at ğ‘˜ = 1.
The choice to ï¬x ğœ and (cid:104)ğ‘˜2(cid:105) is a convenience; we expect that with this
choice, the density peaks arising from diï¬€erent power spectra will
have comparable size, structure and amplitude. In particular, Delos
et al. (2019) found (see also Section 3.2) that the inner structures
of the ï¬rst haloes are sensitive almost entirely to the heights ğ›¿ and
characteristic sizes |ğ›¿/âˆ‡2ğ›¿|1/2 of their progenitor peaks in the linear
density ï¬eld ğ›¿(x). In the high-peak limit, the values of |ğ›¿/âˆ‡2ğ›¿|1/2
sharply cluster around (cid:104)ğ‘˜2(cid:105)âˆ’1/2 (Bardeen et al. 1986).3 Therefore, we
obtain similar peak heights for diï¬€erent power spectra by matching
ğœ and similar peak sizes by matching (cid:104)ğ‘˜2(cid:105).

In our simulations we will take the initial scale factor to be ğ‘ =
0.03, so that ğ‘ = ğœ in linear theory. We also deï¬ne mass units such
that the mean comoving cosmological density is 1. The units and
conventions are summarized in Table 1.4

2.2 Simulation procedure

We use the Gadget-4 simulation code (Springel et al. 2021) to exe-
cute our simulations. First, we carry out one primary simulation for
each of the three power spectra in Fig. 1. In each case we use second-
order Lagrangian perturbation theory to produce a perturbed grid of

3 We comment that if we were interested in halo counts instead of density
proï¬les, the more natural length scale would instead be (cid:104)ğ‘˜4 (cid:105)âˆ’1/2 (cid:104)ğ‘˜2 (cid:105)1/2 =
âˆšï¸2/(5 + ğ‘›) ğ‘˜âˆ’1
cut, which sets the number density of peaks (Bardeen et al. 1986).
4 For the power spectrum given by Eq. (1), the â€œhalf-modeâ€ scale commonly
considered in studies of warm dark matter (e.g. Enzi et al. 2021) is ğ‘˜hm =
1.18ğ‘˜cut (as a wavenumber) or ğœ†hm = 5.3ğ‘˜âˆ’1
cut (as a wavelength). Here we
use the deï¬nition of the half-mode scale as the scale at which the cutoï¬€
suppresses the amplitudes (not power) of density variations by a factor of
two. Consequently the half-mode mass ğ‘€hm â‰¡ (4 ğœ‹/3) Â¯ğœŒğœ†3
in our units
hm
is ğ‘€hm = 1800, ğ‘€hm = 225, and ğ‘€hm = 42.7 for ğ‘› = 1, ğ‘› = âˆ’2, and
ğ‘› = âˆ’2.67, respectively. This mass scale is not particularly meaningful for
haloes; see for instance Fig. 3 and footnote 5.

Inner cusps of the ï¬rst haloes

3

Figure 2. Projected density ï¬eld within a representative region of each sim-
ulation at ğ‘ = 2 (when the rms density contrast ğœ = 2 in linear theory). The
region is a cube of width 261(cid:104)ğ‘˜2 (cid:105)âˆ’1/2; for ğ‘› = âˆ’2.67 this is the entire box.
The vastly higher amplitude of large-scale power in the ğ‘› = âˆ’2 and ğ‘› = âˆ’2.67
simulations, compared to the ğ‘› = 1 simulation, is immediately evident. The
latter produces an essentially uniform distribution of haloes, while the former
produce structures that approach the size of the displayed region.

10243 particles inside a periodic box of width 643ğ‘˜âˆ’1
cut. This choice
means that the Nyquist frequency associated with the initial particle
grid is 5ğ‘˜cut. We then simulate each box up to some scale factor
ğ‘ > 2 under the assumption of matter domination. The simulation
force softening length here is set to 0.03 times the initial interparticle
spacing. A portion of each resulting simulation box at ğ‘ = 2 is shown
in Fig. 2; in particular we show a cube of width 261(cid:104)ğ‘˜2(cid:105)âˆ’1/2, which
for ğ‘› = âˆ’2.67 is the entire box. The imprint of the power spectrum
is evident here. The ğ‘› = 1 simulationâ€™s dearth of large-scale power
yields an essentially uniform distribution of tiny haloes, whereas the
substantial amplitude of large-scale power in the ğ‘› â‰¤ âˆ’2 simulations
produces much larger haloes and ï¬laments; in the ğ‘› = âˆ’2.67 case
these structures begin to approach the box size.

From each of these primary simulations, we select a range of
haloes to resimulate at much higher resolution. The selection is
mostly arbitrary, but we favor haloes that formed by ğ‘ âˆ¼ 0.6. We
aim to ensure that there is a reasonable sense in which each halo ini-
tially formed by direct collapse. To boost the resolution, we identify
each low-resolution particle that resides within the haloâ€™s spherical-
overdensity radius ğ‘…178 (enclosing an average density 178 times the
cosmological mean) at some late time. We then locate that particle
within the initial conditions and replace it with a glass consisting of
between 4.0 Ã— 103 and 2.6 Ã— 105 high-resolution particles (depending
on the halo). We also include in this procedure particles that are out-
side the ï¬nal halo but lie in the initial conditions between any halo
particle and the high-resolution regionâ€™s centre of mass. For each
such high-resolution halo, we then carry out another simulation that
includes that haloâ€™s high-resolution particles along with the remain-
ing original low-resolution particles (which retain their original mass
and force-softening length). Note that due to the short duration of our
simulations and our focus on inner density proï¬les, it is not necessary
to ensure that low-resolution particles never enter the high-resolution
halo. We discuss in Appendix A the extent to which low-resolution
particles do enter our haloes, showing that they remain at radii too
large to aï¬€ect our conclusions.

The numerical parameters associated with the high-resolution halo
simulations are listed in Table 2. We simulate twelve haloes in this
way, which we name H1â€“H3 (from the ğ‘› = 1 power spectrum),
W1â€“W5 (from the ğ‘› = âˆ’2 power spectrum), and C1â€“C4 (from the
ğ‘› = âˆ’2.67 power spectrum). The mass accretion histories of these
haloes are depicted in Fig. 3 over the period that we simulate them
at high resolution.5

5 Figure 3 already demonstrates the value of our choice of units. By ï¬xing

MNRAS 000, 1â€“23 (2021)

n=1n=âˆ’2n=âˆ’2.674 M. S. Delos & S. D. M. White

Table 2. Numerical parameters associated with our high-resolution halo sim-
ulations. For each halo (and associated power spectral index ğ‘›), we list the
number ğ‘high of high-resolution particles, their mass ğ‘šğ‘, the softening length
ğœ– , and the ï¬nal expansion factor and halo mass, ğ‘f and ğ‘€f .

ğ‘›

halo

ğ‘high

ğ‘šğ‘

ğœ–

1
1
1
âˆ’2
âˆ’2
âˆ’2
âˆ’2
âˆ’2
âˆ’2.67
âˆ’2.67
âˆ’2.67
âˆ’2.67

H1
H2
H3
W1
W2
W3
W4
W5
C1
C2
C3
C4

2.4 Ã— 108
1.5 Ã— 108
5.6 Ã— 107
3.0 Ã— 108
1.9 Ã— 108
1.4 Ã— 108
1.6 Ã— 108
5.9 Ã— 108
8.6 Ã— 108
5.6 Ã— 108
2.2 Ã— 108
4.7 Ã— 108

2.1 Ã— 10âˆ’5
2.1 Ã— 10âˆ’5
2.1 Ã— 10âˆ’5
2.1 Ã— 10âˆ’5
2.1 Ã— 10âˆ’5
2.1 Ã— 10âˆ’5
2.1 Ã— 10âˆ’5
3.3 Ã— 10âˆ’7
4.1 Ã— 10âˆ’6
4.1 Ã— 10âˆ’6
4.1 Ã— 10âˆ’6
5.1 Ã— 10âˆ’7

4.3 Ã— 10âˆ’4
4.3 Ã— 10âˆ’4
4.3 Ã— 10âˆ’4
4.3 Ã— 10âˆ’4
4.3 Ã— 10âˆ’4
4.3 Ã— 10âˆ’4
4.3 Ã— 10âˆ’4
1.1 Ã— 10âˆ’4
2.5 Ã— 10âˆ’4
2.5 Ã— 10âˆ’4
2.5 Ã— 10âˆ’4
1.2 Ã— 10âˆ’4

ğ‘f

4.72
5.06
6.51
1.50
1.28
1.69
1.68
1.52
1.00
1.19
1.03
1.41

ğ‘€f

1.4 Ã— 103
2.1 Ã— 103
9.5 Ã— 102
3.1 Ã— 103
1.8 Ã— 103
9.8 Ã— 102
1.4 Ã— 103
1.0 Ã— 102
2.3 Ã— 103
2.0 Ã— 103
8.4 Ã— 102
1.6 Ã— 102

Figure 3. The spherical-overdensity mass ğ‘€200 (within a spherical region
enclosing a mean density 200 times the cosmic average) of each halo that we
study, as a function of the scale factor ğ‘. The curve associated with each halo
terminates where we end the simulation.

In later sections, we plot halo density proï¬les down to a minimum
radius that is determined by the simulation particle count and the
force softening length ğœ–. Speciï¬cally, we consider the two radii ğ‘Ÿrel,
at which the age of the universe is equal to the two-body relaxation
time scale ğ‘¡rel (Eq. B1), and ğ‘Ÿsoft = 5ğœ–. We then plot density proï¬les
only at radii larger than both ğ‘Ÿrel and ğ‘Ÿsoft. We test a density proï¬le
for numerical convergence in Appendix B and ï¬nd that these choices
determine reasonably well the minimum radius that is converged with
respect to simulation resolution.

3 FORMATION OF THE INNER CUSP

We now explore the formation of the central cusp during the initial
collapse of the high-resolution haloes presented above. A major goal
of this section is to show that a wide variety of collapse sequences
all give rise to the same power-law ğœŒ âˆ ğ‘Ÿâˆ’3/2 inner density proï¬le.

the characteristic sizes | ğ›¿/âˆ‡2 ğ›¿ |1/2 âˆ¼ 1 of peaks in the linear density ï¬eld,
we ensure that all haloes have masses of order unity at the time they collapse.

MNRAS 000, 1â€“23 (2021)

Figure 4. Density proï¬le of halo H1 during its collapse. The upper panel
shows density ğœŒ as a function of radius ğ‘Ÿ , while the lower panel scales the
vertical axis by ğ‘Ÿ 3/2. We plot physical, not comoving, quantities. Diï¬€erent
colours represent diï¬€erent times. The density proï¬le begins to stabilize around
ğ‘ = 0.55, after which it is essentially ï¬xed and only grows outward in radius.
The power law of the inner proï¬le is about ğœŒ âˆ ğ‘Ÿ âˆ’3/2 (horizontal on the lower
panel).

We also discuss the connection between this feature and the initial
density ï¬eld.

3.1 The formation process

We ï¬rst focus on haloes arising from the ğ‘› = 1 power spectrum. Fig-
ure 4 shows the density proï¬le of the H1 halo during and shortly after
its formation. This halo forms around ğ‘ (cid:39) 0.6, and its inner density
proï¬le immediately settles at ğœŒ (cid:39) 60ğ‘Ÿâˆ’3/2 (in physical coordinates).
From this point on, the density proï¬le essentially remains stable at
small radii, only growing outward due to new accretion. This picture
closely resembles that in Delos et al. (2019), even with the present
studyâ€™s signiï¬cantly improved spatial resolution.

Figure 5 shows the haloâ€™s surrounding density ï¬eld during its
formation. We show three orthogonal projections at each time, and
to clarify the picture, we align these projections with the principal
axes of the tidal tensor at the haloâ€™s Lagrangian position within the
initial density ï¬eld. Evidently, the haloâ€™s precursor overdensity ï¬rst
collapses into a one-dimensional ï¬lament (second column in Fig. 5)
aligned in the ğ‘§ direction with very little extent in either the ğ‘¥ or the
ğ‘¦ direction. This ï¬lament begins to break up into regular fragments,
easily visible in the third column, which are a well-known numerical
artifact in simulations of this type (e.g. Wang & White 2007; Angulo
et al. 2013; Lovell et al. 2014). Finally, a collapsed halo forms near
the densest point of the ï¬lament. For convenience we also plot the
spherically averaged density proï¬le at each time. By ğ‘ = 0.59 the
inner ğœŒ (cid:39) 60ğ‘Ÿâˆ’3/2 cusp is already present. The haloâ€™s outer density
caustic is clearly visible in the proï¬le at this time around ğ‘Ÿ (cid:39) 2Ã—10âˆ’2,
and the ï¬lamentâ€™s outer caustic can also be seen around ğ‘Ÿ (cid:39) 8 Ã— 10âˆ’2
(the latter will soon be swallowed by the growing halo; see Fig. 4).
In Fig. 5, the inner cusp could be interpreted as forming from
a collection of artiï¬cial ï¬lament fragments, a prospect that might
cast doubt on the validity of the central proï¬le of the resulting halo.

100a10âˆ’1100101102103M200H1H2H3W1W2W3W4W5C1C2C3C4102104106Ïa=0.45a=0.55a=0.68a=0.84HaloH110âˆ’310âˆ’210âˆ’1100r101102Ïr3/2HaloH1Inner cusps of the ï¬rst haloes

5

Figure 5. Formation of the halo H1. We plot three diï¬€erent orthogonal projections of the density ï¬eld (upper three rows) at four diï¬€erent times (columns). These
projections are aligned with the principal axes of the initial tidal tensor. Material initially collapses to form a ï¬lament (ï¬rst three columns), which is evident
because two projections show a linearly extended object while the third suggests a point-like object. Within this ï¬lament the collapsed halo eventually forms
(last column). Fragmentation of the ï¬lament visible in the third column is a numerical artifact. In the bottom row, we show the spherically averaged density
proï¬le corresponding to the pictures above. Evidently, by ğ‘ = 0.59 (last column) the haloâ€™s stable ğœŒ (cid:39) 60ğ‘Ÿ âˆ’3/2 density proï¬le is already present. Within the
lower panels, the vertical line marks half the width of the displayed box (i.e. the radius from the centre to the left or right edge), while the faint grey diagonal
line indicates the cosmological mean density. In the upper panels of the left column we include directional references to clarify the relationship between the
three projections; for instance the upper panels are projected in the â€œğ‘§â€ direction, and the â€œğ‘¥â€ and â€ğ‘¦â€ directions therein are indicated by arrows.

These fragments arise because the discrete simulation particles that
comprise the ï¬lament tend to cluster (a process that may be viewed as
the triggering of a one-dimensional Jeans instability by discreteness
noise).6 However, two lines of evidence suggest that the ğœŒ âˆ ğ‘Ÿâˆ’3/2
cusp is robust.

(i) In Appendix B, we explicitly test the density proï¬le of the
W5 halo for numerical convergence. This halo also exhibits a clear
ğœŒ âˆ ğ‘Ÿâˆ’3/2 power-law density proï¬le at small radii, and its proï¬le is
stable with respect to changes in the simulationâ€™s spatial and mass
resolution. In contrast, the mass and number of artiï¬cial ï¬lament
fragments scale with a simulationâ€™s linear resolution (Wang & White
2007).

(ii) As we will see next, a halo that collapses from a two-
dimensional sheet (instead of a one-dimensional ï¬lament) also de-
velops a clear ğœŒ âˆ ğ‘Ÿâˆ’3/2 density cusp, even though the sheet exhibits
far weaker artiï¬cial structuring.

Figure 6 depicts the density ï¬eld around the H3 halo during its
collapse. We show again the ï¬eld projected along the tidal tensorâ€™s
principal axes. The material in this case collapses into a sheet (ï¬rst

two columns), as indicated by two of the projections showing a
linearly extended object while the third shows no apparent collapsed
object at all.7 In the second column artiï¬cial small-scale structure is
visible in the sheet and is ampliï¬ed as it collapses along a second
axis, as seen in the third column. It is, however, far weaker than
the fragmentation in Fig. 5. Finally, the halo forms in the rightmost
column. The lower panels show the spherically averaged density
proï¬le, and by ğ‘ = 0.45 (rightmost column), the halo has developed
a ğœŒ (cid:39) 90ğ‘Ÿâˆ’3/2 inner density cusp.

So far we have only studied haloes arising from the ğ‘› = 1 power
spectrum. We now show examples of haloes arising from each of
the ğ‘› = âˆ’2 and ğ‘› = âˆ’2.67 power spectra. Figures 7 and 8 show the
density ï¬elds surrounding haloes W1 and C1, respectively, during
their collapse. Each exhibits its own unique behaviour. The material
of the W1 halo (Fig. 7) initially collapses into a ï¬lament, but the
halo forms at the end of this ï¬lament, so unlike H1 (Fig. 5), it is
not clear that W1 can be viewed as arising from the collapse of
the ï¬lament itself. Meanwhile, the material of the C1 halo (Fig. 8)
exhibits a range of behaviour during its collapse. It ï¬rst collapses
into a very pronounced sheet; this sheet subsequently collapses into

6 Simulation methods exist that can eliminate these artifacts (StÃ¼cker et al.
2020, 2022b), although we do not employ them here.

7 The principal-axis projections are particularly valuable in the case of sheet
collapse, as most projection angles would show no clear evidence of collapse.

MNRAS 000, 1â€“23 (2021)

a=0.46zxya=0.50a=0.55a=0.59xzyyzx10âˆ’310âˆ’210âˆ’1100r100101102Ïr3/2HaloH110âˆ’310âˆ’210âˆ’1100r10âˆ’310âˆ’210âˆ’1100r10âˆ’310âˆ’210âˆ’1100r6 M. S. Delos & S. D. M. White

Figure 6. Formation of the halo H3. As in Fig. 5, we plot the density ï¬eld projected along the principal axes of the initial tidal tensor (upper three panels) along
with the spherically averaged density proï¬le (lower panels) at four diï¬€erent times (columns); see that ï¬gureâ€™s caption for further explanation. The material in
this case collapses into a sheet (ï¬rst two columns), which is evidenced by a linearly extended object visible along two of the principal axes and no collapsed
object visible along the third. Artiï¬cial small-scale structure is visible in the sheet in the top image of the second and third columns and in the lower image (â€œğ‘¦â€
projection) of the third column, but it is far less pronounced than the ï¬lament fragmentation seen in Fig. 5. The haloâ€™s stable inner ğœŒ (cid:39) 90ğ‘Ÿ âˆ’3/2 density proï¬le
has already developed by ğ‘ = 0.45 (last column).

a ï¬lament followed almost immediately by formation of the halo,
which promptly accretes another collapsed ï¬lament edge-on. Despite
these variations, both haloes develop an inner density proï¬le close
to ğœŒ (cid:39) 80ğ‘Ÿâˆ’3/2 by the ï¬nal snapshot shown.

Figure 9 shows density proï¬les during the collapse phase and
shortly afterwards for all twelve of our high-resolution haloes. All
of these haloes develop density proï¬les with ğœŒ âˆ¼ ğ‘Ÿâˆ’3/2 that remain
eï¬€ectively stable over a factor of at least 1.3 in scale factor, extending
to larger radii as the haloes accrete new material. Some of these
density proï¬les, such as those of C1 and C2, do grow moderately in
amplitude over time, an eï¬€ect we explore further in Section 4. The
density proï¬les of our highest-resolution haloes â€“ W5 and C4 â€“ show
some tendency toward shallowing at the smallest radii. However,
it is unclear whether this behaviour is converged with respect to
simulation resolution, as we discuss in Appendix B, and studies
with yet higher resolution are needed to test this. Aside from the
uncertainty in these two cases, the ğœŒ âˆ ğ‘Ÿâˆ’3/2 density cusp appears
to be a robust consequence of the direct collapse of a smooth initial
density peak, independent of the details of the collapse.

et al. (2019) noted that since the ğœŒ âˆ ğ‘Ÿâˆ’3/2 cusp stabilizes so quickly
after collapse, its properties must be sensitive only to the immediate
neighborhood of the precursor density peak. Such a peak can be
locally characterized by its height ğ›¿ and its characteristic comoving
radius ğ‘… â‰¡ |ğ›¿/âˆ‡2ğ›¿|1/2. Its collapse dynamics are also sensitive to the
tidal tensor ğœ•ğ‘– ğœ• ğ‘— ğœ™ (where ğœ™ is the peculiar potential), which can be
described by its ellipticity ğ‘’ and prolateness ğ‘.8 From dimensional
considerations, we expect that the amplitude ğ´ of the ğœŒ = ğ´ğ‘Ÿâˆ’3/2
cusp should be proportional to Â¯ğœŒ(ğ‘ğ‘)(ğ‘ğ‘ ğ‘…)3/2, where ğ‘ğ‘ is the
expansion factor at which the peak collapses and Â¯ğœŒ(ğ‘ğ‘) = Â¯ğœŒğ‘âˆ’3
ğ‘
is the cosmological density at ğ‘ğ‘. As above, Â¯ğœŒ is the comoving
cosmological density (equal to 1 in our simulations). Consequently,
we may write

ğ´ = ğ›¼ Â¯ğœŒğ‘âˆ’3/2

ğ‘

ğ‘…3/2

(4)

for some universal proportionality constant ğ›¼. Here we evaluate ğ‘ğ‘ as
a function of ğ›¿, ğ‘’, and ğ‘ using the ellipsoidal collapse approximation
in Sheth et al. (2001).9

3.2 Connection to the precursor density ï¬eld

Despite the varied details of the collapse process, the central cusps of
the ï¬rst haloes develop from particularly simple initial conditions: the
inner regions of smooth peaks in the primordial density ï¬eld. Delos

MNRAS 000, 1â€“23 (2021)

8

ğœ†1+ğœ†3âˆ’2ğœ†2
2(ğœ†1+ğœ†2+ğœ†3 )

If ğœ†1 > ğœ†2 > ğœ†3 are the eigenvalues of âˆ’ğœ•ğ‘– ğœ•ğ‘— ğœ™, then ğ‘’ â‰¡

ğœ†1âˆ’ğœ†3
2(ğœ†1+ğœ†2+ğœ†3 )
. Note that since ğœ†1 + ğœ†2 + ğœ†3 âˆ ğ›¿, the three quantities

and ğ‘ â‰¡
ğ›¿, ğ‘’, and ğ‘ fully specify the tidal tensor up to rotation.
9 For our haloes, the predicted ğ‘ğ‘ lies within about 5 per cent of the scale
factor at which the ğœŒ âˆ ğ‘Ÿ âˆ’3/2 cusp ï¬rst appears. Using the latter scale factor

a=0.39zxya=0.41a=0.43a=0.45xyzyxz10âˆ’310âˆ’210âˆ’1100r101102Ïr3/2HaloH310âˆ’310âˆ’210âˆ’1100r10âˆ’310âˆ’210âˆ’1100r10âˆ’310âˆ’210âˆ’1100rInner cusps of the ï¬rst haloes

7

Figure 7. Formation of the halo W1. We plot the density ï¬eld projected along the principal axes of the initial tidal tensor (upper three rows of panels) along with
the spherically averaged density proï¬le (lower panels) at four diï¬€erent times (columns); see the caption of Fig. 5 for further explanation. The haloâ€™s material
initially collapses into a ï¬lament (ï¬rst two columns), similarly to the case of the H1 halo (Fig. 5). Unlike H1, however, W1 forms at the end of its ï¬lament (third
column). Moreover, while artiï¬cial fragmentation is visible at this time, the halo has clearly already formed, as evidenced by comparing the density proï¬les in
the third and fourth columns at the innermost resolved radii. By ğ‘ = 0.38 (last column) a ğœŒ (cid:39) 70ğ‘Ÿ âˆ’3/2 density proï¬le is already well developed.

Figure 8. Formation of the halo C1. We plot the density ï¬eld projected along the principal axes of the initial tidal tensor (upper three rows of panels) along with
the spherically averaged density proï¬le (lower panels) at ï¬ve diï¬€erent times (columns); see the caption of Fig. 5 for further explanation. This haloâ€™s material
initially collapses into a sheet (ï¬rst column), which is far more pronounced than the sheet associated with the H3 halo (Fig. 6). This sheet soon collapses into
a ï¬lament (third column) followed almost immediately by the halo (fourth column). The haloâ€™s ğœŒ (cid:39) 70ğ‘Ÿ âˆ’3/2 density proï¬le is well developed by ğ‘ = 0.45 (last
column); meanwhile, another ï¬lament is about to accrete edge-on, although its accretion will not change the density proï¬le signiï¬cantly (see Fig. 9).

MNRAS 000, 1â€“23 (2021)

a=0.34zxya=0.35a=0.36a=0.38xzyyzx10âˆ’2100r101102Ïr3/2HaloW110âˆ’2100r10âˆ’2100r10âˆ’2100ra=0.35zxya=0.38a=0.40a=0.43a=0.45xyzyxz10âˆ’2100r101102Ïr3/2HaloC110âˆ’2100r10âˆ’2100r10âˆ’2100r10âˆ’2100r8 M. S. Delos & S. D. M. White

Figure 9. Density proï¬les of all of our high-resolution haloes during their collapse. As in Fig. 4, the vertical axis is scaled by ğ‘Ÿ 3/2; we plot physical, not
comoving, quantities; and diï¬€erent colours represent diï¬€erent times. The haloes all develop ğœŒ âˆ ğ‘Ÿ âˆ’3/2 density cusps very quickly after they collapse. In some
cases there is a tendency for the proï¬le to shallow at the smallest radii, but it is unclear whether this behaviour is numerically converged (see Appendix B). The
horizontal black line indicates the cusp amplitude ğ´ = ğœŒğ‘Ÿ 3/2 predicted from each haloâ€™s precursor density peak using Eq. (4) with ğ›¼ = 24. This line terminates
at the estimated initial cusp radius ğ‘Ÿ0 predicted from the same peak data using Eq. (6). There is some scatter, but overall these predictions match well the actual
properties of the cusps.

We can also estimate the size of the ğœŒ âˆ ğ‘Ÿâˆ’3/2 central cusp shortly
after collapse. Close to a peak in the linear density ï¬eld, the mean
density contrast within comoving radius ğ‘ scales as 1âˆ’ (ğ‘/ğ‘…)2/10.10
Spherical shells at radii ğ‘ > 0 can be approximated as undergoing el-
lipsoidal collapse within the same tidal ï¬eld with this lower enclosed
density contrast. Now consider the shell that collapses at ğ‘ = 1.17ğ‘ğ‘.
A factor of 1.17 in ğ‘ corresponds to one dynamical time, in the sense
of Binney & Tremaine (2008), for an object whose density is 200
times the cosmological mean. This shell has Lagrangian radius ğ‘
satisfying 1 âˆ’ (ğ‘/ğ‘…)2/10 = 1.17âˆ’1, so it encloses the mass

ğ‘€0 =

4ğœ‹
3

ğ‘3 Â¯ğœŒ =

4ğœ‹
3

103/2 (cid:18)

1 âˆ’

1
1.17

(cid:19)3/2

ğ‘…3 Â¯ğœŒ (cid:39) 7.3ğ‘…3 Â¯ğœŒ.

(5)

The collapsed halo therefore achieves a mass of approximately ğ‘€0
after one dynamical time interval. If its density proï¬le is ğœŒ = ğ´ğ‘Ÿâˆ’3/2

to predict ğ´ does not appreciably alter the degree to which it matches the
simulation results in Fig. 9.
10 This is the mean overdensity within ğ‘; the mean overdensity at ğ‘ scales
as 1 âˆ’ (ğ‘/ğ‘…) 2/6.

MNRAS 000, 1â€“23 (2021)

out to the physical radius ğ‘Ÿ0 that encloses ğ‘€0, then

ğ‘Ÿ0 =

1
4

(cid:18) 3
ğœ‹

(cid:19)2/3 (cid:18) ğ‘€0
ğ´

(cid:19)2/3

(cid:39) 0.92ğ›¼âˆ’2/3ğ‘ğ‘ ğ‘….

(6)

If the ğœŒ âˆ ğ‘Ÿâˆ’3/2 cusp is established over roughly the ï¬rst dynamical
time interval after collapse, then ğ‘Ÿ0 may be interpreted as an estimate
of the cuspâ€™s initial radius.

Within each of our haloes, we identify all of the particles that lie
at a radius ğ‘Ÿ < 4.2 Ã— 10âˆ’3 at some time shortly after halo formation
(the speciï¬c time makes no diï¬€erence), and we locate the Lagrangian
centre of mass of these particles in the initial conditions. We then
follow the local density gradient to ï¬nd the nearest peak in the initial
density ï¬eld. We record the peak height ğ›¿ and use Fourier methods
to evaluate ğ‘…, ğ‘’, and ğ‘. We use Eqs. (4), (5), and (6) to evaluate the
predicted values of ğ´, ğ‘€0, and ğ‘Ÿ0, respectively, for the associated
halo. We assume the proportionality constant ğ›¼ = 24.11 Table 3 lists
these data. In Fig. 9, we mark the predicted ğ´ for each halo with

11 The value of ğ›¼ that we assume is about 10 per cent smaller than the
value that Delos et al. (2019) obtained. It is likely that the proportionality

101102Ïr3/20.510.61a=0.73H10.550.66a=0.78H20.390.47a=0.56H3101102Ïr3/20.340.40a=0.48W10.340.41a=0.49W20.390.47a=0.56W3101102Ïr3/20.340.40a=0.48W40.480.58a=0.69W50.400.48a=0.57C110âˆ’310âˆ’210âˆ’1r101102Ïr3/20.390.46a=0.55C210âˆ’310âˆ’210âˆ’1r0.400.48a=0.57C310âˆ’310âˆ’210âˆ’1r0.530.63a=0.75C4Table 3. Properties of our haloesâ€™ precursor peaks in the linear density ï¬eld
ğ›¿ (x). The â€œoï¬€setâ€ is the comoving distance between the central cuspâ€™s mean
Lagrangian position and the density peak. ğ‘… â‰¡ | ğ›¿/âˆ‡2 ğ›¿ | is the characteristic
size of the peak and ğ›¿ (ğ‘)/ğ‘ is its height (scaled by ğ‘âˆ’1 since ğ›¿ (ğ‘) âˆ ğ‘).
ğ‘’ and ğ‘ are the â€œellipticityâ€ and â€œprolatenessâ€ of the tidal tensor ğœ•ğ‘– ğœ•ğ‘— ğœ™ at
the location of the peak (see footnote 8). Finally, ğ‘ğ‘ is the peakâ€™s predicted
collapse time (using the approximation in Sheth et al. 2001), ğ´ is the resulting
haloâ€™s predicted cusp amplitude (Eq. 4 with ğ›¼ = 24), and ğ‘€0 and ğ‘Ÿ0 are the
predicted mass and radius of the cusp after one dynamical time interval,
respectively (Eqs. 5 and 6).

halo

oï¬€set

ğ‘…

H1
H2
H3
W1
W2
W3
W4
W5
C1
C2
C3
C4

0.31
0.54
0.31
0.25
0.19
0.00
0.11
0.11
0.24
0.11
0.00
0.00

0.96
1.20
1.08
0.82
0.89
0.98
0.95
0.75
0.96
0.74
0.70
0.55

ğ›¿ (ğ‘)
ğ‘

3.40
3.32
4.09
4.86
5.00
4.20
4.77
3.48
4.30
4.22
4.11
3.66

ğ‘’

ğ‘

ğ‘ğ‘

ğ´ ğ‘€0

ğ‘Ÿ0

0.09 âˆ’0.06
0.00
0.18
0.06
0.00
0.04 âˆ’0.02
0.10 âˆ’0.01
0.09
0.01
0.06 âˆ’0.01
0.12 âˆ’0.01
0.12 âˆ’0.00
0.07
0.01
0.10 âˆ’0.02
0.15 âˆ’0.07

0.54
0.60
0.43
0.36
0.37
0.43
0.37
0.53
0.43
0.42
0.44
0.54

57
68
96
84
91
83
99
40
79
57
47
25

6.6
13
9.3
4.1
5.2
6.8
6.3
3.1
6.5
3.0
2.5
1.2

0.058
0.079
0.051
0.032
0.036
0.046
0.039
0.044
0.046
0.034
0.034
0.032

a horizontal black line, and we terminate that line with a point at
the radius ğ‘Ÿ0. We ï¬nd that with ğ›¼ = 24, the predicted values of ğ´
match the haloesâ€™ density proï¬les mostly very well, albeit with minor
scatter. The radius ğ‘Ÿ0 also reasonably estimates the initial size of the
ğœŒ âˆ ğ‘Ÿâˆ’3/2 cusp, although this size cannot be precisely deï¬ned.

We also list in Table 3 the oï¬€set between the halo cuspâ€™s La-
grangian centre and the density peak. In the ideal case where only ğ›¿,
ğ‘…, ğ‘’, and ğ‘ determine collapse, this oï¬€set should be zero because the
halo should form precisely at the density peak. The presence of an
oï¬€set thus implies that the broader density ï¬eld around the peak does
have a small inï¬‚uence on the collapse process (beyond determining
the tidal tensor). The inï¬‚uence of the broader density ï¬eld could also
explain some of the scatter in the cusp amplitudes ğœŒğ‘Ÿ3/2 in Fig. 9
with respect to the predicted values ğ´ from Eq. (4). However, we
note that since this oï¬€set is always signiï¬cantly smaller than ğ‘…, there
is no ambiguity as to whether a halo actually arose from the peak to
which we associate it. We also tried evaluating the predicted value
of ğ´ using the values of ğ›¿, ğ‘…, ğ‘’, and ğ‘ at the location of the La-
grangian centre instead of the peak, but the outcome did not change
signiï¬cantly.

4 PERSISTENCE OF THE INNER CUSP
We saw in Section 3 that a haloâ€™s ğœŒ âˆ ğ‘Ÿâˆ’3/2 cusp forms immediately
after collapse. In this section, we explore the extent to which these
cusps persist over cosmic time. Figure 10 shows the density proï¬le
of every halo at the end of its simulation (see Fig. 3). Speciï¬cally, we
average the density proï¬le over the ï¬nal factor of 1.17 in the scale
factor (corresponding again to one dynamical time for something 200
times denser than the cosmological mean). Some of these haloes â€“
H1, H3, and W5 â€“ evidently maintain their ğœŒ âˆ ğ‘Ÿâˆ’3/2 density cusps.
However, most of the late-time density proï¬les exhibit some degree

constant obtained in that work was biased upward by haloesâ€™ later evolution
(see Section 4), but since our own halo sample is small and not necessarily
representative, the value that we use here might not be more accurate.

Inner cusps of the ï¬rst haloes

9

Figure 10. Density proï¬les of all twelve high-resolution haloes at the end
of their simulations (averaged over the ï¬nal factor of 1.17 in scale factor).
We plot these proï¬les out to the radius ğ‘…200 enclosing an average density
200 times the cosmological mean. While haloes H1, H3, and W5 still retain
their ğœŒ âˆ ğ‘Ÿ âˆ’3/2 inner density proï¬les, most of the proï¬les have shallowed
by this late time. We include a reference ğœŒ âˆ ğ‘Ÿ âˆ’1 line, corresponding to
the innermost slope of the NFW proï¬le. Some of the density proï¬les are
beginning to approach this slope.

of shallowing, with some, like C2, even approaching the ğœŒ âˆ ğ‘Ÿâˆ’1
asymptote of the NFW form.

4.1 The impact of accretion rate

The shallowing of the inner proï¬le can largely be understood as
a consequence of high accretion rates. Due to its high energy and
(typically) high angular momentum, newly accreted material tends to
contribute signiï¬cant density to a halo only at large and intermediate
radii, close to the orbital apocentres of the newly accreted particles.12
Consequently, rapid accretion can shallow a haloâ€™s proï¬le by boosting
the density at intermediate radii.

Figure 11 shows how this process plays out. We plot halo mass
(upper panel) and mass accretion rate Î“ â‰¡ Î” log ğ‘€200/Î” log ğ‘ (centre
panel; e.g. Diemer & Kravtsov 2014) for W1 as a function of scale
factor ğ‘, where both Î” log ğ‘€200 and Î” log ğ‘ are evaluated over the
preceding factor of 1.17 in ğ‘. The same ï¬gure also shows (lower
panel) the evolution of the halo density proï¬le over the same period;
speciï¬cally we time average the proï¬le over successive factors of
1.17 in ğ‘. The colour of each density proï¬le in the lower panel
matches the time range of the same colour marked in the upper
panels. While the halo initially has ğœŒ âˆ ğ‘Ÿâˆ’3/2 in the inner regions, it
continues to accrete rapidly for some time after its formation (blue
and green), which causes the haloâ€™s density to grow at radii ğ‘Ÿ (cid:38)
10âˆ’2. This density growth is suï¬ƒcient to produce a shallow density
slope, d log ğœŒ/d log ğ‘Ÿ > âˆ’3/2, in the inner regions. The accretion
rate later drops (yellow), leading to a period in which the density
proï¬le remains stable except near ğ‘…200. Finally, near the end of the
simulation the accretion rate again rises, causing further deposition
of mass at intermediate radii.

12 New material tends to contribute almost uniform density at radii much
smaller than the apocentres of its particle orbits (e.g. Dalal et al. 2010).
However, this contribution is dwarfed by the much higher density already
present at those radii. Only close to the apocentres can the new material
signiï¬cantly boost the haloâ€™s density.

MNRAS 000, 1â€“23 (2021)

10âˆ’310âˆ’210âˆ’1100r101102Ïr3/2Ïâˆrâˆ’1H1H2H3W1W2W3W4W5C1C2C3C410 M. S. Delos & S. D. M. White

Figure 11. Mass (top), accretion rate Î“ evaluated at each time over the
preceding factor of 1.17 in ğ‘ (centre), and density proï¬le (bottom) for the
W1 halo. We plot the density proï¬le in physical coordinates at a range of
diï¬€erent times, indicated by colours; each proï¬le is averaged over the time
interval in the upper panels that is marked with the same colour (we also
separate these intervals with vertical lines). The halo begins with a ğœŒ âˆ ğ‘Ÿ âˆ’3/2
inner density proï¬le (purple), but its consistently high accretion rate (blue
and green) causes the density proï¬le to trend shallower as the halo grows.
The accretion rate later drops below Î“ âˆ¼ 3 (yellow), and the density proï¬le
remains stable for a period. Finally, towards the end of the simulation the
accretion rate rises above Î“ âˆ¼ 3 again (red), inducing renewed shallowing. At
the ï¬nal time the density proï¬le is well ï¬t by an Einasto proï¬le with ğ›¼ = 0.17
(Eq. 8; dotted curve) except at the smallest radii where the natal ğœŒ âˆ ğ‘Ÿ âˆ’3/2
cusp appears to persist. New accretion has mostly built on top of the cusp
rather than disrupting it (but see Section 4.2). A horizontal line marks Î“ = 3;
the idea that Î“ > 3 corresponds to newly accreted material forming a density
proï¬le shallower than ğœŒ âˆ ğ‘Ÿ âˆ’3/2 is approximately borne out. In the lower
panel we include a ğœŒ âˆ ğ‘Ÿ âˆ’1 line as reference (upper left); ğœŒ âˆ ğ‘Ÿ âˆ’3/2 would
correspond to a horizontal line.

The connection between the density proï¬le slope d log ğœŒ/d log ğ‘Ÿ
and the accretion rate Î“ â‰¡ d log ğ‘€/d log ğ‘ can be understood on
an approximate level by means of a simple model. Due to its mass
growth, the haloâ€™s radius ğ‘… grows at the rate d log ğ‘…/d log ğ‘ = 1+Î“/3
in physical coordinates. Now suppose that material accreted at the
scale factor ğ‘(cid:48) contributes signiï¬cant density within the halo only
near a particular radius ğ‘Ÿ = ğ‘¥ğ‘…(ğ‘(cid:48)) that is proportional to the haloâ€™s
radius ğ‘…(ğ‘(cid:48)) at the accretion time (so ğ‘¥ is some ï¬xed number). Then
the proï¬le ğ‘€ (ğ‘Ÿ) of the haloâ€™s enclosed mass obeys

(cid:19)âˆ’1

=

d log ğ‘€ (ğ‘Ÿ)
d log ğ‘Ÿ

d log ğ‘€ (ğ‘)
d log ğ‘

(cid:18) d log ğ‘…(ğ‘)
d log ğ‘
at ğ‘Ÿ = ğ‘¥ğ‘…(ğ‘) if Î“ is evaluated at ğ‘. Despite this modelâ€™s simplicity,
close variants thereof have been shown to successfully predict trends
in the density proï¬les within halo populations (Dalal et al. 2010;

3Î“
3 + Î“

(7)

=

MNRAS 000, 1â€“23 (2021)

Ludlow et al. 2013; Delos et al. 2019).13 Equation (7) suggests that
if a halo accretes material at a rate Î“ > 3, then the mass proï¬le
resulting from this accretion should obey d log ğ‘€/d log ğ‘Ÿ > 3/2 at
the corresponding radius, which requires a density proï¬le shallower
than ğœŒ âˆ ğ‘Ÿâˆ’3/2. Thus, we expect that accretion at a rate Î“ (cid:38) 3 should
build up a density proï¬le with a logarithmic slope shallower than
âˆ’3/2. This expectation is approximately borne out in Fig. 11, where
in the centre panel we mark Î“ = 3 with a grey line. When ğ‘ (cid:46) 0.9 and
when ğ‘ (cid:38) 1.2, Î“ > 3, which causes the density proï¬le to gradually
grow at intermediate radii 10âˆ’2 (cid:46) ğ‘Ÿ (cid:46) 10âˆ’1 into a form with a
slope shallower than ğœŒ âˆ ğ‘Ÿâˆ’3/2. In contrast, when 0.9 (cid:46) ğ‘ (cid:46) 1.2,
Î“ < 3, and during this interval the inner and intermediate parts of
the density proï¬le remain stable.

Since the primary impact of rapid accretion is to boost the haloâ€™s
density, the shallowing of the density proï¬le predominantly occurs
at intermediate radii 10âˆ’2 (cid:46) ğ‘Ÿ (cid:46) 10âˆ’1. The central ğœŒ âˆ ğ‘Ÿâˆ’3/2 cusp
largely survives the process, albeit with some mass loss that we will
discuss further in Section 4.2 (where we attribute it to a major merger
event). In fact, W1â€™s density proï¬le in the ï¬nal snapshot is well ï¬t at
almost all radii by the Einasto density proï¬le (dotted curve)

ğœŒ(ğ‘Ÿ) = ğœŒâˆ’2 exp

(cid:26)

âˆ’

2
ğ›¼

(cid:20)(cid:18) ğ‘Ÿ
ğ‘Ÿâˆ’2

(cid:19) ğ›¼

(cid:21) (cid:27)

âˆ’ 1

(8)

(Einasto 1965), where ğœŒâˆ’2 and ğ‘Ÿâˆ’2 are scale parameters deï¬ned
here as the density and radius at which the proï¬leâ€™s logarithmic
slope crosses d log ğœŒ/d log ğ‘Ÿ = âˆ’2. Here we ï¬x ğ›¼ = 0.17 and ï¬nd
ğ‘Ÿâˆ’2 = 0.55 and ğœŒâˆ’2 = 380. Equation (8) is the same density proï¬le
seen in cold dark matter simulations at much larger scales where the
free-streaming cutoï¬€ is not resolved (e.g. Navarro et al. 2004, 2010),
and such simulations also ï¬nd that ğ›¼ (cid:39) 0.17 supplies a good ï¬t. Only
at the smallest resolved scales, ğ‘Ÿ (cid:46) 5 Ã— 10âˆ’3, does the density proï¬le
here break away from the Einasto form due to the persistence of the
initial ğœŒ âˆ ğ‘Ÿâˆ’3/2 central cusp.

Figure 12 shows three more examples of how the accretion rate Î“

relates to the shallowing of the haloâ€™s density proï¬le.

(i) Halo C2 (left) forms with a density proï¬le that is initially close
to ğœŒ âˆ ğ‘Ÿâˆ’3/2, but its accretion rate Î“ remains high, so this proï¬le
rapidly shallows. By the end of the simulation the inner density
proï¬le is close to ğœŒ âˆ ğ‘Ÿâˆ’1.

(ii) In contrast, the accretion rate of halo H3 (centre) quickly drops
after its formation, allowing its inner ğœŒ âˆ ğ‘Ÿâˆ’3/2 density proï¬le to
remain stable over nearly an order of magnitude in scale factor. The
accretion rate in this case becomes so low that even the outer, steeper
part of the density proï¬le stabilizes after ğ‘ (cid:39) 2.

(iii) Halo H2â€™s accretion rate (right) also slows quickly early on,
leading to an initially static inner density proï¬le. However, around
ğ‘ (cid:39) 1.6 a brief period of rapid accretion builds up the density proï¬le
to a shallower slope. Subsequently the haloâ€™s accretion rate remains
low, and its density proï¬le correspondingly remains static again.

13 Dalal et al. (2010) and Delos et al. (2019) considered models framed in
terms of a haloâ€™s initial density peak instead of its accretion rate, but the
idea is otherwise almost identical. These works also considered variants in
which the radius at which accreted material settles is allowed to change in
response to later accretion. The model in Ludlow et al. (2013) is equivalent
to the claim that Eq. (7) holds if Î“ is evaluated at the scale factor ğ‘ such
that ğ‘€ (ğ‘) = ğ‘€ (ğ‘Ÿ ), where ğ‘€ (ğ‘) is the haloâ€™s mass at ğ‘ while ğ‘€ (ğ‘Ÿ ) is the
enclosed mass proï¬le at the ï¬nal time. Note that since these models cannot
explain the ğœŒ âˆ ğ‘Ÿ âˆ’3/2 cusp, we ï¬nd that they cannot explain the inner proï¬les
of many of our simulated haloes.

100101102103M20010.32a100101Î“â‰¡âˆ†logM200âˆ†loga10âˆ’310âˆ’210âˆ’1100r102Ïr3/2Ïâˆrâˆ’1a=0.41a=0.76a=1.43HaloW1EinastoInner cusps of the ï¬rst haloes

11

Figure 12. Masses (top), accretion rates Î“ (centre) and density proï¬les (bottom) of the haloes C2 (left), H3 (centre), and H2 (right). As in Fig. 11 we use colours
to match the density proï¬les in each lower panel to the corresponding scale factor band in the accretion-rate plot above it. (See that ï¬gureâ€™s caption for further
explanations.) Left-hand panels: Halo C2 maintains a high accretion rate Î“ for some time after formation (like W1 in Fig. 11) and its density proï¬le shallows
signiï¬cantly over time, almost reaching ğœŒ âˆ ğ‘Ÿ âˆ’1 by the end of the simulation. Centre panels: In contrast, halo H3â€™s accretion quickly slows below Î“ âˆ¼ 3 and
remains low. Its inner ğœŒ âˆ ğ‘Ÿ âˆ’3/2 density proï¬le consequently remains stable over nearly an order of magnitude in scale factor. The accretion rate is so low at
late times that even the outer, steeper part of the density proï¬le remains stable from ğ‘ (cid:39) 2 to ğ‘ (cid:39) 5. Right-hand panels: Halo H2â€™s accretion rate initially drops
below Î“ âˆ¼ 3, causing the inner ğœŒ âˆ ğ‘Ÿ âˆ’3/2 proï¬le to persist intact until ğ‘ (cid:39) 1.6 (green), at which point a short burst of accretion builds up the inner density
proï¬le to a somewhat shallower slope. In fact this accretion episode was associated with a triple merger, which also marginally disrupted the central cusp (see
Section 4.2). The accretion rate remains low thereafter, and the density proï¬le correspondingly remains almost static.

4.2 Impact of halo mergers

Ogiya et al. (2016) and Angulo et al. (2017) showed through con-
trolled merger simulations that major mergers (between haloes of
comparable masses) can disrupt ğœŒ âˆ ğ‘Ÿâˆ’3/2 central cusps. We now
present a couple of examples that conï¬rm this eï¬€ect in a cosmolog-
ical setting.

â€¢ Halo H2 merged at ğ‘ (cid:39) 1.6 with two other haloes of roughly
1/3 and 1/4 the main progenitorâ€™s mass. This event is pictured in
the upper row of panels in Fig. 13. The right-hand panels of Fig. 12
show that the amplitude of the central ğœŒ âˆ ğ‘Ÿâˆ’3/2 cusp decreased by
about 10 per cent at this time (and its slope may have also changed).
The large inï¬‚ux of mass mostly settled at larger radii, boosting the
density proï¬le around ğ‘Ÿ âˆ¼ 10âˆ’1.

â€¢ Halo W1 merged at ğ‘ (cid:39) 0.6 with two other haloes of masses
roughly 1/4 and 1/5 the main progenitorâ€™s mass; this event is pictured
in the central row of panels in Fig. 13. Figure 11 shows that like
H2â€™s merger, this event reduced the amplitude of the central density
cusp around ğ‘Ÿ âˆ¼ 10âˆ’2 by about 10 per cent (although we do not have
the resolution to determine whether the slope also changed). Here,
too, the mass primarily settled at larger radii, building up the density
proï¬le around ğ‘Ÿ âˆ¼ 10âˆ’1.

Major mergers have the capacity to alter a haloâ€™s structure at small
radii because dynamical friction causes the core of a large subhalo to
sink rapidly to the centre of a host, shedding most of its mass along
the way (e.g. Mo et al. 2010). The subhalo heats the hostâ€™s material in
the process. This behaviour contrasts with that of smoothly accreted
material and minor mergers, which do not sink in this way and
therefore impact the growing haloâ€™s structure only at intermediate to
large radii (see Section 4.1). We illustrate this eï¬€ect in Fig. 14. This
ï¬gure shows a haloâ€™s density proï¬le at a particular time in the left-
hand panels, and we mark radial bins within the density proï¬le with
diï¬€erent colours. The panels to the right of each density proï¬le show
the distribution of Lagrangian positions (within the initial conditions)
of material residing within each coloured radial bin. The uppermost
row of panels shows halo W1 at an early time, before any signiï¬cant
mergers have taken place. The Lagrangian regions associated with
each radial bin of the density proï¬le are simply connected and nested
at this time, with shells of larger (ï¬nal) radius associated with larger
Lagrangian regions. This behaviour indicates that material that was
initially at a larger radius within the haloâ€™s precursor density peak
â€“ and therefore accreted later â€“ contributes primarily at larger radii
within the nonlinear halo cusp. In contrast, the second row of panels
shows halo W1 after the set of major mergers discussed above has
taken place. Disconnected Lagrangian regions, which we label â€˜Aâ€™

MNRAS 000, 1â€“23 (2021)

100101102103M2000.40.61a10âˆ’1100101Î“â‰¡âˆ†logM200âˆ†loga0.5124a0.5124a10âˆ’310âˆ’210âˆ’1100r101102Ïr3/2a=0.47a=0.75a=1.02Ïâˆrâˆ’1HaloC210âˆ’310âˆ’210âˆ’1100ra=0.47a=0.89a=1.66a=3.11a=5.84HaloH310âˆ’310âˆ’210âˆ’1100ra=0.66a=1.24a=2.32a=4.35HaloH212 M. S. Delos & S. D. M. White

Figure 13. The signiï¬cant merger events (each a diï¬€erent row) that we con-
sider in Section 4.2. From left to right we advance in time. Top row: H2â€™s
merger event at ğ‘ âˆ¼ 1.6 is a three-body event where the two smaller haloes
have masses of about 1/3 and 1/4 the main progenitorâ€™s mass. This event
disturbs the haloâ€™s established ğœŒ âˆ ğ‘Ÿ âˆ’3/2 density proï¬le by about 10 per cent
(see Fig. 12). Centre row: W1â€™s merger event at ğ‘ âˆ¼ 0.6 is also a three-body
event; in this case the two smaller haloes have somewhat smaller masses of
about 1/4 and 1/5 the main progenitorâ€™s mass. This event disturbs the haloâ€™s
established ğœŒ âˆ ğ‘Ÿ âˆ’3/2 density proï¬le to a similar degree (see Fig. 11). Bottom
row: W1â€™s second major merger event at ğ‘ âˆ¼ 1.3 has a mass ratio of about 1/3
but does not appreciably disturb the central ğœŒ âˆ ğ‘Ÿ âˆ’3/2 cusp, at least within
our resolution limits.

and â€˜Bâ€™, now contribute even within the smallest radial bins (blue
and red). The inner regions of W1 thus contain material from both
merging haloes; both contribute to the ï¬nal proï¬le at all radii, even
to the inner cusp. The amplitude of the density proï¬le of W1 is
decreased at small radii as a result of this merging (the density
proï¬le from the uppermost row is overplotted here as a dotted curve
for comparison).

However, disruption of the central cusp is not a guaranteed out-
come of a major merger. In fact, W1 underwent another merger event
at ğ‘ (cid:39) 1.3 with a mass ratio of about 1/3, an event that is pictured
in the lower panels of Fig. 13. The disconnected Lagrangian region
associated with this merging halo is labeled â€˜Câ€™ in the third row of
panels in Fig. 14. This haloâ€™s material was able to contribute density
as deep as the red radial bin within W1. However, this event did
not appreciably disturb the innermost part of the density proï¬le, at
least within our resolution limits. As before, we overplot the previous
rowâ€™s density proï¬le as a dotted curve.

We can also use plots of this kind to show explicitly that major
mergers are not necessary to produce a shallow density proï¬le. In
the lower two rows of Fig. 14, we show the density proï¬le of halo
C3 at two diï¬€erent times. As before, the right-hand panels plot the
Lagrangian positions of the material that resides within each coloured
radial bin at each time. This halo evidently develops a density proï¬le
at intermediate radii that is signiï¬cantly shallower than ğœŒ âˆ ğ‘Ÿâˆ’3/2.
However, there is no signiï¬cant disconnected Lagrangian region that
would mark the impact of a major merger event.14 Instead, material

14 The ring-like structure visible in the bottom-right panel is associated with
coherence of the orbital phases of freshly accreted material. Material initially
within the ring is close to the ï¬rst pericentre of its orbit through the halo,
while material initially in the white region just inside the ring is close to its

MNRAS 000, 1â€“23 (2021)

at large Lagrangian distances (which was accreted later) remains at
large radii within the halo. Accordingly, the central ğœŒ âˆ ğ‘Ÿâˆ’3/2 cusp
remains undisturbed. Indeed, halo C3â€™s most major merger event was
associated with a mass ratio of about 1/20.

The degree to which mergers disrupt the natal cusps of our haloes
appears at most moderate. Figure 15 shows the density proï¬le evolu-
tion for all twelve of our haloes. Despite the signiï¬cant shallowing of
many density proï¬les at intermediate radii â€“ and sometimes even at
the smallest resolved radii â€“ due to deposition of accreted material,
we ï¬nd no case where the initial cusp suï¬€ered more than 10 to 20 per
cent suppression. Resolution limitations mean that there are cases â€“
particularly H2, W3, C1, C2, and C4 â€“ where we cannot exclude that
more major disruption occurred at the smallest radii. Nevertheless,
in no case do we ï¬nd positive evidence for substantial disruption of
the central cusp. In cases where the central ğœŒ = ğ´ğ‘Ÿâˆ’3/2 cusp persists
within our resolution limits, the properties of the haloâ€™s precursor
peak continue to predict its coeï¬ƒcient ğ´ with reasonable accuracy
(horizontal black lines; see Section 3.2).

4.3 Mass and size of the inner cusp

We have now seen many examples of how a haloâ€™s density proï¬le
evolves after formation of its initial ğœŒ âˆ ğ‘Ÿâˆ’3/2 cusp. For instance, halo
W1 (Fig. 11) rapidly built a shallow Einasto density proï¬le on top of
its initial cusp, so that the latter only persists at radii ğ‘Ÿ (cid:46) ğ‘…200/400.
Halo C2 (Fig. 12) underwent similar evolution to the extent that its
central cusp (if it persists) is not even resolved at the ï¬nal snapshot.
In contrast, halo H3â€™s ğœŒ âˆ ğ‘Ÿâˆ’3/2 cusp remains a signiï¬cant portion
of the halo even at the end of the simulation. We now quantify more
precisely how the sizes of our haloesâ€™ natal cusps evolve over time.
We deï¬ne the size and mass of the ğœŒ âˆ ğ‘Ÿâˆ’3/2 cusp in the following
manner. First, we evaluate d log ğœŒ/d log ğ‘Ÿ at each radius ğ‘Ÿ by carrying
out a linear regression in log space over the surrounding factor of
1.5 in ğ‘Ÿ (that is, radii ğ‘Ÿ (cid:48) satisfying ğ‘Ÿ/
1.5ğ‘Ÿ). Next,
we search for the smallest radius at which d log ğœŒ/d log ğ‘Ÿ deviates
from âˆ’1.5 by more than 0.2, but since d log ğœŒ/d log ğ‘Ÿ is noisy, we
ignore deviations that are conï¬ned to less than a factor of 2 in radius.
We deï¬ne the deviation radius obtained in this way to be ğ‘…cusp, the
radius of the natal cusp. We demonstrate the outcome of this process
in Fig. 16 for the C3 halo. It does indeed place ğ‘…cusp where one might
reasonably decide that the central cusp ends.

1.5 < ğ‘Ÿ (cid:48) <

âˆš

âˆš

âˆš

âˆš

1.17 < ğ‘(cid:48) <

For each halo and each scale factor ğ‘, we average the density proï¬le
over the surrounding factor of 1.17 in ğ‘ (that is, scale factors ğ‘(cid:48) satis-
fying ğ‘/
1.17ğ‘) and then evaluate ğ‘…cusp by the above
procedure.15 The resulting evolution of ğ‘…cusp is plotted in Fig. 17.
Note that ğ‘…cusp is not always resolved if the slope d log ğœŒ/d log ğ‘Ÿ is
already much shallower than -1.5 at the minimum resolved radius. If
ğ‘…cusp is not resolved at some time, we do not attempt to resolve it

ï¬rst apocentre subsequent to infall and currently lies outside the orange radial
range in the proï¬le panel. Note that halo C3 formed from a ï¬lament, and the
Lagrangian ring is aligned along that ï¬lamentâ€™s axis.
15 We also make a further adjustment to clean up the evolution plots. Namely,
we iteratively remove the data at a scale factor ğ‘ if the enclosed mass ğ‘€cusp at
that scale factor is larger by at least a factor of 3 than at both of its neighboring
scale factors. We do the same for scale factors at which ğ‘€cusp is smaller by
the same factor than both of its neighbors. Any data points removed in this
way are instead interpolated between the neighboring points. This process
suppresses a few instances in which ğ‘…cusp and ğ‘€cusp jump wildly. Note that
we use all snapshot scale factors, which are separated by roughly a factor of
1.035 in ğ‘, and not only the scale factors shown in Fig. 16, so we do not
remove a signiï¬cant fraction of the data points.

a=1.56H2a=1.67a=1.79a=1.92a=0.55W1a=0.57a=0.59a=0.61a=0.96W1a=1.06a=1.18a=1.31Inner cusps of the ï¬rst haloes

13

Figure 14. Lagrangian regions associated with halo material at set radii. Within each row, the left-hand panel shows a haloâ€™s density proï¬le at a particular time
(averaged over a factor of 1.17 in ğ‘), and in some rows we also overplot the previous rowâ€™s density proï¬le as a dotted curve for comparison. We mark four
coloured radial bins (also separated by vertical lines). The panels to the right of each density proï¬le show the projected distribution of Lagrangian positions
(i.e. positions within the initial conditions) associated with the material that resides in the radial bin of the same colour (and we consider the same time interval,
distributing each particle across multiple bins if necessary). The colour intensity scale is logarithmic between 10âˆ’3 and 1/4 the total projected density (over a
cubic region). The upper three panels show the W1 halo at diï¬€erent times. At ï¬rst, the Lagrangian region associated with each radial bin is simply connected,
and bins at larger radii are associated with larger Lagrangian regions. This behaviour indicates that material that accreted later (because it was initially farther
from the peak) contributes at larger radii within the halo (note that the red, green and yellow regions in all panels are hollow, although this is diï¬ƒcult to see
in projection). The second and third rows of panels for W1 show disconnected Lagrangian regions â€˜Aâ€™, â€˜Bâ€™, and â€˜Câ€™ contributing to the inner radial bins. Each
additional region is associated with a separate halo that merged onto the main system; dynamical friction allowed this these haloes to deposit material close to
the centre of W1. The merger events associated with the â€˜Aâ€™ and â€˜Bâ€™ regions partially disrupted the haloâ€™s central density proï¬le, but the merger associated with
the â€˜Câ€™ region had no such eï¬€ect, depositing all its material at intermediate radii. In contrast, the lower two panels show the C3 halo. This halo did not undergo
any major mergers, and the Lagrangian distribution of the material in its inner radial bins is simply connected and nearly spherically symmetric at both times.
Nevertheless, rapid accretion of diï¬€use material caused this halo to develop a shallow density proï¬le at all but the innermost radii, where the initial ğœŒ âˆ ğ‘Ÿ âˆ’3/2
cusp is preserved.

MNRAS 000, 1â€“23 (2021)

10040200Ïr3/2densityproï¬leatahaloW1a=0.57Lagrangiandistributionofmaterialineachcolouredradialbin10040200Ïr3/2haloW1a=0.96AAB10040200Ïr3/2haloW1a=1.41CC10040200Ïr3/2haloC3a=0.5710âˆ’310âˆ’210âˆ’1100r10040200Ïr3/2-505haloC3a=0.96-505comovingposition-505-50514 M. S. Delos & S. D. M. White

Figure 15. Density proï¬le evolution for all twelve haloes. As in earlier ï¬gures, the density proï¬les are time averaged over successive factors of 1.17 in ğ‘
(diï¬€erent colours). We ï¬nd no evidence, within our resolution limits, for signiï¬cant disruption of the natal cusps due to merger events. The eï¬€ects are limited to
a 10 to 20 per cent reduction in amplitude. We also repeat the cusp predictions (black lines) from Fig. 9, which are based on each haloâ€™s precursor density peak.
Even after halo growth, the initial peak continues to predict the inner cusp reasonably well in cases where the cusp persists within our resolution limits.

.

at any future time; attempting to do so may inappropriately identify
the central cusp with, e.g., the portion of the Einasto density proï¬le
for which the density slope is close to âˆ’1.5. When ğ‘…cusp ceases to be
resolved, we instead simply cut oï¬€ its time evolution curve in Fig. 17.

In the upper panel of Fig. 17, we see that the physical cusp radius
ğ‘…cusp often remains close to constant in time. This behaviour holds
during periods of slow accretion but also during rapid accretion as
long as accretion builds up the density proï¬le primarily at radii out-
side of the central cusp. For instance, halo W1â€™s cusp radius remains
essentially constant over the time interval 0.6 (cid:46) ğ‘ (cid:46) 1.4 even though
accretion during that interval is sometimes rapid enough to build
up a shallow density proï¬le and sometimes not; compare Fig. 11.
However, ğ‘…cusp also typically undergoes one (and only one) sudden
drop when rapid accretion begins to build on top of an established
ğœŒ âˆ ğ‘Ÿâˆ’3/2 cusp. A prime example of this behaviour occurs for halo
H2 at ğ‘ (cid:39) 1.8; compare the right-hand panels of Fig. 12. Finally, at
early times there can be growth in ğ‘…cusp as the initial collapse builds
the density proï¬le outward; compare for instance halo W1â€™s cusp
growth during 0.4 (cid:46) ğ‘ (cid:46) 0.55 to the plot of its density in Fig. 9 over
the same time period. In some cases, growth of ğ‘…cusp can proceed
for some time. This outcome is likely attributable to an accretion rate

MNRAS 000, 1â€“23 (2021)

that remains close to Î“ = 3 for a while; for example, compare H3â€™s
cusp growth during 0.7 (cid:46) ğ‘ (cid:46) 1.2 to the contemporaneous accretion
rate and density proï¬le in the centre panels of Fig. 12. In this case,
the ğœŒ âˆ ğ‘Ÿâˆ’3/2 cusp is not entirely set by the initial collapse but is
further built outward by later accretion.

The lower panel of Fig. 17 plots the evolution of ğ‘…cusp/ğ‘…200 for
each halo. For the haloes arising from the ğ‘› = âˆ’2.67 power spectrum,
accretion is so rapid that the haloâ€™s ğ‘…200 radius quickly grows to more
than 100 times the cusp radius. This picture demonstrates further why
other studies did not ï¬nd the natal ğœŒ âˆ ğ‘Ÿâˆ’3/2 cusp inside haloes for
which rapid accretion built up a shallower intermediate proï¬le. For
instance, Ishiyama (2014) and Angulo et al. (2017) concluded simply
that larger haloes have shallower density proï¬le slopes,16 while Wang
et al. (2020) found that all haloes are well described by the Einasto

16 Angulo et al. (2017) resolved radii below 10âˆ’2 ğ‘…178 for some of their halo
mass bins, and their plot of d log ğœŒ/d log ğ‘Ÿ (Fig. 6 of Angulo et al. 2017)
does show signs of steepening at the smallest radii that they plot. Although
this eï¬€ect lies below the radii at which they expect the simulation to be
numerically converged, numerical artifacts normally push the density proï¬le
towards a shallower rather than a steeper slope (see Appendix B).

101102Ïr3/2a=0.62a=4.06H1a=0.66a=4.35H2a=0.47a=5.84H3101102Ïr3/2a=0.41a=1.43W1a=0.41a=1.23W2a=0.47a=1.66W3101102Ïr3/2a=0.41a=1.67W4a=0.58a=1.50W5a=0.48a=0.91C110âˆ’310âˆ’210âˆ’1100r101102Ïr3/2a=0.47a=1.02C210âˆ’310âˆ’210âˆ’1100ra=0.48a=0.91C310âˆ’310âˆ’210âˆ’1100ra=0.64a=1.41C4Inner cusps of the ï¬rst haloes

15

Figure 16. Demonstration of the procedure through which we identify the
radius ğ‘…cusp of the central cusp. We plot the density proï¬le (top) and log-
arithmic density slope d log ğœŒ/d log ğ‘Ÿ (bottom) of the C3 halo at a number
of diï¬€erent times (colours). At each time, we identify the cusp radius ğ‘…cusp
(vertical line) as the largest radius at which d log ğœŒ/d log ğ‘Ÿ remains within the
range (-1.7,-1.3) (grey band), but we ignore small excursions; see the text.
The resulting radius values appear to reasonably mark the outer edge of the
ğœŒ âˆ ğ‘Ÿ âˆ’3/2 cusp.

Figure 18. Evolution of the masses ğ‘€cusp enclosed within our haloesâ€™ cusp
radii ğ‘…cusp. The upper panel shows ğ‘€cusp in absolute units; behaviours similar
to those in Fig. 17 are evident. The lower panel shows ğ‘€cusp/ğ‘€200, i.e. the
cusp mass in units of the haloâ€™s mass ğ‘€200 (enclosed within ğ‘…200). We ï¬nd
that the rapidly accreting haloes C1â€“C4 and W1â€“W3 quickly grow to such
extent that ğ‘€cusp/ğ‘€200 (cid:46) 10âˆ’3. On the other hand, slowly accreting haloes
like H1, H3, W4, and W5 are able to maintain ğ‘€cusp/ğ‘€200 âˆ¼ 10âˆ’1.

Figure 17. Evolution of the cusp radii ğ‘…cusp of our haloes as a function
of the expansion factor ğ‘. The upper panel shows ğ‘…cusp in absolute units;
generally we ï¬nd that ğ‘…cusp grows initially, drops suddenly at one time as
rapid accretion begins to build up a shallower density proï¬le, and otherwise
remains stable. The lower panel shows instead ğ‘…cusp/ğ‘…200, i.e. the cusp radius
in units of the haloâ€™s radius ğ‘…200 (enclosing 200 times the cosmological mean
density). Rapidly accreting haloes arising from the ğ‘› = âˆ’2.67 and ğ‘› = âˆ’2
power spectra quickly grow to the extent that ğ‘…cusp/ğ‘…200 < 10âˆ’2, but haloes
W4, W5, H1, and H3 maintain slower accretion rates such that ğ‘…cusp remains
close to 10âˆ’1 ğ‘…200.

Figure 19. Accretion rates Î“ â‰¡ Î” log ğ‘€200/Î” log ğ‘ for our haloes, evaluated
as in Section 4.1. The horizontal reference line marks Î“ = 3.

ï¬tting form. These studies did not resolve small enough radii to ï¬nd
the natal cusps inside their rapidly accreting haloes.

In Fig. 18 we similarly plot the mass ğ‘€cusp enclosed inside ğ‘…cusp.
For rapidly accreting haloes arising from the ğ‘› = âˆ’2 and ğ‘› = âˆ’2.67
power spectra, the natal cuspâ€™s contribution quickly drops below 10âˆ’3
of the total halo mass. However, haloes W4 and W5 (arising from the
ğ‘› = âˆ’2 power spectrum) do not accrete rapidly enough to overwhelm
the cusp in this way, so they maintain ğ‘€cusp/ğ‘€200 âˆ¼ 10âˆ’1 for the
full duration of their respective simulations. The naturally slower
accretion rates expected for the ğ‘› = 1 power spectrum also cause
haloes H1 and H3 to maintain ğ‘€cusp/ğ‘€200 around 10âˆ’1 to 10âˆ’2
during an order-of-magnitude increase in the scale factor ğ‘. For
reference, we show in Fig. 19 the accretion rates of our haloes; there

MNRAS 000, 1â€“23 (2021)

r101102Ïr3/2a=0.48a=0.57a=0.66a=0.77a=0.91HaloC310âˆ’310âˆ’210âˆ’1100râˆ’2âˆ’1dlogÏ/dlogr10âˆ’310âˆ’210âˆ’1Rcusp100a10âˆ’210âˆ’1100Rcusp/R200H1H2H3W1W2W3W4W5C1C2C3C410âˆ’210âˆ’1100101102Mcusp100a10âˆ’410âˆ’310âˆ’210âˆ’1100Mcusp/M200H1H2H3W1W2W3W4W5C1C2C3C4100a100101Î“H1H2H3W1W2W3W4W5C1C2C3C416 M. S. Delos & S. D. M. White

Figure 20. Velocity anisotropy parameter (centre panels) and ellipsoidal axis ratios (lower panels) for the haloes H3, W5, C3, and W1 (from left to right). We
also show the density proï¬le at the top, for reference, and all quantities are averaged over successive factors of 1.17 in ğ‘. The ğœŒ âˆ ğ‘Ÿ âˆ’3/2 central cusps of these
haloes have nearly radial velocity distributions (ğ›½ close to 0). However, there is far less uniformity in the three-dimensional shapes. H3 and W1 have triaxial
cusps that evolve signiï¬cantly toward a more spherical shape, with H1â€™s cusp becoming nearly spherical at late times. In contrast, W5 and C3 have very prolate
central cusps that remain so throughout their evolution, at least at the smallest radii; W5â€™s cusp becomes more oblate at intermediate radii.

is a clear correspondence between low accretion rates at late times
and large fractional masses in the central cusps.

4.4 Three-dimensional structure

We brieï¬‚y discuss the three-dimensional structures of our haloes and
their evolution over time. We ï¬rst explore anisotropy in the velocity
structure. The centre panels of Fig. 20 show the velocity anisotropy
parameter

ğ›½ â‰¡ 1 âˆ’ ğœ2

ğ‘¡ /(2ğœ2
ğ‘Ÿ )

(9)

as a function of radius within each of haloes H3, W5, C3, and W1,
where ğœğ‘Ÿ and ğœğ‘¡ are the radial and tangential velocity dispersions,
respectively.17 ğ›½ = 0 represents an isotropic velocity dispersion,
while ğ›½ = 1 implies that all motion is radial. Generally, ğ›½ grows with
radius at small and intermediate radii but drops again as we approach
the haloâ€™s outer edge. This pattern has been seen in cold dark matter
haloes as well (e.g. Navarro et al. 2010). In the context of the ï¬rst
haloes, the interesting feature is that the velocity structure is nearly
isotropic (ğ›½ (cid:39) 0) inside the central ğœŒ âˆ ğ‘Ÿâˆ’3/2 cusps.

We also explore the three-dimensional shapes of our haloes. We
use the algorithm of Allgood et al. (2006) (see also Vera-Ciro et al.
2011), which involves regarding a halo (or concentric subset thereof)
as an ellipsoid and evaluating the associated axis lengths ğ‘™1 â‰¥ ğ‘™2 â‰¥ ğ‘™3
via the haloâ€™s inertia tensor. An ellipsoidâ€™s axis lengths are propor-
tional to the square roots of the eigenvalues of its inertia tensor.

ğ‘Ÿ = (cid:104)ğ‘£2

ğ‘Ÿ (cid:105) âˆ’ (cid:104)ğ‘£ğ‘Ÿ (cid:105)2 and ğœ2

17 We evaluate ğœ2
ğ‘Ÿ (cid:105), where ğ‘£ğ‘Ÿ is a
particleâ€™s radial velocity, ğ‘£ is its total velocity, and the angle brackets denote
the average over particles in a narrow radial bin centred at radius ğ‘Ÿ . That
is, we consider the velocity dispersion at each radius with respect to the net
radial motion at that radius.

ğ‘¡ = (cid:104)ğ‘£2 (cid:105) âˆ’ (cid:104)ğ‘£2

MNRAS 000, 1â€“23 (2021)

Speciï¬cally, this procedure employs the â€œreducedâ€ inertia tensor

ğ¼ğ‘– ğ‘— =

âˆ‘ï¸

ğ‘šğ‘›

ğ‘›

ğ‘› ğ‘¥ ( ğ‘—)
ğ‘¥ (ğ‘–)
ğ‘›
Ëœğ‘Ÿ2
ğ‘›

,

(10)

summed over particles ğ‘› at â€œellipsoidalâ€ radii Ëœğ‘Ÿğ‘›, which avoids
weighting more distant particles more highly. If ğ‘¥ğ‘›, ğ‘¦ğ‘›, and ğ‘§ğ‘›
are coordinates in the ellipsoidâ€™s principal-axes frame, then Ëœğ‘Ÿ2
ğ‘› â‰¡
(ğ‘¥ğ‘›/ğ‘™1)2 + (ğ‘¦ğ‘›/ğ‘™2)2 + (ğ‘§ğ‘›/ğ‘™3)2. Beginning with a spherical ellipsoid
with axes ğ‘™1 = ğ‘™2 = ğ‘™3, we evaluate ğ¼ğ‘– ğ‘— for particles inside the el-
lipsoid, evaluate the resulting new axis lengths (keeping the longest
axis length ğ‘™1 ï¬xed), and rotate the system into the frame of these
new axes. This procedure is iterated until the axis ratios ğ‘™2/ğ‘™1 and
ğ‘™3/ğ‘™1 are converged to better than 10âˆ’3.

The lower panels of Fig. 20 show the axis ratios ğ‘™3/ğ‘™1 and ğ‘™2/ğ‘™1
as a function of the radius ğ‘Ÿ = (ğ‘™1ğ‘™2ğ‘™3)1/3, which is the radius of the
sphere that encloses the same volume as the ellipsoid. Generally these
haloes are highly aspherical, although there is a weak tendency for
them to become more spherical over time, as measured by the ğ‘™3/ğ‘™1
axis ratio. At late times, these haloes tend to be less spherical at large
radii and more spherical at small radii, a trend that is interestingly
the opposite of what Vera-Ciro et al. (2011) found for cold dark
matter haloes. Also, our haloes tend to be comparatively prolate at
large radii, as evidenced by the ratios ğ‘™3/ğ‘™1 and ğ‘™2/ğ‘™1 both lying well
below unity. With respect to the ğœŒ âˆ ğ‘Ÿâˆ’3/2 central cusps, however,
there is little uniformity. H3â€™s cusp is initially triaxial but becomes
nearly spherical at late times. W5 and C3 have highly prolate cusps
that remain so through their evolution, although the portion of W5â€™s
cusp at intermediate radii ğ‘Ÿ (cid:38) 10âˆ’2 becomes more oblate. W1â€™s cusp
is triaxial, although it appears to be evolving rapidly toward a more
spherical shape.

Despite the variety of three-dimensional shapes of haloesâ€™ central
cusps, we ï¬nd one general feature: the cusp tends to align with the
halo at larger radii. Figure 21 shows slices of the equidensity surfaces
of the same four haloes at radii ğ‘Ÿ âˆ¼ 0.01 and ğ‘Ÿ âˆ¼ 0.2. While some

101102Ïr3/2H3W5C3W10.00.5Î²=1âˆ’Ïƒ2t2Ïƒ2ra=0.47a=1.66a=5.84H3a=0.58a=0.94a=1.50W5a=0.48a=0.66a=0.91C3a=0.41a=0.76a=1.43W110âˆ’310âˆ’210âˆ’1100r0.51.0axisratiosH3l2/l1l3/l110âˆ’310âˆ’210âˆ’1100rW510âˆ’310âˆ’210âˆ’1100rC310âˆ’310âˆ’210âˆ’1100rW1Inner cusps of the ï¬rst haloes

17

Figure 21. Slices of the equidensity surfaces of haloes H3, W5, C3, and W1 (from left to right) at ğ‘ = 0.96. Speciï¬cally, we use the density ï¬eld averaged over
the surrounding factor of 1.17 in ğ‘. The upper, centre, and lower panels show diï¬€erent perpendicular slices, while for each halo, the left-hand and right-hand
panels show two diï¬€erent length scales. The equidensity surfaces inside the central cusps (dark curves in each haloâ€™s left-hand panels) tend to be aligned with
those at larger radii (each haloâ€™s right-hand panels).

of the ellipsoidal axis ratios are clearly more extreme at larger radii,
the axes themselves are closely aligned between the inner cusp at
ğ‘Ÿ (cid:46) 0.01 and the broader halo at ğ‘Ÿ âˆ¼ 0.1.

5 MINIMUM RADIUS OF THE INNER CUSP
We have found that the ğœŒ âˆ ğ‘Ÿâˆ’3/2 density cusps of our haloes extend
down to the resolution limits of our simulations, but it is unclear
how much farther this power law could extend. If the dark matter
were inï¬nitely cold, but the initial power spectrum nevertheless had
a small scale cutoï¬€, then it is possible that the cusp could extend to
arbitrarily small radii. However, any thermal motions of dark matter
particles in the initial conditions would impose a minimum radius
below which the ğœŒ âˆ ğ‘Ÿâˆ’3/2 structure must give way to a core. We
now explore what the radius of this core should be.

5.1 Maximum phase-space density

The thermal core can be understood as a consequence of Liouvilleâ€™s
theorem, which implies that the maximum coarse-grained phase-
space density cannot increase with time (Tremaine & Gunn 1979).
As a result, the (time-independent) maximum phase-space density
ğ‘“max of the dark matter at times prior to formation of any nonlinear
structure sets an upper limit on the value of the distribution function
ğ‘“ (x, v) anywhere inside a halo at all later times (e.g. Dalcanton
& Hogan 2001; Strigari et al. 2006; Villaescusa-Navarro & Dalal
2011; MacciÃ² et al. 2012). Simulations suggest that halo centres
approximately saturate this limit (MacciÃ² et al. 2012).

We ï¬rst estimate ğ‘“max. In general, dark matter that was once cou-
pled to the radiation bath is left with some momentum distribution
ğ‘“ ğ‘ (p, ğ‘) that peaks at p = 0 and has width proportional to some

scale momentum ğ‘0 = ğ‘0d (ğ‘d/ğ‘) that declines as ğ‘âˆ’1 from its ini-
tial value ğ‘0d, which was deï¬ned at the scale factor ğ‘d when the dark
matter kinetically decoupled. The maximum value of this distribu-
tion is given by ğ‘“ ğ‘ (0) = ğ¶ ğ‘âˆ’3
, where ğ¶ is a normalization factor
0
independent of ğ‘. Two speciï¬c examples are cold dark matter (CDM)
and warm dark matter (WDM):

(i) In the CDM scenario, dark matter decouples while it is nonrela-
tivistic. In this case it has a Maxwell-Boltzmann momentum distribu-
tion, ğ‘“ ğ‘ (p) = (2ğœ‹)âˆ’3/2 ğ‘âˆ’3
0)], so that ğ¶ = (2ğœ‹)âˆ’3/2
exp[âˆ’p2/(2ğ‘2
0
and ğ‘0d = (ğ‘‡dğ‘š)1/2, where ğ‘‡d is the temperature at decoupling and
ğ‘š is the particle mass.

(ii) In the WDM scenario, dark matter

is a fermion that
is ultrarelativistic. In this case it has an
ğ‘“ ğ‘ (p) =
0 [exp( ğ‘/ğ‘0) + 1]âˆ’1 (where ğœ is the Riemann zeta

decouples while it
ultrarelativistic Fermi-Dirac momentum distribution,
[6ğœ‹ğœ (3)]âˆ’1 ğ‘âˆ’3
function), so that ğ¶ = [12ğœ‹ğœ (3)]âˆ’1 (cid:39) 0.0221 and ğ‘0d = ğ‘‡d.

Let us now consider a time when the dark matter is nonrelativistic
(regardless of whether it was relativistic at decoupling). Its spatial
density is then ğœŒmğ‘âˆ’3, where ğœŒm is the present-day dark matter den-
sity (i.e. at ğ‘ = 1). Consequently, the maximum density in position-
momentum phase space is (ğ¶ ğ‘âˆ’3
0 )(ğœŒmğ‘âˆ’3) = ğ¶ ğœŒm ( ğ‘0dğ‘d)âˆ’3.
Within dark matter haloes we ï¬nd it more convenient to work with
the equivalent position-velocity phase-space density, the maximum
value of which is therefore

ğ‘“max = ğ¶ ğœŒm ( ğ‘0dğ‘d/ğ‘š)âˆ’3,

(11)

where ğ‘š is the mass of the dark matter particle.

We may now estimate a haloâ€™s thermal core radius ğ‘Ÿc as the largest
radius at which its phase-space density reaches the value ğ‘“max. If we
also deï¬ne ğœŒc â‰¡ ğœŒ(ğ‘Ÿc), then we show in Appendix C that
ğœŒcğ‘Ÿ6

c (cid:39) 3 Ã— 10âˆ’5ğºâˆ’3 ğ‘“ âˆ’2
max

(12)

MNRAS 000, 1â€“23 (2021)

HaloH3,a=0.96x-yslicey-zsliceâˆ’0.010.000.01z-xsliceâˆ’0.20.00.2HaloW5,a=0.96âˆ’0.010.000.01âˆ’0.20.00.2HaloC3,a=0.96âˆ’0.010.000.01âˆ’0.20.00.2HaloW1,a=0.96âˆ’0.010.000.01âˆ’0.20.00.2position18 M. S. Delos & S. D. M. White

Figure 22. Matter power spectrum at redshift ğ‘§ = 267 in a 3.5 keV WDM
scenario (solid black curve) compared to appropriately rescaled versions of
our ğ‘› = âˆ’2 and ğ‘› = âˆ’2.67 power-law simulation power spectra. In particular
we rescale to match ğœ, the rms density contrast, and (cid:104)ğ‘˜2 (cid:105). The 3.5 keV
WDM power spectrum appears to eï¬€ectively lie somewhere between these
two power laws.

for a halo with central cusp ğœŒ âˆ ğ‘Ÿâˆ’ğ›¾ with 1 (cid:46) ğ›¾ (cid:46) 1.5. Thus, once a
haloâ€™s rescaled density proï¬le ğœŒğ‘Ÿ6 approaches ğœŒcğ‘Ÿ6
c , its central cusp
must give way to a thermal core.

Figure 23. Predicted core sizes for our simulated haloes if they arise in a
WDM scenario. In particular, we plot the density proï¬les ğœŒ(ğ‘Ÿ ) (scaled by
ğ‘Ÿ 3/2) for the haloes that arise from the ğ‘› = âˆ’2 (dashed curves) and ğ‘› = âˆ’2.67
(solid curves) power spectra. These haloes have been rescaled to correspond
to a 3.5 keV WDM scenario (as described in the text). Each halo is plotted in
a diï¬€erent colour, and for each halo we plot the density proï¬le shortly after
formation (thin curve) and a factor of about 1.9 in the scale factor later (thick
curve). On the left, we show the ğœŒğ‘Ÿ 6 = ğœŒcğ‘Ÿ 6
c line (black) corresponding to
Eq. (12). Each haloâ€™s inner cusp is expected to give way to a central core
where it crosses this line.

5.2 Warm dark matter core sizes

Let us now explore the core sizes that would develop in our simulated
haloes if they were to form in a WDM cosmology. Eq. (A3) of Bode
et al. (2001) gives the characteristic nonrelativistic streaming velocity
( ğ‘0d/ğ‘š)(ğ‘d/ğ‘) as a function of the present-day dark matter density
Î©ğœ’ (in units of the critical density), the Hubble parameter â„, the
dark matter particleâ€™s eï¬€ective number ğ‘›ğœ’ of degrees of freedom,
and its mass ğ‘š. We ï¬x ğ‘š = 3.5 keV, ğ‘”ğœ’ = 1.5, â„ = 0.68, and
Î©ğœ’ = 0.3 (and for simplicity we assume that dark matter constitutes
all of the matter). Consequently, ğ‘0dğ‘d/ğ‘š = 7.8 Ã— 10âˆ’9, and hence
by Eq. (11), ğ‘“max = 1.8 Ã— 1033 M(cid:12) Mpcâˆ’3.18 Now Eq. (12) implies
that the phase-space barrier lies at ğœŒcğ‘Ÿ6

c = 8.0 Ã— 10âˆ’14 M(cid:12) Mpc3.

The simulations, however, have been carried out with arbitrary
units. To ï¬x the units, we must compare our power spectra (Eq. 1)
to the power spectrum that arises in the WDM scenario described
above. We evaluate the matter power spectrum using the ï¬tting form
from Eisenstein & Hu (1998) and normalize it to ğœ8 = 0.81 (Planck
Collaboration et al. 2020) at ğ‘ = 1. Next, we use the transfer func-
tion described in Bode et al. (2001) to apply the small-scale cutoï¬€
corresponding to the WDM scenario above. In particular, we ï¬nd
that the free-streaming length ğ›¼ of Bode et al. (2001) in this scenario
is ğ›¼ = 0.017 Mpc. We now recall that our simulations begin when
the rms density contrast is ğœ = 0.03. The WDM power spectrum
described above must be scaled back to ğ‘§ = 267 (using the growth
function) to have the same rms density contrast. Consequently, we in-
terpret the starting redshift of our simulations to be ğ‘§ = 267, and their
ï¬nal redshifts range over 3.8 < ğ‘§ < 7.0 for the ğ‘› = âˆ’2 and ğ‘› = âˆ’2.67
cases which are most relevant in this context. Figure 22 shows the
WDM power spectrum at the initial time (thick solid curve).

The remaining step is to ï¬x the length scales in the simulations.
Since the simulation power spectra have diï¬€erent forms than the

18 We take the speed of light ğ‘ = 1.

MNRAS 000, 1â€“23 (2021)

WDM power spectrum, there is no unique way to make this as-
sociation. We choose to ï¬x (cid:104)ğ‘˜2(cid:105) (Eq. 3; see the considerations in
Section 2), which evaluates to (cid:104)ğ‘˜2(cid:105) = 150 Mpcâˆ’2 for the WDM
power spectrum. Consequently we take the simulation length unit to
be (cid:104)ğ‘˜2(cid:105)âˆ’1/2 = 8.2 Ã— 10âˆ’2 Mpc (see Table 1), which implies that the
exponential cutoï¬€ wavenumber is ğ‘˜cut (cid:39) 17 Mpcâˆ’1 for ğ‘› = âˆ’2 and
ğ‘˜cut (cid:39) 29 Mpcâˆ’1 for ğ‘› = âˆ’2.67. Figure 22 shows the rescaled ğ‘› = âˆ’2
(dashed curve) and ğ‘› = âˆ’2.67 (thin solid curve) power spectra.

The WDM power spectrum evidently lies eï¬€ectively somewhere
between the ğ‘› = âˆ’2 and ğ‘› = âˆ’2.67 power spectra, so we consider
the nine simulated haloes that arose therefrom. After applying the
scaling described above, we plot density proï¬les for these haloes in
Fig. 23. We also plot the line ğœŒğ‘Ÿ6 = ğœŒcğ‘Ÿ6
c = 8 Ã— 10âˆ’14 M(cid:12) Mpc3;
the interpretation is that each haloâ€™s inner cusp (as long as its slope
lies between ğœŒ âˆ ğ‘Ÿâˆ’3/2 and ğœŒ âˆ ğ‘Ÿâˆ’1) must give way to a central core
once it crosses this line. Evidently, each haloâ€™s ğœŒ âˆ ğ‘Ÿâˆ’3/2 cusp should
extend over about two decades in radius shortly after formation and
up to almost three decades in radius after halo growth in those cases
where the ğ‘Ÿâˆ’3/2 cusp persists. In general, haloes in this WDM sce-
nario have core radii of about 3 pc. At early times, we resolve the
inner cusps of our haloes down to about three times the predicted
core radius, although this resolution worsens as time goes on.

5.3 Cold dark matter core sizes

We also explore core sizes that would arise in a CDM cosmology.
In particular, we suppose that the dark matter has particle mass
ğ‘š = 100 GeV and kinetically decouples at the temperature ğ‘‡d =
30 MeV. In this case, ğ‘0dğ‘d/ğ‘š = 9.2 Ã— 10âˆ’14 and hence ğ‘“max =
3.1 Ã— 1048 M(cid:12) Mpcâˆ’3, which implies that the phase-space barrier
lies at ğœŒcğ‘Ÿ6

c = 2.7 Ã— 10âˆ’44 M(cid:12) Mpc3.

To ï¬nd the power spectrum, we scale the aforementioned Eisen-
stein & Hu (1998) ï¬tting function using the CDM transfer function
in Green et al. (2005). We extrapolate this power spectrum back

10âˆ’1100101k(Mpcâˆ’1)10âˆ’610âˆ’510âˆ’410âˆ’3P(k)3.5keVWDMatz=267n=âˆ’2powerlawn=âˆ’2.67powerlaw10âˆ’510âˆ’410âˆ’310âˆ’2r(Mpc)10111012Ïr3/2(MâŠ™Mpcâˆ’3/2)W1W2W3W4W5C1C2C3C4Inner cusps of the ï¬rst haloes

19

power spectrum along with the corresponding phase-space barrier
ğœŒğ‘Ÿ6 = 2.7 Ã— 10âˆ’44 M(cid:12) Mpc3. Core radii in this scenario evidently
lie around 10âˆ’5 pc, where the proï¬les would cross the phase-space
barrier. Interestingly, despite the huge diï¬€erence in scales between
the ï¬rst haloes in these WDM and CDM scenarios, the core radii are
very similar when considered as fractions of the halo (or cusp) radii.
CDM core radii are only about three times smaller than WDM cores
in this relative sense. Like in the WDM case, the ğœŒ âˆ ğ‘Ÿâˆ’3/2 cusps
of CDM haloes can extend across two to three decades in radius in
cases where they persist.

5.4 Scaling behaviour

The observation that CDM and WDM core sizes are nearly the same,
when considered in relation to the extent of the haloâ€™s inner cusp,
merits further discussion. In a general sense, it is expected that core
sizes and cusp sizes scale together because the former are set by the
dark matter thermal velocity distribution while the latter are set by
the drift distances that result from these velocities. However, it is not
obvious that their mutual scaling should be so tight.

Consider dark matter particles with mass ğ‘š that kinetically decou-
pled at the scale factor ğ‘d during the last radiation-dominated epoch
with characteristic (possibly relativistic) momentum ğ‘0d. Their char-
acteristic comoving drift distance is

ğœ† =

âˆ« ğ‘

ğ‘d

dğ‘(cid:48)

(cid:104)1 + (cid:0) ğ‘0d ğ‘d

(cid:1)âˆ’2(cid:105) âˆ’1/2

ğ‘šğ‘(cid:48)
ğ‘(cid:48)2ğ» (ğ‘(cid:48))

by the scale factor ğ‘, where

Î›fs (cid:39) ln

(cid:34)

8
1+âˆšï¸1+ ( ğ‘0d/ğ‘š)2

(cid:35)

ğ‘eq
ğ‘d

(cid:18) 8ğœ‹ğº
3

=

ğœŒmğ‘eq

(cid:19)âˆ’1/2 ğ‘0dğ‘d

ğ‘š

Î›fs

(13)

(14)

is roughly the logarithm of the factor in ğ‘ over which particles stream
nonrelativistically during radiation domination. Here ğ» (ğ‘) is the
Hubble rate, ğœŒm is the matter density at ğ‘ = 1 today, and ğ‘eq is the
scale factor at matter-radiation equality. In Eq. (14) we assume the
dark matter becomes nonrelativistic long before ğ‘eq and that we are
evaluating ğœ† at a scale factor ğ‘ (cid:29) ğ‘eq. We also neglect changes in the
radiation content, which in general raise Î›fs by a small amount.20

If ğ‘… is the characteristic (comoving) size of a peak in the primordial
density ï¬eld smoothed by free streaming, we expect that ğ‘… âˆ¼ ğœ†. For
a halo that collapses at the scale factor ğ‘c from such a peak, we thus
expect that the haloâ€™s ğœŒ âˆ ğ‘Ÿâˆ’3/2 cusp has coeï¬ƒcient ğ´ = ğœŒğ‘Ÿ3/2 âˆ¼
ğœŒmğ‘âˆ’3/2
ğœ†3/2 and initial radius ğ‘Ÿ0 âˆ¼ ğ‘cğœ† (see Section 3.2). Now
c
through these relations and Eqs. (11), (12), and (13) we ï¬nd that

ğ‘Ÿc/ğ‘Ÿ0 âˆ¼ (ğ‘c/ğ‘eq)âˆ’2/3Î›âˆ’4/3
The mutual scaling between core radius ğ‘Ÿc and cusp radius ğ‘Ÿ0 thus
emerges, and we see that there are two main inï¬‚uences that can

(15)

fs

.

Figure 24. Matter power spectrum at redshift ğ‘§ = 1272 in a 100 GeV CDM
scenario (black) compared to a version of our ğ‘› = âˆ’2.67 power-law simulation
power spectrum that we rescale to match ğœ and (cid:104)ğ‘˜2 (cid:105) (orange).

Figure 25. Predicted core sizes for our simulated haloes if they arise in a CDM
scenario. We plot the density proï¬les ğœŒ(ğ‘Ÿ ) (scaled by ğ‘Ÿ 3/2) for the haloes
that arise from the ğ‘› = âˆ’2.67 power spectrum, and these haloes have been
rescaled to correspond to a 100 GeV CDM scenario with kinetic decoupling
at 30 MeV. As in Fig. 23, each halo is represented by a diï¬€erent colour, and
for each halo we plot the density proï¬le shortly after formation (thin curve)
and a factor of about 1.9 in the scale factor later (thick curve). We show on
the left the ğœŒğ‘Ÿ 6 = ğœŒcğ‘Ÿ 6
c barrier (black) at which each haloâ€™s inner cusp is
expected to give way to a central core.

to ğ‘§ = 1272 so that ğœ = 0.03.19 The resulting power spectrum
is shown as the black curve in Fig. 24. This power spectrum has
(cid:104)ğ‘˜2(cid:105) = 7.4 Ã— 1010 Mpcâˆ’2, so we take our simulation length unit to
be 3.7 Ã— 10âˆ’6 Mpc.

Figure 24 shows the appropriately rescaled version of our ğ‘› =
âˆ’2.67 power spectrum (orange curve). This power spectrum is some-
what too steep to faithfully represent the CDM scenario, but the
mismatch is not serious. We now show in Fig. 25 the appropriately
rescaled density proï¬les of the haloes arising from the ğ‘› = âˆ’2.67

19 We use the growth function that is valid in mixed matter-dark energy
domination. At such early times, the radiation density also has a signiï¬cant
inï¬‚uence on the growth function, but since our simulations were carried
out assuming matter domination, we neglect this eï¬€ect in order to maintain
consistency. Also, baryons do not cluster at the scale of the CDM cutoï¬€,
an eï¬€ect that makes CDM density variations grow slightly more slowly on
such scales (Hu & Sugiyama 1996). Since neither our simulations nor the
Eisenstein & Hu (1998) power spectrum that we use include this eï¬€ect, we
also neglect it in the growth function.

20 ğ» is scaled by (ğ‘”âˆ—/3.36) 1/2 (ğ‘”âˆ—ğ‘ /3.91) âˆ’2/3, where ğ‘”âˆ— and ğ‘”âˆ—ğ‘  are the
eï¬€ective numbers of relativistic degrees of freedom for energy and entropy
density, respectively. Assuming only Standard Model content, this factor is
1 at temperatures below about 1 MeV, roughly 0.9 at temperatures between
1 MeV and 100 MeV, and roughly 0.6 at temperatures above about 100 MeV
(e.g. Husdal 2016). Since ğœ† âˆ¼ ğ» âˆ’1, inclusion of this eï¬€ect can boost ğœ† by up
to a factor of about 2, although typically the eï¬€ect is far smaller because ğ» âˆ’1
appears inside an integral. Warm dark matter, however, can require large ğ‘”âˆ—
at decoupling to give dark matter the observed relic abundance.

MNRAS 000, 1â€“23 (2021)

102103104105106k(Mpcâˆ’1)10âˆ’610âˆ’510âˆ’4P(k)100GeVCDMatz=1272n=âˆ’2.67powerlaw10âˆ’1110âˆ’1010âˆ’910âˆ’810âˆ’7r(Mpc)106107Ïr3/2(MâŠ™Mpcâˆ’3/2)C1C2C3C420 M. S. Delos & S. D. M. White

raise ğ‘Ÿ0 without raising ğ‘Ÿc.21 The ï¬rst possibility is to raise Î›fs
by increasing the duration of nonrelativistic drift (or by raising the
number of relativistic degrees of freedom in the early universe).
This change raises the free-streaming length without altering particle
velocities and hence ğ‘“max. The second possibility is to form haloes
later, which raises the physical free-streaming scale ğ‘cğœ† without
altering ğ‘“max.

CDM and WDM have comparable values of Î›fs (of order 10)
and ğ‘c/ğ‘eq (of order 100), so they approximately preserve the mu-
tual scaling between ğ‘Ÿc and ğ‘Ÿ0. However, nonstandard early-universe
physics can break this scaling to a more serious extent. For instance,
certain inï¬‚ationary (e.g. Ben-Dayan & Brustein 2010) or postinï¬‚a-
tionary (e.g. Erickcek & Sigurdson 2011) scenarios can greatly boost
the power spectrum at small scales, potentially leading to ğ‘c âˆ¼ ğ‘eq
for the ï¬rst haloes. Moreover, if the dark matter decoupled in the
presence of a large number of beyond-Standard Model relativistic
degrees of freedom, this eï¬€ect could signiï¬cantly raise Î›fs. A large
injection of entropy after dark matter decoupling, such as that aris-
ing from a period of early matter domination (e.g. Allahverdi et al.
2021), has a similar eï¬€ect. Also, these considerations only apply to
haloes that form at the free-streaming scale. Inï¬‚ationary dynamics
(e.g. Barnaby & Huang 2009) can give rise to features in the pri-
mordial power spectrum that are completely independent of the free-
streaming scale, and similar features can arise in the matter power
spectrum due to postinï¬‚ationary physics (e.g. Hogan & Rees 1988;
Erickcek et al. 2021). If such a feature is suï¬ƒciently pronounced to
form haloes by direct collapse, those haloes could develop ğœŒ âˆ ğ‘Ÿâˆ’3/2
density proï¬les with arbitrarily small cores.

6 CONCLUSIONS

We have carried out high-resolution cosmological zoom simulations
of twelve ï¬rst-generation haloes of mass corresponding approxi-
mately to the small-scale cutoï¬€ in the ï¬‚uctuation power spectrum.
The three idealized linear power spectra we considered correspond
roughly (but not exactly) to those associated with hot, warm, and
cold dark matter. Our main ï¬ndings are the following:

(i) Soon after collapse and for all three initial power spectra, al-
most all our haloes contained central cusps with ğœŒ âˆ ğ‘Ÿâˆ’3/2 and with
total mass comparable to that of the peak in the linear density ï¬eld
from which the halo originated. We could follow this cusp over as
many as two decades in radius. Cusp formation is independent both of
collapse morphology and of the prominence of small-scale N-body
clumping artifacts in the pre-collapse structure. Collapses through
a ï¬lament, through a sheet, and through more complex caustic net-
works all produce similar cusps. We explicitly veriï¬ed in one case
that the cusp proï¬le is stable with respect to changes in the simulation
resolution.

(ii) Since the cusp forms so quickly after collapse, its coeï¬ƒcient
ğ´ = ğœŒğ‘Ÿ3/2 is sensitive almost wholly to the immediate neighborhood
of the haloâ€™s precursor density peak. This outcome conï¬rms earlier
ï¬ndings by Delos et al. (2019). In particular, we ï¬nd the peakâ€™s height
and spherically averaged characteristic radius, along with the tidal

21 ğ‘Ÿc/ğ‘Ÿ0 is also sensitive to the shape of the initial momentum distribution,
both through the normalization factor ğ¶ (see Section 5.1) and the form
of the power spectrum cutoï¬€, which sets the connection between ğœ† and
the distribution of peak radii ğ‘…. The ğ‘… distribution also depends on the
underlying initial power spectrum of density variations. These are order-unity
considerations, however.

MNRAS 000, 1â€“23 (2021)

tensor at the location of the peak, suï¬ƒce to determine ğ´ to within 10
to 20 per cent.

(iii) Haloes that initially possess ğœŒ âˆ ğ‘Ÿâˆ’3/2 central cusps tend
to develop shallower density proï¬les as they grow. However, unlike
previous works that attributed this process to major mergers, we
ï¬nd that it can be attributed to rapid accretion in general (which
includes major mergers, minor mergers, and accretion of the smooth
background). In fact, this shallowing is consistent with simple models
of the sort presented by Dalal et al. (2010) and Ludlow et al. (2013)
that connect halo density proï¬les to their accretion histories. But
unlike mergers, rapid accretion tends to build up a haloâ€™s density
proï¬le at intermediate and large radii without disturbing its inner
proï¬le; it does not necessarily disrupt the initial ğœŒ âˆ ğ‘Ÿâˆ’3/2 cusp.

(iv) Major mergers can disturb the central ğœŒ âˆ ğ‘Ÿâˆ’3/2 cusp, as
Ogiya et al. (2016) and Angulo et al. (2017) found. In two cases,
we found that a major merger event reduced the amplitude of the
central ğœŒ âˆ ğ‘Ÿâˆ’3/2 cusp by about 10 per cent (although we do not
have the resolution to assess whether the cuspâ€™s slope changed). In
the absence of mergers, on the other hand, the central cusp remains
undisturbed even when accretion is otherwise rapid. We also found
a case where even a major merger had no impact on the central cusp.
Within our halo sample and resolution limits, the extent to which
mergers disrupt the ğœŒ âˆ ğ‘Ÿâˆ’3/2 cusp remains small.

(v) For haloes that grow suï¬ƒciently slowly, the ğœŒ âˆ ğ‘Ÿâˆ’3/2 central
cusp can continue to comprise between 1 and 10 per cent of the total
halo mass even long after the haloâ€™s formation. Two of the haloes
arising from the hot dark matter-like power spectrum maintained a
cusp mass fraction in this range over a factor of about 10 in the scale
factor. On the other hand, a period of rapid accretion tends to swiftly
reduce the cusp mass fraction below 10âˆ’3.

(vi) The ğœŒ âˆ ğ‘Ÿâˆ’3/2 cusp invariably has a nearly isotropic velocity
dispersion. Conversely, it exhibits a wide range of three-dimensional
shapes across diï¬€erent haloes and even for the same halo across
diï¬€erent times. Equidensity surfaces within the cusp tend to align
with those of the halo at larger radii.

(vii) It is still unclear how far down in radius the ğœŒ âˆ ğ‘Ÿâˆ’3/2 cusp
can extend, owing to the limits of our simulation resolution. How-
ever, if the dark matter was once in contact with the radiation bath,
then its residual thermal motion means that any density cusp must
give way to a ï¬nite-density core at small enough radii. Some of our
simulations probe radii down to as little as three times the expected
core radius in a warm dark matter scenario, which suggests that the
question of how much farther the ğœŒ âˆ ğ‘Ÿâˆ’3/2 cusp can extend may be
largely immaterial, at least for conventional dark matter models in
which the power spectrumâ€™s cutoï¬€ arises from thermal free stream-
ing. Nevertheless, the core radius is small enough that the ğœŒ âˆ ğ‘Ÿâˆ’3/2
density proï¬le can be important if it survives.

Survival of the ğœŒ âˆ ğ‘Ÿâˆ’3/2 central cusp through periods of rapid
accretion can lead to density proï¬les resembling that in Fig. 11.
There, a halo with an Einasto density proï¬le at intermediate and
large radii still possesses its natal ğœŒ âˆ ğ‘Ÿâˆ’3/2 cusp at the smallest
radii. In larger-scale cosmological simulations, this cusp might go
unresolved, which could explain why some works (e.g. Wang et al.
2020) found no evidence of ğœŒ âˆ ğ‘Ÿâˆ’3/2 cusps despite resolving the
smallest haloes. Moreover, this picture demonstrates a new avenue by
which the ğœŒ âˆ ğ‘Ÿâˆ’3/2 cusps of the ï¬rst haloes may transition into the
Einasto density proï¬les seen at larger scales. Since this mechanism
does not destroy the cusp, this discovery raises the prospect that a
signiï¬cant number of ğœŒ âˆ ğ‘Ÿâˆ’3/2 cusps could survive up to the present
day.

We studied only a small halo sample over a limited time range.

More work is needed to determine the true extent to which the
ğœŒ âˆ ğ‘Ÿâˆ’3/2 cusps of the ï¬rst haloes persist through cosmic time.
If these cusps survive, they could have observational implications.
The abundance of the smallest subhaloes could be larger than previ-
ously estimated, owing to the lower eï¬ƒciency of tidal stripping for
steep central cusps (PeÃ±arrubia et al. 2010; StÃ¼cker et al. 2022a).
For instance, Lee et al. (2021) concluded that the suppression of
the smallest CDM subhaloes by tidal stripping pushes them outside
the reach of pulsar timing searches. This conclusion may need to
be reassessed if ğœŒ âˆ ğ‘Ÿâˆ’3/2 density proï¬les persist. Separately from
the question of subhalo survival, observable signatures of dark mat-
ter haloes, such as through dark matter annihilation (e.g. Ishiyama
et al. 2010) and astrometric microlensing (Erickcek & Law 2011),
tend to be larger if they have steeper cusps. We also comment that
these considerations are ampliï¬ed for nonstandard cosmological ini-
tial condition scenarios in which small-scale density variations are
boosted (e.g. Erickcek & Sigurdson 2011). The haloes that arise at
those boosted scales grow slowly, so their ğœŒ âˆ ğ‘Ÿâˆ’3/2 cusps may
remain a large fraction of the total mass in haloes.

Finally, we have not addressed the question of why the ğœŒ âˆ ğ‘Ÿâˆ’3/2
density proï¬le arises. This proï¬le appears to be a general conse-
quence of the collapse of a smooth density peak, independent of the
details of the collapse process. It has been observed that the Einasto
or NFW density proï¬les of idealized CDM haloes can largely be
explained by appealing to their accretion histories (Dalal et al. 2010;
Ludlow et al. 2013), an idea that is linked to the notion that material
stratiï¬es within the halo based on its accretion time (see Section 4.1).
However, this idea cannot explain the ğœŒ âˆ ğ‘Ÿâˆ’3/2 density proï¬les of
the ï¬rst haloes; these proï¬les form immediately upon collapse, before
there is any meaningful accretion history. A new idea is needed.

ACKNOWLEDGEMENTS

We thank Neal Dalal, Benedikt Diemer, and Go Ogiya for useful
discussions. The simulations for this work were carried out on the
MPAâ€™s Freya computing cluster at the Max Planck Computing and
Data Facility.

DATA AVAILABILITY

Simulation data are available upon reasonable request to the corre-
sponding author.

REFERENCES

Inner cusps of the ï¬rst haloes

21

Dalal N., Lithwick Y., Kuhlen M., 2010, arXiv e-prints, p. arXiv:1010.2539
Dalcanton J. J., Hogan C. J., 2001, ApJ, 561, 35
Dehnen W., 2001, MNRAS, 324, 273
Delos M. S., Erickcek A. L., Bailey A. P., Alvarez M. A., 2018a, Phys. Rev. D,

97, 041303

Delos M. S., Erickcek A. L., Bailey A. P., Alvarez M. A., 2018b, Phys. Rev. D,

98, 063527

Delos M. S., Bruï¬€ M., Erickcek A. L., 2019, Phys. Rev. D, 100, 023523
Diemand J., Moore B., Stadel J., 2005, Nature, 433, 389
Diemer B., Kravtsov A. V., 2014, ApJ, 789, 1
Einasto J., 1965, Trudy Astroï¬zicheskogo Instituta Alma-Ata, 5, 87
Eisenstein D. J., Hu W., 1998, ApJ, 496, 605
Enzi W., et al., 2021, MNRAS, 506, 5848
Erickcek A. L., Law N. M., 2011, ApJ, 729, 49
Erickcek A. L., Sigurdson K., 2011, Phys. Rev. D, 84, 083503
Erickcek A. L., Ralegankar P., Shelton J., 2021, Phys. Rev. D, 103, 103508
Green A. M., Hofmann S., Schwarz D. J., 2005, J. Cosmology Astropart.

Phys., 2005, 003

Hogan C. J., Rees M. J., 1988, Physics Letters B, 205, 228
Hu W., Sugiyama N., 1996, ApJ, 471, 542
Husdal L., 2016, Galaxies, 4, 78
Huss A., Jain B., Steinmetz M., 1999, MNRAS, 308, 1011
Ishiyama T., 2014, ApJ, 788, 27
Ishiyama T., Ando S., 2020, MNRAS, 492, 3662
Ishiyama T., Makino J., Ebisuzaki T., 2010, ApJ, 723, L195
Lee V. S. H., Mitridate A., Trickle T., Zurek K. M., 2021, Journal of High

Energy Physics, 2021, 28

Lovell M. R., Frenk C. S., Eke V. R., Jenkins A., Gao L., Theuns T., 2014,

MNRAS, 439, 300

Ludlow A. D., et al., 2013, MNRAS, 432, 1103
MacciÃ² A. V., Paduroiu S., Anderhalden D., Schneider A., Moore B., 2012,

MNRAS, 424, 1105

Mo H., van den Bosch F. C., White S., 2010, Galaxy Formation and Evolution
Moore B., Quinn T., Governato F., Stadel J., Lake G., 1999, MNRAS, 310,

1147

Navarro J. F., Frenk C. S., White S. D. M., 1996, ApJ, 462, 563
Navarro J. F., Frenk C. S., White S. D. M., 1997, ApJ, 490, 493
Navarro J. F., et al., 2004, MNRAS, 349, 1039
Navarro J. F., et al., 2010, MNRAS, 402, 21
Ogiya G., Hahn O., 2018, MNRAS, 473, 4339
Ogiya G., Nagai D., Ishiyama T., 2016, MNRAS, 461, 3385
PeÃ±arrubia J., Benson A. J., Walker M. G., Gilmore G., McConnachie A. W.,

Mayer L., 2010, MNRAS, 406, 1290

Planck Collaboration et al., 2020, A&A, 641, A6
Polisensky E., Ricotti M., 2015, MNRAS, 450, 2172
Power C., Navarro J. F., Jenkins A., Frenk C. S., White S. D. M., Springel V.,

Stadel J., Quinn T., 2003, MNRAS, 338, 14

Sheth R. K., Mo H. J., Tormen G., 2001, MNRAS, 323, 1
Springel V., Pakmor R., Zier O., Reinecke M., 2021, MNRAS, 506, 2871
Strigari L. E., Bullock J. S., Kaplinghat M., Kravtsov A. V., Gnedin O. Y.,

Abazajian K., Klypin A. A., 2006, ApJ, 652, 306

Allahverdi R., et al., 2021, The Open Journal of Astrophysics, 4, 1
Allgood B., Flores R. A., Primack J. R., Kravtsov A. V., Wechsler R. H.,

StÃ¼cker J., Hahn O., Angulo R. E., White S. D. M., 2020, MNRAS, 495, 4943
StÃ¼cker J., Ogiya G., Angulo R. E., Aguirre-Santaella A., SÃ¡nchez-Conde

Faltenbacher A., Bullock J. S., 2006, MNRAS, 367, 1781

M. A., 2022a, arXiv e-prints, p. arXiv:2207.00604

Anderhalden D., Diemand J., 2013, J. Cosmology Astropart. Phys., 2013, 009
Angulo R. E., White S. D. M., 2010, MNRAS, 401, 1796
Angulo R. E., Hahn O., Abel T., 2013, MNRAS, 434, 3337
Angulo R. E., Hahn O., Ludlow A. D., Bonoli S., 2017, MNRAS, 471, 4687
Avila-Reese V., ColÃ­n P., Valenzuela O., Dâ€™Onghia E., Firmani C., 2001, ApJ,

559, 516

Bardeen J. M., Bond J. R., Kaiser N., Szalay A. S., 1986, ApJ, 304, 15
Barnaby N., Huang Z., 2009, Phys. Rev. D, 80, 126018
Ben-Dayan I., Brustein R., 2010, J. Cosmology Astropart. Phys., 2010, 007
Bertschinger E., 2006, Phys. Rev. D, 74, 063509
Binney J., Tremaine S., 2008, Galactic Dynamics: Second Edition
Bode P., Ostriker J. P., Turok N., 2001, ApJ, 556, 93
Busha M. T., Evrard A. E., Adams F. C., 2007, ApJ, 665, 1

StÃ¼cker J., Angulo R. E., Hahn O., White S. D. M., 2022b, MNRAS, 509,

1703

Tremaine S., Gunn J. E., 1979, Phys. Rev. Lett., 42, 407
Vera-Ciro C. A., Sales L. V., Helmi A., Frenk C. S., Navarro J. F., Springel

V., Vogelsberger M., White S. D. M., 2011, MNRAS, 416, 1377

Villaescusa-Navarro F., Dalal N., 2011, J. Cosmology Astropart. Phys., 2011,

024

Wang J., White S. D. M., 2007, MNRAS, 380, 93
Wang J., White S. D. M., 2009, MNRAS, 396, 709
Wang J., Bose S., Frenk C. S., Gao L., Jenkins A., Springel V., White S. D. M.,

2020, Nature, 585, 39

White S. D. M., Frenk C. S., Davis M., 1983, ApJ, 274, L1

MNRAS 000, 1â€“23 (2021)

22 M. S. Delos & S. D. M. White

Figure A1. Total enclosed mass proï¬les of our haloes (diagonal curves
through the centre) along with the mass proï¬les contributed by low-resolution
particles only (lower right). We average these proï¬les over the ï¬nal factor of
1.17 in the scale factor (i.e. from ğ‘f /1.17 to ğ‘f ). Black tick marks in the
lower right show for each primary (low-resolution) simulation the mass of
one low-resolution particle (but since we time average it, the mass proï¬le
of low-resolution particles is not required to advance in integer multiples
thereof). Evidently, low-resolution particles comprise (cid:46) 1 per cent of each
halo, and all such particles reside at radii too large to aï¬€ect this studyâ€™s
conclusions (compare Fig. 10).

APPENDIX A: MIXING OF LOW- AND
HIGH-RESOLUTION PARTICLES

Section 2 describes how we prepare our high-resolution halo simu-
lations. After choosing the halo in a low-resolution simulation, we
identify the Lagrangian region spanned by halo particles and replace
all of the low-resolution particles in that region with much more nu-
merous high-resolution particles. To spare computational expense,
however, we do not make the high-resolution region so large as to
ensure that low-resolution particles never fall into the high-resolution
halo. In this appendix, we show that any numerical artifacts that arise
from this choice cannot impact our results.

Mixing of particles of diï¬€erent masses can accelerate two-body
relaxation eï¬€ects (e.g. Binney & Tremaine 2008). Artiï¬cial energy
exchange between simulation particles causes the more massive par-
ticles to gradually sink to the centre of the system while the light
particles are dynamically heated. However, we plot in Fig. A1 the
total enclosed mass proï¬le ğ‘€ (ğ‘Ÿ) of each of our haloes along with the
mass proï¬le contributed by low-resolution particles at the ï¬nal scale
factor ğ‘f. Evidently, each haloâ€™s low-resolution particles contribute
1 per cent or less of the total mass. Moreover, all such particles re-
side at radii so large that this small mass fraction cannot alter the
conclusions of our study. Comparison with Fig. 10 shows that, for
all haloes, the low-resolution particles lie outside both the central
ğœŒ âˆ ğ‘Ÿâˆ’3/2 cusp and any shallower portion of the density proï¬le
created by rapid accretion.

APPENDIX B: NUMERICAL CONVERGENCE AT SMALL
RADII

We simulated halo W5 at the highest spatial resolution of all of our
haloes (see Table 2). In this section we test numerical convergence
by simulating the same halo at worse resolution; speciï¬cally we raise
the simulation particle mass ğ‘š ğ‘ and the force softening length ğœ–.

MNRAS 000, 1â€“23 (2021)

We carried out two simulations in which we raise the particle mass
by factors of 8 and 64 and the softening length by factors of 2 and
4, respectively. Figure B1 plots this haloâ€™s density proï¬le at four
diï¬€erent times in the original simulation (cyan) and in both reduced-
resolution simulations (red and black). All density proï¬les transition
into a core at small radii, but this core is clearly artiï¬cial in that
its radius scales with the spatial resolution. The ğœŒ âˆ ğ‘Ÿâˆ’3/2 part of
the density proï¬le, on the other hand, appears to be converged with
respect to simulation resolution at all four times.

We ï¬nd that the radius above which the density proï¬le is converged
is reasonably well approximated by 5ğœ–, where ğœ– is the force-softening
length. Figure B1 depicts the density proï¬le at radii below 5ğœ– with
a thin dotted line. The idea here is that force softening introduces a
bias (e.g. Dehnen 2001) that makes systems less tightly bound, and
the relative eï¬€ect becomes larger as we consider systems closer to the
softening scale. However, this criterion somewhat fails at the earliest
times for reasons that are unclear. In particular, the solid red and cyan
curves in the upper left-hand panel begin to shallow at small radii ğ‘Ÿ
even when ğ‘Ÿ > 5ğœ–, but this shallowing occurs at diï¬€erent radii for
diï¬€erent resolution levels. Consequently, tendencies of some of our
haloesâ€™ early density proï¬les to shallow at the smallest radii, e.g. in
Fig. 9, should be interpreted with some skepticism.

Also, while the 5ğœ– condition mostly suï¬ƒces for W5, simulations
carried out over a longer duration must also consider two-body relax-
ation between simulation particles. We evaluate the relaxation time
scale

ğ‘¡rel (ğ‘Ÿ) (cid:39)

ğ‘
8 log(ğ‘Ÿ/ğœ–)

2ğœ‹ğ‘Ÿ
âˆšï¸ğº ğ‘€/ğ‘Ÿ

(B1)

(e.g. Binney & Tremaine 2008; Power et al. 2003) as a function of
radius ğ‘Ÿ, where ğ‘€ and ğ‘ are the mass and particle count enclosed
within ğ‘Ÿ. The radius ğ‘Ÿrel at which ğ‘¡rel is equal to the age of the
universe (a decent approximation for the age of any halo) then serves
as an alternative minimum converged radius. In Fig. B1, radii with
5ğœ– < ğ‘Ÿ < ğ‘Ÿrel are shown in principle with a thin dashed line, but
only at ğ‘ = 1.52 (bottom right) for the lowest-resolution simulation
(black) does an example of such a radius appear. This restriction
becomes more relevant for haloes simulated for longer durations (see
Fig. 3).

APPENDIX C: PHASE-SPACE STRUCTURE OF A
DENSITY CUSP

In this appendix, we quantify the phase-space structure of a density
cusp for the purpose of determining the size of the core that arises
from phase-space conservation. Consider an equilibrium spherical
dark matter system with the density proï¬le
ğœŒ(ğ‘Ÿ) = ğ´ğ‘Ÿâˆ’ğ›¾ .
The coeï¬ƒcient ğ´ is the systemâ€™s sole scaling parameter with dimen-
sions of density Ã— lengthğ›¾. If ğ›¾ < 3, then the systemâ€™s enclosed mass
proï¬le is

(C1)

ğ‘€ (ğ‘Ÿ) =

4ğœ‹
3 âˆ’ ğ›¾

ğ´ğ‘Ÿ3âˆ’ğ›¾ .

If ğ›¾ < 2, then the systemâ€™s potential is

Î¦(ğ‘Ÿ) =

4ğœ‹
(3 âˆ’ ğ›¾)(2 âˆ’ ğ›¾)

ğº ğ´ğ‘Ÿ2âˆ’ğ›¾,

(C2)

(C3)

and dimensional considerations imply that the velocity dispersion
has the same scaling, ğœ2 âˆ ğ‘Ÿ2âˆ’ğ›¾. Consequently, the distribution
function scales as ğ‘“ âˆ ğœŒ/ğœ3 âˆ ğ‘Ÿ ğ›¾/2âˆ’3 âˆ Î¦âˆ’1/2âˆ’2/(2âˆ’ğ›¾) . Let us

10âˆ’310âˆ’210âˆ’1100101r10âˆ’310âˆ’210âˆ’1100101102103104M(<r)H1H2H3W1W2W3W4W5C1C2C3C4Inner cusps of the ï¬rst haloes

23

Figure B1. Density proï¬le of the W5 halo at four diï¬€erent times (panels) and three diï¬€erent simulation resolutions (colours), indicated by the particle mass
ğ‘šğ‘. The force-softening length ğœ– is scaled as ğ‘š1/3
ğ‘ . While the density proï¬les all transition into a uniform-density core at small radii (indicated by a steeply
rising curve in this scaled plot), this transition is evidently artiï¬cial because the transition radius scales with the simulation resolution. Meanwhile, the ğœŒ âˆ ğ‘Ÿ âˆ’3/2
behaviour (horizontal) is stable with respect to simulation resolution. We plot the density proï¬le at radii below 5ğœ– with a thin dotted line; ğœ– itself is marked for
each simulation by a coloured tick at the bottom of each panel. We also plot radii above 5ğœ– but below the relaxation limit ğ‘Ÿrel (where the relaxation time scale
becomes shorter than the age of the universe; see the text) with a thin dashed line, although for this halo the only example occurs for ğ‘ = 1.52 (lower right-hand
panel) at the lowest simulation resolution (black).

assume that the distribution function is isotropic, so it depends on
energy ğ¸ = Î¦ + ğ‘£2/2 alone, i.e. ğ‘“ (ğ‘Ÿ, ğ‘£) âˆ ğ¸ âˆ’1/2âˆ’2/(2âˆ’ğ›¾) . Recall
from Section 4.4 that the velocity dispersion inside the central cusp
is indeed nearly isotropic. If we also assume that ğ›¾ > 0, then we can
normalize ğ‘“ by requiring that âˆ« d3v ğ‘“ (ğ‘Ÿ, ğ‘£) = ğœŒ(ğ‘Ÿ). Then
(cid:17)

Î“

(cid:16) ğ›¾
2âˆ’ğ›¾ + 3
2
(cid:16) ğ›¾
(cid:17)
2âˆ’ğ›¾

Î“

ğœŒ(ğ‘Ÿ)
Î¦(ğ‘Ÿ)3/2

(cid:20)

1 +

ğ‘£2
2Î¦(ğ‘Ÿ)

(cid:21) âˆ’ 1

2 âˆ’ 2
2âˆ’ğ›¾

, (C4)

ğ‘“ (ğ‘Ÿ, ğ‘£) = (2ğœ‹)âˆ’3/2

where Î“ is the gamma function.

At each radius ğ‘Ÿ, the maximum phase-space density is obtained by

setting ğ‘£ = 0:22

ğ‘“ (ğ‘Ÿ, 0) =

[(3âˆ’ğ›¾)(2âˆ’ğ›¾)]3/2
29/2ğœ‹3

Î“

(cid:17)

(cid:16) ğ›¾
2âˆ’ğ›¾ + 3
2
(cid:17)
(cid:16) ğ›¾
2âˆ’ğ›¾

Î“

ğºâˆ’3/2 ğ´âˆ’1/2ğ‘Ÿ ğ›¾/2âˆ’3

(C5)

(where we have substituted Eqs. C1 and C3). If some maximum
phase-space density ğ‘“max is set by dark matter microphysics, as
discussed in Section 5, then the radius ğ‘Ÿc at which ğ‘“max is reached is
thus

2
6âˆ’ğ›¾

(cid:17)

Î“

ğ‘Ÿc =

(cid:20) (3âˆ’ğ›¾)(2âˆ’ğ›¾)
8ğœ‹2

6âˆ’ğ›¾ ï£®
(cid:21) 3
ï£¯
ï£¯
ï£¯
ï£¯
ï£¯
ï£°
If we deï¬ne ğœŒc = ğœŒ(ğ‘Ÿc) and substitute ğ´ = ğœŒcğ‘Ÿ ğ›¾

(cid:16) ğ›¾
2âˆ’ğ›¾ + 3
2
(cid:17)
(cid:16) ğ›¾
2âˆ’ğ›¾

ï£¹
ï£º
ï£º
ï£º
ï£º
ï£º
ï£»

Î“

c , then

(ğº3 ğ´ ğ‘“ 2

max)âˆ’ 1

6âˆ’ğ›¾ .

(C6)

ğœŒcğ‘Ÿ6

c =

(cid:20) (3 âˆ’ ğ›¾)(2 âˆ’ ğ›¾)
8ğœ‹2

Î“

(cid:17)

(cid:16) ğ›¾
2âˆ’ğ›¾ + 3
2
(cid:17)
(cid:16) ğ›¾
2âˆ’ğ›¾

Î“

(cid:21) 3 ï£®
ï£¯
ï£¯
ï£¯
ï£¯
ï£¯
ï£°

2

ï£¹
ï£º
ï£º
ï£º
ï£º
ï£º
ï£»

Figure C1. Sensitivity of the phase-space barrier ğœŒcğ‘Ÿ 6
c to the density proï¬le
slope ğ›¾. In particular, the maximum phase-space density within a ğœŒ âˆ ğ‘Ÿ âˆ’ğ›¾
density cusp begins to exceed ğ‘“max where ğœŒğ‘Ÿ 6 drops below ğœŒcğ‘Ÿ 6
c . For the
typical slopes 1 (cid:46) ğ›¾ (cid:46) 1.5 observed in this work and others, ğœŒcğ‘Ÿ 6
c (cid:39) 3 Ã—
10âˆ’5ğºâˆ’3 ğ‘“ âˆ’2
max.

deï¬nes the general barrier in ğœŒâ€“ğ‘Ÿ space at which ğ‘“max is reached.
The right-hand side of this equation depends only on ğ‘“max and not
on the parameters of the particular halo, other than ğ›¾. In fact, within
the range 1 < ğ›¾ < 1.5, ğœŒcğ‘Ÿ6
c is almost independent of ğ›¾ as well. We
plot its dependence on ğ›¾ in Fig. C1; evidently,
ğœŒcğ‘Ÿ6

c (cid:39) 3 Ã— 10âˆ’5ğºâˆ’3 ğ‘“ âˆ’2
max

(C8)

ğºâˆ’3 ğ‘“ âˆ’2
max

(C7)

for any halo within this slope range.

22 Interestingly, Eq. (C5) implies that spatially denser haloes (with larger ğ´)
have lower phase-space density, owing to their higher velocity dispersion.

MNRAS 000, 1â€“23 (2021)

101Ïr3/2a=0.58mp=2.1Ã—10âˆ’5mp=2.7Ã—10âˆ’6mp=3.3Ã—10âˆ’7a=0.79mp=2.1Ã—10âˆ’5mp=2.7Ã—10âˆ’6mp=3.3Ã—10âˆ’710âˆ’410âˆ’310âˆ’210âˆ’1r101Ïr3/2a=1.07mp=2.1Ã—10âˆ’5mp=2.7Ã—10âˆ’6mp=3.3Ã—10âˆ’710âˆ’410âˆ’310âˆ’210âˆ’1ra=1.52mp=2.1Ã—10âˆ’5mp=2.7Ã—10âˆ’6mp=3.3Ã—10âˆ’70.00.51.01.52.0Î³0123Ïcr6c/(10âˆ’5Gâˆ’3fâˆ’2max)