MNRAS 000, 1–23 (2021)

Preprint 13 July 2022

Compiled using MNRAS LATEX style ﬁle v3.0

Inner cusps of the ﬁrst dark matter haloes:
Formation and survival in a cosmological context

M. Sten Delos,1★ Simon D. M. White1
1Max Planck Institute for Astrophysics, Karl-Schwarzschild-Str. 1, 85748 Garching, Germany

Accepted XXX. Received YYY; in original form ZZZ

2
2
0
2

l
u
J

1
1

]

O
C
.
h
p
-
o
r
t
s
a
[

1
v
2
8
0
5
0
.
7
0
2
2
:
v
i
X
r
a

ABSTRACT
We use very high resolution cosmological zoom simulations to follow the early evolution of twelve ﬁrst-generation haloes formed
from gaussian initial conditions with scale-free power spectra truncated on small scales by a gaussian. Initial collapse occurs with
a diverse range of sheet- or ﬁlament-like caustic morphologies, but in almost all cases it gives rise to a numerically converged
density cusp with 𝜌 = 𝐴𝑟 −3/2 and total mass comparable to that of the corresponding peak in the initial linear density ﬁeld. The
constant 𝐴 can be estimated to within about 10 per cent from the properties of this peak. This outcome agrees with earlier work
on the ﬁrst haloes in cold and warm dark matter universes. Within central cusps, the velocity dispersion is close to isotropic, and
equidensity surfaces tend to align with those of the main body of the halo at larger radii. As haloes grow, their cusps are often
(but not always) overlaid with additional material at intermediate radii to produce proﬁles more similar to the Einasto or NFW
forms typical of more massive haloes. Nevertheless, to the extent that we can resolve them, cusps survive at the smallest radii.
Major mergers can disturb them, but the eﬀect is quite weak in the cases that we study. The cusps extend down to the resolution
limits of our simulations, which are typically a factor of several larger than the cores that would be produced by phase-space
conservation if the initial power spectrum cutoﬀ arises from free streaming.

Key words: methods: numerical – cosmology: theory – dark matter

1 INTRODUCTION

In the idealized cold dark matter (CDM) picture, density variations
are present at all scales within the initial mass distribution. These den-
sity variations seed gravitationally collapsed haloes that form hierar-
chically through accretion and mergers of smaller haloes. Numerical
simulations of this scenario have found that the spherically averaged
density proﬁles 𝜌(𝑟) of these haloes are remarkably universal as a
function of the radius 𝑟. Navarro et al. (1996, 1997) showed that all
CDM haloes are well described by a functional form – now called the
Navarro–Frenk–White (NFW) proﬁle – that approaches 𝜌 ∝ 𝑟−1 at
small radii and steepens towards 𝜌 ∝ 𝑟−3 as the outer "virial" radius
of the halo is approached. Navarro et al. (2004) later found that the
Einasto density proﬁle (Einasto 1965), in which the logarithmic den-
sity slope varies with radius as d log 𝜌/d log 𝑟 ∝ −𝑟 𝛼 with 𝛼 ∼ 0.17,
supplies a slightly better ﬁt. This proﬁle’s density slope becomes
even shallower at small radii than the NFW asymptotic limit of −1
(Navarro et al. 2010).

This picture is incomplete, however. Most models of particle dark
matter possess some thermal motion in the initial conditions. This
motion smooths out the primordial density ﬁeld on a characteristic,
free-streaming scale. For example, if the dark matter is the lightest
neutralino in a supersymmetric extension of the Standard Model with
a mass of order 100 GeV, then the free-streaming scale corresponds
to roughly an Earth mass, and the ﬁrst haloes form at about this mass
(e.g. Green et al. 2005). For warm dark matter (WDM) models, the

★ E-mail: sten@mpa-garching.mpg.de

© 2021 The Authors

free-streaming mass scale could be as large as ∼ 108 M(cid:12) (e.g. Enzi
et al. 2021). The ﬁrst haloes form via the direct monolithic collapse of
smooth density peaks at this scale. Compared to the NFW or Einasto
density proﬁles associated with idealized CDM haloes, the density
proﬁles of these ﬁrst haloes tend to be steeper at small radii, with
slopes approaching d log 𝜌/d log 𝑟 = −3/2 (Diemand et al. 2005;
Ishiyama et al. 2010; Anderhalden & Diemand 2013; Ishiyama 2014;
Polisensky & Ricotti 2015; Angulo et al. 2017; Ogiya & Hahn 2018;
Delos et al. 2018a,b; Ishiyama & Ando 2020).1

Yet the relevance of these 𝜌 ∝ 𝑟−3/2 cusps to cosmological haloes
remains uncertain. The central density slope tends to be shallower
for more massive haloes (Ishiyama 2014; Angulo et al. 2017), which
suggests that steep inner cusps may relax into shallower NFW or
Einasto forms over time as haloes grow. Moreover, a separate body
of work (Huss et al. 1999; Avila-Reese et al. 2001; Busha et al.
2007; Wang & White 2009; Lovell et al. 2014; Wang et al. 2020)
continues to ﬁnd no evidence of steep central cusps in even the
smallest haloes, instead concluding that these haloes possess the same
NFW or Einasto density proﬁles as their idealized CDM counterparts.
It is also noteworthy that simulations that resolve the free-streaming
scale are polluted by smaller-scale structures that arise artiﬁcially
from discreteness noise (e.g. Wang & White 2007), an issue that

1 Dark matter halo density proﬁles that approach 𝜌 ∝ 𝑟 −3/2 at small radii
were suggested earlier by Moore et al. (1999) in the context of idealized
CDM, but later works (e.g. Navarro et al. 2004) found that this behaviour did
not hold as simulation resolution improved.

 
 
 
 
 
 
2 M. S. Delos & S. D. M. White

could cast doubt on the numerical robustness of the density proﬁles
in these simulations.

The present study is aimed at clarifying the extent to which
𝜌 ∝ 𝑟−3/2 central density cusps arise and persist in a cosmologi-
cal context. We carry out very high resolution zoom simulations of
twelve ﬁrst-generation haloes, grown from three diﬀerent initial lin-
ear power spectra, and we track the structure and the density proﬁles
of these haloes through their formation and early evolution. The de-
tails of the initial collapse diﬀer dramatically in the twelve cases, as
does the degree of artiﬁcial structuring present during the formation
process. Our ﬁrst objective is to test whether these diverse formation
sequences all result in haloes with 𝜌 ∝ 𝑟−3/2 in their inner regions.
Our second goal is to explore the survival of these cusps. Appealing
to the results of idealized simulations, Ogiya et al. (2016) and Angulo
et al. (2017) argued that major mergers drive the transition of 𝜌 ∝
𝑟−3/2 cusps toward the shallower NFW or Einasto forms found in
larger haloes. On the other hand, studies of CDM haloes by Dalal
et al. (2010) and Ludlow et al. (2013), among others, found the
overall mass accretion history of a halo, which is usually dominated
by minor mergers and diﬀuse accretion rather than by major mergers
(e.g. Angulo & White 2010), to be a good predictor of its density
proﬁle. Our halo sample exhibits a variety of accretion and merger
histories, the range of which is enhanced by our sampling of very
diﬀerent initial power spectra. We explore how the later-time density
proﬁles of our haloes vary with accretion and merger history, and we
investigate how this aﬀects their initial central cusps.

If they survive, 𝜌 ∝ 𝑟−3/2 central cusps might have signiﬁcant
observational implications. Subhaloes with steeper central cusps are
substantially more resistant to tidal disruption (Peñarrubia et al. 2010;
Stücker et al. 2022a), so 𝜌 ∝ 𝑟−3/2 cusps could boost the abundance
of the lowest-mass subhaloes in the haloes of the Milky Way and other
large galaxies. Steeper cusps are also associated directly with stronger
observational signatures. For instance, prospects for the detection of
dark subhaloes using annihilation radiation are enhanced because the
annihilation luminosity diverges logarithmically towards 𝑟 = 0 for
a proﬁle with 𝜌 ∝ 𝑟−3/2. This behaviour illustrates the importance
of understanding the range of radii encompassed by the cusps of
the ﬁrst haloes. Our ﬁnal aim is thus to explore this question. Our
simulations can determine the maximum radii of the cusps, but they
do not resolve the minimum radius. However, if the initial density
ﬁeld was smoothed by free streaming of the dark matter particles, then
these same motions must tame the central cusp by imposing a core
at the maximum phase-space density allowed by Liouville’s theorem
(Tremaine & Gunn 1979). We study the phase-space structure of the
inner cusp analytically to determine the radius at which it must give
way to a core.

Our main results support the robustness of 𝜌 ∝ 𝑟−3/2 cusps in
the ﬁrst haloes. We ﬁnd that such cusps arise for haloes with wildly
diﬀerent formation sequences and are well converged with respect to
simulation resolution. As our haloes grow, rapid accretion is the main
eﬀect leading to shallower density proﬁles, but this process works
by building up the density at intermediate radii without substantially
altering the inner cusp. Consequently, haloes can develop apparently
shallow Einasto-like density proﬁles at large and intermediate radii
while retaining the initial 𝜌 ∝ 𝑟−3/2 cusp at the smallest radii. Major
merger events can disturb this central cusp, but their impact is rela-
tively minor in the cases that we have studied. Finally, the radius at
which phase-space constraints force a cusp to give way to a core is
suﬃciently small in realistic models that the 𝜌 ∝ 𝑟−3/2 cusp can span
several decades in radius. These ﬁndings suggest that 𝜌 ∝ 𝑟−3/2 cen-
tral cusps may survive long enough to be observationally relevant,

MNRAS 000, 1–23 (2021)

Figure 1. The power spectra from which we draw our simulation initial
conditions. We show the dimensionless form P (𝑘) ≡ [𝑘3/(2 𝜋2) ] 𝑃 (𝑘). The
length units are ﬁxed such that (cid:104)𝑘2 (cid:105) = 1, so the gaussian cutoﬀ scale is 𝑘cut =
√︁2/(3 + 𝑛). These spectra are normalized so that the rms density contrast
is 𝜎 = 0.03. The vertical cyan lines indicate the fundamental frequency
associated with the box employed for simulations with each power spectrum.

although studies involving larger halo samples and longer time spans
(and hence larger growth factors) are needed to be certain.

This article is organized as follows. In Section 2, we discuss our
simulation setup and the properties of our simulated haloes. In Sec-
tion 3, we explore halo formation mechanisms and the density cusps
that emerge. In Section 4, we explore how and why halo density pro-
ﬁles evolve over time, and we study the extent to which the 𝜌 ∝ 𝑟−3/2
cusps survive this process. In Section 5, we use analytic arguments to
evaluate the radius at which an inner density cusp must give way to
a core with ﬁnite central density. We summarize our results in Sec-
tion 6. Finally, Appendices A and B validate the numerical robustness
of our simulation results, while Appendix C presents mathematical
details relating to the calculation of the core size in Section 5.

2 SIMULATION SETUP

2.1 Power spectra and units

To explore scenarios in which density variations are cut oﬀ at small
scale, we consider Einstein-de Sitter cosmologies with initial power
spectra taking the form

𝑃(𝑘) ∝ 𝑘 𝑛 exp[−(𝑘/𝑘cut)2],

(1)

i.e. power laws multiplied by a gaussian of scale 𝑘 = 𝑘cut.2 Specif-
ically, we consider the three power-law indices 𝑛 = 1, 𝑛 = −2, and
𝑛 = −2.67. These power spectra are depicted in Fig 1; we show the
dimensionless form P (𝑘) ≡ [𝑘3/(2𝜋2)]𝑃(𝑘), indicating the typical
(squared) relative amplitude of density variations as a function of
their scale. Generally, power spectra with 𝑛 close to −3 are associ-
ated with the presence of signiﬁcant density variations over a broad
range of scales. In contrast, the 𝑛 = 1 power spectrum has signiﬁ-
cant support only within a narrow range. In standard cosmological
scenarios, cold dark matter is associated with 𝑛 ∼ −3 at scales close
to the cutoﬀ while warmer dark matter is associated with 𝑛 farther
from −3. For instance, we will see later that the power spectrum
associated with 3.5-keV warm dark matter (e.g. Bode et al. 2001)
lies somewhere between the 𝑛 = −2.67 and 𝑛 = −2 power laws near

2 A cutoﬀ of exactly this form arises from free streaming if the thermal
velocity distribution is Maxwell-Boltzmann (e.g. Bertschinger 2006).

10−210−1100101k10−610−510−410−3P(k)≡[k3/(2π2)]P(k)n=1n=−2n=−2.67Table 1. The units that we employ in this study. We specify comoving units
here; for physical units the scale factor 𝑎 is deﬁned such that 𝑎 = 𝜎 in linear
theory.

quantity

unit

length
density
mass

(cid:104)𝑘2 (cid:105)−1/2
¯𝜌
¯𝜌 (cid:104)𝑘2 (cid:105)−3/2

the cutoﬀ. Substantially larger power-law indices are not observa-
tionally viable in this context, although they arose in the original hot
dark matter models (e.g. White et al. 1983) and are also found for
cold dark matter for some nonstandard cosmological initial condi-
tion scenarios (e.g. Erickcek & Sigurdson 2011). In this paper, we do
not aim to reproduce any particular cosmology but rather to explore
the formation of ﬁrst-generation objects using idealized initial power
spectra.

The power spectra in Fig. 1 are normalized so that the (unﬁltered)

rms density contrast is 𝜎 = 0.03, where

𝜎2 =

∫ ∞

0

d𝑘
𝑘

P (𝑘).

We also ﬁx our length units so that (cid:104)𝑘2(cid:105) = 1, where
(cid:104)𝑘2(cid:105) = 𝜎−2 ∫ ∞

𝑘2P (𝑘),

d𝑘
𝑘

0

(2)

(3)

which leads to 𝑘cut = √︁2/(3 + 𝑛) and puts the peak of P at 𝑘 = 1.
The choice to ﬁx 𝜎 and (cid:104)𝑘2(cid:105) is a convenience; we expect that with this
choice, the density peaks arising from diﬀerent power spectra will
have comparable size, structure and amplitude. In particular, Delos
et al. (2019) found (see also Section 3.2) that the inner structures
of the ﬁrst haloes are sensitive almost entirely to the heights 𝛿 and
characteristic sizes |𝛿/∇2𝛿|1/2 of their progenitor peaks in the linear
density ﬁeld 𝛿(x). In the high-peak limit, the values of |𝛿/∇2𝛿|1/2
sharply cluster around (cid:104)𝑘2(cid:105)−1/2 (Bardeen et al. 1986).3 Therefore, we
obtain similar peak heights for diﬀerent power spectra by matching
𝜎 and similar peak sizes by matching (cid:104)𝑘2(cid:105).

In our simulations we will take the initial scale factor to be 𝑎 =
0.03, so that 𝑎 = 𝜎 in linear theory. We also deﬁne mass units such
that the mean comoving cosmological density is 1. The units and
conventions are summarized in Table 1.4

2.2 Simulation procedure

We use the Gadget-4 simulation code (Springel et al. 2021) to exe-
cute our simulations. First, we carry out one primary simulation for
each of the three power spectra in Fig. 1. In each case we use second-
order Lagrangian perturbation theory to produce a perturbed grid of

3 We comment that if we were interested in halo counts instead of density
proﬁles, the more natural length scale would instead be (cid:104)𝑘4 (cid:105)−1/2 (cid:104)𝑘2 (cid:105)1/2 =
√︁2/(5 + 𝑛) 𝑘−1
cut, which sets the number density of peaks (Bardeen et al. 1986).
4 For the power spectrum given by Eq. (1), the “half-mode” scale commonly
considered in studies of warm dark matter (e.g. Enzi et al. 2021) is 𝑘hm =
1.18𝑘cut (as a wavenumber) or 𝜆hm = 5.3𝑘−1
cut (as a wavelength). Here we
use the deﬁnition of the half-mode scale as the scale at which the cutoﬀ
suppresses the amplitudes (not power) of density variations by a factor of
two. Consequently the half-mode mass 𝑀hm ≡ (4 𝜋/3) ¯𝜌𝜆3
in our units
hm
is 𝑀hm = 1800, 𝑀hm = 225, and 𝑀hm = 42.7 for 𝑛 = 1, 𝑛 = −2, and
𝑛 = −2.67, respectively. This mass scale is not particularly meaningful for
haloes; see for instance Fig. 3 and footnote 5.

Inner cusps of the ﬁrst haloes

3

Figure 2. Projected density ﬁeld within a representative region of each sim-
ulation at 𝑎 = 2 (when the rms density contrast 𝜎 = 2 in linear theory). The
region is a cube of width 261(cid:104)𝑘2 (cid:105)−1/2; for 𝑛 = −2.67 this is the entire box.
The vastly higher amplitude of large-scale power in the 𝑛 = −2 and 𝑛 = −2.67
simulations, compared to the 𝑛 = 1 simulation, is immediately evident. The
latter produces an essentially uniform distribution of haloes, while the former
produce structures that approach the size of the displayed region.

10243 particles inside a periodic box of width 643𝑘−1
cut. This choice
means that the Nyquist frequency associated with the initial particle
grid is 5𝑘cut. We then simulate each box up to some scale factor
𝑎 > 2 under the assumption of matter domination. The simulation
force softening length here is set to 0.03 times the initial interparticle
spacing. A portion of each resulting simulation box at 𝑎 = 2 is shown
in Fig. 2; in particular we show a cube of width 261(cid:104)𝑘2(cid:105)−1/2, which
for 𝑛 = −2.67 is the entire box. The imprint of the power spectrum
is evident here. The 𝑛 = 1 simulation’s dearth of large-scale power
yields an essentially uniform distribution of tiny haloes, whereas the
substantial amplitude of large-scale power in the 𝑛 ≤ −2 simulations
produces much larger haloes and ﬁlaments; in the 𝑛 = −2.67 case
these structures begin to approach the box size.

From each of these primary simulations, we select a range of
haloes to resimulate at much higher resolution. The selection is
mostly arbitrary, but we favor haloes that formed by 𝑎 ∼ 0.6. We
aim to ensure that there is a reasonable sense in which each halo ini-
tially formed by direct collapse. To boost the resolution, we identify
each low-resolution particle that resides within the halo’s spherical-
overdensity radius 𝑅178 (enclosing an average density 178 times the
cosmological mean) at some late time. We then locate that particle
within the initial conditions and replace it with a glass consisting of
between 4.0 × 103 and 2.6 × 105 high-resolution particles (depending
on the halo). We also include in this procedure particles that are out-
side the ﬁnal halo but lie in the initial conditions between any halo
particle and the high-resolution region’s centre of mass. For each
such high-resolution halo, we then carry out another simulation that
includes that halo’s high-resolution particles along with the remain-
ing original low-resolution particles (which retain their original mass
and force-softening length). Note that due to the short duration of our
simulations and our focus on inner density proﬁles, it is not necessary
to ensure that low-resolution particles never enter the high-resolution
halo. We discuss in Appendix A the extent to which low-resolution
particles do enter our haloes, showing that they remain at radii too
large to aﬀect our conclusions.

The numerical parameters associated with the high-resolution halo
simulations are listed in Table 2. We simulate twelve haloes in this
way, which we name H1–H3 (from the 𝑛 = 1 power spectrum),
W1–W5 (from the 𝑛 = −2 power spectrum), and C1–C4 (from the
𝑛 = −2.67 power spectrum). The mass accretion histories of these
haloes are depicted in Fig. 3 over the period that we simulate them
at high resolution.5

5 Figure 3 already demonstrates the value of our choice of units. By ﬁxing

MNRAS 000, 1–23 (2021)

n=1n=−2n=−2.674 M. S. Delos & S. D. M. White

Table 2. Numerical parameters associated with our high-resolution halo sim-
ulations. For each halo (and associated power spectral index 𝑛), we list the
number 𝑁high of high-resolution particles, their mass 𝑚𝑝, the softening length
𝜖 , and the ﬁnal expansion factor and halo mass, 𝑎f and 𝑀f .

𝑛

halo

𝑁high

𝑚𝑝

𝜖

1
1
1
−2
−2
−2
−2
−2
−2.67
−2.67
−2.67
−2.67

H1
H2
H3
W1
W2
W3
W4
W5
C1
C2
C3
C4

2.4 × 108
1.5 × 108
5.6 × 107
3.0 × 108
1.9 × 108
1.4 × 108
1.6 × 108
5.9 × 108
8.6 × 108
5.6 × 108
2.2 × 108
4.7 × 108

2.1 × 10−5
2.1 × 10−5
2.1 × 10−5
2.1 × 10−5
2.1 × 10−5
2.1 × 10−5
2.1 × 10−5
3.3 × 10−7
4.1 × 10−6
4.1 × 10−6
4.1 × 10−6
5.1 × 10−7

4.3 × 10−4
4.3 × 10−4
4.3 × 10−4
4.3 × 10−4
4.3 × 10−4
4.3 × 10−4
4.3 × 10−4
1.1 × 10−4
2.5 × 10−4
2.5 × 10−4
2.5 × 10−4
1.2 × 10−4

𝑎f

4.72
5.06
6.51
1.50
1.28
1.69
1.68
1.52
1.00
1.19
1.03
1.41

𝑀f

1.4 × 103
2.1 × 103
9.5 × 102
3.1 × 103
1.8 × 103
9.8 × 102
1.4 × 103
1.0 × 102
2.3 × 103
2.0 × 103
8.4 × 102
1.6 × 102

Figure 3. The spherical-overdensity mass 𝑀200 (within a spherical region
enclosing a mean density 200 times the cosmic average) of each halo that we
study, as a function of the scale factor 𝑎. The curve associated with each halo
terminates where we end the simulation.

In later sections, we plot halo density proﬁles down to a minimum
radius that is determined by the simulation particle count and the
force softening length 𝜖. Speciﬁcally, we consider the two radii 𝑟rel,
at which the age of the universe is equal to the two-body relaxation
time scale 𝑡rel (Eq. B1), and 𝑟soft = 5𝜖. We then plot density proﬁles
only at radii larger than both 𝑟rel and 𝑟soft. We test a density proﬁle
for numerical convergence in Appendix B and ﬁnd that these choices
determine reasonably well the minimum radius that is converged with
respect to simulation resolution.

3 FORMATION OF THE INNER CUSP

We now explore the formation of the central cusp during the initial
collapse of the high-resolution haloes presented above. A major goal
of this section is to show that a wide variety of collapse sequences
all give rise to the same power-law 𝜌 ∝ 𝑟−3/2 inner density proﬁle.

the characteristic sizes | 𝛿/∇2 𝛿 |1/2 ∼ 1 of peaks in the linear density ﬁeld,
we ensure that all haloes have masses of order unity at the time they collapse.

MNRAS 000, 1–23 (2021)

Figure 4. Density proﬁle of halo H1 during its collapse. The upper panel
shows density 𝜌 as a function of radius 𝑟 , while the lower panel scales the
vertical axis by 𝑟 3/2. We plot physical, not comoving, quantities. Diﬀerent
colours represent diﬀerent times. The density proﬁle begins to stabilize around
𝑎 = 0.55, after which it is essentially ﬁxed and only grows outward in radius.
The power law of the inner proﬁle is about 𝜌 ∝ 𝑟 −3/2 (horizontal on the lower
panel).

We also discuss the connection between this feature and the initial
density ﬁeld.

3.1 The formation process

We ﬁrst focus on haloes arising from the 𝑛 = 1 power spectrum. Fig-
ure 4 shows the density proﬁle of the H1 halo during and shortly after
its formation. This halo forms around 𝑎 (cid:39) 0.6, and its inner density
proﬁle immediately settles at 𝜌 (cid:39) 60𝑟−3/2 (in physical coordinates).
From this point on, the density proﬁle essentially remains stable at
small radii, only growing outward due to new accretion. This picture
closely resembles that in Delos et al. (2019), even with the present
study’s signiﬁcantly improved spatial resolution.

Figure 5 shows the halo’s surrounding density ﬁeld during its
formation. We show three orthogonal projections at each time, and
to clarify the picture, we align these projections with the principal
axes of the tidal tensor at the halo’s Lagrangian position within the
initial density ﬁeld. Evidently, the halo’s precursor overdensity ﬁrst
collapses into a one-dimensional ﬁlament (second column in Fig. 5)
aligned in the 𝑧 direction with very little extent in either the 𝑥 or the
𝑦 direction. This ﬁlament begins to break up into regular fragments,
easily visible in the third column, which are a well-known numerical
artifact in simulations of this type (e.g. Wang & White 2007; Angulo
et al. 2013; Lovell et al. 2014). Finally, a collapsed halo forms near
the densest point of the ﬁlament. For convenience we also plot the
spherically averaged density proﬁle at each time. By 𝑎 = 0.59 the
inner 𝜌 (cid:39) 60𝑟−3/2 cusp is already present. The halo’s outer density
caustic is clearly visible in the proﬁle at this time around 𝑟 (cid:39) 2×10−2,
and the ﬁlament’s outer caustic can also be seen around 𝑟 (cid:39) 8 × 10−2
(the latter will soon be swallowed by the growing halo; see Fig. 4).
In Fig. 5, the inner cusp could be interpreted as forming from
a collection of artiﬁcial ﬁlament fragments, a prospect that might
cast doubt on the validity of the central proﬁle of the resulting halo.

100a10−1100101102103M200H1H2H3W1W2W3W4W5C1C2C3C4102104106ρa=0.45a=0.55a=0.68a=0.84HaloH110−310−210−1100r101102ρr3/2HaloH1Inner cusps of the ﬁrst haloes

5

Figure 5. Formation of the halo H1. We plot three diﬀerent orthogonal projections of the density ﬁeld (upper three rows) at four diﬀerent times (columns). These
projections are aligned with the principal axes of the initial tidal tensor. Material initially collapses to form a ﬁlament (ﬁrst three columns), which is evident
because two projections show a linearly extended object while the third suggests a point-like object. Within this ﬁlament the collapsed halo eventually forms
(last column). Fragmentation of the ﬁlament visible in the third column is a numerical artifact. In the bottom row, we show the spherically averaged density
proﬁle corresponding to the pictures above. Evidently, by 𝑎 = 0.59 (last column) the halo’s stable 𝜌 (cid:39) 60𝑟 −3/2 density proﬁle is already present. Within the
lower panels, the vertical line marks half the width of the displayed box (i.e. the radius from the centre to the left or right edge), while the faint grey diagonal
line indicates the cosmological mean density. In the upper panels of the left column we include directional references to clarify the relationship between the
three projections; for instance the upper panels are projected in the “𝑧” direction, and the “𝑥” and ”𝑦” directions therein are indicated by arrows.

These fragments arise because the discrete simulation particles that
comprise the ﬁlament tend to cluster (a process that may be viewed as
the triggering of a one-dimensional Jeans instability by discreteness
noise).6 However, two lines of evidence suggest that the 𝜌 ∝ 𝑟−3/2
cusp is robust.

(i) In Appendix B, we explicitly test the density proﬁle of the
W5 halo for numerical convergence. This halo also exhibits a clear
𝜌 ∝ 𝑟−3/2 power-law density proﬁle at small radii, and its proﬁle is
stable with respect to changes in the simulation’s spatial and mass
resolution. In contrast, the mass and number of artiﬁcial ﬁlament
fragments scale with a simulation’s linear resolution (Wang & White
2007).

(ii) As we will see next, a halo that collapses from a two-
dimensional sheet (instead of a one-dimensional ﬁlament) also de-
velops a clear 𝜌 ∝ 𝑟−3/2 density cusp, even though the sheet exhibits
far weaker artiﬁcial structuring.

Figure 6 depicts the density ﬁeld around the H3 halo during its
collapse. We show again the ﬁeld projected along the tidal tensor’s
principal axes. The material in this case collapses into a sheet (ﬁrst

two columns), as indicated by two of the projections showing a
linearly extended object while the third shows no apparent collapsed
object at all.7 In the second column artiﬁcial small-scale structure is
visible in the sheet and is ampliﬁed as it collapses along a second
axis, as seen in the third column. It is, however, far weaker than
the fragmentation in Fig. 5. Finally, the halo forms in the rightmost
column. The lower panels show the spherically averaged density
proﬁle, and by 𝑎 = 0.45 (rightmost column), the halo has developed
a 𝜌 (cid:39) 90𝑟−3/2 inner density cusp.

So far we have only studied haloes arising from the 𝑛 = 1 power
spectrum. We now show examples of haloes arising from each of
the 𝑛 = −2 and 𝑛 = −2.67 power spectra. Figures 7 and 8 show the
density ﬁelds surrounding haloes W1 and C1, respectively, during
their collapse. Each exhibits its own unique behaviour. The material
of the W1 halo (Fig. 7) initially collapses into a ﬁlament, but the
halo forms at the end of this ﬁlament, so unlike H1 (Fig. 5), it is
not clear that W1 can be viewed as arising from the collapse of
the ﬁlament itself. Meanwhile, the material of the C1 halo (Fig. 8)
exhibits a range of behaviour during its collapse. It ﬁrst collapses
into a very pronounced sheet; this sheet subsequently collapses into

6 Simulation methods exist that can eliminate these artifacts (Stücker et al.
2020, 2022b), although we do not employ them here.

7 The principal-axis projections are particularly valuable in the case of sheet
collapse, as most projection angles would show no clear evidence of collapse.

MNRAS 000, 1–23 (2021)

a=0.46zxya=0.50a=0.55a=0.59xzyyzx10−310−210−1100r100101102ρr3/2HaloH110−310−210−1100r10−310−210−1100r10−310−210−1100r6 M. S. Delos & S. D. M. White

Figure 6. Formation of the halo H3. As in Fig. 5, we plot the density ﬁeld projected along the principal axes of the initial tidal tensor (upper three panels) along
with the spherically averaged density proﬁle (lower panels) at four diﬀerent times (columns); see that ﬁgure’s caption for further explanation. The material in
this case collapses into a sheet (ﬁrst two columns), which is evidenced by a linearly extended object visible along two of the principal axes and no collapsed
object visible along the third. Artiﬁcial small-scale structure is visible in the sheet in the top image of the second and third columns and in the lower image (“𝑦”
projection) of the third column, but it is far less pronounced than the ﬁlament fragmentation seen in Fig. 5. The halo’s stable inner 𝜌 (cid:39) 90𝑟 −3/2 density proﬁle
has already developed by 𝑎 = 0.45 (last column).

a ﬁlament followed almost immediately by formation of the halo,
which promptly accretes another collapsed ﬁlament edge-on. Despite
these variations, both haloes develop an inner density proﬁle close
to 𝜌 (cid:39) 80𝑟−3/2 by the ﬁnal snapshot shown.

Figure 9 shows density proﬁles during the collapse phase and
shortly afterwards for all twelve of our high-resolution haloes. All
of these haloes develop density proﬁles with 𝜌 ∼ 𝑟−3/2 that remain
eﬀectively stable over a factor of at least 1.3 in scale factor, extending
to larger radii as the haloes accrete new material. Some of these
density proﬁles, such as those of C1 and C2, do grow moderately in
amplitude over time, an eﬀect we explore further in Section 4. The
density proﬁles of our highest-resolution haloes – W5 and C4 – show
some tendency toward shallowing at the smallest radii. However,
it is unclear whether this behaviour is converged with respect to
simulation resolution, as we discuss in Appendix B, and studies
with yet higher resolution are needed to test this. Aside from the
uncertainty in these two cases, the 𝜌 ∝ 𝑟−3/2 density cusp appears
to be a robust consequence of the direct collapse of a smooth initial
density peak, independent of the details of the collapse.

et al. (2019) noted that since the 𝜌 ∝ 𝑟−3/2 cusp stabilizes so quickly
after collapse, its properties must be sensitive only to the immediate
neighborhood of the precursor density peak. Such a peak can be
locally characterized by its height 𝛿 and its characteristic comoving
radius 𝑅 ≡ |𝛿/∇2𝛿|1/2. Its collapse dynamics are also sensitive to the
tidal tensor 𝜕𝑖 𝜕 𝑗 𝜙 (where 𝜙 is the peculiar potential), which can be
described by its ellipticity 𝑒 and prolateness 𝑝.8 From dimensional
considerations, we expect that the amplitude 𝐴 of the 𝜌 = 𝐴𝑟−3/2
cusp should be proportional to ¯𝜌(𝑎𝑐)(𝑎𝑐 𝑅)3/2, where 𝑎𝑐 is the
expansion factor at which the peak collapses and ¯𝜌(𝑎𝑐) = ¯𝜌𝑎−3
𝑐
is the cosmological density at 𝑎𝑐. As above, ¯𝜌 is the comoving
cosmological density (equal to 1 in our simulations). Consequently,
we may write

𝐴 = 𝛼 ¯𝜌𝑎−3/2

𝑐

𝑅3/2

(4)

for some universal proportionality constant 𝛼. Here we evaluate 𝑎𝑐 as
a function of 𝛿, 𝑒, and 𝑝 using the ellipsoidal collapse approximation
in Sheth et al. (2001).9

3.2 Connection to the precursor density ﬁeld

Despite the varied details of the collapse process, the central cusps of
the ﬁrst haloes develop from particularly simple initial conditions: the
inner regions of smooth peaks in the primordial density ﬁeld. Delos

MNRAS 000, 1–23 (2021)

8

𝜆1+𝜆3−2𝜆2
2(𝜆1+𝜆2+𝜆3 )

If 𝜆1 > 𝜆2 > 𝜆3 are the eigenvalues of −𝜕𝑖 𝜕𝑗 𝜙, then 𝑒 ≡

𝜆1−𝜆3
2(𝜆1+𝜆2+𝜆3 )
. Note that since 𝜆1 + 𝜆2 + 𝜆3 ∝ 𝛿, the three quantities

and 𝑝 ≡
𝛿, 𝑒, and 𝑝 fully specify the tidal tensor up to rotation.
9 For our haloes, the predicted 𝑎𝑐 lies within about 5 per cent of the scale
factor at which the 𝜌 ∝ 𝑟 −3/2 cusp ﬁrst appears. Using the latter scale factor

a=0.39zxya=0.41a=0.43a=0.45xyzyxz10−310−210−1100r101102ρr3/2HaloH310−310−210−1100r10−310−210−1100r10−310−210−1100rInner cusps of the ﬁrst haloes

7

Figure 7. Formation of the halo W1. We plot the density ﬁeld projected along the principal axes of the initial tidal tensor (upper three rows of panels) along with
the spherically averaged density proﬁle (lower panels) at four diﬀerent times (columns); see the caption of Fig. 5 for further explanation. The halo’s material
initially collapses into a ﬁlament (ﬁrst two columns), similarly to the case of the H1 halo (Fig. 5). Unlike H1, however, W1 forms at the end of its ﬁlament (third
column). Moreover, while artiﬁcial fragmentation is visible at this time, the halo has clearly already formed, as evidenced by comparing the density proﬁles in
the third and fourth columns at the innermost resolved radii. By 𝑎 = 0.38 (last column) a 𝜌 (cid:39) 70𝑟 −3/2 density proﬁle is already well developed.

Figure 8. Formation of the halo C1. We plot the density ﬁeld projected along the principal axes of the initial tidal tensor (upper three rows of panels) along with
the spherically averaged density proﬁle (lower panels) at ﬁve diﬀerent times (columns); see the caption of Fig. 5 for further explanation. This halo’s material
initially collapses into a sheet (ﬁrst column), which is far more pronounced than the sheet associated with the H3 halo (Fig. 6). This sheet soon collapses into
a ﬁlament (third column) followed almost immediately by the halo (fourth column). The halo’s 𝜌 (cid:39) 70𝑟 −3/2 density proﬁle is well developed by 𝑎 = 0.45 (last
column); meanwhile, another ﬁlament is about to accrete edge-on, although its accretion will not change the density proﬁle signiﬁcantly (see Fig. 9).

MNRAS 000, 1–23 (2021)

a=0.34zxya=0.35a=0.36a=0.38xzyyzx10−2100r101102ρr3/2HaloW110−2100r10−2100r10−2100ra=0.35zxya=0.38a=0.40a=0.43a=0.45xyzyxz10−2100r101102ρr3/2HaloC110−2100r10−2100r10−2100r10−2100r8 M. S. Delos & S. D. M. White

Figure 9. Density proﬁles of all of our high-resolution haloes during their collapse. As in Fig. 4, the vertical axis is scaled by 𝑟 3/2; we plot physical, not
comoving, quantities; and diﬀerent colours represent diﬀerent times. The haloes all develop 𝜌 ∝ 𝑟 −3/2 density cusps very quickly after they collapse. In some
cases there is a tendency for the proﬁle to shallow at the smallest radii, but it is unclear whether this behaviour is numerically converged (see Appendix B). The
horizontal black line indicates the cusp amplitude 𝐴 = 𝜌𝑟 3/2 predicted from each halo’s precursor density peak using Eq. (4) with 𝛼 = 24. This line terminates
at the estimated initial cusp radius 𝑟0 predicted from the same peak data using Eq. (6). There is some scatter, but overall these predictions match well the actual
properties of the cusps.

We can also estimate the size of the 𝜌 ∝ 𝑟−3/2 central cusp shortly
after collapse. Close to a peak in the linear density ﬁeld, the mean
density contrast within comoving radius 𝑞 scales as 1− (𝑞/𝑅)2/10.10
Spherical shells at radii 𝑞 > 0 can be approximated as undergoing el-
lipsoidal collapse within the same tidal ﬁeld with this lower enclosed
density contrast. Now consider the shell that collapses at 𝑎 = 1.17𝑎𝑐.
A factor of 1.17 in 𝑎 corresponds to one dynamical time, in the sense
of Binney & Tremaine (2008), for an object whose density is 200
times the cosmological mean. This shell has Lagrangian radius 𝑞
satisfying 1 − (𝑞/𝑅)2/10 = 1.17−1, so it encloses the mass

𝑀0 =

4𝜋
3

𝑞3 ¯𝜌 =

4𝜋
3

103/2 (cid:18)

1 −

1
1.17

(cid:19)3/2

𝑅3 ¯𝜌 (cid:39) 7.3𝑅3 ¯𝜌.

(5)

The collapsed halo therefore achieves a mass of approximately 𝑀0
after one dynamical time interval. If its density proﬁle is 𝜌 = 𝐴𝑟−3/2

to predict 𝐴 does not appreciably alter the degree to which it matches the
simulation results in Fig. 9.
10 This is the mean overdensity within 𝑞; the mean overdensity at 𝑞 scales
as 1 − (𝑞/𝑅) 2/6.

MNRAS 000, 1–23 (2021)

out to the physical radius 𝑟0 that encloses 𝑀0, then

𝑟0 =

1
4

(cid:18) 3
𝜋

(cid:19)2/3 (cid:18) 𝑀0
𝐴

(cid:19)2/3

(cid:39) 0.92𝛼−2/3𝑎𝑐 𝑅.

(6)

If the 𝜌 ∝ 𝑟−3/2 cusp is established over roughly the ﬁrst dynamical
time interval after collapse, then 𝑟0 may be interpreted as an estimate
of the cusp’s initial radius.

Within each of our haloes, we identify all of the particles that lie
at a radius 𝑟 < 4.2 × 10−3 at some time shortly after halo formation
(the speciﬁc time makes no diﬀerence), and we locate the Lagrangian
centre of mass of these particles in the initial conditions. We then
follow the local density gradient to ﬁnd the nearest peak in the initial
density ﬁeld. We record the peak height 𝛿 and use Fourier methods
to evaluate 𝑅, 𝑒, and 𝑝. We use Eqs. (4), (5), and (6) to evaluate the
predicted values of 𝐴, 𝑀0, and 𝑟0, respectively, for the associated
halo. We assume the proportionality constant 𝛼 = 24.11 Table 3 lists
these data. In Fig. 9, we mark the predicted 𝐴 for each halo with

11 The value of 𝛼 that we assume is about 10 per cent smaller than the
value that Delos et al. (2019) obtained. It is likely that the proportionality

101102ρr3/20.510.61a=0.73H10.550.66a=0.78H20.390.47a=0.56H3101102ρr3/20.340.40a=0.48W10.340.41a=0.49W20.390.47a=0.56W3101102ρr3/20.340.40a=0.48W40.480.58a=0.69W50.400.48a=0.57C110−310−210−1r101102ρr3/20.390.46a=0.55C210−310−210−1r0.400.48a=0.57C310−310−210−1r0.530.63a=0.75C4Table 3. Properties of our haloes’ precursor peaks in the linear density ﬁeld
𝛿 (x). The “oﬀset” is the comoving distance between the central cusp’s mean
Lagrangian position and the density peak. 𝑅 ≡ | 𝛿/∇2 𝛿 | is the characteristic
size of the peak and 𝛿 (𝑎)/𝑎 is its height (scaled by 𝑎−1 since 𝛿 (𝑎) ∝ 𝑎).
𝑒 and 𝑝 are the “ellipticity” and “prolateness” of the tidal tensor 𝜕𝑖 𝜕𝑗 𝜙 at
the location of the peak (see footnote 8). Finally, 𝑎𝑐 is the peak’s predicted
collapse time (using the approximation in Sheth et al. 2001), 𝐴 is the resulting
halo’s predicted cusp amplitude (Eq. 4 with 𝛼 = 24), and 𝑀0 and 𝑟0 are the
predicted mass and radius of the cusp after one dynamical time interval,
respectively (Eqs. 5 and 6).

halo

oﬀset

𝑅

H1
H2
H3
W1
W2
W3
W4
W5
C1
C2
C3
C4

0.31
0.54
0.31
0.25
0.19
0.00
0.11
0.11
0.24
0.11
0.00
0.00

0.96
1.20
1.08
0.82
0.89
0.98
0.95
0.75
0.96
0.74
0.70
0.55

𝛿 (𝑎)
𝑎

3.40
3.32
4.09
4.86
5.00
4.20
4.77
3.48
4.30
4.22
4.11
3.66

𝑒

𝑝

𝑎𝑐

𝐴 𝑀0

𝑟0

0.09 −0.06
0.00
0.18
0.06
0.00
0.04 −0.02
0.10 −0.01
0.09
0.01
0.06 −0.01
0.12 −0.01
0.12 −0.00
0.07
0.01
0.10 −0.02
0.15 −0.07

0.54
0.60
0.43
0.36
0.37
0.43
0.37
0.53
0.43
0.42
0.44
0.54

57
68
96
84
91
83
99
40
79
57
47
25

6.6
13
9.3
4.1
5.2
6.8
6.3
3.1
6.5
3.0
2.5
1.2

0.058
0.079
0.051
0.032
0.036
0.046
0.039
0.044
0.046
0.034
0.034
0.032

a horizontal black line, and we terminate that line with a point at
the radius 𝑟0. We ﬁnd that with 𝛼 = 24, the predicted values of 𝐴
match the haloes’ density proﬁles mostly very well, albeit with minor
scatter. The radius 𝑟0 also reasonably estimates the initial size of the
𝜌 ∝ 𝑟−3/2 cusp, although this size cannot be precisely deﬁned.

We also list in Table 3 the oﬀset between the halo cusp’s La-
grangian centre and the density peak. In the ideal case where only 𝛿,
𝑅, 𝑒, and 𝑝 determine collapse, this oﬀset should be zero because the
halo should form precisely at the density peak. The presence of an
oﬀset thus implies that the broader density ﬁeld around the peak does
have a small inﬂuence on the collapse process (beyond determining
the tidal tensor). The inﬂuence of the broader density ﬁeld could also
explain some of the scatter in the cusp amplitudes 𝜌𝑟3/2 in Fig. 9
with respect to the predicted values 𝐴 from Eq. (4). However, we
note that since this oﬀset is always signiﬁcantly smaller than 𝑅, there
is no ambiguity as to whether a halo actually arose from the peak to
which we associate it. We also tried evaluating the predicted value
of 𝐴 using the values of 𝛿, 𝑅, 𝑒, and 𝑝 at the location of the La-
grangian centre instead of the peak, but the outcome did not change
signiﬁcantly.

4 PERSISTENCE OF THE INNER CUSP
We saw in Section 3 that a halo’s 𝜌 ∝ 𝑟−3/2 cusp forms immediately
after collapse. In this section, we explore the extent to which these
cusps persist over cosmic time. Figure 10 shows the density proﬁle
of every halo at the end of its simulation (see Fig. 3). Speciﬁcally, we
average the density proﬁle over the ﬁnal factor of 1.17 in the scale
factor (corresponding again to one dynamical time for something 200
times denser than the cosmological mean). Some of these haloes –
H1, H3, and W5 – evidently maintain their 𝜌 ∝ 𝑟−3/2 density cusps.
However, most of the late-time density proﬁles exhibit some degree

constant obtained in that work was biased upward by haloes’ later evolution
(see Section 4), but since our own halo sample is small and not necessarily
representative, the value that we use here might not be more accurate.

Inner cusps of the ﬁrst haloes

9

Figure 10. Density proﬁles of all twelve high-resolution haloes at the end
of their simulations (averaged over the ﬁnal factor of 1.17 in scale factor).
We plot these proﬁles out to the radius 𝑅200 enclosing an average density
200 times the cosmological mean. While haloes H1, H3, and W5 still retain
their 𝜌 ∝ 𝑟 −3/2 inner density proﬁles, most of the proﬁles have shallowed
by this late time. We include a reference 𝜌 ∝ 𝑟 −1 line, corresponding to
the innermost slope of the NFW proﬁle. Some of the density proﬁles are
beginning to approach this slope.

of shallowing, with some, like C2, even approaching the 𝜌 ∝ 𝑟−1
asymptote of the NFW form.

4.1 The impact of accretion rate

The shallowing of the inner proﬁle can largely be understood as
a consequence of high accretion rates. Due to its high energy and
(typically) high angular momentum, newly accreted material tends to
contribute signiﬁcant density to a halo only at large and intermediate
radii, close to the orbital apocentres of the newly accreted particles.12
Consequently, rapid accretion can shallow a halo’s proﬁle by boosting
the density at intermediate radii.

Figure 11 shows how this process plays out. We plot halo mass
(upper panel) and mass accretion rate Γ ≡ Δ log 𝑀200/Δ log 𝑎 (centre
panel; e.g. Diemer & Kravtsov 2014) for W1 as a function of scale
factor 𝑎, where both Δ log 𝑀200 and Δ log 𝑎 are evaluated over the
preceding factor of 1.17 in 𝑎. The same ﬁgure also shows (lower
panel) the evolution of the halo density proﬁle over the same period;
speciﬁcally we time average the proﬁle over successive factors of
1.17 in 𝑎. The colour of each density proﬁle in the lower panel
matches the time range of the same colour marked in the upper
panels. While the halo initially has 𝜌 ∝ 𝑟−3/2 in the inner regions, it
continues to accrete rapidly for some time after its formation (blue
and green), which causes the halo’s density to grow at radii 𝑟 (cid:38)
10−2. This density growth is suﬃcient to produce a shallow density
slope, d log 𝜌/d log 𝑟 > −3/2, in the inner regions. The accretion
rate later drops (yellow), leading to a period in which the density
proﬁle remains stable except near 𝑅200. Finally, near the end of the
simulation the accretion rate again rises, causing further deposition
of mass at intermediate radii.

12 New material tends to contribute almost uniform density at radii much
smaller than the apocentres of its particle orbits (e.g. Dalal et al. 2010).
However, this contribution is dwarfed by the much higher density already
present at those radii. Only close to the apocentres can the new material
signiﬁcantly boost the halo’s density.

MNRAS 000, 1–23 (2021)

10−310−210−1100r101102ρr3/2ρ∝r−1H1H2H3W1W2W3W4W5C1C2C3C410 M. S. Delos & S. D. M. White

Figure 11. Mass (top), accretion rate Γ evaluated at each time over the
preceding factor of 1.17 in 𝑎 (centre), and density proﬁle (bottom) for the
W1 halo. We plot the density proﬁle in physical coordinates at a range of
diﬀerent times, indicated by colours; each proﬁle is averaged over the time
interval in the upper panels that is marked with the same colour (we also
separate these intervals with vertical lines). The halo begins with a 𝜌 ∝ 𝑟 −3/2
inner density proﬁle (purple), but its consistently high accretion rate (blue
and green) causes the density proﬁle to trend shallower as the halo grows.
The accretion rate later drops below Γ ∼ 3 (yellow), and the density proﬁle
remains stable for a period. Finally, towards the end of the simulation the
accretion rate rises above Γ ∼ 3 again (red), inducing renewed shallowing. At
the ﬁnal time the density proﬁle is well ﬁt by an Einasto proﬁle with 𝛼 = 0.17
(Eq. 8; dotted curve) except at the smallest radii where the natal 𝜌 ∝ 𝑟 −3/2
cusp appears to persist. New accretion has mostly built on top of the cusp
rather than disrupting it (but see Section 4.2). A horizontal line marks Γ = 3;
the idea that Γ > 3 corresponds to newly accreted material forming a density
proﬁle shallower than 𝜌 ∝ 𝑟 −3/2 is approximately borne out. In the lower
panel we include a 𝜌 ∝ 𝑟 −1 line as reference (upper left); 𝜌 ∝ 𝑟 −3/2 would
correspond to a horizontal line.

The connection between the density proﬁle slope d log 𝜌/d log 𝑟
and the accretion rate Γ ≡ d log 𝑀/d log 𝑎 can be understood on
an approximate level by means of a simple model. Due to its mass
growth, the halo’s radius 𝑅 grows at the rate d log 𝑅/d log 𝑎 = 1+Γ/3
in physical coordinates. Now suppose that material accreted at the
scale factor 𝑎(cid:48) contributes signiﬁcant density within the halo only
near a particular radius 𝑟 = 𝑥𝑅(𝑎(cid:48)) that is proportional to the halo’s
radius 𝑅(𝑎(cid:48)) at the accretion time (so 𝑥 is some ﬁxed number). Then
the proﬁle 𝑀 (𝑟) of the halo’s enclosed mass obeys

(cid:19)−1

=

d log 𝑀 (𝑟)
d log 𝑟

d log 𝑀 (𝑎)
d log 𝑎

(cid:18) d log 𝑅(𝑎)
d log 𝑎
at 𝑟 = 𝑥𝑅(𝑎) if Γ is evaluated at 𝑎. Despite this model’s simplicity,
close variants thereof have been shown to successfully predict trends
in the density proﬁles within halo populations (Dalal et al. 2010;

3Γ
3 + Γ

(7)

=

MNRAS 000, 1–23 (2021)

Ludlow et al. 2013; Delos et al. 2019).13 Equation (7) suggests that
if a halo accretes material at a rate Γ > 3, then the mass proﬁle
resulting from this accretion should obey d log 𝑀/d log 𝑟 > 3/2 at
the corresponding radius, which requires a density proﬁle shallower
than 𝜌 ∝ 𝑟−3/2. Thus, we expect that accretion at a rate Γ (cid:38) 3 should
build up a density proﬁle with a logarithmic slope shallower than
−3/2. This expectation is approximately borne out in Fig. 11, where
in the centre panel we mark Γ = 3 with a grey line. When 𝑎 (cid:46) 0.9 and
when 𝑎 (cid:38) 1.2, Γ > 3, which causes the density proﬁle to gradually
grow at intermediate radii 10−2 (cid:46) 𝑟 (cid:46) 10−1 into a form with a
slope shallower than 𝜌 ∝ 𝑟−3/2. In contrast, when 0.9 (cid:46) 𝑎 (cid:46) 1.2,
Γ < 3, and during this interval the inner and intermediate parts of
the density proﬁle remain stable.

Since the primary impact of rapid accretion is to boost the halo’s
density, the shallowing of the density proﬁle predominantly occurs
at intermediate radii 10−2 (cid:46) 𝑟 (cid:46) 10−1. The central 𝜌 ∝ 𝑟−3/2 cusp
largely survives the process, albeit with some mass loss that we will
discuss further in Section 4.2 (where we attribute it to a major merger
event). In fact, W1’s density proﬁle in the ﬁnal snapshot is well ﬁt at
almost all radii by the Einasto density proﬁle (dotted curve)

𝜌(𝑟) = 𝜌−2 exp

(cid:26)

−

2
𝛼

(cid:20)(cid:18) 𝑟
𝑟−2

(cid:19) 𝛼

(cid:21) (cid:27)

− 1

(8)

(Einasto 1965), where 𝜌−2 and 𝑟−2 are scale parameters deﬁned
here as the density and radius at which the proﬁle’s logarithmic
slope crosses d log 𝜌/d log 𝑟 = −2. Here we ﬁx 𝛼 = 0.17 and ﬁnd
𝑟−2 = 0.55 and 𝜌−2 = 380. Equation (8) is the same density proﬁle
seen in cold dark matter simulations at much larger scales where the
free-streaming cutoﬀ is not resolved (e.g. Navarro et al. 2004, 2010),
and such simulations also ﬁnd that 𝛼 (cid:39) 0.17 supplies a good ﬁt. Only
at the smallest resolved scales, 𝑟 (cid:46) 5 × 10−3, does the density proﬁle
here break away from the Einasto form due to the persistence of the
initial 𝜌 ∝ 𝑟−3/2 central cusp.

Figure 12 shows three more examples of how the accretion rate Γ

relates to the shallowing of the halo’s density proﬁle.

(i) Halo C2 (left) forms with a density proﬁle that is initially close
to 𝜌 ∝ 𝑟−3/2, but its accretion rate Γ remains high, so this proﬁle
rapidly shallows. By the end of the simulation the inner density
proﬁle is close to 𝜌 ∝ 𝑟−1.

(ii) In contrast, the accretion rate of halo H3 (centre) quickly drops
after its formation, allowing its inner 𝜌 ∝ 𝑟−3/2 density proﬁle to
remain stable over nearly an order of magnitude in scale factor. The
accretion rate in this case becomes so low that even the outer, steeper
part of the density proﬁle stabilizes after 𝑎 (cid:39) 2.

(iii) Halo H2’s accretion rate (right) also slows quickly early on,
leading to an initially static inner density proﬁle. However, around
𝑎 (cid:39) 1.6 a brief period of rapid accretion builds up the density proﬁle
to a shallower slope. Subsequently the halo’s accretion rate remains
low, and its density proﬁle correspondingly remains static again.

13 Dalal et al. (2010) and Delos et al. (2019) considered models framed in
terms of a halo’s initial density peak instead of its accretion rate, but the
idea is otherwise almost identical. These works also considered variants in
which the radius at which accreted material settles is allowed to change in
response to later accretion. The model in Ludlow et al. (2013) is equivalent
to the claim that Eq. (7) holds if Γ is evaluated at the scale factor 𝑎 such
that 𝑀 (𝑎) = 𝑀 (𝑟 ), where 𝑀 (𝑎) is the halo’s mass at 𝑎 while 𝑀 (𝑟 ) is the
enclosed mass proﬁle at the ﬁnal time. Note that since these models cannot
explain the 𝜌 ∝ 𝑟 −3/2 cusp, we ﬁnd that they cannot explain the inner proﬁles
of many of our simulated haloes.

100101102103M20010.32a100101Γ≡∆logM200∆loga10−310−210−1100r102ρr3/2ρ∝r−1a=0.41a=0.76a=1.43HaloW1EinastoInner cusps of the ﬁrst haloes

11

Figure 12. Masses (top), accretion rates Γ (centre) and density proﬁles (bottom) of the haloes C2 (left), H3 (centre), and H2 (right). As in Fig. 11 we use colours
to match the density proﬁles in each lower panel to the corresponding scale factor band in the accretion-rate plot above it. (See that ﬁgure’s caption for further
explanations.) Left-hand panels: Halo C2 maintains a high accretion rate Γ for some time after formation (like W1 in Fig. 11) and its density proﬁle shallows
signiﬁcantly over time, almost reaching 𝜌 ∝ 𝑟 −1 by the end of the simulation. Centre panels: In contrast, halo H3’s accretion quickly slows below Γ ∼ 3 and
remains low. Its inner 𝜌 ∝ 𝑟 −3/2 density proﬁle consequently remains stable over nearly an order of magnitude in scale factor. The accretion rate is so low at
late times that even the outer, steeper part of the density proﬁle remains stable from 𝑎 (cid:39) 2 to 𝑎 (cid:39) 5. Right-hand panels: Halo H2’s accretion rate initially drops
below Γ ∼ 3, causing the inner 𝜌 ∝ 𝑟 −3/2 proﬁle to persist intact until 𝑎 (cid:39) 1.6 (green), at which point a short burst of accretion builds up the inner density
proﬁle to a somewhat shallower slope. In fact this accretion episode was associated with a triple merger, which also marginally disrupted the central cusp (see
Section 4.2). The accretion rate remains low thereafter, and the density proﬁle correspondingly remains almost static.

4.2 Impact of halo mergers

Ogiya et al. (2016) and Angulo et al. (2017) showed through con-
trolled merger simulations that major mergers (between haloes of
comparable masses) can disrupt 𝜌 ∝ 𝑟−3/2 central cusps. We now
present a couple of examples that conﬁrm this eﬀect in a cosmolog-
ical setting.

• Halo H2 merged at 𝑎 (cid:39) 1.6 with two other haloes of roughly
1/3 and 1/4 the main progenitor’s mass. This event is pictured in
the upper row of panels in Fig. 13. The right-hand panels of Fig. 12
show that the amplitude of the central 𝜌 ∝ 𝑟−3/2 cusp decreased by
about 10 per cent at this time (and its slope may have also changed).
The large inﬂux of mass mostly settled at larger radii, boosting the
density proﬁle around 𝑟 ∼ 10−1.

• Halo W1 merged at 𝑎 (cid:39) 0.6 with two other haloes of masses
roughly 1/4 and 1/5 the main progenitor’s mass; this event is pictured
in the central row of panels in Fig. 13. Figure 11 shows that like
H2’s merger, this event reduced the amplitude of the central density
cusp around 𝑟 ∼ 10−2 by about 10 per cent (although we do not have
the resolution to determine whether the slope also changed). Here,
too, the mass primarily settled at larger radii, building up the density
proﬁle around 𝑟 ∼ 10−1.

Major mergers have the capacity to alter a halo’s structure at small
radii because dynamical friction causes the core of a large subhalo to
sink rapidly to the centre of a host, shedding most of its mass along
the way (e.g. Mo et al. 2010). The subhalo heats the host’s material in
the process. This behaviour contrasts with that of smoothly accreted
material and minor mergers, which do not sink in this way and
therefore impact the growing halo’s structure only at intermediate to
large radii (see Section 4.1). We illustrate this eﬀect in Fig. 14. This
ﬁgure shows a halo’s density proﬁle at a particular time in the left-
hand panels, and we mark radial bins within the density proﬁle with
diﬀerent colours. The panels to the right of each density proﬁle show
the distribution of Lagrangian positions (within the initial conditions)
of material residing within each coloured radial bin. The uppermost
row of panels shows halo W1 at an early time, before any signiﬁcant
mergers have taken place. The Lagrangian regions associated with
each radial bin of the density proﬁle are simply connected and nested
at this time, with shells of larger (ﬁnal) radius associated with larger
Lagrangian regions. This behaviour indicates that material that was
initially at a larger radius within the halo’s precursor density peak
– and therefore accreted later – contributes primarily at larger radii
within the nonlinear halo cusp. In contrast, the second row of panels
shows halo W1 after the set of major mergers discussed above has
taken place. Disconnected Lagrangian regions, which we label ‘A’

MNRAS 000, 1–23 (2021)

100101102103M2000.40.61a10−1100101Γ≡∆logM200∆loga0.5124a0.5124a10−310−210−1100r101102ρr3/2a=0.47a=0.75a=1.02ρ∝r−1HaloC210−310−210−1100ra=0.47a=0.89a=1.66a=3.11a=5.84HaloH310−310−210−1100ra=0.66a=1.24a=2.32a=4.35HaloH212 M. S. Delos & S. D. M. White

Figure 13. The signiﬁcant merger events (each a diﬀerent row) that we con-
sider in Section 4.2. From left to right we advance in time. Top row: H2’s
merger event at 𝑎 ∼ 1.6 is a three-body event where the two smaller haloes
have masses of about 1/3 and 1/4 the main progenitor’s mass. This event
disturbs the halo’s established 𝜌 ∝ 𝑟 −3/2 density proﬁle by about 10 per cent
(see Fig. 12). Centre row: W1’s merger event at 𝑎 ∼ 0.6 is also a three-body
event; in this case the two smaller haloes have somewhat smaller masses of
about 1/4 and 1/5 the main progenitor’s mass. This event disturbs the halo’s
established 𝜌 ∝ 𝑟 −3/2 density proﬁle to a similar degree (see Fig. 11). Bottom
row: W1’s second major merger event at 𝑎 ∼ 1.3 has a mass ratio of about 1/3
but does not appreciably disturb the central 𝜌 ∝ 𝑟 −3/2 cusp, at least within
our resolution limits.

and ‘B’, now contribute even within the smallest radial bins (blue
and red). The inner regions of W1 thus contain material from both
merging haloes; both contribute to the ﬁnal proﬁle at all radii, even
to the inner cusp. The amplitude of the density proﬁle of W1 is
decreased at small radii as a result of this merging (the density
proﬁle from the uppermost row is overplotted here as a dotted curve
for comparison).

However, disruption of the central cusp is not a guaranteed out-
come of a major merger. In fact, W1 underwent another merger event
at 𝑎 (cid:39) 1.3 with a mass ratio of about 1/3, an event that is pictured
in the lower panels of Fig. 13. The disconnected Lagrangian region
associated with this merging halo is labeled ‘C’ in the third row of
panels in Fig. 14. This halo’s material was able to contribute density
as deep as the red radial bin within W1. However, this event did
not appreciably disturb the innermost part of the density proﬁle, at
least within our resolution limits. As before, we overplot the previous
row’s density proﬁle as a dotted curve.

We can also use plots of this kind to show explicitly that major
mergers are not necessary to produce a shallow density proﬁle. In
the lower two rows of Fig. 14, we show the density proﬁle of halo
C3 at two diﬀerent times. As before, the right-hand panels plot the
Lagrangian positions of the material that resides within each coloured
radial bin at each time. This halo evidently develops a density proﬁle
at intermediate radii that is signiﬁcantly shallower than 𝜌 ∝ 𝑟−3/2.
However, there is no signiﬁcant disconnected Lagrangian region that
would mark the impact of a major merger event.14 Instead, material

14 The ring-like structure visible in the bottom-right panel is associated with
coherence of the orbital phases of freshly accreted material. Material initially
within the ring is close to the ﬁrst pericentre of its orbit through the halo,
while material initially in the white region just inside the ring is close to its

MNRAS 000, 1–23 (2021)

at large Lagrangian distances (which was accreted later) remains at
large radii within the halo. Accordingly, the central 𝜌 ∝ 𝑟−3/2 cusp
remains undisturbed. Indeed, halo C3’s most major merger event was
associated with a mass ratio of about 1/20.

The degree to which mergers disrupt the natal cusps of our haloes
appears at most moderate. Figure 15 shows the density proﬁle evolu-
tion for all twelve of our haloes. Despite the signiﬁcant shallowing of
many density proﬁles at intermediate radii – and sometimes even at
the smallest resolved radii – due to deposition of accreted material,
we ﬁnd no case where the initial cusp suﬀered more than 10 to 20 per
cent suppression. Resolution limitations mean that there are cases –
particularly H2, W3, C1, C2, and C4 – where we cannot exclude that
more major disruption occurred at the smallest radii. Nevertheless,
in no case do we ﬁnd positive evidence for substantial disruption of
the central cusp. In cases where the central 𝜌 = 𝐴𝑟−3/2 cusp persists
within our resolution limits, the properties of the halo’s precursor
peak continue to predict its coeﬃcient 𝐴 with reasonable accuracy
(horizontal black lines; see Section 3.2).

4.3 Mass and size of the inner cusp

We have now seen many examples of how a halo’s density proﬁle
evolves after formation of its initial 𝜌 ∝ 𝑟−3/2 cusp. For instance, halo
W1 (Fig. 11) rapidly built a shallow Einasto density proﬁle on top of
its initial cusp, so that the latter only persists at radii 𝑟 (cid:46) 𝑅200/400.
Halo C2 (Fig. 12) underwent similar evolution to the extent that its
central cusp (if it persists) is not even resolved at the ﬁnal snapshot.
In contrast, halo H3’s 𝜌 ∝ 𝑟−3/2 cusp remains a signiﬁcant portion
of the halo even at the end of the simulation. We now quantify more
precisely how the sizes of our haloes’ natal cusps evolve over time.
We deﬁne the size and mass of the 𝜌 ∝ 𝑟−3/2 cusp in the following
manner. First, we evaluate d log 𝜌/d log 𝑟 at each radius 𝑟 by carrying
out a linear regression in log space over the surrounding factor of
1.5 in 𝑟 (that is, radii 𝑟 (cid:48) satisfying 𝑟/
1.5𝑟). Next,
we search for the smallest radius at which d log 𝜌/d log 𝑟 deviates
from −1.5 by more than 0.2, but since d log 𝜌/d log 𝑟 is noisy, we
ignore deviations that are conﬁned to less than a factor of 2 in radius.
We deﬁne the deviation radius obtained in this way to be 𝑅cusp, the
radius of the natal cusp. We demonstrate the outcome of this process
in Fig. 16 for the C3 halo. It does indeed place 𝑅cusp where one might
reasonably decide that the central cusp ends.

1.5 < 𝑟 (cid:48) <

√

√

√

√

1.17 < 𝑎(cid:48) <

For each halo and each scale factor 𝑎, we average the density proﬁle
over the surrounding factor of 1.17 in 𝑎 (that is, scale factors 𝑎(cid:48) satis-
fying 𝑎/
1.17𝑎) and then evaluate 𝑅cusp by the above
procedure.15 The resulting evolution of 𝑅cusp is plotted in Fig. 17.
Note that 𝑅cusp is not always resolved if the slope d log 𝜌/d log 𝑟 is
already much shallower than -1.5 at the minimum resolved radius. If
𝑅cusp is not resolved at some time, we do not attempt to resolve it

ﬁrst apocentre subsequent to infall and currently lies outside the orange radial
range in the proﬁle panel. Note that halo C3 formed from a ﬁlament, and the
Lagrangian ring is aligned along that ﬁlament’s axis.
15 We also make a further adjustment to clean up the evolution plots. Namely,
we iteratively remove the data at a scale factor 𝑎 if the enclosed mass 𝑀cusp at
that scale factor is larger by at least a factor of 3 than at both of its neighboring
scale factors. We do the same for scale factors at which 𝑀cusp is smaller by
the same factor than both of its neighbors. Any data points removed in this
way are instead interpolated between the neighboring points. This process
suppresses a few instances in which 𝑅cusp and 𝑀cusp jump wildly. Note that
we use all snapshot scale factors, which are separated by roughly a factor of
1.035 in 𝑎, and not only the scale factors shown in Fig. 16, so we do not
remove a signiﬁcant fraction of the data points.

a=1.56H2a=1.67a=1.79a=1.92a=0.55W1a=0.57a=0.59a=0.61a=0.96W1a=1.06a=1.18a=1.31Inner cusps of the ﬁrst haloes

13

Figure 14. Lagrangian regions associated with halo material at set radii. Within each row, the left-hand panel shows a halo’s density proﬁle at a particular time
(averaged over a factor of 1.17 in 𝑎), and in some rows we also overplot the previous row’s density proﬁle as a dotted curve for comparison. We mark four
coloured radial bins (also separated by vertical lines). The panels to the right of each density proﬁle show the projected distribution of Lagrangian positions
(i.e. positions within the initial conditions) associated with the material that resides in the radial bin of the same colour (and we consider the same time interval,
distributing each particle across multiple bins if necessary). The colour intensity scale is logarithmic between 10−3 and 1/4 the total projected density (over a
cubic region). The upper three panels show the W1 halo at diﬀerent times. At ﬁrst, the Lagrangian region associated with each radial bin is simply connected,
and bins at larger radii are associated with larger Lagrangian regions. This behaviour indicates that material that accreted later (because it was initially farther
from the peak) contributes at larger radii within the halo (note that the red, green and yellow regions in all panels are hollow, although this is diﬃcult to see
in projection). The second and third rows of panels for W1 show disconnected Lagrangian regions ‘A’, ‘B’, and ‘C’ contributing to the inner radial bins. Each
additional region is associated with a separate halo that merged onto the main system; dynamical friction allowed this these haloes to deposit material close to
the centre of W1. The merger events associated with the ‘A’ and ‘B’ regions partially disrupted the halo’s central density proﬁle, but the merger associated with
the ‘C’ region had no such eﬀect, depositing all its material at intermediate radii. In contrast, the lower two panels show the C3 halo. This halo did not undergo
any major mergers, and the Lagrangian distribution of the material in its inner radial bins is simply connected and nearly spherically symmetric at both times.
Nevertheless, rapid accretion of diﬀuse material caused this halo to develop a shallow density proﬁle at all but the innermost radii, where the initial 𝜌 ∝ 𝑟 −3/2
cusp is preserved.

MNRAS 000, 1–23 (2021)

10040200ρr3/2densityproﬁleatahaloW1a=0.57Lagrangiandistributionofmaterialineachcolouredradialbin10040200ρr3/2haloW1a=0.96AAB10040200ρr3/2haloW1a=1.41CC10040200ρr3/2haloC3a=0.5710−310−210−1100r10040200ρr3/2-505haloC3a=0.96-505comovingposition-505-50514 M. S. Delos & S. D. M. White

Figure 15. Density proﬁle evolution for all twelve haloes. As in earlier ﬁgures, the density proﬁles are time averaged over successive factors of 1.17 in 𝑎
(diﬀerent colours). We ﬁnd no evidence, within our resolution limits, for signiﬁcant disruption of the natal cusps due to merger events. The eﬀects are limited to
a 10 to 20 per cent reduction in amplitude. We also repeat the cusp predictions (black lines) from Fig. 9, which are based on each halo’s precursor density peak.
Even after halo growth, the initial peak continues to predict the inner cusp reasonably well in cases where the cusp persists within our resolution limits.

.

at any future time; attempting to do so may inappropriately identify
the central cusp with, e.g., the portion of the Einasto density proﬁle
for which the density slope is close to −1.5. When 𝑅cusp ceases to be
resolved, we instead simply cut oﬀ its time evolution curve in Fig. 17.

In the upper panel of Fig. 17, we see that the physical cusp radius
𝑅cusp often remains close to constant in time. This behaviour holds
during periods of slow accretion but also during rapid accretion as
long as accretion builds up the density proﬁle primarily at radii out-
side of the central cusp. For instance, halo W1’s cusp radius remains
essentially constant over the time interval 0.6 (cid:46) 𝑎 (cid:46) 1.4 even though
accretion during that interval is sometimes rapid enough to build
up a shallow density proﬁle and sometimes not; compare Fig. 11.
However, 𝑅cusp also typically undergoes one (and only one) sudden
drop when rapid accretion begins to build on top of an established
𝜌 ∝ 𝑟−3/2 cusp. A prime example of this behaviour occurs for halo
H2 at 𝑎 (cid:39) 1.8; compare the right-hand panels of Fig. 12. Finally, at
early times there can be growth in 𝑅cusp as the initial collapse builds
the density proﬁle outward; compare for instance halo W1’s cusp
growth during 0.4 (cid:46) 𝑎 (cid:46) 0.55 to the plot of its density in Fig. 9 over
the same time period. In some cases, growth of 𝑅cusp can proceed
for some time. This outcome is likely attributable to an accretion rate

MNRAS 000, 1–23 (2021)

that remains close to Γ = 3 for a while; for example, compare H3’s
cusp growth during 0.7 (cid:46) 𝑎 (cid:46) 1.2 to the contemporaneous accretion
rate and density proﬁle in the centre panels of Fig. 12. In this case,
the 𝜌 ∝ 𝑟−3/2 cusp is not entirely set by the initial collapse but is
further built outward by later accretion.

The lower panel of Fig. 17 plots the evolution of 𝑅cusp/𝑅200 for
each halo. For the haloes arising from the 𝑛 = −2.67 power spectrum,
accretion is so rapid that the halo’s 𝑅200 radius quickly grows to more
than 100 times the cusp radius. This picture demonstrates further why
other studies did not ﬁnd the natal 𝜌 ∝ 𝑟−3/2 cusp inside haloes for
which rapid accretion built up a shallower intermediate proﬁle. For
instance, Ishiyama (2014) and Angulo et al. (2017) concluded simply
that larger haloes have shallower density proﬁle slopes,16 while Wang
et al. (2020) found that all haloes are well described by the Einasto

16 Angulo et al. (2017) resolved radii below 10−2 𝑅178 for some of their halo
mass bins, and their plot of d log 𝜌/d log 𝑟 (Fig. 6 of Angulo et al. 2017)
does show signs of steepening at the smallest radii that they plot. Although
this eﬀect lies below the radii at which they expect the simulation to be
numerically converged, numerical artifacts normally push the density proﬁle
towards a shallower rather than a steeper slope (see Appendix B).

101102ρr3/2a=0.62a=4.06H1a=0.66a=4.35H2a=0.47a=5.84H3101102ρr3/2a=0.41a=1.43W1a=0.41a=1.23W2a=0.47a=1.66W3101102ρr3/2a=0.41a=1.67W4a=0.58a=1.50W5a=0.48a=0.91C110−310−210−1100r101102ρr3/2a=0.47a=1.02C210−310−210−1100ra=0.48a=0.91C310−310−210−1100ra=0.64a=1.41C4Inner cusps of the ﬁrst haloes

15

Figure 16. Demonstration of the procedure through which we identify the
radius 𝑅cusp of the central cusp. We plot the density proﬁle (top) and log-
arithmic density slope d log 𝜌/d log 𝑟 (bottom) of the C3 halo at a number
of diﬀerent times (colours). At each time, we identify the cusp radius 𝑅cusp
(vertical line) as the largest radius at which d log 𝜌/d log 𝑟 remains within the
range (-1.7,-1.3) (grey band), but we ignore small excursions; see the text.
The resulting radius values appear to reasonably mark the outer edge of the
𝜌 ∝ 𝑟 −3/2 cusp.

Figure 18. Evolution of the masses 𝑀cusp enclosed within our haloes’ cusp
radii 𝑅cusp. The upper panel shows 𝑀cusp in absolute units; behaviours similar
to those in Fig. 17 are evident. The lower panel shows 𝑀cusp/𝑀200, i.e. the
cusp mass in units of the halo’s mass 𝑀200 (enclosed within 𝑅200). We ﬁnd
that the rapidly accreting haloes C1–C4 and W1–W3 quickly grow to such
extent that 𝑀cusp/𝑀200 (cid:46) 10−3. On the other hand, slowly accreting haloes
like H1, H3, W4, and W5 are able to maintain 𝑀cusp/𝑀200 ∼ 10−1.

Figure 17. Evolution of the cusp radii 𝑅cusp of our haloes as a function
of the expansion factor 𝑎. The upper panel shows 𝑅cusp in absolute units;
generally we ﬁnd that 𝑅cusp grows initially, drops suddenly at one time as
rapid accretion begins to build up a shallower density proﬁle, and otherwise
remains stable. The lower panel shows instead 𝑅cusp/𝑅200, i.e. the cusp radius
in units of the halo’s radius 𝑅200 (enclosing 200 times the cosmological mean
density). Rapidly accreting haloes arising from the 𝑛 = −2.67 and 𝑛 = −2
power spectra quickly grow to the extent that 𝑅cusp/𝑅200 < 10−2, but haloes
W4, W5, H1, and H3 maintain slower accretion rates such that 𝑅cusp remains
close to 10−1 𝑅200.

Figure 19. Accretion rates Γ ≡ Δ log 𝑀200/Δ log 𝑎 for our haloes, evaluated
as in Section 4.1. The horizontal reference line marks Γ = 3.

ﬁtting form. These studies did not resolve small enough radii to ﬁnd
the natal cusps inside their rapidly accreting haloes.

In Fig. 18 we similarly plot the mass 𝑀cusp enclosed inside 𝑅cusp.
For rapidly accreting haloes arising from the 𝑛 = −2 and 𝑛 = −2.67
power spectra, the natal cusp’s contribution quickly drops below 10−3
of the total halo mass. However, haloes W4 and W5 (arising from the
𝑛 = −2 power spectrum) do not accrete rapidly enough to overwhelm
the cusp in this way, so they maintain 𝑀cusp/𝑀200 ∼ 10−1 for the
full duration of their respective simulations. The naturally slower
accretion rates expected for the 𝑛 = 1 power spectrum also cause
haloes H1 and H3 to maintain 𝑀cusp/𝑀200 around 10−1 to 10−2
during an order-of-magnitude increase in the scale factor 𝑎. For
reference, we show in Fig. 19 the accretion rates of our haloes; there

MNRAS 000, 1–23 (2021)

r101102ρr3/2a=0.48a=0.57a=0.66a=0.77a=0.91HaloC310−310−210−1100r−2−1dlogρ/dlogr10−310−210−1Rcusp100a10−210−1100Rcusp/R200H1H2H3W1W2W3W4W5C1C2C3C410−210−1100101102Mcusp100a10−410−310−210−1100Mcusp/M200H1H2H3W1W2W3W4W5C1C2C3C4100a100101ΓH1H2H3W1W2W3W4W5C1C2C3C416 M. S. Delos & S. D. M. White

Figure 20. Velocity anisotropy parameter (centre panels) and ellipsoidal axis ratios (lower panels) for the haloes H3, W5, C3, and W1 (from left to right). We
also show the density proﬁle at the top, for reference, and all quantities are averaged over successive factors of 1.17 in 𝑎. The 𝜌 ∝ 𝑟 −3/2 central cusps of these
haloes have nearly radial velocity distributions (𝛽 close to 0). However, there is far less uniformity in the three-dimensional shapes. H3 and W1 have triaxial
cusps that evolve signiﬁcantly toward a more spherical shape, with H1’s cusp becoming nearly spherical at late times. In contrast, W5 and C3 have very prolate
central cusps that remain so throughout their evolution, at least at the smallest radii; W5’s cusp becomes more oblate at intermediate radii.

is a clear correspondence between low accretion rates at late times
and large fractional masses in the central cusps.

4.4 Three-dimensional structure

We brieﬂy discuss the three-dimensional structures of our haloes and
their evolution over time. We ﬁrst explore anisotropy in the velocity
structure. The centre panels of Fig. 20 show the velocity anisotropy
parameter

𝛽 ≡ 1 − 𝜎2

𝑡 /(2𝜎2
𝑟 )

(9)

as a function of radius within each of haloes H3, W5, C3, and W1,
where 𝜎𝑟 and 𝜎𝑡 are the radial and tangential velocity dispersions,
respectively.17 𝛽 = 0 represents an isotropic velocity dispersion,
while 𝛽 = 1 implies that all motion is radial. Generally, 𝛽 grows with
radius at small and intermediate radii but drops again as we approach
the halo’s outer edge. This pattern has been seen in cold dark matter
haloes as well (e.g. Navarro et al. 2010). In the context of the ﬁrst
haloes, the interesting feature is that the velocity structure is nearly
isotropic (𝛽 (cid:39) 0) inside the central 𝜌 ∝ 𝑟−3/2 cusps.

We also explore the three-dimensional shapes of our haloes. We
use the algorithm of Allgood et al. (2006) (see also Vera-Ciro et al.
2011), which involves regarding a halo (or concentric subset thereof)
as an ellipsoid and evaluating the associated axis lengths 𝑙1 ≥ 𝑙2 ≥ 𝑙3
via the halo’s inertia tensor. An ellipsoid’s axis lengths are propor-
tional to the square roots of the eigenvalues of its inertia tensor.

𝑟 = (cid:104)𝑣2

𝑟 (cid:105) − (cid:104)𝑣𝑟 (cid:105)2 and 𝜎2

17 We evaluate 𝜎2
𝑟 (cid:105), where 𝑣𝑟 is a
particle’s radial velocity, 𝑣 is its total velocity, and the angle brackets denote
the average over particles in a narrow radial bin centred at radius 𝑟 . That
is, we consider the velocity dispersion at each radius with respect to the net
radial motion at that radius.

𝑡 = (cid:104)𝑣2 (cid:105) − (cid:104)𝑣2

MNRAS 000, 1–23 (2021)

Speciﬁcally, this procedure employs the “reduced” inertia tensor

𝐼𝑖 𝑗 =

∑︁

𝑚𝑛

𝑛

𝑛 𝑥 ( 𝑗)
𝑥 (𝑖)
𝑛
˜𝑟2
𝑛

,

(10)

summed over particles 𝑛 at “ellipsoidal” radii ˜𝑟𝑛, which avoids
weighting more distant particles more highly. If 𝑥𝑛, 𝑦𝑛, and 𝑧𝑛
are coordinates in the ellipsoid’s principal-axes frame, then ˜𝑟2
𝑛 ≡
(𝑥𝑛/𝑙1)2 + (𝑦𝑛/𝑙2)2 + (𝑧𝑛/𝑙3)2. Beginning with a spherical ellipsoid
with axes 𝑙1 = 𝑙2 = 𝑙3, we evaluate 𝐼𝑖 𝑗 for particles inside the el-
lipsoid, evaluate the resulting new axis lengths (keeping the longest
axis length 𝑙1 ﬁxed), and rotate the system into the frame of these
new axes. This procedure is iterated until the axis ratios 𝑙2/𝑙1 and
𝑙3/𝑙1 are converged to better than 10−3.

The lower panels of Fig. 20 show the axis ratios 𝑙3/𝑙1 and 𝑙2/𝑙1
as a function of the radius 𝑟 = (𝑙1𝑙2𝑙3)1/3, which is the radius of the
sphere that encloses the same volume as the ellipsoid. Generally these
haloes are highly aspherical, although there is a weak tendency for
them to become more spherical over time, as measured by the 𝑙3/𝑙1
axis ratio. At late times, these haloes tend to be less spherical at large
radii and more spherical at small radii, a trend that is interestingly
the opposite of what Vera-Ciro et al. (2011) found for cold dark
matter haloes. Also, our haloes tend to be comparatively prolate at
large radii, as evidenced by the ratios 𝑙3/𝑙1 and 𝑙2/𝑙1 both lying well
below unity. With respect to the 𝜌 ∝ 𝑟−3/2 central cusps, however,
there is little uniformity. H3’s cusp is initially triaxial but becomes
nearly spherical at late times. W5 and C3 have highly prolate cusps
that remain so through their evolution, although the portion of W5’s
cusp at intermediate radii 𝑟 (cid:38) 10−2 becomes more oblate. W1’s cusp
is triaxial, although it appears to be evolving rapidly toward a more
spherical shape.

Despite the variety of three-dimensional shapes of haloes’ central
cusps, we ﬁnd one general feature: the cusp tends to align with the
halo at larger radii. Figure 21 shows slices of the equidensity surfaces
of the same four haloes at radii 𝑟 ∼ 0.01 and 𝑟 ∼ 0.2. While some

101102ρr3/2H3W5C3W10.00.5β=1−σ2t2σ2ra=0.47a=1.66a=5.84H3a=0.58a=0.94a=1.50W5a=0.48a=0.66a=0.91C3a=0.41a=0.76a=1.43W110−310−210−1100r0.51.0axisratiosH3l2/l1l3/l110−310−210−1100rW510−310−210−1100rC310−310−210−1100rW1Inner cusps of the ﬁrst haloes

17

Figure 21. Slices of the equidensity surfaces of haloes H3, W5, C3, and W1 (from left to right) at 𝑎 = 0.96. Speciﬁcally, we use the density ﬁeld averaged over
the surrounding factor of 1.17 in 𝑎. The upper, centre, and lower panels show diﬀerent perpendicular slices, while for each halo, the left-hand and right-hand
panels show two diﬀerent length scales. The equidensity surfaces inside the central cusps (dark curves in each halo’s left-hand panels) tend to be aligned with
those at larger radii (each halo’s right-hand panels).

of the ellipsoidal axis ratios are clearly more extreme at larger radii,
the axes themselves are closely aligned between the inner cusp at
𝑟 (cid:46) 0.01 and the broader halo at 𝑟 ∼ 0.1.

5 MINIMUM RADIUS OF THE INNER CUSP
We have found that the 𝜌 ∝ 𝑟−3/2 density cusps of our haloes extend
down to the resolution limits of our simulations, but it is unclear
how much farther this power law could extend. If the dark matter
were inﬁnitely cold, but the initial power spectrum nevertheless had
a small scale cutoﬀ, then it is possible that the cusp could extend to
arbitrarily small radii. However, any thermal motions of dark matter
particles in the initial conditions would impose a minimum radius
below which the 𝜌 ∝ 𝑟−3/2 structure must give way to a core. We
now explore what the radius of this core should be.

5.1 Maximum phase-space density

The thermal core can be understood as a consequence of Liouville’s
theorem, which implies that the maximum coarse-grained phase-
space density cannot increase with time (Tremaine & Gunn 1979).
As a result, the (time-independent) maximum phase-space density
𝑓max of the dark matter at times prior to formation of any nonlinear
structure sets an upper limit on the value of the distribution function
𝑓 (x, v) anywhere inside a halo at all later times (e.g. Dalcanton
& Hogan 2001; Strigari et al. 2006; Villaescusa-Navarro & Dalal
2011; Macciò et al. 2012). Simulations suggest that halo centres
approximately saturate this limit (Macciò et al. 2012).

We ﬁrst estimate 𝑓max. In general, dark matter that was once cou-
pled to the radiation bath is left with some momentum distribution
𝑓 𝑝 (p, 𝑎) that peaks at p = 0 and has width proportional to some

scale momentum 𝑝0 = 𝑝0d (𝑎d/𝑎) that declines as 𝑎−1 from its ini-
tial value 𝑝0d, which was deﬁned at the scale factor 𝑎d when the dark
matter kinetically decoupled. The maximum value of this distribu-
tion is given by 𝑓 𝑝 (0) = 𝐶 𝑝−3
, where 𝐶 is a normalization factor
0
independent of 𝑎. Two speciﬁc examples are cold dark matter (CDM)
and warm dark matter (WDM):

(i) In the CDM scenario, dark matter decouples while it is nonrela-
tivistic. In this case it has a Maxwell-Boltzmann momentum distribu-
tion, 𝑓 𝑝 (p) = (2𝜋)−3/2 𝑝−3
0)], so that 𝐶 = (2𝜋)−3/2
exp[−p2/(2𝑝2
0
and 𝑝0d = (𝑇d𝑚)1/2, where 𝑇d is the temperature at decoupling and
𝑚 is the particle mass.

(ii) In the WDM scenario, dark matter

is a fermion that
is ultrarelativistic. In this case it has an
𝑓 𝑝 (p) =
0 [exp( 𝑝/𝑝0) + 1]−1 (where 𝜁 is the Riemann zeta

decouples while it
ultrarelativistic Fermi-Dirac momentum distribution,
[6𝜋𝜁 (3)]−1 𝑝−3
function), so that 𝐶 = [12𝜋𝜁 (3)]−1 (cid:39) 0.0221 and 𝑝0d = 𝑇d.

Let us now consider a time when the dark matter is nonrelativistic
(regardless of whether it was relativistic at decoupling). Its spatial
density is then 𝜌m𝑎−3, where 𝜌m is the present-day dark matter den-
sity (i.e. at 𝑎 = 1). Consequently, the maximum density in position-
momentum phase space is (𝐶 𝑝−3
0 )(𝜌m𝑎−3) = 𝐶 𝜌m ( 𝑝0d𝑎d)−3.
Within dark matter haloes we ﬁnd it more convenient to work with
the equivalent position-velocity phase-space density, the maximum
value of which is therefore

𝑓max = 𝐶 𝜌m ( 𝑝0d𝑎d/𝑚)−3,

(11)

where 𝑚 is the mass of the dark matter particle.

We may now estimate a halo’s thermal core radius 𝑟c as the largest
radius at which its phase-space density reaches the value 𝑓max. If we
also deﬁne 𝜌c ≡ 𝜌(𝑟c), then we show in Appendix C that
𝜌c𝑟6

c (cid:39) 3 × 10−5𝐺−3 𝑓 −2
max

(12)

MNRAS 000, 1–23 (2021)

HaloH3,a=0.96x-yslicey-zslice−0.010.000.01z-xslice−0.20.00.2HaloW5,a=0.96−0.010.000.01−0.20.00.2HaloC3,a=0.96−0.010.000.01−0.20.00.2HaloW1,a=0.96−0.010.000.01−0.20.00.2position18 M. S. Delos & S. D. M. White

Figure 22. Matter power spectrum at redshift 𝑧 = 267 in a 3.5 keV WDM
scenario (solid black curve) compared to appropriately rescaled versions of
our 𝑛 = −2 and 𝑛 = −2.67 power-law simulation power spectra. In particular
we rescale to match 𝜎, the rms density contrast, and (cid:104)𝑘2 (cid:105). The 3.5 keV
WDM power spectrum appears to eﬀectively lie somewhere between these
two power laws.

for a halo with central cusp 𝜌 ∝ 𝑟−𝛾 with 1 (cid:46) 𝛾 (cid:46) 1.5. Thus, once a
halo’s rescaled density proﬁle 𝜌𝑟6 approaches 𝜌c𝑟6
c , its central cusp
must give way to a thermal core.

Figure 23. Predicted core sizes for our simulated haloes if they arise in a
WDM scenario. In particular, we plot the density proﬁles 𝜌(𝑟 ) (scaled by
𝑟 3/2) for the haloes that arise from the 𝑛 = −2 (dashed curves) and 𝑛 = −2.67
(solid curves) power spectra. These haloes have been rescaled to correspond
to a 3.5 keV WDM scenario (as described in the text). Each halo is plotted in
a diﬀerent colour, and for each halo we plot the density proﬁle shortly after
formation (thin curve) and a factor of about 1.9 in the scale factor later (thick
curve). On the left, we show the 𝜌𝑟 6 = 𝜌c𝑟 6
c line (black) corresponding to
Eq. (12). Each halo’s inner cusp is expected to give way to a central core
where it crosses this line.

5.2 Warm dark matter core sizes

Let us now explore the core sizes that would develop in our simulated
haloes if they were to form in a WDM cosmology. Eq. (A3) of Bode
et al. (2001) gives the characteristic nonrelativistic streaming velocity
( 𝑝0d/𝑚)(𝑎d/𝑎) as a function of the present-day dark matter density
Ω𝜒 (in units of the critical density), the Hubble parameter ℎ, the
dark matter particle’s eﬀective number 𝑛𝜒 of degrees of freedom,
and its mass 𝑚. We ﬁx 𝑚 = 3.5 keV, 𝑔𝜒 = 1.5, ℎ = 0.68, and
Ω𝜒 = 0.3 (and for simplicity we assume that dark matter constitutes
all of the matter). Consequently, 𝑝0d𝑎d/𝑚 = 7.8 × 10−9, and hence
by Eq. (11), 𝑓max = 1.8 × 1033 M(cid:12) Mpc−3.18 Now Eq. (12) implies
that the phase-space barrier lies at 𝜌c𝑟6

c = 8.0 × 10−14 M(cid:12) Mpc3.

The simulations, however, have been carried out with arbitrary
units. To ﬁx the units, we must compare our power spectra (Eq. 1)
to the power spectrum that arises in the WDM scenario described
above. We evaluate the matter power spectrum using the ﬁtting form
from Eisenstein & Hu (1998) and normalize it to 𝜎8 = 0.81 (Planck
Collaboration et al. 2020) at 𝑎 = 1. Next, we use the transfer func-
tion described in Bode et al. (2001) to apply the small-scale cutoﬀ
corresponding to the WDM scenario above. In particular, we ﬁnd
that the free-streaming length 𝛼 of Bode et al. (2001) in this scenario
is 𝛼 = 0.017 Mpc. We now recall that our simulations begin when
the rms density contrast is 𝜎 = 0.03. The WDM power spectrum
described above must be scaled back to 𝑧 = 267 (using the growth
function) to have the same rms density contrast. Consequently, we in-
terpret the starting redshift of our simulations to be 𝑧 = 267, and their
ﬁnal redshifts range over 3.8 < 𝑧 < 7.0 for the 𝑛 = −2 and 𝑛 = −2.67
cases which are most relevant in this context. Figure 22 shows the
WDM power spectrum at the initial time (thick solid curve).

The remaining step is to ﬁx the length scales in the simulations.
Since the simulation power spectra have diﬀerent forms than the

18 We take the speed of light 𝑐 = 1.

MNRAS 000, 1–23 (2021)

WDM power spectrum, there is no unique way to make this as-
sociation. We choose to ﬁx (cid:104)𝑘2(cid:105) (Eq. 3; see the considerations in
Section 2), which evaluates to (cid:104)𝑘2(cid:105) = 150 Mpc−2 for the WDM
power spectrum. Consequently we take the simulation length unit to
be (cid:104)𝑘2(cid:105)−1/2 = 8.2 × 10−2 Mpc (see Table 1), which implies that the
exponential cutoﬀ wavenumber is 𝑘cut (cid:39) 17 Mpc−1 for 𝑛 = −2 and
𝑘cut (cid:39) 29 Mpc−1 for 𝑛 = −2.67. Figure 22 shows the rescaled 𝑛 = −2
(dashed curve) and 𝑛 = −2.67 (thin solid curve) power spectra.

The WDM power spectrum evidently lies eﬀectively somewhere
between the 𝑛 = −2 and 𝑛 = −2.67 power spectra, so we consider
the nine simulated haloes that arose therefrom. After applying the
scaling described above, we plot density proﬁles for these haloes in
Fig. 23. We also plot the line 𝜌𝑟6 = 𝜌c𝑟6
c = 8 × 10−14 M(cid:12) Mpc3;
the interpretation is that each halo’s inner cusp (as long as its slope
lies between 𝜌 ∝ 𝑟−3/2 and 𝜌 ∝ 𝑟−1) must give way to a central core
once it crosses this line. Evidently, each halo’s 𝜌 ∝ 𝑟−3/2 cusp should
extend over about two decades in radius shortly after formation and
up to almost three decades in radius after halo growth in those cases
where the 𝑟−3/2 cusp persists. In general, haloes in this WDM sce-
nario have core radii of about 3 pc. At early times, we resolve the
inner cusps of our haloes down to about three times the predicted
core radius, although this resolution worsens as time goes on.

5.3 Cold dark matter core sizes

We also explore core sizes that would arise in a CDM cosmology.
In particular, we suppose that the dark matter has particle mass
𝑚 = 100 GeV and kinetically decouples at the temperature 𝑇d =
30 MeV. In this case, 𝑝0d𝑎d/𝑚 = 9.2 × 10−14 and hence 𝑓max =
3.1 × 1048 M(cid:12) Mpc−3, which implies that the phase-space barrier
lies at 𝜌c𝑟6

c = 2.7 × 10−44 M(cid:12) Mpc3.

To ﬁnd the power spectrum, we scale the aforementioned Eisen-
stein & Hu (1998) ﬁtting function using the CDM transfer function
in Green et al. (2005). We extrapolate this power spectrum back

10−1100101k(Mpc−1)10−610−510−410−3P(k)3.5keVWDMatz=267n=−2powerlawn=−2.67powerlaw10−510−410−310−2r(Mpc)10111012ρr3/2(M⊙Mpc−3/2)W1W2W3W4W5C1C2C3C4Inner cusps of the ﬁrst haloes

19

power spectrum along with the corresponding phase-space barrier
𝜌𝑟6 = 2.7 × 10−44 M(cid:12) Mpc3. Core radii in this scenario evidently
lie around 10−5 pc, where the proﬁles would cross the phase-space
barrier. Interestingly, despite the huge diﬀerence in scales between
the ﬁrst haloes in these WDM and CDM scenarios, the core radii are
very similar when considered as fractions of the halo (or cusp) radii.
CDM core radii are only about three times smaller than WDM cores
in this relative sense. Like in the WDM case, the 𝜌 ∝ 𝑟−3/2 cusps
of CDM haloes can extend across two to three decades in radius in
cases where they persist.

5.4 Scaling behaviour

The observation that CDM and WDM core sizes are nearly the same,
when considered in relation to the extent of the halo’s inner cusp,
merits further discussion. In a general sense, it is expected that core
sizes and cusp sizes scale together because the former are set by the
dark matter thermal velocity distribution while the latter are set by
the drift distances that result from these velocities. However, it is not
obvious that their mutual scaling should be so tight.

Consider dark matter particles with mass 𝑚 that kinetically decou-
pled at the scale factor 𝑎d during the last radiation-dominated epoch
with characteristic (possibly relativistic) momentum 𝑝0d. Their char-
acteristic comoving drift distance is

𝜆 =

∫ 𝑎

𝑎d

d𝑎(cid:48)

(cid:104)1 + (cid:0) 𝑝0d 𝑎d

(cid:1)−2(cid:105) −1/2

𝑚𝑎(cid:48)
𝑎(cid:48)2𝐻 (𝑎(cid:48))

by the scale factor 𝑎, where

Λfs (cid:39) ln

(cid:34)

8
1+√︁1+ ( 𝑝0d/𝑚)2

(cid:35)

𝑎eq
𝑎d

(cid:18) 8𝜋𝐺
3

=

𝜌m𝑎eq

(cid:19)−1/2 𝑝0d𝑎d

𝑚

Λfs

(13)

(14)

is roughly the logarithm of the factor in 𝑎 over which particles stream
nonrelativistically during radiation domination. Here 𝐻 (𝑎) is the
Hubble rate, 𝜌m is the matter density at 𝑎 = 1 today, and 𝑎eq is the
scale factor at matter-radiation equality. In Eq. (14) we assume the
dark matter becomes nonrelativistic long before 𝑎eq and that we are
evaluating 𝜆 at a scale factor 𝑎 (cid:29) 𝑎eq. We also neglect changes in the
radiation content, which in general raise Λfs by a small amount.20

If 𝑅 is the characteristic (comoving) size of a peak in the primordial
density ﬁeld smoothed by free streaming, we expect that 𝑅 ∼ 𝜆. For
a halo that collapses at the scale factor 𝑎c from such a peak, we thus
expect that the halo’s 𝜌 ∝ 𝑟−3/2 cusp has coeﬃcient 𝐴 = 𝜌𝑟3/2 ∼
𝜌m𝑎−3/2
𝜆3/2 and initial radius 𝑟0 ∼ 𝑎c𝜆 (see Section 3.2). Now
c
through these relations and Eqs. (11), (12), and (13) we ﬁnd that

𝑟c/𝑟0 ∼ (𝑎c/𝑎eq)−2/3Λ−4/3
The mutual scaling between core radius 𝑟c and cusp radius 𝑟0 thus
emerges, and we see that there are two main inﬂuences that can

(15)

fs

.

Figure 24. Matter power spectrum at redshift 𝑧 = 1272 in a 100 GeV CDM
scenario (black) compared to a version of our 𝑛 = −2.67 power-law simulation
power spectrum that we rescale to match 𝜎 and (cid:104)𝑘2 (cid:105) (orange).

Figure 25. Predicted core sizes for our simulated haloes if they arise in a CDM
scenario. We plot the density proﬁles 𝜌(𝑟 ) (scaled by 𝑟 3/2) for the haloes
that arise from the 𝑛 = −2.67 power spectrum, and these haloes have been
rescaled to correspond to a 100 GeV CDM scenario with kinetic decoupling
at 30 MeV. As in Fig. 23, each halo is represented by a diﬀerent colour, and
for each halo we plot the density proﬁle shortly after formation (thin curve)
and a factor of about 1.9 in the scale factor later (thick curve). We show on
the left the 𝜌𝑟 6 = 𝜌c𝑟 6
c barrier (black) at which each halo’s inner cusp is
expected to give way to a central core.

to 𝑧 = 1272 so that 𝜎 = 0.03.19 The resulting power spectrum
is shown as the black curve in Fig. 24. This power spectrum has
(cid:104)𝑘2(cid:105) = 7.4 × 1010 Mpc−2, so we take our simulation length unit to
be 3.7 × 10−6 Mpc.

Figure 24 shows the appropriately rescaled version of our 𝑛 =
−2.67 power spectrum (orange curve). This power spectrum is some-
what too steep to faithfully represent the CDM scenario, but the
mismatch is not serious. We now show in Fig. 25 the appropriately
rescaled density proﬁles of the haloes arising from the 𝑛 = −2.67

19 We use the growth function that is valid in mixed matter-dark energy
domination. At such early times, the radiation density also has a signiﬁcant
inﬂuence on the growth function, but since our simulations were carried
out assuming matter domination, we neglect this eﬀect in order to maintain
consistency. Also, baryons do not cluster at the scale of the CDM cutoﬀ,
an eﬀect that makes CDM density variations grow slightly more slowly on
such scales (Hu & Sugiyama 1996). Since neither our simulations nor the
Eisenstein & Hu (1998) power spectrum that we use include this eﬀect, we
also neglect it in the growth function.

20 𝐻 is scaled by (𝑔∗/3.36) 1/2 (𝑔∗𝑠/3.91) −2/3, where 𝑔∗ and 𝑔∗𝑠 are the
eﬀective numbers of relativistic degrees of freedom for energy and entropy
density, respectively. Assuming only Standard Model content, this factor is
1 at temperatures below about 1 MeV, roughly 0.9 at temperatures between
1 MeV and 100 MeV, and roughly 0.6 at temperatures above about 100 MeV
(e.g. Husdal 2016). Since 𝜆 ∼ 𝐻 −1, inclusion of this eﬀect can boost 𝜆 by up
to a factor of about 2, although typically the eﬀect is far smaller because 𝐻 −1
appears inside an integral. Warm dark matter, however, can require large 𝑔∗
at decoupling to give dark matter the observed relic abundance.

MNRAS 000, 1–23 (2021)

102103104105106k(Mpc−1)10−610−510−4P(k)100GeVCDMatz=1272n=−2.67powerlaw10−1110−1010−910−810−7r(Mpc)106107ρr3/2(M⊙Mpc−3/2)C1C2C3C420 M. S. Delos & S. D. M. White

raise 𝑟0 without raising 𝑟c.21 The ﬁrst possibility is to raise Λfs
by increasing the duration of nonrelativistic drift (or by raising the
number of relativistic degrees of freedom in the early universe).
This change raises the free-streaming length without altering particle
velocities and hence 𝑓max. The second possibility is to form haloes
later, which raises the physical free-streaming scale 𝑎c𝜆 without
altering 𝑓max.

CDM and WDM have comparable values of Λfs (of order 10)
and 𝑎c/𝑎eq (of order 100), so they approximately preserve the mu-
tual scaling between 𝑟c and 𝑟0. However, nonstandard early-universe
physics can break this scaling to a more serious extent. For instance,
certain inﬂationary (e.g. Ben-Dayan & Brustein 2010) or postinﬂa-
tionary (e.g. Erickcek & Sigurdson 2011) scenarios can greatly boost
the power spectrum at small scales, potentially leading to 𝑎c ∼ 𝑎eq
for the ﬁrst haloes. Moreover, if the dark matter decoupled in the
presence of a large number of beyond-Standard Model relativistic
degrees of freedom, this eﬀect could signiﬁcantly raise Λfs. A large
injection of entropy after dark matter decoupling, such as that aris-
ing from a period of early matter domination (e.g. Allahverdi et al.
2021), has a similar eﬀect. Also, these considerations only apply to
haloes that form at the free-streaming scale. Inﬂationary dynamics
(e.g. Barnaby & Huang 2009) can give rise to features in the pri-
mordial power spectrum that are completely independent of the free-
streaming scale, and similar features can arise in the matter power
spectrum due to postinﬂationary physics (e.g. Hogan & Rees 1988;
Erickcek et al. 2021). If such a feature is suﬃciently pronounced to
form haloes by direct collapse, those haloes could develop 𝜌 ∝ 𝑟−3/2
density proﬁles with arbitrarily small cores.

6 CONCLUSIONS

We have carried out high-resolution cosmological zoom simulations
of twelve ﬁrst-generation haloes of mass corresponding approxi-
mately to the small-scale cutoﬀ in the ﬂuctuation power spectrum.
The three idealized linear power spectra we considered correspond
roughly (but not exactly) to those associated with hot, warm, and
cold dark matter. Our main ﬁndings are the following:

(i) Soon after collapse and for all three initial power spectra, al-
most all our haloes contained central cusps with 𝜌 ∝ 𝑟−3/2 and with
total mass comparable to that of the peak in the linear density ﬁeld
from which the halo originated. We could follow this cusp over as
many as two decades in radius. Cusp formation is independent both of
collapse morphology and of the prominence of small-scale N-body
clumping artifacts in the pre-collapse structure. Collapses through
a ﬁlament, through a sheet, and through more complex caustic net-
works all produce similar cusps. We explicitly veriﬁed in one case
that the cusp proﬁle is stable with respect to changes in the simulation
resolution.

(ii) Since the cusp forms so quickly after collapse, its coeﬃcient
𝐴 = 𝜌𝑟3/2 is sensitive almost wholly to the immediate neighborhood
of the halo’s precursor density peak. This outcome conﬁrms earlier
ﬁndings by Delos et al. (2019). In particular, we ﬁnd the peak’s height
and spherically averaged characteristic radius, along with the tidal

21 𝑟c/𝑟0 is also sensitive to the shape of the initial momentum distribution,
both through the normalization factor 𝐶 (see Section 5.1) and the form
of the power spectrum cutoﬀ, which sets the connection between 𝜆 and
the distribution of peak radii 𝑅. The 𝑅 distribution also depends on the
underlying initial power spectrum of density variations. These are order-unity
considerations, however.

MNRAS 000, 1–23 (2021)

tensor at the location of the peak, suﬃce to determine 𝐴 to within 10
to 20 per cent.

(iii) Haloes that initially possess 𝜌 ∝ 𝑟−3/2 central cusps tend
to develop shallower density proﬁles as they grow. However, unlike
previous works that attributed this process to major mergers, we
ﬁnd that it can be attributed to rapid accretion in general (which
includes major mergers, minor mergers, and accretion of the smooth
background). In fact, this shallowing is consistent with simple models
of the sort presented by Dalal et al. (2010) and Ludlow et al. (2013)
that connect halo density proﬁles to their accretion histories. But
unlike mergers, rapid accretion tends to build up a halo’s density
proﬁle at intermediate and large radii without disturbing its inner
proﬁle; it does not necessarily disrupt the initial 𝜌 ∝ 𝑟−3/2 cusp.

(iv) Major mergers can disturb the central 𝜌 ∝ 𝑟−3/2 cusp, as
Ogiya et al. (2016) and Angulo et al. (2017) found. In two cases,
we found that a major merger event reduced the amplitude of the
central 𝜌 ∝ 𝑟−3/2 cusp by about 10 per cent (although we do not
have the resolution to assess whether the cusp’s slope changed). In
the absence of mergers, on the other hand, the central cusp remains
undisturbed even when accretion is otherwise rapid. We also found
a case where even a major merger had no impact on the central cusp.
Within our halo sample and resolution limits, the extent to which
mergers disrupt the 𝜌 ∝ 𝑟−3/2 cusp remains small.

(v) For haloes that grow suﬃciently slowly, the 𝜌 ∝ 𝑟−3/2 central
cusp can continue to comprise between 1 and 10 per cent of the total
halo mass even long after the halo’s formation. Two of the haloes
arising from the hot dark matter-like power spectrum maintained a
cusp mass fraction in this range over a factor of about 10 in the scale
factor. On the other hand, a period of rapid accretion tends to swiftly
reduce the cusp mass fraction below 10−3.

(vi) The 𝜌 ∝ 𝑟−3/2 cusp invariably has a nearly isotropic velocity
dispersion. Conversely, it exhibits a wide range of three-dimensional
shapes across diﬀerent haloes and even for the same halo across
diﬀerent times. Equidensity surfaces within the cusp tend to align
with those of the halo at larger radii.

(vii) It is still unclear how far down in radius the 𝜌 ∝ 𝑟−3/2 cusp
can extend, owing to the limits of our simulation resolution. How-
ever, if the dark matter was once in contact with the radiation bath,
then its residual thermal motion means that any density cusp must
give way to a ﬁnite-density core at small enough radii. Some of our
simulations probe radii down to as little as three times the expected
core radius in a warm dark matter scenario, which suggests that the
question of how much farther the 𝜌 ∝ 𝑟−3/2 cusp can extend may be
largely immaterial, at least for conventional dark matter models in
which the power spectrum’s cutoﬀ arises from thermal free stream-
ing. Nevertheless, the core radius is small enough that the 𝜌 ∝ 𝑟−3/2
density proﬁle can be important if it survives.

Survival of the 𝜌 ∝ 𝑟−3/2 central cusp through periods of rapid
accretion can lead to density proﬁles resembling that in Fig. 11.
There, a halo with an Einasto density proﬁle at intermediate and
large radii still possesses its natal 𝜌 ∝ 𝑟−3/2 cusp at the smallest
radii. In larger-scale cosmological simulations, this cusp might go
unresolved, which could explain why some works (e.g. Wang et al.
2020) found no evidence of 𝜌 ∝ 𝑟−3/2 cusps despite resolving the
smallest haloes. Moreover, this picture demonstrates a new avenue by
which the 𝜌 ∝ 𝑟−3/2 cusps of the ﬁrst haloes may transition into the
Einasto density proﬁles seen at larger scales. Since this mechanism
does not destroy the cusp, this discovery raises the prospect that a
signiﬁcant number of 𝜌 ∝ 𝑟−3/2 cusps could survive up to the present
day.

We studied only a small halo sample over a limited time range.

More work is needed to determine the true extent to which the
𝜌 ∝ 𝑟−3/2 cusps of the ﬁrst haloes persist through cosmic time.
If these cusps survive, they could have observational implications.
The abundance of the smallest subhaloes could be larger than previ-
ously estimated, owing to the lower eﬃciency of tidal stripping for
steep central cusps (Peñarrubia et al. 2010; Stücker et al. 2022a).
For instance, Lee et al. (2021) concluded that the suppression of
the smallest CDM subhaloes by tidal stripping pushes them outside
the reach of pulsar timing searches. This conclusion may need to
be reassessed if 𝜌 ∝ 𝑟−3/2 density proﬁles persist. Separately from
the question of subhalo survival, observable signatures of dark mat-
ter haloes, such as through dark matter annihilation (e.g. Ishiyama
et al. 2010) and astrometric microlensing (Erickcek & Law 2011),
tend to be larger if they have steeper cusps. We also comment that
these considerations are ampliﬁed for nonstandard cosmological ini-
tial condition scenarios in which small-scale density variations are
boosted (e.g. Erickcek & Sigurdson 2011). The haloes that arise at
those boosted scales grow slowly, so their 𝜌 ∝ 𝑟−3/2 cusps may
remain a large fraction of the total mass in haloes.

Finally, we have not addressed the question of why the 𝜌 ∝ 𝑟−3/2
density proﬁle arises. This proﬁle appears to be a general conse-
quence of the collapse of a smooth density peak, independent of the
details of the collapse process. It has been observed that the Einasto
or NFW density proﬁles of idealized CDM haloes can largely be
explained by appealing to their accretion histories (Dalal et al. 2010;
Ludlow et al. 2013), an idea that is linked to the notion that material
stratiﬁes within the halo based on its accretion time (see Section 4.1).
However, this idea cannot explain the 𝜌 ∝ 𝑟−3/2 density proﬁles of
the ﬁrst haloes; these proﬁles form immediately upon collapse, before
there is any meaningful accretion history. A new idea is needed.

ACKNOWLEDGEMENTS

We thank Neal Dalal, Benedikt Diemer, and Go Ogiya for useful
discussions. The simulations for this work were carried out on the
MPA’s Freya computing cluster at the Max Planck Computing and
Data Facility.

DATA AVAILABILITY

Simulation data are available upon reasonable request to the corre-
sponding author.

REFERENCES

Inner cusps of the ﬁrst haloes

21

Dalal N., Lithwick Y., Kuhlen M., 2010, arXiv e-prints, p. arXiv:1010.2539
Dalcanton J. J., Hogan C. J., 2001, ApJ, 561, 35
Dehnen W., 2001, MNRAS, 324, 273
Delos M. S., Erickcek A. L., Bailey A. P., Alvarez M. A., 2018a, Phys. Rev. D,

97, 041303

Delos M. S., Erickcek A. L., Bailey A. P., Alvarez M. A., 2018b, Phys. Rev. D,

98, 063527

Delos M. S., Bruﬀ M., Erickcek A. L., 2019, Phys. Rev. D, 100, 023523
Diemand J., Moore B., Stadel J., 2005, Nature, 433, 389
Diemer B., Kravtsov A. V., 2014, ApJ, 789, 1
Einasto J., 1965, Trudy Astroﬁzicheskogo Instituta Alma-Ata, 5, 87
Eisenstein D. J., Hu W., 1998, ApJ, 496, 605
Enzi W., et al., 2021, MNRAS, 506, 5848
Erickcek A. L., Law N. M., 2011, ApJ, 729, 49
Erickcek A. L., Sigurdson K., 2011, Phys. Rev. D, 84, 083503
Erickcek A. L., Ralegankar P., Shelton J., 2021, Phys. Rev. D, 103, 103508
Green A. M., Hofmann S., Schwarz D. J., 2005, J. Cosmology Astropart.

Phys., 2005, 003

Hogan C. J., Rees M. J., 1988, Physics Letters B, 205, 228
Hu W., Sugiyama N., 1996, ApJ, 471, 542
Husdal L., 2016, Galaxies, 4, 78
Huss A., Jain B., Steinmetz M., 1999, MNRAS, 308, 1011
Ishiyama T., 2014, ApJ, 788, 27
Ishiyama T., Ando S., 2020, MNRAS, 492, 3662
Ishiyama T., Makino J., Ebisuzaki T., 2010, ApJ, 723, L195
Lee V. S. H., Mitridate A., Trickle T., Zurek K. M., 2021, Journal of High

Energy Physics, 2021, 28

Lovell M. R., Frenk C. S., Eke V. R., Jenkins A., Gao L., Theuns T., 2014,

MNRAS, 439, 300

Ludlow A. D., et al., 2013, MNRAS, 432, 1103
Macciò A. V., Paduroiu S., Anderhalden D., Schneider A., Moore B., 2012,

MNRAS, 424, 1105

Mo H., van den Bosch F. C., White S., 2010, Galaxy Formation and Evolution
Moore B., Quinn T., Governato F., Stadel J., Lake G., 1999, MNRAS, 310,

1147

Navarro J. F., Frenk C. S., White S. D. M., 1996, ApJ, 462, 563
Navarro J. F., Frenk C. S., White S. D. M., 1997, ApJ, 490, 493
Navarro J. F., et al., 2004, MNRAS, 349, 1039
Navarro J. F., et al., 2010, MNRAS, 402, 21
Ogiya G., Hahn O., 2018, MNRAS, 473, 4339
Ogiya G., Nagai D., Ishiyama T., 2016, MNRAS, 461, 3385
Peñarrubia J., Benson A. J., Walker M. G., Gilmore G., McConnachie A. W.,

Mayer L., 2010, MNRAS, 406, 1290

Planck Collaboration et al., 2020, A&A, 641, A6
Polisensky E., Ricotti M., 2015, MNRAS, 450, 2172
Power C., Navarro J. F., Jenkins A., Frenk C. S., White S. D. M., Springel V.,

Stadel J., Quinn T., 2003, MNRAS, 338, 14

Sheth R. K., Mo H. J., Tormen G., 2001, MNRAS, 323, 1
Springel V., Pakmor R., Zier O., Reinecke M., 2021, MNRAS, 506, 2871
Strigari L. E., Bullock J. S., Kaplinghat M., Kravtsov A. V., Gnedin O. Y.,

Abazajian K., Klypin A. A., 2006, ApJ, 652, 306

Allahverdi R., et al., 2021, The Open Journal of Astrophysics, 4, 1
Allgood B., Flores R. A., Primack J. R., Kravtsov A. V., Wechsler R. H.,

Stücker J., Hahn O., Angulo R. E., White S. D. M., 2020, MNRAS, 495, 4943
Stücker J., Ogiya G., Angulo R. E., Aguirre-Santaella A., Sánchez-Conde

Faltenbacher A., Bullock J. S., 2006, MNRAS, 367, 1781

M. A., 2022a, arXiv e-prints, p. arXiv:2207.00604

Anderhalden D., Diemand J., 2013, J. Cosmology Astropart. Phys., 2013, 009
Angulo R. E., White S. D. M., 2010, MNRAS, 401, 1796
Angulo R. E., Hahn O., Abel T., 2013, MNRAS, 434, 3337
Angulo R. E., Hahn O., Ludlow A. D., Bonoli S., 2017, MNRAS, 471, 4687
Avila-Reese V., Colín P., Valenzuela O., D’Onghia E., Firmani C., 2001, ApJ,

559, 516

Bardeen J. M., Bond J. R., Kaiser N., Szalay A. S., 1986, ApJ, 304, 15
Barnaby N., Huang Z., 2009, Phys. Rev. D, 80, 126018
Ben-Dayan I., Brustein R., 2010, J. Cosmology Astropart. Phys., 2010, 007
Bertschinger E., 2006, Phys. Rev. D, 74, 063509
Binney J., Tremaine S., 2008, Galactic Dynamics: Second Edition
Bode P., Ostriker J. P., Turok N., 2001, ApJ, 556, 93
Busha M. T., Evrard A. E., Adams F. C., 2007, ApJ, 665, 1

Stücker J., Angulo R. E., Hahn O., White S. D. M., 2022b, MNRAS, 509,

1703

Tremaine S., Gunn J. E., 1979, Phys. Rev. Lett., 42, 407
Vera-Ciro C. A., Sales L. V., Helmi A., Frenk C. S., Navarro J. F., Springel

V., Vogelsberger M., White S. D. M., 2011, MNRAS, 416, 1377

Villaescusa-Navarro F., Dalal N., 2011, J. Cosmology Astropart. Phys., 2011,

024

Wang J., White S. D. M., 2007, MNRAS, 380, 93
Wang J., White S. D. M., 2009, MNRAS, 396, 709
Wang J., Bose S., Frenk C. S., Gao L., Jenkins A., Springel V., White S. D. M.,

2020, Nature, 585, 39

White S. D. M., Frenk C. S., Davis M., 1983, ApJ, 274, L1

MNRAS 000, 1–23 (2021)

22 M. S. Delos & S. D. M. White

Figure A1. Total enclosed mass proﬁles of our haloes (diagonal curves
through the centre) along with the mass proﬁles contributed by low-resolution
particles only (lower right). We average these proﬁles over the ﬁnal factor of
1.17 in the scale factor (i.e. from 𝑎f /1.17 to 𝑎f ). Black tick marks in the
lower right show for each primary (low-resolution) simulation the mass of
one low-resolution particle (but since we time average it, the mass proﬁle
of low-resolution particles is not required to advance in integer multiples
thereof). Evidently, low-resolution particles comprise (cid:46) 1 per cent of each
halo, and all such particles reside at radii too large to aﬀect this study’s
conclusions (compare Fig. 10).

APPENDIX A: MIXING OF LOW- AND
HIGH-RESOLUTION PARTICLES

Section 2 describes how we prepare our high-resolution halo simu-
lations. After choosing the halo in a low-resolution simulation, we
identify the Lagrangian region spanned by halo particles and replace
all of the low-resolution particles in that region with much more nu-
merous high-resolution particles. To spare computational expense,
however, we do not make the high-resolution region so large as to
ensure that low-resolution particles never fall into the high-resolution
halo. In this appendix, we show that any numerical artifacts that arise
from this choice cannot impact our results.

Mixing of particles of diﬀerent masses can accelerate two-body
relaxation eﬀects (e.g. Binney & Tremaine 2008). Artiﬁcial energy
exchange between simulation particles causes the more massive par-
ticles to gradually sink to the centre of the system while the light
particles are dynamically heated. However, we plot in Fig. A1 the
total enclosed mass proﬁle 𝑀 (𝑟) of each of our haloes along with the
mass proﬁle contributed by low-resolution particles at the ﬁnal scale
factor 𝑎f. Evidently, each halo’s low-resolution particles contribute
1 per cent or less of the total mass. Moreover, all such particles re-
side at radii so large that this small mass fraction cannot alter the
conclusions of our study. Comparison with Fig. 10 shows that, for
all haloes, the low-resolution particles lie outside both the central
𝜌 ∝ 𝑟−3/2 cusp and any shallower portion of the density proﬁle
created by rapid accretion.

APPENDIX B: NUMERICAL CONVERGENCE AT SMALL
RADII

We simulated halo W5 at the highest spatial resolution of all of our
haloes (see Table 2). In this section we test numerical convergence
by simulating the same halo at worse resolution; speciﬁcally we raise
the simulation particle mass 𝑚 𝑝 and the force softening length 𝜖.

MNRAS 000, 1–23 (2021)

We carried out two simulations in which we raise the particle mass
by factors of 8 and 64 and the softening length by factors of 2 and
4, respectively. Figure B1 plots this halo’s density proﬁle at four
diﬀerent times in the original simulation (cyan) and in both reduced-
resolution simulations (red and black). All density proﬁles transition
into a core at small radii, but this core is clearly artiﬁcial in that
its radius scales with the spatial resolution. The 𝜌 ∝ 𝑟−3/2 part of
the density proﬁle, on the other hand, appears to be converged with
respect to simulation resolution at all four times.

We ﬁnd that the radius above which the density proﬁle is converged
is reasonably well approximated by 5𝜖, where 𝜖 is the force-softening
length. Figure B1 depicts the density proﬁle at radii below 5𝜖 with
a thin dotted line. The idea here is that force softening introduces a
bias (e.g. Dehnen 2001) that makes systems less tightly bound, and
the relative eﬀect becomes larger as we consider systems closer to the
softening scale. However, this criterion somewhat fails at the earliest
times for reasons that are unclear. In particular, the solid red and cyan
curves in the upper left-hand panel begin to shallow at small radii 𝑟
even when 𝑟 > 5𝜖, but this shallowing occurs at diﬀerent radii for
diﬀerent resolution levels. Consequently, tendencies of some of our
haloes’ early density proﬁles to shallow at the smallest radii, e.g. in
Fig. 9, should be interpreted with some skepticism.

Also, while the 5𝜖 condition mostly suﬃces for W5, simulations
carried out over a longer duration must also consider two-body relax-
ation between simulation particles. We evaluate the relaxation time
scale

𝑡rel (𝑟) (cid:39)

𝑁
8 log(𝑟/𝜖)

2𝜋𝑟
√︁𝐺 𝑀/𝑟

(B1)

(e.g. Binney & Tremaine 2008; Power et al. 2003) as a function of
radius 𝑟, where 𝑀 and 𝑁 are the mass and particle count enclosed
within 𝑟. The radius 𝑟rel at which 𝑡rel is equal to the age of the
universe (a decent approximation for the age of any halo) then serves
as an alternative minimum converged radius. In Fig. B1, radii with
5𝜖 < 𝑟 < 𝑟rel are shown in principle with a thin dashed line, but
only at 𝑎 = 1.52 (bottom right) for the lowest-resolution simulation
(black) does an example of such a radius appear. This restriction
becomes more relevant for haloes simulated for longer durations (see
Fig. 3).

APPENDIX C: PHASE-SPACE STRUCTURE OF A
DENSITY CUSP

In this appendix, we quantify the phase-space structure of a density
cusp for the purpose of determining the size of the core that arises
from phase-space conservation. Consider an equilibrium spherical
dark matter system with the density proﬁle
𝜌(𝑟) = 𝐴𝑟−𝛾 .
The coeﬃcient 𝐴 is the system’s sole scaling parameter with dimen-
sions of density × length𝛾. If 𝛾 < 3, then the system’s enclosed mass
proﬁle is

(C1)

𝑀 (𝑟) =

4𝜋
3 − 𝛾

𝐴𝑟3−𝛾 .

If 𝛾 < 2, then the system’s potential is

Φ(𝑟) =

4𝜋
(3 − 𝛾)(2 − 𝛾)

𝐺 𝐴𝑟2−𝛾,

(C2)

(C3)

and dimensional considerations imply that the velocity dispersion
has the same scaling, 𝜎2 ∝ 𝑟2−𝛾. Consequently, the distribution
function scales as 𝑓 ∝ 𝜌/𝜎3 ∝ 𝑟 𝛾/2−3 ∝ Φ−1/2−2/(2−𝛾) . Let us

10−310−210−1100101r10−310−210−1100101102103104M(<r)H1H2H3W1W2W3W4W5C1C2C3C4Inner cusps of the ﬁrst haloes

23

Figure B1. Density proﬁle of the W5 halo at four diﬀerent times (panels) and three diﬀerent simulation resolutions (colours), indicated by the particle mass
𝑚𝑝. The force-softening length 𝜖 is scaled as 𝑚1/3
𝑝 . While the density proﬁles all transition into a uniform-density core at small radii (indicated by a steeply
rising curve in this scaled plot), this transition is evidently artiﬁcial because the transition radius scales with the simulation resolution. Meanwhile, the 𝜌 ∝ 𝑟 −3/2
behaviour (horizontal) is stable with respect to simulation resolution. We plot the density proﬁle at radii below 5𝜖 with a thin dotted line; 𝜖 itself is marked for
each simulation by a coloured tick at the bottom of each panel. We also plot radii above 5𝜖 but below the relaxation limit 𝑟rel (where the relaxation time scale
becomes shorter than the age of the universe; see the text) with a thin dashed line, although for this halo the only example occurs for 𝑎 = 1.52 (lower right-hand
panel) at the lowest simulation resolution (black).

assume that the distribution function is isotropic, so it depends on
energy 𝐸 = Φ + 𝑣2/2 alone, i.e. 𝑓 (𝑟, 𝑣) ∝ 𝐸 −1/2−2/(2−𝛾) . Recall
from Section 4.4 that the velocity dispersion inside the central cusp
is indeed nearly isotropic. If we also assume that 𝛾 > 0, then we can
normalize 𝑓 by requiring that ∫ d3v 𝑓 (𝑟, 𝑣) = 𝜌(𝑟). Then
(cid:17)

Γ

(cid:16) 𝛾
2−𝛾 + 3
2
(cid:16) 𝛾
(cid:17)
2−𝛾

Γ

𝜌(𝑟)
Φ(𝑟)3/2

(cid:20)

1 +

𝑣2
2Φ(𝑟)

(cid:21) − 1

2 − 2
2−𝛾

, (C4)

𝑓 (𝑟, 𝑣) = (2𝜋)−3/2

where Γ is the gamma function.

At each radius 𝑟, the maximum phase-space density is obtained by

setting 𝑣 = 0:22

𝑓 (𝑟, 0) =

[(3−𝛾)(2−𝛾)]3/2
29/2𝜋3

Γ

(cid:17)

(cid:16) 𝛾
2−𝛾 + 3
2
(cid:17)
(cid:16) 𝛾
2−𝛾

Γ

𝐺−3/2 𝐴−1/2𝑟 𝛾/2−3

(C5)

(where we have substituted Eqs. C1 and C3). If some maximum
phase-space density 𝑓max is set by dark matter microphysics, as
discussed in Section 5, then the radius 𝑟c at which 𝑓max is reached is
thus

2
6−𝛾

(cid:17)

Γ

𝑟c =

(cid:20) (3−𝛾)(2−𝛾)
8𝜋2

6−𝛾 
(cid:21) 3






If we deﬁne 𝜌c = 𝜌(𝑟c) and substitute 𝐴 = 𝜌c𝑟 𝛾

(cid:16) 𝛾
2−𝛾 + 3
2
(cid:17)
(cid:16) 𝛾
2−𝛾









Γ

c , then

(𝐺3 𝐴 𝑓 2

max)− 1

6−𝛾 .

(C6)

𝜌c𝑟6

c =

(cid:20) (3 − 𝛾)(2 − 𝛾)
8𝜋2

Γ

(cid:17)

(cid:16) 𝛾
2−𝛾 + 3
2
(cid:17)
(cid:16) 𝛾
2−𝛾

Γ

(cid:21) 3 







2









Figure C1. Sensitivity of the phase-space barrier 𝜌c𝑟 6
c to the density proﬁle
slope 𝛾. In particular, the maximum phase-space density within a 𝜌 ∝ 𝑟 −𝛾
density cusp begins to exceed 𝑓max where 𝜌𝑟 6 drops below 𝜌c𝑟 6
c . For the
typical slopes 1 (cid:46) 𝛾 (cid:46) 1.5 observed in this work and others, 𝜌c𝑟 6
c (cid:39) 3 ×
10−5𝐺−3 𝑓 −2
max.

deﬁnes the general barrier in 𝜌–𝑟 space at which 𝑓max is reached.
The right-hand side of this equation depends only on 𝑓max and not
on the parameters of the particular halo, other than 𝛾. In fact, within
the range 1 < 𝛾 < 1.5, 𝜌c𝑟6
c is almost independent of 𝛾 as well. We
plot its dependence on 𝛾 in Fig. C1; evidently,
𝜌c𝑟6

c (cid:39) 3 × 10−5𝐺−3 𝑓 −2
max

(C8)

𝐺−3 𝑓 −2
max

(C7)

for any halo within this slope range.

22 Interestingly, Eq. (C5) implies that spatially denser haloes (with larger 𝐴)
have lower phase-space density, owing to their higher velocity dispersion.

MNRAS 000, 1–23 (2021)

101ρr3/2a=0.58mp=2.1×10−5mp=2.7×10−6mp=3.3×10−7a=0.79mp=2.1×10−5mp=2.7×10−6mp=3.3×10−710−410−310−210−1r101ρr3/2a=1.07mp=2.1×10−5mp=2.7×10−6mp=3.3×10−710−410−310−210−1ra=1.52mp=2.1×10−5mp=2.7×10−6mp=3.3×10−70.00.51.01.52.0γ0123ρcr6c/(10−5G−3f−2max)