0
2
0
2

r
p
A
4

]
T
S
.
h
t
a
m

[

1
v
7
6
4
6
0
.
4
0
0
2
:
v
i
X
r
a

On Symmetrized Pearson’s Type Test for Normality

of Autoregression: Power under Local Alternatives

M. V. Boldin ∗

Abstract

We consider a stationary linear AR(p) model with observations subject to gross errors

(outliers). The autoregression parameters as well as the distribution function (d.f.) G of

innovations are unknown. The distribution of outliers Π is unknown and arbitrary, their
intensity is γn−1/2 with an unknown γ, n is the sample size. We test the hypothesis for
normality of innovations

HΦ : G

∈ {

Φ(x/θ), θ > 0

,

}

Φ(x) is the d.f. N (0, 1). Our test is the special symmetrized Pearson’s type test. We ﬁnd

the power of this test under local alternatives

ρ

≥

H1n(ρ) : G(x) = An(x) := (1

−

ρn−1/2)Φ(x/θ0) + ρn−1/2H(x),

0, θ0 is the unknown (under HΦ) variance of innovations. First of all we estimate the

autoregression parameters and then using the residuals from the estimated autoregression

we construct a kind of empirical distribution function (r.e.d.f.), which is a counterpart

of the (inaccessible) e.d.f. of the autoregression innovations. After this we construct the

symmetrized variant r.e.d.f. Our test statistic is the functional from symmetrized r.e.d.f.
We obtain a stochastic expansion of this symmetrized r.e.d.f. under H1n(ρ) , which enables
us to investigate our test. We establish qualitative robustness of this test in terms of

uniform equicontinuity of the limiting power (as functions of γ, ρ and Π) with respect to

γ in a neighborhood of γ = 0.

Key words: autoregression, outliers, residuals, empirical distribution function,

Pearson’s chi-square test, robustness, estimators, normality, local alternatives.

∗Moscow State Lomonosov Univ., Dept. of Mech. and Math., Moscow, Russia

e-mail: boldin−m@hotmail.com

1

 
 
 
 
 
 
2010 Mathematics Subject Classiﬁcation: Primary 62G10; secondary 62M10,

62G30, 62G35.

1 Введение

В этой работе мы рассматриваем стационарную AR(p) модель с ненулевым средним

vt = β1vt−1 +

· · ·

+ βpvt−p + ν + εt,

Z.

t

∈

(1.1)

– независимые одинаково распределенные случайные величины

В (1.1)

εt}

{

(н.о.р.сл.в.) с неизвестной функцией распределения (ф.р.) G(x); Eε1 = 0, 0 < Eε2

1 <
Rp– вектор неизвестных параметров, таких что корни соот-
∞
ветствующего (1.1) характеристического уравнения по модулю меньше единицы; ν –

; β = (β1, . . . , βp)T

∈

неизвестное среднее, ν

R1.

∈

Эти условия дальше всегда предполагаются выполненными и особо не оговаривают-

ся.

Мы рассматриваем модель (1.1) с выбросами в наблюдениях. А именно, предполага-

ется, что наблюдаются величины

yt = vt + zγn

t ξt,

t = 1

p, . . . , n,

−

(1.2)

zγn
где v1−p, . . . , vn – выборка из стационарного решения
t }
н.о.р.сл.в., имеющие распределение Бернулли, т.е. принимающие значения 1 и 0, при-

уравнения (1.1);

vt}

{

{

чем вероятность единицы γn,

γn = min(1,

γ
√n

),

γ

≥

0 неизвестно.

Кроме того,

ременные

– н.о.р.сл.в. с произвольным и неизвестным распределением Π. Пе-

ξt}
интерпретируются как выбросы (засорения), γn уровень засорения.

{
ξt}

{

Для γ = 0 мы получаем модель (1.1) без засорений.

Модель (1.2) – локальный вариант хорошо известной модели засорения данных

во временных рядах, см. [8].

В этой работе мы рассматриваем гипотезу о нормальности инноваций

HΦ : G(x)

Φ(x/θ), θ > 0

,

}

∈ {

где Φ(x) – стандартная нормальная ф.р. Напомним, что гипотеза HΦ эквивалентна

нормальности самой стационарной последовательности

.

vt}

{

2

Нормальность инноваций обеспечивает оптимальность процедур наименьших квад-

ратов оценивания и проверки гипотез в авторегрессии, см., например, [1],[6]. Поэтому
проверка HΦ – содержательная задача. В [3] была построена специальная симмет-
ризованная статистика типа хи-квадрат Пирсона для HΦ в схеме (1.1) –(1.2) с неиз-

вестным средним и найдено ее распределение при гипотезе. Необходимый следующий

шаг – найти мощность построенного теста при локальных альтернативах и исследо-

вать устойчивость мощности к выбросам. Этот шаг мы и делаем в настоящей работе.
Обозначим неизвестную дисперсию инноваций при HΦ через θ0. В качестве альтер-
нативы к HΦ берется предположение о том, что

в (1.1) – н.о.р.сл.в. с ф.р. в виде

εt}

{

G(x) = An(x) := (1

−

ρn)Φ(x/θ0) + ρnH(x),

(1.3)

смеси

где

H(x)

−

ф.р., ρn = min(1,

ρ
√n

), ρ

0.

≥

Предположение (1.3) будем понимать как локальную альтернативу к HΦ и обозна-
чать H1n(ρ). Разумеется, HΦ и H1n(0) совпадают.
Наша цель – найти предельное распределение симметризованной статистики из [3]
при H1n(ρ), найти мощность теста и исследовать ее устойчивость к выбросам.
Отметим, что недавно в [2],[5] были получены результаты о проверке HΦ в схеме

(1.1)–(1.2) при ν = 0. Результаты получены и при гипотезе и при локальных аль-

тернативах. Но нулевое среднее – существенное ограничение. В нашей ситуации при

неизвестном и, быть может, ненулевом ν, использовать статистики типа хи квадрат
из [2], [5] не удается, т.к. их предельное распределение зависит от оценок β и ν даже

при γ = 0.

Мы преодолеваем эту трудность, строя симметризованную статистику Пирсон. Раз-

биение, которым она определяется, специальное и симметрично относительно нуля.

Симметризованная статистика Пирсона является функционалом от симметризован-

ной остаточной эмпирической функции распределения (о.э.ф.р.). Мы находим асимп-

тотические распределения симметризованной о.э.ф.р. и нашей статистики Пирсона
при H1n(ρ). Асимптотические распределения симметризованных о.э.ф.р. и статисти-
ки Пирсона при HΦ и γ = 0 свободны. Кроме того, симметризованный тест Пирсона

оказывается качественно робастным.

Все определения и результаты (основные, это Теоремы 2.1–2.2) представлены в

Разделе 2.

3

2 Основные результаты

2.1 Стохастическое разложение о.э.ф. р.

Относительно альтернативы H1n(ρ) из (1.3) нам потребуется сделать некоторые
предположения.

Условие (i). Случайная величина с функцией распределения H(x) имеет нуле-

вое средние и конечную дисперсию.

Условие (ii). Функции распределения H(x) дважды дифференцируема с огра-

ниченной второй производной.

Условие (iii). Функции распределения H(x) симметрична относительно нуля.

Перепишем уравнение (1.1) в удобном для дальнейшего рассмотрения виде. Для

этого определим константу µ соотношеним

ν = (1

β1

−

−

. . .

−

βp)µ,

тогда

vt −

µ = β1(vt−1

µ) +

+ βp(vt−p −

· · ·

−

µ) + εt,

Z.

t

∈

Если положить ut := vt −

µ, то

vt = µ + ut,

ut = β1ut−1 +

+ βput−p + εt,

· · ·

Z.

t

∈

(2.1)

Последовательность

в (2.1) – авторегрессионная последовательность с нулевым

ut}

{

средним и конечной дсперсией.
yt}

Построим по наблюдениям

{

Далее Γ, R –любые конечные неотрицательные числа. Пусть ˆµn будет любая после-
довательность, для которой при H1n(ρ) последовательнсть

из (1.2) оценки ненаблюдаемых

.

εt}

{

n1/2(ˆµn −

µ) = OP (1), n

→ ∞

, равномерно по ρ

R, γ

Γ.

≤

≤

(2.2)

Положим

ˆut = yt −

ˆµn,

t = 1, . . . , n.

Пусть ˆβn = ( ˆβ1n, . . . , ˆβpn)T будет любая последовательность, для которой при H1n(ρ)
последовательность

n1/2( ˆβn −

β) = OP (1), n

→ ∞

, равномерно по ρ

R, γ

Γ.

≤

≤

(2.3)

4

Примеров подходящих оценок ˆµn, ˆβn много, широкий класс составляют, например,
аналогично тому, как они строятся по неза-
М-оценки, построенные по

и

yt}

{

ˆut}

{

соренным данным, см., например, [7]. Результаты для М-оценок при альтернативе
H1n(ρ) в схеме (1.1)–(1.2) вполне аналогичны изложенным в Разделе 2.4 [2].
Положим

ˆεt = ˆut −

ˆβ1n ˆut−1

− · · · −

ˆβpn ˆut−p,

t = 1, . . . , n.

(2.4)

Величины

ˆεt}

{

называются остатками.

Ведем остаточную эмпирическую функцию распределения ( о.э.ф.р.)

ˆGn(x) = n−1

n

X
t=1

I(ˆεt ≤

x),

x

R1.

∈

Здесь и в дальнейшем I(
Функция ˆGn(x) – аналог гипотетической э.ф.р.

) обозначает индикатор события.

·

Gn(x) = n−1

n

X
t=1

I(εt ≤

x)

ненаблюдаемых величин ε1, . . . , εn.
Следствие 2.1 в [4] прямо влечет следующую Теорему 2.1.

Теорема 2.1. Предположим, что верна альтернатива H1n(ρ). Пусть выполнены
Условия (i) – (ii), и пусть ϕ(x) будет стандартная гауссовская плотность. Пусть

0 будут любые конечные числа. Тогда для любого δ > 0

Gn(x)]

−

1
θ0

−

ϕ(

x
θ0

)ˆδnn1/2(ˆµn −

µ)

−

γ∆0(x, Π)

> δ)

|

→

0, n

.

→ ∞

0, R

Γ

≥

sup
ρ≤R,γ≤Γ

P(

|

≥
n1/2[ ˆGn(x)

Здесь сдвиг

∆0(x, Π) =

p

X
j=0

[EG0(x + βjξ1)

G0(x)], β0 =

−

1, G0(x) = Φ(

−

x
θ0

),

а ˆδn = 1

ˆβ1n −

−

. . .

−

ˆβpn.

При гипотезе HΦ ф.р. G(x) = Φ( x

θ0 ) и, значит, симметрична относительно нуля.

Поэтому будем брать оценкой G(x) симметризованную оценку

Положим

ˆSn(x) :=

ˆGn(x) + 1
−
2

ˆGn(

x)

−

.

∆S(x, Π) :=

∆0(x, Π)

∆0(
−
2

x, Π)

−

.

5

(2.5)

(2.6)

Пусть

Sn(x) :=

Gn(x) + 1
−
2

Gn(

x)

−

.

(2.7)

Теорема 2.1 и четность ϕ(x) прямо влекут

Следствие 2.1. При условиях Теоремы 2.1

sup
ρ≤R,γ≤Γ

P(

|

n1/2[ ˆSn(x)

Sn(x)]

−

−

γ∆S(x, Π)

> δ)

|

→

0, n

.

→ ∞

2.2 Симметризованный тест типа хи-квадрат Пирсона для HΦ

В этом разделе мы построим тест типа хи-квадрат Пирсона для проверки

HΦ : G(x)

Φ(x/θ), θ > 0

,

}

∈ {

где Φ(x) – стандартная нормальная ф.р. Как отмечалось во Введении, такая ги-

потеза эквивалентна гауссовости стационарного решения (1.1). Наша цель – найти
распределение тестовой статистики при альтернативе H1n(ρ) из (1.3).

Напомним, θ0 истинное и неизвестное значение θ при HΦ, тогда при HΦ G(x) =

Φ(x/θ0). Для полуинтервалов

B+

j = (xj−1, xj],

j = 1, . . . , m, m > 2, 0 = x0 < x1 < . . . < xm =

,

∞

пусть

При HΦ P(ε1

∈

p+
j (θ) = Φ(xj/θ)

−

Φ(xj−1/θ) > 0.

B+

j ) = p+

j (θ0). Если ввести еще симметричные полуинтервалы

B−

j = (

xj,

−

xj−1], то при HΦ

−

P(ε1

B+

j ∪

∈

B−

j ) = 2p+

j (θ0) := pj(θ0),

m

X
j=1

pj(θ0) = 1.

Пусть ˆν+
j обозначает число остатков среди
обозначает число остатков, попавших в B−

ˆεt, t = 1, . . . , n
}

{
j . Тогда

, попавших в B+

j , а ˆν−

j

ˆν+
j = n[ ˆGn(xj)

−

ˆGn(xj−1)],

j = n[ ˆGn(
ˆν−

xj−1)

−

ˆGn(

xj)].

−

−

(2.8)

Пусть

ˆνj = ˆν+

j + ˆν−
j .

6

Оценкой θ0 мы возьмем n1/2-состоятельное решение уравнения

m

X
j=1

ˆνj
pj(θ)

p

′

j(θ) = 0,

в котором штрих означает производную относительно θ. Такое уравнение – аналог

обычного уравнения модифицированного метода хи-квадрат, в котором ненаблюдае-
мые частоты ν1, . . . , νm инноваций, попавших в B1, . . . , Bm, Bj := B+
j , заменены
их оценками ˆν1, . . . , ˆνm.

j ∪

B−

Интересующая нас тестовая статистика типа хи-квадрат для HΦ имеет вид

ˆχ2
n =

m

X
j=1

npj(ˆθn))2

(ˆνj −

npj(ˆθn)

.

(2.9)

Статистика ˆχ2

n является функционалом от ˆSn(x). Действительно, в силу (2.5) и (2.8)

n[ ˆSn(xj)

−

ˆSn(xj−1)] =

1
2 {

n[ ˆGn(xj)

−

ˆGn(xj−1)] + n[ ˆGn(

xj−1)

−

−

ˆGn(

xj)]

−

=

}

(ˆν+

j + ˆν−

j )/2 = ˆνj/2.

(2.10)

n из (2.9) симметризованной статистикой Пирсона.

Будем называть ˆχ2
Чтобы описать асимптотические свойства ˆχ2
ния. Далее

| · |

означает Евклидову норму вектора или матрицы.

n нам понадобятся некоторые обозначе-

Введем диагональную матрицу

P0 = diag

{

p1(θ0), . . . , pm(θ0)

}

и векторы

p0 = (p1(θ0), . . . , pm(θ0))T , p′

0 = (p′

1(θ0), . . . , p′

m(θ0))T ,

b0 = P −1/2

0

p′

0, α0 = b0/

b0

,

pA = (pA

1 , . . . , pA

m)T с компонентами pA

|

|
j = 2(An(xj)

An(xj−1)),

−

pH = (pH

1 , . . . , pH

m)T ,

pH
j

:= 2(H(xj)

H(xj−1)).

−

Нам понадобится еще вектор

δ(Π) = (δ1(Π), . . . , δm(Π))T

с компонентами δj(Π) = 2[∆S(xj, Π)

∆S(xj−1, Π)],

−

сдвиг ∆S(x, Π) определен в (2.6).

7

Из определения Sn(x) и νj аналогично (2.10) следует:

n[Sn(xj)

−

Sn(xj−1)] = νj/2.

(2.11)

В силу соотношений (2.10) –(2.11), Следствия 2.1 и определения вектора δ(Π) имеем
при H1n(ρ):

n1/2(

ˆνj
n −

pj(θ0))

n1/2(

νj
n −

−

pj(θ0)) = n1/2(

ˆνj
n −

νj
n

) =

2n1/2

{

[ ˆSn(xj)

−

ˆSn(xj−1]

−

[Sn(xj)

−

Sn(xj−1)]

}

= γδj(Π) + oP (1), n

.

(2.12)

→ ∞

Здесь oP (1) обозначает величину, сходящуюся к нулю по вероятности равномерно по
ρ

R, γ

Γ.

≤

≤

Введем вектора

ˆν = (ˆν1, . . . , ˆνm)T , ν = (ν1, . . . , νm)T .

В силу (2.12) при H1n(ρ)

n1/2(

ˆν
n −

p0) = n1/2(

ν
n −

pA) + ρ(pH −

p0) + γδ(Π) + oP (1), n

.

→ ∞

(2.13)

Напомним еще известный факт относительно слабой сходимости вектора ν (см. [5],
соотношение (3.10)): при H1n(ρ) равномерно по ρ

R

≤

n1/2(

ν
n −

pA)

→

N (0, P0

p0pT

0 ), n

.

→ ∞

−

(2.14)

Соотношений (2.13) –(2.14) достаточно, чтобы следуя схеме доказательства Теоремы
2.2 в [5] доказать наше основное утверждение – Теорему 2.2. В ней Fm−2(x, ˆλ2(ρ, γ, Π))
означает ф.р. нецентрального хи-квадрата с m
2 степенями свободы и параметром
нецентральности ˆλ2(ρ, γ, Π), а Em означает единичную матрицу порядка m.

−

Теорема 2.2. Пусть альтернатива H1n(ρ) верна. Пусть выполнены Условия (i)–
(iii). Тогда для любых конечных неотрицательных Γ, R

sup
x∈R1,ρ≤R,γ≤Γ |

P( ˆχ2

n ≤

x)

−

Fm−2(x, ˆλ2(ρ, γ, Π))

0, n

.

→ ∞

| →

Параметр нецентральности равен

ˆλ2(ρ, γ, Π) =

(Em −

|

α0αT

0 )P −1/2

0

[ρ(pH −

p0) + γδ(Π)]

2.

|

В силу Теоремы 2.2 при HΦ, т.е. при ρ = 0, и γ = 0 предельное распределение на-
n будет обычное (центральное) распределение хи-квадрат

шей тестовой статистики ˆχ2
2 степенями свободы.
с m

−

8

Для заданного 0 < α < 1 ( α –асимптотический уровень в схеме без засорений),

мы будем отвергать HΦ, когда

ˆχ2
n > χm−2(1

α),

−

α) – квантиль уровня 1

χm−2(1
свободы. Мощность такого теста равна

−

−

α распределения хи-квадрат с m

(2.15)

2 степенями

−

Wn(ρ, γ, Π) = P ( ˆχ2

n > χm−2(1

α)).

−

В силу Теоремы 2.2 эта мощность сходится при n

к асимптотической мощности

→ ∞

равномерно по ρ

R, γ

Γ

≤

≤

W (ρ, γ, Π) = 1

Fm−2(χm−2(1

−

−

α), ˆλ2(ρ, γ, Π)), W (0, 0, Π) = α.

Используя неравенство

Fk(x, λ2
1)

|

−

Fk(x, λ2
2)

2 sup
x∈R1

ϕ(x)

λ1

|

λ2

,

|

−

| ≤

ϕ(x) стандартная гауссовская плотность, и определение ˆλ2(ρ, γ, Π)), получаем:

sup
Π,ρ≥0 |

W (ρ, γ, Π)

−

W (ρ, 0, Π)

γp2/π

(Em −

|

| ≤

α0αT

0 )P −1/2

0

sup
π |

|

δ(Π)

| →

0,

γ

0.

→
(2.16)

Соотношение (2.16) означает асимптотическую качественную робастность теста
(2.15). Такая робастность означает, что HΦ для малых γ можно проверять примерно

с асимптотическим уровнем α, и тест будет иметь примерно такую же асимптотиче-
скую мощность при H1n(ρ) c ρ > 0, как в схеме без засорений. И все это независимо
от распределения засорений Π.

9

Список литературы

[1] Anderson T.V. The Statistical Analysis of time series. Wiley and Sons, Inc., New

York, 1971.

[2] Boldin M.V., Petriev M.N. On the Empirical Distribution Function of Residuals in

Autoregression with Outliers and Pearson’s Chi-Square type Tests. Math. Methods

Statist., 2018, v. 27, No. 4, p. 1–17.

[3] Boldin M.V. On Symmetrized Pearson’s Type Test in Autoregression with Outliers:

Robust Testing of Normality. http://arxiv.org/abs/2003.07878.

[4] Boldin M.V. On the Power of Symmetrized Pearson’s Type Test under Local

Alternatives in Autoregression with Outliers. http://arxiv.org/abs/2003.13072.

[5] Болдин М.В. О проверке нормальности авторегрессии с засорениями критерием

Пирсона. Теория вероятн. и ее применения, 2020, т. 65, No 1, с. 126–137.

[6] Brockwell P.J. and Daviis R.A. Time Series: Theory and Methods. Springer-Verlag,

1987.

[7] Koul H. L. Weighted Empiricals and Linear Models. MSU, Hayward, California, 1992.

[8] Martin B.D. and Yohai V.J. Inﬂuence functionals for Time Series. The Ann. of

Statist., 1986, v. 14, p. 781 –818.

10

