2
2
0
2

l
u
J

5

]

O
C
.
h
p
-
o
r
t
s
a
[

2
v
6
7
0
0
1
.
1
0
2
2
:
v
i
X
r
a

MNRAS 000, 1â€“24 (2021)

Preprint 6 July 2022

Compiled using MNRAS LATEX style ï¬le v3.0

relensing: Reconstructing the mass proï¬le of galaxy clusters from
gravitational lensing

Daniel A. Torres-Ballesteros,1â˜… and Leonardo CastaÃ±eda1â€ 
1Observatorio AstronÃ³mico Nacional, Universidad Nacional de Colombia, Carrera 30 Calle 45-03, P.A. 111321 BogotÃ¡, Colombia

Accepted XXX. Received YYY; in original form ZZZ

ABSTRACT
In this work we present relensing, a package written in python whose goal is to model galaxy clusters from gravitational
lensing. With relensing we extend the amount of software available, which provides the scientiï¬c community with a wide
range of models that help to compare and therefore validate the physical results that rely on them. We implement a free-form
approach which computes the gravitational deï¬‚ection potential on an adaptive irregular grid, from which one can characterize
the cluster and its properties as a gravitational lens. Here, we use two alternative penalty functions to constrain strong lensing.
We apply relensing to two toy models, in order to explore under which conditions one can get a better performance in the
reconstruction. We ï¬nd that by applying a smoothing to the deï¬‚ection potential, we are able to increase the capability of this
approach to recover the shape and size of the mass proï¬le of galaxy clusters, as well as its magniï¬cation map. This translates
into a better estimation of the critical and caustic curves. The power that the smoothing provides is also tested on the simulated
clusters Ares and Hera, for which we get an rms on the lens plane of âˆ¼ 0.17 ğ‘ğ‘Ÿğ‘ğ‘ ğ‘’ğ‘ and âˆ¼ 0.16 ğ‘ğ‘Ÿğ‘ğ‘ ğ‘’ğ‘, respectively. Our results
represent an improvement with respect to reconstructions that were carried out with methods of the same nature as relensing.
At the same time, the smoothing also increases the stability of our implementation, and decreases the computation time. In its
current state, relensing is available upon request.

Key words: gravitational lensing â€“ galaxy cluster â€“ cosmology

1 INTRODUCTION

Gravitational lensing has proven to be a powerful tool for under-
standing the universe at diï¬€erent scales (e.g. Blandford & Narayan
(1992); Schneider et al. (2006)), where its power relies upon its sim-
plicity, since it only depends on the mass distribution that acts as lens,
irrespective of its nature (baryonic or not) or its dynamical state.

It is of particular interest its application to the study of galaxy
clusters and their mass distribution. As the most massive objects in
the universe, galaxy clusters provide a framework for cosmological
probes, such as testing the underlying gravitational theory (e.g. Lam
et al. (2012); Pizzuti et al. (2016); Cataneo & Rapetti (2018)) and
cosmological model (e.g. Gilmore & Natarajan (2009); Dâ€™Aloisio &
Natarajan (2011); Jullo et al. (2010)), and also provide strong con-
strains to the paradigm of structure formation and evolution (e.g see
Allen et al. (2011); Kravtsov & Borgani (2012) for reviews). In addi-
tion, galaxy clusters also act as eï¬€ective cosmic telescopes, since their
angular size and mass turn them into the biggest and strongest man-
ifestation of gravitational lensing in the universe. Therefore, galaxy
clusters are capable of magnifying faint background sources that
would otherwise remain unseen, or for which it would be diï¬ƒcult
to infer any signiï¬cant information. This is for example the case
for galaxies with high redshift (the ï¬rst galaxies ever formed in the
universe) (e.g. Kneib et al. (2004); BradaÄ et al. (2009); Coe et al.

â˜… E-mail:daatorresba@unal.edu.co
â€  E-mail: lcastanedac@unal.edu.co

Â© 2021 The Authors

(2013); Richard et al. (2014); Oesch et al. (2015); McLeod et al.
(2016); Furtak et al. (2021)). For a deeper description of the role that
gravitation lensing plays in the context of galaxy clusters refer to e.g.
Kneib & Natarajan (2011); Hoekstra et al. (2013); Umetsu (2020)
and the references therein.

The problem of making an estimation of the mass proï¬le of a
galaxy cluster from gravitational lensing has been approached from
diï¬€erent perspectives over the years. As a result, several methods
have been developed. In general terms, they are usually classiï¬ed as
parametric or free-form (sometimes also labeled as non-parametric)
methods. Parametric methods are characterized by employing an
input model that depends on a set of parameters which needs to
reproduce the input data as well as possible. This can be done for
example, by means of Bayesian methods such as MCMC or Nested
Sampling. The input model can be for example, the mass distribution
composed of a superposition of baryonic and dark matter components
for the diï¬€erent cluster members, and which are chosen taking into
account certain physical and geometrical properties that are expected
to satisfy the properties shown by the galaxy cluster. On the other
hand, free-form methods generally work on a grid on which some
quantity of interest is deï¬ned, for example the convergence or the
deï¬‚ection potential, and they need to be found. Therefore, free-form
methods are parametric on the inside, since there is a set of parameters
that need to be found in order to achieve the reconstruction, but they
are diï¬€erent to pure parametric methods in the sense that does not
exist an imposed input model that constrains the reconstruction.

Among parametric approaches we can ï¬nd e.g. LENSTOOL Kneib

 
 
 
 
 
 
2

D. A. Torres-Ballesteros and L. CastaÃ±eda

et al. (1996); Jullo et al. (2007); Newman et al. (2013); SchÃ¤fer
et al. (2020), Light-Traces-Mass (LTM) Broadhurst et al. (2005), and
glafic Oguri (2010), Meanwhile, for free-form approaches we have
e.g. Bartelmann et al. (1996), Abdelsalam et al. (1998), Saha &
Williams (1997), Seitz et al. (1998), Cacciato et al. (2006), Jee et al.
(2007), Deb et al. (2008), GRALE Liesenborgs et al. (2006, 2007,
2009, 2020); Ghosh et al. (2020), WSLAP Diego et al. (2005, 2007),
SWUnited BradaÄ et al. (2005a,b, 2009), LensPerfect Coe et al.
(2008), and SaWLens(2) Merten et al. (2009, 2011); Merten (2016);
Huber et al. (2019). There are also available hybrid methods that
combine elements of both approaches e.g. Jullo & Kneib (2009);
Niemiec et al. (2020) (which are part of LENSTOOL), and WSLAP+
Sendra et al. (2014); Diego et al. (2016) (an extension of WSLAP).

Nowadays, the relevant observations in this regard are open access,
as it is the case for Hubble Frontier Fields (HFF) Lotz et al. (2017),
Reionization Lensing Cluster Survey (RELICS) Coe et al. (2019),
Cluster Lensing and Supernova Survey with Hubble (CLASH) Post-
man et al. (2012). Additionally, there is an expected increase in both
quality and quantity of observations from upcoming ground/space
based observatories such as James Webb Space Telescope (JWST)
Gardner et al. (2006), Euclid LaureÄ³s (2009); LaureÄ³s et al. (2011),
and Vera C. Rubin Observatory (LSST) IveziÄ‡ et al. (2019). There-
fore, it is pertinent to have access to a variety of open access software
that aims to model galaxy clusters from gravitational lensing, in order
to be able to compare, and validate those models, as well as the phys-
ical results that rely on them (e.g Priewe et al. (2017); Meneghetti
et al. (2017); Strait et al. (2018); Remolina GonzÃ¡lez et al. (2018)).
Therefore, in this work we describe what is behind relensing,
an easy-to-use package currently written in python, in which a free-
form reconstruction method is implemented. The method that we
discuss here is based upon the work previously presented by BradaÄ
et al. (2005a, 2009), which itself is an extension of Bartelmann et al.
(1996).

We explore the eï¬€ectiveness of an alternative ï¬nite diï¬€erence
approach. Also, we extend the grid reï¬nement to an adaptive irregular
one, that is intended to follow the observational data from strong
lensing as well as the shape of the main deï¬‚ectors. Additionally,
we discuss two diï¬€erent approaches to the strong lensing penalty
function, which along with the introduction of a smoothing process
enhance the performance of this approach, reducing the computation
time and providing a more accurate reconstruction.

This paper is organized as follows. In Sec. 2 we discuss the rel-
evant aspects of gravitational lensing theory, and also introduce the
notation used throughout the paper. Then, in Sec. 3 we describe the
reconstruction method in detail. Once the reconstruction framework
is settled, in Sec. 4 we apply the reconstruction to two simple distri-
butions, in order to explore how relensing behaves and how to get
the best out of it. In Sec. 5 we apply the reconstruction to Ares and
Hera (see Meneghetti et al. (2017)), which provide a way of testing
the performance of relensing in a more realistic scenario. Finally,
in Sec. 6 we present the conclusions of this work.

For the mock catalogues discussed in Sec. 4.1, and the recon-
structions presented in this work, we consider a ï¬‚at Î›CDM cos-
mology with density parameter Î©ğ‘š,0 = 0.3 and Hubble constant
ğ»0 = 70 ğ‘˜ğ‘š ğ‘ âˆ’1 ğ‘€ ğ‘ğ‘âˆ’1.

2 GRAVITATIONAL LENSING NOTATION

In this work we focus on the gravitational lensing eï¬€ect under the thin
lens approximation. A presentation of this topic deeper than the one

MNRAS 000, 1â€“24 (2021)

intended here, can be found, for example in Schneider et al. (1992,
2006).

In this context, the galaxy cluster with redshift ğ‘§ğ‘™ takes the place
of the lens, and it is characterized by the projected mass density Î£ =
Î£(ğœ½), with ğœ½ being an angular position from the observer perspective.
Then, the aim is to recover Î£ somehow. For this task, we need to
compare observations to theory. Therefore, as observables we will
make use of multiply imaged systems (strong regime) (e.g. Hattori
et al. (1999); Schneider et al. (2006)), since galaxy clusters are rich
in those systems, and we will also consider the ellipticity of weakly
distorted and singly imaged background sources (weak regime) (e.g.
Bartelmann & Schneider (2001); Schneider et al. (2006); Hoekstra
(2013); Mandelbaum (2018); Umetsu (2020)).

The aforementioned observables can be characterized by means
of the convergence ğœ… = ğœ…(ğ‘§, ğœ½), the shear ğ›¾ = ğ›¾(ğ‘§, ğœ½), and also the
reduced (or scaled) deï¬‚ection angle ğœ¶ = ğœ¶(ğ‘§, ğœ½) (hereafter we will
refer to it as deï¬‚ection angle for simplicity), which are deï¬ned in
terms of potential ğœ“ = ğœ“(ğ‘§, ğœ½). Here ğœ… is a direct estimator of the
mass proï¬le, since it is deï¬ned as

ğœ… :=

Î£
Î£ğ‘ğ‘Ÿ

=

1
2

âˆ‡2ğœ“ with Î£ğ‘ğ‘Ÿ :=

ğ‘2ğ· (ğ‘§)
4ğœ‹ğº ğ· (ğ‘§ğ‘™)ğ· (ğ‘§ğ‘™, ğ‘§)

,

(1)

where Î£ğ‘ğ‘Ÿ = Î£ğ‘ğ‘Ÿ (ğ‘§, ğ‘§ğ‘™) is known as critic mass density, and it is
deï¬ned in terms of the angular diameter distances from the observer
to the lens ğ· (ğ‘§ğ‘™), from the observer to source ğ· (ğ‘§) of interest, and
ï¬nally from the lens to such source ğ· (ğ‘§ğ‘™, ğ‘§). Thus, we refer to ğœ… as
the mass proï¬le. Similarly, ğ›¾ is a dimensionless complex quantity
whose components are
(cid:32) ğœ•2ğœ“
(cid:33)
ğœ•ğœƒ2
1

ğœ•2ğœ“
ğœ•ğœƒ1ğœ•ğœƒ2

and ğ›¾2 :=

ğ›¾1 :=

ğœ•2ğœ“

1
2

(2)

âˆ’

,

ğœ•ğœƒ2
2
with ğ›¾ := ğ›¾1 + ğ‘–ğ›¾2. In addition, ğœ¶ reads
ğœ¶ := âˆ‡ğœ“.

(3)

From (1) it is clear that once ğœ“ is known, the mass proï¬le is
recovered. Now, since ğœ“ depends on ğ‘§ it is convenient to deï¬ne a
reference redshift ğ‘§ğ‘Ÿ > ğ‘§ğ‘™, so that given ğœ“ğ‘Ÿ one can write ğœ“, ğœ…. ğ›¾ and
ğœ¶ in terms of ğœ“ğ‘Ÿ as well as in terms of ğœ…ğ‘Ÿ , ğ›¾ğ‘Ÿ and ğœ¶ğ‘Ÿ , respectively. This
transition is done by using the cosmological weight ğ‘ = ğ‘ (ğ‘§, ğ‘§ğ‘Ÿ , ğ‘§ğ‘™)
deï¬ned as

ğ· (ğ‘§ğ‘™, ğ‘§)ğ· (ğ‘§ğ‘Ÿ )
ğ· (ğ‘§)ğ· (ğ‘§ğ‘™, ğ‘§ğ‘Ÿ )

ğ‘ˆ (ğ‘§),

ğ‘ :=

with

ğ‘ˆ (ğ‘§) =

(cid:40)

1
0

if
if

ğ‘§ > ğ‘§ğ‘™
ğ‘§ â‰¤ ğ‘§ğ‘™

,

(4)

(5)

from which one gets ğœ“ = ğ‘ğœ“ğ‘Ÿ , ğœ… = ğ‘ ğœ…ğ‘Ÿ , ğ›¾ = ğ‘ğ›¾ğ‘Ÿ and ğœ¶ = ğ‘ğœ¶ğ‘Ÿ . In
this way, we only need to deal with ğœ“ğ‘Ÿ , which simpliï¬es the problem
signiï¬cantly.

With respect to the observables, in the strong regime the multiply
imaged systems can in principle be characterized by solving the lens
equation

ğœ· = ğœ½ âˆ’ ğ‘ğœ¶ğ‘Ÿ ,

(6)

which relates the true angular position ğœ· to the observed angular
position ğœ½. Alternatively, it is simpler to work on the source plane,
taking into account that the multiple images of a given system have
to converge to a unique source.

On the other hand, with respect to the weak regime, distortions
(shape, size and orientation) at this level are characterized by means
of source ellipticity. Among the diï¬€erent deï¬nitions of ellipticity

relensing: Reconstructing the mass proï¬le of galaxy clusters from gravitational lensing

3

ğœ“ is by using ï¬nite diï¬€erences. In this context, the advantage of ï¬nite
diï¬€erences over other methods lies in its capability to express the
derivatives (of any order) of ğœ“ as a linear combination of ğœ“ ğ‘— (deï¬ned
on the grid), and it also makes the linearization of (11) simple. In
this direction, ğœ…, ğ›¾, ğœ¶, and ğœ“ itself, evaluated at an arbitrary angular
position ğœ½ğ’Š (it does not need to correspond to a node) can be written
in terms of every ğœ“ ğ‘— as

(e.g. Schneider et al. (2006)), the more suited for the task in hand
is the complex ellipticity ğœ– = ğœ– (ğ‘§, ğœ½), which is related to the source
intrinsic or true ellipticity ğœ–ğ‘  by means of the expression

ğœ– =

ğœ–ğ‘  + ğ‘”
1 + ğ‘”âˆ—ğœ–ğ‘ 

1 + ğ‘”ğœ– âˆ—
ğ‘ 
ğœ– âˆ—
ğ‘  + ğ‘”âˆ—

ï£±ï£´ï£´ï£´ï£´ï£´ï£²
ï£´ï£´ï£´ï£´ï£´

ï£³

if

if

|ğ‘”| â‰¤ 1

|ğ‘”| > 1

,

(7)

where the asterisk stands for complex conjugate, and the reduced
shear ğ‘” = ğ‘”(ğ‘§) is deï¬ned as

ğ‘” =

ğ‘ğ›¾ğ‘Ÿ
1 âˆ’ ğ‘ ğœ…ğ‘Ÿ

.

(8)

ğœ…ğ‘– =

Here ğœ–ğ‘  is not an observable, therefore (7) cannot be used directly.
This problem is avoided by considering the average intrinsic elliptic-
ity for several (as many as possible) sources in a local neighborhood
to be (cid:104)ğœ–ğ‘ (cid:105) = 0. As a result, for a given redshift the average observed
ellipticity reads

ğœ“ğ‘– =

ğ‘
âˆ‘ï¸

ğ‘—=1

ğ‘
âˆ‘ï¸

ğ‘—=1

Pğ‘– ğ‘— ğœ“ ğ‘— ,

Kğ‘– ğ‘— ğœ“ ğ‘— ,

ğ›¾ğ‘›,ğ‘– =

ğ‘
âˆ‘ï¸

ğ‘—=1

ğ‘
âˆ‘ï¸

ğ‘—=1

Gğ‘›,ğ‘– ğ‘— ğœ“ ğ‘— ,

Dğ‘›,ğ‘– ğ‘— ğœ“ ğ‘— ,

(9)

ğ›¼ğ‘›,ğ‘– =

(12)

(13)

(14)

(15)

(cid:104)ğœ–(cid:105) =

ğ‘”

1
ğ‘”âˆ—

ï£±ï£´ï£´ï£´ï£´ï£²
ï£´ï£´ï£´ï£´
ï£³

if

if

|ğ‘”| â‰¤ 1

|ğ‘”| > 1

,

yielding a direct estimation of the local reduced shear, which allows
us to directly contrast observations to theory at weak regime. Further
details can be found in Schneider & Seitz (1995); Seitz & Schneider
(1997).

3 RECONSTRUCTION METHOD

The aim of those methods derived from Bartelmann et al. (1996) and
its extensions is to constrain the deï¬‚ection potential ğœ“ in a given grid
by making use of gravitational lensing observations. No assumption
about mass traces light is made.

Consider (in general) an irregular grid deï¬ned on the lens plane,
which is composed of ğ‘ nodes whose angular position is ğœ½ ğ‘— (with
ğ‘— = 1, 2, . . . , ğ‘). On each node a deï¬‚ection potential ğœ“ ğ‘— is assigned,
and such potentials are constrained from the observables described
in Sec. 2. To do so, we implement the penalty function
ğœ’2 (ğœ“ ğ‘— ) := ğœ’2

ğ‘¤ (ğœ“ ğ‘— ) + ğœ’2

ğ‘  (ğœ“ ğ‘— ) + ğœ’2

ğœ… (ğ‘…) (ğœ“ ğ‘— ) + ğœ’2

ğ›¾ (ğ‘…) (ğœ“ ğ‘— ),

(10)

ğ‘  constrains the strong regime, ğœ’2
ğœ… (ğ‘…) and ğœ’2

where ğœ’2
ğ‘¤ constrains the weak
regime, and both ğœ’2
ğ›¾ (ğ‘…) are regularization terms. Here,
(10) needs to be explicitly written in terms of the ğ‘ deï¬‚ection po-
tentials, since they are the parameters to be found. This task can
be achieved by minimizing (10) with respect to every ğœ“ğ‘˜ (with
ğ‘˜ = 1, 2, . . . , ğ‘), which leads to ğ‘ equations of the form

ğœ• ğœ’2

ğœ• ğœ’2

+

+

+

= 0,

ğœ• ğœ’2
ğ‘ 
ğœ•ğœ“ğ‘˜

ğœ… (ğ‘…)
ğœ•ğœ“ğ‘˜

ğ›¾ (ğ‘…)
ğœ•ğœ“ğ‘˜

ğœ• ğœ’2
ğ‘¤
ğœ•ğœ“ğ‘˜
each of them with ğ‘ unknowns. The system of equations is in general
nonlinear, making it diï¬ƒcult to solve. Linearizing (if possible) such
system simpliï¬es the implementation and reduces the computation
time, which is an advantage in practical terms, considering that reli-
able results are obtained. In Sec. 3.3 we explain how to perform such
linearization.

(11)

Now, from Sec. 2 it is clear that the observables we are interested
in can be characterized by ğœ…, ğ›¾, and ğœ¶, which are deï¬ned in terms of
either ï¬rst or second order derivatives of ğœ“. Since we are working on a
grid, the most direct way to explicitly write these quantities in terms of

with ğ‘› = 1, 2 representing the components of ğ›¾ and ğœ¶, respectively.
The coeï¬ƒcients (or nodes weight) Pğ‘– ğ‘— , Kğ‘– ğ‘— , Gğ‘›,ğ‘– ğ‘— and Dğ‘›,ğ‘– ğ‘— depend
on what form the grid has, i.e. if it is regular (e.g. BradaÄ et al.
(2005a); Deb et al. (2008); Merten et al. (2009)) or irregular (e.g.
BradaÄ et al. (2009); Merten (2016)), and also on how ï¬nite diï¬€er-
ences and the interpolation are carried out. In Sec. 3.1 we describe
how we obtain such weights. Since ğœ½ğ‘– is arbitrary (within the region
of interest), equations (12) - (15) also work to interpolate.

Once the diï¬€erent penalty functions in (10) are explicitly written
in terms of ğœ“ ğ‘— , we have that their contribution to (11) after the
corresponding linearization yields an expression of the form

ğœ• ğœ’2
ğ‘
ğœ•ğœ“ğ‘˜

= 2

ğ‘
âˆ‘ï¸

ğ‘—=1

W ( ğ‘)
ğ‘˜ ğ‘—

ğœ“ ğ‘— âˆ’ 2V ( ğ‘)

ğ‘˜

,

(16)

where ğ‘ = ğ‘  stands for strong regime, ğ‘ = ğ‘¤ for weak regime, and
ğ‘ = ğœ… and ğ‘ = ğ›¾ stand for both regularization terms. In Sec. 3.3 we
and V ( ğ‘)
describe how W ( ğ‘)
are deï¬ned in each case. From (16)
ğ‘˜
ğ‘˜ ğ‘—
it is clear that (11) reduces to

ğ‘
âˆ‘ï¸

Wğ‘˜ ğ‘— ğœ“ ğ‘— = Vğ‘˜ ,

(17)

ğ‘—=1
where Wğ‘˜ ğ‘— = W (ğ‘¤)
+ V (ğ›¾)
V (ğ‘ )
+ V (ğœ…)
ğ‘˜
ğ‘˜
ğ‘˜
node weight for the ğ‘˜-th linear equation.

ğ‘˜ ğ‘— + W (ğ‘ )

ğ‘˜ ğ‘— + W (ğœ…)

ğ‘˜ ğ‘— + W (ğ›¾)

ğ‘˜ ğ‘— and Vğ‘˜ = V (ğ‘¤)

ğ‘˜

+

. Here the coeï¬ƒcient Wğ‘˜ ğ‘— represent the ğ‘—-th

The deï¬‚ection potential admits two transformations that introduce
degrees of freedom in the reconstruction, which may aï¬€ect diï¬€erent
aspects of the results. On one hand, transformation
ğœ“ â†’ ğœ“(cid:48) = ğœ“ + ğœ“0 + ğ’„ Â· ğœ½
introduces three degrees of freedom, one through the constant term
ğœ“0, and two from the bidimensional constant vector ğ’„. On the other
hand, transformation
ğœ“ â†’ ğœ“(cid:48) = (1 âˆ’ ğœ†)|ğœ½ |2/2 + ğœ†ğœ“,

(19)

(18)

responsible for the well known Mass Sheet Degeneracy (MSD for
short), introduces an extra degree of freedom through the constant
term ğœ†. Following BradaÄ et al. (2005a), we have that such degrees

MNRAS 000, 1â€“24 (2021)

4

D. A. Torres-Ballesteros and L. CastaÃ±eda

of freedom can be ï¬xed by keeping the deï¬‚ection potential ï¬xed on
one node for each degree of freedom. Since we have four degrees of
freedom, we will hold ğœ“ ğ‘— = 0 ï¬xed on each of the four corners of the
grid if both transformations are relevant, or only on three of the four
corners of the grid if the MSD in not considered to be a concern.
This leaves us respectively with a (ğ‘ âˆ’ 4) Ã— (ğ‘ âˆ’ 4) system of linear
equations to be solved.

Observations of galaxy clusters have shown the existence of several
systems of multiple images, and for many of them the redshift is
known; at least up to some extent. When such redshifts are suï¬ƒciently
diverse, in principle the MSD breaks. Under these conditions the
MSD is not a concern, so that we are left only with three degrees of
freedom from (18). Thus, in this case we are left with a (ğ‘ âˆ’ 3) Ã—
(ğ‘ âˆ’ 3) system of linear equations. In this work this condition is met.
Hence, as well as in BradaÄ et al. (2005a), we will not consider the
MSD to be a problem, which is supported by the results that we get.
Now, before we describe which ï¬nite diï¬€erence approach that we
use, let us continue describing, in general, how the reconstruction
method works. At this point, one might think that solving (17) is just
enough for getting the reconstruction done. Unfortunately, this leads
to a low resolution and under reconstructed proï¬le. In this regard,
BradaÄ et al. (2005a) found that two levels of iterations solve the
problem. Therefore, keeping their notation, we will refer to them as
the inner and outer levels. The inner level is in charge of computing
the deï¬‚ection potential iteratively, while the outer level is responsible
for producing the grid reï¬nement that produce a ï¬ner and adapted
grid on which a new estimation of ğœ“ takes place.

In general terms, a description of how this method works is pre-

sented in Algorithm 1.

Algorithm 1 Reconstruction
1: Input: Initial conditions and the initial guess ğœ“ (0) .
and ğ›¾ (0)
2: Compute ğœ… (0) , ğ›¾ (0)
2
1
3: while outer_end = False do
4:
5:
6:

Compute the nodes weight.
while inner_end = False do

from ğœ“ (0) .

it âˆ’â†’ ğœ“ (ğ‘›) .

Compute the system of linear equations needed and solve

Smoothing of ğœ“ (ğ‘›) âˆ’â†’ New ğœ“ (ğ‘›) (optional).
Compute ğœ… (ğ‘›) from ğœ“ (ğ‘›) .
if (cid:12)

(cid:12)
(cid:12) â‰¤ tolerance then

(cid:12)ğœ… (ğ‘›)
ğ‘— âˆ’ ğœ… (ğ‘›âˆ’1)
inner_end = True.

ğ‘—

7:
8:

9:

10:

11:
12:

13:

14:
15:

Compute ğœ’2
ğ‘  .
if ğœ’2
ğ‘  â‰¤ ğ‘(2ğ‘img) then
outer_end = True.
if outer_end = False then
Apply grid reï¬nement.
Compute ğœ“ (ğ‘š) , ğœ… (ğ‘š) , ğ›¾ (ğ‘š)

16:
17: return ğœ“

and ğ›¾ (ğ‘š)
2

on the new grid.

1

This algorithm has as input (line 1) a set of parameters that are
used along the reconstruction. Among them, we have the grid initial
and reï¬nement conditions (more details in Sec. 3.2), regularization
weights ğœ‚ğœ… and ğœ‚ğ›¾ (more details in Sec. 3.3.3), whether constrains
from both strong and weak regimes are used or only from the strong
regime, and the type of ğœ’2
ğ‘  that is going to be used (more details in Sec.
3.3.1). Last but not least, as input we have the initial guess ğœ“ (0) for
and ğ›¾ (0)
the deï¬‚ection potential, from which we compute ğœ… (0) , ğ›¾ (0)
2
1

MNRAS 000, 1â€“24 (2021)

(line 2 ). These quantities are needed to initialize the reconstruction
(more details in Sec. 3.3).

Once we have set the initial conditions, the outer level starts (line
3). At the beginning of each outer iteration we compute the node
weights for every node and data point (line 4). Such weights come
from the ï¬nite diï¬€erence scheme and the interpolation (when re-
quired), and have to be computed once for each outer iteration. With
these weights in hand, the inner level starts (line 5).

The inner level is in charge of computing the system of linear
equations (17) and its solution, so that we get ğœ“ (ğ‘›) ; a new version of
the deï¬‚ection potential. Here, ğ‘› represents the current inner iteration
(line 6). The reconstruction might be quite noisy, (as we show in
Sec. 4.3), nonetheless, the results in the overall reconstruction can
be improved by introducing a smoothing on ğœ“ (ğ‘›) . Such smoothing
is the result of recomputing ğœ“ (ğ‘›) with equation (12), where for this
case ğœ“ğ‘– represents the smoothed potential at the ğ‘–-th node, while ğœ“ ğ‘—
comes from the solution of (17). This step is optional but advised, as
we justify in Sec. 4.3 (line 7).

Then, from ğœ“ (ğ‘›) (smoothed or not) we compute the convergence
ğœ… (ğ‘›) on the grid (line 8) by using ï¬nite diï¬€erences, such that, when
the condition
ğ‘— âˆ’ ğœ… (ğ‘›âˆ’1)
ğœ… (ğ‘›)

â‰¤ tolerance

(20)

ğ‘—

(cid:12)
(cid:12)
(cid:12)

(cid:12)
(cid:12)
(cid:12)

is satisï¬ed for every node ( ğ‘— = 1, . . . , ğ‘), (line 9), the inner level
ï¬nishes its task (line 10). In (20) ğœ… (ğ‘›âˆ’1) represents the convergence
from the previous inner iteration.

When the inner level ï¬nishes, we compute either the type 1 or
type 2 penalty function ğœ’2
ğ‘  depending on the initial conditions (line
11). We have seen that optimal results are obtained when the recon-
struction reaches ğœ’2
ğ‘  âˆ¼ 2ğ‘img, with Nimg being the total number of
multiple images being used. This condition is intended to avoid an
overï¬t, without compromising the quality of the reconstruction. With
that in mind, we consider that once the condition ğœ’2
ğ‘  â‰¤ ğ‘(2ğ‘img)
(for ğ‘ > 1) is satisï¬ed (line 12), the outer level as well as the recon-
struction ï¬nish (line 13). Here we have taken ğ‘ = 1.4, for which the
reconstruction tends to satisfy (ğ‘ âˆ’ 1)(2ğ‘img) â‰¤ ğœ’2

ğ‘  â‰¤ ğ‘(2ğ‘img).

If condition ğœ’2

ğ‘  â‰¤ ğ‘(2ğ‘img) is not met, a new outer iteration is
required (line 14). Thus, the grid reï¬nement is performed (line 15)
(more details in Sec. 3.2). Then, from the deï¬‚ection potential result
of the last inner iteration for the current outer iteration, we compute
ğœ“ (ğ‘š) , ğœ… (ğ‘š) , ğ›¾ (ğ‘š)
on this new grid (line 16) (more details in
Sec. 3.1). They are required to initialize the next outer iteration (more
details in Sec. 3.3), taking the place of ğœ“ (ğ‘šâˆ’1) , ğœ… (ğ‘šâˆ’1) , ğ›¾ (ğ‘šâˆ’1)
and
ğ›¾ (ğ‘šâˆ’1)
and ğ›¾ (0)
2
2
iteration. Here, ğ‘š stands for the current outer iteration.

, or ğœ“ (0) , ğœ… (0) , ğ›¾ (0)
1

if we are running the ï¬rst outer

and ğ›¾ (ğ‘š)
2

1

1

Finally, if no further outer iterations are required, as return we have
the ï¬nal deï¬‚ection potential, which corresponds to the last ğœ“ (ğ‘›) that
we know (line 17).

Due to the nature of the method, negative densities may appear.
This happens mainly for blind reconstruction (i.e. ğœ“ (0)
ğ‘— = 0 at every
node), as well as in situations with little observational constraints.
The negative values tend to appear towards the outskirts of the dis-
tribution. The presence of negative densities is also heavily related
to the initial conditions. For instance, small values of ğœ‚ğœ… and ğœ‚ğ›¾ pro-
duce an overï¬t of the intrinsic noise in the reconstruction. Likewise,
a too dense initial grid restrains the capability of the method to adapt
to the data. One way to solve this problem (when it occurs), is to
use as an initial guess a distribution other than the blind one, which,
along with the smoothing reduce the noise in the reconstruction,
particularly towards the outskirts.

relensing: Reconstructing the mass proï¬le of galaxy clusters from gravitational lensing

5

3.1 Finite diï¬€erence approach

In this regard, we follow the generalized ï¬nite diï¬€erence approach
(GFD) (e.g. Benito et al. (2001); Gavete et al. (2003); Benito et al.
(2003)), with the diï¬€erence that we use it not only for ï¬nding the
derivatives on a grid from the deï¬‚ection potential deï¬ned on such a
grid, but also for interpolating the deï¬‚ection potential and its deriva-
tives at a given angular position ğœ½0, in case it is not part of the
grid.

Let us consider the ğ‘„ nearest nodes (NN) (nearest neighbors) to
ğœ½0, as it is depicted in Fig. 1. On each of such NN we apply the Taylor
series expansion to is corresponding deï¬‚ection potential around ğœ½0
up to second order derivatives. Therefore, for the ğ‘–-th NN we get

â„2
ğ‘–
2

ğ‘˜2
ğ‘–
2

+

+

+ğ‘˜ğ‘–

+â„ğ‘– ğ‘˜ğ‘–

, (21)

ğœ•ğœ“0
ğœ•ğœƒ2

ğœ•ğœ“0
ğœ•ğœƒ1

ğœ“ğ‘– = ğœ“0+â„ğ‘–

ğœ•2ğœ“0
ğœ•ğœƒ2
1

ğœ•2ğœ“0
ğœ•ğœƒ1ğœ•ğœƒ2

ğœ•2ğœ“0
ğœ•ğœƒ2
1
with â„ğ‘– = ğœƒğ‘–,1 âˆ’ ğœƒ0,1, and ğ‘˜ğ‘– = ğœƒğ‘–,2 âˆ’ ğœƒ0,2. In case for example ï¬‚exion
is being considered in the reconstruction, higher order derivatives
have to be taken in the expansion (21). Here ğ‘‹1 = ğœ“0, ğ‘‹2 = ğœ•ğœ“0/ğœ•ğœƒ1,
1, ğ‘‹5 = ğœ•2ğœ“0/ğœ•ğœƒ1ğœ•ğœƒ2, and ğ‘‹6 =
ğ‘‹3 = ğœ•ğœ“0/ğœ•ğœƒ2, ğ‘‹4 = ğœ•2ğœ“0/ğœ•ğœƒ2
ğœ•2ğœ“0/ğœ•ğœƒ2
2 are the unknowns, which, following GFD, can be obtained
by minimizing the penalty function

Figure 1. In this ï¬gure the black dots represent the NN to ğœ½0, where the given
dashed circle is centered at ğœ½0. The gray dots correspond to nodes that are
not being considered in the ï¬nite diï¬€erence scheme.

where the weight of the ğ‘–-th NN for the ğ‘—-th unknown is given by

ğœ’2
ğºğ¹ ğ· =

ğ‘„
âˆ‘ï¸

(cid:16)

ğ‘–=1

Î¨ğ‘–ğ‘Šğ‘–

(cid:17)2

,

with ğ‘Šğ‘– = ğ‘Š (â„ğ‘–, ğ‘˜ğ‘–) being a weighting function, and

Î¨ğ‘– = âˆ’ğœ“ğ‘– + ğ‘‹1 + â„ğ‘– ğ‘‹2 + ğ‘˜ğ‘– ğ‘‹3 +

â„2
ğ‘–
2
Therefore, when minimizing (22) with respect to the ğ‘—-th unknown

ğ‘‹4 + â„ğ‘– ğ‘˜ğ‘– ğ‘‹5 +

ğ‘˜2
ğ‘–
2

ğ‘‹6.

(23)

we get

ğœ• ğœ’2

ğºğ¹ ğ·
ğœ• ğ‘‹ ğ‘—

= 2

ğ‘„
âˆ‘ï¸

ğ‘–=1

Î¨ğ‘–ğ‘Š 2
ğ‘–

ğœ•Î¨ğ‘–
ğœ• ğ‘‹ ğ‘—

= 0,

(24)

which leads to a system of linear equations of the form ğ´ğ‘¿ = ğ’ƒ, with

ğ´ =

ğ‘„
âˆ‘ï¸

ğ‘–=1

ğ‘Š 2
ğ‘–

ğ‘˜ğ‘–

â„ğ‘– ğ‘˜ğ‘–

ğ‘˜2
ğ‘–

1

â„ğ‘–

â„2
ğ‘–

SYM

(cid:169)
(cid:173)
(cid:173)
(cid:173)
(cid:173)
(cid:173)
(cid:173)
(cid:173)
(cid:173)
(cid:173)
(cid:173)
(cid:173)
(cid:173)
(cid:173)
(cid:173)
(cid:173)
(cid:173)
(cid:173)
(cid:173)
(cid:173)
(cid:173)
(cid:173)
(cid:173)
(cid:171)

â„2
ğ‘–
2
â„3
ğ‘–
2
â„2
ğ‘– ğ‘˜ğ‘–
2
â„4
ğ‘–
4

â„ğ‘– ğ‘˜ğ‘–

â„2
ğ‘– ğ‘˜ğ‘–

â„ğ‘– ğ‘˜2
ğ‘–
â„3
ğ‘– ğ‘˜ğ‘–
2

â„2
ğ‘– ğ‘˜2
ğ‘–

ğ‘˜2
ğ‘–
2
â„ğ‘– ğ‘˜2
ğ‘–
2
ğ‘˜3
ğ‘–
2
ğ‘– ğ‘˜2
â„2
ğ‘–
4
â„ğ‘– ğ‘˜3
ğ‘–
2
ğ‘˜4
ğ‘–
4

(cid:170)
(cid:174)
(cid:174)
(cid:174)
(cid:174)
(cid:174)
(cid:174)
(cid:174)
(cid:174)
(cid:174)
(cid:174)
(cid:174)
(cid:174)
(cid:174)
(cid:174)
(cid:174)
(cid:174)
(cid:174)
(cid:174)
(cid:174)
(cid:174)
(cid:174)
(cid:174)
(cid:172)

and

ğ‘‡ =

ğ’ƒ

ğ‘„
âˆ‘ï¸

ğ‘–=1

(cid:16)

ğ‘Š 2

ğ‘– ğœ“ğ‘–

1, â„ğ‘–, ğ‘˜ğ‘–, â„2

ğ‘– /2, â„ğ‘– ğ‘˜ğ‘–, ğ‘˜2

ğ‘– /2

(cid:17)

,

(26)

while the elements of ğ‘¿ were deï¬ned above. We ï¬nd ğ´âˆ’1 numeri-
cally, such that

ğ‘‹ ğ‘— =

ğ‘„
âˆ‘ï¸

ğ‘–=1

Xğ‘—ğ‘–ğœ“ğ‘–,

(27)

(cid:32)

Xğ‘—ğ‘– = ğ‘Š 2
ğ‘–

(22)

ğ‘—1 + ğ´âˆ’1
ğ´âˆ’1
ğ‘—2

â„ğ‘– + ğ´âˆ’1
ğ‘—3

ğ‘˜ğ‘– + ğ´âˆ’1
ğ‘—4

â„2
ğ‘–
2

+ ğ´âˆ’1
ğ‘—5

â„ğ‘– ğ‘˜ğ‘– + ğ´âˆ’1
ğ‘—6

(cid:33)

ğ‘˜2
ğ‘–
2

. (28)

From (27) it is clear that only the weights of the ğ‘„ NN are (in prin-
ciple) diï¬€erent from zero. Here, from (28) it becomes straightforward
to compute the weights required in equations (12) - (15).

Now, we have found from mock reconstructions that for ğ‘„ âˆ¼ 9 the
reconstruction still works, but for less NN the reconstruction tends to
fail, since (25) becomes singular quickly. Under this condition, if the
reconstruction converges, most likely the output will not be reliable.
On the other hand, if ğ‘„ is beyond ğ‘„ âˆ¼ 36 the reconstruction ï¬‚attens.
We have seen that 16 â‰¤ ğ‘„ â‰¤ 36 is good enough for the reconstruction
to work properly, with optimal results for ğ‘„ âˆ¼ 25, since the output is
neither irregular in excess nor ï¬‚attened in excess.

In this paper we use a quartic spline as ğ‘Šğ‘–, given by
(cid:19)3

(cid:19)2

(cid:19)4

(cid:18) ğ‘‘ğ‘–
ğ‘‘ğ‘š

+ 8

(cid:18) ğ‘‘ğ‘–
ğ‘‘ğ‘š

âˆ’ 3

(cid:18) ğ‘‘ğ‘–
ğ‘‘ğ‘š

ğ‘Šğ‘– = 1 âˆ’ 6

,

(29)

âˆšï¸ƒ

with ğ‘‘ğ‘– =
(ğœƒğ‘–,1 âˆ’ ğœƒ0,1)2 + (ğœƒğ‘–,2 âˆ’ ğœƒ0,2)2, and ğ‘‘ğ‘š = ğ‘›ğ‘‘ğ‘šğ‘ğ‘¥, where
ğ‘‘ğ‘šğ‘ğ‘¥ is the distance of the furthest NN from ğœ½0 (as it is shown in
Fig. 1), and ğ‘› > 1. In this work we have taken ğ‘› = 2.

,

(25)

3.2 Grid reï¬nement

The reconstruction begins with a rectangular grid with ğ‘1 Ã— ğ‘2 nodes
with respect to the rectangular coordinates ğœƒ1 and ğœƒ2, deï¬ned over
the region where the reconstruction takes place.

For the reï¬nement process, by means of a Gaussian distribution
with standard deviation ğœğ‘‘, we draw ğ‘ğ‘‘ new nodes around each
of the main deï¬‚ectors when they are known. If that is not the case,
by default, such new nodes are drawn with respect to the center of
the region of reconstruction. We keep only those new nodes that
lie within a radius ğ‘…ğ‘‘ > ğœğ‘‘ from the given main deï¬‚ector. The
aim of ğ‘…ğ‘‘ is to regulate the density of nodes, whereas weak lensing
is dominant. With this distribution of nodes, the reconstruction is
capable to provide a better description of those regions with high
mass concentrations.

Additionally, around each of the multiple images, we set a circu-
lar neighborhood of radius ğ‘Ÿğ‘‘ and determine the number of nodes

MNRAS 000, 1â€“24 (2021)

Î¸1Î¸2dmax6

D. A. Torres-Ballesteros and L. CastaÃ±eda

Figure 2. In this ï¬gure the blue dot represents the position of the main deï¬‚ector, the red dots represent the multiple images, and the black dots represent the
nodes in the given grid. Here we have the initial grid (left panel), upon which the ï¬rst reï¬nement is applied at the end of the ï¬rst outer level iteration (middle
panel). The reï¬nement continues until the reconstruction ends, giving us the ï¬nal grid (right panel).

within such neighborhood. If it is less than ğ‘„, by means of a uniform
distribution, we add the number of nodes required to get ğ‘„ nodes.
Otherwise, we do not add new nodes. For each outer iteration, ğ‘Ÿğ‘‘
is reduced by a factor ğ‘¢. This adaptive process provides a higher
resolution, and thus a more accurate reproduction the multiply im-
aged systems. We apply this process only to the strong regime, since,
in general terms the identiï¬cation of the multiply imaged systems
and their positions, as well as the penalty functions themselves, are
less noisy than those from the weak regime; and we want to avoid
overï¬tting such noise as much as possible.

An example of the reï¬nement process for a single deï¬‚ector is

depicted in Fig. 2.

3.3 Penalty functions

In this section we discuss how the diï¬€erent contributions to the
penalty function (10) are deï¬ned, and how they contribute to (17).

As we described before, the reconstruction method consists of two
levels of iterations, where the system of linear equations is computed
at the inner level. So that, when we compute such system of equa-
tions, those terms that mess up with the linearity with respect to
the deï¬‚ection potential are computed using the deï¬‚ection potential
from the previous inner iteration. In consequence, such terms can be
considered as constants during the current inner iteration. If we are
at the ï¬rst inner iteration, we make use of ğœ“ (ğ‘šâˆ’1) , with ğ‘š â‰¥ 1 being
the current outer iteration.

3.3.1 Strong regime

The strong regime is constrained by using the multiply imaged sys-
tems available, as discussed in Sec. 2. In particular, we focus on their
angular position, which makes natural to deï¬ne the penalty function
for this regime as

ğœ’2

ğ‘  :=

ğ‘ğ‘ 
âˆ‘ï¸

(cid:32) ğ‘ğ‘–
âˆ‘ï¸

ğ‘–=1

ğ‘›=1

ğ‘‡
ğ‘–ğ‘›Sâˆ’1

ğ‘™,ğ‘–ğ‘› ğ’‘ğ‘–ğ‘›

ğ’‘

(cid:33)

,

(30)

Mğ‘–ğ‘› =ğœ‡ğ‘–ğ‘›

where ğ‘ğ‘  and ğ‘ğ‘– are ,respectively, the number of multiply imaged
systems that are being used, and the number of images the ğ‘–-th system
has. On the other hand, ğ’‘ğ‘–ğ‘› := ğœ½ğ‘–ğ‘› âˆ’ ğœ½ (cid:48)
ğ‘–ğ‘› compares the ğ‘›-th observed
image position ğœ½ (cid:48)
ğ‘–ğ‘› from the ğ‘–-th system to the corresponding position
ğœ½ğ‘–ğ‘› computed from the reconstruction. The uncertainties in ğœ½ (cid:48)
ğ‘–ğ‘› at

MNRAS 000, 1â€“24 (2021)

each component are ğœ1,ğ‘–ğ‘› and ğœ2,ğ‘–ğ‘›, which are introduced trough

ğ‘†ğ‘™,ğ‘–ğ‘› =

(cid:32) ğœ2
1,ğ‘–ğ‘›
0

(cid:33)

.

0
ğœ2

2,ğ‘–ğ‘›

(31)

The problem with (30) relies on the need to explicitly solve the
lens equation, which makes diï¬ƒcult to explicitly write it in terms
of ğœ“ on every node. For that reason, working on the source plane
instead, turns out to be an advantage. In this direction, let us deï¬ne
two diï¬€erent penalty functions.

Type 1: Since any multiply imaged system is linked to a unique
source, when we apply the lens equation (6) to such images, they
have to take us to the same source with position ğœ·. Hence, for the
ğ‘–-th system we can compare the source position ğœ·ğ‘–ğ‘› predicted by
the reconstruction for the ğ‘›-th image to the source true position ğœ·(cid:48)
ğ‘–,
however, since such true position is unknown, the average source
position predicted by the reconstruction

(cid:104)ğœ·ğ‘–(cid:105) =

1
ğ‘ğ‘–

ğ‘ğ‘–
âˆ‘ï¸

ğ‘›=1

ğœ·ğ‘–ğ‘›

(32)

is commonly used instead. Here ğœ·ğ‘–ğ‘› = ğœ½ (cid:48)
ğ‘–ğ‘› âˆ’ ğ‘ğ‘–ğœ¶ğ‘–ğ‘›. This approach
also constrains the multiple images to converge to the same source
as needed.

One cannot simply work on the source plane and make use of the
observed uncertainties, since the eï¬€ect of the lens is important. As
it is discussed in (Schneider et al. 2006, Part 2, Section 4.6), the
magniï¬cation induced on the images by the mapping ğœ· â†’ ğœ½ also
aï¬€ects their position uncertainties. Therefore, as a correction to this
matter, by applying the Taylor expansion to the lens equation (6) up
to ï¬rst order derivatives around (cid:104)ğœ·ğ‘–(cid:105)1, we get
ğ’‘ğ‘–ğ‘› = Mğ‘–ğ‘› (cid:0)ğœ·ğ‘–ğ‘› âˆ’ (cid:104)ğœ·ğ‘–(cid:105)(cid:1) ,

(33)

where

(cid:18) 1 âˆ’ ğ‘ğ‘– ğœ…ğ‘–ğ‘› + ğ‘ğ‘– ğ›¾1,ğ‘–ğ‘›
ğ‘ğ‘– ğ›¾2,ğ‘–ğ‘›
(cid:18) ğ‘š1,ğ‘–ğ‘› ğ‘š2,ğ‘–ğ‘›
ğ‘š3,ğ‘–ğ‘› ğ‘š4,ğ‘–ğ‘›

(cid:19)

.

ğ‘ğ‘– ğ›¾2,ğ‘–ğ‘›
1 âˆ’ ğ‘ğ‘– ğœ…ğ‘–ğ‘› âˆ’ ğ‘ğ‘– ğ›¾1,ğ‘–ğ‘›

(cid:19)

(34)

=ğœ‡ğ‘–ğ‘›

1 We use (cid:104)ğœ·ğ‘– (cid:105) since the true source position ğœ·ğ‘– is unknown.

Î¸1Î¸2Î¸1Î¸1relensing: Reconstructing the mass proï¬le of galaxy clusters from gravitational lensing

7

is the magniï¬cation matrix at ğœ½ (cid:48)

ğ‘–ğ‘›, and

(cid:17)

(35)

ğœ‡ğ‘–ğ‘› =

1
(1 âˆ’ ğ‘ğ‘– ğœ…ğ‘–ğ‘›)2 âˆ’ ğ‘ 2
ğ‘–

(cid:16)

1,ğ‘–ğ‘› + ğ›¾2
ğ›¾2
is magniï¬cation the of the corresponding image as well. It is impor-
tant to take into account that the approximation (33) holds as long as
the predicted images are as close as possible to the observed ones.

2,ğ‘–ğ‘›

It has been shown that only the magniï¬cation ğœ‡ğ‘–ğ‘› is enough to
account for this correction (e.g. BradaÄ et al. (2005b)). We stick
to this for the reconstructions presented in this work. Nevertheless,
due to the nature of this reconstruction method, considering only
the magniï¬cation (at least for our implementation) can lead to a
divergent solution; the method may become numerically unstable.
For instance, considering Mğ‘–ğ‘› as a hole helps to control the impact
of ğœ‡ğ‘–ğ‘› making the reconstruction more stable, with the cost of losing
some accuracy around the mass peaks. Now, the implementation of
either ğœ‡ğ‘–ğ‘› or Mğ‘–ğ‘› introduce nonlinearities on (17), so that they are
not explicitly written in terms of ğœ“ ğ‘— . Instead, they are computed from
the last ğœ“ that is known, and are manipulated as constant terms.

With respect to (cid:104)ğœ·ğ‘–(cid:105), one can compute it in the same way as ğœ‡ğ‘–ğ‘›
and Mğ‘–ğ‘› are computed (as it is done in e.g. BradaÄ et al. (2005a,
2009)). However, at least for our implementation this approach is not
eï¬€ective, since when either ğœ‡ğ‘–ğ‘› or Mğ‘–ğ‘› is included the reconstruction
shows the tendency to produce an overestimation of ğœ…, close to some
of the grid corners, and it cannot be eï¬€ectively solved simply by
considering a wider region for the reconstruction or changing the grid
size. This problem is solved by explicitly writing the components of
(cid:104)ğœ·ğ‘–(cid:105) in terms of ğœ“ ğ‘— as

(cid:104)ğ›½ğ‘,ğ‘–(cid:105) =

1
ğ‘ğ‘–

ğ‘ğ‘–
âˆ‘ï¸

ğ‘=1

ğœƒ (cid:48)
ğ‘,ğ‘– ğ‘ âˆ’

1
ğ‘ğ‘–

ğ‘ğ‘–
âˆ‘ï¸

(cid:32) ğ‘
âˆ‘ï¸

ğ‘=1

ğ‘—=1

(cid:33)

Dğ‘,ğ‘– ğ‘ ğ‘— ğœ“ ğ‘—

,

from which we have that

1
ğ‘ğ‘–

ğ‘ğ‘–
âˆ‘ï¸

ğ‘=1

ğœƒ (cid:48)
ğ‘,ğ‘– ğ‘,

(cid:104)ğœƒğ‘,ğ‘–(cid:105) :=

and

ğœ• (cid:104)ğ›½ğ‘,ğ‘–(cid:105)
ğœ•ğœ“ğ‘˜

:= âˆ’

ğ‘ğ‘–
ğ‘ğ‘–

ğ‘ğ‘–
âˆ‘ï¸

ğ‘=1

Dğ‘,ğ‘– ğ‘ğ‘˜ ,

(36)

(37)

(38)

with ğ‘ = 1, 2 representing each component. Under this approach, we
also get an improvement in the performance. For a tolerance of 10âˆ’3
we observed in the diï¬€erent reconstructions presented in this work a
reduction in the number of inner iterations of at least ten times. Also,
structure was clearly shown after the ï¬rst or second inner iteration,
and the condition (20) was fulï¬lled within 4 âˆ’ 6 inner iterations.

At this point, we have that our ï¬rst penalty function is easily
ğ‘  , its contribution to

obtained by replacing (33) into (30). Having ğœ’2
(17) is given through

W (ğ‘ )
ğ‘˜ ğ‘—

:=

ğ‘ğ‘ 
âˆ‘ï¸

ğ‘ğ‘–
âˆ‘ï¸

2
âˆ‘ï¸

ğ‘–=1

ğ‘›=1

ğ‘=1

(cid:32)

ğ‘ğ‘– ğµğ‘,ğ‘–ğ‘›ğ‘˜

Dğ‘,ğ‘–ğ‘› ğ‘— âˆ’

(cid:33)

,

Dğ‘,ğ‘– ğ‘ ğ‘—

1
ğ‘ğ‘–

ğ‘ğ‘–
âˆ‘ï¸

ğ‘=1

and

V (ğ‘ )
ğ‘˜

=

ğ‘ğ‘ 
âˆ‘ï¸

ğ‘ğ‘–
âˆ‘ï¸

2
âˆ‘ï¸

(cid:34)

ğ‘–=1

ğ‘›=1

ğ‘=1

(cid:32)

ğ‘ğ‘,ğ‘–ğ‘›

ğ‘ğ‘– Dğ‘,ğ‘–ğ‘›ğ‘˜ +

(cid:33)

ğœ• (cid:104)ğ›½ğ‘,ğ‘–(cid:105)
ğœ•ğœ“ğ‘˜

âˆ’ ğµğ‘,ğ‘–ğ‘›ğ‘˜ (cid:104)ğœƒ1,ğ‘–(cid:105)

(cid:35)

,

where we have deï¬ned

(cid:32)

ğµ1,ğ‘–ğ‘›ğ‘˜ :=ğœ‡2
ğ‘–ğ‘›

ğ‘ğ‘–Î”ğ‘š1,ğ‘–ğ‘› ğ·1,ğ‘–ğ‘›ğ‘˜ + ğ‘ğ‘–Î”ğ‘š2,ğ‘–ğ‘› ğ·2,ğ‘–ğ‘›ğ‘˜

+ Î”ğ‘š1

ğœ• (cid:104)ğ›½1,ğ‘–(cid:105)
ğœ•ğœ“ğ‘˜

+ Î”ğ‘š2

(cid:33)

,

ğœ• (cid:104)ğ›½2,ğ‘–(cid:105)
ğœ•ğœ“ğ‘˜

(cid:32)

ğµ2,ğ‘–ğ‘›ğ‘˜ :=ğœ‡2
ğ‘–ğ‘›

ğ‘ğ‘–Î”ğ‘š2,ğ‘–ğ‘› ğ·1,ğ‘–ğ‘›ğ‘˜ + ğ‘ğ‘–Î”ğ‘š3,ğ‘–ğ‘› ğ·2,ğ‘–ğ‘›ğ‘˜

+ Î”ğ‘š2

ğœ• (cid:104)ğ›½1,ğ‘–(cid:105)
ğœ•ğœ“ğ‘˜

+ Î”ğ‘š3

(cid:33)

,

ğœ• (cid:104)ğ›½2,ğ‘–(cid:105)
ğœ•ğœ“ğ‘˜

ğ‘1,ğ‘–ğ‘› := ğœ‡2
ğ‘–ğ‘›

and
ğ‘2,ğ‘–ğ‘› := ğœ‡2
ğ‘–ğ‘›

(cid:16)

(cid:16)

Î”ğ‘š1,ğ‘–ğ‘›ğœƒ1,ğ‘–ğ‘› + Î”ğ‘š2,ğ‘–ğ‘›ğœƒ2,ğ‘–ğ‘›

Î”ğ‘š2,ğ‘–ğ‘›ğœƒ1,ğ‘–ğ‘› + Î”ğ‘š3,ğ‘–ğ‘›ğœƒ2,ğ‘–ğ‘›

(cid:17)

,

(cid:17)

,

with

Î”ğ‘š1,ğ‘–ğ‘› :=

Î”ğ‘š2,ğ‘–ğ‘› :=

and

Î”ğ‘š3,ğ‘–ğ‘› :=

+

(cid:33)

,

ğ‘š2

3,ğ‘–ğ‘›

ğœ2

2,ğ‘–ğ‘›

(cid:32) ğ‘š2

1,ğ‘–ğ‘›

ğœ2

1,ğ‘–ğ‘›
(cid:32) ğ‘š1,ğ‘–ğ‘›ğ‘š2,ğ‘–ğ‘›
ğœ2
1,ğ‘–ğ‘›

+

ğ‘š3,ğ‘–ğ‘›ğ‘š4,ğ‘–ğ‘›
ğœ2

2,ğ‘–ğ‘›

(cid:33)

,

(cid:32) ğ‘š2

2,ğ‘–ğ‘›

ğœ2

1,ğ‘–ğ‘›

+

(cid:33)

.

ğ‘š2

4,ğ‘–ğ‘›

ğœ2

2,ğ‘–ğ‘›

(41)

(42)

(43)

(44)

(45)

(46)

(47)

Type 2: In this case, for each of the multiply imaged systems, we
compare the possible pairs formed from the position of the source
predicted for each of the corresponding multiple images. Therefore,
the penalty function reads
(cid:32) ğ‘ğ‘–âˆ’1
âˆ‘ï¸

ğ‘ğ‘ 
âˆ‘ï¸

ğ‘ğ‘–
âˆ‘ï¸

(cid:33)

ğ‘‡
ğ‘–ğ‘›ğ‘šSâˆ’1

ğ‘™,ğ‘–ğ‘›ğ‘šğ’ƒğ‘–ğ‘›ğ‘š

ğ’ƒ

,

ğœ’2

ğ‘  :=

(48)

ğ‘–=1

ğ‘›=1

ğ‘š=ğ‘›+1

where ğ’ƒğ‘–ğ‘›ğ‘š = ğœ·ğ‘–ğ‘› âˆ’ ğœ·ğ‘–ğ‘š, with ğœ·ğ‘–ğ‘› = ğœ½ (cid:48)
ğ‘–ğ‘› âˆ’ ğ‘ğ‘–ğœ¶ğ‘–ğ‘› and ğœ·ğ‘–ğ‘š =
ğœ½ (cid:48)
ğ‘–ğ‘š âˆ’ ğ‘ğ‘–ğœ¶ğ‘–ğ‘š. In order to account for the correction discussed above,
that is needed in order to be able to work at source plane, we have
deï¬ned

ğœ2

1,ğ‘–ğ‘š
ğœ‡2

ğ‘–ğ‘š

ğ‘†ğ‘™,ğ‘–ğ‘›ğ‘š =

ğœ2

1,ğ‘–ğ‘›
ğœ‡2
ğ‘–ğ‘›

+

0

1
2

(cid:169)
(cid:173)
(cid:173)
(cid:173)
(cid:173)
(cid:173)
(cid:171)

0

+

ğœ2

2,ğ‘–ğ‘›
ğœ‡2
ğ‘–ğ‘›

.

(cid:170)
(cid:174)
(cid:174)
(cid:174)
(cid:174)
(cid:174)
(cid:172)

ğœ2

2,ğ‘–ğ‘š
ğœ‡2

ğ‘–ğ‘š

Here, the contribution of ğœ’2
ğ‘ğ‘–âˆ’1
âˆ‘ï¸

ğ‘ğ‘ 
âˆ‘ï¸

ğ‘ğ‘–
âˆ‘ï¸

2
âˆ‘ï¸

ğ‘  to (17) yields
(cid:32) ğ‘ 2
ğ‘–

W (ğ‘ )
ğ‘˜ ğ‘—

:=

ğ‘–=1

ğ‘›=1

ğ‘š=ğ‘›+1

ğ‘=1

ğœ2

ğ‘,ğ‘–ğ‘›ğ‘š

Î”Dğ‘,ğ‘–ğ‘›ğ‘šğ‘˜ Î”Dğ‘,ğ‘–ğ‘›ğ‘š ğ‘—

(49)

(cid:33)

,

(50)

(39)

and

V (ğ‘ )
ğ‘˜

:=

ğ‘ğ‘ 
âˆ‘ï¸

ğ‘ğ‘–âˆ’1
âˆ‘ï¸

ğ‘ğ‘–
âˆ‘ï¸

(cid:32)

2
âˆ‘ï¸

ğ‘ğ‘–

ğ‘–=1

ğ‘›=1

ğ‘š=ğ‘›+1

ğ‘=1

ğœ2

ğ‘,ğ‘–ğ‘›ğ‘š

where we have deï¬ned

Î”Dğ‘,ğ‘–ğ‘›ğ‘šğ‘˜ Î”ğœƒğ‘,ğ‘–ğ‘›ğ‘š

,

(51)

(cid:33)

(40)

Î”Dğ‘,ğ‘–ğ‘›ğ‘š ğ‘ := Dğ‘,ğ‘–ğ‘› ğ‘ âˆ’ Dğ‘,ğ‘–ğ‘š ğ‘
with ğ‘ = ğ‘˜, ğ‘—, and
Î”ğœƒğ‘,ğ‘–ğ‘›ğ‘š := ğœƒ (cid:48)

ğ‘,ğ‘–ğ‘› âˆ’ ğœƒ (cid:48)

ğ‘,ğ‘–ğ‘š.

(52)

(53)

MNRAS 000, 1â€“24 (2021)

8

D. A. Torres-Ballesteros and L. CastaÃ±eda

3.3.2 Weak regime

such that for |ğ‘”ğ‘– | â‰¤ 1 we get

Following BradaÄ et al. (2005a), we constrain the weak regime by
means of sources apparent ellipticity, as discussed in Sec. 2. There-
fore, for this regime the penalty function is deï¬ned as

ğœ’2

ğ‘¤ :=

ğ‘ğ‘¤
âˆ‘ï¸

ğ‘–=1

|ğœ–ğ‘– âˆ’ (cid:104)ğœ–ğ‘–(cid:105) |2
ğœ2
ğ‘–

,

(54)

with ğ‘ğ‘¤ being the number of background galaxies for which their
ellipticity and redshift is known. Additionally Schneider et al. (2006)

ğ´1,ğ‘– =

ğ´5,ğ‘– =

ğ‘3,ğ‘– =

ğ‘ 2
ğ‘–
ğœ2

â‰¤,ğ‘–
ğ‘ 2
ğ‘–
ğœ2

â‰¤,ğ‘–
ğ‘ğ‘–
ğœ2

â‰¤,ğ‘–

ğœ–1,ğ‘–,

ğ´2,ğ‘– =

|ğœ–ğ‘– |2,

ğ‘1,ğ‘– =

|ğœ–ğ‘– |2,

ğ‘ 2
ğ‘–
ğœ2

â‰¤,ğ‘–
ğ‘ğ‘–
ğœ2

â‰¤,ğ‘–

ğœ–2,ğ‘–,

ğ´3,ğ‘– = ğ´4,ğ‘– =

ğ‘ 2
ğ‘–
ğœâ‰¤,ğ‘–

,

ğœ–1,ğ‘–,

ğ‘2,ğ‘– =

ğ‘ğ‘–
ğœ2

â‰¤,ğ‘–

ğœ–2,ğ‘–,

(60)

meanwhile for |ğ‘”ğ‘– | > 1 the coeï¬ƒcients are

ğœ2

ğ‘– =

(cid:16)

1
ğ‘ ğ‘,ğ‘–

1 âˆ’ ğ‘šğ‘–ğ‘›

(cid:16)

|ğ‘”ğ‘– |2, |ğ‘”ğ‘– |âˆ’2(cid:17)(cid:17)2

ğœ2

ğœ– ğ‘  + ğœ2

ğ‘’ğ‘Ÿğ‘Ÿ ,

(55)

ğ´1,ğ‘– =

where ğ‘ ğ‘,ğ‘– corresponds to the number of averaged apparent elliptic-
ities in (9). Such ellipticities are from sources with the same redshift,
and located in a neighborhood within which the properties of the
lens do not change signiï¬cantly Bartelmann & Schneider (2001);
Schneider et al. (2006). Now, since in practice it is not easy to fulï¬ll
these conditions, the best choice is to take ğ‘ ğ‘,ğ‘– = 1, and so consider
ğœ–ğ‘– to be the best representative of its sample at its neighborhood
BradaÄ et al. (2005a). That is why in (54) ğœ–ğ‘– is compared to (cid:104)ğœ–ğ‘–(cid:105). The
quantities ğœğœ–ğ‘  and ğœğ‘’ğ‘Ÿğ‘Ÿ in (55) correspond to the intrinsic and ob-
servational ellipticity standard deviations, respectively. In this paper
we take ğœğœ–ğ‘  âˆ¼ 0.2 âˆ’ 0.3 and ğœğ‘’ğ‘Ÿğ‘Ÿ = 0.1 BradaÄ et al. (2005a); Cain
et al. (2016).

An alternative approach to ğœ’2

ğ‘¤ can be found in e.g. Merten et al.

(2009, 2011); Merten (2016).

According to (9), the penalty function (54) has two possible forms.

To begin with, for |ğ‘”ğ‘– | â‰¤ 1 (54) turns into

ğ‘ğ‘¤
âˆ‘ï¸

ğœ’2

ğ‘¤ =

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

1
ğœ2
ğ‘–

ğœ–ğ‘– âˆ’

ğ‘ğ‘– ğ›¾ğ‘–
1 âˆ’ ğ‘ğ‘– ğœ…ğ‘–

ğ‘ğ‘¤
âˆ‘ï¸

=

(cid:12)
2
(cid:12)
(cid:12)
(cid:12)
(cid:12)

ğœ–ğ‘– âˆ’ ğ‘ğ‘–ğœ–ğ‘– ğœ…ğ‘– âˆ’ ğ‘ğ‘– ğ›¾ğ‘–

(1 âˆ’ ğ‘ğ‘– ğœ…ğ‘–)2 ğœ2
ğ‘–

(cid:12)
2
(cid:12)
(cid:12)

,

(56)

ğ‘–=1

ğ‘–=1
whereas for |ğ‘”ğ‘– | > 1 (54) becomes

(cid:12)
(cid:12)
(cid:12)

(cid:12)
(cid:12)
(cid:12)

In practice, the observations mainly come from sources that sat-
isfy |ğ‘”ğ‘– | < 1. However, we have implemented both possibilities in
relensing, such that, for every inner iteration we evaluate |ğ‘”ğ‘– | from
the last deï¬‚ection potential that we have. With that, relensing
decides whether to use (56) or (57) as the corresponding penalty
function for the weak regime.
For both versions of ğœ’2

ğ‘¤ the coeï¬ƒcients W ğ‘¤

ğ‘˜ ğ‘— and V ğ‘¤
ğ‘˜

can be

written as

W (ğ‘¤)
ğ‘˜ ğ‘—

:=

(cid:34)

ğ‘ğ‘¤
âˆ‘ï¸

ğ‘–=1

(cid:32)

(cid:33)

ğ´1,ğ‘–

G1,ğ‘–ğ‘˜ Kğ‘– ğ‘— + Kğ‘–ğ‘˜ G1,ğ‘– ğ‘—

(cid:32)

(cid:33)

+ ğ´2,ğ‘–

G2,ğ‘–ğ‘˜ Kğ‘– ğ‘— + ğ¾ğ‘–ğ‘˜ G2,ğ‘– ğ‘—

+ ğ´3,ğ‘– G1,ğ‘–ğ‘˜ G1,ğ‘– ğ‘—

+ ğ´4,ğ‘– G2,ğ‘–ğ‘˜ G2,ğ‘– ğ‘— + ğ´5,ğ‘–Kğ‘–ğ‘˜ Kğ‘– ğ‘— ,

(cid:35)

,

and

V (ğ‘¤)
ğ‘˜

:=

(cid:32)

ğ‘ğ‘¤
âˆ‘ï¸

ğ‘–=1

ğ‘1,ğ‘– G1,ğ‘–ğ‘˜ + ğ‘2,ğ‘– G2,ğ‘–ğ‘˜ + ğ‘3,ğ‘–Kğ‘–ğ‘˜

(cid:33)

,

MNRAS 000, 1â€“24 (2021)

ğœ–1,ğ‘–,

ğ´2,ğ‘– =

ğ‘ 2
ğ‘–
ğœ2

>,ğ‘–

ğœ–2,ğ‘–,

ğ´3,ğ‘– = ğ´4,ğ‘– =

ğ‘ 2
ğ‘–
ğœ2

>,ğ‘–

|ğœ–ğ‘– |2,

ğ‘1,ğ‘– =

ğ‘ğ‘–
ğœ2

>,ğ‘–

ğœ–1,ğ‘–,

ğ‘2,ğ‘– =

ğ‘ğ‘–
ğœ2

>,ğ‘–

ğœ–2,ğ‘–,

,

,

(61)

ğ‘ 2
ğ‘–
ğœ2

>,ğ‘–
ğ‘ 2
ğ‘–
ğœ2

>,ğ‘–
ğ‘ğ‘–
ğœ2

>,ğ‘–

ğ´5,ğ‘– =

ğ‘3,ğ‘– =

â‰¤,ğ‘– := (1 âˆ’ ğ‘ğ‘– ğœ…ğ‘–)2ğœ2
ğ‘– . Here, both ğœ2
>,ğ‘– := ğ‘ 2
â‰¤,ğ‘–
>,ğ‘– are computed from the last ğ‘ğ‘ ğ‘– that is known, so that they

with ğœ2
and ğœ2
are manipulated as constant terms.

ğ‘– and ğœ2

ğ‘– |ğ›¾ğ‘– |2ğœ2

3.3.3 Regularization terms

This sort of grid based reconstruction methods require a term which
provides stability along the reconstruction. Such term helps to deal
with numerical noise, which otherwise will most likely lead to diver-
gent solutions for (17).

Diï¬€erent solutions have been proposed to overcome these diï¬ƒcul-
ties, either as a regularization term (e.g Seitz et al. (1998); BradaÄ
et al. (2005a,b); Merten (2016)), or by introducing the signal to noise
ratio (e.g Deb et al. (2008)). Here, as we have stated before, we have
chosen to implement the former approach, particularly by using the
regularization terms

(62)

(63)

and

ğœ’2
ğ›¾ (ğ‘…) = ğœ‚ğ›¾

ğ‘
âˆ‘ï¸

2
âˆ‘ï¸

(cid:16)

ğ‘—=1

ğ‘=1

ğ›¾ğ‘, ğ‘— âˆ’ ğ›¾ (ğ‘šâˆ’1)

ğ‘, ğ‘—

(cid:17)2

,

with ğœ‚ğœ… and ğœ‚ğ›¾ being positive deï¬ned constants. Such constants
or regularization weights, control how smooth the reconstruction
turns. The term (62) acts mainly within the cluster inner region
dominated by the strong regime, while the term (63) helps to control
the reconstruction outside the inner region.

, ğ›¾ (ğ‘šâˆ’1)
1, ğ‘—

, and ğ›¾ (ğ‘šâˆ’1)
2, ğ‘—

On the other hand, if we are in the ğ‘š-th outer iteration, the terms
ğœ… (ğ‘šâˆ’1)
in (62) and (63), respectively, are com-
ğ‘—
puted after the grid reï¬nement at the end of the previous outer itera-
tion, or they come from the initial guess (ğ‘š = 1).
Therefore, from (62) we get the coeï¬ƒcients

(58)

W (ğœ…)
ğ‘˜ ğ‘—

:= ğœ‚ğœ…

ğ‘
âˆ‘ï¸

ğ‘–=1

Kğ‘–ğ‘˜ Kğ‘– ğ‘—

and

(59)

V ( ğœ…)
ğ‘˜

:= ğœ‚ğœ…

ğ‘
âˆ‘ï¸

ğ‘–=1

ğœ… (ğ‘šâˆ’1)
ğ‘–

Kğ‘–ğ‘˜ ,

(64)

(65)

ğœ’2

ğ‘¤ =

ğ‘ğ‘¤
âˆ‘ï¸

ğ‘–=1

1
ğœ2

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

ğœ–ğ‘– âˆ’

1 âˆ’ ğ‘ğ‘– ğœ…ğ‘–
ğ‘ğ‘– ğ›¾âˆ—
ğ‘–

(cid:12)
2
(cid:12)
(cid:12)
(cid:12)
(cid:12)

=

ğ‘ğ‘¤
âˆ‘ï¸

ğ‘–=1

ğ‘ğ‘–ğœ–ğ‘– ğ›¾âˆ—

(cid:12)
2
ğ‘– + ğ‘ğ‘– ğœ…ğ‘– âˆ’ 1
(cid:12)
(cid:12)
ğ‘– |ğ›¾ğ‘– |2ğœ2
ğ‘ 2
ğ‘–

.

(57)

ğœ’2
ğœ… (ğ‘…) = ğœ‚ğœ…

ğ‘
âˆ‘ï¸

(cid:16)

ğ‘—=1

ğœ… ğ‘— âˆ’ ğœ… (ğ‘šâˆ’1)
ğ‘—

(cid:17)2

,

relensing: Reconstructing the mass proï¬le of galaxy clusters from gravitational lensing

9

meanwhile for (63) we have

W (ğ›¾)
ğ‘˜ ğ‘—

:= ğœ‚ğ›¾

ğ‘
âˆ‘ï¸

2
âˆ‘ï¸

ğ‘–=1

ğ‘=1

Gğ‘,ğ‘–ğ‘˜ Gğ‘,ğ‘– ğ‘— ,

and

V (ğ›¾)
ğ‘˜

:= ğœ‚ğ›¾

ğ‘
âˆ‘ï¸

2
âˆ‘ï¸

ğ‘–=1

ğ‘=1

ğ›¾ (ğ‘šâˆ’1)
ğ‘,ğ‘– Gğ‘,ğ‘–ğ‘˜ .

(66)

(67)

4 MOCK DISTRIBUTIONS: SIMPLE MODELS

For testing the performance of relensing we apply the reconstruc-
tion to two mock lenses, modeled by means of Non-singular Isother-
mal Spheres (NIS for short). Below, we describe how the mock
catalogues are created, and discuss the outcomes from their corre-
sponding reconstructions.

Hereinafter, for comparing the reconstructions to the true distribu-
tion, we use the relative diï¬€erence Î”ğ‘Ÿ ğ‘‹ = (ğ‘‹ğ‘Ÿ ğ‘’ğ‘ğ‘œ âˆ’ ğ‘‹ğ‘¡ğ‘Ÿ ğ‘¢ğ‘’)/ğ‘‹ğ‘¡ğ‘Ÿ ğ‘¢ğ‘’,
deï¬ned for any quantity ğ‘‹ of interest.

4.1 Catalogues

For each model, the catalogues involved are drawn under the same
conditions.

For the strong regime, we consider 40 sources randomly selected
with redshift ğ‘§ğ‘  > ğ‘§ğ‘™, and for which more than one image is obtained
after solving the lens equation (6). Whereas for the weak regime we
consider 1000 background sources with redshift ğ‘§ğ‘¤ > ğ‘§ğ‘™, whose el-
lipticities catalogue is constructed in the same direction as in BradaÄ
et al. (2005a); Cain et al. (2016). Thus, the intrinsic ellipticities are
drawn from a Gaussian distribution with ğœğœ– ğ‘  = 0.2, then, to each
component of the observed ellipticities (which are computed from
(7)) an error is added. Such an error is drawn from a Gaussian dis-
tribution with ğœğ‘’ğ‘Ÿğ‘Ÿ = 0.1. Their redshifts are drawn from a Gamma
distribution with shape and rate parameters ğ›¼ = 3 and ğ›½ = 3/2,
respectively. For each redshift, the corresponding added uncertainty
is drawn from a Gaussian distribution with ğœğ‘§,ğ‘– = 0.05(1 + ğ‘§ğ‘–) (with
ğ‘– = 1, . . . , ğ‘ğ‘¤ ). We keep those sources with only one image after
solving the lens equation.

4.2 NIS and 2NIS

The deï¬‚ection potential for a NIS is deï¬ned as

âˆšï¸ƒ

ğœ“(ğœ½) = ğ‘…0

|Î”ğœ½ |2 + ğœƒ2

0 with ğ‘…0 :=

4ğœ‹ğœ2ğ· (ğ‘§ğ‘™, ğ‘§)
ğ‘2ğ· (ğ‘§)

,

(68)

where Î”ğœ½ := ğœ½ âˆ’ğœ½ ğ‘. Such deï¬‚ection potential depends on the angular
diameter distance between the lens and the given source (ğ· (ğ‘§ğ‘™, ğ‘§)),
and also between the observer and the source (ğ· (ğ‘§)). As well, it
depends on the velocity dispersion ğœ, the speed of light ğ‘, the distri-
bution core ğœƒ0, and distribution center ğœ½ ğ‘.

The ï¬rst model we consider is a NIS with redshift ğ‘§ğ‘™ = 0.4, with
center at ğœ½ ğ‘ = (0, 0) ğ‘ğ‘Ÿğ‘ğ‘šğ‘–ğ‘›. It is characterized by the parameters
ğœƒ0 = 0.4 ğ‘ğ‘Ÿğ‘ğ‘šğ‘–ğ‘› and ğœ = 1500 ğ‘˜ğ‘š/ğ‘ . The corresponding conver-
gence map for a source with redshift ğ‘§ğ‘Ÿ = 9 is depicted in Fig. 3
(True).

The second model consists of two identical NIS with redshift
ğ‘§ğ‘™ = 0.4, whose center is at ğœ½ ğ‘1 = (âˆ’0.2, âˆ’0.4) ğ‘ğ‘Ÿğ‘ğ‘šğ‘–ğ‘›, and ğœ½ ğ‘2 =
(0.2, 0.4) ğ‘ğ‘Ÿğ‘ğ‘šğ‘–ğ‘›, respectively. The parameters describing each of
those NIS are ğœƒ0 = 0.2 ğ‘ğ‘Ÿğ‘ğ‘šğ‘–ğ‘› and ğœ = 1000 ğ‘˜ğ‘š/ğ‘ , such that the

resulting convergence map for a source with redshift ğ‘§ğ‘Ÿ = 9 is shown
in Fig. 5 (True). We refer to this model as 2NIS.

4.3 Reconstruction

The reconstructions are carried out considering ğœ‚ğœ… = ğœ‚ğ›¾ = 200
irrespectively of the initial guess ğœ“ (0) . Here, for the NIS we only
consider blind reconstructions, and then we explore the eï¬€ect of
the smoothing on such reconstructions. Whereas, for the 2NIS we
compare blind reconstructions against those for which ğœ“ (0) is given
by a Non-singular Isothermal Ellipsoid (NIE for short), as we discuss
later.

Now, for the initial grid, when only the strong regime is being
considered (s), we use 20 Ã— 20 nodes over a region of 3 Ã— 3 ğ‘ğ‘Ÿğ‘ğ‘šğ‘–ğ‘›2,
meanwhile, when both regimes are being considered (s+w), we take
22Ã—22 nodes over a region of 3.2Ã—3.2 ğ‘ğ‘Ÿğ‘ğ‘šğ‘–ğ‘›2. For the last scenario,
the extra nodes and grid size help to avoid overestimations of the
diï¬€erent quantities of interest on the boundary (particularly ğœ…), which
arise when some observations are close to such boundary.

With respect to the reï¬nement process, the NIS shows only one
deï¬‚ector, so that we add ğ‘ğ‘‘ = 600 nodes for each reï¬nement. On
the other hand, the 2NIS consists of two deï¬‚ectors, so that we add
ğ‘ğ‘‘ = 300 nodes for each deï¬‚ector. In both cases, those new nodes are
distributed considering ğœğ‘‘ = 1 ğ‘ğ‘Ÿğ‘ğ‘šğ‘–ğ‘›, and ğ‘…ğ‘‘ = 2 ğ‘ğ‘Ÿğ‘ğ‘šğ‘–ğ‘›. Also,
we take ğ‘Ÿğ‘‘ = 0.2 ğ‘ğ‘Ÿğ‘ğ‘šğ‘–ğ‘› for the ï¬rst reï¬nement process, which is
reduced by a factor ğ‘¢ = 0.8 at each of the subsequent reï¬nements,
except for the last one for which the reï¬nement is not applied. As
we discussed in Sec. 3.1, we set ğ‘„ = 25 nodes to perform the ï¬nite
diï¬€erences.

4.3.1 Convergence

In Fig. 3 we can see eight diï¬€erent reconstructed convergence maps
(ğœ…), along with the true mass for the NIS; which is the simplest of the
distributions that we are considering in this work. This distribution
posses spherical symmetry, for which we have only considered blind
reconstructions here, since a parametric ï¬tting to the data from the
strong regime either to a NIS itself or to a NIE leads to the true lens
(or at least a distribution close to it), and that is not what we want.
One of the aims of this work is to show the power of the method
to reveal important features of the lens, based upon little knowledge
about it, which is closer to what one has to face with real data.

Let us start with the eï¬€ect of the smoothing. The Fig. 3 shows in the
upper row the reconstructions for both penalty functions ğœ’2
ğ‘  without
considering the smoothing (reconstructions (1) âˆ’ (4)), meanwhile,
in the middle row the reconstructions were carried out under the
very same conditions, but with considering the smoothing (recon-
structions (5) âˆ’ (8)); so that reconstruction (1) is directly compared
to reconstruction (5), and so on. It is clear that the reconstructions
reveal the central peak regardless of the smoothing, the penalty func-
tion used, or whether weak lensing is being considered. However,
in Fig. 4 we can see that the inclusion of the smoothing provides a
better reconstruction once we move towards the outskirts.

Comparing Type 1 and Type 2 reconstructions (carried out un-
der the same conditions), we can see that there are no signiï¬cant
diï¬€erences when it comes to the results given by both penalty func-
tions. Instead, a signiï¬cant diï¬€erence appears when the smoothing
is included. Without smoothing, the contours in ğœ… are noisier and
less accurate, particularly outside the inner region. This is clearer
when weak lensing constraints are being considered. Here, for the
inner region we refer to the region that encloses all the multiple

MNRAS 000, 1â€“24 (2021)

10

D. A. Torres-Ballesteros and L. CastaÃ±eda

images known, as it is depicted in Fig. 4 (purple dashed contour).
That behaviour stands irrespectively of the lens distribution or the
input deï¬‚ection potential ğœ“ (0) . This behavior is accentuated when
the complexity of the lens increases.

When only the strong regime is included, the reconstruction ef-
fectiveness is strongly restricted to the inner region, as we can see in
Fig. 4, where most of such region presents a relative diï¬€erence within
|Î”ğ‘Ÿ ğœ…| < 0.1 (10%). In particular, we can see an improvement at the
inner region boundary when the smoothing is included. Outside the
inner region, the reconstruction loses its eï¬€ectiveness and there is an
underestimation of ğœ…, which is less accentuated when the smoothing
is added, but still present. Once strong and weak regimes are com-
bined, there is an overall enhancement in the reconstruction outside
the inner region, but without smoothing the increase in ğœ… is less uni-
form, and we can still see marked peaks of both underestimations
and overestimations of ğœ….

Now, we put our attention on ğ‘€ = ğ‘€ (â‰¤ ğœƒ), which represents
the mass enclosed within an angular radius ğœƒ measured from ğœ½ =
(0, 0) ğ‘ğ‘Ÿğ‘ğ‘šğ‘–ğ‘›. This applies to all the reconstructions considered in
this work. Here, Fig. 7 shows ğ‘€ for the eight reconstructions, given
for ğ‘ğ‘Ÿğ‘ğ‘šğ‘–ğ‘› â‰¤ ğœƒ â‰¤ 1.5 ğ‘ğ‘Ÿğ‘ğ‘šğ‘–ğ‘›. The curves have been separated into
Type 1 (upper panel) and Type 2 (lower panel), so that we can directly
compare the eï¬€ects of using the strong/weak regime as well as the
smoothing. We can see that ğ‘€ behaves similarly for Type 1 and Type
2 reconstructions. Again, we see that the best performance appears
within the inner region, where we can see a relative diï¬€erence within
|Î”ğ‘Ÿ ğ‘€ | â‰¤ 0.05 (5%).

The vertical lines in Fig 7, given for ğœƒğ‘–ğ‘› â‰ˆ 0.86 ğ‘ğ‘Ÿğ‘ğ‘šğ‘–ğ‘› and
ğœƒğ‘œğ‘¢ğ‘¡ â‰ˆ 1.04 ğ‘ğ‘Ÿğ‘ğ‘šğ‘–ğ‘›, correspond, respectively, to the inner and outer
radius of the inner region. It is within such limits, particularly close
to ğœƒğ‘œğ‘¢ğ‘¡ , that ğ‘€ starts to deviate from the true curve. Beyond the
inner region, the eï¬€ectiveness decreases, and for the range within
which the reconstruction is being considered, the relative diï¬€erence
gets up to |Î”ğ‘Ÿ ğ‘€ | â‰ˆ 0.16 (16%) for those reconstructions where only
strong lensing is being used; irrespectively of the smoothing. With
the inclusion of the weak regime, we see an improvement in ğ‘€ of
âˆ¼ 7%.

We see that the estimation of ğ‘€ is not severely aï¬€ected by the
smoothing, since the main features of the lens are recovered in both
cases. However, the smoothing provides a clear improvement in the
mass proï¬le, as well as in estimation of the magniï¬cations maps, and
therefore the critical curves; as we discuss later. Hence, from here on
we consider the smoothing in our reconstructions.

For the 2NIS we focus on the comparison between blind recon-
structions and those for which the input potential ğœ“ (0) or initial guess
contains some previous information about the lens. We want to keep
this initial guess as simple as possible, so that we cannot interfere in
excess, imposing many assumptions about the lens. For that reason,
as it has been shown in BradaÄ et al. (2005a), ï¬tting a NIE to the
multiply image systems provides a good enough estimation of ğœ“ (0) to
start working with. Depending on the complexity of the cluster, or its
morphological properties, it may be convenient to use a combination
of NIE as the initial guess. The deï¬‚ection potential of such NIE is
deï¬ned by making the transformation

|Î”ğœ½ |2 âˆ’â†’(1 âˆ’ ğ‘’) (cid:0)Î”ğœƒ1 cos ğœ‘ + Î”ğœƒ2 sin ğœ‘(cid:1)2

+ (1 + ğ‘’) (cid:0) âˆ’ Î”ğœƒ1 sin ğœ‘ + Î”ğœƒ2 cos ğœ‘(cid:1)2

(69)

into (68), which accounts for the introduction of the ellipticity ğ‘’ and
the rotation ğœ‘ of the semi major axis with respect to the horizontal,
and measured counterclockwise. For the ï¬tting we have constrained
0 â‰¤ ğ‘’ â‰¤ 0.25, so the proï¬le does not get distorted into a peanut

MNRAS 000, 1â€“24 (2021)

shaped one, as it is discussed in e.g. Golse & Kneib (2002). Here we
have let ğœƒ0 = 0.2 ğ‘ğ‘Ÿğ‘ğ‘šğ‘–ğ‘› ï¬xed. Therefore, for the 2NIS, besides the
blind reconstruction we consider a NIE as the initial guess.

In Fig. 5 we can see the eight reconstructions taken into account.
The upper row shows the blind reconstructions (reconstructions (1) âˆ’
(4)), whereas the middle row shows the reconstruction carried out
under the same conditions except that the initial guess is given by
the NIE (reconstructions (5) âˆ’ (8)). The lower panel shows the true
proï¬le.

The 2NIS is characterized by two prominent peaks or main deï¬‚ec-
tors, which are eï¬€ectively recovered in all reconstructions. Therefore,
the initial guess is not relevant in this matter. In terms of the blind
reconstructions, we can see that they struggle to recover the distri-
bution beyond the inner region. It is expected for reconstructions (1)
and (3), which only use strong lensing, as we saw for the NIS. In
contrast, reconstructions (2) and (4), which also use weak lensing
show an improvement in Î”ğ‘Ÿ ğœ… of about 10% âˆ’ 20% towards the out-
skirts, as it is depicted in Fig. 6 (upper row). Within most of the inner
region ğœ… shows a relative diï¬€erence |Î”ğ‘Ÿ |ğœ… < 0.1, with few peaks that
fall into 0.1 (10%) â‰¤ |Î”ğ‘Ÿ ğœ…| < 0.2 (20%).

At this point, it is clear that weak lensing strengthens the recon-
structions outside the inner region, so that the smoothing does not
have a negative impact on such regime. We focus now on how the
reconstruction behaves once one goes beyond blind reconstructions.
For reconstructions (5) âˆ’ (8) we can see a considerable improvement
with respect to their blind counterpart. Comparing reconstructions
(1) and (5), as well as reconstructions (3) and (7) (which only use
strong lensing), we ï¬nd a closer approach to the true proï¬les, as it
can be seen in the contour curves in ğœ… and also in the Î”ğ‘Ÿ ğœ… maps in
Fig. 6. In addition, comparing reconstructions (2) and (6), as well
as reconstructions (4) and (8) (which use strong and weak lensing),
we can see that outside the inner region they go from an underesti-
mation to an overestimation of ğœ…, notwithstanding, the region where
|Î”ğ‘Ÿ ğœ…| < 0.1 is wider, and the overestimation lies beyond |Î”ğ‘Ÿ ğœ…| > 0.2,
mostly close to the boundaries, where the constraints are weaker. In
either case, within the inner region, there are no signiï¬cant changes
in the reconstruction. Likewise, Type 1 and Type 2 reconstructions
behave equally well.

With respect to ğ‘€, which is computed within 0 ğ‘ğ‘Ÿğ‘ğ‘šğ‘–ğ‘› â‰¤ ğœƒ â‰¤
1.5 ğ‘ğ‘Ÿğ‘ğ‘šğ‘–ğ‘›, we have a good agreement with the true mass with
a relative diï¬€erence within |Î”ğ‘Ÿ ğ‘€ | < 0.05 (5%) for ğœƒ â‰¤ ğœƒğ‘–ğ‘› â‰ˆ
0.74 ğ‘ğ‘Ÿğ‘ğ‘šğ‘–ğ‘›, and close to ğœƒğ‘œğ‘¢ğ‘¡ â‰ˆ 0.90 ğ‘ğ‘Ÿğ‘ğ‘šğ‘–ğ‘› the curves start to
deviate from the true one; except for the orange curves (reconstruc-
tions (6) and (8)) as it is depicted in Fig. 8. For ğœƒ > ğœƒğ‘œğ‘¢ğ‘¡ the
worst estimation of ğ‘€ is given by reconstructions (1) and (3) (red
curves) for which Î”ğ‘Ÿ ğ‘€ â‰ˆ âˆ’0.25. They are followed by reconstruc-
tions (2) and (4) (blue curves), which show an improvement of at
most âˆ¼ 7%. As expected from the results in ğœ…, a better scenario is
provided by reconstructions (5) and (7) (green curves), as well as
(6) and (8) (orange curves), for which the relative diï¬€erence is at
most |Î”ğ‘Ÿ ğ‘€ | â‰ˆ 0.08 (8%) and |Î”ğ‘Ÿ ğ‘€ | â‰ˆ 0.01 (1%), respectively. It
is clear that there are not signiï¬cant diï¬€erences between Type 1 and
Type 2 reconstructions.

Blind reconstructions work incredibly well, particularly if one is
interested in the inner region. However, in order to achieve a better
understanding of the outskirts, it is worth using an initial guess other
than the blind one. The drawback relies on what initial guess we use.
For the inner region there are no signiï¬cant eï¬€ects if there are enough
multiply imaged systems close to the mass peaks, but the outskirts are
more sensitive to such changes, where the method presents particular
diï¬ƒculties in scaling down/up to values close to the true ğœ…, coming
from overestimations/underestimations given by the initial guess.

relensing: Reconstructing the mass proï¬le of galaxy clusters from gravitational lensing

11

Figure 3. Convergence maps (ğœ…) for the NIS, given for a source with redshift ğ‘§ğ‘Ÿ = 9. The upper row shows the blind reconstructions without considering the
smoothing, while the middle row shows the blind reconstructions considering the smoothing. The true map is shown in the lower panel.

Figure 4. Relative diï¬€erence Î”ğ‘Ÿ ğœ… between the reconstructed and true convergence maps for the NIS shown in Fig. 3. Here, the red and green solid contours
correspond to Î”ğ‘Ÿ ğœ… = 0.1 and Î”ğ‘Ÿ ğœ… = âˆ’0.1, respectively. Meanwhile, the purple dashed contour delimits the region within which we have multiple images
available.

MNRAS 000, 1â€“24 (2021)

âˆ’101Î¸2(arcmin)Type1s(1)0.30.30.30.51.02.0Type1s+w(2)0.30.30.30.30.30.30.30.30.30.51.02.0Type2s(3)0.30.30.30.51.02.0Type2s+w(4)0.30.30.30.30.30.30.30.30.30.30.30.51.02.0âˆ’101Î¸2(arcmin)Type1s(5)0.30.51.02.0âˆ’101Î¸1(arcmin)Type1s+w(6)0.30.30.51.02.0âˆ’101Î¸1(arcmin)Type2s(7)0.30.51.02.0âˆ’101Î¸1(arcmin)Type2s+w(8)0.30.30.51.02.0âˆ’101Î¸1(arcmin)âˆ’101Î¸2(arcmin)True0.30.30.30.30.51.02.00.00.20.40.60.81.01.21.41.61.82.02.2âˆ’101Î¸2(arcmin)(1)(2)(3)(4)âˆ’101Î¸1(arcmin)âˆ’101Î¸2(arcmin)(5)âˆ’101Î¸1(arcmin)(6)âˆ’101Î¸1(arcmin)(7)âˆ’101Î¸1(arcmin)(8)-1.0-0.8-0.6-0.4-0.20.00.20.40.60.81.012

D. A. Torres-Ballesteros and L. CastaÃ±eda

Figure 5. Convergence maps (ğœ…) for the 2NIS, given for a source with redshift ğ‘§ğ‘Ÿ = 9. The upper row shows the blind reconstructions, while the middle row
shows the reconstructions with an input ğœ“ (0) given by a NIE. For all reconstructions, the smoothing has been considered. The true map is shown in the lower
panel.

Figure 6. Same as in Fig. 4 but for the 2NIS.

MNRAS 000, 1â€“24 (2021)

âˆ’101Î¸2(arcmin)Type1s(1)0.30.51.01.0Type1s+w(2)0.30.51.01.0Type2s(3)0.30.51.01.0Type2s+w(4)0.30.51.01.0âˆ’101Î¸2(arcmin)Type1s(5)0.30.51.01.0âˆ’101Î¸1(arcmin)Type1s+w(6)0.30.30.30.30.51.01.0âˆ’101Î¸1(arcmin)Type2s(7)0.30.51.01.0âˆ’101Î¸1(arcmin)Type2s+w(8)0.30.30.30.30.30.51.01.0âˆ’101Î¸1(arcmin)âˆ’101Î¸2(arcmin)True0.30.51.01.00.00.20.40.60.81.01.21.41.61.82.02.2âˆ’101Î¸2(arcmin)(1)(2)(3)(4)âˆ’101Î¸1(arcmin)âˆ’101Î¸2(arcmin)(5)âˆ’101Î¸1(arcmin)(6)âˆ’101Î¸1(arcmin)(7)âˆ’101Î¸1(arcmin)(8)-1.0-0.8-0.6-0.4-0.20.00.20.40.60.81.0relensing: Reconstructing the mass proï¬le of galaxy clusters from gravitational lensing

13

Figure 7. Mass for the NIS within an angular radius ğœƒ, centered at ğœ½ =
(0, 0) ğ‘ğ‘Ÿ ğ‘ğ‘šğ‘–ğ‘› (upper panel in each ï¬gure), and the relative diï¬€erence Î”ğ‘Ÿ ğ‘€
comparing the reconstructed and true mass (lower panel in each ï¬gure).
The curves are separated depending on the penalty function ğœ’2
ğ‘  used in
the reconstruction, either Type 1 or Type 2. The label s corresponds to
reconstructions where only strong lensing was used, meanwhile the label s+w
stands for reconstructions for which both, strong and weak lensing were used.
Reconstructions with the label (sm) were carried out using the smoothing.
The vertical dashed lines represent the inner and outer radius of the inner
region (purple dashed contour in Fig. 4). The horizontal dashed lines enclose
|Î”ğ‘Ÿ ğ‘€ | â‰¤ 0.1. Here, (sm) stands for those reconstructions for which the
smoothing was applied.

4.3.2 Magniï¬cation

Magniï¬cation maps are key elements in the study of galaxy clusters,
since they are needed to characterize the galaxy cluster, for example,
as a cosmic telescope, since the biggest magniï¬cations occur close
to the critical curves, allowing us to study distant objects. Also, they
help to identify new multiply imaged systems, as well as to extend
those already known. So then, we do not only need the critical curves,
but also the magniï¬cation itself, close to such curves. The quality
of the reconstructed magniï¬cation maps has been studied in e.g.
Meneghetti et al. (2017), where they compare the reconstruction
of the simulated galaxy clusters, Ares and Hera, given by diï¬€erent
methods and approaches, in order to have a better understanding
of the results obtained for the HFF clusters. We present our own
reconstructions for Ares and Hera in Sec. 5.1.

In Fig. 9 and Fig. 11 we have the magniï¬cation maps |ğœ‡| for the
NIS and 2NIS, respectively, Those maps are depicted in concordance
with the convergence maps shown in Fig. 3 and Fig. 5.

Figure 8. Same as in Fig. 7 but for the 2NIS, with the diï¬€erence that here
all reconstructions were carried out using the smoothing. Here, (b) stands for
blind reconstruction.

At critical curves, by deï¬nition ğœ‡ diverges, so that they are depicted
as regions of high |ğœ‡|. Due to this behavior, even true deviations from
true critical curves are expected to make it diï¬ƒcult to accurately
recover ğœ‡.

For the NIS, we have that reconstructions (1) âˆ’ (4) (upper row in
Fig. 9) produce critical curves that actually follow the form and size
of the true ones, but are noisy and quite irregular, particularly the
outer or tangential curve. Such irregularities in fact provide a |ğœ‡| map
with high error close to the critical curves, as it is depicted in Fig.
10 (upper row). Now, by including the smoothing in reconstructions
(5) âˆ’ (8) (middle row in Fig. 9) we can see a better recovery of
critical curves. They are not as smooth as the true ones, but are less
irregular than curves (1) âˆ’ (4). The improvement is not restricted to
the recovery of such critical curves in shape and size, but it extends to
the overall estimation of |ğœ‡|, particularly when weak lensing is used,
as it can be seen for reconstructions (6) and (8) in Fig. 10 (lower
row). Still, the highest deviations in |ğœ‡| appear close to the critical
curves.

Now, with respect to the 2NIS, in Fig. 11 we can see that there are
no signiï¬cant diï¬€erences between the critical curves provided by the
eight reconstructions. All of them provide accurate reproductions of
the critical curves both in shape and size. However, for reconstruc-
tions (5) âˆ’ (8) we get a better reproduction of |ğœ‡| as a whole, as it is
depicted in Fig. 12. Again, the highest deviations appear close to the
critical curves.

Additionally, in Fig. 13 and Fig. 14 we can see the critical and

MNRAS 000, 1â€“24 (2021)

0.01.53.04.56.07.5M(â‰¤Î¸)(Ã—1014M(cid:12))Type1ss+ws(sm)s+w(sm)True0.00.30.60.91.21.5Î¸(arcmin)-0.2-0.10.00.1âˆ†rM0.01.53.04.56.07.5M(â‰¤Î¸)(Ã—1014M(cid:12))Type2ss+ws(sm)s+w(sm)True0.00.30.60.91.21.5Î¸(arcmin)-0.2-0.10.00.1âˆ†rM0.01.53.04.56.07.5M(â‰¤Î¸)(Ã—1014M(cid:12))Type1s(b)s+w(b)ss+wTrue0.00.30.60.91.21.5Î¸(arcmin)-0.2-0.10.00.1âˆ†rM0.01.53.04.56.07.5M(â‰¤Î¸)(Ã—1014M(cid:12))Type2s(b)s+w(b)ss+wTrue0.00.30.60.91.21.5Î¸(arcmin)-0.2-0.10.00.1âˆ†rM14

D. A. Torres-Ballesteros and L. CastaÃ±eda

Figure 9. Magniï¬cation maps ( |ğœ‡ |) for the NIS, given for a source with redshift ğ‘§ğ‘Ÿ = 9. They correspond to the reconstructions shown in Fig. 3. The true map
is shown in the lower panel.

Figure 10. Relative diï¬€erence Î”ğ‘Ÿ |ğœ‡ | between the reconstructed and true magniï¬cation maps for the NIS shown in Fig. 9. Here, the red and green solid contours
correspond to Î”ğ‘Ÿ ğœ… = 0.2 and Î”ğ‘Ÿ ğœ… = âˆ’0.2, respectively. The black solid lines depict the true critical curves.

MNRAS 000, 1â€“24 (2021)

âˆ’101Î¸2(arcmin)(1)(2)(3)(4)âˆ’101Î¸2(arcmin)(5)âˆ’101Î¸1(arcmin)(6)âˆ’101Î¸1(arcmin)(7)âˆ’101Î¸1(arcmin)(8)âˆ’101Î¸1(arcmin)âˆ’101Î¸2(arcmin)True01020304050âˆ’101Î¸2(arcmin)(1)(2)(3)(4)âˆ’101Î¸1(arcmin)âˆ’101Î¸2(arcmin)(5)âˆ’101Î¸1(arcmin)(6)âˆ’101Î¸1(arcmin)(7)âˆ’101Î¸1(arcmin)(8)-1.0-0.8-0.6-0.4-0.20.00.20.40.60.81.0relensing: Reconstructing the mass proï¬le of galaxy clusters from gravitational lensing

15

Figure 11. Same as in Fig. 9 but for the 2NIS.

Figure 12. Same as in Fig. 10 but for the 2NIS.

MNRAS 000, 1â€“24 (2021)

âˆ’101Î¸2(arcmin)(1)(2)(3)(4)âˆ’101Î¸2(arcmin)(5)âˆ’101Î¸1(arcmin)(6)âˆ’101Î¸1(arcmin)(7)âˆ’101Î¸1(arcmin)(8)âˆ’101Î¸1(arcmin)âˆ’101Î¸2(arcmin)True01020304050âˆ’101Î¸2(arcmin)(1)(2)(3)(4)âˆ’101Î¸1(arcmin)âˆ’101Î¸2(arcmin)(5)âˆ’101Î¸1(arcmin)(6)âˆ’101Î¸1(arcmin)(7)âˆ’101Î¸1(arcmin)(8)-1.0-0.8-0.6-0.4-0.20.00.20.40.60.81.016

D. A. Torres-Ballesteros and L. CastaÃ±eda

Figure 13. Comparison between the reconstructed (blue) and true (red) crit-
ical (upper row) and caustic (lower row) curves for the NIS. The curves are
given for the reconstructions (6) and (8).

Figure 14. Same as in Fig. 13 but for the 2NIS.

caustic curves for the NIS and 2NIS, respectively, given for recon-
structions (6) and (8); which have shown the best performance as a
hole for both lenses. The critical curves have been computed apply-
ing the algorithm discussed in Bartelmann (2003). With respect to
the caustic curves, we have a good agreement with the true curves.
However, they are aï¬€ected by the irregularities in the critical curves.
This is particularly evident for the NIS, where the tangential critical

MNRAS 000, 1â€“24 (2021)

curve is supposed to be mapped into a point, but instead the recon-
structed caustic is wider and more irregular. This eï¬€ect has to be
taken into account when one is interested in predicting the existence
of new images or multiply imaged systems, as well as when it comes
to verifying the reproduction of the input data.

It is worth noting that transformation (18) does not aï¬€ect the re-
covery of neither the critical curves nor the convergence map and
thus the mass proï¬le, since ğœ… and ğ›¾ are invariant under this trans-
formation. Nevertheless, ğœ¶ is not invariant, since ğœ¶ â†’ ğœ¶(cid:48) = ğœ¶ + ğ’„
translates the source plane. It is not an observable, but it results in a
translation of the caustic curves. We see that ï¬xing the correspond-
ing three degrees of freedom allows the reconstruction to properly
account for the caustic curves, as we have in Fig. 13 and Fig. 14
(lower row).

5 REALISTIC DISTRIBUTIONS: ARES AND HERA

At this point, we have explored under which conditions relensing
provides the best performance in its current state, by exploring the
reconstructions of the NIS and 2NIS. We move forward in order to
explore the validity of the reconstructions provided by relensing
in more realistic scenarios. We focus on the simulated clusters Ares
and Hera, which are intended to reproduce the complex structures
and lensing properties observed in the Hubble Frontier Fields (HFF)
clusters.

Ares is shown in Fig. 15 (left panel). It corresponds to a cluster
with redshift ğ‘§ğ‘™ = 0.5, for which a semi-analytical approach was used
for its simulation, under a ï¬‚at Î›CDM cosmology with density param-
eter Î©ğ‘š,0 = 0.272 and Hubble constant ğ»0 = 70.4 ğ‘˜ğ‘š ğ‘ âˆ’1 ğ‘€ ğ‘ğ‘âˆ’1.
Ares is characterized by two main distributions or main deï¬‚ec-
tors (MD) located at â‰ˆ (âˆ’0.335, âˆ’0.525) ğ‘ğ‘Ÿğ‘ğ‘šğ‘–ğ‘› (MD 1) and
â‰ˆ (0.666, 0.666) ğ‘ğ‘Ÿğ‘ğ‘šğ‘–ğ‘› (MD 2). Also, it is rich in well deï¬ned
substructures as it is shown in Fig. 16 (lower panel).

On the other hand, Hera, with redshift ğ‘§ğ‘™ = 0.507 is shown in Fig.
15 (right panel). Unlike Ares, the simulation of Hera was carried out
using a N-body approach, under a ï¬‚at Î›CDM cosmology with den-
sity parameters Î©ğ‘š,0 = 0.24, Î©ğ‘,0 = 0.04 and Hubble constant ğ»0 =
72 ğ‘˜ğ‘š ğ‘ âˆ’1 ğ‘€ ğ‘ğ‘âˆ’1. Like Ares, Hera shows two prominent peaks cor-
responding to the MD, located at â‰ˆ (âˆ’0.001, 0.015) ğ‘ğ‘Ÿğ‘ğ‘šğ‘–ğ‘› (MD
1) and â‰ˆ (âˆ’0.361, 0.045) ğ‘ğ‘Ÿğ‘ğ‘šğ‘–ğ‘› (MD 2). It also exhibits a clear
substructure at â‰ˆ (0.113, âˆ’0.883) ğ‘ğ‘Ÿğ‘ğ‘šğ‘–ğ‘›, whose inï¬‚uence appears
in the convergence map Fig. 17 (lower panel), as well as in the mag-
niï¬cation map Fig. 22 (lower panel).

See Meneghetti et al. (2017) and the references therein for further
details on how the simulations of Ares and Hera were carried out, as
well as their lensing properties.

5.1 Reconstruction

For Ares, in the strong regime, there is available a catalogue that
consists of 85/242 systems/images. This amount of constraints ex-
ceeds those found e.g in the HFF clusters, for which the number
of constrains used/identiï¬ed for their reconstructions have been e.g.
60/188 systems/images in Mahler et al. (2018) for Abell 2744, 45/138
systems/images in Lagattuta et al. (2019) for Abell 370, 19/52 sys-
tems/images in Karman et al. (2017) for Abell S1063, 48/138 sys-
tems/images in Bergamini et al. (2021); Vanzella et al. (2021) for
MACS J0416.1- 2403 (MACS 0416), 60/165 systems/images in
Limousin et al. (2016) for MACS J0717.5+ 3745 (MACS 0717), and
45/143 systems/images in Jauzac et al. (2016) for MACS J1149.5+
2223 (MACS 1149). The number of systems/images actually used for

-1.0-0.50.00.51.0Î¸1(arcmin)-1.0-0.50.00.51.0Î¸2(arcmin)(6)-1.0-0.50.00.51.0Î¸2(arcmin)(8)-0.4-0.20.00.20.4Î²1(arcmin)-0.4-0.20.00.20.4Î²2(arcmin)(6)-0.4-0.20.00.20.4Î²1(arcmin)(8)-1.0-0.50.00.51.0Î¸1(arcmin)-1.0-0.50.00.51.0Î¸2(arcmin)(6)-1.0-0.50.00.51.0Î¸2(arcmin)(8)-0.4-0.20.00.20.4Î²1(arcmin)-0.4-0.20.00.20.4Î²2(arcmin)(6)-0.4-0.20.00.20.4Î²1(arcmin)(8)relensing: Reconstructing the mass proï¬le of galaxy clusters from gravitational lensing

17

Figure 15. Images of Ares (left panel) and Hera (right panel) which have been composed from the F435W, F606W and F814W bands. The blue contours enclose
the multiple images, while the red dashed contours enclose the main deï¬‚ectors. The images cover 3.4 Ã— 3.4 ğ‘ğ‘Ÿ ğ‘ğ‘šğ‘–ğ‘›2.

the reconstructions is usually smaller, depending on the uncertainty
in their identiï¬cation. For the weak regime the ellipticities redshifts
are not available. Hence, we only use the strong regime for Ares
reconstructions.

In the case of Hera, for the strong regime we have fewer constraints,
being 19/65 systems/images. The impact on the number of constraints
is noticeable in the reconstruction, as we discuss below. Here, for the
weak regime the redshifts are available, therefore, for Hera we use
both strong and weak regimes to preform the reconstruction. The
reconstruction takes place in a region of 3.4 Ã— 3.4 ğ‘ğ‘Ÿğ‘ğ‘šğ‘–ğ‘›2 for which
we have 123 sources with their ellipticity and redshift.

relensing approaches the reï¬nement of the grid with respect
to the main deï¬‚ectors. So then, in order to identify what cluster
members can be considered as main deï¬‚ectors, one can simply apply
a quick blind reconstruction, which will show the peaks of mass
corresponding to those main deï¬‚ectors. Following this process, we
identiï¬ed the two main deï¬‚ectors present in Ares, as well as in Hera.
Then, we estimated their location, which were aforementioned.

Now, with respect to the reconstructions, for each cluster we take
as initial guess a NIE as well as a 2NIE; since both cluster have two
main deï¬‚ectors. Additionally, from our previous experience with
the NIS and 2NIS we have that Type 1 and Type 2 reconstructions
produce similar results. Hence, it is best to let them work together.

Considering the input potential and the type of reconstruction,
we are left with four combinations to carry out the reconstructions,
namely NIE + Type 1, NIE + Type 2, 2NIE + Type 1, and 2NIE
+ Type 2. For each combination we perform 10 realizations of the
reconstructions, which give us 40 reconstructions in total. The re-
sults we show in this section correspond to the average of those 40
reconstructions. We do this for Ares and Hera.

The conditions to perform the reconstructions are the same for
Areas and Hera. For all realizations we consider the smoothing.
We consider an initial grid of size ğ‘›ğ‘¥ Ã— ğ‘›ğ‘¦ nodes over a region of
3.4 Ã— 3.4 ğ‘ğ‘Ÿğ‘ğ‘šğ‘–ğ‘›2; which covers the region shown in Fig. 15. Since
we are working on a square region, we consider ğ‘›ğ‘¥ = ğ‘›ğ‘¦, which are

randomly selected between 20 âˆ’ 25 nodes. Likewise, ğœ‚ğœ… = ğœ‚ğ›¾ are
randomly selected between 100 âˆ’ 200.

With respect to the reï¬nement process, we add ğ‘ğ‘‘ new nodes for
each reï¬nement for each main deï¬‚ector, which is randomly between
300âˆ’500. Such nodes are distributed with ğœğ‘‘ = 1 ğ‘ğ‘Ÿğ‘ğ‘šğ‘–ğ‘›, and ğ‘…ğ‘‘ =
2 ğ‘ğ‘Ÿğ‘ğ‘šğ‘–ğ‘›. The adaptive reï¬nement was done with ğ‘Ÿğ‘‘ = 0.2 ğ‘ğ‘Ÿğ‘ğ‘šğ‘–ğ‘›
and ğ‘¢ = 0.8. For the ï¬nite diï¬€erences we use ğ‘„ = 25 nodes.

We have used almost the same parameters that we used for the NIS
and 2NIS, except for ğ‘›ğ‘¥, ğ‘›ğ‘¦, ğœ‚ğœ… , ğœ‚ğ›¾, and ğ‘ğ‘‘, which were drawn from
a uniform distribution deï¬ned in the given ranges. The selection took
place for each realization of the reconstruction.

5.1.1 Convergence

In Fig. 16 we ï¬nd the reconstructed (left panel) and true (right panel)ğœ…
maps for Ares. It is clear that our reconstruction retrieves successfully
the two MD, as well as the general morphological characteristics
found in Ares. However, the reconstructions cannot account for the
rich substructure present in Ares.

Within the inner region we have that most of such region satisï¬es
|Î”ğ‘Ÿ ğœ…| < 0.1 (10%) as it is depicted in Fig. 18 (left panel), where we
also can ï¬nd few regions for which 0.1 (10%) â‰¤ Î”ğ‘Ÿ ğœ… â‰¤ 0.2 (20%)
(red contour) and âˆ’0.2 (20%) â‰¤ Î”ğ‘Ÿ ğœ… â‰¤ âˆ’0.1 (10%) (green contour).
Beyond that, we have |Î”ğ‘Ÿ ğœ…| > 0.2 (20%) at those locations with sub-
structure. Outside the inner region the quality of the reconstruction
decreases as expected, since we are using strong lensing only. The
discrepancy is higher towards the upper left and lower right corners,
due to the lack of observations there, as we can see in Fig. 15 (left
panel).

For Hera, we can see in Fig. 17 that our reconstruction (left panel)
recovers both MD, as well as the general shape and size shown
by Hera. However, they do not exhibit the substructure (enclosed
by the white dashed curve) found in the true proï¬le (right panel).
In Fig.18 (right panel) we can see that such substructure (enclosed
by the black dashed curve) lies outside the inner region, so that

MNRAS 000, 1â€“24 (2021)

-1.5-1.0-0.50.00.51.01.5Î¸1(arcmin)-1.5-1.0-0.50.00.51.01.5Î¸2(arcmin)MD1MD2Ares-1.5-1.0-0.50.00.51.01.5Î¸1(arcmin)-1.5-1.0-0.50.00.51.01.5Î¸2(arcmin)MD1MD2Hera18

D. A. Torres-Ballesteros and L. CastaÃ±eda

Figure 16. Convergence maps (ğœ…) for Ares, given for a source with redshift ğ‘§ğ‘Ÿ = 9. The reconstruction and true map are shown respectively in the left and right
panels.

Figure 17. Same as in Fig. 16 but for Hera. The white dashed contour encloses the substructure present in the true map of Hera (right panel), and which is not
recovered by the reconstruction (left panel).

there are not multiple images there that allow relensing to ac-
count for it. Therefore, the absence of this substructure is due to
the lack of data there, and not a consequence of the reconstruction
method used. This behaviour is consistent with the reconstructions
discussed in Meneghetti et al. (2017). Now, similarly to Ares, we
can see that |Î”ğ‘Ÿ ğœ…| < 0.1 (10%), for most of the inner region, with
few regions where 0.1 (10%) â‰¤ Î”ğ‘Ÿ ğœ… â‰¤ 0.2 (20%) (red contour) and
âˆ’0.2 (20%) â‰¤ Î”ğ‘Ÿ ğœ… â‰¤ âˆ’0.1 (10%) (green contour). For the substruc-
ture we have Î”ğ‘Ÿ ğœ… > âˆ’0.3 (30%).

In addition, for both Ares and Hera we can see in Fig. 18 that our
reconstructions present a deviation |Î”ğ‘Ÿ ğœ…| (cid:39) 0.1 (10%) around the
MD (violet solid contours), where the underestimations are present
at the exact location of the MD (green contours).

With respect to ğ‘€, it is computed in the range 0 ğ‘ğ‘Ÿğ‘ğ‘šğ‘–ğ‘› â‰¤ ğœƒ â‰¤
1.7 ğ‘ğ‘Ÿğ‘ğ‘šğ‘–ğ‘›. For Ares, the maximum relative diï¬€erence that our
reconstruction produces is |Î”ğ‘Ÿ ğ‘€ | â‰ˆ 0.024 (2.4%), which appears

close to the center of the distribution. The deviation from the true ğ‘€
is stable even between ğœƒğ‘–ğ‘› â‰ˆ 1 ğ‘ğ‘Ÿğ‘ğ‘šğ‘–ğ‘› â‰¤ ğœƒ â‰¤ ğœƒğ‘œğ‘¢ğ‘¡ â‰ˆ 1.56 ğ‘ğ‘Ÿğ‘ğ‘šğ‘–ğ‘›,
and it starts to deviate beyond ğœƒğ‘œğ‘¢ğ‘¡ , as we saw for the NIS and 2NIS.
For Hera, we can see in Fig. 20 that the deviation from the true ğ‘€
gets its higher value |Î”ğ‘Ÿ ğœ…| â‰ˆ 0.12 (12%) for ğœƒ < 0.2 ğ‘ğ‘Ÿğ‘ğ‘šğ‘–ğ‘›, which
approximately coincides with the mass estimation for MD 1; since
it is located close to the image center. This behaviour is expected
from how the convergence behaves close to the MD, where, as we
mentioned above, it presents a underestimation |Î”ğ‘Ÿ ğœ…| (cid:39) 0.1 (10%),
which translates in a underestimation in ğ‘€ with the same range of
error. Beyond such underestimation, the diï¬€erence decreases rapidly,
achieving |Î”ğ‘Ÿ ğœ…| â‰ˆ 0 (0%). Between ğœƒğ‘–ğ‘› â‰ˆ 0.38 ğ‘ğ‘Ÿğ‘ğ‘šğ‘–ğ‘› â‰¤ ğœƒ â‰¤
ğœƒğ‘œğ‘¢ğ‘¡ â‰ˆ 0.82 ğ‘ğ‘Ÿğ‘ğ‘šğ‘–ğ‘› again ğ‘€ starts to deviate from its true value,
getting up to |Î”ğ‘Ÿ ğ‘€ | â‰ˆ 0.05 (5%) beyond ğœƒğ‘œğ‘¢ğ‘¡ .

Among the reconstructions discussed in Meneghetti et al. (2017),
we compare our results to those reconstructions produced with

MNRAS 000, 1â€“24 (2021)

âˆ’1.5âˆ’1.0âˆ’0.50.00.51.01.5Î¸1(arcmin)âˆ’1.5âˆ’1.0âˆ’0.50.00.51.01.5Î¸2(arcmin)Reconstruction0.30.30.30.51.01.02.0âˆ’1.5âˆ’1.0âˆ’0.50.00.51.01.5Î¸1(arcmin)True0.30.30.30.30.30.30.30.30.50.50.51.01.01.02.02.02.00.00.51.01.52.02.53.0âˆ’1.5âˆ’1.0âˆ’0.50.00.51.01.5Î¸1(arcmin)âˆ’1.5âˆ’1.0âˆ’0.50.00.51.01.5Î¸2(arcmin)Reconstruction0.30.51.02.02.0âˆ’1.5âˆ’1.0âˆ’0.50.00.51.01.5Î¸1(arcmin)True0.30.30.30.30.30.30.30.50.51.02.02.00.00.51.01.52.02.53.0relensing: Reconstructing the mass proï¬le of galaxy clusters from gravitational lensing

19

Figure 18. Relative diï¬€erence Î”ğ‘Ÿ ğœ… between the reconstructed and true convergence maps for Ares (left panel), as well as for Hera (right panel). Here, the red
and green solid contours correspond to Î”ğ‘Ÿ ğœ… = 0.1 and Î”ğ‘Ÿ ğœ… = âˆ’0.1, respectively. The purple dashed contour delimits the region within which we have multiple
images available. Additionally, the solid violet contours enclose the main deï¬‚ectors. Here, the black dashed contour encloses the substructure present in Hera
(left panel).

Figure 19. Mass for Ares within an angular radius ğœƒ, centered at ğœ½ =
(0, 0) ğ‘ğ‘Ÿ ğ‘ğ‘šğ‘–ğ‘› (upper panel), and the relative diï¬€erence Î”ğ‘Ÿ ğ‘€ comparing
the reconstructed and true mass (lower panel). The vertical dashed lines rep-
resent the inner and outer radius of the inner region (purple dashed contour
in Fig. 18 left). The horizontal dashed lines enclose |Î”ğ‘Ÿ ğ‘€ | â‰¤ 0.05.

SWUnited, since SWUnited and relensing are based on the same
principles. In Meneghetti et al. (2017) they labeled the reconstruc-
tions produced with SWUnited as Bradac-Hoag models. Here, we
will refer to them as BHm.

The ğœ… maps given by BHm (for a source with redshift ğ‘§ğ‘Ÿ = 9)
for Ares and Hera are depicted respectively in Fig. 7 (upper let
panel) and Fig. 8 (upper left panel) in Meneghetti et al. (2017). One
can see that for Ares their reconstruction shows a more irregular
shape, and noisier contour curves than our reconstruction. In the
case of Hera, BHm is smoother than the one given for Ares, however,
their reconstruction exhibits a substructure close to MD 1 that is not
present in the true distribution. This extra substructure is not present
in our reconstructions, as it is clear from Fig. 17. For BHm as well,
the substructure present in Hera was not recovered.

Figure 20. Same as in Fig. 19 but for Hera.

5.1.2 Magniï¬cation

In Fig. 21 we can see the magniï¬cation maps for Ares, where the
reconstruction is shown in the left panel, and the true map in the
right panel. The external curve of high |ğœ‡| exhibits an elongated
shape, within which there is one internal curve surrounding each
MD. The main diï¬€erence appears close to the MD 2, where we get
an overestimation of |ğœ‡|. Such overestimation coincides with a true
critical curve, as one can notice by direct comparison between the true
(red) and reconstructed (blue) critical curves in Fig. 24 (upper left
panel). Despite this overestimation, we are not able to retrieve such
critical curve. It is worth mentioning that it is possible to reproduce
such critical curve by forcing the reconstruction parameters, where
its presence is more frequent for Type 2 reconstructions. Nonetheless,
in practice we are not aware of these details, so that the best we can
do is to use the parameters that provide the best overall outcome.

It is clear that our reconstruction recovers the orientation, shape
and size of such critical curves with great accuracy. Additionally, the

MNRAS 000, 1â€“24 (2021)

âˆ’1.5âˆ’1.0âˆ’0.50.00.51.01.5Î¸1(arcmin)âˆ’1.5âˆ’1.0âˆ’0.50.00.51.01.5Î¸2(arcmin)Aresâˆ’1.5âˆ’1.0âˆ’0.50.00.51.01.5Î¸1(arcmin)âˆ’1.5âˆ’1.0âˆ’0.50.00.51.01.5Î¸2(arcmin)Hera-1.0-0.8-0.6-0.4-0.20.00.20.40.60.81.00.00.30.60.91.2M(â‰¤Î¸)(Ã—1015M(cid:12))ReconstructionTrue0.00.30.60.91.21.5Î¸(arcmin)-0.050.000.05âˆ†rM0.01.53.04.56.0M(â‰¤Î¸)(Ã—1014M(cid:12))ReconstructionTrue0.00.30.60.91.21.5Î¸(arcmin)-0.10-0.050.000.05âˆ†rM20

D. A. Torres-Ballesteros and L. CastaÃ±eda

Figure 21. Magniï¬cation maps (|ğœ‡ |) for Ares, given for a source with redshift ğ‘§ğ‘Ÿ = 9. They correspond to the maps shown in Fig. 16. The true map is shown in
the left panel.

Figure 22. Same as in Fig. 21 but for Hera. Here, the black dashed contour encloses the critical curve produced by the substructure present in Hera.

critical curves corresponding to the substructure cannot be recovered,
since it is diï¬ƒcult to account for such detailed peaks from the limited
information provided by strong lensing.

For Hera, its magniï¬cation maps are shown in Fig. 22. In general
terms, our reconstruction is capable of recovering the main features
shown by the true map (Fig. 22 left panel), except for the curve (sur-
rounded by the white dashed contour) produced by the substructure
present in Hera, which our reconstruction fail to account for. As we
discussed above, it is not possible to account for such substructure,
due to the lack of observations there. Besides such curve, the exter-
nal critical curve exhibits an elongated shape with one inner curve
surrounding each MD; similarly to Ares. Fig. 24 (upper right panel)
shows the direct comparison between true (red) and reconstructed
(blue) critical curves. It is clear that the shape, and size of the main
curves are reproduced by our reconstruction.

Since for Hera we have fewer systems/images than for Ares, it is
expected for us to obtain less accurate curves. This can be seen in the

external curve, where at its ends the reconstructions fail to accurately
reproduce its shape. This becomes more evident in the critical curves,
as it is depicted in Fig. 24 (upper left panel). Nonetheless, our results
are incredibly accurate, considering that the only assumption that we
have made with respect to the cluster itself relies on the NIE and
2NIE used as input. Beyond that, the reconstructions just adapt to the
observations.

From Fig. 23 it is clear again that the higher diï¬€erence between the
true and reconstructed |ğœ‡| maps is produced close to the true critical
curves (solid black lines), where the deviation from the true curves
shows the overestimation in |ğœ‡| associated with the presence of the
reconstructed critical curves. This is more evident for Hera.

Now, moving to the source plane, in Fig. 24 we have the true
(red) and predicted (blue) caustic curves for Ares (lower left panel)
and Hera (lower right panel). We successfully recover the overall
morphological characteristics present in the caustic curves, except for

MNRAS 000, 1â€“24 (2021)

âˆ’1.5âˆ’1.0âˆ’0.50.00.51.01.5Î¸1(arcmin)âˆ’1.5âˆ’1.0âˆ’0.50.00.51.01.5Î¸2(arcmin)Reconstructionâˆ’1.5âˆ’1.0âˆ’0.50.00.51.01.5Î¸1(arcmin)True01020304050âˆ’1.5âˆ’1.0âˆ’0.50.00.51.01.5Î¸1(arcmin)âˆ’1.5âˆ’1.0âˆ’0.50.00.51.01.5Î¸2(arcmin)Reconstructionâˆ’1.5âˆ’1.0âˆ’0.50.00.51.01.5Î¸1(arcmin)True01020304050relensing: Reconstructing the mass proï¬le of galaxy clusters from gravitational lensing

21

Figure 23. Relative diï¬€erence Î”ğ‘Ÿ |ğœ‡ | between the reconstructed and true magniï¬cation maps for Ares (left panel) and Hera (right panel). The red and green solid
contours correspond to Î”ğ‘Ÿ ğœ… = 0.2 and Î”ğ‘Ÿ ğœ… = âˆ’0.2, respectively. The black solid lines depict the true critical curves. Additionally, the black dashed contour
encloses the critical curve produced by the substructure present in Hera.

those curves associated with substructure. Our curves are deviated
from the true ones, which is a consequence of (18).

Now, for the |ğœ‡| maps given by BHm, which are shown for Ares and
Hera respectively in Fig. 19 (upper left panel) and Fig. 20 (upper left
panel) in Meneghetti et al. (2017), it is clear that the irregularities
present in Ares produce equally irregular critical curves. BHm is
capable of reproducing the curves around the MD, and the external
curve follows the orientation of the true curve. Nonetheless, the
external curve produces several regions of high magniï¬cation that do
not follow the true map. In contrast, our reconstruction has produced
smoother curves which present less deviations from true critical
curves. On the other hand, the BHm of Hera shows a critical curve
related to the substructure present in their reconstruction, which is
absent in the true map. Since our reconstruction does not present
such substructure, it lacks that critical curve.

Lastly, we consider the root-mean-square (rms) on the lens plane,

deï¬ne as

Î”ğ‘Ÿ ğ‘šğ‘  =

(cid:118)(cid:117)(cid:117)(cid:116) 1
Ëœğ‘img

ğ‘ğ‘ 
âˆ‘ï¸

Ëœğ‘ğ‘–
âˆ‘ï¸

ğ‘–=1

ğ‘›=1

(cid:12)
(cid:12)ğœ½ğ‘–ğ‘› âˆ’ ğœ½ (cid:48)
(cid:12)

ğ‘–ğ‘›

(cid:12)
2
(cid:12)
(cid:12)

,

(70)

ğ‘–

where Ëœğ‘ğ‘– is the number of reproduced images corresponding to the
ğ‘–-th multiply imaged system, and Ëœğ‘img = (cid:205)ğ‘ğ‘ 
Ëœğ‘ğ‘– is the total number
of multiple images recovered from the reconstruction. Recall that ğ‘ğ‘ 
is the number of multiple imaged systems used in the reconstruction,
as well, ğœ½ğ‘–ğ‘› and ğœ½ (cid:48)
ğ‘–ğ‘› are the ğ‘›-th reconstructed and true angular
position of the ğ‘–-th multiply imaged system, respectively. In general,
Ëœğ‘img â‰  ğ‘img, since it is possible to get an excess or lack of multiple
images. In case of getting an excess of multiple images, we discard
those which are outside a given neighborhood with respect to the
closest true image.

A small rms is an indication of how well the reconstruction repro-
duces the input image positions. However, in practice it is perhaps
more important to get a small prediction rms (prms), which is com-
puted for a set of multiply imaged systems which were not considered
as input data. Now, take into account that, as it is discussed in e.g
Williams et al. (2018), a small rms by itself is a necessary but not
suï¬ƒcient criteria to qualify the overall quality of the reconstruction,

particularly since it may be the indication of an overï¬tting of the
intrinsic noise in the data. Thus, it becomes necessary to get small
values for both, rms and prms. For further details in this regard see
e.g James et al. (2013). We left the study of the prediction power of
relensing for another paper.

For Ares we have Î”ğ‘Ÿ ğ‘šğ‘  â‰ˆ 0.17 ğ‘ğ‘Ÿğ‘ğ‘ ğ‘’ğ‘ with Ëœğ‘img = 240 out of the
total ğ‘img = 242. Meanwhile, for Hera we get Î”ğ‘Ÿ ğ‘šğ‘  â‰ˆ 0.16 ğ‘ğ‘Ÿğ‘ğ‘ ğ‘’ğ‘
with Ëœğ‘img = ğ‘img = 65. Considering the rms aforementioned, as
well as the reproduction of the diï¬€erent properties of Ares and Hera
discussed up to here, we are conï¬dent to say that relensing is
capable of producing accurate reproduction of the mass distributions
of galaxy clusters, and their properties as gravitational lens.

6 SUMMARY AND CONCLUSIONS

In this work we describe and test a free-form method which makes use
of gravitational lensing in order to produce an estimation of the mass
proï¬le of galaxy clusters, as well as its properties as a gravitational
lens. In addition, we note that this approach does not consider that
mass traces light; commonly assumed in parametric methods. This
approach is an extension of the method presented in BradaÄ et al.
(2005a, 2009), which at the same time is an extension of the work
discussed in Bartelmann et al. (1996).

Here, we use an irregular and adaptive grid that is intended to pro-
duce a higher resolution around those mass peaks (main deï¬‚ectors)
responsible for most of the strong lensing eï¬€ect, as well as around
the multiple images. Additionally, we have opted for an alternative
ï¬nite diï¬€erence approach (generalized ï¬nite diï¬€erence). Moreover,
we include two diï¬€erent ways of computing the penalty function ğœ’2
ğ‘  ,
which we have named Type 1 and Type 2.

We start by testing our approach on two simple distributions; a
NIS and 2NIS, in order to explore the set of input parameters that
take us to reliable results. With them, we also explore the impact that
the input deï¬‚ection potential has on the reconstructions, where we
use a blind reconstruction and a NIE. Within the region delimited by
the available multiple images (inner region) there are no major dif-
ferences. However, for blind reconstructions it is diï¬ƒcult to scale up

MNRAS 000, 1â€“24 (2021)

âˆ’1.5âˆ’1.0âˆ’0.50.00.51.01.5Î¸1(arcmin)âˆ’1.5âˆ’1.0âˆ’0.50.00.51.01.5Î¸2(arcmin)Aresâˆ’1.5âˆ’1.0âˆ’0.50.00.51.01.5Î¸1(arcmin)âˆ’1.5âˆ’1.0âˆ’0.50.00.51.01.5Î¸2(arcmin)Hera-1.0-0.8-0.6-0.4-0.20.00.20.40.60.81.022

D. A. Torres-Ballesteros and L. CastaÃ±eda

Figure 24. Comparison between the reconstructed (blue) and true (red) critical (upper row) and caustic (lower row) curves for Ares (left panels) and Hera (right
panels). The black dashed contour encloses the critical (upper right panel) and caustic (lower right panel) curves produced by the substructure present in Hera.

outside the inner region. The introduction of weak lensing improves
the reconstruction on such region, but there is still a lack of mass
towards the outskirts. The NIE helps to extend the reconstruction
outside the inner region along with weak lensing, where for the 2NIS
we get an improvement in the mass estimation of âˆ¼ 7%. For ğœ… most
of the region presents an estimation that lies below âˆ¼ 20%, with just
a few sectors mainly close to the boundaries where we get higher
values. Thus, the choice of ğœ“ (0) does not aï¬€ect signiï¬cantly the
reconstruction where strong lensing is dominant. However, outside
such region the reconstruction is more susceptible to ğœ“ (0) . If ğœ“ (0)
corresponds to an overestimation of ğœ… that moves away from the true
map, it becomes diï¬ƒcult for the reconstruction to scale down towards
the true value. The opposite eï¬€ect occurs in blind reconstructions.

We also show that by recomputing the deï¬‚ection potential from
the weight of every node; i.e by using (12), we are able to smooth
the shape of convergence and magniï¬cation maps, which otherwise
tend to be quite irregular and noisy. For instance, the overall rela-
tive diï¬€erence Î”ğ‘Ÿ ğœ… and Î”ğ‘Ÿ ğœ‡ improves. We refer to this process as
smoothing.

This smoothing improves the power of this free-form approach,

which we also test on Ares and Hera Meneghetti et al. (2017), two
simulated galaxy clusters, which provide a more realistic framework
to prove the reliability of our reconstructions. Our results show an
improvement with respect to e.g. BHm (Bradac-Hoag models) in
Meneghetti et al. (2017), where we get less irregular proï¬les and
magniï¬cation maps, which turns into a more accurate reconstruction
of these distributions.

Among the reconstructions discussed in this work, we have that
within the inner region the reconstructions mainly satisfy |Î”ğ‘Ÿ ğœ…| <
0.1 (10%), with 0.1 (10%) < Î”ğ‘Ÿ ğœ… < 0.2 (20%) mostly close to
inner region boundary. Higher values are obtained most likely where
small substructures are located, like in Ares. When weak lensing
is included, the reconstruction provides a more accurate estimation
of the mass proï¬le outside the inner region. For |ğœ‡|, the higher
discrepancies appear close to the critical curves, as expected due to
their nature. The morphological properties of the critical and caustic
curves do not show signiï¬cant changes when weak lensing is also
used in the reconstruction.

Our reconstructions have shown to be capable of recovering the
orientation, shape, and size of critical curves, despite the irregulari-

MNRAS 000, 1â€“24 (2021)

âˆ’1.5âˆ’1.0âˆ’0.50.00.51.01.5Î¸1(arcmin)âˆ’1.5âˆ’1.0âˆ’0.50.00.51.01.5Î¸2(arcmin)Aresâˆ’1.0âˆ’0.50.00.5Î¸1(arcmin)âˆ’1.0âˆ’0.50.00.51.0Î¸2(arcmin)Heraâˆ’0.8âˆ’0.40.00.40.8Î²1(arcmin)âˆ’0.9âˆ’0.6âˆ’0.30.00.30.60.9Î²2(arcmin)âˆ’0.6âˆ’0.4âˆ’0.20.00.2Î²1(arcmin)âˆ’0.4âˆ’0.20.00.20.4Î²2(arcmin)relensing: Reconstructing the mass proï¬le of galaxy clusters from gravitational lensing

23

ties present in the reconstructions. We have found a way of reducing
such irregularities by means of the smoothing. Nevertheless, since
critical curves are sensitive to variations by nature, they might pro-
duce high deviations in |ğœ‡|; even if such variations are small. This is
a problem that requires further improvement.

We have seen that Type 1 and Type 2 reconstructions produce
similar results, except for some minor diï¬€erences that are related to
the input parameters. Therefore, it is best to use both types of recon-
struction for a given galaxy cluster, which is done by taking several
realizations of the reconstruction for each type of reconstruction
combined with diï¬€erent initial deï¬‚ection potentials (if convenient).
If this is done, it is also convenient to use random seeds for some
input parameters. Then, by averaging such realizations, the result is
even more accurate. This process becomes convenient considering
the random nature of the grid along the reconstruction.

We followed this approach for Ares and Hera, where we used the
NIE and 2NIE as an initial guess, so that we averaged 40 realizations
of the reconstructions for each cluster. As a result, we got a rms on
the lens plane of about 0.17 ğ‘ğ‘Ÿğ‘ğ‘ ğ‘’ğ‘ and 0.16 ğ‘ğ‘Ÿğ‘ğ‘ ğ‘’ğ‘ for Ares and
Hera. Also, we were able to recover 240 of the 242 images used in
Ares, and all the images used in Hera.

relensing has shown an incredible capability in terms of pro-
ducing an accurate estimation of the mass proï¬le of galaxy clusters,
along with their properties as gravitational lens. Therefore, with this
work we expect to provide an accessible package written in python,
focused on the characterization of galaxy clusters by using gravi-
tational lensing. This provides users with a wider range of options
to choose from, which becomes indispensable in order to validate
physical results.

In this regard, the application of relensing to real galaxy clus-
ters, such as those from e.g. HFF, is naturally the next step (this is a
work in progress). Also, with the expected increase in quantity and
quality of observations from upcoming facilities, we plan to explore
how relensing behaves depending on the number of multiply im-
aged systems, and multiple images available. Additionally, as already
discussed in Cain et al. (2016), ï¬‚exion allows us to get information
from substructure where strong lensing is not dominant. So that it
becomes interesting to explore the impact the smoothing has on re-
constructions when ï¬‚exion is included. Moreover, it is indispensable
to test the prediction power of relensing particularly in the con-
text of predicting the existence of multiple images, which is of great
importance for strong lensing studies.

ACKNOWLEDGEMENTS

L. CastaÃ±eda was supported by Patrimonio AutÃ³nomo - Fondo Na-
cional de Financiamiento para la Ciencia, la TecnologÃ­a y la Inno-
vaciÃ³n Francisco JosÃ© de Caldas (MINCIENCIAS - COLOMBIA)
Grant No. 110685269447 RC-80740-465-2020, projects 69723.

We thank A. Plazas for his comments on our work, and the sugges-
tion of applying our approach to Ares and Hera. We also appreciate
the insights of L. A. Garcia, J. Liesenborgs, and L.L.R. Williams,
which have been useful to improve our manuscript. Additionally, we
thank M. Meneghetti and P. Natarajan for making publicly available
the simulations of Ares and Hera through FF-SIMS.

relensing has been possible thanks to numpy (Harris et al.
(2020)), scipy (Virtanen et al. (2020)), numba (Lam et al. (2015)),
matplotlib (Hunter (2007)), and astropy (Astropy Collaboration
et al. (2013, 2018)).

DATA AVAILABILITY

The data discussed in this work will be shared upon request to the
authors. We plan to make relensing available through GitHub in
the near future.

REFERENCES

Abdelsalam H. M., Saha P., Williams L. L. R., 1998, MNRAS, 294, 734
Allen S. W., Evrard A. E., Mantz A. B., 2011, ARA&A, 49, 409
Astropy Collaboration et al., 2013, A&A, 558, A33
Astropy Collaboration et al., 2018, AJ, 156, 123
Bartelmann M., 2003, arXiv preprint astro-ph/0304162
Bartelmann M., Schneider P., 2001, Phys. Rep., 340, 291
Bartelmann M., Narayan R., Seitz S., Schneider P., 1996, ApJ, 464, L115
Benito J., Urena F., Gavete L., 2001, Applied Mathematical Modelling, 25,

1039

Benito J., Urena F., Gavete L., Alvarez R., 2003, Computer methods in applied

mechanics and engineering, 192, 735
Bergamini P., et al., 2021, A&A, 645, A140
Blandford R. D., Narayan R., 1992, ARA&A, 30, 311
BradaÄ M., Schneider P., Lombardi M., Erben T., 2005a, A&A, 437, 39
BradaÄ M., et al., 2005b, A&A, 437, 49
BradaÄ M., et al., 2009, ApJ, 706, 1201
Broadhurst T., et al., 2005, ApJ, 621, 53
Cacciato M., Bartelmann M., Meneghetti M., Moscardini L., 2006, A&A,

458, 349

Cain B., BradaÄ M., Levinson R., 2016, MNRAS, 463, 4287
Cataneo M., Rapetti D., 2018, International Journal of Modern Physics D,

27, 1848006

Coe D., Fuselier E., BenÃ­tez N., Broadhurst T., Frye B., Ford H., 2008, ApJ,

681, 814

Coe D., et al., 2013, ApJ, 762, 32
Coe D., et al., 2019, ApJ, 884, 85
Dâ€™Aloisio A., Natarajan P., 2011, MNRAS, 411, 1628
Deb S., Goldberg D. M., Ramdass V. J., 2008, ApJ, 687, 39
Diego J. M., Protopapas P., Sandvik H. B., Tegmark M., 2005, MNRAS, 360,

477

Diego J. M., Tegmark M., Protopapas P., Sandvik H. B., 2007, MNRAS, 375,

958

Diego J. M., et al., 2016, MNRAS, 456, 356
Furtak L. J., Atek H., Lehnert M. D., Chevallard J., Charlot S., 2021, MNRAS,

501, 1568

Gardner J. P., et al., 2006, Space Sci. Rev., 123, 485
Gavete L., Gavete M., Benito J., 2003, Applied Mathematical Modelling, 27,

831

Ghosh A., Williams L. L. R., Liesenborgs J., 2020, MNRAS, 494, 3998
Gilmore J., Natarajan P., 2009, MNRAS, 396, 354
Golse G., Kneib J. P., 2002, A&A, 390, 821
Harris C. R., et al., 2020, Nature, 585, 357
Hattori M., Kneib J., Makino N., 1999, Progress of Theoretical Physics Sup-

plement, 133, 1

Hoekstra H., 2013, arXiv e-prints, p. arXiv:1312.5981
Hoekstra H., Bartelmann M., Dahle H., Israel H., Limousin M., Meneghetti

M., 2013, Space Sci. Rev., 177, 75

Huber K., Tchernin C., Merten J., Hilbert S., Bartelmann M., 2019, A&A,

627, A143

Hunter J. D., 2007, Computing in Science & Engineering, 9, 90
IveziÄ‡ Å½., et al., 2019, ApJ, 873, 111
James G., Witten D., Hastie T., Tibshirani R., 2013, An introduction to

statistical learning. Springer

Jauzac M., et al., 2016, MNRAS, 457, 2029
Jee M. J., et al., 2007, ApJ, 661, 728
Jullo E., Kneib J. P., 2009, MNRAS, 395, 1319
Jullo E., Kneib J. P., Limousin M., ElÃ­asdÃ³ttir Ã., Marshall P. J., Verdugo T.,

2007, New Journal of Physics, 9, 447

MNRAS 000, 1â€“24 (2021)

24

D. A. Torres-Ballesteros and L. CastaÃ±eda

Jullo E., Natarajan P., Kneib J.-P., Dâ€™Aloisio A., Limousin M., Richard J.,

Schimd C., 2010, Science, 329, 924
Karman W., et al., 2017, A&A, 599, A28
Kneib J.-P., Natarajan P., 2011, A&ARv, 19, 47
Kneib J. P., Ellis R. S., Smail I., Couch W. J., Sharples R. M., 1996, ApJ,

471, 643

Kneib J.-P., Ellis R. S., Santos M. R., Richard J., 2004, ApJ, 607, 697
Kravtsov A. V., Borgani S., 2012, ARA&A, 50, 353
Lagattuta D. J., et al., 2019, MNRAS, 485, 3738
Lam T. Y., Nishimichi T., Schmidt F., Takada M., 2012, Phys. Rev. Lett., 109,

051301

Lam S. K., Pitrou A., Seibert S., 2015, in Proceedings of the Second Workshop

on the LLVM Compiler Infrastructure in HPC. pp 1â€“6

LaureÄ³s R., 2009, arXiv e-prints, p. arXiv:0912.0914
LaureÄ³s R., et al., 2011, arXiv e-prints, p. arXiv:1110.3193
Liesenborgs J., De RÄ³cke S., Dejonghe H., 2006, MNRAS, 367, 1209
Liesenborgs J., de RÄ³cke S., Dejonghe H., Bekaert P., 2007, MNRAS, 380,

1729

Liesenborgs J., de RÄ³cke S., Dejonghe H., Bekaert P., 2009, MNRAS, 397,

341

Liesenborgs J., Williams L. L. R., Wagner J., De RÄ³cke S., 2020, MNRAS,

494, 3253

Limousin M., et al., 2016, A&A, 588, A99
Lotz J. M., et al., 2017, ApJ, 837, 97
Mahler G., et al., 2018, MNRAS, 473, 663
Mandelbaum R., 2018, ARA&A, 56, 393
McLeod D. J., McLure R. J., Dunlop J. S., 2016, MNRAS, 459, 3812
Meneghetti M., et al., 2017, MNRAS, 472, 3177
Merten J., 2016, MNRAS, 461, 2328
Merten J., Cacciato M., Meneghetti M., Mignone C., Bartelmann M., 2009,

A&A, 500, 681

Merten J., et al., 2011, MNRAS, 417, 333
Newman A. B., Treu T., Ellis R. S., Sand D. J., Nipoti C., Richard J., Jullo

E., 2013, ApJ, 765, 24

Niemiec A., Jauzac M., Jullo E., Limousin M., Sharon K., Kneib J.-P., Natara-

jan P., Richard J., 2020, MNRAS, 493, 3331

Oesch P. A., Bouwens R. J., Illingworth G. D., Franx M., Ammons S. M.,

van Dokkum P. G., Trenti M., LabbÃ© I., 2015, ApJ, 808, 104

Oguri M., 2010, PASJ, 62, 1017
Pizzuti L., et al., 2016, J. Cosmology Astropart. Phys., 2016, 023
Postman M., et al., 2012, ApJS, 199, 25
Priewe J., Williams L. L. R., Liesenborgs J., Coe D., Rodney S. A., 2017,

MNRAS, 465, 1030

Remolina GonzÃ¡lez J. D., Sharon K., Mahler G., 2018, ApJ, 863, 60
Richard J., et al., 2014, MNRAS, 444, 268
Saha P., Williams L. L. R., 1997, MNRAS, 292, 148
SchÃ¤fer C., Fourestey G., Kneib J. P., 2020, Astronomy and Computing, 30,

100360

Schneider P., Seitz C., 1995, A&A, 294, 411
Schneider P., Ehlers J., Falco E. E., 1992, Gravitational Lenses. Springer,

doi:10.1007/978-3-662-03758-4

Schneider P., Kochanek C., Wambsganss J., 2006, Gravitational lensing:
strong, weak and micro: Saas-Fee advanced course 33. Springer Science
& Business Media

Seitz C., Schneider P., 1997, A&A, 318, 687
Seitz S., Schneider P., Bartelmann M., 1998, A&A, 337, 325
Sendra I., Diego J. M., Broadhurst T., Lazkoz R., 2014, MNRAS, 437, 2642
Strait V., et al., 2018, ApJ, 868, 129
Umetsu K., 2020, A&ARv, 28, 7
Vanzella E., et al., 2021, A&A, 646, A57
Virtanen P., et al., 2020, Nature Methods, 17, 261
Williams L. L. R., Sebesta K., Liesenborgs J., 2018, MNRAS, 480, 3140

This paper has been typeset from a TEX/LATEX ï¬le prepared by the author.

MNRAS 000, 1â€“24 (2021)

