2
2
0
2

l
u
J

5

]

O
C
.
h
p
-
o
r
t
s
a
[

2
v
6
7
0
0
1
.
1
0
2
2
:
v
i
X
r
a

MNRAS 000, 1–24 (2021)

Preprint 6 July 2022

Compiled using MNRAS LATEX style ﬁle v3.0

relensing: Reconstructing the mass proﬁle of galaxy clusters from
gravitational lensing

Daniel A. Torres-Ballesteros,1★ and Leonardo Castañeda1†
1Observatorio Astronómico Nacional, Universidad Nacional de Colombia, Carrera 30 Calle 45-03, P.A. 111321 Bogotá, Colombia

Accepted XXX. Received YYY; in original form ZZZ

ABSTRACT
In this work we present relensing, a package written in python whose goal is to model galaxy clusters from gravitational
lensing. With relensing we extend the amount of software available, which provides the scientiﬁc community with a wide
range of models that help to compare and therefore validate the physical results that rely on them. We implement a free-form
approach which computes the gravitational deﬂection potential on an adaptive irregular grid, from which one can characterize
the cluster and its properties as a gravitational lens. Here, we use two alternative penalty functions to constrain strong lensing.
We apply relensing to two toy models, in order to explore under which conditions one can get a better performance in the
reconstruction. We ﬁnd that by applying a smoothing to the deﬂection potential, we are able to increase the capability of this
approach to recover the shape and size of the mass proﬁle of galaxy clusters, as well as its magniﬁcation map. This translates
into a better estimation of the critical and caustic curves. The power that the smoothing provides is also tested on the simulated
clusters Ares and Hera, for which we get an rms on the lens plane of ∼ 0.17 𝑎𝑟𝑐𝑠𝑒𝑐 and ∼ 0.16 𝑎𝑟𝑐𝑠𝑒𝑐, respectively. Our results
represent an improvement with respect to reconstructions that were carried out with methods of the same nature as relensing.
At the same time, the smoothing also increases the stability of our implementation, and decreases the computation time. In its
current state, relensing is available upon request.

Key words: gravitational lensing – galaxy cluster – cosmology

1 INTRODUCTION

Gravitational lensing has proven to be a powerful tool for under-
standing the universe at diﬀerent scales (e.g. Blandford & Narayan
(1992); Schneider et al. (2006)), where its power relies upon its sim-
plicity, since it only depends on the mass distribution that acts as lens,
irrespective of its nature (baryonic or not) or its dynamical state.

It is of particular interest its application to the study of galaxy
clusters and their mass distribution. As the most massive objects in
the universe, galaxy clusters provide a framework for cosmological
probes, such as testing the underlying gravitational theory (e.g. Lam
et al. (2012); Pizzuti et al. (2016); Cataneo & Rapetti (2018)) and
cosmological model (e.g. Gilmore & Natarajan (2009); D’Aloisio &
Natarajan (2011); Jullo et al. (2010)), and also provide strong con-
strains to the paradigm of structure formation and evolution (e.g see
Allen et al. (2011); Kravtsov & Borgani (2012) for reviews). In addi-
tion, galaxy clusters also act as eﬀective cosmic telescopes, since their
angular size and mass turn them into the biggest and strongest man-
ifestation of gravitational lensing in the universe. Therefore, galaxy
clusters are capable of magnifying faint background sources that
would otherwise remain unseen, or for which it would be diﬃcult
to infer any signiﬁcant information. This is for example the case
for galaxies with high redshift (the ﬁrst galaxies ever formed in the
universe) (e.g. Kneib et al. (2004); Bradač et al. (2009); Coe et al.

★ E-mail:daatorresba@unal.edu.co
† E-mail: lcastanedac@unal.edu.co

© 2021 The Authors

(2013); Richard et al. (2014); Oesch et al. (2015); McLeod et al.
(2016); Furtak et al. (2021)). For a deeper description of the role that
gravitation lensing plays in the context of galaxy clusters refer to e.g.
Kneib & Natarajan (2011); Hoekstra et al. (2013); Umetsu (2020)
and the references therein.

The problem of making an estimation of the mass proﬁle of a
galaxy cluster from gravitational lensing has been approached from
diﬀerent perspectives over the years. As a result, several methods
have been developed. In general terms, they are usually classiﬁed as
parametric or free-form (sometimes also labeled as non-parametric)
methods. Parametric methods are characterized by employing an
input model that depends on a set of parameters which needs to
reproduce the input data as well as possible. This can be done for
example, by means of Bayesian methods such as MCMC or Nested
Sampling. The input model can be for example, the mass distribution
composed of a superposition of baryonic and dark matter components
for the diﬀerent cluster members, and which are chosen taking into
account certain physical and geometrical properties that are expected
to satisfy the properties shown by the galaxy cluster. On the other
hand, free-form methods generally work on a grid on which some
quantity of interest is deﬁned, for example the convergence or the
deﬂection potential, and they need to be found. Therefore, free-form
methods are parametric on the inside, since there is a set of parameters
that need to be found in order to achieve the reconstruction, but they
are diﬀerent to pure parametric methods in the sense that does not
exist an imposed input model that constrains the reconstruction.

Among parametric approaches we can ﬁnd e.g. LENSTOOL Kneib

 
 
 
 
 
 
2

D. A. Torres-Ballesteros and L. Castañeda

et al. (1996); Jullo et al. (2007); Newman et al. (2013); Schäfer
et al. (2020), Light-Traces-Mass (LTM) Broadhurst et al. (2005), and
glafic Oguri (2010), Meanwhile, for free-form approaches we have
e.g. Bartelmann et al. (1996), Abdelsalam et al. (1998), Saha &
Williams (1997), Seitz et al. (1998), Cacciato et al. (2006), Jee et al.
(2007), Deb et al. (2008), GRALE Liesenborgs et al. (2006, 2007,
2009, 2020); Ghosh et al. (2020), WSLAP Diego et al. (2005, 2007),
SWUnited Bradač et al. (2005a,b, 2009), LensPerfect Coe et al.
(2008), and SaWLens(2) Merten et al. (2009, 2011); Merten (2016);
Huber et al. (2019). There are also available hybrid methods that
combine elements of both approaches e.g. Jullo & Kneib (2009);
Niemiec et al. (2020) (which are part of LENSTOOL), and WSLAP+
Sendra et al. (2014); Diego et al. (2016) (an extension of WSLAP).

Nowadays, the relevant observations in this regard are open access,
as it is the case for Hubble Frontier Fields (HFF) Lotz et al. (2017),
Reionization Lensing Cluster Survey (RELICS) Coe et al. (2019),
Cluster Lensing and Supernova Survey with Hubble (CLASH) Post-
man et al. (2012). Additionally, there is an expected increase in both
quality and quantity of observations from upcoming ground/space
based observatories such as James Webb Space Telescope (JWST)
Gardner et al. (2006), Euclid Laureĳs (2009); Laureĳs et al. (2011),
and Vera C. Rubin Observatory (LSST) Ivezić et al. (2019). There-
fore, it is pertinent to have access to a variety of open access software
that aims to model galaxy clusters from gravitational lensing, in order
to be able to compare, and validate those models, as well as the phys-
ical results that rely on them (e.g Priewe et al. (2017); Meneghetti
et al. (2017); Strait et al. (2018); Remolina González et al. (2018)).
Therefore, in this work we describe what is behind relensing,
an easy-to-use package currently written in python, in which a free-
form reconstruction method is implemented. The method that we
discuss here is based upon the work previously presented by Bradač
et al. (2005a, 2009), which itself is an extension of Bartelmann et al.
(1996).

We explore the eﬀectiveness of an alternative ﬁnite diﬀerence
approach. Also, we extend the grid reﬁnement to an adaptive irregular
one, that is intended to follow the observational data from strong
lensing as well as the shape of the main deﬂectors. Additionally,
we discuss two diﬀerent approaches to the strong lensing penalty
function, which along with the introduction of a smoothing process
enhance the performance of this approach, reducing the computation
time and providing a more accurate reconstruction.

This paper is organized as follows. In Sec. 2 we discuss the rel-
evant aspects of gravitational lensing theory, and also introduce the
notation used throughout the paper. Then, in Sec. 3 we describe the
reconstruction method in detail. Once the reconstruction framework
is settled, in Sec. 4 we apply the reconstruction to two simple distri-
butions, in order to explore how relensing behaves and how to get
the best out of it. In Sec. 5 we apply the reconstruction to Ares and
Hera (see Meneghetti et al. (2017)), which provide a way of testing
the performance of relensing in a more realistic scenario. Finally,
in Sec. 6 we present the conclusions of this work.

For the mock catalogues discussed in Sec. 4.1, and the recon-
structions presented in this work, we consider a ﬂat ΛCDM cos-
mology with density parameter Ω𝑚,0 = 0.3 and Hubble constant
𝐻0 = 70 𝑘𝑚 𝑠−1 𝑀 𝑝𝑐−1.

2 GRAVITATIONAL LENSING NOTATION

In this work we focus on the gravitational lensing eﬀect under the thin
lens approximation. A presentation of this topic deeper than the one

MNRAS 000, 1–24 (2021)

intended here, can be found, for example in Schneider et al. (1992,
2006).

In this context, the galaxy cluster with redshift 𝑧𝑙 takes the place
of the lens, and it is characterized by the projected mass density Σ =
Σ(𝜽), with 𝜽 being an angular position from the observer perspective.
Then, the aim is to recover Σ somehow. For this task, we need to
compare observations to theory. Therefore, as observables we will
make use of multiply imaged systems (strong regime) (e.g. Hattori
et al. (1999); Schneider et al. (2006)), since galaxy clusters are rich
in those systems, and we will also consider the ellipticity of weakly
distorted and singly imaged background sources (weak regime) (e.g.
Bartelmann & Schneider (2001); Schneider et al. (2006); Hoekstra
(2013); Mandelbaum (2018); Umetsu (2020)).

The aforementioned observables can be characterized by means
of the convergence 𝜅 = 𝜅(𝑧, 𝜽), the shear 𝛾 = 𝛾(𝑧, 𝜽), and also the
reduced (or scaled) deﬂection angle 𝜶 = 𝜶(𝑧, 𝜽) (hereafter we will
refer to it as deﬂection angle for simplicity), which are deﬁned in
terms of potential 𝜓 = 𝜓(𝑧, 𝜽). Here 𝜅 is a direct estimator of the
mass proﬁle, since it is deﬁned as

𝜅 :=

Σ
Σ𝑐𝑟

=

1
2

∇2𝜓 with Σ𝑐𝑟 :=

𝑐2𝐷 (𝑧)
4𝜋𝐺 𝐷 (𝑧𝑙)𝐷 (𝑧𝑙, 𝑧)

,

(1)

where Σ𝑐𝑟 = Σ𝑐𝑟 (𝑧, 𝑧𝑙) is known as critic mass density, and it is
deﬁned in terms of the angular diameter distances from the observer
to the lens 𝐷 (𝑧𝑙), from the observer to source 𝐷 (𝑧) of interest, and
ﬁnally from the lens to such source 𝐷 (𝑧𝑙, 𝑧). Thus, we refer to 𝜅 as
the mass proﬁle. Similarly, 𝛾 is a dimensionless complex quantity
whose components are
(cid:32) 𝜕2𝜓
(cid:33)
𝜕𝜃2
1

𝜕2𝜓
𝜕𝜃1𝜕𝜃2

and 𝛾2 :=

𝛾1 :=

𝜕2𝜓

1
2

(2)

−

,

𝜕𝜃2
2
with 𝛾 := 𝛾1 + 𝑖𝛾2. In addition, 𝜶 reads
𝜶 := ∇𝜓.

(3)

From (1) it is clear that once 𝜓 is known, the mass proﬁle is
recovered. Now, since 𝜓 depends on 𝑧 it is convenient to deﬁne a
reference redshift 𝑧𝑟 > 𝑧𝑙, so that given 𝜓𝑟 one can write 𝜓, 𝜅. 𝛾 and
𝜶 in terms of 𝜓𝑟 as well as in terms of 𝜅𝑟 , 𝛾𝑟 and 𝜶𝑟 , respectively. This
transition is done by using the cosmological weight 𝑍 = 𝑍 (𝑧, 𝑧𝑟 , 𝑧𝑙)
deﬁned as

𝐷 (𝑧𝑙, 𝑧)𝐷 (𝑧𝑟 )
𝐷 (𝑧)𝐷 (𝑧𝑙, 𝑧𝑟 )

𝑈 (𝑧),

𝑍 :=

with

𝑈 (𝑧) =

(cid:40)

1
0

if
if

𝑧 > 𝑧𝑙
𝑧 ≤ 𝑧𝑙

,

(4)

(5)

from which one gets 𝜓 = 𝑍𝜓𝑟 , 𝜅 = 𝑍 𝜅𝑟 , 𝛾 = 𝑍𝛾𝑟 and 𝜶 = 𝑍𝜶𝑟 . In
this way, we only need to deal with 𝜓𝑟 , which simpliﬁes the problem
signiﬁcantly.

With respect to the observables, in the strong regime the multiply
imaged systems can in principle be characterized by solving the lens
equation

𝜷 = 𝜽 − 𝑍𝜶𝑟 ,

(6)

which relates the true angular position 𝜷 to the observed angular
position 𝜽. Alternatively, it is simpler to work on the source plane,
taking into account that the multiple images of a given system have
to converge to a unique source.

On the other hand, with respect to the weak regime, distortions
(shape, size and orientation) at this level are characterized by means
of source ellipticity. Among the diﬀerent deﬁnitions of ellipticity

relensing: Reconstructing the mass proﬁle of galaxy clusters from gravitational lensing

3

𝜓 is by using ﬁnite diﬀerences. In this context, the advantage of ﬁnite
diﬀerences over other methods lies in its capability to express the
derivatives (of any order) of 𝜓 as a linear combination of 𝜓 𝑗 (deﬁned
on the grid), and it also makes the linearization of (11) simple. In
this direction, 𝜅, 𝛾, 𝜶, and 𝜓 itself, evaluated at an arbitrary angular
position 𝜽𝒊 (it does not need to correspond to a node) can be written
in terms of every 𝜓 𝑗 as

(e.g. Schneider et al. (2006)), the more suited for the task in hand
is the complex ellipticity 𝜖 = 𝜖 (𝑧, 𝜽), which is related to the source
intrinsic or true ellipticity 𝜖𝑠 by means of the expression

𝜖 =

𝜖𝑠 + 𝑔
1 + 𝑔∗𝜖𝑠

1 + 𝑔𝜖 ∗
𝑠
𝜖 ∗
𝑠 + 𝑔∗






if

if

|𝑔| ≤ 1

|𝑔| > 1

,

(7)

where the asterisk stands for complex conjugate, and the reduced
shear 𝑔 = 𝑔(𝑧) is deﬁned as

𝑔 =

𝑍𝛾𝑟
1 − 𝑍 𝜅𝑟

.

(8)

𝜅𝑖 =

Here 𝜖𝑠 is not an observable, therefore (7) cannot be used directly.
This problem is avoided by considering the average intrinsic elliptic-
ity for several (as many as possible) sources in a local neighborhood
to be (cid:104)𝜖𝑠(cid:105) = 0. As a result, for a given redshift the average observed
ellipticity reads

𝜓𝑖 =

𝑁
∑︁

𝑗=1

𝑁
∑︁

𝑗=1

P𝑖 𝑗 𝜓 𝑗 ,

K𝑖 𝑗 𝜓 𝑗 ,

𝛾𝑛,𝑖 =

𝑁
∑︁

𝑗=1

𝑁
∑︁

𝑗=1

G𝑛,𝑖 𝑗 𝜓 𝑗 ,

D𝑛,𝑖 𝑗 𝜓 𝑗 ,

(9)

𝛼𝑛,𝑖 =

(12)

(13)

(14)

(15)

(cid:104)𝜖(cid:105) =

𝑔

1
𝑔∗





if

if

|𝑔| ≤ 1

|𝑔| > 1

,

yielding a direct estimation of the local reduced shear, which allows
us to directly contrast observations to theory at weak regime. Further
details can be found in Schneider & Seitz (1995); Seitz & Schneider
(1997).

3 RECONSTRUCTION METHOD

The aim of those methods derived from Bartelmann et al. (1996) and
its extensions is to constrain the deﬂection potential 𝜓 in a given grid
by making use of gravitational lensing observations. No assumption
about mass traces light is made.

Consider (in general) an irregular grid deﬁned on the lens plane,
which is composed of 𝑁 nodes whose angular position is 𝜽 𝑗 (with
𝑗 = 1, 2, . . . , 𝑁). On each node a deﬂection potential 𝜓 𝑗 is assigned,
and such potentials are constrained from the observables described
in Sec. 2. To do so, we implement the penalty function
𝜒2 (𝜓 𝑗 ) := 𝜒2

𝑤 (𝜓 𝑗 ) + 𝜒2

𝑠 (𝜓 𝑗 ) + 𝜒2

𝜅 (𝑅) (𝜓 𝑗 ) + 𝜒2

𝛾 (𝑅) (𝜓 𝑗 ),

(10)

𝑠 constrains the strong regime, 𝜒2
𝜅 (𝑅) and 𝜒2

where 𝜒2
𝑤 constrains the weak
regime, and both 𝜒2
𝛾 (𝑅) are regularization terms. Here,
(10) needs to be explicitly written in terms of the 𝑁 deﬂection po-
tentials, since they are the parameters to be found. This task can
be achieved by minimizing (10) with respect to every 𝜓𝑘 (with
𝑘 = 1, 2, . . . , 𝑁), which leads to 𝑁 equations of the form

𝜕 𝜒2

𝜕 𝜒2

+

+

+

= 0,

𝜕 𝜒2
𝑠
𝜕𝜓𝑘

𝜅 (𝑅)
𝜕𝜓𝑘

𝛾 (𝑅)
𝜕𝜓𝑘

𝜕 𝜒2
𝑤
𝜕𝜓𝑘
each of them with 𝑁 unknowns. The system of equations is in general
nonlinear, making it diﬃcult to solve. Linearizing (if possible) such
system simpliﬁes the implementation and reduces the computation
time, which is an advantage in practical terms, considering that reli-
able results are obtained. In Sec. 3.3 we explain how to perform such
linearization.

(11)

Now, from Sec. 2 it is clear that the observables we are interested
in can be characterized by 𝜅, 𝛾, and 𝜶, which are deﬁned in terms of
either ﬁrst or second order derivatives of 𝜓. Since we are working on a
grid, the most direct way to explicitly write these quantities in terms of

with 𝑛 = 1, 2 representing the components of 𝛾 and 𝜶, respectively.
The coeﬃcients (or nodes weight) P𝑖 𝑗 , K𝑖 𝑗 , G𝑛,𝑖 𝑗 and D𝑛,𝑖 𝑗 depend
on what form the grid has, i.e. if it is regular (e.g. Bradač et al.
(2005a); Deb et al. (2008); Merten et al. (2009)) or irregular (e.g.
Bradač et al. (2009); Merten (2016)), and also on how ﬁnite diﬀer-
ences and the interpolation are carried out. In Sec. 3.1 we describe
how we obtain such weights. Since 𝜽𝑖 is arbitrary (within the region
of interest), equations (12) - (15) also work to interpolate.

Once the diﬀerent penalty functions in (10) are explicitly written
in terms of 𝜓 𝑗 , we have that their contribution to (11) after the
corresponding linearization yields an expression of the form

𝜕 𝜒2
𝑝
𝜕𝜓𝑘

= 2

𝑁
∑︁

𝑗=1

W ( 𝑝)
𝑘 𝑗

𝜓 𝑗 − 2V ( 𝑝)

𝑘

,

(16)

where 𝑝 = 𝑠 stands for strong regime, 𝑝 = 𝑤 for weak regime, and
𝑝 = 𝜅 and 𝑝 = 𝛾 stand for both regularization terms. In Sec. 3.3 we
and V ( 𝑝)
describe how W ( 𝑝)
are deﬁned in each case. From (16)
𝑘
𝑘 𝑗
it is clear that (11) reduces to

𝑁
∑︁

W𝑘 𝑗 𝜓 𝑗 = V𝑘 ,

(17)

𝑗=1
where W𝑘 𝑗 = W (𝑤)
+ V (𝛾)
V (𝑠)
+ V (𝜅)
𝑘
𝑘
𝑘
node weight for the 𝑘-th linear equation.

𝑘 𝑗 + W (𝑠)

𝑘 𝑗 + W (𝜅)

𝑘 𝑗 + W (𝛾)

𝑘 𝑗 and V𝑘 = V (𝑤)

𝑘

+

. Here the coeﬃcient W𝑘 𝑗 represent the 𝑗-th

The deﬂection potential admits two transformations that introduce
degrees of freedom in the reconstruction, which may aﬀect diﬀerent
aspects of the results. On one hand, transformation
𝜓 → 𝜓(cid:48) = 𝜓 + 𝜓0 + 𝒄 · 𝜽
introduces three degrees of freedom, one through the constant term
𝜓0, and two from the bidimensional constant vector 𝒄. On the other
hand, transformation
𝜓 → 𝜓(cid:48) = (1 − 𝜆)|𝜽 |2/2 + 𝜆𝜓,

(19)

(18)

responsible for the well known Mass Sheet Degeneracy (MSD for
short), introduces an extra degree of freedom through the constant
term 𝜆. Following Bradač et al. (2005a), we have that such degrees

MNRAS 000, 1–24 (2021)

4

D. A. Torres-Ballesteros and L. Castañeda

of freedom can be ﬁxed by keeping the deﬂection potential ﬁxed on
one node for each degree of freedom. Since we have four degrees of
freedom, we will hold 𝜓 𝑗 = 0 ﬁxed on each of the four corners of the
grid if both transformations are relevant, or only on three of the four
corners of the grid if the MSD in not considered to be a concern.
This leaves us respectively with a (𝑁 − 4) × (𝑁 − 4) system of linear
equations to be solved.

Observations of galaxy clusters have shown the existence of several
systems of multiple images, and for many of them the redshift is
known; at least up to some extent. When such redshifts are suﬃciently
diverse, in principle the MSD breaks. Under these conditions the
MSD is not a concern, so that we are left only with three degrees of
freedom from (18). Thus, in this case we are left with a (𝑁 − 3) ×
(𝑁 − 3) system of linear equations. In this work this condition is met.
Hence, as well as in Bradač et al. (2005a), we will not consider the
MSD to be a problem, which is supported by the results that we get.
Now, before we describe which ﬁnite diﬀerence approach that we
use, let us continue describing, in general, how the reconstruction
method works. At this point, one might think that solving (17) is just
enough for getting the reconstruction done. Unfortunately, this leads
to a low resolution and under reconstructed proﬁle. In this regard,
Bradač et al. (2005a) found that two levels of iterations solve the
problem. Therefore, keeping their notation, we will refer to them as
the inner and outer levels. The inner level is in charge of computing
the deﬂection potential iteratively, while the outer level is responsible
for producing the grid reﬁnement that produce a ﬁner and adapted
grid on which a new estimation of 𝜓 takes place.

In general terms, a description of how this method works is pre-

sented in Algorithm 1.

Algorithm 1 Reconstruction
1: Input: Initial conditions and the initial guess 𝜓 (0) .
and 𝛾 (0)
2: Compute 𝜅 (0) , 𝛾 (0)
2
1
3: while outer_end = False do
4:
5:
6:

Compute the nodes weight.
while inner_end = False do

from 𝜓 (0) .

it −→ 𝜓 (𝑛) .

Compute the system of linear equations needed and solve

Smoothing of 𝜓 (𝑛) −→ New 𝜓 (𝑛) (optional).
Compute 𝜅 (𝑛) from 𝜓 (𝑛) .
if (cid:12)

(cid:12)
(cid:12) ≤ tolerance then

(cid:12)𝜅 (𝑛)
𝑗 − 𝜅 (𝑛−1)
inner_end = True.

𝑗

7:
8:

9:

10:

11:
12:

13:

14:
15:

Compute 𝜒2
𝑠 .
if 𝜒2
𝑠 ≤ 𝑞(2𝑁img) then
outer_end = True.
if outer_end = False then
Apply grid reﬁnement.
Compute 𝜓 (𝑚) , 𝜅 (𝑚) , 𝛾 (𝑚)

16:
17: return 𝜓

and 𝛾 (𝑚)
2

on the new grid.

1

This algorithm has as input (line 1) a set of parameters that are
used along the reconstruction. Among them, we have the grid initial
and reﬁnement conditions (more details in Sec. 3.2), regularization
weights 𝜂𝜅 and 𝜂𝛾 (more details in Sec. 3.3.3), whether constrains
from both strong and weak regimes are used or only from the strong
regime, and the type of 𝜒2
𝑠 that is going to be used (more details in Sec.
3.3.1). Last but not least, as input we have the initial guess 𝜓 (0) for
and 𝛾 (0)
the deﬂection potential, from which we compute 𝜅 (0) , 𝛾 (0)
2
1

MNRAS 000, 1–24 (2021)

(line 2 ). These quantities are needed to initialize the reconstruction
(more details in Sec. 3.3).

Once we have set the initial conditions, the outer level starts (line
3). At the beginning of each outer iteration we compute the node
weights for every node and data point (line 4). Such weights come
from the ﬁnite diﬀerence scheme and the interpolation (when re-
quired), and have to be computed once for each outer iteration. With
these weights in hand, the inner level starts (line 5).

The inner level is in charge of computing the system of linear
equations (17) and its solution, so that we get 𝜓 (𝑛) ; a new version of
the deﬂection potential. Here, 𝑛 represents the current inner iteration
(line 6). The reconstruction might be quite noisy, (as we show in
Sec. 4.3), nonetheless, the results in the overall reconstruction can
be improved by introducing a smoothing on 𝜓 (𝑛) . Such smoothing
is the result of recomputing 𝜓 (𝑛) with equation (12), where for this
case 𝜓𝑖 represents the smoothed potential at the 𝑖-th node, while 𝜓 𝑗
comes from the solution of (17). This step is optional but advised, as
we justify in Sec. 4.3 (line 7).

Then, from 𝜓 (𝑛) (smoothed or not) we compute the convergence
𝜅 (𝑛) on the grid (line 8) by using ﬁnite diﬀerences, such that, when
the condition
𝑗 − 𝜅 (𝑛−1)
𝜅 (𝑛)

≤ tolerance

(20)

𝑗

(cid:12)
(cid:12)
(cid:12)

(cid:12)
(cid:12)
(cid:12)

is satisﬁed for every node ( 𝑗 = 1, . . . , 𝑁), (line 9), the inner level
ﬁnishes its task (line 10). In (20) 𝜅 (𝑛−1) represents the convergence
from the previous inner iteration.

When the inner level ﬁnishes, we compute either the type 1 or
type 2 penalty function 𝜒2
𝑠 depending on the initial conditions (line
11). We have seen that optimal results are obtained when the recon-
struction reaches 𝜒2
𝑠 ∼ 2𝑁img, with Nimg being the total number of
multiple images being used. This condition is intended to avoid an
overﬁt, without compromising the quality of the reconstruction. With
that in mind, we consider that once the condition 𝜒2
𝑠 ≤ 𝑞(2𝑁img)
(for 𝑞 > 1) is satisﬁed (line 12), the outer level as well as the recon-
struction ﬁnish (line 13). Here we have taken 𝑞 = 1.4, for which the
reconstruction tends to satisfy (𝑞 − 1)(2𝑁img) ≤ 𝜒2

𝑠 ≤ 𝑞(2𝑁img).

If condition 𝜒2

𝑠 ≤ 𝑞(2𝑁img) is not met, a new outer iteration is
required (line 14). Thus, the grid reﬁnement is performed (line 15)
(more details in Sec. 3.2). Then, from the deﬂection potential result
of the last inner iteration for the current outer iteration, we compute
𝜓 (𝑚) , 𝜅 (𝑚) , 𝛾 (𝑚)
on this new grid (line 16) (more details in
Sec. 3.1). They are required to initialize the next outer iteration (more
details in Sec. 3.3), taking the place of 𝜓 (𝑚−1) , 𝜅 (𝑚−1) , 𝛾 (𝑚−1)
and
𝛾 (𝑚−1)
and 𝛾 (0)
2
2
iteration. Here, 𝑚 stands for the current outer iteration.

, or 𝜓 (0) , 𝜅 (0) , 𝛾 (0)
1

if we are running the ﬁrst outer

and 𝛾 (𝑚)
2

1

1

Finally, if no further outer iterations are required, as return we have
the ﬁnal deﬂection potential, which corresponds to the last 𝜓 (𝑛) that
we know (line 17).

Due to the nature of the method, negative densities may appear.
This happens mainly for blind reconstruction (i.e. 𝜓 (0)
𝑗 = 0 at every
node), as well as in situations with little observational constraints.
The negative values tend to appear towards the outskirts of the dis-
tribution. The presence of negative densities is also heavily related
to the initial conditions. For instance, small values of 𝜂𝜅 and 𝜂𝛾 pro-
duce an overﬁt of the intrinsic noise in the reconstruction. Likewise,
a too dense initial grid restrains the capability of the method to adapt
to the data. One way to solve this problem (when it occurs), is to
use as an initial guess a distribution other than the blind one, which,
along with the smoothing reduce the noise in the reconstruction,
particularly towards the outskirts.

relensing: Reconstructing the mass proﬁle of galaxy clusters from gravitational lensing

5

3.1 Finite diﬀerence approach

In this regard, we follow the generalized ﬁnite diﬀerence approach
(GFD) (e.g. Benito et al. (2001); Gavete et al. (2003); Benito et al.
(2003)), with the diﬀerence that we use it not only for ﬁnding the
derivatives on a grid from the deﬂection potential deﬁned on such a
grid, but also for interpolating the deﬂection potential and its deriva-
tives at a given angular position 𝜽0, in case it is not part of the
grid.

Let us consider the 𝑄 nearest nodes (NN) (nearest neighbors) to
𝜽0, as it is depicted in Fig. 1. On each of such NN we apply the Taylor
series expansion to is corresponding deﬂection potential around 𝜽0
up to second order derivatives. Therefore, for the 𝑖-th NN we get

ℎ2
𝑖
2

𝑘2
𝑖
2

+

+

+𝑘𝑖

+ℎ𝑖 𝑘𝑖

, (21)

𝜕𝜓0
𝜕𝜃2

𝜕𝜓0
𝜕𝜃1

𝜓𝑖 = 𝜓0+ℎ𝑖

𝜕2𝜓0
𝜕𝜃2
1

𝜕2𝜓0
𝜕𝜃1𝜕𝜃2

𝜕2𝜓0
𝜕𝜃2
1
with ℎ𝑖 = 𝜃𝑖,1 − 𝜃0,1, and 𝑘𝑖 = 𝜃𝑖,2 − 𝜃0,2. In case for example ﬂexion
is being considered in the reconstruction, higher order derivatives
have to be taken in the expansion (21). Here 𝑋1 = 𝜓0, 𝑋2 = 𝜕𝜓0/𝜕𝜃1,
1, 𝑋5 = 𝜕2𝜓0/𝜕𝜃1𝜕𝜃2, and 𝑋6 =
𝑋3 = 𝜕𝜓0/𝜕𝜃2, 𝑋4 = 𝜕2𝜓0/𝜕𝜃2
𝜕2𝜓0/𝜕𝜃2
2 are the unknowns, which, following GFD, can be obtained
by minimizing the penalty function

Figure 1. In this ﬁgure the black dots represent the NN to 𝜽0, where the given
dashed circle is centered at 𝜽0. The gray dots correspond to nodes that are
not being considered in the ﬁnite diﬀerence scheme.

where the weight of the 𝑖-th NN for the 𝑗-th unknown is given by

𝜒2
𝐺𝐹 𝐷 =

𝑄
∑︁

(cid:16)

𝑖=1

Ψ𝑖𝑊𝑖

(cid:17)2

,

with 𝑊𝑖 = 𝑊 (ℎ𝑖, 𝑘𝑖) being a weighting function, and

Ψ𝑖 = −𝜓𝑖 + 𝑋1 + ℎ𝑖 𝑋2 + 𝑘𝑖 𝑋3 +

ℎ2
𝑖
2
Therefore, when minimizing (22) with respect to the 𝑗-th unknown

𝑋4 + ℎ𝑖 𝑘𝑖 𝑋5 +

𝑘2
𝑖
2

𝑋6.

(23)

we get

𝜕 𝜒2

𝐺𝐹 𝐷
𝜕 𝑋 𝑗

= 2

𝑄
∑︁

𝑖=1

Ψ𝑖𝑊 2
𝑖

𝜕Ψ𝑖
𝜕 𝑋 𝑗

= 0,

(24)

which leads to a system of linear equations of the form 𝐴𝑿 = 𝒃, with

𝐴 =

𝑄
∑︁

𝑖=1

𝑊 2
𝑖

𝑘𝑖

ℎ𝑖 𝑘𝑖

𝑘2
𝑖

1

ℎ𝑖

ℎ2
𝑖

SYM

(cid:169)
(cid:173)
(cid:173)
(cid:173)
(cid:173)
(cid:173)
(cid:173)
(cid:173)
(cid:173)
(cid:173)
(cid:173)
(cid:173)
(cid:173)
(cid:173)
(cid:173)
(cid:173)
(cid:173)
(cid:173)
(cid:173)
(cid:173)
(cid:173)
(cid:173)
(cid:173)
(cid:171)

ℎ2
𝑖
2
ℎ3
𝑖
2
ℎ2
𝑖 𝑘𝑖
2
ℎ4
𝑖
4

ℎ𝑖 𝑘𝑖

ℎ2
𝑖 𝑘𝑖

ℎ𝑖 𝑘2
𝑖
ℎ3
𝑖 𝑘𝑖
2

ℎ2
𝑖 𝑘2
𝑖

𝑘2
𝑖
2
ℎ𝑖 𝑘2
𝑖
2
𝑘3
𝑖
2
𝑖 𝑘2
ℎ2
𝑖
4
ℎ𝑖 𝑘3
𝑖
2
𝑘4
𝑖
4

(cid:170)
(cid:174)
(cid:174)
(cid:174)
(cid:174)
(cid:174)
(cid:174)
(cid:174)
(cid:174)
(cid:174)
(cid:174)
(cid:174)
(cid:174)
(cid:174)
(cid:174)
(cid:174)
(cid:174)
(cid:174)
(cid:174)
(cid:174)
(cid:174)
(cid:174)
(cid:174)
(cid:172)

and

𝑇 =

𝒃

𝑄
∑︁

𝑖=1

(cid:16)

𝑊 2

𝑖 𝜓𝑖

1, ℎ𝑖, 𝑘𝑖, ℎ2

𝑖 /2, ℎ𝑖 𝑘𝑖, 𝑘2

𝑖 /2

(cid:17)

,

(26)

while the elements of 𝑿 were deﬁned above. We ﬁnd 𝐴−1 numeri-
cally, such that

𝑋 𝑗 =

𝑄
∑︁

𝑖=1

X𝑗𝑖𝜓𝑖,

(27)

(cid:32)

X𝑗𝑖 = 𝑊 2
𝑖

(22)

𝑗1 + 𝐴−1
𝐴−1
𝑗2

ℎ𝑖 + 𝐴−1
𝑗3

𝑘𝑖 + 𝐴−1
𝑗4

ℎ2
𝑖
2

+ 𝐴−1
𝑗5

ℎ𝑖 𝑘𝑖 + 𝐴−1
𝑗6

(cid:33)

𝑘2
𝑖
2

. (28)

From (27) it is clear that only the weights of the 𝑄 NN are (in prin-
ciple) diﬀerent from zero. Here, from (28) it becomes straightforward
to compute the weights required in equations (12) - (15).

Now, we have found from mock reconstructions that for 𝑄 ∼ 9 the
reconstruction still works, but for less NN the reconstruction tends to
fail, since (25) becomes singular quickly. Under this condition, if the
reconstruction converges, most likely the output will not be reliable.
On the other hand, if 𝑄 is beyond 𝑄 ∼ 36 the reconstruction ﬂattens.
We have seen that 16 ≤ 𝑄 ≤ 36 is good enough for the reconstruction
to work properly, with optimal results for 𝑄 ∼ 25, since the output is
neither irregular in excess nor ﬂattened in excess.

In this paper we use a quartic spline as 𝑊𝑖, given by
(cid:19)3

(cid:19)2

(cid:19)4

(cid:18) 𝑑𝑖
𝑑𝑚

+ 8

(cid:18) 𝑑𝑖
𝑑𝑚

− 3

(cid:18) 𝑑𝑖
𝑑𝑚

𝑊𝑖 = 1 − 6

,

(29)

√︃

with 𝑑𝑖 =
(𝜃𝑖,1 − 𝜃0,1)2 + (𝜃𝑖,2 − 𝜃0,2)2, and 𝑑𝑚 = 𝑛𝑑𝑚𝑎𝑥, where
𝑑𝑚𝑎𝑥 is the distance of the furthest NN from 𝜽0 (as it is shown in
Fig. 1), and 𝑛 > 1. In this work we have taken 𝑛 = 2.

,

(25)

3.2 Grid reﬁnement

The reconstruction begins with a rectangular grid with 𝑁1 × 𝑁2 nodes
with respect to the rectangular coordinates 𝜃1 and 𝜃2, deﬁned over
the region where the reconstruction takes place.

For the reﬁnement process, by means of a Gaussian distribution
with standard deviation 𝜎𝑑, we draw 𝑁𝑑 new nodes around each
of the main deﬂectors when they are known. If that is not the case,
by default, such new nodes are drawn with respect to the center of
the region of reconstruction. We keep only those new nodes that
lie within a radius 𝑅𝑑 > 𝜎𝑑 from the given main deﬂector. The
aim of 𝑅𝑑 is to regulate the density of nodes, whereas weak lensing
is dominant. With this distribution of nodes, the reconstruction is
capable to provide a better description of those regions with high
mass concentrations.

Additionally, around each of the multiple images, we set a circu-
lar neighborhood of radius 𝑟𝑑 and determine the number of nodes

MNRAS 000, 1–24 (2021)

θ1θ2dmax6

D. A. Torres-Ballesteros and L. Castañeda

Figure 2. In this ﬁgure the blue dot represents the position of the main deﬂector, the red dots represent the multiple images, and the black dots represent the
nodes in the given grid. Here we have the initial grid (left panel), upon which the ﬁrst reﬁnement is applied at the end of the ﬁrst outer level iteration (middle
panel). The reﬁnement continues until the reconstruction ends, giving us the ﬁnal grid (right panel).

within such neighborhood. If it is less than 𝑄, by means of a uniform
distribution, we add the number of nodes required to get 𝑄 nodes.
Otherwise, we do not add new nodes. For each outer iteration, 𝑟𝑑
is reduced by a factor 𝑢. This adaptive process provides a higher
resolution, and thus a more accurate reproduction the multiply im-
aged systems. We apply this process only to the strong regime, since,
in general terms the identiﬁcation of the multiply imaged systems
and their positions, as well as the penalty functions themselves, are
less noisy than those from the weak regime; and we want to avoid
overﬁtting such noise as much as possible.

An example of the reﬁnement process for a single deﬂector is

depicted in Fig. 2.

3.3 Penalty functions

In this section we discuss how the diﬀerent contributions to the
penalty function (10) are deﬁned, and how they contribute to (17).

As we described before, the reconstruction method consists of two
levels of iterations, where the system of linear equations is computed
at the inner level. So that, when we compute such system of equa-
tions, those terms that mess up with the linearity with respect to
the deﬂection potential are computed using the deﬂection potential
from the previous inner iteration. In consequence, such terms can be
considered as constants during the current inner iteration. If we are
at the ﬁrst inner iteration, we make use of 𝜓 (𝑚−1) , with 𝑚 ≥ 1 being
the current outer iteration.

3.3.1 Strong regime

The strong regime is constrained by using the multiply imaged sys-
tems available, as discussed in Sec. 2. In particular, we focus on their
angular position, which makes natural to deﬁne the penalty function
for this regime as

𝜒2

𝑠 :=

𝑁𝑠
∑︁

(cid:32) 𝑁𝑖
∑︁

𝑖=1

𝑛=1

𝑇
𝑖𝑛S−1

𝑙,𝑖𝑛 𝒑𝑖𝑛

𝒑

(cid:33)

,

(30)

M𝑖𝑛 =𝜇𝑖𝑛

where 𝑁𝑠 and 𝑁𝑖 are ,respectively, the number of multiply imaged
systems that are being used, and the number of images the 𝑖-th system
has. On the other hand, 𝒑𝑖𝑛 := 𝜽𝑖𝑛 − 𝜽 (cid:48)
𝑖𝑛 compares the 𝑛-th observed
image position 𝜽 (cid:48)
𝑖𝑛 from the 𝑖-th system to the corresponding position
𝜽𝑖𝑛 computed from the reconstruction. The uncertainties in 𝜽 (cid:48)
𝑖𝑛 at

MNRAS 000, 1–24 (2021)

each component are 𝜎1,𝑖𝑛 and 𝜎2,𝑖𝑛, which are introduced trough

𝑆𝑙,𝑖𝑛 =

(cid:32) 𝜎2
1,𝑖𝑛
0

(cid:33)

.

0
𝜎2

2,𝑖𝑛

(31)

The problem with (30) relies on the need to explicitly solve the
lens equation, which makes diﬃcult to explicitly write it in terms
of 𝜓 on every node. For that reason, working on the source plane
instead, turns out to be an advantage. In this direction, let us deﬁne
two diﬀerent penalty functions.

Type 1: Since any multiply imaged system is linked to a unique
source, when we apply the lens equation (6) to such images, they
have to take us to the same source with position 𝜷. Hence, for the
𝑖-th system we can compare the source position 𝜷𝑖𝑛 predicted by
the reconstruction for the 𝑛-th image to the source true position 𝜷(cid:48)
𝑖,
however, since such true position is unknown, the average source
position predicted by the reconstruction

(cid:104)𝜷𝑖(cid:105) =

1
𝑁𝑖

𝑁𝑖
∑︁

𝑛=1

𝜷𝑖𝑛

(32)

is commonly used instead. Here 𝜷𝑖𝑛 = 𝜽 (cid:48)
𝑖𝑛 − 𝑍𝑖𝜶𝑖𝑛. This approach
also constrains the multiple images to converge to the same source
as needed.

One cannot simply work on the source plane and make use of the
observed uncertainties, since the eﬀect of the lens is important. As
it is discussed in (Schneider et al. 2006, Part 2, Section 4.6), the
magniﬁcation induced on the images by the mapping 𝜷 → 𝜽 also
aﬀects their position uncertainties. Therefore, as a correction to this
matter, by applying the Taylor expansion to the lens equation (6) up
to ﬁrst order derivatives around (cid:104)𝜷𝑖(cid:105)1, we get
𝒑𝑖𝑛 = M𝑖𝑛 (cid:0)𝜷𝑖𝑛 − (cid:104)𝜷𝑖(cid:105)(cid:1) ,

(33)

where

(cid:18) 1 − 𝑍𝑖 𝜅𝑖𝑛 + 𝑍𝑖 𝛾1,𝑖𝑛
𝑍𝑖 𝛾2,𝑖𝑛
(cid:18) 𝑚1,𝑖𝑛 𝑚2,𝑖𝑛
𝑚3,𝑖𝑛 𝑚4,𝑖𝑛

(cid:19)

.

𝑍𝑖 𝛾2,𝑖𝑛
1 − 𝑍𝑖 𝜅𝑖𝑛 − 𝑍𝑖 𝛾1,𝑖𝑛

(cid:19)

(34)

=𝜇𝑖𝑛

1 We use (cid:104)𝜷𝑖 (cid:105) since the true source position 𝜷𝑖 is unknown.

θ1θ2θ1θ1relensing: Reconstructing the mass proﬁle of galaxy clusters from gravitational lensing

7

is the magniﬁcation matrix at 𝜽 (cid:48)

𝑖𝑛, and

(cid:17)

(35)

𝜇𝑖𝑛 =

1
(1 − 𝑍𝑖 𝜅𝑖𝑛)2 − 𝑍 2
𝑖

(cid:16)

1,𝑖𝑛 + 𝛾2
𝛾2
is magniﬁcation the of the corresponding image as well. It is impor-
tant to take into account that the approximation (33) holds as long as
the predicted images are as close as possible to the observed ones.

2,𝑖𝑛

It has been shown that only the magniﬁcation 𝜇𝑖𝑛 is enough to
account for this correction (e.g. Bradač et al. (2005b)). We stick
to this for the reconstructions presented in this work. Nevertheless,
due to the nature of this reconstruction method, considering only
the magniﬁcation (at least for our implementation) can lead to a
divergent solution; the method may become numerically unstable.
For instance, considering M𝑖𝑛 as a hole helps to control the impact
of 𝜇𝑖𝑛 making the reconstruction more stable, with the cost of losing
some accuracy around the mass peaks. Now, the implementation of
either 𝜇𝑖𝑛 or M𝑖𝑛 introduce nonlinearities on (17), so that they are
not explicitly written in terms of 𝜓 𝑗 . Instead, they are computed from
the last 𝜓 that is known, and are manipulated as constant terms.

With respect to (cid:104)𝜷𝑖(cid:105), one can compute it in the same way as 𝜇𝑖𝑛
and M𝑖𝑛 are computed (as it is done in e.g. Bradač et al. (2005a,
2009)). However, at least for our implementation this approach is not
eﬀective, since when either 𝜇𝑖𝑛 or M𝑖𝑛 is included the reconstruction
shows the tendency to produce an overestimation of 𝜅, close to some
of the grid corners, and it cannot be eﬀectively solved simply by
considering a wider region for the reconstruction or changing the grid
size. This problem is solved by explicitly writing the components of
(cid:104)𝜷𝑖(cid:105) in terms of 𝜓 𝑗 as

(cid:104)𝛽𝑞,𝑖(cid:105) =

1
𝑁𝑖

𝑁𝑖
∑︁

𝑝=1

𝜃 (cid:48)
𝑞,𝑖 𝑝 −

1
𝑁𝑖

𝑁𝑖
∑︁

(cid:32) 𝑁
∑︁

𝑝=1

𝑗=1

(cid:33)

D𝑞,𝑖 𝑝 𝑗 𝜓 𝑗

,

from which we have that

1
𝑁𝑖

𝑁𝑖
∑︁

𝑝=1

𝜃 (cid:48)
𝑞,𝑖 𝑝,

(cid:104)𝜃𝑞,𝑖(cid:105) :=

and

𝜕 (cid:104)𝛽𝑞,𝑖(cid:105)
𝜕𝜓𝑘

:= −

𝑍𝑖
𝑁𝑖

𝑁𝑖
∑︁

𝑝=1

D𝑞,𝑖 𝑝𝑘 ,

(36)

(37)

(38)

with 𝑞 = 1, 2 representing each component. Under this approach, we
also get an improvement in the performance. For a tolerance of 10−3
we observed in the diﬀerent reconstructions presented in this work a
reduction in the number of inner iterations of at least ten times. Also,
structure was clearly shown after the ﬁrst or second inner iteration,
and the condition (20) was fulﬁlled within 4 − 6 inner iterations.

At this point, we have that our ﬁrst penalty function is easily
𝑠 , its contribution to

obtained by replacing (33) into (30). Having 𝜒2
(17) is given through

W (𝑠)
𝑘 𝑗

:=

𝑁𝑠
∑︁

𝑁𝑖
∑︁

2
∑︁

𝑖=1

𝑛=1

𝑞=1

(cid:32)

𝑍𝑖 𝐵𝑞,𝑖𝑛𝑘

D𝑞,𝑖𝑛 𝑗 −

(cid:33)

,

D𝑞,𝑖 𝑝 𝑗

1
𝑁𝑖

𝑁𝑖
∑︁

𝑝=1

and

V (𝑠)
𝑘

=

𝑁𝑠
∑︁

𝑁𝑖
∑︁

2
∑︁

(cid:34)

𝑖=1

𝑛=1

𝑞=1

(cid:32)

𝑏𝑞,𝑖𝑛

𝑍𝑖 D𝑞,𝑖𝑛𝑘 +

(cid:33)

𝜕 (cid:104)𝛽𝑞,𝑖(cid:105)
𝜕𝜓𝑘

− 𝐵𝑞,𝑖𝑛𝑘 (cid:104)𝜃1,𝑖(cid:105)

(cid:35)

,

where we have deﬁned

(cid:32)

𝐵1,𝑖𝑛𝑘 :=𝜇2
𝑖𝑛

𝑍𝑖Δ𝑚1,𝑖𝑛 𝐷1,𝑖𝑛𝑘 + 𝑍𝑖Δ𝑚2,𝑖𝑛 𝐷2,𝑖𝑛𝑘

+ Δ𝑚1

𝜕 (cid:104)𝛽1,𝑖(cid:105)
𝜕𝜓𝑘

+ Δ𝑚2

(cid:33)

,

𝜕 (cid:104)𝛽2,𝑖(cid:105)
𝜕𝜓𝑘

(cid:32)

𝐵2,𝑖𝑛𝑘 :=𝜇2
𝑖𝑛

𝑍𝑖Δ𝑚2,𝑖𝑛 𝐷1,𝑖𝑛𝑘 + 𝑍𝑖Δ𝑚3,𝑖𝑛 𝐷2,𝑖𝑛𝑘

+ Δ𝑚2

𝜕 (cid:104)𝛽1,𝑖(cid:105)
𝜕𝜓𝑘

+ Δ𝑚3

(cid:33)

,

𝜕 (cid:104)𝛽2,𝑖(cid:105)
𝜕𝜓𝑘

𝑏1,𝑖𝑛 := 𝜇2
𝑖𝑛

and
𝑏2,𝑖𝑛 := 𝜇2
𝑖𝑛

(cid:16)

(cid:16)

Δ𝑚1,𝑖𝑛𝜃1,𝑖𝑛 + Δ𝑚2,𝑖𝑛𝜃2,𝑖𝑛

Δ𝑚2,𝑖𝑛𝜃1,𝑖𝑛 + Δ𝑚3,𝑖𝑛𝜃2,𝑖𝑛

(cid:17)

,

(cid:17)

,

with

Δ𝑚1,𝑖𝑛 :=

Δ𝑚2,𝑖𝑛 :=

and

Δ𝑚3,𝑖𝑛 :=

+

(cid:33)

,

𝑚2

3,𝑖𝑛

𝜎2

2,𝑖𝑛

(cid:32) 𝑚2

1,𝑖𝑛

𝜎2

1,𝑖𝑛
(cid:32) 𝑚1,𝑖𝑛𝑚2,𝑖𝑛
𝜎2
1,𝑖𝑛

+

𝑚3,𝑖𝑛𝑚4,𝑖𝑛
𝜎2

2,𝑖𝑛

(cid:33)

,

(cid:32) 𝑚2

2,𝑖𝑛

𝜎2

1,𝑖𝑛

+

(cid:33)

.

𝑚2

4,𝑖𝑛

𝜎2

2,𝑖𝑛

(41)

(42)

(43)

(44)

(45)

(46)

(47)

Type 2: In this case, for each of the multiply imaged systems, we
compare the possible pairs formed from the position of the source
predicted for each of the corresponding multiple images. Therefore,
the penalty function reads
(cid:32) 𝑁𝑖−1
∑︁

𝑁𝑠
∑︁

𝑁𝑖
∑︁

(cid:33)

𝑇
𝑖𝑛𝑚S−1

𝑙,𝑖𝑛𝑚𝒃𝑖𝑛𝑚

𝒃

,

𝜒2

𝑠 :=

(48)

𝑖=1

𝑛=1

𝑚=𝑛+1

where 𝒃𝑖𝑛𝑚 = 𝜷𝑖𝑛 − 𝜷𝑖𝑚, with 𝜷𝑖𝑛 = 𝜽 (cid:48)
𝑖𝑛 − 𝑍𝑖𝜶𝑖𝑛 and 𝜷𝑖𝑚 =
𝜽 (cid:48)
𝑖𝑚 − 𝑍𝑖𝜶𝑖𝑚. In order to account for the correction discussed above,
that is needed in order to be able to work at source plane, we have
deﬁned

𝜎2

1,𝑖𝑚
𝜇2

𝑖𝑚

𝑆𝑙,𝑖𝑛𝑚 =

𝜎2

1,𝑖𝑛
𝜇2
𝑖𝑛

+

0

1
2

(cid:169)
(cid:173)
(cid:173)
(cid:173)
(cid:173)
(cid:173)
(cid:171)

0

+

𝜎2

2,𝑖𝑛
𝜇2
𝑖𝑛

.

(cid:170)
(cid:174)
(cid:174)
(cid:174)
(cid:174)
(cid:174)
(cid:172)

𝜎2

2,𝑖𝑚
𝜇2

𝑖𝑚

Here, the contribution of 𝜒2
𝑁𝑖−1
∑︁

𝑁𝑠
∑︁

𝑁𝑖
∑︁

2
∑︁

𝑠 to (17) yields
(cid:32) 𝑍 2
𝑖

W (𝑠)
𝑘 𝑗

:=

𝑖=1

𝑛=1

𝑚=𝑛+1

𝑞=1

𝜎2

𝑞,𝑖𝑛𝑚

ΔD𝑞,𝑖𝑛𝑚𝑘 ΔD𝑞,𝑖𝑛𝑚 𝑗

(49)

(cid:33)

,

(50)

(39)

and

V (𝑠)
𝑘

:=

𝑁𝑠
∑︁

𝑁𝑖−1
∑︁

𝑁𝑖
∑︁

(cid:32)

2
∑︁

𝑍𝑖

𝑖=1

𝑛=1

𝑚=𝑛+1

𝑞=1

𝜎2

𝑞,𝑖𝑛𝑚

where we have deﬁned

ΔD𝑞,𝑖𝑛𝑚𝑘 Δ𝜃𝑞,𝑖𝑛𝑚

,

(51)

(cid:33)

(40)

ΔD𝑞,𝑖𝑛𝑚 𝑝 := D𝑞,𝑖𝑛 𝑝 − D𝑞,𝑖𝑚 𝑝
with 𝑝 = 𝑘, 𝑗, and
Δ𝜃𝑞,𝑖𝑛𝑚 := 𝜃 (cid:48)

𝑞,𝑖𝑛 − 𝜃 (cid:48)

𝑞,𝑖𝑚.

(52)

(53)

MNRAS 000, 1–24 (2021)

8

D. A. Torres-Ballesteros and L. Castañeda

3.3.2 Weak regime

such that for |𝑔𝑖 | ≤ 1 we get

Following Bradač et al. (2005a), we constrain the weak regime by
means of sources apparent ellipticity, as discussed in Sec. 2. There-
fore, for this regime the penalty function is deﬁned as

𝜒2

𝑤 :=

𝑁𝑤
∑︁

𝑖=1

|𝜖𝑖 − (cid:104)𝜖𝑖(cid:105) |2
𝜎2
𝑖

,

(54)

with 𝑁𝑤 being the number of background galaxies for which their
ellipticity and redshift is known. Additionally Schneider et al. (2006)

𝐴1,𝑖 =

𝐴5,𝑖 =

𝑎3,𝑖 =

𝑍 2
𝑖
𝜎2

≤,𝑖
𝑍 2
𝑖
𝜎2

≤,𝑖
𝑍𝑖
𝜎2

≤,𝑖

𝜖1,𝑖,

𝐴2,𝑖 =

|𝜖𝑖 |2,

𝑎1,𝑖 =

|𝜖𝑖 |2,

𝑍 2
𝑖
𝜎2

≤,𝑖
𝑍𝑖
𝜎2

≤,𝑖

𝜖2,𝑖,

𝐴3,𝑖 = 𝐴4,𝑖 =

𝑍 2
𝑖
𝜎≤,𝑖

,

𝜖1,𝑖,

𝑎2,𝑖 =

𝑍𝑖
𝜎2

≤,𝑖

𝜖2,𝑖,

(60)

meanwhile for |𝑔𝑖 | > 1 the coeﬃcients are

𝜎2

𝑖 =

(cid:16)

1
𝑁 𝑝,𝑖

1 − 𝑚𝑖𝑛

(cid:16)

|𝑔𝑖 |2, |𝑔𝑖 |−2(cid:17)(cid:17)2

𝜎2

𝜖 𝑠 + 𝜎2

𝑒𝑟𝑟 ,

(55)

𝐴1,𝑖 =

where 𝑁 𝑝,𝑖 corresponds to the number of averaged apparent elliptic-
ities in (9). Such ellipticities are from sources with the same redshift,
and located in a neighborhood within which the properties of the
lens do not change signiﬁcantly Bartelmann & Schneider (2001);
Schneider et al. (2006). Now, since in practice it is not easy to fulﬁll
these conditions, the best choice is to take 𝑁 𝑝,𝑖 = 1, and so consider
𝜖𝑖 to be the best representative of its sample at its neighborhood
Bradač et al. (2005a). That is why in (54) 𝜖𝑖 is compared to (cid:104)𝜖𝑖(cid:105). The
quantities 𝜎𝜖𝑠 and 𝜎𝑒𝑟𝑟 in (55) correspond to the intrinsic and ob-
servational ellipticity standard deviations, respectively. In this paper
we take 𝜎𝜖𝑠 ∼ 0.2 − 0.3 and 𝜎𝑒𝑟𝑟 = 0.1 Bradač et al. (2005a); Cain
et al. (2016).

An alternative approach to 𝜒2

𝑤 can be found in e.g. Merten et al.

(2009, 2011); Merten (2016).

According to (9), the penalty function (54) has two possible forms.

To begin with, for |𝑔𝑖 | ≤ 1 (54) turns into

𝑁𝑤
∑︁

𝜒2

𝑤 =

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

1
𝜎2
𝑖

𝜖𝑖 −

𝑍𝑖 𝛾𝑖
1 − 𝑍𝑖 𝜅𝑖

𝑁𝑤
∑︁

=

(cid:12)
2
(cid:12)
(cid:12)
(cid:12)
(cid:12)

𝜖𝑖 − 𝑍𝑖𝜖𝑖 𝜅𝑖 − 𝑍𝑖 𝛾𝑖

(1 − 𝑍𝑖 𝜅𝑖)2 𝜎2
𝑖

(cid:12)
2
(cid:12)
(cid:12)

,

(56)

𝑖=1

𝑖=1
whereas for |𝑔𝑖 | > 1 (54) becomes

(cid:12)
(cid:12)
(cid:12)

(cid:12)
(cid:12)
(cid:12)

In practice, the observations mainly come from sources that sat-
isfy |𝑔𝑖 | < 1. However, we have implemented both possibilities in
relensing, such that, for every inner iteration we evaluate |𝑔𝑖 | from
the last deﬂection potential that we have. With that, relensing
decides whether to use (56) or (57) as the corresponding penalty
function for the weak regime.
For both versions of 𝜒2

𝑤 the coeﬃcients W 𝑤

𝑘 𝑗 and V 𝑤
𝑘

can be

written as

W (𝑤)
𝑘 𝑗

:=

(cid:34)

𝑁𝑤
∑︁

𝑖=1

(cid:32)

(cid:33)

𝐴1,𝑖

G1,𝑖𝑘 K𝑖 𝑗 + K𝑖𝑘 G1,𝑖 𝑗

(cid:32)

(cid:33)

+ 𝐴2,𝑖

G2,𝑖𝑘 K𝑖 𝑗 + 𝐾𝑖𝑘 G2,𝑖 𝑗

+ 𝐴3,𝑖 G1,𝑖𝑘 G1,𝑖 𝑗

+ 𝐴4,𝑖 G2,𝑖𝑘 G2,𝑖 𝑗 + 𝐴5,𝑖K𝑖𝑘 K𝑖 𝑗 ,

(cid:35)

,

and

V (𝑤)
𝑘

:=

(cid:32)

𝑁𝑤
∑︁

𝑖=1

𝑎1,𝑖 G1,𝑖𝑘 + 𝑎2,𝑖 G2,𝑖𝑘 + 𝑎3,𝑖K𝑖𝑘

(cid:33)

,

MNRAS 000, 1–24 (2021)

𝜖1,𝑖,

𝐴2,𝑖 =

𝑍 2
𝑖
𝜎2

>,𝑖

𝜖2,𝑖,

𝐴3,𝑖 = 𝐴4,𝑖 =

𝑍 2
𝑖
𝜎2

>,𝑖

|𝜖𝑖 |2,

𝑎1,𝑖 =

𝑍𝑖
𝜎2

>,𝑖

𝜖1,𝑖,

𝑎2,𝑖 =

𝑍𝑖
𝜎2

>,𝑖

𝜖2,𝑖,

,

,

(61)

𝑍 2
𝑖
𝜎2

>,𝑖
𝑍 2
𝑖
𝜎2

>,𝑖
𝑍𝑖
𝜎2

>,𝑖

𝐴5,𝑖 =

𝑎3,𝑖 =

≤,𝑖 := (1 − 𝑍𝑖 𝜅𝑖)2𝜎2
𝑖 . Here, both 𝜎2
>,𝑖 := 𝑍 2
≤,𝑖
>,𝑖 are computed from the last 𝑝𝑠𝑖 that is known, so that they

with 𝜎2
and 𝜎2
are manipulated as constant terms.

𝑖 and 𝜎2

𝑖 |𝛾𝑖 |2𝜎2

3.3.3 Regularization terms

This sort of grid based reconstruction methods require a term which
provides stability along the reconstruction. Such term helps to deal
with numerical noise, which otherwise will most likely lead to diver-
gent solutions for (17).

Diﬀerent solutions have been proposed to overcome these diﬃcul-
ties, either as a regularization term (e.g Seitz et al. (1998); Bradač
et al. (2005a,b); Merten (2016)), or by introducing the signal to noise
ratio (e.g Deb et al. (2008)). Here, as we have stated before, we have
chosen to implement the former approach, particularly by using the
regularization terms

(62)

(63)

and

𝜒2
𝛾 (𝑅) = 𝜂𝛾

𝑁
∑︁

2
∑︁

(cid:16)

𝑗=1

𝑞=1

𝛾𝑞, 𝑗 − 𝛾 (𝑚−1)

𝑞, 𝑗

(cid:17)2

,

with 𝜂𝜅 and 𝜂𝛾 being positive deﬁned constants. Such constants
or regularization weights, control how smooth the reconstruction
turns. The term (62) acts mainly within the cluster inner region
dominated by the strong regime, while the term (63) helps to control
the reconstruction outside the inner region.

, 𝛾 (𝑚−1)
1, 𝑗

, and 𝛾 (𝑚−1)
2, 𝑗

On the other hand, if we are in the 𝑚-th outer iteration, the terms
𝜅 (𝑚−1)
in (62) and (63), respectively, are com-
𝑗
puted after the grid reﬁnement at the end of the previous outer itera-
tion, or they come from the initial guess (𝑚 = 1).
Therefore, from (62) we get the coeﬃcients

(58)

W (𝜅)
𝑘 𝑗

:= 𝜂𝜅

𝑁
∑︁

𝑖=1

K𝑖𝑘 K𝑖 𝑗

and

(59)

V ( 𝜅)
𝑘

:= 𝜂𝜅

𝑁
∑︁

𝑖=1

𝜅 (𝑚−1)
𝑖

K𝑖𝑘 ,

(64)

(65)

𝜒2

𝑤 =

𝑁𝑤
∑︁

𝑖=1

1
𝜎2

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

𝜖𝑖 −

1 − 𝑍𝑖 𝜅𝑖
𝑍𝑖 𝛾∗
𝑖

(cid:12)
2
(cid:12)
(cid:12)
(cid:12)
(cid:12)

=

𝑁𝑤
∑︁

𝑖=1

𝑍𝑖𝜖𝑖 𝛾∗

(cid:12)
2
𝑖 + 𝑍𝑖 𝜅𝑖 − 1
(cid:12)
(cid:12)
𝑖 |𝛾𝑖 |2𝜎2
𝑍 2
𝑖

.

(57)

𝜒2
𝜅 (𝑅) = 𝜂𝜅

𝑁
∑︁

(cid:16)

𝑗=1

𝜅 𝑗 − 𝜅 (𝑚−1)
𝑗

(cid:17)2

,

relensing: Reconstructing the mass proﬁle of galaxy clusters from gravitational lensing

9

meanwhile for (63) we have

W (𝛾)
𝑘 𝑗

:= 𝜂𝛾

𝑁
∑︁

2
∑︁

𝑖=1

𝑞=1

G𝑞,𝑖𝑘 G𝑞,𝑖 𝑗 ,

and

V (𝛾)
𝑘

:= 𝜂𝛾

𝑁
∑︁

2
∑︁

𝑖=1

𝑞=1

𝛾 (𝑚−1)
𝑞,𝑖 G𝑞,𝑖𝑘 .

(66)

(67)

4 MOCK DISTRIBUTIONS: SIMPLE MODELS

For testing the performance of relensing we apply the reconstruc-
tion to two mock lenses, modeled by means of Non-singular Isother-
mal Spheres (NIS for short). Below, we describe how the mock
catalogues are created, and discuss the outcomes from their corre-
sponding reconstructions.

Hereinafter, for comparing the reconstructions to the true distribu-
tion, we use the relative diﬀerence Δ𝑟 𝑋 = (𝑋𝑟 𝑒𝑐𝑜 − 𝑋𝑡𝑟 𝑢𝑒)/𝑋𝑡𝑟 𝑢𝑒,
deﬁned for any quantity 𝑋 of interest.

4.1 Catalogues

For each model, the catalogues involved are drawn under the same
conditions.

For the strong regime, we consider 40 sources randomly selected
with redshift 𝑧𝑠 > 𝑧𝑙, and for which more than one image is obtained
after solving the lens equation (6). Whereas for the weak regime we
consider 1000 background sources with redshift 𝑧𝑤 > 𝑧𝑙, whose el-
lipticities catalogue is constructed in the same direction as in Bradač
et al. (2005a); Cain et al. (2016). Thus, the intrinsic ellipticities are
drawn from a Gaussian distribution with 𝜎𝜖 𝑠 = 0.2, then, to each
component of the observed ellipticities (which are computed from
(7)) an error is added. Such an error is drawn from a Gaussian dis-
tribution with 𝜎𝑒𝑟𝑟 = 0.1. Their redshifts are drawn from a Gamma
distribution with shape and rate parameters 𝛼 = 3 and 𝛽 = 3/2,
respectively. For each redshift, the corresponding added uncertainty
is drawn from a Gaussian distribution with 𝜎𝑧,𝑖 = 0.05(1 + 𝑧𝑖) (with
𝑖 = 1, . . . , 𝑁𝑤 ). We keep those sources with only one image after
solving the lens equation.

4.2 NIS and 2NIS

The deﬂection potential for a NIS is deﬁned as

√︃

𝜓(𝜽) = 𝑅0

|Δ𝜽 |2 + 𝜃2

0 with 𝑅0 :=

4𝜋𝜎2𝐷 (𝑧𝑙, 𝑧)
𝑐2𝐷 (𝑧)

,

(68)

where Δ𝜽 := 𝜽 −𝜽 𝑐. Such deﬂection potential depends on the angular
diameter distance between the lens and the given source (𝐷 (𝑧𝑙, 𝑧)),
and also between the observer and the source (𝐷 (𝑧)). As well, it
depends on the velocity dispersion 𝜎, the speed of light 𝑐, the distri-
bution core 𝜃0, and distribution center 𝜽 𝑐.

The ﬁrst model we consider is a NIS with redshift 𝑧𝑙 = 0.4, with
center at 𝜽 𝑐 = (0, 0) 𝑎𝑟𝑐𝑚𝑖𝑛. It is characterized by the parameters
𝜃0 = 0.4 𝑎𝑟𝑐𝑚𝑖𝑛 and 𝜎 = 1500 𝑘𝑚/𝑠. The corresponding conver-
gence map for a source with redshift 𝑧𝑟 = 9 is depicted in Fig. 3
(True).

The second model consists of two identical NIS with redshift
𝑧𝑙 = 0.4, whose center is at 𝜽 𝑐1 = (−0.2, −0.4) 𝑎𝑟𝑐𝑚𝑖𝑛, and 𝜽 𝑐2 =
(0.2, 0.4) 𝑎𝑟𝑐𝑚𝑖𝑛, respectively. The parameters describing each of
those NIS are 𝜃0 = 0.2 𝑎𝑟𝑐𝑚𝑖𝑛 and 𝜎 = 1000 𝑘𝑚/𝑠, such that the

resulting convergence map for a source with redshift 𝑧𝑟 = 9 is shown
in Fig. 5 (True). We refer to this model as 2NIS.

4.3 Reconstruction

The reconstructions are carried out considering 𝜂𝜅 = 𝜂𝛾 = 200
irrespectively of the initial guess 𝜓 (0) . Here, for the NIS we only
consider blind reconstructions, and then we explore the eﬀect of
the smoothing on such reconstructions. Whereas, for the 2NIS we
compare blind reconstructions against those for which 𝜓 (0) is given
by a Non-singular Isothermal Ellipsoid (NIE for short), as we discuss
later.

Now, for the initial grid, when only the strong regime is being
considered (s), we use 20 × 20 nodes over a region of 3 × 3 𝑎𝑟𝑐𝑚𝑖𝑛2,
meanwhile, when both regimes are being considered (s+w), we take
22×22 nodes over a region of 3.2×3.2 𝑎𝑟𝑐𝑚𝑖𝑛2. For the last scenario,
the extra nodes and grid size help to avoid overestimations of the
diﬀerent quantities of interest on the boundary (particularly 𝜅), which
arise when some observations are close to such boundary.

With respect to the reﬁnement process, the NIS shows only one
deﬂector, so that we add 𝑁𝑑 = 600 nodes for each reﬁnement. On
the other hand, the 2NIS consists of two deﬂectors, so that we add
𝑁𝑑 = 300 nodes for each deﬂector. In both cases, those new nodes are
distributed considering 𝜎𝑑 = 1 𝑎𝑟𝑐𝑚𝑖𝑛, and 𝑅𝑑 = 2 𝑎𝑟𝑐𝑚𝑖𝑛. Also,
we take 𝑟𝑑 = 0.2 𝑎𝑟𝑐𝑚𝑖𝑛 for the ﬁrst reﬁnement process, which is
reduced by a factor 𝑢 = 0.8 at each of the subsequent reﬁnements,
except for the last one for which the reﬁnement is not applied. As
we discussed in Sec. 3.1, we set 𝑄 = 25 nodes to perform the ﬁnite
diﬀerences.

4.3.1 Convergence

In Fig. 3 we can see eight diﬀerent reconstructed convergence maps
(𝜅), along with the true mass for the NIS; which is the simplest of the
distributions that we are considering in this work. This distribution
posses spherical symmetry, for which we have only considered blind
reconstructions here, since a parametric ﬁtting to the data from the
strong regime either to a NIS itself or to a NIE leads to the true lens
(or at least a distribution close to it), and that is not what we want.
One of the aims of this work is to show the power of the method
to reveal important features of the lens, based upon little knowledge
about it, which is closer to what one has to face with real data.

Let us start with the eﬀect of the smoothing. The Fig. 3 shows in the
upper row the reconstructions for both penalty functions 𝜒2
𝑠 without
considering the smoothing (reconstructions (1) − (4)), meanwhile,
in the middle row the reconstructions were carried out under the
very same conditions, but with considering the smoothing (recon-
structions (5) − (8)); so that reconstruction (1) is directly compared
to reconstruction (5), and so on. It is clear that the reconstructions
reveal the central peak regardless of the smoothing, the penalty func-
tion used, or whether weak lensing is being considered. However,
in Fig. 4 we can see that the inclusion of the smoothing provides a
better reconstruction once we move towards the outskirts.

Comparing Type 1 and Type 2 reconstructions (carried out un-
der the same conditions), we can see that there are no signiﬁcant
diﬀerences when it comes to the results given by both penalty func-
tions. Instead, a signiﬁcant diﬀerence appears when the smoothing
is included. Without smoothing, the contours in 𝜅 are noisier and
less accurate, particularly outside the inner region. This is clearer
when weak lensing constraints are being considered. Here, for the
inner region we refer to the region that encloses all the multiple

MNRAS 000, 1–24 (2021)

10

D. A. Torres-Ballesteros and L. Castañeda

images known, as it is depicted in Fig. 4 (purple dashed contour).
That behaviour stands irrespectively of the lens distribution or the
input deﬂection potential 𝜓 (0) . This behavior is accentuated when
the complexity of the lens increases.

When only the strong regime is included, the reconstruction ef-
fectiveness is strongly restricted to the inner region, as we can see in
Fig. 4, where most of such region presents a relative diﬀerence within
|Δ𝑟 𝜅| < 0.1 (10%). In particular, we can see an improvement at the
inner region boundary when the smoothing is included. Outside the
inner region, the reconstruction loses its eﬀectiveness and there is an
underestimation of 𝜅, which is less accentuated when the smoothing
is added, but still present. Once strong and weak regimes are com-
bined, there is an overall enhancement in the reconstruction outside
the inner region, but without smoothing the increase in 𝜅 is less uni-
form, and we can still see marked peaks of both underestimations
and overestimations of 𝜅.

Now, we put our attention on 𝑀 = 𝑀 (≤ 𝜃), which represents
the mass enclosed within an angular radius 𝜃 measured from 𝜽 =
(0, 0) 𝑎𝑟𝑐𝑚𝑖𝑛. This applies to all the reconstructions considered in
this work. Here, Fig. 7 shows 𝑀 for the eight reconstructions, given
for 𝑎𝑟𝑐𝑚𝑖𝑛 ≤ 𝜃 ≤ 1.5 𝑎𝑟𝑐𝑚𝑖𝑛. The curves have been separated into
Type 1 (upper panel) and Type 2 (lower panel), so that we can directly
compare the eﬀects of using the strong/weak regime as well as the
smoothing. We can see that 𝑀 behaves similarly for Type 1 and Type
2 reconstructions. Again, we see that the best performance appears
within the inner region, where we can see a relative diﬀerence within
|Δ𝑟 𝑀 | ≤ 0.05 (5%).

The vertical lines in Fig 7, given for 𝜃𝑖𝑛 ≈ 0.86 𝑎𝑟𝑐𝑚𝑖𝑛 and
𝜃𝑜𝑢𝑡 ≈ 1.04 𝑎𝑟𝑐𝑚𝑖𝑛, correspond, respectively, to the inner and outer
radius of the inner region. It is within such limits, particularly close
to 𝜃𝑜𝑢𝑡 , that 𝑀 starts to deviate from the true curve. Beyond the
inner region, the eﬀectiveness decreases, and for the range within
which the reconstruction is being considered, the relative diﬀerence
gets up to |Δ𝑟 𝑀 | ≈ 0.16 (16%) for those reconstructions where only
strong lensing is being used; irrespectively of the smoothing. With
the inclusion of the weak regime, we see an improvement in 𝑀 of
∼ 7%.

We see that the estimation of 𝑀 is not severely aﬀected by the
smoothing, since the main features of the lens are recovered in both
cases. However, the smoothing provides a clear improvement in the
mass proﬁle, as well as in estimation of the magniﬁcations maps, and
therefore the critical curves; as we discuss later. Hence, from here on
we consider the smoothing in our reconstructions.

For the 2NIS we focus on the comparison between blind recon-
structions and those for which the input potential 𝜓 (0) or initial guess
contains some previous information about the lens. We want to keep
this initial guess as simple as possible, so that we cannot interfere in
excess, imposing many assumptions about the lens. For that reason,
as it has been shown in Bradač et al. (2005a), ﬁtting a NIE to the
multiply image systems provides a good enough estimation of 𝜓 (0) to
start working with. Depending on the complexity of the cluster, or its
morphological properties, it may be convenient to use a combination
of NIE as the initial guess. The deﬂection potential of such NIE is
deﬁned by making the transformation

|Δ𝜽 |2 −→(1 − 𝑒) (cid:0)Δ𝜃1 cos 𝜑 + Δ𝜃2 sin 𝜑(cid:1)2

+ (1 + 𝑒) (cid:0) − Δ𝜃1 sin 𝜑 + Δ𝜃2 cos 𝜑(cid:1)2

(69)

into (68), which accounts for the introduction of the ellipticity 𝑒 and
the rotation 𝜑 of the semi major axis with respect to the horizontal,
and measured counterclockwise. For the ﬁtting we have constrained
0 ≤ 𝑒 ≤ 0.25, so the proﬁle does not get distorted into a peanut

MNRAS 000, 1–24 (2021)

shaped one, as it is discussed in e.g. Golse & Kneib (2002). Here we
have let 𝜃0 = 0.2 𝑎𝑟𝑐𝑚𝑖𝑛 ﬁxed. Therefore, for the 2NIS, besides the
blind reconstruction we consider a NIE as the initial guess.

In Fig. 5 we can see the eight reconstructions taken into account.
The upper row shows the blind reconstructions (reconstructions (1) −
(4)), whereas the middle row shows the reconstruction carried out
under the same conditions except that the initial guess is given by
the NIE (reconstructions (5) − (8)). The lower panel shows the true
proﬁle.

The 2NIS is characterized by two prominent peaks or main deﬂec-
tors, which are eﬀectively recovered in all reconstructions. Therefore,
the initial guess is not relevant in this matter. In terms of the blind
reconstructions, we can see that they struggle to recover the distri-
bution beyond the inner region. It is expected for reconstructions (1)
and (3), which only use strong lensing, as we saw for the NIS. In
contrast, reconstructions (2) and (4), which also use weak lensing
show an improvement in Δ𝑟 𝜅 of about 10% − 20% towards the out-
skirts, as it is depicted in Fig. 6 (upper row). Within most of the inner
region 𝜅 shows a relative diﬀerence |Δ𝑟 |𝜅 < 0.1, with few peaks that
fall into 0.1 (10%) ≤ |Δ𝑟 𝜅| < 0.2 (20%).

At this point, it is clear that weak lensing strengthens the recon-
structions outside the inner region, so that the smoothing does not
have a negative impact on such regime. We focus now on how the
reconstruction behaves once one goes beyond blind reconstructions.
For reconstructions (5) − (8) we can see a considerable improvement
with respect to their blind counterpart. Comparing reconstructions
(1) and (5), as well as reconstructions (3) and (7) (which only use
strong lensing), we ﬁnd a closer approach to the true proﬁles, as it
can be seen in the contour curves in 𝜅 and also in the Δ𝑟 𝜅 maps in
Fig. 6. In addition, comparing reconstructions (2) and (6), as well
as reconstructions (4) and (8) (which use strong and weak lensing),
we can see that outside the inner region they go from an underesti-
mation to an overestimation of 𝜅, notwithstanding, the region where
|Δ𝑟 𝜅| < 0.1 is wider, and the overestimation lies beyond |Δ𝑟 𝜅| > 0.2,
mostly close to the boundaries, where the constraints are weaker. In
either case, within the inner region, there are no signiﬁcant changes
in the reconstruction. Likewise, Type 1 and Type 2 reconstructions
behave equally well.

With respect to 𝑀, which is computed within 0 𝑎𝑟𝑐𝑚𝑖𝑛 ≤ 𝜃 ≤
1.5 𝑎𝑟𝑐𝑚𝑖𝑛, we have a good agreement with the true mass with
a relative diﬀerence within |Δ𝑟 𝑀 | < 0.05 (5%) for 𝜃 ≤ 𝜃𝑖𝑛 ≈
0.74 𝑎𝑟𝑐𝑚𝑖𝑛, and close to 𝜃𝑜𝑢𝑡 ≈ 0.90 𝑎𝑟𝑐𝑚𝑖𝑛 the curves start to
deviate from the true one; except for the orange curves (reconstruc-
tions (6) and (8)) as it is depicted in Fig. 8. For 𝜃 > 𝜃𝑜𝑢𝑡 the
worst estimation of 𝑀 is given by reconstructions (1) and (3) (red
curves) for which Δ𝑟 𝑀 ≈ −0.25. They are followed by reconstruc-
tions (2) and (4) (blue curves), which show an improvement of at
most ∼ 7%. As expected from the results in 𝜅, a better scenario is
provided by reconstructions (5) and (7) (green curves), as well as
(6) and (8) (orange curves), for which the relative diﬀerence is at
most |Δ𝑟 𝑀 | ≈ 0.08 (8%) and |Δ𝑟 𝑀 | ≈ 0.01 (1%), respectively. It
is clear that there are not signiﬁcant diﬀerences between Type 1 and
Type 2 reconstructions.

Blind reconstructions work incredibly well, particularly if one is
interested in the inner region. However, in order to achieve a better
understanding of the outskirts, it is worth using an initial guess other
than the blind one. The drawback relies on what initial guess we use.
For the inner region there are no signiﬁcant eﬀects if there are enough
multiply imaged systems close to the mass peaks, but the outskirts are
more sensitive to such changes, where the method presents particular
diﬃculties in scaling down/up to values close to the true 𝜅, coming
from overestimations/underestimations given by the initial guess.

relensing: Reconstructing the mass proﬁle of galaxy clusters from gravitational lensing

11

Figure 3. Convergence maps (𝜅) for the NIS, given for a source with redshift 𝑧𝑟 = 9. The upper row shows the blind reconstructions without considering the
smoothing, while the middle row shows the blind reconstructions considering the smoothing. The true map is shown in the lower panel.

Figure 4. Relative diﬀerence Δ𝑟 𝜅 between the reconstructed and true convergence maps for the NIS shown in Fig. 3. Here, the red and green solid contours
correspond to Δ𝑟 𝜅 = 0.1 and Δ𝑟 𝜅 = −0.1, respectively. Meanwhile, the purple dashed contour delimits the region within which we have multiple images
available.

MNRAS 000, 1–24 (2021)

−101θ2(arcmin)Type1s(1)0.30.30.30.51.02.0Type1s+w(2)0.30.30.30.30.30.30.30.30.30.51.02.0Type2s(3)0.30.30.30.51.02.0Type2s+w(4)0.30.30.30.30.30.30.30.30.30.30.30.51.02.0−101θ2(arcmin)Type1s(5)0.30.51.02.0−101θ1(arcmin)Type1s+w(6)0.30.30.51.02.0−101θ1(arcmin)Type2s(7)0.30.51.02.0−101θ1(arcmin)Type2s+w(8)0.30.30.51.02.0−101θ1(arcmin)−101θ2(arcmin)True0.30.30.30.30.51.02.00.00.20.40.60.81.01.21.41.61.82.02.2−101θ2(arcmin)(1)(2)(3)(4)−101θ1(arcmin)−101θ2(arcmin)(5)−101θ1(arcmin)(6)−101θ1(arcmin)(7)−101θ1(arcmin)(8)-1.0-0.8-0.6-0.4-0.20.00.20.40.60.81.012

D. A. Torres-Ballesteros and L. Castañeda

Figure 5. Convergence maps (𝜅) for the 2NIS, given for a source with redshift 𝑧𝑟 = 9. The upper row shows the blind reconstructions, while the middle row
shows the reconstructions with an input 𝜓 (0) given by a NIE. For all reconstructions, the smoothing has been considered. The true map is shown in the lower
panel.

Figure 6. Same as in Fig. 4 but for the 2NIS.

MNRAS 000, 1–24 (2021)

−101θ2(arcmin)Type1s(1)0.30.51.01.0Type1s+w(2)0.30.51.01.0Type2s(3)0.30.51.01.0Type2s+w(4)0.30.51.01.0−101θ2(arcmin)Type1s(5)0.30.51.01.0−101θ1(arcmin)Type1s+w(6)0.30.30.30.30.51.01.0−101θ1(arcmin)Type2s(7)0.30.51.01.0−101θ1(arcmin)Type2s+w(8)0.30.30.30.30.30.51.01.0−101θ1(arcmin)−101θ2(arcmin)True0.30.51.01.00.00.20.40.60.81.01.21.41.61.82.02.2−101θ2(arcmin)(1)(2)(3)(4)−101θ1(arcmin)−101θ2(arcmin)(5)−101θ1(arcmin)(6)−101θ1(arcmin)(7)−101θ1(arcmin)(8)-1.0-0.8-0.6-0.4-0.20.00.20.40.60.81.0relensing: Reconstructing the mass proﬁle of galaxy clusters from gravitational lensing

13

Figure 7. Mass for the NIS within an angular radius 𝜃, centered at 𝜽 =
(0, 0) 𝑎𝑟 𝑐𝑚𝑖𝑛 (upper panel in each ﬁgure), and the relative diﬀerence Δ𝑟 𝑀
comparing the reconstructed and true mass (lower panel in each ﬁgure).
The curves are separated depending on the penalty function 𝜒2
𝑠 used in
the reconstruction, either Type 1 or Type 2. The label s corresponds to
reconstructions where only strong lensing was used, meanwhile the label s+w
stands for reconstructions for which both, strong and weak lensing were used.
Reconstructions with the label (sm) were carried out using the smoothing.
The vertical dashed lines represent the inner and outer radius of the inner
region (purple dashed contour in Fig. 4). The horizontal dashed lines enclose
|Δ𝑟 𝑀 | ≤ 0.1. Here, (sm) stands for those reconstructions for which the
smoothing was applied.

4.3.2 Magniﬁcation

Magniﬁcation maps are key elements in the study of galaxy clusters,
since they are needed to characterize the galaxy cluster, for example,
as a cosmic telescope, since the biggest magniﬁcations occur close
to the critical curves, allowing us to study distant objects. Also, they
help to identify new multiply imaged systems, as well as to extend
those already known. So then, we do not only need the critical curves,
but also the magniﬁcation itself, close to such curves. The quality
of the reconstructed magniﬁcation maps has been studied in e.g.
Meneghetti et al. (2017), where they compare the reconstruction
of the simulated galaxy clusters, Ares and Hera, given by diﬀerent
methods and approaches, in order to have a better understanding
of the results obtained for the HFF clusters. We present our own
reconstructions for Ares and Hera in Sec. 5.1.

In Fig. 9 and Fig. 11 we have the magniﬁcation maps |𝜇| for the
NIS and 2NIS, respectively, Those maps are depicted in concordance
with the convergence maps shown in Fig. 3 and Fig. 5.

Figure 8. Same as in Fig. 7 but for the 2NIS, with the diﬀerence that here
all reconstructions were carried out using the smoothing. Here, (b) stands for
blind reconstruction.

At critical curves, by deﬁnition 𝜇 diverges, so that they are depicted
as regions of high |𝜇|. Due to this behavior, even true deviations from
true critical curves are expected to make it diﬃcult to accurately
recover 𝜇.

For the NIS, we have that reconstructions (1) − (4) (upper row in
Fig. 9) produce critical curves that actually follow the form and size
of the true ones, but are noisy and quite irregular, particularly the
outer or tangential curve. Such irregularities in fact provide a |𝜇| map
with high error close to the critical curves, as it is depicted in Fig.
10 (upper row). Now, by including the smoothing in reconstructions
(5) − (8) (middle row in Fig. 9) we can see a better recovery of
critical curves. They are not as smooth as the true ones, but are less
irregular than curves (1) − (4). The improvement is not restricted to
the recovery of such critical curves in shape and size, but it extends to
the overall estimation of |𝜇|, particularly when weak lensing is used,
as it can be seen for reconstructions (6) and (8) in Fig. 10 (lower
row). Still, the highest deviations in |𝜇| appear close to the critical
curves.

Now, with respect to the 2NIS, in Fig. 11 we can see that there are
no signiﬁcant diﬀerences between the critical curves provided by the
eight reconstructions. All of them provide accurate reproductions of
the critical curves both in shape and size. However, for reconstruc-
tions (5) − (8) we get a better reproduction of |𝜇| as a whole, as it is
depicted in Fig. 12. Again, the highest deviations appear close to the
critical curves.

Additionally, in Fig. 13 and Fig. 14 we can see the critical and

MNRAS 000, 1–24 (2021)

0.01.53.04.56.07.5M(≤θ)(×1014M(cid:12))Type1ss+ws(sm)s+w(sm)True0.00.30.60.91.21.5θ(arcmin)-0.2-0.10.00.1∆rM0.01.53.04.56.07.5M(≤θ)(×1014M(cid:12))Type2ss+ws(sm)s+w(sm)True0.00.30.60.91.21.5θ(arcmin)-0.2-0.10.00.1∆rM0.01.53.04.56.07.5M(≤θ)(×1014M(cid:12))Type1s(b)s+w(b)ss+wTrue0.00.30.60.91.21.5θ(arcmin)-0.2-0.10.00.1∆rM0.01.53.04.56.07.5M(≤θ)(×1014M(cid:12))Type2s(b)s+w(b)ss+wTrue0.00.30.60.91.21.5θ(arcmin)-0.2-0.10.00.1∆rM14

D. A. Torres-Ballesteros and L. Castañeda

Figure 9. Magniﬁcation maps ( |𝜇 |) for the NIS, given for a source with redshift 𝑧𝑟 = 9. They correspond to the reconstructions shown in Fig. 3. The true map
is shown in the lower panel.

Figure 10. Relative diﬀerence Δ𝑟 |𝜇 | between the reconstructed and true magniﬁcation maps for the NIS shown in Fig. 9. Here, the red and green solid contours
correspond to Δ𝑟 𝜅 = 0.2 and Δ𝑟 𝜅 = −0.2, respectively. The black solid lines depict the true critical curves.

MNRAS 000, 1–24 (2021)

−101θ2(arcmin)(1)(2)(3)(4)−101θ2(arcmin)(5)−101θ1(arcmin)(6)−101θ1(arcmin)(7)−101θ1(arcmin)(8)−101θ1(arcmin)−101θ2(arcmin)True01020304050−101θ2(arcmin)(1)(2)(3)(4)−101θ1(arcmin)−101θ2(arcmin)(5)−101θ1(arcmin)(6)−101θ1(arcmin)(7)−101θ1(arcmin)(8)-1.0-0.8-0.6-0.4-0.20.00.20.40.60.81.0relensing: Reconstructing the mass proﬁle of galaxy clusters from gravitational lensing

15

Figure 11. Same as in Fig. 9 but for the 2NIS.

Figure 12. Same as in Fig. 10 but for the 2NIS.

MNRAS 000, 1–24 (2021)

−101θ2(arcmin)(1)(2)(3)(4)−101θ2(arcmin)(5)−101θ1(arcmin)(6)−101θ1(arcmin)(7)−101θ1(arcmin)(8)−101θ1(arcmin)−101θ2(arcmin)True01020304050−101θ2(arcmin)(1)(2)(3)(4)−101θ1(arcmin)−101θ2(arcmin)(5)−101θ1(arcmin)(6)−101θ1(arcmin)(7)−101θ1(arcmin)(8)-1.0-0.8-0.6-0.4-0.20.00.20.40.60.81.016

D. A. Torres-Ballesteros and L. Castañeda

Figure 13. Comparison between the reconstructed (blue) and true (red) crit-
ical (upper row) and caustic (lower row) curves for the NIS. The curves are
given for the reconstructions (6) and (8).

Figure 14. Same as in Fig. 13 but for the 2NIS.

caustic curves for the NIS and 2NIS, respectively, given for recon-
structions (6) and (8); which have shown the best performance as a
hole for both lenses. The critical curves have been computed apply-
ing the algorithm discussed in Bartelmann (2003). With respect to
the caustic curves, we have a good agreement with the true curves.
However, they are aﬀected by the irregularities in the critical curves.
This is particularly evident for the NIS, where the tangential critical

MNRAS 000, 1–24 (2021)

curve is supposed to be mapped into a point, but instead the recon-
structed caustic is wider and more irregular. This eﬀect has to be
taken into account when one is interested in predicting the existence
of new images or multiply imaged systems, as well as when it comes
to verifying the reproduction of the input data.

It is worth noting that transformation (18) does not aﬀect the re-
covery of neither the critical curves nor the convergence map and
thus the mass proﬁle, since 𝜅 and 𝛾 are invariant under this trans-
formation. Nevertheless, 𝜶 is not invariant, since 𝜶 → 𝜶(cid:48) = 𝜶 + 𝒄
translates the source plane. It is not an observable, but it results in a
translation of the caustic curves. We see that ﬁxing the correspond-
ing three degrees of freedom allows the reconstruction to properly
account for the caustic curves, as we have in Fig. 13 and Fig. 14
(lower row).

5 REALISTIC DISTRIBUTIONS: ARES AND HERA

At this point, we have explored under which conditions relensing
provides the best performance in its current state, by exploring the
reconstructions of the NIS and 2NIS. We move forward in order to
explore the validity of the reconstructions provided by relensing
in more realistic scenarios. We focus on the simulated clusters Ares
and Hera, which are intended to reproduce the complex structures
and lensing properties observed in the Hubble Frontier Fields (HFF)
clusters.

Ares is shown in Fig. 15 (left panel). It corresponds to a cluster
with redshift 𝑧𝑙 = 0.5, for which a semi-analytical approach was used
for its simulation, under a ﬂat ΛCDM cosmology with density param-
eter Ω𝑚,0 = 0.272 and Hubble constant 𝐻0 = 70.4 𝑘𝑚 𝑠−1 𝑀 𝑝𝑐−1.
Ares is characterized by two main distributions or main deﬂec-
tors (MD) located at ≈ (−0.335, −0.525) 𝑎𝑟𝑐𝑚𝑖𝑛 (MD 1) and
≈ (0.666, 0.666) 𝑎𝑟𝑐𝑚𝑖𝑛 (MD 2). Also, it is rich in well deﬁned
substructures as it is shown in Fig. 16 (lower panel).

On the other hand, Hera, with redshift 𝑧𝑙 = 0.507 is shown in Fig.
15 (right panel). Unlike Ares, the simulation of Hera was carried out
using a N-body approach, under a ﬂat ΛCDM cosmology with den-
sity parameters Ω𝑚,0 = 0.24, Ω𝑏,0 = 0.04 and Hubble constant 𝐻0 =
72 𝑘𝑚 𝑠−1 𝑀 𝑝𝑐−1. Like Ares, Hera shows two prominent peaks cor-
responding to the MD, located at ≈ (−0.001, 0.015) 𝑎𝑟𝑐𝑚𝑖𝑛 (MD
1) and ≈ (−0.361, 0.045) 𝑎𝑟𝑐𝑚𝑖𝑛 (MD 2). It also exhibits a clear
substructure at ≈ (0.113, −0.883) 𝑎𝑟𝑐𝑚𝑖𝑛, whose inﬂuence appears
in the convergence map Fig. 17 (lower panel), as well as in the mag-
niﬁcation map Fig. 22 (lower panel).

See Meneghetti et al. (2017) and the references therein for further
details on how the simulations of Ares and Hera were carried out, as
well as their lensing properties.

5.1 Reconstruction

For Ares, in the strong regime, there is available a catalogue that
consists of 85/242 systems/images. This amount of constraints ex-
ceeds those found e.g in the HFF clusters, for which the number
of constrains used/identiﬁed for their reconstructions have been e.g.
60/188 systems/images in Mahler et al. (2018) for Abell 2744, 45/138
systems/images in Lagattuta et al. (2019) for Abell 370, 19/52 sys-
tems/images in Karman et al. (2017) for Abell S1063, 48/138 sys-
tems/images in Bergamini et al. (2021); Vanzella et al. (2021) for
MACS J0416.1- 2403 (MACS 0416), 60/165 systems/images in
Limousin et al. (2016) for MACS J0717.5+ 3745 (MACS 0717), and
45/143 systems/images in Jauzac et al. (2016) for MACS J1149.5+
2223 (MACS 1149). The number of systems/images actually used for

-1.0-0.50.00.51.0θ1(arcmin)-1.0-0.50.00.51.0θ2(arcmin)(6)-1.0-0.50.00.51.0θ2(arcmin)(8)-0.4-0.20.00.20.4β1(arcmin)-0.4-0.20.00.20.4β2(arcmin)(6)-0.4-0.20.00.20.4β1(arcmin)(8)-1.0-0.50.00.51.0θ1(arcmin)-1.0-0.50.00.51.0θ2(arcmin)(6)-1.0-0.50.00.51.0θ2(arcmin)(8)-0.4-0.20.00.20.4β1(arcmin)-0.4-0.20.00.20.4β2(arcmin)(6)-0.4-0.20.00.20.4β1(arcmin)(8)relensing: Reconstructing the mass proﬁle of galaxy clusters from gravitational lensing

17

Figure 15. Images of Ares (left panel) and Hera (right panel) which have been composed from the F435W, F606W and F814W bands. The blue contours enclose
the multiple images, while the red dashed contours enclose the main deﬂectors. The images cover 3.4 × 3.4 𝑎𝑟 𝑐𝑚𝑖𝑛2.

the reconstructions is usually smaller, depending on the uncertainty
in their identiﬁcation. For the weak regime the ellipticities redshifts
are not available. Hence, we only use the strong regime for Ares
reconstructions.

In the case of Hera, for the strong regime we have fewer constraints,
being 19/65 systems/images. The impact on the number of constraints
is noticeable in the reconstruction, as we discuss below. Here, for the
weak regime the redshifts are available, therefore, for Hera we use
both strong and weak regimes to preform the reconstruction. The
reconstruction takes place in a region of 3.4 × 3.4 𝑎𝑟𝑐𝑚𝑖𝑛2 for which
we have 123 sources with their ellipticity and redshift.

relensing approaches the reﬁnement of the grid with respect
to the main deﬂectors. So then, in order to identify what cluster
members can be considered as main deﬂectors, one can simply apply
a quick blind reconstruction, which will show the peaks of mass
corresponding to those main deﬂectors. Following this process, we
identiﬁed the two main deﬂectors present in Ares, as well as in Hera.
Then, we estimated their location, which were aforementioned.

Now, with respect to the reconstructions, for each cluster we take
as initial guess a NIE as well as a 2NIE; since both cluster have two
main deﬂectors. Additionally, from our previous experience with
the NIS and 2NIS we have that Type 1 and Type 2 reconstructions
produce similar results. Hence, it is best to let them work together.

Considering the input potential and the type of reconstruction,
we are left with four combinations to carry out the reconstructions,
namely NIE + Type 1, NIE + Type 2, 2NIE + Type 1, and 2NIE
+ Type 2. For each combination we perform 10 realizations of the
reconstructions, which give us 40 reconstructions in total. The re-
sults we show in this section correspond to the average of those 40
reconstructions. We do this for Ares and Hera.

The conditions to perform the reconstructions are the same for
Areas and Hera. For all realizations we consider the smoothing.
We consider an initial grid of size 𝑛𝑥 × 𝑛𝑦 nodes over a region of
3.4 × 3.4 𝑎𝑟𝑐𝑚𝑖𝑛2; which covers the region shown in Fig. 15. Since
we are working on a square region, we consider 𝑛𝑥 = 𝑛𝑦, which are

randomly selected between 20 − 25 nodes. Likewise, 𝜂𝜅 = 𝜂𝛾 are
randomly selected between 100 − 200.

With respect to the reﬁnement process, we add 𝑁𝑑 new nodes for
each reﬁnement for each main deﬂector, which is randomly between
300−500. Such nodes are distributed with 𝜎𝑑 = 1 𝑎𝑟𝑐𝑚𝑖𝑛, and 𝑅𝑑 =
2 𝑎𝑟𝑐𝑚𝑖𝑛. The adaptive reﬁnement was done with 𝑟𝑑 = 0.2 𝑎𝑟𝑐𝑚𝑖𝑛
and 𝑢 = 0.8. For the ﬁnite diﬀerences we use 𝑄 = 25 nodes.

We have used almost the same parameters that we used for the NIS
and 2NIS, except for 𝑛𝑥, 𝑛𝑦, 𝜂𝜅 , 𝜂𝛾, and 𝑁𝑑, which were drawn from
a uniform distribution deﬁned in the given ranges. The selection took
place for each realization of the reconstruction.

5.1.1 Convergence

In Fig. 16 we ﬁnd the reconstructed (left panel) and true (right panel)𝜅
maps for Ares. It is clear that our reconstruction retrieves successfully
the two MD, as well as the general morphological characteristics
found in Ares. However, the reconstructions cannot account for the
rich substructure present in Ares.

Within the inner region we have that most of such region satisﬁes
|Δ𝑟 𝜅| < 0.1 (10%) as it is depicted in Fig. 18 (left panel), where we
also can ﬁnd few regions for which 0.1 (10%) ≤ Δ𝑟 𝜅 ≤ 0.2 (20%)
(red contour) and −0.2 (20%) ≤ Δ𝑟 𝜅 ≤ −0.1 (10%) (green contour).
Beyond that, we have |Δ𝑟 𝜅| > 0.2 (20%) at those locations with sub-
structure. Outside the inner region the quality of the reconstruction
decreases as expected, since we are using strong lensing only. The
discrepancy is higher towards the upper left and lower right corners,
due to the lack of observations there, as we can see in Fig. 15 (left
panel).

For Hera, we can see in Fig. 17 that our reconstruction (left panel)
recovers both MD, as well as the general shape and size shown
by Hera. However, they do not exhibit the substructure (enclosed
by the white dashed curve) found in the true proﬁle (right panel).
In Fig.18 (right panel) we can see that such substructure (enclosed
by the black dashed curve) lies outside the inner region, so that

MNRAS 000, 1–24 (2021)

-1.5-1.0-0.50.00.51.01.5θ1(arcmin)-1.5-1.0-0.50.00.51.01.5θ2(arcmin)MD1MD2Ares-1.5-1.0-0.50.00.51.01.5θ1(arcmin)-1.5-1.0-0.50.00.51.01.5θ2(arcmin)MD1MD2Hera18

D. A. Torres-Ballesteros and L. Castañeda

Figure 16. Convergence maps (𝜅) for Ares, given for a source with redshift 𝑧𝑟 = 9. The reconstruction and true map are shown respectively in the left and right
panels.

Figure 17. Same as in Fig. 16 but for Hera. The white dashed contour encloses the substructure present in the true map of Hera (right panel), and which is not
recovered by the reconstruction (left panel).

there are not multiple images there that allow relensing to ac-
count for it. Therefore, the absence of this substructure is due to
the lack of data there, and not a consequence of the reconstruction
method used. This behaviour is consistent with the reconstructions
discussed in Meneghetti et al. (2017). Now, similarly to Ares, we
can see that |Δ𝑟 𝜅| < 0.1 (10%), for most of the inner region, with
few regions where 0.1 (10%) ≤ Δ𝑟 𝜅 ≤ 0.2 (20%) (red contour) and
−0.2 (20%) ≤ Δ𝑟 𝜅 ≤ −0.1 (10%) (green contour). For the substruc-
ture we have Δ𝑟 𝜅 > −0.3 (30%).

In addition, for both Ares and Hera we can see in Fig. 18 that our
reconstructions present a deviation |Δ𝑟 𝜅| (cid:39) 0.1 (10%) around the
MD (violet solid contours), where the underestimations are present
at the exact location of the MD (green contours).

With respect to 𝑀, it is computed in the range 0 𝑎𝑟𝑐𝑚𝑖𝑛 ≤ 𝜃 ≤
1.7 𝑎𝑟𝑐𝑚𝑖𝑛. For Ares, the maximum relative diﬀerence that our
reconstruction produces is |Δ𝑟 𝑀 | ≈ 0.024 (2.4%), which appears

close to the center of the distribution. The deviation from the true 𝑀
is stable even between 𝜃𝑖𝑛 ≈ 1 𝑎𝑟𝑐𝑚𝑖𝑛 ≤ 𝜃 ≤ 𝜃𝑜𝑢𝑡 ≈ 1.56 𝑎𝑟𝑐𝑚𝑖𝑛,
and it starts to deviate beyond 𝜃𝑜𝑢𝑡 , as we saw for the NIS and 2NIS.
For Hera, we can see in Fig. 20 that the deviation from the true 𝑀
gets its higher value |Δ𝑟 𝜅| ≈ 0.12 (12%) for 𝜃 < 0.2 𝑎𝑟𝑐𝑚𝑖𝑛, which
approximately coincides with the mass estimation for MD 1; since
it is located close to the image center. This behaviour is expected
from how the convergence behaves close to the MD, where, as we
mentioned above, it presents a underestimation |Δ𝑟 𝜅| (cid:39) 0.1 (10%),
which translates in a underestimation in 𝑀 with the same range of
error. Beyond such underestimation, the diﬀerence decreases rapidly,
achieving |Δ𝑟 𝜅| ≈ 0 (0%). Between 𝜃𝑖𝑛 ≈ 0.38 𝑎𝑟𝑐𝑚𝑖𝑛 ≤ 𝜃 ≤
𝜃𝑜𝑢𝑡 ≈ 0.82 𝑎𝑟𝑐𝑚𝑖𝑛 again 𝑀 starts to deviate from its true value,
getting up to |Δ𝑟 𝑀 | ≈ 0.05 (5%) beyond 𝜃𝑜𝑢𝑡 .

Among the reconstructions discussed in Meneghetti et al. (2017),
we compare our results to those reconstructions produced with

MNRAS 000, 1–24 (2021)

−1.5−1.0−0.50.00.51.01.5θ1(arcmin)−1.5−1.0−0.50.00.51.01.5θ2(arcmin)Reconstruction0.30.30.30.51.01.02.0−1.5−1.0−0.50.00.51.01.5θ1(arcmin)True0.30.30.30.30.30.30.30.30.50.50.51.01.01.02.02.02.00.00.51.01.52.02.53.0−1.5−1.0−0.50.00.51.01.5θ1(arcmin)−1.5−1.0−0.50.00.51.01.5θ2(arcmin)Reconstruction0.30.51.02.02.0−1.5−1.0−0.50.00.51.01.5θ1(arcmin)True0.30.30.30.30.30.30.30.50.51.02.02.00.00.51.01.52.02.53.0relensing: Reconstructing the mass proﬁle of galaxy clusters from gravitational lensing

19

Figure 18. Relative diﬀerence Δ𝑟 𝜅 between the reconstructed and true convergence maps for Ares (left panel), as well as for Hera (right panel). Here, the red
and green solid contours correspond to Δ𝑟 𝜅 = 0.1 and Δ𝑟 𝜅 = −0.1, respectively. The purple dashed contour delimits the region within which we have multiple
images available. Additionally, the solid violet contours enclose the main deﬂectors. Here, the black dashed contour encloses the substructure present in Hera
(left panel).

Figure 19. Mass for Ares within an angular radius 𝜃, centered at 𝜽 =
(0, 0) 𝑎𝑟 𝑐𝑚𝑖𝑛 (upper panel), and the relative diﬀerence Δ𝑟 𝑀 comparing
the reconstructed and true mass (lower panel). The vertical dashed lines rep-
resent the inner and outer radius of the inner region (purple dashed contour
in Fig. 18 left). The horizontal dashed lines enclose |Δ𝑟 𝑀 | ≤ 0.05.

SWUnited, since SWUnited and relensing are based on the same
principles. In Meneghetti et al. (2017) they labeled the reconstruc-
tions produced with SWUnited as Bradac-Hoag models. Here, we
will refer to them as BHm.

The 𝜅 maps given by BHm (for a source with redshift 𝑧𝑟 = 9)
for Ares and Hera are depicted respectively in Fig. 7 (upper let
panel) and Fig. 8 (upper left panel) in Meneghetti et al. (2017). One
can see that for Ares their reconstruction shows a more irregular
shape, and noisier contour curves than our reconstruction. In the
case of Hera, BHm is smoother than the one given for Ares, however,
their reconstruction exhibits a substructure close to MD 1 that is not
present in the true distribution. This extra substructure is not present
in our reconstructions, as it is clear from Fig. 17. For BHm as well,
the substructure present in Hera was not recovered.

Figure 20. Same as in Fig. 19 but for Hera.

5.1.2 Magniﬁcation

In Fig. 21 we can see the magniﬁcation maps for Ares, where the
reconstruction is shown in the left panel, and the true map in the
right panel. The external curve of high |𝜇| exhibits an elongated
shape, within which there is one internal curve surrounding each
MD. The main diﬀerence appears close to the MD 2, where we get
an overestimation of |𝜇|. Such overestimation coincides with a true
critical curve, as one can notice by direct comparison between the true
(red) and reconstructed (blue) critical curves in Fig. 24 (upper left
panel). Despite this overestimation, we are not able to retrieve such
critical curve. It is worth mentioning that it is possible to reproduce
such critical curve by forcing the reconstruction parameters, where
its presence is more frequent for Type 2 reconstructions. Nonetheless,
in practice we are not aware of these details, so that the best we can
do is to use the parameters that provide the best overall outcome.

It is clear that our reconstruction recovers the orientation, shape
and size of such critical curves with great accuracy. Additionally, the

MNRAS 000, 1–24 (2021)

−1.5−1.0−0.50.00.51.01.5θ1(arcmin)−1.5−1.0−0.50.00.51.01.5θ2(arcmin)Ares−1.5−1.0−0.50.00.51.01.5θ1(arcmin)−1.5−1.0−0.50.00.51.01.5θ2(arcmin)Hera-1.0-0.8-0.6-0.4-0.20.00.20.40.60.81.00.00.30.60.91.2M(≤θ)(×1015M(cid:12))ReconstructionTrue0.00.30.60.91.21.5θ(arcmin)-0.050.000.05∆rM0.01.53.04.56.0M(≤θ)(×1014M(cid:12))ReconstructionTrue0.00.30.60.91.21.5θ(arcmin)-0.10-0.050.000.05∆rM20

D. A. Torres-Ballesteros and L. Castañeda

Figure 21. Magniﬁcation maps (|𝜇 |) for Ares, given for a source with redshift 𝑧𝑟 = 9. They correspond to the maps shown in Fig. 16. The true map is shown in
the left panel.

Figure 22. Same as in Fig. 21 but for Hera. Here, the black dashed contour encloses the critical curve produced by the substructure present in Hera.

critical curves corresponding to the substructure cannot be recovered,
since it is diﬃcult to account for such detailed peaks from the limited
information provided by strong lensing.

For Hera, its magniﬁcation maps are shown in Fig. 22. In general
terms, our reconstruction is capable of recovering the main features
shown by the true map (Fig. 22 left panel), except for the curve (sur-
rounded by the white dashed contour) produced by the substructure
present in Hera, which our reconstruction fail to account for. As we
discussed above, it is not possible to account for such substructure,
due to the lack of observations there. Besides such curve, the exter-
nal critical curve exhibits an elongated shape with one inner curve
surrounding each MD; similarly to Ares. Fig. 24 (upper right panel)
shows the direct comparison between true (red) and reconstructed
(blue) critical curves. It is clear that the shape, and size of the main
curves are reproduced by our reconstruction.

Since for Hera we have fewer systems/images than for Ares, it is
expected for us to obtain less accurate curves. This can be seen in the

external curve, where at its ends the reconstructions fail to accurately
reproduce its shape. This becomes more evident in the critical curves,
as it is depicted in Fig. 24 (upper left panel). Nonetheless, our results
are incredibly accurate, considering that the only assumption that we
have made with respect to the cluster itself relies on the NIE and
2NIE used as input. Beyond that, the reconstructions just adapt to the
observations.

From Fig. 23 it is clear again that the higher diﬀerence between the
true and reconstructed |𝜇| maps is produced close to the true critical
curves (solid black lines), where the deviation from the true curves
shows the overestimation in |𝜇| associated with the presence of the
reconstructed critical curves. This is more evident for Hera.

Now, moving to the source plane, in Fig. 24 we have the true
(red) and predicted (blue) caustic curves for Ares (lower left panel)
and Hera (lower right panel). We successfully recover the overall
morphological characteristics present in the caustic curves, except for

MNRAS 000, 1–24 (2021)

−1.5−1.0−0.50.00.51.01.5θ1(arcmin)−1.5−1.0−0.50.00.51.01.5θ2(arcmin)Reconstruction−1.5−1.0−0.50.00.51.01.5θ1(arcmin)True01020304050−1.5−1.0−0.50.00.51.01.5θ1(arcmin)−1.5−1.0−0.50.00.51.01.5θ2(arcmin)Reconstruction−1.5−1.0−0.50.00.51.01.5θ1(arcmin)True01020304050relensing: Reconstructing the mass proﬁle of galaxy clusters from gravitational lensing

21

Figure 23. Relative diﬀerence Δ𝑟 |𝜇 | between the reconstructed and true magniﬁcation maps for Ares (left panel) and Hera (right panel). The red and green solid
contours correspond to Δ𝑟 𝜅 = 0.2 and Δ𝑟 𝜅 = −0.2, respectively. The black solid lines depict the true critical curves. Additionally, the black dashed contour
encloses the critical curve produced by the substructure present in Hera.

those curves associated with substructure. Our curves are deviated
from the true ones, which is a consequence of (18).

Now, for the |𝜇| maps given by BHm, which are shown for Ares and
Hera respectively in Fig. 19 (upper left panel) and Fig. 20 (upper left
panel) in Meneghetti et al. (2017), it is clear that the irregularities
present in Ares produce equally irregular critical curves. BHm is
capable of reproducing the curves around the MD, and the external
curve follows the orientation of the true curve. Nonetheless, the
external curve produces several regions of high magniﬁcation that do
not follow the true map. In contrast, our reconstruction has produced
smoother curves which present less deviations from true critical
curves. On the other hand, the BHm of Hera shows a critical curve
related to the substructure present in their reconstruction, which is
absent in the true map. Since our reconstruction does not present
such substructure, it lacks that critical curve.

Lastly, we consider the root-mean-square (rms) on the lens plane,

deﬁne as

Δ𝑟 𝑚𝑠 =

(cid:118)(cid:117)(cid:117)(cid:116) 1
˜𝑁img

𝑁𝑠
∑︁

˜𝑁𝑖
∑︁

𝑖=1

𝑛=1

(cid:12)
(cid:12)𝜽𝑖𝑛 − 𝜽 (cid:48)
(cid:12)

𝑖𝑛

(cid:12)
2
(cid:12)
(cid:12)

,

(70)

𝑖

where ˜𝑁𝑖 is the number of reproduced images corresponding to the
𝑖-th multiply imaged system, and ˜𝑁img = (cid:205)𝑁𝑠
˜𝑁𝑖 is the total number
of multiple images recovered from the reconstruction. Recall that 𝑁𝑠
is the number of multiple imaged systems used in the reconstruction,
as well, 𝜽𝑖𝑛 and 𝜽 (cid:48)
𝑖𝑛 are the 𝑛-th reconstructed and true angular
position of the 𝑖-th multiply imaged system, respectively. In general,
˜𝑁img ≠ 𝑁img, since it is possible to get an excess or lack of multiple
images. In case of getting an excess of multiple images, we discard
those which are outside a given neighborhood with respect to the
closest true image.

A small rms is an indication of how well the reconstruction repro-
duces the input image positions. However, in practice it is perhaps
more important to get a small prediction rms (prms), which is com-
puted for a set of multiply imaged systems which were not considered
as input data. Now, take into account that, as it is discussed in e.g
Williams et al. (2018), a small rms by itself is a necessary but not
suﬃcient criteria to qualify the overall quality of the reconstruction,

particularly since it may be the indication of an overﬁtting of the
intrinsic noise in the data. Thus, it becomes necessary to get small
values for both, rms and prms. For further details in this regard see
e.g James et al. (2013). We left the study of the prediction power of
relensing for another paper.

For Ares we have Δ𝑟 𝑚𝑠 ≈ 0.17 𝑎𝑟𝑐𝑠𝑒𝑐 with ˜𝑁img = 240 out of the
total 𝑁img = 242. Meanwhile, for Hera we get Δ𝑟 𝑚𝑠 ≈ 0.16 𝑎𝑟𝑐𝑠𝑒𝑐
with ˜𝑁img = 𝑁img = 65. Considering the rms aforementioned, as
well as the reproduction of the diﬀerent properties of Ares and Hera
discussed up to here, we are conﬁdent to say that relensing is
capable of producing accurate reproduction of the mass distributions
of galaxy clusters, and their properties as gravitational lens.

6 SUMMARY AND CONCLUSIONS

In this work we describe and test a free-form method which makes use
of gravitational lensing in order to produce an estimation of the mass
proﬁle of galaxy clusters, as well as its properties as a gravitational
lens. In addition, we note that this approach does not consider that
mass traces light; commonly assumed in parametric methods. This
approach is an extension of the method presented in Bradač et al.
(2005a, 2009), which at the same time is an extension of the work
discussed in Bartelmann et al. (1996).

Here, we use an irregular and adaptive grid that is intended to pro-
duce a higher resolution around those mass peaks (main deﬂectors)
responsible for most of the strong lensing eﬀect, as well as around
the multiple images. Additionally, we have opted for an alternative
ﬁnite diﬀerence approach (generalized ﬁnite diﬀerence). Moreover,
we include two diﬀerent ways of computing the penalty function 𝜒2
𝑠 ,
which we have named Type 1 and Type 2.

We start by testing our approach on two simple distributions; a
NIS and 2NIS, in order to explore the set of input parameters that
take us to reliable results. With them, we also explore the impact that
the input deﬂection potential has on the reconstructions, where we
use a blind reconstruction and a NIE. Within the region delimited by
the available multiple images (inner region) there are no major dif-
ferences. However, for blind reconstructions it is diﬃcult to scale up

MNRAS 000, 1–24 (2021)

−1.5−1.0−0.50.00.51.01.5θ1(arcmin)−1.5−1.0−0.50.00.51.01.5θ2(arcmin)Ares−1.5−1.0−0.50.00.51.01.5θ1(arcmin)−1.5−1.0−0.50.00.51.01.5θ2(arcmin)Hera-1.0-0.8-0.6-0.4-0.20.00.20.40.60.81.022

D. A. Torres-Ballesteros and L. Castañeda

Figure 24. Comparison between the reconstructed (blue) and true (red) critical (upper row) and caustic (lower row) curves for Ares (left panels) and Hera (right
panels). The black dashed contour encloses the critical (upper right panel) and caustic (lower right panel) curves produced by the substructure present in Hera.

outside the inner region. The introduction of weak lensing improves
the reconstruction on such region, but there is still a lack of mass
towards the outskirts. The NIE helps to extend the reconstruction
outside the inner region along with weak lensing, where for the 2NIS
we get an improvement in the mass estimation of ∼ 7%. For 𝜅 most
of the region presents an estimation that lies below ∼ 20%, with just
a few sectors mainly close to the boundaries where we get higher
values. Thus, the choice of 𝜓 (0) does not aﬀect signiﬁcantly the
reconstruction where strong lensing is dominant. However, outside
such region the reconstruction is more susceptible to 𝜓 (0) . If 𝜓 (0)
corresponds to an overestimation of 𝜅 that moves away from the true
map, it becomes diﬃcult for the reconstruction to scale down towards
the true value. The opposite eﬀect occurs in blind reconstructions.

We also show that by recomputing the deﬂection potential from
the weight of every node; i.e by using (12), we are able to smooth
the shape of convergence and magniﬁcation maps, which otherwise
tend to be quite irregular and noisy. For instance, the overall rela-
tive diﬀerence Δ𝑟 𝜅 and Δ𝑟 𝜇 improves. We refer to this process as
smoothing.

This smoothing improves the power of this free-form approach,

which we also test on Ares and Hera Meneghetti et al. (2017), two
simulated galaxy clusters, which provide a more realistic framework
to prove the reliability of our reconstructions. Our results show an
improvement with respect to e.g. BHm (Bradac-Hoag models) in
Meneghetti et al. (2017), where we get less irregular proﬁles and
magniﬁcation maps, which turns into a more accurate reconstruction
of these distributions.

Among the reconstructions discussed in this work, we have that
within the inner region the reconstructions mainly satisfy |Δ𝑟 𝜅| <
0.1 (10%), with 0.1 (10%) < Δ𝑟 𝜅 < 0.2 (20%) mostly close to
inner region boundary. Higher values are obtained most likely where
small substructures are located, like in Ares. When weak lensing
is included, the reconstruction provides a more accurate estimation
of the mass proﬁle outside the inner region. For |𝜇|, the higher
discrepancies appear close to the critical curves, as expected due to
their nature. The morphological properties of the critical and caustic
curves do not show signiﬁcant changes when weak lensing is also
used in the reconstruction.

Our reconstructions have shown to be capable of recovering the
orientation, shape, and size of critical curves, despite the irregulari-

MNRAS 000, 1–24 (2021)

−1.5−1.0−0.50.00.51.01.5θ1(arcmin)−1.5−1.0−0.50.00.51.01.5θ2(arcmin)Ares−1.0−0.50.00.5θ1(arcmin)−1.0−0.50.00.51.0θ2(arcmin)Hera−0.8−0.40.00.40.8β1(arcmin)−0.9−0.6−0.30.00.30.60.9β2(arcmin)−0.6−0.4−0.20.00.2β1(arcmin)−0.4−0.20.00.20.4β2(arcmin)relensing: Reconstructing the mass proﬁle of galaxy clusters from gravitational lensing

23

ties present in the reconstructions. We have found a way of reducing
such irregularities by means of the smoothing. Nevertheless, since
critical curves are sensitive to variations by nature, they might pro-
duce high deviations in |𝜇|; even if such variations are small. This is
a problem that requires further improvement.

We have seen that Type 1 and Type 2 reconstructions produce
similar results, except for some minor diﬀerences that are related to
the input parameters. Therefore, it is best to use both types of recon-
struction for a given galaxy cluster, which is done by taking several
realizations of the reconstruction for each type of reconstruction
combined with diﬀerent initial deﬂection potentials (if convenient).
If this is done, it is also convenient to use random seeds for some
input parameters. Then, by averaging such realizations, the result is
even more accurate. This process becomes convenient considering
the random nature of the grid along the reconstruction.

We followed this approach for Ares and Hera, where we used the
NIE and 2NIE as an initial guess, so that we averaged 40 realizations
of the reconstructions for each cluster. As a result, we got a rms on
the lens plane of about 0.17 𝑎𝑟𝑐𝑠𝑒𝑐 and 0.16 𝑎𝑟𝑐𝑠𝑒𝑐 for Ares and
Hera. Also, we were able to recover 240 of the 242 images used in
Ares, and all the images used in Hera.

relensing has shown an incredible capability in terms of pro-
ducing an accurate estimation of the mass proﬁle of galaxy clusters,
along with their properties as gravitational lens. Therefore, with this
work we expect to provide an accessible package written in python,
focused on the characterization of galaxy clusters by using gravi-
tational lensing. This provides users with a wider range of options
to choose from, which becomes indispensable in order to validate
physical results.

In this regard, the application of relensing to real galaxy clus-
ters, such as those from e.g. HFF, is naturally the next step (this is a
work in progress). Also, with the expected increase in quantity and
quality of observations from upcoming facilities, we plan to explore
how relensing behaves depending on the number of multiply im-
aged systems, and multiple images available. Additionally, as already
discussed in Cain et al. (2016), ﬂexion allows us to get information
from substructure where strong lensing is not dominant. So that it
becomes interesting to explore the impact the smoothing has on re-
constructions when ﬂexion is included. Moreover, it is indispensable
to test the prediction power of relensing particularly in the con-
text of predicting the existence of multiple images, which is of great
importance for strong lensing studies.

ACKNOWLEDGEMENTS

L. Castañeda was supported by Patrimonio Autónomo - Fondo Na-
cional de Financiamiento para la Ciencia, la Tecnología y la Inno-
vación Francisco José de Caldas (MINCIENCIAS - COLOMBIA)
Grant No. 110685269447 RC-80740-465-2020, projects 69723.

We thank A. Plazas for his comments on our work, and the sugges-
tion of applying our approach to Ares and Hera. We also appreciate
the insights of L. A. Garcia, J. Liesenborgs, and L.L.R. Williams,
which have been useful to improve our manuscript. Additionally, we
thank M. Meneghetti and P. Natarajan for making publicly available
the simulations of Ares and Hera through FF-SIMS.

relensing has been possible thanks to numpy (Harris et al.
(2020)), scipy (Virtanen et al. (2020)), numba (Lam et al. (2015)),
matplotlib (Hunter (2007)), and astropy (Astropy Collaboration
et al. (2013, 2018)).

DATA AVAILABILITY

The data discussed in this work will be shared upon request to the
authors. We plan to make relensing available through GitHub in
the near future.

REFERENCES

Abdelsalam H. M., Saha P., Williams L. L. R., 1998, MNRAS, 294, 734
Allen S. W., Evrard A. E., Mantz A. B., 2011, ARA&A, 49, 409
Astropy Collaboration et al., 2013, A&A, 558, A33
Astropy Collaboration et al., 2018, AJ, 156, 123
Bartelmann M., 2003, arXiv preprint astro-ph/0304162
Bartelmann M., Schneider P., 2001, Phys. Rep., 340, 291
Bartelmann M., Narayan R., Seitz S., Schneider P., 1996, ApJ, 464, L115
Benito J., Urena F., Gavete L., 2001, Applied Mathematical Modelling, 25,

1039

Benito J., Urena F., Gavete L., Alvarez R., 2003, Computer methods in applied

mechanics and engineering, 192, 735
Bergamini P., et al., 2021, A&A, 645, A140
Blandford R. D., Narayan R., 1992, ARA&A, 30, 311
Bradač M., Schneider P., Lombardi M., Erben T., 2005a, A&A, 437, 39
Bradač M., et al., 2005b, A&A, 437, 49
Bradač M., et al., 2009, ApJ, 706, 1201
Broadhurst T., et al., 2005, ApJ, 621, 53
Cacciato M., Bartelmann M., Meneghetti M., Moscardini L., 2006, A&A,

458, 349

Cain B., Bradač M., Levinson R., 2016, MNRAS, 463, 4287
Cataneo M., Rapetti D., 2018, International Journal of Modern Physics D,

27, 1848006

Coe D., Fuselier E., Benítez N., Broadhurst T., Frye B., Ford H., 2008, ApJ,

681, 814

Coe D., et al., 2013, ApJ, 762, 32
Coe D., et al., 2019, ApJ, 884, 85
D’Aloisio A., Natarajan P., 2011, MNRAS, 411, 1628
Deb S., Goldberg D. M., Ramdass V. J., 2008, ApJ, 687, 39
Diego J. M., Protopapas P., Sandvik H. B., Tegmark M., 2005, MNRAS, 360,

477

Diego J. M., Tegmark M., Protopapas P., Sandvik H. B., 2007, MNRAS, 375,

958

Diego J. M., et al., 2016, MNRAS, 456, 356
Furtak L. J., Atek H., Lehnert M. D., Chevallard J., Charlot S., 2021, MNRAS,

501, 1568

Gardner J. P., et al., 2006, Space Sci. Rev., 123, 485
Gavete L., Gavete M., Benito J., 2003, Applied Mathematical Modelling, 27,

831

Ghosh A., Williams L. L. R., Liesenborgs J., 2020, MNRAS, 494, 3998
Gilmore J., Natarajan P., 2009, MNRAS, 396, 354
Golse G., Kneib J. P., 2002, A&A, 390, 821
Harris C. R., et al., 2020, Nature, 585, 357
Hattori M., Kneib J., Makino N., 1999, Progress of Theoretical Physics Sup-

plement, 133, 1

Hoekstra H., 2013, arXiv e-prints, p. arXiv:1312.5981
Hoekstra H., Bartelmann M., Dahle H., Israel H., Limousin M., Meneghetti

M., 2013, Space Sci. Rev., 177, 75

Huber K., Tchernin C., Merten J., Hilbert S., Bartelmann M., 2019, A&A,

627, A143

Hunter J. D., 2007, Computing in Science & Engineering, 9, 90
Ivezić Ž., et al., 2019, ApJ, 873, 111
James G., Witten D., Hastie T., Tibshirani R., 2013, An introduction to

statistical learning. Springer

Jauzac M., et al., 2016, MNRAS, 457, 2029
Jee M. J., et al., 2007, ApJ, 661, 728
Jullo E., Kneib J. P., 2009, MNRAS, 395, 1319
Jullo E., Kneib J. P., Limousin M., Elíasdóttir Á., Marshall P. J., Verdugo T.,

2007, New Journal of Physics, 9, 447

MNRAS 000, 1–24 (2021)

24

D. A. Torres-Ballesteros and L. Castañeda

Jullo E., Natarajan P., Kneib J.-P., D’Aloisio A., Limousin M., Richard J.,

Schimd C., 2010, Science, 329, 924
Karman W., et al., 2017, A&A, 599, A28
Kneib J.-P., Natarajan P., 2011, A&ARv, 19, 47
Kneib J. P., Ellis R. S., Smail I., Couch W. J., Sharples R. M., 1996, ApJ,

471, 643

Kneib J.-P., Ellis R. S., Santos M. R., Richard J., 2004, ApJ, 607, 697
Kravtsov A. V., Borgani S., 2012, ARA&A, 50, 353
Lagattuta D. J., et al., 2019, MNRAS, 485, 3738
Lam T. Y., Nishimichi T., Schmidt F., Takada M., 2012, Phys. Rev. Lett., 109,

051301

Lam S. K., Pitrou A., Seibert S., 2015, in Proceedings of the Second Workshop

on the LLVM Compiler Infrastructure in HPC. pp 1–6

Laureĳs R., 2009, arXiv e-prints, p. arXiv:0912.0914
Laureĳs R., et al., 2011, arXiv e-prints, p. arXiv:1110.3193
Liesenborgs J., De Rĳcke S., Dejonghe H., 2006, MNRAS, 367, 1209
Liesenborgs J., de Rĳcke S., Dejonghe H., Bekaert P., 2007, MNRAS, 380,

1729

Liesenborgs J., de Rĳcke S., Dejonghe H., Bekaert P., 2009, MNRAS, 397,

341

Liesenborgs J., Williams L. L. R., Wagner J., De Rĳcke S., 2020, MNRAS,

494, 3253

Limousin M., et al., 2016, A&A, 588, A99
Lotz J. M., et al., 2017, ApJ, 837, 97
Mahler G., et al., 2018, MNRAS, 473, 663
Mandelbaum R., 2018, ARA&A, 56, 393
McLeod D. J., McLure R. J., Dunlop J. S., 2016, MNRAS, 459, 3812
Meneghetti M., et al., 2017, MNRAS, 472, 3177
Merten J., 2016, MNRAS, 461, 2328
Merten J., Cacciato M., Meneghetti M., Mignone C., Bartelmann M., 2009,

A&A, 500, 681

Merten J., et al., 2011, MNRAS, 417, 333
Newman A. B., Treu T., Ellis R. S., Sand D. J., Nipoti C., Richard J., Jullo

E., 2013, ApJ, 765, 24

Niemiec A., Jauzac M., Jullo E., Limousin M., Sharon K., Kneib J.-P., Natara-

jan P., Richard J., 2020, MNRAS, 493, 3331

Oesch P. A., Bouwens R. J., Illingworth G. D., Franx M., Ammons S. M.,

van Dokkum P. G., Trenti M., Labbé I., 2015, ApJ, 808, 104

Oguri M., 2010, PASJ, 62, 1017
Pizzuti L., et al., 2016, J. Cosmology Astropart. Phys., 2016, 023
Postman M., et al., 2012, ApJS, 199, 25
Priewe J., Williams L. L. R., Liesenborgs J., Coe D., Rodney S. A., 2017,

MNRAS, 465, 1030

Remolina González J. D., Sharon K., Mahler G., 2018, ApJ, 863, 60
Richard J., et al., 2014, MNRAS, 444, 268
Saha P., Williams L. L. R., 1997, MNRAS, 292, 148
Schäfer C., Fourestey G., Kneib J. P., 2020, Astronomy and Computing, 30,

100360

Schneider P., Seitz C., 1995, A&A, 294, 411
Schneider P., Ehlers J., Falco E. E., 1992, Gravitational Lenses. Springer,

doi:10.1007/978-3-662-03758-4

Schneider P., Kochanek C., Wambsganss J., 2006, Gravitational lensing:
strong, weak and micro: Saas-Fee advanced course 33. Springer Science
& Business Media

Seitz C., Schneider P., 1997, A&A, 318, 687
Seitz S., Schneider P., Bartelmann M., 1998, A&A, 337, 325
Sendra I., Diego J. M., Broadhurst T., Lazkoz R., 2014, MNRAS, 437, 2642
Strait V., et al., 2018, ApJ, 868, 129
Umetsu K., 2020, A&ARv, 28, 7
Vanzella E., et al., 2021, A&A, 646, A57
Virtanen P., et al., 2020, Nature Methods, 17, 261
Williams L. L. R., Sebesta K., Liesenborgs J., 2018, MNRAS, 480, 3140

This paper has been typeset from a TEX/LATEX ﬁle prepared by the author.

MNRAS 000, 1–24 (2021)

