Draft version November 3, 2020
Typeset using LATEX twocolumn style in AASTeX63

0
2
0
2

v
o
N
1

]

R
S
.
h
p
-
o
r
t
s
a
[

3
v
3
5
5
7
0
.
0
1
0
2
:
v
i
X
r
a

Solar Coronal Magnetic Field Extrapolation from Synchronic Data with AI-generated Farside

HYUN-JIN JEONG ,1 Yong-Jae Moon ,1, 2 Eunsu Park ,2 and Harim Lee

2

1School of Space Research, Kyung Hee University, Yongin, 17104, Republic of Korea
2Department of Astronomy and Space Science, College of Applied Science, Kyung Hee University, Yongin, 17104, Republic of Korea

(Received August 31, 2020; Revised October 14, 2020; Accepted October 19, 2020)

Submitted to ApJL

ABSTRACT

Solar magnetic ﬁelds play a key role in understanding the nature of the coronal phenomena. Global
coronal magnetic ﬁelds are usually extrapolated from photospheric ﬁelds, for which farside data is
taken frontside, about two weeks earlier. For the ﬁrst time we have constructed the extrapolations
of global magnetic ﬁelds using frontside and artiﬁcial intelligence (AI)-generated farside magnetic
ﬁelds at a near-real time basis. We generate the farside magnetograms from three channel farside
observations of Solar Terrestrial Relations Observatory (STEREO) Ahead (A) and Behind (B) by our
deep learning model trained with frontside Solar Dynamics Observatory extreme ultraviolet images
and magnetograms. For frontside testing data sets, we demonstrate that the generated magnetic ﬁeld
distributions are consistent with the real ones; not only active regions (ARs), but also quiet regions
of the Sun. We make global magnetic ﬁeld synchronic maps in which conventional farside data are
replaced by farside ones generated by our model. The synchronic maps show much better not only
the appearance of ARs but also the disappearance of others on the solar surface than before. We use
these synchronized magnetic data to extrapolate the global coronal ﬁelds using Potential Field Source
Surface (PFSS) model. We show that our results are much more consistent with coronal observations
than those of the conventional method in view of solar active regions and coronal holes. We present
several positive prospects of our new methodology for the study of solar corona, heliosphere, and space
weather.

Keywords: Solar magnetic ﬁelds (1503), Solar corona (1483), Convolutional neural networks (1938),

The Sun(1693), Space weather(2037), Astronomical models(86)

1. INTRODUCTION

Solar magnetic ﬁelds dominate the structure and dy-
namics of the corona and inner heliosphere (Jess et al.
2016). The magnetic ﬁeld is an energy source of so-
lar ﬂares and their accompanying coronal mass ejec-
tions (Amari et al. 2018; Inoue et al. 2018). Photo-
spheric magnetic ﬁelds are routinely measured, but di-
rect measurements of coronal magnetic ﬁelds are very
diﬃcult and rare. Thus, several models of extrapola-
tion or magnetohydrodynamic (MHD) simulation have
been developed to derive coronal magnetic ﬁelds from
photospheric magnetograms (Miki´c et al. 2018; Nandy

Corresponding author: Yong-Jae Moon
moonyj@khu.ac.kr

et al. 2018). A synoptic map of solar magnetic ﬁelds
has been widely used for the input boundary condition
of the coronal models. The map constructed by merg-
ing together frontside magnetograms, which are daily
updated near-central-meridian data, over 27-day solar
rotation period (Bertello et al. 2014). For the farside
of the map, data assimilation techniques with magnetic
surface ﬂux transport models and helioseismic farside
detections were applied (DeVore et al. 1984; Schrijver
& DeRosa 2003). However, those approaches still have
limitations to predict real-time farside magnetic ﬁelds,
especially for rapid changes in magnetic ﬁelds by ﬂux
emergence or disappearance near the limb.

Deep learning, a subset of machine learning in arti-
ﬁcial intelligence (AI) and also known as deep neural
networks, has been developed to ﬁnd the best mathe-

 
 
 
 
 
 
2

Jeong et al.

matical manipulation to turn the input into the output,
whether it be a linear or nonlinear relationship. And it
has made many advances to solve space weather prob-
lems like solar ﬂare forecast (Huang et al. 2018; Park
et al. 2018), coronal hole detection (Illarionov & Tla-
tov 2018), etc.. The Pix2Pix (Isola et al. 2017) model,
which is based on the conditional Generative Adver-
sarial Networks (cGAN; Mirza & Osindero 2014), is a
novel deep learning method excellent for image trans-
lation tasks that have been well demonstrated in solar
astronomy and space weather (Park et al. 2019, 2020;
Ji et al. 2020). Kim et al. (2019) (hereafter KPL19)
proposed an approach to generate solar farside magne-
tograms from the Solar TErrestrial RElations Observa-
tory (STEREO; Kaiser et al. 2008)/Extreme UltraVio-
let Imager (EUVI; Howard et al. 2008) 304 ˚A images.
The orbit of STEREO Ahead (A) and Behind (B) is
at a distance of about 1 AU, and drift away from the
Earth at a rate of about 22◦ per year in opposite di-
rections. They applied the Pix2Pix and trained and
evaluated the model with pairs of frontside Solar Dy-
namics Observatory (SDO; Pesnell et al. 2011)/Atmo-
spheric Imaging Assembly (AIA; Lemen et al. 2011) 304
˚A images and SDO/Helioseismic and Magnetic Imager
(HMI; Scherrer et al. 2012) line-of-sight (LOS) magne-
tograms before the generation of farside data. However,
their results were limited to the maximum magnetic ﬁeld
strength of ±100 Gauss, and showed low correlations in
solar quiet regions. It was noted that the Pix2Pix has an
issue with generating high-resolution data, and the lack
of details and realistic features in the high-resolution
results (Chen & Koltun 2017). Wang et al. (2018) pro-
posed an improved model to solve the issues with a novel
adversarial loss and multi-scale architectures of the net-
works, and they named the model ”Pix2PixHD”. Shin
et al. (2020) tried to generate magnetograms from Ca
II K images, and their results show that the Pix2PixHD
model is useful to generate ones with a large dynamic
range (±1400 Gauss).

In this Letter, we make an upgraded model with
±3000 Gauss dynamic range based on the Pix2PixHD
and use multi-channel images for input. We describe
the detailed structure of the model in Section 3.1. We
train the model with frontside SDO extreme ultraviolet
(EUV) passband images and magnetograms, and then
generate farside magnetograms from the corresponding
images of STEREO A and B by the model in Section
4.1. Next we generate a synchronic map of photospheric
ﬁeld, which replaces the conventional synoptic map at
the farside with the AI-generated ones in Section 4.2.
Hereafter, this is called the HMI & AI synchronic map.
Finally, we extrapolate coronal magnetic ﬁelds from the

synchronic map using a Potential Field Source Surface
(PFSS) model. Then we compare them with EUV obser-
vations as well as those from the conventional method in
Section 4.3. We present several prospects of our results
in Section 5.

2. DATA

We use pairs of full-disk SDO/AIA three passband im-
ages and SDO/HMI LOS 720s magnetograms to train
our deep learning model. The three EUV passbands
are 304, 193, and, 171 ˚A corresponding to the chromo-
sphere, corona, and upper transition region, respectively
(Lemen et al. 2011). The data pairs have a cadence of
12 hr (at 00 UT and 12 UT each day) from 2011 January
1 to 2017 December 31. We use 4231 pairs of the multi-
channel EUV images for input and magnetograms for
output of our model. We construct a training set with
10 months and an evaluation set with two months, and
both are selected for each year without any duplication
between the two sets.
In order to train and evaluate
various inclination conditions, which cause diﬀerent dis-
tributions of southern/northern magnetic ﬁeld strength
for each month (Pastor Yabar et al. 2015), the months
are selected randomly. We take 3412 pairs for the train-
ing data set and 819 pairs for the evaluation data set.

we

To

generate

farside magnetograms,

use
STEREO/EUVI A & B (304, 195, and 171 ˚A) passband
images, which have similar response characteristics to
the SDO/AIA images (Downs et al. 2012). These SDO
and STEREO passbands are often used together for
the global solar studies (Su & Van Ballegooijen 2012;
Cairns et al. 2018). The farside EUV images are selected
from the closest times (within one hour) to the synoptic
data, which is a conventional boundary condition for
the coronal magnetic ﬁeld extrapolation.

The following data pre-processing is applied to the
EUV data and magnetograms for the eﬀective train-
ing and generating. We make Level 1.5 images with
the standard SolarSoftWare (SSW) packages (Freeland
& Handy 1998) of aia prep.pro, hmi prep.pro and
secchi prep.pro function, which process the images by
calibrating, rotating, and centering. We downsample
them to be same resolution (1024 × 1024 pixels), and
the solar radius (R(cid:12)) is ﬁxed at 450 pixels. We mask
the area outside 0.98R(cid:12) of disk center to minimize the
uncertainty of limb data. For the calibration of the EUV
data, all data numbers are scaled by median values of
the original data on the solar disk, which are ﬁxed at
100. Then the logarithms of the scaled data are normal-
ized from -1 to 1 with the saturation values of 0 (lower
limit) and log(200) (upper limit). Then we combine the
three passband images from SDO and the STEREOs

Coronal extrapolation from synchronic data with AI-generated farside

3

into the RGB channel dimensions. The magnetograms
for training have an upper and lower saturation limit of
±3000 Gauss for the normalization. Finally, we manu-
ally exclude a set of SDO data pairs and STEREO data
with poor quality; for example, noise images because
of solar ﬂares, those with incorrect header information,
those with infrequent events such as eclipses, transits,
etc..

We use HMI daily updated radial ﬁeld synoptic map
with polar ﬁeld correction (Sun et al. 2011) for the con-
ventional magnetic ﬁeld map at the photosphere. Here-
after, this is called the HMI synoptic map, and is pro-
vided by the Joint Science Operation Center (JSOC).
The synoptic map well represents the region within
±60◦ of longitude with a daily updated frontside magne-
togram. However, the map still has several uncertainties
at the farside. Here, we improve the farside of the syn-
optic map in Section 4.2.

3. METHOD

3.1. Pix2PixHD model

We adopt the Pix2PixHD model, which is one of the
popular deep-learning methods for image translation of
high-resolution images without signiﬁcant artifacts, to
generate solar farside magnetograms. The Pix2PixHD
consists of two major networks: one is a generative net-
work (generator) and the other is a discriminative net-
work (discriminator). The generator tries to generate
realistic output from input, and the discriminator tries
to distinguish the more realistic pair between a real pair
and a fake pair. The real pair consists of a real input
and a real output. The fake pair consists of a real in-
put and an output from the generator. We construct a
real input, a real output, and an output from the gen-
erator as a combined image of three EUV passbands, a
magnetogram, and an AI-generated magnetogram, re-
spectively.

The generative network consists of several convolu-
tional layers and transposed convolutional layers. A
convolutional layer contains a set of ﬁlters that extract
features automatically from the input data, like a human
visual system, and whose parameters are learned or up-
dated during the model training process. A transposed
convolutional layer is an inverse process of convolution
and tries to reconstruct output from the extracted fea-
tures. The discriminative network is a classiﬁer that
consists of several convolution layers. Features which
are passed through the convolution layers are fed into a
single sigmoid output in order to produce a probability
output in the range of 0 (fake) to 1 (real) so that the
discriminator acts like a classiﬁer.

While the model is training, both networks compete
with each other and get an update at every step with
loss functions. Loss functions are objectives that score
the quality of results by the model, and the network
automatically learns that they are appropriate for sat-
isfying a goal, i.e., the generation of realistic magne-
tograms. We train and evaluate our model using SDO
frontside data pairs, and generate farside magnetograms
from STEREO’s EUV observations as an input of the
generator.

Networks of the Pix2PixHD model get an update with
two loss functions: one is a conditional generative adver-
sarial network (cGAN) loss (LcGAN ), and the other is a
feature-matching loss (LF M ). The cGAN loss is a basic
function of the models based on cGANs, and aim for
the generator and discriminator to compete. In order to
clearly discriminate the real and fake pairs, the discrim-
inator tries to maximize the loss. The generator tries
to generate realistic data that fools the discriminator,
thus minimizing the loss. The LcGAN gets a lower value
when D(x, G(x)) has a value close to 1, in which the
AI-generated image is similar to the real output. The
loss of cGAN is given by

LcGAN (G, D) = log

(cid:16)

(cid:17)

D(x, y)

(cid:16)

+ log

1 − D(x, G(x))

(cid:17)

,

(1)
where x, y, and G(x) are a real input, a real output, and
an output from the generator, respectively. The LF M
is to regularize the fake pair to have more similar dis-
tribution and statistics with the real pair from multiple
layers of the discriminator. The loss of feature matching
is given by

LF M (G, D) =

(cid:34)

T
(cid:88)

i=1

1
Ni

(cid:13)
(cid:13)D(i)(x, y) − D(i)(x, G(x))
(cid:13)

(cid:35)
,

(cid:13)
(cid:13)
(cid:13)

(2)
where T , i, and Ni are the total number of layers, a
serial number of the layers, and the number of pixels in
output feature maps of each layer, respectively.

Figure 1 shows the main structure of our model, which
has one generator and two discriminators (D1 and D2).
One discriminator gets input pairs of the original pixel
size, and the other gets input pairs that are downsam-
pled by half. Each discriminator classiﬁes real pairs and
generated pairs with diﬀerent scales, and guides the gen-
erative networks to generate globally consistent images
and produce ﬁner details. Their full loss function com-
bines both cGAN loss and feature-matching loss. We
use 10 for a relative weight (λ) which controls the im-
portance of LcGAN and LF M as in Wang et al. (2018).
When the model is trained, the generator tries to mini-
mize the full loss and the discriminators try to maximize

4

Jeong et al.

Figure 1. Flowchart and structures of our deep-learning model. G is the generator, D1 and D2 are the discriminators, x is
an EUV image with three passbands, y is a real magnetogram, and G(x) is an AI-generated magnetogram.

the cGAN loss (equation 3). To minimize or maximize
the loss, we use Adam solver (Kingma & Ba 2015) as an
optimizer for both the generator and the discriminator.

(cid:32)

(cid:16)

min
G

max
D1,D2

(cid:88)

k=1,2

LcGAN (G, Dk)

(cid:17)

(cid:88)

+λ

k=1,2

(cid:33)

LF M (G, Dk)

(3)
In our model, an input image (x) of three EUV chan-
nels is given to a generator and it generates an HMI-
like magnetogram (G(x)). The model calculates LcGAN
and LF M from the results of discriminators. Then
the networks get an update at every step with the
losses and they are iterated until the assigned iteration,
which is a suﬃcient number assuring the convergence
of the model. We train the model with 3412 pairs of
training dataset for 630,000 iterations (∼ 150 epochs),
and save AI-generated magnetograms from the evalua-
tion inputs every 10,000 iterations. Our code is avail-
able at https://github.com/JeongHyunJin/Jeong2020
SolarFarsideMagnetograms. In the readme ﬁle, we ex-
plain the architecture and selected hyperparameters of
our deep-learning model. For basic and extensive infor-
mation on the deep learning, please refer to Buduma &
Locascio (2017), Goodfellow et al. (2016), and Subra-
manian (2018).

3.2. PFSS model

We use PFSS extrapolation, which is a well-
established method for estimating large scale structure
of global corona (Riley et al. 2006) And the PFSS is
much more widely used for the space weather forecast
(Hakamada et al. 2005; Pomoell & Poedts 2018) than

the Nonlinear Force-Free Field (NLFFF) extrapolation
and the magnetohydrodynamic (MHD) approach. The
extrapolation calculates current-free ﬁeld of the corona
from the bottom boundary radius to the source surface
radius (RSS) by solving the Laplace equation, which is
given by

∇2ΦB(r) = 0,

(4)

where ΦB is a scalar potential. At the source surface,
the magnetic ﬁeld is assumed to be radial, because the
outﬂowing solar wind drags the ﬁeld out into the helio-
sphere. Open ﬁeld lines arriving at the source surface
are associated with coronal holes (CHs) (Lowder et al.
2014). The CHs are regions of low-intensity emission in
EUV and X-rays due to their low density and tempera-
ture compared to the surrounding quiet corona. The so-
lar winds and interplanetary magnetic ﬁelds are known
to originate from these regions (Wang et al. 1996). The
heliocentric height of RSS has been conventionally as-
sumed to be 2.5 solar radius (R(cid:12)). However, the lower
RSS produces better results near solar minimum (Lee
et al. 2011). Lowering the RSS in the PFSS model re-
sults in more open ﬂuxes and more coronal hole areas.
In this Letter we use two values: 2.0R(cid:12) and 2.5R(cid:12).
The input boundary condition is the measured radial
magnetic ﬁelds in the photosphere-like HMI synoptic
maps. We compute the PFSS model on a uniform grid
of 155 × 240 × 480 (r × θ × φ).

4. RESULTS

4.1. Generation of solar farside magnetograms

Coronal extrapolation from synchronic data with AI-generated farside

5

Table 1. Three Objective Measures of Comparison between SDO/HMI Magnetograms and AI-generated
Ones for Full Disk, ARs and QRs.

Full Disk

AR

QR

825 images

1,033 patches

825 patches

(1, 024 × 1, 024 pixels)

(128 × 128 pixels)

(128 × 128 pixels)

Ours

KPL19

Ours

KPL19

Ours

KPL19

Total unsigned magnetic ﬂux CC
Net magnetic ﬂux CC
Mean pixel-to-pixel CC (8 × 8 binning)

0.99
0.86
0.81

0.97
-
0.77

0.95
0.93
0.79

0.95
-
0.66

0.98
0.97
0.62

0.74
-
0.21

Note—For comparison with the previous research, the results of KPL19 are shown together.

We train and evaluate our deep-learning model us-
ing pairs of SDO/AIA three EUV passband images
and SDO/HMI LOS magnetograms. Table 1 shows re-
sults of three objective measures for full disk, active re-
gions (ARs) and quiet regions (QRs) between real and
AI-generated magnetograms for the evaluation dataset.
First, we calculate correlation coeﬃcients (CCs) be-
tween the total unsigned magnetic ﬂux (TUMF) of the
SDO/HMI magnetograms with a full dynamic range and
that of AI-generated ones. Our model shows that the
CCs are 0.99, 0.95, and 0.98 for 819 full disk, 1,281 ARs
and 819 QRs. These values demonstrate that our model
can successfully generate TUMF over all regions. Sec-
ond, we calculate CCs between the net magnetic ﬂux
(NMF) of SDO/HMI magnetograms and that of AI-
generated ones, and those are 0.86, 0.93, and 0.97 for the
same data sets, respectively. Because discrete magnetic
ﬁeld polarity at the limb of solar disk, NMF CC for full
disk is lower than those for ARs and QRs. Third, mean
pixel-to-pixel CCs between SDO/HMI magnetograms
and that of AI-generated ones after 8 × 8 binning are
0.81, 0.79, and 0.62. These imply that our model
greatly improves the generation of magnetograms for not
only ARs but also QRs when compared with results of
KPL19.
In particular, it is noticeable that the mean
pixel-to-pixel CCs of the QRs has greatly increased.

Figure 2 shows a comparison of magnetograms on
2014 April 1: real one, one by KPL19, and ours. It is
taken from the evaluation dataset. AI-generated magne-
tograms from KPL19 and our model show overall mag-
netic ﬁeld distributions well. However, in detailed mag-
netic structures, our AI-generated magnetogram is much
more consistent with the real one than one by KPL19
with a couple of strong points. First, the NOAA AR
12021 (red box), which shows strong (higher than 1, 000
Gauss) magnetic ﬁelds, are well generated by our model.
Second, the networks of magnetic ﬁelds (blue box) are

well generated by our model, and the distributions of
magnetic polarity look like real one. Based on those re-
sults, our model generates more reliable magnetograms
than KPL19.

We generate more realistic farside magnetograms
from the corresponding three EUV passband images of
STEREOs by the model. The images of STEREOs are
scaled to SDO ones with a correction factor that is es-
timated from the ratio of the median on-disk brightness
of those images (Ugarte-Urra et al. 2015; Liewer et al.
2017). It is not meant as an absolute calibration cor-
rection, but it makes consistent conditions with train-
ing data for the deep-learning model. Thus the farside
magnetograms generated make it possible to monitor the
continuous evolution of solar magnetic ﬁeld distribution
over the solar surface. Our farside magnetograms gen-
erate ARs with realistic magnetic ﬁeld strength (Figure
3).

4.2. Generation of HMI & AI synchronic maps

We generate the HMI & AI synchronic map using the
farside AI-generated magnetograms. The AI-generated
ones are converted from full disk images to Carring-
ton heliographic coordinated maps, and from the line
of sight to the radial magnetic ﬁeld by applying the
radial-acute method (Wang & Sheeley Jr 1992) based
on their coordinates. A farside part (from 60◦ to 300◦
Carrington longitude) of the HMI synoptic map is re-
placed by the AI-generated magnetograms within ±60◦
if the farside EUV data are available. Our synchronic
map greatly improves farside magnetic ﬁelds, which can
be generated at almost the same time as near-real-time
EUV observations.

We compare farside photospheric ﬁeld maps and an
EUV 304 ˚A synchronic map, which is reconstructed
with multi-viewpoints observations of SDO/AIA and
STEREO/EUVI A and B on 2011 June 1 (Figure 4).

6

Jeong et al.

Figure 2. Comparisons of a real SDO/HMI line-of-sight magnetogram and AI-generated magnetograms. (a) AI-generated
data by KPL19 model. (b) real magnetogram on 2014 April 1 at 12:00 UT. (c) AI-generated one by our model. Full-disk
magnetograms are displayed as white for positive polarity and black for negative one. A solar AR on the center of the solar
disk (red box) and a QR on the limb (blue box) are zoomed and represented with other color maps showing the large dynamic
range values in Gauss.

Each map is interpolated to an uniform, 240 × 480 grid
in latitude and Carrington longitude for the comparisons
of input conditions to compute the coronal ﬁeld extrap-
olation. The farside of the HMI synoptic map (Figure
4(a)) and the EUV synchronic map (Figure 4(d)) show
noticeable diﬀerences, because the farside of the synop-
tic map was taken several days previously. There were
several ﬂux appearance (cases A1, A2, and A3 in Figure
4) and ﬂux disappearance (case D1 in Figure 4) of ARs.
There was also a ﬂux emergence and a shift of the loca-
tion of an AR moving west (case A4 in Figure 4). Each
location of A1-4 and D1 in Figure 4 was set according to
the EUV map. The Air Force Data Assimilative Pho-
tospheric ﬂux Transport (ADATP) Global Oscillation
Network Group (GONG) map (Hickmann et al. 2015)
provided by the National Solar Observatory (NSO) is
based on a magnetic surface ﬂux transport model, and
can predict the changes of sequential magnetic ﬂux that
showed at the solar frontside (cases A1 and D1 in Figure
4(c)). As shown in cases A2 and A3 in Figure 4(c), rapid
changes associated with the emergence of new magnetic
regions at the limb or farside are not properly repro-

duced. Our synchronic map shows well not only the
appearance and disappearance of ARs (cases A1-2, A4,
and D1 in Figure 4(b)) but also a shift of an AR (case A4
in Figure 4(b)). In the case of STEREO data unavail-
ability (e.g. case A3 in Figure 4(b)), our result cannot
predict the appearance of the AR.

4.3. Extrapolation of coronal magnetic ﬁelds

We use the HMI & AI synchronic map as a bottom
boundary condition to extrapolate global coronal mag-
netic ﬁelds. Then we predict open ﬁeld areas (CHs)
from the results of extrapolation, and compare those
with CHs observed in EUV emissions. Figure 5 shows
the results of extrapolations calculated from the HMI
synoptic and HMI & AI synchronic data, and EUV ob-
servations of STEREO/EUVI 284 ˚A and SDO/AIA 211
˚A from 2011 June 1 to 21. Those EUV passbands are
not used for training and generation, and ARs and CHs
are well identiﬁed in those images. There was a contin-
uous magnetic ﬂux emergence of the NOAA AR 11236
over a solar rotation. We select the data when the AR
was near the center of the solar disk in each spacecraft
observation, and indicate them with green arrows. The

Coronal extrapolation from synchronic data with AI-generated farside

7

Figure 3. A series of full-disk EUV images and magnetograms. (a) The ﬁrst and fourth EUV images are taken from SDO/AIA
304, 193 and 171 ˚A passbands. The second and third EUV images are taken from STEREO/EUVI A & B 304, 195 and 171
˚A passbands. (b) The ﬁrst and fourth magnetograms are taken from SDO/HMI. The second and third magnetograms are AI-
generated farside ones by the model. The yellow boxes show the tracking of solar ARs over a solar rotation. The positions of the
boxes are slightly diﬀerent due to the inclination angle between the ecliptic plane and orbit of the spacecrafts. (c) EUV images
and magnetograms in the yellow box area are zoomed. Full-disk magnetograms are displayed as white for positive polarity and
black for negative one. The color map of zoomed magnetograms shows large dynamic range values in kG.

ﬁrst and second rows in Figure 5 show STEREO EUV
images at the solar farside and the extrapolation re-
sults at the corresponding positions. These positions
are 94◦ Carrington longitude near the west limb and
267◦ Carrington longitude near the east limb of the so-
lar frontside. There were appearances of two ARs in-
cluding NOAA AR 11236 near the center of the solar
disk observed by STEREO A (Figure 5(b)). The PFSS
extrapolation from HMI synoptic data cannot represent

those ARs, and depict long CH structures along the lat-
itudinal direction near the meridian (Figure 5(a)). On
the other hand, the extrapolation from HMI & AI syn-
chronic data well represents the ARs and CHs under the
NOAA AR 11236 (Figure 5(c)). And 23 days later, ﬂux
emergences of the NOAA AR 11236 and another AR on
its southeast region were observed by the STEREO-B
on 2011 June 14 (Figure 5(e)). The PFSS extrapolation
from HMI synoptic data show similar CH distributions

8

Jeong et al.

Figure 4. Comparisons of solar farside magnetic ﬁeld maps of the photosphere with the EUV 304 ˚A synchronic map. (a)
Conventional HMI synoptic map on 2011 June 1 at 12:00 UT. (b) HMI & AI synchronic map. (c) ADAPT GONG map. (d)
EUV 304 ˚A synchronic map. Each map is shows 60◦ to 300◦ Carrington longitude and within ±60◦ latitude. ”A” indicates
appearance or shift case of solar ARs and ”D” indicates a disappearance case. The polarity of the magnetic ﬁelds are shown as
a color map of full-disk magnetograms in Figure 2 and 3.

as the extrapolations from several days previous (Figure
5(d)). The extrapolation from our synchronic data well
represents the distributions of the ARs and CHs consis-
tent with the observed images (Figure 5(f)). The third
row in Figure 5 shows SDO observations at the frontside
and PFSS results at the corresponding position on 2011
June 21. The results of these calculations are mostly
same, because both extrapolations are computed by the
observed frontside magnetograms (Figure 5(g) and (i)).
The PFSS results of our synchronic data (Figure 5(c),
(f) and (i)) show continuous sequences of ARs and CHs
from the farside to the frontside of the Sun.

Figure 6 shows the EUV observations and CHs identi-
ﬁed from the extrapolations in view of Carrington maps
from 2011 December 25 to 2012 January 21. The ﬁrst
row in Figure 6 shows synchronized EUV maps from
STEREO/EUVI A & B 195 ˚A and SDO/AIA 193 ˚A.
The second row in Figure 6 shows the results from our
HMI & AI synchronic data, and the third row in Fig-
ure 6 corresponds to the results from conventional HMI
synoptic data. There are two major magnetic ﬂux emer-
gence of the ARs. They are linked with equatorial open
ﬁeld regions (CHs), which are indicated with green and
pink arrows in Figure 6. Those ARs and CHs are more
consistent with our results than those of the conven-

tional method. Our extrapolations show overall consis-
tent distributions of global magnetic ﬁeld polarities over
one solar rotation.

We calculate the magnetic ﬂuxes for each area (green
box in Figure 6) including an equatorial coronal hole.
On 2011 December 25, when the coronal hole is on the
farside of the Sun, the total unsigned magnetic ﬂux, pos-
itive magnetic ﬂux, and negative magnetic ﬂux from our
HMI & AI synchronic data are 2.1×1021, 6.2×1020, and
1.5 × 1021 Mx, respectively. In HMI synoptic data they
are 2.3×1021, 1.0×1021, and 1.3×1021 Mx, respectively.
In our case the ratio of the negative magnetic ﬂux to the
total unsigned magnetic ﬂux is about 71 %, while the
ratio from the synoptic data is about 55 %. For 2012
January 11 data, where the equatorial coronal hole is
well predicted, the ratio of our result is about 70 %, and
71 % from the synoptic data. Our results show more
consistent magnetic ﬂuxes of the unipolar region than
those from the HMI synoptic data. These results repre-
sent that our AI-generated magnetograms well generate
distributions of magnetic ﬂuxes in coronal holes.

5. SUMMARY AND PROSPECTS

We want to stress on that our new methodology has
several positive prospects for the study of solar corona,
heliosphere, and space weather. First, AI-generated

Coronal extrapolation from synchronic data with AI-generated farside

9

Figure 5. Comparisons between EUV observations and results of PFSS extrapolations from conventional and HMI & AI
synchronic data in view of full-disk observations. (a)-(c) Result of PFSS extrapolation from HMI synoptic data, EUV observation,
and result of PFSS extrapolation from HMI & AI synchronic data at the position of STEREO A on 2011 June 1. (d)-(f) Those
at the position of STEREO-B on 2011 June 14. (g)-(i) Those at the position of SDO on 2011 June 21. Positive and negative
polarities of the open ﬁelds are indicated with blue and red colors. Closed ﬁeld lines are indicated with dark yellow. Field lines
at the limb and open ﬁeld area on the surface are only displayed for comparison. The PFSS is computed with RSS = 2.0R(cid:12)
and RSS = 2.5R(cid:12), and those open ﬁeld areas are displayed with hatched pattern and ﬁlled area, respectively. The solar surface
is ﬁlled with the bottom boundary data to show the distribution of ARs. The green arrow represents appearances of the NOAA
AR 11236.

farside magnetograms, together with frontside magne-
tograms, can be used for the long-term evolution of
sunspots and solar magnetic ﬂuxes. In this Letter, we
have applied a deep learning model to the generation of
solar farside magnetograms in order to extrapolate solar
coronal magnetic ﬁelds. We show that the AI-generated
magnetograms in our model can generate strong mag-
netic ﬁelds, which show correlations with real magne-
tograms of full disk, ARs, and QRs that are higher than

those of KPL19. The improvements provide new op-
portunities for the global magnetic ﬂux studies, such as
tracking solar ARs and studying their evolution (Ugarte-
Urra et al. 2015) or studying the time evolution of open
and total magnetic ﬂuxes at the solar surface (Solanki
et al. 2002). As deep learning technology advances, our
AI-generated data will become more realistic and the
applications from the AI-generated ones will show more
promising results.

10

Jeong et al.

Figure 6. Comparisons between EUV synchronic maps and results of PFSS extrapolations from conventional and HMI & AI
synchronic data in view of Carrington maps over a solar rotation. (a)-(c) EUV synchronic maps from STEREO/EUVI A & B
195 ˚A and SDO/AIA 193 ˚A on 2011 December 25, and those on 2012 January 11 and 21. (d)-(f) Results of PFSS extrapolation
from HMI & AI synchronic data corresponding to the EUV maps. (g)-(i) Those from HMI synoptic data corresponding to the
EUV maps. Green and pink arrows indicate two solar ARs linked with equatorial open ﬁeld regions. The boxes with green
represent the areas, which include a coronal hole, where we compute the magnetic ﬂuxes. Other features are described in Figure
5.

Second, our synchronic map can be better input data
for not only the PFSS global ﬁeld extrapolations but also
MHD approaches such as the Magnetohydrodynamic Al-
gorithm outside a Sphere (MAS) model (Miki´c et al.
2018). We show that our maps are more consistent with
EUV observations than the conventional photospheric
data. The MAS model has been used to be computed
for higher heights of corona than the source surface ra-
dius of the PFSS and constructs the physical parameters
of corona, which are not only magnetic ﬁeld vectors but
also plasma properties such as mass density, gas pres-
sure, and velocity. If our results are used for the input of
the MAS model, we expect that the model can produce
more reasonable solar coronal and heliospheric physical
parameters.

Third, the HMI & AI synchronic map may be im-
proved with data assimilation methods and photospheric
ﬂux transport models, which include the eﬀects of diﬀer-
ential rotation, meridional ﬂow, super-granulation, and
In our study, we simply re-
random background ﬂux.
place a farside HMI synoptic map by the AI-generated
farside magnetograms. There are several techniques
that assimilate magnetograms into the ﬂux transport
model, e.g., the Schrijver and DeRosa model (Schri-
jver & DeRosa 2003) and the ADAPT model (Hick-
mann et al. 2015). As shown in their methods, our AI-

generated farside magnetograms can be assimilated into
the ﬂux transport model, and as a result we expect that
the model may show better results than before. This
model has the advantage that the map has a better sta-
ble balance in magnetic ﬂux on the boundary of the
generated data and on the map close to the boundary.
Fourth, extrapolated coronal magnetic ﬁeld data can
be used for initial boundary conditions of several space
weather prediction models. We have shown that the
PFSS extrapolations with the synchronic data are also
more consistent with EUV observations than the con-
ventional methods and show continuous sequences of
coronal structure changes over several solar rotations.
Our improved PFSS extrapolation data will be useful
as better input conditions for the solar wind forecasting
(Hakamada et al. 2005; Pomoell & Poedts 2018), which
is a major component for space weather. For example,
the Wang-Sheeley-Arge (WSA) solar wind model (Arge
& Pizzo 2000) has been widely used to forecast the so-
It
lar wind at 1 AU from the coronal extrapolation.
provides improved solar wind conditions to heliospheric
MHD models, such as an ENLIL model for forecast of
corona mass ejection arrivals (Steenburgh et al. 2013).
Our method will provide more accurate solar wind pre-
dictions, especially for the farside of the sun and helio-
sphere.

Coronal extrapolation from synchronic data with AI-generated farside

11

Fifth, our PFSS extrapolation can be help us study
the global environment from the Sun to the interplane-
tary space. The extrapolation has been widely used for
decades to study interplanetary ﬁelds (Schatten et al.
1969; Rust et al. 2008), photospheric sources of the so-
lar wind (Wang & Sheeley Jr 2003), and solar energetic
particle (SEP) events (Nitta et al. 2006; Park et al.
2013). Recently, the Parker Solar Probe (PSP) (Fox
et al. 2016), the ﬁrst spacecraft to ﬂy into the low so-
lar corona, has been collecting data on magnetic ﬁelds,
which has been compared with the time series predic-
tions of radial magnetic ﬁelds from the PFSS (Bale et al.
2019; Panasenco et al. 2020). When the training data
for our deep-learning model have been prepared for this
solar cycle, we hope to compare the results with the
PSP observations. Solar Orbiter, which was launched
in 2020, is equipped with a wide range of not only in
situ but also remote-sensing instruments (Mueller et al.
2013), which can be better examined with our method.
Moreover, our study may give us new insight on the
global solar research techniques and on how to construct
a set of instruments on board future spaceborne solar
imaging missions such as the L4 and L5 missions (Vourl-
idas 2015).

ACKNOWLEDGMENTS

We really appreciate the referee’s constructive com-
ments. We thank the numerous team members who
have contributed to the success of the SDO mission,
as well as the STEREO mission. We also thank the
Solar Physics Group at Stanford University for their
support in providing timely access to HMI data and
synoptic maps. We acknowledge the community ef-
forts devoted to developing the open-source packages
that were used in this work. This work was sup-
ported by the BK21 plus program through the Na-
tional Research Foundation (NRF) funded by the Min-
istry of Education of Korea, the Basic Science Re-
search Program through the NRF funded by the Min-
istry of Education (NRF-2016R1A2B4013131, NRF-
2019R1A2C1002634, NRF-2019R1C1C1004778, NRF-
2020R1C1C1003892), the Korea Astronomy and Space
Science Institute (KASI) under the R&D program
‘Study on the Determination of Coronal Physical Quan-
tities using Solar Multi-wavelength Images (project No.
2019-1-850-02)’ supervised by the Ministry of Science
and ICT, and Institute for Information & communica-
tions Technology Promotion (IITP) grant funded by the
Korea government (MSIP; 2018-0-01422, Study on anal-
ysis and prediction technique of solar ﬂares).

12

Jeong et al.

REFERENCES

Amari, T., Canou, A., Aly, J.-J., Delyon, F., & Alauzet, F.

Lee, C., Luhmann, J., Hoeksema, J., et al. 2011, Solar

2018, Nature, 554, 211

Physics, 269, 367

Arge, C., & Pizzo, V. 2000, Journal of Geophysical

Research: Space Physics, 105, 10465

Lemen, J. R., Akin, D. J., Boerner, P. F., et al. 2011, in
The solar dynamics observatory (Springer), 17–40

Bale, S., Badman, S., Bonnell, J., et al. 2019, Nature, 576,

Liewer, P., Qiu, J., & Lindsey, C. 2017, Solar Physics, 292,

237

146

Bertello, L., Pevtsov, A., Petrie, G., & Keys, D. 2014, Solar

Lowder, C., Qiu, J., Leamon, R., & Liu, Y. 2014, The

Physics, 289, 2419

Astrophysical Journal, 783, 142

Buduma, N., & Locascio, N. 2017, Fundamentals of deep

Miki´c, Z., Downs, C., Linker, J. A., et al. 2018, Nature

learning: Designing next-generation machine intelligence
algorithms (” O’Reilly Media, Inc.”)

Cairns, I. H., Lobzin, V., Donea, A., et al. 2018, Scientiﬁc

reports, 8, 1

Astronomy, 2, 913

Mirza, M., & Osindero, S. 2014, CoRR, abs/1411.1784
Mueller, D., Marsden, R. G., Cyr, O. S., Gilbert, H. R.,

et al. 2013, Solar Physics, 285, 25

Chen, Q., & Koltun, V. 2017, 2017 IEEE International

Nandy, D., Bhowmik, P., Yeates, A. R., et al. 2018, The

Conference on Computer Vision (ICCV), 1520

Astrophysical Journal, 853, 72

DeVore, C. R., Sheeley, N., & Boris, J. 1984, Solar physics,

Nitta, N. V., Reames, D. V., DeRosa, M. L., et al. 2006,

92, 1

The Astrophysical Journal, 650, 438

Downs, C., Roussev, I. I., van der Holst, B., Lugaz, N., &
Sokolov, I. V. 2012, The Astrophysical Journal, 750, 134

Panasenco, O., Velli, M., D’Amicis, R., et al. 2020, The
Astrophysical Journal Supplement Series, 246, 54

Fox, N., Velli, M., Bale, S., et al. 2016, Space Science

Park, E., Moon, Y.-J., Lee, J.-Y., et al. 2019, The

Reviews, 204, 7

Freeland, S. L., & Handy, B. 1998, Solar Physics, 182, 497
Goodfellow, I., Bengio, Y., Courville, A., & Bengio, Y.
2016, Deep learning, Vol. 1 (MIT press Cambridge)
Hakamada, K., Kojima, M., Ohmi, T., Tokumaru, M., &

Astrophysical Journal Letters, 884, L23

Park, E., Moon, Y.-J., Lim, D., & Lee, H. 2020, The

Astrophysical Journal Letters, 891, L4

Park, E., Moon, Y.-J., Shin, S., et al. 2018, The

Astrophysical Journal, 869, 91

Fujiki, K. 2005, Solar Physics, 227, 387

Park, J., Innes, D., Bucik, R., & Moon, Y.-J. 2013, The

Hickmann, K. S., Godinez, H. C., Henney, C. J., & Arge,

Astrophysical Journal, 779, 184

C. N. 2015, Solar Physics, 290, 1105

Pastor Yabar, A., Mart´ınez Gonz´alez, M., & Collados, M.

Howard, R. A., Moses, J., Vourlidas, A., et al. 2008, Space

Science Reviews, 136, 67

Huang, X., Wang, H., Xu, L., et al. 2018, The

Astrophysical Journal, 856, 7

Illarionov, E. A., & Tlatov, A. G. 2018, Monthly Notices of

2015, Monthly Notices of the Royal Astronomical
Society: Letters, 453, L69

Pesnell, W. D., Thompson, B. J., & Chamberlin, P. 2011,
in The Solar Dynamics Observatory (Springer), 3–15
Pomoell, J., & Poedts, S. 2018, Journal of Space Weather

the Royal Astronomical Society, 481, 5014

and Space Climate, 8, A35

Inoue, S., Kusano, K., B¨uchner, J., & Sk´ala, J. 2018,

Riley, P., Linker, J., Miki´c, Z., et al. 2006, The

Nature communications, 9, 1

Astrophysical Journal, 653, 1510

Isola, P., Zhu, J.-Y., Zhou, T., & Efros, A. A. 2017, in

Rust, D. M., Haggerty, D. K., Georgoulis, M. K., et al.

Proceedings of the IEEE conference on computer vision
and pattern recognition, 1125–1134

2008, The Astrophysical Journal, 687, 635

Schatten, K. H., Wilcox, J. M., & Ness, N. F. 1969, Solar

Jess, D. B., Reznikova, V. E., Ryans, R. S., et al. 2016,

Physics, 6, 442

Nature Physics, 12, 179

Scherrer, P. H., Schou, J., Bush, R., et al. 2012, Solar

Ji, E.-Y., Moon, Y.-J., & Park, E. 2020, Space Weather, 18,

Physics, 275, 207

e2019SW002411

Schrijver, C. J., & DeRosa, M. L. 2003, Solar Physics, 212,

Kaiser, M. L., Kucera, T., Davila, J., et al. 2008, Space

165

Science Reviews, 136, 5

Shin, G., Moon, Y.-J., Park, E., et al. 2020, The

Kim, T., Park, E., Lee, H., et al. 2019, Nature Astronomy,

Astrophysical Journal Letters, 895, L16

3, 397

Solanki, S., Sch¨ussler, M., & Fligge, M. 2002, Astronomy &

Kingma, D. P., & Ba, J. 2015, CoRR, abs/1412.6980

Astrophysics, 383, 706

Coronal extrapolation from synchronic data with AI-generated farside

13

Steenburgh, R., Biesecker, D., & Millward, G. 2013, in
Solar Origins of Space Weather and Space Climate
(Springer), 239–254

Su, Y., & Van Ballegooijen, A. 2012, The Astrophysical

Journal, 757, 168

Subramanian, V. 2018, Deep Learning with PyTorch: A
practical approach to building neural network models
using PyTorch (Packt Publishing Ltd)

Sun, X., Liu, Y., Hoeksema, J., Hayashi, K., & Zhao, X.

2011, Solar Physics, 270, 9

Vourlidas, A. 2015, Space Weather, 13, 197

Wang, T.-C., Liu, M.-Y., Zhu, J.-Y., et al. 2018, in

Proceedings of the IEEE conference on computer vision

and pattern recognition, 8798–8807

Wang, Y.-M., Hawley, S. H., & Sheeley, N. R. 1996,

Science, 271, 464

Wang, Y.-M., & Sheeley Jr, N. 1992, The Astrophysical

Journal, 392, 310

Ugarte-Urra, I., Upton, L., Warren, H. P., & Hathaway,

—. 2003, The Astrophysical Journal, 587, 818

D. H. 2015, The Astrophysical Journal, 815, 90

