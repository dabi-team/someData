Spatial Firewalls: Quarantining Malware Epidemics

1

in Large Scale Massive Wireless Networks

Hesham ElSawy, Senior Member, IEEE, Mustafa A. Kishk, Member, IEEE,

and Mohamed-Slim Alouini, Fellow, IEEE

0
2
0
2

n
u
J

2
1

]

R
C
.
s
c
[

2
v
9
5
0
5
0
.
6
0
0
2
:
v
i
X
r
a

Abstract

Billions of wireless devices are foreseen to participate in big data aggregation and smart automation in order to

interface the cyber and physical worlds. Such large-scale ultra-dense wireless connectivity is vulnerable to malicious

software (malware) epidemics. Malware worms can exploit multi-hop wireless connectivity to stealthily diffuse

throughout the wireless network without being noticed to security servers at the core network. Compromised devices

can then be used by adversaries to remotely launch cyber attacks that cause large-scale critical physical damage and

threaten public safety. This article overviews the types, threats, and propagation models for malware epidemics in

large-scale wireless networks (LSWN). Then, the article proposes a novel and cost efﬁcient countermeasure against

malware epidemics in LSWN, denoted as spatial ﬁrewalls. It is shown that equipping a strategically selected small

portion (i.e., less than 10%) of the devices with state-of-the-art security mechanisms is sufﬁcient to create spatially

secured zones that quarantine malware epidemics. Quarantined infected devices are then cured by on-demand localized

software patching. To this end, several ﬁrewall deployment strategies are discussed and compared.

Cybersecurity, Malware epidemics, Massive wireless networks, Percolation theory.

Index Terms

I. INTRODUCTION

The imminent era of smart world relies on large-scale massive wireless connectivity that interfaces the

physical and cyber worlds. The surging Internet of Things (IoT) and cyber physical systems (CPS) with

massive numbers of heterogeneous wireless devices (e.g., sensors, actuators, smart phones, smart appliances,

H. ElSawy is with King Fahd University of Petroleum and Minerals (KFUPM), Dhahran, Eastern Province, Saudi Arabia. email:

hesham.elsawy@kfupm.edu.sa.

M.A. Kishk and M.-S. Alouini are with King Abdullah University of Science and Technology (KAUST), Thuwal, Makkah Province, Saudi

Arabia, email: {mustafa.kishk, slim.alouini}@kaust.edu.sa.

This work is funded in part by the deanship of scientiﬁc research (DSR), at King Fahd University of Petroleum and Minerals (KFUPM), under

research grant no. DF191052.

 
 
 
 
 
 
2

autonomous vehicles, etc.) are examples of such massive large-scale wireless networks (LSWNs). IoT/CPS

are foreseen to provide ﬂexible platforms for big data aggregation and/or smart automation to almost every

aspect in our lives [1]. For instance, intelligent transportation systems with connected/autonomous vehicles

exploit wireless connectivity to improve road safety and reduce trafﬁc congestion. Smart power grids utilize

wireless connectivity for data communications and smart control (e.g., smart meters and ﬁeld devices) in

order to enhance energy generation and distribution. Large scale massive connectivity is also a foundational

building block for process automation in the next industrial revolution (i.e., industry 4.0). In addition to

the aforementioned examples, large-scale massive wireless connectivity can bring unlimited potentials to

many other verticals such as health care, public safety, agriculture, retail, etc.

On the downside, massive LSWNs bring a multitude of new and challenging security threats [1].

Particularly, many of the wireless devices in the IoT/CPS are installed and controlled via consumers with

limited security background. The high competition between IoT/CPS manufacturers overlooks cybersecurity

aspects to reduce costs and keep-up with the rapid proliferation of IoT/CPS. Many IoT/CPS devices are

too constrained, in terms of computational power, energy, and storage, to implement and continuously

execute sophisticated defense mechanisms [2], [3]. Such lack of security oriented network administration

and per-device defense mechanisms opens several loopholes for adversaries to inﬁltrate malicious software,

or shortly malware, to the network.

Conventionally, malware programs are designed for variety of criminal and hostile activities such as

spying (spyware), threatening for monetary beneﬁt (ransomware), and/or controlling large population of

devices (botnets). In IoT/CPS networks, malware hostile activities naturally extend to physical threats.

In smart vehicles, adversaries can control the vehicle through telematics unit, which introduce the risk

of physical denial of service (DoS) (e.g., stop the engine and lock doors/windows) as well as deliberate

collisions. In power grids, adversaries can compromise ﬁeld devices (e.g., switch gears and circuit breakers)

to sabotage equipment, disrupt power distribution, and cause major blackouts. In medical care systems,

adversaries can inject false prescriptions and manipulate wearable drug infusion devices. In industrial

environments, adversaries can halt/manipulate ongoing production lines, delete customized machine setting,

or even damage products and injure workers. There could be also generic attacks for LSWN such as network

jamming and colluded eavesdropping. Note that network-jamming attacks may disrupt the entire network

connectivity via overwhelming interference and shorten the network lifetime by depleting compromised

devices batteries. Using colluded eavesdropping, adversaries can reveal and misuse private data.

Exploiting the massive spatial density in LSWN and multi-hop wireless connectivity (e.g., machine-to-

machine communications), the malware can stealthily propagate from one device to another and form an

epidemic outbreak without being noticed by the security administration at the core network [2], [4]. Even

worse, the emerging beyond 5G technologies (e.g., non-orthogonal multiple access (NOMA) and ultra-

3

reliable low latency communications (URLLC)), that are meant to enhance information dissemination, will

also accelerate epidemic outbreak throughout the network. An epidemic outbreak of a malware enables

the adversities to control a large population of devices and launch large-scale cyberphiscal attacks, which

may lead to catastrophic consequences in IoT/CPS. From the propagation point of view, malware can be

classiﬁed into the following categories

• Trojans: Malware hiding in legitimate programs but intended to infect a target system and open

backdoors for future intrusion.

• Virus: Self-replicating malware designated to infect and corrupt the operation of a target system.

Viruses propagates via host executable ﬁles.

• Worm: Self-replicating malware intended to spread and infect all the devices in a network. A worm

is a stand-alone software that automatically propagate from one device to another.

Human interventions, such as manual attacks by adversaries or infected ﬁle exchange/execution by

legitimate users,1 are required for Trojans and viruses to spread in a network. On the other hand, worm

malware automatically identiﬁes network vulnerabilities to diffuse and compromise new targets. Exploiting

the dense network deployment, the broadcast nature of the wireless channel, the one-to-many communication

schemes (e.g, NOMA), and high-reliability-low-latency communications (e.g., URLLC), worm malware can

quickly and covertly spread in the wireless network and form an epidemic outbreak. This makes worm

epidemics the hardest to decelerate their diffusion and/or quarantine their infection. Hence, worm malware

is among the highest security threats for large-scale wireless networks [5].

II. SECURING LARGE-SCALE IOT/CPS

The aforementioned threatening physical consequences of malware intrusion in CPS/IoT call out for

robust security countermeasure and defense mechanisms. Securing the devices against manipulation and

intrusion is the ﬁrst line of defense for IoT/CPS networks. Such defense mechanisms could be embedded

in hardware (e.g., trusted platforms), software (e.g., anti-malware programs), communication protocols

(e.g., encryption & authentication), and/or device operation (scheduled attestation/patching). However, the

strict cost, energy, and computational power constraints of devices in many IoT/CPS applications limit the

implementation of sophisticated defense mechanisms to all devices. In this regards, [3] proposes a Poisson

game to distributively decide on which devices to adopt an anti-malware such that an epidemic outbreak

is prevented. However, the proposed mechanism in [3] is based on a fully mixed epidemic model,2 which

overlooks the spatial topology and limited wireless communication range in LSWN.

1Legitimate users can be incentivised to install free programs that contain malware.

2A fully mixed epidemic model assumes that an infection (e.g., malware) can be directly transmitted from any node in the network to any

other node in the network.

4

Another effective, yet simple, defense mechanism is to perform scheduled (i.e., periodic) software

attestation/patching for IoT/CPS devices to ensure conﬁgurations integrity and wipeout potential malicious

software [6], [7]. However, to thwart epidemic diffusion, the treatment rate should be faster than the epidemic

infection rate. Being oblivious to the device status, unnecessary disruption for the IoT/CPS operation may

occur due to attesting/patching healthy devices [6]. Furthermore, a device that is compromised shortly after

being patched/attested, may have enough time to be exploited to launch versatile malicious attacks. Such

problems are more acute when employing wireless technologies such as NOMA and URLLC due to the

accelerated epidemic infection rate.

To efﬁciently balance the tradeoff between cybersecurity, anti-malware license cost, and devices hardware

complexity, this paper proposes a novel ubiquitous security countermeasure, denoted as “spatial ﬁrewalls”,

which is meant to detect, spatially quarantine, and report malware infections in LSWN. The proposed spatial

ﬁrewalls countermeasure is detailed in Section III. Section IV highlights the mathematical propagation

models for malware in LSWN, which are necessary to design and assess cybersecurity countermeasures.

Section V showcases and assesses the spatial ﬁrewalls solution before the paper is concluded in Section VI.

III. THE SPATIAL FIREWALLS SOLUTION

To secure massive LSWN against malware epidemics, this paper proposes to implement “spatial ﬁre-

walls”, which are deﬁned as follows:

Deﬁnition 1. Spatial Firewalls are wireless devices, with sufﬁcient computational capabilities, energy

resources, and memory, to store, execute, and frequently update anti-malware and intrusion detection

programs (e.g., edge computing devices, access points, junction nodes). These devices are deployed at

critical locations within a LSWN to enforce secured zones in order to quarantine any emerging malware

epidemic and thwart its outbreak.

Fig. 1 illustrates an edge-computing enabled spatial ﬁrewall operation in massive LSWNs, where ﬁrewalls

are implemented at base stations. Devices that are adjacent to a ﬁrewall inquire about codes (e.g., software

updates, system conﬁgurations, or control commands) received from their wireless interface. For each valida-

tion inquiry, the ﬁrewall ensures that the code is malware free (e.g., using signature-based or anomaly-based

detection) and veriﬁes its integrity (e.g., using operator digital signature and certiﬁcates) [7]. Only validated

codes are approved for execution and/or dissemination to other devices. If a threat is detected, the ﬁrewall

disapproves the code execution/dissemination and reports the incident to the security administration. Hence,

each ﬁrewall creates a secured zone, determined by its wireless range, for adjacent devices and thwarts

their infection (i.e., analogous to herd immunity effect). Thus, ﬁrewalls enable an exclusive dissemination of

5

Fig. 1: Illustration of an edge-computing enabled spatial ﬁrewalls operation in massive LSWN to quarantine

malware diffusion. The secured zones succeed to spatially quarantine the malware infection within a conﬁned

area with limited number of devices.

legitimate codes through the network.3 In summary, spatial ﬁrewalls are meant to i) create spatially secured

zones within the wireless network, ii) thwart the dissemination of malware (i.e., ensure that malware can

only inﬁltrate to limited number, by design, of devices regardless of the infection/treatment rates), and iii)

initiate on-demand software attestation/patching for infected devices.

It is worth noting that extending the ﬁrewall code validation scheme for non-adjacent devices through

multi-hop wireless inquiries may impose overwhelming signaling overhead and large control latency due

to the massive and wide-scale deployment of devices. To balance the security, signaling overhead, and

3Different from legacy IT systems, IoT/CPS networks have no clear boundary between secured and unsecured (i.e., public) domains. Hence,

the proposed spatial ﬁrewalls enforce the concept of secured zones within the wireless network.

6

control latency of the network, the code-validation role of the ﬁrewall is limited to adjacent devices. As

such, the design objective is to have sufﬁcient numbers of efﬁciently located ﬁrewalls to satisfy the security

requirements of the network, which may tolerate interim infection of some devices (i.e., until being detected

and patched).

As compared to scheduled patching/software attestation [6], [7], spatial ﬁrewalls provide ubiquitous

security countermeasure that reacts to attacks by i) thwarting malware diffusion, ii) localizing infected

(i.e., quarantined) regions,4 and iii) initiating localized software attestation/patching campaigns. Due to

the overwhelming overhead and time required for brute-force software attestation/patching of all devices,

localizing infected regions is necessary in massive LSWN.

A. Practical Implementation Challenges

To conceptualize and materialize the spatial ﬁrewalls cybersecurity countermeasure, several practical

challenges should be taken into consideration, which include

• Firewall deployment: The main technical challenge is to determine the number of ﬁrewalls and their

spatial locations that guarantee spatially quarantined malware.

• Techno-economic aspects: The ﬁrewall deployment should account for the trade-off between net-

work security, involved capital-expenditure (CAPEX) to deploy ﬁrewalls, and operational-expenditure

(OPEX) to maintain their up-to-date anti-malware programs and licenses. In case of multiple IoT/CPS

operators/owners, an agreement for bearing such CAPEX and OPEX is required.

• Operator privacy: In case of multiple operators, code veriﬁcation and software attestation schemes

should keep the speciﬁc information and conﬁgurations of the operators hidden from each other.

• Devices heterogeneity: For universal utilization of spatial ﬁrewalls, uniﬁed/standardized signaling

protocols for different IoT/CPS devices using different wireless interfaces are required. Such signaling

protocols should deﬁne the method for ﬁrewall discovery, association, and templates for code validation

inquiries/responses.

• Signaling overhead: Efﬁcient signaling schemes are required for code veriﬁcation to impose minimum

disruption to the existing data trafﬁc. For instance, encrypted digital signature for ﬁrewalls should be

developed to eliminate redundant validation of the same code across different ﬁrewalls.

• Latency: The code validation and execution should occur within the tolerable latency deﬁned by

data communications and/or control applications. This may require developing security-aware trafﬁc

prioritization schemes that expedite ﬁrewalls related signaling.

4The location of quarantined regions can be inferred from the reporting ﬁrewalls identities and known locations.

7

• Devices Mobility: Malware may get through the secured-zones by means of physical mobility of

infected devices. Hence, the spatial ﬁrewalls should be able to detect and cure infected mobile devices

passing through secured zones.

This paper focuses on the spatial ﬁrewall deployment that ensures spatially quarantined malware. Other

challenges are left for future extensions. In particular, we aim to provide guidelines to design and assess the

impact of implementing spatial ﬁrewalls. To minimize the associated CAPEX and OPEX, the objective is

to ﬁnd the minimum number of ﬁrewalls that enforce an epidemic free network operation. For this purpose,

we ﬁrst present the underlying mathematical models for malware propagation that are used to formulate

and solve the spatial ﬁrewall design problem. Then, several spatial deployment strategies for ﬁrewalls are

discussed and compared.

IV. PROPAGATION MODELS FOR MALWARE EPIDEMICS

Mathematical models that characterize propagation of infection in large populations are used to predict

epidemic outcomes and design defense mechanisms. In IT systems, the population represents a network of

connected devices. The network topology is mathematically described by a graph G = {V, E}, where V is

the set of vertices (i.e., devices) and E is the set of edges connecting the vertices (see Fig. 2). In the context

of wireless networks, an edge between two devices implies that they are within the communication range

of each other. The communication range is usually deﬁned by a minimum required signal-to-interference-

plus-noise-ratio (SINR) [8]. Graphs that account for the random spatial locations of the devices and their

wireless communications ranges are denoted as random geometric graphs (RGGs).

An epidemic is considered as a process on the graph, where each device (i.e., vertex) can transition

between different states such as susceptible (S) (i.e., healthy but can be infected), infected (I) (i.e., com-

promised via a malware), and recovered (R) (i.e., malware is detected and removed). A malware worm can

only inﬁltrate from an infected device to a susceptible device if the two devices are directly connected via

an edge. Once a new device gets compromised by a malware, it becomes an infection threat to its directly

connected neighbors and so on.

The dynamics of epidemic infection/treatment are fully characterized via time domain models. Due to

several factors (e.g., medium access control protocols and per-link transmission rate), the time taken for

malware worm to inﬁltrate from an infected to susceptible device is random. Meanwhile, depending on the

malware detection and treatment technique, the time a device stays infected is also random. On average,

propagation and recovery rates (or probability per unit time) can be characterized, which are then used

to construct a system of differential equations that fully describes the temporal evolution of an epidemic.

Resorting to the fact that the total number of devices in the network remain ﬁxed (i.e., the total population),

such system of equations can be solved to determine the percentiles of devices in each of the S, I, and R

8

states, as function of time. However, in RRGs, such system of differential equations is not tractable and

approximations are always sought [9].

Instead of full temporal characterization, the ﬁnal outcome of an epidemic infection can be directly

characterized. Such late-time characterization alleviates the mathematical complications (e.g., non-linearity

of differential equations) introduced by temporal models. In particular, late-time models characterize the

overall epidemic inﬁltration through the network without any information about the infection/treatment

rates. As mentioned earlier, the time taken for a malware worm to propagate from a device to each of its

neighbors is random and the time each device remain infected is also random. Hence, even after sufﬁciently

long time, some devices will be cured before infecting some of their neighbors and the malware worm

would only inﬁltrate through a subset of the network. For a given malware worm, the late time model

would show all devices that were infected at any point in time regardless if they got cured or not. Such

phenomenon of global and time oblivious worm diffusion, through a portion of the network, can be studied

via percolation theory, which is deﬁned as follows

Deﬁnition 2. Percolation Theory is a well-developed mathematical ﬁeld that characterizes global connec-

tivity in random graphs when vertices and their associated edges are removed. Connectivity is characterized

by the presence/absence of a giant component, which is the largest connected sub-graph that spans the

horizon.

Mapping to the aforementioned epidemic models, percolation theory can be used to characterize late-

time epidemic outbreak as follows. Consider the complete network graph and remove all devices, with

their associated edges, that are never infected (i.e., their neighbors are cured before malware inﬁltration).

After such devices removal, the existence (absence) of a giant component implies an epidemic outbreak

(quarantine). In the notation of percolation theory, we have the following deﬁnitions

Deﬁnition 3. Supercritical Regime deﬁnes the set of network parameters such that a giant connected

component exits.

Deﬁnition 4. Subcritical Regime deﬁnes the set of network parameters such that a giant connected

component does not exist.

Percolation theory is best suited to develop robust security countermeasures that are independent of

the epidemic infection/treatment rates. That is, no matter how fast (slow) is the infection (treatment) rate,

a defense mechanism that operates the susceptible devices in the subcritical regime ensures quarantined

epidemic. On the other hand, if the susceptible devices operate in the supercritical regime, then an epidemic

outbreak may occur if the treatment rate is not sufﬁciently faster than the infection rate. In the latter case,

9

(a) Malware epidemic outbreak for Random selection of

(b) Malware epidemic outbreak for degree-aware selection

ﬁrewalls

of ﬁrewalls

(c) Malware epidemic outbreak for random selection with

(d) Quarantined malware for degree-aware selection with

minimum DC

minimum DC

Fig. 2: Epidemic potential diffusion in the same network realization under different ﬁrewalls selection

strategies for ﬁrewalls percentage of 6% of the total network devices. The ﬁgure follows the same color

code for ﬁrewalls, secured zone, susceptible, and compromised IoT/CPS devices. The links between devices

denote potential routes for malware epidemic diffusion, which are obstructed by secured zones. Only ﬁgure

(d) eliminates the giant connected component, which implies quarantined epidemic.

10

the giant component size relative to the network size represents the percentile of infected devices.

It is worth noting that percolation theory is a well developed ﬁeld that has been extensively used in

the literature to characterize ad hoc and cognitive network connectivity [8], [10], secure dissemination

of information [11], network resilience/reliability [12], and Internet malware epidemics [13]. However,

percolation models are barely used to characterize and develop defense mechanisms for epidemics in

LSWN. Note that, in wireless networks, epidemic propagation is highly restricted by the network spatial

topology, medium access control, and physical layer properties [14]. Hence, it is important to consider

RRG to account for the intrinsic properties of wireless networks [6], [8], [11]. In this regards, stochastic

geometry (see [15]–[19] for tutorials) can be utilized to model the spatial devices locations and construct

SINR-aware edges that connect devices that can reliably communicate to each other. Then, exploiting the

rich literature on percolation theory, epidemic propagation can be characterized, and defense mechanism

can be developed for a variety of IoT/CPS systems and use cases.

V. SPATIAL FIREWALLS DESIGN AND ASSESSMENT

A. Network Model and Proposed Approach

As discussed earlier, due to cost, energy, and computational power constraints, not all IoT/CPS devices can

adopt sufﬁcient security mechanisms. Furthermore, state oblivious scheduled software attestation/patching

may deteriorate the IoT/CPS functionality due to unnecessary (delayed) patching of healthy (infected)

devices. Hence, we propose to strategically select some devices, denoted as spatial ﬁrewalls, and equip

them with state-of-the-art security mechanisms such as anti-malware and anomaly/intrusion detection pro-

grams. As shown in Fig. 1, each ﬁrewall enforces a security zone of radius Rf meters, where Rf is the

communication/detection range of ﬁrewalls. Then, all IoT/CPS devices within a secured zone, denoted as

protected devices, should validate codes (e.g., software, conﬁguration, or control commands) with ﬁrewalls

before executing or relaying them. Hence, neither the ﬁrewalls nor the protected devices participate in

malware diffusion. Consequently, the secured zones enforced by the ﬁrewalls will split the network into

protected (i.e., green) and susceptible (gray) IoT/CPS devices. The design objective for spatial ﬁrewalls

is to enforce sufﬁcient secured zones, denoted as critical percentage, that ensures quarantined epidemics.

Regardless of the infection/treatment rates, the ﬁrewalls provides a ubiquitous defense mechanism to thwart

wide-spread diffusion of malware and initiate informed (i.e., status-aware) software patching for infected

devices.

Interpreting the ﬁrewall design objective to the notion of percolation theory, it is required to remove the

minimum number of vertices from the IoT/CPS network graph such that the largest connected subgraph does

not percolate. In other words, it is required to place sufﬁcient number of ﬁrewalls at effective locations such

that the network formed by devices outside the secured zones operate in the subcritical regime. Otherwise,

11

the epidemic spatial diffusion may get out of control and span the horizon. It is worth noting that the wireless

network topology is dynamic due to devices mobility. Furthermore, the security defense mechanism should

be general in case there is no prior knowledge about the underlying devices locations. Hence, the spatial

ﬁrewalls should be selected among the set of vertices V in a RRG G, which accounts for devices wireless

communication range as well as the random spatial locations of devices.

A well established result in the literature for random graphs is that network percolation exhibit a phase

transition phenomenon between the supercritical and subcritical regimes. This means that it is feasible to

quarantine epidemics in LSWN if the correct percentage of devices are protected. Such critical percentage

could be mathematically quantiﬁed via percolation models. However, different from conventional percolation

problems, where individual vertices are randomly removed, in the spatial ﬁrewall problem a chunk of

proximate vertices (i.e., all devices in the spatial secured zones including the ﬁrewalls, as well as all of

their associated edges) are removed (c.f. Fig. 2). Hence, advanced percolation models, such as percolation

on networks with holes [20], are required for the design, implementation, and assessment of spatial ﬁrewalls.

Inspired by results from percolation theory, the ﬁrewalls design objective is decomposed to 1) ﬁnd

minimum percentage of spatial ﬁrewalls that guarantees quarantined malware,5 2) select the spatial locations

of ﬁrewalls that minimizes the average sizes of connected clusters of susceptible devices. This article

examines four heuristic ﬁrewall selection schemes, namely, i) random, ii) degree-aware, iii) random with

minimum distance constraint (DC), and iv) degree-aware with minimum DC. Degree awareness is crucial

because devices with high degree would participate more to an epidemic diffusion. Intuitively, devices with

higher degrees are expected to have a signiﬁcant impact on epidemic diffusion if selected as ﬁrewalls due

to the high number of protected neighbors within the secured zone. The minimum DC among the ﬁrewalls

guarantees good spatial distribution of secured zones across the network to thwart emerging epidemics in

different locations.

A pictorial illustration of the ﬁrewalls is shown in Fig. 2 for different selection strategies. While the

same number of ﬁrewalls is selected in all cases, Figs. 2a, 2b, and 2c, show poor spatial distributions of

secured zones that fails to eliminate the giant connected component. Thus, a wide spread of the malware

epidemic is viable. However, the degree-aware with minimum DC ﬁrewalls in Fig. 2d ensures a good spatial

distribution of the secured zones and succeeds to split the network into disjoint clusters. Hence, regardless

of the infection/treatment rates, a malware injected to any susceptible device within a cluster is prevented

to diffuse to other clusters in the network. Upon the detection of the malware, ﬁrewalls inform the security

administration to initiate localized software attestation/patching to all devices in the infected cluster.

5Due to the involved CAPEX and OPEX of the spatial ﬁrewalls (e.g, hardware upgrade and software license), a cost efﬁcient selection

strategy should quarantine an epidemic with less critical intensity of ﬁrewalls.

12

Fig. 3: Probability of epidemic outbreak versus the percentage of ﬁrewalls.

B. Proof of Concept

While the proof-of-concept can be done analytically using tools from stochastic geometry and percolation

theory, we resort to comprehensive Monte Carlo simulations to alleviate unnecessary mathematical details.

Each simulation run realizes 4 × 4 km2 random network with wrap around boundaries. The devices are

distributed in the simulation area according to a Poisson point process with intensity λ = 80 device/km2

(i.e., an average of 1280 device per simulation run). Each device is assumed to have a communication range

of 200 m, where a connection is realized between two devices that lie within the communication range of

each other. The ﬁrewalls are chosen among the network devices according to the implemented selection

scheme, where each ﬁrewall enforces a circular secured zone with a radius of 200 m. The devices that fall

within the secured zone are excluded and the global network connectivity is realized. Percolation is declared

if a giant component of susceptible devices that spans the simulation area vertically and horizontally exists.

Percolation means that the selected spatial ﬁrewalls fail to quarantine the malware infection. This is because

a malware inﬁltrated to any of the devices within the giant component can create an epidemic outbreak

within that component of susceptible devices without being obstructed by the selected spatial ﬁrewalls.

Furthermore, the number of disjoint clusters and the number of devices per each cluster are recorded. A

pictorial illustration of a single simulation run is depicted in Fig. 2, where percolation is declared for the

scenarios in Figs. 2a, 2b, 2c.

00.020.040.060.080.1Percentage of Firewalls00.20.40.60.81Malware Outbreak ProbabilityRandomRandom with DCDegree-awareDegree-aware with DC13

Fig. 4: Number of disjoint clusters and size of the maximum cluster versus the percentage of ﬁrewalls.

Fig. 3 shows the malware outbreak probability versus the percentage of devices that are selected as ﬁre-

walls. Surprisingly, random ﬁrewall selection signiﬁcantly outperforms the degree-aware selection scheme.

Such counter-intuitive behavior is due to the spatially correlated degree of devices. Hence, stand-alone

degree awareness fails to quarantine the epidemic due to the spatial concentration of ﬁrewalls within small

geographical regions, which leads to overlapped secured zones (see Fig. 2b). The random selection of

ﬁrewalls provides a better spatial coverage of secured zones, and hence, succeeds to quarantine epidemics

when the ﬁrewalls are sufﬁciently dense (i.e, critical percentage 9%). Incorporating minimum DC improves

the spatial distribution of ﬁrewalls and reduces the required density of ﬁrewalls. The superior performance

of degree-awareness with minimum DC (critical percentage 6%) is due to the strategic selection of ﬁrewalls

in terms of both spatial distribution of secured zones and number of devices covered by each secured zone.

Fig. 4 shows the number of susceptible clusters along with the number of devices in the largest cluster.

As the intensity of ﬁrewalls increases, large network components break into smaller susceptible clusters

with less devices in each cluster. Hence, the number of clusters increases and the number of devices within

each cluster decreases. Fig. 4 conﬁrms the insights of Fig. 3 regarding the ﬁrewalls selection schemes.

Degree and location awareness ensure that malware can only infect less number of devices within smaller

geographical regions when compared to other sections schemes. It is worth noting that the number of

clusters decreases in Fig. 4 when secured zones start to span and cover the entire simulation area, which

leaves small spatial gaps to form clusters.

0.020.040.060.080.1Percentage of Firewalls0500100015002000Maximum Cluster Size010203040Number of ClustersRandomRandom with DCDegree-awareDegree-aware with DCNumber of ClustersMaximum Cluster Size14

VI. ACKNOWLEDGMENT

Fig. 1 was created by Heno Hwang, scientiﬁc illustrator at King Abdullah University of Science and

Technology (KAUST).

VII. CONCLUSIONS

This article overviews the vulnerabilities and cybersecurity threats in large-scale wireless IoT and CPS.

The article then proposes a novel technique, denoted as spatial ﬁrewalls, to quarantine and cure malware

epidemics in such IoT and CPS. In particular, we show that strategically selecting less than 10% of devices

and equipping them with up-to-date anti-malware programs is sufﬁcient to thwart malware epidemics. To

this end, guidelines to design and characterize the impact of spatial ﬁrewalls is presented. Proof-of-concept

numerical results are presented and several ﬁrewalls selection schemes are evaluated, namely, random and

degree-aware with and without minimum distance constraints. Surprisingly, the random ﬁrewall selection

outperforms degree-aware ﬁrewall selection, which is due to the spatially correlated degree of devices

that lead to poor spatial distribution of ﬁrewalls. Adding a minimum distance constraint to degree-aware

selection scheme signiﬁcantly enhances its impact in terms of percentile of ﬁrewalls required to spatially

quarantine malware epidemics and the size of infected clusters.

REFERENCES

[1] A. Humayed, et al., “Cyber-physical systems securityA survey,” IEEE IoT Journal, vol. 4, no. 6, pp. 1802–1831, Dec 2017.

[2]

I. Agadakos, et al., “Jumping the air gap: Modeling cyber-physical attack paths in the Internet-of-things,” in Proceedings of the 2017

Workshop on Cyber-Physical Systems Security and Privacy. ACM, 2017, pp. 37–48.

[3] Y. Hayel and Q. Zhu, “Epidemic protection over heterogeneous networks using evolutionary Poisson games,” IEEE Transactions on

Information Forensics and Security, vol. 12, no. 8, pp. 1786–1800, Aug 2017.

[4] M. Nekovee, “Modeling the spread of worm epidemics in vehicular ad hoc networks,” in 2006 IEEE 63rd Vehicular Technology Conference,

vol. 2, May 2006, pp. 841–845.

[5] J. Kleinberg, “Computing: The wireless epidemic,” Nature, vol. 449, no. 7160, p. 287, 2007.

[6] M. J. Farooq and Q. Zhu, “Modeling, analysis, and mitigation of dynamic botnet formation in wireless IoT networks,” IEEE Transactions

on Information Forensics and Security, vol. 14, no. 9, pp. 2412–2426, Sep. 2019.

[7] N. Asokan, et al., “SEDA: Scalable embedded device attestation,” in Proceedings of the 22nd ACM SIGSAC Conference on Computer

and Communications Security, 2015, pp. 964–975.

[8] O. Dousse, et al., “Percolation in the signal to interference ratio graph,” Journal of Applied Probability, vol. 43, no. 2, pp. 552–562,

2006.

[9] M. Newman, Networks. Oxford university press, 2018.

[10] W. Ren, Q. Zhao, and A. Swami, “Connectivity of heterogeneous wireless networks,” IEEE Transactions on Information Theory, vol. 57,

no. 7, pp. 4315–4332, July 2011.

[11] P. C. Pinto and M. Z. Win, “Percolation and connectivity in the intrinsically secure communications graph,” IEEE Transactions on

Information Theory, vol. 58, no. 3, pp. 1716–1730, March 2012.

[12] Z. Huang, C. Wang, M. Stojmenovic, and A. Nayak, “Characterization of cascading failures in interdependent cyber-physical systems,”

IEEE Transactions on Computers, vol. 64, no. 8, pp. 2158–2168, Aug 2015.

15

[13] M. Garetto, W. Gong, and D. Towsley, “Modeling malware spreading dynamics,” in IEEE INFOCOM 2003, vol. 3, March 2003, pp.

1869–1879 vol.3.

[14] M. Nekovee, “Worm epidemics in wireless ad hoc networks,” New Journal of Physics, vol. 9, no. 6, p. 189, 2007.

[15] H. ElSawy, E. Hossain, and M. Haenggi, “Stochastic geometry for modeling, analysis, and design of multi-tier and cognitive cellular

wireless networks: A survey,” IEEE Commun. Surveys Tuts., vol. 15, no. 3, pp. 996–1019, 2013.

[16] M. Z. Win, P. C. Pinto, and L. A. Shepp, “A mathematical theory of network interference and its applications,” Proc. IEEE, vol. 97,

no. 2, pp. 205–230, Feb. 2009.

[17] H. ElSawy, A. Sultan-Salem, M. S. Alouini, and M. Z. Win, “Modeling and analysis of cellular networks using stochastic geometry: A

tutorial,” IEEE Commun. Surveys Tuts., vol. 19, no. 1, pp. 167–203, Firstquarter 2017.

[18] M. Haenggi, J. G. Andrews, F. Baccelli, O. Dousse, and M. Franceschetti, “Stochastic geometry and random graphs for the analysis and

design of wireless networks,” IEEE J. Sel. Areas Commun., vol. 27, no. 7, pp. 1029–1046, Sep. 2009.

[19] M. Haenggi, Stochastic Geometry for Wireless Networks. Cambridge University Press, 2012.

[20] A. Sarkar and M. Haenggi, “Continuum percolation with holes,” Statistics & Probability Letters, vol. 126, pp. 212–218, 2017.

BIOGRAPHIES

Hesham Elsawy [S’10, M’14, SM’17] received the Ph.D. degree in electrical engineering from the

University of Manitoba, Canada, in 2014. He was a Post-Doctoral Fellow at the King Abdullah University of

Science and Technology (KAUST), Saudi Arabia, a Research Assistant at TRTech, Winnipeg, MB, Canada,

and a Telecommunication Engineer at the National Telecommunication Institute, Egypt. He is currently an

Assistant Professor with the King Fahd University of Petroleum and Minerals (KFUPM), Saudi Arabia.

His research interests include statistical modeling of wireless networks, stochastic geometry, and queueing

analysis for wireless communication networks. He received several academic awards at the University of

Manitoba, including the NSERC Industrial Postgraduate Scholarship (20102013), and the TRTech Graduate

Students Fellowship (20102014). He has coauthored four award-winning papers that are recognized by the

IEEE COMSOC Best Tutorial Paper Award, IEEE COMSOC Best Survey Paper Award, the Best Scientiﬁc

Contribution Award to the IEEE International Symposium on Wireless Systems 2017, and the Best Paper

Award in Small Cell and 5G Networks (SmallNets) Workshop of the 2015 IEEE International Conference

on Communications (ICC). He is a recipient of the IEEE ComSoc Outstanding Young Researcher Award

for Europe, Middle East, & Africa Region in 2018. He is recognized as an exemplary reviewer by the

IEEE Transactions on Communications (20142016), the IEEE Transactions on Wireless Communications

in 2017 and 2018, and the IEEE Wireless Communications Letters in 2018.

Mustafa A. Kishk [S’16, M’18] is a postdoctoral research fellow in the communication theory lab at

King Abdullah University of Science and Technology (KAUST). He received his B.Sc. and M.Sc. degree

from Cairo University in 2013 and 2015, respectively, and his Ph.D. degree from Virginia Tech in 2018. His

current research interests include stochastic geometry, energy harvesting wireless networks, UAV-enabled

communication systems, and satellite communications.

16

Mohamed-Slim Alouini [S’94, M’98, SM’03, F’09] was born in Tunis, Tunisia. He received the Ph.D.

degree in Electrical Engineering from the California Institute of Technology (Caltech), Pasadena, CA, USA,

in 1998. He served as a faculty member in the University of Minnesota, Minneapolis, MN, USA, then in

the Texas A&M University at Qatar, Education City, Doha, Qatar before joining King Abdullah University

of Science and Technology (KAUST), Thuwal, Makkah Province, Saudi Arabia as a Professor of Electrical

Engineering in 2009. His current research interests include the modeling, design, and performance analysis

of wireless communication systems.

