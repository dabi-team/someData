This article has been accepted for publication in a future issue of this journal, but has not been fully edited. Content may change prior to final publication. Citation information: DOI
10.1109/ACCESS.2020.2982057, IEEE Access

Date of publication xxxx 00, 0000, date of current version xxxx 00, 0000. 

Digital Object Identifier 10.1109/ACCESS.2020.Doi Number 

Method for Extracting Patterns of Coordinated 
Network Attacks on Electric Power CPS based 
on Temporal-Topological Correlation 

LEI WANG1,2(Student Member, IEEE), ZHAOYANG QU1,2(Member, IEEE), YANG LI1(Senior 
Member, IEEE), KEWEI HU3, JIAN SUN3, KAI XUE3 AND MINGSHI CUI4 
1School of Electric Engineering, Northeast Electric Power University, Jilin 132012, China 
2Jilin Engineering Technology Research Center of Intelligent Electric Power Big Data Processing, Jilin 132012, China 
3State Grid Jilin Province Electric Power Supply Company, Changchun 130000, China 
4EastInner Mongolia Electric Power Company, Hohhot 010000, China 

Corresponding author: ZHAOYANG QU (e-mail: qzywww@neepu.edu.cn). 

This  work  was  supported  by  the  Key  Projects  of  the  National  Natural  Science  Foundation  of  China  under  Grant  51437003  and  the  Jilin  science  and 
technology development plan project of China under Grant 20180201092GX. 

ABSTRACT In the analysis of coordinated network attacks on electric power cyber-physical system (CPS), 
it  is  difficult  to  restore  the  complete  attack  path,  and  the  intent  of  the  attack  cannot  be  identified 
automatically. A method is therefore proposed for the extracting patterns of coordinated network attacks on 
electric  power  CPS  based  on  temporal-topological  correlation.  First,  the  attack  events  are  aggregated 
according to the alarm log of the cyber space, and a temporal-causal Bayesian network-based cyber attack 
recognition  algorithm  is  proposed  to  parse  out  the  cyber  attack  sequences  of  the  same  attacker.  Then, 
according to the characteristic curves of different attack measurement data in physical space, a combination 
of  physical  attack  event  criteria  algorithm  is  designed  to  distinguish  the  types  of  physical  attack  events. 
Finally, physical attack events and cyber attack sequences are matched via temporal-topological correlation, 
frequent  patterns  of  attack  sequences  are  extracted,  and  hidden  multi-step  attack  patterns  are  found  from 
scattered grid measurement data and information  from alarm logs. The effectiveness and efficiency of the 
proposed method are verified by the testbed at Mississippi State University. 

INDEX  TERMS  Cyber-physical system, Attack pattern, Temporal-topological Correlation, Fuzzy feature 
Analysis, Frequent pattern tree. 

I. INTRODUCTION 
The  “Ukrainian  Blackout”  in  2015,  a  landmark  event  in 
history in which a cyber attack was made on a power grid, 
fully  confirms  that  cyber  attack  could  cripple  essential 
public  systems.  The  SANS  ICS  information  security 
organization has clearly stated that the cause of the incident 
was a coordinated network attack [1]. A coordinated attack 
can  also  look  as  though  multiple  attackers  are  working 
together  to  execute  a  distributed  scan  on  many  internal 
addresses  or  services.  It  is  believed  that  probes  of  this 
nature have been developed in an attempt to elude the scan 
detection code present in many intrusion detection systems 
[2].  The  destructiveness  of  coordinated  network  attacks  is 
increasing  with  the  widespread  application  of  a  large 
number  of  smart  terminals  and  advanced  measurement 
devices in smart grids [3]. 

In 

traditional 

technology, 

the 
information  security 
intrusion  process  of  the  physical  system  is  not  considered, 
and  it  is  difficult  to  effectively  identify  potential  physical 
attack behavior [4]. Additionally, due to the combination of 
both  cyber  and  physical  attacks,  the  existing  protection 
methods, such as intrusion detection system (IDS), firewalls, 
and  abnormal  data  detection,  lack  effective  correlation 
capabilities  and  cannot  identify  multi-step  coordinated 
network  attacks  [5].  Therefore,  there  is  an  urgent  need  to 
study  how  to  extract  hidden  multi-step  attack  patterns  to 
reveal  the  complete  process  of  intrusion  behavior  via  the 
integration of physical grid operation information and cyber 
system alarm information. 

Many  scholars  have  carried  out  research  on  the  pattern 
recognition  and  mining  of  coordinated  network  attack 
sequences. A mining algorithm for cascading failure model 

VOLUME XX, 2020 

1 

This work is licensed under a Creative Commons Attribution 4.0 License. For more information, see https://creativecommons.org/licenses/by/4.0/.

 
This article has been accepted for publication in a future issue of this journal, but has not been fully edited. Content may change prior to final publication. Citation information: DOI
10.1109/ACCESS.2020.2982057, IEEE Access

important  measure 

based  on  sequential  pattern  mining  has  been  proposed  by 
Trang  et  al.  [6],  in  which  the  simulation  analysis  of  a 
massive  amount  of  grid  operation  data  is  conducted  to 
effectively identify the system’s cascading failure modes. A 
sequential  pattern  mining  method  that  takes  into  account 
the  degree  of  interest  of  sequential  patterns  and  the  utility 
value of each item in the sequence was proposed by Li Y et 
al.  [7-8].  It  presents  an  improvement  over  traditional 
sequential  pattern  mining,  and  uses  sequence  frequency  as 
an 
for  patterns.  A  multi-stage 
coordinated  attack  analysis  model  based  on  the  finite  state 
machine  and  intelligent  planning  technology,  which  can 
identify the steps and paths of an attack, was established in 
the  work  by  Gan  w  et  al.  [9-11].  The  reference  [12-13] 
showed  how  a  previously  published  method  based  on 
Monte  Carlo  simulation  could  be  enhanced  to  take  into 
account time-dependent phenomena. The reference [14-16] 
studied  transmission  vulnerability  based  on  the  fault  chain 
theory of security science, the cascading failure process and 
its generic features was described according to a fault chain. 
The  reference  [17]  findings  highlight  the  need  to  consider 
the  load  and  coupling  preference  when  designing  robust 
interdependent networks. 

the  cyber-physical  attack  process. 

However,  the  existing  methods  and  models  have  some 
limitations.  (1)  In  the  analysis  of  the  attack  process,  only 
the  pattern  analysis  of  the  cyber  network  space  or  the 
physical  grid  space  is  performed;  this  diminishes  the 
integrity  of 
(2) 
Supervised  learning  based  on  finite  state  machines  and 
intelligent  planning  focuses  on  the  attack  state  transition 
analysis of smaller-scale systems, which requires too much 
prior  knowledge  and  complex  rules.  It  is  not  practical  for 
application  in  large-scale  CPS  systems.  (3)  The  existing 
mining  models  of  attack  patterns  do  not  comprehensively 
consider the impacts of physical grid constraints and cyber 
network  attacks  on  electric  power  CPS  systems,  and  there 
remains  a  lack  of  effective  methods  for  identifying  attack 
events. 

Based on the existing research, the main purpose of this 
paper is to mine frequent attack patterns consisting of cyber 
attack  sequences  and  physical  attack  events,  and  then  to 
restore  the  attacker's  attack  process  on  the  entire  electric 
power  CPS  system.  In  summary,  the  contributions  of  this 
paper are as follows. 

1)  The  fuzzy  C-means  and  temporal  causal  Bayesian 
network  are  introduced  to  aggregate  cyber  system  alarm 
information  and  extract  cyber  attack  sequences,  which 
significantly  reduces  the  proportion  of  alarms.  Multi-step 
attack  sequences  are  obtained  via  credibility  calculation, 
which improves the accuracy and the number of identified 
multi-step attack sequences. 

2)  A  new  physical  attack  event  recognition  method  that 
combines  physical  criteria  conditions  with  rule  criteria 
conditions  is  proposed,  and  considers  the  variation  law  of 
the  characteristic  curves  for  power  grid  measurement  data 

three  new  key 
under  different  attacks.  Additionally, 
indicators  are  defined  to  improve  the  random  forest  (RF). 
Finally, the identification accuracy of physical attack events 
is improved. 

3)  For  the  first  time,  the  temporal  and  topological 
relationship  of  cyber-physical  components  is  introduced 
into  frequent  pattern  mining, which  combines  cyber  attack 
sequences  and  physical  attack  events.  The  frequent 
subsequence  in  the  complete  attack  sequence  can  be 
extracted, which is the  coordinated  network attack pattern. 
This  method  effectively  reduces  the  number  of  candidate 
sequences  to  be  scanned,  and  no  prior  knowledge  is 
required  to  set  rules  manually,  which  improves  the 
efficiency of pattern mining. 

The  remainder  of  this  paper  is  organized  as  follows.  In 
Section  II,  related  definitions  of  coordinated  network 
attacks  and  the  attack  process  problem  formulation  are 
given. The extraction method of coordinated network attack 
patterns  is  presented  in  Section  III.  The  validation  and 
performance  of  the  proposed  method  are  analyzed  in 
Section IV. Finally, the paper is concluded in Section V. 

II. RELATED DEFINITIONS AND PROBLEM 
FORMULATION 

there 

A. RELATED DEFINITIONS OF COORDINATED 
NETWORK ATTACKS 
Coordinated network attacks on electric power CPS include 
two  processes  that  occur  in  different  spaces  [18].  In  the 
cyber system space, attacks will generate a large number of 
discrete alarm sequences; in the power system space, attack 
events will cause continuous changes in measurement data. 
Moreover, 
is  an  attack  conversion  relationship 
between  cyber  attacks  and  physical  grid  attacks,  and  there 
are certain attack patterns of specific attack steps. Therefore, 
the relevant concepts of the process of coordinated network 
attacks are defined as follows.  
Definition  1.  Cyber  attack  sequence  (CAS).  CAS  aim  at 
attacking  the  cyber  components  in  electric  power  CPS 
systems, which include routers, switches, computing devices, 
etc.  The  same  attacker  aims  to  obtain  certain  cyber  system 
permissions, and implements a complete multi-step attack to 
trigger  an  alarm  event  sequence,  which  is  defined  as  CAS. 
CAS = [sCE1 
 (1 ≤ k ≤ m) indicates 
an alarm event, which is represented by a 7-tuple [19], sCEi 
k = 
(cid,  time,  src-ip,  dst-ip,  src-port,  dst-port,  sig_name),  the 
superscript  CEi  indicates  the  number  of  cyber  components, 
and  the  subscript  k  is  the  type  number  of  the  cyber  attack 
event,  and 
in 
chronological order such that si.time ≤ sj.time, (1 ≤ i ≤ j ≤ m). 
Definition  2.  Physical  attack  event  (PAE).  PAE  aim  at 
attacking  physical  components,  such  as  relay  protection 
devices,  breaks, 
lines,  etc.  Attacks  that 
influence or damage the operation status of the power grid 
by  tampering  with  measurement  data  or  physical  device 

the  related  event  sequence  is  ordered 

2 >...> sCEm 

transmission 

], where sCEi 

1 > sCE2 

m

k

VOLUME XX, 2020 

2 

This work is licensed under a Creative Commons Attribution 4.0 License. For more information, see https://creativecommons.org/licenses/by/4.0/.

 
 
This article has been accepted for publication in a future issue of this journal, but has not been fully edited. Content may change prior to final publication. Citation information: DOI
10.1109/ACCESS.2020.2982057, IEEE Access

k

2

n

1

|ePE2 
configuration  parameters  are  defined  as  PAE  =  [ePE1 
|...,|ePEn 
], where the superscript PEi indicates the number of 
physical components, and subscript k is the type of physical 
attack event. ePEn 
 (1 < k < n) will cause abnormal changes 
in  grid  measurement  (e.g.,  the  voltage  and  current  phase 
angle,  amplitude,  impedance,  etc.).    While  PAE  satisfies 
e1∩em = Ø, (0 < l, m < n), only single physical attack event 
behavior is considered in this paper, and multi-step physical 
attack events are not analyzed. 
Definition  3.  Attack  Pattern  (AP):  A  CAS  and  PAE  that 
belong to the same combined attack sequence [sCE1 
...> s
m  >  ePEn 
] represent the complete attack path  sequence. The 
attack process is closely related to the topological structure of 
the  physical  power  grid  and  the  information  network. 
Therefore,  under  a  specific  electric  power  CPS  topological 
structure, although the attack  paths are different, there  is an 
implicit correlation between these paths. The most frequently 
occurring  subsequence  in  the  attack  path  sequence  are 
defined as AP , which is expressed as [sCEj 
ePEk 

], (1 ≤ j+i ≤ m, 1≤ k≤n). 

j+1 > …>sCEj+i 

j > sCEj+1 

1   > sCE2 

CEm 

2

n

k

j+i => 

B. ANALYSIS OF COORDINATED NETWORK ATTACK 
PROCESS 
The  complete  coordinated  network  attack  process  includes 
two  phases,  namely  a  cyber  attack  and  physical  attack,  as 
illustrated  in  Fig.  1.  During  the  cyber  attack  phase,  cyber 
components  are  primarily  attacked 
through  network 
intrusion means to obtain certain control rights, such as via 
vulnerability  scanning,  brute-force  attack,  and  network 
monitoring  [20-22].  Based  on  this,  during  the  physical 
attack phase,  via the injection of false data or other means 
of  tampering  with  the  scheduling  control  instructions  or 
attacking  the  physical  system  components,  such  attack 
behavior will cause the power system to fail or the line load 
to  be  reduced,  thereby  disrupting  the  normal  operation  of 
the power grid [23-25]. 

and  the  physical  system,  and  finally  acts  on  the  physical 
power  grid  [26].  It  generally  consists  of  multiple 
interrelated  attack  steps,  the  former  step  of  which  is  often 
the condition for the latter step to occur [27].  

Based  on  the  above  analysis  of  the  main  characteristics 
of  coordinated  network  attacks,  there  are  two  kinds  of 
relationships in the different attack stages. 

1)  Temporal  relationship:  If  the  premise  of  an  attack on 
the  physical  grid  is  to  obtain  certain  permissions,  then  the 
cyber attack that obtains this permission must happen first. 
In  other  words,  to  achieve  a specific  attack  target,  a  cyber 
attack  must  be  successfully  carried  out  before 
the 
subsequent  physical  power  grid  attack,  so  the  process 
determines the time range of the physical attack. 

Suppose an attacker's attack path contains parts CASi and 
PAEj, which separately occur in the periods [ti, ti+n] and [tj, 
tj+n].  If  CASi  is  a  prerequisite  for  PAEj,  then  CASi  must 
happen before PAEj, that is, [ti, ti+n] < [tj, tj+n].

2)  Topological  relationship:  There  is  a  topological 
relationship  in  the  attack  location.  In  a  smart  grid,  cyber 
components  (CE)  and  physical  components  (PE)  are 
connected  according  to  a  certain  topological  structure. 
Therefore, the locations  of attacked  CE determine the area 
that  may  be  physically  attacked.  It  is  assumed  that  the 
physical  system  is  an  n-node power  system,  and  the  cyber 
system  is  an  m-node  communication  and  control  network. 
The  two  networks  represent  the  connection  relationship 
through a ternary mapping table O < CEs, PEs, R >, that is 
CEs represents a collection of CE in a cyber-network, PEs 
represents a collection of  PE in a  physical-network, and  R 
represents  the  connection  relationship  between  cyber-
physical  components.  If  PEi  is  connected  to  CE  (CE1, 
CE2 ,…,CEn), then there is a correlation between the  cyber 
attack  event  sequence  [sCE1 
1 >  sCE2 
]  and  the  physical 
attack event ePEi 
. 
i
Assumptions 

2 >…sCEn 

n

1)  Because  the  dispatch  data  network  uses  a  standard 
communication  protocol,  there  is  a  possibility  of  being 
hacked. 

2) After gaining the dispatcher's authority through attack 
methods  such  as  permission  elevation,  the  attacker  can 
issue  malicious  load  shedding  instructions,  leading  to 
various types of grid accidents. 

3)  Cyber  and  physical  attacks  occur  within  a  certain 
interval. When the interval exceeds a certain time limit, the 
attack  components  completed  earlier  may 
their 
influence  on  subsequent  attacks  due  to  human  recovery  or 
security early warning. 

lose 

III.  EXTRACTION METHOD OF COORDINATED 
NETWORK ATTACK PATTERNS 

FIGURE 1. Coordinated network attack process. 

Coordinated network attacks begin with the cyber attack, 
move  through  the  security  boundary  of  the  cyber  system 

A. OVERALL FRAMEWORK 
The proposed framework for the extraction of coordinated 
network  attack  patterns  is  shown  in  Fig.  2.  It  consists  of 

VOLUME XX, 2020 

3 

This work is licensed under a Creative Commons Attribution 4.0 License. For more information, see https://creativecommons.org/licenses/by/4.0/.

Cyber NetworkPhysical NetworkData injection AttackNetwork topologyCyber components AttackPhysical components AttackNetwork coordinated AttackT1T2T3T4 
 
 
 
 
This article has been accepted for publication in a future issue of this journal, but has not been fully edited. Content may change prior to final publication. Citation information: DOI
10.1109/ACCESS.2020.2982057, IEEE Access

three  main  stages:  the  CAS  recognition  in  the  cyber 
system, the  PAE recognition in the physical grid, and the 

AP  extraction  based  on 
correlation. The specific steps are as follows. 

the 

temporal-topological 

FIGURE 2. Framework of the attack pattern extraction method. 

1) During the analysis phase of the attack process on the 
cyber system space, alarm events in the cyber system, such 
as  the  IDS,  syslog,  firewall  log,  and  router  log,  is 
comprehensively  used.  According  to  the  characteristics  of 
cyber  attack,  the  fuzzy  c-means  method  is  used  to  cluster 
the  alarm  events,  therefore  similar  alarm  events  are 
aggregated  together.  Then,  a  temporal  causal  Bayesian 
network  is  used  to  perform  a  fuzzy  causal  analysis  on  the 
sequence  set  to  construct  a  CAS  set.  Via  credibility 
calculation, the CAS that belongs to the same attacker with 
the highest probability is recognized. 

2) During the analysis phase of the attack process on the 
physical  system  space,  the  measurement  data  collected  by 
the  power  management  unit  (PMU)  is  obtained.  Physical 
feature  criteria  conditions  are  established  based  on  the 
operating characteristic curves under different attacks of the 
physical  power  grid,  and  the  normal  state  and  abnormal 
state of the physical system are preliminarily judged. Then, 
three  key  indicators  (δI  and  δU  represent  the  phase 
difference  change  rate  of  voltage  or  current,  δI  and  δU 
represent  the  amplitude  fluctuation  rate  of  voltage  or 
current  , 
 represents  the  mutation  coefficient  of  the 
negative/zero sequence) are defined to represent the law of 
attack  behavior.  The  specific  attack  type  decision  rule 

criterion for the abnormal state dataset is established based 
on the improved  RF algorithm, and the  PAE is recognized 
by relying on the above rules. 

3) During the extraction phase of the  coordinated  attack 
pattern,  CASi∪PAEj are connected  based on the  temporal-
topological correlation. A dynamic sliding window winterval 
is  then  designed  according  to  the  temporal  relationship  to 
obtain  the  full  attack  path  of  the  attacker.  A  coordinated 
network  attack  sequential  pattern  mining  algorithm  is 
proposed  based  on  frequent  pattern  tree.  According  to  the 
attack  pattern  threshold 
,  all  coordinated  network 
 and 
attack APs are extracted. 

B. CAS RECOGNITION BASED ON FUZZY FEATURE 
ANALYSIS 

1) CYBER ATTACK EVENT AGGREGATION 
When  an  attacker 
launches  an  attack  on  a  power 
information network, a large number of warning traces will 
be left in the cyber components, including the IDS, router, 
and firewall. Considering that the alarm events  s1, s2, ..., sk 
of  multi-step  cyber  attack  activities  have  a  certain  internal 
relationship  in  time  and  space,  it  can  restore  the  steps  and 
purpose  of  the  attacker.  However,  these  alarm  logs  are 
scattered  throughout  different  cyber  components,  most  of 

VOLUME XX, 2020 

4 

This work is licensed under a Creative Commons Attribution 4.0 License. For more information, see https://creativecommons.org/licenses/by/4.0/.

PMU measurement data of power physical systemCASi∪PAEj   topological relationship connection O < CEs, PEs, R >Attacker's full attack path CASi => PAEj based on temporal correlation wintervalPhysical features criteriaNormal state dataAbnormal state dataThree new key indicators（ηU and ηI,δI and δU,Г） PAE  recognitionVarious alarm events of the  cyber systemAggregation of similar cyber attack eventsFuzzy causality analysis of attack sequence setsCAS  recognition The analysis of physical system space attackPAECASDecision rule criteriaImproved frequent pattern tree combining cyber-physical component numbersExtraction result of APPattern Extraction of coordinatednetwork  attackThe analysisof cyber system space attackYN 
 
 
 
 
 
This article has been accepted for publication in a future issue of this journal, but has not been fully edited. Content may change prior to final publication. Citation information: DOI
10.1109/ACCESS.2020.2982057, IEEE Access

them  are  low-level  isolated  events  that  lack  relevance  and 
have high false positive and false negative rates; therefore, 
traditional attack methods cannot be used to directly divide 
attack sequences. 

For  this  reason,  the  idea  of  fuzzy  cluster  analysis  is 
adopted,  and  a  fuzzy  C-means  clustering  algorithm  that 
takes into account the characteristics of cyber attacks based 
on  the  characteristics  of  the  attacked  cyber  components  is 
proposed. 

Let  uik  represent  the  attack  activity  xi  belong  to  the 
membership  degree  of  alarm  event  sk;  0  ≤  uik  ≤  1,  and 

 .  The  objective  function  is  then  defined  as 

follows [28]. 

(1) 

where  U  =  (uik)i×n is  the  membership  degree  matrix,  m  is 
the number of clusters, dik = ||xk - vi||, and J(U,V) is the sum 
of  the  weighted  squared  distance  from  the  attack  activity 
to the cluster center in each alarm event. Additionally, the 
weight  of  attack  activity  xk belongs  to  the  m-th  power  of 
the  membership  degree  of  the  type  i-th  attack  event.  The 
clustering  criterion  of  the  algorithm  is  to  calculate  U and 
V to make J(U, V) have the minimum value, and indicates 
that  related  attacks  xk  have  similar  attack  characteristics 
and belong to the same type of attack. 

2) RECOGNITION OF CYBER ATTACK SEQUENCE 
Based  on  the  aggregate  calculation  of  network  attack 
alarm  events,  two  factors  must  be  considered  to  identify 
the CAS belonging to the same attacker. First, due to noise 
interference  and  the  failure  of  the  attacked  component 
itself, false alarms and the phenomenon of underreporting 
are  difficult  to  avoid.  Second,  the  causal  relationship 
between  the  attack  sequence  and  the  alarm  event  usually 
has  a  certain  timeliness  and  time  uncertainty.  The  CAS 
should  be  formed  within  a  certain  period  of  time  after 
different  alarm  events,  but  it  is  difficult  to  accurately 
determine a clear time interval. 

This  paper  proposes  a  method  based  on  the  temporal 
causal  Bayesian  network  to  identify  CASs  of  the  same 
cyber  attack  sequence.  As  presented  in  Fig.  3,  the  CAS 
recognition  method  is  a  two-layer directed  acyclic graph, 
the root node of which represents the alarm event, and the 
leaf node of which represents the cyber attack sequence. It 
can  be  described  by  a  quadruple  G={S,CAS',E,K},  where 
S  represents  an  alarm  event  node  set,  CAS'  represents  a 
fuzzy subset of cyber attack sequences,  E is the edge set 
that  the cause  event node  points  to  the  result  event  node, 
E  indicates  that  alarm  events  Si  and  attack  result 
Eij
events 
have  a  causal  relationship,  and  K  represents 
the set of states that have causality. Any Kij K can be the 
state of the side switch. 

The specific steps of the method are as follows. 

FIGURE 3. Model of temporal causal Bayesian network cyber attack 
sequence. 

1  > sCE2 

root  nodes,  each 

Step1: When multiple alarm events s1, s2,...,sk can form the 
same  CAS,  i.e.,  when  the  attack  sequence  contains 
multiple 
root  node  event  can 
independently trigger the cyber attack. 
Step2:  After  performing  fuzzy  operations  on  all  the 
temporal-causal  relationships  of  the  CAS,  a  fuzzy  subset 
 2 > …> sCEm 
of the cyber attack sequence CAS' = [sCE1 
] 
can be obtained, in which different permutations of alarm 
events constitute different fuzzy subsets CAS'. 
Step3:  The  fuzzy  subset of  the  CAS  contains  all  possible 
combinations  of  the  alarm  events  forming  the  attack 
sequence.  As  shown  in  the  example  in  Fig.  3,  there  are 
three  kinds  of  CASs  that  may  attack  the  sequence  set: 
CAS'  =  {CAS'1,  CAS'2,  CAS'3},  where  CAS'1  =  (s- 
2 ), 
CAS'2 = (s+ 
Step4:  Probability  calculations  are  used  to  determine 
which  attack  sequence  CAS'i  has  the  greatest  credibility. 
For  any  attack  sequence  CAS'i CAS',  its  credibility  is 
calculated as follows. 

2), and CAS'3 = (s- 

1 ,  s+ 

1 , s- 

1, s- 

2). 

m

 (2)

 is  the  normalization  constant,  and  πi  is  the  si 
Where 
prior  probability  of  occurrence.  The  maximum  value  of 
Bel (CAS'j) indicates the alarm event combination [sCEi1 
, s
], which is an accurate sequence of actual CASj. 

,...,sCEim 

CEi2 
2

m

1

C. PAE RECOGNITION BASED ON COMBINED 
CRITERIA 

1) PHYSICAL FEATURE CRITERIA CONDITIONS 
The measurement data of the physical power grid contains 
many  attributes,  including  the  voltage,  current,  phase 
angle,  positive  sequence,  negative  sequence,  and  zero 
sequence.  Via  analysis,  it  is  found  that  under  different 
types  of  attacks,  there  are  obvious  differences  in  the 
characteristic  curves  of  these  measurement  data.  The 
features can be summarized as follows. 

Attack  type  1:  Data  injection  attack.  The  measured 
value  is  maliciously  modified  to  disguise  a  normal  fault, 
causing  the  operator  to  mistakenly  believe  that  a  short-
circuit  fault  occurred  and  to  issue  a  removal  instruction. 
Fig. 4 presents a recording of the time interval from 42 to 
92,  in  which  malicious  data  tampering  was  performed, 

VOLUME XX, 2020 

5 

This work is licensed under a Creative Commons Attribution 4.0 License. For more information, see https://creativecommons.org/licenses/by/4.0/.

11nikiu==211(,)ncmikikkiJUVud===jCASj::()(,)(1)+−===−iiiiiijississBelCASmaxCASSK 
 
                      
 
 
 
This article has been accepted for publication in a future issue of this journal, but has not been fully edited. Content may change prior to final publication. Citation information: DOI
10.1109/ACCESS.2020.2982057, IEEE Access

resulting in the phase differences between A-C three-phase 
voltages not being 120 degrees. 

Based  on  the  analyses  of  the  characteristic  curves  of 
these  three  types  of  attack  states,  the  physical  feature 
criteria  for  establishing  abnormal  conditions  according  to 
the operating characteristics of the physical power grid are 
listed in Table 1. 

TABLE 1. Physical feature criteria for abnormal conditions. 

FIGURE 4. Characteristic curve of voltage phase angle. 

Attack  type  2:  Command  injection  attack  of  remote 
switch. An attacker sends a malicious operation command 
to the relay, causing the circuit breaker position to change. 
Fig.  5  presents 
the  positive-negative-zero  sequence 
current  amplitude  changes  in  the  relay  after  the  attacker 
injected  a  malicious  disconnect  command  in  the  time 
intervals from 36 to 38 and from 153 to 158. 

FIGURE 5. Characteristic curve of positive-negative-zero sequence. 

Attack type 3: Relay setting parameter tampering attack. 
The  impedance  relay  main  function  is  to  measure  the 
distance  from  the  short-circuit  point  to  the  protection 
installation.  In  the  attack  state,  because  the  protection 
distance parameter is tampered with, the protection has no 
effect.  Fig.  6  displays  the  attacker  tampering  with  relay 
protection parameters in the  time intervals from 25 to 60, 
and  presents  the  change  in  impedance  angle  ZH  between 
the attack failure and the normal failure. 

FIGURE 6. Characteristic curve of the impedance phase angle. 

Physical feature criteria 

Abnormal 
number 

Abnormal 
feature 1 

Abnormal 
feature 2 

Abnormal 
feature 3 

In    Table  1,  φ(t),  U(t),  I(t),  and  z(t)  respectively 
represent  the  phase  angle,  voltage  amplitude,  current 
amplitude,  and  impedance  amplitude  measured  at  time  t,  
I_(t)  and  I0(t)  respectively  represent  negative  and  zero 
sequence  currents,  Δz  represents  the  rate  of  change  of 
impedance, and ε1, ε2, ε3, and ε4 denote the allowable error 
ranges [29]. 

2) RECOGNITION OF PHYSICAL ATTACK EVENTS 
To  accurately  identify  the  specific  attack  type  of  the 
abnormal state, three key indicators are defined according 
to  the  change  laws  of  the  measurement  characteristics 
under the attack. 

Indicator 1: Phase difference change rate of voltage or 
current.  Taking  a  fixed  interval  window  n,  to  reflect  the 
average deviation of the three-phase current or voltage. 

        (3) 

        (4) 

Indicator  2:  The  amplitude  fluctuation  rate  of  voltage 
or current reflects the fluctuation degree of the three-phase 
current or voltage at a certain moment. 

       (5) 

    (6) 

Indicator  3:  The  mutation  coefficient  of 

the 
negative/zero sequence. When the system fails or attacks, 
it  usually  breaks  down  the  current  negative  and  zero 
two 
sequence  amplitude.  Therefore,  detecting 

these 

VOLUME XX, 2020 

6 

This work is licensed under a Creative Commons Attribution 4.0 License. For more information, see https://creativecommons.org/licenses/by/4.0/.

123[,],(()())(()())(()())(()())(()())(()())00ABBCABBCABBCtttTttttorUtUtUtUtorItItItIt+−−−−−−−−−00[,],()0()00tttTItorIt−+004()-()[,],()101ztzttttTzzt+=C1(()()()())nABBuuuutUttttn=−−−=C1(()()()())nABBiiiitIttttn=−−−=max()3100%3ABCABCIABCIIIIIII++−=++max()3100%3ABCABCUABCUUUUUUU++−=++ 
 
 
 
 
 
 
 
 
 
 
 
This article has been accepted for publication in a future issue of this journal, but has not been fully edited. Content may change prior to final publication. Citation information: DOI
10.1109/ACCESS.2020.2982057, IEEE Access

variables that should not occur in the normal state can be 
used as a basis for judging whether the system is abnormal. 
,If  I0(t)  or  I-(t)  have  a 
 interval is more than 20% [30], 

Setting  the  window  length 

change in the adjacent 
it may be considered as an abnormal value. 

(7) 

table 

The above three indicators are merged, a physical attack 
event recognition algorithm based on RF, called PAR-RF, 
is  proposed  to  realize  the  classification  detection  of 
abnormal  measurement  data.  The  main  steps  of  the 
algorithm are as follows. 
Step1: The original physical grid measurement dataset W 
is  obtained  according  to  the  established  physical  feature 
criteria  condition 
to  perform  a  preliminary 
determination  of  the  normal  state  and  the  attack  state. 
Additionally,  a  candidate  attack  dataset  that  may  have 
attack events W' is generated. 
Step2:  Supposing  that  W'  contains  m  samples  and  each 
sample has X features, a random forest containing T decision 
trees must be trained, Bootstrap is used for sampling, and T 
training sets K of size n (n < m) are obtained from W'. 
Step3:  In  each  training  set  K,  the  phase  change  rates  of 
voltage and current ηU and ηI, the amplitude fluctuation rates 
of voltage and current δI and δU, and the mutation coefficient 
are calculated. Additionally, 
of the negative/zero sequence
the  feature  extraction  method  is  used  to  select  important 
features x' according to the feature importance value (x' < X), 
and combined with the three key indicators, namely (x', ηU, ηI, 
δI, δU, τ). 
Step4: CART is used to build a classification decision tree, 
and steps 2 and 3 are repeated to build T decision trees, i.e., 
T classifiers. Rules are then generated to determine the type 
of  attack.  Finally,  the  voting  results  of  the  T  classifiers  are 
used to determine the final attack PAE event category e 
i. 

D. AP EXTRACTION BASED ON TEMPORAL-
TOPOLOGICAL CORRELATION 
Based  on  the  captured  CAS  and  PAE,  the  temporal  and 
topological  relationships  between  the  physical  and  cyber 
components are used as correlated conditions. The frequent 
pattern  tree  (FP-Tree)  is  improved  via  the  time  scale  and 
topology,  and  a  coordinated  network  attack  sequential 
pattern  mining  algorithm  (NSPMA)  is  proposed.  By 
establishing  a  topology  frequent  pattern  tree  (TFP-Tree), 
the  coordinated  AP  of  the  electric  power  CPS  network  is 
mined. The steps of the NSPMA method are as follows. 
Step1: Cyber-physical attack sequential connection based on 
topology. According to the topological relationship O < CEs, 
PEs,  R  >,  the  CAS  set  {CAS1,  CAS2,…,CASm}  and  the  PAE 

VOLUME XX, 2020 

set  {PAE1,  PAE2,…,PAEn}  are  traversed,  and  if  there  is  a 
connection relationship, operation CASi∪PAEj is performed. 
Step2:  The  complete  attack  sequence  for  each  attacker  is 
obtained based on a new dynamic time window. The cyber-
physical attack sequence is sorted according to the attacker’s 
AID as the primary key and the timestamp as the secondary 
key. To avoid dividing the sequence of the same attacker into 
different sequences, the dynamic time window winterval in the 
attack  scene  is  designed.  The  attack  sequence  is  then 
segmented  to  obtain  the  complete  attack  sequence  database 
(AD) for all attackers. 

For CASi (which occurs at [ti, ti+n]) and PAEj (which occurs 
at [tj, tj+n]), the attack interval is Δt = |tj—ti+n|. In the relevant 
 > 240 seconds, after the attack step 
literature [31], when 
interval exceeds 240 seconds, the attack result will be invalid, 
even without any threat. The maximum upper limit of winterval 
is  set  to  240  seconds.  When 
<  240  seconds,  winterval  is 
dynamically  calculated  and  determined  according  to  the 
average time interval of each type of attack sequence. 

              (8)

where tk represents a time interval in which a certain type of 
attack  sequence  CASi  =>  PAEj  may  occur  among  different 
attackers,  and  ni  represents  a  cumulative  number  of 
occurrences  of  the  CASi  =>  PAEj  sequence  in  each  tk 
interval. 
Step3:  Construct  attack  sequence  TFP-Tree.  By  setting  the 
threshold 
 for attack pattern support, the AD is scanned to 
count each of the attack items, and the CE or PE component 
number is recorded simultaneously. Only the frequent attack 
items greater than 
 are retained, and the support items are 
sorted  in  descending  order.  Then,  by  scanning  the  attack 
sequence  of  each  attacker  in  the  AD,  the  sorted  frequent 
items  in  each  attack  sequence  are  obtained,  and  the  attack 
sequence TFP-Tree is established, as shown in Fig. 7. 

    (9) 

Step4:  The  TFP-Tree  is  mined  to  find  extremely  frequent 
sequences  and  generate  APs.  Each  item  in  the  header  of 
table  is  traversed  in  turn,  all  existing  attack  paths  are 
extracted  according  to  the  node  list,  and  the  subschema 
base is calculated to build a conditional FP tree. Finally, all 
APs are obtained according to the set attack sequence mode 
confidence

 threshold. 

(10) 

7 

This work is licensed under a Creative Commons Attribution 4.0 License. For more information, see https://creativecommons.org/licenses/by/4.0/.

tt0000000001()()0.2()=()()0.20()()0.2orororororororororItIttIttandtIttItItIttItIt−−−−−−−−−−−+−+−， （-）（）， （）tt11240,240seconds*t,240secondslikintervaliliitnwtn===121niNumber of attackers on [S>S...S=>e] Total number of attackers−=121121[...][...]ninNumber of attacks on antecedent SSSconsequent eNumber of antecedent attacks SSS−−= 
 
 
 
 
 
This article has been accepted for publication in a future issue of this journal, but has not been fully edited. Content may change prior to final publication. Citation information: DOI
10.1109/ACCESS.2020.2982057, IEEE Access

A total of 28,901 alarm data was generated in the deployed 
snort,  syslog  servers,  routers,  and  switches.  A  fuzzy  C-
means  clustering  algorithm  that  takes  into  account  cyber 
attack  characteristics  was  verified  to  aggregate  network 
attack events. In the experiment, the attackers were divided 
by IP address. Membership degree was calculated based on 
the continuous variables such as timestamp, and sig_name, 
and the alarm events to which attack activities belong were 
determined by the values. There were 12,360 alarm events 
after  calculation,  and  the  results  are  presented  in  Fig.  9, 
which  displays  the  changes  in  the  numbers  of  the  top  8 
cyber alarm events before and after aggregation.  

FIGURE 9. Comparison of the numbers of original alarms and 
aggregated alarms. 

The events were numbered from s1 to s8, and the specific 

event information is presented in Table 2. 

TABLE 2. Meanings of some cyber alarm events. 

Serial 

number 

Attack type 

Description 

s1 

s2 

s3 

s4 

s5 

s6 

s7 

s8 

sshd buffer 
overflow 

ftp_rhosts 

rsh login 

local buffer 
overflow 

Remotely obtain root permissions on 
the target host. 

Gain the trust of the target host. 
Get user permissions on the target 
host. 

Get root privileges on localhost. 

sadmind_ping 

Search for active hosts to target 
attacks. 

RDP Inception 

Rookit 

Landmodule 

Wait for the intranet administrator to 
initiate an RDP connection request and 
repeatedly obtain the management 
control shell of all devices. 
Install on the target component and 
hide to realize the functions of hiding 
and manipulating and collecting data. 
Send spoofed data packets to disable 
target devices without corresponding 
protection mechanisms. 

8 

FIGURE 7. TFP-Tree example. 

IV. EXPERIMENT AND ANALYSIS 
The testbed of Mississippi State  University  was utilized to 
analyze  and  verify  the  proposed  method  of  coordinated 
network  attack  pattern  extraction  [32].  The  experimental 
connection  topology  is  illustrated  in  Fig.  8.  The  physical 
grid  system  contains  the  following  components:  2  power 
generators G1 and G2, 4 intelligent electronic devices (IED) 
R1  through  R4,  they  can  switch  the  breakers  on  or  off.  4 
circuit breakers BR1 to BR4. R1 controls BR1, R2 controls 
BR2  and  son  on  accordingly.  2  grid  lines  L1  and  L2;  the 
components  are  numbered  from  PE1  to  PE12.  The  cyber 
system contains the following components: a router, switch, 
snort,  syslog  server,  open  PDC,  computer 
terminal, 
software  system,  etc.  The  components  are  numbered  from 
CE1 to CE9. 

FIGURE 8. Testbed topology. 

A. VALIDATION AND ANALYSIS OF CAS 
RECOGNITION 

VOLUME XX, 2020 

This work is licensed under a Creative Commons Attribution 4.0 License. For more information, see https://creativecommons.org/licenses/by/4.0/.

CAS1CAS2CAS3PAE1PAE2ROOTCAS1:7CE1,CE4,CE6,...CAS2:2CE5,...CAS3:2CE2,...CAS2:4CE8,CE9,...PAE1:1PE2CAS3:2CE3,CE6PAE2:1PE1PAE1:1PE4CAS3:2CE7,CE2,...PAE2:1PE8TIDSupportcount76622Node chain.........G1（PE7）R2R3R4R5G2（PE8）Control RoomControl RoomR1（PE9）PDC（CE9）Terminal（CE1）Software backdoor（CE2）Substation switch（CE3）Router（CE4）Snort（CE5）Syslog（CE6）Control panel（CE7）OpenPDC（CE8）BR1（PE1）BR2（PE2）BR3（PE3）BR4（PE4）Line1（PE5）Line2（PE6）R2（PE10）R3（PE11）R4（PE12）4318321924351456143412451230118928172180198312981070590897460sshd buffer overflowftp_rhostsrsh loginlocal buffer overflowSadmind_pingRDPInceptionrookitlandmodule010002000300040005000Number of alarmsAlarm event type Alarm before aggregation Alarm after aggregation 
 
 
 
 
 
 
This article has been accepted for publication in a future issue of this journal, but has not been fully edited. Content may change prior to final publication. Citation information: DOI
10.1109/ACCESS.2020.2982057, IEEE Access

contrary,  the  intelligent  planning  method  pre-defines  the 
prerequisites and consequences of the attack steps, and  the 
alarm correlation method uses the time window to segment 
the  alarm  sequence  in  sections,  the  randomness  and 
uncertainty of the attack sequence events are ignored. 

Based on this clustering data, a temporal causal Bayesian 
network  model  was  used  to  identify  the  attack  sequences 
belonging  to  the  same  attacker,  and  a  total  of  420  cyber 
attack  sequences  was  obtained.  Based  on  the  maximum 
confidence  probability  calculation,  a  total  of  138  actual 
attack  activity  sequences  was  identified.  Due  to  space 
limitations,  only  the  top  10  cyber  attack  sequences  with 
high credibility are listed, as presented in Table 3.

TABLE  3. Top 10 cyber attack sequences with high credibility. 

Serial number 

Cyber attack sequence set 

Reliability 

CAS1 

CAS2 

CAS3 

CAS4 

CAS5 

CAS6 

CAS7 

CAS8 

CAS9 

CAS10 

5  > sCE3 
sCE1 

6  > sCE2 

1

7  > sCE3 
sCE1 

5  > sCE2 

4

7  > sCE4 
sCE7 

2  > sCE3 

4

6  > sCE4 
sCE5 

3  > sCE3 

4

5  > sCE4 
sCE7 

7  > sCE3 

3

8  > sCE7 
sCE8 

7  > sCE4 

2  > sCE3 

4

6  > sCE6 
sCE1 

8  > sCE4 

2  > s4 

7  > sCE4 
sCE5 

5  > sCE3 

8  > sCE2 

4

6  > sCE4 
sCE1 

5  > sCE6 

8  > sCE5 

2  > sCE3 

4

8  > sCE7 
sCE6 

5  > sCE4 

6  > sCE3 

2  > sCE2 

4

98.4% 

97.6% 

85.4% 

94.3% 

91.8% 

82.5% 

81.7% 

80.6% 

77.1% 

76.6% 

(a) Number of recognized attack sequences 

As is evident from Table 3, the maximum credibility of a 
3-step  attack  was  98.4%,  the  maximum  credibility  of  a  4-
step attack was 82.5%, and the maximum credibility of a 5-
step attack was 77.1%. As the length of the identified cyber 
the  credibility  decreased 
attack  sequence 
significantly. This is because when the length of the attack 
sequence  increases,  the  attacker's  intention  to  attack  is 
uncertain. Various tentative attacks will affect the accuracy 
of the identification rate. 

increased, 

The cyber attack sequence recognition method proposed 
in  this  paper  and  other  methods  proposed  in  previous 
research [33] are aimed at the mining of network alarm logs 
of multi-step cyber attack sequences. Thus, to further verify 
the  effectiveness  of  the  method  proposed  in  this  paper,  an 
experimental comparison with related methods was carried 
out.  The  aggregated  12,360  alarm  event  data  were  used  in 
the experiment, and were divided into 10 groups of test data 
sets. The experimental results are presented in Fig. 10. 

The  experimental  results  demonstrate  that  the  proposed 
method exhibited obvious advantages in both the number of 
the  accuracy  of 
sequences  and 
recognized  attack 
recognition.  This 
the  proposed  method 
is  because 
establishes an optimization objective function to  determine 
the  membership  of  each  sample  point  to  all  class  centers, 
thereby effectively reducing the number of redundant types 
of  alarm  information  and  making  up  for  the  shortcomings 
of  the  other  algorithms,  which  only  cluster  by  the  time 
attribute or attack type. It is therefore more in line with the 
actual situation of multi-step attack implementation. On the 

(b) Recognition accuracy 

FIGURE 10. Performance comparison of the proposed method, 
intelligent planning method, and alarm correlation method. 

B. VALIDATION AND ANALYSIS OF PAE RECOGNITION 
The  physical  grid  data  set  was  collected  by  4  PMUs,  and 
includes 28 types of attack scenarios and 9 types of normal, 
short-circuit, and maintenance scenarios. The numbers and 
event descriptions of all 37 scenarios are listed in Table 4.  

TABLE 4. Physical attack event descriptions. 

Event number 

Description 

e41 

Normal 

e1-e6 

short-circuit fault from 10-19%, 20-79%, 80-

90% on L1 or L2 

e13, e14 

Line1 or Line2 maintenance 

VOLUME XX, 2020 

9 

This work is licensed under a Creative Commons Attribution 4.0 License. For more information, see https://creativecommons.org/licenses/by/4.0/.

12345678910020406080100120140Number of recognition attack sequencesNumber of test data set Proposed method Intelligent planning method Alarm correlation method123456789107880828486889092949698Recognition accuracy（%）Number of test data set Proposed method Intelligent planning method Alarm correlation method 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This article has been accepted for publication in a future issue of this journal, but has not been fully edited. Content may change prior to final publication. Citation information: DOI
10.1109/ACCESS.2020.2982057, IEEE Access

(R4-PM6:I <= 377.38971) and  
(R1-PM5:I > 357.98005) and 
 (R1-PA6:IH > 49.841599) and 
 (R2-PM5:I <= 510.32757) 
(R4-PM2:V > 131127.0625) and  
(R2-PM3:V <= 130431.1505) and 
 (R2-PM4:I <= 485.115051) and  
(R4-PA3:VH <= -13.81387799) 
(R2-PA2:VH <= -156.864385) and 
 (R4-PM5:I > 380.8688) and 
 (R3-PA2:VH <= -34.61811) and 
 (R3-PA5:IH > -125.02512) 
(R3-PM5:I <= 424.99831) and  
(R2-PA2:VH > -156.864385) and 
 (R2-PM5:I > 362.709045) and 
 (R2-PA3:VH > 48.8561) 

24 

12 

36 

13 

0.962 

0.957 

0.951 

0.948 

According  to  the  classification  rules,  the  accuracy 
analysis experiment of physical attack type recognition was 
performed.  The  experiment  was  performed  using  PAR-RF 
and  the  original  RF  on  the  test  data  set.  The  size  of  the 
initial random forest scale was 20. To ensure the stability of 
the  experimental  results,  the  experiment  was  repeated  20 
times  on  each  data  set.  The  recognition  capabilities  of  the 
two methods are presented in Fig. 11. 

e15-e20 

remote command injection attack on R1 to R4 

e21-e30, e35-e40 

relay setting change attack from 10-19%, 20-

90%, 10-49%, 50-79% on R1 to R4 

e7-e12 

measuring data injection attacks from 10-19%, 

20-79%, 80-90% on L1 or L2 

The  data  set  contains  128  features  with  a  total  of  about 
70,000 pieces of data, and is divided into 15 sub-data sets. 
The  features  are  explained  in  the  Table  5.  There  are  29 
types  of  measurements  from  each  PMU,  so  the  4  PMUs 
have 116 measurement columns. There are 12 columns for 
control  panel  logs,  snort  alerts  and  relay  logs.  The  last 
column is the marker. 

TABLE 5. Data set features descriptions. 

Feature 

Description 

PA1:VH – PA3:VH  Phase A - C Voltage Phase Angle 

PM1: V – PM3: V  Phase A - C Voltage Phase Magnitude 

PA4:IH – PA6:IH  Phase A - C Current Phase Angle 

PM4: I – PM6: I 

Phase A - C Current Phase Magnitude 

PA7:VH – PA9:VH  Pos. – Neg. – Zero Voltage Phase Angle 

PM7: V – PM9: V  Pos. – Neg. – Zero Voltage Phase Magnitude 

PA10:VH - PA12:VH  Pos. – Neg. – Zero Current Phase Angle 

PM10: V - PM12: V  Pos. – Neg. – Zero Current Phase Magnitude 

F 

DF 

Frequency for relays 

Frequency Delta (dF/dt) for relays 

PA:Z 

Appearance Impedance for relays 

PA:ZH 

Appearance Impedance Angle for relays 

S 

Status Flag for relays 

The  physical  attack  event  recognition  method  was 
verified, and an initial random forest with a size of 100 was 
then  constructed.  The  decision  rules  were  generated  from 
the  training  data  set,  and  the  top  5  rules  for  accuracy  are 
listed in the Table 6. The index of each rules is in the form 
of  “ R#-Signal  Reference ”   that  indicates  a  type  of 
measurement  from  a  PMU  specified  by  “ R# ” .  For 
example,  R3-PM7:V  means  Pos  voltage  phase  magnitude 
measured by PMU R3. 

TABLE 6. Top 5 decision rules for accuracy. 

Decision rule 

(R3-PM7:V <= 130130.2713) and  
(R2-PM6:I <= 383.337036) and 
 (R2-PA3:VH > 48.856111) and 
 (R2-PM5:I <= 486.88949) 

Most frequent 

category 

Rule accuracy 

24 

0.978 

FIGURE 11. Comparison of classification accuracy under forests of 
different scales. 

The  experimental  results  reveal  that  PAR-RF  exhibited 
better  overall  classification  accuracy  than  RF  due  to  the 
addition  of  the  key  indicators  for  classification  feature 
selection.  The  best  classification  accuracy  was  97.9%,  and 
the forest size was 88. 

Additionally, a test data set was randomly selected from 
15  sample  data  sets.  It  contained  a  total  of  5,069  samples, 
of which 4887  test classifications were correct,  accounting 
for  96.41%,  and  182  were  misclassified,  accounting  for 
3.59%. The classification of 37 scenarios was analyzed via 
the confusion matrix performance, as  presented in Fig. 12. 
The main diagonals of the matrix were classified correctly, 
the others were misclassified. 

The  accuracy  and  false  positive  rates  of  the  37  attack 
scenarios were calculated according to the confusion matrix, 
as presented in Fig. 13. 

VOLUME XX, 2020 

10 

This work is licensed under a Creative Commons Attribution 4.0 License. For more information, see https://creativecommons.org/licenses/by/4.0/.

2025303540455055606570758085909510092939495969798Recognition accuracy (%)Number of trees RF PAR-RF 
 
 
 
 
 
 
 
This article has been accepted for publication in a future issue of this journal, but has not been fully edited. Content may change prior to final publication. Citation information: DOI
10.1109/ACCESS.2020.2982057, IEEE Access

accuracy  rates  were  e20,  e11,  and  e16;  the  respective 
recognition  accuracy  rates  were  100%,  99.06%,  and 
99.03%, and the respective false detection rates were 0.03%, 
0.02%,  and  0.04%.  The  top  three  misdetection  rates  for 
attack  scenarios  were  e1,  e7,  and  e21;  the  respective 
misdetection rates were 0.11%, 0.09%, and 0.08%, and the 
respective accuracy rates were 95.6%, 92%, and 97.8%. 

The  causes  of  error  are  analyzed.  e1  is  a  normal  short-
circuit  fault  of  Line1  at  10%-19%  of  the  position,  and  the 
attack events  e7 and  e21 were tampering via  malicious data 
injection  or  relay  R1  parameter  settings,  resulting  in  a 
positive sequence of Line1 short-circuit fault at  10%-19%. 
Additionally,  the  negative/zero  sequence  amplitude  and 
phase angle change were similar, which could easily cause 
confusion in recognition. 

FIGURE 13. Accuracy and false detection rate of 37 scene recognitions. 

The  experimental  results  demonstrate  that  the  proposed 
method  has  a  better  recognition  effect  on  single  or 
combined relay remote command injection attacks and data 
injection  attacks.  The  top  three  attack  scene  recognition 

FIGURE 12. Confusion matrix for the recognition of 37 scenarios. 

C. VALIDATION AND ANALYSIS OF ATTACK PATTERN 
EXTRACTION 
CASs  and  PAEs  were  recognized  based  on  the  reported 
experiments.  The  NSPMA  algorithm  was  used  to  mine 
a  TFP-Tree, 
frequent 
establishing 
 from  which  the  sequential  pattern  of  the 

sets  by 

item 

coordinated network attack was extracted. 

Via  experimental  verification,  a  total  of  461  complete 
attack paths were obtained, and 22 frequent  attack patterns 
were  mined.  The  results  are  sorted  in  descending  order 
according  to  the  number  of  sequences  that  occur  in  each 
pattern, as shown in the Fig .14.  This proved that frequent 
attack patterns account for only a small percentage. 

FIGURE14.   Descending  statistics  of  sequence  number  in  attack 
pattern 

A 

total  of  6  frequent  coordinated  network  attack 

VOLUME XX, 2020 

11 

This work is licensed under a Creative Commons Attribution 4.0 License. For more information, see https://creativecommons.org/licenses/by/4.0/.

=30=30，；123456789101112131415161718192021220102030405060708090100Number of occurance sequencesAttack Pattern serial number 
 
 
 
 
 
 
 
 
This article has been accepted for publication in a future issue of this journal, but has not been fully edited. Content may change prior to final publication. Citation information: DOI
10.1109/ACCESS.2020.2982057, IEEE Access

5 >s CE3 

1 =>e PE2 

sequential  patterns  with  a  confidence  level  of  greater  than 
90%  were  found,  as  shown  in  Table  7.  For  example,  the 
pattern  [s CE4 
]  indicates  that  when  the  cyber 
component  CE4  is  attacked  by  a  Sadmind  Ping  (s 
5),  and 
then  CE3  is  attacked  by  an  sshd  buffer  overflow  (s 
1),  the 
physical  component  PE2  suffers  a  relay  setting  change  
attack (e 

21) with a confidence of 93.1%, support of 97.5%. 

21

TABLE 7. Coordinated network attack pattern with top 6 confidence. 

Serial 

Coordinated network attack 

number 

pattern  

Confidence 

Support 

1 

2 

3 

4 

5 

6 

16 ] 

[sCE1 
[sCE4 
[sCE7 
[sCE6 
[sCE4 
[sCE4 

5 >sCE3 
5 >sCE3 
7 >sCE4 
6 >sCE4 
6 >sCE3 
3 >sCE3 

6 > sCE2 
1 =>ePE2 
5 > sCE3 
8 > sCE3 
2 =>ePE9 
4 =>ePE3 

3 =>ePE2 
21 ] 
3 =>ePE11 
4 =>ePE1 
17 ] 
27 ] 
] 

7

9

] 

94.1% 

93.1% 

92.6% 

91.3% 

91.6% 

90.5% 

98.6% 

97.5% 

93.5% 

92.7% 

94.6% 

95.4% 

By summarizing the results of these attack patterns, three 
typical  network  cooperative  attack  patterns  can  be 
determined. 

1)  The  data  injection  attack  patterns  mainly  focus  on 
network  monitoring,  packet  read  and  write  (such  as  the 
Netcat tool) attack events, and  the  injection of maliciously 
tampered-with data to affect the dispatcher's decision, such 
7 >sCE4 
as the following pattern: [sCE7 
2)  The  command  injection  attack  pattern  mainly  uses 
password  brute  force  cracking  and  privilege  elevation 
attacks. After gaining  the  root privileges of the dispatcher, 
malicious  load  shedding  attacks  on  the  physical  grid  are 
performed,  such  as  the  following  pattern:  [sCE6 
8 >sCE3 
=>ePE1 

3 =>ePE11 

6 >sCE4 

5 >sCE3 

17 ]. 

]. 

7

4

3)  The  attack  pattern  of  tampering  with  relay  setting 
mainly targets router or switch security vulnerabilities. The 
relay  device  is  invaded  through  a  network  connection  to 
maliciously  modify  the  protection  distance  parameter, 
which  causes  the  relay  to  refuse  to  operate  when  a  fault 
occurs, such as the following pattern: [sCE4 

2 =>ePE9 

6 >sCE3 

27 ]. 

To  fully  verify  the  efficiency  of  the  NSPMA  algorithm 
proposed  in  this  paper,  four  representative  sequential 
pattern mining algorithms, namely Prefix Span, Free Span, 
GSP, and Spade, were selected for comparison experiments. 
Under  the  same  conditions,  according  to  the  different 
support levels set, each algorithm was independently run 20 
times,  and  the  average  running  time  was  taken  as  the 
calculation  result.  The  time  efficiency  comparison  of  the 
four algorithms is presented in Fig. 15. 

FIGURE 15.  Algorithm running times with different support thresholds. 

increases, 

The  results  demonstrate  that  with  the  increase  of  the 
support  threshold,  the  running  time  of  each  algorithm  will 
decrease  rapidly.  The  reason  for  this  is  that  as  the  support 
the  number  of  frequent  pattern 
threshold 
sequences  that  meet  the  threshold  will  decrease,  and  the 
running  time  will  also  decrease.  In  terms  of  running  time, 
NSPMA  was  found  to  be  superior  to  the  other  algorithms. 
This  is  because  the  connection  topology  of  components  is 
considered in the frequent item set comparison process, i.e., 
item  sets  that  have  no  relationship  will  be  directly  pruned 
without  the  need  for  connection  operations;  this  avoid  a 
large  number  of  useless  candidate  sequence  item  sets, 
thereby  effectively  improving  the  efficiency  of  pattern 
mining. 

VI. CONCLUSION AND FUTURE WORK 
This paper proposes a new method for the automatic mining 
of  attack  patterns  from  measurement  data  and  information 
alarm  logs  based  on  the  characteristics  of  coordinated 
network  attacks  that  occur  in  physical  space  and  cyber 
space, and the temporal and topological correlation between 
each  attack  step.  The  proposed  method  can  restore  the 
complete  attack  path  of  the  attacker  and  identify  the  key 
cyber  and  physical  components  that  are  vulnerable  in  the 
electric  power  CPS  network.  This  method  proposes  the 
concept  of  coordinated  network  attack  modes  and  uses 
corresponding  algorithms 
for  physical  attack  event 
identification,  cyber  attack  sequence  identification,  and 
multi-step frequent attack mode extraction. 

This  paper  comprehensively  considered 

the  attack 
process  of  both  cyber  and  physical  space.  Moreover,  the 
proposed  method  does  not  rely  on  various  complicated 
association rules that are set manually, and does not require 
a  large  amount  of  prior  knowledge  to  achieve  good 
practical results.  In complex electric power CPS networks, 
the  attack  patterns  discovered 
in  different  network 
cooperative  attack  sequences  may  be  local.  Therefore, 
future  research  will  focus  on  the  investigation  of  attack 
pattern fusion methods in large-scale topologies. 

REFERENCES 

VOLUME XX, 2020 

12 

This work is licensed under a Creative Commons Attribution 4.0 License. For more information, see https://creativecommons.org/licenses/by/4.0/.

102030405060708090050100150200250300350400450500550600650700NSPMA (S)MinSupport (%) NSPMA AprioriAll PrefixSpan GSP 
 
 
 
 
 
This article has been accepted for publication in a future issue of this journal, but has not been fully edited. Content may change prior to final publication. Citation information: DOI
10.1109/ACCESS.2020.2982057, IEEE Access

[1]  Lai R, Qiu X, Wu J. “Robustness of Asymmetric Cyber-Physical Po
wer Systems Against Cyber Attacks,” IEEE Access, vol.7, pp. 6134
2-61352,2019. 

[2]  Qu Zhaoyang, Zhang Y, Qu N, et al. “Method for Quantitative Esti
mation of the Risk Propagation Threshold in Electric Electric power
 CPS Based on Seepage Probability,” IEEE Access, vol. 6, pp. 6881
3-68823,2018. 

[3]  Trang, Van, Bay Vo, Bac Le, “Mining sequential patterns with item 
set constraints,” Knowledge and Information Systems, vol. 57, No. 2, 
pp. 311-330,2018. 
Sun,  Chih  Che  ,  J.  Hong  ,  and  C.  C.  Liu  .  "A  coordinated  cyber 
attack  detection  system  (CCADS)  for  multiple  substations."  2016 
Power Systems Computation Conference (PSCC) IEEE, pp.114-129, 
2016. 

[4] 

[5]  Li Y, Li Z, Chen L. Dynamic State Estimation of Generators Under 

Cyber Attacks. IEEE Access, vol. 7, pp. 125253-67, 2019. 

[6]  Gan  W,  Lin  J  C  W,  Fournier-Viger  P,  et  al.  “A  survey  of  parallel 
sequential  pattern  mining”  arXiv  preprint  arXiv:  vol.  1805, 
pp.10515,2018. 

[7]  Gan  W,  Lin  J C  W,  Fournier-Viger P,  et al. “A  Survey  of  Parallel 
Sequential  Pattern  Mining,”  ACM  Transactions  on  Knowledge 
Discovery from Data (TKDD), vol. 13, No. 3, pp. 25,2019. 

[8]  Mei  S,  He  F,  Zhang  X,  et  al,  “An  Improved  OPA  Model  and 
Blackout Risk Assessment,” IEEE Transactions on Power Systems, 
vol. 24, No. 2, pp. 814-823,2009. 

[9]  Tang, J., Yin, X., Wen, M., & Zhang, Z., “Fault location in neutral 
non-effectively  grounded  distribution  systems  using  phase  current 
and  line-to-line  voltage,”  Electr.  Power  Comp.  and  Syst.,  Vlo.  42, 
13, pp. 1371-1385, 2014. 

[10]  Wang,  Jia,  Li,  Hongguang,  Huang,  Jingwen.  “Association  rules 
mining based analysis of consequential alarm sequences in chemical 
processes,”  Journal  of  Loss  Prevention  in  the  Process  Industries, 
Vol. 41, No. 21, pp.178-185, Mar. 2016. 

[11]  Xu, Shengzhi, Su, Sen, Cheng, Xiang，et al. “Differentially Private 
Frequent  Sequence  Mining,”  IEEE  Transactions  on  Knowledge  & 
Data Engineering, Vol. 28, No. 11, pp.2910-2926, NOV. 2016. 
[12]  Rios M A, Kirschen D S, Jayaweera D, et al. “Value of Security: M
odeling Time-Dependent Phenomena and Weather Conditions,” IEE
E Transactions on Power Systems, vol. 17, No. 7, pp. 53-53,2002. 

[13]  Wang A, Luo Y, Tu G, et al. “Vulnerability Assessment Scheme for
 Power System Transmission Networks Based on the Fault Chain Th
eory,” IEEE Transactions on Power Systems, vol. 26, No. 1, pp. 442
-450,2010. 

[14]  Zhu B, Ghorbani A A. “Alert correlation for extracting attack strate
gies,” IJ Network Security, vol. 3, No. 3, pp. 244-258,2006. 
[15]  Wang L, Ghorbani A, Li Y. “Automatic multi-step attack pattern dis
covering,” International Journal of Network Security, vol. 10, No. 2,
 pp. 144-152,2010. 

[16]  Qu Z, Qu N, Liu Y, et al. “Multi-objective optimization model of el
ectricity behavior considering the combination of household applian
ce correlation and comfort,” Journal of Electric Engineering & Tech
nology, vol. 13, No. 5, pp. 1821-1830,2018. 

[17]  Hong,  Sheng,  Wang,  Baoqing,  et  al.  “Failure  cascade 

in 
interdependent  network  with  traffic  loads,”  Journal  of  Physics  A: 
Mathematical and Theoretical, 48: 485101, 2015. 

[18]  Wang Lei, Qu Zhaoyang, Li Z. “The design and implementation of 
attack path extraction model in power cyber physical system,” Journ
al of Communications, vol. 11, No. 9, pp. 834-840,2016. 

[19]  Cao J, Fang Z, Qu G, et al. “An accurate traffic classification model 
based on support vector machines,” International Journal of Networ
k Management, vol. 27, No. 1, pp. e1962,2017. 

[20]  Sridhar S, Hahn A, Govindarasu M. “Cyber–physical system securit
y for the electric power grid,” Proceedings of the IEEE, vol. 100, N
o. 1, pp. 210-224,2011. 

[21]  Ozay M, Esnaola I, Vural F T Y, et al. “Machine learning methods f
or attack detection in the smart grid,” IEEE transactions on neural n
etworks and learning systems, vol. 27, No. 8, pp. 1773-1786,2015. 

[22]  Li S, Yılmaz Y, Wang X. “Quickest detection of false data injection
 attack in wide-area smart grids,” IEEE Transactions on Smart Grid,
 vol. 6, No. 6, pp. 2725-2735,2014. 

[23]  He H, Yan J. “Cyber-physical attacks and defences in the smart grid:
 a survey,” IET Cyber-Physical Systems: Theory & Applications, vol.
 1, No. 1, pp. 13-27,2016. 

[24]  Ding D, Han Q L, Xiang Y, et al. “A survey on security control and 
attack detection for industrial cyber-physical systems,” Neurocompu
ting, vol. 275, pp. 1674-1683,2018. 

[25]  Xiang Y, Wang L, Liu N. “Coordinated attacks on electric power sy
stems in a cyber-physical environment,” Electric Power Systems Re
search, vol. 149, pp. 156-168,2017. 

[26]  Lai K, Illindala M, Subramaniam K. “A tri-level optimization model
 to mitigate coordinated attacks on electric power systems in a cyber
-physical environment,” Applied Energy, vol. 235, pp. 204-218,201
9.  

[27]  Zhao J, Zhang G, La Scala M, et al. “Short-Term State Forecasting-
Aided Method for Detection of Smart Grid General False Data Injec
tion Attacks,” IEEE Transactions on Smart Grid, vol. 6, No. 10, pp. 
11p,2015. 

[28]  Y. Li, J. Wang, D. Zhao, G. Li, and C. Chen, “A two-stage approach
 for combined heat and power economic emission dispatch: Combin
ing multi-objective optimization with integrated decision making,”E
nergy, vol. 162, pp. 237–254, Nov. 2018. 

[29]  Zhao J, Wen F, Xue Y, et al. Cyber physical power systems: archite
cture, implementation techniques and challenges. Automation of Ele
ctric Power Systems, vol. 34, No. 16, pp. 1-7,2010. 

[30]  Li Z, Shahidehpour M, Alabdulwahab A, et al. “Analyzing locally c
oordinated cyber-physical attacks for undetectable line outages,” IE
EE Transactions on Smart Grid, vol. 9, No. 1, pp. 35-47,2016. 
[31]  Li Z, Shahidehpour M, Alabdulwahab A, et al. “Bilevel model for a
nalyzing coordinated cyber-physical attacks on power systems” IEE
E Transactions on Smart Grid, vol. 7, No. 5, pp. 2260-2272,2015. 

[32]  Chen L, Yue D, Dou C, et al. “Robustness of cyber-physical power 
systems in cascading failure: Survival of interdependent clusters” In
ternational Journal of Electric Power & Energy Systems, vol. 114, p
p. 105374,2020. 

[33]  Shengyi Pan, Thomas Morris. A Specification-based Intrusion Dete
ction Framework for Cyber-physical Environment in Electric Power
 System. International Journal of Network Security, vol.17, No. 2, p
p. 174-188, Mar. 2015. 

LEI  WANG  was  born  in  Jilin,  China.  He  is 
pursing his Doctor's degree of electric engineering 
in  Northeast  Electric  Power  University  .  He is an 
Associate  professor  at  the  School  of  Information 
Engineering.  His  research 
is  Cyber-
physical system attack and identification in Smart 
grid.  He  won  the  first  prize  of  scientific  and 
technological progress in Jilin Province in 2019 . 

interest 

ZHAOYANG  QU received his Ph.D degree in 
electric  engineering  from  China  Northeast 
Electric Power University in 2006 and 2010,and 
his  M.S  degree 
in  Dalian  University  of 
Technology in 1984 and 1988. He is currently a 
professor  and  doctoral  tutor  in  the  School  of 
Information  Engineering  of  Northeast  Electric 
Power  University.  His  interests  include  smart 
grid  and  power  information  processing,  virtual 
reality and network technology. 

He  is  a  member  of  the  China  Electric 
Engineering  Society  Power  Information  Committee, the vice  president  of 
the Jilin Province Image and Graphics Society, the head of the Power Big 
Data Intelligent Processing Engineering Technology Research Center, and 
the  Jilin  Governor  Baish  an  Scholar.  He  is  also  a  top-notch  innovative 
talent  in  Jilin  Province  and  a  young  and  middle-aged  professional  and 

VOLUME XX, 2020 

13 

This work is licensed under a Creative Commons Attribution 4.0 License. For more information, see https://creativecommons.org/licenses/by/4.0/.

 
 
 
 
 
 
 
 
 
 
 
 
This article has been accepted for publication in a future issue of this journal, but has not been fully edited. Content may change prior to final publication. Citation information: DOI
10.1109/ACCESS.2020.2982057, IEEE Access

technical  talent  with  outstanding  contributions.  He  presided  over  the 
completion  of  2  national  natural  science  funds,  won  the  second  prize  of 
Jilin  Province  Science  and  Technology  Progress  Award,  and  wrote  46 
papers on electric power information SCI/EI search. 

YANG  LI  (S’13–M’14–SM’18)  was  born  in 
Nan yang, China. He received his Ph.D. degree 
in  Electric  Engineering  from  North  China 
Electric  Power  University  (NCEPU),  Beijing, 
China,  in  2014.He  is  an  Associate  professor  at 
the  School  of  Electric  Engineering,  Northeast 
Electric  Power  University, 
Jilin,  China. 
Currently,  he  is  also  a  China  Scholarship 
Council  (CSC)-funded  post  doc  with  Argonne 
National  Laboratory,  Lemont,  United  States. 
His  research  interests  include  power  system 
integrated  energy  system,  renewable  energy 
stability  and  control, 
integration, and smart grids. Dr. Li is the Associate Editor of IEEE Access, 
IET Renewable Power Generation, and Electrical Engineering. 

KEWEI  HU  was  born  in  May  1968,  he  is  now 
working in the Power Dispatching Control Center 
of  the  State  Grid  Jilin  Electric  Power  Co.,  Ltd., 
and  graduated  from  Northeast  Electric  Power 
University with a master's degree in power system 
and  automation.  His  research  direction  is  power 
system dispatching automation. 

JIAN  SUN  received  the  B.S.  degree  from  the 
Northeast  Electric  Power  University,  in  2001.He 
is  currently  a  Senior  Engineer  at  State  Grid  Jilin 
Power Co., Ltd. Baishan Power Supply Company. 
His  research  interest  is  safety  monitoring  in  the 
smart grid. 

KAI  XUE  received  the  M.S.  degree  from  the 
Northeast  Normal  University.  He  is  currently  a 
Senior  Engineer  at  State  Grid  Jilin  Power  Co., 
Ltd.  Training  Center.  His  research  interest  is 
power system automation. 

MINGSHI  CUI  received  the  B.S.  degree  from  the 
North China Electric Power University, in 2010. 
He  is  currently  an  Engineer  at  State  Grid  Inner 
Mongolia  Eastern  Electric  Power  Company.  His 
research interest is information processing in smart 
grid. 

VOLUME XX, 2020 

14 

This work is licensed under a Creative Commons Attribution 4.0 License. For more information, see https://creativecommons.org/licenses/by/4.0/.

 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
