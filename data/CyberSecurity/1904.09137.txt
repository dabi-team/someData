9
1
0
2

p
e
S
2
2

]

C
O
.
h
t
a
m

[

2
v
7
3
1
9
0
.
4
0
9
1
:
v
i
X
r
a

From Static to Dynamic Anomaly Detection
with Application to Power System Cyber Security

KAIKAI PAN, PETER PALENSKY, AND PEYMAN MOHAJERIN ESFAHANI

Abstract. Developing advanced diagnosis tools to detect cyber attacks is the key to security of power
systems. It has been shown that multivariate data injection attacks can bypass bad data detection schemes

typically built on static behavior of the systems, which misleads operators to disruptive decisions. In this
article, we depart from the existing static viewpoint to develop a diagnosis ﬁlter that captures the dynamics
signatures of such a multivariate intrusion. To this end, we introduce a dynamic residual generator approach
formulated as robust optimization programs in order to detect a class of disruptive multivariate attacks that
potentially remain stealthy in view of a static bad data detector. We investigate two possible desired features:
(i) a non-zero transient and (ii) a non-zero steady-state behavior of the residual generator in the presence of
an attack. In case (i), the problem is reformulated as a ﬁnite, but possibly non-convex, optimization program.

We further develop a linear programming relaxation that improves the scalability, and as such practicality,
of the diagnosis ﬁlter design. In case (ii), it turns out that the resulting robust program admits an exact
convex reformulation, yielding a Nash equilibrium between the attacker and the residual generator. This
assertion has an interesting implication: the proposed approach is not conservative in the sense that the
additional knowledge of the worst-case attack does not improve the diagnosis performance. To illustrate our
theoretical results, we implement the proposed diagnosis ﬁlter to detect multivariate attacks on the system
measurements deployed to generate the so-called Automatic Generation Control signals in a three-area IEEE

39-bus system.

1. Introduction

The digital transformation of our power system does not only lead to better observability, ﬂexibility and
eﬃciency, but also introduces a phenomenon that is new to power system controls: cyber security threats.
NIST [7] deﬁnes ﬁve functions for protecting Information and Communication Technology (ICT): (i) Identify,
(ii) Protect, (iii) Detect, (iv) Respond, (v) Recover. It would be naive to think an ICT system can be perfectly
protected in order to address the issues raised by (iii)-(v). This paper focuses on (iii) Detection for supervisory
control and data acquisition (SCADA) systems, which are in charge of transmitting measurement and control
signals between power system substations and control centers. Such SCADA systems are notorious for being
based on legacy ICT, and are a popular target for adversaries [13, 6] nowadays. The consequences of a
successful attack on SCADA systems can be catastrophic to an economy and society in general [24, 17]. In
this light, it is of utmost importance to detect these attacks and respond accordingly. Notably, if the malicious
attacks can be detected suﬃciently fast, the corrupted signals can be disconnected or corrected by resilient
controls, preventing further severe damage [34].

Literature on anomaly detection. Traditionally, SCADA systems deploy bad data detection (BDD) to
ﬁlter out possible erroneous measurements due to sensor failures or anomalies [33]. The BDD process captures
only a snapshot of the steady states of system trajectories, and thus only exploits possible static impact of

Date: September 24, 2019.
The authors are with the Delft University of Technology, The Netherlands

(email:

{K.Pan, P.Palensky,

P.MohajerinEsfahani}@tudelft.nl).

1

 
 
 
 
 
 
FROM STATIC TO DYNAMIC ANOMALY DETECTION

2

intrusions. Although this method can perform successfully in detecting basic attacks, it may fail in the
presence of the so-called stealthy multivariate attacks that carefully launch synthesized false data injections
given full knowledge of the system model [15].

It was ﬁrst explored in [20] that such an attack can perturb the state estimation function without triggering
alarms in BDD. Since then vulnerability and impact analysis of stealthy attacks on power systems have been
a prominent subject in the literature. A typical notion to quantify the vulnerability to stealthy attacks is
directly concerned with the level of eﬀorts required to alter speciﬁc measurements [12, 27]. Without advanced
diagnosis tools, tampering measurements remains undetected, causing state deviations, equipment damages or
even cascading failures [18]. Techniques proposed to deal with stealthy attacks include statistical methods such
as sequential detection using Cumulative Sum (CUSUM)-type algorithms [16], and measurements consistency
assessment under certain observability assumptions [35]. A detection method that leverages online information
is described in [3], which is applicable by ensuring the availability and accuracy of load forecasts and generation
schedules.
In [19], a mechanism is introduced to formulate the detection scheme as a matrix separation
problem, but it only recovers intrusions among corrupted measurements over a particular period of time.

These techniques are essentially static detection methods that may be conﬁned by certain prior assumptions
on the distribution of measurement errors. Despite an extensive and ongoing literature focusing on the static
part of BDD mechanism, the following question remains largely unexplored:

Would it be possible to detect stealthy multivariate attacks in a real-time operation by exploiting the attack
impact on the dynamics of system trajectories during the transient?

The importance of an appropriate answer to this question has been reinforced thanks to recent advances
in sensing technology in the modern power systems. Our main objective in this article is to address this
question.

Related work. Detection methods concerning system dynamics have primarily emerged under the topic of
fault detection and isolation ﬁlters. A subclass of these schemes is the observer-based approach applied initially
to linear models [21]; see also [9] for a comprehensive summary of the large body of literature. The authors
in [25] further extend the modeling framework to general linear diﬀerential-algebraic equations (DAEs),
enhancing the applicability of such methods particularly for power system applications due to the common
governing physical laws in this setting. Recently, a variant of observer-based methods is also investigated
in [1] so as to deal with unknown natural exogenous inputs.

An inherent shortcoming of many observer-based approaches is that the degree of the resulting diagnosis
ﬁlter is eﬀectively the same as the system dynamics, which may yield an unnecessarily complex ﬁlter in
large-scale power systems. To our best of knowledge, there are relatively much fewer studies in the literature
on the design of the reduced-order observers where the conditions for a minimum order existence need to be
satisﬁed [9, 10]. The closest approach in the literature is [23] where a scalable optimization-based ﬁlter design
is developed for high-dimensional nonlinear control systems. However, the proposed method opts for mainly
dealing with a single fault scenario, and may not be as eﬀective in case of smart multivariate adversarial
inputs.

An eﬀective approach toward security and modeling the interaction between attackers and detectors builds
on the rich framework of game theory. Recently, the authors in [32] propose a two player mixed strategy game
to address a dynamic resource-planning problem between an attacker targeting the communication equipment
and a defender protecting the control network. Similar frameworks have also been deployed to model the
dynamics of information ﬂow between an advanced persistent threat and a detector [30, 29].

FROM STATIC TO DYNAMIC ANOMALY DETECTION

3

Our contributions. The main objective of this article is to develop a diagnosis ﬁlter to detect multivariate
data injection attacks in a real-time operation. For this purpose, considering a class of disruptive multivariate
attack scenarios (Deﬁnition 2.5), we ﬁrst characterize the attack impact on power system dynamics through
a set of diﬀerential equations. Having transferred the dynamics into the discrete-time domain, we further
restrict the diagnosis ﬁlter to a family of dynamic residual generators that entirely decouples the contributions
of the attacks from the system states and natural disturbances. In order to identify an admissible multivariate
attack scenario, we propose an optimization-based framework to robustify the diagnosis ﬁlter with respect
to such attacks, i.e., aiming to design a ﬁlter whose residual (output) is sensitive to any plausible disruptive
multivariate attacks. The main contributions of this article are as follows:

(i) Unlike the existing literature, we go beyond a static viewpoint of anomaly detection to capture the
attack impact on the dynamics of system trajectories. To this end, we characterize the diagnosis ﬁlter
design approach as a robust optimization program. It is guaranteed that while the ﬁlter residual is
decoupled from system states and disturbances, it still remains sensitive to all admissible disruptive
multivariate attacks even if the attacker has full knowledge about the diagnosis ﬁlter architecture
(Deﬁnition 4.1 and the program (18)).

(ii) To detect attacks during the transient behavior, we reformulate the resulting robust program as a
ﬁnite, possibly non-convex, optimization program (Theorem 4.3). To improve the scalability of the
proposed solution, we further propose a linear programming relaxation which is highly tractable for
large scale systems (Corollary 4.4). It is guaranteed that if the optimal value of the relaxed program
is positive, the resulting diagnosis ﬁlter is able to detect any admissible disruptive attack scenarios,
which may remain stealthy through the lens of a static detector.

(iii) We further explore the steady-state behavior of the diagnosis ﬁlter in the presence of a plausible attack
scenario (Lemma 4.6). In this case, we develop an exact convex reformulation of the resulting robust
program. As a byproduct, we show that the proposed solution is indeed a Nash equilibrium (saddle
point) between the attacker and the residual generator (Theorem 4.7). An interesting implication of
such a Nash equilibrium is that the information of the attack signal may not necessarily improve the
performance of the diagnosis ﬁlter. In other words, if the proposed convex optimization fails to have
a desirable feasible solution, it then implies that there exists a disruptive stealthy attack where the
exact knowledge of the attack signal still does not help design a successful residual generator.

In addition to the above theoretical results, we validate the performance and eﬀectiveness of the proposed
diagnosis ﬁlter on a multi-area IEEE 39-bus system. Numerical results illustrate that the diagnosis ﬁlter
successfully generates a residual “alert” in the presence of multivariate attacks that are stealthy in a static
viewpoint, even in a noisy environment with imprecise measurements.

Section 2 introduces the problem of power system cyber security, and the challenges posed by multivariate
attacks are highlighted. Section 3 discusses a model instance of power system dynamics under attacks on
measurements. Our diagnosis ﬁlter design is proposed in Section 4 where an optimization framework is
introduced, and numerical simulations are reported in Section 5.

Notation. The symbols R, N represent the set of real numbers and integers, respectively. Given a matrix
A ∈ Rm×n, A(cid:62) denotes its transpose, and the space Im(A) represents its range space. Throughout the paper,
the matrix I is the identity matrix with an appropriate dimension. Given a column vector a ∈ Rm, diag(a)
denotes an m × m diagonal matrix with the elements of vector a sitting on the main diagonal and the rest
of the elements being zero. We also denote by diag[A1, A2, . . . , Ak] a block matrix whose main diagonal
elements are the matrices A1, A2, . . . , Ak. Given a vector a ∈ Rm, the associated (cid:96)∞−norm is denoted by
(cid:107)a(cid:107)∞ = maxi≤m |ai|.

FROM STATIC TO DYNAMIC ANOMALY DETECTION

4

Figure 1. Schematic block diagram of the system model.

2. Problem Statement

2.1. Static detection and system modeling

For a power grid, measurements are collected by remote sensors and transmitted through a SCADA
network. The typical BDD is conducted to detect the erroneous measurements at each time instance. We can
see this as a static process: it only concerns the system states X[k] ∈ RnX and measurements Y [k] ∈ RnY at
time step k ∈ N, which can be described by

Y [k] = CX[k] + Df f [k],

(1)

where C ∈ RnY ×nX is the measurement matrix, and f [ · ] ∈ Rnf represents the data injection attacks on
It
measurements. Note that the matrix Df characterizes which measurement is vulnerable to attacks.
is customary to deﬁne a residual signal for a static detector, rS[k] := Y [k] − ˆY [k], where ˆY [ · ] denotes
the estimated measurements. In the traditional weighted least squares estimation, the estimate of state is
(C (cid:62)C)−1C (cid:62)Y [k], assuming that C has full column rank with high measurement redundancy. Then the
measurements estimate is C(C (cid:62)C)−1C (cid:62)Y [k], and the residual signal can be further expressed as

rS[k] = (cid:0)I − C(C (cid:62)C)−1C (cid:62)(cid:1)Y [k].

(2)

Such an anomaly detector has shown a good eﬀectiveness in detecting erroneous data and basic attacks [8].
However, in the face of coordinated attacks on multiple measurements, this static detector can fail. In this
article, motivated by this shortcoming, we take a dynamic design perspective where we shift the emphasis on
an attack as a static process to its eﬀects on power system dynamics. In particular, we opt for diﬀerentiating
the attack impact on the systems trajectories from natural disturbances such as load deviations.

To model its impact on the dynamics, let us consider a more general modeling framework in Figure 1.
The electrical grid is operated by a digital controller that receives measurements as inputs and sends control
signals to the actuators through communication networks. These transmitted data are applied in discrete-
time samples. On the power grid side, the input d[k] ∈ Rnd represents natural disturbances. On the controller
side, a control signal u[k] ∈ Rnu is computed given the measurements Y [k]. Note that with the closed-loop

Electrical Power GridElectrical Power Gridd[k]u[k]Y[k]Diagnosis FilterDiagnosis Filterr[k]Feedback ControllerFeedback ControllerCommunication NetworkCommunication Networkf[k]FROM STATIC TO DYNAMIC ANOMALY DETECTION

5

control, the corruptions f [k] on the measurements would aﬀect the system dynamics. The dynamics of the
closed-loop system is

(cid:40) X[k + 1] = AxX[k] + Bdd[k] + Buu[k],

Y [k] = CX[k] + Df f [k],

(3)

where Ax, Bd and Bu are constant matrices. Let us highlight the diﬀerence between the dynamical system (3)
and the respective static counterpart (1). In fact, the time independence of the ﬁrst equation in (3) describes
the dynamics of the system, while the algebraic equation (1) represents the relation on each time instance and
describes a static relation between the states and outputs. The aim of this study is to exploit such dynamics
information in (3) in order to design a diagnosis ﬁlter to detect stealthy multivariate attacks. To illustrate the
attack impact on the system dynamics, we can simply consider the feedback controller as a linear operator
such that u[k] = GY [k] where G ∈ Rnu×nY is a matrix gain. By deﬁning the closed-loop system matrices
Acl := A + BuGC and Bf := BuGDf , we can reformulate (3) into

(cid:40) X[k + 1] = AclX[k] + Bdd[k] + Bf f [k],

Y [k] = CX[k] + Df f [k].

(4)

Remark 2.1 (Dynamic feedback controller). The restriction to only a static feedback controller u[k] = GY [k]
to transfer from (3) to (4) is without loss of generality. Namely, the proposed framework is rich enough to
Indeed, when the controller has certain dynamics, it
subsume a dynamic controller architecture as well.
suﬃces to augment the system dynamics (3) with the controller states and outputs. We refer to Appendix 2.1,
for such a detailed analysis.

Remark 2.2 (Attacks impact on the dynamics of system trajectories). In light of (4), matrices Bf , Df
capture the attack impact on the power system dynamics, mapping attacks f [ · ] to the system states and
measurements respectively.

In the following, we show that the state-space description (4) is a particular case of DAE model. By

introducing a time-shift operator q : qX[k] → X[k + 1], one can ﬁt (4) into

H(q)x[k] + L(q)y[k] + F (q)f [k] = 0,

(5)

where x := [X (cid:62) d(cid:62)](cid:62) represents the unknown signals of system states and disturbances; y := Y contains
all the available data for the operator. Let nx and ny be the dimensions of x[ · ], y[ · ]. We denote nr as the
number of rows in (5). Then H, L, F are polynomial matrices in terms of the time-shift operator q with nr
rows and nx, ny, nf columns separately, by deﬁning,

H(q) :=

(cid:34)

−qI + Acl Bd
0

C

(cid:35)

, L(q) :=

(cid:35)

(cid:34)

0
−I

, F (q) :=

(cid:35)

.

(cid:34)

Bf
Df

2.2. Challenge: multivariate attacks

We start this subsection with an existing result characterizing the set of stealthy multivariate attacks that

can bypass the static detector.

Lemma 2.3 (Stealthy attack values [20, Theorem 1]). Consider the measurement equation (1) and the static
detector with the respective residual function (2). Then, an attack f [ · ] remains stealthy, i.e., it does not
cause any additional residue to (2), if it takes values from the set

F := (cid:8)f [k] ∈ Rnf : Df f [k] ∈ Im(C),

k ∈ N(cid:9),

(6)

FROM STATIC TO DYNAMIC ANOMALY DETECTION

6

One can observe that a stealthy attack Df f [ · ] described in (6) has the knowledge of the system model (1)
through the range space of C. That is, it represents a tampered value Df f [k] = C∆X where ∆X ∈ RnX can
be any injected bias inﬂuencing certain sensor measurements. Such multivariate attacks would also challenge
the detector design as they may neutralize the diagnosis ﬁlter outputs.

Assumption 2.4 (Stationary attacks). Throughout this article, we consider attacks f [ · ] that are time-
invariant, i.e., f [k] = 0 for all k ≤ kmin; f [k] = f ∈ F for all k > kmin. Namely, the attack occurs as a
constant bias injection f on measurements during the system operations at a speciﬁc unknown time instance
kmin, and it remains unchanged since then.

Advanced attacks also pursue a maximized impact on the system dynamics. Thus, an adversary would
try to inject “smart” false data, possibly with large magnitudes, in such a way that it causes the maximum
damage. The next deﬁnition opts to formalize this class of attacks.

Deﬁnition 2.5 (Disruptive stealthy attack). Consider a set of vectors Fb := [f1, f2, . . . , fd] representing a
ﬁnite basis for the set of stealthy attacks (6), i.e., the set F deﬁned in (6) can equivalently be represented by

(cid:40)

F =

F (cid:62)

b α =

d
(cid:88)

i=1

αifi

(cid:12)
(cid:12) α = [α1, α2, · · · , αd](cid:62) ∈ Rd
(cid:12)

(cid:41)

.

We call a signal f ∈ F disruptive stealthy attack if its corresponding coeﬃcients α is a polytopic set, i.e., it
belongs to

A := (cid:8)α ∈ Rd | Aα ≥ b(cid:9),
(7)
where A ∈ Rnb×d and b ∈ Rnb are given matrices. We emphasize that the subsequent analysis and the proposed
diagnosis ﬁlter design only rely on the convexity of the set A. Namely, the choice (7) may be adjusted according
to the application at hand, as long as the convexity of the set is respected.

3. Cyber Security of Power Systems: AGC modeling

In this section, we ﬁrst go through a modeling instance of power system dynamics in the form of (4):
Automatic Generation Control (AGC) closed-loop system under attacks. This model will be used to validate
our diagnosis ﬁlter. Figure 2 depicts the diagram of a three-area IEEE 39-bus system. AGC is a feedback
controller that tunes the setpoints of participated generators (e.g., G11 of Area 1) to maintain the frequency
as its nominal value and the tie-line (e.g., L1-2 between Area 1 and 2) power as the scheduled one.

In the work of AGC, a linearized model is commonly used for the load-generation dynamics [28]. For a

three-area system, the frequency dynamics in Area i can be written as

∆ ˙ωi =

1
2Hi

(∆Pmi − ∆Ptiei − ∆Pli − Di∆ωi),

(8a)

where Hi is the equivalent inertia constant; Di is the damping coeﬃcient and ∆Pli denotes load deviations.
Here ∆Ptiei, ∆Pmi represent the total tie-line power exchanges from Area i and the total generated power
in Area i, i.e., ∆Ptiei = (cid:80)
∆Ptiei,j where Ei denotes the set of areas that connect to Area i, and
∆Pmi = (cid:80)Gi

g=1 ∆Pmi,g where Gi denotes the number of participated generators in Area i, and we have

j∈Ei

∆ ˙Pmi,g = −

1
Tchi,g

(∆Pmi,g +

1
Si,g

∆ ˙Ptiei,j = Tij(∆ωi − ∆ωj),

∆ωi − φi,g∆Pagci),

(8b)

(8c)

where Tchi,g is the governor-turbine’s time constant; Si,g denote the droop coeﬃcient; Tij is the synchronizing
parameter between Area i and j. Note that ∆Pagci is the signal from AGC for the participated generators to

FROM STATIC TO DYNAMIC ANOMALY DETECTION

7

Figure 2. Three-area 39-bus system: the measurements of the tie-lines (in red) L1-3, L1-2,
L2-3 are attacked.

track the load changes, and φi,g is the participating factor, i.e., (cid:80)Gi
and tie-line power measurements, the area control error (ACE) is computed for an integral action,

g=1 φi,g = 1. After receiving the frequency

ACEi = Bi∆ωi +

(cid:88)

∆Ptiei,j ,

j∈Ei
∆ ˙Pagci = −KIiACEi,

(8d)

(8e)

where Bi is the frequency bias and KIi represents the integral gain. Based on the equations (8), the linearized
model of Area i can be presented as the state equation

˙Xi(t) = AiiX(t) + Bi,ddi(t) +

(cid:88)

j∈Ei

AijXj(t),

(9)

where Xi is the state vector; di := ∆Pli denotes load deviations. Recall Remark 2.1 that (9) is an augmented
model for the closed-loop AGC system that Xi consists of not only the electrical grid states (e.g., frequency,
generator output and tie-line power) but also the controller state ∆Pagci, i.e.,

(cid:104)

Xi :=

{∆Ptiei,j }j∈Ei ∆ωi

{∆Pmi,g }1:Gi ∆Pagci

(cid:105)(cid:62)

.

Besides in (9), Aii is the system matrix of Area i; Aij is a matrix whose only non-zero element is −Tij in row
1 or 2 and column 3; Bi,d is the matrix for load deviations.

In addition to (9), we assume a measurement model with high redundancy that the measurements of each
tie-line power (∆Ptiei,j ) and the total tie-lines’ power (∆Ptiei), the frequency (∆ωi), each generator output
(∆Pmi,g ) and the total generated power (∆Pmi ), and the AGC controller output (∆Pagci) are all available.
Besides, vulnerabilities within SCADA networks may allow cyber intrusions. Thus the output equation is

where Yi is the system output and Ci is the output tall-matrix with full column rank. Here fi denotes
multivariate attacks and the matrix Di,f quantiﬁes which output is attacked. In the aforementioned section,

Yi(t) = CiX(t) + Di,f fi(t),

(10)

Area 3Area 1Area 2G31G11G22G21G23L1-3-1L1-3-2L1-2L2-3G12G32FROM STATIC TO DYNAMIC ANOMALY DETECTION

8

due to the feedback loop, attacks on the measurements would also aﬀect the frequency dynamics. Hence the
state equation (9) during attacks becomes

˙Xi(t) = AiiX(t) + Bi,ddi(t) + Bi,f fi(t) +

(cid:88)

j∈Ei

AijXj(t),

where Bi,f is the matrix that relates attacks to system states.

Using the state equations of each area, the continuous-time model of the three-area system can be obtained,

˙X(t) = ˜AclX(t) + ˜Bdd(t) + ˜Bf f (t),

(11)

where X is the vector consisting of groups of dynamic states in each area; d is the vector for all areas’ load
deviations; f denotes all the attack signals in the three-area, namely,

X =

(cid:104)
X (cid:62)

1 X (cid:62)

2 X (cid:62)
3

(cid:105)(cid:62)

,

d =

(cid:104)
∆Pl1 ∆Pl2 ∆Pl3

(cid:105)(cid:62)

,

f =

(cid:104)
f (cid:62)
l

f (cid:62)
2

(cid:105)(cid:62)

.

f (cid:62)
3

In (11), ˜Acl is the closed-loop system matrix; ˜Bd, ˜Bf are constant matrices that relate load deviations and
attacks to system states. For the three-area system, these matrices are

˜Acl =






A11 A12 A13
A21 A22 A23
A31 A32 A33




 ,

˜Bd = diag

(cid:104)

B1,d, B2,d, B3,d

(cid:105)

,

˜Bf = diag

(cid:104)
B1,f , B2,f , B3,f

(cid:105)

.

We can also obtain the output equation of the system,

Y (t) = CX(t) + Df f (t),

(12)

where Y is the system output vector containing all the three areas’ outputs; C is the output matrix; Df
quantiﬁes all the vulnerable signals. Similarly, these matrices are

Y =

(cid:104)
Y (cid:62)
1

(cid:105)(cid:62)

Y (cid:62)
2

Y (cid:62)
3

, C = diag

(cid:104)

C1, C2, C3

(cid:105)

, Df = diag

(cid:104)

D1,f , D2,f , D3,f

(cid:105)

.

To obtain the sampled discrete-time model as (4), (11) and (12) must be discretized. We deploy a zero-order

hold (ZOH)1 discretization for a given sampling period Ts [26],

Acl = e ˜AclTs , Bd =

(cid:90) Ts

0

e ˜Acl(Ts−t) ˜Bddt.

(13)

Note that the attack matrix ˜Bf has the same matrix transformation as ˜Bd, resulting Bf . The above approxi-
mation is exact for a ZOH and (13) corresponds to the analytical solution of the discretization. Therefore, the
above model can be described in the form of (4) which again can be ﬁtted into the DAE (5). In Appendix 2.2,
we provide the detailed description of the involved parameters of the three-area 39-bus system as well as the
attack scenarios on the AGC measurements.

4. Robust Dynamic Detection

4.1. Preliminaries for diagnosis ﬁlter construction

An ideal detection aims to implement a non-zero mapping from the attack to the diagnostic signal while
decoupled from system states and disturbances, given the available data y[ · ] in the control center. In the
power system dynamics described via a set of DAE, we restrict the diagnosis ﬁlter to a type of dynamic
residual generator in the form of linear transfer functions, i.e., rD[k] := R(q)y[k] where rD is the residual

1The inputs signals d( · ) and f ( · ) in (11) are assumed to be piecewise constant within the sampling periods.

FROM STATIC TO DYNAMIC ANOMALY DETECTION

9

signal of the diagnosis ﬁlter and R(q) is a transfer operator. Note that y[ · ] is associated with the polynomial
matrix L(q) in (5). We propose a formulation of transform operator R(q) as

R(q) := a(q)−1N (q)L(q),

where N (q) is a polynomial vector with the dimension of nr and a predeﬁned order dN . To make R(q)
physically realizable, stable dynamics a(q) with suﬃcient order need to be added as the denominator where
all the roots are strictly contained in the unit circle. Note that, unlike the observer-based methods, here dN
can be much less than the dimension of system dynamics. Then N (q) and a(q) are the two variables for a
diagnosis ﬁlter design. By multiplying a(q)−1N (q) in the left of (5), we have

rD[k] = a(q)−1N (q)L(q)y[k] = − a(q)−1N (q)H(q)x[k]
(cid:125)

(cid:124)

(cid:123)(cid:122)
(I)

− a(q)−1N (q)F (q)f [k]
,
(cid:123)(cid:122)
(cid:125)
(II)

(cid:124)

(14)

where term (I) in (14) is due to x[ · ] of system states and natural disturbances. Term (II) is the desired
contribution from the attacks f [ · ]. In view of this diagnosis ﬁlter description, we introduce a class of residual
generator which is sensitive to disruptive stealthy attacks as deﬁned in Deﬁnition 2.5.

Deﬁnition 4.1 (Robust residual generator). Consider a linear residual generator represented via a poly-
nomial vector N (q). This residual generator is robust with respect to disruptive stealthy attacks introduced
in Deﬁnition 2.5 if

(cid:40)

(I) N (q)H(q) = 0,
(II) N (q)F (q)Fbα (cid:54)= 0,

∀α ∈ A,

(15)

where the basis matrix Fb and the set A are the same as the ones in Deﬁnition 2.5.

In the next step, we show that the polynomial equations (15) in Deﬁnition 4.1 can be characterized as a

feasibility problem of a ﬁnite robust program.

Lemma 4.2 (Linear program characterization). Consider the polynomial matrices H(q) = (cid:80)1
N (q) := (cid:80)dN
trices. Then, the family of robust residual generators in (15) is characterized by

i=0 Hiqi,
i=0 Niqi and F (q) = F , where Hi ∈ Rnr×nx , Ni ∈ Rnr , and F ∈ Rnr×nf are constant ma-

(cid:40)

(I)
(II) (cid:13)

¯N ¯H = 0,
(cid:13) ¯N V (α)(cid:13)

(cid:13)∞ > 0,

where (cid:107) · (cid:107)∞ denotes the inﬁnite vector norm, and



H0 H1

0

· · ·

¯N :=

(cid:104)
N0 N1

· · · NdN

(cid:105)

,

¯H :=








0 H0 H1
0
...
. . .
. . .
0
0 H0 H1
0

0
· · ·

∀α ∈ A,

(16)










,

V (α) :=



F Fbα

0








0
...
0

F Fbα

0
· · ·

· · ·

0
. . .
0










.

0
...

0
F Fbα

0
...

Proof. The proof follows a similar line of arguments as [23, Lemma 4.2]. The key step is to observe that
N (q)H(q) = ¯N ¯H[I, qI, · · · , qdN +1I](cid:62), and N (q)F Fbα = ¯N V (α)[I, qI, · · · , qdN I](cid:62). The rest of the proof
(cid:3)
follows rather straightforwardly, and we omit the details for brevity.

4.2. Robust diagnosis ﬁlter: transient behavior

In light of (16), we can deﬁne a symmetric set for the design variable ¯N of the dynamic residual generator,

N := { ¯N ∈ R(dN +1)nr | ¯N ¯H = 0, (cid:107) ¯N (cid:107)∞ ≤ η}.

(17)

FROM STATIC TO DYNAMIC ANOMALY DETECTION

10

The second constraint in the set is added to avoid possible unbounded solutions. To design a robust residual
generator, we aim to ﬁnd an ¯N ∈ N that for all α ∈ A, (16) can be satisﬁed. To this end, a natural
reformulation of the residual synthesis is to consider an objective function as the second quantity in (16)
inﬂuenced by the parameters N and the attacker action α, i.e., J ( ¯N , α) := (cid:107) ¯N V (α)(cid:107)∞. A successful scenario
from an attacker viewpoint is to minimize this objective function given a residual generator. Therefore, we
take a rather conservative viewpoint where the attacker may have complete knowledge of the system model
and even the residual generator parameters, and exploits it so as to synthesize a stealthy attack. We then
reformulate the diagnosis ﬁlter design as the robust optimization program,
(cid:111)
.

(cid:110)
J ( ¯N , α) := (cid:107) ¯N V (α)(cid:107)∞

(18)

γ(cid:63) := max
¯N ∈N

min
α∈A

The optimal value γ(cid:63) of the robust reformulation (18) is indeed an indication whether the attack still
remains stealthy in the dynamic setting, i.e., if γ(cid:63) > 0 then the optimal solution ¯N (cid:63) yields a diagnosis ﬁlter in
the form of (14) which detects all the admissible attacks introduced in Deﬁnition 2.5. However, if γ(cid:63) = 0, then
it implies that for any possible detectors (static or dynamic) there exists a stationary disruptive attack that
remains stealthy. In the next step, we show that the robust program (18) can be equivalently reformulated
as a ﬁnite (non-convex) optimization problem.

Theorem 4.3 (Finite reformulation of (18)). The robust optimization (18) can be equivalently described via
the ﬁnite optimization program

γ(cid:63) = max
¯N , β, λ

b(cid:62)λ

s.t.

(β2i − β2i+1)NiF Fb = λ(cid:62)A,

dN(cid:80)
i=0
1(cid:62)β = 1, β ≥ 0,
¯N ∈ N , λ ≥ 0,

where β = [β0, β1, · · · , β2dN +1](cid:62) is an R2dN +2-valued auxiliary variable.

Proof. See Appendix 1.1.

(19)

(cid:3)

The exact reformulation program (19) for (18) is unfortunately non-convex due to the bilinearity between
the variables β and Ni in the ﬁrst constraint.
In the following corollary, we suggest a convex relaxation
of the program by restricting the feasible set of the variable β to a 2dN + 2 ﬁnite possibilities where β =
[0, · · · , 1, · · · , 0](cid:62) in which the only non-zero element of the vector is the i-th element.

Corollary 4.4 (Linear program relaxation). Given i ∈ {1, . . . , 2dN + 2}, consider the linear program

γ(cid:63)
i := max
¯N , λ
s.t.

b(cid:62)λ

(−1)iN(cid:98)i/2(cid:99)F Fb = λ(cid:62)A,
¯N ∈ N , λ ≥ 0,

(LPi)

where (cid:98) · (cid:99) is the ceiling function that maps the argument to the least integer. Then, the solution to the
program (LPi) is a feasible solution to the exact robust design reformulation (19), and max{i≤2dN +2} γ(cid:63)
i ≤ γ(cid:63).
In particular, if for any i ∈ {1, . . . , 2dN +2} we have γ(cid:63)
i > 0, then the solution to LPi oﬀers a robust residual
generator detecting all admissible disruptive attacks introduced by Deﬁnition 2.5.

Corollary 4.4 suggests that the maximum optimal value of {γ(cid:63)
provide a suboptimal solution to the original robust design (18).

0 , γ(cid:63)

1 , · · · , γ(cid:63)

2dN +2} and its corresponding ¯N (cid:63)

FROM STATIC TO DYNAMIC ANOMALY DETECTION

11

We note that the focus of this article is on stationary (time-invariant) attacks. It is also important to
highlight that the robust design perspective (18) allows the attacker to know the system model and ﬁlter
parameters. In such a setting, the detection procedure could be much more diﬃcult if the attacker would
be able to dynamically adapt the attacks over the time, i.e., the attack signal is time-varying. In fact, in a
multivariate attack scenario, one can construct a disruptive time-varying attack bypassing any linear residual
generators. The next remark alludes more to this situation.

Remark 4.5 (Time-varying stealthy attacks). Consider a multivariate attack f = [f1 f2 · · · fnf ](cid:62) where
each element is a time-varying signal fi = fi[k]. Then, the residual (14) can be rewritten as

a(q)rD[k] = −

nf
(cid:88)

(cid:16)

i=1

N (q)Fifi[ · ]

(cid:17)

[k],

(20)

where F = [F1 F2 · · · Fnf ] represents the attack dynamics matrix. One can inspect that when the time-varying
relation (cid:80)nf
i=1

(cid:0)N (q)Fifi[ · ](cid:1)[k] = 0 holds for every k, for instance when

fnf [k] = −(cid:0)N (q)Fnf

(cid:1)−1

nf −1
(cid:88)

(cid:16)

i=1

N (q)Fifi[ · ]

(cid:17)

[k],

then the residual outcome (20) stays zero for all k, and as such, the attack remains undetected.

The proposed robust design in (18) does not necessarily enforce a non-zero steady-state residual of the
diagnosis ﬁlter under multivariate attacks. Namely, the design perspective of (18) focuses on detection of
attacks during the transient behavior without any requirements on long-term behavior of the residual. Indeed,
the residual signal rD may return to zero value after a successful reaction to the attack occurrence. A more
stringent perspective is to require a non-zero steady-state behavior under any admissible attack scenario in
α ∈ A. This extension is addressed in the next subsection.

4.3. Robust diagnosis ﬁlter: steady-state behavior

In order to design a diagnosis ﬁlter with non-zero steady-state residual “alert” when a multivariate at-
tack occurs, the robust optimization (18) can be modiﬁed by a more conservative (smaller) objective func-
tion J ( ¯N , α) := | ¯N ¯F α| where

(cid:104)

¯F :=

F Fb F Fb

· · · F Fb

(cid:105)(cid:62)

.

(21)

A similar treatment as the preceding subsection can establish a framework for computational purposes. The
next lemma follows similar objective as in Lemma 4.2 with a more demanding requirement of the non-zero
long-term residual behavior.

Lemma 4.6 (Non-zero steady-state residual characterization). For the polynomial matrices H(q), N (q) and
F (q) as deﬁned in Lemma 4.2, the family of dynamic residual generators with non-zero steady-state residual
under multivariate attacks can be characterized by the algebraic relations

(cid:40)

(I)
(II)

¯N ¯H = 0,
| ¯N ¯F α| > 0,

∀α ∈ A,

(22)

where ¯F is deﬁned in (21), and the matrices ¯N , ¯H are as deﬁned in Lemma 4.2.

· · · , qdN +1I](cid:62). Thus if ¯N ¯H = 0, the diagnosis ﬁlter be-
Proof. Recall that N (q)H(q) = ¯N ¯H[I, qI,
comes rD[k] = −a(q)−1N (q)f [k]. Note the steady-state value of the ﬁlter residual under attacks would
be −a(q)−1N (q)F (q)f |q=1. Thus for the multivariate attack with α, the steady-state value of the ﬁlter
residual is −a(1)−1N (1)F (1)Fbα. The proof concludes by noting that N (1)F (1)Fbα = ¯N ¯F α.
(cid:3)

FROM STATIC TO DYNAMIC ANOMALY DETECTION

In a similar fashion, the robust design perspective in (18) can be modiﬁed accordingly as

µ(cid:63) := max
¯N ∈N

min
α∈A

(cid:110)

J ( ¯N , α) := | ¯N ¯F α|

(cid:111)
.

12

(23)

Notice the relation between the new objective function with the absolute value and the one in (18) with
the inﬁnity-norm. As it appears in the next result, the new setting is in fact a restricted case of the ﬁnite
reformulation in Theorem 4.3.

Theorem 4.7 (Residual long-term behavior: exact convex reformulation and Nash equilibrium). Consider
the minimax counterpart of the program (18) as deﬁned

ϕ(cid:63) := min
α∈A

max
¯N ∈N

(cid:110)

J ( ¯N , α) := | ¯N ¯F α|

(cid:111)
.

Each of the program (23) and (24) can be equivalently reformulated through the linear programs

µ(cid:63) = max
¯N , λ
s.t.

b(cid:62)λ

¯N ¯F = λ(cid:62)A
¯N ∈ N , λ ≥ 0 ,

ϕ(cid:63) =

min
v1, v2, w, α
s.t.

1(cid:62)v1 + 1(cid:62)v2
¯Hw + v1 − v2 = ¯F α
v1 ≥ 0, v2 ≥ 0,
Aα ≥ b .

Moreover, the value of each of these two programs coincide, i.e., µ(cid:63) = ϕ(cid:63).

Proof. See Appendix 1.2.

(24)

(25a)

(25b)

(cid:3)

It is worth noting the diﬀerence between the robust perspective of (23) versus the minimax program (24).
While in the design perspective of (23) the ﬁlter is oblivious to the possible attack scenarios, in the perspective
of (24) the ﬁlter is aware of the attack signal and opts to detect that particular signal in the presence of natural
disturbances. Obviously, the former setting is the one closer to the reality and, in general, the knowledge of
the attack signal should help the detection signiﬁcantly. This observation can indeed be translated through
the usual weak inequality of µ(cid:63) ≤ ϕ(cid:63). However, Theorem 4.7 indicates that the ﬁlter performance, in view
of the long-term behavior of the worst-case attack scenario, indeed does not depend on the exact knowledge
of the attacker signal and the inequality holds as the equality. We summarize this discussion in the following
remark.

Remark 4.8 (Nash equilibrium interpretation). If the linear programs (25a) (25b) admit a positive optimal
value ϕ(cid:63) = µ(cid:63) > 0, then the resulting ﬁlter can detect all the admissible multivariate attacks described by
Deﬁnition 2.5 along with a non-zero steady-state residual level. On the other hand, if the optimal values
coincide with ϕ(cid:63) = µ(cid:63) = 0, it then implies that there is no linear ﬁlter being able to decouple the admissible
attack with α(cid:63), the solution to (25b), from the natural disturbances in a long-term horizon.

5.1. Test system and diagnosis ﬁlter description

5. Numerical Results

In order to validate the eﬀectiveness of the diagnosis ﬁlter with application to power system cyber security,
we employed the IEEE 39-bus system which is well-known as a standard system for testing of new power
system analysis. As shown in Figure 2, this system consists of 3 areas and 10 generators where 7 of them

FROM STATIC TO DYNAMIC ANOMALY DETECTION

13

(a) Load disturbance and basic attack

(b) Load disturbance and stealthy attack

(c) Residual of static detector under basic attack

(d) Residual of static detector under stealthy attack

(e) Residual of dynamic detector under basic attack

(f) Residual of dynamic detector under stealthy attack

Figure 3. Static detector in (2) versus dynamic detector (diagnosis ﬁlter) from Corollary 4.4
under basic and stealthy attacks.

are equipped with AGC for frequency control. All the participating generators in each area are with equal
participation factors. The total load of the three-area system is 5.483 GW for the base of 100 MVA and 60 Hz.
The generator speciﬁcations and AGC parameters of each area are referred to [4], and the linear frequency
dynamics model has been developed in the preceding Section 3. Thus we result in a 19-order model in the
form of (4).

We apply the diagnosis ﬁlter proposed in Section 4 to detect multivariate disruptive attacks on the mea-
surements of AGC system. In the following simulations, we set the degree of the dynamic residual generator
dN = 3 which is much less than the order of the dynamics model, the sampling time Ts = 0.5 sec and the
ﬁnite time horizon 60 sec. To design the ﬁlter, we set the denominator in the form a(q) = (q − p)dN /(1 − p)dN
where p is a user-deﬁned variable acting as the pole of the transfer operator R(q), and it is normalized in
steady-state value for all feasible poles. The pole is set to be p = 0.8 for a stable dynamic behavior at the
beginning, and we have deployed the solver CPLEX to solve the corresponding optimization problems.

5.2. Simulation results

To evaluate the performance of the diagnosis ﬁlter, the disturbances di = ∆Pli are modeled as stochastic
load patterns. To capture its uncertainty, as shown in Figure 3a and Figure 3b, we mainly model ∆Pl1 in
Area 1 as random zero-mean Gaussian signals. It should be noted that tie-line power ﬂow measurements
are much more vulnerable to cyber attacks, comparing with frequency measurements (e.g., the anomalies in
frequency can be easily detected by comparing the corrupted reading with the normal one.) [5]. Therefore as
indicated in Figure 2 we mainly focus on the scenario that there are 5 vulnerable tie-line power measurements,
namely ∆Ptie1,2 , ∆Ptie1,3, ∆Ptie1 , ∆Ptie2,3 and ∆Ptie2. Recalling Deﬁnition 2.5 for stealthy attack basis,
thus there exist 3 basis vectors in the spanning set and we model them as follows: f1 = [0.1 0 0.1 0 0]T ,
f2 = [0.1 0.15 0.25 0 0]T , f3 = [0 0 0 0.1 0.1]T (all in p.u.). Here each basis vector lies in the range space

time(s)102030405060(p.u.)-1-0.500.5Disturbance∆Pl1FDIAttackftie1,2FDIAttackftie1FDIAttackftie2,3,ftie2time(s)102030405060(p.u.)-1-0.500.5Disturbance∆Pl1FDIAttackftie1,2FDIAttackftie1,3FDIAttackftie1FDIAttackftie2,3,ftie2time(s)0102030405060rS,tie100.020.04time(s)0102030405060rS,tie100.020.04time(s)0102030405060rD012time(s)0102030405060rD00.10.20.3FROM STATIC TO DYNAMIC ANOMALY DETECTION

14

of the output matrix that the corrupted measurements still align with an actual physical state, bypassing
the static detector rS[ · ]. Furthermore, without loss of generality we set A = 1(cid:62) and b = 1.5 in the set A
and η = 10 in the set N . The design variable ¯N of the robust residual generator is ﬁrst derived by solving
(18) through (LPi). The optimal value achieves maximum for i = 2 that γ(cid:63)
2 = 300, which implies a robust
detection during the transient behavior as Corollary 4.4. For the given ¯N , the multivariate attack coordinates
α = [2.8 1 − 2.3](cid:62) are obtained by solving the inner minimization of (18). Next, we look into the steady-state
behavior of the ﬁlter with the above sets N and A. For this, following Theorem 4.7 we solve (23) and (24)
It turns out that the derived optimal values satisfy the equality
through the programs (25a) and (25b).
ϕ(cid:63) = µ(cid:63) = 0, indicating that the optimal multivariate attack with α(cid:63), the optimizer of the program (25b)
and an optimal solution to (24), is a stealthy attack in the long-term horizon. We highlight that, thanks to
the fact that the optimal values of the programs (25a) (25b) form a Nash equilibrium, even with the exact
information of the stealthy attack coeﬃcients α(cid:63), we still cannot decouple the long-term behavior of the
residual from the natural disturbances; see Remark 4.8.

In the ﬁrst simulation, we begin with a general scenario where the multivariate attack is not carefully
coordinated, i.e., basic attack. Thus as shown in Figure 3a, only 4 of 5 vulnerable measurements are com-
promised that ftie1,2 = 0.38p.u., ftie1 = 0.53p.u., ftie2,3 = −0.23p.u. and ftie2 = −0.23p.u.. Note that since
the injected data on ∆Ptie1,2 and ∆Ptie1 are inconsistent, the static detector is also expected to be triggered.
To test the detectors in a more realistic setup, we also consider the presence of process and measurements
noises. The process noise term added to the state equation of Area 1 is zero-mean Gaussian noises with the
covariance matrix RX1 = 0.03 × diag([1 1 0.03 1 1 1 1](cid:62)), i.e., the covariance of the noise to the frequency is
0.009 and the covariance of other states’ noise is 0.03 [1]. Similarly, the measurement noise term added to
the measurements of Area 1 is with the covariance matrix RY1 = 0.03 × diag([1 1 1 0.03 1 1 1 1 1](cid:62)), i.e., the
covariance of the frequency measurement is 0.009 and the covariance of other measurements’ noise is 0.03 [1].
Note the residue rS of BDD in (2) becomes rS[k] = (I − C(C (cid:62)R−1
Y )Y [k] under the noisy system.
The attacks are launched at kmin = 30 sec. In Figure 3c and Figure 3e, results of the static detector in (2) and
the proposed dynamic detector (diagnosis ﬁlter) are presented. Both detectors have succeeded to generate a
diagnostic signal when attacks occurred, and the diagnosis ﬁlter residual rD is signiﬁcantly decoupled from
stochastic load disturbances, and keeps sensitive to the multivariate attacks for a successful detection under
noisy system settings.

Y C)−1C (cid:62)R−1

In the second simulation, to challenge the detectors, now the multivariate attacks have been launched
on all the 5 vulnerable measurements and the derived attack coeﬃcient α from the optimization results has
been used for a more intelligent adversary. Thus in Figure 3b, the corruptions become ftie1,2 = 0.38p.u.,
ftie1,3 = 0.15p.u., ftie1 = 0.53p.u., ftie2,3 = −0.23p.u. and ftie2 = −0.23p.u.. This corresponds to the worst
case for the diagnosis ﬁlter that the adversary is given the knowledge of the residual generator’s parameter ¯N
that it tries to minimize the payoﬀ function over A. Besides, the noisy system settings have been considered.
Figure 3d and Figure 3f demonstrate all the simulation results. In Figure 3d, the static detector becomes
totally blind to the occurrence of such an intelligent attack. However, as we can see in Figure 3f, even in
the worst case, the diagnosis ﬁlter works perfectly well under the noisy system, generate a residual “alert”
for the presence of multivariate attacks. We can also see that the residual output becomes close to zero
value again after a successful detection during the transient behavior in Figure 3f, which is consistent to
the aforementioned result ϕ(cid:63) = µ(cid:63) = 0 and Remark 4.8. These simulations also prove the eﬀectiveness and
robustness of the proposed diagnosis ﬁlter design.

FROM STATIC TO DYNAMIC ANOMALY DETECTION

15

5.3. Further discussions

In this section we elaborate several practical aspects of the proposed ﬁlter in the preceding section.

5.3.A. Diagnosis sensitivity to ﬁlter poles

While the denominator of the ﬁlter a(q) in (14) is chosen rather arbitrarily, up to a stability condition, the
poles however has a signiﬁcant impact on the residual sensitivity. As a general rule, the smaller the poles, the
faster the residual responds, and the more sensitive the residual responds to model imprecision and noises.
Simulation results in Figure 4 in Appendix 2.3 numerically illustrate this relation when the ﬁlter poles vary.

5.3.B. Other types of attacks

In addition to a smart multivariate measurement attacks, the main focus of this study, there are several

other types of attacks that we brieﬂy discuss in the following:

• Denial-of-service (DoS) attack: A type of availability attack where the attacker aims to prevent some

speciﬁc data from being delivered to the respective destinations.

• Replay attack: A two-stage attack where the adversary gathers a sequence of data packets at stage 1,

and then replays the recorded data afterwards at stage 2.

From a detection point of view, DoS attacks are trivially detectable without any sophisticated mechanisms
as the absence of data is not stealthy.
In the typical DoS attack modeling, the missing data is typically
replaced with the last received ones [31]. In such a mechanism, the DoS can be treated as an “injection”
attack. We investigate the performance of our ﬁlter in the presence of this class of attacks in Figure 5 in
Appendix 2.3. Numerical results conﬁrm that the proposed ﬁlter can successfully detect the DoS attacks. In
regard with the replay attack, the articles [22, 14] oﬀer suﬃcient conditions under which plausible attacks
may remain stealthy irrespective of the detection mechanism providing that the attacker has access all the
necessary data channels and excite attack of stage 2 at a suitable time.

5.3.C. Observer-based diagnosis ﬁlters

Another major technique for anomaly detection builds on observer-based techniques.

In this view, the
estimate of the system states, or in more general setting output observer, is a reference to alert the abnormal-
ity [11]. We close this section by a brief summary of the diﬀerences between these approaches and the one
proposed in this study.

• The observer-based approaches typically yield diagnosis ﬁlters with higher dynamical system degrees
than the approach proposed in this study. A low-order diagnosis ﬁlter is often more desired due to
practical aspects of online implementation particularly for large-scale power systems.

• Observer-based diagnosis ﬁlters usually rely on a precondition of system observability. An extended
version of such ﬁlters relaxes this condition to the so-called Luenberger-type conditions [2]. Our
diagnosis ﬁlter, however, requires a weaker condition reﬂected through the feasibility condition of the
resulting optimization programs, e.g., when the program (16) in Lemma 4.2 is feasible.

• Thanks to the optimization-based framework, unlike the observer-based approaches, we have a sys-

tematic approach to incorporate a multivariate attack scenario into the framework.

FROM STATIC TO DYNAMIC ANOMALY DETECTION

16

6. Conclusion

In this article, we investigated the problem of anomaly detection in the power system cyber security with a
particular focus on exploiting the dynamics information where tempering multiple measurements data may be
possible. Our study showed that a dynamical perspective to the detection task indeed oﬀers powerful diagnosis
tools to encounter attack scenarios that may remain stealthy from a static point of view. The eﬀectiveness
of this result was validated by simulations in the IEEE 39-bus system. Future research directions that we
envision include an extension to nonlinear systems, as well as a setting exposed to the “dynamic” (time-
variant) attacks in Remark 4.5, as opposed to the linear models and stationary attack scenarios studied in
this article.

Appendix I: Technical Proofs

1.1. Proof of Theorem 4.3

Let us recall that ¯N V (α) =

(cid:105)
, and as such, the payoﬀ function of the
robust reformulation (18) is J ( ¯N , α) = maxi |NiF Fbα| where i ∈ {0, · · · , dN }. By introducing an auxiliary
variable β in the simplex set B := {β ∈ R2dN +2 | β ≥ 0, 1(cid:62)β = 1}, one can rewrite J as

(cid:104)
N0F Fbα N1F Fbα · · · NdN F Fbα

J ( ¯N , α) = max
β∈B

dN(cid:88)

i=0

(β2i − β2i+1)NiF Fb.

In this light, the original robust strategy (18) can be equivalently described via

max
¯N ∈N

min
α∈A

max
β∈B

(cid:40) dN(cid:88)

(β2i − β2i+1)NiF Fbα

(cid:41)

.

i=0

Note that given a ﬁxed ¯N the inner minimax optimization is indeed a bilinear objective in the decision
variables and the respective feasible sets A and B are convex. Since one of the sets, B, is also compact, then
the zero-duality gap holds. Therefore, interchanging the optimization over α ∈ A and β ∈ B yields

(cid:40)

γ(cid:63) = max

¯N ∈N , β∈B

min
α∈A

dN(cid:88)

(β2i − β2i+1)NiF Fbα

(cid:41)

.

i=0

(26)

The inner minimization of (26) is a (feasible) linear program. We can use the duality again. To this end, let
us assume that the decision variables ¯N and β are ﬁxed and consider the Lagrangian function
(cid:16) dN(cid:88)

(cid:17)

L(α; λ) = b(cid:62)λ +

(β2i − β2i+1)NiF Fb − λ(cid:62)A

α,

where optimizing over an unconstrained variable α becomes

i=0

min
α

L(α; λ) =





b(cid:62)λ if






(β2i − β2i+1)NiF Fb = λ(cid:62)A

dN(cid:80)
i=0
λ ≥ 0

−∞ otherwise,

Using the above characterization as the most inner optimization program in (26) leads to

max
λ

s.t.

b(cid:62)λ
dN(cid:80)
i=0
λ ≥ 0.

(β2i − β2i+1)NiF Fb = λ(cid:62)A,

(27)

FROM STATIC TO DYNAMIC ANOMALY DETECTION

17

It then suﬃces to combine maximizing over the auxiliary variable λ together with the variables ¯N and β

to arrive at the main result in (19).

1.2. Proof of Theorem 4.7

We ﬁrst prove the convex reformulation. For a given ¯N ∈ N , the inner minimization of (23) can be

translated as

min
α∈A, r
s.t.

r

¯N ¯F α − r ≤ 0,
− ¯N ¯F α − r ≤ 0.

The Lagrangian of the inner minimization reads as

L(α, r; β, λ) = b(cid:62)λ + (cid:0)(β0 − β1) ¯N ¯F − λ(cid:62)A(cid:1)α + (1 − β0 − β1)r.

Optimizing over the variables α, r yields

min
α, r

L(α, r; β, λ) =






b(cid:62)λ if






(β0 − β1) ¯N ¯F = λ(cid:62)A
β0 + β1 ≤ 1
β0 ≥ 0, β1 ≥ 0, λ ≥ 0

−∞ otherwise.

Then, combining maximization over the auxiliary variables λ, β0, β1 together with the variable ¯N arrives at
the optimization program,

µ(cid:63) =

max
¯N , β0, β1, λ
s.t.

b(cid:62)λ

(β0 − β1) ¯N ¯F = λ(cid:62)A,
β0 + β1 ≤ 1, β0 ≥ 0, β1 ≥ 0,
¯N ∈ N , λ ∈ Rnb , λ ≥ 0.

(28)

Note that the actual program (25a) is a restriction of (28) where the variables β0 and β1 are restricted to
β0 = 1 and β1 = 0. Next, we show that this restriction is indeed without loss of generality. To this end,
1 , ¯N (cid:63), λ(cid:63)) is an optimal solution to the program (28). Note that the optimal variables
suppose the tuple (β(cid:63)
0 and β(cid:63)
β(cid:63)

1 may satisfy one of the following three properties:

0 , β(cid:63)

(i) β(cid:63)

(ii) β(cid:63)

(cid:48)

(cid:48)

0 = 1, β

1 : In this case, λ(cid:63) = 0, and therefore the optimal value µ(cid:63) = 0. This optimal solution can be

0 = β(cid:63)
trivially achieved in the program (25a) by setting ¯N = 0.
1 : Observe that the tuple (cid:0)β
0 > β(cid:63)
with the objective value b(cid:62)λ(cid:63)/(β(cid:63)
(0, 1], then this feasible solution has a possibly higher optimal value, and therefore β(cid:63)
is, β(cid:63)
0 < β(cid:63)
1 : Following similar steps as the previous case together with the symmetric property of the
feasible set N , one can show that the optimal value of the program (28) also coincides with the
restricted version in (25a).

1 )(cid:1) is a feasible solution
0 − β(cid:63)
1 ∈
1 = 1. That

1 ). Since b(cid:62)λ(cid:63) ≥ 0 by optimality assumption and β(cid:63)

0 = 1 and β(cid:63)

1 = 0, ¯N

= ¯N (cid:63), λ

= λ(cid:63)/(β(cid:63)

0 − β(cid:63)

0 − β(cid:63)

0 − β(cid:63)

1 = 0.

(cid:48)

(cid:48)

(iii) β(cid:63)

This concludes the proof of the convex reformulation from (23) to (25a).

In regard with the minimax
problem (24), let us recall the symmetric property of the feasible set N in the variable ¯N . With a ﬁxed α,
the inner maximization can be directly formed as max ¯N ∈N

¯N ¯F α whose Lagrangian becomes

L( ¯N ; v, w) = −(1(cid:62)v1 + 1(cid:62)v2) + (cid:0)w(cid:62) ¯H (cid:62) + v(cid:62)

1 − v(cid:62)

2 − ( ¯F α)(cid:62)(cid:1) ¯N (cid:62),

FROM STATIC TO DYNAMIC ANOMALY DETECTION

18

Optimizing over the variable ¯N leads to



L( ¯N ; v, w) =

min
¯N

−1(cid:62)v1 − 1(cid:62)v2

if

(cid:40) ¯Hw + v1 − v2 = ¯F α
v1 ≥ 0, v2 ≥ 0



−∞

otherwise.

Thus, combining minimization over the auxiliary variables v1, v2, w together with the variable α, the minimax
optimization (24) can be reformulated as the linear program (25b).

Finally, we show that the solution to programs (25) indeed forms a Nash equilibrium between the pro-
grams (23) and (24). Thus far, we have reformulated maximin and minimax problems as linear programs (25).
The idea is to show that these programs have the same optimal values. In fact, we show that the programs
are dual of each other, and that the strong duality holds when both programs are feasible. To this end, we
resort to the duality of (25a) with the Lagrangian
L( ¯N , λ; α, v, w) = (cid:0)w(cid:62) ¯H (cid:62) + v(cid:62)

2 − ( ¯F α)(cid:62)(cid:1) ¯N (cid:62) + (α(cid:62)A(cid:62) − b(cid:62))λ − (1(cid:62)v1 + 1(cid:62)v2).

1 − v(cid:62)

Optimizing over the variables ¯N , λ yields

L( ¯N , λ; α, v, w) =

min
¯N ,λ






−1(cid:62)v1 − 1(cid:62)v2

if






¯Hw + v1 − v2 = ¯F α
Aα ≥ b
v1 ≥ 0, v2 ≥ 0

−∞

otherwise.

It is not diﬃcult to see that the above program coincides with the program (25b); this concludes the proof.

Appendix II: System Parameters & Added Simulation Results

2.1. Dynamic Feedback Controller Modeling

Consider a dynamical system (e.g., the electrical power system studied in Section 3). Suppose the control

signal is implemented as a dynamic feedback controller described by the discrete-time dynamics

(cid:40) Xc[k + 1] = AcXc[k] + BcY [k],
u[k] = CcXc[k] + DcY [k],

where the input is the dynamical system measurements Y [ · ], the output the control signal u[ · ], and the
internal state of the controller is denoted by Xc ∈ Rnc . When an attack occurs on the measurements, it
aﬀects the dynamics of the controller and consequently the involved physical system. To study the control
dynamics together with the original dynamical system, one can augment the states of the system (3) together
with the controller’s as ˆX := [X (cid:62) X (cid:62)
c ](cid:62). Assuming that the control signal can also be measured, one can
also introduce an augmented measurement signals as ˆY = [Y (cid:62) u(cid:62)](cid:62). Following this procedure, the dynamics
of the closed-loop system is described by

(cid:40) ˆX[k + 1] = ˆAcl ˆX[k] + ˆBdd[k] + ˆBf f [k],

ˆY [k] = ˆC ˆX[k] + ˆDf f [k].

(29)

where the involved matrices are deﬁned as

(cid:34)

ˆAcl :=

Ax + BuDcC BuCc

(cid:35)

,

ˆBd :=

(cid:35)

(cid:34)

Bd
0

Ac

BcC

(cid:34)

ˆC :=

(cid:35)

,

C

0
DcC Cc

ˆDf :=

(cid:34)

Df
DcDf

ˆBf :=

(cid:34)

BuDcDf
BcDf

(cid:35)

,

,

(cid:35)

.

FROM STATIC TO DYNAMIC ANOMALY DETECTION

19

(a) Load disturbance and basic attack

(b) Load disturbance and stealthy attack

(c) Residual signal rD with pole p = 0.1

(d) Residual signal rD with pole p = 0.1

(e) Residual signal rD with pole p = 0.6

(f) Residual signal rD with pole p = 0.6

(g) Residual signal rD with pole p = 0.98

(h) Residual signal rD with pole p = 0.98

Figure 4. Results of dynamic detector (diagnosis ﬁlter) with diﬀerent poles (p =
0.1, 0.6, 0.98) under basic and stealthy attacks.

In this view, the augmented system (29) shares the same structure as (4) studied in the main part of the
article for the case of static feedback controller.

2.2. AGC Parameters of the three-area 39-bus system

In this subsection we provide the involved matrices and parameters of the three-area 39 system. We take

the model description of Area 1 in the three-area system in Figure 2 of Section 3 as an instance,

B1,d =

(cid:104)

0

0 − 1
2H1

0

0

(cid:105)(cid:62)
0

,

A11 =














0
0
− 1
2H1
0

0
0
− 1
2H1
0

0

0

−KI1 −KI1

T12
T13
− D1
2H1
1
Tch1,1 S1,1
1
Tch1,2 S1,2
−KI1B1

−

−

0
0
1
2H1
− 1

Tch1,1
0

0

0
0
1
2H1
0
− 1

Tch1,2
0














0
0
0
φ1,1
Tch1,1
φ1,2
Tch1,2
0

.

time(s)102030405060(p.u.)-1-0.500.5Disturbance∆Pl1FDIAttackftie1,2FDIAttackftie1FDIAttackftie2,3,ftie2time(s)102030405060(p.u.)-1-0.500.5Disturbance∆Pl1FDIAttackftie1,2FDIAttackftie1,3FDIAttackftie1FDIAttackftie2,3,ftie2time(s)0102030405060rD024time(s)0102030405060rD-10123time(s)0102030405060rD0123time(s)0102030405060rD00.20.40.6time(s)0102030405060rD00.20.4time(s)0102030405060rD00.010.02FROM STATIC TO DYNAMIC ANOMALY DETECTION

20

(a) ∆Ptie1,2 under DoS attacks from kdos = 30

(b) Residual signal rD under DoS attacks

Figure 5. Results of dynamic detector (diagnosis ﬁlter) under DoS attacks on ∆Ptie1,2 (p = 0.8).

As we have assumed a measurement model with high redundancy, the matrix Ci for Area 1 becomes

C1 =


1

0


0



0


0


0



1

0

0
1
0
0
0
0
1
0

0
0
1
0
0
0
0
0

0
0
0
1
0
0
0
1

0
0
0
0
1
0
0
1

(cid:62)


















0
0
0
0
0
1
0
0

.

In Area 1, the vulnerable measurements to cyber attacks are the ones of tie-line power ﬂows ∆Ptie1,2,

∆Ptie1,3 and ∆Ptie1. Thus the AGC signal ∆Pagc1 would be corrupted into

∆ ˙Pagc1 = −k1(B1∆ω1 + ∆Ptie1,2 + ftie1,2 + ∆Ptie1,3 + ftie1,3) .

Then the parameters regarding multivariate attacks are

(cid:104)

f1 =

ftie1,2

ftie1,3

ftie1

(cid:105)(cid:62)

,

D1,f =


1

0

0

0 0 0
1 0 0
0 0 0

0
0
0

0 0
0 0
0 1

(cid:62)






0
0
0

, B1,f =


0

0

0

0
0
0

0
0
0

0
0
0

(cid:62)






.

0 −k1
0 −k1
0

0

2.3. Additional simulation results

In Figure 4 we present the simulation results of the residual signal rD from the proposed diagnosis ﬁlter
under diﬀerent poles (p = 0.1, 0.6, 0.98, respectively). We also show the simulation results of the residual
signal rD from the proposed diagnosis ﬁlter under DoS attacks in Figure 5.

References

[1] A. Ameli, A. Hooshyar, E. El-Saadany, and A. Youssef, Attack detection and identiﬁcation for automatic generation

control systems, IEEE Transactions on Power Systems, (2018), p. 1.

[2] V. Andrieu and L. Praly, On the existence of a kazantzis–kravaris/luenberger observer, SIAM Journal on Control and

Optimization, 45 (2006), pp. 432–456.

[3] A. Ashok, M. Govindarasu, and V. Ajjarapu, Online detection of stealthy false data injection attacks in power system

state estimation, IEEE Transactions on Smart Grid, 9 (2018), pp. 1636–1646.

[4] H. Bevrani, Robust Power System Frequency Control, Power Electronics and Power Systems, Springer, 2008.
[5] C. Chen, K. Zhang, K. Yuan, L. Zhu, and M. Qian, Novel detection scheme design considering cyber attacks on load

frequency control, IEEE Transactions on Industrial Informatics, 14 (2018), pp. 1932–1941.
[6] T. M. Chen and S. Abu-Nimeh, Lessons from stuxnet, Computer, 44 (2011), pp. 91–93.

time(s)0102030405060∆Ptie1,2(p.u.)-0.2-0.100.10.2time(s)0102030405060rD00.51FROM STATIC TO DYNAMIC ANOMALY DETECTION

21

[7] C. Cybersecurity, Framework for improving critical infrastructure cybersecurity version 1.1, tech. rep., National Institute

of Standards and Technology, Apr. 2018.

[8] R. Deng and H. Liang, False data injection attacks with limited susceptance information and new countermeasures in

smart grid, IEEE Transactions on Industrial Informatics, (2018), p. 1.

[9] S. X. Ding, Model-based fault diagnosis techniques: design schemes, algorithms, and tools, Springer Science & Business

Media, 2008.

[10] X. Gao, X. Liu, and J. Han, Reduced order unknown input observer based distributed fault detection for multi-agent

systems, Journal of the Franklin Institute, 354 (2017), pp. 1464–1483.

[11] W. Ge and C.-Z. FANG, Detection of faulty components via robust observation, International Journal of Control, 47 (1988),

pp. 581–599.

[12] A. Giani, E. Bitar, M. Garcia, M. McQueen, P. Khargonekar, and K. Poolla, Smart grid data integrity attacks,

IEEE Transactions on Smart Grid, 4 (2013), pp. 1244–1253.

[13] S. Gorman, Electricity grid in US penetrated by spies, The Wall Street Journal, 8 (2009).
[14] A. Hoehn and P. Zhang, Detection of replay attacks in cyber-physical systems, in American Control Conference, 2016,

pp. 290–295.

[15] G. Hug and J. A. Giampapa, Vulnerability assessment of AC state estimation with respect to false data injection cyber-

attacks, IEEE Transactions on Smart Grid, 3 (2012), pp. 1362–1370.

[16] S. Li, Y. Yılmaz, and X. Wang, Quickest detection of false data injection attack in wide-area smart grids, IEEE Trans-

actions on Smart Grid, 6 (2015), pp. 2725–2735.

[17] G. Liang, S. R. Weller, J. Zhao, F. Luo, and Z. Y. Dong, The 2015 Ukraine blackout: Implications for false data

injection attacks, IEEE Transactions on Power Systems, 32 (2017), pp. 3317–3318.

[18] J. Liang, L. Sankar, and O. Kosut, Vulnerability analysis and consequences of false data injection attack on power

system state estimation, IEEE Transactions on Power Systems, 31 (2016), pp. 3864–3872.

[19] L. Liu, M. Esmalifalak, Q. Ding, V. A. Emesih, and Z. Han, Detecting false data injection attacks on power grid by

sparse optimization, IEEE Transactions on Smart Grid, 5 (2014), pp. 612–621.

[20] Y. Liu, P. Ning, and M. K. Reiter, False data injection attacks against state estimation in electric power grids, in 16th

ACM Conference on Computer and Communication Security, New York, 2009, pp. 21–32.

[21] M. A. Massoumnia, G. C. Verghese, and A. S. Willsky, Failure detection and identiﬁcation, IEEE Transactions on

Automatic Control, 34 (1989), pp. 316–321.

[22] Y. Mo and B. Sinopoli, Secure control against replay attacks, in 47th Annual Allerton Conference on Communication,

Control, and Computing, 2009, pp. 911–918.

[23] P. Mohajerin Esfahani and J. Lygeros, A tractable fault detection and isolation approach for nonlinear systems with

probabilistic performance, IEEE Transactions on Automatic Control, 61 (2016), pp. 633–647.

[24] P. Mohajerin Esfahani, M. Vrakopoulou, K. Margellos, J. Lygeros, and G. Andersson, Cyber attack in a two-area

power system: Impact identiﬁcation using reachability, in American Control Conference, 2010, pp. 962–967.

[25] M. Nyberg and E. Frisk, Residual generation for fault diagnosis of systems described by linear diﬀerential-algebraic

equations, IEEE Transactions on Automatic Control, 51 (2006), pp. 1995–2000.

[26] K. Ogata, Discrete-time Control Systems (2Nd Ed.), Prentice-Hall, Inc., Upper Saddle River, NJ, USA, 1995.
[27] K. Pan, A. Teixeira, M. Cvetkovic, and P. Palensky, Cyber risk analysis of combined data attacks against power system

state estimation, IEEE Transactions on Smart Grid, (2018), p. 1.

[28] E. Rakhshani, D. Remon, A. M. Cantarellas, J. M. Garcia, and P. Rodriguez, Virtual synchronous power strategy
for multiple hvdc interconnections of multi-area agc power systems, IEEE Transactions on Power Systems, 32 (2017),
pp. 1665–1677.

[29] D. Sahabandu, S. Moothedath, L. Bushnell, R. Poovendran, J. Aller, W. Lee, and A. Clark, A game theo-
retic approach for dynamic information ﬂow tracking with conditional branching, in American Control Conference, 2019,
pp. 2289–2296.

[30] D. Sahabandu, B. Xiao, A. Clark, S. Lee, W. Lee, and R. Poovendran, Dift games: Dynamic information ﬂow
tracking games for advanced persistent threats, in IEEE Conference on Decision and Control, Dec. 2018, pp. 1136–1143.
[31] L. Schenato, To zero or to hold control inputs with lossy links?, IEEE Transactions on Automatic Control, 54 (2009),

pp. 1093–1099.

[32] P. Shukla, A. Chakrabortty, and A. Duel-Hallen, A cyber-security investment game for networked control systems,

in American Control Conference, 2019, pp. 2297–2302.

[33] A. Teixeira, S. Amin, H. Sandberg, K. H. Johansson, and S. S. Sastry, Cyber security analysis of state estimators in

electric power systems, in IEEE Conference on Decision and Control, 2010.

FROM STATIC TO DYNAMIC ANOMALY DETECTION

22

[34] E. E. Tiniou, P. Mohajerin Esfahani, and J. Lygeros, Fault detection with discrete-time measurements: An application

for the cyber security of power networks, in IEEE Conference on Decision and Control, 2013.

[35] J. Zhao, L. Mili, and M. Wang, A generalized false data injection attacks against power system nonlinear state estimator

and countermeasures, IEEE Transactions on Power Systems, (2018), p. 1.

