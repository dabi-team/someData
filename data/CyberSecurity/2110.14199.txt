1
2
0
2

v
o
N
9
1

]

Y
S
.
s
s
e
e
[

2
v
9
9
1
4
1
.
0
1
1
2
:
v
i
X
r
a

Arbitrarily Fast Switched Distributed Stabilization of Partially
Unknown Interconnected Multiagent Systems:
A Proactive Cyber Defense Perspective

Vahid Rezaei⋆, Jafar Haadi Jafarian⋆, and Douglas C. Sicker⋆†

Abstract

A design framework recently has been developed to stabilize interconnected multiagent systems in a distributed
manner, and systematically capture the architectural aspect of cyber-physical systems. Such a control theoretic
framework, however, results in a stabilization protocol which is passive with respect to the cyber attacks and
conservative regarding the guaranteed level of resiliency. We treat the control layer topology and stabilization
gains as the degrees of freedom, and develop a mixed control and cybersecurity design framework to address
the above concerns. From a control perspective, despite the agent layer modeling uncertainties and perturbations,
we propose a new step-by-step procedure to design a set of control sublayers for an arbitrarily fast switching of
the control layer topology. From a proactive cyber defense perspective, we propose a satisﬁability modulo theory
formulation to obtain a set of control sublayer structures with security considerations, and offer a frequent and
fast mutation of these sublayers such that the control layer topology will remain unpredictable for the adversaries.
We prove the robust input-to-state stability of the two-layer interconnected multiagent system, and validate the
proposed ideas in simulation.

I. INTRODUCTION

In response to the advances in embedded sensing, computation, and wireless communication, multiagent and
cyber-physical systems (MASs and CPSs) have attracted signiﬁcant attention during the past two decades. The
preliminary studies in the literature of MASs were mainly focused on the simple integrator or linear time-invariant
(LTI) agent models in order to achieve consensus in MASs, by creating a meaningful connection between control
and graph theories [1]. Later, this attention was shifted toward more complicated models, e.g., with (completely
known) interconnected LTI agents [2], and noninterconnected agents subject to local (agent-level) modeling
uncertainties [3].

In parallel to the above studies, [4] articulated the concept of a multilayer control structure according to a
graph theoretic consensus viewpoint. It provides an appropriate foundation to study the control aspects of the
increasingly important CPSs [5]. Based on a completely known MAS of interconnected single integrators, [6]
reported a graph theoretic formulation to capture the architectural aspect of CPSs. Nevertheless, a CPS might
be subject to various cyber and physical abnormalities to be addressed using a mixed control and cybersecurity
framework (e.g., see [7] and [8]).

From a control perspective, after a few preliminary studies, [9] proposed a mixed control and graph theoretic
framework to stabilize an interconnected MAS in a distributed manner. That design framework, in particular,
enables a designer to capture the architectural aspect of (single or multiagent) CPSs with separate agent (physical)
and control (cyber) layers. Nevertheless, while robust with respect to the modeling uncertainties, that approach
does not guarantee the stability of interconnected MAS in the presence of cyber attacks.

Reference [10] developed another distributed stabilization protocol to simultaneously guarantee a level of
resiliency against the denial of service (DoS) attacks over the control layer, and robustness with respect to the
modeling uncertainties over the agent layer. That method is based on the concept of average dwell time, which
is known to be conservative, e.g., according to section IV in [11]. Moreover, it is not straightforward to expand
the theoretical side of that work to a distributed DoS scenario, when an attacker persistently blocks (multiple)
individual communication links, instead of blocking the control layer communications for short periods of time in
a centralized manner [10]. It is possible to reduce the conservatism using a mode-dependent average dwell time

⋆ V. Rezaei, J. H. Jafarian, and D. Sicker are with the Department of Computer Science and Engineering, University of Colorado,

Denver, CO 80204, USA, Emails: firstname.lastname@ucdenver.edu.

† D. Sicker is with the Department of Electrical Engineering, University of Colorado, Denver, CO, USA.

1

 
 
 
 
 
 
formulation [12] and expand that to a distributed DoS attack scenario. Nevertheless, such purely control-oriented
viewpoints mainly are suitable for the resiliency analysis of a readily compromised systems, or are passive or
reactive with respect to the attacks (with no reaction to the attacks, or with a conservative reaction only after the
time that an attack is detected).

In the literature of computer science, the above issues have been addressed by cyber resilience or agility
techniques, which proactively (without any indication of the attack) change the network communication paths in
order to make the routing topology unpredictable and, therefore, rescue the attacked trafﬁc [13]-[15]. Via such
route randomization or multipath routing, it is shown that the these cyber agility techniques raise the network
infrastructures’ bar against attacks, such as the distributed DoS attack, which is the focus of this paper. Such a
moving target defense concept recently has attracted interest in the control systems community. We refer to [16]
and [17] for single dynamical systems. In particular, focusing on a control design problem, [17] relies on the
redundancy in the physical components of the underlying system and its moving target defense idea is based on
an average dwell time condition, which would be conservative (see the previous paragraph). Also, [18] relies on
the closed-loop system matrices of the completely known LTI (single dynamical) systems, and its MAS-related
analysis is based on the decoupled second-order agents, which will not be applicable to the design problem for
a more general MAS in Section III (with high-order interconnected agents subject to the nonlinear modeling
uncertainties).

We propose a new design framework that synergistically combine the cybersecurity and control algorithms in
order to effectively handle the multitude of cyber and physical challenges for interconnected MASs. Namely, for a
fully heterogeneous interconnected MAS, we consider the modeling uncertainties and nonvanishing perturbations
over the agent layer, and distributed DoS attacks over the control layer. From a control viewpoint, we broaden
the design aspect to an arbitrarily fast switched distributed stabilization protocol, while capturing the architectural
aspect of CPSs (to separately study the cybersecurity concerns). From a cybersecurity viewpoint, we propose a
control-aware satisﬁability modulo theory (SMT) formulation to develop a set of control layer (communication)
subgraphs that satisfy multiple security constraints. We further rely on the arbitrarily fast switching capability
of our design in order to secure the control layer communication against distributed DoS attacks, via a highly
frequent mutation between the alternative control sublayers. In particular, unlike [10] and [19], we do not restrict
the class of (persistent) DoS attacks by any average dwell time means. To validate the feasibility of the proposed
proactive cyber defense strategy, we theoretically prove the robust input-to-state stability (ISS) of the two-layer
interconnected MAS (with its cybersecurity-aware control sublayer topologies) and, in simulation, discuss its
effectiveness in the presence of the distributed DoS attacks.

In the rest of this paper, we overview a few deﬁnitions (Section II), propose the main results (Section III),

discuss a simulation study (Section IV), and summarize the paper (Section V).

II. PRELIMINARIES

We use 0 to denote a matrix of all zeros with compatible dimension, diag{.} a (block) diagonal matrix of
the elements in {.}, col{xi} an ordered column vector of xi ∈ Rn for a set of i, k.k the (induced) 2-norm of
its input vector (matrix), ⊗ Kronecker product, and A ≻ B ( ¯V ≻ 0) a positive deﬁnite matrix A − B ∈ Rn×n
(scalar function ¯V ). Also, < indicates positive semi-deﬁniteness. We propose two graph topologies Ga and Gc
which admit selﬂoops (i.e., an edge that goes out and returns to the same node without passing others), unlike
traditional cases [20], and can be disconnected.

ij 6= 0 if the ith agent is affected by the jth agent’s dynamics for i, j ∈ {1, 2, ..., N }, and aa

An agent layer digraph Ga with N nodes represents the physical interaction of agents’ dynamics. It is
ij] ∈ RN ×N where N ≥ 1 is the total number of
characterized by a modiﬁed adjacency matrix Aa = [aa
agents, aa
ij = 0
otherwise. Compared to the standard deﬁnition, selﬂoops j = i are admitted, and both positive and negative signs
ij. Information about all agent-layer neighbors of an agent i, including the ith agent if there
are acceptable for aa
is a selﬂoop, is given by a set N a
i . Only a scalar kAak is shared with the control layer designer, such that the
interconnection topology (structure and edge weights) remains conﬁdential. It enables a designer to eliminate the
predictability of the control layer topology, to be discussed in the ﬁrst paragraph of Subsection III-B.

2

A control layer is built by M ≥ 1 control sublayer(s), to be determined by a piecewise constant switching
signal σ ∈ {1, 2, ..., M }. Each control sublayer’s undirected graph Gcσ is represented by a modiﬁed Laplacian
ij ] ∈ RN ×N where i, j ∈ {1, 2, ..., N }, hcσ
matrix Hcσ = [hcσ
denotes
the neighbor set of the control node i (without selﬂoops), acσ
i > 0 selﬂoop weights of
control node i (scσ
c can be disconnected;
however, there is at least one selﬂoop in each connected component of Gσ
c . Consequently, all eigenvalues of Hcσ
are real-valued positive scalars to be sorted as 0 < µσ1 ≤ µσ2 ≤ ... ≤ µσN [9]. We use both structure and
weights (i.e., topology) of each subgraph Gcσ as the design degrees of freedom in Subsections III-B and III-C.
In particular, G01

i = 0 if there is not a selﬂoop). Each (ﬁxed) control sublayer topology Gσ

cσ abstracts the structure of Gcσ, to be determined using the cybersecurity Algorithms 1 and 2.

ij = −acσ
j∈N cσ
ij ≥ 0 edge weights, and scσ

ij , and hcσ

ij + scσ
acσ
i

, N cσ
i

ii =

P

i

We let {tk}k∈Z≥0 be the switching time sequence for σ(t), and assume that there exists a dwell time τd > 0
such that multiple switchings will not happen at the same time: infk∈Z≥0(tk+1 − tk) ≥ τd, the adjacent switching
intervals [tk, tk+1) do not have overlaps, and the control sublayer Gcσ remains ﬁx during each switching time
interval. Unlike [11] and [12], we neither restrict the length of τd by any means nor use it in the derivations of
this paper.

Over a control layer, selﬂoops determine the control layer conﬁguration (see subsection 3.1 in [21]). Over
an agent layer, selﬂoops model local or agent-level modeling uncertainty when an agent’s modeling uncertainty
depends on its own state variables (see the description of agents (1)).

In this section, we lay the foundation of this paper (Subsection III-A), develop a new framework to design
and validate a control layer (Subsections III-B and III-C), and provide a theoretical analysis for the proposed
two-layer (closed-loop) interconnected MAS (Subsection III-D).

III. MAIN RESULTS

A. Problem Foundation

We consider an MAS of N interconnected agents:

˙xi(t) = Aixi(t) + Buiui(t) + Bfifi(yi(t), t) + Bdidi(t)
yi(t) = Cyi

aa
ijxj(t)

j∈N a
i

(1)

P

where i ∈ {1, 2, ..., N } denotes the agent number; xi ∈ Rnx state variable of agent i; ui ∈ Rnu control input;
di ∈ Rnd nonmeasurable, nonvanishing, external perturbation (disturbance or process noise); and yi ∈ Rny
interconnection variable. The known Ai ∈ Rnx×nx is the ith agent’s system matrix, Bui ∈ Rnx×nu control
allocation matrix, Bdi ∈ Rnx×nd perturbation allocation matrix, and Bfi ∈ Rnx×ng uncertainty allocation matrix.
Each pair (Ai, Bui) represents a stabilizable system, and Bdi and Bfi can be in the range space of Bui (matched
scenario) or not (unmatched scenario). This enables a designer to model an MAS subject to the mixed matched
and unmatched modeling uncertainties.

The unknown interconnection matrices Cyi ∈ Rny×nx satisfy the norm conditions kCyik2 ≤ γcyi. The nonlinear
functions fi : Rny ×R≥0 → Rng satisfy Lipschitz condition to ensure the existence and uniqueness of the solutions
to the nonlinear differential equations (1) [22]. To avoid a conservative Lipschitz-based stabilization approach, we
assume that each nonlinear function satisﬁes a norm condition f T
i yi. We also assume that
only two constants, γcy = maxi(γcyi) > 0 and γf = maxi{γfi} > 0, are known to the control layer designer. (A
Lipschitz constant satisﬁes this norm condition; however, it would end in a larger (more conservative) constant
compared to γf .)

i (yi, t)fi(yi, t) ≤ γfiyT

Model (1) enables us to consider an interconnected MAS subject to both agent-level modeling uncertainties
i ) and MAS-level modeling uncertainties (via non-
(over agent layer)

ii over the agent layer: i ∈ N a
ij: j 6= i and j ∈ N a

i ), because the agents’ neighbor sets N a
i

(via selﬂoops with unknown aa
selﬂoop edges with unknown aa
are unknown.

We propose the following communication-based, switched distributed stabilization protocol:

ui(t) =

(cid:0) Xj∈N cσ(t)

i

acσ(t)
ij

(vi(t) − vj(t)) + scσ(t)

i

vi(t)
(cid:1)

(2)

3

in which each virtual stabilization signal vi is locally computed by the associated agent i:

vi(t) = Kixi(t)

where Ki ∈ Rnu×nx denotes the ith agent’s stabilization gain, to be designed.

We aggregate the interconnected agents (1) for all i ∈ {1, 2, ..., N } to ﬁnd a model of the agent layer:

˙x(t) = ¯Ax(t) + ¯Buu(t) + ¯Bf f (y, t) + ¯Bdd(t)
y(t) = ¯Cy(Aa ⊗ Inx)x(t)

(3)

(4)

where ¯A := diag{Ai}, ¯Bu := diag{Bui}, ¯Bf := diag{Bfi}, ¯Bd := diag{Bdi }, ¯Cy := diag{Cyi}, x := col{xi},
u := col{ui}, d := col{di}, y := col{yi}, and f := col{fi}. We also aggregate the distributed stabilization
protocols (2) for all i, and reach to the following model of the switched control layer (with multiple sublayers):

u(t) = (Hcσ(t) ⊗ Inu)v(t)
where v := col{vi} := ¯Kx, and ¯K := diag{Ki}. Now we are ready to articulate the main objective of this paper.
(See [23] for the deﬁnitions of comparison functions and ISS.)

(5)

Objective: In the presence of modeling uncertainties and nonvanishing perturbations (over agent layer) and
distributed DoS attacks (over control layer), design a distributed protocol to guarantee both robust ISS and
proactive security for a two-layer (closed-loop) interconnected MAS (4) and (5):

kx(t)k ≤ β(kx(0)k, t) + κ(kd(t)k∞)

(6)

for K L -function β, K∞-function κ, and d ∈ L∞(R≥0).

Modiﬁed based on [23] and [24], we also deﬁne a common ISS Lyapunov function to prove robust distributed

ISS in Subsection III-D.

Deﬁnition 1: A function ¯V : Rn → R≥0 is a smooth, common ISS Lyapunov function for the two-layer

interconnected MAS (4) and (5) if the following inequalities are satisﬁed:

κ1(kxk) ≤ ¯V (x) ≤ κ2(kxk)

˙¯V (x) ≤ −κ3(kxk) + γ(kdk)

for all σ ∈ {1, 2, ..., M }, and for K∞ functions κ1, κ2, κ3, and γ.

◭

B. Control Layer Design Framework: Stabilization

In order to go beyond the ideas of [10] and establish proactive cyber defense, we propose a design procedure

to simultaneously:

1) make the control layer (communication) topology independent of the agent layer (interconnection) topology,

i.e., to capture the architectural aspect of CPSs, and

2) reconﬁgure the control layer topology in an arbitrarily fast manner.
Note that at least a subset of communication links would be predictable when a known agent layer topology
is included in the control layer topology [19], or if we follow the (average dwell time-based) resiliency bounds
in [10] and create a slow-varying switching signal. Instead, we propose the following design procedure to develop
a control layer with an arbitrarily fast switching of multiple sublayers (Modiﬁed from [12] and [25] to develop
a “common” ISS Lyapunov function in Subsection III-D).

Design Procedure 1: (A mixed optimal control and graph theoretic formulation)

1) For each control sublayer σ ∈ {1, 2, ..., M }, develop a control layer graph topology Gcσ based on a
ij > 0 to a graph

i > 0 to deﬁne selﬂoops, and assign N cσ
i

cooperativeconﬁguration: Set a few scσ

and acσ(t)

4

in which each connected component has a control node with a selﬂoop. Let µmin := minσ{µσ1} > 0
where µσ1 is the smallest (positive) eigenvalue of Hcσ associated to each Gcσ.
2) For each agent i ∈ {1, 2, ..., N }, design a candidate robust ISS gain Ki as follows:

a) Let Qi ∈ Rnx×nx and Ri ∈ Rnu×nu be two positive deﬁnite design matrices, and Qf i = Qi + Rf a
modiﬁed state weighting matrix where Rf = (af γf γcykAak2 + ad)Inx for two positive design scalars
af and ad.

b) Find the optimal solution v′

i = Kix′

i ∈ Rnu of the following modiﬁed linear quadratic regulator (LQR)

problem:

minv′
i∈Ci
subject to

∞

i Qf ix′
0 (x′T
i = Aix′
˙x′
R

i Riv′
i + v′T
i)dτ
i + µminBuiv′
i

in which Ci is the set of all static linear state feedback stabilizing signals v′
dynamics ˙x′

i + µminBuiv′
i.

i = Aix′

i for the networked nominal

3) Gcσ and Ki build a set of valid control sublayers if the following condition is satisﬁed:

¯Qvσ := ¯Q + ¯K T

¯R + 2 ¯R ¯Ecσ

¯K −

(cid:0)

(cid:1)

1
af

¯P ¯Bf ¯BT
f

¯P ≻ 0

(7)

and ¯Q := diag{Qi}, ¯R := diag{Ri}, ¯P := diag{Pi}, and ¯Ecσ :=
< 0. The matrices
Pi ∈ Rnx×nx are the unique positive deﬁnite solutions of the following algebraic Riccati equations (AREs):

− IN ) ⊗ Inu

( Hcσ
µmin

(cid:1)

AT

i Pi + PiAi + Qf i − µ2

(cid:0)
minPiBuiR−1
i BT

uiPi = 0.

(8)

The term “modiﬁed” highlights the required modiﬁcations to obtain a state weighting matrix Qf i and the pres-
ence of µmin in the networked nominal dynamics of the modiﬁed LQR formulation. The existence and uniqueness
of the solutions Pi are guaranteed by the stabilizability and observability of the triple ((Qf i)1/2, Ai, µminBui)
where ((Qf i)1/2)T (Qf i)1/2 = Qf i, pointing out that each (Ai, µminBui) is stabilizable due to that of (Ai, Bui)
and positiveness of µmin. We recommend to develop a set of control sublayers Gcσ (or Hcσ) with sufﬁciently
positive µmin in order to avoid controllability issues in the modiﬁed LQR problems (or, equivalently, singularity
in AREs (8)).

Remark 1: Arbitrarily fast switching has already been used in the literature of MASs. However, to the best of
our knowledge, the existing studies should be limited to the consensus (vs. stabilization) problem for completely
known, homogeneous, or purely LTI MASs with noninterconnected dynamics (e.g., see [26]). Such developments
◭
are not necessarily applicable to the considered problem in this paper.

C. Control Layer Design Framework: Cybersecurity

In the previous subsections, we proposed a switched distributed stabilization protocol (2) with all stabilization
gains and control sublayer topologies as the design degrees of freedom, and developed a step-by-step procedure
to design and validate a set of control sublayers for the robust ISS of a two-layer interconnected MAS (4) and (5)
with an arbitrarily fast switching. Together with a control-oriented recommendation at the end of the previous
subsection, the Step 1 of that procedure gives insights to determine a control layer conﬁguration from a large-
scale system viewpoint [27]. To better leverage the power of the proposed distributed stabilization protocol (2),
along the Step 1 of Design Procedure 1, we propose a new formulation to determine a set of candidate control
sublayer structures that simultaneously satisfy multiple cybersecurity and distributed control constrains:

1) Full connectivity: To ensure that the conditions of the control subgraphs in Section II are satisﬁed, while
taking into account the agents’ capability or willingness to provide their absolute measurements to the
control layer (e.g., see subsection 3.1 and section 5 in [21]).

2) Centrality distribution: To have a sufﬁcient number of active selﬂoops to reduce attack vulnerability by

avoiding a single point of failure over the control layer.

5

3) Non-overlappingpaths: To ensure that an attacker will not be able to compromise multiple control sublayers
by a single attack on a common inter-controller communication link (i.e., to increase the cost of attack).
4) Low risk: By excluding the high risk communication links that have been compromised in the recent past.

Note that these conditions would naturally disqualify centralized (with all-to-all) and decentralized (with only
selﬂoops) conﬁgurations from the Step 1 of Design Procedure 1. Further, the above planning is a generalization
of the 0-1 knapsack problem [28], which is NP-hard. Therefore, we reformulate it as a satisﬁability problem
using a generalized Boolean/arithmetic logic of SMT [29]. (While satisﬁability problems are NP-complete in
general, the recent advances in SMT solvers have made them scalable to the problems with millions of variables
[30].)

cσ = (V, E 01
ij ∀ (i, j) ∈ V × V} edge set over each G01

In conjunction with the Step 1 of Design Procedure 1, we propose Algorithm 1 to generate a set G 01
cσ ), where V = {1, 2, . . . , N } denotes the node set and E 01
cσ. The edge weights αcσ

cσ of
M control sublayer structures G01
cσ =
{αcσ
ij of this outcome graph are either 1 when
an edge is determined by the proposed algorithms, or 0 otherwise. Further, to introduce fewer parameters in this
subsection, we use αcσ
to denote the existence of a selﬂoop around any node i. These two points are unlike the
ii
i ∈ R≥0 for the ﬁnal Gcσ (see Section II). An integer-valued T
deﬁnitions of (real-valued) acσ
denotes the number of the nodes that are required to have selﬂoops (i.e., for the centrality distribution). Each
integer-valued scalar θi ∈ {0, 1} determines whether we can add a selﬂoop to a node i and use the absolute
measurement of that agent, or not. Each integer-valued scalar rij ∈ {0, 1} indicates whether a link (i, j) (therefore,
(j, i)) is a high risk link or not. Further, each integer-valued scalar ηij ∈ {0, 1} memorizes whether a link (i, j)
(therefore, (j, i)) has been inactive in all prior control sublayer graphs or not, i.e., an ηij = 1 means that link
has not been used previously.

ij ∈ R≥0 and scσ

Based on a logic (notation) similar to the standard SMT references, e.g., [29], Algorithm 2 describes the
proposed SMT formulation to generate a candidate control sublayer structure G01
cσ that satisﬁes the aforementioned
user-deﬁned conditions 1 to 4. In particular, we ﬁrst consider a directed (sub) graph design problem, in order
to determine the communication paths over each control sublayer. Constraint (9) ensures the soundness of the
resulting control layer subgraphs, by limiting all integer-valued αcσ
ij to either 0 or 1. Constraint (10) ensures only
the nodes with selﬂoop capability will be asked to share their absolute measurements over the control sublayers
(see subsection 3.1 in [21]). Constraint (11) ensures that T nodes in the outcome sublayer graph will have active
selﬂoops (to avoid a single point of failure). Constraint (12) ensures that all the high-risk, recently compromised
communication links (known based on the history of the underlying two-layer interconnected MAS) will be
excluded from the control layer. Constraint (13) ensures that any link which has been used in the prior control
sublayers (developed by the proposed algorithm) will not be used in the new sublayer graph. Constraint (14)
ensures that any node without an active selﬂoop will be connected to a node with an active selﬂoop (either

Algorithm 1: generateAllGraphs
Inputs: M , N , T , {θi}, {rij}
Output: G 01
cσ
%initialization
V = {1, . . . , N }
for every (i, j) ∈ V × V do

ηij = 0

%Generate all (sub) graphs
for σ = 1 to M do

G01
cσ = generateOneGraph(V, T, {rij}, {θi}, {ηij }, σ)
G 01
cσ = G 01
cσ ∪ G01
cσ
for every (i, j) ∈ V × V, i 6= j do

ηij = ηij ∨ ¬αcσ
ij

6

Algorithm 2: generateOneGraph
Inputs: V, T, {rij}, {θi}, {ηij}, σ
Output: G01
cσ
%Define SMT model Λ, with following constraints

0 ≤ αcσ

ij ≤ 1,

αcσ

ii ≤ θi,
αcσ

ii = T

Xi∈V

αcσ
αcσ

ij ≤ rij
ij ≤ ηij ,

∀(i, j) ∈ V × V

∀i ∈ V

∀(i, j) ∈ V × V

∀(i, j) ∈ V × V

ij = 1) ∧ (αcσ
(αcσ
∀i, ∀j 6= i, ∀k 6= j

jk = 1) → (αcσ

kk = 1) ∧ (αcσ

jj = 0)

αcσ

ij = 1,

Xj∈V

∀i ∈ V

%Solve the SMT model
{αcσ
ij } = solveSMTModel(Λ)
%Build a symmetric (sub) graph structure
αcσ
ji = 1,
E 01
cσ = {αcσ
cσ = (V, E 01
G01
cσ )

ij = 1
ij ∀(i, j) ∈ V × V}

∀αcσ

(9)

(10)

(11)

(12)

(13)

(14)

(15)

directly or via an intermediary node). Constraint (15) ensures that every node has either an active selﬂoop or
has a path to (receive information from) exactly one node with an active selﬂoop. A solver solveSM T M odel(.)
(e.g., see [29]) determines the satisﬁable assignments to the unknown variables for an SMT model Λ, in order
to obtain the active communication links. Finally, an edge set E 01
cσ is built, in order to offer the structure of a
symmetric control sublayer G01

cσ with undirected communication links.

The exclusion of high risk links enhances the resilience of the control layer to the potential distributed DoS
attacks. However, we ensure the cyber agility via a consistent mutation of the control sublayers (see Design
Procedure 1, and Algorithms 1 and 2) based on an arbitrarily fast switching strategy. Such an arbitrarily fast and
unordered switching would turn a control layer’s communication links (or topology) into a set of unpredictable
moving targets. Next to the fact that the candidate sublayers have no common inter-controller communication
link, 1) it would be hard(er) for an attacker to study the underlying two-layer interconnected MAS in order to plan
and execute a distributed DoS attack, and 2) a distributed DoS attack that targets a speciﬁc set of inter-controller
communications in any one of these candidate sublayers, will not be effective against others.

We need to mention that the proposed SMT formulation is based on the notion of directed subgraphs, which
would end in the structurally nonsymmetric control sublayers (see [11] and [21]). We manually set αcσ
ji = 1 if the
SMT solver assigns αcσ
ij = 1 to a pair (i, j) ∈ V × V, in order to build a control sublayer graph with undirected
communication links. This viewpoint is along the practices in computer science, where the computer networks’
communication links are full-duplex. We also need to mention that the proposed SMT formulation determines
the structure G01
cσ of a control sublayer topology Gcσ. We manually select the weights of edges and selﬂoops, and
design a set of distributed stabilization gains, such that the validation condition (7) is satisﬁed. Expanding the
high-dimension approach in [31] (limited to the ﬁrst and second order agents) to the agent model (1), an interested
reader might be able to combine that high-dimension modiﬁed LQR formulation with the low-dimension one in

7

Step 2 of Design Procedure 1 in order to automatically determine a set of robust edge weights and selﬂoops
based on the subgraph structures of Algorithms 1 and 2.

D. Theoretical Analysis

In this subsection, we derive a few key properties of the proposed design framework, and analyze ISS for
the resulting two-layer interconnected MAS (4) and (5) with a security-oriented, arbitrarily fast switching of the
control sublayers.

Analytically, we know that the stabilization gains Ki are characterized as follows [32]:

Ki = −µminR−1

i BT

uiPi.

(16)

We aggregate each (8) and (16), and further ﬁnd ¯AT ¯P + ¯P ¯A + ¯Qf − µ2

¯P = 0 and ¯K +
µmin ¯R−1 ¯BT
¯P = 0 where ¯Qf := diag{Qf i}. We postmultiply both of the above equalities by x, premultiply
u
the second one by xT , and after a few manipulations ﬁnd the following design properties for each ﬁxed control
sublayer (known as the optimality conditions in the literature of optimal control for single dynamical systems
[32]).

¯P ¯Bu ¯R−1 ¯BT
u

min

Design Properties 1: The following equalities hold for each control sublayer of Design Procedure 1 and

Algorithms 1 and 2, to be used in a two-layer interconnected MAS (4) and (5):

xT ¯Qf x + vT ¯Rv + ¯V T

2vT ¯R + µmin ¯V T
¯Bu =0
x
x ( ¯Ax + µmin ¯Buv) =0.

x := ∂ ¯V

where V T

∂x and ¯V (x) := xT ¯P x.
Now we propose the main result of this subsection.
Theorem 1: If Gcσ and Ki are developed according to Subsections III-B and III-C, robust ISS is guaranteed
for the interconnected MAS (4) and (5) despite the modeling uncertainties and nonvanishing perturbations over
the agent layer, and arbitrarily fast switching of the control layer (communication) topology.

◭

Proof : To facilitate the derivations of this proof, we ﬁrst substitute the control layer (5) in the agent layer
dynamics (4), add and subtract µmin ¯Buv, and rewrite the two-layer interconnected MAS of this paper as follows:

+ ¯Bf f (y) + µmin ¯Bu ¯Ecσv + ¯Bdd

(17)

Uncertainties and perturbations over Ga and Gc
}
{z

|

in which ¯Bdd represents the nonvanishing perturbations and ¯Bf f (z) the actual modeling uncertainties over the
agent layer, and µmin ¯Bu ¯Ecσv a ﬁctitious uncertainty over the control layer, that is introduced to formulate
a low-dimension modiﬁed LQR problem in Design Procedure 1, despite the fact that we are dealing with a
high-dimension (or MAS-level) robust ISS problem.
We deﬁne a candidate common ISS Lyapunov function:

¯V (x) = xT ¯P x ≻ 0

which is the same as that of Design Properties 1 (a consequence of the mixed optimal and graph theoretic
formulation in Design Procedure 1). As a key point, unlike the multiple Lyapunov functions in [11] and [12],
we point out that this ¯P does not vary depending on the active control sublayer (or switching mode σ).
Along the uncertain trajectories of the two-layer interconnected MAS (17) and based on Design Properties 1, we
ﬁnd:

˙¯V = ¯V T
x ˙x
x ( ¯Ax + µmin ¯Buv) + µmin ¯V T
= ¯V T
x
= −xT ¯Qf x − vT ¯Rv − 2vT ¯R ¯Ecσv + 2xT ¯P ¯Bf f (y) + 2xT ¯P ¯Bdd.

¯Bu ¯Ecσv + ¯V T
x

¯Bf f (y) + ¯V T
x

¯Bdd

8

˙x = ¯Ax + µmin ¯Buv
Networked nominal dynamics
|
}
{z

We use Young’s inequality as follows:

˙¯V ≤ −xT ¯Qf x − vT ¯Rv − 2vT ¯R ¯Ecσv + af f T f + adxT x + 1

≤ −xT
≤ −xT ¯Qvx + γdkdk2

(cid:0)

¯Q + ¯K T ¯R ¯K + 2 ¯K T ¯R ¯Ecσ ¯K − 1
af

¯P ¯Bf ¯BT
f

¯P

(cid:1)

xT ¯P ¯Bf ¯BT
f

¯P x + 1
ad

dT ¯BT
d

¯P 2 ¯Bdd

af

x + γdkdk2 ≤ −xT ¯Qvσx + γdkdk2

where γd := k ¯P ¯Bdk2, and 0 ≺ ¯Qv 4 ¯Qvσ for all σ ∈ {1, 2, ..., M }. Since the characteristics of the candidate
common ISS Lyapunov function (or the matrix ¯P ) and its decay rate along the uncertain trajectories (or ¯Qv and
γd) are independent of σ, we ﬁnd that ¯V is a valid common ISS Lyapunov function (see Deﬁnition 1). Thus,
we conclude robust ISS for the two-layer interconnected MAS of this paper under an arbitrarily fast switching
(cid:4)
of the control layer topology.
Remark 2: In the absence of perturbations, i.e., when d(t) = 0, we ﬁnd ˙¯V ≤ −xT ¯Qvx ≺ 0 (asymptotic
convergence of all state trajectories to the origin). Using Rayleigh-Ritz inequality, we reach to λmin( ¯P )kxk2 ≤
¯V ≤ λmax( ¯P )kxk2 and ˙¯V ≤ −λmin( ¯Qv)kxk2, which guarantee the robust exponential convergence of all state
trajectories to the origin: kx(t)k ≤ κe exp−σet kx(0)k where κe =
◭

[22].

and σe = λmin( ¯Qv)
2λmax( ¯P )

λmax( ¯P )
λmin( ¯P )

Remark 3: As an alternative to the proposed Design Procedure 1, an interested reader can restrict the design
to Ri = rInu with r ∈ R>0 for all agents, or to a set of Ri and Hcσ that satisfy
< 0 for all
σ, in order to remove 2 ¯K T ¯R ¯Ecσ ¯K from the validation matrix ¯Qvσ in (7). Consequently, that high-dimension
validation matrix will turn into a set of N low-dimension conditions Qvi = Qi + K T
Pi ≻ 0
(one for each control node), and a σ-independent ¯Qv = diag{Qvi} will directly appear (instead of ¯Qvσ) in the
◭
proof of Theorem 1.

¯R ¯Ecσ+( ¯R ¯Ecσ)T
2

i RiKi − 1
af

PiBfiBT
fi

q

IV. SIMULATION VERIFICATION

Now we demonstrate the feasibility of the proposed ideas for an interconnected MAS (1), with an (unknown)
interconnection topology Ga shown over the agent layer in Fig. 1, where each black arrow represents an edge
weight equal to 1 and orange arrow −1. Together with the agent dynamics in Appendix I, this builds an unstable
(open-loop) agent layer with divergent trajectories.

We follow the steps of the proposed Design Procedure 1 and SMT-based Algorithms 1 and 2, and develop
a control layer with M = 5 sublayers as depicted in Fig. 1. In particular, as a few conditions in the proposed
cybersecurity Algorithms 1 and 2, we set T = 3, r14 = r37 = r38 = 0, and θ2 = θ5 = 0 (other parameters are
relatively evident). Each edge with a cyan color represents a weight equal to 2, and black equal to 4. We obtain the
robust distributed ISS gains K1 = [−5.2632, −6.6137], K2 = [−4.8272, −6.3715], K3 = [−1.8623, −3.8913],
K4 = [−5.0504, −6.4468], K5 = [5.0014, 5.1293], K6 = [5.1795, 4.9353], K7 = [5.3290, 5.4146], and K8 =
[3.8166, 3.7070] such that the validation condition (7) is satisﬁed.

It is a common practice to assume that an attacker does not have unlimited resources [33]. Thus, we assume
three communication links (including one selﬂoop) can be compromised per each sublayer (see dotted arrows
over the control sublayers in Fig. 1). Despite this assumption, the divergent trajectories in Fig. 2 demonstrate
that a smart attacker can easily compromise the underlying two-layer interconnected MAS if its control layer
topology is ﬁxed.

To examine the power of the proposed proactive cyber defense strategy, we consider an attack scenario where
the attacker (persistently) attacks on (the dotted edges of) the control sublayer 5 over t ∈ [0, 2), 4 over t ∈ [2, 4),
3 over t ∈ [4, 6), 2 over t ∈ [6, 8), and 1 over t ∈ [8, 10], in addition to the permanently compromised (potential)
communication capabilities between the control nodes 1 and 4, 3 and 7, and 3 and 8. Note that the two-layer
interconnected MAS starts under a DoS attack, and persistently remains under attack. This is different from the
existing switching-based studies [10] and [19], where the attack frequently goes off and, in average, the system
has (enough) time to recover after each DoS. As shown in Fig. 3, via an arbitrarily fast switching of the control
sublayers, the proposed distributed protocol ensures ISS for the two-layer interconnected MAS in the presence
of various abnormalities.

9

K

4

K

5

K

6

K

3

K

2

K

1

K

8

e r

y

b l a

K

7

o l s u

n t r

o

C

e r

y

b l a

o l s u

n t r

o

C

e r

y

b l a

o l s u

n t r

o

C

e r

y

b l a

o l s u

n t r

o

C

5

4

3

2

1

e r

y

b l a

o l s u

n t r

o

C

a

4

a

5

a

6

e r

y

n t l a

a

7

e

g

A

a

8

a

3

a

1

a

2

Fig. 1: A two-layer interconnected MAS with ﬁve control sublayers, where ai denotes the agent and Ki the
stabilization gains associated to each node i according to (3). Ki is the same for each control node, to be found
by following the dashed vertical lines. In simulation of Fig. 2, only control sublayer 1 is active. In simulation of
Fig. 3, all control sublayers are frequently active, one at each time, according to subplot (a) in that ﬁgure. For
the sake of visibility, the color of each control sublayer’s frame is the same as its nodes. The dotted horizontal
arrows denote the compromised (blocked) communication links by distributed DoS attacks.

10

50

40

30

20

10

0

0

||x1||
||x2||
||x3||
||x4||
||x5||
||x6||
||x7||
||x8||

2

4

6

8

10

Fig. 2: Compromised system: Divergent trajectories show that a smart attacker, with limited resources, can easily
compromise a ﬁxed (predictable) control sublayer 1.

11

5

4

3

2

1

0

1

2

3

4

5

6

7

8

9

10

(a) The switching signal σ indicates the number of an active control sublayer 1 to 5 for an arbitrarily fast switching.

4

3.5

3

2.5

2

1.5

1

0.5

0

0

10-3

15

10

5

7

7.2

7.4

7.6

7.8

8

8.2

||x

||x

||x

||x

||x

||x

||x

||x

||

||

||

||

||

||

||

||

1

2

3

4

5

6

7

8

1

2

3

4

5

6

7

8

9

10

(b) Robust ISS behavior under the distributed DoS, modeling uncertainties, nonvanishing perturbations, and very fast
switching.

Fig. 3: Proactive cyber defense: Robust ISS for the two-layer interconnected MAS in Fig. 1 under a (time-varying)
persistent, distributed DoS attack, as explained in Section IV.

12

All individual subsystems should be asymptotically stable in order to guarantee the asymptotic stability of an
arbitrarily fast switched system (subsection 2.1.1, [24]). In the ISS simulation results of this section, the two-layer
interconnected MAS may temporarily face an attack on a few of its communication links, which violates such a
condition. This could be problematic pointing to the fact that the underlying agent layer is unstable. However, due
to the “non-overlapping paths” and “centrality distribution” conditions in the developments of Subsection III-C,
a fast mutation among the control sublayers ensures that the ﬁnal moving target defense strategy will end in a
two-layer interconnected MAS that (with an abuse of the words) is “more (input-to-state) stable than unstable.”
Indeed, over a time interval, the agent layer dynamics see a (time varying) control layer topology for which the
conditions of Section II are satisﬁed by the union of the activated control sublayers. Further computer science-
oriented investigation on this subject is left for the future. However, without any technical modiﬁcations, we
need to mention that an increase in the number of nodes (in simulation) will increase the power of the proposed
moving target defense strategy to handle the (unmeasured) cyber attacks in a proactive manner, because it will
increase the number of possible control sublayer structures that would satisfy the conditions of Subsection III-C.

V. SUMMARY

We systematically study the robust input-to-state stability and proactive security in an interconnected multiagent
system (subject to multiple cyber and physical abnormalities), based on a synergistic combination of various
concepts from the literature of controls, graph theory, and computer science. In particular, we design a set
of cybersecurity-aware, robust control sublayers based on a mixed optimal control, graph, and satisﬁability
modulo theory formulation. Then, relying on the arbitrarily fast switching capability of the proposed distributed
stabilization protocol and the designed cybersecurity-aware control sublayers, we offer a moving target defense
strategy, and enhance the cybersecurity aspect of the two-layer interconnected multiagent system in a proactive
manner. The proposed systematic framework may pave the way for an effective and comprehensive study of the
cyber-physical multiagent systems from both control and cybersecurity viewpoints [8], with an application to
power systems (with their inherently interconnected dynamics) [34].

In Fig. 1, according to model (1), the (unstable) nominal part of interconnected MAS is characterized by the

following matrices for l ∈ {1, 2, 3, 4} and m ∈ {5, 6, 7, 8}:

APPENDIX I

Al =

Am =

1

0
−1 0.25(cid:21)
(cid:20)
1

0

0.25 −1(cid:21)
(cid:20)

Bul =

Bum =

0
1(cid:21)
(cid:20)
0.25
−1 (cid:21)

(cid:20)

and the modeling uncertainty and perturbation matrices are:

Bf2 =

Bf1 = Bu1
0.5
−1(cid:21)
(cid:20)
0.25
−0.75(cid:21)
(cid:20)

Bf3 =

Bd1 = Bu1

(matched scenario)

Bd2 =

Bd3 =

0.25
−0.75(cid:21)
(cid:20)
0.5
1 (cid:21)

(cid:20)

Bf4 = Bu4

Bd4 = Bu4

(matched scenario)

Bf5 =

Bf6 =

Bf7 =

−0.5
0.5 (cid:21)
(cid:20)
0
1(cid:21)
(cid:20)
0
−1(cid:21)
(cid:20)

Bf8 = Bu8

Bd8 =

Bd5 = Bu5

Bd6 = Bf6

Bd7 =

0.5
0.5(cid:21)
(cid:20)
0
1(cid:21)

(cid:20)

.

13

Also, the (unknown) nonlinearities and interconnection matrices are f1(z1) = 0.5 tanh(z1), f2(z2) = −0.4 sin(z2),

f3(z3, t) = 0.5 sin(t) tanh(z3), f4(z4) = −0.4 tanh(z4), f5(z5) = −0.5 sin(z5), f6(z6, t) = 0.4 sin(t) sin(z6),
f7(z7) = 0.5z7, and f8(z8) = 0.4 tanh(z8), as well as Cl = [0, 1] for l ∈ {1, 2, 3, 4}, and Cm = [−1, 0]
for m ∈ {5, 6, 7, 8}. The nonmeasurable, nonvanishing, external perturbations are dp(t) = 1
3 sin(πt), and
dq(t) = 1

3 sin(2πt) for p ∈ {1, 3, 5, 7} and q ∈ {2, 4, 6, 8}.

REFERENCES

[1] Knorn S., Chen Z., Middleton R., “Overview: Collective Control of Multiagent Systems,” IEEE Transactions on Control of Network

Systems, 3(4):334–347, 2015.

[2] Oh K.-K., Moore K., Ahn H.-S., “Disturbance Attenuation in a Consensus Network of Identical Linear Systems: An H∞ Approach”,

IEEE Transactions on Automatic Control, 59(8):2164-2169, 2014.

[3] Ai X., Yu J., Jia Z., Shen Y., Ma P., Yang D., “Adaptive Robust Consensus Tracking for Nonlinear Second-Order Multi-Agent Systems

with Heterogeneous Uncertainties,” International Journal of Robust and Nonlinear Control, 27:5082–5096, 2017.

[4] Rieger C., Moore K., Baldwin T., “Resilient Control Systems: A Multi-Agent Dynamic Systems Perspective,” IEEE International

Conference on Electro-Information Technology, USA, 2013.

[5] Antsaklis P., “Goals and Challenges in Cyber-Physical Systems Research: Editorial of the Editor in Chief,” IEEE Transactions on

Automatic Control, 59(12):3117–3119, 2014.

[6] Egerstedt M., “From Algorithms to Architectures in Cyber-Physical Networks,” Cyber-Physical Systems, 1(2-4):67–75, 2015.
[7] Cardenas A., Amin S., Sastry S. “Research Challenges for the Security of Control Systems,” Workshop on Hot Topics in Security,

USA, 2008.

[8] Chong M., Sandberg H., and Teixeira A., “A Tutorial Introduction to Security and Privacy for Cyber-Physical Systems,” European

Control Conference, Italy, 2019.

[9] Rezaei V., Stefanovic M., “Event-Triggered Cooperative Stabilization of Multiagent Systems with Partially Unknown Interconnected

Dynamics,” Automatica, 130:109657, Aug 2021.

[10] Rezaei V., “Event-Triggered Distributed Stabilization of Partially Unknown Interconnected Multiagent Systems with Abnormal Agent

and Control Layers,” IEEE Conference on Decision and Control, USA, 2021.

[11] Rezaei V., “Robust Distributed Stabilization of Interconnected Multiagent Systems with Switched Control Sublayers,” AIAA Science

and Technology Forum and Exposition, USA, 2021.

[12] Rezaei V., Stefanovic M., “Mode-Dependent Switched Distributed Stabilization of Partially Unknown Interconnected Multiagent

Systems,” American Control Conference, USA, 2021.

[13] Jafarian J.H., Al-Shaer E., Duan Q., “Formal Approach for Route Agility Against Persistent Attackers,” European Symposium on

Research in Computer Security, pp. 237-254, Springer, 2013.

[14] Zhou Z., Xu C., Kuang X., Zhang T., Sun L., “An Efﬁcient and Agile Spatio-Temporal Route Mutation Moving Target Defense

Mechanism,” IEEE International Conference on Communications, China, 2019.

[15] Bhardwaj A., El-Ocla H., “Multipath Routing Protocol Using Genetic Algorithm in Mobile Ad Hoc Networks,” IEEE Access,

8:177534-177548, 2020.

[16] Grifﬁoen P., Weerakkody S., Sinopoli B., “A Moving Target Defense for Securing Cyber-Physical Systems,” IEEE Transactions on

Automatic Control, 66(5):2016-2031, 2021.

[17] Kanellopoulos A., Vamvoudakis K., “A Moving Target Defense Control Framework for Cyber-Physical Systems,” IEEE Transactions

on Automatic Control, 65(3):1029-1043, 2020.

[18] Giraldo J., Cardenas A., Moving Target Defense for Attack Mitigation in Multi-Vehicle Systems, In Proactive and dynamic Network

Defense, pp. 163-190, Springer, 2019.

[19] Feng S., Tesi P., De Persis C., “Towards Stabilization of Distributed Systems under Denial-of-Service,” IEEE Conference on Decision

and Control, Australia, 2017.

[20] Mesbahi M., Egerstedt M., Graph Theoretic Methods in Multiagent Networks, Princeton, 2010.
[21] Rezaei V., Stefanovic M., “Distributed Stabilization of Interconnected Multiagent Systems using Structurally Nonsymmetric Control

Layers,” IFAC World Congress, Germany, 2020.
[22] Khalil H., Nonlinear Systems, Prentice-Hall, 2003.
[23] Sontag, E., Input to State Stability: Basic Concepts and Results, In: Nistri P., Stefani G. (eds) Nonlinear and Optimal Control Theory.

Lecture Notes in Mathematics, Vol 1932, Springer, 2008.

[24] Liberzon D., Switching in Systems and Control, Springer, 2003.
[25] Rezaei V., Stefanovic M., “Distributed Input-to-State Stabilization of Heterogeneous Interconnected Multiagent Systems with Partially

Unknown Dynamics,” Mediterranean Conference on Control and Automation, Italy, 2021.

[26] Valcher M., Zorzan I., “On the Consensus of Homogeneous Multi-Agent Systems with Arbitrarily Switching Topology,” Automatica,

84:79-85, 2017.

[27] Lunze J., Feedback Control of Large-Scale Systems, Prentice-Hall, 1992.
[28] Sahni S., “Approximate Algorithms for the 0/1 Knapsack Problem,” Journal of the ACM, 22(1):115-124, 1975.
[29] Bjørner N., de Moura L., “Z310: Applications, Enablers, Challenges and Directions,” Sixth International Workshop on Constraints

in Formal Veriﬁcation, 2009.

[30] de Moura L., Bjørner N., Formal Methods: Foundations and Applications, In: Satisﬁability Modulo Theories: An Appetizer, Springer,

2009.

14

[31] Rezaei V., Stefanovic M., “Multi-Layer Distributed Protocols for Robust Cooperative Tracking in Interconnected Nonlinear Multiagent

Systems,” International Journal of Robust and Nonlinear Control, 29(12):3859–3891, 2019.

[32] Lin F., Robust Control Design: An Optimal Control Approach, Wiley, 2007.
[33] Jajodia S., Ghosh A., Swarup V., Wang C., Wang X., Moving Target Defense: Creating Asymmetric Uncertainty for Cyber Threats,

Springer Science & Business Media, 2011.

[34] Zhou Q., Shahidehpour M., Paaso A., Bahramirad S., Alabdulwahab A., Abusorrah A., “Distributed Control and Communication

Strategies in Networked Microgrids,” IEEE Communications Surveys and Tutorials, 22(4):2586-2633, 2020.

15

