Secure State Estimation and Control for Cyber
Security of AC Microgirds

Dariush Fooladivanda*, Qie Hu*, Young Hwan Chang*, and Peter W. Sauer

1

9
1
0
2

g
u
A
6
1

]

Y
S
.
s
s
e
e
[

1
v
3
4
8
5
0
.
8
0
9
1
:
v
i
X
r
a

Abstract—A timely, accurate, and secure dynamic state esti-
mation is needed for reliable monitoring and efﬁcient control
of microgrids. The synchrophasor technology enables us to
obtain synchronized measurements in real-time and to develop
dynamic state estimators for real-time monitoring and control
of microgrids. In this study, we consider an AC microgrid
comprising several synchronous generators and inverter-interface
power supplies, and focus on securely estimating the dynamic
states of the microgrid from a set of corrupted data. We propose
a dynamic state estimator which enables the microgrid operator
to reconstruct the dynamic states of the microgrid from a set
of corrupted data. Finally, we consider an AC microgrid with
the same topology as the IEEE 33-bus distribution system, and
numerically show that the proposed secure estimation algorithm
can accurately reconstruct the attack signals.

Index Terms—Secure state estimation, dynamic state estima-

tion, microgrids, distribution systems.

I. INTRODUCTION

F UTURE distribution systems will include interconnected

microgrids [1]- [2]. Such systems are designed to be
operated and controlled in a hierarchical fashion to deal with
various dynamic phenomena with different time scales [3]-[4].
The functionality of control systems in microgrids is highly
dependent on state estimation schemes used to observe the
state of the system over time. Traditional energy management
systems are using static state estimation schemes designed
from steady-state models [5]- [6]. With the high penetration
of distributed energy resources (DER) on the generation side,
and ﬂexible loads and new demand-response technologies on
the demand side, static state estimation methods will be unable
to capture power systems’ dynamics accurately [7]. Dynamic
state estimation schemes will be needed to accurately capture
the system dynamics. Such state estimation schemes, designed
based on dynamical models, will play an important role in
microgrid control and protection [8]- [9]. The focus of this
paper is the design of dynamic state estimation schemes which
are secure to cyber-physical attacks.

Large-scale integration of inverter-interfaced power supplies
and distributed controls requires a widespread deployment of
the synchrophasor technology and communication networks in
future distribution systems. This will lead to high-volume data
exchange between different controllers which will make mi-
crogrids vulnerable to cyber-physical attacks. Corrupted data

D. Fooladivanda is with the Department of Mechanical and Aerospace Engi-
neering at the University of California, San Diego, USA (dfooladi@ucsd.edu).
Q. Hu is with the Department of Electrical Engineering and Computer
Sciences, University of California Berkeley, USA (qiehu@berkeley.edu). Y.
H. Chang is with the Department of Biomedical Engineering and Com-
putational Biology Program, Oregon Health and Science University, USA
(chanyo@ohsu.edu). Peter W. Sauer is with the Department of Electrical
and Computer Engineering, University of Illinois Urbana-Champaign, USA
(psauer@illinois.edu).

*These authors contributed equally to this work.

in controllers can disrupt power generators’ synchrony and
result in a network-wide instability. Several attack detection
schemes have been proposed in recent years [10]- [14]. In
false-data injection attacks, disturbances are injected to sensors
and actuators to disrupt their measurements and computed
control inputs. While it is possible to identify misbehaving
agents [10]- [11], such solutions require knowledge of the
communication network and are hard to scale. In [15], the
authors propose a computationally-efﬁcient scheme to detect
deception attacks on sensors. While such solutions enable us to
detect cyber attacks efﬁciently, these solutions do not mitigate
all possible adverse effects. Robust game-theoretic schemes
can lead to conservative results against cyber attacks [16]-[17].
Cyber attacks can be modeled as noise or disturbance to the
system. Basseville et al. [18] use noise ﬁltration techniques
to detect and remove malicious attacks, and the authors in
[19] develop disturbance attenuation methods for cyber attack
detection. Notice that noise ﬁltration or disturbance attenuation
techniques operate under certain statistical properties, e.g.,
white Gaussian noise signal. However,
in practice, cyber
attacks can be deliberately designed by a malicious attacker. In
[20], the authors propose an attack-resilient distributed control
for synchronization of islanded inverter-based microgrids. The
authors study the effect of attacks on sensors and actuators, and
numerically demonstrate the effectiveness of their distributed
controls on a modiﬁed IEEE 34-bus system.

In recent years, several researchers have focused on state es-
timation with security guarantees for both linear and nonlinear
dynamical systems [21]-[24]. The existing literature related to
secure state estimation in linear dynamical systems can be
classiﬁed into two classes: 1) noiseless measurements, and 2)
noisy measurements. For the noiseless framework, the studies
in [21]- [23] show that the state of the system can be ac-
curately reconstructed under certain conditions. When sensor
measurements are affected by both noise and attack signals,
sparse attack vectors can be distinguished from measurement
noise under certain conditions [25]-[27]. In [24], the authors
focus on securely estimating the state of a nonlinear dynamical
system from a set of corrupted measurements for two classes
of nonlinear systems without any assumption on the sensor
attacks or corruptions. They propose a secure state estimator
for those systems assuming that the set of attacked sensors
can change with time. Finally, they consider a power system
comprising several synchronous generators and storage units
connected to each other through a set of transmission lines,
and assume that the storage units use feedback linearization
controls. The authors design a secure estimator that allows us
to securely estimate the dynamic states of the power network,
i.e., the states of the synchronous generators, under cyber-
physical attacks and communication failures.

 
 
 
 
 
 
Several approaches in the literature are addressing the
dynamic state estimation problem. However, the existing dy-
namic state estimators have the following drawbacks:

1) Loads are considered to be quasi-static, i.e., load dynam-
ics are neglected. Unlike large power systems, microgrids
are small footprint power systems comprising distribution
assets, DERs, and loads. DERs are typically of inverter-
interfaced power supplies with no inertia. These resources
respond to disturbances as fast as their controls, and hence
dynamics of loads and DERs are strongly coupled in mi-
crogrids. More precisely, load dynamics have signiﬁcant
transient impacts in microgrids [28]- [29].

2) Controllers are considered to have speciﬁc structure.
For example, storage units are assumed to use feedback
linearization controls in [24]. DERs can use several types
of distributed and centralized control schemes [30]-[31].
In summary, load dynamics cannot be neglected in securely
estimating dynamic states, and controllers cannot be limited to
any speciﬁc structure. To overcome the above drawbacks, we
develop a secure state estimation method without linearization
or reducing the microgrid into a network of oscillators.

In this study, we focus on secure dynamic state estimation in
AC microgrids under cyber attacks or communication failures.
We consider an AC microgrid comprising several synchronous
generators, inverter-interfaced power supplies, and loads con-
trolled via a central controller (i.e., the microgrid operator)
as well as local controllers. We assume that these controllers
use the synchrophasor technology, phasor measurement units
(PMU), to maintain the system’s reliability. More precisely,
each bus is equipped with a local controller, transceiver, and
measurement unit which allow the controller to exchange its
information with the central controller and the local controllers
of other buses. The transceivers are connected through a
communication network which sends the feedback information
to the microgrid operator. We make the following assumptions:
A.1 The communication paths from the central controller to
different buses are secured while other communication
paths and PMUs are subject to cyber attacks.

A.2 The set of attacked PMUs or communication paths can

change with time.

A.3 Attacks or corruptions can follow any particular model.
A practical example of cyber attacks in which the set of
attacked sensors can change with time is provided in [32].

We propose a secure state estimator for reconstructing the
dynamic states of the AC microgrid from a set of corrupted
measurements without any assumption on the attacks. The
proposed estimators are computationally efﬁcient. We then
consider an AC microgrid with the same topology as the IEEE
33-bus distribution system, and numerically demonstrate the
effectiveness of our estimators in accurately reconstructing the
attack or corruption signals. The proposed technique enables
microgrid operators to reconstruct dynamic states before using
the received measurements for computing control signals, and
to monitor the operation of local controllers.

The paper is organized as follows: In Section II, we intro-
duce the microgrid model adopted in this work, and review the
classical error correction methods. In Section III, we formulate
the dynamic state estimation problem for AC microgrids, and
propose a solution technique for recovering dynamic states.
Finally, in Section IV, we demonstrate the effectiveness of the

proposed state estimation algorithm using the IEEE 33-bus
distribution system.

II. PRELIMINARIES

We ﬁrst introduce the physical layer model of an AC mi-
crogrid with synchronous generators, inverter-interfaced power
supplies, and loads. We then describe the cyber layer over
which the microgrid operator relies to control its DERs, and
introduce the cyber attacks that we are considering in this
study. Finally, we brieﬂy review the existing secure state
estimation techniques for linear dynamical systems.

A. Physical Layer Model

Consider a microgrid with m + n + l buses. Without loss
of generality, we assume that m of these buses, indexed by
N (S) = {1, · · · , m}, have synchronous generators connected
to them, and that n of the microgrid buses, indexed by N (I) =
{m + 1, · · · , m + n}, have inverter-interfaced power supplies
attached to them. We further assume that the remaining buses,
indexed by N (L) = {m + n + 1, · · · , m + n + l}, have
loads and no generation1. In addition, we assume that the
network interconnecting the generator and load buses is linear
so that it can be represented by the nodal admittance matrix
Y = G +
−1B where G and B denote the conductance and
susceptance matrices, respectively.

√

We use the standard structure-preserving model to describe
the microgrid’s dynamics [33]. This model that incorporates
the dynamics of generators’ rotor angle and response of load
power output to frequency deviations, allows us to preserve
the structure of the grid,
i.e., no load bus elimination is
made. We introduce ﬁctitious buses representing the internal
generation voltages for synchronous generators and inverter-
interfaced power supplies. Each of these buses is connected
to either a synchronous generator or inverter-interfaced power
supply bus via reactances that account for transient reactances
and connecting lines. These reactances can be considered as
transmission lines [34]. Therefore, in the augmented network,
the number of buses is 2(m + n) + l. We further denote the
set of ﬁctitious buses for synchronous generators and inverter-
interfaced power supplies by N (S)
, respectively. The
f
topology of the augmented network can be represented by
an undirected graph, G(N , E), where N = N (S) ∪ N (I) ∪
N (L) ∪ N (S)
; and where each element in the edge
set E corresponds to a transmission line connecting a pair of
buses in the augmented network. We assume that the network
topology is ﬁxed and known to the microgrid operator.

f ∪ N (I)

and N (I)

f

f

Let Vi and θi denote the voltage magnitude and phase
angle of bus i ∈ N , respectively. The dynamics of each
synchronous generator are described by a structure-preserving
model with constant complex voltage behind reactance [34,
Sec. 7.9.2], augmented to include the governor dynamics. For a
synchronous generator at ﬁctitious bus i ∈ N (S)
, let θi denote
the angle of its voltage (the generator’s internal voltage) as
measured with respect to a synchronous reference rotating at
the nominal system electrical frequency ω0. Further, let ωi
denote its rotor electrical angular speed, and let P m
be the
i

f

1Without loss of generality, we consider tie-line buses that connect the

microgrid to the grid, as load buses.

turbine’s mechanical power. For each synchronous generator
i ∈ N (S)

, we have

f

˙θi = ωi − ω0,

Mi ˙ωi = P m
i − Di(ωi − ω0)
−

(cid:88)

ViVj|yij| sin(θi − θj + φij),

τi

j∈Ni
˙P m
i = −P m
i + P s
√

i − Ri(ωi,meas − ω0),

(1)

(2)

(3)

where yij = gij +
−1bij with gij and bij being the entries
of the conductance and susceptance matrices, respectively, and
φij equals arctan(gij/bij). Ni denotes the set of neighbors of
node i in graph G(N , E), Di (in s/rad) is the generator damp-
ing coefﬁcient, and Mi (in s2/rad) is a scaled inertia constant.
Further, Ri is the frequency-power speed-droop characteristic
constant, τi is the generator governor time constant, and P s
i
denotes the generator’s power set-point. Notice that ωi,meas is
the measured value of state ωi for all i ∈ N (S)

.

The dynamics of inverter-based power supplies can similarly
be described by a constant voltage behind reactance model,
augmented to include a frequency-droop controller. For a
inverter-based power supply at ﬁctious bus i ∈ N (I)
, let θi
denote the angle of its voltage as measured with respect to
the nominal system electrical frequency ω0, and let P s
i denote
its generation set-point. For each inverter-based power supply
i ∈ N (I)

, we have

f

f

f

Di

˙θi = P s

i −

(cid:88)

j∈Ni

ViVj|yij| sin(θi − θj + φij),

(4)

where Di (in s/rad) is the speed-droop characteristics slope of
the inverter-interfaced power supply.

In general, the real power drawn by the load at load bus
i ∈ N (S) ∪ N (I) ∪ N (L) is a nonlinear function of voltage and
frequency. However, for constant voltages and small frequency
deviations around the nominal frequency ω0, it is reasonable
to assume that the real power drawn by the load equals P d
i +
Di
i > 0 are the constant frequency
coefﬁcient of load and the nominal load at bus i ∈ N (S) ∪
N (I)∪N (L), respectively. Therefore, for constant voltages and
small frequency deviations, the dynamics of the phase angle
at load bus i ∈ N (S) ∪ N (I) ∪ N (L) can be modeled by

˙θi where Di > 0 and P d

Di

˙θi = −P d

i −

(cid:88)

j∈Ni

ViVj|yij| sin(θi − θj + φij).

(5)

Here, we ignore reactive powers for synchronous generators,
inverter-interfaced power supplies, and loads as they are un-
necessary for the analysis presented in this study.

B. Cyber Layer Model

Each bus i is equipped with a local controller, transceiver,
and measurement unit which allow bus i to exchange informa-
tion with the central controller (i.e., the microgrid operator)
as well as the local controllers of other buses. As men-
tioned earlier, ﬁctitious buses represent the internal generation
voltages for synchronous generators and inverter-interfaced
power supplies. We assume that each inverter-interfaced power
supply is equipped with a local controller, transceiver, and
measurement unit which allow the inverter-interfaced power

Fig. 1. A graphical depiction of the cyber network model: For simplicity, we
focus on a microgrid comprising four buses. The graph in green (sold lines)
shows the secured information ﬂow (i.e., the set of information ﬂows from the
microgrid operator to local controllers) while the graph in red (dotted lines)
represents the set of non-secured information ﬂows.

supply at ﬁctitious bus i to measure and communicate its
internal voltage phase angle.

The rotor angle of synchronous generators has an electro-
mechanic nature, and hence it cannot be measured via electric
measurement units. However, we can estimate rotor angle by
using other electric parameters of synchronous generators. In
the literature, several studies are addressing the problem of
estimating the rotor angle of synchronous generators [43]-[46].
We assume that each synchronous generator is equipped with
a local controller, transceiver, and measurement unit, and that
the measurement unit at bus i is using a rotor angle estimator to
compute the internal voltage phase angle for the synchronous
generator at bus i.

The transceivers are connected through a communication
network which sends the feedback information measurements,
including rotors’ speeds and voltage phase angles,
to the
central controller. The communication network, measurement
units, and transceivers are not secured. Therefore, these de-
vices are subject to cyber attacks and communication failures.
We assume that the communication paths from the central
controller to the local controllers are secured while other com-
munication paths are not secured2. Hence, the communication
network can be decomposed into two sub-graphs, one for
secured information ﬂow and one for non-secured information
ﬂow, as shown in Fig. 1.

The microgrid operator needs to perform secure state esti-
mation before using the received measurements (e.g., ωi’s and
θi’s) for computing different control signals and for monitoring
the performance of the local controllers in the microgrid. To
do so, we consider two types of attacks:

• Attack 1: an attack that corrupts the communication
paths from the transceivers to the central controller.
• Attack 2: an attack that affects measurement units.
These types of attacks are illustrated in Fig. 1 for a microgrid
comprising four buses. Notice that the set of attacked mea-
surements can change at each time instant.

2In practice,

the central controller is strongly protected against cyber
attacks, and the local transceivers are more vulnerable to cyber attacks than
the central controller. For more information, we refer the reader to the North
American Electric Reliability Corp. (NERC)s Critical Infrastructure Protection
(CIP) standards [35].

Secured Communication NetworkNon-securedCommunicationNetworkSecured Communication PathNon-secured Communication PathMicrogrid Operator1234Microgrid Operator2134Attack type 1Attack type 2C. Error Correction

1) Compressed Sensing: Let A ∈ Rm×n (m (cid:28) n) and
b ∈ Rm be a sensing matrix and measurement vector. Sparse
solutions x ∈ Rn, are sought to the following problem:

min
x

(cid:107)x(cid:107)0 subject to b = Ax,

(6)

where (cid:107)x(cid:107)0 denotes the number of nonzero elements of x. The
following results provide a sufﬁcient condition for a unique
solution to (6).

Lemma 1. ([36]) If the sparsest solution to (6) has (cid:107)x(cid:107)0 = q
and m ≥ 2q and all subsets of 2q columns of A are full rank,
then the solution is unique.

2) The Error Correction Problem: Consider a full rank
coding matrix C ∈ R(cid:96)×n ((cid:96) > n) and a set of corrupted
measurements y = Cx+e where e is an arbitrary and unknown
sparse error vector. In the classical error correction problem,
we aim to recover the input vector x ∈ Rn from the corrupted
measurements y. To reconstruct x, it is sufﬁcient to reconstruct
the error vector e since knowledge of y = Cx + e and e gives
Cx, and then x can be computed using the full rank matrix C
[36]. Candes et al. [36] construct a matrix F that annihilates
C on the left, i.e., F Cx = 0 for all x. Then, by applying F
to y, they obtain

˜y = F (Cx + e) = F e.

(7)

Hence, the classical error correction problem can be trans-
formed into reconstructing a sparse vector e from the mea-
surement vector ˜y = F e. By using Lemma 1, if all subsets of
2q columns of F are full rank, we can then reconstruct any e
that satisﬁes (cid:107)e(cid:107)0 ≤ q.

3) Secure Estimation for Linear Dynamical Systems: Con-

[36] and [37]. First, we compute the error vector Eq,K, and
then solve for x[0]. To compute Eq,K, consider the QR
decomposition of Φ as follows:
(cid:20)R1
0

Φ = (cid:2)Q1 Q2

= Q1R1,

(10)

(cid:21)

(cid:3)

(cid:3) ∈ Rp·K×p·K is orthogonal, Q1 ∈
where (cid:2)Q1 Q2
Rp·K×n, Q2 ∈ Rp·K×(p·K−n), and R1 ∈ Rn×n is a rank-n
upper triangular matrix. We pre-multiply (9) by (cid:2)Q1 Q2
(cid:3)(cid:62)
,
and obtain:

(cid:21)

(cid:20)Q(cid:62)
1
Q(cid:62)
2

Y =

(cid:21)

(cid:20)R1
0

x[0] +

(cid:21)

(cid:20)Q(cid:62)
1
Q(cid:62)
2

Eq,K.

(11)

Using the second block row, we have:

˜Y (cid:44) Q(cid:62)

2 Eq,K,

2 Y = Q(cid:62)
2 ∈ R(p·K−n)×p·K. Using Lemma 1,
where Q(cid:62)
the above
optimization has a unique, s-sparse solution (where s ≤ q · K)
if all subsets of 2s columns (at most 2q · K columns) of Q(cid:62)
2
are full rank. Using this observation, we consider solving the
following l1-minimization problem:

(12)

ˆEq,K = arg min
E

(cid:107)E(cid:107)l1

subject to ˜Y = Q(cid:62)

2 E.

(13)

Here, we approximate the l0-minimization problem with an l1-
minimization problem to obtain a convex decoder [38]- [42].
Using the ﬁrst block row of (11), we can now compute x[0]

as follows:

x[0] = R−1

1 Q(cid:62)

1 (Y − ˆEq,K).

(14)

The following result provides the conditions under which
exists a unique solution to (14). The proof follows by using
Lemma 1 and the fact that the null space of Q(cid:62)
2 is equal to
the column space of Φ.

sider a discrete-time linear control system as follows:

x[k + 1] = Ax[k],
y[k] = Cx[k] + e[k],

Lemma 2. There exists a unique solution x[0] if all subsets
of 2s columns of Q(cid:62)
2 are linearly independent and Φ is full
column rank.

(8)

where x[k] ∈ Rn and y[k] ∈ Rp denote the states and outputs
of the system at time slot k, respectively. e[k] ∈ Rp denotes
attack signals injected by malicious agents at the sensors.

Let Y ∈ Rp·K be a collection of corrupted measurements
over K time slots, and let Eq,K denote the set of error
vectors (cid:2)e[0]; ... ; e[K − 1](cid:3) ∈ Rp·K where each e[k] satisﬁes
(cid:107)e[k](cid:107)0 ≤ q ≤ p. We have:








Y (cid:44)

=

y[0]
y[1]
...
y[K − 1]







C
CA
...
CAK−1













=

Cx[0] + e[0]
CAx[0] + e[1]
...
CAK−1x[0] + e[K − 1]











(9)

x[0] + Eq,K (cid:44) Φx[0] + Eq,K,






where Φ ∈ Rp·K×n is the K-step observability matrix of the
system at hand. We assume that rank(Φ) = n; otherwise, we
cannot determine x[0] even if there was no attack Eq,K = 0.
We can now reconstruct the initial state x[0] from y[k]’s,
where k = 0, ..., K − 1, by following a two-step procedure

Next, we propose a dynamic state estimator for secure state

estimation of dynamic states ωi’s and θi’s in microgrids.

III. SECURE STATE ESTIMATION FOR MICROGRIDS
Let us assume that the time is slotted in time slot of size
δ. At each time slot k, the central controller receives the
measured values of voltage phase angles, generators’ internal
angles, and rotors’ speed. Let yi[k] denote the measurement
vector received from bus i ∈ N . Since the measurement units
and communication paths from the measurement units to the
central controller are not secured, yi[k] is subject to cyber
attacks and corruptions:

yi[k] =

(cid:21)

(cid:20)θi[k]
ωi[k]

+ ei[k], ∀i ∈ N (S)

f

,

yi[k] = θi[k] + ei[k], ∀i ∈ N \ N (S)

f

,

(15)

(16)

where ei[k] represents either a corruption or an attack signal
injected by a malicious agent. Notice that ei[k] ∈ R2 for all
i ∈ N (S)

, and ei[k] ∈ R for all i ∈ N \ N (S)

.

Our goal is to reconstruct θi[k] for all i ∈ N and ωi[k] for
all i ∈ N (S)
by using the received measurements. The only
assumption concerning the corrupted sensors is the number of

f

f

f

sensors that are attacked or corrupted due to failures. We do
not assume the errors ei[k]’s follow any particular model, i.e.,
the elements of ei[k] can take any value in R. If the sensor at
bus i is not attacked and the communication ﬂow from bus i
to the central controller is not corrupted, then necessarily the
elements of ei[k] are zero.

A. Formulation of Secure State Estimation

The microgrid dynamics and power ﬂows can be described
by the dynamical equations in (1)-(5). We apply the forward
Euler discretization scheme to the continuous-time dynamics
in (1)-(5) to obtain a discrete-time approximation, assuming
constant discretization step δ. We begin with the synchronous
generators, and use the same approach for inverter-interfaced
power supplies and loads.

Synchronous Generators: For each synchronous generator

at ﬁctitious bus i ∈ N (S)

, we have

f

θi[k + 1] = θi[k] + δ(ωi[k] − ω0),
ωi[k + 1] = αiωi[k] + ηiP m
i
(cid:88)

[k] + βi

+

fij(θi[k], θj[k]),

where the state vector xi[k] = (cid:2)θi[k], ωi[k], P m

i

[k](cid:3)(cid:62)

, and



Ai =


0
δ
1
0
ηi
αi

0 −νi κi
ui[k] = (cid:2)−δω0, βi + (cid:80)
(cid:15)i[k] = (cid:2)ec
[k], · · · , ec
ij1
Hi[k] = (cid:2)γs
[k], · · · , γs
ij1

 , Bi =

j∈Ni

 , Ci =




0
0
0
0

0
νi
ij[k], ζi[k](cid:3)(cid:62)
γs

,

(cid:20)1
0

(cid:21)

,

0 0
1 0

[k], es
ij1
[k], γc
ij1

ijn(i)

ijn(i)

[k], · · · , es

ijn(i)

[k], · · · , γc

ijn(i)

[k](cid:3)(cid:62)
,
[k](cid:3) .

Notice that n(i) denotes the number of neighbors of node i in
graph G(N , E), i.e., n(i) = |Ni|, and that nodes j1, · · · , jn(i)
represent the neighbors of node i in G(N , E). More precisely,
we have Hi[k] ∈ R1×2n(i) and (cid:15)i[k] ∈ R2n(i). Next, by using
the same approach, we obtain the state space model of inverter-
interfaced power supplies and loads.

Inverter-interfaced Power Supplies: The state space
model of the inverter-interfaced power supply at ﬁctitious bus
i ∈ N (I)

can be described by

f

xi[k + 1] = xi[k] + ui[k] − Hi[k](cid:15)i[k],

yi[k] = xi[k] + ei[k],

(21)

P m
i

[k + 1] = κiP m
i

j∈Ni

[k] + ζi[k] − νi(ωi[k] + (cid:2)0, 1(cid:3) ei[k]),

where fij(θi[k], θj[k]) = γij[k] sin(θi[k] − θj[k] + φij),

where xi[k] = θi[k] and ui[k] = δP s
Hi[k] and (cid:15)i[k] are deﬁned above.

i [k]/Di + (cid:80)

γs
ij[k].

j∈Ni

Loads: The state space model of the load at bus i ∈ N (S) ∪

N (I) ∪ N (L) can be described by

ηi = δ/Mi,
νi = Riδ/τi,
κi = (1 − δ/τi),
αi = (Mi − δDi)/Mi,

βi = δDiω0/Mi,

ζi[k] = δ(P s
γij[k] = −δVi[k]Vj[k]|yij|/Mi.

i [k] + Riω0)/τi,

Notice that ωi,meas[k] equals (cid:2)0, 1(cid:3) yi[k] which is equal to
(ωi[k] + (cid:2)0, 1(cid:3) ei[k]). Using (15)-(16), we have

fij(θi[k], θj[k]) = γij[k] sin(θi[k] − θj[k] + φij)

=γij[k] sin(yi[k] − ei[k] − yj[k] + ej[k] + φij)
ij[k] − γc
=γs
(18)

ij[k] − γs

ij[k]es

ij[k]ec

ij[k],

where

γs
ij[k] = γij[k] sin(yi[k] − yj[k] + φij),
γc
ij[k] = γij[k] cos(yi[k] − yj[k] + φij),
ij[k] (cid:44) 1 − cos(ei[k] − ej[k]),
ec
ij[k] (cid:44) sin(ei[k] − ej[k]).
es

(19)

the coefﬁcients of γc

ij[k] can be
Notice that
calculated using the measurement received from the local
controllers.

ij[k] and γs

Now, the state space model of the synchronous generator at

ﬁctitious bus i ∈ N (S)

f

can be represented by

xi[k + 1] = Aixi[k] + ui[k] −

yi[k] = Cixi[k] + ei[k]





0
Hi[k](cid:15)i[k]
0



 − Biei[k]

(20)

(17)

xi[k + 1] = xi[k] + ui[k] − Hi[k](cid:15)i[k],

yi[k] = xi[k] + ei[k],

(22)

γs
ij[k].

where xi[k] = θi[k] and ui[k] = −δP d
Hi[k] and (cid:15)i[k] are deﬁned above.

i [k]/Di +(cid:80)

j∈Ni

Consider an enlarged system composed of all the system

dynamics:

X[k + 1] = AX[k] + U [k] − H[k](cid:15)[k] − BE[k],








y1[k]
y2[k]
...
y|N |[k]








Y [k] =

where

= CX[k] + E[k],

(23)

A (cid:44) blkdiag{A1, · · · , Am, Im+2n+l} ∈ R(|N |+2m)×(|N |+2m),
B (cid:44) blkdiag{B1, · · · , Bm, 0m+2n+l} ∈ R(|N |+2m)×(|N |+m),
C (cid:44) blkdiag{C1, · · · , Cm, Im+2n+l} ∈ R(|N |+m)×(|N |+2m),
X[k] (cid:44) (cid:2)x1[k](cid:62), · · · , x|N |[k](cid:62)(cid:3)(cid:62)
U [k] (cid:44) (cid:2)u1[k](cid:62), · · · , u|N |[k](cid:62)(cid:3)(cid:62)
(cid:15)[k] (cid:44) (cid:2)(cid:15)1[k](cid:62), · · · , (cid:15)|N |[k](cid:62)(cid:3)(cid:62)
E[k] (cid:44) (cid:2)e1[k](cid:62), · · · , e|N |[k](cid:62)(cid:3)(cid:62)



∈ R(|N |+2m),
∈ R(|N |+2m),
i∈N n(i),

∈ R2 (cid:80)
∈ R|N |+m,

H[k] (cid:44) blkdiag

01×2n(m)
01×2n(1)
Hm[k]
H1[k]
01×2n(m)
01×2n(1)
, Hm+1[k], · · · , H|N |[k](cid:9) ∈ R(|N |+2m)×2 (cid:80)

 , · · · ,

i∈N n(i).

 ,















Consider K time slots k = 0, · · · , K − 1, and collect the
measurements corresponding the K time slots in vector Y as
follows:

Y =





Y [0]
Y [1] − CU [0]


Y [2] − CAU [0] − CU [1]


...


k=0 AK−2−kU [k]







Y [K − 1] − C (cid:80)K−2

.

(24)

Y ∈ RK(|N |+m) can be rewritten in the following form:

where Ψ = (cid:2)Ψ1 Ψ2
Ψ2 ∈ RK(|N |+m)×2K (cid:80)

Y = ΦX[0] + ΨE,
(25)
(cid:3) with Ψ1 ∈ RK(|N |+m)×K(|N |+m) and










I|N |+m
−CB
−CAB
...
−CAK−2B

i∈N n(i), and
· · ·
· · ·

0
I|N |+m
−CB I|N |+m

...
· · ·

. . .
−CB I|N |+m

· · ·
· · ·
· · ·
...









0
−CH[0]
−CAH[0]
...
−CAK−2H[0]

0
0
−CH[1]
...
· · ·

· · ·
· · ·
0
. . .
−CH[K − 2]










,

· · ·
· · ·
· · ·
...
0









,

Ψ1 =

Ψ2 =

Φ = (cid:2)C; CA; CA2; · · · ; CAK−1(cid:3) ,
E = (cid:2)E[0]; · · · ; E[K − 1]; (cid:15)[0]; · · · ; (cid:15)[K − 1](cid:3) .

The number of columns of the matrix H[k] and the number
of rows of the column vector (cid:15)[k] can be reduced from
2 (cid:80)
i∈N n(i) to 2|E| by using the following properties:
ec
ij[k] = 1 − cos(ei[k] − ej[k]) = ec
ij[k] = sin(ei[k] − ej[k]) = −es
es
ji[k].

ji[k],

(26)

Notice that we have γij[k] = γji[k] and φij = φji. Hence, the
dimension of Ψ2 and E can also be reduced as follows:

dim(Ψ2) → K(|N | + m) × 2K|E|,
dim(E) → K (|N | + m + 2|E|).

(27)

We now choose Ω ∈ R(K|N |−2|N |)×K(|N |+m) which annihi-
lates Φ, i.e., ΩΦ = 0. We then have:

(cid:101)Y = ΩY = Ω (cid:101)Ψ (cid:101)E,

(28)

where (cid:101)Ψ and (cid:101)E are the reduced Ψ and E.

In error correction, accurate decoding can be guaranteed if
the coding matrix (i.e., Ω ˜Φ) satisﬁes the Restricted Isometric
Properties (RIP), which is often achieved by randomly choos-
ing a coding matrix a priori. In [23], Theorem 1 provides a
sufﬁcient condition for perfect recovery of the system states
against sensor attack and describes estimator design by using
a state feedback controller. However, in the current setting,
since there is a limitation to manipulate the coding matrix,
we combine our secure estimator with a Kalman Filter (KF)
to improve its practical performance. Since KF ﬁlters out
both occasional estimation errors by the secure estimator and
noisy measurement, a secure estimation based Kalman Filter
improves practical performance [23]. Next, we numerically
demonstrate the effectiveness of the proposed estimators.

IV. NUMERICAL RESULTS
We consider an AC microgrid consisting of m = 3
synchronous generators, n = 25 inverter-interfaced power
supplies, and l = 5 load buses. The microgrid topology is
shown in Fig. 2, a modiﬁed IEEE 33-bus distribution system
from [47]. Notice that in the augmented network, the number
of buses is 61. The synchronous generator buses are buses
N (S) = {3, 6, 9},
the load buses without generation are
buses N (L) = {1, 2, 14, 22, 25}, and the inverter-interfaced
power supply buses are N (I) = {1, · · · , 33} \ (N (L) ∪ S (L)).
Further, we consider the ﬁctitious buses for the synchronous
generators to be buses 34,35, and 36, and the ﬁctitious buses
for the inverter-interfaced power supplies to be buses 37 to 61.
The buses are connected via a set of electrical transmission
lines. The microgird is connected to the grid via the tie-line
connected to bus one. We take the turbine time constants to be
τi = 5 s, the generator damping coefﬁcients to be Di = 2, the
inertia constants to be Mi = 10, and the droop coefﬁcients to
be Ri = 9.5 for all i ∈ N (S). We further select the inverter-
interfaced power supply droop coefﬁcients to be Di = 0.7 for
all i ∈ N (I), and the constant frequency coefﬁcients of the
loads to be Di = 0.1 for all i ∈ N (L).

We simulate the system for t = 20 seconds with a dis-
cretization step of δ = 1/60 seconds. We select the nominal
loads P d
i ’s randomly from the interval [0, 0.5] pu, and select
the generation set-points P s
i ’s such that the system is balanced.
Notice that computing the active power set-points P s
i ’s is not
the subject of this study. Therefore, we only need to select the
values of P s
i ’s such that the demand and supply are balanced.
We further ignore reactive powers for synchronous generators,
inverter-interfaced power supplies, and loads as they are un-
necessary for the analysis presented in this study. Without loss
of generality, we assume that voltage magnitudes Vi[k]’s are
constant and equal to 1 pu for all k and i = 1, · · · , 33.

We demonstrate the effectiveness of our secure state estima-
tion method through simulations of the two types of attacks:
1) Type A: attacks targeted at synchronous generators, i.e.,
measurements yi[k]’s, where i ∈ N (S) ∪ N (S)
, are
corrupted.

f

2) Type B: attacks targeted at inverter-interfaced power sup-
plies, i.e., measurements yi[k]’s, where i ∈ N (I) ∪ N (I)
,
are corrupted.

f

For each of these attack types, we simulate three scenarios:
1) Scenario 1: There is no cyber attack on the microgrid.
2) Scenario 2: The microgrid is under cyber attack, and it

is not protected by any secure state estimation.

3) Scenario 3: The microgrid is under cyber attack, and it
is protected by the proposed secure state estimation.

A. Attack Type A: Synchronous Generator Attacks

The microgrid operator measures rotor angle from the three
synchronous generator buses, and rotor angle and speed from
the three ﬁctitious synchronous generator buses. Hence, the
operator has access to nine measurements that are subject to
cyber attacks. We assume that from t = 1.1 seconds onwards,
the attacker randomly chooses a set of ﬁve measurements out
of the nine measurements and corrupts them with random
signals at each time step. Fig. 3 shows the simulation results
for the three scenarios: 1) there is no attack (No Attack), 2)

Fig. 2. An AC microgrid comprising m = 3 synchronous generators, n = 25
inverter-interfaced power supplies, and l = 5 load buses.

Fig. 4. True and estimated attack signals: The rows and columns correspond
to measurements and time steps, respectively. In the subﬁgures, the color
indicates the attack signal: red is a positive attack, green is a negative
attack, and black is no attack. Only measurements of the synchronous
generators buses and their corresponding ﬁctitious buses are corrupted by
the attack. Notice that measurements 1 to 6 correspond to rotor angle and
speed measurements from the ﬁctitious synchronous generator buses, and
measurements 34, 37 and 40 correspond to phase angle measurements from
the synchronous generator buses. In subﬁgure “Estimation Error”, the black
color indicates there is zero estimation error for all measurements at all times.

Fig. 3. Phase angles and rotor speeds of the synchronous generators under
attack Type A in the three scenarios.

the microgrid system is under attack and there is no secure
estimation (SE), and 3) the microgrid is under attack and the
microgrid operator uses SE. Notice that in Fig. 3, we only
show phase angles and rotor speeds of the three ﬁctitious
synchronous generator buses.

In the microgrid without cyber attacks, the rotor speeds con-
verge to 60 Hz after an initial transient period. As mentioned
earlier, in Scenario 2, no secure estimation-based protection is
implemented while the micorgrid operator uses the proposed
secure state estimation to protect the system against cyber
attacks in Scenario 3. Therefore, when the system is under
cyber attack, both rotor angles and speeds cannot be estimated
correctly in Scenario 2, as shown in Fig. 3. However, the
operator can perfectly estimate both rotor angles and speeds in
Scenario 3. Fig. 4 shows the attack signal, secure estimator’s
estimated attack signal, and the estimation error. The results
show that the secure estimator correctly estimates the attack
signal throughout the simulation. Hence, the system’s dynam-
ics are identical to the system without any attacks.

B. Attack Type B: Inverter-interfaced Power Supply Attacks

The microgrid operator measures phase angles from the
inverter-interfaced power supply buses. Hence, the operator
has access to 50 measurements that are subject to cyber attack:
25 correspond to phase angle measurements of the inverter-
interfaced power supply buses and 25 correspond to the phase
angle measurements of the corresponding ﬁctitious buses. We
assume that from t = 1.1 seconds onwards,
the attacker
randomly chooses a set of ﬁve measurements out of the 50

Fig. 5. Phase angles and rotor speeds of the synchronous generators under
attack Type B in the three scenarios.

measurements and corrupts them with random signals at each
time step. The simulation results are shown in Fig. 5 and
Fig. 6. The results show that both phase angles and rotor
speeds are severely affected when the system is under attack
and no secure estimation-based protection is implemented.
However, the microgrid operator can perfectly recover the
attack signals and restore the system’s normal dynamics as
if there was no attack when secure state estimation is used.

V. CONCLUSION
We propose a secure state estimator for dynamic state
estimation in AC microgrids under cyber physical attacks. We
show that the microgrid operator can perfectly estimate the
dynamic states in its AC microgrid using our estimator.

REFERENCES

[1] R. Lasseter, “MicroGrids,” in IEEE Power Engineering Society Winter

Meeting, vol. 1, pp. 305--308, 2002.

[2] N. Hatziagyriou, H. Asano, R. Iravani, and C. Marnay, “Microgrids,”
IEEE Power and Energy Magazine, vol. 5, no. 4, pp. 78–94, 2007.

123456789101112131415161718192221202324252627282930313233[22] Y. Shoukry and P. Tabuada, “Event-Triggered State Observers for Sparse
Sensor Noise/Attacks,” IEEE Trans. on Automatic Control, no. 99, pp.
1–13, 2015.

[23] Y. H. Chang, Q. Hu, and C. J. Tomlin, “Secure estimation based Kalman
Filter for cyber physical systems against sensor attacks,” Automatica, 95,
pp.399-412, Sep. 2018.

[24] Q. Hu, D. Fooladivanda, Y. H. Chang, and C. J. Tomlin, “Secure State
Estimation and Control for Cyber Security of the Nonlinear Power
Systems,” IEEE Trans. on Control of Network Systems, vol. 5, no. 3,
pp. 1310–1321, Sept. 2018.

[25] Y. Shoukry, P. Nuzzo, A. Puggelli, A. L. Sangiovanni-Vincentelli, S.
A. Seshia, and P. Tabuada, “Secure state estimation for cyber physical
systems under sensor attacks: a satisﬁability modulo theory approach,”
arXiv pre-print, Dec. 2014.

[26] M. Pajic, J. Weimer, N. Bezzo, P. Tabuada, O. Sokolsky, I. Lee, and G.
Pappas, “Robustness of attack-resilient state estimators,” in ACM/IEEE
International Conference on Cyber-Physical Systems (ICCPS), 2014.

[27] S. Farahmand, G. B. Giannakis, and D. Angelosante, “Doubly robust
smoothing of dynamical processes via outlier sparsity constraints,” IEEE
Trans. on Signal Processing, vol. 59, no. 10, pp. 4529-4543, Oct. 2011.
[28] X. Zhang, J. Chen, and C. Wang, “Stability analysis of islanded micro-
grids with dynamic loads,” in Proc. IEEE 14th International Conference
on Control, Automation, Robotics, and Vision, pp. 1-6, 2016.

[29] A. Haddadi, A. Yazdani, G. Joos, and B. Boulet, “A Generic load model
for simulation studies of microgrids,” in Proc. IEEE Power & Energy
Society General Meeting, pp. 1-5, 2013.

[30] M. Yazdanian, and A. Mehrizi-Sani, “Distributed Control Techniques in
Microgrids,” in IEEE Trans. on Smart Grid, vol. 5, no. 6, pp. 2901–2909,
Nov. 2014.

[31] A. Hooshyar, and R. Iravani, “Microgrid Protection,” in Proc. of the

IEEE, vol. 105, no. 7, pp. 1332–1353, July 2017.

[32] S. Liu, B. Chen, T. Zourntos, D. Kundur, and K. Butler-Purry, “A
Coordinated Multi-Switch Attack for Cascading Failures in Smart Grid,”
IEEE Trans. on Smart Grid, vol. 5, no. 3, pp. 1183–1195, May 2014.
[33] A. R. Bergen, and D. J. Hill, “A structure preserving model for
power system stability analysis,” Power Apparatus and Systems, IEEE
Transactions on, no. 1, pp. 25–35, 1981.

[34] P. W. Sauer and M. A. Pai, Power System Dynamics and Stability. Upper

Saddle River, NJ, USA: Prentice-Hall, 1998.

[35] Available at http://www.nerc.com/pa/Stand/Pages/CIPStandards.aspx
[36] E. Candes, J. Romberg, and T. Tao, “Stable Signal Recovery from
Incomplete and Inaccurate Measurements,” Communications on pure
and applied mathematics, vol. 59, no. 8, pp. 1207–1223, 2006.

[37] D. Hayden, Y. H. Chang, J. Goncalves, and C. Tomlin, “Sparse network
identiﬁability via Compressed Sensing,” Automatica, vol. 68, pp. 9–17,
Jun. 2016.

[38] E. J. Candes, and T. Tao, “Decoding by linear programming,” IEEE
Trans. on Info. Theory, vol. 51, no. 12, pp. 4203–4215, Dec. 2005.
[39] D. L. Donoho, and M. Elad, “Optimally sparse representation in general
(nonorthogonal) dictionaries via l1 minimization,” in Proc. National
Academy of Sciences, pp. 2197–2202, 2003.

[40] M. Elad, and A. M. Bruckstein, “A generalized uncertainty principle
and sparse representation in pairs of bases,” IEEE Trans. on Information
Theory, vol. 48, no. 9, pp. 2558–2567, 2002.

[41] R. Gribonval, and M. Nielsen, “Sparse representations in unions of
bases,” IEEE Trans. on Information Theory, vol. 49, no. 12, pp. 3320–
3325, 2003.

[42] J.A. Tropp, “Greed is good: algorithmic results for sparse approxima-
tion,” IEEE Trans. on Information Theory, vol. 50, no. 10, pp. 2231–
2242, 2004.

[43] P. Tripathy, S. C. Srivastava, and S. N. Singh, “A Divide-by-Difference-
Filter Based Algorithm for Estimation of Generator Rotor Angle Uti-
lizing Synchrophasor Measurements,” in IEEE Transactions on Instru-
mentation and Measurement, vol. 59, no. 6, pp. 1562–1570, June 2010.
[44] G. K. Venayagamoorthy, and R. G. Harley, “MLP/RBF neural-
networkbased online global model identiﬁcation of synchronous gen-
erator,” IEEE Trans. Ind. Electron., vol. 52, no. 6, pp. 1685–1695, Dec.
2005.

[45] A. D. Angel, P. Geurts, D. Ernst, M. G. Glavic, and L. Wehenkel,
“Estimation of rotor angles of synchronous machines using artiﬁcial
neural networks and local PMU-based quantities,” Int. J. Neurocomput.,
vol. 70, no. 16–18, pp. 2668–2678, Oct. 2007.

[46] V. Venkatasubramanian, and R. G. Kavasseri, “Direct computation of
generator internal states from terminal measurements,” in Proc. 37th
Annu. Hawaii Int. Conf. Syst. Sci., 2004.

[47] M. E. Baran, and F. F. Wu, “Network reconﬁguration in distribution
systems for loss reduction and load balancing,” in IEEE Transactions
on Power Delivery, vol. 4, no. 2, pp. 1401–1407, Apr 1989.

Fig. 6. True and estimated attack signals: The rows and columns correspond
to measurements and time steps, respectively. In the subﬁgures, the color
indicates the attack signal: red is a positive attack, green is a negative attack,
and black is no attack. Only measurements of the inverter-interfaced power
supply buses and their corresponding ﬁctitious buses are corrupted by the
attack. In subﬁgure “Estimation Error”, the black color indicates there is zero
estimation error for all measurements at all times.

[3] M. Ili´c and S. Liu, Hierarchical Power Systems Control: Its Value in a

Changing Industry. Springer, 1996.

[4] P. Kundur, et al., “Deﬁnition and classiﬁcation of power system stability
IEEE/CIGRE joint task force on stability terms and deﬁnitions,” IEEE
Trans. on Power Systems, vol. 19, no. 3, pp. 1387–1401, Aug. 2004.
[5] F. C. Schweppe and J. Wildes, “Power System Static-State Estimation,
Part I: Exact Model,” IEEE Trans. on Power Apparatus and Systems,
vol. PAS-89, no. 1, pp. 120–125, Jan. 1970.

[6] A. Abur and A. G. Exp´osito, Power System State Estimation: Theory

and Application. Marcel Dekker, Inc., 2004.

[7] J. Zhao, et al., “Power System Dynamic State Estimation: Motivations,
Deﬁnitions, Methodologies and Future Work,” IEEE Trans. on Power
Systems, 2019.

[8] H. Modir and R. A. Schlueter, “A Dynamic State Estimator for Dynamic
Security Assessment,” IEEE Trans. on Power Apparatus and Systems,
vol. PAS-100, no. 11, pp. 4644–4652, Nov. 1981.

[9] A. P. S. Meliopoulos, et al., “Dynamic State Estimation-Based Protec-
tion: Status and Promise,” IEEE Trans. on Power Delivery, vol. 32, no.
1, pp. 320–330, Feb. 2017.

[10] F. Pasqualetti, A. Bicchi, and F. Bullo, “Consensus computation in
unreliable networks: A system theoretic approach,” IEEE Trans. Autom.
Control, vol. 57, no. 1, pp. 90–104, Jan. 2012.

[11] F. Pasqualetti, F. Dorﬂer, and F. Bullo, “Attack detection and identiﬁca-
tion in cyber-physical systems,” IEEE Trans. Autom. Control, vol. 58,
no. 11, pp. 2715–2729, Nov. 2013.

[12] K. Manandhar, X. Cao, F. Hu, and Y. Liu, “Detection of faults and
attacks including false data injection attack in smart grid using kalman
ﬁlter,” IEEE Trans. Control Netw. Syst., vol. 1, no. 4, pp. 370–379, 2014.
[13] S. Bi, and Y. J. Zhang, “Graphical methods for defense against false-
data injection attacks on power system state estimation,” IEEE Trans.
Smart Grid, vol. 5, no. 3, pp. 1216–1227, May 2014.

[14] L. Liu, M. Esmalifalak, Q. Ding, V. A. Emesih, and Z. Han, “Detecting
false data injection attacks on power grid by sparse optimization,” IEEE
Trans. Smart Grid, vol. 5, no. 2, pp. 612–621, March 2014.

[15] Y. Mo, R. Chabukswar, and B. Sinopoli, “Detecting integrity attacks on
scada systems,” IEEE Trans. Control Syst. Technol., vol. 22, no. 4, pp.
1396–1407, July 2014.

[16] T. Alpcan, and T. Basar, “A game theoretic approach to decision and
analysis in network intrusion detection,” in Proc. 42nd IEEE Conference
on Decision and Control, vol. 3, Dec 2003, pp. 2595–2600.

[17] P. Srikantha and D. Kundur, “A DER attack-mitigation differential game
for smart grid security analysis,” IEEE Trans. Smart Grid, vol. 7, no. 3,
pp. 1476–1485, May 2016.

[18] M. Basseville, I. V. Nikiforov et al. , Detection of abrupt changes: theory
and application. Prentice Hall Englewood Cliffs, 1993, vol. 104.
[19] Q. Jiao, H. Modares, F. L. Lewis, S. Xu, and L. Xie, “Distributed (cid:96)2-gain
output-feedback control of homogeneous and heterogeneous systems,”
Automatica, vol. 71, pp. 361–368, 2016.

[20] S. Abhinav, H. Modares, F. L. Lewis, F. Ferrese, and A. Davoudi,
“Synchrony in Networked Microgrids Under Attacks,” IEEE Trans. on
Smart Grid, vol. 9, no. 6, pp. 6731–6741, Nov. 2018.

[21] H. Fawzi, P. Tabuada, and S. Diggavi, “Secure estimation and control
for cyber-physical systems under adversarial attacks,” IEEE Trans. on
Automatic Control, vol. 59, no. 6, pp. 1454–1467, June 2014.

