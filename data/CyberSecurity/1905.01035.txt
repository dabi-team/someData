Secure Integration of Electric Vehicles with the
Power Grid

Chaitra Niddodi*, Shanny Lin+, Sibin Mohan*, and Hao Zhu+

*University of Illinois at Urbana-Champaign
+University of Texas at Austin

9
1
0
2

g
u
A
4

]

Y
S
.
s
c
[

4
v
5
3
0
1
0
.
5
0
9
1
:
v
i
X
r
a

Abstract—This paper focuses on the secure integration of
distributed energy resources (DERs), especially pluggable electric
vehicles (EVs), with the power grid. We consider the vehicle-to-
grid (V2G) system where EVs are connected to the power grid
through an ’aggregator’1. In this paper, we propose a novel Cyber-
Physical Anomaly Detection Engine that monitors system behavior
and detects anomalies almost instantaneously (worst case inspec-
tion time for a packet is 0.165 seconds2). This detection engine
ensures that the critical power grid component (viz.,aggregator)
remains secure by monitoring (a) cyber messages for various state
changes and data constraints along with (b) power data on the
V2G cyber network using power measurements from sensors on
the physical/power distribution network. Since the V2G system
is time-sensitive, the anomaly detection engine also monitors the
timing requirements of the protocol messages to enhance the safety
of the aggregator. To the best of our knowledge, this is the ﬁrst
piece of work that combines (a) the EV charging/discharging
protocols, the (b) cyber network and (c) power measurements
from physical network to detect intrusions in the EV to power
grid system.

Index Terms—Cyber-Physical, Security, Intrusion Detection,

Vehicle-to-Grid, Electric Vehicles, Anomaly Detection

I. INTRODUCTION

The power grid is one of the critical infrastructures of a
nation. It is a complex cyber-physical system (CPS) often
with time sensitive properties. Any problem that affects the
in damage to life, property or the
power grid can result
environment. With increased automation, technological and
communication advances, multiple new components and sys-
tems are interacting with the grid. Some notable examples
are the distributed energy resources (DERs) such as plug-
gable electric vehicles (EVs), solar arrays, smart homes and
industrial building automation systems. With this increased
connectivity and plethora of applications comes more oppor-
tunities for malicious entities to gain access to critical systems
and potentially wreak havoc with essential components of the
power grid. Attackers could use the communication channels
between the DERs and the power grid to potentially take
control of or even shut down critical grid components

There exist multiple challenges in securing power grid
systems: (a) the grid has many legacy systems that may not
know how to interact, in a secure manner, with the newer
applications such as EVs; (b) attacks on edge devices (such

1Aggregator is the component in the V2G system that connects EVs to the

power grid (Fig. 1)

2Minimum latency on V2G network is 2 seconds

Fig. 1: Conceptual Architecture of
(V2G)system. [3]

a Vehicle-to-Grid

as DERs) are difﬁcult
the grid level due to
to detect at
the lack of visibility into their operational details; (c) new
systems such as the Vehicle-to-Grid (V2G) introduce new
components such as EVs, aggregators and electric vehicle
supply equipment (EVSEs) to the grid, each of which can have
additional vulnerabilities; (d) these systems also introduce
new communication paths that raise new issues dealing with
coordination among multiple stakeholders and ﬁnally (e) new
infrastructure must be set up for managing credentials for
the new components and their operators. In fact, it is well
documented that the power grid is vulnerable to a wide range
of attacks [1].

With the increasing number of EVs (e.g., Tesla), the com-
munication complexities in the V2G system have increased.
EVs not only participate in drawing current from the grid
to charge themselves but they also act as batteries that can
discharge to the grid during periods of high power demand
[2]. Hence, EVs are fast becoming an important type of DER
that closely interact with the grid.

Figure 1 presents a high-level conceptual architecture
of the power grid with multiple EVs connected to it. The
“aggregators” [4] in this ﬁgure are the entities that act as
mediators between the end DER systems (the EVs in this
case) and the power grid utility system. A single aggregator
can manage multiple EVs (usually in close geographic
proximity). In the model presented, the aggregator can be

 
 
 
 
 
 
intrusion at

a prime target for attackers since (i) it manages multiple
EVs and (ii) is also directly connected to the power grid
the aggregator
utility system. A successful
level can have serious consequences for the power grid.
Therefore, ensuring the security of this critical component
(viz.,aggregator) is essential to ensure secure integration of
DERs such as EVs with the power grid. To this end, we
propose a Cyber-Physical Anomaly Detection Engine with
mechanisms to detect anomalous behavior in aggregators of
the V2G system. For our anomaly detection engine, we rely
on both the cyber and physical properties of the system. On
the cyber side, we focus on the communication protocol in
the V2G system to ensure correct operation of the aggregator,
while we validate its behavior using the physical side of the
system in the form of power measurements.

The main contributions of this work are:

1) An enumeration of the correct sequences of commands
in the V2G communication protocol. This is used to
generate an aggregator state machine for our detection
engine (§V-A)

2) Development of a Cyber-Physical Anomaly Detection
Engine that can detect malicious activity at the aggregator
level as soon as they occur. The anomaly detection engine
monitors communication on the V2G cyber network using
power measurements from sensors on the physical/power
distribution network (§V-D). It also makes use of timing
constraints related to frequency of periodic messages
(§V-B) and subscription period (§V-C) to differentiate
between correct/incorrect system behavior.

3) Implementation and evaluation of a prototype of the
Cyber-Physical Anomaly Detection Engine (§VI and
§VII)

While there are some intrusion detection systems designed
for components of the power grid system (as discussed in
detail in §IX), to the best of our knowledge there are none
that combine cyber and physical properties of the system
along with communication standards for EVs. Hence, there
is no direct comparison possible while evaluating our cyber-
physical anomaly detection engine. Our evaluation consists
of measuring the accuracy and performance of our anomaly
detection engine as described in §VII. The simple model of
our anomaly detection engine enables it to detect anomalies
accurately and almost instantaneously.

II. VEHICLE-TO-GRID SYSTEM

Fig.1 shows the conceptual architecture of the V2G system.
The main components in this system include EVs, aggregators
and the power grid. EVs not only act as loads but can also
feed power back to the grid. The EV to power grid operations
considered in this paper are (a) charging where EV draws
power from the grid, (b) discharging where EV supplies power
to the grid during times of peak power demand and helps to
reduce the load on the grid

coordinating discharging operation. This is because individual
EVs have very small power capacities in comparison with the
scales of power generation and distribution at the power grid.
Therefore, for efﬁcient discharging operations, a large number
of EVs are required. An aggregator manages multiple EVs
and helps in efﬁciently managing these operations [2]. With
aggregators acting as intermediaries between the utility power
grid operator and the EVs [4], all communication messages
between the EVs and the power grid pass through aggregators.
The requirements and speciﬁcations for communication
between the EVs and the electric power grid are established by
the SAE communication standards [5]. SAE J2847/1 standard
provides speciﬁcations for forward power ﬂow viz.,charging
operation between the EVs and the power grid [5]. Whereas,
SAE J2847/3 standard provides speciﬁcations for reverse
power ﬂow viz.,discharging operation between the EVs and
the power grid [5].

Integration of distributed sources of energy such as EVs
with the power grid comes with the penalty of making the
grid susceptible to a range of cyber-physical attacks. These
include large scale attacks if many of these edge devices
viz.,EVs, are compromised. The growing number of sophisti-
cated attacks (§IV), necessitates the need for the development
of an advanced cyber-physical attack detection and resiliency
framework.

III. SYSTEM MODEL

Fig. 2: System Model: EVs intermittently charging at homes

Fig.2 highlights the system under consideration along with
the various components and relevant connections in the cyber
and physical networks. Multiple buildings (e.g., households)
are connected to the aggregator with multiple EVs connected
to each building. The Cyber-Physical Anomaly Detection
Engine residing at the aggregator receives inputs from both
the cyber as well as physical networks. We assume a second
cyber network connecting the sensors in the physical network
/ power distribution network to the Cyber-Physical Anomaly
Detection Engine in order to receive power measurements. For
the purpose of evaluating the performance of our system, we
assume that this second cyber network has similar properties
(in terms of bandwidth etc) as the cyber network in the V2G
system.

The role of aggregators as mediators between end users
(viz.,EVs) and the utility operator is particularly useful in

As part of the cyber network, the EVs are the only type
of load being considered, i.e, only the packets exchanged

2

between the EVs and aggregator are taken as input for anomaly
detection. As part of the physical network, the aggregated
proﬁle of all household loads at the entry point is taken as
input for anomaly detection. Individual household loads such
as air conditioning, appliances, electrical outlets, heating and
lighting loads etc. make up the majority of the non-EV loads
in the aggregated proﬁle. In this model, we assume that the
physical network and cyber network are not compromised
simultaneously, i.e., we assume that the inputs obtained from
atleast one of these networks are genuine.

IV. THREAT MODEL

With reference to the power grid, security issues manifest as
safety/reliability concerns where attackers try to bring down
system reliability. The attacks in a V2G system can be broadly
classiﬁed into Network-based attacks and Component-based
attacks. Network-based attacks are the ones where the V2G
communication network is compromised. These include Man-
in-the-middle attacks (MITM) that either passively intercept
and observe the communication by eavesdropping or actively
modify communication by injection, replay or repudiation of
trafﬁc. Denial of Service (DoS) attacks on the V2G network
include jamming of signals and dropping of packets. For
instance, when EVs initially connect to the grid, information
such as customer details and location data are exchanged.
Eavesdropping on such information compromises customer
privacy. As another example, transmitted control commands
and updating ﬁrmware, software, drivers etc. also affect sys-
tem stability, safety and reliability. Active modiﬁcation of
such trafﬁc has an impact on the functioning of the V2G
components [8]. Component-based attacks are those attacks
where one or more of the components in the V2G system
are compromised. These include violation of authentication
and/or authorization at the utility system (components of the
power grid including aggregators), spooﬁng of utility system
components, compromise of end devices (Electric Vehicles)
and Denial of Service (DoS) attacks on utility system com-
ponents by the exhaustion of resources at aggregator and/or
Power Grid. These threats make the V2G sub-system of the
power grid highly susceptible to attacks.

Based on the above possible attacks in a V2G system [8]–
[10], Tab.I shows the attacks that our Cyber-Physical Anomaly
Detection engine focuses on. There have been instances of
attacks involving modiﬁcation of current to cause a ﬁre [11].
Multiple studies [12], [13] have shown that EVs can offer sig-
niﬁcant services to improve grid stability. It therefore follows
that compromising a large number of EVs and in turn a large
number of aggregators using the above attacks (Tab. I) could
cause grid instabilities. Hence securing the component that
connects EVs to the power grid viz.,aggregator is of paramount
importance for the safe operation of the power grid.

TABLE I: Threat Model

No. Attack

Effect

1

2

3

4

5

Compromise of EVs or the cyber
network to report more power than
actually consumed

Compromise of EVs or the cyber
network to report less power than
actually consumed

Compromise of EVs, the cyber net-
work or the power network causing
packets to be generated out of ex-
pected sequence
Compromise of EVs, the cyber net-
work or the power network causing
EVs to charge/discharge beyond
their subscription periods
Compromise of EVs, the cyber net-
work or the power network caus-
ing periodic message packets to be
generated more or less frequently
than expected

the ag-
DOS attacks at
gregator preventing more
EVs from connecting to
aggregator
Could cause transformer
overheating due to more
EVs connecting to aggre-
gator
Disrupt the correct func-
tioning of aggregator to
cause aggregator instabil-
ities
Disrupt the correct func-
tioning of aggregator to
cause aggregator instabil-
ities
Disrupt the correct func-
tioning of aggregator to
cause aggregator instabil-
ities

information from multiple sources to monitor the system as
shown in Fig.2. Anomalous incoming packets to the aggre-
gator are dropped thereby ensuring intrusion tolerance at the
aggregator.

The anomaly detection engine includes (a) message se-
quence validation (b) message frequency validation (c) sub-
scription period validation and (d) power measurement val-
idation to detect anomalies in system behavior as shown in
Fig.3. An anomaly is detected whenever the system deviates
from the expected system behavior. Expected system behavior
is deﬁned based on the communication standards in the V2G
system, as discussed in detail below.

Fig. 3: Components of Cyber-Physical Anomaly Detection
Engine

A. Message Sequence Validation

V. CYBER-PHYSICAL ANOMALY DETECTION ENGINE

We have designed a Cyber-Physical Anomaly Detection
Engine for the aggregator that detects unexpected packets
during communication. This anomaly detection engine uses

The sequences of messages in incoming packets are vali-
dated. To do this, an aggregator state machine is created with
valid states and state transitions. This state machine is based
on valid message sequences established by communication

3

standards between the aggregator and the EVs as well as
between the aggregator and the power grid. The requirements
and speciﬁcations for communication between EVs and the
electric power grid are established by the SAE J2847/1 stan-
dard for forward power ﬂow that includes charging [5], [5]
and SAE J2847/3 standard for reverse power ﬂow that includes
discharging [5]. A list of valid messages or commands between
the aggregator and the EVs as well as the aggregator and the
power grid is created. Then a list of valid command sequences
formed by these messages is created to verify if the packets
coming into and going out of the aggregator follow these valid
sequences. These valid messages and message sequences are
in accordance with the SAE communication standards.

Since the SAE standards are proprietary, complete details
are not provided. However, sufﬁcient details on the types and
sequences of messages are provided below in Fig. 4 for a
better understanding of our work.

Fig. 4: Sub-states of the aggregator state machine.

Fig. 4 shows the various messages in each of the two EV-
grid operations, (a) charging, (b) discharging. It also shows
the principal sub-states in the aggregator state machine that
are generated from the list of valid command sequences
enumerated for the three EV-grid operations. The state diagram
captures the various states and state transitions when EVs are
subscribed i.e., connected to the power grid (denoted by ’S’)
as well as when they are not subscribed to the grid (denoted
by ’NS’). When subscribed, EVs can be involved in any one
of the three aforementioned EV-grid operations. Each state
represents a sequence of messages. The state transitions in
various cases are as follows:

a) Subscribed and Charging / Discharging - Flow reser-
vation is the process in which the EV is assigned a
subscription period (i.e., period when connected to the
grid) for charging/discharging. First, a ﬂow reservation
is established. This may be followed by one or more
new ﬂow reservations after cancellation of a previously
established ﬂow reservation. Once the subscription pe-
riod begins, the EV starts sending periodic power status
updates (i.e., information related to the amount of power
drawn) to the grid through the aggregator. In parallel, it
also periodically fetches the ﬂow reservation list from the

4

grid, through the aggregator, to check for any updates in
the subscription period.

b) Not subscribed - when the EV is not subscribed to the
power grid (i.e., not engaged in any of the three EV-grid
operations), it periodically fetches updates on pricing and
load control related information from the grid to make a
decision on when to charge / discharge.

This component of the anomaly detection engine handles
attack 3 in Tab.I.

B. Message Frequency Validation

Power grid systems such as V2G system must satisfy
certain time related constraints. Our anomaly detection engine
monitors incoming packets to ensure that timing constraints
are enforced. Periodic messages have a predeﬁned frequency.
The frequency of such periodic messages coming into the
aggregator are monitored. At the aggregator, the frequency of
a given periodic message is monitored by checking the time
elapsed between two occurrences of the message. Therefore,
it is not required that the clocks at the aggregator and the EVs
be synchronized. This component of the anomaly detection
engine handles attack 5 in Tab.I.

C. Subscription Period Validation

Message data in the packets coming into the aggregator are
validated. Analysis of message data in packets is particularly
useful for monitoring the aggregator/EV communication that
involves a highly vulnerable edge device viz.,the EV. Two
important parameters in the EV to power grid communication
that are most likely to be tampered by adversaries are:

a) the subscription period, that deﬁnes the duration of charg-
ing/discharging during the respective operations and
b) the state of charge (SOC), that deﬁnes the percentage of

charge in the battery of the connected EV.

Hence, we need to inspect packets to monitor these quan-
tities. During charging and discharging operations, the EV
periodically fetches the ﬂow reservation list from the grid
while also periodically updating its power status to the grid.
The ﬂow reservation list contains the start and end of the
subscription period. This data is used to verify that there are no
power status updates outside the speciﬁed time interval. Power
status updates occur only during the subscription period. This
component of the anomaly detection engine handles attack 4
in Tab.I.

The power status update messages contain vehicle SOC
related information in terms of amount of power drawn. These
power measurements are validated against physical power
measurements as discussed next.

D. Consistency of Cyber and Physical States

We develop additional security checks to verify the consis-
tency of cyber states with the physical states. Power measure-
ments related to the EV charging load can be obtained from
the sensors installed on the power distribution grid. Potential
sources for the actual power data include the connected
EV charging equipment, smart meters and distribution line

measuring devices. These sensors are assumed to be able to
report the instantaneous active power or even complex power
readings that are time-stamped for validating the cyber states
of EV activities.

To this end, let P (t) denote the active power measurement
for time period t, with the time resolution of ∆t. We plot a
sample daily proﬁle of P (t) for an actual residential home in
Fig. 5a, both with and without the EV charging load. The
residential home power demand and the EV charging data
are obtained from the Pecan Street database at a minute-
level sampling rate [14]. As observed from the data, the EV
charging load exhibits unique pattern that is different from
other residential appliances and devices. First, the EV power
demand is at least 3kW and also higher than that of other
typical household loads [15]. Based on the observed power
proﬁles from the Pecan Street dataset, only the air-conditioning
load has a comparable level of power demand. Second, the EV
charging typically lasts for hours at the constant rated power
demand level, which is different from the periodic pattern of
air-conditioning load. Therefore, for the EV load, there is a
noticeable change only at the start and end time points of
charging.

To better demonstrate this feature of EV load, we process
the power data using a simple high pass ﬁlter to determine the
rate of change between two consecutive data points, namely
∆P (t) = P (t) − P (t − ∆t). To capture the fast change due
to EV charging, the sampling rate of the power data needs to
be sufﬁciently high to show that the EV can reach its rated
power within two minutes while all other residential loads stay
relatively unchanged. If the sampling rate increases, one may
need to perform more sophisticated ﬁltering process to recover
the EV charging states.

The ﬁltered output for the residential home load with EV
charging in Fig. 5a from approximately 3:35 – 6:00 AM
is illustrated in Fig. 5b. Note that
the negative power in
the aggregated load in Fig. 5a is due to PV generation.
The ﬁrst spike in the plot represents the time instant when
the EV charging started, reaching its rated power of around
3kW within two minutes. Note that when the charging ended
for this 3kW rated EV, its power consumption slowly drops
from the rated power and is therefore not noticeable from
the ﬁltered output. However, for EVs rated around 6kW or
higher from the Pecan Street dataset, the end charging time
is more noticeable from the ﬁltered output. Speciﬁcally, the
’end charging’ characteristics are very similar to the ’start
charging’ ones as the EV’s power consumption drops from
its rated power to zero within two minutes. This will result in
a negative spike in the ﬁltered output with a magnitude close
to its rated power.

The power data spike due to start/end of EV charging can
be used to verify the physical state when a packet with power
measurement message is detected on the cyber network. Note
that if the load proﬁle is at sufﬁciently high sampling rate, it
is unlikely that there is other major load change activity at
the start/end time of EV charging. Therefore, the turn-on/-off
events of air-conditioning loads will not confuse the engine

with a potential EV activity. If the sampling rate gets slower,
it will be necessary to smooth out the non-EV loads in order
to determine the power spike from EV charging. Note that this
may reduce the conﬁdence in physical state veriﬁcation part
due to the existence of other heavy loading appliances with
periodic patterns (i.e., air-conditioning load). This component
of the anomaly detection engine handles attacks 1,2 in Tab.I.
We have performed a design space exploration for many
combinations of EV and household numbers for the SAE
protocol family (Fig. 2). For instance, (i) it can handle multiple
EVs at a single household even if they start charging at
the same instance of time. In which case, the total power
consumed by these EVs is used to validate consistency on
cyber and physical sides (ii) it can can detect even if an EV
stops charging partway before reaching 100%

VI. IMPLEMENTATION

To evaluate the anomaly detection engine, we implemented
a prototype in Python2.7 on the Intel i7 NUC platform with
speciﬁcations as follows:

• Platform - Intel i7 NUC
• Processor - Intel(R) Core(TM) i7-7567U CPU @ 3.5

GHz, 4 cores

• Memory - 32 GB RAM, 128 GB HDD
• Operating System - Ubuntu 16.04
The algorithm for anomaly detection is as shown in Al-
gorithm 2 in Appendix. The engine inspects all the received
packets from EVs and ﬁlters out the malicious ones. To handle
multiple EVs at an aggregator, there are multiple instances
of packet inspection that execute in parallel, each instance
monitoring a single EV. The source EV of each received packet
is ﬁrst identiﬁed based on its IP address and the packet is then
passed onto the corresponding instance of packet inspection
(Algorithm 3 in Appendix). Based on the output from the
packet inspection module, the packet is either dropped or
output. The algorithm for packet inspection as detailed in §V
is shown in Algorithm 4 in Appendix.

Algorithm 6 in Appendix is used to validate the consistency
of the cyber and physical states by detecting anomalies in
the EV charging. To detect
the EV chrg state from just
the aggregated load perspective, we ﬁrst pass the aggregated
load through a high pass ﬁlter described in Algorithm 5 in
Appendix. Next, Algorithm 1 in Appendix is used to determine
the EV ’chrg state’ by searching for a ∆P within an acceptable
range of EV rated power that corresponds to a ’start charging’
or ’stop charging’ event.

VII. EVALUATION

Our focus is to secure the aggregator, a critical component
of the V2G system, thereby increasing the reliability and the
resiliency of such systems against cyber attacks. Power grid
systems are often time-sensitive. Therefore, our goal is to not
only detect anomalies accurately but to also do so as soon
as a malicious network packet arrives at the aggregator. The
anomaly detection engine is placed at the aggregator in the
V2G system as shown in Fig. 2. This makes it important to

5

(a) Load proﬁle of a residential home with and without the EV charging
load.

(b) Filtered output of the total EV included load in Fig. 5a during the
EV charging period.

a

Fig. 5: Power proﬁles

ensure that it does not introduce signiﬁcant delay to the packet
transfer rate at the aggregator. We evaluate the prototype of our
anomaly detection engine for both accuracy and performance:
1) Accuracy is measured in terms of false positives and false

negatives.

2) Performance is measured in terms of average and worst
case time taken by the anomaly detection engine to
inspect one packet and compared with minimum network
latency.

Note that as mentioned previously, since there are no existing
anomaly detection engines to the best of our knowledge that
combine cyber and physical properties along with communica-
tion standards for this type of system (§IX), direct comparisons
are not possible.

Power Data for EV Charging - Packets on the cyber
network are generated based on EV power proﬁle data for
charging obtained from the Pecan Street database at a minute-
level sampling rate [14]. This data consists of timestamps
and corresponding power measurements with respect to each
EV, from which all required information (such as subscription
period) for packet generation can be extracted.

Power Data for EV Discharging - Using the above EV
charging data, we formulated the data for EV discharging
based on efﬁciency formulas from paper [16]. From equation
(12) in the reference paper [16], the magnitude of EV charg-
ing/discharging power from/to the power grid is described as
follows

|Pgrid| =






EVrated
η1

= |Pc|

EVrated ∗ η2 = |Pd|

(1)

EVrated is the rated EV power, η1 is charging efﬁciency, η2
is discharging efﬁciency, |Pc| is the magnitude of EV charging
power and |Pd| is the magnitude of EV discharging power.
Using algebraic manipulation and substituting EVrated, we
obtain the magnitude of EV discharging power as a function of
EV charging power. From the reference paper [16], we obtain
the charging and discharging efﬁciencies in Table II as 0.92

and 0.92 respectively. Plugging these values into the previous
equation, we get the magnitude of the EV discharging power
is approximately 85% of the EV charging power.

|Pd| = |Pc| ∗ η1 ∗ η2 = |Pc| ∗ 0.92 ∗ 0.92 = |Pc| ∗ 0.846 (2)

Currently, there are no EVs/EVSEs that support the SAE
J2847/1 and SAE J2847/3 standards since these communica-
tion standards are still in the process of development. There
towards making the real world
has been signiﬁcant effort
implementation of SAE standards feasible [17], [18]. Once
these standards are implemented, our anomaly detection en-
gine can be easily integrated with them. Therefore, to test our
anomaly detection engine, we generate packets with custom
HTTP payloads according to speciﬁcations provided by SAE
communication standards [5]. The simulation is carried out on
an Intel i7 NUC (§VI). Further details on how the packets are
generated are provided below.

A. Accuracy

Testcases to test for false positives are generated based on
certain ground truth and testcases to test for false negatives
are obtained by modifying the former testcases to introduce
various kinds of anomalies.

Message Sequence Validation - The ground truth for
testcase generation here is the SAE standards [5]. (a) Test-
cases for false positives include all possible valid sequences
consisting of parallel as well as repeating sequences. Due to
the possibility of a lot of valid variations, there is a large
number of these test cases. For instance, consider the charging
operation. As shown in Fig. 4, ﬁrst a ﬂow reservation with
or without cancellation is performed (note the existence of
two possibilities already). Then the EV starts sending periodic
power updates to the grid during its subscription period for
charging. In parallel, the EV also periodically fetches the ﬂow
reservation list from the grid. Periodic messages give rise to
repeating sequences and increase the number of possible valid
variations. Similarly, parallel sequences of messages (power

6

updates and fetching of ﬂow reservation list in this case)
also increase the number of possible valid variations. This
is because one or more messages from a parallel sequence
(say, power updates in this case) can arrive anywhere between
messages in a related parallel sequence (fetching of ﬂow
reservation list
in this case). The sequence to which the
message belongs is identiﬁed using the message data. (b)
Testcases for false negatives were generated by randomly
placing invalid packets amidst valid sequences.

Message Frequency Validation - The ground truth for
testcase generation here is again the SAE standards [5]. (a)
Testcases for false positives consisted of packets with ex-
pected message periodicities. (b) Testcases for false negatives
consisted of packets containing messages with periodicities
different (i.e., periodicities lower and higher than expected
values) from expected values as speciﬁed in the SAE standards
[5].

Subscription Period Validation - The ground truth here is
based on the data obtained from the Pecan Street database
[14]. (a) Testcases for false positives consisted of packets
with subscription periods consistent with the aforementioned
data. (b) Testcases for false negatives consisted of packets
with inconsistencies where the actual subscription period was
different from previously agreed upon subscription period, i.e,
the arrival time of packets containing power status updates
were modiﬁed so as to be different from the time intervals
speciﬁed in packets containing the ﬂow reservation list.

Consistency of Cyber and Physical States - We have a
high certainty on detecting the stop charging time for EVs
with higher rated power versus EVs with lower rated power
for two reasons. The ﬁrst is that the stop charging characteristic
for higher rated EVs is very similar to the start charging
characteristics of EVs except that it will drop from its rated
power to zero within two minutes. The lower rated EVs take
longer than two minutes to stop charging so there will not
be a noticeable negative spike in the ﬁltered load sequence.
the higher rated EVs are less
The second reason is that
sensitive to non-EV loads changes. For instance, if an 1.5kW
AC unit starts/stops around an EV start/stop event, it will
effect the total ∆P of two consecutive time stamps. In the
worst case scenario, the AC will reach its rated power within
one minute. The AC rated power is 50 percent of an EV
rated at 3kW which will force ∆P out of the acceptable
range of start/stop charging values. The AC rated power is
only 25 percent of an EV rated at 6kW, however, ∆P will
usually be barely within range of acceptable start/stop charging
values making higher rated EVs less sensitive to non-EV
load changes. The ground truth here is again based on the
power data obtained from the Pecan Street database [14]. (a)
Testcases for false positives consisted of packets with power
measurements consistent with this data. During steady state
charging, the EV power should not vary beyond +/- 0.5kW
in the worst case scenario. Any power measurement beyond
this range is considered anomalous. (b) Testcases for false
negatives makes use of this fact, i.e., it consists of packets
with inconsistencies with respect to power measurements, i.e,

Fig. 6: Performance of the Anomaly Detection Engine

power measurements were varied to be above and below this
permissible range of +/- 0.5kW.

B. Performance

Minimum network latency - According to the smart
grid communication requirements speciﬁed by the Department
of Energy, the minimum network latency with reference to
Electric Transportation is 2 seconds [19]

Worst case time taken - We compare the worst case time
taken by the anomaly detection engine to inspect a packet
with the minimum network latency to determine whether or
not the anomaly detection engine introduces signiﬁcant delay.
The worst case time taken to inspect a packet is when it goes
through the longest datapath in the anomaly detection engine.
The 99.9th percentile worst case time is 0.165 seconds.

Average time taken - In this evaluation, the total number
of EVs that are simultaneously handled by the aggregator has
been varied (up to a maximum of 400) based on literature [20].
As shown in Fig. 2, there are multiple households connected to
a single aggregator with (possibly) multiple EVs connected to
each household. The power measurements originally obtained
from the Pecan Street database [14]) contains individual EV
loads as well as the corresponding aggregated loads at house-
holds where one household has just one EV associated with it.
We have modiﬁed this power data as follows: (i) In order to
simulate multiple EVs connected to each household, we ﬁrst
assign charging/discharging start times to include situations
where multiple EVs at one household start to charge/discharge
either at the same instance of time or at different instances of
time. Then, we compute the operation end times while keeping
the duration of operation unchanged. Note that we are only
modifying the charging/discharging start times for EVs i.e., we
are just sliding the EV charging/discharging duration windows
(Algorithm 7 in Appendix). (ii) To simulate multiple such
households being simultaneously connected to the aggregator,
we replicated the power data per household. The average time
taken by the anomaly detection engine to inspect a packet
is approximately 0.014 seconds as shown in Fig. 6. Tab. II
summarizes these results.

TABLE II: Performance of Anomaly Detection Engine

Minimum
Network
Latency
2 seconds

case
per
inspection

Worst
packet
time
0.165 seconds

Average per packet
inspection time

0.014 seconds

As stated previously (§III), we assume that

the cyber
network connecting physical network sensors to the anomaly

7

detection engine has similar properties (in terms of bandwidth
etc) as the cyber network in the V2G system. Therefore, the
individual EV power measurements on the V2G cyber network
and the corresponding aggregated power measurements on the
sensor cyber network are received by the anomaly detection
engine simultaneously (i.e., without any delay).

VIII. DISCUSSION

As seen from the results in Tab. II, the worst case time to
inspect a packet i.e., 0.165 seconds is lesser than the minimum
network latency, i.e., 2 seconds. Therefore, our anomaly detec-
tion engine detects malicious packets almost instantly without
introducing signiﬁcant delay at the aggregator.

In all of our validation techniques, the consistency of data
obtained from one source is veriﬁed against data obtained
from a different source as explained next. This makes it
more difﬁcult to tamper with the data so as to produce false
consistencies. In case of Message Sequence Validation and
Message Frequency Validation, packets are veriﬁed against
information obtained from the communication standards doc-
umentation. For validating consistency of Cyber and Physical
States, power data reported in cyber messages is validated
against physical power measurements. In case of Subscription
Period Validation, subscription period related data is validated
using messages from the power grid side of communication
that contain ﬂow reservation list and messages from the EV
side of communication that contain power status updates.

Packet

loss can result

in certain packets either arriving
(at the aggregator) out of sequence or at unexpected times.
This might result in false positives being signalled by the
anomaly detection engine. However, rate of packet loss is
very low given the 99-99.99% network reliability requirement
for Electric Transportation in the Smart Grid [19]. Network
delays/jitters could also lead to false positives due to packets
arriving at an unexpected time. This can be handled by setting
an appropriate tolerance level with respect to time constraints.
Our anomaly detection engine has a complete list of all
possible valid states and state transitions. This eliminates the
likelihood of false negatives. Our evaluation is carried out
based on the previously stated assumption that
the inputs
obtained from atleast one of the cyber or physical networks
are genuine. If this is not true, then an attacker could tamper
with the cyber and physical states of the system to obtain
consistency and conceal the attack from our anomaly detection
engine.

IX. RELATED WORK

There has been a wide range of attacks on the power grid
that has triggered research towards securing its various com-
ponents such as the advanced metering infrastructure (AMI)
and smart inverters. Examples of intrusion detection systems
for cyber-physical systems include the work on securing the
advanced metering system by using speciﬁcation based intru-
sion detection [21]. This IDS monitors the cyber state of the
system by observing trafﬁc among access points and meters
at various layers to ensure expected behavior. We use similar

8

techniques to monitor the cyber state of a V2G aggregator. In
addition, we also check for consistency of cyber and physical
states of the system.

Apart from the various components of the power grid,
the distribution networks have also received attention. The
paper by Liao et al [22] focuses on enhancing power grid
security by using micro-synchrophasors as a tool to monitor
and manage distribution networks. The high ﬁdelity, time-
synchronized phase angle and voltage magnitude data obtained
from micro-synchrophasors helps track events originating at
local distribution. This work is similar to our work in that it
uses data from sensors for monitoring. However, in addition
to using sensor readings, our anomaly detection engine also
monitors other data constraints related to the communication
protocol speciﬁcations along with timing constraints related to
message frequencies and subscription periods.

there has been effort

With increase in number of DERs being integrated with
the power grid,
in the direction of
securing these DERs [23]. The paper discusses the architecture
of cyber-physical power system with penetration of DERs,
analyzes related cyber security challenges, summarizes impor-
tant attack scenarios and proposes a DER resilience analysis
methodology to prevent, detect and respond to attacks. The
paper provides a generalized analysis for DERs. However,
speciﬁc DERs have their own challenges. Our work focuses
on a speciﬁc DER, i.e., EVs.

With respect to the V2G system, implementation and op-
timization have so far received a lot of focus. The paper
by Guille et al [24] discusses a framework to integrate EVs
with the power grid. The paper by Mal et al [25] focuses
on optimizing the charging operation in the V2G system and
thereby efﬁciently balancing the load on power grid. However,
attention has recently shifted towards the security of EVs in the
power grid. Chen et al [26] propose an efﬁcient and secure au-
thentication scheme for V2G networks that preserves privacy.
The authentication scheme provides anonymity in the V2G
network. The paper focuses on securing the communication
of EVs in the V2G system of power grid. On the other hand,
our work focuses on securing the aggregator, an important
component of the V2G system, by increasing its resiliency to
attacks.

There is some related work on identifying EV charging
proﬁles for improving power distribution system operations.
The statistical characteristics of EV’s state-of-charge or the
duration of charging period have been studied in [27], [28]
by analyzing a ﬂeet of EV charging proﬁles. More recently,
a deep learning approach has been proposed in [29] to ex-
tract the EV charging proﬁle from the aggregated household
demand as a load disaggregation problem. However, we use
a similar ﬁltering mechanism but for a different purpose, i.e.,
anomaly detection to ensure security. We have developed a
simple approach for estimating EV charging status that is very
suitable for real-time implementation needs of the proposed
anomaly detection engine. Interesting future work opens up
on investigating the potential trade-offs between accuracy and
computational complexity for the task of determining EV

[17] R.M. Pratt, F.K. Tuffner, and K. Gowri, “Roadmap for Testing and
Validation of Electric Vehicle Communication Standards,”In Electric
Vehicle Symposium (EVS26), 2012.

[18] R.M. Pratt, F.K. Tuffner, and K. Gowri, “Electric Vehicle Communica-

tion Standards Testing and Validation Phase 1: SAE J2847/1,” 2011.

[19] DOE, “Communications Requirements of Smart Grid Technologies,”

2010.

[20] A. Y. Lam, K. Leung, and V. O. Li, “Capacity estimation for vehicle-
to-grid frequency regulation services with smart charging mechanism,”
arXiv:1410.1282v4 [cs.SY], 2015.

[21] R. Berthier, W. H. Sanders, and H. Khurana, “Speciﬁcation-based
intrusion detection for advanced metering infrastructures,” in PRDC,
2011.

[22] A. L. Liao, E. M. Stewart, and E. C. Kara, Micro-synchrophasor data for
diagnosis of transmission and distribution level events.
in Transmission
and Distribution Conference and Exposition (T and D), IEEE/PES, 2016.
[23] J. Qi, A. Hahn, X. Lu, J. Wang, and C. Liu, “Cybersecurity for
distributed energy resources and smart inverters,” in IET Cyber-Physical
Systems: Theory and Applications, 2016.

[24] C. Guille and G. Gross, “A conceptual framework for the vehicle-to-grid

(v2g) implementation,” Energy Policy, 2009.

[25] S. M. et al, Electric vehicle smart charging and vehicle-to-grid op-
International Journal of Parallel Emergent and Distributed

eration.
Systems, 2012.

[26] J. Chen, Y. Zhang, and W. Su, An anonymous authentication scheme
for plug-in electric vehicles joining to charging/discharging station in
vehicle-to-grid (v2g) networks. China Communications, 2015.
[27] W. Su and M.-Y. Chow, “Performance evaluation of an eda-based large-
scale plug-in hybrid electric vehicle charging algorithm.” IEEE Trans.
Smart Grid, 2012.

[28] K. Qian, C. Zhou, M. Allan, and Y. Yuan, “Modeling of load demand
due to ev battery charging in distribution systems,” IEEE Transactions
on Power Systems, 2011.

[29] S. Wang, L. Du, J. Ye, and D. Zhao, “Robust identiﬁcation of ev charging
proﬁles,” in 2018 IEEE Transportation Electriﬁcation Conference and
Expo (ITEC).

IEEE, 2018.

charging activity from aggregated load data.

X. CONCLUSION

In this work, we have presented a novel architecture of
a Cyber-Physical Anomaly Detection Engine that captures
the cyber and physical properties of the system along with
the related communication standards to deﬁne correct sys-
tem behavior. The simple model of our anomaly detection
engine demonstrates that accurate and almost instantaneous
detection of anomalies is feasible. Although our prototype
Cyber-Physical Anomaly Detection Engine is based on SAE
standards of communication for V2G system, this architecture
can be extended to other communication standards for other
DERs as well.

ACKNOWLEDGEMENTS

This work is supported in part by grants from the Dept. of
Energy (CEDS program - contract number DE-0E0000826)
and the National Science Foundation (NSF SaTC 1718952).
Any opinions, ﬁndings, and conclusions or recommendations
expressed here are those of the authors and do not necessarily
reﬂect the views of sponsors. The authors would also like to
thank Tim Yardley, Steve Granda, Devu Shila, Lynn Ren for
their useful discussions and ideas.

REFERENCES

[1] Nescor, ” Electric sector failure scenarios and impact analyses version

3.0”, 2015.

[2] M. A. Rahman, F. Mohsen, and E. Al-Shaer, “A formal model for
sustainable vehicle-to-grid management,” SEGS ’13 Proceedings of the
ﬁrst ACM workshop on Smart energy grid security, 2013.

[3] C. Niddodi, S. Mohan, and T. Yardley, “Securing electric vehicles in the
power grid,” in Proceedings of 29th Euromicro Conference on Real-Time
Systems (ECRTS17) Work-in-Progress Session, 2017.

[4] L. Gkatzikis, I. Koutsopoulos, and T. Salonidis, “The role of aggregators
in smart grid demand,” IEEE Journal on Selected Areas in Communi-
cations, 2013.

[5] SAE International, “What do SAE standards offer the Automotive

Electronics industry?,” 2009.

[6] SAE International, “Sae j2847-1 communication for smart charging of

plug-in electric vehicles using smart energy proﬁle 2.0,” 2013.

[7] SAE International, “Sae j2847-3 communication for plug-in vehicles as

a distributed energy resource,” 2013.

[8] R. Falk, and S. Fries, “Security Considerations for the Electric Vehicle
Charging Infrastructure,” IARIA Conference SECURWARE, 2012.
[9] Y. Zhang, S. Gjessing, H. Liu, H. Ning, L. T. Yang, and M. Guizani,
“Securing vehicle-to-grid communications in the smart grid,” IEEE
Wireless Communications, 2013.

[10] N. Saxena, S. Grijalva, V. Chukwuka, and A. V. Vasilakos, “Network
security and privacy challenges in smart vehicle-to-grid,” IEEE Wireless
Communications, 2016.

[11] T. Seals, “Electric Vehicle Charging Stations Open to IoT Attacks,”

2018.

[12] W. Kempton and J. Tomic, “Vehicle-to-grid power fundamentals: calcu-

lating capacity and net revenue,” in Journal of Power Sources, 2005.

[13] W. Kempton and J. Tomic, “Vehicle-to-grid power implementation:
from stabilizing the grid to supporting large-scale renewable energy,”
in Journal of Power Sources, 2005.

[14] “https://dataport.pecanstreet.org/”.
[15] H. Estes, S. Santoso, and G. Fisher, “Analysis of high-resolution electric
vehicle charging on time-of-use grid demands,” IEEE Power & Energy
Society General Meeting, 2015.

[16] L. Gkatzikis, I. Koutsopoulos, and T. Salonidis, “Decentralized vehicle-
to-grid control for primary frequency regulation considering charging
demands,” IEEE Transactions on Power Systems, 2013.

9

APPENDIX

Algorithm 2 Cyber-Physical Anomaly Detection Engine

Algorithm 1 EV Chrg State Identiﬁcation

1: Input: Output sequence of High Pass Filter, EV rated

power

2: Output: EV charge state sequence
3: //Determine initial chrg state from EV load proﬁle: 1 -

charging, 0 - not charging
4: if High EV rated power then
5:

if EV load power is within steady state power range
then

6:
7:
8:
9:
10:
11:
12:
13:
14:
15:

16:

17:
18:
19:
20:
21:
22:
23:
24:

25:
26:

27:

28:
29:
30:
31:
32:
33:
34:
35:
36:
37:
38: else
39:
40:
41:
42:

43:

44:
45:

set initial chrg state to 1

else

set initial chrg state to 0

end if
for i in ﬁltered load sequence do
//EV is currently not charging
if previous chrg state = 0 then
//Look for EV charging event
if current ﬁltered data point > 0 then

∆P = current ﬁltered load point + next ﬁltered
load point
if ∆P is within an acceptable range of EV rated
power then

//EV charging event detected
set chrg state to 1

else

set chrg state to 0

end if

end if

else

//previous chrg state = 1, look for stop charging
event
if current ﬁlter data point < 0 then

∆P = current ﬁltered load point + previous
ﬁltered load point
if ∆P is within acceptable negative range of EV
rated power then

//EV stop charging event detected
set chrg state to 0

else

set chrg state to 1

end if

else

set chrg state to 1

end if

end if
end for

//Lower EV rated power
for i in ﬁltered load sequence do

if current ﬁlter data point > 0 then

∆P = current ﬁltered load point + next ﬁltered
load point
if ∆P is within an acceptable range of EV rated
power then

//EV charging event detected
//Stop charging event cannot be detected - set a
constant charging time period
for t in constant charging time period do

set chrg state to 1

end for

else

set chrg state to 0

end if

46:
47:
48:
49:
50:
51:
52:
53:
54: end if

end if
end for

1: Input: All packets from EVs
2: Output: Benign packets from EVs
3: Spawn ’n’ instances of Packet Inspection module
4: for packet in packets do
5:
6:
7:
8:

instance i := Packet Identiﬁcation(cid:0)packet(cid:1)
if

instance i (cid:54)= -1 then
//Call ith instance of Packet Inspection
anomalous := Packet Inspection(cid:0)packet(cid:1)
if anomalous then
drop packet

9:
10:
11:
12:
13:
14:

else

output packet

end if

else

drop packet

15:
end if
16:
17: end for

Algorithm 3 Packet Identiﬁcation

1: Input: Packet
2: Output: Instance of Packet Inspection module
3: //Determine to which instance of Packet Inspection mod-

ule does packet belong

4: for i in instances do
5:
6:

//Checking src and dst IP addresses
if packet IP equals IP monitored by i then

7:
8:
9:
10:
11:
12:

return i

else

if i is free then

set monitoring IP of i to packet src IP and return i

else

return -1

end if

13:
end if
14:
15: end for

10

Algorithm 4 Packet Inspection

1: Input: Packet
2: Output: Packet is anomalous or not
3: if no packet received until timeout then
4:
5: else
6:
7:

transition to idle state

//Message Sequence Validation
if packet.payload matches expected packet.payload in
current state then

8:
9:

10:
11:
12:
13:
14:

15:

16:
17:
18:

19:
20:
21:

22:

23:
24:
25:
26:
27:
28:

//Message Frequency Validation
if (packet.arrivalTime - packet.lastArrivalTime) satis-
ﬁes frequency constraints then

update packet.lastArrivalTime

else

raise anomaly - inconsistent frequency

end if
//Subscription Period Validation
if
time
current
packet.payload
then

in
contains

subscription
power

period

and
update

status

pass

else

raise anomaly - invalid subscription

end if
//Cyber and Physical States Consistency Validation
match:=Power Validator(cid:0)packet.power,
packet.timestamp, packet.srcIP(cid:1)
//if power reported in packet matches ﬁltered EV
power from aggregated load power
if match is True then

pass

else

raise anomaly - inconsistent power

end if
transition to next state

raise anomaly - unexpected packet

else

end if

29:
30:
31:
32: end if
33: if anomaly raised then
34:
35: else
36:
37: end if

return anomalous

return not anomalous

Algorithm 6 Power Validator

1: Input: packet.Power, packet.timestamp, packet.srcIP
2: Output: True/False - Cyber and Physical States Consis-

tency Validation

3: //chrg state: 0 - not charging, 1 - charging
4: //Determine max and min steady state charging power for

packet.srcIP
5: //Determine

chrg

state
EV Chrg State Identiﬁcation
for packet.srcIP

from
at

output

of
packet.timestamp

//No EV charging for given packet.timestamp
return 0

6: if chrg state is 0 then
7:
8:
9: else
10:
11:

//chrg state is 1
if packet.power < min steady sate charging power for
packet.srcIP then

12:
13:

14:
15:
16:
17:
18:

if this is the ﬁrst packet sent then

//EV could be in the process of reaching its rated
power
return 1

else

return 0

end if

else if packet.power is within the range of max and min
steady state power for packet.srcIP then

return 1

return 0

else

19:
20:
21:
22:
23: end if

end if

Algorithm 7 Household Load Generator

1: Input: household power proﬁles without EVs, individual

EV power proﬁles, EV charging start times

2: Output: new household aggregated power proﬁles includ-

ing EVs, new individual EV power proﬁles

3: for all EVs do
4:
5:

if i-th EV is chosen to be included in household then

for all charging events of EV do

Algorithm 5 High Pass Filter

1: Input: Aggregated load sequence
2: Output: Filtered aggregated load sequence
3: for i in aggregated load sequence do
4:

i in ﬁltered aggregated load sequence = i in aggregated
load sequence + i-1 in aggregated load sequence

5: end for

6:

7:
8:

new EV charge end time = new EV charge start
time + (old EV charge end time - old EV charge
start time)

end for
generate aggregated household power proﬁle by
adding new EV power proﬁle to household power
proﬁle without EVs

end if
9:
10: end for

11

