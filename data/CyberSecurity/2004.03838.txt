A Moving-target Cyber-Attack Detection Strategy for Large-scale
Power Systems using Dynamic Clustering

Ana Jevti´c and Marija Ili´c

0
2
0
2

r
p
A
8

]

Y
S
.
s
s
e
e
[

1
v
8
3
8
3
0
.
4
0
0
2
:
v
i
X
r
a

Abstract—In recent years, cyber-security of power systems
has become a growing concern. To protect power systems from
malicious adversaries, advanced defense strategies that exploit
sophisticated detection algorithms are required. Motivated by
this, in this paper we introduce an active defense method based
on dynamic clustering. Our detection strategy uses a moving-
target approach where information about the system’s varying
operating point is ﬁrst used to cluster measurements according
to their transfer function characteristics that change over time.
Then, detection is carried out through series of similarity checks
between measurements within the same cluster. The proposed
method is effective in detecting cyber-attacks even when the at-
tacker has extensive knowledge of the system parameters, model
and detection policy at some point in time. The effectiveness
of our proposed detection algorithm is demonstrated through a
numerical example on the IEEE 24-bus power system.

I. INTRODUCTION

Cyber-security of power systems has become a very impor-
tant topic of research in the recent years. Events like the 2015
cyber-attack on the Ukrainian power grid [1], and recently
reported cyber incident that disrupted grid operation in the
western US [2] have led to the increase in awareness of
the problem of securing critical infrastructure, such as the
power grid, transportation systems, gas and water networks,
etc. The large scale of power systems, diversity and complexity
of its components, and, more recently, its exposure to the
public via smart devices with Internet connectivity, are some
of the factors that make cyber-security of power systems a
challenging problem. The literature on this topic is constantly
growing, but securing power systems against cyber-attacks is
still an open problem [3], [4], [5].

In order to ensure secure operation of the power system, it
is important to design and implement attack detection, which
enables the system to mitigate any malicious intrusions. In
general, this task is not trivial, since malicious attackers can
be very resourceful, have detailed knowledge of the power
system, and therefore launch highly effective and deceptive
attacks. Static attack detectors do not consider system dynam-
ics, but only the outputs of the system, which they check
for consistency at every time step [6], [7]. However, in [8]
it is shown that attacks undetectable by static detectors can
be constructed by the attacker. Stealthy attacks [9], replay
attacks [10], and zero-dynamics attacks [11] are all examples
of how an adversary can exploit knowledge of the system
to launch attacks that can evade detection by the existing
systems in power system control centers, namely State Esti-
mation (SE) and static fault detection via Bad Data Detection
(BDD). These attacks target SCADA (Supervisory Control
and Data Acquisition), or more precisely the measurements

of the system. Additionally, they don’t affect the physical
power system directly, but only through control and operating
decisions based on wrong information. However, no dynamic
detector can counter these attacks either, as they change the
output of the system in a way that the output could also result
from normal system behavior. References [12], [13], [14] all
provide dynamic attack detection algorithms. But in order to
detect stealthy attacks, another class of detectors is introduced,
namely active attack detectors. In contrast to passive detectors,
active detectors perturb the system either through topology
changes, or by injecting random signals into the network, in
order to expose stealthy attacks.

One recent approach to active defense introduces an addi-
tional random signal, or ”watermark”, to the control signal as
a form of authentication [15], [16], [10]. In normal operation,
this watermark should also be present in the measurement
signal, so it’s absence suggests that
the system has been
tampered with. This is a good defense strategy, especially
against replay attacks, but it is not effective in the case the
attacker has extensive knowledge of the system model and the
watermark. Another approach is to reveal the stealthy attacks
by modifying the system’s structure. Speciﬁcally, new mea-
surements can be added incrementally to reveal stealthy zero-
dynamics attacks [17]. Even though this strategy effectively
increases the robustness of the system, it is only successful
for attacks that are constructed off-line, and once they are
launched, the adversary can’t gain new information about the
changes in the structure of the system. Coding sensor outputs
[18], [19] is an economical way of detecting stealthy FDI
attacks when the attacker knows the system model without the
coding scheme. However, similarly to the previous approaches,
this strategy fails when the attacker has extensive knowledge
of the system. On the other hand, in [20] the authors assume
that the attacker without previous knowledge can ﬁrst identify
the system model by observing the control and measurement
signals. Then they provide a controller design method which
renders the system unidentiﬁable, but with a performance
trade-off.

To address these issues, in this paper we make the following
contribution. We propose a moving-target detection algorithm,
that takes advantage of natural variations in power system
dynamics, and varies its strategy accordingly in order to detect
stealthy FDI attacks. The main difference in our approach,
compared to the ones stated above, is that we don’t assume
that our detection strategy is always unknown to the adversary.
Even if the adversary has complete knowledge of the current
detection policy, system parameters and its structure at one
point in time, the natural ﬂuctuations of the system will render

 
 
 
 
 
 
that knowledge unusable as the time goes by. The operating
point of power systems, and therefore its dynamic behavior,
varies in time since the generation has to continually change to
satisfy the current demand. With that in mind, our main goal
is to quickly detect FDI attacks, before they have a chance to
cause potentially devastating damage to the system. With our
method, each incoming measurement is veriﬁed before being
used as a feedback signal in any control process. We perform
this veriﬁcation in two stages. First, we cluster all the system
measurements according to their dynamic response to natural
load variations during normal operation. Next, we verify each
incoming measurement by running a series of similarity checks
with other measurements from the same cluster.

Notation: Let R and N denote the sets of real and natural
numbers, respectively. Let Ik denote a set of integers, and |Ik|
∈ Rn×|Ik| is a matrix composed
its cardinality. Then, en
Ik
of column vectors of the identity matrix In ∈ Rn×n corre-
sponding to the index set Ik. Given a matrix M ∈ Rn×n,
we denote its transpose by M T , and its trace by tr{M }. We
use (cid:107)M (cid:107)F to denote the Frobenius norm of M , deﬁned as
(cid:107)M (cid:107)F = (cid:112)tr{M T M }. Furthermore, M is said to be Hurwitz
if every eigenvalue of M has strictly negative real part. Matrix
M is said to be semistable iff the zero eigenvalues of M
are semisimple (geometric multiplicity of each eigenvalue
coincides with its algebraic multiplicity), and all the other
eigenvalues have a negative real part. Given a stable proper
transfer function of a dynamical system g(s), (cid:107)g(s)(cid:107)H2 is the
H2-norm of the system, deﬁned as the energy of the system’s
impulse response. We use diag(v) to represent a diagonal
matrix having a vector v on its diagonal.

The remainder of this paper is structured as follows. In
Section II we formulate the problem of detecting FDI cyber-
attacks. Then, in Section IV-A we introduce relevant power
system component models and derive the dynamics of the
interconnected power system. In Section III, we present the
main contribution of this paper,
the moving-target attack
detection method. Section IV demonstrates the efﬁciency of
our proposed method through a numerical example on the
IEEE RTS 24-bus power system. Finally, in Section V we
give some concluding remarks.

II. PROBLEM FORMULATION

In this paper, we are concerned with detection of False
Data Injection (FDI) attacks that target measurements, without
affecting the physical behavior of the power system directly,
but through incorrect control actions. Figure 1 depicts the
block diagram representation of the system we consider. The
power system block represents various components, such as
generators, loads, transmission lines, etc. Two types of inputs
enter the power system block: controlled inputs u(t) enforced
by the actuators with the goal to stabilize and regulate the
power grid to the desired operating point x0, and uncontrolled
inputs or disturbances d(t) that represent changes in the
environment that cannot be controlled. In our context, d(t)
is the power consumed by the loads, which directly inﬂuences
control decisions and operation of the grid. More speciﬁcally,

Fig. 1: Block diagram of attacked power system in (5). The
attacker injects signal ya into measurements y in order to
manipulate the system.

in a linearized system, d(t) is the unpredictable variation of
load around the forecasted value. It is important to note that
this kind of disturbance does not act as noise in the system,
since control feedback loop is designed to drive the actuators
to balance these changes in load. Thus, we assume the physical
system follows:

˙x(t) = Ax(t) + B ˜u(t) + Gd(t)

(1)

where the states of system are denoted x ∈ Rn, the disturbance
is d ∈ Rm, the control signal issued by the Control Center
(CC) is ˜u ∈ Rp. A large network of ﬁeld sensors is deployed
to monitor the operation of the power system in (1). In normal
operation, the CC uses the measurements provided by these
sensors to estimate the current demand, and then dispatch the
generators accordingly. The actuators then adjust the power
outputs of the generators to meet the new demand. However,
the system by
a malicious attacker can negatively impact
manipulating the measurements, which is represented with the
added signal ya(t) in Figure 1:

˜y(t) = y(t) + ya(t)
y(t) = Cx(t)

(2)

(3)

where ˜y ∈ Rl are measurements received by the CC. Thus, a
potentially manipulated measurement signal ˜y reaches the CC,
which can then issue a potentially incorrect control signal ˜u
to the power system actuators:

˜u(t) = K ˜y = K[y(t) + ya(t)]

(4)

The control signal can then be decomposed as ˜u(t) = u(t) +
ua(t), where u(t) = Ky(t) and ua(t) = Kya(t). Thus, the
attacked system can be rewritten in closed-loop as:

(cid:40)

Σa :

˙x(t) = Ax(t) + Bya(t) + Gd(t)
˜y(t) = Cx(t) + ya(t)

(5)

where A = A + BKC is the closed-loop system matrix, and
B = BK.

Note that both signals d(t) and ya(t) are unknown. Now, the
challenge we tackle in this paper emerges: distinguish whether
a received measurement ˜y corresponds to physical changes in
the system created by d(t), or to malicious injection of ya(t)
into the communication channel with intent to manipulate the
control process. This is indeed a challenge when the attacks are
stealthy, i.e. designed to satisfy the dynamics of the underlying
system, so to be undetectable by traditional methods. This
kind of disturbance, that does not represent noise, but physical
changes in the system that are not predictable, can not be
neglected when designing an FDI detection ﬁlter. We will
demonstrate this in the next section.

A. Dynamic Detection Filter Based on Linear Observers

In this section, we will explain why dynamic attack detec-
tors based on linear observers may not be suitable for attack-
detection in systems that are described by (1), especially when
the unknown disturbance d(t) is not taken into account in the
observer design process. Under normal conditions (no cyber-
attack injected into the system, ˜u(t) = u(t)), a linear observer
is designed for the system in (1), to compute the state estimate
ˆx(t) from the received measurements:

˙ˆx(t) = Aˆx(t) + L(ˆy(t) − y(t))
= (A − LC)ˆx(t) + Ly(t)

ˆy(t) = C ˆx(t)

(6)

The error system can then be deﬁned as e(t) := ˆx(t) − x(t),
and its dynamics:

˙e(t) = (A − LC)e(t) − Gd(t)

(7)

It is well known that, if (A, C) is observable, L can be chosen
such that (A − LC) is Hurwitz, making the error system
exponentially stable [21] in absence of the disturbance d(t),
i.e when d(t) = 0. Finally, the residual rc(t) := ˆy(t) − y(t),
where ˆy is deﬁned in (6), can be expressed as

Thus, one can use this residual to successfully detect cyber-
attacks, as the error e(t) and residual rc(t) will both converge
to nonzero values only when a cyber-attack is present in the
system, i.e. ya (cid:54)= 0. On the other hand, in presence of the
disturbance d(t) (cid:54)= 0, both the error and the residual will
converge to nonzero values, e → e∗ (cid:54)= 0 and rc → r∗
c (cid:54)= 0,
even when the system is not under attack. Speciﬁcally, e∗(t) =
(A − LC)−1Gd(t) and r∗
c (t) = Ce∗(t). Thus, this observer
will have a nonzero residual even in absence of cyber-attacks.
If we also consider that the system is under attack, the error
dynamics become:

˙e(t) = (A − LC)e(t) + [(L − B)ya(t) − Gd(t)]
rc(t) = Ce(t) − ya(t)

Note that both the disturbance d(t) and attack signal ya(t)
enter the dynamics of the error system and residual. Therefore,
using a detection ﬁlter based on such observers to detect
FDI attacks on measurements may be ineffective for several
reasons. First, the effect of the disturbance d(t) in the error
dynamics may frequently trigger false alarms. Second, it will
be ineffective against stealthy attacks, since the signals d(t)
and ya(t) may not be distinguishable. Finally, it is clear that
dynamic attack detectors, that do not account for unknown
disturbances d(t), cannot be used to detect stealthy cyber-
attacks, as the residual rc is mutually dependent on both the
disturbance and the attack signal, and it is nonzero even when
the system is attack-free. In the rest of this paper, we will
show how one can take advantage of the system’s structure to
expose stealthy attacks in a dynamic fashion by designing a
new residual and a corresponding detection algorithm.

B. Proposed Clustering-based Detection Filter

In order to be able to discriminate between effects of the
signals d(t) and ya(t), we will ﬁrst consider the system in (5)
in absence of attacks, i.e. for ya(t) ≡ 0:
(cid:40)

˙x(t) = Ax(t) + Gd(t)

(8)

y(t) = Cx(t)

rc(t) = Ce(t)

Σ :

Note that residual rc also converges to zero as e(t) → 0
when d(t) = 0. Therefore, a typical observer of this form
will successfully estimate the state of the system under normal
conditions only when the system does not experience a distur-
bance. Under certain assumptions on the disturbance, i.e. if it
assumed to be white noise, an observer can be designed so that
the residual converges to zero in expectation, i.e. E[rc(t)] = 0.
In that case, an accurate system estimate can be produced
even in presence of a stochastic disturbance. In previous work,
this is considered the case, and any unknown disturbance d(t)
that enters the system is neglected. Under this assumption,
the observer error dynamics for a system under attack can be
described by:

˙e(t) = (A − LC)e(t) + (L − B)ya(t)

and the residual by

rc(t) = Ce(t) − ya(t)

These equations represent the normal behavior of the system.
To quantify the effects of disturbances on measurement sig-
nals, we deﬁne the clusters Ik as subsets of measurements that
have a similar dynamic response to d(t). More speciﬁcally,
measurements i, j belonging to the cluster Ik are approx-
imately proportional aiyi(t) ≈ ajyj(t) ≈ · · · ≈ z(k)(t),
where ai, aj, . . . are some constant coefﬁcients. This relation
of measurements within the same cluster can also be written
as:

ˆy(k)(t) =







z(k)(t)

(9a)







p(k)
1
...
p(k)
|Ik|

such that (cid:107)y(k)(t) − ˆy(k)(t)(cid:107) ≤ θ,

θ ≥ 0

(9b)

where pi = a−1
measurements y belonging to cluster Ik, y(k) = (en
Ik

for all i ∈ Ik, and y(k) is a subset of
)T y,

i

its elements are approximately proportional

and all
to a
single scalar variable z(k). Parameter θ is a design parameter,
which will be discussed in later sections. Thus, we use terms
cluster and clustering in the sense of model order reduction
method in this work. We aim to estimate the full system
state not only based on the received measurements and full
system model, but also using the reduced order model which
contains and encodes more detailed information (e.g. as in
(9a)) that can be used to detect stealthy attacks. Speciﬁcally,
we use the knowledge of the fact that incoming measurements
˜y(k)(t) = y(k)(t) + y(k)
a (t) belonging to cluster k also have
the property in (9a) only if y(k)
a ≡ 0. Therefore, we deﬁne the
set of residuals ri,j(t) that exploit this property as:

ri,j(t) = ||pj ˜yi(t) − pi ˜yj(t)||,

∀i, j ∈ Ik

(10)

The residuals ri,j deﬁned above will have a value larger
than some threshold ε only in presence of FDI attacks. The
appropriate choice for the threshold ε will be discussed in later
sections. In the following sections, we provide a method for
ﬁnding the boundaries of clusters used for attack detection and
design a moving-target FDI attack detection algorithm.

III. CYBER-ATTACK DETECTION METHODOLOGY

In order to address the problem of detecting FDI attacks
in a large power system network, we propose a methodology
that consists of two steps. In the ﬁrst step, we group the state
measurements y(t) into clusters, based on similarity of their
dynamic response to input d(t) in normal operating conditions.
Then, in step two, we identify the attacked measurements
through a series of consistency checks within each cluster.
This procedure can be written compactly as:

• group the indices i of all measurements yi(t) with similar
dynamic responses into index sets Ik, k ∈ {1, . . . K}
• for a given threshold ε > 0, check all incoming measure-
ments ˜yi(t) for consistency. If there exist i, j ∈ Ik such
that following condition is satisﬁed

Further, clustering coefﬁcients corresponding to Ik are

deﬁned as pk ∈ R1×|Ik|, such that (cid:107)pk(cid:107) = 1, and
(en
Ik
(cid:107)(en
Ik

)T vmax
)T vmax(cid:107)

k ∈ K

pk =

,

(11)

where vmax is the left eigenvector corresponding to the largest
eigenvalue of A. With this deﬁnition in mind, we aim to
partition the set L into clusters Ik such that

pjgi(s) = pigj(s),

∀i, j ∈ Ik

(12)

where gi is the i-th element of g(s) = C(sIn − A)−1G,
an input-output
transfer matrix of the system in (8). The
measurements i and j belonging to the same cluster k have a
proportional, or in some cases identical, response to the input
d(t). In that sense, the proportionality of transfer functions
gi and gj can also be expressed as proportionality to some
scalar function ¯g corresponding to cluster k. Therefore, we
can deﬁne a condition for cluster formation in a compact way
as follows.

Deﬁnition. A set of measurements {yi} should form a cluster
Ik if there exists a scalar function ¯g(s) such that:

(en
Ik

)T g(s) = pT

k ¯g(s)

(13)

where pk is deﬁned as in (11).

This deﬁnition provides intuition on the meaning of clus-
tering in our application, but is not practical for designing
is not
a procedure that would form such clusters, as it
practical to perform similarity checks on functions. To get
around this problem, we will derive a matrix-based condition
equivalent to (13) that will be more straightforward to check.
For that reason, we will derive an equivalent condition for
cluster formation that is more practical to check, based on
this deﬁnition of similarity and the notion of reachability. To
that end, we ﬁrst derive reachability Gramian of a semistable
system (8). The reachability Gramian is deﬁned as
(cid:90) ∞

Wc =

eAtGGT eAT tdt

(14)

ri,j(t) = (cid:107)pj ˜yi(t) − pi ˜yj(t)(cid:107) ≥ ε

0

ﬂag measurements ˜yi and ˜yj as attacked measurements.
In the following subsections, we will introduce each of these
steps in detail.

A. Measurement clustering

In this section, we will introduce an aggregation method,
inspired by [22], [23], for clustering measurements according
to their dynamic response to the external input d(t). This
method will form the basis of our methodology for detecting
cyber-attacks in power systems. We begin by introducing the
deﬁnition of a cluster.

Deﬁnition. Let L = {1, . . . , l} be the set of measurement
indices, and K = {1, . . . , K} the set of cluster indices. Then,
clusters Ik, k ∈ K, are deﬁned as disjoint subsets of L, that
cover all the elements in L, i.e. (cid:83)

k∈K Ik = L.

When A is Hurwitz, the above integral converges, and Wc
can also be found as a solution of the Lyapunov equation
AWc + WcAT + GGT = 0

However, in power systems, the system matrix A has an in-
herent structural singularity, as a direct consequence of power
conservation law. Due to semistability of the system matrix
A, the integral in (14) may not converge. To compute the
reachability Gramian of a semistable system, we ﬁrst consider
the decomposition of A where 0 = λ1 > λ2 ≥ · · · ≥ λn

A = U ΛU −1 = [umax

(cid:20)0

¯U ]



vT
max

(cid:21)



¯Λ

¯V T





where umax and vmax are the right and left eigenvectors cor-
responding to the largest eigenvalue λ1 = 0, and ¯Λ is diagonal
and Hurwitz. Let ¯A = V
G, deﬁned as the
stable subspace of Σ. Then, the reachability Gramian of the

AU and G = V

T

T

T
stable subspace is the solution of ¯A W c +W c ¯AT +GG
Substituting ¯A and G into (14) yields
(cid:90) ∞

W c =

T
e ¯AtGG

e ¯AT tdt

0
(cid:90) ∞

=

T

V

eAt ¯U V

T

GGT V ¯U T eAT tV dt

0
T
= V

WcV

and

Wc = V W cV

T

(15)

is the reachability Gramian of the semistable system Σ and
contains information on the degree of reachability of states
to the input d(t). In the following theorem
with respect
we show that the condition in (13) is equivalent to linear
dependence of rows of a matrix Φ, where linearly dependent
rows are expressed as proportional to some constant vector ¯φ.

Theorem. Consider the reachability Gramian Wc in (15)
let
of
the
the semistable system Σ in (8). Furthermore,
Cholesky factorization of Wc be given by Wc = WLW T
L , and
Φ = CWL. Then, the condition in (13) is equivalent to

(en
Ik

)T Φ = pT
k

¯φ

(16)

where ¯φ ∈ R1×n is a constant vector.

Proof. In order for (13) to hold, for each i, j ∈ Ik it must
hold that

pj(cid:107)gi(s)(cid:107)H2 = pi(cid:107)gj(s)(cid:107)H2.

Similarly, (16) is equivalent to

pj(cid:107)Φi(cid:107) = pi(cid:107)Φj(cid:107)

where Φi is the ith row of the matrix Φ. The H2-norm of a
linear system can be computed as the L2-norm of its impulse
response h(t):

(cid:107)g(s)(cid:107)2

H2

= (cid:107)h(t)(cid:107)2

2 = tr

(cid:90) ∞

(cid:26)

C

0

eAtGGT eAT tdtC T

(cid:27)

Plugging in (15), we have

(cid:107)h(t)(cid:107)2

2 = tr

(cid:26)

CV

(cid:20)(cid:90) ∞

T
e ¯AtGG

(cid:21)
e ¯AT tdt

T

C T

V

(cid:27)

0

= 0.

However, in real systems, the identity in (13) is almost
never the case. Therefore, we will relax the strict equality,
and require

(cid:107)pjgi(s) − pigj(s)(cid:107)H2 ≤ ε,

∀i, j ∈ Ik

(18)

to hold for each cluster, or equivalently, we can check for
linear dependence between rows of matrix Φ:

(cid:107)pjΦi − piΦj(cid:107) ≤ θ ∀i, j ∈ Ik

(19)

where θ > 0 and Φi is the i-th row of Φ. Here, θ is a parameter
that allows us to control the coarseness of clustering. In other
words, it allows us to ﬁnd outputs that have a ”similar”,
instead of equal, response, which relaxes the condition (13).
The smaller θ is, more accurate the clustering will be, but
the clusters may contain very few measurements, which is not
desirable for attack detection purposes. On the other hand, if
θ is too large, the detection threshold in (10) will have to be
large as well to avoid false alarm, and stealthy attacks may
not be detected. Since this trade-off in choice of θ is obvious,
ideally, θ should be chosen as a smallest value for which each
cluster contains at least two measurements.

Finally, we can introduce the measurement clustering al-
gorithm deﬁned above. Assume k clusters have already been
formed. First, we choose an index i that hasn’t already been
assigned to any cluster, and add it to cluster k + 1. Then, we
choose another index j that is not yet assigned to a cluster, and
check condition (19) for i and j. If the condition is satisﬁed,
we add j to cluster k + 1. We repeat this process until all
measurements are assigned to a cluster. This procedure is
summarized in the algorithm below.

Algorithm 1 Clustering algorithm

Initialize cluster index k = 0, and cluster set K = ∅
repeat

Choose measurement index i ∈ L that hasn’t been

assigned to a cluster yet, and add it to cluster Ik+1

Set k ← k + 1, K ← {K, k}
Find all j ∈ L that haven’t been assigned to a cluster

yet and that satisfy (19) and add them
to Ik+1 ← {Ik+1, j}

until all measurements are assigned to a cluster,
(cid:83)

k∈K Ik = L

i.e.

For (cid:107)h(t)(cid:107)2
Since ¯A and G are the stable subspace of Σ, we have

2 to be ﬁnite, the integral above must be ﬁnite.

Next, we introduce the moving-target FDI attack detection

method, based on this clustering procedure.

e ¯At = 0

lim
t→∞

and (cid:107)h(t)(cid:107)2

2 is ﬁnite and equal to:

(cid:107)g(s)(cid:107)2

H2

2 = tr{CWcC T } = tr{CWLW T

= (cid:107)h(t)(cid:107)2
= (cid:107)CWL(cid:107)F = (cid:107)Φ(cid:107)F

L C T } =
(17)

where (cid:107)·(cid:107)F is a vector norm applied to each row of Φ. Hence,
(13) is equivalent to (16).

B. Detection algorithm

In the previous section we have derived the algorithm for
cluster formation with regard to the linearized system in (8).
In this section, we will introduce our cyber-attack detection
algorithm that leverages measurement clusters found using
Algorithm 1. Two properties of this clustering method are key
in our cyber-attack detection ﬁlter design. Firstly, we know
that, once clustering is performed on the system in normal
operating conditions, the outputs within the clusters will be

approximately proportional to each other at all times t. That
enables us to perform quick consistency checks to ensure
the safety and reliability of the system. Secondly, the result
of clustering will change over time as operating conditions
change. On one hand, that means that the clustering will have
to be performed periodically, but on the other hand, it gives our
detection ﬁlter a very desirable property of ”moving-target”
behavior. That means our detection strategy will change over
time, posing an additional difﬁculty to the attacker. In this
section, we will derive a detection algorithm based on these
two crucial properties.

In the analysis in Section III-A, we have shown that clusters
can be formed such that measurements i, j within the cluster
Ik are approximately proportional, i.e. aiyi(t) ≈ ajyj(t) ≈
· · · ≈ z(k)(t), where pi = a−1
for all i ∈ Ik. Then, we
i
derived a matrix-based condition to ﬁnd such clusters. Next,
we will show that the clustering-based approximation ˆy as in
(9a) is a good approximation of y. In other words, we can
approximate original system outputs y = Cx by ˆy = ΠT z,
where z = Πy = ΠCx. The clustering matrix Π ∈ RK×n
is deﬁned as:

Π := Diag{p1, p2, . . . , pK}E ∈ RK×n

(20)

is deﬁned in (11), and E is a permutation ma-
where pi
]T . The input-output
trix deﬁned as E = [en
I1
transfer matrix associated with ˆy can then be deﬁned as
ˆg(s) = ΠT ΠC (sIn − A)−1 G. The following theorem will
show that ˆy is a good approximation of y, and that it can
be used in our cyber-attack detection methodology.

, . . . , en
IK

is nonlinear,

underlying power system model
the system
matrices A and G are only valid around a certain operating
point x0, and we will denote them with A(x0) and G(x0).
Unit Commitment (UC) and Economic Dispatch (ED) are core
processes in power system’s operation, whose main function
is to balance the current demand with sufﬁcient generation in
regular intervals (usually every 1 hour). Thus, as loading or
topology of the system change, so will the operating point of
the system x0, as well as the boundaries of the clusters.

As a result, cluster boundaries have to be recomputed at
every instance of ED, for the current operating conditions
x0. At ﬁrst,
this may sound inconvenient for the system
operator, but the additional computations that are needed are
negligible compared to the signiﬁcant increase in difﬁculty of
manipulating the system using the moving-target strategy. In
other words, even if the attacker had absolute knowledge of the
system at one time, our detection strategy will keep changing,
and that knowledge will eventually become meaningless.

Once the new operating point is received from the ED
process, the linearized system matrices and clusters need to be
recomputed. Then, at every time step of the control processes,
the incoming measurements must be veriﬁed using residuals
of the clustering-based detection ﬁlter given in (10) before
the control action is computed and performed. Veriﬁcation is
performed within each cluster using the following procedure.
• For each cluster Ik, k ∈ K, run a sequence of similarity

checks for all i, j ∈ Ik:

ri,j(t) = ||pj ˜yi(t) − pi ˜yj(t)||,

∀i, j ∈ Ik

(22)

Theorem. Consider a semistable linear system in (8). Con-
sider also a clustering-based approximation ˆy obtained using
the
the aggregation matrix Π. Then,
approximation ge(s) = g(s) − ˆg(s) is asymptotically stable.

the error system of

• All measurements that satisfy ri,j(t) ≥ (cid:15) are classiﬁed as

attacked measurements.

Now, we can state the moving-target FDI attack detection
algorithm, based on dynamic clustering.

Proof. By deﬁnitions given in (11) and (20), Π is a unitary
matrix, i.e. ΠΠT = IK, and ΠT Π is an orthogonal projection
onto colspace(ΠT ). Note also that, by deﬁnition, vmax ∈
colspace(ΠT ). We then deﬁne ¯Π as an orthogonal complement
of Π, such that [ΠT ¯ΠT ]T is unitary, and I − ΠT Π = ¯ΠT ¯Π.
Consider now the error system ge = g − ˆg of the approxima-
tion:

ge(s) = C(sI − A)−1G − ΠT ΠC(sI − A)−1G =
= (In − ΠT Π)C(sI − A)−1G = ¯ΠT ¯Πg(s)

(21)

Then ΠT Πvmax = vmax, or equivalently

¯Πvmax = 0.
This implies that there is pole-zero cancellation in ¯Πg(s)
associated with the zero eigenvalue. Therefore, all poles of
¯Πg(s) have negative real parts, and the error system ge is
asymptotically stable.

Now, we introduce the moving-target detection algorithm
based on dynamic clustering of system outputs. Firstly, the
moving-target nature of our proposed method stems from
the natural ﬂuctuations occurring in power systems. As the

Algorithm 2 Clustering-based FDI attack Detection Method

repeat

Get new operating conditions x0
Compute matrices A(x0), G(x0), and ﬁnd cluster

sets Ik according to Algorithm 1

for every time-step of the control process do

for all measurements yi, i ∈ Ik do

if condition in (22) is satisﬁed then

→ FDI attack detected

end if

end for

end for

until new ED interval

Finally, we give a note on the computation effort involved
in implementing the detection algorithm described above. As
we explained, the clustering procedure needs to be repeated
in
relatively infrequently, usually every 1 hour. Even so,
the large-scale setting, solving Lyapunov equations may be
considered time consuming. However, the inherent sparsity of
power systems, and a number of existing efﬁcient iterative

calculation methods for solving the Lyapunov equation, enable
the clustering to be performed in a timely manner. The
veriﬁcation process of system measurements only consists of
simple mathematical and logical operations, and is not com-
putationally demanding. Therefore, our proposed FDI attack
detection method can be implemented in real-time system
operation.

IV. NUMERICAL EXAMPLES

We begin this section by providing necessary power system
component models, and deriving the standard state space
model of the interconnected power system in form given in
(8). Then, we demonstrate the performance of our method on
the IEEE RTS 24-bus system.

A. Power system modeling

In this section, we introduce the power system component
models used to derive the system matrices in (8). We model
the loads as dynamic using the structure-preserving load model
[24], [25], alongside the well-known generator model with
governor control [26], for two main reasons. First, so that the
sparsity of the power system topology is preserved. Second,
and even more importantly, to account for cyber-attacks on
loads such as smart meters, electric vehicles and other smart
appliances [3], that are exposed through their Internet con-
nectivity. For these reasons, modeling loads when studying
the impact of cyber-attacks on power systems becomes highly
necessary.

Here we consider a power system with nG generators and
nL loads, and denote the set of generator buses by G, and the
set of load buses by L. The mechanical dynamics of generators
and aggregate loads at the substation level are given by:

Ji ˙ωi + Diωi = PT,i − Pi + eT,iai,
Ji ˙ωi + Diωi = −Pi − Li,

i ∈ G

i ∈ L

(23)

For each bus i, state variable ωi denotes its frequency, Pi
the net real power injected into the network, and parameters
Ji, Di the inertia and damping. At load buses i ∈ L, Li is
deﬁned as actual mechanical power consumed by the load.
At generator buses i ∈ G, there are additional controller
dynamics, namely, governor dynamics. States PT,i and ai
denote the mechanical power of the generator and the turbine
valve position respectively, and eT,i
is a parameter of the
turbine. The governor dynamics are given by:
Tu,i ˙PT,i = −PT,i + Kt,iai,

i ∈ G

(24)

Tg,i ˙ai = −riai − (ωi − ωref ),

i ∈ G

The governor’s and turbine’s time constants are denoted by
Tu,i and Tg,i while Kt,i and ri are control gains. Finally, ωref
is the frequency reference provided by the higher control layer.
In order to derive the interconnected system, we treat Pi as
a coupling state variable whose dynamics can be obtained by
differentiating the DC power ﬂow equation, and expressed in
matrix form as:

(cid:21)

(cid:20) ˙PG
− ˙PL

= Ybusω

(25)

where PG := [Pi]i∈G and PL := [Pi]i∈L, and Ybus is the
admittance matrix of a lossless transmission network which
can be partitioned as:

Ybus =

(cid:20)YGG YGL
YLG YLL

(cid:21)

Further, ω can also be partitioned as ω := (cid:2)ωG ωL
where ωG := [ωi]i∈G and ωL := [ωi]i∈L. Finally,
the lin-
earized closed-loop power system model described by equa-
tions (23), (24) and (25) can be expressed in form (8), with the
state vector x := [ωG, ωL, PG, PL, PT , a]T , and d = [Li]i∈L.
The system matrices are given by:

(cid:3)T

G :=





0nG×nL
−J−1
L
0(3nG+nL)×nL















−J−1
G DG
0
YGG
−YLG
0
−T−1
g

0
−J−1
L DL
YGL
−YLL
0
0

−J−1
G
0
0
0
0
0

0
J−1
L
0
0
0 −T−1
0

J−1
J−1
G eT
G
0
0
0
0
0
0
u T−1
u Kt
0 −T−1
g r











A :=

where:

JG := diag({Ji}i∈G)
JL := diag({Ji}i∈L)
DG := diag({Di}i∈G)
DL := diag({Di}i∈L)
eT := diag({eT,i}i∈G)

Kt := diag({Kt,i}i∈G)
Tg := diag({Tg,i}i∈G)
Tu := diag({Tu,i}i∈G)
r := diag({ri}i∈G)

In the following sections, we present numerical simulation
examples performed on the IEEE RTS 24-bus power system
to illustrate the performance of our proposed cyber-attack
detection method.

B. Test system and illustrative scenarios

The IEEE RTS 24-bus system [27] consists of 10 generators,
equipped with governor control, and 14 loads. The intercon-
nected system is modeled using equations (23)-(25), where the
dimension of x is 68. For this system, we will ﬁrst consider
two scenarios with different loading conditions, to demonstrate
the detection algorithm as well as the moving-target defense
strategy:

• Scenario 1 - the system is at high loading condition.
From t = 0 to 20 s, the loading is nominal. At time
t = 20 s, load at bus 3 increases by 0.5 p.u., and at time
t = 200 loading returns to nominal value.

• Scenario 2 - the system is at low loading condition. From
t = 0 to 20 s, the loading is nominal. At time t = 20 s,
load at bus 3 increases by 0.5 p.u., and at time t = 200
loading returns to nominal value.

We use these two scenarios to demonstrate the clustering
method introduced in Section III-A, and how cluster bound-
aries change with the operating conditions. This is demon-
strated in Table I, where the net real power injection of gener-
ator 8, PG8, and its mechanical power output PT8 are clustered
with respective states of generators 3 and 10 under Scenario 1,
and generators 4 and 5 under Scenario 2. Additionally, for the

Clustered states

Scenario 1 PG3, PG8 , PG10, PT3, PT8 , PT10
Scenario 2 PG4, PG5, PG8 , PT4, PT5, PT8

TABLE I: PG8 and PT8 belong to different clusters as oper-
ating conditions change

same θ = 5e−3, the clustering procedure resulted in 21 clusters
under Scenario 1, and 23 under Scenario 2.

In Figure 2 we show the dynamic response of one of
the clusters under Scenario 1. In this particular case we can
also see the effect of the coarseness parameter θ: for higher
detection accuracy, we can decrease θ in which case the cluster
in Figure 2 would split into two. Appropriate attack analysis
and parameter tuning is necessary in general case, but we use
reasonable values in a common attack scenario to demonstrate
our method.

Fig. 2: Dynamic response of measurements in one of the
clusters under Scenario 1

We note that the nature of power systems highly inﬂuences
the clustering procedure. In other words, measurements of
states tend to group according to type: generator net real power
injection PG,i and mechanical power output PT,i measure-
ments tend to be in the same group, while load net real power
injections PL,i group together, and so do the frequencies ωi.
Also, component and network parameters have an inﬂuence
on cluster boundaries. Two generators with the same inertia,
damping and controller gains will naturally have very similar

dynamic response. Also, frequencies of components connected
by a line with a large susceptance (i.e. small impedance), tend
to have similar magnitude of oscillation.

C. Implementation of the attack detection methodology and
result analysis

We consider Scenario 3 in the remainder of this section
to demonstrate attack-detection capabilities of our proposed
method:

• Scenario 3: the system is at high loading condition. From
t = 0 to 20 s, the loading is nominal. At time t = 20 s,
load at bus 3 increases by 0.5 p.u., and at time t = 200
loading returns to nominal value; at time t = 125 s,
a sequence of 6 scaling attacks are launched on the
measurement PG,8, each lasting 5 seconds, with total
duration of the attack Ta = 55 s

where a scaling attack can be represented in terms of system in
(3) as ˜y = y + ya, where ya = k · y. We use scaling coefﬁcient
k = 0.1, which corresponds to a 10 % increase in value of
PG,8 at the time of the attack.

We use Scenario 3 to demonstrate the performance of our
detection ﬁlter, both in presence and absence of measurement
noise. In Figure 3a we consider the noiseless scenario, and
compare the attacked measurement PG,8 (middle plot) with
other measurements belonging to the same cluster (top plot),
to obtain the residual in the bottom plot, which only crosses
the chosen detection threshold for each of the attacks. In
Figure 3b we consider the same attack scenario in presence
of noise. Note that false positive alarms become very likely
in this case, using the appropriate threshold designed for the
deterministic scenario. If the noise parameters are known,
additional statistical methods (e.g. hypothesis testing, etc.)
may be employed to distinguish between noise and signal. In
Figures 3c (no measurement noise) and 3d (with measurement
noise) we show cluster measurements (top) and residuals
(bottom) in absence of cyber-attacks. In noiseless scenario,
the residual does not cross the detection threshold even when
system conditions change, i.e. when there is a load disturbance
in the system. In presence of noise, false positives are possible,
and additional statistical methods can be employed to improve
the performance of the attack detection ﬁlter.

V. CONCLUSION

In this paper, we presented a moving-target defense algo-
rithm that is based on dynamic clustering to detect false data
injection attacks on power system measurements. Our strategy
is dynamic and uses information about the system’s chang-
ing operating point to deﬁne clusters of measurements that
have similar dynamic response and then carries out detection
through similarity checks on the measurements belonging to
the same cluster. We numerically showed the performance of
our proposed detection algorithm and its ability to successfully
detect FDI attacks through an example on the IEEE 24-bus
power system.

[24] Marija D. Ilic, Le Xie, Usman A. Khan, and Jos M. F. Moura. Modeling
of future cyber-physical energy systems for distributed sensing and
IEEE Transactions on Systems, Man and Cybernetics: Part
control.
A, 2010.

[25] Arthur R. Bergen and David J. Hill. Structure preserving model for
power system stability analysis. IEEE Trans. Power Appar. Syst., 1981.
[26] Marija D. Ilic and John Zaborszky. Dynamics and Control of Large

Electric Power Systems. John Wiley& Sons, Inc., 2000.

[27] Christos Ordoudis, Pierre Pinson, Juan Miguel Morales Gonz´alez, and
Marco Zugno. An updated version of the ieee rts 24-bus system for
electricity market and power system operation studies. 2016.

REFERENCES

[1] Defense Use Case. Analysis of the cyber attack on the ukrainian power

grid. 2016.

[2] Blake Sobczak. ’Cyber event’ disrupted U.S. grid networks - DOE. E&

E News, April 30, 2019.

[3] Richard J. Campbell. Cybersecurity issues for the bulk power system.

Technical report, Congressional Research Service Report, 2015.

[4] Yilin Mo, Tiffany Hyun-Jin Kim, Kenneth Brancik, Dona Dickinson,
Heejo Lee, Adrian Perrig, and Bruno Sinopoli. Cyber–physical security
of a smart grid infrastructure. Proceedings of the IEEE, 100(1):195–209,
2012.

[5] Himanshu Khurana, Mark Hadley, Ning Lu, and Deborah A Frincke.
Smart-grid security issues. IEEE Security & Privacy, 8(1):81–85, 2010.
[6] O. Kosut, Liyan Jia, R. J. Thomas, and Lang Tong. Limiting false
In 2010 44th Annual
data attacks on power system state estimation.
Conference on Information Sciences and Systems (CISS), pages 1–6,
2010.

[7] Yao Liu, Peng Ning, and Michael K. Reiter. False data injection attacks
In Proceedings of
against state estimation in electric power grids.
the 16th ACM Conference on Computer and Communications Security,
pages 21–32, New York, NY, USA, 2009. ACM.

[8] Fabio Pasqualetti, Florian D¨orﬂer, and Francesco Bullo. Attack detection
IEEE transactions on

and identiﬁcation in cyber-physical systems.
automatic control, 58(11):2715–2729, 2013.

[9] Le Xie, Yilin Mo, and Bruno Sinopoli. Integrity data attacks in power
market operations. IEEE Transactions on Smart Grid, 2(4), 2011.
[10] Yilin Mo and Bruno Sinopoli. Secure control against replay attacks. In
2009 47th Annual Allerton Conference on Communication, Control, and
Computing (Allerton), pages 911–918. IEEE, 2009.

[11] Andr´e Teixeira, Daniel P´erez, Henrik Sandberg, and Karl Henrik Jo-
hansson. Attack models and scenarios for networked control systems.
In Proceedings of the 1st international conference on High Conﬁdence
Networked Systems, pages 55–64. ACM, 2012.

[12] Siddharth Sridhar and Manimaran Govindarasu. Model-based attack
detection and mitigation for automatic generation control. IEEE Trans-
actions on Smart Grid, 5(2):580–591, 2014.

[13] Y. Shoukry and P. Tabuada. Event-triggered state observers for sparse
IEEE Transactions on Automatic Control, pages

sensor noise/attacks.
2079–2091, 2016.

[14] H. Fawzi, P. Tabuada, and S. Diggavi. Secure estimation and control for
cyber-physical systems under adversarial attacks. IEEE Transactions on
Automatic Control, pages 1454–1467, 2014.

[15] Tong Huang, Bharadwaj Satchidanandan, PR Kumar, and Le Xie. An
online detection framework for cyber attacks on automatic generation
control. IEEE Transactions on Power Systems, 33(6):6816–6827, 2018.
[16] Bharadwaj Satchidanandan and Panganamala R Kumar. Dynamic
watermarking: Active defense of networked cyber–physical systems.
Proceedings of the IEEE, 105(2):219–240, 2017.

[17] Andr´e Teixeira, Iman Shames, Henrik Sandberg, and Karl H Johansson.
Revealing stealthy attacks in control systems. In 2012 50th Annual Aller-
ton Conference on Communication, Control, and Computing (Allerton),
pages 1806–1813. IEEE, 2012.

[18] Fei Miao, Quanyan Zhu, Miroslav Pajic, and George J Pappas. Coding
sensor outputs for injection attacks detection. In 53rd IEEE Conference
on Decision and Control, pages 5776–5781. IEEE, 2014.

[19] Taouba Rhouma, Jean-Yves Keller, Karim Chabir, Dominique Sauter,
and Mohamed Naceur Abdelkrim. Coding control signals and switching
lqg controller for secure fault-tolerant control against stealthy false data
injection. In 2016 3rd Conference on Control and Fault-Tolerant Systems
(SysTol), pages 750–755. IEEE, 2016.

[20] Ye Yuan and Yilin Mo. Security in cyber-physical systems: Controller
design against known-plaintext attack. In 2015 54th IEEE Conference
on Decision and Control (CDC), pages 5814–5819. IEEE, 2015.
[21] Chi-Tsong Chen. Linear System Theory and Design. Oxford University

Press, Inc., New York, NY, USA, 3rd edition, 1998.

[22] Takayuki Ishizaki, Kenji Kashima, Antoine Girard, Jun ichi Imura,
Luonan Chen, and Kazuyuki Aihara. Clustered model reduction of
positive directed networks. Automatica, 59:238 – 247, 2015.

[23] Takayuki Ishizaki, Kenji Kashima, Jun ichi Imura, and Kazuyuki Aihara.
Model order reduction for mimo linear dynamical networks via reaction-
diffusion transformation. pages 5019–5024, 2011.

(a) Top: Other cluster measurements; Middle: Measurement of PG,8
under a scaling attack; Bottom: detection residual (blue) and threshold
(red)

(b) Top: Other cluster measurements (noisy); Middle: Measurement
of PG,8 (noisy) under a scaling attack; Bottom: detection residual
(noisy) and threshold (red)

(c) Top: Measurements in one of the clusters under Scenario 3, in
absence of cyber-attacks; Bottom: residual in absence of cyber-attacks

(d) Top: Noisy measurements in one of the clusters under Scenario
3, in absence of cyber-attacks; Bottom: noisy residual in absence of
cyber-attacks

Fig. 3: Group of measurements belonging to one of the clusters under Scenario 3. Figures 3a and 3b show cases where one
of the measurements in the cluster is under scaling attack, namely PG8, in noiseless and noisy setting, respectively. Figures
3c and 3d show measurements from the same cluster in absence of cyber-attacks, in noiseless and noisy setting,respectively.

