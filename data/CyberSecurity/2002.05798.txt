Detection and Compensation of Linear 
Attacks in Cyber Physical Systems through 
System Identification  

Soheila Barchinezhad 
School of Electrical and Computer Engineering 
 University of Tehran 
Tehran, Iran  
S.Barchinezhad@ut.ac.ir 

Mohammad Sayad Haghighi  
School of Electrical and Computer Engineering 
 University of Tehran 
Tehran, Iran  
 sayad@ut.ac.ir

Abstract—  Cyber-physical  Systems  (CPSs)  are  vasly  used  in 
today’s  cities  critical  infrastructure.  The  cyber  part  of  these 
systems  usually  has  a  network  component  through  which  cyber 
attacks can be launched.  In this paper, we first design an intrusion 
detection system (IDS) by indentifying the plant. We assume the 
intial operation period of the CPS is attack-free and learn the plant 
model.  Then,  we  compare  the  expected  output  found  via  the 
identifier with the real one coming through the feedback link. Any 
difference greater than a threshold is deemed to be an anomaly. 
To compensate, once the IDS flags a change in the loop, we restart 
the system identification to find the new transfer function. With 
the  estimation  of  the  new  transfer  function  at  hand,  a  new 
controller is designed to keep the system stable.  To test the idea, 
we  took  a  DC motor  as  the  plant  and  employed  ARX  identifier. 
Matlab  Simulink  environment  was  used  to  test  the  proposed 
intrusion  detection  and  compensation  framework.  We  applied  a 
set of deception attacks to the forward channel in our experiments. 
The obtained results prove that our detection strategy works well 
and  timely  reacts  to  anomalies.  Moreover,  they  show  that  the 
compensation strategy is also effective and keeps the system stable 
under such attacks.  

Keywords— 

(IDS),  System 
Intrusion  Detection  System 
Identification, Cyber-Physical Systems (CPS), Compensation, ARX. 

I.  INTRODUCTION  

Cyber-Physical Systems (CPSs) are control systems which 
are  composed  of  sensors,  actuators,  control,  and  network 
components.  They  have  been  employed  in  many  domains 
including gas pipelines [1], electric power grids [2], medicine 
[3],  water  networks  [4],  driver  assistance  systems  [5,  6]  and 
autonomous electric vehicles [7]. Using computer networks in 
these  systems  for  communication  and  interconnection  of 
components  makes  them  vulnerable  to  cyber  threats  [8]. 
Therefore,  appropriate  detection  and  possibly  compensation 
techniques are required to counter such cyber attacks. Designing 
Intrusion  Detection  Systems  (IDS)  for  CPSs  has  gained 
considerable  attention  [7]  due  to  the  consequences  of  CPSs 
failure. IDS is a necessary complement to security mechanisms 
like ﬁrewalls. It detects intrusions and provides forensic reports 
to  system  administrator  or  control  center  to  react.  IDSs  are 
classified  into  signature-based  and  anomaly-based  categories. 
Signature based methods [9] recognize an intrusion based on a  
previously-known  intrusion  or  attack  characteristics.  On  the 
other  side,  anomaly  detection  methods  [10,  11]  identify  an 

intrusion  by  calculating  a  deviation  from  normal  system 
behavior. 

Traditional  IDSs  are  inadequate  for  CPSs  as  they  are 
unaware  of  the  events  happening  in  the  physical  part  of  the 
system.  Cyber 
focuses  mainly  on 
investigating the changes in the physical process outputs which 
cannot  be  detected  by  traditional  attack  detectors  or  human 
observer.  

intrusion  detection 

This  paper  is  concerned  with the  detection  issue  for  CPSs 
against  deception  attacks.  Deception  attacks  compromise  the 
integrity  of  packets,  and  manipulate  the  behavior  of  physical 
process. Some deception attacks are covert and cannot be easily  
perceived by human beings. They slightly modify the behavior 
of the system, but their effect cannot be identiﬁed by a human 
observer. This paper tries to model the process or plant normal 
behavior, create a residual error locally by comparing the model 
and plant outputs, and compensating the effect of attack upon 
crossing  of  the  residual  error  from  the  detection  threshold. 
Accordingly, an intrusion detection approach is proposed which 
detects the unordinary changes in the physical process output by 
using a statistical based threshold. Once the detector detects the 
presence of an attack, the attack function identification process 
is triggered. We assume the attacks are of linear type and can be 
modelled  by  a  transfer  function  in  the  frequency/Laplace 
domain  or  its  discrete  time  equivalent  (z-transform).  After 
characterizing the attack, the final step of the proposed scheme 
is  to  design  a  compensating  controller  to  thwart  the  negative 
effects of attack. We switch to this second controller once the 
attack is detected and identified. 

To  evaluate  the  proposed  scheme,  we  conduct  a  set  of 
simulations under Matlab Simulink. A DC motor is used as the 
plant  of  the  control  system.  We  simulate  packet  modification 
attack by using TrueTime tools [12]. The simulation results, as 
presented  later,  demonstrate  that  the  proposed  scheme  well 
detect  and  control  deception  attacks  which  cannot  be  easily 
identiﬁed  by  a  human  being.  Moreover,  the  compensation 
strategy proves effective in the simulated scenarios.   

The  rest of  this  paper  is organized  as follows.  The  related 
studies  are  given  in  Section  II.  The  proposed  detection  and 
identification  scheme  as  well  as  designing  a  compensating 
controller is presented in Section III. In Section IV, the results 
of simulations on  a sample CPS are reported and discussed. The 
concluding remarks are given in Section V. 

 
 
 
 
II.  RELATED WORKS 

Securing CPSs has emerged as an important issue for most 
governments in last few years. In this context, studies have been 
conducted to security of CPSs in many aspects. For example, the 
security challenges of CPSs have been discussed in detail in [13, 
14]. The paper [15] consider the security and privacy issues in 
intelligent transportation systems which is an example of CPS. 
Cyber-attacks has received increasing attention after the launch 
of  the  Stuxnet  worm  [16].  Cyber-attacks  in  modern  CPSs  are 
divided  in  three  categories  [17]:  attacks  on  the  control  layer, 
attacks  on  the  communication  network,  and  attacks  on  the 
physical  process.  Communication  network  is  more  vulnerable 
than other components to cyber-attacks. These cyber-attacks can 
be classified into denial of service (DoS) and deception attacks 
[18]. Deception attacks mention to the possibility of damaging 
the  integrity  of  data  packets  which  change  the  behavior  of 
sensors and actuators [19, 20]. They are also called false  data 
injection  attack  [21].  Conversely,  DoS  attacks  [22]  decreases 
access  to  resources  in  various  ways,  such  as  blocking  the 
communication channel.  

The general approach of some researches on the analysis of 
cyber-attacks is investigating the impact of specific attacks on 
particular  systems.  For  example,  in  [23,  24]  a  covert  (stealth) 
deception attack on the communications network in control and 
monitoring  systems  have  been  introduced  which  is  specific 
deception  attacks.  In  this  paper  a  hidden  agent  changes  the 
behavior of the physical system while leaving little residue on 
the main output of the system. Also in [24], the effect of covert 
attacks on control systems is investigated. In this paper, a covert 
deception attack is proposed to disturbance the control system 
operation based on the information collected by another attack. 
The author claims that the co-operation of the two attacks can 
covertly and accurately affect the physical behavior of a system. 
Covert attacks are also mentioned in . The purpose of this paper 
is to design a deception attack for service degradation that can 
be  stay  stealth  and  has  proved  that  it  can  compromises  the 
system stability. In that paper, a gain attack as the false signals 
are injected to make an overshoot on a DC motor system. Two 
other  papers  [25,  26]  address  the  vulnerabilities  of  control 
systems, in particular modern irrigation channel control systems. 
In this papers, the deceptive attacks on both the forward and the 
backward communication channel are investigated. During this 
deception attack, the attacker sends false data from sensors or 
controllers. These attacks can be carried out by obtaining secret 
keys  used  by  the  controllers  and  physical  systems  or  by 
conquering some of the sensors or controllers.  

payed to identification and compensation of intrusions. In   [30], 
an analytical method for intrusion detection in smart grids based 
on error analysis is presented. The proposed method is based on 
the  state  estimation  algorithm  which  minimizes  the  sum  of 
squares of error. Paper  [31] present a specification based IDS 
for  home  area  network.  Normal  behavior  of  the  network  is 
defined through selected specifications and deviations from the 
defined normal behavior can be a sign of some intrusions. In a 
similar  fashion,  in  [32]  authors  developed  an  algorithm  that 
monitors power flow and detects anomalies. This algorithm uses 
principal  component  analysis to  separate regular  and  irregular 
power flow data. Analysis of the information in this subspace 
determines  whether 
the  power  system  data  has  been 
compromised.  Another  research  proposed  a  model  based 
intrusion  detection  and  impact  reduction  for  an  automatic 
control  system  [8].  This  paper  first  illustrates  the  impact  of 
deception  attacks  on  automatic  generation  control  (AGC)  and 
proposes  a  general  framework  for  use  in  intelligent  attack 
control.  It  actually  develops  a  model-based  attack  detection 
algorithm and mitigates the attack effects. 

 There  is  a  large  variety  of  previous  work  on  intrusion 
detection in CPSs but they have failed to simultaneously detect 
and identify the nature of the attack and design a new controller 
based on detection and identification results. Even methods that 
claim to perform attack identification, actually do the classifying 
of intrusions, rather than fully identifying the nature of the attack 
and its effects.  

III.  THE PROPOSED APPROACH 

When  a  CPS  works  with  a  communication  network,  data 
packets  are  sent  between  the  controller  and  plant  through  the 
network,  and  may  be  attacked.  The  issue  under  study  in  this 
section is how to detect (linear) attacks which are launched over 
the network and to control the destructive effect of them.  

A.  The Proposed Scheme for Intrusion Detection and 

Compensation  

Deception attacks compromise the integrity of data packets 
on  communication  channel  between  the  controller  and  the 
physical process. In this paper we study some specific deception 
attacks which cause a steady state error on plant output or make 
system unstable. The proposed model for intrusion detection and 
compensation is shown in Fig. 1.  

that  decreases 

techniques  are  developed 

Securing the CPSs can be done at several levels. First, some 
preventive 
the 
occurrences  of  attacks.  But  by  increasing  the  attacks  in  these 
systems, prevention and resistance techniques can be defeated 
and  the  development  of  intrusion  detection  techniques  is  a 
necessity. Intrusion detection, identification, and compensation  
is one of the most important defense mechanisms against cyber-
attacks which a great deal of researches [27, 28] on security of 
CPSs  and  IoT  [29]  have  dealt  with  it.  This  mechanism  is 
activated after that attacks occur. Most research in this area has 
focused only on the issue of detection, and a few of them have 

Fig. 1.  Block diagram of the proposed intrusion detection and compensation 

system 

It is assumed that the feedback channel is secure and attacks 
are launched on the forward channel. It is possible to detect the 

 
 
 
 
 
attacked place with the help of additional sensors. It is assumed 
that the Man in The Middle (MITM) attack [6] is linear and with 
a  transfer  function  of  M(z).  The  control  center  tries  to  detect 
attacks.  

 The  solution  proposed  here  is  placing  an  identifier  at  the 
controller  side  of  the  networked  system.  We  could  use  an 
observer to identify the plant, however, for the sake of simplicity 
in presentation here, we assume that the mathematical model of 
the plant is known to the IDS. If an approximate model of the 
plant is to be used, we should additionally assume that there is a 
secure phase at the beginning of system operation, i.e. when the 
system starts working. During this phase, the identifier learns the 
normal behavior of the original plant and the information about 
the  residuals  are  collected  by  IDS  to  determine  the  detection 
threshold. 

B.   System Identificatio 

System  identification  methods  can  be  used  to  find  the 
dynamics  of  systems.  If  the  system  is  linear,  linear  system 
identification methods can be used. But for nonlinear systems 
there are some other identification techniques (such as a neural 
network)[34]. 

In  linear  system  identification,  dynamic  models  such  as 
ARX,  ARMA,  ARMAX,  etc.  can  be  employed.  The  most 
common model for systems with output feedback is ARX [35] 
which  is  demonstrated  in  Fig.2.  ARX  is  popular  because  its 
parameters  can  be  easily  estimated  by  a  linear  least  squares 
technique.  

is 

important 

Early  detection  of 

to  allow 
intrusion 
maintenance or compensation. A common idea is to compare the 
model  output  with  the  system  output.  If  the  residual  error 
exceeds a threshold, there must be an attacker in the loop. This 
of course shall be done when the secure phase is finished.  In 
other  words,  the  difference  between  the  outputs  of  the 
model/identifier  and  the  physical  plant  is  calculated  and 
compared against the detection threshold. Both model and the 
physical plant are fed with the same control signal. Therefore, 
any  significant  deviation  shows  an  anomaly.  The  choice  of 
threshold  plays  a  significant  role  at  the  detection  step.  A 
common  simple  thresholding  method  is η-  standard  deviation 
[33]. The residuals which is collected in the secure phase is used 
to  determine  the  threshold.  Imagine  the  residual  error  as  a 
random  variable  with  the  mean  value  of  mR  and  the  standard 
deviation of sR. It can have e.g. normal distribution. In a simple 
detection  strategy,  the  upper  and  lower  thresholds  can  be 
determined as follows: 

Fig. 2.  ARX model [35] 

u(k) and y(k) are the discrete system input and output. All 
disturbances are transferred to the output in the noise n(k). B(q) 
and  A(q)  are  the  numerator  and  denominator  of  the  transfer 
function  of  a  system  by  parameters 
and 

,...,

, 2
aa
1

la

mb

,...,

, 2
bb
.  The  purpose  of  identifying  the  parameters  is  to 
1
obtain values that minimize the error between the model output 
and the system output. The best choice for merit function is the 
least sum of squares of error. The ARX model estimator will be 
as Fig. 3 and Eq. (2). 

𝜆(cid:3048)(cid:3043)(cid:3043) (cid:3404) m(cid:3019) (cid:3397) ηs(cid:3019)    
𝜆(cid:3039)(cid:3042)(cid:3050) (cid:3404) m(cid:3019) (cid:3398) ηs(cid:3019)   

       (1) 

η is a tuning parameter which depends on system sensitivity. 

When  a  linear  attack  happens  in  the  forward  channel,  it 
changes the transfer function of the system. In this case, system 
identification  methods  can  be  used  to  identify  the  current 
dynamic  function  governing  the  system  (normal  system 
dynamic  function  plus  the  attacker  function).  It  will  help  to 
design  a  proper  compensator  to  counteract  the  effect  of  the 
attack. In the proposed scheme, a system identification method 
(ARX  estimator)  is  used  for  this  purpose.  Once  the  detector 
sends the detection signal to the estimator, it is activated. When 
estimation  error  converges  to  zero,  the  dynamics  of  the  new 
system will be known. Then, the new controller parameters can 
be calculated for the new system in the way explained in the next 
section.  The  controller  usually  has  some  design  goals,  for 
example, to reduce overshoots or even steady-state error. Design 
goals can be met provided that the compensating coefficients are 
set  properly.  Therefore,  reducing  the  error  or  increasing  the 
stability  can  be  realized  when  there  is  a  proper  relationship 
between  the  detector,  identifier  and  compensator.  The  default 
controller has been designed to achieve the performance goals 
assuming that the system transfer function is the one defined by 
the legitimate plant. However, in attack scenarios, we need to 
redesign  a  substitute  controller  to  achieve  the  goals  using  an 
estimation of the attack function. 

Fig. 3.  ARX estimator [35] 

In Fig. (3), 𝑦(cid:3548)(cid:4666)𝑘(cid:4667) is the model output for sample k. 

𝑦(cid:3548)(cid:4666)𝑘|𝑘 (cid:3398) 1(cid:4667) (cid:3404) 𝐵(cid:4666)𝑞(cid:4667)𝑢(cid:4666)𝑘(cid:4667) (cid:3397) (cid:4666)1 (cid:3398) 𝐴(cid:4666)𝑞(cid:4667)(cid:4667)𝑦(cid:4666)𝑘(cid:4667) 

(2)   

which can be rewritten as 

𝑦(cid:3548)(cid:4666)𝑘|𝑘 (cid:3398) 1(cid:4667) (cid:3404) 𝑏(cid:2869)𝑢(cid:4666)𝑘 (cid:3398) 1(cid:4667) (cid:3397) ⋯ (cid:3397) 𝑏(cid:3040)𝑢(cid:4666)𝑘 (cid:3398) 𝑚(cid:4667) 
                       (cid:3398)𝑎(cid:2869)𝑦(cid:4666)𝑘 (cid:3398) 1(cid:4667) (cid:3398) ⋯ (cid:3398) 𝑎(cid:3039)𝑦(cid:4666)𝑘 (cid:3398) 𝑙(cid:4667) 

(3) 

assuming deg(A)=l and deg(B)=m. With Eq. (3) the prediction 
error of an ARX model is, 

 
 
 
 
 
 
 
 
 
 
𝑒(cid:4666)𝑘(cid:4667) (cid:3404) 𝐴(cid:4666)𝑞(cid:4667)𝑦(cid:4666)𝑘(cid:4667) (cid:3398) 𝐵(cid:4666)𝑞(cid:4667)𝑢(cid:4666)𝑘(cid:4667) 

We can state that 

with  

𝑦 (cid:3404) 𝑋𝜃 

              y (cid:3404)

𝑦(cid:4666)𝑚 (cid:3397) 1(cid:4667)
⎤
𝑦(cid:4666)𝑚 (cid:3397) 2(cid:4667)
⎥
.
⎥
.
⎥
.
⎥
𝑦(cid:4666)𝑁(cid:4667)
⎦

⎡
⎢
⎢
⎢
⎢
⎣

         ،               𝜃 (cid:3404)

𝑎(cid:2869)
⎤
𝑎(cid:2870)
⎥
.
⎥
.
⎥
𝑎(cid:3039)
⎥
𝑏(cid:2869)
⎥
𝑏(cid:2870)
⎥
.
⎥
.
⎥
𝑏(cid:3040)⎦

⎡
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎣

and  

𝑋 (cid:3404)

(cid:3398)𝑦(cid:4666)𝑙(cid:4667)           …
⎡
(cid:3398)𝑦(cid:4666)𝑙 (cid:3397) 1(cid:4667)   …
⎢
.
⎢
.
⎢
.
⎢
(cid:3398)𝑦(cid:4666)𝑁 (cid:3398) 1(cid:4667)   …
⎣

(cid:3398)𝑦(cid:4666)1(cid:4667)
(cid:3398)𝑦(cid:4666)2(cid:4667)
.
.
.
(cid:3398)𝑦(cid:4666)𝑁 (cid:3398) 𝑙(cid:4667)

𝑢(cid:4666)𝑚(cid:4667)           …
𝑢(cid:4666)𝑚 (cid:3397) 1(cid:4667)   …
.
.
.
𝑢(cid:4666)𝑁 (cid:3398) 1(cid:4667)   …

𝑢(cid:4666)1(cid:4667)
⎤
𝑢(cid:4666)2(cid:4667)
⎥
.
⎥
.
⎥
.
⎥
𝑢(cid:4666)𝑁 (cid:3398) 𝑚(cid:4667)⎦

in  which  N  is  the  number  of  available  data  samples.  Then  to 
obtain the least sum of squares of errors, the optimal parameters 
of the ARX linear model will be as follows: 

𝜃(cid:3552) (cid:3404) (cid:4666)𝑋(cid:3021)𝑋(cid:4667)(cid:2879)(cid:2869)𝑋(cid:3021)𝑦 

(6) 
Finally, the calculation of the parameters at the arbitrary step 
k is done using the parameters obtained in step k-1. The use of 
the forget factor will be useful for tracking the parameters, i.e. 
reducing the value of the old data compared to that of the new 
data  being  entered.  This  algorithm  is  capable  of  tracking  the 
system  parameters.  By  increasing  the  number  of  samples  to 
infinity, 𝜃(cid:3552) →  𝜃. 

C.  Designing the Controller 

 The block diagram of a classic well known feedback control 
system is shown in Fig. 4, where C(z) is the controller function, 
G(z) represents the system (plant) function, and signals r, e, u 
and  y  denote  the  reference  value,  control  error,  control  signal 
and  sensed  output  variable,  respectively.  In  our  case,  G(z)  is 
actually composed of the attacker’s transfer function (M(z)) and 
the original plant transfer function (H(z)).  

Fig. 4.  Block diagram of a feedback control system 

industrial  applications.  Proportional, 

There are a veriety of controllers which are used in CPSs and 
other 
integral  and 
derivative (PID) controller  [36] is a kind of controller which is 
widely  used  in these  systems.  It  tries  to  minimize  difference 
between a setpoint and a received sensed or measured variable 
along the feedback line and accordingly applies a control signal 

(4) 

(5) 

improve 

to 
the  dynamic  response.  Generally  speaking, 
the proportional gain reduces error signal, the integral controller 
reduces steady-state error and the derivative controller improves 
transient  response.  The  PID  controller  continues  time  transfer 
function can be shown as [37]: 

𝐶(cid:4666)𝑠(cid:4667) (cid:3404) 𝑘(cid:3043) (cid:3397)

(cid:3397) 𝑘(cid:3031)𝑠 

𝑘(cid:3036)
𝑠

Where 

p kk ,

i

 and 

(7)   
dk are the coefficients for the proportional, 

integral and derivative terms. 

The  essential  problem  in  designing  a  PID  controller  is  to 
determine  its  parameters  which  guarantee  stabilization  of  the 
loop.  Many  studies  have  worked  on  the  computation  of  all 
stabilizing  P,  PI  and  PID  controllers  parameteres  [38,  39]. 
Consider the single-input single-output control system where,  

𝐺(cid:4666)𝑧(cid:4667) (cid:3404)

A(cid:4666)z(cid:4667)
𝐵(cid:4666)𝑧(cid:4667)

is the plant to be controlled.  

                             (8) 

We  take  a  PID  controller  for  example  though  a  generic  PID 
controller  could  be  designed  similarly.  C(z)  is  a  descrete  PID 
controller which by approximation, can be written as: 

𝑁

(9)   

𝐶(cid:4666)𝑧(cid:4667) (cid:3404) 𝑘(cid:3043) (cid:3397)

𝑘(cid:3036)𝑇(cid:3046)
𝑧 (cid:3398) 1

(cid:3397) 𝑘(cid:3005)

1
𝑧 (cid:3398) 1

1 (cid:3397) 𝑁𝑇(cid:3046)
where in implementation, 𝑇(cid:3046) is the sampling time and 𝑁 is the 
filter coefficient. The problem is to compute the parameters of 
PID in Eq. (9) that stabilize the system of Fig. 4. The closed loop 
transfer function of the system shown in Fig. 4 (by considering 
the G(z) and C(z) as Eq. (8) and Eq. (9)) is: 

Y(cid:4666)z(cid:4667)
R(cid:4666)z(cid:4667)

(cid:3404)

G(cid:4666)z(cid:4667)C(cid:4666)z(cid:4667)
1 (cid:3397) G(cid:4666)z(cid:4667)C(cid:4666)z(cid:4667)

  (10) 

The stability of such a system is determined by the location of 
the poles of the closed loop transfer function in the z-plane or, 
the  roots  of  the  closed  loop  characteristic  polynomial  1 (cid:3397)
G(cid:4666)z(cid:4667)C(cid:4666)z(cid:4667) (cid:3404) 0. When there is no attack, G(cid:4666)z(cid:4667) (cid:3404) 𝐻(cid:4666)𝑧(cid:4667). 
For  the  system  to  be  stable,  all  the  roots  of  carachteristic 
equation must lie in the unit circle in the z-plane. The system is 
unstable if any closed loop pole lies outside the unit circle. In 
our scheme, we want to control the attacked system by a new 
compensator 𝐶′(cid:4666)𝑧(cid:4667).  This  compensator  is  a  PID  controller  that 
replaces  the  original  controller  once  attack  is  detected.  We 
assume  the  identified  attacked  system  by  ARX  estimator  is 
shown  by  𝐺′(cid:4666)𝑧(cid:4667) ,  which  is  presumably  an  approximation  of 
zHzM
)(
)(
.  Then,  we  are  going  to  determine  the  parameters 

 and  dk , that make the roots of  1 (cid:3397) 𝐺′(cid:4666)𝑧(cid:4667)𝐶′(cid:4666)𝑧(cid:4667) (cid:3404) 0 stay 

k ,
p k
inside the unit circle.  

i

By solving this equation, the stability region for  

k ,
p k

i

 and 

dk is obtained in a 3D space. The PID controller parameters can 
be then selected from the stable region.  

IV.  SIMULATION AND RESULTS 

The  proposed  scheme 

in  TrueTime 
is 
environment  [12].    One  controller  and  one  plant  node  are 

implemented 

 
 
        
 
 
  
 
 
   
 
                                   
 
 
   
                           
considered  which  communicate  through  a  Controlled  Area 
Network (CAN) bus [40] with each other.  The example plant 
which we have used in this study consists of a second-order plant 
(DC motor). DC motor is a popular actuator in control systems. 
We  take  an  example  in  which  the  plant  is  being  normally 
controlled by a PI controller. The PI controller and plant transfer 
functions are linear time-invariant (LTI) and the set point of this 
system is defined by a (unit) step function. In the experiment, 
the discrete time transfer function of the controller and the plant 
are, 

where  𝑎(cid:2869) (cid:3404) 1.59359996 (cid:3400) 10(cid:2879)(cid:2872) ,  𝑎(cid:2870) (cid:3404) (cid:3398)1.58720003 (cid:3400)
10(cid:2879)(cid:2872) ,  𝑏(cid:2869) (cid:3404) (cid:3398)1.98799999 ,  𝑏(cid:2870) (cid:3404) 0.988099999  and  𝑇(cid:3046) (cid:3404)
0.001𝑠. By using the characteristic polynomial formed on the 
basis of Eq. (15) and a parametric PI controller defined in Eq. 
(14),  one  can  find  the  stabilizing  region  based  on 𝑘(cid:3036)   and 𝑘(cid:3043). 
Once  the  stability  region  is  found  based  on  the  parameters 
𝑘(cid:3043) 𝑎𝑛𝑑 𝑘(cid:3036) ,  one  can  pick  a  pair  that  satisfies  the  desired 
performance criteria (like small overshoot or steady state error). 
By solving the Eq.(15), we found the values of parameteres 𝑘(cid:3036) 
and 𝑘(cid:3043) which  make  the  roots  of  Eq.  (15)  stay  inside  the  unit 

𝐻(cid:4666)𝑧(cid:4667) (cid:3404)

9.96 (cid:3400) 10(cid:2879)(cid:2875)𝑧 (cid:3397) 9.92 (cid:3400) 10(cid:2879)(cid:2875)
𝑧(cid:2870) (cid:3398) 1.988𝑧 (cid:3397) 0.9881

𝐶(cid:4666)𝑧(cid:4667) (cid:3404)

(cid:4666)30.2𝑧 (cid:3398) 29.97(cid:4667)
𝑧 (cid:3398) 1

(11) 

(12) 

In order to evaluate the performance of the proposed scheme, 
simulations  are  conducted.  The  first  implemented  attack  is  a 
gain  attack  which  makes  the  plant  unstable.  In  this  attack 
M(z)=160.  

In these simulations, the transmission bit rate is set to 250kbps 
to match J1939 CAN protocol specifications. Also, the secure 
time  span  is  5  seconds  from  the  beginning  of  the  simulation, 
sampling time (𝑇(cid:3046)(cid:4667) is 0.001s and the attack is launched at 𝑡 = 5s. 
Fig. 5 shows the normal output/behavior of system when there 
is  no  attack.  In  normal  operation,  the  output  of  plant  (motor 
speed) rises sharply and gradually converges to one when a step 
like set point with the value of one is applied.  

In  the  mentioned  gain -attack  case,  IDS  detects  the  attack  at 
t=5.003s,  merely  a  few  milliseconds  after  the  launch.  At  this 
time, the ARX estimator is enabled. The estimation error reaches 
7e-15 by t=5.075s. A small error implies that the identification 
process  of  system  dynamics  is  completed.  The  result  of 
identification process in the simulations is, 

𝐺′(cid:4666)𝑧(cid:4667) (cid:3404)

1.59359996 (cid:3400) 10(cid:2879)(cid:2872)𝑧 (cid:3398) 1.58720003 (cid:3400) 10(cid:2879)(cid:2872)
𝑧(cid:2870) (cid:3398) 1.98799999𝑧 (cid:3397) 0.988099999

                                                                                        (13) 

Fig. 5. Behavior (motor speed) of the plant under normal condition. 

Fig. 6. Stability region in the (kp , ki)  plane (for the system with a gain 
attack=160). The darker area shows where the system is stable. 

(

zHzM
).
)(

but  not  identical.  𝐺′(cid:4666)𝑧(cid:4667)  is  an 
which  is  close  to 
estimated  function  of  system  dynamics  ( 𝐺(cid:4666)𝑧(cid:4667) ).  We  take  a 
substitute PI controller (𝐶′(cid:4666)𝑧(cid:4667)) as an example and determine 𝑘(cid:3036)  
and 𝑘(cid:3043) that keep the attacked system stable.  

𝐶′(cid:4666)𝑧(cid:4667) (cid:3404) 𝑘(cid:3043) (cid:3397)

𝑘(cid:3036)𝑇(cid:3046)
𝑧 (cid:3398) 1

(14)   

 To find the stability region, we should determine the parameters 
𝑘(cid:3043) 𝑎𝑛𝑑 𝑘(cid:3036)  that  make  the  roots  of  1 (cid:3397) 𝐺′(cid:4666)𝑧(cid:4667)𝐶′(cid:4666)𝑧(cid:4667) (cid:3404) 0  stay 
inside the unit circle. 

                    1 (cid:3397) 𝐺(cid:4593)(cid:4666)𝑧(cid:4667)𝐶(cid:4593)(cid:4666)𝑧(cid:4667) (cid:3404) 𝑧(cid:2871) (cid:3397) (cid:3435)𝑏(cid:2869) (cid:3398) 1 (cid:3397) 𝑘(cid:3043)𝑎(cid:2869)(cid:3439)𝑧(cid:2870) 
                     (cid:3397)(cid:3435)𝑏(cid:2870) (cid:3398) 𝑏(cid:2869) (cid:3397) 𝑘(cid:3043)𝑎(cid:2870) (cid:3398) 𝑘(cid:3043)𝑎(cid:2869) (cid:3397) 𝑇(cid:3046)𝑘(cid:3036)𝑎(cid:2869)(cid:3439)𝑧 
                     (cid:3397)(cid:3435)(cid:3398)𝑏(cid:2870) (cid:3398) 𝑘(cid:3043)𝑎(cid:2870) (cid:3397) 𝑇(cid:3046)𝑘(cid:3036)𝑎(cid:2870)(cid:3439) (cid:3404) 0 

(15)   

Fig. 7. Behavior of attacked system (for a gain attack=160) with and 
without  IDS and compensator by kp=50 and ki=100.   

 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
circle. Fig. 6 shows the result. For the mentioned gain attack, 
selected parameters for compensation are kp=50 and ki=100.  

𝐺(cid:4666)𝑧(cid:4667) (cid:3404)

6.972 (cid:3400) 10(cid:2879)(cid:2875)𝑧(cid:2870) (cid:3397) 0.028 (cid:3400) 10(cid:2879)(cid:2875)𝑧 (cid:3398) 6.944 (cid:3400) 10(cid:2879)(cid:2875)
𝑧(cid:2871) (cid:3398) 2.988100049𝑧(cid:2870) (cid:3397) 2.976298898𝑧 (cid:3398) 0.988198859

The output of the case in which attack was launched on the 
channel, but no IDS or compensator was involved, and also the 
output  of  the  case  in  which  the  proposed  intrusion  detection, 
identification  and  compensation  scheme  was  involved  are 
shown in Fig. 7. Attacker made the system completely unstable. 
This  is  obvious  from  the  oscillating  output  of  the  system.  In 
Fig.7 IDS flag is raised at 5.003s and the compensation by the 
substitute controller is  activated at 5.075s. It shows the system 
with  IDS  and  compensator  can  tolerate  the  attack  more  and 
guarantee  the  stability.  The  picked  proportional  gain  and  the 
integral componenet have made system stable and reduced the 
steady state error of the attacked system, respectively. 

The  proposed  scheme  is  implemented  also  with  another 
deception attack which makes a steady-state error. To do so, we 
use  a  discrete  transfer  function  (M(z))  as  the  MITM  attacker, 
similar to the one presented in reference [24],  

𝑀(cid:4666)𝑧(cid:4667) (cid:3404)

0.7𝑧 (cid:3398) 0.7
𝑧 (cid:3398) 1.0001

(16) 

In  this  case,  attack  is  detected  at  t=5.023s, and  the  estimation 
error reaches 6e-16 by t=5.12s. The result of ARX estimator for 
system by mentioned attack is as, 

Fig. 8. Stability region in the (kp , ki)  plane (for the system with steady 
state error attack). The darker area shows where the system is stable. 

Fig. 9. Behavior of attacked system (with steady state error attack) with 
and without  IDS and compensator by kp=2000 and ki=1500.   

                                                                                        (17) 

For the system with this steady state error attack, stability region 
based  on  proportional  and 
integral  components  of  PI 
compensator has been shown in Fig. 8. Also, Fig. 9 shows the 
system  output.  When  there  is  no  IDS  or  compensator,  the 
attacker  manages  to  create  a  steady state error of magnitude 
0.032 which, by given the original controller, does not converge 
to zero. With the proposed intrusion detection, identification and 
the  designed  compensator,  the  system  can  tolerate  the  attacks 
more.  In  Fig.9,  it  is  easy  to  see  that  the  response  curve  has 
become better and the steady state error was reduced to 0.005 at 
t=14s  by  using  PI  controller  by  parameters  kp=2000  and 
ki=1500 as compensator. 

V.  CONCLUSIONS 

the  attack  and 

Cyber-physical  systems  (CPSs)  are  vulnerable  to  cyber 
attacks in their communication layer. Packet manipulation and 
deception attacks may signiﬁcantly impair the control system 
properties such as steady state error, rise and settling time and 
overshoot/undershoot. In order to recognize the characteristics 
of 
take  better  decisions,  a  detection, 
identification and compensation mechanism is proposed in this 
paper. In the adversarial model studied, it is assumed that the 
feedback  channel  is  secure,  and  attacks  are  launched  on  the 
forward  channel.  The  intrusion  detector  uses  a  model  of  the 
plant  obtained  by  an  identifier  at  the  controller  side.  The 
identifier follows the normal behavior of the original plant and 
can help to detect any deviation from the benign behavior. Once 
the attack is detected, assuming that it can be approximated by 
a  linear  function,  an  ARX  estimator  finds  the  new  dynamic 
function and accordingly, the controller is updated to cope with 
the attack condition. The goal is to keep the system under attack 
stable and with desired output. To evaluate the performance of 
the proposed method, simulations have been conducted using 
Matlab  Simulink  and  TrueTime  tools.  A  DC  motor  has  been 
used as the example in simulations. We put the idea to test with 
a  two  deception  attacks.  Simulation  results  show  that  the 
proposed method can effectively help the control system remain 
stable under such attack scenarios and compensate the negative 
effects  of  attacks.  For  the  future  work,  we  aim  to  extend  the 
proposed  approach  to  support  nonlinear  systems  as  well  as 
attacks. 

REFERENCES 

[1] 

[2] 

[3] 

[4] 

I.  P.  Turnipseed,  A  new  scada  dataset  for  intrusion  detection 
research. Mississippi State University, 2015. 
S. Sridhar, A. Hahn, and M. Govindarasu, "Cyber physical system 
security for the electric power grid," Proc. IEEE, vol. 100, no. 1, pp. 
210-224, 2012. 
R.  Mitchell  and  R.  Chen,  "Behavior  rule  specification-based 
intrusion  detection  for  safety  critical  medical  cyber  physical 
systems," IEEE Trans. Dependable Secure Comput. , vol. 12, no. 1, 
pp. 16-30, 2015. 
S. Amin, X. Litrico, S. Sastry, and A. M. Bayen, "Cyber security of 
water  SCADA  systems—Part  I:  Analysis  and  experimentation  of 
stealthy  deception  attacks,"  IEEE  Trans.  Control  Syst.  Technol.  , 
vol. 21, no. 5, pp. 1963-1970, 2013. 

 
 
 
 
 
 
 
 
[5] 

[6] 

[7] 

[8] 

[9] 

[10] 

[11] 

[12] 

[13] 

[14] 

[15] 

[16] 

[17] 

[18] 

[19] 

[20] 

[21] 

[22] 

J. Li, J. Wu, G. Xu, J. Li, X. Zheng, and A. Jolfaei, "Integrating NFV 
and  ICN  for  advanced  driver  assistance  systems,"  IEEE  IoT  J.  , 
2019. 
J.  Wan,  H.  Yan,  D.  Li,  K.  Zhou,  and  L.  Zeng,  "Cyber-physical 
systems  for  optimal  energy  management  scheme  of  autonomous 
electric vehicle," The Computer Journal, vol. 56, no. 8, pp. 947-956, 
2013. 
S. Sridhar and M. Govindarasu, "Model-based attack detection and 
mitigation  for  automatic  generation  control,"  IEEE  Trans.  Smart 
Grid , vol. 5, no. 2, pp. 580-591, 2014. 
R. Mitchell and R. Chen, "Behavior-rule based intrusion detection 
systems  for  safety  critical  smart  grid  applications,"  IEEE  Trans. 
Smart Grid , vol. 4, no. 3, pp. 1254-1263, 2013. 
 A.  Ghafouri,  W.  Abbas,  A.  Laszka,  Y.  Vorobeychik,  and  X. 
Koutsoukos,  "Optimal  thresholds  for  anomaly-based  intrusion 
detection in dynamical environments," in Int. Conf. on Decision and 
Game Theory for Security, 2016: Springer, pp. 415-434.  
 P. Kreimel, O. Eigner, and P. Tavolato, "Anomaly-based detection 
and classification of attacks in cyber-physical systems," in Proc. of 
the 12th Int. Conf. on Availability, Reliability and Security, 2017: 
ACM, p. 40.  
A. Cervin, D. Henriksson, and M. Ohlin, "TrueTime 2.0–reference 
manual," Technical Report, 2009. 
 P.  Pal,  R.  Schantz,  K.  Rohloff,  and  J.  Loyall,  "Cyber  physical 
systems  security  challenges  and  research  ideas,"  in  Workshop  on 
Future Directions in Cyber-physical Systems Security, 2009, pp. 1-
5.  
M. N. Al-Mhiqani, R. Ahmad, K. H. Abdulkareem, and N. S. Ali, 
"Investigation  study  of  cyber-physical  systems:  characteristics, 
application domains, and security challenges," ARPN J. Eng. and 
Appl. Sci., vol. 12, no. 22, pp. 6557-6567, 2017. 
 A. Jolfaei and K. Kant, "Privacy and security of connected vehicles 
in intelligent transportation system," in 49th Annual IEEE/IFIP Int. 
Conf.  on  Dependable  Systems  and  Networks–Supplemental 
Volume (DSN-S), 2019: IEEE, pp. 9-10.  
N.  Falliere, L. O.  Murchu, and  E. Chien, "W32. stuxnet dossier," 
White paper, Symantec Corp., vol. 5, no. 6, p. 29, 2011. 
L. Fillatre, I. Nikiforov, and P. Willett, "security of SCADA systems 
against cyber–physical attacks," IEEE Aerosp. Electron. Syst. Mag. 
, vol. 32, no. 5, pp. 28-45, 2017. 
 S.  Amin,  A.  A.  Cárdenas,  and  S.  S.  Sastry,  "Safe  and  secure 
networked  control  systems  under  denial-of-service  attacks,"  in 
International  Workshop  on  Hybrid  Systems:  Computation  and 
Control, 2009: Springer, pp. 31-45.  
B. Li, R. Lu, W. Wang, and K.-K. R. Choo, "Distributed host-based 
collaborative detection for false data injection attacks in smart grid 
cyber-physical system," J. Parallel Distrib. Comput. , vol. 103, pp. 
32-41, 2017. 
Y. Mo and B. Sinopoli, "On the performance degradation of cyber-
physical  systems  under  stealthy  integrity  attacks,"  IEEE  Trans. 
Autom. Control , vol. 61, no. 9, pp. 2618-2624, 2015. 
 Y.  Mo  and  B.  Sinopoli,  "Integrity  attacks  on  cyber-physical 
systems,"  in  Proc.  of  the  1st  Int.  Conf.  on  High  Confidence 
Networked Systems, 2012: ACM, pp. 47-54.  
M.  S.  Haghighi,  F.  Farivar,  A.  Jolfaei,  and  M.  H.  Tadayon, 
"Intelligent  robust  control  for  cyber-physical  systems  of  rotary 
gantry  type  under  denial  of  service  attack,"  The  Journal  of 
Supercomputing, pp. 1-23, 2019. 
 C.  Kwon,  W.  Liu,  and  I.  Hwang,  "Security  analysis  for  cyber-
physical  systems  against  stealthy  deception  attacks,"  in  American 
control conference, 2013: IEEE, pp. 3344-3349.  

[23] 

[24] 

[25] 

[26] 

[27] 

[28] 

[29] 

[30] 

[31] 

[32] 

[33] 

[34] 

[35] 

[36] 

[37] 

[38] 

[39] 

[40] 

A. O. de Sá, L. F. R. da Costa Carmo, and R. C. Machado, "Covert 
attacks in cyber-physical control systems," IEEE Trans. Ind. Inf. , 
vol. 13, no. 4, pp. 1641-1651, 2017. 
S. Amin, X. Litrico, S. Sastry, and A. M. Bayen, "Cyber security of 
water  SCADA  systems—Part  I:  Analysis  and  experimentation  of 
stealthy  deception  attacks,"  IEEE  Trans.  Control  Syst.  Technol.  , 
vol. 21, no. 5, pp. 1963-1970, 2012. 
S. Amin, X. Litrico, S. S. Sastry, and A. M. Bayen, "Cyber security 
of water SCADA systems—Part II: Attack detection using enhanced 
hydrodynamic models," IEEE Trans. Control Syst. Technol. , vol. 
21, no. 5, pp. 1679-1693, 2012. 
F.  Farivar,  M.  S.  Haghighi,  A.  Jolfaei,  M.  Alazab,  "Artificial 
intelligence  for  detection,  estimation,  and  compensation  of 
malicious attacks in nonlinear cyber physical systems and industrial 
IoT,", in IEEE Tranactions on Industrial Informatics, in press, 2019. 
F.  Farivar,  S.  Barchinezhad,  M.  S.  Haghighi,  and  A.  Jolfaei, 
"Detection and compensation of covert cervice degrading Intrusions 
in cyber physical systems through intelligent adaptive control." in 
20th IEEE Int. Conf. on Industrial Technology, 2019. 
 A. Arabsorkhi, M. S. Haghighi, and R. Ghorbanloo, "A conceptual 
trust  model  for  the  Internet  of  Things  interactions,"  in  8th 
International  Symposium  on  Telecommunications  (IST),  2016: 
IEEE, pp. 89-93.  
A.  S.  Bretas,  N.  G.  Bretas,  B.  Carvalho,  E.  Baeyens,  and  P.  P. 
Khargonekar,  "Smart  grids  cyber-physical  security  as  a  malicious 
data attack: An innovation approach," Electr. Power Syst. Res. , vol. 
149, pp. 210-219, 2017. 
 P.  Jokar,  H.  Nicanfar,  and  V.  C.  Leung,  "Specification-based 
intrusion detection for home area networks in smart grids," in Smart 
Grid  Communications  (SmartGridComm),  IEEE  Int.  Conf.  on, 
2011: IEEE, pp. 208-213.  
J.  Valenzuela,  J.  Wang,  and  N.  Bissinger,  "Real-time  intrusion 
detection in power system operations," IEEE Trans. Power Syst. , 
vol. 28, no. 2, pp. 1052-1062, 2013. 
 I.  Stojmenovic  and  S.  Wen,  "The  fog  computing  paradigm: 
Scenarios  and  security  issues,"  in  2014  Fed.  Conf.  on  Computer 
Science and Information Systems, 2014: IEEE, pp. 1-8.  
H. A. Nozari, M. A. Shoorehdeli, S. Simani, and H. D. Banadaki, 
"Model-based  robust  fault  detection  and  isolation  of  an  industrial 
gas 
techniques," 
Neurocomputing, vol. 91, pp. 29-47, 2012. 
S. Lu and T. Basar, "Robust nonlinear system identification using 
neural-network models," IEEE Trans. Neural Networks , vol. 9, no. 
3, pp. 407-429, 1998. 
O.  Nelles,  "Nonlinear  system  identification,"  ed:  IOP  Publishing, 
2002. 
D. E. Rivera, M. Morari, and S. Skogestad, "Internal model control: 
PID controller design," Ind. Eng. Chem. Process Des. Dev. , vol. 25, 
no. 1, pp. 252-265, 1986. 
Z.-L. Gaing, "A particle swarm optimization approach for optimum 
design  of  PID  controller  in  AVR  system,"  IEEE  Trans.  Energy 
Convers. , vol. 19, no. 2, pp. 384-391, 2004. 
N. Tan, I. Kaya, C. Yeroglu, and D. P. Atherton, "Computation of 
stabilizing  PI  and  PID  controllers  using  the  stability  boundary 
locus,"  Energy  Convers.  Manage.  ,  vol.  47,  no.  18-19,  pp.  3045-
3058, 2006. 
 M.T. Ho, A. Datta, and S. Bhattacharyya, "A linear programming 
characterization of all stabilizing PID controllers," in  Proc. of the 
1997 American Control Conference, vol. 6: IEEE, pp. 3922-3928.  
R.  Erckert,  "Receiving  circuit  and  method  for  a  controlled  area 
network system," ed: Google Patents, 2002. 

turbine  prototype  using  soft  computing 

 
 
 
