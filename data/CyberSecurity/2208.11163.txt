Cyber-resilient Automatic Generation Control for
Systems of AC Microgrids

Tong Huang, Member, IEEE, Dan Wu, Member, IEEE, and Marija Ili´c, Life Fellow, IEEE

1

2
2
0
2

g
u
A
3
2

]

Y
S
.
s
s
e
e
[

1
v
3
6
1
1
1
.
8
0
2
2
:
v
i
X
r
a

Abstract—In this paper we propose a co-design of the sec-
ondary frequency regulation in systems of AC microgrids and
its cyber securty solutions. We term the secondary frequency
regulator a Micro-Automatic Generation Control (µAGC) for
highlighting its same functionality as the AGC in bulk power
systems. We identify sensory challenges and cyber threats facing
the µAGC. To address the sensory challenges, we introduce
a new microgrid model by exploiting the rank-one deﬁciency
property of microgrid dynamics. This model
is used to pose
an optimal µAGC control problem that is easily implemented,
because it does not require fast frequency measurements. An end-
to-end cyber security solution to the False Data Injection (FDI)
attack detection and mitigation is developed for the proposed
µAGC. The front-end barrier of applying off-the-shelf algorithms
for cyber attack detection is removed by introducing a data-
driven modeling approach. Finally, we propose an observer-based
corrective control for an islanded microgrid and a collaborative
mitigation schemes in systems of AC microgrids. We demonstrate
a collaborative role of systems of microgrids during cyber attacks.
The performance of the proposed cyber-resilient µAGC is tested
in a system of two networked microgrids.

Index Terms—Cyber security, Automatic Generation Control
for Microgrids (µAGC), networked microgrids, inverter-based
resource (IBR), False Data Injection (FDI)

I. INTRODUCTION
The recent decade has witnessed several large-scale elec-
tricity outages due to low-probability but high-impact events,
such as extreme weather. Examples include the 2012 Hurricane
Sandy power outage, the 2020 California rotating electricity
outage caused by extreme heat wave [1], and the 2021 Texas
power crisis resulting from unusually severe winter storms
[2]. During these extreme weather-related events, the bulk
transmission systems failed to supply sufﬁcient electric energy
to distribution systems, causing millions of businesses and
homes to lose their electricity supply. One promising solution
to enhance resilience of distribution systems to these extreme
events is to integrate Distributed Energy Resources (DERs),
e.g., solar panels, micro-turbines, and energy storage, to the
distribution systems. However, a large-scale deployment of
DERs in the distribution systems introduces unprecedented
complexity and the need for extensive Distribution Manage-
ment Systems (DMSs). To reduce the management complexity,
a distribution system with massive DERs can be conﬁgured
to be a system of microgrids. Neighboring loads, DERs and
their grid infrastructure are clustered into an AC or DC, small-
scale power system, i.e., a microgrid. One microgrid can either
operate autonomously in an islanded mode, or connect to its
host distribution system in a grid-connected mode, or as an
interactive network with its neighboring microgrids and form
a system of microgrids that does not physically connect to their

host distribution system in a hybrid mode. Each microgrid is
managed by the Microgrid Management System (µMS). In
such a conﬁguration, the management burden of the DMS is
signiﬁcantly reduced, as the DMS only needs to coordinate
several µMS.

For an AC microgrid, frequency regulation is an important
functional block in the µMS design, expecially when the
microgrid enters the islanded or hybrid mode. Similar to
bulk transmission systems, frequencies at the microgrid can
be regulated in a hierarchical manner. The bottom layer of
the frequency regulation entails local controller in DERs,
e.g., power controllers of inverter-based resources (IBRs),
and governors of small synchronous generators. These local
controllers are termed the primary control of microgrids [3],
[4]. As the primary control can yield steady-state errors of
frequencies from their nominal values after a disturbance, a
secondary control layer is needed in microgrids to regain the
nominal frequency [5], [6]. Since the secondary frequency
regulation in AC microgrids shares a very similar objective
with the Automatic Generation Control (AGC) of bulk trans-
mission systems, we term the secondary frequency regulator
in microgrids Micro-AGC (µAGC) to highlight its connection
with the AGC that has served the bulk power systems for half
of a century. This paper focuses on the µAGC design.

A. State-of-the-art µAGC

There is a large body of literature that addresses the
µAGC design. These design schemes can be generally cat-
egorized into the centralized, distributed, and decentralized
control [7]. The centralized µAGC relies on a monopolistic
decision-making platform that gathers measurements from
the DERs under control, computes regulation signals, and
dispatches these signals to the DERs [8], [9]. The distributed
µAGC employs cooperative control policies among neigh-
boring DERs to achieve certain objectives. It can be fur-
ther classiﬁed into three sub-groups: averaging-based meth-
ods [5], distributed-consensus-based methods [10], and event-
triggering-based methods [11]. In decentralized µAGC design,
each DER participating in the µAGC recovers its own nominal
frequency to a nominal value independently. The washout
ﬁlter is investigated in [12] and shown to be equivalent to a
decentralized secondary control. In [13], a decentralized LQR
control design is proposed to achieve frequency restoration
in an optimal way. Another idea to achieve decentralized
frequency regulation is based on µAGC. The estimation-based
µAGC [14] employs the system states estimated locally instead
of the true measurements to generate control signals.

 
 
 
 
 
 
B. The Challenge of Accurate Measurements

However, a system of microgrids equipped with the µAGC
design mentioned above may be still vulnerable to physical
disturbances and/or cyber anomalies. Compared with high-
voltage transmission systems, a microgrid is more sensitive
to physical disturbances, e.g., load/renewable power ﬂuctua-
tions, and IBR connection and re-connection, due to its small
scale and the zero/low inertia of its generation units. These
disturbances cause large, and fast ﬂuctuations of microgrid
frequencies. The frequency changes induced by the distur-
bances may not be captured in an accurate and timely manner
by the frequency sensors. However, almost all of the above-
mentioned µAGC design schemes utilize frequency measure-
ments to make decisions. It is assumed that the frequency
information can be reported by DERs or it can be accurately
measured in a fast manner. In practice, while the frequency
information can be produced by the IBR power controller as
a digital, internal control command, such a digital signal may
not be available for a third-party µAGC1, and it can only
be indirectly obtained by external frequency sensors. As a
result, the desirable control performance of the µAGC relying
on accurate frequency measurements might not be attained,
especially with fast ﬂuctuations from renewable generation
and load (shall be shown in Section II-B). Therefore, it is
advantageous to develop a µAGC that does not depend on the
frequency information when a microgrid enters the islanded
or hybrid operating mode.

C. The Challenge of Cyber Attacks

Another important consideration for the µAGC design is
the cyber security. While the distributed and decentralized
µAGC reduce the cyber risks of the µAGC by sparsifying or
eliminating long-distance communication links among DERs,
these µAGC design may be still susceptible to the false data
injection (FDI) attack where the sensors can be manipulated
to report wrong information to the µAGC. Many references
concerns attenuating the inﬂuence of the FDI attacks [15]. One
category of methods explores state estimation techniques [16],
for example, the Kalman ﬁlter method [17] and optimization-
based state estimation methods [18]. These methods either
rely on the accuracy of measurements or heavy computations
[19]. To address these challenges, observer-based detection
and control methods have been proposed [15], [20]. Recently,
the unknown input observer (UIO) has found a broad range
of applications in FDI attack detection and cyber-resilient
control designs [21], [22] since it can separate the external
disturbance from the attack signal, yielding a more sensitive
anomaly diagnosis. However, these cyber security solutions
are built upon existing µAGC designs that require accurate
frequency information. It is an open-ended question whether
these solutions can extend to other control designs that require
different information other than frequencies. While some cyber
attack solutions [23], [24] are designed for a general model
that serves as an abstraction of many engineering systems,
e.g., a state-space model, the model that should be used for

1By the third-party µAGC, we mean that the µAGC service is not designed

and implemented by the inverter manufacture.

2

the purpose of developing cyber solutions heavily depends on
the information feeding its controller. For a speciﬁc controller,
it might not be straightforward to derive a proper model that
lends itself to the cyber solution design even for domain
experts. Therefore, the development of µAGC and its cyber
solution are interdependent.

To overcome these challenges in this paper we introduce a
co-design of µAGC and its cyber solutions. We identify the
sensory challenges and cyber vulnerability facing the µAGC
design. To address the sensory challenges, we introduce a new
microgrid modeling approach by exploiting the structure of
microgrid dynamics, i.e., the property of rank-one deﬁciency.
Such a modeling approach leads to an optimal µAGC that
is easily implemented, as it does not require fast frequency
measurements that can be hard to obtain [25]. An end-to-end
cyber security solution to FDI attack detection and mitigation
is developed for the proposed µAGC. The front-end barrier
of applying off-the-shelf algorithms for cyber attack detection
is removed by introducing a data-driven modeling approach.
Besides, we propose an observer-based corrective control for
an islanded microgrid and a collaborative mitigation schemes
in systems of AC microgrids. Compared with the existing
µAGC design, the contribution of this paper is summarized
as follows: 1) The proposed µAGC can regulate microgrid
frequencies in the presence of both load/renewable power
ﬂuctuations and FDI cyber attacks; 2) Compared with the
µAGC design that requires internal digital signals of DERs
or fast frequency measurements, the proposed µAGC is more
practically implementable, as it only requires real-time real
power which can be measured fast and accurately; 3) Com-
pared with the method that is speciﬁcally designed for one
type of DERs [13], the proposed µAGC design can address
systems of microgrids with heterogeneous DERs; and 4) We
demonstrate the role of systems of microgrids in terms of
attenuating the inﬂuence of cyber attacks.

The rest of this paper is organized as follows: Section II
presents the challenges facing the µAGC design; Section III
introduces the new microgrid modeling approach that is used
for designing the µAGC in the presence of fast load/renewable
power ﬂuctuations; Section IV demonstrates the cyber security
solutions to the proposed µAGC; and Section V tests the
proposed µAGC and its cyber security solution.

II. NEW MODELING FOR µAGC DESIGN

This section starts with describing the dynamics of systems
of microgrids in the conventional state space where voltage
phase angles and frequencies are used as the state variables.
the limitations of conventional µAGC
Then we point out
design. We derive a new model which lends itself to more
robust µAGC with respect to measurement inaccuracies and
cyber attacks.

A. Conventional Microgrid Modeling for µAGC design

We consider a microgrid with N inverter-based resources
(IBRs) and M loads. Without loss of generality, the IBRs
are connected to the ﬁrst N nodes, and the loads and the
point that networks with the neighboring microgrids locate at

where

3

1 , . . . , ∆x(cid:62)

N ](cid:62); ∆ωs = [∆ωs1, . . . ∆ωsN ](cid:62);

∆x = [∆x(cid:62)
∆PG = [PG1, . . . , PGN ](cid:62); AG = diag(A1, . . . , AN );
B1 = diag(B11, . . . , B1N ); B2 = diag(B21, . . . , B2N ).

2) Network Constraints: For the microgrid under study, its
neighboring microgrids that can be networked with can be con-
sidered power injection. For simplicity, real power and voltage
magnitudes are assumed to be decoupled, i.e., the voltage
magnitudes Vi for i ∈ {1, . . . , N + M } is constant. The IBRs
and loads are interconnected via microgrid network which
introduces algebraic constraints for i ∈ {1, 2, . . . , N + M }:

PIi − V ∗2

i gii −

N +M
(cid:88)

k=1,k(cid:54)=i

i V ∗
V ∗

k Yik cos(δik − θik) = 0

(7)

where PIi
is the net real injection to node i; gii denotes
the self-conductance of node i; the admittance of the branch
from the i-th to the k-th node is Yik∠θik; V ∗
is the nominal
i
voltage magnitude at node i; and δik is the voltage phase angle
difference between nodes i and k, i.e., δik = δi−δk. Denote by
{P ∗
i |i = 1, 2, . . . , N +M } the operating condition
that satisﬁes constraints (7). Deﬁne the following vectors
L ](cid:62)

∆PI := [∆PI1, . . . , ∆PIN +M ](cid:62) = [∆P(cid:62)
∆δ := [∆δ1, . . . , ∆δN +M ](cid:62) = [∆δ(cid:62)

G , ∆P(cid:62)
L ](cid:62)

G , ∆δ(cid:62)

Ii, Q∗

Ii, V ∗

i , δ∗

where ∆PIi and ∆δi are the deviations of PIi and δi from P ∗
Ii
i , respectively; ∆PG = [∆PG1, . . . , ∆PGN ](cid:62); ∆PL =
and δ∗
[∆PIN +1, . . . , ∆PIN +M ](cid:62); ∆δG = [∆δ1, . . . , ∆δN ](cid:62);
∆δL = [∆δN +1, . . . , ∆δN +M ](cid:62); and the subscript of “I” of
∆PIi stands for “Injection”. If ∆PIi and ∆δi for all i are small,
the relationship between ∆PI and ∆δI can be described by

∆PI = H∆δ
where the entry h(i,k) at the i-th row and the k-th column of
H ∈ R(N +M )×(N +M ) can be obtained via
k Yik sin(δ∗
i V ∗
N +M
(cid:88)

ik − θik) ∀k (cid:54)= i

h(i,k) = V ∗

(9)

i V ∗
V ∗

p Yip sin(cid:0)δ∗

ip − θip

(cid:1).

h(i,i) = −

p=1,p(cid:54)=i

Equation (9) is equivalent to

(cid:21)

(cid:20)∆PG
∆PL

=

(cid:20)HGG HGL
HLG HLL

(cid:21) (cid:20)∆δG
∆δL

(cid:21)

(11)

where HGG ∈ RN ×N , HGL ∈ RN ×M , HLG ∈ RM ×N , and
HLL ∈ RM ×M . Based on the above equation, ∆PG can be
expressed as a function of ∆δG and ∆PL, i.e.,
∆PG = (HGG − HGLH −1
3) System Dynamics: Plugging (12) into (5), we have

LL HLG)∆δG + HGLH −1

LL ∆PL. (12)

Fig. 1. A microgrid with N IBRs and M loads and the control scheme
of IBRs. The control variables of loops 1 and 2 are voltage and current
measurements from the LC ﬁlter, and the modulation index, respectively.

nodes N + 1, . . . , N + M , as shown in Figure 1. The effect
of the neighboring microgrids on the microgrid under study is
modeled as load power injection.

1) Nodal dynamics: Without µAGC and load/renewable
power ﬂuctuations, the primary control is designed such that
the frequencies at all IBRs can be stabilized at ωnom which
is the desired/nominal frequency (i.e., 314 or 377 rad/s). The
dynamics of the power calculator at the i-th IBR is
˙δi = ωi − ωnom
˙Pi = −ωciPi + ωciPGi
ωi = ωsi − mPiPi

(1b)

(1c)

(1a)

where δi is the internal voltage phase angle; ωi is frequency;
PGi is the instantaneous real power component [26]; Pi is
the real power ﬁltered by the digital ﬁlter; ωci is the cut-off
frequency of the digital ﬁlter; ωsi is the setpoint; and mPi is
the droop coefﬁcient. Equation (1a) is introduced by deﬁnition;
and Equations (1b) and (1c) are resulting from the digital ﬁlter
dynamics and the droop characteristic [26]. Variables PGi, Pi,
δi, and ωsi are annotated in Figure 1. Since ωi is the variable
that is regulated by the µAGC, we eliminate Pi by noting
˙ωi = −mPi ˙Pi; Pi = (ωsi − ωi)/mPi.

(2)

The underlying assumption of (2) is that the change rate of
˙ωsi ≈ 0. With (2),
setpoint
we obtain the following dynamics for the i-th IBR where ωi
becomes a state variable:

˙ωsi is much slower than ˙ωi, i.e.,

(3a)

(3b)

˙δi = ωi − ωnom
˙ωi = −ωciωi + ωciωsi − mPiωciPGi.
i , ω∗

i , and P ∗

Denote by δ∗
Gi the steady-state values of δi, ωi,
and PGi, respectively. Suppose that there are no load/renewable
power ﬂuctuations. If we need ωi to converge to ωnom, ωsi
should be set to ω∗

si where ω∗

si = ωnom + mPiP ∗
Gi.
i , ∆ωi = ωi − ω∗
i , ∆PGi = PGi − P ∗
Gi,
si. Use ∆xi = [∆δi, ∆ωi](cid:62) as a state

Deﬁne ∆δi = δi − δ∗
and ∆ωsi = ωsi − ω∗
vector. Then, Equation (3) becomes

∆ ˙xi = Ai∆xi + B1i∆ωsi + B2i∆PGi

(4)

where

Ai =

(cid:21)

(cid:20)0
0 −ωci

1

, B1i =

(cid:21)

(cid:20) 0
ωci

, B2i =

(cid:20)

0
−mPiωci

(cid:21)

.

The dynamics for N IBRs can be described by

∆ ˙x = AG∆x + B1∆ωs + B2∆PG

(5)

∆ ˙x = A∆x + B1∆ωs + F ∆PL

(13)

where A = AG + B2(HGG − HGLH −1
LL HLG)E; and F =
B2HGLH −1
LL . In the expression of matrix A, matrix E =
diag(E1, . . . , EN ) where Ei = [1, 0] for i = 1, . . . , N . It is
worth noting that dynamics (13) directly establish the connec-
tion between the frequency change ∆ωi and the load/tie-line
ﬂow ﬂuctuations ∆PL.

4) Two Common Assumptions for Conventional µAGC De-
sign: The objective of µAGC is to drive the frequency devi-
ations {∆ωi|i = 1, . . . , N } to zero by tuning the setpoints of
IBRs ωsi in the presence of load/renewable power ﬂuctuations
∆PL. With such an objective, a centralized µAGC typically
tunes the setpoints ωs of the IBRs under control by measuring
the frequency at a critical node. A decentralized/distributed
µAGC observes its local frequency and other variables, e.g.,
local real power PGi, to tune its local setpoint ωsi. Note that
these µAGC design schemes are generally built upon at least
one of the following two assumptions: 1) An IBR can report
its true frequency ωi to its µAGC, or ωi can be measured
accurately by external sensors; and 2) The measurements
feeding the secondary controllers are authentic. However, it
is possible that neither assumption holds in practice. This will
be elaborated in the following two subsections.

B. Sensory Challenges of µAGC Design

The frequency ωi is used as an input for many conventional
µAGC to tune the setpoint ωsi. For a commercial inverter, this
variable is an internal, digital control command that might not
be accessible for a third-party µAGC. One alternative solution
to obtaining ωi is to measure the frequency of the fundamental
component of terminal voltage at the i-th IBR. However, it
is challenging to measure frequency both fast and accurately
in practice . Figure 2 shows the sensory challenges when
actual frequency changes fast and the frequency is required
to be measured fast. In Figure 2, the orange lines represent
the true frequency of three-phase sinusoidal waves, while the
blue curves shows the frequencies measured by a Simulink
Phasor Measurement Unit (PMU) block [27]. In Figure 2(a),
the true frequency changes at the 1-st second, the measured
frequency converges to the true frequency. The measurement
error is acceptable if the PMU reports the frequency at a
slow rate, say 10 samples per second (10 Hz). However, large
measurement errors may exist from time t = 1 s to t = 1.1 s,
if frequency is required to be reported every 0.01 seconds (100
Hz). Furthermore, as shown in Figure 2(b), if the frequency
keeps ﬂuctuating, the large measurement errors can persist
when a high sampling rate, say, 100 Hz, is required.

4

fast, large frequency ﬂuctuations are more pronounces in small
systems like microgrids than in the BPSs. Similar to the bulk
transmission systems, there are volatile loads/renewables that
keep perturbing the microgrid, which cause the microgrid fre-
quencies to keep ﬂuctuating. Compared with the transmission
systems, the microgrid is more sensitive to these disturbances
due to its smaller scale and the low inertia of its DERs.
As a result, the microgrid frequencies may have large, fast
ﬂuctuations. To regulate the microgrid frequencies to their
nominal values, the rate of issuing control commands should
be much faster than the rate at which disturbances change.
Otherwise, the frequencies may not be regulated. Since the
frequency cannot be measured accurately in a fast manner,
for a conventional µAGC that takes measured frequency as
inputs, its desirable control performance may not be achieved
only by increasing the rates of issuing control signals. This
motivates us to design a fast µAGC without using the fast
measurements of frequencies. The solution to addressing the
sensory challenge is presented in Section III.

C. Cyber Vulnerability of µAGC

A third-party µAGC coordinates IBRs based on sensor
if these sensor mea-
measurements. One concern is that
surements are maliciously manipulated by an adversary, all
control commends from the µAGC can compromise the safety
and efﬁciency of the microgrid [28]. Denote by y and y(cid:48)
the actual measurements and the information feeding µAGC,
respectively. Without cyber attacks, y(cid:48) equals y, while y(cid:48) can
be different from y if cyber attacks occur. For example, an
attacker can blind the µAGC by launching a replay attack,
i.e., the actual measurements y is replaced by a sequence
of pre-recorded y [28]. As another example, an adversary
may compromise the efﬁciency of the µAGC by superposing
random noise upon the actual measurements y. Such an attack
is termed the noise injection attack [28]. A key question is
how to design the µAGC that is resilient to the cyber attacks
on the information feeding the µAGC. Section IV proposes a
potential answer to this question.

III. FAST MICRO-AUTOMATIC GENERATION CONTROL

This section introduces a new model

that exploits the
rank-one-deﬁciency property of the microgrid dynamics and
describes the microgrid behaviors in a new state space. Such
a model lends itself to address the sensory challenge in the
presence of fast load/renewable power ﬂuctuations. Based on
the model in the new space, we introduce a fast µAGC for a
system of microgrids.

(a)

(b)

A. New State Space Modeling of Microgrid Dynamics

Fig. 2. (a) The true frequency can be measured if it changes slowly; (b) The
true frequency cannot be accurately measured if it changes fast.

One obvious question is why a high sampling rate of
measurements is necessary for µAGC, compared with the
conventional AGC in bulk transmission systems which issues
control commands every 2-4 seconds. The reason is that the

We describe the microgrid dynamics in a new state-space by
exploiting the rank deﬁciency property of the system matrix
Ai in (4). The rank deﬁciency property is used for analyzing
bulk transmission systems in our previous work [29], [30]. It is
obvious that Ai is rank deﬁcient, i.e., one of eigenvalues of Ai
is zero. Denote by Ti ∈ R1×2 the left eigenvector associated

0.9511.051.11.151.21.251.349.949.955050.0550.150.1550.250.2550.3measuredtrue0.9511.051.11.151.21.251.349.949.955050.0550.150.1550.250.2550.3measuredtruewith the zero eigenvalue of matrix Ai. By deﬁnition, we have
TiAi = 0. One choice of Ti is

Ti = [ωci, 1].

Deﬁne a scalar zi as follows:

zi := Ti∆xi.

Multiplying both sides of (4) by Ti, we obtain

˙zi = ωci∆ωsi − mPiωci∆PGi.

(14)

(15)

(16)

Here, we show that the scalar zi lends itself to design a fast

µAGC. The reason lies in the following two observations:

• Observation 1: zi reﬂects the frequency regulation ob-

jective: a zero ˙zi implies that ∆ωi tends to zero.

• Observation 2: Computing zi only requires PGi, sug-

gesting that zi can be obtained in a fast manner.

Observation 1 results from Equations (4) and (16) that lead to

∆ ˙ωi = −ωc∆ωi + ˙zi.

(17)

With a zero ˙zi, ∆ωi(t) tends to zero, as time t tends to inﬁnity,
given any intial condition ∆ωi(0). This is because the scalar
system ∆ ˙ωi = −ωc∆ωi is asymptotically stable, where ωc >
0. Observation 1 essentially connects the frequency regulation
with the scalar zi, and it suggests that the frequency at the
i-th IBR can be regulated, if the corresponding ˙zi equals 0.
Observation 2 is obtained by integrating both sides of (16):

zi(t) = ωci

(cid:90) t

0

(∆ωsi(τ ) − mPi∆PGi(τ )) dτ + zi(0)

(18)

where ∆ωsi is the control command produced by the sec-
ondary controller; ∆PGi can be measured in a fast manner;
and the initial condition zi(0) can be set to zero for en-
gineering implementation. Essentially, (18) suggests that if
the µAGC makes decisions by observing zi in the presence
of fast load/renewable power ﬂuctuations, it is unnecessary
to have fast frequency measurements. Therefore, the sensory
bottleneck described in Section II-B is overcome.

It is worth noting that the modeling approach is applicable
to other types of DERs that possesses the rank-one deﬁciency
property. This is because this rank deﬁciency is a direct conse-
quence of conservation of energy [29], [30]. Our earlier work
[31] addresses synchronous machines using the same modeling
approach. Such a modeling approach lends itself to a µAGC
design for microgrids with heterogeneous energy resources.
The µAGC design for such a kind of microgrids cannot
be formulated by some control methods that are speciﬁcally
designed for IBRs, such as [13].

B. Optimal Frequency Regulation

This subsection introduces an optimal µAGC that tunes the
IBR setpoints ∆ωi by observing the scalars zi. To drive the
frequency deviations to zero, based on Observation 1, one
possible control law is

∆ωsi = mPi∆PGi ∀i = 1, . . . , N.

(19)

According to (16), the control law (19) leads to a zero ˙zi.
It follows that ∆ωsi tends to zero, based on Observation 1.

5

It is worth noting that the control law (19) can be imple-
mented in a decentralized manner, as the setpoint for the i-
th IBR is computed only by its local measurement PGi for
i = 1, 2, . . . , N . However, the decentralized control law (19)
might not achieve high economical efﬁciency, since different
IBRs incurs different generation costs. For example, we may
expect the cheaper IBRs to generate more real power in order
to regulate the microgrid frequencies. Therefore, coordination
among IBRs is needed in order to regulate frequencies at the
minimal costs. Such coordination is achieved by formulating
the frequency regulation problem into the following optimal
control problem in the zi space:

(cid:90) ∞

0

(20)

min
∆ωs

(cid:2)z(t)(cid:62)Qz(t) + ∆ωs(t)(cid:62)R∆ωs(t)(cid:3) dt

1
2
s.t. ∆ ˙x(t) = A∆x(t) + B1∆ωs(t)
where z = [z1, . . . , zN ](cid:62); matrices Q ∈ RN ×N and R ∈
RN ×N are positive deﬁnite. In the frequency regulation prob-
lem in this paper, both matrices Q and R are diagonal. Denote
by qi and ri the i-th diagonal entry of Q and R, respectively. A
relatively large qi suggests relatively higher quality of service
is required by the end users at node i. A relatively large ri
suggests a relatively higher generation cost at the i-th IBR.
Based on transformation (14), z can be expressed in terms of
states ∆x in the conventional space

z = T ∆x

(21)

where T = diag(T1, . . . , TN ). Plugging (21) into the objective
function of the optimization (20) gives the standard formula-
tion of the linear quadratic regulator (LQR) problem:

min
∆ωs

(cid:90) ∞

(cid:2)∆x(t)(cid:62)Q(cid:48)∆x(t) + ∆ωs(t)(cid:62)R∆ωs(t)(cid:3) dt

1
2
s.t. ∆ ˙x(t) = A∆x(t) + B1∆ωs(t)

0

(22)
where Q(cid:48) = T (cid:62)QT . The solution to (22) has the following
form: ∆ωs = −K (cid:48)∆x, where K (cid:48) can be obtained a process
that has been standardized in some software toolboxes, e.g.,
the function lqr in MATLAB. As discussed earlier, it is more
desirable to feed µAGC the transformed states z, rather than
∆x which includes the frequency deviation δωi that is hard
to measure at a fast rate. Therefore, the control law is

∆ωs = −Kz.

(23)

where matrix K is chosen such that Kz ≈ K (cid:48)∆x, and one
possible choice of K is K = K (cid:48)T (cid:62)(T T (cid:62))−1 [30]. Note
that the control law (23) tunes ∆ωs by observing z or by
measuring PGi for i = 1, 2, . . . , N . Such a control law is
immune to the false data injection attacks on frequency or
phase angle measurements. However, it is vulnerable to cyber
attacks on PGi. The cyber vulnerability of the control law (23)
is addressed in the following section.

IV. CYBER ANOMALY DETECTION AND CORRECTION
To compute z, the real power PGi for all IBRs is needed
to be measured and reported to a µAGC. It
is possible
that a malicious adversary can compromise the microgrid by
manipulating the PGi. If this happens, the control command

6

∆ωs issued by the µAGC may fail to stabilize or to regulate
the frequency, compromising the microgrid’s safety and the
quality of electricity service. This section introduces an end-
to-end scheme that can enhance the microgrid resilience to
cyber attack on the critical measurements. The key idea of the
scheme is to leverage a computational model that represents
the dynamics of the microgrid, for the purpose of predicting
PGi. The main challenge is how to obtain the computational
model that bridges the healthy information ∆ωs to PGi that
might be under cyber attacks. We ﬁrst present the computa-
tional model that serves as the prerequisite of applying existing
cyber attack detection algorithms. Next, we propose a strategy
that can mitigate the impact of cyber attacks.

2) Order Selection: The optimal system order d∗ is ob-
tained by trial and error. Suppose that there a set D that collects
some candidate system orders, say, D := {1, 2, . . . , 10}. For
d ∈ D, the N4SID technique can return the identiﬁed A(cid:48), B(cid:48),
and C (cid:48). With these matrices and the input data O, ∆PG’s
prediction ∆ ˆPGd can be computed. The performance of the
identiﬁed system with the order d can be quantiﬁed by

ηd =

1
K0 + 1

K0(cid:88)

k=0

(cid:13)
(cid:13)∆ ˆPGd − ∆PG
(cid:13)

(cid:13)
(cid:13)
(cid:13)2

.

(27)

The optimal order d∗ is chosen such that the smallest ηd is
attained, viz., η∗ = arg mind∈D ηd.

A. Computational Model for Cyber Attack Mitigation

Without load/renewable power ﬂuctuations, the real power
∆PG used for computing z in (23) can be predicted by ∆ωs
according to the following discrete state space model with the
sample time ∆t:

ˆx[k] = A(cid:48) ˆx[k − 1] + B(cid:48)∆ωs[k − 1]
∆ ˆPG[k] = C (cid:48) ˆx[k]

(24a)

(24b)

where ∆ ˆPG is the predicted version of ∆PG[k]; ˆx[k] is an
intermediate variable which can be obtained by using (24a)
recursively if ˆx[0] is given; and A(cid:48), B(cid:48), and C (cid:48) are the system,
input, and output matrices.

One challenge of using (24) to predict ∆PG is how to
obtain the matrices A(cid:48), B(cid:48), and C (cid:48). We leverage a system
identiﬁcation technique (i.e., N4SID [32]) to learn these
matrices using the experimental measurements of ∆ωs and
∆PG. Implementing the N4SID technique requires: 1) input-
output data; and 2) the order of the system (24).

1) Input-output data: Deﬁne

a

rectangular

function

rect(t) as follows

rect(t) = 1t≥0 − 1t−∆t(cid:48)≥0

(25)

where ∆t(cid:48) > ∆t denotes the width of the rectangular pulse;
and 1t≥0 is an indicator function, i.e.,

1t≥0 =

(cid:40)

1
0

t ≥ 0
t < 0.

The input signal ∆ω(cid:48)
s[k] for system identiﬁcation can be
sampled from the following continuous function with sampling
time ∆t

l(t) =

(cid:100)t/∆t(cid:48)(cid:101)
(cid:88)

k=0

αkrect(t − k∆t(cid:48))

(26)

where (cid:100)·(cid:101) is the ceiling function; the random scalar αk is
uniformly distributed in [−β, β] whence β is a small positive
scalar. By feeding the microgrid the designed setpoint se-
quence S = {∆ω(cid:48)
s[k]|k = 0, 1, . . . , K0}, the response of ∆PG
can be measured at sample time ∆t. The input sequence S
associated with the ∆PG’s response is used for implementing
the N4SID technique.

B. Cyber Attack Detection

The state-space model (24) can be used in some cyber attack
detection algorithms, e.g., the dynamic watermarking approach
[23], and the UIO method [21]. As an example, we show how
to use the dynamic watermarking approach to detect cyber
attacks on PGi.

Figure 3 shows the basic idea of the dynamic watermarking
approach. A small, secret watermark signal e[k] ∈ RN is
superposed upon the IBRs’ setpoints ∆ωs at each time step
k. The watermark signal possesses some known statistics, e.g.
e[k] ∼ N (0, Σ) where matrix Σ is the covariance matrix of
e[k]. The watermark e[k] impacts the measurement of ∆PG.
As a result, an authentic measurement of ∆PG should reﬂect
the statistical properties concerning the watermark e[k]. By
subjecting the measurements of ∆PG to certain statistical
tests, a wide range of cyber attacks on the measurement of
∆PG can be detected [23], [28].

The detailed mechanism of the dynamic watermarking ap-
proach is elaborated as follows. Denote by ∆P(cid:48)
G the measure-
ments of the real power ∆PG that are received by the µAGC.
If there are no cyber attacks on ∆PG, ∆P(cid:48)
G = ∆PG, with the
true sequence of {∆ωs[i]} and {e[i]} for i = 0, 1, . . . , k − 1,
one can approximately predict ∆PG[k] based on

ˆx[k] = A(cid:48) ˆx[k − 1] + B(cid:48)(∆ωs[k − 1] + e[k − 1])
∆ ˆPG[k] = C (cid:48) ˆx[k].

(28a)

(28b)

Deﬁne

ν[k] := ∆P(cid:48)

G[k] − ∆ ˆPG[k].
For a microgrid without cyber attack, i.e., ∆P(cid:48)
we can obtain a long sequence {∆P(cid:48)
where W is a large integer. The expectation µ∗
matrix Σ∗
approximated by ˆµ∗

G[k] = ∆PG[k],
G[k]|k = 1, . . . , W }
ν and covariance
ν of ν in the microgrid without cyber attack can be

(29)

ν and ˆΣ∗

ν where

ˆµ∗

ν =

ˆΣ∗

ν =

1
W

1
W

W
(cid:88)

k=1
W
(cid:88)

ν[k]

(ν[k] − ˆµ∗

ν)(ν[k] − ˆµ∗

ν)(cid:62).

(30a)

(30b)

k=1

For the microgrid that might be under cyber attacks where
∆P(cid:48)
G[k] may not be equal to ∆PG[k], denote by ˆµν and
ˆΣν the estimated expectation and covariance matrix of ν,

7

the proposed control law (23). Depending on whether there
are microgrids that can be networked with the microgrid under
cyber attacks, the µAGC under cyber attack can select one of
the following two schemes to regulate frequencies.

1) Observer-based Correction Scheme: Once the cyber at-
tack is detected and there is no neighboring microgrid that can
be networked with the microgrid under attack, the microgrid
attacked can use the observer-based correction scheme to
regulate its frequencies. The basic idea of such a scheme is to
leverage an observer to predict the real power measurement
∆PG and to use the prediction ∆ ˆPG to tune the setpoints ∆ωs
of IBRs. Speciﬁcally, the observer is deﬁned in (24) [33]. The
control law in the observer-based correction scheme is
∆ωs = −K (cid:2)ˆz1, ˆz2, . . . , ˆzN

(34)

(cid:3)(cid:62)

.

where ˆzi(t) = ωci

(cid:16)

(cid:17)
∆ωsi(τ ) − mPi∆ ˆPGi(τ )

dτ .

(cid:82) t
0

2) Collaborative Correction Scheme: The control law (19)
is blind to load/renewable power ﬂuctuations. As a result,
the frequencies cannot be regulated at the nominal frequency
if ∆PL (cid:54)= 0. This issue can be addressed by the collabo-
rative correction scheme presented here. Suppose that there
are two islanded microgrids. Each microgrid has its own
µAGC designed based on the control law (23). Assume that
µAGC1 (µAGC2) is for Microgrid 1 (Microgrid 2). Suppose
that microgrid 1 is under cyber attack on its ∆PGi that is
used for computing zi. Once the cyber attack is detected at
Microgrid 1 by some cyber attack detection algorithms, e.g.,
the dynamic watermarking approach, µAGC1 will be disabled,
and Microgrid 1 can be networked with Microgrid 2 by closing
the tie line between Microgrids 1 and 2. As will be shown in
Section V, µAGC2 can regulate the frequencies at all nodes
of both Microgrids 1 and 2, while µAGC2 makes decisions
only based on the local measurements at Microgrid 2.

The overall procedure described throughout Sections III and
IV is summarized in Algorithm 2 where set Iρ−1 collects the
input for the function DW in Algorithm 1, i.e.,

Iρ−1 :={Mρ−1, ˆMρ−1, ∆P(cid:48)

G[ρ], ∆ωs[ρ], e[ρ],

ˆx(cid:48)[ρ − 1], A(cid:48), B(cid:48), C (cid:48), ˆµ∗

ν, ˆΣ∗

ν, (cid:15)1, (cid:15)2}.

(35)

V. CASE STUDY

In this section, the proposed fast µAGC and the associated
cyber anomaly detection and correction scheme are tested in a
microgrid with three IBRs via Simulink simulations. We ﬁrst
provide a brief description for the software-based microgrid
testbed. Then we show the performance of the fast controller
that exploits the rank deﬁciency property of IBRs, under
fast renewable/load power ﬂuctuations. Finally, we present
the performance of the cyber attack detection and correction
scheme that is built upon the model developed in Section IV.

A. Description of Software-based Microgrid Testbed

Figure 4 illustrates the physical and cyber architecture
of two networked microgrids that are used to test the pro-
posed algorithms. For each IBR, its power calculator, voltage
controller, current controller, and output ﬁlter are modeled

Fig. 3. Basic idea of the dynamic watermarking approach

respectively. Let Mρ and ˆMρ collect ∆P(cid:48) and its prediction
∆ ˆPG from time t = (ρ − W + 1)∆t to t = ρ∆t, viz.,

(31a)

(31b)

(32a)

Mρ := {∆P(cid:48)
G[k]|k = ρ − W + 1, . . . , ρ}
ˆMρ := {∆ ˆPG[k]|k = ρ − W + 1, . . . , ρ}.

ˆµν and ˆΣν can be estimated from Mρ and ˆMρ via

ρ
(cid:88)

ν[k]

ˆµν =

ˆΣν =

1
W

1
W

k=ρ−W +1
ρ
(cid:88)

(ν[k] − ˆµν)(ν[k] − ˆµν)(cid:62).

(32b)

k=ρ−W +1

G[k] = ∆PG[k], ˆµν and ˆΣν should be close to ˆµ∗

ν and

If ∆P(cid:48)
ˆΣ∗

ν, respectively, that is,

ξ1 = (cid:107) ˆµν − ˆµ∗
ξ2 = |tr( ˆΣν − ˆΣ∗

ν(cid:107)2 < (cid:15)1
ν)| < (cid:15)2

(33a)

(33b)

(cid:54)= ∆P(cid:48)

where (cid:107)·(cid:107)2 and tr(·) are the L2 norm and the trace operator,
respectively; and (cid:15)1 and (cid:15)2 are positive numbers. Violation
of either (33a) or (33b) or both suggests cyber attacks, i.e.,
G[k]. The two conditions in (33) can be
∆PG[k]
checked in a moving-window fashion, which is summarized
in Algorithm 1. Function DW in Algorithm 1 returns a binary
result: “flag = 0” suggests that a cyber attack is not detected,
while “flag = 1” suggests that cyber attack is detected.

Algorithm 1 Watermarking-based Cyber Attack Detection
1: function DW(Mρ−1, ˆMρ−1, ∆P(cid:48)

G[ρ], ∆ωs[ρ], e[ρ], ˆx(cid:48)[ρ−

∪ ˆMρ−1 −
G[ρ]} ∪ Mρ−1 − {∆P(cid:48)

(cid:111)
(cid:110)
∆ ˆPG[ρ − W ]
G[ρ − W ]}

Compute ˆµν, ˆΣν using Mρ, ˆMρ based on (29), (32)
Obtain ξ1 and ξ2 according to (33)
if (ξ1 < (cid:15)1) ∧ (ξ2 < (cid:15)2) then

2:

ν, (cid:15)1, (cid:15)2)

1], A(cid:48), B(cid:48), C (cid:48), ˆµ∗

ν, ˆΣ∗
Compute ∆ ˆPG[ρ], ˆx by (28)
(cid:111)
(cid:110)
∆ ˆPG[ρ]
ˆMρ ←
3:
4: Mρ ← {∆P(cid:48)
5:
6:
7:
8:
9:

flag ← 0

else

flag ← 1

10:
11:
12:
13: end function

end if
return flag, Mρ, ˆMρ, ˆx(cid:48)[ρ]

(cid:46) No attack is detected

(cid:46) Attack is detected

C. Corrective Control

This subsection addresses how to regulate frequency under
cyber attacks on the real power measurements ∆PG feeding

G[k]}

flag, Mρ, ˆMρ, x(cid:48)[ρ] ← DW(Iρ−1)
if flag = 0 then

Algorithm 2 Cyber Resilient µAGC
1: MW ← ∪W
k=1{∆P(cid:48)
2: while ρ = W + 1, W + 2, . . . do
3:
4:
5:
6:
7:
8:

Compute ∆ωs[ρ] via (18) and (23)

else

if Neighboring microgrids are unavailable then

Compute ∆ωs[ρ] via (24) and (34).
e[ρ] ← 0

(cid:46) Stop injecting watermark

else

∆ωs[ρ] ← 0; e[ρ] ← 0
Network with the neighboring microgrids

end if

9:
10:
11:
12:
13:

end if
return ∆ωs[ρ]

14:
15:
16: end while

Fig. 4. Physical and cyber architecture of two networked microgrids

according to [26]. All IBRs have the same parameters. Loads
1, 2, and 3 are modeled by resistors with the values of 25 Ω,
20 Ω, and 33 Ω for each phase. There is a tie line that can
network Microgrid 1 with Microgrid 2. The line parameters
are annotated in Figure 4. Each microgrid has its own µAGC
which tunes the setpoint of each IBR in the local microgrid.

B. Control Performance without Cyber Attack

Here the performance of the controller (23) is tested. The
secondary controller µAGC1 takes real power measurements
PGi every 5 ms and issues control commands ωsi at the same
rate, for i = 1, 2, 3. The tie line in Figure 4 is open.

1) Control Performance with Fast Renewable Fluctuations:
Suppose Load 1 varies periodically and Figure 5 shows the real
power ﬂowing to Load 1. The spikes in Figure 5(a) show the
load changing transients, and the zoomed-in version of one of
the spikes is shown in Figure 5(b). As a result, the frequencies
at the three nodes of Microgrid 1 ﬂuctuate periodically. This
can be observed via the orange dashed curves in Figure 6.

8

The blue curves in Figure 6 show the frequencies at the three
nodes with fast load/renewable power ﬂuctuations, when the
proposed µAGC1 is enabled. It can be seen that the magnitudes
of the frequencies’ ﬂuctuations are signiﬁcantly reduced by the
proposed µAGC under load/renewable power ﬂuctuations.

2) Comparison: The proposed µAGC is compared with a
slow LQR µAGC and a fast proportional–integral (PI) µAGC.
The slow µAGC issues control commands every 0.1 s, while
the two fast µAGC issues control commands every 5 ms.
Figure 7 summarizes the comparison results in response to
the load power ﬂuctuations shown in Figure 5. In Figure 7,
the orange dotted curves are the frequencies under the slow
µAGC. It can be observed that the frequencies cannot be regu-
lated. This is not surprising because the time interval between
two successive control commends is the same as that between
two successive disturbances. The yellow dashed curves are
the frequency response with the fast PI µAGC. Since the fast
frequency changes cannot be measured accurately, the fre-
quencies under the fast PI controller still cannot be regulated.
As the proposed µAGC does not rely on the availability of
fast frequency measurements, the frequencies can be regulated
tightly around 50 Hz under the fast load/renewable power
ﬂuctuations, as it is shown by the blue curves in Figure 7.

C. Cyber Attack Detection and Corrective Control

The proposed scheme for cyber resilient frequency regulator
is tested under both renewable/load power ﬂuctuations and
cyber attacks.

1) Cyber Attack Detection: One prerequisite for imple-
menting Algorithm 1 is that the matrices A(cid:48), B(cid:48), and C (cid:48) are
available. In this paper, these matrices are learned from the
measurements of ∆ωs and ∆PG based on the system identiﬁ-
cation procedure. The performance of the system identiﬁcation
procedure is shown in Figure 8. Without the load/renewable
power ﬂuctuations, the set point ∆ωs1 has a step change at
time t = 0.7 s. The blue curve in Figure 8 represents the
evolution of the measurements on PG1 under the step change.
The orange dashed curve represents the prediction of the real
power PG1 according to the learned state space model. These
two curves almost overlap with each other, suggesting that the
state-space model learned can accurately predict the response
of the real power measurements PG1.

The performance of Algorithm 1 is tested under the noise
injection attack and the replay attack. Figure 9 shows the
performance of of Algorithm 1 under the noise injection

(a)

(b)

Fig. 5. (a) Real power measurement PL1 at load 1; and (b) zoomed-in version
of PL1 from time t = 0.799 sec. to t = 0.803 sec.

0.511.50.20.40.60.811.21.41.61.81040.7990.80.8010.8020.8033000400050006000700080009000100009

Fig. 6. Frequencies at (a) node 1, (b) node 2, and (c) node 3 with and without the proposed µAGC.

(a)

(b)

(c)

Fig. 7. Comparison of the proposed µAGC, the slow LQR-based controller, and the fast PI controller: frequencies at Nodes 1 (a), 2 (b), and 3 (c).

(a)

(b)

(c)

Fig. 8. Actual measurements and predicted measurements

(a)

(b)

attack. As shown in Figure 9(a), the noise injection attack
on PG1 is launched at time t = 2 s. Such an attack causes the
attack indicator ξ2 to shoot up and triggers the cyber attack
alarm. Figure 10 illustrates the performance of of Algorithm 1
under the replay attack. A replay attack on the PG1 occurs at
time t = 2 s. Figure 10(a) shows the PG1 measurements under
such an attack. From Figure 10(a), it is hard to determine
when the cyber anomaly occurs by simply eyeballing the PG1
measurement curve. However, Figure 10(b) which shows the
evolution of the attack indicator ξ2 explicitly suggests that the
attack occurs around t = 2 s.

2) Observer-based Cyber Attack Correction: Figure 11
demonstrates the performance of the observer-based corrective
controller. The noise injection attacks occur at
the sensor
measuring PG1 at Microgrid 1 at t = 0.7 s. Consequently,
frequencies at the three nodes of Microgrid 1 become noisy.
At t = 1 s, the observer-based corrective controller is enabled,
and the frequencies are stabilized.

3) Collaborative Cyber Attack Correction: The observer-
is blind to renewable/load power
based corrective control
ﬂuctuations. If Microgrid 2 is available, once cyber attacks

Fig. 9. Detection of the noise injection attack: (a) the real power measurement
PGi in the time domain; and (b) the evolution of cyber attack indicator ξ2.

(a)

(b)

Fig. 10. Detection of the replay attack: (a) the real power measurement PGi
in the time domain; and (b) the evolution of cyber attack indicator ξ2.

at Microgrid 1 are detected, Microgrid 1 can disable µAGC1
and turn on the switches of the tie line that connects Microgrid
2. The µAGC2 can regulate the frequencies of both Microgrids
1 and 2. Figure 12 illustrates such a process. Suppose that at
t = 0.5 s, µAGC1 is disabled due to a cyber attack detected.
Load 1 also increases at t = 0.5 s, leading frequencies at

0.511.549.9649.9749.9849.995050.0150.0250.03proposed controlno control0.511.549.9649.9749.9849.995050.0150.0250.03proposed controlno control0.511.549.9649.9749.9849.995050.0150.0250.03proposed controlno control1.51.61.71.81.9249.9649.9749.9849.995050.0150.0250.03proposed controlslow LQR controlfast PI control1.51.61.71.81.9249.9649.9749.9849.995050.0150.0250.03proposed controlslow LQR controlfast PI control1.51.61.71.81.9249.9649.9749.9849.995050.0150.0250.03proposed controlslow LQR controlfast PI control0.511.543004400450046004700480049005000MeasurementPredicted1.522.53-50000500010000150001.522.530246810121061.522.533700380039004000410042001.522.53123456710410

[5] Simpson-Porco et al., “Secondary frequency and voltage control of
islanded microgrids via distributed averaging,” IEEE Transactions on
Industrial Electronics, vol. 62, no. 11, pp. 7025–7038, 2015.

[6] J. Choi, S. I. Habibi, and A. Bidram, “Distributed ﬁnite-time event-
triggered frequency and voltage control of ac microgrids,” IEEE Trans-
actions on Power Systems, vol. 37, no. 3, pp. 1979–1994, 2021.

[7] Y. Khayat et al., “On the secondary control architectures of ac micro-
grids: An overview,” IEEE Transactions on Power Electronics, 2019.
[8] J. P. Lopes, C. L. Moreira, and A. Madureira, “Deﬁning control strategies
for microgrids islanded operation,” IEEE Transactions on power systems,
vol. 21, no. 2, pp. 916–924, 2006.

[9] A. G. Tsikalakis and N. D. Hatziargyriou, “Centralized control for
optimizing microgrids operation,” in IEEE PES General Meeting, 2011.
[10] S. Manaffam et al., “Intelligent pinning based cooperative secondary
control of distributed generators for microgrid in islanding operation
mode,” IEEE Transactions on Power Systems, 2017.

[11] J. Shi, D. Yue, and S. Weng, “Distributed event-triggered mechanism for
secondary voltage control with microgrids,” Transactions of the Institute
of Measurement and Control, 2019.

[12] Y. Han et al., “Analysis of washout ﬁlter-based power sharing strat-
egy—an equivalent secondary controller for islanded microgrid without
lbc lines,” IEEE Transactions on Smart Grid, 2017.

[13] Y. Khayat et al., “Decentralized optimal frequency control

in au-

tonomous microgrids,” IEEE Transactions on Power Systems, 2018.
[14] G. Lou et al., “Decentralised secondary voltage and frequency control
scheme for islanded microgrid based on adaptive state estimator,” IET
Generation, Transmission & Distribution, 2017.

[15] S. Tan, P. Xie et al., “Cyberattack detection for converter-based dis-
tributed dc microgrids: Observer-based approaches,” IEEE Industrial
Electronics Magazine, 2021.

[16] G. Hug and J. A. Giampapa, “Vulnerability assessment of ac state
to false data injection cyber-attacks,” IEEE

estimation with respect
Transactions on smart grid, 2012.

[17] M. N. Kurt et al., “Distributed quickest detection of cyber-attacks in
smart grid,” IEEE Trans. on Information Forensics and Security, 2018.
[18] L. Liu et al., “Detecting false data injection attacks on power grid by

sparse optimization,” IEEE Transactions on Smart Grid, 2014.

[19] A. O. Aluko et al., “Real-time cyber attack detection scheme for stand-

alone microgrids,” IEEE Internet of Things Journal, 2022.

[20] A. Cecilia et al., “On addressing the security and stability issues due
to false data injection attacks in dc microgrids—an adaptive observer
approach,” IEEE Transactions on Power Electronics, 2021.

[21] H. H. Alhelou et al., “Deterministic dynamic state estimation-based
optimal LFC for interconnected power systems using unknown input
observer,” IEEE Transactions on Smart Grid, 2019.

[22] M. R. Khalghani et al., “Resilient frequency control design for mi-
crogrids under false data injection,” IEEE Transactions on Industrial
Electronics, 2020.

[23] B. Satchidanandan and P. R. Kumar, “Dynamic watermarking: Active
defense of networked cyber–physical systems,” Proceedings of the IEEE,
vol. 105, no. 2, pp. 219–240, 2017.

[24] Y. Guan and M. Saif, “A novel approach to the design of unknown input

observers,” IEEE Transactions on Automatic Control, 1991.

[25] J. M. Rey et al., “Secondary switched control with no communications
for islanded microgrids,” IEEE Trans. on Industrial Electronics, 2017.
[26] N. Pogaku, M. Prodanovic, and T. C. Green, “Modeling, analysis and
testing of autonomous operation of an inverter-based microgrid,” IEEE
Transactions on Power Electronics, vol. 22, no. 2, pp. 613–625, 2007.

[27] PMU (PLL-based, Positive-Sequence) Benchmark, MathWorks.
[28] T. Huang, B. Satchidanandan, P. R. Kumar, and L. Xie, “An online
detection framework for cyber attacks on automatic generation control,”
IEEE Transactions on Power Systems, 2018.

[29] M. Ilic and X. Liu, “A simple structural approach to modeling and
analysis of the interarea dynamics of the large electric power systems:
Part i—linearized models of frequency dynamics,” in North American
Power Symposium, 1993, pp. 560–569.

[30] Q. Liu, “Large-scale systems framework for coordinated frequency
control of electric power systems,” Ph.D. dissertation, Carnegie Mellon
University, 2013.

[31] X. Miao, M. Ili´c, and Q. Liu, “Enhanced automatic generation control
(E-AGC) for electric power systems with large intermittent renewable
energy sources,” in 2019 IEEE PES General Meeting.

Fig. 11. Performance of the observer-based controller

Microgrid 1 to decrease. To recover the frequencies to 50
Hz, Microgrid 1 networks with Microgrid 2 via the tie line
at t = 0.7 sec. It can be seen from Figure 12 that the three
frequencies at Microgrid 1 are brought back to 50 Hz, and the
event of networking Microgrids 1 and 2 only causes negligible
frequency ripples at Microgrid 2.

(a)

(b)

Fig. 12. Performance of collaborative corrective control scheme: (a) frequen-
cies at microgrid 1 under cyber attack; and (b) frequencies at microgrid 2.

VI. CONCLUSION
In this paper, a cyber-resilient µAGC is proposed. A new
microgrid modeling approach is introduced. The modeling
approach exploits the rank-deﬁcient property of IBR dynamics.
Such modeling approach leads to a fast µAGC design that
requires no frequency measurements that may not be available
in practice under fast load/renewable power ﬂuctuations. An
end-to-end cyber security solution to FDI attack detection and
mitigation is developed for the proposed µAGC. The proposed
cyber-resilient µAGC is tested in a system of two microgrids.
Simulation shows the proposed µAGC can regulate microgrid
frequencies under fast renewable/load power ﬂuctuations, and
its cyber security solution can detect and mitigate FDI attacks.
Future work will investigate the impact of microgrid nonlin-
earity on the cyber-resilient µAGC design and test and validate
the proposed µAGC in a large-scale system of AC microgrids.

REFERENCES

[1] “Root cause analysis mid-August 2020 extreme heat wave,” California
Independent System Operator, California Public Utilities Commission,
California Energy Commission, Tech. Rep., 2021.

[2] “The February 2021 cold weather outages in texas and the south central

united states,” FERC, NERC, Tech. Rep., 2021.

[3] M. Farrokhabadi et al., “Microgrid stability deﬁnitions, analysis, and

[32] P. Van Overschee and B. De Moor, “N4sid: numerical algorithms for

examples,” IEEE Transactions on Power Systems, 2020.

state space subspace system identiﬁcation,” in IFAC, 1993.

[4] J. M. Guerrero et al., “Hierarchical control of droop-controlled ac
and dc microgrids—a general approach toward standardization,” IEEE
Transactions on industrial electronics, vol. 58, no. 1, pp. 158–172, 2010.

[33] D. Wu, P. Bharadwaj, P. Rowles, and M. Ilic, “Cyber-physical secure
observer-based corrective control under compromised sensor measure-
ments,” in American Control Conference, 2022.

0.511.549.9849.995050.0150.0250.03Node 1Node 2Node 30.511.549.9649.985050.0250.0450.06Node 1Node 2Node 30.511.549.99649.99749.99849.9995050.00150.00250.003Node 4Node 5