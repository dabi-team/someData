8
1
0
2

g
u
A
6

]

R
C
.
s
c
[

1
v
7
5
9
1
0
.
8
0
8
1
:
v
i
X
r
a

IEEETRANSACTIONSONEMERGINGTOPICSINCOMPUTING1KnowAbnormal,FindEvil:FrequentPatternMiningforRansomwareThreatHuntingandIntelligenceSajadHomayoun,AliDehghantanha,MarziehAhmadzadeh,SattarHashemi,RaoufKhayamiAbstract—Emergenceofcrypto-ransomwarehassigniﬁcantlychangedthecyberthreatlandscape.Acryptoransomwareremovesdatacustodianaccessbyencryptingvaluabledataonvictims’computersandrequestsaransompaymenttore-instantiatecustodianaccessbydecryptingdata.Timelydetec-tionofransomwareverymuchdependsonhowquicklyandaccuratelysystemlogscanbeminedtohuntabnormalitiesandstoptheevil.Inthispaperweﬁrstsetupanenvironmenttocollectactivitylogsof517Lockyransomwaresamples,535Cerberransomwaresamplesand572samplesofTeslaCryptransomware.WeutilizeSequentialPatternMiningtoﬁndMaximalSequentialPatterns(MSP)ofactivitieswithindifferentransomwarefamiliesascandidatefeaturesforclassiﬁcationusingJ48,RandomForest,BaggingandMLPalgorithms.Wecouldachieve99%accuracyindetectingransomwareinstancesfromgoodwaresamplesand96.5%accuracyindetectingfamilyofagivenransomwaresam-ple.Ourresultsindicateusefulnessandpracticalityofapplyingpatternminingtechniquesindetectionofgoodfeaturesforran-somwarehunting.Moreover,weshowedexistenceofdistinctivefrequentpatternswithindifferentransomwarefamilieswhichcanbeusedforidentiﬁcationofaransomwaresamplefamilyforbuildingintelligenceaboutthreatactorsandthreatproﬁleofagiventarget.IndexTerms—Malware,ransomware,cryptoransomware,ran-somwaredetection,ransomwarefamilydetection.I.INTRODUCTIONCYBERCRIMINALSposearealandpersistentthreattobusiness,governmentandﬁnancialinstitutionsallaroundtheglobe[1]–[3].Thevolume,scopeandcostofcybercrimeallremainonanupwardtrend[4].Maliciousprogramshavealwaysbeenanimportanttoolincybercriminalsportfolios[5],[6]andalmosteverydaywearedetectingnewvariantsofmalwareprograms[7].Developmentandwideadoptionofe-currenciessuchasBitcoinledtomanychangesincybercriminalactivities[8],[9]includingdevelopmentofanewtypeofmalwarecalledransomware[10].Ransomwareisatypeofmalwarethatremovesacustodianaccesstoherdataandrequestforaransompaymenttore-instantiatedataaccess[11].Ransomwarehasbeenaroundsince1989,whenransomwareﬁrstappearedunderthenameofAIDSTrojan[12].RansomwaresareutilizingdifferentinfectionvectorsS.Homayoun,M.AhmadzadehandRaoufKhayamiarewiththeDepart-mentofComputerEngineeringandInformationTechnology,ShirazUniversityofTechnology,Shiraz,Iran.e-mail:S.Homayoun@sutech.ac.ir.A.DehghantanhaiswithDepartmentofComputerScience,SchoolofComputing,ScienceandEngineering,UniversityofSalford,Salford,U.K.S.HashemiiswithDepartmentofComputerEngineering,ShirazUniversity,Shiraz,Iran.rangingfromsocialengineeringandSpamemailstobotnetsfordistribution.TherearetwomaintypesofransomwaresnamelyLockerandCryptoransomwares.Theformerlocksasystemanddeniesusers’accesswithoutmakinganychangestothedatastoredonthesystemwhilethelatterencryptsallorselecteddatausuallyusingastrongcryptographyalgorithmsuchasAESorRSA[12].Afterencryption,thevictimispresentedwiththeransompaymentinstructionswithpossibilityofrecoveringransomeddata.Ransomwarehasdominatedthethreatlandscapein2016withannualincreaserateof267%[13].Itisestimatedthatin2014only,cybercriminalshavemademorethan$3millionproﬁtusingransomwareprograms[14].Unsurprisingly,ran-somwareattacksaremostlyinfectingindividualswhoarenotsecurityaware.Takingregularbackupstoasecurelocationisagoodcountermeasuretoreduceeffectsofransomwareinfection[15].Thesedays,ransomwareprogramsareindis-criminatelytargetingallindustriesrangingfromhealthcaretothebankingsectorandevenpowergrids[4].TheCrypto-ransomwareprogramsaremuchmorepopularthanLockersasalmostalwayssecurityengineerscouldﬁndwaystounlockasystemwithoutpayingtheransomwhiletheonlyviablesolutionfordecryptingstronglyencrypteddataistopayransomandreceivedecryptionkey[16].Therefore,focusofthispaperisonlyoncrypto-ransomwareandintherestofthepaper,theword”ransomware”isactuallyreferringtothe”crypto-ransomware”only.Itwasalreadyreportedthatcybersecuritytrainingandemployeeawarenesswouldreducetheriskofransomwareattacks[17].However,automatedtoolsandtechniquesarerequiredtodetectransomwareapplicationsbeforetheyarelaunched[18]orwithinashortperiodaftertheirexecution[19].Thegrowingdangerofransomwareattacksrequiresnewsolutionsforprevention,detectionandremovingransomwaresprograms.Inthispaper,weareusingasequentialpatternminingtechniquetodetectbestfeaturesforclassiﬁcationofran-somwareapplicationsfrombenignappsaswellasidentifyingaransomwaresamplefamily.WeinvestigateusefulnessofourdetectedfeaturesbyapplyingtheminJ48,RandomForest,BaggingandMLPclassiﬁcationalgorithmsagainstadatasetcontains517Lockyransomwaresamples,535Cerberransomwaresamples,572samplesofTeslaCryptransomwareand220standaloneWindowsPortableandExecutable(PE32)benignapplications.Wenotonlyachieved99%accuracyindetectionofransomwaresamplesand96.5%indetectionof 
 
 
 
 
 
IEEETRANSACTIONSONEMERGINGTOPICSINCOMPUTING2theirfamiliesbutreducedthedetectiontimetolessthan10secondsoflaunchingaransomapplication;athirdofthetimereportedbyearlierstudiesi.e.[20].Ourresultsarenotonlyindicativeofusefulnessofpatternminingtechniquesinidentiﬁcationofbestfeaturesforhuntingransomwareapplica-tionsbutshowhowpatternsofdifferentransomwarefamiliescanhelpindetectingaransomwarefamilywhichassistinbuildingintelligenceaboutthreatsapplicabletoagiventarget.Tothebestofauthorsknowledgethisistheveryﬁrstpaperapplyingsequencepatternminingtodetectfrequentfeaturesofransomwareapplicationsandtobuildvectoreddatasetsofransomwareapplicationslogs.OurcreateddatasetscontainlogsofDynamicLinkLibraries(DLL)activities,ﬁlesystemactivitiesandregistryactivitiesof1624ransomwaresamplesfromthreedifferentfamiliesand220benignapplications.WeareusingwidelyacceptedcriterianamelyTruePositive(TP),FalsePositive(FP),TrueNegative(TN),andFalseNegativetoevaluateourmodel[21]–[23].TPisreﬂectingtotalsamplesthatcorrectlyidentiﬁed.FPshowsincorrectlyidentiﬁedsamples.TNdemonstratesthenumberofcorrectlyrejectedsamples,whileFNshowsincorrectlyrejectedsam-ples.PrecisionsofaclassiﬁcationalgorithmisameasureofrelevancyofresultsandiscalculatedbydividingTPbytotalofFPandTPpredictedbyaclassiﬁerasshowninequation(1).RecallreﬂectstheproportionofpositivesthatarecorrectlyidentiﬁedbyclassiﬁcationtechniquewhichiscalculatedbydividingTPbytotalofTPandFNasshowninequation(2).F-measureisshowingtheperformanceofaclassiﬁcationalgorithmandiscalculatedbytheharmonicmeanofprecisionandrecallasshowninequation(3).Precision=TPTP+FP(1)Recall=TPTP+FN(2)F−measure=2×Precision×RecallPrecision+Recall(3)WewillalsoreportReceiverOperatingCharacteristic(ROC)thatisapotentiallypowerfulmetricforcomparisonofdifferentclassiﬁers,becauseitisinvariantagainstskewnessofclassesinthedataset.InaROCcurvethetruepositiverateisplottedinfunctionofthefalsepositiveratefordifferentthresholds.InadditiontoROC,AreaUndertheCurve(AUC)isameasureofhowwellaparametercanbeusedtodistinguishbetweentwoclasses.AUCisasinglevaluethatsummarizestheROCbycalculatingtheareaoftheconvexshapebelowtheROCcurve.AUCcanbebetween0and1,wherethevalueof1showsoptimalpointofperfectprediction.MatthewsCorrelationCoefﬁcient(MCC)[24]providesan-othermeasuresofqualitytocomparedifferentclassiﬁers[25].TheMCCvalueisbetween−1and+1,whereincasesofperfectpredictionitgives+1.−1coefﬁcientshowstotaldisagreementbetweenpredictionandobservationwhilethecoefﬁcientvalueof0indicatesthattheclassiﬁerdoesnotworkbetterthanarandomprediction.MCCisalsoausefulmeasureofclassiﬁerperformanceagainstimbalanceddatasets.WhilePrecision,RecallorF-measurevaluesinarandomguessingwouldbehigherthan0.5,MCCvaluewouldbearound0forrandomguessing.Therefore,formakingsurethatourclassiﬁersarefarfromrandomclassiﬁers,wewillcomputeMCCvaluesforeachclassiﬁer.Thevaluescanbecomputedusingequation(4).MCC=TP×TN−FP×FNp(TP+FP)(TP+FN)(TN+FP)(TN+FN)(4)Theremainderofthispaperisorganizedasfollows.SectionIIreviewssomerelatedresearchwhileSectionIIIexplainsourmethodforcollectingandpreprocessingofdatainacontrolledenvironment.Wedescribefeatureextractionandvectoriza-tioninSectionIV.SectionVintroducesourapproachforransomwaredetectionfollowedbySectionVIthatdescribesourperformanceindetectingransomwaresfamilies.Finally,sectionVIIdiscussesabouttheachievementsofthispaperandconcludesthepaper.II.RELATEDWORKRansomwareprogramsarereportedlybecomingadominanttoolforcybercriminalsandagrowingthreattoourICTinfras-tructure[10],[26],[27].Thepossibilityofusingencryptiontechniquestoencryptusers’dataaspartofaDenialofService(DoS)attackisknownforaverylongtime[28].However,recentadoptionofeCurrenciessuchasBitCoinprovidedmanynewopportunitiesforattackersincludingreceivingaransompaymentfordecryptingusers’data[28].Inspiteofitssimplicityandprimitiveutilizationofcryptographictechniques[29],ransomwareprogramsarebecomingamajortoolincybercriminals’toolset[30].Foranycyberthreat,preventionisidealbutdetectionisamustandransomwareisnotanexception[7],[31].Situationalcybersecurityawarenessplaysanimportantroleinpreventingcyber-attacks[32].Aneducationalframeworkthatistailoredtoransomwarethreats[17]aswellasatoolwhichmimickedransomwareattacks[33]provedtobeusefulinreducingransomwareinfections.Moreover,technicalcountermeasuressuchverifyingapplicationstrustworthinesswhencallingacryptolibrary[34]orminimizingattacksurfacebylimitingend-users’privilegeprovedeffectiveinpreventiveransomwareattacks[16].Mostransomwaresdetectionsolutionsarerelyingonﬁlesys-tem[35]–[37]andregistryevents[38]toidentifymaliciousbehaviors.Investigationof1359ransomwaresamplesshowedthatmajorityofransomwaresamplesareusingsimilarAPIsandgeneratingsimilarlogsofﬁlesystemactivities[36].Forexample,using20typesofﬁlesystemandregistryeventsasfeaturesofaBayesianNetworkmodelagainst20Win-dowsransomwaresamplesresultedtoanaccurateransomwaredetectionwithF-Measureof0.93[38].UNVEIL[36]asarasnsomwareclassiﬁcationsystemutilizedﬁlesystemeventstodistinguish13,637ransomwaresfromadatasetof148,223malwaresampleswithaccuracyof96.3%.CloudRPS[39]wasacloud-basedransomwaredetectionsystemwhichreliedonabnormalbehaviorssuchasconversionoflargequantitiesofﬁlesinashortintervaltodetectransomwaresamples.EldeRan[20]utilizedassociationbetweendifferentoperatingsystemIEEETRANSACTIONSONEMERGINGTOPICSINCOMPUTING3eventstobuildamatrixofapplicationsactivitiesandtodetectransomwaresampleswithin30secondsoftheirexecutionwithAUCof0.995.Timelydetectionofaransomwareuponitsexecutionisverycrucialandsystemsthatfailtodetectran-somwareinlessthan10secondsarenotconsideredeffective[11].Moreover,timelyidentiﬁcationofaransomwarefamilywouldassistinbuildingintelligenceaboutapplicablethreatactorsandthreatproﬁleforagiventarget.III.DATACREATIONWehavedownloaded1624WindowsPortableExecutable(PE32)ransomwaresamplesfromvirustotal.comwhichwerereportedasmaliciousransomwareﬁlebyRansomware-Tracker.abuse.chintheperiodofFebruary2016toMarch2017.Collectedsamplesbelongtothreefamiliesofran-somwarenamely517Lockysamples,535Cerbersamplesand572samplesofTeslaCrypt.Thebesttypeofgoodwarecounterpartformalwareapplicationsareportableandstan-dalonebenignapps[32].Therefore,wehavecollectedall220availableportableWindowsPE32benignapplicationsfromportableapps.com1inApril2017toserveasgoodwarecounterpartofourdataset.WehavesetuptheenvironmentshowninFig.1tocollectlogsofransomwareandgoodwaresamplesruntimeactivities.TheControllerapplicationonthehostmachineisrandomlyselectingaransomwareorgoodwaresampleandpassesitthroughFTPservertotheVirtualMachine(VM).Whenthesampleissuccessfullytransferred,theControllernotiﬁestheLauncherapptoruntheProcessMonitorapplicationandexecutesagivensample.Similartothepreviousresearch[11],theﬁrst10secondslogofransomwareandbenignapplicationsruntimeactivitiesiscollectedandthecreatedlogﬁleisup-loadedtotheLogrepositoryonthehostmachine.Sincemajor-ityofbenignapplicationsrequirehumaninteractionstorun(i.eclickingonabutton),wehavedevelopedanapplicationcalledPyWinMonkeywhichautomatesuserinteractionswithanap-plication.Whenthelogﬁleissuccessfullystoredonthehostmachine,theControllerapplicationrevertstheVMbacktoitsoriginalcopyandpassesthenextsample.ItisnotablethatPyWinMonkeyissimilartoMonkey2Androidappwhichuti-lizedinmanypreviousAndroidmalwareresearchpapers[40]formimickinghumaninteractions.WehaveusedPython3.6.1todevelopController,LauncherandPyWinMonkeyapps(ac-cessibleathttps://github.com/sajadhomayoun/PyWinMonkey)andrunProcessMonitorV3.31onWindows10buildnumber10240onacomputerwithCorei7CPUwith8coresof4GHzand16GBofRAM.Foreachandeveryprocess,ProcessMonitorrecordsloadedDynamicLinkedLibraries(DLLs),ﬁlesystemactivitiesandregistryactivities.Wescannedallcapturedlogstoﬁnduniqueactivitiesthroughoutthedataset(seeTableI).Therefore,wewillhavethreesetsofeventsnamelyRegistryEventsSet,whichincludesallreg-istryevents,DLLEventsSet,whichincludesallDLLeventsandFileSystemEventsSet,whichcontainsallFilesystemeventsaslistedinTableI.Moreover,EventType(E)isa1https://portableapps.com/apps2https://developer.android.com/studio/test/monkey.htmlprocedurethatreturnsthetypeofgivenevent(RforRegistryevents,FforFilesystemevents,andDforDLLevents)asshowninFig.2.ControllerFTP ServerLauncherFTP ClientRansomware/Goodware SamplesLogs RepositoryProcess Monitor*.csvReverting SnapshotHost OS (Win10)Virtual Machine(Win 10)Fig.1.EnvironmentSetuptoCaptureMalwareandGoodwareActivitiesLogAswewillbeusingasequentialpatternminingtechnique(MG-FSM)todetectcandidatefeaturesforclassiﬁcationtask,weshouldconvertourdataintoasequentialdatasetwhichisacollectionofsequencessuchasD={S1,S2,...,Sn}whereSirepresentsasequentiallyorderedsetofevents.Wehavecreatedasequenceofruntimeeventsforeachandeveryransomwareandbenignapplication.SirepresentsasequenceofalleventsEcausedbylaunchinganapplicationiorderedbytimeasfollow:Si={E1,i(argE1),E2,i(argE2),...,E2,i(argEn)}whereEx,y(argEx)representseventxforanapplicationyandargExshowstheargumentpassedtotheeventEx.Forexample,{LoadImage(C:\system32\gdi32.dll)},{ReadFile(C:\Windows\SysWOW64\wininet.dll)}showsasequenceoftwoeventswheretheﬁrstevent1:procedureEVENTTYPE(EventE)2:ifE∈RegistryEventsSetreturnR3:ifE∈FilesystemEventsSetreturnF4:ifE∈DLLEventsSetreturnD5:endprocedureFig.2.DeterminingEvenTypeofagivenevent.IEEETRANSACTIONSONEMERGINGTOPICSINCOMPUTING4TABLEILISTOFACTIVITIESCANBECAPTUREDBYPROCESSMONITORActivityTypeListRegistryRegQueryKey,RegOpenKey,RegQueryValue,RegCloseKey,RegCreateKey,RegSetInfoKey,RegEnumKey,RegQueryKeySecurity,Re-gEnumValue,RegSetValue,RegDeleteValue,RegQueryMultipleValueKey,RegDeleteKey,RegLoadKey,RegFlushKeyFilesystemQueryNameInformationFile,ReadFile,CreateFile,QueryBasicInformationFile,CloseFile,QueryStandardInformationFile,CreateFileMapping,QuerySizeInformation-Volume,FileSystemControl,QueryDirectory,WriteFile,QueryNetworkOpenInformation-File,QueryRemoteProtocolInformation,QuerySecurityFile,LockFile,UnlockFileSin-gle,DeviceIoControl,SetEndOfFileInfor-mationFile,FlushBuffersFile,SetAllocation-InformationFile,SetBasicInformationFile,QueryAttributeTagFile,QueryFileInternalIn-formationFile,QueryInformationVolume,QueryAttributeInformationVolume,SetRenameInformationFile,QueryNormalized-NameInformationFile,NotifyChangeDirectory,QueryFullSizeInformationVolume,SetSecurityFile,QueryStreamInformationFile,SetDispositionInformationFile,QueryEaIn-formationFile,QueryAllInformationFile,QueryIdInformation,SetPositionInforma-tionFile,QueryPositionInformationFile,SetValidDataLengthInformationFileDLLLoadImageloadsgdi32.dllinthememoryofcallingprocess(henceC:\system32\gdi32.dllistheparameterforthisevent)andthesecondeventreadswininet.dllﬁlelocatedatC:\Windows\SysWOW64.Thesizeofeachsequencede-pendsonthenumberofeventsthatarecalledbyanapplicationandvariesbetweendifferentapps.Onceallsequencesarecreated,wehaveutilizedtheFindFrequentPatternOutlierFactor(FindFPOF)[41]algorithmtoremoveanyoutliersequencefromoursequentialdataset.ItisnotablethatFindPOFisamongveryfewsequentialdatasetoutlierdetectiontechniqueswhichoffersareasonabledetec-tionperformance[42].FindFPOFbeneﬁtsFrequentPatternOutlierFactor(FPOF)toextractallfrequentpatternsfromadatasetandremovesoutliersequencesasthosewiththeleastfrequentpatterns.Outliersweredetectedandremovedforeachransomwarefamilyseparatelyasitisexpectedthatransomwarefromthesamefamilyexposecommonfeaturesincomparewiththosefromdifferentfamilies.TableIIreﬂectsﬁnaldatasetswiththenumberofsequencesineachdataset.WeuseDxnotationtoreferdatasetxintherestofthispaper.DLockyrepresentssequencesofLockyransomwaresamples,DCerbershowsCerberransomwarese-quencesandDTeslaCryptincludessequencesofTeslaCryptransomwaresamples.DRansomwarerepresentscombinedse-quencesofallransomwaresampleswhileDGoodwareincludessequencesofeventsofallbenignapplications.Werandomlycollected52Locky,50Cerber,52TeslaCryptand20benignTABLEIICREATEDDATASETSDatasetNumberofSequencesDLocky450DCerber470DTeslaCrypt507DGoodware200DOF174applicationssequencesinaseparateddatasetforover-ﬁttingtestaswell(DOF).IV.FEATUREEXTRACTIONANDVECTORIZATIONTodetectthebestfeaturesforclassiﬁcationtask,weneedtoﬁrstdeﬁnedetectablepatternsofeventsandthenuti-lizeapatternminingalgorithmtoﬁndMaximalSequentialPatterns(MSP)collectionswithineachdataset.Afterwards,everysequencewithineveryrelevantdatasetistraversedbasedonagivenMSPcollectiontoprovidefeaturesfortrainingclassiﬁers.Sequentialpatternminingtechniquesdiscoverallsubse-quences(SequentialPatterns)thatappearinagivensequen-tialdatasetwithfrequencyofnolessthanauser-speciﬁedthreshold(minsup)[42].Asequenceα={a1,a2,...,an}iscalledasubsequenceofanothersequenceβ={b1,b2,...,bm}andβisasuper-sequenceofα,denotedasα⊆β,ifthereexistsintegers1≤j1<j2<...<jn≤msuchthata1⊆bj1,a2⊆bj2,...,an⊆bjn.AsequenceαissaidtobefrequentandcalledaSequentialPattern(SP)inasequentialdatasetDifsupα≥minsup,wheresupα(supportofα)denotesthefrequencyofoccurrenceofαinagivensequentialdatasetD.Moreover,ifaSequentialPatternSPisnotcontainedinanyothersequentialpatterns,itiscalledaMaximalSequentialPattern(MSP).CollectionofallMSPswithinagivensequentialdatasetDcanbedenotedasaMaximalSequentialPatternCollection(MCD).MembersofaMCareinformatof(P,supP)wherePisaMSPandsupPshowsthefrequencyofoccurrenceofPinagivendatasetD.TherearetwomajortypesofsequentialpatternminingalgorithmstoextractMSPsnamelyApriori-basedandfrequentpatterngrowth.Apriori-basedalgorithmsaredetectingMSPsbasedonthefactthatanysubsetofafrequentpatternmustbefrequent.However,recursivenatureofApriori-basedalgo-rithmsincreasescomplexityandrunningtimeofthealgorithm[43].Ontheotherside,frequentpatterngrowthalgorithmsareusingdivide-and-conquertechniquestonarrowdownthesearchspaceMSPs.Duetothelargenumberofelementsineachsequence(greaterthan5000elementsineachsequenceinthispaper),traditionalalgorithmse.g.GeneralizedSequentialPattern(GSP)[44]areinefﬁcient.Inotherwords,fewofthecommonlyusedsequentialpatternminingalgorithmsarecapableofproducingmaximalpatternsinareasonabletime[45].TodetectMSPsinthisstudy,weutilizeawidelyusedfrequentpatterngrowthalgorithm[46]called”MindtheGap:FrequentSequenceMining(MG-FSM)”[47].MG-FSMisaparallelprocessingsolutionbasedonMap-Reduce[48]whichIEEETRANSACTIONSONEMERGINGTOPICSINCOMPUTING5canbeeasilydeployedonacloudinfrastructuretoprovidedesiredscalability.LowthresholdvaluesforminimumsupportmaygenerateahugesetofMSPsthataffectsthecomputationalfeasibilityofourvectorizationmodel.Ontheotherhand,veryhighvaluesofminimumsupportmayremoveusefulMSPsindetectingransomwaresfromourdatasets.Therefore,wedecidedtochooseminsupof50%toachieveareasonableperformancewhilecoveringsufﬁcientnumberofMSPsinourdataset.ApplyingMG-FSMagainstourdatasetsgener-atesfourMSPcollectionsnamelyMCDLocky,MCDCerber,MCDTeslaCryptandMCDRansowmare.MCD={(Px,supPx)|supPx≥minsup∧∀Px(6∃Py(Px⊆Py))}.WecandistinguishthreetypesofatomicMSPsandsixtypesofsinglesteptransitionMSPswithinoursequentialdatasetsasshowninTableIII.AtomicMSPsarerepresentingcontinuouseventsofthesametypei.e.theatomicMSPofFrepresentscontinuousFilesystemevents.SinglesteptransitionsMSPsarerepresentingatransitionfromoneatomicMSPtoanother.Forexample,MSPof“RD”representsasequenceofregistryevents(RatomicMSP)followedbyasequenceofDLLevents(DatomicMSP).Sincewewillhaveonefeatureinourvectoreddatasetforeachtransition;incasesofconsideringmultisteptransitionswewillhavemorefeaturesforeachvector.Havingtoomanyfeaturesmakesadatasetsparseanddifﬁculttoﬁndaseparationhyperplane.Thisissueisreferredascurseofdimensionalityissue[44]whichstatesthatasthedimensionalityincreases,thevolumeofthespaceincreasessofastthattheavailabledatabecomesparse.Inthisresearch,wecancalculatetotalnumberoffeaturesineachvectorusingequation(5),where3isthenumberofconsideredactivities(F,R,D)andxisthedesiredstepsineachtransition.Considert=a,b,casa2stepsMSP,acanbeoneof3possibleactivities(F,R,D)andasaconstrainttomaketransitionwehaveb6=a(2possibleactivitiesforb)whileforthenexttransitionwemusthavec6=b(2possibleactivitiesforc).Therefore,wewillhave(3×2i)partofformulainequation5.Forx=3(singlestep,2stepsand3stepstransitions),wewillhavetotalof45features.Therefore,wedecidedtoonlyconsidersinglesteptransitionstoavoidsparsityinextractedfeatures.TotalFeatures=3+xXi=1(3×2i)(5)AMSPP={E1,...,En}isatomicif∀Ex,Ey∈P∧Ex6=Ey(EventType(Ex)=EventType(Ey)).AMSPP={E1,...,En}isasinglesteptransitionif∃Ex,Ey∈P∧Ex6=Ey(EventType(Ex)6=EventType(Ey)).WecandeﬁneasetthatcontainsallMSPtypes(MSPTypeSet)andaprocedure(MSPType(MSPP)inFig.3)thatreturnstypeofgivensequenceSasfollow:MSPTypeSet={R,F,D,RF,RD,FR,FD,DR,DF}.SupportRatio(SR)ofaMSPisavalueintherangeof[0,1]thatshowsthepossibilityofoccurrenceoftheMSPinagivendatasetofransomwareandiscalculatedbydividingfrequencyofoccurrencesofMSP(supMSP)bythetotalnumberofall1:procedureMSPTYPE(MSPP)2:forall(Ex,Ey∈P)∧(x≤i)∧(y>i)∧(i,y≤n)do3:ifEventType(Ex)==EventType(Ey)then4:ifEventType(Ex)==RreturnR5:ifEventType(Ex)==FreturnF6:ifEventType(Ex)==DreturnD7:else8:ifEventType(Ex)==R&EventType(Ey)==FreturnRF9:ifEventType(Ex)==R&EventType(Ey)==DreturnRD10:ifEventType(Ex)==F&EventType(Ey)==RreturnFR11:ifEventType(Ex)==F&EventType(Ey)==DreturnFD12:ifEventType(Ex)==D&EventType(Ey)==RreturnDR13:ifEventType(Ex)==D&EventType(Ey)==FreturnDF14:endif15:endfor16:endprocedureFig.3.FindingMSPTypeofagivenMSP.TABLEIIIMAXIMALSEQUENTIALPATTERNTYPESTypeDescriptionRAlleventsmustberegistryFAlleventsmustbeﬁleDAlleventsmustbeactionsondllﬁlesRFTheMSPhasoneormoretransitionswhiletheﬁrsttransitionisfromaregistryeventtoaﬁleeventRDTheMSPhasoneormoretransitionswhiletheﬁrsttransitionisfromaregistryeventtoadlleventFRTheMSPhasoneormoretransitionswhiletheﬁrsttransitionisfromaﬁleeventtoaregistryeventFDTheMSPhasoneormoretransitionswhiletheﬁrsttransitionisfromaﬁleeventtoadlleventDRTheMSPhasoneormoretransitionswhiletheﬁrsttransitionisfromadlleventtoaregistryeventDFTheMSPhasoneormoretransitionswhiletheﬁrsttransitionisfromadlleventtoaﬁleeventransomwaresequences(γ)inagivendatasetD.ForeverysequenceSwecandeﬁneaVectorofsizenine(9)thatcontainsSRvalueofeveryMSPtypedetectedinMSPCollectionMCwithinsequenceSasfollow:Vector(S)MC={(SRR),(SRF),(SRD),(SRRF),(SRRD),(SRFR),(SRFD),(SRDR),(SRDF)}SRvalueofeveryMSPTypeofasequenceforagivenMCcanbecalculatedusingCalculateSRprocedureshowninFig.4.WhenvectorofallsequenceswithinasequentialdatasetDusingaMSPCollectionMCiscreated,wewillhaveaIEEETRANSACTIONSONEMERGINGTOPICSINCOMPUTING61:procedureCALCULATESR(SequenceS,MSPCollectionMC,MSPTypeSetT)2:SRPTotal=03:forallP∈MCdo4:ifP⊆S&MSPType(P)==Tthen5:SRPTotal=SRPTotal+(supPγ)6:endif7:endfor8:returnSRPTotal9:endprocedureFig.4.SRcalculationalgorithmforsequenceS.VectoredDatasetVDD,MC.Moreover,foreverysequenceSwecandeﬁneaSuperVectorofSasasetofVectorscreatedusingMSPscollectedfromdifferentdataseti.e.MCD1,MCD2,...,MCDnasfollow:SuperVector(S)={Vector(S)MC1,Vector(S)MC2,...,Vector(S)MCn}whereMC1toMCnreﬂectsMSPCol-lectionsofdifferentdatasets.SizeofaSuperVectorwithnvectorsiscalculatedbyn×mwheremissizeofeachvector(9inthisresearch).BycalculatingSuperVectorforallsequenceswithinadatasetD,wewillhaveSuperVectoredDatasetSVDD.V.HUNTINGFOREVIL:RANSOMWAREDETECTIONTodetectbestfeatures(MSPtypes)forclassifyingran-somwarefrombenignapplicationswecreatedadatasetMCDTotalbycombiningDRansomwareandDGoodwareandthengeneratedavectoreddatasetVDDTotal,MCRansomware.WethenutilizedgreedystepwisesearchmethodofCfsSub-setEval[49]ofWeka3.8.1withVDDTotal,MCRansomwareandfoundthatMSPTypesofR(Registry),D(DLLs)andFD(FileandDLL)mayprovidebestdistinctionbetweenransomwareandgoodwaresamples(seeFig.5).AsshowninFig.5aransomwareapplicationsaretendtoconductamuchwiderrangeofRegistryactivitiesincomparewithgooodwareapps.AsshowninFig.5b,majorityofbenignapplicationswereconductingsimilarDLLactivitieswhilethereweremuchmorevariationsinransomwaresamplesDLLevents.RansomwareapplicationsaretakingavarietyofFilesystemtoDLLtran-sitionswhilegoodwaresamplesweremainlytakingonlytwospeciﬁcFilesystemtoDLLeventstransitions(seeFig.5c).WehaveutilizedR,D,andFDasfeaturestotrainfourclassiﬁersnamelyJ48,RandomForest,Bagging,andMultiLayerPerception(MLP)usingVDDTotal,MCRansomwareand10-foldcrossvalidationtechniqueforevaluation.AsshowninTableIV,allclassiﬁersachievedF-measureof0.99withalowfalsepositiverate(FPR≤0.04).Moreover,similaritiesbetweenROCcurvesofdifferentclassiﬁers(seeFig.6)provesthatthereisnotmuchdifferencebetweenperformanceofdifferentclassiﬁerswhichisanotherindicationofsuitabilityofourfeaturesforclassifyingransomwareandbenignapplica-tions.AsshowninFig.7,AUCvalueforallclassiﬁersisquitehigh(morethan0.990)whileAUCvalueofBaggingclassiﬁer(0.995)isveryclosetoanoptimalprediction.TheMCCvalueofallclassiﬁersismorethan0.96whileRandomForestand200400600800100012001400(a)SRRValue00.10.20.30.40.5ProbabilityGoodwareRansomware051015202530(b) SRDValue00.20.40.60.81Probability20406080100(c) SRFDValue00.10.20.30.40.5ProbabilityFig.5.HistogramoftheprobabilityofSRvaluesforransomwareandgoodware.TABLEIVCLASSIFIERSPERFORMANCEONVDDTotal,MCRansomwareClassiﬁerTPRFPRF-MeasureJ480.9940.0400.994RandomForest0.9930.0400.993Bagging0.9940.0390.977MLP0.9940.0350.994BaggingachievedMCCofalmost+1whichisveryclosetoaperfectprediction.Toshowthatwehavenotover-ﬁttedourclassiﬁers,wetestedallclassiﬁersusingonVDDOF,MCRansomware.AsshowninTableVallclassiﬁersachievedaccuracyof0.994IEEETRANSACTIONSONEMERGINGTOPICSINCOMPUTING700.10.20.30.40.50.60.70.80.9100.20.40.60.81True Positive RateFalse Positive RateJ48Random ForestMLPBaggingFig.6.ROCdiagramsforclassiﬁers.0.910.920.930.940.950.960.970.980.991J48RandomForestBaggingMLPAUC ValueFig.7.AUCofclassiﬁersfordetectingransomwares0.910.920.930.940.950.960.970.980.991J48RandomForestBaggingMLPMCC ValueFig.8.MCC[24]ofclassiﬁersfordetectingransomwaresTABLEVRESULTSOFCLASSIFIERSONVDDOF,MCRansomwareFORDETECTINGRANSOMWAREClassiﬁerAccuracyJ480.994RandomForest0.994Bagging0.994MLP0.994inclassifyingunforeseenransomwareandgoodwaresamplestoo.TABLEVITHECLASSIFIERSPERFORMANCEONSVDDTotalFamilyClassiﬁerTPRFPRF-MeasureMCCJ480.9810.0060.9810.974RandomForest0.9830.0060.9830.978Bagging0.9800.0070.9800.974MLP0.9800.0070.9800.973VI.THREATINTELLIGENCE:DETECTIONOFARANSOMWAREFAMILYToinvestigateperformanceofclassiﬁersindetectionofaransomwarefamilywehavecreatedDTotalFamilydatasetwhichcontainsallsequencesfromDLocky,DCerber,DTeslaCryptandDGoodware.WethengeneratedVDDTotalFamily,MCLocky,VDDTotalFamily,MCCerberandVDDTotalFamily,MCTeslaCryptvectoreddatasetsandfedthemtoCfsSubsetEvalofWeka3.8.1.Allinall13candidatefeaturesweredetectedforclassiﬁcationofransomwarefamiliesasshowninFig.9.Fig.9revealsthatatomicRegistryMSPs(activities)areofgreatimportancetodifferentiatebetweenransomwarefamilies.ScatteredvaluesofSRRfordifferentfamiliesinFig.9a,9band9cmakeSRRasadesirablefeatureforseparationofdifferentfamiliesofransomwares.FilesystemtoDLL(SRFD)isalsoausefulfeatureforidentifyingaransomwarefamilyasshowninFig.9a,9band9c.Fig.9aalsoshowsthatLockyransomwaresamplestendtohavemoreRegistryactivitiesbasedonVDDTotalFamily,MCLockywhileCerbersamplesperformedmoreDLLactivities(seeSRDinFig.9b)incomparewithotherstudiedfamilies.Moreover,LockysampleshadthemostnumberofRegistrytoFilesystemtransitions(basedonVDDTotalFamily,MCLockyandbasedonVDDTotalFamily,MCTeslaCryptinFig.9aandFig.9crespectively)andDLLtoFilesystem(SRDF)transi-tions(basedonVDDTotalFamily,MCLockyseeFig.9aand9b).Finally,FilesystemtoRegistrytransitions(SRFR)aremostcommonwithinCerbersamples(seeFig.9b).Asdetectionofransomwarefamiliesisamulti-classclassi-ﬁcationtaskwithfourclasslabels(Locky,Cerber,TeslaCryptandGoodware),therefore,wehavetrainedJ48,RandomForest,BaggingandMLPwithamulti-classclassiﬁerusingSVDDTotalFamilydatasetwith13selectedfeaturesinFig.9.TableVIpresentsperformanceofallclassiﬁersobtainedfrom10-foldcrossvalidation.Obtainedminimumweightedaverage[50]F-Measureof0.983withFPR≤0.006reﬂectssuitabilityofourfeaturesfordetectingransomwaresamplesfamilies.MCCvaluesofmorethan0.95forallclassiﬁersalsoindicatequalityofourfeaturesinenablingclassiﬁerstoprovideanalmostperfectprediction.Finally,asshowninTableVIIourfeaturesenabledclassiﬁerstoofferanaccurateprediction(≥0.965)evenonunforeseensamples(SVDDOF).VII.CONCLUDINGREMARKSInthispaper,bycombiningsequentialpatternminingforfeatureidentiﬁcationwithmachinelearningclassiﬁcationtech-niqueswecouldaccuratelydistinguishbetweenransomwareIEEETRANSACTIONSONEMERGINGTOPICSINCOMPUTING805001000SRRValue00.20.40.6Probability050100SRRFValue00.51Probability050100SRFDValue00.51Probability050100SRDFValue00.51Probability(a)FeaturesselectedfromVDDTotalFamily,MCLocky010002000SRRValue00.20.40.6ProbabilityLockyCerberTeslaCryptGoodware02040SRDValue00.51Probability0100200SRFRValue00.51Probability050100SRFDValue00.51Probability02040SRDFValue00.51Probability(b)FeaturesselectedfromVDDTotalFamily,MCCerber0100020003000SRRValue00.20.4Probability0200400600SRFValue00.10.20.3Probability050100150SRRFValue00.51Probability050100SRFDValue00.51Probability(c)FeaturesselectedfromVDDTotalFamily,MCTeslaCryptFig.9.HistogramoftheprobabilityofSRvaluesforransomwarefamilies.TABLEVIIRESULTSOFCLASSIFIERSONDATASETSVDDOFFORDETECTINGRANSOMWAREFAMILYClassiﬁerAccuracyJ480.947RandomForest0.965Bagging0.959MLP0.959andgoodwaresamplesandidentifygivenransomwarefam-ilieswithinﬁrst10secondsofaransomwareexecution.WeachievedminimumF-measureof0.994withminimumAUCvalueof0.99indetectionofransomwaresamplesfromgoodwareusingRegistry(R)events,DLL(D)eventsandFilesystemtoRegistry(FD)transitionsasfeaturesforJ48,RandomForest,BaggingandMLPclassiﬁers.WeachievedF-Measureofmorethan0.98withFPRoflessthan0.007indetectionofagivenransomwarefamilyusing13selectedfeaturesdetectedinthisstudy.Theoreticalimplicationofthisstudystemsfromapplicationofsequencepatternmin-ingtodetectfrequentfeaturesofransomwareapplicationstobuildvectoreddatasetsofransomwarelogs.Moreover,createddatasetof1624ransomwaresamplesand220benignapplicationscanbeusedbyfutureresearcherstofurtherourunderstandingofransomwarebehavior.PracticalimplicationsmayincludeutilizationofreportedfeaturesfordifferentiatingransomwareandbenignapplicationsforransomwarethreatIEEETRANSACTIONSONEMERGINGTOPICSINCOMPUTING9huntingwhilefeaturesreportedforransomwarefamilyclassi-ﬁcationaregreatforbuildingintelligenceaboutthreatproﬁlesapplicabletoagiventarget.Inrecenttimes,researchershaveproposedtheconceptofforensic-by-design[51]–[53],andanotherinterestingfutureresearchistoextendthisforensic-by-designtocapturingransomwaredetection,mitigationandroll-back.Applyingotherclassiﬁcationtechniquessuchasfuzzyclassiﬁcationcanbeconsideredasafutureworkofthisstudy.Moreover,utilizationofStreamDataMiningtechniquestoreduceransomwaredetectiontimeisanotherinterestingextensionofthisstudy.Finally,itisinterestingtoutilizeourtechniqueinotheremergingdomainssuchmobilemalwaredetectionandInternetofThings(IoT)forensics.ACKNOWLEDGMENTTheauthorswouldliketothankvirustotal.comforsharingmalwaresamplesandgivingthecapabilityofscanningﬁles.Wealsothankransomwaretracker.abuse.chfortheirupdatedandpreciousinformationaboutdifferentfamiliesofran-somwares.REFERENCES[1]M.HopkinsandA.Dehghantanha,“Exploitkits:Theproductionlineofthecybercrimeeconomy?”in2015SecondInternationalConferenceonInformationSecurityandCyberForensics(InfoSec).IEEE,nov2015.[Online].Available:https://doi.org/10.1109%2Finfosec.2015.7435501[2]K.-K.R.Choo,“Thecyberthreatlandscape:Challengesandfutureresearchdirections,”Computers&Security,vol.30,no.8,pp.719–731,nov2011.[Online].Available:https://doi.org/10.1016/j.cose.2011.08.004[3]——,“Cyberthreatlandscapefacedbyﬁnancialandinsuranceindustry,”http://www.aic.gov.au/publications/current%20series/tandi/401-420/tandi408.html,Feb2011,(Accessedon08/09/2017).[4]EUROPOL.(2016)Theinternetorganisedcrimethreatassessment(iocta)2016.[Online].Avail-able:https://www.europol.europa.eu/activities-services/main-reports/internet-organised-crime-threat-assessment-iocta-2016[5]J.WallsandK.-K.R.Choo,“Areviewoffreecloud-basedanti-malwareappsforandroid,”in2015IEEETrustcom/BigDataSE/ISPA.IEEE,aug2015.[Online].Available:https://doi.org/10.1109/trustcom.2015.482[6]J.WallsandK.-K.Choo,“Astudyoftheeffectivenessabsreliabilityofandroidfreeanti-mobilemalwareapps,”inMobileSecurityandPrivacy.Elsevier,2017,pp.167–203.[Online].Available:https://doi.org/10.1016/b978-0-12-804629-6.00008-0[7]N.Milosevic,A.Dehghantanha,andK.-K.R.Choo,“Machinelearningaidedandroidmalwareclassiﬁcation,”Computers&ElectricalEngineering,feb2017.[Online].Available:https://doi.org/10.1016%2Fj.compeleceng.2017.02.013[8]K.-K.R.Choo,“Newpaymentmethods:Areviewof2010–2012FATFmutualevaluationreports,”Computers&Security,vol.36,pp.12–26,jul2013.[Online].Available:https://doi.org/10.1016/j.cose.2013.01.009[9]——,“Cryptocurrencyandvirtualcurrency,”inHandbookofDigitalCurrency.Elsevier,2015,pp.283–307.[Online].Available:https://doi.org/10.1016/b978-0-12-802117-0.00015-1[10]K.CabajandW.Mazurczyk,“Usingsoftware-deﬁnednetworkingforransomwaremitigation:ThecaseofCryptoWall,”IEEENetwork,vol.30,no.6,pp.14–20,nov2016.[Online].Available:https://doi.org/10.1109/mnet.2016.1600110nm[11]A.Azmoodeh,A.Dehghantanha,M.Conti,andK.-K.R.Choo,“Detectingcrypto-ransomwareiniotnetworksbasedonenergyconsumptionfootprint,”JournalofAmbientIntelligenceandHumanizedComputing,Aug2017.[Online].Available:https://doi.org/10.1007/s12652-017-0558-5[12]H.L.KevinSavage,PeterCoogan,Theevolutionofransomware.Symantec,2015.[13]Symantec,“Internetsecuritythreatreport,”Symantec,Tech.Rep.21,apr2016.[14]K.Thomas,D.Huang,D.Wang,E.Bursztein,C.Grier,T.J.Holt,C.Kruegel,D.McCoy,S.Savage,andG.Vigna,“Framingdependenciesintroducedbyundergroundcommoditization,”inWorkshopontheEconomicsofInformationSecurity,2015,pp.1–24.[Online].Available:https://static.googleusercontent.com/media/research.google.com/en//pubs/archive/43798.pdf[15]“Symantecbackupsurvey,”https://www.symantec.com/content/de/de/about/downloads/PressCenter/SymantecBackupSurvey.pdf,2009,(Accessedon08/09/2017).[16]Monika,P.Zavarsky,andD.Lindskog,“Experimentalanalysisofransomwareonwindowsandandroidplatforms:Evolutionandcharacterization,”ProcediaComputerScience,vol.94,pp.465–472,2016.[Online].Available:https://doi.org/10.1016/j.procs.2016.08.072[17]X.LuoandQ.Liao,“Awarenesseducationasthekeytoransomwareprevention,”InformationSystemsSecurity,vol.16,no.4,pp.195–202,sep2007.[Online].Available:https://doi.org/10.1080%2F10658980701576412[18]M.Simmonds,“Howbusinessescannavigatethegrowingtideofransomwareattacks,”ComputerFraud&Security,vol.2017,no.3,pp.9–12,mar2017.[Online].Available:https://doi.org/10.1016/s1361-3723(17)30023-4[19]S.Grzonkowski,A.Mosquera,L.Aouad,andD.Morss,“Smartphonesecurity:Anoverviewofemergingthreats.”IEEEConsumerElectronicsMagazine,vol.3,no.4,pp.40–44,oct2014.[Online].Available:https://doi.org/10.1109/mce.2014.2340211[20]D.Sgandurra,L.Mu˜noz-Gonz´alez,R.Mohsen,andE.C.Lupu,“Automateddynamicanalysisofransomware:Beneﬁts,limitationsandusefordetection,”CoRR,vol.abs/1609.03020,2016.[Online].Available:http://arxiv.org/abs/1609.03020[21]M.Sohrabi,M.M.Javidi,andS.Hashemi,“Detectingintrusiontransactionsindatabasesystems:anovelapproach,”JournalofIntelligentInformationSystems,vol.42,no.3,pp.619–644,dec2013.[Online].Available:https://doi.org/10.1007%2Fs10844-013-0286-z[22]M.Sun,X.Li,J.C.S.Lui,R.T.B.Ma,andZ.Liang,“Monet:Auser-orientedbehavior-basedmalwarevariantsdetectionsystemforandroid,”IEEETransactionsonInformationForensicsandSecurity,vol.12,no.5,pp.1103–1112,may2017.[Online].Available:https://doi.org/10.1109%2Ftifs.2016.2646641[23]M.R.Watson,N.ul-hassanShirazi,A.K.Marnerides,A.Mauthe,andD.Hutchison,“Malwaredetectionincloudcomputinginfrastructures,”IEEETransactionsonDependableandSecureComputing,vol.13,no.2,pp.192–205,mar2016.[Online].Available:https://doi.org/10.1109%2Ftdsc.2015.2457918[24]B.Matthews,“Comparisonofthepredictedandobservedsecondarystructureoft4phagelysozyme,”BiochimicaetBiophysicaActa(BBA)-ProteinStructure,vol.405,no.2,pp.442–451,oct1975.[Online].Available:https://doi.org/10.1016%2F0005-2795%2875%2990109-9[25]D.M.Powers,“Evaluation:fromprecision,recallandf-measuretoroc,informedness,markednessandcorrelation,”JournalofMachineLearningTechnologies,vol.2,no.1,pp.37–63,2011.[Online].Available:https://dspace2.ﬂinders.edu.au/xmlui/bitstream/handle/2328/27165/Powers%20Evaluation.pdf?sequence=1[26]“Ransomwarebecomesmostpopularformofattackaspayoutsapproach$1bnayear,”NetworkSecurity,vol.2017,no.1,pp.1–2,jan2017.[Online].Available:https://doi.org/10.1016/s1353-4858(17)30001-6[27]“UKmajortargetforransomware,”ComputerFraud&Security,vol.2016,no.1,p.3,jan2016.[Online].Available:https://doi.org/10.1016/s1361-3723(16)30003-3[28]H.Orman,“Eviloffspring-ransomwareandcryptotechnology,”IEEEInternetComputing,vol.20,no.5,pp.89–94,sep2016.[Online].Available:https://doi.org/10.1109/mic.2016.90[29]C.Everett,“Ransomware:topayornottopay?”ComputerFraud&Security,vol.2016,no.4,pp.8–12,apr2016.[Online].Available:https://doi.org/10.1016/s1361-3723(16)30036-7[30]A.Gazet,“Comparativeanalysisofvariousransomwarevirii,”JournalinComputerVirology,vol.6,no.1,pp.77–90,jul2008.[Online].Available:https://doi.org/10.1007%2Fs11416-008-0092-2[31]R.Brewer,“Ransomwareattacks:detection,preventionandcure,”NetworkSecurity,vol.2016,no.9,pp.5–9,sep2016.[Online].Available:https://doi.org/10.1016/s1353-4858(16)30086-1[32]M.Damshenas,A.Dehghantanha,andR.Mahmoud,“Asurveyonmalwarepropagation,analysis,anddetection,”InternationalJournalofCyber-SecurityandDigitalForensics(IJCSDF),vol.2,no.4,pp.10–29,2013.[33]S.Al-Sharif,F.Iqbal,T.Baker,andA.Khattack,“White-hathackingframeworkforpromotingsecurityawareness,”in20168thIFIPInternationalConferenceonNewTechnologies,MobilityIEEETRANSACTIONSONEMERGINGTOPICSINCOMPUTING10andSecurity(NTMS).IEEE,nov2016.[Online].Available:https://doi.org/10.1109/ntms.2016.7792489[34]A.L.Young,“CryptoviralextortionusingmicrosoftcryptoAPI,”InternationalJournalofInformationSecurity,vol.5,no.2,pp.67–76,mar2006.[Online].Available:https://doi.org/10.1007%2Fs10207-006-0082-7[35]A.Kharraz,W.Robertson,D.Balzarotti,L.Bilge,andE.Kirda,“Cuttingthegordianknot:Alookunderthehoodofransomwareattacks,”inDetectionofIntrusionsandMalware,andVulnerabilityAssessment.SpringerNature,2015,pp.3–24.[Online].Available:https://doi.org/10.1007%2F978-3-319-20550-21[36]A.Kharaz,S.Arshad,C.Mulliner,W.Robertson,andE.Kirda,“Unveil:Alarge-scale,automatedapproachtodetectingransomware,”in25thUSENIXSecuritySymposium(USENIXSecurity16).Austin,TX:USENIXAssociation,2016,pp.757–772.[Online].Available:https://www.usenix.org/conference/usenixsecurity16/technical-sessions/presentation/kharaz[37]C.Moore,“Detectingransomwarewithhoneypottechniques,”in2016CybersecurityandCyberforensicsConference(CCC).InstituteofElectricalandElectronicsEngineers(IEEE),aug2016.[Online].Available:https://doi.org/10.1109%2Fccc.2016.14[38]M.M.AhmadianandH.R.Shahriari,“2entfox:Aframeworkforhighsurvivableransomwaresdetection,”in201613thInternationalIranianSocietyofCryptologyConferenceonInformationSecurityandCryptology(ISCISC).InstituteofElectricalandElectronicsEngineers(IEEE),sep2016.[Online].Available:https://doi.org/10.1109%2Fiscisc.2016.7736455[39]J.K.Lee,S.Y.Moon,andJ.H.Park,“CloudRPS:acloudanalysisbasedenhancedransomwarepreventionsystem,”TheJournalofSupercomputing,jul2016.[Online].Available:https://doi.org/10.1007/s11227-016-1825-5[40]M.Damshenas,A.Dehghantanha,K.-K.R.Choo,andR.Mahmud,“M0droid:Anandroidbehavioral-basedmalwaredetectionmodel,”JournalofInformationPrivacyandSecurity,vol.11,no.3,pp.141–157,jul2015.[Online].Available:https://doi.org/10.1080/15536548.2015.1073510[41]Z.He,X.Xu,Z.Huang,andS.Deng,“FP-outlier:Frequentpatternbasedoutlierdetection,”ComputerScienceandInformationSystems,vol.2,no.1,pp.103–118,2005.[Online].Available:https://doi.org/10.2298%2Fcsis0501103h[42]R.AgrawalandR.Srikant,“Miningsequentialpatterns,”inProceedingsoftheEleventhInternationalConferenceonDataEngineering,ser.ICDE’95.Washington,DC,USA:IEEEComputerSociety,1995,pp.3–14.[Online].Available:http://dl.acm.org/citation.cfm?id=645480.655281[43]W.Shen,J.Wang,andJ.Han,“Sequentialpatternmining,”inFrequentPatternMining.SpringerInternationalPublishing,2014,pp.261–282.[Online].Available:https://doi.org/10.1007/978-3-319-07821-211[44]P.-N.Tan,M.Steinbach,andV.Kumar,IntroductiontoDataMining.Pearson,2005.[45]P.Fournier-Viger,A.Gomariz,T.Gueniche,A.Soltani,C.-W.Wu,andV.S.Tseng,“Spmf:Ajavaopen-sourcepatternmininglibrary,”J.Mach.Learn.Res.,vol.15,no.1,pp.3389–3393,Jan.2014.[Online].Available:http://dl.acm.org/citation.cfm?id=2627435.2750353[46]K.Damevski,D.C.Shepherd,J.Schneider,andL.Pollock,“Miningsequencesofdeveloperinteractionsinvisualstudioforusagesmells,”IEEETransactionsonSoftwareEngineering,vol.43,no.4,pp.359–371,apr2017.[Online].Available:https://doi.org/10.1109%2Ftse.2016.2592905[47]I.Miliaraki,K.Berberich,R.Gemulla,andS.Zoupanos,“Mindthegap,”inProceedingsofthe2013internationalconferenceonManagementofdata-SIGMOD13.AssociationforComputingMachinery(ACM),2013.[Online].Available:https://doi.org/10.1145%2F2463676.2465285[48]Whatismapreduce?–ibmanalytics.https://www.ibm.com/analytics/us/en/technology/hadoop/mapreduce/.(Accessedon09/01/2017).[49]M.A.Hall,“Correlation-basedfeatureselectionformachinelearning,”Ph.D.dissertation,1999.[Online].Available:http://www.cs.waikato.ac.nz/∼mhall/thesis.pdf[50]M.SokolovaandG.Lapalme,“Asystematicanalysisofperformancemeasuresforclassiﬁcationtasks,”InformationProcessing&Management,vol.45,no.4,pp.427–437,jul2009.[Online].Available:https://doi.org/10.1016/j.ipm.2009.03.002[51]N.H.A.Rahman,N.D.W.Cahyani,andK.-K.R.Choo,“Cloudincidenthandlingandforensic-by-design:cloudstorageasacasestudy,”ConcurrencyandComputation:PracticeandExperience,vol.29,no.14,p.e3868,may2016.[Online].Available:https://doi.org/10.1002/cpe.3868[52]N.H.A.Rahman,W.B.Glisson,Y.Yang,andK.-K.R.Choo,“Forensic-by-designframeworkforcyber-physicalcloudsystems,”IEEECloudComputing,vol.3,no.1,pp.50–59,jan2016.[Online].Available:https://doi.org/10.1109/mcc.2016.5[53]G.Grispos,W.B.Glisson,andK.-K.R.Choo,“Medicalcyber-physicalsystemsdevelopment:Aforensics-drivenapproach,”inIEEE/ACMCon-ferenceonConnectedHealth:Applications,SystemsandEngineeringTechnologies.IEEE,jun2017,pp.108–114.SajadHomayounisaPh.DcandidateofComputerNetworksatShirazUniversityofTechnologysince2013.Healsohasamaster’sdegreeinInforma-tionTechnologyformK.N.ToosiUniversityofTechnology(KhajehNasireToosi)ofTehranandabachelor’sdegreeinComputerSoftware.Heiscurrentlyinchargeofsecuritylaboratory(SecLab)inShirazUniversityofTechnologysince2014.HisresearchinterestsareCyberSecurity,MachineLearningApplicationsinComputerSecurityandComputerNetworks.AliDehghantanhaisaMarie-CurieInternationalIncomingFellowinCyberForensics,afellowoftheUKHigherEducationAcademy(HEA)andanIEEESr.member.Hehasservedformanyyearsinavarietyofresearchandindustrialpositions.OtherthanPh.DinCyberSecurityheholdsseveralpro-fessionalcertiﬁcatessuchasGXPN,GREM,GCFA,CISM,andCISSP.Hismainresearchinterestsarecyberthreatintelligence,threathuntinganddigitalforensics.MarziehAhmadzadehholdsaPh.DinComputerScienceandMSc.InInformationTechnology,bothreceivedfromtheUniversityofNottingham,UK,andaﬁrstclassBScinSoftwareEngineeringre-ceivedfromIsfahanUniversity,Iran.SinceSeptem-ber2006,shehasbeenanassistantprofessorattheschoolofcomputerEngineeringandIT,ShirazUniversityofTechnology,whereshehassupervisedmorethan20MScstudentswhoseresearchareaaremostlyapplieddatamining.BeingaresearchassistantattheUniversityofNottinghamandfullstacksoftwareengineerfor3yearsisalsopartofherworkexperience.HerresearchinterestincludesDataMining,DataSecurity,HCIandComputerScienceEducation.SattarHashemireceivedthePhDdegreeincom-putersciencefromIranUniversityofScienceandTechnologyinconjunctionwithMonashUniver-sity,Australia,in2008.Followingacademicap-pointmentsatShirazUniversity,heiscurrentlyanassociateprofessoratElectricalandComputerEngineeringSchool,ShirazUniversity,Shiraz,Iran.Hisresearchinterestsincludemachinelearning,datamining,socialnetworks,datastreammining,gametheory,andadversariallearning.IEEETRANSACTIONSONEMERGINGTOPICSINCOMPUTING11RaoufKhayamireceivedhisBSdegreeincomputerengineering(hardwaresystems)fromShirazUniver-sityin1993,theMSdegreeinartiﬁcialintelligenceandroboticsfromthesameuniversityin1996,andthePh.DdegreeinsoftwaresystemsfromShirazUniversityin2009.HeiscurrentlyanassistantprofessorintheComputerEngineeringandInfor-mationTechnologyDepartment,ShirazUniversityofTechnology,Shiraz,Iran,andthere,heistheHeadoftheDepartment.Hisresearchinterestsincludedatamining,businessintelligence,andenterprisearchitecture,onwhichhehaspublishedanumberofrefereedarticles,surveysandtechnicalreportsinprestigiousnationalandinternationalconferencesandjournals.Healsoisactiveinconsultingandindustrialprojects.