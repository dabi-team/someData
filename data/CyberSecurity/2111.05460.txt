CROSS-LAYERED DISTRIBUTED DATA-DRIVEN FRAMEWORK
FOR ENHANCED SMART GRID CYBER-PHYSICAL SECURITY ∗

1
2
0
2

v
o
N
0
1

]

G
L
.
s
c
[

1
v
0
6
4
5
0
.
1
1
1
2
:
v
i
X
r
a

Allen Starke, Keerthiraj Nagaraj, Cody Ruben, Nader Aljohani, Sheng Zou,
Arturo Bretas, Janise McNair, Alina Zare
Electrical and Computer Engineering
University of Florida
1064 Center Dr, Gainesville, Fl. 32611, U.S.
{email}allen1.starke@ufl.edu; k.nagaraj@ufl.edu; cruben31@ufl.edu;
nzjohani@taibahu.edu.sa; shengzou@ufl.edu; arturo@ece.ufl.edu;
mcnair@ece.ufl.edu; azare@ece.ufl.edu

ABSTRACT

Smart Grid (SG) research and development has drawn much attention from academia, industry and
government due to the great impact it will have on society, economics and the environment. Securing
the SG is a considerably signiﬁcant challenge due the increased dependency on communication
networks to assist in physical process control, exposing them to various cyber-threats. In addition
to attacks that change measurement values using False Data Injection (FDI) techniques, attacks on
the communication network may disrupt the power system’s real-time operation by intercepting
messages, or by ﬂooding the communication channels with unnecessary data. Addressing these
attacks requires a cross-layer approach. In this paper a cross-layered strategy is presented, called
Cross-Layer Ensemble CorrDet with Adaptive Statistics(CECD-AS), which integrates the detection
of faulty SG measurement data as well as inconsistent network inter-arrival times and transmission
delays for more reliable and accurate anomaly detection and attack interpretation. Numerical results
show that CECD-AS can detect multiple False Data Injections, Denial of Service (DoS) and Man In
The Middle (MITM) attacks with a high F1-score compared to current approaches that only use SG
measurement data for detection such as the traditional physics-based State Estimation, Ensemble
CorrDet with Adaptive Statistics strategy and other machine learning classiﬁcation-based detection
schemes.

Keywords cyber security, network security, network reliability, real-time systems, cyber-physical systems, cross-
layered, power systems, machine learning

Nomenclature

Communication Network

β

(cid:15)t
λ

µ

φ

ψ

σ

Parameter used for measuring degree of LRD in autocorrelation functions
White noise distribution of Xt
Packet arrival rate into system

Packet service rate at each system

Scaling function in autoregressive integrated moving average

Mother wavelet function in autoregressive integrated moving average

The scale parameter in the generalized pareto distribution

∗This paper is a preprint of a paper submitted to IET Smart Grid. If accepted, the copy of record will be available at the IET

Digital Library.

 
 
 
 
 
 
Cross-Layered Framework

σt, σ2
ξ

t Standard deviation and variance of Xt

The shape parameter in the generalized pareto distribution

Gξ,σ(µ(x) Standard cumulative distribution function of generalized pareto distribution
H
Hurst parameter used to measure the degree of long-range dependence
IAT
Inter-arrival times
Slowly varying function where limx→∞
L(•)

L(tx)
L(x) = 1 for all t > 0

Weight parameter
Window size for threshold update
Squared Mahalanobis distance of sample z with respect to the distribution of normal samples on φm
Magnitude parameter for threshold estimation

Total number of packets
Use of the queueing system (i.e. trafﬁc intensity)
packet count (i.e. trafﬁc volume)
Transmission delay
Total waiting time or transmission delays

n
putil
P C
T D
W
Xt, Xi A series of datapoints ordered by time
Machine Learning
α
β
δECD
m
η
δZ,m Squared Mahalanobis distance of all training samples with respect to φm
δzˆk
ˆY
ˆZ
µ
µm
Σ
Σm
Y
Z
z

Testing set
Mean of normal samples
Mean of normal samples on φm
Covariance of normal samples
Covariance of normal samples on φm
Label for training set
Training set
Triplet, the complete set of triple elements [zSG, zIAT , zT D]
Triplet element, [z(c)
IAT , z(c)
T D]
Selected triplet element, a set of triple elements with respect to φm

label for testing set

SG, z(c)

Squared Mahalanobis distance of of k-th testing sample with respect to ΦE

Vector of all measurement values
Vector of all time delay values

z(c)
zm
zIAT Vector of all inter-arrival time values
zSG
zT D
µthr,m Mean of the Mahalanobis distance values of zm of all normal samples in training data
ΦE
φm
ΦR
σthr,m Covariance of the Mahalanobis distance values of zm of all normal samples in training data
τ
τm
d
M
T

Threshold value to classify abnormal samples on ΦR
Threshold value to classify abnormal samples on φm
Number of measurement or inter-arrival time or time delay values
Number of buses/local Cross-layer CorrDet detector
Set of τm

Symbol for Cross-layer Ensemble CorrDet detector
Symbol for m-th local Cross-layer CorrDet detector
Symbol for CorrDet detector

2

Cross-Layered Framework

Current Measurement Estimation
Measurement Standard Deviation

State Estimation
χ2
Chi-Squared Threshold
eD
Detectable Error Vector
eU
Undetectable Error Vector
e
Measurement Error Vector
r
Residual of Measurements Vector
x∗
Current State Estimation
x
State Vector
zSG Measurement Vector
z∗
SG
σ
CM E Composed Measurement Error
d
H
h
II
J
N
P
p
R

Number of Measurements
Jacobian Matrix of h
Function of Measurements in terms of States
Measurement Innovation Index
WLS-SE objective function
Number of States
WLS-SE Projection Matrix
Chi-Squared Probability
Covariance Matrix of Measurements

1

Introduction

The future power grid, or Smart Grid (SG), has drawn much attention from academia, industry and government due to
the signiﬁcant impact it will have on society, economics and the environment. Next generation SG systems integrate
control, communication and computation to achieve stability, efﬁciency and robustness of physical control processes.
Network communication introduces several drawbacks and opportunities. First, it introduces an exposure to cyber-
threats [1]. Recently, the ﬁrst conﬁrmed cyber-attack-initiated blackout occurred in Ukraine and caused a power
outage that affected 225,000 customers [2, 3]. Similar malware was found in several systems that operate in the US
power grid [4, 3]. In addition to being a subject of National Security, blackouts have huge economic impact. For
instance, the estimated cost of the 2003 Northwest blackout ranges from 4 to 10 billion U.S. dollars in the United
States, and 2.3 billion Canadian dollars in Ontario [5]. This realization reinforced the critical need for research on
cyber-related power grid vulnerabilities [6, 7]. Recent research literature addresses physical control process reliability,
but research on cyber-physical security of SGs is still developing. On the other hand, communication networks provide
an opportunity for cross-layer awareness. Typically, the classical power grid is protected by isolated and uncoordinated
devices that provide ad-hoc solutions for each protection problem. The lack of cooperation between these tools leaves
them vulnerable to distributed attacks. Consider power systems stabilizers (PSS), which are located at synchronous
generators to provide protection from small disturbances. If either a cyber-attack or other disturbance occurs at any
stage of the data collection process, the PSS can potentially malfunction, compromising SG stability. A cross-layer
approach can provide situational awareness, generate a more accurate response and increase system reliability and
resiliency through network redundancy. Just as Stuxnet exploited a vulnerability in a set of programmable logic
controllers (PLCs) that controlled centrifuges for nuclear fuel processing [8], similar vulnerabilities could be exploited
in PLCs that control automatic systems in grid-connected equipment.

Current research on the cyber-security of the power grid focuses on a process called state estimation (SE) [9, 10,
11, 12, 13]. SE uses real-time measurements and static data about the system topology to (1) estimate the state of
the system and (2) perform various monitoring applications [14]. One of the main applications performed is Bad
Data Analysis, which uses statistical tests to determine if any of the measurements on the system have an error.
Errors in measurements can come from a variety of sources like faulty meters or cyber-attacks. A cyber-attack on
the measurements themselves is called a False Data Injection (FDI) and is the most common form of cyber-attack
considered in the literature. Current solutions for detecting FDI attacks tend to focus on modelling the behavior of the

3

Cross-Layered Framework

attack, then use load forecasting by training various machine learning methods to detect relatively small changes in load
distribution or in the state variables of the power grid [15, 16, 17]. While forecasting has been a very effective method
to detect false data injection within the power grid, these methods do not consider multiple hackers injecting false data
to conduct a coordinated attack. In addition, these solutions do not address detecting other forms of cyber attacks that
can negatively impact the performance of the power grid. The work in [18] and [19] focuses on developing real-time
solutions for detecting and defending against denial-of-service (DoS) attacks. In [18], a dynamic differential system
is used that models the changing states of a metering infrastructure during DoS attacks and in [19] an online storage
facility is proposed for access to faster and scalable data analysis.In [20, 21, 22] solutions are proposed to protect
against negative impacts on power grid state estimation due to delays in the transmission of state measurements and
control signals.The work in [23] demonstrates that the lack of strong integrity and authentication checks in a power
grid’s network communication protocols can allow hackers easy access to the system and may cause detrimental effects
to performance.

While there are a wide range of cyber attacks that can negatively impact the power grid, recent research has focused
mainly on detecting and mitigating a single attack , i.e., have assumed that only one type of attack occurs at a given
time. In a more realistic scenario cyber attacks involve multiple entities exploiting various security ﬂaws in the physical
and cyber domains of the cyber-physical system. To the best of our knowledge, the impact of a coordinated attack
consisting of different types, such as DoS, FDI, and Man in The Middle (MITM) has not been addressed. Furthermore,
the challenge of leveraging the interdependence between different layers of the SG, i.e., physical domain and cyber
domain, to achieve more robust securityin the system has not been sufﬁciently addressed. Therefore, this paper
proposes a method of detecting multiple attacks and different types of attacks, initiated from different layers within
the SG. This is accomplished through our proposed, novel cross-layer perspective. As shown in Fig. 1, the SG cyber-
physical system is composed of a physical domain, where measurements are taken and communicated through a
communication network, and a cyber domain, where all of the data collected and communicated is analyzed. The
cyber domain is where the SE process occurs. In a previous work [24, 25], the authors have shown that Machine
Learning (ML) can be used in the cyber domain, operating on the same data as the SE, to improve bad data analysis.
This hybrid data-driven physics-model based framework takes advantage of both temporal data through ML and the
known topology of the system through SE. Yet, this technique, like the other current research, still only addresses
FDI attacks and only uses standard measurements taken on power systems. Thus, it does not consider the cross-layer
interdependencies of the SG. In another previous work [26], the Ensemble CorrDet with Adaptive Statistics (ECD-AS)
strategy was developed by the authors to analyze measurement data and packet contents. ECD-AS is also a data driven
method for the detection of FDI attacks and considers the changing state of the SG. The limitation of this method is it
only uses measurement data, limiting its ability to detect cyber-attacks focused on the communication network layer
of the SG. However, the work in this paper will leverage the analysis layer, which can also consider data related to the
communication network that drives the SG, speciﬁcally, the packet inter-arrival times, transmission delay, and packet
count. Considering this type of data will expand the model of an FDI attack in the cyber domain as well as reveal
models of different types of cyber-attacks that would go undetected by current approaches in the literature.

In this paper, we present a SG cyber-physical security framework based on a cross-layer perspective that focuses on
detection of various cyber attacks called the Cross-Layer Ensemble CorrDet with Adaptive Statistics (CECD-AS).
Differently from previous approaches that propose SGs cyber-physical security, we consider the SG and the commu-
nication network as one and propose security solutions for the entire system. In such a system, the characteristics
and security speciﬁcations of each layer should be considered in a cross-layer model to provide speciﬁc integrated
countermeasures. Current state of the art approaches focus only on data from the SG like power and voltage measure-
ments. Analyzing data related to the communication network provides further information that can and should be used
to better detect not only FDI attacks, but a variety of other potential cyber-attacks that may not affect measurement
values at all.

The contributions of this work to the state of the art are as follows:

• Using a cross-layer perspective between the power grid and communication network to enhance the detection

of cyber attacks on the Smart Grid.

• Expanding on the ECD-AS method of anomaly detection on the Smart Grid to include information from the

communication network.

• The consideration of various types of cyber attacks, beyond just FDI attacks, that can only be detected by

using a cross-layer perspective.

• Mathematically modelling the impact of various cyber attacks on the power grid and the communication

network simultaneously.

4

Cross-Layered Framework

Figure 1: Cross-layer Cyber-Physical Security Architecture

The remainder of the paper is organized as follows. In Section 2, background information on the various aspects of
the cross-layer perspective is presented. The details of the CECD-AS algorithm are shown in Section 3. The results of
numerical tests used to evaluate the performance of this method are shown and discussed in Section 4. Finally, Section
5 presents the conclusions of this work.

2 Background Information

2.1 Smart Grid System Communication Architecture

Traditionally, SG communications consisted of very low rate exchange of serial data point-to-point between deter-
ministic nodes. With the creation of Phaser Measurement Units (PMUs) and dynamic networking infrastructures,
SG systems’ network trafﬁc is increasingly coming from heterogeneous network structures experiencing different
types of events, requiring more complex networking and control protocols. Managing these evolving networks using
traditional network management schemes can increase the cost of network operation and maintenance and leave sig-
niﬁcant vulnerabilities in fault tolerance and security. Software Deﬁned Networking (SDN) is a networking paradigm
in which the forwarding hardware is decoupled from control decisions. The network intelligence is logically central-
ized in software-based controllers (the control plane), and network devices become simple packet forwarding devices
(the data plane) that can be programmed via an open interface. SDNs help to assemble new services and infrastruc-
ture quickly to meet dynamically changing environment objectives. Furthermore, the software implementation of the
control plane and the built-in data collection mechanisms are excellent tools to implement Machine Learning (ML)
network control applications [27]. Extracting knowledge from data collection to understand and predict the state of
the SG network will be crucial to implement security management in the SG. Two signiﬁcant challenges are proposed
to be addressed: real-time SDN machine learning systems, and real-time SG communications management through a
distributed SDN architecture. As outlined in Fig. 1, the ML takes in the signal information from the physical layer
as well as the network trafﬁc information from the management layer and monitors the data for anomalies and signal
corruption. The ML can leverage interactions between the subsystems on the physical layer and integrated operation
with the Distributed Software Deﬁned Networking (D-SDN) controllers at the management layer.

Traditional supervised ML methods, in general, assume that every possible class and distribution of possible samples
for each of these classes are appropriately characterized by training data. Yet, in implementation, it is infeasible to
assume that all possible behaviors can be identiﬁed and characterized in training data prior to implementation of a
system – malicious attacks and their associated behaviors on the communication grid can and will be re-imagined and
re-implemented. Thus, a system is needed that can adapt to changes in communication behavior based on cross-layer
information and can robustly detect and classify anomalous communication packets in real time. In the literature, ML
methods haven’t been used within a cross-layer security framework to monitor for malicious behavior.

5

Cross-Layered Framework

2.2 Network Performance Statistics

The cross-layered analysis framework is based on the IEEE 118-bus system emulating the commonly used Modbus
RTU over TCP/IP protocol for traditional SG environments. This system follows the poisson trafﬁc model, since
transmission of packets occur in batches every 4 seconds [28]. Each bus is modelled after the M/M/c queue [29], i.e.,
c≥1, where the arrival of packets follow a poisson process and the service time of the queue follows an exponential
distribution. The utiliziation (i.e. trafﬁc intensity) of the systems is represented as

where λ refers to the arrival rate of packets to the system, and µ refers to the service time of packets in the system.
The inter-arrival time (IAT) is the time between packet arrivals and is one of the network performance metrics used in
our analysis, which has an exponential distribution with parameter λ. For t ≥ 0, the probability density function is

putil =

λ
µ

(1)

Hence, the average IAT is deﬁned as

f (t) = λe−λt

IAT =

1
λ

The service time s has an exponential distribution with parameter µ, and the probability density function is
g(s) = µe−µs,

∀s ≥ 0

(2)

(3)

(4)

where 1
deﬁne as the transmission delays (TD), can be measured as

µ is the average service time of the system. Using Little’s theorem, the total waiting time, in our case what we

Lastly, the so called ”normal” distribution of network packet arrivals (i.e. non-attacked packets) into each system are
determined by the probability of seeing a number of packet arrivals in a period from [0,T] .

W = T D =

1
µ − λ

(5)

P (n arrivals in interval T ) =

(λT )ne−λT
n!

(6)

where T is the interval of time, and n represents the number of packet. This is used to model trafﬁc volume of the bus,
and the packet count (PC) metric is deﬁned as

P C = λT

(7)

2.3 Cyber Attacks

In this section, we provide an overview of the different possible types of cyber attacks based on the studies in [30, 31],
apply them to Supervisory Control and Data Acquisition (SCADA) networking systems for powergrid, and discuss
their impact on network connectivity, topology and network trafﬁc.

• False Data Injections (FDI): this type of cyber attack injects forged measurement into the control system in

hope of misguiding the control algorithm.
Impact: the impact factor of FDI attacks is high and can be seen on the physical and networking level of the
victim system. The work [32] proves that FDI attacks can increase the delay overtime of network packet
transmissions. Such effects coupled with changes to power control have the potential of shutting down power
grids causing blackouts for an entire region.

• Flooding Denial of Service (DoS): in denial of service, the attacker intentionally disrupts the transmission of
data to/from a given node through an excessive amount of service requests to the victim node, consuming all
available resources.
Impact: the impact factor of DoS attacks are high. This type of attack increases network trafﬁc at its victim
node (i.e. arrival rate) to consume the victim resources and extend queue length resulting in an increase in
wait times or transmission delays as can be seen in [33]. This can cause nodes to shutdown, and impact the
entire network as a whole. Distributed Denial of Service (DDoS) has a larger impact, since the attack occurs
from multiple nodes resulting in a higher arrival/attack rate.

6

Cross-Layered Framework

Figure 2: Victim representation of a cyber attack

• Man-in-the-Middle (MITM): an attack in which a third party gains access to the communications between
two other parties, without either of those parties realising it. The third party might read the contents of
the communication, or in some cases also manipulate it. The attacker node advertises false information
using Address Resolution Protocol (ARP) messages, or by hijacking the router each of the victim nodes are
connected to. MITM attacks are seen as the grandfather to all other cyber attacks since this is typically the
ﬁrst step that must be achieved before executing other attacks.
Impact: the impact factor of MITM attacks is typically low or non-existent. Based on the type of MITM
attack a ﬂux of packets could increase the network trafﬁc with no serious impact on network performance.
MITM attacks have the most potential out of all the attacks listed, since they are the hardest to detect and can
evolve into a dangerous attack such as DoS or FDI.

2.4 Cyber Attack Statistical Properties and Models

A cyber attack is an attempt by hackers to damage or destroy a computer network or system. In general, the cyber
attacks discussed in the previous section demonstrate a similar characteristic of increasing the arrival rate of the
network trafﬁc at the victim or destination nodes, as demonstrated in Fig. 2. During speciﬁc cyber attacks (e.g.
DoS, FDI) the arrival rate, λ1, is a combination of normal and attack trafﬁc (e.g. for DoS attacks λ1 is increased
by ﬂooded trafﬁc from a hacker intending to crash the victim, where FDI attacks increase λ1 slightly to inject bad
data). The impact of this increase of the arrival rate at the victim node (i.e. increase in λ1) is cascaded through the
rest of the system, decreasing the service rate, µ1, of the victim node and arrival rate, λ2, of the destination node.
For MITM attacks the hacker inﬁltrates the connection between the victim node and the destination node, increasing
the destination node’s arrival rate, λ2, in an attempt to disguise themselves as the source node. Cyber attacks can be
naturally modeled as stochastic processes [34]. The models are based on the attack rate (i.e. number of attacks that
arrive per a unit of time), and can be represented on three levels of the networking system including network-level,
victim-level, and port-level attack processes as stated in [34]. FDI, DoS, and MITM attacks are executed on a victim-
level attack process, which are attacks on individual victim computers or IP addresses. The authors of [34] proved
that 80% and 70% of cyber attacks on the network and victim level respectively don’t function as Poisson processes
and instead exhibit long-range dependence (LRD) with extreme values. LRD refers to the rate of decay of statistical
dependence of two points with increasing time interval or spatial distance between the points. A phenomenon is
usually considered to exhibit LRD if the dependence in its autocorrelation function (ACF) decays more slowly than an
exponential decay.

p(h) = Cor(Xi, Xi+h) ∼ h−βL(h), h → ∞

(8)

L(tx)
where 0 < β < 1 and L(•) is a slowly varying function meaning that limx→∞
L(x) = 1 for all t > 0 [35]. β is
related to the Hurst parameter (H) as β = 2 − 2H. H is used to measure the degree of LRD, where 1/2 < H < 1 and
the degree of LRD increases as H → 1 [34]. The distribution of extreme values for stationary time series follows the
generalized pareto distribution (GPD) with survival function

7

Gξ,σ(µ)(x) = 1 − Gξ,σ(µ) =

(cid:40)

σ )− 1

ξ

(1 + ξ x
e

−x
σ

Cross-Layered Framework

ξ (cid:54)= 0,
ξ = 0.

(9)

where ξ and σ are called shape and scale parameter respectively.

A combination of an (LRD)-aware model of auto regressive fractionally integrated moving average (ARFIMA or
FARIMA) and extreme-value-aware model such as the integrated generalized autoregressive conditional heteroskedas-
ticity (IGARCH) is used for modelling and predicting cyber attacks [36]. FARIMA models are time series models
that generalize ARIMA (autoregressive integrated moving average) models by allowing non-integer values of the dif-
ferencing parameter. This is the well-known model where H = d + 1/2 and 0 < d < 1/2 . A stationary process Xt is
FARIMA (p,d,q) if

for some -1/2 < d < 1/2, where

and

φ(B)(1 − B)dXt = ψ(B)(cid:15)t

φ(x) = 1 −

ψ(x) = 1 +

p
(cid:88)

j=1

q
(cid:88)

j=1

φjxj

ψjxj

(10)

(11)

(12)

B is the back shift operator deﬁned by BXt = Xt−1, B2Xt = Xt−2, etc. [34]. GARCH is a model for identifying
stochastic processes with a conditional variance of the process. A time series is a GARCH process if Xt = σt(cid:15)t and
the integrated GARCH model is as follows

t = w + (1 − ψ(B))((cid:15)2
where (cid:15)t is the white noise distribution, σt is the standard deviation, and σ2

φ(B)(1 − B)(cid:15)2

t − σ2
t )
t is the variance [36].

(13)

2.5 Physics-Based State Estimation

In modern Energy Management Systems (EMS), the State Estimation (SE) process is the core process for situational
awareness of a power system and is used in many EMS applications, including the detection of bad data. The common
approach to SE is using the classical Weighted Least Squares (WLS) method described in [14]. In this approach, the
system is modeled as a set of non-linear equations based on the physics of the system:

zSG = h(x) + e
(14)
where zSG ∈ R1×d is the measurement vector, x ∈ R1×N is the vector of state variables, h : R1×N → R1×d is a
continuously non-linear differentiable function, and e ∈ R1×d is the measurement error vector. Each measurement
error, ei is assumed to have zero mean, standard deviation σi and Gaussian probability distribution. d is the number of
measurements and N is the number of states.

In the classical WLS approach, the best estimate of the state vector in (14) is found by minimizing the cost function
J(x):

J(x) = (cid:107)zSG − h(x)(cid:107)2

R−1 = [zSG − h(x)]T R−1[zSG − h(x)]

(15)

where R is the covariance matrix of the measurements. In this paper, we consider the standard deviation of each
measurement to be equal to 1% of the measurement magnitude. In [37], it is shown that in the gross error detection
process all measurements should be weighted equally proportional to the measurement magnitude. After gross error
processing, in the second step, meter precision can be restored and state estimation performed.

∆zSG = H∆x + e

(16)

8

Cross-Layered Framework

∂x is the Jacobian matrix of h at the current state estimate x∗, ∆zSG = zSG − h(x∗) = zSG − z∗

where H = ∂h
SG is
the correction of the measurement vector and ∆x = x − x∗ is the correction of the state vector. The WLS solution
is the projection of ∆zSG onto the Jacobian space by a linear projection matrix P , i.e. ∆zSG = P ∆ˆzSG. Letting
r = ∆zSG − ∆ˆzSG be the residual vector, the P matrix that minimizes J(x) will be orthogonal to the Jacobian range
space and to r; ∆ˆz = H∆ˆx. This is in the form:

(cid:104)∆ˆzSG, r(cid:105) = (H∆ˆx)T R−1(∆zSG − H∆ˆx) = 0.

Solving (17) for ∆ˆx:

∆ˆx = (H T R−1H)−1H T R−1∆zSG.

(17)

(18)

At each iteration, a new incumbent solution x∗
each iteration until ∆ˆx is sufﬁciently small to claim convergence of the solution.

new is found and updated following x∗

new = x∗ + ∆ˆx. (18) is solved

The projection matrix P is the idempotent matrix that has the following expression:

P = ∆ˆx = (H T R−1H)−1H T R−1

(19)

As shown in [38], the geometrical position of the measurement error in relation to the range space of H provides
another way of interpreting the state estimation. Hence, as the measurement vector can be decomposed into two
subspaces, it is possible to decompose the measurement error vector into two components as follow:

e = P e
(cid:124)(cid:123)(cid:122)(cid:125)
eU

+ (I − P )e
(cid:123)(cid:122)
(cid:125)
eD

(cid:124)

(20)

The component eD is the detectable error, which is the residual in the classical WLS model, while the component eU
is the undetectable error. eD is in the orthogonal space to the range space of Jacobian whereas eU is hidden in the
Jacobian space.

(cid:107)e(cid:107)2 = (cid:107)eD(cid:107)2 +(cid:107)eU(cid:107)2
(21)
The error vector in (21) is called Composed Measurement Error (CM E). In order to quantify the undetectable error,
the Innovation Index (II) is introduced [39] and is presented in the following:

II i =

(cid:13)
(cid:13)ei
D
(cid:13)
(cid:13)ei
U

(cid:13)
(cid:13)
(cid:13)
(cid:13)

=

√

1 − Pii
√
Pii

(22)

Low Innovation index means there is a large component of error that is not reﬂected in the residual. Therefore, the
residual will be very small even if there is a gross error. By using (21) and (22), the CM E can be expressed in terms
of the residual and the innovation index as follow:



(cid:115)

CM Ei = ri



1 +



 .

2

1
IIi

(23)

The CM E values for the measurements taken on the SG can then be used to do Bad Data Analysis, one of the
main applications of SE [40]. A chi-squared test is used for the detection of bad data in the measurement set, which
compares a CM E based objective function value to a chi-squared threshold, which is based on the probability p
(typically p = 0.95) and the degrees of freedom d:

JCM E(ˆx) =

(cid:21)2

d
(cid:88)

i=1

(cid:20) CM Ei
σi

> χ2

d,p

(24)

If the value of JCM E is greater than the chi-squared threshold, then an error is detected in the measurement set.

2.6 CorrDet (CD) Anomaly Detection

The machine learning layer of the smart power grid uses the knowledge of already veriﬁed data to learn the normal
state of a properly functioning grid. It is then able to detect any anomalies introduced into the system at any point
forward and alerts the Network layer to identify the anomaly, isolate it from the remainder of the system and take
appropriate action. This action might be in the form of preventing contamination of the system, with regards to both
power distribution in other subsystems, and data assimilation by the machine learning system itself.

9

Cross-Layered Framework

The ML layer is developed using CorrDet Anomaly Detection [41, 42, 43] algorithm as the foundation. The CorrDet
anomaly detection learns a set of statistics for normal samples, including the mean (µ) and standard deviation (Σ).
Then, for each incoming sample (z), the Mahalanobis distance of this new sample is computed with respect to the
distribution of normal samples. A threshold value (τ ) is also estimated such that if the Mahalanobis distance is larger
than the threshold value, the new sample is detected as abnormal sample.

There are two versions of CorrDet anomaly detection based on the change in statistics of data over time. If the data is
not dynamically changing over time, a simple version of CorrDet algorithm can be applied. In this case, the statistics
of normal samples are estimated directly from sample mean and covariance of training data and the threshold is
picked by experiments. If the data is dynamically changing over time, an adaptive version of CorrDet algorithm can
be used. In this case, the sample mean and covariance of training data, as well as the threshold value estimated from
training data are only for initialization. As an incoming new samples is detected to be normal, the values of µ, Σ and
τ are updated and the sample is added to the set of normal samples.

3 Cyber-Attack Detection: A Cross Layered Perspective

On the cyber domain, high-level functions take the input from data acquired at the physical layer and implement SE and
ML actions that require interactions between the subsystems on the physical layer. The top layer, as shown in Fig. 1,
is the management layer where a D-SDN leverages data and statistics from communications and machine intelligence
to detect abnormal behavior of the communication network and prompt the analysis layer to take corrective actions.
The D-SDN output information is investigated for false data detection improvement, as well as detection of man-in-
the-middle, and denial-of-service attacks. The D-SDN, through the embedded ML, will analyze network performance
statistics (i.e. inter-arrival times, transmission delays, trafﬁc volume, etc.) in the SG network communication layer.
This network information is not considered by the SE physics-based model for detecting anomalous behavior.

Figure 3: Distributed architecture of the control and data acquisition systems of the Smart Grid

Fig. 3 shows a more detailed view of the distributed SCADA Agents from Fig. 1. In each agent, a Modbus Router
will collect real time measurements from the system and distribute that information to the SE as well as a Local Cross-
layer CorrDet. The Modbus Router also passes communication performance data to the Local Cross-layer CorrDet,
giving the ML algorithm the cross-layered perspective that is vital to detecting cyber-attacks besides FDIs. The Local
Cross-layer CorrDets are then used in the Cross-layer Ensemble CorrDet with Adaptive Statistics algorithm described
below. Finally, all of the analysis done through ML and SE are passed to the Management Layer.

3.1 Cross-Layer Ensemble CorrDet with Adaptive Statistics (CECD-AS)

In the proposed anomaly detection using cross-layer data, each sample z is a concatenation of the measurement vector,
zSG, inter-arrival time vector, zIAT , and transmission delay vector, zT D. In other words, each sample is a triple,
z = [zSG, zIAT , zT D], a 1 × 3d vector instead of z = [zSG], a 1 × d vector when only measurement values are used in
FDI attack [26], where d is the number of measurements/inter-arrival time/transmission delay of all buses in the power
grid system. A triple element z(c), a 1 × 3 vector, is deﬁned as a concatenation of the cth measurement value, the cth

10

Cross-Layered Framework

Figure 4: Cross-Layer Ensemble CorrDet Framework

inter-arrival time value and the cth transmission delay value , z(c) = [z(c)
the triple, z(c) ∈ z.

SG, z(c)

IAT , z(c)

T D]. A triple element is a subset of

The Cross-Layer Ensemble CorrDet with Adaptive Statistics, an extended work of CorrDet algorithm, can be con-
sidered as a set of Cross-layer CorrDet detectors for each local environment, as shown in Fig. 4. For instance, local
CorrDet for bus 1 (φ1) receives measurement vector (zSG) from smart-grid layer, and inter-arrival time vector (zIAT )
and transmission delay vector (zT D) from network layer for every sample. These local Cross-Layer CorrDets forms
the Cross-Layer Ensemble CorrDet. In the whole power grid topology, spatially neighboring buses are more highly
correlated and easier to be affected by an attack while buses that are further away have lower correlation. Thus, learn-
ing a full covariance over the triple z of all buses is unnecessary (nearly sparse covariance), especially when training
data is limited. Instead, local, fewer dimensional subsets of the triple offer a more accurate statistic estimation and a
computationally cheaper, more sensitive anomaly detection.

The CorrDet detector learns a set of statistics, (µ, Σ and τ ) for all buses ΦR in power grid topology, while CECD-AS
learns a series of statistics (µm, Σm and τm), one for each bus φm considering information from both smart grid and
communication layers. CECD-AS detector prevents the numerical issue of estimating a high-dimensional mean and
covariance for the distribution of the normal samples (in CorrDet detector) in the space of all triple elements when
the number of triple elements are high and the number of training samples is low, by learning a lower-dimensional
statistics in the space of only the measurements associated with each bus.

There are mj(mj < d) triple elements on each bus m, where each bus is considered as a local, spatial region,
corresponding to one Local Cross-layer CorrDet detector, φm. For ΦR, the learning process consists of estimating µ
and Σ−1 from normal training samples z (z ∈ R1×3d). A similar strategy is proposed to learn the CECD-AS detector.
The learning of ΦE involves the estimation of a set of Local Cross-layer CorrDet detectors, φm.
For each φm, the learning process consists of estimating its µm and Σ−1
selected triple elements zm (zm is a 1 × 3mj vector). The µm and Σ−1
covariance of selected triplet elements of ﬁrst k samples that are labeled as normal.

m from the normal training samples with
m are initialized with the sample mean and

Then, it starts to accept new sample and classify the new sample as follows. For each new incoming sample z, a set of
squared Mahalanobis distances, δECD
m , are computed using equation (25) and compared with the corresponding set of
thresholds, T , where T = {τm}m=1:M . If at least one squared Mahalanobis distance in {δECD
m }m=1:M is greater than
its corresponding threshold, this incoming sample is classiﬁed as an anomaly. Otherwise, it is classiﬁed as a normal
sample.

m (zm) = (zm − µm)T Σ−1
δECD

m (zm − µm)

(25)

11

Cross-Layered Framework

where µm is the mean and Σ−1
detector.

m is the inverse covariance matrix of normal samples on mth local Cross-layer CorrDet

For each new sample that is classiﬁed as normal, the anomaly detector must be able to adapt with changing trends since
data is dynamic and it changes gradually over time. Therefore, the mean, µm and inverse covariance matrix, Σ−1
m are
updated using the Woodbury Matrix Identity [44] in equations (26) and (27) respectively. Note that this update is done
only if the incoming data is considered normal data.

µnew,m = (1 − α)µm + α(zm − µm)

Σ−1

new,m =

(cid:34)
Σ−1

m −

1
1 − α

(zm − µm)(zm − µm)T
1−α
α + (zm − µm)T (zm − µm)

(cid:35)

(26)

(27)

where µm is the old mean of mth local Cross-layer CorrDet detector, Σ−1
m is the old inverse covariance matrix of
mth local Cross-layer CorrDet detector and α is a hyper-parameter value between zero and one that determines how
much importance is given to the new data sample versus the old mean. We determine the value of k and α through
experimentation.

The threshold can be assumed to be ﬁxed for data set that has constant mean and small variation in the time domain.
T = {τm}m=1:M is estimated using equation (28).

τm = µthr,m + η ∗ σthr,m

(28)

where µthr,m and σthr,m are the mean and standard deviation of the Mahalanobis distance values of the selected
triplet elements of all normal samples in training data.

However, for the daily load proﬁle data set considered in this work, the statistics of normal samples have a larger
dynamically changing mean and covariance with time such that the previous ﬁxed threshold assumption doesn’t hold.
Therefore, the Cross-Layer ECD with Adaptive Statistics is used in this work.

Unlike the ﬁxed threshold estimation in CorrDet algorithm, adaptive threshold estimation in the CECD-AS algorithm
not only initializes the threshold values τm for each local Cross-layer CorrDet detector (bus-level) following equation
(28), but updates τm in an online sliding window fashion [26].

For every new incoming sample z, the threshold values τm are inferred from the most recent β normal samples before
it. In other words, the standard deviation (σthr,m,−β) and mean (µthr,m,−β) of squared Mahalanobis distance values
of β normal samples past of the new sample z are calculated for each local Cross-layer CorrDet detector φm. Here
β is the sliding window size. Then, threshold value τm for each local Cross-layer CorrDet detector is updated using
equation (29) with updated µthr,m,−β and σthr,m,−β, where −β signiﬁes the use of past β number of samples for
updating threshold.

τm = µthr,m,−β + η ∗ σthr,m,−β.

(29)

Let K1 and K2 be the number of training and testing samples, respectively. Let Z (Z ∈ R3d×K1) and (cid:101)Z ((cid:101)Z ∈ R3d×K2 )
the training and testing samples, respectively. Let Y (Y ∈ R1×K1) and (cid:101)Y ( (cid:101)Y ∈ R1×K2) the corresponding labels.
δZ,m (δZ,m ∈ R1×K1) denotes the squared Mahalanobis distances of all training samples with respect to mth Cross-
(cid:101)zk ∈ R1×M ) denotes the squared Mahalanobis distances of kth testing sample with
layer CorrDet classiﬁer, φm. δ
respect to all local Cross-layer CorrDet classiﬁers, ΦE. Let B be the squared Mahalanobis distances of all normal
samples in the sliding window with a length of β (B ∈ R1×β). The pseudo code for the proposed anomaly detection
algorithm is shown in Procedure 1.

(cid:101)zk (δ

3.2 Combining Power Grid and Communication Network Statistics

Characteristics and security speciﬁcations of each layer should be considered in a cross-layer model to provide speciﬁc
integrated countermeasures. The envisioned cross-layer analysis architecture for the cyber plane of one agent is rep-
resented in Fig. 3. Each agent has a ML element with cross-layer interaction between the data plane, the SE, and the
SDN to record and monitor network performance data and power exchanges. Packets are transmitted from bus-to-bus
or bus-to-server using the Modbus RTU over TCP/IP networking protocol and technology. The transmission delays
(TDs) are measured at the source node (i.e.
), as shown in Fig. 2, and the inter arrival times (IATs) and trafﬁc

1
µ1−λ1

12

Procedure 1 Cross-Layer Ensemble CorrDet with Adaptive Statistics (CECD-AS) algorithm

Cross-Layered Framework

1: Train a Cross-Layer Ensemble CorrDet classiﬁer:
Input: Z, Y, (cid:101)Z
2: for Every local Cross-layer CorrDet classiﬁer m = 1 : M do
3:

Initialize the mean µm and covariance Σ−1

normal samples in the training set with selected triple elements associated with φm

Initialize the squared Mahalanobis distance δZ,m using equation (25)
Initialize the threshold τm using equation (28)

4:
5:
6: end for

7: Test using the Cross-Layer Ensemble CorrDet classiﬁer with Adaptive Statistics:

m of normal statistics using the sample mean and covariance of

Compute the squared Mahalanobis distance δ
if ∀m, δ

8: for Every test sample k = 1 : K2 do
9:
10:
11:
12:
13:
14:

(cid:101)zk < τm then

Classify (cid:101)zk as normal sample: (cid:101)yk = 0
Update the mean µm and covariance Σ−1
Update the sliding window by adding δ
Update the mean µthr,m,−β and variance σthr,m,−β of squared Mahalanobis distances in the updated

m using equation (26) and equation (27)
(cid:101)zk to B and removing the oldest value from B.

(cid:101)zk using equation (25)

sliding window of each local Cross-layer CorrDet detector

Update the threshold value τm for each local Cross-layer CorrDet detector using equation (29)

else

15:
16:
17:
18:
19: end for
Output: (cid:101)Y

end if

Classify (cid:101)zk as abnormal sample: (cid:101)yk = 1

volume are measured at the destination node (i.e. 1
). Power measurements are polled and recorded periodically from
λ2
each bus on the physical layer every 4 seconds. These values (i.e. voltage, power, and network performance statistics)
are combined and analyzed locally using the algorithm described in section 3.1, to provide a distributed approach at
detecting anomalies for each agent.

4 Experimental results

The cross-layered analysis for detection of cyber attacks was validated using the IEEE 118-bus system. Using the
MATLAB package MATPOWER [45], 21,600 samples (i.e. one day’s worth) of measurement were generated with
Gaussian noise based on a common daily load proﬁle that contains temporal information of a power system’s changing
state. The measurement set included are real and reactive power ﬂows, power injections, and all voltage magnitudes,
resulting in 691 measurements. Then, network packet times (i.e. inter-arrival times, transmission delays) were gener-
ated using mininet and extensions to emulate the commonly used Modbus RTU over TCP/IP protocol for traditional
SG environments [46]. Times were based on the M/M/c queue, i.e., c ≥ 1, where packet arrivals were modelled after
Poisson distribution and transmission delays were inherently modelled after the exponential distribution, as described
in Section 2.2. The correlating anomalous network performance statistics (i.e. IAT, and TD) from DoS and FDI
attacks were generated based on the attack tools used in [32, 33] respectively and exhibit the cyber attack properties
described in Section 2.4. The data ﬂow of the simulation environment can be seen in Fig. 5. In general, the packet ar-
rival rates to the victim node is increased during the periods where FDI and DoS attacks take place. The attack severity
level is changed based on the different methods of attacking, as described in the next section, which can increase the
network performance statistics by a factor between 2-7. Network trafﬁc volume was generated using a combination
of simulation tools such as mininet and a commonly used tool useful for executing man-in-the-middle cyber attacks
called Ettercap [47]. For this paper, we tested our cross-layered anomaly detection scheme on three types of cyber at-
tacks including multiple false data injections, multiple denial-of-service, and man-in-the-middle attacks. These cyber
attacks are done on a victim-level attack process, which are attacks on individual victim computers or IP addresses.

13

Cross-Layered Framework

Figure 5: Simulation environment model.

4.1 Data set description

In this paper, four types of data sets were generated to simulate different types of attack. It should be noted that
true labels are assigned during the process of introducing errors in all data set. The datasets described used for
experimentation are available upon request from any of the authors of this paper.

4.1.1 MFDI attack data set:

In this data set, only Multiple False Data Injection (MFDI) attack is considered. Errors are injected in the measurement
set at random in 5% of the data set samples. The resultant data set of this type has 1103 samples with MFDI attackout
of 21600 samples. In this case, two scenario were considered. The ﬁrst scenario, two measurements were chosen
randomly to be compromised and included a higher severity level for the network statistics during the periods of the
attack. In the second scenario, Coordinated Multiple FDI (C-MFDI) attack is considered. This attack is designed such
that measurements with low Innovation Index (II) are attacked, which is shown to be difﬁcult for physics-based state
estimation solution bad data detection [10]. The second scenario included a lower severity level for network statistics
to make it more difﬁcult in detecting the attack taking place.

4.1.2 MDoS attack data set:

In this data set, only Multiple Denial of Service (MDoS) attacks are considered. In a similar way, errors are introduced
in 5% of the samples at random. However, once a decision is made to introduce DoS attack, the measurements
associated with the selected buses, which is also by random, will be altered for ten consecutive samples. The resultant
data set of this type has 7330 samples with DoS attackout of 21600 samples. In each of the attacked samples, three
buses were chosen randomly to have their associated measurements (voltage, power injection, and power ﬂow from
those buses) be compromised. The MDoS dataset contained a high severity level on the network statistics during the
periods of attack.

14

Cross-Layered Framework

4.1.3 MFDI-MDoS attack data set:

In this data set, a combination of MFDI and MDoS at random samples with random number of measurements being
in error is considered. The resultant data set of this type has 4861 samples with MFDI or MDoS attack out of 21600
samples. In each of the attacked samples, four measurements were chosen randomly to be compromised if the attack
is MFDI. For MDoS attack, four buses at random were chosen to have their associated measurements be altered. The
MFDI-MDoS dataset contained a high severity level on the network statistics during the periods of attack.

4.1.4 MITM attack data set:

In this data set, only the man-in-the-middle (MITM) attack is considered. In a similar way to the MDoS data set,
errors are introduced in 5% of the samples at random. Unlike DoS and FDI attacks, which affect both the power ﬂow
and network performance metrics, MITM attack only affects the network performance metric for trafﬁc volume (i.e.
packet count). Hence, trafﬁc volume is generated and tested for this attack. Once a decision is made to introduce the
MITM attack, the network trafﬁc of a randomly selected bus is altered for ten consecutive samples. The resultant data
set of this type has 7330 samples with MITM attacks out of 21600 samples.

Table 1: Performance comparison of various false data detection methodologies [26]

Method

Accuracy

Precision

Recall

F1-score

µcv ± σcv

µcv ± σcv

µcv ± σcv

µcv ± σcv

KNN

93.05 ± 02.71

13.36 ± 09.24

03.94 ± 03.35

04.64 ± 02.97

MLPNN

78.04 ± 20.64

08.75 ± 11.98

20.89 ± 24.21

05.29 ± 04.09

GNB

ADT

SVC

49.81 ± 38.06

28.26 ± 38.50

51.35 ± 39.73

07.94 ± 04.47

45.56 ± 22.03

05.66 ± 02.33

57.84 ± 23.87

09.54 ± 01.54

55.68 ± 25.75

11.46 ± 12.14

60.57 ± 22.11

14.89 ± 06.75

SE [11]

94.07 ± 00.25

36.56 ± 02.15

80.64 ± 02.21

57.03 ± 01.92

CD [24]

04.88 ± 00.24

04.88 ± 00.24

99.07 ± 00.00

09.31 ± 00.43

ECD [25]

97.28 ± 01.40

46.52 ± 28.03

44.08 ± 29.63

55.42 ± 27.71

ECD-AS [26]

99.35 ± 00.45

87.24 ± 09.30

86.94 ± 09.87

92.54 ± 05.74

4.2 Performance Analysis

To evaluate the performance of the anomaly detection strategies included in this paper, we make use of the following
classiﬁcation metrics [48]. In our analysis, True Negatives (TN) refer to normal samples that are predicted as normal
samples. True Positives (TP) refer to anomalous samples correctly predicted as anomalous. False Negatives (FN)
refers to anomalous samples predicted to be normal, and False Positives (FP) refers to normal samples predicted to be
anomalous.

Accuracy is the ratio of correctly predicted samples to the total number of samples. Accuracy is a good performance
metric when the class sizes are balanced in the data set. For data sets with imbalanced class size (which is true in
our analysis), accuracy would not serve as a good performance metric. Hence, we include metrics such as Precision,
Recall and F1-score, which provides a better measure of performance for anomaly detection strategy. (30) shows the
formula to calculate overall accuracy of the model.

Accuracy = 100 ×

T P + T N
T P + F P + T N + F N

(30)

15

Cross-Layered Framework

Table 2: Performance results for MFDI, MDoS and MITM attacks(ECD-AS: Ensemble CorrDet with Adaptive Statis-
tics [26], CECD-AS : Cross-Layer Ensemble CorrDet with Adaptive Statistics, MFDI : Multiple False Data Injection
attacks, C-MFDI : Coordinated Multiple False Data Injection attacks, MDoS : Multiple Denial of Service attacks,
MITM : Man In The Middle attacks, SG : Smart Grid measurements, IAT : Inter Arrival Time, TD : Transmission
Delay, PC : Packet count)

Attack type

Method

Layer

Information

MITM

ECD-AS

network

MFDI

ECD-AS

smart grid

network

PC

SG

IAT

TD

Accuracy

µcv ± σcv

Precision

µcv ± σcv

Recall

F1-score

µcv ± σcv

µcv ± σcv

92.50 ± 00.21

91.62 ± 00.26

86.43 ± 00.29

88.95 ± 00.23

99.36 ± 00.27

99.99 ± 00.01

87.35 ± 5.10

93.16 ± 03.00

98.58 ± 00.10

77.85 ± 00.86

99.99 ± 00.01

87.54 ± 00.54

99.16 ± 00.04

85.56 ± 00.75

99.99 ± 00.01

92.22 ± 00.43

CECD-AS

cross-layer

[SG, IAT, TD]

99.96 ± 00.01

99.41 ± 00.31

99.89 ± 00.14

99.65 ± 00.16

C-MFDI

ECD-AS

smart grid

network

SG

IAT

TD

96.58 ± 00.78

99.94 ± 00.15

32.15 ± 13.39

47.13 ± 15.08

97.19 ± 00.44

70.50 ± 02.93

76.02 ± 08.27

72.82 ± 05.32

96.27 ± 00.45

61.12 ± 02.64

68.73 ± 08.47

64.60 ± 05.09

CECD-AS

cross-layer

[SG, IAT, TD]

99.83 ± 00.06

97.04 ± 01.12

99.77 ± 00.16

98.38 ± 00.61

MDoS

ECD-AS

smart grid

network

SG

IAT

TD

52.63 ± 00.78

34.08 ± 01.03

37.06 ± 04.15

35.41 ± 02.23

99.98 ± 00.01

99.96 ± 00.01

99.99 ± 0.01

99.98 ± 00.01

94.83 ± 00.13

87.28 ± 00.35

99.99 ± 00.01

93.20 ± 00.20

CECD-AS

cross-layer

[SG, IAT, TD]

99.83 ± 00.06

99.71 ± 00.08

99.82 ± 00.17

99.76 ± 00.09

MFDI-MDoS

ECD-AS

smart grid

network

SG

IAT

TD

69.58 ± 01.98

28.96 ± 01.12

24.84 ± 01.92

26.66 ± 00.81

90.53 ± 00.22

70.16 ± 01.32

99.99 ± 00.01

82.46 ± 00.01

98.81 ± 00.03

94.94 ± 00.29

99.99 ± 00.01

97.40 ± 00.15

CECD-AS

cross-layer

[SG, IAT, TD]

99.64 ± 00.06

98.47 ± 00.27

99.96 ± 00.06

99.21 ± 00.14

Precision is the ratio of number of correctly predicted normal samples to the overall predicted normal samples. Preci-
sion is an important metric when we want to minimize False Positives. (31) shows the formula for calculating Precision
performance metric.

P recision = 100 ×

T P
T P + F P

(31)

Recall (also called as Sensitivity) is the ratio of number of correctly predicted normal samples to number of true
normal samples. If we want to minimize the False Negatives, high value of Recall is expected without precision being
too low. (32) shows the formula for calculating Recall performance metric.

Recall = 100 ×

T P
T P + F N

(32)

F1-score is the harmonic mean of Precision and Recall. It would be better to have a single performance metric that
would consider both Precision and Recall, and which strikes a good balance between them. This metric is more useful
than accuracy since we have uneven class distribution for normal samples and anomalous samples in our analysis. (33)
shows the formula for calculating F1-score performance metric.

16

Cross-Layered Framework

F1-score = 100 ×

2 ∗ Recall ∗ P recision
Recall + P recision

(33)

4.3 Numerical Results and Discussions

To compare our results with other techniques, we ﬁrst provide Table 1, which shows the mean and standard deviation
of accuracy, precision, recall and F1-score values of various FDI detection techniques developed using traditional
machine learning classiﬁcation algorithms [26]. Table 1 demonstrated that, for FDI attacks in daily load proﬁle based
SG data, the ECD-AS technique outperforms traditional ML techniques as well as the physics-based State Estimator
and the data driven technique. In Table 2, we compare ECD-AS with the proposed cross-layer CECD-AS approach.
Accuracy, precision, recall and F1-score are shown for MFDI, MDoS and MITM attacks.

The Cross-Layer Ensemble CorrDet with Adaptive Statistics (CECD-AS) algorithm is employed to detect MFDI,
MDoS, MITM and MFDI-MDoS attacks using various attack data sets. Model parameters such as α in (26) and (27),
β in (29) and η in (29) were selected through experimentation by considering the values of F1-score. The optimal
values used to generate results in Table 2 are α = 8e − 5 and β = 90. The value of η is selected to be 11 for MFDI
and C-MFDI attacks and 7 for MDoS, MFDI-MDoS and MITM attacks. From the 21600 samples in each data set,
in the ﬁrst cross validation experiment samples 0 − 1800 (K1 = 1800, 2 hours worth of data) were used for initial
model training and samples 1800 − 12600 (K2 = 10800, 12 hours worth of data) were used for subsequent model
update and testing phase of CECD-AS. For the second cross validation experiment, we consider samples 1000 − 2800
(K1 = 1800) for training and samples 2800 − 13600 (K2 = 10800) for subsequent model update and testing phase
and so on for a total of 10 cross validation experiments.

The data-driven statistical ML approach CECD-AS learns the behaviour of normal samples and anomalous samples
through model training and adapts over time to effectively detect various kinds of attacks in the cross-layered cyber-
physical smart grid systems. This claim is supported by the high F1-scores for MFDI, MDoS and MFDI-MDoS attacks
in Table 2. It is important to note that for these data sets, three out of the four methods tested are using new information
when compared to the state of the art (SG Information) [26]. IAT and TD information is tested individually along with
the full CECD-AS framework to show that the most comprehensive and efﬁcient method for cyber-attack detection
is to combine the SG, IAT, and TD data. CECD-AS detects MITM attacks using the Packet Count (PC) data set and
the performance metrics are shown in Table 2. MITM attacks can only be detected from the data collected at network
communication layer as the attack does not impact any measurement values at the SG layer. We recorded values of
Accuracy, Precision, Recall and F1-score for all the cross validation experiments and Table 2 shows the mean (µcv) and
standard deviation (σcv) values for each of these metrics, where high value of µcv and low value of σcv is favorable.

Fig 6 shows the values of decision scores and thresholds obtained using SE and CECD-AS approaches for the C-MFDI
dataset. SE approach only provides a single decision score for the entire 118-bus system for each testing sample, in
oppose to the proposed CECD-AS which, due to its distributed nature, provides a decision score for each bus system.
SE approach also results in a static decision threshold for the entire 118-bus system whereas CECD-AS approach
results in adaptive threshold for each bus system. In the considered C-MFDI attacks dataset, bus 10 was targeted to
inject false data. Fig 6(b) shows the decision score and adaptive threshold obtained from CECD-AS approach for bus
10. As an illustration, we also show decision score and adaptive threshold for a bus that was not subjected to any
C-MFDI attacks in Fig 6(c). Decision scores which are above threshold are considered to be attacked samples and are
compared with the ground truth to generate the performance results shown in Table 2.

For every new incoming sample z, the threshold values τm are inferred from the most recent β normal samples before
it. Smaller value of β limits the number of past normal samples used to estimate anomaly threshold and would reduce
the accuracy of detection as it would fail to capture the dynamically changing state in the data. Large value for β would
allow us to use more number of normal past samples but would add additional cost in storing and processing higher
amount of data for every new incoming sample. This motivates us to pick an optimal value of β through validation
experiments, and we selected the value of β considering both F1-score of detection on unseen data and computation
time. In Fig 7, F1-score mostly increases with increasing beta but after beta reaches 90 the value of F1-score doesn’t
change by signiﬁcant amount. Meanwhile computation time increases exponentially with increasing values of beta.
We choose the value of beta with high f1-score and fairly low overall testing computation time as the optimal value.

We can observe, from Table 3, the physics based SE approach [40] fails to consistently detect different types of attacks
in the cyber-physical smart grid systems which is evident by the low F1-scores for MFDI, MDoS and MFDI-MDoS
attacks. Most of the literature on SG bad data analysis research 0focuses on the recall metric, detecting as many of the
FDI attacks as possible. Therefore, it makes sense the SE has a very high Recall score. However, there is a relatively
high rate of FPs in the SE results, which when coupled with the fact that most samples are normal, leads to a low
precision and F1 score, even when only analyzing MFDI attacks. For the data sets that include DoS attacks, the scores

17

Cross-Layered Framework

Figure 6: Comparison of SE and CECD-AS methods through corresponding decision score and decision thresholds
for Coordinated Multiple False Data Injection (C-MFDI) attacks

are bad all around since the DoS attack has little to no impact on actual measurement data. This means an attacker can
be ﬂooding the communication network with almost no detection by the SE.

Table 3: Performance results for physics based SE [40] (MFDI - Multiple
False Data Injection attacks, MDoS - Multiple Denial of Service attacks)

Attack type

Accuracy Precision Recall F1-score

MFDI

MDoS

92.76

63.42

41.34

99.45

58.41

32.81

07.43

12.12

MFDI-MDoS

75.18

38.37

16.95

23.51

For MFDI attacks, although accuracy values for individual data sets (SG, IAT, and TD) are close to accuracy value for
cross-layered data set, F1-score gives a better picture of the model performance as it strikes better balance between
precision and recall for the data sets with imbalanced class size. We can observe that cross-layered approach results in
much higher mean F1-score (99.65) compared to the individual data sets.

For C-MFDI attacks, ECD-AS approach fails to detect anomalies with high performance resulting in low F1-scores
especially with SG measurements as SG layer is more affected by coordinated attacks on the grid compared to network
layer. As the proposed CECD-AS takes information from both SG measurements and network layer data, it can capture
most of the anomalies resulting in a mean F1-score of 98.38.

For MDoS attacks, the mean F1-score for SG data set is low due to the fact that MDoS attacks have little to no impact
on the measurement values from SG layer, but higher impact on the parameters in network communication layer in
the cyber-physical smart grid systems. Hence, CECD-AS results in high mean F1-scores for the data sets collected at
network layer (IAT and TD). The cross-layered approach also results in similar performance as the individual data sets
from the network communication layer.

For MFDI-MDoS attacks, the SG data set fails to give high mean F1-score due to the presence of MDoS attacks,
and it is evident from Table 2 that the cross-layered approach results in higher mean F1-score (99.21). Performance
metric values from Table 2 show that the proposed cross-layered approach can detect various kinds of attacks in cyber-
physical SG systems with high F1-scores as the model will learn from the data sets obtained from both SG and network
communications layers. IAT and TD data sets have resulted in higher recall values for different attack types compared
to cross-layered approach but they also result in low precision values (high False Positives). Hence, results from Table
2 show that the proposed cross-layered approach results in both lower False Positives and False Negatives generally
compared to results obtained from considering individual data sets from the SG layer or the network communication
layer.

5 Conclusion

This paper presents a cross-layered approach for enhancing the detection of different potential cyber-attacks on the
Smart Grid. The state of the art solutions consider only false data injection (FDI) attacks as the source of inﬂuencing

18

Cross-Layered Framework

Figure 7: Selection of optimal value for the beta based on F1-score and computation time

measurements data (voltages and powers). However, this paper showed that measurements can be affected through the
use of communication network. Such an attack limits the ability of detecting bad data when considering measurement
data alone. Hence, the novelty of the cross-layer strategy is the integration of data from communication network as
another source of data beside measurements collected from Smart Grid in order to improve the anomaly detection
scheme for real time monitoring. The Cross-Layer Ensemble CorrDet with Adaptive Statistics (CECD-AS) reﬂects
the inter-dependency between the power grid and communication network.

The cross-layer strategy framework was implemented on the IEEE 118 bus system. Test results show that the proposed
CECD-AS can detect attacks such as Multiple False Data Injections, Multiple Denial of Service and Man In The
Middle with high F1-score compared to approaches which uses data from individual layers in the cyber-physical Smart
Grid systems. The improved performance of the proposed framework can be attributed for its ability to understand
normal and anomalous data behavior at both the Smart Grid layer (using voltage/power measurements) and network
communication layer (using inter arrival times, transmission delay and trafﬁc volume values) with a cross-layered
perspective. The trained CECD-AS model decides whether a given sample is normal or anomalous and adapts its
statistics in matter of milliseconds, so the proposed system can be implemented in real time monitoring of cyber-
physical Smart Grid systems.

Acknowledgment

This material is based upon work supported by the National Science Foundation under Grant Number 1809739.

References

[1] M. Farag, M. Azab, and B. Mokhtar, “Cross-layer security framework for smart grid: Physical security layer,” in

IEEE PES Innovative Smart Grid Technologies Europe (ISGT Europe).

IEEE, 2014, pp. 1–7.

[2] D. Volz, “U.s. government concludes cyber attack caused ukraine power outage,” Reuters, 2016.

19

Cross-Layered Framework

[3] P. Fairley, “Upgrade coming to grid cybersecurity in u.s.” IEEE Spectrum, 2016.

[4] “Cyber-attack against ukrainian critical infrastructure,” The Cybersecurity and Infrastructure Security Agency,

2018.

[5] “Blackout 2003: Final report on the august 14, 2003 blackout in the united states and canada: Causes and

recommendations,” U.S.-Canada Power System Outage Task Force, 2004.

[6] S. Morgan, “Major cyber attack on u.s. power grid is likely,” Forbes, 2016.

[7] E. Perez, “First on cnn: U.s. investigators ﬁnd proof of cyberattack on ukraine power grid,” CNN, 2016.

[8] K. Zetter, “An unprecedented look at stuxnet, the world’s ﬁrst digital weapon,” Wired.com, 2014.

[9] E. Handschin, F. C. Schweppe, J. Kohlas, and A. Fiechter, “Bad data analysis for power system state estimation,”

IEEE Transactions on Power Apparatus and Systems, vol. 94, no. 2, pp. 329–337, March 1975.

[10] N. Bretas, A. Bretas, and S. Piereti, “Innovation concept for measurement gross error detection and identiﬁcation
in power system state estimation,” IET generation, transmission & distribution, vol. 5, no. 6, pp. 603–608, June
2011.

[11] N. G. Bretas and A. S. Bretas, “The extension of the gauss approach for the solution of an overdetermined set of
algebraic non linear equations,” IEEE Transactions on Circuits and Systems II: Express Briefs, vol. 65, no. 9, pp.
1269–1273, 2018.

[12] A. S. Bretas, N. G. Bretas, and B. E. Carvalho, “Further contributions to smart grids cyber-physical security
as a malicious data attack: Proof and properties of the parameter error spreading out to the measurements and
a relaxed correction model,” International Journal of Electrical Power & Energy Systems, vol. 104, pp. 43–51,
2019.

[13] N. G. Bretas, A. S. Bretas, and A. C. P. Martins, “Convergence property of the measurement gross error correction
in power system state estimation, using geometrical background,” IEEE Transactions on Power Systems, vol. 28,
no. 4, pp. 3729–3736, 2013.

[14] A. Bretas, N. Bretas, J. London, and B. Carvalho, Cyber-Physical Power Systems State Estimation. Elsevier,

2021, vol. 1.

[15] Y. Deng, K. Zhu, R. Wang, and Y. Wan, “Real-time detection of false data injection attacks based on load
forecasting in smart grid,” in 2019 IEEE International Conference on Communications, Control, and Computing
Technologies for Smart Grids (SmartGridComm), 2019, pp. 1–6.

[16] M. G. Kallitsis, S. Bhattacharya, and G. Michailidis, “Detection of false data injection attacks in smart grids
based on forecasts,” in 2018 IEEE International Conference on Communications, Control, and Computing
Technologies for Smart Grids (SmartGridComm), 2018, pp. 1–7.

[17] A. Ashok, M. Govindarasu, and V. Ajjarapu, “Online detection of stealthy false data injection attacks in power

system state estimation,” IEEE Transactions on Smart Grid, vol. 9, no. 3, pp. 1636–1646, 2018.

[18] C. Zhang, F. Luo, M. Sun, and G. Ranzi, “Modeling and defending advanced metering infrastructure subjected
to distributed denial-of-service attacks,” IEEE Transactions on Network Science and Engineering, pp. 1–1, 2020.

[19] Irshad, Aamir, Ibrar, N. Khan, and M. Riaz, “Reliable and secure advanced metering infrastructure for smart grid
network,” in 2018 International Conference on Computing, Electronic and Electrical Engineering (ICE Cube),
2018, pp. 1–6.

[20] Z. Zhang, Y. Mishra, D. Yue, C. Dou, B. Zhang, and Y.-C. Tian, “Delay-tolerant predictive power compensation
control for photovoltaic voltage regulation,” IEEE Transactions on Industrial Informatics, vol. 17, no. 7, pp.
4545–4554, 2021.

[21] G. De Pace, Z. Wang, J. Benin, H. He, and Y. Sun, “Evaluation of communication delay based attack against the

smart grid,” in 2020 IEEE Kansas Power and Energy Conference (KPEC), 2020, pp. 1–6.

[22] T. R. B. Kushal, Z. Gao, J. Wang, and M. S. Illindala, “Causal chain of time delay attack on synchronous

generator control,” in 2020 IEEE Power Energy Society General Meeting (PESGM), 2020, pp. 1–5.

[23] J. J. Fritz, J. Sagisi, J. James, A. S. Leger, K. King, and K. J. Duncan, “Simulation of man in the middle attack

on smart grid testbed,” in 2019 SoutheastCon, 2019, pp. 1–6.

[24] R. D. Trevizan, C. Ruben, K. Nagaraj, L. L. Ibukun, A. C. Starke, A. S. Bretas, J. McNair, and A. Zare, “Data-
driven physics-based solution for false data injection diagnosis in smart grids,” in 2019 IEEE PES GM, Aug
2019.

20

Cross-Layered Framework

[25] C. Ruben, S. C. Dhulipala, K. Nagaraj, S. Zou, A. Starke, A. Bretas, A. Zare, and J. McNair, “Hybrid data-driven
physics model-based framework for enhanced cyber-physical smart grid security,” IET Smart Grid, December
2019.

[26] K. Nagaraj, S. Zou, C. Ruben, S. C. Dhulipala, A. Starke, A. Bretas, A. Zare, and J. McNair, “Ensemble corrdet

with adaptive statistics for bad data detection,” IET Smart Grid, June 2020.

[27] e. a. Amaral, Pedro, “Machine learning in software deﬁned networks: Data collection and trafﬁc classiﬁcation.”

in 2016 IEEE 24th International Conference on Network Protocols (ICNP).

ICNP.

[28] R. Jain and S. Routhier, “Packet trains–measurements and a new model for computer network trafﬁc,” IEEE

Journal on Selected Areas in Communications, vol. 4, no. 6, pp. 986–995, 1986.

[29] M. Haviv, Queues: a course in queueing theory. Springer, 2015.

[30] M. H. Cintuglu, O. A. Mohammed, K. Akkaya, and A. S. Uluagac, “A survey on smart grid cyber-physical

system testbeds,” IEEE Communications Surveys Tutorials, vol. 19, no. 1, pp. 446–464, 2017.

[31] A. Humayed, J. Lin, F. Li, and B. Luo, “Cyber-physical systems security—a survey,” IEEE Internet of Things

Journal, vol. 4, no. 6, pp. 1802–1831, 2017.

[32] L. Qiu, W. Jiang, W. Zhang, and P. Li, “Wireless injection attacks based on fake data injection in tinyos,” in 2015
Seventh International Symposium on Parallel Architectures, Algorithms and Programming (PAAP), 2015, pp.
236–242.

[33] J. Gao, S. Chai, B. Zhang, and Y. Xia, “Research about dos attack against icps,” Sensors, vol. 19, p. 1542, 03

2019.

[34] Z. Zhan, “A statistical framework for analyzing cyber attacks,” Master’s thesis, University of Texas, may 2014.

[35] P. Embrechts, C. Kl¨uppelberg, and T. Mikosch, “Modelling extremal events - for insurance and ﬁnance: Paul

embrechts.”

[36] J. D. Cryer and K.-s. Chan, Time series analysis with applications in R. Springer, 2011.

[37] N. G. Bretas and A. S. Bretas, “A two steps procedure in state estimation gross error detection, identiﬁcation,
and correction,” International Journal of Electrical Power & Energy Systems, vol. 73, pp. 484–490, 2015.

[38] N. G. Bretas, S. A. Piereti, A. S. Bretas, and A. C. Martins, “A geometrical view for multiple gross errors
detection, identiﬁcation, and correction in power system state estimation,” IEEE Transactions on Power Systems,
vol. 28, no. 3, pp. 2128–2135, 2013.

[39] N. Bretas, A. Bretas, and S. Piereti, “Innovation concept for measurement gross error detection and identiﬁcation
in power system state estimation,” IET Generation, Transmission & Distribution, vol. 5, no. 6, pp. 603–608,
2011.

[40] A. S. Bretas, N. G. Bretas, B. Carvalho, E. Baeyens, and P. P. Khargonekar, “Smart grids cyber-physical security
as a malicious data attack: An innovation approach,” Electric Power Systems Research, vol. 149, pp. 210–219,
2017.

[41] K. Ho and P. D. Gader, “A linear prediction land mine detection algorithm for hand held ground penetrating

radar,” IEEE transactions on geoscience and remote sensing, vol. 40, no. 6, pp. 1374–1384, 2002.

[42] K. C. Ho and P. D. Gader, “Correlation-based land mine detection using gpr,” in Detection and Remediation
International Society for Optics and Photonics,

Technologies for Mines and Minelike Targets V, vol. 4038.
2000, pp. 1088–1096.

[43] C.-I. Chang and S.-S. Chiang, “Anomaly detection and classiﬁcation for hyperspectral

imagery,” IEEE

transactions on geoscience and remote sensing, vol. 40, no. 6, pp. 1314–1325, 2002.

[44] B. Alvey, A. Zare, M. Cook, and D. K. Ho, “Adaptive coherence estimator (ace) for explosive hazard detection
using wideband electromagnetic induction (wemi),” in Detection and Sensing of Mines, Explosive Objects, and
Obscured Targets XXI, vol. 9823.

International Society for Optics and Photonics, 2016, p. 982309.

[45] R. D. Zimmerman, C. E. Murillo-Sanchez, and R. J. Thomas, “Matpower: Steady-state operations, planning, and
analysis tools for power systems research and education,” IEEE Trans. Power Syst., vol. 26, no. 1, pp. 12–19,
Feb 2011.

[46] R. R. Fontes, S. Afzal, S. H. Brito, M. A. Santos, and C. E. Rothenberg, “Mininet-wiﬁ: Emulating software-
deﬁned wireless networks,” in 11th International Conference on Network and Service Management (CNSM).
IEEE, 2015, pp. 384–389.

[47] “Ettercap home page.”

21

[48] S. Godbole and S. Sarawagi, “Discriminative methods for multi-labeled classiﬁcation,” in Paciﬁc-Asia
conference on knowledge discovery and data mining. Berlin, Heidelberg: Springer Berlin Heidelberg, 2004,
pp. 22–30.

Cross-Layered Framework

22

