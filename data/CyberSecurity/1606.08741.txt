Dynamic Watermarking: Active Defense of
Networked Cyber-Physical Systems

Bharadwaj Satchidanandan and P. R. Kumar, Fellow IEEE

1

6
1
0
2

n
u
J

7
2

]

Y
S
.
s
c
[

1
v
1
4
7
8
0
.
6
0
6
1
:
v
i
X
r
a

Abstract—The coming decades may see the large scale deploy-
ment of networked cyber-physical systems to address global needs
in areas such as energy, water, healthcare, and transportation.
However, as recent events have shown, such systems are vulner-
able to cyber attacks. Being safety critical, their disruption or
misbehavior can cause economic losses or injuries and loss of
life. It is therefore important to secure such networked cyber-
physical systems against attacks. In the absence of credible
security guarantees, there will be resistance to the proliferation
of cyber-physical systems, which are much needed to meet global
needs in critical infrastructures and services.

This paper addresses the problem of secure control of net-
worked cyber-physical systems. This problem is different from
the problem of securing the communication network, since cyber-
physical systems at their very essence need sensors and actuators
that interface with the physical plant, and malicious agents may
tamper with sensors or actuators, as recent attacks have shown.
We consider physical plants that are being controlled by
multiple actuators and sensors communicating over a network,
where some sensors could be “malicious,” meaning that they
may not report the measurements that they observe. We address
a general technique by which the actuators can detect the
actions of malicious sensors in the system, and disable closed-
loop control based on their information. This technique, called
“watermarking,” employs the technique of actuators injecting
private excitation into the system which will reveal malicious
tampering with signals. We show how such an active defense can
be used to secure networked systems of sensors and actuators.

Index Terms—Dynamic Watermarking, Networked Cyber-
Physical Systems, Networked Control Systems, Secure Control,
Cyber-Physical Systems (CPS).

I. INTRODUCTION

T He 21st century could well be the era of large-scale

system building. Such large-scale systems are envisioned
to be formed by the interconnection of many embedded
devices communicating with each other, and interacting with
the physical world. Their operation requires tight integration
of communication, control, and computation, and they have
been termed broadly as Cyber-Physical Systems (CPS). The
smart energy grid, intelligent transportation systems, internet
of things, telesurgical systems, and robotics are examples of
such cyber-physical systems.

While the importance and beneﬁts of cyber-physical systems
require no emphasis, their sustained proliferation is contingent
on some key challenges being addressed, security being a
primary one. Since CPSs have many applications in safety-
critical scenarios, security breaches of these systems can have

This paper is partially based on work supported by NSF Science and
Technology Center Grant CCF-0939370, NSF Contract No. CNS-1302182,
the US Army Research Ofﬁce under Contract No. W911NF-15-1-0279, and
the AFOSR under Contract No. FA-9550-13-1-0008.

adverse consequences including economic loss,
death.

injury and

There have been many instances of demonstrated attacks
on cyber-physical systems in the recent past [1], [2]. In
Maroochy-Shire, Australia, in the year 2003, a disgruntled
ex-employee of a sewage treatment corporation hacked into
the computers controlling the sewage system and issued com-
mands which led to a series of faults in the system [1],
[3]. This is an insider attack, where the adversary has the
necessary credentials to access and issue control commands
to the system. We will return to this point shortly. Another
example is the attack on computers controlling the Davis-
Besse nuclear power plant in Ohio. In the year 2003, the
Slammer worm, which infected about 75000 hosts in the
internet in under ten minutes, also infected the computers
controlling the nuclear power plant, disabling the safety moni-
toring systems [1]. While the Slammer worm was not designed
to target the nuclear power plant, the use of commodity IT
software in control systems made them vulnerable to such
attacks [1]. Another pertinent example is the Stuxnet worm
which, in the year 2010, exploited a vulnerability in Microsoft
Windows to subvert critical computers controlling centrifuges
in Iran’s uranium enrichment facility [4]. Having subverted
the computers, it issued control commands that caused the
centrifuges to operate at abnormally high speeds, causing them
to tear themselves apart. In order to keep the attacks undetected
by software-implemented alarm routines and ofﬁcials in the
control room, Stuxnet recorded the sensor values in the facility
for twenty-one seconds before carrying out each attack, and
replayed those twenty-one seconds in a constant loop during
the attack. Stuxnet has been claimed to be the ﬁrst known
digital weapon [4], and since then, cyberwarfare has emerged
as a serious concern for cyber-physical systems due to the
many advantages it offers to the attacker such as allowing it
to remain anonymous, attack without geographical constraints,
etc. Today, the resources required to carry out such attacks on
critical infrastructures are generally available [5], underlining
the urgent need for the research community to pay attention
to this problem.

In this paper, we examine the problem of detecting at-
tacks on networked cyber-physical systems. These systems
can be thought of as having two layers- a physical layer,
which consists of the plant, actuators, controllers, and sensors,
which interact with physical signals, and a cyber layer, which
networks the components of the physical layer. While securing
the cyber layer is certainly of importance, by itself, it does not
constitute the security of the cyber-physical system as a whole.
The Maroochy-Shire incident is a classic illustration of this

 
 
 
 
 
 
point, where the malfunctioning of the plant was not the result
of an attack on the network layer, but of authorized individuals
attacking the physical layer by the issue of improper control
commands.

At ﬁrst look, it appears as though securing the physical
layer is harder than securing the cyber layer. In the problem of
network security, there is a clear distinction between an honest
party and an adversary. Attributes such as credentials and
cryptographic keys distinguish honest parties from adversaries.
However, when it comes to securing the physical layer, no such
demarcation exists. Any authorized party is also a potential
adversary.

However, we show in this paper that what works in fa-
vor of securing the physical layer, and what we exploit, is
the fact that the actions of every node interfacing with the
physical layer get transformed into physical signals, and these
signals can be subject to scrutiny for semantic consistency.
To elaborate, consider a physical system consisting of a plant,
some actuators, and some sensors. If an actuator injects into
the system a probing signal that is not disclosed to other
nodes in the system, then, combined with the knowledge of
the plant dynamics, the actuator expects the signals to appear
in transformed ways at various points in the system. Based
on the information that the actuator receives from the sensors
about the signals at various points, it can potentially infer if
there is malicious activity in the system or not.

We develop these ideas to secure the physical layer of a
noisy dynamical system. We examine a protocol whereby hon-
est actuator nodes deliberately superimpose certain stochasti-
cally independent probing signals on top of the control law
they are intended to apply. We then propose speciﬁc “tests”
that these actuator nodes perform to infer malicious activity,
and establish their effectiveness. As a particular illustration
of the results, for example, we can show that even if all
the sensors are malicious, and the actuators have absolutely
no measurements that they can directly make and have to
completely rely on the malicious sensors for all their purported
measurements, then even in such an adverse environment,
the actuators can under appropriate conditions ensure that
the additional distortion on performance that the malicious
sensors can cause is of mean-square zero, if they are to remain
undetected. Using this approach of active defense, we establish
that under appropriate conditions, no matter in what way the
adversarial sensors collude, the amount of distortion that they
can add without exposing their presence can have an average
power of only zero.

The method we examine is a dynamic version of “water-
marking,” [6] where certain indelible patterns are imprinted
into a medium that can detect tampering [6]–[8]. It shows how
one can watermark dynamic signals so that one can detect
malicious misbehavior on the part of sensors or actuators.
On top of a secure communication system, it provides overall
security to a cyber-physical system against malicious sensors
and actuators.

This paper is organized as follows. Section II describes prior
work in this area. Section III provides a system-theoretic for-
mulation of the problem. Section IV describes our approach of
active defense for networked cyber-physical systems. Section

2

V opens by describing the method in the relatively simple
context of a scalar linear Gaussian system and rigorously
establishes the associated theoretical guarantees. Section VI
treats the more general class of scalar auto-regressive systems
with exogenous noise (ARX systems) that is Gaussian. Section
VII extends these ideas to the more general ARMAX systems
with arbitrary delay, a model that is frequently encountered
in process control. Section VIII deals with partially observed
SISO systems with Gaussian process and measurement noise.
Section IX considers multi-input, multi-output linear Gaussian
systems in state-space form. Section X describes how our
results can potentially be extended to non-Gaussian systems.
Section XI shows how the theoretical results lead to statistical
tests that can be used to detect malicious behavior within a
delay bound with a controlled false alarm rate. Section XII
provides some concluding remarks.

II. PRIOR WORK
The vulnerability and the need to secure critical infrastruc-
ture from cyberattacks has been recognized at least as early as
in 1997 [9]. Subsequent reports [10]–[15] cited demonstrated
attacks, identifying potential threats, and analyzing the effects
of successful attacks on speciﬁc systems. The large-scale
replacement of proprietary control software and protocols
by commodity IT software and protocols by the industry
in order to allow for interoperability and rapid scalability
has increased the vulnerability of Industrial Control Systems
(ICS) to cyberattacks, and roadmaps were prepared to address
security of control systems in various sectors such as the
energy sector [16], water sector [17], chemical sector [18],
and the transportation sector [19].

Some of the initial work on secure control [20] has ad-
dressed the deﬁnition of what constitutes a secure control
system. Certain key operational goals such as closed-loop
stability and performance metric of interest are noted in [20],
and it is proposed that a secure control system must achieve
these operational goals even when under attack, or at least
cause only a gradual degradation. It also identiﬁes how the
problem of secure control of networked systems departs from
the traditional problems of network security and information
security. In the former, authorized users or insiders can launch
attacks on the system causing physical damage, as in the
Maroochy-Shire incident. Hence, network and information
security measures such as intrusion prevention and detec-
tion, authentication, access control, etc., fundamentally cannot
address these attacks. Therefore, securing the network does
not amount to securing the NCS. In this paper, we build
a framework on top of a secure communication network to
secure the NCS. There has been recent work showing how
one indeed can build a communication network that provides
provable guarantees on security, throughput as well as delays
[21].

A theoretical study of secure control beneﬁts from having a
model for the adversary, and [22] deﬁnes certain adversary and
attack models. A popular attack on communication networks
is the Denial-of-Service (DoS) attack, in which the adversary
ﬂoods the communication network with useless packets, ren-
dering it incapable of transporting useful information. Another

attack is the deception attack, where an adversary impersonates
as another node and transmits false information on its behalf.
In the context of a networked control system, the adversary
could employ DoS attack to prevent the controller and actuator
from receiving the data required for their operation, and could
employ deception to cause an actuator node to issue incorrect
actuation signals. A framework to study the evolution of the
physical process under Denial-Of-Service (DoS) and deception
attacks is presented in [22].

Classical estimation algorithms such as the Kalman ﬁlter
assume perfect communication between the sensor and the
controller. However, in the presence of an unreliable network,
which may stem from either the characteristics of the network
or from adversarial presence, certain packets may be dropped.
This affects the performance of the estimation and control
algorithm. Motivated by this scenario, a large body of research
has been devoted to developing estimation and control algo-
rithms for systems with intermittent observations, c.f. [23]–
[27] and references therein. Though this line of work does not
explicitly model adversarial behavior, some of these ideas have
been employed in the literature of secure control. For instance,
[28] studies, using some of the machinery developed in [23]
in the context of control over lossy communication networks,
the effect of DoS attack on the control performance. Also
addressed in the literature is the effect of deception attacks on
estimation and control performance. In [29], the effect of false
data fed by the compromised sensors to the state estimator is
studied. The goal is to characterize the set of all estimation
biases that an adversary can inject without being identiﬁed.
A related work is [30], where fundamental trade-offs between
the detection probability (for a ﬁxed false alarm rate) and the
estimation error that the adversary can cause, are studied for
single-input-single-output systems.

Several techniques have also been developed to counter
attacks on cyber-physical systems. A technique for correct
recovery of the state estimate in the presence of malicious
sensors is presented in [31], and also a characterization of the
number of malicious sensors that can be tolerated by the algo-
rithm. A well-known attack on control systems is the replay
attack, where the adversary records the sensor measurements
for a ﬁxed period of time and replays them during the attack
so as to maintain the illusion of a normal operating condition.
It was shown in [32] that only systems for which the matrix
(A + BL)(I − KC) is stable are susceptible to replay attacks,
where L is the feedback gain and K is the steady-state Kalman
gain of the system’s Kalman ﬁlter. Consequently, for such
systems, a method to secure the system from replay attack
is presented in [32]–[35]. The fundamental idea of these is
to inject into the actuation signal a component that is not
known in advance. Speciﬁcally, [32], [34] consider the replay
attack, employed in Stuxnet, and introduce a technique, termed
Physical Watermarking, wherein the controller commands the
actuators to inject into the system a component that is random
and not known in advance in order to secure the system
against such an attack. To the best of our knowledge, this
is the ﬁrst use of the idea of watermarking. It is shown that
by employing Physical Watermarking, the covariance of the
innovations process when the system is “healthy” and that

3

when it is under attack are signiﬁcantly different, enabling
the estimator to detect the attack using a χ2 detector. This
technique is extended in [35] to detect an adversary employing
more intelligent attack strategies. Speciﬁcally, the adversary
is assumed to possess a set of capabilities, based on which a
speciﬁc attack strategy, consisting of the adversary generating
false measurement values that are reported to the estimator, is
identiﬁed. It is shown that Physical Watermarking can counter
such an adversary. Including a random component
in the
actuation signal would clearly affect the running cost, and
[36] develops an optimal policy to switch between cost-centric
and security-centric controllers, by formulating the problem
as a stochastic game between the system and the adversary.
A method to detect false-data injection is presented in [37],
where the focus is on zero-dynamics attacks, attacks which
cannot be detected based on input and output measurements.
A method to verify the measurements received from multiple
sensors is presented in [38], which exploits correlations be-
tween sensor measurements and other features to weed out the
measurements from malicious sensors. Though not presented
in the context of a dynamical system, the ideas presented
in [38] could in principle be extended to incorporate system
dynamics.

At a high level, the techniques generally proposed in the
literature for secure control, such as estimation with intermit-
tent or incorrect observations, exploiting known correlations
between sensor measurements to weed out suspicious mea-
surements, or techniques inspired from fault-tolerant control,
can be classiﬁed as passive techniques, meaning that they
anticipate that the adversary will inject malicious signals into
the system, and therefore employ a design that minimizes the
damage that can be so caused. On the contrary, in this paper,
we pursue active defense along the lines of [32], [34], [35],
an alternative approach for secure control in which, over and
above the control-policy speciﬁed excitation, the system is
excited in ways unknown to the adversary, thereby preventing
the adversary from injecting malicious signals into the system.
This constitutes a form of watermarking of a dynamic system
[6]–[8]. Since it does not distinguish between an adversarial
node and a faulty node, this approach also falls under the
purview of fault-tolerant control. Such a singular departure
from passive approach is [32], [34], [35], where it has been
proposed to inject a signal to guard against adversarial attacks.
This paper develops a comprehensive treatment of such dy-
namic watermarking. To the best of our knowledge, the general
theory and techniques of active defense for arbitrary attacks
does not appear to have been studied in the literature thus far.
That is what is developed in this paper.

III. PROBLEM FORMULATION

Fig. 1 illustrates the basic architecture of a Networked
Cyber-Physical System. At the heart of the system is a physical
plant with m inputs and n outputs. Each input is controlled
by an independent actuator, and each output is measured by
an independent sensor. A known transformation capturing the
dynamics of the physical plant maps the actuation signals
applied by the actuators to outputs that are measured by the

sensors. These measurements are communicated to entities
called controllers through an underlying communication net-
work. Each controller’s job is to compute, in accordance with
a control policy, the particular actuation signals that must be
applied. The result of this computation is then communicated
to the actuators through the communication network, which
then apply the actuation signals. We assume that the network is
complete, so that every node in the network can communicate
with every other node. We use the term “nodes” generically to
refer to any entity in the network. Therefore, in Fig. 1, some
nodes are actuators, some are sensors, some are controllers,
and some could just be relays whose only job is to forward the
information from one node to another. In this work, we assume
that each node has both communication and computational
capabilities, thereby allowing the controllers to be collocated
with the actuators.

However, certain sensors in the system could be “malicious”
(suggestive of this, some nodes in Fig. 1 are marked in
red), and the other nodes are said to be “honest.” We further
assume that the malicious nodes know the identity of all other
malicious nodes in the system, allowing them to collude to
achieve their objective, whereas the honest nodes don’t know
which of the other nodes are malicious or honest. A malicious
sensor is a sensor node which does not report accurately the
measurements that it observes. Rather, it reports a distorted
version of the measurements. A malicious router node may not
forward the packets that it receives, may forward packets that
it does not receive (while claiming otherwise), alter packets
before forwarding, introduce intentional delays, impersonate
some other node in the system, etc. Therefore, the challenges
of securing a Networked Cyber-Physical System are two-fold:
1) Secure the cyber layer that comprises the communication
network, ensuring conﬁdentiality, integrity, and availabil-
ity of network packets, and

2) Secure the sensors and actuators interfacing with the

physical layer.

The former is achieved by a combination of traditional ap-
proaches such as cryptography and a more recent line of work
reported in [21], [39], [40], while the latter is the subject of
this paper.

Based on our assumption that the communication network
is complete, and that the cyber layer has been secured, we
suppose that every node in the network knows the identity
of the node from which a packet that it receives originated,
and knows if a packet that it receives was tampered with
by any node along the route. Therefore, going forward, we
abstract the cyber layer as consisting of secure, reliable, delay
guaranteed bit pipes between any pair of nodes in the network.
In particular, we imagine that there exists a secure, reliable,
delay guaranteed bit pipe between any particular sensor and
actuator node.

Finally, the plant that is being controlled is abstracted as a
stochastic linear dynamical system described by time-invariant
parameters. While any system that is of practical interest is
most certainly non-linear, we focus on linear systems for two
reasons. The ﬁrst is that a linear system lends itself to tractable
analysis, and enables one to separate the complexity arising
out of the problem at hand from the complexity arising as a

4

Figure 1. A Networked Cyber-Physical System

consequence of the system’s non-linearity. Secondly, a theory
developed for linear systems provides valuable insights and
design principles that often transcend the particulars of the
model and apply to a much broader class of systems. The wide
applicability of Kalman’s pioneering work on linear control
systems [41] stands testimony to this fact.

We are now in a position to state the problem in precise
terms (with notation as indicated in the Appendix). Consider
an m × n stochastic linear dynamical system of order p,
described by

x[t + 1] = Ax[t] + Bu[t] + w[t + 1],

(1)

where A ∈ Rp×p, B ∈ Rp×m, u[t] is the input applied to
the plant at time t, {w} is a sequence of independent and
identically distributed (i.i.d.) Gaussian random vectors with
zero mean and covariance martix σ2
wI, independent of the
initial state x0 of the system.

While a malicious sensor can report different measure-
ments to different actuators, the consistency of the reported
measurements can be checked by allowing the actuators to
exchange the reported measurements among themselves. This
constrains the malicious sensors to report the same value to
all honest nodes in the system. The sensor node j reports
to the honest nodes in the system the value zj[t] as the
measurement that it observes at time t. We deﬁne z[t] :=
[z1[t] z2[t] z3[t] · · · zn[t]]T . We will call z[t] for t ≥ 0 the
measurements reported by the sensors. Note that the sensor j
is honest if zj[t] = xj[t] ∀t.

We assume that a control policy is in place, known to all
nodes in the system, and allow for it to be history dependent,
so that the ith input at time t, ug
i [t], dictated by the policy is
ug
t(zt),
i [t] = gi

(2)

where zt := {z[0], z[1], ..., z[t]}. We can suppose without loss
of generality that the controller that computes this control law
is collocated with the actuator node.

Our goal in this paper is to secure the control system by
developing techniques that prevent the malicious nodes from
causing excessive distortion if they are to remain undetected.
We will suppose that the purpose of control law (2) is to

Private excitation ei[t] is
superimposed on the
control policy-speciﬁed input

Actual actuation signal
contains private excitation
known only to actuator i

ei[t]

ug
i [t]

ui[t]

Node
j

PHYSICAL
PLANT

Node
s

Node
n

Figure 2.
realization is unknown to other nodes on to its control inputs

The actuator node i superimposes a private excitation whose

improve the regulation performance of the system with respect
to the disturbances affecting it. For some of the performance
results we will assume that the system is open-loop stable, and
show that the adversarial nodes cannot affect the performance
of the system without remaining undetected, and if detected
then they can be disconnected, returning the system to sta-
ble behavior. The fundamental results characterizing what is
the most that the adversarial nodes can do while remaining
undetected, are applicable to all systems, stable or unstable.

IV. DYNAMIC WATERMARKING: AN ACTIVE DEFENSE
FOR NETWORKED CYBER-PHYSICAL SYSTEMS

The key idea which allows the honest nodes to detect the
presence of malicious nodes in the system is the following. Let
g denote the control policy in place that speciﬁes inputs to be
applied in response to observed outputs. At each time instant t,
an actuator node superimposes on its control policy-speciﬁed
input ug
i [t], a random variable ei[t] that it draws independently
from a speciﬁed distribution. Therefore, the input that actuator
i applies at time t is

ui[t] = ug

i [t] + ei[t].

(3)

is

illustrated in Fig. 2. The

random variables
This
e0[t], e1[t], e2[t] · · · are independent and identically distributed
(i.i.d.), independent of the control policy-speciﬁed input. The
distribution that they are chosen from is made public (i.e.,
made known to every node in the system), but the actual
values of the excitation are not disclosed. In fact, this is
how the honest actuators can check whether signals are being
tampered with as they travel around the control loop. We
refer to these random variables as an actuator node’s privately
imposed excitation, since only that actuator node knows the
actual realization of the sequence.

To see why private excitation helps, consider the example of
a single-input-single-output (SISO) system where the sensor is
malicious and the actuator is honest. Suppose that the control
policy in place is g = (g1, g2, . . . , gt, . . .), where gt speciﬁes

5

the input to be applied at time t in response to outputs up
till that time. The actual outputs of the plant up to time t
are xt := (x[0], x[1], . . . , x[t]). However the outputs reported
to it by the malicious sensor are zt := (z[0], z[1], . . . , z[1]),
which may differ from xt. The actuator therefore applies the
control input u[t] = gt(zt) at time t, without using any private
excitation. Then, we have the system

(4)

x[t + 1] = ax[t] + bgt(zt) + w[t + 1],
where w[t] is the zero-mean process noise with variance σ2
w.
If the actuator does not superimpose a private excitation,
the sensor knows, for each time t, the input u[t] applied by
the actuator. This is because it knows both the measurement
sequence zt that it reported to the actuator as well as the
control policy {g1, g2, ...} that the honest actuator has imple-
mented. Hence, the malicious sensor can report a sequence of
measurements {z[t]} to the actuator without even “looking”
at the output, but by simply “simulating a linear stochastic
system” after generating its own i.i.d. process noise {w(cid:48)} from
the same distribution as that of {w}, as follows.

z(t + 1) = az(t) + bgt(zt) + w(cid:48)(t + 1).

(5)

The actuator cannot detect that the sensor is malicious since
the sequence {w(cid:48)}, having been chosen from the same distri-
bution as {w}, could have been the actual process noise.
However, by superimposing a private excitation that
is
unknown to the sensor, the actuator forces the sensor to report
measurements that are correlated with {ei}, lest it be exposed,
as we will show in the sequel. In the following sections, we
prove that thereby constraining the sensor to report measure-
ments that are correlated with the private excitation essentially
limits the amount of distortion that the sensor can get away
with while remaining undetected to be essentially zero in a
mean-square sense.

This active defense technique is similar in spirit to the
technique of digital watermarking [6] in electronic documents.
Electronic documents can be easily transmitted and reproduced
in large numbers. In doing so, the source of the document may
be deleted, and can result in copyright violations. To protect
the identity of its author, or any other information about the
document, the electronic document is “watermarked” before
being made available electronically. A digital watermark is a
digital code that is robustly embedded in the original document
[7]. By robust, it is meant that the code cannot be destroyed
without destroying the contents of the document. This code
typically contains information about the document that needs
to be preserved. Though preferable, it is not a requirement that
the watermark be imperceptible. The only requirement is that
it does not distort the actual contents beyond certain acceptable
limits [7]. Applications of digital watermarking also include
data authentication, where fragile watermarks are used which
get destroyed when the data is tampered with [7], and data
monitoring and tracking.

This approach for secure control is analogous to digital
watermarking. As we show in the subsequent sections, with
regard to, for example, the above case where we considered
is
a compromised sensor,
unknown to the sensor effectively “watermarks” the process

injecting private excitation that

noise, in the sense that the sensor cannot separate the private
excitation from the process noise. Hence, any attempt on the
part of the sensor to distort the process noise (which is the only
component of the output unknown to the actuators) will also
distort the “watermark,” allowing the honest nodes to detect
malicious activity.

Speciﬁcally, given a general MIMO system of the form (1),

we deﬁne

v[k] := z[k] − Az[k − 1] − Bu[k − 1] − w[k],

distributed (i.i.d.) and Gaussian of mean 0 and variance σ2
e .
Therefore, the system evolves in closed-loop as

x[t + 1] = ax[t] + bgt(zt) + be[t] + w[t + 1].

(8)

We propose that the honest actuator perform certain “tests”
to check if the sensor is malicious or not. Towards developing
these tests, note that the actual sequence of states {x[t]} of
the system satisﬁes

x[t + 1] − ax[t] − bgt(zt) = be[t] + w[t + 1].

(9)

6

so that if the sensors truthfully report z[t] ≡ y[t], then, v ≡ 0.
As will be shown, the sequence {v} has the interpretation of
the additive distortion introduced by the malicious sensors to
the process noise. A similar deﬁnition can also be provided
for a partially observed system, as we will show in Section
VIII. In this case, the sequence {v} has the interpretation of
the additive distortion introduced by the malicious sensors to
the innovations process. Now, based on {v}, we deﬁne the
following quantity.
Deﬁnition: (Additive distortion power of malicious sensors)
We call

lim sup
T →∞

1
T

T
(cid:88)

k=1

(cid:107)v[k](cid:107)2

as the additive distortion power of the malicious sensors.

The fundamental security guarantee provided by Dynamic
Watermarking is that the additive distortion power is restricted
to be zero if the malicious sensors are to remain undetected.
We establish this in several linear control system contexts in
this paper.

V. ACTIVE DEFENSE FOR NETWORKED CYBER-PHYSICAL
SYSTEMS: THE SISO CASE WITH GAUSSIAN NOISE

In this section, to illustrate the results in a simple context,
we focus on single-input, single-output linear stochastic dy-
namical systems with Gaussian noise. The system is described
by

x[t + 1] = ax[t] + bu[t] + w[t + 1],

(6)

where a, b, x[t], u[t], w[t] ∈ R, with {w[t]} being zero-mean
i.i.d. Gaussian process noise of variance σ2
w. The actuator
wishes to implement a control law {gt}, i.e., it wishes to
implement u[t] = gt(xt), where xt := (x[0], x[1], · · · , x[t]).
However, the actuator does not have access to xt. It relies on a
sensor that measures x[t]. However, since the sensor could be
malicious, it reports measurements z[t] to the actuator, where
z[t] could differ from x[t]. We consider an honest actuator that
is meant to, and implements the control policy {g}, but adds
a private excitation {e} as a defense. Speciﬁcally, the actuator
applies to the system the input

u[t] = gt(zt) + e[t].

(7)

Therefore, we have

{x[t + 1] − ax[t] − bgt(zt)}t ∼

i.i.d. N (0, b2σ2

e + σ2

w),

(10)

and

{x[t + 1] − ax[t] − bgt(zt) − be[t]}t ∼

i.i.d. N (0, σ2

w).

(11)

Based on the above observations, we propose that
the
actuator perform the following natural tests for variance to
check if the sensor is honestly reporting x[t]. The actuator
checks if the reported sequence {z[t]} satisﬁes conditions (10)
and (11), which the true output {x[t]} would satisfy if the
sensor were truthfully reporting z[t] ≡ x[t]. We write the
tests in an asymptotic form below, as a test conducted over
an inﬁnite time interval. They can be reduced to statistical
tests over a ﬁnite time interval in standard ways, which we
elaborate on in Section-XI.

1) Actuator Test 1: Check if the reported sequence of

measurements {z[t]} satisﬁes

lim
T →∞

1
T

T −1
(cid:88)

k=0

(z[k + 1] − az[k] − bgk(zk) − be[k])2 = σ2
w.

(12)

2) Actuator Test 2: Check if the reported sequence of

measurements {z[t]} satisﬁes

(z[k + 1] − az[k] − bgk(zk))2

lim
T →∞

= (b2σ2

T −1
(cid:88)

1
T
k=0
e + σ2

w).

(13)

Deﬁne

v[t + 1] := z[t + 1] − az[t] − bgt(zt) − be[t] − w[t + 1],

so that for an honest sensor which reports z[t] ≡ x[t], v[t] =
0 ∀t. We term the quantity

lim
T →∞

1
T

T
(cid:88)

k=1

v2[k]

Note that even though it implements the control policy {g},
the policy is applied to the measurements z[t] reported by
the sensor, which could differ from the true output x[t]. The
private excitation e[·] added is independent and identically

the additive distortion power of a malicious sensor for reasons
explained later. The ensuing theorem proves that a malicious
sensor with only zero additive distortion power can pass the
above two tests, thereby remaining undetected.

Theorem 1. If {z[t]} passes tests (12) and (13), thereby
remaining undetected, then,

lim
T →∞

1
T

T
(cid:88)

k=1

v2[k] = 0.

(14)

Proof: Since {z} satisﬁes (12), we have,

lim
T →∞

1
T

T
(cid:88)

(v[k] + w[k])2 = σ2
w.

(15)

k=1

Hence,

lim
T →∞

1
T

T
(cid:88)

k=1

v2[k] + 2v[k]w[k] + w2[k] = σ2
w.

Since limT →∞

1
T

(cid:80)T

T
(cid:88)

lim
T →∞

1
T

v2[k] + lim
T →∞

1
T

k=1
Since {z} also satisﬁes (13), we have,

k=1

k=1 w2[k] = E{w2[k]} = σ2
T
(cid:88)

w, we have

2v[k]w[k] = 0.

(16)

7

< 1.

where β := σ2
b2σ2

w
e +σ2
w

Let (cid:101)w[k] := w[k]− (cid:98)w[k]. Then, ( (cid:101)w[k−1], Sk) is a Martingale

difference sequence. This is because (cid:101)w[k − 1] ∈ Sk, and
E[ (cid:101)w[k] (cid:12)

(cid:12)Sk] = 0.

(19)

We also have v[k] ∈ Sk (in fact, v[k] ∈ σ(xk, zk)). Hence,
Martingale Stability Theorem (MST) [43] applies, and we have

T
(cid:88)

k=1

T
(cid:88)

v[k] (cid:101)w[k] = o(

k=1

v2[k]) + O(1).

(20)

Now,

T
(cid:88)

k=1

v[k]w[k] =

=

T
(cid:88)

k=1
T
(cid:88)

k=1

v[k]( (cid:98)w[k] + (cid:101)w[k])

v[k] (cid:98)w[k] + o(

T
(cid:88)

v2[k]) + O(1).

k=1

Employing the speciﬁc form of the estimate (18), we have
from the above,

T
(cid:88)

(v[k] + be[k − 1] + w[k])2 = b2σ2

e + σ2
w.

k=1

T
(cid:88)

k=1

So,

lim
T →∞

lim
T →∞

1
T

1
T

T
(cid:88)

k=1

(v[k] + w[k])2 + lim
T →∞

1
T

T
(cid:88)

k=1

b2e2[k − 1]

+ lim
T →∞

1
T

T
(cid:88)

k=1

2be[k − 1](v[k] + w[k]) = b2σ2

e + σ2
w.

Using (15), and the fact that {e} has variance σ2
reduces to

e , the above

lim
T →∞

1
T

T
(cid:88)

k=1

e[k − 1](v[k] + w[k]) = 0.

Invoking the fact that e[k − 1] and w[k] are independent ∀k
and zero mean, it further reduces to

lim
T →∞

1
T

T
(cid:88)

k=1

e[k − 1]v[k] = 0.

(17)

The above equation implies that the sequence {v}, added by
the sensor, must be empirically uncorrelated with the actuator’s
private noise sequence {e}.

Let Sk := σ(xk, zk, ek−2), (cid:98)w[k] := E[w[k](cid:12)
(cid:12)Sk]. Since
w[k] = x[k] − ax[k − 1] − bgk−1(zk−1) − be[k − 1],

we have

(xk−2, ek−2) → (x[k − 1], x[k], zk) → w[k]

a Markov

chain. Consequently,

:=
(cid:98)w[k]
forming
E[w[k](cid:12)
(cid:12)σ(ek−2, xk−2, x[k − 1], x[k], zk)] = E[w[k](cid:12)
(cid:12)σ(x[k −
1], x[k], zk)]. Since x[k] − ax[k − 1] − bgk−1(zk−1) (which
is equal to be[k − 1] + w[k]) is i.i.d. Gaussian for different k,
we have [42]
σ2
w
e + σ2
w

(be[k − 1] + w[k]) = β(be[k − 1] + w[k]),

(cid:98)w[k] =

b2σ2

(18)

v[k]w[k] =βb

T
(cid:88)

v[k]e[k − 1] + β

k=1
T
(cid:88)

+ o(

k=1

v2[k]) + O(1).

T
(cid:88)

k=1

v[k]w[k]

Hence,

T
(cid:88)

v[k]w[k] =

T
(cid:88)

v[k]e[k − 1] + o(

βb
1 − β

T
(cid:88)

k=1

v2[k]) + O(1).

k=1 v[k]e[k − 1] = o(T ). It follows that

k=1
k=1
From (17), we have (cid:80)T

T
(cid:88)

k=1

v[k]w[k] = o(

T
(cid:88)

k=1

v2[k]) + o(T ) + O(1).

(21)

So,

T
(cid:88)

k=1

v2[k] +

T
(cid:88)

k=1

2v[k]w[k] = (1 + o(1))(

T
(cid:88)

v2[k]) + o(T )

k=1

+ O(1)

Dividing the above equation by T , taking the limit as T → ∞,
and invoking (16) completes the proof.
Remark: Note that the only sources of uncertainty in the
system are the initial state of the system x[0] and the sequence
of noise realizations {w[1], w[2], w[3], · · · }. The sensor report-
ing a sequence of measurements is equivalent to it reporting
a sequence of process noise realizations, since the actuator
expects z[t+1]−az[t]−bgt(zt)−be[t], which it can compute,
to be equal to the process noise w[t + 1]. From the deﬁnition
of v[t], we have

z[t + 1] − az[t] − bgt(zt) − be[t] = w[t + 1] + v[t + 1].

The left hand side of the above equation can be computed by
the actuator, and therefore, it can also compute the sequence
{w + v}. What the theorem states is that a malicious sensor
cannot distort the noise realization {w[1], w[2], w[3], · · · } be-
yond adding a zero-power sequence to it. Suppose the control

law g has been designed to provide good noise regulation
performance of a stable system, then the performance of the
system is good, subject only to the slightly increased cost of
the private excitation of variance σ2
e . As we discuss in Section
XI, this can be reduced to a low enough value that permits
detection of a malicious sensor within a speciﬁed delay with
an acceptable level of false alarm probability.

Theorem 2. Suppose |a| < 1, i.e., the system is stable.
(i) Deﬁne the distortion d[t] := z[t] − x[t]. Then,

lim
T →∞

1
T

T −1
(cid:88)

k=0

d2[k] = 0.

(ii) If the malicious sensor is to remain undetected, the mean-
square performance of x[t] is the same as the reported
mean-square performance z[t] that the actuator believes
it is:

lim
T →∞

1
T

T −1
(cid:88)

k=0

x2[k] = lim
T →∞

1
T

T −1
(cid:88)

k=0

z2[k].

(iii) Suppose the control law is ug(t) = f x(t) with |a +
bf | < 1. The malicious sensor cannot compromise the
performance of the system if it is to remain undetected,
i.e., the mean-square performance of the system is

lim
T →∞

1
T

T −1
(cid:88)

k=0

x2[k] =

w + b2σ2
σ2
e
1 − |a + bf |2 .

Proof: Note that

d[k + 1]

= z[k + 1] − x[k + 1]
= (az[k] + bgk(zk) + be[k] + w[k + 1] + v[k + 1])

− (ax[k] + bgk(zk) + be[k] + w[k + 1])

= a(z[k] − x[k]) + v[k + 1]

= ad[k] + v[k + 1].

The distortion experienced by the actuator can therefore be
thought of as the output of a linear dynamical system driven
by an input sequence {v[t]} satisfying (14). Therefore,

d[k] =

k−1
(cid:88)

n=0

anv[k − n],

where limT →∞

1
T

(cid:80)T

p=1 v2[p] = 0.

From the stability of a, it follows that

lim
T →∞

1
T

T −1
(cid:88)

k=0

d2[k] = 0.

(22)

Note that x[k] = z[k] − d[k]. Hence x2[k] = z2[k] + d2[k] −
2(γz[k])(γ−1d[k]). Now |2(γz[k])(γ−1d[k])| ≤ (γ2z2[k]) +
(γ−2d2[k]). Therefore,

lim
T →∞

1
T

T −1
(cid:88)

k=0

x2[k] ≤ lim
T →∞

1
T

T −1
(cid:88)

(1 + γ2)z2[k]

k=0
+ (1 + γ−2)d2[k].

8

Since the result is true for any γ > 0, taking the limit γ → 0
and noting that the mean-square of d is 0 gives

lim
T →∞

1
T

T −1
(cid:88)

k=0

x2[k] ≤ lim
T →∞

1
T

T −1
(cid:88)

k=0

z2[k].

(23)

Similarly, since z[k] = x[k] + d[k], we have z2[k] = x2[k] +
d2[k] + 2(γx[k])(γ−1z[k]). Repeating the same argument as
before, we have

lim
T →∞

1
T

T −1
(cid:88)

k=0

z2[k] ≤ lim
T →∞

1
T

T −1
(cid:88)

(1 + γ2)x2[k]

k=0
+ (1 + γ−2)d2[k].

Taking the limit as γ → 0, and noting that mean-square of d
is 0, the above reduces to

lim
T →∞

1
T

T −1
(cid:88)

k=0

z2[k] ≤ lim
T →∞

1
T

T −1
(cid:88)

k=0

x2[k].

(24)

The second result follows from (23) and (24). The third result
is immediate noting that the mean-square of {z} converges to
σ2
w+b2σ2
1−|a+bf |2 .

e

VI. ACTIVE DEFENSE FOR NETWORKED
CYBER-PHYSICAL SYSTEMS: THE SISO ARX CASE

The results developed in the previous section can be ex-
tended to a more general ARX system model. Speciﬁcally,
we consider a unit delay, strictly minimum phase, single-input,
single-output system described by

y[t + 1] = −

p
(cid:88)

m=0

amy[t − m] +

h
(cid:88)

r=0

bru[t − r] + w[t + 1],

(25)
where am, br, y[t], u[t], w[t] ∈ R, b0 (cid:54)= 0, and with {w[t]}
being zero-mean i.i.d. Gaussian process noise of variance σ2
w.
Let q−1 denote the backward shift operator. The above system
can equivalently be expressed as

A(q−1)y[t] = q−1B(q−1)u[t] + w[t],

(26)

where A(q−1) := 1 + a0q−1 + a1q−2 + ... + apq−(p+1), and
B(q−1) := b0+b1q−1+...+bhq−h, with B(q−1) being strictly
minimum phase, i.e., all its roots lie strictly outside the unit
circle.

We consider an honest actuator that is meant to, and imple-
ments the control policy {g}, and adds a private excitation {e}
as a defense. Unlike in the system considered in Section-V,
the output of the ARX system at any particular time depends
on the past inputs. Speciﬁcally, the output at any time instant
contains contributions of private excitation injected in the past.
Hence, simply injecting an i.i.d. sequence of Gaussian random
variables will not result in an output distribution that is i.i.d.
across time.

However, since the actuator knows the past values of the
private excitation, and also the transfer function of the sys-
tem, it can perform “pre-equalization” by ﬁltering the private
excitation sequence before injecting it into the system. The
ﬁlter, which we refer to as the pre-equalizer, has to be chosen

in such a way that the component of the private excitation that
appears in the output of the plant is an i.i.d. sequence of mean
0 and variance b2

e . We let

0σ2

e(cid:48)[t] := −

1
b0

(b1e(cid:48)[t − 1] + b2e(cid:48)[t − 2] + . . . + bhe(cid:48)[t − h]) + e[t],

where e[t] is i.i.d. and Gaussian of mean 0 and variance σ2
e .
Since the system is strictly minimum phase, this is a stable
generation of an excitation sequence [42].

With a pre-equalizer in place, the effective input applied by

the actuator is

u[t] = gt(zt) + e(cid:48)[t].

(27)

where {e(cid:48)}t is the output of the pre-equalizer, and zt is the
sequence of measurements reported by the sensor up to time
t. Therefore, the system evolves in closed-loop as

y[t + 1] = −

p
(cid:88)

m=0

amy[t − m] +

h
(cid:88)

r=0

brgt−r(zt−r)

+b0e[t] + w[t + 1],

(28)

where {e[t]} is a sequence of i.i.d. Gaussian random variables
with mean 0 and variance σ2
e . Hence, from the point of view
of actuator tests and associated results, the above problem is
similar to that described in Section-V.

We propose that the actuator perform the following tests to

check if the sensor is reporting the measurements honestly.

9

if the control law was designed to provide a certain mean-
square performance, then that is the value that is indeed
attained.

Proof: Omitted, since the proof follows the same se-

quence of arguments as the proof of Theorem 1.

In the following section, we extend the technique to systems
with arbitrary delay and colored noise, i.e., the more general
ARMAX model, see [44].

VII. ACTIVE DEFENSE FOR NETWORKED
CYBER-PHYSICAL SYSTEMS: THE SISO ARMAX CASE

A general ARMAX system with arbitrary but ﬁnite delay
is a model that is encountered often in process control. In
this section, we develop a Dynamic Watermarking scheme
to secure such systems. We show that by commanding the
actuator to inject private excitation whose spectrum is matched
to that of the colored process noise entering the system, it can
be ensured that a malicious sensor is constrained to distorting
the process noise, the only quantity unknown to the actuator,
by at most a zero-power signal. This amounts to a form
of Internal Model Principle [45] for Dynamic Watermarking,
and is a phenomenon that doesn’t emerge in the analysis of
a simple SISO or an ARX system treated in the previous
sections.

A general ARMAX system with ﬁnite delay l is described

1) Actuator Test 1: Check if the reported sequence of

by

measurements {z[t]} satisﬁes

lim
T →∞

1
T

T −1
(cid:88)

k=0

(z[k + 1] +

p
(cid:88)

m=0

amz[k − m]−

h
(cid:88)

r=0

brgk−r(zk−r) − b0e[k])2 = σ2

w. (29)

2) Actuator Test 2: Check if the reported sequence of

measurements {z[t]} satisﬁes

lim
T →∞

1
T

T −1
(cid:88)

(z[k + 1] +

k=0

p
(cid:88)

m=0

y[t] = −

p
(cid:88)

k=1

aky[t − k] +

h
(cid:88)

k=0

bku[t − l − k]

+

r
(cid:88)

k=0

ckw[t − k].

(32)

Without loss of generality, we assume that c0 = 1. Let q−1 be
the backward shift operator, so that q−1y[t] = y[t − 1]. Then,
the above system can be expressed as

amz[k − m]−

A(q−1)y[t] = q−lB(q−1)u[t] + C(q−1)w[t],

(33)

h
(cid:88)

r=0

brgk−r(zk−r))2 = (b2

0σ2

e + σ2

w). (30)

Consequently, Theorem 1 and Theorem 2 can be extended as
follows.

Theorem 3.

1) Let v[t + 1] := z[t + 1] + (cid:80)p

m=0 amz[k −
m] − (cid:80)h
r=0 brgk−r(zk−r) − b0e[t] − w[t + 1], so that for
an honest sensor which reports z[t] ≡ y[t], v[t] = 0 ∀t.
If {z[t]} passes tests (29) and (30), then,

lim
T →∞

1
T

T
(cid:88)

k=1

v2[k] = 0.

(31)

where a0 := 1, A(q−1) := a0+a1q−1+...+apq−p, B(q−1) :=
b0 + b1q−1 + ... + bhq−h, C(q−1) := c0 + c1q−1 + ... + crq−r,
and B(q−1) and C(q−1) are assumed to be strictly minimum
phase. To secure the system, the actuator applies the control

u[t] = ug[t] + B−1(q−1)C(q−1)e[t],

(34)

where ug[t]
is the control policy-speciﬁed input sequence
and {e} is a sequence of i.i.d Gaussian random variables
of zero mean and variance σ2
e , denoting the actuator node’s
private excitation. Since B(q−1) is assumed to be minimum
phase, (34) is a stable generation of the control input u[t].
Consequently, the output of the system obeys

2) If the malicious sensor is to remain undetected, the mean-
square performance of {y} is what the actuator believes it
is, which is the mean-square performance of {z}. Hence

A(q−1)y[t] = q−lB(q−1)ug[t] + q−lC(q−1)e[t]
+C(q−1)w[t],

(35)

implying that

p
(cid:88)

y[t] = −

aky[t − k] +

h
(cid:88)

k=0

bkug[t − l − k]

k=1
r
(cid:88)

+

k=0

cke[t − l − k] +

r
(cid:88)

k=0

ckw[t − k].

(36)

While the q−domain derivation is just formal,
difference equation can be obtained rigorously.

the above

Deﬁne λ[t] := e[t − l] + w[t]. Then, the output of the system

can be expressed as

10

Proof: From (38) and (39), one gets

r
(cid:88)

k=0

ck(cid:101)z[t − k] = z[t] +

p
(cid:88)

k=1

akz[t − k] −

h
(cid:88)

k=0

bkug[t − l − k]

=

r
(cid:88)

k=0

ckλ[t − k] + v[t].

(42)

Equivalently, assuming appropriate initial conditions, one has

C(q−1)(cid:101)z[t] = C(q−1)λ[t] + v[t].

y[t] = −

p
(cid:88)

k=1

aky[t − k] +

h
(cid:88)

k=0

bkug[t − l − k]

This gives

+

r
(cid:88)

k=0

ckλ[t − k].

(37)

where vf [t] := C −1(q−1)v[t]. Now,

(cid:101)z[t] = λ[t] + vf [t],

We now develop tests that the actuator should perform to
detect maliciousness of the sensor. The fundamental
idea
behind the tests is to check if the prediction-error of the
reported sequence {z} has the appropriate statistics. Specif-
ically, the actuator processes the reported measurements with
a prediction-error ﬁlter deﬁned through the following recursion
for all t ≥ 0.

(cid:101)z[t] = λ[t] + vf [t]

= w[t] + e[t − l] + vf [t].

(43)

Since {(cid:101)z} passes (40), we have from the above,

lim
T →∞

1
T

T −1
(cid:88)

k=0

(vf [k] + w[k])2 = σ2
w.

(44)

bkug[t − l − k]

This gives

zt|t−1 = −

+

akz[t − k] +

h
(cid:88)

k=0

ck(cid:101)z[t − k],

p
(cid:88)

k=1
r
(cid:88)

k=1

(cid:101)z[t] = z[t] − zt|t−1.

The ﬁlter is assumed to be initialized with (cid:101)z[−k] = λ[−k], k ∈
{−1, −2, ..., −r}. It is easy to verify that the above ﬁlter
produces (cid:101)z[t] ≡ λ[t] if z[t] ≡ y[t]. Based on this observation,
we propose that the actuator perform the following tests.

1) Actuator Test 1: The actuator checks if

(38)

(39)

lim
T →∞

1
T

T −1
(cid:88)

k=0

v2
f [k] + 2vf [k]w[k] = 0.

(45)

Since {(cid:101)z} also passes (41), we have

T −1
(cid:88)

(vf [k] + w[k] + e[k − l])2 = σ2

w + σ2
e .

(46)

k=0

lim
T →∞

1
T

This gives

lim
T →∞

1
T

T −1
(cid:88)

((cid:101)z[k] − e[k − l])2 = σ2
w.

k=0

(40)

lim
T →∞

1
T

T −1
(cid:88)

k=0

v2
f [k] + 2vf [k]w[k] + 2vf [k]e[k − l] = 0.

2) Actuator Test 2: The actuator checks if

lim
T →∞

1
T

T −1
(cid:88)

k=0

(cid:101)z2[k] = σ2

w + σ2
e .

(41)

The following theorem shows that the above tests sufﬁce to
ensure that a malicious sensor cannot introduce any distortion
beyond addition of a zero-power signal to the process noise.
i.e., a malicious sensor of only zero additive distortion power
can pass the above tests to remain undetected.
Theorem 4. Deﬁne v[t] := (cid:80)p
k=0 bkug[t −
l−k]−(cid:80)r
k=0 ckλ[t−k], so that for an honest sensor reporting
z ≡ y, v ≡ 0. If the sensor passes tests (40) and (41), then,

k=0 akz[t − k] − (cid:80)h

Combining the above with (45), we have

lim
T →∞

1
T

T −1
(cid:88)

k=0

vf [k]e[k − l] = 0.

(47)

Comparing (45) and (47) with (16) and (17), we see that
the ﬁltered distortion measure {vf } behaves the same way {v}
does in the white noise case. Proceeding the same way as in
the proof of Theorem 1, one arrives at

lim
T →∞

1
T

T −1
(cid:88)

k=0

v2
f [k] = 0.

(48)

lim
T →∞

1
T

T −1
(cid:88)

k=0

v2[k] = 0.

Since v[k] = C(q−1)vf [k], and C(q−1) is minimum phase, it
follows that limT →∞

k=0 v2[k] = 0.

(cid:80)T −1

1
T

VIII. ACTIVE DEFENSE FOR NETWORKED
CYBER-PHYSICAL SYSTEMS: SISO SYSTEMS WITH
PARTIAL OBSERVATIONS

In this section, we address SISO systems with noisy, partial
observations. We consider a pth order single input single
output system described by

x[t + 1] = Ax[t] + Bu[t] + w[t + 1],

y[t + 1] = Cx[t + 1] + n[t + 1].

(49)

(50)

where x[t] ∈ Rp, and A, B, and C are known matrices of
appropriate dimensions. The actuator, being honest, applies
the input

u[t] = gt(zt) + e[t],

(51)

where gt(zt) is the control policy-speciﬁed input, and e[t] ∼
N (0, σ2
e ) is a sequence of i.i.d random variables denoting the
actuator node’s private excitation. Consequently, the system
evolves as

x[t + 1] = Ax[t] + Bgt(zt) + be[t] + w[t + 1],
y[t + 1] = Cx[t + 1] + n[t + 1].

(52)

(53)

Let z[t] be the measurement reported by the sensor at time t.
Since the sensor can be malicious, z[t] need not equal y[t] for
every t.

The actuator performs Kalman ﬁltering on the reported

measurements {z} as follows.

(cid:98)xF (k + 1|k) = A(cid:98)xF (k|k) + Bgk(zk) + Be[k],

(54)

(cid:98)xF (k + 1|k + 1) = A(cid:98)xF (k|k) + Bgk(zk) + Be[k]
+KkνF [k + 1],

(55)

where νF [k + 1] := z[k + 1] − C(cid:98)xF (k + 1|k), denotes the
(possibly) faulty innovations computed by the actuator, and
Kk is the Kalman gain at time k.

We also deﬁne a Kalman ﬁlter that operates on the true

measurements y[t] as follows.

(cid:98)xR(k + 1|k) = A(cid:98)xR(k|k) + Bgk(zk) + Be[k],

(56)

(cid:98)xR(k + 1|k + 1) = A(cid:98)xR(k|k) + Bgk(zk) + Be[k]
+KkνR[k + 1],

(57)

where νR[k + 1] := y[k + 1] − C(cid:98)xR(k + 1|k) is the “real
innovations” or “true innovations” of the system. Of course,
the actuator cannot implement the latter Kalman ﬁlter since it
may not receive y[k] from the sensor.

We now deﬁne

v[k + 1] := (cid:98)xF (k + 1|k + 1) − A(cid:98)xF (k|k) − Bgk(zk)
−Be[k] − KkνR[k + 1],

(58)

so that for an honest sensor which reports z ≡ y, we have
ν ≡ νR and consequently, v ≡ 0. The actuator performs the
following two tests to detect maliciousness of the sensor.

11

1) Actuator Test 1: Actuator checks if

lim
T →∞

1
T

T −1
(cid:88)

k=0

e[k]((cid:98)xF (k + 1|k + 1) − A(cid:98)xF (k|k)

−Bgk(zk) − Be[k]) = 0

(59)

2) Actuator Test 2: Actuator checks if

lim
T →∞

1
T

T −1
(cid:88)

k=0

((cid:98)xF (k + 1|k + 1) − A(cid:98)xF (k|k) − Bgk(zk) − Be[k])
((cid:98)xF (k + 1|k + 1) − A(cid:98)xF (k|k) − Bgk(zk) − Be[k])T
= σ2
(60)

RKK T ,

where σ2
R denotes the variance of the true innovations process,
and K is the steady-state Kalman gain. We assume that
(A, C) is observable so that the algebraic Riccati equation
associated with the Kalman gain has a unique nonnegative
deﬁnite solution [42]. The following theorem shows that the
above tests sufﬁce to ensure that a malicious sensor of only
zero additive distortion power can pass the tests to remain
undetected.

Theorem 5. Suppose that the reported sequence of measure-
ments passes the tests (59) and (60). Then,

1)

lim
T →∞

1
T

T −1
(cid:88)

k=0

(cid:107)v[k + 1](cid:107)2 = 0.

(61)

Proof: Since the reported sequence of measurements

passes (59), we have

lim
T →∞

1
T

T −1
(cid:88)

k=0

e[k](KkνR[k + 1] + v[k + 1]) = 0.

Since the true innovations are independent of the zero-mean
private excitation, it follows that

lim
T →∞

1
T

T −1
(cid:88)

k=0

e[k]v[k + 1] = 0.

(62)

Since the reported sequence of measurements also passes (60),
we have

lim
T →∞

1
T

T −1
(cid:88)

(KkνR[k + 1] + v[k + 1])

k=0

(KkνR[k + 1] + v[k + 1])T = σ2

RKK T .

Simplifying, the above gives

lim
T →∞

1
T

T −1
(cid:88)

(KkνR[k + 1]vT [k + 1])

k=0

+ (KkνR[k + 1]vT [k + 1])T + (v[k + 1]vT [k + 1]) = 0.

(63)

R , (cid:98)xk|k
F , zk, ek−2, yk−1), where
We deﬁne Sk
(cid:98)xk|k
R := {(cid:98)xR(k|k), (cid:98)xR(k − 1|k − 1), ..., (cid:98)xR(−1| − 1)}, and

:= σ((cid:98)xk|k

is deﬁned likewise. Deﬁne (cid:98)νR[k] := E[νR[k](cid:12)

(cid:98)xk|k
the Kalman ﬁltering equations, we have

F

(cid:12)Sk]. From

Kk−1νR[k] = (cid:98)xR(k|k) − A(cid:98)xR(k − 1|k − 1)
−Bgk−1(zk−1) − Be[k − 1]

implying that

R

((cid:98)xk−2|k−2

, (cid:98)xk|k
F , ek−2, yk−1) →
((cid:98)xR(k − 1|k − 1), (cid:98)xR(k|k), zk) → νR[k]
a Markov
R , (cid:98)xk|k
(cid:12)σ((cid:98)xk|k

forms
E[νR[k](cid:12)
1|k − 1), (cid:98)xR(k|k), zk)]. Therefore, we have

F , zk, ek−2, yk−1)] = E[νR[k](cid:12)

Therefore,

chain.

(cid:98)νR[k]

:=
(cid:12)σ((cid:98)xR(k −

(64)

RKk−1K T

RKk−1K T

Kk−1(cid:98)νR[k] = Kν(Kk−1νR[k] + Be[k − 1]),
k−1 + σ2
k−1(σ2

e BBT )−1.
where Kν := σ2
:= Kk−1νR[k] − Kk−1(cid:98)νR[k]. Then,
Deﬁne Kk−1(cid:101)νR[k]
(Kk−1(cid:101)νR[k −1], Sk) is a martingale difference sequence. This
is because, (cid:101)νR[k − 1] ∈ Sk, and
E[(cid:101)νR[k](cid:12)
Also, v[k] ∈ Sk. Hence, MST applies, and we have

(cid:12)Sk] = 0.

T
(cid:88)

Kk−1(cid:101)νR[k]vT [k] =

k=1

o((cid:80)T −1
o((cid:80)T −1





o((cid:80)T −1

k=0 v2
k=0 v2
...
k=0 v2

1[k + 1])
1[k + 1])

1[k + 1])

. . .
. . .

. . .
. . .

o((cid:80)T −1
o((cid:80)T −1

k=0 v2
k=0 v2
...
k=0 v2

o((cid:80)T −1

p[k + 1])
p[k + 1])

p[k + 1])









+ O(1),

(65)

where vi[k] denotes the ith component of v[k]. Now, since
KkνR[k] = Kk(cid:98)νR[k] + Kk(cid:101)νR[k], from (64), we have

Kk−1νR[k] = (I − Kν)−1Be[k − 1]
+(I − Kν)−1Kk−1(cid:101)νR[k].

(66)

Substituting this in (63) and equating the diagonals using (62)
and (65) completes the proof.

IX. ACTIVE DEFENSE FOR NETWORKED
CYBER-PHYSICAL SYSTEMS: MIMO SYSTEMS WITH
GAUSSIAN NOISE

In this section, we investigate multiple-input-multiple-
output (MIMO) linear stochastic dynamical systems. They
pose additional challenges as compared to SISO systems since
malicious sensors in a MIMO system can attempt to collude
so as to prevent the other nodes from detecting their presence.
In this section, we show how the actuators can prevent the
malicious nodes from introducing “excessive” distortion, lest
they expose their presence.

An m input MIMO Linear Dynamical System of order n is

12

with covariance matrix σ2
is perfectly observed.

wIn. We consider the case where x

Let z[t] be the measurements reported by the sensors to
the other nodes in the system. Note that since the nodes in
the system are allowed to exchange reported measurements
among them, all malicious sensors have to be consistent and
report the same (but possibly erroneous) measurements to all
honest nodes in the system. A history-dependent control policy
is assumed to be in place, which dictates that the ith input to
the system at time t be

ug
i [t] = gi

t(zt).

(68)

As reasoned before, to secure the system, each actuator
superimposes on the input speciﬁed by the control policy, an
additional zero-mean private excitation that it draws from a
distribution, here Gaussian, that is made public. It should be
noted that while the distribution is made public, the actual
values of the excitation are not revealed by the actuator to any
other node. The private excitation value drawn at each time t
is chosen to be independent of its private excitation values at
all the other time instants, of the private excitation values of
other actuator nodes, and of the control policy-speciﬁed input.
Therefore, actuator i applies at time t the input
ui[t] = ug
t(zt) + ei[t],
i [t] + ei[t] = gi
where ei[t] ∼ N (0, σ2
e ) is independent of ej[k] for (j, k) (cid:54)=
(i, t), x[m], z[m] for m ≤ t, and w[n] for all n. We assume
that all actuators are honest, meaning that they apply control
inputs in accordance to (69).

(69)

We propose the following tests to be performed by each

actuator i.

1) Actuator Test 1: Actuator i checks if the reported

sequence of measurements {z} satisﬁes

lim
T →∞

1
T

T −1
(cid:88)

(z[k + 1] − Az[k] − Bgk(zk))

k=0

(z[k + 1] − Az[k] − Bgk(zk))T = σ2

e BBT + σ2

wIn

(70)

2) Actuator Test 2: Actuator i checks if the reported

sequence of measurements {z} satisﬁes

lim
T →∞

1
T

T −1
(cid:88)

k=0

ei[k](z[k + 1] − Az[k] − Bgk(zk))

= B·,iσ2
e

(71)

In Actuator Test 2, we have simpliﬁed the test to directly check
the quantity that is important, which in this is case is the
analog of (12). We note that for any set of conditions to be an
admissible test, they have to be (i) checkable by the sensors
and actuators based on their observations and what is reported
to them, and (ii) satisﬁed if all parties are honest. The above
two conditions satisfy these two conditions.

described by

Deﬁne

x[t + 1] = Ax[t] + Bu[t] + w[t + 1]

(67)

v[t + 1] := z[t + 1] − Az[t] − Bgt(zt) − Be[t] − w[t + 1],

where x[t] ∈ Rn, u[t] ∈ Rm, A ∈ Rn×n, B ∈ Rn×m, and
{w} is a zero-mean i.i.d. sequence of Gaussian random vectors

so that if z[t] ≡ x[t], v[t] ≡ 0. It is easy to see that as in the
case of SISO systems, the sequence {v} has the intepretation

as the additive distortion of the process noise deliberately
introduced by the malicious sensors. We term the quantity

lim
T →∞

1
T

T
(cid:88)

||v[k]||2

k=1
the additive distortion power of the malicious sensors. The
following theorem, akin to Theorem 1, proves that malicious
sensors of only zero additive distortion power can pass the
above tests, thereby remaining undetected.

Theorem 6. Suppose that the reported sequence of measure-
ments passes the tests (70), and (71). If B is of rank n, then,

lim
T →∞

1
T

T
(cid:88)

k=1

||v[k]||2 = 0.

(72)

Proof: Since {z} satisﬁes

(71), we have, ∀i ∈

{1, 2, ..., m},

lim
T →∞

1
T

T
(cid:88)

k=1

ei[k](Be[k] + w[k + 1] + v[k + 1])

= σ2

e B·(i).

It follows that for all i ∈ {1, 2, · · · , m},

lim
T →∞

1
T

T
(cid:88)

k=1

ei[k]v[k + 1] = 0.

(73)

Therefore,

lim
T →∞

1
T

T
(cid:88)

k=1

e[k]vT [k + 1] = 0.

Since {z} also satisﬁes (70), we have,

lim
T →∞

1
T

T −1
(cid:88)

(Be[k] + w[k + 1] + v[k + 1])

k=0

(Be[k] + w[k + 1] + v[k + 1])T = σ2

e BBT + σ2

wIn

13

w(σ2

where KW := σ2
wI)−1. Now deﬁne (cid:101)w[k] :=
w[k] − (cid:98)w[k]. Then, ( (cid:101)w[k − 1], Sk) is a martingale difference
sequence. This is because (cid:101)w[k − 1] ∈ Sk, and

e BBT + σ2

E[ (cid:101)w[k](cid:12)
Also, v[k] ∈ Sk. Hence, MST applies, and we have

(cid:12)Sk] = 0.

(78)

T −1
(cid:88)

(cid:101)w[k + 1]vT [k + 1] =

k=0

o((cid:80)T −1
o((cid:80)T −1





o((cid:80)T −1

k=0 v2
k=0 v2
...
k=0 v2

1[k + 1])
1[k + 1])

1[k + 1])

. . .
. . .

. . .
. . .

o((cid:80)T −1
o((cid:80)T −1

k=0 v2
k=0 v2
...
k=0 v2

o((cid:80)T −1

p[k + 1])
p[k + 1])

p[k + 1])









+ O(1),

(79)

where vi[k + 1] denotes the ith element of v[k + 1].

Using the above, we have

w[k + 1] = (cid:98)w[k + 1] + (cid:101)w[k + 1]

= KW (Be[k] + w[k + 1]) + (cid:101)w[k + 1].

(80)

From the assumption on the rank of B, it follows that KW has
all eigenvalues strictly lesser than unity. Therefore, simplifying
the above,

w[k + 1] = (I − KW )−1KW Be[k]
+(I − KW )−1
(cid:101)w[k + 1].

(81)

(74)

Substituting this into (76), using (74) and (79), and equating
the qth entry along the diagonal, we have

T −1
(cid:88)

k=0

v2
q [k + 1] + o(

T −1
(cid:88)

k=0

v2
q [k + 1]) = o(T ).

(82)

Since this is true for all q ∈ {1, 2, ..., p}, dividing the above
by T and taking the limit as T → ∞ completes the proof.

(75)

Using (74) and the fact that the process noise w[k+1], and the
private excitation of the actuators at time k are independent,
the above simpliﬁes to

lim
T →∞

1
T

T −1
(cid:88)

k=0

(w[k + 1]vT [k + 1]) + (w[k + 1]vT [k + 1])T

(v[k + 1]vT [k + 1]) = 0.

(76)

Deﬁne Sk := σ(xk, zk, ek−2), and (cid:98)w[k] := E[w[k](cid:12)

(cid:12)Sk].

Since

w[k] = x[k] − Ax[k − 1] − Bgk−1(zk−1) − Be[k − 1]),

we have

(xk−2, ek−2) → (x[k − 1], x[k], zk) → w[k]

(cid:98)w[k]
(cid:12)σ(xk−2, ek−2, x[k − 1], x[k], zk)] = E[w[k](cid:12)

chain. Consequently,

a Markov

forming
E[w[k](cid:12)
1], x[k], zk)]. Therefore,

:=
(cid:12)σ(x[k −

(cid:98)w[k] = KW (Be[k − 1] + w[k]),

(77)

X. EXTENSION TO NON-GAUSSIAN SYSTEMS

The results developed in the previous sections assumed
that the process noise follows a Gaussian distribution. This
assumption can be relaxed to a certain extent. In this section,
we illustrate how this may be relaxed for a single-input-single-
output system.

Consider a SISO system described by

x[t + 1] = ax[t] + bu[t] + w[t],

(83)

where w[t] ∼ PW is an i.i.d. process with mean 0 and variance
σ2
w. In such a case, the actuator can choose the distribution
of its private excitation such that the output of the private
excitation has the same distribution as the process noise.
Hence, the actuator applies to the system the input

u[t] = gt(zt) + e[t],

(84)

where be[t] ∼ PW is an i.i.d. sequence. As before, even though
the actuator implements the control policy {g}, the policy is
applied to the measurements z[t] reported by the sensor, which

could differ from the true output x[t]. Therefore, the system
evolves in closed-loop as

x[t + 1] = ax[t] + bgt(zt) + be[t] + w[t].

(85)

The actuator then performs the following tests to check if

the sensor is malicious or not.

1) Actuator Test 1: Check if the reported sequence of

measurements {z[t]} satisﬁes

lim
T →∞

1
T

= σ2
w.

T −1
(cid:88)

(z[k + 1] − az[k] − bgk(zk) − be[k])2

k=0

(86)

2) Actuator Test 2: Check if the reported sequence of

measurements {z[t]} satisﬁes

T −1
(cid:88)

(z[k + 1] − az[k] − bgk(zk))2

k=0

lim
T →∞

1
T

= 2σ2
w.

(87)

As before, let

v[t + 1] := z[t + 1] − az[t] − bgt(zt) − be[t] − w[t + 1],

so that for an honest sensor which reports z[t] ≡ x[t], v[t] =
0 ∀t. The additive distortion power of a malicious sensor too
is deﬁned as before, i.e., as

lim
T →∞

1
T

T
(cid:88)

k=1

v2[k].

The following result, a generalization of Theorem 1, shows
that the above tests sufﬁce to ensure that a malicious sensor
of only zero effective power can remain undetected.

Theorem 7. If {z[t]} satisﬁes tests (86) and (87), then,

lim
T →∞

1
T

T
(cid:88)

k=1

v2[k] = 0.

(88)

Proof: Following the same sequence of arguments as in
the proof of Theorem 1, we arrive at the following equalities:

lim
T →∞

1
T

T
(cid:88)

k=1

v2[k] + lim
T →∞

1
T

T
(cid:88)

k=1

2v[k]w[k] = 0,

(89)

lim
T →∞

1
T

T
(cid:88)

k=1

e[k − 1]v[k] = 0.

(90)

:= E[w[k](cid:12)

Let Sk

:= σ(xk, zk, ek−2), and (cid:98)w[k]

(cid:12)Sk].
The general complication is that due to non-Gaussianity, the
conditional mean estimate may be non-linear in e[k − 1] and
w[k], unlike in the Gaussian case. However, since the sequence
of observations are i.i.d., and the distribution of the actuator’s
private excitation is chosen to be the same as the distribution
of the process noise, we have

(cid:98)w[k] =

1
2

(be[k − 1] + w[k]) = β(be[k − 1] + w[k]),

(91)

14

where β := 1

2 . This can be written as

(cid:98)w[k] = αe[k − 1] + βw[k],

where α := bβ. Let (cid:101)w[k] := w[k] − (cid:98)w[k].

Now, the following result also holds following the same
sequence of arguments employed in the proof of Theorem 1:

T
(cid:88)

k=1

v[k] (cid:101)w[k] = o(

T
(cid:88)

k=1

v2[k]) + O(1).

(92)

Hence, following similar arguments as in the proof of

Theorem 1, we obtain

T
(cid:88)

k=1

v2[k] +

T
(cid:88)

k=1

2v[k]w[k] = (1 + o(1))(

T
(cid:88)

v2[k]) + O(1).

k=1

Dividing the above equation by T , taking the limit as T → ∞,
and invoking (89) completes the proof.
Remark: The net import of this result is that in order to
safeguard against malicious actions of the sensor we need to
add a level of noise exactly equal to the process noise already
present in the system. Hence there is an ampliﬁcation of the
2 that appears the price
process noise’s standard deviation by
of guarding against malicious attack by the sensor. In contrast,
in the Gaussian case, we have seen that this extra cost can be
made as small as desired by choosing σ2
e as small as desired,
though of course at the cost of delaying detection with an
acceptable false alarm probability, as we discuss in the next
section.

√

XI. STATISTICAL TESTS FOR ACTIVE DEFENSE

The results developed in the previous sections are couched
in an asymptotic fashion. They characterize what can be
detected and how that may be done. These asymptotic charac-
terizations can be used to develop statistical tests that reveal
malicious activity in a ﬁnite period of time with acceptable
false alarm rates.

Yet another test

The task at hand is to develop statistical tests equivalent to
asymptotic tests such as (12), (13), (70), (71), which include
tests for covariance matrices of certain random vectors. This
problem has been addressed in [46] in the context of fault
detection in control systems, in which the innovation sequence
is tested for the properties of whiteness, mean, and covariance.
Since these are also the properties that have to be satisﬁed by
the test sequences that we construct in (12), (13), and (71),
the same test described in [46] can be used.
that

is particularly well-suited for the
problem at hand is the sequential probability ratio test, intro-
duced in [47]. In the standard setting of sequential hypothesis
testing, for each time t, the set of all possible observations
Sm (or the space of sufﬁcient statistics) is partitioned into
three sets R0, R1, R. At each time t, a decision is made
whether to select the null hypothesis (and stop), select the the
alternative hypothesis (and stop), or continue observing. The
null (alternative) hypothesis is accepted and hypothesis testing
is stopped if at some time t, the observations available till
time t, denoted by {zt
s}, fall in the set R0 (R1). Hypothesis
testing is continued at time t if {zt
s} falls in R. One such

sequential test is the sequential probability ratio test presented
in [47], where the likelihood ratio of observations up to time
t, denoted by Λt, is compared against two thresholds τ1 and
τ2. The null (alternative) hypothesis is accepted at time t if
Λt < τ1 (Λt > τ2). If τ1 ≤ Λt ≤ τ2, another observation is
drawn, and the process repeats.

There are a few aspects where the problem at hand departs
from the above. These are enumerated below. In what follows,
the null hypothesis is that the control system is not under
attack.

1) In the problem of secure control, it is not possible to
attribute a distribution (or even a parameterized, ﬁnite-
dimensional family of distributions) from which the ob-
servations would occur under the alternative hypothesis
(that the control system is under attack). Consequently,
a likelihood ratio cannot be deﬁned, and the sequential
probability ratio test cannot be used. Hence, the problem
at hand is not to test one hypothesis against another, but
is only that of rejecting the null hypothesis or otherwise.
2) In the classical setup as described in [47], in a ﬁnite time
and with probability 1, the test stops, and one hypothesis
or the other is accepted. However, the adversary could be
a “sleeper agent”. It could behave as an honest party for
a long period of time, and then operate in a malicious
manner. Hence in our situation, at no time can one
“accept” the null hypothesis forever for all subsequent
time. Therefore, in the systems of interest here, there are
only two possible decisions at any time t, reject the null
hypothesis or continue observations.

3) In the classical setting, optimal performance is obtained
by considering all observations that are available up to the
time of making a decision. However, in our problem, an
adversary that behaves maliciously in a bursty fashion, is
not likely to be detected since long term averaging would
nullify these effects. In order to account for this, a moving
window approach could be employed over which a test
statistic can be calculated. That is, the statistical test is
conducted over a window of l observations, nl ≤ t <
(n + 1)l. In each window it assesses whether to reject
the null hypotheses. In this manner, malicious activity
can be detected within l samples, with acceptable false
alarm rate. The choice of the excitation variance σ2
e can
be based on the acceptable detection delay l, and the false
alarm rate.

15

addressed in Section-VI. Speciﬁcally, we consider a second
order plant of the type common in process control. A single-
input, single-output stable plant obeying (25), with parameters
a0 = 0.7, a1 = 0.2, b0 = 1, b1 = 0.5 and σ2
w = 1 is
considered. Note that the chosen system is minimum phase, so
that the pre-equalizer required to ﬁlter the sequence of private
excitation is stable.

The sensor is assumed to be initially well-behaved, but
suddenly become malicious after a certain period (denoting
the time of initiation of attack), while the actuator is assumed
to remain uncompromised. The actuator applies control inputs

u[k] = −

1
b0

(a0z[t] + a1z[t − 1] + b1u[k − 1]) + e[k],

where z[k] is the measurement reported by the sensor at time
k, and e[k] ∼ i.i.d. N (0, 1) is the actuator node’s private
excitation. Therefore, the system evolves as

y[k + 1] = 0.7(y[k] − z[k]) + 0.3(y[k − 1] − z[k − 1])

+e[k] + w[k + 1].

The adversary attacks the system at some random time and
begins to report false measurements. In order to do so, the
adversary estimates optimally the process noise at each instant
from the measurements that it observes. Since the process
noise and the private excitation have the same variance, the
optimal estimate is simply 1
2 (y[k + 1] − 0.7(y[k] − z[k]) −
0.3(y[k −1]−z[k −1]). Once the adversary forms its estimate,
it adds a noise correlated with the estimate as follows. The
adversary forms v[t] = n[t] − (cid:98)w[t], where n[t] ∼ N (0, 1), the
same distribution as w[t], and reports z[t] = x[t] + v[t]. Note
that in the absence of dynamic watermarking, employing this
strategy would enable the adversary to form perfect estimates
of the process noise, and consequently, as reasoned in Section-
IV, would render every detection algorithm useless.

Fig. 3 plots the evolution of the negative log likelihood
function over time when dynamic watermarking is employed.
In our simulation, the adversary initiates attack at time epoch
4500. As indicated in Fig. 3, the (windowed) negative log
likelihood function corresponding to (29) stays within limits
the likelihood
until
function steadily increases, indicating the onset of an attack.
Based on tolerable false alarm rates, an appropriate detection
threshold can be set.

the attack. Around time epoch 4500,

Based on the above, the basis of a statistical hypothesis test
for the problem can be chosen as follows. Under the null
hypothesis, the sample covariance matrix follows the Wishart
distribution [48] (the multidimensional counterpart of the Chi-
squared distribution). Hence, for a given false alarm rate α, the
threshold τ (α) can be determined for the likelihood function
of the observations, where the likelihood function considered
for the test at time t is the probability density evaluated at the
l most recent observations. If this likelihood function exceeds
the threshold at any time t, an alarm is raised. If not, the test
is repeated for the next time instant. The following simulation
example is illustrative.

Example: We consider the scenario of an ARX system

XII. CONCLUSION

In this paper, we have considered the fundamental problem
of security of networked cyber-physical systems. Securing
such systems is not the same as securing a communication
network due to the fundamental role played by sensors and
actuators in interfacing with and controlling the physical
plant. We have provided a general procedure for dynamic
watermarking that imposes private excitation signals on the
actuation signals whose presence can then be traced around
the loop to detect malicious behaviors of sensors.

We have only explored the tip of the iceberg of this
procedure. It can be used in more general contexts for a variety
of plants of interest in control systems such as process control

16

[6] J. T. Brassil, S. Low, N. F. Maxemchuk, and L. O. Gorman, “Electronic
marking and identiﬁcation techniques to discourage document copying,”
IEEE Journal on Selected Areas in Communications, vol. 13, no. 8, pp.
1495–1504, 1995.

[7] F. Hartung and M. Kutter, “Multimedia watermarking techniques,”

Proceedings of the IEEE, vol. 87, no. 7, pp. 1079–1107, 1999.

[8] A. Z. Tirkel, G. Rankin, R. Van Schyndel, W. Ho, N. Mee, and C. F.
Osborne, “Electronic watermark,” Digital Image Computing, Technology
and Applications (DICTA93), pp. 666–673, 1993.

[9] “President’s Commission on Critical Infrastructure Protection. Critical
[Online].

Foundations: Protecting America’s Infrastructures,” 1997.
Available: https://www.fas.org/sgp/library/pccip.pdf

[10] Y. Y. Haimes, N. C. Matalas, J. H. Lambert, B. A. Jackson, and J. F. R.
Fellows, “Reducing vulnerability of water supply systems to attack,”
Journal of Infrastructure Systems, vol. 4, no. 4, pp. 164–177, 1998.
[Online]. Available: http://dx.doi.org/10.1061/(ASCE)1076-0342(1998)
4:4(164)

and

[11] M.
tics
pp.
vol.
http://dx.doi.org/10.1080/13523260312331271839

E. Goldman,
information warfare,” Contemporary

Bishop
of
24,

113–139,

2003.

“The

no.

1,

strategy

and
tac-
Security Policy,
[Online]. Available:

Figure 3. Sequential Hypothesis Testing for Attack Detection

systems where more nonlinear models may be of interest.
Further study into performance of ﬁnite-time tests for Dynamic
Watermarking would also be of practical interest.

There is much to be done in this area if cyber-physical
system applications are to proliferate to address critical in-
frastructural and societal needs.

Notation: This paper uses the following notation.

ADDENDUM

• Scalars are denoted using lowercase: a
• Vectors are denoted using lowercase boldface: x
• The ith component of vector x: xi
• Matrices are denoted using uppercase: A
• The ith column of matrix A: A·i
• The ith row of matrix A: Ai·
• The submatrix of A formed by the intersection of rows i

through j and columns p through q: Ai:j,p:q

• The matrix with ith column of A removed: A·(−i)
• The matrix with ith row of A removed: A(−i)·
• The vector with ith component of x removed: x−i

ACKNOWLEDGMENTS

The authors would like to thank Bruno Sinopoli (CMU),
Yilin Mo (NTU) and Sean Weerakkody (CMU) for their
valuable comments.

REFERENCES

[1] A. Cardenas, S. Amin, B. Sinopoli, A. Giani, A. Perrig, and S. Sastry,
“Challenges for securing cyber physical systems,” in Workshop on future
directions in cyber-physical systems security, 2009.

[2] Y. Mo, T. H.-J. Kim, K. Brancik, D. Dickinson, H. Lee, A. Perrig, and
B. Sinopoli, “Cyber-physical security of a smart grid infrastructure,”
Proceedings of the IEEE, vol. 100, no. 1, pp. 195–209, 2012.

[3] M. Abrams and J. Weiss, “Malicious control system cyber security attack
case study-Maroochy water services, Australia,” Technical Report, 2008.
[4] R. Langner, “Stuxnet: Dissecting a cyberwarfare weapon,” Security &

Privacy, IEEE, vol. 9, no. 3, pp. 49–51, 2011.

[5] S. Staniford, V. Paxson, and N. Weaver, “How to own the internet in your
spare time,” in Proceedings of the 11th USENIX Security Symposium.
Berkeley, CA, USA: USENIX Association, 2002, pp. 149–167.
[Online]. Available: http://dl.acm.org/citation.cfm?id=647253.720288

[12] K. Barnes and B. Johnson, “Introduction to SCADA: Protection and
vulnerabilities,” Technical Report INEEL/EXT-04-01710, Idaho National
Engineering and Environmental Laboratory, 2004.

[13] Y. Y. Haimes, “Risk of terrorism to cyber-physical and organizational-
infrastructures,” Public Works Management and Policy,
[Online]. Available: http:

societal
vol. 6, no. 4, pp. 231–240, 2002.
//pwm.sagepub.com/content/6/4/231.abstract

[14] D. Watts, “Security and vulnerability in electric power systems,” 35th

North American Power Symposium, pp. 559–566, 2003.

[15] A. S. Brown, “SCADA vs. the hackers,” Mechanical Engineering, vol.

124, no. 12, p. 37, 2002.

[16] J. Eisenhauer, P. Donnelly, M. Ellis, and M. O’Brien, “Roadmap to
secure control systems in the energy sector,” Energetics Incorporated.
Sponsored by the U.S. Department of Energy and the U.S. Department
of Homeland Security, January 2006.

[17] “Roadmap to secure control systems in the water sector,” March
2006. [Online]. Available: http://www.awwa.org/Portals/0/ﬁles/legreg/
Security/SecurityRoadmap.pdf

[18] “Roadmap to secure control systems in the chemical sector,” September
2009. [Online]. Available: https://scadahacker.com/library/Documents/
Roadmaps/Roadmap%20to%20Secure%20Control%20Systems%20in%
20the%20Chemical%20Sector.pdf

[19] “Roadmap to secure control systems in the transportation sector,”
[Online]. Available: https://ics-cert.us-cert.gov/sites/

August 2012.
default/ﬁles/ICSJWG-Archive/TransportationRoadmap20120831.pdf
[20] A. A. Cardenas, S. Amin, and S. Sastry, “Secure control: Towards sur-
vivable cyber-physical systems,” in The 28th International Conference
on Distributed Computing Systems Workshops.

IEEE, 2008.

[21] J. Ponniah, Y.-C. Hu, and P. R. Kumar, “A clean slate approach to
secure wireless networking,” Foundations and Trends in Networking,
vol. 9, no. 1, pp. 1–105, 2014. [Online]. Available: http://dx.doi.org/10.
1561/1300000037

[22] A. A.

Cardenas,
challenges
for
line]. Available:
full papers/cardenas/cardenas html/hotsecHTML.html

“Research
the
[On-
https://www.usenix.org/legacy/events/hotsec08/tech/

S. Amin,
security

S.
control

systems.”

Sastry,

and

of

[23] L. Schenato, B. Sinopoli, M. Franceschetti, K. Poolla, and S. S.
Sastry, “Foundations of control and estimation over lossy networks,”
Proceedings of the IEEE, vol. 95, no. 1, pp. 163–187, 2007.

[24] B. Sinopoli, L. Schenato, M. Franceschetti, K. Poolla, and S. Sastry,
“Optimal linear LQG control over lossy networks without packet ac-
knowledgment,” Asian Journal of Control, vol. 10, no. 1, pp. 3–13,
2008.

[25] V. Gupta, B. Hassibi, and R. M. Murray, “Optimal LQG control across
packet-dropping links,” Systems & Control Letters, vol. 56, no. 6, pp.
439–446, 2007.

[26] N. Elia and S. K. Mitter, “Stabilization of linear systems with limited
information,” IEEE Transactions on Automatic Control, vol. 46, no. 9,
pp. 1384–1400, 2001.

[27] X. Liu and A. Goldsmith, “Kalman ﬁltering with partial observation
losses,” in 43rd IEEE Conference on Decision and Control, vol. 4.
IEEE, 2004.

[28] S. Amin, A. A. C´ardenas, and S. S. Sastry, “Safe and secure networked
control systems under denial-of-service attacks,” in Hybrid Systems:
Computation and Control. Springer, 2009.

Time in Epochs0200040006000800010000Negative Log Likelihood Function00.511.522.5317

P. R. Kumar B. Tech.
(IIT Madras, 73),
D.Sc.(Washington University, St. Louis, 77), was
a faculty member at UMBC (1977-84) and Univ.
of Illinois, Urbana-Champaign (1985-2011). He is
currently at Texas A&M University. His current re-
search is focused on stochastic systems, energy sys-
tems, wireless networks, security, automated trans-
portation, and cyberphysical systems. He is a mem-
ber of the US National Academy of Engineering and
The World Academy of Sciences. He was awarded
a Doctor Honoris Causa by ETH, Zurich. He has
received the IEEE Field Award for Control Systems, the Donald P. Eckman
Award of the AACC, Fred W. Ellersick Prize of the IEEE Communications
the
Society,
Infocom Achievement Award, and the SIGMOBILE Test-of-Time Paper
Award. He is a Fellow of IEEE and ACM Fellow. He was Leader of the
Guest Chair Professor Group on Wireless Communication and Networking at
Tsinghua University, is a D. J. Gandhi Distinguished Visiting Professor at IIT
Bombay, and an Honorary Professor at IIT Hyderabad. He was awarded the
Distinguished Alumnus Award from IIT Madras, the Alumni Achievement
Award from Washington Univ., and the Daniel Drucker Eminent Faculty
Award from the College of Engineering at the Univ. of Illinois.

the Outstanding Contribution Award of ACM SIGMOBILE,

[29] Y. Mo, E. Garone, A. Casavola, and B. Sinopoli, “False data injection
attacks against state estimation in wireless sensor networks,” in 49th
IEEE Conference on Decision and Control (CDC).

IEEE, 2010.

[30] C.-Z. Bai, F. Pasqualetti, and V. Gupta, “Security in stochastic control
systems: Fundamental limitations and performance bounds,” American
Control Conference, pp. 195–200, 2015.

[31] H. Fawzi, P. Tabuada, and S. Diggavi, “Secure state-estimation for
dynamical systems under active adversaries,” in 49th Annual Allerton
Conference on Communication, Control, and Computing (Allerton).
IEEE, 2011.

[32] Y. Mo and B. Sinopoli, “Secure control against replay attacks,” in
47th Annual Allerton Conference on Communication, Control, and
Computing, Sept 2009.

[33] Y. Mo, R. Chabukswar, and B. Sinopoli, “Detecting integrity attacks on
SCADA systems,” IEEE Transactions on Control Systems Technology,
vol. 22, no. 4, pp. 1396–1407, 2014.

[34] Y. Mo, S. Weerakkody, and B. Sinopoli, “Physical authentication of con-
trol systems: Designing watermarked control inputs to detect counterfeit
sensor outputs,” IEEE Control Systems, vol. 35, no. 1, pp. 93–109, Feb
2015.

[35] S. Weerakkody, Y. Mo, and B. Sinopoli, “Detecting integrity attacks
on control systems using robust physical watermarking,” in 53rd IEEE
Conference on Decision and Control, Dec 2014, pp. 3757–3764.
[36] F. Miao, M. Pajic, and G. J. Pappas, “Stochastic game approach for
replay attack detection,” in 2013 IEEE 52nd Annual Conference on
Decision and Control (CDC).

IEEE, 2013.

[37] A. Teixeira, I. Shames, H. Sandberg, and K. Johansson, “Revealing
stealthy attacks in control systems,” in 50th Annual Allerton Conference
on Communication, Control, and Computing (Allerton), Oct 2012.
[38] S. Gisdakis, T. Giannetsos, and P. Papadimitratos, “Shield: A
data veriﬁcation framework for participatory sensing systems,” in
Proceedings of the 8th ACM Conference on Security & Privacy in
Wireless and Mobile Networks, ser. WiSec ’15. New York, NY, USA:
ACM, 2015. [Online]. Available: http://doi.acm.org/10.1145/2766498.
2766503

[39] J. Ponniah, Y.-C. Hu, and P. Kumar, “A system-theoretic clean slate
approach to provably secure ad hoc wireless networking,” IEEE Trans-
actions on Control of Network Systems, To Appear.

[40] I.-H. Hou, V. Borkar, and P. Kumar, “A theory of qos for wireless,” in

IEEE INFOCOM.

IEEE, 2009.

[41] R. Kalman, “On the general theory of control systems,” IRE Transactions

on Automatic Control, vol. 4, no. 3, pp. 110–110, Dec 1959.

[42] P. R. Kumar and P. Varaiya, Stochastic Systems: Estimation, Identiﬁca-
tion and Adaptive Control. Upper Saddle River, NJ, USA: Prentice-Hall,
Inc., 1986.

[43] T. L. Lai and C. Z. Wei, “Least squares estimates in stochastic regression
models with applications to identiﬁcation and control of dynamic
systems,” The Annals of Statistics, pp. 154–166, 1982.

[44] K. J. ˚Astrom, Introduction to Stochastic Control. New York: Academic

Press, 1970, 1970.

[45] B. A. Francis and W. M. Wonham, “The internal model principle of
control theory,” Automatica, vol. 12, no. 5, pp. 457–465, 1976.
[46] R. K. Mehra and J. Peschon, “An innovations approach to fault detection
and diagnosis in dynamic systems,” Automatica, vol. 7, no. 5, pp. 637–
640, 1971.

[47] A. Wald, “Sequential tests of statistical hypotheses,” The Annals of

Mathematical Statistics, vol. 16, no. 2, pp. 117–186, 1945.

[48] T. W. Anderson, An introduction to multivariate statistical analysis.

Wiley New York, 1958, vol. 2.

Bharadwaj Satchidanandan is a doctoral student in
the Electrical and Computer Engineering department
at Texas A&M University, College Station, TX.
Prior to this, he completed his Master’s from Indian
Institute of Technology Madras, where he worked
on Wireless Communications. Between May ’15 and
August ’15, he interned at Intel Labs, Santa Clara,
CA, where he worked on interference cancellation
algorithms for next-generation wireless networks.
His research interests include cyberphysical systems,
power systems, security, database privacy, commu-

nications, control, and signal processing.

