Distorting an Adversary’s View in Cyber-Physical Systems

Gaurav Kumar Agarwal, Mohammed Karmoose, Suhas Diggavi, Christina Fragouli, Paulo Tabuada
Department of Electrical and Computer Engineering, UCLA, Los Angeles, USA
Email: {gauravagarwal, mkarmoose, suhasdiggavi, christina.fragouli, tabuada}@ucla.edu

8
1
0
2

p
e
S
2
1

]
T
I
.
s
c
[

1
v
0
8
5
4
0
.
9
0
8
1
:
v
i
X
r
a

(CPSs),

Abstract— In Cyber-Physical Systems

inference
based on communicated data is of critical signiﬁcance as it
can be used to manipulate or damage the control operations
by adversaries. This calls for efﬁcient mechanisms for secure
transmission of data since control systems are becoming in-
creasingly distributed over larger geographical areas. Distortion
based security, recently proposed as one candidate for CPSs
security, is not only more appropriate for these applications but
also quite frugal in terms of prior requirements on shared keys.
In this paper, we propose distortion-based metrics to protect
CPSs communication and show that it is possible to confuse
adversaries with just a few bits of pre-shared keys.

I. INTRODUCTION

It is well recognized that wireless networking is essential
to realize the potential of new CPS applications, and is
equally well recognized that private and secure exchange
of information is a necessary and not simply a desirable
condition for the CPS ecosystem to thrive. For instance, per-
sonal health data in assisted environments, car positions and
trajectories, proprietary interests, all need to be protected.
We introduces a new approach to CPS security, that aims to
distort an adversary’s view of a control system’s states.

Our starting observation is that information security mea-
sures (cryptographic and information theoretic secrecy), are
not well matched to CPS applications as they impose un-
necessary requirements, such as protecting all the raw data,
and thus can cause high operational costs. Cryptographic
methods rely on computational complexity:
they require
short keys, but high complexity at the communicating nodes
(that can be simple sensors in some cases), and can impose a
signiﬁcant overhead on short packet transmissions, therefore
increasing delay [1], [2], [3], [4]. Information theoretic
methods rely on keys: they have low complexity and do not
add packet overhead, but require the communicating nodes
to share large keys - every communication link needs to use a
shared secret key (for a one-time pad) of length equal to the
entropy (effectively length) of the transmitted data [5]. These
costs accumulate rapidly given that large CPS applications
can have dense communication patterns.

Instead, we propose a lightweight approach,

that uses
small amounts of key and low complexity operations, and
builds around a distortion measure. To illustrate1, consider
the following simple example of a drone ﬂying motion

The work was partially supported by NSF grant 1740047, by the Army
Research Laboratory under Cooperative Agreement W911NF-17-2-0196,
and by the UC-NL grant LFR-18-548554.

1Although we illustrate our approach for a speciﬁc simple example, it

extends to protecting general system states.

(a)

(b)

Fig. 1: Example of drone motion: (a) protection of the most
signiﬁcant bit (b) mirroring based scheme.

inside a square, depicted in Fig. 1a. The drone starts at any
position, and moves between adjacent points in the grid. It
regularly communicates its location to a legitimate receiver,
Bob; a passive eavesdropper, Eve, wishes to infer the drone’s
locations, and can perfectly overhear all the transmissions the
drone makes. We assume the drone and Bob share just one
bit of key, that is secret from Eve, and ask: what is the best
use we can make of the key?

Using the one bit of shared key to protect

the most
signiﬁcant bit (MSB) is not a good solution. As shown in
Fig. 1a, the adversary can discover the fake trajectory after a
few time steps since this scheme can lead to trajectories that
do not adhere to the dynamics or environment constraints.
At this point, it can learn the real trajectory by ﬂipping back
the MSB (we assume that the used scheme is known to
everyone). Similar attacks can be made if we use a one-time
pad [5] using the same keys over time: as time progresses,
more fake trajectories can be discovered and discarded.

Conventional entropy measures also fail to provide in-
sights on how to use the key. For instance, assume we label
the 64 squares in Fig. 1a sequentially row per row, and
consider two cases: in case I, Eve learns that the drone is in
one of the neighboring squares {1, 2}, each with probability
1/2. For case II, Eve knows that the drone is in one of the
squares {1, 64}, again each with probability 1/2. Both cases
are equivalent from an information security perspective since
in both cases Eve’s uncertainty is a set of size 2 equiprobable
elements and hence its entropy is 1. However, the security
risk in each situation is different. For example, if Eve aims to
take a photo of the drone, in the ﬁrst case she knows where
to turn her camera (squares 1 and 2 are close by) while in the
second case, she does not (squares 1 and 64 are far apart).
Instead, we propose to use an Euclidean distance distortion

Actual TrajectoryChanging MSBInfeasible trajectoryActual TrajectoryMirroring Point(Center)Mirrored Trajectory 
 
 
 
 
 
measure: how far (in Euclidean distance) is Eve’s estimate
from the actual location. We then propose encoding/decoding
schemes which utilize the shared key to maximize this
distance. We ﬁrst consider a distortion measure averaged
over time and trajectories as we formally deﬁne later. Note
that if Eve had not received any of the drone transmissions,
then the best (adversarial) estimate of the drone’s location at
any given time is the center point of the conﬁned region in
Fig. 1a. Therefore, a good encryption scheme would strive to
maintain Eve’s estimate to be as close to the center point as
possible; and we achieve the maximum possible distortion,
if, after overhearing the drone’s transmissions, Eve’s best
estimate still remains the center point.

The following scheme can achieve this maximum distor-
tion by using exactly one bit of shared secret key. When
encoding, the drone either sends its actual trajectory, or a
“mirrored” version of it, depending on the value of the secret
key. The mirrored trajectory is obtained by reﬂecting the
actual trajectory across a mirroring point in space; in this
example, the mirroring point is the center point as shown in
Fig. 1b. Since Eve does not know the value of the shared
key, its best estimate of the drone’s location - after receiving
the drone’s transmissions - would be the average location
given the trajectory and its mirrored version, which is exactly
the center point. Our results in Section III extend this idea
of mirroring to dynamical systems in higher dimensional
spaces, and theoretically analyze the performance in terms of
average distortion for a larger variety of distributions (with
certain symmetry conditions).

Next, we consider a worst-case distortion-based metric. In
this case, our security metric is “in the worst case, how far is
Eve’s estimate from the actual location?” That is, the adver-
sary’s distortion may be different for different time instances
and different instances of the actual trajectory, and we are
interested in the minimum among these. In Section IV we
provide encryption schemes that are suitable for maximizing
this distortion metric and show that with 3 bits of shared
key per dimension (i.e., 9 for three dimensional motion),
our schemes achieve near-perfect worst case distortion. Our
main contributions are as follows:
• We deﬁne security measures that are based on assessing
the distortion: in the average sense over time and over data,
and in the worst-case sense, providing such guarantees at any
time and for any particular instances of data.
• For the average distortion, we develop a mirroring based
scheme which uses one bit of key and achieves the maximum
possible distortion (equivalent to Eve with no observations)
in some cases. We also discuss the cases where it is sub-
optimal and analytically characterize the attained distortion.
• For the worst case distortion, we design a scheme that
uses 3 bits of key per dimension and prove it achieves the
maximum possible distortion (equivalent to Eve having no
observations) when the inputs to the system are independent
from the previous states.
Related Work. Secure data communication where the ad-
versary has unlimited computational power is studied from
the lens on information theory, most notably by Shannon [5]

and Wyner [6]. The study of secure communication from
a distortion angle is relatively new and is ﬁrst studied by
Yamamoto [7], where the goal is to maximize the distortion
of an eavesdropper’s estimate on a message. Schieler and
Cuff [8] later showed that, in the limit of an inﬁnite block
length (n) code, only log(n) bits of secret keys are needed to
achieve the maximum possible distortion. Schemes for single
shot communication were considered in [9] and exponential
beneﬁts for each additional bit of shared key were discussed.
However, the above schemes do not directly translate to the
scenarios where one has to communicate correlated temporal
data like the state of a control system.

Secure communication in control systems is studied
in [10], [11], [12], [13], [14], [15]. These works either pro-
vide distortion only at the steady state or use measures like
differential privacy (does not use keys) and weak information
theoretic security; they sometimes also assume that Eve gets
different (a subset of the) information than Bob.

II. SYSTEM MODEL

a X (cid:48)

a+1 · · · X (cid:48)

Notation. Xt denote a column vector, and X b
a =
b](cid:48) for b ≥ a and a, b ∈ Z; fX (x) denotes the
[X (cid:48)
probability density function of a random vector X; for any
random vector Y , we denote the mean vector and covariance
matrix of Y by µY and RY respectively, thus for example,
the mean and the covariance matrix of X b
a will be denoted
respectively; for a matrix A, A(cid:48) denotes
by µX b
the transpose of A and Ar denotes the r-th power of A;
[m] := {1, 2, . . . , m} where m ∈ Z+.
System Dynamics. We consider the linear dynamical system,

and RX b

a

a

Xt+1 = AXt + BUt + wt,

Yt = CXt + vt,

(1)

1

1

1

1 , U = U T −1

where Xt ∈ Rn is the state of the system at time t, Ut ∈ Rm
is the input to the system at time t, wt ∈ Rn is the process
noise, Yt are the system observations, and vt ∈ Rp is the
and w = wT −1
observation noise. Let X = X T
.
Based on the initial X1 and target XT states, the controller
computes U T −1
which moves the system from X1 to XT .
Communication and Adversary Models. At each time
its state
instance the system transmits information about
to a legitimate receiver, which is referred to as Bob, via
a noiseless link. This situation occurs for example when
Bob is remotely monitoring the execution of the system
as in Supervisory Control And Data Acquisition (SCADA)
system. A malicious receiver, Eve, is assumed to eavesdrop
on the communication between the system and Bob and is
able to receive all transmitted signals. Eve is assumed to be
passive: she does not actively communicate but is interested
in learning the system’s states from t = 1 to T . We assume
that the system and Bob have a shared k-bit key K which
they use to encode/decode the transmitted messages.
Inputs and States Random Process Model. We assume
that both Eve and Bob are aware of the system model,
the matrices A, B, C and the statistics of noises. From the
perspective of Eve, the input and output sequences have
random distributions which depend on A, B, C and the
statistics of the noise. In addition to the process noise w, the

joint distribution f (X, U, w) depends on the initial and target
states and the control law of the system. So, even in noiseless
systems, X and U possess inherent randomness from Eve’s
perspective due to her lack of knowledge about the control
law and the initial and target states. In general, the control
inputs U can be dependent on the system states X. However,
knowing the marginal distribution of U in noiseless systems
can specify the marginal distribution of X. This follows by
2 = QU + ˜QW + ˆQX1, where Q and ˜Q
noting that X T
are lower triangular block matrices with the (i, j)th block
submatrices, i ≥ j, being Ai−jB and Ai−j repsectively,
and ˆQ = [A(cid:48) (A2)(cid:48)
· · · (AT −1)(cid:48)](cid:48). This implies that for
the marginal distribution of U would
noiseless systems,
imply the marginal distribution of X T
for a given initial
2
state X1 and thus the marginal distribution of X. For a given
X1, the mean vector and covariance matrix of X T
2 become
= QµU + ˆQµX1 and RX T
E(X T
Encoding Model. The system transmits a packet Zt at each
time step t. The t-th transmitted packet can be a function of
all previous observations and the shared keys, thus, Zt :=
Et(Y t
1 , K), where Et is the encoding function used at time
t. We will denote Z T
Bob/Eve Models of Decoding. Bob noiselessly receives
the transmitted packets from the system, and decodes them
using the shared key. Then, using the decoded information, it
generates an estimate of the state transmissions of the system
at times t = 1, · · · , T . We require Bob to decode loss-
lessly (i.e., with zero distortion). Formally, H(Xt|Z t
1, K) =
0, ∀t ∈ [T ], where H is the Shannon entropy [5].

= QRU QT .

2 ) = µX T

1 by Z.

2

2

1

1

,

1

(cid:16)

(2)

(cid:13)
2
(cid:13)
(cid:13)
2

(cid:0)Z T

(a)
= tr

RXt|ZT

D(t, Z T

1 ) := EXt|ZT

Similarly, Eve also receives all transmissions from the
system. However, unlike Bob, she does not have the key K.
(cid:1) , t ∈ [T ],
Therefore, Eve’s estimate of Xt is ˆXt := φt
where φt is the decoding function used by Eve at time t.
Distortion Metrics. We consider a distortion-based security
metric which captures how far (in Euclidean distance) an
estimate is from the actual value. More formally, for a given
time instance t and a transmitted codeword Z T
1 , we deﬁne
(cid:17)

(cid:13)
(cid:13)Xt − ˆXt
(cid:13)
where (2) captures the distortion incurred by Eve’s estimate
of Xt. Equality in (a) follows because the best (minimizing)
(cid:3) .
estimates of Eve at time t are, ˆXt = φt
This implies that Eve’s state estimation is the optimal one
given the observations Z T
1 . In general, this state estimate
is dependent on the time instance. In other words, unless
it happens to be the optimal estimate, making a constant
estimation of the state hoping that it matches the actual state
at some time will lead to high distortion values. Because Bob
is required to successfully decode - for a given realization
of the key, the encoding function can only map one Xt and
that key realization to each value of Z T
1 . Therefore Eve
realizes that only trajectories from a particular subset can
be the true trajectory for a given Z T
1 : those are the ones
which correspond to each key realization. The expectation
in (2) is in fact taken over the randomness in the key taking
into account posterior probabilities given Z T
1 . If Eve does

(cid:1) = E (cid:2)Xt|Z T

(cid:0)Z T

1

1

not have observations, the expectation is taken over Xt with
prior distribution and will get D(t, Z T

1 ) = tr(RXt).

As D(t, Z T

1 ) is a function of time t and the transmitted
sequence Z T
1 , we consider two overall distortion metrics: the
average case distortion (denoted by DE) where we take the
expectation over all possible Z T
1 averaged out over time; and
the worst case distortion (denoted by DW ) where we take
the minimum over all possible Z T

1 and time instances.
(cid:34)

(cid:35)

Average
Distortion

Worst Case
Distortion

− DE := EZT

1

− DW := min
ZT
1

T
(cid:88)

t=1

1
T
(cid:20)

min
t∈[T ]

D(t, Z T
1 )

D(t, Z T
1 )

(cid:21)

.

(3)

(4)

Note that DW can be deﬁned even when there is no prior
distribution on X T
1 . However, to provide a baseline compar-
ison with the case when the adversary has no observations,
we assume that X T
1 always have a known prior distribution.
Design Goals. Our goal is to choose the encoding function,
Et, so that Bob can decode loselessly while the distortion
is maximized for Eve’s estimate. In addition, we seek to
achieve this with the minimum amount of shared key K.
In absence of any observation by Eve, these distortions will
be, Dmax
W = mint∈[T ]tr(RXt).
These provide upper bounds as,

t=1tr(RXt) and Dmax

E = 1
T

(cid:80)T

DE =

1
T

EZT

1

T
(cid:88)

tr(RXt|ZT

1

t=1

(a)
≤

)

1
T

T
(cid:88)

t=1

DW = min
ZT
1

min
t∈[T ]

tr(RXt|ZT

1

) ≤ min
t∈[T ]

EZT

1

(b)
≤ min
t∈[T ]

tr(RXt) = Dmax
W ,

tr(RXt) = Dmax
E ,

(5)

(cid:104)

tr(RXt|ZT

1

(cid:105)
)

(6)

where (a) and (b) follow by noting that the trace of the con-
ditional covariance matrix is a quadratic (convex) function
in Z T

1 and therefore we can use Jensen’s inequality.

III. OPTIMIZING THE AVERAGE DISTORTION DE
In this section, we assume that the control system in (1)
is noise free, that is vt = wt = 0. Although our results can
be extended to an arbitrary observable pair (A,C) in (1), to
simplify the exposition we assume the state can be directly
measured (C = I). We now discuss our proposed scheme
that uses one bit of shared key and show how the achieved
distortion compares to the upper bound in (5). As we show
later (Corollary 3.3), this scheme is optimal when the prior
distribution on the state have a point of symmetry.
Mirroring Scheme. Let ˜Xt be the state vector Xt, mirrored
across a afﬁne subspace Vt = {x ∈ Rn | Stx = bt}, where
St ∈ Rstxn and bt ∈ Rst This scheme works as follows:

Zt = (1 − K)Xt + K ˜Xt, ∀t ∈ [T ],

(7)

where K is the shared bit. Since every afﬁne subspace can
be written in terms of orthogonal vectors, we assume that
t = I. It is easy to show that the mirrored point ˜Xt
StS(cid:48)
is (I − 2S(cid:48)
tSt)Xt + 2S(cid:48)
tbt and thus the encoding/decoding
complexity of our scheme is O(n2).

(cid:107)StXt − bt(cid:107)2

,

(8)

X1 ∼ Uni([−a : a])

Example. Consider Xt ∈ R2 where St = 1√
2

[−1 1] and
bt = 0. Then ˜Xt corresponds to reﬂecting across a line that
passes through the origin with a 45o angle.

The performance of our scheme is as follows.
Theorem 3.1: (Proof in Appendix V-A) The mirroring
scheme with matrices St and bt allows Bob to perfectly
estimate Xt, and the distortion for Eve is,
(cid:34)

(cid:35)

DE =

T
(cid:88)

EX

1
T

2fX ( ˜X)
fX (X) + fX ( ˜X)

t=1
where ˜X := [ ˜X (cid:48)
1

˜X (cid:48)

2 · · · ˜X (cid:48)

T ](cid:48) is the mirrored version of X.
Assuming that fX (x) is known, then Theorem 3.1 pro-
vides a closed-form characterization of the achieved average
distortion for any mirroring scheme with matrices St and bt.
Moreover, under some symmetry conditions on fX (x), the
expression in (8) simpliﬁes and gives insights on the maxi-
mum achievable distortion. This is shown in Corollary 3.2.
Corollary 3.2: (Proof in Appendix V-A) If the mirroring
scheme matrices St and bt in Theorem 3.1 are selected such
that fX (X) = fX ( ˜X), ∀X ∈ RnT , then (8) becomes,

DE =

1
T

i=1

T
(cid:88)

tr (StRXtS(cid:48)

t + (bt −StµXt)(bt −StµXt)(cid:48)) (9)

T
(cid:80)
i=1

tr(StRXtS(cid:48)

Note that fX (X) = fX ( ˜X) implies bt = StµXt. We can
interpret (9) as follows. Assuming that fX (X) = fX ( ˜X) is
met, then the distortion becomes DE = 1
t).
T
The achieved distortion therefore depends on the choice of
St: if St = I then the maximum distortion can be achieved
by our mirroring scheme. However, such a choice of St may
not be able to ensure that fX (X) = fX ( ˜X) is met, as we will
see in some of the following examples. One case for which
St = I satisﬁes fX (X) = fX ( ˜X) and allows maximum
distortion is when X is symmetrically distributed around a
point. We show this in the next corollary.

T

T
(cid:80)
t=1

tr(RXt).

Corollary 3.3: For a random vector X ∈ RT n, if there
exists a point v ∈ RT n for which fX (X) = fX (2v − X),
∀X ∈ RT n, then DE = 1
T tr(RX ) = 1
Proof: Since X and 2v −X have the same distribution,
they will have the same mean. This implies that v = µX . We
then use the following mirroring scheme: St = I, bt = µXt
for t ∈ [1 : T ]. With this, we get ˜Xt = 2µXt − Xt, and
thus ˜X = 2µX − X where ˜X := [ ˜X (cid:48)
T ](cid:48) and
1
(cid:48)
(cid:48)](cid:48). This implies, fX (X) =
µX := [µX1
· · · µXT
fX ( ˜X), ∀X ∈ RnT . Therefore the distortion is Dmax
E .
We now illustrate our results for few examples.

2 · · · ˜X (cid:48)

(cid:48) µX2

˜X (cid:48)

2 is also Gaussian distributed with mean µX T

Example 1. Assume U is distributed as Gaussian with mean
µU and covariance matrix RU . Then for a zero initial state,
X T
= QµU and
= QRU QT , as we assume the noise to be
covariance RX T
zero. A Gaussian random vector satisﬁes the conditions in
Corollary 3.3, and therefore we can get maximum distortion
by setting bt = µXt and St = I.

2

2

The next example is based on a Markov-based model for

the dynamical system and uses the following lemma.

Lemma 3.4: Consider the random vectors Xt where the
following conditions hold: 1) fX1 (x1) = fX1(2µ1 − x1) and
2) fXt|Xt−1 (xt|xt−1) = fXt|Xt−1(2µt − xt|2µt−1 − xt−1).
Then for this case, fX (X) = fX (2µ − X), where µ =
(cid:48)](cid:48). Therefore, by virtue of Corollary 3.3,
[µ1
mirroring schemes can achieve the maximum distortion.
Example 2. Consider the following random walk mobility
model. Let a ∈ N+, and Xt be its location at time t, then,

· · · µT

(cid:48) µ2

(cid:48)

Xt|Xt−1 ∼ Uni([−a : a] ∩ {Xt−1 − 1, Xt−1, Xt−1 + 1}).

One can see that these distributions satisfy the conditions in
Lemma 3.4. Therefore, one can set bt = µt = 0 and St = 1,
which will achieve maximum distortion of DE.
Example 3. Here we provide a numerical example which
shows how our mirroring scheme performs for situations
where we do not have an analytical handle on the state
distributions. We assume the quadrotor dynamical system
provided in [16]. The quadrotor moves in a 3-dimensional
cubed space with a width, length and height of 2 meters,
where the origin is the center point of the space. The quadro-
tor starts its trajectory from an initial point (−1, y1, z1) and
ﬁnishes its trajectory at a target point (1, yT , zT ) after T time
steps, where the points y1, z1, yT , zT are picked uniformly
at random in [−1, 1]4. We assume that T = 10 time steps,
and that the continuous model in [16] is discretized with
a sample time of Ts = 0.5 seconds. We assume that
the quadrotor encodes and transmits only the states which
contain the location information (ﬁrst three elements of the
state vector Xt). The quadrotor is equipped with an LQR
controller which designs the input sequence U T −1
which
minimizes (cid:107)U (cid:107)2 + 10 (cid:13)
(cid:13)
2
(cid:13)X T −1
while ensuring that XT is
(cid:13)
2
equal to the target state. We perform numerical simulation
of the aforementioned setup: we run 2 millions iterations,
where in each iteration a new initial and target points are
picked, and the resultant trajectory is recorded. Based on
the recorded data, we consider different mirroring schemes
and numerically evaluate the attained distortion. To facilitate
numerical evaluations, the simulation space is gridded into
bins with 0.2 meters of separation, and the location of the
drone at each trajectory is approximated to the nearest bin.
Figure 2 shows some of the drone trajectories obtained
from our numerical simulation. It
is clear that not all
trajectories are equiprobable, and therefore the distribution
of Xt is not uniform across all bins in space. However,
the computation of EXt shows the expected value of the
position to be the origin. Moreover, since the motion of the
drone is mainly progressive in the positive x-axis direction,
reﬂection across the origin results in mirrored trajectories
that are progressing in the opposite direction, and therefore
are identiﬁed to be fake automatically. Therefore, mirroring
across a point here is useless: the numerically computed
distortion for this scheme is equal to zero.

1

Next we consider mirroring across the reﬂection plane
(cid:21)
(cid:20)0 1 0
.
0 0 1

shown in Figure 2, where bt = 0 and St =

As can be seen from the ﬁgure,

the reﬂection plane is

−θ2

0

θ2

−θ2

0

θ2

(a)

(b)

Fig. 4: (a) Transparent shapes represent true values and solid
shapes represent their respective mapping when two bit key
is 11 and 10 respectively. (b) DW , as a function of number
of keys for optimal choice of θk.

Eve optimally uses her observations and knowledge about
the dynamics, her best estimate attains maximal distortion.
We start by studying the case of single shot transmission
(Theorems 4.2 and 4.3), which form the basis for maximizing
the worst case distortion of a trajectory (Theorem 4.4).

A. Building Step: Scalar Case

Consider the case where the system wants to communicate
a single scalar random variable X to Bob by transmitting
Z. The worst case distortion DW for Eve will be DW =
minZ Var(X|Z). Note that if Eve does not overhear Z, Eve
uses the minimum mean square error estimate (i.e., the mean
value) as her estimate, and thus experiences a worst case
distortion equal to the variance of X.

We ﬁrst assume that X ∼ N (0, 1), and thus, the worst
case distortion can not be larger than 1 by (6). We next
develop our scheme progressively, from simple to more
sophisticated steps. We will also use the following lemma.
Lemma 4.1: The variance of two real numbers a and b

with probabilities pa and pb is given by papb(a − b)2.
Mirroring or Shifting. Reﬂecting around the origin (as
proposed in Section III) is not suitable for maximizing DW :
indeed, using Lemma 4.1, Var(X|Z) evaluates to 0 when
Z = 0 and attains limited distortion for small values of Z.
Another scheme consists of “shifting” X by a constant θ
whenever the shared key bit is one. Differently, this scheme
admits Var(X|Z) which decreases fast for large values of Z.
Shifting+Mirroring. We here combine both schemes in
order to achieve a good performance for both small and large
values of X. We start from the case where we have k = 1
bit of key and then go to the case k ≥ 1.
• k = 1. We select a θ1 ∈ R that determines a window size
(θ1 is public and known by Eve). The encoding function is

Z = E(X, K) =






(1 − 2K)X if K = 0 or |X| > θ1

X + θ1
X − θ1

if K = 1, −θ1 ≤ X < 0
if K = 1, 0 ≤ X < θ1

We note that there is one particular value of X, X = θ1,
which we do not transmit. Since this is of zero probability
measure, it can be safely ignored. Given Z, there are two
possibilities for X: for |Z| > θ1, X ∈ {Z, −Z}; for −θ1 ≤
Z < 0, X ∈ {Z, Z + θ1}; for 0 ≤ Z < θ1, X ∈ {Z, Z −

Fig. 2: An illustration of some trajectories. The reﬂection
plane is shown as a dashed-black line. One trajectory (solid-
black) is shown along with its mirrored image (dotted-black).

indeed an axis of symmetry for the distribution of the drones
trajectories, and therefore is expected to provide high distor-
tion values. We numerically evaluate the attained distortion
using the scheme by using equation (8), which evaluates to
DE = 0.3971. This is slightly less than Dmax

E = 0.3979.

IV. OPTIMIZING THE WORST CASE DISTORTION DW

Fig. 3: Var(X|Z) Vs Z for mirroring+shift based scheme
with θ1 = 1.76; DW = 0.4477.

The expected distortion metric might not be well-suited
for some applications (for example if an adversary wants to
shoot a drone). In this case, the adversary’s estimate needs to
be far from the actual state at all time instances. Therefore,
a more appropriate metric would be to consider the worst
case distortion for the adversary. Consider for example the
scheme in Fig. 1b. Here, the adversary’s estimate is always
the center point and the maximum expected distortion is
achieved. However, when the drone is very close to the
center, its mirror image will also be close to the center. At
this particular time instance, the adversary’s distortion will
be very small and thus the adversary will essentially know
the position.

In this section, we present an encryption scheme that
attempts to maximize the worst case distortion for Eve.
The scheme obfuscates the initial state such that, even if

-11-0.510.50.50yz0x00.5-0.5-0.51-1-1Reflection PlaneA trajectoryMirroredTrajectoryθ1}. Using the fact that X ∼ N (0, 1), we can calculate
the posterior probabilities P r(X|Z) and use Lemma 4.1 to
compute Var(X|Z). Fig. 3 plots Var(X|Z) for θ1 = 1.76.
The worst case distortion in this case becomes 0.4477, which
is the best we can hope for if we have only one bit of shared
key. This follows because for any mapping from X to Z, a
transmitted symbol Z can have at most two pre-images (as
Bob needs to reliably decode with one bit of key), and if
one of these is X = 0, then no matter what the second one
is, the distortion corresponding to Z will be at most 0.4477.
Equality occurs when the second pre-image of Z is ±1.76.
Note that our scheme also maps 0 to −1.76 (for θ1 = 1.76).
• k ≥ 1. For K ∈ {0, 1}k, we use the following encoding:

Z = E(X, K) =






X
−X
X +K 2θk

K < 2k−1, |X| > θk
K ≥ 2k−1, |X| > θk
o.w. ,

2k mod [−θk, θk)

where the optimal value of the constant θk depends on the
number k of keys we have, K is the decimal equivalent of
a binary string of length k, and r mod [a, b) = r − i(b − a)
is such that i is an integer and r − i(b − a) ∈ [a, b) for
r, a, b ∈ R. Intuitively, if |X| > θk then for half of the keys,
we reﬂect across origin and for the other half we do nothing;
if |X| < θk, we divide this window of size 2θk into 2k equal
size windows and shift a point from one window to another
by jumping K (in decimal) windows. An example for k = 2
is shown in Fig. 4a for the key values K = 11 and K = 10.
Fig. 4b plots DW as a function of the number of keys k.
Using k = 3 and θ3 = 4.84 we achieve DW = 0.9998
which is very close to 1, the best we could hope for.

Theorem 4.2: A Gaussian random variable with mean µ
and variance σ2 can be near perfectly (∼ 0.9998 times the
perfect distortion) distorted in the worst case settings by just
using three bits of shared keys.

Proof: Generate the random variable V ∼ N (0, 1) as
V = (X − µ)/σ and encrypt it using k = 3 key bits and
the previously described scheme. For c = 0.9998 we have
Dw = min
Remark: We optimized the parameter θk of our scheme
assuming Gaussian distribution. For other distributions, the
optimal choice of θk and the corresponding worst case
distortion would be different.

Var(σV + µ|Z) = cσ2.

Var(X|Z) = min

Z

Z

B. Vector Case and Time Series

Theorem 4.3: (Proof in Appendix V-B) For a Gaussian
random vector X ∈ Rn with mean µ and a diagonal
covariance matrix Σ we can achieve DW within 0.9998 of
the optimal by using 3n bits of shared keys.
This theorem uses our 3-bit encryption for each element in
the vector. Assume now that this vector captures the prob-
ability distribution of the initial state of dynamical system;
by encrypting this state we can guarantee the following.

Theorem 4.4: (Complete Proof in Appendix V-C) Using
3n bits of shared keys we can achieve DW within 0.9998
of the optimal for the dynamical systems (1) with C = I,
vt = 0, singular values of A more than 1, and initial state

X1 ∼ N (µ, Σ), where Σ is diagonal covariance matrix, and
Ut and wt are independent of Xt.
Remark: Although the independence assumption on the
inputs is rather restrictive, the result serves as a stepping
stone towards understanding general cases.

Proof:

The system transmits Z1 = f (Y1, K) =

f (X1, K) where f is the encoding in Theorem 4.3, and

Zt+1 = AZt +(Yt+1 −AYt) = AZt +BUt +wt, ∀t ∈ [T − 1].

Bob can decode X1 using Z1 and K. Then:

ˆXt+1 = Zt+1 − AZt + A ˆXt = BUt + wt + A ˆXt

= AXt + BUt + wt = Xt+1,

∀t ∈ [T − 1].

Eve’s distortion is calculated in Appendix V-C.
Complexity: O(n2) per time for both encoding & decoding.

A. Proof of Theorem 3.1 and Corollary 3.2

V. APPENDICES

We start by computing RXt|ZT

. Note that given a sequence
1 there are two possible values of
1 and
1 , where ˜Zt is the image of Zt across the afﬁne

of transmitted symbol Z T
sequence of message symbols X T
X T
subspace given by Stx = bt.

1 which are X T

1 = ˜Z T

1 = Z T

1

With this, the posterior probability of Xt = Zt given
1 =
, where

i.e., P r(Xt = Zt|Z T
1 ) := pZ. We note that pZ =
T ](cid:48). Then E(Xt|Z T

1 ) will be equal to P r(X T

Z T
1
Z T
1 |Z T
˜Z := [ ˜Z (cid:48)
1

f (Z)
f (Z)+f ( ˜Z)

2 · · · ˜Z (cid:48)
˜Z (cid:48)

1 ),

= pZZt + (1 − pZ)( ˜Zt) = Zt + 2(1 − pZ)S(cid:48)

t (bt − StZt) .

RXt|ZT

1

1

(cid:104)(cid:0)Xt − E(Xt|Z T

1 )(cid:1)(cid:48)(cid:105)
1 )(cid:1) (cid:0)Xt − E(Xt|Z T
t(bt − StZt)(bt − StZt)(cid:48)St)(cid:1)
t(bt − StZt)(bt − StZt)(cid:48)St)(cid:1)

= EXt|ZT
(cid:0)4(1 − pZ)2 (S(cid:48)
= pZ
+ (1 − pZ) (cid:0)4pZ
2 (S(cid:48)
t(bt − StZt)(bt − StZt)(cid:48)St.
S(cid:48)
= 4pZ(1 − pZ)
(cid:123)(cid:122)
(cid:125)
η(Z)

(cid:124)

DE = EZ

= EZ

= EZ

1
T

=

=

=

1
T

1
T

1
T

EZ

EZ

EZ

1
T

1
T

T
(cid:88)

t=1
T
(cid:88)

t=1

(cid:16)

tr

RXt|ZT

1

(cid:17)

tr (η(Z)S(cid:48)

t(bt − StZt)(bt − StZt)(cid:48)St)

T
(cid:88)

η(Z)tr (S(cid:48)

t(bt − StZt)(bt − StZt)(cid:48)St)

t=1
(cid:34) T

(cid:88)

t=1
(cid:34) T

(cid:88)

t=1
(cid:34) T

(cid:88)

t=1

(cid:35)

η(Z)(cid:107)StZt − bt(cid:107)2

4pZ(1 − pZ)(cid:107)StZt − bt(cid:107)2

(cid:35)

4

fX (Z)fX ( ˜Z)
(fX (Z) + fX ( ˜Z))2

(cid:35)

(cid:107)StZt − bt(cid:107)2

.

Now, Z T

1 is the transmitted symbols if X T

1 and key
was zero or if {Xt = ˜Zt, ∀t ∈ [T ]} and key was one. So
fZ(Z) = fX (Z)+fX ( ˜Z)
. Thus DE,
(cid:34) T

1 = Z T

(cid:35)

2

EZ

(cid:90)

(cid:88)

t=1

fZ(Z)

4

fX (Z)fX ( ˜Z)
(fX (Z) + fX ( ˜Z))2
(cid:34) T

(cid:88)

4fX (Z)fX ( ˜Z)
(fX (Z) + fX ( ˜Z))2

(cid:107)StZt − bt(cid:107)2

(cid:35)

(cid:107)StZt − bt(cid:107)2

dZ

(cid:90) (cid:34) T
(cid:88)

t=1
(cid:34) T

(cid:88)

t=1

EX

t=1
2fX (Z)fX ( ˜Z)
fX (Z) + fX ( ˜Z)
2fX ( ˜X)
fX (X) + fX ( ˜X)

(cid:107)StZt − bt(cid:107)2

(cid:35)

dZ

(cid:35)

(cid:107)StXt − bt(cid:107)2

,

=

=

=

=

1
T

1
T

1
T

1
T

which proves (8). Again, if we can choose St’s and bt’s such
that,

fX (X) = fX ( ˜X), ∀X ∈ RnT ,

the distortion DE becomes,

EX

T
(cid:88)

t=1

(cid:107)StXt − bt(cid:107)2 =

1
T

T
(cid:88)

t=1

EXt(cid:107)StXt − bt(cid:107)2

subtracting AZt from Zt+1 for t ∈ [1 : T − 1]. So the
adversary’s information is given by following set:

Einfo = {Z1, BUt + wt, t ∈ [1 : T − 1]}

= {f (X1, K), BUt + wt, t ∈ [1 : T − 1]} .

Thus, D(t, Z T

1 ) = D(t, Einfo) = tr(RXt|Einfo).

Let’s ﬁrst compute D(t = 1, Z T

1 ),

D(t = 1, Z T

1 ) = tr(RX1|Einfo)

(a)
= tr(RX1|f (X1,K))

(b)
= c tr(Σ),

where (a) is because Ut and wt are independent on Xt and
(b) is due to the encoding used in Theorem 4.3 with c =
0.9998.

Now, for other time instances we can use induction to
prove that we will have worst case distortion at least tr(Σ).

D(t + 1, Z T
1 ) = tr(RXt+1|Einfo) = tr(R(AXt+BUt+wt)|Einfo)
= tr(R(AXt)|Einfo) = tr(ARXt|EinfoA(cid:48)) = tr(A(cid:48)ARXt|Einfo)
(a)
= tr(V ΛV (cid:48)RXt|Einfo) = tr(ΛV (cid:48)RXt|EinfoV )

(b)
=

(d)
=

n
(cid:88)

λidi(V (cid:48)RXt|EinfoV )

(c)
≥

(cid:88)

di(V (cid:48)RXt|EinfoV )

i=1
(cid:88)

i∈[n]

νi(V (cid:48)RXt|EinfoV )

(e)
=

i∈[n]
(cid:88)

νi(RXt|Einfo)

i∈[n]

tr (StRXtS(cid:48)

t + (bt − StµXt)(bt − StµXt)(cid:48)) ,

= tr(RXt|Einfo)

(f )
≥ c tr(Σ),

1
T

1
T

=

T
(cid:88)

t=1

which proves (9).

B. Proof for Theorem 4.3

Let

the shared key K is (K1, K2, . . . , Kn) where all
Ki’s are i.i.d. and uniformly distributed in {0, 1}3. Let us
also assume that X = (X (1), X (2), . . . , X (n)), where each
X (i) ∈ R. Similar to the scheme for scalar case, we create a
random vector V = (V (1), . . . , V (n)) where,

V (i) = (X (i) − µ(i))/

(cid:112)

Σii,

and encode V (i) using key Ki as in the case of a scalar for
all i ∈ [n]. Thus, the distortion DW will be,

= min

Z

tr(RX|Z) = min

Z

n
(cid:88)

i=1

Var(X (i)|Z)

= min

Z

n
(cid:88)

i=1

(Σii)Var(V (i)|Z) =

n
(cid:88)

i=1

(Σii) min

Z

Var(V (i)|Z)

=

n
(cid:88)

i=1

(Σii) min
Z(i)

Var(V (i)|Z (i)) = c

n
(cid:88)

(Σii) = c tr(Σ),

i=1

where c = 0.9998. And since tr(Σ) is the expected distortion
even when the adversary has no observations, and as we can
not beat this by (6), this is optimal.

C. Proof for Theorem 4.4

Distortion at the adversary’s end. Based on the coding
scheme we can see that the adversary get BUt + wt by just

where in (a), we do eigenvalue decomposition of A(cid:48)A which
is a positive deﬁnite matrix and thus will have non negative
in (b) di(V (cid:48)RXt|EinfoV ) is the i-th diagonal
eigenvalues;
entry of V (cid:48)RXt|EinfoV ; (c) is true because V (cid:48)RXt|EinfoV is
a positive deﬁnite matrix and all the diagonal entries of a
positive semi deﬁnite matrix are non-negative and because
of our assumption that singular values of A, i.e. the square
root of eigenvalues of A(cid:48)A are all more than one; (d)
is because summation of eigenvalues is equal to the sum
of all the diagonal entries for any square matrix, where
νi(V (cid:48)RXt|EinfoV ) is the i-th eigenvalue of V (cid:48)RXt|EinfoV ;
(e) is because a unitary transform preserve the eigenvalues.
Finally (f) is because of the induction step.

REFERENCES

[1] J. Wan, A. B. Lopez, and M. A. A. Faruque, “Exploiting wireless
channel randomness to generate keys for automotive cyber-physical
system security,” in 2016 ACM/IEEE 7th International Conference on
Cyber-Physical Systems (ICCPS), April 2016, pp. 1–10.

[2] B. Zan, M. Gruteser, and F. Hu, “Key agreement algorithms for
vehicular communication networks based on reciprocity and diversity
theorems,” IEEE Transactions on Vehicular Technology, vol. 62, no. 8,
pp. 4020–4027, Oct 2013.

[3] W. Trappe, R. Howard, and R. S. Moore, “Low-energy security: Limits
and opportunities in the internet of things,” IEEE Security Privacy,
vol. 13, no. 1, pp. 14–21, Jan 2015.

[4] P. Koopman and C. Szilagyi, “Integrity in embedded control net-
works,” IEEE Security Privacy, vol. 11, no. 3, pp. 61–63, May 2013.
[5] C. E. Shannon, “Communication theory of secrecy systems,” Bell

system technical journal, vol. 28, no. 4, pp. 656–715, 1949.

[6] A. D. Wyner, “The wire-tap channel,” The Bell System Technical

journal, vol. 54, no. 8, pp. 1355–1387, 1975.

[7] H. Yamamoto, “A rate-distortion problem for a communication system
with a secondary decoder to be hindered,” IEEE Transactions on
Information Theory, vol. 34, no. 4, pp. 835–842, July 1988.

[8] C. Schieler and P. Cuff, “Rate-distortion theory for secrecy systems,”
IEEE Transactions on Information Theory, vol. 60, no. 12, pp. 7584–
7605, Dec 2014.

[9] C. Tsai, G. K. Agarwal, C. Fragouli, and S. Diggavi, “A distortion
based approach for protecting inferences,” in 2017 IEEE International
Symposium on Information Theory (ISIT), June 2017, pp. 1913–1917.
[10] A. Tsiamis, K. Gatsis, and G. J. Pappas, “State-secrecy codes for
networked linear systems,” CoRR, vol. abs/1709.04530, 2017.
[11] ——, “State estimation with secrecy against eavesdroppers,” IFAC-
PapersOnLine, vol. 50, no. 1, pp. 8385 – 8392, 2017, 20th IFAC
World Congress.

[12] T. Tanaka, M. Skoglund, H. Sandberg, and K. H. Johansson, “Di-
rected information and privacy loss in cloud-based control,” in 2017
American Control Conference (ACC), May 2017, pp. 1666–1672.
[13] D. van Dooren, S. Schiessl, A. Molin, J. Gross, and K. H. Johansson,
“Safety analysis for controller handover in mobile systems,” IFAC-
PapersOnLine, vol. 50, no. 1, pp. 10 090 – 10 095, 2017, 20th IFAC
World Congress.

[14] W. A. Malik, N. C. Martins, and A. Swami, LQ Control under Security
Constraints. Heidelberg: Springer International Publishing, 2013, pp.
101–120.

[15] J. Corts, G. E. Dullerud, S. Han, J. L. Ny, S. Mitra, and G. J. Pappas,
“Differential privacy in control and network systems,” in 2016 IEEE
55th Conference on Decision and Control (CDC), Dec 2016, pp. 4252–
4272.

[16] V. Kumar and N. Michael, “Opportunities and challenges with au-
tonomous micro aerial vehicles,” The International Journal of Robotics
Research, vol. 31, no. 11, pp. 1279–1291, 2012.

