1

Safeguarding the IoT from Malware Epidemics: A
Percolation Theory Approach

Ainur Zhaikhan, Mustafa A. Kishk, Hesham ElSawy, and Mohamed-Slim Alouini

0
2
0
2

t
c
O
4
2

]

R
C
.
s
c
[

1
v
2
6
8
2
1
.
0
1
0
2
:
v
i
X
r
a

Abstract—The upcoming Internet of things (IoT) is foreseen to
encompass massive numbers of connected devices, smart objects,
and cyber-physical systems. Due to the large-scale and massive
deployment of devices, it is deemed infeasible to safeguard 100%
of the devices with state-of-the-art security countermeasures.
Hence,
large-scale IoT has inevitable loopholes for network
intrusion and malware inﬁltration. Even worse, exploiting the
high density of devices and direct wireless connectivity, mal-
ware infection can stealthily propagate through susceptible (i.e.,
unsecured) devices and form an epidemic outbreak without
being noticed to security administration. A malware outbreak
enables adversaries to compromise large population of devices,
which can be exploited to launch versatile cyber and physical
malicious attacks. In this context, we utilize spatial ﬁrewalls,
to safeguard the IoT from malware outbreak. In particular,
spatial ﬁrewalls are computationally capable devices equipped
with state-of-the-art security and anti-malware programs that
are spatially deployed across the network to ﬁlter the wireless
trafﬁc in order to detect and thwart malware propagation. Using
tools from percolation theory, we prove that there exists a critical
density of spatial ﬁrewalls beyond which malware outbreak is
impossible. This,
in turns, safeguards the IoT from malware
epidemics regardless of the infection/treatment rates. To this
end, a tractable upper bound for the critical density of spatial
ﬁrewalls is obtained. Furthermore, we characterize the relative
communications ranges of the spatial ﬁrewalls and IoT devices
to ensure secure network connectivity. The percentage of devices
secured by the ﬁrewalls is also characterized.

Index Terms—Percolation theory, Network Epidemics, Boolean

Model, Random Geometric Graphs

I. INTRODUCTION

The surging Internet of Things (IoT) and cyber physical
systems (CPS) are extending wireless connectivity to billions
of new devices of multitude heterogeneity [1]. In addition
to phones, tablets, and laptops, the IoT and CPS integrate
appliances, sensors, actuators, machines, robots, vehicles, and
many other smart objects to the wireless infrastructure. It is
speculated that the numbers of IoT devices per square kilome-
ters will be in the order of millions [2]. Such ubiquitous, large-
scale, diverse, and massive wireless connectivity is essential
for big data aggregation and smart world automation, which
is expected to improve almost every aspect in our lives [1].
For instance, health care providers can access real time vital
signals for patients through connected body sensors, which
improves diagnostics, enables early disease detection, and
decreases infection risks. Smart power grids utilize wireless

A. Zhaikhan, M. A. Kishk, and M.-S. Alouini are with King Abdullah
University of Science and Technology (KAUST), Thuwal 23955-6900, Saudi
Arabia. (emails: ainur.zhaikhan, mustafa.kishk, slim.alouini@kaust.edu.sa)

H. ElSawy is with the Electrical Engineering Department, King Fahd
University of Petroleum & Minerals (KFUPM), Dhahran, 31261, Saudi Arabia
(email: hesham.elsawy@kfupm.edu.sa). H. ElSawy acknowledges the support
received from the deanship of scientiﬁc research (DSR) at KFUPM under
grant no. DF191052.

connectivity of smart meters and ﬁeld devices to improve
energy generation and distribution. Intelligent transportation
systems with connected/autonomous vehicles exploit wireless
connectivity to improve road safety and reduce trafﬁc con-
gestion. Large-scale massive connectivity is also foundational
for process automation in the next industrial revolution (i.e.,
industry 4.0). In addition to the aforementioned examples,
IoT/CPS can bring unlimited potentials to many other verticals
such as crowd management, public safety, agriculture, retail,
etc.

The aforementioned beneﬁts of IoT/CPS come at the cost of
a plenty of new and challenging security threats [3]–[7]. The
IoT and CPS devices are mainly installed and controlled via
consumers who have limited knowledge about security threats
and countermeasures. The imposed high competition between
IoT vendors leads to overlooking cybersecurity aspects in
order to accelerate the production of devices and reduce their
prices. Furthermore, many of the IoT and CPS devices do
not have sufﬁcient energy, storage, or computational power
to implement up-to-date anti-malware programs and/or so-
phisticated intrusion defense mechanisms [8]–[11]. In large-
scale IoT/CPS networks, there is no distinct boundary be-
tween secured and public (i.e., unsecured) domains to enforce
security policies on the incoming/outgoing trafﬁc. The lack
of per-device defense mechanisms and network-wide security
administration open several loopholes for network intrusion
and malware inﬁltration. Even worse, exploiting the high
spatial density of devices and direct wireless connectivity (e.g.,
machine-to-machine and device-to-device communications),
the malware infection can stealthily propagate from one device
to another and form an epidemic outbreak without being
noticed to security administration [8], [12]–[14]. Malware
diffusion through the devices can be further accelerated via
emerging beyond 5G technologies such as non-orthogonal
multiple access (NOMA) and ultra-reliable low latency com-
munications (URLLC), which are meant to enhance informa-
tion dissemination.

A malware outbreak gives adversaries the opportunity to
compromise large population of IoT/CPS devices, which can
then be used to launch versatile criminal and hostile attacks.
Examples of generic IoT/CPS attacks are network-jamming,
colluded eavesdropping, spooﬁng, denial of service, and data
falsiﬁcation [15]. The negative impact of any of the afore-
mentioned attacks is proportional to the number of compro-
mised devices. It is worth noting that, in IoT/CPS systems,
adversaries can compromise, control, and manipulate physical
equipment, which may lead to physical consequences such
as equipment sabotage, power outage, vehicles collisions, or
workers injury [3]. The aforementioned security risks call for
resilient, robust, and ubiquitous security countermeasures to

 
 
 
 
 
 
2

safeguard IoT/CPS networks from large-scale malware attacks.

II. PRIOR ART & CONTRIBUTIONS

One major research direction is to develop lightweight secu-
rity countermeasures for IoT/CPS devices. Per-device IoT/CPS
security can be implemented either in hardware [16] or in
software [17], [18]. However, many IoT/CPS devices are too
constrained (e.g., storage, energy, and computational power)
to implement such per-device countermeasures. Furthermore,
due to the massive number of devices, implementation of
hardware solutions and licensing of software countermeasures
may impose overwhelming monetary costs. Hence, it is infea-
sible to ubiquitously safeguard 100% of the devices against
malware intrusion/infection [9], [10], [19]. Articulated differ-
ently, interim infection of some devices is inevitable in large-
scale massive IoT/CPS systems. Hence, timely detection and
treatment of malware is the security challenge in large-scale
IoT/CPS networks such that malware outbreak is prevented.
Otherwise the malware infection goes out of control and large
populations of devices are compromised.

To detect compromised devices, the authors in [20], [21]
propose software attestation schemes to insure the integrity
of the running software and conﬁguration of IoT devices.
However, the attestation schemes in [20], [21] are centralized,
which may impose overwhelming overhead trafﬁc and delay
to detect compromised devices. The work in [9] proposes
a game theoretic approach to select the devices that install
anti-malware programs such that an epidemic outbreak is
prevented. However, the proposed mechanism in [9] is based
on a fully mixed epidemic model,1 which is not adequate
for wireless IoT networks. Accounting for the physical layer
parameters of wireless networks, the authors in [10] propose
periodic software patching for IoT/CPS devices to elimi-
nate potential malicious codes to combat botnet formation.
the technique proposed in [10] is oblivious to
However,
the device status, which may lead to unnecessary disruption
for the IoT/CPS operation as a price for patching healthy
devices. Furthermore, compromising a device shortly after
being attested and/or patched may grant adversaries enough
time to launch malicious attacks. Such scheduled software
attestation/patching problems are more acute when employing
wireless technologies such as NOMA and URLLC due to the
accelerated epidemic infection rate.

To overcome the aforementioned problems,

the authors
in [22] propose a novel countermeasure denoted as “spatial
ﬁrewalls”. The spatial ﬁrewalls are wireless devices, with
sufﬁcient computational power, energy resources, and memory,
to store, execute, and frequently update anti-malware and
intrusion detection programs. Spatial ﬁrewalls can be edge
servers, access points, or capable IoT/CPS devices, which are
randomly deployed in the network to analyze the wireless
trafﬁc in order to detect and thwart emerging malware infec-
tions. However, the exposition in [22] is based on simulations,
which lacks the mathematical details that are necessary to

1A fully mixed epidemic model assumes that an infection (e.g., malware)
can be directly transmitted from any node in the network to any other node
in the network.

prove the concept, assess, and design spatial ﬁrewalls. In this
context, we develop a rigorous mathematical framework to
assess and design spatial ﬁrewalls. In order to account for the
underlying limited-range wireless connectivity for the ﬁrewalls
and IoT/CPS devices, we utilize percolation theory on ran-
dom geometric graphs (RGG) for the developed mathematical
framework.

It is worth noting that percolation theory on RGG is widely
used to assess information dissemination and global network
connectivity in wireless sensors networks [23], [24], robot
swarms [25], high altitude platforms [26], and connected
unmanned aerial vehicles [27]. Percolation models are also
used to study information dissemination in cognitive net-
works [28], [29]. Note that the models in [23]–[29] assume
proximity based wireless communications, which does not
account for the aggregated network interference. Interference-
aware percolation models are developed in [30], [31], where
nodes communicate if and only if the signal-to-interference-
plus-noise ratio exceeds a certain threshold. Percolation theory
is also used in [32], [33] to study private information dissem-
ination in the presence of eavesdroppers.

In this paper, we utilize percolation theory on RGG to char-
acterize wireless malware propagation in IoT/CPS networks,
and hence, prove the concept and assess the spatial ﬁrewalls
solution. That is, we mathematically prove the existence of a
critical density of ﬁrewalls beyond which malware outbreak
becomes impossible. To this end, we ﬁnd a tractable upper-
is required
bound on the critical density of ﬁrewalls that
to safeguard large-scale IoT/CPS networks against malware
epidemics. In addition, we present several insights for the
design of spatial ﬁrewalls. The contributions of this paper can
be summarized in the following points

• We deﬁne the infection susceptible graph (ISG)

to
characterize the risk malware propagation in large-scale
IoT/CPS networks.

• Using percolation theory along with the ISG, we prove
that properly designed ﬁrewalls are capable to safeguard
large-scale IoT/CPS networks from malware outbreak
irrespective of the infection propagation rate.

• We derive a tractable upperbound for the critical density
of spatial ﬁrewalls that is required to safeguard large-scale
IoT/CPS networks against malware epidemics.

• We analytically characterize the IoT/CPS communica-
tions range that allows network connectivity while pro-
hibiting malware epidemics.

• We provide several insights on the percentage of IoT/CPS

devices that are protected via the spatial ﬁrewalls.

It is worth noting that the spatial ﬁrewalls represents one
layer of the IoT cybersecurity countermeasures. In the IoT
era, specially when the devices are simple, ultra-dense, and
managed by general public, the security problem is not a
single-sided IT problem. Instead, cybersecurity in IoT is
a multi-dimensional problem that should be collaboratively
solved by wireless communication experts, machine learning
experts, hardware designers, software developers, IT experts,
in addition to IoT consumers by raising awareness regarding
cybersecurity threats. This paper focuses on the wireless com-

3

TABLE I: Table of Notations

Description

the set of IoT/CPS devices locations; their intensity; their communication range

the set of ﬁrewalls locations; their intensity; their communication range

the set of susceptible devices locations

the set of protected devices locations

the RGG representation of IoT/CPS network with vertex set Φ and edge set E

the infection susceptible graph with vertex set Ξ and edge set E

probability of percolation in G

probability of percolation in I

critical density of ﬁrewalls

hexagonal lattice; square lattice; dual of square lattice

Notation

Φ; λr; rr

Ψ; λf ; rf

Ξ = Φ \ Θ

Θ = Φ \ Ξ

G = (Φ, E)

I = {Ξ, E}

θG(λr, rr)

θI(λf , rf , λr, rr)
λc
f
Lh; Ls; Ld
s

K, KLh , KLs, KLd

s

, KI

connected component in G, Lh, Ls, Ld

s and I, respectively

δsec; δc
sec

the percentage of protected devices; critical percentage of protected devices

munications and networking aspect of the IoT and provides a
proactive countermeasure that eliminates the risk of large-scale
diffusion of malware epidemics.

A. Paper organization

The rest of the paper is organized as follows. Section
III presents the system model and formulates the large-scale
malware epidemic problem in terms of graph and percolation
theory. Section IV proves the concept of spatial ﬁrewalls and
shows the existence of a critical density for the spatial ﬁrewalls
that safeguards large-scale IoT/CPS from malware epidemics.
Section V discusses different design schemes for the spatial
ﬁrewalls. Simulation and numerical results are presented in
Sec. VI. Finally, concluding remarks are given in Sec. VII. For
the ease of mathematical exposition, frequently used symbols
are summarized in Table I.

III. SYSTEM MODEL

We consider large-scale IoT/CPS network with ad hoc
topology. In particular, the IoT/CPS devices are assumed to
be scattered in R2 according to a homogeneous Poisson point
process (PPP) Φ ≡ {x0, x1, · · · , xk, · · · } ⊂ R2 with intensity
λr. We model the locations of the IoT devices as a PPP with
density λr. Note that the PPP is commonly utilized and widely
accepted in the literature to model wireless networks due to
its tractability and practical signiﬁcance [10], [34]–[38]. The
IoT/CPS devices can establish bidirectional device-to-device
(D2D) links if they are within the wireless communication
is assumed that all devices have
ranges of each other. It
the same wireless communication range of rr meters. All
IoT/CPS devices are assumed to be too constrained to install
and execute anti-malware programs. Hence, the D2D links can
be used for legitimate code dissemination or exploited for mal-
ware infection propagation. We assume autonomous malware
worms in which compromised devices are infection threats for
all of their connected neighbors [12], [13]. Exploiting multi-
hop D2D connectivity, the malware infection may diffuse to
large population of devices and create an epidemic outbreak.

To secure such large-scale IoT/CPS network from malware
epidemic outbreak, spatial ﬁrewalls are randomly deployed
according to an independent PPP Ψ ≡ {a0, a1, · · · , ak, · · · } ⊂
R2 with intensity λf . Firewalls are computationally capable
devices (e.g., edge computing device, access point, high-end
IoT/CPS devices) that are equipped with the state-of-the-art
anti-malware programs [39]–[41]. Each ﬁrewall is assumed to
have a communication range of rf meters, and hence, each
ﬁrewall creates a secured zone of radius rf around itself.
Due to the higher transmit power and better signal capture
capabilities of ﬁrewalls, it is assumed that the ﬁrewalls have
larger communication and detection ranges than the IoT/CPS
devices (i.e., rf ≥ rr). IoT/CPS devices within secured
zones inquire the ﬁrewall about software codes received from
the wireless interface. The ﬁrewalls scan inquired codes for
security threats. If the code is legitimate and free from malware
threats, the ﬁrewalls approves it. Otherwise, the code is disap-
proved and reported to the security administration for further
action.2 Consequently, IoT/CPS devices within secured zones
are protected from malware infection and do not participate
in malware propagation. On the other hand, devices outside
secured zones have no direct connectivity with ﬁrewalls, and
hence, they opt to directly execute and relay the codes received
from the wireless interface. Hence, devices that are outside
secured zones are susceptible to malware infection and may
participate to malware propagation. In practice, we can expect
that spatial ﬁrewalls are continuously updated, monitored and
maintained with highly skilled personnel. Hence, in analysis,
we assume that spatial ﬁrewalls are never compromised with
attackers and can ensure almost 100% security. The operation
of the spatial ﬁrewalls in large-scale IoT/CPS is depicted in
Fig. 1. As shown in the ﬁgure, if the ﬁrewalls are dense
enough, the collective impact of secured zones can thwart
malware outbreak by spatially quarantining malware infections
within ﬁnite region. The ﬁrewalls can then report
to the
security administration about detected malware for localized

2For instance, the security administration may need to launch a patching
campaign to recover compromised devices and prevent further propagation of
the malware to other vulnerable devices.

4

Fig. 1: Illustration of spatial ﬁrewalls operation.

patching and treatment of compromised devices. As shown in
Fig. 1, the IoT/CPS network is composed from three types of
devices:

• Spatial ﬁrewalls are capable devices, equipped with the
state-of-the-art anti-malware programs, that are spatially
distributed across the network.

• Protected devices are IoT/CPS devices that fall within
the secured zone of a ﬁrewall, and hence, can not be
infected with malware and do not participate in malware
propagation.

• Susceptible devices are IoT/CPS devices that fall outside
the secured zone of a ﬁrewall, and hence, can be com-
promised and may participate in malware propagation.

all other devices in G. This is because there might not be a
multi-hop route in E that connects the compromised device
to all other devices in G. The mutual infection threat between
devices in G is speciﬁed through the connected components,
which are deﬁned as:

Deﬁnition 1 (Connected Component). A connected component
is a sub-graph K ⊆ G(Φ, E) with the largest possible devices
such that, within K, any device xi ∈ K can always ﬁnd a
multi-hop route through a set of consecutive edges in E to
any other device xj ∈ K, i (cid:54)= j. Consequently, a malware
inﬁltration to any device xi ∈ K represents an infection
threat for all devices xj ∈ K for i (cid:54)= j.

A. Mapping to Graph and Percolation Theory

To study and characterize malware propagation in IoT/CPS
networks and assess the impact of spatial ﬁrewalls, we utilize
graph and percolation theory. In particular, the IoT/CPS net-
work is mapped to a RGG, denoted as G = {Φ, E}, where
the devices Φ are mapped to the graph vertices. Accounting
for the limited wireless D2D communications range of rr, the
set of edges E is deﬁned as

E = {xixj : (cid:107)xi − xj(cid:107) ≤ rr, xi, xj ∈ Φ} ,
(1)
where (cid:107)·(cid:107) denotes the Euclidean norm and xixj is the edge
connecting xi and xj. The edges deﬁned in (1) represent
bidirectional direct (i.e., one hop) D2D connectivity between
devices. The bidirectional links in E can be used for legitimate
trafﬁc dissemination or malware propagation. An infection
from a device in G can reach its direct D2D neighbor devices
in one hop. Furthermore, an infection from a device in G
can also reach non-neighbor distant devices through multi-
hop connectivity if there exists a route in E that connects the
compromised device to the distant device. However, due to
the random devices locations and limited wireless D2D range,
a compromised device does not imply an infection threat to

Based on Deﬁnition 1 and the ability of malware infection
to exploit multi-hop connectivity, a compromised device is
an infection threat to all devices within its own connected
component. Hence, the infection threat is directly proportional
to the size of connected components. Small values of λr
and/or rr lead to sparse vertices in Φ, and hence, the graph
G will be consisting from several disjoint small connected
components. In such case, there is no risk of an epidemic
outbreak due to the lack of multi-hop wireless connectivity that
connects large population of devices. Increasing λr and/or rr,
the connected components start to merge together into larger
components and an infection becomes threatening to a larger
number of devices. Sufﬁciently high λr and/or rr create a
giant component that connects inﬁnite number of devices [42],
[43]. The existence of a giant component implies the risk of
an epidemic outbreak that gets out of control and compromise
large-population of IoT/CPS devices. Characterizing the net-
work parameters that lead to the existence/absence of the giant
component is the core focus of percolation theory. Formally,
the percolation probability on the graph G, as a function of
λr and/or rr, is deﬁned as

Deﬁnition 2 (Percolation Probability). Percolation probability

Quarantined!Secured deviceSpatial firewallSusceptible deviceMalware propagationLegitimate code dissemination Integrity query Execution approvalExecution disapprovalAdversary Legitimate operator  Compromised deviceWireless transmissionSecured zone𝑟𝑓deﬁnes the probability of existence of inﬁnitely large connected
component K ⊆ G, deﬁned as

θG(λr, rr) = P{|K| = ∞},
(2)
where | · | denotes the set cardinality. A non-zero percolation
probability θG(λr, rr) > 0 deﬁnes the super-critical regime in
which the network percolates and a giant component exists.
On the other hand, a zero percolation probability θG(λr, rr) =
0 deﬁnes the sub-critical regime with no percolation and no
giant components.

In the context of the malware infection in IoT/CPS network,
the super-critical regime implies the risk of having a large con-
nected population of devices that are vulnerable to an epidemic
outbreak if a single device is compromised. The relative values
of λr and rr that lead to super-critical regime operation and
raise the risk of malware epidemic in the depicted IoT/CPS
network is deﬁned in the following proposition.

Lemma 1. The IoT/CPS network operates in the super-critical
regime θG(λr, rr) > 0, and hence, is susceptible to malware
epidemic if and only if

λr ≥

λc(1)
r2
r

,

(3)

where λc(1) ≈ 1.44.

Proof: The proof is similar to [44, Chapter 2] which
characterizes continuum percolation on PPP networks with
homogeneous communication ranges.

If (3) is not satisﬁed, the IoT/CPS network is physically
immune to malware epidemics. That is because if the defence
mechanism of an IoT device is beaten by the attacker, the
largest infected region will still be ﬁnite.

Remark 1. λc(1) deﬁned in Lemma 1 is the critical (i.e.,
minimum) intensity of nodes required for continuum per-
colation in homogeneous PPP network with a normalized
communication range 1. There is no known exact value for
λc(1) in the literature. However,
there exists some useful
approximations in literature such as λc(1) ≈ 1.44 [45].
There are also analytically derived lower and upper bounds:
0.768 < λc(1) < 3.37 [44], [46].

If the condition deﬁned in (3) of Lemma 1 is not satisﬁed,
then the IoT/CPS network is physically immune to malware
epidemics due to the lack of multi-hop D2D connectivity
that can be exploited to transfer malware infection to large-
population of devices. Otherwise, the IoT/CPS network is at
risk of malware epidemic and the spatial ﬁrewalls counter-
measure is required. Note that in dense IoT/CPS networks,
the condition in (3) is usually satisﬁed.

As discussed earlier, the spatial ﬁrewalls introduce spatial
secured zones that protect some IoT/CPS devices and thwart
malware propagation.3 To incorporate the impact of spatial
ﬁrewalls to the mathematical framework, the vertices Φ in the

3Different form traditional reactive cybersecurity countermeasures,
the
proposed spatial ﬁrewall solution is a proactive networking solution that
eliminates network-wide malware infection risks rather than reacting to local
attacks. To defend against local attacks (i.e., within single or multiple prox-
imate susceptible devices), there should be complementing reactive security
countermeasure.

5

RGG G are further divided into susceptible devices Ξ ⊆ Φ and
protected devices Θ ⊆ Φ such that Ξ ∪ Θ = Φ and Ξ ∩ Θ = ∅.
(cid:107)xi − aj(cid:107) ≤ rf },
The protected set Θ = {xi ∈ Φ : min
aj ∈Ψ

where min
aj ∈Ψ

(cid:107)xi − aj(cid:107) is the minimum distance between xi
and all ﬁrewalls in Ψ. Hence, Θ contains all the devices
that are located within the secured zones of the ﬁrewalls,
i.e., the devices that can neither be infected nor participate
in malware propagation. On the other hand, the susceptible
(cid:107)xi − aj(cid:107) > rf } contains the devices
set Ξ = {xi ∈ Φ : min
aj ∈Ψ

that are located outside the secured zones of all ﬁrewalls. A
pictorial illustration for a realization of G = (Φ, E) before
and after deploying spatial ﬁrewalls is shown in Fig. 2.

To characterize the impact of spatial ﬁrewalls, we deﬁne
the infection susceptible graph (ISG) I = {Ξ, E}, with all
susceptible devices in Ξ and set of edges E, which contains
all the D2D links that can be exploited for malware infection
propagation. The set E is deﬁned as

E

(a)
= {xixj : (cid:107)xi − xj(cid:107) ≤ rr, xi, xj ∈ Ξ} .
The ISG is illustrated in Fig. 2b, which highlights all suscep-
tible deceives and their D2D connectivity. It is worth noting
that an infection cannot propagate from a device in Ξ to a
device in Θ, or vice versa, due to the ﬁrewall protection for
all devices in Θ. Hence, the deﬁnition in (4) for the edges in
E is restricted to the susceptible devices in Ξ.

(4)

It is clear that the ISG is a subset of the IoT/CPS network
graph I ⊆ G. At the absence of spatial ﬁrewalls (i.e., λf = 0),
all the devices are susceptible to infection, and hence, the
ISG coincides with the IoT/CPS network graph I = G(Φ, E).
Deploying spatial ﬁrewalls splits the set Φ into protected Θ
and susceptible Ξ devices. The ISG I can be constructed by
removing the vertices in Θ and their associated edges from
G(Φ, E). Given that G operates in the super-critical regime,
the objective is to deploy sufﬁciently dense spatial ﬁrewalls
(i.e., λf ) such that the ISG I ⊆ G operates in the sub-
critical regime. Note that the sub-critical regime operation
of I ⊆ G implies that
the risk of malware epidemic is
eliminated. Consequently, the IoT/CPS network is safeguarded
from malware epidemics regardless of the malware infection
rate. Let KI ⊆ I be the largest connected component in
the ISG I and let θI(λf , rf , λr, rr) = P{|KI| = ∞} be
the percolation probability of the ISG I. Then, the design
objective of the spatial ﬁrewalls is formally deﬁned as

minimize
subject to θI(λf , rf , λr, rr) = 0,

λf

(5)

To minimize the monetary cost (e.g., deployment and/or
anti-malware licensing) of spatial ﬁrewalls, it is desirable to
ﬁnd the minimum intensity of ﬁrewalls that safeguards the
IoT/CPS network against malware epidemics. In the notion of
percolation theory, the optimal λ∗
f is denoted as the critical
density for percolation.

IV. PROOF OF CONCEPT

This section proves the concept of spatial ﬁrewalls by
showing that there exists a phase transition for the percolation

6

(a)

(b)

Fig. 2: The left ﬁgure shows a realization of G(Φ, E) before the deployment of spatial ﬁrewalls. The right ﬁgure shows the
impact of spatial ﬁrewalls (blue triangles with green secured zones), which splits G(Φ, E) into the ISG I = {Ξ, E} (orange
connected nodes) and protected deceives Θ (grey nodes).

probability of the ISG. In particular, there is a critical intensity
of spatial ﬁrewall λc
f below which the ISG operates in the
super-critical regime. Hence, if the ﬁrewalls are not dense
enough, the percolation probability is non-zero and the risk
of malware epidemic exists. If the intensity of ﬁrewalls is
above the critical intensity λc
f , the ISG operates in the sub-
critical regime, which eliminates the risk of malware epidemic
by enforcing a zero percolation probability. To complete the
proof of concept, we show that the percolation probability
is monotonically decreasing in λf , which proves the phase
transition at a critical intensity λc
f . Hence, the critical intensity
λc
f is the optimal density that minimizes (5).
For

the sake of organized presentation, Section IV-A
presents the sub-critical regime operation for the ISG, which
proves the effectiveness of the spatial ﬁrewalls. Then, Sec-
tion IV-B presents the super-critical regime operation for the
ISG, which proves the need for dense enough spatial ﬁrewalls.
Last but not least, Section IV-C completes the proof of concept
by showing the monotonicity of the percolation probability in
λf .

A. Sub-critical regime

This section proves that sufﬁciently dense ﬁrewalls enforce
a sub-critical regime operation for the ISG, which safeguards
the IoT/CPS networks against malware epidemics. To ﬁnd
sufﬁcient conditions for spatial ﬁrewalls intensity that enforces
sub-critical regime operation for the ISG, a worst case scenario
of rf = rr is assumed. Such sufﬁcient ﬁrewalls intensity
would also enforce sub-critical regime for the general case
of rf ≥ rr. For tractable analysis, the common practice in
percolation theory is to study continuum percolation in RGG
by mapping them to discrete lattices. Inspired by [32], we

prove the sub-critical regime operation by mapping the ISG
to hexagonal lattice as deﬁned in the sequel.
Mapping to a Hexagonal Lattice: Let Lh be a hexagonal
lattice with a side equal to the D2D communication range rr,
which is also equal to the secured zone radius is (i.e., rf = rr).
Let H denote a randomly selected hexagon, also denoted as a
face, in Lh. Depending on the ﬁrewalls occupancy, a face H
can be either open or closed, as explained next.
Deﬁnition 3 (Closed/Open face in Lh). Let {Ti}3
i=1 denote
three non-adjacent equilateral triangles within a face H as
shown in Fig.3a. Then, the face H is said to be closed if
each of these triangles is occupied with at least one ﬁrewall.
Otherwise, the face H is denoted as an open face.

Deﬁnition 3 is chosen such that the absence of open face
percolation in Lh assures no continuum percolation in the ISG
I = (Ξ, E). In particular, open face percolation is obstructed
by closed faces. In our setup, a closed face deﬁnes a protected
geographical region (i.e., by secured zones of ﬁrewalls) that
cannot be crossed by a malware infection. More precisely,
due to the union of the secured zones of the ﬁrewalls within
the triangles {Ti}3
i=1, an infected device within the vicinity
of a closed face will not have any susceptible device within
its D2D reach through the closed face. Articulated differently,
there could not be susceptible edges in E of the ISG that
passes through a closed face in Lh. A sequence of connected
closed faces form a closed path, which further extends the
ﬁrewalls spatial protection to larger connected (i.e, no gaps for
malware propagation) geographical region. A path that starts
and ends at the same face is denoted as a closed circuit. A
closed circuit on Lh implies no open face percolation on Lh,
which also implies ﬁnite connected component in I = (Ξ, E).
Hence, closed circuit on Lh means spatially quarantined (i.e.,

surrounded) malware. A pictorial illustrations of a closed face
and a closed circuit are shown in Fig. 3b.

As illustrated above, malware infection is obstructed by
closed faces. Hence, an infection that originated within a
closed circuit is spatially quarantined within the connected
component of the infected device. Due to the stationarity of
the PPP, there is no loss of generality to assume that the
infection originates at the device located at the origin. Hence,
it is sufﬁcient to prove that the origin is surrounded by a closed
circuit to prove that the ISG operates in the sub-critical regime.
The coupling between the hexagonal lattice Lh and the ISG
I is formally stated and proved in the following lemma.

Lemma 2 (Hexagonal lattice coupling). Let KI(0) ⊆ I(Ξ, E)
and KLh (0) ⊆ Lh denote connected components around the
origin in, respectively, the ISG I and the hexagonal lattice
Lh. If KLh (0) is surrounded with closed-circuit C(0) in Lh,
then KI(0) is ﬁnite.

Proof: A closed circuit around the origin implies a
ﬁnite number of open faces on the inner side of the circuit.
Consequently,
|KLh(0)| < ∞ and the region covered by
KLh (0) involves a ﬁnite number of vertices of I(Ξ, E). Hence,
to prove that KI(0) is ﬁnite, it is sufﬁcient to prove that
no edge of I(Ξ, E) crosses C(0). Let us consider an extreme
scenario for the closed face with the worst spatial setup for
the three ﬁrewalls and IoT/CPS devices, shown in Fig.3a. In
particular, assume each of the triangles {Ti}3
i=1 has only one
ﬁrewall in the shown worst case locations such that their
secured zones provides minimum protection (i.e., coverage)
of the closed face. Furthermore, let us consider the most
advantageous location for the IoT/CPS devices for malware
infection propagation as shown Fig.3a. Recall that the side
of each equilateral triangle is rr, then we have one of the
following two scenarios. 1) If the two devices are within the
D2D communication range of each other, then one of them
should be in Θ (i.e., within the secured zone of one or more
of the three spatial ﬁrewalls). 2) If both devices are in Ξ
(i.e., both of them are out of the range of the three ﬁrewalls),
then they are out of the D2D communication range of each
other (i.e., the condition in (4) is not satisﬁed). The example
shown in Fig.3a shows that even in the worst case spatial
setup of ﬁrewalls, an infection cannot bypass the closed face.
Therefore, no edge in E can cross C(0), and hence we conclude
that a ﬁnite |KLh(0)| leads to a ﬁnite |KI(0)|.

Exploiting the mapping to the hexagonal lattice and the
coupling introduced in Lemma 2, we can state the main result
of this section in the following proposition

Proposition 1 (Sufﬁcient condition for zero percolation on
ISG). For given λr > 0 and rr > 0, the ISG operates in the
sub-critical regime (i.e., θI(λf , rf , λr, rr) = 0) if

λf >

3.65
r2
r
Proof: Referring to the results in Lemma 2, a closed
circuit C(0) on the hexagonal lattice Lh implies sub-critical
regime operation of the ISG I. Based on the results in [47],
the origin is almost surely (a.s.) surrounded with closed circuit

(6)

.

C(0) in Lh if

P (H is closed) >

1
2

.

7

(7)

From the PPP properties of the spatial ﬁrewalls we have





P (H is closed ) = P



(cid:92)

|Ti ∩ Ψ| ≥ 1



i=1,2,3

= (1 − P (|T1 ∩ Ψ| = 0))3

(cid:16)

=

1 − e−λf

√

3

4 r2

r

(cid:17)3

.

(8)

Substituting (8) back in (7), we conclude that the origin is a.s
surrounded with closed circuit C(0) in Lh if

(cid:16)

1 − e−λf

√

3

4 r2

r

(cid:17)3

>

1
2

.

(9)

Rearranging the terms of (9) and following to the statement
of Lemma 2 we conclude that there is a closed circuit C(0) in
Lh if λf > 3.65/r2
r . Meanwhile, the existence of C(0) assures
KLh (0) < ∞. Hence, λf > 3.65/r2
r is the condition that
guarantees that the ISG I(Ξ, E) does not percolate, which
concludes the proof of Proposition 1.

Before switching the discussion to the super-critical regime
operation of the ISG, it is worth stating the following two
important remarks.

is important

to note that

Remark 2. It
the condition in
(6) that enforces sub-critical regime operation of the ISG
is independent of the IoT/CPS devices intensity λr. This is
because the proof of Proposition 1 is based on the collective
ability of the secured zones to spatially quarantine malware
infection within ﬁnite region. That is, the condition in (6)
implies that the spatial ﬁrewalls are dense enough to construct
continuous secured zones that surround any malware infection
to safeguard the IoT/CPS from malware epidemic regardless
of the IoT/CPS devices intensity.

Remark 3. The proof of Proposition 1 is based on the
assumption that rr = rf . The case of rf > rr also satisﬁes
Deﬁnition 3 for the closed face. In fact, increasing rf expands
the secured zone of H. Hence, the expression for λf that
satisﬁes (7) is also sufﬁcient for no percolation when rf ≥ rr.
Therefore, the proof of Proposition 1 is also valid for the case
of rf ≥ rr.

B. Super-critical regime

This section shows that insufﬁcient deployment of spatial
ﬁrewalls leads to a super-critical regime operation for the ISG,
which implies that the IoT/CPS network is at a risk of malware
epidemics. For a tractable analysis for the super-critical regime
operation, we map the ISG to a square lattice as deﬁned in
the sequel.

. The dual lattice Ld

Mapping to a Square Lattice: Let Ls be a square lattice
with side s = rr√
s is a translated version
5
of Ls with the translation magnitude ( s
2 ). That is, Ld
s =
Ls + ( s
2 ). Without loss of generality, it is assumed that
one of the vertices of Ld
s is the origin. Let e denote an edge
common to two adjacent squares S1(e) and S2(e) in Ls and
e d is the corresponding dual edge in Ld
s. According to the

2 , s

2 , s

8

(a) A closed face illustration.

(b) A closed circuit around the origin.

Fig. 3: Illustrating the concept of closed face and closed circuit in the hexagonal lattice Lh.

spatial ﬁrewalls and IoT/CPS devices locations, the edge e
can be either open or closed as deﬁned below.

Deﬁnition 4 (Open/closed edge). Let {vk }4
k=1 denote ver-
tices of a rectangle formed by the union S1(e) ∪ S2(e).
let A(e) be the smallest square containing circles
Also,
{C(vk , rf )}4
k=1. where C(a, r) denotes a circle of radius r
centered at a. Then an edge e is deﬁned to be open if i) each
of S1(e) and S2(e) has at least one IoT/CPS device, and ii)
there are no ﬁrewalls within A(e). Otherwise, the edge is said
to be closed.

A pictorial illustration of the square lattice mapping with
an open edge e is shown in Fig 4. The rectangular lattice
mapping is chosen to deﬁne a geographical region that con-
tains a connected component of susceptible devices in the
ISG I = {Ξ, E}. Since A(e) is free from ﬁrewalls, then
the region covered by S1(e) ∪ S2(e) is located outside the
secured zones of all ﬁrewalls. Furthermore, since each of
S1(e) and S2(e) has at least one IoT/CPS device, then the
region S1(e) ∪ S2(e) contains some vertices of Ξ. Lastly,
since the largest distance (i.e., the diagonal) within the region
S1(e) ∪ S2(e) equals to rr, all devices that are located within
S1(e) ∪ S2(e) are within the D2D range of each other. Hence,
the region deﬁned by S1(e) ∪ S2(e) contains devices in Ξ
that are all connected to each other with edges in E. The
connectivity within S1(e) ∪ S2(e) (i.e., open edge in Ls)
is also represented via an open edge in the dual lattice Ld
s.
Hence, bond percolation on the square lattice Ld
s implies
inﬁnite connected component in I = {Ξ, E}. To study bond
percolation of Ld
s, we focus on the connected component that
contains the origin. As mentioned before, there is no loss in
generality to focus on the origin due to the stationarity of the
PPP. The coupling between the square lattice Ld
s and the ISG
I = {Ξ, E} is formally stated in the following lemma.

Fig. 4: An illustration of the open edge e in the square lattice
Ls., where red dots denote susceptible devices, blue dots
denote protected devices, and crosses denote spatial ﬁrewalls.

Lemma 3 (Square lattice coupling). Let KLd
connected component in Ld
is inﬁnite, then KI(0) is also inﬁnite.

s containing the origin. If KLd

(0) denote a
(0)

s

s

s

s

Proof: Let a path PLd

denote a sequence of connected
open edges in Ld
s. Since there is one to one mapping between
dual and prime edges, PLd
is uniquely associated with an-
other path PLs ∈ Ls, in which all edges are also open.
Furthermore, PLs is associated with a unique sequence of
pairs, where each pair is composed
{S1(ei), S2(ei)}ei∈PLs
of single connected component within the ISG I. Hence, an
inﬁnite-length path in Ld
s implies that there is an inﬁnite
sequence of connected susceptible devices that are members
of the same connected component in I(Ξ, E).

closed face𝑻𝟏open face𝑟𝑟𝑻𝟐𝑻𝟑𝑟𝑓closed circuit𝐴(𝑒)𝑟𝑟5𝑟𝑓𝑣2𝑣1𝑣3𝑣4𝑆1(𝑒)𝑆2(𝑒)𝒆it

By virtue of Lemma 3,

to characterize
is sufﬁcient
percolation in Ld
s to prove the super-critical regime of the
ISG I(Ξ, E). However, before delving into the analysis, it is
important to note the dependency between proximate edges,
as stated in the following remark.

Remark 4 (Edge dependencies). Since an open edge e ensures
that ﬁrewalls are absent from the region A(e), then the status
of proximate edges are correlated. The status of two edges are
independent if they do not share a common spatial region that
requires the absence of spatial ﬁrewalls. Hence, the smallest
distance that ensures independent edges is 2s(cid:100) rf
s (cid:101) horizontally
and 2s(cid:100) rf

s (cid:101) + 2s vertically.

Now we are in position to study the super-critical regime of
the ISG, which is characterized in the following proposition.

Proposition 2 (Sufﬁcient condition for non-zero percolation
on ISG). For given rr > 0 and λr > 0, the ISG operates in
the super-critical regime (i.e., θI(λf , rf , λr, rr) > 0) if




(cid:17)

(cid:16)

1 − exp
√

ln



− λrr2

r

5

1 − β

 ,

(10)

λf <

10
NAr2
r
√

10

where β = ( 11−2
27
√
5rf
a = 2(cid:100)
rr

(cid:101) + 2 and b = 2(cid:100)

(cid:101) + 1.

√

5rf
rr

)N , N = 8ab − 2a − 6b + 1, NA = ab,

s

s

s

Proof: To prove the proposition, we characterize the
conditions which ensure that the probability of no percola-
tion is strictly less than one. Hence, the probability of the
complement event (i.e., percolation) is strictly greater than
zero. As mentioned in Lemma 3, a ﬁnite KLd
(0) implies no
percolation on Ld
s, which in turns implies sub-critical regime
the ISG. In the following, we ﬁnd the conditions that
of
ensures that P{|KLd
(0)| < ∞} < 1. Hence, such conditions
also implies non-zero probability of the complement event
P{|KLd
(0)| < ∞}) > 0. Hence,
the ISG has non-zero probability to operate in the super-
critical regime.

(0)| = ∞} = (1 − P{|KLd

Let PLs(n) denote a path of length n edges {ei}n

i=1 ∈ Ls.
From the coupling between the dual and primal square lattices,
it can be inferred that KLd
(0) is ﬁnite iff there is a closed
for the
circuit path in Ls around the origin. To account
edge dependencies within the path PLs(n), we recall from
Deﬁnition 4 that
if
(A(ei) ∩ A(ej)) = ∅. Let N denote the number of edges
in A0(e) and let SI ⊆ PLs(n) denote the subset of all inde-
pendent edges in PLs(n). Then, the set SI has a cardinality of
at least n/N . The construction of A0(e) and the computation
of N are illustrated in Appendix A.

the edges ei and ej are independent

s

s

It is shown in [48] that there are 4n3n−2 possible ways to
construct a circuit of length n around the origin. Therefore,
the probability that a closed path exists around the origin is
expressed as

Pc =

≤

(cid:88)

n
∞
(cid:88)

n=1

4n3n−2P{PLs(n) is closed}

4n3n−2q

n

N =

N

4q 1
3(1 − 3q 1

N )2

,

(11)

where q ≡ P{e is closed} and the last equality in (11) is

9

√

obtained by treating the sum as a derivative of geometric series
with respect to q1/N . To ensure that Pc is strictly less than 1,
the following condition must be satisﬁed

10

(12)

)N .

q < (

= 1 − (1 − e−λrs2

11 − 2
27
Based on Deﬁnition 4, an explicit expression for q can be
found as follows
q = 1− P{Φ ∩ S1(e) (cid:54)= ∅ & Φ ∩ S2(e) (cid:54)= ∅ & Ψ ∩ A(e) = ∅}
(13)
where NA is the number of squares covered by A(e). From
Fig. 4, NA = (2(cid:100)
(cid:101) + 1). The condition
in (12) ensures that P{|KLd
(0)| < ∞} < 1, which implies
non-zero probability of percolation. Hence, substituting (13)
into (12) and after some basic algebraic manipulations, we
can ﬁnally get the result in (10).

)2e−λf NAs2

(cid:101) + 2) × (2(cid:100)

5rf
rr

5rf
rr

√

√

,

s

Remark 5. Proposition 2 shows that the super-critical regime
operation, which raises the risk of malware epidemic requires
both i) sufﬁciently dense IoT devices and ii) sufﬁciently sparse
ﬁrewall deployment. More precisely, (10) shows an inverse
relationship between λr and λf to allow long-range malware
propagation. Hence, it may be apparent that higher intensity
of IoT/CPS devices requires higher intensity of ﬁrewalls to
spatially quarantine malware infections. However, this is only
true up to the threshold shown in Proposition 1. This is
because the intensity shown in Proposition 1 implies that
the ﬁrewalls are dense enough such that the union of their
secured zones form continuous circles in the spatial domain
that surrounds and thwarts any emerging malware infection.
Hence, the intensity of spatial ﬁrewalls shown in Proposition 1
safeguards the IoT/CPS network from malware epidemics
irrespective of the IoT/CPS devices intensity.

C. Phase transition

This section shows that the percolation probability of the
ISG exhibits a phase transition property in the intensity
of ﬁrewalls λf . Hence, the percolation critical intensity of
ﬁrewalls is the unique intensity that minimizes (5). Such phase
transition behavior is formally stated in the following theorem.

Theorem 1 (Phase transition). Let θI(λf , rf , λr, rr) denote
the percolation probability of the ISG I(Ξ, E), then ∀λr > 0
there exists a critical value λc
f < ∞ for the density of ﬁrewalls
such that

θI(λf , rf , λr, rr) > 0,
θI(λf , rf , λr, rr) = 0,

for λf < λc
f
for λf > λc
f

.

(14)

Proof: We start the proof by showing that the percolation
probability θI(λf , rf , λr, rr) is non-increasing function in λf .
Consider two sets of ﬁrewalls Ψ1 and Ψ2 with intensities
λf1 < λf2 , respectively. Owing to the fact that both Ψ1 and Ψ2
are PPPs and that λf1 < λf2, then Ψ1 can be constructed by
thinning Ψ2 with probability λf1
[49, Chapter 2]. As thinning
λf2
implies random removal of nodes, then |Ψ1∩A| ≤ |Ψ2∩A| for
any A ∈ R2. For the set of IoT devices Φ, the set of protected
devices is deﬁned as Θi = {xi ∈ Φ : min (cid:107)xi − Ψi(cid:107) < rf }
for i ∈ {1, 2}, and hence, |Θ1∩A| ≤ |Θ2∩A| for any A ∈ R2.

10

the critical intensity of ﬁrewalls that safeguards such IoT/CPS
network from malware epidemics is bounded by

λc
f ≤

λc(1)
f − r2
r

4r2

,

(15)

where λc(1) is given in Remark 1.

Proof: The construction of the ISG graph is based on the
interaction between the IoT/CPS devices in Φ and the ﬁrewalls
in Ψ. Particularly, the devices in the ISG Ξ = Φ \ Θ are the
IoT/CPS devices in Φ that exists outside the secured zones of
the ﬁrewalls in Ψ. Hence, Ξ and Ψ can be treated as an overlay
of two non-intersecting networks: a network of ﬁrewalls and
a network of susceptible devices. Let us deﬁne the vacant
space V = {x ∈ R2 : min (cid:107)x − Ψ(cid:107) > rf } as all spatial
regions in R2 that are not covered by the secured zones of
the ﬁrewalls in Ψ. By virtue of the exclusive relation between
I = {Ξ, E} and Ψ, an inﬁnite connected component in I
necessitates an inﬁnite vacant component within V. Hence, to
prove Theorem 2, we analyze the condition for the existence of
an inﬁnite vacant component (i.e., inﬁnite continuous space)
in V. Let us consider the worst-case arrangement shown in
Fig. 6. The ﬁgure shows two IoT/CPS devices that are exactly
rf away from the nearest ﬁrewall and rr away from each
other. Such setup depicts the minimum vacant space W that
allows for malware propagation between two IoT/CPS devices
in Φ, where ro is the minimum distance from any ﬁrewall in Ψ
and W . Therefore, the minimum requirement for the existence
of an inﬁnite path in I corresponds to the case of having
an inﬁnite vacant component in the Poisson Boolean model
4 − (cid:15)2
[42] with the intensity λf and radius ro ≡
2 .
Following [28] it can be shown that the critical intensity for
coverage percolation of a Boolean model with secured zones
of radius r is

λc(1)
(2r)2 .
Substituting the value for ro in (16), we conclude that there
is no inﬁnite vacant component in V if

f − r2
r2

(16)

(cid:113)

r

(17)

λf ≥

(cid:18)

(cid:113)
2

λc(1)

(cid:19)2 .

r

4 − (cid:15)2

f − r2
r2
Hence, the ﬁrewall intensity in (17) prohibits percolation in
I. Owing to the fact that the critical intensity is the minimum
intensity of ﬁrewalls that prohibit percolation in I and taking
the limit (cid:15)2 −→ 0, we ﬁnally get the upper-bound in (15).

The results in Theorem 2 shows that any ﬁrewall intensity
equal to or above the threshold shown in (15) is ensured to
safeguard the IoT/CPS networks from malware epidemics. Dif-
ferent from Theorem 1, the threshold shown in (15) accounts
for the larger communication/detection range of ﬁrewalls when
compared to the IoT/CPS devices. Capitalizing on Theorem 2,
it is possible to prohibit malware epidemics through the design
of the communication range of the IoT/CPS devices as an
alternative to deploying more spatial ﬁrewalls. However, it
should be noted that the communication range of the IoT/CPS
devices should ensure global network connectivity. The D2D
communication range that ensures both global network con-
nectivity and prohibits malware epidemics is stated in the

Fig. 5: Existence of critical density of ﬁrewalls.

Now consider two ISGs I1 = (Ξ1, E1) and I2 = (Ξ2, E2)
constructed with the same parameters λr, rr and rf but with
the different sets of ﬁrewalls Ψ1 and Ψ2. Since Ξi = Φ \ Θi
for i ∈ {1, 2}, then |Ξ1 ∩ A| ≥ |Ξ2 ∩ A| for any A ∈ R2.
So, it is valid to state that KI1 (0) ⊇ KI2(0). Therefore, the
condition 0 < λf1 < λf2 implies that θI(λf1 , rf , λr, rr) ≥
θI(λf2 , rf , λr, rr), and hence, θI(λf ) is a non-increasing
function of λf .

Recall that θI(λf1 , rf , λr, rr) > 0 for λf < λL as shown
in Proposition 2. Also, θI(λf1 , rf , λr, rr) = 0 for λf > λU
as shown in Proposition 1. Since θI(λf1, rf , λr, rr) is non-
increasing in λf , there should be a critical value λc
f that exhibit
the phase transition indicated in (14) and depicted in Fig.5.

V. SECURED IOT/CPS NETWORK DESIGN

Section IV proves the concept of spatial ﬁrewalls. In particu-
lar, Theorem 1 shows that the phase transition critical intensity
λc
f is the minimum intensity of ﬁrewalls that safeguards
the IoT/CPS from malware epidemics. Hence, λc
f implies
minimum deployment and licensing cost for spatial ﬁrewalls.
However, as in the majority of continuum percolation models,
there is no exact expression for λc
f . Hence, approximations
and bounds are always sought. Proposition 1 shows sufﬁcient
conditions for the ﬁrewalls intensity to safeguards IoT/CPS
networks from malware epidemic. However,
the sufﬁcient
condition of Proposition 1 can be regarded as a loose upper-
bound on λc
f as it assumes a worst case scenario of rf = rf .
Furthermore, Proposition 1 restricts the vulnerable and secured
regions to hexagonal shapes. Relaxing the assumptions of
Proposition 1, the following theorem presents a tight upper-
bound for λc
f , which provides an economical design of spatial
ﬁrewalls. In addition, Theorem 2 gives extra parameter for
manipulation of λc

f upperbound.

Theorem 2. Consider an IoT/CPS network with devices
intensity λr > 0 and D2D communications range rr > 0.
To secure such IoT/CPS network, spatial ﬁrewalls with com-
munication/detection range of rf ≥ rr are deployed. Then,

LfcUsuper-criticalsub-  critical is bounded within the following range

11

0.67 ≤ δc

sec ≤ 0.78,

(21)
where the upper limit corresponds to rf = rr and the lower
limit corresponds to the rf (cid:29) rr. Note that δsec approaches the
lower limit rapidly with increasing rf , which appears within
a quadratic term inside the exponential function.

Remark 6. The results in Theorem 2 and (21) show that
lower values of rf necessitate higher intensity of ﬁrewalls
to safeguard the IoT/CPS network. That is, lower values of
rf requires protecting at most 10% more IoT/CPS devices to
safeguard the IoT/CPS network from malware epidemics.

The results in (20) and (21) also show the percentage of
devices that are required to be secured by spatial ﬁrewalls to
safeguard the IoT/CPS networks from malware epidemics.

VI. NUMERICAL AND SIMULATION RESULTS

The simulation of the IoT/CPS network is implemented in
Matlab. In each simulation run, two independent PPPs with
intensities λf device/m2 for ﬁrewalls and λr device/m2 for
IoT/CPS devices are scattered over a square region of size
100 × 100 m2. The set of protected devices Θ and the set of
susceptible devices Ξ are ﬁrst identiﬁed based on the distances
between the IoT/CPS devices and ﬁrewalls. The ISG I(Ξ, E)
is then constructed based on the D2D communication range
among the susceptible devices in Ξ. Percolation is declared on
I(Ξ, E) if it contains a connected component that spans the
simulation region from left to right and from bottom to top.
Percolation probability is then calculated by averaging over
several realizations of the Monte-Carlo simulations. The unit
of λr, λf , and λc
f in all the ﬁgures is device per square meter.
Fig.7 shows the percolation probability versus the intensity
of ﬁrewalls for rr = 2 m and λr = 0.8 device/m2. Recall that
the critical density, λc
f appears at the point where percolation
probability drops to 0 for the ﬁrst time. The ﬁgure shows a
phase transition in the percolation probability, which veriﬁes
Theorem 1. The ﬁgure also highlights the positive impact
of ﬁrewall communication/detection range rf . Increasing rf
reduces the critical intensity that is required to safeguard the
IoT/CPS network from malware epidemics.

Fig. 8 plots the critical intensity of ﬁrewalls λc

f (obtained
via simulations) versus the intensity of IoT/CPS devices. The
ﬁgure also depicts the upper-bounds in Theorem 2 for different
values of λc(1). The ﬁgure clearly shows the three regions
of operation for the IoT/CPS network. The ﬁrst region is
characterized by small values of λr such that the network
lacks long range multi-hop wireless connectivity, and hence, is
physically immune to malware epidemics. The second region
is when the intensity of IoT/CPS is sufﬁciently high for global
network connectivity while the intensity of ﬁrewalls is not
sufﬁcient (i.e., λf < λc
f ), and hence, the network is at risk of
malware epidemics. The last region is where sufﬁciently dense
spatial ﬁrewalls are deployed (i.e., λf ≥ λc
f ), and hence, the
network is safeguarded from malware epidemics.

Fig. 8 also shows that as the intensity of IoT/CPS devices
increase, denser ﬁrewalls deployment is required to prohibit

Fig. 6: Worst case scenario for existence of inﬁnite path.

following corollary.

Corollary 1. For a given λf , rf , and λr, a safeguarded wide
range connectivity for the IoT/CPS network can be ensured if
the D2D range satisﬁes the following condition

(cid:115)

(cid:115)

≤ rr ≤

4r2

f −

λc(1)
λr

λc(1)
λf

.

(18)

Proof: The corollary can be directly proved from Theorem

2 and IoT/CPS connectivity condition in (3).

The conditions in (18) ensures that the D2D communication
range is sufﬁcient for legitimate information dissemination
within G = {Φ, E} but not for a malware epidemic outbreak
on I(Ξ, E). Hence, Theorem 2 and Corollary 1 allow alterna-
tive techniques for safeguarding IoT/CPS networks, namely,
through the ﬁrewalls intensity λf , the ﬁrewalls communica-
tion/detection range rf , or the IoT/CPS D2D range rr. Note
that the ranges rf and rr can be controlled through the transmit
powers and receivers sensitivities.

The results in Theorem 2 and Corollary 1 safeguard the
IoT/CPS networks from malware epidemics. However, The-
orem 2 and Corollary 1 do not give insights about
the
percentages of susceptible and secured IoT devices. Hence,
an alternative design objective is to ensure that a required
percentage, denoted as δsec, of the devices are secured as
shown in the following corollary

Corollary 2. The percentage of IoT/CPS devices that are
protected from malware inﬁltration/infection is given by

δsec = 1 − exp(−πλf r2

f ).

(19)

Proof: By deﬁnition, a device is protected from malware
infection if it falls within the secured zones of ﬁrewalls. Hence,
the corollary can be directly proved from void probability of
the PPP.

Combining the results of Theorem 2 and Corollary 2, it can
be shown that using the critical intensity of ﬁrewalls in (15)
corresponds to securing the following critical percentage of
IoT/CPS devices







πλc(1)
(cid:16) rr
rf

(cid:17)2

δc
sec = 1 − exp

−

.

(20)


Owing to the fact that rf ≥ rr and using λc(1) ≈ 1.44, it
can be shown that δc
sec is a decreasing function in rf which

4 −



𝑟𝑓𝑟𝑟ε2𝑟𝑜𝑊12

Fig. 7: Phase transition.

malware epidemics. However, the required intensity for ﬁre-
walls saturates at the upper-bound indicated in Theorem 2,
which validates our analysis. That is, the ﬁgure conﬁrms that
there exists a ﬁnite intensity of ﬁrewalls λf that safeguards the
IoT/CPS network from malware epidemics regardless of the
intensity of IoT/CPS devices. It is worth noting that the upper-
bound in (15) depends on the approximate value of λc(1).
Hence, the ﬁgure also shows (15) when using the upper-bound
on λc(1) provided in Remark 1, which provides a safety mar-
gin against malware epidemics. Note that operating with such
safety margin increases the critical percentage of protected
devices from the range shown in (21) to 0.92 ≤ δc
sec ≤ 0.97
depending on the relative value of rf compared to rr.

Fig. 9 shows the percentage of susceptible devices, i.e.,
(1 − δsec), for different values of λf and rf /rr. On the
same ﬁgure, we also highlight the critical percentage 1 − δc
sec,
i.e., the complement of (20), which shows the percentage of
susceptible devices when operating at the critical intensity λc
f
derived in Theorem 2. First, the ﬁgure illustrates the range
of δc
sec presented in (21) and shows the fast convergence
of δc
sec to the upper limit 0.78. The ﬁgure also depicts the
high impact of rf on the network design and performance.
For instance, at λf = 0.1 device/m2 increasing rf to twice
rr leads to more than 10-fold decrease in the percentage of
susceptible devices. Furthermore, doubling rf also leads to
around 4 times reduction in the critical intensity of ﬁrewalls
required to safeguard the IoT/CPS devices. The ﬁgure also
shows the costs, in terms of λf and rf , that are required to
protect more devices beyond the required critical percentage
δc
sec.

VII. SUMMARY AND CONCLUSIONS
The Internet-of-things (IoT) is intrinsically vulnerable to
large-scale malware attacks, where malware inﬁltrated to one
device represents an infection threat to a large population
of devices. To safeguard the IoT from malware epidemics,
spatial ﬁrewalls are randomly deployed in the network to
detect and thwart emerging malware infections. Each ﬁrewall
imposes a secured zone, determined by its wireless con-
nectivity, that protects its proximate devices form malware

cf
λ

0.3

0.2

0.1

0

λc
f obtained via simulations
Theorem 2 for λc(1) ← 1.44
Theorem 2 for λc(1) ← 3.37

Safegaurded via spatial ﬁrewalls
(λf > λc
f)

s
c
i
m
e
d
i
p
e

e
r
a
w
l
a
m
o
t

e
n
u
m
m

I

At risk of malware epidemics

(λf < λc
f)

0 0.5 1 1.5 2 2.5 3 3.5 4 4.5 5 5.5 6 6.5 7
λr

Fig. 8: The critical intensity of ﬁrewalls vs the intensity of
IoT/CPS devices.

Fig. 9: Percentage of susceptible devices vs different values
of λf (using λc(1) ≈ 1.44).

infection. Mapping the network to a random geometric graph
and using tools from percolation theory, we develop a novel
mathematical framework to assess and design spatial ﬁrewalls.
In particular, we deﬁne the infection susceptible graph (ISG)
to assess the risk of a malware outbreak (i.e., epidemic).
We prove that the connectivity of the ISG exhibits a phase
transition, where there exists a critical intensity of ﬁrewalls
that prohibit the formation of a giant-connected component
within the ISG. From the security perspective, the absence of a
giant-connected component within the ISG eliminates the risk
of long-range propagation of malware infection, and hence,
safeguards the IoT from malware epidemics.

To this end, we present ﬂexible design paradigm for the
ﬁrewalls to safeguard the IoT. For instance, we ﬁnd tight

00.020.040.060.080.1f00.20.40.60.81Percolation ProbabilityIncreasing rf/rr=[1  1.5 2]00.050.10.150.2f10-810-610-410-21001-sec0.20.250.3Decreasing rf/rr: [2.5 2 1.5 1](fc;1-secc)upper-bound for the critical intensity of spatial ﬁrewalls re-
quired to safeguard the IoT from malware epidemics. We
also characterize the relative communications ranges of the
ﬁrewalls and the IoT devices that allow secure global net-
work connectivity. In addition, we specify the percentage of
secured devices that corresponds to the critical intensity of
spatial ﬁrewalls. The results show that the required density
of spatial ﬁrewalls signiﬁcantly decreases as we increase the
relative communication range of the spatial ﬁrewalls when
compared to the IoT devices. It is also shown that securing
67% to 78% of the IoT devices via ﬁrewalls is sufﬁcient to
safeguard the IoT network from malware epidemics, where the
required percentage of secured IoT devices decreases as the
communication range of the spatial ﬁrewalls increases.

A. Maximum number of dependent edges

APPENDIX

let {en}8

This appendix illustrates how to ﬁnd general expression
for the maximum number of edges N that are dependent of
some arbitrary edge e. We assume that all edges in the lattice
have dependency region A(·) of general size a × b squares.
According to the deﬁnition of dependency region, any two
edges ei, ej are considered independent iff (A(ei) ∩ A(ej)) =
∅. Therefore,
n=1 be the 8 closest edges which
dependency regions {A(ei)}8
i=1 do not overlap with A(e).
Next, we should construct maximal rectangle around e such
that created region A0(e) does not include {ei}8
i=1. Hence, we
can be sure that A0(e) covers maximal number of edges that
are dependent of e. For illustrative purposes, a toy example of
edge dependency problem is given in Fig. 10. By construction,
the size of A0(e) is (2a − 2) × (2b − 1). Hence, the number
of edges in A0(e) is
N = (2a − 1)(2b − 1) + (2a − 2)2b = 8ab − 2a − 6b + 1. (22)
For the scenario in Proposition 2, the dimensions of A(e) are

a = 2(cid:100)

(cid:101) + 2

and b = 2(cid:100)

(cid:101) + 1.

Substituting these values in (22) leads to the ﬁnal result of N .

REFERENCES

[1] A. Al-Fuqaha, M. Guizani, M. Mohammadi, M. Aledhari, and
M. Ayyash, “Internet of Things: A survey on enabling technologies,
protocols, and applications,” IEEE Communications Surveys Tutorials,
vol. 17, no. 4, pp. 2347–2376, Fourthquarter 2015.

[2] A. Hoglund, X. Lin, O. Liberg, A. Behravan, E. A. Yavuz, M. Van Der
Zee, Y. Sui, T. Tirronen, A. Ratilainen, and D. Eriksson, “Overview of
3GPP release 14 enhanced NB-IoT,” IEEE Network, vol. 31, no. 6, pp.
16–22, 2017.

[3] A. Humayed, J. Lin, F. Li, and B. Luo, “Cyber-physical systems security-
a survey,” IEEE Internet of Things Journal, vol. 4, no. 6, pp. 1802–1831,
2017.

[4] K. S. Ali, H. ElSawy, M. Haenggi, and M. Alouini, “The effect of spatial
interference correlation and jamming on secrecy in cellular networks,”
IEEE Wireless Communications Letters, vol. 6, no. 4, pp. 530–533, 2017.
[5] M. A. Kishk and H. S. Dhillon, “Stochastic geometry-based comparison
of secrecy enhancement techniques in D2D networks,” IEEE Wireless
Communications Letters, vol. 6, no. 3, pp. 394–397, 2017.

[6] F. Jameel, S. Wyne, G. Kaddoum, and T. Q. Duong, “A comprehensive
survey on cooperative relaying and jamming strategies for physical layer
security,” IEEE Communications Surveys Tutorials, vol. 21, no. 3, pp.
2734–2771, 2019.

√

5rf
rr

√

5rf
rr

13

Fig. 10: Example of edge dependency region A(e): a = 4 and
b = 3.

[7] M. A. Kishk and H. S. Dhillon, “Coexistence of RF-powered IoT and a
primary wireless network with secrecy guard zones,” IEEE Transactions
on Wireless Communications, vol. 17, no. 3, pp. 1460–1473, 2018.
[8] I. Agadakos, et al., “Jumping the air gap: Modeling cyber-physical attack
paths in the Internet-of-things,” in Proceedings of the 2017 Workshop on
Cyber-Physical Systems Security and Privacy. ACM, 2017, pp. 37–48.
[9] Y. Hayel and Q. Zhu, “Epidemic protection over heterogeneous networks
using evolutionary Poisson games,” IEEE Transactions on Information
Forensics and Security, vol. 12, no. 8, pp. 1786–1800, 2017.

[10] M. J. Farooq and Q. Zhu, “Modeling, analysis, and mitigation of
dynamic botnet formation in wireless IoT networks,” IEEE Transactions
on Information Forensics and Security, vol. 14, no. 9, pp. 2412–2426,
2019.

[11] X. Liu, M. Zhao, S. Li, F. Zhang, and W. Trappe, “A security framework
for the Internet of things in the future Internet architecture,” Future
Internet, vol. 9, no. 3, p. 27, 2017.

[12] M. Nekovee, “Worm epidemics in wireless ad hoc networks,” New

Journal of Physics, vol. 9, no. 6, p. 189, 2007.

[13] J. Kleinberg, “Computing: The wireless epidemic,” Nature, vol. 449, no.

7160, p. 287, 2007.

[14] M. Nekovee, “Modeling the spread of worm epidemics in vehicular ad
hoc networks,” in 2006 IEEE 63rd Vehicular Technology Conference,
vol. 2, May 2006, pp. 841–845.

[15] Y. Zou, J. Zhu, X. Wang, and L. Hanzo, “A survey on wireless security:
Technical challenges, recent advances, and future trends,” Proceedings
of the IEEE, vol. 104, no. 9, pp. 1727–1765, 2016.

[16] M. Hasan and S. Mohan, “Protecting actuators in safety-critical IoT
systems from control spooﬁng attacks,” in Proceedings of
the 2nd
International ACM Workshop on Security and Privacy for the Internet-
of-Things, 2019, pp. 8–14.

[17] H. Darabian, A. Dehghantanha, S. Hashemi, S. Homayoun, and K.-
K. R. Choo, “An opcode-based technique for polymorphic internet of
things malware detection,” Concurrency and Computation: Practice and
Experience, vol. 32, no. 6, p. e5173, 2020.

[18] H.-T. Nguyen, Q.-D. Ngo, D.-H. Nguyen, and V.-H. Le, “PSI-rooted
subgraph: A novel feature for IoT botnet detection using classiﬁer
algorithms,” ICT Express, 2020.

[19] F. Abdi, C. Chen, M. Hasan, S. Liu, S. Mohan, and M. Caccamo,
“Preserving physical safety under cyber attacks,” IEEE Internet of
Things Journal, vol. 6, no. 4, pp. 6285–6300, 2019.

[20] N. Asokan and et al., “SEDA: Scalable embedded device attestation,”
in Proceedings of the 22nd ACM SIGSAC Conference on Computer and
Communications Security, 2015, pp. 964–975.

[21] W. Yan, A. Fu, Y. Mu, X. Zhe, S. Yu, and B. Kuang, “EAPA: Efﬁcient
attestation resilient to physical attacks for IoT devices,” in Proceedings
of the 2nd International ACM Workshop on Security and Privacy for the
Internet-of-Things, 2019, pp. 2–7.

[22] H. ElSawy, M. A. Kishk, and M.-S. Alouini, “Spatial ﬁrewalls: Quar-

𝑒𝑒5𝑒1𝑒2𝑒3𝑒7𝑒8𝑒4𝑒6𝐴0(𝑒)𝐴(𝑒1)𝐴(𝑒2)𝐴(𝑒3)𝐴(𝑒4)𝐴(𝑒)𝐴(𝑒5)𝐴(𝑒6)𝐴(𝑒7)𝐴(𝑒8)[46] Z. Kong and E. M. Yeh, “Characterization of the critical density for
percolation in random geometric graphs,” in 2007 IEEE International
Symposium on Information Theory, June 2007, pp. 151–155.

[47] B. Bollobas and O. Riordan, Percolation. Cambridge University Press,

2006.

[48] G.Grimmett, Percolation. Springer-Verlag, 1980.
[49] M. Haenggi, Stochastic Geometry for Wireless Networks. Cambridge

University Press, 2012.

14

antining malware epidemics in large scale massive wireless networks,”
IEEE Communications Magazine, to appear.

[23] L. Liu, X. Zhang, and H. Ma, “Optimal density estimation for exposure-
path prevention in wireless sensor networks using percolation theory,”
in 2012 Proceedings IEEE INFOCOM, March 2012, pp. 2601–2605.

[24] J. Wang and X. Zhang, “3D percolation theory-based exposure-path pre-
vention for optimal power-coverage tradeoff in clustered wireless camera
sensor networks,” in 2014 IEEE Global Communications Conference,
Dec 2014, pp. 305–310.

[25] Y. Katada, “Connectivity of swarm robot networks for communication
range and the number of robots based on percolation theory,” in 2014
IEEE/SICE International Symposium on System Integration, Dec 2014,
pp. 93–98.

[26] N. Anjum, H. Wang, and H. Fang, “Percolation analysis of large-scale
wireless balloon networks,” Digital Communications and Networks,
vol. 5, 03 2018.

[27] M. N. Anjum, H. Wang, and H. Fang, “Coverage analysis of random
UAV networks using percolation theory,” in 2020 International Confer-
ence on Computing, Networking and Communications (ICNC), 2020,
pp. 667–673.

[28] W.Ren, Q.Zhao, and A.Swami, “Connectivity of heterogeneous wireless
networks,” IEEE Transactions on Information Theory, vol. 56, pp. 4315–
4332, 2011.

[29] M. Yemini, A. Somekh-Baruch, R. Cohen, and A. Leshem, “The
simultaneous connectivity of cognitive networks,” IEEE Transactions
on Information Theory, vol. 65, no. 11, pp. 6911–6930, 2019.

[30] O. Dousse, F. Baccelli, and P. Thiran, “Impact of interferences on con-
nectivity in ad hoc networks,” IEEE/ACM Transactions on Networking,
vol. 13, no. 2, pp. 425–436, April 2005.

[31] O. Dousse, M. Franceschetti, N. Macris, R. Meester, and P.Thiran,
“Percolation in the signal to interference ratio graph,” Journal of Applied
Probability, vol. 43, no. 2, pp. 552–562, 2006.

[32] P. C. Pinto and M. Z. Win, “Percolation and connectivity in the intrinsi-
cally secure communications graph,” IEEE Transactions on Information
Theory, vol. 58, no. 3, pp. 1716 – 1730, 2012.

[33] R. Vaze and S. Iyer, “Percolation on the information theoretic secure
SINR graph: Upper and lower bounds,” in 10th International Workshop
on Spatial Stochastic Models for Wireless Networks 2014, Hammamet,
Tunisia, 2014.

[34] A. Guo and M. Haenggi, “Spatial stochastic models and metrics for the
structure of base stations in cellular networks,” IEEE Transactions on
Wireless Communications, vol. 12, no. 11, pp. 5800–5812, 2013.
[35] J. G. Andrews, F. Baccelli, and R. K. Ganti, “A tractable approach
to coverage and rate in cellular networks,” IEEE Transactions on
Communications, vol. 59, no. 11, pp. 3122–3134, 2011.

[36] W. Bao and B. Liang, “Stochastic geometric analysis of user mobility
in heterogeneous wireless networks,” IEEE Journal on Selected Areas
in Communications, vol. 33, no. 10, pp. 2212–2225, 2015.

[37] W. Lu and M. Di Renzo, “Stochastic geometry modeling of mmwave
cellular networks: Analysis and experimental validation,” in 2015 IEEE
International Workshop on Measurements Networking (M N), 2015, pp.
1–4.

[38] W. Lu and M. Di Renzo, “Stochastic geometry modeling of cellular
networks: Analysis, simulation and experimental validation,” in Proceed-
ings of the 18th ACM International Conference on Modeling, Analysis
and Simulation of Wireless and Mobile Systems, ser. MSWiM ’15. New
York, NY, USA: Association for Computing Machinery, 2015.

[39] H. El Merabet and A. Hajraoui, “A survey of malware detection tech-
niques based on machine learning,” International Journal of Advanced
Computer Science and Applications, vol. 10, 01 2019.

[40] N. C. Idika and A. P. Mathur, “A survey of malware detection tech-

niques,” 2007.

[41] A. Souri and R. Hosseini, “A state-of-the-art survey of malware detection

approaches using data mining techniques,” vol. 8, pp. 1–22, 12 2018.

[42] M. Haenggi, Stochastic Geometry for Wireless Networks. Cam-bridge

Univ. Press, 2012.

[43] M. Haenggi,

and
J. G. Andrews, F. Baccelli, O. Dousse,
M. Franceschetti, “Stochastic geometry and random graphs
for
the analysis and design of wireless networks,” IEEE Journal on
Selected Areas in Communications, vol. 27, no. 7, pp. 1029–1046,
2009.

[44] R. Meester and R. Roy, Continuum Percolation. New York: Cambridge

Univ. Press, 1996.

[45] J. Quintanilla, S. Torquato, and R. M. Ziff, “Efﬁcient measurement of
the percolation threshold for fully penetrable discs,” Journal of Physics
A: Mathematical and General, vol. 33, no. 42, pp. L399–L407, oct 2000.

