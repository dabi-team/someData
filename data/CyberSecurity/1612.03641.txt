6
1
0
2

c
e
D
2
1

]

R
C
.
s
c
[

1
v
1
4
6
3
0
.
2
1
6
1
:
v
i
X
r
a

Developing Security Reputation Metrics for Hosting Providers
(Step Right Up! Metrics Galore! )

A. Noroozian

M. Korczy´nski

S. TajalizadehKhoob

M. van Eeten

Delft University of Technology

Abstract

Research into cybercrime often points to concentrations
of abuse at certain hosting providers. The implication is
that these providers are worse in terms of security; some
are considered ‘bad’ or even ‘bullet proof’.

Remarkably little work exists on systematically com-
paring the security performance of providers. Existing
metrics typically count instances of abuse and sometimes
normalize these counts by taking into account the adver-
tised address space of the provider. None of these at-
tempts have worked through the serious methodological
challenges that plague metric design.

In this paper we present a systematic approach for
metrics development and identify the main challenges:
(i) identiﬁcation of providers, (ii) abuse data coverage
and quality, (iii) normalization, (iv) aggregation and
(v) metric interpretation. We describe a pragmatic ap-
proach to deal with these challenges.
In the process,
we answer an urgent question posed to us by the Dutch
police: ‘which are the worst providers in our jurisdic-
tion?’. Notwithstanding their limitations, there is a clear
need for security metrics for hosting providers in the ﬁght
against cybercrime.

Introduction

1
Hosting providers are companies that provide servers via
which customers can make content or services available
on the Internet e.g. websites, email or support for multi-
player gaming. As with virtually all services on the In-
ternet, they are abused for criminal purposes as well. A
wealth of research has identiﬁed how hosting infrastruc-
ture shows up in various criminal business models. Think
of phishing sites, command-and-control servers for bot-
nets, child pornography, malware distribution, and spam
servers [1].

Nobody contests that hosting providers play a key
role in ﬁghting cybercrime. Much of the criminal ac-
tivity runs on compromised servers of legitimate cus-
tomers, some on servers rented by the criminals them-
selves. In either case, the hosting providers typically be-
comes aware of the problem only after being notiﬁed of
the abuse. Their response to abuse reports varies widely,

ranging from vigilant to slow to negligent or even bullet-
proof [1, 2]. To empirically measure which of these re-
sponses is actually occurring has proven to be very chal-
lenging. Existing metrics of hosting provider security
typically count instances of abuse within an Autonomous
System, sometimes normalized by the size of the ad-
vertised address space [1, 3, 4]. None of these attempts
adequately account for the serious methodological chal-
lenges plaguing such metrics.

In this paper, we present a systematic approach for
developing metrics for hosting providers. It enables us
to identify and discuss the main challenges: (i) identi-
ﬁcation of providers, (ii) abuse data coverage and qual-
ity, (iii) normalization, (iv) aggregation and (v) metric
interpretation in light of the heterogeneity of hosting
providers. Additionally we present a pragmatic approach
to deal with these issues.

This study is part of an ongoing collaboration with the
Dutch National High Tech Crime Police, the Authority
for Consumers and Markets, the Public Prosecutor and
the Dutch Hosting Provider Association. The objective is
to answer an urgent question posed by the police: which
are the worst providers in our jurisdiction?

The question illustrates there is a clear need for secu-
rity metrics for hosting providers, notwithstanding their
limitations. Reducing cybercrime is as much a problem
of incentives as it is a technical issue [5]. Without re-
liable signals we cannot tell which provider is vigilant,
lax, negligent or outright criminal and it will be very
difﬁcult to move the sector towards more secure prac-
Information asymmetry erodes the incentives of
tices.
providers to invest in security. Reliable metrics can (i)
signal security performance to customers, upstream and
downstream providers, law enforcement and other stake-
holders (ii) enable benchmarking of providers, and (iii)
help identify the effectiveness of security practices and
policies.

The main contributions of this paper are as follows: (i)
we systematically outline the process to develop security
reputation metrics for hosting providers, as well as the
methodological challenges encountered along the way,
(ii) we improve existing techniques for mapping abuse
to hosting providers and for taking into account the size

1

 
 
 
 
 
 
of hosting providers in computing reputation scores, (iii)
we present a pragmatic approach to produce metrics for
the Dutch market, developed in collaboration with key
stakeholders.

2 Background
Hosting providers come in many shapes and sizes and of-
fer portfolios of services: from relatively expensive ded-
icated physical machines to virtual private servers (VPS)
to the cheaper options of shared hosting or even so-called
free hosting. In each service, the role of the provider vis
a vis the customer is different. On a dedicated machine,
and to a lesser extent on a VPS, the customer controls the
entire software stack, whereas on shared hosting, many
customers operate under restricted privileges on a ma-
chine they share with many other users. Free hosting
services limit user control to the extreme.

Depending on the type of customer, hosting providers
play a different role in protecting their customers against
compromise by patching servers, cleaning and monitor-
ing for abuse. Similarly, providers need to protect the rest
of the Internet against potentially malicious customers by
putting in place different checks and restrictions which
depends on the service contract with that customer.

Next to the occurrence rate of abuse, the uptime of
abuse also reﬂects hosting provider security practices.
On one end of the spectrum, vigilant hosting providers
remove malicious content often within hours of its dis-
covery, in the middle there are some providers that re-
spond more slowly and more selectively and on the other
extreme are the so called ‘bulletproof’ hosting providers
that seem to ignore all abuse notiﬁcations.

There has been a lot of speculation over the incentives
of providers. A shared hosting provider, for example,
could act against abuse more directly because its cus-
tomers have only limited control over the machines that
they use. On the other hand, shared hosting is a highly
competitive market with low margins, so investing in se-
curity is not likely to be a high priority. The only way
forward is to replace speculation with reliable empirical
evidence of abuse rates across providers.

3 Overview of Approach
Our approach for calculating reputation metrics is partly
guided by the goal to allow our collaborators to engage in
meaningful discussions based on reliable empirical tech-
niques. To this end, we produce two types of security in-
dicators for hosting providers based on data available in
public and private abuse feeds: (i) Occurrence of abuse:
an indicator based on counting occurrence of abuse, and
(ii) Persistence of abuse: an indicator based on how long
the abuse was present. Distinguishing between occur-
rence of abuse and the response of a hosting provider to

abuse as independent measures of performance is impor-
tant. While the occurrence of abuse is to some extent
inevitable due to technical vulnerabilities and related to
organization size and attacker characteristics, persistence
of abuse indicates attitude towards dealing with abuse
and mainly relates to defender characteristics.
In con-
junction, these independent indicators provide a better
understanding of the overall security performance of a
hosting provider.

Figure 1 illustrates a high level overview of the com-
plete procedure to produce these indicators. Here, boxes
represent inputs/outputs to each step while arrows trans-
formation steps on data required for each step. The pro-
cess is quite generic and outlines the steps that any repu-
tation metric requires to arrive at ﬁnal scores. In execut-
ing these steps there are challenges that need to be over-
come and choices that have to be made that will undoubt-
edly effect the reliability and interpretation of the repu-
tation metric.
In what follows we systematically walk
the reader through the steps of the process meanwhile
highlighting challenges related to each step and the pos-
sible effects on the overall metric and its interpretation.
A more detailed analysis of some choices and their effect
are presented later in Section 10.

4 Step 1 - Abuse Mapping
Identifying hosting providers is not straight forward
since they do not directly map onto entities with which
underlying Internet protocols work or what abuse data
capture. The ﬁrst decision that needs to be made is to
identify what a hosting provider is.
4.1
for Dutch hosting
To produce reputation metrics
providers, we made the (common [1, 3, 6, 7]) assump-
tion that hosting providers will have an associated Au-
tonomous System Number (ASN). Consequently, we
considered any AS which routed IP addresses that geo-
located to the Netherlands as a Dutch hosting provider.

Identifying Hosting Providers

While the assumption may hold in general, ASes could
refer to Internet Service Providers (ISP), Internet ex-
change points, banks, governmental institutions, univer-
sities and in general non-hosting entities. Without a
deeper analysis of the ASes, such an assumption may
lead to considerable error in mapping abuse onto hosting.
Even when an AS does refer to a hosting provider, com-
plexity still exists. Providers may have multiple ASNs or
there might be multiple organizations which own a part
of the IP space in an AS or resellers who lease infrastruc-
ture from the AS. Some ASes also route trafﬁc destined
for IPs owned by peers. Certain legitimate services (e.g.
CloudFlare) may act as proxies and hide providers. As
a result abuse associated with small organizations with
registered IPs in ASes may end up attributed to the AS

2

Figure 1: Reputation metric development process

from which the infrastructure is leased. We have opted to
analyze abuse for organizations with registered IPs inside
ASes in future work.

One method to better identify hosting providers and
identifying organizations under each AS, is to analyze
IP ‘ownership’ using Maxmind’s GeoIP ISP Database.
Utilizing such information results in a more ﬁne grained
mapping which mitigates the mapping problems dis-
cussed above. Nevertheless, this approach has com-
plications of its own such as non-standardized WHOIS
data formats where the same organization might ap-
pear with multiple names that are non-trivial to re-
late to each other. For example, the Dutch provider
Leaseweb might appear under any of the following
Leaseweb Asia Pacific. ltd.,
additional names:
leaseweb1.iomadserve.com.

4.2 Unit of Abuse
The second key decision is about the unit of abuse or how
to count the abuse data. Unlike other hosting metrics
which typically count distinct IP addresses as the unit for
abuse [1, 3, 7], our approach considers unique 2nd-level
domain-IP pairs - (cid:104)2LD, IP(cid:105) - as the unit of abuse. From
this point on, we use the terms ‘2LD’ and ‘domain’ inter-
changeably, unless the context requires otherwise. Sim-
ply counting the number of abusive IP addresses largely
underestimates abuse from shared hosting services since
criminals may use the same IPs for various purposes. For
example a compromised server may host a phishing web-
site and also be used for spreading malware. Further-
more, the number of domains is a better proxy for the
number of customers of the provider, which is valuable
to include in approximating its size. Last, this deﬁnition
also maximizes the value of our feeds as measured by
their differential contribution [8].

Counting pairs of (cid:104)2LD, IP(cid:105) mitigates the problem but
is not perfect. In some cases it is appropriate to count
(cid:104)FQDN, IP(cid:105) pairs (e.g. malicious domain generation al-
gorithms), or even (cid:104)URL, IP(cid:105) pairs (e.g. child abuse con-
tent concentrated under the same domain with varying
paths in the URL).

4.3 Data feeds

A separate decision in mapping abuse is what data feeds
to use. A wide range of abuse on the Internet is as-
sociated with hosting. Hosts are used as malware drop
zones and to host phishing pages designed to steal sen-
sitive information. Botnet command and control (C&C)
servers are also hosted [7]. Other types of hosting related
abuse includes child pornography, SEO schemes, spam
and counterfeit goods stores. Not all criminal activity can
be observed in a way that can be attributed to the infras-
tructure of a speciﬁc hosting provider. Think of hidden
services on TOR. Even if it can be observed, the crim-
inal activity might not be captured in abuse data feeds,
which are often produced by automated means. This im-
plies that abuse feeds are always partial and of varying
quality. This is a well known fact [8, 9]. Needless to say,
criminal activity that is not captured in the abuse data in-
cluded in a metric, forms a blind spot of that metric. This
suggests to include as broad a spectrum of abuse feeds as
possible.

We collect a range of feeds and blacklists from private,
public, commercial, and governmental sources. Table 1
gives and overview of these data feeds. The data spans
over the entire duration of 2014 (with the exception of
the SHC and SHS which span over the 2nd half of 2014).
The majority of our feeds, do not share much information
on the exact collection methodology. We did not include
some of the available spam feeds because our analysis of
the data revealed these to be mostly related to compro-
mised end users of ISPs rather than hosting companies.

Table 1: Data Feeds and Statistics

Abuse Type

Feed

Organization

Samples

(cid:104)Domain, IP(cid:105)

IPs

Total

Excl.

Total

Excl.

Malicious Hosts
Malicious Hosts
Malware
Botnet C&Cs
Phishing
Phishing
Take Down Request
Child Pornography

SHC
SHS
SBW
ZEUS
PHISH
APWG
MLAT
MELD

Shadowserver
Shadowserver
StopBadware
Abuse.ch
Phishtank
APWG
Dutch Police
Meldpunt

3957
7632
15204
50
2278
3060
1347
725

3615
7489
14757
27
1780
2430
1202
584

2260
1100
7702
72
1377
1886
1433
417

1321
816
6170
35

1101
1202
242

Total

3

34253

31884

16247

11491

In general, data quality relates mainly (but not only)
to: (i) coverage (What is the overlap between the dif-
ferent feeds?), (ii) purity (How much of the blacklisted
domains truly host malicious content? However, it is not
always possible to assess the coverage or purity of a feed
since mainly of its details are not well documented [8].

Coverage. Previous overlap analysis of blacklists that
cover different types of abuse concludes that - although
existent - there is little overlap in terms of the abuse as-
sociated with each ASN [9]. We reach similar results es-
pecially when (cid:104)2LD, IP(cid:105) pairs are the unit of abuse.

Clearly the feeds differ substantially in terms of the
volume of reported abuse samples. For example, the pro-
fessionally oriented SBW feed contributed over 15,000
samples, while the non-proﬁt ZEUS feed three orders of
magnitude less domain-IP pairs.
In terms of the total
number of IPs, SBW reports almost two times less unique
IPs than distinct (cid:104)2LD, IP(cid:105) pairs whereas the ZEUS feed
reports more IPs because some Zeus conﬁg, binary, and
drop zones are hosted solely on IP addresses. Moreover,
the differences between (cid:104)2LD, IP(cid:105) pairs and IPs indicate
that many domains used for criminal activity are mapped
to a smaller number of IP addresses which could be the
result of shared hosting services. Across our feeds, 93%
of all (cid:104)2LD, IP(cid:105) pairs and 71% of all IPs for all domains
were exclusive to a single feed (cf. Excl. column in Ta-
ble 1). We refer to samples as exclusive when they appear
only in one feed.

Figure

2 illustrates pairwise feed intersections as
a matrix, with unique (cid:104)2LD, IP(cid:105) (left) and unique IPs
(right) as the unit for abuse respectively. Here darker
shades of grey represent higher overlaps. For instance,
in Figure 2 (left), the overlap between MLAT and MELD
indicates 124 (cid:104)2LD, IP(cid:105) pairs in common. This overlap
constitutes 9% of the MLAT feed. In comparison, 124
(cid:104)2LD, IP(cid:105) pairs represents 17% of the MELD feed. The
rightmost column indicates the absolute number and the
percentage of samples that the feed has in common with
all other feeds combined. The amount of overlap in the
rightmost columns conﬁrms the simultaneous use of IPs
for different malicious purposes. This also further sup-
ports our choice of abuse unit.

Finally, the relatively small overlap among our chosen
data feeds in terms of (cid:104)2LD, IP(cid:105) indicates the suitability
of these feeds, still, other feed characteristics need to be
analyzed to further establish suitability.

Purity. All abuse feeds contain false positives. The
main question is which samples should be considered
false positives and excluded and which should not? We
deﬁne false positives as websites maintained by legiti-
mate users that do not serve any malicious content and
are incorrectly blacklisted.

Some domains are legitimate but point to servers that
host malicious content. For example, we consider URL

shortening services such as goo.gl or bit.ly as false
positives. However, other legitimate websites such as
free web hosting providers (e.g. Hostinger), or cloud
storage services (e.g.
Imagezilla.net or Dropbox) are
misused by criminals and included in our analysis.

Moreover, a certain portion of abuse feeds include be-
nign domains. We analyze benign domains that appear
in the Alexa top 25 thousand domain list to evaluate
the prevalence of false positives. Although we do not
provide a real-time veriﬁcation of blacklisted Alexa do-
mains, we perform a posteriori analysis to further estab-
lish the suitability of our chosen abuse feeds.

Due to space limitation we only brieﬂy discuss the
analysis and do not include the details. Overall we ﬁnd a
low number of Alexa domains in the abuse feeds. Nev-
ertheless, there are major differences among the types
of Alexa domains per feed. For example, through man-
ual analysis of a random sample from the SHS feed we
found that approximately 30% of this feed’s Alexa do-
mains were ﬁle sharing services most probably used to
host malicious content and thus relevant to include. On
the other hand, we also ﬁnd some examples of popular
websites like msn.com, or microsoft.com that are pre-
sumably used by compromised machines to test network
connectivity. In the case of the PHISH feed we ﬁnd that
a signiﬁcant number of ranked domains that are either
false positives (e.g. banks and other legitimate services),
or are not appropriate for the type of analysis that we pro-
vide (e.g. URL shorteners). The majority of the ranked
domains for both MLAT and MELD represent ﬁle and
adult content sharing services. As systematic false posi-
tives, or unrelated web services in our feeds do not con-
stitute a large number we therefore have opted to include
such ranked domains in our analyses.

5 Step 2 - Size Mapping

Reliable reputation metrics need to account for a com-
monly observed trend that larger providers also experi-
ence a larger amount of abuse.

A common yardstick for measuring the ‘size’ of host-
ing providers is the number of IP addresses routed by
its corresponding AS in the BGP protocol [1, 3]. Never-
theless not all IPs routed by an AS are used for hosting
content nor are they directly in use by the AS. IPs may
be leased and used for other purposes. Inaccuracies in
size estimation may negatively impact the reliability of a
metric in that they can lead to misleading results. Nev-
ertheless, due to simplicity of calculating, advertised IP
space remains and attractive choice for size estimation.

We propose (and use) two additional size estimators:
(i) the number of hosted 2LD and (ii) the number of IP
addresses used to host content per hosting provider. To
calculate these estimators we use the historical passive
DNS (pDNS) data provided to us by Farsight Security.

4

Figure 2: Pairwise overlap of feeds with unique (cid:104)2LD, IP(cid:105) (left) and IPs (right) as unit of abuse

This data records domain name resolution queries col-
lected over the entire duration of 2014 which we use to
count the number of unique 2LDs and their matching
IP addresses. These counts are subsequently mapped to
ASes routing the IP addresses and used as an estimation
of the size of the provider. Here the quality of the result-
ing estimates is highly dependent on the coverage of the
pDNS data. As long as the pDNS data has a reasonable
coverage of all registered 2LDs, it can be used to pro-
duce reasonable size estimates. We have crosschecked
the number of unique 2LDs observed in the pDNS data
with the number of 2LDs of gTLDs and ccTLDs present
in zone ﬁles of new gTLDs that we obtained under agree-
ment from ICANN 1 in addition to ccTLD sizes reported
by APWG 2 at the end of 2014. Extrapolating from these
results we have concluded pDNS to be a reasonably reli-
able source to estimate hosting provider size.

There are potentially other conceivable estimators for
hosting provider size such as the number of customers.
Nevertheless, the scarcity of data to base such estimates
on is a largely limiting factor in this respect.

6 Step 3 - Normalization of Abuse

Given the output of abuse mapping and size mapping, the
next step in the metric production process is to normalize
abuse by a size estimate. This leads to S × N normalized
abuse mappings where S is the number of size maps pro-
duced earlier and N the total number of abuse maps cor-
responding to analyzed blacklists. A key question here
relates to interpretations that can already be made from
normalized abuse data.

All size estimates have their advantages and disadvan-
tages which have to be viewed as trade-offs. The most
commonly used size estimator - routed IPs - is the easi-
est to calculate, but it suffers from systematically favor-
ing large providers, since not all routed IPs are used for

1http://newgtlds.icann.org
2http://docs.apwg.org

hosting. Using the portion of the routed IP space that
is used for hosting as the size estimator mitigates the
problem, however, this is much more difﬁcult to calcu-
late. This estimate is also not free of systematic bias,
because it favors hosting providers that have a dispropor-
tionately large amount of shared hosting. We can use the
number of hosted 2LDs as the estimator, which would
treat shared hosting fairly but would still underestimate
the size of subdomain resellers and free-hosting services.
The trend here is clear; normalized abuse has its blind
spots, and needs to be taken into account especially for
interpreting results at this stage.

It is important to note that some size estimates are
more volatile than others due to the dynamic nature of
the underlying processes. For example, the number of
FQDNs hosted by a provider may change at a much
faster rate than the number of 2LDs if an estimator based
on FQDNs is used.

Normalized abuse, is already an indicator of secu-
rity performance by itself. Note however,
that nor-
malized abuse is abuse type speciﬁc. For example,
one can analyze normalized abuse based on the occur-
rence of malware on hosting providers and draw con-
clusions; however, this only provides a partial picture of
the performance of hosting providers. Some providers
might be much less strict about allowing malware spread
from their servers than for example the hosting of child
pornography [7]. In our case, we use all size estimators
outlined in the previous section without committing to a
speciﬁc one or considering one superior to others. The
expectation is that the combination of these can over-
come the deﬁciencies of each. This matter is further ex-
plored in Section 10.

Finally, note that when talking about metrics based on
the up-time of abuse, size corrections are not appropriate.
In such cases it is common to use mean or median up-
times instead of normalized abuse.

5

  17%, 1240%, 260%, 190%, 30%, 00%, 00%, 59%, 124  0%, 180%, 240%, 20%, 00%, 00%, 51%, 262%, 18  4%, 1415%, 1214%, 23%, 1201%, 951%, 193%, 240%, 141  15%, 3616%, 35%, 1980%, 310%, 30%, 20%, 12111%, 361  2%, 13%, 1260%, 70%, 00%, 00%, 20%, 30%, 1  0%, 00%, 200%, 00%, 00%, 1206%, 1985%, 1260%, 0  0%, 50%, 50%, 50%, 951%, 310%, 740%, 200%, 5  10%, 14519%, 1412%, 44720%, 63021%, 49846%, 238%, 3421%, 143MLATMELDSBWAPWGPHISHZEUSSHCSHSTOTMLATMELDSBWAPWGPHISHZEUSSHCSHS  29%, 1231%, 1243%, 592%, 364%, 31%, 371%, 148%, 123  0%, 681%, 370%, 90%, 00%, 71%, 129%, 12418%, 68  31%, 48151%, 51037%, 2047%, 76322%, 2184%, 599%, 376%, 481  29%, 39633%, 1912%, 2717%, 812%, 362%, 96%, 51021%, 396  35%, 1915%, 3234%, 510%, 30%, 00%, 201%, 191%, 19  0%, 122%, 242%, 371%, 710%, 76314%, 27127%, 32320%, 12  5%, 590%, 142%, 122%, 2184%, 813%, 5135%, 242%, 59  16%, 23141%, 17519%, 153241%, 78556%, 77351%, 3741%, 93925%, 284MLATMELDSBWAPWGPHISHZEUSSHCSHSTOTMLATMELDSBWAPWGPHISHZEUSSHCSHS7 Step 4 - Rating of Abuse

Given the normalized abuse maps, the next step in the
process, calculates rankings over all maps to produce
rankings. Rankings are one way of unifying the scales
on which normalized abuse is measured and allows
cross comparisons over categories of abuse. For exam-
ple, comparing the security performance of a hosting
provider in terms of how well it manages to mitigate mal-
ware with its performance in terms of how well it miti-
gates phishing is not meaningful when based on normal-
ized abuse. However, the comparison is meaningful over
rankings.

Given the normalized abuse maps, our method for
ranking hosting providers is as follows: We rank nor-
malized abuse from high to low. This results in 3 × N
rankings. The individual rankings may range between
zero and R, the total number hosting providers. The
worst rank, R, is assigned to the AS with the highest nor-
malized abuse, R − 1 to the second worst and so forth.
ASes with equal normalized abuse are assigned equal
ranks. If a normalized abuse map only contains data on
for example 20 providers the ranking will range between
[R − 20, R] with all providers for which no abuse was de-
tected receiving the low rank of R − 20.

An important consideration in producing rankings is
information loss. To illustrate this consider two hosting
providers HP1 and HP2 that have a normalized abuse of
0.1 and 0.3 and have been assigned the ranks of 10 (worst
performer) and 5 (5th worst) respectively. Our ranking is
not distance preserving since the difference between the
hosting provider ranks (10 − 5) does not entail the same
information as that of the normalized abuse (0.3 − 0.1
). That is, one unit of change in ranking could mean
any number of changes in the unit of normalized abuse.
As a result these distances cannot be interpreted in the
same way. In ranking hosting providers, some informa-
tion about the magnitude of the differences is unavoid-
ably lost.

8 Step 5 - Aggregation of Rates

We now aggregate our rankings into one overall ranking
that assigns scores in the range [0, 1], where score 1 in-
dicates the worst performer. The aggregation procedure
considers every ranking as a voting preference over R
candidates in an imaginary election. The election winner
is effectively decided using a Borda Count vote aggre-
gation method that basically counts how many times a
certain candidate appeared in the 1st place, 2nd place,
3rd place (and so forth) in every ranking and decides the
outcome based on all rankings.

An alternative approach could perform factor analy-
sis and take into account the most contributing feeds
when interpreting metric scores (cf. also Section 10).

We ﬁnd, however, voting systems to be a useful anal-
ogy when thinking about aggregation. A useful aggrega-
tion method must have certain desirable properties, such
as being intuitive. For example, if a particular hosting
provider is the worst ranked performer in all categories
of abuse, the reputation metric should reﬂect that by as-
signing the worst metric score to that provider and not to
others. Certain methods of aggregation will not guaran-
tee such properties and are therefore undesirable. We re-
fer the reader to literature on different voting aggregation
methods 3 for a better understanding of the properties of
such methods and their limitations.

9 Step 6 - Metric Interpretation

Reputation scores need to be interpreted to guide pol-
icy and reduce information asymmetry around the secu-
rity performance of hosting providers. However, cor-
rect interpretation of a metric without detailed knowl-
edge of the various blind spots and biases of the process
is difﬁcult. Additionally the heterogeneity in the hosting
provider landscape directly inﬂuences what conclusions
can be drawn from the scores.

To illustrate the challenges of interpretation we brieﬂy
present some of our results here. Figure 3 plots the rank-
ings of the 20 worst performers based on the occurrence
of abuse. The plot demonstrates a large variance between
the performance of providers that have comparable sizes.
The results clearly indicate signiﬁcant differences in how
hosting providers deal with abuse. Here, the safest com-
parisons are among providers that have the most simi-
lar properties. As an example consider the two hosting
providers colored in bright green, ﬁrst the provider with
the highest metric score and second the provider located
approximately at (x (cid:119) 104, y (cid:119) 0.85). These are very
similar in all aspects and therefore it can be safely con-
cluded that the provider with the lower score is perform-
ing signiﬁcantly better than the worst performer due to
its security policies and practices. To consider the worst
provider as negligent or criminally engaged simply be-
cause it has the worst score is however a wrong conclu-
sion to draw here.

Figure 4 compares the occurrence metric and the up-
time metric of hosting providers. A cautionary note here
is that our uptime metrics are based on only 2 data feeds
from which up-times could be calculated. The weak re-
lationship (Spearman’s ρ = 0.38, Pearson r = 0.36) be-
tween occurrence and up-time is expected as each cap-
tures a different aspect of hosting provider characteris-
tics that relate to abuse (see Section 3). Clearly some
providers experience large amounts of abuse while man-
aging to quickly block the abuse (upper left region of the
plot). Others, perform consistently bad in the sense that

3See e.g. http://lorrie.cranor.org/pubs/diss/node4.html

6

on alternate methodological options for each of these de-
cisions. We compare them to the ranking of the prag-
matic approach we presented (called as benchmark rank-
ing) by calculating the Pearson correlation coefﬁcient
among the top n = 100 worst performing Dutch hosting
providers.

Unit of abuse. We used unique (cid:104)2LD, IP(cid:105) pairs as the
unit of abuse. We calculated an alternate ranking based
on unique IP counts, the standard approach in the litera-
ture. The Pearson’s r among both rankings is 0, 952. Per-
haps more tangible: 16 ASes are in the top-20 of worst
performers of both rankings. In other words, the metric
is not very sensitive to either speciﬁcation.

Abuse normalization. We calculated three alter-
nate scores using the three size estimates for hosting
providers: (i) the advertised IP space (ii) the advertised
IP space that is used for hosting, and (iii) the number
hosted 2LDs. The benchmark ranking used all three of
them. The Pearson’s r for the alternative speciﬁcations
to the benchmark ranking are 0, 896, 0, 909, and 0, 6438,
respectively. The results reveal a strong correlation be-
tween the IP space-based size estimators and the bench-
mark ranking, and a less strong correlation with the esti-
mates based on 2LDs. Out of the top 20 worst performers
in the benchmark ranking, only 7 ASNs were present in
all alternate top 20 rankings. When comparing pairwise:
the reference ranking shares 13 ASNs in common with
those based on advertised IP addresses and hosted 2LDs,
and 15 ASNs with the ranking based on IP addresses
used for webhosting. In other words, using the number of
hosted domains vs. estimates based on IP address space
give signiﬁcantly different results. By including all three
size estimations, our metric speciﬁcation mitigates that
impact, while retaining the advantages of including do-
main name counts in abuse counting and size estimation.
Metric aggregation. We also compared our bench-
mark ranking with a ranking in which we assigned
weights to each data source according to their compre-
hensiveness, i.e., the relative volume of each feed in
terms of distinct number of exclusive (cid:104)2LD, IP(cid:105) pairs in
the dataset (cf. Table 1).
In summary, out of top 20
abused ASNs in the benchmark, 14 ASNs showed up in
the weighted rankings and the Pearson’s r of the bench-
mark ranking and weighted ranking is equal to 0, 791.

11 Related Work

Numerous studies have pointed to concentrations of
abuse in certain networks, typically in the context of a
speciﬁc criminal business model, e.g., spam [10], phish-
ing [11] or malware [12]. Effects and policy implications
of intervention at classes of intermediaries have also been
studied in [10, 13]. The quality of abuse data has also
been extensively covered [8, 9, 12]. [2] examines the role

Figure 3: The 20 worst Dutch providers for abuse rate.

Figure 4: Comparison of occurrence and uptime metric.

they experience large abuse occurrence and are also slow
to block it (upper right region of the plot). Neverthe-
less, we believe that the amount of occurring abuse and
the response of a hosting provider to abuse are important
aspects that need to be both measured separately to pro-
vide a thorough picture of security performance. Only
now can we draw the conclusion that the worst perform-
ing hosting provider in terms of occurrence is probably
negligent because it is also among the worst performers
in terms of uptimes (see point with (x (cid:119) 0.8, y = 1) coor-
dinates)

Finally when interpreting the results, one should also
take the hosting provider business model into account.
Hosting providers with a large portion of shared hosting
customers have a larger role to play in cleaning up con-
tent than ones with dedicated hosting clients. It might
very well be the case that the worst performer in terms of
both occurrence of abuse and response to abuse provides
solely unmanaged hosting to its customers and therefore
not in the same position as its peers that provide mainly
shared hosting.
In this case the observed performance
could simply be indicating the security of the hosting
customers rather than that of the hosting provider itself.

10 Sensitivity Analysis
To better understand the impact of key design decisions,
we undertake a brief sensitivity analysis of alternative
speciﬁcations for (i) unit of abuse, (ii) abuse normaliza-
tion, and (iii) metric aggregation strategies. We explore
the robustness of the results by producing rankings based

7

of hosting providers in detecting abuse and reacting to
user complaints for shared hosting providers. It paints a
general picture that underlines the need for hosting repu-
tation metrics. None of these studies try to develop rep-
utation metrics from abuse data, however.

Closest to our work are [1, 3, 14]. [6] produces a
weighted metric score for ASes. [1] includes only up-
time data and focuses mainly on identifying the worst
actors. We expand on this work by systematically ad-
dressing challenges not discussed there. These studies
typically count IP addresses as the unit of abuse and use
advertised IP address space as a normalization factor.

Industry attention to hosting has been along the lines
of the Host Exploit Index (HE index) [4]. While valu-
able, their methodologies are not fully transparent and
the parts that are, suffer from similar limitations as the
academic work discussed above.

12 Conclusions

This paper has systematically worked through the many
challenges of developing security reputation metrics for
hosting providers. All conceivable metrics will suffer
from various limitations, that much is clear. This is not
to say that they are not useful. We presented our ap-
proach to various stakeholders in the Netherlands, in-
cluding hosting providers. The main response was that
the metrics were a valid starting point for evaluating host-
ing security, incentivizing self-regulation and, ultimately,
identifying actors for enforcement activities.

The way forward is to improve the methodology. First,
we aim to include additional abuse data feeds and more
uptime data. We also are improving the identiﬁcation
of hosting providers by using WHOIS data on IP ad-
dress ownership, rather than AS-level routing data. We
are working on techniques to differentiate various host-
ing provider services, so that abuse rates can take these
into account. A further step is to use different aggre-
gation techniques, such as factor analysis. We also aim
to further investigate incentives under certain conditions
where security metrics can be gamed by providers. Last,
but not least, we will undertake more in-depth sensitiv-
ity analysis of how the various methodological decisions
impact the metric.

It is safe to say that a lot of current claims about host-
ing providers are based on anecdotal evidence or meth-
ods that are not adequately understood. This paper con-
tributes to remediating this shortfall.

Acknowledgements

This work was funded by NWO under Pr. Nr. CYBSEC.12.003 /
628.001.003, and SIDN (www.sidn.nl). We would like to thank Paul
Vixie and Eric Ziegast for great support, NCSC, the Dutch police,
Farsight Security, StopBadware, APWG, Meldpunt, Shadow Server,
Abuse.ch, and PhishTank for providing access to their data.

References

[1] Brett Stone-Gross et al. “FIRE: FInding Rogue
nEtworks”. In: ACSAC. 2009, pp. 231–240.

[2] Davide Canali, Davide Balzarotti, and Aur´elien
Francillon. “The role of web hosting providers in
detecting compromised websites”. In: WWW. May
2013, pp. 177–188.

[3] Craig A. Shue, Andrew J. Kalafut, and Mi-
naxi Gupta. “Abnormally Malicious Autonomous
Systems and Their Internet Connectivity”. In:
IEEE/ACM TON 20.1 (2012), pp. 220–230.

[4] HostExploit. URL: http://hostexploit.com/.

[5] T Moore and R Clayton. “The impact of incentives
on notice and take-down”. In: Managing Informa-
tion Risk and the Economics of Security (2009),
pp. 199–223.

[6] C. Wagner et al. “ASMATRA: Ranking ASs pro-
viding transit service to malware hosters”. In: In-
tegrated Network Management. 2013, pp. 260–
268.

[7] Danny Bradbury. “Testing the defences of bullet-
proof hosting companies”. In: Network Security
2014.6 (June 2014), pp. 8–12.

[8] Andreas Pitsillidis et al. “Taster’s choice: a com-
parative analysis of spam feeds”. In: IMC. 2012,
p. 427.

[9] Leigh Metcalf and Jonathan M Spring. Everything
You Wanted to Know About Blacklists But Were
Afraid to Ask. Tech. rep. CERT Network Situa-
tional Awareness Group, 2013.

[10] M Van Eeten, JM Bauer, and H Asghari. “The
role of internet service providers in botnet miti-
gation an empirical analysis based on spam data”.
In: WEIS. 2010.

[11] T Moore and R Clayton. “Examining the impact
of website take-down on phishing”. In: eCrime.
2007.

[12] Marc K¨uhrer, Christian Rossow, and Thorsten
Holz. “Paint It Black: Evaluating the Effective-
ness of Malware Blacklists”. In: RAID. Vol. 7462.
LNCS. Cham, 2012, pp. 1–21.

[13] Shuang Hao et al. “Understanding the domain reg-
istration behavior of spammers”. In: IMC. Oct.
2013, pp. 63–76.

[14] Stjepan Gros, Mislav Stubli´c, and Leonardo Jelen-
ovi´c. “Determining autonomous systems reputa-
tion based on DNS measurements”. In: MIPRO.
2012, pp. 1526–1528.

8

