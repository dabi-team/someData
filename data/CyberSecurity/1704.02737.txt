Secure Mode Distinguishability for
Switching Systems Subject to Sparse
Attacks (cid:63)

Gabriella Fiore ∗ Elena De Santis ∗
Maria Domenica Di Benedetto ∗

∗ Center of Excellence DEWS, Department of Information
Engineering, Computer Science and Mathematics, University of
L’Aquila, Italy. (E-mail: gabriella.ﬁore@graduate.univaq.it;
elena.desantis,mariadomenica.dibenedetto@univaq.it).

7
1
0
2

r
p
A
0
1

]

Y
S
.
s
c
[

1
v
7
3
7
2
0
.
4
0
7
1
:
v
i
X
r
a

Abstract: Switching systems are an important mathematical formalism when dealing with
Cyber-Physical Systems (CPSs). In this paper we provide conditions for the exact reconstruction
of the initial discrete state of a switching system, when only the continuous output is measurable,
and the discrete output signal is not available. In particular, assuming that the continuous input
and output signals may be corrupted by additive malicious attacks, we provide conditions for the
secure mode distinguishability for linear switching systems. As illustrative example, we consider
the hybrid model of a DC/DC boost converter.

Keywords: Switching systems, mode distinguishability, secure state estimation.

1. INTRODUCTION

In Cyber-Physical Systems (CPSs) physical processes,
computational resources and communication capabilities
are tightly interconnected. Traditionally, the physical com-
ponents of a CPS are described by means of diﬀerential
or diﬀerence equations, while the cyber components are
modeled by means of discrete dynamics. Therefore, hy-
brid systems, that are heterogeneous dynamical systems
characterized by the interaction of continuous and discrete
dynamics, are a powerful modeling framework to deal
with CPSs. Switching systems are an important subclass
of hybrid systems and can be viewed as a higher level
abstraction of a hybrid model. In general, for switching
systems the observability property is concerned with the
possibility of reconstructing the hybrid state, i.e. both
the discrete state (also called mode or location) and the
continuous one.

The focus of this paper is on the exact reconstruction of
the discrete state of a switching system, when only the
continuous output is accessible and the discrete output is
not available, using the formalism introduced in De Santis
(2011) and developed in De Santis and Di Benedetto
(2016), where the authors address the problem of discrete
state reconstruction for ideal autonomous and controlled
switching systems. In this paper, we extend those results,
by investigating the scenario in which the continuous input

(cid:63) NOTICE: this is the authors version of a work that was accepted
for publication in IFAC 2017 World Congress. Changes resulting
from the publishing process, such as peer review, editing, corrections,
structural formatting, and other quality control mechanisms may not
be reﬂected in this document. Changes may have been made to this
work since it was submitted for publication. A deﬁnitive version was
subsequently published in IFAC World Congress, July 2017 (see Fiore
et al. (2017b)).

and output signals may be corrupted by additive malicious
attacks. This is motivated by the great importance of secu-
rity issues for CPSs, where the presence of a feedback loop
between the physical processes and the controllers through
the communication network may increase the vulnerability
of the system to failures or malicious attacks. In this case,
security measures protecting only the computational and
communication layers are not suﬃcient for guaranteeing
the safe operation of the entire system against the pres-
ence of malicious attackers. Therefore, new strategies that
explicitly address the strong interconnection between the
physical, the computational and the network layers are
needed.

There exists a vast literature dealing with security for
CPSs (see Amin et al. (2009) and Pasqualetti et al. (2015)
to name a few). In general, cyber attacks can be divided
in two main categories (see Amin et al. (2009)): deception
attacks compromising the integrity of the information, and
denial-of-service attacks compromising the availability of
the information. Recent results focus on the case when
the attack is not represented by a speciﬁc model, but
it is assumed to be unbounded and inﬂuencing only a
small subset of sensors and/or actuators, i.e., the attack
is sparse but its intensity can be unbounded (see Fawzi
et al. (2014), Chong et al. (2015), Shoukry et al. (2015),
Shoukry and Tabuada (2016), Hu et al. (2016), Shoukry
et al. (2016), Fiore et al. (2017a)). In Fawzi et al. (2014)
the authors propose a method to estimate the state of
a linear time invariant system when an unknown (but
ﬁxed in time) set of sensors and actuators is corrupted by
sparse deception attacks. They prove that, if the number of
corrupted devices is smaller than a certain threshold, then
it is possible to exactly recover the internal state of the
system, by means of an algorithm derived from compressed
sensing techniques. A more computational eﬃcient version

 
 
 
 
 
 
of the algorithm is presented in Shoukry and Tabuada
(2016) where the authors introduce a notion of strong
observability and a recursive algorithm that estimates
the state despite the presence of the attack. The same
assumption on the sparsity of the attack signal is made
in Chang et al. (2016) where the authors consider a more
general case in which the set of attacked nodes can change
over time. A similar approach is used in Chong et al.
(2015) where a continuous time linear system is considered.
In order to overcome the limitations imposed by the
combinatorial nature of the problem, in Shoukry et al.
(2016) the authors formulate the problem as a satisﬁability
one, and propose a sound and complete algorithm based on
the Satisﬁability Modulo Theory paradigm. All the above-
mentioned works are concerned with the state estimation
for linear systems and cannot be directly applied to
switching systems.

Contribution.
In this paper, we investigate under which
conditions the exact reconstruction of the initial discrete
state of a switching system is resilient against the pres-
ence of a sparse attack. In order to estimate the current
mode of the switching system when the discrete output
is not available and only the continuous output signal is
accessible, we need to distinguish which discrete state is
indeed active, i.e. we need to distinguish between any two
dynamical systems, based on the continuous information
only. This problem has been addressed in the literature
for switching systems where the continuous input and
output information is not corrupted by failures or ma-
licious attacks (see De Santis and Di Benedetto (2016)
and references therein for a complete review of existing
results on this topic). In Baglietto et al. (2014) the authors
investigate the problem of identifying the current location
of a switching system when the continuous measurement
signal is corrupted by noise. This disturbance is assumed
to have bounded magnitude and therefore their results do
not apply to the case in which the additive signal is not
a measurement noise but an intentional attack performed
by a malicious attacker, the magnitude of which can be
unbounded. Thus, when the continuous input and output
signals can be compromised by a malicious attacker, we ex-
tend the characterization presented in Fawzi et al. (2014)
by deﬁning a notion of secure distinguishability. We model
an attack on the sensors as an attack on the continuous
output signal of the switching system, and an attack on the
actuators as an attack on the continuous input signal. We
consider both the case of autonomous switching systems
and the case of controlled switching systems.

The paper is organized as follows. In Section 2 we provide
a general formulation of our problem. In Section 3 we
investigate the case of controlled switching systems in
which both the sensor measurements and the actuator
signals can be corrupted by a malicious attacker. In Section
4 we consider the case of autonomous switching systems
with sparse attacks on sensors. In Section 5 we provide
an illustrative example, in which we check if the dynamics
of a DC/DC boost converter are securely distinguishable,
making use of the hybrid model provided in Theunisse
et al. (2015).

Notation.
In this paper we use the following notation. I
indicates the identity matrix, 0 indicates the null matrix of

proper dimensions (which can be trivially deduced by the
context). Given a vector x ∈ Rn, supp(x) is its support,
that is the set of indexes of the non-zero elements of x;
(cid:107)x(cid:107)0 is the cardinality of supp(x), that is the number of
non-zero elements of x. The vector x ∈ Rn is said to be
s-sparse if (cid:107)x(cid:107)0 ≤ s. Sn
s indicates the set containing all
the s-sparse vectors xi ∈ Rn such that (cid:107)xi(cid:107)0 ≤ s. Given
the function y : N → Rp, y|[t0,t0+T −1] is the collection
i.e. y|[t0,t0+T −1] = (y(t0)(cid:62) y(t0 +
of T samples of y,
1)(cid:62) · · · y(t0 + T − 1)(cid:62))(cid:62). The function y is said to be
cyclic s-sparse if, given a set Γ ⊂ {1, . . . , p}, such that
s and supp(y(t)) ⊆ Γ, for all t ∈ N. CSpT
|Γ| = s, y(t) ∈ Sp
s
is the set containing all the cyclic s-sparse vectors y ∈ RpT .
Given a matrix M ∈ Rn×m and a set Γ ⊆ {1, . . . n}, we
denote by M Γ ∈ R(n−|Γ|)×m the matrix obtained from M
by removing the rows whose indexes are contained in Γ.
If Γ is the support of a vector x ∈ Rn, its complement
is Γ = {1, . . . n} \ Γ. Thus, M Γ ∈ R|Γ|×m is the matrix
obtained from M by removing the rows whose indexes are
contained in Γ, or, equivalently, the rows whose indexes
are not contained in Γ. Given the set Π ⊆ {1, . . . m} we
denote by (cid:102)MΠ ∈ Rn×(m−|Π|) the matrix obtained from
M by removing the columns whose indexes are contained
in Π. (cid:102)MΠ ∈ Rn×|Π| is the matrix obtained from M by
removing the columns whose indexes are not contained in
Π.

2. PROBLEM FORMULATION

In this paper we consider a nominal switching system,
where the ﬁnite set of discrete states is Q = {1, . . . , N }. A
linear discrete-time dynamical system Si is associated to
each discrete state i ∈ Q, which is fully described by the
tuple (Ai, Bi, Ci) as follows:

x(t + 1) = Aix(t) + Biu(t),

x(t0) = x0

y(t) = Cix(t)

(1)

where t ∈ Z, Z denotes the set of nonnegative integer
numbers, x(t) ∈ Rn is the (continuous) state of the system,
y(t) ∈ Rp is the output measured by the sensors, u(t) ∈
Rm is the input sent by the controller to the actuators. The
collection of all subsystems Si, i ∈ Q is denoted by S. We
assume that only the continuous input and output signals
are known, whereas the initial discrete state q0 ∈ Q, and
the initial continuous state x0 ∈ Rn are unknown. The
switching signal speciﬁes which dynamical system Si ∈ S
is currently active in each time instant, that is, which is
the current discrete state. In this paper we assume that
the switching signal is unknown and arbitrary, therefore
we do not exploit any information about the underlying
graph topology, representing the admissible transitions
between discrete states. Let t0 = 0 be the initial time.
For a given T > 0, we assume that no switching occurs
in the interval [0, T ]. In other words, we assume that the
switching system dwells enough time in each discrete mode
before a new transition takes place. More speciﬁcally, we
assume the existence of a minimum dwell time T such that
each discrete state remains active for at least T steps.

We consider the scenario in which sensor measurements
(continuous output) are sent to the controller, which es-
timates the true discrete state of the system and the cor-
responding initial continuous state (which are unknown).

and the continuous input signal (which can be corrupted
by a malicious attacker, too). The reconstruction of the
discrete mode of the switching system corresponds to un-
derstanding which continuous dynamical system is evolv-
ing, in a set S of known ones. This means that, given a
pair of linear systems, we have to investigate the possibility
of distinguishing which one of the two systems is active,
based on the continuous output and input information,
despite the presence of sparse attacks. The initial discrete
state can be reconstructed if and only if each pair in
S can be distinguished. If the initial discrete state can
be reconstructed, then also the discrete state after each
switching can be reconstructed, provided that the dwell
time is suﬃciently large.

For the nominal system in (1), diﬀerent distinguishability
notions have been proposed, based on the role of the input
function and of the continuous initial state (see De Santis
(2011) for an exhaustive analysis). In this paper, we inte-
grate these notions, by introducing the secure distinguisha-
bility property for the corrupted switching system in (2),
and we investigate under which conditions this property
holds. More speciﬁcally, we assume that the continuous in-
put and output signals can be corrupted by sparse attacks,
as in Fawzi et al. (2014). However, in spite of considering a
discrete-time linear system, we extend the characterization
in Fawzi et al. (2014) to switching systems. Therefore, our
attention is focused in providing conditions which enable
the correct identiﬁcation of the current location of the
switching system, despite the presence of sparse attacks.

For the sake of clarity, we ﬁrst review the notion of dis-
tinguishability between nominal linear systems, described
as in (1), in which the distinguishability is required for
generic inputs and for all initial states. A generic input
sequence u|[0,τ −1) is any input sequence that belongs to a
dense subset of the set Rmτ , equipped with the L∞ norm.
Let yi, i ∈ Q, be the output evolution when the dynamical
system Si is active with initial state x(0) = x0i, and let U
be the set of all input functions u : N → Rm.
Deﬁnition 2. (De Santis (2011)) Two linear systems Si
and Sj, (i, j) ∈ Q × Q, are input-generic distinguishable if
there exists τ ∈ N such that, for any pair of initial states
x0i and x0j, and for a generic input sequence u|[0,τ −1),
with u ∈ U, yi|[0,τ −1] (cid:54)= yj|[0,τ −1]. The systems Si and Sj
are called indistinguishable if they are not input-generic
distinguishable.

In Section 3 we introduce the notion of secure distinguisha-
bility for corrupted discrete time linear systems described
as in (2), whereas in Section 4 we describe how to change
the notion of secure distinguishability in the case in which
autonomous linear systems are considered.

3. CONTROLLED SWITCHING SYSTEMS

In this section we consider the corrupted system in (2),
with attacks on sensor measurements and on input signals
which are σ-sparse and ρ-sparse, respectively.

First, we recall the result on input-generic distinguishabil-
ity for the nominal system in (1). The distinguishability
notion implies the comparison between the output evolu-
tions of diﬀerent dynamical systems. Thus, let two nominal
linear systems Si and Sj, (i, j) ∈ Q × Q, be given. We

Fig. 1. Conceptual block diagram of the control system.
The plant is modeled as a switching system, a dynamical system
as in (1) is associated to each discrete mode i, j ∈ Q. Sensor
measurements and control inputs are exchanged by means of
a communication network. ˆq ∈ Q indicates the estimate of the
current discrete mode, ˆx ∈ Rn is the estimate of the continuous
state.

Based on this estimation, the controller sends the control
signal (continuous input) to the actuators, as shown in Fig.
1. We assume that sensor measurements and actuator in-
puts are exchanged by means of a wireless communication
network, and that both of them could be compromised
by an external malicious attacker. With this assumption,
we consider both the case in which the attacker compro-
mises the devices (sensors or actuators, also called nodes)
and the case in which the attacker aﬀects the commu-
nication links between diﬀerent devices (that is, between
sensors/actuators and the controller).

(2)

The corrupted system can be described as follows:

x(t + 1) = Aix(t) + Bi[u(t) + v(t)]

y(t) = Cix(t) + w(t)
where v(t) ∈ Sm
ρ is the ρ-sparse attack vector on actuator
signals, and w(t) ∈ Sp
σ is the σ-sparse attack vector
on sensor measurements. We assume that the malicious
attacker has only access to a subset of sensors Kw ⊂
{1, . . . , p}, and to a subset of actuators Kv ⊂ {1, . . . , m},
meaning that the set of attacked nodes is ﬁxed over time
(but unknown). This assumption is motivated by the fact
that it is reasonable to suppose that, in a real system, the
attacker has not access to the whole set of monitoring and
controlling devices.
Assumption 1. We assume that the attack on sensor mea-
surements is cyclic σ-sparse (for brevity, σ-sparse), and
that the attack on actuator signals is cyclic ρ-sparse (for
brevity, ρ-sparse).
Roughly speaking, Assumption 1 means that we know that
both the set of attacked sensors and the set of attacked
actuators have bounded cardinality (that is, |Kw| ≤ σ < p,
|Kv| ≤ ρ < m, respectively), but we do not know which
nodes are actually compromised. Let wk(t) denote the
k-th component of w(t) ∈ Rp, k ∈ {1, . . . , p} (i.e., the
component of w(t) corresponding to the k-th sensor), at
time t ∈ N. If k /∈ Kw, then wk(t) = 0 for all t ∈ N
and the k-th sensor is said to be secure (i.e. not attacked).
If k ∈ Kw, then wk(t) can assume any value and this
corresponds to the case in which the attacker has access
to the k-th sensor. The same holds for attacks on the
actuators.

The problem that we consider in this paper is to provide
conditions for the exact reconstruction of the discrete state
of a switching system in the time interval [0, T ], based on
the knowledge of the corrupted continuous output signal

Fig. 2. Attack on sensors and actuators: the augmented

linear system Sij.

consider the augmented linear system Sij, which is fully
described by the triple (Aij, Bij, Cij), such that:

Aij =

(cid:21)

(cid:20)Ai 0
0 Aj

, Bij =

(cid:21)

(cid:20)Bi
Bj

, Cij = [Ci −Cj]

(3)

with Aij ∈ R2n×2n, Bij ∈ R2n×m, Cij ∈ Rp×2n.
The following matrices are also associated with the aug-
mented system Sij:

Oij =

Mij =















i





= (cid:2)O(2n−1)

Cij
Cij Aij
...
Cij A2n−1
ij
0
Cij Bij
...
ij Bij Cij A2n−3
Cij A2n−2

−O(2n−1)
j

(cid:3) ,

· · ·
· · ·

0
0
...
· · ·
ij Bij · · · Cij Bij

0
0
...

(4)







i

and O(2n−1)
j

where 0 ∈ Rp×m is the null matrix, Mij ∈ R2np×(2n−1)m.
Oij ∈ R2np×2n is the 2n steps-observability matrix for the
augmented system Sij, and it is made up of the 2n steps-
observability matrices O(2n−1)
for the linear
systems Si and Sj, respectively.
Theorem 3. (De Santis (2011)) Two nominal linear sys-
tems Si and Sj, (i, j) ∈ Q × Q, are input-generic distin-
guishable if and only if Mij (cid:54)= 0.
Assumption 4. In this section, we assume that, for any
pair (i, j) ∈ Q × Q, the linear systems Si and Sj are input-
generic distinguishable.
We now extend Deﬁnition 2 and Theorem 3 to take into
account the presence of the (unknown) attack on sensors
and actuators, as in (2), when the controller is not aware
neither of which actuators are corrupted, nor of which
sensors are corrupted. In this case, the distinguishability
between diﬀerent modes is required for generic inputs,
generic ρ−sparse attacks on actuators, for all σ−sparse
attacks on sensors, and for all initial states.
Deﬁnition 5. Two linear systems Si and Sj, (i, j) ∈ Q×Q,
are securely distinguishable with respect to generic inputs,
generic ρ−sparse attacks on actuators and for all σ−sparse
attacks on sensors (shortly, σρ−securely distinguishable),
if there exists τ ∈ N such that yi|[0,τ −1] (cid:54)= yj|[0,τ −1], for any
pair of initial states x0i and x0j, for any pair of σ−sparse
σ and wj|[0,τ −1] ∈ CSτ p
attack vectors wi|[0,τ −1] ∈ CSτ p
σ ,
ρ × Sm
and for any generic (u, vi, vj) ∈ U × Sm
ρ .

To the aim of characterizing the σρ−secure distinguisha-
bility property, we consider the augmented linear system
Sij depicted in Fig. 2. We assume that the sets of attacked
actuators for Si and Sj are, respectively, ∆i ⊂ {1, . . . , m}
and ∆j ⊂ {1, . . . , m}, with |∆i| = |∆j| = ρ. The sets

of attacked sensors for Si and Sj are, respectively, Γi ⊂
{1, . . . , p} and Γj ⊂ {1, . . . , p}, with |Γi| = |Γj| = σ.

We can reformulate the component of the state due to
the attack on actuators as Bivi = (cid:101)Bi,∆i
di(t) and Bjvj =
∈ Rn×ρ,
dj(t), where di(t) ∈ Rρ, dj(t) ∈ Rρ. (cid:101)Bi,∆i
(cid:101)Bj,∆j
∈ Rn×ρ are the matrices obtained from Bi and Bj
(cid:101)Bj,∆j
by removing the columns whose indexes are not contained
in ∆i and ∆j, respectively.

The augmented linear system Sij is represented by the
following equations:

x(t + 1) =

(cid:105)

(cid:104)Ai 0
0 Aj

x(t) +

(cid:105)

(cid:104)Bi
Bj

u(t) +

(cid:34)
(cid:101)Bi,∆i
0

(cid:35)

(cid:105)
(cid:104)di(t)
dj (t)

0
(cid:101)Bj,∆j

= Aijx(t) + Biju(t) + (cid:98)Bidi(t) + (cid:98)Bjdj(t)

y(t) = [Ci −Cj] x(t) + wi(t) − wj(t)

where x(t) ∈ R2n, wi(t) ∈ Sp
(cid:98)Bj ∈ R2n×ρ.
The following matrices are associated with the augmented
system Sij in (5):

σ, wj(t) ∈ Sp

(5)
σ, (cid:98)Bi ∈ R2n×ρ,

M ij

i

(cid:3)







U =

−O(2n−1)
j

Oij = (cid:2)O(2n−1)

0
Cij Bij
...
ij Bij Cij A2n−3
Cij A2n−2
0
Cij (cid:98)Bi
...
Cij A2n−2
ij
0
Cij (cid:98)Bj
...
Cij A2n−2
ij

(cid:98)Bi Cij A2n−3

(cid:98)Bj Cij A2n−3

ij
0
0
...

Mj =

Mi =











ij

0
0
...

· · ·
· · ·

0
0
...
· · ·
ij Bij · · · Cij Bij

· · ·
0
0
· · ·
...

0
0
...





· · ·







(6)

(cid:98)Bi · · · Cij (cid:98)Bi
· · ·
· · ·

0
0
...







· · ·

(cid:98)Bj · · · Cij (cid:98)Bj

where M ij
U ∈ R2np×(2n−1)m, Mi ∈ R2np×(2n−1)ρ, Mj ∈
R2np×(2n−1)ρ, Oij ∈ R2np×2n is the 2n steps-observability
matrix for the augmented system Sij.
Deﬁnition 6. Let two linear systems Si and Sj, (i, j) ∈ Q×
Q, and sets Γ ⊂ {1, . . . , p}, |Γ| ≤ 2σ, ∆k ⊂ {1, . . . , m},
|∆k| ≤ ρ, k = i, j be given. Consider the input sequence
u|[0,τ −1), with u ∈ U, the attack sequences on actuators
di|[0,τ −1), dj|[0,τ −1) with di(t) ∈ Rρ, dj(t) ∈ Rρ, and the
attack sequences on sensors wi|[0,τ −1), wj|[0,τ −1). The set
Ω ⊂ ker(C ij,Γ) ⊂ R2n, is deﬁned as:
(cid:3)(cid:62)

∈ R2n : ∀u|[0,τ −1), ∀di|[0,τ −1),

Ω ={(cid:2)x(cid:62)

0i x(cid:62)
0j

∀wi|[0,τ −1), ∀wj|[0,τ −1), ∃dj|[0,τ −1) :
yi|[0,τ −1] = yj|[0,τ −1]}

(7)

Given sets Γ ⊂ {1, . . . , p}, ∆k ⊂ {1, . . . , m} such that
|Γ| ≤ 2σ, |∆k| ≤ ρ, k = i, j, let Ω∗ be the maximal
subspace such that

AijΩ∗ + Im (cid:0)(cid:2)Bij (cid:98)Bi

(cid:3)(cid:1) ⊂ Ω∗ + Im( (cid:98)Bj)

Ω∗ ⊂ ker(C ij,Γ)

(8)

Let Wij,Γ be the maximal (cid:0)A, (cid:2)Bij (cid:98)Bi (cid:98)Bj
invariant subspace contained in ker (cid:0)C ij,Γ
Basile and Marro (1992)).
Proposition 7. Given sets Γ ⊂ {1, . . . , p}, ∆k ⊂ {1, . . . , m}
such that |Γ| ≤ 2σ, |∆k| ≤ ρ, k = i, j, there exists Ω∗ as
in (8) if and only if:

(cid:3)(cid:1)-controlled
(cid:1) (as deﬁned in

(cid:3)(cid:1) ⊂ Wij,Γ.
If this inclusion holds, then Ω∗ = Wij,Γ.

Im (cid:0)(cid:2)Bij (cid:98)Bi

Proof. Assume that Ω∗ exists. Then Ω∗ is a
(cid:0)A, (cid:2)Bij (cid:98)Bi (cid:98)Bj
in ker (cid:0)C ij,Γ
Wij,Γ. Condition (8) implies that Im (cid:0)(cid:2)Bij (cid:98)Bi
Wij,Γ. On the other side, suppose that Im (cid:0)(cid:2)Bij (cid:98)Bi
Wij,Γ. Then AijWij,Γ ⊂ Wij,Γ + Im (cid:0)(cid:2)Bij (cid:98)Bi (cid:98)Bj
Wij,Γ + Im

(cid:3)(cid:1)-controlled invariant subspace contained
(cid:1), hence Ω∗ ⊂ Wij,Γ because of maximality of
(cid:3)(cid:1) ⊂ Ω∗ ⊂
(cid:3)(cid:1) ⊂
(cid:3)(cid:1) =

(cid:16)

(cid:17)

(cid:98)Bj
. Since
AijWij,Γ + Im (cid:0)(cid:2)Bij (cid:98)Bi

(cid:3)(cid:1) ⊂ Wij,Γ + Im (cid:0)(cid:2)Bij (cid:98)Bi (cid:98)Bj

(cid:3)(cid:1)

and

Wij,Γ + Im (cid:0)(cid:2)Bij (cid:98)Bi (cid:98)Bj

(cid:3)(cid:1) = Wij,Γ + Im

(cid:17)

(cid:16)

(cid:98)Bj

then Wij,Γ ⊂ Ω∗, because of maximality of Ω∗. Therefore
(cid:3)
Ω∗ = Wij,Γ.

The output sequence of the augmented system Sij in (5)
can be written in compact form as:

Y = O(τ −1)

ij

x0 + M ij

U U + MiDi − MjDj + Wi − Wj

(10)
where Y = yi|[0,τ −1] − yj|[0,τ −1], U = u|[0,τ −1), Di =
di|[0,τ −1), Dj = dj|[0,τ −1), Wi = wi|[0,τ −1), Wj =
wj|[0,τ −1), and the matrices are deﬁned in (6).
Proposition 8. Given sets Γ, with Γ ⊂ {1, . . . , p}, |Γ| ≤ 2σ
and (∆i, ∆j) with ∆k ⊂ {1, . . . , m}, |∆k| ≤ ρ, for k = i, j
(10) has a solution (cid:2)x(cid:62)
(cid:3)(cid:62)
∈ R(2n+τ ρ), for all Di, for
all Wi, for all Wj, and for all U , if and only if Im (Bij) +
Im
.

⊂ Wij,Γ + Im

0 D(cid:62)
j

(cid:16)

(cid:17)

(cid:16)

(cid:17)

(cid:98)Bj

(cid:98)Bi

Proof. Assume that yi|[0,τ −1] = yj|[0,τ −1]. Then the set
Ω∗ is non-empty. Therefore AijΩ∗ + Im (cid:0)(cid:2)Bij (cid:98)Bi
(cid:3)(cid:1) ⊂
Ω∗ + Im( (cid:98)Bj), and the following holds: AijΩ∗ + Im (Bij) +
⊂ Ω∗ + Im( (cid:98)Bj) ⊂ Wij + Im( (cid:98)Bj). Thus Im (Bij) +
Im

(cid:98)Bi

(cid:16)

(cid:17)

(cid:17)

(cid:16)

(cid:98)Bi

Im

⊂ Wij,Γ + Im

(cid:16)

(cid:17)

.

(cid:98)Bj

(cid:16)

(cid:17)

(cid:16)

(cid:17)

(cid:98)Bi

(cid:98)Bj

⊂ Wij,Γ + Im

.
(cid:3)(cid:1) ⊂ Wij,Γ +Im( (cid:98)Bj). As Wij,Γ is the
(cid:3)(cid:1)-controlled invariant subspace
(cid:1), then there exist Wi and Wj such
(cid:3)

Assume now that Im (Bij) + Im
Therefore Im (cid:0)(cid:2)Bij (cid:98)Bi
maximal (cid:0)A, (cid:2)Bij (cid:98)Bi (cid:98)Bj
contained in ker (cid:0)C ij,Γ
that yi|[0,τ −1] = yj|[0,τ −1].
Theorem 9. Two linear systems Si and Sj, (i, j) ∈ Q × Q,
are σρ−securely distinguishable if and only if the following
conditions hold:

Im (Bij) + Im

(cid:42) Wij,Γ + Im

Im (Bij) + Im

(cid:16)

(cid:17)

(cid:42) Wij,Γ + Im

(cid:16)

(cid:17)

(cid:98)Bi

(cid:98)Bj

(cid:17)

(cid:16)

(cid:98)Bj
(cid:16)

(cid:98)Bi

(cid:17)

(11)

(9)

Fig. 3. The extended autonomous linear system Sij.

for any tuple of sets (Γ, ∆i, ∆j), with Γ ⊆ {1, . . . , γ},
|Γ| ≤ 2σ, and ∆k ⊆ {1, . . . , δ}, |∆k| ≤ ρ, for k = i, j.

Proof. The proof directly follows from Propositions 7 and
(cid:3)
8.

4. AUTONOMOUS SWITCHING SYSTEMS

In this section, an autonomous switching system, whose
continuous output is corrupted by a sparse attack,
is
considered. A dynamical system is associated to each
discrete state as follows:

x(t + 1) = Aix(t), x(t0) = x0
y(t) = Cix(t) + w(t)

(12)

σ represents the σ-sparse attack on the

where w(t) ∈ Sp
sensor measurements.
Remark 10. Let two nominal autonomous linear systems
Si and Sj be given (that is, in (12) the attack vectors
are such that wi(t) = wj(t) = 0, ∀ t ∈ N). When
both Si and Sj have initial condition in the origin (i.e.,
x0i = x0j = 0), the output evolutions are identically
zero. Thus, for autonomous systems, the distinguishability
between diﬀerent modes can not be required for any initial
state. Therefore, the following distinguishability notion is
considered, in which the possibility of both autonomous
linear systems having initial condition in the origin, is
excluded.
Deﬁnition 11. (Vidal et al. (2002)) Two autonomous lin-
ear systems Si and Sj, (i, j) ∈ Q × Q, are distinguish-
able, if there exists τ ∈ N such that, for any pair of
initial states x0i and x0j (with x0i
(cid:54)= 0),
yi|[0,τ −1]
(cid:54)= yj|[0,τ −1]. The nominal autonomous linear
systems Si and Sj are called indistinguishable if they are
not distinguishable.

(cid:54)= 0 or x0j

Our aim is to investigate under which conditions it is
possible to determine the current mode of the autonomous
switching system in (12) (without knowing the continu-
ous initial state), when the continuous output signal is
corrupted. In order to do so, we extend Deﬁnition 11 to
take into account the presence of the (unknown) attack on
sensors.
Deﬁnition 12. Two autonomous linear systems Si and Sj,
(i, j) ∈ Q×Q, are σ-securely distinguishable if there exists
τ ∈ N such that, for any pair of initial states x0i and x0j
(with x0i (cid:54)= 0 or x0j (cid:54)= 0), and for any pair of σ-sparse
attack vectors wi|[0,τ −1] ∈ CSτ p
σ and wj|[0,τ −1] ∈ CSτ p
σ ,
yi|[0,τ −1] (cid:54)= yj|[0,τ −1].

As already described in the previous section, in order to
compare the output evolutions of two autonomous linear
systems Si and Sj, (i, j) ∈ Q × Q, we consider the
augmented linear system Sij, depicted in Fig. 3, which
is fully described by the pair (Aij, Cij), such that:

Aij =

(cid:21)

(cid:20)Ai 0
0 Aj

, Cij = [Ci −Cj]

(13)

with Aij ∈ R2n×2n, Cij ∈ Rp×2n. The following 2n steps-
observability matrix is associated with the augmented
system Sij:

(cid:104)

(cid:105)

i

O(2n−1)

−O(2n−1)
j

(14)

Oij =
where Oij ∈ R2np×2n.
First, we recall the result concerning the distinguishability
of two nominal autonomous systems.
Theorem 13. (Vidal et al. (2002)) Two nominal au-
tonomous linear systems Si and Sj, (i, j) ∈ Q × Q, are
distinguishable for any initial state x0i and x0j (with
x0i (cid:54)= 0 or x0j (cid:54)= 0) if and only if rank(Oij) = 2n.
Assumption 14. In this section, we assume that, for any
pair (i, j) ∈ Q × Q, the linear systems Si and Sj are
distinguishable.
Remark 15. In Assumption 14 we consider a number of ob-
servations τ = 2n (i.e., equal to the state space’s dimension
of the augmented system Sij). It can be noted that, adding
further observations (i.e., beyond 2n samples) would not
increase the rank of the observability matrix O(2n−1)
be-
cause, due to the Cayley-Hamilton theorem, they would
be a linear combination of the ﬁrst 2n components.
Proposition 16. Two autonomous linear systems Si and
Sj, (i, j) ∈ Q × Q, are σ-securely distinguishable if and
only if, for any set Γ ⊆ {1, . . . , γ} with |Γ| ≤ 2σ, the matrix
Oij,Γ obtained from the pairs (Ai, C i,Γ) and (Aj, C j,Γ) has
full column rank.

ij

Proof. Assuming to collect 2n observations, the output
of the augmented linear system Sij, as shown in Fig. 3, is:
(cid:104)

(cid:21)

yi|[0,2n−1] − yj|[0,2n−1] =

O(2n−1)

i

− O(2n−1)
j

(cid:105) (cid:20)x0i
x0j

+ wi|[0,2n−1] − wj|[0,2n−1]

= Oij

+ wi|[0,2n−1] − wj|[0,2n−1]

(cid:21)

(cid:20)x0i
x0j

Let us rearrange equation (15) as:
(cid:21)

Yi − Yj = Oij

+ Wi − Wj

(cid:20)x0i
x0j
= O(2n−1)
ij

x0 + ∆W

(15)

(16)

where Wi = wi|[0,2n−1] ∈ CS2np
CS2np
and x0 = (cid:2)x(cid:62)

σ , Wj = wj|[0,2n−1] ∈
σ , ∆W ∈ CS2np
2σ , Yi = yi|[0,2n−1], Yj = yj|[0,2n−1]
(cid:3)(cid:62)
.

0i x(cid:62)
0j

By contradiction, assume that for any set Γ = {1, . . . , γ},
|Γ| ≤ 2σ, the observability matrix Oij,Γ obtained from the
two pairs (Ai, C i,Γ) and (Aj, C j,Γ) has full column rank
(i.e. ker(Oij,Γ) = {0}), and that there exist two initial
(cid:54)= 0) and a pair
states x0i and x0j (x0i
of attack vectors Wi ∈ CS2np
σ , such that
Yi = Yj. Let Γ = {k ∈ {1, . . . , 2np} | ∆Vk (cid:54)= 0} be the set
of indexes k ∈ {1, . . . , 2np}, for which the corresponding
k-th element of ∆W is diﬀerent from zero (i.e. ∆Wk (cid:54)= 0
), thus |Γ| ≤ 2σ. Oij,Γx0 = 0 ⇔ x0 ∈ ker(Oij,Γ), which is
a contradiction.

σ , Wj ∈ CS2np

(cid:54)= 0 or x0j

Assume now that there exists a set of indexes Γ, |Γ| ≤ 2σ,
for which the observability matrix Oij,Γ obtained from the
two pairs (Ai, C i,Γ) and (Aj, C j,Γ) has not full column
rank (i.e. there exists x0 (cid:54)= 0 such that x0 ∈ ker(Oij,Γ)),
and that there exist two initial states x0i and x0j (x0i (cid:54)= 0
or x0j (cid:54)= 0) and a pair of attack vectors Wi ∈ CS2np
σ , Wj ∈
CS2np
σ , such that Yi (cid:54)= Yj. Γ = {k ∈ {1, . . . , 2np} | ∆Vk (cid:54)=
0} is the set of indexes k ∈ {1, . . . , 2np}, for which the
corresponding k-th element of ∆W is diﬀerent from zero
(i.e. ∆Wk (cid:54)= 0). Assume now to partition the set Γ as
Γ = Γi ∪ Γj such that |Γi| ≤ σ and |Γj| ≤ σ. For the sake
of clarity consider Oijx0 = v and assume that the pair
(Wi, Wj) is such that:

Wi,k =

Wj,k =

(cid:26) −vk
0

if k ∈ Γi
otherwise

,

(cid:26) vk if k ∈ Γj
0 otherwise

(17)

where Wi,k, k ∈ {1, . . . , 2np}, indicates the k-th element
of the vector Wi ∈ CS2np
σ . Thus Yi − Yj = Oijx0 +
∆W = 0, which contradicts the initial assumption of
(cid:3)
distinguishability.
Remark 17. Proposition 16 corresponds to an observabil-
ity notion stronger than the classical one, for the aug-
mented system Sij. This means that for the linear system
Sij the observability property must be satisﬁed even after
the removal of a proper number of output signals (in
particular, after the removal of the corrupted sensors).

Proposition 16 gives a bound on the cardinality of the
set of attacked sensors (that is, for the sparsity of the
attack vector). In particular, it is trivial to check that the
following condition has to be satisﬁed: 2σ < p.
Remark 18. This condition corresponds to the maximum
number of correctable errors (i.e., the maximum number
of attackable sensors) derived in Fawzi et al. (2014) for
the discrete-time linear system. Here, we obtain the same
bound for secure mode distinguishability of switching
systems.

5. NUMERICAL RESULTS

In this section, in order to show the applicability of the
proposed conditions, we apply them to a DC/DC boost
converter. We make use of the hybrid model described
in Theunisse et al. (2015), in which the behavior of the
DC/DC boost converter is modeled by means of three
discrete modes (two corresponding to the open switch, one
corresponding to the closed switch), thus Q = {1, 2, 3}.
When the switch is open, two dynamical systems S1 and
S3 can be active, depending on the diode conducting or
not. When the switch is closed, a single dynamics S2 can
be considered. The dynamical systems are described by
the following matrices:

A1 =

A2 =

A3 =

(cid:105)
(cid:104) 0
1/L

(cid:105)

, B1 =

(cid:104)−1/RC 1/C
0
−1/L
(cid:105)
(cid:104)−1/RC 0
, B2 = B1
0
0
(cid:105)
(cid:104)0
(cid:105)
(cid:104)−1/RC 0
, B3 =
0
0
0

(18)

We assume to consider the following output matrices:

C1 = C3 =

(cid:34)

0
0

(cid:35)

1
1

, C2 =

(cid:34)

1
1

(cid:35)

0
0

−1/RC 1/C

−1/RC 1/C

(19)

The model provided in Theunisse et al. (2015) takes into
account continuous-time linear systems. We consider here
their discretized version, to model the situation where
the sensors send the measurement signals with a time
triggered strategy. If the systems were autonomous, for
any pair (i, j) ∈ Q × Q, the linear systems Si and Sj
would be distinguishable for any initial state x0i and x0j
(with x0i
(cid:54)= 0 or x0j (cid:54)= 0), as rank(Oij) = 4, for any
(i, j) ∈ Q × Q. In this case, if the sensors were corrupted,
we should test the condition given in Proposition 16 for σ-
secure distinguishability. The number of attacked sensors
has to satisfy the condition 2σ < p, therefore the attacker
can have access to no more than one sensor or, in other
words, (at least) two sensors must be secure. In order
for S1 and S2 to be 1-securely distinguishable, for any
set Γ1 = {1, 2}, Γ2 = {1, 3}, Γ3 = {2, 3}, the matrix
O
, k = 1, 2, 3, obtained from the pairs (A1, C 1,Γk )
and (A2, C 2,Γk ) should be full column rank. The results
are shown in the ﬁrst column of Table 1.

(2n−1)
12,Γk

Table 1. 1-secure distinguishability of (Si, Sj)

Γ
Γ1
Γ2
Γ3

)

(2n−1)
rank(O
12,Γ
4
3
3

)

(2n−1)
rank(O
13,Γ
4
3
3

)

(2n−1)
rank(O
23,Γ
2
2
2

Actually, we can conclude that if S1 and S2 were au-
tonomous, they would not be 1-securely distinguishable,
due to the rank loss for some combinations of sensors.
The same holds for the pairs (S1, S3) and (S2, S3). How-
ever, since the dynamical systems are not autonomous,
we can verify the conditions provided in Section 3. In
particular, assuming that the actuator is secure, we can
check if the conditions in Theorem 9 are satisﬁed. Both
conditions in Theorem 9 are satisﬁed, therefore S1 and
S2 are σ0−securely distinguishable with respect to generic
inputs and for all σ−sparse attacks on sensors, with σ = 1.

6. CONCLUSIONS

Motivated by the fact that switching systems are an im-
portant mathematical formulation for dealing with CPSs,
in this paper we investigate under which conditions it
is possible to estimate the discrete state of a switching
system, when only the continuous output is accessible,
and the discrete information is not available. We consider
the case in which both sensor measurements and actuator
inputs may be compromised by malicious sparse attacks,
and we deﬁne under which conditions any two discrete
modes are securely distinguishable. The aim of our future
work is to propose a computational eﬃcient estimator
of the discrete state of switching systems when sensor
measurements and/or actuator signals are corrupted by
sparse malicious attacks. In addition, a more realistic sce-
nario will be investigated, in which bounded process and
measurement noises are also considered in the model of
the switching system.

REFERENCES

Amin, S., C´ardenas, A.A., and Sastry, S.S. (2009). Safe
and secure networked control systems under denial-of-
In Hybrid Systems: Computation and
service attacks.
Control, 31–45. Springer.

Baglietto, M., Battistelli, G., and Tesi, P. (2014). Mode-
observability degree in discrete-time switching linear
systems. Systems & Control Letters, 70, 69 – 76. doi:
http://dx.doi.org/10.1016/j.sysconle.2014.05.006.

Basile, G. and Marro, G. (1992). Controlled and condi-
tioned invariants in linear system theory. Prentice Hall
Englewood Cliﬀs.

Chang, Y.H., Hu, Q., and Tomlin, C.J. (2016). Secure esti-
mation based Kalman ﬁlter for Cyber-Physical Systems
against adversarial attacks. CoRR, abs/1512.03853v2.
URL http://arxiv.org/abs/1512.03853v2.

Chong, M.S., Wakaiki, M., and Hespanha, J.P. (2015). Ob-
servability of linear systems under adversarial attacks.
In American Control Conference (ACC), 2015, 2439–
2444. doi:10.1109/ACC.2015.7171098.

De Santis, E. (2011). On location observability notions for
switching systems. Systems & Control Letters, 60(10),
807–814.

De Santis, E. and Di Benedetto, M.D. (2016). Observ-
ability of hybrid dynamical systems. Foundations and
Trends in Systems and Control, 3(4), 363–540. doi:
10.1561/2600000009.

Fawzi, H., Tabuada, P., and Diggavi, S. (2014).

Se-
cure estimation and control for Cyber-Physical Sys-
IEEE Transac-
tems under adversarial attacks.
tions on Automatic Control, 59(6), 1454–1467.
doi:
10.1109/TAC.2014.2303233.

Fiore, G., Chang, Y.H., Hu, Q., Di Benedetto, M.D., and
Tomlin, C.J. (2017a). Secure state estimation for Cyber
Physical Systems with sparse malicious packet drops. In
American Control Conference (ACC), 2017.

Fiore, G., De Santis, E., and Di Benedetto, M.D. (2017b).
Secure mode distinguishability for switching systems
subject to sparse attacks. IFAC World Congress, 2017.
Hu, Q., Chang, Y.H., and Tomlin, C.J. (2016). Secure
estimation for Unmanned Aerial Vehicles against adver-
sarial cyber-attacks. 30th Congress of the International
Council of the Aeronautical Sciences (ICAS).

Pasqualetti, F., Dorﬂer, F., and Bullo, F. (2015). Control-
theoretic methods for cyberphysical security: geomet-
ric principles for optimal cross-layer resilient control
systems. IEEE Control Systems, 35(1), 110–127. doi:
10.1109/MCS.2014.2364725.

Shoukry, Y., Chong, M., Wakaiki, M., Nuzzo, P.,
Sangiovanni-Vincentelli, A.L., Seshia, S.A., Hespanha,
J.P., and Tabuada, P. (2016).
SMT-based observer
design for Cyber-Physical Systems under sensor at-
tacks.
In 2016 ACM/IEEE 7th International Confer-
ence on Cyber-Physical Systems (ICCPS), 1–10. doi:
10.1109/ICCPS.2016.7479119.

Shoukry, Y., Nuzzo, P., Bezzo, N., Sangiovanni-
Vincentelli, A.L., Seshia, S.A., and Tabuada, P. (2015).
Secure state reconstruction in diﬀerentially ﬂat sys-
tems under sensor attacks using Satisﬁability Mod-
In 2015 54th IEEE Conference
ulo Theory solving.
on Decision and Control (CDC), 3804–3809.
doi:
10.1109/CDC.2015.7402810.

Shoukry, Y. and Tabuada, P. (2016). Event-triggered
state observers for sparse sensor noise/attacks.
IEEE
Transactions on Automatic Control, 61(8), 2079–2091.
doi:10.1109/TAC.2015.2492159.

Theunisse, T.A.F., Chai, J., Sanfelice, R.G., and Heemels,
W.P.M.H. (2015). Robust global stabilization of the
DC-DC boost converter via hybrid control.
IEEE
Transactions on Circuits and Systems I: Regular Papers,
62(4), 1052–1061. doi:10.1109/TCSI.2015.2413154.
Vidal, R., Chiuso, A., and Soatto, S. (2002). Observ-
In
ability and identiﬁability of jump linear systems.
Decision and Control, 2002, Proceedings of the 41st
IEEE Conference on, volume 4, 3614–3619 vol.4. doi:
10.1109/CDC.2002.1184923.

