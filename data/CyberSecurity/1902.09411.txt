9
1
0
2

b
e
F
5
2

]

Y
S
.
s
c
[

1
v
1
1
4
9
0
.
2
0
9
1
:
v
i
X
r
a

ON APPROXIMATE OPACITY OF CYBER-PHYSICAL SYSTEMS

XIANG YIN1 AND MAJID ZAMANI2

Abstract. Opacity is an important information-Ô¨Çow security property in the analysis of cyber-physical sys-
tems. It captures the plausible deniability of the system‚Äôs secret behavior in the presence of an intruder that
may access the information Ô¨Çow. Existing works on opacity only consider non-metric systems by assuming
that the intruder can always distinguish two diÔ¨Äerent outputs precisely. In this paper, we extend the concept
of opacity to systems whose output sets are equipped with metrics. Such systems are widely used in the
modeling of many real-world systems whose measurements are physical signals. A new concept called approx-
imate opacity is proposed in order to quantitatively evaluate the security guarantee level with respect to the
measurement precision of the intruder. Then we propose a new simulation-type relation, called approximate
opacity preserving simulation relation, which characterizes how close two systems are in terms of the satis-
faction of approximate opacity. This allows us to verify approximate opacity for large-scale, or even inÔ¨Ånite
systems, using their abstractions. We also discuss how to construct approximate opacity preserving symbolic
models for a class of discrete-time control systems. Our results extend the deÔ¨Ånitions and analysis techniques
for opacity from non-metric systems to metric systems.

1. Introduction

1.1. Motivations. Cyber-physical systems (CPS) are complex systems resulting from tight interactions of
dynamical systems and computational devices. Such systems are generally very complex posing both contin-
uous and discrete behaviors which makes the veriÔ¨Åcation and design of such systems signiÔ¨Åcantly challenging.
In particular, components in CPS are usually connected via communication networks in order to acquire
and exchange information so that some global functionality of the system can be achieved. However, this
also brings new challenges for the veriÔ¨Åcation and design of CPS since the communication between system
components may release information that might compromise the security of the system. Therefore, how to
analyze and enforce security for CPS is becoming an increasingly important issue and has drawn considerable
attention in the literature in the past few years [KK12, SAJ15].

In this paper, we investigate an important information-Ô¨Çow security property called opacity. Roughly speaking,
opacity is a conÔ¨Ådentiality property that captures whether or not the ‚Äúsecret‚Äù of the system can be revealed
to an intruder that can infer the system‚Äôs actual behavior based on the information Ô¨Çow. A system is said
to be opaque if it always has the plausible deniability for any of its secret behavior. The concept of opacity
was originally proposed in the computer science literature as a uniÔ¨Åed notion for several security properties
[Maz04, BKMR08]. Since then, opacity has been studied more extensively in the context of Discrete-Event
Systems (DES), an important class of event-driven dynamical systems with discrete state spaces. For example,
in [SH11, SH12, SH13], several state-based notions of opacity were proposed, which include current-state
opacity, initial-state opacity, K-step opacity and inÔ¨Ånite-step opacity. In [Lin11], the author proposed two
language-based opacity called strong opacity and weak opacity and investigated their relationships with some
In [WL13], transformation algorithms among diÔ¨Äerent notions of opacity were proposed.
other properties.
The above mentioned works mainly consider DES modeled by Ô¨Ånite-state automata. More recently, the
deÔ¨Ånitions and veriÔ¨Åcation algorithms for diÔ¨Äerent notions of opacity have been extended to other classes of
(discrete) systems, including Petri nets [TLSG17a, TLSG17b, CFML18, BDT18], stochastic systems [SH14,
KH18, WLL18], recursive tile systems [CMPM14] and pushdown systems [KH13]. The interested readers are
referred to recent surveys [JLF16, LLH18] for more references and recent developments on this active research
area.

1

 
 
 
 
 
 
2

X. YIN AND M. ZAMANI

Since opacity is an information-Ô¨Çow property, its deÔ¨Ånition strictly depends on the information model of the
system. Most of the existing works in the literature formulate opacity by adopting the event-based observation
model, i.e., some events of the system (either transition labels or state labels) are observable or distinguishable
while some are not. This essentially assumes that the output of the system is symbolic in the sense that we
can precisely distinguish two outputs with diÔ¨Äerent labels. Hereafter, we will also refer to opacity under this
setting as exact opacity. Exact opacity is very meaningful for systems whose output sets are non-metric, e.g.,
discrete systems whose outputs are logic events. However, for many real-world applications whose outputs
are physical signals, instead of just saying that two events are distinguishable or indistinguishable, we may
have a measurement to quantitatively evaluate how close two outputs are. Such systems are referred to as
metric systems, where the output sets are equipped with appropriate metrics. For metric systems, if two
signals are very close to each other, then it will be very hard to distinguish them unambiguously due to
the measurement precision or potential measurement noises. A typical example of this scenario is linear
or nonlinear discrete-time control systems with continuous state-spaces and continuous output mappings.
Therefore, existing deÔ¨Ånitions of opacity are too strong for metric systems since they implicitly assume that
the intruder can always distinguish two output signals even when they are arbitrarily close to each other,
which is not practical.

1.2. Our Contributions. In this paper, we propose a new concept called approximate opacity that is more
In particular, we treat two outputs as ‚Äúindistinguishable‚Äù outputs if their
applicable to metric systems.
distance is smaller than a given threshold parameter Œ¥ ‚â• 0. We consider three basic types of opacity, initial-
state opacity, current-state opacity and inÔ¨Ånite-step opacity, and propose three new notions of opacity as
their approximate counterparts. For example, Œ¥-approximate initial-state opacity (respectively, Œ¥-approximate
current-state opacity) requires that, for any state run starting from a secret state (respectively, leading to
a secret state), there exists another state run starting from a non-secret state (respectively, leading to a
non-secret state), such that their corresponding output runs are Œ¥-close to each other. By ‚ÄúŒ¥-close‚Äù, we
mean that the largest distance between two output runs is smaller than Œ¥. Intuitively, Œ¥-approximate initial-
state opacity (respectively, Œ¥-approximate current-state opacity) says that the intruder can never determine
that the system is initiated from a secret state (respectively, currently at a secret state) if it does not have
an enough measurement precision which is captured by parameter Œ¥. Similarly, Œ¥-approximate inÔ¨Ånite-step
opacity requires that the intruder can never determine that the system was at secret state for any speciÔ¨Åc
instant if its measurement precision is no more than Œ¥. In other words, instead of requiring that the system is
exactly opaque, our new deÔ¨Ånitions essentially provide relaxed versions of opacity with a quantitative security
guarantees level with respect to the measurement precision of the intruder. Clearly, approximate opacity boils
down to the exact one when Œ¥ = 0. EÔ¨Äective veriÔ¨Åcation algorithms are also provided to verify approximate
opacity for the case of Ô¨Ånite systems.

It is worth noting that the complexity of verifying exact opacity is already PSPACE-hard [CDM12]. As a
generalization of exact opacity, verifying approximate opacity unavoidably requires very high computational
complexity. Therefore, for systems whose state-spaces are very large or even inÔ¨Ånite, it is desirable to construct
abstract models that preserve opacity, to some extent, for the propose of veriÔ¨Åcation. To this end, for each
type of approximate opacity, we propose the concept of Œµ-approximate opacity preserving simulation relation.
The proposed simulation relations characterize how close two systems are, speciÔ¨Åed by parameter Œµ ‚â• 0, in
terms of the satisfaction of approximate opacity. More speciÔ¨Åcally, we show that if there is an Œµ-approximate
opacity preserving simulation relation from system Sa to system Sb, then Sb being Œ¥-approximate opaque
implies that Sa is (Œ¥ + 2Œµ)-approximate opaque. In particular, for a class of incrementally input-to-state stable
discrete-time control systems with possibly inÔ¨Ånite state-spaces, we propose an eÔ¨Äective approach to construct
symbolic models (a.k.a. Ô¨Ånite abstractions) that approximately simulate the original systems in the sense of
opacity preserving and vice versa. The resulting symbolic model is Ô¨Ånite if the state-space of the original
continuous system is within a bounded region. Therefore, the proposed abstraction technique together with
the veriÔ¨Åcation algorithm for the Ô¨Ånite case provide a sound way for verifying opacity of discrete-time control
systems with continuous state-spaces.

ON APPROXIMATE OPACITY OF CYBER-PHYSICAL SYSTEMS

3

1.3. Related Works. Our work is closely related to several works in the literature. First, several diÔ¨Äerent ap-
proaches have been proposed in the literature to evaluate opacity more quantitatively rather than requiring that
the system is opaque exactly [SH14, BMS15, CIK17, YLWL19]. For example, in [CIK17], the authors adopt
the Jensen-Shannon divergence as the measurement to quantify secrecy loss. In [SH14, BMS15, YLWL19], sto-
chastic DES models are used to study the probabilistic measurement of opacity. These approaches essentially
aim to analyze how opaque a single system is, e.g., the probability of being opaque. However, they neither
consider how close two systems are in terms of being opaque nor consider under what observation precision
level, we can guarantee opacity.

There are also attempts in the literature that extend opacity from discrete systems to continuous systems.
For example, in the recent results in [RCM16b, RCM16a, RCM17], the authors extended the notion of opacity
to (switched) linear systems. However, their deÔ¨Ånition of opacity is more related to an output reachability
property rather than an information-Ô¨Çow property. Moreover, their formulation is mostly based on the setting
of exact opacity, i.e., we can always distinguish two diÔ¨Äerent outputs precisely no matter how close they
are, In [RCM16b], the authors mentioned the direction of using output metric to quantify opacity and a
property called strong (cid:15)-K-initial-state opacity was proposed, which is closely related to our notions. However,
no systematic study, e.g., veriÔ¨Åcation and abstraction as we consider in this paper, was provided for this
property.

Regarding the techniques used in this paper, Ô¨Årst, our algorithms for the veriÔ¨Åcation of approximate notions of
opacity are motivated by the veriÔ¨Åcation algorithms for exact opacity studied in [SH11, YL17]. In particular, we
use the idea of constructing a new system, called the state-estimator, that tracks all possible states consistent
with the observation. However, our construction of state-estimator is not exactly the same as the existing one
as additional state information is needed in order to handle the issue of approximation.

Abstraction-based techniques have also been investigated in the literature for the veriÔ¨Åcation and synthesis of
opacity; see, e.g., [ZYZ18, NHLH18a, NHLH18b, WL18, MJL18]. In particular, in our recent work [ZYZ18], we
propose several notions of opacity preserving (bi)simulation relations. However, these relations only preserve
exact opacity for non-metric systems. Our new relations extend the relations in [ZYZ18] to metric systems by
taking into account how close two systems are. Such an extension is motivated by the deÔ¨Ånition of approx-
imate (bi)simulation relation originally proposed in [GP07]. However, the original deÔ¨Ånition of approximate
(bi)simulation relation does not necessarily preserves approximate opacity. Constructing symbolic models for
control systems is also an active research area; see, e.g., [GPT10, Rei11, ZPMT12, ZAG15]. However, most of
the existing works on the construction of symbolic models only consider the dynamics of the systems and are
not taking into account the opacity property. In our approach, we need to consider both the dynamic and the
secret of the system while constructing the symbolic model and guarantee the preservation of approximate
opacity across related systems.

Finally, approximate notions of two related properties called diagnosability and predictability are investigated
recently in [PDSDB18, FDSPDB18]. Their setting is very similar to us as we both consider a measurement
uncertainty threshold. However, diagnosability and predictability are language-based properties, which can be
preserved by standard approximate simulation relation. Our notions of opacity are state-based and we show
that standard approximate simulation relation does not preserve opacity. Therefore, the proposed approximate
opacity preserving simulation relation is diÔ¨Äerent from the standard approximate simulation relation in the
literature.

In Section 2, we Ô¨Årst introduce some
1.4. Organization. The rest of this paper is organized as follows.
necessary preliminaries. Then we propose the concept of approximate opacity in Section 3. The veriÔ¨Åcation
procedures for approximate opacity are provided in Section 4. In Section 5, approximate opacity preserving
simulation relations are proposed and their properties are also discussed.
In Section 6, we describe how
to construct approximate opacity preserving symbolic models for incrementally stable discrete-time control
systems with continuous state-spaces. Finally, we conclude the paper by Section 7. Preliminary and partial
version of this paper is presented as an extended abstract in [YZ19].

4

X. YIN AND M. ZAMANI

2. Preliminaries

2.1. Notation. The symbols N, N0, Z, R, R+, and R+
0 denote the set of natural, nonnegative integer, integer,
real, positive, and nonnegative real numbers, respectively. Given a vector x ‚àà Rn, we denote by xi the i‚Äìth
element of x, and by (cid:107)x(cid:107) the inÔ¨Ånity norm of x.
The closed ball centered at u ‚àà Rm with radius Œª is deÔ¨Åned by BŒª(u) = {v ‚àà Rm | (cid:107)u ‚àí v(cid:107) ‚â§ Œª}. A set
B ‚äÜ Rm is called a box if B = (cid:81)m
i=1[ci, di], where ci, di ‚àà R with ci < di for each i ‚àà {1, . . . , m}. The span
of a box B is deÔ¨Åned as span(B) = min{|di ‚àí ci| | i = 1, . . . , m}. For a box B ‚äÜ Rm and ¬µ ‚â§ span(B),
deÔ¨Åne the ¬µ-approximation [B]¬µ = [Rm]¬µ ‚à© B, where [Rm]¬µ = {a ‚àà Rm | ai = ki¬µ, ki ‚àà Z, i = 1, . . . , m}.
Remark that [B]¬µ (cid:54)= ‚àÖ for any ¬µ ‚â§ span(B). Geometrically, for any ¬µ ‚àà R+ with ¬µ ‚â§ span(B) and Œª ‚â• ¬µ,
the collection of sets {BŒª(p)}p‚àà[B]¬µ is a Ô¨Ånite covering of B, i.e. B ‚äÜ (cid:83)
BŒª(p). We extend the notions of
p‚àà[B]¬µ
span and approximation to Ô¨Ånite unions of boxes as follows. Let A = (cid:83)M
j=1 Aj, where each Aj is a box. DeÔ¨Åne
span(A) = min{span(Aj) | j = 1, . . . , M }, and for any ¬µ ‚â§ span(A), deÔ¨Åne [A]¬µ = (cid:83)M
j=1[Aj]¬µ.
Given a function f : N+
0 ‚Üí Rn, the (essential) supremum of f is denoted by (cid:107)f (cid:107)‚àû := (ess)sup{(cid:107)f (k)(cid:107), k ‚â• 0}.
A continuous function Œ≥ : R+
0 is said to belong to class K if it is strictly increasing and Œ≥(0) = 0; Œ≥ is
said to belong to class K‚àû if Œ≥ ‚àà K and Œ≥(r) ‚Üí ‚àû as r ‚Üí ‚àû. A continuous function Œ≤ : R+
0 is
said to belong to class KL if, for each Ô¨Åxed s, the map Œ≤(r, s) belongs to class K with respect to r and, for
each Ô¨Åxed nonzero r, the map Œ≤(r, s) is decreasing with respect to s and Œ≤(r, s) ‚Üí 0 as s ‚Üí ‚àû. We identify a
relation R ‚äÜ A √ó B with the map R : A ‚Üí 2B deÔ¨Åned by b ‚àà R(a) iÔ¨Ä (a, b) ‚àà R. Given a relation R ‚äÜ A √ó B,
R‚àí1 denotes the inverse relation deÔ¨Åned by R‚àí1 = {(b, a) ‚àà B √ó A : (a, b) ‚àà R}.

0 ‚Üí R+

0 ‚Üí R+

0 √ó R+

2.2. System Model. In this paper, we employ a notion of ‚Äúsystem‚Äù introduced in [Tab09] as the underlying
model of CPS describing both continuous-space and Ô¨Ånite control systems.

DeÔ¨Ånition 2.1. A system S is a tuple

where

S = (X, X0, U, (cid:45) , Y, H),

(2.1)

‚Ä¢ X is a (possibly inÔ¨Ånite) set of states;
‚Ä¢ X0 ‚äÜ X is a (possibly inÔ¨Ånite) set of initial states;
‚Ä¢ U is a (possibly inÔ¨Ånite) set of inputs;
‚Ä¢ (cid:45) ‚äÜ X √ó U √ó X is a transition relation;
‚Ä¢ Y is a set of outputs;
‚Ä¢ H : X ‚Üí Y is an output map.

A transition (x, u, x(cid:48)) ‚àà (cid:45) is also denoted by x
u(cid:45) x(cid:48), state x(cid:48) is called a
u-successor, or simply a successor, of state x; state x is called a u-predecessor, or simply a predecessor, of state
x(cid:48). We denote by Postu(x) the set of all u-successors of state x and by Preu(x) the set of all u-predecessors
of state x. For a set of states q ‚àà 2X , we deÔ¨Åne Postu(q) = ‚à™x‚ààqPostu(x) and Preu(q) = ‚à™x‚ààqPreu(x). A
system S is said to be

u(cid:45) x(cid:48). For a transition x

‚Ä¢ metric, if the output set Y is equipped with a metric d : Y √ó Y ‚Üí R+
0 ;
‚Ä¢ Ô¨Ånite (or symbolic), if X and U are Ô¨Ånite sets;
‚Ä¢ deterministic, if for any state x ‚àà X and any input u ‚àà U , |Postu(x)| ‚â§ 1 and nondeterministic

otherwise.

Given a system S = (X, X0, U, (cid:45) , Y, H) and any initial state x0 ‚àà X0, a Ô¨Ånite state run generated from
x0 is a Ô¨Ånite sequence of transitions:

x0

u1(cid:45) x1

u2(cid:45) ¬∑ ¬∑ ¬∑

un‚àí1(cid:45) xn‚àí1

un(cid:45) xn,

(2.2)

ON APPROXIMATE OPACITY OF CYBER-PHYSICAL SYSTEMS

5

ui+1(cid:45) xi+1 for all 0 ‚â§ i < n. A Ô¨Ånite state run can be readily extended to an inÔ¨Ånite state run
such that xi
as well. A Ô¨Ånite output run is a sequence y0y1 . . . yn such that there exists a Ô¨Ånite state run of the form (2.2)
with yi = H(xi), for i = 0, . . . , n. A Ô¨Ånite output run can also be directly extended to an inÔ¨Ånite output run
as well.

3. Exact and Approximate Opacity

In this section, we Ô¨Årst review the notion of exact opacity. Then we introduce the notion of approximate
opacity.

3.1. Exact Opacity. In many applications, systems may have some ‚Äúsecrets‚Äù that do not want to be revealed
to intruders that are potentially malicious.
In this paper, we adopt a state-based formulation of secrets.
SpeciÔ¨Åcally, we assume that XS ‚äÜ X is a set of secret states. Hereafter, we will always consider systems
with secret states and we write a system S = (X, X0, U, (cid:45) , Y, H) with secret states XS by a new tuple
S = (X, X0, XS, U, (cid:45) , Y, H).
In order to characterize whether or not a system is secure, the concept of opacity was proposed in the literature.
We review three basic notions of opacity [WL13] as follows.
DeÔ¨Ånition 3.1. Consider a system S = (X, X0, XS, U, (cid:45) , Y, H). System S is said to be

‚Ä¢ initial-state opaque if for any x0 ‚àà X0 ‚à© XS and Ô¨Ånite state run x0
u(cid:48)
n(cid:45) x(cid:48)

0 ‚àà X0 \ XS and a Ô¨Ånite state run x(cid:48)
0

u(cid:48)
2(cid:45) ¬∑ ¬∑ ¬∑

u(cid:48)
1(cid:45) x(cid:48)

1

there exist x(cid:48)
for any i = 0, 1, . . . , n;

un(cid:45) xn,
u2(cid:45) ¬∑ ¬∑ ¬∑
u1(cid:45) x1
n such that H(xi) = H(x(cid:48)
i)

‚Ä¢ current-state opaque if for any x0 ‚àà X0 and Ô¨Ånite state run x0
u(cid:48)
2(cid:45) ¬∑ ¬∑ ¬∑

0 ‚àà X0 and Ô¨Ånite state run x(cid:48)
0

u(cid:48)
1(cid:45) x(cid:48)

1

i) for any i = 0, 1, . . . , n;
‚Ä¢ inÔ¨Ånite-step opaque if for any x0 ‚àà X0 and Ô¨Ånite state run x0

xn ‚àà XS, there exist x(cid:48)
and H(xi) = H(x(cid:48)

xk ‚àà XS for some k = 0, . . . n, there exist x(cid:48)
such that x(cid:48)

k ‚àà X \ XS and H(xi) = H(x(cid:48)

i) for any i = 0, 1, . . . , n.

u1(cid:45) x1
0 ‚àà X0 and Ô¨Ånite state run x(cid:48)
0

u2(cid:45) ¬∑ ¬∑ ¬∑
u(cid:48)
1(cid:45) x(cid:48)

1

un(cid:45) xn such that
u(cid:48)
u(cid:48)
n(cid:45) x(cid:48)
2(cid:45) ¬∑ ¬∑ ¬∑

n

u1(cid:45) x1
u(cid:48)
n(cid:45) x(cid:48)

u2(cid:45) ¬∑ ¬∑ ¬∑
n such that x(cid:48)

un(cid:45) xn such that
n ‚àà X \XS

The intuitions of the above deÔ¨Ånitions are as follows. Suppose that the output run of the system can be
observed by a passive intruder that may use this information to infer the secret of the system. Then initial-
state opacity requires that the intruder should never know for sure that the system is initiated from a secret
state no matter what output run is generated. Similarly, current-state opacity says that the intruder should
never know for sure that the system is currently at a secret state no matter what output run is generated.
InÔ¨Ånite-step opacity is stronger than both initial-state opacity and current-state opacity as it requires that the
intruder should never know that the system is/was at a secret state for any speciÔ¨Åc instant k. For any system
S = (X, X0, XS, U, (cid:45) , Y, H), we assume without loss of generality that ‚àÄx0 ‚àà X0 : {x ‚àà X0 : H(x) =
H(x0)} (cid:54)‚äÜ XS. This assumption essentially requires that the secret of the system cannot be revealed initially;
otherwise, the system is not opaque trivially.

Remark 3.2. DeÔ¨Ånition 3.1 implicitly assumes that the intruder only has the output information of the
system. In other words, the input information is assumed to be internal and intruder does not know which
input the system takes. This setting can be easily relaxed and all results in this paper can be extended to the
case where both input and output information are available by the intruder. For example, we can simply reÔ¨Åne
the model of the system such that the output space of the reÔ¨Åned system is a pair and the input leading to a
state is also encoded in the output of this state.

6

X. YIN AND M. ZAMANI

3.2. Approximate Opacity. Note that DeÔ¨Ånition 3.1 requires that for any secret behavior, there exists a
non-secret behavior such that they generate exactly the same output. Therefore, we will also refer to these
deÔ¨Ånitions as exact opacity. Exact opacity essentially assumes that the intruder or the observer can always
measure each output or distinguish between two diÔ¨Äerent outputs precisely. This setting is reasonable for
non-metric systems where outputs are symbols or events. However, for metric systems, e.g., when the outputs
are physical signals, this setting may be too restrictive.
In particular, due to the imperfect measurement
precision, which is almost the case for all physical systems, it is very diÔ¨Écult to distinguish two observations
if their diÔ¨Äerence is very small. Therefore, exact opacity may be too strong for metric systems and it will be
useful to deÔ¨Åne a weak and ‚Äúrobust‚Äù version of opacity by characterizing under which measurement precision
the system is opaque. To this end, we deÔ¨Åne new notions of opacity called approximate opacity for metric
systems.
DeÔ¨Ånition 3.3. Let S = (X, X0, XS, U, (cid:45) , Y, H) be a metric system, with the metric d deÔ¨Åned over the
output set, and a constant Œ¥ ‚â• 0. System S is said to be

un(cid:45) xn, there exist x(cid:48)

‚Ä¢ Œ¥-approximate initial-state opaque if for any x0 ‚àà X0‚à©XS and Ô¨Ånite state run x0
0 ‚àà X0 \ XS and a Ô¨Ånite state run x(cid:48)
0
i)) ‚â§ Œ¥

d(H(xi), H(x(cid:48)

u(cid:48)
2(cid:45) ¬∑ ¬∑ ¬∑

u(cid:48)
1(cid:45) x(cid:48)

1

u(cid:48)
n(cid:45) x(cid:48)

max
i‚àà{0,...,n}

u2(cid:45) ¬∑ ¬∑ ¬∑

u1(cid:45) x1
n such that

‚Ä¢ Œ¥-approximate current-state opaque if for any x0 ‚àà X0 and Ô¨Ånite state run x0
u1(cid:45) x(cid:48)

0 ‚àà X0 and Ô¨Ånite state run x(cid:48)
0

un(cid:45) xn such that xn ‚àà XS, there exist x(cid:48)
such that x(cid:48)

n ‚àà X \ XS and

1

max
i‚àà{0,...,n}

d(H(xi), H(x(cid:48)

i)) ‚â§ Œ¥

u1(cid:45) x1
u(cid:48)
2(cid:45) ¬∑ ¬∑ ¬∑

u2(cid:45) ¬∑ ¬∑ ¬∑
u(cid:48)
n(cid:45) x(cid:48)

n

‚Ä¢ Œ¥-approximate inÔ¨Ånite-step opaque if for any x0 ‚àà X0 and Ô¨Ånite state run x0

x(cid:48)
0

u1(cid:45) x(cid:48)

un(cid:45) xn such that xk ‚àà XS for some k = 0, . . . n, there exist x(cid:48)
n such that x(cid:48)
max
i‚àà{0,...,n}

k ‚àà X \ XS and

d(H(xi), H(x(cid:48)

u(cid:48)
2(cid:45) ¬∑ ¬∑ ¬∑

u(cid:48)
n(cid:45) x(cid:48)

i)) ‚â§ Œ¥.

1

u2(cid:45) ¬∑ ¬∑ ¬∑
u1(cid:45) x1
0 ‚àà X0 and Ô¨Ånite state run

The notions of Œ¥-approximate initial-state, current-state opacity and inÔ¨Ånite-step opacity are very similar
to their exact counterparts. The main diÔ¨Äerence is how we treat two outputs as indistinguishable outputs.
Intuitively, the approximate version of opacity can be interpreted as ‚Äúthe secret of the system cannot be revealed
to an intruder that does not have an enough measurement precision related to parameter Œ¥‚Äù. In other words,
instead of providing an exact security guarantee, approximate opacity provides a relaxed and quantitative
security guarantee with respect to the measurement precision of the intruder. Clearly, when Œ¥ = 0, each
notion of Œ¥-approximate opacity reduces to its exact version. Similar to the exact case, hereafter, we assume
without loss of generality that

‚àÄx0 ‚àà X0 : {x ‚àà X0 : d(H(x0), H(x)) ‚â§ Œ¥} (cid:54)‚äÜ XS,
for any system S = (X, X0, XS, U, (cid:45) , Y, H). This assumption can be easily checked and its non-satisfaction
means that Œ¥-approximate initial-state opacity, Œ¥-approximate current-state opacity and Œ¥-approximate inÔ¨Ånite-
step opacity are all violated trivially.

We illustrate exact opacity and approximate opacity by the following example.
Example 3.4. Consider system S = (X, X0, XS, U, (cid:45) , Y, H) depicted in Figure 1, where X = {A, B, C, D},
X0 = {A, B}, XS = {B}, U = {u}, H = {0.1, 0.15, 0.2, 0.35} ‚äÜ R and the output map is speciÔ¨Åed by the value
associated to each state. Clearly, none of exact initial-state opacity, exact current-state opacity and exact
inÔ¨Ånite-step opacity is satisÔ¨Åed since we know immediately that the system is at secret state B when value 0.1
is observed.

ON APPROXIMATE OPACITY OF CYBER-PHYSICAL SYSTEMS

7

Figure 1. An example for approximate opacity, where states marked by red denote secret
states, states marked by input arrows denote initial states and the output map is speciÔ¨Åed by
the value associated to each state.

Now, let us assume that the output set Y is equipped with metric d deÔ¨Åned by d(y1, y2) = |y1 ‚àí y2|. We claim
u(cid:45) B
that S is not 0.05-approximate current-state opaque. For example, let us consider Ô¨Ånite run B
that generates output run [0.1][0.35][0.1]. However, there does not exists a Ô¨Ånite run leading to a non-secret
state whose output run is 0.05-close to the above output run. To see this, in order to match the above output
run, we must consider a run starting from state B, since for the initial state A, we have d(H(A), H(B)) =
0.1 ‚â• 0.05, and the next state reached can only be D. From state D, we can reach states A and B, but
d(H(A), 0.1) = 0.1 ‚â• 0.05 =: Œ¥. Therefore, the only Ô¨Ånite run that approximately matches the above output
will end up with secret state B, i.e., we know unambiguously that the system is currently at a secret state
even when we cannot measure the output precisely. On the other hand, one can check that the system is
0.1-approximate current-state opaque.

u(cid:45) D

Similarly, system S is not 0.1-approximate initial-state opaque, since for output run [0.1][0.35] starting from
the secret state B, there is no run starting from a non-secret initial state that can approximately match it.
One can also check that the system is Œ¥-approximate initial-state opaque only when Œ¥ ‚â• 0.15. We will provide
formal procedures for verifying approximate opacity later.
Remark 3.5. Let S = (X, X0, XS, U, (cid:45) , Y, H) be a metric system. If the output map H is identity, i.e.
H(x) = x, ‚àÄx ‚àà X, then S is trivially not exactly opaque as in DeÔ¨Ånition 3.1 since we know the exact state of
the system directly. However, this is not the case for the approximate notions of opacity as in DeÔ¨Ånition 3.3
since the distance between a secret state and a non-secret state can be very small even if their values are not
exactly the same.

4. Verification of Approximate Opacity for Finite Systems

In this section, we show how to verify approximate opacity for Ô¨Ånite systems. This will also provide the basis
for the veriÔ¨Åcation of approximate opacity for inÔ¨Ånite systems.

4.1. VeriÔ¨Åcation of Approximate Initial-State Opacity. In order to verify Œ¥-approximate initial-state
opacity, we construct a new system called the Œ¥-approximate initial-state estimator deÔ¨Åned as follows.
DeÔ¨Ånition 4.1. Let S = (X, X0, XS, U, (cid:45) , Y, H) be a metric system, with the metric d deÔ¨Åned over the
output set, and a constant Œ¥ ‚â• 0. The Œ¥-approximate initial-state estimator is a system (without outputs)

where

SI = (XI , XI0, U,

(cid:45) ),

I

‚Ä¢ XI ‚äÜ X √ó 2X is the set of states;
‚Ä¢ XI0 = {(x, q) ‚àà X √ó 2X : x(cid:48) ‚àà q ‚áî d(H(x), H(x(cid:48))) ‚â§ Œ¥} is the set of initial states;
‚Ä¢ U is the set of inputs, which is the same as the one in S;

ABCDùë¢ùë¢ùë¢ùë¢ùë¢ùë¢[0.2][0.15][0.1][0.35]ùë¢(ùê∂,{ùêµ,ùê∂})(ùê¥,{ùê¥,ùêµ,ùê∂})(ùêµ,{ùêµ,ùê∂})(ùê∂,{ùê¥,ùêµ,ùê∂})(ùê¥,{ùê¥})(ùê∂,{ùê¥,ùêµ,ùê∂})(ùê¥,{ùê¥,ùêµ,ùê∂,ùê∑})(ùêµ,{ùê¥,ùêµ,ùê∂})(ùê∑,{ùê¥,ùê∑})(ùê¥,{ùê¥,ùê∑})ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢(ùêµ,{ùê¥,ùêµ,ùê∂})(ùê∑,{ùê∑})ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢8

‚Ä¢

(cid:45) ‚äÜ XI √ó U √ó XI is the transition function deÔ¨Åned by: for any (x, q), (x(cid:48), q(cid:48)) ‚àà X √ó 2X and

I

X. YIN AND M. ZAMANI

u

(cid:45) (x(cid:48), q(cid:48)) if
u ‚àà U , (x, q)
(1) (x(cid:48), u, x) ‚àà (cid:45) ; and
(2) q(cid:48) = ‚à™ÀÜu‚ààU PreÀÜu(q) ‚à© {x(cid:48)(cid:48) ‚àà X : d(H(x(cid:48)), H(x(cid:48)(cid:48))) ‚â§ Œ¥}.

I

For the sake of simplicity, we only consider the part of SI that is reachable from initial states.

Intuitively, the Œ¥-approximate initial-state estimator works as follows. Each initial state of SI is a pair
consisting of a system state and its Œ¥-closed states; we consider all each pairs as the set of initial states.
Then from each state, we track backwards states that are consistent with the output information recursively.
Our construction is motivated by the reversed-automaton-based initial-state-estimator proposed in [WL13]
but with the following diÔ¨Äerences. First, the way we deÔ¨Åned information-consistency is diÔ¨Äerent. Here we
treat states whose output are Œ¥-close to each other as consistent states. Moreover, the structure in [WL13]
only requires a state space of 2X , while our state space is X √ó 2X . The additional Ô¨Årst component can be
understood as the ‚Äúreference trajectory‚Äù that is used to determine what is ‚ÄúŒ¥-close‚Äù at each instant. We use
the following result to show the main property of SI .

Proposition 4.2. Let S = (X, X0, XS, U,
output set, and a constant Œ¥ ‚â• 0. Let SI = (XI , XI0, U,
Then for any (x0, q0) ‚àà XI0 and any Ô¨Ånite run

I

I

(cid:45) , Y, H) be a metric system, with the metric d deÔ¨Åned over the
(cid:45) ) be its Œ¥-approximate initial-state estimator.

(x0, q0)

u1

(cid:45) (x1, q1)

I

(cid:45) ¬∑ ¬∑ ¬∑
u2

I

un

(cid:45) (xn, qn)

I

we have

(i) xn

(ii) qn =

un(cid:45) xn‚àí1
(cid:26)
0 ‚àà X : ‚àÉx(cid:48)
x(cid:48)
0

un‚àí1(cid:45) ¬∑ ¬∑ ¬∑
u(cid:48)
n(cid:45) x(cid:48)

1

u1(cid:45) x0; and
u(cid:48)
n‚àí1(cid:45) ¬∑ ¬∑ ¬∑

Proof. See the Appendix.

u(cid:48)
1(cid:45) x(cid:48)

n s.t. maxi‚àà{0,1,...,n} d(H(xi), H(x(cid:48)

n‚àíi)) ‚â§ Œ¥

(cid:27)

.

(cid:3)

The next theorem provides one of the main results of this section on the veriÔ¨Åcation of Œ¥-approximate initial-
state opacity of Ô¨Ånite metric systems.

Theorem 4.3. Let S = (X, X0, XS, U,
the output set, and a constant Œ¥ ‚â• 0. Let SI = (XI , XI0, U,
Then, S is Œ¥-approximate initial-state opaque if and only if

I

I

(cid:45) , Y, H) be a Ô¨Ånite metric system, with the metric d deÔ¨Åned over
(cid:45) ) be its Œ¥-approximate initial-state estimator.

Proof. See the Appendix.

‚àÄ(x, q) ‚àà XI : x ‚àà X0 ‚à© XS ‚áí q ‚à© X0 (cid:54)‚äÜ XS.

(4.1)

(cid:3)

We illustrate how to verify Œ¥-approximate initial-state opacity by the following example.

Example 4.4. Let us still consider system S shown in Figure 1. The Œ¥-approximate initial-state estimator SI
when Œ¥ = 0.1 is shown in Figure 2(a). For example, for initial state (D, {D}), we have (D, {D})

(cid:45) (B, {B, C})

u

I

u(cid:45) D and {B, C} = Preu({D}) ‚à© {x ‚àà X : d(H(x), 0.1) ‚â§ 0.1} = {B, C} ‚à© {A, B, C}. However,
since B
for state (B, {B, C}) ‚àà XI , we have B ‚àà X0 ‚à© XS and {B, C} ‚à© X0 = {B} ‚äÜ XS. Therefore, by Theorem 4.3,
we know that the system is not 0.1-approximate initial-state opaque. Similarly, we can also construct SI for
the case of Œ¥ = 0.15, which is shown in Figure 2(b). Since for state (B, {A, B, C}) ‚àà XI , which is the only
state whose Ô¨Årst component is in X0 ‚à© XS, we have {A, B, C} ‚à© X0 = {A, B} (cid:54)‚äÜ XS. By Theorem 4.3, we
know that the system is 0.15-approximate initial-state opaque.

ON APPROXIMATE OPACITY OF CYBER-PHYSICAL SYSTEMS

9

(a) SI when Œ¥ = 0.1

(b) SI when Œ¥ = 0.15

Figure 2. Examples of Œ¥-approximate initial-state estimators.

4.2. VeriÔ¨Åcation of Approximate Current-State Opacity. In order to verify Œ¥-approximate current-
state opacity, we also need to construct a new system called the Œ¥-approximate current-state estimator deÔ¨Åned
as follows.
DeÔ¨Ånition 4.5. Let S = (X, X0, XS, U, (cid:45) , Y, H) be a metric system, with the metric d deÔ¨Åned over the
output set, and a constant Œ¥ ‚â• 0. The Œ¥-approximate current-state estimator is a system (without outputs)

where

SC = (XC, XC0, U,

(cid:45) ),

C

‚Ä¢ XC ‚äÜ X √ó 2X is the set of states;
‚Ä¢ XC0 = {(x, q) ‚àà X0 √ó2X0 : x(cid:48) ‚àà q ‚áî d(H(x), H(x(cid:48))) ‚â§ Œ¥} is the set of initial states;
‚Ä¢ U is the set of inputs, which is the same as the one in S;
‚Ä¢

(cid:45) ‚äÜ XC √ó U √ó XC is the transition function deÔ¨Åned by: for any (x, q), (x(cid:48), q(cid:48)) ‚àà X √ó 2X and

C

u

(cid:45) (x(cid:48), q(cid:48)) if
u ‚àà U , (x, q)
(1) (x, u, x(cid:48)) ‚àà (cid:45) ; and
(2) q(cid:48) = ‚à™ÀÜu‚ààU PostÀÜu(x) ‚à© {x(cid:48)(cid:48) ‚àà X : d(H(x(cid:48)), H(x(cid:48)(cid:48))) ‚â§ Œ¥}.

C

For the sake of simplicity, we only consider the part of SC that is reachable from initial states.

The construction of SC is similar to SI . However, we need to track all forward runs from each pair of initial-
state and its information-consistent states. Still, we need the Ô¨Årst component as the ‚Äúreference state‚Äù to
determine what are ‚ÄúŒ¥-close‚Äù states. We use the following result to state the main properties of SC.
Proposition 4.6. Let S = (X, X0, XS, U, (cid:45) , Y, H) be a metric system, with the metric d deÔ¨Åned over the
(cid:45) ) be its Œ¥-approximate current-state estimator.
output set, and a constant Œ¥ ‚â• 0. Let SC = (XC, XC0, U,
Then for any (x0, q0) ‚àà XC0 and any Ô¨Ånite run

C

we have

(x0, q0)

u1

(cid:45) (x1, q1)

C

(cid:45) ¬∑ ¬∑ ¬∑
u2

C

un

(cid:45) (xn, qn),

C

u1(cid:45) x1

u2(cid:45) ¬∑ ¬∑ ¬∑

(i) x0
(ii) qn = {x(cid:48)

n ‚àà X : ‚àÉx(cid:48)

0 ‚àà X0, ‚àÉx(cid:48)
0

un(cid:45) xn; and
u(cid:48)
1(cid:45) x(cid:48)

1

u(cid:48)
2(cid:45) ¬∑ ¬∑ ¬∑

u(cid:48)
n(cid:45) x(cid:48)

n s.t. maxi‚àà{0,1,...,n} d(H(xi), H(x(cid:48)

i)) ‚â§ Œ¥}.

Proof. See the Appendix.

(cid:3)

Now, we show the second main result of this section by providing a veriÔ¨Åcation scheme for Œ¥-approximate
current-state opacity of Ô¨Ånite metric systems.

ABCDùë¢ùë¢ùë¢ùë¢ùë¢ùë¢[0.2][0.15][0.1][0.35]ùë¢(ùê∂,{ùêµ,ùê∂})(ùê¥,{ùê¥,ùêµ,ùê∂})(ùêµ,{ùêµ,ùê∂})(ùê∂,{ùê¥,ùêµ,ùê∂})(ùê¥,{ùê¥})(ùê∂,{ùê¥,ùêµ,ùê∂})(ùê¥,{ùê¥,ùêµ,ùê∂,ùê∑})(ùêµ,{ùê¥,ùêµ,ùê∂})(ùê∑,{ùê¥,ùê∑})(ùê¥,{ùê¥,ùê∑})ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢(ùê∑,{ùê∑})ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢ABCDEFGI[2.8][3.1][1.4][1.4][1.5][1.5][1.3][1.6]JKNM[2.9][3.0][1.4][1.5]ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢(ùêµ,{ùê¥,ùêµ,ùê∂})ABCDùë¢ùë¢ùë¢ùë¢ùë¢ùë¢[0.2][0.15][0.1][0.35]ùë¢(ùê∂,{ùêµ,ùê∂})(ùê¥,{ùê¥,ùêµ,ùê∂})(ùêµ,{ùêµ,ùê∂})(ùê∂,{ùê¥,ùêµ,ùê∂})(ùê¥,{ùê¥})(ùê∂,{ùê¥,ùêµ,ùê∂})(ùê¥,{ùê¥,ùêµ,ùê∂,ùê∑})(ùêµ,{ùê¥,ùêµ,ùê∂})(ùê∑,{ùê¥,ùê∑})(ùê¥,{ùê¥,ùê∑})ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢(ùê∑,{ùê∑})ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢ABCDEFGI[2.8][3.1][1.4][1.4][1.5][1.5][1.3][1.6]JKNM[2.9][3.0][1.4][1.5]ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢(ùêµ,{ùê¥,ùêµ,ùê∂})10

X. YIN AND M. ZAMANI

Theorem 4.7. Let S = (X, X0, XS, U, (cid:45) , Y, H) be a metric system, with the metric d deÔ¨Åned over the
(cid:45) ) be its Œ¥-approximate current-state estimator.
output set, and a constant Œ¥ ‚â• 0. Let SC = (XC, XC0, U,
C
Then, S is Œ¥-approximate current-state opaque if and only if

Proof. See the Appendix.

‚àÄ(x, q) ‚àà XC : q (cid:54)‚äÜ XS.

(4.2)

(cid:3)

4.3. VeriÔ¨Åcation of Approximate InÔ¨Ånite-Step Opacity. Finally, we can combine the Œ¥-approximate
initial-state estimator SI and the Œ¥-approximate current-state estimator SC to verify Œ¥-approximate inÔ¨Ånite-
step opacity of Ô¨Ånite metric systems. The veriÔ¨Åcation scheme is provided by the following theorem.
Theorem 4.8. Let S = (X, X0, XS, U, (cid:45) , Y, H) be a Ô¨Ånite metric system, with the metric d deÔ¨Åned
(cid:45) ) be
over the output set, and a constant Œ¥ ‚â• 0. Let SI = (XI , XI0, U,
its Œ¥-approximate initial-state estimator and Œ¥-approximate current-state estimator, respectively. Then, S is
Œ¥-approximate inÔ¨Ånite-step opaque if and only if

(cid:45) ) and SC = (XC, XC0, U,

C

I

Proof. See the Appendix.

‚àÄ(x, q) ‚àà XI , (x(cid:48), q(cid:48)) ‚àà XC : x = x(cid:48) ‚àà XS ‚áí q ‚à© q(cid:48) (cid:54)‚äÜ XS.

(4.3)

(cid:3)

Remark 4.9. We conclude this section by discussing the complexity of verifying approximate opacity. Let
S = (X, X0, XS, U, (cid:45) , Y, H) be a Ô¨Ånite metric system. The complexity of the veriÔ¨Åcation algorithms for
both approximate initial-state and current-state opacity is O(|U | √ó |X| √ó 2|X|), which is the size of SI or SC.
For approximate inÔ¨Ånite-step opacity, we need to construct both SI and SC, and compare each pair of states
in SI and SC. Therefore, the complexity for verifying approximate inÔ¨Ånite-step opacity using Theorem 4.8 is
O(|U | √ó |X|2 √ó 4|X|). It is worth noting that the complexity of verifying exact opacity as in DeÔ¨Ånition 3.1 is
already known to be PSPACE-complete [CDM12]. Therefore, we can conclude that the complexity of verifying
approximate opacity as in DeÔ¨Ånition 3.3 is also PSPACE-complete.

5. Approximate Simulation Relations for Opacity

In this section, we introduce new notions of approximate opacity preserving simulation relations, inspired by
the one in [GP07], which is crucial when analyzing opacity or synthesizing controllers enforcing opacity for
deterministic systems. The newly proposed simulation relations will also provide the basis for abstraction-
based veriÔ¨Åcation of approximate opacity.

5.1. Approximate Initial-State Opacity Preserving Simulation Relation. First, we introduce a new
notion of approximate initial-state opacity preserving simulation relation.

DeÔ¨Ånition 5.1. (Approximate Initial-State Opacity Preserving Simulation Relation) Consider two metric
(cid:45) , Yb, Hb) with the same
systems Sa = (Xa, Xa0, XaS, Ua,
output sets Ya = Yb and metric d. For Œµ ‚àà R+
0 , a relation R ‚äÜ Xa √ó Xb is called an Œµ-approximate initial-
state opacity preserving simulation relation (Œµ-InitSOP simulation relation) from Sa to Sb if

(cid:45) , Ya, Ha) and Sb = (Xb, Xb0, XbS, Ub,

a

b

(1) (a) ‚àÄxa0 ‚àà Xa0 ‚à© XaS, ‚àÉxb0 ‚àà Xb0 ‚à© XbS : (xa0, xb0) ‚àà R;
(b) ‚àÄxb0 ‚àà Xb0 \ XbS, ‚àÉxa0 ‚àà Xa0 \ XaS : (xa0, xb0) ‚àà R;

(2) ‚àÄ(xa, xb) ‚àà R : d(Ha(xa), Hb(xb)) ‚â§ Œµ;
(3) For any (xa, xb) ‚àà R, we have
(cid:45) x(cid:48)
(cid:45) x(cid:48)
ua
ub
a
b
(cid:45) x(cid:48)
(cid:45) x(cid:48)
ua
ub
b

b : (x(cid:48)
a : (x(cid:48)

a, x(cid:48)
a, x(cid:48)

(a) ‚àÄxa

(b) ‚àÄxb

b, ‚àÉxa

a, ‚àÉxb

a

b) ‚àà R;

b) ‚àà R.

ON APPROXIMATE OPACITY OF CYBER-PHYSICAL SYSTEMS

11

We say that Sa is Œµ-InitSOP simulated by Sb, denoted by Sa (cid:22)Œµ
relation R from Sa to Sb.

I Sb, if there exists an Œµ-InitSOP simulation

Note that although the above relation is similar to the approximate bisimulation relation proposed in [GP07],
it is still a one sided relation here because condition (1) is not symmetric. We refer the interested readers
to [ZYZ18] to see why one needs strong condition (3) in DeÔ¨Ånition 5.1 to show preservation of initial-state
opacity in one direction when Œµ = 0.

The following main theorem provides a suÔ¨Écient condition for Œ¥-approximate initial-state opacity based on
related systems as in DeÔ¨Ånition 5.1.

Theorem 5.2. Let Sa = (Xa, Xa0, XaS, Ua,
metric systems with the same output sets Ya = Yb and metric d and let Œµ, Œ¥ ‚àà R+
then the following implication hold:

(cid:45) , Ya, Ha) and Sb = (Xb, Xb0, XbS, Ub,

a

0 . If Sa (cid:22)Œµ

b

(cid:45) , Yb, Hb) be two
I Sb and Œµ ‚â§ Œ¥
2 ,

Sb is (Œ¥ ‚àí 2Œµ)-approximate initial-state opaque

‚áíSa is Œ¥-approximate initial-state opaque.

Proof. Consider an arbitrary secret initial state x0 ‚àà X0a ‚à© XSa and a run x0
Sa. Since Sa (cid:22)Œµ
0 ‚àà Xb0 ‚à© XbS and a run x(cid:48)
x(cid:48)
0

(cid:45) xn in
I Sb, by conditions (1)-(a), (2) and (3)-(a) in DeÔ¨Ånition 5.1, there exist a secret initial state

n in Sb such that

(cid:45) ¬∑ ¬∑ ¬∑
u2
a

(cid:45) x1

un
a

u1
a

1

u(cid:48)
(cid:45) x(cid:48)
1
b

u(cid:48)
(cid:45) ¬∑ ¬∑ ¬∑
2
b

u(cid:48)
(cid:45) x(cid:48)
n
b
‚àÄi ‚àà {0, 1, . . . , n} : d(Ha(xi), Hb(x(cid:48)

i)) ‚â§ Œµ.

(5.1)

Since Sb is (Œ¥ ‚àí 2Œµ)-approximate initial-state opaque, there exist a non-secret initial state x(cid:48)(cid:48)
a run x(cid:48)(cid:48)
0

n such that

u(cid:48)(cid:48)
(cid:45) x(cid:48)(cid:48)
1
b

1

u(cid:48)(cid:48)
(cid:45) ¬∑ ¬∑ ¬∑
2
b

u(cid:48)(cid:48)
(cid:45) x(cid:48)(cid:48)
n
b

0 ‚àà Xb0 \ XbS and

max
i‚àà{0,1,...,n}

d(Hb(x(cid:48)

i), Hb(x(cid:48)(cid:48)

i )) ‚â§ Œ¥ ‚àí 2Œµ.

(5.2)

Again, since Sa (cid:22)Œµ
0 ‚àà Xa0 \ XaS and a run x(cid:48)(cid:48)(cid:48)
x(cid:48)(cid:48)(cid:48)
0

I Sb, by conditions (1)-(b), (2) and (3)-(b) in DeÔ¨Ånition 5.1, there exist an initial state
n such that
i ), Hb(x(cid:48)(cid:48)

u(cid:48)(cid:48)(cid:48)
(cid:45) x(cid:48)(cid:48)(cid:48)
1
a
‚àÄi ‚àà {0, 1, . . . , n} : d(Ha(x(cid:48)(cid:48)(cid:48)

u(cid:48)(cid:48)(cid:48)
(cid:45) ¬∑ ¬∑ ¬∑
2
a

u(cid:48)(cid:48)(cid:48)
(cid:45) x(cid:48)(cid:48)(cid:48)
n
a

i )) ‚â§ Œµ.

(5.3)

1

Combining equations (5.1), (5.2), (5.3), and using the triangle inequality, we have

max
i‚àà{0,1,...,n}

: d(Ha(xi), Ha(x(cid:48)(cid:48)(cid:48)

i )) ‚â§ Œ¥.

(5.4)

Since x0 ‚àà Xa0 ‚à© XaS and x0
initial-state opaque.

(cid:45) x1

u1
a

(cid:45) ¬∑ ¬∑ ¬∑
u2
a

un
a

(cid:45) xn are arbitrary, we conclude that Sa is Œ¥-approximate
(cid:3)

The following corollary is a simple consequence of the result in Theorem 5.2 but for the lack of Œ¥-approximate
initial-state opacity.

Corollary 5.3. Let Sa = (Xa, Xa0, XaS, Ua,
two metric systems with the same output sets Ya = Yb and metric d and let Œµ, Œ¥ ‚àà R+
following implication hold:

(cid:45) , Ya, Ha) and Sb = (Xb, Xb0, XbS, Ub,

b
0 . If Sb (cid:22)Œµ

a

(cid:45) , Yb, Hb) be
I Sa, then the

Sb is not (Œ¥ + 2Œµ)-approximate initial-state opaque

‚áíSa is not Œ¥-approximate initial-state opaque.

Proof. Since Sb (cid:22)Œµ
I Sa, by Theorem 5.2, we know that Sa being Œ¥-approximate initial-state opaque implies
that Sb is (Œ¥ + 2Œµ)-approximate initial-state opaque. Hence, Sb not being (Œ¥ + 2Œµ)-approximate initial-state
(cid:3)
opaque implies that Sa is not Œ¥-approximate initial-state opaque.

12

X. YIN AND M. ZAMANI

(a) Sa

(b) Sb

Figure 3. Example of Œµ-approximate initial-state opacity preserving simulation relation.

Remark 5.4. It is worth remarking that Œ¥ and Œµ are parameters specifying two diÔ¨Äerent types of precision.
Parameter Œ¥ is used to specify the measurement precision under which we can guarantee opacity for a sin-
gle system, while parameter Œµ is used to characterize the ‚Äúdistance‚Äù between two systems in terms of being
approximate opaque. The reader should not be confused by the diÔ¨Äerent roles of these two parameters.

We illustrate Œ¥-approximate initial-state opacity and its property by the following example.

Example 5.5. Let us consider systems Sa and Sb shown in Figures 3(a) and 3(b), respectively. We mark all
secret states by red and the output map is speciÔ¨Åed by the value associated to each state. Let us consider the
following relation R = {(A, J), (B, K), (C, K), (D, K), (E, N ), (F, M ), (G, M ),
(I, M )}. We claim that R is an Œµ-approximate initial-state opacity preserving simulation relation from Sa
to Sb when Œµ = 0.1. We check item by item following DeÔ¨Ånition 3.1. First, for E ‚àà Xa0 ‚à© XaS, we have
N ‚àà Xb0‚à©XbS such that (E, N ) ‚àà R. Similarly, for J ‚àà Xb0\XbS, we have A ‚àà Xa0\XaS such that (A, J) ‚àà R.
Therefore, condition (a) in DeÔ¨Ånition 3.1 holds. Also, for any (xa, xb) ‚àà R, we have d(Ha(xa), Ha(xb)) ‚â§ 0.1,
e.g., d(Ha(A), Hb(J)) = 0.1 and d(Ha(C), Hb(K)) = 0. Therefore, condition (b) in DeÔ¨Ånition 3.1 holds.
Finally, we can also check that condition (c) in DeÔ¨Ånition 3.1 holds. For example, for (D, K) ‚àà R and
(cid:45) B, we can choose K
(cid:45) M , we can choose
(cid:45) K such that (B, K) ‚àà R; for (E, M ) ‚àà R and N
(cid:45) F such that (F, M ) ‚àà R. Therefore, we know that R is an Œµ-InitSOP simulation relation from Sa to

D

a
u

u

u

u

b

b

E
Sb, i.e., Sa (cid:22)Œµ

b

I Sb.

Then, by applying the veriÔ¨Åcation algorithm in Section 4, we can check that Sb is Œ¥-approximate initial-state
opaque for Œ¥ = 0.1. Therefore, according to Theorem 5.2, we conclude that Sa is 0.3-approximate initial-state
opaque, where 0.3 = Œ¥ + 2Œµ, without applying the veriÔ¨Åcation algorithm to Sa directly.

5.2. Approximate Current-State Opacity Preserving Simulation Relation. Now, we provide a notion
of approximate simulation relation for preserving current-state opacity.

(cid:45) , Ya, Ha) and Sb = (Xb, Xb0, XbS, Ub,

DeÔ¨Ånition 5.6. (Approximate Current-State Opacity Preserving Simulation Relation) Let Sa = (Xa, Xa0, XaS,
(cid:45) , Yb, Hb) be two metric systems with the same output sets
Ua,
Ya = Yb and metric d. For Œµ ‚àà R+
0 , a relation R ‚äÜ Xa √ó Xb is called an Œµ-approximate current-state opacity
preserving simulation relation (Œµ-CurSOP simulation relation) from Sa to Sb if

a

b

(1) ‚àÄxa0 ‚àà Xa0, ‚àÉxb0 ‚àà Xb0 : (xa0, xb0) ‚àà R;
(2) ‚àÄ(xa, xb) ‚àà R : d(Ha(xa), Hb(xb)) ‚â§ Œµ;
(3) For any (xa, xb) ‚àà R, we have
(cid:45) x(cid:48)
(cid:45) x(cid:48)
ua
ub
b : (x(cid:48)
a
b
(cid:45) x(cid:48)
(cid:45) x(cid:48)
ub
ua
b

a ‚àà XaS, ‚àÉxb

(a) ‚àÄxa

(b) ‚àÄxa

a, ‚àÉxb

a

a, x(cid:48)
b) ‚àà R;
b ‚àà XbS : (x(cid:48)

a, x(cid:48)

b) ‚àà R;

ABCDùë¢ùë¢ùë¢ùë¢ùë¢ùë¢[0.2][0.15][0.1][0.35]ùë¢(ùê∂,{ùêµ,ùê∂})(ùê¥,{ùê¥,ùêµ,ùê∂})(ùêµ,{ùêµ,ùê∂})(ùê∂,{ùê¥,ùêµ,ùê∂})(ùê¥,{ùê¥})(ùê∂,{ùê¥,ùêµ,ùê∂})(ùê¥,{ùê¥,ùêµ,ùê∂,ùê∑})(ùêµ,{ùê¥,ùêµ,ùê∂})(ùê∑,{ùê¥,ùê∑})(ùê¥,{ùê¥,ùê∑})ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢(ùê∑,{ùê∑})ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢ABCDEFGI[2.8][3.1][1.4][1.4][1.5][1.5][1.3][1.6]JKNM[2.9][3.0][1.4][1.5]ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢(ùêµ,{ùê¥,ùêµ,ùê∂})ABCDùë¢ùë¢ùë¢ùë¢ùë¢ùë¢[0.2][0.15][0.1][0.35]ùë¢(ùê∂,{ùêµ,ùê∂})(ùê¥,{ùê¥,ùêµ,ùê∂})(ùêµ,{ùêµ,ùê∂})(ùê∂,{ùê¥,ùêµ,ùê∂})(ùê¥,{ùê¥})(ùê∂,{ùê¥,ùêµ,ùê∂})(ùê¥,{ùê¥,ùêµ,ùê∂,ùê∑})(ùêµ,{ùê¥,ùêµ,ùê∂})(ùê∑,{ùê¥,ùê∑})(ùê¥,{ùê¥,ùê∑})ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢(ùê∑,{ùê∑})ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢ABCDEFGI[2.8][3.1][1.4][1.4][1.5][1.5][1.3][1.6]JKNM[2.9][3.0][1.4][1.5]ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢ùë¢(ùêµ,{ùê¥,ùêµ,ùê∂})ON APPROXIMATE OPACITY OF CYBER-PHYSICAL SYSTEMS

13

(c) ‚àÄxb

(d) ‚àÄxb

(cid:45) x(cid:48)
ub
b
(cid:45) x(cid:48)
ub
b

(cid:45) x(cid:48)
ua

a : (x(cid:48)

b, ‚àÉxa

a
b ‚àà Xb \ XbS, ‚àÉxa

a, x(cid:48)
b) ‚àà R.
(cid:45) x(cid:48)
ua

a

a ‚àà Xa \ XaS : (x(cid:48)

a, x(cid:48)

b) ‚àà R.

We say that Œ£a is Œµ-CurSOP simulated by Œ£b, denoted by Œ£a (cid:22)Œµ
relation R from Sa to Sb.

C Œ£b, if there exists an Œµ-CurSOP simulation

The following theorem provides a suÔ¨Écient condition for Œ¥-approximate current-state opacity based on related
systems as in DeÔ¨Ånition 5.6.

Theorem 5.7. Let Sa = (Xa, Xa0, XaS, Ua,
metric systems with the same output sets Ya = Yb and metric d and let Œµ, Œ¥ ‚àà R+
then the following implication hold:

(cid:45) , Ya, Ha) and Sb = (Xb, Xb0, XbS, Ub,

a

0 . If Sa (cid:22)Œµ

b

(cid:45) , Yb, Hb) be two
C Sb and Œµ ‚â§ Œ¥
2 ,

Sb is (Œ¥ ‚àí 2Œµ)-approximate current-state opaque

‚áíSa is Œ¥-approximate current-state opaque.

(cid:45) xn in
Proof. Let us consider an arbitrary initial state x0 ‚àà Xa0 and Ô¨Ånite run x0
Sa such that xn ‚àà XaS. We consider the following two cases: n = 0 and n (cid:54)= 0. If n = 0, we know that
x0 ‚àà XaS. Since we assume that {x ‚àà X0 : (Ha(x0), Ha(x)) ‚â§ Œ¥} (cid:54)‚äÜ XaS, we observe immediately that there
exists x(cid:48)
C Sb,
by conditions (1), (2), (3)-(a) and (3)-(b) in DeÔ¨Ånition 5.6, there exist an initial state x(cid:48)
0 ‚àà Xb0 and a Ô¨Ånite
run x(cid:48)
0

0 ‚àà Xa0 \ XaS such that d(Ha(x0), Ha(x)) ‚â§ Œ¥. Then, we consider the case of n ‚â• 1. Since Sa (cid:22)Œµ

n in Sb such that x(cid:48)

n ‚àà XbS and

(cid:45) ¬∑ ¬∑ ¬∑
u2
a

(cid:45) x1

un
a

u1
a

1

u(cid:48)
(cid:45) ¬∑ ¬∑ ¬∑
2
b

u(cid:48)
(cid:45) x(cid:48)
n
b

u(cid:48)
(cid:45) x(cid:48)
1
b

‚àÄi ‚àà {0, 1, . . . , n} : d(Ha(xi), Hb(x(cid:48)

i)) ‚â§ Œµ.

(5.5)

Since Sb is (Œ¥ ‚àí 2Œµ)-approximate current-state opaque, there exist an initial state x(cid:48)(cid:48)
x(cid:48)(cid:48)
0

n ‚àà Xb \ XbS and

n such that x(cid:48)(cid:48)

u(cid:48)(cid:48)
(cid:45) x(cid:48)(cid:48)
1
b

1

u(cid:48)(cid:48)
(cid:45) ¬∑ ¬∑ ¬∑
2
b

u(cid:48)(cid:48)
(cid:45) x(cid:48)(cid:48)
n
b

0 ‚àà X0b and a Ô¨Ånite run

max
i‚àà{0,1,...,n}

d(Hb(x(cid:48)

i), Hb(x(cid:48)(cid:48)

i )) ‚â§ Œ¥ ‚àí 2Œµ.

(5.6)

Again, since Sa (cid:22)Œµ
0 ‚àà X0a and a Ô¨Ånite run x(cid:48)(cid:48)(cid:48)
x(cid:48)(cid:48)(cid:48)
0

C Sb, by conditions (1), (2), (3)-(c) and (3)-(d) in DeÔ¨Ånition 5.6, there exist an initial state
n such that x(cid:48)(cid:48)(cid:48)

n ‚àà Xa \ XaS and

u(cid:48)(cid:48)(cid:48)
(cid:45) x(cid:48)(cid:48)(cid:48)
1
a

1

u(cid:48)(cid:48)(cid:48)
(cid:45) ¬∑ ¬∑ ¬∑
2
a

u(cid:48)(cid:48)(cid:48)
(cid:45) x(cid:48)(cid:48)(cid:48)
n
a

‚àÄi ‚àà {0, 1, . . . , n} : d(Ha(x(cid:48)(cid:48)(cid:48)

i ), Hb(x(cid:48)(cid:48)

i )) ‚â§ Œµ.

Combining equations (5.5), (5.6), (5.7), and using the triangle inequality, we have

max
i‚àà{0,1,...,n}

d(Ha(xi), Ha(x(cid:48)(cid:48)(cid:48)

i )) ‚â§ Œ¥.

(5.7)

(5.8)

Since x0 ‚àà X0a and x0
current-state opaque.

(cid:45) x1

u1
a

(cid:45) ¬∑ ¬∑ ¬∑
u2
a

un
a

(cid:45) xn are arbitrary, we conclude that Sa is Œ¥-approximate
(cid:3)

The following corollary is a simple consequence of the result in Theorem 5.6 but for the lack of Œ¥-approximate
current-state opacity.

Corollary 5.8. For any two systems Sa and Sb with Sb (cid:22)Œµ

C Sa, the following implication holds:

Sb is not (Œ¥ + 2Œµ)-approximate current-state opaque

‚áíSa is not Œ¥-approximate current-state opaque.

14

X. YIN AND M. ZAMANI

5.3. Approximate InÔ¨Ånite-Step Opacity Preserving Simulation Relation. Finally, by combing Œµ-
CurSOP simulation relation and Œµ-InitSOP simulation relation, we provide a notion of approximate simulation
relation for preserving inÔ¨Ånite-step opacity.

a

(cid:45) , Ya, Ha) and Sb = (Xb, Xb0, XbS, Ub,

DeÔ¨Ånition 5.9. (Approximate InÔ¨Ånite-Step Opacity Preserving Simulation Relation) Let Sa = (Xa, Xa0, XaS,
(cid:45) , Yb, Hb) be two metric systems with the same output
Ua,
sets Ya = Yb and metric d. For Œµ ‚àà R+
0 , a relation R ‚äÜ Xa √ó Xb is called an Œµ-approximate inÔ¨Ånite-step
opacity preserving simulation relation (Œµ-InfSOP simulation relation) from Sa to Sb if it is both an Œµ-CurSOP
simulation relation from Sa to Sb and an Œµ-InitSOP simulation relation from Sa to Sb, i.e.,

b

(1) (a) ‚àÄxa0 ‚àà Xa0, ‚àÉxb0 ‚àà Xb0 : (xa0, xb0) ‚àà R;

(b) ‚àÄxa0 ‚àà Xa0 ‚à© XaS, ‚àÉxb0 ‚àà Xb0 ‚à© XbS : (xa0, xb0) ‚àà R;
(c) ‚àÄxb0 ‚àà Xb0 \ XbS, ‚àÉxa0 ‚àà Xa0 \ XaS : (xa0, xb0) ‚àà R;

a, ‚àÉxb

(a) ‚àÄxa

(2) ‚àÄ(xa, xb) ‚àà R : d(Ha(xa), Hb(xb)) ‚â§ Œµ;
(3) For any (xa, xb) ‚àà R, we have
(cid:45) x(cid:48)
(cid:45) x(cid:48)
ua
ub
b : (x(cid:48)
a
b
(cid:45) x(cid:48)
(cid:45) x(cid:48)
ub
ua
a
b
(cid:45) x(cid:48)
ub
a : (x(cid:48)
b
(cid:45) x(cid:48)
ub
b

a
b ‚àà Xb \ XbS, ‚àÉxa

a ‚àà XaS, ‚àÉxb

(cid:45) x(cid:48)
ua

(b) ‚àÄxa

(d) ‚àÄxb

(c) ‚àÄxb

b, ‚àÉxa

a, x(cid:48)
b) ‚àà R;
b ‚àà XbS : (x(cid:48)
a, x(cid:48)
b) ‚àà R.
(cid:45) x(cid:48)
ua

a

a, x(cid:48)

b) ‚àà R;

a ‚àà Xa \ XaS : (x(cid:48)

a, x(cid:48)

b) ‚àà R.

We say that Œ£a is Œµ-InfSOP simulated by Œ£b, denoted by Œ£a (cid:22)Œµ
relation R from Sa to Sb.

IF Œ£b, if there exists an Œµ-InfSOP simulation

Similar to the cases of initial-state opacity and current-state opacity, we have the following theorem as a
suÔ¨Écient condition for Œ¥-approximate inÔ¨Ånite-step opacity based on related systems as in DeÔ¨Ånition 5.9.

Theorem 5.10. Let Sa = (Xa, Xa0, XaS, Ua,
two metric systems with the same output sets Ya = Yb and metric d and let Œµ, Œ¥ ‚àà R+
Œµ ‚â§ Œ¥

2 , then the following implication hold:

(cid:45) , Ya, Ha) and Sb = (Xb, Xb0, XbS, Ub,

a

(cid:45) , Yb, Hb) be
IF Sb and

b
0 . If Sa (cid:22)Œµ

Sb is (Œ¥ ‚àí 2Œµ)-approximate inÔ¨Ånite-step opaque

‚áíSa is Œ¥-approximate inÔ¨Ånite-step opaque.

u1
Proof. Let us consider an arbitrary initial state x0 ‚àà Xa0 and Ô¨Ånite run x0
a
such that xk ‚àà XaS for some k = 0, . . . , n. We consider the following two cases:
If k = 0, then we have x0 ‚àà XaS. Since Sa (cid:22)Œµ
know that there exist an initial state x(cid:48)
maxi‚àà{0,1,...,n} d(Ha(xi), Ha(x(cid:48)

IF Sb implies Sa (cid:22)Œµ
0 ‚àà Xa0 \ XaS and a run x(cid:48)
0

u(cid:48)
(cid:45) x(cid:48)
1
a

i)) ‚â§ Œ¥.

1

(cid:45) x1

(cid:45) ¬∑ ¬∑ ¬∑
u2
a

(cid:45) xn in Sa

un
a

I Sb, by the proof of Theorem 5.2, we
n such that

u(cid:48)
(cid:45) ¬∑ ¬∑ ¬∑
2
a

u(cid:48)
(cid:45) x(cid:48)
n
a

If k ‚â• 1, then similar to the proof of Theorem 5.7, by conditions (1)-(a), (2), (3)-(a), (3)-(b), (3)-(c) and
(3)-(d) in DeÔ¨Ånition 5.9 and the fact the Sb is (Œ¥ ‚àí 2Œµ)-approximate inÔ¨Ånite-step opaque, there exist an
initial state x(cid:48)
k ‚àà Xa \ XaS and
maxi‚àà{0,1,...,n} d(Ha(xi), Ha(x(cid:48)

0 ‚àà X0a and a Ô¨Ånite run x(cid:48)
0

n such that x(cid:48)

u(cid:48)
(cid:45) ¬∑ ¬∑ ¬∑
2
a

u(cid:48)
(cid:45) x(cid:48)
1
a

(cid:45) x(cid:48)

u(cid:48)
n
a

1

Since x0 ‚àà X0a, x0
inÔ¨Ånite-step opaque.

(cid:45) x1

u1
a

un
a

(cid:45) xn and index k are arbitrary, we conclude that Sa is Œ¥-approximate
(cid:3)

i)) ‚â§ Œ¥.
(cid:45) ¬∑ ¬∑ ¬∑
u2
a

We can obtain the following corollary immediately.

ON APPROXIMATE OPACITY OF CYBER-PHYSICAL SYSTEMS

15

Corollary 5.11. For any two systems Sa and Sb with Sb (cid:22)Œµ

IF Sa, the following implication holds:

Sb is not (Œ¥ + 2Œµ)-approximate inÔ¨Ånite-step opaque

‚áíSa is not Œ¥-approximate inÔ¨Ånite-step opaque.

In the next section, we study opacity of continuous-space control systems by constructing their Ô¨Ånite abstrac-
tions and analyzing their opacity.

6. Opacity of Control Systems

In this section, we show how to analyze approximate opacity for a class of discrete-time control systems of the
following form.
DeÔ¨Ånition 6.1. A discrete-time control system Œ£ is deÔ¨Åned by the tuple Œ£ = (X, S, U, f, Y, h), where X,
U, and Y are the state, input, and output sets, respectively, and are subsets of normed vector spaces with
appropriate Ô¨Ånite dimensions. Set S ‚äÜ X is a set of secret states. The map f : X √ó U ‚Üí X is called the
transition function, and h : X ‚Üí Y is the output map and assumed to satisfy the following Lipschitz condition:
(cid:107)h(x) ‚àí h(y)(cid:107) ‚â§ Œ±((cid:107)x ‚àí y(cid:107)) for some Œ± ‚àà K‚àû and all x, y ‚àà X. The discrete-time control system Œ£ is described
by diÔ¨Äerence equations of the form

Œ£ :

(cid:26) Œæ(k + 1) = f (Œæ(k), œÖ(k)),
Œ∂(k) = h(Œæ(k)),

(6.1)

where Œæ : N0 ‚Üí X, Œ∂ : N0 ‚Üí Y, and œÖ : N0 ‚Üí U are the state, output, and input signals, respectively.

We write ŒæxœÖ(k) to denote the point reached at time k under the input signal œÖ from initial condition x = ŒæxœÖ(0).
Similarly, we denote by Œ∂xœÖ(k) the output corresponding to state ŒæxœÖ(k), i.e. Œ∂xœÖ(k) = h(ŒæxœÖ(k)). In the above
deÔ¨Ånition, we implicitly assumed that set X is positively invariant1.

Now, we introduce the notion of incremental input-to-state stability (Œ¥-ISS) leveraged later to show some of
the main results of the paper.
DeÔ¨Ånition 6.2. System Œ£ = (X, S, U, f, Y, h) is called incrementally input-to-state stable (Œ¥-ISS) if there exist
a KL function Œ≤ and K‚àû function Œ≥ such that ‚àÄx, x(cid:48) ‚àà X and ‚àÄœÖ, œÖ(cid:48) : N0 ‚Üí U, the following inequality holds
for any k ‚àà N:

(cid:107)ŒæxœÖ(k)‚àíŒæx(cid:48)œÖ(cid:48)(k)(cid:107) ‚â§ Œ≤((cid:107)x ‚àí x(cid:48)(cid:107), k)+Œ≥((cid:107)œÖ ‚àí œÖ(cid:48)(cid:107)‚àû).

Example 6.3. As an example, for a linear control system:

Œæ(k + 1) = AŒæ(k) + BœÖ(k),

Œ∂(k) = CŒæ(k),

where all eigenvalues of A are inside the unit circle, the functions Œ≤ and Œ≥ can be chosen as:

Œ≤(r, k) = (cid:107)Ak(cid:107)r;

Œ≥(r) = (cid:107)B(cid:107)

(cid:33)

(cid:107)Am(cid:107)

r.

(cid:32) ‚àû
(cid:88)

m=0

(6.2)

(6.3)

(6.4)

In general, it is diÔ¨Écult to check inequality (6.2) directly for nonlinear systems. Fortunately, Œ¥-ISS can be
characterized using Lyapunov functions.
DeÔ¨Ånition 6.4. Consider a control system Œ£ and a continuous function V : X √ó X ‚Üí R+
called a Œ¥-ISS Lyapunov function for Œ£ if there exist K‚àû functions Œ±1, Œ±2, œÅ and K function œÉ such that:

0 . Function V is

(i) for any x, x(cid:48) ‚àà X

Œ±1((cid:107)x ‚àí x(cid:48)(cid:107)) ‚â§ V (x, x(cid:48)) ‚â§ Œ±2((cid:107)x ‚àí x(cid:48)(cid:107));

(ii) for any x, x(cid:48) ‚àà X and u, u(cid:48) ‚àà U

V(f (x, u),f (x(cid:48), u(cid:48)))‚àíV (x, x(cid:48)) ‚â§ ‚àíœÅ(V (x, x(cid:48)))+œÉ((cid:107)u ‚àí u(cid:48)(cid:107));

1Set X is called positively invariant under (6.1) if ŒæxœÖ(k) ‚àà X for any k ‚àà N, any x ‚àà X and any œÖ : N0 ‚Üí U.

16

X. YIN AND M. ZAMANI

The following result characterizes Œ¥-ISS in terms of existence of Œ¥-ISS Lyapunov functions.

Theorem 6.5. [Tra18] Consider a control system Œ£.

‚Ä¢ Œ£ is Œ¥-ISS if it admits a Œ¥-ISS Lyapunov function;
‚Ä¢ If U is compact and convex and X is compact, tehn the existence of a Œ¥-ISS Lyapunov function is

equivalent to Œ¥-ISS.

The next technical lemma will be used later to show some of the main results of this section.

Lemma 6.6. Consider a control system Œ£. Suppose V is a Œ¥-ISS Lyapunov function for Œ£. Then there exist
Œ∫, Œª ‚àà K‚àû, where Œ∫(s) < s for any s ‚àà R+, such that

V (f (x, u), f (x(cid:48), u(cid:48))) ‚â§ max{Œ∫(V (x, x(cid:48))), Œª((cid:107)u ‚àí u(cid:48)(cid:107))},

(6.5)

for any x, x(cid:48) ‚àà X and any u, u(cid:48) ‚àà U.

The proof is similar to that of Theorem 1 in [SGZ17] and is omitted here due to lack of space.

In order to provide the main results of this section, we Ô¨Årst describe control systems in DeÔ¨Ånition 6.1 as
metric systems as in DeÔ¨Ånition 2.1. More precisely, given a control system Œ£ = (X, S, U, f, Y, h), we deÔ¨Åne an
associated metric system

S(Œ£) = (X, X0, XS, U, (cid:45) , Y, H),

(6.6)
u(cid:45) x(cid:48) if and only if x(cid:48) = f (x, u). We
where X = X, X0 = X, XS = S, U = U, Y = Y, H = h, and x
assume that the output set Y is equipped with the inÔ¨Ånity norm: d(y1, y2) = (cid:107)y1 ‚àí y2(cid:107), ‚àÄy1, y2 ‚àà Y . We have
a similar assumption for the state set X.
Now, we introduce a symbolic system for the control system Œ£ = (X, S, U, f, Y, h). To do so, from now on we
assume that sets X, S and U are of the form of Ô¨Ånite union of boxes. Consider a concrete control system Œ£
and a tuple q = (Œ∑, ¬µ) of parameters, where 0 < Œ∑ ‚â§ min {span(S), span(X \ S)} is the state set quantization
and 0 < ¬µ ‚â§ span(U) is the input set quantization. Let us introduce the symbolic system

where Xq = Xq0 = [X]Œ∑, XqS = [S]Œ∑, Uq = [U]¬µ, Yq = {h(xq) | xq ‚àà Xq}, Hq(xq) = h(xq), ‚àÄxq ‚àà Xq, and

Sq(Œ£) = (Xq, Xq0, XqS, Uq,

(cid:45) , Yq, Hq),

q

(6.7)

‚Ä¢ xq

(cid:45) x(cid:48)
uq

q

q if and only if (cid:107)x(cid:48)

q ‚àí f (xq, uq)(cid:107) ‚â§ Œ∑.

We can now state the Ô¨Årst main result of this section showing that, under some condition over the quantiza-
tion parameters Œ∑ and ¬µ, Sq(Œ£) and S(Œ£) are related under an approximate initial-state opacity preserving
simulation relation.

Theorem 6.7. Let Œ£ = (X, S, U, f, Y, h) be a Œ¥-ISS control system. For any desired precision Œµ > 0, and any
tuple q = (Œ∑, ¬µ) of quantization parameters satisfying

Œ≤ (cid:0)Œ±‚àí1(Œµ), 1(cid:1) + Œ≥(¬µ) + Œ∑ ‚â§ Œ±‚àí1(Œµ),

(6.8)

we have S(Œ£) (cid:22)Œµ

I Sq(Œ£) (cid:22)Œµ

I S(Œ£).

Proof. We start by proving S(Œ£) (cid:22)Œµ
only if (cid:107)x ‚àí xq(cid:107) ‚â§ Œ±‚àí1(Œµ). Since Œ∑ ‚â§ span(S), XS ‚äÜ (cid:83)
exists xq ‚àà XqS such that:

I Sq(Œ£). Consider the relation R ‚äÜ X √ó Xq deÔ¨Åned by (x, xq) ‚àà R if and
BŒ∑(p), and by (6.8), for every x ‚àà XS there always

p‚àà[S]Œ∑

(cid:107)x ‚àí xq(cid:107) ‚â§ Œ∑ ‚â§ Œ±‚àí1(Œµ).
Hence, (x, xq) ‚àà R and condition (1)-(a) in DeÔ¨Ånition 5.1 is satisÔ¨Åed. For every xq ‚àà Xq \ XqS, by choosing
x = xq which is also inside set X \ XS, one gets (x, xq) ‚àà R and, hence, condition (1)-(b) in DeÔ¨Ånition 5.1

(6.9)

ON APPROXIMATE OPACITY OF CYBER-PHYSICAL SYSTEMS

17

holds as well. Now consider any (x, xq) ‚àà R. Condition (2) in DeÔ¨Ånition 5.1 is satisÔ¨Åed by the deÔ¨Ånition of R
and the Lipschitz assumption on map h as in DeÔ¨Ånition 6.1:

(cid:107)H(x) ‚àí Hq(xq)(cid:107) = (cid:107)h(x) ‚àí h(xq)(cid:107) ‚â§ Œ±((cid:107)x ‚àí xq(cid:107)) ‚â§ Œµ.

Let us now show that condition (3) in DeÔ¨Ånition 5.1 holds.

Consider any u ‚àà U . Choose an input uq ‚àà Uq satisfying:

(6.10)
(cid:107)u ‚àí uq(cid:107) ‚â§ ¬µ.
Note that the existence of such uq is guaranteed by the inequality ¬µ ‚â§ span(U) which guarantees that
u(cid:45) x(cid:48) = f (x, u) in S(Œ£). It follows from the Œ¥-ISS
U ‚äÜ (cid:83)
assumption on Œ£ and (6.10) that the distance between x(cid:48) and f (xq, uq) is bounded as:

B¬µ(p). Consider the unique transition x

p‚àà[U]¬µ

(6.11)

(6.12)

(cid:107)x(cid:48) ‚àí f (xq, uq)(cid:107) ‚â§Œ≤ ((cid:107)x ‚àí xq(cid:107), 1) + Œ≥ ((cid:107)u ‚àí uq(cid:107))

‚â§Œ≤ (cid:0)Œ±‚àí1(Œµ), 1(cid:1) + Œ≥ (¬µ) .

Since X ‚äÜ (cid:83)

p‚àà[X]Œ∑

BŒ∑(p), there exists x(cid:48)

q ‚àà Xq such that:

(cid:107)f (xq, uq) ‚àí x(cid:48)

q(cid:107) ‚â§ Œ∑,
(cid:45) x(cid:48)
uq

q

which, by the deÔ¨Ånition of Sq(Œ£), implies the existence of xq
(6.11), (6.12), and triangle inequality, we obtain:

q in Sq(Œ£). Using the inequalities (6.8),

(cid:107)x(cid:48) ‚àí x(cid:48)

q(cid:107) ‚â§ (cid:107)x(cid:48) ‚àí f (xq, uq) + f (xq, uq) ‚àí x(cid:48)

q(cid:107)
‚â§ (cid:107)x(cid:48) ‚àí f (xq, uq)(cid:107) + (cid:107)f (xq, uq) ‚àí x(cid:48)
q(cid:107)
‚â§ Œ≤ (cid:0)Œ±‚àí1(Œµ), 1(cid:1) + Œ≥ (¬µ) + Œ∑ ‚â§ Œ±‚àí1(Œµ).

Therefore, we conclude (x(cid:48), x(cid:48)
condition (3)-(b) in DeÔ¨Ånition 5.1 also holds.

q) ‚àà R and condition (iii)-(a) in DeÔ¨Ånition 5.1 holds. Let us now show that

Now consider any (x, xq) ‚àà R. Consider any uq ‚àà Uq. Choose the input u = uq and consider the unique
x(cid:48) = f (x, u) in S(Œ£). Using Œ¥-ISS assumption for Œ£, we bound the distance between x(cid:48) and f (xq, uq) as:

(cid:107)x(cid:48) ‚àí f (xq, uq)(cid:107) ‚â§ Œ≤ ((cid:107)x ‚àí xq(cid:107), 1) ‚â§ Œ≤ (cid:0)Œ±‚àí1(Œµ), 1(cid:1) .

(6.13)

Using the deÔ¨Ånition of Sq(Œ£), the inequalities (6.8), (6.13), and the triangle inequality, we obtain:

(cid:107)x(cid:48) ‚àí x(cid:48)

q(cid:107) ‚â§(cid:107)x(cid:48) ‚àí f (xq, uq) + f (xq, uq) ‚àí x(cid:48)

q(cid:107)
‚â§(cid:107)x(cid:48) ‚àí f (xq, uq)(cid:107) + (cid:107)f (xq, uq) ‚àí x(cid:48)
‚â§Œ≤ (cid:0)Œ±‚àí1(Œµ), 1(cid:1) + Œ∑ ‚â§ Œ±‚àí1(Œµ).

q(cid:107)

Therefore, we conclude that (x(cid:48), x(cid:48)

q) ‚àà R and condition (iii)-(b) in DeÔ¨Ånition 5.1 holds.

In a similar way, one can prove that Sq(Œ£) (cid:22)Œµ

I S(Œ£).

(cid:3)

Remark 6.8. Note that there always exist quantization parameters q such that inequality (6.8) holds as long
as Œ≤ (cid:0)Œ±‚àí1(Œµ), 1(cid:1) < Œ±‚àí1(Œµ). By assuming that the discrete-time control system Œ£ is a sampled-data version of
an original continuous-time one with the sampling time œÑ , one can ensure the latter inequality by choosing
the sampling time large enough given that Œ≤(r, 1) = ÀÜŒ≤(r, œÑ ) < r for some KL function ÀÜŒ≤ establishing the
incremental stability of the original continuous-time system. For example, for the function in (6.4), one has
Œ≤(r, 1) = (cid:107)A(cid:107)r = (cid:107)e ÀÜAœÑ (cid:107)r, where ÀÜA is the state matrix of the original continuous-time linear control system.

The next theorem provides similar results as in Theorem 6.7 but by leveraging Œ¥-ISS Lyapunov functions. To
show the next result, we will make the following supplementary assumption on the Œ¥-ISS Lyapunov functions:
there exists a function ÀÜŒ≥ ‚àà K‚àû such that

‚àÄx, x(cid:48), x(cid:48)(cid:48) ‚àà X,

V (x, x(cid:48)) ‚àí V (x(cid:48), x(cid:48)(cid:48)) ‚â§ ÀÜŒ≥((cid:107)x ‚àí x(cid:48)(cid:48)(cid:107)).

(6.14)

18

X. YIN AND M. ZAMANI

Inequality (6.14) is not restrictive at all provided we are interested in the dynamics of the control system on
a compact subset of the state set X; see the discussion at the end of Section IV in [GPT10].

Theorem 6.9. Let Œ£ = (X, S, U, f, Y, h) admit a Œ¥-ISS Lyapunov function V satisfying (6.14). For any
desired precision Œµ > 0, and any tuple q = (Œ∑, ¬µ) of quantization parameters satisfying

Œ±2(Œ∑) ‚â§Œ±1(Œ±‚àí1(Œµ)),
max{Œ∫(Œ±1(Œ±‚àí1(Œµ))), Œª(¬µ)} + ÀÜŒ≥(Œ∑) ‚â§Œ±1(Œ±‚àí1(Œµ)),

(6.15)

(6.16)

we have S(Œ£) (cid:22)Œµ

I Sq(Œ£) (cid:22)Œµ

I S(Œ£).

Proof. We start by proving S(Œ£) (cid:22)Œµ
only if V (x, xq) ‚â§ Œ±1(Œ±‚àí1(Œµ)). Since Œ∑ ‚â§ span(S) and XS ‚äÜ (cid:83)
exists xq ‚àà XqS such that (cid:107)x ‚àí xq(cid:107) ‚â§ Œ∑. Then

I Sq(Œ£). Consider the relation R ‚äÜ X √ó Xq deÔ¨Åned by (x, xq) ‚àà R if and
BŒ∑(p), for every x ‚àà XS there always

p‚àà[S]Œ∑

V (x, xq) ‚â§ Œ±2((cid:107)x ‚àí xq(cid:107)) ‚â§ Œ±2(Œ∑) ‚â§ Œ±1(Œ±‚àí1(Œµ))

because of (6.15) and Œ±2 being a K‚àû function. Hence, (x, xq) ‚àà R and condition (1)-(a) in DeÔ¨Ånition 5.1 is
satisÔ¨Åed. For every xq ‚àà Xq \ XqS, by choosing x = xq which is also inside set X \ XS, one gets trivially
(x, xq) ‚àà R and, hence, condition (1)-(b) in DeÔ¨Ånition 5.1 holds as well. Now consider any (x, xq) ‚àà R. Con-
dition (2) in DeÔ¨Ånition 5.1 is satisÔ¨Åed by the deÔ¨Ånition of R and the Lipschitz assumption on map h as in
DeÔ¨Ånition 6.1:

(cid:107)H(x) ‚àí Hq(xq)(cid:107) = (cid:107)h(x) ‚àí h(xq)(cid:107) ‚â§ Œ±((cid:107)x ‚àí xq(cid:107))

‚â§ Œ±(Œ±‚àí1

1 (V (x, xq)) ‚â§ Œµ.

Let us now show that condition (3) in DeÔ¨Ånition 5.1 holds.

Consider any u ‚àà U . Choose an input uq ‚àà Uq satisfying:

(cid:107)u ‚àí uq(cid:107) ‚â§ ¬µ.
(6.17)
Note that the existence of such uq is guaranteed by the inequality ¬µ ‚â§ span(U) which guarantees that
u(cid:45) x(cid:48) = f (x, u) in S(Œ£). Given Œ¥-ISS Lyapunov
U ‚äÜ (cid:83)
function V for Œ£, inequality (6.5), and (6.17), one obtains:

B¬µ(p). Consider the unique transition x

p‚àà[U]¬µ

V (x(cid:48), f (xq, uq)) ‚â§ max{Œ∫ (V (x, xq)) , Œª ((cid:107)u ‚àí uq(cid:107))}

‚â§ max{Œ∫ (cid:0)Œ±1(Œ±‚àí1(Œµ))(cid:1) , Œª (¬µ)}.

Since X ‚äÜ (cid:83)

p‚àà[X]Œ∑

BŒ∑(p), there exists x(cid:48)

q ‚àà Xq such that:

(cid:107)f (xq, uq) ‚àí x(cid:48)

q(cid:107) ‚â§ Œ∑,

(6.18)

(6.19)

which, by the deÔ¨Ånition of Sq(Œ£), implies the existence of xq
(6.16), (6.18), and (6.19), we obtain:

(cid:45) x(cid:48)
uq

q

q in Sq(Œ£). Using the inequalities (6.14),

V (x(cid:48), x(cid:48)

q) ‚â§ V (x(cid:48), f (xq, uq)) + ÀÜŒ≥((cid:107)f (xq, uq) ‚àí x(cid:48)
‚â§ max{Œ∫ (cid:0)Œ±1(Œ±‚àí1(Œµ))(cid:1) , Œª (¬µ)} + ÀÜŒ≥ (Œ∑)
‚â§ Œ±1(Œ±‚àí1(Œµ)).

q(cid:107))

Therefore, we conclude (x(cid:48), x(cid:48)
condition (3)-(b) in DeÔ¨Ånition 5.1 also holds.

q) ‚àà R and condition (iii)-(a) in DeÔ¨Ånition 5.1 holds. Let us now show that

Now consider any (x, xq) ‚àà R. Consider any uq ‚àà Uq. Choose the input u = uq and consider the unique
x(cid:48) = f (x, u) in S(Œ£). Given Œ¥-ISS Lyapunov function V for Œ£ and inequality (6.5), one gets:

V (x(cid:48), f (xq, uq)) ‚â§ Œ∫ (V (x, xq)) ‚â§ Œ∫ (cid:0)Œ±1(Œ±‚àí1(Œµ))(cid:1) .

(6.20)

ON APPROXIMATE OPACITY OF CYBER-PHYSICAL SYSTEMS

Using the deÔ¨Ånition of Sq(Œ£), the inequalities (6.14), (6.16), and (6.20), we obtain:

V (x(cid:48), x(cid:48)

q) ‚â§V (x(cid:48), f (xq, uq)) + ÀÜŒ≥((cid:107)f (xq, uq) ‚àí x(cid:48)

q(cid:107))
‚â§Œ∫ (cid:0)Œ±1(Œ±‚àí1(Œµ))(cid:1) + ÀÜŒ≥(Œ∑) ‚â§ Œ±1(Œ±‚àí1(Œµ)).

Therefore, we conclude that (x(cid:48), x(cid:48)

q) ‚àà R and condition (iii)-(b) in DeÔ¨Ånition 5.1 holds.

In a similar way, one can prove that Sq(Œ£) (cid:22)Œµ

I S(Œ£).

19

(cid:3)

Remark 6.10. One can readily verify that there always exits a choice of quantization parameter q = (Œ∑, ¬µ)
such that inequalities (6.15) and (6.16) hold simoultanously. Although the result in Theorem 6.9 seems more
general than that of Theorem 6.7 in terms of the existence of quantization parameter q, the symbolic model
Sq(Œ£), computed by using the quantization parameters q provided in Theorem 6.7 whenever existing, is likely
to have fewer states than the model computed by using the quantization parameters provided in Theorem 6.9
due to the conservative nature of Œ¥-ISS Lyapunov functions.

The next theorems illustrate the other main results of this section showing that, under similar conditions over
the quantization parameters Œ∑ and ¬µ, Sq(Œ£) and S(Œ£) are related under an approximate current-state opacity
preserving simulation relation.

Theorem 6.11. Let Œ£ = (X, S, U, f, Y, h) be a Œ¥-ISS control system. For any desired precision Œµ > 0, and
any tuple q = (Œ∑, ¬µ) of quantization parameters satisfying

Œ≤ (cid:0)Œ±‚àí1(Œµ), 1(cid:1) + Œ≥(¬µ) + Œ∑ ‚â§ Œ±‚àí1(Œµ),

we have S(Œ£) (cid:22)Œµ

C Sq(Œ£) (cid:22)Œµ

C S(Œ£).

Proof. The proof is similar to that of Theorem 6.7 and is omitted here due to lack of space.

(cid:3)

Theorem 6.12. Let Œ£ = (X, S, U, f, Y, h) admits a Œ¥-ISS Lyapunov function V satisfying (6.14). For any
desired precision Œµ > 0, and any tuple q = (Œ∑, ¬µ) of quantization parameters satisfying

Œ±2(Œ∑) ‚â§Œ±1(Œ±‚àí1(Œµ)),
max{Œ∫(Œ±1(Œ±‚àí1(Œµ))), Œª(¬µ)} + ÀÜŒ≥(Œ∑) ‚â§Œ±1(Œ±‚àí1(Œµ)),

we have S(Œ£) (cid:22)Œµ

C Sq(Œ£) (cid:22)Œµ

C S(Œ£).

Proof. The proof is similar to that of Theorem 6.9 and is omitted here due to lack of space.

(cid:3)

I Sq(Œ£) (cid:22)Œµ

Since S(Œ£) (cid:22)Œµ
C S(Œ£) under the same relation in Theorems 6.7 and 6.11
(resp. Theorems 6.9 and 6.12), by the deÔ¨Ånition of approximate inÔ¨Ånite-state opacity preserving simulation
relation, we consequently get the following results.

I S(Œ£) and S(Œ£) (cid:22)Œµ

C Sq(Œ£) (cid:22)Œµ

Theorem 6.13. Let Œ£ = (X, S, U, f, Y, h) be a Œ¥-ISS control system. For any desired precision Œµ > 0, and
any tuple q = (Œ∑, ¬µ) of quantization parameters satisfying

Œ≤ (cid:0)Œ±‚àí1(Œµ), 1(cid:1) + Œ≥(¬µ) + Œ∑ ‚â§ Œ±‚àí1(Œµ),

we have S(Œ£) (cid:22)Œµ

IF Sq(Œ£) (cid:22)Œµ

IF S(Œ£).

Theorem 6.14. Let Œ£ = (X, S, U, f, Y, h) admits a Œ¥-ISS Lyapunov function V satisfying (6.14). For any
desired precision Œµ > 0, and any tuple q = (Œ∑, ¬µ) of quantization parameters satisfying

Œ±2(Œ∑) ‚â§Œ±1(Œ±‚àí1(Œµ)),
max{Œ∫(Œ±1(Œ±‚àí1(Œµ))), Œª(¬µ)} + ÀÜŒ≥(Œ∑) ‚â§Œ±1(Œ±‚àí1(Œµ)),

we have S(Œ£) (cid:22)Œµ

IF Sq(Œ£) (cid:22)Œµ

IF S(Œ£).

20

X. YIN AND M. ZAMANI

7. Conclusion

In this paper, we extended the concept of opacity to metric systems by proposing the notion of approximate
opacity. VeriÔ¨Åcation algorithms and approximate relations that preserve approximate opacity were also pro-
vided. We also discussed how to construct Ô¨Ånite abstractions that approximately simulates a class of control
systems in terms of opacity preserving. Our result bridges the gap between the opacity analysis of Ô¨Ånite
discrete systems and continuous control systems.

Among the many possible directions for future work that will be built based on the proposed framework,
we mention several directions of immediate interest. One direction is to extend our framework to the
stochastic setting for almost opacity [SH14, BMS15, CIK17, YLWL19]. Also, we are interested in con-
structing approximate opacity preserving symbolic models for more classes of systems. Finally, we plan
to extend approximate opacity preserving simulation relation to approximate opacity preserving alternat-
ing simulation relation [Tab09] and solve the problem of controller synthesis enforcing approximate opacity
[DDM10, CDM12, ZSL15, YL16, TLSG18, JWL18].

.1. Proofs not contained in main body. Proof of Proposition 4.2

Proof. It is straightforward to show (i). Hereafter, we prove (ii) by induction on the length of input sequence.

When n = 0, i.e., there is no input sequence, we have that (x0, q0) ‚àà XI0. By the deÔ¨Ånition of XI0, we know
that

which implies (ii) immediately.

q0 = {x(cid:48)

0 ‚àà X : d(H(x0), H(x(cid:48)

0)) ‚â§ Œ¥}

To proceed the induction, we assume that (ii) holds when n = k. Now, we need to show that (ii) also holds
when n = k + 1. To this end, we consider arbitrary pair (x0, q0) ‚àà XI0 and Ô¨Ånite run
(cid:45) (xn+1, qn+1).

(cid:45) (xn, qn)

(cid:45) (x1, q1)

(x0, q0)

un+1

(cid:45) ¬∑ ¬∑ ¬∑
u2
I

un
I

u1
I

I

Then, we have

qn+1 = ‚à™ÀÜu‚ààU PreÀÜu(qn) ‚à© {x ‚àà X : d(H(xn+1), H(x)) ‚â§ Œ¥}

={x ‚àà X : ‚àÉx(cid:48) ‚àà qn, u(cid:48)
= (cid:8)x ‚àà X : [‚àÉx(cid:48) ‚àà qn, u(cid:48)

n+1 ‚àà U s.t. (x, u(cid:48)
n+1 ‚àà U s.t. (x, u(cid:48)

n+1, x(cid:48)) ‚àà (cid:45)} ‚à© {x ‚àà X : d(H(xn+1), H(x)) ‚â§ Œ¥}
n+1, x(cid:48)) ‚àà (cid:45)] ‚àß [d(H(xn+1), H(x)) ‚â§ Œ¥](cid:9) .

(.1)

By the induction hypothesis, we know that

(cid:26)

qn =

0 ‚àà X : ‚àÉx(cid:48)
x(cid:48)
0

u(cid:48)
n(cid:45) x(cid:48)

1

u(cid:48)
n‚àí1(cid:45) ¬∑ ¬∑ ¬∑

u(cid:48)
1(cid:45) x(cid:48)

n s.t.

max
i‚àà{0,1,...,n}

Therefore, by combing equations (.1) and (.2), one gets

d(H(xi), H(x(cid:48)

n‚àíi)) ‚â§ Œ¥

(cid:27)

.

(.2)

(cid:40)

qn+1 =

x ‚àà X :

u(cid:48)
u(cid:48)
n(cid:45) x(cid:48)
1(cid:45) x(cid:48)
1
s.t. maxi‚àà{0,1,...,n} d(H(xi), H(x(cid:48)
n‚àíi)) ‚â§ Œ¥ ‚àß d(H(xn+1), H(x)) ‚â§ Œ¥

un‚àí1(cid:45) ¬∑ ¬∑ ¬∑

u(cid:48)
n+1(cid:45) x(cid:48)

‚àÉx

n

0

(cid:26)
x ‚àà X : ‚àÉx(cid:48)(cid:48)
0

=

u(cid:48)
n+1(cid:45) x(cid:48)(cid:48)

1

u(cid:48)
n(cid:45) ¬∑ ¬∑ ¬∑

u(cid:48)
1(cid:45) x(cid:48)(cid:48)

n+1 s.t.

max
i‚àà{0,1,...,n+1}

d(H(xi), H(x(cid:48)(cid:48)

n+1‚àíi)) ‚â§ Œ¥

.

(.3)

(cid:41)

(cid:27)

Note that, in the second equality of equation (.3), we choose x(cid:48)(cid:48)
obtains that the induction step holds, which completes the induction and proof.

0 = x and x(cid:48)(cid:48)

i = x(cid:48)

i‚àí1, i ‚â• 1. Therefore, one
(cid:3)

Proof of Theorem 4.3

ON APPROXIMATE OPACITY OF CYBER-PHYSICAL SYSTEMS

21

Proof. (‚áí) By contraposition: suppose that there exists a state (x, q) ‚àà XI such that x ‚àà X0 ‚à© XS and
q ‚à© X0 ‚äÜ XS. Let

(x0, q0)

(cid:45) (x1, q1)

u1
I

(cid:45) ¬∑ ¬∑ ¬∑
u1
I

(cid:45) (xn, qn)

un
I

be a run reaching (x, q) =: (xn, qn). By Proposition 4.2, we have xn
well-deÔ¨Åned in S as xn ‚àà X0. Moreover, by Proposition 4.2, we have

un(cid:45) xn‚àí1

un‚àí1(cid:45) ¬∑ ¬∑ ¬∑

u1(cid:45) x1, which is

(cid:26)

qn =

0 ‚àà X : ‚àÉx(cid:48)
x(cid:48)
0

u(cid:48)
n(cid:45) x(cid:48)

1

u(cid:48)
n‚àí1(cid:45) ¬∑ ¬∑ ¬∑

u(cid:48)
1(cid:45) x(cid:48)

n s.t.

max
i‚àà{0,1,...,n}

d(H(xi), H(x(cid:48)

n‚àíi)) ‚â§ Œ¥

(cid:27)

.

However, since qn‚à©X0 ‚äÜ XS, we know that there does not exist x(cid:48)
such that maxi‚àà{0,1,...,n} d(H(xi), H(x(cid:48)
¬∑ ¬∑ ¬∑

u1(cid:45) x1, we know that the system is not Œ¥-approximate initial-state opaque.

0 ‚àà X0\XS and x(cid:48)
0

n‚àíi)) ‚â§ Œ¥. Therefore, by considering xn ‚àà X0‚à©XS and xn

u(cid:48)
n(cid:45) x(cid:48)

1

u(cid:48)
n‚àí1(cid:45) ¬∑ ¬∑ ¬∑

u(cid:48)
1(cid:45) x(cid:48)

n
un‚àí1(cid:45)

un(cid:45) xn‚àí1

(‚áê) By contradiction: suppose that equation (4.1) holds and assume, for the sake of contradiction, that
S is not Œ¥-approximate initial-state opaque. Then, we know that there exists a secret initial state x0 ‚àà
un(cid:45) xn such that there does not exist a non-
X0 ‚à© XS and a sequence of transitions x0
u(cid:48)
2(cid:45) ¬∑ ¬∑ ¬∑
secret initial state x(cid:48)
n such that
maxi‚àà{0,1,...,n} d(H(xi), H(x(cid:48)

0 ‚àà X0 \ XS and a sequence of transitions x(cid:48)
0

u2(cid:45) ¬∑ ¬∑ ¬∑

u(cid:48)
n(cid:45) x(cid:48)

u1(cid:45) x1

u(cid:48)
1(cid:45) x(cid:48)

1

i)) ‚â§ Œ¥. Let us consider the following sequence of transitions in SI
(cid:45) ¬∑ ¬∑ ¬∑

(cid:45) (xn‚àí1, q1)

(cid:45) (x0, qn).

(xn, q0)

un‚àí1

I

u1
I

un
I

By Proposition 4.2, we know that
(cid:26)

qn =

0 ‚àà X : ‚àÉx(cid:48)
x(cid:48)
0

u(cid:48)
n(cid:45) x(cid:48)

1

u(cid:48)
n‚àí1(cid:45) ¬∑ ¬∑ ¬∑

u(cid:48)
1(cid:45) x(cid:48)

n s.t.

max
i‚àà{0,1,...,n}

d(H(xi), H(x(cid:48)

i)) ‚â§ Œ¥

(cid:27)

.

Since equation (4.1) holds, we know that qn ‚à© X0 (cid:54)‚äÜ XS. Therefore, there exists a non-secret initial state x(cid:48)
u(cid:48)
u(cid:48)
2(cid:45) ¬∑ ¬∑ ¬∑
1(cid:45) x(cid:48)
X0\XS and a sequence of transitions x(cid:48)
0
Œ¥, which is a contradiction. Therefore, S has to be Œ¥-approximate initial-state opaque.

n such that maxi‚àà{0,1,...,n} d(H(xi), H(x(cid:48)

u(cid:48)
n(cid:45) x(cid:48)

0 ‚àà
i)) ‚â§
(cid:3)

1

Proof of Proposition 4.6

Proof. It is straightforward to show (i). Hereafter, we show (ii) by induction on the length of input sequence.

When n = 0, i.e., there is no input sequence, we get that (x0, q0) ‚àà XC0. By the deÔ¨Ånition of XC0, we know
that

q0 = {x(cid:48)

0 ‚àà X0 : d(H(x0), H(x(cid:48)

0)) ‚â§ Œ¥},

which implies (ii) immediately.

To proceed the induction, we assume that (ii) holds for n = k. Now, we need to show that (ii) also holds for
n = k + 1. To this end, we consider arbitrary pair (x0, q0) ‚àà XC0 and Ô¨Ånite run
(cid:45)(x1, q1)

(cid:45)(xn+1, qn+1).

(cid:45)(xn, qn)

(x0, q0)

un+1

(cid:45) ¬∑ ¬∑ ¬∑
u2
C

un
C

u1
C

C

Then, we have

qn+1 = ‚à™ÀÜu‚ààUPostÀÜu(x)‚à©{x(cid:48)(cid:48)‚ààX : d(H(x(cid:48)), H(x(cid:48)(cid:48))) ‚â§ Œ¥}

={x ‚àà X : ‚àÉx(cid:48) ‚àà qn, u(cid:48)
=(cid:8)x ‚àà X: [‚àÉx(cid:48) ‚àà qn, u(cid:48)
By the induction hypothesis, we know that

n+1 ‚àà U s.t. (x(cid:48), u(cid:48)
n+1 ‚àà U s.t. (x(cid:48), un+1, x) ‚àà (cid:45)] ‚àß [d(H(xn+1), H(x)) ‚â§ Œ¥](cid:9) .

n+1, x) ‚àà (cid:45)} ‚à© {x ‚àà X : d(H(xn+1), H(x)) ‚â§ Œ¥}

(cid:26)

qn =

n ‚àà X :‚àÉx(cid:48)
x(cid:48)

0 ‚àà X0, ‚àÉx(cid:48)
0

u(cid:48)
1(cid:45) x(cid:48)

1

u(cid:48)
2(cid:45) ¬∑ ¬∑ ¬∑

u(cid:48)
n(cid:45) x(cid:48)

n s.t.

max
i‚àà{0,1,...,n}

d(H(xi), H(x(cid:48)

i)) ‚â§ Œ¥

(cid:27)

.

(.4)

(.5)

22

X. YIN AND M. ZAMANI

Therefore, by combing equations (.4) and (.5), one obtains

(cid:40)

qn+1 =

x ‚àà X :

u(cid:48)
1(cid:45) x(cid:48)

‚àÉx(cid:48)

0 ‚àà X0, ‚àÉx(cid:48)
0
s.t. maxi‚àà{0,1,...,n} d(H(xi), H(x(cid:48)
u(cid:48)
2(cid:45) ¬∑ ¬∑ ¬∑

u(cid:48)
1(cid:45) x(cid:48)

0 ‚àà X0, ‚àÉx(cid:48)
0

1

1

(cid:110)
xn+1 ‚àà X : ‚àÉx(cid:48)

=

u(cid:48)
n(cid:45) x(cid:48)

u(cid:48)
2(cid:45) ¬∑ ¬∑ ¬∑
i)) ‚â§ Œ¥ ‚àß d(H(xn+1), H(x)) ‚â§ Œ¥

u(cid:48)
n+1(cid:45) x

n

(cid:41)

u(cid:48)
n+1(cid:45) x(cid:48)

n+1 s.t. maxi‚àà{0,1,...,n+1} d(H(xi), H(x(cid:48)(cid:48)

(cid:111)
i )) ‚â§ Œ¥

.

Note that, in the second equality of equation (.6), we choose x(cid:48)
induction step holds, which completes the proof.

n+1 = x. Therefore, we conclude that the
(cid:3)

(.6)

Proof of Theorem 4.7

Proof. (‚áí) By contraposition: suppose that there exists a state (x, q) ‚àà XC such that q ‚äÜ XS. Let

(x0, q0)

(cid:45) (x1, q1)

u1
C

(cid:45) ¬∑ ¬∑ ¬∑
u1
C

(cid:45) (xn, qn),

un
C

be a run reaching (x, q) =: (xn, qn). By Proposition 4.6, we have x0 ‚àà X0 and x0
Moreover, one has

u1(cid:45) x1

u2(cid:45) ¬∑ ¬∑ ¬∑

un(cid:45) xn.

(cid:26)

qn =

n ‚àà X : ‚àÉx(cid:48)
x(cid:48)

0 ‚àà X0, ‚àÉx(cid:48)
0

u(cid:48)
1(cid:45) x(cid:48)

1

u(cid:48)
2(cid:45) ¬∑ ¬∑ ¬∑

u(cid:48)
n(cid:45) x(cid:48)

n s.t.

max
i‚àà{0,1,...,n}

d(H(xi), H(x(cid:48)

i)) ‚â§ Œ¥!

(cid:27)

.

Since qn ‚äÜ XS, one obtains that xn ‚àà qn ‚äÜ XS and there does not exist an initial state x(cid:48)
x(cid:48)
0

n such that xn ‚àà X \ XS and maxi‚àà{0,1,...,n} d(H(xi), H(x(cid:48)
u2(cid:45) ¬∑ ¬∑ ¬∑

0 ‚àà X0 and a run
i)) ‚â§ Œ¥. Therefore,
un(cid:45) xn, we know that the system is not Œ¥-approximate current-state

u(cid:48)
2(cid:45) ¬∑ ¬∑ ¬∑

u1(cid:45) x1

u(cid:48)
n(cid:45) x(cid:48)

1

u(cid:48)
1(cid:45) x(cid:48)
by considering x0
opaque.

u1(cid:45) x1
u(cid:48)
1(cid:45) x(cid:48)

(‚áê) By contradiction: suppose that equation (4.2) holds and assume, for the sake of contradiction, that S is
not Œ¥-approximate current-state opaque. Then, we know that there exists an initial state x0 ‚àà X0 and a run
0 ‚àà X0 and a
x0
run x(cid:48)
i)) ‚â§ Œ¥. Let us
0
consider the following sequence of transitions in SC
(cid:45) (x1, q1)

un(cid:45) xn, where xn ‚àà XS, such that there do not exist an initial state x(cid:48)

n ‚àà X \ XS and maxi‚àà{0,1,...,n} d(H(xi), H(x(cid:48)

u2(cid:45) ¬∑ ¬∑ ¬∑
u(cid:48)
2(cid:45) ¬∑ ¬∑ ¬∑

n such that x(cid:48)

(cid:45) (xn, qn),

u(cid:48)
n(cid:45) x(cid:48)

(x0, q0)

1

(cid:45) ¬∑ ¬∑ ¬∑
u2
C

un
C

u1
C

where q0 = {x ‚àà X0 : d(H(x0), H(x)) ‚â§ Œ¥}. By Proposition 4.6, we obtain that

(cid:26)
n ‚àà X : ‚àÉx(cid:48)
x(cid:48)

0 ‚àà X0, ‚àÉx(cid:48)
0

qn =

u(cid:48)
1(cid:45) x(cid:48)

1

u(cid:48)
2(cid:45) ¬∑ ¬∑ ¬∑

u(cid:48)
n(cid:45) x(cid:48)

n s.t.

max
i‚àà{0,1,...,n}

d(H(xi), H(x(cid:48)

i)) ‚â§ Œ¥

(cid:27)

.

Since equation (4.2) holds, we know that qn (cid:54)‚äÜ XS. Therefore, there exist an initial state x(cid:48)
x(cid:48)
0
contradiction. Therefore, S has to be Œ¥-approximate current-state opaque.

0 ‚àà X0 and a run
i)) ‚â§ Œ¥ and xn ‚àà X \ XS, which is a
(cid:3)

n such that maxi‚àà{0,1,...,n} d(H(xi), H(x(cid:48)

u(cid:48)
2(cid:45) ¬∑ ¬∑ ¬∑

u(cid:48)
n(cid:45) x(cid:48)

u(cid:48)
1(cid:45) x(cid:48)

1

Proof of Theorem 4.8

Proof. By contraposition: suppose that there exist two states (xn, q(cid:48)
and qn ‚à© q(cid:48)

n) ‚àà XI , (xn, qn) ‚àà XC such that xn ‚àà XS

(cid:45) ¬∑ ¬∑ ¬∑
u2
C

(cid:45) (xn, qn)(xn+m, qn+m)

un
C

un+m

(cid:45) (xn+m‚àí1, qn+m‚àí1)

I

un+m‚àí1

(cid:45) un+1

(cid:45) (xn, q(cid:48)
n)

I

I

n ‚äÜ XS. Let
(cid:45) (x1, q1)
u1
C

(x0, q0)

be two runs reaching (x, q) and (x, q(cid:48)), respectively. By Propositions 4.2 and 4.6, we have x0 ‚àà X0 and
un(cid:45)xn

un+m(cid:45)xn+m.

un‚àí1(cid:45)xn‚àí1

un+1(cid:45)xn+1

un+2(cid:45) ¬∑ ¬∑ ¬∑

u1(cid:45) ¬∑ ¬∑ ¬∑

x0

ON APPROXIMATE OPACITY OF CYBER-PHYSICAL SYSTEMS

23

Moreover, one has

(cid:40)

qn ‚à© q(cid:48)

n =

x(cid:48)
n ‚àà X :

‚àÉx(cid:48)

u(cid:48)
n+m(cid:45) x(cid:48)
s.t. maxi‚àà{0,1,...,n+m} d(H(xi), H(x(cid:48)

0 ‚àà X0, ‚àÉx(cid:48)
0

u(cid:48)
1(cid:45) ¬∑ ¬∑ ¬∑

(cid:41)

.

n+m
i)) ‚â§ Œ¥
u(cid:48)
1(cid:45) ¬∑ ¬∑ ¬∑

n ‚äÜ XS, we know that there does not exist x(cid:48)

n ‚àà X \ XS and maxi‚àà{0,1,...,n+m} d(H(xi), H(x(cid:48)

n+m such
i)) ‚â§ Œ¥. Therefore, the system is not Œ¥-approximate

0 ‚àà X0 and x(cid:48)
0

u(cid:48)
n+m(cid:45) x(cid:48)

However, since qn ‚à© q(cid:48)
that x(cid:48)
inÔ¨Ånite-step opaque.

(‚áê) By contradiction: suppose that equation (4.3) holds and assume, for the sake of contradiction, that S is
not Œ¥-approximate inÔ¨Ånite-step opaque. Then, we know that there exists an initial state x0 ‚àà X0, a sequence
un(cid:45) xn and an index k ‚àà {0, . . . , n} such that xk ‚àà XS and there does
of transitions x0
u(cid:48)
1(cid:45) x(cid:48)
not exist an initial state x(cid:48)
n such that
1
x(cid:48)
k ‚àà X \ XS and maxi‚àà{0,1,...,n} d(H(xi), H(x(cid:48)
i)) ‚â§ Œ¥. Let us consider the following sequence of transitions in
SC

u2(cid:45) ¬∑ ¬∑ ¬∑
0 ‚àà X0 and a sequence of transitions x(cid:48)
0

u(cid:48)
2(cid:45) ¬∑ ¬∑ ¬∑

u(cid:48)
n(cid:45) x(cid:48)

u1(cid:45) x1

(x0, q0)

(cid:45) (x1, q1)

u1
C

(cid:45) ¬∑ ¬∑ ¬∑
u2
C

(cid:45) (xk, qk),

uk
C

and the following sequence of transitions in SI

(xn, q(cid:48)

n)

(cid:45) (xn‚àí1, q(cid:48)

n‚àí1)

un
I

un‚àí1

(cid:45) ¬∑ ¬∑ ¬∑

I

uk+1

(cid:45) (xk, q(cid:48)

k).

I

By Propositions 4.2 and 4.6, we know that

qn ‚à© q(cid:48)

n =

(cid:26)
k ‚àà X : ‚àÉx(cid:48)
x(cid:48)

0 ‚àà X0, ‚àÉx(cid:48)
0

u(cid:48)
1(cid:45) ¬∑ ¬∑ ¬∑

u(cid:48)
n(cid:45) x(cid:48)

n s.t.

max
i‚àà{0,1,...,n}

d(H(xi), H(x(cid:48)

i)) ‚â§ Œ¥

(cid:27)

.

Since equation (4.3) holds, we know that qn ‚à© q(cid:48)
transitions x(cid:48)
0
contradiction. Therefore, S has to be Œ¥-approximate inÔ¨Ånite-step opaque.

u(cid:48)
1(cid:45) ¬∑ ¬∑ ¬∑

n such that xk ‚àà X \ XS and maxi‚àà{0,1,...,n} d(H(xi), H(x(cid:48)

n (cid:54)‚äÜ XS. Therefore, there exists x(cid:48)

0 ‚àà X0 and a sequence of
i)) ‚â§ Œ¥ , which is a
(cid:3)

u(cid:48)
n(cid:45) x(cid:48)

References

[BDT18]

[BKMR08]

[BMS15]

[CDM12]

[CFML18]

[CIK17]

[CMPM14]

[DDM10]

F. Basile and G. De Tommasi. An algebraic characterization of language-based opacity in labeled Petri nets. In
14th International Workshop on Discrete Event Systems, pages 329‚Äì336, 2018.
J. W. Bryans, M. Koutny, L. Mazar¬¥e, and P. Y. A. Ryan. Opacity generalised to transition systems. International
Journal of Information Security, 7(6):421‚Äì435, Nov 2008.
B. B¬¥erard, J. Mullins, and M. Sassolas. Quantifying opacity. Math. Structures in Computer Science, 25(2):361‚Äì403,
2015.
F. Cassez, J. Dubreil, and H. Marchand. Synthesis of opaque systems with static and dynamic masks. Formal
Methods in System Design, 40(1):88‚Äì115, 2012.
X. Cong, M.P. Fanti, A.M. Mangini, and Z. Li. On-line veriÔ¨Åcation of current-state opacity by petri nets and integer
linear programming. Automatica, 94:205‚Äì213, 2018.
J. Chen, M. Ibrahim, and R. Kumar. QuantiÔ¨Åcation of secrecy in partially observed stochastic discrete event
systems. IEEE Trans. Automation Science and Engineering, 14(1):185‚Äì195, 2017.
S. Ch¬¥edor, C. Morvan, S. Pinchinat, and H. Marchand. Diagnosis and opacity problems for inÔ¨Ånite state systems
modeled by recursive tile systems. Discrete Event Dynamic Systems, 25(1-2):271‚Äì294, 2014.
J. Dubreil, P. Darondeau, and H. Marchand. Supervisory control for opacity. IEEE Trans. Aut. Cont., 55(5):1089‚Äì
1100, 2010.

[FDSPDB18] G. Fiore, E. De Santis, G. Pola, and M.D. Di Benedetto. On approximate predictability of metric systems. In 6th

[GP07]

[GPT10]

[JLF16]

[JWL18]

IFAC Conference on Analysis and Design of Hybrid Systems, pages 169‚Äì174, 2018.
A. Girard and G. J. Pappas. Approximation metrics for discrete and continuous systems. IEEE Transactions on
Automatic Control, 52(5):782‚Äì798, May 2007.
A. Girard, G. Pola, and P. Tabuada. Approximately bisimilar symbolic models for incrementally stable switched
systems. IEEE Transactions on Automatic Control, 55(1):116‚Äì126, 2010.
R. Jacob, J.-J. Lesage, and J.-M. Faure. Overview of discrete event systems opacity: Models, validation, and
quantiÔ¨Åcation. Annual Reviews in Control, 41:135‚Äì146, 2016.
Y. Ji, Y.-C. Wu, and S. Lafortune. Enforcement of opacity by public and private insertion functions. Automatica,
93:369‚Äì378, 2018.

24

[KH13]

[KH18]

[KK12]

[Lin11]
[LLH18]

[Maz04]

[MJL18]

X. YIN AND M. ZAMANI

K. Kobayashi and K. Hiraishi. VeriÔ¨Åcation of opacity and diagnosability for pushdown systems. Journal of Applied
Mathematics, 2013, 2013.
C. Keroglou and C.N. Hadjicostis. Probabilistic system opacity in discrete event systems. Discrete Event Dyn. Sys.:
Theory & Apl., 28(2):289‚Äì314, 2018.
K.-D. Kim and P.R. Kumar. Cyber‚Äìphysical systems: A perspective at the centennial. Proceedings of the IEEE,
100(Special Centennial Issue):1287‚Äì1308, 2012.
F. Lin. Opacity of discrete event systems and its applications. Automatica, 47(3):496‚Äì503, March 2011.
S. Lafortune, F. Lin, and C.N. Hadjicostis. On the history of diagnosability and opacity in discrete event systems.
Annual Reviews in Control, 45:257‚Äì266, 2018.
L. Mazar¬¥e. Using uniÔ¨Åcation for opacity properties. Proceedings of the Workshop on Issues in the Theory of Security,
7:165‚Äì176, 2004.
S. Mohajerani, Y. Ji, and S. Lafortune. EÔ¨Écient synthesis of edit functions for opacity enforcement using
bisimulation-based abstractions. In IEEE Conference on Decision and Control, pages 4849‚Äì4854, 2018.

[NHLH18a] M. Noori-Hosseini, B. Lennartson, and C. Hadjicostis. Compositional visible bisimulation abstraction applied to

opacity veriÔ¨Åcation. In 14th International Workshop on Discrete Event Systems, pages 434‚Äì441, 2018.

[NHLH18b] M. Noori-Hosseini, B. Lennartson, and C. Hadjicostis. Incremental observer reduction applied to opacity veriÔ¨Åcation

and synthesis. arXiv:1812.08083, 2018.

[PDSDB18] G. Pola, E. De Santis, and M.D. Di Benedetto. Approximate diagnosis of metric systems. IEEE Control Systems

[RCM16a]

[RCM16b]

[RCM17]

[Rei11]

[SAJ15]

[SGZ17]

[SH11]

[SH12]

[SH13]

[SH14]

[Tab09]

Letters, 2(1):115‚Äì120, 2018.
B. Ramasubramanian, R. Cleaveland, and S.I. Marcus. A framework for decentralized opacity in linear systems. In
54th Annual Allerton Conference on Communication, Control, and Computing, pages 274‚Äì280, 2016.
B. Ramasubramanian, R. Cleaveland, and S.I. Marcus. A framework for opacity in linear systems. In American
Control Conference, pages 6337‚Äì6344, 2016.
B. Ramasubramanian, R. Cleaveland, and S.I. Marcus. Opacity for switched linear systems: Notions and charac-
terization. In 56th IEEE Conference on Decision and Control, pages 5310‚Äì5315, 2017.
G. Reissig. Computing abstractions of nonlinear systems. IEEE Transactions on Automatic Control, 56(11):2583‚Äì
2598, Nov 2011.
H. Sandberg, S. Amin, and K.H. Johansson. Cyberphysical security in networked control systems. IEEE Control
Systems, 35(1):20‚Äì23, 2015.
A. Swikir, A. Girard, and M. Zamani. From dissipativity theory to compositional synthesis of symbolic models.
arXiv: 1710.05585, October 2017.
A. Saboori and C.N. Hadjicostis. VeriÔ¨Åcation of K-Step Opacity and Analysis of Its Complexity. IEEE Transactions
on Automation Science and Engineering, 8(3):549‚Äì559, July 2011.
A. Saboori and C.N. Hadjicostis. VeriÔ¨Åcation of inÔ¨Ånite-step opacity and complexity considerations. IEEE Trans-
actions on Automatic Control, 57(5):1265‚Äì1269, May 2012.
A. Saboori and C.N. Hadjicostis. VeriÔ¨Åcation of initial-state opacity in security applications of discrete event
systems. Information Sciences, 246:115‚Äì132, 2013.
A. Saboori and C.N. Hadjicostis. Current-state opacity formulations in probabilistic Ô¨Ånite automata. IEEE Trans-
actions on Automatic Control, 59(1):120‚Äì133, 2014.
P. Tabuada. VeriÔ¨Åcation and Control of Hybrid Systems: A Symbolic Approach. Springer Publishing Company, 1st
edition, 2009.

[TLSG17a] Y. Tong, Z. Li, C. Seatzu, and A. Giua. Decidability of opacity veriÔ¨Åcation problems in labeled Petri net systems.

Automatica, 80:48‚Äì53, 2017.

[TLSG17b] Y. Tong, Z. Li, C. Seatzu, and A. Giua. VeriÔ¨Åcation of state-based opacity using petri nets. IEEE Transactions on

[TLSG18]

[Tra18]

[WL13]

[WL18]

[WLL18]

[YL16]

[YL17]

[YLWL19]

Automatic Control, 62(6):2823‚Äì2837, 2017.
Y. Tong, Z. Li, C. Seatzu, and A. Giua. Current-state opacity enforcement in discrete event systems under incom-
parable observations. Discrete Event Dynamic Systems: Theory & Appllications, 28(2):161‚Äì182, 2018.
D. N. Tran. Advances in stability analysis for nonlinear discrete-time dynamical systems. PhD thesis, The Univer-
sity of Newcastle, 2018.
Y. Wu and S. Lafortune. Comparative analysis of related notions of opacity in centralized and coordinated archi-
tectures. Discrete Event Dynamic Systems, 23(3):307‚Äì339, Sep 2013.
B. Wu and H. Lin. Privacy veriÔ¨Åcation and enforcement via belief abstraction. IEEE Control Systems Letters,
2(4):815‚Äì820, 2018.
B. Wu, Z. Liu, and H. Lin. Parameter and insertion function co-synthesis for opacity enhancement in parametric
stochastic discrete event systems. In American Control Conference, pages 3032‚Äì3037, 2018.
X. Yin and S. Lafortune. A uniform approach for synthesizing property-enforcing supervisors for partially-observed
discrete-event systems. IEEE Trans. Aut. Cont., 61(8):2140‚Äì2154, 2016.
X. Yin and S. Lafortune. A new approach for the veriÔ¨Åcation of inÔ¨Ånite-step and K-step opacity using two-way
observers. Automatica, 80:162‚Äì171, 2017.
X. Yin, Z. Li, W. Wang, and S. Li. InÔ¨Ånite-step opacity and K-step opacity of stochastic discrete-event systems.
Automatica, 99:266‚Äì274, 2019.

ON APPROXIMATE OPACITY OF CYBER-PHYSICAL SYSTEMS

25

[YZ19]

[ZAG15]

X. Yin and M. Zamani. Towards approximate opacity of cyber-physical systems. In 10th ACM/IEEE International
Conference on Cyber-Physical Systems, 2019.
M. Zamani, A. Abate, and A. Girard. Symbolic models for stochastic switched systems: A discretization and a
discretization-free approach. Automatica, 55:183‚Äì196, 2015.

[ZPMT12] M. Zamani, G. Pola, M. Mazo, and P. Tabuada. Symbolic models for nonlinear control systems without stability

[ZSL15]

[ZYZ18]

assumptions. IEEE Transactions on Automatic Control, 57(7):1804‚Äì1809, July 2012.
B. Zhang, S. Shu, and F. Lin. Maximum information release while ensuring opacity in discrete event systems. IEEE
Transactions on Automation Science and Engineering, 12(3):1067‚Äì1079, 2015.
K. Zhang, X. Yin, and M. Zamani. Opacity of nondeterministic transition systems: A (bi)simulation relation
approach. https: // arxiv. org/ abs/ 1802. 03321 , 2018.

1Department of Automation, Shanghai Jiao Tong University, Shanghai, China.

E-mail address: yinxiang@sjtu.edu.cn

2Computer Science Department, University of Colorado Boulder, CO 80309, USA.

E-mail address: majid.zamani@colorado.edu

