9
1
0
2

b
e
F
5
2

]

Y
S
.
s
c
[

1
v
1
1
4
9
0
.
2
0
9
1
:
v
i
X
r
a

ON APPROXIMATE OPACITY OF CYBER-PHYSICAL SYSTEMS

XIANG YIN1 AND MAJID ZAMANI2

Abstract. Opacity is an important information-ﬂow security property in the analysis of cyber-physical sys-
tems. It captures the plausible deniability of the system’s secret behavior in the presence of an intruder that
may access the information ﬂow. Existing works on opacity only consider non-metric systems by assuming
that the intruder can always distinguish two diﬀerent outputs precisely. In this paper, we extend the concept
of opacity to systems whose output sets are equipped with metrics. Such systems are widely used in the
modeling of many real-world systems whose measurements are physical signals. A new concept called approx-
imate opacity is proposed in order to quantitatively evaluate the security guarantee level with respect to the
measurement precision of the intruder. Then we propose a new simulation-type relation, called approximate
opacity preserving simulation relation, which characterizes how close two systems are in terms of the satis-
faction of approximate opacity. This allows us to verify approximate opacity for large-scale, or even inﬁnite
systems, using their abstractions. We also discuss how to construct approximate opacity preserving symbolic
models for a class of discrete-time control systems. Our results extend the deﬁnitions and analysis techniques
for opacity from non-metric systems to metric systems.

1. Introduction

1.1. Motivations. Cyber-physical systems (CPS) are complex systems resulting from tight interactions of
dynamical systems and computational devices. Such systems are generally very complex posing both contin-
uous and discrete behaviors which makes the veriﬁcation and design of such systems signiﬁcantly challenging.
In particular, components in CPS are usually connected via communication networks in order to acquire
and exchange information so that some global functionality of the system can be achieved. However, this
also brings new challenges for the veriﬁcation and design of CPS since the communication between system
components may release information that might compromise the security of the system. Therefore, how to
analyze and enforce security for CPS is becoming an increasingly important issue and has drawn considerable
attention in the literature in the past few years [KK12, SAJ15].

In this paper, we investigate an important information-ﬂow security property called opacity. Roughly speaking,
opacity is a conﬁdentiality property that captures whether or not the “secret” of the system can be revealed
to an intruder that can infer the system’s actual behavior based on the information ﬂow. A system is said
to be opaque if it always has the plausible deniability for any of its secret behavior. The concept of opacity
was originally proposed in the computer science literature as a uniﬁed notion for several security properties
[Maz04, BKMR08]. Since then, opacity has been studied more extensively in the context of Discrete-Event
Systems (DES), an important class of event-driven dynamical systems with discrete state spaces. For example,
in [SH11, SH12, SH13], several state-based notions of opacity were proposed, which include current-state
opacity, initial-state opacity, K-step opacity and inﬁnite-step opacity. In [Lin11], the author proposed two
language-based opacity called strong opacity and weak opacity and investigated their relationships with some
In [WL13], transformation algorithms among diﬀerent notions of opacity were proposed.
other properties.
The above mentioned works mainly consider DES modeled by ﬁnite-state automata. More recently, the
deﬁnitions and veriﬁcation algorithms for diﬀerent notions of opacity have been extended to other classes of
(discrete) systems, including Petri nets [TLSG17a, TLSG17b, CFML18, BDT18], stochastic systems [SH14,
KH18, WLL18], recursive tile systems [CMPM14] and pushdown systems [KH13]. The interested readers are
referred to recent surveys [JLF16, LLH18] for more references and recent developments on this active research
area.

1

 
 
 
 
 
 
2

X. YIN AND M. ZAMANI

Since opacity is an information-ﬂow property, its deﬁnition strictly depends on the information model of the
system. Most of the existing works in the literature formulate opacity by adopting the event-based observation
model, i.e., some events of the system (either transition labels or state labels) are observable or distinguishable
while some are not. This essentially assumes that the output of the system is symbolic in the sense that we
can precisely distinguish two outputs with diﬀerent labels. Hereafter, we will also refer to opacity under this
setting as exact opacity. Exact opacity is very meaningful for systems whose output sets are non-metric, e.g.,
discrete systems whose outputs are logic events. However, for many real-world applications whose outputs
are physical signals, instead of just saying that two events are distinguishable or indistinguishable, we may
have a measurement to quantitatively evaluate how close two outputs are. Such systems are referred to as
metric systems, where the output sets are equipped with appropriate metrics. For metric systems, if two
signals are very close to each other, then it will be very hard to distinguish them unambiguously due to
the measurement precision or potential measurement noises. A typical example of this scenario is linear
or nonlinear discrete-time control systems with continuous state-spaces and continuous output mappings.
Therefore, existing deﬁnitions of opacity are too strong for metric systems since they implicitly assume that
the intruder can always distinguish two output signals even when they are arbitrarily close to each other,
which is not practical.

1.2. Our Contributions. In this paper, we propose a new concept called approximate opacity that is more
In particular, we treat two outputs as “indistinguishable” outputs if their
applicable to metric systems.
distance is smaller than a given threshold parameter δ ≥ 0. We consider three basic types of opacity, initial-
state opacity, current-state opacity and inﬁnite-step opacity, and propose three new notions of opacity as
their approximate counterparts. For example, δ-approximate initial-state opacity (respectively, δ-approximate
current-state opacity) requires that, for any state run starting from a secret state (respectively, leading to
a secret state), there exists another state run starting from a non-secret state (respectively, leading to a
non-secret state), such that their corresponding output runs are δ-close to each other. By “δ-close”, we
mean that the largest distance between two output runs is smaller than δ. Intuitively, δ-approximate initial-
state opacity (respectively, δ-approximate current-state opacity) says that the intruder can never determine
that the system is initiated from a secret state (respectively, currently at a secret state) if it does not have
an enough measurement precision which is captured by parameter δ. Similarly, δ-approximate inﬁnite-step
opacity requires that the intruder can never determine that the system was at secret state for any speciﬁc
instant if its measurement precision is no more than δ. In other words, instead of requiring that the system is
exactly opaque, our new deﬁnitions essentially provide relaxed versions of opacity with a quantitative security
guarantees level with respect to the measurement precision of the intruder. Clearly, approximate opacity boils
down to the exact one when δ = 0. Eﬀective veriﬁcation algorithms are also provided to verify approximate
opacity for the case of ﬁnite systems.

It is worth noting that the complexity of verifying exact opacity is already PSPACE-hard [CDM12]. As a
generalization of exact opacity, verifying approximate opacity unavoidably requires very high computational
complexity. Therefore, for systems whose state-spaces are very large or even inﬁnite, it is desirable to construct
abstract models that preserve opacity, to some extent, for the propose of veriﬁcation. To this end, for each
type of approximate opacity, we propose the concept of ε-approximate opacity preserving simulation relation.
The proposed simulation relations characterize how close two systems are, speciﬁed by parameter ε ≥ 0, in
terms of the satisfaction of approximate opacity. More speciﬁcally, we show that if there is an ε-approximate
opacity preserving simulation relation from system Sa to system Sb, then Sb being δ-approximate opaque
implies that Sa is (δ + 2ε)-approximate opaque. In particular, for a class of incrementally input-to-state stable
discrete-time control systems with possibly inﬁnite state-spaces, we propose an eﬀective approach to construct
symbolic models (a.k.a. ﬁnite abstractions) that approximately simulate the original systems in the sense of
opacity preserving and vice versa. The resulting symbolic model is ﬁnite if the state-space of the original
continuous system is within a bounded region. Therefore, the proposed abstraction technique together with
the veriﬁcation algorithm for the ﬁnite case provide a sound way for verifying opacity of discrete-time control
systems with continuous state-spaces.

ON APPROXIMATE OPACITY OF CYBER-PHYSICAL SYSTEMS

3

1.3. Related Works. Our work is closely related to several works in the literature. First, several diﬀerent ap-
proaches have been proposed in the literature to evaluate opacity more quantitatively rather than requiring that
the system is opaque exactly [SH14, BMS15, CIK17, YLWL19]. For example, in [CIK17], the authors adopt
the Jensen-Shannon divergence as the measurement to quantify secrecy loss. In [SH14, BMS15, YLWL19], sto-
chastic DES models are used to study the probabilistic measurement of opacity. These approaches essentially
aim to analyze how opaque a single system is, e.g., the probability of being opaque. However, they neither
consider how close two systems are in terms of being opaque nor consider under what observation precision
level, we can guarantee opacity.

There are also attempts in the literature that extend opacity from discrete systems to continuous systems.
For example, in the recent results in [RCM16b, RCM16a, RCM17], the authors extended the notion of opacity
to (switched) linear systems. However, their deﬁnition of opacity is more related to an output reachability
property rather than an information-ﬂow property. Moreover, their formulation is mostly based on the setting
of exact opacity, i.e., we can always distinguish two diﬀerent outputs precisely no matter how close they
are, In [RCM16b], the authors mentioned the direction of using output metric to quantify opacity and a
property called strong (cid:15)-K-initial-state opacity was proposed, which is closely related to our notions. However,
no systematic study, e.g., veriﬁcation and abstraction as we consider in this paper, was provided for this
property.

Regarding the techniques used in this paper, ﬁrst, our algorithms for the veriﬁcation of approximate notions of
opacity are motivated by the veriﬁcation algorithms for exact opacity studied in [SH11, YL17]. In particular, we
use the idea of constructing a new system, called the state-estimator, that tracks all possible states consistent
with the observation. However, our construction of state-estimator is not exactly the same as the existing one
as additional state information is needed in order to handle the issue of approximation.

Abstraction-based techniques have also been investigated in the literature for the veriﬁcation and synthesis of
opacity; see, e.g., [ZYZ18, NHLH18a, NHLH18b, WL18, MJL18]. In particular, in our recent work [ZYZ18], we
propose several notions of opacity preserving (bi)simulation relations. However, these relations only preserve
exact opacity for non-metric systems. Our new relations extend the relations in [ZYZ18] to metric systems by
taking into account how close two systems are. Such an extension is motivated by the deﬁnition of approx-
imate (bi)simulation relation originally proposed in [GP07]. However, the original deﬁnition of approximate
(bi)simulation relation does not necessarily preserves approximate opacity. Constructing symbolic models for
control systems is also an active research area; see, e.g., [GPT10, Rei11, ZPMT12, ZAG15]. However, most of
the existing works on the construction of symbolic models only consider the dynamics of the systems and are
not taking into account the opacity property. In our approach, we need to consider both the dynamic and the
secret of the system while constructing the symbolic model and guarantee the preservation of approximate
opacity across related systems.

Finally, approximate notions of two related properties called diagnosability and predictability are investigated
recently in [PDSDB18, FDSPDB18]. Their setting is very similar to us as we both consider a measurement
uncertainty threshold. However, diagnosability and predictability are language-based properties, which can be
preserved by standard approximate simulation relation. Our notions of opacity are state-based and we show
that standard approximate simulation relation does not preserve opacity. Therefore, the proposed approximate
opacity preserving simulation relation is diﬀerent from the standard approximate simulation relation in the
literature.

In Section 2, we ﬁrst introduce some
1.4. Organization. The rest of this paper is organized as follows.
necessary preliminaries. Then we propose the concept of approximate opacity in Section 3. The veriﬁcation
procedures for approximate opacity are provided in Section 4. In Section 5, approximate opacity preserving
simulation relations are proposed and their properties are also discussed.
In Section 6, we describe how
to construct approximate opacity preserving symbolic models for incrementally stable discrete-time control
systems with continuous state-spaces. Finally, we conclude the paper by Section 7. Preliminary and partial
version of this paper is presented as an extended abstract in [YZ19].

4

X. YIN AND M. ZAMANI

2. Preliminaries

2.1. Notation. The symbols N, N0, Z, R, R+, and R+
0 denote the set of natural, nonnegative integer, integer,
real, positive, and nonnegative real numbers, respectively. Given a vector x ∈ Rn, we denote by xi the i–th
element of x, and by (cid:107)x(cid:107) the inﬁnity norm of x.
The closed ball centered at u ∈ Rm with radius λ is deﬁned by Bλ(u) = {v ∈ Rm | (cid:107)u − v(cid:107) ≤ λ}. A set
B ⊆ Rm is called a box if B = (cid:81)m
i=1[ci, di], where ci, di ∈ R with ci < di for each i ∈ {1, . . . , m}. The span
of a box B is deﬁned as span(B) = min{|di − ci| | i = 1, . . . , m}. For a box B ⊆ Rm and µ ≤ span(B),
deﬁne the µ-approximation [B]µ = [Rm]µ ∩ B, where [Rm]µ = {a ∈ Rm | ai = kiµ, ki ∈ Z, i = 1, . . . , m}.
Remark that [B]µ (cid:54)= ∅ for any µ ≤ span(B). Geometrically, for any µ ∈ R+ with µ ≤ span(B) and λ ≥ µ,
the collection of sets {Bλ(p)}p∈[B]µ is a ﬁnite covering of B, i.e. B ⊆ (cid:83)
Bλ(p). We extend the notions of
p∈[B]µ
span and approximation to ﬁnite unions of boxes as follows. Let A = (cid:83)M
j=1 Aj, where each Aj is a box. Deﬁne
span(A) = min{span(Aj) | j = 1, . . . , M }, and for any µ ≤ span(A), deﬁne [A]µ = (cid:83)M
j=1[Aj]µ.
Given a function f : N+
0 → Rn, the (essential) supremum of f is denoted by (cid:107)f (cid:107)∞ := (ess)sup{(cid:107)f (k)(cid:107), k ≥ 0}.
A continuous function γ : R+
0 is said to belong to class K if it is strictly increasing and γ(0) = 0; γ is
said to belong to class K∞ if γ ∈ K and γ(r) → ∞ as r → ∞. A continuous function β : R+
0 is
said to belong to class KL if, for each ﬁxed s, the map β(r, s) belongs to class K with respect to r and, for
each ﬁxed nonzero r, the map β(r, s) is decreasing with respect to s and β(r, s) → 0 as s → ∞. We identify a
relation R ⊆ A × B with the map R : A → 2B deﬁned by b ∈ R(a) iﬀ (a, b) ∈ R. Given a relation R ⊆ A × B,
R−1 denotes the inverse relation deﬁned by R−1 = {(b, a) ∈ B × A : (a, b) ∈ R}.

0 → R+

0 → R+

0 × R+

2.2. System Model. In this paper, we employ a notion of “system” introduced in [Tab09] as the underlying
model of CPS describing both continuous-space and ﬁnite control systems.

Deﬁnition 2.1. A system S is a tuple

where

S = (X, X0, U, (cid:45) , Y, H),

(2.1)

• X is a (possibly inﬁnite) set of states;
• X0 ⊆ X is a (possibly inﬁnite) set of initial states;
• U is a (possibly inﬁnite) set of inputs;
• (cid:45) ⊆ X × U × X is a transition relation;
• Y is a set of outputs;
• H : X → Y is an output map.

A transition (x, u, x(cid:48)) ∈ (cid:45) is also denoted by x
u(cid:45) x(cid:48), state x(cid:48) is called a
u-successor, or simply a successor, of state x; state x is called a u-predecessor, or simply a predecessor, of state
x(cid:48). We denote by Postu(x) the set of all u-successors of state x and by Preu(x) the set of all u-predecessors
of state x. For a set of states q ∈ 2X , we deﬁne Postu(q) = ∪x∈qPostu(x) and Preu(q) = ∪x∈qPreu(x). A
system S is said to be

u(cid:45) x(cid:48). For a transition x

• metric, if the output set Y is equipped with a metric d : Y × Y → R+
0 ;
• ﬁnite (or symbolic), if X and U are ﬁnite sets;
• deterministic, if for any state x ∈ X and any input u ∈ U , |Postu(x)| ≤ 1 and nondeterministic

otherwise.

Given a system S = (X, X0, U, (cid:45) , Y, H) and any initial state x0 ∈ X0, a ﬁnite state run generated from
x0 is a ﬁnite sequence of transitions:

x0

u1(cid:45) x1

u2(cid:45) · · ·

un−1(cid:45) xn−1

un(cid:45) xn,

(2.2)

ON APPROXIMATE OPACITY OF CYBER-PHYSICAL SYSTEMS

5

ui+1(cid:45) xi+1 for all 0 ≤ i < n. A ﬁnite state run can be readily extended to an inﬁnite state run
such that xi
as well. A ﬁnite output run is a sequence y0y1 . . . yn such that there exists a ﬁnite state run of the form (2.2)
with yi = H(xi), for i = 0, . . . , n. A ﬁnite output run can also be directly extended to an inﬁnite output run
as well.

3. Exact and Approximate Opacity

In this section, we ﬁrst review the notion of exact opacity. Then we introduce the notion of approximate
opacity.

3.1. Exact Opacity. In many applications, systems may have some “secrets” that do not want to be revealed
to intruders that are potentially malicious.
In this paper, we adopt a state-based formulation of secrets.
Speciﬁcally, we assume that XS ⊆ X is a set of secret states. Hereafter, we will always consider systems
with secret states and we write a system S = (X, X0, U, (cid:45) , Y, H) with secret states XS by a new tuple
S = (X, X0, XS, U, (cid:45) , Y, H).
In order to characterize whether or not a system is secure, the concept of opacity was proposed in the literature.
We review three basic notions of opacity [WL13] as follows.
Deﬁnition 3.1. Consider a system S = (X, X0, XS, U, (cid:45) , Y, H). System S is said to be

• initial-state opaque if for any x0 ∈ X0 ∩ XS and ﬁnite state run x0
u(cid:48)
n(cid:45) x(cid:48)

0 ∈ X0 \ XS and a ﬁnite state run x(cid:48)
0

u(cid:48)
2(cid:45) · · ·

u(cid:48)
1(cid:45) x(cid:48)

1

there exist x(cid:48)
for any i = 0, 1, . . . , n;

un(cid:45) xn,
u2(cid:45) · · ·
u1(cid:45) x1
n such that H(xi) = H(x(cid:48)
i)

• current-state opaque if for any x0 ∈ X0 and ﬁnite state run x0
u(cid:48)
2(cid:45) · · ·

0 ∈ X0 and ﬁnite state run x(cid:48)
0

u(cid:48)
1(cid:45) x(cid:48)

1

i) for any i = 0, 1, . . . , n;
• inﬁnite-step opaque if for any x0 ∈ X0 and ﬁnite state run x0

xn ∈ XS, there exist x(cid:48)
and H(xi) = H(x(cid:48)

xk ∈ XS for some k = 0, . . . n, there exist x(cid:48)
such that x(cid:48)

k ∈ X \ XS and H(xi) = H(x(cid:48)

i) for any i = 0, 1, . . . , n.

u1(cid:45) x1
0 ∈ X0 and ﬁnite state run x(cid:48)
0

u2(cid:45) · · ·
u(cid:48)
1(cid:45) x(cid:48)

1

un(cid:45) xn such that
u(cid:48)
u(cid:48)
n(cid:45) x(cid:48)
2(cid:45) · · ·

n

u1(cid:45) x1
u(cid:48)
n(cid:45) x(cid:48)

u2(cid:45) · · ·
n such that x(cid:48)

un(cid:45) xn such that
n ∈ X \XS

The intuitions of the above deﬁnitions are as follows. Suppose that the output run of the system can be
observed by a passive intruder that may use this information to infer the secret of the system. Then initial-
state opacity requires that the intruder should never know for sure that the system is initiated from a secret
state no matter what output run is generated. Similarly, current-state opacity says that the intruder should
never know for sure that the system is currently at a secret state no matter what output run is generated.
Inﬁnite-step opacity is stronger than both initial-state opacity and current-state opacity as it requires that the
intruder should never know that the system is/was at a secret state for any speciﬁc instant k. For any system
S = (X, X0, XS, U, (cid:45) , Y, H), we assume without loss of generality that ∀x0 ∈ X0 : {x ∈ X0 : H(x) =
H(x0)} (cid:54)⊆ XS. This assumption essentially requires that the secret of the system cannot be revealed initially;
otherwise, the system is not opaque trivially.

Remark 3.2. Deﬁnition 3.1 implicitly assumes that the intruder only has the output information of the
system. In other words, the input information is assumed to be internal and intruder does not know which
input the system takes. This setting can be easily relaxed and all results in this paper can be extended to the
case where both input and output information are available by the intruder. For example, we can simply reﬁne
the model of the system such that the output space of the reﬁned system is a pair and the input leading to a
state is also encoded in the output of this state.

6

X. YIN AND M. ZAMANI

3.2. Approximate Opacity. Note that Deﬁnition 3.1 requires that for any secret behavior, there exists a
non-secret behavior such that they generate exactly the same output. Therefore, we will also refer to these
deﬁnitions as exact opacity. Exact opacity essentially assumes that the intruder or the observer can always
measure each output or distinguish between two diﬀerent outputs precisely. This setting is reasonable for
non-metric systems where outputs are symbols or events. However, for metric systems, e.g., when the outputs
are physical signals, this setting may be too restrictive.
In particular, due to the imperfect measurement
precision, which is almost the case for all physical systems, it is very diﬃcult to distinguish two observations
if their diﬀerence is very small. Therefore, exact opacity may be too strong for metric systems and it will be
useful to deﬁne a weak and “robust” version of opacity by characterizing under which measurement precision
the system is opaque. To this end, we deﬁne new notions of opacity called approximate opacity for metric
systems.
Deﬁnition 3.3. Let S = (X, X0, XS, U, (cid:45) , Y, H) be a metric system, with the metric d deﬁned over the
output set, and a constant δ ≥ 0. System S is said to be

un(cid:45) xn, there exist x(cid:48)

• δ-approximate initial-state opaque if for any x0 ∈ X0∩XS and ﬁnite state run x0
0 ∈ X0 \ XS and a ﬁnite state run x(cid:48)
0
i)) ≤ δ

d(H(xi), H(x(cid:48)

u(cid:48)
2(cid:45) · · ·

u(cid:48)
1(cid:45) x(cid:48)

1

u(cid:48)
n(cid:45) x(cid:48)

max
i∈{0,...,n}

u2(cid:45) · · ·

u1(cid:45) x1
n such that

• δ-approximate current-state opaque if for any x0 ∈ X0 and ﬁnite state run x0
u1(cid:45) x(cid:48)

0 ∈ X0 and ﬁnite state run x(cid:48)
0

un(cid:45) xn such that xn ∈ XS, there exist x(cid:48)
such that x(cid:48)

n ∈ X \ XS and

1

max
i∈{0,...,n}

d(H(xi), H(x(cid:48)

i)) ≤ δ

u1(cid:45) x1
u(cid:48)
2(cid:45) · · ·

u2(cid:45) · · ·
u(cid:48)
n(cid:45) x(cid:48)

n

• δ-approximate inﬁnite-step opaque if for any x0 ∈ X0 and ﬁnite state run x0

x(cid:48)
0

u1(cid:45) x(cid:48)

un(cid:45) xn such that xk ∈ XS for some k = 0, . . . n, there exist x(cid:48)
n such that x(cid:48)
max
i∈{0,...,n}

k ∈ X \ XS and

d(H(xi), H(x(cid:48)

u(cid:48)
2(cid:45) · · ·

u(cid:48)
n(cid:45) x(cid:48)

i)) ≤ δ.

1

u2(cid:45) · · ·
u1(cid:45) x1
0 ∈ X0 and ﬁnite state run

The notions of δ-approximate initial-state, current-state opacity and inﬁnite-step opacity are very similar
to their exact counterparts. The main diﬀerence is how we treat two outputs as indistinguishable outputs.
Intuitively, the approximate version of opacity can be interpreted as “the secret of the system cannot be revealed
to an intruder that does not have an enough measurement precision related to parameter δ”. In other words,
instead of providing an exact security guarantee, approximate opacity provides a relaxed and quantitative
security guarantee with respect to the measurement precision of the intruder. Clearly, when δ = 0, each
notion of δ-approximate opacity reduces to its exact version. Similar to the exact case, hereafter, we assume
without loss of generality that

∀x0 ∈ X0 : {x ∈ X0 : d(H(x0), H(x)) ≤ δ} (cid:54)⊆ XS,
for any system S = (X, X0, XS, U, (cid:45) , Y, H). This assumption can be easily checked and its non-satisfaction
means that δ-approximate initial-state opacity, δ-approximate current-state opacity and δ-approximate inﬁnite-
step opacity are all violated trivially.

We illustrate exact opacity and approximate opacity by the following example.
Example 3.4. Consider system S = (X, X0, XS, U, (cid:45) , Y, H) depicted in Figure 1, where X = {A, B, C, D},
X0 = {A, B}, XS = {B}, U = {u}, H = {0.1, 0.15, 0.2, 0.35} ⊆ R and the output map is speciﬁed by the value
associated to each state. Clearly, none of exact initial-state opacity, exact current-state opacity and exact
inﬁnite-step opacity is satisﬁed since we know immediately that the system is at secret state B when value 0.1
is observed.

ON APPROXIMATE OPACITY OF CYBER-PHYSICAL SYSTEMS

7

Figure 1. An example for approximate opacity, where states marked by red denote secret
states, states marked by input arrows denote initial states and the output map is speciﬁed by
the value associated to each state.

Now, let us assume that the output set Y is equipped with metric d deﬁned by d(y1, y2) = |y1 − y2|. We claim
u(cid:45) B
that S is not 0.05-approximate current-state opaque. For example, let us consider ﬁnite run B
that generates output run [0.1][0.35][0.1]. However, there does not exists a ﬁnite run leading to a non-secret
state whose output run is 0.05-close to the above output run. To see this, in order to match the above output
run, we must consider a run starting from state B, since for the initial state A, we have d(H(A), H(B)) =
0.1 ≥ 0.05, and the next state reached can only be D. From state D, we can reach states A and B, but
d(H(A), 0.1) = 0.1 ≥ 0.05 =: δ. Therefore, the only ﬁnite run that approximately matches the above output
will end up with secret state B, i.e., we know unambiguously that the system is currently at a secret state
even when we cannot measure the output precisely. On the other hand, one can check that the system is
0.1-approximate current-state opaque.

u(cid:45) D

Similarly, system S is not 0.1-approximate initial-state opaque, since for output run [0.1][0.35] starting from
the secret state B, there is no run starting from a non-secret initial state that can approximately match it.
One can also check that the system is δ-approximate initial-state opaque only when δ ≥ 0.15. We will provide
formal procedures for verifying approximate opacity later.
Remark 3.5. Let S = (X, X0, XS, U, (cid:45) , Y, H) be a metric system. If the output map H is identity, i.e.
H(x) = x, ∀x ∈ X, then S is trivially not exactly opaque as in Deﬁnition 3.1 since we know the exact state of
the system directly. However, this is not the case for the approximate notions of opacity as in Deﬁnition 3.3
since the distance between a secret state and a non-secret state can be very small even if their values are not
exactly the same.

4. Verification of Approximate Opacity for Finite Systems

In this section, we show how to verify approximate opacity for ﬁnite systems. This will also provide the basis
for the veriﬁcation of approximate opacity for inﬁnite systems.

4.1. Veriﬁcation of Approximate Initial-State Opacity. In order to verify δ-approximate initial-state
opacity, we construct a new system called the δ-approximate initial-state estimator deﬁned as follows.
Deﬁnition 4.1. Let S = (X, X0, XS, U, (cid:45) , Y, H) be a metric system, with the metric d deﬁned over the
output set, and a constant δ ≥ 0. The δ-approximate initial-state estimator is a system (without outputs)

where

SI = (XI , XI0, U,

(cid:45) ),

I

• XI ⊆ X × 2X is the set of states;
• XI0 = {(x, q) ∈ X × 2X : x(cid:48) ∈ q ⇔ d(H(x), H(x(cid:48))) ≤ δ} is the set of initial states;
• U is the set of inputs, which is the same as the one in S;

ABCD𝑢𝑢𝑢𝑢𝑢𝑢[0.2][0.15][0.1][0.35]𝑢(𝐶,{𝐵,𝐶})(𝐴,{𝐴,𝐵,𝐶})(𝐵,{𝐵,𝐶})(𝐶,{𝐴,𝐵,𝐶})(𝐴,{𝐴})(𝐶,{𝐴,𝐵,𝐶})(𝐴,{𝐴,𝐵,𝐶,𝐷})(𝐵,{𝐴,𝐵,𝐶})(𝐷,{𝐴,𝐷})(𝐴,{𝐴,𝐷})𝑢𝑢𝑢𝑢𝑢𝑢𝑢𝑢(𝐵,{𝐴,𝐵,𝐶})(𝐷,{𝐷})𝑢𝑢𝑢𝑢𝑢𝑢𝑢𝑢𝑢𝑢𝑢𝑢8

•

(cid:45) ⊆ XI × U × XI is the transition function deﬁned by: for any (x, q), (x(cid:48), q(cid:48)) ∈ X × 2X and

I

X. YIN AND M. ZAMANI

u

(cid:45) (x(cid:48), q(cid:48)) if
u ∈ U , (x, q)
(1) (x(cid:48), u, x) ∈ (cid:45) ; and
(2) q(cid:48) = ∪ˆu∈U Preˆu(q) ∩ {x(cid:48)(cid:48) ∈ X : d(H(x(cid:48)), H(x(cid:48)(cid:48))) ≤ δ}.

I

For the sake of simplicity, we only consider the part of SI that is reachable from initial states.

Intuitively, the δ-approximate initial-state estimator works as follows. Each initial state of SI is a pair
consisting of a system state and its δ-closed states; we consider all each pairs as the set of initial states.
Then from each state, we track backwards states that are consistent with the output information recursively.
Our construction is motivated by the reversed-automaton-based initial-state-estimator proposed in [WL13]
but with the following diﬀerences. First, the way we deﬁned information-consistency is diﬀerent. Here we
treat states whose output are δ-close to each other as consistent states. Moreover, the structure in [WL13]
only requires a state space of 2X , while our state space is X × 2X . The additional ﬁrst component can be
understood as the “reference trajectory” that is used to determine what is “δ-close” at each instant. We use
the following result to show the main property of SI .

Proposition 4.2. Let S = (X, X0, XS, U,
output set, and a constant δ ≥ 0. Let SI = (XI , XI0, U,
Then for any (x0, q0) ∈ XI0 and any ﬁnite run

I

I

(cid:45) , Y, H) be a metric system, with the metric d deﬁned over the
(cid:45) ) be its δ-approximate initial-state estimator.

(x0, q0)

u1

(cid:45) (x1, q1)

I

(cid:45) · · ·
u2

I

un

(cid:45) (xn, qn)

I

we have

(i) xn

(ii) qn =

un(cid:45) xn−1
(cid:26)
0 ∈ X : ∃x(cid:48)
x(cid:48)
0

un−1(cid:45) · · ·
u(cid:48)
n(cid:45) x(cid:48)

1

u1(cid:45) x0; and
u(cid:48)
n−1(cid:45) · · ·

Proof. See the Appendix.

u(cid:48)
1(cid:45) x(cid:48)

n s.t. maxi∈{0,1,...,n} d(H(xi), H(x(cid:48)

n−i)) ≤ δ

(cid:27)

.

(cid:3)

The next theorem provides one of the main results of this section on the veriﬁcation of δ-approximate initial-
state opacity of ﬁnite metric systems.

Theorem 4.3. Let S = (X, X0, XS, U,
the output set, and a constant δ ≥ 0. Let SI = (XI , XI0, U,
Then, S is δ-approximate initial-state opaque if and only if

I

I

(cid:45) , Y, H) be a ﬁnite metric system, with the metric d deﬁned over
(cid:45) ) be its δ-approximate initial-state estimator.

Proof. See the Appendix.

∀(x, q) ∈ XI : x ∈ X0 ∩ XS ⇒ q ∩ X0 (cid:54)⊆ XS.

(4.1)

(cid:3)

We illustrate how to verify δ-approximate initial-state opacity by the following example.

Example 4.4. Let us still consider system S shown in Figure 1. The δ-approximate initial-state estimator SI
when δ = 0.1 is shown in Figure 2(a). For example, for initial state (D, {D}), we have (D, {D})

(cid:45) (B, {B, C})

u

I

u(cid:45) D and {B, C} = Preu({D}) ∩ {x ∈ X : d(H(x), 0.1) ≤ 0.1} = {B, C} ∩ {A, B, C}. However,
since B
for state (B, {B, C}) ∈ XI , we have B ∈ X0 ∩ XS and {B, C} ∩ X0 = {B} ⊆ XS. Therefore, by Theorem 4.3,
we know that the system is not 0.1-approximate initial-state opaque. Similarly, we can also construct SI for
the case of δ = 0.15, which is shown in Figure 2(b). Since for state (B, {A, B, C}) ∈ XI , which is the only
state whose ﬁrst component is in X0 ∩ XS, we have {A, B, C} ∩ X0 = {A, B} (cid:54)⊆ XS. By Theorem 4.3, we
know that the system is 0.15-approximate initial-state opaque.

ON APPROXIMATE OPACITY OF CYBER-PHYSICAL SYSTEMS

9

(a) SI when δ = 0.1

(b) SI when δ = 0.15

Figure 2. Examples of δ-approximate initial-state estimators.

4.2. Veriﬁcation of Approximate Current-State Opacity. In order to verify δ-approximate current-
state opacity, we also need to construct a new system called the δ-approximate current-state estimator deﬁned
as follows.
Deﬁnition 4.5. Let S = (X, X0, XS, U, (cid:45) , Y, H) be a metric system, with the metric d deﬁned over the
output set, and a constant δ ≥ 0. The δ-approximate current-state estimator is a system (without outputs)

where

SC = (XC, XC0, U,

(cid:45) ),

C

• XC ⊆ X × 2X is the set of states;
• XC0 = {(x, q) ∈ X0 ×2X0 : x(cid:48) ∈ q ⇔ d(H(x), H(x(cid:48))) ≤ δ} is the set of initial states;
• U is the set of inputs, which is the same as the one in S;
•

(cid:45) ⊆ XC × U × XC is the transition function deﬁned by: for any (x, q), (x(cid:48), q(cid:48)) ∈ X × 2X and

C

u

(cid:45) (x(cid:48), q(cid:48)) if
u ∈ U , (x, q)
(1) (x, u, x(cid:48)) ∈ (cid:45) ; and
(2) q(cid:48) = ∪ˆu∈U Postˆu(x) ∩ {x(cid:48)(cid:48) ∈ X : d(H(x(cid:48)), H(x(cid:48)(cid:48))) ≤ δ}.

C

For the sake of simplicity, we only consider the part of SC that is reachable from initial states.

The construction of SC is similar to SI . However, we need to track all forward runs from each pair of initial-
state and its information-consistent states. Still, we need the ﬁrst component as the “reference state” to
determine what are “δ-close” states. We use the following result to state the main properties of SC.
Proposition 4.6. Let S = (X, X0, XS, U, (cid:45) , Y, H) be a metric system, with the metric d deﬁned over the
(cid:45) ) be its δ-approximate current-state estimator.
output set, and a constant δ ≥ 0. Let SC = (XC, XC0, U,
Then for any (x0, q0) ∈ XC0 and any ﬁnite run

C

we have

(x0, q0)

u1

(cid:45) (x1, q1)

C

(cid:45) · · ·
u2

C

un

(cid:45) (xn, qn),

C

u1(cid:45) x1

u2(cid:45) · · ·

(i) x0
(ii) qn = {x(cid:48)

n ∈ X : ∃x(cid:48)

0 ∈ X0, ∃x(cid:48)
0

un(cid:45) xn; and
u(cid:48)
1(cid:45) x(cid:48)

1

u(cid:48)
2(cid:45) · · ·

u(cid:48)
n(cid:45) x(cid:48)

n s.t. maxi∈{0,1,...,n} d(H(xi), H(x(cid:48)

i)) ≤ δ}.

Proof. See the Appendix.

(cid:3)

Now, we show the second main result of this section by providing a veriﬁcation scheme for δ-approximate
current-state opacity of ﬁnite metric systems.

ABCD𝑢𝑢𝑢𝑢𝑢𝑢[0.2][0.15][0.1][0.35]𝑢(𝐶,{𝐵,𝐶})(𝐴,{𝐴,𝐵,𝐶})(𝐵,{𝐵,𝐶})(𝐶,{𝐴,𝐵,𝐶})(𝐴,{𝐴})(𝐶,{𝐴,𝐵,𝐶})(𝐴,{𝐴,𝐵,𝐶,𝐷})(𝐵,{𝐴,𝐵,𝐶})(𝐷,{𝐴,𝐷})(𝐴,{𝐴,𝐷})𝑢𝑢𝑢𝑢𝑢𝑢𝑢𝑢(𝐷,{𝐷})𝑢𝑢𝑢𝑢𝑢𝑢𝑢𝑢𝑢𝑢𝑢ABCDEFGI[2.8][3.1][1.4][1.4][1.5][1.5][1.3][1.6]JKNM[2.9][3.0][1.4][1.5]𝑢𝑢𝑢𝑢𝑢𝑢𝑢𝑢𝑢𝑢𝑢𝑢𝑢𝑢𝑢𝑢(𝐵,{𝐴,𝐵,𝐶})ABCD𝑢𝑢𝑢𝑢𝑢𝑢[0.2][0.15][0.1][0.35]𝑢(𝐶,{𝐵,𝐶})(𝐴,{𝐴,𝐵,𝐶})(𝐵,{𝐵,𝐶})(𝐶,{𝐴,𝐵,𝐶})(𝐴,{𝐴})(𝐶,{𝐴,𝐵,𝐶})(𝐴,{𝐴,𝐵,𝐶,𝐷})(𝐵,{𝐴,𝐵,𝐶})(𝐷,{𝐴,𝐷})(𝐴,{𝐴,𝐷})𝑢𝑢𝑢𝑢𝑢𝑢𝑢𝑢(𝐷,{𝐷})𝑢𝑢𝑢𝑢𝑢𝑢𝑢𝑢𝑢𝑢𝑢ABCDEFGI[2.8][3.1][1.4][1.4][1.5][1.5][1.3][1.6]JKNM[2.9][3.0][1.4][1.5]𝑢𝑢𝑢𝑢𝑢𝑢𝑢𝑢𝑢𝑢𝑢𝑢𝑢𝑢𝑢𝑢(𝐵,{𝐴,𝐵,𝐶})10

X. YIN AND M. ZAMANI

Theorem 4.7. Let S = (X, X0, XS, U, (cid:45) , Y, H) be a metric system, with the metric d deﬁned over the
(cid:45) ) be its δ-approximate current-state estimator.
output set, and a constant δ ≥ 0. Let SC = (XC, XC0, U,
C
Then, S is δ-approximate current-state opaque if and only if

Proof. See the Appendix.

∀(x, q) ∈ XC : q (cid:54)⊆ XS.

(4.2)

(cid:3)

4.3. Veriﬁcation of Approximate Inﬁnite-Step Opacity. Finally, we can combine the δ-approximate
initial-state estimator SI and the δ-approximate current-state estimator SC to verify δ-approximate inﬁnite-
step opacity of ﬁnite metric systems. The veriﬁcation scheme is provided by the following theorem.
Theorem 4.8. Let S = (X, X0, XS, U, (cid:45) , Y, H) be a ﬁnite metric system, with the metric d deﬁned
(cid:45) ) be
over the output set, and a constant δ ≥ 0. Let SI = (XI , XI0, U,
its δ-approximate initial-state estimator and δ-approximate current-state estimator, respectively. Then, S is
δ-approximate inﬁnite-step opaque if and only if

(cid:45) ) and SC = (XC, XC0, U,

C

I

Proof. See the Appendix.

∀(x, q) ∈ XI , (x(cid:48), q(cid:48)) ∈ XC : x = x(cid:48) ∈ XS ⇒ q ∩ q(cid:48) (cid:54)⊆ XS.

(4.3)

(cid:3)

Remark 4.9. We conclude this section by discussing the complexity of verifying approximate opacity. Let
S = (X, X0, XS, U, (cid:45) , Y, H) be a ﬁnite metric system. The complexity of the veriﬁcation algorithms for
both approximate initial-state and current-state opacity is O(|U | × |X| × 2|X|), which is the size of SI or SC.
For approximate inﬁnite-step opacity, we need to construct both SI and SC, and compare each pair of states
in SI and SC. Therefore, the complexity for verifying approximate inﬁnite-step opacity using Theorem 4.8 is
O(|U | × |X|2 × 4|X|). It is worth noting that the complexity of verifying exact opacity as in Deﬁnition 3.1 is
already known to be PSPACE-complete [CDM12]. Therefore, we can conclude that the complexity of verifying
approximate opacity as in Deﬁnition 3.3 is also PSPACE-complete.

5. Approximate Simulation Relations for Opacity

In this section, we introduce new notions of approximate opacity preserving simulation relations, inspired by
the one in [GP07], which is crucial when analyzing opacity or synthesizing controllers enforcing opacity for
deterministic systems. The newly proposed simulation relations will also provide the basis for abstraction-
based veriﬁcation of approximate opacity.

5.1. Approximate Initial-State Opacity Preserving Simulation Relation. First, we introduce a new
notion of approximate initial-state opacity preserving simulation relation.

Deﬁnition 5.1. (Approximate Initial-State Opacity Preserving Simulation Relation) Consider two metric
(cid:45) , Yb, Hb) with the same
systems Sa = (Xa, Xa0, XaS, Ua,
output sets Ya = Yb and metric d. For ε ∈ R+
0 , a relation R ⊆ Xa × Xb is called an ε-approximate initial-
state opacity preserving simulation relation (ε-InitSOP simulation relation) from Sa to Sb if

(cid:45) , Ya, Ha) and Sb = (Xb, Xb0, XbS, Ub,

a

b

(1) (a) ∀xa0 ∈ Xa0 ∩ XaS, ∃xb0 ∈ Xb0 ∩ XbS : (xa0, xb0) ∈ R;
(b) ∀xb0 ∈ Xb0 \ XbS, ∃xa0 ∈ Xa0 \ XaS : (xa0, xb0) ∈ R;

(2) ∀(xa, xb) ∈ R : d(Ha(xa), Hb(xb)) ≤ ε;
(3) For any (xa, xb) ∈ R, we have
(cid:45) x(cid:48)
(cid:45) x(cid:48)
ua
ub
a
b
(cid:45) x(cid:48)
(cid:45) x(cid:48)
ua
ub
b

b : (x(cid:48)
a : (x(cid:48)

a, x(cid:48)
a, x(cid:48)

(a) ∀xa

(b) ∀xb

b, ∃xa

a, ∃xb

a

b) ∈ R;

b) ∈ R.

ON APPROXIMATE OPACITY OF CYBER-PHYSICAL SYSTEMS

11

We say that Sa is ε-InitSOP simulated by Sb, denoted by Sa (cid:22)ε
relation R from Sa to Sb.

I Sb, if there exists an ε-InitSOP simulation

Note that although the above relation is similar to the approximate bisimulation relation proposed in [GP07],
it is still a one sided relation here because condition (1) is not symmetric. We refer the interested readers
to [ZYZ18] to see why one needs strong condition (3) in Deﬁnition 5.1 to show preservation of initial-state
opacity in one direction when ε = 0.

The following main theorem provides a suﬃcient condition for δ-approximate initial-state opacity based on
related systems as in Deﬁnition 5.1.

Theorem 5.2. Let Sa = (Xa, Xa0, XaS, Ua,
metric systems with the same output sets Ya = Yb and metric d and let ε, δ ∈ R+
then the following implication hold:

(cid:45) , Ya, Ha) and Sb = (Xb, Xb0, XbS, Ub,

a

0 . If Sa (cid:22)ε

b

(cid:45) , Yb, Hb) be two
I Sb and ε ≤ δ
2 ,

Sb is (δ − 2ε)-approximate initial-state opaque

⇒Sa is δ-approximate initial-state opaque.

Proof. Consider an arbitrary secret initial state x0 ∈ X0a ∩ XSa and a run x0
Sa. Since Sa (cid:22)ε
0 ∈ Xb0 ∩ XbS and a run x(cid:48)
x(cid:48)
0

(cid:45) xn in
I Sb, by conditions (1)-(a), (2) and (3)-(a) in Deﬁnition 5.1, there exist a secret initial state

n in Sb such that

(cid:45) · · ·
u2
a

(cid:45) x1

un
a

u1
a

1

u(cid:48)
(cid:45) x(cid:48)
1
b

u(cid:48)
(cid:45) · · ·
2
b

u(cid:48)
(cid:45) x(cid:48)
n
b
∀i ∈ {0, 1, . . . , n} : d(Ha(xi), Hb(x(cid:48)

i)) ≤ ε.

(5.1)

Since Sb is (δ − 2ε)-approximate initial-state opaque, there exist a non-secret initial state x(cid:48)(cid:48)
a run x(cid:48)(cid:48)
0

n such that

u(cid:48)(cid:48)
(cid:45) x(cid:48)(cid:48)
1
b

1

u(cid:48)(cid:48)
(cid:45) · · ·
2
b

u(cid:48)(cid:48)
(cid:45) x(cid:48)(cid:48)
n
b

0 ∈ Xb0 \ XbS and

max
i∈{0,1,...,n}

d(Hb(x(cid:48)

i), Hb(x(cid:48)(cid:48)

i )) ≤ δ − 2ε.

(5.2)

Again, since Sa (cid:22)ε
0 ∈ Xa0 \ XaS and a run x(cid:48)(cid:48)(cid:48)
x(cid:48)(cid:48)(cid:48)
0

I Sb, by conditions (1)-(b), (2) and (3)-(b) in Deﬁnition 5.1, there exist an initial state
n such that
i ), Hb(x(cid:48)(cid:48)

u(cid:48)(cid:48)(cid:48)
(cid:45) x(cid:48)(cid:48)(cid:48)
1
a
∀i ∈ {0, 1, . . . , n} : d(Ha(x(cid:48)(cid:48)(cid:48)

u(cid:48)(cid:48)(cid:48)
(cid:45) · · ·
2
a

u(cid:48)(cid:48)(cid:48)
(cid:45) x(cid:48)(cid:48)(cid:48)
n
a

i )) ≤ ε.

(5.3)

1

Combining equations (5.1), (5.2), (5.3), and using the triangle inequality, we have

max
i∈{0,1,...,n}

: d(Ha(xi), Ha(x(cid:48)(cid:48)(cid:48)

i )) ≤ δ.

(5.4)

Since x0 ∈ Xa0 ∩ XaS and x0
initial-state opaque.

(cid:45) x1

u1
a

(cid:45) · · ·
u2
a

un
a

(cid:45) xn are arbitrary, we conclude that Sa is δ-approximate
(cid:3)

The following corollary is a simple consequence of the result in Theorem 5.2 but for the lack of δ-approximate
initial-state opacity.

Corollary 5.3. Let Sa = (Xa, Xa0, XaS, Ua,
two metric systems with the same output sets Ya = Yb and metric d and let ε, δ ∈ R+
following implication hold:

(cid:45) , Ya, Ha) and Sb = (Xb, Xb0, XbS, Ub,

b
0 . If Sb (cid:22)ε

a

(cid:45) , Yb, Hb) be
I Sa, then the

Sb is not (δ + 2ε)-approximate initial-state opaque

⇒Sa is not δ-approximate initial-state opaque.

Proof. Since Sb (cid:22)ε
I Sa, by Theorem 5.2, we know that Sa being δ-approximate initial-state opaque implies
that Sb is (δ + 2ε)-approximate initial-state opaque. Hence, Sb not being (δ + 2ε)-approximate initial-state
(cid:3)
opaque implies that Sa is not δ-approximate initial-state opaque.

12

X. YIN AND M. ZAMANI

(a) Sa

(b) Sb

Figure 3. Example of ε-approximate initial-state opacity preserving simulation relation.

Remark 5.4. It is worth remarking that δ and ε are parameters specifying two diﬀerent types of precision.
Parameter δ is used to specify the measurement precision under which we can guarantee opacity for a sin-
gle system, while parameter ε is used to characterize the “distance” between two systems in terms of being
approximate opaque. The reader should not be confused by the diﬀerent roles of these two parameters.

We illustrate δ-approximate initial-state opacity and its property by the following example.

Example 5.5. Let us consider systems Sa and Sb shown in Figures 3(a) and 3(b), respectively. We mark all
secret states by red and the output map is speciﬁed by the value associated to each state. Let us consider the
following relation R = {(A, J), (B, K), (C, K), (D, K), (E, N ), (F, M ), (G, M ),
(I, M )}. We claim that R is an ε-approximate initial-state opacity preserving simulation relation from Sa
to Sb when ε = 0.1. We check item by item following Deﬁnition 3.1. First, for E ∈ Xa0 ∩ XaS, we have
N ∈ Xb0∩XbS such that (E, N ) ∈ R. Similarly, for J ∈ Xb0\XbS, we have A ∈ Xa0\XaS such that (A, J) ∈ R.
Therefore, condition (a) in Deﬁnition 3.1 holds. Also, for any (xa, xb) ∈ R, we have d(Ha(xa), Ha(xb)) ≤ 0.1,
e.g., d(Ha(A), Hb(J)) = 0.1 and d(Ha(C), Hb(K)) = 0. Therefore, condition (b) in Deﬁnition 3.1 holds.
Finally, we can also check that condition (c) in Deﬁnition 3.1 holds. For example, for (D, K) ∈ R and
(cid:45) B, we can choose K
(cid:45) M , we can choose
(cid:45) K such that (B, K) ∈ R; for (E, M ) ∈ R and N
(cid:45) F such that (F, M ) ∈ R. Therefore, we know that R is an ε-InitSOP simulation relation from Sa to

D

a
u

u

u

u

b

b

E
Sb, i.e., Sa (cid:22)ε

b

I Sb.

Then, by applying the veriﬁcation algorithm in Section 4, we can check that Sb is δ-approximate initial-state
opaque for δ = 0.1. Therefore, according to Theorem 5.2, we conclude that Sa is 0.3-approximate initial-state
opaque, where 0.3 = δ + 2ε, without applying the veriﬁcation algorithm to Sa directly.

5.2. Approximate Current-State Opacity Preserving Simulation Relation. Now, we provide a notion
of approximate simulation relation for preserving current-state opacity.

(cid:45) , Ya, Ha) and Sb = (Xb, Xb0, XbS, Ub,

Deﬁnition 5.6. (Approximate Current-State Opacity Preserving Simulation Relation) Let Sa = (Xa, Xa0, XaS,
(cid:45) , Yb, Hb) be two metric systems with the same output sets
Ua,
Ya = Yb and metric d. For ε ∈ R+
0 , a relation R ⊆ Xa × Xb is called an ε-approximate current-state opacity
preserving simulation relation (ε-CurSOP simulation relation) from Sa to Sb if

a

b

(1) ∀xa0 ∈ Xa0, ∃xb0 ∈ Xb0 : (xa0, xb0) ∈ R;
(2) ∀(xa, xb) ∈ R : d(Ha(xa), Hb(xb)) ≤ ε;
(3) For any (xa, xb) ∈ R, we have
(cid:45) x(cid:48)
(cid:45) x(cid:48)
ua
ub
b : (x(cid:48)
a
b
(cid:45) x(cid:48)
(cid:45) x(cid:48)
ub
ua
b

a ∈ XaS, ∃xb

(a) ∀xa

(b) ∀xa

a, ∃xb

a

a, x(cid:48)
b) ∈ R;
b ∈ XbS : (x(cid:48)

a, x(cid:48)

b) ∈ R;

ABCD𝑢𝑢𝑢𝑢𝑢𝑢[0.2][0.15][0.1][0.35]𝑢(𝐶,{𝐵,𝐶})(𝐴,{𝐴,𝐵,𝐶})(𝐵,{𝐵,𝐶})(𝐶,{𝐴,𝐵,𝐶})(𝐴,{𝐴})(𝐶,{𝐴,𝐵,𝐶})(𝐴,{𝐴,𝐵,𝐶,𝐷})(𝐵,{𝐴,𝐵,𝐶})(𝐷,{𝐴,𝐷})(𝐴,{𝐴,𝐷})𝑢𝑢𝑢𝑢𝑢𝑢𝑢𝑢(𝐷,{𝐷})𝑢𝑢𝑢𝑢𝑢𝑢𝑢𝑢𝑢𝑢𝑢ABCDEFGI[2.8][3.1][1.4][1.4][1.5][1.5][1.3][1.6]JKNM[2.9][3.0][1.4][1.5]𝑢𝑢𝑢𝑢𝑢𝑢𝑢𝑢𝑢𝑢𝑢𝑢𝑢𝑢𝑢𝑢(𝐵,{𝐴,𝐵,𝐶})ABCD𝑢𝑢𝑢𝑢𝑢𝑢[0.2][0.15][0.1][0.35]𝑢(𝐶,{𝐵,𝐶})(𝐴,{𝐴,𝐵,𝐶})(𝐵,{𝐵,𝐶})(𝐶,{𝐴,𝐵,𝐶})(𝐴,{𝐴})(𝐶,{𝐴,𝐵,𝐶})(𝐴,{𝐴,𝐵,𝐶,𝐷})(𝐵,{𝐴,𝐵,𝐶})(𝐷,{𝐴,𝐷})(𝐴,{𝐴,𝐷})𝑢𝑢𝑢𝑢𝑢𝑢𝑢𝑢(𝐷,{𝐷})𝑢𝑢𝑢𝑢𝑢𝑢𝑢𝑢𝑢𝑢𝑢ABCDEFGI[2.8][3.1][1.4][1.4][1.5][1.5][1.3][1.6]JKNM[2.9][3.0][1.4][1.5]𝑢𝑢𝑢𝑢𝑢𝑢𝑢𝑢𝑢𝑢𝑢𝑢𝑢𝑢𝑢𝑢(𝐵,{𝐴,𝐵,𝐶})ON APPROXIMATE OPACITY OF CYBER-PHYSICAL SYSTEMS

13

(c) ∀xb

(d) ∀xb

(cid:45) x(cid:48)
ub
b
(cid:45) x(cid:48)
ub
b

(cid:45) x(cid:48)
ua

a : (x(cid:48)

b, ∃xa

a
b ∈ Xb \ XbS, ∃xa

a, x(cid:48)
b) ∈ R.
(cid:45) x(cid:48)
ua

a

a ∈ Xa \ XaS : (x(cid:48)

a, x(cid:48)

b) ∈ R.

We say that Σa is ε-CurSOP simulated by Σb, denoted by Σa (cid:22)ε
relation R from Sa to Sb.

C Σb, if there exists an ε-CurSOP simulation

The following theorem provides a suﬃcient condition for δ-approximate current-state opacity based on related
systems as in Deﬁnition 5.6.

Theorem 5.7. Let Sa = (Xa, Xa0, XaS, Ua,
metric systems with the same output sets Ya = Yb and metric d and let ε, δ ∈ R+
then the following implication hold:

(cid:45) , Ya, Ha) and Sb = (Xb, Xb0, XbS, Ub,

a

0 . If Sa (cid:22)ε

b

(cid:45) , Yb, Hb) be two
C Sb and ε ≤ δ
2 ,

Sb is (δ − 2ε)-approximate current-state opaque

⇒Sa is δ-approximate current-state opaque.

(cid:45) xn in
Proof. Let us consider an arbitrary initial state x0 ∈ Xa0 and ﬁnite run x0
Sa such that xn ∈ XaS. We consider the following two cases: n = 0 and n (cid:54)= 0. If n = 0, we know that
x0 ∈ XaS. Since we assume that {x ∈ X0 : (Ha(x0), Ha(x)) ≤ δ} (cid:54)⊆ XaS, we observe immediately that there
exists x(cid:48)
C Sb,
by conditions (1), (2), (3)-(a) and (3)-(b) in Deﬁnition 5.6, there exist an initial state x(cid:48)
0 ∈ Xb0 and a ﬁnite
run x(cid:48)
0

0 ∈ Xa0 \ XaS such that d(Ha(x0), Ha(x)) ≤ δ. Then, we consider the case of n ≥ 1. Since Sa (cid:22)ε

n in Sb such that x(cid:48)

n ∈ XbS and

(cid:45) · · ·
u2
a

(cid:45) x1

un
a

u1
a

1

u(cid:48)
(cid:45) · · ·
2
b

u(cid:48)
(cid:45) x(cid:48)
n
b

u(cid:48)
(cid:45) x(cid:48)
1
b

∀i ∈ {0, 1, . . . , n} : d(Ha(xi), Hb(x(cid:48)

i)) ≤ ε.

(5.5)

Since Sb is (δ − 2ε)-approximate current-state opaque, there exist an initial state x(cid:48)(cid:48)
x(cid:48)(cid:48)
0

n ∈ Xb \ XbS and

n such that x(cid:48)(cid:48)

u(cid:48)(cid:48)
(cid:45) x(cid:48)(cid:48)
1
b

1

u(cid:48)(cid:48)
(cid:45) · · ·
2
b

u(cid:48)(cid:48)
(cid:45) x(cid:48)(cid:48)
n
b

0 ∈ X0b and a ﬁnite run

max
i∈{0,1,...,n}

d(Hb(x(cid:48)

i), Hb(x(cid:48)(cid:48)

i )) ≤ δ − 2ε.

(5.6)

Again, since Sa (cid:22)ε
0 ∈ X0a and a ﬁnite run x(cid:48)(cid:48)(cid:48)
x(cid:48)(cid:48)(cid:48)
0

C Sb, by conditions (1), (2), (3)-(c) and (3)-(d) in Deﬁnition 5.6, there exist an initial state
n such that x(cid:48)(cid:48)(cid:48)

n ∈ Xa \ XaS and

u(cid:48)(cid:48)(cid:48)
(cid:45) x(cid:48)(cid:48)(cid:48)
1
a

1

u(cid:48)(cid:48)(cid:48)
(cid:45) · · ·
2
a

u(cid:48)(cid:48)(cid:48)
(cid:45) x(cid:48)(cid:48)(cid:48)
n
a

∀i ∈ {0, 1, . . . , n} : d(Ha(x(cid:48)(cid:48)(cid:48)

i ), Hb(x(cid:48)(cid:48)

i )) ≤ ε.

Combining equations (5.5), (5.6), (5.7), and using the triangle inequality, we have

max
i∈{0,1,...,n}

d(Ha(xi), Ha(x(cid:48)(cid:48)(cid:48)

i )) ≤ δ.

(5.7)

(5.8)

Since x0 ∈ X0a and x0
current-state opaque.

(cid:45) x1

u1
a

(cid:45) · · ·
u2
a

un
a

(cid:45) xn are arbitrary, we conclude that Sa is δ-approximate
(cid:3)

The following corollary is a simple consequence of the result in Theorem 5.6 but for the lack of δ-approximate
current-state opacity.

Corollary 5.8. For any two systems Sa and Sb with Sb (cid:22)ε

C Sa, the following implication holds:

Sb is not (δ + 2ε)-approximate current-state opaque

⇒Sa is not δ-approximate current-state opaque.

14

X. YIN AND M. ZAMANI

5.3. Approximate Inﬁnite-Step Opacity Preserving Simulation Relation. Finally, by combing ε-
CurSOP simulation relation and ε-InitSOP simulation relation, we provide a notion of approximate simulation
relation for preserving inﬁnite-step opacity.

a

(cid:45) , Ya, Ha) and Sb = (Xb, Xb0, XbS, Ub,

Deﬁnition 5.9. (Approximate Inﬁnite-Step Opacity Preserving Simulation Relation) Let Sa = (Xa, Xa0, XaS,
(cid:45) , Yb, Hb) be two metric systems with the same output
Ua,
sets Ya = Yb and metric d. For ε ∈ R+
0 , a relation R ⊆ Xa × Xb is called an ε-approximate inﬁnite-step
opacity preserving simulation relation (ε-InfSOP simulation relation) from Sa to Sb if it is both an ε-CurSOP
simulation relation from Sa to Sb and an ε-InitSOP simulation relation from Sa to Sb, i.e.,

b

(1) (a) ∀xa0 ∈ Xa0, ∃xb0 ∈ Xb0 : (xa0, xb0) ∈ R;

(b) ∀xa0 ∈ Xa0 ∩ XaS, ∃xb0 ∈ Xb0 ∩ XbS : (xa0, xb0) ∈ R;
(c) ∀xb0 ∈ Xb0 \ XbS, ∃xa0 ∈ Xa0 \ XaS : (xa0, xb0) ∈ R;

a, ∃xb

(a) ∀xa

(2) ∀(xa, xb) ∈ R : d(Ha(xa), Hb(xb)) ≤ ε;
(3) For any (xa, xb) ∈ R, we have
(cid:45) x(cid:48)
(cid:45) x(cid:48)
ua
ub
b : (x(cid:48)
a
b
(cid:45) x(cid:48)
(cid:45) x(cid:48)
ub
ua
a
b
(cid:45) x(cid:48)
ub
a : (x(cid:48)
b
(cid:45) x(cid:48)
ub
b

a
b ∈ Xb \ XbS, ∃xa

a ∈ XaS, ∃xb

(cid:45) x(cid:48)
ua

(b) ∀xa

(d) ∀xb

(c) ∀xb

b, ∃xa

a, x(cid:48)
b) ∈ R;
b ∈ XbS : (x(cid:48)
a, x(cid:48)
b) ∈ R.
(cid:45) x(cid:48)
ua

a

a, x(cid:48)

b) ∈ R;

a ∈ Xa \ XaS : (x(cid:48)

a, x(cid:48)

b) ∈ R.

We say that Σa is ε-InfSOP simulated by Σb, denoted by Σa (cid:22)ε
relation R from Sa to Sb.

IF Σb, if there exists an ε-InfSOP simulation

Similar to the cases of initial-state opacity and current-state opacity, we have the following theorem as a
suﬃcient condition for δ-approximate inﬁnite-step opacity based on related systems as in Deﬁnition 5.9.

Theorem 5.10. Let Sa = (Xa, Xa0, XaS, Ua,
two metric systems with the same output sets Ya = Yb and metric d and let ε, δ ∈ R+
ε ≤ δ

2 , then the following implication hold:

(cid:45) , Ya, Ha) and Sb = (Xb, Xb0, XbS, Ub,

a

(cid:45) , Yb, Hb) be
IF Sb and

b
0 . If Sa (cid:22)ε

Sb is (δ − 2ε)-approximate inﬁnite-step opaque

⇒Sa is δ-approximate inﬁnite-step opaque.

u1
Proof. Let us consider an arbitrary initial state x0 ∈ Xa0 and ﬁnite run x0
a
such that xk ∈ XaS for some k = 0, . . . , n. We consider the following two cases:
If k = 0, then we have x0 ∈ XaS. Since Sa (cid:22)ε
know that there exist an initial state x(cid:48)
maxi∈{0,1,...,n} d(Ha(xi), Ha(x(cid:48)

IF Sb implies Sa (cid:22)ε
0 ∈ Xa0 \ XaS and a run x(cid:48)
0

u(cid:48)
(cid:45) x(cid:48)
1
a

i)) ≤ δ.

1

(cid:45) x1

(cid:45) · · ·
u2
a

(cid:45) xn in Sa

un
a

I Sb, by the proof of Theorem 5.2, we
n such that

u(cid:48)
(cid:45) · · ·
2
a

u(cid:48)
(cid:45) x(cid:48)
n
a

If k ≥ 1, then similar to the proof of Theorem 5.7, by conditions (1)-(a), (2), (3)-(a), (3)-(b), (3)-(c) and
(3)-(d) in Deﬁnition 5.9 and the fact the Sb is (δ − 2ε)-approximate inﬁnite-step opaque, there exist an
initial state x(cid:48)
k ∈ Xa \ XaS and
maxi∈{0,1,...,n} d(Ha(xi), Ha(x(cid:48)

0 ∈ X0a and a ﬁnite run x(cid:48)
0

n such that x(cid:48)

u(cid:48)
(cid:45) · · ·
2
a

u(cid:48)
(cid:45) x(cid:48)
1
a

(cid:45) x(cid:48)

u(cid:48)
n
a

1

Since x0 ∈ X0a, x0
inﬁnite-step opaque.

(cid:45) x1

u1
a

un
a

(cid:45) xn and index k are arbitrary, we conclude that Sa is δ-approximate
(cid:3)

i)) ≤ δ.
(cid:45) · · ·
u2
a

We can obtain the following corollary immediately.

ON APPROXIMATE OPACITY OF CYBER-PHYSICAL SYSTEMS

15

Corollary 5.11. For any two systems Sa and Sb with Sb (cid:22)ε

IF Sa, the following implication holds:

Sb is not (δ + 2ε)-approximate inﬁnite-step opaque

⇒Sa is not δ-approximate inﬁnite-step opaque.

In the next section, we study opacity of continuous-space control systems by constructing their ﬁnite abstrac-
tions and analyzing their opacity.

6. Opacity of Control Systems

In this section, we show how to analyze approximate opacity for a class of discrete-time control systems of the
following form.
Deﬁnition 6.1. A discrete-time control system Σ is deﬁned by the tuple Σ = (X, S, U, f, Y, h), where X,
U, and Y are the state, input, and output sets, respectively, and are subsets of normed vector spaces with
appropriate ﬁnite dimensions. Set S ⊆ X is a set of secret states. The map f : X × U → X is called the
transition function, and h : X → Y is the output map and assumed to satisfy the following Lipschitz condition:
(cid:107)h(x) − h(y)(cid:107) ≤ α((cid:107)x − y(cid:107)) for some α ∈ K∞ and all x, y ∈ X. The discrete-time control system Σ is described
by diﬀerence equations of the form

Σ :

(cid:26) ξ(k + 1) = f (ξ(k), υ(k)),
ζ(k) = h(ξ(k)),

(6.1)

where ξ : N0 → X, ζ : N0 → Y, and υ : N0 → U are the state, output, and input signals, respectively.

We write ξxυ(k) to denote the point reached at time k under the input signal υ from initial condition x = ξxυ(0).
Similarly, we denote by ζxυ(k) the output corresponding to state ξxυ(k), i.e. ζxυ(k) = h(ξxυ(k)). In the above
deﬁnition, we implicitly assumed that set X is positively invariant1.

Now, we introduce the notion of incremental input-to-state stability (δ-ISS) leveraged later to show some of
the main results of the paper.
Deﬁnition 6.2. System Σ = (X, S, U, f, Y, h) is called incrementally input-to-state stable (δ-ISS) if there exist
a KL function β and K∞ function γ such that ∀x, x(cid:48) ∈ X and ∀υ, υ(cid:48) : N0 → U, the following inequality holds
for any k ∈ N:

(cid:107)ξxυ(k)−ξx(cid:48)υ(cid:48)(k)(cid:107) ≤ β((cid:107)x − x(cid:48)(cid:107), k)+γ((cid:107)υ − υ(cid:48)(cid:107)∞).

Example 6.3. As an example, for a linear control system:

ξ(k + 1) = Aξ(k) + Bυ(k),

ζ(k) = Cξ(k),

where all eigenvalues of A are inside the unit circle, the functions β and γ can be chosen as:

β(r, k) = (cid:107)Ak(cid:107)r;

γ(r) = (cid:107)B(cid:107)

(cid:33)

(cid:107)Am(cid:107)

r.

(cid:32) ∞
(cid:88)

m=0

(6.2)

(6.3)

(6.4)

In general, it is diﬃcult to check inequality (6.2) directly for nonlinear systems. Fortunately, δ-ISS can be
characterized using Lyapunov functions.
Deﬁnition 6.4. Consider a control system Σ and a continuous function V : X × X → R+
called a δ-ISS Lyapunov function for Σ if there exist K∞ functions α1, α2, ρ and K function σ such that:

0 . Function V is

(i) for any x, x(cid:48) ∈ X

α1((cid:107)x − x(cid:48)(cid:107)) ≤ V (x, x(cid:48)) ≤ α2((cid:107)x − x(cid:48)(cid:107));

(ii) for any x, x(cid:48) ∈ X and u, u(cid:48) ∈ U

V(f (x, u),f (x(cid:48), u(cid:48)))−V (x, x(cid:48)) ≤ −ρ(V (x, x(cid:48)))+σ((cid:107)u − u(cid:48)(cid:107));

1Set X is called positively invariant under (6.1) if ξxυ(k) ∈ X for any k ∈ N, any x ∈ X and any υ : N0 → U.

16

X. YIN AND M. ZAMANI

The following result characterizes δ-ISS in terms of existence of δ-ISS Lyapunov functions.

Theorem 6.5. [Tra18] Consider a control system Σ.

• Σ is δ-ISS if it admits a δ-ISS Lyapunov function;
• If U is compact and convex and X is compact, tehn the existence of a δ-ISS Lyapunov function is

equivalent to δ-ISS.

The next technical lemma will be used later to show some of the main results of this section.

Lemma 6.6. Consider a control system Σ. Suppose V is a δ-ISS Lyapunov function for Σ. Then there exist
κ, λ ∈ K∞, where κ(s) < s for any s ∈ R+, such that

V (f (x, u), f (x(cid:48), u(cid:48))) ≤ max{κ(V (x, x(cid:48))), λ((cid:107)u − u(cid:48)(cid:107))},

(6.5)

for any x, x(cid:48) ∈ X and any u, u(cid:48) ∈ U.

The proof is similar to that of Theorem 1 in [SGZ17] and is omitted here due to lack of space.

In order to provide the main results of this section, we ﬁrst describe control systems in Deﬁnition 6.1 as
metric systems as in Deﬁnition 2.1. More precisely, given a control system Σ = (X, S, U, f, Y, h), we deﬁne an
associated metric system

S(Σ) = (X, X0, XS, U, (cid:45) , Y, H),

(6.6)
u(cid:45) x(cid:48) if and only if x(cid:48) = f (x, u). We
where X = X, X0 = X, XS = S, U = U, Y = Y, H = h, and x
assume that the output set Y is equipped with the inﬁnity norm: d(y1, y2) = (cid:107)y1 − y2(cid:107), ∀y1, y2 ∈ Y . We have
a similar assumption for the state set X.
Now, we introduce a symbolic system for the control system Σ = (X, S, U, f, Y, h). To do so, from now on we
assume that sets X, S and U are of the form of ﬁnite union of boxes. Consider a concrete control system Σ
and a tuple q = (η, µ) of parameters, where 0 < η ≤ min {span(S), span(X \ S)} is the state set quantization
and 0 < µ ≤ span(U) is the input set quantization. Let us introduce the symbolic system

where Xq = Xq0 = [X]η, XqS = [S]η, Uq = [U]µ, Yq = {h(xq) | xq ∈ Xq}, Hq(xq) = h(xq), ∀xq ∈ Xq, and

Sq(Σ) = (Xq, Xq0, XqS, Uq,

(cid:45) , Yq, Hq),

q

(6.7)

• xq

(cid:45) x(cid:48)
uq

q

q if and only if (cid:107)x(cid:48)

q − f (xq, uq)(cid:107) ≤ η.

We can now state the ﬁrst main result of this section showing that, under some condition over the quantiza-
tion parameters η and µ, Sq(Σ) and S(Σ) are related under an approximate initial-state opacity preserving
simulation relation.

Theorem 6.7. Let Σ = (X, S, U, f, Y, h) be a δ-ISS control system. For any desired precision ε > 0, and any
tuple q = (η, µ) of quantization parameters satisfying

β (cid:0)α−1(ε), 1(cid:1) + γ(µ) + η ≤ α−1(ε),

(6.8)

we have S(Σ) (cid:22)ε

I Sq(Σ) (cid:22)ε

I S(Σ).

Proof. We start by proving S(Σ) (cid:22)ε
only if (cid:107)x − xq(cid:107) ≤ α−1(ε). Since η ≤ span(S), XS ⊆ (cid:83)
exists xq ∈ XqS such that:

I Sq(Σ). Consider the relation R ⊆ X × Xq deﬁned by (x, xq) ∈ R if and
Bη(p), and by (6.8), for every x ∈ XS there always

p∈[S]η

(cid:107)x − xq(cid:107) ≤ η ≤ α−1(ε).
Hence, (x, xq) ∈ R and condition (1)-(a) in Deﬁnition 5.1 is satisﬁed. For every xq ∈ Xq \ XqS, by choosing
x = xq which is also inside set X \ XS, one gets (x, xq) ∈ R and, hence, condition (1)-(b) in Deﬁnition 5.1

(6.9)

ON APPROXIMATE OPACITY OF CYBER-PHYSICAL SYSTEMS

17

holds as well. Now consider any (x, xq) ∈ R. Condition (2) in Deﬁnition 5.1 is satisﬁed by the deﬁnition of R
and the Lipschitz assumption on map h as in Deﬁnition 6.1:

(cid:107)H(x) − Hq(xq)(cid:107) = (cid:107)h(x) − h(xq)(cid:107) ≤ α((cid:107)x − xq(cid:107)) ≤ ε.

Let us now show that condition (3) in Deﬁnition 5.1 holds.

Consider any u ∈ U . Choose an input uq ∈ Uq satisfying:

(6.10)
(cid:107)u − uq(cid:107) ≤ µ.
Note that the existence of such uq is guaranteed by the inequality µ ≤ span(U) which guarantees that
u(cid:45) x(cid:48) = f (x, u) in S(Σ). It follows from the δ-ISS
U ⊆ (cid:83)
assumption on Σ and (6.10) that the distance between x(cid:48) and f (xq, uq) is bounded as:

Bµ(p). Consider the unique transition x

p∈[U]µ

(6.11)

(6.12)

(cid:107)x(cid:48) − f (xq, uq)(cid:107) ≤β ((cid:107)x − xq(cid:107), 1) + γ ((cid:107)u − uq(cid:107))

≤β (cid:0)α−1(ε), 1(cid:1) + γ (µ) .

Since X ⊆ (cid:83)

p∈[X]η

Bη(p), there exists x(cid:48)

q ∈ Xq such that:

(cid:107)f (xq, uq) − x(cid:48)

q(cid:107) ≤ η,
(cid:45) x(cid:48)
uq

q

which, by the deﬁnition of Sq(Σ), implies the existence of xq
(6.11), (6.12), and triangle inequality, we obtain:

q in Sq(Σ). Using the inequalities (6.8),

(cid:107)x(cid:48) − x(cid:48)

q(cid:107) ≤ (cid:107)x(cid:48) − f (xq, uq) + f (xq, uq) − x(cid:48)

q(cid:107)
≤ (cid:107)x(cid:48) − f (xq, uq)(cid:107) + (cid:107)f (xq, uq) − x(cid:48)
q(cid:107)
≤ β (cid:0)α−1(ε), 1(cid:1) + γ (µ) + η ≤ α−1(ε).

Therefore, we conclude (x(cid:48), x(cid:48)
condition (3)-(b) in Deﬁnition 5.1 also holds.

q) ∈ R and condition (iii)-(a) in Deﬁnition 5.1 holds. Let us now show that

Now consider any (x, xq) ∈ R. Consider any uq ∈ Uq. Choose the input u = uq and consider the unique
x(cid:48) = f (x, u) in S(Σ). Using δ-ISS assumption for Σ, we bound the distance between x(cid:48) and f (xq, uq) as:

(cid:107)x(cid:48) − f (xq, uq)(cid:107) ≤ β ((cid:107)x − xq(cid:107), 1) ≤ β (cid:0)α−1(ε), 1(cid:1) .

(6.13)

Using the deﬁnition of Sq(Σ), the inequalities (6.8), (6.13), and the triangle inequality, we obtain:

(cid:107)x(cid:48) − x(cid:48)

q(cid:107) ≤(cid:107)x(cid:48) − f (xq, uq) + f (xq, uq) − x(cid:48)

q(cid:107)
≤(cid:107)x(cid:48) − f (xq, uq)(cid:107) + (cid:107)f (xq, uq) − x(cid:48)
≤β (cid:0)α−1(ε), 1(cid:1) + η ≤ α−1(ε).

q(cid:107)

Therefore, we conclude that (x(cid:48), x(cid:48)

q) ∈ R and condition (iii)-(b) in Deﬁnition 5.1 holds.

In a similar way, one can prove that Sq(Σ) (cid:22)ε

I S(Σ).

(cid:3)

Remark 6.8. Note that there always exist quantization parameters q such that inequality (6.8) holds as long
as β (cid:0)α−1(ε), 1(cid:1) < α−1(ε). By assuming that the discrete-time control system Σ is a sampled-data version of
an original continuous-time one with the sampling time τ , one can ensure the latter inequality by choosing
the sampling time large enough given that β(r, 1) = ˆβ(r, τ ) < r for some KL function ˆβ establishing the
incremental stability of the original continuous-time system. For example, for the function in (6.4), one has
β(r, 1) = (cid:107)A(cid:107)r = (cid:107)e ˆAτ (cid:107)r, where ˆA is the state matrix of the original continuous-time linear control system.

The next theorem provides similar results as in Theorem 6.7 but by leveraging δ-ISS Lyapunov functions. To
show the next result, we will make the following supplementary assumption on the δ-ISS Lyapunov functions:
there exists a function ˆγ ∈ K∞ such that

∀x, x(cid:48), x(cid:48)(cid:48) ∈ X,

V (x, x(cid:48)) − V (x(cid:48), x(cid:48)(cid:48)) ≤ ˆγ((cid:107)x − x(cid:48)(cid:48)(cid:107)).

(6.14)

18

X. YIN AND M. ZAMANI

Inequality (6.14) is not restrictive at all provided we are interested in the dynamics of the control system on
a compact subset of the state set X; see the discussion at the end of Section IV in [GPT10].

Theorem 6.9. Let Σ = (X, S, U, f, Y, h) admit a δ-ISS Lyapunov function V satisfying (6.14). For any
desired precision ε > 0, and any tuple q = (η, µ) of quantization parameters satisfying

α2(η) ≤α1(α−1(ε)),
max{κ(α1(α−1(ε))), λ(µ)} + ˆγ(η) ≤α1(α−1(ε)),

(6.15)

(6.16)

we have S(Σ) (cid:22)ε

I Sq(Σ) (cid:22)ε

I S(Σ).

Proof. We start by proving S(Σ) (cid:22)ε
only if V (x, xq) ≤ α1(α−1(ε)). Since η ≤ span(S) and XS ⊆ (cid:83)
exists xq ∈ XqS such that (cid:107)x − xq(cid:107) ≤ η. Then

I Sq(Σ). Consider the relation R ⊆ X × Xq deﬁned by (x, xq) ∈ R if and
Bη(p), for every x ∈ XS there always

p∈[S]η

V (x, xq) ≤ α2((cid:107)x − xq(cid:107)) ≤ α2(η) ≤ α1(α−1(ε))

because of (6.15) and α2 being a K∞ function. Hence, (x, xq) ∈ R and condition (1)-(a) in Deﬁnition 5.1 is
satisﬁed. For every xq ∈ Xq \ XqS, by choosing x = xq which is also inside set X \ XS, one gets trivially
(x, xq) ∈ R and, hence, condition (1)-(b) in Deﬁnition 5.1 holds as well. Now consider any (x, xq) ∈ R. Con-
dition (2) in Deﬁnition 5.1 is satisﬁed by the deﬁnition of R and the Lipschitz assumption on map h as in
Deﬁnition 6.1:

(cid:107)H(x) − Hq(xq)(cid:107) = (cid:107)h(x) − h(xq)(cid:107) ≤ α((cid:107)x − xq(cid:107))

≤ α(α−1

1 (V (x, xq)) ≤ ε.

Let us now show that condition (3) in Deﬁnition 5.1 holds.

Consider any u ∈ U . Choose an input uq ∈ Uq satisfying:

(cid:107)u − uq(cid:107) ≤ µ.
(6.17)
Note that the existence of such uq is guaranteed by the inequality µ ≤ span(U) which guarantees that
u(cid:45) x(cid:48) = f (x, u) in S(Σ). Given δ-ISS Lyapunov
U ⊆ (cid:83)
function V for Σ, inequality (6.5), and (6.17), one obtains:

Bµ(p). Consider the unique transition x

p∈[U]µ

V (x(cid:48), f (xq, uq)) ≤ max{κ (V (x, xq)) , λ ((cid:107)u − uq(cid:107))}

≤ max{κ (cid:0)α1(α−1(ε))(cid:1) , λ (µ)}.

Since X ⊆ (cid:83)

p∈[X]η

Bη(p), there exists x(cid:48)

q ∈ Xq such that:

(cid:107)f (xq, uq) − x(cid:48)

q(cid:107) ≤ η,

(6.18)

(6.19)

which, by the deﬁnition of Sq(Σ), implies the existence of xq
(6.16), (6.18), and (6.19), we obtain:

(cid:45) x(cid:48)
uq

q

q in Sq(Σ). Using the inequalities (6.14),

V (x(cid:48), x(cid:48)

q) ≤ V (x(cid:48), f (xq, uq)) + ˆγ((cid:107)f (xq, uq) − x(cid:48)
≤ max{κ (cid:0)α1(α−1(ε))(cid:1) , λ (µ)} + ˆγ (η)
≤ α1(α−1(ε)).

q(cid:107))

Therefore, we conclude (x(cid:48), x(cid:48)
condition (3)-(b) in Deﬁnition 5.1 also holds.

q) ∈ R and condition (iii)-(a) in Deﬁnition 5.1 holds. Let us now show that

Now consider any (x, xq) ∈ R. Consider any uq ∈ Uq. Choose the input u = uq and consider the unique
x(cid:48) = f (x, u) in S(Σ). Given δ-ISS Lyapunov function V for Σ and inequality (6.5), one gets:

V (x(cid:48), f (xq, uq)) ≤ κ (V (x, xq)) ≤ κ (cid:0)α1(α−1(ε))(cid:1) .

(6.20)

ON APPROXIMATE OPACITY OF CYBER-PHYSICAL SYSTEMS

Using the deﬁnition of Sq(Σ), the inequalities (6.14), (6.16), and (6.20), we obtain:

V (x(cid:48), x(cid:48)

q) ≤V (x(cid:48), f (xq, uq)) + ˆγ((cid:107)f (xq, uq) − x(cid:48)

q(cid:107))
≤κ (cid:0)α1(α−1(ε))(cid:1) + ˆγ(η) ≤ α1(α−1(ε)).

Therefore, we conclude that (x(cid:48), x(cid:48)

q) ∈ R and condition (iii)-(b) in Deﬁnition 5.1 holds.

In a similar way, one can prove that Sq(Σ) (cid:22)ε

I S(Σ).

19

(cid:3)

Remark 6.10. One can readily verify that there always exits a choice of quantization parameter q = (η, µ)
such that inequalities (6.15) and (6.16) hold simoultanously. Although the result in Theorem 6.9 seems more
general than that of Theorem 6.7 in terms of the existence of quantization parameter q, the symbolic model
Sq(Σ), computed by using the quantization parameters q provided in Theorem 6.7 whenever existing, is likely
to have fewer states than the model computed by using the quantization parameters provided in Theorem 6.9
due to the conservative nature of δ-ISS Lyapunov functions.

The next theorems illustrate the other main results of this section showing that, under similar conditions over
the quantization parameters η and µ, Sq(Σ) and S(Σ) are related under an approximate current-state opacity
preserving simulation relation.

Theorem 6.11. Let Σ = (X, S, U, f, Y, h) be a δ-ISS control system. For any desired precision ε > 0, and
any tuple q = (η, µ) of quantization parameters satisfying

β (cid:0)α−1(ε), 1(cid:1) + γ(µ) + η ≤ α−1(ε),

we have S(Σ) (cid:22)ε

C Sq(Σ) (cid:22)ε

C S(Σ).

Proof. The proof is similar to that of Theorem 6.7 and is omitted here due to lack of space.

(cid:3)

Theorem 6.12. Let Σ = (X, S, U, f, Y, h) admits a δ-ISS Lyapunov function V satisfying (6.14). For any
desired precision ε > 0, and any tuple q = (η, µ) of quantization parameters satisfying

α2(η) ≤α1(α−1(ε)),
max{κ(α1(α−1(ε))), λ(µ)} + ˆγ(η) ≤α1(α−1(ε)),

we have S(Σ) (cid:22)ε

C Sq(Σ) (cid:22)ε

C S(Σ).

Proof. The proof is similar to that of Theorem 6.9 and is omitted here due to lack of space.

(cid:3)

I Sq(Σ) (cid:22)ε

Since S(Σ) (cid:22)ε
C S(Σ) under the same relation in Theorems 6.7 and 6.11
(resp. Theorems 6.9 and 6.12), by the deﬁnition of approximate inﬁnite-state opacity preserving simulation
relation, we consequently get the following results.

I S(Σ) and S(Σ) (cid:22)ε

C Sq(Σ) (cid:22)ε

Theorem 6.13. Let Σ = (X, S, U, f, Y, h) be a δ-ISS control system. For any desired precision ε > 0, and
any tuple q = (η, µ) of quantization parameters satisfying

β (cid:0)α−1(ε), 1(cid:1) + γ(µ) + η ≤ α−1(ε),

we have S(Σ) (cid:22)ε

IF Sq(Σ) (cid:22)ε

IF S(Σ).

Theorem 6.14. Let Σ = (X, S, U, f, Y, h) admits a δ-ISS Lyapunov function V satisfying (6.14). For any
desired precision ε > 0, and any tuple q = (η, µ) of quantization parameters satisfying

α2(η) ≤α1(α−1(ε)),
max{κ(α1(α−1(ε))), λ(µ)} + ˆγ(η) ≤α1(α−1(ε)),

we have S(Σ) (cid:22)ε

IF Sq(Σ) (cid:22)ε

IF S(Σ).

20

X. YIN AND M. ZAMANI

7. Conclusion

In this paper, we extended the concept of opacity to metric systems by proposing the notion of approximate
opacity. Veriﬁcation algorithms and approximate relations that preserve approximate opacity were also pro-
vided. We also discussed how to construct ﬁnite abstractions that approximately simulates a class of control
systems in terms of opacity preserving. Our result bridges the gap between the opacity analysis of ﬁnite
discrete systems and continuous control systems.

Among the many possible directions for future work that will be built based on the proposed framework,
we mention several directions of immediate interest. One direction is to extend our framework to the
stochastic setting for almost opacity [SH14, BMS15, CIK17, YLWL19]. Also, we are interested in con-
structing approximate opacity preserving symbolic models for more classes of systems. Finally, we plan
to extend approximate opacity preserving simulation relation to approximate opacity preserving alternat-
ing simulation relation [Tab09] and solve the problem of controller synthesis enforcing approximate opacity
[DDM10, CDM12, ZSL15, YL16, TLSG18, JWL18].

.1. Proofs not contained in main body. Proof of Proposition 4.2

Proof. It is straightforward to show (i). Hereafter, we prove (ii) by induction on the length of input sequence.

When n = 0, i.e., there is no input sequence, we have that (x0, q0) ∈ XI0. By the deﬁnition of XI0, we know
that

which implies (ii) immediately.

q0 = {x(cid:48)

0 ∈ X : d(H(x0), H(x(cid:48)

0)) ≤ δ}

To proceed the induction, we assume that (ii) holds when n = k. Now, we need to show that (ii) also holds
when n = k + 1. To this end, we consider arbitrary pair (x0, q0) ∈ XI0 and ﬁnite run
(cid:45) (xn+1, qn+1).

(cid:45) (xn, qn)

(cid:45) (x1, q1)

(x0, q0)

un+1

(cid:45) · · ·
u2
I

un
I

u1
I

I

Then, we have

qn+1 = ∪ˆu∈U Preˆu(qn) ∩ {x ∈ X : d(H(xn+1), H(x)) ≤ δ}

={x ∈ X : ∃x(cid:48) ∈ qn, u(cid:48)
= (cid:8)x ∈ X : [∃x(cid:48) ∈ qn, u(cid:48)

n+1 ∈ U s.t. (x, u(cid:48)
n+1 ∈ U s.t. (x, u(cid:48)

n+1, x(cid:48)) ∈ (cid:45)} ∩ {x ∈ X : d(H(xn+1), H(x)) ≤ δ}
n+1, x(cid:48)) ∈ (cid:45)] ∧ [d(H(xn+1), H(x)) ≤ δ](cid:9) .

(.1)

By the induction hypothesis, we know that

(cid:26)

qn =

0 ∈ X : ∃x(cid:48)
x(cid:48)
0

u(cid:48)
n(cid:45) x(cid:48)

1

u(cid:48)
n−1(cid:45) · · ·

u(cid:48)
1(cid:45) x(cid:48)

n s.t.

max
i∈{0,1,...,n}

Therefore, by combing equations (.1) and (.2), one gets

d(H(xi), H(x(cid:48)

n−i)) ≤ δ

(cid:27)

.

(.2)

(cid:40)

qn+1 =

x ∈ X :

u(cid:48)
u(cid:48)
n(cid:45) x(cid:48)
1(cid:45) x(cid:48)
1
s.t. maxi∈{0,1,...,n} d(H(xi), H(x(cid:48)
n−i)) ≤ δ ∧ d(H(xn+1), H(x)) ≤ δ

un−1(cid:45) · · ·

u(cid:48)
n+1(cid:45) x(cid:48)

∃x

n

0

(cid:26)
x ∈ X : ∃x(cid:48)(cid:48)
0

=

u(cid:48)
n+1(cid:45) x(cid:48)(cid:48)

1

u(cid:48)
n(cid:45) · · ·

u(cid:48)
1(cid:45) x(cid:48)(cid:48)

n+1 s.t.

max
i∈{0,1,...,n+1}

d(H(xi), H(x(cid:48)(cid:48)

n+1−i)) ≤ δ

.

(.3)

(cid:41)

(cid:27)

Note that, in the second equality of equation (.3), we choose x(cid:48)(cid:48)
obtains that the induction step holds, which completes the induction and proof.

0 = x and x(cid:48)(cid:48)

i = x(cid:48)

i−1, i ≥ 1. Therefore, one
(cid:3)

Proof of Theorem 4.3

ON APPROXIMATE OPACITY OF CYBER-PHYSICAL SYSTEMS

21

Proof. (⇒) By contraposition: suppose that there exists a state (x, q) ∈ XI such that x ∈ X0 ∩ XS and
q ∩ X0 ⊆ XS. Let

(x0, q0)

(cid:45) (x1, q1)

u1
I

(cid:45) · · ·
u1
I

(cid:45) (xn, qn)

un
I

be a run reaching (x, q) =: (xn, qn). By Proposition 4.2, we have xn
well-deﬁned in S as xn ∈ X0. Moreover, by Proposition 4.2, we have

un(cid:45) xn−1

un−1(cid:45) · · ·

u1(cid:45) x1, which is

(cid:26)

qn =

0 ∈ X : ∃x(cid:48)
x(cid:48)
0

u(cid:48)
n(cid:45) x(cid:48)

1

u(cid:48)
n−1(cid:45) · · ·

u(cid:48)
1(cid:45) x(cid:48)

n s.t.

max
i∈{0,1,...,n}

d(H(xi), H(x(cid:48)

n−i)) ≤ δ

(cid:27)

.

However, since qn∩X0 ⊆ XS, we know that there does not exist x(cid:48)
such that maxi∈{0,1,...,n} d(H(xi), H(x(cid:48)
· · ·

u1(cid:45) x1, we know that the system is not δ-approximate initial-state opaque.

0 ∈ X0\XS and x(cid:48)
0

n−i)) ≤ δ. Therefore, by considering xn ∈ X0∩XS and xn

u(cid:48)
n(cid:45) x(cid:48)

1

u(cid:48)
n−1(cid:45) · · ·

u(cid:48)
1(cid:45) x(cid:48)

n
un−1(cid:45)

un(cid:45) xn−1

(⇐) By contradiction: suppose that equation (4.1) holds and assume, for the sake of contradiction, that
S is not δ-approximate initial-state opaque. Then, we know that there exists a secret initial state x0 ∈
un(cid:45) xn such that there does not exist a non-
X0 ∩ XS and a sequence of transitions x0
u(cid:48)
2(cid:45) · · ·
secret initial state x(cid:48)
n such that
maxi∈{0,1,...,n} d(H(xi), H(x(cid:48)

0 ∈ X0 \ XS and a sequence of transitions x(cid:48)
0

u2(cid:45) · · ·

u(cid:48)
n(cid:45) x(cid:48)

u1(cid:45) x1

u(cid:48)
1(cid:45) x(cid:48)

1

i)) ≤ δ. Let us consider the following sequence of transitions in SI
(cid:45) · · ·

(cid:45) (xn−1, q1)

(cid:45) (x0, qn).

(xn, q0)

un−1

I

u1
I

un
I

By Proposition 4.2, we know that
(cid:26)

qn =

0 ∈ X : ∃x(cid:48)
x(cid:48)
0

u(cid:48)
n(cid:45) x(cid:48)

1

u(cid:48)
n−1(cid:45) · · ·

u(cid:48)
1(cid:45) x(cid:48)

n s.t.

max
i∈{0,1,...,n}

d(H(xi), H(x(cid:48)

i)) ≤ δ

(cid:27)

.

Since equation (4.1) holds, we know that qn ∩ X0 (cid:54)⊆ XS. Therefore, there exists a non-secret initial state x(cid:48)
u(cid:48)
u(cid:48)
2(cid:45) · · ·
1(cid:45) x(cid:48)
X0\XS and a sequence of transitions x(cid:48)
0
δ, which is a contradiction. Therefore, S has to be δ-approximate initial-state opaque.

n such that maxi∈{0,1,...,n} d(H(xi), H(x(cid:48)

u(cid:48)
n(cid:45) x(cid:48)

0 ∈
i)) ≤
(cid:3)

1

Proof of Proposition 4.6

Proof. It is straightforward to show (i). Hereafter, we show (ii) by induction on the length of input sequence.

When n = 0, i.e., there is no input sequence, we get that (x0, q0) ∈ XC0. By the deﬁnition of XC0, we know
that

q0 = {x(cid:48)

0 ∈ X0 : d(H(x0), H(x(cid:48)

0)) ≤ δ},

which implies (ii) immediately.

To proceed the induction, we assume that (ii) holds for n = k. Now, we need to show that (ii) also holds for
n = k + 1. To this end, we consider arbitrary pair (x0, q0) ∈ XC0 and ﬁnite run
(cid:45)(x1, q1)

(cid:45)(xn+1, qn+1).

(cid:45)(xn, qn)

(x0, q0)

un+1

(cid:45) · · ·
u2
C

un
C

u1
C

C

Then, we have

qn+1 = ∪ˆu∈UPostˆu(x)∩{x(cid:48)(cid:48)∈X : d(H(x(cid:48)), H(x(cid:48)(cid:48))) ≤ δ}

={x ∈ X : ∃x(cid:48) ∈ qn, u(cid:48)
=(cid:8)x ∈ X: [∃x(cid:48) ∈ qn, u(cid:48)
By the induction hypothesis, we know that

n+1 ∈ U s.t. (x(cid:48), u(cid:48)
n+1 ∈ U s.t. (x(cid:48), un+1, x) ∈ (cid:45)] ∧ [d(H(xn+1), H(x)) ≤ δ](cid:9) .

n+1, x) ∈ (cid:45)} ∩ {x ∈ X : d(H(xn+1), H(x)) ≤ δ}

(cid:26)

qn =

n ∈ X :∃x(cid:48)
x(cid:48)

0 ∈ X0, ∃x(cid:48)
0

u(cid:48)
1(cid:45) x(cid:48)

1

u(cid:48)
2(cid:45) · · ·

u(cid:48)
n(cid:45) x(cid:48)

n s.t.

max
i∈{0,1,...,n}

d(H(xi), H(x(cid:48)

i)) ≤ δ

(cid:27)

.

(.4)

(.5)

22

X. YIN AND M. ZAMANI

Therefore, by combing equations (.4) and (.5), one obtains

(cid:40)

qn+1 =

x ∈ X :

u(cid:48)
1(cid:45) x(cid:48)

∃x(cid:48)

0 ∈ X0, ∃x(cid:48)
0
s.t. maxi∈{0,1,...,n} d(H(xi), H(x(cid:48)
u(cid:48)
2(cid:45) · · ·

u(cid:48)
1(cid:45) x(cid:48)

0 ∈ X0, ∃x(cid:48)
0

1

1

(cid:110)
xn+1 ∈ X : ∃x(cid:48)

=

u(cid:48)
n(cid:45) x(cid:48)

u(cid:48)
2(cid:45) · · ·
i)) ≤ δ ∧ d(H(xn+1), H(x)) ≤ δ

u(cid:48)
n+1(cid:45) x

n

(cid:41)

u(cid:48)
n+1(cid:45) x(cid:48)

n+1 s.t. maxi∈{0,1,...,n+1} d(H(xi), H(x(cid:48)(cid:48)

(cid:111)
i )) ≤ δ

.

Note that, in the second equality of equation (.6), we choose x(cid:48)
induction step holds, which completes the proof.

n+1 = x. Therefore, we conclude that the
(cid:3)

(.6)

Proof of Theorem 4.7

Proof. (⇒) By contraposition: suppose that there exists a state (x, q) ∈ XC such that q ⊆ XS. Let

(x0, q0)

(cid:45) (x1, q1)

u1
C

(cid:45) · · ·
u1
C

(cid:45) (xn, qn),

un
C

be a run reaching (x, q) =: (xn, qn). By Proposition 4.6, we have x0 ∈ X0 and x0
Moreover, one has

u1(cid:45) x1

u2(cid:45) · · ·

un(cid:45) xn.

(cid:26)

qn =

n ∈ X : ∃x(cid:48)
x(cid:48)

0 ∈ X0, ∃x(cid:48)
0

u(cid:48)
1(cid:45) x(cid:48)

1

u(cid:48)
2(cid:45) · · ·

u(cid:48)
n(cid:45) x(cid:48)

n s.t.

max
i∈{0,1,...,n}

d(H(xi), H(x(cid:48)

i)) ≤ δ!

(cid:27)

.

Since qn ⊆ XS, one obtains that xn ∈ qn ⊆ XS and there does not exist an initial state x(cid:48)
x(cid:48)
0

n such that xn ∈ X \ XS and maxi∈{0,1,...,n} d(H(xi), H(x(cid:48)
u2(cid:45) · · ·

0 ∈ X0 and a run
i)) ≤ δ. Therefore,
un(cid:45) xn, we know that the system is not δ-approximate current-state

u(cid:48)
2(cid:45) · · ·

u1(cid:45) x1

u(cid:48)
n(cid:45) x(cid:48)

1

u(cid:48)
1(cid:45) x(cid:48)
by considering x0
opaque.

u1(cid:45) x1
u(cid:48)
1(cid:45) x(cid:48)

(⇐) By contradiction: suppose that equation (4.2) holds and assume, for the sake of contradiction, that S is
not δ-approximate current-state opaque. Then, we know that there exists an initial state x0 ∈ X0 and a run
0 ∈ X0 and a
x0
run x(cid:48)
i)) ≤ δ. Let us
0
consider the following sequence of transitions in SC
(cid:45) (x1, q1)

un(cid:45) xn, where xn ∈ XS, such that there do not exist an initial state x(cid:48)

n ∈ X \ XS and maxi∈{0,1,...,n} d(H(xi), H(x(cid:48)

u2(cid:45) · · ·
u(cid:48)
2(cid:45) · · ·

n such that x(cid:48)

(cid:45) (xn, qn),

u(cid:48)
n(cid:45) x(cid:48)

(x0, q0)

1

(cid:45) · · ·
u2
C

un
C

u1
C

where q0 = {x ∈ X0 : d(H(x0), H(x)) ≤ δ}. By Proposition 4.6, we obtain that

(cid:26)
n ∈ X : ∃x(cid:48)
x(cid:48)

0 ∈ X0, ∃x(cid:48)
0

qn =

u(cid:48)
1(cid:45) x(cid:48)

1

u(cid:48)
2(cid:45) · · ·

u(cid:48)
n(cid:45) x(cid:48)

n s.t.

max
i∈{0,1,...,n}

d(H(xi), H(x(cid:48)

i)) ≤ δ

(cid:27)

.

Since equation (4.2) holds, we know that qn (cid:54)⊆ XS. Therefore, there exist an initial state x(cid:48)
x(cid:48)
0
contradiction. Therefore, S has to be δ-approximate current-state opaque.

0 ∈ X0 and a run
i)) ≤ δ and xn ∈ X \ XS, which is a
(cid:3)

n such that maxi∈{0,1,...,n} d(H(xi), H(x(cid:48)

u(cid:48)
2(cid:45) · · ·

u(cid:48)
n(cid:45) x(cid:48)

u(cid:48)
1(cid:45) x(cid:48)

1

Proof of Theorem 4.8

Proof. By contraposition: suppose that there exist two states (xn, q(cid:48)
and qn ∩ q(cid:48)

n) ∈ XI , (xn, qn) ∈ XC such that xn ∈ XS

(cid:45) · · ·
u2
C

(cid:45) (xn, qn)(xn+m, qn+m)

un
C

un+m

(cid:45) (xn+m−1, qn+m−1)

I

un+m−1

(cid:45) un+1

(cid:45) (xn, q(cid:48)
n)

I

I

n ⊆ XS. Let
(cid:45) (x1, q1)
u1
C

(x0, q0)

be two runs reaching (x, q) and (x, q(cid:48)), respectively. By Propositions 4.2 and 4.6, we have x0 ∈ X0 and
un(cid:45)xn

un+m(cid:45)xn+m.

un−1(cid:45)xn−1

un+1(cid:45)xn+1

un+2(cid:45) · · ·

u1(cid:45) · · ·

x0

ON APPROXIMATE OPACITY OF CYBER-PHYSICAL SYSTEMS

23

Moreover, one has

(cid:40)

qn ∩ q(cid:48)

n =

x(cid:48)
n ∈ X :

∃x(cid:48)

u(cid:48)
n+m(cid:45) x(cid:48)
s.t. maxi∈{0,1,...,n+m} d(H(xi), H(x(cid:48)

0 ∈ X0, ∃x(cid:48)
0

u(cid:48)
1(cid:45) · · ·

(cid:41)

.

n+m
i)) ≤ δ
u(cid:48)
1(cid:45) · · ·

n ⊆ XS, we know that there does not exist x(cid:48)

n ∈ X \ XS and maxi∈{0,1,...,n+m} d(H(xi), H(x(cid:48)

n+m such
i)) ≤ δ. Therefore, the system is not δ-approximate

0 ∈ X0 and x(cid:48)
0

u(cid:48)
n+m(cid:45) x(cid:48)

However, since qn ∩ q(cid:48)
that x(cid:48)
inﬁnite-step opaque.

(⇐) By contradiction: suppose that equation (4.3) holds and assume, for the sake of contradiction, that S is
not δ-approximate inﬁnite-step opaque. Then, we know that there exists an initial state x0 ∈ X0, a sequence
un(cid:45) xn and an index k ∈ {0, . . . , n} such that xk ∈ XS and there does
of transitions x0
u(cid:48)
1(cid:45) x(cid:48)
not exist an initial state x(cid:48)
n such that
1
x(cid:48)
k ∈ X \ XS and maxi∈{0,1,...,n} d(H(xi), H(x(cid:48)
i)) ≤ δ. Let us consider the following sequence of transitions in
SC

u2(cid:45) · · ·
0 ∈ X0 and a sequence of transitions x(cid:48)
0

u(cid:48)
2(cid:45) · · ·

u(cid:48)
n(cid:45) x(cid:48)

u1(cid:45) x1

(x0, q0)

(cid:45) (x1, q1)

u1
C

(cid:45) · · ·
u2
C

(cid:45) (xk, qk),

uk
C

and the following sequence of transitions in SI

(xn, q(cid:48)

n)

(cid:45) (xn−1, q(cid:48)

n−1)

un
I

un−1

(cid:45) · · ·

I

uk+1

(cid:45) (xk, q(cid:48)

k).

I

By Propositions 4.2 and 4.6, we know that

qn ∩ q(cid:48)

n =

(cid:26)
k ∈ X : ∃x(cid:48)
x(cid:48)

0 ∈ X0, ∃x(cid:48)
0

u(cid:48)
1(cid:45) · · ·

u(cid:48)
n(cid:45) x(cid:48)

n s.t.

max
i∈{0,1,...,n}

d(H(xi), H(x(cid:48)

i)) ≤ δ

(cid:27)

.

Since equation (4.3) holds, we know that qn ∩ q(cid:48)
transitions x(cid:48)
0
contradiction. Therefore, S has to be δ-approximate inﬁnite-step opaque.

u(cid:48)
1(cid:45) · · ·

n such that xk ∈ X \ XS and maxi∈{0,1,...,n} d(H(xi), H(x(cid:48)

n (cid:54)⊆ XS. Therefore, there exists x(cid:48)

0 ∈ X0 and a sequence of
i)) ≤ δ , which is a
(cid:3)

u(cid:48)
n(cid:45) x(cid:48)

References

[BDT18]

[BKMR08]

[BMS15]

[CDM12]

[CFML18]

[CIK17]

[CMPM14]

[DDM10]

F. Basile and G. De Tommasi. An algebraic characterization of language-based opacity in labeled Petri nets. In
14th International Workshop on Discrete Event Systems, pages 329–336, 2018.
J. W. Bryans, M. Koutny, L. Mazar´e, and P. Y. A. Ryan. Opacity generalised to transition systems. International
Journal of Information Security, 7(6):421–435, Nov 2008.
B. B´erard, J. Mullins, and M. Sassolas. Quantifying opacity. Math. Structures in Computer Science, 25(2):361–403,
2015.
F. Cassez, J. Dubreil, and H. Marchand. Synthesis of opaque systems with static and dynamic masks. Formal
Methods in System Design, 40(1):88–115, 2012.
X. Cong, M.P. Fanti, A.M. Mangini, and Z. Li. On-line veriﬁcation of current-state opacity by petri nets and integer
linear programming. Automatica, 94:205–213, 2018.
J. Chen, M. Ibrahim, and R. Kumar. Quantiﬁcation of secrecy in partially observed stochastic discrete event
systems. IEEE Trans. Automation Science and Engineering, 14(1):185–195, 2017.
S. Ch´edor, C. Morvan, S. Pinchinat, and H. Marchand. Diagnosis and opacity problems for inﬁnite state systems
modeled by recursive tile systems. Discrete Event Dynamic Systems, 25(1-2):271–294, 2014.
J. Dubreil, P. Darondeau, and H. Marchand. Supervisory control for opacity. IEEE Trans. Aut. Cont., 55(5):1089–
1100, 2010.

[FDSPDB18] G. Fiore, E. De Santis, G. Pola, and M.D. Di Benedetto. On approximate predictability of metric systems. In 6th

[GP07]

[GPT10]

[JLF16]

[JWL18]

IFAC Conference on Analysis and Design of Hybrid Systems, pages 169–174, 2018.
A. Girard and G. J. Pappas. Approximation metrics for discrete and continuous systems. IEEE Transactions on
Automatic Control, 52(5):782–798, May 2007.
A. Girard, G. Pola, and P. Tabuada. Approximately bisimilar symbolic models for incrementally stable switched
systems. IEEE Transactions on Automatic Control, 55(1):116–126, 2010.
R. Jacob, J.-J. Lesage, and J.-M. Faure. Overview of discrete event systems opacity: Models, validation, and
quantiﬁcation. Annual Reviews in Control, 41:135–146, 2016.
Y. Ji, Y.-C. Wu, and S. Lafortune. Enforcement of opacity by public and private insertion functions. Automatica,
93:369–378, 2018.

24

[KH13]

[KH18]

[KK12]

[Lin11]
[LLH18]

[Maz04]

[MJL18]

X. YIN AND M. ZAMANI

K. Kobayashi and K. Hiraishi. Veriﬁcation of opacity and diagnosability for pushdown systems. Journal of Applied
Mathematics, 2013, 2013.
C. Keroglou and C.N. Hadjicostis. Probabilistic system opacity in discrete event systems. Discrete Event Dyn. Sys.:
Theory & Apl., 28(2):289–314, 2018.
K.-D. Kim and P.R. Kumar. Cyber–physical systems: A perspective at the centennial. Proceedings of the IEEE,
100(Special Centennial Issue):1287–1308, 2012.
F. Lin. Opacity of discrete event systems and its applications. Automatica, 47(3):496–503, March 2011.
S. Lafortune, F. Lin, and C.N. Hadjicostis. On the history of diagnosability and opacity in discrete event systems.
Annual Reviews in Control, 45:257–266, 2018.
L. Mazar´e. Using uniﬁcation for opacity properties. Proceedings of the Workshop on Issues in the Theory of Security,
7:165–176, 2004.
S. Mohajerani, Y. Ji, and S. Lafortune. Eﬃcient synthesis of edit functions for opacity enforcement using
bisimulation-based abstractions. In IEEE Conference on Decision and Control, pages 4849–4854, 2018.

[NHLH18a] M. Noori-Hosseini, B. Lennartson, and C. Hadjicostis. Compositional visible bisimulation abstraction applied to

opacity veriﬁcation. In 14th International Workshop on Discrete Event Systems, pages 434–441, 2018.

[NHLH18b] M. Noori-Hosseini, B. Lennartson, and C. Hadjicostis. Incremental observer reduction applied to opacity veriﬁcation

and synthesis. arXiv:1812.08083, 2018.

[PDSDB18] G. Pola, E. De Santis, and M.D. Di Benedetto. Approximate diagnosis of metric systems. IEEE Control Systems

[RCM16a]

[RCM16b]

[RCM17]

[Rei11]

[SAJ15]

[SGZ17]

[SH11]

[SH12]

[SH13]

[SH14]

[Tab09]

Letters, 2(1):115–120, 2018.
B. Ramasubramanian, R. Cleaveland, and S.I. Marcus. A framework for decentralized opacity in linear systems. In
54th Annual Allerton Conference on Communication, Control, and Computing, pages 274–280, 2016.
B. Ramasubramanian, R. Cleaveland, and S.I. Marcus. A framework for opacity in linear systems. In American
Control Conference, pages 6337–6344, 2016.
B. Ramasubramanian, R. Cleaveland, and S.I. Marcus. Opacity for switched linear systems: Notions and charac-
terization. In 56th IEEE Conference on Decision and Control, pages 5310–5315, 2017.
G. Reissig. Computing abstractions of nonlinear systems. IEEE Transactions on Automatic Control, 56(11):2583–
2598, Nov 2011.
H. Sandberg, S. Amin, and K.H. Johansson. Cyberphysical security in networked control systems. IEEE Control
Systems, 35(1):20–23, 2015.
A. Swikir, A. Girard, and M. Zamani. From dissipativity theory to compositional synthesis of symbolic models.
arXiv: 1710.05585, October 2017.
A. Saboori and C.N. Hadjicostis. Veriﬁcation of K-Step Opacity and Analysis of Its Complexity. IEEE Transactions
on Automation Science and Engineering, 8(3):549–559, July 2011.
A. Saboori and C.N. Hadjicostis. Veriﬁcation of inﬁnite-step opacity and complexity considerations. IEEE Trans-
actions on Automatic Control, 57(5):1265–1269, May 2012.
A. Saboori and C.N. Hadjicostis. Veriﬁcation of initial-state opacity in security applications of discrete event
systems. Information Sciences, 246:115–132, 2013.
A. Saboori and C.N. Hadjicostis. Current-state opacity formulations in probabilistic ﬁnite automata. IEEE Trans-
actions on Automatic Control, 59(1):120–133, 2014.
P. Tabuada. Veriﬁcation and Control of Hybrid Systems: A Symbolic Approach. Springer Publishing Company, 1st
edition, 2009.

[TLSG17a] Y. Tong, Z. Li, C. Seatzu, and A. Giua. Decidability of opacity veriﬁcation problems in labeled Petri net systems.

Automatica, 80:48–53, 2017.

[TLSG17b] Y. Tong, Z. Li, C. Seatzu, and A. Giua. Veriﬁcation of state-based opacity using petri nets. IEEE Transactions on

[TLSG18]

[Tra18]

[WL13]

[WL18]

[WLL18]

[YL16]

[YL17]

[YLWL19]

Automatic Control, 62(6):2823–2837, 2017.
Y. Tong, Z. Li, C. Seatzu, and A. Giua. Current-state opacity enforcement in discrete event systems under incom-
parable observations. Discrete Event Dynamic Systems: Theory & Appllications, 28(2):161–182, 2018.
D. N. Tran. Advances in stability analysis for nonlinear discrete-time dynamical systems. PhD thesis, The Univer-
sity of Newcastle, 2018.
Y. Wu and S. Lafortune. Comparative analysis of related notions of opacity in centralized and coordinated archi-
tectures. Discrete Event Dynamic Systems, 23(3):307–339, Sep 2013.
B. Wu and H. Lin. Privacy veriﬁcation and enforcement via belief abstraction. IEEE Control Systems Letters,
2(4):815–820, 2018.
B. Wu, Z. Liu, and H. Lin. Parameter and insertion function co-synthesis for opacity enhancement in parametric
stochastic discrete event systems. In American Control Conference, pages 3032–3037, 2018.
X. Yin and S. Lafortune. A uniform approach for synthesizing property-enforcing supervisors for partially-observed
discrete-event systems. IEEE Trans. Aut. Cont., 61(8):2140–2154, 2016.
X. Yin and S. Lafortune. A new approach for the veriﬁcation of inﬁnite-step and K-step opacity using two-way
observers. Automatica, 80:162–171, 2017.
X. Yin, Z. Li, W. Wang, and S. Li. Inﬁnite-step opacity and K-step opacity of stochastic discrete-event systems.
Automatica, 99:266–274, 2019.

ON APPROXIMATE OPACITY OF CYBER-PHYSICAL SYSTEMS

25

[YZ19]

[ZAG15]

X. Yin and M. Zamani. Towards approximate opacity of cyber-physical systems. In 10th ACM/IEEE International
Conference on Cyber-Physical Systems, 2019.
M. Zamani, A. Abate, and A. Girard. Symbolic models for stochastic switched systems: A discretization and a
discretization-free approach. Automatica, 55:183–196, 2015.

[ZPMT12] M. Zamani, G. Pola, M. Mazo, and P. Tabuada. Symbolic models for nonlinear control systems without stability

[ZSL15]

[ZYZ18]

assumptions. IEEE Transactions on Automatic Control, 57(7):1804–1809, July 2012.
B. Zhang, S. Shu, and F. Lin. Maximum information release while ensuring opacity in discrete event systems. IEEE
Transactions on Automation Science and Engineering, 12(3):1067–1079, 2015.
K. Zhang, X. Yin, and M. Zamani. Opacity of nondeterministic transition systems: A (bi)simulation relation
approach. https: // arxiv. org/ abs/ 1802. 03321 , 2018.

1Department of Automation, Shanghai Jiao Tong University, Shanghai, China.

E-mail address: yinxiang@sjtu.edu.cn

2Computer Science Department, University of Colorado Boulder, CO 80309, USA.

E-mail address: majid.zamani@colorado.edu

