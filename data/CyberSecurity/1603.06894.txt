Secure State Estimation for Nonlinear Power Systems under Cyber Attacks

Qie Hu*, Dariush Fooladivanda*, Young Hwan Chang*, and Claire J. Tomlin

6
1
0
2

r
a

M
2
2

]

Y
S
.
s
c
[

1
v
4
9
8
6
0
.
3
0
6
1
:
v
i
X
r
a

Abstract— This paper focuses on securely estimating the state
of a nonlinear dynamical system from a set of corrupted
measurements. In particular, we consider two broad classes of
nonlinear systems, and propose a technique which enables us to
perform secure state estimation for such nonlinear systems. We
then provide guarantees on the achievable state estimation error
against arbitrary corruptions, and analytically characterize the
number of errors that can be perfectly corrected by a decoder.
To illustrate how the proposed nonlinear estimation approach
can be applied to practical systems, we focus on secure estima-
tion for the wide area control of an interconnected power system
under cyber-physical attacks and communication failures, and
propose a secure estimator for the power system. Finally, we
numerically show that the proposed secure estimation algorithm
enables us to reconstruct the attack signals accurately.

I. INTRODUCTION

Today’s critical infrastructures are mostly managed by
cyber-physical systems (CPS) that consist of several actua-
tors, sensors, and controllers. Securing these systems against
malicious attacks or communication failures is an important
problem [1]. In recent years, researchers have investigated
various aspects of the problem of securing complex CPS,
e.g., the networking security among cyber devices [2]- [6]
and the early detection of faults/attacks [7]- [8]. From the
controller’s point of view, researchers have studied how we
can securely estimate the state of a dynamical system from a
set of noisy and maliciously corrupted sensor measurements.
In particular, researchers have focused on linear dynamical
systems, and have tried to understand how the system dy-
namics can be leveraged for security guarantees.

In [9], Pasqualetti et al. propose a mathematical framework
for cyber-physical systems, attacks, and monitors. They study
the fundamental monitoring limitations for linear systems
(especially for power networks), and characterize the vulner-
ability of linear systems to cyber-physical attacks using graph
theory. Finally, to detect and to identify attacks, the authors
propose centralized and decentralized ﬁlters, and validate
their results via several examples. The main limitation of
the study is that the proposed ﬁlters are computationally
expensive, and are hard to implement in practice. In [10],
Fawzi et al. focus on secure estimation and control of linear
time-invariant systems, and assume that the set of attacked
nodes does not change over time. The authors then formulate
the system under attack as an estimation problem without
any limiting assumption on attack signals, and propose a
novel method for error estimation and correction. The main
drawback of the study is that the set of attacked nodes is
assumed to be ﬁxed. Chang et al. [11] extend the results
in [10] to scenarios in which the set of attacked nodes can
change over time, and show that under a certain condition,

the secure estimation problem with time-varying attacked
nodes is equivalent to the classical error correction problem.
The authors provide a novel method to guarantee accurate
decoding, and then propose a secure estimation method
which is a combination of the proposed secure estimator and
the Kalman Filter (KF). Finally, they demonstrate the per-
formance of their algorithm through numerous simulations.
Extensive work has been done on secure estimation for
linear dynamical systems, here, we focus on the design of
a secure state estimator for nonlinear systems. We study
the secure estimation of the state of a nonlinear dynamical
system from a set of corrupted measurements. In particular,
we focus on two broad classes of nonlinear systems, and
propose a technique which enables us to transform the
nonlinear dynamics into a set of linear equations. We then
apply the classical error correction method to the equivalent
linear system, and provide guarantees on the achievable state
estimation error against arbitrary corruptions. In this paper,
we do not assume the sensor attacks or corruptions to follow
any particular model. The only assumption concerning the
corrupted sensors is about the number of sensors that are
corrupted due to attacks or failures. Our analytical results
characterize the number of errors that can be perfectly
corrected by an estimator.

As mentioned earlier, we focus on two broad classes of
nonlinear systems in this paper. In order to illustrate how
the proposed nonlinear state estimation approach can be
applied to practical systems, we consider an interconnected
power system comprising several synchronous generators,
transmission lines, and energy storage units. We assume
that all
these physical devices are controlled via wide
area control systems (WACS) as well as local controllers
which use the synchrophasor technology to maintain the
system’s stability. WACS employ advanced data acquisition,
communications, and control to enable increased efﬁciency
and reliability of power delivery [12]- [14]. While WACS
are the most promising technology to detect small signal
instabilities in large power systems, their performance is
highly dependent on the received data and on the underlying
communication network. Clearly, the greater dependence on
communication systems increases opportunities for cyber-
physical attacks and disturbances. Extensive work has been
done on monitoring and on autonomous feedback control for
WACS [15], but this work has not studied how to identify
cyber-physical attacks or communication failures, and how
to perform secure state estimation for WACS.

In this paper, we focus on secure estimation for the
wide area control of an interconnected power system, and
assume that the system operator has installed several phasor

 
 
 
 
 
 
measurement units (PMU) at different generator buses in
the power network. These PMUs are connected through a
communication network which sends PMU measurements,
including rotors’ speeds and generators’ phase angles, to
different controllers in the system. We also assume that there
are several communication channels between generators and
the WACS, as well as channels between generators. These
channels and PMUs are not secured and are subject to cyber
attacks and failures (except
the communication channels
from the WACS to the generators). Therefore, the WACS
needs to perform secure state estimation to reconstruct the
system’s states before using the received data for computing
wide area control signals, and to monitor the operation of
local controllers installed in the system. We develop a secure
state estimator for the WACS by using the proposed secure
state estimation technique for nonlinear systems.

The paper is organized as follows: In Section II, we review
the classical error correction methods. We then formulate the
nonlinear state estimation problem and propose a solution
technique for the proposed problem in Section III. We
illustrate how the proposed secure state estimation approach
can be applied to practical systems in Section IV and V.
Finally, we provide a numerical example in Section VI.

II. ERROR CORRECTION: A REVIEW

A. Classical Error Correction

Compressed Sensing: Sparse solutions x ∈ Rn, are

sought to the following problem:

min
x

(cid:107)x(cid:107)0 subject to b = Ax

(1)

where b ∈ Rm are the measurements, A ∈ Rm×n (m (cid:28) n)
is a sensing matrix and (cid:107)x(cid:107)0 denotes the number of nonzero
elements of x. The following lemma provides a sufﬁcient
condition for a unique solution to (1):

Lemma 1: ([16]) If the sparsest solution to (1) has (cid:107)x(cid:107)0 =
q and m ≥ 2q and all subsets of 2q columns of A are full
rank, then the solution is unique.
Proof : Suppose the solution is not unique, hence there exists
x1 (cid:54)= x2 such that Ax1 = b and Ax2 = b where (cid:107)x1(cid:107)0 =
(cid:107)x2(cid:107)0 = q. Then A(x1 − x2) = 0 and x1 − x2 (cid:54)= 0. Since
(cid:107)x1 − x2(cid:107)0 ≤ 2q and all 2q columns of A are full rank (i.e.
linearly independent), it is impossible to have x1 − x2 (cid:54)= 0
that satisﬁes A(x1 − x2) = 0 (contradiction).

The Error Correction Problem [16]: Consider the clas-
sical error correction problem: y = Cx + e where C ∈ Rl×n
is a coding matrix (l > n) and assumed to be full rank.
We wish to recover the input vector x ∈ Rn from corrupted
measurements y. Here, e is an arbitrary and unknown sparse
error vector. To reconstruct x, note that
is obviously
sufﬁcient to reconstruct the vector e since knowledge of
Cx + e together with e gives Cx, and consequently x since
C has full rank [16]. In [16], the authors construct a matrix
F which annihilates C on the left, i.e., F Cx = 0 for all x.
Then, they apply F to the output y and obtain

it

˜y = F (Cx + e) = F e.

(2)

Thus,
the decoding problem can be reduced to that of
reconstructing a sparse vector e from the observations ˜y =
F e. Therefore, by Lemma 1, if all subsets of 2q columns
of F are full rank, then we can reconstruct any e such that
(cid:107)e(cid:107)0 ≤ q.

B. Secure Estimation via Error Correction (Linear Systems)
[11]

Consider the linear control system as follows:

x(k + 1) = Ax(k), y(k) = Cx(k) + e(k)

(3)

where x(k) ∈ Rn and y(k) ∈ Rp represent the states and
outputs of the system at time k, respectively. e(k) ∈ Rp
represents attack signals injected by malicious agents at the
sensors, and the set of attacked sensors can change over time.
Consider the problem of reconstructing the initial state
x(0) of the plant from the corrupted observations y(k)’s
where k = 0, ..., T − 1. Let Eq,T denote the set of error
vectors (cid:2)e(0); ... ; e(T − 1)(cid:3) ∈ Rp·T where each e(k) satis-
ﬁes (cid:107)e(k)(cid:107)0 ≤ q ≤ p.







=






Cx(0) + e(0)
CAx(0) + e(1)
...
CAT −1x(0) + e(T − 1)











(4)

Y (cid:44)

=

y(0)
y(1)
...
y(T − 1)


C
CA
...
CAT −1













x(0) + Eq,T (cid:44) Φx(0) + Eq,T






where Y ∈ Rp·T is a collection of corrupted measurements
over T time steps and Φ ∈ Rp·T ×n represents the observ-
ability matrix of the system. We assume that rank(Φ) = n.
This is a reasonable assumption because if not, the system
is unobservable, therefore we cannot determine x(0) even if
there was no attack (Eq,T = 0).

Inspired by error correction techniques proposed in [16]
and [18], we ﬁrst determine the error vector Eq,T , and
then solve for x(0). Consider the QR decomposition of
Φ ∈ Rp·T ×n,

Φ = (cid:2)Q1 Q2

(cid:3)

(cid:21)

(cid:20)R1
0

= Q1R1

(5)

(cid:3) ∈ Rp·T ×p·T is orthogonal, Q1 ∈
where (cid:2)Q1 Q2
Rp·T ×n, Q2 ∈ Rp·T ×(p·T −n), and R1 ∈ Rn×n is a rank-n
upper triangular matrix. Pre-multiplying (4) by (cid:2)Q1 Q2
(cid:3)(cid:62)
gives:

(cid:21)

(cid:20)Q(cid:62)
1
Q(cid:62)
2

(cid:21)

(cid:20)R1
0

(cid:21)

(cid:20)Q(cid:62)
1
Q(cid:62)
2

Y =

x(0) +

Eq,T .

(6)

We can solve for Eq,T using the second block row:

˜Y (cid:44) Q(cid:62)

2 Y = Q(cid:62)

2 Eq,T

(7)

2 ∈ R(p·T −n)×p·T . From Lemma 1, (7) has a
where Q(cid:62)
unique, s(≤ q·T )-sparse solution if all subsets of 2s(≤ 2q·T )
columns of Q(cid:62)
2 are full rank (this is a reasonable assumption

if (p · T − n) ≥ 2s = 2q · T ). Thus, we consider solving the
following l1-minimization problem:

x(k+1)−Ax(k)−u(k) for all k, therefore, we can construct
a vector Y as follows:

ˆEq,T = arg min
E

(cid:107)E(cid:107)l1

subject to ˜Y = Q(cid:62)

2 E

(8)

Given ˆEq,T , we can then solve for x(0) from the ﬁrst

Y =

block row of (6):

x(0) = R−1

1 Q(cid:62)

1 (Y − ˆEq,T )

(9)

The conditions for the existence of a unique solution are
stated in the following Lemma.

Lemma 2: ([11]) x(0) is the unique solution if all subsets
of 2s columns of Q(cid:62)
2 are linearly independent and Φ is full
column rank. Also, this condition is equivalent to (cid:107)Φz(cid:107)0 >
2s for all z ∈ Rn\{0}.
Proof : By Lemma 1 and noting that by deﬁnition the null
space of Q(cid:62)
2 equals the column space of Φ. For the second
statement, we refer to the proof of Proposition 2 in [11].

III. SECURE ESTIMATION FOR NONLINEAR SYSTEMS

A. Problem Formulation

Consider a nonlinear dynamical system given by
x(k + 1) = Ax(k) + f (cid:0)x(k), e(k)(cid:1) + u(k)

y(k) = Cx(k) + e(k)












y(0)
y(1) − C(cid:0)g(y(0)) + u(0)(cid:1)


y(2) − C(cid:0)Ag(y(0)) + Au(0) + g(y(1)) + u(1)(cid:1)


...


y(T − 1) − C(cid:0)AT −2g(y(0)) + AT −2u(0) + · · · (cid:1)

e(0)
e(1)
e(2)
...
e(T − 1)

C
CA
CA2
...
CAT −1

= Φx(0) + E

x(0) +



































=

(12)
where E = [e(0); e(1); · · · ; e(T − 1)] ∈ Rp·T is the set of
error vectors, and Φ = [C; CA; CA2; · · · ; CAT −1].

We can now apply the error correction technique intro-
duced in Section II to the linear system in (12). While
the proposed technique is very useful in reconstructing the
initial state x(0), we might not always be able to ﬁnd a
mapping function g(·) such that (11) is satisﬁed. Next, we
use feedback linearization to generalize our result to a larger
class of nonlinear systems.

(10)

C. Feedback Linearization

where x(k) ∈ Rn represents the state at time k ∈ N, A ∈
Rn×n, f (x(k), e(k)) : Rn ×Rp → Rn represent the system’s
dynamics, and u(k) ∈ Rn is a control input. Also, C ∈
Rp×n is the sensors’ measurement matrix, y(k) ∈ Rp are the
corrupted measurements at time k, and e(k) ∈ Rp represents
attack signals injected by malicious agents at the sensors. If
sensor i ∈ {1, 2, · · · , p} is not attacked, then necessarily
the i-th element of e(k) is zero; otherwise, the i-th element
of e(k) can take any value in R (i.e., we do not assume
the errors e(k) to follow any particular model). The only
assumption concerning the corrupted sensors is the number
of sensors that are attacked or corrupted due to failures. Our
analytical results then characterize the number of errors that
can be corrected by a decoder.

Under certain conditions which are explained at the end of
the next subsection, the problems of reconstructing the state
x(k) or the initial condition x(0) are equivalent. Therefore,
in the following, we focus on the problem of reconstructing
the initial state x(0) for two classes of nonlinear systems.

B. Existence of Mapping Function with Error Correction

Let us assume that

there exists a mapping function

g(cid:0)y(k)(cid:1) : Rp → Rn such that

g(cid:0)y(k)(cid:1) = f (cid:0)x(k), e(k)(cid:1) .

(11)

By using measurements y(k) and this mapping function
g(cid:0)y(k)(cid:1), we can transform the nonlinear system in (10) into
a linear system for which the error correction technique
introduced in Section II can be used to reconstruct
the
initial state x(0). From (10) and (11), we have g(cid:0)y(k)(cid:1) =

Let us assume that there exist mapping functions g(cid:0)y(k)(cid:1)
(cid:0)x(k)(cid:1) (possibly nonlinear), and a linear map

and h1
h2

(cid:0)e(k)(cid:1) such that:

f (cid:0)x(k), e(k)(cid:1) = g(cid:0)y(k)(cid:1) + h1

(cid:0)x(k)(cid:1) + h2

(cid:0)e(k)(cid:1)

(13)

(cid:0)x(k)(cid:1) : Rn → Rn, and
(cid:0)e(k)(cid:1) : Rp → Rn are non-zero. The control input can be
(cid:0)x(k)(cid:1) + v(k) which cancels

where g(cid:0)y(k)(cid:1) : Rp → Rn, h1
h2
chosen such that u(k) = −h1
out the nonlinear term h1

(cid:0)x(k)(cid:1) and gives:

g(cid:0)y(k)(cid:1) = x(k + 1) − Ax(k) − v(k) − h2

(cid:0)e(k)(cid:1).

We can now construct a vector Y as follows:

Y =



y(0)
y(1) − C(cid:0)g(y(0)) + v(0)(cid:1)


y(2) − C(cid:0)Ag(y(0)) + Av(0) + g(y(1)) + v(1)(cid:1)


...


y(T − 1) − C(cid:0)AT −2g(y(0)) + AT −2v(0) + · · · (cid:1)










= Φx(0) + E +

CAh2










0
(cid:0)e(0)(cid:1)
Ch2
(cid:0)e(0)(cid:1) + Ch2
...
(cid:0)e(0)(cid:1) · · ·
CAT −2h2

(cid:0)e(1)(cid:1)










.

Since h2(·) is a linear map (i.e., h2
H ∈ Rn×p), thus:

(14)
(cid:0)e(k)(cid:1) = He(k) where

Y = Φx(0) + ΨE

(15)

where the matrices Φ ∈ Rp·T ×n and Ψ ∈ Rp·T ×p·T are as
follows








Φ =

C
CA
CA2
...
CAT −1








, Ψ =















I

I
CH
CAH
. . .

CH I
. . .
. . .
CAT −2H · · ·
· · ·

.








I

. . .
· · ·

We can now apply the error correction method introduced in
Section II to the linearized system in (15) and reconstruct
x(0) if we satisfy the condition in Lemma 2.

Next, we consider an interconnected power system with
several synchronous generators, and illustrate how the pro-
posed nonlinear state estimation approach can be applied for
the secure state estimation of practical systems.

IV. APPLICATION TO POWER SYSTEM STATE
ESTIMATION
Consider a power system comprising N generators, and
q > N buses indexed by g1, · · · , gN and b1, · · · , bq, respec-
tively. Let b1, · · · , bN be the generator terminal buses, each
one connected to exactly one generator, and let bN +1, · · · , bq
be the load buses. Let B and V denote the set of buses and
transmission lines, respectively. We assume that the network
topology is ﬁxed and known (i.e., the neighbors of each bus
are known), and that the corresponding graph H(B, V) is
connected.

Load buses: Let Vi and δi denote the magnitude and phase
angle of the voltage phasor, respectively, at load bus i. Let
P e
i be the total active power leaving bus i (i.e., the real power
drawn by the load at bus i). P e

i can be computed by

P e

i =

(cid:88)

j∈B

ViVj|yij| sin(δi − δj + φij)

(16)

√

−1bij is the admittance of the line
where yij = gij +
between buses i and j, and φij equals arctan(gij/bij). Note
that gij = gji ≥ 0 and bij = bji > 0 are the conductance and
susceptance of the line between buses i and j, respectively.
Generator buses: Let G denote the set of generators in the
system. Let (cid:99)Ei = Ei θi denote the internal voltage phasor of
generator i. According to the synchronous machine theory,
Ei is constant and θi is the angular position of the generator
rotor. We assume that the voltages at the generator buses
are controlled via droop control, and that all the generator
terminal buses are equipped with fast response energy storage
units which are controlled via local and wide area controllers.
Under these assumptions, at each generator i ∈ G,
the
dynamic variables are the generator phase angle θi and the
rotor speed ωi, and the generator dynamics can be described
by [19]

˙θi = ωi − ωs
2Hi
ωs

˙ωi = P m

i − P e

i −

di
ωs

ωi + Ui

(17)

(18)

Fig. 1. The networked system: the communication network and the power
system.

and P m
is the mechanical power input to the generator. As
i
mentioned earlier, each generator terminal bus bi is equipped
with a fast response energy storage, such as ﬂywheels, to
improve the system stability. The energy storage receives a
measurement-based control signal, and supplies or absorbs
Ui into bus bi. Similar to the study in [20], we develop a
feedback linearization controller, and assume that generator i
implements the following feedback linearization control law

Ui = − P m

i + P e

i,meas − Fi (ωi − ωs) .

(19)

where P e
i,meas is computed locally at generator i using re-
ceived phase angle measurements and Fi ≥ 0 is a design
parameter. The energy storage injects Ui per unit values of
power into generator bus bi if Ui ≥ 0; otherwise, it absorbs
Ui per unit values of power from generator bus bi.

Wide Area Control System (WACS): To maintain the
system’s stability, the system operator installs several PMUs
at different buses in the power network. These PMUs are
connected through a communication network which sends
PMU measurements, including rotors’ speeds and generators’
phase angles, to different controllers in the system. We as-
sume that there are several communication channels between
generators and the WACS, as well as channels between
generators as shown in Fig. 1. These channels and PMUs
are not secured and are subject to cyber attacks and failures
(except the communication channels from the WACS to the
generators). Therefore, the WACS needs to perform secure
state estimation before using the received data (e.g., ωi’s
and θi’s) for computing wide area control signals and for
monitoring local controllers. Next, by using the proposed
secure state estimation technique, we develop a secure state
estimator for the WACS.

V. SECURE STATE ESTIMATOR FOR WIDE AREA
CONTROL SYSTEMS

where ωs is the nominal speed, Hi is the machine inertia
constant, di is the damping coefﬁcient of the generator, Ui
is the external stabilizing energy source at generator bus bi,

We begin with deriving the system dynamics. The
algebraic-differential equations (16)-(18) describe system
dynamics and power ﬂows in the power system. However,

123…NijNon‐secured Information Flow (Control)Non‐secured Information Flow (Monitoring)Power System NetworkWACSAttack Type mAttack Type cwe can use the Kron reduction technique to reduce the
model in (16)-(18) into a purely differential model, i.e., a
network of electro-mechanical oscillators comprising the N
generators connected to each other through L transmission
lines. Let V (cid:48) denote the set of transmission lines between
the generators after performing the Kron reduction technique,
and let K(G, V (cid:48)) denote the corresponding graph. This graph
is connected and has L edges where L ≤ N (N − 1)/2.

Let (cid:98)yij = (cid:98)gij +

−1 (cid:98)bij denote the admittance of the
the Kron-reduced equivalent line between generators i and
j, and let Ni denote the set of neighbors of generator i
after performing the Kron reduction technique. The system
dynamics can be described by
˙θi = ωi − ωs

√

2Hi
ωs

˙ωi = P m

i −

(cid:88)

j∈Ni

EiEj|(cid:98)yij| sin(θi − θj + (cid:98)φij)

(20)

−

di
ωs

ωi + Ui

where (cid:98)φij equals arctan((cid:98)gij/(cid:98)bij). In this study, we consider
the mechanical power input P m
and the storage control
i
signal Ui as local control signals which are computed based
on PMU measurements and wide area control signals (e.g.,
area control error) [19]. More precisely, the WACS performs
a monitoring role and does secure estimation.

i,meas

(cid:54)= P e

If measurements are attacked P e

i , then ωi (cid:54)=
ωs. The WACS estimates attacks from measurements and
communicates estimated attack signals to each generator.
Then, each generator subtracts the estimated attack from the
measured θ values, as to make P e
i as
possible, and hence stabilize ωi to ωs.

i,meas as close to P e

A. Formulation of Secure Estimation

In order to compute P e

each generator i receives measurement yc
j at time instant t:

i,meas and the local control signal Ui,
ij from its neighbor

ij(t) = θj(t) + ec
yc

ij(t), i ∈ G, j ∈ Ni ∪ {i},

(21)

ij represents the corruption in the measurement of
i,meas can be computed by

where ec
θj received at generator i. Then, P e
EiEj|(cid:98)yij| sin(cid:0)yc

i,meas =

ii(t) − yc

ij(t) + (cid:98)φij

(cid:1).

(22)

(cid:88)

P e

j∈Ni

Note that ec
ji represents the corruption in the measurement
ij and ec
of θi received at generator j, thus ec
ji represent
two distinct variables. In addition, ec
ii = 0 because θi is
measured locally and therefore is not subject to cyber attack,
i.e., yc

ii(t) = θi(t).

To enable the WACS to perform secure estimation, each
generator sends all of its measurements to the WACS. In
other words, the WACS receives the following measurements

discrete-time approximation, assuming a constant discretiza-
tion step Ts for all k:

θi(k + 1) = θi(k) + Ts
wi(k + 1) = αwi(k) + β

(cid:0)wi(k) − ws

(cid:1)

(cid:88)

+

fij

j∈Ni

(cid:0)θi(k), θj(k), yc

ii(k), yc

ij(k)(cid:1)

(24)

where α = 1 − Ts(di+Fi)
(cid:2) sin (cid:0)θi(k) − θj(k) + (cid:98)φij
˜Gij
and ˜Gij = − TsEiEj |(cid:98)yij |

2Hi

.

2Hi

, β = TsFiws
2Hi
ii(k) − yc

(cid:1) − sin (cid:0)yc

, fij(·) =
(cid:1)(cid:3)
ij(k) + (cid:98)φij

Using (21) and (23), fij(·) can be re-written using the

measurements received at the WACS, ym
(cid:2) sin (cid:0)

ij ’s:
(cid:98)φij + θi(k) − θj(k)(cid:1)
ij(k)(cid:1)(cid:3)
ii(k) − yc

fij(·) = ˜Gij

(cid:98)φij + yc

− sin (cid:0)
= ˜Gij sin (cid:0)
+ em
− ym

ij (k) + ec
ij (k) − em
ij(k)(cid:15)c
= Gs
ij(k) = ˜Gij sin (cid:0)
where Gs
˜Gij cos (cid:0)
ii (k) − ym
(cid:98)φij + ym
the other hand, (cid:15)c
ij and (cid:15)s
signals and are deﬁned as:
ij(k) = cos (cid:0)em
(cid:15)c

ij (k) − em

ii (k)
(cid:98)φij + ym

ii (k)

(cid:98)φij + ym

ii (k) − ym
ij(k)(cid:1) − ˜Gij sin (cid:0)
ii (k) + em
ij(k)(cid:15)s

ij (k)(cid:1)
ij(k),

ij(k) − Gc

ij (k)(cid:1), Gc

ii (k) − ym

(cid:98)φij + ym
ij(k) =
ij (k)(cid:1) are known to the WACS. On
ij are functions of unknown attack

ii (k) − em

− cos (cid:0)em

ii (k) − em

ij(k) = sin (cid:0)em
(cid:15)s

ii (k) − em

− sin (cid:0)em

ii (k) − em

ij(k)(cid:1)

ij(k)(cid:1)

ij (k) − ec
ij (k)(cid:1)
ij (k) − ec
ij (k)(cid:1).

(25)

ij(k) and (cid:15)s

In other words, fij(·) is now a linear function of the
unknowns: (cid:15)c
ij(k), whose coefﬁcients can be
computed by the WACS from its measurements. In addition,
if there is no attack on any of the communication channels
in the system at time slot k, then (cid:15)c

ij(k) = (cid:15)s

ij(k) = 0.

The state space model of the i-th generator is given by:

xi(k + 1) = Aixi(k) + qi + Hi(k)(cid:15)i(k)
(cid:21)
(cid:20)−Tsws
(cid:21)
β

(cid:20)1 Ts
0 α

xi(k) +

=

+

(cid:21)

(cid:20)
0
hi(k)(cid:62)

where the state vector xi(k) = (cid:2)θi(k), wi(k)(cid:3)(cid:62)

and

(cid:15)i(k)

(26)

hi(k)(cid:62) = (cid:2)Gs

iNi(1)(k), · · · , Gs
Gc

iNi(1)(k), · · · , Gc

iNi(li)(k),

iNi(li)(k)(cid:3) ∈ R1×2li

(cid:15)i(k) = (cid:2)(cid:15)c

iNi(1)(k), · · · , (cid:15)c

iNi(li)(k),

iNi(1)(k), · · · , (cid:15)s
(cid:15)s

iNi(li)(k)(cid:3)(cid:62)

∈ R2li×1.

Here, Ni(j) is the j-th generator in the neighborhood of
generator i and li is the cardinality of the set Ni.

ij (t) = yc
ym

ij(t) + em

ij (t), i ∈ G, j ∈ Ni ∪ {i}

(23)

Now, consider the enlarged system with N generators in

where em

ij represents the corruption in yc
ij.

We now apply the forward Euler discretization scheme
to this continuous-time system and obtain the following

the network:

X(k + 1) = AX(k) + q + H(k)(cid:15)(k)

Y (k) = CX(k) + DE(k)

(27)

where

X(k) = (cid:2)x1(k); · · · ; xN (k)(cid:3) ∈ R2N ×1

A = blkdiag{A1, · · · , AN } ∈ R2N ×2N
q = (cid:2)q1; · · · ; qN

(cid:3) ∈ R2N ×1
H(k) = blkdiag{H1(k), · · · , HN (k)} ∈ R2N ×4L
(cid:15)(k) (cid:44) (cid:2)(cid:15)1(k); · · · ; (cid:15)N (k)(cid:3) ∈ R4L×1
Y (k) = (cid:2)Yi(k); · · · ; YN (k)(cid:3) ∈ R(N +2L)×1
Yi(k) = (cid:2)yii(k); yiNi(1)(k); · · · ; yiNi(li)(k)(cid:3) ∈ R(1+li)×1
(cid:3) ∈ R(N +2L)×(N +4L)
(cid:20) 0
(cid:26)(cid:20) 0
IlN ,lN
Il1,l1
D2 = IN +2L,N +2L ∈ R(N +2L)×(N +2L)

D = (cid:2)D1, D2

D1 = blkdiag

, · · · ,

(cid:21)(cid:27)

(cid:21)

∈ R(N +2L)×2L

E(k) = (cid:2)Ec

1(k); · · · ; Ec

N (k); Em

1 (k); · · · ; Em

N (k)(cid:3)

∈ R(N +4L)×1
(cid:104)

iNi(1)(k); · · · ; ec
ec
ii ; em
em

iNi(1)(k); · · · ; em

∈ Rli×1
(cid:105)
iNi(li)(k)

iNi(li)(k)

(cid:104)

∈ R(1+li)×1

(cid:105)

Ec

i (k) =

Em

i (k) =
(cid:80)

i li
2

and L =
represents the total number of edges / links in
the network. Matrix C ∈ R(N +2L)×2N is given as follows:
let the a-th element of vector Y be ym
ij , then the (a, b)-th
entry of C is given by

C(a,b) =

(cid:40)
1
0

if 2j − 1 = b
otherwise.

Consider T time steps of measurements
{0, · · · , T − 1}) and deﬁne:

(i.e., k =

¯Y =



Y (0)
Y (1) − Cq
...





Y (T − 1) − C (cid:80)T −2

m=0 AT −2−mq








∈ R(N +2L)T ×1

(28)

then

¯Y = ΦX(0) + Ψ ¯E
(29)
where Φ = (cid:2)C; CA; · · · ; CAT −1(cid:3) ∈ R(N +2L)T ×2N
system,
is
¯E
∈
(cid:3), with
R((N +4L)T +4L(T −1))×1
Ψ1 ∈ R(N +2L)T ×(N +4L)T and Ψ2 ∈ R(N +2L)T ×4L(T −1) as
follows:

observability
matrix
(cid:2)E(0); · · · ; E(T − 1); (cid:15)(0); · · · ; (cid:15)(T − 2)(cid:3)

and Ψ = (cid:2)Ψ1 Ψ2

the
=

the

of

Ψ1 = blkdiag{D, · · · , D}

Ψ2 =










0
CH(0)
CAH(0)
...
CAT −2H(0)

0
0
CH(1)
...
· · ·

· · ·
· · ·
· · ·
. . .
CH(T − 2)










.

We can choose Ω ∈ R((N +2L)T −2N )×(N +2L)T such that
ΩΦ = 0, then:

˜Y = Ω ¯Y = ΩΨ ¯E,

(30)

where ΩΨ ∈ R((N +2L)T −2N )×((N +4L)T +4L(T −1)).

B. Difﬁculties in Secure Estimation due to System Dynamics

The linear system in (30) is in the form of (7). Hence, from
Lemma 1, ¯E has a unique s-sparse solution if all subsets of
2s columns of ΩΨ are linearly independent. However, in this
case, Ψ2 is rank deﬁcient due to the system dynamics. To see
this more clearly, the ﬁrst row of Hi(k) are zeros, therefore
given any matrix M , rank(M Hi(k)) = 1. In other words,
all columns of Ψ2 that correspond to the same Hi(k) are
linearly dependent. In (30), Ψ2 multiplies the (cid:15)(k) terms in
¯E, consequently, the (cid:15)(k)’s may not be identiﬁable.
ij (k) = θj(k) + ec

ij (k), hence, for
a given (i, j)-pair (i (cid:54)= j) and a given k, the columns of Ψ1
that correspond to ec
ij (k) are identical. As a result,
applying the estimation algorithm introduced in Section II to
(30) can only uniquely identify the sum ec
ij (k) but
not the individual terms: ec
ij (k).

Furthermore, ym

ij(k) and em

ij(k) and em

ij(k) + em

ij(k) + em

To overcome these difﬁculties, we consider the following

problem setup.

C. Assumptions and Secure Estimation with 2-Step Delay

We distinguish between two types of attacks:
• c-attack: an attack that corrupts communication chan-
nels between generators, i.e., there exists at least one
(i, j)-pair such that ec

ij (cid:54)= 0.

• m-attack: an attack that affects communication chan-
nels between the generators and the WACS, i.e., there
exists at least one (i, j)-pair such that em

ij (cid:54)= 0.

Assume that at any time k, the power network is subject to
either a c-attack or an m-attack, but not both. However, both
the type of attack and the set of attacked measurements can
change at each time step. In addition, the WACS does not
know a priori which type of attack the system is subjected
to, hence secure estimation techniques are used to determine
the type of attack, as well as the exact corruption signals.

From (27) we can derive the following equality:

f2-step

(cid:0)(cid:15)(k − 2), E(k)(cid:1) = Y (k) − CA2 · X(k − 2) − CAq
− Cq − CA · H(k − 2) · (cid:15)(k − 2)

− DE(k)

= 0,

ij(k) + em

(31)
where the ﬁrst equality uses CH(k) = 0 for all k. Observe
that if it is an m-attack at time k, then ec
ij (k) =
em
ij (k) and (cid:15)(k) = 0 in (31); on the other hand, if it is a
c-attack at time k, then ec
ij(k) + em
ij(k) and (cid:15)(k) (cid:54)=
0. Combining these observations with (31), we propose the
following algorithm which can be used by the WACS to
determine the type of attack and the exact corruption signals,
with a 2-step delay.
Step 1: At each time k, estimate ¯E(k) by solving the
following l1-minimization problem

ij (k) = ec

¯Eest(k) = arg min (cid:107) ¯E(cid:107)l1 subject to ˜Y = ΩΨ ¯E.

Extract Eest(k − 2) and Eest(k) from ¯Eest(k).
Step 2: Let ec
ij elements in
Eest. Similarly, for Ec-att,est and Em-att,est. Consider 2 cases:

est,ij denote ec

est,ij and em

ij and em

• m-attack at time k − 2: (cid:15)m-att,est(k − 2) = 0.
• c-attack at time k − 2: First, obtain Ec-att,est(k − 2)
as follows: for all i and j, em
c-att,est,ij(k − 2) = 0 and
ec
est,ij(k − 2) + em
c-att,est,ij(k − 2) = ec
est,ij(k − 2). Second,
use (25) to compute (cid:15)c-att,est(k − 2) from Ec-att,est(k − 2).
Step 3: Evaluate
If
(cid:0)(cid:15)m-att,est(k −
(cid:107)f2-step
2), Eest(k)(cid:1)(cid:107), then it is a c-attack at k − 2, and E(k − 2) =
Ec-att,est(k − 2), (cid:15)(k − 2) = (cid:15)c-att,est(k − 2). Otherwise, it
is an m-attack at k − 2, and E(k − 2) = Em-att,est(k − 2),
(cid:15)(k − 2) = (cid:15)m-att,est(k − 2).

(cid:0)(cid:15)c-att,est(k − 2), Eest(k)(cid:1)(cid:107) < (cid:107)f2-step

for both cases.

equation (31)

To summarize, as a result of the system dynamics and
the proposed model, it is not possible to recover the exact
corruption if the system is subjected to both c- and m-
attacks at the same time. In light of this, we make the
simplifying assumption that at any time k, the system may
only be subject to one type of attack. However, the type
of attack can change over time. Then, by comparing the
actual measurements with the different system trajectories
that would result from each type of attack, we can determine
both the attack type and the exact corruption signals, with a
2-step delay. Note that at time k, this secure state estimation
algorithm is able to detect the presence of attacks at times
k − 1 and k, merely not the exact attack signals.

Fig. 2. True and estimated attack signals. The rows and columns correspond
to attacked measurements and time steps, respectively. In subﬁgures “True
Attack” and “Estimated Attack”, the color indicates the attack signal: red is
a positive attack, green a negative attack and black is no attack. In subﬁgure
“Estimation Error”, the black color indicates there is zero estimation error
for all measurements at all times.

Remark 1: Let Q be the number of non-zero elements
in ¯E that correspond to the E(k) terms. By Lemma 2, the
maximum number Q that can be corrected after T steps is
(cid:98)(N + 2L)T /2 − N (cid:99), and the average number of correctable
non-zeros per time step is ¯q(= Q

T ) = (cid:98)N/2 + L − N/T (cid:99).

i j(k) and em

Due to the non-identiﬁability of ec

i j(k), each
corrupted measurement at time k contributes up to 2 non-zero
elements in E(k). Thus, in this example, the average number
of corrupted measurements that can be perfectly recovered
is (cid:98)N/4 + L/2 − N/(2T )(cid:99) per time step; and the maximum
average number of correctable corruptions is (cid:100)N/4 + L/2 −
1(cid:101). Next, we numerically demonstrate the effectiveness of
the proposed state estimation algorithm.

VI. NUMERICAL EXAMPLE

We focus on the New England power system comprising
10 generators and 39 buses. The values of the system
parameters are taken from [21]- [22]. The power system is
initially under equilibrium condition, and the rotor speeds of
all 10 generators are at the nominal value, ws, of 60 Hz.
Malicious attacks targeted at generator 1 are injected as
follows:

• At every time step, the attacker randomly chooses to
perform either a c-attack or an m-attack. Denote the
chosen attack type as [·].

• A constant attack signal of 90◦ is injected into the

measurement of θ2, i.e., e[·]

12 = 90◦.

• 9 additional measurements from E[·]
1

are chosen at
random, and each of them is corrupted with a random
Gaussian signal.

The left plot in Figure 2 shows the true attack signals (for
clarity, only those measurements that are attacked at some

Fig. 3. Evolution of phase angle and rotor speed of generators 1, 2, and
3 when the network is under attack, with and without secure estimation.
Without secure estimation, generator 1’s phase angle deviates rapidly from
its equilibrium value, reaching a maximum of 159◦. With secure estimation,
the phase angle of generator 1 is maintained close to equilibrium, with a
maximum deviation of only 2.9◦.

point during the simulation are shown). Initially, generator 1
has a phase angle of 6.85◦. The left plots in Figure 3 show
that if no secure estimation-based protection is implemented,
the phase angle of generator 1 deviates rapidly from its
equilibrium value and reaches 159◦ within 7.3 sec. When
the phase angle difference between two generators exceeds
90◦, the generators can potentially loose synchrony and trip.
As shown in Fig. 2, the proposed state estimation enables the
WACS to reconstruct the rotor angles and rotational speeds of
the generators accurately, and to prevent all possible failures.
the system’s behavior with secure
estimation-based protection. Using the algorithm described
in Section V, WACS estimates the attack signals and the
generator phase angles. Then,
it sends the reconstructed
measurements to all the generators, and each generator uses

We now consider

True AttackTime (sec)2 4 6 8 1024681012141618Estimated AttackTime (sec)2 4 6 8 1024681012141618Estimation ErrorTime (sec)2 4 6 8 1024681012141618-400-300-200-1000100200300400[12] A. Chakrabortty and P. Khargonekar, “Introduction to Wide-Area
Control of Power Systems,” in Proc. of American Control Conference,
pp. 6758-6770, 2013.

[13] Y. Liu et al., “A US-wide power systems frequency monitoring
network,” in Proc. IEEE PES General Meeting, pp. 1914-1921, Jun.
2006.

[14] A. R. Messina, V. Vittal, D. Ruiz-Vega, and G. Enriquez-Harper,
“Interpretation and visualization of wide-area PMU measurements
using Hilbert analysis,” IEEE Trans. on Power Syst., vol. 21, no. 4,
pp. 1760-1771, 2006.

[15] M. R. Younis, and R. Iravani, “Wide-area damping control for inter-
area oscillations: A comprehensive review,” Electrical Power & Energy
Conference (EPEC), pp. 1–6, Aug. 2013.

[16] E. Candes, and T. Tao, “Decoding by linear programming,” Informa-
tion Theory, IEEE Transactions on, vol. 51, no. 12, pp. 4203-4215,
Dec. 2005.

[17] D. Hayden, Y. H. Chang, J. Goncalves, and C. Tomlin, “Compressed

sensing for network reconstruction,” arXiv:1411.4095, 2014.

[18] D. Hayden, Y. H. Chang, J. Goncalves, and C. Tomlin, “Sparse
network identiﬁability via Compressed Sensing,” Automatica, vol. 68,
pp. 9–17, Jun. 2016.

[19] P. Kundur, Power System Stability and Control. McGraw-Hill, 1994.
[20] A. Farraj, E. Hammad, and D. Kundur, “A Cyber-Enabled Stabilizing
Control Scheme for Resilient Smart Grid Systems,” Smart Grid, IEEE
Transactions on, no. 99, pp. 1–10, 2015.

[21] T. Athay, R. Podmore, and S. Virmani, “A Practical Method for the
Direct Analysis of Transient Stability,” IEEE Transactions on Power
Apparatus and Systems, vol. 98, pp. 573-584, 1979.

[22] B. Pal and B. Chaudhuri, Robust Control in Power Systems. Power

Electronics and Power Systems Series, Springer, 2006.

the reconstructed phase angle measurements to compute its
local control
the proposed
input. During the simulation,
estimation algorithm correctly estimates the type of attack
at every time step (results are not shown due to space
limitations) and also recovers the attack signals accurately
as shown in Figure 2. Figure 3 shows that by incorporating
secure estimation in this way, even with a 2-step estimation
delay, the phase angle of generator 1 is maintained within
the range [6.3◦, 9.8◦], i.e., a maximum deviation of 2.9◦ from
its equilibrium value. In addition, generator 1’s rotor speed
hardly deviates from the nominal frequency of 60 Hz and
is kept within [59.95 Hz, 60.07 Hz]. The phase angles of
generators 4 to 10 are unaffected by the attack during the
simulation period, and are not shown here for clarity.

VII. CONCLUSION

We propose a secure state estimator for two broad classes
of nonlinear systems, and provide guarantees on the achiev-
able state estimation error against arbitrary corruptions. More
precisely, we analytically characterize the number of errors
that can be perfectly corrected by a decoder. We then
illustrate how the proposed estimator can be used in practical
systems. In particular, by using the proposed estimator, we
propose a secure state estimator for the wide area control
of power systems under cyber-physical attacks and commu-
nication failures. Finally, we numerically demonstrate the
effectiveness of the proposed secure estimator.

REFERENCES

[1] F. Pasqualetti, F. Dorﬂer and F. Bullo, “Control-Theoretic Methods
for Cyberphysical Security: Geometric Principles for Optimal Cross-
Layer Resilient Control Systems,” in IEEE Control Systems, vol. 35,
no. 1, pp. 110–127, Feb. 2015.

[2] S. Sridhar, A. Hahn, and M. Govindarasu, “CyberPhysical System
Security for the Electric Power Grid,” in Proceedings of the IEEE,
vol. 100, no. 1, pp. 210–224, Jan. 2012

[3] X. Wang and P. Yi, “Security framework for wireless communications
in smart distribution grid,” IEEE Trans. Smart Grid, vol. 2, no. 4, pp.
809–818, Dec. 2011.

[4] Y. Zhang, L. Wang, W. Sun, R. Green, and M. Alam, “Distributed
intrusion detection system in a multi-layer network architecture of
smart grids,” IEEE Trans. Smart Grid, vol. 2, no. 4, pp. 796-808,
Dec. 2011.

[5] H. Li, L. Lai, and W. Zhang, “Communication requirement for reliable
and secure state estimation and control in smart grid,” IEEE Trans.
Smart Grid, vol. 2, no. 3, pp. 476-486, Sep. 2011.

[6] Q. Li and G. Cao, “Multicast authentication in the smart grid with
onetime signature,” IEEE Trans. Smart Grid, vol. 2, no. 4, pp. 686-
696, Dec. 2011.

[7] C. Alcaraz, C. Fernandez-Gago, and J. Lopez, “An early warning
system based on reputation for energy control systems,” IEEE Trans.
Smart Grid, vol. 2, no. 4, pp. 827-834, Dec. 2011.

[8] C. W. Ten, J. Hong, and C. C. Liu, “Anomaly detection for cyberse-
curity of the substations,” IEEE Trans. Smart Grid, vol. 2, no. 4, pp.
865-873, Dec. 2011.

[9] F. Pasqualetti, F. Dorﬂer, and F. Bullo, “Attack detection and identiﬁca-
tion in cyber-physical systems,” Automatic Control, IEEE Transactions
on, vol. 58, no. 11, pp. 2715–2729, Nov. 2013.

[10] H. Fawzi, P. Tabuada, and S. Diggavi, “Secure estimation and con-
trol for cyber-physical systems under adversarial attacks,” Automatic
Control, IEEE Transactions on, vol. 59, no. 6, pp. 1454-1467, June
2014.

[11] Y. H. Chang, Q. Hu, and C. J. Tomlin, “Secure Estimation based
Kalman Filter for Cyber-Physical Systems against Adversarial At-
tacks,” arXiv:1512.03853

