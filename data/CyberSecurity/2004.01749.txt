0
2
0
2

r
p
A
2

]

R
C
.
s
c
[

1
v
9
4
7
1
0
.
4
0
0
2
:
v
i
X
r
a

Typosquatting for Fun and Proﬁt:
Cross-Country Analysis of Pop-Up Scam

Tobias Dam1,3, Lukas Daniel Klausner1,4, Sebastian Schrittwieser2,5

1 Institute of IT Security Research
St. Pölten University of Applied Sciences
Austria
2 Josef Ressel Center TARGET
St. Pölten University of Applied Sciences
Austria
3tobias.dam@fhstp.ac.at
4mail@l17r.eu
5sebastian.schrittwieser@fhstp.ac.at

Abstract

Today, many different types of scams can be found on the internet. Online
criminals are always ﬁnding new creative ways to trick internet users, be it in
the form of lottery scams, downloading scam apps for smartphones or fake
gambling websites. This paper presents a large-scale study on one particular
delivery method of online scam: pop-up scam on typosquatting domains.
Typosquatting describes the concept of registering domains which are very
similar to existing ones while deliberately containing common typing errors;
these domains are then used to trick online users while under the belief of
browsing the intended website. Pop-up scam uses JavaScript alert boxes to
present a message which attracts the user’s attention very effectively, as they
are a blocking user interface element.

Our study among typosquatting domains derived from the Majestic Million
list utilising an Austrian IP address revealed on 1 219 distinct typosquatting

River Journal, 1–30.
c(cid:13) 2020 River Publishers. All rights reserved.

 
 
 
 
 
 
2 Dam, Klausner, Schrittwieser

URLs a total of 2 577 pop-up messages, out of which 1 538 were malicious.
Approximately a third of those distinct URLs (403) were targeted and dis-
played pop-up messages to one speciﬁc HTTP user agent only. Based on
our scans, we present an in-depth analysis as well as a detailed classiﬁcation
of different targeting parameters (user agent and language) which triggered
varying kinds of pop-up scams. Furthermore, we expound the differences
of current pop-up scam characteristics in comparison with a previous scan
performed in late 2018 and examine the use of IDN homograph attacks as
well as the application of message localisation using additional scans with IP
addresses from the United States and Japan.

Keywords: phishing, typosquatting, scam, web security.

1 Introduction

Pop-up ads have been an annoying phenomenon on the internet since the
1990s. This type of web advertisement puts the ad banner into a separate
browser window instead of directly integrating it with the website [21]. The
great popularity of pop-up ads among advertisement companies contrasted
with the dissatisfaction of users because of the ads’ highly intrusive nature.
This eventually caused all major browser vendors to implement pop-up block-
ers in their software in the early 2000s [8]. Today, websites rarely make use
of pop-ups and pop-up ads have disappeared almost completely from the web
(as browsers would block them anyway).

However, similar concepts are now being used for online scams. Instead of
displaying an ad or malicious content in a new browser window through the
JavaScript method window.open,1 a new trend in web-based scams can be
observed: The JavaScript method alert2 is used to show a short text message
to the user.

Displaying the phishing message inside a JavaScript alert box has one im-
portant advantage for the attacker: An alert box steals the focus of the entire
website. While normal advertisements can easily be ignored, alert boxes

1

2

https://developer.mozilla.org/en-US/docs/Web/API/Window/open (last
accessed: 30 November 2019)
https://developer.mozilla.org/en-US/docs/Web/API/Window/alert (last
accessed: 30 November 2019)

Typosquatting for Fun and Proﬁt 3

require the user to actively click a button to dismiss them. This obligatory
interaction combined with the often short messages creates an effective entry
point to further engage the user. This initial forced attention can then be
exploited to lure the user to a dedicated website which serves the attacker’s
purpose, e. g. by asking for email addresses or credit card details. Attackers
have also been observed repeatedly opening alert boxes, trying to pose as
legitimate OS error messages and scaring the user into thinking that their
device has been infected by malware [13].

These properties make alert boxes a very effective and widely abused vec-
tor for attackers. However, little attention has been paid to the described
techniques by the research community. We conducted a scan utilising typo-
squatting URLs based on the Alexa Top 1 Million websites [2] in late 2018
and performed a large-scale analysis [4] using the collected data. During our
work, we discovered various hints of localisation attempts, which were likely
caused by our Austrian IP address. In order to examine whether our assump-
tion was correct as well as to observe possible changes of pop-up message
characteristics since our last scan, we decided to perform additional scans
utilising IP addresses from Austria, the United States and Japan.

Based on the Majestic Million websites [12], we created a list of websites
with commonly misspelt names. This set consisted of 638 835 valid, re-
gistered domain names, which we scanned using automated browsers with
ﬁve different user agents. In this paper, we present an up-to-date comprehens-
ive, large-scale study of the use of automatically displayed pop-up scams on
websites and analyse how different user agents and languages are targeted by
these campaigns. Additionally, we compare our results to our prior pop-up
scam analysis research.

In particular, the main contributions of this paper are:

• We present an up-to-date comprehensive scientiﬁc large-scale follow-up
study of the utilisation of JavaScript pop-up messages for online scams
on typosquatting URLs based on the Majestic Million websites.

• In contrast to our previous scan, we also include IDN homograph attacks

as a possible typosquatting attack vector.

• We provide insight into the goals and purposes of the pop-up messages
and the sites hosting them by manually deﬁning and assigning categories
based on the message content and the websites.

• Various distributions of the languages and the user agents across the
different distinct messages, websites and categories are visualised and

4 Dam, Klausner, Schrittwieser

detailed, in order to explain the current state as well as trends in this
particular delivery method for online scams.

• A comparison with our previous scan in relation to pop-up scams details
the developments and the differences of the messages as well as the sites
displaying them.

• An assessment of the application of alert box message localisation by

utilising IP addresses from three different countries.

The remainder of this paper is structured as follows: We discuss related work
in section 2 and give a technical overview of the utilised framework in sec-
tion 3. We present the results of our research in section 4 and evaluate the scan
results in section 5, where we also present a large-scale analysis. Possible
future work is detailed in section 6 and section 7 concludes the paper. All
diagrams visualising our results are located in the appendix.

2 Related Work

One important online scam category is phishing. It has been around for a long
time as one of the most effective social engineering techniques and is a well-
studied research area (see e. g. [1, 14, 15]). Due to the fact that the majority of
today’s users have only limited technical and security knowledge, the success
rate of social engineering attacks is constantly high. Moreover, adversaries
are becoming more and more creative in handcrafting their attacks to increase
their success rate. While traditional means of delivery (i. e. via email [19]) are
still widely used, many other delivery methods exist. Typosquatting [7] (also
referred to as “URL hijacking”) is a technique which is based on the concept
of registering domain names with typing errors and similar mistakes made by
users when entering a popular web address.

One of the ﬁrst large-scale studies on typosquatting was conducted in 2003
by Edelman [6], who discovered more than 8 800 registered domains which
were typographical variations of the most popular domain names at that time.
His ﬁndings showed that most of those domain names were traced back to one
individual, John Zuccarini, who used these typosquatted domains to redirect
users to websites containing sexually explicit content. Furthermore, he was
found to use particular tactics to trap the users from leaving these sites, such
as blocking the browser’s “Back” and “Close” functionalities.

Typosquatting for Fun and Proﬁt 5

Typosquatting attacks are based on the insertion, deletion or substitution
of characters or the permutation of adjacent characters in popular domain
names [10]. Holgers et al. [9] conducted an experiment in 2006 in which they
measured the effect of visual similarities between letters in particular domain
names. At that time, their results outlined that such homograph attacks were
very rare and not severe in nature. However, the increasing use of interna-
tionalised domain names (IDNs) as well as the rising number of malicious
IDN registrations over the last years show the increasing signiﬁcance of this
typosquatting technique [11, 22].

Numerous other squatting techniques such as bitsquatting, combosquatting,
and soundsquatting were thoroughly researched in the past. Bitsquatting is
the act of registering a domain name one bit different than an original domain,
which might be accessed by users due to bit errors changing their memory
content. Dinaburg [5] performed an experiment in which he registered 30
bitsquatted versions of popular domains and logged all HTTP requests. His
ﬁndings outlined that there were 52 317 bitsquat requests from 12 949 unique
IP addresses over the course of eight months. Nikiforakis et al. [18] conducted
one of the ﬁrst large-scale analyses of the bitsquatting phenomenon. Their
results clearly showed that new bitsquatting domains are registered daily and
are commonly used by the adversaries for generating proﬁt through the use of
ads, abuse of afﬁliate programs and, in some cases, distribution of malicious
content.

Kintis et al. [10] conducted a study on combosquatting, which combines
brand names with other keywords in the domain names. Their study showed
that combosquatting domains are widely used to perform various types of at-
tacks, including phishing, social engineering, afﬁliate abuse, trademark abuse
and malware.

Furthermore, Nikiforakis et al. [16] presented a concept called soundsquat-
ting which takes advantage of user confusion over homophones and near-
homophones, i. e. words which sound similar or the same, but are spelled
differently. To verify how much this soundsquatting technique is used in the
wild, Nikiforakis et al. developed a tool to generate possible soundsquatted
domains from a list of target domains. Using the Alexa Top 10,000 websites,
they were able to generate 8 476 soundsquatted domains out of which 1 823
were already registered.

Additionally, Nikiforakis et al. [17] conducted a study in which they ex-
amined malicious JavaScript inclusions. Their ﬁndings included a vulnerab-

6 Dam, Klausner, Schrittwieser

ility which occurs when a developer mistypes the address of a JavaScript
library in their HTML pages. This would allow an attacker to easily register
the typosquatted domain which could then compromise the website including
a malicious JavaScript library.

Pop-up scam has not been researched in much detail yet. Miramirkhani et
al. [13] performed a large-scale analysis of one particular type of pop-up
scams, namely technical support scams. Their methodology included a check
for JavaScript alert boxes. In Chou et al.’s work [3] the detection of traditional
(JavaScript-less) pop-up ads through machine learning was proposed. The
psychological aspects of fake pop-ups on internet users were analysed by
Sharek et al. [23].

We performed a large-scale analysis of pop-up scams on typosquatting
URLs [4] by utilising a modiﬁed version of the MININGHUNTER framework
and an Austrian IP address. Our scan on the typosquatting domains based on
the Alexa Top 1 Million list revealed on 8 255 distinct typosquatting URLs
a total of 9 857 pop-up messages, out of which 8 828 were malicious. We
found that the majority of distinct URLs were targeting mobile browser user
agents. Additionally, we categorised the messages and provided insights on
their characteristics and goals as well as the application of localisation.

3 Technical Overview

To perform the large-scale scans required for this research, we employed a
modiﬁed version of the MININGHUNTER [20] framework, which we ini-
tially developed to identify browser-based cryptocurrency mining campaigns.
MININGHUNTER is based on Docker Swarm3 and consists of automated
browsers and a back end where the collected data is stored.

To scan websites at a large scale, a Chromium browser installed inside a
Docker container is automated using the Chrome DevTools protocol.4 It
receives scanning requests via a Kue5 job queue, automatically loads the
website and records various details such as visited URLs. The accumulated

3

4

5

https://docs.docker.com/engine/swarm/key-concepts (last accessed: 30
November 2019)
https://chromedevtools.github.io/devtools-protocol (last accessed: 30
November 2019)
https://github.com/Automattic/kue (last accessed: 30 November 2019)

Typosquatting for Fun and Proﬁt 7

data is then sent to a back end container through HTTPS and stored inside a
MongoDB6 database for later analysis. To scan a large number of websites
within a reasonable time span, multiple scanning containers can be active at
the same time.

For the purpose of testing we mimicked the most common behaviour of an
adversary, namely, we made use of a technique popularly known as “typo-
squatting”, as explained in section 2. In our experiment, we applied this
technique to the Majestic Million websites. To be able to cover the broad
spectrum of the web address permutations, we used dnsmorph,7 a tool which
generates possible typosquatting URLs for a particular URL. From the pool
of thousands of possible address permutations, we selected only those which
were actually registered as valid domains (in total, we were able to gener-
ate and verify 638 835 registered domain names). In contrast to dnstwist,8
which was used in our ﬁrst study, dnsmorph is able to generate internation-
alised domain names (IDN) homograph attacks (using homographs such as
Greek omicron ‘ο’ or Cyrillic es ‘с’). However, this attack vector seems to
be purely theoretical in our use case, as we could not ﬁnd any application
of that attack using our scans – the generated list of registered typosquatting
domains did not contain any IDN homographs, at all.

For the purpose of this research, we developed two additional custom plugins
for our framework. The ﬁrst plugin, UserAgentSpoofer, sends a conﬁgurable,
fake user agent to allow us to discern differences in behaviour which depend
on this HTTP header. The plugin replaces the User-Agent request header in
all requests sent to websites using the Network.setUserAgentOverride
method of the Chrome DevTools protocol. The second plugin, AlertRe-
corder, stores URLs and messages of all JavaScript alert boxes encountered
while loading and rendering a website. The data is acquired using the
Page.javascriptDialogOpening API.

the Network.loadingFinished event

is
Websites are scanned until
triggered by the Chrome DevTools protocol, plus an additional second in
order to capture alerts that appear after the site has ﬁnished loading. The scan
is also stopped in case the Network.loadingFinished event is not triggered
30 seconds after beginning to load the website.

6

7

8

https://www.mongodb.com/what-is-mongodb (last accessed: 30 November 2019)
https://github.com/netevert/dnsmorph (last accessed: 30 November 2019)
https://github.com/elceef/dnstwist (last accessed: 30 November 2019)

8 Dam, Klausner, Schrittwieser

Using these two plugins, we performed ﬁve full scans of our list of typosquat-
ting domains based on the Majestic Million websites. To be able to provide a
wider variety of targets, each scan used a different user agent. We updated the
user agents used in our ﬁrst scan according to current browsers and operating
systems and selected Chrome 78 and Firefox 70 (both from 2019) to repres-
ent two popular, modern browsers running on Windows 10. We additionally
included Internet Explorer 11 (from 2015) on Windows 10 to determine if
any campaigns speciﬁcally target Microsoft’s default browser for that OS. To
cover the most commonly used mobile devices, we included Chrome 77 on
Android 9 and Safari 13 on iOS 13.1 (both from 2019). Detailed information
regarding all user agents selected for the scans can be found in Table 1.

For the purpose of analysing localisation attempts, the scans of the ﬁve dif-
ferent user agents were repeated with IP addresses from other countries. The
trafﬁc of the automated browser inside the Docker containers was routed
through an OpenVPN9 tunnel to endpoints in speciﬁc countries provided by
AirVPN.10

4 Results

As mentioned in section 1, our previous scan revealed several signs of mes-
sage localisation. In order to assess whether this result was caused by our
Austrian IP address, we performed additional scans utilising IP addresses of
two further countries via a VPN service.

Our scans originating from Austrian IP addresses (utilising different user
agents as described in section 3) resulted in a total of 2 577 recorded alert
boxes as well as 1 219 distinct URLs and 303 distinct messages. 1 538 of the
recorded alert boxes can be considered malicious. An interesting aspect of
our results is the targeting of speciﬁc user agents, which is further detailed
in section 5: 403 websites displayed an alert box only to one particular user
agent, whereas 816 websites showed messages to more than one user agent.
Considering only distinct messages, we observed similar behaviour – 102
distinct messages were only shown to one particular user agent, 201 to more
than one.

9

10

https://openvpn.net/ (last accessed: 30 November 2019)
https://airvpn.org/ (last accessed: 30 November 2019)

Typosquatting for Fun and Proﬁt 9

r
e
s
w
o
r
b

m
e
t
s
y
s

g
n
i
t
a
r
e
p
o

t
n
e
g
a

r
e
s
u

1
1

r
e
r
o
l
p
x
E

t
e
n
r
e
t
n
I

0
1
s
w
o
d
n
i
W

8
7
e
m
o
r
h
C

0
1
s
w
o
d
n
i
W

6
3

.

7
3
5
/
t
i

K
b
e
W

e
l
p
p
A

)
4
6
x

;
4
6
n
i
W

;
0
.
0
1

T
N

s
w
o
d
n
i
W

(

0
.
5
/
a
l
l
i
z
o
M

6
3
.
7
3
5
/
i
r
a
f
a
S
0
7
.
4
0
9
3
.
0
.
8
7
/
e
m
o
r
h
C

)
o
k
c
e
G
e
k
i
l

,

L
M
T
H
K

(

e
k
i
l

)
0
.
1
1
:
v
r

;
0
.
7
/
t
n
e
d
i
r
T

;
4
6
W
O
W

;
0
.
0
1

T
N

s
w
o
d
n
i
W

(

0
.
5
/
a
l
l
i
z
o
M

o
k
c
e
G

)

X

S
O

c
a

M

e
k
i
l

3
_
1
_
3
1

S
O

e
n
o
h
P
i

U
P
C

;
e
n
o
h
P
i
(

0
.
5
/
a
l
l
i
z
o
M

l
e
b
a
l

e
m
o
r
h
c

e
i

3
1
i
r
a
f
a
S

1

.

3
1
S
O

i

-
o
M

1
.
0
.
3
1
/
n
o
i
s
r
e
V

)
o
k
c
e
G

e
k
i
l

,

L
M
T
H
K

(

5
1
.
1
.
5
0
6
/
t
i

K
b
e
W

e
l
p
p
A

i
r
a
f
a
s
s
o
i

0
7

x
o
f
e
r
i
F

0
1
s
w
o
d
n
i
W

7
7
e
m
o
r
h
C

9
d
i
o
r
d
n
A

1
0
1
0
0
1
0
2
/
o
k
c
e
G

)
0
.
0
7
:
v
r

;
4
6
x
;
4
6
n
i
W

;
0
.
0
1
T
N
s
w
o
d
n
i
W

(
0
.
5
/
a
l
l
i
z
o
M

1
.
4
0
6
/
i
r
a
f
a
S
8
4
1
E
5
1
/
e
l
i
b

0
.
0
7
/
x
o
f
e
r
i
F

x
o
f
e
r
ﬁ

.

6
3
7
3
5
/
t
i

K
b
e
W

e
l
p
p
A

)
3
5
0
1
-
A
T

;
9

d
i
o
r
d
n
A

;
x
u
n
i
L
(

0
.
5
/
a
l
l
i
z
o
M

6
3
.
7
3
5
/
i
r
a
f
a
S
e
l
i
b
o
M
6
1
1
.
5
6
8
3
.
0
.
7
7
/
e
m
o
r
h
C

)
o
k
c
e
G
e
k
i
l

,

L
M
T
H
K

(

e
m
o
r
h
c
d
i
o
r
d
n
a

g
n
i
r
r
e
f
e
r
n
e
h
w

r
e
p
a
p
s
i
h
t

t
u
o
h
g
u
o
r
h
t
d
e
s
u
r
e
ﬁ
i
t
n
e
d
i

e
u
q
i
n
u
a

s
i

”
l
e
b
a
L
“

.
s
n
a
c
s

e
h
t

r
o
f
d
e
s
u
s
t
n
e
g
a

r
e
s
u
e
h
T

:
1
e
l
b
a
T

y
b

d
e
i
l
p
m

i

y
g
o
l
o
n
h
c
e
t

g
n
i
d
n
o
p
s
e
r
r
o
c

o
t

r
e
f
e
r

”
r
e
s
w
o
r
b
“

d
n
a

”
m
e
t
s
y
s

g
n
i
t
a
r
e
p
O
“

.
t
n
e
g
a

r
e
s
u

g
n
i
d
n
o
p
s
e
r
r
o
c

e
h
t

o
t

.
t
n
e
g
a

r
e
s
u

e
h
t

10 Dam, Klausner, Schrittwieser

The second scan used IP addresses from the United States and yielded 2 420
recorded alert boxes. It consisted of 1 155 distinct sites, 298 distinct messages
and 1 393 potentially malicious alert boxes. The results regarding the user
agent aspect are quite similiar to the Austrian scan: 382 websites showed an
alert box only to one particular user agent, while 773 websites served them
to multiple user agents. 94 distinct messages were used for only one speciﬁc
user agent, 204 for more than one.

The third scan used IP addresses from Japan, during which we recorded 2 403
alert boxes, 305 distinct messages and 1 098 distinct sites. 1 403 alert boxes
can be considered malicious. The results of this scan feature similar charac-
teristics regarding the user agent as the aforementioned scans: 336 websites
displayed an alert box only to one particular user agent, while 762 websites
showed messages to more than one user agent. 103 distinct messages were
only shown to one particular user agent, 202 to more than one.

The aforementioned statistics show that the number of sites displaying alert
boxes declined for each scan, although each scan used the same set of ty-
poquatting URLs. Due to limited resources, we performed the Austrian, US
and Japanese scans consecutively over four weeks. We found that several
domains are registered only for a short period of time, and deregistered or
used for other purposes afterwards. This might be caused by e. g. phishing
site takedowns or attempts to remain anonymous by the website operators.

5 Evaluation

Using the categories described in subsection 5.1 as well as the user agents
shown in Table 1, we determined speciﬁc characteristics of the recorded alert
box messages with respect to these features.

5.1 Categories

In order to determine which websites try to achieve similar goals by dis-
playing a message inside an alert box as well as to enable clearer visual
representations of the distribution of message types across different user
agents, we selected a number of categories from our ﬁndings and assigned
one to each message.

Typosquatting for Fun and Proﬁt 11

Most messages in the FRAUD category declare that the user’s device is in-
fected by a virus or inform you about a pending update. They either urge the
user to download potentially malicious software or to call a speciﬁed phone
number. These characteristics contrast with those of the FRAUD messages in
our previous study, where most messages claimed that the user would receive
some free credit for gambling if they registered and provided their credit card
information.

Messages contained in the LOTTERY category either claim the visitor has
already won a lottery or that they have a particularly high chance of winning
one. Such websites often either require the user to play a “game”, such as
spinning a wheel of fortune, or to answer questions regarding the prize (e. g.
a smartphone). After completing such tasks, the websites reveal that the prize
is actually a “special offer” and ask the visitor to provide their credit card
information.

All messages in the category APK are in Chinese and most of them urge the
user to download a dedicated application for displaying adult content. Unlike
alert boxes in the category MOBILE CLIENT, they do not redirect to app store
websites, but instead offer a direct download of an Android APK ﬁle or re-
direct to an iOS itms-services URL. Several samples were analysed using
VirusTotal11 and were identiﬁed as potentially unwanted programs (such as
adware and spyware) as well as Trojans.

Based on the characteristics of the alert box message content as well as
manual inspection of selected samples for each distinct message, we con-
sider messages inside the categories FRAUD, LOTTERY, and APK to be
malicious (e. g. phishing). Besides these malicious categories, we further
deﬁned various non-malicious categories; they were differentiated by content
and message purpose in order to gain additional insight into the reasons for
showing alert boxes in general.

The category ERRORS contains several types of error messages, e. g. indicat-
ing invalid access tokens or JavaScript errors as well as website maintenance
and discontinuation notices.

Messages categorised as DOWNLOAD urge the user to install or update either
Java or Adobe Flash Player and redirect the user to the corresponding down-
load area. Manual inspection of the websites included in our scan which

11

https://www.virustotal.com (last accessed: 30 November 2019)

12 Dam, Klausner, Schrittwieser

displayed these messages showed that the alert boxes do actually redirect
to the legitimate websites of the software manufacturers.

ADULT messages inform the user about adult content on the visited website,
ask the user to conﬁrm that they are of legal age and present the website’s
terms and conditions.

Messages of the category MOBILE SITE ask the visitor whether they want to
display the dedicated mobile version of the website.

MOBILE CLIENT messages inform the user about the website’s smartphone
app and redirect the user to the according app store website.

The categories MOBILE SITE and MOBILE CLIENT are combined into the
category MOBILE in diagrams throughout this paper.

Messages of the GAMBLING category are related to gambling websites. All
messages are in Chinese, and most websites hosting these alert boxes provide
the latest results of the Hong Kong Jockey Club’s Mark Six lottery12 as well
as other gambling information. They either require the user to register on a
different website or present a special offer along with an ID or contact number
for instant messengers, which are in widespread use in the People’s Republic
of China. Since the websites did not directly request credit card information
or deceive the visitors in other ways, and since we could not easily invest-
igate the associated instant messenger accounts, we chose to separate these
messages into the category GAMBLING instead of including them in the more
explicitly malicious category LOTTERY.

MISC categorises alert box contents which do not ﬁt into any other category
and include short cookie policy statements, welcome messages and password
prompts as well as various other kinds of miscellaneous messages.

5.2 Analysis

Our results show that a signiﬁcant portion of the scanned websites target
visitors with mobile web browser user agents. As Figures 1, 2 and 3, which
are located in the appendix, illustrate, there are few distinct messages dis-
played only to a speciﬁc user agent. While the difference in the number of
messages only shown to one speciﬁc user agent is not signiﬁcant, there is

12

https://bet.hkjc.com/marksix/ (last accessed: 30 November 2019)

Typosquatting for Fun and Proﬁt 13

a large disparity between the number of websites focussing on desktop web
browsers and those targeting mobile web browsers in general.

Figures 4, 5 and 6 illustrate the number of websites which displayed an alert
box only to one particular user agent. While some alert boxes are legitimately
directed at speciﬁc user groups, the number of alert boxes shown only to
desktop browsers is almost negligible. We present some possible explana-
tions for the speciﬁc targeting of mobile users in subsection 5.1 as well as
subsection 5.4.

As we found many websites displaying alert boxes only to users with mobile
web browser user agents and a relatively low diversity of messages (many of
which are presented to one particular user agent only), our ﬁndings indicate
that there are relatively few operators deploying their resources on a large
number of different websites at the same time.

The distribution of unique messages and sites appears quite similar in the
Austrian, US and Japanese scans. The notably higher number of distinct sites
showing alert boxes only to devices with the user agent iossafari in the
Austrian scan is caused by an accordingly increased count of sites displaying
messages of the LOTTERY category, which is discussed in subsection 5.3.

5.3 Category Analysis

To make further analysis of the message content possible as well as to sim-
plify the identiﬁcation of speciﬁc phishing campaigns, we translated every
message into English utilising Google Translate. This allowed us to clas-
sify the messages into the content categories described in subsection 5.1
regardless of the original language.

Figures 7, 8 and 9 show the number of distinct messages in each category;
as the ﬁgure shows, the greatest diversity in message content occurs in the
categories MISC, MOBILE and ERRORS.

While the majority of distinct messages belongs to legitimate non-malicious
categories, most of the recorded alert boxes actually do fall into malicious
categories. Figures 10, 11 and 12 depict the number of sites in each category.
The vast majority of alert boxes belong to the category APK and tries to
trick users into downloading and installing smartphone apps outside of the
controlled environment of their OS’s application store. Several “distinct”
messages in the LOTTERY category were identical except for the current date

14 Dam, Klausner, Schrittwieser

being included inside the message text, which differs for the subsequent scans
utilising the chosen user agents for technical reasons (i. e. the fact that we had
to stagger our scans over several days). As a result, the number of distinct
messages in this category appears somewhat higher in our data than it should
be. Taking this into account would yield 4 instead of 9 distinct messages
in the LOTTERY category for the Austrian scan and 1 instead of 4 distinct
messages for the Japanese scan, while the count would remain the same for
the US scan. The large number of distinct messages and websites in the MISC
category is attributable to the scattered characteristics of the messages in this
category and therefore not as signiﬁcant.

Furthermore, we found noticeable differences between our previous scan and
our new results. While the number of distinct messages in the APK category
increased, the number of distinct sites displaying APK or LOTTERY mes-
sages reduced drastically. Distinct messages and sites in the FRAUD category
decreased as well. While most messages of the previous scan in this category
claimed to provide some free credit for gambling if the user registers on
the website, current messages try to either trick users into downloading and
installing software or perform a technical support scam.

Finally, we want to discuss the joint distribution of user agents and message
content. Figures 13, 14 and 15 display the number of distinct messages shown
only to a particular user agent for each of the malicious categories (FRAUD,
LOTTERY, and APK), whereas Figures 16, 17 and 18 show the correspond-
ing graph for distinct websites. Most malicious alert boxes were encountered
while utilising a mobile web browser user agent, while only a small fraction
of the websites showed alert boxes on desktop browsers.

Our ﬁndings for the US and Japanese scans indicate that the majority of web-
sites in the category LOTTERY targeted the user agent iossafari, while the
Austrian scan showed a focus on androidchrome and iossafari (in that
order). The websites in the category APK mostly targeted user agents of mo-
bile web browsers (for obvious reasons), although there are few exceptions.
Some websites do not distinguish between user agents and provide the APK
ﬁle to all web browsers, while some seem to erroneously serve the APK ﬁle
to a speciﬁc desktop user agent.

Typosquatting for Fun and Proﬁt 15

5.4 Language Distribution

Since we discovered a number of different trends for targeting speciﬁc user
groups, we additionally analysed the language distribution of the collected
messages. As shown in Figures 19, 20 and 21, the vast majority of websites
displayed messages written in Chinese (zh) followed by English (en). The
Austrian scan results show a signiﬁcantly higher number of German (de)
messages, while the increase in English messages is not as striking for the US
scan. The Japanese scan results do not show a signiﬁcant increase in websites
displaying a Japanese (ja) message.

The main reason for the large number of Chinese messages is evident in
Figures 22, 23, 24, 25, 26 and 27, which show the distribution of languages
over messages as well as websites in the different categories: The category
APK (which contains the largest number of websites, cf. Figures 10, 11 and
12) consists solely of messages in Chinese, and several other categories have
a relatively large fraction of messages in Chinese, as well.

As we mentioned in our previous analysis, a large number of websites show-
ing messages in the main language(s) of a country might indicate localisation
attempts due to the utilisation of detection of IP addresses assigned to that
country. The aforementioned ﬁgures provide an insight into the IP address-
based localisation attempts, as well. Since most distinct German messages
and according distinct sites contained in the Austrian scan results are cat-
egorised as LOTTERY, unlike the US and Japanese scan results, these seem
to be localised for malicious purposes. In contrast, while the US scan does
exhibit an increased number of distinct websites showing messages written
in English, most of these are in the MISC category. The larger number of
English messages in this scan hence does not provide signiﬁcant evidence for
localisation attempts, both due to the characteristics of the messages in this
category and the distance of time between the Austrian and the US scans of
each website (during which some websites could have added or changed mes-
sages, in particular informational messages falling into the MISC category).
Finally, we were unable to detect any attempts at localisation in the Japanese
scan results. Therefore our ﬁndings indicate that IP address-based targeting
is only performed for speciﬁc languages.

The distribution of the languages across the different user agents is depicted
in Figures 28, 29 and 30 as well as Figures 31, 32 and 33. While the largest
fraction of distinct messages are written in English, the majority of websites
display alert boxes with Chinese messages.

16 Dam, Klausner, Schrittwieser

In summary, our results show that most alert boxes are displayed to visitors
utilising web browsers with mobile user agents as well as that the majority
of those alert box messages are in Chinese or English, with some country-
speciﬁc evidence of localisation attempts based on users’ IP addresses.

6 Future Work

Compared to our previous study [4], we explored language- and location-
speciﬁc targeting by conducting three different scans utilising IP addresses
from Austria, the United States and Japan via a VPN Service. Our results
show that localisation is indeed applied by scammers, although apparently
only for speciﬁc languages.

Additionally, we generated typosquatting domains based on the Majestic Mil-
lion websites utilising dnsmorph, which is able to perform IDN homograph
attacks – which is an improvement over dnstwist used in our ﬁrst scan.
While the tool provided this functionality, our generated list did not contain
any registered domains with IDN homographs.

A possibility to further improve our work could be the replacement of the
manual process of assigning categories to distinct messages by a fully auto-
mated classiﬁcation process utilising machine learning algorithms. A review
of the existing categories might be necessary, as well, and the categorisation
might rely solely on the message content instead of including background
knowledge. This new process could establish a periodical automatic analysis
enabling the observance of developments and trends in pop-up scams.

7 Conclusion

Techniques similar to those used for displaying pop-up ads in the early days
of the World Wide Web are now used by malicious websites to deliver online
scam. JavaScript alert message boxes steal the focus of the website, show
a short text message to the user and try to either lure or scare the user into
taking speciﬁc actions or exposing their data. Unfortunately, little scientiﬁc
attention has been paid so far to the techniques utilised by scam websites to
gain the attention of users and to retrieve data such as credit card information.

Typosquatting for Fun and Proﬁt 17

We performed large-scale scans of typosquatting URLs based on the Majestic
Million websites with IP addresses from Austria, the United States and Japan
via automated Chromium browsers utilising a modiﬁed version of the MIN-
INGHUNTER [20] framework in combination with a VPN service. The three
scans with ﬁve different user agents resulted in an aggregated total of 7 400
recorded alert boxes, out of which 4 334 can be considered malicious.

Our in-depth analysis presented characteristics of web-based scam campaigns
and outlined target groups and goals of the various attacks. It showed that a
signiﬁcant fraction of websites displayed a pop-up box to one speciﬁc HTTP
user agent only, and that most of them focused on mobile web browsers.

Different message categories were deﬁned based on the message content and
the websites displaying an alert box containing the message. The largest cat-
egory is APK, which is trying to trick the user into directly downloading and
installing a potentially malicious application.

Another aspect of our analysis was the distribution of different languages.
We found that most websites were displaying alert box messages in Chinese,
followed by English. Chinese messages often fell into the category APK and
targeted a mobile web browser user agent.

Compared to our previous work, we found an overall decline of websites
utilising malicious alert boxes for pop-up scam. The results of our Austrian
scan showed the same evidence of localisation attempts, whereas the US and
Japanese scans exhibited no signiﬁcant evidence of localisation. It appears
that this technique is only applied to some speciﬁc languages.

Acknowledgements

This research was funded by the Austrian Research Promotion Agency (FFG)
BRIDGE project 853264 “Privacy and Security in Online Advertisement
(PriSAd)” as well as the Josef Ressel Center TARGET. The ﬁnancial support
by the Austrian Research Promotion Agency, the Federal Ministry for Digital
and Economic Affairs and the Christian Doppler Research Association is
gratefully acknowledged.

18 Dam, Klausner, Schrittwieser

Appendix

Figure 1: Number of distinct messages displayed to one
particular user agent (Austrian IP address)

Figure 2: Number of distinct messages displayed to one
particular user agent (US IP address)

Figure 3: Number of distinct messages displayed to one
particular user agent (Japanese IP address)

chromeieiossafariﬁrefoxandroidchromedistinct messagesuser agents62926734chromeieiossafariﬁrefoxandroidchromedistinct messagesuser agents122628622chromeieiossafariﬁrefoxandroidchromedistinct messagesuser agents330301426Typosquatting for Fun and Proﬁt 19

Figure 4: Number of websites targeting one
particular user agent (Austrian IP address)

Figure 5: Number of websites targeting one
particular user agent (US IP address)

Figure 6: Number of websites targeting one
particular user agent (Japanese IP address)

chromeieiossafariﬁrefoxandroidchromedistinct sites (log10 scale)user agents6426813274chromeieiossafariﬁrefoxandroidchromedistinct sites (log10 scale)user agents2338348279chromeieiossafariﬁrefoxandroidchromedistinct sites (log10 scale)user agents741251125220 Dam, Klausner, Schrittwieser

Figure 7: Number of distinct messages per category (Austrian IP address)

Figure 8: Number of distinct messages per category (US IP address)

Figure 9: Number of distinct messages per category (Japanese IP address)

FraudLotteryAPKErrorsDownloadAdultMobileGamblingMiscdistinct messagescategories193379844310116FraudLotteryAPKErrorsDownloadAdultMobileGamblingMiscdistinct messagescategories123473834312122FraudLotteryAPKErrorsDownloadAdultMobileGamblingMiscdistinct messagescategories143870723917127Typosquatting for Fun and Proﬁt 21

Figure 10: Number of distinct sites per category (Austrian IP address)

Figure 11: Number of distinct sites per category (US IP address)

Figure 12: Number of distinct sites per category (Japanese IP address)

FraudLotteryAPKErrorsDownloadAdultMobileGamblingMiscdistinct sites (log10 scale)categories1808471011144414120FraudLotteryAPKErrorsDownloadAdultMobileGamblingMiscdistinct sites (log10 scale)categories4482891103446166FraudLotteryAPKErrorsDownloadAdultMobileGamblingMiscdistinct sites (log10 scale)categories14804819241515422 Dam, Klausner, Schrittwieser

Figure 13: Distribution of distinct messages over
different user agents in malicious categories (Austrian IP address)

Figure 14: Distribution of distinct messages over
different user agents in malicious categories (US IP address)

Figure 15: Distribution of distinct messages over
different user agents in malicious categories (Japanese IP address)

5102025FraudLotteryAPKdistinct messagescategorieschromeieiossafariﬁrefoxandroidchrome5102025FraudLotteryAPKdistinct messagescategorieschromeieiossafariﬁrefoxandroidchrome5102025FraudLotteryAPKdistinct messagescategorieschromeieiossafariﬁrefoxandroidchromeTyposquatting for Fun and Proﬁt 23

Figure 16: Distribution of distinct sites over
different user agents in malicious categories (Austrian IP address)

Figure 17: Distribution of distinct sites over
different user agents in malicious categories (US IP address)

Figure 18: Distribution of distinct sites over
different user agents in malicious categories (Japanese IP address)

51050100500800FraudLotteryAPKdistinct sites (log10 scale)categorieschromeieiossafariﬁrefoxandroidchrome51050100500800FraudLotteryAPKdistinct sites (log10 scale)categorieschromeieiossafariﬁrefoxandroidchrome51050100500800FraudLotteryAPKdistinct sites (log10 scale)categorieschromeieiossafariﬁrefoxandroidchrome24 Dam, Klausner, Schrittwieser

Figure 19: Number of distinct sites displaying messages
in a speciﬁc language (Austrian IP address)

Figure 20: Number of distinct sites displaying messages
in a speciﬁc language (US IP address)

Figure 21: Number of distinct sites displaying messages
in a speciﬁc language (Japanese IP address)

zhendejakofrruesitarfanldanoiwﬁdistinct sites (log10 scale)languages (ISO 639-1)93214489211175331111111zhenjadekorufresitnlarfadanoptﬁdistinct sites (log10 scale)languages (ISO 639-1)9271632210966332111111zhenjakodefrruesitidnlarfanodaptdistinct sites (log10 scale)languages (ISO 639-1)906134219954322111111Typosquatting for Fun and Proﬁt 25

Figure 22: Distribution of distinct messages over
different languages by category (Austrian IP address)

Figure 23: Distribution of distinct messages over
different languages by category (US IP address)

Figure 24: Distribution of distinct messages over
different languages by category (Japanese IP address)

51020305060FraudLotteryAPKErrorsDownloadAdultMobileGamblingMiscdistinct messagescategorieszhendeothers51020305060FraudLotteryAPKErrorsDownloadAdultMobileGamblingMiscdistinct messagescategorieszhenjaothers51020305060FraudLotteryAPKErrorsDownloadAdultMobileGamblingMiscdistinct messagescategorieszhenjaothers26 Dam, Klausner, Schrittwieser

Figure 25: Distribution of distinct sites over
different languages by category (Austrian IP address)

Figure 26: Distribution of distinct sites over
different languages by category (US IP address)

Figure 27: Distribution of distinct sites over
different languages by category (Japanese IP address)

51050100800FraudLotteryAPKErrorsDownloadAdultMobileGamblingMiscdistinct sites (log10 scale)categorieszhendeothers51050100800FraudLotteryAPKErrorsDownloadAdultMobileGamblingMiscdistinct sites (log10 scale)categorieszhenjaothers51050100800FraudLotteryAPKErrorsDownloadAdultMobileGamblingMiscdistinct sites (log10 scale)categorieszhenjaothersTyposquatting for Fun and Proﬁt 27

Figure 28: Distribution of distinct messages over
different languages by user agent (Austrian IP address)

Figure 29: Distribution of distinct messages over
different languages by user agent (US IP address)

Figure 30: Distribution of distinct messages over
different languages by user agent (Japanese IP address)

52030406080chromeieiossafariﬁrefoxandroidchromedistinct messagesuser agentszhendejakoothers52030406080chromeieiossafariﬁrefoxandroidchromedistinct messagesuser agentszhenjadekoothers52030406080chromeieiossafariﬁrefoxandroidchromedistinct messagesuser agentszhenjakodeothers28 Dam, Klausner, Schrittwieser

Figure 31: Distribution of distinct sites over
different languages by user agent (Austrian IP address)

Figure 32: Distribution of distinct sites over
different languages by user agent (US IP address)

Figure 33: Distribution of distinct sites over
different languages by user agent (Japanese IP address)

51050100500800chromeieiossafariﬁrefoxandroidchromedistinct sites (log10 scale)user agentszhendejakoothers51050100500800chromeieiossafariﬁrefoxandroidchromedistinct sites (log10 scale)user agentszhenjadekoothers51050100500800chromeieiossafariﬁrefoxandroidchromedistinct sites (log10 scale)user agentszhenjakodeothersTyposquatting for Fun and Proﬁt 29

References

[1] Sherly Abraham and InduShobha Chengalur-Smith. An Overview of Social Engineering

Malware: Trends, Tactics, and Implications. Technol. Soc., 32(3):183–196, 2010.

[2] Alexa Internet, Inc. Alexa Top 1,000,000 Sites. 2019.
[3] Yao-Ping Chou, Shi-Jinn Horng, Hung-Yan Gu, Cheng-Ling Lee, Yuan-Hsin Chen, and
Yi Pan. Detecting Pop-Up Advertisement Browser Windows Using Support Vector
Machines. J. Chin. Inst. Eng., 31(7):1189–1198, 2008.

[4] Tobias Dam, Lukas Daniel Klausner, Damjan Buhov, and Sebastian Schrittwieser. Large-
Scale Analysis of Pop-Up Scam on Typosquatting URLs. In Proceedings of the 14th
International Conference on Availability, Reliability and Security, ARES ’19, pages
53:1–53:9, New York, NY, United States, 2019. ACM.

[5] Artem Dinaburg. Bitsquatting: Dns hijacking without exploitation.

(presented at

BlackHat Security 2011), 2011.

[6] Benjamin Edelman. Large-Scale Registration of Domains with Typographical Errors.

(unpublished), 2003.

[7] Dara B. Gilwit. The Latest Cybersquatting Trend: Typosquatters, Their Changing Tac-
tics, and How to Prevent Public Deception and Trademark Infringement. Wash. U. J. L.
& Pol’y, 11:267–294, 2003.

[8] Saul Hansell. As consumers revolt, a rush to block pop-up online ads. The New York

Times, page C00001, 19 Jan 2004.

[9] Tobias Holgers, David E. Watson, and Steven D. Gribble. Cutting Through the Con-
In Proceedings of the Annual
fusion: A Measurement Study of Homograph Attacks.
Conference on USENIX ’06 Annual Technical Conference, Annual Tech ’06, pages
261–266, Berkeley, CA, United States, 2006. USENIX Association.

[10] Panagiotis Kintis, Najmeh Miramirkhani, Charles Lever, Yizheng Chen, Rosa Romero-
Gómez, Nikolaos Pitropakis, Nick Nikiforakis, and Manos Antonakakis. Hiding in Plain
In Proceedings of the 2017
Sight: A Longitudinal Study of Combosquatting Abuse.
ACM SIGSAC Conference on Computer and Communications Security, CCS ’17, pages
569–586, New York, NY, United States, 2017. ACM.

[11] Baojun Liu, Chaoyi Lu, Zhou Li, Ying Liu, Haixin Duan, Shuang Hao, and Zaifeng
Zhang. A reexamination of internationalized domain names: The good, the bad and
In 48th IEEE/IFIP International Conference on Dependable Systems and
the ugly.
Networks, DSN 2018, pages 654–665, Washington, DC, United States, 2018. IEEE
Computer Society.

[12] Majestic-12 Ltd. Majestic Million. 2019.
[13] Najmeh Miramirkhani, Oleksii Starov, and Nick Nikiforakis. Dial One for Scam: A
In 24th Network and Distributed
Large-Scale Analysis of Technical Support Scams.
System Security Symposium, NDSS 2017, pages 1–15, Reston, VA, United States, 2016.
Internet Society.

[14] Rami M. Mohammad, T. L. McCluskey, and Fadi Abdeljaber Thabtah. Predicting Phish-
ing Websites using Neural Network trained with Back-Propagation. In Proceedings of
the 2013 World Congress in Computer Science, Computer Engineering, and Applied
Computing, WORLDCOMP’13, pages 682–686, 2013.

30 Dam, Klausner, Schrittwieser

[15] Rami M. Mohammad, Fadi Abdeljaber Thabtah, and Lee McCluskey.

Predicting
Phishing Websites Based on Self-Structuring Neural Network. Neural Comput. Appl.,
25(2):443–458, 2014.

[16] Nick Nikiforakis, Marco Balduzzi, Lieven Desmet, Frank Piessens, and Wouter Joosen.
Soundsquatting: Uncovering the Use of Homophones in Domain Squatting. In Inform-
ation Security, ISC 2014, Lecture Notes in Computer Science 8783, pages 291–308,
Cham, Switzerland, 2014. Springer International Publishing.

[17] Nick Nikiforakis, Luca Invernizzi, Alexandros Kapravelos, Steven Van Acker, Wouter
Joosen, Christopher Kruegel, Frank Piessens, and Giovanni Vigna. You Are What You
In Proceedings of
Include: Large-Scale Evaluation of Remote JavaScript Inclusions.
the 2012 ACM Conference on Computer and Communications Security, CCS ’12, pages
736–747, New York, NY, United States, 2012. ACM.

[18] Nick Nikiforakis, Steven Van Acker, Wannes Meert, Lieven Desmet, Frank Piessens,
and Wouter Joosen. Bitsquatting: Exploiting Bit-Flips for Fun, or Proﬁt? In Proceedings
of the 22nd International Conference on World Wide Web, WWW ’13, pages 989–998,
New York, NY, United States, 2013. ACM.

[19] Tianrui Peng, Ian Harris, and Yuki Sawa. Detecting Phishing Attacks Using Natural
In 12th IEEE International Conference
Language Processing and Machine Learning.
on Semantic Computing, ICSC 2018, pages 300–301, Washington, DC, United States,
2018. IEEE Computer Society.

[20] Julian Rauchberger, Sebastian Schrittwieser, Tobias Dam, Robert Luh, Damjan Buhov,
Gerhard Pötzelsberger, and Hyoungshick Kim. The Other Side of the Coin: A Frame-
work for Detecting and Analyzing Web-Based Cryptocurrency Mining Campaigns.
In Proceedings of the 13th International Conference on Availability, Reliability and
Security, ARES 2018, pages 18:1–18:10, New York, NY, United States, 2018. ACM.
[21] Shelly Rodgers and Esther Thorson. The Interactive Advertising Model: How Users

Perceive and Process Online Ads. J. Interact. Advert., 1(1):41–60, 2000.

[22] Mike Schiffman. Farsight Security Global Internationalized Domain Name Homograph

Report Q2/2018. (unpublished), 2018.

[23] David Sharek, Cameron Swofford, and Michael Wogalter. Failure to Recognize Fake
Internet Popup Warning Messages. Proc. Hum. Factors Ergon. Soc. Annu. Meet.,
52(6):557–560, 2008.

