IET Research Journals

Submission Template for IET Research Journal Papers

Hybrid data-driven physics model-based
framework for enhanced cyber-physical
smart grid security
Cody Ruben1∗, Surya Dhulipala1, Keerthiraj Nagaraj1, Sheng Zou1, Allen Starke1, Arturo Bretas1, Alina
Zare1, Janise McNair1
1 Electrical and Computer Engineering, University of Florida, 1064 Center Dr, Gainesville, FL, USA
* E-mail: cruben31@uﬂ.edu

ISSN 1751-8644
doi: 0000000000
www.ietdl.org

Abstract: This paper presents a hybrid data-driven physics model-based framework for real time monitoring in smart grids. As
the power grid transitions to the use of smart grid technology, it’s real time monitoring becomes more vulnerable to cyber attacks
like false data injections (FDI). Although smart grids cyber-physical security has an extensive scope, this paper focuses on FDI
attacks, which are modeled as bad data. State of the art strategies for FDI detection in real time monitoring rely on physics
model-based weighted least squares state estimation solution and statistical tests. This strategy is inherently vulnerable by the
linear approximation and the companion statistical modeling error, which means it can be exploited by a coordinated FDI attack.
In order to enhance the robustness of FDI detection, this paper presents a framework which explores the use of data-driven
anomaly detection methods in conjunction with physics model-based bad data detection via data fusion. Multiple anomaly detection
methods working at both the system level and distributed local detection level are fused. The fusion takes into consideration the
conﬁdence of the various anomaly detection methods to provide the best overall detection results. Validation considers tests on
the IEEE 118 bus system.

This paper is a preprint of a paper submitted to IET Smart Grid.
If accepted, the copy of record will be available at the IET Digital
Library.

1

Introduction

The future power grid, or Smart Grid (SG), will integrate con-
trol, communication and computation aiming to achieve stability,
efﬁciency and robustness of the physical processes on the sys-
tem. These advancements bring many challenges to the SG and
therefore have drawn much attention from academia, industry and
government due to the great impact they will have on society, eco-
nomics and the environment. While a great amount of research
has been done towards these objectives, science and technology
related to the cyber-physical security of SGs are still immature.
Additionally, much of the critical infrastructure is currently transi-
tioning towards the paradigm of SGs by increasing the dependency
of control of physical processes on communication networks, thus
becoming exposed to cyber-threats [1].

Guaranteeing the reliable operation of power grids is crucial
for today’s society and it is done through real-time power sys-
tem monitoring. Currently, real-time monitoring is done through a
process called power system state estimation (PSSE) [2], which pro-
vides relevant information on the power grid current operating point
based on the measurements throughout the system. These measure-
ments are commonly transmitted to a Supervisory Control and Data
Acquisition (SCADA) system, which implements centralized moni-
toring and control for the electrical grid, where PSSE is performed.
One important feature of PSSE is its error processing capability.
Measurements that are clearly inconsistent are discarded in the pre-
ﬁltering step, which precedes state estimation step. Following state
estimation using pre-ﬁltered data, a post-processing step called bad
data analysis is performed. This step aims at detecting bad data or
gross errors (GE), assuming they are statistically large errors.

The established procedure to determine the current operating
point for the power grid has been based on iterative numerical lin-
earization around the incumbent solution, which is determined easily

by least squares approaches to ﬁnd solutions within the convex hull.
There is always an inherent error in this approximation procedure
that is difﬁcult to quantify, but it has been sufﬁciently small for
the current requirements of dispatching, detection of failures, and
reliability studies. This linear approximation and the companion sta-
tistical modeling error approach alone are not compatible to the new
demands of cyber-physical security because its sensitivity and speci-
ﬁcity is theoretically lower bounded by the level and dynamics of the
approximation error, which can be easily explored by coordinated
cyber-attacks.

The increasing dependence on digital monitoring and control of
power systems raises concerns with respect to cybersecurity. One
common type of cyber-threat is false data injection (FDI) attack,
where an attack aims to disrupt the operation of the power grid by
modifying a subset of measurement values. While bad data anal-
ysis is capable of detecting many instances of Gross Errors via
tests such as the Chi Squared Test, largest normalized residual [3]
or innovation-based [4] approaches, intelligent cyber-attacks may
be engineered to be difﬁcult to detect [5], considering the implicit
constraints of physics model-based solutions.

Methods devised to tackle FDI attacks include Generalized Like-
lihood Ratio Detector with L-1 Norm Regularization [6], a scheme
for protecting a selected set of measurements and verifying the val-
ues of a set of state variables independently [7], and the estimation of
the normalized composed measurement error for detection of mali-
cious data attacks [8]. These solutions all consider a quasi-static
physics measurement model, however the power grid is a time-
varying system with loads and generation constantly changing. Thus
grid temporal characteristics are not fully explored for FDI detection.
temporal characteristics, machine
learning based solutions have also been explored for anomaly detec-
tion. The Correlation-based Detection (CorrDet) algorithm [9] was
introduced for landmine detection. The Reed-Xiaoli (RX) Detector
[10] was introduced for target detection of remote sensing images.
Both methods rely on the approach where an incoming sample
is classiﬁed as abnormal if its squared Mahalanobis distance with
respect to a background statistic is above some threshold.

Considering environment

IET Research Journals, pp. 1–9
c(cid:13) The Institution of Engineering and Technology 2015

1

9
1
0
2

v
o
N
5
1

]

Y
S
.
s
s
e
e
[

2
v
7
9
1
0
1
.
0
1
9
1
:
v
i
X
r
a

 
 
 
 
 
 
Notation

J(x)
d
P
αχ
z
z∗
ˆz
Z
ˆZ
K1
K2
x
x∗
ˆx
N
ΣSE

Σ
e
eD
eU
II
σ
h(x)
H
B
χ2
r
CM E
Wt
β
σ2
n
µo−u(t)
δCD
µ
τ

d,p

T
l
α
M
Y
ˆY
φm
ΦE
ΦR
δZ,m

δzˆk

ΨECD

ΨSE

Ψf usion

for

state

Explanation
WLS cost function - R1×1
number of measurements - R1×1
projection matrix - Rd×d
signiﬁcance level - R1×1
vector of measurements - R1×d
operating measurement vector - R1×d
estimated measurement vector - R1×d
training set - Rd×K1
testing set - Rd×K2
number of samples in training set - R1×1
number of samples in testing set - R1×1
vector of state variables - R1×N
operating state vector - R1×N
estimated state vector - R1×N
number of states - R1×1
covariance of measurement vector
estimator- Rd×d
covariance of measurement vector - Rd×d
vector of measurement error - R1×d
detectable component of error - R1×1
undetectable component of error - R1×1
Innovation Index of measurement - R1×1
standard deviation of e - R1×1
vector of measurement estimates - Rd×d
Jacobian matrix - Rd×N
set of buses j (cid:51) Yij (cid:54)= 0
Chi-squared value - R1×1
vector of measurement residuals - R1×d
Composed Measurement Error - R1×1
driving noise of O-U process
decay-rate of O-U process
variance of noise of O-U process
long term mean of O-U process
squared Mahalanobis distance value - R1×1
mean of measurement vector - R1×d
threshold value to classify abnormal samples -
R1×1
set of τ (R1×M )
label of a sample - R1×1
weight value - R1×1
number of buses - R1×1
label for training samples - R1×K1
label for testing samples -R1×K2
symbol for m-th Local CorrDet detector
symbol for Ensemble CorrDet detector
symbol for CorrDet detector
δCD of all training samples with respect to φm -
R1×K1
δCD of k-th testing sample with respect to ΦE -
R1×M
overall decision scores from Ensemble CorrDet
detector - R1×K2
decision scores from state estimator technique -
R1×K2
fusion decision scores for hybrid data-driven
physics model-based framework - R1×K2

Some artiﬁcial intelligence-related detection methods have been
put forward in recent years, which are mainly based on neural net-
work, deep learning and fuzzy clustering [11, 12]. In [13], the
authors focus on the detection of false data injection attacks in smart
grids using a deep belief network-based (DBN) attack detection
method with unsupervised learning methods to provide the initial
weights. The authors of [14], overcome the above-mentioned prob-
lems with Artiﬁcial Neural Network (ANN) based approach which
identiﬁes the FDI by tracking the measurement data. The uniqueness
of the neural network method is simple infrastructure but uneasy
in the parameter adjustment. Numerous tests should be utilized to
train the network model. A deep learning method originates from the
neural network, which can solve the overﬁtting problems well but
the training method is more complex [15]. Unsupervised learning
is performed from the bottom of the restricted Boltzmann machine
to provide initial weights for the network. The backpropagation
algorithm propagates the error from top to bottom and ﬁne-tunes the
model parameters.

Considering hybrid data-driven physics model-based solutions for
FDI detection, literature review will present seldom contributions.
It is clear that analytic quasi-static model-based solutions can rep-
resent spatial characteristics of the environment, while data-driven
solutions can explore temporal characteristics which are inherent to
the grid operation. Thus they are complementary solutions. Con-
sidering such rationale, in [16], a previous work of the authors, an
extended Chi-squared test using information from PSSE and a data
driven CorrDet algorithm [9] is presented.

In this work, a hybrid data-driven physics model-based frame-
work for FDI detection on system real-time monitoring is presented.
Figure 1 illustrates the presented framework, which explores both
temporal and spatial characteristics of the environment in a dis-
tributed multi-agent architecture. An Ensemble CorrDet algorithm
is presented to address drifting load scenarios and numerical issues.
The CorrDet algorithm is used to learn the background statistics (e.g.
mean and covariance for normal samples) over the whole power grid
topology, consisting of a series of buses where feature (measure-
ment) values are measured in a single bus or between two buses.
Ensemble CorrDet detector can be considered as a set of CorrDet
detectors for each local environment. Therefore, Ensemble CorrDet
detector learns a series of background statistics, one for each bus.
There are several advantages for using Ensemble Corrdet detec-
tor compared to Corrdet detector. FDI are sparse, thus learning the
background statistics on each bus, instead of the whole power sys-
tem topology, allows for a more sensitive anomaly detection while
embedding local environmental spatial characteristics to the data-
driven solution. More speciﬁcally, spatially neighboring buses are
more highly correlated and easier to be affected by an attack while
buses that are further away have lower correlation. Thus, learning
a full covariance over all measurements of all buses is unnecessary
(nearly sparse covariance), especially when training data is limited.
Instead, local, fewer dimensional measurement sets offer a more
accurate statistic estimation and a computationally cheaper, more
sensitive anomaly detection. Ensemble CorrDet detector is also a
scalable solution as even when more buses are added to the grid,
we could just add a Local CorrDet detector to that bus and include
the result of this local detector in the Ensemble CorrDet algorithm.
Second, learning the background statistics on the whole power sys-
tem topology is usually more challenging than learning on a bus. The
latter allows a distributed local environmental model learning on the
much smaller dimensional data (usually several measurements) than
the former (usually several hundreds of measurements). To avoid
the numerical issues due to large dimensions, a much larger train-
ing set would be necessary for the CorrDet detector to achieve the
same performance, otherwise, estimated background statistics are
often ill-posed. Third, Ensemble CorrDet detector is more robust and
secure than CorrDet detector, since the classiﬁcation of the anomaly
for Ensemble CorrDet detector is an aggregated decision of a series
of local CorrDet detectors, as a committee, allowing for a small num-
ber of failed local CorrDet detections, while CorrDet detector is a
single detector. Lastly, a good feature of Ensemble CorrDet detector
is FDI localization. For instance, if an FDI happens on a measure-
ment between two buses and the corresponding two local CorrDet

2

IET Research Journals, pp. 1–9
c(cid:13) The Institution of Engineering and Technology 2015

Fig. 1: Distributed multi-agent architecture

detectors ﬂags the sample as abnormal, it can also be inferred that
the FDI is a measurement between the two buses, while CorrDet
detector cannot ﬁnd the location where false data was injected.

In order to create the hybrid between physics model-based and
data-driven solutions, a decision level fusion solution is presented.
On such, several data-driven and physics-based methods for the FDI
attacks detection on SG real-time monitoring are combined produc-
ing one output. The fusion considers the conﬁdence of each anomaly
detection method, creating the hybrid method that proves to perform
better than any of the individual detection methods.
The contributions of this paper are as follows:

• Decision level fusion is used to create a hybrid physics-based
data-driven anomaly detection that considers the conﬁdence of indi-
vidual anomaly detection methods such that different anomalies
detected by the individual methods can be aggregated upon fusion;
• A data-driven Ensemble CorrDet anomaly detection method is
presented which works in a distributed fashion, allowing for more
sensitive local detection on the spatial domain;
• Using a physics-based bad data detection method considering the
Innovation Concept to improve the data driven detection method.

The remainder of the paper is organized as follows. In Section 2,
background information of the challenges and existing solutions are
presented. Section 3 presents the proposed framework, discussing
each component and how they are used to build the framework. The
results of numerical tests used to evaluate the method’s performance
are shown in Section 4. Finally, Section 5 presents the conclusions
of this work.

Background, Challenges, Existing Solutions

2
and their Limitations

exposes the system to cyber-attacks, it becomes increasingly impor-
tant to develop countermeasures [17–22]. Most research [23–25]
in this area focuses on improving bad data detection schemes or
improving the security of the communication system. An analy-
sis of the state-of-the-art physics model-based solutions for FDI
detection on SGs real-time monitoring will show that these apply
residual-based approaches for cyber-attack detection, while ignor-
ing the inherent masked error component [26]. Still, as cited in [27],
a stealthy attack requires the corruption of several measurements.
This relates to the fact that a stealthy attack must have the attack
vector ﬁtting the measurement model, which is equivalent to shifting
the result of the state estimation to a physically possible but wrong
solution. Cyber-attacks with such characteristics are hard to discover
when applying the classical bad data approaches, which may cause
the cyber-attack to remain undetected [28].

The authors of [29] proposed an interval forecasting method to
predict the possible largest variation bounds of each state variable
based on a worst-case analysis based on the forecasting uncertain-
ties of renewable energy sources, and electric loads. Works such as
[30] also use extreme learning machine-based (ELM) one-class-one-
network (OCON) and prediction methods to improve the resilience
of the power system, exploiting the spatial correlation of power data
within subnets.

While power systems are ideally in a steady state, there are con-
stant variations to load and generation. Current bad data analysis
techniques in power systems work in a quasi-steady state, only con-
sidering a single snapshot of the system. In theory, temporal changes
on the system could add more information for bad data detection that
current techniques are not using. In [16], the authors begin to make
use of this temporal data by developing an extended Chi-squared
test that combines the classical PSSE method with a data driven
CorrDet algorithm that takes into account past data. This extended
Chi-squared test does not work as well when introduced to more
realistic load variation and stealthier FDI attacks.

2.1

Smart Grid System

2.2 CorrDet and Ensemble CorrDet detectors

PSSE plays a crucial role in SG real-time monitoring, as it is respon-
sible for estimating unknown system state variables based mostly
on measurements of voltage, power and current. As SG evolution

The CorrDet detector is capable of training a data-driven anomaly
detector, however it is not very efﬁcient and may suffer from numer-
ical issues when the number of measurements is large. Therefore,

IET Research Journals, pp. 1–9
c(cid:13) The Institution of Engineering and Technology 2015

3

ensemble CorrDet detector is proposed. For the CorrDet detector,
only one set of parameters (sample mean, sample covariance matrix
and detection threshold) are estimated for the whole power system.
These parameters, especially covariance matrix, characterize the cor-
relations among all measurements on all buses. The required number
of training samples rapidly grows when the number of measurements
increases. Therefore, the detector parameters, especially the covari-
ance matrix, are usually not well-trained, resulting in numerical
issues and bad detection performance when the number of training
samples is limited. However, learning a full covariance matrix for all
measurements is actually not necessary since the covariance matrix
is sparse. The reason is that the farther two buses are, the less correla-
tion their measurements will have. In other words, if an FDI happens
on one measurement, the most probable affected buses are usually
the one or two that the measurement is linked to. Thus, this chal-
lenge can be tackled by considering the detection at a smaller spatial
scale. More speciﬁcally, instead of training the detector parameters
at the scale of all measurements of all buses, we can train a set of
detectors, which trains measurements associated on each single bus.
Typically, the number of measurements that are linked to each
bus is less than ten, while the total number of measurements is sev-
eral hundred. The reduced dimensionalities for each local CorrDet
detector yields more accurate estimation of normal sample means
and covariance matrices and ﬁnally a more sensitive detection. By
looking at which local CorrDet detector(s) reports an anomaly, we
can further infer the possible position where the FDI happens.

Hybrid Physics Model-Based Data-Driven

3
Framework

3.1

Physics Model

In modern Energy Management Systems (EMS), the State Estima-
tion (SE) process is the core process for situational awareness of
a power system and is used in many EMS applications, including
the detection of bad data. The common approach to SE is using the
classical Weighted Least Squares (WLS) method described in [2]. In
this approach, the system is modeled as a set of non-linear algebraic
equations based on the physics of the system:

z = h(x) + e
(1)
where z ∈ R1×d is the measurement vector, x ∈ R1×N is the vector
of state variables, h : R1×N → R1×d is a continuously non-linear
differentiable function, and e ∈ R1×d is the measurement error vec-
tor. Each measurement error, ei is assumed to have zero mean,
standard deviation σi and Gaussian distribution. d is the number of
measurements and N is the number of states.

In the classical WLS approach, the best estimate of the state

vector in (1) is found by minimizing the cost function J(x):

J(x) = (cid:107)z − h(x)(cid:107)2

Σ−1
SE

= [z − h(x)](cid:48)Σ

−1
SE[z − h(x)]

(2)

where Σ is the covariance matrix of the measurements. In this paper,
we consider the standard deviation of each measurement to be 1%
of the measurement magnitude, which has been shown to improve
the detection of bad data [31]. The covariance submatrix for zero
injection measurements is calculated as shown in (4) and (5) . In
order to solve this problem, (1) is linearized at a certain point x∗ in
(3) and the optimal states are found through an iterative process.

∆z = H∆x + e
(cid:115)(cid:88)

σ(Pi) =

σ2(Pij )

j∈B

(cid:115)(cid:88)

j∈B

σ2(Qij )

σ(Qi) =

(3)

(4)

(5)

where H = δh
δx is the Jacobian matrix of h at the current state
estimate x∗, ∆z = z − h(x∗) = z − z∗ is the correction of the
measurement vector and ∆x = x − x∗ is the correction of the state
vector. B is the set of buses j (cid:51) Yij (cid:54)= 0. The WLS solution is
the projection of ∆z onto the Jacobian space by a linear projection
matrix P, i.e. ∆z = P∆ˆz. Letting r = ∆z − ∆ˆz be the residual
vector, the P matrix that minimizes J(x) will be orthogonal to the
Jacobian range space and to r; ∆ˆz = H∆ˆx. This is in the form:

(cid:104)∆ˆz, r(cid:105) = (H∆ˆx)(cid:48)Σ−1

SE(∆z − H∆ˆx) = 0.

Solving (6) for ∆ˆx:

∆ˆx = (H(cid:48)Σ

−1

SEH)−1H(cid:48)Σ

−1
SE∆z.

(6)

(7)

At each iteration, a new incumbent solution x∗

new is found and
new = x∗ + ∆ˆx. (7) is solved each iteration
updated following x∗
until ∆ˆx is sufﬁciently small to claim convergence of the solution.
Once the SE converges, the Innovation Concept is used for the detec-
tion of bad data in the measurement vector z [4, 8]. In the Innovation
Concept, the Innovation Index (II) in (8) is deﬁned as the ratio of the
detectable and undetectable components of the measurement error
and can be calculated using the projection matrix, P, of the WLS
solution (9).

IIi =

||eDi||Σ−1
||eU i||Σ−1

SE

SE

√

1 − Pii
√
Pii

.

=

P = (H(cid:48)Σ

−1

SEH)−1H(cid:48)Σ

−1
SE.

(8)

(9)

The II and the measurement residual, r, are used to calculate
the Composed Measurement Error (CME) for each measurement,
as shown in (10).

(cid:115)

CM Ei = ri

1 +

1
II 2
i

.

(10)

The measurements are considered to be i.i.d, so the statistical Chi-

squared test is used, as shown in (11).

(cid:21)2

d
(cid:88)

i=1

(cid:20) CM Ei
σi

> χ2

αχ,d

(11)

for d degrees of freedom and signiﬁcance level αχ. In this paper, the
common signiﬁcance level of 0.05 is used. If the sum of normalized
CME values is greater than the Chi-squared distribution value, then
bad data with (1 − αχ) conﬁdence level is detected. We call this
statistical test CME Chi-Square Test (CMECST).

3.2 Data-Driven Machine Learning

information that

In addition to the spatial
is used in physics
based-model, data-driven machine learning algorithms (CorrDet and
Ensemble CorrDet algorithms) are proposed to take advantage of
both temporal and spatial information. CorrDet algorithm is pro-
posed to estimate the sample statistics globally, while Ensemble
CorrDet algorithm combines Local CorrDet estimates, where spa-
tially remote correlations are ignored but the spatially neighboring
correlations are reserved.

3.2.1 CorrDet Anomaly Detection: The machine learning
layer of the proposed smart power grid framework uses the knowl-
edge of already veriﬁed data to learn the normal state of a properly
functioning grid. It is then able to detect any anomalies introduced
into the system at any point forward and alerts the cloud layer,
as shown in Figure 1, to identify the anomaly, isolate it from the
remainder of the system and take appropriate action to prevent con-
tamination of the system, with regards to both power distribution
in other subsystems, and data assimilation by the machine learning
system itself.

4

IET Research Journals, pp. 1–9
c(cid:13) The Institution of Engineering and Technology 2015

A machine learning layer is implemented using the CorrDet
Anomaly Detection [9, 10, 32] algorithm described in equation (12),
where z is the new incoming data, µ is the mean and Σ−1 is the
inverse covariance matrix of normal samples. Equation (12) calcu-
lates the squared Mahalanobis distance, δCD(z), of a given data z,
from the mean, µ of the distribution.

δCD(z) = (z − µ)T Σ−1(z − µ).
The anomaly detector is trained with the ﬁrst k number of incom-
ing samples to generate the µ and Σ−1. It then accepts new data and
uses equation (12) to determine its squared Mahalanobis distance
and compares it to a threshold value τ .

(12)

l(z) =

(cid:40)

1,
0,

if δCD(z) ≥ τ
if δCD(z) < τ .

(13)

If the result is below the threshold, the new data is considered
to be normal data (label l(z) = 0) but if the result is above the
threshold, the new data is ﬂagged as an anomaly (label l(z) = 1).

In order to select this threshold τ for Mahalanobis distance, we
conduct an experiment to vary τ as a function of standard devia-
tion (σthr) and mean (µthr) of Mahalanobis distance values of all
the normal samples in training dataset as shown in Equation 14. We
use F1-score as the performance metric to choose the value of η of
Equation 14 that results in the highest F1-score for training data to
decide the optimal value of τ .

τ = µthr + η ∗ σthr.
(14)
The µ and Σ−1 statistics can be updated over time with mea-
surement values from normal test samples to make the model more
adaptive and learn the behavior of data over time.

3.2.2
Ensemble CorrDet Algorithm: The sample data zi is
usually a set of hundreds of measurements at time i, which can
be represented as zt = [zt1, zt2, ..., ztd], where d is the number
of measurements and each element ztj denotes the j-th measure-
ment value at time t. In this work, the dissimilarity comes from the
abnormal behaviors of one or several measurements in the power
system.

In other words, an abnormal sample is caused by at least one mea-
surement value that is abnormal. There are a variety of reasons for a
measurement to be abnormal, including an FDI. For instance, Figure
2 shows the normalized real power ﬂow values from bus 5 to bus 3
(zt,340) from time t = 1 to t = 10000. There are 2 measurements
z9161 and z9385 in zt,340 that are far different than the rest, which
can be detected as abnormal measurements. Therefore, the samples
z9161 and z9385, containing the abnormal measurement z9161,340
and z9385,340, are detected as abnormal samples.

Since buses are connected via transmission lines, spatially neigh-
boring buses are more highly correlated and easily affected once
being attacked while buses that are farther away have less correla-
tion. Thus, learning a full covariance over all measurements of all
buses is unnecessary (nearly sparse covariance) when training data
is limited. Instead, it is proposed to use local regions with fewer
measurements. These regions have smaller dimension and offer a
more accurate normal statistic estimation while being computation-
ally cheaper and provide more sensitive anomaly detection. Based on
the CorrDet algorithm, a spatial-temporal, regional CorrDet anomaly
detection method is proposed, named Ensemble CorrDet (ECD).

Ensemble CorrDet detector is deﬁned as a set of Local CorrDet
detectors on data samples with a few, spatial neighboring measure-
ments, compared to full measurements in the CorrDet detector. To
be more speciﬁc, let ΦE be the Ensemble CorrDet detector, ΦR the
CorrDet detector with full dimensionality and φm the Local Cor-
rDet detector with reduced dimensionality where m = 1 : M and
M is the number of buses. So ΦE = {φm}m=1:M . Assume that
the total number of measurements is d. There are mj , mj < d, mea-
surements on each bus m, where each bus is considered as a local,
spatial region, corresponding to one Local CorrDet detector, φm.

For ΦR, the learning process consists of estimating µ and Σ−1
from normal training samples zi (zi ∈ R1×d). A similar strategy is

Fig. 2: Normalized real power ﬂow values from bus 5 to bus 3 for
all samples t = 1 to t = 10000

proposed to learn the Ensemble CorrDet detector. The learning of
ΦE involves the estimation of a set of Local CorrDet detectors, φm.
For each φm, similarly, the learning process consists of estimating its
µm and Σ−1
m from the normal training samples with selected mea-
surements zi,m (zi,m is a 1 × mj vector). The threshold value τm
for each φm is estimated using the same strategy of CorrDet detector
as shown in Eq.14. For the new incoming samples, a set of squared
Mahalanobis distances, ΦE, are computed and compared with the
corresponding set of thresholds, T , where T = {τm}m=1:M . If at
least one squared Mahalanobis distance in ΦE is greater than its
corresponding threshold, this incoming sample is classiﬁed as an
anomaly. Otherwise, it is classiﬁed as normal samples. This voting
process is visualized in Figure 3.

Fig. 3: Voting strategy for Ensemble CorrDet detector

Let K1 and K2 the number of training and testing samples,
respectively. Let Z (Z ∈ Rd×K1 ) and (cid:101)Z ((cid:101)Z ∈ Rd×K2 ) the train-
ing and testing samples, respectively. Let Y (Y ∈ R1×K1 ) and
(cid:101)Y ( (cid:101)Y ∈ R1×K2 ) the corresponding labels. δZ,m (δZ,m ∈ R1×K1 )
denotes the squared Mahalanobis distances of all training samples
(cid:101)zk ∈ R1×M )
with respect to mth CorrDet detector, φm. δ
denotes the squared Mahalanobis distances of kth testing sample
with respect to all CorrDet detectors, ΦE. The pseudo code for the
proposed Ensemble CorrDet algorithm is shown in the following.

(cid:101)zk (δ

IET Research Journals, pp. 1–9
c(cid:13) The Institution of Engineering and Technology 2015

5

Local CorrDetLocal CorrDet...All normal decisions?Normal AbnormalTRUEFALSEProcedure 1 Ensemble CorrDet algorithm

1: Train an Ensemble CorrDet detector:
Input: Z, Y, (cid:101)Z
2: for Every Local CorrDet detector m = 1 : M do
3:

Compute the mean and covariance of normal statistics: µm

and Σ−1
m

using Eq. 12

4:

Compute the squared Mahalanobis distance: compute δZ,m

Compute the threshold: τm

5:
6: end for
7: Test using the Ensemble CorrDet detector:
8: for Every test sample k = 1 : K2 do
9:

Compute the squared Mahalanobis distance: compute δ

(cid:101)zk < τm then

Classify (cid:101)zk as normal sample: (cid:101)yk = 0

Classify (cid:101)zk as abnormal sample: (cid:101)yk = 1

using Eq. 12
if ∀m, δ

else

10:
11:
12:
13:
14:
15: end for
Output: (cid:101)Y

end if

(cid:101)zk

Fusion of Physics Model-Based Data Driven Detection

3.3
Methods

In order to employ the anomaly detection capabilities of both state
estimator solution and the Ensemble CorrDet algorithm, we fuse the
results from both the methodologies as shown in Figure 1. In the
Ensemble CorrDet algorithm, each sample in the testing set will have
M CorrDet distances, one for each region as its decision score. We
need an overall ECD decision score for each sample to combine it
with the decision score from state estimator (ΨSE,(cid:101)zk ). SE decision
score is calculated as shown in equation (15).

ΨSE =

d
(cid:88)

i=1

(cid:20) CM Ei
σi

(cid:21)2

.

(15)

To ﬁnd the overall ECD decision score (ΨECD,(cid:101)zk ) for each
testing sample, we consider the squared Mahalanobis distance of
Local CorrDet detector which led us to decide whether that sam-
ple is anomalous or normal. This is achieved by considering the
decision score of the region whose Local CorrDet detector detected
an anomaly. In case that there are multiple Local CorrDet detectors
that detect an anomalous sample, the maximum decision score is
selected from these multiple Local CorrDet detectors. If there was
no anomaly detected from any local CorrDet detectors, the minimum
of all decision scores from local CorrDet detectors is considered as
the ECD decision score.

We normalize the decision scores obtained from state estimator
and Ensemble CorrDet detector by subtracting by their correspond-
ing mean value and dividing by their corresponding standard devia-
tion to form ΨECDnormalized and ΨSEnormalized . For each testing
sample, we add the normalized decision scores from the state esti-
mator and Ensemble CorrDet detector, and create a new decision
score termed as Fusion decision score (Ψf usion,(cid:101)zk ). Fusion deci-
sion scores, which are calculated as shown in equation (16), are
compared with ground truth values to show the improvement in
fused model performance compared to individual detectors.

Ψf usion = ΨECDnormalized + ΨSEnormalized .
In order to decide whether an incoming test sample is anoma-
lous or normal, we deﬁne a threshold (τf usion) based on the fusion
decision scores of training set using equation (14). We compare the
fusion decision score of test sample (Ψf usion,(cid:101)zk ) with (τf usion) as
shown in equation (17) to predict whether it is anomalous or normal.

(16)

(cid:101)zk =

(cid:40)

anomalous, Ψf usion,(cid:101)zk ≥ τf usion
Ψf usion,(cid:101)zk < τf usion.
normal,

(17)

4

Case Study

4.1 Dataset description

For this work, the IEEE 118 bus system [33] illustrated in Figure
4 was used to generate the training and testing data. Errors are
introduced at random in 5% of the dataset samples and true labels
are assigned during this process. Error detection based on physics-
based models is performed as a post-processing step to PSSE using
CMECST. The dataset consists of 10000 samples with 712 mea-
surements, of which 21 measurements are zero injection measure-
ments. Zero injection measurements are not modeled as equality
constraints in the PSSE process. The standard deviation of zero-
injection measurements is calculated as shown in (4) and (5) to avoid
any gain matrix singularity issues in PSSE process. The types of
measurements considered were a combination of standard SCADA
measurements, i.e. bus voltage magnitudes, real and reactive power
injections, and real and reactive power ﬂows. The measurement set
data was generated using the power ﬂow options in the MATPOWER
package in MATLAB [34]. PSSE uses all 712 measurements while
the Ensemble CorrDet detector will only use 691 measurements,
excluding the zero injection measurements. A drifting load proﬁle
was considered for the generation of the measurement set. The drift
was modeled by the Ornstein-Uhlenbeck (O-U) process - a mean-
reverting process [35, 36]. This is a stochastic process similar to a
random walk, but has a tendency to drift back towards the original
load. The mean loading condition is updated periodically to model
physical reality as aptly as possible. This presents a greater challenge
to the data driven solution since there will be greater variations from
the mean vector. A detailed discussion of O-U process is included in
the subsequent section.

4.1.1 Ornstein-Uhlenbeck (O-U) Process: The O-U process
Xt is deﬁned by the following stochastic differential equation
(SDE):

dXt = −β(Xt − µo−u)dt + σndWt

(18)

where Xt is a random variable, Wt is the driving noise, β is the
decay-rate, σ2

n variance of noise, and µo−u is the long term mean.

(18) can be solved using Ito’s formula and the solution is given by

(19). It can be seen from (19) that limt→∞ Xt = µo−u.

Xt = e−βtX0 + µo−u

(cid:16)

1 − e−βt(cid:17)

+ σn

(cid:90)

t

0

eβ(t0−t)dWt0

(19)

4.2

Experimental Results

The anomaly detection problem can be treated as a classiﬁcation
problem, as our goal is to classify testing samples into normal and
anomalous classes based on the models trained on training samples.
To evaluate the performance of strategies included in this paper, we
make use of classiﬁcation metrics [37] such as Receiver Operating
Characteristics (ROC) curves and Area Under Curve (AUC) score,
which are deﬁned based on True Positive Rate (TPR) and False
Positive Rate (FPR) of a classiﬁcation model. ROC curves repre-
sent classiﬁcation performance of a classiﬁer by varying thresholds
and calculating TPR and FPR values for each threshold for decision
scores. In our analysis, we plot ROC curves using Ψf usion values
and ground truth values.

In our dataset, we used 30% of samples for training and 70% of
the samples for testing the model’s anomaly detection abilities. In
order to reduce the bias of our models, we repeated model training
and testing for different combinations of samples in the data for 10
times. For each combination, we obtained a ROC curve for testing
samples to understand the model performance. In Figure 5, we show
the ROC curves for multiple experiments conducted along with a
mean ROC curve (averaged over FPR) and variation of mean AUC
score (averaged over FPR) for each of the methodologies proposed
in this paper.

6

IET Research Journals, pp. 1–9
c(cid:13) The Institution of Engineering and Technology 2015

Fig. 4: IEEE-118 Bus System

We can also notice that Ensemble CorrDet detector performs
much better compared to state estimator solution and CorrDet detec-
tor as shown in Figure 6. One reason is due to the fact that using
all the measurements in CorrDet detector incurs numerical issues
but when we look at Ensemble CorrDet detector, we are reduc-
ing the measurements for individual detectors, thereby reducing the
numerical issues which improves the anomaly detection capabilities.
For an anomaly detection problem, FPR should be fairly low or
the model ends up wrongly classifying many normal samples as
anomalous. Hence, we also show the performance of the presented
anomaly detection methodologies speciﬁcally for FPR values less
than 0.2 through corresponding mean ROC curves and variation of
mean AUC scores for multiple experiments in Figure 6. The optimal
threshold (τf usion) for fusion decision scores (Ψf usion) also lies
in this region as to maximize F1-score, FPR value has to be fairly
low.

In Figure 6, instead of absolute AUC score, we show the rela-
tive AUC score which is the ratio of AUC score by 0.2 (area in
the curve for FPR values between 0 and 0.2). The presented hybrid
data-driven physics model-based anomaly detection methodology
improved mean AUC score by 6.75% compared to state estimator
results for FPR values than 0.2.

From Figures 5 and 6, we can observe that the performance
improvement from the presented hybrid data-driven physics model-
based anomaly detection methodology compared to state estimator
prediction is larger in the ROC space where FPR is less than 0.2
compared to overall ROC space, which is a favorable outcome.

Fig. 5: ROC curve comparison

In Figure 5, we can notice that mean AUC score for Ensemble
CorrDet detector (0.95) is better than mean AUC score for state esti-
mator (0.94), but the mean AUC score for fusion results (0.97) is
much better than both Ensemble CorrDet algorithm and state estima-
tor method anomaly detection methodologies. The proposed hybrid
data-driven physics model-based anomaly detection methodology
improved mean AUC score by 3.2% compared to state estimator
results.

IET Research Journals, pp. 1–9
c(cid:13) The Institution of Engineering and Technology 2015

7

6 Kosut, O., Jia, L., Thomas, R.J., Tong, L. ‘Malicious data attacks on smart grid
In: 2010 First IEEE

state estimation: Attack strategies and countermeasures’.
International Conference on Smart Grid Communications. (, 2010. pp. 220–225
7 Bobba, R.B., Rogers, K.M., Wang, Q., Khurana, H., Nahrstedt, K., Overbye, T.J.
‘Detecting false data injection attacks on dc state estimation’. In: Preprints of the
First Workshop on Secure Control Systems, CPSWEEK. vol. 2010. (, 2010.
8 Bretas, A.S., Bretas, N.G., Carvalho, B., Baeyens, E., Khargonekar, P.P.:
‘Smart grids cyber-physical security as a malicious data attack: An inno-
vation approach’, Electric Power Systems Research, 2017, 149, pp. 210 –
Available from: http://www.sciencedirect.com/science/
219.
article/pii/S0378779617301657

9 Ho, K.C., Gader, P.D.

‘Correlation-based land mine detection using gpr’.

In:
Detection and Remediation Technologies for Mines and Minelike Targets V. vol.
4038. (International Society for Optics and Photonics, 2000. pp. 1088–1096
10 Chang, C.I., Chiang, S.S.: ‘Anomaly detection and classiﬁcation for hyperspec-
tral imagery’, IEEE transactions on geoscience and remote sensing, 2002, 40, (6),
pp. 1314–1325

11 He, Y., Mendis, G.J., Wei, J.: ‘Real-time detection of false data injection attacks in
smart grid: A deep learning-based intelligent mechanism’, IEEE Transactions on
Smart Grid, 2017, 8, (5), pp. 2505–2516

12 Ozay, M., Esnaola, I., Yarman Vural, F.T., Kulkarni, S.R., Poor, H.V.: ‘Machine
learning methods for attack detection in the smart grid’, IEEE Transactions on
Neural Networks and Learning Systems, 2016, 27, (8), pp. 1773–1786

13 Wei, L., Gao, D., Luo, C. ‘False data injection attacks detection with deep belief
networks in smart grid’. In: 2018 Chinese Automation Congress (CAC). (, 2018.
pp. 2621–2625
Potluri, S., Diedrich, C., Sangala, G.K.R. ‘Identifying false data injection attacks
in industrial control systems using artiﬁcial neural networks’. In: 2017 22nd IEEE
International Conference on Emerging Technologies and Factory Automation
(ETFA). (, 2017. pp. 1–8

14

15 Wang, Q., Tai, W., Tang, Y., Ni, M.: ‘Review of the false data injection attack
against the cyber-physical power system’, IET Cyber-Physical Systems: Theory
Applications, 2019, 4, (2), pp. 101–107

16 Trevizan, R.D., Ruben, C., Nagaraj, K., Ibukun, L.L., Starke, A.C., Bretas, A.S.,
et al. ‘Data-driven physics-based solution for false data injection diagnosis in smart
grids’. In: 2019 IEEE PES GM. (, 2019.

17 Liu, Y., Reiter, M.K., Ning, P. ‘False data injection attacks against state estimation
In: in Proc. 16th ACM Conference on Computer and

in electric power grids’.
Communications Security. (ACM, 2009.

18 Hug, G., Giampapa, J.A.

‘Vulnerability assessment of ac state estimation with
respect to false data injection cyber-attacks’. In: in IEEE Transactions on Smart
Grid. vol. 3. (, 2012. pp. 1362–1370
Sandberg, H., Teixeira, A., Johansson, K.H.
‘On security indices for state esti-
mators in power networks’. In: in Proc. 1st Workshop Secure Control Systems. (,
2010.

19

20 Esfahani, P.M., Vrakopoulou, M., Margellos, K., Lygeros, J., Andersson, G.
‘Cyber-attack in a two-area power system: Impact identiﬁcation using reachabil-
ity’. In: in Proc. American Control Conference (ACC). (ACC, 2010.

21 Esfahani, P.M., Vrakopoulou, M., Margellos, K., Lygeros, J., Andersson, G. ‘A
robust policy for automatic generation control cyber-attack in two area power
network’. In: in Proc. 2010 49th IEEE Conf. Decision Control (CDC). (CDC, .
pp. 5973–5978

22 Xie, L., Mo, Y., Sinopoli, B. ‘False data injection attacks in electricity markets’. In:
Proc. 1st IEEE Int. Conf. Smart Grid Communications. (SmartGridComm, 2010.
23 Kosut, O., Liyan, J., Thomas, R.J., Lang, T. ‘Malicious data attacks on smart grid
state estimation: Attack strategies and countermeasures’. In: Proc. 1st IEEE Int.
Conf. Smart Grid Commun. (, 2010.

24 Bobba, R.B., Rogers, K.M., Wang, Q., Khurana, H., Nahrstedt, K., Overbye,
In: Proc. 1st

‘Detecting false data injection attacks on dc state estimation’.

T.
Workshop Secure Control Syst. (, 2010.

25 Kim, T.T., Poor, H.V. ‘Strategic protection against data injection attacks on power

grids’. In: IEEE Trans. Smart Grid. vol. 2. (, 2011. pp. 326–333

26 Bretas, N.G., Bretas, A.S.: ‘The extension of the gauss approach for the solution
of an overdetermined set of algebraic non linear equations’, IEEE Transactions on
Circuits and Systems II: Express Briefs, 2018, 65, (9), pp. 1269–1273

27 Teixeira, A., Amin, S., Sandberg, H., Johansson, K.H., Sastry, S.S. ‘Cyber security
In: in Proc. 16th ACM
analysis of state estimators in electric power systems’.
Conference on Computer and Communications Security. (, 2010. pp. 5991–5998
28 Bretas, A.S., Bretas, N.G., Carvalho, B.E.B.: ‘Further contributions to smart
grids cyber-physical security as a malicious data attack: Proof and properties
of the parameter error spreading out to the measurements and a relaxed correc-
tion model’, International Journal of Electrical Power & Energy Systems, 2019,
104, pp. 43 – 51. Available from: http://www.sciencedirect.com/
science/article/pii/S0142061518303946

29 Wang, H., Ruan, J., Zhou, B., Li, C., Wu, Q., Raza, M.Q., et al.: ‘Dynamic data
injection attack detection of cyber-physical power systems with uncertainties’,
IEEE Transactions on Industrial Informatics, 2019, pp. 1–1

30 Xue, D., Jing, X., Liu, H.: ‘Detection of false data injection attacks in smart grid
utilizing elm-based ocon framework’, IEEE Access, 2019, 7, pp. 31762–31773
31 Bretas, N.G., Bretas, A.S.: ‘A two steps procedure in state estimation gross
error detection,
Journal of
Electrical Power & Energy Systems, 2015, 73, pp. 484 – 490. Available
from: http://www.sciencedirect.com/science/article/pii/
S0142061515002495

and correction’,

identiﬁcation,

International

32 Ho, K., Gader, P.D.: ‘A linear prediction land mine detection algorithm for hand
held ground penetrating radar’, IEEE transactions on geoscience and remote
sensing, 2002, 40, (6), pp. 1374–1384

33 Group, I.P.. ‘Index of data illinois institute of technology’. (, 2001.

[Online;
accessed 2019-09-30]. Available from: http://motor.ece.iit.edu/

Fig. 6: ROC curve comparison for a False Positive Rate less than
0.2

5

Conclusion

This paper presents a hybrid physics model-based data-driven frame-
work for the detection of FDI attacks on the SG real-time moni-
toring. The physics model-based solution uses the state of the art
Innovation Concept of bad data detection and the novel, data-driven
Ensemble CorrDet algorithm is introduced to exploit both spatial and
temporal characteristics of the SG. The Ensemble CorrDet algorithm
uses information from distributed, Local CorrDet detectors to make
a decision on whether or not there is an FDI in the system. By doing
this, the data-driven solution not only uses temporal information, but
spatial information as well. Decision level fusion is used to combine
the information that each individual anomaly detection method con-
tains, considering the conﬁdence that each method has for a given
sample.

The hybrid FDI detection framework was tested on the IEEE 118
bus system. Test results show that the fusion of the individual tech-
niques has the best overall performance, detecting FDI attacks at
high rate without many false alarms, which can cause issues in a
similar fashion to an undetected FDI attack. The presented hybrid
framework improved mean Area Under Curve score for testing set
by 6.75% compared to physics model-based results. The fusion
of physics model-based data-driven solutions and of temporal and
spatial information has been shown to be an improvement on the
detection of FDI attacks on the SG, opening up opportunities for
future research in this area.

Acknowledgment

This material is based upon work supported by the National Science
Foundation under Grant Number 1809739.

6

1

References

Farag, M., Azab, M., Mokhtar, B. ‘Cross-layer security framework for smart grid:
Physical security layer’. In: IEEE PES Innovative Smart Grid Technologies Europe
(ISGT Europe). (IEEE, 2014. pp. 1–7

2 Monticelli, A.: ‘State estimation in electric power systems: a generalized

approach’. vol. 507. (Springer Science & Business Media, 1999)

3 Handschin, E., Schweppe, F.C., Kohlas, J., Fiechter, A.: ‘Bad data analysis for
power system state estimation’, IEEE Transactions on Power Apparatus and
Systems, 1975, 94, (2), pp. 329–337

4 Bretas, N.G., Bretas, A.S., Piereti, S.A.: ‘Innovation concept for measurement
gross error detection and identiﬁcation in power system state estimation’, IET
Generation, Transmission Distribution, 2011, 5, (6), pp. 603–608

5 Liu, Y., Ning, P., Reiter, M.K. ‘False data injection attacks against state estimation
in electric power grids’. In: Proceedings of the 16th ACM Conference on Com-
puter and Communications Security. CCS ’09. (New York, NY, USA: ACM, 2009.
pp. 21–32. Available from: http://doi.acm.org/10.1145/1653662.
1653666

8

IET Research Journals, pp. 1–9
c(cid:13) The Institution of Engineering and Technology 2015

data/

34 Zimmerman, R.D., Murillo.Sanchez, C.E., Thomas, R.J.: ‘Matpower: Steady-state
operations, planning, and analysis tools for power systems research and education’,
IEEE Trans Power Syst, 2011, 26, (1), pp. 12–19

35 Bibbona, E., Panﬁlo, G., Tavella, P.: ‘The ornstein–uhlenbeck process as a model

of a low pass ﬁltered white noise’, Metrologia, 2008, 45, pp. S117

36 Thierfelder, C.: ‘The trending ornstein–uhlenbeck process and its applications in

mathematical ﬁnance’, Mathematical Finance, 2015,

37 Bradley, A.P.: ‘The use of the area under the roc curve in the evaluation of machine
learning algorithms’, Pattern Recogn, 1997, 30, (7), pp. 1145–1159. Available
from: http://dx.doi.org/10.1016/S0031-3203(96)00142-2

IET Research Journals, pp. 1–9
c(cid:13) The Institution of Engineering and Technology 2015

9

