A deep learning based known-plaintext attack method for chaotic cryptosystem

Fusen Wanga,b, Jun Sanga,b,∗, Qi Liua,b, Chunlin Huanga,b, Jinghan Tana,b

a Key Laboratory of Dependable Service Computing in Cyber Physical Society of Ministry of Education, Chongqing University, Chongqing
400044, China
bSchool of Big Data & Software Engineering, Chongqing University, Chongqing 401331, China

1
2
0
2

r
a

M
9

]

R
C
.
s
c
[

1
v
2
4
2
5
0
.
3
0
1
2
:
v
i
X
r
a

Abstract

In this paper, we propose a known-plaintext attack (KPA) method based on deep learning for traditional chaotic encryp-
tion scheme. We employ the convolutional neural network to learn the operation mechanism of chaotic cryptosystem,
and accept the trained network as the ﬁnal decryption system. To evaluate the attack performance of diﬀerent networks
against diﬀerent chaotic cryptosystem, we adopt two neural networks to perform known-plaintext attacks on two dis-
tinct chaotic encryption schemes. The experimental results demonstrate the potential of deep learning-based method
for known-plaintext attack against chaotic cryptosystem. Diﬀerent from the previous known-plaintext attack methods,
which were usually limited to speciﬁc chaotic cryptosystems, a neural network can be applied to the cryptanalysis of
various chaotic cryptosystems with deep learning-based approach, while several diﬀerent networks can be designed for the
cryptanalysis of chaotic cryptosystems. This paper provides a new idea for the cryptanalysis of chaotic image encryption
algorithm.

Keywords: Chaotic image encryption, Cryptanalysis, Known-plaintext attack, Deep learning, Convolution Neural
Network

1. Introduction

Many chaotic image encryption algorithms have been
proposed during the past years, and their security require-
ments have achieved good improvement [1, 2, 3, 4, 5, 6].
While the chaotic cryptosystem is developing rapidly, its
security has also attracted widespread attention. Many
attack schemes against certain speciﬁc chaotic encryption
algorithm have been proposed in succession, e.g., Dou et
al.
[7] proposed an eﬀective attack scheme against the
one-dimensional combined chaotic color image encryption
algorithm [8] in the case of unknown parameters. Li et
al. [9] proposed a chosen-plaintext attack strategy against
one-dimensional bit-level chaotic color image encryption
algorithm [10] and proved the eﬀectiveness and feasibility
of the method. However, the disadvantage of these meth-
ods is that they are limited to solving particular chaotic
encryption schemes, and cannot attack other encryption
algorithms.

In recent years, deep learning also has numerous ap-
plications in the domain of cryptography, especially in im-
age encryption [11, 12]. Besides, Hai et al.
[13] ﬁrst put
forward one method to apply deep learning to the crypt-
analysis of optical encryption scheme. They designed a
deep neural network namely DecNet to train iterative a
large number of “plaintext-ciphertext” pairs generated by
the classical double random phase encoding system even

∗Corresponding author
Email address:

jsang@cqu.edu.cn ( Jun Sang )

the more secure triple random phase encoding system, and
then regarded the trained model as the “equivalent key”
of the cryptographic system, which was used to crack the
subsequent ciphertext.

Based on the shortcomings of traditional chaotic sys-
tem cryptanalysis and the stimulation of [13] method, in
this paper, we propose a known-plaintext attack method
based on deep learning for chaotic cryptosystems. Two
chaotic encryption schemes are adopted to encrypt images
to generate suﬃcient “plaintext-ciphertext” pairs, and two
convolution neural networks are utilized as the decryption
model to train these data. Then ciphertext images are
performed to verify and visualize the decryption eﬀect on
the trained model.

The main contributions of our work are outlined as

follows:

• A known plaintext attack method based on deep
learning for chaotic cryptosystems is proposed for
the ﬁrst time.

• By employing two diﬀerent convolution neural net-
works to train the “plaintext-ciphertext” pairs, which
are generated by two kinds of chaotic encryption
schemes, excellent ciphertext reconstruction results
can be obtained.

• We get the conclusion, diﬀerent from the traditional
known-plaintext attack methods for chaotic cryp-
tosystems, one neural network can be employed to
decrypt diﬀerent chaotic cryptosystems, and one chaotic

Preprint submitted to Elsevier

March 10, 2021

 
 
 
 
 
 
2.2. MSEDNet

In this paper, we propose an encoder-decoder network
for decryption, named Multi-Stage Encoder Decoder Net-
work. The ﬁrst ﬁve layers of the left column of the network
are encoding layers, and each layer is composed of con-
volution (Conv) with ﬁlter size 3x3, batch normalization
(BN), rectiﬁed linear unit (ReLU), and average pooling
layer with stride 2x2. Through feature extraction, higher-
precision pixel-by-pixel estimation can be achieved while
maintaining the per-pixel position information on the fea-
ture map.

In the decoding stage, we integrate the feature map
of multiple encoding stages to fully fuse the multi-scale
context information and conduct pixel-by-pixel regression
considering that simple interpolation operation cannot re-
store the information lost in the previous pooling layer,
even if skip connections are employed. The network struc-
ture is presented in Fig. 2.

cryptosystem can take multiple neural networks as
decrypters for comparing their ciphertext reconstruc-
tion eﬀects.

2. CNN for known-plaintext attack on chaotic cryp-

tosystems

The decryption work of ciphertext images is quite sim-
ilar to some classic tasks in deep learning, such as im-
age denoising [14], image defogging [15] and image super-
resolution reconstruction [16], in which their purposes are
always to recover some fuzzy or even invisible images to the
same resolution as the original image as much as possible.
Therefore, we adopt two encoder-decoder neural networks
based on end-to-end structure as experimental models, in-
cluding the medical segmentation network Unet [17] that is
the earliest used for image denoising tasks, and the Multi-
Stage Encoder-Decoder Network (MSEDNet) proposed by
us. The speciﬁc introduction is as follows.

2.1. Unet

As a classic encoder-decoder network in the ﬁeld of
medical image processing, Unet [17] is usually conducted
for image segmentation, image compression, image denois-
ing, etc. It can also be used to decrypt encrypted informa-
tion and restore images. A straightforward modiﬁcation is
made to Unet’ output channels since the datasets contain
vast small-size images, and its network structure is shown
in Fig. 1.

Figure 2: The architecture of MSEDNet: The numbers in the ﬁgure
represent the number of channels in each feature map.

3. Chaotic encryption system

To better verify that the known-plaintext attack method
based on deep learning can be applied to the cryptanalysis
of diﬀerent chaotic encryption systems, we introduce two
chaotic encryption schemes as the targets to be attacked:
(1) the classic one dimensional chaotic map (for grayscale
images); (2) the proposed hybrid chaotic map, i.e., em-
ploy one dimensional Logistic, Sine, and Chebyshev maps
to encrypt the R, G and B channels of the image separately
(for color images).

3.1. One-dimensional chaotic maps

This part brieﬂy introduces three types of classic one-
dimensional chaotic maps: Logistic map, Sine map, and
Chebyshev map [18]. In view of the space limitation and
the similar nature of the experiment, we only employ Lo-
gistic map as the experimental scheme in one-dimensional
chaotic map.

3.1.1. Logistic map

One-dimensional Logistic map has extremely complex
dynamic behavior, and its mathematical expression for-
mula is as follows:

2

Figure 1: The architecture of modiﬁed Unet: H x W x C represents
respectively the image’ height, width, and channel number with a
value of 1 or 3.

In addition to the last convolution layer with kernel
size 1x1, each convolution consists of three consecutive op-
erations: convolution (Conv) with 3x3 kernel size, batch
normalization (BN), and rectiﬁed linear unit (ReLU). The
down-sampling phase adopts the max-pooling of stride
2x2. The up-sampling layers are concatenated with the
output of the corresponding down-sampling layer and de-
convolved with a 2x2 ﬁlter.

Xn+1 = µ × Xn × (1 − Xn),

(1)

where Xn is the nth chaotic iterative sequence with vec-
tor length n. The initialization parameters X0 ∈ (0, 1),
µ ∈ [0, 4], and when µ ∈ (3.5699456, 4] is especially closer
to 4, the iteration sequence will be in a pseudo-random dis-
tribution state. In experiment, we set X0 = 0.1, µ = 3.601.

3.1.2. Sine map

As one of classical one-dimensional chaotic maps, Sine
map can generate chaotic sequences similar to Logical map.
It can be deﬁned by the following equation:

Xn+1 = σ × sin(π × Xn),

(2)

4. Implementation Details

In this section, we give the experimental details of
known-plaintext attacks on diﬀerent chaotic cryptosystems
by various convolution neural networks. It is assumed that
the attacker has obtained a large number of “plaintext-
ciphertext” pairs without knowing the encryption algo-
rithm since the neural network needs abundant data sam-
ples to learn the map relationship between the input end
and the output end. So, through two encryption schemes,
we produce ﬁrstly suﬃcient “plaintext-ciphertext” pairs on
datasets, which is then transmitted to two neural networks
as training sets. In the end, the ciphertext images of the
testing set are input into the trained decryption model to
verify the reconstruction eﬀect.

where Xn is the output chaotic iterative sequence, the ini-
tial parameter σ ∈ (0, 1]. We set σ = 0.95, X0 = 0.154.

4.1. Datasets

3.1.3. Chebyshev map

Chebyshev map, which is similar to sine map, displays
some speciﬁc chaotic eﬀects. This function is formulated
as below:

Xn+1 = cos(θ × cos−1Xn),
when the parameter θ > 1, the output sequence has chaotic
behavior. In our experiment, we set θ = 5, X0 = 0.165.

(3)

3.2. Hybrid chaotic maps

This section will introduce the above-mentioned one-
dimensional hybrid chaotic map. In [6], one novel image
encryption scheme was proposed to combine two diﬀerent
chaotic maps and derive a new encryption formula, which
was used to encrypt the image and reduce the correlation
between the three channels of image R, G and B. Based
on this idea, three diﬀerent one-dimensional chaotic maps
are adopted in this paper to perform chaotic processing
on R, G and B channels of the color image. Compared
with using only one-dimensional Logistic map to generate
a sequence of length W x H x C (W, H, C denotes width,
height, channels of the image), the hybrid chaotic map is
more secure and can further reﬂect the ability of convolu-
tion neural network to learn the encryption mechanism of
chaotic systems. In Section 5, we observe that the hybrid
chaotic map is better than the one-dimensional Logistic
map in terms of the chaotic eﬀect through the evaluation
metrics in Fig. 3 and Fig. 5. The mathematical formula
is as follows:

Yi = Y (:, :, i)i = 1, 2, 3,
Y1,n+1 = µ × Y1,n × (1 − Y1,n),
Y2,n+1 = σ × sin(π × Y2,n),
Y3,n+1 = cos(θ × cos−1Y3,n),
where Eq.(4) indicates that the color image Y is divided
into three single-channel images Yi along channel; in Eq.(5),
Eq.(6), Eq.(7), Yi,n+1 represents the chaotic processing of
the R, G, and B channels of the color image Y with Lo-
gistic map, Sine map, and Chebyshev map respectively.

(4)
(5)
(6)
(7)

3

In this paper, we generate the “plaintext-ciphertext”
pairs required for the experiment on MNIST [19] and CIFAR-
10 [20]. Since MNIST are all single-channel images, we
employ an one-dimensional Logistic map to encrypt the
datasets, while utilize hybrid chaotic map to encrypt the
three-channel images of cifar-10. These “plaintext-ciphertext”
pairs are randomly divided, 90% of which are used as train-
ing sets of neural networks, while the rest are employed as
testing sets to detect the decryption ability of model.

4.2. Loss Function

To minimize the information loss between the decrypted
images and the plaintext images, the absolute value loss
function (L1loss) is used to supervise the training of all the
networks in this paper. The equation is deﬁned as follows:

Loss1 =

1
N

(cid:88)N

i=1

O(Xi; θ) − P (Xi),

(8)

where N is the number of the training images batch, O(Xi; θ)
is the decrypted image output by the network with param-
eters θ, P (Xi) is the supervision label (plaintext) of the
ciphertext Xi.

4.3. Training details

All experiments are implemented in the environment of
CPU-Python3.5-Pytorch1.0, employing Adam optimizer
with L2 regularization weight decay rate of 1e-4. The ini-
tial learning rate is 1e-5 and it drops by 10% every 20
epochs when training with a batch size of 8. In addition,
a dropout layer with ratio of 0.5 is added to the partial
convolution layer to prevent the network from over-ﬁtting.

5. Experiments

5.1. Evaluation metrics

In the experiment, Pearson correlation coeﬃcient [21]
was taken as the evaluation metrics for two aspects: (1) to
estimate the correlation between plaintext images and ci-
phertext images in diﬀerent chaotic encryption systems in

Section3; (2) to evaluate the correlation between the out-
put (decryption image) and the label (plaintext image) of
the known-plaintext attack method based on deep learn-
ing. It can be deﬁned by the following equation:

E(X) =
(cid:114)

(cid:88)W

1
W × H
(cid:88)H

(cid:88)W

(cid:88)H

X(i, j),

i=1

j=1
[X(i, j) − E(X(i, j))]2,

(9)

(10)

(cid:80)W

i=1

(cid:80)H

j=1

i=1

j=1 (O − E(O))(P − E(P ))

,

(11)

σ(X) =

Corr =

σ(O)σ(P )

where W , H represent the width and height of the im-
ages respectively, O(i, j) is the output of the network (de-
crypted image), P (i, j) is the label of the network (plain-
text image). This Eq.(11) is applicable to two encryption
schemes and is regarded as training/testing accuracy.

5.2. Experiment results of Logistic map on MNIST

Table. 1 shows the experimental results of two convo-
lution neural networks to crack the Logistic map on the
MNIST dataset, including training Loss, training average
accuracy, testing average accuracy, epoch and the running
time of each epoch.

Fig. 3 gives the visualization results of one-dimensional
Logistic map on the MNIST dataset, where the ﬁrst col-
umn shows the plaintext image; the second column dis-
plays the corresponding ciphertext image; the third-fourth
columns list the decrypted images of MSEDNet, and Unet
severally. At the same time, the correlation coeﬃcients of
the ciphertext image and the plaintext image, as well as
the decrypted images and the plaintext image are given
separately. From the results we can observe that the test-
ing ciphertext images can be well reconstructed by the neu-
ral network, and the correlation with the plaintext grad-
ually tends to 1. However, the reconstruction eﬀect of
diverse networks is diﬀerent, among which the decryption
eﬀect is Unet ¿ MSEDNet.

(a)

(b)

Figure 4: The change curve of MNIST training process: (a) Training
L1Loss, (b) Testing Correlation Coeﬃcient. The green and red line
represent MSEDNet and Unet architecture separately.

time and accuracy. The training eﬃciency and accuracy
of Unet [17] are better than the MSEDNet.

5.3. Experiment results of Hybrid chaotic map on Cifar

Table. 2 presents the experimental results of diﬀerent
convolution neural networks cracking the hybrid chaotic
map (Cifar-10), similar to Table. 1.

Figure 3: Visualization of three random images on MNIST testing
set, including Plaintext, Ciphertext, Decrypted image of MSEDNet,
Unet, Correlation coeﬃcient with plaintext.

The curve changes of training Loss and testing evalu-
ation metrics of two networks on the MNIST dataset are
plotted in Fig. 4 (a) and Fig. 4 (b). We reach the conclu-
sion from the ﬁgure that the selections of neural network
for the same encryption scheme greatly aﬀect the training

Figure 5: Visualization of three random images on Cifar-10 testing
set, including Plaintext, Ciphertext, Decrypted image of MSEDNet,
Unet, Correlation coeﬃcient with plaintext.

Fig. 5 shows the visualization results of the hybrid
chaotic map on the Cifar-10 dataset, which is greatly sim-
ilar to MNIST, i.e., after more epochs training, the cipher-
text image in testing set can be reconstructed pretty well,

4

Table 1: The experimental result of deep learning method for attacking Logistic map.

¨Encryption Scheme Network

Training accuracy Testing accuracy Epoch Time/Epoch

Logistic Map

MSEDNet
Unet

98.32%
99.61%

97.80%
99.15%

200

80s
85s

Table 2: The experimental result of deep learning method for attacking Hybrid Chaotic map.

¨Encryption Scheme

Network

Training accuracy Testing accuracy Epoch Time/Epoch

Hybrid Chaotic Map

MSEDNet
Unet

95.86%
97.82%

93.62%
95.70%

800

82s
89s

but the two reconstruction eﬀects have slight diﬀerences,
among which the decryption eﬀect is Unet ¿ MSEDNet.
Fig. 6 displays the curve changes of training Loss and
testing evaluation metrics of two networks on the Cifar-10
dataset. Similar to Fig. 4, it can be observed that the
training eﬃciency and accuracy of Unet are signiﬁcantly
higher than MSEDNet.

5.4. Experimental analysis

This paper aims to investigate the cryptanalysis of per-
forming known-plaintext attacks with multiple convolu-
tion neural networks against diﬀerent chaotic encryption
systems. The following conclusions can be drawn from
the above experimental data in the ﬁgure and table: (1)
For the same encryption scheme, diﬀerent neural networks
can be used as the decryption model. However, the rea-
son for diﬀerent ciphertext reconstruction eﬀects may be
related to the number of participants and learning abil-
ity of the neural network, which will be one of our next
research works. (2) The same convolution neural network
can be used to attack diﬀerent encryption systems, but the
ciphertext reconstruction eﬀect is also diverse, which may
be related to the complexity of the encryption mechanism.
This will be our other future research works.

Compared with traditional known-plaintext attack meth-

ods speciﬁc to a certain chaotic cryptosystem, our scheme
deep learning-based is more ﬂexible and extensible. More-
over, this method can be transferred to other chaotic cryp-
tosystems, even to the ﬁeld of non-chaotic encryption.

6. Conclusion

In this paper, a known-plaintext attack scheme of chaotic

system based on deep learning is proposed, which uses
convolution neural networks to train a large number of
“plaintext-ciphertext” pairs to learn the conversion pro-
cess between plaintext and ciphertext. The trained model
is regarded as the “decryption formula”. By training dif-
ferent encryption systems with various convolutional neu-
ral networks, we obtain excellent decryption results. Over-
all, the diversity of ciphertext reconstruction eﬀects may
be related to the complexity of the encryption system, the

5

(a)

(b)
Figure 6: The change curve of MNIST training process: (a) Training
L1Loss, (b) Testing Correlation Coeﬃcient. The green and red line
represent MSEDNet and Unet architecture separately.

number of parameters and learning capabilities of the neu-
ral network, the training time. This will be worthy of our
further study. In practice, the advantages of this method
are as follows: (1) It can completely avoid the recording
and transmission of complex ciphertexts; (2) The chaotic
cryptanalysis method based on deep learning can be in-
troduced to other chaotic cryptographic systems even to
the ﬁeld of non-chaotic cryptography; (3) In addition, it
also proposes a new research direction in the ﬁeld of mul-
timedia security, i.e., how to prevent cryptography attack
means based on deep learning.

[18] Y. Yu, S. Gao, S. Cheng, Y. Wang, S. Song, F. Yuan, Cbso:
a memetic brain storm optimization with chaotic local search,
Memet. Comput 10 (4) (2018) 353–367.

[19] L. Deng, The mnist database of handwritten digit images for
machine learning research [best of the web], IEEE Signal Pro-
cess. Mag 29 (6) (2012) 141–142.

[20] A. Krizhevsky, G. Hinton, Learning multiple layers of features
from tiny images, Handbook of Systemic Autoimmune Diseases
1 (4).

[21] B. Mondal, T. Mandal, A nobel chaos based secure image en-
cryption algorithm, International Journal of Applied Engineer-
ing Research 11 (5) (2016) 3120–3127.

7. References

References

[1] K. Gupta, R. Gupta, R. Agrawal, S. Khan, An ethical approach
of block based image encryption using chaotic map, Interna-
tional Journal of Security and Its Applications 9 (9) (2015)
105–122.

[2] Y. H. Ail, Z. A. Alobaidy, Images encryption using chaos and
random generation, Engineering and Technology Journal 34 (1
Part (B) Scientiﬁc) (2016) 172–179.

[3] G. Alvarez, S. Li, Some basic cryptographic requirements for
chaos-based cryptosystems, Int. J. Bifurcation Chaos 16 (08)
(2006) 2129–2151.

[4] H. N. Abdullah, H. A. Abdullah, Image encryption using hybrid

chaotic map, in: ICCIT, 2017.

[5] Y. Song, J. Song, J. Qu, A secure image encryption algorithm
based on multiple one-dimensional chaotic systems, in: ICCC,
2016.

[6] N. Elabady, H. Abdalkader, M. Moussa, S. F. Sabbeh, Image en-
cryption based on new one-dimensional chaotic map, in: ICET,
2014.

[7] Y. Dou, M. Li, Cryptanalysis of a new color image encryp-
tion using combination of the 1d chaotic map, Applied Sciences
10 (6) (2020) 2187.

[8] C. Pak, L. Huang, A new color image encryption using combina-
tion of the 1d chaotic map, Signal Process 138 (2017) 129–137.
[9] M. Li, P. Wang, Y. Liu, H. Fan, Cryptanalysis of a novel bit-
level color image encryption using improved 1d chaotic map,
IEEE Access 7 (2019) 145798–145806.

[10] C. Pak, K. An, P. Jang, J. Kim, S. Kim, A novel bit-level color
image encryption using improved 1d chaotic map, Multimed.
Tools Appl 78 (9) (2019) 12027–12042.

[11] X. Li, Y. Jiang, M. Chen, F. Li, Research on iris image encryp-
tion based on deep learning, EURASIP J. Image Video Process
2018 (1) (2018) 1–10.

[12] Y. Qin, C. Zhang, R. Liang, M. Chen, Research on face image
encryption based on deep learning, in: IOP Conference Series:
Earth and Environmental Science, 2019.

[13] H. Hai, S. Pan, M. Liao, D. Lu, W. He, X. Peng, Cryptanalysis
of random-phase-encoding-based optical cryptosystem via deep
learning, Opt. Express 27 (15) (2019) 21204–21213.

[14] L. Gondara, Medical image denoising using convolutional de-

noising autoencoders, in: ICDMW, 2016.

[15] C. Li, T. Fan, X. Ma, Z. Zhang, H. Wu, L. Chen, An im-
proved image defogging method based on dark channel prior,
in: ICIVC, 2017.

[16] C. Dong, C. C. Loy, K. He, X. Tang, Image super-resolution
using deep convolutional networks, IEEE Trans. Pattern Anal.
Mach. Intell 38 (2) (2015) 295–307.

[17] O. Ronneberger, P. Fischer, T. Brox, U-net: Convolutional
networks for biomedical image segmentation, in: International
Conference on Medical image computing and computer-assisted
intervention, 2015.

6

