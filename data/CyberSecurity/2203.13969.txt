Preventing Outages under Coordinated
Cyber-Physical Attack with Secured PMUs

Yudi Huang, Student Member, IEEE, Ting He, Senior Member, IEEE, Nilanjan Ray Chaudhuri,

Senior Member, IEEE, and Thomas La Porta Fellow, IEEE

1

2
2
0
2

r
a

M
6
2

]
F
P
.
s
c
[

1
v
9
6
9
3
1
.
3
0
2
2
:
v
i
X
r
a

Abstractâ€”Due to the potentially severe consequences of coordi-
nated cyber-physical attacks (CCPA), the design of defenses has
gained signiï¬cant attention. A popular approach is to eliminate
the existence of attacks by either securing existing sensors
or deploying secured PMUs. In this work, we improve this
approach by lowering the defense target from eliminating attacks
to preventing outages and reducing the required number of PMUs.
To this end, we formulate the problem of PMU Placement for
Outage Prevention (PPOP) under DC power ï¬‚ow model as a
tri-level non-linear optimization problem and transform it into
a bi-level mixed-integer linear programming (MILP) problem.
Then, we propose an alternating optimization framework to solve
PPOP by iteratively adding constraints, for which we develop
two constraint generation algorithms. In addition, for large-scale
grids, we propose a polynomial-time heuristic algorithm to obtain
suboptimal solutions. Next, we extend our solution to achieve the
defense goal under AC power ï¬‚ow model. Finally, we evaluate our
algorithm on IEEE 30-bus, 57-bus, 118-bus, and 300-bus systems,
which demonstrates the potential of the proposed approach in
greatly reducing the required number of PMUs.

I. INTRODUCTION
Coordinated cyber-physical attacks (CCPA) [2] have gained
a great deal of attention due to the stealthiness of such attacks
and the potential for severe damage on to the smart grid. The
power of CCPA is that its physical component damages the grid
while its cyber component masks such damage from the control
center (CC) to prolong outages and potentially enable cascades.
For instance, in the Ukrainian power grid attack [3], attackers
remotely switched off substations (damaging the physical
system) while disrupting the control through telephonic ï¬‚oods
and KillDisk server wiping (damaging the cyber system).

Defenses against CCPA can be broadly categorized into
detection and prevention. Attack detection mechanisms aim
at detecting attacks that are otherwise undetectable using
traditional bad data detection (BDD) by exploiting knowledge
unknown to the attacker [4]. However, the knowledge gap
between the attacker and the defender may disappear due to
more advanced attacks, and relying on detection alone risks
severe consequences in case of misses. Therefore, in this work,
we focus on preventing attacks using secured sensors.

We consider a powerful attacker with full knowledge of
the pre-attack state of the grid and the locations of secured
PMUs. The attacker launches an optimized CCPA where the

The authors are with the School of Electrical Engineering and Computer
Science, Pennsylvania State University, University Park, PA 16802, USA
(e-mail: {yxh5389, tzh58, nuc88, tï¬‚12}@psu.edu).

A preliminary version of this work was presented at SmartGridCommâ€™21 [1].
This work was supported by the National Science Foundation under award

ECCS-1836827.

physical attack disconnects a limited number of lines and the
cyber attack falsiï¬es the breaker status and the measurements
from unsecured sensors to mask the physical attack while
misleading security constrained economic dispatch (SCED)
at the CC. Such attacks can result in severe cascading failures.
For example, under the setting in Section V, CCPA in absence
of secured PMUs can cause initial overload-induced tripping
at 2, 1, and 2 lines in IEEE 30-bus, 57-bus, and 118-bus
systems, respectively. Moreover, the re-distribution of power
ï¬‚ows on the initially tripped lines may cause cascading
outages. Take IEEE 118-bus system as an example. There is
an attack that physically disconnects line 144 and manipulates
the measurements to cause overload-induced tripping at line
109. These initial outages will trigger a cascade that eventually
results in outages at 82 lines. This observation highlights the
importance of defending against such attacks.

While attack prevention traditionally aims at eliminating
undetectable attacks by deploying secured PMUs to achieve
full observability [5], this approach can require a large number
of PMUs. Little is known about how to achieve a good tradeoff
between the efï¬cacy of protection and the cost of PMU place-
ment during the deployment process before full observability is
achieved. In addition, the operators may be only interested in
using secured PMUs to prevent severe consequences, while leav-
ing the defense of less severe attacks to other mechanisms [6].
To ï¬ll this gap, we lower the goal of PMU placement to pre-
venting undetectable attacks from causing outages. Speciï¬cally,
we want to deploy the minimum number of secured PMUs such
that the attacker will not be able to cause overload-induced line
tripping due to overcurrent protection devices. The key novelty
of our approach is that we allow undetectable attacks to exist but
prevent them from causing any outages, hence potentially requir-
ing fewer secured PMUs. For instance, we can prevent overload-
induced tripping using 71% fewer secured PMUs compared to
the requirement of full observability in IEEE 118-bus system.

A. Related Work

Attacks: False data injection (FDI) [7], [8] is widely adopted
to launch cyber attacks in CCPA to bypass the traditional BDD
[2]. A typical form of FDI is load redistribution attack [9],
which together with physical attacks [2], [10], [11] that alter
grid topology, aims to mislead SCED by injecting false data
for economic loss or severe physical consequences such
as sequential outages [11]. Bi-level optimization is widely
adopted for analyzing the impact of CCPA on state deviation
[12] or line ï¬‚ow changes [13]. In this work, we extend them

 
 
 
 
 
 
2

into a stronger attacker that jointly optimizes the location
of physical attacks and the attack target. Besides misleading
SCED, similar physical consequences can also be achieved
by attacking the commands issued by the control center [14],
[15], which is not the focus of this work.

Defenses: Defending against CCPA requires a systematic
mechanism [6], which can be decomposed into three modules:
prevention that postpones the onset of attacks [10], detection
that identiï¬es the attack before it starts affecting the system
[5], [14], [16]â€“[21], and resilience which limits the impact
of the attacks that successfully bypass the detection [18],
[22]â€“[24]. Our focus is on an intermediate stage of PMU
deployment where not enough PMUs are installed to achieve
perfect detection of all FDI attacks.

To eliminate the existence of FDI by detection, different
strategies have been studied, such as directly protecting meters
[16]â€“[20], [25] or deploying secured PMUs [5], [21]. Due to
the connection between observability of the grid and FDI [17],
solutions on achieving full observability through PMUs [26] can
also be leveraged to defend against FDI. Unlike the aforemen-
tioned works, our work only aims to prevent attacks from caus-
ing outages, which can signiï¬cantly reduce the required number
of secured PMUs while maintaining the system resilience.

Tri-level optimization is widely used for modeling interac-
tions among the defender, the attacker and the operator in smart
grid. To name a few, a tri-level model is proposed in [23] to
ï¬nd the optimal set of lines to protect from physical attacks to
minimize load shedding. In [18], [22], [24], the measurements
to protect were chosen by solving a budget-constrained
optimization problem, which was also adopted in [27] for
distribution networks. However, existing works are limited in
the following aspects. From the formulation perspective, their
solution may become sub-optimal if the cost vector in SCED
changes due to the dependence of their methods on the KKT
conditions of linear programming. Such dependence also limits
the extension of their formulation to the AC power ï¬‚ow model.
From the computational perspective, the method in [18] solves
a MIP for each possible physical attack and thus is not scalable
to multi-line physical attacks. The method in [23] introduces
bilinear terms, which leads to a high computational cost. To
overcome such limitations, we will develop a formulation for
CCPA that can (i) model multi-line physical attacks without
bilinear terms, and (ii) be extended to the AC power ï¬‚ow model.
Moreover, the PMU placement obtained from our solution can
prevent overloading-induced line tripping regardless of the cost
vector in SCED. Furthermore, securing PMU measurements
instead of (legacy) measurements for individual nodes/lines has
the advantage that it aligns with the ongoing trend of deploying
PMU-based power grid monitoring systems.

Power ï¬‚ow models: Due to the nonlinear and nonconvex na-
ture of AC power ï¬‚ow equations, it is a common practice [28] to
develop FDI/CCPA or its countermeasure under the DC power
ï¬‚ow model and validate the solutions under the AC power ï¬‚ow
model. Although much efforts [29]â€“[31] have been devoted into
directly formulating FDI under the AC model, most of them
targeted at causing erroneous state estimation, with very limited
results on load redistribution attack aiming at causing outages.
The works [29] formulated FDI under the AC model through

convex relaxation, but did not accurately model the impact of
FDI on SCED. In [25], [28], [32], the design of FDI was based
on the DC model, although the feasibility of the attack was
tested under the AC model. In [30], [31], a formulation based
on convex relaxation was proposed to model load redistribution
attack under the AC model. They adopted DC-based line outage
distribution factors (LODF) to infer the impact of attacks on
SCED, which leads to the use of active power ï¬‚ows as the
criterion to determine overloading. This is inaccurate as the true
criterion should be the magnitude of current. To the best of our
knowledge, it remains an open problem to compute the optimal
load redistribution attack under the AC power ï¬‚ow model. Our
approach is to circumvent this problem by (i) ï¬rst ï¬nding
a PMU placement to prevent load redistribution attack from
causing outages under the DC model, (ii) then developing a
method to test the feasibility of the found PMU placement under
the AC model based on a recently developed approximation
of AC power ï¬‚ow equations [33], and (iii) ï¬nally reï¬ning the
PMU placement to prevent outages under the AC model.

B. Summary of Contributions

We summarize our contributions as follows:

1) Instead of eliminating the existence of FDI, we
investigate the optimal secured PMU Placement for
Outage Prevention (PPOP) problem to defend against
CCPA, where we formulate a strong attacker that jointly
optimizes physical attack locations and target lines. The
proposed approach can potentially require fewer PMUs
than approaches that eliminate FDI.

2) We propose an alternating optimization algorithm
to solve PPOP by generating additional constraints
from each infeasible PMU placement. Speciï¬cally, we
demonstrate how to generate â€œNo-Goodâ€ constraints and
â€œAttack-Denialâ€ constraints to solve PPOP optimally.
3) We develop a heuristic algorithm for PPOP to produce
a possibly suboptimal solution. The complexity of the
proposed heuristic is polynomial in the grid size, which
makes it scalable to large networks.

4) We develop an algorithm to test whether a given PMU
placement can achieve our defense goal under the AC
power ï¬‚ow model. In addition, we propose a heuristic
to augment the given PMU placement to pass the test.
5) We systematically evaluate the proposed solution on
IEEE 30-bus, IEEE 57-bus, IEEE 118-bus, and IEEE
300-bus systems. The results demonstrate that
the
proposed solution can substantially reduce the number
of required PMUs while preventing CCPA from causing
outages, even with the AC-based augmentation.

Roadmap: We formulate the PPOP problem under the DC
model in Section II and present both optimal algorithms and
heuristics to solve PPOP in Section III. We then show how
the DC-based solution can be reï¬ned to work under the AC
model in Section IV. We evaluate the performance of PPOP
in Section V and conclude the paper in Section VI. Additional
contents and proofs are given in the appendices.

II. PROBLEM FORMULATION

Notations: For a matrix A, we denote by ai its i-th column
and Ak its k-th row. We slightly abuse the notation | Â· | in that
|A| indicates the cardinality if A is a set and the element-wise
absolute value if A is a vector or matrix. Logical expression â†”
indicates the â€œif and only ifâ€ logic, while â†’ denotes the â€œif thenâ€
logic. When the operators â‰¥, â‰¤, = are applied to two vectors,
they indicate element-wise operations. Let a âˆˆ Rna , b âˆˆ Rnb
be two vectors, then a âŠ• b âˆˆ Rna+nb indicates the vertical
concatenation of a and b. Let (cid:100)a(cid:101) denote the element-wise
ceiling. If na = nb = n, then a (cid:12) b := (aibi)n
i=1 denotes
the Hadamard product, i.e., the element-wise product. We use
Î›(Â·) âˆˆ {0, 1}mÃ—n with one nonzero element in each row to
select entries from a vector such that Î›(Â·)x is a subvector of x.

A. Power Grid Modeling

We model the power grid as a connected undirected graph
N = (V, E), where E denotes the set of lines (lines) and
V the set of nodes (buses). Majority of our results will be
based on the DC power ï¬‚ow model, which is an approximation
widely adopted for studying security issues in power grids [2],
[5], [9]â€“[13], [18]; extension to the AC power ï¬‚ow model is
deferred to Section IV. Under this approximation, each line
e = (s, t) is characterized by reactance re = rst = rts. The
grid topology can be represented by the admittance matrix
B := (Buv)u,vâˆˆV âˆˆ R|V |Ã—|V |, deï¬ned as

Buv =

ï£±
ï£²

ï£³

0
âˆ’1/ruv
âˆ’ (cid:80)

if u (cid:54)= v, (u, v) (cid:54)âˆˆ E,
if u (cid:54)= v, (u, v) âˆˆ E,

(1)

wâˆˆV \{u} Buw if u = v.
Besides B, the grid topology can also be described by incidence
matrix D âˆˆ {âˆ’1, 0, 1}|V |Ã—|E|, which is deï¬ned as follows:

Dij =

ï£±
ï£²

ï£³

1
âˆ’1
0

if line ej comes out of node vi,
if line ej goes into node vi,
otherwise,

(2)

where the orientation of each line is assigned arbitrarily. By
deï¬ning Î“ âˆˆ R|E|Ã—|E| as a diagonal matrix with diagonal
entries Î“e = 1
(e âˆˆ E), we have B = DÎ“DT and f =
re
Î“DT Î¸ âˆˆ R|E| where f denotes the line ï¬‚ows. By deï¬ning net-
work states as phase angles Î¸ := (Î¸u)uâˆˆV and active powers as
p = (pu)uâˆˆV , the relationship between p, Î¸ and f is given as

p = BÎ¸ = Df ,

(3)

N , zT

The CC will periodically conduct state estimation, whose results
will be used for SCED to re-plan the power generation [9], [11].
L ]T âˆˆ Rm denote the unsecured meter
Formally, let z = [zT
measurements, where zN âˆˆ RmN denotes the power injection
measurements over (a subset of) nodes and zL âˆˆ RmL denotes
the power ï¬‚ow measurements over (a subset of) lines. Let Î›N
and Î›p be two row selection matrices such that zN = Î›N z =
Î›pp. Similarly, we deï¬ne row selection matrices Î›L and Î›f
such that zL = Î›Lz = Î›f f . Then, we have
(cid:20) Î›pB
Î›f Î“DT

z = HÎ¸ + (cid:15) for H :=

(4)

(cid:21)

,

3

where H is the measurement matrix based on the meter
locations and the reported breaker status, and (cid:15) is the
measurement noise. In the rest of the paper, we assume that
the measurements satisfy the conditions of [34, Theorem 5]
such that H has full column rank to support unique recovery
of Î¸ from (4) (before attack). If Â¯Î¸ is the estimated phase
angle from z and H, then BDD will raise alarm if (cid:107)z âˆ’ H Â¯Î¸(cid:107)
is greater than a predeï¬ned threshold.

Given p0 := B Â¯Î¸, the CC will conduct SCED to calculate
new generation to meet
the demand with minimal cost.
Speciï¬cally, let Î›g âˆˆ {0, 1}|Vg|Ã—|V |, Î›d âˆˆ {0, 1}|Vd|Ã—|V | be
row selection matrices for generator/load buses in p, where
Vd and Vg denote the sets of load buses and generator buses,
respectively. Denote Ë†Î¸ as the decision variable where B Ë†Î¸
represents the new power injection after SCED, and Ï† âˆˆ R|Vg|
as the cost vector for power generation. Then, SCED can be
formulated as follows [11]:

Ïˆs(p0, D) = arg min

Ë†Î¸

Ï†T (Î›gB Ë†Î¸)

s.t. Î›dB Ë†Î¸ = Î›dp0,

Î“DT Ë†Î¸ âˆˆ [âˆ’fmax, fmax],
Î›gB Ë†Î¸ âˆˆ [pg,min, pg,max],

(5a)

(5b)

(5c)

(5d)

where fmax âˆˆ R|E|
indicates the normal line ï¬‚ow limits,
pg,min and pg,max denote lower/upper bounds on generation,
and (5b) indicates that demands on all load buses are satisï¬ed.

B. Modeling Coordinated Cyber-Physical Attack (CCPA)

In this section, we formulate the attack model according
to a load redistribution attack [9] that aims at causing the
maximum outages, so that a defense against this attack can
prevent outage under any attack under the same constraints. In
the sequel, â€œground truthâ€ means the estimated value based on
unmanipulated measurements, which may contain noise.

For ease of presentation, we summarize the timeline of the

entire attack process, as shown in Fig 1. Speciï¬cally,

â€¢ At t0, the attacker estimates Î¸0 and p0 := ËœBÎ¸0 by

eavesdropping on z0 and ËœH.

â€¢ At t1, CCPA is deployed to change the ground-truth from

z0, ËœH, Î¸0 to z1, H and Î¸1, respectively.

â€¢ At t2, the CC receives falsiï¬ed information, i.e., ËœH and
Ëœz2, which leads to ËœÎ¸2. Then the CC will deploy a new
dispatch of power generation as Ëœp3 := ËœB ËœÎ¸3, where ËœÎ¸3
denotes the associated predicted phase angles.

â€¢ At t3, the new dispatch takes effect and reaches steady
state, with the true phase angles Î¸3 and power ï¬‚ows f3.
Key notations at different time instances are summarized in
Table I, where â€œâ€”â€ means that the information is not available
to the CC at the given time instance.

Figure 1. Timeline of an instance of CCPA

First, we model the inï¬‚uence of attacks on SCED. We
deï¬ne ac âˆˆ Rm to be the cyber-attack vector, which changes
the measurements received by the CC to Ëœz2 = z2 + ac, and

t0t1t2timet3à·©ğ»,à·¨ğµ,à·©ğ·ğ»,ğµ,ğ·Physical attackBefore attackCCPA deployedSCED at CCPost-SCED steady stateğ‘¢0ğ‘¢5ğ‘¢1ğ‘¢3ğ‘¢4ğ‘¢2Table I
NOTATIONS V.S. TIMELINE

forecasting [9], [11], which can be modeled by 1

t1
t0
time
ËœH H
True measurement matrix
Measurement matrix at CC â€” â€”
Î¸0
Î¸1
â€” â€”
z0
z1
â€” â€”

True phase angle
Phase angle at CC
True measurement
measurement at CC

t2
H
ËœH
Î¸2 = Î¸1
ËœÎ¸2
z2 = z1
Ëœz2

t3
H
ËœH
Î¸3
ËœÎ¸3
z3
â€”

âˆ’Î±|p0| â‰¤ ËœB ËœÎ¸2 âˆ’ p0 â‰¤ Î±|p0|.

(12)

Following the convention in [9], [23], the attack is con-
strained by a predeï¬ned constant Î¾p denoting the maximum
number of attacked lines and another constant Î¾c denoting the
maximum number of manipulated measurements, i.e.,

(cid:107)ap(cid:107)0 â‰¤ Î¾p,

(cid:107)ac(cid:107)0 â‰¤ Î¾c.

(13)

4

ap âˆˆ {0, 1}|E| the physical-attack vector, where ap,e = 1
indicates that line e is disconnected by the physical attack.
As the physical attack changes the topology, we use ËœN to
denote the pre-attack topology and N the post-attack topology.
Accordingly, ËœB, ËœD, ËœH denote the pre-attack admittance, inci-
dence, and measurement matrices, and B, D, H their (true)
post-attack counterparts, related by

B = ËœB âˆ’ ËœDÎ“diag(ap) ËœDT , D = ËœD âˆ’ ËœDdiag(ap),
and H = ËœH âˆ’ [(Î›p ËœDÎ“diag(ap) ËœDT )T , (Î›f ËœDdiag(ap))T ]T .
Falsiï¬ed measurements in Ëœz2 and breaker status will mislead
CC to an incorrect state estimation and thus falsiï¬ed SCED de-
cisions. Hence, overload-induced line tripping can happen at t3.

(6)

To bypass BDD, the attacker has to manipulate breaker status
information to mask the physical attack, misleading the CC to
believe that the measurement matrix is ËœH instead of H. Also,
measurements have to be modiï¬ed into Ëœz2 such that BDD
with Ëœz2 and ËœH as input will not raise any alarm. Below, we
will derive constraints on ap and ac such that the modiï¬ed
data can pass BDD under the assumption that the pre-attack
data can pass BDD as assumed in FDI [2]. Considering that
Ëœz2 = z2 + ac, ac should be constructed such that
(cid:107) Ëœz2 âˆ’ ËœH ËœÎ¸2(cid:107) = (cid:107)z0 âˆ’ ËœHÎ¸0 + z2 + ac âˆ’ z0 + ËœHÎ¸0 âˆ’ ËœH ËœÎ¸2(cid:107)
(7)

(pre-attack residual)

= (cid:107)z0 âˆ’ ËœHÎ¸0(cid:107),

which leads to the following construction of ac:

ac = z0 âˆ’ z2 + ËœH( ËœÎ¸2 âˆ’ Î¸0)

= ËœHÎ¸0 + (cid:15)0 âˆ’ (HÎ¸2 + (cid:15)0) + ËœH( ËœÎ¸2 âˆ’ Î¸0)

=

(cid:20) Î›p ËœB
Î›f Î“ ËœDT

(cid:21)

ËœÎ¸2 âˆ’

(cid:20) Î›pB
Î›f Î“DT

(cid:21)

Î¸2.

(8)

(9)

(10)

Besides (8), there may be additional constraints on ac to avoid
causing suspicion. Speciï¬cally, following [9], we assume that
all the power injections at generator buses are measured and
not subject to attacks, i.e.,

Î›g ËœD Ëœf2 = Î›g ËœB ËœÎ¸2 = Î›gBÎ¸2 = Î›gDf2 = Î›gp0,

(11)

recalling that Î›g is the row selection matrix corresponding
to generator buses. Moreover, by representing the maximum
normal load ï¬‚uctuation through Î± â‰¥ 0, the magnitude of
falsiï¬cation at load buses needs to be constrained due to load

In addition, we constrain ap so that the graph after physical
attack remains connected, which is needed for stealth of the
attack according to [11], [12]. Speciï¬cally, deï¬ning fcon âˆˆ
R|E| as a pseudo ï¬‚ow and u0 as the reference node, we can
guarantee network connectivity at t2 by ensuring
(cid:40)

ËœDufcon =

|V | âˆ’ 1,
âˆ’1,

if u = u0,
if u âˆˆ V \ {u0},

âˆ’|V | Â· (1 âˆ’ ap,e) â‰¤ fcon,e â‰¤ |V | Â· (1 âˆ’ ap,e).

(14a)

(14b)

With lines oriented as in ËœD, (14a) (ï¬‚ow conservation constraint)
and (14b) (line capacity constraint) ensure the existence of a
unit pseudo ï¬‚ow from u0 to every other node in the post-attack
grid and hence the connectivity of the post-attack grid, where
fcon,e > 0 if the ï¬‚ow on e is in the same direction of the line
and fcon,e < 0 otherwise.

In practice, transmission lines are equipped with overcurrent
protection devices, which will trip the lines when the power
ï¬‚ow exceeds the tripping threshold. Thus, heavy overloading
caused by the SCED misled by cyber attacks can lead to
initial outages at t3, which can create cascading outages [11].
Speciï¬cally, let fmax âˆˆ R|E| be the normal power ï¬‚ow limits
imposed in SCED [35]. Then, a line e âˆˆ E will be tripped by
protection devices (i.e., having an outage) if

|fe| > Î³efmax,e,

(15)

where Î³e denotes the tripping threshold based on the thermal
limit of the line. In practice, although [36] suggests Î³e â‰¥ 1.5,
the operator may choose higher fmax,e, which leads to a smaller
Î³e. As discussed in [11], [37], a small Î³e implies that the system
is operating with a low margin of overload. A large Î³e may
contribute to robustness to cascading failure [37], but leads to
underutilization of transmission lines.

C. Modeling the Protection Effect of Secured PMUs

Let Î² âˆˆ {0, 1}|V | be the indicator vector for PMU placement
such that Î²u = 1 if and only if a secured PMU is installed at
node u. We deï¬ne â„¦(Î²) := {u|Î²u > 0} and the inverse process
Î²(â„¦) : Î²u = 1 if u âˆˆ â„¦ and Î²u = 0 otherwise. Let Vu be the
node set containing neighbors of node u (including u) and Eu
be the line set composed of lines incident on u. According to
[21], by measuring both voltage and current phasor, a PMU
on node u can guarantee the correctness of phase angles in Vu

1In contrast to [1] that only imposes the magnitude constraint on measured
buses, constraint (12) is imposed on all buses (although subsumed by (11)
for generator buses). This is because under the assumption of full-rank
measurement matrix (Section II-A), the CC can recover all the phase angles
and hence the power injections at all the buses, and thus the attacker needs to
avoid causing too much deviation in the power injections at all the buses.

and protect lines in Eu from both cyber and physical attacks.
Formally, we deï¬ne xN âˆˆ {0, 1}|V | such that (xN,u = 1) â†”
(âˆƒv âˆˆ Vu such that Î²v = 1), which can be modeled as

âˆ†âˆ’1AÎ² â‰¤ xN â‰¤ âˆ†âˆ’1AÎ² +

(cid:107)âˆ†(cid:107)âˆ âˆ’ 1
(cid:107)âˆ†(cid:107)âˆ

,

(16)

where âˆ† âˆˆ Z|V |Ã—|V | is a diagonal matrix with âˆ†uu = |Vu|,
while A := A+I is the adjacency matrix of the grid with added
self-loops at all nodes. Similarly, we deï¬ne Î¶ to be any constant
within [0.5, 1) and xL âˆˆ {0, 1}|E| satisfying (xL,e = 1) â†”
(âˆƒv with e âˆˆ Ev and Î²v = 1), which can be linearlized as

0.5|D|T Î² â‰¤ xL â‰¤ 0.5|D|T Î² + Î¶.

(17)

We assume that the PMU locations are known to the attacker,

thus the cyber attack is constrained as follows:
xN,u = 1 â†’ ËœÎ¸2,u = Î¸2,u,âˆ€u âˆˆ V,
âˆ€e âˆˆ E.
xL,e = 1 â†’ ap,e = 0,

(18a)

(18b)

Note that (16)-(18) implicitly protect the power ï¬‚ow measure-
ments on lines incident to a PMU. To see this, suppose that e =
(s, t) and Î²s = 1. Then we must have xN,s = xN,t = xL,e = 1
due to (16)-(17). By (18), it is guaranteed that Ëœz2,e := (ËœÎ¸2,s âˆ’
ËœÎ¸2,t)/rst = (Î¸2,s âˆ’ Î¸2,t)/rst =: z2,e. In addition, PMU data
are usually collected at a high frequency (e.g., around 60-200
samples per second). Thus, the PMUs can â€œinstantlyâ€ detect any
attack violating (18) even though they cannot prevent the attack
from happening. In this way, the PMUs can reduce the potential
damage by restricting the attackerâ€™s choices of attack vectors.

D. Optimal PMU Placement Problem

Our main problem, named PMU Placement for Outage
Prevention (PPOP), aims at placing the minimum number
of secured PMUs so that no undetectable CCPA can cause
overload-induced tripping. To achieve this, we model the
problem as a tri-level optimization problem (an overview of
PPOP is given in Fig. 4 in Appendix A).

The middle-level optimization is the attackerâ€™s problem,
which aims to maximize the number of overloaded lines without
being detected. Instead of using ac as decision variable, we
propose to formulate over Ëœfi, fi and ËœÎ¸i, Î¸i where i âˆˆ {2, 3}. In
the rest of the paper, we will apply big-M modeling technique
that introduces sufï¬ciently large constants denoted as M(Â·) for
linearization. The calculation of M(Â·) is given in Appendix B.
Speciï¬cally, the constraints on Î¸2 and f2 are:

âˆ’M2,a,e (1 âˆ’ ap) â‰¤ f2 â‰¤ M2,a,e (1 âˆ’ ap) ,
ËœDf2 = p0,
âˆ’ M2,f ap â‰¤ Î“DÎ¸2 âˆ’ f2 â‰¤ M2,f ap.

(19a)

(19b)

(19c)

The constraints (19a) and (19b) guarantee the consistency
between f2 and p0 given ap, where ap,e = 1 will force
f2,e = 0. The role of (19c) is to force the consistency between
f2 and Î¸2 for all e with ap,e = 0, which is necessary for the
uniqueness of f2. Similarly, we can transform (7)-(13) into
constraints over Ëœf2, ËœÎ¸2, and ap, which are

âˆ’ fmax â‰¤ Ëœf2 â‰¤ fmax,

(20a)

Î“ ËœDT ËœÎ¸2 âˆ’ Ëœf2 = 0,
ËœÎ¸2,u âˆ’ Î¸2,u â‰¤ M2,Î¸ Â· (1 âˆ’ xN,u),
ËœÎ¸2,u âˆ’ Î¸2,u â‰¥ âˆ’M2,Î¸ Â· (1 âˆ’ xN,u),
âˆ’ Î±|p0| â‰¤ ËœD Ëœf2 âˆ’ p0 â‰¤ Î±|p0|,
Î›g ËœD Ëœf2 = Î›gp0,
(cid:16) Ëœf2 âˆ’ f2
(cid:107)Î›f
(cid:107)ap(cid:107)0 â‰¤ Î¾p,

(cid:107)0 + (cid:107)Î›p

(cid:17)

(cid:16) ËœD Ëœf2 âˆ’ p0

5

(20b)

(20c)

(20d)

(20e)

(20f)

(20g)

(cid:17)

(cid:107)0 â‰¤ Î¾c,

(20h)
where (20a)-(20b) guarantee the validity of Ëœf2 as in (19a)-(19c),
(20c)-(20d) linearize (18a) (M2,Î¸ deï¬ned in Appendix B), while
(20e), (20f), and (20g)â€“(20h) correspond to (12), (11), and (13),
respectively. It is worth noting that there exists an ac in the
form of (10) for any Ëœf2 and ËœÎ¸2 satisfying (20) due to the
relationship between Ëœf2, ËœÎ¸2 and ac shown in (10) and (20b).
Moreover, the constraints on Î¸3, ËœÎ¸3, and f3 are

pg,min â‰¤ Î›g ËœB ËœÎ¸3 â‰¤ pg,max
âˆ’ fmax â‰¤ Î“DT ËœÎ¸3 â‰¤ fmax,
Î›d ËœB ËœÎ¸3 = Î›d ËœD Ëœf2
âˆ’ M3,a(1 âˆ’ ap) â‰¤ f3 â‰¤ M3,a(1 âˆ’ ap),
Î›d ËœDf3 = Î›dp0, Î›g ËœDf3 = Î›g ËœB ËœÎ¸3,
âˆ’ M3,f ap â‰¤ Î“ ËœDT Î¸3 âˆ’ f3 â‰¤ M3,f ap,

(21a)

(21b)

(21c)

(21d)

(21e)

(21f)
where (21a)-(21c) describe the feasible region of ËœÎ¸3 under
false data injection, and (21d)â€“(21f) are used to enforce the
power ï¬‚ow equation (3) at t3, where Î›g ËœB ËœÎ¸3 is the post-SCED
generation predicted by the attacker. While a straightforward
formulation of the power ï¬‚ow equation should be
Î“DT Î¸3 = f3, Î›dDf3 = Î›dp0, Î›gDf3 = Î›g ËœB ËœÎ¸3, (22)
such a formulation will introduce bilinear terms DT Î¸3 and
Df3, as the post-attack incidence matrix D is a function
of the physical-attack vector ap that
is also a decision
variable for the attacker. To avoid the bilinear terms, we
use (21d) to force f3,e = 0 when ap,e = 1 (line e is
e Î¸3 = f3,e
disconnected), and (21f) to force Î“e
when ap,e = 0. Moreover, under (21d), we observe that Df3 =
(cid:80)
Ëœdef3,e = ËœDf3, as de = Ëœde if ap,e = 0
and def3,e = Ëœdef3,e = 0 if ap,e = 1, which explains (21e).

eâˆˆE def3,e = (cid:80)

ËœdT
e Î¸3 = Î“edT

eâˆˆE

Thus, the attackerâ€™s problem, which deï¬nes the optimal

attack strategy, can be formulated as:

Ïˆa(Î²) := max (cid:107)Ï€(cid:107)0

s.t.

(14), (16) âˆ’ (21),
Î¸2,u0 = Î¸3,u0 = ËœÎ¸2,u0 = ËœÎ¸3,u0 = 0,
ËœÎ¸3 = Ïˆs( ËœB ËœÎ¸2, ËœD),
|f3,e|
fmax,e

> Î³e â†” Ï€e = 1, âˆ€e âˆˆ E,

(23a)

(23b)

(23c)

(23d)

(23e)

where yc := ËœÎ¸2 âŠ• ËœÎ¸3 âŠ• Î¸2 âŠ• Î¸3 âŠ• f2 âŠ• f3 âŠ• Ëœf2 âŠ• fcon and
yb := Ï€ âŠ• ap âŠ• xN âŠ• xL are continuous and binary decision
variables, respectively. Here, Ï€e = 1 if and only if line e is
overloaded to be tripped, which is ensured by (23e). Thus,
the objective is to maximize the number of overload-induced
tripped lines due to the attack-induced load redistribution. The

constraints (23c) ï¬xes the phase angle at the reference node,
denoted as node u0. The constraint (23d) incorporates the lower-
level optimization of SCED (5) by specifying the post-SCED
generation, determined by ËœÎ¸3.

We formulate the upper-level PMU placement problem as

min (cid:107)Î²(cid:107)0

s.t. Ïˆa(Î²) = 0

(24a)

(24b)

where the decision variable is Î² âˆˆ {0, 1}|V |, and Ïˆa(x)
deï¬ned in (23) denotes the maximum number of lines that
will be tripped according to (15) at t3. In the sequel, we call
(ap, ac, e) an attack tuple, which is called â€œsuccessfulâ€ under
PMU placement Î² if there exists a feasible solution to (23)
with physical attack ap and cyber attack ac such that Ï€e = 1.
Moreover, we call (ap, e) a successful attack pair under Î² if
it can form a successful attack tuple under Î².

Remark 1: While the above formulation treats the load proï¬le
p0 as a constant, it can be easily extended to handle the
ï¬‚uctuations in loads. This can be modeled by treating p0 as a
decision variable in the attackerâ€™s optimization, constrained by
the expected range of ï¬‚uctuation, e.g., p0 âˆˆ [Îºp(0), Îºp(0)], or
the union of ranges around multiple operating points:

i0(cid:91)

p0 âˆˆ

{Îºip(i) â‰¤ p â‰¤ Îºip(i)}.

(25)

i=1

This enlarges the solution space for the attacker, which changes
the meaning of Ïˆa(Î²) to the maximum number of tripped lines
under the worst load proï¬le and the worst attack under this
load proï¬le. Clearly, a PMU placement that avoids overload-
induced tripping in this worst scenario can avoid overload-
induced tripping in any scenario encountered during operation,
as long as the load proï¬le stays within the predicted range.

Remark 2: In practice, PMUs are often deployed in stages.
Thus, it may be desirable that a temporary PMU placement
designed to prevent outages can be augmented into an optimal
PMU placement Î²opt
in the long run (e.g., a minimum
placement that provides full observability). This can be modeled
by adding a constraint in (24) that requires Î² â‰¤ Î²opt.

III. SOLVING PPOP

The PPOP problem (23)-(24) is a tri-level non-linear mixed
integer problem, which is notoriously hard [12]. In this section,
we ï¬rst formally prove that the problem is NP-hard, and
then demonstrate how to transform it into a bi-level mixed-
integer linear programming (MILP) problem. Next, we propose
an alternating optimization framework based on constraint
generation to solve the problem optimally. Finally, to accelerate
the computation, we develop a polynomial-time heuristic.

A. Hardness and Conversion to Bi-Level MILP

Although multi-level non-linear mixed integer programming
is generally hard, PPOP is only a special case and hence needs
to be analyzed separately. Nevertheless, we show that PPOP
is NP-hard (see proof in Appendix H).

6

The attackerâ€™s problem (23) can be linearized into a MILP
(see details in Appendix A), which implies that PPOP can be
converted into a bi-level MILP.

B. An Alternating Optimization Framework

Algorithm 1: Alternating Optimization
1 Initialization: k = 1, Ë†Î²(k) = 0;
2 while True do

3

4

5

6

Solve (23) under Ë†Î²(k) to obtain Ïˆa( Ë†Î²(k));
if Ïˆa( Ë†Î²(k)) > 0 then

Add constraints to (24);
k â† k + 1, obtain Ë†Î²(k) by solving (24), with
(24b) replaced by the generated constraints

else break ;

7
8 Return Ë†Î²(k), indicators of the selected PMU placement;

As a bi-level MILP, PPOP is still difï¬cult to solve due to the
integer variables in (23) and (24). Since one of the fundamental
challenges in solving bi-level MILPs is the lack of explicit
description of the upper-level optimizationâ€™s feasible region, we
propose an alternating optimization framework shown in Alg. 1
to solve PPOP by gradually approximating the feasible region
of the upper-level optimization through constraint generation. In
Sections III-Câ€“III-D, we will give two concrete constraint gen-
eration methods for Line 5 of Alg. 1 based on the results of (23).
In the sequel, we assume that solving (23) returns a

successful attack tuple (a(k)

p , a(k)

c

, e(k)) if Ïˆa( Ë†Î²(k)) > 0.

C. Alternating Optimization with No-Good Constraints
(AONG)

In this section, we give the ï¬rst speciï¬c algorithm under the
framework of Alg. 1, in which the added constraints in Line 5
are motivated by the following observation:
Lemma III.1. Given Ë†Î² and â„¦( Ë†Î²) := {u âˆˆ V : Ë†Î²u > 0}, if
there exists a successful attack tuple (ap, ac, e), then for all
Î² with â„¦(Î²) âŠ† â„¦( Ë†Î²), there exists a successful attack tuple.
Proof. For any Î² with â„¦(Î²) âŠ† â„¦( Ë†Î²), (ap, ac, e) remains a
successful attack tuple.

The above observation indicates that at least one PMU must
be placed in â„¦( Ë†Î²)c := V \ â„¦( Ë†Î²). Therefore, the optimal Î² can
be obtained in an iterative manner: during each iteration, we
use the PMU placement Ë†Î² from the previous iteration (initially,
Ë†Î² = 0) to solve (23) for Ïˆa( Ë†Î²). If Ïˆa( Ë†Î²) = 0, Ë†Î² is the
ï¬nal solution; otherwise, we will add the following â€œNo-Goodâ€
constraint: (cid:80)
i: Ë†Î²i=0 Î²i â‰¥ 1 to (24) for the next iteration to rule
out the infeasible solution Ë†Î².

However, the above procedure will converge very slowly as
|â„¦( Ë†Î²)c| is usually large. To speed up convergence, we augment
each discovered infeasible solution Ë†Î² into a maximal infeasible
solution Ë†Î²(cid:48) to narrow down candidate solutions. This can be
achieved by solving the following problem:

Theorem III.1. The PPOP problem (24) is NP-hard.

max (cid:107) Ë†Î²(cid:48)(cid:107)0

(26a)

s.t.

Ïˆa( Ë†Î²(cid:48)) â‰¥ 1,
u = 1, âˆ€u âˆˆ V with Ë†Î²u = 1,
Ë†Î²(cid:48)

(26b)

(26c)

which has the same decision variables as (23) and the additional
Ë†Î²(cid:48). Algorithm AONG adds the following â€œNo-Goodâ€ constraint
in Line 5 of Alg. 1:

Î²i â‰¥ 1.

(cid:88)

i: Ë†Î²(cid:48)

i=0

(27)

AONG solves PPOP optimally, as proved in Appendix H.

Theorem III.2. AONG converges in ï¬nite time to an optimal
solution to (24).

Given the MILP formulation of (23) in Appendix A, it is
easy to write (26) as a MILP and solve it by existing MILP
solvers. It is worth noting that solving (26) suboptimally does
not affect the optimality of AONG. Thus, we can also apply
heuristic algorithms (e.g., LP relaxation with rounding).

D. Alternating Optimization with Double Constraints (AODC)

Building on AONG, we develop an additional constraint as
a complement of (27) to accelerate convergence, in the special
case where Î¾c = âˆ and Ïˆs(p, D) returns the set of Î¸â€™s satisfy-
ing (5b)-(5d), i.e., it returns the feasible region of SCED rather
than a single solution. Such a special case is worth consideration
because (i) Î¾c = âˆ represents the strongest cyber attack, and
(ii) relaxing the optimality requirement in (23d) means that
the attacker is allowed to pick a solution for SCED within its
feasible region, both making the attack stronger and hence the
resulting PMU placement more robust in preventing outages.
Below we will ï¬rst introduce the new constraints, called
â€œAttack-Denialâ€ constraints, and then give the AODC algorithm,
in which both â€œNo-Goodâ€ constraints and â€œAttack-Denialâ€
constraints are added in Line 5 of Alg. 1. The new constraints
are motivated by the following observations about AONG:
many PMU placements enumerated by AONG are vulnerable
to attacks formed from the same attack pair (ap, e), indicating
that
to generate constraints that can
invalidate the identiï¬ed attack pairs. More discussions are
given in Appendix C.

is more efï¬cient

it

The above observations motivate the following idea of
â€œAttack-Denialâ€ constraints: given a successful attack pair
(a(k)
p , e(k)) under Î²(k), the added constraints should guarantee
that any PMU placement satisfying the constraints can prevent
attacks that fail lines according to a(k)
from causing overload-
induced tripping at line e(k). We focus on (a(k)
p , e(k)) instead
of (a(k)

, e(k)) due to the following observations:

p , a(k)

p

c

2) Given xN and (a(k)

1) The number of (a(k)

c

c

p , a(k)

is continuous, but the number of (a(k)

, e(k))â€™s is inï¬nite since a(k)
p , e(k))â€™s is ï¬nite.
p , e(k)), (23b)-(23e) reduce to a linear
system with only the continuous variables contained in
yc under the assumptions that Î¾c = âˆ and Ïˆs(p, D)
returns the set of Î¸â€™s satisfying (5b)-(5d). The linear
system can be summarized as
1 yc = s(k)
F (k)
1 ,
2 yc â‰¤ s(k)
F (k)
2 + F3xN ,

(28b)

(28a)

7

1

, F (k)
2

where F (k)
, F3, s(k)
are constant
matrices/vectors deï¬ned in Appendix D. An attack pair
(a(k)
p , e(k)) can form a successful attack if and only if
(28) has a feasible solution.

1 , s(k)

2

The above assumptions (i.e., Î¾c = âˆ and Ïˆs(p, D) returns all
the Î¸â€™s satisfying (5b)-(5d)) are needed because: (i) Î¾c = âˆ
implies that we no longer need the binary variables used to
linearize (20g) (i.e., wf and wp in (40) in Appendix A); (ii)
when the lower-level optimization returns the feasible region
of (5), (23d) can be replaced by (5b)-(5d) without introducing
binary variables required for transforming (5) into its KKT
conditions [9].

l:a(k)

Our key observation is that a PMU placement Î² can defend
against an attack pair (a(k)
p , e(k)) by either preventing the
physical attack a(k)
or making (28) infeasible. The former can
p
be achieved by adding constraint (cid:80)
p,l =1 xL,l â‰¥ 1 (i.e., at
least one attacked line must be incident to a PMU). The latter
holds according to Galeâ€™s theorem of alternative [38] if and
only if there exists q(k)

1
(F (k)
)T q(k)
1
1 + (s(k)
1 âˆˆ Rm1 and q(k)

1 )T q(k)

and q(k)
2 â‰¥ 0 satisfying
1 + (F (k)
)T q(k)
2 = 0,
2 + F3xN )T q(k)
2 < 0,
2 âˆˆ Rm2 can be treated as the dual

where q(k)
variables for (28a) and (28b), respectively.

(s(k)

(29b)

(29a)

2

Based on the above observation, the â€œAttack-Denialâ€ con-

p , e(k)) are:

straints for defending against (a(k)
1 + (F (k)
1 + (s(k)
xL,l â‰¥ wa,k,

)T q(k)
(F (k)
1
(s(k)
1 )T q(k)
(cid:88)

)T q(k)
2 + F3xN )T q(k)

2 = 0,

2

2 â‰¤ wa,k âˆ’ 1,

p,l =1

l:a(k)
q(k)
2 â‰¥ 0, wa,k âˆˆ {0, 1},

(30a)

(30b)

(30c)

(30d)

2

1

and q(k)

1 , q(k)

where q(k)
2 , and wa,k are newly introduced variables. Note
that (29b) and (30b) are equivalent when wk = 0 since we can
scale q(k)
to satisfy (30b) if (29b) holds. The binary
variable wa,k indicates which approach to use for defending
against (a(k)
p , e(k)). When wa,k = 0, (30c) holds trivially, in
which case Î² defends against (a(k)
p , e(k)) by satisfying (29),
i.e., preventing the cyber attack from causing overload-induced
tripping at line e(k). When wa,k = 1, q(k)
2 = 0
will satisfy the constraints (30a)-(30b), in which case Î² defends
against (a(k)

p , e(k)) by preventing the physical attack a(k)
p .

1 = 0 and q(k)

Now, we are ready to present the AODC algorithm, where

Ë†Î²(K+1) in Line 6 of Alg. 1 is obtained by solving:

min (cid:107)Î²(cid:107)0

s.t.

(16) âˆ’ (17), (30) for k = 1, Â· Â· Â· , K,

(cid:88)

Î²i â‰¥ 1, k = 1, Â· Â· Â· , K,

i =0

i: Ë†Î²(cid:48)(k)
Î² âˆˆ {0, 1}|V |,

(31a)

(31b)

(31c)

(31d)

where the decision variables are Î², xN , xL, q(k)
wa,k for k = 1, Â· Â· Â· , K.

1 , q(k)

2 , and

To convert (31) to a MILP, we linearize (F3xN )T q(k)

2

using McCormickâ€™s relaxation. Concretely, note that

(F3xN )T q(k)

2 =

(cid:88)

uâˆˆV

xN,u

(cid:32) m2(cid:88)

i=1

(cid:33)

F3,i,uq(k)
2,i

, âˆ€k.

(32)

Assuming that (cid:80)
2,i âˆˆ [M F , M F ], we introduce a
continuous auxiliary variable yu and the following constraints:

i F3,i,uq(k)

M F xN,u â‰¤ yu â‰¤ M F xN,u,
(cid:32) m2(cid:88)

(cid:33)

F3,i,uq(k)
2,i

yu â‰¤

i=1

(cid:32) m2(cid:88)

i=1

yu â‰¥

(cid:33)

F3,i,uq(k)
2,i

(33a)

+ M F xN,u âˆ’ M F ,

(33b)

+ M F xN,u âˆ’ M F .

(33c)

Note that yu = (cid:80)m2
wise, i.e., yu = xN,u
in (30b) can be replaced by (cid:80)

i=1 F3,i,uq(k)
(cid:16)(cid:80)m2

2,i if xN,u = 1 and yu = 0 other-
. Then, (F3xN )T q(k)

i=1 F3,i,uq(k)

2,i

(cid:17)

2

uâˆˆV yu subject to (33).

AODC guarantees an optimal solution at convergence in the

considered special case (see proof in Appendix H).

Theorem III.3. If Î¾c = âˆ and Ïˆs(p, D) returns the feasible
region of (5), then AODC will converge in ï¬nite time to an
optimal solution to (24).

Although in the worst case AODC may still enumerate all the
attack pairs, which can be exponential in |E|, we have observed
that in practice it usually converges after identifying a relatively
small set of â€œtypical attack pairsâ€, as shown in Table V.

E. Efï¬cient Heuristics

Although Alg. 1 is guaranteed to ï¬nd the optimal solution,
the computational complexity can grow exponentially with
the network size due to the requirement of solving MILPs in
each iteration, which motivates us to develop polynomial-time
heuristics. A scenario of particular interest is when Î¾p is small,
i.e., Î¾p = O(1). In this case, the total number of attack pairs is
polynomial in |E|, and thus the number of iterations in AODC
and the complexity of computing a new attack pair in each
iteration are both polynomial in |E|. Our focus in this case is
thus on solving (31) approximately in polynomial time.

Relaxation: One idea is to directly relax the MILP version of
(31) into an LP. However, simple LP relaxation will not work:
1) The LP relaxation will invalidate the McCormick relax-

ation (33) for the bilinear term (F3xN )T q(k)
2 .

2) The feasible region is signiï¬cantly extended by the LP
relaxation due to the adopted big-M modeling technique.
3) Given a continuous solution ËœÎ² obtained from the LP
relaxation, it is non-trivial to determine which subset of
â„¦( ËœÎ²), if any, can achieve our defense goal.

We have developed a polynomial-time heuristic that can
ï¬nd a better PMU placement. The core of our heuristic is a
different â€œLP relaxationâ€ of (31). Recall that the main challenge
in directly relaxing the MILP version of (31) is the invalidation
of (33) for linearizing (F3xN )T q(k)
2 . To overcome this issue,
we make the following observation (see proof in Appendix H):

8

Lemma III.2. Deï¬ne Î›x,p, Î›x,n âˆˆ {0, 1}|V |Ã—m2 such that
(Î›x,pq2)u is the dual variable for (20c) and (Î›x,nq2)u is the
dual variable for (20d). Suppose that the linear system
1 + (F (k)
(F (k)
1
1 + (s(k)
(s(k)
(Î›x,p + Î›x,n)q2 â‰¤ MqAÎ²,
q(k)
2 â‰¥ 0, 1 â‰¥ Î² â‰¥ 0

)T q(k)
2 = 0,
2 + F3)T q(k)

)T q(k)
1 )T q(k)

2 â‰¤ âˆ’1,

(34b)

(34d)

(34a)

(34c)

2

for attack pair (a(k)
p , e(k)) is feasible under Î² = Ë‡Î², where Mq
is a large constant (deï¬ned in Appendix B). Then, Î² = (cid:100) Ë‡Î²(cid:101)
satisï¬es (16)â€“(17) and (30) with wa,k = 0 for the attack pair
(a(k)

p , e(k)).
Lemma III.2 suggests that given an attack pair (a(k)

p , e(k)),
we can relax the mixed integer â€œAttach-Denialâ€ constraints
(30) into the linear constraints (34) and round up the fractional
solution to obtain a valid PMU placement, which is guaranteed
to prevent the given attack pair from forming successful
attack tuples. According to Galeâ€™s theorem of alternative,
(cid:16)
(Î›x,p + Î›x,n)q(k)
> 0 only if at least one of (20c)
and (20d) is effective for making (28) infeasible2. Since
(20c)-(20d) is effective if and only if xN,u = 1 (under the
constraint of xN,u âˆˆ {0, 1}), we use (Î›x,p + Î›x,n)q(k)
as a
proxy of xN in Lemma III.2.

(cid:17)

u

2

2

Lemma III.2 motivates us to formulate the following LP
based on a given set C of infeasible PMU placements and a
given set {(a(k)

p , e(k))}K

min

s.t.

k=1 of attack pairs:
(cid:88)

Î²u

uâˆˆV
(34) for k = 1, Â· Â· Â· , K,
Î²i â‰¥ 1, âˆ€ Ë†Î² âˆˆ C,

(cid:88)

i: Ë†Î²i=0

(35a)

(35b)

(35c)

where (35b) models relaxed â€œAttack-Denialâ€ constraints and
(35c) models relaxed â€œNo-Goodâ€ constraints. In this sense,
(35) is a â€œLP relaxationâ€ of (31). However, instead of directly
computing a PMU placement from (35) which still faces some
of the issues for simple LP relaxation, our idea is to use the
result of (35) to identify important nodes for PMU placement
to defend against the given attack pairs in the case of wa,k = 0
in (30). We will account for the case of wa,k = 1 separately in
the proposed algorithm to avoid scaling and numerical issues.
Algorithm: The details of the proposed heuristic is given
in Alg. 2, which relies on the function UpdateCandidate(Â·)
shown in Alg. 3. The logic behind the heuristic is similar to
that in AODC, i.e., iteratively updating PMU placements based
on newly found attack pairs. The questions are: (i) how to
generate initial placements, (ii) how to ï¬nd attack pairs that
can cause outages under given placements, and (iii) how to
update the given placements to defend against the newly found
attack pairs, all in polynomial time. Since this algorithm is
designed for the case of Î¾p = O(1), under which question (ii)
is easily solvable, our focus will be on questions (i) and (iii).

2We say that an inequality in (28) is effective for making (28) infeasible if

removing it will change the feasibility of (28).

Algorithm 2: 3-phase Secured PMU Placement
/* Phase-1: find a set A0 of attack

pairs

1 Initialization: k = 1, Ë†Î²(k) = 0, A0 = âˆ…, C = âˆ…;
2 while Ïˆa( Ë†Î²(k)) > 0 do
A0 â† A0 âˆª {(a(k)
p , e(k))}, where (a(k)
3
obtained by solving (23) under Ë†Î²(k);
C â† C âˆª { Ë†Î²(k)}, k â† k + 1;
obtain Ë‡Î²(k) by solving (35) over C and A0;
Rounding: Ë†Î²(k) â† (cid:100) Ë‡Î²(k)(cid:101);

5

4

6

p , e(k)) is

*/

/* Phase-2: find candidate placements
i=1 to defend against A0

{â„¦i}Kc

7 Set â„¦i := {ui}, i = 1, Â· Â· Â· , Kc, where {ui}Kc

indices of the largest Kc elements of Ë‡Î²(k) that is
obtained in the last iteration of phase-1;
{â„¦i}Kc
i=1, A0, C
i=1 to find a

i=1, C â† UpdateCandidate
/* Phase-3: augment {â„¦i}Kc

(cid:17)

(cid:16)

8 {â„¦i}Kc

;

*/
i=1 are the

placement â„¦ with Ïˆa (Î²(â„¦)) = 0

*/

9 while True do
10

A â† âˆ…;
for i â† 1 to Kc do

11

12

13

14

p , e(i))

if Ïˆa (Î²(â„¦i)) > 0 then Generate (a(i)
and A â† A âˆª (a(i)
p , e(i));
else Return â„¦âˆ— = arg minâ„¦j :Ïˆa(Î²(â„¦j ))=0 |â„¦j| if
|â„¦âˆ—| â‰¤ 1 + minâ„¦j :Ïˆa(Î²(â„¦j ))>0 |â„¦j|;
{â„¦i}Kc
i=1, C â† UpdateCandidate

i=1, A, C

(cid:16)

(cid:17)

;

{â„¦i}Kc

We answer question (i) in two phases. Speciï¬cally, in
phase-1, we iteratively ï¬nd a set of attack pairs A0 such
that solving (35) over A0 leads to a fractional solution Ë‡Î²
(cid:0)(cid:100) Ë‡Î²(cid:101)(cid:1) = 0. Then in phase-2, we search for a set of
with Ïˆa
candidate PMU placements {â„¦i}Kc
i=1 to defend against A0 in
the hope that |â„¦i| < |â„¦((cid:100) Ë‡Î²(cid:101))|. The motivation for maintaining
Kc > 1 candidates is to avoid the situation where the computed
placement is effective in defending against the given attacks
but ineffective for other attacks.

We answer (iii) in Alg. 3, which iteratively augments a
given set of candidate placements {â„¦i}Kc
i=1 to defend against a
given set A of attack pairs. For each candidate placement not
effective against all the attack pairs in A, Alg. 3 will generate
KL and KA new candidate placements in Line 7 and Lines 8-9,
respectively. Then, Line 10 will select the Kc placements most
effective in defending against the attack pairs in A from the pool
of Kc Â· (KA + KL) candidate placements. We now characterize
the complexity of Alg. 2 (see proof in Appendix H).

Theorem III.4. If Î¾p = O(1), then the complexity of Alg. 2
is polynomial in |V |, |E|, and Kc.

IV. EXTENSION TO AC POWER FLOW MODEL

So far we have assumed the DC power ï¬‚ow approximation
for the power grid given in Section II-A. It remains to validate
the resulting PMU placement under the AC power ï¬‚ow model

9

Algorithm 3: UpdateCandidate(cid:0){â„¦i}Kc
1 Initialization: Ai = A, i = 1, Â· Â· Â· , Kc;
2 while âˆƒi such that Ai (cid:54)= âˆ… do
3

Q â† âˆ…;
for i â† 1 to Kc do

i=1, A, C(cid:1)

4

5

6

7

8

9

10

11

if Ai = âˆ… then Q â† Q (cid:83){â„¦i} and continue;
else C â† C âˆª {Î²(â„¦i)} ;
Q â† Q (cid:83)(â„¦i âˆª {vj}) for j = 1, Â· Â· Â· , KL,
where vj can prevent the j-th most physical
attacks in Ai ;
Solve (35) over A, C, and the constraints
Î²u = 1, âˆ€u âˆˆ â„¦i, which results in Ë‡Î²;
Q â† Q (cid:83)(â„¦i âˆª {uj}) for j = 1, Â· Â· Â· , KA,
where uj is the index of the j-th largest
element in { Ë‡Î²u}uâˆˆV \â„¦i;

i=1 as the Kc elements in Q that can

Update {â„¦i}Kc
defend against the most attack pairs in A;
Ai â† {(ap, e) âˆˆ A|â„¦i cannot defend against
(ap, e)}, âˆ€i = 1, . . . , Kc;
i=1 and C;

12 Return {â„¦i}Kc

that describes the grid state more accurately. To this end, we
will address the following questions: given a PMU placement
â„¦DC âŠ† V obtained under the DC power ï¬‚ow model, (i) how
to test the feasibility of â„¦DC in preventing outages under the
AC power ï¬‚ow model, and (ii) how to reï¬ne â„¦DC if needed to
achieve our defense goal under the AC power ï¬‚ow model.

A. Testing a PMU Placement under AC Model

One challenge to answer the ï¬rst question is the nonlinear
and nonconvex nature of AC power ï¬‚ow based SCED (AC-
SCED), which invalidates the transformation of (23) into a
single-level MILP through KKT conditions. Another challenge
lies in formulating a single optimization to maximize the
overloading of a target line after SCED (at t3 in Fig. 1).
Speciï¬cally, since solving nonlinear AC power ï¬‚ow equations
usually requires iterative methods (e.g., Newton-Raphson
method [39]), we cannot directly formulate the AC-SCED
at t2 and the corresponding ground-truth grid state at t3 in an
optimization problem. Existing works handled this challenge
by approximating the grid state at t3 by the DC power ï¬‚ow
model [28], [32] or DC-based line outage distribution factors
[30], [31]. However, such DC-based approximations cannot
be directly used to compute the magnitude of currents, which
determines the overloading and related tripping of lines.

In the following, we provide a method, as shown in Alg. 4,
to check the existence of an AC-based CCPA that can cause
overloading under a given PMU placement. To overcome the
challenges discussed before, we ï¬rst remove the optimality
requirement in AC-SCED, similar to our derivation of â€œAttack-
Denialâ€ constraints in Section III-D. Omitting this optimality
requirement is equivalent to allowing the attacker to choose the
objective for AC-SCED, which enlarges the feasible region for
the attackerâ€™s optimization. To jointly model the current at t3
and the AC-SCED at t2, we adopt the linearized approximation

of AC power ï¬‚ow equations [33]. Based on these two strategies,
we formulate the following optimization problem for the
attacker to maximize the magnitude of current on a given
target line et under a given physical attack (i.e., ap):

max | Ë†I3,et|2

s.t.

Constraints on Ëœv2, ËœÎ¸2 to bypass BDD,
ACOPF constraints on Ëœv3, ËœÎ¸3,
Constraints to solve Ë†v3, Ë†Î¸3, | Ë†I3|,

(36a)

(36b)

(36c)

(36d)

where Ëœv2, ËœÎ¸2 denote the voltage magnitudes and phase
angles estimated at t2 by the control center based on falsiï¬ed
measurements, Ëœv3, ËœÎ¸3 denote the same variables predicted by
AC-SCED for t3 (computed at t2), and Ë†v3, Ë†Î¸3, | Ë†I3| denote the
approximated ground-truth of voltage magnitudes, phase angles
and line current magnitude at t3. The details of (36) are given
in Appendix E. Similar to Table I, for a given variable x, we
use Ëœx2 to denote its estimate based on falsiï¬ed measurements
at t2, x2 to denote its ground-truth value at t2, Ëœx3 to denote the
value predicted by AC-SCED (at t2) for t3, and x3 to denote
the ground-truth value at t3. Given the voltage magnitudes Ëœv3
and the phase angles ËœÎ¸3, the approximated values of x at t3 is
denoted as Ë†x3.

In (36), we have the following three types of constraints and

decision variables:

1) Constraint (36b) is the counterpart of (20) under the AC
power ï¬‚ow model, in which the main decision variables
are Ëœv2 and ËœÎ¸2. Similar to (20), we use Ëœv2 and ËœÎ¸2 as
the decision variables to model the cyber attack that can
bypass the BDD. Following [30], we adopt the quadratic
convex (QC) relaxation [40] in (36b) to model the AC
power ï¬‚ow equations.

2) As the counterpart of (21a)-(21c) under the AC power
ï¬‚ow model, (36c) models the reaction of AC-SCED to
the falsiï¬ed measurements based on the QC relaxation.
3) The real grid state at t3 is formulated in (36d) as the
counterpart of (21d)-(21f), based on the approximation
of AC power ï¬‚ow equations proposed in [33].

As we have enlarged the feasible region for the attacker in
(36b)-(36c) by using the QC relaxation, (36) models a stronger
attack, and hence a PMU placement that prevents overloading
under this attack can prevent overloading under the original
attack. We will use xâˆ— to denote the value of decision variable
x in the optimal solution to (36).

Based on (36), we develop an algorithm to check the
feasibility of a PMU placement â„¦ âŠ† V in preventing outages
under AC-based CCPA, shown in Algorithm 4. Speciï¬cally,
at Lines 2, we compute v2, Î¸2, |I2| by solving power ï¬‚ow
equations. Thus, the counterpart of (19) is no longer needed
to compute the real grid states after physical attacks. Then,
3, ËœÎ¸âˆ—
at Line 3, we obtain the optimal solution (| Ë†I âˆ—
3) to
(36) for the given attack pair (ap, et) (recall that | Ë†I âˆ—
| is the
3,et
approximated current magnitude on line et at time t3 while
|I âˆ—
| is the corresponding true value). Alg. 4 considers the
PMU placement â„¦ to successfully defend against (ap, et) (i.e.,
preventing overloading at line et under physical attack ap) if
one of the following conditions hold:

|, Ëœvâˆ—

3,et

3,et

1) no cyber attack ac can bypass the BDD, i.e., (36) is

10

infeasible, as checked in Line 9, or

3,et

3,et

2) | Ë†I âˆ—

| â‰¤ Ë†Imax,et and |I âˆ—

| â‰¤ Î³eImax,et, as checked in
Lines 4â€“7, where Ë†Imax,et (derived in Theorem IV.1) is
the threshold used by Alg. 4 to detect the tripping of line
et based on the approximated current magnitude | Ë†I âˆ—
|.
3,et
The use of Ë†Imax,e rather than Î³eImax,e allows us to
compensate for the approximation error at t3. As stated in
Theorem IV.1, under a properly-set Ë†Imax,e, a PMU placement
â„¦ is guaranteed to achieve our defense goal under the AC
model if â„¦ can pass the test of Alg. 4, i.e., no overloading is
reported. How to bound the approximation errors as assumed in
Theorem IV.1 is not the focus of this work; we refer interested
readers to [33] for details.

Theorem IV.1. Assume that the approximation used in (36d)
satisï¬es |Ë†v3,u âˆ’ v3,u| â‰¤ (cid:15)v,u, |Ë†Î¸3,u âˆ’ Î¸3,u| â‰¤ (cid:15)Î¸,u, âˆ€u âˆˆ V and
|Ë†p3,f,e âˆ’ p3,f,e| â‰¤ (cid:15)p,e, |Ë†q3,f,e âˆ’ q3,f,e| â‰¤ (cid:15)q,e, âˆ€e âˆˆ E. Then,
there exists (cid:15)I,e, âˆ€e âˆˆ E (see proof in Appendix H for details)
and Ë†Imax,e := Î³eImax,e âˆ’ (cid:15)I,e such that any PMU placement
passing the test of Alg. 4 can prevent overload-induced tripping
under the AC power ï¬‚ow model.

Algorithm 4: Test Feasibility of â„¦ under AC Model
1 for each possible attack pair (ap, et) under the given

PMU placement â„¦ do

2

3

4

5

6

7

8

9

10

11

Obtain v2, Î¸2, |I2| from AC power ï¬‚ow equations;
Solve (36) to obtain | Ë†I âˆ—
3,et
if (36) is feasible AND | Ë†I âˆ—

3, ËœÎ¸âˆ—
3;
| â‰¤ Ë†Imax,et then

|, Ëœvâˆ—

3,et

| from AC power ï¬‚ow equations;

3,et

Compute |I âˆ—
if |I âˆ—

3,et
Continue;

| â‰¤ Î³eImax,et then

else Terminate and report overloading;

else if (36) is infeasible then

Continue;

else Terminate and report overloading;

B. Reï¬ning PMU Placement

In the case that the DC-based PMU placement â„¦DC fails the
test by Alg. 4, we provide a simple heuristic to augment it into a
new placement â„¦AC that can achieve our defense goal under the
AC model. The intuition is to iteratively augment â„¦DC by placing
more PMUs until the resulting placement â„¦AC can pass the test
of Alg. 4. The key question is which node to add. To answer this
question, we ï¬rst augment â„¦DC into a PMU placement â„¦C :=
â„¦(Î²C) that can achieve full observability by solving (37):

min
Î²C âˆˆ {0, 1}|V |
s.t.

(cid:107)Î²C(cid:107)1

Î²C â‰¥ Î²(â„¦DC),
AÎ²C â‰¥ 1,

(37a)

(37b)

(37c)

where (37b) guarantees â„¦DC âŠ† â„¦C, and (37c) forces â„¦C
to achieve full observability. Then equipped with â„¦C, we
augment â„¦DC into â„¦AC by Alg. 5. If a PMU placement cannot

defend against an attack pair (ap, et) (Line 6), then we update
the PMU placement by the following rules:

1) If there exists a node u âˆˆ â„¦C that can prevent the
physical attack ap as in (18b), we add node u to the
current PMU placement (Line 8).

2) Otherwise, we add the node in â„¦C with the maximum
deviation in phase angle due to false data injection
(Line 11), with ties broken arbitrarily.

Algorithm 5: Augment PMU Placement for AC Model
1 Initialization: â„¦AC = â„¦DC;
2 while True do
3

Test â„¦AC through Alg. 4;
if No overloading is reported then Return â„¦AC;
else

Let (ap, et) be the attack pair under which
overloading is reported, and
U := {u âˆˆ V : âˆƒe with ap,e = 1, Du,e (cid:54)= 0}
(all end-nodes of physically-attacked lines);
if â„¦C âˆ© U (cid:54)= âˆ… then

Arbitrarily choose a node u âˆˆ â„¦C âˆ© U ;

else

Let ËœÎ¸2, Î¸2 be the falsiï¬ed/true phase angles
at t2 under attack pair (ap, et);
Set u := arg maxvâˆˆâ„¦C |ËœÎ¸2,v âˆ’ Î¸2,v|;

â„¦AC â† â„¦AC âˆª {u};

4

5

6

7

8

9

10

11

12

V. NUMERICAL EXPERIMENTS

Simulation Settings: We evaluate our solution against bench-
marks in several standard systems: IEEE 30-bus, IEEE 57-bus,
IEEE 118-bus, and IEEE 300-bus system, where the system
parameters as well as load proï¬les are obtained from [41].
The parameters for our evaluation are set as follows unless
speciï¬ed otherwise: We set Î± = 0.25 according to [11]. We
allow ËœÎ¸3 to take any value speciï¬ed by the attacker subject to
(5b)-(5d), which makes our defense effective under any SCED
cost vector. The attackerâ€™s capability is set as Î¾p = 2, Î¾c = âˆ
(no constraint on the number of manipulated meters). We set
the overload-induced tripping threshold to Î³e = 1.2, âˆ€e âˆˆ E,
which is slightly smaller than the one used in [11] to make the
solution more robust. For Alg. 2, we set Kc = KA = KL = 10.
In the rest of this section, we will compare the performance
of Alg. 1 (AONG or AODC) and Alg. 2 with the following
benchmarks: (i) PMU placement to achieve full observability as
proposed in [26]; (ii) greedily placing PMUs in the descending
order of node degrees until attack-induced overload-induced
tripping is prevented, referred to as â€œGreedyDegreeâ€. Bench-
mark (i) represents the current approach, and benchmark (ii)
represents a baseline solution under the lowered goal of defense.
Savings in the Number of PMUs: In Table II, we compare the
number of secured PMUs required by the proposed algorithms
(Alg. 1, Alg. 2) with the benchmarks under the nominal
operating point [41]. The minimum number of PMUs required
to avoid outages, given by Alg. 1 (either AONG or AODC),
is signiï¬cantly smaller than what is required to achieve full

11

observability. Alg. 2 closely approximates the minimum for the
tested systems, but a simple heuristic such as GreedyDegree
does not. For IEEE 300-bus system, we have skipped Alg. 1
as neither AODC nor AONG can converge within 72 hours.
The details of PMU locations are given in Appendix F.

Table II
COMPARISON OF THE REQUIRED NUMBER OF PMUS

Alg. 1 (optimal)
Alg. 2
GreedyDegree
Full observability

30-bus
2
2
3
10

57-bus
3
3
3
17

118-bus
9
10
14
32

300-bus
â€”
31
85
87

Then, we evaluate the scenario when the solution by PPOP
is used as a temporary PMU placement that will eventually
be augmented into a placement achieving full observability,
as discussed at the end of Section II (Remark 2). To this end,
we evaluate the following metrics: (i) the minimum number
of PMUs required by PPOP |â„¦PPOP|, (ii) the minimum number
of PMUs for achieving full observability |â„¦FO|, (iii) the size
of a full-observability placement â„¦C augmented from â„¦PPOP
given by (37), and (iv) the size of the optimal solution â„¦(cid:48)
PPOP
to a variation of PPOP with the additional constraint that
â„¦(cid:48)
PPOP| is only
slightly larger than |â„¦PPOP|, i.e., most of the cost savings by
PPOP is still achievable when its solution is required to be
consistent with the optimal long-term solution that achieves full
observability, but (ii) |â„¦C| can be notably larger than |â„¦FO| for
large systems, i.e., augmenting an arbitrary solution to PPOP
to achieve full observability may require notably more PMUs
compared to a clean-slate solution.

PPOP âŠ† â„¦FO. In Table III, we observe that (i) |â„¦(cid:48)

Table III
COMPARISON OF #PMUS UNDER TEMPORARY/LONG-TERM PLACEMENT

|â„¦PPOP|
|â„¦(cid:48)
PPOP|
|â„¦C |
|â„¦FO|

30-bus
2
2
10
10

57-bus
3
3
17
17

118-bus
9
10
33
32

300-bus
31
34
95
87

Impact of System Parameters: We evaluate the impact of
various system parameters on the number of PMUs required
by PPOP, given by Alg. 1 (by Alg. 2 for the 300-bus system).
First, we study the effect of Î± introduced in (12), where
a larger Î± implies a larger feasible region for the attacker. It
can be seen from Table IV that (i) PPOP can still signiï¬cantly
reduce the required number of PMUs compared to â€œFull
observabilityâ€ (see Table II) even if Î± is large, and (ii) PPOP
beneï¬ts from a small value of Î±, which signiï¬es the importance
of precise load forecasting in defending against CCPA.

Table IV
NUMBER OF PMUS IN PPOP UNDER VARYING Î±

Î± = 0.01
Î± = 0.10
Î± = 0.25
Î± = 0.50

30-bus
1
1
2
3

57-bus
1
2
3
3

118-bus
4
6
9
11

300-bus
24
30
31
34

Then, we vary Î¾p and Î¾c to evaluate the impact of the
attackerâ€™s capability. As shown in Figure 2, (i) defending

12

(a) Effect of Î¾p

(b) Effect of Î¾c

(a) Number of secured PMUs

(b) Computation time

Figure 2.

#PMUs required by PPOP

#PMUs required by full observability (Î¾c =|V |+|E| means no Î¾c-constraint).

Figure 3. The performance of Alg. 2 under different Kc, KA, and KL.

against a stronger attacker requires more PMUs as expected,
(ii) PPOP still
requires much fewer PMUs than â€œFull
observabilityâ€ when the attacker can disconnect multiple lines
and manipulate all the meters (except for the secured PMUs),
which is stronger than the attack model considered in [11],
[18], and (iii) PPOP can save a larger fraction of PMUs in
IEEE 57-bus system since fmax given in [41] is large.

In addition, we consider the case that the load proï¬le p0
can vary as shown in (25). We assume p0 âˆˆ [Îºp(0), Îºp(0)],
where p(0) is the nominal load proï¬le from [41], Îº = 0.5 and
Îº is set to the maximum value that keeps (5) feasible under
Îºp(0). In our evaluations, we set Îº as 1.95, 2.69, 2.41 and
1.61 for IEEE 30-bus, 57-bus, 118-bus and 300-bus systems,
respectively. For the given range, PPOP requires 3, 4, 19,
and 33 PMUs for the 30-bus, 57-bus, 118-bus, and 300-bus
systems, which is more than what is required under a single
load proï¬le as expected. Nevertheless, PPOP can still save
PMUs compared to â€œFull observabilityâ€ as shown in Table II.
Computational Efï¬ciency: We compare AODC and AONG in
terms of the number of iterations (which is also the number of
examined attack pairs) and the running time, which is evaluated
in a platform with Intel i7-8700 CPU with Gurobi as the solver.
Since any feasible solution to (26) can form an â€œNo-Goodâ€
constraint, we set an upper-bound on the time for solving
(26), which is 1200 seconds. As shown in Table V, while the
two algorithms perform similarly for small systems, AODC
converges notably faster for larger systems such as the 118-bus
system thanks to its reduced solution space due to the adoption
of both â€œNo-Goodâ€ and â€œAttack-Denialâ€ constraints. Note that
both algorithms converge after examining a small fraction of
possible attack pairs (the total number of attack pairs is 33620,
252800, and 3200130 for these systems, respectively).

Table V
NUMBER OF ITERATIONS/CONVERGENCE TIME (103 SEC)

30-bus
AODC
8/0.021
AONG 7/0.014

57-bus
3/2.188
4/2.163

118-bus
16/26.64
78/74.44

Moreover, we use IEEE 118-bus system as an example to
demonstrate the trade-off in tuning the parameters Kc, KA, KL
for Alg. 2 (assuming KA = KL). We run Alg. 2 for 5 times
under each setting due to the randomness in solving (23)
and breaking ties. The results are given in Fig. 3, where
the bar denotes the mean and the error bar denotes the
minimum/maximum. In Fig. 3 (b), we show the speedup
of the heuristic compared to AODC in convergence time,
i.e., (time of AODC)/(time of heuristic). We observe that (i)

Alg. 2 can return a good solution when Kc â‰¥ %10 Â· |V | and
KA = KL â‰¥ Kc, and (ii) under this conï¬guration, Alg. 2 is
signiï¬cantly faster than AODC at a small cost of requiring
a couple of more PMUs.

Extension to AC model: We compare the solution â„¦AC
obtained by Alg. 5 with the best previous solution â„¦DC obtained
under the DC approximation. As shown in Table VI, although
the DC-based solution may need augmentation to defend against
AC-based CCPA, the gap (i.e., |â„¦AC| âˆ’ |â„¦DC|) is small. More
importantly, |â„¦AC| is still much smaller (by 60â€“80%) than the
number of PMUs |â„¦FO| required to achieve full observability
(see Table III), indicating the efï¬cacy of our approach of ï¬rst
computing an initial solution under the DC approximation and
then augmenting it to achieve our defense goal under the AC
model. We note that the values of |â„¦AC| in Table VI are only
upper bounds on the number of PMUs required to prevent
outages under AC-based CCPA, suggesting great potential of
saving PMUs by adopting the proposed defense goal.

Table VI
NUMBER OF PMUS UNDER AC POWER FLOW MODEL

|â„¦AC|
|â„¦DC|

30-bus
3
2

57-bus
3
3

118-bus
10
9

300-bus
34
31

VI. CONCLUSION

We formulate a tri-level optimization problem under the DC
power ï¬‚ow model to ï¬nd the optimal secured PMU placement
to defend against the coordinated cyber-physical attack (CCPA)
in the smart grid. Rather than completely eliminating the attack,
we propose to limit the impact of the attack by preventing
overload-induced outages. To solve the proposed problem, we
ï¬rst transform it into a bi-level MILP and then propose an
alternating optimization algorithm framework to obtain optimal
solutions. The core of the proposed algorithm framework is
constraint generation based on infeasible placements, for which
we develop two constraint generation approaches. Furthermore,
we propose a polynomial-time heuristic algorithm that can
scale to large-scale grids. In addition, we demonstrate how to
extend the obtained PMU placement to achieve our defense
goal under the AC power ï¬‚ow model. Our experimental results
on standard test systems demonstrate great promise of the
proposed approach in reducing the requirement of PMUs. Our
work lays the foundation for tackling a number of further
questions in future work, e.g., how to characterize the optimal
attack without solving MILPs, how to directly optimize the

30-bus57-bus118-bus300-busTest systems00.10.20.30.4Fraction of secured PMUsp = 1p = 2p = 330-bus57-bus118-bus300-busTest systems00.10.20.30.4Fraction of secured PMUsc = 0.7(|V|+|E|)c = 0.8(|V|+|E|)c = 0.9(|V|+|E|)c = (|V|+|E|)15101520The value of Ka and KL05101520Number of PMUsKc = 1Kc = 4Kc = 7Kc = 10AODC15101520The value of Ka and KL0510152025SpeedupKc = 1Kc = 4Kc = 7Kc = 10PMU placement for outage prevention under the AC model,
and how to improve the robustness of the solution against the
failures of PMUs themselves.

REFERENCES

[1] Y. Huang, T. He, N. R. Chaudhuri, and T. L. Porta, â€œPreventing outages
under coordinated cyber-physical attack with secured PMUs,â€ in IEEE
SmartGridComm.

IEEE, 2021.

[2] R. Deng, P. Zhuang, and H. Liang, â€œCcpa: Coordinated cyber-physical
attacks and countermeasures in smart grid,â€ IEEE Transactions on Smart
Grid, vol. 8, no. 5, pp. 2420â€“2430, 2017.

[3] P. Fairley, â€œCybersecurity at U.S. utilities due for an upgrade: Tech to
detect intrusions into industrial control systems will be mandatory,â€ IEEE
Spectrum, vol. 53, no. 5, pp. 11â€“13, May 2016.

[4] G. Chaojun, P. Jirutitijaroen, and M. Motani, â€œDetecting false data
injection attacks in AC state estimation,â€ IEEE Transactions on Smart
Grid, vol. 6, no. 5, pp. 2476â€“2483, 2015.

[5] K. C. Sou, â€œProtection placement for power system state estimation
measurement data integrity,â€ IEEE Transactions on Control of Network
Systems, vol. 7, no. 2, pp. 638â€“647, 2019.

[6] S. M. Dibaji, M. Pirani, D. B. Flamholz, A. M. Annaswamy, K. H.
Johansson, and A. Chakrabortty, â€œA systems and control perspective of
CPS security,â€ Annual reviews in control, vol. 47, pp. 394â€“411, 2019.
[7] M. Ozay, I. Esnaola, F. T. Y. Vural, S. R. Kulkarni, and H. V. Poor, â€œSparse
attack construction and state estimation in the smart grid: Centralized and
distributed models,â€ IEEE Journal on Selected Areas in Communications,
vol. 31, no. 7, pp. 1306â€“1318, 2013.

[8] T. A. Alexopoulos, G. N. Korres, and N. M. Manousakis, â€œComplemen-
tarity reformulations for false data injection attacks on pmu-only state
estimation,â€ Electric Power Systems Research, vol. 189, p. 106796, 2020.
[9] Y. Yuan, Z. Li, and K. Ren, â€œModeling load redistribution attacks in
power systems,â€ IEEE Transactions on Smart Grid, vol. 2, no. 2, pp.
382â€“390, 2011.

[10] S. Lakshminarayana, E. V. Belmega, and H. V. Poor, â€œMoving-target
defense against cyber-physical attacks in power grids via game theory,â€
IEEE Transactions on Smart Grid, 2021.

[11] L. Che, X. Liu, Z. Li, and Y. Wen, â€œFalse data injection attacks induced
sequential outages in power systems,â€ IEEE Transactions on Power
Systems, vol. 34, no. 2, pp. 1513â€“1523, 2018.

[12] X. Liu, Z. Li, X. Liu, and Z. Li, â€œMasking transmission line outages via
false data injection attacks,â€ IEEE Transactions on Information Forensics
and Security, vol. 11, no. 7, pp. 1592â€“1602, 2016.

[13] Z. Li, M. Shahidehpour, A. Alabdulwahab, and A. Abusorrah, â€œBilevel
model for analyzing coordinated cyber-physical attacks on power systems,â€
IEEE Transactions on Smart Grid, vol. 7, no. 5, pp. 2260â€“2272, 2015.
[14] H. Lin, A. Slagell, Z. T. Kalbarczyk, P. W. Sauer, and R. K. Iyer,
â€œRuntime semantic security analysis to detect and mitigate control-related
attacks in power grids,â€ IEEE Transactions on Smart Grid, vol. 9, no. 1,
pp. 163â€“178, 2016.

[15] L. Garcia, F. Brasser, M. H. Cintuglu, A.-R. Sadeghi, O. A. Mohammed,
and S. A. Zonouz, â€œHey, my malware knows physics! attacking PLCs
with physical model aware rootkit.â€ in NDSS, 2017.

[16] R. Deng, G. Xiao, and R. Lu, â€œDefending against false data injection
attacks on power system state estimation,â€ IEEE Transactions on
Industrial Informatics, vol. 13, no. 1, pp. 198â€“207, 2015.

[17] X. Liu, Z. Li, and Z. Li, â€œOptimal protection strategy against false data
injection attacks in power systems,â€ IEEE Transactions on Smart Grid,
vol. 8, no. 4, pp. 1802â€“1810, 2016.

[18] M. Tian, M. Cui, Z. Dong, X. Wang, S. Yin, and L. Zhao, â€œMultilevel
programming-based coordinated cyber physical attacks and countermea-
sures in smart grid,â€ IEEE Access, vol. 7, pp. 9836â€“9847, 2019.
[19] T. T. Kim and H. V. Poor, â€œStrategic protection against data injection
attacks on power grids,â€ IEEE Transactions on Smart Grid, vol. 2, no. 2,
pp. 326â€“333, 2011.

[20] J. Hao, R. J. Piechocki, D. Kaleshi, W. H. Chin, and Z. Fan, â€œSparse
malicious false data injection attacks and defense mechanisms in smart
grids,â€ IEEE Transactions on Industrial Informatics, vol. 11, no. 5, pp.
1â€“12, 2015.

[21] Q. Yang, D. An, R. Min, W. Yu, X. Yang, and W. Zhao, â€œOn optimal
pmu placement-based defense against data integrity attacks in smart grid,â€
IEEE Transactions on Information Forensics and Security, vol. 12, no. 7,
pp. 1735â€“1750, 2017.

[22] Y. Xiang and L. Wang, â€œA game-theoretic study of load redistribution
attack and defense in power systems,â€ Electric Power Systems Research,
vol. 151, pp. 12â€“25, 2017.

13

[23] X. Wu and A. J. Conejo, â€œAn efï¬cient tri-level optimization model for
electric grid defense planning,â€ IEEE Transactions on Power Systems,
vol. 32, no. 4, pp. 2984â€“2994, 2016.

[24] Y. Yao, T. Edmunds, D. Papageorgiou, and R. Alvarez, â€œTrilevel
optimization in power network defense,â€ IEEE Transactions on Systems,
Man, and Cybernetics, Part C (Applications and Reviews), vol. 37, no. 4,
pp. 712â€“718, 2007.

[25] R. B. Bobba, K. M. Rogers, Q. Wang, H. Khurana, K. Nahrstedt, and T. J.
Overbye, â€œDetecting false data injection attacks on DC state estimation,â€
in First Workshop on Secure Control Systems, vol. 2010. Stockholm,
Sweden, 2010.

[26] S. Chakrabarti, E. Kyriakides, and D. G. Eliades, â€œPlacement of
synchronized measurements for power system observability,â€ IEEE
Transactions on power delivery, vol. 24, no. 1, pp. 12â€“19, 2008.
[27] W. Yuan, J. Wang, F. Qiu, C. Chen, C. Kang, and B. Zeng, â€œRobust
optimization-based resilient distribution network planning against natural
disasters,â€ IEEE Transactions on Smart Grid, vol. 7, no. 6, pp. 2817â€“2826,
2016.

[28] J. Liang, L. Sankar, and O. Kosut, â€œVulnerability analysis and conse-
quences of false data injection attack on power system state estimation,â€
IEEE Transactions on Power Systems, vol. 31, no. 5, pp. 3864â€“3872,
2015.

[29] M. Jin, J. Lavaei, and K. H. Johansson, â€œPower grid ac-based state esti-
mation: Vulnerability analysis against cyber attacks,â€ IEEE Transactions
on Automatic Control, vol. 64, no. 5, pp. 1784â€“1799, 2019.

[30] H.-M. Chung, W.-T. Li, C. Yuen, W.-H. Chung, Y. Zhang, and C.-K.
Wen, â€œLocal cyber-physical attack for masking line outage and topology
attack in smart grid,â€ IEEE Transactions on Smart Grid, vol. 10, no. 4,
pp. 4577â€“4588, 2018.

[31] Z. Chu, J. Zhang, O. Kosut, and L. Sankar, â€œN-1 reliability makes it
difï¬cult for false data injection attacks to cause physical consequences,â€
IEEE Transactions on Power Systems, 2021.

[32] â€”â€”, â€œVulnerability assessment of large-scale power systems to false
data injection attacks,â€ in 2020 IEEE International Conference on
Communications, Control, and Computing Technologies for Smart Grids
(SmartGridComm).

IEEE, 2020, pp. 1â€“6.
[33] Z. Yang, K. Xie, J. Yu, H. Zhong, N. Zhang, and Q. Xia, â€œA general
formulation of linear power ï¬‚ow models: Basic theory and error analysis,â€
IEEE Transactions on Power Systems, vol. 34, no. 2, pp. 1315â€“1324,
2018.

[34] G. Krumpholz, K. Clements, and P. Davis, â€œPower system observability:
a practical algorithm using network topology,â€ IEEE Transactions on
Power Apparatus and Systems, no. 4, pp. 1534â€“1542, 1980.
exceedance
clariï¬ca-
https://www.nerc.com/pa/Stand/

deï¬nition
tion,â€
2014,
Prjct201403RvsnstoTOPandIROStndrds/2014 03 fourth posting
white paper sol exceedance 20141201 clean.pdf.

[35] â€œSystem operating

Online, March

limit

and

[36] â€œNerc standard prc-023-1,â€ Online, February 2008, https://www.nerc.

com/ï¬les/prc-023-1.pdf.

[37] M. H. Athari and Z. Wang, â€œImpacts of wind power uncertainty on
grid vulnerability to cascading overload failures,â€ IEEE Transactions on
Sustainable Energy, vol. 9, no. 1, pp. 128â€“137, 2017.
[38] O. L. Mangasarian, Nonlinear programming. SIAM, 1994.
[39] A. Monticelli, â€œElectric power system state estimation,â€ Proceedings of

the IEEE, vol. 88, no. 2, pp. 262â€“282, 2000.

[40] C. Coffrin, H. L. Hijazi, and P. Van Hentenryck, â€œThe qc relaxation:
A theoretical and computational study on optimal power ï¬‚ow,â€ IEEE
Transactions on Power Systems, vol. 31, no. 4, pp. 3008â€“3018, 2015.

[41] S. Babaeinejadsarookolaee, A. Birchï¬eld, R. D. Christie, C. Coffrin,
C. DeMarco, R. Diao, M. Ferris, S. Fliscounakis, S. Greene, R. Huang
et al., â€œThe power grid library for benchmarking ac optimal power ï¬‚ow
algorithms,â€ arXiv preprint arXiv:1908.02788, 2019.

[42] C. Coffrin, H. L. Hijazi, and P. Van Hentenryck, â€œDistï¬‚ow extensions

for ac transmission systems,â€ arXiv preprint arXiv:1506.04773, 2015.

[43] M. Porter, P. Hespanhol, A. Aswani, M. Johnson-Roberson, and R. Va-
sudevan, â€œDetecting generalized replay attacks via time-varying dynamic
watermarking,â€ IEEE Transactions on Automatic Control, vol. 66, no. 8,
pp. 3502â€“3517, 2020.

[44] L. Liu, M. Esmalifalak, Q. Ding, V. A. Emesih, and Z. Han, â€œDetecting
false data injection attacks on power grid by sparse optimization,â€ IEEE
Transactions on Smart Grid, vol. 5, no. 2, pp. 612â€“621, 2014.

[45] J. P. Vielma, â€œMixed integer linear programming formulation techniques,â€

Siam Review, vol. 57, no. 1, pp. 3â€“57, 2015.

[46] T. Terlaky, Interior point methods of mathematical programming.

Springer Science & Business Media, 2013, vol. 5.

APPENDIX A
MILP FORMULATION OF ATTACKERâ€™S PROBLEM

In this section, we will demonstrate how to transform (23)
into a MILP, which can be efï¬ciently solved by existing solver
such as Gurobi.

To begin with, we give an overview of the PPOP, as shown

in Fig. 4.

Figure 4. Overview of the PPOP

We ï¬rst consider the case that lower-level optimization (5)
returns the set of Î¸â€™s satisfying (5b)-(5d), i.e., it returns the
feasible region of SCED rather than a single solution. In this
case, (23) becomes a single-level problem.

Below, we show how to convert the single-level formulation
of (23) into a MILP. To convert (18) and (23e) into linear con-
straints, we introduce a constant M2,Î¸ (deï¬ned in Appendix B)
such that (18a) holds if and only if the following holds:
ËœÎ¸2,u âˆ’ Î¸2,u â‰¤ M2,Î¸ Â· (1 âˆ’ xN,u),
ËœÎ¸2,u âˆ’ Î¸2,u â‰¥ âˆ’M2,Î¸ Â· (1 âˆ’ xN,u),

(38b)

(38a)

and similar conversion applies to (18b). As for (23e), by
deï¬ning a sufï¬ciently large constant MÏ€,e (see Appendix B)
and two binary auxiliary variables Ï€n,e, Ï€p,e to get rid of the
absolute value operation, (23e) is transformed into

âˆ’MÏ€,e Â· (1 âˆ’ Ï€p,e) <

âˆ’MÏ€,e Â· (1 âˆ’ Ï€n,e) <

f3,e
fmax,e
âˆ’f3,e
fmax,e

âˆ’ Î³e â‰¤ MÏ€,e Â· Ï€p,e,

(39a)

âˆ’ Î³e â‰¤ MÏ€,e Â· Ï€n,e.

(39b)

We claim that Ï€e = Ï€n,e + Ï€p,e. To see this, suppose that
f3,e â‰¥ 0. Then, we must have âˆ’ f3,e
âˆ’ Î³e â‰¤ 0 and thus
fmax,e
Ï€n,e = 0, while |f3,e|
âˆ’ Î³e and thus Ï€p,e = Ï€e.
fmax,e
Notice that we must have Ï€e = 1 if |f3,e| âˆ’ Î³e Â· fmax,e > 0,
while |f3,e| âˆ’ Î³e Â· fmax,e â‰¤ 0 leads to Ï€e = 0.

âˆ’ Î³e = f3,e
fmax,e

To linearize (20g), we introduce binary variables wf âˆˆ
{0, 1}|mL| and wp âˆˆ {0, 1}|mN | for data injection on line
measurements and node measurements, respectively. Then,
(20g) can be transformed into (see deï¬nitions of Mc,f , Mc,p
in Appendix B)

(cid:17)

(cid:16) Ëœf2 âˆ’ f2
(cid:16) ËœB ËœÎ¸2 âˆ’ p0

âˆ’ Mc,f wf â‰¤ Î›f

âˆ’ Mc,pwp â‰¤ Î›p
1T wf + 1T wp â‰¤ Î¾c.

â‰¤ Mc,f wf ,
(cid:17)

â‰¤ Mc,pwp,

(40a)

(40b)

(40c)

14

{Ï€n, Ï€p, ap, wf , wp},

are
are
{ ËœÎ¸2, ËœÎ¸3, Î¸2, Î¸3, f2, f3, Ëœf2, fcon}, where wf , wp are introduced
formulation without
auxiliary variables. Then,
considering the optimality of (5) is given as follows.

continuous

variables

the full

max (cid:107)Ï€p + Ï€n(cid:107)0
s.t.

âˆ†âˆ’1AÎ² â‰¤ xN â‰¤ âˆ†âˆ’1AÎ² +

(cid:107)âˆ†(cid:107)âˆ âˆ’ 1
(cid:107)âˆ†(cid:107)âˆ

,

(cid:17)

1
2

â‰¤ Mc,f wf ,

|D|T Î² + Î¶,

(cid:16) Ëœf2 âˆ’ f2

1
|D|T Î² â‰¤ xL â‰¤
2
âˆ’ (1 âˆ’ ap) â‰¤ diag (Î³ (cid:12) fmax)âˆ’1 f2 â‰¤ 1 âˆ’ ap,
ËœDf2 = p0, âˆ’M2,f ap â‰¤ Î“DÎ¸2 âˆ’ f2 â‰¤ M2,f ap,
âˆ’ fmax â‰¤ Ëœf2 â‰¤ fmax, Î“ ËœDT ËœÎ¸2 âˆ’ Ëœf2 = 0,
âˆ’ Î±|p0| â‰¤ ËœD Ëœf2 âˆ’ p0 â‰¤ Î±|p0|,
Î›g ËœD Ëœf2 = Î›gp0,
âˆ’ Mc,f wf â‰¤ Î›f
âˆ’ Mc,pwp â‰¤ ËœB ËœÎ¸2 âˆ’ p0 â‰¤ Mc,pwp,
1T wf + 1T wp â‰¤ Î¾c, (cid:107)ap(cid:107)0 â‰¤ Î¾p,
ËœÎ¸2,u âˆ’ Î¸2,u â‰¤ M2,Î¸ Â· (1 âˆ’ xN,u),
ËœÎ¸2,u âˆ’ Î¸2,u â‰¥ âˆ’M2,Î¸ Â· (1 âˆ’ xN,u),
pg,min â‰¤ Î›g ËœB ËœÎ¸3 â‰¤ pg,max,
âˆ’ fmax â‰¤ Î“DT ËœÎ¸3 â‰¤ fmax,
Î›d ËœB ËœÎ¸3 = Î›d ËœD Ëœf2,
âˆ’ M3,a(1 âˆ’ ap) â‰¤ f3 â‰¤ M3,a(1 âˆ’ ap),
Î›d ËœDf3 = Î›dp0, Î›g ËœDf3 = Î›g ËœB ËœÎ¸3,
âˆ’ M3,f ap â‰¤ Î“ ËœDT Î¸3 âˆ’ f3 â‰¤ M3,f ap,
Î¸2,u0 = Î¸3,u0 = ËœÎ¸2,u0 = ËœÎ¸3,u0 = 0,
Î³e
MÏ€,e
Î³e
MÏ€,e

f3,e
MÏ€,efmax,e
âˆ’f3,e
MÏ€,efmax,e

âˆ’ Â·(1 âˆ’ Ï€n,e) <

âˆ’ Â·(1 âˆ’ Ï€p,e) <

âˆ’

âˆ’

â‰¤ Â·Ï€p,e, âˆ€e,

â‰¤ Â·Ï€n,e, âˆ€e,

(cid:40)

ËœDufcon =

|V | âˆ’ 1,
âˆ’1,

if u = u0,
if u âˆˆ V \ {u0},

,

âˆ’ |V | Â· (1 âˆ’ ap,e) â‰¤ fcon,e â‰¤ |V | Â· (1 âˆ’ ap,e)

(41a)

(41b)

(41c)

(41d)

(41e)

(41f)

(41g)

(41h)

(41i)

(41j)

(41k)

(41l)

(41m)

(41n)

(41o)

(41p)

(41q)

(41r)

(41s)

(41t)

(41u)

(41v)

(41w)

(41x)

The constraints (41b)-(41c) correspond to (16)-(17), (41d)-
(41e) correspond to (19a)-(19c), (41f)-(41k) correspond to (20),
(41l)-(41m) correspond to (38), (41n)-(41s) correspond to (21),
(41t) corresponds to (23c), (41u)-(41v) correspond to (23e),
(41w)-(41x) correspond to (14).

If we do not relax the optimality requirements in (5), we need
to introduce additional binary variables {rf l, rf u, rgl, rgu} and
continuous dual variables {Âµb, Âµc, Âµd, Âµe, Âµg} to transform
(5) into a linear system by using its KKT conditions [9].
Speciï¬cally, we add the following linear system into (41) for
the completeness of KKT conditions of (5):
d Âµb + ËœDÎ“Âµc + ËœDÎ“Âµd + ËœBÎ›T
ËœBÎ›T

g Âµe âˆ’ ËœBÎ›T

g Ï†

g Âµg = âˆ’ ËœBÎ›T
(42a)
(42b)

(42c)

Together,

the above techniques

transform (23)

a MILP. Speciï¬cally,

the

binary

decision

into
variables

Âµc âˆ’ M rf l â‰¤ 0,
Î“ ËœDT ËœÎ¸3 + M rf l â‰¤ M âˆ’ fmax

The Proposed Formulation (PPOP) â€¢Frameworkâ€¢Tri-level optimization problemPMU deployment OptimizationAttackerâ€™s problemSCEDWhether successful attack existsPMU placementResult of SCED under the given attackAn attackÂµd âˆ’ M rf u â‰¤ 0,
âˆ’ Î“ ËœDT ËœÎ¸3 + M rf l â‰¤ M âˆ’ fmax
Âµe âˆ’ M rgl â‰¤ 0,
Î›g ËœB ËœÎ¸3 + M rgl â‰¤ pg,min + M 1
Âµg âˆ’ M rgu â‰¤ 0,
âˆ’ Î›g ËœB ËœÎ¸3 + M rgu â‰¤ âˆ’pg,max + M 1
rgl + rgu â‰¤ 1
rf l + rf u â‰¤ 1
Âµc, Âµd, Âµe, Âµg â‰¥ 0

(42d)

(42e)

(42f)

(42g)

(42h)

(42i)

(42j)

(42k)

(42l)

Compared to the attackerâ€™s formulations in [1], [13] that also
optimize the location of physical attacks, the key advantage
of (23) is avoiding McCormickâ€™s relaxation for bilinear terms
(22) and reducing the numbers of variables and constraints.
Speciï¬cally, McCormickâ€™s relaxation in [1] will introduce
2|E||V | additional continuous variables and 8|E||V | additional
constrains. The cost of avoiding bilinear term in (23) is the
additional variables f2, f3, Ëœf2 and the associated constraints,
although the beneï¬t usually outweighs the cost. For example,
for the IEEE 118-bus system, the formulation in [1] has 44436
continuous variables and 178, 596 constraints, while (23) only
has 1216 continuous variables and 5, 802 constraints.

APPENDIX B
CALCULATION OF BIG-M

In this section, we will explain how to calculate M2,a,e in
(19a), M2,f in (19c), M3,a in (21d), M2,Î¸ in (38), M3,f in
(21f), MÏ€,e in (39), M F , M F in (33), Mc,f , Mc,p in (40) and
Mq in (34c). In this section, we denote N = (V, E) as the
graph before physical attack while N (cid:48) = (V, E(cid:48)) as the graph
after attack.

We ï¬rst show how to calculate M2,a, M2,f and M2,Î¸.
Suppose that the power grid is designed to be robust to
N âˆ’ k contingency. Then, the value of M2,a depends on
Î¾p âˆ’ k. If Î¾p âˆ’ k â‰¤ 0, then we can set M2,a,e := fmax,e
or M2,a,e := Î³efmax,e, since no ap can cause overloading.
Otherwise, we set M2,a,e := C2,aÎ³efmax,e with a parameter
C2,a > 1. In our simulations, we ï¬nd that C2,a := 3 sufï¬ces
since Î¾p âˆ’ k is usually small. Next, we bound |Î¸2| by deï¬ning
MÎ¸2,u â‰¥ maxap |Î¸2,u| and MÎ¸2 â‰¥ maxap maxu |Î¸2,u| since
the value of Î¸2 depends on ap. An intuitive way of obtaining
MÎ¸2,u is enumerating all possible values of ap, whose time
complexity is polynomial in |E| and |V | if Î¾p = O(1).
Here we provide another way of bounding MÎ¸2,u. Due to
our assumption of the connected N , there exists at least
one path in N connecting the reference node u0 to each
node u âˆˆ V . Moreover, for each path connecting u0 and
u, say P a(u0, u) := (e0, e1, Â· Â· Â· , eJ ) where e0 = (u0, v1),
ej = (vj, vj+1) and eJ = (vJ , u), we have Î¸2,u âˆ’ Î¸2,u0 =
Î¸2,s âˆ’ Î¸2,v1 + Î¸2,v1 âˆ’ Â· Â· Â· + Î¸2,vJ âˆ’ Î¸2,t, which leads to

max
ap

|Î¸2,u| = max
ap

|Î¸2,u âˆ’ Î¸2,u0 |

â‰¤

J
(cid:88)

j=0

rej M2,a,ej := MP a(Î¸2,u)

(43)

15

i=1

since Î¸2,u0 = 0 in our assumption and |Î¸2,vj âˆ’ Î¸2,vj+1| â‰¤
rej M2,a,ej due to (19a). Denote np as the number of dif-
ferent paths connecting u and u0. Then, since the physical
attack will disconnect at most Î¾p lines, we set MÎ¸2,u :=
max{MP ai(Î¸2,u)}min{Î¾p+1,np}
.
Equipped with MÎ¸2,u, u âˆˆ V , we can calculate M2,f and
M2,Î¸. We deï¬ne an intermediate constant M2,f,e for each line
such that M2,f = maxeâˆˆE M2,f,e. Then, for e = (u, v) we can
ËœdT
set M2,f,e := re(MÎ¸2,u + MÎ¸2,v) since |Î“e
e Î¸2 âˆ’ f2,e| > 0
only if ap,e = 1 and f2,e = 0.
obtain M2,Î¸, we

â‰¥
maxap,ac |ËœÎ¸2,u|, u âˆˆ V in a similar way as that in (43).
Speciï¬cally, since ËœÎ¸2 is estimated by CC based on the topology
N , we can arbitrarily choose one path (e0, e1, Â· Â· Â· , eJ ) in N
that connects u and u0 and set

bound MËœÎ¸2,u

ï¬rst

To

MËœÎ¸2,u :=

J
(cid:88)

j=0

rej fmax,ej â‰¥ max
ap,ac

|ËœÎ¸2,u|.

(44)

Then, we can set M2,Î¸ := maxuâˆˆV (MËœÎ¸2,u + MÎ¸2,u).

Now, we are ready to demonstrate the calculation of M3,a
and M3,f . As for M3,a, we only require M3,a,e > Î³efmax,e
and M3,a â‰¥ maxeâˆˆE Î³efmax,e so that the attacker can cause
outages over any lines. In practice, we can set M3,a :=
c maxeâˆˆE Î³efmax,e with c > 1. As for M3,f , we again ï¬rst
show that we can bound |Î¸3,u| â‰¤ MÎ¸3,u without hurting the
attackerâ€™s objective. We notice that the topology of grid at t3
before lines facing outage automatically disconnect themselves
is still N (cid:48). Thus, we can set MÎ¸3,u similarly as MÎ¸2,u, except
that (43) becomes:

max
ap

|Î¸3,u| â‰¤

J
(cid:88)

j=0

rej Ma,ej := MP a(Î¸3,u).

(45)

Then, we can set MÎ¸3,u := max{MP ai(Î¸3,u)}min{Î¾p+1,np}
,
M3,f,e := re(MÎ¸3,u + MÎ¸3,v) for e = (u, v) âˆˆ E, and M3,f =
maxeâˆˆE M3,f,e.

i=1

Equipped with M3,a,e, MÏ€,e can be easily set as c Â· ( M3,a,e
fmax,e

+

Î³e) with any constant c > 1.

We can set M F as 0 since q2 â‰¥ 0 and F3,i,u âˆˆ {0, âˆ’M2,Î¸},
âˆ€i, u. There is no simple guidelines for M F in (33) since it is
the bound for dual variables. In practice, we can initialize M F
to a given value and solve (31) for each attack pair separately.
Then, we iteratively decrease M F until (31) is feasible under
each attack pair separately. In our simulations, we set M F :=
âˆ’M 2

2,Î¸. Equipped with M F , we can set Mq := 2M F
M2,Î¸
Finally, we demonstrate how to set Mc,f and Mc,p. Due
to (19a) and (20a), we have | Ëœf2,e âˆ’ f2,e| â‰¤ (1 + Î³e)fmax,e,
which implies that we can set Mc,f := maxeâˆˆE(1 + Î³e)fmax,e.
Similarly, we can set Mc,p := Î±(cid:107)p0(cid:107)âˆ due to (20e).

.

APPENDIX C
EFFICIENCY ANALYSIS OF â€œNO-GOODâ€ CONSTRAINTS

We have the following observations about AONG:
1) Cold start. The efï¬ciency of (27) can be characterized
by the number of infeasible Î²â€™s that are cut out. Let
{ Ë†Î²(k)}K
k=1 be the PMU placements obtained in the ï¬rst

K iterations of Alg. 1 and { Ë†Î²
k=1 the corresponding
augmented placements obtained from (26). Then, the
number of feasible Î²â€™s for the next iteration is at least

(cid:48)(k)}K

(cid:16)

2| (cid:84)K

k=1 â„¦( Ë†Î²

(cid:48)(k))c| âˆ’ 1

(cid:17)

Â· 2|V |âˆ’| (cid:84)K

k=1 â„¦( Ë†Î²

(cid:48) (k))c|

(46)

k=1 â„¦( Ë†Î²

k=1 â„¦( Ë†Î²
(cid:48)(k)}K

if (cid:84)K
(cid:48)(k))c (cid:54)= âˆ…, as placing at least one PMU in
(cid:84)K
(cid:48)(k))c will satisfy (27) for every placement in
{ Ë†Î²
k=1. This implies that the number of Î²â€™s that are
(cid:48) (k))c|. Therefore, the
cut out is at most 2|V |âˆ’| (cid:84)K
k=1 â„¦( Ë†Î²
ï¬rst K â€œNo-Goodâ€ constraints (27) added in Alg. 1 will
be inefï¬cient if | (cid:84)K
(cid:48)(k))c| is large. We observe
that | (cid:84)K
k=1 â„¦( Ë†Î²
(cid:48)(k))c| is large at the beginning of Alg. 1
and decreases quickly as (cid:107) Ë†Î²(k)(cid:107)0 increases.

k=1 â„¦( Ë†Î²

2) Repeated successful attacks. Another cause of inefï¬ciency
is that for many PMU placements enumerated by AONG,
there exist successful attacks based on the same attack
pair (ap, e), indicating that new constraints are needed
to better defend against identiï¬ed attacks.

APPENDIX D
THE DETAILS OF COEFFICIENTS IN ATTACKERâ€™S PROBLEM

The linear system (28a) is the composition of (20f), (21e)

and (21c), which can be expanded into:

ï£®

ï£¯
ï£¯
ï£°

Î›g ËœB
0
0

0
0

0
Î›dB
âˆ’Î›g ËœB Î›gB

Î›d ËœB âˆ’Î›d ËœB

0

ï£¹

ï£º
ï£º
ï£»

ï£®

ï£°

ËœÎ¸2
ËœÎ¸3
Î¸3

ï£¹

ï£» =

ï£®

ï£¯
ï£¯
ï£°

ï£¹

ï£º
ï£º
ï£»

Î›gp0
Î›dp0
0
0

(47)

as well as ËœÎ¸2,u0 = ËœÎ¸3,u0 = Î¸3,u0 = 0. For a given attack pair
(ap, e) and the corresponding Î¸2, the expansion of (28b) is

ï£®

ï£¯
ï£¯
ï£¯
ï£¯
ï£¯
ï£¯
ï£¯
ï£¯
ï£¯
ï£¯
ï£¯
ï£¯
ï£¯
ï£¯
ï£¯
ï£¯
ï£°

ËœÎ¸2
ËœB
âˆ’ ËœB
I|V |
âˆ’I|V |
0
0
0
0
0
ËœDT Î“
âˆ’ ËœDT Î“

ËœÎ¸3
0
0
0
0
0
ËœDT Î“
âˆ’ ËœDT Î“
Î›g ËœB
âˆ’Î›g ËœB
0
0

Î¸3
0
0
0
0
âˆ’Î“edT
e
0
0
0
0
0
0

s2 + F3xN
p0 + Î±|p0|
âˆ’p0 + Î±|p0|
Î¸2 + MÎ¸(1 âˆ’ xN )
âˆ’Î¸2 + MÎ¸(1 âˆ’ xN )
âˆ’Î³efmax,e
fmax
fmax
pg,max
âˆ’pg,min
fmax
fmax

ï£¹

ï£º
ï£º
ï£º
ï£º
ï£º
ï£º
ï£º
ï£º
ï£º
ï£º
ï£º
ï£º
ï£º
ï£º
ï£º
ï£º
ï£»

(48)

Speciï¬cally, the ï¬rst two rows of (48) correspond to (20e), the
next two rows correspond to (38), the 5-th row indicates the
outage at the target line, the 6-th and 7-th rows correspond to
(21b), the 8-th and 9-th rows correspond to (21a), and the last
two rows correspond to (20a).

APPENDIX E
DETAILS OF THE ATTACKERâ€™S PROBLEM UNDER AC POWER
FLOW MODEL

For completeness, we summarize the necessary notations for
presenting AC power ï¬‚ow model in Table VII. Speciï¬cally,

16

Table VII
NOTATIONS FOR AC POWER FLOW
Description

Notation
p/q âˆˆ C|V |
(cid:126)vu = vuejÂ·Î¸u
ËœYbus = ËœGbus + j ËœBbus
ËœYf / ËœYt âˆˆ C|E|Ã—|V |
Cf /Ct âˆˆ {0, 1}|E|Ã—|V |
pf /pt âˆˆ C|E|
qf /qt âˆˆ C|E|
|If |2/|It|2 âˆˆ C|E|
Imax âˆˆ R|E|
Ë†Imax âˆˆ R|E|
ËœYc = ËœGc + j ËœBc âˆˆ C|E|
ËœZ = ËœZR + j ËœZI âˆˆ C|E|
ËœYL = ËœGL + j ËœBL âˆˆ C|E|
Vmax/Vmin âˆˆ R|V |
Î¸max/Î¸min âˆˆ R|E|
Ë†p3/ Ë†q3 âˆˆ R|V |
Ë†pf,3/ Ë†qf,3 âˆˆ R|E|

Active/reactive power injection

node voltage

Bus admittance matrix
From/to end admittance matrix
From/to end incidence matrix
From/to end active power ï¬‚ow
From/to end reactive power ï¬‚ow
Square of from/to end current magnitude

Limit on line current magnitude

Threshold for line tripping

line charging

line impedance

line admittance

Limit on node voltage magnitude

Limit on phase angle difference for lines
approximated power injections at t3
approximated line power ï¬‚ow at t3

we denote Cf as the From end incidence matrix, in which
Cf,e,i = 1 if and only if we have e = (i, k) âˆˆ E. The To end
incidence matrix Ct is deï¬ned similarly, where Ct,e,k = 1 if
and only if we have e = (i, k) âˆˆ E.

We provide details about (36), where we adopt QC relaxation
proposed in [40] for (36c) and linearized approximation
proposed in [33] for (36d). As for the constraint on false data
injection to bypass BDD (36b), we follow [30] to formulate
QC relaxation-based constraints.

To begin with, we demonstrate the basics on QC relaxation
for AC power ï¬‚ow equations. Recall from Table VII that the
complex voltage on node i is (cid:126)vi := viejÂ·Î¸i. Then, we introduce
auxiliary variables cii, cik and sik in the hope that
cii = v2
i ,
cik = vivk cos Î¸ik
sik = vivk sin Î¸ik,

(49b)

(49a)

(49c)

where Î¸ik = Î¸i âˆ’ Î¸k. As proposed in [40], we ï¬rst introduce
the notation (cid:104)x(cid:105)Â·, which indicates an auxiliary variable as well
as the associated constraints with x as input. Concretely, (cid:10)x2(cid:11)T
indicates the auxiliary variable Ë˜x together with the following
constraints:

(cid:10)x2(cid:11)T

â‰¡

(cid:26) Ë˜x (cid:62) x2

Ë˜x (cid:54) (xu + xl) x âˆ’ xuxl

,

(50)

where x âˆˆ [xl, xu] is pre-assigned bound. Similarly, we have

ï£±
ï£´ï£´ï£²

(cid:104)xy(cid:105)M :=

(cid:104)sin x(cid:105)S :=

(cid:104)cos x(cid:105)C :=

Ë˜xy (cid:62) xly + ylx âˆ’ xlyl
Ë˜xy (cid:62) xuy + yux âˆ’ xuyu
Ë˜xy (cid:54) xly + yux âˆ’ xlyu
Ë˜xy (cid:54) xuy + ylx âˆ’ xuyl
(cid:1) (cid:0)x âˆ’ xu
(cid:1) (cid:0)x + xu
(xu)2 x2

ï£´ï£´ï£³
(cid:26) Ë˜sx (cid:54) cos (cid:0) xu
Ë˜sx (cid:62) cos (cid:0) xu
cx (cid:54) 1 âˆ’ 1âˆ’cos(xu)
Ë˜cx (cid:62) cos (xu)

(cid:40)

2

2

2

2

(cid:1) + sin (cid:0) xu
(cid:1) âˆ’ sin (cid:0) xu

2

2

(cid:1)
(cid:1)

(51a)

(51b)

(51c)

Equipped with (50) and (51), the QC relaxation-based con-
(cid:11)T
straints on cii for each i âˆˆ V can be written as cii âˆˆ (cid:10)v2
,
while the constraints on cik and sik for each e = (i, k) âˆˆ E
are

i

cik = cki,
sik = âˆ’ski,
ik + s2
c2
ik â‰¤ ciickk,
(cid:104)vivk(cid:105)M Â· (cid:104)cos Î¸ik(cid:105)C(cid:69)M
(cid:68)
(cid:104)vivk(cid:105)M Â· (cid:104)sin Î¸ik(cid:105)S(cid:69)M
(cid:68)

sik âˆˆ

cik âˆˆ

(52a)

(52b)

(52c)

(52d)

(52e)

,

.

For simplicity, we will omit the auxiliary variables and
the associated constraints for modeling (52d) and (52e). We
assume that (52d) and (52e) are imposed when QC relaxation
is adopted. For (36b), the decision variables we focus are
Ëœc2,ii, âˆ€i âˆˆ V, Ëœc2,ik, Ëœs2,ik, âˆ€e = (i, k) âˆˆ E, e = (k, i) âˆˆ E,
ËœÎ¸2, Ëœv2 and | ËœI2,f |2, | ËœI2,t|2. Then, the constraints (36b) can be
written as

2,i, âˆ€i âˆˆ Vg,

Î›g( Ëœp2 âˆ’ p0) = 0, Î›g( Ëœq2 âˆ’ q2) = 0
Î›g(Ëœv2 âˆ’ v2) = 0,
Ëœc2,ii = v2
âˆ’ Î›d| Ëœp0| â‰¤ Î±Î›d( Ëœp2,i âˆ’ Ëœp0) â‰¤ Î±Î›d| Ëœp0|,
âˆ’ Î›d| Ëœq0| â‰¤ Î±Î›d( Ëœq2,i âˆ’ Ëœq0) â‰¤ Î±Î›d| Ëœq0|,
(1 âˆ’ Î·)Vmin â‰¤ Ëœv2 â‰¤ (1 + Î·)Vmax
(1 âˆ’ Î·)Î¸min,e â‰¤ ËœÎ¸2,e â‰¤ (1 + Î·)Î¸max,e, âˆ€e âˆˆ E
| ËœI2,f | â‰¤ Imax, | ËœI2,t| â‰¤ Imax
Ëœp2,i =

ËœGikËœc2,ik âˆ’ ËœBik Ëœs2,ik,

(cid:88)

Ëœq2,i =

k=1,...,n
(cid:88)

k=1,...,n

âˆ’ ËœBikËœc2,ik âˆ’ ËœGik Ëœs2,ik,

(53a)

(53b)

(53c)

(53d)

(53e)

(53f)

(53g)

(53h)

(53i)

(53j)

t,e,kËœc2,kk + ËœGt,e,iËœc2,ik + ËœBt,e,iËœs2,ik,
t,e,kËœc2,kk âˆ’ ËœBt,e,iËœc2,ik + ËœGt,e,iËœs2,ik,
f,i Ëœpf,2 + cT
t,i Ëœpt,2 + R(Ysh,iËœc2,ii)
f,i Ëœqf,2 + cT
t,i Ëœqt,2 âˆ’ I(Ysh,iËœc2,ii)
2,i, Ëœv2,i = v2,i, ËœÎ¸2,i = Î¸2,i, âˆ€i with xN,i = 1,

Ëœp2,f,e = ËœGf,e,iËœc2,ii + ËœGf,e,kËœc2,ik âˆ’ ËœBf,e,k Ëœs2,ik,
Ëœq2,f,e = âˆ’ ËœBf,e,iËœc2,ii âˆ’ ËœBf,e,kËœc2,ik âˆ’ ËœGf,e,k Ëœs2,ik,
Ëœp2,t,e = ËœGâˆ—
Ëœq2,t,e = âˆ’ ËœBâˆ—
Ëœp2,i = cT
Ëœq2,i = cT
Ëœc2,ii = v2
Ëœc2,ik = v2,iv2,k cos Î¸ik, âˆ€e = (i, k) with xL,e = 1,
Ëœp2,e = p2,e, Ëœq2,e = q2,e, âˆ€e = (i, k) with xL,e = 1,
ËœI2,f,e = I2,f,e, ËœI2,t,e = I2,t,e, âˆ€e = (i, k) with xL,e = 1,

(53k)

(53l)

(53m)

(53n)

(53o)

(53p)

(53q)

(53r)

(53s)

(53t)

where p0 and q0 indicates the ground-truth power injections
at t0, (53i)-(53j) are imposed for each node i âˆˆ V , (53k)-
(53n) are imposed for all e = (i, k) âˆˆ E, cf,i/ct,i is the
i-th column of Cf /Ct, Ysh denotes the diagonal matrix of
node shunt, R(x)/I(x) denotes the real/imaginary part of
x, (53q)-(53t) indicates the protection effect of PMUs, and
Î· âˆˆ [0, 1) is a manually assigned factor for Ëœv2 and ËœÎ¸2 not to
raise alarms in control center. Besides (53), we impose the

following constraints according to [42, Chapter 5] for each
e = (i, k) âˆˆ E into (36b) :

17

| ËœI2,f,e|2 =

1

|Ze|2 (Ëœc2,ii + Ëœc2,kk âˆ’ 2Ëœc2,ik) + 2 ËœGc,e Ëœp2,f,e
âˆ’ 2 ËœBc,e Ëœq2,f,e âˆ’ |Yc,e|2 Ëœc2,ii,

Ëœp2,f,e + Ëœq2,f,e = ËœZR,e
+ |Yc,e|2 Ëœc2,ii
Ëœp2,f,e + Ëœq2,f,e = ËœZI,e

(54a)
(cid:0)| ËœI2,f,e|2 âˆ’ 2( ËœGc,e Ëœp2,f,e âˆ’ ËœBc,e Ëœq2,f,e)
(cid:1) + ËœGc,e(Ëœc2,ii + Ëœc2,kk),
(54b)
(cid:0)| ËœI2,f,e|2 âˆ’ 2( ËœGc,e Ëœp2,f,e âˆ’ ËœBc,e Ëœq2,f,e)
(54c)

(cid:1) âˆ’ ËœBc,e(Ëœc2,ii + Ëœc2,kk),

(cid:16)

+ |Yc,e|2 Ëœc2,ii
1 + 2 ËœZR,e ËœGc,e âˆ’ 2 ËœZI,e ËœBc,e
Ëœc2,ii âˆ’ Ëœc2,kk = 2( ËœZR,e Ëœp2,f,e
+ ËœZI,e Ëœq2,f,e) âˆ’ | ËœZe|2(cid:0)| ËœI2,f,e|2 âˆ’ 2( ËœGc,e Ëœp2,f,e âˆ’ ËœBc,e Ëœq2,f,e)
(cid:1)

(cid:17)

2

+

ËœYc,e

(cid:12)
(cid:12)
(cid:12)

(cid:12)
(cid:12)
(cid:12)

Ëœc2,ii

(54d)

All equations in (54) should hold simultaneously.

Similarly, the decision variables we will focus on in (36c)
are Ëœc3,ii, âˆ€i âˆˆ V, Ëœ32,ik, Ëœs3,ik, âˆ€e = (i, k) âˆˆ E, e = (k, i) âˆˆ
E, ËœÎ¸3, Ëœv3 and | ËœI3,f |2, | ËœI3,t|2. Then, the constraints (36c) are
similar to (53) and (54), with (53a)-(53h) changed into

pg,min â‰¤ Î›g Ëœp3 â‰¤ pg,max, qg,min â‰¤ Î›g Ëœq3 â‰¤ qg,max, (55a)
Î›d( Ëœp3,i âˆ’ Ëœp2,i) = 0, Î›d( Ëœq3,i âˆ’ Ëœq2,i) = 0,
(55b)
Î›g( Ëœp3,i âˆ’ Ëœp2,i) = 0
(55c)
Vmin â‰¤ Ëœv3 â‰¤ Vmax, Î¸min,e â‰¤ ËœÎ¸3,e â‰¤ Î¸max,e, âˆ€e âˆˆ E, (55d)
| ËœI3,f | â‰¤ Imax, | ËœI3,t| â‰¤ Imax.
(55e)

the decision variables

Following [33],
in (36d) are
3,i, Ë†Î¸3,i, Ë†p3,i, Ë†q3,i, âˆ€i âˆˆ V , Ë†pf,3 âˆˆ R|E|, Ë†qf,3 âˆˆ R|E| and
Ë†v2
| Ë†I3|2 âˆˆ R|E|. Next, we deï¬ne pL
f,3,e for e = (i, k) âˆˆ
E with ap,e = 0 as follows:

f,3,e and qL

f,3,e = ËœGL,e
pL

(cid:18)

Ë†Î¸ik,0

Ë†Î¸3,ik âˆ’

Ë†Î¸2
ik,0
2

f,3,e = âˆ’ ËœBL,e
qL

âˆ’

(Ë†vi,0 âˆ’ Ë†vk,0)2
2

(cid:18)

Ë†Î¸ik,0

Ë†Î¸3,ik âˆ’

Ë†Î¸2
ik,0
2

âˆ’

(Ë†vi,0 âˆ’ Ë†vk,0)2
2

+

Ë†vi,0 âˆ’ Ë†vk,0
Ë†vi,0 + Ë†vk,0
(cid:19)

(Ë†v2

3,i âˆ’ Ë†v2

3,k)

+ R( ËœYc,e)Ë†v2
3,i

(56a)

+

(cid:19)

Ë†vi,0 âˆ’ Ë†vk,0
Ë†vi,0 + Ë†vk,0

(Ë†v2

3,i âˆ’ Ë†v2

3,k)

âˆ’ I( ËœYc,e)Ë†v2

3,i,

(56b)

where Ë†vik,0 and Ë†Î¸ik,0 are obtained from any base case system
operating condition. In our work, we set it as Ë†vik,0 = v2,ik
and Ë†Î¸ik,0 = Î¸2,ik for each given (ap, et). Then, we have three
types of constraints in (36d). Speciï¬cally, by appropriately
setting Î·3,p,i and Î·3,q,i (see proof of Theorem IV.1 for details)
to tolerate the approximation error, for each i âˆˆ V , we have

âˆ’Î·3,p,i â‰¤ Di Ë†p3,f + Ë†v2
3,i

|V |
(cid:88)

k=1

ËœGik âˆ’ p0,i â‰¤ Î·3,p,i.

(57)

For each i âˆˆ Vd, we have

âˆ’Î·3,q,i â‰¤ Di Ë†q3,f âˆ’ Ë†v2
3,i

|V |
(cid:88)

k=1

ËœBik âˆ’ Ëœq3,i â‰¤ Î·3,q,i, .

(58)

For each e = (i, k) âˆˆ E with ap,e = 0, we have

pf,3,e = ËœGL,e

âˆ’ ËœBL,e

Ë†Î¸ik + pL

f,3,e,

3,i âˆ’ Ë†v2
Ë†v2
3,k
2
3,i âˆ’ Ë†v2
Ë†v2
3,k
2

qf,3,e = âˆ’ ËœBL,e
(cid:16)

Ë†Î¸ik + qL

f,3,e,

âˆ’ ËœGL,e
(cid:17)

1 + 2 ËœZR,e ËœGc,e âˆ’ 2 ËœZI,e ËœBc,e

3,k = 2( ËœZR,e Ë†p3,f,e
3,i âˆ’ Ë†v2
Ë†v2
+ ËœZI,e Ë†q3,f,e) âˆ’ | ËœZe|2(cid:0)| Ë†I3,f,e|2 âˆ’ 2( ËœGc,e Ë†p3,f,e
(cid:12)
ËœYc,e
(cid:12)
(cid:12)

âˆ’ ËœBc,e Ë†q3,f,e) +

Ë†v2
3,i

(cid:12)
(cid:12)
(cid:12)

(cid:1)

2

(59c)

(59a)

(59b)

APPENDIX F
DETAILS OF PMU LOCATIONS OBTAINED IN PPOP

Here, we present the location of PMUs obtained in the
proposed PPOP. First, in Table VIII, we give the PMU locations
according to the best proposed solution â„¦PPOP to PPOP, which
is consistent with Table II.

Table VIII
PMU LOCATIONS OF PPOP UNDER DC MODEL

IEEE 30-bus system
IEEE 57-bus system
IEEE 118-bus system

IEEE 300-bus system

Location of PMUs
15, 23
12,13,25
17,34,37,42,49,72,85,100,118
8,20,22,34,38,43,44,48,49,54,64,68,
74,77,79,89,90,94,99,109,119,132,
138,152,185,190,203,216,221,270,271

Then, in Table IX, we present the PMU locations of the
solution that can pass the test of Alg. 4 under AC power ï¬‚ow
model, obtained by Alg. 5.

Table IX
PMU LOCATIONS OF PPOP UNDER AC MODEL

IEEE 30-bus system
IEEE 57-bus system
IEEE 118-bus system

IEEE 300-bus system

Location of PMUs
5,15,23
12,13,25
17,34,37,42,49,62,72,85,100,118
8,20,22,34,38,43,44,48,49,54,64,68,
74,77,79,81,89,90,94,99,109,119,132,
138,152,175,185,190,197,203,216,
221,270,271

APPENDIX G
MORE DISCUSSION OF RELATED WORKS

Different defense techniques against CCPA/FDI: Follow-
ing [6], we classify defense techniques against CCPAs into the
following categories:

1) Prevention: Due to the requirements of network infor-
mation and measurements, prevention methods defend
against CCPAs by reducing or postponing the information
leakage. Moving target defense (MTD) approach [10]
is a typical
technique in this category. Speciï¬cally,
MTD methods will strategically impose random change
to network components (such as line admittance) to
mislead the attacker. The CCPAs with falsiï¬ed network
parameters have a higher chance to be detected. Another

18

typical method in this category is dynamic watermarking
[43], which shares a similar spirit of MTD.

2) Detection: The methods in this category manage to
detect the existence of attacks under some assumption on
information exposure and attack capability. Traditional
BDD is one of the approaches in this category. There
are some advanced detection techniques, such as low
rank-based detection [44]. Securing measurements or de-
ploying PMUs can also be used for detection. Speciï¬cally,
an attack that tries to alter the measurements secured by
PMUs will be detected by the control center. However,
to achieve full detection, full observability by PMUs is
required.

3) Resilience: It is critical to keep the system stable when
there exist CCPAs that can bypass the detection. In other
words, resilience approaches aim at limiting the impact of
the attacks. Game-theoretic methods can be regarded as
typical ones, such as the budget-constrained formulations
in [18], [22]â€“[24], [27]. Our solution lies in this category.

APPENDIX H
ADDITIONAL PROOFS

Theorem III.1. We will reduce the dominating set problem to
PPOP. Given a graph N = (V, E), the dominating set problem
aims to ï¬nd a minimum set of vertices V1 âˆˆ V such that
âˆ€u âˆˆ V \V1, u has at least one neighbor in V1. The dominating
set problem is known to be NP-hard. Notice that given the grid
N = (V, E) the parameters for the proposed problem (24)-(23)
are p0, Î“, Î¾p, Î¾c, Î± and {Î³e}eâˆˆE. We will prove for any given
connected grid and the associated dominating set problem,
there exists a parameter setting for the proposed problem such
that V1 is a minimal dominating set if and only if V1 is an
optimal solution to (24), i.e., âˆ€u âˆˆ V, xN,u = 1.

Given any p0, suppose that Î¸0 is the associated phase angle
without attack, i.e., p0 = ËœBÎ¸0, and Ë†Î¸0 is the the solution to
(5), i.e., Ë†Î¸0 = Ïˆs(p0, ËœD), which gives Ë†f0 := Î“ ËœDT Ë†Î¸0.

Then, we set p0 = 0, Î¾p = 0, Î¾c = âˆ, Î± = âˆ and Î“ as
identity matrix, which results in Î¸0 = Ë†Î¸0 = 0 and Ë†f0 = 0. In
addition, we set Î³e = 0, âˆ€e âˆˆ E, which transform (23e) to

|Î“edT

(60)

e Î¸3| = 0 â†” Ï€e = 0.
Next, we show by contradiction that |Î“edT
e Î¸3| = 0 holds for
all e âˆˆ E only if ËœÎ¸2 = 0 = Î¸0. Suppose ËœÎ¸2 (cid:54)= 0, we must
have ËœB ËœÎ¸2 (cid:54)= 0, which leads to 0 (cid:54)= ËœÎ¸3 = Ïˆs( ËœB ËœÎ¸2, ËœD) and
thus Î›g ËœB ËœÎ¸3 (cid:54)= 0 due to the constraint (23c). The non-zero
Î›g ËœB ËœÎ¸3 implies that âˆƒe âˆˆ E such that Î“edT
e Î¸3 (cid:54)= 0. That is to
say, the constraint (24b) holds only when ËœÎ¸2 = Î¸0 = 0, which
indicates that the defender has to place PMUs to guarantee
that the only feasible solution to (23) is ac = 0. In another
word, Î² needs to satisfy âˆ€u âˆˆ V, xN,u = 1, which completes
the proof.

Theorem III.2. First, we introduce some deï¬nitions: B :=
{Î²|Ïˆa(Î²) = 0} denotes the set of
feasible solutions,
Bc := {Î²|Ïˆa(Î²) â‰¥ 1} the infeasible solutions, M(Bc) :=
{Î²|(Î², Î²(cid:48) âˆˆ Bc) âˆ§ (Î²(cid:48) â‰¥ Î²) â†’ (Î²(cid:48) = Î²)} the maximal
infeasible solutions, and P := { Ë‡Î² âˆˆ [0, 1]|V ||âˆ€Î² âˆˆ M(Bc) :

(cid:80)

u:Î²u=0

Ë‡Î²u â‰¥ 1} the polytope excluding all the maximal

infeasible solutions.

Then, based on the results in [45], we have the following

characterization:

Lemma H.1. The following statements hold:
{0, 1}|V | = B; (ii) âˆ€Î²(cid:48) âˆˆ M(Bc), (cid:80)
facet of P.

(i) P âˆ©
u=0 Î²u â‰¥ 1 deï¬nes a

u:Î²(cid:48)

u:Î²(cid:48)

1,u=0 Î²1,u = 0, which implies â„¦(Î²1) âŠ† â„¦(Î²(cid:48)

Proof. To prove statement (i), we ï¬rst prove that B âŠ†
(P âˆ©{0, 1}|V |) by contradiction. Suppose âˆƒÎ²1 âˆˆ B but Î²1 /âˆˆ P.
1 âˆˆ Bc such
Then by deï¬nition of P, there must exist Î²(cid:48)
that (cid:80)
1). By
Lemma III.1, we must have Î²1 âˆˆ Bc, which contradicts with
the assumption that Î²1 âˆˆ B. Thus, B âŠ† (P âˆ© {0, 1}|V |). Then,
we prove (P âˆ© {0, 1}|V |) âŠ† B by contradiction. Suppose there
exists Ë‡Î² âˆˆ (P âˆ© {0, 1}|V |) but Ë‡Î² /âˆˆ B, which implies that
Ë‡Î² âˆˆ Bc. That is to say, âˆƒ Ë‡Î²(cid:48) â‰¥ Ë‡Î² such that Ë‡Î²(cid:48) âˆˆ M(Bc). Then
by deï¬nition of P, we have (cid:80)
Ë‡Î²u â‰¥ 1. However, since
Ë‡Î²(cid:48) â‰¥ Ë‡Î², âˆ€u : Ë‡Î²u = 0, we must have Ë‡Î²u = 0 and leads to
(cid:80)
Ë‡Î²u = 0, which introduces contradiction. In summary,

u=0

u: Ë‡Î²(cid:48)

u: Ë‡Î²(cid:48)

u=0

P âˆ© {0, 1}|V | = B.

u: Ë‡Î²(cid:48)

(ii) by contradiction,

We then prove statement

i.e.,
âˆƒ Ë‡Î²(cid:48) âˆˆ M(Bc) such that when we remove the inequality
(cid:80)
u=0 Î²u â‰¥ 1 from P, we still have P. By deï¬nition of
M(Bc), we must have Ë‡Î²(cid:48) âˆˆ Bc, which implies (cid:80)
Ë‡Î²(cid:48)
u =
0, i.e., Ë‡Î²(cid:48) /âˆˆ P. That is to say, there exists some inequality
to cut Ë‡Î²(cid:48) out from P, i.e., âˆƒ Ë‡Î²(cid:48)(cid:48) âˆˆ M(Bc) and Ë‡Î²(cid:48)(cid:48) (cid:54)= Ë‡Î²(cid:48) such
that (cid:80)
u = 0. Notice that âˆ€u : ( Ë‡Î²(cid:48)(cid:48)
Ë‡Î²(cid:48)
u = 0),
which implies â„¦( Ë‡Î²(cid:48)) âŠ† â„¦( Ë‡Î²(cid:48)(cid:48)). By deï¬nition of M(Bc), we
u = Ë‡Î²(cid:48)
must have Ë‡Î²(cid:48)(cid:48)
u and
completes the proof.

u, which contradicts with Ë‡Î²(cid:48)(cid:48)

u = 0) â†’ ( Ë‡Î²(cid:48)

u (cid:54)= Ë‡Î²(cid:48)

u: Ë‡Î²(cid:48)(cid:48)

u =0

u=0

u: Ë‡Î²(cid:48)

We now prove Theorem III.2 based on Lemma H.1. First
notice that each Ë†Î² âˆˆ Bc will be enumerated at most once in
Alg. 1 due to the â€œno-goodâ€ constraints, and hence the algorithm
will converge in ï¬nite time. Then, consider an arbitrary Ë†Î²(cid:48)
obtained through (26). The generated â€œno-goodâ€ constraint
(cid:80)
i=0 Î²i â‰¥ 1 must be satisï¬ed by all the feasible solutions
in B, as any PMU placement violating this constraint must be
infeasible according to Lemma III.1. Finally, for any Î²1, Î²2 âˆˆ
B with (cid:107)Î²1(cid:107)0 < (cid:107)Î²2(cid:107)0, Î²1 will be found by Alg. 1 before Î²2,
since each guess of PMU placement is obtained by minimizing
(cid:107)Î²(cid:107)0 in (24), which completes the proof.

i: Ë†Î²(cid:48)

Theorem III.3. As Alg. 1 always returns a feasible solution
that defends against all attack pairs, we only need to prove
that the solution Î²1 returned by AODC requires the minimum
number of PMUs. We will prove this by contradiction.
Suppose that there exists Î²2 such that (cid:107)Î²2(cid:107)0 < (cid:107)Î²1(cid:107)0 and
Ïˆa(Î²2) = 0. Then Î²2 must be feasible to the instance of (31)
constructed based on the attack pairs {(a(k)
k=1 and
the maximal infeasible solutions { Ë†Î²
k=1 found by AODC
as it defends against all attacks. This contradicts with the fact
that Î²1 is optimal to (31).

p , e(k))}K

(cid:48)(k)}K

Lemma III.2. We ï¬rst observe that xN and xL are unique
under the constraints (16)-(17). Thus, we will use xN (Î²) and

19

xL(Î²) to denote the values of xN and xL satisfying (16)-(17)
for a given Î² âˆˆ {0, 1}|V |.

For a given attack pair (ap, e), ( Ë‡q1, Ë‡q2, Ë‡Î²) can be feasible

to (34) in two different cases. The ï¬rst case is that

(cid:88)

ap,e=1

xL,e((cid:100) Ë‡Î²(cid:101)) â‰¥ 1,

(61)

which makes (q1 = 0, q2 = 0, (cid:100) Ë‡Î²(cid:101), xN ((cid:100) Ë‡Î²(cid:101)), xL((cid:100) Ë‡Î²(cid:101)))
feasible for (30) with wa = 1.
The second case is

that xL,e((cid:100) Ë‡Î²(cid:101)) = 0 for all
e with ap,e = 1,
in which case we must have
( Ë‡q1, Ë‡q2, (cid:100) Ë‡Î²(cid:101), xN ((cid:100) Ë‡Î²(cid:101)), xL((cid:100) Ë‡Î²(cid:101))) feasible to (30) with wa = 0.
To prove this, we only need to show that

(cid:0)F3xN ((cid:100) Ë‡Î²(cid:101))(cid:1)T

Ë‡q2 â‰¤ F3 Ë‡q2.

(62)

According to (48), F3,i,u is either 0 or âˆ’MÎ¸, which together
with the fact that xN,u((cid:100) Ë‡Î²(cid:101)) â‰¥ 0 and Ë‡q2,i â‰¥ 0 implies that

(cid:0)F3xN ((cid:100) Ë‡Î²(cid:101))(cid:1)T

Ë‡q2 =

â‰¤

(cid:88)

uâˆˆV

(cid:88)

(cid:32) m2(cid:88)

xN,u((cid:100) Ë‡Î²(cid:101))

(cid:33)

F3,i,u Ë‡q2,i

(63)

(cid:32) m2(cid:88)

1

i=1

(cid:33)

F3,i,u Ë‡q2,i

= F3 Ë‡q2,

(64)

uâˆˆV

i=1

which completes the proof.

Theorem III.4. Under the assumption of Î¾p = O(1),
the
(cid:1)(cid:17)
number of possible attack pairs is |E|
â‰¤
Î¾p|E|Î¾p+1 = O (cid:0)|E|Î¾p+1(cid:1). Therefore, the time complexity
of solving (23) for a given Î² is polynomial in |E| and |V |,
since in the worst case (23) can be solved by checking the
feasibility of (28) for all the O (cid:0)|E|Î¾p+1(cid:1) attack pairs.

(cid:16)(cid:80)Î¾p
i=1

(cid:0)|E|
i

We ï¬rst characterize the complexity of Alg. 3. Since each
candidate placement â„¦i either has one more node or can defend
against all attack pairs in A after one iteration of the while loop,
Alg. 3 converges within |V | iterations. Each iteration of Alg. 3
is dominated by solving (35) (Line 8) for at most Kc times.
Since the numbers of variables and constraints of (35) are both
O((|E| + |V |)|A|) and |A| = O (cid:0)|E|Î¾p+1(cid:1), the complexity
of solving (35) is polynomial 3 in |V | and |E|. In summary,
the complexity of Alg. 3 is polynomial in |V |, |E|, and Kc
since it solves a polynomial-sized LP for at most Kc|V | times.
It is worth noting that the effect of KA and KL in Alg. 3â€™s
complexity is dominated by |V | and |E|. To see this, we note
that KL only appears in Line 7 of Alg. 3, in which we must
have KL â‰¤ |E|. Then, KA only appears in Line 9 of Alg. 3, in
which we must have KA â‰¤ |V |. Thus, we do not consider the
effect of KA and KL in Alg. 3â€™s computational complexity.

The complexity of Alg. 2 comes from: (i) solving (23)
O(|E|Î¾p+1) times (Line 3 and Line 12); (ii) solving (35) for
|A0| = O(|E|Î¾p+1) times (Line 5), each of which deals with
an LP containing O((|E| + |V |)|A0|) variables and constraints
and thus takes polynomial time; (iii) calling Alg. 3 at Line 8 for
1 time and at Line 14 for O(|E|Î¾p+1) times, whose complexity
is polynomial in |V |, |E|, and Kc. In summary, Alg. 2 is a
polynomial-time algorithm in terms of |V |, |E|, and Kc.

3The exact order depends on the speciï¬c algorithm used to solve LP [46].

Theorem IV.1. According to [33], [42] and (59), we have

20

| Ë†I3,f,e|2 =

1
|Ze|2

(cid:0)2( ËœZR,e Ë†p3,f,e + ËœZI,e Ë†q3,f,e) + Ë†v2

(1 + 2 ËœZR,e ËœGc,e âˆ’ 2 ËœZI,e ËœBc,e)Ë†v2
i
ËœBc,e Ë†q3,f,e) âˆ’ | ËœYc,e|2Ë†v2
i

kâˆ’
(cid:1) + 2( ËœGc,e Ë†p3,f,eâˆ’

(65)

for each e = (i, k) âˆˆ E with ap,e = 0. Based on (65)
and the assumption on (cid:15)Î¸ = ((cid:15)Î¸,u)uâˆˆV , (cid:15)v = ((cid:15)v,u)uâˆˆV ,
(cid:15)p = ((cid:15)p,e)eâˆˆE and (cid:15)q = ((cid:15)q,e)eâˆˆE, we can easily derive
an upperbound (cid:15)I,e â‰¥ || Ë†I3,e| âˆ’ |I3,e||, âˆ€e âˆˆ E. Speciï¬cally, we
can set

(cid:15)I,e :=

1
|Ze|2

(cid:0)2(| ËœZR,e|(cid:15)p,e + | ËœZI,e|(cid:15)q,e) + (cid:15)2

|1 + 2 ËœZR,e ËœGc,e + 2 ËœZI,e ËœBc,e|(cid:15)2
v,i
| ËœBc,e|(cid:15)q,e) + | ËœYc,e|2(cid:15)2

v,i.

v,i+
(cid:1) + 2(| ËœGc,e|(cid:15)p,e+

(66)

If there exists an successful attack pair (ap, e) that cannot
be found by Alg. 4 for a given PMU placement, we must have
one of the following cases:

1) There exists Ëœv2, ËœÎ¸2 such that |I3,e| > Î³eImax,e. In the
meantime, at least one of (57) and (58) are violated.

2) Let

3 , ËœÎ¸(1)

2 , Ëœv(1)

| Ë†I âˆ—
3,f,e| be the optimal solution of (36). There
exists Ëœv(1)
2 , ËœÎ¸(1)
3,e | > Î³eImax,e.
Let | Ë†I (1)
3,f,e| be the corresponding approximated solution
for Ëœv(1)
2 , ËœÎ¸(1)
3 . Then we must have Ë†Imax,e â‰¥
3,f,e| â‰¥ | Ë†I (1)
| Ë†I âˆ—

2 , Ëœv(1)
3,f,e|.

such that |I (1)

3 , ËœÎ¸(1)

3

We ï¬rst show that the case one can be avoided if we properly
set Î·3,p,i in (57) and Î·3,q,i in (58). Speciï¬cally, according to
(57), we must have

Di Ë†p3,f + Ë†v2
3,i

|V |
(cid:88)

k=1

ËœGik âˆ’ p0,i â‰¤ Î·3,p,i

(67)

if we set

Î·3,p,i â‰¥ (âˆ†ii âˆ’ 1)(cid:15)p,i + |

|V |
(cid:88)

k=1

ËœGik|(cid:15)v,i,

(68)

where (âˆ†ii âˆ’ 1) denotes the number of neighbors of node i
as deï¬ned in (16). Similarly, we can deï¬ne Î·3,q,i to avoid the
ï¬rst case. Then, we will show how to set Ë†Imax,e so that the
second case will not happen. In case two, we must have
3,f,e| â‰¥ |I (1)
Ë†Imax,e â‰¥ | Ë†I âˆ—

3,f,e| â‰¥ | Ë†I (1)

3,e | âˆ’ (cid:15)I,e > Î³eImax,e âˆ’ (cid:15)I,e
(69)

Thus, if we set Ë†Imax,e â‰¤ Î³eImax,e âˆ’ (cid:15)I,e, (69) cannot hold,
which rules out the possibility of case two. In summary, by
properly setting Î·3,p,i, Î·3,q,i and set Ë†Imax,e â‰¤ Î³eImax,e âˆ’ (cid:15)I,e,
a PMU placement that can pass the test of Alg. 4 will achieve
our defense goal.

