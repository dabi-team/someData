IEEE TRANSACTIONS ON INDUSTRIAL INFORMATICS, VOL. XX, NO. XX, XXXX

1

Attack Detection for Networked Control Systems
Using Event-Triggered Dynamic Watermarking

Dajun Du, Changda Zhang, Xue Li, Minrui Fei, and Huiyu Zhou

2
2
0
2

y
a
M
2

]

R
C
.
s
c
[

1
v
5
2
6
0
0
.
5
0
2
2
:
v
i
X
r
a

Abstract— Dynamic watermarking schemes can enhance
the cyber attack detection capability of networked con-
trol systems (NCSs). This paper presents a linear event-
triggered solution to conventional dynamic watermarking
(CDW) schemes. Firstly, the limitations of CDW schemes
for event-triggered state estimation based NCSs are investi-
gated. Secondly, a new event-triggered dynamic watermark-
ing (ETDW) scheme is designed by treating watermarking
as symmetric key encryption, based on the limit conver-
gence theorem in probability. Its security property against
the generalized replay attacks (GRAs) is also discussed in
the form of bounded asymptotic attack power. Thirdly, ﬁnite
sample ETDW tests are designed with matrix concentration
inequalities. Finally, experimental results of a networked
inverted pendulum system demonstrate the validity of our
proposed scheme.

Index Terms— Networked control systems, event-
triggered communication, cyber attack detection, dynamic
watermarking

I. INTRODUCTION

M ODERN networked control systems (NCSs) integrate

communication networks and smart sensors with phys-
ical plants and digital controllers (including digital ﬁlters) in
an effort to achieve satisfactory efﬁciency and productivity
over traditional control systems [1]–[3].

However, the wide introduction and usage of communica-
tion networks (especially wireless networks [4]) may bring
the following two essential problems. (1) NCSs security. Com-
pared with self-enclosed physical plants and digital controllers,
the cyber space of networks is open to real world, which makes
networks easy to access by malicious users. Recent years have
witnessed serious cyber threats to NCSs such as the attack on
U.S. fuel pipelines [5] and Stuxnet worm [6] on Iranian nuclear
facilities. (2) Energy scarcity. Speciﬁcally, when distributed
sensors for measuring plant performance communicates with

The work of D. Du, C. Zhang, X. Li, and M. Fei was sup-
ported in part by the National Science Foundation of China un-
der Grant Nos. 92067106, 61773253, 61803252, and 61833011,
111 Project under Grant No. D18003, and Project of Science and
Technology Commission of Shanghai Municipality under Grant Nos.
20JC1414000, 19510750300, 21190780300. (Corresponding authors:
Changda Zhang; Xue Li.)

D. Du, C. Zhang, X. Li, and M. Fei are with Shanghai Key Lab-
oratory of Power Station Automation Technology, School of Mecha-
tronic Engineering and Automation, Shanghai University, Shanghai
200444, China (e-mail: ddj@i.shu.edu.cn; changdazhang@shu.edu.cn;
lixue@i.shu.edu.cn; mrfei@staff.shu.edu.cn).

H. Zhou is with School of Computing and Mathematical Sci-
(e-mail:

ences, University of Leicester, Leicester LE1 7RH, U.K.
hz143@leicester.ac.uk).

digital controllers via a wireless network and are battery-
powered, the energy supply of sensors becomes limited and it
is usually not realistic to achieve frequent battery replacement.
It is widely known [7] that compared with data sampling,
data transmission for sensors equipped with radio modules
usually consumes more energy; e.g., the power consumption
of temperature sampling of sensor STCN75 produced by STM
is 0.4 mW, and the power consumption of data transmission
of radio module CC2420 produced by Texas Instruments is
35 mW (at 0dBm). In this context, it is not surprising that the
critical questions on NCSs security and energy scarcity have
attracted wide attention.

NCSs security can be greatly guaranteed by addressing the
problems of attack modelling and detection. A popular attack
is deception attack, which has a major type as replay attacks
[6]. A generalization of replay attacks is termed as generalized
replay attacks (GRAs) [8], [9], which is with simplicity of
implementation and has been applied in real-world attacks. It
has been found [10], [11] that both replay attacks and GRAs
have an ability of bypassing passive detection methods (e.g.,
the χ2 test), meanwhile destroying stability of systems with
unstable open-loop dynamics. To improve the attack detec-
tion capability of passive detection methods, active detection
methods have been widely investigated.

Dynamic watermarking is one particular active detection
method, which mainly includes CDW scheme [11]–[13] and
new dynamic watermarking (NDW) scheme [3], [14]. For
CDW scheme, the control or actuator signals are encrypted by
injecting a watermarking signal generally with Gaussian dis-
tributions. For NDW scheme, the before-transmission system
outputs are encrypted by injecting a watermarking signal, and
then the after-transmission system outputs are decrypted by
the same watermarking signal. For CDW and NDW scheme,
some hypothesis tests (e.g., χ2 test [11], KL divergence based
test [3] or consistent tests [12]–[14]) are used to detect cyber
attacks. Generally, the consistent tests are designed to be
asymptotic (i.e., with inﬁnite window sizes) at the beginning,
and then are transformed to be statistical (e.g., with ﬁnite
window sizes [8], [15] or ﬁnite samples [16]) for practical
use in real world.

Existing dynamic watermarking schemes have the following
two features. (1) Under no attack, nonzero system performance
loss is introduced by watermarking signals for CDW scheme,
while NDW scheme can guarantee zero system performance
loss. (2) For linear systems with time-triggered commutation
(TTC, i.e., periodic sampling and data transmission), the replay

 
 
 
 
 
 
2

IEEE TRANSACTIONS ON INDUSTRIAL INFORMATICS, VOL. XX, NO. XX, XXXX

TABLE I
COMPARISON BETWEEN THE EXISTING DYNAMIC WATERMARKING
SCHEMES AND OUR PROPOSED SCHEME.

Refs.1

DWF2

ECS3/ESO4/SPL5

LSF6

TCM7

LTV10
LTI12
LTI
LTI
LTI
LTI
LTI
LTI
LTI

Asym.8 & FWS9
FWS
Asym.
Asym. & FWS
FWS
Asym. & FIS13
FWS
Asym. & FWS
Asym. & FIS

"/%/"
[8]
"/%/"
[11]
"/%/"
[12]
"/%/"
[13]
"/%/"
[15]
"/%/"
[16]
%/"/%
[3]
%/"/%
[14]
†14
%/"/%
1References. 2Dynamic watermarking form.
3Encryption of control signal. 4Encryption of system outputs.
5System performance loss. 6Linear system form.
7Triggering communication modes. 8Asympototic. 9Finite window size.
10Linear time-varying. 11Time-triggering communication.
12Linear time-invariant. 13Finite sample.
14This paper. 15Event-triggered communication.

TTC11
TTC
TTC
TTC
TTC
TTC
TTC
TTC
ETC15

attacks detection capability increases with watermarking inten-
sity increasing for CDW scheme [11]; the detection of attacks
is guaranteed by the asymptotic CDW [12] and NDW schemes
[14]; the ﬁnite failure on GRAs detection is guaranteed by
the ﬁnite sample CDW scheme [16]; the detection of GRAs
is guaranteed by the asymptotic time-varying CDW scheme
[8]. In a word, existing dynamic watermarking schemes have
only focused on TTC. While TTC can be well-used for stable
operation and superior performance of systems, the use of TTC
may be limited by energy scarcity.

Energy scarcity compels some energy-recharging solutions
[17] (e.g., energy harvesting and transferring) or energy-saving
solutions to be extensively used, where specially the energy-
saving solutions are indispensable when there are no other
resources (e.g., wind and solar power) for recharging energy.
Event-triggered communication (ETC) [3], [18], [19] is one
popular energy-saving solution, where the sampled data will be
sent through networks immediately when a predeﬁned event-
triggered condition is violated at a certain time instant. Spe-
cially, if the state of physical plants is partially available, the
event-triggered state estimation (ETSE) [20], [21] developed
from the standard Kalman ﬁlter is commonly used to obtain the
state estimate. The primary advantage of ETC compared with
TTC is saving energy, meanwhile maintaining the comparable
performance of systems [3]. While ETC provides the above
advantages, existing dynamic watermarking schemes may not
always be applicable for ETC.

Motivated by the above observations, the following chal-

lenges will be addressed:

(1) What are the limitations of CDW scheme for ETSE-

based NCSs?

(2) How to design a new dynamic watermarking scheme
for ETSE-based NCSs? What is the security property of
such scheme?

(3) For the new dynamic watermarking scheme, how to de-
sign new statistical tests available for real-world ETSE-
based NCSs?

To deal with these challenges, this paper extends CDW
scheme into a new event-triggered dynamic watermarking
(ETDW) scheme. Compared with the existing results in the
literatures, comparative analysis is listed in Table I. It can
be clearly found that the existing results have only focused on
dynamic watermarking scheme for TTC, but the proposed new
ETDW scheme pays its attention to dynamic watermarking
scheme for ETC. The main contributions of this paper are
summarized as follows:

(1) The limitations of CDW scheme for ETSE-based NCSs
are revealed, where there are system performance loss
from watermarking signals and event-triggered covari-
ance of signals used for attack detection;

(2) A new ETDW scheme is designed by treating water-
marking as symmetric key encryption, based on limit
convergence theorem in probability. Furthermore, the
security property of such scheme is proven that the
asymptotic power of undetected GRAs is guaranteed to
be not more than the power of attack-free residuals.
(3) Two new ﬁnite sample ETDW tests are designed by
using matrix concentration inequalities. Furthermore, the
attack detection capability of such tests is proved with
ﬁnite false alarm under no attack and ﬁnite failure on
GRAs detection.

The rest of this paper is organized as follows. Section II is
problem formulation, where ETSE-based systems with CDW
scheme under the GRAs and limitations of CDW scheme are
analysed. Section III presents a new ETDW scheme, where the
design, security property analysis, and performance analysis of
our proposed approach are presented. Experimental results for
a networked inverted pendulum system are given in Section IV,
followed by the conclusion in Section V.

Notation: The Euclidean norm of a vector x is denoted as
kxk. The spectral norm and spectral radius of a matrix X are
denoted as kXk and ρ(X), respectively. Multivariate Gaussian
distribution with mean µ and covariance E is denoted N (µ, E).
The expectation of a random variable a conditional on the
variable b is denoted E[a|b]. Given two events E1 and E2, the
probability of E1 conditional on E2 is denoted P(E1|E2) and
the inverse event of E1 is denoted ¬E1. Table A.II of Section I
in the supplementary materials summarizes the notations most
frequently used throughout the rest of the paper.

II. PROBLEM FORMULATION

A. ETSE-Based NCSs with CDW Scheme

The general framework of ETSE-based NCSs with CDW
scheme is shown in Fig. 1. The system output y(k) is ﬁrstly
measured by the sensor periodically. After having received
y(k), the trigger generates a binary triggering signal γ(k) by
the preset triggering condition and then accordingly decides
whether or not y(k) is sent to the network; as a consequence,
y(k) becomes ¯y(k). Then, ¯y(k), γ(k) will be transmitted to
the event-triggered estimator and the CDW detector via the
network, which may be attacked and become ¯ya(k), γ(k).
Using received ¯ya(k), γ(k) and the control input u(k − 1), the
event-triggered estimator calculates the a priori state estimate
ˆx(k|k − 1), a posteriori state estimate ˆx(k|k), prediction error

DU et al.: ATTACK DETECTION FOR NETWORKED CONTROL SYSTEMS USING EVENT-TRIGGERED DYNAMIC WATERMARKING

3

ay k

  !"

  !
k 

Deﬁnition 1: The asymptotic attack power is deﬁned as, cf.

  !w k

  !
v k

 !"##$!

 &’(

  !k 

’ (a k

 !"#$"%&

 !"#$

%&#’()

* +
y k

  !
y k

2 3u k

) *
cu k

  !
d k

 !"#$%

d k
0 1

 z  

0/’(!/11$!

u k  

!"

’(
)
x k k

*

 !"#$%&

%&$’()(!"##$!$*+
$,("-.(/!

ay k

  !"

  !
k 

P 
%
!

k k

"#
x k k

d k

 kz  ! !

P
!$%
k k
k ! !

!"

 !"#$%$&’(("&")*
+,-*)"$".$/&

Fig. 1. Framework of ETSE-based NCSs with CDW scheme.

covariance Pk|k−1 and upper bound ¯Pk|k of estimation error
covariance. Furthermore, using ˆx(k|k − 1), Pk|k−1, ¯Pk|k and
watermarking signal d(k − k′ − 1) generated by GenCDW,
the event-triggered CDW detector judges whether or not an
attack takes place; if yes, the alarm will sound, otherwise the
alarm keeps silence. Furthermore, using ˆx(k|k), the controller
calculates uc(k), which is encrypted by d(k) and becomes
u(k). Finally, the actuator applies u(k) to stabilizing the plant.
Remark 1: It is not necessary to transmit γ(k) in real world.
The event-triggered estimator and the CDW detector have the
ability to judge whether or not a data packet is received, e.g.,
by the mechanism of TCP-ACK transmission [22].

To analyse the limitations of CDW scheme for ETSE-based
NCSs, we consider a discrete-time linear time-invariant plant

y(k) = Cx(k) + v(k)

x(k + 1) = Ax(k) + Bu(k) + w(k),

(1)
(2)
where x(k) ∈ Rnx, u(k) ∈ Rnu and y(k) ∈ Rny are the
system state, control input and system output at k-th sampling
instant, respectively; the process noise w(k) and measurement
noise v(k) are mutually independent and take the distribution
form w(k) ∼ N (0, Ew), v(k) ∼ N (0, Ev). A, B and C are
constant matrices with appropriate dimensions.

1) ETC with Send-on-Delta Condition: The send-on-delta
condition for ETC is used to send y(k). To formulate the send-
on-delta condition, a triggering signal γ(k) is deﬁned by

γ(k) :=

1, if ǫT (k)ǫ(k) > δ
0, otherwise

(

(3)

where ǫ(k) := y(k)−y(τk) is the difference between y(k) and
the previously transmitted measurement y(τk) (and τk < k);
δ > 0 is the user-deﬁned event-triggered threshold. Note that
if and only if γ(k) = 1, then y(k) will be sent via the network.
Consequently, the network’s input becomes

¯y(k) = y(k) − (1 − γ(k)) ǫ(k).

(4)

2) The GRAs: ¯y(k) could be compromised by cyber attacks
from the network. Note that if and only if there is no any
attack, then ¯ya(k) = ¯y(k). When there is a persistent event-
triggered version of GRAs [8], ¯ya(k) can be formulated by

¯ya(k) = ¯y(k) + a(k),
a(k) = γ(k) (s¯y(k) + Cxa(k) + va(k)) ,

xa(k + 1) = Aaxa(k)

(5)
(6)

(7)

where a(k) is the false data with respect to γ(k) and generated
by the hidden Markov model (6) and (7); s ∈ R is called
the attack scaling factor; xa(k) ∈ Rnx is the hidden state
of GRAs; the noise va(k) takes the distribution of va(k) ∼
N (0, Eva), and va(k) is mutually independent with v(k),
w(k); Aa is Schur stable, i.e., ρ(Aa) < 1.

To further quantify the persistent additional distortion from

GRAs, we consider the following Deﬁnition 1.

[13],

as-lim
i→∞

1
i

i

k=1

aT (k)a(k)

X
where as-lim represents the almost sure limit, or, cf. [8],

p-lim
i→∞

1
i

i

k=1

aT (k)a(k)

where p-lim represents limit in probability.

X

(8)

(9)

3) ETSE with Send-on-Delta condition: Using ¯ya(k), γ(k)
and u(k − 1), an event-triggered estimator can be designed to
estimate system states for calculating control input, i.e.,

ˆx(k|k − 1) = Aˆx(k − 1|k − 1) + Bu(k − 1),
ˆx(k|k) = ˆx(k|k − 1) + L(k, γ, δ)r(k)

(10)

(11)

where r(k) := ¯ya(k) − C ˆx(k|k − 1) is the residual (or in-
novation); L(k, γ, δ) is the event-triggered estimator gain and
can be designed according to Theorem A.1 of Section II.A in
the supplementary materials.

4) Controller and CDW Scheme: Using ˆx(k|k) generated
by the above event-triggered estimator, the controller output
can be calculated by minimizing linear quadratic Gaussian
performance J [11], and the optimal solution is

uc(k) = K ˆx(k|k)
−1

(12)

BT SB + R

BT SA is the controller gain;
where K = −
S is the unique positive deﬁnite solution of algebraic Riccati
equation S = AT SA + Q − AT SB
BT SA;
Q and R are the designed constant matrices. Furthermore, to
detect cyber attacks, uc(k) is encrypted by injecting d(k), i.e.,

BT SB + R

−1

(cid:0)

(cid:0)

(cid:1)

(cid:1)

u(k) = uc(k) + d(k)

(13)

where d(k) ∼ N (0, Ed) is independent of uc(k), and Ed is
full rank.

The ETSE-based NCSs with CDW scheme have been well
partially established as (1)–(7) and (10)–(13), where there are
still attack detection formulas remaining to be designed. Then,
two asymptotic CDW tests have been designed [13] and the
corresponding security property restricting the attack power
(8) of undetected attacks to zero is given in Theorem A.2 of
Section II.C in the supplementary materials.

Remark 2: The above event-triggered estimator (10), (11)
and controller (13) can theoretically satisfy the state limitation,
i.e., if ρ (A + BK) < 1 and ρ ((I − L(k, γ, δ)C)A) < 1, then
∃ς < ∞, it follows that limk→∞E [kx(k)k] < ς, where the
proof is given in Section II.B of the supplementary materials.
Moreover, in the experiments of Section IV, appropriate Q
and R are selected to guarantee ρ (A + BK) < 1, and proper
δ is also selected to guarantee ρ ((I − L(k, γ, δ)C)A) < 1,

 
 
 
 
 
 
4

IEEE TRANSACTIONS ON INDUSTRIAL INFORMATICS, VOL. XX, NO. XX, XXXX

+ ,w k

  !
v k

  !k 

 !"#$"%&

 !"#$

%&#’()

* +
y k

’ (
y k

  !
nd k
!

y

k 
  !

’ (a k

 !"##$!

 ! "#$

%&’(

  !u k

2 3u k

u k  
)

*+

 z  

  !
nd k

 !"# $

 !"#$%&’&(’)*

"% 

!

# $
x k k
n
P
n k k
!

P 
"

n k k
!

0/’(!/11$!

  !
nx k k

"

#

%&$’()(!"##$!$*+$,("-.(/!

 !"#$%&
!
  !"
ay
k
  !
nd k

  !
k 

"

!

ay

  !"
k

  !
k 

!

ay

% &’
k

% &
k 

Fig. 2. Framework of ETSE-based NCSs with new ETDW scheme.

meanwhile Q, R and δ are carefully regulated so that the
system states do not exceed the limitation.

Remark 3: The inﬁnite limits i → ∞ in the asymptotic
CDW tests (A.14) of Section II.C in the supplementary ma-
terials are not well suited for real-time attack detection. To
deal with the problem, the ﬁnite sample CDW tests [16] have
been transformed from the asymptotic CDW tests (A.14) of
Section II.C in the supplementary materials, where two events
are deﬁned by

Remark 4: From limitations 1 and 2, it can be clearly seen
that there are three main problems of CDW scheme for ETSE-
based NCSs to be solved: 1) bigger Ed brings more ∆J;
2) the asymptotic CDW tests (A.14) of Section II.C in the
supplementary materials may not be used; and 3) the ﬁnite
sample CDW tests (14) may also not be used. To overcome
limitations 1 and 2, it is necessary to develop a new attack
detection scheme.

1
i
1
i

(cid:26)(cid:13)
(cid:13)
(cid:13)
(cid:13)
(cid:26)(cid:13)
(cid:13)
(cid:13)
(cid:13)

(cid:0)

Ξ1,i :=

Ξ2,i :=

Di

> ϑ1,i

,

(cid:13)
(cid:13)
(cid:13)
Ri − iE f
(cid:13)
r

(cid:27)

> ϑ2,i

(14a)

(14b)

where ϑ1,i and ϑ2,i are time-varying threshold functions.
Furthermore, deﬁne Ξi := {Ξ1,i ∪ Ξ2,i}, and if Ξi is true,
then the attack will be alarmed at the i-th sampling instant,
otherwise the alarm keeps silence.

(cid:27)

(cid:13)
(cid:13)
(cid:1)
(cid:13)
(cid:13)

B. Limitations of CDW Scheme for ETSE-Based NCSs

The above discussion is for ETSE-based NCSs with CDW
scheme. However, due to the introduction of watermarking
signals and ETSE, there are two limitations of CDW scheme
for ETSE-based NCSs.

Limitation 1–System Performance Loss From Watermark-
ing: Considering the system (1)–(7) and (10)–(13) under no
attacks or trigger (i.e., a(k) = 0, γ(k) = 1, ∀k > 0), then the
system performance loss is, cf. [11, Th. 3],

∆J = tr

(BT SB + R)Ed

(15)

where S and R have been given in (12).

(cid:0)

(cid:1)

Limitation 2–Event-Triggered Covariance: Considering the
system (1)–(7) and (10)–(13) under no attack (i.e., a(k) =
0, ∀k > 0), the cross covariance of r(k) and d(k − 1), and the
auto covariance of r(k) satisfy

E

r(k)dT (k − 1)
E
r(k)rT (k)

γ(k)

= (γ(k) − 1) CBEd,
6 Ψβ (k, γ, δ)

(cid:2)

γ(k)
(cid:3)
where Ψβ (k, γ, δ) is the same as (A.3) of Section II.A in the
(cid:3)
supplementary materials. The proof is given in Section II.D
of the supplementary materials.

(16b)

(cid:12)
(cid:12)
(cid:12)
(cid:12)

(cid:2)

(16a)

III. NEW EVENT-TRIGGERED DYNAMIC WATERMARKING

The above has presented the framework of ETSE-based
NCSs with CDW scheme, and analysed the corresponding two
limitations. To cope with the limitations, a new ETDW scheme
is designed and analysed from asymptotic form to ﬁnite sample
form. As a comparison, a candidate ETDW scheme is designed
and analysed in Section III.A of the supplementary materials.

A. Design and Security Property Analysis of New ETDW
Scheme for ETSE-Based NCSs

a (k), γ(k). Then, ¯y+

The designed framework of ETSE-based NCSs with new
ETDW scheme is shown in Fig. 2. Firstly, y(k) is measured by
the sensor periodically. After having received y(k), the trigger
generates γ(k) by (3) and then accordingly decides whether
or not y(k) is sent to the network; as a result, y(k) becomes
¯y(k). Secondly, ¯y(k) is encrypted by injecting dn(k) that
is generated by EnENDW, becoming ¯y+(k). Thirdly, ¯y+(k),
γ(k) are transmitted to the event-triggered estimator and the
ETDW detector via the network, which may be attacked and
become ¯y+
a (k) is decrypted by subtracting
dn(k) that is generated by DeENDW, becoming ¯y−
a (k). Using
received ¯y−
a (k), γ(k) and u(k − 1), the event-triggered esti-
mator calculates ˆxn(k|k − 1), ˆxn(k|k), Pn,k|k−1 and ¯Pn,k|k.
Furthermore, using ˆxn(k|k − 1), Pn,k|k−1, ¯Pn,k|k and dn(k),
the ETDW detector evaluates whether or not an attack takes
place; if yes, the alarm will sound, otherwise the alarm keeps
silence. Furthermore, using ˆxn(k|k), the controller calculates
u(k), which is applied by the actuator to stabilizing the plant.
1) Design of Watermarking as Symmetric Key Encryption,
Event-Triggered Estimator and Controller: Consider the plant
and trigger (1)–(4). To monitor the information integrity and

 
 
 
 
DU et al.: ATTACK DETECTION FOR NETWORKED CONTROL SYSTEMS USING EVENT-TRIGGERED DYNAMIC WATERMARKING

5

protect the information conﬁdentiality, ¯y(k) is encrypted by
dn(k), becoming

Proof: The proof is given in Section III.C of the supple-

mentary materials.

¯y+(k) = ¯y(k) + dn(k)

(17)

where dn(k) ∼ N (0, Edn) is independent of ¯y(k), and Edn is
with full rank. Under the GRAs, ¯y+(k) becomes

¯y+
a (k) = ¯y+(k) + a(k),
a(k) = γ(k)
xa(k + 1) = Aaxa(k).

(cid:0)

s¯y+(k) + Cxa(k) + va(k)

,

(18)

(cid:1)

To prevent the watermarking signal exciting the system oper-
ation, ¯y+

a (k) is decrypted by dn(k), becoming

a (k) = ¯y+
¯y−

a (k) − dn(k).

(19)

For now, the mechanism of watermarking as symmetric key
encryption (17) and (19) is completed, which has been devel-
oped in [14], and guarantees attack-free and trigger-free

∆J = 0.

(20)

Using ¯y−

a (k), the event-triggered estimator is designed as

ˆxn(k|k − 1) = Aˆxn(k − 1|k − 1) + Bu(k − 1),
ˆxn(k|k) = ˆxn(k|k − 1) + Ln(k, γ, δ)rn(k)

(21)

(22)

where rn(k) := ¯y−
like L(k, γ, δ), i.e.,

a (k)−C ˆxn(k|k−1); Ln(k, γ, δ) is designed

Ln(k, γ, δ) = (1 + β1 (1 − γ(k))) Pn,k|k−1

×CT Ψ−1

n,β (k, γ, δ) ,

Pn,k|k−1 = APn,k−1|k−1AT + Ew,

(23)

(24)

(cid:1)
(26)
, en(k|k −
γ(k)

Ψn,β (k, γ, δ) = (1 + β1 (1 − γ(k))) CPn,k|k−1CT
(25)
1 + β−1
δI,
+ (1 + β2 (1 − γ(k))) Ev + (1 − γ(k))
¯Pn,k|k = (1 + β1 (1 − γ(k))) (I − Ln(k, γ, δ)C) Pn,k|k−1,

1 + β−1
2

(cid:0)

and Pn,k|k−1 := E
γ(k)
1) := x(k)−ˆxn(k|k−1); Pn,k|k := E
en(k|k)eT
(cid:12)
(cid:2)
and en(k|k) := x(k) − ˆxn(k|k), Pn,k|k ∼= ¯Pn,k|k.
(cid:12)

en(k|k − 1)eT

n (k|k − 1)

n (k|k)
(cid:3)

(cid:3)
To ensure the stability of the plant, using ˆxn(k|k) from
the above event-triggered estimator, the control signal (13)
deployed by actuator can be re-written as

(cid:2)

(cid:12)
(cid:12)

u(k) = K ˆxn(k|k).

(27)

2) Design of New Asymptotic ETDW Tests: From the design
so far, the new ETDW scheme for ETSE-based NCSs has been
completed partially, where there are attack detection formulas
remaining to be designed. To design attack detection formulas,
the features of rn(k) and dn(k) under no attack are presented
in the following Theorem 1.

Theorem 1: Considering the system (1)–(4) and (17)–(27)
under no attack (i.e., a(k) = 0, ∀k > 0), the cross covariance
of rn(k) and dn(k), and the auto covariance of rn(k) satisfy

E

E

(cid:2)

rn(k)dT
rn(k)rT

n (k)
n (k)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

γ(k)

γ(k)
(cid:3)

= 0,
6 Ψn,β (k, γ, δ)

(28a)

(28b)

where Ψn,β (k, γ, δ) is the same as (25).

(cid:3)

(cid:2)

Using (28) in Theorem 1, meanwhile according to the limit
convergence theorem in probability [8, Th. A.6], two new
asymptotic ETDW tests can be designed as

p-lim
i→∞

p-lim
i→∞

1
i
1
i

Dn,i = 0,

Rn,i 6 Ψn,β (k, γ, δ)

(29a)

(29b)

:=

i
k=1 rn(k)dT

n (k) and

where the summations are Dn,i
i
k=1 rn(k)rT
Rn,i :=

n (k).

P

P

Remark 5: The new ETDW tests (29) with the mechanism
of watermarking as symmetric key encryption (17) and (19)
can detect denial-of-service (DoS) attacks and replay attacks,
where the proofs are given in Section III.C of the supplemen-
tary materials. Furthermore, the new ETDW tests against other
types of attacks can be investigated in future work.

3) Security Property of New Asymptotic ETDW Tests: Now,
the new ETDW scheme for ETSE-based NCSs is completed.
The security property of new ETDW scheme is analysed in
the following Theorem 2.

Theorem 2: Considering the system (1)–(4) and (17)–(27),
if both (29a) and (29b) are true, then the asymptotic attack
power of GRAs is constrained by

p-lim
i→∞

1
i

X

i

k=1

aT (k)a(k) 6 tr (Ψn,β (k, γ, δ))

(30)

where Ψn,β (k, γ, δ) is the same as (25).

Proof: The proof is given in Section III.D of the supple-

mentary materials.

Remark 6: Unlike the zero asymptotic power of undetected
attacks from trigger-free CDW scheme in Theorem 2, Theorem
3 reveals that with new ETDW scheme used, the asymptotic
power of undetected GRAs is not more than the power
tr (Ψn,β(k, γ, δ)) of attack-free rn(k).

B. Design and Attack Detection Performance Analysis of
New Finite Sample ETDW Tests for ETSE-Based NCSs

We have established a new ETDW scheme for ETSE-based
NCSs and analysed its security property. However, the new
asymptotic ETDW tests used for new ETDW scheme requires
the inﬁnite limit i → ∞ that is unrealistic. To solve the
problem, the new ﬁnite sample ETDW tests for ETSE-based
NCSs are designed and its attack detection performance is
analysed as follows.

1) New Ideal Finite Sample ETDW Tests: To construct ﬁnite
sample ETDW tests, three necessary conditions are required:

c1) Make i ﬁnite;
c2) The summation Dn,i and Rn,i need to be formulated;
c3) To use matrix concentration inequality [16, Prop. 1],

zero-mean matrices need to be deﬁned.

To satisfy the conditions (c1)–(c3), one of the solutions is
to derive the expectation of Dn,i or Rn,i from Dn,i or Rn,i

6

IEEE TRANSACTIONS ON INDUSTRIAL INFORMATICS, VOL. XX, NO. XX, XXXX

respectively, i.e.,

1
i
1
i

Dn,i −

(cid:18)

Rn,i −

(cid:18)

i

k=1

E

rn(k)dT

n (k)

γ(k)

X

i

k=1

(cid:2)

E

rn(k)rT

(cid:12)
(cid:12)
n (k)

,

.

(31)

(32)

(cid:19)
(cid:3)
γ(k)

(cid:19)
(cid:3)

X

(cid:2)
Note that (31) and (32) meet the conditions (c1)–(c3) well.
Following Theorem 3, we substitute (28a) and (28b) into (31)
and (32) respectively, then,

(cid:12)
(cid:12)

1
i
1
i

Dn,i −

(cid:18)

Rn,i −

(cid:18)

i

k=1

X

i

X

k=1

1
i

E

rn(k)dT

n (k)

γ(k)

(cid:2)

E

rn(k)rT

(cid:12)
(cid:12)
n (k)

(cid:19)
(cid:3)
γ(k)

1
i

=

>

Dn,i,

(33)

(cid:2)
Rn,i −

(cid:18)

i

(cid:12)
(cid:12)
k=1

X

(cid:19)
(cid:3)
Ψn,β (k, γ, δ)

.

(34)

(cid:19)

It can be seen from (28a) that E [ Dn,i| γ(k)] = 0 in (33),
but the expectation of the right-hand side of (34) is not zero,
which is against the condition (c3), i.e., prevents us from using
matrix concentration inequality to develop new ﬁnite sample
ETDW tests.

To cope with the non-zero expectation of the right-hand side
of (34), let us ﬁrstly focus on the following proposition: If and
only if (28a) is true, then ∃Xn > 0,

E

rn(k)rT

n (k)

γ(k)

+ Xn = Ψn,β (k, γ, δ) .

(35)

(cid:2)

(cid:12)
The proof is omitted.
(cid:12)

(cid:3)
Using (35), we can deﬁne a zero-mean matrix:

˜RXn

n,i := Rn,i −

i

k=1

Ψn,β (k, γ, δ) + iXn

(36)

˜RXn
n,i

X
where E
= 0. Substituting (36) into the left-
hand side of (34) and then using proposition 1, the left-hand
(cid:12)
(cid:12)
side of (34) can be re-written as
(cid:12)

γ(k)

h

i

Rn,i −

1
i

(cid:18)

i

k=1

X

(cid:2)

E

rn(k)rT

n (k)

γ(k)

=

1
i

˜RXn
n,i .

(37)

For now, (33) and (37) satisfy conditions (c1)–(c3). Further-
more, based on the matrix concentration inequality and using
(33) and (37), the new ideal ﬁnite sample ETDW tests can be
given by the following two events:

(cid:19)
(cid:3)

(cid:12)
(cid:12)

1
i
1
i

Ξn,1,i :=

Dn,i

> ˜ϑn,1,i

γ(k)

,

(38a)

ΞXn

n,2,i :=

(cid:13)
(cid:13)
˜RXn
(cid:13)
(cid:13)
n,i
(cid:13)
(cid:13)
where detection thresholds ˜ϑn,1,i
(cid:13)
(cid:13)
and ˜ϑn,2,i :=
are positive scalers.

(cid:12)
(cid:12)
> ˜ϑn,2,i
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(1 + ιn,1)κn,1ln i/i
(cid:12)
(1 + ιn,2)κn,2ln i/i, and ιn,1, ιn,2, κn,1, κn,2
p

(cid:26) (cid:13)
(cid:13)
(cid:13)
(cid:13)
(cid:26) (cid:13)
(cid:13)
(cid:13)
(cid:13)

(38b)

γ(k)

:=

(cid:27)

(cid:27)

2) New Adding-Threshold Finite Sample ETDW Tests: Even
though the above new ideal ﬁnite sample ETDW tests seem to
resolve the considered problem directly, there is still a huge
gap between (38) and the desired ﬁnite sample ETDW tests.
This is because Xn used in (38b) is unknown and thus it
is impossible to achieve the calculation of (38b) in general.
Yet, we observe that the concept of subset will help to cope
with the considered situation. Speciﬁcally, a subset of (38b)

p

allows us to eliminate the matrix Xn by adding an adjustable
real threshold. Motivated by this, we will construct the new
adding-threshold ﬁnite sample ETDW tests.

the part of ˜RXn

To design the adding-threshold ﬁnite sample ETDW tests,
n,i in (36) without Xn is deﬁned as
i

˜Rn,i := Rn,i −

Ψn,β (k, γ, δ)

(39)

k=1

n,i = ˜Rn,i + iXn. The
is given in the following

and thus (36) can be re-written as ˜RXn
relation between ˜RXn
Lemma 1.

n,i and ˜Rn,i

X

Lemma 1: For ˜Rn,i and ˜RX

n,i, there are two cases:
1
i

i) If

ii) If

˜RXn
n,i

1
˜Rn,i
i
1
˜Rn,i
(cid:13)
(cid:13)
i
(cid:13)
˜ϑn,2,i or
(cid:13)
(cid:13)
(cid:13)
where ℑn = kXnk.

> ˜ϑn,2,i + ℑn, then
< ˜ϑn,2,i +ℑn, it is possible that
(cid:13)
(cid:13)
(cid:13)
(cid:13)
(cid:13)
(cid:13)
1
˜RXn
(cid:13)
(cid:13)
n,i
i
(cid:13)
(cid:13)
(cid:13)
(cid:13)

> ˜ϑn,2,i

(cid:13)
(cid:13)
(cid:13)

(cid:13)
(cid:13)
(cid:13)

> ˜ϑn,2,i;
1
˜RXn
n,i
i

(cid:13)
(cid:13)
(cid:13)

(cid:13)
(cid:13)
(cid:13)

<

Proof: The proof is given in Section III.E in the supplemen-

tary materials.

According to Lemma 1, the adding-threshold ﬁnite sample

ETDW tests can be given by (38a) and

1
i

Ξn,2,i :=

˜Rn,i

> ˜ϑn,2,i + ˜ℑn

γ(k)

(40)

(cid:26) (cid:13)
(cid:13)
(cid:13)
(cid:13)

(cid:13)
(cid:13)
where the added threshold ˜ℑn > 0 is used to approximate
(cid:13)
(cid:13)
ℑn and needs to be carefully designed, and the detection
threshold functions ˜ϑn,1,i and ˜ϑn,2,i have been given in (38).
Furthermore, we can deﬁne

(cid:12)
(cid:12)
(cid:12)
(cid:12)

(cid:27)

Ξn,i := {Ξn,1,i ∪ Ξn,2,i} .

(41)

We expect that if Ξn,i is true, the attack will be alarmed at
i-th sampling instant; if ¬Ξn,i is true, there is no attack alarm.
3) False Alarm Analysis under no Attack and Detection Per-
formance Analysis for the GRAs of New Adding-Threshold Finite
Sample ETDW Tests: We have fully addressed the new adding-
threshold ﬁnite sample ETDW tests. The false alarm under no
attack of such tests is analysed in the following Theorem 3.(i)
based on Lemma 1, and the GRAs detection performance of
such tests is presented in the following Theorem 3.(ii).

Theorem 3: Considering the system (1)–(4) and (17)–(27):
i) If there is no attack (i.e., a(k) = 0, ∀k > 0), kw(k)k <

∞, kv(k)k < ∞, and ˜ℑd = kXnk, then

P

lim sup
i→∞

(cid:18)

Ξn,i

= 0

(cid:19)

(42)

ii) If the GRAs do not satisfy (30), kw(k)k < ∞, kv(k)k <

∞, and ˜ℑd = kXnk, then

P

lim sup
i→∞

(cid:18)

¬Ξn,i| s

= 0.

(43)

Proof: The proof is given in Section III.F of the supplemen-

(cid:19)

tary materials.

Remark 7: As an event-triggered extension of ﬁnite sample
CDW tests (14) [16, Thms. 5 and 7], Theorem 3 reveals that i)
under no attack, the new adding-threshold ﬁnite time ETDW
tests will trigger only ﬁnite number of attack alarms for ETSE-
based NCSs, and ii) the new adding-threshold ﬁnite sample
ETDW tests cannot detect the GRAs going against (30) only

DU et al.: ATTACK DETECTION FOR NETWORKED CONTROL SYSTEMS USING EVENT-TRIGGERED DYNAMIC WATERMARKING

7

visual servo systems (NIPVSSs) [25] with new and candidate
ETDW scheme in Section II of the supplementary materials
is considered, as shown in Fig. 3.

&’#(!#)"

A. Platform of NIPVSS

*%+,(-($

 !$%"!

 !"#

+,+-./
.$+-./
0$,1./
+2’3!"’)*
.$’$&’)*
1),’*)44$*

 !"#$

 !"#$

% &k 

  !
nd k

  !
y k

y k
5 6

k 
  !

y

%&’("’)*

 !"#$

. /u k

  !
nx k k

"

#

k 
  !
ay

k 
  !
ay

  !
nd k

!

 !"#$

  !k 

  !
y k

y k
+ ,

  !u k

  !
cu k

 !
"
x k k

#

% &
ay k

%&’("’)*

  !
d k

Fig. 3.
Experimental platform of NIPVSSs with new and candidate
ETDW scheme. NETDW: New ETDW scheme. CETDW: Candidate
ETDW scheme.

The discrete-time system state of NIPVSSs is denoted as
x(k) :=
, where α(k) and θ(k) are
the cart position and pendulum angle at k-th sampling instant,
respectively. The state-space model of NIPVSSs is

α(k); θ(k); ˙α(k); ˙θ(k)
i
h

A = 

0

1
0 1.0015
0
0 0.2945

0

0.0100
0
1
0

0
0.0100
0
1.0015



, B = 



0
0.0002
0.0100
0.0300











0, 0, 10−5, 10−5
and the covariance of w(k) is Ew = diag
.
The system output is y(k) = [α(k); θ(k)], thus C = [I, 0]; the
(cid:9)
covariance of v(k) is Ev = diag
.

2.7 × 10−7, 5.5 × 10−6





(cid:8)

(cid:9)

(cid:8)

The trigger (3) is set as δ = 0.00001. The event-triggered
estimators (10), (11), (21) and (22) are set as P−1|−1 =
Pn,−1|−1 = 0, β1 = β2 = 0.02. By selecting Q =
diag{10, 10, 10, 10} and R = 1, the controllers (13) and (27)
are designed as K = [2.8889, −36.6415, 4.9141, −7.3267]. To
analyse the power of the GRAs, a quantity of attack power is
i
deﬁned as A(i) = 1
k=1 aT (k)a(k).
i
Considering the limits of reality, there are two bounds:
|α(k)| 6 0.3m, |θ(k)| 6 0.8rad. Once one of the above two
bounds is crossed, the servo motor of NIPVSSs will be put
“OFF”, i.e., NIPVSSs will get out of control.

P

a ﬁnite number of numbers for ETSE-based NCSs, i.e., the
GRAs going against (30) can be always detected by such tests.
Remark 8: It is difﬁcult to yield ˜ℑn = kXnk because we
do not know the value of Xn. But then, by performing multiple
attack-free experiments on the system, an appropriate ˜ℑd can
be selected so that the false alarm under no attack is avoided
as much as possible, which is shown in Section IV.

Remark 9: For now, limitations 1 and 2 of CDW scheme

for ETSE-based NCSs have been well-handled as follows:

limitation 1 : (15)

limitation 2 : (16)

1st
→(20),
1st
→(28)

2nd
→ (29)

2nd
→ (38)

3rd
→(38a), (40).

Firstly, to overcome limitation 1 (15) of CDW scheme, the new
ETDW scheme guarantees (20) by treating watermarking as
symmetric key encryption (17) and (19). Meanwhile, limitation
2 (16) of CDW scheme is transformed into the feature (28)
under new ETDW scheme. Secondly, based on (28), the new
asymptotic ETDW tests (29) are designed, which is used to
produce the new ideal ﬁnite sample ETDW tests (38). Thirdly,
based on (38), the new adding-threshold ﬁnite sample ETDW
tests (38a) and (40) are designed. Finally, Theorems 2, 3 and
experiment results in Section IV show the reasonable GRAs
detection performance of the proposed new ETDW scheme.

IV. EXPERIMENTS

To demonstrate the effectiveness of new ETDW scheme, the
scenario when the GRAs enter networked inverted pendulum

B. CDW Scheme on TTC

To analyse the experimental results of NIPVSSs with CDW

scheme on TTC, the following two steps are performed.

Step 1: Six experiments on NIPVSSs with CDW scheme
of Ed = 0.01 on TTC under no attack are carried out. To
save page, one of six experiments is shown in Fig. A.1 of
Section IV.A in the supplementary materials. Six experiments
are used to determine the detection threshold functions for
CDW tests on TTC with Ed = 0.01. The results of attack-free
CDW tests on TTC with Ed = 0.01 are shown in Fig. A.2,
and the value of E f
r and the concrete parameters of ϑ1,i and
ϑ2,i are given in Section IV.A of the supplementary materials.
Step 2: we construct the GRAs with s = −1, va(k) = 0 and
Aa = diag {0.1, 0.1, 0.1, 0.1} from k > 400. The detection
results of NIPVSSs with CDW scheme on TTC of Ed = 0.01
under the GRAs are shown in Fig. 4, where it can be seen
that 1) the pendulum angle is driven to cross 0.8 rad, and the
corresponding attack power A(k) considerably exceeds zero
base line, and 2) the CDW tests on TTC of Ed = 0.01 fail to
detect the GRAs.

C. Triggering Rates of ETC

To analyse the triggering rates (TRs) of ETC with δ =
0.00001, we perform twelve experiments on NIPVSSs with
new ETDW scheme (Edn = 0.01I, six times) and candidate
ETDW scheme (Ed = 0.01, six times) under no attack. To
save page, two of twelve experiments are shown in Figs. A.3

 
 
8

IEEE TRANSACTIONS ON INDUSTRIAL INFORMATICS, VOL. XX, NO. XX, XXXX

0.1

0

-0.1

-0.2

0

1

0.5

0

-0.5

0

20

10

0

100

200

300

400

500

600

(a) Cart position

100

200

300

400

500

600

(b) Pendulum angle

10-3

0

100

200

300

400

500

600

(c) A(k)

2

1

0

-1

0

100

10-5

10-10

0

10-2

10-4

10-6
0

100

200

300

400

500

600

(d) γ(k)

100

200

300

400

500

600

(e) 1

i Di

100

200

300

400

500

600

(f) 1

i (Ri − iE f
r )

Fig. 4. States, attack power, triggering signal and detection results of
NIPVSSs with CDW scheme on TTC of Ed = 0.01 under the GRAs
from k > 400. (a), (b), (d)-(f): Blue Line, attack-free; Red Line, under
the GRAs; Black Line, detection threshold function. (c): Blue Line, zero
line; Red Line, attack power A(k).

and A.4 of Section IV.B in the supplementary materials, and
the values of TRs are shown in Table II, where 1) it can
be calculated that when δ = 0.00001, the average TRs of
NIPVSSs with new ETDW scheme of Edn = 0.01I (six times)
and candidate ETDW scheme of Ed = 0.01 (six times) are
41.0969% and 41.1073% respectively and it means that the
trigger can save much communication resource, and 2) the
trigger can make NIPVSSs operate stably.

TABLE II
TRIGGERING RATES ANALYSIS OF ATTACK-FREE NIPVSSS WITH NEW
AND CANDIDATE ETDW SCHEME WHEN δ = 0.00001

TR for NETDW1

TR for CETDW2

1st Exp.3
2nd Exp.
3rd Exp.
4th Exp.
5th Exp.
6th Exp.
1New ETDW. 2Candidate ETDW. 3Experiment.

38.6008%
43.6083%
39.9198%
40.7949%
42.5484%
41.1089%

7th Exp.
8th Exp.
9th Exp.
10th Exp.
11th Exp.
12th Exp.

44.1856%
40.4984%
40.5813%
38.5386%
45.3508%
37.4888%

TABLE III
CONCRETE PARAMETERS IN ˜ϑ1,n,i AND ˜ϑ2,n,i + ˜ℑn ( ˜ϑ1,i AND
˜ϑ2,i + ˜ℑ)

˜ϑ1,n,i
( ˜ϑ1,i)

ιn,1
(ι1)

κn,1
(κ1)

NETDW1
1.0
(CETDW2)
(1.0)
1Candidate ETDW. 2New ETDW.

1.8e-7
(1.0e-5)

˜ϑ2,n,i + ˜ℑn
( ˜ϑ2,i + ˜ℑ)

ιn,2
(ι2)

1.0
(1.0)

κn,2(κ2)

˜ℑn( ˜ℑ)

1.0e-6
(1.0e-6)

1.0e-3
(1.0e-3)

D. Detection Threshold Functions and False Alarm for
Candidate and New ETDW Tests on ETC

The above 12 experiments are also used to determine the
detection threshold functions for new and candidate ﬁnite
sample adding-threshold ETDW tests with any Edn and Ed =
0.01 respectively. The results of candidate and new ﬁnite
sample adding-threshold tests are shown in Figs. A.5-A.7 of
Section IV.C in the supplementary materials, and the concrete
parameters of detection threshold functions in ˜ϑ1,i, ˜ϑ2,i + ˜ℑ,
˜ϑ1,n,i and ˜ϑ2,n,i + ˜ℑd are given in Table III, where it can
be clearly seen that the false alarm under no attacks can be
avoided as much as possible by selecting appropriate ˜ϑ1,i,
˜ϑ2,i + ˜ℑ, ˜ϑ1,n,i and ˜ϑ2,n,i + ˜ℑn.

E. The GRAs Detection Effectiveness for Candidate and
New ETDW Tests on ETC

We construct the GRAs with s = −1, va(k) = 0 and Aa =
diag {0.1, 0.1, 0.1, 0.1} from k > 400. The detection results
of NIPVSSs with candidate ﬁnite sample adding-threshold
ETDW tests of Ed = 0.01 and new ﬁnite sample adding-
threshold ETDW tests of Edn = 0.01I under the GRAs are
shown in Figs. 5 and 6 respectively, where it can be seen that
1) the candidate ﬁnite sample adding-threshold ETDW tests of
Ed = 0.01 fails to detect the GRAs and the pendulum angle
is driven to cross 0.8 rad, and the corresponding attack power
A(k) considerably exceeds the value of tr (Ψβ(k, γ, δ)); and
2) new ﬁnite sample adding-threshold ETDW tests of Edn =
0.01I succeed to detect the GRAs and the pendulum angle is
driven to cross 0.8 rad, and the corresponding attack power
A(k) considerably exceeds the value of tr (Ψn,β(k, γ, δ)).

Remark 10: It can be clearly seen from Section IV.B-
E that the time-triggered strategy provides worse detection
performance than the event-triggered one. Speciﬁcally, the
CDW tests on TTC of Ed = 0.01 fail to report the GRAs

DU et al.: ATTACK DETECTION FOR NETWORKED CONTROL SYSTEMS USING EVENT-TRIGGERED DYNAMIC WATERMARKING

9

0.1

0

-0.1

-0.2

0

1

0.5

0

-0.5

0

20

10

0

100

200

300

400

500

600

(a) Cart position

100

200

300

400

500

600

(b) Pendulum angle

10-3

0

100

200

300

400

500

600

0.05

0

-0.05

-0.1

0

0.5

0

-0.5

-1

0

15

10

5

0

-5

100

200

300

400

500

600

(a) Cart position

100

200

300

400

500

600

(b) Pendulum angle

10-3

0

100

200

300

400

500

600

(c) A(k)

(c) A(k)

2

1

0

-1

0

10-2

10-4

10-6
0

10-2

10-3

10-4
0

100

200

300

400

500

600

(d) γ(k)

100

200

300

400

500

600

(e) 1

i Di

100

200

300

400

500

600

2

1

0

-1

0

10-2

10-4

10-6
0

10-2

10-3

10-4
0

100

200

300

400

500

600

(d) γ(k)

100

200

300

400

500

600

(e) 1

i Dn,i

100

200

300

400

500

600

(f) 1
i

˜Ri

(f) 1
i

˜Rn,i

Fig. 5. States, attack power, triggering signal and detection results
of NIPVSSs with candidate ETDW scheme of Ed = 0.01 under the
GRAs from k > 400. (a), (b), (d)-(f): Blue Line, attack-free; Red Line,
under the GRAs; Black Line, detection threshold function. (c): Blue Line,
tr (cid:0)Ψβ(k, γ, δ)(cid:1); Red Line, attack power A(k).

Fig. 6. States, attack power, triggering signal and detection results
of NIPVSSs with new ETDW scheme of Edn = 0.01I under the
GRAs from k > 400. (a), (b), (d)-(f): Blue Line, attack-free; Red Line,
under the GRAs; Black Line, detection threshold function. (c): Blue Line,
tr (cid:0)Ψn,β(k, γ, δ)(cid:1); Red Line, attack power A(k).

as shown in Fig. 4, while the ETDW tests of Edn = 0.01I
succeed to report the GRAs as shown in Fig. 6. With the bigger
Ed (e.g., Ed = 10), the CDW tests on TTC could succeed
to report the GRAs. However, large Ed for the CDW tests
will degrade the control performance, or even make systems
crash. In comparison with the CDW tests, the ETDW tests
with watermarking signals of arbitrary Edn will not degrade
the control performance as shown in (20), while the bigger δ
(i.e., the lower triggering frequency) will decline the control
performance. Therefore, co-design between the event-triggered

threshold δ and the controller gain K provides a path to
guarantee the control performance.

F. The GRAs Detection Effectiveness for New ETDW
Tests from Watermarking Intensity on ETC

To further investigate the impact of Edn on the GRAs detec-
tion effectiveness, we perform the same experiments of Fig. 6
again with new adding-threshold ﬁnite sample ETDW tests of
Edn = 0.0001I. The experiment results are shown in Figs. A.8
of Section IV.D in the supplementary materials, where it can

10

IEEE TRANSACTIONS ON INDUSTRIAL INFORMATICS, VOL. XX, NO. XX, XXXX

be seen that new adding-threshold ﬁnite sample ETDW tests
of Edn = 0.0001I fail to detect the GRAs (in which the
pendulum angle is driven to cross 0.8 rad). Therefore, a big
enough watermarking intensity (e.g., Edn = 0.01I) should be
selected in new adding-threshold ﬁnite sample ETDW tests for
successful attack detection.

V. CONCLUSION

A linear event-triggered extension to the CDW scheme
had been developed. Speciﬁcally, a new ETDW scheme was
designed from new asymptotic ETDW tests to new ideal ﬁnite
sample ETDW tests, which limited the power of undetected
GRAs and guaranteed the ﬁnite false alarm under no attacks
and ﬁnite failures on GRAs detection. Experimental results on
NIPVSSs veriﬁed the proposed scheme.

The ETDW scheme can be used in nonlinear systems.
According to the approach of linearization, the ETDW scheme
can be directly applied to the linearized nonlinear system with
low degree of nonlinearity. However, for nonlinear systems
with high degree of nonlinearity, it has to incorporate the
properties of saturation, dead zone, gap, relay and so forth to
analyze the covariance of signals. Therefore, it is interesting to
extend ETDW scheme into nonlinear systems in future work.

REFERENCES

[1] X. Zhang, Q.-L. Han and X. Yu, “Survey on recent advances in
networked control systems,” IEEE Trans. Ind. Inf., vol. 12, no. 5, pp.
1740-1752, Oct. 2016.

[2] X.-L. Zhang, Q.-L. Han and B. Zhang, “An overview and deep inves-
tigation on sampled-data-based event-triggered control and ﬁltering for
networked systems,” IEEE Trans. Ind. Inf., vol. 13, no. 1, pp. 4-16, Feb.
2017.

[3] D. Wang, J. Huang, Y. Tang and F. Li, “A watermarking strategy
against linear deception attacks on remote state estimation under K-L
divergence,” IEEE Trans. Ind. Inf., vol. 17, no. 5, pp. 3273-3281, May
2021.

[4] D. Du, C. Zhang, H. Wang, X. Li, H. Hu and T. Yang, “Stability analysis
of token-based wireless networked control systems under deception
attacks,” Inf. Sci., vol. 459, pp. 168-182, Aug. 2018.

[5] V. Stracqualursi, G. Sands and A. Saenz, “Cyberattack forces major US
fuel pipeline to shut down,” Cable News Netw., May 2021. [Online].
Available: https://edition.cnn.com/2021/05/08/politics/colonial-pipeline-
cybersecurity-attack.

[6] D. P. Fidler, “Was Stuxnet an act of war? Decoding a cyberattack,” IEEE

Secur. Privacy, vol. 9, no. 4, pp. 56-59, July-Aug. 2011.

[7] C. Alippi, G. Anastasi, M. Di Francesco and M. Roveri, “Energy
management in wireless sensor networks with energy-hungry sensors,”
IEEE Instrum. Meas. Mag., vol. 12, no. 2, pp. 16-23, April 2009.
[8] M. Porter, P. Hespanhol, A. Aswani, M. Johnson-Roberson and R.
Vasudevan, “Detecting generalized replay attacks via time-varying dy-
namic watermarking,” IEEE Trans. Autom. Control, to be published, doi:
10.1109/TAC.2020.3022756.

[9] C. Zhang, D. Du, Q. Sun, X. Li, A. Raki´c and M. Fei, “Security
weakness of dynamic watermarking-based detection for generalised
replay attacks”, Int. J. Syst. Sci., vol. 53, no. 5, pp. 948-966, 2022.
[10] Z. Guo, D. Shi, K. H. Johansson and L. Shi, “Optimal linear cyber-attack
on remote state estimation,” IEEE Trans. Control Netw. Syst., vol. 4, no.
1, pp. 4-13, March 2017.

[11] Y. Mo and B. Sinopoli, “Secure control against replay attacks,” in 2009
47th Annu. Allerton Conf. Commun., Control, Comput. (Allerton), 2009,
pp. 911-918.

[12] B. Satchidanandan and P. R. Kumar, “Dynamic watermarking: Active
defense of networked cyber–physical systems,” Proc. IEEE, vol. 105,
no. 2, pp. 219-240, Feb. 2017.

[13] P. Hespanhol, M. Porter, R. Vasudevan and A. Aswani, “Dynamic
watermarking for general LTI systems,” in 2017 IEEE 56th Annu. Conf.
Decis. Control (CDC), 2017, pp. 1834-1839.

[14] D. Du, C. Zhang, Xue Li, M. Fei, T. Yang and H. Zhou, “Secure control
of networked control systems using dynamic watermarking,” IEEE
Trans. Cybern., to be published, doi: 10.1109/TCYB.2021.3110402.
[15] T. Huang, B. Satchidanandan, P. R. Kumar and L. Xie, “An online
detection framework for cyber attacks on automatic generation control,”
IEEE Trans. Power Syst., vol. 33, no. 6, pp. 6816-6827, Nov. 2018.
[16] P. Hespanhol, M. Porter, R. Vasudevan and A. Aswani, “Sensor
switching control under attacks detectable by ﬁnite sample dynamic
watermarking tests,” IEEE Trans. Autom. Control, to be published, doi:
10.1109/TAC.2020.3032085.

[17] S. O. Olatinwo and T. Joubert, “Energy efﬁcient solutions in wireless
sensor systems for water quality monitoring: A review,” IEEE Sens. J.,
vol. 19, no. 5, pp. 1596-1625, 1 March1, 2019.

[18] X. Ge, Q.-L. Han, L. Ding, Y.-L. Wang and X. Zhang, “Dynamic event-
triggered distributed coordination control and its applications: A survey
of trends and techniques,” IEEE Trans. Syst., Man, Cybern., Syst., vol.
50, no. 9, pp. 3112-3125, Sept. 2020.

[19] L. Ding, Q.-L. Han, X. Ge and X. Zhang, “An overview of recent
advances in event-triggered consensus of multiagent systems,” IEEE
Trans. Cybern., vol. 48, no. 4, pp. 1110-1123, April 2018.

[20] M. Kooshkbaghi and H. J. Marquez, “Event-triggered discrete-time
cubature Kalman ﬁlter for nonlinear dynamical systems with packet
dropout,” IEEE Trans. Autom. Control, vol. 65, no. 5, pp. 2278-2285,
May 2020.

[21] W. Chen, D. Shi, J. Wang and L. Shi, “Event-triggered state estimation:
Experimental performance assessment and comparative study,” IEEE
Trans. Control Syst. Technol., vol. 25, no. 5, pp. 1865-1872, Sept. 2017.
[22] B. Moon and J. Mo, “Optimizing uplink TCP-ACK transmission in
WiMAZ OFDMA systems,” IEEE Communications Letters, vol. 12, no.
4, pp. 256-258, April 2008.

[23] G. Park, C. Lee, H. Shim, Y. Eun and K. H. Johansson, “Stealthy
adversaries against uncertain cyber-physical systems: Threat of robust
zero-dynamics attack,” IEEE Trans. Autom. Control, vol. 64, no. 12, pp.
4907-4919, Dec. 2019.

[24] H. Jeon and Y. Eun, “A stealthy sensor attack for uncertain cyber-
physical systems,” IEEE Internet Things J., vol. 6, no. 4, pp. 6345-6352,
Aug. 2019.

[25] D. Du, C. Zhang, Y. Song, H. Zhou, X. Li, M. Fei, W. Li, “Real-time
H∞ control of networked inverted pendulum visual servo systems,”
IEEE Trans. Cybern., vol. 50, no. 12, pp. 5113-5126, Dec. 2020.

Dajun Du received the B.Sc. and M.Sc. degrees
all from the Zhengzhou University, China in 2002
and 2005, respectively, and his Ph. D. degree
in control theory and control engineering from
Shanghai University in 2010. From September
2008 to September 2009, he was a visiting PHD
student at Queen’s University Belfast, UK. From
April 2011 to August 2012, he was a Research
Fellow at Queen’s University Belfast, UK. He
is currently a professor in Shanghai University.
His main research interests include system mod-

elling and identiﬁcation and networked control systems.

Changda Zhang received the B.Sc. and M.Sc.
degrees from Shanghai University, Shanghai,
China in 2016 and 2019, respectively. He is
currently pursuing the Ph. D. degree in Shanghai
University. His main research interests include
secure control for networked control systems.

DU et al.: ATTACK DETECTION FOR NETWORKED CONTROL SYSTEMS USING EVENT-TRIGGERED DYNAMIC WATERMARKING

11

Xue Li received the B.Sc. and M.Sc. degrees all
from the Zhengzhou University, China in 2002
and 2006, respectively, and her Ph. D. degree
in control theory and control engineering from
Shanghai University in 2009. She is currently
a professor in Shanghai University. Her main
research interests include security control and
performance assessment of smart grids.

Minrui Fei received his B.S. and M.S. degrees
in Industrial Automation from the Shanghai Uni-
versity of Technology in 1984 and 1992, respec-
tively, and his PhD degree in Control Theory and
Control Engineering from Shanghai University in
1997. Since 1998, he has been a full professor at
Shanghai University. He is Chairman of Embed-
ded Instrument and System Sub-society, and
Standing Director of China Instrument & Control
Society; Chairman of Life System Modeling and
Simulation Sub-society, Vice-chairman of Intelli-
gent Control and Intelligent Management Sub-society, and Director of
Chinese Artiﬁcial Intelligence Association. His research interests are
in the areas of networked control systems, intelligent control, complex
system modeling, hybrid network systems, and ﬁeld control systems.

Huiyu Zhou received his BEng degree in radio
technology from Huazhong University of Sci-
ence and Technology, China, a MSc degree
in biomedical engineering from University of
Dundee, U.K., and a Doctorate of Philosophy
degree in computer vision from Heriot-Watt Uni-
versity, Edinburgh, U.K. He is currently a full
Professor with School of Computing and Math-
ematical Sciences, University of Leicester, U.K.
He has authored or co-authored over 350 peer-
reviewed papers in the ﬁeld. His research work
has been or is being supported by UK EPSRC, MRC, AHRC, ESRC,
EU ICT, Royal Society, Innovate UK, Leverhulme Trust, Invest NI, Pufﬁn
Trust, Alzheimer Research (UK) and industry.

