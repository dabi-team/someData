1

Joint Attack Detection and Secure State Estimation
of Cyber-Physical Systems
Nicola Forti†∗, Giorgio Battistelli∗, Luigi Chisci∗, and Bruno Sinopoli‡
†Research Department, NATO STO CMRE, La Spezia, Italy
∗Dipartimento di Ingegneria dell’Informazione, Universit`a di Firenze, Firenze, Italy
‡Department of Electrical & Systems Engineering, Washington University in St. Louis, MO
†nicola.forti@cmre.nato.int, ∗{giorgio.battistelli,luigi.chisci}@uniﬁ.it, ‡bsinopoli@wustl.edu

9
1
0
2

b
e
F
4
2

]

Y
S
.
s
c
[

4
v
8
7
4
8
0
.
2
1
6
1
:
v
i
X
r
a

Abstract

This paper deals with secure state estimation of cyber-physical systems subject to switching (on/off) attack
signals and injection of fake packets (via either packet substitution or insertion of extra packets). The random set
paradigm is adopted in order to model, via Random Finite Sets (RFSs), the switching nature of both system attacks
and the injection of fake measurements. The problem of detecting an attack on the system and jointly estimating its
state, possibly in the presence of fake measurements, is then formulated and solved in the Bayesian framework for
systems with and without direct feedthrough of the attack input to the output. This leads to the analytical derivation
of a hybrid Bernoulli ﬁlter (HBF) that updates in real-time the joint posterior density of a Bernoulli attack RFS and
of the state vector. A closed-form Gaussian-mixture implementation of the proposed hybrid Bernoulli ﬁlter is fully
derived in the case of invertible direct feedthrough. Finally, the effectiveness of the developed tools for joint attack
detection and secure state estimation is tested on two case-studies concerning a benchmark system for unknown
input estimation and a standard IEEE power network application.

Cyber-physical systems; secure state estimation; Bayesian state estimation; Bernoulli ﬁlter; extra packet

injection; random ﬁnite sets.

Index Terms

I. INTRODUCTION

Cyber-Physical Systems (CPSs) are complex engineered systems arising from the integration of computational
resources and physical processes, tightly connected through a communication infrastructure. Typical examples of
CPSs include next-generation systems in building and environmental monitoring/control, health care, electric power
grids, transportation and mobility and industrial process control. While, on one hand, advances in CPS technology
will enable enhanced autonomy, efﬁciency, seamless interoperability and cooperation, on the other hand the increased
interaction between cyber and physical realms is unavoidably providing novel security vulnerabilities, which make
CPSs subject to non-standard malicious threats. Recent real-world attacks such as the Maroochy Shire sewage spill,
the Stuxnet worm sabotaging an industrial control system, and the lately reported massive power outage against
Ukrainian electric grid [1], have brought into particularly sharp focus the urgency of designing secure CPSs. It
is worth pointing out that in presence of malicious threats against CPSs, standard approaches extensively used for
control systems subject to benign faults and failures are no longer suitable. Moreover, the design and implementation
of defense mechanisms usually employed for cyber security, can only guarantee limited layers of protection, since
they do not take into account vulnerabilities like the ones on physical components. This is why recent research
efforts on the design of secure systems have explored different routes. Preliminary work addressed the issues of
attack detection/identiﬁcation, and proposed attack monitors for deterministic control systems [2]. Secure strategies
have been studied for replay attacks [3], [4] where the adversary ﬁrst records and then replays the observed data, as
well as for denial-of-service (DoS) attacks [5], [6] disrupting the ﬂow of data. Moreover, active detection methods
have been designed in order to detect stealthy attacks via manipulation of, e.g., control inputs [7] or dynamics [8].
Over the last few years, the problem of secure state estimation, i.e. capable of reconstructing the state even when
the CPS of interest is under attack, has gained considerable attention [9]–[18]. Initial work considered a worst-case
approach for the special class of SISO systems [9]. Under the assumption of linear systems subject to an unknown
but bounded number of false-data injection attacks on sensor outputs, the problem for a noise-free system has been
cast into an (cid:96)0−optimization problem, which can be relaxed as a more efﬁcient convex problem [10], and, in turn,
adapted to systems with bounded noise [11]. Further advances tried to tackle the combinatorial complexity of the
problem by resorting to satisﬁability modulo theories [12] and investigated, in the same context, the case of Gaussian

 
 
 
 
 
 
2

measurement noise [13] and the concept of observability under attacks [14]. Most recently, deterministic models of
the most popular attack policies have been presented based on adversary’s resources and system knowledge [15],
and secure state estimation of CPSs has been addressed [16] by modeling in a stochastic framework the attacker’s
decision-making by assuming Markov (possibly uninformative) decision processes instead of unknown or worst-case
models.

Though the literature on attack-resilient state estimation is quite abundant, most of the existing contributions
have adopted a deterministic (worst-case) approach and/or have been restricted to linear systems. In practice, the
system monitor (defender) might have some (even no) probabilistic prior knowledge on the attacker’s strategy
and the CPS of interest might easily be affected by nonlinearities. In this respect, a Bayesian approach where prior
knowledge on the attacks is characterized in terms of probability distributions and nonlinearities are possibly handled
by particle ﬁltering or Gaussian-mixture methods, seems well suited and will be pursued in this paper. This allows
great ﬂexibility in that knowledge available to the attack monitor can range from complete knowledge to no prior
knowledge (uninformative prior) depending on the assumed distributions.

Speciﬁcally, in this paper three different types of adversarial attacks on CPSs are considered: (i) signal attack,
i.e. signal of arbitrary magnitude and location injected (with known structure) to corrupt sensor/actuator data, (ii)
packet substitution attack, describing an intruder that possibly intercepts and then replaces the system-generated
measurement with a fake (unstructured) one, and (iii) extra packet injection, a new type of attack against state
estimation, already introduced in information security [19], [20], in which multiple counterfeit observations (junk
packets) are possibly added to the system-generated measurement. Note that the key feature distinguishing signal
attacks on sensors from packet substitution, relies on the fact that the former are assumed to alter the measurement
through a given structure (i.e., known measurement function), whereas the latter mechanism captures integrity attacks
that spoof sensor data packets with no care of the model structure. By considering both structured and unstructured
injections, we do not restrict the type of attack the adversary can enforce on the sensor measurements. Please notice
that, as a further by-product, the Bayesian approach with uninformative prior can also deal with the situation in
which the attacker has the ability to choose arbitrarily large attack and/or fake measurements, while the worst-case
attack paradigm in this case is not viable.

The present paper aims to address the problem of simultaneously detecting a signal attack while estimating the
state of the monitored system, possibly in presence of fake measurements independently injected into the system’s
monitor by cyber-attackers. A random set attack modeling approach is undertaken by representing the signal attack
presence/absence by means of a Bernoulli random set (i.e. a set that, with some probability, can be either empty or
a singleton depending on the presence or not of the attack) and by taking into account possible fake measurements
by means of a random measurement set. We follow the approach of Forti et al. [17], [18] and formulate the joint
attack detection-state estimation problem within the Bayesian framework as the recursive determination of the joint
posterior density of the signal attack Bernoulli set and of the state vector at each time given all the measurement
sets available up to that time. Strictly speaking, the posed Bayesian estimation problem is neither standard [21]
nor Bernoulli ﬁltering [22]–[25] but is rather a hybrid Bayesian ﬁltering problem that aims to jointly estimate a
Bernoulli random set for the signal attack and a random vector for the system state. An analytical solution of the
hybrid ﬁltering problem has been found in terms of integral equations that generalize the Bayes and Chapman-
Kolmogorov equations of the Bernoulli ﬁlter. In particular, the proposed hybrid Bernoulli Bayesian ﬁlter for joint
attack detection-state estimation propagates in time, via a two-step prediction-correction procedure, a joint posterior
density completely characterized by a triplet consisting of: (1) a signal attack probability; (2) a probability density
function (PDF) in the state space for the system under no signal attack; (3) a PDF in the joint attack input-state
space for the system under signal attack.

The adopted approach enjoys the following positive features: 1) it encompasses in a unique framework different
types of attacks (signal attacks, packet substitution, extra packet injection, temporary DoS, etc.); 2) it takes into
account the presence of disturbances and noise and deals with general nonlinear systems; 3) it propagates probability
distributions of the system state, attack signal and attack existence, which can be useful for, respectively, real-time
dynamic state estimation, attack reconstruction and security decision-making. Notice that, unlike most previous
work cited above, in the present paper we address the problem from the estimator’s perspective and, hence, we
cannot assume any speciﬁc strategy for the attacker. This motivates the modeling of the signal attack as a switching
unknown input affecting the system.

Preliminary work on Bayesian state estimation against switching unknown inputs and extra packet injection was
carried out by Forti et al. [17], [18]. The present paper extends this preliminary work in the following directions.
1) It also considers the packet substitution attack (in addition to the already considered extra packet injection attack).
This novel type of attack refers to the practically relevant situation wherein the attacker has the ability to intercept
and manipulate packets sent to the system monitor so as to replace system-originated measurements by fake ones
but, unlike the extra packet injection attack, cannot send additional indistinguishable packets containing fake

3

measurements to confuse the system monitor.

2) It provides the full derivation of a closed-form solution of the posed Bayesian ﬁltering problem for linear-
Gaussian models based on a Gaussian-mixture approach. This allows a computationally efﬁcient implementation
of the proposed joint attack detector-state estimator also extendable to nonlinear models via extended or unscented
(instead of standard) Kalman ﬁltering techniques.

3) It considers also the case of no direct feedthrough of the attack input into the observed output.

The rest of the paper is organized as follows. Section II introduces the considered attack models and provides
the necessary background on joint input-and-state estimation as well as on random set estimation. Sections III and
IV formulate and solve the joint attack detection-state estimation problem of interest in the Bayesian framework.
Section V provides detailed derivations of the Gaussian-mixture hybrid Bernoulli ﬁler for linear-Gaussian mod-
els. Then, Section VI demonstrates the effectiveness of the proposed approach via numerical examples. Finally,
Section VII ends the paper with concluding remarks and perspectives for future work.

II. PROBLEM SETUP AND PRELIMINARIES

A. System description and attack model

Let the discrete-time cyber-physical system of interest be modeled by

xk+1 =

(cid:40) f 0
k (xk) + wk,
f 1
k (xk, ak) + wk, under attack

under no attack

(1)

where: k is the time index; xk ∈ Rn is the state vector to be estimated; ak ∈ Rm, called attack vector, is an
unknown input affecting the system only when it is under attack; f 0
k (·, ·) are known state transition
functions that describe the system evolution in the no attack and, respectively, attack cases; wk is a random process
disturbance also affecting the system. For monitoring purposes, the state of the above system is observed through
the measurement model

k (·) and f 1

yk =

(cid:40) h0
k(xk) + vk,
h1
k(xk, ak) + vk,

under no attack

under attack

(2)

k(·) and h1

where: h0
k(·, ·) are known measurement functions that refer to the no attack and, respectively, attack cases;
vk is a random measurement noise. It is assumed that the measurement yk is actually delivered to the system monitor
with probability pd ∈ (0, 1], where the non-unit probability might be due to a number of reasons (e.g. temporary
denial of service, packet loss, sensor inability to detect or sense the system, etc.). The attack modeled in (1)-(2)
via the attack vector ak is usually referred to as signal attack. While for ease of presentation only the case of a
single attack model is taken into account, multiple attack models [26] could be accommodated in the considered
framework by letting (1)-(2) depend on a discrete variable, say νk, which speciﬁes the particular attack model and
has to be estimated together with ak. Besides the system-originated measurement yk in (2), it is assumed that the
system monitor might receive fake measurements from some cyber-attacker. In this respect, the following two cases
will be considered.
1) Packet substitution - With some probability pf ∈ [0, 1), the attacker replaces the system-originated measurement

yk with a fake one yf
k .

2) Extra packet injection - The attacker sends to the monitor one or multiple fake measurements indistinguishable

from the system-originated one.

Fig. 1: Packet substitution attack.

For the subsequent developments, it is convenient to introduce the attack set at time k, Ak, which is either equal
to the empty set if the system is not under signal attack at time k or to the singleton {ak} otherwise, i.e.

Ak =

(cid:26) ∅,

if the system is not under signal attack

{ak}, otherwise.

PhysicalPlantMan-in-the-middleSystemMonitor4

Fig. 2: Extra packet injection attack.

It is also convenient to deﬁne the measurement set at time k, Zk. For the packet substitution attack (Fig. 1):

Zk =






∅,

with probability 1 − pd

{yk}, with probability pd(1 − pf )
{yf

k }, with probability pd pf

(3)

where yk is given by (2) and yf
extra packet injection attack (Fig. 2) the deﬁnition (3) is replaced by

k is a fake measurement provided by the attacker in place of yk. Conversely, for the

where

Zk = Yk ∪ Fk

Yk =

(cid:26) ∅,

with probability 1 − pd

{yk}, with probability pd

is the set of system-originated measurements and Fk the ﬁnite set of fake measurements.

(4)

(5)

The aim of this paper is to address the problem of joint attack detection and state estimation, which amounts to
i=1Zi

jointly estimating, at each time k, the state xk and signal attack set Ak given the set of measurements Z k (cid:52)
up to time k.

= ∪k

B. Joint input and state estimation

In this section, the main ideas of the Bayesian approach to Joint Input and State Estimation (JISE) [27] are

summarized. Consider a system affected by an unknown input ak

(cid:26) xk+1 = f (xk, ak) + wk
yk = h(xk, ak) + vk

(6)

In JISE [27]–[29] it is customary to distinguish the case in which there is a direct feedthrough of the unknown
input ak to the output yk from the case of no direct feedthrough.

Direct feedthrough: Suppose that there is an invertible direct feedthrough [27], [28] of the unknown input ak to
the output yk, which amounts to assuming that the function h(x, a) is injective with respect to a for any x. In this
case, the Bayesian approach is based on the recursive computation of the joint PDF p(ak, xk|yk) of the unknown
input ak and state xk conditioned on all the information available up to the current time. Given the conditional
PDF, optimal estimates of ak and xk can be computed according to any given criterion, the most typical ones being
Maximum A-posteriori Probability (MAP) and Minimum Mean Square Error (MMSE). The joint conditional PDF
can be computed by means of a two-step procedure of correction and prediction. Suppose that at time k − 1, the
predicted posterior p(ak, xk|yk−1) has been computed. Then, at time k, when the new measurement yk is collected,
in the correction step the new conditional PDF p(ak, xk|yk) can be obtained by means of the Bayes rule

p(ak, xk|yk) =

p(yk|ak, xk) p(ak, xk|yk−1)
p(yk|yk−1)

(7)

Conversely, the prediction step concerns the propagation of the conditional PDF from time k to time k + 1. In the
literature on unknown input estimation, it is usually supposed that the values ak and xk of unknown input and,
respectively, state at time k do not provide any information on the value ak+1 taken by the unknown input at time
k + 1. Accordingly, p(ak+1, xk+1|yk) takes the form

p(ak+1, xk+1|yk) = p(xk+1|yk) p(ak+1)

(8)

PhysicalPlantMan-in-the-middleSystemMonitorwhere the conditional PDF p(xk+1|yk) is computed via the Chapman-Kolmogorov equation

p(xk+1|yk) =

(cid:90) (cid:90)

p(xk+1|ak, xk) p(ak, xk|yk) dakdxk.

5

(9)

With this respect, when no information on the unknown input ak+1 is supposed to be available, it is customary [27]
to resort to the so-called principle of indifference and take p(ak+1) as an uninformative (ﬂat) prior. It is easy to
check that, in this case, the conditional PDF p(ak, xk|yk) resulting from the correction step can be rewritten as

p(ak, xk|yk) =

p(yk|ak, xk) p(xk|yk−1)
(cid:82) (cid:82) p(yk|a, x) p(x|yk−1) dx da

(10)

Then, maximization of (10) with respect to xk and ak provides a MAP estimate of xk and a Maximum Likelihood
(ML) estimate of the unknown input ak. This is the approach followed by Fang et al. [27] that allows to generalize
the traditional techniques for linear systems [28], [29] to general nonlinear systems (see Theorems 1 and 2 in the
work of Fang et al. [27]).

No direct feedthrough: Suppose that there is no direct feedthrough [27], [29] of the unknown input ak to
the output yk so that yk = h(xk) + vk. In this case, the unknown input must be estimated with one step delay,
since yk+1 is the ﬁrst measurement containing information on ak. Hence, the Bayesian approach is based on the
recursive computation of the joint PDF p(ak−1, xk|yk) of the unknown input ak−1 and state xk conditioned on all
the information available up to time k. Suppose that at time k −1, the predicted posterior p(ak−1, xk|yk−1) has been
computed. Then, at time k, when the new measurement yk is collected, in the correction step the new conditional
PDF p(ak−1, xk|yk) can be obtained by means of the Bayes rule

p(ak−1, xk|yk) =

p(yk|xk) p(ak−1, xk|yk−1)
p(yk|yk−1)

while in the prediction step, p(ak, xk+1|yk) takes the form

p(ak, xk+1|yk) = p(xk+1|ak, yk) p(ak)

where the conditional PDF p(xk+1|ak, yk) is computed via the Chapman-Kolmogorov equation

p(xk+1|ak, yk) =

(cid:90)

p(xk+1|ak, xk) p(xk|yk) dxk.

(11)

(12)

(13)

When no information on the unknown input ak is supposed to be available so that p(ak) as an uninformative (ﬂat)
prior, the conditional PDF p(ak−1, xk|yk) resulting from the correction step can be rewritten as

p(ak−1, xk|yk) =

p(yk|xk) p(xk|ak−1, yk−1)
(cid:82) (cid:82) p(yk|x) p(x|a, yk−1) dx da

(14)

C. Random set estimation

An RFS (Random Finite Set) X over X is a random variable taking values in F(X), the collection of all ﬁnite
subsets of X. The mathematical background needed for Bayesian random set estimation can be found in Mahler’s
book [23]; here, the basic concepts needed for the subsequent developments are brieﬂy reviewed. From a probabilistic
viewpoint, an RFS X is completely characterized by its set density f (X ), also called FISST (FInite Set STatistics)
probability density. In fact, given f (X ), the cardinality probability mass function ρ(n) that X have n ≥ 0 elements
and the joint PDFs f (x1, x2, . . . , xn|n) over Xn given that X have n elements, are obtained as follows:
1
n!

f ({x1, . . . , xn}) dx1 · · · dxn

ρ(n) =

(cid:90)

Xn

1
n! ρ(n)
In order to measure probability over subsets of X or compute expectations of random set variables, Mahler [23]
introduced the notion of set integral for a generic real-valued function g(X ) of an RFS X as

f (x1, x2, . . . , xn|n) =

f ({x1, . . . , xn}).

(cid:90)

g(X ) δX = g(∅) +

(cid:90)

∞
(cid:88)

n=1

1
n!

g({x1, . . . , xn}) dx1 · · · dxn

(15)

6

In particular, in this work we will consider the Bernoulli RFS, i.e. a random set which can be either empty or,
with some probability r ∈ [0, 1], a singleton {x} whose element is distributed over X according to the PDF p(x).
Accordingly, its set density is deﬁned as follows:

f (X ) =

(cid:40)

1 − r,
r · p(x),

if X = ∅
if X = {x}

(16)

Please notice that the above equation as well as all subsequent deﬁnitions of probability distributions involving a
Bernoulli set argument have two branches on the right-hand-side depending on whether the Bernoulli argument is
empty or a singleton.

III. BAYESIAN RANDOM SET FILTER FOR JOINT ATTACK DETECTION AND STATE ESTIMATION –
THE DIRECT FEEDTHROUGH CASE

Let us suppose that, when the attack input is present, there is a direct feedthrough from the attack ak to the
output yk. More speciﬁcally, in accordance with the considerations of Section II-B, it is assumed that, when the
attack input is present, the mapping from ak to yk is full rank, i.e. invertible. Let the attack input at time k be
modeled as a Bernoulli random set Ak ∈ B(A), where B(A) = ∅ ∪ S(A) is a set of all ﬁnite subsets of the attack
space A ⊆ Rm, and S(A) denotes the set of all singletons (i.e., sets with cardinality 1) {a} such that a ∈ A.
Further, let X ⊆ Rn denote the Euclidean space for the system state vector, then we can deﬁne the Hybrid Bernoulli
Random Set (HBRS) (A, x) as a new state variable which incorporates the Bernoulli attack random set A and the
random state vector x, taking values in the hybrid space B(A) × X. A HBRS is fully speciﬁed by the (signal attack)
probability r of A being a singleton, the PDF p0(x) deﬁned on the state space X, and the joint PDF p1(a, x) deﬁned
on the joint attack input-state space A × X, i.e.

p(A, x) =

(cid:40) (1 − r) p0(x),
r · p1(a, x),

if A = ∅

if A = {a}

.

Moreover, since integration over B(A) × X takes the form

(cid:90)

B(A)×X

p(A, x)δA dx =

(cid:90)

(cid:90) (cid:90)

p(∅, x) dx +

p({a}, x) da dx

(17)

(18)

where the set integration with respect to A is deﬁned according to (15) while the integration with respect to x is an
ordinary one, it is easy to see that p(A, x) integrates to one by substituting (17) in (18), and noting that p0(x) and
p1(a, x) are conventional probability density functions on X and A × X, respectively. This, in turn, guarantees that
(17) is a FISST probability density for the HBRS (A, x). The notion of attack existence, embodied by parameter
r in (17), is introduced so as to detect the presence (existence) of a signal attack and hence initiate its estimation.
Thanks to this concept, as shown later on, the probability of attack existence is directly computed by the ﬁlter.

In this paper the attack input is modeled as a Bernoulli random set (BRS) to account for the fact that the attack
can switch (from off to on or viceversa) at any time with no prior knowledge on the attack onset/termination from
the system monitor side. The switching nature of the attack could be tackled in different ways, e.g. with multiple
models (one for the attack and another for the no-attack cases), but the random set approach undertaken in this
work turns out to be advantageous also to include other type of attacks, speciﬁcally packet substitution and extra
packet injection to be considered in the next subsection.

A. Measurement models and correction

1) Packet substitution: Let us consider the packet substitution attack model introduced in Section 2.1 and
denote by λ(Zk|Ak, xk) the likelihood function of the measurement set deﬁned in (3), which has obviously two
possible forms, Ak being a Bernoulli random set. In particular, for Ak = ∅:

λ(Zk|∅, xk) =

(cid:40) 1 − pd,
pd

(cid:2)(1 − pf ) (cid:96)(yk|xk) + pf κ(yk)(cid:3),
where {yk} denotes the singleton whose element represents a delivered measurement, i.e. λ({yk}|Ak, xk) is the
likelihood that a single measurement yk will be collected. Furthermore, (cid:96)(yk|xk) is the standard likelihood function
of the system-generated measurement yk when no signal attack is present, whereas κ(·) is a PDF modeling the fake
measurement yf

k , assumed to be independent of the system state. Conversely, for Ak = {ak}:

if Zk = {yk}

(19)

λ(Zk|{ak}, xk) =

(cid:40) 1 − pd,
pd

(cid:2)(1 − pf ) (cid:96)(yk|ak, xk) + pf κ(yk)(cid:3),

if Zk = ∅

if Zk = {yk}

(20)

if Zk = ∅

where (cid:96)(yk|ak, xk) denotes the conventional likelihood of measurement yk, due to the system under attack ak in
state xk. Notice that, by using the deﬁnition of set integral (15), it is easy to check that both forms (19) and
(20) of the likelihood function λ(Zk|Ak, xk) integrate to one. Using the aforementioned measurement model, it is
possible to derive the exact correction equations of the Bayesian random set ﬁlter for joint attack detection and state
estimation, in case of substitution attack.

Theorem 1: (Correction under packet substitution attack) Suppose that the prior density at time k is hybrid

7

Bernoulli of the form

p(Ak, xk|Z k−1) =

(cid:40) (1 − rk|k−1) p0
rk|k−1 · p1

k|k−1(ak, xk),

k|k−1(xk),

if Ak = ∅

if Ak = {ak}

.

(21)

Then, given the measurement random set Zk deﬁned in (3), also the posterior density at time k turns out to be
hybrid Bernoulli of the form

p(Ak, xk|Z k) =

completely speciﬁed by the triplet

(cid:40) (1 − rk|k) p0
rk|k · p1

k|k(ak, xk),

k|k(xk),

if Ak = ∅

if Ak = {ak}

(cid:0)rk|k, p0

k|k(xk), p1

k|k(ak, xk)(cid:1) = (cid:0)rk|k−1, p0

k|k−1(xk), p1

k|k−1(ak, xk)(cid:1)

if Zk = ∅ or, if Zk = {yk}, by:

rk|k

p0
k|k(xk)

p1
k|k(ak, xk)

=

=

=

where

(1 − pf ) Ψ1 + pf κ(yk)
(1 − pf )(Ψ0 − rk|k−1Ψ) + pf κ(yk)
(1 − pf ) (cid:96)(yk|xk) + pf κ(yk)
(1 − pf ) Ψ0 + pf κ(yk)

p0
k|k−1(xk)

rk|k−1

(1 − pf ) (cid:96)(yk|ak, xk) + pf κ(yk)
(1 − pf ) Ψ1 + pf κ(yk)

p1
k|k−1(ak, xk)

Ψ0

Ψ1

(cid:52)
=

(cid:52)
=

(cid:90)

(cid:96)(yk|xk) p0

k|k−1(xk) dxk

(cid:90) (cid:90)

(cid:96)(yk|ak, xk) p1

k|k−1(ak, xk) dakdxk

Ψ

(cid:52)
= Ψ0 − Ψ1.

(22)

(23)

(24)

(25)

(26)

(27)

(28)

Proof: The correction equation of the Bayes random set ﬁlter for joint attack detection and state estimation

follows from a generalization of (7), which yields

p(Ak, xk|Z k) =

λ(Zk|Ak, xk) p(Ak, xk|Z k−1)
p(Zk|Z k−1)

(29)

where λ(Zk|Ak, xk) is given by (19) and (20), while
(cid:90) (cid:90)

p(Zk|Z k−1)

=

λ(Zk|Ak, xk) p(Ak, xk|Z k−1) δAkdxk

(cid:90)

=

λ(Zk|∅, xk) p(∅, xk|Z k−1) dxk +

(cid:90) (cid:90)

λ(Zk|{ak}, xk) p({ak}, xk|Z k−1) dakdxk. (30)

For the case Zk = ∅, the above reduces to

p(∅|Z k−1) = 1 − pd
by substituting (19)-(20) and (21) in (30), and simply noting that (cid:82) p0
1. The posterior probability of attack existence rk|k can be obtained from the posterior density (29) with Ak = ∅
via

k|k−1(xk)dxk = 1 and (cid:82)(cid:82) p1

k|k−1(ak, xk) dakdxk =

(31)

where - using (19), (21) and (31) in (29) - we have

rk|k = 1 −

(cid:90)

p(∅, xk|Z k) dxk

p(∅, xk|Z k) = (1 − rk|k−1) p0

k|k−1(xk).

(32)

(33)

Moreover, p0
from the posterior density with Ak = {ak} by recalling that p1

k|k(xk) = p(∅, xk|Z k)/(1−rk|k), and the joint density for the system under attack can be easily derived

k|k(ak, xk) = p({ak}, xk|Z k)/rk|k, where

p({ak}, xk|Z k) = rk|k−1 · p1

k|k−1(ak, xk)

(34)

8

results from replacing (20), (21) and (31) in (29). Notice that from the set integral deﬁnition (15), and densities
(33)-(34), it holds that (cid:82) p(∅, xk|Z k) dxk + (cid:82)(cid:82) p({ak}, xk|Z k) dakdxk = 1. Hence, as stated, the Bayes correction
(22) provides a hybrid Bernoulli density. Next, for the case Zk = {yk}, (30) leads to
(cid:21)

p({yk}|Z k−1) = pd

(cid:20)
(1 − pf )(Ψ1 − rk|k−1Ψ) + pf κ(yk)

(35)

(36)

so that from (29) one gets

(cid:21)
(cid:20)
(1 − pf ) (cid:96)(yk|xk) + pf κ(yk)

p(∅, xk|Z k) =

(1 − pf )(Ψ1 − rk|k−1Ψ) + pf κ(yk)

(1 − rk|k−1) p0

k|k−1(xk)

which, in turn, is used to obtain (23) through (32). Once rk|k is known, (24) immediately follows as previously
shown for the case Zk = ∅, while (25) comes from dividing the posterior
(cid:21)
(cid:20)
(1 − pf ) (cid:96)(yk|xk) + pf κ(yk)

p({ak}, xk|Z k) =

(1 − pf )(Ψ1 − rk|k−1Ψ) + pf κ(yk)

rk|k−1 p1

k|k−1(ak, xk)

(37)

by rk|k in (23).

2) Extra packet injection: A complete derivation of the correction step for the extra packet injection model
introduced in Section II-A can be found in Forti et al. [18] We summarize below the main results, since they are the
basis for the derivation of the Gaussian-mixture ﬁlter of Section 4. First recall that, in this case, the measurement
set Zk is given by the union of the two independent random sets Yk and Fk. Clearly, in view of (5), Yk is a
Bernoulli random set whose cardinality is either 0 or 1 depending on whether the system-originated measurement
yk is delivered or not. Conversely, it is supposed that no prior knowledge on the number of fake measurements,
i.e. the cardinality of Fk, is available. Accordingly, ρ(n) is taken as an uninformative distribution and, hence, the
FISST PDF of fake-only measurements turns out to be

γ(Fk) ∝ |Fk|!

(cid:89)

κ(yk)

yk∈Fk

(38)

where κ(yk) is a PDF describing the distribution of fake measurements on the measurement space Y. Clearly, if
no prior knowledge on such a distribution can be assumed, the same approach of Section 2.1 can be followed by
taking κ(yk) as an uninformative (i.e. uniform) PDF over Y. The following result holds.

Theorem 2: (Correction under extra packet injection attack, Forti et al. [18]) Suppose that the prior density at

time k is hybrid Bernoulli of the form

p(Ak, xk|Z k−1) =

(cid:40) (1 − rk|k−1) p0
rk|k−1 · p1

k|k−1(ak, xk),

k|k−1(xk),

if Ak = ∅

if Ak = {ak}

.

(39)

Then, given the measurement random set Zk deﬁned in (4), also the posterior density at time k turns out to be
hybrid Bernoulli of the form

p(Ak, xk|Z k) =

completely speciﬁed by the triplet

(cid:40) (1 − rk|k) p0
rk|k · p1

k|k(ak, xk),

k|k(xk),

if Ak = ∅

if Ak = {ak}

rk|k

=

p0
k|k(xk)

p1
k|k(ak, xk)

=

=

1 − pd (1 − Γ1)
1 − pd[1 − (Γ0 − rk|k−1Γ)]
(cid:96)(yk|xk)
n κ(yk)

1 − pd + pd

(cid:88)

yk∈Zk
1 − pd (1 − Γ0)

rk|k−1

p0
k|k−1(xk)

1 − pd + pd

(cid:88)

(cid:96)(yk|ak, xk)
n κ(yk)

yk∈Zk
1 − pd (1 − Γ1)

p1
k|k−1(ak, xk)

(40)

(41)

(42)

(43)

where

Γ0

Γ1

(cid:52)
=

(cid:52)
=

(cid:88)

yk∈Zk

(cid:88)

yk∈Zk

(cid:82) (cid:96)(yk|xk) p0

k|k−1(xk) dxk

n κ(yk)
(cid:82)(cid:82) (cid:96)(yk|ak, xk) p1

k|k−1(ak, xk) dakdxk

n κ(yk)

and Γ

(cid:52)
= Γ0 − Γ1.

B. Dynamic model and prediction

9

(44)

(45)

Let us now focus on the prediction step of the Bayesian hybrid Bernoulli ﬁlter. Concerning the propagation of
the signal attack from time k to time k + 1, we consider the most general model for signal attacks where any value
can be injected and, accordingly, we model ak+1 as a completely unknown input whose value does not depend on
the values ak and xk of attack and, respectively, state at time k. However, concerning the existence of the attack at
time k + 1, we introduce two parameters ps and pb to model the fact that the presence of an attack at time k + 1 is
more probable when an attack is already present at time k: pb denotes the probability that an attack ak+1 is launched
to the system at time k + 1 when the system is under normal operation at time k; ps denotes the probability that
an adversarial action affecting the system at time k will endure to time k + 1. Notice that the probabilities pb and
ps have to be regarded as design parameters for the ﬁlter that can be tuned depending on the desired properties:
the lower is pb the more cautious will be the ﬁlter in declaring the presence of an attack; the higher is ps the more
cautious will be the ﬁlter in declaring that the attack has disappeared. According to this model, the transition density
π(Ak+1|Ak) of the attack BRS takes the form

π(Ak+1|∅) =

π(Ak+1|{ak}) =

(cid:40) 1 − pb,

if Ak+1 = ∅

pb p(ak+1),

(cid:40) 1 − ps,

if Ak+1 = {ak+1}
if Ak+1 = ∅

ps p(ak+1),

if Ak+1 = {ak+1}

Like in Section 2.2, p(ak+1) is the PDF summarizing the available knowledge on ak+1, which can be taken equal
to an uninformative PDF (e.g., uniform over the attack space) when the attack vector is completely unknown.

Then, the joint transition density of (A, x) at time k + 1 takes the form

where, in accordance with (1), we have

π(Ak+1, xk+1|Ak, xk) = π(xk+1|Ak, xk) π(Ak+1|Ak)

π(xk+1|Ak, xk) =

(cid:40) π(xk+1|xk),

if Ak = ∅

π(xk+1|ak, xk),

if Ak = {ak}

(46)

(47)

with π(xk+1|xk) and π(xk+1|ak, xk) known Markov transition PDFs.

Under the above assumptions, Forti et al. [18] obtained an exact recursion for the prior density.

Theorem 3: (Forti et al. [18]) Given the posterior hybrid Bernoulli density p(Ak, xk|Z k) at time k of the form
k|k(ak, xk)(cid:1), also the predicted density turns out to be hybrid

k|k(xk), p1

(22), fully characterized by the triplet (cid:0)rk|k, p0
Bernoulli of the form

p(Ak+1, xk+1|Z k) =

with

(cid:40) (1 − rk+1|k) p0
rk+1|k · p1

k+1|k(xk+1),

k+1|k(ak+1, xk+1),

if Ak+1 = ∅

if Ak+1 = {ak+1}

rk+1|k =

p0
k+1|k(xk+1) =

(1 − rk|k) pb + rk|k ps
(1 − rk|k)(1 − pb) pk+1|k(xk+1|∅)
1 − rk+1|k

+

rk|k(1 − ps) pk+1|k(xk+1|{ak})
1 − rk+1|k

p1
k+1|k(ak+1, xk+1) =

(1 − rk|k) pb pk+1|k(xk+1|∅) p(ak+1)
rk+1|k

+

rk|k ps pk+1|k(xk+1|{ak}) p(ak+1)
rk+1|k

(48)

(49)

(50)

(51)

where

pk+1|k(xk+1|∅) =

(cid:90)

π(xk+1|xk) p0

k|k(xk) dxk

pk+1|k(xk+1|{ak}) =

(cid:90) (cid:90)

π(xk+1|ak, xk) p1

k|k(ak, xk) dakdxk.

10

(52)

(53)

Notice that, if pb = 0, ps = 1 and rk|k = 1, it follows that rk+1|k = 1 and p1

k+1|k(ak+1, xk+1) =
pk+1|k(xk+1|{ak}) p(ak+1). Hence, in this case, we recover the standard Chapman–Kolmogorov equation (9) for
the system under attack.

Remark 1: Given the conditional density p(Ak, xk|Z k), characterized by the triplet

, the
joint attack detection and state estimation problem can be solved as follows. First of all, we perform attack detection
using rk|k from the available current hybrid Bernoulli density p(Ak, xk|Z k). By using a MAP decision rule, given Zk,
the detector will assign ˆAk (cid:54)= ∅ (the system is under attack) if and only if Prob(Ak (cid:54)= ∅|Z k) > Prob(Ak = ∅|Z k),
i.e. if and only if rk|k > 1/2. Then, if the signal attack has been detected, one can maximize p(Ak, xk|Z k) with
respect to xk and ak. In this way it is possible to obtain a MAP estimate of xk and an ML estimate of the unknown
attack input ak.

k|k(·), p1

rk|k, p0

(cid:16)

(cid:17)
k|k(·, ·)

Remark 2: The Bayesian formulation of this section has allowed to generalize the standard joint input and state
ﬁltering process to take into account several practically relevant issues like the switching nature of the attack input,
the injection of fake measurements or replacement of system-originated by fake measurements, and the possible
lack of system-originated measurements. Please notice that all such phenomena are not contemplated in the standard
ﬁltering process.

Remark 3: The HBRS Bayesian ﬁltering recursions derived in this section are rarely solvable in explicit form
but, as it will be shown in the next section, this is possible in the linear-Gaussian case. In such a case, in fact, the
propagated PDFs p0
k|k(·, ·) turn out to be Gaussian mixtures at any time k, even if with a number of
Gaussian components growing with time and hence to be reduced via suitable pruning & merging procedures.

k|k(·) and p1

Remark 4: It is clear from the previous derivations that the defense method against signal attacks is embedded
in the proposed hybrid Bernoulli ﬁlter and can be coordinated with any of the defense methods against the two
considered data attacks, either packet substitution or extra packet injection. In fact, it sufﬁces to perform the correction
step of the HBF according to either Theorem 1 or Theorem 2 while the prediction step is clearly unaffected by
the choice of the data attack model. Please notice that packet substitution and extra packet injection attacks are
clearly alternative and that the HBF can switch from counteracting one or the other at any time, just by choosing
the appropriate correction step, depending on whether the system monitor receives a single or multiple data packets
during the sampling interval. The above described strategy could, therefore, provide a sensible way to coordinate
the defense methods against packet substitution and extra packet injection cyber-attacks.

IV. BAYESIAN RANDOM SET FILTER FOR JOINT ATTACK DETECTION AND STATE ESTIMATION –
THE NO DIRECT FEEDTHROUGH CASE

Suppose now that, even when the attack input is present, there is no direct feedthrough from the attack ak to

the output yk, so that the measurement model is

yk = h(xk) + vk

(54)

irrespectively of the presence of the attack. In this case, clearly, the attack set Ak must be estimated with one step
delay, since Zk+1 is the ﬁrst measurement set containing information on Ak. In the following sections, a detailed
derivation of the correction and prediction steps of the Bayes recursion in the case of no direct feedthrough is
provided.

A. Measurement models and correction

In the case of packet substitution with no direct feedthrough, the likelihood function λ(Zk|xk) takes the following

form:

λ(Zk|xk) =

(cid:40) 1 − pd,
pd

(cid:2)(1 − pf ) (cid:96)(yk|xk) + pf κ(yk)(cid:3),

if Zk = ∅

if Zk = {yk}

(55)

11

where (cid:96)(yk|xk) is the standard likelihood function of the system-generated measurement yk. It is easy to check that
the likelihood function λ(Zk|xk) integrates to one.

Instead, in the case of extra packet injection attack with no direct feedthrough, it can be shown that the likelihood

function λ(Zk|xk) can be written as



λ(Zk|xk) = γ(Zk)

1 − pd + pd

(cid:88)

yk∈Zk

(cid:96)(yk|xk)
n κ(yk)





(56)

where n denotes the cardinality of Zk, i.e. the number of received measurements.

Hence, the following result holds (the proof is omitted since it follows along the same lines as the proofs of

Theorems 1 and 2).

Theorem 4: (Correction without direct feedthrough) Suppose that the prior density at time k is hybrid Bernoulli

of the form

p(Ak−1, xk|Z k−1) =

(cid:40) (1 − rk|k−1) p0
rk|k−1 · p1

k|k−1(xk),

k|k−1(ak−1, xk),

if Ak−1 = ∅

if Ak−1 = {ak−1}

.

(57)

Then, given the measurement random set Zk for packet substitution attack, also the posterior density at time k turns
out to be hybrid Bernoulli of the form

p(Ak−1, xk|Z k) =

(cid:40) (1 − rk|k) p0
rk|k · p1

k|k(xk),

k|k(ak−1, xk),

if Ak−1 = ∅

if Ak−1 = {ak−1}

(58)

(cid:16)

(cid:17)
k|k(ak−1, xk)

rk|k, p0

k|k(xk), p1

completely specifying the posterior density can be computed as in
The triplet
Theorem 1 for the case of packet substitution and as in Theorem 2 for the case of extra packet injection attack,
provided that ak, Ak, and (cid:96)(yk|ak, xk) are replaced by ak−1, Ak−1, and (cid:96)(yk|xk), respectively.

B. Dynamic model and prediction

The joint transition density takes the form

where

π(Ak, xk+1|Ak−1, xk) = π(xk+1|Ak, xk) π(Ak|Ak−1)

π(xk+1|Ak, xk) =

(cid:40) π(xk+1|xk),

if Ak = ∅

π(xk+1|ak, xk),

if Ak = {ak}

(59)

(60)

with π(xk+1|xk) and π(xk+1|ak, xk) known Markov transition PDFs.

The transition density π(Ak|Ak−1) of the attack BRS takes the form

π(Ak|∅) =

π(Ak|{ak−1}) =

(cid:40) 1 − pb,
pb p(ak),
(cid:40) 1 − ps,
ps p(ak),

if Ak = ∅

if Ak = {ak}
if Ak = ∅

if Ak = {ak}

p(ak) is the PDF summarizing the available knowledge on ak, which can be taken equal to an uninformative PDF
(e.g., uniform over the attack space) when the attack vector is completely unknown.

Theorem 5: Given the posterior hybrid Bernoulli density p(Ak−1, xk|Z k) at time k of the form (58), fully
k|k(ak−1, xk)(cid:1), also the predicted density turns out to be hybrid Bernoulli

k|k(xk), p1

characterized by the triplet (cid:0)rk|k, p0
of the form

p(Ak, xk+1|Z k) =

(cid:40) (1 − rk+1|k) p0
rk+1|k · p1

k+1|k(xk+1),

k+1|k(ak, xk+1),

if Ak = ∅

if Ak = {ak}

(61)

with

rk+1|k =

p0
k+1|k(xk+1) =

(1 − rk|k)(1 − pb) pk+1|k(xk+1|∅)
1 − rk+1|k

+

(1 − rk|k) pb + rk|k ps
rk|k(1 − ps) pk+1|k(xk+1|{ak−1})
1 − rk+1|k

p1
k+1|k(ak, xk+1) =

(1 − rk|k) pb pk+1|k(xk+1|{ak}, ∅) p(ak)
rk+1|k

+

rk|k ps pk+1|k(xk+1|{ak}, {ak−1}) p(ak)
rk+1|k

where

pk+1|k(xk+1|∅)

pk+1|k(xk+1|{ak−1})

pk+1|k(xk+1|{ak}, ∅)

pk+1|k(xk+1|{ak}, {ak−1})

(cid:52)
=

(cid:52)
=

(cid:52)
=

(cid:52)
=

(cid:90)

π(xk+1|xk) p0

k|k(xk) dxk

(cid:90) (cid:90)

π(xk+1|xk) p1
(cid:90)

k|k(ak−1, xk) dak−1dxk

π(xk+1|ak, xk) p0

k|k(xk) dxk

(cid:90) (cid:90)

π(xk+1|ak, xk) p1

k|k(ak−1, xk) dak−1dxk.

12

(62)

(63)

(64)

(65)

(66)

(67)

(68)

Proof: The prediction equation is given by the following generalization of (12)

p(Ak, xk+1|Z k)

(cid:90) (cid:90)

=

π(Ak, xk+1|Ak−1, xk) p(Ak−1, xk|Z k) δAk−1dxk

(cid:90)

= (1 − rk|k)

π(Ak, xk+1|∅, xk) p0

k|k(xk) dxk

(cid:90) (cid:90)

+ rk|k

π(Ak, xk+1|{ak−1}, xk) p1

k|k(ak−1, xk) dak−1dxk

Then, for Ak = ∅, one has

p(∅, xk+1|Z k) = (1 − rk|k)(1 − pb)
(cid:90) (cid:90)

+ rk|k(1 − ps)

(cid:90)

π(xk+1|xk) p0

k|k(xk) dxk

π(xk+1|xk) p1

k|k(ak−1, xk) dak−1dxk

= (1 − rk|k) (1 − pb) pk+1|k(xk+1|∅) + rk|k (1 − ps) pk+1|k(xk+1|{ak−1}).

Analogously, for Ak = {ak} we obtain

p({ak}, xk+1|Z k) =

(cid:21)
(cid:20)
(1 − rk|k) pb pk+1|k(xk+1|{ak}, ∅) + rk|k ps pk+1|k(xk+1|{ak}, {ak−1})

p(ak).

Thus, the output of the prediction step is of the form (61), fully speciﬁed by (62)-(64).

V. GAUSSIAN-MIXTURE HYBRID BERNOULLI FILTER

k|k(·) and p1

While in general no exact closed-form solution to the proposed hybrid Bernoulli ﬁlter is admitted, for
the special class of linear Gaussian models, this problem can be effectively mitigated by parameterizing the
posterior densities p0
k|k(·, ·) via Gaussian mixtures (GMs) so as to derive a GM hybrid Bernoulli
ﬁlter. This approach can be generalized to nonlinear models and/or non-Gaussian noises via nonlinear
extensions of the GM approximation based on nonlinear ﬁltering techniques such as the Extended Kalman
Filter or the Unscented Kalman ﬁlter. In what follows, a detailed derivation of the GM hybrid Bernoulli
ﬁlter for linear-Gaussian models is provided. For the sake of brevity, only the direct feedthrough case
(Section III) is considered. The GM implementation in the case of no direct feedthrough (Section IV)
can be derived in a similar way.

Denoting by N (x; m, P ) a Gaussian PDF in the variable x, with mean m and covariance P , the
closed-form GM hybrid Bernoulli ﬁlter assumes linear Gaussian observation, transition, and (a priori)
attack models, i.e.

13

(cid:96)(yk|xk) = N (yk; Cxk, R)

(cid:96)(yk|ak, xk) = N (yk; Cxk + Hak, R)
π(xk+1|xk) = N (xk+1; Axk, Q)

π(xk+1|ak, xk) = N (xk+1; Axk + Gak, Q)
J a
(cid:88)

˜ωa,jN (a; ˜aj, ˜P a,j)

p(a) =

(69)

(70)

(71)

(72)

(73)

Note that (73) uses given model parameters J a, ˜ωa,j, ˜aj, ˜P a,j, j = 1, . . . , J a, to deﬁne the a priori PDF
of the signal attack, here expressed as a Gaussian mixture and supposed time independent.

In the GM implementation, each probability density at time k is represented by the following set of

parameters

j=1

(cid:16)

rk|k, p0

k|k(xk), p1

k|k(ak, xk)

(cid:17)

(cid:16)

=

rk|k, (cid:8)ω0,j

k|k, m0,j

k|k, P 0,j

k|k

k|k

(cid:9)J 0
j=1, (cid:8)ω1,j

k|k, m1,j

k|k, P 1,j

k|k

(cid:17)

(cid:9)J 1

k|k
j=1

where ω and J indicate, respectively, weights and number of mixture components, such that

p0
k|k(xk) =

p1
k|k(ak, xk) =

k|k

J 0
(cid:88)

j=1

k|k

J 1
(cid:88)

j=1

k|k N (m0,j
ω0,j

k|k, P 0,j
k|k )

k|k N (m1,j
ω1,j

k|k, P 1,j
k|k )

(74)

(75)

(76)

with m0

k|k = ˆx0

k|k, m1

k|k = [ˆx1T

k|k, ˆaT

k ]T , P 0
k|k

(cid:52)
= E[(xk − ˆx0

k|k)(xk − ˆx0

k|k)T ], P 1

(cid:52)
= E[(xk − ˆx1

P 1x
k|k
ˆak)T ]. The weights are such that (cid:80)J 0

k|k)(xk − ˆx1

k|k)T ], (P xa

k|k

k )T = P ax
k

(cid:52)
= E[(ak − ˆak)(xk − ˆx1

k|k)T ], P a
k

j=1 ω0,j

k|k = 1, and (cid:80)J 1

j=1 ω1,j

k|k

k|k = 1.

(cid:21)

(cid:20)P 1x
k|k P xa
k
k|k =
P a
P ax
k
k
(cid:52)
= E[(ak − ˆak)(ak −

, and

The Gaussian Mixture implementation of the Hybrid Bernoulli Filter (GM-HBF) is described as

follows.

A. GM-HBF correction for packet substitution

Proposition 1: Suppose that: assumptions (69)-(73) hold; the measurement set Zk is deﬁned by (3);
k|k−1(ak, xk)(cid:1);

the predicted FISST density at time k is fully speciﬁed by the triplet (cid:0)rk|k−1, p0
k|k−1(·), p1
p0

k|k−1(·, ·) are Gaussian mixtures of the form

k|k−1(xk), p1

p0
k|k−1(xk) =

k|k−1

J 0
(cid:88)

k|k−1N (m0,j
ω0,j

k|k−1, P 0,j

k|k−1)

p1
k|k−1(ak, xk) =

j=1

k|k−1

J 1
(cid:88)

j=1

k|k−1N (m1,j
ω1,j

k|k−1, P 1,j

k|k−1)

(77)

(78)

Then, the posterior FISST density (cid:0)rk|k, p0

k|k(xk), p1

k|k(ak, xk)(cid:1) is given by

14

rk|k =

p0
k|k(xk) =

p1
k|k(ak, xk) =

where

for i = 0, 1, while

rk|k−1

(79)

(1 − pf ) Ψ1 + pf κ(yk)
(1 − pf )(Ψ0 − rk|k−1Ψ) + pf κ(yk)
J 0
k|k
(cid:88)

J 0
k|k−1
(cid:88)

k|kN (m0,j
ω0,j

k|k, P 0,j

k|k) =

F,k|k N (m0,j
ω0,j

k|k−1, P 0,j

k|k−1) +

j=1

J 1
k|k
(cid:88)

j=1

k|kN (m1,j
ω1,j

k|k, P 1,j

k|k) =

j=1

J 1
k|k−1
(cid:88)

j=1

F,k|k N (m1,j
ω1,j

k|k−1, P 1,j

k|k−1) +

ωi,j
F,k|k =

ωi,j
¯F ,k|k

=

k|k−1

pf κ(yk) ωi,j
(1 − pf )Ψi + pf κ(yk)
(1 − pf ) ωi,j
(1 − pf )Ψi + pf κ(yk)

k|k−1

,

qi,j
k (yk)

J 0
k|k−1
(cid:88)

j=1

J 1
k|k−1
(cid:88)

j=1

¯F ,k|k N (m0,j
ω0,j

k|k, P 0,j
k|k)

(80)

¯F ,k|k N (m1,j
ω1,j

k|k, P 1,j
k|k)

(81)

(82)

(83)

q0,j
k (yk) = N (y; Cm0,j
q1,j
k (yk) = N (y; ˜Cm1,j

k|k−1, CP 0,j
k|k−1, ˜CP 1,j
k (yk), and Ψ1 = (cid:80)J 1
Proof: From Theorem 1, the corrected probability of signal attack existence is provided by (23) where

k|k−1CT + R)
˜CT + R)

= [C, H], Ψ0 = (cid:80)J 0

j=1 ω0,j

j=1 ω1,j

k|k−1q0,j

k|k−1q1,j

k (yk).

(85)

(84)

k|k−1

k|k−1

k|k−1

(cid:52)

with ˜C

Ψ0 is obtained by substituting (69) and (77) into (26), so that

(cid:90)

Ψ0 =

N (y; Cxk, R)

k|k−1

J 0
(cid:88)

j=1

k|k−1N (m0,j
ω0,j

k|k−1, P 0,j

k|k−1) dxk.

Then, by applying a standard result for Gaussian functions, [30, Lemma 1] we can write

(cid:90)

N (y; Cxk, R) N (m0,j

k|k−1, P 0,j

k|k−1) dxk = q0,j

k (yk)

where q0,j

k (yk) is given by (84) and, hence, (86) takes the form

Ψ0 =

k|k−1

J 0
(cid:88)

j=1

k|k−1q0,j
ω0,j

k (yk).

(86)

(87)

(88)

Moreover, Ψ1 in (79) can be analogously obtained by substituting (70) and (78) into (27), and by applying
Lemma 1 in Vo and Ma [30] to the (double) integral (cid:82)(cid:82) N (y; Cxk + Hak, R) N (m1,j
k|k−1) dakdxk,
so as to obtain

k|k−1, P 1,j

Ψ1 =

ω1,j
k|k−1q1,j

k (yk)

(89)

k|k−1

J 1
(cid:88)

j=1

where q1,j(yk) is given by (85) and m1,j

Next, the posterior density p0

k|k−1 = [(ˆx1

k|k−1)T , (ˆaj
k|k(·) can be derived from (24) in Theorem 1 as

k)T ]T .

p0
k|k(xk) =

pf κ(yk)
(1 − pf ) Ψ0 + pf κ(yk)

p0
k|k−1(xk) +

(1 − pf ) (cid:96)(yk|xk)
(1 − pf ) Ψ0 + pf κ(yk)

p0
k|k−1(xk).

(90)

15

(91)

(92)

By substituting (69) and (77) into (90), we obtain

p0
k|k(xk) =

k|k−1

J 0
(cid:88)

j=1

pf κ(yk) ω0,j
(1 − pf ) Ψ0 + pf κ(yk)

k|k−1

N (m0,j

k|k−1, P 0,j

k|k−1)

k|k−1

J 0
(cid:88)

+

j=1

(1 − pf ) ω0,j

k|k−1 N (y; Cxk, R)

(1 − pf ) Ψ0 + pf κ(yk)

N (m0,j

k|k−1, P 0,j

k|k−1).

Then, by applying Lemma 2 in Vo and Ma, [30] we can write
N (y; Cxk, R) N (m0,j

k|k−1, P 0,j
k (yk) has been deﬁned in (84), while m0,j
In the special case of linear Gaussian models, m0,j

k|k−1) = q0,j
k|k, P 0,j

where q0,j

k (yk) N (m0,j

k|k, P 0,j
k|k )

k|k have been introduced in (75).
k|k and P 0,j

k|k can be easily calculated following the
standard Bayes ﬁlter correction step, which in this case boils down to the standard Kalman ﬁlter for linear
discrete-time systems [28]:

k|k = m0,j
m0,j
k|k = (I − L0,j
P 0,j

k C)P 0,j

k|k−1

k|k−1 + L0,j

k (yk − Cm0,j

k|k−1)

where

L0,j
k = P 0,j
S0,j
k

k|k−1CT (S0,j
k )−1
k|k−1CT + R.

= CP 0,j

Thus, by substituting (92) into (91) with means and covariances given by (93)-(94), we can write

p0
k|k(xk) =

k|k

J 0
(cid:88)

j=1

k|k N (m0,j
ω0,j

k|k, P 0,j
k|k )

which consists of 2 J 0

k|k−1 Gaussian components, i.e.

p0
k|k(xk) =

k|k−1

J 0
(cid:88)

j=1

F,k|k N (m0,j
ω0,j

k|k−1, P 0,j

k|k−1) +

k|k−1

J 0
(cid:88)

j=1

ω0,j
¯F ,k|k

N (m0,j

k|k, P 0,j
k|k )

(93)

(94)

(95)

(96)

(97)

(98)

F,k|k, ω0,j

with weights ω0,j
out that J 0
of the system-originated measurement being replaced by a fake one yf
are the ones corrected under the hypothesis of receiving yk with probability 1 − pf .

¯F ,k|k given by (82)-(83) for i = 0. Note that, as it can be seen from (98), it turns
k|k−1, where the ﬁrst legacy (not corrected) components correspond to the hypothesis
k , while the remaining components

k|k = 2 J 0

Following the same rationale, analogous results can be obtained for p1

k|k(·, ·), with the exception that
also signal attack estimation has to be performed. By substituting (70) and (78) into (25) in Theorem 1,
we obtain

p1
k|k(ak, xk) =

k|k−1

J 1
(cid:88)

j=1

pf κ(yk) ω1,j
(1 − pf ) Ψ1 + pf κ(yk)

k|k−1

N (m1,j

k|k−1, P 1,j

k|k−1)

k|k−1

J 1
(cid:88)

+

j=1

(1 − pf ) ω1,j

k|k−1 N (y; Cxk + Hak, R)

(1 − pf ) Ψ1 + pf κ(yk)

N (m1,j

k|k−1, P 1,j

k|k−1).

Then, by applying Lemma 2 in Vo and Ma, [30] we can write
k|k−1) = q1,j
N (y; Cxk + Hak, R) N (m1,j

k|k−1, P 1,j

k (yk) N (m1,j

k|k, P 1,j
k|k )

(99)

(100)

k (yk) has been deﬁned in (85), while m1,j

where q1,j
models, m1,j
estimation of linear discrete-time systems [28], introduced in Section II-B. In particular, m1,j

k|k have been introduced in (76). For linear Gaussian
k|k can be calculated following the correction step of the ﬁlter for joint input and state
k|k consists of:

k|k and P 1,j

k|k, P 1,j

16

k|k = ˆx1,j
ˆx1,j
k = M j
ˆaj

k|k−1 + ˜L1,j
k (yk − C ˆx1,j

k|k−1)

k (yk − C ˆx1,j

k|k−1 − Hˆaj

k) = ˆx1,j

k|k−1 + L1,j

k (yk − C ˆx1,j

k|k−1)

where

k (I − HM j
k )
k|k−1CT (S1,j
k )−1
k|k−1CT + R

k = ˜L1,j
L1,j
˜L1,j
k = P 1x,j
S1,j
k
M j

= CP 1x,j
k = (cid:2)H T (S1,j
k|k can be computed as

k )−1H(cid:3)−1H T (S1,j

k )−1.

The elements composing P 1,j

k|k = (I − L1,j
P 1x,j
= [H T (S1,j
P a,j
k
= (P ax,j
P xa,j
k

k C)P 1x,j
k )−1H]−1
)T = − ˜L1,j

k|k−1

k

k HP a,j
k .

(101)

(102)

(103)

(104)

(105)

(106)

(107)

(108)

(109)

Thus, by substituting (100) into (99) with means and covariances given by (101)-(102) and (107)-(109),
we can write

k|k

J 1
(cid:88)

p1
k|k(ak, xk) =

k|kN (m1,j
ω1,j

k|k, P 1,j
k|k )

(110)

which comprises 2 J 1

k|k−1 components, i.e.

j=1

p1
k|k(ak, xk) =

k|k−1

J 1
(cid:88)

j=1

F,k|k N (m1,j
ω1,j

k|k−1, P 1,j

k|k−1) +

k|k−1

J 1
(cid:88)

j=1

ω1,j
¯F ,k|k

N (m1,j

k|k, P 1,j
k|k )

(111)

with weights ω1,j

F,k|k, ω1,j

¯F ,k|k given by (82)-(83) for i = 1.

B. GM-HBF correction for extra packet injection

Proposition 2: Suppose that: assumptions (69)-(73) hold; the measurement set Zk is deﬁned by (4);
k|k−1(ak, xk)(cid:1);
k|k−1(·, ·) are Gaussian mixtures of the form (77) and (78), respectively. Then, the posterior

the predicted FISST density at time k is fully speciﬁed by the triplet (cid:0)rk|k−1, p0
p0
k|k−1(·), p1
FISST density (cid:0)rk|k, p0

k|k−1(xk), p1

rk|k =

p0
k|k(xk) =

p1
k|k(ak, xk) =

k|k(xk), p1

k|k(ak, xk)(cid:1) is given by
1 − pd + pd Γ1
1 − pd + pd(1 − rk|k−1) Γ0 + pd rk|k−1Γ1
J 0
k|k
(cid:88)

J 0
k|k−1
(cid:88)

k|kN (m0,j
ω0,j

k|k, P 0,j

k|k) =

¯D,k|k N (m0,j
ω0,j

k|k−1, P 0,j

k|k−1) +

j=1

k|k

J 1
(cid:88)

j=1

ω1,j
k|kN (m1,j

k|k, P 1,j

k|k) =

j=1

k|k−1

J 1
(cid:88)

j=1

¯D,k|k N (m1,j
ω1,j

k|k−1, P 1,j

k|k−1) +

rk|k−1

(112)

J 0
k|k−1
(cid:88)

(cid:88)

yk∈Zk

j=1

k|k−1

J 1
(cid:88)

(cid:88)

yk∈Zk

j=1

D,k|k N (m0,j
ω0,j

k|k, P 0,j
k|k)

(113)

ω1,j
D,k|k N (m1,j

k|k, P 1,j
k|k)

(114)

where, for i = 0, 1,

and

ωi,j
¯D,k|k =

ωi,j
D,k|k =

,

(1 − pd) ωi,j
k|k−1
1 − pd + pd Γi
k|k−1qi,j
pd ωi,j
(1 − pd + pd Γi) n κ(yk)

k (yk)

Γ0 =

Γ1 =

J 0
k|k−1
(cid:88)

(cid:88)

yk∈Zk

j=1

J 1
k|k−1
(cid:88)

(cid:88)

yk∈Zk

j=1

ω0,j
k|k−1
n κ(yk)

ω1,j
k|k−1
n κ(yk)

q0,j
k (yk)

q1,j
k (yk).

17

(115)

(116)

(117)

(118)

Proof: We ﬁrst derive the corrected probability of signal attack existence, which can be directly written

from (41) as

rk|k =

1 − pd + pd Γ1
1 − pd + pd(1 − rk|k−1) Γ0 + pd rk|k−1Γ1

rk|k−1

(119)

where Γ0 is obtained by substituting (69) and (77) into (44), so that

(cid:90)

N (y; Cxk, R)

k|k−1

J 0
(cid:88)

j=1

Γ0 =

(cid:88)

yk∈Zk

k|k−1N (m0,j
ω0,j

k|k−1, P 0,j

k|k−1) dxk

n κ(yk)

.

(120)

Then, by applying (87), (120) takes the form (117). Moreover, Γ1 in (119) can be analogously obtained
by substituting (70) and (78) into (45), and by applying (100) which leads to (118).

Next, the posterior density p0

k|k(·) can be derived from (42) in Theorem 2 as

p0
k|k(xk) =

1 − pd
1 − pd + pdΓ0

p0
k|k−1(xk) +

pd
1 − pd + pdΓ0

(cid:88)

yk∈Zk

(cid:96)(yk|xk)
n κ(yk)

p0
k|k−1(xk).

(121)

By substituting (69) and (77) into (121), we obtain

p0
k|k(xk) =

k|k−1

J 0
(cid:88)

j=1

1 − pd
1 − pd + pdΓ0

k|k−1N (m0,j
ω0,j

k|k−1, P 0,j

k|k−1)

k|k−1

J 0
(cid:88)

(cid:88)

+

yk∈Zk

j=1

ω0,j
k|k−1

pd
1 − pd + pdΓ0

N (y; Cxk, R)
n κ(yk)

N (m0,j

k|k−1, P 0,j

k|k−1).

(122)

Thus, by substituting (87) into (122), with means and covariances given by (93)-(94), we can write

p0
k|k(xk) =

k|k

J 0
(cid:88)

j=1

k|kN (m0,j
ω0,j

k|k, P 0,j
k|k )

(123)

which comprises J 0
set Z at time k, i.e.

k|k−1(1 + |Zk|) components, where |Zk| denotes the cardinality of the measurement

p0
k|k(xk) =

k|k−1

J 0
(cid:88)

j=1

ω0,j
¯D,k|k

N (m0,j

k|k−1, P 0,j

k|k−1) +

k|k−1

J 0
(cid:88)

(cid:88)

yk∈Zk

j=1

D,k|k N (m0,j
ω0,j

k|k, P 0,j
k|k )

(124)

18

q0,h
k (yk)

with weights

ω0,j
¯D,k|k

=

ω0,j
D,k|k =

1 − pd + pd

(1 − pd) ω0,j
J 0
(cid:88)

(cid:88)

k|k−1

k|k−1
ω0,h
k|k−1
n κ(yk)

yk∈Zk

h=1
pd ω0,j
J 0
(cid:88)

k|k−1q0,j
k (yk)
ω0,h
k|k−1
n κ(yk)

k|k−1

yk∈Zk

h=1

(cid:104)

1 − pd + pd

(cid:88)

.

n κ(yk)

(cid:105)
q0,h
k (yk)

Note that, as it can be seen from (124), it turns out that J 0
k|k−1(1 + |Zk|),
where the ﬁrst legacy components correspond to the fact that no measurement has been delivered and
hence no update is carried out, while the remaining components are the ones corrected when one or
multiple measurements are received.
Following the same rationale, analogous results can be obtained for p1

k|k−1 + |Zk| J 0

k|k−1 = J 0

k|k(·, ·). From (43) in Theorem 2:

k|k = J 0

p1
k|k(ak, xk) =

1 − pd
1 − pd + pdΓ1

p1
k|k−1(ak, xk) +

pd
1 − pd + pdΓ1

(cid:88)

yk∈Zk

(cid:96)(yk|ak, xk)
n κ(yk)

p1
k|k−1(ak, xk). (125)

By substituting (70) and (78) into (125), we obtain

p1
k|k(ak, xk) =

k|k−1

J 1
(cid:88)

j=1

1 − pd
1 − pd + pdΓ1

k|k−1N (m1,j
ω1,j

k|k−1, P 1,j

k|k−1)

(126)

k|k−1

J 1
(cid:88)

(cid:88)

+

yk∈Zk

j=1

ω1,j
k|k−1

pd
1 − pd + pdΓ1

N (y; Cxk + Hak, R)
n κ(yk)

N (m1,j

k|k−1, P 1,j

k|k−1).

Thus, by substituting (100) into (126), with means and covariances given by (101)-(102) and (107)-(109),
we can write

p1
k|k(ak, xk) =

k|kN (m1,j
ω1,j

k|k, P 1,j
k|k )

(127)

which comprises J 1

k|k−1(1 + |Zk|) components, i.e.

j=1

p1
k|k(ak, xk) =

k|k−1

J 1
(cid:88)

j=1

ω1,j
¯D,k|k

with weights

N (m1,j

k|k−1, P 1,j

k|k−1) +

k|k−1

J 1
(cid:88)

(cid:88)

yk∈Zk

j=1

D,k|k N (m1,j
ω1,j

k|k, P 1,j
k|k )

(128)

k|k

J 1
(cid:88)

ω1,j
¯D,k|k

=

ω1,j
D,k|k =

1 − pd + pd

(cid:104)

1 − pd + pd

(cid:88)

q1,h
k (yk)

(1 − pd) ω1,j
J 1
(cid:88)

(cid:88)

k|k−1

k|k−1
ω1,h
k|k−1
n κ(yk)

yk∈Zk

h=1
pd ω1,j
J 1
(cid:88)

k|k−1q1,j
k (yk)
ω1,h
k|k−1
n κ(yk)

k|k−1

yk∈Zk

h=1

.

n κ(yk)

(cid:105)
q1,h
k (yk)

C. GM-HBF prediction

19

speciﬁed by the triplet (cid:0)rk|k, p0
k|k(ak, xk)(cid:1), and p0
form (75)-(76). Then the predicted FISST density (cid:0)rk+1|k, p0

Proposition 3: Suppose assumptions (69)-(73) hold, the posterior FISST density at time k is fully
k|k(·, ·) are Gaussian mixtures of the
k+1|k(ak+1, xk+1)(cid:1) is given by
(129)

k|k(·), p1
k+1|k(xk+1), p1

rk+1|k = (1 − rk|k) pb + rk|k ps

k|k(xk), p1

p0
k+1|k(xk+1) =

p1
k+1|k(ak+1, xk+1) =

k+1|k

J 0
(cid:88)

j=1

k+1|k

J 1
(cid:88)

j=1

k+1|kN (m0,j
ω0,j

k+1|k, P 0,j

k+1|k)

k+1|kN (m1,j
ω1,j

k+1|k, P 1,j

k+1|k)

(130)

(131)

where (130) comprises J 0

k+1|k = J 0

k|k + J 1

k|k components, i.e.

p0
k+1|k(xk+1) =

k|k

J 0
(cid:88)

j=1
(cid:124)

ω0,j
¯B,k+1|k

N (m0,j

¯B,k+1|k

, P 0,j

¯B,k+1|k

)

+

(cid:123)(cid:122)
no attack-birth

(cid:125)

k|k

J 1
(cid:88)

j=1
(cid:124)

ω0,j
¯S,k+1|k

N (m0,j

¯S,k+1|k

, P 0,j

¯S,k+1|k

(cid:123)(cid:122)
no attack-survival

(132)

)

(cid:125)

with

and

where ˜A

m0,j
P 0,j

¯B,k+1|k

¯B,k+1|k

= A m0,j
k|k
= AP 0,j

ω0,j
¯B,k+1|k

=

k|k AT + Q
(1 − rk|k)(1 − pb)
1 − rk+1|k

ω0,j
k|k

m0,j
P 0,j

¯S,k+1|k

¯S,k+1|k

= ˜A m1,j
k|k
= ˜AP 1,j
k|k

˜AT + Q

ω0,j
¯S,k+1|k

=

rk|k (1 − ps)
1 − rk+1|k

ω1,j
k|k

(cid:52)
= [A, G]. Moreover, (131) comprises J 1

k+1|k = J a(J 0

k|k + J 1

k|k) components, i.e.

p1
k+1|k(ak+1, xk+1) =

J 0
k|k
(cid:88)

J a
(cid:88)

h=1

j=1
(cid:124)

where

B,k+1|k N (m1,jh
ω1,jh

B,k+1|k, P 1,jh

B,k+1|k)

J 1
k|k
(cid:88)

J a
(cid:88)

+

S,k+1|k N (m1,jh
ω1,jh

S,k+1|k, P 1,jh

S,k+1|k)

(cid:123)(cid:122)
attack-birth

h=1

j=1
(cid:124)

(cid:125)

(cid:123)(cid:122)
attack-survival

(cid:125)

m1,jh

B,k+1|k =

P 1,jh
B,k+1|k =

ω1,jh
B,k+1|k =

(cid:35)

(cid:34)

(cid:34)

A m0,j
k|k
˜ah
AP 0,j

k|k AT + Q
0

(cid:35)

0
˜P a,h

(1 − rk|k) pb
rk+1|k

ω0,j
k|k ˜ωa,h

(133)

(134)

(135)

(136)

(137)

(138)

(139)

(140)

(141)

(142)

and

m1,jh

S,k+1|k =

P 1,jh
S,k+1|k =

ω1,jh
S,k+1|k =

(cid:35)

k|k

(cid:34) ˜A m1,j
˜ah
(cid:34) ˜AP 1,j

k|k

˜AT + Q
0

rk|k ps
rk+1|k

ω1,j
k|k ˜ωa,h.

20

(143)

(144)

(145)

(cid:35)

0
˜P a,h

Proof: The predicted signal attack probability comes directly from (49). Let us now derive the predicted

density p0

k+1|k(·). From (50) in Theorem 3:

p0
k+1|k(xk+1) =

(1 − rk|k) (1 − pb)
1 − rk+1|k
rk|k (1 − ps)
1 − rk+1|k
Using (71), (75) in the ﬁrst term and (72), (76) in the second term, we can rewrite

π(xk+1|ak, xk), p1

π(xk+1|xk), p0

k|k(xk) dxk

(cid:90) (cid:90)

+

(cid:90)

k|k(ak, xk) dakdxk.

(146)

p0
k+1|k(xk+1) =

(1 − rk|k) (1 − pb)
1 − rk+1|k

(cid:90)

N (x; Axk, Q)

k|k

J 0
(cid:88)

j=1

k|k N (m0,j
ω0,j

k|k, P 0,j

k|k ) dxk

+

rk|k (1 − ps)
1 − rk+1|k

(cid:90) (cid:90)

N (x; Axk + Gak, Q)

k|k

J 1
(cid:88)

j=1

k|k N (m1,j
ω1,j

k|k, P 1,j

k|k ) dakdxk. (147)

Hence, using Lemma 1 by Vo and Ma [30] in both the above terms, we ﬁnally derive (132):

p0
k+1|k(xk+1) =

k|k

J 0
(cid:88)

j=1

(1 − rk|k) (1 − pb)
1 − rk+1|k

k|k N (x; Am0,j
ω0,j

k|k, AP 0,j

k|k AT + Q)

j=1
In a similar fashion, we can obtain p1

p1
k+1|k(ak+1, xk+1) =

k|k

J 1
(cid:88)

+

rk|k (1 − ps)
1 − rk+1|k

k|k N (x; ˜Am1,j
ω1,j

k|k, ˜AP 1,j

k|k

˜AT + Q).

(cid:90)

k+1|k(·, ·). From (51) in Theorem 3:
(1 − rk|k) pb
rk+1|k
rk|k ps
rk+1|k

π(xk+1|ak, xk) p1

π(xk+1|xk), p0

(cid:90) (cid:90)

+

k|k(xk) dxk p(a)

k|k(ak, xk) dakdxk p(a)

which, using (71), (72), (73), (75) and (76), leads to

p1
k+1|k(ak+1, xk+1) =

(cid:90)

(1 − rk|k) pb
rk+1|k

N (x; Axk, Q)

J 0
k|k
(cid:88)

j=1

k|k N (m0,j
ω0,j

k|k, P 0,j

k|k) dxk

J a
(cid:88)

h=1

˜ωa,h N (a; ˜ah, ˜P a,h)

(cid:90) (cid:90)

+

rk|k ps
rk+1|k

N (x; Axk + Gak, Q)

J 1
k|k
(cid:88)

j=1

k|k N (m1,j
ω1,j

k|k, P 1,j

k|k) dakdxk

J a
(cid:88)

h=1

˜ωa,h N (a; ˜ah, ˜P a,h).

(148)

Finally, by applying the same result on integrals of Gaussians used above, we obtain (139):

p1
k+1|k(ak+1, xk+1) =

k|k

J 0
(cid:88)

J a
(cid:88)

j=1

h=1

(1 − rk|k) pb
rk+1|k

k|k ˜ωa,hN (x; Am0,j
ω0,j

k|k, AP 0,j

k|kAT + Q) N (a; ˜ah, ˜P a,h)

+

k|k

J 1
(cid:88)

J a
(cid:88)

j=1

h=1

rk|k ps
rk+1|k

k|k ˜ωa,hN (x; ˜Am1,j
ω1,j

k|k, ˜AP 1,j

k|k

˜AT + Q) N (a; ˜ah, ˜P a,h).

(149)

It is worth pointing out that, likewise other GM ﬁlters, also the proposed Gaussian Mixture Hybrid
Bernoulli Filter is characterized by a number of Gaussian components that increases with no bound over
time. As already noticed in the above derivation, at time k the GM-HBF requires

J 0
k|k =

(cid:40) 2 J 0

k|k−1,

packet substitution

J 0
k|k−1(1 + |Zk|),

extra packet injection

,

J 1
k|k =

(cid:40) 2 J 1

k|k−1,

packet substitution

J 1
k|k−1(1 + |Zk|),

extra packet injection

21

components to exactly represent the posterior densities p0

k|k(·, ·), respectively. Here

k|k(·) and p1
k−1|k−1,

J 0
k|k−1 = J 0
k|k−1 = J a(J 0
J 1

k−1|k−1 + J 1

k−1|k−1 + J 1

k−1|k−1)

denote the number of components generated in the prediction step. Heuristic pruning and merging
procedures [30] can be performed at each time step so as to remove low-weight components and combine
statistically close components and, hence, reduce the growing number of GM components.

Remark 5: The Gaussian-mixture implementation of this section has actually revealed a connection
between the proposed hybrid Bernoulli ﬁlter and the Kalman ﬁlter (KF) in that the former uses multiple
KFs (or EKFs/UKFs) to propagate in time means and covariances of the various components of the
Gaussian mixture (see eqns. (93)-(96), (101)-(109), (133)-(134) and (136)-(137)).

VI. NUMERICAL EXAMPLES

The effectiveness of the developed tools, based on Bayesian random-set theory, for joint attack
detection and secure state estimation of cyber-physical systems has been tested on two numerical ex-
amples concerning a benchmark linear dynamical system and a standard IEEE power network case-study.
Simulations have been carried out in the presence of both signal and extra packet injection attacks as
well as uncertainty on measurement delivery. Results on the performance of the GM-HBF under packet
substitution attack are shown in Section VI-B.

A. Benchmark linear system

Let us ﬁrst consider the following benchmark linear system, already used in the JISE literature [31]:

xk+1 = Axk + Gak + wk
yk = Cxk + Hak + vk

(150)

where A, C, R, and Q are the same as in Yong et al. [32], while G = [e1, e2] and H = [e3, e1], where
e1, . . . , e5 denote the canonical basis vectors. For this numerical study, the probabilities of attack-birth
and attack-survival are ﬁxed, respectively, at pb = 0.2 and ps = 0.8. The system-generated measurement
is supposed to be delivered at the monitor/control center with probability pd = 0.98, while the initial
signal attack probability is set to r1|0 = 0.1. The initial state has been set equal to x0 = 0, whereas both
densities p0(·) and p1(·, ·) have been initialized as single Gaussian components with ﬁrst guess mean
ˆx0
1|0 = 104 I5. Moreover, the ﬁrst estimate of the attack vector has
1|0 = [10, 10, 0, 0, 0]T and covariance P 0
been randomly initialized as ˜a1|0 = [15.1, 25.53]T , with associated initial covariance matrix ˜P a
1|0 = 50 I2.
The extra fake measurements are modeled as uniformly distributed over the interval [−0.3, 140.3]. Finally,
a pruning threshold γp = 10−3 and a merging threshold γm = 3 have been chosen. As shown in Fig.3,
at time k = 150 a signal attack vector a = [10, 20]T is injected into the system, persisting for 200
time steps. The proposed GM-HBF promptly detects the unknown signal attack, by simply comparing
the attack probability rk|k obtained in (41) with the threshold 0.5. Fig. 4 provides a comparison between
the true and the estimated values of states x1 and x2 (clearly the only state components affected by the
signal attack). Note that the state estimate is obtained by means of a MAP estimator, i.e. by extracting the
Gaussian mean with the highest weight from the posterior density p0(·) (42) or p1(·, ·) (43), according to
the current value of the attack probability. Finally, Fig. 5 shows how the attack estimates extracted from
p(a) of the two components of the attack vector, coincide with the actual values inside the attack time
interval [150, 350]. Note that outside that interval the estimates of the attack vector are not meaningful
because the attack probability rk|k is almost 0.

22

Fig. 3: True and estimated attack probability.

Fig. 4: True and estimated state components x1 and x2.

Fig. 5: True and estimated attack components a1 and a2.

B. IEEE 14-bus power network

State estimation is of paramount importance to ensure the reliable operation of energy delivery systems
since it provides estimates of the power grid state by processing meter measurements and exploiting power
system models. Cyber attacks on power systems can alter available information at the control center and
generate fake meter and input data, potentially causing power outage and forcing the energy management
system to make erroneous decisions, e.g. on contingency analysis and economic dispatch. The proposed
GM-HBF was tested on the IEEE 14-bus system (Fig. 6) consisting of 5 synchronous generators and 11
load buses, with parameters taken from MATPOWER [33]. The dynamics of the system can be described
by the linearized swing equation [34] derived through the Kron reduction [35] of the linear small-signal
power network model. The DC state estimation model assumes 1 p.u. (per unit) voltage magnitudes in all
buses and j1 p.u. branch impedance, with j denoting imaginary unit. The system dynamics is represented
by the evolution of n = 10 states comprising both the rotor angles δj and the frequencies ωj of each
generator j in the network. After discretization (with sampling interval T = 0.01s), the model of the
system takes the form (1)-(2), where the whole state is measured by a network Si of sensors. The system
is assumed to be corrupted by additive zero mean Gaussian white process and measurement noises with
v = 0.01. At time k = 50 a signal attack vector a = [0.2, 0.1]T p.u. is injected
variances σ2

w = 0.01 and σ2

050100150200250300350400450500Time step00.51050100150200250300350400450500Time step-50050100150050100150200250300350400450500Time step-100102030050100150200250300350400450500Time step01020050100150200250300350400450500Time step010203023

Fig. 6: Single-line model of the IEEE 14-bus system. The true victim load buses 3 and 9 are circled in red.

Fig. 7: Number of extra fake measurements injected (blue circles) and undelivered (pd = 0.95) system-originated
observations (red cross in −1) vs time. The proposed GM-HB ﬁlter turns out to be particularly robust to extra
packet injection attacks.

into the system to abruptly increase the real power demand of the two victim load buses 3 and 9 with an
additional loading of 21.23% and, respectively, 33.9%. This type of attack, referred to as load altering
attack [36], can provoke a loss of synchrony of the rotor angles and hence a deviation of the rotor speeds
of all generators from their nominal value. In addition, we ﬁxed the following parameters: pb = 0.05,
ps = 0.95, pd = 0.95, pruning and merging thresholds γp = 10−2 and γm = 3 for the Gaussian-mixture
implementation. Let us ﬁrst consider the system under extra packet injection attack. The additional fake
measurements injected into the sensor channels are modeled as uniformly distributed over the interval
[−10, 5], suitably chosen to emulate system-originated observations. Fake and missed packets are shown
in Fig. 7 for a speciﬁc run. The joint attack detection and state estimation performance of the GM-HBF
algorithm has been analyzed by Monte Carlo simulations. Fig. 8 shows the true and estimated probability
of attack existence (a) and the Root Mean Square Error (RMSE), averaged over 1000 Monte Carlo runs,
relative to the rotor angle (b) and frequency (c) estimates. Fig. 8 (d) shows the RMSE of the estimated
components of the signal attack, extracted from p1
k|k(a, x). As shown in the results (a)-(d), the proposed
secure state estimator succeeds in promptly detecting a signal attack altering the nominal energy delivery
system behavior, and hence in being simultaneously resilient to integrity attacks on power demand, and
robust to extra fake packets and undelivered measurements. Fig. 9 provides, for a single Monte Carlo
trial, a comparison between the true and the estimated values of the two rotor angles mainly affected
by the victim load buses, and clearly shows how δ1 and δ3 lose synchrony once the load altering attack

0102030405060708090100Time step-105101520Fake/undelivered measurements24

Fig. 8: Performance of the GM-HBF in terms of joint attack detection (a) and estimation of attack signal (b), rotor
angles δi, i = 1, . . . , 5 (c), and frequencies ωi, i = 1, . . . , 5 (d).

Fig. 9: Estimated vs true trajectory of rotor angles δj, j = 1, 3. Note that, if |δj| is sufﬁciently large (values close
to π/2), the linear small signal approximation signiﬁcantly deviates from the nonlinear dynamics of the system,
and hence the assumed dynamic model becomes inaccurate.

enters into action. Nevertheless, the proposed secure ﬁlter keeps tracking the state evolution with high
accuracy even after time k = 50, once recognized that the system is under attack.

Finally, Fig. 10 shows the performance of the GM-HBF in estimating the generator frequencies ω1
and ω3, before and after the appearance of the signal attack on the victim loads. The performance of the
proposed GM-HBF under packet substitution attack, i.e. the ﬁlter adopting the correction step described
in part 1) of Section III-A, is shown in Fig. 11 for pf = 0.3 and pd = 1. It is worth noting that the
probability of packet substitution pf can be seen as a design parameter which can be suitably tuned so as
to enhance estimation performance. This is illustrated in Fig. 12 where the mean (over time, components
and Monte Carlo runs) RMSE on state/attack estimation is shown as a function of parameter pf . By
contrast, simulation results indicated that the choice on pf does not signiﬁcantly affect the overall attack
detection performance.

0102030405060708090100Time step00.51(a)0102030405060708090100Time step00.51(c)0102030405060708090100Time step00.51(d)0102030405060708090100Time step0.20.40.60.811.2(b)0102030405060708090100Time step-2-10123Rotor angle [rad] true 1 estimated 10 + /2 - /2 true 3 estimated 30 estimated 31 estimated 1125

Fig. 10: Estimated vs true trajectory of frequencies ω1 and ω3.

Fig. 11: Performance of the GM-HBF under packet substitution attack (pf = 0.3) in terms of (a) attack detection,
(b) attack reconstruction, and (c)-(d) state estimation.

VII. CONCLUSIONS

This paper proposed a general framework to solve resilient state estimation for (linear/nonlinear) cyber-
physical systems considering switching signal attacks, fake measurement injection and packet substitution.
Random ﬁnite sets have been exploited in order to model the switching nature of the signal attack as
well as the possible presence of fake measurements, and a Bayesian random set estimation problem has
been formulated for jointly detecting a signal attack and estimating the system state. In this way, a hybrid
Bernoulli ﬁlter for the Bayes-optimal solution of the posed problem has been derived and implemented as
a Gaussian-sum ﬁlter. Numerical examples concerning both a benchmark system with direct feedthrough
and a realistic energy delivery system have been presented so as to demonstrate the potentials and the
real-world applicability of the proposed approach. Future work will concern worst-case performance
degradation analysis for the developed ﬁlter and its application to resilient state estimation in distributed
settings with non-secure communication links.

0102030405060708090100Time step-1-0.500.511.5Frequency [rad s-1] true 1 true 3  estimated 3  estimated 31 estimated 10  estimated 110102030405060708090100Time step00.51(c)0102030405060708090100Time step00.51(d)0102030405060708090100Time step00.51(b)0102030405060708090100Time step00.51(a)26

Fig. 12: Mean RMSE on state (generators’ rotor angles and frequencies) and attack estimation under packet
substitution attack as a function of ﬁlter’s parameter pf . Simulated packet substitutions occur with probability
¯pf = 0.1. The choice of pf can improve estimation performance (the best results are obtained when pf = ¯pf ) which,
however, turns out to be comparable for most parameter’s values in the set {10−5, 10−4, 10−3, 10−2, 0.1, 0.5, 0.9}.

REFERENCES

[1] “The Industrial Control Systems Cyber Emergency Response Team (ICS-CERT),” [Online]: https://ics-cert.us-cert.gov/.
[2] F. Pasqualetti, F. D¨orﬂer, and F. Bullo, “Attack detection and identiﬁcation in cyber-physical systems,” IEEE Transactions

on Automatic Control, vol. 58, no. 11, pp. 2715–2729, 2013.

[3] Y. Mo and B. Sinopoli, “Secure control against replay attacks,” Proc. 47th Allerton Conference on Communication, Control,

and Computing, pp. 911–918, 2009.

[4] F. Miao, M. Pajic, and G. Pappas, “Stochastic game approach for replay attack detection,” Proc. 52nd IEEE Conference

on Decision and Control, pp. 1854–1859, 2013.

[5] C. De Persis and P. Tesi, “Input-to-state stabilizing control under denial-of-service,” IEEE Transactions on Automatic

Control, vol. 60, no. 11, pp. 2930–2944, 2015.

[6] H. Zhang, P. Cheng, L. Shi, and J. Chen, “Optimal denial-of-service attack scheduling with energy constraint,” IEEE

Transactions on Automatic Control, vol. 60, no. 11, pp. 3023–3028, 2015.

[7] Y. Mo, S. Weerakkody, and B. Sinopoli, “Physical authentication of control systems: Designing watermarked control inputs

to detect counterfeit sensor outputs,” IEEE Control Systems Magazine, vol. 35, no. 1, pp. 93–109, 2015.

[8] S. Weerakkody and B. Sinopoli, “Detecting integrity attacks on control systems using a moving target approach,” Proc.

54th IEEE Conference on Decision and Control, pp. 5820–5826, 2015.

[9] Y. Mo and B. Sinopoli, “Secure estimation in the presence of integrity attacks,” IEEE Transactions on Automatic Control,

vol. 60, no. 4, pp. 1145–1151, 2015.

[10] H. Fawzi, P. Tabuada, and S. Diggavi, “Secure estimation and control for cyber-physical systems under adversarial attacks,”

IEEE Transactions on Automatic Control, vol. 59, no. 6, pp. 1454–1467, 2014.

[11] M. Pajic, I. Lee, and G. Pappas, “Attack-resilient state estimation for noisy dynamical systems,” IEEE Transactions on

Control of Network Systems, vol. 4, no. 1, pp. 82–92, 2017.

[12] Y. Shoukry, A. Puggelli, P. Nuzzo, A. Sangiovanni-Vincentelli, S. Seshia, and P. Tabuada, “Sound and complete state
estimation for linear dynamical systems under sensor attacks using satisﬁability modulo theory solving,” Proc. American
Control Conference, pp. 3818–3823, 2015.

[13] S. Mishra, Y. Shoukry, N. Karamchandani, S. Diggavi, and P. Tabuada, “Secure state estimation against sensor attacks in

the presence of noise,” IEEE Transactions on Control of Network Systems, vol. 4, no. 1, pp. 49–59, 2017.

[14] M. Chong, M. Wakaiki, and J. Hespanha, “Observability of linear systems under adversarial attacks,” Proc. American

Control Conference, pp. 2439–2444, 2015.

[15] A. Teixeira, I. Shames, H. Sandberg, and K. Johansson, “A secure control framework for resource-limited adversaries,”

Automatica, vol. 51, no. 1, pp. 135–148, 2015.

[16] D. Shi, R. Elliott, and T. Chen, “On ﬁnite-state stochastic modeling and secure estimation of cyber-physical systems,” IEEE

Transactions on Automatic Control, vol. 62, no. 1, pp. 65–80, 2017.

[17] N. Forti, G. Battistelli, L. Chisci, and B. Sinopoli, “A Bayesian approach to joint attack detection and resilient state

estimation,” Proc. 55th IEEE Conference on Decision and Control, pp. 1192–1198, 2016.

[18] N. Forti, G. Battistelli, L. Chisci, and B. Sinopoli, “Bayesian state estimation against unknown switching inputs and
extra packet injections,” IEEE Transactions on Automatic Control, 2019. Under review. [Online]. Available: http://www.
nicolaforti.com/wp-content/uploads/2019/02/728.pdf.

[19] Q. Gu, P. Liu, S. Zhu, and C.-H. Chu, “Defending against packet injection attacks in unreliable ad hoc networks,” Proc.

IEEE Global Telecommunications Conference, pp. 1837–1841, 2005.

10-510-410-310-210-110000.050.10.150.20.25mean RMSE   RMSE  attack RMSE   RMSE27

[20] X. Zhang, H. Chan, A. Jain, and A. Perrig, “Bounding packet dropping and injection attacks in sensor networks,” Tech. Rep.
07-019, CMU-CyLab, Pittsburgh, PA, USA, 2007. [Online]. Available: https://www.cylab.cmu.edu/ﬁles/pdfs/tech reports/
cmucylab07019.pdf.

[21] Y. Ho and R. Lee, “A Bayesian approach to problems in stochastic estimation and control,” IEEE Transactions on Automatic

Control, vol. 9, no. 4, pp. 333–339, 1964.

[22] B. Ristic, B.-T. Vo, B.-N. Vo, and A. Farina, “A tutorial on Bernoulli ﬁlters: Theory, implementation and applications,”

IEEE Transactions on Signal Processing, vol. 61, no. 13, pp. 3406–3430, 2013.

[23] R. Mahler, Statistical multisource multitarget information fusion. Artech House, Inc., 2007.
[24] B.-T. Vo, D. Clark, B.-N. Vo, and B. Ristic, “Bernoulli forward-backward smoothing for joint target detection and tracking,”

IEEE Transactions on Signal Processing, vol. 59, no. 9, pp. 4473–4477, 2011.

[25] B.-T. Vo, C. See, N. Ma, and W. Ng, “Multi-sensor joint detection and tracking with the Bernoulli ﬁlter,” IEEE Transactions

on Aerospace and Electronic Systems, vol. 48, no. 2, pp. 1385–1402, 2012.

[26] N. Forti, G. Battistelli, L. Chisci, and B. Sinopoli, “Secure state estimation of cyber-physical systems under switching

attacks,” IFAC-PapersOnLine, 20th IFAC World Congress, vol. 50, no. 1, pp. 4979–4986, 2017.

[27] H. Fang, R. De Callafon, and J. Cort´es, “Simultaneous input and state estimation for nonlinear systems with applications

to ﬂow ﬁeld estimation,” Automatica, vol. 49, no. 9, pp. 2805–2812, 2013.

[28] S. Gillijns and B. De Moor, “Unbiased minimum-variance input and state estimation for linear discrete-time systems with

direct feedthrough,” Automatica, vol. 43, no. 5, pp. 934–937, 2007.

[29] S. Gillijns and B. De Moor, “Unbiased minimum-variance input and state estimation for linear discrete-time systems,”

Automatica, vol. 43, no. 1, pp. 111–116, 2007.

[30] B.-N. Vo and W. Ma, “The Gaussian mixture probability hypothesis density ﬁlter,” IEEE Transactions on Signal Processing,

vol. 54, no. 11, pp. 4091–4104, 2006.

[31] Y. Cheng, H. Ye, Y. Wang, and D. Zhou, “Unbiased minimum-variance state estimation for linear systems with unknown

input,” Automatica, vol. 45, no. 2, pp. 485–491, 2009.

[32] S. Yong, M. Zhu, and E. Frazzoli, “Resilient state estimation against switching attacks on stochastic cyber-physical systems,”

Proc. 54th IEEE Conference on Decision and Control, pp. 5162–5169, 2015.

[33] R. Zimmerman, C. Murillo-Sanchez, and R. Thomas, “MATPOWER: Steady-state operations, planning, and analysis tools
for power systems research and education,” IEEE Transactions on Power Systems, vol. 26, no. 1, pp. 12–19, 2011.

[34] P. Kundur, N. Balu, and M. Lauby, Power System Stability and Control. McGraw-Hill, 1994.
[35] F. Pasqualetti, A. Bicchi, and F. Bullo, “A graph-theoretical characterization of power network vulnerabilities,” Proc.

American Control Conference, pp. 3918–3923, 2011.

[36] S. Amini, H. Mohsenian-Rad, and F. Pasqualetti, “Dynamic load altering attacks in smart grid,” Proc. Innovative Smart

Grid Technologies Conference, pp. 1–5, 2015.

