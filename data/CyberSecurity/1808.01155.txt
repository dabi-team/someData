8
1
0
2

g
u
A
3

]

R
C
.
s
c
[

1
v
5
5
1
1
0
.
8
0
8
1
:
v
i
X
r
a

1

Chapter1AdaptiveTrafﬁcFingerprintingforDarknetThreatIntelligenceHamishHaughey,GregoryEpiphaniou,HaiderAl-Khateeb,andAliDehghantanhaAbstractDarknettechnologysuchasTorhasbeenusedbyvariousthreatactorsfororganisingillegalactivitiesanddataexﬁltration.Assuchthereisacasefororganisationstoblocksuchtrafﬁc,ortotryandidentifywhenitisusedandforwhatpurposes.However,anonymityincyberspacehasalwaysbeenadomainofconﬂictinginterests.Whileitgivesenoughpowertonefariousactorstomasqueradetheirillegalactivities,itisalsothecornerstonetofacilitatefreedomofspeechandprivacy.Wepresentaproofofconceptforanovelalgorithmthatcouldformthefundamentalpillarofadarknet-capableCyberThreatIntelligenceplatform.ThesolutioncanreduceanonymityofusersofTor,andconsiderstheexistingvisibilityofnetworktrafﬁcbeforeoptionallyinitiatingtargetedorwidespreadBGPinterception.IncombinationwithserverHTTPresponsemanipulation,thealgorithmattemptstoreducethecandidatedatasettoeliminateclient-sidetrafﬁcthatismostunlikelytoberesponsibleforserver-sideconnectionsofinterest.OurtestresultsshowthatMITMmanipulatedserverresponsesleadtoexpectedchangesreceivedbytheTorclient.Usingsimulationdatageneratedbyshadow,weshowthatthedetectionschemeiseffectivewithfalsepositiverateof0.001,whilesensitivitydetectingnon-targetswas0.016±0.127.Ouralgorithmcouldassistcollaboratingorganisationswillingtosharetheirthreatintelligenceorcooperateduringinvestigations.HamishHaugheyUniversityofNorthumbria,Newcastle,England,e-mail:hamish.haughey@gmail.comGregoryEpiphaniouUniversityofBedfordshire,Bedfordshire,Englande-mail:gregory.epiphaniou@beds.ac.ukHaiderAl-KhateebUniversityofBedfordshire,Bedfordshire,Englande-mail:haider.alkhateeb@beds.ac.ukAliDehghantanhaUniversityofSalford,Salford,Englande-mail:A.Dehghantanha@salford.ac.uk1 
 
 
 
 
 
2

2HamishHaughey,GregoryEpiphaniou,HaiderAl-Khateeb,andAliDehghantanha1.1IntroductionThreatstoindividualsandorganisationsfromCyberattackershavebeenobservedsincetheearlydaysofcomputersandtheInternet[48].Threatactorshaveperpe-tratedvariousattacksrangingfromrelativelyinnocuoushoaxestomoreimpact-fulinstancesofsocialengineeringandreverseengineeringtoharvestcredentials,holdorganisationstoransomfortheirdata,orcauseactualphysicaldamagetosystems[30].Inresponsetothispersistentthreatfromawiderangeofactorswithvaryingmotivesandmethods,anumberofontologiesforCyberThreatIntelligence(CTI)haveappearedovertheyearssuchasSTIXandTAXII[10],OpenIOC[8],SCAP[39],VERIS[46],Cybox[9],andRIDandIODEF[25].Giventhatsomanyontolo-giesexisttoaddresssomeaspectofexchangingCTI,furtherworkhasattemptedtotaxonomisethesesystemstounderstandtheirdependenciesandinteroperability[6].Furthermore,itiswidelyacceptedthatacriticalpartofanorganisation’sCTIcapabilityrequiresthesharingofinformationwithtrustedpeers[2].Thisvariedse-lectionofofferingshighlightstheimportanceofstandardisation,asorganisationsarelikelytouseaparticularsolutionthatmayornotbecompatiblewiththatinusebyanotherorganisation.AgapinthecurrentofferingsappearstobeinsatisfactorilyaddressingPrivacyEnhancingTechnology(PET)asamediumforthreatactorstoperpetratetheirnefariousactivitiesundetected.Anexampleofthreatactorbehaviouristheuseofencryptedchannelsfordataex-ﬁltration[20],andthechallengefororganisationsinidentifyingorblockingknownbadnetworklocationshasincreasedduetothereadinesswithwhichPETisnowavailable.Organisationsarethenfacedwithachoice,toallowordisallowtrafﬁcoriginatingfrom,ordestinedfor,suchPETontheirnetworks.Thischoiceisfurthercomplicatedbytheopendebateonprivacyanddataprotection[13].Itiseasilyobservablethatlong-standingconcernsregardingprivacyandanonymitycontinuetogrowamongcertaingroups[47,35,17].Thismaynotcomeasasur-prise,consideringtheincreasingcapabilitiesofsomeorganisationstomonitorandreportonuserbehaviourindaytodayactivities[14].Fuellingthisdebate,therehavebeenrecentlegislationssuchastheInvestigatoryPowersBillintheUKproposedtorequireInternetServiceProviders(ISPs)andMobileOperatorstopreservemeta-dataontheactivitiesofeachInternetuser[56].ThishasresultedingreateruseovertimeofPETsuchasTheOnionRouter(Tor)[55,15],TheInvisibleInternetProject(i2p)[24],andFreenet[52],forawiderangeofreasons,andnolongerlimitedtocyber-espionageorillegalactivities.DeepPacketInspection(DPI)isasuitableexampleofatechniquetoextendanalysiscapabilitiestowardsencryptedtrafﬁc[61].Forinstance,whileDPIcannotbydefaultaccessencryptedstreams,itcouldstillfacilitatecensorshipbymeansofaDenial-of-Service(DoS)attackonPETbyanalysingIPandTCPheaders[61].CountermeasuresinthiscasefocusonobfuscatingPETtrafﬁc[63,60].Forexam-ple,Tor’sobfsproxy[43]isimplementedtomockthebehaviourofthewidelyusedTransportLayerSecurity(TLS)protocol,relyingontheessentialrolethatTLSplaysinothercommunications,andthefactthatitmustbepermittedasakeyrequirementtoenablee-commerceinagivenregion.3

1AdaptiveTrafﬁcFingerprintingforDarknetThreatIntelligence3ThereisaknownthreattousersofPETofpowerfuladversarieswithaccesstoAutonomousSystems(AS)orInternetExchanges(IX),whoareinstrongtacticalpositiontovieworgainaccesstolargeportionsofInternettrafﬁc,potentiallyal-lowingpassivetrafﬁcassociationtotakeplace[57,51].WhiletheTorthreatmodelstatesthatitdoesnotprotectagainstadversariesthatcanviewbothsidesofacir-cuit,theTorpathselectionalgorithmdoestakestepstoreducethechanceofthishappening[15,34]andthereforesuchanadversaryisobviouslyofconcerntothedevelopersandusersofthesystem.Inthisworkwepresentanovelalgorithmthatcouldactasafundamentalpil-larofaThreatIntelligencePlatformforusebyASandIXoperatorseitheralone,orincollaborationwithtrustedpeers.Thealgorithmmayallowoperatorstoiden-tifyencryptedconnectionsengaginginactivitythatisagainsttheiracceptableusepoliciesortermsandconditionsofuse.ThealgorithmﬁngerprintsTCPconnectionmeta-dataandsuppliesafullyautomatedroutinetoassistwiththeeffectivedegra-dationofun-traceabilityofPETusers.Theproposedalgorithmcombinesseveralpreviouslydocumentedtechniques.Thealgorithmcanclassifynetworkstreamsac-cordingtoﬂowmetrics,makeuseofBGPinterceptionifnecessarytoincreasetheattacksurfacefortrafﬁcassociation,andalsomanipulateserver-sidetrafﬁcdestinedfortheclient.OurinitialtestresultsshowthatMITMmanipulatedserverresponsesleadtoexpectedchangesreceivedbytheTorclient.Usingsimulationdatageneratedbyshadow,weshowthatthedetectionschemeiseffectivewithfalsepositiverateof0.001,whilesensitivitydetectingnon-targetswas0.016±0.127.Webelievethatthealgorithmcanbefurtherimprovedoradaptedinordertoimprovedetectionratesandefﬁcienciesinperformance.Ouralgorithmcouldassistcollaboratingorganisationswillingtosharetheirthreatintelligenceorcooperateduringinvestigations.Thetrafﬁcassociationmethodsalonemayproveusefultoroutingprovidersthatwishtoengageinintelligence-sharing,byallowingariskscoretobeassignedtoﬂowsthatdemonstrateparticularbehaviour.TCPﬂowmetricscouldbecombinedwithotherscoringmetricsthatserviceproviderswishtouse,ormayhighlightcan-didatesforthetrafﬁcmanipulationorBGPinterceptioncomponents.Suchcollabo-rationbetweenproviderscouldleadtoimprovedoverallrisk-reductionormayprovevaluableduringforensicsinvestigations.Theremainderofthischapterisstructuredasfollows:Section1.2containsback-groundanddiscussionofexistingworksdescribingattackanddefencemechanismsrelevanttoourwork.Then,Section1.3introducesanadaptivetrafﬁcassociationandBGPinterceptionalgorithm(ATABI)againstTor.Insection1.4wepresentourinitialexperimentationandresultsanddiscussthemin1.5.Finally,thechapterisconcludedinSection1.6.1.2BackgroundItisimportantforanyorganisationtohavesomehandleonthecommon,generic,andopportunisticattacksthattheymaybesubjectto.Forlargerormorerisk-averse4

4HamishHaughey,GregoryEpiphaniou,HaiderAl-Khateeb,andAliDehghantanhaorganisations,thereisacaseforbeingawareofmoretargetedattacks,andapplica-bleAdvancedPersistentThreats(APT)[42].Threatintelligencecanbegeneratedfromavarietyofresourcesthatatypicalorganisationhasaccessto,suchaswebserverlogs,ﬁrewalllogs,maillogs,antivirus,andhostornetworkintrusiondetec-tionsystems[38].Theconsumptionandinterpretationofsuchdatacanbecomeachallengeduetothelargevolumesoftengenerated,leadingtoacaseofbeingunabletoseethewoodforthetrees,orsearchingforaneedlesinahaystacks[45].Oftencriticaltoidentifyingthreatsisthechallengingtaskofdeﬁningthebaselineandunderstandingwhatnormalactivityactuallylookslike[59].Furthermore,threatsareeverevolving,andolderthreatsoftentendtobecomebenignasmoreeffectivetechniquestakeover,orwhenlawenforcementtakedowncommandandcontrolinfrastructure[41].TheprimarygoalofCTI,then,istoinformorganisationsofwhatthecurrentthreatsaresothatappropriateactionscanbetaken,withasmuchautomationaspossible[7].Tothisendmachinelearning,bigdataanalytics,andintelligenceshar-ingtechniqueshavebecomemorecommoninmodernSecurityandInformationandEventManagement(SIEM)andCTIsystems[50].Primarycustomersofsuchtech-nologyarealwaysgoingtobedeterminedbyfactorssuchastheirriskproﬁle,riskappetite,andofcoursethesizeoftheirsecuritybudget[7].1.2.1AnalysisofAttackVectorsinTorHavingavarietyofthreatintelligencesourcesincreasesanorganisation’sabilitytoidentifythreatsearlyoninatypicalseriesofsequentialactionsleadingtodatabreach.WherePETsuchasTorisconcerned,theabilitytoinjectrelaysallowsanobservertobecomeapartofthenetwork,andwhentheyareparticipatingasanentranceorexitnode,thesourceorthedestinationoftrafﬁccouldberecordedbyathreatmanagementplatform.Indeed,manyattacksagainstTorusersrequirevis-ibilityofboththeentranceandexittrafﬁc[34,57].InjectionofrelaysistypicallysimpletoachieveasPETsystemsaremostlydesignedtoallowanyonetoparticipateasauserorarouteroftrafﬁc[53,64,31,12,32,54,1,3,5].Assuch,adversariescaneasilyinitiaterogueroutersinordertoconductactivetrafﬁcanalysisbyinject-ingtrafﬁcintolegitimatecommunicationchannelsinanattempttoenumerateandanalyseunderlyingtrafﬁc[31,32].Thesecommonandeasy-to-deployattacksmayeffectivelyexposeanonymouscommunications,andthecurrentauthorsassertthattheymayalsogiveserviceprovidersandcollaboratingorganisationstheopportunitytorecordandshareob-servedbehaviouroriginatingfromspeciﬁclocations.Themoreroutersthatarecom-promisedbytheadversary,thegreatertheprobabilitythatcircuitswillstartbeingbuiltusingthoseroutersasentranceandexitnodes.ThiscomeswithaﬁnancialcostincreasingovertimewiththetotalnumberofTorrelaysinexistence.ItispossiblewiththisprerequisiteforaTorexitrelaytoinsertasignalintothetrafﬁcthatcanbedetectedbyanentryrelay[31].ThisisaccomplishedbymakingchangestotheTor5

1AdaptiveTrafﬁcFingerprintingforDarknetThreatIntelligence5applicationcodetocontrolatwhatpointwriteeventsaremade,whichresultinout-putbuffersbeingﬂushed.Bycontrollingwhethereitheroneorthreecells1aresentinanindividualInternetProtocol(IP)packet,itispossibletocreateabinarysignal.Ifthesignalcreatedbytheexitrelaymatchesthesignalreceivedbytheentryrelay,thentheuserwillbediscoveredalongwiththevisitedwebsite.Theobstaclethatmustbeovercomebyanadversarytoperpetratethisclassofattackisingettingthetargettouseentryandexitroutersbelongingtoanadversary,oringainingcontrolofroutersbelongingtootheroperators.SomeofthemostpowerfulattacksagainstPETarethosepossibleifanadversaryhasaccesstoASorIXroutinginfrastructure[33,21,62,34,18,51,57],asthispositiongreatlyincreasesthepossibilityofobservingtrafﬁcdestinedforserversthatareparticipatingasrelays.Morespeciﬁcally,ithasbeenreportedthattheprobabilityofanadversarywithIX-levelaccessservingASesappearingonbothsidesofacircuitismuchgreaterthanpreviouslyestimated[57].Thisisduetotrafﬁcbetweentheuserandtheentryrelay,andalsobetweentheexitrelayandwebsite,passingthroughseveralroutersexistinginmultipleASesandIXes.Anotherpreviousstudyconductedareal-worldanalysisofdistributionofIXesonTorentryandexitrelaynetworkpathstoestimatetheprobabilityofthesameIXorASappearingatbothendsofacircuit[34].ThisinvolvedrunningtracerouteanalysisfromTorclientstoentrynodes,aswellasfromremotedestinationwebsitesbacktoTorexitnodes.Allrouterpointsonthediscoveredroutewerethenassoci-atedwithanASandanIXusingavailableIPtoASnumberreferencesystemsandIXmappingdata.ItwasreportedthatonespeciﬁcAShada17%chanceofroutingtrafﬁcforbothendsofanestablishedcircuit,andaspeciﬁcIXhada73%chance[34].ThiswouldultimatelyallowcompletelypassiveanalysisandcorrelationoftrafﬁcforlargeportionsoftheTornetwork,andallowassociationofwebsiteinter-actionbyaToruser.Thisclassofattackhasahighlevelofsophisticationduetothelevelofaccessrequired,andalsoduetotheamountofprocessingpowernecessarytoanalysethetrafﬁcandcorrelatetrafﬁcpatterns.Organizationsthatdohavetherequiredaccesscouldmakeuseofthiscapabilitytoperpetratesuchattacksthem-selvesorshareitwithotherparties.ChangestotheTornodeselectionalgorithmhavebeensuggestedtoreducethefeasibilityofthisattackbytakingintoaccountspeciﬁcASesandIXesonthepathsbetweenrelaynodes[34].Ithasbeensuggestedthatlittleattentionhasbeengiventoapplication-levelat-tacksagainstlow-latencyanonymousnetworkssuchasTor[58].ApotentialattackwaspresentedinwhichattackerscompromisedmultipleroutersintheTornetworkwithonlyonewebrequesttode-anonymiseaclient.However,thereareseveralotherrequirementsandcaveats.Firstly,thetargetmustconstructcircuitsusingcompro-misedrelays.Secondly,separaterelaycommandsmustbesetupforeachrequestandit’snotclearwhetherthiswouldworkwithsimultaneousrequestssuchasthoseoverHTTP/1.1.Theattackisnotedasbecomingfarlesseffectiveiftheclientispar-ticipatinginconcurrentbrowsingactivity,asthiswilldiluteorcompletelyhidethesignalcreated.Furthermore,certainactivecircuitscanbemultiplexedoverasingle1Individualandequal-sized512byteunitofTortrafﬁc[15]6

6HamishHaughey,GregoryEpiphaniou,HaiderAl-Khateeb,andAliDehghantanhaOR1OR2OR3DBRPClientProvider1. Establish random virtual circuits with intermediate ORs2. Advertise the hidden greg.onion service to the DB3. Get the list of Ors and setup a rendezous point4. client sends an encrypted message to the provider listing the RP and one-time secret and asks an OR to deliver it to the provider5. the provider connects to FOLHQW¶V(cid:3)53(cid:3)DQG(cid:3)SURYLGHV(cid:3)his/her on-time secretChat roomBlog about security,etc6. Client and Provider proceed to use their circuits as normalWHOIS, IP discovery and geo-location DO NOT WORK HERE!Tor: Hidden Service ProtocolUnobservabilityUnidentifiability & UntraceabilityFig.1.1HiddenServicesProtocol[15]TCPstreamwithvariationsofthetrafﬁcpattern.Furtherdevelopmentsby[20]iden-tiﬁedthatHTTPGETrequestsaretypicallyencapsulatedwithinasingleTorcell.Theauthorsdiscussedhowpreviousworkonﬁngerprintinginsingle-hopencryptedconnectionssuchasSSHtunnelsoropenVPNwasbasedonthefactthatvariationsinwebassetsizesareusefulforallowingassociationofencryptedtrafﬁctoﬁnger-printedwebsites.However,sincetheintroductionofHTTP/1.1andthesupportforpersistentconnectionshandlingconcurrentrequests,suchattacksbecamelargelyin-effectiveduetooverlappingwebassetrequests.Asaresult,attentionquicklyturnedtopacketsizesandtiming.Animportantassumptionin[20]isthatHTTPGETrequestsexistinasingleoutboundcellfromtheclient.Thepropositionisthatbydelayingtheseoutboundpacketsbyasmallperiodbetweentheclientandtheentryguard,overlapsbetweenHTTPGETrequestsandserverresponsescanberemoved.Thiscreatesmuchcleanertrafﬁcpatternsforanalysisandcouldovercomeoneofthepossiblelimitationsof[58],asalreadydiscussed.1.2.2HiddenServicesThenatureofTorhiddenservicesprovidesanumberofchallengesincollectingandanalysingtrafﬁc,becausebytheirverydesigntheservicehostisintendedtoremainanonymous[15].Manyhiddenservices,or”deepnet”sitescanbefoundusingpub-liclyavailableindexes.SuchhiddenservicescanthenbeﬁngerprintedfortrafﬁcanalysisbyaTorclient,butthewiderchallengeisinidentifyingandproﬁlingsitesthatarenotindexedinthisway,oraccessiblebyinvitationonly.Thereisresearch7

1AdaptiveTrafﬁcFingerprintingforDarknetThreatIntelligence7intoattacksonhiddenservicesinTor[64,28,18],which,asstated,areasmuchofaproblemfortheproviderofthatserviceasthevisitinguserduetohiddenserviceoperatorsoftenwishingtoremainanonymous.Abriefoverviewofhiddenserviceoperationisprovidedinﬁgure1.1.ForTornetworksinparticular,runningahid-denservicecomeswiththegreatestriskduetotheeasewithwhichanadversarycanidentifytheservicehost[28].Threeseparateattacksnamelycircuitclassiﬁca-tion,circuitﬁngerprinting,andwebsiteﬁngerprintingagainstTorhiddenservicesweredescribedin[28]basedontheassumptionthatitispossibletoﬁngerprinttheprocessofconnectingtoahiddenservice.TheabilitytoidentifyhiddenservicesissigniﬁcantlygreaterthanassociationofnormaluserbehaviourduelargelytothemuchsmallernumberofhostsandtypicallymorestaticcontentprovidedbyhiddenservicescomparedtotheopenInternet[28].Adversarialoperatorsofhiddenservicedirectoriesmayrecordtheaddressesofotherwiseunadvertisedhiddenservicestolaunchapplicationlevelattacks[40].Therearemanywaysofcovertlytrackingauser’sbehaviourontheInternetsuchascookies,serverlogs,andwebbeacons.MostPETtechnologywillprovideorsup-portﬁt-for-purposeprecautionarymeasures[44].However,someattacks,especiallyagainsthiddenservices,maysimplytakeadvantageofthehumanfactor.Forex-ample,conﬁgurationerrorisalargeriskforinexperiencedusersofthei2psystem[11]aswellasTorhiddenservicehosts.Hiddenservicescanbeerroneouslyhostedonapublic-facinginterface,oronaserverthatotherwisealsohostspublicinfor-mationandgivesawayit’sidentitythroughprivatekeyﬁngerprintsorotheruniqueserviceinformation[11].ItisthereforerecognisedthatPETsystemsarevulnerabletoconﬁgurationerrors.1.2.3CombiningMethodsLittleresearchattentionhasbeendrawntothepossibilitythatwithsufﬁcientre-sources,apowerfuladversarycouldcombineseveraldocumentedattackstofurtheraugmentdegradationofanonymity.Suchcombinedmethodsarelikelytohavevary-ingcompatibilitywitheachotherbutthepotentialendresultwouldbesomecombi-nationofanincreasedsuccessrate,andareductioninnumberofresourcesrequiredaspartoftheattackitself.ConsideringtherangeofknownattackmethodsagainstPETintroducedabove,wewillnowpresentanovelalgorithm.Ouralgorithmcom-binesanumberofthesepreviousattackswithalevelofautomaticadaptationtoassistwithreductioninun-traceabilityofTorusers.ThiscanprovideafundamentalpillarofathreatintelligenceplatformcapableofidentifyingthreatsmakinguseofPET.8

8HamishHaughey,GregoryEpiphaniou,HaiderAl-Khateeb,andAliDehghantanha1.3AdaptiveTrafﬁcAssociationandBGPInterceptionAlgorithm(ATABI)Normally,theTorclientchoosesthreerelaynodestorouteencryptedtrafﬁc.Eachnodeinturnthenremovesalayerofencryption,beforetheunencryptedtrafﬁcleavesthenetworktowardsitsdestination.Therefore,andasdepictedinﬁgure1.2step1,serverresponsesdestinedfortheclientareunencrypteduntiltheyre-enterthetornetwork,unlessthewebsiteimplementsitsownTLSencryption.Oncethere-sponsesreachtheexitrelay(OR3)theyareencryptedwithintheTornetwork(step2).Responsestravellingbetweentheentryrelay(OR1)andtheclientarealsoen-cryptedaspartoftheestablishedTorcircuit(step3).Forsimpliﬁcation,thefollow-ingdescriptionassumesthatanentityisinterestedingeneratingthreatintelligencerelatingtoundesirableuseofPETontheirinfrastructurewithoutbeingconcernedaboutthepotentialrepercussionsofcarryingoutthemethodsdescribed.Amorepragmaticapproachmightbetocollaboratewithotherserviceproviderstoperformwiderpassiveanalysisandreconnaissance,andagreeingaboutcircumstancesthatcollaboratingentitiesarepermittedtomakeBGPannouncementsforthepurposesofassociationorinvestigation.ObviouslyoperatorscouldalsosharethenecessaryinformationwiththeircollaboratorswithouttheneedforBGPupdatestogainaddi-tionalnetworkvisibility.Aspreviouslymentioned,thepublishedresearchdoesnotcontainmanydetailedexamplesofcombiningknownattacksagainstTor,especiallygiventhehighlyad-vantageousManintheMiddle(MITM)positionprovidedtoanAS-orIX-levelentity.Forinstance,HTTPresponsetrafﬁccanbemodiﬁedwhilein-transitwithsophisticatedregularexpression(regex)searchandreplacemethods[29,36].WeproposethattheseorsimilartechniquescanbeusedbyanAS-orIX-levelentitytomanipulateserverresponsetrafﬁcsentbetweenwebsitesandTorexitnodesdes-tinedfortheuser.ThiswillallowmodiﬁcationofHTTPresponsessentbacktothebrowserinordertodirectlyaffectorcontrolclientbehaviour,whileremovingsomeoftheobstaclestopreviousattackssuchashavingtocompromisethewebsiteitselforforuserstohaveJavaScriptenabledintheirbrowser.ObviouslythiskindofattackisconsiderablyeasieroncleartextwebsitesasopposedtoHTTPSsitesemployingSecureSocketLayer(SSL)orTLSprotocols,asinthesecasestheadversarywouldalsohavetogainvisibilityofserver-sideencryptedtrafﬁc.ThereareseveralknownattacksagainstHTTPSthatadversariesmaybeabletoleveragetofacilitatethis,ortheymaysimplyhavegainedaccesstotheprivatekeysofarootorintermediatecertiﬁcateauthority[16,37].TheASorIXoperatormayinsteadwishtoinvestigatewatermarkingtechniquestoavoidcompromisingHTTPS.ThescopeofthisstudyislimitedtotestingHTTPtrafﬁconlyassumingthatHTTPSiseithernotenforced,orhasbeencompromised.LetusassumethatanASorIXoperatorhasidentiﬁedawebsiteforwhichtheywishtoidentifytheusers.IfthisentityhasthecapabilityofinstigatingaBGPinterceptionattack,thentheymightbeginbyenumeratingthelistofallpreﬁxes9

1AdaptiveTrafﬁcFingerprintingforDarknetThreatIntelligence9Tor NetworkEncrypted ResponsesWebsiteOR1OR2OR3123Unencrypted ResponsesEncrypted Tor trafficFig.1.2ServerResponsesinTorhostingTorrelaysthattheydonotalreadyhavevisibilityof,orperhapsforloca-tionsthattheybelievetobelikelysourcesofthetrafﬁc.Withthisinformationandtheknownpreﬁxofthedestinationwebsite,aBGPinterceptionattackcouldbelaunchedagainstallofthesepreﬁxes,thusgettingcompletevisibilityoftheentryandexittrafﬁcofinterest.ThechallengeisthentoassociatethewebsitetrafﬁcwiththeencryptedTorentrytrafﬁc.Wepresentanalgorithm1thatconsiderswhetherornotanadversaryalreadyhasvisibilityoftheirintendedtargetsandperformsBGPinterceptionifnecessary.Thealgorithmwaitsforatriggerconditionsuchasasecurityalert,indicatorofcompromise,ormanualinitiationbeforesavingallrequirednetworktrafﬁctodiskforanalysis.Ouralgorithmconsistsofthreecomponents:BGPinterception,MITMserverresponsemanipulation(usingMITMProxy[36]),andadetectionscheme.Thefullalgorithmcanbedescribedasfollows(seeﬁgure1.3):1.TheIX-leveladversaryinitiatesaBGPinterceptionagainstthesubjectsofinter-est,forinstanceadestinationwebsite.BGPinterceptioncanalsobeperformedtogainincreasedvisibilityofclienttoentry-sidetrafﬁc.2.Theadversaryroutesunencryptedwebserverresponsetrafﬁcthroughamanipu-latorinordertochangetheHTTPresponsesasrequired,forinstancebyinsertingassets.3.ThetrafﬁcthenenterstheTornetworkviatheexitrelay.Fromthispointbacktotheclient,responsesremainencryptedaspertheTorimplementation.4.Theadversaryperformstrafﬁcanalysiswiththedetectionschemeontrafﬁcdes-tinedfortheclientatpoint2(unencrypted)andpoint4(encrypted).Theexpectedoutcomeisthatasroutesstarttoconverge,theadversarygainsvisibilityofalltrafﬁcdestinedforthatwebsiteaswellastheproportionofTorentrynodetrafﬁcofinterest.TheMITMproxyconﬁgurationforcespageresponsestoincludelargeassetsthatincreasetrafﬁcforusersthattheadversarydesires.Asmentioned,thisattackhasahighlevelofsophisticationduetothetypeofaccessrequiredbyASorIXInternetroutingsystems.However,forentitieswiththatlevelofaccess,updatingroutingtoﬂowthroughanothersystemrunningsomeformofmanipulationsoftwarewouldbestraightforward.Webelievethatthisisentirelyachievableforaserviceproviderorgroupofcollaboratingproviders.Anumberofassumptionsbasedonpreviousresearchsupporttheproposedalgo-rithm.Firstly,weassumeitisfeasibletoassociatetrafﬁcbehaviourtoindividualsif10

10HamishHaughey,GregoryEpiphaniou,HaiderAl-Khateeb,andAliDehghantanhaTor NetworkEncrypted ResponsesWebsiteOR1OR2OR3134Unencrypted ResponsesBGP interceptionMITM Proxymanipulates Server Responses2Encrypted Tor trafficBGP interception1Fig.1.3AdaptiveTrafﬁcAssociationandBGPInterceptionbothsidesoftheconnectioncanbeobserved[31,22,23].Secondly,BGProutingat-tacksbyanASorIXoperatorcanallowobservationoflargeorspeciﬁcproportionsofInternettrafﬁc[51,57].Finally,HTTPSisnotalwaysimplemented,ormaybevulnerabletoarangeofattacks,andcanbevulnerabletowatermarkingtechniques[16,37].1.3.1BGPInterceptionComponentWeconsidertherecentlydisclosedattackknownasRAPTOR(RoutingAttacksonPrivacyinTor)[51],whichisafurtherdevelopmentonpreviousworkssuchas[57].Suchroutingattacksareoneexamplethatcouldplaceapowerfuladversaryatgreatadvantage,iftheyhaveaccesstocoreInternetroutinginfrastructure.Theseworksdescribethreemainassumptionsthatcanbeapproachedeitherindividuallyorincombinationtoincreasetheexploitabilityofthesystem.First,Internetroutingisasymmetricinitsnature.Inotherwords,thepaththatanoutgoingpackettakesisnotnecessarythesameasthatofitsreply,andvisibilityofonlyonedirectionofthistrafﬁcﬂowisrequiredtoanalysetrafﬁc.Thereforetheattacksurfaceandlikelihoodofexposuretoanadversaryperformingapassivetrafﬁcassociationattackaregreatlyincreased.Second,BGP”churn”overtimeduetonetworkchangesortransientissuessuchasrouterfailuresincreasesthechancesthataregularuserofTorwillcrosspathswithaparticularASorIX,facilitatingpassivetrafﬁcanalysis.Finally,itispossibleforanASoperatortomakefalseBGPannouncementsinordertohavetrafﬁcintendedforanotherASroutethroughtheirownroutersinanactiveattack,whichpositionsthemselvesonatargetcircuit.11

1AdaptiveTrafﬁcFingerprintingforDarknetThreatIntelligence11Theactiveattackcomesintwoversions,hijackandintercept.Thedrawbackofthehijackisthatthetrafﬁcneverreachesitsintendeddestinationandsotheclientexperiencewillbeinterrupted,potentiallyraisingthealarm,orcausinganewcircuittobebuilt.Aninterceptionontheotherhandallowsthetrafﬁctocontinuetoitsdes-tinationandtheclientsessionremainsactive.Therearethreepossiblescenariosfortheinterceptionattacknamely:1)theadversaryalreadymonitorsawebsiteorexitnodeandtargetsasetofknownTorentryrelays;2)theadversaryalreadymonitorstheclienttoentryrelaysideandtargetsknownTorexitrelays(oradestinationweb-site);3)theadversarytargetsbothentryandexittrafﬁcinordertoperformgeneralmonitoring,datagatheringandassociation.Itshouldbenotedthatwhiletheimpactofahijacktoauserisobvious,thereisnomentionoftheimpactonuserexperi-enceintermsoflatency,orpacketlosswhilethenewroutespropagateandconvergeduringaninterceptionattack.OncethisManintheMiddlepositionisachieved,thepreviousauthorsdiscussedthestrongfeasibilityoftrafﬁctimingattacks,especiallygiventhebeneﬁtsofasym-metricrouting.WeproposethatthisMITMpositioncanbeputtofurtherusetoprovidegreateradvantagebyperpetratingfurtherattacksincombination.1.3.2MITMComponentManipulatingtrafﬁcisusefulforaffectingclientbehaviour.Inalargesetofsimilarcandidateconnections,theabilitytoaffectthosethattheentityisinterestedinandseparatethemfromtherestisobviouslyavaluablecapability.Below,wedemon-strateinasimpletestthatmanipulationofserverresponsespriortoenteringtheTornetworkresultintheexpectedclientbehaviour.WeusedtheMITMProxyapplica-tiontoactasareverseproxyforApacheHTTPdinordertoreplace:</body>With:<imgsrc=”linktolargefile”width=”1px”/></body>Wesuggestthatanexampleofarealusecasemayinsteadneedtosimplyfor-wardtrafﬁcforallnon-targetdestinationsasrequiredwhilepatternmatchingtomanipulateonlyresponsesfromthetargetwebsite,andthisispossiblewithMITM-Proxyﬁlteroptions.Wetestedthe“--anticache”optionandfoundthistobeeffectiveagainstacachingserver(varnish)infrontofourtestwebserver.TheoutputasobservedinTORBrowserwithoutMITMProxywasasfollows:curl−−socks4a127.0.0.1:9050http://52.48.17.126/<html><head></head><body><divalign=”center”><p>Welcomehome!!!</p></div></body></html>AndwithMITMProxyrunningwithsearchandreplaceonthebodytagresultedto:12

12HamishHaughey,GregoryEpiphaniou,HaiderAl-Khateeb,andAliDehghantanhacurl−−socks4a127.0.0.1:9050http://52.48.17.126/<html><head></head><body><divalign=”center”><p>Welcomehome!!!</p></div><imgsrc=”/dsc0575.jpg”width=”1px”/></body></html>Notetheadditionalimagebeingincludedpriortotheclosingbodytag,whichisa3.5MBJPEGbutresizedtoonebyonepixelsoasnottobeobvious.Theimageinthistestalsoresidedonthewebserver,butcouldjustaseasilybehostedelsewhere.However,hostingassetswithanothersitemayrequirealterationstothedetectionscheme.1.3.3DetectionSchemeAlgorithm1includesthedetectionscheme,whichisusefulforﬁngerprintingcon-nectionsandconsistsofareductionfunctionbasedonasetofﬁltersappliedinsequence.Thegoalistoeliminateclientconnectionstreamsthatareunlikelytoberesponsiblefortheobservedserver-sidetrafﬁc,basedontheirmeta-data.Wepro-posethatthismaybeusefulinassigningariskscoretoanyclientconnectionsthatremainafterapplyingthedetectionscheme.SuchscoringmaybeusefulforlaterinterpretationoralertingbyBayesiananalysisormachinelearningsystems.Specif-ically,server-sidesessionsareﬁngerprintedbyrecordingspeciﬁcmetricsincludingthestartandendtimeoftheconnection(SCtinAlgorithm1),totalnumberofpack-etssenttotheclient(tp),averagetimedistancebetweensuccessivepackets(at),totaldatasent(td),andtotaltransmissiontime(tt).Similarmetricshavebeenusedinpreviousstudies[22,23,31],howeverwebelieveourspeciﬁcgenerationandtreatmentofthesemetricsisnovelinitsapproach.Thesamemetricsaregeneratedforallotherobservedconnections.Oncethisﬁngerprintingiscomplete,reductionbeginsbyﬁrstﬁlteringforonlyconnectionsthatﬁtwithinthesametimeperiodastheserver-sideconnection(CCt).Thereafter,remainingconnectionsareﬁlteredforsimilarityusingthesamemetricsalreadydis-cussedinturn,startingbyleavingonlythosewithsimilartotalnumberofpackets(CCtp),thensimilaraveragetimebetweenpackets(CCat),similartotaldatare-ceived(CCtd),andﬁnally,similartotaltransmissiontime(CCtt).Anyremainingclientconnectionsarereturnedaspossiblecandidatesfortheobservedserver-sideconnectioninquestion.Moreover,ourproposalisthataveragetimedistancebe-tweenindividualpacketscanactastheﬁlter,followedbysimilartotalamountofdatasent,andthenﬁnallysimilartotaltransmissiontime.Thedetectionschemeisadaptiveinthesensethataninitialtoleranceissetandifnocandidatesarefound,theﬁlterisperformedagainafterautomaticallyincreasingthetolerance.Inourinitialtests,weselectedabaseintervalof±1%forincreasingtolerances.Thisprovedeffectiveinourtests,butisadaptableandmayimprovedinfurtherwork.Thisoccursforeachofthediscussedmetricsinturn.Forexample,the13

1AdaptiveTrafﬁcFingerprintingforDarknetThreatIntelligence13Algorithm1TrafﬁcAssociation1:functionBGPINTERCEPT(target)2:InitiateBGPInterceptionagainsttarget3:4:functionCOMPUTESTATS(connection)5:tp=Totalnumberofpacketsinconnection6:at=Averagetimebetweenpacketsinconnection7:td=Totaldatasentinconnection8:tt=Totaldurationofconnection9:returntp,at,td,tt10:11:ifTargetwebsitetrafﬁcnotvisiblethenBGPInterceptwebsite12:13:ifSuspectclientstrafﬁcnotvisiblethenBGPInterceptclients14:15:whiletrigger6=1do16:Checkfortriggercondition17:18:whileServerConnection=activedo19:InitiateMITMmanipulationofserverresponses20:Saveallnetworktrafﬁctodisk21:22:forallServerConnectionsdo23:SCt=TimeframeofServerConnection24:SC=ComputeStatsserverconnection25:returnSC26:27:forallClientConnectionsdo28:CC=ComputeStatsclientconnection29:returnCC30:forallSCdo31:Setinitialtolerances32:CCt=listofCCwhereCCpacketsareinthesametimeframeasSCt33:34:CCtp=CCtwhereCCthassimilartotalnumberofpacketsasSC35:ifCCtp=0thenIncreasetoleranceby±1%andrepeat36:iftolerance≥maxtolerancethenStop37:38:CCat=CCtpwhereCCtphassimilaraveragetimebetweenpacketsasSC39:ifCCat=0thenIncreasetoleranceby±1%andrepeat40:iftolerance≥maxtolerancethenStop41:42:CCtd=CCatwhereCCathassimilartotaldatasentasSC43:ifCCtd=0thenIncreasetoleranceby±1%andrepeat44:iftolerance≥maxtolerancethenStop45:46:CCtt=CCtdwhereCCtdhassimilartotaltransmissiontimeasSC47:ifCCtt=0thenIncreasetoleranceby±1%andrepeat48:iftolerance≥maxtolerancethenStop49:50:returnSC,CCtt14

14HamishHaughey,GregoryEpiphaniou,HaiderAl-Khateeb,andAliDehghantanhacheckfortotalpacketssentwillincreasefrom±5%by±1%untilatleastonecan-didateisreturned,upuntilamaximumtolerancelevel.Maximumtoleranceswerechosensimplytoavoidthealgorithmcontinuingindeﬁnitelyuntilcandidatesarereturnedthatarehighlyunlikelytobethoseresponsiblefortheserver-sideconnec-tionofinterest.Anycandidatesfoundarepassedtothenextstepinthedetectionscheme.Thestartingtolerance,incrementalamount,andmaximumtoleranceareallconﬁgurableandwerechosenbythepresentauthorsduringtestingastheyprovedtobeeffectivewithourdata.Weanticipatethatfutureresearchwillallowtolerancevaluestobesetautomaticallybymachinelearningsystemsbasedonmeasurablefactorsincludingnetworkconditionssuchaslatency,packetloss,andjitter.Wewilldiscussexperimentalresultsfollowinginitialtestingofthedetectioncomponentofthealgorithm,andofferadiscussionofcurrentdesignandperfor-mance.Weuseseveralkeyperformanceindicators(KPI’s)usedintypicalbinaryclassiﬁcationsystemstoevaluatetheeffectivenessofthedetectionscheme.Ourra-tionaleforchoosingtheseKPI’swasduetothesimilaritytoclinicalstudiesinwhichatestisevaluatedbasedonitsabilitytocorrectlydiagnosemembersofapopula-tionwithacondition,whilekeepingfalsepositivestoaminimum.KPI’sincludesensitivity(se,percentageoftargetclientscorrectlyidentiﬁedascandidatesforaserver-sideconnection),speciﬁcity(sp,percentageofnon-targetclientswhoarecorrectlyexcludedfromthelistofcandidates),falsepositiverate(fpr,percentageofnon-targetclientswhoareincorrectlyincludedinlistofcandidates),andfalsenegativerate(fnr,percentageofvictimclientswhoareincorrectlyexcludedfromthelistofcandidates).Forcompleteness,wealsoreportthepositivepredictivevalue(ppv,percentageofincludedcandidateswhoweretrulyresponsible),andnegativepredictivevalue(npv,percentageofexcludedclientswhoweretrulynotresponsi-ble).1.4ExperimentationandResults1.4.1ExperimentSetupWeusedshadow[26]tocreatesimulatednetworksandgeneratePCAPdataforanalysis.Shadowwasusedduetobeingreadilyavailable,easilyaccessible,multi-threadingcapability,simulationoftransientnetworkissues,itsuseofrealTorcode,andthefactthatitisstillactivelymaintained[49].Shadowandshadow-plugin-torwerebuiltfromtheprojectsourcecodeavailableongithub.Thetgenpluginwasusedforthepurposesofgeneratingtrafﬁconthenetwork.ThispluginmakesuseofgraphmlXMLﬁlesthatcontrolthebehaviourofaparticularclientsuchaswhichserverstodownloadfrom,howlargeadownloadshouldbe,howmanydownloadstocomplete,andhowlongtopausebetweeneachdownload.ThelateststablereleaseofTorcode(0.2.7.6-2015-12-10,atthetimeofexperimentation)wasusedwithshadow-plugin-tor.15

1AdaptiveTrafﬁcFingerprintingforDarknetThreatIntelligence15Insizingoursimulationnetwork,wereferredto[19]inwhichtwoseparateex-perimentswereconductedasfollows;First,totestthefeasibilityofanattack,theau-thorsimplementedasmallscaleexperimentconsistingof20relays,190webclientsand10bulkclients.Secondly,Alargernetworkwasalsoconstructedbytheauthorsbasedontheworkof[27]consistingof400relays,3000clients,and400servers.Ourapproachwassimilar,implementingsmallnetworksforspeedofsimulationsinordertodebuganyproblems,andtodevelopandtestthedetectionscheme.Wethencreatedalargernetworkresultinginmoretime-consumingsimulationandgreaterdatagenerationforourtesting.AWSEC2instanceswereusedforrunningoursimulations.Withourtimeandbudgetaryconstraintsinmind,anm4.2xlargeAWSEC2instanceof8coresand32GBmemorywasusedtorunsimulationsonanetworkcontaining4authorityservers,400relays,1000clients,and400webservers.GenerationofthenetworktopologywasbasedontormetricsandserverdescriptorsforthemonthofApril2016(2016-04-30).The1000clientsincluded989similarwebclientsallsettodownloada350KiBﬁleevery60seconds,and10bulkclientssettodownloada5MiBﬁlerepeatedlywithoutpausing.Therewerealsotwo50KiB,1MiB,and5MiBclientsdownloadingevery60seconds.Theactualdownloadeddataisarbitraryandrandomlygeneratedbyshadowinordertoprovidesimulationdata.Tosimulateincreasedtrafﬁcforavictim(e.g.followingaMITMattack)asingledefaultwebclientasprovidedbyshadowwassettodownloada2MiBﬁle.Duetothefactthatshadowrecordssessioninformationforallclients,servers,andrelays,itisstraightforwardtoconﬁrmfromsimulationoutputwhichclientwasactuallyresponsibleforaparticularserverconnection.Theprocessforrunningaparticulartestofthedetectionschemewasautomatedandinvolvedthefollowingsteps:•Inspectthewebclientlogﬁleforasuccessfuldownloadandtakenoteofthetimeofthedownloadandnameofthedestinationwebserver.•Inspectthewebserverlogﬁleforthecorrectdownload(whichshadowhelpfullyconﬁrmsinthelogs)andtakenoteoftheconnectingexitrelaysessiontuple(IPandportnumber).•RunthealgorithmagainstthegivenwebserverPCAPﬁleandrecordconnec-tiontupleinformationofallclients’PCAPdatainordertodetectcandidatesforresponsibleclients.Thedetectionschemeisnotcurrentlymulti-threadedbutresultgenerationfordetectionperformancewasscriptedandsplitbetween16coresonac3.4xlargeEC2instancewith30GBmemory,andwith9000InputOutputOperationsPerSecond(IOPS).16

16HamishHaughey,GregoryEpiphaniou,HaiderAl-Khateeb,andAliDehghantanhaFig.1.4No.ClientsvsDetectionRunTime(s)Table1.1SingleDetectionResultMatrixTestResultClientTargetNonTargetTarget(tp=1)(fn=0)(t=1)NonTarget(fp=2)(tn=197)(nt=199)Total3197(n=200)1.4.2EvaluationCriteriaFigure1.4illustratesalinearincreaseinaverageruntimeofthedetectionschemeagainstasinglesessiontoidentifyaspeciﬁcclientamongstagroupof50,100,200,500,and1000clients.Thisisindicativeoftheonetomanyrelationshipbetweenatargetconnectiononaserver,andthevariablenumberofpotentialcandidates.ThedetectionschemewastestedbyimplementinginpythonagainsteveryclientinturnwithinaparticularsetofsimulationdataandthedetectionperformanceKPI’swerecalculated.Foragivendetectionattemptinanetworkofnclients,thetotalnumberoftargetstwillonlyeverbe1,withallotherclientsbeingnon-targets(nt=n−t).Thisisbecausethereisonlyeveroneclientthatwastrulyresponsibleforaspeciﬁcserver-sideconnection.Usingadiagnosticclassiﬁcationmatrix,theoutcomeforadetectionattemptcontainsvaluesfortruepositivestp,beingeither1or0;falsenegativesfn,(beingtheinverseoftpgiventhatthereisonlyeveronetruetarget);falsepositiveswhere0≤fp≤(nt−1);andtruenegativestnwhere0≤tn≤(n−1)andtn=nt−fp.Atypicaloutputfromourtestingisreﬂectedintable1.1.PerformanceKPI’sareallpercentagesintherange0≤KPI≤1.Sensitivityseiscalculatedasse=tptandwillalwaysbeeither1or0asthereisonlyonetarget.Speciﬁcityspiscalculatedassp=tnnt.Falsepositiveratefpriscalculatedasfpr=fpntor1−sp.Falsenegativeratefnrwillalwaysbe0or1andiscalculatedas17

1AdaptiveTrafﬁcFingerprintingforDarknetThreatIntelligence17Table1.2DetectionPerformanceComparisonTestABCDETestAVictimse0.016±0.1270.558±0.4970.485±0.5000.279±0.4490.008±0.0901.000sp1.000±0.0010.981±0.0140.986±0.0100.993±0.0061.000±0.0000.999fpr0.000±0.0010.019±0.0140.014±0.0100.007±0.0060.000±0.0000.001fnr0.984±0.1270.442±0.4970.515±0.5000.721±0.4490.992±0.0900.000ppv0.012±0.1000.073±0.1860.075±0.1920.065±0.1810.008±0.0900.500npv0.999±0.0001.000±0.0010.999±0.0010.999±0.0000.999±0.0001.000VictimDetected:TrueTrueFalseFalseFalseTruefnr=fntor1−se.Positivepredictivevalueisppv=tptp+fpandNegativepredictivevalueisnpv=tnfn+tn.1.4.3ResultsWeranthedetectionschemeagainstallclientsﬁvetimesforthelargestsimulationdata,varyingthepercentagesoftoleranceinordertoidentifywhethertherewasanoptimisedtoleranceforthedifferentmetrics.Tolerancesforeachmetricbeganat±5%ineverytestandasperthealgorithm,increasedby±1%untilcandidatesarereturnedoruntilthemaximumtoleranceisreached.Theseresultsarepresentedintable1.2.Thetolerancevaluestestedwere(numberofpackets,averagepackettime,totaldata,totaltime):52,32,2,1(A);100,50,25,5(B);50,50,25,5(C);50,50,10,5(D);25,25,5,1(E)TheresultstablealsoincludesacolumnshowingdetectionperformanceKPI’sfortheMITMvictimduringTest(A).Theﬁrsttest(A)usedtolerancevaluestai-loredtoachievethebestdetectionofthecorrectMITMvictimtarget.SubsequenttestswereperformedtoquantifydetectionKPIperformanceingeneral,andalsotestedagainsttheMITMvictim.Test(B)allowedamaximumtoleranceof±100%forsimilarnumberofpacketsandresultedinlargernumbersofcandidatestobeincludedforclassiﬁcationaccordingtotheothermetrics.TestresultsshowhowtheperformanceKPI’sareaffectedbychangingthemaximumtolerancevaluesofthealgorithm.Test(A)clearlyperformspoorlyoverall,howeverishighlysuccessfulintermsoftruepositiveandfalsepositiverates.Thismightbeexpectedastest(A)wasdesignedfordetectionoftheMITMvictim.Withthesemaximumtolerancevaluesset,thecorrecttargetwasidentiﬁedonly16timesoutof984totalattempts,whiledetectionperformanceoftheMITMvictimclientwiththesetolerancevalueswasveryhigh.DetectionoftheMITMvictimwasachievedwithasensitivityof1(averageforallotherdetectionsagainstnon-victims=0.016±0.127),speciﬁcityof0.999(average=1±0.001)andafalsepositiverateof0.001(average=0±0.001).Test(B)correctlyidentiﬁedtheMITMvictim,andalsocorrectlyidentiﬁedothertargetswithasensitivityof0.558±0.497andfalsepositiverateof0.019±0.014.18

18HamishHaughey,GregoryEpiphaniou,HaiderAl-Khateeb,andAliDehghantanhaDetectionperformancewhilstsearchingforthevictimwiththesetoleranceshadasensitivityof1andfprof0.003,whichindicatesanimprovementoverdetectionofnon-victims.Tests(C,D,E)allfailedtoidentifytheMITMvictimandachieveddecreasingdetectionperformanceKPI’saspertable1.2.1.5DiscussionOurtestsindicateapoordetectionperformanceforanyclientwhileusingmaximumtolerancesfortotalnumberofpackets,averageinter-packettime,andtotaldatasent,andlowermaximumtolerancefortotalconnectiontime(Test(B).WhiletheMITMvictimwasdetectedwiththesetolerances,threefalsepositiveswerealsoidentiﬁedascandidates.WithﬁnetunedtolerancesfortheMITMvictiminTest(A),detec-tionperformanceforothertargetsispoor,whilethevictimdetectionwassuccessfulwithjust1falsepositive.Thissuggeststhatgettingthetolerancesrightiscriticaltosuccess.Furthermore,withfurtherdevelopmentandtesting,tolerancescouldbeautomaticallydeﬁnedbasedonexternalfactorssuchasnetworkconditionsorfac-torsthattheadversarycancontrol,suchasthesizeornumberofinsertedassets.Itmayalsobeworthinvestigatingthesplittingofindividualconnectionsintosec-tionsthatcanbeindividuallyﬁngerprintedwiththesamemetrics.Therelationshipbetweensectionswhencomparingclienttoserver-sidetrafﬁcmayyieldimproveddetectionratesthankstotemporalvariationsinnetworkconditions.Wenotethattheruntimeperformanceofthedetectionschemeisnotcurrentlyscalable,andthatthereareopportunitiesforfurtherefﬁcienciestobeadded.Machinelearninginpar-ticularisofinterestasasolutionforeliminatingcandidateswhenperformingthetrafﬁcassociationelement.AgeneralstrengthofthisalgorithmisthatitdoesnotrequireTornodestobeinjectedorcompromised.Thealgorithmissimpliﬁedandonlyrequiresaverageandtotalstatisticstobecalculatedforsomeindividualﬂowmetadataforcomparison.Byusingaveragedataforconnectionsratherthanconsideringallinter-packettim-ingdataforcomparison,minortransientnetworkissuessuchasshort-termjitterandpacketlossareexpectedtohaveareducedimpactondetection,howeverfalseposi-tivesmaybemoreofaproblemwhenlargerdatasetsareavailable.Shadowallowsforrandomandtransientvariablessuchasbandwidth,computingpower,packetloss,andjittertobesimulatedinordertomimicrealnetworkconnectionsandwiththesedefaultmeasuresinplace,ourinitialresultsarepositive.Theapplicationlayercomponentofthisalgorithmreliesonvisibilityofunen-cryptedtrafﬁcbetweentheexitnodeandthedestination,incontrasttowatermark-ingtechniques,whichoperatepurelybyembeddingasignalintothepackettiming.PreviousattackssuchasSWIRLarealsoblind,meaningthataslongasthewater-markeranddetectorbothknowthewatermarkingsecret,nootherdataneedstobesynchronisedbetweenthem.Ourattackrequiresthatthemetadatadescriptorsofthe19

1AdaptiveTrafﬁcFingerprintingforDarknetThreatIntelligence19entry-andexit-sideconnectionbesharedwithwhicheversystemisperformingthealgorithm,atlessthan150bytesperconnection.Theattackalsoassumesthattheclientisonlyparticipatinginactivityononedestinationwebsite.Becausetheonionproxymultiplexesalloutgoingconnectionsthroughasingleconnectiontoanentryguard,ifseveralclientactivitiesarecon-currentthenthealgorithmwillnotcurrentlydealwiththis.However,ifweassumethatinmostcasesusersofTorwillbebrowsingonepageatanyonetime,thetimeslicingoftheclientsidemultiplexedconnectionwouldinthatcaseonlyincludetherelevantdatapertainingtotheobservedexit-sidetrafﬁc.WecurrentlymakenoattempttoremoveTorcontrolcellsfromtheclientsideconnectiondata.Thetolerancelevelinthealgorithmhelpstoaccountforthis,butafutureimprovementtothealgorithmmightwishtotakethisintoaccountasdis-cussedin[20].Totaldatareceivedbytheclientinaparticularwindowcouldsimplybeindicativeofclientbandwidthlimitations.Therefore,foragiventimewindowoftheexit-sidetrafﬁc,thereisariskthatotherToruserswithsimilarbandwidthrestrictionscouldappearinthesetofcandidates,eveniftheyareaccessingcom-pletelydifferentsites.Howeverthisstillallowsforcorrelationwiththeexit-sidetrafﬁcthankstotheinter-packettimingandtotaldatasentforindividualconnec-tions.Wealsonotethatcomparedtowatermarkingtechniques,theperformanceimpactofembeddinglargeassetswouldperhapsbemorenoticeableintextonlyapplications,image-sparseforums,orbulletinboardsystems.1.5.1UseCasesIthaspreviouslybeenpresentedthatasmallnumberofverylargeASesarenaturallyinapositiontoseeatleastoneendofacircuitduepurelytotheirsize[51].TenASeswereshowntohavevisibilityofatleast50%ofallTorcircuits,withsomeprovidersseeingover90%.Thiswouldplacetheseprovidersinaprimepositiontogeneratethreatintelligencedatapointsbasedontrafﬁcanalysis,ortoinitiateBGPupdatestohijackorintercepttrafﬁcduringinvestigations.TheinitialthreatintelligencegatheringcouldleadtotriggeringaBGProutingupdateundercertainconditions,suchasasecurityalert.ItisworthnotingthattherearenumerousentitiesandorganisationsthatmonitorBGPactivityontheinternetandreportsuspectedinterceptionincidents[4].Assuch,anomaliesaregenerallyreportedinforumsandnewssitesfairlyquicklywhentheydooccur.However,thisdoesnotimplythatorganisationswillnotcarryoutsuchmethodsanyway,onlythattheyaremorelikelytobedetected,reportedanddiscussed.Weimaginetwopreliminaryusecasesforouralgorithmduringinvestigations.Firstly,anadversarymayhavelittleornoideaofthelocationofthesourcesoftrafﬁcdestinedforaparticularwebsite.TheobjectiveherewouldbeawideBGPinterceptionattackagainstalltrafﬁcthattheadversarydoesnotalreadyhavevis-ibilityof.Thiswouldbealarge-scaleattackandrequiresigniﬁcantresourceforinjectingtheHTMLintoresponsesandprocessingthetrafﬁctoidentifythesources20

20HamishHaughey,GregoryEpiphaniou,HaiderAl-Khateeb,andAliDehghantanharesponsible.Analternativetoreducetheoverheadwouldbetoengageinanumberofsmallerattacksiteratingthroughmultiplesourcelocations.InthiscasetheBGPinterceptionattackswouldbetargetedatthesmallerIPrangesinsequencetogetherwiththedestinationifrequired.Asdiscussed,anotheralternativewouldbeifASorIXoperatorsparticipateinthreatinformationexchange,oragreetermsunderwhichsuchBGProutingupdatesareacceptable.Secondly,theadversarymayhaveagoodideaofwherethesourceoftrafﬁciscomingfrom,forinstanceinacriminalinvestigationwhereasuspectisbelievedtoresideinaparticulararea.Inthiscase,theadversarymaybefortunateenoughtoalreadyhavevisibilityoftherequiredIPrangesthankstoasymmetricroutingbutifnot,thenwouldonlyhavetoperpetrateamuchsmallerBGPinterceptionattackbasedonthesuspect’slocation.WhileourpresentedalgorithmappliestoTorclientsaccessingpublicInternetsites,similartechniquescouldbeappliedtoTorhiddenservices.Forinstance,ifanoperatorwastoﬁrstidentifyaremotehiddenservice,thentheycouldrepeatedlymakecustomrequeststoitduringawidespreadBGPinterceptionattack(orworkingwithcollaborators)whilerunningthedetectionscheme.Ifdetectionofthehiddenserviceweretoprovesuccessful,thenBGPinterceptionanddetectioncouldbeusedtoidentifyclientsofthehiddenservice,ortheadversarycouldtargetthehostingsystemdirectlyinotherways,leadingtofurtherattacks.1.5.2ProposedDefencesTomitigateagainsttheHTMLinjectioncomponent,Tornodescouldconsiderdisal-lowingport80/HTTPintheirexitpolicy.ThismaybestronglyadvisedinanycaseconsideringthetypicalToruser’sprivacyconcernsaswellasthewiderindustrymovingtowardsHTTPSeverywhere,andHTTPStrictTransportSecurity(HSTS).Ifblockingport80istooproblematicforuserexperienceorwebsitefunctionality,thentheonlyotheroptionisforwebsiteoperatorstocorrectlyimplementHTTPSandmakeuseofHSTS.UsersthatcaredeeplyabouttheirprivacyshouldinsistonusingHTTPSwebsitesandavoidtheuseofHTTPsitesforaccessingorshar-ingsensitiveinformation.ThiswillstillnothelpiftheadversaryhastheabilitytocompromiseHTTPS,butwouldmakesuccessfortheadversarysigniﬁcantlymoredifﬁcult,orforcetheuseofothermethodssuchaswatermarking.ThecountermeasuressuggestedbytheauthorsofRAPTOR[51]wouldallstillapplytotheroutingcomponentofthecurrentalgorithmandthereforedeserveamention.Monitoringwasproposedtoraiseawarenessofthepossibilityofincreasedtrafﬁcvisibilityduetoasymmetricrouting,BGPchurn,orroutingattacks,andtonotifyclientswhenapotentialdegradationofanonymityisidentiﬁed.BGPandtraceroutemonitoringwerebothsuggestedandtestedwithsuccessfulresultsre-ported.Itwasalsonotedthattraditionalcountermeasuresthatmanipulatepacketsizesortimingcomewithasigniﬁcantlatencyimpactandsowouldremoveoneofthemain21

1AdaptiveTrafﬁcFingerprintingforDarknetThreatIntelligence21beneﬁtsofTor.Anumberofalternativecountermeasureswereproposed,includingincorporatingtracerouteandASlookupsaspartofintelligentselectionofrelaystobuildcircuitsthatavoidroutescrossingthesameASmultipletimes.However,thismayresultinloweroverallentropyinTorcircuitselectionandgreaterprobabilityofadversarieswithlargenumbersofinjectedorcompromisedrelaysappearingonbothendsofacircuit.AnothersuggestedmitigationwasthatTorrelaysshouldadvertisepreﬁxesof/24toreducethecapabilityofBGPhijackorinterceptionattacks.Adversariescouldstilllaunchattacksbyadvertisingthesamepreﬁx,howevertheimpactoftheattackwouldbemorelocalizedtotheadversaryandmorewidespreadredirectionofInter-nettrafﬁcwouldnottakeplace.Tofurthermitigatethisreducedcapability,itwassuggestedthatclientscouldfavourguardrelaysthatarecloserintermsofnumberofAShops,butthatthiscouldrevealprobabilisticinformationaboutclients,andrequiresfurtherinvestigation.TheﬁnalsuggestedmitigationrequiresthatthewiderInternetmovestowardssecureinter-domainrouting,howeverthishasbeenslowtogetofftheground.1.6ConclusionandFutureWorkThisworkhaspresentedanovelalgorithm(ATABI)againsttheTornetworkbasedonthecombinationofpreviouslyreportedHTMLinjectiontechniqueswithBGProutingattacksandadetectionscheme.ThisalgorithmcouldformafundamentalpillarofaPET-capableCyberThreatIntelligenceManagementplatform.Asimpli-ﬁedversionoftheMITMcomponentwasperpetratedagainstabasicwebpagetoinsertalargehiddenassetatthebottomoftheHTML.ThischangeinthereturnedHTMLwasobservedintheresponsereceivedbytheTorclient.Thesuggestedde-tectionalgorithmyieldedpositiveresultsininitialtestsondatageneratedbytheshadowsimulatorforTor.DetectionperformanceofanMITMvictimwithlargetoleranceswasgoodwithafprof0.003,whileaveragegeneraldetectionperfor-manceofallclientswithoutMITMtrafﬁcmanipulationwaspoorwithsensitivityof0.558±0.497andfprof0.019±0.014.BytailoringthetolerancesfortheMITMvictimandrunningagainstallclients,generalperformancewasgreatlyreducedwithaveragesensitivityof0.016±0.127andaveragefnrof0.984±0.127,whilesensi-tivitywhensearchingforthevictimwas1withafprof0.001.Infutureresearchweintendtoevaluatewhethertemporalpatternsmanifestedthroughoutthedurationofasessioncanassistdetectionbysplittingsessionsandﬁngerprintingeachsection.WehopetoprovidemorepracticalexamplesofroutingattacksfacilitatingaMITMpositionandconsiderotherMITMtechnologiesorde-velopmentofadedicatedlightweightapplication.Withfurtherefﬁcienciessuchasmulti-threadingforanindividualattack,performancecouldbeincreasedtooperatewithlargerdatasets.IncreasedperformancemayalsobeachievedbyusingGPU,ordistributedcomputing.CombiningtheIX-leveladvantagewithotherpreviouscon-ceptssuchaswatermarkingschemes,sendingcustomrequeststohiddenservices,22

22REFERENCESordelayingGETrequestsbutattheexitsideratherthantheclientsidearealsoofinterest.Wealsoplanonperformingfurthersimulationsandexperimentstopro-ducemoredatainordertofurtheroptimisethetolerancelevelsforeachconnectionmetric,andprovidemoredataforpotentialtestingandimplementationofmachinelearning.GiventhelargenumberofCTIontologiesavailable,wewouldseebeneﬁtindevelopingouralgorithmtobeplatformagnostic.AworthwhileprojectwouldbethecreationofaPET-capableCyberThreatIntelligenceManagementPlatformthatcaninteroperatewithawiderangeofCTIontologies,withaviewtodrivingstandardisation,andwithouralgorithmasafundamentalpillar.Webelievethatthisvarietyofopportunitiestoperpetratepreviouslyknownat-tacksagainstPETmoreeffectivelyincombinationwithAS-orIX-levelaccessislikelytogainmoreresearchattentioninthefuture.ThislikelihoodisaugmentedespeciallyconsideringthechallengeofattributioninCTIfordarknet-basedthreatactivity.References[1]MichaelBackesetal.“(Nothingelse)MATor(s):MonitoringtheAnonymityofTor’sPathSelection”.In:Proceedingsofthe2014ACMSIGSACConfer-enceonComputerandCommunicationsSecurity.ACM.2014,pp.513–524.[2]SeanBarnum.“StandardizingcyberthreatintelligenceinformationwiththeStructuredThreatInformationeXpression(STIX)”.In:MITRECorporation11(2012).[3]ToddBaumeisteretal.“ARoutingTableInsertion(RTI)AttackonFreenet”.In:CyberSecurity(CyberSecurity),2012InternationalConferenceon.IEEE.2012,pp.8–15.[4]BGPMon.BGPMon.2016.URL:http://bgpmon.net/(visitedon10/31/2016).[5]NikitaBorisovetal.“Denialofserviceordenialofsecurity?”In:Proceed-ingsofthe14thACMconferenceonComputerandcommunicationssecurity.ACM.2007,pp.92–102.[6]EricWBurgeretal.“Taxonomymodelforcyberthreatintelligenceinforma-tionexchangetechnologies”.In:Proceedingsofthe2014ACMWorkshoponInformationSharing&CollaborativeSecurity.ACM.2014,pp.51–60.[7]Kim-KwangRaymondChoo.“Thecyberthreatlandscape:Challengesandfutureresearchdirections”.In:Computers&Security30.8(2011),pp.719–731.[8]MandiantCorporation.TheOpenIOCFramework.2017.URL:http://www.openioc.org/(visitedon01/03/2017).[9]TheMITRECorporation.CyberObservableeXpression.2017.URL:https://cyboxproject.github.io/(visitedon01/03/2017).23

REFERENCES23[10]TheMITRECorporation.STIX:StructuredThreatInformationeXpres-sion.2017.URL:https://stixproject.github.io/(visitedon01/03/2017).[11]AdrianCrenshaw.“Darknetsandhiddenservers:Identifyingthetrueip/net-workidentityofi2pservicehosts”.In:BlackHat(2011).[12]NormanDanneretal.“Effectivenessanddetectionofdenial-of-serviceat-tacksinTor”.In:ACMTransactionsonInformationandSystemSecurity(TISSEC)15.3(2012),p.11.[13]AliDehghantanhaandKatrinFranke.“Privacy-respectingdigitalinvestiga-tion”.In:Privacy,SecurityandTrust(PST),2014TwelfthAnnualInterna-tionalConferenceon.IEEE.2014,pp.129–138.[14]AliDehghantanha,NurIzuraUdzir,andRamlanMahmod.“Towardsaper-vasiveformalprivacylanguage”.In:AdvancedInformationNetworkingandApplicationsWorkshops(WAINA),2010IEEE24thInternationalConferenceon.IEEE.2010,pp.1085–1091.[15]RogerDingledine,NickMathewson,andPaulSyverson.Tor:Thesecond-generationonionrouter.Tech.rep.DTICDocument,2004.[16]ZakirDurumericetal.“Thematterofheartbleed”.In:Proceedingsofthe2014ConferenceonInternetMeasurementConference.ACM.2014,pp.475–488.[17]EFF.TheElectronicFrontierFoundation.2015.URL:https://www.eff.org/(visitedon10/30/2015).[18]JuanAElices,FernandoP´erez-Gonz´alez,etal.“LocatingTorhiddenservicesthroughaninterval-basedtrafﬁc-correlationattack”.In:CommunicationsandNetworkSecurity(CNS),2013IEEEConferenceon.IEEE.2013,pp.385–386.[19]JohnGeddes,RobJansen,andNicholasHopper.“Howlowcanyougo:Bal-ancingperformancewithanonymityinTor”.In:PrivacyEnhancingTech-nologies.Springer.2013,pp.164–184.[20]GaofengHeetal.“AnovelactivewebsiteﬁngerprintingattackagainstToranonymoussystem”.In:ComputerSupportedCooperativeWorkinDesign(CSCWD),Proceedingsofthe2014IEEE18thInternationalConferenceon.IEEE.2014,pp.112–117.[21]NguyenPhongHOANG,YasuhitoASANO,andMasatoshiYOSHIKAWA.“Anti-RAPTOR:AntiRoutingAttackonPrivacyforaSecurerandScalableTor”.In:IEEE.2015,pp.147–154.[22]AmirHoumansadrandNikitaBorisov.“SWIRL:AScalableWatermarktoDetectCorrelatedNetworkFlows.”In:NDSS.2011.[23]AmirHoumansadr,NegarKiyavash,andNikitaBorisov.“RAINBOW:ARo-bustAndInvisibleNon-BlindWatermarkforNetworkFlows.”In:NDSS.2009.[24]i2pProject.Geti2p.2015.URL:https://geti2p.net/(visitedon10/24/2015).24

24REFERENCES[25]InternetEngineeringTaskForce(IETF).RFC6545-Real-timeInter-networkDefense(RID).2017.URL:https://tools.ietf.org/html/rfc6545(visitedon01/03/2017).[26]RobJansenandNicholasHooper.Shadow:RunningTorinaboxforaccurateandefﬁcientexperimentation.Tech.rep.DTICDocument,2011.[27]RobJansenetal.“MethodicallyModelingtheTorNetwork.”In:CSET.2012.[28]AlbertKwon.“Circuitﬁngerprintingattacks:passivedeanonymizationoftorhiddenservices”.In:USENIXSecuritySymposium,201524thProceedingsof.USENIX.2015,pp.286–302.[29]SpiderLabs.Responder.2015.URL:https://github.com/SpiderLabs/Responder(visitedon10/28/2015).[30]RalphLangner.“Stuxnet:Dissectingacyberwarfareweapon”.In:IEEESe-curity&Privacy9.3(2011),pp.49–51.[31]ZhenLingetal.“Anewcell-counting-basedattackagainstTor”.In:IEEE/ACMTransactionsonNetworking(TON)20.4(2012),pp.1245–1261.[32]ZhenLingetal.“Equal-sizedcellsmeanequal-sizedpacketsinTor?”In:Communications(ICC),2011IEEEInternationalConferenceon.IEEE.2011,pp.1–6.[33]PeipengLiuetal.“EmpiricalMeasurementandAnalysisofI2PRouters”.In:JournalofNetworks9.9(2014),pp.2269–2278.[34]PeipengLiuetal.“IX-LevelAdversariesonEntry-andExit-TransmissionPathsinTorNetwork”.In:Networking,ArchitectureandStorage(NAS),2013IEEEEighthInternationalConferenceon.IEEE.2013,pp.166–172.[35]GaryTMarx.“What’sinaName?SomeReﬂectionsontheSociologyofAnonymity”.In:TheInformationSociety15.2(1999),pp.99–112.[36]MITMProxy.MITMProxy-Replacements.2015.URL:https://mitmproxy.org/index.html(visitedon10/28/2015).[37]BodoM¨oller,ThaiDuong,andKrzysztofKotowicz.“ThisPOODLEbites:exploitingtheSSL3.0fallback”.In:Google,Sep(2014).[38]ArsalanMohsenNiaandNirajKJha.“Acomprehensivestudyofsecurityofinternet-of-things”.In:IEEETransactionsonEmergingTopicsinComputing(2016).[39]NIST.SecurityContentAutomationProtocol.2017.URL:https://scap.nist.gov/index.html(visitedon01/03/2017).[40]GuevaraNoubirandAmiraliSanatinia.HoneyOnions:ExposingSnoop-ingTorHSDirRelays.2016.URL:https://www.defcon.org/html/defcon-24/dc-24-speakers.html#Noubir(visitedon07/10/2016).[41]OpeyemiOsanaiyeetal.“Ensemble-basedmulti-ﬁlterfeatureselectionmethodforDDoSdetectionincloudcomputing”.In:EURASIPJournalonWirelessCommunicationsandNetworking2016.1(2016),p.130.[42]HamedHaddadPajouhetal.“Atwo-layerdimensionreductionandtwo-tierclassiﬁcationmodelforanomaly-basedintrusiondetectioninIoTbackbonenetworks”.In:IEEETransactionsonEmergingTopicsinComputing(2016).25

REFERENCES25[43]TheTorProject.TheTorProject:obfsproxy.2016.URL:https://www.torproject.org/projects/obfsproxy.html.en(visitedon07/10/2016).[44]TheTorProject.WantTortoReallyWork?2015.URL:https://www.torproject.org/download/download.html.en%5C#Warning(visitedon10/25/2015).[45]DarrenQuickandKim-KwangRaymondChoo.“Bigforensicdatareduction:digitalforensicimagesandelectronicevidence”.In:ClusterComputing19.2(2016),pp.723–740.[46]VerizonSecurityResearchandCyberIntelligenceCenter.TheVERISFrame-work.2017.URL:http://veriscommunity.net/(visitedon01/03/2017).[47]Schneier,B.AnonymityWon’tKilltheInternet.2006.URL:http://archive.wired.com/politics/security/commentary/securitymatters/2006/01/70000?currentPage=all(visitedon10/18/2015).[48]KavehShaerpour,AliDehghantanha,andRamlanMahmod.“Asurveyoncyber-crimepredictiontechniques”.In:InternationalJournalofAdvance-mentsinComputingTechnology5.14(2013),p.52.[49]FatemehShirazi,MatthiasGoehring,andClaudiaDiaz.“Torexperimentationtools”.In:SecurityandPrivacyWorkshops(SPW),2015IEEE.IEEE.2015,pp.206–213.[50]DanielSunetal.“Non-intrusiveanomalydetectionwithstreamingper-formancemetricsandlogsforDevOpsinpublicclouds:acasestudyinAWS”.In:IEEETransactionsonEmergingTopicsinComputing4.2(2016),pp.278–289.[51]YixinSunetal.“RAPTOR:routingattacksonprivacyintor”.In:arXivpreprintarXiv:1503.03940(2015).[52]TheFreenetProject.TheFreenetProject.2002.URL:https://freenetproject.org/index.html(visitedon10/24/2015).[53]JuanPabloTimpanaro,IsabelleChrisment,andOlivierFestor.“Group-BasedCharacterizationfortheI2PAnonymousFile-SharingEnvironment”.In:NewTechnologies,MobilityandSecurity(NTMS),20146thInternationalConfer-enceon.IEEE.2014,pp.1–5.[54]JuanPabloTimpanaro,IsabelleChrisment,andOlivierFestor.“MonitoringanonymousP2Pﬁle-sharingsystems”.In:Peer-to-PeerComputing(P2P),2013IEEEThirteenthInternationalConferenceon.IEEE.2013,pp.1–2.[55]TorProject.TorProject.2015.URL:https://www.torproject.org/(visitedon10/03/2015).[56]GOVUK.Investigatorypowersbill.2016.[57]LaurentVanbeveretal.“Anonymityonquicksand:UsingBGPtocompro-miseTor”.In:Proceedingsofthe13thACMWorkshoponHotTopicsinNet-works.ACM.2014,p.14.[58]XiaogangWangetal.“ApotentialHTTP-basedapplication-levelattackagainstTor”.In:FutureGenerationComputerSystems27.1(2011),pp.67–77.26

26REFERENCES[59]SteveWatsonandAliDehghantanha.“Digitalforensics:themissingpieceoftheInternetofThingspromise”.In:ComputerFraud&Security2016.6(2016),pp.5–8.[60]ZacharyWeinbergetal.“StegoTorus:acamouﬂageproxyfortheToranonymitysystem”.In:Proceedingsofthe2012ACMconferenceonComputerandcom-municationssecurity.ACM.2012,pp.109–120.[61]PhilippWinterandStefanLindskog.“HowchinaisblockingTor”.In:arXivpreprintarXiv:1204.0447(2012).[62]PhilippWinterandStefanLindskog.“Howthegreatﬁrewallofchinaisblockingtor”.In:FreeandOpenCommunicationsontheInternet(2012).[63]PhilippWinter,TobiasPulls,andJuergenFuss.“ScrambleSuit:Apolymor-phicnetworkprotocoltocircumventcensorship”.In:Proceedingsofthe12thACMworkshoponWorkshoponprivacyintheelectronicsociety.ACM.2013,pp.213–224.[64]LuZhangetal.“Application-levelattackagainstTor’shiddenservice”.In:PervasiveComputingandApplications(ICPCA),20116thInternationalConferenceon.IEEE.2011,pp.509–516.