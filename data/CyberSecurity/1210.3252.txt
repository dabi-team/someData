Bad Data Injection Attack and Defense in
Electricity Market using Game Theory Study

Mohammad Esmalifalak†, Ge Shi‡, Zhu Han†, and Lingyang Song‡
†ECE Department, University of Houston, Houston, TX 77004
‡School of Electrical Engineering and Computer Science, Peking University, Beijing, China

2
1
0
2

t
c
O
0
1

]

R
C
.
s
c
[

1
v
2
5
2
3
.
0
1
2
1
:
v
i
X
r
a

Abstract—Applications of cyber technologies improve the qual-
ity of monitoring and decision making in smart grid. These
cyber technologies are vulnerable to malicious attacks, and
compromising them can have serious technical and economical
problems. This paper speciﬁes the effect of compromising each
measurement on the price of electricity, so that the attacker is
able to change the prices in the desired direction (increasing
or decreasing). Attacking and defending all measurements are
impossible for the attacker and defender, respectively. This
situation is modeled as a zero–sum game between the attacker
and defender. The game deﬁnes the proportion of times that
the attacker and defender like to attack and defend different
measurements, respectively. From the simulation results based
on the PJM 5-Bus test system, we can show the effectiveness and
properties of the studied game.

I. INTRODUCTION

Recently, power systems are becoming more and more
sophisticated in the structure and conﬁguration because of
the increasing in electricity demand and the limited energy
resources. Traditional power grids are commonly used to carry
power from a few central generators to a large number of
customers. In contrast, the new-generation of electricity grid
that is also known as the smart grid uses bidirectional ﬂows of
electricity and information to deliver power in more efﬁcient
ways responding to wide ranging conditions and events [1]
(Fig. 1).

Online monitoring of smart grid is important for control
centers in different decision making processes. State estima-
tion (SE) is a key function in building real-time models of
electricity networks in Energy Management Centers (EMCs)
[2]. State estimators provide precise and efﬁcient observations
of operational constraints to identify the current operating state
of the system in quantities such as transmission line loadings
or bus voltage magnitudes. Accuracy of state estimation can
be affected by bad data during the measuring process. Mea-
surements may contain errors due to the various reasons such
as random errors, incorrect topology information and injection
of bad data by attackers. By integrating more advanced cyber
technologies into the energy management system (EMS),
cyber-attacks can cause major technical problems such as
blackouts in power systems1[3], [4]. The attacks also can be
designed to the attacker’s ﬁnancial beneﬁt at the expense of
the general consumer’s net cost of electricity [6], [7].

1Aurora attack involves a cyber attack against breakers in a generating unit.
This experiment shows the abilities of cyber attackers in taking control over
breakers and consequently, it reveals the technical problems of this attack for
the power grid [5].

In this paper, we consider the case wherein the attacker
uses cyber attack against electricity prices. We show that the
attacker observes the results of the day–ahead market and
changes the estimated transmitted power in order to change
the congestion2 level, resulting in a proﬁt. On the other
hand, the defender tries to defend the accuracy of network
measurements. Since the attacker and defender are not able
to attack and defend all measurements, they will compete
to increase and decrease the injected false data, respectively.
This behavior is modeled by a two-person zero-sum strategic
game where the players try to ﬁnd the Nash equilibrium and
maximize their proﬁts. The results of simulations on the PJM
5-Bus test system show the effectiveness of attack on the prices
of electricity on the real–time market.

The remainder of this paper is organized as follows: The
literature survey is provided in Section II. The system model
is given in Section III, and the formulation of an undetectable
attack in the electricity market is given in Section IV. Section
V models the interactions between the attacker and defender
as a zero–sum game. Numerical results are shown in Section
VI, and the conclusion closes the paper in Section VII.

II. LITERATURE REVIEW

Due to the importance of the smart grid studies, some
surveys have classiﬁed the different aspects of smart grids
[10], [11], [12]. In [10] the authors explore three major
systems, namely the smart infrastructure system, the smart
management system, and the smart protection system and also
propose possible future directions in each system. In [11], a
survey is designed to deﬁne a smart distribution system as
well as to study the implications of the smart grid initiative
on distribution engineering. In [12] relevant approaches are
investigated to give concrete recommendations for smart grid
standards, which try to identify standardization in the context
of smart grids. National Institute of Standards and Technology
(NIST) in [13], explains anticipated beneﬁts and requirements
of smart grid.

Some researches have been done over cyber security for
smart grid [15], [16], [17], [18], [19], [20]. In [15], an unde-
tectable attack by bad data detectors (BDD) is ﬁrst introduced,

2Injected power in a speciﬁc node of power network, will be transferred to
different loads through transmission lines (using kirchoff’s law). In power
community we say congestion happens if increasing the power injection,
increases (at least one of) transmission lines power to their (its) thermal limit
[8], [9].

 
 
 
 
 
 
where the attacker knows the state estimation Jacobian matrix
(H) and deﬁnes an undetectable attack using this matrix. [16]
uses independent component analysis (ICA), and inserts an
undetectable attack even when this matrix is unknown for
attackers. In [17], the authors discuss key security technologies
for a smart grid system, including public key infrastructures
and trusted computing. Reliable and secure state estimation in
smart grid from communication capacity requirement point of
view is analyzed in [18]. In [19], a new criterion of reliable
strategies for defending power systems is derived and two
allocation algorithms have been developed to seek reliable
strategies for two types of defense tasks. [20] is a draft
from NIST which addresses the cyber security of smart grid
extensively. While most of current researches (in bad data
injection area) focus on different attack or defend scenarios,
our work describes a mutual interaction between both parties.
This work shows how the interest of one party (attacker or
defender) can inﬂuence the other’s interest.

Some applications of game theory in smart grids have been
studied in [21], [22], [23], [26]. In [21], the authors present a
method for evaluating a fully automated electric grid in real
time and ﬁnding potential problem areas or weak points within
the electric grid by using the game theory. In [22], the authors
propose a consumption scheduling mechanism for home and
neighborhood area load demand management in smart grid
using integer linear programming (ILP) and game theory. [23]
is a survey about some of game theory-based applications to
solve different problems in smart grid. In [26] the authors
model and analyze the interactions between the retailer and
electricity customers as a four-stage Stackelberg game.

Demand-side management (DSM), is another topic in smart
grid, which is recently considered by researchers. In [24] an
intelligent management system is designed based on the ob-
jective of orderly consumption and demand-side management,
under the circumstances of China’s smart grid construction.
An Intelligent Metering/Trading/Billing System (ITMBS) with
its implementation on DSM is analyzed by [25]. [27] is
a research on an autonomous and distributed demand-side
energy management system among different users.

III. SYSTEM MODEL

In power systems, transmission lines are used to transfer
generated power from generating units to consumers. Theo-
retically, transmitted complex power between bus i and bus j
depends on the voltage difference between these two buses,
and it is also a function of impedance between these buses. In
general, transmission lines have high reactance over resistance
(i.e. X/R ratio), and one can approximate the impedance of a
transmission line with its reactance. In DC power ﬂow studies,
it is assumed that the voltage phase difference between two
buses is small and that the amplitudes of voltages in buses are
near to unity. Transmitted power is approximated with a linear
equation [28]:

Fig. 1. Flow of energy and data between different parts of smart grids

where θi
is the voltage phase angle in bus i, and Xij is
the reactance of transmission line between bus i and bus
j. In the state-estimation problem, the control center tries
to estimate n phase angles θi, by observing m real-time
measurements. In power ﬂow studies, the voltage phase angle
(θi) of the reference bus is ﬁxed and known, and thus only
n − 1 angles need to be estimated. We deﬁne the state vector
as θ = [θ1, . . . , θn]T . The control center observes a vector z
for m active power measurements. These measurements can
be either transmitted active power Pij from bus i to j, or
injected active power to bus i (Pi =
Pij). The observation
can be described as follows:

P

z = P(θ) + e,

(2)

where z = [z1, · · · , zm]T is the vector of measured active
power in transmission lines, P(θ) is the nonlinear relation
between measurement z, state θ is the vector of n bus phase
angles θi, and e = [e1, · · · , em]T is the Gaussian measurement
noise vector with covariant matrix Σe.

Deﬁne the Jacobian matrix H ∈ Rm as

∂P(θ)
∂θ
If the phase difference (θi − θj) in (1) is small, then the linear
approximation model of (2) can be described as:

|θ= 0 .

H =

(3)

z = Hθ + e.

(4)

The bad data can be injected to z so as to inﬂuence the
state estimation of θ. Next, we describe the current bad data
injection method used in state estimators of different electricity
markets. Given the power ﬂow measurements z, the estimated
state vector ˆθ can be computed as:

ˆθ = (HT Σ−1

e H)−1HT Σ−1

e z = Mz,

(5)

(6)

Pij =

θi − θj
Xij

,

where

(1)

M = (HT Σ−1

e H)−1HT Σ−1
e .

Thus, the residue vector r can be computed as the difference
between measured quantity and the calculated value from the
estimated state:

r = z − Hˆθ.

(7)

Therefore,
residual are:

the expected value and the covariance of the

E(r) = 0 and cov(r) = (I − M)Σe,

(8)

False data detection can be performed using a threshold test

[29]. The hypothesis of not being attacked is accepted if

max
i

|ri| ≤ γ,

where γ is the threshold and ri is the component of r.

(9)

s.t.

IV. ATTACK IN ELECTRICITY MARKET

A power network is a typically large and complicated
system, which should be operated without any interruption.
Normal operation needs a system wide monitoring of the
states of network in speciﬁc time intervals. Based on the
monitored values, corrective actions need to be taken. Any
fault in measurement data (because of measurement failures
or cyber attack against them), can change the decisions of con-
trol center, which can cause serious technical or economical
problems in the network. In this section, we ﬁrst introduce the
electricity market structure, and then from the attacker point of
view we will formulate an undetectable attack that can change
the prices of electricity.

A. Optimal Power Flow (OPF) and DCOPF

Security and optimality of power network operation are
the most important tasks in control centers, which can be
achieved by efﬁcient monitoring and decision making. After
deregulation of electric industries, different services that can
improve security and optimality of network can be traded
in different markets. Energy market is one of these markets
in which generation companies (GENCO’s) and load serving
entities (LSE’s) compete to generate and consume energy,
respectively3. Control center knowing the submitted prices
and network constraints,
tries to maximize social welfare
for all participants. A well known program for solving this
optimization is Optimal Power Flow (OPF) program. Linear
form of optimal power ﬂow is called (DCOPF) and is used
to deﬁne the price of electricity (called locational marginal
prices or LMPs) in both day–ahead and real–time markets. In
the following subsections, the formulation of DCOPF together
with the general structure of day–ahead and real–time markets
is described.

3In an electricity (energy) market, GENCO’s submit their bids (for gener-
ating electricity) to the market. In this case, higher prices will decrease the
chance of supplying electricity (selling electricity). Similarly, LSE’s submit
their bids for consuming energy. In this case, lower bids will decrease the
chance of buying electricity. So competition in both entities (GENCO’s and
LSE’s) will increase the efﬁciency of the electricity market.

B. DC Optimal Power Flow (DCOPF)

i

In general, the LMP can be split into three components in-
cluding the marginal energy price LM P Energy
, marginal con-
gestion price LM P Cong
, and marginal loss price LM P Loss
[31], [32], [33]. A common model of the LMP simulation
is based on the DC model and
is introduced in [31]. It
Linear Programming (LP), which can easily incorporate both
marginal congestion and marginal losses. The generic dispatch
model can be written as

i

i

N

Xi=1

Ci × Gi,

min
Gi

N

Gi −

Di = 0,

Pi=1

GSFk−i × (Gi − Di) ≤ F max

k

N

Pi=1
N

(10)

, k ∈ {all lines},

Pi=1
Gmin

i ≤ Gi ≤ Gmax

i

, i ∈ {all generators},






where

number of buses;
generation cost at bus i in ($/MWh);
generation dispatch at bus i in ($/MWh);
demand at bus i in (MWh);

N
Ci
Gi
Di
GSFk−i generation shift factor from bus i to line k;
F max
k
Gmax
i
Gmin
i

transmission limit of line K;
upper generation limit for generator i;
lower generation limit for generator i.

The general formulation of the LMP at bus i can be written

as follows:

LM Pi = LM P energy + LM P cong
LM P energy = λ,

i

+ LM P loss

i

,

LM P cong
i

=

L

Xi=1

GSFk−i × µk,

LM P loss
i

= λ × (DFi − 1),

(11)
(12)

(13)

(14)

where L is the number of lines, λ is the Lagrangian multiplier
of the equality constraint, µk is the Lagrangian multiplier of
the kth transmission constraint, and DFi is delivery factor at
bus i. If the optimization model in (10) ignores losses, we
will have DFi = 1 and LM P loss
= 0 in (14). In this work
i
in order to emphasize the main point to be presented, the loss
price is ignored.

1) Day-Ahead Market: Based on the submitted bids (from
generators and loads) and predicted network condition4, con-
trol center runs the DCOPF program. The output of this market
speciﬁes the dispatch schedule for all generators and deﬁnes
the Locational Marginal Price (LMP) in each bus of power

4Such as the load level for the next day, which can be predicted by the

historical load data from the past years.

network. Trading electricity in most of electricity markets such
as PJM Interconnection, New York, and New England markets
is based on the LMP method.
2) Real–Time Market:

In this market the control center
conducts the following: 1- Gathers data from the measure-
ments that are installed in the physical layer (power network);
2- Estimates the states of the network (online monitoring of
the network); 3- Runs an incremental dispatch model based
on the state estimation results. The obtained LMP’s will be
considered as the real-time price of electricity5. The real–time
(Ex–Post) model which is used in Midwest ISO, PJM, and
ISO-New England, can be written as [34], [35]:

min
∆Gi

N

Xi=1

CRT

i × ∆Gi,

(15)

N

Pi=1
N

N

∆Gi −

∆Di = 0,

Pi=1

GSFk−i × (∆Gi − ∆Di) ≤ 0, k ∈ {CL},
Pi=1
i ≤ ∆Gi ≤ ∆Gmax
∆Gmin
,
≤ ∆Di ≤ ∆Dmax
∆Dmin
,
i

i ∈ {QG},
i ∈ {P L},

i

i

s.t.






i

i

and ∆Gmin

is the generation cost at bus i in ($/M W h)6,
where CRT
∆Gi is the change in the output of generator i, and ∆Di is
the change in the demand of dispatchable load at bus i in
(M W h), ∆Gmax
are the upper and lower bands
for change in the generation of each qualiﬁed generator (QG)7.
Similarly, ∆Dmax
are the upper and lower bands
for change in the consumption of each dispatchable load (DL).
Second constraint shows that any change in the transmitted
power in congested lines (CL), should be non–positive value.
Similar to day–ahead market, LMP in bus i (without con-

and ∆Dmax

i

i

i

sidering the effect of losses) will be,

word, if an attacker can change the measurement values8, the
results of state estimation and consequently results of real-time
market will be affected. Changing measurements’ data without
detection by BDD (which can bring ﬁnancial beneﬁts) is the
main goal of the attacker in this paper. In the previous section,
we described that the congestion in lines will change the price
of electricity in the network. Manipulating prices is a good
incentive for the attacker to compromise the measurements.
In order to manipulate the congestion level in a speciﬁc line,
the attacker needs to deﬁne the group of measurements that
can increase or decrease the congestion, then the attacker can
insert false data into the measurements. Equation (1), shows
that any change in voltage angle can change the transmitted
power through the line. For example, any increase/decrease in
△ˆθ = (ˆθi − ˆθj) will increase/decrease the transmitted power.
In online monitoring of power systems, the transmitted power
from bus i to bus j can be estimated with ˆPij =
, and
this equation together with equation (5) gives the following:

ˆθi− ˆθj
Xij

ˆPij =

ˆθi − ˆθj
Xij
= QT z = QT

=

(Mi − Mj)T
Xij
+z+ + QT

−z−,

z

(17)

Xij

+ and QT

where QT = (Mi−Mj)T
. The positive and negative arrays of
this vector are shown with QT
−, respectively. These
coefﬁcient vectors divide the measurements into two groups
z+ and z−, in which adding za > 0 to any array of z+
and z− will increase and decrease the estimated transmitted
power ﬂow, respectively. In this paper, the measurements in
z+ and z− are considered as group M and N , respectively9.
After deﬁning these groups, the attacker tries to insert an
undetectable bad data into the measurements. Assume z = z0
is the measurement values without corruption (safe mode).
From (7) residue for safe mode will be:

r0 = z − Hˆθ = z0 − H(Mz0).

(18)

LM P RT

i = λ +

L

Xi=1

GSFk−i × µk,

(16)

In the case of attack, z = z0 + za and the residue will be,

where, L is the number of lines, λ is the Lagrangian multiplier
of the equality constraint, and µk is the Lagrangian multiplier
of the kth transmission constraint.

r = z − Hˆθ = z0 + za − H(Mz0 + Mza)
= z0 − HMz0 + za − HMza = r0 + ra,

(19)

C. Cyber Attack Against Electricity Prices

where ra = (I − HM)za. From triangular inequality,

Real-time market uses the state estimator results that shows
the on-line state of the network. In order to transfer data to the
state estimator, control center uses different communication
channels such as power line communication channel. Using
these channels, increases the risk of cyber attack. In other

5Dispatch schedule will be similar to the day–ahead market and major

changes of load will be covered by the Ancillary Services.

6This price can be the same as day–ahead market or can be changed by

the generator in a speciﬁc time (i.e. 4P.M. – 6P.M. in PJM market).

7All PJM generation units that are following PJM dispatch instructions,
are eligible to participate in the real–time market (to set the real–time LMP
values), these generation units are called qualiﬁed generators.

k r k≤k r0 k + k ra k,

(20)

this equation shows that if k ra k=k (I − HM)za k is
small, with large probability control center can not distinguish
between k r k and k r0 k. So inserted attack will path the bad

8Attacker can carry out stealth attacks by corrupting the power ﬂow
measurements through attacking the Remote Terminal Units (RTUs), tam-
pering with the heterogeneous communication network or breaking into the
Supervisory Control and Data Acquisition (SCADA) system through the
control center ofﬁce Local Area Network (LAN) [14], [15].

9It is assumed that attacker knows H (and consequently M). Knowing the
location of attack, from (17), attacker can distinguish the measurements in
group M and N .

data detection if, k(I − HM)zak ≤ ξ. In this constraint ξ
is a design parameter for the attacker. Smaller values of ξ
will be more likely to be undetected by the control center [7].
However, the ability to manipulate the state estimation, will
be limited. we assume ξ is predetermined by the attacker. In
order to change congestion, attacker will deﬁne the inserted
false data using the following optimization,

max
za

.

za(i) −

za(j),

(21)

Xi∈{M}

Xj∈{N }

s.t.

(cid:26)

k(I − HM)zak ≤ ξ,
za(k) = 0 ∀ k ∈ {SM},

where za(i) is the ith element of attack vector za. Group M
and N consist of measurements that increasing and decreasing
their value will increase the congestion. Objective of the above
optimization is to increase and decrease measurements value in
group M and N , respectively. First constraint is for avoiding
detection of the attack by bad data detector in state estimator.
Group SM shows the safe measurements that can not be
compromised (such as those protected by Phasor Measurement
Units). With inserting the resulted attack vector za to the actual
values of measurements (z = z0+za), the attacker will change
the estimated transmitted power in the attacked line. From
(17), this change will be

∆ ˆPij =

(Mi − Mj)T
Xij

za.

(22)

While the attacker tries to increase this change, the defender
tries to decrease it by defending the measurements that have
high risk of being attacked. Changing the estimated power
ﬂow in a speciﬁc line will increase the chance of changing
prices in both sides of the attacked line10. Either increasing or
decreasing congestion can bring ﬁnancial beneﬁts for attacker.
1) Decreasing The Congestion: In day–ahead market the
attacker buys at lower price LM P DA
and sells at higher
< LM P DA
price LM P DA
). The difference of
two prices should be paid to the transmission company as the
congestion prices. In the real–time market, because of decreas-
ing congestion, the congestion price paid by the attacker is less
than the supposed congestion price in the day–ahead market
so the proﬁt of this trade in $/M W h will be:

(LM P DA

j

j

i

i

Cng = CongestionDA
P Dec
= (LM P DA

P rice − CongestionRT
) − (LM P RT

j − LM P DA

i

P rice
j − LM P RT

i

).

(23)

a speciﬁc transmission line in a deﬁned time and location to
transmit a speciﬁc value of power. In real–time market with
creating congestion, FTR can be sold (with higher price) to
any Load Serving Entities (LSE’s).

In the next section, we will analyze the behavior of both
attacker and defender in the real–time market. Limitation in
attack (to) and defend (from) different measurements makes a
difﬁcult situation for both parties. Mathematical modeling of
this behavior in the next section, is an efﬁcient answer to the
question of where should I attack? and where should I defend?
for the attacker and the defender, respectively.

V. GAMING BETWEEN ATTACKER AND DEFENDER

In order to protect line L, the defender needs to protect
group M and group N . Because the inserted attack will
pass the BDD in state estimation (ﬁrst constraint in (21)), the
control center should use some other detection methods. For
example, the defender can put some secure measurements into
random locations in the network. The main problem in this
procedure is that defending all measurements is not possible.
On the other hand, it is impossible for the attacker to attack
all measurements. Instead it tries to attack measurements that
have the most effect on the state estimator without being
detected by the control center. This behavior can be modeled
with a zero–sum strategic game between the attacker and the
defender11.

A. Two-Person Zero-Sum Game Between Attacker and De-
fender

Deﬁne A = (N , (Si)iǫR, (Ui)iǫN ) as a game, in which the
defender and the attacker compete to increase and decrease
the change of the estimated transmitted power (∆ ˆPij ), respec-
tively. In this game, R is the set of players (the defender and
the attacker), and the game can be deﬁned as:

• Players set: R = {1, 2} (the defender and the attacker).

• Attacker’s strategy: to choose measurements to attack.

• Strategy set Si: The set of available strategies for player
i, S1 = {αCNa}, S2 = {αCNd }, where Na and Nd are
the maximum number of measurements that the attacker
can attack and the defender can defend and αCNa is the
combination of Na measurement out of α measurement.
• Utility: U1 = ∆ ˆPij and U2 = −∆ ˆPij for the attacker

and the defender, respectively.

2) Increasing the congestion: Increasing transmitted power
from bus i to bus j, can create congestion in line Lij. This
congestion increases/decreases the price of electricity in the
receiving/sending end of the transmission line. So the attacker
needs to buy a Financial Transmission Right (FTR) from
sending bus i to ending bus j. FTR is a ﬁnancial contract
to hedge congestion charges. The FTR holder has access to

10The attacker doesn’t have access to all data such as the submitted prices,
generation limits, etc. So with changing the estimated transmitted power
desired direction, the attacker increases the chance of creating or releasing
congestion in the attacked line.

B. Noncooperative Finite Games: Two–Person Zero–Sum

A strategic game is a model of interactive decision-making,
in which each decision-maker chooses its plan of action once
and for all, and these choices are made simultaneously. For a

11In the case that there are different non-cooperative attackers, they will
have the worst performance. But if the attackers are cooperative, it is the worst
case for the defender. In this paper, we consider the worst case by assuming
all attackers are together as one party. So we formulate the problem as the
two-user zero sum game. If the attackers are non-cooperative, some games
such as the Stackelberg game can be employed. These games are interesting
topics which needs future investigations.

given (m × n) matrix game A = {aij : i = 1, . . . , m; j =
1, . . . , n}, let {row i∗, column j∗} be a pair of strategies
adopted by the players. Then, if the pair of inequalities

ai∗j ≤ ai∗j∗ ≤ aij∗ ,

(24)

is satisﬁed ∀i, j. The two–person zero–sum game is said to
have a saddle point in pure strategies. The strategies {row i∗,
column j∗} are said to constitute a saddle–point equilibrium.
Or simply, they are said to be the saddle–point strategies. The
corresponding outcome ai∗j∗ of the game is called the saddle–
point value. If a two–person zero–sun game possesses a single
saddle point, the value of the game is uniquely given by the
value of saddle point. However, the mixed strategies are used
to obtain an equilibrium solution in the matrix games that do
not possess a saddle point in pure strategies. A mixed strategy
for a player is a probability distribution on the space of its
pure strategies. Given an (m×n) matrix game A = {aij : i =
1, . . . , m; j = 1, . . . , n}, the frequencies with which different
rows and columns of the matrix are chosen by the defender
and the attacker will converge to their respective probability
distributions that characterize the strategies. In this way, the
average value of the outcome of the game is equal to

However, it always holds true that V m(A) = V m(A) for a
two-person zero-sum game in the mixed strategies. In this way,
for an (m×n) matrix game A, A has a saddle point in the
mixed strategies, and Vm(A) is uniquely given by

Vm(A) = V m(A) = V m(A).

(33)

We can see that if the players are able to use mixed strategies,
the matrix games always have a saddle-point solution Vm(A)
as the only solution in the zero-sum two-person game.

C. Computation of A Two-Person Zero-Sum Game

One way to get the saddle point in the mixed strategies is
to convert the original matrix game into a linear programming
(LP) problem. Given A = {aij : i = 1, . . . , m; j = 1, . . . , n}
with all entries positive (i.e., aij > 0), the average value of
the game in mixed strategies is given by

Vm(A) = min

Y

max
W

y′Aw = max

W

y′Aw.

min
Y

(34)

Obviously, Vm(A) must be a positive quantity on A. Further-
more, the expression can also be written as

min
y∈Y

v1(y),

(35)

J(y, w) =

m

n

Xi=1

Xj=1

yiaijwj = y′Aw,

(25)

where v1(y) is deﬁned as

where y and w are the probability distribution vectors deﬁned
by

y = (y1, · · · , ym)′, w = (w1, · · · , wn)′.

(26)

The defender wants to minimize J(y, w) by an optimum
choice of a probability distribution vector y ∈ Y , while the
attacker wants to maximize the same quantity by choosing an
appropriate w ∈ W . The sets Y and W are

Y = {y ∈ Rm : y ≥ 0,

W = {w ∈ Rn : w ≥ 0,

m

Xi=1
n

Xj=1

yi = 1},

(27)

wj = 1}.

(28)

Given an (m×n) matrix game A, a vector y∗ is known as
a mixed security strategy for the defender if the following
inequality holds ∀y ∈ Y :
V m(A) , max
w∈W

y∗′Aw ≤ max
w∈W

y′Aw, y ∈ Y.

(29)

And the quantity V m(A) is known as the average security
level of the defender. We can also deﬁne the average security
level of the attacker as V m(A) if the following inequality
holds for all w ∈ W :
V m(A) , min
y∈Y

y′Aw∗ ≥ min
y∈Y

y′Aw, w ∈ W.

(30)

The two inequalities can also be given as:

v1(y) = max

W

y′Aw ≥ y′Aw,

∀w ∈ W.

(36)

In addition, it can also be written as

A′y ≤ 1nv1(y),

1n , (1, . . . , 1)′ ∈ Rn.

(37)

Now the mixed security strategy for the defender is to

min v1(y)

(38)

A′ ˜y ≤ 1n,
˜y′1m = [v1(y)]−1,
y = ˜yv1(y)
˜y ≥ 0,

s.t.






where ˜y is deﬁned as y/v1(y). This is further equivalent to
the maximization problem

max
˜y

˜y′1m,

s.t.

(cid:26)

A′ ˜y ≤ 1n,
˜y ≥ 0,

(39)

which is a standard LP problem.

Similarly, we can get the standard LP problem for the

attacker

min
˜w

˜w′1n,

s.t.

(cid:26)

A ˜w ≥ 1m,
˜w ≥ 0,

(40)

V m(A) = min

Y

y′Aw,

max
W

V m(A) = max
W

min
Y

y′Aw.

(31)

(32)

where ˜w is deﬁned as w/v2(w) and

v2 , min

Y

y′Aw ≤ y′Aw,

∀y ∈ Y.

(41)

TABLE I
LINE REACTANCE AND THERMAL LIMIT FOR 5–BUS TEST SYSTEM

Line
X (%)

F max
k

(M W )

L12
2.81
999

L14
3.04
999

L15
0.64
999

L23
1.08
999

L34
2.97
999

L45
2.97
240

VI. NUMERICAL RESULTS

i

In this section, we analyze the effect of attack on the
PJM 5-bus test system in [30] with a slightly modiﬁcations.
Transmission lines’ parameters are given in Table I and II.
Generators’ and loads’ parameters (including Gmax
, Ci, and
Di) together with the location of measurements are shown in
Figure 2. Solving (10) for the day–ahead market shows that
L54 (line from B5 to B4) is congested. Here attacker chooses
L54 to attack. Knowing H, from (17) the attacker obtains Q =
[0.2 0.05 0 0.19 0.25 0.04 − 0.04 − 0.08 − 0.13 0.18 0.05].
Positive and negative arrays of this vector correspond to z+
and z− vectors, respectively, i.e., zT
+ = [z1, z2, z4, z5, z6, z10]
and zT
− = [z7, z8, z9]. The greater values of Q(i) correspond
to measurements that have more effect on ˆPij . Suppose there
are 4 insecure measurements {z1, z4, z5, z10} and the attacker
can compromise 2 of them, also the defender can defend 2
measurements simultaneously. So the attacker should choose
2 measurements among these measurements that have more
effect on ˆPij and a sufﬁciently low probability of detection
by the defender. In this example, the attacker can choose
from strategy set S1 = {z1z4, z1z5, z1z3, z4z5, z4z3, z5z3},
and the defender can choose from strategy set S2 =
{z1z5, z1z3, z4z5, z4z3, z5z3}. It is assumed that if the attacker
for example chooses {zizj} (to attack measurement i and j,
i 6= j) and the defender chooses {zizk} (to defend measure-
ment i and k, i 6= k), compromising {zj} will be successful,
and the change in ˆPij is only because of compromising {zj}.
If ξ = [5MW , · · · , 5MW ]′
(12×1), solving (21) and (22) gives
∆ ˆP54 = U1 = −U2. As Figure 3 shows, these payoffs are the
results of different attack and defend strategies (which both
players take). The attacker and defender in this game are not
aware of the sequence of play. Also one player has no idea
about the other player’s action. These situations are described
by a normal form zero–sum game in Table III.

TABLE II
GENERATION SHIFT FACTORS OF LINES IN 5–BUS TEST SYSTEM

PPPPPP

Line

Bus

L1−2
L1−4
L1−5
L2−3
L3−4
L5−4

B1

B2

B3

B4

B5

0.1939
0.4376
0.3685
0.1939
0.1939
0.3685

-0.476
0.258
0.2176
0.5241
0.5241
0.2176

-0.349
0.1895
0.1595
-0.349
0.6510
0.1595

0
0
0
0
0
0

0.1595
0.36
-0.5195
0.1595
0.1595
0.4805

Fig. 2. Measurement conﬁguration in PJM 5-bus test system

Fig. 3. Extensive form of single–act game

attacker and the defender, play their own strategies. Solving
such a game (which does not have a single saddle point) is a
linear programming. From (39) defender deﬁnes ˜y, we have

max

˜y′1m,

(42)

1.17˜y2 + 1.17˜y3 + 1.28˜y4 + 1.28˜y5 + 3.2˜y6 ≤ 1,
3.14˜y1 + 3.14˜y3 + 1.28˜y4 + 5.35˜y5 + 1.28˜y6 ≤ 1,
2.81˜y1 + 2.81˜y2 + 4.43˜y4 + 1.28˜y5 + 1.28˜y6 ≤ 1,
3.14˜y1 + 1.17˜y2 + 5˜y3 + 3.14˜y5 + 1.17˜y6 ≤ 1,
2.81˜y1 + 5˜y2 + 1.17˜y3 + 2.81˜y4 + 1.17˜y6 ≤ 1,
4.84˜y1 + 2.81˜y2 + 3.14˜y3 + 2.81˜y4 + 3.14˜y5 ≤ 1,
˜y1, ˜y2, ˜y3, ˜y4, ˜y5, ˜y6 ≥ 0,

s.t.






=

˜yv1(y)

which gives ˜y = [0 0.049 0.134 0.136 0.018 0.183].
Therefore, y
=
[0 0.094 0.26 0.262 0.0347 0.35]. Similarly, solving (40)
for the attacker gives ˜w = [0.29 0 0.02 0.019 0.019 0.174],
and therefore, w = ˜wv1(w) = ˜w( ˜w′1m)−1 =
[0.556 0 0.038 0.036 0.037 0.333].

˜y(˜y′1m)−1

=

Table III shows that min(max
row

) = 3.21, which is not equal
) = 0. So there is no ai∗j∗ that satisﬁes (24).
to max( min
column
Therefore, the game doesn’t have a single saddle point and
the problem shifts to ﬁnding the proportion of times that the

Figure 4 shows the proportion of times that the defender and
the attacker should defend and attack different measurements,
respectively. As discussed in Section IV, changing the esti-
mated transmitted power in line L54 can change the prices
in either bus 5 or bus 4. In real–time market the control

TABLE III
ZERO–SUM GAME BETWEEN THE ATTACKER AND THE DEFENDER

PPPPPP

Def.

Att.

z1z4
z1z5
z1z10
z4z5
z4z10
z5z10

w1

w2

w3

w4

w5

w6

z1z4

z1z5

z1z10

z4z5

z4z10

z5z10

0
1.17
1.17
1.28
1.28
3.21

3.14
0
3.14
1.28
5.35
1.28

2.81
2.81
0
4.43
1.28
1.28

3.14
1.17
5
0
3.14
1.17

2.81
5
1.17
2.81
0
1.17

4.84
2.81
3.14
2.81
3.14
0

y1
y2
y3
y4
y5
y6

center estimates transmitted power and then knowing dispatch
schedule (which is deﬁned in day–ahead market) load level
in different buses is estimated. This estimated load together
with the current state of the network is applied to a DCOPF,
and this program deﬁnes the real–time prices. If the operating
condition (such as the load level) has not changed and there
is no error in the measurements, the real–time prices should
be the same as the day–ahead prices. Here without loss of
generality, we assume that the actual load level doesn’t change
and any change in the estimated load level is because of bad
data injection to the state estimator.

The following example shows how attacker is able to change
the prices in real–time market. Suppose attacker compro-
mise z1z4 and the defender defends z5z10 so, attack against
z1z4 is successful. In this case solving (21) gives za =
[8.21 0 0 8.09 0 0 0 0 0 0 0 0](MW ). So from (5), estimated
states for all buses will be ˆθ = [50 56 65 01 71.6] × 10−3
(rad).
Using (17), estimated transmitted power can be obtained12
ˆP54 = 236.59(MW ). This power is less than thermal limit of
transmission line that shows, congestion in this line is released.
In this case solving (15) and (16) gives the real time prices
(here it is assumed that ∆Gmax
= 0.1MW and
∆Dmax
i = 0MW ).
i

= −∆Dmin

= −∆Gmin

i

i

Figure 6 shows the prices for attacked and without–attack
cases. Change of estimated transmitted power in transmission
line is shown in Figure 5. Now, assume that in day–ahead
market, the attacker buys 100MW power in bus 5 and sells it
in bus 4. From (23), the proﬁt of this contract will be:

P rof it = [(35 − 20) − (30 − 30)] × 100 = 1500($/h). (43)

VII. CONCLUSION

In this paper, ﬁrst we analyzed the effect of compromising
each measurement on the state estimator results. Compro-
mising these measurements can change the congestion and
consequently the price of electricity, and thus, the attacker
has an intensive to change the congestion in the desired
direction. Since a typical power system has a huge number
of measurements, attacking or defending all of those becomes
impossible for attacker and defender, respectively. To this end,
this behavior is modeled and analyzed in the framework of
game theory. The simulation results on PJM 5–Bus test system

12This value is considered as the real–time transmitted power in L54.

This change, will release
the congestion of Line L54

3.5

3

2.5

2

1.5

1

0.5

0

)

W
M

(
e
n

i
l

P
d
e
i
t
a
m

i
t
s
E
e
h
t

n

i

e
g
n
a
h
C

−0.5

L12

L14

L15

L23

L34

L54

Lij (Line From bus i to bus j)

Fig. 5. Change in the estimated transmitted power of lines because of attack
to Z1 and Z4

indicate that, in the speciﬁed load level, how attacker can
change the prices in the desired direction (decreasing in this
example).

ACKNOWLEDGEMENT

This work is partially supported by US NSF CNS-
0953377, ECCS-1028782, CNS-1117560, Qatar National Re-
search Fund, National Nature Science Foundation of China
under grant number 60972009 and 61061130561, as well as
the National Science and Technology Major Project of China
under grant number 2011ZX03005-002.

)
h
W
M
/
$
(

e
c
i
r

P

l

i

a
n
g
r
a
M

l

a
n
o
i
t

a
c
o
L

36

34

32

30

28

26

24

22

20

18

1

LMP Ex−Ante (No Attack)
LMP Ex−Post (Attacked)

2

3
Bus Number

4

5

Fig. 6. Locational Marginal Prices for PJM 5-Bus test system for both with
attack and without attack

REFERENCES

[1] T. F. Garrity, “Getting Smart,” IEEE Power and Energy Magazine, vol.

6, no. 2, pp. 38–45, March–April 2008.

[2] A. Monticelli, “Electric Power System State Estimation,” Proceedings

of IEEE, vol. 88, no. 2, pp. 262–282, Feb. 2000.

[3] Y. Yuan, Z. Li, and K. Ren, “Modeling Load Redistribution Attacks in
Power System,” IEEE Transactions on Smart Grid,, vol. 2, no. 2, pp.
382–390, June 2011.

 
 
 
 
 
 
 
 
 
 
(a) Probability of attack

(b) Probability of defend

Fig. 4. Proportion of times that attacker and defender, attack and defend to measurements respectively.

[4] Y. Yuan, Z. Li, and K. Ren, “Quantitative Analysis of Load Redis-
tribution Attack in Electric Grid,” IEEE Transactions on Parallel and
Distributed Systems, vol. 23, no. 9, pp. 1731–1738, Sept. 2012.

[5] J. Meserve, “Staged cyber attack reveals vulnerability in power grid”,
Available: http://www.cnn.com/2007/US/09/26/power.at.risk/index.html,
CNN, Sep. 2007.

[6] M. Esmalifalak, Z. Han, and L. Song “Effect Of Stealthy Bad Data
Injection On Network Congestion In Market Based Power System”,
IEEE Wireless Communications and Networking Conference (WCNC
2012), Paris, France, Apr. 2012.

[7] L. Xie, Y. Mo, and B. Sinopoli, “Integrity Data Attacks in Power Market
Operations,” IEEE Transactions on Smart Grid, vol. 2, no. 99, pp. 659–
666, Dec. 2011.

[8] G. Chen, Z. Y. Dong, D. J. Hill, and Y. S. Xue, “A Zonal Congestion
Management Approach Using Real and Reactive Power Rescheduling,”
IEEE Transactions on Power Systems, vol. 19, no. 1, pp. 554–562, Feb.
2004.

[9] M.E Falak, M.O Buygi, and A. Karimpour, “Market oriented reactive
power expansion planning using locational marginal price”, IEEE 2nd
International Power and Energy Conference (PECon 2008), Johor
Baharu, Malaysia, Dec. 2008.

[10] X. Fang. S. Misra, G. Xue, and D. Yang, “Smart Grid – The New and
Improved Power Grid: A Survey,” IEEE Communications Surveys &
Tutorials, no. 99, pp. 1–37.

[11] H. E. Brown and S. Suryanarayanan, “A Survey Seeking a Defenition of
a Smart Distribution System,” North American Power Symposium 2009,
pp. 1–7, 2009.

[12] S. Rohjansand, M. Uslar, R. Bleiker, J. Gonz´alez, M. Specht, T. Suding,
and T. Weidelt., “Survey of Smart Grid Standardization Studies and
Recommendations,” Smart Grid Communications (SmartGridComm),
2010 First IEEE International Conference on, Oldenburg, Germany, Oct.
2010.
[13] Ofﬁce

the National Coordinator

Smart Grid

of

[14] A. Teixeira, S. Amin, H. Sandberg, K.H. Johansson and S.S. Sastry,
“Cyber security analysis of state estimators in electric power systems,”
2010 49th IEEE Conference on Decision and Control (CDC), Dec. 2010.
[15] Y. Liu, M. K. Reiter, and P. Ning, “False Data Injection Attacks Against
State Estimation in Electric Power Grids,” the 16th ACM conference on
Computer and communications security., Nov. 2009.

[16] M. Esmalifalak, H. Nguyen, R. Zheng, and Z. Han, “Stealth False Data
Injection using Independent Component Analysis in Smart Grid”, IEEE
Second Conference on Smart Grid Communications, Brussels, Belgium,
Oct. 2011.

[17] A. R. Metke and R. L. Ekl, “Smart Grid Security Technology,” Innova-
tive Smart Grid Technologies (ISGT), 2010, Schaumburg, IL, USA, Jan.
2010.

[18] H. Li, L. Lai, and R.C. Qiu, “Communication Capacity Requirement
for Reliable and Secure State Estimation in Smart Grid”, The ﬁrst IEEE
Conference on Smart Grid Communications, Maryland, USA, Oct. 2010.
[19] G. Chen, Z. Y. Dong, D. J. Hill, and Y. S. Xue, “Exploring Reliable
Strategies for Defending Power Systems Against Targeted Attacks,”
IEEE Transactions on Power Systems, vol. 26, no. 3, pp. 1000–1009,
Aug. 2011.

[20] The

Smart

Grid

Interoperability

rity Working

Group,

“Introduction

Panel
to

Cyber
NISTIR

Secu-
7628

“NIST
Interoperability

teroperability,
Grid
http://www.nist.gov/public affairs/releases/upload/smartgrid-interoperability ﬁnal.pdf,
Jan. 2010.

Framework
Standards,

for

for
and Roadmap
1.0,”
Release

In-
Smart
Available:

Guidelines
http://www.nist.gov/smartgrid/upload/nistir-7628 total.pdf, Sep. 2010.

Security,”

Available:

Cyber

Smart

Grid

for

[21] M. Swearingen, “Real Time Evaluation and Operation of the Smart
Grid Using Game Theory,” 2011 IEEE Rural Electric Power Conference
(REPC), Hooker, OK, USA, April 2011.

[22] Z. Zhu, J. Tang, S. Lambotharan, W.H. Chin, and Z. Fan, “An Integer
Linear Programming and Game Theory based Optimization for Demand-
side Management in Smart Grid,” 2011 IEEE GLOBECOM Workshops
(GC Wkshps), Loughborough, UK, Dec. 2011.

[23] Z.M. Fadlullah, Y. Nozaki, A. Takeuchi, and N. Kato, “A survey of
game theoretic approaches in smart grid,” 2011 International Conference
on Wireless Communications and Signal Processing (WCSP), Sendai,
Japan, Nov. 2011.

[24] X. Zhang, J. Lu, H. Sun, and X. Ma, “Orderly Consumption and
Intelligent Demand-side Response Management System under Smart
Grid,” 2010 Asia-Paciﬁc Power and Energy Engineering Conference
(APPEEC), Beijing, China, March2010.

[25] P. Wang, J. Y.Huang, Y. Ding, P. Loh, and L. Goel, “Demand Side
Load Management of Smart Grids using intelligent trading/Metering/
Billing System,” 2010 IEEE Power and Energy Society General Meeting,
Singapore, Singapore, July 2010.

[26] S. Bu, F. R.Yu, and P. X.Liu, “A Game-Theoretical Decision-Making
Scheme for Electricity Retailers in the Smart Grid with Demand-Side
Management,” 2011 IEEE International Conference on Smart Grid
Communications (SmartGridComm), Ottawa, ON, Canada, Oct. 2011.

[27] A. Mohsenian-Rad, V.W.S. Wong, J. Jatskevich, R. Schober, and
A. Leon-Garcia, “Autonomous Demand–Side Management Based on
Game-Theoretic Energy Consumption Scheduling for the Future Smart
Grid,” IEEE Transactions on Smart Grid, vol.1, no.3, pp.320-331, Dec.
2010.

[28] A. J. Wood and B. F. Wollenberg, Power Generation, Operation, and

Control, Wiley New York et al., 1996.

[29] A. Abur and A. G. Exposito, Power System State Estimation: Theory

and Implementation, Marcel Dekker, Inc., 2004.

[30] F. Li, and R. Bo “Small Test Systems for Power System Economic
Studies,” Power and Energy Society General Meeting, Minneapolis,
Minnesota USA, Jul. 2010.

[31] F. Li and R. Bo, “DCOPF-Based LMP Simulation: Algorithm, Compar-
ison with ACOPF, and Sensitivity,” IEEE Trans. Power Syst., vol. 22,
no. 4, pp. 1475–1485, Nov. 2007.

[32] F. Li, J. Pan, and H. Chao, “Marginal Loss Calculation in Competitive
Electrical Energy Markets,” in Proc. 2004 IEEE Int. Conf. Electric Util-
ity Deregulation, Restructuring and Power Technologies 2004 (DRPT
2004), Apr. 2004, vol. 1, pp. 205–209.

[33] E. Litvinov, T. Zheng, G. Rosenwald, and P. Shamsollahi, “Marginal
Loss Modeling in LMP Calculation,” IEEE Trans. Power Syst., vol. 19,
no. 2, pp. 880–888, May 2004.

[34] A. L. Ott, “Experience with PJM Market Operation, System Design, and
Implementation, IEEE Trans. Power Syst., vol. 18, no. 2, pp. 528534,
May 2003.

[35] T. Zheng and E. Litvinov, “Ex post Pricing in the Co-Optimized Energy
and Reserve Market, IEEE Trans. Power Syst., vol. 21, no. 4, pp.
15281538, Nov. 2006.

Mohammad Esmalifalak (S’12) received his M.S.
degree in power system engineering from Shahrood
University of Technology, Shahrood, Iran in 2007.
He joined Ph.D. program in the University of Hous-
ton (UH) in 2010. From 2010 to 2012 he was re-
search assistant in the ECE department of UH. He is
the author of the paper that won the best paper award
in IEEE Wireless Communications and Networking
Conference (WCNC 2012), Paris, France. His main
research interests include the application of data
mining, machine learning and signal processing in

the operation and expansion of the smart grids.

Ge Shi is a candidate for bachelors degree of Elec-
tronics Engineering from Peking University, Beijing,
China. He is now working on a research about intel-
ligent information processing in machine to machine
communications (M2M) based on ZigBee protocol
under the direction of Prof. Lingyang Song in State
Key Laboratory of Advanced Optical Communica-
tion Systems & Networks, Peking University. His
research interests mainly include smart grids, game
theory, and internet of things.

Zhu Han (S’01-M’04-SM’09) received the B.S.
degree in electronic engineering from Tsinghua Uni-
versity, in 1997, and the M.S. and Ph.D. degrees in
electrical engineering from the University of Mary-
land, College Park, in 1999 and 2003, respectively.
92077918

From 2000 to 2002, he was an R&D Engineer of
JDSU, Germantown, Maryland. From 2003 to 2006,
he was a Research Associate at the University of
Maryland. From 2006 to 2008, he was an assistant
professor in Boise State University, Idaho. Currently,
he is an Assistant Professor in Electrical and Computer Engineering De-
partment at the University of Houston, Texas. His research interests include
wireless resource allocation and management, wireless communications and
networking, game theory, wireless multimedia, security, and smart grid
communication.

Dr. Han is an Associate Editor of IEEE Transactions on Wireless Com-
munications since 2010. Dr. Han is the winner of IEEE Fred W. Ellersick
Prize 2011. Dr. Han is an NSF CAREER award recipient 2010. Dr. Han is
the coauthor for the papers that won the best paper awards in IEEE Inter-
national Conference on Communications 2009, 7th International Symposium
on Modeling and Optimization in Mobile, Ad Hoc, and Wireless Networks
(WiOpt09), and IEEE Wireless Communication and Networking Conference,
2012.

Lingyang Song (S03-M06-SM12) received his PhD
from the University of York, UK, in 2007, where he
received the K. M. Stott Prize for excellent research.
He worked as a postdoctoral research fellow at the
University of Oslo, Norway, and Harvard University,
until rejoining Philips Research UK in March 2008.
In May 2009, he joined the School of Electronics
Engineering and Computer Science, Peking Univer-
sity, China, as a full professor. His main research
interests include MIMO, OFDM, cooperative com-
munications, cognitive radio, physical layer security,

game theory, and wireless ad hoc/sensor networks.

He is co-inventor of a number of patents (standard contributions), and author
or co-author of over 100 journal and conference papers. He received the best
paper award in IEEE International Conference on Wireless Communications,
Networking and Mobile Computing (WiCOM 2007), the best paper award in
the First IEEE International Conference on Communications in China (ICCC
2012), the best student paper award in the7th International Conference on
Communications and Networking in China (ChinaCom2012), and the best
paper award in IEEE Wireless Communication and Networking Conference
(WCNC2012).

He is currently on the Editorial Board of IET Communications, Journal
of Network and Computer Applications, and International Journal of Smart
Homes, and a guest editor of Elsevier Computer Communications and
EURASIP Journal on Wireless Communications and Networking. He serves
as a member of Technical Program Committee and Co-chair for several
international conferences and workshops.

