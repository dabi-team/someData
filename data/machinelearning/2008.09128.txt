Protocol Discovery for the Quantum Control of Majoranas by Diﬀerentiable
Programming and Natural Evolution Strategies

Luuk Coopmans,1, 2, ∗ Di Luo,3, ∗ Graham Kells,1 Bryan K. Clark,3 and Juan Carrasquilla4, 5
1Dublin Institute for Advanced Studies, School of Theoretical Physics, 10 Burlington Rd, Dublin, Ireland.
2School of Physics, Trinity College Dublin, College Green, Dublin 2, Ireland
3Department of Physics and IQUIST and Institute for Condensed Matter Theory,
University of Illinois at Urbana-Champaign, IL 61801, USA
4Vector Institute for Artiﬁcial Intelligence, MaRS Centre, Toronto, Ontario, Canada
5Department of Physics and Astronomy, University of Waterloo, Ontario, N2L 3G1, Canada
(Dated: April 12, 2021)

Quantum control, which refers to the active manipulation of physical systems described by the
laws of quantum mechanics, constitutes an essential ingredient for the development of quantum tech-
nology. Here we apply Diﬀerentiable Programming (DP) and Natural Evolution Strategies (NES)
to the optimal transport of Majorana zero modes in superconducting nanowires, a key element to
the success of Majorana-based topological quantum computation. We formulate the motion control
of Majorana zero modes as an optimization problem for which we propose a new categorization of
four diﬀerent regimes with respect to the critical velocity of the system and the total transport time.
In addition to correctly recovering the anticipated smooth protocols in the adiabatic regime, our
algorithms uncover eﬃcient but strikingly counter-intuitive motion strategies in the non-adiabatic
regime. The emergent picture reveals a simple but high ﬁdelity strategy that makes use of pulse-like
jumps at the beginning and the end of the protocol with a period of constant velocity in between
the jumps, which we dub the jump-move-jump protocol. We provide a transparent semi-analytical
picture, which uses the sudden approximation and a reformulation of the Majorana motion in a
moving frame, to illuminate the key characteristics of the jump-move-jump control strategy. We
verify that the jump-move-jump protocol remains robust against the presence of interactions or
disorder, and corroborate its high eﬃcacy on a realistic proximity coupled nanowire model. Our
results demonstrate that machine learning for quantum control can be applied eﬃciently to quantum
many-body dynamical systems with performance levels that make it relevant to the realization of
large-scale quantum technology.

I.

INTRODUCTION

Through the use of a wide array of promising exper-
imental platforms ranging from superconducting qubits
[1] to trapped ions [2–4], optical lattices [5] and nitrogen-
vacancy centers [6, 7], scientists are exploring ground-
breaking ways to build quantum technology with an eye
on deepening our understanding of complex natural sys-
tems, improving artiﬁcial intelligence, and impacting in-
dustry more broadly. While promising, several funda-
mental and practical diﬃculties must be overcome for
quantum machines to become practical [8]. Quantum
control, which studies the manipulation of physical sys-
tems whose behaviour is dominated by the laws of quan-
tum mechanics, remains a fundamental ingredient in the
quest for practical quantum technology. Thus, the devel-
opment of principles and strategies for quantum control
[9–13] remains an essential task for future quantum tech-
nologies [14], e.g., in the preparation of complex quantum
states in quantum computing and quantum simulators.
The practical encoding and manipulation of quantum
information has however been hampered by the presence
of noise and decoherence inherent to brittle quantum
devices. Majorana zero modes, which are special zero-

∗ Co-ﬁrst authors.

energy quasi-particles with non-abelian braiding statis-
tics that can potentially be realized in proximity-coupled
superconductors [15–24], represent a promising alterna-
tive approach due to their non-local nature and antici-
pated topological protection against local errors [25–30].
The key to manipulating this topologically encoded quan-
tum information is the development of protocols to trans-
port the Majoranas, as will be necessary for their braid-
ing and measurement. While the simplest approaches
proposed to move the Majoranas adiabatically, decoher-
ence processes such as quasiparticle poisoning [31], mo-
tivate the need for faster and more eﬃcient control pro-
tocols.

In this context, machine learning (ML) oﬀers a power-
ful and unifying approach to the study, design, bench-
marking, and control of quantum systems and de-
vices. Motivated by a series of remarkable technologi-
cal breakthroughs in research areas as diverse as com-
puter vision [32], natural language processing [33] and
genomics [34], physicists have started to explore the po-
tential of ML for fundamental research [35]. In particu-
lar, researchers interested in quantum many-body physics
have initiated the development of a machine learning per-
spective on the many-body problem [36] with recent ad-
vances such as neural network representation of quantum
states [37–48], neural network tomography [49–51], ma-
chine learning classiﬁcation of phases [38], as well as ad-
vances in quantum chemistry [52–54], density functional

1
2
0
2

r
p
A
9

]
l
e
-
r
t
s
.
t
a
m
-
d
n
o
c
[

2
v
8
2
1
9
0
.
8
0
0
2
:
v
i
X
r
a

 
 
 
 
 
 
2

FIG. 1. a) In the Majorana Game the agent moves the left Majorana γL from a position xA to a position xB by tuning
the external potential proﬁle V (x, t). b) The agent attempts diﬀerent movement paths and tries to ﬁnd the optimal one
that minimizes the inﬁdelity I(T ). c) Diﬀerent Majorana control regimes and their corresponding strategies (boxes in d)):
I) Critical regime (vavg > vcrit), II) sub-critical regime ( vcrit/2 < vavg < vcrit), III) short time T , low velocity regime and
IV) (super)-adiabatic regime (long time T and low velocity vavg). d) In regimes I-II-III we ﬁnd the jump-move-jump (JMJ)
strategy whereas in regime IV we recover a smooth super-adiabatic protocol. The inﬁdelities are I(T ) = 0.3575 in regime I,
I(T ) = 0.1589 in II, I(T ) = 0.0057 in III and I(T ) = 0.0005 in regime IV; the parameters for the JMJ strategies displayed in
regimes I, II, III can be found in App. G and we have set xL(0) = xA = 5.0 to ensure a smooth potential proﬁle V (x, t).

theory [55, 56] and the acceleration of Monte Carlo sim-
ulations [57–59], preparation of quantum states [60, 61],
quantum feedback [62], among many others [36, 63]. ML
applications in the context of quantum control [64–67]
are largely based on reinforcement learning (RL) tech-
niques, which are the key ingredient behind major artiﬁ-
cial intelligence breakthroughs in game play [68, 69]. A
RL perspective on quantum control has been developed
in the context of quantum state preparation [64], where
the authors reexamine the quantum state preparation in
terms of a modiﬁed version of the Watkins Q-learning
algorithm [70]. Likewise, Ref. [65] considers the problem
of gate synthesis from a RL viewpoint.

In this work we exploit Diﬀerentiable Programming
(DP) [71] and Natural Evolutionary Strategies (NES) [72]
to ﬁnd optimal strategies to transport Majorana zero
modes. We reformulate the complex task of transporting
a Majorana zero mode as a quantum control optimization
problem amenable to advanced ML techniques. This can
be most easily understood from a reinforcement learning
perspective where the movement of the Majoranas can be
recast as a “game”, see Fig. 1. In this game the player
(agent) has to move a Majorana from a position xA to
a position xB in a ﬁxed amount of time T . At the end
of the game the agent gets rewarded depending on how

well the Majorana reached its target state at position xB.
The objective of the agent is to learn the best strategy
(path of the Majorana) that maximizes the reward.

Our machine learning techniques discover a novel
and counter-intuitive approach to transporting Majorana
zero modes, here dubbed the jump-move-jump approach
and exempliﬁed in Fig. 1, which yields a high ﬁdelity con-
trol signiﬁcantly superior in terms of speed and quality to
previous strategies applied to this problem [73–75]. The
jump-move-jump protocol, which is relevant for trans-
porting Majoranas over a large distance l in a short time
T , makes use of pulse-like jumps at the beginning and
end of the protocol (see regions I-III of Fig. 1), with a
period of nearly constant velocity between the jumps.
This is particularly interesting given the previous results
for other models showed that bang-bang protocols [74]
were the most eﬃcient approach to this form of quantum
control.

Using the insight gleaned from our ML-inspired con-
trol protocols, we construct the core strategy for these
paths and provide a theoretical understanding for the
protocol by analyzing the motion of the Majoranas in a
moving frame. We ﬁnd that these protocols simultane-
ously use the stability of the system at ﬁnite velocities
together with the fact that small sudden jumps in wall

a)b)c)IIIIIIIVd)IIIIIIIVposition do not signiﬁcantly reduce the ground-state ﬁ-
delity. In contrast, in the limit where there is a signiﬁ-
cant total time T to move a relatively small distance l,
the best approach is to follow smooth protocols that fol-
low an adiabatic path. Our ML technology recovers these
protocols without any prior knowledge (see region IV of
Fig. 1). In addition, we verify that the jump-move-jump
protocol retains its usefulness in the presence of interac-
tions or disorder, and also corroborate its high eﬃcacy us-
ing the more experimentally relevant proximity-coupled
semiconductor nanowire model.

We have structured this paper as follows: in section II
we introduce the setup of the Majorana control problem.
In section III we introduce the optimization methods DP
and NES for which we provide the optimization results
in section IV which we benchmark against a standard
simulated annealing method. In section IV we also high-
light some of the advantages of the DP and NES methods
compared to others. We describe and analyse the physi-
cal mechanisms behind the jump-move-jump strategy in
section V. Then we provide some numerical results of the
robustness of the jump-move-jump strategy with respect
to interactions or disorder in section VI before concluding
our work.

We also include several appendices where we provide
extra details regarding the moving frame in App. A,
ML methods in App. B, C and E, extra results for
the proximity-coupled semiconductor nanowire in App. F
and the robustness of the JMJ strategy with respect to
interactions and disorder in App. H. Finally in App. G
and App. I we discuss extra details for the analysis of the
JMJ strategy.

II. SETUP OF THE MAJORANA CONTROL
PROBLEM

To model the movement of the Majorana zero modes
in superconducting nano-wires we use a one-dimensional
(1D) Kitaev Chain [25] described by the Hamiltonian

N
(cid:88)

H(t) = −

[µ(x) − V (x, t)](c†

xcx − 1/2)

x=1

N −1
(cid:88)

(c†

xcx+1 + h.c) + ∆

− w

x=1

N −1
(cid:88)

x=1

(c†

xc†

x+1 + h.c.),

(1)

where c(†)
are fermionic annihilation (creation) opera-
x
tors, µ(x) the onsite chemical potential, V (x, t) a time-
dependent external potential, w the hopping amplitude
and ∆ the p-wave superconducting gap. This model can
be realized eﬀectively in variety of setups by proximity
coupling to a conventional s-wave superconductor [15–
17, 19, 20, 76–78]. When |µ| ≥ |2w| the gap in the en-
ergy spectrum closes inducing a transition to a topolog-
ical trivial phase [25, 79]. For an open chain, a pair of
Majorana zero-modes are found to reside on the edges

3

of the wire if the bulk is topologically non-trivial. The
existence of such Majorana modes implies the existence
of a degenerate space of ground states. The ground state
of the system is protected by a robust topological en-
ergy gap, which in the continuum limit of the model is
given by min[µc, ∆ckF ]. As a consequence of this protec-
tion, two pairs of Majorana zero-modes can be used to
produce a qubit whose information content is protected
non-locally [27].

Manipulation of the information encoded in the ground
state requires the braiding of the Majorana quasi-
particles [18, 26, 28, 29, 80–83], while staying as much
as possible within the degenerate ground-state space. To
achieve this, a generic strategy is to try to perform the
braiding adiabatically. An adiabatic path generically
must have a total time T larger then the inverse gap;
in practice the size of the topological gap makes such a
strategy prohibitively slow in view of numerous sources
of decoherence in proximity coupled setups [31, 84–91].
In light of this, our strategy in what follows (see also
[73, 75, 92]), is to attempt to move Majoranas as quickly
and eﬃciently as possible. To this end, and to have
smooth control over the position of the Majorana bound
states on the lattice, we encode the external potential
proﬁle as

V (x, t) = Vheight[f (x − xL(t)) + f (xR − x)]

(2)

where Vheight is the maximum height of the outer poten-
tial walls and f (x) = 1/(1 + exp(x/σ)) is a sigmoid func-
tion shifted by the wall positions xL(R) (Fig. 1 a). The
Majoranas are localized at the outer edges of the poten-
tial proﬁle, which can be seen as domain walls between
topological and non-topological phases since Vheight (cid:29)
2w. The position of these domain walls can be be con-
trolled through xL(R); to move the left Majorana we give
the agent control over xL(t) as a function of time.

The motivation for this speciﬁc form of potential pro-
ﬁle comes from experimental proposals for moving the
Majorana by the so called piano-key potentials [18, 73,
93]. In this proposal the position of the domain wall in
the wire is controlled by applying gate electrodes. 1 At
variance with protocols found in [74], the presence of non-
linearities in the potential proﬁle implies that bang-bang
protocols, which are expected for linear control [96, 97],
may no longer be optimal. As a consequence of this, it
is conceivable that the space of possible solutions is ex-
panded in our setting.

The Majorana game starts at t = 0 with the system in
the groundstate of Eq. 1 with xL(0) = xA. The aim is
to reach the groundstate |ΨB(cid:105) with xL(T ) = xB located
at a distance xB − xA = l spending a total time T . A
natural choice to quantify the accuracy of the protocol is

1 For a more detailed discussion of these eﬀects in more compli-
cated geometries see Refs. [94, 95]. For a discussion on alterna-
tive braiding schemes see II A.

4

the inﬁdelity

A. Relevance to other braiding schemes

I(T ) = 1 − | (cid:104)ψB| T e−i (cid:82) T

0 H(t)dt |ψA(cid:105) |2 ≡ 1 − F(T ). (3)

Here, H(t) is the time-dependent Hamiltonian that de-
scribes the Majorana wire setup Eq. 1 during the pro-
tocol. Whereas I(T ) = 0 means that we have fully pre-
served the encoded quantum information, I(T ) = 1 im-
plies that information has been completely lost.

A key timescale related to the control problem is Tres =
2π
, which naturally arises from the response of the sys-
∆kF
tem to boundary wall oscillations (see [75] and App. A).
Tres corresponds to the time above which one can make
changes slowly enough for genuinely super-adiabatic mo-
tion [73, 98, 99]. Super-adiabaticity in this scenario al-
lows the static ground state to be accelerated into the
ground state of a moving frame, provided the transition
is done slowly enough, i.e., in times large compared to
Tres. Another important additional physical constraint is
the presence of a critical velocity vcrit = ∆ [73, 92] above
which the moving frame Hamiltonian becomes gapless
(App. A) and the ground states lose their topological
protection.

Based on this we divide up the Majorana control prob-

lem into four diﬀerent regimes (I-IV) (see Fig. 1 c).

• Regime I corresponds to the critical regime in which
the Majorana must move on average vavg = l/T
above the critical velocity.
In this regime the
ground state ﬁdelity is expected to rapidly decrease
to zero.

• Regime II is the sub-critical regime for which the
velocity is on average close to but nonetheless below
vcrit. This regime is open ended in both time T
and length l. The key feature distinguishing this
regime from regime IV below is character of the
found optimal protocols.

• Regime III is again a sub-critical regime, deﬁned
for the times that are short with respect to the res-
onance time Tres but also has low velocity. This
region cannot be used to eﬃciently move Majorana
states over long distances, but we expect it to be
relevant for braiding protocols based on small rela-
tive movements that change the eﬀective couplings
between Majoranas.

• Finally regime IV is the adiabatic regime in which
we are above Tres and we have suﬃcient time
to expect that slow ramp-up/ramp-down proto-
cols [73, 75] from earlier studies to be optimal.
Ideally one would always like to be in this regime,
however a gradual build up of noise and decoher-
ence may make it necessary to get things done more
quickly.

It is worth mentioning here that the aforementioned
trade-oﬀ between adiabaticity and the need to perform
operations quickly has led to the emergence of other ap-
proaches to braiding. These schemes seek to circumvent
the need to manipulate/shuttle Majorana’s over exces-
sively long distances. This includes local [18, 100, 101]
and non-local
[102, 103] Majorana coupling in wire-
networks, and the implementation of one-way computa-
tion schemes [104, 105] via projective charge measure-
ments [30, 106–110].

All of these methods still require some level of adi-
abatic control, or some eﬀective short-cutting thereof
(see e.g.
[111, 112]) and there can also be some ad-
ditional downsides. The interaction/coupling schemes
for example require precise control of the couplings be-
tween neighbouring Majoranas and the loss of some topo-
logical protection [87, 113]. In implementations of wire
measurement-only schemes one must also tune a coupling
between wire and a quantum dot [30, 108] and accept
state manipulation that is inherently probabilistic [110].
The phase diagram that we have outlined above is di-
rectly applicable to the local coupling schemes, where
the relative Majorana position can be seen as a proxy
for the coupling strength. A similar proxy may also
hold for measurement-only schemes via the distance be-
tween topological boundary and quantum dot, although
the connection here is harder to make directly because
one should also account for fermion number conservation
[30, 106–109]. That said, the DP and NES methods we
apply below do have direct relevance for even more so-
phisticated numerical treatments of this problem. We
refer to our concluding remarks for further discussion of
this point.

III. MACHINE LEARNING METHODS

In our study we apply two machine learning strategies,
namely Diﬀerentiable Programming (DP) and Natural
Evolution Strategies (NES), to minimize the inﬁdelity
Eq. 3 with respect to the position of the domain wall
xL(t). 2 In this section we introduce these methods in a
way that directly applies to our Majorana control setup.
For the interested reader we provide the corresponding
programming codes in [114].

A. Diﬀerentiable Programming

DP is a programming paradigm to evaluate gradients
of computer programs [115] that has been recently intro-

2 We note that the control can also be represented by the velocity
or a neural network parameterization of the domain wall from
which the position xL(t) can be extracted.

duced as an optimization method in physics applications
like Tensor Networks [116, 117], Monte Carlo [40, 118,
119], and optimal control [67, 120]. DP obtains numer-
ically exact gradients with similar computational time
complexity as the forward evaluation of the computer
program due to the use of backward propagation [121–
123].

In our Majorana control optimization problem we are
interested in the total derivative of the inﬁdelity with re-
spect to the control dI(T )
dxL(t) . As shown in App. B, the
algorithm to compute I(T ) consists of a sequence of ele-
mentary operations fi, in DP language known as primi-
tives, which maps the input control xL(t) to the value of
the inﬁdelity by I(T ) = fn ◦ fn−1 ◦ · · · ◦ f1(xL(t)). More-
over, the derivatives of each individual operation fi are
known and the total derivative dI(T )
dxL(t) can be assembled
by recursively applying the chain rule with automatic
diﬀerentiation (see App. B).

In practice, we write a code to evaluate the real-
time dynamics of the Majorana induced by the time-
dependent proﬁle V (x, t) such that all the individual
operations are diﬀerentiable. To obtain the necessary
gradients we use a language that supports automatic
diﬀerentiation, which in our case is the JAX library
[124]. The gradients are used to minimize the inﬁ-
delity of the ﬁnal state using Gradient Descent (GD) and
ADAM [125]. For GD this is done iteratively, where at
each iteration of the algorithm the protocol is updated as
xL(t) → xL(t) − ∇xL(t)I(T ). Moreover since neural net-
works consist of diﬀerentiable elementary operations, we
also explore representing and training the control xL(t)
as the output of a neural network for which the weights
are updated with the standard update scheme ADAM.

B. Natural Evolution Strategies

Evolution Strategies is a family of black-box optimiza-
tion algorithms inspired by natural evolution [72, 126].
These methodologies have been recently revisited in the
context of machine learning [127], in particular in rein-
forcement learning [128], where OpenAI demonstrated
that a particular incarnation of the algorithm called nat-
ural evolution strategies (NES) oﬀers a powerful alterna-
tive to popular Markov-decision process-based reinforce-
ment learning methods [129].

NES starts with an objective function F (φ) that acts
on parameters φ from a population described by a dis-
tribution pθ, where θ parameterizes the population dis-
tribution. In our work, we choose the objective function
F (φ) to be the inﬁdelity I(T, φ) in Eq. 3. Depending
on the setting, the parameter φ corresponds to either
the position proﬁle xL(t), the velocity vL(t) = ˙xL(t)
or the parameters of a neural network whose output is
xL(t) = NNφ(t).

The NES algorithm proceeds to optimize the expecta-
tion value of the objective function Eφ∼pθ [I(T, φ)] over

5

the population. We choose pθ to be a Gaussian dis-
tribution with mean θ and diagonal covariance matrix
Σ = σ2I with σ = 0.1, i.e., N (θ, σ2I). It follows that the
gradient of the cost function is (see App. C)

∇θEφ∼N (θ,σ2I) [I(T, φ)] = ∇θE(cid:15)∼N (0,I) [I(T, θ + σ(cid:15))]

= E(cid:15)∼N (0,I) [I(T, θ + σ(cid:15))(cid:15)/σ] .
(4)

This equation provides an eﬃcient way for comput-
ing gradients without diﬀerentiation, but instead through
the expectation of the objective function. Notice that
E(cid:15)∼N (0,I)[I(T, θ)(cid:15)/σ] = 0, which implies the above equa-
tion is equivalent to E(cid:15)∼N (0,I)[(I(T, θ +σ(cid:15))−I(T, θ))(cid:15)/σ].
This means that the estimation of the gradient can be
seen as the ﬁnite diﬀerence of the objective function with
random search [128]. To update the parameters θ, we ap-
ply gradient descent to θ with Eq. 4.

IV. MACHINE LEARNED STRATEGIES FOR
MAJORANA CONTROL

Our main objective is to investigate the use of DP and
NES for the motion of the Majorana modes in the four
diﬀerent movement regimes I-IV. We choose four diﬀer-
ent points (l, T ) (which ﬁxes vavg = l/T ) each of which
belongs to a diﬀerent regime. For each of these points
we apply the optimization algorithms to minimize the
inﬁdelity I(T ) in Eq. 3 with respect to the control of the
domain wall. The control can be parameterized by either
the wall position xL(t), the wall velocity vL(t) or a neural
network xL(t) = NNθ(t), where θ represent the parame-
ters in the neural network. We tested all these diﬀerent
parameterizations (see App. D) and in the following we
focus on the parameterization choices that give the best
performance (the lowest inﬁdelity values).

For the DP optimization, we ﬁrst parameterize the
wall position by a neural network xL(t) = NNθ(t) and
use ADAM [125] to optimize the parameters. We then
take the resulting real-space proﬁle xL(t) and directly re-
optimize it in the position representation with GD. We
ﬁnd that this two-step process is beneﬁcial; while the
initial NN stage allows a quick convergence to a smooth
nearly-optimal control proﬁle, the second step allows for
additional ﬁne-tuning and more abrupt changes in the
protocol. The neural network NNθ(t) used for these
simulations consists of three layers of 100 neurons with
Rectiﬁed Linear (ReLU) activation functions followed by
one output neuron with a sigmoid activation function.
The learning rate for the ADAM optimization algorithm
is determined empirically by running a range of values
and picking the one that showed the best convergence, a
method which is similar to the one used in [125]. The
NES optimization in regimes I/II operates directly on the
wall position xL(t) and in regimes III/IV it operates on
the wall velocity vL(t) from which the wall position can
be extracted via integration xL(t) = xA + (cid:82) t
0 vL(t(cid:48))dt(cid:48).

6

FIG. 2. Overview of the optimal controls in the four diﬀerent Majorana motion regimes (I-IV) obtained after optimization with
Diﬀerentiable Programming (DP), Natural Evolutionary Strategies (NES) and Simulated Annealing (SA). In all panels we plot
the domain wall position xL(t) as a function of time starting from xL(0) = xA = 5.0. The red dotted line in regime I has a
slope equal to the critical velocity. Regimes I-III show a pulse like motion at the edges and an on average constant velocity in
the bulk of the protocol. In regime IV the strategy is to slowly build up to constant speed and then slow down again. In these
simulations we set N = 110, µ = 1, w = 1, ∆ = 0.3, Vheight = 30.1, and σ = 1. The constraint parameters (l, T ) are given by
{(4.32, 12), (4.95, 22), (0.48, 8), (2.4, 40)} for regimes I, II, III, and IV, respectively.

The uncertainty parameter for NES can be viewed as a
trade-oﬀ of exploration and exploitation [70] and was de-
termined empirically by testing a range of values. We
note that in [128] it was shown that NES is a robust
method with respect to diﬀerent hyper-parameters in dif-
ferent learning settings.

The time-dependent simulations of the fermionic sys-
tem are discretized over time with a small time resolu-
tion dt = 0.01. We allow the ML algorithms control over
only a coarse grained time scale ∆t ≥ 10dt such that
in the continuous time limit dt (cid:55)→ 0 we get a continu-
ous protocol xL(t) and the domain wall position is not
discontinuously changing every single discrete time step
dt. Moreover to probe the susceptibility of the optimized
protocols to initial conditions, we repeat the optimiza-
tions a few times for several diﬀerent starting conﬁgura-
tions to ensure that the results are independent of the
initialization.

The results for these optimizations 3 in the four diﬀer-
ent regimes are shown in Fig. 2(a-h) and can be summa-

3 Here we discuss the results obtained in the Kitaev chain while
in App. F we show the results obtained for the more general
proximity coupled semiconducting nanowire.

rized as follows. In the regimes I-II-III we can identify
clear similarities between all of the optimised strategies
which display sudden movements (jumps) at the begin-
ning and end, and more gradual rates of changes in the
middle of the protocol. The initial sudden movements
can be roughly characterised by a rapid jump forward,
followed by a less abrupt backward motion. The jumps
near the end of the protocol display an analogous move-
ments in the reverse order, although these are generally
less pronounced. The middle of the protocols consists of
an approximately constant-velocity forward-motion that
is dressed to various degrees with high frequency oscilla-
tions. We observe that the velocity in the middle part of
the protocols is typically lower than vcrit even for regime
I, where the the total average velocity vavg (including the
sudden movements) is above vcrit. The size and charac-
ter of the additional oscillations largely depends on the
optimization strategy being used.

The inﬁdelity values we ﬁnd in regimes I-II-III are sig-
niﬁcantly better compared to strategies like linear motion
xL(t) = vavgt or bang-bang as shown in App. D. In the
critical regime I we get an inﬁdelity of about I(T ) ≈ 0.35
compared to I(T ) = 0.47 for a linear protocol whereas
in regime II we get I(T ) ≈ 0.15 versus I(T ) = 0.22

DPRegime IIIRegime IIRegime IVRegime INESSAa)b)c)d)e)f)g)h)i)j)k)l)for linear. In the low average velocity regime III we get
inﬁdelities as low as I(T ) ≈ 0.006 while linear motion
gives I(T ) = 0.012. The inﬁdelity value improvement
in regime I is rather surprising given that the Majorana
moves on average above the critical velocity. Below, we
explain why the jumps in this scenario are particularly
beneﬁcial.

In regime IV the results show a globally diﬀerent strat-
egy: in this regime the optimal protocol is to slowly ac-
celerate the Majorana up to some ﬁnite velocity and then
slowly decelerate back down to the target position. This
type of protocol was discussed in earlier work [73, 75]
in regimes where there is enough time to accelerate to a
moving frame, i.e. regime IV. We note that due to the
nearly adiabatic motion in regime IV, the values of inﬁ-
delity are the lowest I(T ) ≈ O(10−4). These inﬁdelity
values make regime IV optimal for braiding of Majoranas
in an ideal experimental setup. However, due to imper-
fection in the devices and their coupling to a noisy envi-
ronment, balancing the inﬁdelity associated with shorter
protocols with respect to the inﬁdelity induced by de-
phasing in a longer time protocol makes controlling Ma-
jorana movement in faster regimes relevant for near term
experiments.

Compared to previous studies however [73, 75, 89] we
ﬁnd that the starting velocity vL(t = 0) of the protocols
in regime IV can be ﬁnite if one allows for small but ﬁ-
nite inﬁdelity values I(T ) ≈ O(10−4). In the obtained
protocols for example we have vL(t = 0) (cid:54)= 0 followed by
an approximately smooth gradual build up and down of
the velocity. Moreover, the optimization techniques with
which these protocols were obtained have as additional
advantage that they can ﬁne tune the protocols up to a
ﬁner level (bigger search space) than the previously stud-
ied parameterized adiabatic protocols [75], as we show in
App. D). This advantage of our methods might be par-
ticularly beneﬁcial for ﬁnding optimal protocols in the
presence of disorder in the wires as discussed brieﬂy in
section VI B and App. H.

Note that although we have focused on the Kitaev
chain model in Eq.1 the results and conclusions discussed
here remain true on the more realistic proximity coupled
nanowire models, where the JMJ protocol is optimal in
the non-adiabatic regime (see details of the proximity
couple nanowire simulations in App. F). Additionally,
the results on the proximity couple nanowire in App. F
are compatible with a smooth protocol in the adiabatic
regime, as well as consistent with the results on the Ki-
taev chain in the large Zeeman ﬁeld and large strong
spin-orbit coupling limits.

Comparison between simulated annealing and DP
and NES optimization

7

the wall velocity vL(t) of the domain wall is iteratively
updated by choosing two random intervals of length ∆t
of which one interval is increased by ∆v and the other
is decreased by ∆v. The new inﬁdelity Ii is calculated
for the updated velocity proﬁle and the move is accepted
with a probability e−δI/TSA where δI = Ii − Ii−1 is the
diﬀerence in the inﬁdelity with respect to previous iter-
ation. The annealing temperature TSA is slowly cooled
down to zero. The results of this benchmark in each of
the four regimes are shown in Fig. 2(i-l) and are qualita-
tively similar to the results obtained with NES and DP
(Fig. 2(a-h)).

In practice, we ﬁnd that SA is signiﬁcantly more com-
putationally demanding than NES or DP since a typical
SA simulation entails the evaluation of the many-body
inﬁdelity for each SA update step. To obtain results with
comparable inﬁdelities, the SA simulation requires a total
of 105 evaluations of the inﬁdelity while for DP we only
need 440 update steps each involving a single inﬁdelity
and gradient evaluation (the latter requiring similar com-
putational complexity as the inﬁdelity calculation); the
NES algorithm requires 50 update steps each with 100
parallel evaluations to reach convergence.

This diﬀerences may be partially attributed to the fact
that SA does not take advantage of any gradient sig-
nal. Beyond these practical observations, a careful scal-
ing analysis of the convergence of these methods requires
an analysis of the convexity properties of the inﬁdelity
landscape as a function of the control parameters. This
can be either done analytically for simple inﬁdelity land-
scapes [130], but may require a numerical investigation
for control problems exhibiting a glassy landscape [131].

Overall, we highlight that DP oﬀers a powerful tool
for quantum control as long as an accurate and diﬀeren-
tiable physical model is available. It is found that direct
gradient based gradient methods are usually more stable
In contrast, NES can op-
and eﬃcient than RL [132].
timize non-diﬀerentiable and discrete control protocols,
both of which remain challenging for DP. NES can be also
directly applied to experimental settings as long as a suit-
able objective function, such as the expectation value of a
Hermitian observable or the ﬁdelity, is available. For in-
stance, recent experiments demonstrate the teleportation
of Majorana modes in a quantum simulation of a small
Majorana chain [133] including access to the ﬁdelity of
the protocol. This possibility makes NES a viable tool
for controlling and designing quantum simulations of Ma-
jorana modes.

We now benchmark the results of the DP and NES al-
gorithms against the standard simulated annealing (SA)
In the SA method
method following Ref. [74] closely.

Additional discussions detailing connections, compar-
isons, advantages, and disadvantages of the machine
learning approaches in relation to other advanced meth-
ods used in quantum control are presented in App E.

8

FIG. 4. The jump-move-jump protocol maximizes the prod-
uct of the two functions Oδ (Eq. 8) and Ov (Eq. 9). Here
l = 4.32 and T = 12 (regime I) and we have used s = 2.45
and β = 0.065. The ground state projection analysis (solid
blue) captures the key features of the ML-inspired (one-wall)
JMJ strategy (blue stars) for low velocities v but tends to
overestimate the penalty for moving at velocities near vcrit.

forward jump over a distance ∆xforward followed by a
rapid backward movement over a distance ∆xback in a
time ∆tback. Similarly, the last pulse starts with a rapid
backward movement ∆xback followed by a forward jump
over a distance ∆xforward.
In what follows, we assume
that jumps at the beginning and end of the protocol are
symmetric and are described by the same parameters.

The simplicity of this model allows us to develop an
understanding for the key mechanisms behind the ML
strategies and estimate the value of the inﬁdelity of the
JMJ strategy for a wide range of parameters l, T in
regimes I-III (see Fig. 5 and Fig. 3 (b)).
In section
V A below we will ﬁrst argue that when we disregard the
backward movements, i.e. ∆xback = 0, the overall strat-
egy can be explained via a trade-oﬀ (Fig. 4) between the
amount of ﬁdelity loss due to the boundary jumps and
the loss due to sudden changes in velocity.

In section V B we also explore how this mechanism
can be better controlled with the backward movements
∆xback (cid:54)= 0 which, for a certain subset of parameters
(∆xforward, ∆xback), leads to a model strategy with in-
ﬁdelities that compare competitively with the best ML
learned protocols (see the discussion in App. G and Figs.
1 (d) and 2). Our analysis shows that this dressed pro-
tocol allows one to better target the ground-state of the
system in a moving (constant velocity) frame.

A. Bare Jump-Move-Jump (∆xback = 0)

For the case ∆xback = 0 we minimize the inﬁdelity
Eq. 3 with respect to the velocity v of the bulk of the

FIG. 3. a) Setup of the ML-inspired simple control strategy
consisting of two edge pulses with a forward jump ∆xforward
and backward jump ∆xback together with a constant linear
motion in between the dressed jumps. b) Inﬁdelity I(T ) sur-
face plot for the scans over the free parameters ∆xforward and
∆xback of the model strategy with ∆tback = 0.07w−1 and
∆tforward = 0.01w−1 in regime I (l = 4.32, T = 12). The
red line indicates the line where the size of the forward jump
∆xforward is equal to the total movement length l. The pa-
rameters of the Majorana control setup are the same as in
Fig. 2. The optimal dressed jumps appear at a diagonal set
of parameters ∆xforward − ∆xback ∼ C where C ≈ 0.96. We
note that the best protocol has a jump size bigger than the
movement length ∆xforward > l which means that it jumps
over the target position xL(T ) = xB and then jumps back
within the range xA < xL < xB as can be seen in Fig. 1 d)
(for regimes I and III).

V. JUMP-MOVE-JUMP [JMJ] MAJORANA
CONTROL STRATEGY

The main features of the ML strategies in regimes I, II
and III can be encapsulated in a simple model strategy,
the jump-move-jump strategy as shown in Fig. 3 a),
amenable to semi-analytical and numerical analysis. This
strategy consists of two dressed jumps in the position of
the domain wall at the beginning and end of the protocol
interluded by a period of motion at a constant velocity
v. The initial dressed jump comprises an instantaneous

50a)b)2468101268795432210013450.90.80.70.60.50.4protocol which ﬁxes the instantaneous forward jump to
∆xforward = (l − vT )/2 ≡ δ. To make analytic analysis
simpler we focus on the case that both the left and the
right domain wall positions are being evolved simultane-
ously with the JMJ strategy. This means that the right
wall position xR in Eq. 2 becomes time-dependent via
xR(t) = xL(t) + Cx with Cx a ﬁxed constant. This two
wall scenario makes it possible to evaluate the strategy
in the moving frame basis (App. A), which allows the
key rationale behind the JMJ strategy to be revealed.

To evaluate this strategy we expand the inﬁdelity after
the ﬁrst jump xL = xA (cid:55)→ xL = xA + δ in terms of the
eigenbasis (cid:12)
(cid:11) of the Hamiltonian Eq. 1 with the wall
A+δ
at position xL = xA + δ giving

(cid:12)ψi

9

with γ = 1/(cid:112)1 − v2/∆2. One way to argue for this form
is to use the results of [75] that showed that the energy of
the moving frame ground state w.r.t. to the static frame
goes as E ∼ γM v2 where M ∝ kF /∆. The overlap can
be related to this energy via Ov ∼ 1 − E/kF ∆. We arrive
at a value of β ∼ 0.13 by ﬁtting Eq. 9 to moving frame
(two-wall) numerical simulations for v (cid:28) vcrit. For single
wall motion we can calculate value of β ∼ 0.065 by slowly
accelerating the wall up to v (cid:28) vcrit and comparing the
evolved state with the instantaneous ground-state. Note
that this analysis also holds for the more general proxim-
ity coupled semiconducting nanowire with diﬀerent val-
ues for ﬁtting parameters α and β.

I(T ) = 1 −

(cid:12)
(cid:12)
(cid:88)
(cid:12)
(cid:12)
(cid:12)

i

(cid:104)ψB| U (T ) (cid:12)

(cid:12)ψi

A+δ

(cid:11) (cid:10)ψi

A+δ

(cid:12)
(cid:12)ψA

(cid:11)

2

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

(5)

in which U (T ) = T e−i (cid:82) T
0 H(t)dt is the time-ordered evo-
lution operator with H(t) following the time-dependence
of the strategy. We break this equation up into two sep-
arate terms

I(T ) = 1 − | (cid:104)ψB| U (T ) (cid:12)
(cid:88)
+

(cid:12)ψ0
(cid:104)ψB| U (T ) (cid:12)

A+δ
(cid:12)ψi

(cid:11) (cid:10)ψ0

A+δ

(cid:11) (cid:10)ψi

A+δ

(cid:11)

(cid:12)
(cid:12)ψA
(cid:12)
(cid:12)ψA

A+δ

(cid:11) |2

(6)

i>0

which allows for an approximate analysis of the sepa-
rate contributions. Here we focus on the groundstate
contribution (ﬁrst line), making the assumption that the
second line is small in comparison.

To approximate the groundstate contribution we insert
projections onto the groundstate (cid:12)
(cid:11) of a moving frame
Hamiltonian H(v) with a velocity v equal to the bulk
velocity of the strategy and ﬁnally a projection onto the
groundstate (cid:12)
(cid:11) of the Hamiltonian Eq. 1 with the
wall at position xL = xB − δ (just before the ﬁnal jump)
resulting in

(cid:12)ψ0
v

(cid:12)ψ0

B−δ

(cid:12)
(cid:12)ψ0
v

(cid:11) (cid:10)ψ0
B−δ
(cid:12)
(cid:11) (cid:10)ψ0
(cid:12)ψ0

(cid:12)
I(T ) ≈ 1 − | (cid:10)ψB
(cid:11) ×
(cid:12)ψ0
B−δ
(cid:12) U (T ) (cid:12)
(cid:12)
(cid:11) (cid:10)ψ0
(cid:10)ψ0
(cid:12)ψ0
v
v
(cid:12)
The (cid:10)ψA(B)±δ
(cid:11) represent the initial and ﬁnal
(cid:12)ψA(B)
jumps in position space of size δ which by ﬁtting to our
numerical model can be characterized as

(cid:12)
(cid:12)ψA

(cid:11) |2.

(7)

A+δ

A+δ

v

FIG. 5. Contours showing the inﬁdelity I for the bare (one-
wall) jump-move-jump strategy (Eq. 10) as a function of dis-
tance l and time T using the same ﬁtted parameters as Fig. 4.
The red dashed line indicates when vavg = l/T = vcrit which
can be used to distinguish the diﬀerent Majorana motion
regimes as deﬁned in Fig. 1 (c). The jump-move-jump proto-
col allows for low inﬁdelities even in cases where the average
velocity exceeds vcrit (regime I).

If we assume a symmetric strategy (e.g. jumps of the
same size at the beginning and end) then the ﬁdelity
function F(T ) ≈ |OδOν|2 (where I(T ) = 1 − F(T )) to
be maximized is approximated as

Oδ = | (cid:104)ψxL|ψxL+δ(cid:105) |2 ∼ exp(cid:0)−δ2/s2(cid:1)

(8)

F(T ) ≈ exp

−

(cid:18)

(l − vT )2
2s2

(cid:19)

(cid:20)

×

1 − βγ

(cid:17)2(cid:21)2

(cid:16) v
∆

(10)

where s ∼ (cid:15)+αλF with λF the Fermi wavelength and the
ﬁtting parameters ((cid:15), α) = (−0.33, 0.44) for one-wall and
(−0.12, 0.3) for two-walls when ∆ = 0.3. In the appendix
I we discuss this in more details, showing also how the
ﬁt s scales with the coherence length ξ of the Majorana
mode.

The amplitude (cid:10)ψ0

(cid:11) represents the overlap be-
tween the static ground state and that of a moving frame
with a constant velocity v. We estimate this as follows:

(cid:12)
(cid:12)ψ0

A+δ

v

Ov = | (cid:10)ψ0
xL

(cid:12)
(cid:12)ψ0
v

(cid:11) |2 ∼ 1 − β

(cid:17)2

γ

(cid:16) ν
∆

(9)

where we have substituted δ = (l − vT )/2. The ﬁrst
function is maximized by making v as large as possible
while the second prefers to have small v, with a very
severe penalty kicking in as v approaches the critical ve-
locity ∼ ∆. In Figure 4 we show how this function be-
haves for the protocol in regime I, which indicates that
the analysis accurately captures the behaviour of the ﬁ-
delity at small v/∆ but also displays overall qualitative
agreement with the numerical results for a wide range of
values of v/∆ including the presence of a maximum in
the ﬁdelity.

An important part of the strategy are the jumps at
the beginning and end of the protocol that allow for a
constant middle motion at lower velocities. In Fig. 5 we
show how the inﬁdelity behaves for a range of movement
lengths l and times T obtained from maximizing Eq. 10
with respect to v. By comparing with Fig. 1 (c) we see
that in regime I the bare JMJ strategy gives inﬁdelities
of I(T ) > 0.25, in regime II (between the dashed lines)
about 0.04 < I(T ) < 0.25 and in the short l- short T
regime III (below the blue dashed line) performs partic-
ularly well with inﬁdelities I(T ) ∼ O(10−2).

This method is only eﬀective however if the jumps
needed are not too large (δ ∼ O(λF )).
Interestingly,
as the overlap behaviour of Ov is relatively unaﬀected
by changes to the chemical potential, this suggests that
a chemical potential nearer to the bottom of the band,
µ → −2w can help to extend the range of the protocol.

B. Dressed Jump-Move-Jump (∆xback (cid:54)= 0)

On top of the bare jump-move-jump structure, the ML
algorithms dress the protocols with additional forward
and backward movements. In this section we will show
that the primary purpose behind these additional mo-
tions is to better target the moving frame ground state
in the move part of the jump-move-jump protocol.

To proceed we focus on the simple upgraded JMJ pro-
tocol that also allows backward motions over distances
∆xback (cid:54)= 0, see Fig. 3 (a). Our ﬁrst key observation is
that the optimal protocols here tend to choose a com-
bined jump size ∆xforward − ∆xback ∼ C, see Fig. 3 (b),
where C is a ﬁxed constant. This indicates the same
primary goal as the JMJ strategy: to allow a period of
optimal and roughly constant sub-critical motion.

(cid:12)ψ0

To understand why the backward motion is a further
beneﬁt we examine the instantaneous inﬁdelity in both
the static and moving frames for a series of protocols with
the ﬁxed bulk velocity v, see Fig. 6 (a). The instanta-
neous inﬁdelity is deﬁned as I(t) = 1 − | (cid:10)ψ(t)(cid:12)
ins(t)(cid:11) |2
with |ψ(t)(cid:105) = T e−i (cid:82) t
0 H(t(cid:48))dt(cid:48)
|ψA(cid:105) in which H(t) follows
the time-dependence of the dressed JMJ strategy and
(cid:12)
ins(t)(cid:11) corresponds to the instantaneous groundstate
(cid:12)ψ0
(at the ﬁxed time t) of the static frame Hamiltonian H(t)
(Eq. 1) or the moving frame Hamiltonian Hv(t) (Eq.
A2). The static frame perspective shows that the opti-
mal jump ﬁnds a state that slowly becomes the lowest in-
ﬁdelity state after some time. However a more revealing
picture emerges if we examine the same set of protocols
in a moving frame (inset). Here we see that the objective
of the initial jumps is to maximize the overlap with the
ground state of the moving frame.

Using the same methodology we can also reveal what
moving frame bulk excitations (cid:12)
(cid:11) with many-body en-
(cid:12)ψi
v
ergy Ei
v (restricting here to single- and two particle ex-
citations only) the dressed protocol occupies during the
evolution, see Fig. 6 (b). For protocols close to the bare
JMJ strategy (shown in red) one ﬁnds that the domi-

10

FIG. 6. a) Instantaneous Inﬁdelity I(t) with respect to the
static (lab) frame groundstate (main panel) and moving frame
groundstate (inset) as a function of the protocol time t for
various dressed jumps in regime I which are depicted by the
diﬀerent colours (red,blue,green,grey) and shown in the inset
of b). The optimal dressed jump (blue) has the minimum in-
ﬁdelity with the moving frame groundstate and becomes the
strategy with the minimum static frame inﬁdelity after about
t ≈ 4. b) The time-evolved state |ψ(t)(cid:105) expanded in the single
and two particle excitations (cid:12)
(cid:11) of the moving frame basis
(cid:12)ψi
v
with energies Ei
v at t = T /2 for a forward jump (red), an
optimal dressed jump (blue) and non-optimal dressed jump
(green) for regime I as given in the inset. The occupation
probabilities (delta functions) are convoluted for visualisation
purposes. The forward jump strategy (red) occupies the exci-
tations close to the bottom of the band in the moving frame
(Ei
v ≈ 0.08) more compared to the dressed jumps (blue and
green). In this ﬁgure all times are in units of 1/ω.

nant excitations have energies close to the moving frame
bulk gap (Ei
v ≈ 0.08). The dressed jumps (in blue and
green) however are able to lower the amplitudes of these

a)b)excitations, but at the cost of also exciting some higher
energy quasi-particles. For dressed jumps that are too
large (in green) these higher energy excitations eventu-
ally dominate and one gets an increase in the ground
state inﬁdelity.

Before ending this section, we now brieﬂy summarize
why similar JMJ strategies work in the regimes I-III. The
ﬁrst advantage of the JMJ strategy is that, with abrupt
initial and ﬁnal costs, it allows for an eﬀective reduction
in the distance l. This is especially obvious in the case
of regime I where, by deﬁnition, simple linear motion
implies a need to move above the critical velocity.

The other crucial aspect of the dressed protocols is that
they can better target the ground state of the moving
system through the combination of jumping and moving.
This allows the system to be rapidly accelerated to a
near constant velocity frame where there is no additional
inﬁdelity cost. For a ﬁxed distance l, the JMJ strategy
therefore generally allows for a reduced time by cutting
out the slow acceleration parts of regime IV, allowing
regime III, regime II and, to a lesser extent, regime I
exploit the property of super-adiabaticity.

Of course it is always possible to deﬁne scenarios deep
in regime I where the distance and time constraints would
lead to large inﬁdelity even for the dressed JMJ proto-
cols. However they do allow, under the same spatial and
temporal constraints, for Majoranas to be moved more
eﬃciently than that of linear motion or slow ramp-up
ramp-down protocols.

VI. ROBUSTNESS OF THE JMJ PROTOCOL
WITH RESPECT TO INTERACTIONS AND
DISORDER

In the space between our simpliﬁed theoretical setups
(the Kitaev chain in Eq. 1 and Proximity Coupled Semi-
conductor in App. F) and actual topological quantum
devices there are many additional layers of complexity,
and one might wonder which aspects of the JMJ proto-
col remain robust. In this section we assess the robust-
ness of our optimal JMJ protocols obtained in the clean
non-interacting system when applied in a system with in-
teractions (see e.g [134–140]), and separately applied in
a system with disorder, see [76, 141, 142]. We ﬁnd that
the ﬁdelity loss due to the jumps of the JMJ protocol
remains robust and that the overall protocol still outper-
forms the naive linear benchmark protocol signiﬁcantly.
Finally we comment on the extension of our ML methods
to include these more complex scenarios.

A. The eﬀect of interactions

Interactions are modeled by adding the nearest
neighbour density-density interaction term Hint =
(cid:80)N −1
x+1cx+1 with interaction strength ux to
the Kitaev chain Hamiltonian in Eq. 1, H(t) = H(t) +

x=1 uxc†

xcxc†

11

FIG. 7. Main panel:
instantaneous inﬁdelity I(t) of the
optimal JMJ protocol from the non-interacting system in
regime I run in a system with several diﬀerent ﬁnite interac-
tion strengths u. The jumps are robust against interactions
whereas inﬁdelity increases during the move part of the pro-
tocol. Inset: the ﬁnal inﬁdelity values I(T ) increase approxi-
mately linearly with interaction strength for both a linear as
well as the best JMJ protocol. For all interaction strengths
the JMJ protocol outperforms the linear protocol. The other
parameters for these simulations are the same as in Fig. 2 and
the parameters of the JMJ protocol can be found in App. G.

Hint. Since Hint is quartic in the creation and annihila-
tion operators, the BdG time evolution algorithm used
before (see App. B) cannot be applied directly and we
consider a time-dependent variational principle with ma-
trix product states (MPS-TDVP) [143, 144] approach to
simulate the dynamics.

In Fig. 7 we show how the optimal protocol obtained
in the non-interacting system in regime I performs for
various ﬁnite interaction strengths (see App. H for the
other regimes). From the instantaneous inﬁdelity plot
in the main panel we can see that the ﬁdelity loss due
to the jumps remains robust with increasing interaction
strength whereas in the bulk (move part) the loss in-
creases. As a consequence the ﬁnal inﬁdelity I(T ) in-
creases with interaction strength (See inset Fig. 7), but
the performance remains superior to a naive linear proto-
col at all interaction strengths. The increase of inﬁdelity
with interaction can be argued for on the basis of mean-
ﬁeld theory, where one expects repulsive interactions to
lower the eﬀective gap (leading to a lower critical veloc-
ity) and the appearance of non-uniformity in the eﬀective
coupling parameters near the system boundary.

Since we did not perform the optimization directly in
the presence of interactions, we cannot argue that the
optimal JMJ protocol from the non-interacting system
is also the optimal protocol in the interacting system.
We note however that our ML optimization methods can
be directly extended for this task. Firstly, the NES al-
gorithm is a black-box optimization method and can be

combined with any method that generates the dynamics
such as the MPS-TDVP algorithm. Secondly, to apply
DP one needs to make the code for the MPS-TDVP al-
gorithm diﬀerentiable. In this regard we note that the
DMRG algorithm to ﬁnd ground states in interacting sys-
tems has been recently made diﬀerentiable [116].

FIG. 8. Main panel: disorder averaged instantaneous inﬁ-
delity (cid:104)I(t)(cid:105) of the optimal JMJ protocol from the clean wire
in regime I for diﬀerent disorder strengths λ. The jumps are
robust against weak disorder whereas the inﬁdelity increases
during the move part of the protocol. The disorder averaging
was done over 500 realizations. Inset: the ﬁnal inﬁdelity val-
ues (cid:104)I(T )(cid:105) increase approximately quadratically with disorder
strength for both a linear as well as the best JMJ protocol.
For all disorder strengths the JMJ protocol outperforms the
linear protocol. The other parameters for these simulations
are the same as in Fig. 2 and the parameters of the JMJ
protocol can be found in App. G.

B. The eﬀect of disorder

Disorder in the wires can be modeled by adding a ran-
dom Gaussian noise term ˜µ(x) with mean 0 and stan-
dard deviation λ to the chemical potential µdis(x) =
µ(x) + ˜µ(x) [76, 141, 142]. It has been shown that this
form of disorder leads to an increase in the eﬀective co-
herence length ξeﬀ of the Majorana, which in the contin-
uum limit leads to 1
F/λ2
ξeff
is the characteristic disorder length scale. When the dis-
order strength is such that 2ldis = ξ, the eﬀective Ma-
jorana coherence length ξeﬀ diverges and the topological
phase is destroyed. Another consequence of disorder is
that the critical velocity is signiﬁcantly reduced [92] and
the ground state ﬁdelity is expected to rapidly decrease
upon smoothly moving the Majoranas over a disordered
medium.

. Here ldis = v2

ξ − 1
2ldis

= 1

In Fig. 8 we show the performance of the JMJ pro-
tocol in regime I for various diﬀerent disorder strengths
compared to a linear benchmark protocol. Regimes II,

12

III and IV are detailed in App. H. From the averaged
instantaneous inﬁdelity (cid:104)I(t)(cid:105) in Fig. 8 it can be seen
that the inﬁdelity associated with the jumps is robust to
the presence of disorder but there is a relatively strong
ﬁdelity loss associated with the linear motion of the move
part. This is in line with the expectations given the lower
critical velocity and longer coherence length induced by
disorder. While the ﬁnal inﬁdelity value I(T ) of the JMJ
protocol remains reasonably high in regime I, for longer
time/distance regimes (e.g. deep in regimes II/IV) I(T )
worsens signiﬁcantly, which suggests that additional pro-
tocol optimization in the presence of disorder may be
required to achieve comparable inﬁdelities.

The protocol optimization in the presence of disorder
can be achieved through the NES method since the com-
putational complexity grows linearly with the number of
disorder realizations, all of which can be simulated in par-
allel. The DP method can also be applied because the
disorder averaging is a diﬀerentiable operation, i.e., DP
can access the disorder averaged inﬁdelity ∇θ(cid:104)I(T )(cid:105) with
respect to the control parameters. For example [145] and
[146] consider DP for stochastic optimization tasks.

VII. CONCLUSION AND FURTHER WORK

We have applied two state-of-the-art machine learn-
ing techniques, namely diﬀerentiable programming (DP)
and natural evolution strategies (NES), to the problem of
manipulating Majorana bound-states in a topological su-
perconductor. For DP we have shown that the entire dy-
namical evolution of any free-fermion system can be func-
tionally diﬀerentiated, allowing for eﬃcient optimization
protocols. This in turn provides an ability to tackle com-
putationally harder problems and allows the dynamical
optimization to be integrated seamlessly with both di-
rect and neural-network parameterizations of quantum
control protocols.

In addition to this we have shown how the Majorana
control problem itself can be naturally formulated as
a game. This allows the application of reinforcement
learning approaches and NES to zero-mode manipula-
tion. The key advantage here is both speed and ﬂexibility
compared to, e.g., the standard MC methods such as sim-
ulated annealing. Beyond the advantages observed in our
numerical experiments there are a number of additional
conceptual and practical ingredients which can be taken
advantage of in the reinforcement learning setup includ-
ing a ﬂexible exploration step, delayed rewards, partial
observations, and the ease of accounting for the stochas-
tic nature of the reward function, all of which may be
particularly relevant to experimental setups.

Note that these machine learning approaches are not
speciﬁc to Majorana bound state control, and could also
be applied to diﬀerent dynamical many-body problems
with radically diﬀerent motivations and cost functions
(e.g. log-likelihood [147], Fisher information [148] or the
trace distance [149]).

On the theoretical level we have introduced a frame-
work for dividing up the Majorana control problem into
four distinct transport regimes. This has deepened the
understanding of the problem and help to establish a con-
nection with optimal control theory more broadly. Re-
markably our numerical simulations displayed an innate
awareness of this rich landscape and uncovered impor-
tant hidden aspects of the underlying physics.
In par-
ticular they have identiﬁed a new class of protocol that
radically outperforms other known strategies (adiabatic
and bang-bang) when there are both spatial and tem-
poral constraints. We have shown that this family of
protocols, and the associated classiﬁcation of Majorana
motion, also holds for the richer proximity-coupled semi-
conductor nanowire model, which is directly relevant for
experiments. In principle, since the deﬁning criteria are
related to topological gap, similar protocols should also
apply to related models such as the SSH chain [150] or
multi-channel topological wires variants [151].

The core of this alternative strategy is a sudden jump
followed by a period of constant velocity motion and then
another jump. A theoretical analysis of this dynamics
shows that the strategy simultaneously exploits the mod-
els stability at constant velocities below a certain thresh-
old, and the property that small instantaneous changes
in the domain wall position do not dramatically reduce
the ground state ﬁdelity. Further analysis of dressed
JMJ protocols reveals that more complex initial jump
sequences can, in addition to allowing a sub-critical ve-
locity, better target the ground state of the moving frame.
The protocol resembles the parallel recent development
of the Bang-Anneal-Bang protocols [97] for ground state
preparation in Noisy Intermediate Scale Quantum de-
vices. Our theoretical analysis illuminates why this type
of strategy works so successfully and we are hopeful that
this approach will motivate more general theoretical anal-
ysis of related protocols. In this context it would also be
interesting to see the same types of protocols also emerge
in more realistic materials. Our results for the semicon-
ductor model suggest that similar protocols are indeed
relevant. However, in that example, it is important to
note that boundary motion does not strongly couple be-
tween bands with diﬀerent spin orientations. In real ma-
terials one might expect that sudden boundary change
would couple the ground state to bands at larger ener-
gies and this may restrict the range of motions that one

13

can achieve.

Another natural direction to explore is the application
of our methods to the problem of Majorana braiding,
which is the ultimate goal behind the study and control
of zero-modes in the context of topological quantum com-
puting. It remains an interesting open question whether
aspects of our protocols remain robust if one models spe-
ciﬁc devices more closely. We emphasize however that
the strength of the RL setup is that one can easily encode
other experimental restrictions on the control by includ-
ing them in the reward or action spaces [152]. As such the
application of these methods can be readily extended to
other more complicated models, such as models including
the eﬀect of interactions [153], diﬀerent simulation tech-
niques such as the time-dependent density-matrix renor-
malization group [154], and to measurement-based Ma-
jorana devices [107].

In a broader sense we believe our work shows that ma-
chine learning for quantum control can be done at a scale,
speed, and precision that is relevant to modern experi-
mental devices. As such we believe that it will be used
to overcome obstacles to realizing large-scale quantum
computation, quantum communication networks, quan-
tum thermal machines, analogue quantum simulations,
and control of other quantum many-body dynamical sys-
tems more broadly.

ACKNOWLEDGMENTS

We would like to thank Andreas Buchleitner, Steve
Campbell, Aaron Conlon, Shane Dooley, Ian Jubb, Kevin
Kavanagh, Jinguo Liu, Xiuzhe Luo, Frank Sch¨afer, Ji-
ayu Shen and Lei Wang for helpful discussions regarding
this project. L.C and G.K. acknowledge Science Founda-
tion Ireland for ﬁnancial support through Career Devel-
opment Award 15/CDA/3240. G. K. was also supported
by a Schr¨odinger Fellowship. J.C. acknowledges support
from Natural Sciences and Engineering Research Council
of Canada (NSERC), the Shared Hierarchical Academic
Research Computing Network (SHARCNET), Compute
Canada, Google Quantum Research Award, and the
Canadian Institute for Advanced Research (CIFAR) AI
chair program. D.L and BKC acknowledge support from
the Department of Energy grant DOE desc0020165.

[1] J. M. Gambetta, J. M. Chow, and M. Steﬀen, Building
logical qubits in a superconducting quantum computing
system, npj Quantum Information 3, 2 (2017).

[2] J. I. Cirac and P. Zoller, Quantum computations with
cold trapped ions, Phys. Rev. Lett. 74, 4091 (1995).
[3] J. G. Bohnet, B. C. Sawyer, J. W. Britton, M. L. Wall,
A. M. Rey, M. Foss-Feig, and J. J. Bollinger, Quantum
spin dynamics and entanglement generation with hun-
dreds of trapped ions, Science 352, 1297 (2016).

[4] C. D. Bruzewicz, J. Chiaverini, R. McConnell, and J. M.
Sage, Trapped-ion quantum computing: Progress and
challenges, Applied Physics Reviews 6, 021314 (2019),
https://doi.org/10.1063/1.5088164.

[5] C. Gross and I. Bloch, Quantum simulations with ultra-
cold atoms in optical lattices, Science 357, 995 (2017).
[6] B. B. Zhou, A. Baksic, H. Ribeiro, C. G. Yale, F. J.
Heremans, P. C. Jerger, A. Auer, G. Burkard, A. A.
Clerk, and D. D. Awschalom, Accelerated quantum

control using superadiabatic dynamics in a solid-state
lambda system, Nature Physics 13, 330 (2017).

[7] F. Casola, T. van der Sar, and A. Yacoby, Probing
condensed matter physics with magnetometry based on
nitrogen-vacancy centres in diamond, Nature Reviews
Materials 3, 17088 (2018).

[8] D. P. DiVincenzo, The physical

implementation of
quantum computation, Fortschritte der Physik 48, 771
(2000).

[9] A. Baksic, H. Ribeiro, and A. A. Clerk, Speeding up adi-
abatic quantum state transfer by using dressed states,
Phys. Rev. Lett. 116, 230503 (2016).

[10] H. Rabitz, R. de Vivie-Riedle, M. Motzkus, and
K. Kompa, Whither the future of controlling quantum
phenomena?, Science 288, 824 (2000).

[11] X. Wang, M. Allegra, K. Jacobs, S. Lloyd, C. Lupo,
and M. Mohseni, Quantum brachistochrone curves as
geodesics: Obtaining accurate minimum-time protocols
for the control of quantum systems, Phys. Rev. Lett.
114, 170501 (2015).

[12] D. Gu´ery-Odelin, A. Ruschhaupt, A. Kiely, E. Tor-
rontegui, S. Mart´ınez-Garaot, and J. G. Muga, Short-
cuts to adiabaticity: Concepts, methods, and applica-
tions, Rev. Mod. Phys. 91, 045001 (2019).

[13] A. del Campo and K. Sengupta, Controlling quantum
critical dynamics of isolated systems, The European
Physical Journal Special Topics 224, 189 (2015).
[14] A. G. J. MacFarlane, J. P. Dowling, and G. J. Milburn,
Quantum technology: The second quantum revolution,
Philosophical Transactions of the Royal Society of Lon-
don. Series A: Mathematical, Physical and Engineering
Sciences 361, 1655 (2003).

[15] L. Fu and C. L. Kane, Superconducting proximity eﬀect
and majorana fermions at the surface of a topological
insulator, Phys. Rev. Lett. 100, 096407 (2008).

[16] R. M. Lutchyn, J. D. Sau, and S. Das Sarma, Ma-
jorana fermions and a topological phase transition in
semiconductor-superconductor heterostructures, Phys.
Rev. Lett. 105, 077001 (2010).

[17] Y. Oreg, G. Refael, and F. von Oppen, Helical liquids
and majorana bound states in quantum wires, Phys.
Rev. Lett. 105, 177002 (2010).

[18] J. Alicea, Y. Oreg, G. Refael, F. von Oppen, and
M. P. A. Fisher, Non-abelian statistics and topological
quantum information processing in 1d wire networks,
Nature Physics 7, 412 (2011).

[19] M. Kjaergaard, K. W¨olms, and K. Flensberg, Majorana
fermions in superconducting nanowires without spin-
orbit coupling, Phys. Rev. B 85, 020503 (2012).

[20] M. Leijnse and K. Flensberg, Introduction to topological
superconductivity and majorana fermions, Semiconduc-
tor Science and Technology 27, 124003 (2012).

[21] V. Mourik, K. Zuo, S. M. Frolov, S. R. Plissard,
E. P. A. M. Bakkers, and L. P. Kouwenhoven, Signa-
tures of majorana fermions in hybrid superconductor-
semiconductor nanowire devices, Science 336, 1003
(2012).

[22] M. T. Deng, C. L. Yu, G. Y. Huang, M. Larsson,
P. Caroﬀ, and H. Q. Xu, Anomalous zero-bias conduc-
tance peak in a nb–insb nanowire–nb hybrid device,
Nano Letters 12, 6414 (2012).

[23] A. Das, Y. Ronen, Y. Most, Y. Oreg, M. Heiblum, and
H. Shtrikman, Zero-bias peaks and splitting in an al–
inas nanowire topological superconductor as a signature

14

of majorana fermions, Nature Physics 8, 887 (2012).
[24] R. M. Lutchyn, E. P. A. M. Bakkers, L. P. Kouwen-
hoven, P. Krogstrup, C. M. Marcus, and Y. Oreg, Majo-
rana zero modes in superconductor–semiconductor het-
erostructures, Nature Reviews Materials 3, 52 (2018).

[25] A. Y. Kitaev, Unpaired majorana fermions in quantum

wires, Physics-Uspekhi 44, 131 (2001).

[26] A. Kitaev, Fault-tolerant quantum computation by

anyons, Annals of Physics 303, 2 (2003).

[27] S. D. Sarma, M. Freedman, and C. Nayak, Majorana
zero modes and topological quantum computation, npj
Quantum Information 1, 1 (2015).

[28] C. Nayak, S. H. Simon, A. Stern, M. Freedman,
and S. Das Sarma, Non-abelian anyons and topologi-
cal quantum computation, Rev. Mod. Phys. 80, 1083
(2008).

[29] T. D. Stanescu and S. Tewari, Majorana fermions in
semiconductor nanowires: fundamentals, modeling, and
experiment, Journal of Physics: Condensed Matter 25,
233201 (2013).

[30] D. Aasen, M. Hell, R. V. Mishmash, A. Higginbotham,
J. Danon, M. Leijnse, T. S. Jespersen, J. A. Folk, C. M.
Marcus, K. Flensberg, and J. Alicea, Milestones toward
majorana-based quantum computing, Phys. Rev. X 6,
031016 (2016).

[31] D. Rainis and D. Loss, Majorana qubit decoherence by
quasiparticle poisoning, Phys. Rev. B 85, 174533 (2012).
[32] A. Voulodimos, N. Doulamis, A. Doulamis, and E. Pro-
topapadakis, Deep Learning for Computer Vision: A
Brief Review, Computational Intelligence and Neuro-
science 2018, 7068349 (2018).

[33] T. Young, D. Hazarika, S. Poria, and E. Cam-
bria, Recent Trends in Deep Learning Based Natu-
ral Language Processing, arXiv:1708.02709 [cs] (2018),
arXiv:1708.02709 [cs].

[34] G. Eraslan, ˇZ. Avsec, J. Gagneur, and F. J. Theis, Deep
learning: New computational modelling techniques for
genomics, Nature Reviews Genetics 20, 389 (2019).
[35] G. Carleo, I. Cirac, K. Cranmer, L. Daudet, M. Schuld,
N. Tishby, L. Vogt-Maranto, and L. Zdeborov´a, Ma-
chine learning and the physical sciences, Rev. Mod.
Phys. 91, 045002 (2019).

[36] J. Carrasquilla, Machine learning for quantum matter,

Advances in Physics: X 5, 1797528 (2020).

[37] I. E. Lagaris, A. Likas, and D. I. Fotiadis, Artiﬁcial neu-
ral network methods in quantum mechanics, Computer
Physics Communications 104, 1 (1997).

[38] J. Carrasquilla and R. G. Melko, Machine learning
phases of matter, Nature Physics 13, 431 (2017).
[39] G. Carleo and M. Troyer, Solving the quantum many-
body problem with artiﬁcial neural networks, Science
355, 602 (2017).

[40] D. Kochkov and B. K. Clark, Variational optimiza-
tion in the ai era: Computational graph states and
supervised wave-function optimization, arXiv preprint
arXiv:1811.12423 (2018).

[41] D. Luo and B. K. Clark, Backﬂow transformations via
neural networks for quantum many-body wave func-
tions, Phys. Rev. Lett. 122, 226401 (2019).

[42] D. Pfau, J. S. Spencer, A. G. de G. Matthews, and
W. M. C. Foulkes, Ab-initio solution of the many-
electron schr¨odinger equation with deep neural networks
(2019), arXiv:1909.02487 [physics.chem-ph].

[43] J. Hermann, Z. Sch¨atzle, and F. No´e, Deep neural net-

work solution of the electronic schr¨odinger equation
(2019), arXiv:1909.08423 [physics.comp-ph].

[44] O. Sharir, Y. Levine, N. Wies, G. Carleo, and
A. Shashua, Deep autoregressive models for the eﬃcient
variational simulation of many-body quantum systems,
Phys. Rev. Lett. 124, 020503 (2020).

[45] M. Hibat-Allah, M. Ganahl, L. E. Hayward, R. G.
Melko, and J. Carrasquilla, Recurrent neural network
wave functions, Phys. Rev. Research 2, 023358 (2020).
[46] S. Lu, X. Gao, and L.-M. Duan, Eﬃcient representa-
tion of topologically ordered states with restricted boltz-
mann machines, Phys. Rev. B 99, 155136 (2019).
[47] X. Gao and L.-M. Duan, Eﬃcient representation of
quantum many-body states with deep neural networks,
Nature Communications 8, 662 (2017).

[48] I. Glasser, N. Pancotti, M. August, I. D. Rodriguez, and
J. I. Cirac, Neural-network quantum states, string-bond
states, and chiral topological states, Physical Review X
8, 10.1103/physrevx.8.011006 (2018).

[49] G. Torlai, G. Mazzola, J. Carrasquilla, M. Troyer,
R. Melko, and G. Carleo, Neural-network quantum state
tomography, Nature Physics 14, 447 (2018).

[50] G. Torlai and R. G. Melko, Latent Space Puriﬁcation
via Neural Density Operators, Physical Review Letters
120, 240503 (2018).

[51] J. Carrasquilla, G. Torlai, R. G. Melko, and L. Aolita,
Reconstructing quantum states with generative models,
Nature Machine Intelligence 1, 155 (2019).

[52] M. Rupp, A. Tkatchenko, K.-R. M¨uller, and O. A. von
Lilienfeld, Fast and accurate modeling of molecular at-
omization energies with machine learning, Phys. Rev.
Lett. 108, 058301 (2012).

[53] M. Rupp, Machine learning for quantum mechanics in a
nutshell, International Journal of Quantum Chemistry
115, 1058 (2015).

[54] K. T. Sch¨utt, M. Gastegger, A. Tkatchenko, K.-R.
M¨uller, and R. J. Maurer, Unifying machine learning
and quantum chemistry with a deep neural network for
molecular wavefunctions, Nature Communications 10,
5024 (2019).

[55] J. C. Snyder, M. Rupp, K. Hansen, K.-R. M¨uller, and
K. Burke, Finding density functionals with machine
learning, Phys. Rev. Lett. 108, 253002 (2012).

[56] L. Li, J. C. Snyder, I. M. Pelaschier, J. Huang, U.-
N. Niranjan, P. Duncan, M. Rupp, K.-R. M¨uller, and
K. Burke, Understanding machine-learned density func-
tionals, International Journal of Quantum Chemistry
116, 819 (2016).

[57] J. Liu, Y. Qi, Z. Y. Meng, and L. Fu, Self-learning monte

carlo method, Phys. Rev. B 95, 041101 (2017).

[58] L. Huang and L. Wang, Accelerated monte carlo simu-
lations with restricted boltzmann machines, Phys. Rev.
B 95, 035105 (2017).

[59] S. Pilati, E. M. Inack, and P. Pieri, Self-learning pro-
jective quantum monte carlo simulations guided by re-
stricted boltzmann machines, Phys. Rev. E 100, 043301
(2019).

[60] A. A. Melnikov, H. P. Nautrup, M. Krenn, V. Dunjko,
M. Tiersch, A. Zeilinger, and H. J. Briegel, Active learn-
ing machine learns to create new quantum experiments,
Proceedings of the National Academy of Sciences 115,
1221 (2018).

[61] J. Yao, L. Lin, and M. Bukov, Reinforcement Learning
for Many-Body Ground State Preparation based

15

Counter-Diabatic Driving,

arXiv:2010.03655
on
[cond-mat,
physics:quant-ph]
(2020), arXiv:2010.03655 [cond-mat, physics:physics,
physics:quant-ph].

physics:physics,

[62] T. F¨osel, P. Tighineanu, T. Weiss, and F. Marquardt,
Reinforcement learning with neural networks for quan-
tum feedback, Phys. Rev. X 8, 031084 (2018).

[63] V. Dunjko and H. J. Briegel, Machine learning & ar-
tiﬁcial intelligence in the quantum domain: A review
of recent progress, Reports on Progress in Physics 81,
074001 (2018).

[64] M. Bukov, A. G. R. Day, D. Sels, P. Weinberg,
A. Polkovnikov, and P. Mehta, Reinforcement learning
in diﬀerent phases of quantum control, Phys. Rev. X 8,
031086 (2018).

[65] M. Y. Niu, S. Boixo, V. N. Smelyanskiy, and H. Neven,
Universal quantum control through deep reinforcement
learning, npj Quantum Information 5, 1 (2019).

[66] X.-M. Zhang, Z. Wei, R. Asad, X.-C. Yang, and
X. Wang, When does reinforcement learning stand out
in quantum control? A comparative study on state
preparation, npj Quantum Information 5, 1 (2019).
[67] F. Sch¨afer, M. Kloc, C. Bruder, and N. L¨orch, A diﬀer-
entiable programming method for quantum control, Ma-
chine Learning: Science and Technology 10.1088/2632-
2153/ab9802 (2020).

[68] V. Mnih, K. Kavukcuoglu, D. Silver, A. A. Rusu,
J. Veness, M. G. Bellemare, A. Graves, M. Riedmiller,
A. K. Fidjeland, G. Ostrovski, S. Petersen, C. Beat-
tie, A. Sadik, I. Antonoglou, H. King, D. Kumaran,
D. Wierstra, S. Legg, and D. Hassabis, Human-level
control through deep reinforcement learning, Nature
518, 529 (2015).

[69] D. Silver, A. Huang, C. J. Maddison, A. Guez,
L. Sifre, G. van den Driessche, J. Schrittwieser,
I. Antonoglou, V. Panneershelvam, M. Lanctot,
S. Dieleman, D. Grewe, J. Nham, N. Kalchbrenner,
I. Sutskever, T. Lillicrap, M. Leach, K. Kavukcuoglu,
T. Graepel, and D. Hassabis, Mastering the game of Go
with deep neural networks and tree search, Nature 529,
484 (2016).

[70] R. S. Sutton and A. G. Barto, Reinforcement Learning:
An Introduction (A Bradford Book, Cambridge, MA,
USA, 2018).

[71] A. G. Baydin, B. A. Pearlmutter, A. A. Radul, and J. M.
Siskind, Automatic diﬀerentiation in machine learning:
A survey, J. Mach. Learn. Res. 18, 5595–5637 (2017).

[72] I. Rechenberg, Evolutionsstrategie: Optimierung tech-
nischer Systeme nach Prinzipien der biologischen Evo-
lution (Stuttgart : Frommann-Holzboog, 1973).

[73] M. S. Scheurer and A. Shnirman, Nonadiabatic pro-
cesses in majorana qubit systems, Phys. Rev. B 88,
064515 (2013).

[74] T. Karzig, A. Rahmani, F. von Oppen, and G. Refael,
Optimal control of majorana zero modes, Phys. Rev. B
91, 201404 (2015).

[75] A. Conlon, D. Pellegrino, J. K. Slingerland, S. Doo-
ley, and G. Kells, Error generation and propagation in
majorana-based topological qubits, Phys. Rev. B 100,
134307 (2019).

[76] P. W. Brouwer, M. Duckheim, A. Romito, and F. von
Oppen, Probability distribution of majorana end-state
energies in disordered wires, Phys. Rev. Lett. 107,
196804 (2011).

[77] S. B. Chung, H.-J. Zhang, X.-L. Qi, and S.-C.
Zhang, Topological superconducting phase and ma-
in half-metal/superconductor het-
jorana fermions
erostructures, Phys. Rev. B 84, 060510 (2011).

[78] S. Nadj-Perge, I. K. Drozdov, B. A. Bernevig, and
A. Yazdani, Proposal for realizing majorana fermions
in chains of magnetic atoms on a superconductor, Phys.
Rev. B 88, 020407 (2013).

[79] B. Bernevig and T. Hughes, Topological Insulators
and Topological Superconductors (Princeton University
Press, 2013).

[80] N. Read and D. Green, Paired states of fermions in two
dimensions with breaking of parity and time-reversal
symmetries and the fractional quantum hall eﬀect,
Phys. Rev. B 61, 10267 (2000).

[81] D. A. Ivanov, Non-abelian statistics of half-quantum
vortices in p-wave superconductors, Phys. Rev. Lett. 86,
268 (2001).

[82] A. Stern, F. von Oppen, and E. Mariani, Geometric
phases and quantum entanglement as building blocks
for non-abelian quasiparticle statistics, Phys. Rev. B 70,
205338 (2004).

[83] M. Stone and S.-B. Chung, Fusion rules and vortices
in px + ipy superconductors, Phys. Rev. B 73, 014505
(2006).

[84] J. C. Budich, S. Walter, and B. Trauzettel, Failure of
protection of majorana based qubits against decoher-
ence, Phys. Rev. B 85, 121405 (2012).

[85] F. Konschelle and F. Hassler, Eﬀects of nonequilibrium
noise on a quantum memory encoded in majorana zero
modes, Phys. Rev. B 88, 075431 (2013).

[86] H. T. Ng, Decoherence of interacting majorana modes,

Scientiﬁc Reports 5, 12530 (2015).

[87] F. L. Pedrocchi and D. P. DiVincenzo, Majorana braid-
ing with thermal noise, Phys. Rev. Lett. 115, 120402
(2015).

[88] Y. Hu, Z. Cai, M. A. Baranov, and P. Zoller, Majorana
fermions in noisy kitaev wires, Phys. Rev. B 92, 165118
(2015).

[89] C. Knapp, M. Zaletel, D. E. Liu, M. Cheng, P. Bonder-
son, and C. Nayak, The nature and correction of dia-
batic errors in anyon braiding, Phys. Rev. X 6, 041003
(2016).

[90] C. Knapp, T. Karzig, R. M. Lutchyn, and C. Nayak,
Dephasing of majorana-based qubits, Phys. Rev. B 97,
125404 (2018).

[91] Y. Huang, A. M. Lobos, and Z. Cai, Dissipative majo-

rana quantum wires, iScience 21, 241 (2019).

[92] T. Karzig, G. Refael, and F. von Oppen, Boosting ma-
jorana zero modes, Phys. Rev. X 3, 041017 (2013).
[93] B. Bauer, T. Karzig, R. V. Mishmash, A. E. Antipov,
and J. Alicea, Dynamics of Majorana-based qubits op-
erated with an array of tunable gates, SciPost Phys. 5,
4 (2018).

[94] A. E. Antipov, A. Bargerbos, G. W. Winkler, B. Bauer,
E. Rossi, and R. M. Lutchyn, Eﬀects of gate-induced
electric ﬁelds on semiconductor majorana nanowires,
Phys. Rev. X 8, 031041 (2018).

[95] B. D. Woods, T. D. Stanescu, and S. Das Sarma, Eﬀec-
tive theory approach to the schr¨odinger-poisson prob-
lem in semiconductor majorana devices, Phys. Rev. B
98, 035428 (2018).

[96] Z.-C. Yang, A. Rahmani, A. Shabani, H. Neven, and
C. Chamon, Optimizing variational quantum algorithms

16

using pontryagin’s minimum principle, Phys. Rev. X 7,
021027 (2017).

[97] L. T. Brady, C. L. Baldwin, A. Bapat, Y. Kharkov, and
A. V. Gorshkov, Optimal protocols in quantum anneal-
ing and qaoa problems (2020), arXiv:2003.08952 [quant-
ph].

[98] M. V. Berry, Quantum phase corrections from adiabatic
iteration, Proceedings of the Royal Society of London.
A. Mathematical and Physical Sciences 414, 31 (1987).
[99] M. Deschamps, G. Kervern, D. Massiot, G. Pintacuda,
L. Emsley, and P. J. Grandinetti, Superadiabaticity in
magnetic resonance, The Journal of Chemical Physics
129, 204110 (2008), https://doi.org/10.1063/1.3012356.
[100] J. D. Sau, D. J. Clarke, and S. Tewari, Controlling non-
abelian statistics of majorana fermions in semiconductor
nanowires, Phys. Rev. B 84, 094505 (2011).

[101] B. I. Halperin, Y. Oreg, A. Stern, G. Refael, J. Alicea,
and F. von Oppen, Adiabatic manipulations of majo-
rana fermions in a three-dimensional network of quan-
tum wires, Phys. Rev. B 85, 144501 (2012).

[102] B. van Heck, A. R. Akhmerov, F. Hassler, M. Burrello,
and C. W. J. Beenakker, Coulomb-assisted braiding of
majorana fermions in a josephson junction array, New
Journal of Physics 14, 035019 (2012).

[103] M. Burrello, B. van Heck, and A. R. Akhmerov, Braid-
ing of non-abelian anyons using pairwise interactions,
Phys. Rev. A 87, 022343 (2013).

[104] P. Bonderson, M. Freedman,

Measurement-only
tion, Phys. Rev. Lett. 101, 010501 (2008).

topological

and C. Nayak,
quantum computa-

[105] P. Bonderson, Measurement-only topological quantum
computation via tunable interactions, Phys. Rev. B 87,
035113 (2013).

[106] S. Vijay and L. Fu, Teleportation-based quantum in-
formation processing with majorana zero modes, Phys.
Rev. B 94, 235446 (2016).

[107] T. Karzig, C. Knapp, R. M. Lutchyn, P. Bonderson,
M. B. Hastings, C. Nayak, J. Alicea, K. Flensberg,
S. Plugge, Y. Oreg, C. M. Marcus, and M. H. Freedman,
Scalable designs for quasiparticle-poisoning-protected
topological quantum computation with majorana zero
modes, Phys. Rev. B 95, 235305 (2017).

[108] S. Plugge, A. Rasmussen, R. Egger, and K. Flens-
berg, Majorana box qubits, New Journal of Physics 19,
012001 (2017).

[109] C. Knapp, J. I. V¨ayrynen, and R. M. Lutchyn, Number-
conserving analysis of measurement-based braiding with
majorana zero modes, Phys. Rev. B 101, 125108 (2020).
[110] C. Zeng, G. Sharma, T. D. Stanescu, and S. Tewari,
Feasibility of measurement-based braiding in the quasi-
majorana regime of semiconductor-superconductor het-
erostructures, Phys. Rev. B 102, 205101 (2020).
[111] E. Torrontegui, S. Ib´a˜nez, S. Mart´ınez-Garaot, M. Mod-
ugno, A. del Campo, D. Gu´ery-Odelin, A. Ruschhaupt,
X. Chen, and J. G. Muga, Chapter 2 - Shortcuts to
Adiabaticity, in Advances In Atomic, Molecular, and
Optical Physics, Advances in Atomic, Molecular, and
Optical Physics, Vol. 62, edited by E. Arimondo, P. R.
Berman, and C. C. Lin (Academic Press, 2013) pp. 117–
169.

[112] T. Karzig, F. Pientka, G. Refael, and F. von Oppen,
Shortcuts to non-abelian braiding, Phys. Rev. B 91,
201102 (2015).

[113] G. Kells, V. Lahtinen, and J. Vala, Kitaev spin models

from topological nanowire networks, Phys. Rev. B 89,
075122 (2014).

[114] L. Coopmans, D. Luo, G. Kells, B. K. Clark, and J. Car-
rasquilla, Protocol discovery for the quantum control of
majoranas by diﬀerential programming and natural evo-
lution strategies, github repository (2020).

[115] R. E. Wengert, A simple automatic derivative evalua-
tion program, Commun. ACM 7, 463–464 (1964).
[116] H.-J. Liao, J.-G. Liu, L. Wang, and T. Xiang, Diﬀeren-
tiable programming tensor networks, Phys. Rev. X 9,
031041 (2019).

[117] H. Xie, J.-G. Liu, and L. Wang, Automatic diﬀeren-
tiation of dominant eigensolver and its applications in
quantum physics, Phys. Rev. B 101, 245139 (2020).

[118] S. Sorella and L. Capriotti, Algorithmic diﬀerentiation
and the calculation of forces by quantum monte carlo,
The Journal of Chemical Physics 133, 234111 (2010).

[119] S.-X. Zhang, Z.-Q. Wan, and H. Yao, Automatic diﬀer-
entiable monte carlo: Theory and application (2019),
arXiv:1911.09117 [physics.comp-ph].

[120] N. Leung, M. Abdelhafez, J. Koch, and D. Schuster,
Speedup for quantum optimal control from automatic
diﬀerentiation based on graphics processing units, Phys.
Rev. A 95, 042318 (2017).

[121] D. E. Rumelhart, G. E. Hinton, and R. J. Williams,
Learning representations by back-propagating errors,
Nature 323, 533 (1986).

[122] W. Baur and V. Strassen, The complexity of par-
tial derivatives, Theoretical Computer Science 22, 317
(1983).

[123] J. Morgenstern, How to compute fast a function and
all its derivatives: A variation on the theorem of baur-
strassen, SIGACT News 16, 60–62 (1985).

[124] J. Bradbury, R. Frostig, P. Hawkins, M. J. Johnson,
C. Leary, D. Maclaurin, and S. Wanderman-Milne, JAX:
composable transformations of Python+NumPy pro-
grams (2018).

[125] D. P. Kingma and J. Ba, Adam: A method for stochastic
optimization, in 3rd International Conference on Learn-
ing Representations, ICLR 2015, San Diego, CA, USA,
May 7-9, 2015, Conference Track Proceedings, edited
by Y. Bengio and Y. LeCun (2015).

[126] H.-P.

von
Schwefel, Numerische Optimierung
Computer-Modellen mittels der Evolutionsstrategie,
ISR, Vol. 26 (Birkhaeuser, Basel/Stuttgart, 1977) p.
390.

[127] D. Wierstra, T. Schaul, T. Glasmachers, Y. Sun, J. Pe-
ters, and J. Schmidhuber, Natural evolution strategies,
Journal of Machine Learning Research 15, 949 (2014).
[128] T. Salimans, J. Ho, X. Chen, S. Sidor, and I. Sutskever,
Evolution Strategies as a Scalable Alternative to Rein-
forcement Learning, arXiv:1703.03864 [cs, stat] (2017),
arXiv:1703.03864 [cs, stat].

[129] R. S. Sutton and A. G. Barto, Reinforcement Learning:
An Introduction, 2nd ed. (The MIT Press, 2018).
[130] R. Chakrabarti and H. Rabitz, Quantum control land-
scapes, International Reviews in Physical Chemistry 26,
671 (2007).

[131] A. G. R. Day, M. Bukov, P. Weinberg, P. Mehta, and
D. Sels, Glassy phase of optimal quantum control, Phys.
Rev. Lett. 122, 020601 (2019).

[132] D. Ghosh, A. Gupta, A. Reddy, J. Fu, C. Devin, B. Ey-
senbach, and S. Levine, Learning to reach goals via
iterated supervised learning (2020), arXiv:1912.06088

17

[cs.LG].

[133] H.-L. Huang, M. Naro˙zniak, F. Liang, Y. Zhao, A. D.
Castellano, M. Gong, Y. Wu, S. Wang, J. Lin, Y. Xu,
H. Deng, H. Rong, J. P. Dowling, C.-Z. Peng, T. Byrnes,
X. Zhu, and J.-W. Pan, Emulating quantum teleporta-
tion of a majorana zero mode qubit, Phys. Rev. Lett.
126, 090502 (2021).

[134] E. M. Stoudenmire, J. Alicea, O. A. Starykh, and M. P.
Fisher, Interaction eﬀects in topological superconduct-
ing wires supporting majorana fermions, Phys. Rev. B
84, 014503 (2011).

[135] E. Sela, A. Altland, and A. Rosch, Majorana fermions
in strongly interacting helical liquids, Phys. Rev. B 84,
085114 (2011).

[136] R. M. Lutchyn and M. P. A. Fisher, Interacting topo-
logical phases in multiband nanowires, Phys. Rev. B 84,
214528 (2011).

[137] F. Cr´epin, G. Zar´and, and P. Simon, Nonperturba-
tive phase diagram of interacting disordered majorana
nanowires, Phys. Rev. B 90, 121407 (2014).

[138] N. M. Gergs, L. Fritz, and D. Schuricht, Topological or-
der in the kitaev/majorana chain in the presence of dis-
order and interactions, Phys. Rev. B 93, 075129 (2016).
[139] G. Kells, N. Moran, and D. Meidan, Localization en-
hanced and degraded topological order in interacting
p-wave wires, Phys. Rev. B 97, 085425 (2018).

[140] A. Moon and B. Nachtergaele, Stability of gapped
ground state phases of spins and fermions in one di-
mension, Journal of Mathematical Physics 59, 091415
(2018), https://doi.org/10.1063/1.5036751.

[141] P. W. Brouwer, M. Duckheim, A. Romito, and F. von
Oppen, Topological superconducting phases in disor-
dered quantum wires with strong spin-orbit coupling,
Phys. Rev. B 84, 144526 (2011).

[142] W. DeGottardi, D. Sen, and S. Vishveshwara, Majo-
rana fermions in superconducting 1d systems having pe-
riodic, quasiperiodic, and disordered potentials, Phys.
Rev. Lett. 110, 146404 (2013).

[143] J. Haegeman, J. I. Cirac, T. J. Osborne, I. Piˇzorn,
H. Verschelde, and F. Verstraete, Time-dependent vari-
ational principle for quantum lattices, Phys. Rev. Lett.
107, 070601 (2011).

[144] S. Paeckel, T. K¨ohler, A. Swoboda, S. Manmana,
U. Schollw¨ock, and C. Hubig, Time-evolution meth-
ods for matrix-product states, Annals of Physics 411,
167998 (2019).

[145] F. Sch¨afer, P. Sekatski, M. Koppenh¨ofer, C. Bruder, and
M. Kloc, Control of stochastic quantum dynamics with
diﬀerentiable programming (2021), arXiv:2101.01190
[quant-ph].

[146] M. Abdelhafez, D. I. Schuster, and J. Koch, Gradient-
based optimal control of open quantum systems us-
ing quantum trajectories and automatic diﬀerentiation,
Phys. Rev. A 99, 052327 (2019).

[147] C. M. Bishop, Pattern Recognition and Machine Learn-
ing (Information Science and Statistics) (Springer-
Verlag, Berlin, Heidelberg, 2006).

[148] D. Petz and C. Ghinea, Introduction to quantum ﬁsher
information, in Quantum Probability and Related Top-
ics, Vol. Volume 27 (WORLD SCIENTIFIC, 2011) pp.
261–281.

[149] M. A. Nielsen and I. L. Chuang, Quantum Computation
and Quantum Information: 10th Anniversary Edition,
10th ed. (Cambridge University Press, New York, NY,

18

USA, 2011).

[150] W. P. Su, J. R. Schrieﬀer, and A. J. Heeger, Solitons in
polyacetylene, Phys. Rev. Lett. 42, 1698 (1979).
[151] M.-T. Rieder, G. Kells, M. Duckheim, D. Meidan, and
P. W. Brouwer, Endstates in multichannel spinless p-
wave superconducting wires, Phys. Rev. B 86, 125423
(2012).

[152] C. Liu, X. Xu, and D. Hu, Multiobjective reinforce-
ment learning: A comprehensive overview, IEEE Trans-
actions on Systems, Man, and Cybernetics: Systems 45,
385 (2015).

[153] E. M. Stoudenmire, J. Alicea, O. A. Starykh, and M. P.
Fisher, Interaction eﬀects in topological superconduct-
ing wires supporting majorana fermions, Phys. Rev. B
84, 014503 (2011).

[154] S. R. White and A. E. Feiguin, Real-time evolution
using the density matrix renormalization group, Phys.
Rev. Lett. 93, 076401 (2004).

[155] J. J. Sakurai, Modern quantum mechanics; rev. ed.

(Addison-Wesley, Reading, MA, 1994).

[156] P. Ring and P. Schuck, The Nuclear Many-Body Prob-
lem, Physics and astronomy online library (Springer,
2004).

[157] M. B. Giles, Collected matrix derivative results for for-
ward and reverse mode algorithmic diﬀerentiation, in
Advances in Automatic Diﬀerentiation, edited by C. H.
Bischof, H. M. B¨ucker, P. Hovland, U. Naumann, and
J. Utke (Springer Berlin Heidelberg, Berlin, Heidelberg,
2008) pp. 35–44.

[158] R. T. Q. Chen, Y. Rubanova, J. Bettencourt, and
D. Duvenaud, Neural ordinary diﬀerential equations
(2019), arXiv:1806.07366 [cs.LG].

[159] C. Rackauckas, Y. Ma, V. Dixit, X. Guo, M. Innes,
J. Revels, J. Nyberg, and V. Ivaturi, A Compari-
son of Automatic Diﬀerentiation and Continuous Sen-
sitivity Analysis for Derivatives of Diﬀerential Equa-
tion Solutions, arXiv e-prints , arXiv:1812.01892 (2018),
arXiv:1812.01892 [cs.NA].

[160] V. F. Krotov, Global Methods in Optimal Control The-
ory, in Advances in Nonlinear Dynamics and Control:
A Report from Russia, Progress in Systems and Con-
trol Theory, edited by A. B. Kurzhanski (Birkh¨auser,
Boston, MA, 1993) pp. 74–121.

[161] N. Khaneja, T. Reiss, C. Kehlet, T. Schulte-
Herbr¨uggen, and S. J. Glaser, Optimal control of cou-
pled spin dynamics: Design of NMR pulse sequences by
gradient ascent algorithms, Journal of Magnetic Reso-
nance 172, 296 (2005).

[162] G. Matheron, N. Perrin, and O. Sigaud, The problem
with ddpg: understanding failures in deterministic envi-
ronments with sparse rewards (2019), arXiv:1911.11679
[cs.LG].

[163] G. Dulac-Arnold, D. Mankowitz, and T. Hester, Chal-
lenges of real-world reinforcement learning (2019),
arXiv:1904.12901 [cs.LG].

[164] L. Coopmans, K. Kavanagh, I. Jubb, S. Dooley, and
G. Kells, On dynamical phase error in interacting topo-
logical quantum memories (2020), arXiv:2101.00022
[cond-mat.str-el].

Appendix

19

Protocol Discovery for the Quantum Control of Majoranas by Diﬀerentiable
Programming and Natural Evolution Strategies

Appendix A: Derivation of the Critical Velocity and Moving Frame Picture

In this appendix we ﬁrst introduce some background theory related to the critical velocity and the Majorana-mode
wave function in the moving frame. Afterwards we derive the resonance time scale Tres for Majorana shuttling from
the Fermi golden rule and ﬁnally we show the emergence of this resonance timescale in numerical simulations for
forward oscillating motion.

1. Dispersion and Majorana Mode in the Moving Frame

To ﬁnd the critical velocity we start from the periodic (N+1=1) Kitaev chain Hamiltonian (Eq. 1 with V (x, t) = 0)

in the continuum which reads after a Fourier transformation
(cid:32) k2

Hk = (cid:126)dk · (cid:126)σ =

(cid:33)

2m − µ
−i∆k − k2

i∆k
2m + µ

(A1)

with (cid:126)dk = (0, −∆k, k2
2m −µ), momentum k and (cid:126)σ the Pauli spin matrices. Solving for the energy eigenvalues gives mode
(cid:12)
(cid:126)dk
( k2
(cid:12)
2m − µ)2 + ∆2k2. The moving frame can now be obtained by a Galilean transformation
dispersion (cid:15)k = ±
(cid:12) = ±
in terms of the unitary rotation U (t) = e−ik (cid:82) t
0 v(t(cid:48))dt(cid:48)
which is the time dependent translation operator that rotates
to a frame with domain wall velocity v(t). Applying this to A1 gives the moving frame Hamiltonian

(cid:113)

(cid:12)
(cid:12)
(cid:12)

Hv(t) = U †(t)HkU (t) + i

dU †
dt

U (t) =

(cid:32) k2

2m − µ + v(t)k
−i∆k

i∆k
2m + µ + v(t)k

− k2

(cid:33)

.

(A2)

(cid:12)
(cid:12)
(cid:12)

(cid:113)

(cid:126)dk

The moving frame has an extra term v(t)k on the diagonal which means the moving frame energy dispersion is
( k2
2m − µ)2 + ∆2k2 + vk [73]. This results in a tilted dispersion as shown in Fig. A1, when v = ∆
(cid:15)k = ±
the tilt causes the gap to close and we have a topological phase transition. This velocity deﬁnes the critical velocity
vcrit = ∆.

(cid:12)
(cid:12)
(cid:12) = ±

Besides the energy dispersion, we can also look at the wave function of the Majorana zero modes in the moving
frame. To ﬁnd this wave function we solve for the zero-energy solutions of the moving frame Hamiltonian A2 which
results in ψ = [φ, −φ](cid:124) with

φ(x) ∝ e−x/(γξ) sin

(cid:18)(cid:113)

k2
F + 1/(γξ)2x

(cid:19)

.

(A3)

(cid:113)

The diﬀerence with the Majoranas in the lab frame is that the localization length ξ = 1/∆m is dilated by a factor
∆2 causing the Majorana modes to become spatially more extended (delocalized) in the moving frame.
γ = 1/
When v = vcrit = ∆ the localization length becomes inﬁnite indicating that the local character is lost and hence a
topological phase transition occurs as shown in Fig. A1.

1 − v2

2. Derivation and numerical analysis of the resonant time scale

To derive the time scale for resonant Majorana motion we consider a scenario in which we are shuttling the left

Majorana back and forth by using

vL(t) = vmax sin ωt

(A4)

20

FIG. A1. a) Mode dispersion in the moving frame for several diﬀerent velocities. b) Localization of the Majorana zero modes
in the moving frame for several diﬀerent velocities. It can be seen that the gap closes for v = vcrit = ∆ and simultaneously the
Majoranas delocalize in the moving frame.

for the velocity of the left domain wall in Eq. 2. When vmax is not too large, i.e.
the amplitude of the left
domain wall position can be considered small compared to the total length of the wire N , we can treat this motion
as a time-dependent perturbation and apply perturbation theory.
In this case we write the external potential as
V = V0 + δV sin ωt in which V0 is the static domain wall proﬁle in Eq. 2 and δV sin ωt a time-dependent ﬂuctuation
on top of it. From Fermi’s Golden Rule for a harmonic perturbation [155] we can ﬁnd the inﬁdelity rate to be

lim
T (cid:55)→∞

I(T )
T

= lim
T (cid:55)→∞

1
T

(cid:40)

[1 − | (cid:104)ψ0| exp

−i

(cid:90) T

0

(cid:41)

H(t)dt

|ψ0(cid:105) |2] = lim
T (cid:55)→∞

(cid:40)

| (cid:104)ψi| exp

−i

(cid:90) T

0

1
T

(cid:88)

i(cid:54)=0

(cid:41)

H(t)dt

|ψ0(cid:105) |2 = (A5)

2π

(cid:88)

i(cid:54)=0

(δ(Ei − E0 + ω) + δ(Ei − E0 − ω))| (cid:104)ψi| δV |ψ0(cid:105) |2 (A6)

in which |ψi(cid:105) are the eigenstates of the Hamiltonian with the static domain wall proﬁle V0 which have energy Ei.

From this equation we can read oﬀ that there are resonances in the inﬁdelity whenever ωres = ±(Ei − E0), for
the ﬁrst excited state ωres = Ei − E0 = ∆kF is equal to the gap in the system and we arrive at the resonance
time Tres = 2π
. The resonances for the higher energy bands are suppressed with the transition amplitude
ωres
| (cid:104)ψi| δV |ψ0(cid:105) |2. When ω (cid:55)→ ∞ there are no resonances and the inﬁdelity becomes zero; the intuition for this is that the
static system H0 does not notice the harmonic perturbation because it oscillates at a much higher frequency. Similarly,
when ω < ωres there are also no resonances because the frequencies are smaller than the gap which corresponds to
adiabatic Majorana motion.

= 2π
∆kF

In the Majorana motion problem in the main text we are however looking at moving the left domain wall forward

from xA to xB. As shown in Fig. A2 we see that the same resonance time scale emerges for forward motion with

For ω (cid:55)→ ∞ we get the same rate as constant motion with vmax
adiabaticity.

2 which can be explained for low velocities from

vL(t) = vmax

1 − cos ωt
2

.

(A7)

Appendix B: Algorithm and Analysis of the Derivative of the Inﬁdelity

In this appendix we ﬁrst outline the algorithm we use to compute the many-body overlap Eq. 3 for the Majorana
wire setup. Afterwards we argue that all operations in this algorithm are diﬀerentiable and we can obtain the derivative
of the ﬁdelity with respect to control parameters using automatic diﬀerentiation. In the end we show the numerical
obtained derivatives and check them with ﬁnite diﬀerence methods.

21

FIG. A2. a) Inﬁdelity as a function of frequency ω, the black dashed line indicates the resonance frequency ωres = ∆kF = 0.3.
At ω (cid:55)→ ∞ the inﬁdelity is the same as for constant linear motion with xL(t) = vmax
t. b) Inﬁdelity as a function of frequency
and vmax. For velocities vmax > vcrit = 0.3 there are no low adiabatic frequencies anymore. The parameters used in these
simulations are N = 140, µ = 1, w = 1, ∆ = 0.3 and σ = 1.

2

To ﬁnd the ﬁdelity we ﬁrst write the Hamiltonian Eq. 1 in Bogolyubov-de-Gennes (single-particle) form [79, 156]

H(t) =

1
2

C †HBdG(t)C

with C † ≡ [c†

1...c†

i ....c†

N c1...ci....cN ] and diagonalize it

HBdG(t)W (t) = E(t)W (t)

(B1)

(B2)

in which the columns of W (t) =

(cid:20) u(t) v(t)∗
v(t) u(t)∗

(cid:21)

are the eigenmodes (quasi-particle modes) of the BdG Hamiltonian

and E(t) is the diagonal matrix of the mode energies [E]ii(t) = (cid:15)i(t). To compute the ﬁnal many-body overlap at
time t = T we then use the Onishi Formula

F(T ) = | (cid:104)ψB|ψ(T )(cid:105) |2 = det(u∗

Bu(T ) + v∗

Bv(T ))

(B3)

which relates the BdG quasi-particle picture to the many-body picture. In this u(T ) and v(T ) can be obtained from
W (T ) = T e−i (cid:82) T
W (0) and uB and vB from the diagonalization of the instantaneous BdG Hamiltonian with
the domain wall at position xB. F(T ) can now be used to compute the inﬁdelity I(T ) in Eq. 3 in the main text.

0 Hbdg(t(cid:48))dt(cid:48)

From a programming perspective, a code to compute the inﬁdelity from Eq. B3 and Eq. 3 consists of a series
of elementary operations (primitives) fi that map the input control xL(t) with t ∈ [0, T ] to the output I(T ) =
fn ◦ fn−1 ◦ · · · ◦ f1(xL(t)). The required primitives for this algorithm are matrix multiplications, diagonalization of
a hermitian matrix B2 and taking the determinant B3. Each of these operations has a known forward and reverse
mode derivative [157] that can be recursively assembled in the chain rule

dI
dxL

=

dfn
dfn−1

dfn−1
dfn−2

· · ·

df1
dxL

(B4)

to ﬁnd the derivative of the inﬁdelity with respect to the control.

An automatic diﬀerentiation package, like the JAX library [124], computes all the derivatives of the primitives in a
code automatically and assembles them in the chain rule to evaluate the total gradient of a computer program. We
applied this method to the code to compute the inﬁdelity and used the gradient for the optimizations described in
the main text. In Fig. A3 a) we show an example for the gradient obtained in this way for a linear motion protocol
in regime I which we checked with ﬁnite diﬀerence to make sure it was working correctly. We observe that for this
protocol the gradient is the biggest at the boundary which might explain the jumping behaviour at the beginning and
end of the protocols we found with the ML optimizations (Fig. 2).

22

FIG. A3. a) Comparison between the gradient of the inﬁdelity I with respect to the control xL obtained with automatic
diﬀerentiation (AD) and ﬁnite diﬀerence. The gradients dI
were evaluated for a linear protocol xL(t) = vavgt as a function
dxL
of time t in regime I. The AD gradient matches up with the ﬁnite diﬀerence gradient and we note that at the beginning and
end of the protocol the magnitude of the gradient is the largest. b) and c) Optimized parameterized bang-bang protocols in
regimes II (b) and IV (c) with the simulated annealing method. The position proﬁles xL(t) are plotted in the main panels
and the velocity proﬁles vL(t) in the insets. The bang-bang protocols seem to approximate the JMJ protocol in regime II and
super-adiabatic protocol in regime IV. The parameters for these simulations were the same as in Fig. 2 in the main text.

≈ ΠT /dt

0 Hbdg(t(cid:48))dt(cid:48)

To compute the matrix exponential required for the computation of W (T ) = T e−i (cid:82) T

W (0) we discretize
the continuous time variable t in individual time steps of size dt and apply the Trotter-Suzuki expansion to write
T e−i (cid:82) T
j=1 e−iHBdG(jdt)dt. This means that while the time complexity of the back-propagation algo-
rithm is similar to the forward evaluation, the memory complexity grows linearly with the number of discrete time
steps T /dt. A method to circumvent this growth in memory complexity is the use of adjoint sensitivity methods [158]
which avoid back propagating through the time evolution diﬀerential equation (Schr¨odinger equation) by solving a
second diﬀerential equation backwards in time. In practise the memory complexity did not turn out to be a bottle-
neck in our simulations however and it was suﬃcient to use the backpropagation algorithm as described above. For
extending our methods to include disorder and interactions or for simulating very long times T ∼ O(103) the adjoint
method might be a good option to explore and we refer the interested reader to [159] for comparative studies between
the adjoint and backprogagation algorithms.

0 Hbdg(t(cid:48))dt(cid:48)

Appendix C: Gradient Formula for Natural Evolution Strategies

Denote pθ(φ) for the Gaussian distribution φ ∼ N (θ, σ2I) with σ ﬁxed. It follows that [127]

∇θEφ∼N (θ,σ2I) [I(T, φ)] = ∇θ

(cid:90)

pθ(φ)I(T, φ)dφ

(cid:90)

(cid:90)

=

=

pθ(φ)∇θlogpθ(φ)I(T, φ)dφ

pθ(φ)

(φ − θ)
σ2

I(T, φ)dφ.

With change of variable φ = θ + σ(cid:15), we have

∇θEφ∼N (θ,σ2I) [I(T, φ)] =

(cid:90)

pI((cid:15))I(T, θ + σ(cid:15))(cid:15)/σd(cid:15)

= E(cid:15)∼N (0,I) [I(T, θ + σ(cid:15))(cid:15)/σ] .

(C1)

(C2)

(C3)

(C4)

(C5)

Appendix D: Comparing standard benchmark protocols and diﬀerent parameterizations of the control

In addition to the SA benchmark results in the main paper, in this appendix we compare the ML results to
optimized parameterized standard bang-bang [74, 96] and super-adiabatic ramp-up-down protocols [75]. We will also
show results for ML optimizations of diﬀerent parameterizations of the control xL(t).

a)b)c)23

For a standard bang-bang protocol the velocity of the domain wall vL is at all times only allowed to take either the
value vL = vmin or the value vL = vmax, a switch between these two discrete velocities is called a bang. To search for
the optimal bang-bang protocols we ﬁx the minimum time between two consecutive bangs to be ∆t = 0.1 and perform
a simulated annealing search similar to the one described in the main text. In this SA search we impose an additional
constraint (compared to the free search in the main text) in which each update steps consist of changing vmax to vmin
and vice versa to retain the bang-bang character of the protocols. We note that a version of this method was used in
[131] to search for optimal bang-bang protocols in a spin system. We used vmin = 0 similar to the bang-bang protocols
in [74] and we scanned diﬀerent values of the maximum velocity 0 < vmax < 8vavg. This means that for some of the
bang-bang protocols in regimes I and II vmax ≥ vcrit which was not the case for the protocols in [74], however we
observed that increasing vmax leads to lower inﬁdelities even when making vmax bigger than the critical velocity.

The ramp-up-down protocols are a family of super-adiabatic protocols in which the velocity is slowly built up from

zero to some maximum velocity vmax and then ramped down again to zero as given by

vL(t) =






vmax
vmax,
vmax
0,

1−cos ωt
2

,

1−cos(ωt−ωT )
2

, π

0 ≤ t ≤ π
ω
ω ≤ t ≤ π
π
ω + T
ω + T ≤ t ≤ 2π
otherwise

ω + T

(D1)

in which ω is the parameter that determines how quickly the velocity is accelerated to vmax. To ﬁnd the best ramp-
up-down protocol in each regime we scanned over a large range of values of the free parameter ω (vmax is ﬁxed by the
average velocity constraint).

In Table A1 we summarize the best results (lowest inﬁdelity) of these protocols. We compared these results to
protocols obtained with the ML methods as described in the main text and see that in all regimes the ML protocols
outperform the standard benchmark protocols signiﬁcantly. The optimal bang-bang protocols obtained with the SA
method in regimes II and IV are plotted in Fig. A3. It can be seen that the protocols start to approximate the
optimal JMJ and super-adiabatic protocols obtained with the other methods. To be able to fully approximate the
optimal JMJ protocols with a bang-bang protocol one needs to test even higher maximum velocities than we did here
and also consider a negative minimum velocity vmin < 0.

Regime linear bang-bang ramp-up-down
0.3923
0.1713
0.0067
0.0004

0.4738
I
0.2236
II
III
0.0120
IV 0.0077

0.4817
0.2350
0.0125
0.0045

SA

DP NES
0.3801 0.3546 0.3431
0.1637 0.1549 0.1514
0.0062 0.0056 0.0071
0.0004 0.0005 0.0009

TABLE A1. Results for the inﬁdelity I(T ) of diﬀerent benchmark protocols (ﬁrst three columns) in regime I-IV compared to
results obtained with SA, AD and NES. For these simulations (l, T ) are {(4.32, 12), (4.95, 22), (0.48, 8), (2.4, 40)}, N = 110 and
the other parameters of the Majorana wire setup are the same as for ﬁgure 2 in the main text.

We also tested the NES and DP optimization algorithms for diﬀerent parameterizations of the control of the domain
wall on a smaller system size N = 50 before ﬁxing the speciﬁc parameterizations as used and described in the main
text for the big system N = 110. We compared parameterizing the control by the position xL(t), the velocity vL(t)
or a neural network xL(t) = NNθ(t) and show the results in Table A2. The optimization with NES gives the lowest
inﬁdelity when we parameterize by position in regimes I and II and by velocity in regimes III and IV. For the DP
optimization the best inﬁdelity optimizes a neural network in regimes I,III and IV and optimizes over the position in
regime II.

Appendix E: Discussion on other methods for quantum control

We now brieﬂy discuss the NES and DP methods in relation to traditional quantum control algorithms and RL
methods. First we note that DP provides a general framework to automatically evaluate gradients of computer
programs which can be integrated into traditional quantum control techniques such as the Krotov method [160],
Gradient-based-Pulse-Engineering[161], and other gradient-based control techniques. In this context, a key advantage
of DP is its ability to ease the implementation of gradient-based techniques, where, e.g., the incorporation of physical
constraints, such as the restrictions in the amplitude of the controls, requires only adding the constraints to the
main objective function. This avoids complex and potentially error-prone analytical calculations. In addition, the

Regime DP neural net DP position NES position NES velocity NES neural net

I
II
III
IV

0.3910
0.1541
0.0064
0.0001

0.4159
0.1531
0.0070
0.0024

0.3945
0.1453
0.0120
0.0148

0.4008
0.1509
0.0069
0.0004

0.4586
0.1842
0.0084
0.0007

24

TABLE A2. Comparison of the lowest inﬁdelity values between optimizations of AD and NES with respect to diﬀerent
parameterizations of the control (position xL(t), velocity vL(t) and neural net xL(t) = NNθ(t)). Based on these testing values
we determined which parameterizations to use for the optimizations in the main text. These simulations were run for a system
size of N = 50 and all the other parameters are the same as the parameters in Fig. 2 in the main text.

implementation of control protocols to widely diﬀerent physical scenarios (e.g. free fermion or boson Hamiltonians or
alternative simulation strategies) typically requires only the coding of the forward propagation of the simulation with
minimal changes to the optimization subroutines. In addition, quantum optimal control algorithms based on DP can
easily harness the acceleration aﬀorded by graphics processing units (GPUs), which may speedup quantum control
calculations by more than an order of magnitude [120]. This is most easily achieved using freely available open-source
packages such as JAX [124].

Compared to RL and other gradient-free methods, the DP method used here remains a powerful method as long
as the physical model is diﬀerentiable, as is the case in our work since the BdG algorithm B used to compute the
many-body inﬁdelity is fully diﬀerentiable. DP and all gradient-based methods provide a strong optimization signal
and typically converge faster than RL techniques, which often require high sample complexity for good convergence.
In addition, the use of gradients avoids the reward function design problem in RL [162, 163]. This allows us to
eﬃciently extend DP to the many particle Hamiltonian required for the Majorana transport.

On the other hand, NES exhibits multiple advantageous features. First, as a gradient-free black box optimization
method, NES is the most ﬂexible among the methods implemented in our work since it can be applied to controls
that are discrete and continuous. Second, it can optimize non-diﬀerentiable control problems, as well as problems
where the gradient estimation is numerically unstable in a way that makes the application of DP challenging. NES is
also easily parallelizable across multiple processors for a fast collection of suﬃcient samples for optimization. Lastly,
compared to RL, we mention that NES can be directly applied to any desired objective function. This avoids the
problem of the design of reward function commonly encountered in RL algorithms, which is necessary to avoid sparse
learning signals that may hamper the eﬃciency of RL methods in quantum control.

We also brieﬂy mention that RL techniques such as the Watkins Q-learning algorithm [70] and policy gradient,
tabular Q-learning, and deep Q-learning have recently been shown to be capable of achieving high performance in
other quantum control setups [66]. Ref.[66] provides a detailed comparison between tabular Q-learning, deep Q-
learning, and policy gradient [70], and gradient descent and Krotov algorithms applied to the problem of preparing
a target quantum state. Gleaned from their numerical experiments, the authors in Ref. [66] conclude that the deep
Q-learning and policy gradient algorithms tend to outperform other RL and traditional control algorithms when the
problem allows for discrete values of the control parameters, and when the problem is scaled up to large system sizes.
Finally, we comment on well-established adiabatic shortcut methods [12], in particular counter diabatic driving
(CDD) and Lewis-Riesenfeld invariants (LRI), in the context of the Majorana game problem. We note that an
attempt to implement these in our setup encounters an array of problems. In CDD for example, the control protocols
required a level of Hamiltonian control far beyond what would be experimentally feasible, where a full time-dependent
and spatial control of a the problem Hamiltonian is required. Lastly, LRI requires ﬁnding a suitable invariant, which
to the best our knowledge, is not known for the Majorana wire.

Appendix F: Semiconducting nanowire spin-orbit coupled to s-wave superconductor

The Kiteav chain model for topological p-wave superconductivity [25] used for the simulations in the main text can
be realized eﬀectively in a semiconducting nanowire proximity coupled to a conventional s-wave superconductor in a
Zeeman ﬁeld [15–17]. In this appendix we will ﬁrst introduce the proximity coupled model and discuss in which limits
the Kitaev chain toy model can be obtained. Then we show how the critical velocity vcrit and resonance frequency
can be obtained such that we can deﬁne the same Majorana motion regimes as in the main text. Finally we show
numerical optimization results obtained with AD and NES in each of those regimes for two diﬀerent sets of parameters
of the proximity coupled model (with one set outside the Kitaev chain limit).

1. Hamiltonian and Energy dispersion

25

The Hamiltonian for the proximity coupled semiconducting nanowire (NW) for periodic boundary conditions, a
homogeneous potential V (x) = V and chemical potential µ(x) = µ in the continuum momentum representation is
given by

with Ψ†

k = [c†

k↑c†

k↓c−k↑c−k↓] and

HNW =

(cid:90)

1
2

dkΨ†

kH BdG(k)Ψk

H BdG(k) = (

k2
2m

+ V − µ + Bσx + αkσy)τz + ∆σyτx

(F1)

(F2)

In here we have an external
in which σi acts on the spin-degrees of freedom and τi on the particle-hole space.
magnetic ﬁeld B in the x-direction, spin-orbit coupling with strength α in the y-direction and a standard s-wave
superconducting term with gap ∆. Note the main diﬀerence with the Kiteav chain in Eq. A1 is the spin-degrees of
freedom s = {↑↓} which result in Zeeman splitting, spin-orbit interaction and s-wave superconductivity instead of
spin-less p-wave superconductivity.

The energy dispersion can be found by solving the characteristic equation for H BdG Eq. F2 which leads to

±(k) = ξ2 + B2 + α2k2 + |∆|2 ± 2
(cid:15)2

(cid:113)

B2|∆|2 + ξ2B2 + α2k2ξ2

(F3)

in which we have deﬁned ξ(k) = k2
2m + V − µ. In this four-band model various parameter choices lead to a gapped
dispersion with in some phases Majorana zero modes, see for a complete discussion e.g. [17]. Moreover, in two speciﬁc
limits (large Zeeman ﬁeld B (cid:29) α, ∆ or for large spin-orbit coupling α (cid:29) B, ∆) this proximity coupled NW model can
be projected onto the lower bands (reduces to two similar blocks) resulting in the Kitaev chain model with p-wave
superconducting gap ∆(cid:48) = α∆

mα (large α) respectively [73, 151].

B (large B) or ∆(cid:48) = ∆

2. Critical Velocity and Resonance Frequency

To bring the NW in Eq. F2 into the moving frame we apply the same techniques as for the Kitaev chain dis-
to rotate the

cussed earlier in App. A, i.e. we apply the time-dependent translation operator U (t) = e−ik (cid:82) t
Hamiltonian Eq. F2, which results in the moving frame Hamiltonian

0 v(t(cid:48))dt(cid:48)

H BdG
v

(k) =

(cid:18) k2
2m

+ V − µ + Bσx + αkσy

τz + ∆σyτx + vk14.

(F4)

(cid:19)

Like for the Kitaev chain this transformation gives an additional contribution vk to the energy dispersion that tilts
it as shown in ﬁgure A4. In the regimes when the system is originally gapped the gap closes due to this tilt when
v ≡ vcrit = Egap
. For most parameters ﬁnding the general expression for the energy gap and critical velocity is too
kF
complicated and we need to obtain it numerically. However things simplify in the Kitaev chain limit for B (cid:29) α, ∆
which gives vcrit ≈ α∆

B and when α (cid:29) B, ∆ we obtain vcrit ≈ ∆

The resonance frequency in this model is like for the Kitaev chain deﬁned as the being equal to the gap ωres = Egap.
With these associations for the critical velocity and resonance frequency the deﬁnition of the Majorana motion regimes
originally in terms of parameters of the Kitaev chain can be extended to include the proximity coupled model as well;
regime I is deﬁned to be for vavg > vcrit, regime II close but below the critical velocity, regime III low velocity and
short time-scales with respect to the energy gap and ﬁnally the (super)-adiabatic regime IV for long times and low
velocities with respect to the gap.

mα [73].

By putting the NW model Eq. F2 on a lattice, opening up the boundary condition and imposing the smooth
potential proﬁle in Eq. 2 we acquire the same control of the position of the Majorana zero mode as for the Kitaev

3. Optimization results

26

FIG. A4. a) Energy dispersion of the Hamiltonian Eq. F4 in the moving frame for three diﬀerent velocities. The velocity tilts
the dispersion and the gap closes when v = vcrit. The model parameters used for this dispersion are B = α = 1.0, ∆ = 0.5
and µ = −0.55, V = 0.0. b) Excitation energy eigenvalues En of the NW model on a lattice for open boundary conditions as a
function of the chemical potential µ. The red dashed line indicates µ = −0.55. The other parameters are the same as for panel
a). We get a zero mode (blue line) but also some Andreev bound states (e.g. orange line) that come down when we bring µ
closer to the bottom of the band.

chain in the main text. In Fig. A4 b) we show an example of the excitation energies for a set of parameters outside
the Kitaev chain limit in which we have a Majorana zero mode and also Andreev bound states.

We then optimize the transport of the Majoranas in this NW model with the same AD and NES techniques as
used before. We show the results for these simulations for the same parameters as in Fig. A4 from Diﬀerentiable
Programming and Natural Evolutionary Strategies in Fig. A5 (i-p) and from JMJ protocols in Fig. A5 (q-s). For
completeness in Fig. A5 (a-h) we include results obtained by choosing parameters that approximate the Kitaev chain
limit (high B−ﬁeld).

It can be seen that for these two sets of parameters we obtained qualitatively similar strategies for Majorana
transport in the proximity-coupled NW as for the simpler Kitaev chain model as shown in Fig. 2 in the main text.
That is, in regions I-II-III we get the JMJ strategy with a pulse-like motion at the beginning and end of the protocol
and an on average constant motion with a velocity vcrit in the middle of the protocol. For the parameters outside
the Kitaev limit, the initial and ﬁnal dressed jumps are comprised of three parts: a forward jump, a backward jump
and another forward jump. For these parameters we observe a much smoother protocol in regime II compared to the
Kitaev chain. In regime IV for both sets of parameters we again recover the expected smooth adiabatic protocols.

To show that the JMJ-strategy (together with its analysis discussed in the main text) is also a robust strategy for
the proximity coupled NW model we scanned again over the diﬀerent parameters ∆xforward and ∆xback outside the
Kitaev limit. The optimal JMJ protocols obtained in this way together with the inﬁdelity values are shown in Fig. A5
(q-s). It can be seen that the inﬁdelity values for the dressed JMJ protocol are competitive to the protocols obtained
with DP and NES. Compared to the Kitaev chain results (panel (d) in Fig. 1) it can be seen that for this proximity
coupled NW model the dressing of the jumps is slightly less pronounced.

Appendix G: Parameters and interpolation of the optimized JMJ model strategy

In this appendix we give the parameters of the optimized JMJ strategies in regimes I,II, and III as shown in Fig. 1 d)
in the main text and verify how close these strategies are to the protocols obtained with the ML methods. In the
main text we observed that dressed JMJ protocols with the lowest inﬁdelities have a linear relation between ∆xforward
and ∆xbackward as Fig. 3 shows. To attain the best JMJ protocols in regime I-III, we scan through ∆xforward and
∆xback with respect to the linear relation in each regime and pick the one which gives the overall lowest inﬁdelity.
The parameters of the resulting JMJ strategies are provided in Table A3 and the strategies are shown in Fig. 1.

We linearly interpolate these best JMJ model strategies to the machine learning protocols in the main paper (Fig.
2) to see whether there are additional protocols that are better in terms of inﬁdelity. The results for this in regime
III with the DP strategy are shown in Fig. A6 from which we can see that the DP strategy is slightly better than the

a)b)27

FIG. A5. Overview of the optimal controls in the four diﬀerent Majorana motion regimes (I-IV) obtained after optimization
with Diﬀerentiable Programming (DP), Natural Evolutionary Strategies (NES) and the parameterized JMJ protocols for the
proximity coupled NW model as given by Eq. F2. In all panels we plot the domain wall position xL(t) as a function of time
starting from xL(0) = xA = 5.0. The red dotted line in regime I has a slope equal to the critical velocity vcrit ≈ 0.27 for panels
a/e and vcrit ≈ 0.28 for panels i/m. The obtained strategies are similar to the strategies obtained for the Kitaev chain in the
main text with pulse-like motion at the beginning and end in regimes I-II-III bookening smoother motion in the middle and
in regime IV a smooth adiabatic protocol. In the simulations for panels a-h we set N = 100, µ = 0.0, w = 1, ∆ = 0.8, B = 2,
α = 0.8, Vheight = 30.1, and σ = 1 and for panels i-s we set N = 100, µ = −0.55, w = 1, ∆ = 0.5, B = 1, α = 1.0, Vheight = 30.1,
and σ = 1. The constraint parameters (l, T ) are given by {(4.32, 12), (4.95, 22), (0.48, 8), (2.4, 40)} for regimes I,II,III, and IV,
respectively.

JMJ (due to more free parameters) and that there are no other local minima in between them. For the other regimes

Regime IIIRegime IIRegime IVRegime IJMJq)r)s)DPNESi)j)l)m)o)k)n)p)DPa)b)d)c)NESg)f)h)e)9e-6Regime ∆xforward ∆xback ∆tback Inﬁdelity
7.5060
1.5496
0.4571

7.992
1.9093
0.5482

0.3575
0.1589
0.0057

0.05
0.31
0.33

I
II
III

28

TABLE A3. Best dressed JMJ model strategies parameters and their corresponding inﬁdelities obtained from scans over
∆xforward, ∆xback and ∆tback. The corresponding proﬁles are shown in Fig. 1 in the main paper.

and interpolations from the NES strategy we obtained similar results.

FIG. A6. a) The DP optimized majorana motion strategy in regime III (T = 8, l = 0.48) on top of the optimized (scans over the
free parameters) JMJ model strategy. The optimal JMJ model strategy captures the main features (jumps) of the DP strategy
well. b) Inﬁdelity I(T ) obtained for 100 linearly interpolated proﬁles between the DP strategy and JMJ model strategy as
shown in panel a). We observe a convex decreasing function towards the more ﬂexible DP result.

Appendix H: Extra Results on Robustness of the JMJ strategy with respect to Interactions and Disorder

In Fig. A7 we show simulation results when running the optimal protocols obtained in the clean system in a system
with disorder and separately interactions. In summary we see that in regimes I, II and III the ML protocols in the
clean non-interacting system outperform a naive linear benchmark protocol. On the other hand, in regime IV after
large enough interaction strengths or disorder strengths the linear protocols outperform the super-adiabatic protocols
found before in the literature. Moreover, the inﬁdelity values get worse by more than an order of magnitude in
this regime which emphasises the importance of looking for alternative strategies that can be more eﬃcient than the
smooth super-adiabatic protocols.

The observation that the inﬁdelity values generally get worse with increasing interaction strength can be explained,
at least partially, due to a lowering of eﬀective critical velocity. This comes about in two main ways. Firstly on a
mean-ﬁeld level we know that including repulsive onsite interactions results in a lower topological energy gap Egap
(see e.g [134]). This would result in, as shown in [164], the resonance frequency ωres becoming lower which means
that the resonance time-scale, and consequently regime IV, get pushed to longer timescales T .

Another feature that may be at play here is the fact that interactions, on a mean-ﬁeld level, typically induce
non-uniformity in the eﬀective couplings (found for example by running some suitable Hartree-Fock-Bogoliubov min-
imisation [156]). The result in this case would be similar to the scenario encountered in the disordered situations
where moving the wall over changing landscape amounts to a time dependent perturbation (see e.g. [92]). For future
studies it would be interesting to investigate if one can use NES or DP to improve these values further by optimizing
in the presence of disorder or interactions.

a)b)DPJMJ29

FIG. A7. Overview of simulation results of running the optimal protocols obtained in the clean non-interacting system in a
system with interactions (top row) or disorder (bottom row) in all four regimes. In all regimes the inﬁdelity increases with
disorder strength λ and also with interaction strength u. The parameters for these simulations were the same as in Fig. 2 in
the main text and the disorder averaging was done over 500 disorder realizations.

Appendix I: Jump inﬁdelity costs with system parameters

In this appendix we examine the inﬁdelity cost of a single jump as a function of the important physical lengths
scales λF = 2π/kF and ξ = 1/(m∆). Our numerical test suggest a near Gaussian drop oﬀ in the inﬁdelity as a
function of jump distance: Oδ ∼ exp(cid:0)−δ2/s2(cid:1). Generally speaking, the larger the value of s, the larger one can jump.
In ﬁgure A8 we plot the value of s that we obtain from a numerical ﬁtting the Oδ drop-oﬀ. We see that the value of
the superconducting parameter ∆ (and hence ξ) do play a role: the value of s tends to go down, but not dramatically
so, as ∆ gets smaller (and ξ gets larger). Perhaps more importantly we see the that s parameter is linearly related to
λF . This means the jump size can in principle get bigger if one tunes the chemical potential towards the bottom of
the single particle valence band.

e)f)g)h)Regime IIIRegime IIRegime IVRegime Ia)b)c)d)30

FIG. A8. In the p-wave model the Oδ ∼ exp(cid:0)−δ2/s2(cid:1) have an interesting relationship to the two key length scales. The ﬁt
parameter s is reduced by a factor of about 1/2 when the coherence length ξ = 1/(m∆) is made very large. On the other hand
its value tends to increase linearly in proportion to λF = 2π/kF . The topological gap Egap ∼ ∆kF = 2π/(mξλF ) is however
inversely proportional to both length scales.

