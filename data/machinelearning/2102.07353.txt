Publications of the Astronomical Society of Australia (PASA)
doi: 10.1017/pas.2021.xxx.

SkyMapper Optical Follow-up of Gravitational Wave Triggers:
Alert Science Data Pipeline and LIGO/Virgo O3 Run

1
2
0
2

r
p
A
1

]

M

I
.
h
p
-
o
r
t
s
a
[

2
v
3
5
3
7
0
.
2
0
1
2
:
v
i
X
r
a

Seo-Won Chang1,2,3,4,5*, Christopher A. Onken1,3, Christian Wolf1,2,3, Lance Luvaul1, Anais Möller1,6,
Richard Scalzo1,7, Brian P. Schmidt1, Susan M. Scott2,3,8, Nikunj Sura1, and Fang Yuan1
1Research School of Astronomy and Astrophysics, The Australian National University, Canberra, ACT 2611, Australia
2ARC Centre of Excellence for Gravitational Wave Discovery (OzGrav), Australia
3Centre for Gravitational Astrophysics, The Australian National University, ACT 2601, Australia
4SNU Astronomy Research Center, Seoul National University, 1 Gwanak-rho, Gwanak-gu, Seoul 08826, Korea
5Astronomy program, Dept. of Physics & Astronomy, Seoul National University, 1 Gwanak-rho, Gwanak-gu, Seoul 08826, Korea
6Université Clermont Auvergne, CNRS/IN2P3, LPC, F-63000 Clermont-Ferrand, France
7Centre for Translational Data Science, University of Sydney, Darlington, NSW 2008, Australia
8Research School of Physics, The Australian National University, Canberra, ACT 2601, Australia

Abstract
We present an overview of the SkyMapper optical follow-up program for gravitational-wave event triggers from the
LIGO/Virgo observatories, which aims at identifying early GW170817-like kilonovae out to ∼ 200 Mpc distance.
We describe our robotic facility for rapid transient follow-up, which can target most of the sky at δ < +10 deg to
a depth of iAB ≈ 20 mag. We have implemented a new software pipeline to receive LIGO/Virgo alerts, schedule
observations and examine the incoming real-time data stream for transient candidates. We adopt a real-bogus classiﬁer
using ensemble-based machine learning techniques, attaining high completeness (∼98%) and purity (∼91%) over
our whole magnitude range. Applying further ﬁltering to remove common image artefacts and known sources of
transients, such as asteroids and variable stars, reduces the number of candidates by a factor of more than 10. We
demonstrate the system performance with data obtained for GW190425, a binary neutron star merger detected during
the LIGO/Virgo O3 observing campaign. In time for the LIGO/Virgo O4 run, we will have deeper reference images
allowing transient detection to iAB ≈21 mag.

Keywords: methods: data analysis – methods: statistical – transient detection – gravitational waves – neutron stars

1 INTRODUCTION

The observable signature of merging binary neutron stars
(BNS) was revealed for the ﬁrst time by the event GW170817,
which started with a gravitational-wave (GW) chirp signal
detected by the Advanced LIGO/Virgo detectors and was then
followed by electromagnetic (EM) observations over a broad
range of wavelengths from γ-rays to radio (Abbott et al.,
2017a,b). One of the most promising outcomes is luminous
EM emission in the optical and near-infrared bands after
the ﬁnal coalescence of the stars (e.g., Andreoni et al. 2017;
Arcavi et al. 2017; Coulter et al. 2017; Cowperthwaite et al.
2017; Drout et al. 2017; Kilpatrick et al. 2017; Kasliwal
et al. 2017; Smartt et al. 2017). This fast-evolving transient,
referred to as a kilonova, was predicted to be powered by
the radioactive decay of heavy elements via rapid neutron
capture processes (Li & Paczy´nski, 1998; Metzger et al.,
2010; Barnes & Kasen, 2013; Tanaka & Hotokezaka, 2013;
Fernández & Metzger, 2016). We now know that rapid EM

*E-mail: seowon.chang@anu.edu.au or seowon.chang@snu.ac.kr

follow-up (on the timescale of hours) provides a wealth of
information on the nature of the progenitor (Abbott et al.,
2017c; Kruckow et al., 2018), its environment (Levan et al.,
2017; Adhikari et al., 2020) and explosion mechanism (Troja
et al., 2017; Mooley et al., 2018). In particular, the spectral
evolution of such events is key to understanding the merger
process and the origin of rare heavy elements (Kasen et al.,
2017; Kasliwal et al., 2019; Wu et al., 2019). Furthermore,
the identiﬁcation of an EM counterpart is needed to pinpoint
the host galaxy, thus determining the redshift (Coulter et al.,
2017; Hjorth et al., 2017).

Photometric and spectroscopic data of kilonovae provide
a novel probe into the physics and nature of the BNS them-
selves (e.g., NS radius or mass ratio) and into the process
and end-product of mergers. Although GW170817 remains
the only kilonova that was both spectroscopically conﬁrmed
and associated with a GW signal, it allows us to better un-
derstand how different ejecta components (with different
lanthanide fractions) contribute its EM emission from early
to late times after the merger. However, little is known about

1

 
 
 
 
 
 
2

S.-W. Chang et al.

the earliest stages of the kilonova, because the EM coverage
of GW170817 started more than 10 hours after the event.
Hence, we have no constraints yet on possible emission from
the outermost layers of the ejecta that may have faded after
a few hours. For example, Metzger et al. (2015) proposed a
candidate precursor of kilonova emission, caused by β-decay
of free neutrons in the outermost ejecta, which can increase
the luminosity of the EM source by over an order of magni-
tude during the ﬁrst hour after the merger. Metzger (2019)
mentions r-process heating or radioactive decay of free neu-
trons. And further mechanisms such as jet/wind re-heating
could play a similar role in producing enhanced luminosity
at early times (e.g., Metzger et al. 2018). Only high-cadence
observations in the ﬁrst few hours after the merger can test
these predictions in detail and reveal the source of the blue
emission (Arcavi, 2018).

The SkyMapper optical wide-ﬁeld telescope in Australia
(see Section 2.1) is one of the facilities that can discover early
GW170817-like kilonovae and is probably the pivotal optical
facility for events that occur in the Southern sky between the
end of the Chilean night and late in the Australian night. The
size of the GW localisation area (a few hundred deg2, see
Abbott et al., 2020b) is usually much larger than the ﬁeld of
view (FoV) of our camera (5.7 deg2). While the GW triggers
in the third LIGO/Virgo observing run (O3) had a median
localisation area of 4480 deg2 (Kasliwal et al., 2020), the area
shrinks quickly for events with stronger signals. A synoptic
tiling strategy covering the high-probability sky area for the
counterpart will usually best exploit our wide FoV, and our
tiles follow the basic tiling scheme of the general-purpose
SkyMapper Southern Survey (Onken et al., 2019, see Sec-
tion 2.1). In contrast, an alternative galaxy-targeted approach
makes more sense for telescopes with smaller FoV and for
nearby events such as GW170817, where it has proven to be
effective. However, for events at distance larger than 50 Mpc,
which are expected to be by far the most common, our FoV
contains usually several possible host galaxies and empty tiles
will be rare. Crucially, we can detect transient candidates in
real-time as we have reference images for subtraction over
the full hemisphere (at least in some passbands, see Section
2.3.2), which are deep enough to detect GW170817-like kilo-
novae at distances up to 200 Mpc as well as the rising part of
kilonova light curves in more nearby cases.

In the O3 run, 56 gravitational-wave events from compact
binary systems were detected, which is ﬁve times more than
reported during the ﬁrst two observing runs. Only two of
them had signiﬁcant (> 85%) initial probability of being
BNS events: S190425z (LIGO Scientiﬁc Collaboration &
VIRGO Collaboration, 2019) and S190901ap (LIGO Scien-
tiﬁc Collaboration & Virgo Collaboration, 2019). However,
after re-analysis with additional background statistics the lat-
ter is no longer considered a signiﬁcant candidate (Abbott
et al., 2020a). S190425z, a.k.a. GW190425 and known in
Australia as the ANZAC Day event, was also conﬁrmed as
the second case of gravitational waves from a binary neu-
tron star inspiral (Abbott et al., 2020c). The system is note-

worthy for a total mass of 3.4M(cid:12), which exceeds that of
known Galactic BNS and may suggest that not all binary
neutron stars are formed in the same way (Romero-Shaw
et al. 2020; Safarzadeh et al. 2020). No EM counterpart was
found by SkyMapper or any other facility, because (i) the sky
localisation of this event was poorly constrained with a 90%
conﬁdence area of 8 284 deg2, (ii) it is expected to be much
fainter than GW170817 in the optical due to its distance, and
(iii) it may be intrinsically faint due to a low ejecta mass
or unfavourable viewing angle. In preparation for the next
LIGO/Virgo observing run (O4), we describe here our facility
and its performance with the current processing pipeline.

For an autonomous selection of transient candidates, it is
key to maximise the recovery rate and minimise the false-
positive rate; in order to reduce the volume of human interven-
tion required to identify the likely source of interest, on which
detailed follow-up observations may be triggered. This pro-
cess faces two challenges: (1) Image artefacts appear in the
subtraction process and pose as transient candidates; this is of-
ten addressed with machine learning approaches that separate
astrophysical sources from spurious detections in a difference
image (e.g., Bailey et al. 2007; Bloom et al. 2012; Brink et al.
2013; Wright et al. 2015; Goldstein et al. 2015; Duev et al.
2019). (2) Astrophysical foreground and background tran-
sients produce a fog of events that are not related to the GW
event, and these are usually too numerous for simultaneous
follow up. In this work, we use an ensemble-based transient
classiﬁer to reject spurious sources and refer to catalogues of
known sources to label other types of variables.

In this paper, we present an overview of the SkyMapper
follow-up program of GW triggers. In Section 2, we describe
our optical facility and the AlertSDP pipeline in detail, from
observing strategy to real-time data processing and transient
identiﬁcation. In Section 3, we introduce an ensemble-based
machine learning approach for real-bogus classiﬁcation. We
also present metrics for evaluating the performance of the
classiﬁer. In Section 4, we present a real case and discuss the
resulting transient statistics. In Section 5, we close with an
outlook to future work and the LIGO/Virgo O4 run. Through-
out the paper we use the AB magnitude system.

2 EM COUNTERPART SEARCHES WITH THE

SKYMAPPER FACILITY

2.1 SkyMapper Telescope

SkyMapper is a 1.35m modiﬁed-Cassegrain telescope located
at Siding Spring Observatory (SSO) in New South Wales,
Australia (Wolf et al., 2018). The telescope has a wide ﬁeld-
of-view of 2.34 × 2.37 deg2, a uvgriz ﬁlter set (Bessell et al.,
2011) and a mosaic of 32 2k×4k CCD detectors with a pixel
scale of 0.5 arcsec/pixel. It is owned and operated by the
Australian National University (ANU) and, most importantly
for EM follow-up, it is a robotic facility.

The main purpose of the telescope is the SkyMapper
Southern Survey (SMSS), a hemispheric sky atlas which

SkyMapper AlertSDP: Alert Science Data Pipeline

3

Figure 1. Top left: LIGO/Virgo probability sky map for S190814bv produced with the ligo.skymap module (Singer et al., 2016). The inset shows the most
probable area for the optical counterpart. Darker colours correspond to higher-probability sky regions, and contours enclosing regions with 50%, 90%, and 99%
of the probability are indicated. Bottom left: probability map convolved with the coverage of reference images in SkyMapper DR2. Bottom right: zoomed-in
map of the 20 highest-probability ﬁelds selected for the search; here, one ﬁeld alone has ∼ 39% probability of containing the GW source. Symbols are bright
galaxies from the 2MASS redshift survey. Top right: Observability plot for the top 20 ﬁelds with telescope altitude, night-time range and Moon separation.

has been underway since 2014 (DR1: Wolf et al. 2018; DR2:
Onken et al. 2019). For point sources with SNR>5, the ex-
pected photometric depth of single-epoch 100-sec images is
u=19.5, v=19.5, g=21, r=20.5, i=20, and z=19 mag. Along-
side, SkyMapper has been used to search for extragalactic
transients, including low-redshift Type Ia supernovae (Scalzo
et al., 2017; Möller et al., 2019) as well as optical counterparts
to GW events (GW170817: Abbott et al. 2017b; Andreoni
et al. 2017) and fast radio bursts (e.g., Petroff et al. 2015;
Farah et al. 2018, 2019; Price et al. 2019; Chang et al. 2019a).
Different needs made the SMSS and the transient searches
develop separate data reduction software: the Science Data
Pipeline (SDP: Luvaul et al. 2017; Wolf et al. 2018) for the
SMSS and the Subtraction Pipeline (SUBPIPE; Scalzo et al.
2017) for the Transient Survey. SUBPIPE was used for EM
data analysis before LIGO/Virgo ER14 (Engineering Run
14), but for the O3 run we updated it to an automated real-
time pipeline (AlertSDP: Alert Science Data Pipeline) that
borrows many features from the SDP (see Section 2.2 and
2.3 for details).

2.2 Alert Response

We continuously listen to the live stream of LIGO/Virgo pub-
lic alerts for compact binary merger candidates1. The stream
is distributed through the Gamma-ray Coordinates Network
(GCN) using the pygcn P Y T H O N module2. We developed a
robotic alert handler that extracts relevant information, ingests
the GW event into our database, downloads the HEALPix
3D localisation map (skymap), prioritises areas for follow-up,
and generates a list of observations for SkyMapper.

A ﬁrst preliminary GCN notice is automatically issued for
a superevent within 1–10 minutes after the GW trigger. From
this notice, our robotic handler initiates rapid-response search
observations by convolving the probability in the BAYESTAR
skymap (Singer & Price, 2016) with the tile pattern of the
SkyMapper Southern Survey (Onken et al., 2019), ranking
the ﬁelds by probability integrated per-ﬁeld and then selecting
the top 20 ﬁelds with existing i-band reference images (∼100
deg2 total area). Figure 1 shows the sky maps for a real alert
and an observability map of the selected target ﬁelds.

In this search stage, we obtain two 100 s exposures in i-
band for each ﬁeld, separated by ∼ 8 minutes. Requiring a

1https://emfollow.docs.ligo.org/userguide/
2https://github.com/lpsinger/pygcn

4

S.-W. Chang et al.

Figure 2. The i-band light curve for the GW170817 kilonova, at different
distances: at the true distance of 40 Mpc (top), shifted to 100 Mpc (middle)
and 200 Mpc (bottom); solid lines are power-law decay ﬁts. The dashed line
at iAB = 20 marks our typical 5-σ magnitude limit in 100 sec exposures
(data were taken from various literature sources; AST3-2: Hu et al. 2017;
B&C: Utsumi et al. 2017; DECam: Cowperthwaite et al. 2017; Gemini:
Kasliwal et al. 2017; LaSilla: Smartt et al. 2017; LCO: Arcavi et al. 2017;
Magellan: Shappee et al. 2017; Pan-STARRS: Smartt et al. 2017; REM:
Pian et al. 2017; SkyMapper: Andreoni et al. 2017; Swope: Drout et al.
2017;T80S: Díaz et al. 2017; VLT: Tanvir et al. 2017; VST: Pian et al. 2017).

twin detection in the two images eliminates moving objects
from the candidate list. The typical rate of motion for main-
belt asteroids, 0.625 arcsec/min near opposition (Jedicke,
1996), provides a sufﬁcient ∼ 5 arcsec spacing between ob-
servations. With a depth of i ≈ 20 mag, we can identify
kilonovae that are ∼ 3 mag (16×) fainter than the kilonova
of GW170817 was ten hours after the GW trigger. Hence,
we could detect kilonovae for GW170817-like events out to
4× the distance of GW170817, or 160 Mpc. Figure 2 shows
the lightcurve of the GW170817 kilonova shifted to different
distances up to 200 Mpc. The declining nature of the i-band
light curve suggests that kilonovae may be more luminous
during the ﬁrst ten hours. We thus assume that we might be
able to detect early kilonova emission, just hours after a BNS
merger, out to distances of 200 Mpc or beyond.

We search in i-band for three reasons: (i) kilonovae are
expected to be red due to the large opacity of neutron-rich
ejecta, although at early times (within an hour of the merger)
blue emission from hotter, polar ejecta may be expected (e.g.,
Troja et al. 2018), (ii) the i-band covers the largest sky area
with deep reference images in the SMSS that can be used
for real-time image subtraction, and therefore provides the
greatest search volume for kilonovae, and (iii) the dominant
source of transient events, ﬂares on M stars too faint to be
seen in quiescence, is nearly irrelevant in i-band (Chang et al.,
2020). The aim of the search phase is to ﬁnd a counterpart as
fast as possible, report it to facilities around the world and

Figure 3. SkyMapper i band coverage in DR2 (top) and DR3 (bottom).
Darker colours resemble deeper reference images used for subtraction.

get SkyMapper itself into monitoring mode. We expect that
the search phase provides a full set of possible counterparts
within four hours (limited by image processing) after the GW
trigger, if the trigger occurs during darkness and the sky is
clear. Later, possibly within 4 hours for BNS or NSBH events,
an updated LALInference skymap (Veitch et al., 2015) will be
distributed, including an updated sky localisation and source
classiﬁcation. This sometimes leads to a signiﬁcant change in
the sky localisation, and the SkyMapper observing plan may
be modiﬁed and re-executed as a result.

At any time, once a position of a likely kilonova transient
is identiﬁed, we can manually switch from the search phase
to a continuous high-cadence monitoring of the new source.
Observations of an early kilonova with a cadence of 2 min
would reveal structure in the lightcurve arising from shocks
induced by the kilonova ejecta (e.g., Metzger 2019). We will
also get high-cadence, multi-band light curves for several con-
secutive nights after any kilonova discovery. The monitoring
strategy will change depending on the colour, luminosity, and
fading time-scale of the kilonova candidates. If the optical
counterpart gets identiﬁed by other groups before SkyMapper
can observe, we will do only light-curve monitoring, as was
the case for GW170817 (Andreoni et al., 2017).

2.3 AlertSDP: Alert Science Data Pipeline

The AlertSDP is a new pipeline created from two existing
software packages, which are the SkyMapper Science Data
Pipeline, SDP, and SUBPIPE, which was used for discover-
ing low-redshift supernovae (see Section 2.1). The SDP has
provided the general process control framework as well as
improved calibration and masking treatment, while the sub-
traction and transient classiﬁcation have evolved from SUB-
PIPE components. First, each raw image is pre-processed
and calibrated. After that, i-band reference images for image
subtraction are selected, and transient candidates detected on
difference images are uploaded into a database. The database
also includes external catalogues to assist transient classiﬁca-
tion.

SkyMapper AlertSDP: Alert Science Data Pipeline

5

2.3.1 Ingest and calibration of new images
Raw SkyMapper images from Siding Spring Observatory are
transferred in real time via Ethernet to a 64-core server at
Mount Stromlo Observatory. Data transfer takes 5–7 seconds
per frame and can be done while the next exposure is al-
ready being taken. To activate the AlertSDP, the Linux inotify
mechanism detects the arrival of an image from the telescope
immediately and initiates the data processing.

The raw data are processed into scientiﬁc data products
using typical SDP procedures, including bias correction, ﬂat-
ﬁelding, defringing, bad-pixel masking, and generation of an
astrometric solution (see Wolf et al. 2018 and Onken et al.
2019 for details). A signiﬁcant structural change from the
SDP to the AlertSDP is a different parallelisation paradigm
designed to minimise the time between image acquisition and
production of transient candidates: while the SDP processes
images in parallel with all the component CCDs treated seri-
ally, the AlertSDP processes the 32 CCDs of each image in
parallel and up to 4 images concurrently.

2.3.2 Selection of reference images
Reference images are required for image subtraction and real-
time transient searching. We take advantage of the nearly all-
Southern-sky coverage (>98 %) of the deeper Main Survey
exposures from the SMSS in i-band (λcentre/∆λ = 779/140
nm). Figure 3 shows the area of sky covered by SkyMapper
DR2 (Onken et al., 2019) and by DR3, which was released to
the Australian community in February 2020 in the late stages
of the O3 run. DR3 expands the deep coverage by including
survey observations from March 2014 to October 20193.

From any new image, we subtract each available reference
image. The best possible reference image combines a small
PSF and a large overlap with the new image. The reference
images come with a range of point-spread functions (PSF),
and because the SMSS obtains repeat images with dithering
to cover the sky homogeneously, the best-available reference
PSF changes discontinuously with sky location. Small over-
laps lead to badly determined convolution kernels and thus
bad subtractions. Hence, we require at least 15% overlap area
for mosaic frames and at least 5% overlap for each individual
CCD. Following a common strategy of other transient sur-
veys, we require that the reference image should be taken at
least two weeks prior to a given new epoch.

2.3.3 Subtraction of images
We perform image subtraction on each ﬁeld of overlapping
new/reference image pairs. First, we resample each of the
reference mosaic frames onto the new image with S WA R P
(Bertin et al., 2002). Next, we convolve those pairs of im-
ages to a common PSF using H O T PA N T S (Becker, 2015),
which implemented the popular image subtraction algorithm
by Alard & Lupton (1998). Solving for the convolution kernel
is a crucial step to equalising the PSFs of the reference and
new images. The position-dependent PSF variation in both

3http://skymapper.anu.edu.au/data-release/dr3/

images is modelled as a linear combination of basis functions,
and by default we choose a 2D polynomial of order two.
Next, the ﬂux level of the subtracted image is normalised to
that of the reference image. Since the photometric calibration
is directly tied to the SMSS photometry, this approach has
the advantage of allowing explicit calculation of zero-point
corrected magnitudes. The preliminary calibrated magnitude
and error used for lightcurve construction is:

msub = −2.5 log fsub + ZPref ,

q

δmsub =

(1.0857 × δfsub/fsub)2 + δZPref

2,

where fsub is the difference ﬂux on the subtracted image
and ZPref is the zeropoint of the reference image. Here,
we use the 15 arcsec (30-pixel-diameter) aperture as a total-
magnitude reference. The zeropoint error δZPref contributes
little, since only images with robust zeropoints are included
in SMSS data releases.

Finally, we run SExtractor (Bertin & Arnouts, 1996) on
the subtracted images to produce a list of transient candidates
and their associated metadata, using a low detection threshold
of 1.5σ above the background. Gaussian ﬁlters in SExtractor
are applied to an image prior to the detection of sources. Only
sources with a signal-to-noise ratio below 2 are referred to as
sub-threshold detections.

2.4 Transient classiﬁcation

Until the end of O3, we classiﬁed transient candidates with
a random forest (RF) classiﬁer trained on earlier supernova
survey data (Scalzo et al., 2017). We computed a set of fea-
tures derived from difference images of individual candidates,
similar to those proposed in Bloom et al. (2012). The main
difference was that three additional checks were made on
each candidate: (i) we removed any detections where the
measurement of shape parameters (e.g., FWHM, elongation)
was signiﬁcantly larger than the median quantities for sources
found in the new science images, and (ii) we matched each of
them to the nearest object (<30 arcsec) seen on the reference
frame, which will be associated with host galaxies or bright
stars that might be poorly subtracted. Then, the RF model
assigned a real-bogus score (RBscore) from 0 (artefacts =
bogus) to 100 (transients = real) to all the detected candidates.
In this work, we added a new classiﬁer (XGBoost) and
new training sets to exploit our improved image processing.
A combination of classiﬁers is often more accurate than a
single classiﬁer, and thus we introduce a new metric (Tscore)
that combines RBscore and XGBoost score to compensate
for the weakness of each classiﬁer (see Section 3 for the full
description and performance).

For each transient candidate, we identify whether it may be
a known variable or Milky Way source by cross-matching it
against catalogues of stars, variable objects and quasars, using
a 3 arcsec search radius. We also reject known solar system
objects with the SkyBoT cone-search service (Berthier et al.,
2006). Our pre-selected categories are as follows:

6

S.-W. Chang et al.

• We deﬁne a "Star" sample using parallaxes and proper
motions (PPM) from Gaia eDR3 (Gaia Collaboration
et al., 2016, 2020), requiring that the signiﬁcance of a
PPM signal4 is SPPM > 3.

• For Gaia eDR3 objects with lower PPM_SN or no PPM

information, we use a "GaiaSource" label.

• We use the label "Var" for all sources cross-matched to
the AAVSO International Variable Star Index (Watson
et al. 2006; version 19 October 2020). It contains mainly
known variable stars and a few QSOs.

• We assign a label of "Quasar" to sources matched to the

Milliquas catalogue (Flesch 2015, version 7.0a).

• For detections that are too close to very bright stars and
carry a risk of being an optical reﬂection (deﬁned by the
algorithm in item 3 of Section 2.6.1 from Onken et al.
2019), we use a "BrightStar" label.

In addition, image mask data allows us to reject sources
as being likely spurious, when they could be affected by
bad pixels, neighbouring saturated pixels, or cosmic ray hits.
Only candidates with Tscore greater than 30 (see Section 3)
are considered plausible candidates and presented for visual
inspection. If the number of plausible sources in a single
CCD image exceeds 50, we reject all detections in that CCD
because the quality of subtracted image is likely to be poor.

2.5 Further follow-up mechanisms

We manage data sets of transient candidates, building on a
web user interface developed by Scalzo et al. (2017) based
on the Django framework. Following the initial automated
typing of the candidates, the next step requires a human to
visually inspect and classify the remaining candidates in a
web interface. All plausible candidates are assigned a unique
name. Since we visit any ﬁeld at least twice during the search,
we prioritise candidates in the visual examination that are
detected at least twice. We keep a list of "active" candidates,
which human vetting has identiﬁed as relevant for spectro-
scopic or photometric follow-up. If another facility reports a
kilonova discovery, we can add such an object manually.

The web interface displays light curves, thumbnails of
new, reference and subtracted images, and information from
external services. Because of the rapid nature of the kilonova
evolution and the robotic nature of SkyMapper operation, we
added features to the web interface that trigger interaction
with the telescope scheduler for follow-up modes that we
anticipate to use during the next GW observing run (O4):

• Candidate Dweller: this feature can be used to monitor
one or several objects in one of three possible modes:
(1) The "one-off" mode triggers just three exposures
in the ﬁlter sequence i-u-i using an exposure sequence
of 100-300-100 seconds (default but changeable). This
mode is designed to probe the colour of a source quickly

4S2

PPM = ((pmra/pmra_error)2 + (pmdec/pmdec_error)2 +

(max(0, parallax)/parallax_error)2)/3

after an initial detection is made to help assess its like-
lihood of being a kilonova from a BNS merger. Two
further modes with different sampling patterns can be
used for continuous monitoring. (2) The "sampling"
mode probes the lightcurve and its colour evolution with
alternating 100 sec i band and 300 sec u band exposures.
And (3) the "intense sampling" mode takes a series of
ten consecutive 100 sec i-band images followed by one
300 sec u-band image, which provides the highest possi-
ble cadence, while recording colour evolution at lower
cadence. Both sampling modes will continue observing
the chosen target(s) until it sets or the dome closes.
• Alert Schedule Cleaner: this feature simply removes
all observations in the queue, aborting any previously
committed sequence and allowing a fresh start.

• AlertSDP Status: this web page reports the execution
status of individual pipeline tasks (Section 2.3) and in-
cludes execution times for all jobs in the workﬂow.

We also trigger prompt Target-of-Opportunity spectroscopy
at the ANU 2.3m Telescope to verify the physical nature of
relevant candidates and inform further SkyMapper activities.

3 ENSEMBLE-BASED TRANSIENT CLASSIFIER

In this section we describe a new ensemble-based approach
for transient classiﬁcation. The previous RF classiﬁer had a
completeness of ∼ 83% at 95% purity, declining to ∼ 70%
at 99% purity (see Scalzo et al. 2017). The classiﬁer was in
need of retraining, because (i) the seeing range of images
changed from the previous SkyMapper Transient Survey that
mostly used bad-seeing time, and (ii) the characteristics of the
image noise changed after implementing the SDP-style image
calibration in the AlertSDP pipeline. However, the image
sample used to train the RF classiﬁer was not reprocessed
with the AlertSDP and hence not available for retraining.
Instead a new image set and transient sample was required.
We used the opportunity given by the need to start from
scratch to switch to a gradient boosted tree model (Section
3.1), as implemented in XGBoost (Chen & Guestrin, 2016),
and develop a new training set from SMSS imagery (Section
3.2). While comparing results with the performance of the
previous RF classiﬁer, we found that the two classiﬁers have
complementary strengths and weaknesses. By combining the
outputs of both classiﬁers, we were able to improve both
purity (Section 3.3) and completeness (Section 3.4).

3.1 New XGBoost Classiﬁer

We adopt XGBoost5 using an ensemble of decision trees. It
uses a gradient boosting algorithm (Friedman, 2000) to min-
imise a loss function when adding new decision trees. Unlike
random forest methods, which train each tree independently,
gradient boosted trees are built sequentially such that each
subsequent tree aims to reduce the errors from its predeces-

5https://github.com/dmlc/xgboost

SkyMapper AlertSDP: Alert Science Data Pipeline

7

Table 1 Explored and chosen (bold) XGBoost Hyperparameters.
Note that the results did not vary strongly with parameter changes.

Hyperparameters

Values

learning_rate
max_depth
n_estimators
colsample_bytree
lambda
alpha

0.1, 0.3, 0.5, 0.7, 0.9
3, 6, 12, 18
10, 50, 150, 300
0.1, 0.3, 0.5, 0.7, 0.9
1, 1.5, 3
5, 10, 15, 30

sors. The accuracy of classiﬁcation is improved as more trees
are added to the model, although a large complexity of the
trees can lead to overﬁtting. However, XGBoost provides ad-
ditional regularisation hyperparameters that can help reduce
model complexity and guard against overﬁtting. Therefore,
we use a column subsampling option to ensure that it uses a
random subsample of the training data prior to growing trees.
The robustness of the classiﬁer model is mainly limited
by the available training data of candidates with known class
label (e.g., Brink et al. 2013; Scalzo et al. 2017). The labelled
data from the earlier supernova survey was unfortunately not
useful in this regard, because it was predominantly obtained
in bad seeing conditions. A new training set was generated
by randomly selecting 1 000 SMSS DR3 images in i-band,
excluding low galactic latitudes of | b |< 15◦. These data
represent a large range of observational conditions and image
quality from the survey. In this data set we searched for tran-
sient candidates and used the original RF classiﬁer to ﬁlter the
list of millions of candidates. We then eyeballed candidates
with RBscore > 40, and labelled them as real or bogus, where
the latter category includes bad subtractions, cosmic ray hits
and warm pixels. We also added to the real set known aster-
oids, variable stars, quasars and a small number of candidates
projected onto galaxies from the 6dFGS and 2MASS XSC
catalogues, as these may appear like typical host galaxies of
kilonovae. Finally, we added to the bogus set a random subset
of candidates with RBscore < 30, provided they were not as-
sociated with known objects of those types mentioned above
that may be genuinely variable; this sample mostly includes
subtraction artefacts such as residual features around bright
stars, bad pixels and cosmic rays. The real-labelled class has
much fewer instances than the bogus-labelled class, with a
number ratio close to 1:10.

For training the XGBoost classiﬁer with the similar input
features used in Scalzo et al. (2017), we split the sample into
training and testing sets of 43 593 and 71 307 candidates, re-
spectively. One issue is that our binary classiﬁcation does not
have a balanced number of instances in the training set. This
requires the use of a stratiﬁed sampling strategy to learn the
features of each class equally. Next, the classiﬁer has a list of
hyperparameters that require ﬁne-tuning in order to derive the
best-possible model. We select test values of hyperparameters
from a set of points in a coarse grid (see Table 1). We focused

on hyperparameters that tend to have a high impact on the
classiﬁcation, such as control overﬁtting, learning rate, and
complexity of the trees. Brieﬂy the parameters are:

• learning_rate: step size shrinkage used in update

to prevent over-ﬁtting,

• max_depth: maximum depth of a tree,
• n_estimators: the number of trees in our ensemble,
• colsample_bytree:
ratio of

subsample

the

columns when constructing each tree,

• lambda: L2 regularisation term on weights,
• alpha:L1 regularisation term on weights.

The ﬁnal parameters were chosen as the model with the lowest
classiﬁcation error, i.e., with both high completeness and high
purity (see bold ﬁgures in Table 1).

3.2 Validation sample

To enable an accurate and unbiased assessment of classiﬁer
purity (Section 3.3), we need to deﬁne a "validation sample"
– a random sample of objects with the weight factors based
on the observed magnitude and RB scores. In the general
case of an unweighted random sample, high RB scores are
less common than low ones. Also, it is required to keep
reasonable statistics for the rare, bright objects. We note that
the distribution of classes in the validation set is unbalanced
and neither reﬂects those in the training set perfectly nor
those expected during the real transient search. The role of
the validation set is to lead the parameters of the classiﬁer
towards best performance on real data. Hence, the distribution
of classes in the validation set should ideally reﬂect that of
the classes in the test set, so that the performance metrics
will be similar on both sets. In other words, the validation set
should reﬂect the expected data imbalance. The imbalance in
our validation set thus leads to suboptimal performance. In
Section 4 we test its performance in a real transient search
during the O3 run.

From a set of 149 DR3 i-band images, we obtained 11,790
sources with RBscore larger than 30 without any further ﬁlter-
ing, and we selected 4 500 candidates for further visual inspec-
tion in a manner that sampled the range of source parameters.
We label the sources irrespective of whether they have an
automatic label or not. Table 2 summarises the steps we used
to select pure transient candidates by removing known im-
age artefacts (cleaned sample 1) and pre-selected categories
(cleaned sample 2). Sample 1 can evaluate basic system per-
formance, while sample 2 represents transient candidates that
remain unexplained after automatic association with a known
variable source and need to be presented for human vetting
when hunting for real kilonovae.

Our main interest is in classifying either isolated (with
no apparent host galaxy) or supernova-like transients with
high completeness. To measure the classiﬁer completeness
(see Section 3.4), we initially used a total of 5 194 asteroid
detections that were identiﬁed by SkyBot and 443 detections

8

S.-W. Chang et al.

Table 2 Sample Selection Criteria for Purity Test

Sample

Raw

Cleaned
sample 1

Cleaned
sample 2

Selection Criteria

No ﬁltering

Known detector damages
Residual CR hits + ﬂagged pixels
Subtraction artefacts
BrightStar-labelled sources

Var-labelled sources
Quasar-labelled sources
Star-labelled sources
Asteroid-labelled sources

N

4 500

4 490
3 519
2 255
2 176

2 102
2 100
1 745
332

for 26 supernovae (16 SN Ia, 7 SN II, 1 SN IIn, 1 SN Ibc,
and 1 SN Ic) that had been followed-up or discovered by the
SkyMapper Transient Survey (Scalzo et al., 2017; Möller
et al., 2019).

We additionally use the Open Supernova Catalogue (Guil-
lochon et al., 2017) to collect spectroscopically conﬁrmed
SNe with distances less than 250 Mpc. In order to match
known SNe against DR3, we take a broad date range of ±30
days from the SN discovery date as our reference epoch. With
this selection cut, there are 429 i-band images of 318 SNe,
where the position and epoch were matched with sources
in the SMSS DR3 catalogue within 5 arcseconds. Some of
those DR3 sources are the host galaxies of SNe, or otherwise
chance superpositions of unrelated sources. After running
the image set through the AlertSDP pipeline, we recover 153
detections for 117 SNe which lie in the magnitude range be-
tween 15.5 and 20.5 in i band. Since the SMSS is focused
on covering the entirety of the southern sky rather than fre-
quently repeating a given area, most of the SNe only appear
in a single exposure. By type, this sample contains 69 Type I
SN (64 Ia, 2 Ib, 2 Ic, 1 Ib/Ic), 45 Type II SN (36 II, 4 IIP, 2
IIb, 3 IIn), and 3 unclassiﬁed ones, in a variety of host galax-
ies. Thus, our completeness test with the Open Supernova
Catalog sample will be less affected by host galaxy selection
effects than that of the SMT SNe sample. Figure 4 shows
thumbnail images of representative SN examples in different
redshift ranges. We assume that this validation sample con-
tains a more representative sample of contaminants, but also
represents the outcome of the pipeline more accurately than
the training data used in the model development stage.

3.3 Purity test

As our two classiﬁers have different strengths, a combination
of them can lead to better performance. XGBoost is much
better at recognising bad subtractions with negative pixel val-
ues, whereas RF works better at recognising that CR hits and
warm pixels are not real objects. While this may be the result
of different training, we deﬁne a new metric here, Tscore,
that combines the two machine learning models (known as

Figure 4. Thumbnail images of two supernovae in the SMSS DR3 i-band
dataset, showing the new, reference, and subtraction image from left to right
(size: 1 arcmin × 1 arcmin). Top: Type II SN 2019ejj at d=13 Mpc, i = 17.1.
Bottom: Type Ia-91T SN 2019ur at d=250 Mpc, i = 18.8.

an ensemble of classiﬁers; see Chapter 34 in Dietterich 2000
for instance), using the simple rule:

Tscore =

RBscore + XGBscore
2

,

which gives both classiﬁers a similar weight.

For any threshold t, we deﬁne classiﬁer purity:

Purity =

TP
TP + FP

,

where TP is the number of true transients with any scores
greater than t, and FP is the number of false positives that
were incorrectly considered as real. Varying the threshold of a
binary classiﬁer usually trades off better completeness against
better purity. In Figure 5, we show curves of completeness vs.
purity in our cleaned samples as a function of threshold and
compare our two classiﬁers as well as the combined Tscore.
In cleaned sample 1, XGBscore is an improvement over RB-
score at every completeness > 90%; for further applications,
we choose a threshold of t = 30, which delivers 92% purity
and 97% completeness. However, at higher purity the origi-
nally used RBscore appears more complete. Our new metric
then combines the advantages of both and is in all parts of
the curve at least as good as either the RB or XGB classiﬁer.
In cleaned sample 2 (right panel of Figure 5) all transient
candidates explained by known objects have been removed
and only those in need of human inspection are left over; here,
a threshold of t = 30 is still a good choice and provides a
purity above 80% with 99% completeness. Based on this, we
choose the ensemble-based Tscore classiﬁer with a threshold
of t = 30 as our ﬁnal classiﬁer. Other wide-ﬁeld surveys
have obtained similar results on real-bogus classiﬁcation by
using convolutional neural networks (e.g. Duev et al., 2019;
Killestein et al., 2021).

SkyMapper AlertSDP: Alert Science Data Pipeline

9

Figure 5. Purity vs. completeness curves for the two cleaned samples described in Section 3.2. We compare the performance of three ensemble scores:
RBscore (grey ﬁlled circle), XGBscore (grey open circle), and our new metric, Tscore (black ﬁlled triangle). The text in the panels refers to purity (P) and
completeness (C) scores at a threshold of t = 30, which we adopt for our transient search.

Figure 6. Completeness test with asteroid (left), SMT SN (middle), and DR3 SN (right) samples as a function of magnitude. We compare the three different
ensemble scores: RBscore (grey ﬁlled circle), XGBscore (grey open circle), and Tscore (black ﬁlled triangle). The same axis ranges are used in each panel.

3.4 Completeness test

Next, we check the completeness of Tscore classiﬁer for real-
bogus classiﬁcation. For any threshold t on the score, we
obtain the completeness or recovery rate as a function of
magnitude, using

Completeness =

TP
TP + FN

,

where TP is the number of true positives in the test set that
were correctly classiﬁed as real and FN is the number of
false negatives (= positives misclassiﬁed as bogus). Figure 6
shows how the classiﬁer performs as a function of magnitude
for the two cases of asteroids and supernovae. In both cases,
there is a clear trend for brighter transients to have a higher
recovery rate at a given threshold. The high recovery rate
of asteroids can be explained by the fact that they are over-

represented in our training set compared to SN-like transients.
Asteroids also appear mostly as isolated sources and are only
rarely blended with galaxies, while supernovae and kilonovae
are mostly blended with their host galaxy. With a threshold
of t = 30, we attain 99.5% completeness for both asteroid
(TP=5 170, FN=24) and supernova (TP=441, FN=2) classi-
ﬁcations. While the SN sample has 443 detection images,
these are from only 26 host galaxies and hence its statistical
signiﬁcance is smaller than it may seem. Moreover, there is
reason to expect variations in completeness as a function of
SN magnitude (at the time of detection), SN offset from the
host galaxy nucleus, morphological type of the host galaxy,
and redshift.

To overcome this weakness, we test the completeness also
for the DR3 SNe sample, which has fewer images but more
(117 vs. 26) host galaxies. Using t = 30 again, we ﬁnd

10

S.-W. Chang et al.

high completeness (∼97%; TP=148, FN=5) to the lowest
magnitudes, comparable to other recently reported results
(Killestein et al., 2021, with ∼97%). We checked the ﬁves
failures of the classiﬁer and noticed that in three cases the
FNs are superimposed on the host nucleus within < 1 arc-
second offset, so that the classiﬁcation may be affected by
residual features from poor subtraction. The two SNe out-
side the nuclei of their hosts are OGLE 16etd, a classical SN
II found close to maximum light in a crowded region, and
SN 2018aau, an apparently hostless SN Ia detected ∼2 weeks
after maximum. The latter has two observations, one classi-
ﬁed as TP and another one as FN. The classiﬁcation scores
of a given transient candidate can indeed vary with seeing
conditions and star density in the ﬁeld, which affect image
subtraction.

4 APPLICATION IN THE LIGO/VIRGO O3 RUN

Our follow-up program was dedicated to the rapid search for
kilonova counterparts to BNS mergers beyond GW170817
that would be observed by LIGO/Virgo observatories in O3.
To trigger the SkyMapper observations, the estimated mass of
one component of the compact binary system is required to
be consistent with a neutron star (via the HasNS probability
in the GCN notice). Table 3 summarises BNS candidates
that have been reported in the LIGO/Virgo O3 public alerts,
including events retracted later. For comparison, we list the
properties of GW170817 detected in the O2 campaign in the
last row of Table 3.

SkyMapper responded to three of these triggers, S190425z,
S190510g and S191220af. The other triggers were ignored
because of poor localisation or proximity to the Sun. The
most promising event in all of O3 was S190425z, also called
GW190425, where SkyMapper managed to obtain a data set
of typical sky coverage. While we responded to the event in
real-time (see Section 4.1), we also reprocessed the data with
the latest version of the AlertSDP to evaluate the real-world
performance of the pipeline (see Section 4.2).

4.1 The search for an EM counterpart to

S190425z/GW190425

On 25 April 2019 08:18:05.017 (UT), the LIGO Livingston
observatory alone identiﬁed a GW chirp signal with a false
alarm rate of one per 69 000 years and a signal-to-noise ratio
(SNR) of 12.9 (Abbott et al., 2020c). The LIGO Hanford
facility was ofﬂine when the event was detected and the
Virgo facility did not contribute to its detection due to a low
SNR=2.5. This signal has strong evidence for the mass of
one or both components to be consistent with a neutron star
(HasNS=100%; BNS=100%). It also shows a clear time-
frequency map with the characteristic upwardly-sweeping
chirp pattern expected for an inspiralling BNS system, which
is what had been seen in GW170817 (see Figure 1 of Abbott
et al. 2017a). The latest inferred position of this event was
poorly localised in the sky, with a 90% credible sky area

covering 8 284 deg2, but the distance inferred from the GW
signal was 159+69
−71 Mpc (see Abbott et al. 2020c for details).
Unlike the case of GW170817, where the position constraints
were ∼ 250× tighter, this situation makes it difﬁcult to ﬁnd
faint EM counterparts quickly. While the extremely wide-
ﬁeld Zwicky Transient Facility (ZTF) did search ∼ 8000 deg2
and reported two potential candidates, they needed two nights
of observing to cover the area (Coughlin et al., 2019). Some
searches even reached sufﬁcient depth to detect GW170817-
like kilonovae, although their areal coverage was incomplete
(Hosseinzadeh et al., 2019).

The ﬁrst optical detection by SkyMapper was made from
the prioritised list of target ﬁelds that were observed about
6 hours after the merger. We let the search mode (Section
2.2) run on a relatively small fraction of the southern locali-
sation region (∼125 square degrees), acknowledging a small
probability of ﬁnding the associated EM counterpart, as the
area covered only ∼1% of the initial BAYESTAR map and
∼3% of its integrated probability. We found two transient
candidates that had two detections separated by about 10 min-
utes, but neither of them had visible host galaxies. After the
discovery of two candidates by the Zwicky Transient Facility
(ZTF) survey, we moved onto a new phase to help determine
whether either transient might be related to the GW signal. In
Section 4.2, we perform a simple experiment to test our new
software implementation with the SkyMapper observations
of the BNS merger GW190425.

As part of our Target-of-Opportunity programme at the
ANU 2.3m Telescope, we obtained a series of early spectra
of the potential counterpart ZTF19aarykkb (Coughlin et al.,
2019). We used the WiFeS instrument (Dopita et al., 2007),
whose integral-ﬁeld nature allows us to obtain spectra of both
the transient and the host galaxy simultaneously. These could
identify a kilonova from its spectral features being atypical
for better-known transient types (e.g., cataclysmic variable
stars or supernovae) and would also provide constraints on
the environment of the transient as a birth or merger place for
the progenitor binary (e.g., Levan et al. 2017). We obtained
our ﬁrst 850 s exposure starting at 2019-04-25 17:40:40 UT,
followed by 5×1200s spectra, using the R ∼ 3000 gratings,
B3000+R3000, covering the wavelength range of 320nm to
990nm. The WiFeS spectra showed the bright ZTF candidate
(r= 18.63 mag) having spectral features similar to those of a
young Type II supernova (Chang et al., 2019b).

A number of additional EM candidates were discovered by
other facilities (e.g., Hosseinzadeh et al. 2019). At the loca-
tion (RA=17:02:19.2, Dec=-12:29:08.2) of the Swift UVOT
candidate by Breeveld et al. (2019) we did not see any tran-
sient down to an i = 20 at the two epochs: 2019-04-25
14:17:00 and 2019-04-25 14:25:53 UT (Chang et al., 2019c).
Later work suggested the Swift detection was likley to be
an ultraviolet ﬂare on an M dwarf star (Lipunov et al., 2019;
Bloom et al., 2019). As discussed by previous studies, M
dwarf ﬂares are the most common transient phenomenon
that may confuse searches for kilonova candidates from GW
events (e.g., van Roestel et al. 2019; Chang et al. 2020).

SkyMapper AlertSDP: Alert Science Data Pipeline

11

Table 3 Summary of preliminary BNS detection alerts in O3. For GW190425, we list updated information from Abbott et al. (2020c).

Preliminary Area

Pclass preliminary (updated)

Superevent
(ID)

50%
(deg2)

GW190425
S190426c
S190510g
S190901ap
S190910h
S191213g
S191220af
S200213t

GW170817

472
575
4176
8066
259
580
150

90%
(deg2)

8284
1932
3462
13613
24226
1393
5238
2587

28

DL
(Mpc)

159+69
−71
377±100
277±92
241±79
230±88
201±81
125±28
210±80

40+8
−14

FAR
(yr−1)

1 per 69 000
1 per 1.63
1 per 3.59
1 per 4.51
1 per 0.88
1 per 0.89
1 per 79.96
1 per 1.79

BNS
(%)

100
49 (24)
98 (42)
86
61
77
>99
63

NSBH Terrestrial

(%)

-
13 (6)
0 (0)
14
0
0
0
0

(%)

-
14 (58)
2 (58)
0
39
23
<1
37

Notes

This
work

(cid:88)

(cid:88)

(cid:88)

Abbott et al. (2020c)
Too distant to detect
Cloudy weather
Poor localisation
Poor localisation
Near the Sun
Retracted
Marginal FAR

1 per 80 000

100

-

-

Abbott et al. (2017a)

4.2 SkyMapper search results for GW190425

Table 4 Transient selection for GW190425

To get a realistic view of the current performance of the
SkyMapper transient facility, we reran the initial search mode
data from the ﬁrst night of the GW190425 event in O3
through the AlertSDP as described above. Each target ﬁeld
in the ∼125 square degrees of the localisation region was
visited twice, separated by about 10 minutes. We applied the
same ﬁltering scheme for the selection of transient candidates
as introduced in Section 3. Table 4 shows how each ﬁlter-
ing step reduced the number of candidates from 41 497 to
359, which is a >100-fold reduction in the number of candi-
dates requiring human inspection. Before the vetting process,
this number was reduced even further to 9 candidates (1 in
∼5,000) by considering only those with two detections. Each
of the remaining candidates could be one of the following
categories: (i) an isolated transient in a position which was
not reported before, (ii) a galaxy with a SN at the time of
observation, (iii) an as-yet unidentiﬁed variable object that
has historical detections, or (iv) a bogus detection. We note
that there was one known SN that was not detected in our
search, because it was fainter than our detection limit (i =
20.4). Five of the sources were clear bogus detections caused
by poor image subtraction. The remaining four candidates
are persistent point sources in SMSS DR3 and seen to vary
by 0.2 to 0.7 mag over the 5-year span of data in DR3. Thus,
we conclude that none of them were related to GW190425.

5 SUMMARY AND OUTLOOK TO O4

In this paper, we describe the capability of the SkyMapper
facility for rapid-response EM observations of GW events.
Developed as a new branch of the SkyMapper pipeline, the
AlertSDP provides a prompt response to GW alerts with low-
latency data processing and a web interface for follow-up.
With a hybrid combination of ensemble-based classiﬁers, we
achieve a high completeness (∼98%) and purity (∼91%) in
real-bogus classiﬁcation; this is measured with a sample of
4 500 random transient candidates in the purity test, and over

Selection Criteria

N

No ﬁltering
Tscore>30

All ﬂagged pixels
Subtraction artefacts
BrightStar-labelled sources

Var-labelled sources
Quasar-labelled sources
Star-labelled sources
Asteroid-labelled sources

41 497
6 619

4 345
4 131
3 067

2 694
2 689
825
359

Candidates detected twice

9

5 000 asteroids as well as 143 supernovae in the completeness
test. We performed the same analysis on the real SkyMapper
data for LIGO/Virgo event S190425z/GW190425, conﬁrming
its efﬁciency to reduce contaminants.

When the observing run O4 starts with the GW detec-
tor network of the LIGO/Virgo/Kagra (LVK) collaboration,
the predicted rate of BNS merger detections is 10+52
−10 per
year, their predicted median luminosity distance is 170+6.3
−4.8
Mpc, and their predicted median 90% sky localisation area
is 33+4.9
−5.3 deg2 (all values given as 5% to 95% conﬁdence
intervals; Abbott et al., 2020b). A 100-sec i-band exposure
with SkyMapper can discover an GW170817-like kilonova
at four times the distance of GW170817. Future SMSS data
releases will have deeper co-added reference images with up
to 600 sec exposures per sky pixel in each band, which may
allow complete detection of transient candidates to i ≈ 21
mag and provide good coverage beyond the LVK median
horizon of 170 Mpc. The AlertSDP should identify all tran-
sients in a ∼ 100 deg2 search area within four hours from the
start of observations. In the future, we expect to reduce this
latency by speeding up the data processing.

12

ACKNOWLEDGEMENTS

We are grateful to an anonymous referee for comments
that signiﬁcantly improved the manuscript. We thank Jon
Nielsen (ANU) for parallelising part of the AlertSDP. This
research was partly funded by the Australian Research Coun-
cil Centre of Excellence for Gravitational Wave Discovery
(OzGrav), CE170100004. SWC acknowledges support from
the National Research Foundation of Korea (NRF) grant,
No. 2020R1A2C3011091, funded by the Korea government
(MSIT). CAO acknowledges support from the Australian Re-
search Council through Discovery Project DP190100252.
The national facility capability for SkyMapper has been
funded through ARC LIEF grant LE130100104 from the
Australian Research Council, awarded to the University of
Sydney, the Australian National University, Swinburne Uni-
versity of Technology, the University of Queensland, the Uni-
versity of Western Australia, the University of Melbourne,
Curtin University of Technology, Monash University and the
Australian Astronomical Observatory. SkyMapper is owned
and operated by The Australian National University’s Re-
search School of Astronomy and Astrophysics. The survey
data were processed and provided by the SkyMapper Team at
ANU. The SkyMapper node of the All-Sky Virtual Observa-
tory (ASVO) is hosted at the National Computational Infras-
tructure (NCI). Development and support of the SkyMapper
node of the ASVO has been funded in part by Astronomy
Australia Limited (AAL) and the Australian Government
through the Commonwealth’s Education Investment Fund
(EIF) and National Collaborative Research Infrastructure
Strategy (NCRIS), particularly the National eResearch Col-
laboration Tools and Resources (NeCTAR) and the Australian
National Data Service Projects (ANDS).

REFERENCES

Abbott B. P., et al., 2017a, Phys. Rev. Lett., 119, 161101
Abbott B. P., et al., 2017b, ApJ, 848, L12
Abbott B. P., et al., 2017c, ApJ, 850, L40
Abbott R., et al., 2020a, arXiv e-prints, p. arXiv:2010.14527
Abbott B. P., et al., 2020b, Living Reviews in Relativity, 23,

3

Abbott B. P., et al., 2020c, ApJ, 892, L3
Adhikari S., Fishbach M., Holz D. E., Wechsler R. H., Fang

Z., 2020, ApJ, 905, 21

Alard C., Lupton R. H., 1998, ApJ, 503, 325
Andreoni I., et al., 2017, PASA, 34, e069
Arcavi I., 2018, ApJ, 855, L23
Arcavi I., et al., 2017, Nature, 551, 64
Bailey S., Aragon C., Romano R., Thomas R. C., Weaver

B. A., Wong D., 2007, ApJ, 665, 1246
Barnes J., Kasen D., 2013, ApJ, 775, 18
Becker A., 2015, HOTPANTS: High Order Transform of PSF

ANd Template Subtraction (ascl:1504.004)

Berthier J., Vachier F., Thuillot W., Fernique P., Ochsenbein

S.-W. Chang et al.

F., Genova F., Lainey V., Arlot J. E., 2006, in Gabriel C.,
Arviset C., Ponz D., Enrique S., eds, Astronomical Society
of the Paciﬁc Conference Series Vol. 351, Astronomical
Data Analysis Software and Systems XV. p. 367

Bertin E., Arnouts S., 1996, A&AS, 117, 393
Bertin E., Mellier Y., Radovich M., Missonnier G., Didelon P.,
Morin B., 2002, in Bohlender D. A., Durand D., Handley
T. H., eds, Astronomical Society of the Paciﬁc Conference
Series Vol. 281, Astronomical Data Analysis Software and
Systems XI. p. 228

Bessell M., Bloxham G., Schmidt B., Keller S., Tisserand P.,

Francis P., 2011, PASP, 123, 789

Bloom J. S., et al., 2012, PASP, 124, 1175
Bloom J. S., Zucker C., Schlaﬂy E., Finkbeiner D., Martinez-
Palomera J., Goldstein D. A., Andreoni I., 2019, GRB
Coordinates Network, 24337, 1

Breeveld A. A., et al., 2019, GRB Coordinates Network,

24296, 1

Brink H., Richards J. W., Poznanski D., Bloom J. S., Rice J.,
Negahban S., Wainwright M., 2013, MNRAS, 435, 1047
Chang S.-W., Wolf C., Onken C. A., Luvaul L., Gupta V.,
Flynn C., 2019a, The Astronomer’s Telegram, 13008, 1
Chang S. W., et al., 2019b, GRB Coordinates Network, 24260,

1

Chang S. W., Wolf C., Onken C. A., Luvaul L., Scott S.,

2019c, GRB Coordinates Network, 24325, 1

Chang S.-W., Wolf C., Onken C. A., 2020, MNRAS, 491, 39
Chen T., Guestrin C., 2016, in Proceedings of the 22nd
ACM SIGKDD International Conference on Knowl-
edge Discovery and Data Mining. KDD ’16. Associa-
tion for Computing Machinery, New York, NY, USA,
p. 785–794, doi:10.1145/2939672.2939785, https://
doi.org/10.1145/2939672.2939785

Coughlin M. W., et al., 2019, ApJ, 885, L19
Coulter D. A., et al., 2017, Science, 358, 1556
Cowperthwaite P. S., et al., 2017, ApJ, 848, L17
Díaz M. C., et al., 2017, ApJ, 848, L29
Dietterich T. G., 2000, Ensemble Methods in Machine Learn-
ing, 3 edn. MCS Vol. 1857, Springer-Verlag Berlin Hei-
delberg, https://doi.org/10.1007/3-540-45014-9_1

Dopita M., Hart J., McGregor P., Oates P., Bloxham G., Jones

D., 2007, Ap&SS, 310, 255

Drout M. R., et al., 2017, Science, 358, 1570
Duev D. A., et al., 2019, MNRAS, 489, 3582
Farah W., et al., 2018, MNRAS, 478, 1209
Farah W., et al., 2019, MNRAS, 488, 2989
Fernández R., Metzger B. D., 2016, Annual Review of Nu-

clear and Particle Science, 66, 23
Flesch E. W., 2015, PASA, 32, e010
Friedman J. H., 2000, Annals of Statistics, 29, 1189
Gaia Collaboration et al., 2016, A&A, 595, A1
Gaia Collaboration Brown A. G. A., Vallenari A., Prusti T., de
Bruijne J. H. J., Babusiaux C., Biermann M., 2020, arXiv
e-prints, p. arXiv:2012.01533

SkyMapper AlertSDP: Alert Science Data Pipeline

13

Singer L. P., et al., 2016, ApJS, 226, 10
Smartt S. J., et al., 2017, Nature, 551, 75
Tanaka M., Hotokezaka K., 2013, ApJ, 775, 113
Tanvir N. R., et al., 2017, ApJ, 848, L27
Troja E., et al., 2017, Nature, 551, 71
Troja E., et al., 2018, Nature Communications, 9, 4089
Utsumi Y., et al., 2017, PASJ, 69, 101
Veitch J., et al., 2015, Phys. Rev. D, 91, 042003
Watson C. L., Henden A. A., Price A., 2006, Society for

Astronomical Sciences Annual Symposium, 25, 47

Wolf C., et al., 2018, PASA, 35, e010
Wright D. E., et al., 2015, MNRAS, 449, 451
Wu M.-R., Barnes J., Martínez-Pinedo G., Metzger B. D.,

2019, Phys. Rev. Lett., 122, 062701

van Roestel J., et al., 2019, MNRAS, 484, 4507

Goldstein D. A., et al., 2015, AJ, 150, 82
Guillochon J., Parrent J., Kelley L. Z., Margutti R., 2017,

ApJ, 835, 64

Hjorth J., et al., 2017, ApJ, 848, L31
Hosseinzadeh G., et al., 2019, ApJ, 880, L4
Hu L., et al., 2017, Science Bulletin, 62, 1433
Jedicke R., 1996, AJ, 111, 970
Kasen D., Metzger B., Barnes J., Quataert E., Ramirez-Ruiz

E., 2017, Nature, 551, 80

Kasliwal M. M., et al., 2017, Science, 358, 1559
Kasliwal M. M., et al., 2019, MNRAS,
Kasliwal M. M., et al., 2020, ApJ, 905, 145
et
Killestein T. L.,
arXiv:2102.09892

al., 2021,

arXiv e-prints, p.

Kilpatrick C. D., et al., 2017, Science, 358, 1583
Kruckow M. U., Tauris T. M., Langer N., Kramer M., Izzard

R. G., 2018, MNRAS, 481, 1908

LIGO Scientiﬁc Collaboration VIRGO Collaboration 2019,

GRB Coordinates Network, 24168, 1

LIGO Scientiﬁc Collaboration Virgo Collaboration 2019,

GRB Coordinates Network, 25606, 1
Levan A. J., et al., 2017, ApJ, 848, L28
Li L.-X., Paczy´nski B., 1998, ApJ, 507, L59
Lipunov V., et al., 2019, GRB Coordinates Network, 24326,

1

Luvaul L. C., Onken C. A., Wolf C., Smillie J. G., Sebo K. M.,
2017, in Lorente N. P. F., Shortridge K., Wayth R., eds,
Astronomical Society of the Paciﬁc Conference Series Vol.
512, Astronomical Data Analysis Software and Systems
XXV. p. 393

Metzger B. D., 2019, Living Reviews in Relativity, 23, 1
Metzger B. D., et al., 2010, MNRAS, 406, 2650
Metzger B. D., Bauswein A., Goriely S., Kasen D., 2015,

MNRAS, 446, 1115

Metzger B. D., Thompson T. A., Quataert E., 2018, ApJ, 856,

101

Möller A., et al., 2019, in Grifﬁn R. E., ed., Interna-
tional Astronomical Union Symposium Series Vol. 339,
Southern Horizons in Time-Domain Astronomy. pp 3–6,
doi:10.1017/S1743921318002077

Mooley K. P., et al., 2018, Nature, 554, 207
Onken C. A., et al., 2019, Publications of the Astronomical

Society of Australia, 36, e033

Petroff E., et al., 2015, MNRAS, 447, 246
Pian E., et al., 2017, Nature, 551, 67
Price D. C., et al., 2019, MNRAS, 486, 3636
Romero-Shaw I. M., Farrow N., Stevenson S., Thrane E., Zhu

X.-J., 2020, arXiv e-prints, p. arXiv:2001.06492

Safarzadeh M., Ramirez-Ruiz E., Berger E., 2020, arXiv e-

prints, p. arXiv:2001.04502

Scalzo R. A., et al., 2017, PASA, 34, e030
Shappee B. J., et al., 2017, Science, 358, 1574
Singer L. P., Price L. R., 2016, Phys. Rev. D, 93, 024013

