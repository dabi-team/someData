0
2
0
2

p
e
S
7
2

]
h
p
-
t
n
a
u
q
[

1
v
7
2
8
2
1
.
9
0
0
2
:
v
i
X
r
a

Realizing a quantum generative adversarial network
using a programmable superconducting processor

Kaixuan Huang,1, âˆ— Zheng-An Wang,2, âˆ— Chao Song,3, âˆ— Kai Xu,2 Hekang Li,3 Zhen Wang,3 Qiujiang Guo,3
Zixuan Song,3 Zhi-Bo Liu,1, â€  Dongning Zheng,2, 4 Dong-Ling Deng,5, â€¡ H. Wang,3 Jian-Guo Tian,1 and Heng Fan2, 6, Â§
1The Key Laboratory of Weak Light Nonlinear Photonics, Ministry of Education,
Teda Applied Physics Institute and School of Physics, Nankai University, Tianjin 300457, China
2Institute of Physics, Chinese Academy of Sciences, Beijing 100190, China
3Interdisciplinary Center for Quantum Information,
State Key Laboratory of Modern Optical Instrumentation,
and Zhejiang Province Key Laboratory of Quantum Technology and Device,
Department of Physics, Zhejiang University, Hangzhou 310027, China
4CAS Center for Excellence in Topological Quantum Computation,
University of Chinese Academy of Sciences, Beijing 100190, China
5Center for Quantum Information, Institute for Interdisciplinary
Information Sciences, Tsinghua University, Beijing 100084, China
6School of Physical Sciences, University of Chinese Academy of Sciences, Beijing 100190, China

Generative adversarial networks are an emerging technique with wide applications in
machine learning [1], which have achieved dramatic success in a number of challenging
tasks including image and video generation [2]. When equipped with quantum pro-
cessors, their quantum counterpartsâ€”called quantum generative adversarial networks
(QGANs)â€”may even exhibit exponential advantages in certain machine learning ap-
plications [3â€“9]. Here, we report an experimental implementation of a QGAN using
a programmable superconducting processor, in which both the generator and the dis-
criminator are parameterized via layers of single- and multi-qubit quantum gates. The
programmed QGAN runs automatically several rounds of adversarial learning with
quantum gradients to achieve a Nash equilibrium point, where the generator can repli-
cate data samples that mimic the ones from the training set. Our implementation
is promising to scale up to noisy intermediate-scale quantum devices, thus paving the
way for experimental explorations of quantum advantages in practical applications with
near-term quantum technologies.

The interplay between quantum physics and machine
learning gives rise to an emergent research frontier of
quantum machine learning that has attracted tremen-
dous attention recently [10â€“13].
In particular, cer-
tain carefully-designed quantum algorithms for machine
learning, or more broadly artiï¬cial intelligence, may ex-
hibit exponential advantages compared to their best pos-
sible classical counterparts [3, 11â€“16]. An intriguing ex-
ample concerns quantum generative adversarial networks
(QGANs) [3], where near-term quantum devices have the
potential to showcase quantum supremacy [17] with real-
life practical applications.

The general framework of QGANs consists of a gen-
erator learning to generate statistics for data mimick-
ing those of a true data set, and a discriminator trying
to discriminate generated data from true data [3]. The
generator and discriminator follow an adversarial learn-
ing procedure to optimize their strategies alternatively
and arrive at a Nash equilibrium point, where the gen-
erator learns the underlying statistics of the true data
and the discriminator can no longer distinguish the dif-
ference between the true and generated data. Diï¬€erent
versions of QGANs have been proposed [3â€“9]. Recently,
a proof-of-principle experimental QGAN demonstration
has been reported [7], showing that the generator can

indeed be trained via the adversarial learning process
to replicate the statistics of the single-qubit quantum
data output from a quantum channel simulator. Yet, in
this experiment the gradient, which is crucial for train-
ing the QGAN, was estimated numerically by the ï¬nite-
diï¬€erence method with a classical computer. This ï¬nite-
diï¬€erence approach induces an inaccuracy to the gradient
and therefore may signiï¬cantly retard the convergence
to the equilibrium point [15].
In addition, the quan-
tum states involved in this experiment were all single-
qubit states, and entanglement, a characterizing feature
of quantumness and a vital resource for quantum advan-
tages, was absent during the learning process [12].

In this paper, we add these two crucial yet miss-
ing blocks by reporting an experiment realization of a
QGAN based on a programmable superconducting pro-
cessor with multiple qubits. Superconducting qubits are
a promising platform for realizing QGANs, owing to their
ï¬‚exible design, excellent scalability and remarkable con-
trollability. In our implementation, both the generator
and discriminator are composed of multiqubit parameter-
ized quantum circuits, also referred to as quantum neu-
ral networks in some contexts [18â€“21]. Here, we bench-
mark the functionality of the quantum gradient method
by learning an arbitrary mixed state, where the state is

 
 
 
 
 
 
replicated with a ï¬delity up to 0.999. We further uti-
lize our QGAN to learn an classical XOR gate, and the
generator is successfully trained to exhibit a truth table
close to that of the XOR gate.

We ï¬rst introduce a general recipe for our QGAN and
then apply it to two typical scenarios: learning quantum
states and the classical XOR gate. The overall structure
of the QGAN is outlined in Fig. 1 (a), which includes
an input label, a real source (R), a generator (G), a dis-
criminator (D), and a quantum gradient subroutine. The
input label sorts the training data stored in R, and also
instructs G to generate data samples mimicking R. D re-
ceives the label and corresponding data samples from ei-
ther G or R, and then evaluates with appropriate scores,
based on which a loss function V is constructed to dif-
ferentiate between R and G. The adversarial training
procedure is repeated in conjugation with the quantum
gradient subroutine, which yields the partial derivatives
of V with respect to the parameters constructing D or
G, so as to maximize V for the optimal conï¬guration of
D and to minimize V for the optimal G in terms of the
chosen values of the constructing parameters.

Speciï¬cally, denoting the sets of parameters construct-
ing G and D as (cid:126)Î¸G and (cid:126)Î¸D, respectively, the loss function
V is written as

V =

1
N

N
(cid:88)

n=1

(cid:104)
SD,R
n

((cid:126)Î¸D) âˆ’ SD,G

n

(cid:105)
((cid:126)Î¸D, (cid:126)Î¸G)

,

n

(SD,G
n

where N is the total number of data samples selected
for training and SD,R
) represents the score of the
nth data sample from R (G) evaluated by D. G and
D are trained alternately with D being trained ï¬rst. In
Dâ€™s turn, we maximize the loss function by iteratively
optimizing (cid:126)Î¸D according to (cid:126)Î¸i+1
V , where i
D +Î±Dâˆ‡(cid:126)Î¸D
is the iteration step index and âˆ‡(cid:126)Î¸D
V denotes the gradient
vector of the loss function at the ith step; we train G
by minimizing the square of the loss function with an
iteration relation (cid:126)Î¸i+1
V 2. The learning
rates can be adjusted by tuning Î±D and Î±G which are
typically on the order of unity.

G âˆ’ Î±Gâˆ‡(cid:126)Î¸G

G = (cid:126)Î¸i

D = (cid:126)Î¸i

An important quantity that plays a vital role in train-
ing our QGAN is the gradient of the loss function with
respect to a given parameter. Interestingly, owing to the
special structures of our quantum circuits for the genera-
tor and the discriminator, a common approach to obtain
such a gradient is to shift the corresponding parameter
by Â±Ï€/2 and measure the loss function at the shifted val-
ues [22]. In our experiment, we employ a even simpler
methodâ€”the Hadamard test quantum algorithm [23]â€”
to obtain the gradient. This algorithm can reduce half
of the time in comparison with the common approach
to ï¬nish the training, at the expense of an additional
auxiliary qubit and two controlled gates (see next) [24].
At each round of the training process, the parameters of
the discriminator (or generator) are updated simultane-
ously after the gradients for all parameters are obtained,

2

and a quantum process tomography (QPT) is performed
to characterize the overlap ï¬delity between the generated
data based on the updated parameters and the true data.
The above mentioned QGAN is experimentally re-
alized on a superconducting quantum processor using
5 frequency-tunable transmon qubits labeled as Qj for
j = 0 to 4, where all qubits are interconnected by a cen-
tral bus resonator as illustrated in Fig. 1 (b). The role
arrangement of Q0 to Q4 can be visualized by the exem-
plary experimental sequence shown in Fig 1 (c). Q0 is
to assist the quantum gradient subroutine. Q1-Q2 stores
the label which is passed to D, with the output score
encoded in Q1 by SD,R/G
1(cid:105)/2 + 1/2. For the ex-
perimental instances with G inserted, Q3-Q4 also stores
the label as the input to G and the output data sample
from G is passed to D via Q3; for the experimental in-
stances with R in replacement of G, only Q3 stores the
data sample from R as designated by the label. Details
of the device parameters can be found in supplementary
materials (SM) [24] and Ref. [25].

= (cid:104)Ïƒz

n

j Ïƒ+

j Ïƒâˆ’

k ) [25], where Ïƒ+

By tuning the qubits on resonance but detuned from
the bus resonator in frequency, these qubits can be all
eï¬€ectively connected, which enables the ï¬‚exible realiza-
tions of the multiqubit entangling gates among arbitrar-
ily selected qubits. The all-to-all interactions are de-
scribed in the dispersive regime by the eï¬€ective Hamil-
tonian HI = (cid:80) Î»jk(Ïƒ+
j (Ïƒâˆ’
k + Ïƒâˆ’
j )
denotes the raising (lowering) operator of Qj, and Î»jk is
the eï¬€ective coupling strength between Qj and Qk medi-
ated by the bus resonator. Evolution under this Hamil-
tonian for an interaction time Ï„ leads to the entangling
operator with the form of UENT = eâˆ’iHIÏ„ , which can
steer the interacting qubits into highly entangled state.
In our QGAN, the parameterized quantum circuits that
comprise G and D leverage the naturally available multi-
qubit UENTs, with the interaction time of the two-qubit
UENT ï¬xed at around 50 ns for G and the three-qubit
one ï¬xed at around 55 ns for D [24]. We note that, in
this hardware-eï¬ƒcient realization of the QGAN, the en-
tangling operators can be any device-tailored operations
that generate suï¬ƒcient entanglement.

j,l,m and Î¸z

As laid out in Fig. 1 (c), the entangling operators UENT
are interleaved with the single-qubit X and Z rotations,
which successively rotate Qj around x- and z-axis in the
Bloch sphere by angles of Î¸x
j,l,m, where l is
the layer index and m âˆˆ {G, D}. The lengths of the X
and Z rotations are ï¬xed at 30 and 20 ns, respectively.
Taking into account the experimental imperfections, we
perform numerical simulations to decide the depths of the
interleaved layers consisting of UENT and the single-qubit
rotations, for a balance between the learning ï¬delity and
eï¬ƒciency. For example, to learn the XOR gate, the cir-
cuit layer depths are set to be 2 and 3 for G and D
respectively, as shown in Fig.1 (c).

The QGAN learning process is guided by the gradient
of the loss function with respect to (cid:126)Î¸G and (cid:126)Î¸D. To ob-

3

Figure 1. QGAN algorithm and its implementation. a, Overview of the QGAN logic. b, Sketch of the superconducting
processor used to implement the QGAN algorithm, where the ï¬ve qubits, Q0 to Q4, are interconnected by the central bus
resonator. c, An instance of the experimental sequences for fulï¬lling the QGAN algorithm to learn the classical XOR gate.
Both G and D are parameterized quantum circuits consisting of layers of the multiqubit entangling gate UENT and the single-
qubit rotations Î¸x/z
j,l,m, where l is the layer index, m âˆˆ {G, D}, and the superscript (x or z) refers to the axis in the Bloch
sphere around which the state of Qj is rotated by the angle Î¸. Shown is the training sequence on G to optimize its parameter
Î¸x
3,1,G based on the quantum gradient subroutine, which includes two Hadamard gates (H), two controlled rotation gates, and
a Ï€/2 rotation around x-axis (X/2). In this instance, both Q1-Q2 and Q3-Q4 store the input label, and Dâ€™s output score is
encoded in Q1 by SD,R/G
0 (cid:105) gives the score derivative
with respect to the rotational angle parameter right before the ï¬rst controlled rotation gate, i.e., âˆ‚(cid:104)Ïƒz
0 (cid:105) for
the sequence displayed here. The ï¬rst controlled rotation gate can be either a controlled X (CNOT) or controlled Z (CZ) gate
depending on the single-qubit rotation axis it follows as shown in the lower right box.

1 (cid:105)/2 + 1/2, which can be obtained by directly measuring Q1. Q0â€™s (cid:104)Ïƒz

3,1,G = âˆ’(cid:104)Ïƒz

1 (cid:105)/âˆ‚Î¸x

= (cid:104)Ïƒz

n

tain these gradients, we adopt a quantum method called
Hadamard test [4, 23], which is illustrated in the sequence
instance in Fig. 1 (c). For the partial derivative with re-
spect to the parameter Î¸x
j,l,m (Î¸z
j,l,m), we insert the ï¬rst
controlled-X (Z) gate right after the single-qubit X (Z)
rotation containing this parameter, with Qj as the tar-
get. The second controlled-Z gate is applied at the end
of the training sequence with Q1 as the target. The par-
tial derivative of Q1â€™s (cid:104)Ïƒz
1(cid:105), which relates to Dâ€™s output
1(cid:105)/âˆ‚Î¸x(z)
score, is given by âˆ‚(cid:104)Ïƒz
0(cid:105), which can be
directly obtained by measuring Q0 and used in comput-
ing the gradient of the loss function. See SM [24] for
more details about the experimental realizations of the
controlled-X (Z) gates, as well as the theoretical and ex-
perimental veriï¬cations of the quantum gradient method.

j,l,m = âˆ’(cid:104)Ïƒz

To benchmark the functionality of the quantum gra-
dient method and the learning eï¬ƒciency of our QGAN
circuit, we ï¬rst train an arbitrary mixed state as data

0.0431+0.3501i
0.2604

0.7396
0.0431âˆ’0.3501i

which is a simulation of quantum channel. As shown
in the inset of Fig.2 (a), the mixed state for Q3 reads
(cid:1), which is generated by
ÏR = (cid:0)
applying two single-qubit X rotations (with the rotation
angles of 1.35 on Q3 and 0.68 on Q4) followed by the
UENT gate on Q3 and Q4. Correspondingly, G is set
up with a single layer and 2 parameters describing the
single-qubit X rotation angles during the training, while
D remains the one shown in Fig.1 (c) with 3 layers and
all 18 parameters being trained. The trajectories of the
loss function and scores of data from R/G during the
training process are recorded and plotted in Fig. 2 (a).
We optimize D at the beginning of the training to en-
large the distance between SD,R and SD,G. At the end
of this turn, D can discriminate datasets from R and G
with the maximum probability. In Gâ€™s turn, SD,G moves
towards SD,R which means that G is learning the be-
havior of R. Each turn ends when the optimal point of

acGeneratorDiscriminatorQ0Q3Q1Q4Q2ğœƒ3,1,ğºğ‘¥ğœƒ4,1,ğºğ‘¥ğœƒ4,1,ğºğ‘§ğœƒ3,1,ğºğ‘§ğœƒ3,3,ğºğ‘¥ğœƒ4,3,ğºğ‘¥ğœƒ4,3,ğºğ‘§ğœƒ3,3,ğºğ‘§ğ‘ˆğ¸ğ‘ğ‘‡ğ‘ˆğ¸ğ‘ğ‘‡ğœƒ1,1,ğ·ğ‘¥ğœƒ2,1,ğ·ğ‘¥ğœƒ2,1,ğ·ğ‘§ğœƒ1,1,ğ·ğ‘§ğœƒ3,1,ğ·ğ‘¥ğœƒ3,1,ğ·ğ‘§ğœƒ1,4,ğ·ğ‘¥ğœƒ2,4,ğ·ğ‘¥ğœƒ2,4,ğ·ğ‘§ğœƒ1,4,ğ·ğ‘§ğœƒ3,4,ğ·ğ‘¥ğœƒ3,4,ğ·ğ‘§ğ‘ğ»ğ»ğ‘‹/2ğœƒğ‘¥ğœƒğ‘¥ğœƒğ‘§ğœƒğ‘§ğ‘ğ‘‹ğ‘‰b...BusresonatorQ0Q4Q3Q1.........Q2...Î”ğ‘‰D3 layersGRQuantum GradientLabel2 layersOR4

Figure 2. QGAN performance in learning a mixed
state. a, Tracking of the loss function V , the output scores
SD,R/G, and the state ï¬delity between R/Gâ€™s output states F
during the adversarial training procedure with learning rates
Î±D = 0.8 and Î±G = 0.6. The alternate training stages of D
and G are marked by red and white regions, respectively. In
each stage, the maximum step number is limited to 50 for D
and 100 for G. Inset: the quantum circuit for generating ÏR
for Q3. The same circuit is also used for G, with random
initial guesses for the two rotational angles which are then
optimized. b, The real and imaginary parts of the output
density matirces of R (black frames) and the ï¬nal G (solid
bars).

Figure 3. QGAN performance in learning the XOR
gate. a, Tracking of of the loss function V , the averaged
output scores Â¯SD,R/G, and the averaged state ï¬delity between
R/Gâ€™s output states Â¯F during the adversarial training process
with learning rates Î±D = 1.0 and Î±G = 1.5. The maximum
step number is limited to 50 for both G and D. Â¯SD,R/G and Â¯F
are averaged over four possible inputs. Inset: The truth table
of G after training in comparison with that of the XOR gate.
b, Trajectories of two representative parameters constructing
D and G, Î¸x
3,1,G, during the QGAN training. All
parameters in G and D are initialized randomly between 0
and Ï€ and optimized alternately during the training.

3,1,D and Î¸x

the loss function is reached, or the iteration number goes
over a preset limit. As the adversarial learning process
goes on, the value of the loss function oscillates from turn
to turn and eventually converges to 0 indicating that the
learning arrives at a Nash equilibrium point, where G
is able to produce a mixed state ÏG which resembles ÏR
and D can no longer distinguish between them [3, 4].
The training process is characterized by the similarity
between datasets generated by G and R, which is quan-
ÏR),
tiï¬ed by the state ï¬delity F (ÏR, ÏG) = Tr(
As shown in Fig 2 (a), F increases rapidly with the iter-
ation steps, indicating the eï¬€ectiveness of the adversarial
learning. The density matrices ÏR and the ï¬nal ÏG are
plotted in Fig 2 (b), which yields a state ï¬delity of around
0.999.

ÏRÏG

âˆš

âˆš

Now we apply the recipe to train the QGAN to repli-
cate the statistics of an XOR gate, which is a classical
gate with input-output rules 00 â†’ 0, 01 â†’ 1, 10 â†’ 1,
and 11 â†’ 0. We use the computational basis state |0(cid:105)
and |1(cid:105) to encode the classical data 0 and 1, respectively.
We randomly initialize the parameters of both D and
G, and then update them alternately following the rules
outlined above. The trajectories of the key parameters

benchmarking the QGAN performance during the train-
ing process are plotted in Fig. 3 (a), with the evolutions
of two representative parameters construcing D and G
shown in Fig. 3 (b). Again, the loss function exhibits
a typical oscillation during the adversarial process, and
the training reaches its equilibrium after about 190 steps
with an average state ï¬delity of 0.927. In addition, af-
ter training G successfully exhibits a truth table close to
that of an XOR gate, as shown in the inset of Fig. 3 (a).
In conclusion, we have experimentally implemented a
multi-qubit QGAN equipped with a quantum gradient
algorithm on a programmable superconducting proces-
sor. The results clearly show the feasibility of QGAN
for learning data with both classical and quantum statis-
tics. The parameterized quantum circuits for construct-
ing quantum generators and discriminators do not re-
quire accurate implementations of speciï¬c quantum log-
ics and can be achieved on the near-term quantum de-
vices across diï¬€erent physical platforms. Our implemen-
tation paves the way to the much-anticipated computing
paradigm with combined quantum-classical processors,
and holds the intriguing potential to realize practical
quantum supremacy [17] with noisy intermediate-scale
quantum devices [26].

abğ‘†D,Gğ¹ğ‘‰Trainingstepsğ‘†D,Rğ¼ğ‘š(ğœŒ)01011010-110ğ‘…ğ‘’(ğœŒ)-1          0           1ğœƒ3,1,ğºğ‘¥ğœƒ4,1,ğºğ‘¥ğ‘ˆğ¸ğ‘ğ‘‡Q3Q4Training stepsabğœƒ3,1,Dğ‘¥ğœƒ3,1,Gğ‘¥Input states|00âŸ©|01âŸ©|10âŸ©|11âŸ©ğ‘·ğŸof Q3XOR1001G0.890.090.100.93Ò§ğ‘†D,Gà´¤ğ¹ğ‘‰Ò§ğ‘†D,R5

[10] G. Carleo, I. Cirac, K. Cranmer, L. Daudet, M. Schuld,
N. Tishby, L. Vogt-Maranto, and L. Zdeborov, Rev. Mod.
Phys. 91, 045002 (2019).

[11] S. D. Sarma, D.-L. Deng, and L.-M. Duan, Physics Today

72, 48 (2019).

[12] J. Biamonte, P. Wittek, N. Pancotti, P. Rebentrost, N.

Wiebe, and S. Lloyd, Nature 549, 195 (2017).

[13] V. Dunjko and H. J. Briegel, Rep. Prog. Phys. 81, 074001

(2018).

[14] X. Gao, Z.-Y. Zhang, and L.-M. Duan, Science advances

4, eaat9004 (2018).

[15] A. Harrow and J. Napp,arXiv:1901.05374 (2019).
[16] V. Havlicek, A. D. Corcoles, K. Temme, A. W. Harrow,
A. Kandala, J. M. Chow, and J. M. Gambetta, Nature
567, 209 (2019).

[17] F. Arute, K. Arya, R. Babbush, D. Bacon, J. C. Bardin,
R. Barends, R. Biswas, S. Boixo, F. G. S. L. Brandao, D.
A. Buell, B. Burkett, Y. Chen, Z. Chen, B. Chiaro, R.
Collins, W. Courtney, A. Dunsworth, E. Farhi, B. Foxen,
A. Fowler, C. Gidney, M. Giustina, R. Graï¬€, K. Guerin,
S. Habegger, M. P. Harrigan, M. J. Hartmann, A. Ho,
M. Hoï¬€mann, T. Huang, T. S. Humble, S. V. Isakov, E.
Jeï¬€rey, Z. Jiang, D. Kafri, K. Kechedzhi, J. Kelly, P. V.
Klimov, S. Knysh, A. Korotkov, F. Kostritsa, D. Landhuis,
M. Lindmark, E. Lucero, D. Lyakh, S. Mandr, J. R. Mc-
Clean, M. McEwen, A. Megrant, X. Mi, K. Michielsen, M.
Mohseni, J. Mutus, O. Naaman, M. Neeley, C. Neill, M.
Y. Niu, E. Ostby, A. Petukhov, J. C. Platt, C. Quintana,
E. G. Rieï¬€el, P. Roushan, N. C. Rubin, D. Sank, K. J.
Satzinger, V. Smelyanskiy, K. J. Sung, M. D. Trevithick,
A. Vainsencher, B. Villalonga, T. White, Z. J. Yao, P. Yeh,
A. Zalcman, H. Neven, and J. M. Martinis, Nature 574,
505 (2019).

[18] M. Jarrod, R., B. Sergio, S. Vadim, N., B. Ryan, and N.
Hartmut, Nat. Commun. 9 (2018), 10.1038/s41467-018-
07090-4.

[19] M. Cerezo, A. Sone, T. Volkoï¬€, L. Cincio, and P. J. Coles,

arXiv:2001.00550 (2020).

[20] A. Skolik, J. R. McClean, M. Mohseni, P. Smagt, and M.

Leib, arXiv:2006.14904 (2020).

[21] P. Huembeli and A. Dauphin, arXiv:2008.02785 (2020).
[22] M. Schuld, V. Bergholm, C. Gogolin, J. Izaac, and N.

Killoran, Phys. Rev. A 99, 032331 (2019).

[23] K. Mitarai and K. Fujii, Physical Review Research 1,

013006 (2019).

[24] Supplementary-Materials.
[25] C. Song, K. Xu, H. Li, Y.-R. Zhang, X. Zhang, W. Liu,
Q. Guo, Z. Wang, W. Ren, J. Hao, H. Feng, H. Fan, D.
Zheng, D.-W. Wang, H. Wang, and S.-Y. Zhu, Science
365, 574 (2019).

[26] J. Preskill, Quantum 2, 79 (2018).

ACKNOWLEDGMENTS

Devices were made at the Nanofabrication Facilities at
Institute of Physics in Beijing and National Center for
Nanoscience and Technology in Beijing. The experi-
ment was performed on the quantum computing plat-
form at Zhejiang University. Funding: Supported
by National Basic Research Program of China (Grants
No. 2017YFA0304300, No. 2016YFA0302104 and No.
2016YFA0300600), National Natural Science Foundation
of China (Grants No. 11934018 and No. 11725419),
the Zhejiang Province Key Research and Development
Program (Grant No. 2020C01019), the start-up fund
from Tsinghua University (Grant No.
53330300320),
and Strategic Priority Research Program of Chinese
Academy of Sciences (Grant No. XDB28000000). Au-
thor contributions: Z.A.W, D.L.D. and H.F. proposed
the idea; supervised by Z.B.L, J.G.T and H.W., K.H.,
C.S., K.X. and Q.G. conducted the experiment; super-
vised by H.F., K.H. and Z.A.W. performed the numeri-
cal simulation; H.L. and D.Z. fabricated the device; K.H.,
Z.A.W., C.S., Z.W., D.L.D., H.W. and H.F. cowrote the
manuscript; and all authors contributed to the exper-
imental setup, discussions of the results, and develop-
ment of the manuscript. Competing interests: Au-
thors declare no competing interests. Data and ma-
terials availability: All data needed to evaluate the
conclusions in the paper are present in the paper or the
supplementary materials.

âˆ— These authors contributed equally to this work.
â€  liuzb@nankai.edu.cn
â€¡ dldeng@tshinghua.edu.cn
Â§ hfan@iphy.ac.cn

[1] I. Goodfellow, J. Pouget-Abadie, M. Mirza, B. Xu, D.
Warde-Farley, S. Ozair, A. Courville, and Y. Bengio, in
Advances in neural information processing systems (2014)
pp. 26722680.

[2] A. Creswell, T. White, V. Dumoulin, K. Arulkumaran,
B. Sengupta, and A. A. Bharath, IEEE Signal Processing
Magazine 35, 53 (2018).

[3] S. Lloyd and C. Weedbrook, Phys. Rev. Lett. 121,

040502(2018).

[4] P.-L. Dallaire-Demers and N. Killoran, Phys. Rev. A 98,

012324 (2018).

[5] J. Zeng, Y. Wu, J.-G. Liu, L. Wang, and J. Hu, Phys. Rev.

A 99, 052306 (2019).

[6] C. Zoufal, A. Lucchi, and S. Woerner, npj Quantum In-

formation 5, 103 (2019).

[7] L. Hu, S.-H. Wu, W. Cai, Y. Ma, X. Mu, Y. Xu, H. Wang,
Y. Song, D.-L. Deng, C.-L. Zou, and L. Sun, Science ad-
vances 5, eaav2761 (2019).

[8] J. Romero and A. Aspuru-Guzik, arXiv:1901.00848

(2019).

[9] A. Anand, J. Romero, M. Degroote, and A. Aspuru-Guzik,

arXiv:2006.01976 (2020).

Supplementary Material for
â€œRealizing a quantum generative adversarial
network using a programmable superconducting
processorâ€

DETAILS ABOUT THE QUANTUM DEVICE

Our experimental device is a superconducting circuit
consisting of 20 transmon qubits interconnected by a
central bus resonator with frequency ï¬xed at around
Ï‰R/2Ï€ â‰ˆ 5.51 GHz. Five qubits, denoted as Qj for j = 0
to 4, are actively used in this work. Each qubit has its
own microwave control and ï¬‚ux bias lines for implemen-
tations of XY and Z rotations respectively. Meanwhile,
each qubit is dispersively coupled to its own readout res-
onator for qubit-state measurement, and all the qubits
can be measured simultaneously using the frequency-
domain multiplexing technique. Details about the fab-
rication process, circuits layout, and quantum manipula-
tion of the device can be found in Ref. [1, 2].

Single-qubit operations and qubit-state measurements
are performed at each qubitâ€™s idle frequency Ï‰j,idle as
listed in Table S1. These frequencies are carefully ar-
ranged to minimize the crosstalk eï¬€ects. Other im-
portant parameters of the ï¬ve qubit are also listed in
Table S1, with their corresponding benchmarking data
shown in Fig. S1. Both the X and X/2 gates are de-
signed following the DRAG theory [3] with a length of
30 ns and a full width half maximum of 15 ns. Their
ï¬delities are no less than 0.9976 characterized by ran-
domized benchmarking (Fig. S1 (c)). Repeated readout
pulses, which are 1.5 Âµs in length, are demodulated at
room temperature, yielding the I âˆ’ Q points for each
qubit on the complex plane forming two blobs to diï¬€er-
entiate its states |0(cid:105) and |1(cid:105) (Fig. S1 (d)). The proba-
bilities of correctly reading out each qubit in |0(cid:105) and |1(cid:105)
monitored over 40 hours are shown in Fig. S1 (e), with
the corresponding mean values listed in Table S1.

MULTI-QUBIT ENTANGLING GATES

The multi-qubit entangling gates that comprise G and
D in our QGANs are generated by tuning all the involved
qubits on-resonance at around 5.165 GHz, which is de-
tuned from the resonator frequency by 345 MHz. Single-
qubit phase gates, which are realized by amplitude-
adjustable Z square pulses with a width of 20 ns, are
added on each qubit before and after the interaction pro-
cess to cancel out the dynamical phases accumulated dur-
ing it. In our experiment, the two- and three- qubit en-
tangling gates contain Q3, Q4 and Q1, Q2, Q3 respec-
tively. The characteristic interaction time tgate is ï¬xed
at Ï€/4|Î»|, where Î» is negative and approximately equals
to (cid:101)g2/âˆ†. (cid:101)g is deï¬ned as the average qubit-resonator cou-

6

Figure S1. Qubits characteristics. a, Qubit energy re-
laxation time measurement. The black solid lines are ï¬ts
for P1,j of Qi according to the exponential decay equation,
P1,j âˆ exp(âˆ’t/T1,j). b, Qubit Ramsey Gaussian dephas-
ing time measurement. The red dots are experimental data
with its envelope of Ramsey fringe ï¬tted by P âˆ—
1,j âˆ 0.5 +
2,j)2], shown by the black solid lines. c, RB
exp[âˆ’t/2T1,jâˆ’(t/T âˆ—
characterizing the ï¬delities of X/2 and X gates. Plotted are
the corrected |0(cid:105)-state probabilities of the ï¬ve qubits averaged
over k = 30 sequences for the reference (red), the X/2 gates
interleaved with the reference (green), and the X gates inter-
leaved with the reference (blue) as functions of the numbers
of gates. Dots are experimental data and lines are ï¬ts by the
exponential decay equation. d, The measured normalized I-Q
values in the I-Q plane, where blue (red) dots are obtained
by repetitively preparing the qubit in |0(cid:105) (|1(cid:105)) states and de-
modulating the corresponding readout signals. e, The |0(cid:105) and
|1(cid:105)-state measurement ï¬delities of the ï¬ve qubits with error
bars, denoted respectively by F0,j (blue) and F1,j(red) as a
function of training time.

pling strength and âˆ† denotes the detuning between the
interaction frequency and resonator frequency. Î»/2Ï€ are
around -2.48 MHz and -2.27 MHz for the two- and three-
qubit cases, respectively.

To characterize the obtained gates, quantum process
tomography (QPT) is performed by preparing a full set of
6n input states (cid:78)n
j {I, Â±X/2, Â±Y /2, X} (here n denotes
the number of qubits) and measuring the resulting out-
put states with quantum state tomography (QST). We
present the ideal and experimental process matrices Ï‡id
and Ï‡exp for the two- and three-qubit entangling gates in
Fig. S2 (a) and (b), ï¬nding the gate ï¬delities tr(Ï‡expÏ‡id)
of 0.9716Â±0.0110 and 0.9456Â±0.0154 respectively.

Q1Q2Q3Q4Q0P0, P1P1P0Norm. QF0, F1Delay (Âµs)Delay (Âµs)m-Number of gatesNorm. ITime (hour)Ref.X/2XabcdeQubits

Q0

Q1

Q2

Q3

Q4

Ï‰j,idle/2Ï€
(GHz)

T1,j (Âµs)
T âˆ—

2,j (Âµs)

5.220

5.055

5.105

5.165

5.000

28.8

2.4

32.2

2.0

38.2

1.8

42.4

2.5

38.8

1.7

X/2 ï¬delity

0.9992

0.9983

0.9990

0.9991

0.9992

X ï¬delity

0.9984

0.9976

0.9988

0.9979

0.9990

F0,j

F1,j

0.982

0.990

0.986

0.988

0.982

0.938

0.933

0.941

0.939

0.944

Table S1. Qubits characteristics. Ï‰j,idle is the idle fre-
quency of Qj where single-qubit state preparation and mea-
surement are implemented. Typical coherence parameters of
the j-th qubit (Qj), including energy relaxation time T1,j and
Ramsey Gaussian dephasing time T âˆ—
2,j are measured at the
idle frequency, respectively. Fidelities of the X/2 and X gates
on Qj are characterized by randomized benchmarking at its
idle frequency Ï‰j,idle. F0,j (F1,j) is the typical |0(cid:105) (|1(cid:105))-state
measurement ï¬delity for Qj, which is then used to correct
the measured qubit probabilities for eliminating the readout
errors.

Figure S2. Process matrices for entangling gates. The
real and imaginary components of the experimental Ï‡exp
(solid bars) and ideal Ï‡ideal (black frames) for the multi-qubit
entangling gates are shown in the left and right panels. The
ï¬delities are 0.9716Â±0.0110 and 0.9456Â±0.0154 for the two-
qubit (a) and three-qubit (b) entangling gates, respectively.

7

Figure S3. Process matrices of two-qubit gates. a, The
unitary matrix of the two-qubit Uphase gate. b, The quan-
tum circuit for constructing the CNOT gate, which consists
of a Uphase gate and six single-qubit gates. The ï¬rst (above)
qubit acts as the control qubit. c, The quantum circuit for
constructing the CZ gate, which consists of a Uphase gate and
eight single-qubit gates. The ï¬rst qubit acts as the control
qubit. d, e, f, & g The real components of the process matri-
ces Ï‡exp (solid bars) and ideal Ï‡ideal (black frames) of Uphase
(left), CNOT (middle) and CZ (right) gates obtained by QST
for diï¬€erent pairs of qubits, i.e., Q0-Q1, Q0-Q2, Q0-Q3, and
Q0-Q4. The ï¬rst qubit in the pairs always acts as the control
qubit. All process ï¬delities calculated by tr(Ï‡expÏ‡ideal) can
be found in Table S2.

(c). The experimental realization of the Uphase gate can
be found in Ref. [4]. For diï¬€erent pairs of qubits, the
Uphase gates have lengths of 159, 141, 170, and 162 ns
respectively.
Ideal and experimental process matrices
for all the related gates measured by QPT are shown
in Fig. S3 (d) to (g), with the corresponding ï¬delities
listed in Table S2.

THE GRADIENT VERIFICATION

TWO-QUBIT CONTROLLED GATES

Two types of controlled gates,

i.e., controlled-X
(CNOT) and controlled-Z (CZ) gates, are frequently used
to fulï¬ll the quantum gradient subroutine in QGANs.
Both gates are made from a two-qubit phase gate Uphase
whose unitary matrix is shown in Fig. S3 (a), combined
with some single-qubit gates as shown in Fig. S3 (b) and

The gradient is a critical ingredient required in the op-
timization procedure of generative adversarial networks
(GANs). In this work, a quantum algorithm known as
the Hadamard test is implemented experimentally for the
ï¬rst time to obtain the gradient. Now we introduce the
basic idea of this algorithm.

A general parameterized quantum circuit for a multi-

0.50-0.50.50-0.5IXYZğ‘…ğ‘…ğ‘…ğ‘…(ğœ’ğœ’)ğ¼ğ¼ğ¼ğ¼(ğœ’ğœ’)ğ‘…ğ‘…ğ‘…ğ‘…(ğœ’ğœ’)ğ¼ğ¼ğ¼ğ¼(ğœ’ğœ’)abIXYZ-0.500.512100ğ‘–ğ‘–01ğ‘–ğ‘–00ğ‘–ğ‘–10ğ‘–ğ‘–001UphaseCNOTCZğ‘ˆğ‘ˆğ‘ğ‘ğ‘ğ‘ğ‘ğ‘ğ‘ğ‘ğ‘âˆ’ğ‘Œğ‘Œ/2âˆ’ğ‘Œğ‘Œâˆ’ğ‘‹ğ‘‹/2ğ‘Œğ‘Œ/2âˆ’ğ‘‹ğ‘‹/2ğ‘Œğ‘Œğ‘ˆğ‘ˆğ‘ğ‘ğ‘ğ‘ğ‘ğ‘ğ‘ğ‘ğ‘ğ‘Œğ‘Œ/2âˆ’ğ‘‹ğ‘‹/2ğ‘Œğ‘Œ/2âˆ’ğ‘‹ğ‘‹/2ğ‘Œğ‘Œğ‘Œğ‘Œ/2ğ‘‹ğ‘‹ğ‘‹ğ‘‹adbcfgeQ0 - Q1Q0 - Q2Q0 - Q3Q0 - Q4Gate name

Ï‰I /2Ï€ (GHz)

FU

Fcnot

Fcz

Q0-Q1

Q0-Q2

Q0-Q3

Q0-Q4

5.050

5.105

5.165

5.000

0.9622Â±0.0059

0.9535Â±0.0062

0.9400Â±0.0061

0.9760Â±0.0052

0.9446Â±0.0082

0.9499Â±0.0055

0.9719Â±0.0102

0.9575Â±0.0049

0.9629Â±0.0048

0.9656Â±0.0065

0.9554Â±0.0058

0.9427Â±0.0099

8

Table S2. Fidelities of two-qubit quantum logical gates. Ï‰I is the working point of the Uphase gate. FU , Fcnot, and Fcz
denote the process ï¬delities of Uphase, CNOT, and CZ gates obtained by QPT, respectively.

measure the partial derivative of (cid:104)O(cid:105) with respect to Î¸j
is shown in the circuit of Fig. S4 (b). For the input state
|0(cid:105) âŠ— |Ïˆ(cid:105), the corresponding output state of the circuit is

1
2

(|0(cid:105) âŠ— (UN :1 + iOUN :j+1hjUj:1)|Ïˆ(cid:105)

+|1(cid:105) âŠ— (UN :1 âˆ’ iOUN :j+1hjUj:1)|Ïˆ(cid:105)) .

(S1)

The expectation value of the ancillary qubitâ€™s Ïƒz is given
by

(cid:104)Ïƒz(cid:105) =

(cid:104)

(cid:104)Ïˆ|U â€ 
1;j

i
2

U â€ 

j+1:N OUN ;j+1, hj

(cid:105)

Uj:1|Ïˆ(cid:105)

= âˆ’

âˆ‚
âˆ‚Î¸j

(cid:104)O(cid:105)

(S2)

The proof of the last equation can be found in Ref. [5].
As such, the partial derivative of (cid:104)O(cid:105) can be measured as
âˆ’(cid:104)Ïƒz(cid:105) of the ancillary qubit.
In our experiment, since
the parameterized unitaries are all single-qubit gates,
only two-qubit controlled gates are required to obtain
the quantum gradient (QG). Nevertheless, the ability to
realize two-qubit controlled gates between the ancillary
qubit and all the other qubits in the system is still a non-
trivial task and relies on the all-to-all connectivity of the
quantum processor.

We test the QG approach with a simple parameter-
ized quantum circuit as shown in Fig. S5 (a), where we
ï¬rst rotate Q1 around the x-axis by an angle Î¸ and then
measure its (cid:104)Ïƒz
1(cid:105). Our goal is to measure the gradient
1(cid:105) with respect to Î¸, i.e., âˆ‚(cid:104)Ïƒz
of (cid:104)Ïƒz
1(cid:105)/âˆ‚Î¸. The variation
of (cid:104)Ïƒz
1(cid:105) versus Î¸ is directly measured, with the results
shown in Fig. S5 (b). Based on this measurement, we
can calculate âˆ‚(cid:104)Ïƒz
1(cid:105)/âˆ‚Î¸ by the CLCU approach, and the
In comparison, we can
result is shown in Fig. S5 (d).
also calculate the gradient by adopting the QG circuit
as shown in Fig. S5 (c) and measure (cid:104)Ïƒz
0(cid:105) of Q0. The
gradient can be obtained by âˆ‚(cid:104)Ïƒz
0(cid:105) with the
results shown in Fig. S5 (d). Due to the inï¬delities of
our two-qubit controlled gates, the quantum gradient is
slightly smaller than the ideal value. In practice, there
may be a delay between the two controlled gates which
will introduce a dephasing error to Q0 and aï¬€ect the ac-
curacy of QG. Such an error can be reduced experimen-
tally by the single-qubit dynamical decoupling (1Q-DD)
technique [4], which is realized by applying a continuous

1(cid:105)/âˆ‚Î¸ = âˆ’(cid:104)Ïƒz

Figure S4. Hadamard test. a, Parameterized quantum
circuit. The system consists of a bunch of qubits and is ini-
tialized in |Ïˆ(cid:105). N unitaries, which are denoted as UN :1 =
UN UN âˆ’1 Â· Â· Â· Uj Â· Â· Â· U2U1, are applied to the system sequen-
tially. Each unitary is parameterized by Uj = eâˆ’ i
2 Î¸j hj , where
hj = hâ€ 
j is the Hamiltonian of the operation. The expectation
value of an observable O is measured at the end of the circuit.
b, An instance circuit of Hadamard test, which is executed
by introducing an ancillary qubit. To measure the gradient of
(cid:104)O(cid:105) with respect to Î¸j, a controlled-hj gate is inserted after
Uj, and a controlled-O gate is appended at the end of the
parameterized quantum circuit. The gradient is encoded in
the expectation value (cid:104)Ïƒz(cid:105) of the ancillary qubit as explained
in the text.

2 Î¸j hj where hj = hâ€ 

qubit system is depicted in Fig. S4 (a). The circuit con-
sists of N unitaries labeled as Uj for j = 1 to N and
outputs the expectation value of an observable O. Uj
can be written as eâˆ’ i
j is the Hamil-
tonian of the system during the operation. Our goal is
to measure âˆ‡(cid:126)Î¸(cid:104)O(cid:105), i.e., the gradient of (cid:104)O(cid:105) with respect
to (cid:126)Î¸, where (cid:126)Î¸ = [Î¸1, Î¸2, ..., Î¸j, ..., Î¸N ]. According to the
parameter shift rules, we can measure the analytic gra-
dient with the â€˜classical linear combinations of unitaries
(CLCU)â€™ method [6] which requires the direct detection
of (cid:104)O(cid:105).

Alternatively, we can add an ancillary qubit and mea-
sure the gradient indirectly by the Hadamard test al-
gorithm. An instance circuit of the Hadamard test to

ğ»ğ‘ˆğ‘—:1ğ‘ˆğ‘:ğ‘—+1ğ»ğ‘‹/2â„ğ‘—ğ‘‚|ğœ“âŸ©|0âŸ©âŸ¨ğœğ‘§âŸ©|ğœ“âŸ©ğ‘ˆğ‘:1âŸ¨ğ‘‚âŸ©ğ‘’âˆ’ğ‘–2ğœƒ1â„1â€¦â€¦â€¦abâ€¦â€¦â€¦ğ‘’âˆ’ğ‘–2ğœƒ2â„2ğ‘’âˆ’ğ‘–2ğœƒğ‘â„ğ‘microwave drive resonantly on the qubit with a Ï€-phase
shift in the middle. To check that, we deliberately intro-
duce a delay of Ï„ = 800 ns in between the two controlled
gates, and compare the results with and without the 1Q-
DD protection. The Rabi frequency of the driving ï¬eld
in 1Q-DD is set to â„¦/2Ï€ = 2 MHz in the experiment. An
obvious enhancement is observed as expected.

ing the time between two controlled gates, we implement
1Q-DD technique on Q0 to protect it from dephasing as
introduced in the previous section.

9

Figure S6. Pulse sequence for measuring QG. Shown
are the control signals of all ï¬ve qubits for measuring the
gradient of (cid:104)Ïƒz
1 (cid:105) with respect to the angle of Q1â€™s XY rotation,
which corresponds to the pulse in the dashed circle. The two-
qubit controlled gates, including CNOT and CZ, are located
in the semitransparent blue blocks, while the two- and three-
qubit entangling gates are covered by the semitransparent red
In the yellow block, two weak microwave driving
shadows.
ï¬elds with opposite phases are applied successively to protect
Q0 from dephasing. The Rabi frequency of the driving ï¬eld
is set to â„¦/2Ï€ = 2 MHz in the experiment.

1 (cid:105) with respect to Î¸, i.e., âˆ‚(cid:104)Ïƒz

Figure S5. Gradient veriï¬cation. a, A simple parameter-
ized quantum circuit for testing QG. Our goal is to measure
the gradient of (cid:104)Ïƒz
1 (cid:105)/âˆ‚Î¸. b, Ex-
perimental (blue squares) and ideal (red line) results for run-
ning the parameterized quantum circuit with diï¬€erent Î¸. The
values of âˆ‚(cid:104)Ïƒz
1 (cid:105)/âˆ‚Î¸ can be calculated by the classical linear
combination of unitaries (CLCU) or quantum gradient (QG)
approach. c, The circuit for measuring gradient with QG
approach. d, Results for the gradients measured in diï¬€erent
cases. Except for the ideal gradient (red line) and that calcu-
lated by the CLCU approach (blue squares), we also present
the experimental results computed by the QG circuit for Ï„ =
0 ns (black squares), Ï„ = 800 ns without (green squares) and
with (cyan squares) 1Q-DD protection respectively.

PULSE SEQUENCES FOR MEASURING THE
QUANTUM GRADIENT

The pulse sequence for measuring the gradient of (cid:104)Ïƒz
1(cid:105)
to Î¸x
1,1,D â€“ the ï¬rst parameter of Q1 in D â€“ during the
training process of XOR gate is shown in Fig. S6. Dur-

STABILITY DURING TRAINING

The stabilities of qubit operations are of great impor-
tance for the successful running of our QGANs. Except
for the readout ï¬delities as shown in Fig. S1 (e), we also
monitor the performances of multi-qubit gates during a
40-hour training time. Instead of benchmarking the gates
by QPT which is rather time-consuming, we select sev-
eral representative states as inputs and monitor the cor-
responding output states by measuring the probabilities
of all the qubits in |1(cid:105). The results for the Uphase gates
on four pairs of qubits, i.e., Q0-Q1, Q0-Q2, Q0-Q3 and
Q0-Q4, are presented in Fig. S7 (a)-(d). The variations of
probabilities for all those gates are no more than 0.036.
The results for two- and three-qubit entangling gates ap-
plied on Q3-Q4 and Q1-Q2-Q3 are shown in Fig. S7 (e)
and (f), with the variations of probabilities being 0.063
and 0.057 respectively. All results show that the per-
formance of our multi-qubit gates is suï¬ƒciently stable
during the QGANs training.

Q10ğ‘¹ğ‘¿(ğœƒ)âŒ©ğœ1ğ‘§âŒªağœ1ğ‘§cğœƒ(rad)ğœƒ(rad)âˆ’ğœ0ğ‘§ğœ=0 nsğœ=800 ns; no protectionğœ=800 ns; with protectionIdealCLCUIdealExp.Q00ğ‘¿ğ‘¹ğ‘¿(ğœƒ)ğ’ğ‘¯ğ‘¿/ğŸâŒ©ğœ0ğ‘§âŒªQ10ğœprotectionğ‘¯dbgeneratordiscriminatorCNOTCZprotectionTTime (ns)Q0XYQ0ZQ1XYQ1ZQ2XYQ2ZQ3XYQ3ZQ4XYQ4Z05001000150010

âˆ— These authors contributed equally to this work.
â€  liuzb@nankai.edu.cn
â€¡ dldeng@tshinghua.edu.cn
Â§ hfan@iphy.ac.cn

[1] C. Song, K. Xu, H. Li, Y.-R. Zhang, X. Zhang, W. Liu,
Q. Guo, Z. Wang, W. Ren, J. Hao, H. Feng, H. Fan, D.
Zheng, D.-W. Wang, H. Wang, and S.-Y. ZhuScience 365,
574-577 (2019).

[2] C. Song, K. Xu, W. Liu, C.-P Yang, S.-B. Zheng, H. Deng,
Q. Xie, K. Huang, Guo, L. Zhang, P. Zhang, D. Xu, D.
Zheng, X. Zhu, H. Wang, Y.-A. Chen, C.-Y. Lu, S. Han,
and J-W. Pan, Phys. Rev. Lett. 119, 180511 (2017).
[3] F. Motzoi, J. M. Gambetta, P. Rebentrost, and F. K. Wil-

helm.Phys. Rev. Lett. 103, 110501 (2009).

[4] Q. Guo, S.-B. Zheng, J. Wang, C. Song, P. Zhang, K. Li,
W. Liu, H. Deng, K. Huang, D. Zheng, X. Zhu, H. Wang,
C.-Y. Lu, and J.-W. Pan, Phys. Rev. Lett. 121, 130501
(2018).

[5] P.-L. Dallaire-Demers, N. Killoran. Phys. Rev. A 98,

012324 (2018).

[6] M. Schuld, V. Bergholm, C. Gogolin, J. Izaac and N. Kil-

loran. Phys. Rev. A 99, 032331 (2019).

Figure S7. Gates stabilities during the training period.
Shown are the experimental data for monitoring the stabil-
ities of the two-qubit Uphase gates (a, b, c & d) and two
entangling gates (e & f ) during a 40-hour training time. For
each gate, we select four representative states as inputs and
measure the probabilities of the output states with all qubits
in |1(cid:105). The input states are denoted by the operations that
prepare them from the initial ground state.

P1Time (hour)abcdefQ0-Q1Q0-Q2Q0-Q3Q0-Q4Q3-Q4Q1-Q2-Q3