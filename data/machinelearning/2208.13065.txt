Improving Electricity Market Economy via
Closed-Loop Predict-and-Optimize

Xianbang Chen, Student Member, IEEE, Yikui Liu, Member, IEEE, Lei Wu, Fellow, IEEE

1

2
2
0
2

g
u
A
7
2

]

C
O
.
h
t
a
m

[

1
v
5
6
0
3
1
.
8
0
2
2
:
v
i
X
r
a

Abstract—The electricity market clearing is usually implemented
via an open-loop predict-then-optimize (O-PO) process: it ﬁrst
predicts the available power of renewable energy sources (RES)
and the system reserve requirements; then, given the predictions,
the markets are cleared via optimization models, i.e., unit com-
mitment (UC) and economic dispatch (ED), to pursue the optimal
electricity market economy. However, the market economy could
suffer from the open-loop process because its predictions may
be overly myopic to the optimizations, i.e., the predictions seek
to improve the immediate statistical forecasting errors instead of
the ultimate market economy. To this end, this paper proposes
a closed-loop predict-and-optimize (C-PO) framework based on
the tri-level mixed-integer programming, which trains economy-
oriented predictors tailored for the market-clearing optimization
to improve the ultimate market economy. Speciﬁcally, the upper
level trains the economy-oriented RES and reserve predictors
according to their induced market economy; the middle and lower
levels, with given predictions, mimic the market-clearing process
and feed the induced market economy results back to the upper
level. The trained economy-oriented predictors are then embedded
into the UC model, forming a prescriptive UC model that can
simultaneously provide RES-reserve predictions and UC decisions
with enhanced market economy. Numerical case studies on an
IEEE 118-bus system illustrate potential economic and practical
advantages of C-PO over O-PO, robust UC, and stochastic UC.

Index Terms—Predict-and-optimize, unit commitment, prescrip-

tive analytics, bilevel/tri-level mixed-integer programming.

NOMENCLATURE

Set/index of branches.
Set/index of enumerations (iterations).
Set/index of units. I = I nqs ∪ I qs.
Set of non-quick-start/quick-start units.
Set/index of RESs.
Set/index of generation segments.
Set/index of load buses.
Set/index of training scenarios.
Set/indexes of hours.
Set deﬁned as {T su

, · · · , T }/{T sd

i

, · · · , T }.

i

Sets and Indexes
B/b
E/e
I/i
I nqs/I qs
J /j
K/k
Q/q
S/s
T /t, t(cid:48)
i /T sd
T su
Decision Variables
Dit/Uit
Iit/Oit

i

Shutdown/startup status of unit i at hour t.
Unit commitment/non-spinning reserve (NR)
provision status of unit i at hour t.
Generation schedule of unit i at hour t.
Schedule of unit i in segment k at hour t.
Vector of reserve schedule decisions in UC.
Spinning reserve (SR)/NR schedule of unit i at
hour t.

bt, S4

bt Slack variables.

Predictor of RES power/reserve requirements.
Generation schedule of RES j at hour t.
Vector of binary decisions in UC.

Pit
P seg
itk
r
Rsr

it /Rnr
it

t , S3
t , S2
S1
W(·)/R(·)
Wjt
x

y

z
·ed
·dv/·ev/·gv

Parameters
Bb
C seg
ik
i /C nl
C su
i
C sr
i /C nr
i
C 1, C 2, C bs
Fb(·)
ˆLqt/ ˜Lqt

/P max
i

N H/N T
P w/P r
P min
i
¯P seg
ik
i /Rsd
Rsu
i
Rup
i /Rdn
i
i / ¯Rnr
¯Rsr
i
t / ˆRnr
ˆRsr

t

T
i /T sd
T su
i
ˆw(cid:5)/ˆr(cid:5)
ˆWjt/ ˜Wjt

| · |

Vector of continuous decisions in UC excluding
r.
Vector of ED decisions.
Decision variables in ED.
Duplicated/enumerated/generated variables.

Transmission capacity of branch b.
Generation cost of unit i in segment k.
Startup/no-load cost of unit i.
SR/NR cost of unit i.
Penalty costs of slack variables.
Power ﬂow function of branch b.
Predicted/actual demand of load q at hour t,
whose vector is ˆl/˜l.
Number of historical/training scenarios.
Feasible region of predictor W(·)/R(·).
Minimum/maximum generation of unit i.
Power limit of unit i at segment k.
Startup/shutdown ramping capacity of unit i.
Upward/downward ramping capacity of unit i.
SR/NR limit of unit i.
Predicted SR/NR requirement at hour t, which
together form the vector ˆr.
Total number of hours.
Minimum on/off time requirement of unit i.
Tailored counterpart of raw prediction ˆw/ˆr.
Predicted/actual available power of RES j at
hour t, whose vector is ˆw/ ˜w.
Cardinality of a set.

I. INTRODUCTION

E LECTRICITY market clearing plays an important role in

guaranteeing the operational economy of power systems
[1]. Aiming to achieve the optimal market economy (i.e., max-
imizing the social welfare or minimizing the system cost), the
electricity markets are generally cleared by Independent System
Operators (ISO) via an open-loop predict-then-optimize (O-PO)
framework, as shown in Fig. 1(a):

•

•

•

Available power of renewable energy sources (RES) as well
as system spinning reserve (SR) and non-spinning reserve
(NR) requirements are predicted.
Taking the predictions as inputs, ISOs solve a deterministic
unit commitment (UC) problem [2] to clear the day-ahead
electricity market.
Based on the UC decisions, ISOs tackle an economic
dispatch (ED) problem [3] to clear the real-time electricity
market1 in the face of actual available RES power.

The authors are with the ECE Department, Stevens Institute of Technology,

Hoboken, NJ, 07030 USA. (Email: xchen130, yliu262, lei.wu@stevens.edu)

1Note that only the ex-post market clearing is considered in this paper for
the real-time market, while multiple intra-day and real-time UC runs adopted in
certain markets are ignored.

 
 
 
 
 
 
2

Fig. 1. Comparison of O-PO, C-PO in our previous work [19], and enhanced C-PO in this paper.

Although O-PO seems practically reasonable, it suffers from
two ﬂaws. First, the RES predictions simply pursue statistical
accuracy, such as mean absolute error (MAE). However, due
to inherent nonlinearity, a statistically more accurate prediction
may not necessarily induce a higher market economy [4].
Second, the reserve requirements sized by traditional rule-of-
thumb methods could be overly conservative and further worsen
market economy [5]. Thus, the predictions in O-PO are regarded
as raw because they are myopic to the optimization tasks.

To improve the market economy, a common way is to augment
the deterministic UC to its two-stage stochastic programming (T-
SP) [6] or two-stage robust optimization (T-RO) [7] counterpart.
Another emerging way is to feed the optimization information
back to the prediction phase, seeking for cost-oriented predic-
tors that can fundamentally improve the economy. Pioneering
methodologies have been explored in this direction, such as the
prescriptive framework [8], the regression method [9], and the
smart predict-then-optimize (SPO) approach [10]. In a nutshell,
these approaches intend to close the loop between the prediction
and the optimization through a feedback path, hence referred to
as the closed-loop predict-and-optimize (C-PO).

Indeed, the C-PO idea has been recently applied in electricity
markets. References [11] and [12] train decision trees to predict
available RES power for RES producers, which use the RES
instead of entropy to evaluate the prediction
trading proﬁt
quality. Similarly, [13]–[15] train neural networks to predict RES
power for RES trading [13], load for ED [14], and electricity
price for energy storage system arbitrage [15], in which the train-
ing loss functions explicitly consider the economy loss induced
by the predictions. All the references [11]–[15] demonstrate
that tailoring the raw predictions for targeted optimization tasks
can improve the economy noticeably, although the statistical
accuracy may be slightly compromised.

Rather than grounding on heuristic methods as [11]–[15],
references [16]–[19] use mathematical programming as the
underlying methodology to implement
the C-PO. The core
of [16]–[19] is to construct an empirical risk minimization
(ERM) problem that integrates both the predictor training and
optimization tasks, which is then solved to obtain the globally
optimal predictors. By solving an ERM problem, [16] trains
an extreme learning machine that can size the SR requirements
economically. By solving a regression-based ERM, [17] obtains
an optimal linear decision rule that maps the raw RES predic-
tions to the proﬁt-oriented predictions for RES trading. The same
authors further use an analogous idea to train value-oriented load
predictors for ED in [18]. Different from [16]–[18] which focus
on linear programming (LP) tasks, our previous work [19], as
shown in Fig. 1(b), constructs a SPO-type ERM for the mixed-
integer programming (MIP)-based UC that yields a cost-oriented
RES predictor tailored for the market-clearing optimization.

predictor training and in-sample optimization to share exactly
the same objective function. As a result, this restriction would
compromise the in-sample optimization model, disobeying the
least-cost merit-order principle (which will be detailed in Sec-
tion II-B2). Feeding these compromised optimization informa-
tion back to training could lead to an over-ﬁtted predictor.

In fact, this issue could be resolved by leveraging multi-
level (e.g., bilevel and tri-level) programming to construct the
ERM—modeling the predictor training in the upper level while
uncompromisingly formulating the optimization tasks in the
lower levels. Following this spirit, [20] and [21] respectively
enhance their previous single-level ERMs in [16] and [17] via
bilevel LP. Similarly, [22]–[24] utilize bilevel LP to construct
ERM and train cost-oriented SR predictors for ED.

Table I summarizes the above C-PO applications [11]–[24].
It is noteworthy that those market-related applications merely
utilize LP-based ED models and/or exclusively predict SR
requirements, ignoring the quick-start units with NR capabilities
that can support the practical ED task.

To this end, this paper presents a C-PO framework, as in
Fig. 1(c), to predict RES-SR-NR and optimize market opera-
tions. A tri-level MIP-based ERM problem is ﬁrst constructed, in
which the upper level trains the predictors for RES power as well
as SR and NR requirements, while the middle and lower levels,
formulated as MIP problems, mimic the UC-ED market-clearing
process to calculate the optimal system cost with respect to given
predictions from the upper level. The system cost is fed back
to the upper level for assessing and improving the prediction
quality. The ERM is converted into a bilevel MIP and then
solved by a reformulation and decomposition (R&D) method
[25] to deliver the optimally trained predictors of RES, SR, and
NR. Finally, the predictors are embedded into the deterministic
UC, forming a prescriptive UC model that delivers cost-oriented
RES-SR-NR predictions and UC decisions simultaneously.

The major works in this paper are summarized as follows:

•

•

•

To improve the electricity market economy, a C-PO frame-
work is presented. The core is to leverage tri-level MIP in
constructing an ERM problem, in which RES-SR-NR pre-
dictions and the market-clearing optimization are integrated
in a closed-loop structure without compromise.
The ERM problem is converted into a tractable bilevel MIP
and then solved by a R&D method [25]. Solving the ERM
provides the cost-oriented predictors tailored for the market-
clearing optimization.
Based on an IEEE 118-bus system with real-world data
from the Belgian ISO [26], the proposed C-PO is compared
to O-PO and T-SP/T-RO with MIP recourse, and sensitivity
analysis is also conducted. To improve the transparency and
reproducibility of this paper, all the testing data and source
codes are made publicly accessible at [27].

Although the methods in [16]–[19] are regarded as stable
and interpretable, their single-level ERM structures require the

The rest of the paper is organized as follows: Section II
details the necessary preliminaries and motivations; Section III

(a). Traditional open-loop predict-then-optimize.Rule-of-Thumb(Raw)Reserve RequirementAccuracy-Oriented(Raw)RES PredictionUCDecisionsPredictionOptimizationOptimizationSolvingUCSolvingEDRESReserveTask:Day-AheadMarketClearingTask:Real-TimeMarketClearing(b). Previous closed-loop predict-and-optimize in [19].Rule-of-Thumb(Raw)Reserve RequirementCost-Oriented(Tailored)RES PredictionUCDecisionsPredictionOptimizationOptimizationSolvingUCSolvingEDRESReserveTask:Day-AheadMarketClearingTask:Real-TimeMarketClearing(c). Enhanced closed-loop predict-and-optimize in this paper.Cost-Oriented(Tailored)Reserve RequirementCost-Oriented(Tailored)RES PredictionUCDecisionsPredictionOptimizationOptimizationSolvingUCSolvingEDRESReserveTask:Day-AheadMarketClearingTask:Real-TimeMarketClearingUCCostActual System CostMethodology Property

ERM Construction

Heuristic

-

Mathematical
Programming

Single-Level Model

Bilevel LP

TABLE I
REVIEW OF C-PO APPLICATIONS IN ELECTRICITY MARKETS
Methodology

Reference

Prediction

[11]
[12]
[13]
[14]
[15]

[16]
[17]
[18]
[19]

[20]
[21]
[22]
[23]
[24]

Regression Tree
Classiﬁcation Tree [8]
Artiﬁcial Neural Network
Deep Neural Network
Deep Neural Network

Extreme Leaning Machine
Linear Regression [9]
Linear Regression
Linear Regression [10]

Extreme Leaning Machine
Linear Regression
Linear Regression
Linear Regression
Linear Regression

RES Power
RES Power
RES Power
Load
Energy Price

RES Power and SR
RES Power
Load
RES Power

RES Power
RES Power
Load and SR
SR
SR and Transmission Capacity

3

Optimization

Type

RES Trading
RES Trading
RES Trading
ED
Storage Arbitrage

Reserve Sizing
RES Trading
ED
UC

ED
RES Trading
ED
ED
ED

LP
LP
LP
LP
MIP

LP
LP
LP
MIP

LP
LP
LP
LP
LP

Tri-Level MIP

This paper

Linear Regression

RES Power, SR, and NR

UC and ED

MIP

expounds the C-PO framework; Section IV analyzes the exper-
imental results; and Section V concludes this paper.

II. PRELIMINARIES AND MOTIVATIONS

A. Preliminaries

1) UC Model: The UC problem is formulated as a MIP
model
in (1). The objective (1.1) is to minimize the total
operation cost including startup, no-load, generation, SR, and
NR costs. The generator constraints include generation limits
(1.2)-(1.3), segment-based generation representation (1.4)-(1.5),
SR (1.6) and NR (1.7) capacities, startup-shutdown-commitment
status logic (1.8), minimum on and off requirements (1.9)-(1.10),
ramping limits (1.11)-(1.12), and RES power limitation (1.13).
Constraints (1.14)-(1.15) mean that only the ofﬂine quick-start
units can provide NR. Constraint (1.16) is the integrality require-
ment. System constraints include system reserve requirements
(1.17)-(1.18), power balance (1.19), and DC power ﬂow-based
transmission limits (1.20). Vector x represents UC variables I,
U , D, and O; vector r represents SR and NR variables Rsr and
Rnr; and all other variables are contained in vector y.
(cid:41)

(cid:40) C su

i Uit + C nl
i Rsr

i Iit + (cid:80)
k
i Rnr
it

it + C nr

∈K

C seg
ik P seg

itk

(1.1)

(cid:80)

(cid:80)

min
x,y,r

i

t

∈T

Iit
Iit

+ C sr
i
∈I
Generator Constraints:
Pit − Rsr
it ≥ P min
Pit + Rsr
it ≤ P max
i
Pit = (cid:80)
P seg
k
itk
0 ≤ P seg
itk ≤ ¯P seg
ik Iit
it ≤ ¯Rsr
0 ≤ Rsr
i Iit
it ≤ ¯Rnr
P min
i Oit ≤ Rnr
Uit − Dit = Iit − Ii,t
(cid:80)t

∈K

−

i Oit
1

−

−

t(cid:48)=t

(cid:80)t

Pi,t

1) + Rup

i +1 Uit(cid:48) ≤ Iit
T su
i +1 Dit(cid:48) ≤ 1 − Iit
T sd
t(cid:48)=t
Pit − Pi,t
+Rsu

1 ≤ P max
i
−
i (Iit − Ii,t
1 − Pit ≤ P max
i (Ii,t
0 ≤ Wjt ≤ ˆWjt
Oit + Iit ≤ 1
Oit = 0
Iit, Uit, Dit, Oit ∈ {0, 1}

1 − Iit) + Rdn

(1 − Iit)
i Ii,t
(1 − Ii,t
−
i Iit

−
+Rsd

−
i

−

1
−
1)

∀t ∈ T , i ∈ I
(1.2)
∀t ∈ T , i ∈ I
(1.3)
∀t ∈ T , i ∈ I
(1.4)
∀t ∈ T , i ∈ I, k ∈ K (1.5)
∀t ∈ T , i ∈ I
(1.6)
∀t ∈ T , i ∈ I
(1.7)
∀t ∈ T , i ∈ I
(1.8)
∀t ∈ T su
(1.9)
∀t ∈ T sd

, i ∈ I

, i ∈ I

(1.10)

i

i

∀t ∈ T , i ∈ I

(1.11)

∀t ∈ T , i ∈ I
∀t ∈ T , j ∈ J
∀t ∈ T , i ∈ I
∀t ∈ T , i ∈ I nqs
∀t ∈ T , i ∈ I

(1.12)
(1.13)
(1.14)
(1.15)
(1.16)

System Constraints:
(cid:80)
i
(cid:80)
i
(cid:80)
i

Rsr
(Rsr
Pit + (cid:80)

it ≥ ˆRsr
it + Rsn

∈I

∈I

t

it ) ≥ ˆRsr

t + ˆRnr

t

Wjt = (cid:80)

∀t ∈ T
∀t ∈ T
ˆLqt ∀t ∈ T

j
∈J
∈Q
−Bb ≤ Fb(Pit, Wjt, ˆLqt) ≤ Bb

∈I

q

∀t ∈ T , b ∈ B

(1.17)
(1.18)
(1.19)

(1.20)

The UC model (1) can be represented in a compact form
(2), in which F (·) and G(·) respectively represent the sets of
equality and inequality constraints of (1).

a(cid:62)x + b(cid:62)y + c(cid:62)r

min
x,y,r
s. t. (x, y, r) ∈ X ( ˆw, ˆr)

(cid:26)

X ( ˆw, ˆr) =

(x, y, r)

F (x, y) = 0
G(x, y, r, ˆw, ˆr) ≤ 0

(cid:27)

(2.1)

(2.2)

(2.3)

Taking the predictions ˆw and ˆr as inputs, UC is solved to
deliver the optimal solutions of startup, commitment, base-point
generation, SR schedule, and NR schedule to ED.

2) ED Model: Taking the UC solutions and the actual RES re-
alization ˜w as inputs, the ED is modelled as a MIP in (3), where
·(cid:63) indicates the optimal solution from UC. The objective (3.1) is
to minimize startup and no-load costs of quick-start units that are
not committed in UC but scheduled for providing NR, generation
costs of all units, as well as slack penalty costs. Constraints (3.2)-
(3.3) mean that only the quick-start units not committed in UC
may change their statuses. All units are subjected to generation
limits (3.4)-(3.7), dispatch adjustment limitation (3.8), ramping
limits (3.9)-(3.10), RES power limitation (3.11), and integrality
requirement (3.12). The system shall satisfy real-time power
balance (3.13) and transmission limits (3.14)-(3.15). Note that
ISOs usually adopt slack variables (i.e., S1/2/3/4 in (3.13)-
(3.15)) to ensure the ED feasibility.
i I ed,qs
t + C bs (cid:80)

it + (cid:80)
ik P ed,seg
C seg
k
∈K
bt + S4
(S3
bt)

i U ed,qs
t + C 2S2

it + C nl

i
∈I
+C 1S1

min
z
t

(C su

(3.1)







(cid:80)

(cid:80)

itk

)





∈T

b

≤ O(cid:63)
it
− I ed,qs
1
i,t
−

Generator Constraints:
it + I ed,qs
it = I (cid:63)
I ed
it
U ed,qs
− Ded,qs
it
it
it = (cid:80)
P ed
k
0 ≤ P ed,seg
itk
it ≥ P min
P ed
it ≤ P max
P ed

; I ed,qs
it
= I ed,qs
it
P ed,seg
itk
≤ ¯P seg
ik I ed
it
I ed
it
it + Rnr,(cid:63)
I (cid:63)

∈K

it

i

i

I ed,qs
it

∈B

∀t ∈ T , i ∈ I
∀t ∈ T , i ∈ I

(3.2)
(3.3)

∀t ∈ T , i ∈ I
(3.4)
∀t ∈ T , i ∈ I, k ∈ K (3.5)
∀t ∈ T , i ∈ I
(3.6)
∀t ∈ T , i ∈ I
(3.7)

4

it

(3.8)

(3.9)

, Ded,qs
it

(3.10)
(3.11)

it| ≤ Rsr,(cid:63)

∀t ∈ T , i ∈ I
∀t ∈ T , j ∈ J
∈ {0, 1} ∀t ∈ T , i ∈ I

Fig. 2. Procedure to evaluate the electricity market economy.
I ed
it + P max
it I (cid:63)
it − P (cid:63)
|P ed
it ∀t ∈ T , i ∈ I
i
(1 − I ed
it − P ed
P ed
1 ≤ P max
it )
i,t
i
−
+Rup
it − I ed
i I ed
1 + Rsu
i (I ed
1) ∀t ∈ T , i ∈ I
i,t
i,t
−
−
(1 − I ed
it ≤ P max
1 − P ed
P ed
1)
i,t
i,t
i
−
−
i I ed
+Rdn
1 − I ed
i (I ed
it + Rsd
it )
i,t
−
jt ≤ ˜Wjt
0 ≤ W ed
, U ed,qs
it , I ed,qs
I ed
it
System Constraints:
(cid:80)
it + (cid:80)
P ed
i
∈I
it , W ed
Fb(P ed
it , W ed
Fb(P ed
t , S2
S1
t ≥ 0
bt, S4
S3
bt ≥ 0
The compact form of ED is shown as in (4), where M (·) and
N (·) respectively represent the sets of equality and inequality
constraints of (3).
min
d(cid:62)z
z
s. t. z ∈ Z(x(cid:63), y(cid:63), r(cid:63), ˜w)
(cid:26)

t ∀t ∈ T (3.13)
(3.14)
(3.15)
(3.16)
(3.17)

˜Lqt + S2
∈Q
∀t ∈ T , b ∈ B
∀t ∈ T , b ∈ B
∀t ∈ T
∀t ∈ T , b ∈ B

W ed
jt , ˜Lqt) − S3
jt , ˜Lqt) + S4

jt + S1
bt ≤ Bb
bt ≥ −Bb

t = (cid:80)

(3.12)

(4.2)

(4.1)

∈J

(cid:27)

q

j

M (x(cid:63), z) = 0
N (x(cid:63), y(cid:63), r(cid:63), z, ˜w) ≤ 0

(4.3)

Z(x(cid:63), y(cid:63), r(cid:63), ˜w) =

z

ED calculates optimal solutions to status switch of quick-start

units, generation of all units, and slack variables.

3) Evaluation of Electricity Market Economy: As shown in
Fig. 2, the market economy is evaluated by solving the day-ahead
UC and the real-time ED in a queue.

Speciﬁcally, since ˜w remains unknown in the day-ahead stage,
UC is ﬁrst conducted to clear the day-ahead market using ˆw
and ˆr, providing the actual UC cost (i.e., startup and no-load
costs a(cid:62)x(cid:63) plus SR and NR costs c(cid:62)r(cid:63)). After ˜w is revealed
in the real-time stage, ED is executed to clear the real-time
market, providing the actual ED cost d(cid:62)z(cid:63) (i.e., startup and
no-load costs of quick-start units additionally committed in ED,
generation cost of all units, and slack penalties).

Finally, the actual system cost csys is calculated via (5), which

is utilized to evaluate the electricity market economy.
csys = (cid:80)
+ (cid:80)

i I (cid:63)
it)
i Rnr,(cid:63)

i U (cid:63)
i Rsr,(cid:63)

it + C nr

it + C nl

(C su

(C sr

i
∈I
(cid:80)

t
∈T

(cid:80)

it

)

i

∈I
(cid:80)

i
∈I
(cid:80)

t
∈T

t

∈T

+ (cid:80)
+ (cid:80)
+ (cid:80)

∈T

t

t

∈T

(C su

i U ed,(cid:63)
it + C nl
(cid:80)
ik P ed,seg,(cid:63)
C seg

itk

i I ed,(cid:63)

it

)

i
k
∈I
∈K
[C 1S1,(cid:63)

t + C 2S2,(cid:63)

t + C bs (cid:80)

(S3,(cid:63)



bt + S4,(cid:63)
bt )]

b

∈B

} a(cid:62)x(cid:63)

} c(cid:62)r(cid:63)


d(cid:62)z(cid:63)

Fig. 3. Asymmetric impact of RES prediction MAE on the market economy.

= a(cid:62)x(cid:63) + c(cid:62)r(cid:63) + d(cid:62)z(cid:63)

(5)

B. Motivations

1) Asymmetric Impact of RES Prediction MAE on Market
Economy: To show this motivation, multiple raw predictions ˆw
on Feb. 16, 2020 are generated based on the Belgian ISO data.
These raw predictions are applied on an IEEE 118-bus system to
conduct the market clearing, i.e., the O-PO process. Finally, the
market economy loss is evaluated by (6), where ˆcsys and ˜csys are
actual systems costs induced by ( ˆw, ˆr) and ( ˜w, ˆr), respectively.
Fig. 3 shows the results of all raw predictions.

Market Economy Loss = (ˆcsys − ˜csys)/˜csys × 100%

(6)

Two motivating cases are highlighted as follows:
Case 1: Raw predictions of

the same MAE may lead to
different economies. Note that points A and B in Fig. 3 have
the same MAE (61.8MW) but different economy losses (3.2%
vs 3.6%). This is because the under-prediction of point A merely
causes downward generation adjustment and RES curtailments
in real-time ED; in comparison, the over-prediction of point
B requires expensive NR deployment from quick-start units in
real-time ED. Indeed, the asymmetric impacts inspire that the
predictions should consider the ultimate economic consequence
out of the UC-ED optimization.

Case 2: Raw predictions of a worse MAE may even lead
to a better economy. Although MAE of point C is noticeably
high (150.2MW),
it still achieves the lowest economy loss
(2.3%) among all raw predictions. This is because each ˆw shall
associate with a just-enough reserve level ˆr(cid:63) in the face of
˜w (e.g., a proper ˆr(cid:63) depends on the difference between ˆw
and ˜w, and ˆr(cid:63) = 0 if ˆw = ˜w). Consequently, if ( ˆw, ˆr(cid:63)) is
taken as input to (2), the induced UC decisions can ensure
just-enough reserve to enable the full utilization of available
RES in real time, delivering the best market economy. Thus,
simultaneously predicting cost-oriented ˆw and ˆr(cid:63) by assessing
their joint impacts on the ultimate market economy would be
beneﬁcial.

2) Limitations in Our Previous Work [19]: This paper is also

motivated by overcoming three limitations of [19].

Underutilization of information. As shown in Fig. 1, [19] only
feeds the UC information back to the prediction, while this paper
feeds both UC and ED information back to optimizations for
boosting the ultimate market economy.

Rule-of-thumb reserve requirements. Only the RES predictions
are tailored in [19], while the reserve requirements are still rule-
of-thumb. Instead, this paper tailors both the RES and reserve
predictions, seeking for the just-enough reserve requirements
paired with RES predictions to deliver the best market economy.

UCDecisionsExecute UC (2) based on predictions of RES !"and reserve requirements #$.UC%⋆'⋆#⋆Startup and no-load costs ofall unitscommitted in UC.Spinning reserve andnon-spinning reserve costs.Day-Ahead Electricity MarketActual UC CostStartup and no-load costs ofquick-start unitscommitted in ED.Actual generation cost ofall units andslack penalties.Real-Time Electricity MarketActual ED CostExecute ED (4)basedonUC decisionsin the face of actual RES realization !(.EDActual System Cost (Market Economy) Actual UC CostActual ED Cost)!%⋆++!#⋆,!-⋆2%3%4%5%-30%-25%-20%-15%-10%-5%0%5%10%15%20%25%30%Point AMAE:61.8MWLoss: 3.2%MAE of RES Prediction (MW)Point BMAE: 61.8MWLoss: 3.6%Point CMAE:150.2MWLoss: 2.3%*Under PredictOver PredictMarket Economy LossTrend Line3%2%4%5%288240192144964804896144192240288Compromised UC modeling in the single-level ERM. In the
single-level ERM (7) [19], the UC objective has to be packed
into objective function of the predictor training model as in (7.1),
in which cuc,(cid:63)
is the UC cost (2.1) induced by ( ˜ws, ˆrs). Thus,
the UC model in (7) is regarded as compromised.

s

5

|a(cid:62)xs + b(cid:62)ys + c(cid:62)rs − cuc,(cid:63)

s

|

(7.1)

Fig. 4.

Illustration of the closed-loop mechanism in tri-level ERM.

1

(cid:80)

min
,xs,ys,rs

|S|

s

∈S

W
s. t. (xs, ys, rs) ∈ X (W( ˆws), ˆrs); W(·) ∈ P w ∀s ∈ S (7.2)

Indeed, since (7) minimizes the in-sample training loss (7.1)
instead of system cost (2.1), its in-sample UC solutions (i.e.,
xs and ys) may violate the least-cost merit-order principle
(i.e., using more expensive units to pursue the minimum loss
function (7.1)), leading to compromised UC decisions. Using
these compromised UC solutions in the training would derive a
predictor W (cid:63) that fails to generalize well, i.e., overﬁtting [21].
this paper uses tri-level MIP to construct ERM,
in which UC is exactly modeled in the middle level without
compromise. In this way, the in-sample UC solutions always
minimize the system cost (2.1), and the least-cost principle
is strictly followed. With this, the accuracy of the feedback
information can effectively avoid the overﬁtting issue.

Instead,

III. CLOSED-LOOP PREDICT-AND-OPTIMIZE FRAMEWORK

This section ﬁrst constructs the tri-level MIP-based ERM
problem and introduces its solution approach, followed by the
prescriptive UC model that integrates the trained predictors into
the UC model to simultaneously deliver the RES-reserve predic-
tions and UC decisions with the enhanced market economy.

A. Constructing ERM Problem

Based on a preselected scenario set S (the scenario selection
will be detailed in Section IV), the tri-level ERM problem is
constructed as in (8). Solving (8) can provide cost-oriented
predictors W (cid:63) and R(cid:63).
Upper Level (Predictor Training):
1
cerm,(cid:63) = min
,
R

[a(cid:62)xs + c(cid:62)rs + d(cid:62)zs]

(8.1)

(cid:80)

∈S

|S|

W

s

ˆw(cid:5)s = W( ˆws); ˆr(cid:5)s = R( ˆws,ˆls)
W(·) ∈ P w; R(·) ∈ P r; rs ≤ ˆr(cid:5)s
Middle Level (UC for Day-Ahead Market Clearing):
xs, ys, rs ∈

arg min
( ˆw(cid:5)
Lower Level (ED for Real-Time Market Clearing):
zs ∈
d(cid:62)zs

xs,ys,rs

∈X

a(cid:62)xs+ b(cid:62)ys+ c(cid:62)rs ∀s ∈ S (8.4)
s ,ˆr(cid:5)
s )

∀s ∈ S (8.2)
∀s ∈ S (8.3)

∀s ∈ S (8.5)

arg min
(xs,ys,rs, ˜ws)

zs

∈Z

The upper level (8.1)-(8.3) trains the RES predictor W and
reserve (including SR and NR) predictor R. The training objec-
tive (8.1) is to minimize the weighted sum of actual system costs
for all scenarios. Constraint (8.2) deﬁnes W and R, respectively
taking ˆws and ( ˆws,ˆls) as inputs; (8.3) limits the predictor
parameters within their feasible regions, and the last inequality
ensures the non-triviality of R. In this paper, the predictors take
the form of afﬁne linear functions as in (9), because of their
interpretability and numerical stability. With this, the training is
essentially to determine the optimal vectors h, m, and n.

W( ˆws) = h(cid:62) ˆws
R( ˆws,ˆls) = m(cid:62) ˆws + n(cid:62)ˆls

h ∈ P w
(m, n) ∈ P r

(9.1)
(9.2)

The middle level (8.4) and the lower level (8.5) respectively
model UC (2) and ED (4) following their original models exactly
without compromise.

Fig. 4 depicts how the tri-level ERM (8) closes the loop
between the predictions and optimizations. The upper level
generates the tailored predictions ˆw(cid:5) and ˆr(cid:5), but cannot directly
assess their ultimate economic consequence. Thus, ˆw(cid:5) and ˆr(cid:5)
are ﬁrst passed to the middle-level day-ahead UC (8.4). Solving
(8.4) provides the actual UC cost a(cid:62)x(cid:63)+c(cid:62)r(cid:63) to the upper level
as well as the UC decisions (x(cid:63), y(cid:63), r(cid:63)) to the lower-level real-
time ED. Then, ED (8.5) is solved to provide the actual ED cost
d(cid:62)z(cid:63) to the upper level. With this, the upper level can assess the
prediction quality via actual system cost a(cid:62)x(cid:63) + c(cid:62)r(cid:63) + d(cid:62)z(cid:63),
and tune the predictor parameters accordingly. This process
repeats until the optimally trained predictors W (cid:63) and R(cid:63) are
obtained. Since W (cid:63) and R(cid:63) are trained to optimize the market
economy, they are economy-oriented (i.e., cost-oriented) and
tailored for the market-clearing optimizations.

B. Solving ERM Problem

1) Convert (8) to Bilevel MIP (10): By leveraging special
structure of the tri-level ERM (8), we convert it into a more
tractable bilevel MIP (10). Solving (10) provides the optimal
solution of the original ERM (8), as indicated in Proposition 1.
Proposition 1: The optimal solution of the bilevel MIP (10)

is also optimal to the original tri-level MIP (8).

min
,
R

,zs

W

1

|S|

(cid:80)
s

∈S

[a(cid:62)xs + c(cid:62)rs + d(cid:62)zs]

s. t. ˆw(cid:5)s = W( ˆws); ˆr(cid:5)s = R( ˆws,ˆls)

W(·) ∈ P w; R(·) ∈ P r; rs ≤ ˆr(cid:5)s
zs ∈ Z(xs, ys, rs, ˜ws)
xs, ys, rs ∈

arg min
( ˆw(cid:5)

∈X

s ,ˆr(cid:5)
s )

xs,ys,rs

(10.1)

(10.2)
(10.3)
(10.4)

∀s ∈ S
∀s ∈ S
∀s ∈ S

∀s ∈ S

(10.5)

a(cid:62)xs + b(cid:62)ys + c(cid:62)rs

Proof: See the Appendix.

2) Solve (10) by Reformulation and Decomposition: The
bilevel MIP (10) is solved by a column-and-constraint generation
(C&CG) type algorithm [25] which iterates between two sub-
problems SP1, SP2 and one master problem MP. The procedure
is summarized in Algorithm 1.

Subproblem SP1 is shown as in (11). It is a duplication of
the UC problem (10.5) while taking the incumbent predictors
We and Re as inputs. Solving SP1 can reveal the UC cost cuc,(cid:63)
induced by the incumbent predictors.
s = min

a(cid:62)xs + b(cid:62)ys + c(cid:62)rs

SP1: cuc,(cid:63)

(11.1)

s

s. t.

xs,ys,rs
ˆw(cid:5)s = We( ˆws); ˆr(cid:5)s = Re( ˆws,ˆls)
F (xs, ys) = 0
G(xs, ys, rs, ˆw(cid:5)s, ˆr(cid:5)s) ≤ 0

(11.2)
(11.3)
(11.4)

Note that multiple optimal UC solutions for SP1 may exist,
which however could lead to different system costs evaluated

MiddleLevel (8.4)LowerLevel (8.5)Reserve PredictorUpperLevel (8.1)-(8.3)RES PredictorPredictor TrainingClearing Electricity MarketsPredictions<latexit sha1_base64="RGwbi1X/6N8+beplt5hStQyK4aE=">AAACK3icbVC7TsMwFHV4lvIKMLJEVEgMqEoqBIwVLIxFog+pCZXjuK1VPyLbAVVR/oeFX2GAgYdY+Q+cNgNtOZblo3PPle89YUyJ0q77aS0tr6yurZc2yptb2zu79t5+S4lEItxEggrZCaHClHDc1ERT3IklhiykuB2OrvN6+wFLRQS/0+MYBwwOOOkTBLWRevaVP4Q69UNBIzVm5kkfs+w+9SMCmeBR5p+aM2+RM5aeXXGr7gTOIvEKUgEFGj371Y8EShjmGlGoVNdzYx2kUGqCKM7KfqJwDNEIDnDXUA4ZVkE62TVzjo0SOX0hzeXamah/O1LIVD6mcTKoh2q+lov/1bqJ7l8GKeFxojFH04/6CXW0cPLgnIhIjDQdGwKRJGZWBw2hhEibeMsmBG9+5UXSqlW982rt9qxSrxVxlMAhOAInwAMXoA5uQAM0AQJP4AW8gw/r2XqzvqzvqXXJKnoOwAysn1/x+6qD</latexit>ˆw⇧ˆr⇧Day-aheadMarket ClearingReal-TimeMarket ClearingActual System Cost<latexit sha1_base64="FeWpwg56vOZPMPuPvx+vukSIzqs=">AAACc3icdZFNSwMxEIaz61etX1XBSw8GqyCIZbeIeix48VjBfkBbSzab1tDsZklmxbrsH/DnefNfePFuti3Y2joQ8vLOM2Qy40WCa3CcT8teWV1b38ht5re2d3b3CvsHDS1jRVmdSiFVyyOaCR6yOnAQrBUpRgJPsKY3vMvyzRemNJfhI4wi1g3IIOR9TgkYq1d4x7jjSeHrUWCuhKRPSQdklM6ar5mpgag0fzFH02W0+o/2l9Fvv3SvUHLKzjjwonCnooSmUesVPjq+pHHAQqCCaN12nQi6CVHAqWBpvhNrFhE6JAPWNjIkAdPdZDyzFJ8Zx8d9qcwJAY/d2YqEBDrr0ZABgWf9N5eZy3LtGPq33YSHUQwspJOH+rHAIHG2AOxzxSiIkRGEKm56xfSZKELBrCkbgvv3y4uiUSm71+XKw1WpWpmOI4eK6ASdIxfdoCq6RzVURxR9WUfWsYWtb7ton9inE9S2pjWHaC7syx++j8Mi</latexit>a>x?+c>r?+d>z?UCDecisions<latexit sha1_base64="ur7oTr7udIlGltD2uAhvM6GJg/4=">AAACNHicdVBNS8MwGE79nPOr6tFLcAgeZLRD1OPAi+BlgvuAtY40TbewtClJKpayH+XFH+JFBA+KePU3mG5F5qZPCHl4nvcl7/t4MaNSWdaLsbC4tLyyWlorr29sbm2bO7styROBSRNzxkXHQ5IwGpGmooqRTiwICj1G2t7wIvfbd0RIyqMblcbEDVE/ogHFSGmpZ145Hme+TEP9ZPej28yRComRc6zPlJP+64gfp9wzK1bVGgPOE7sgFVCg0TOfHJ/jJCSRwgxJ2bWtWLkZEopiRkZlJ5EkRniI+qSraYRCIt1svPQIHmrFhwEX+kYKjtXpjgyFMp9RV4ZIDeSsl4t/ed1EBeduRqM4USTCk4+ChEHFYZ4g9KkgWLFUE4QF1bNCPEACYaVzzkOwZ1eeJ61a1T6t1q5PKvVaEUcJ7IMDcARscAbq4BI0QBNg8ACewRt4Nx6NV+PD+JyULhhFzx74BePrGwQhrgI=</latexit>x?y?r?6

via (10.1). To tackle this issue, the second subproblem SP2 is
modeled as in (12) with cuc,(cid:63)
from SP1 as input. Essentially,
solving SP2 is to select one of the multiple optimal UC solutions
of SP1 in the favor of the objective (10.1). This is referred to
as optimistic bilevel programming [25].

s

SP2: csys,(cid:63)

s

=

s. t.

a(cid:62)xs + c(cid:62)rs + d(cid:62)zs
min
xs,ys,rs,zs
ˆw(cid:5)s = We( ˆws); ˆr(cid:5)s = Re( ˆws,ˆls)
a(cid:62)xs + b(cid:62)ys + c(cid:62)rs ≤ cuc,(cid:63)
F (xs, ys) = 0
G(xs, ys, rs, ˆw(cid:5)s, ˆr(cid:5)s) ≤ 0
M (xs, zs) = 0
N (xs, ys, rs, zs, ˜ws) ≤ 0

s

(12.1)

(12.2)
(12.3)
(12.4)
(12.5)
(12.6)
(12.7)

Based on the selected UC decisions from SP2, the master

(13.1)

(13.2)
∀s ∈ S (13.3)
s , zs, ˜ws) ≤ 0 ∀s ∈ S (13.4)

s , ˆw(cid:5)s, ˆr(cid:5)s) ≤ 0 ∀s ∈ S (13.5)

1

Ξ

|S|

[a(cid:62)xdv

s , rdv

s , ydv

s , rgv
s }

s + d(cid:62)zs] + λ(cid:107)W(cid:107)1
s , ygv
s , rdv

problem MP is formulated as in (13).
(cid:80)
s + c(cid:62)rdv
MP: min
s
∈S
Ξ = {W(·), R(·), ˆw(cid:5)s, ˆr(cid:5)s, zs, xdv
s , ydv
Original Constraints (10.2)-(10.4):
W(·) ∈ P w; R(·) ∈ P r
ˆw(cid:5)s = W( ˆws); ˆr(cid:5)s = R( ˆws,ˆls); rs ≤ ˆr(cid:5)s
M (xdv
s , ydv
s , zs) = 0; N (xdv
Duplication of UC Constraints:
F (xdv
s , ydv
s ) = 0; G(xdv
Stationarity of KKT (Optimality Cut):
∇L(ygv
Primal and Dual Feasibilities of KKT (Optimality Cut):
F (xev
G(xev
Complementary Slackness of KKT (Optimality Cut):
νs,e⊥G(xev
s,e, ygv
s,e, ˆw(cid:5)s, ˆr(cid:5)s)
Objective Cut (Optimality Cut):
a(cid:62)xdv

s,e, µs,e, νs,e) = 0

s,e) = 0;
s,e, rgv

s,e, ygv
s,e, ygv

s,e, rgv

s,e, rgv

s , rdv

s ≤ a(cid:62)xev

s,e + b(cid:62)ygv

s + b(cid:62)ydv

s + c(cid:62)rdv

s,e, ˆw(cid:5)s, ˆr(cid:5)s) ≤ 0; νs,e ≥ 0 ∀s ∈ S, e ∈ E (13.7)

∀s ∈ S, e ∈ E (13.8)

s,e + c(cid:62)rgv
s,e
∀s ∈ S, e ∈ E (13.9)

∀s ∈ S (13.6)

s , ydv

s,e, rgv

s,e, and generated {ygv

Three variants of the original UC variables {xs, ys, rs} are
s , rdv
used in MP, including duplicated {xdv
s }, enumerated
xev
s,e}. The duplicated variables server
as the proxy of the original variables, but with a larger fea-
sible region; the enumerated and generated variables and their
associated cutting planes (13.5)-(13.9) serve to gradually cut the
feasible region of duplicated variables. Finally, MP is built in
three parts.

•

•

•

The ﬁrst part
is (13.1)-(13.4) based on the duplicated
variables. The objective function (13.1) also includes a
regularization term λ(cid:107)W(cid:107)1 with hyper-parameter λ to
relieve overﬁtting. Constraints (13.2)-(13.4) correspond to
the original constraints (10.2)-(10.4).
The second part (13.5) is a duplication of UC constraints
to ensure feasibility of the duplicated variables.
The third part (13.6)-(13.9) servers as the optimality cuts
for the duplicated variables. Note that xev
s,e is a constant
vector enumerated by SP2 for scenario s in iteration e.
When xs is ﬁxed as xev
s,e, (10.5) degenerates to a LP that
can be equivalently substituted by the Karush–Kuhn–Tucker
(KKT) condition (13.6)-(13.8). Here, L(·) denotes the La-
grangian function; µ and ν are dual variables of equalities

Algorithm 1: C&CG Algorithm for Solving (10)

Input: Index of iterations e = 0, iteration limitation E, desired

optimality gap (cid:15)(cid:63), initial predictors We and Re, lower bound
LB, upper bound U B.

Output: The trained predictors W (cid:63) and R(cid:63).
while e ≤ E do

Solve SP1 for each scenario s ∈ S;
Solve SP2 for each scenario s ∈ S;
U B ← min{U B, (cid:80)
s∈S csys,(cid:63)
(cid:15) ← 100% × (U B − LB)/U B;
if (cid:15) ≤ (cid:15)(cid:63) then

s

W (cid:63) ← We, R(cid:63) ← Re;
break;

/|S| + λ(cid:107)W(cid:107)1};

else

end

end

s,e, rgv

s,e ← optimal solution of decision xs in SP2;

xev
Generate new {ygv
Solve MP;
e ← e + 1;
LB ← optimal objective value of MP;
We and Re ← optimal solutions of W and R in MP;

s,e} and (13.6)-(13.9) in MP;

and inequalities. The KKT (13.6)-(13.8) ensures the opti-
mality of the generated variables given xev
s,e. Finally, (13.9)
links the duplicated variables with their optimality cuts. By
linearizing the complementary slackness (13.8) using Big-
M method, MP can be directly solved via MIP solvers.

C. Forming Prescriptive UC Model

The prescriptive UC model (14) can be formed by integrating
the trained cost-oriented predictors W (cid:63) and R(cid:63) into the deter-
ministic UC model (2). It presents two major favorable features
as compared to the deterministic UC model (2):

•

•

Integrating the predictors enables (14) to simultaneously
deliver the RES-reserve predictions and UC decisions,
referred to as prescription. In comparison, (2) exclusively
focuses on the UC decision, and most existing forecasting
works mainly focus on the prediction.
W (cid:63) and R(cid:63) are afﬁne linear functions (9). Therefore, the
tailored predictions are essentially the linear scaling of the
raw predictions, which will not introduce signiﬁcantly extra
computation burden in solving (14).

min
x,y,r, ˆw(cid:5),ˆr(cid:5)

a(cid:62)x + b(cid:62)y + c(cid:62)r

s. t. ˆw(cid:5) = W (cid:63)( ˆw); ˆr(cid:5) = R(cid:63)( ˆw,ˆl)

(x, y, r) ∈ X ( ˆw(cid:5), ˆr(cid:5))

(14.1)

(14.2)
(14.3)

A. Experimental Setting

IV. CASE STUDIES

1) C-PO Implementation Design: By leveraging adaptation to
the ISO’s market-clearing practice and solution quality of (14),
the proposed C-PO is implemented via a weekly rolling scheme,
i.e., for each week, the predictors are retrained to update (14)
using information of the past N H days.

Speciﬁcally, for the dispatch week of Days (D+1) to (D+7),
before the ﬁrst dispatch Day (D+1), norm-2 distance of the net-
load error (15) is calculated for each of the most recent N H days
(i.e., Days (D − N H) to (D − 1)). Among these N H historical
days, N T days with the largest dist are selected to build the
training scenario set S. Then, the ERM (10) is solved to provide
the cost-oriented predictors W (cid:63) and R(cid:63), which are used to form

7

TABLE III
METHODS TO BE DISCUSSED

Label

Note

C-PO-NT
C-PO-A
O-PO
P-PO
T-SP-NS
T-RO-NB

C-PO with N H = 14 and N T = NT.
Average performance of all C-PO-NT methods.
O-PO with raw predictions ˆr and ˆw.
Perfect predict-then-optimize (P-PO) using perfect predictions.
T-SP with |H| = NS scenarios.
T-RO with budget parameter Γ = NB.

Fig. 6. Economy comparison of O-PO, C-PO, and P-PO.

can only achieve 2.65% EI, the 0.82% EI of C-PO-5 would be
regarded as non-trivial.

Table IV further shows the breakdown of actual system costs
(no-load and slack costs are relatively small and thus not listed
individually). Note that the main difference between O-PO and
C-PO-A stems from the reserve schedules, implying that ˆr(cid:5) is
smaller than ˆr. Moreover, C-PO-NTs use quick-start units more
frequently than O-PO, thus rendering a higher start-up cost ($707
vs $132) in ED.

Table V compares the usages of RES and reserves in ED.
Compared to O-PO, C-PO-A has a slightly lower RES usage but
a much more balanced usage between SR and NR. Speciﬁcally,
the difference between total SR and NR usages is only 3.7MW
in C-PO-A, while is 75MW in O-PO.

Finally, Table VI evaluates RES prediction accuracy via four
including MAE, root mean square
commonly used metrics,
error (RMSE), and mean over-/under-prediction percentage error
(MUPE/MOPE). C-PO performs worse in MAE and RMSE. In
addition, C-PO has a better MOPE but a worse MUPE, which
indicates that C-PO tends to conservatively predict RES power
(i.e., ˆw(cid:5) is statistically smaller than ˆw).

2) Discussions: The above results clearly indicate that C-PO
outperforms O-PO economically. Still, the reasons behind this
conclusion deserve further discussion.

As shown in Table IV, the economy difference mainly stems
from the reserve schedules. Speciﬁcally, SR and NR schedules
of C-PO-A are 43.5% and 29.7% lower than those of O-PO,
respectively. This is because C-PO learns that (i) the rule-of-
thumb ˆr is generally redundant, and (ii) C sr
is ﬁve times C nr
.
i
Therefore, C-PO properly lowers ˆr(cid:5) and increases the utilization
of NR, as shown in Table V.

i

However, decreasing the reserve schedules may trigger load
shedding in the face of ˜w. To avoid this, C-PO leverages lower
ˆw(cid:5) and higher base-generation P (cid:63)
it in the day-ahead market,
allowing ISOs to ﬂexibly dispatch RES and avoid load shedding
when faced with ˆw(cid:5) in the real-time market.

In summary, by effectively learning the UC-ED optimization
information, C-PO simultaneously tailors raw ( ˆw, ˆr) to cost-
oriented ( ˆw(cid:5), ˆr(cid:5)) for improving market economy. Even though
the tailored predictions are slightly worse in accuracy,
they
enable ISOs to use various resources more economically, leading
to a better electricity market economy than O-PO.

Fig. 5. The modiﬁed IEEE 118-bus system.

TABLE II
SELECTIVE WEEKS OF 2020
Fall

Summer

Spring

Winter

Peak
Valley

03/05 - 03/11
04/13 - 04/19

08/11 - 08/17
07/05 - 07/11

11/30 - 12/06
10/04 - 10/10

12/10 - 12/16
12/25 - 12/31

the prescriptive UC model (14) used for Days (D+1) to (D+7).
At the end of this period, the above process repeats to update the
predictors and solve (14) for the next week (i.e., Days (D + 8)
to (D + 14)).

dist = (cid:107)ˆl

net

net

− ˜l

(cid:107)2

(15)

2) Testing System Setup: All the cases are conducted on a
modiﬁed IEEE 118-bus system (as shown in Fig. 5) and solved
by Gurobi 9.1 on a 3.5 GHz PC. Based on the Belgian ISO data
[26], eight weeks in 2020 are selected as in Table II, each of
which covers a seasonal peak/valley load. The Belgian data are
properly scaled to build the RES and load data for the system.
i and C nr
are set as 10% and 2% of the
i
generation price at the nominal operating point [28]. The slack
penalty prices C 1, C 2, and C bs are $2,000/MWh, $1,750/MWh,
and $1,500/MWh. The rule-of-thumb reserve requirement ˆr is
set as 30% of raw net load predictions, of which at least 50%
is for SR. Other data can be referred to from [27].

The reserve prices C sr

Table III lists all the models to be analyzed in this paper.

Threshold on the optimality gap of all models is set as 1%.

B. C-PO vs O-PO

This section compares C-PO and O-PO via two metrics:
economy improvement (EI) (16) that evaluates the improvement
in the market economy, and value of information (VoI) (17) that
quantiﬁes the value of the feedback information.

EI = (csys,o-po − csys,c-po)/(csys,o-po)×100%
(16)
VoI = (csys,o-po − csys,c-po)/(csys,o-po − csys,p-po)×100% (17)

1) Results: Fig. 6 shows that all C-PO-NTs with N T = 1
to 7 outperform O-PO economically. Moreover, C-PO-NTs with
N T ≥ 5 generally outperform those with N T < 5, in which
C-PO-5 renders the best performance (0.82% EI and 30.85%
VoI). Considering that even the ideal P-PO with an 100% VoI

Coal Units (Non-Quick) Gas Units (Quick)Oil Units (Quick)RES FarmsG22#1#2#3#4#11#5#6G02#12#7#13#117#14#15#9#10#16#19#30#17#18#29#28#27#31#32#114#115#20#21#26#23#22#25#113#24G10G05G03G01G04G13G14G11G12G07G08G06G53G09G17G18G23G21#40#41#42#53#54#56#55#52#39#33#37#34#59G15#43#44#35G16#36#38#45#46G19#47#48#49#57#58#50#51#63#64#60#61G25#62G26#67#66G28#65G27G29#69#68G54#116G34#118#76#81#78#79#80G44#99#77G36#98#97G35#70#71#72G30#73G32G31#75#74G33G37#82#96#106#100G45#95#94#104#105#107G48G49#93#92G43#83#84#85#88#89G40G38#86#87#90G41#91G42#102#101#103G46G47#108#109G51#111#110#112G52G50G39#8G20G24Zone #3Zone #2Zone #1RES#1200MWRES#2200MWRES#4200MWRES#3200MWRES#5200MWG13Peak loadNumber of Gas-Fuel Units4092MW11InstalledThermal CapacityNumber of Oil-Fuel Units8600MW10InstalledRES CapacityNumber of All Buses1000MW118Number of All UnitsNumber of Load Buses5491Number of Coal-Fuel UnitsNumber of Branches33186G13G13647650653656659662665668C-PO-1C-PO-2C-PO-3C-PO-4C-PO-5C-PO-6C-PO-7EI: 0.54%VoI: 20.30%EI: 0.69%VoI: 26.15%EI: 0.79%VoI: 29.71%EI: 0.77%VoI: 29.18%EI: 0.82%★VoI: 30.85%★EI: 0.81%VoI: 30.41%EI: 0.79%VoI: 29.63%Upper Bound: Cost of traditional O-POLower Bound: Cost of ideal P-POCost of presented C-POAverageActualSystem Cost/103$VoI8

TABLE IV
BREAKDOWN OF ACTUAL SYSTEM COST
UC Cost/103$

ED Cost/103$

csys/103$

O-PO
C-PO-A

Startup

2.4
2.4

SR

10.9
6.2

NR

4.6
3.2

Startup

Generation

0.1
0.7

647.7
647.9

665.8
660.8

TABLE V
ACTUALLY UTILIZED RES AND RESERVE IN ED

Usage Power/MW

Usage Ratio/%

O-PO
C-PO-A

RES

63.8
63.4

SR

80.1
58.5

NR

5.1
54.8

RES

99.9%
99.6%

SR

84.7%
78.6%

NR

0.1%
1.3%

C. C-PO vs Two-Stage Optimization with MIP Recourse

TABLE VI
STATISTICAL ACCURACY OF RES PREDICTION
MOPE/%

RMSE/MW

MAE/MW

ˆw in O-PO
ˆw(cid:5) in C-PO-A

49.6
50.4

59.8
61.1

37.5%
34.6%

MUPE/%

7.3%
8.5%

•

The following points are adopted for the sake of comparisons:
Load and RES are regarded as uncertainty factors, whose
prediction and actual realization are denoted by ˆu and ˜u,
respectively. The day-ahead point forecast and the 90%
conﬁdence interval for ˆu are available from [26].
T-SP is modeled as a scenario-based SP [6] via (18). To
construct the scenario set H, 3, 000 scenarios are generated
via Latin Hypercube sampling within the 90% conﬁdence
interval, and then reduced to N S scenarios via a scenario-
tree method [29]. The probability of scenario h is denoted
by ph. For the sake of comparison, (18) is solved directly.

•

min
x,y,r,zh

a(cid:62)x + b(cid:62)y + c(cid:62)r + ph

(cid:80)
h

∈H

d(cid:62)zh

(18.1)

s. t. (x, y, r) ∈ X (ˆu)

zh ∈ Z(x, y, r, ˜uh) ∀h ∈ H

(18.2)
(18.3)

•

T-RO is modeled as an adjustable RO [7] via (19). The box
uncertainty set U is constructed using the 90% conﬁdence
intervals, and the budget parameter Γ ∈ [0, 48] controls the
robustness degree. A nested C&CG algorithm [7] is applied
to solve (19).

a(cid:62)x + b(cid:62)y + c(cid:62)r + max
∈U

min
x,y,r
s. t. (x, y, r) ∈ X (ˆu)

˜u

z ∈ Z(x, y, r, ˜u, Γ)

min
z

d(cid:62)z

(19.1)

(19.2)
(19.3)

•

The reserve schedules are implicated in the second-stage
ED of (18) and (19) (i.e., (18.3) and (19.3)), thus the reserve
requirement constraints (1.17)-(1.18) are not included.
1) C-PO vs T-SP: Fig. 7(a) sketches the economy on the four

peak-load days. The following points are observed:

•

•

•

T-SP-NSs require dozens of scenarios to perform well, thus
leaving a wide cost gap among different N S values. Rel-
atively, C-PO-NTs need fewer scenarios, with a narrower
cost gap among different N T values. It indicates that the
tri-level ERM enables C-PO to effectively mine the value
of information, thus ensuring its performance in case of
limited scenarios.
Except for the winter day, the costs of T-SP-NSs ﬁnally
fall within the cost gap (i.e., red shadows) of C-PO. It
implies that the economy efﬁciencies of T-SP and C-PO
are mutually reachable with larger N S values.
On the winter day, even with N S = 100, T-SP-NS still
performs poorly. This is because the conﬁdence intervals
cannot exactly cover the underlying distributions of ˆu and
T-SP-NSs would encounter tremendous slack penalties.

Fig. 7. Comparison of C-PO and T-SP (the red shadows show the cost gap
between the best and worst C-PO-NTs).

Fig. 7(b) plots the reserve schedules on a fall day, in which
T-SP-A is the average performance of T-SP-NSs. It can be seen
that the trends of T-SP-A and C-PO-A tend to be opposite. For
example, C-PO-A gradually decreases in hours 1-5 and increases
in hours 6-12, but T-SP-A is opposite. Indeed, except for some
outliers (e.g., hour 18), the reserve schedules of T-SP-A increase
monotonically with N S until reaching a threshold. Because the
average base-point generation schedules of C-PO-NTs and T-
SP-NSs are very close (48.7MW vs 48.3MW), it is pointed out
that the difference of day-ahead results between C-PO and T-SP
mainly stems from the reserve schedules.

Indeed, the different reserve schedules imply that T-SP and C-
PO reach the similar economy via different ways. Speciﬁcally, T-
SP schedules fewer reserves and utilizes more RES curtailments
in place of SR in the real-time ED. This may work well in case
of ample RES, but becomes risky when the real-time available
RES is low as the expensive slack penalties have to be triggered
(e.g., the winter day). In addition, this also causes a lower RES
utilization, i.e., the RES utilization ratios of T-SP-A and C-PO-A
on the four peak-load days are respectively 97.9% and 100.0%.
2) C-PO vs T-RO: Fig. 8(a) sketches the market economy.
It shows that T-RO-NBs outperform the C-PO-NTs in spring
and summer, are outperformed by C-PO-NTs in winter, and are
comparable to C-PO-NTs in fall. Additionally, several T-RO-
NBs fall within the red shadows, e.g., T-RO-16 in spring and
T-RO-32 in fall. It implies that T-RO and C-PO could achieve
similar economy performance with properly tuned parameters.
Fig. 8(b) further compares the reserve schedules in fall. It
shows that C-PO-A schedules more reserves than T-RO-A expect
for some outliers (e.g., hour 2). Moreover, for T-RO-NBs, the
reserve schedules in 15 out of 24 hours (e.g., hour 9) are almost
the same against different Γ, while in other hours (e.g., hours
11 and 16) they increase with Γ until saturated. Generally, C-
PO tends to schedule more reserves than T-RO in most hours,
although their reserve schedules in other hours are similar.

6.57.68.79.810.95102030405060708090100Peak-Load Day of Fall11/30/2020Width: 3.39Width: 0.036.26.87.48.08.65102030405060708090100Peak-Load Day of Spring03/05/2020Width: 1.60Width: 0.036.36.97.58.18.75102030405060708090100Peak-Load Day of Summer08/11/2020Width: 2.02Width: 0.049.010.111.212.313.45102030405060708090100Peak-Load Day of Winter12/10/2020Cost of T-SP-NSCost Gap of C-PO-NTWidth: 2.01Width: 0.10Number ofScenarios (NS)Number ofScenarios(NS)Actual System Cost/105$Actual System Cost/105$(a). Market-economy comparison of C-PO and T-SP 0100200300400500600700123456789101112131415161718192021222324Total Reserve Schedules/MWHourPeak-Load Day of Fall 11/30/2020(b). Reserve-schedule comparison of C-PO and T-SPT-SP-75T-SP-100T-SP-5T-SP-50C-PO-AT-SP-A6.76.86.97.07.112162024283236404448Peak-Load Day of Fall11/30/20206.26.36.46.56.612162024283236404448Peak-Load Day of Spring03/05/20206.46.56.66.76.812162024283236404448Peak-Load Day of Summer08/11/20209.09.710.411.111.812162024283236404448Peak-Load Day of Winter12/10/2020Cost of T-RO-NBCost Gap of C-PO-NTNumber of Budget (NB)Number of Budget (NB)Actual System Cost/105$Actual System Cost/105$(a). Market-economy comparison of C-PO and T-RO 0100200300400500600700123456789101112131415161718192021222324Total Reserve Schedules/MWHourPeak-Load Day of Fall 11/30/2020(b). Reserve-schedule comparison of C-PO and T-ROT-RO-32T-RO-48T-RO-12T-RO-20T-RO-AC-PO-ATABLE VII
COMPARISON OF DIFFERENT C-PO METHODS

MAE/MW Average SR/MW Average NR/MW

O-PO

C-PO-2
C-PO-2-R
C-PO-2-W

C-PO-4
C-PO-4-R
C-PO-4-W

C-PO-6
C-PO-6-R
C-PO-6-W

49.6

50.5
49.6
51.3

50.3
49.6
51.0

50.7
49.6
51.1

386.7

229.0
234.1
386.7

207.0
203.9
386.7

204.0
203.9
386.7

386.6

271.9
271.9
386.6

271.9
271.9
386.6

271.8
271.9
386.6

9

EI/%

0.00%

0.69%
0.68%
-0.02%

0.77%
0.74%
-0.02%

0.81%
0.74%
-0.01%

complaints and misgivings of market participants on the market-
clearing results. An immediate question is why a scenario set is
employed instead of others as all are randomly generated.

Analogously, uncertainty budget settings will suffer from the
same issue. Moreover, an abstract uncertainty budget lacks a
way to be intuitively linked with the market-clearing result. That
is, the impacts of budget forms and settings on the market-
clearing results are difﬁcult to be interpreted and quantiﬁed,
causing suspicions to market participants, especially those whose
economic interests are not in line with the expectations.

In comparison, the prescriptive UC (14) presents the same
model structure as (2), thus following the least-cost principle
and remaining strong interpretability. In addition, the results
have clearly illustrated that efﬁciencies of T-SP/T-RO and C-
PO are mutually reachable. Thus, it is promising to harness the
compatibility of C-PO in bridging the gap between T-SP/T-RO
and the current market practice.

D. Sensitivity Analysis

Sensitivity analysis on predictors of the C-PO is further
conducted. The results are listed in Table VII, in which C-PO-
NT-R/C-PO-NT-W only predicts reserves/RES and keeps raw
RES/reserves. It shows that C-PO-NTs have a slightly better
accuracy than C-PO-NT-Ws, and also achieve the best EI. This
observation supports our motivation—simultaneously predicting
RES and reserves to assess their joint ultimate economic conse-
quence out of the UC-ED optimization is beneﬁcial.

Regarding the reserve schedules, both SR and NR are lower
than the raw schedules. SR decreases as N T goes up but NR
saturates at 272MW. This is because C-PO can properly reduce
SR schedule. As NR is an important safeguard against load
shedding, it saturates at a relatively high threshold.

It is also observed that C-PO-NT-Ws result in negative EI,
indicating that the closed-loop learning may cause an adverse
impact on market economy. Indeed, C-PO possesses the common
issue existing in wide machine learning methods—there is no
absolute guarantee that
learning will always bring in extra
beneﬁts. Nevertheless, this issue could be relieved with sufﬁcient
training scenarios and well-tuned hyper-parameters.

V. CONCLUSION
The electricity market economy suffers from the traditional O-
PO framework. To this end, this paper proposes a tri-level based
C-PO framework for improving the market economy. The core is
to train the RES and reserve predictors that can generate cost-
oriented predictions for the market-clearing optimization task.
Numerical case studies on an IEEE 118-bus system lead to the
following conclusions:

Fig. 8. Comparison of C-PO and T-RO.

3) Discussions: The above comparisons indicate that
the
market economy of C-PO is comparable to T-SP and T-RO.
Although a clear-cut economic beneﬁt of C-PO is yet to be
observed, C-PO does present certain practical advantages.

Computational affordability to ISOs: The day-ahead market
clearing has been widely regarded as one of the most com-
putationally challenging tasks [5]. Concerning that T-SP/T-RO
is much more computationally taxing than its deterministic
counterpart, most ISOs still utilize the deterministic UC model
(2) to clear the markets. In comparison, C-PO is trained ofﬂine
and the prescriptive UC model (14) keeps a similar online
computation burden as O-PO, thus is more affordable to ISOs.
Compatibility with the current market designs: The markets
are designed to achieve maximum social welfare. Thus, ISOs
are required to identify the economically optimal UC decisions
given the predictions, which is vital to derive fair market signals
for incentivizing the market participants. However, UC decisions
of T-SP/T-RO may not follow the least-cost principle in the short
term due to the uncertainty consideration. Although better social
welfare may be reached in a long-term view, the short-term
ﬁnancial deﬁcit would demotivate the market participants [23].
While pursuing short- and long-term social welfare maximiza-
tion, ISOs in a transparent market also focus on the fairness and
interpretability of market-clearing results to market participants,
on which T-SP and T-RO could expose intrinsic obstacles in
practical application. For T-SP, a stable market-clearing result
mathematically requires a sufﬁciently large number of scenarios,
which, however, will undoubtedly magnify the existing computa-
tional challenge and ultimately end up with a trade-off between
the number of scenarios and result stability; while for T-RO,
subject to the availability of tractable reformulation, adaptable
uncertainty budget forms are usually simple, abstract, and heav-
ily parameter-dependent. These together lead to volatility and
poor interpretability of market-clearing results.

Speciﬁcally, different scenario sets and uncertainty budget
settings, even with tiny differences, could lead to noticeable unit
commitment changes that may signiﬁcantly affect the revenues
of certain market participants, especially those who are commit-
ted/decommitted from one case to another. Scenario generation
inevitably introduces randomness, which practically will arouse

6.57.68.79.810.95102030405060708090100Peak-Load Day of Fall11/30/2020Width: 3.39Width: 0.036.26.87.48.08.65102030405060708090100Peak-Load Day of Spring03/05/2020Width: 1.60Width: 0.036.36.97.58.18.75102030405060708090100Peak-Load Day of Summer08/11/2020Width: 2.02Width: 0.049.010.111.212.313.45102030405060708090100Peak-Load Day of Winter12/10/2020Cost of T-SP-NSCost Gap of C-PO-NTWidth: 2.01Width: 0.10Number ofScenarios (NS)Number ofScenarios(NS)Actual System Cost/105$Actual System Cost/105$(a). Market-economy comparison of C-PO and T-SP 0100200300400500600700123456789101112131415161718192021222324Total Reserve Schedules/MWHourPeak-Load Day of Fall 11/30/2020(b). Reserve-schedule comparison of C-PO and T-SPT-SP-75T-SP-100T-SP-5T-SP-50C-PO-AT-SP-A6.76.86.97.07.112162024283236404448Peak-Load Day of Fall11/30/20206.26.36.46.56.612162024283236404448Peak-Load Day of Spring03/05/20206.46.56.66.76.812162024283236404448Peak-Load Day of Summer08/11/20209.09.710.411.111.812162024283236404448Peak-Load Day of Winter12/10/2020Cost of T-RO-NBCost Gap of C-PO-NTNumber of Budget (NB)Number of Budget (NB)Actual System Cost/105$Actual System Cost/105$(a). Market-economy comparison of C-PO and T-RO 0100200300400500600700123456789101112131415161718192021222324Total Reserve Schedules/MWHourPeak-Load Day of Fall 11/30/2020(b). Reserve-schedule comparison of C-PO and T-ROT-RO-32T-RO-48T-RO-12T-RO-20T-RO-AC-PO-A10

•

•

C-PO can economically outperform the traditional O-PO.
According to the results on eight selective weeks, C-PO
leads to a 0.82% improvement in the daily market economy
on average, even though the cost-oriented RES predictions
may have slightly worse MAEs.
Although market economy performance of C-PO, T-SP, and
T-RO are comparable, C-PO presents higher practical values
due to its compatibility with the current market designs.
Thus, C-PO has the potential to serve as a bridge between
T-SP/T-RO and the current market practice.
Sensitivity analysis suggests that simultaneously predicting
RES and reserves to assess their joint ultimate economic
consequence outperforms predicting them individually.
Future work could focus on accelerating the training process

•

of C-PO to further enhance its applicability in ISO’s practice.

APPENDIX

Proof: To prove Proposition 1, problem (20) is built to serve
as a bridge between (8) and (10), which is constructed by adding
(20.4) to (8) or adding (20.6) to (10).

,zs

min
s. t. ˆw(cid:5)s = W( ˆws); ˆr(cid:5)s = R( ˆws,ˆls)

,
R

∈S

W

[a(cid:62)xs + c(cid:62)rs + d(cid:62)zs]/|S|

(cid:80)
s

W(·) ∈ P w; R(·) ∈ P r; rs ≤ ˆr(cid:5)s
zs ∈ Z(xs, ys, rs, ˜ws)
xs, ys, rs ∈

arg min

(xs,ys,rs)

( ˆw(cid:5)

s ,ˆr(cid:5)
s )

∈X

zs ∈

zs

arg min
(xs,ys,rs, ˜ws)

∈Z

d(cid:62)zs

(20.1)
(20.2)
(20.3)
(20.4)

∀s ∈ S
∀s ∈ S
∀s ∈ S
a(cid:62)xs + b(cid:62)ys + c(cid:62)rs

∀s ∈ S
∀s ∈ S

(20.5)
(20.6)

First, we claim that optimal solutions of (8) and (20) are the
same because of their identical objective functions and feasible
regions. They have the same feasible regions because: (i) a
feasible solution of (8) satisﬁes all constraints of (20) and thus
is feasible to (20); and (ii) a feasible solution of (20) also meets
all constraints of (8) and thus is feasible to (8). Thus, it is direct
to conclude that (8) and (20) have the same optimal solutions.
Second, we claim that the optimal solution of (10) is also
optimal for (20). Note that as (10) is equivalent to (20.1)-(20.5),
we only need to show that the optimal solution of (10) also
s, y(cid:63)
satisﬁes (20.6). Speciﬁcally, if Ω(cid:63) (including x(cid:63)
s, and
z(cid:63)
s) is an optimal solution of (10), z(cid:63)
s must be optimal for (21)
that is constructed by ﬁxing all variables in (10) to their optima
except zs. Problem (21) is equivalent to (20.6), i.e., z(cid:63)
s satisﬁes
(20.6). Thus, because Ω(cid:63) is optimal for (20.1)-(20.5) and its z(cid:63)
s
also satisﬁes (20.6), Ω(cid:63) must be optimal for (20).

s, r(cid:63)

minzs
s. t.

(cid:80)
s
∈S
zs ∈

[a(cid:62)x(cid:63)

s + c(cid:62)r(cid:63)
arg min
(x(cid:63)
s ,y(cid:63)
s ,r(cid:63)

s , ˜ws)

zs

∈Z

s + d(cid:62)zs]/|S|

d(cid:62)zs ∀s ∈ S

(21.1)
(21.2)

From the above two claims, it is direct to conclude that the
optimal solution of (10) is optimal for (20), and thus is also
optimal for (8).

REFERENCES

[1] M. Parvania, M. Fotuhi-Firuzabad, and M. Shahidehpour, “ISO’s optimal
strategies for scheduling the hourly demand response in day-ahead mar-
kets,” IEEE Trans. Power Syst., vol. 29, no. 6, pp. 2636–2645, 2014.
[2] Y. Chen, Q. Guo, and H. Sun, “Decentralized unit commitment in inte-
grated heat and electricity systems using SDM-GS-ALM,” IEEE Trans.
Power Syst., vol. 34, no. 3, pp. 2322–2333, 2019.

[3] T. Ding, R. Bo, W. Gu, Q. Guo, and H. Sun, “Absolute value constraint
based method for interval optimization to SCED model,” IEEE Trans.
Power Syst., vol. 29, no. 2, pp. 980–981, 2014.

[4] Y. Wang and L. Wu, “Improving economic values of day-ahead load
forecasts to real-time power system operations,” IET Gener. Transm.
Distrib., vol. 11, no. 17, pp. 4238–4247, 2017.

[5] K. Bruninx and E. Delarue, “Endogenous probabilistic reserve sizing and
allocation in unit commitment models: Cost-effective, reliable, and fast,”
IEEE Trans. Power Syst., vol. 32, no. 4, pp. 2593–2603, 2017.

[6] L. Wu, M. Shahidehpour, and T. Li, “Stochastic security-constrained unit
commitment,” IEEE Trans. Power Syst., vol. 22, no. 2, pp. 800–811, 2007.
[7] B. Hu and L. Wu, “Robust SCUC considering continuous/discrete uncer-
tainties and quick-start units: A two-stage robust optimization with mixed-
integer recourse,” IEEE Trans. Power Syst., vol. 31, no. 2, pp. 1407–1419,
2016.

[8] D. Bertsimas and N. Kallus, “From predictive to prescriptive analytics,”

Manage. Sci., vol. 66, no. 3, pp. 1025–1044, 2020.

[9] G.-Y. Ban and C. Rudin, “The big data newsvendor: Practical insights from

machine learning,” Oper. Res., vol. 67, no. 1, pp. 90–108, 2019.

[10] A. N. Elmachtoub and P. Grigas, “Smart “predict, then optimize”,” Manage.

Sci., vol. 68, no. 1, pp. 9–26, 2022.

[11] G. Li and H.-D. Chiang, “Toward cost-oriented forecasting of wind power
generation,” IEEE Trans. Smart Grid, vol. 9, no. 4, pp. 2508–2517, 2018.
[12] A. C. Stratigakos, S. Camal, A. Michiorri, and G. Kariniotakis, “Prescrip-
tive trees for integrated forecasting and optimization applied in trading of
renewable energy,” IEEE Trans. Power Syst., pp. 1–1, 2022.

[13] T. Carriere and G. Kariniotakis, “An integrated approach for value-
oriented energy forecasting and data-driven decision-making application
to renewable energy trading,” IEEE Trans. Smart Grid, vol. 10, no. 6, pp.
6933–6944, 2019.

[14] J. Han, L. Yan, and Z. Li, “A task-based day-ahead load forecasting model
for stochastic economic dispatch,” IEEE Trans. Power Syst., vol. 36, no. 6,
pp. 5294–5304, 2021.

[15] L. Sang, Y. Xu, H. Long, Q. Hu, and H. Sun, “Electricity price prediction
for energy storage system arbitrage: A decision-focused approach,” IEEE
Trans. Smart Grid, vol. 13, no. 4, pp. 2822–2832, 2022.

[16] C. Zhao, C. Wan, and Y. Song, “Operating reserve quantiﬁcation using
prediction intervals of wind power: An integrated probabilistic forecasting
and decision methodology,” IEEE Trans. Power Syst., vol. 36, no. 4, pp.
3701–3714, 2021.

[17] M. A. Mu˜noz, J. M. Morales, and S. Pineda, “Feature-driven improvement
of renewable energy forecasting and trading,” IEEE Trans. Power Syst.,
vol. 35, no. 5, pp. 3753–3763, 2020.

[18] J. M. Morales, M.

´A. Mu˜noz, and S. Pineda, “Value-oriented fore-
casting of net demand for electricity market clearing,” arXiv preprint
arXiv:2108.01003, 2021.

[19] X. Chen, Y. Yang, Y. Liu, and L. Wu, “Feature-driven economic improve-
ment for network-constrained unit commitment: A closed-loop predict-and-
optimize framework,” IEEE Trans. Power Syst., vol. 37, no. 4, pp. 3104–
3118, 2022.

[20] C. Zhao, C. Wan, and Y. Song, “Cost-oriented prediction intervals: On
bridging the gap between forecasting and decision,” IEEE Trans. Power
Syst., vol. 37, no. 4, pp. 3048–3062, 2022.

[21] M. Mu˜noz, S. Pineda, and J. Morales, “A bilevel framework for decision-
making under uncertainty with contextual information,” Omega, vol. 108,
p. 102575, 2022.

[22] J. D. Garcia, A. Street, T. Homem-de Mello, and F. D. Mu˜noz,
“Application-driven learning via joint prediction and optimization of de-
mand and reserves requirement,” arXiv preprint arXiv:2102.13273, 2021.
[23] V. Dvorkin, S. Delikaraoglou, and J. M. Morales, “Setting reserve require-
ments to approximate the efﬁciency of the stochastic dispatch,” IEEE Trans.
Power Syst., vol. 34, no. 2, pp. 1524–1536, 2019.

[24] N. Viafora, S. Delikaraoglou, P. Pinson, G. Hug, and J. Holbøll, “Dynamic
reserve and transmission capacity allocation in wind-dominated power
systems,” IEEE Trans. Power Syst., vol. 36, no. 4, pp. 3017–3028, 2021.
[25] B. Zeng and Y. An, “Solving bilevel mixed integer program by reformu-

lations and decomposition,” Optim. Online, 2014.

[26] (2022) OpenDataElia. [Online]. Available: opendata.elia.be/pages/home.
[27] (2022) Codes and dataset for “Improving Electricity Market Economy
via Closed-Loop Predict-and-Optimize”. [Online]. Available: github.com/
asxadf/CPO for Electricity Market.

[28] W. Wei, F. Liu, and S. Mei, “Distributionally robust co-optimization of
energy and reserve dispatch,” IEEE Trans. Sustain. Energy, vol. 7, no. 1,
pp. 289–300, 2016.

[29] J. Dupaˇcov´a, N. Gr¨owe-Kuska, and W. R¨omisch, “Scenario reduction in
stochastic programming,” Math. Program., vol. 95, no. 3, pp. 493–511,
2003.

