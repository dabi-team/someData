9
1
0
2

n
u
J

6

]

G
L
.
s
c
[

1
v
5
8
3
2
0
.
6
0
9
1
:
v
i
X
r
a

ASP-based Discovery of Semi-Markovian Causal Models under Weaker
Assumptions
Zhalama1∗ , Jiji Zhang2 , Frederick Eberhardt3 , Wolfgang Mayer1 and Mark Junjie Li4
1University of South Australia
2Lingnan University
3California Institute of Technology
4Shenzhen University
zhalama@mymail.unisa.edu.au, jijizhang@ln.edu.hk, fde@caltech.edu, wolfgang.mayer@unisa.edu.au,
jj.li@szu.edu.cn

Abstract

In recent years the possibility of relaxing the so-
called Faithfulness assumption in automated causal
discovery has been investigated. The investiga-
tion showed (1) that the Faithfulness assumption
can be weakened in various ways that in an impor-
tant sense preserve its power, and (2) that weak-
ening of Faithfulness may help to speed up meth-
ods based on Answer Set Programming. However,
this line of work has so far only considered the dis-
covery of causal models without latent variables.
In this paper, we study weakenings of Faithfulness
for constraint-based discovery of semi-Markovian
causal models, which accommodate the possibility
of latent variables, and show that both (1) and (2)
remain the case in this more realistic setting.

1 Introduction
Causal inference is of great interest in many scientiﬁc ar-
eas, and automated discovery of causal structure from data
is drawing increasingly more attention in the ﬁeld of ma-
chine learning. One of the standard approaches to auto-
mated causal discovery, known as the constraint-based ap-
proach, seeks to infer from data statistical relations among
a set of random variables, and translate those relations into
constraints on the underlying causal structure so that fea-
tures of the causal structure may be determined from the con-
straints [Spirtes et al., 2000; Pearl, 2000]. In this approach,
the most commonly used constraints are in the form of con-
ditional (in)dependence, which can serve as constraints on
the causal structure due in the ﬁrst place to the well known
causal Markov assumption. The assumption states roughly
that a causal structure, as represented by a directed acyclic
graph (DAG), entails a certain set of conditional indepen-
dence statements. With this assumption, a conditional de-
pendency found in the data constrains the causal DAG.

The causal Markov assumption is almost universally ac-
cepted by researchers on causal discovery. However, by itself
the assumption is too weak to enable interesting causal infer-
ence [Zhang, 2013]. It is therefore usually supplemented with

∗Contact Author

an assumption known as Faithfulness, which states roughly
that unless entailed by the causal structure according to the
Markov assumption, no conditional independence relation
should hold. With this assumption, conditional independence
relations found in the data also constrain the causal DAG.

Unlike the causal Markov assumption, the Faithfulness as-
sumption is often regarded as questionable. The standard de-
fense of the assumption is that violations of Faithfulness in-
volve ﬁne-tuning of parameters (such as two causal pathways
balancing out exactly), which is very unlikely if we assume
parameter values are somehow randomly chosen. However,
parameter values may not be randomly chosen, especially in
situations where balancing of multiple causal pathways may
be part of the design. More importantly, even if the true distri-
bution is faithful to the true causal structure, with ﬁnite data,
“apparent violations” of faithfulness can result from errors
in statistical tests, when a false hypothesis of conditional in-
dependence fails to be rejected. Such apparent violations of
faithfulness cannot be reasonably assumed away [Uhler et al.,
2013] and will bring troubles to causal discovery that assumes
Faithfulness [Meek, 1996; Robins et al., 2003].

For these reasons, in recent years the possibility of relaxing
the Faithfulness assumption has been investigated [Ramsey et
al., 2006; Zhang and Spirtes, 2008; Zhang, 2013; Spirtes and
Zhang, 2014; Raskutti and Uhler, 2014; Forster et al., 2017].
This line of work made it clear that in the context of learn-
ing causal models with no latent variables, the Faithfulness
assumption can be weakened or generalized in a number of
ways while retaining its inferential power, because in theory
these assumptions all reduce to the Faithfulness assumption
when the latter happens to hold.

On a more practical note, causal discovery algorithms have
also been developed to ﬁt some of these weaker assumptions,
most notably the Conservative PC algorithm [Ramsey et al.,
2006] and the greedy permutation-based algorithms [Wang et
al., 2017; Solus et al., 2017]. More systematically, Zhalama
et al. [2017] implemented and compared a number of weak-
enings of Faithfulness in the ﬂexible approach to causal dis-
covery based on Answer Set Programming (ASP) [Hyttinen
et al., 2014]. Among other things, they found, rather surpris-
ingly, that some weakenings signiﬁcantly boost the time ef-
ﬁciency of ASP-based algorithms. Since the main drawback
of the ASP-based approach lies with its feasibility, this ﬁnd-

 
 
 
 
 
 
ing is potentially consequential for the further development
of this approach.

However, neither the theoretical investigation nor the ASP-
based practical exploration went beyond the limited (and un-
realistic) context of learning causal models in the absence of
latent confounding, also known as causal discovery with the
assumption of causal sufﬁciency [Spirtes et al., 2000]. Since
latent confounding is ubiquitous, it is a serious limitation to
restrict the study to causally sufﬁcient settings. And it is es-
pecially unsatisfactory from the perspective of the ASP-based
approach, which boasts the potential to deal with a most gen-
eral search space that accommodates the possibility of latent
confounding and that of causal loops [Hyttinen et al., 2013].
In this paper, we make a step towards remedying this lim-
itation by generalizing the aforementioned investigation in a
setting where latent confounding is allowed (but not causal
loops; we remark on a complication that will arise in the
presence of causal loops in the end.) Since the investigation
appeals to the ASP-based platform, we will follow previous
work on this topic to use semi-Markovian causal models to
represent causal structures with latent confounders. Among
other things, we show that it remains the case that (1) the
Faithfulness assumption can be weakened in various ways
that in an important sense preserve its power, and (2) weaken-
ing of Faithfulness may help to speed up ASP-based methods.
The remainder of the paper will proceed as follows.
In
Section 2, we introduce terminologies and describe the ba-
sic setup. In Section 3, we review a few ways to relax the
Faithfulness assumption that have been proposed in the con-
text of causal discovery with causal sufﬁciency and have been
proved to be conservative in a sense we will specify. Then,
in Section 4, we discuss the complications that arise with
semi-Markovian causal models, and establish generalizations
of the results mentioned in Section 3. This is followed by
a discussion in Section 5 of how to implement the weaker
assumptions in the ASP platform. Finally, we report some
simulation results in Section 6 that demonstrate the speed-up
mentioned above, and conclude in Section 7.

2 Preliminaries

In this paper, the general graphical representation of a causal
structure is by way of a mixed graph. The kind of mixed
graph we will use is a triple (V, E1, E2), where V is a set
of vertices (each representing a random variable), E1 a set
of directed edges (→) and E2 a set of bi-directed edges (↔).
In general, more than one edge is allowed between two ver-
tices, but no edge is allowed between a vertex and itself. Two
vertices are said to be adjacent if there is at least one edge
between them. Given an edge X → Y , X is called a par-
ent of Y and Y a child of X. We also say the edge has
a tail at X and an arrowhead at Y . An edge X ↔ Y is
said to have an arrowhead at both X and Y . A path be-
tween X and Y consists of an ordered sequence of distinct
vertices (cid:104)X = V1, ..., Vn = Y (cid:105) and a sequence of edges
(cid:104)E1, ..., En−1(cid:105) such that for 1 ≤ i ≤ n − 1, Ei is an edge
between Vi and Vi+1. Such a path is a directed path if for all
1 ≤ i ≤ n − 1, Ei is a directed edge from Vi to Vi+1. X is an
ancestor of Y and Y an descendant of X, if either X = Y or

there is a directed path from X to Y . A directed cycle occurs
when two distinct vertices are ancestors of each other.

If a mixed graph does not contain any directed cycle, we
will call it a semi-Markovian causal model (SMCM), also
known as an acyclic directed mixed graph (ADMG). Intu-
itively a directed edge in an SMCM represents a direct causal
relationship, and a bi-directed edge represents the presence
of latent confounding. A directed acyclic graph (DAG) is a
special case where no bi-directed edge appears. A DAG can
be thought of as representing a causal model over a causally
sufﬁcient set of random variables, which may be referred to
as a Markovian causal model (MCM).

The conditional independence statements entailed by a
graph can be determined graphically by a separation crite-
rion. One statement of this criterion is m-separation, which
is a natural generalization of the celebrated d-separation cri-
terion for DAGs [Pearl, 1988]. Given any path in a mixed
graph G, a non-endpoint vertex V on the path is said to be a
collider on the path if both edges incident to V on the path
have an arrowhead at V . Otherwise it is said to be a non-
collider on the path.

Deﬁnition 1 (m-connection and m-separation). Given a
mixed graph G over V and Z ⊆ V, a path in G is m-
connecting given Z if every non-collider on the path is not
in Z and every collider on the path has a descendant in Z.

For any distinct X, Y /∈ Z, X and Y are m-separated by Z
in G (written as X ⊥G Y | Z) if there is no path between X
and Y that is m-connecting given Z. Otherwise X and Y are
said to be m-connected by Z.

For any X, Y, Z ⊆ V that are pairwise disjoint, X and
Y are m-separated by Z in G if every vertex in X and every
vertex in Y are m-separated by Z.

This deﬁnition obviously reduces to that of d-connection
and d-separation in the case of DAGs. It is well known that
in a DAG, two vertices are adjacent if and only if no set of
other vertices d-separates them. The ‘only if’ direction holds
for SMCMs, but the ‘if’ direction does not. For example, in
the simple SMCM in Figure 1, V1 and V3 are not adjacent,
but neither the empty set nor the set {V2} m-separates them.
This motivates the following deﬁnition.

Figure 1: An inducing path between two non-adjacent vertices

Deﬁnition 2 (inducing path). A path between X and Y is an
inducing path if every non-endpoint vertex on the path is a
collider and also an ancestor of either X or Y .

For example, in Figure 1, the path V1 → V2 ↔ V3 is an
inducing path between V1 and V3. In general, two vertices in
an SMCM are not m-separated by any set of other variables
if and only if there is an inducing path between them [Verma,
1993]. Note that an edge between two vertices constitutes an
inducing path. Following Richardson [1997], we call two ver-

tices virtually adjacent if there is an inducing path between
them. Adjacency entails virtual adjacency, but not vice versa.

3 Faithfulness and its weakening for learning
causal models without latent variables

We now review some proposals of weakening the Faithful-
ness assumption in the context of learning (acyclic) causal
structures in the absence of latent confounding.
In such
a case, the target is a DAG over the given set of random
variables V, in which each edge represents a direct causal
relation relative to V [Spirtes et al., 2000]. Let G denote the
unknown true causal DAG over V, and P denote the true
joint probability distribution over V. The causal Markov
assumption can be formulated as:

Causal Markov assumption For every pairwise dis-
joint X, Y, Z ⊆ V, if X ⊥G Y | Z, then X ⊥⊥ P Y | Z.

where ‘X ⊥G Y | Z’ means that X and Y are d-separated
by Z in G, and ‘X ⊥⊥ P Y | Z’ means that X and Y are
independent conditional on Z according to P .

The converse is the Faithfulness assumption:

Causal Faithfulness assumption For every pairwise
disjoint X, Y, Z ⊆ V, if X ⊥⊥ P Y | Z, then X ⊥G Y | Z.

As mentioned earlier,

the Faithfulness assumption is
regarded as much more questionable than the Markov
assumption, and the literature has seen a number of proposals
to relax it. In this paper, we focus on the following three.1

Adjacency-faithfulness assumption For every distinct
X, Y ∈ V, if X and Y are adjacent in G, then X \⊥⊥P Y | Z,
for every Z ⊆ V \ {X, Y }.

Number-of-Edges(NoE)-minimality assumption: G is
NoE-minimal in the sense that no DAG with a smaller
number of edges than G satisﬁes the Markov assumption
with P .

Number-of-Independencies(NoI)-minimality
assump-
tion: G is NoI-minimal in the sense that no DAG that entails
a greater number of conditional independence statements
than G does, satisﬁes the Markov assumption with P .

Under the Markov assumption,

these assumptions are
all weaker than the Faithfulness assumption.
In words,
Adjacency-faithfulness says that two variables that are adja-
cent in the causal structure are dependent given any condi-
tioning set. It was ﬁrst introduced in Ramsey et al. [2006]
and motivated the CPC (conservative PC) algorithm. NoE-
minimality says that the true causal structure has the least
number of edges among all structures that satisfy the Markov

1Another two proposals are known as ‘Triangle-Faithfulness
plus SGS-minimality’ [Spirtes and Zhang, 2014] and ‘P-minimality’
[Zhang, 2013]. It is not yet clear how to implement the latter in ASP,
and the former did not seem to help much with ASP-based methods
[Zhalama et al., 2017].

assumption.
It underlies the novel permutation-based al-
gorithms that were developed recently [Raskutti and Uhler,
2014; Wang et al., 2017; Solus et al., 2017]. NoI-minimality
says that the true causal structure entails the greatest number
of conditional independence statements among all structures
that satisfy the Markov assumption. In the ASP-based meth-
ods, the ‘hard-deps’ conﬂict resolution scheme in Hyttinen et
al. [2014] happened to implement this minimality constraint.
Theoretically these assumptions are particularly interesting
because although they are weaker than Faithfulness (given the
Markov assumption), they are in a sense strong enough to pre-
serve the inferential power of Faithfulness. It has been shown
that when Faithfulness happens to hold, all these weaker as-
sumptions become equivalent to Faithfulness [Zhalama et al.,
2017]. In other words, while they are weaker than Faithful-
ness and therefore still hold in many cases when Faithful-
ness does not, they rule out exactly the same causal graphs as
Faithfulness does when the latter happens to be satisﬁed. We
propose to call this kind of weakening conservative, for it re-
tains the inferential power of Faithfulness whenever Faithful-
ness is applicable. The choice between a stronger assumption
and a weaker one usually involves a trade-off between risk (of
making a false assumption) and inferential power, but there is
no such trade-off if the weakening is conservative.

In addition to this theoretical virtue, both Adjacency-
faithfulness and NoE-minimality, and especially Adjacency-
faithfulness, have been shown to signiﬁcantly improve the
time efﬁciency of ASP-based causal discovery methods,
without signiﬁcant sacriﬁce in performance [Zhalama et al.,
2017]. We aim to extend these ﬁndings to the much more
realistic setting where latent confounding may be present.

4 Weakening Faithfulness for learning
semi-Markovian causal models

When the set of observed variables V is not causally sufﬁ-
cient, which means that some variables in V share a common
cause or confounder that is not observed, it is no longer ap-
propriate to represent the causal structure in question with a
DAG over V. One option is to explicitly invoke latent vari-
ables in the representation and assume the underlying causal
structure is properly represented by a DAG over V plus some
latent variables L. Another option is to suppress latent vari-
ables and use bi-directed edges to represent latent confound-
ing. The use of SMCMs exempliﬁes the latter approach.2

As Verma [1993] showed, for every DAG over V and set
of latent variables L, there is a unique projection into an
SMCM over V that preserves both the causal relations among
V and the entailed conditional independence relations among
V. Moreover, as Richardson [2003] pointed out, the original
causal DAG with latent variables and its projection into an
SMCM are equivalent regarding the (nonparametric) identiﬁ-
cation of causal effects. These facts justify using SMCMs to
represent causal structures with latent confounding.

So let us suppose the underlying causal structure over V
is properly represented by an SMCM G and let P denote

2Another important example is the use of ancestral graph Markov
models [Richardson and Spirtes, 2002], which we describe in the
appendices.

the true joint distribution over V. In this setting, the causal
Markov and Faithfulness assumptions can be formulated as
before (in Section 3), except that the separation criterion is
now understood as the more general m-separation. Next we
examine the proposals of weakening Faithfulness.

Regarding Adjacency-faithfulness, it is easy to see that it
remains a logical consequence of Faithfulness. If two vari-
ables are adjacent in an SMCM, then given any set of other
variables, the two are m-connected (any edge between them
constitutes a m-connecting path). Thus, if Faithfulness holds,
then they are not independent conditional on any set of other
variables, exactly what is required by Adjacency-faithfulness.
Since Adjacency-faithfulness does not entail Faithfulness in
the case of DAGs and DAGs are special cases of SMCMs,
Adjacency-faithfulness remains weaker than Faithfulness.

However, it is now too weak to be a conservative weak-
ening of Faithfulness. Here is a very simple example. Sup-
pose the true causal structure over three random variables is
a simple causal chain V1 → V2 → V3, and suppose the joint
distribution is Markov and Faithful to this structure. So we
have V1 ⊥⊥ V3 | V2. Then the distribution is not Faithful to
the structure in Figure 1, because that structure does not en-
tail that V1 and V3 are m-separated by V2. Still, Adjacency-
faithfulness is satisﬁed by the distribution and the structure
in Figure 1, for the only violation of Faithfulness occurs with
regard to V1 and V3, which are not adjacent. Therefore, in
this simple case where Faithfulness happens to hold, if we
just assume Adjacency-faithfulness, we are not going to rule
out the structure in Figure 1, which would be ruled out if we
assumed Faithfulness.

This simple example suggests that we should consider the

following variation:

V(irtual)-adjacency-faithfulness assumption:
For ev-
ery distinct X, Y ∈ V, if X and Y are virtually adjacent in
G (i.e., if there is an inducing path between X and Y in G),
then X \⊥⊥P Y | Z, for every Z ⊆ V \ {X, Y }.

V-adjacency-faithfulness

than
Adjacency-faithfulness, but we can prove that it remains
weaker than Faithfulness. More importantly, it is strong
enough to be a conservative weakening of Faithfulness.

is obviously stronger

How about NoE-minimality? Since more than one edge
can appear between two vertices, NoE-minimality (as it is
formulated in Section 3) is no longer a consequence of Faith-
fulness. To see this, just suppose the true structure over two
random variables is simply V1 → V2 together with V1 ↔ V2
(i.e., V1 is a cause of V2 but the relation is also confounded),
and suppose the distribution is Markov and Faithful to this
structure. NoE-minimality is violated here, for taking away
either (but not both) of the two edges still results in a structure
that satisﬁes the Markov assumption.

So NoE-minimality is not a weakening of Faithfulness.
Note that in the case of DAGs, minimization of the number
of edges is equivalent to minimization of the number of ad-
jacencies. If we replace the former with the latter, the above
example is taken care of (for taking away the adjacency in
that example will result in a structure that fails the Markov
assumption). However, it is also easy to construct an example

where an adjacency in an SMCM can be taken away without
affecting the independence model [Richardson and Spirtes,
2002], so adjacency-minimality also fails to be a weakening
of Faithfulness. The right generalization of NoE-minimality
is unsurprisingly the following:

V(irtual)-adjacency-minimality assumption: G is V-
adjacency-minimal
in the sense that no SMCM with a
smaller number of virtual adjacencies than G satisﬁes the
Markov assumption with P .

Finally, since NoI-minimality is concerned with entailed
conditional independence statements, it is straightforwardly
generalized to the setting of SMCMs (just replace ‘DAG’
with ‘SMCM’ in the original formulation), and remains a
conservative weakening of Faithfulness. Here then is the
main result of this section (a proof of which is given in Ap-
pendix C).
Theorem. Given the causal Markov assumption,
the V-
adjacency-faithfulness assumption, V-adjacency-minimality
assumption, and NoI-minimality assumptions are all conser-
vative weakenings of the Faithfulness assumption, in the fol-
lowing sense: for each of the three assumptions AS,
(a) AS is entailed by, but does not entail, Faithfulness.
(b) For every joint probability distribution P over V, if there
exists an SMCM that satisﬁes both Markov and Faith-
fulness assumptions with P , then for every SMCM G
that satisﬁes the Markov assumption with P , G satisﬁes
Faithfulness if and only if G satisﬁes AS with P .

5 ASP-based Causal Discovery of SMCMs
We instantiated causal discovery algorithms, which adopt
V-adjacency-faithfulness and V-adjacency-minimality, using
the framework of Hyttinen et al. [2014]. This framework
offers a generic constraint-based causal discovery method
based on Answer Set Programming (ASP). The logic is
used to deﬁne Boolean atoms that represent the presence
or absence of a directed or bi-directed edge in an SMCM.
In addition, conditional independence/dependence statements
(CI/CDs) obtained from tests on the input data are encoded in
this logic. Finally, background assumptions, such as Markov
and Faithfulness, are written as logical constraints enforcing a
correspondence between the encoded test results and the un-
derlying Boolean atoms (the edges of the SMCM). Solutions,
which are truth-value assignments to the Boolean atoms, sat-
isfying such a correspondence are found using off-the-shelf
solvers. The set of solutions speciﬁes the set of SMCMs
that satisfy all the input CI/CDs and the background assump-
tions. Given that the results of the statistical tests may conﬂict
with the background assumptions, there may be no solution,
i.e. there is no SMCM that satisﬁes all the input CI/CDs and
background assumptions. For that case Hyttinen et al. [2014]
introduced the following optimization to resolve the conﬂict:

G∗ ∈ arg min
G∈G

(cid:88)

w(k)

k∈K s.t. G(cid:54)|=k

(1)

In words, an output graph G∗ minimizes the weighted sum of
input CI/CDs, which it does not satisfy given the encoded

background assumptions. Hyttinen et al. [2014] adopted
three weighting schemes for the weights w(.): (1) “constant
weights” (CW) assigns a weight of 1 to each CI and CD con-
straint. (2) “hard dependencies” (HW/NoI-m) assigns inﬁnite
weight to any observed CD, and a weight of 1 to any CI. (3)
“log weights” (LW) is a pseudo-Bayesian weighting scheme,
where the weights depend on the log posterior probability of
the CI/CDs being true (see their Sec. 4).

To encode V-adjacency-faithfulness and V-adjacency-
minimality, we need to encode in ASP what it is for an
SMCM to have an inducing path and a virtual adjacency, and
then replace the encoding of the Faithfulness assumption in
Hyttinen et al. [2014] with its weaker versions. Figure 2 sum-
marizes the ASP-encoding of V-adjacency-faithfulness and
V-adjacency-minimality. We brieﬂy explain the predicates:

• edge(X, Z) and conf (X, Z): X → Z and X ↔ Z,

respectively, are in the SMCM.

Inference rules for virtual-adjacency:

h(X, Z, Y ) :- edge(X, Z), ancestors(Z, X, Y ).

h(X, Z, Y ) :- conf (X, Z), ancestors(Z, X, Y ).

h(X, Z, Y ) :- h(X, U, Y ), conf (Z, U ), ancestors(Z, X, Y ).

t(X, Z, Y ) :- h(X, U, Y ), edge(Z, U ), ancestors(Z, X, Y ).

vadj(X, Y ) :- h(X, Y, Y ).

vadj(X, Y ) :- t(X, Y, Y ).

vadj(X, Y ) :- edge(Y, X).

Virtual-adjacency-faithfulness (violations):
∀X∀Y > X, ∀C ⊆ V \ {X, Y },

:- not vadj(X, Y ), indep(X, Y, C, w)

Virtual-adjacency-minimality (optimization of weak con-
straints):
∀X∀Y > X,

f ail(X, Y, w = 1) :- vadj(X, Y ).

• ancestors(Z, X, Y ): Z is an ancestor of X or Y in the

:∼ fail (X, Y, w). [w]

SMCM.

• h(X, Z, Y ): There is a path between X and Z which is
into Z, and if the path consists of two or more edges,
every non-endpoint vertex on the path is a collider and
every vertex on the path is an ancestor of either X or Y .

• t(X, Z, Y ): It differs from h(X, Z, Y ) only in that the
path between X and Z is out of Z. Together, t(.) and
h(.) are used to specify the possible inducing paths.

• vadj(X, Y ): X and Y are virtually adjacent.

• indep(X, Y, C, w): X and Y are independent condi-

tional on C, given as input fact, with weight w.

For V-adjacency-faithfulness, we encode that any CI state-
ment X ⊥⊥ Y | C implies that X and Y are not virtually
adjacent. For V-adjacency-minimality, we employ the mini-
mization of the number of virtual-adjacencies. By encoding
the weaker assumptions in the framework of Hyttinen et al.
[2014], we then have the following algorithms (Hyttinen et
al.’s algorithm based on the ‘hard dependencies’ weights is
equivalent to one based on NoI-minimality):

• VadjF: Virtual-adjacency-faithfulness + Markov

• VadjM: Virtual-adjacency-minimality + Markov

6 Simulations
We report two types of simulation, one using an independence
oracle that speciﬁes the true CI/CDs of the causal model, and
one that uses the CI/CDs inferred from the sample data.

For both simulations we followed the model generation
process of Hyttinen et al. [2014] for causally insufﬁcient
models: We generated 100 random linear Gaussian mod-
els over 6 vertices with an average edge degree of 1 for di-
rected edges. The edge coefﬁcients were drawn uniformly
from [−0.8, −0.2] ∪ [0.2, 0.8]. The error covariance matrices
(which also represent the confounding) were generated using
the observational covariance matrix of a similarly constructed
causally sufﬁcient model (with its error covariances sampled
from N (0.5, 0.01)).

(Variables are in an arbitrary order so that indep(X, Y, C, w)
and dep(X, Y, C, w) are considered only if Y > X, in order
to avoid double counting.)

Figure 2: ASP Encoding of V-adjacency-faithfulness and V-
adjacency-minimality

In the oracle setting, we randomly generated 100 lin-
ear Gaussian models with latent confounders over 6 vari-
ables and then input the independence oracles implied by
these models. We observed that the algorithms based on
V-adjacency-faithfulness, on V-adjacency-minimality, and on
NoI-minimality (which is equivalent to using ‘hard depen-
dencies’ weighting) all returned the exact same results as the
algorithm based on Faithfulness did, which is consistent with
the theoretical results in Section 4 and conﬁrms the correct-
ness of our encoding.

In the ﬁnite sample case we generated ﬁve data sets with
500 samples from each of the 100 models. We used correla-
tional t-tests and tried 10 threshold values for rejecting the
null hypothesis (0.0001, 0.0005, 0.001, 0.005, 0.01, 0.05,
0.1, 0.15, 0.2, 0.25). The test results formed the input for
the algorithms. We also used the log-weighting scheme and
tried 10 values for the free parameter of the Bayesian test
(0.05, 0.09, 0.1, 0.15, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.9).

For each algorithm we output all possible solutions and
compared the d-connections common to all the output graphs
against those of the true data generating graph.
In all
the 100(models)∗5(datasets)∗10(parameters) = 5, 000 runs,
Faithfulness was satisﬁed in only 367/5000 of the cases while
V-adjacency-faithfulness was satisﬁed in 2065/5000 of the
cases. This shows that V-adjacency-faithfulness is indeed sig-
niﬁcantly weaker than Faithfulness and greatly reduces the
number of conﬂicts. By deﬁnition, V-adjacency-minimality
can always be satisﬁed. Figure 3 plots the ROC curves for the
inferred d-connections. Under “constant weighting” (CW)
“hard dependencies weighting” (HW), using V-adjacency-
faithfulness achieves comparable accuracy to using faith-

fulness, with some trade-offs between false-positive rates
and true-positive rates. Under “log weighting” (LW), how-
ever, using Faithfulness seems slightly more accurate than
using V-adjacency-faithfulness, though using V-adjacency-
minimality seems to generally yield the lowest false-positive
rates. How to adapt the “log weighting” to ﬁt V-adjacency-
faithfulness better is an interesting question for future work.

Figure 4: Sorted Solving Times for 8 Variables (time-out at 5,000s)

One great appeal of the ASP-based approach is that the
background assumptions that determine the search space can
be ﬂexibly adjusted to include causal models with both la-
tent confounding and causal feedback. We close with an
illustration of a (further) complication that arises in cyclic
causal models. Suppose the true causal structure is the cyclic
one in Figure 5(a), which entails that V1 ⊥ V2 and V1 ⊥
V2 | {V3, V4}. Suppose the true distribution is Markov and
Faithful to this structure and hence features exactly two non-
trivial conditional independencies. Then the distribution is
not Faithful to the structure in Figure 5(b) (for that struc-
ture does not entail V1 ⊥ V2 | {V3, V4}), but it is still V-
adjacency-faithful (for V1 and V2 are not virtually adjacent).

Figure 5: Illustration of a complication in cyclic models

This means that even V-adjacency-faithfulness is not a con-
servative weakening of Faithfulness when causal feedback is
allowed. Whether it can be strengthened into a useful conser-
vative weakening for the purpose of learning cyclic models is
worth further investigation.

Acknowledgments
JZ was supported by GRF LU13602818 from the RGC of
Hong Kong. FE was supported by NSF grant 1564330.

Figure 3: ROC of d-connections

Finally, to explore the efﬁciency gain of the weakened
faithfulness assumptions, we generated 100 random linear
Gaussian models with latent confounders over 8 variables and
generated one data set with 500 samples from each model.
For each algorithm, we only required that one graph be found.
Figure 4 shows the sorted solving times for the different back-
ground assumptions (with maximum time budget of 5,000s).
As in the causally sufﬁcient case, we see a signiﬁcant im-
provement in solving times when using the weakened faith-
fulness assumptions.

7 Conclusion
We have shown how to extend the results on weakening Faith-
fulness in the context of learning causal DAGs to the more
realistic context of learning SMCMs that allow for the rep-
resentation of unmeasured confounding. We identiﬁed gen-
eralizations of some proposals of weakening Faithfulness in
the literature and showed that they continue to be what we
call conservative weakenings. Moreover, we implemented
ASP-based algorithms for learning SMCMs based on these
weaker assumptions. The simulation results suggest that
some of these weaker assumptions, especially V-adjacency-
faithfulness, help to save solving time in ASP-based algo-
rithms to a signiﬁcant extent.

In this connection, a direction of future work is to explore
how the apparent advantage of using weaker assumptions
may be realized on top of other ASP-based causal discovery
methods, such as ETIO in [Borboudakis and Tsamardinos,
2016] and ACI in [Magliacane et al., 2016].

0.60.70.80.90.00.10.20.30.4FPRTPRAlgorithmVadj−mVadjF+HWVadjF+CWVadjF+LWNoI−mFaith+CWFaith+LW020406080100010002000300040005000instances (sorted for each line)solving time per instance (s)Faith+CWFaith+LWNoI−mVadjF+CWVadjF+HWVadjF+LWVadj−mAppendices

Below we prove the theorem stated in the paper. The result
is restated separately as three theorems in Section C below,
one for each of the three weakenings of the Faithfulness as-
sumption we considered. The proof makes use of maximal
ancestral graphs (MAGs), for which useful characterizations
of Markov equivalence are available. Below we proceed as
follows. In Section A, we introduce MAGs and known facts
that are relevant to our arguments. In Section B, we describe a
connection between SMCMs and MAGs that we will exploit.
Finally, in Section C, we prove the theorems.

A Maximal Ancestral Graphs
Like an SMCM, a MAG is a graphical object designed to rep-
resent a causal structure in the presence of latent variables.
An Ancestral graph is a simple mixed graph (i.e., at most one
edge can appear between any two vertices), in which for any
two vertices X and Y , if X is an ancestor of Y , then there
is no (directed or bi-directed) edge between X and Y that is
into X. A Maximal Ancestral Graph is an ancestral graph
in which for every pair of non-adjacent vertices, there exists
some set of other vertices that m-separates them. A DAG is a
special MAG which does not contain bi-directed edges.

Two DAGs are Markov equivalent if and only if they
share the same adjacencies and unshielded colliders. Al-
though Markov equivalent MAGs also share the same ad-
jacencies and unshielded colliders, these commonalities are
no longer sufﬁcient to characterize Markov equivalence be-
tween MAGs. Two Markov equivalent MAGs may also share
some shielded colliders. The deﬁnitions related to this fact
are given below.
Deﬁnition 3. [Richardson and Spirtes, 2002] A path π =
(V0, V1, ..., Vm = X, Z, Y )(m ≥ 1) is a discriminating path
for (cid:104)X, Z, Y (cid:105) in a MAG, if V0 and Y are not adjacent and
every vertex Vi, 1 ≤ i ≤ m, is a collider on π and a parent of
Y .
Deﬁnition 4. An inducing path π between X and Y is a path
on which every non-endpoint vertex is a collider and an an-
cestor of either X or Y .
Deﬁnition 5. [Ali et al., 2009]: Call (cid:104)X, Z, Y (cid:105) a triple if
X, Z are adjacent and Y, Z are adjacent. The order of such a
triple in a MAG is deﬁned recursively as follows:

Order 0. A triple (cid:104)X, Z, Y (cid:105) has order 0 if X and Y are not

adjacent.

Order i. A triple (cid:104)X, Z, Y (cid:105) has order i, if it does not
have any order less than i, and there is a discriminating path
(cid:104)V0, V1, ..., Vm = X, Z, Y (cid:105) or (cid:104)V0, V1, ..., Vm = Y, Z, X(cid:105),
on which every collider triple centered at Vj (1 ≤ j ≤ m)
has order at most i − 1 (and at least one of them has order
i − 1).

A discriminating path for (cid:104)X, Z, Y (cid:105) is said to have order i
if except for (cid:104)X, Z, Y (cid:105), every collider triple on the path has
order less than i and at least one of them has order i − 1. Note
that some triples in a graph may not have an order. Note also
that the order (if any) of a shielded triple is the minimum of
all discriminating paths with order for that triple [Ali et al.,

2009]. Colliders with order ≥ 1 are those shielded colliders
that are present in all Markov equivalent MAGs.

Proposition 1 [Ali et al., 2009] Two MAGs are Markov
equivalent if and only if they have the same adjacencies and
the same colliders with order.

B SMCMs and MAGs
SMCMs and MAGs are both generalizations of DAGs. Like
in DAGs, directed cycles are not allowed in SMCMs or
MAGs. But unlike DAGs, they can contain bi-directed edges
(↔) in addition to the directed edges (→). However, almost
directed cycles — where one endpoint of a bi-directed edge is
an ancestor of the other endpoint — are allowed in SMCMs
but not in MAGs. For this reason at most one edge is allowed
between any two variables in a MAG, while in SMCMs up to
two edges (one directed and one bi-directed) are allowed. Be-
sides, the interpretation of an edge in an SMCM is different
from that in a MAG. A directed edge X → Y in an SMCM
means that X is a direct cause of Y relative to V. A bi-
directed edge X ↔ Y means that X and Y are confounded
by a latent variable. In contrast, in a MAG a directed edge
X → Y represents that X is a causal ancestor of Y , and a bi-
directed edge X ↔ Y means that X is not an ancestor of Y
and Y is not an ancestor of X (which then imply that they are
confounded by a latent variable). If X is a causal ancestor of
Y (that is not mediated by any other observed variable), and
they also have a common cause which is latent, then only a
directed edge X → Y is present in the corresponding MAG.
For a causally insufﬁcient system V, we assume that there
is a causal DAG G over V ∪ L (where L is a set of latent
variables) that satisﬁes the causal Markov assumption. The
set of m-separations (d-separations) entailed by G is called
the independence model associated with G and denoted as
J(G). The marginal independence model of J(G) over V
after leaving out the set of latent variables L is the subset
of m-separations (d-separations) entailed by G which do not
involve any variables in L. We denote it as J(G)|L. Given G
over V ∪ L, there is a unique MAG M and a unique SMCM
S over V, which represent some causal relations among V in
G and the marginal independence model of G over V.

A DAG over V with latent variables L can be projected
into such an SMCM in the following way [Verma, 1993; Tian
and Pearl, 2002]:

Input: a DAG G over V ∪ L
Output: an SMCM SG over V

1. Add each variable in V as a node of SG.
2. For each pair of variables X, Y ∈ V, if there is an edge

between them in G, add the edge to SG.

3. For each pair of variables X, Y ∈ V, if there is a di-
rected path from X to Y in G such that every mid node
on the path is in L, add edge X → Y to SG, if it does
not exist yet.

4. For each pair of variables X, Y ∈ V, if there exist a
directed path from a variable Li ∈ L to X and a directed
path from Li to Y in G such that every mid node on the

The equivalence of 1) and 3) can be proved in the same way as
the equivalence of (ii) and (iii) of Theorem 4.2 in Richardson
and Spirtes [2002].

C Conservative Weakenings of Faithfulness

In this section, we prove the theorem in the paper, via
generalizations of the weakenings of Faithfulness to MAGs
and establishing related results.
In MAGs, it holds that if
two vertices X and Y are adjacent, then there is no subset of
V \ {X, Y } that m-separates them. Hence, the formulation
of the Adjacency-faithfulness established for DAGs can
be directly applied to MAGs, except
the deﬁnition
of adjacency allows for bi-directed edges. Likewise, the
formulation of Number-of-Edges(NOE)-minimality carries
over to MAGs except that bi-directed edges are allowed in
The Number-of-Independences(NoI)-minimality
MAGs.
assumption, which is given in terms of conditional indepen-
dence statements, can be directly extended to MAGs. In the
following, we prove that for MAGs, all of the generalized as-
sumptions remain conservative weakenings of Faithfulness.
Based on these results, we prove the corresponding theorems
for SMCMs.

that

Lemma 1 Given the causal Markov assumption,
the
Adjacency-faithfulness assumption is a conservative weak-
ening of the Faithfulness assumption in the case of MAGs, in
the following sense:

(a) the Adjacency-faithfulness assumption is entailed by,

but does not entail, the Faithfulness assumption.

(b) For every joint probability distribution P over V, if
there exists a MAG that satisﬁes both Markov and Faith-
fulness assumptions with P , then for every MAG G
that satisﬁes the Markov assumption with P , G satis-
ﬁes Faithfulness if and only if G satisﬁes the Adjacency-
faithfulness assumption with P .

Proof. (a) Let GF be a MAG over V to which P is both
Markov and faithful. If two variables X and Y are adjacent in
GF , they are not m-separated given any set C ⊆ V \ {X, Y }.
Then, since P is faithful to GF , X and Y are not inde-
pendent given any set C ⊆ V \ {X, Y } in P . Thus, GF
satisﬁes Adjacency-faithfulness. Therefore, the Adjacency-
faithfulness assumption is entailed by the Faithfulness as-
sumption.

We show that Adjacency-faithfulness does not entail Faith-
fulness with an example. Suppose that V = {V1, V2, V3} and
the conditional independence relations satisﬁed by the distri-
bution are V1 ⊥⊥ V3 and V1 ⊥⊥ V3 | V2 (see Zhang, 2013 for
an example of such a distribution.) Then given Markov, the
structure V1 → V2 ↔ V3 satisﬁes Adjacency-faithfulness but
not Faithfulness with the distribution.

(b) Suppose there exists a MAG GF that is both Markov
and faithful to P . The “only if” direction has already been
proved in (a), so we just need to prove that, in this case, a
MAG satisﬁes the Faithfulness assumption with P if it sat-
isﬁes Adjacency-faithfulness assumption with P .
In other
words, we just need to prove that in this case, every MAG

Figure 6: An SMCM (left) and its corresponding MAG (right) in
which C and D are not m-separated by any subset of {A, B}.

paths is in L, add edge X ↔ Y to SG, if it does not exist
already.

The conversion of a DAG with latent variables to a MAG

is given in Richardson and Spirtes [2002].

Given a set of variables V, For every SMCM over V,
there is also a unique MAG that corresponds to it, such
that they entail the same set of conditional independence
statements (and the causal relations represented by the
MAG are compatible with those represented by the SMCM).
The following is a procedure to transform an SMCM into
its corresponding MAG. It is adapted from the algorithm
presented in Zhang [2008], which is used to project DAGs
with latent variables to MAGs.

Conversion from an SMCM to a MAG
S 1: For each pair of variables X and Y , X and Y are adja-
cent in the output MAG M , if there is an inducing path
between them in the input SMCM S.

S 2: For each pair of adjacent variables X and Y in the output

MAG M ,

(i) If X is an ancestor of Y in S, orient the edge as

X → Y .

(ii) If Y is an ancestor of X in S, orient the edge as

Y → X.

(iii) else, orient the edge as X ↔ Y .

It is worth noting that in MAGs, two variables are adjacent
if and only if they are not m-separated by any set of other
variables, This is not true for SMCMs, as shown in Figure 6.
However, in SMCMs it holds that there is an inducing path
between two variables if and only if the two variables are not
m-separated by any set of other variables. For example, in
Figure 6(a), there is an inducing path (C, A, B, D) between
C and D. We write the property as a proposition for later
reference.

Proposition 2 If S is an SMCM over V, M is the corre-
sponding MAG of S over V, and X, Y ∈ V, then the follow-
ing statements are equivalent:

1) There is an inducing path between X and Y in S.
2) X and Y are m-connected given any subset of V \

{X, Y }.

3) X and Y are adjacent in M .
Proof. A proof of the equivalence of 2) and 3) is given in
the proof of Theorem 4.2 in Richardson and Spirtes [2002].

GA that satisﬁes Markov Adjacency-faithfulness with P is
Markov equivalent to GF .

By Proposition 1, the MAGs that are Markov equivalent
have the same adjacencies and colliders with order.
It is
easy to see that GA shares the same adjacencies with GF .
The proof given for DAGs [Ramsey et al., 2006] is directly
applicable to MAGs. So we only need to prove that GA and
GF have the same colliders with order. For this purpose, we
ﬁrst prove the following claim.

Claim: Let π = (V0, V1, ..., Vm = X, Z, Y )(m ≥ 1) be
a discriminating path for Z in a MAG GF which satisﬁes
the Markov and the Faithfulness assumption with P . If the
corresponding path π∗ forms a discriminating path in a MAG
GA that satisﬁes Markov with P , then Z is a collider on π in
GF if and only if Z is a collider on π∗ in GA.

If

is

collider

(X, Z, Y )

Proof. As every vertex Vi, 1 ≤ i ≤ m is a collider on path
(V0, V1, ..., Vm = X, Z, Y ) and a parent of Y , any set that
m-separates V0 and Y must include all of them.
in GF ,
a

path
(V0, V1, ..., Vm = X, Z, Y ) m-connects given any su-
perset of S = {V1, ..., Vm} ∪ {Z}. As GF satisﬁes the
Faithfulness assumption with P , V0 and Y are dependent
given any superset of S in P . If (X, Z, Y ) is not a collider
in GA, there must be some superset of S that m-separates V0
and Y . But then GA would violate the Markov assumption,
which is a contradiction. Hence, (X, Z, Y ) is also a collider
in GA.

the

If (X, Z, Y ) is not a collider in GF ,

then the path
(V0, V1, ..., Vm = X, Z, Y ) m-connects given any superset
of {V1, ..., Vm} which does not include Z. By Faithfulness,
V0 and Y are dependent given any superset of {V1, ..., Vm}
which does not include Z in P .
If (X, Z, Y ) is a collider
in GA, any set that m-separates V0 and Y must be a super-
set of {V1, ..., Vm} which does not include Z. But then GA
would violate the Markov assumption, which is a contradic-
tion. Thus, (X, Z, Y ) is not a collider in GA.

Now we can prove that a triple (X, Z, Y ) is a collider with
order r in GF if and only if (X, Z, Y ) is a collider with order
r in GA.

Let r be the order of (X, Z, Y ).
If r = 0, (X, Z, Y ) is an unshielded collider. The proof
given for DAGs in Ramsey et al. [2006] is directly applica-
ble here. The only difference is that in MAGs, colliders and
non-colliders admit more edge conﬁgurations than they do in
DAGs.

When r > 0, assume the result holds for all s < r.
If (X, Z, Y ) is a triple with order r in GF (GA), by the
deﬁnition of ordered triple, there exists a discriminating path
π = (V0, V1, ..., Vm = X, Z, Y ) (or π = (V0, V1, ..., Vm =
Y, Z, X)) in GF (GA) such that, except (X, Z, Y ), every
triple Vi (1 ≤ i ≤ m) on π is a collider and has order less
than r. And since GF and GA have the same adjacencies,
the sequence of vertices forming the discriminating path in
GF (GA), also forms a path in GA(GF ). Let π∗ be the cor-
responding path in GA(GF ). By the inductive hypothesis, in

GA(GF ), each collider Vi (1 ≤ i ≤ m) is also a collider
with the same order as in GF (GA) on the corresponding path
π∗. We claim that the corresponding path π∗ is also a dis-
criminating path in GA(GF ) for (X, Z, Y ). Since we have
V0? → V1 ↔ ... ↔ Vm ←?Z in GA(GF ), it sufﬁces to show
that Vj → Y (1 ≤ j ≤ m) in GA(GF ).

Triple (V0, V1, Y ) is a noncollider with order 0 in
GF (GA), because V0 and Y are not adjacent. Hence,
(V0, V1, Y ) is also a noncollider with order 0 in GA(GF ).
Further, as V0? → V1, by the deﬁnition of MAGs, V1 → Y in
GA(GF ). Arguing inductively, assume Vi → Y (1 < i < m)
in GA(GF ), so that (V0, V1, ..., Vm, Y ) forms a discriminat-
ing path with order at most r for (Vm−1, Vm, Y ) in both GA
and GF . As a consequence, as (Vm−1, Vm, Y ) is a noncol-
lider on (V0, V1, ..., Vm, Y ) in GF (GA), (Vm−1, Vm, Y ) is a
noncollider on (V0, V1, ..., Vm, Y ) in GA(GF ), based on the
claim established above. Since Vm−1 → Vm, by the deﬁni-
tion of MAGs, Vm → Y in GA(GF ). Hence, π∗ also forms a
discriminating path in GA(GF ) for (X, Z, Y ). Again, based
on Lemma 4, (X, Z, Y ) is a collider in GF if and only if
(X, Z, Y ) is a collider in GA.

By the deﬁnition of an ordered triple, (X, Z, Y ) has order
at most r in GA. However, if (X, Z, Y ) has order less than r
in GA, by the inductive hypothesis, (X, Z, Y ) will have order
less than r in GF , which is a contradiction. Thus, (X, Z, Y )
has order r in both graphs.

To summarize, GA and GF are Markov equivalent since

they have the same adjacencies and colliders with order.

Theorem 1 Given the causal Markov assumption, the V-
adjacency-faithfulness assumption is a conservative weaken-
ing of the Faithfulness assumption in the case of SMCMs, in
the following sense:

(a) V-adjacency-faithfulness is entailed by, but does not en-

tail, Faithfulness.

(b) For every joint probability distribution P over V, if there
exists an SMCM that satisﬁes both Markov and Faith-
fulness assumptions with P , then for every SMCM G
that satisﬁes the Markov assumption with P , G satisﬁes
Faithfulness if and only if G satisﬁes the V-adjacency-
faithfulness with P .

Proof. (a) Let SF be an SMCM which satisﬁes Markov and
Faithfulness with P . By Proposition 2, if two variables X and
Y are virtually adjacent in SF , they are m-connected given
any subset of V\{X, Y }. Then by Faithfulness, X and Y are
dependent conditional on any subset of V \ {X, Y }. So SF
satisﬁes V-adjacency-faithfulness. Hence, the V-adjacency-
faithfulness assumption is entailed by the Faithfulness as-
sumption.

However, V-adjacency-faithfulness does not entail Faith-
fulness. It can be illustrated with the same example used in
the proof of Lemma 1, since syntactically MAGs are special
cases of SMCMs.

(b) Now we prove the “if” direction, since the “only if”
direction has already been proved in (a). Let SI be an SMCM
which satisﬁes Markov and V-adjacency-faithfulness with P
and MI be the unique MAG corresponding to SI .

If X and Y are adjacent in MI , there is an inducing path
between X and Y in SI , based on Proposition 2. Then, X and
Y are not independent given any subset of V \ {X, Y }, since
SI satisﬁes V-adjacency-faithfulness. Thus, MI satisﬁes
Adjacency-faithfulness. And, if P is faithful to some SMCM,
it is faithful to the corresponding MAG of that SMCM, which
means that there exists a MAG that satisﬁes both Markov and
Faithfulness with P . Further, by Lemma 1, MI satisﬁes the
Faithfulness assumption. It follows that SI satisﬁes the Faith-
fulness assumption, since MI and SI entail exactly the same
CI statements.

Lemma 2 Given the causal Markov assumption, the NOE-
minimality assumption is a conservative weakening of the
Faithfulness assumption in the case of MAGs, in the follow-
ing sense:

(a) the NOE-minimality assumption is entailed by, but does

not entail, the Faithfulness assumption.

(b) For every joint probability distribution P over V, if
there exists a MAG that satisﬁes both Markov and Faith-
fulness assumptions with P , then for every MAG G
that satisﬁes the Markov assumption with P , G satis-
ﬁes Faithfulness if and only if G satisﬁes the NOE-
minimality assumption with P .

Proof. (a) Let GF be a MAG to which P is both Markov and
faithful. Then removing any edge from GF will either violate
the maximality or introduce an independence which is not
satisﬁed by P , which constitutes a violation of the Markov
assumption. Hence, there is no MAG with a smaller number
of edges than GF , which satisﬁes Markov. So GF satisﬁes
NOE-minimality. Thus, NOE-minimality asusmption is en-
tailed by the Faithfulness assumption.

Forster et al. [2017] showed that NOE-minimality is
weaker than Faithfulness for DAGs. Thus, in the case of
MAGs, NOE-minimality does not entail Faithfulness, since
DAGs are special cases of MAGs.

(b) Suppose there exists a MAG GF that is both Markov
and faithful to P , and suppose GN oE is a MAG that satis-
ﬁes Markov and NOE-minimality with the distribution P . As
we did previously, to prove the “if” direction, we only need
to prove that GF and GN oE have the same adjacencies and
colliders with order.

GF and GN oE have the same number of edges since GF
also satisﬁes NOE-minimality. Now we prove that GF and
GN oE not only have the same number of edges but also the
same adjacencies: For a contradiction, if we assume that
GN oE has one different edge than GF does, then one edge
that is present in GF is removed in GN oE, since they share
the same number of edges. As already mentioned, removing
any edge that is present in GF will result in a violation of
either maximality or Markov. Thus, GF and GN oE not only
have the same number of edges but also the same adjacencies.
Next, we prove that GF and GN oE have the same un-
shielded colliders. Since GF and GN oE have the same ad-
jacencies, a triple is unshielded in GF if and only if it is un-
shielded in GN oE. If an unshielded triple (X, Z, Y ) is an un-
shielded collider in GF , then X and Y are dependent given

any set that includes Z in P , because the distribution P is
faithful to GF . Then, as P and GN oE satisfy the Markov as-
sumption, (X, Z, Y ) is also an unshielded collider in GN oE.
Similarly, if (X, Z, Y ) is an unshielded non-collider in GF ,
then it is an unshielded non-collider in GN oE.

The fact that GF and GN oE have the same colliders with
order can be proved in the same way as we did in the proof of
Lemma 1, since we have already proved that GF and GN oE
have the same adjacencies and unshielded colliders.

Theorem 2 Given the causal Markov assumption, the V-
adjacency-minimality assumption is a conservative weaken-
ing of the Faithfulness assumption in the case of SMCMs, in
the following sense:

(a) V-adjacency-minimality is entailed by, but does not en-

tail, Faithfulness.

(b) For every joint probability distribution P over V, if there
exists an SMCM that satisﬁes both Markov and Faith-
fulness assumptions with P , then for every SMCM G
that satisﬁes the Markov assumption with P , G satis-
ﬁes Faithfulness if and only if G satisﬁes V-adjacency-
minimality with P .

Proof. (a) Let SAF be an SMCM which satisﬁes Markov and
V-adjacency-faithfulness with P . Then if two variables X
and Y are virtually adjacent in SAF , they are dependent given
any subset of V \ {X, Y } in the distribution P . Then, by
Proposition 2, taking away the virtual adjacency between X
and Y will introduce a new conditional independence, which
is not satisﬁed by the distribution P and would thus result
in a violation of the Markov assumption. So SAF satis-
ﬁes V-adjacency-minimality, which means that V-adjacency-
minimality is entailed by V-adjacency-faithfulness. Further,
V-adjacency-minimality is entailed by Faithfulness since V-
adjacency-faithfulness is entailed by Faithfulness.

However, V-adjacency-minimality does not entail
the
Faithfulness assumption because V-adjacency-faithfulness
does not entail Faithfulness.

(b) Now we only need to prove the “if” direction of (b)
since the “only if” direction has already been proved above.
Let SV ADJ be an SMCM which satisﬁes Markov and V-
adjacency-minimality and MV ADJ be the unique MAG cor-
responding to SV ADJ .

By Proposition 2, there is an inducing path in SV ADJ
if and only if there is an edge in MV ADJ .
If MV ADJ
does not satisfy NOE-minimality, there must be some MAG
M , which has fewer edges than MV ADJ and still satis-
ﬁes Markov. The SMCMs corresponding to M then have
fewer virtual-adjacencies than SV ADJ and also still satisfy
Markov. This violates our initial assumption that SV ADJ sat-
isﬁes V-adjacency-minimality. Thus, MV ADJ satisﬁes NOE-
minimality. And, when P is faithful to some SMCM, it is
faithful to the corresponding MAG of this SMCM, which
means that there exists a MAG that satisﬁes both Markov and
Faithfulness with P . Further, by Lemma 2, MV ADJ satis-
ﬁes faithfulness, since it satisﬁes NOE-minimality. Hence
SV ADJ satisﬁes faithfulness, since it entails the same exact
CIs with MV ADJ .

Lemma 3 Given the causal Markov assumption, the NOI-
minimality assumption is a conservative weakening of the
Faithfulness assumption in the case of MAGs, in the follow-
ing sense:
(a) the NOI-minimality asusmption is entailed by, but does

not entail, the Faithfulness assumption.

(b) For every joint probability distribution P over V, if
there exists a MAG that satisﬁes both Markov and Faith-
fulness assumptions with P , then for every MAG G
that satisﬁes the Markov assumption with P , G sat-
isﬁes Faithfulness if and only if G satisﬁes the NOI-
minimality assumption with P .

Proof. (a) The proof that was given for DAGs [Zhalama et
al., 2017] is directly applicable to MAGs.

(b) Let GF be one of the graphs to which P is both Markov
and faithful and GN oI be a graph that satisﬁes Markov
and NOI-minimality with P . Since GF also satisﬁes NOI-
minimality, GF and GN oI entail the same number of con-
ditional independence statements (CIs). Now we prove that
they entail exactly the same CIs. For a contradiction, let’s
assume that GN oI entails one CI that is not entailed by GF .
Because GF satisﬁes faithfulness and Markov with P , the CIs
entailed by GF are exactly the ones satisﬁed by P . But since
GN oI entails one CI that is not satisﬁed by P , it then must
violate Markov, which is a contradiction. Therefore, GF and
GN oI entail the exact same CIs, which means that GN oI also
satisﬁes Markov and faithfulness with P .

Theorem 3 Given the causal Markov assumption, the NOI-
minimality assumption is a conservative weakening of faith-
fulness in the case of SMCMs, in the following sense:
(a) NOI-minimality is entailed by, but does not entail, Faith-

fulness.

(b) For every joint probability distribution P over V, if there
exists an SMCM that satisﬁes both Markov and Faith-
fulness assumptions with P , then for every SMCM G
that satisﬁes the Markov assumption with P , G satisﬁes
Faithfulness if and only if G satisﬁes NOI-minimality
with P .

Proof. The proof of Lemma 3 can be directly extended to
SMCMs.

References
R. Ayesha Ali, Thomas S. Richardson, and Peter Spirtes.
Markov equivalence for ancestral graphs. The Annals of
Statistics, 37(5B):2808–2837, 10 2009.

G. Borboudakis and I. Tsamardinos. Towards robust and ver-
satile causal discovery for business applications. In Pro-
ceedings of KDD, pages 1435–1444, 2016.

M. Forster, G. Raskutti, R. Stern, and N. Weinberger. The
frugal inference of causal relations. British Journal for the
Philosophy of Science, 2017.

A. Hyttinen, P.O. Hoyer, F. Eberhardt, and M. J¨arvisalo. Dis-
covering cyclic causal models with latent variables: A gen-
eral SAT-based procedure. In Proceedings of UAI, pages
301–310. AUAI Press, 2013.

A. Hyttinen, F. Eberhardt, and M. J¨arvisalo. Constraint-based
causal discovery: Conﬂict resolution with Answer Set Pro-
gramming. In Proceedings of UAI, 2014.

S. Magliacane, T. Claassen, and J.M. Mooij. Ancestral causal
inference. In Advances In Neural Information Processing
Systems, pages 4466–4474, 2016.

C. Meek. Graphical Causal Models: Selecting Causal and
Statistical Models. PhD thesis, Department of Philosophy,
Carnegie Mellon University, 1996.

J. Pearl. Probabilistic Reasoning in Intelligent Systems. Mor-

gan Kaufmann, 1988.

J. Pearl. Causality. Oxford University Press, 2000.

J. Ramsey, J. Zhang, and P. Spirtes. Adjacency-faithfulness
and conservative causal inference. In Proceedings of UAI,
pages 401–408, 2006.

G. Raskutti and C. Uhler. Learning directed acyclic graphs
based on sparsest permutations. arXiv:1307.0366v3, 2014.

T. Richardson and P. Spirtes. Ancestral graph Markov mod-

els. The Annals of Statistics, 30(4):962–1030, 2002.

T. Richardson. A characterization of markov equivalence for
directed cyclic graphs. International Journal of Approxi-
mate Reasoning, 17(2-3):107 – 162, 1997.

T. Richardson. Markov properties for acyclic directed mixed
graphs. Scandinavian Journal of Statistics, 30(1):145–157,
2003.

J. M. Robins, R. Scheines, P. Spirtes, and L. Wasserman. Uni-
form consistency in causal inference. Biometrika, 90:491–
515, 2003.

L. Solus, Y. Wang, L. Matejovicova, and C. Uhler. Consis-
tency Guarantees for Permutation-Based Causal Inference
Algorithms. arXiv e-prints, Feb 2017.

P. Spirtes and J. Zhang. A uniformly consistent estimator of
causal effects under the k-triangle-faithfulness assumption.
Statistical Science, 29(4):662–678, 2014.

P. Spirtes, C. Glymour, and R. Scheines. Causation, Predic-

tion and Search. MIT Press, 2 edition, 2000.

J. Tian and J. Pearl. On the testable implications of causal
models with hidden variables. In UAI 2002, Proceedings
of the Conference on Uncertainty in Artiﬁcial Intelligence,
pages 519–527. Morgan Kaufmann, 2002.

C. Uhler, G. Raskutti, P. B¨uhlmann, and B. Yu. Geometry of
faithfulness assumption in causal inference. The Annals of
Statistics, 41:436–463, 2013.

T. Verma. Graphical aspects of causal model. Technical re-
port, Computer Science Department, University of Califor-
nia, Los Angles, 1993.

Y. Wang, L. Solus, K. Yang, and C. Uhler. Permutation-based
In NIPS,

causal inference algorithms with interventions.
pages 5824–5833, 2017.

Zhalama, J. Zhang, F. Eberhardt, and W. Mayer. Sat-based
causal discovery under weaker assumptions. In UAI, 2017.

J. Zhang and P. Spirtes. Detection of unfaithfulness and ro-
bust causal inference. Minds and Machines, 18(2):239–
271, 2008.

J. Zhang. Causal reasoning with ancestral graphs. Journal of

Machine Learning Research, 9:1437–1474, 2008.

J. Zhang. A comparison of three Occam’s razor for Marko-
vian causal models. British Jounrnal for the Philosophy of
Science, 64(2):423–448, 2013.

