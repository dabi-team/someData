Programmable Phase-change Metasurfaces on 

Waveguides for Multimode Photonic Convolutional 

Neural Network 

Changming Wu1, Heshan Yu2, Seokhyeong Lee1, Ruoming Peng1, Ichiro Takeuchi2,  

and Mo Li1,3* 

1Department of Electrical and Computer Engineering, University of Washington, Seattle, WA 98195, USA 

2Department of Materials Science and Engineering, University of Maryland, College Park, MD 20742, USA 

3Department of Physics, University of Washington, Seattle, WA 98195, USA 

ABSTRACT 

Neuromorphic photonics has recently emerged as a promising hardware accelerator, with 

significant  potential  speed  and  energy  advantages  over  digital  electronics  for  machine 

learning algorithms such as neural networks of various types. Integrated photonic networks 

are particularly powerful in performing analog computing of matrix-vector multiplication 

(MVM)  as  they  afford  unparalleled  speed  and  bandwidth  density  for  data  transmission. 

Incorporating  nonvolatile  phase-change  materials  in  integrated  photonic  devices  enables 

indispensable  programming  and  in-memory  computing  capabilities  for  on-chip  optical 

computing.  Here,  we  demonstrate  a  multimode  photonic  computing  core  consisting  of  an 

array of programable mode converters based on on-waveguide metasurfaces made of phase-

change materials. The programmable converters utilize the refractive index change of the 

phase-change material Ge2Sb2Te5 during phase transition to control the waveguide spatial 

modes with a very high precision of up 64 levels in modal contrast. This contrast is used to 

represent the matrix elements, with 6-bit resolution and both positive and negative values, 

to perform MVM computation in neural network algorithms. We demonstrate a prototypical 

* Corresponding author: moli96@uw.edu 

-1- 

 
 
 
optical convolutional neural network that can perform image processing and classification 

tasks  with  a  high  accuracy.  With  a  broad  operation  bandwidth  and  a  compact  device 

footprint, the demonstrated multimode photonic core is readily scalable toward large-scale 

photonic neural networks with ultrahigh computation throughputs. 

The  unmet  gap  between  the  rate  of  energy  efficiency  improvement  of  current  digital 

electronics and the fast-growing load of computation by emerging applications such as machine 

learning  and  artificial  intelligence1,2  has  once  again  brought  optical  computing  into  focus3-6. 

Integrated photonics provides a scalable hardware platform to realize large-scale optical networks 

on a chip, which affords an enormous bandwidth density that is unreachable for electronics7-9. To 

use integrated photonics for optical computing, programmable photonic components and nonlinear 

elements are indispensable building blocks. Phase-change materials (PCM) recently emerged as 

an ideal material system to realize optical programmability10-12. The optical properties of PCMs 

change dramatically during the phase transition, which can be electrically or optically controlled. 

Harnessing this has allowed for embodiments of programmable optical switches, couplers, lens 

and metamaterials to be demonstrated13-21. The phase change in the chalcogenide family of Ge-

Sb-Te alloys is nonvolatile, requiring no sustaining power supply to retain the programmed state 

or stored information19-26. Their use in programmable photonic devices thus can have a significant 

advantage  in  power  consumption  over  electro-optic27-29  or  thermo-optic  methods30-32.  Photonic 

devices incorporating those nonvolatile PCMs thus can realize optical memories and perform in-

memory computing simply by measuring the transmission of the optical input data through the 

programmed device33-35. Proliferating these phase-change photonic devices in a scalable network, 

prototypes of an optical neural network (ONN), has been proposed and demonstrated35-38. 

Here,  we  report  a  programmable  waveguide  mode  converter  based  on  a  phase-gradient 

metasurface  made  of  phase-change  material  Ge2Sb2Te5  (GST).  This  phase-change  metasurface 

mode converter (PMMC) utilizes GST‚Äôs large refractive index change during its phase transition 

to control the conversion of the waveguide‚Äôs two spatial modes (TE0 and TE1 modes). The PMMC 

can be programmed to control the waveguide mode contrast precisely at 64 distinguishable levels, 

which is used to represent the weight parameters with 6-bit precision in MVM computation. We 

build a 2√ó2 array of PMMCs and implement them as programmable kernels to realize a multimode 

optical convolutional neural network (OCNN). By performing image processing tasks such as edge 

-2- 

 
detection and pattern recognition, we demonstrate the OCNN‚Äôs viability and potential in large-

scale optical computing.  

The design of the PMMC is based on the principle of a phase-gradient metasurface but 

replacing noble metals with phase-change materials39. Fig. 1a shows a 3D schematic of the design, 

which consists of a linear array of GST nano-antennae directly integrated on a silicon nitride (SiN) 

waveguide.  Each  GST  nano-antenna  scatters  the  waveguide  mode  and  causes  a  phase  shift  Œ¶, 

which depends on its geometry (e.g., width), as well as the refractive index of its material (Fig. 

2b). A linear array of such nano-antennae with tapering widths thus produces a spatial gradient of 

the  scattering  phases  dŒ¶/dx,  which  is  equivalent  to  a  wavevector  kg.  If  the  phase-gradient 

metasurface is designed such that kg matches the wavevector difference between two spatial modes 

of  the  waveguide:  kmode1-kmode2,  it  satisfies  the  phase-matching  condition  and  facilitates  the 

conversion  between  the  two  modes.  Such  phase-gradient  metasurfaces  for  waveguide  mode 

conversion realized with noble metals or dielectrics materials thus lacked tunability. Here, we use 

GST, which has a large change in its optical properties when a phase transition happens. When the 

GST is in the amorphous phase (aGST), its refractive index n is ~4.7 (representative value in the 

literature, the same hereafter)40. In contrast, when it is turned to the crystalline phase (cGST), n 

increases to ~7.5 with a drastic change of 2.8 over the whole measured spectral range from 1540 

nm to 1580 nm (See Figure S1a for more  detailed  information).  This change will  significantly 

modify the scattered phase of each GST nano-antenna (Fig. 2b) so as to modify the metasurface‚Äôs 

function. Fig. 1c plots the simulated phase of the scattered fields inside the waveguide by a single 

nano-antenna of 30-nm-thick GST as a function of its width and for aGST and cGST phases. Since 

cGST has a much larger n, the scattered phase shows a much stronger dependence on the width 

than  the  aGST  phase.  By  controlling  the  geometry  of  the  GST  nano-antennae  and  the  interval 

between  adjacent  ones  in  the  array,  a  well-defined  phase  gradient  dŒ¶/dx  is  established  (See 

Supplementary Information for details). The entire metasurface consists of an array of 25 nano-

antennae with tapering widths from 510 nm to 84 nm (shaded region in Fig. 1c) and is patterned 

on  a  SiN  waveguide  1.8  ¬µm  wide  and  330  nm  thick.  The  waveguide  supports  two  transverse-

electric  modes:  the  fundamental  TE0  mode  and  the  first-order  TE1  mode.  We  design  the 

metasurface, in the cGST phase, to have a uniform dŒ¶ = 2.5¬∞ for every dx = 400 nm to satisfy the 

generalized  phase-matching  condition,

k n
(
0

TE0

‚àí

n
TE1

)

=

N d

‚ãÖ Œ¶

dx

,  where  k0  is  the  free-space 

-3- 

 
wavevector,  TE0n

 and  TE1n

 are the effective index of the TE0 and TE1 modes, respectively, and N is 

the number of interactions between the guided modes and the metasurface. The cGST metasurface 

thus can efficiently convert the TE0 mode to the TE1 mode, as shown by the finite-domain finite-

time (FDTD) simulation result in Fig. 1d. When the GST is transitioned to the aGST phase, as 

shown in Fig. 1c, the dŒ¶/dx is much reduced and thus insufficient for the phase-matching condition 

so that mode conversion between TE0 and TE1 modes does not occur, which is clearly seen in Fig. 

1e. Therefore, the GST phase-gradient metasurface, as designed here, functions as a programmable 

waveguide mode converter controlled by the tunable material phase of the GST. 

Fig. 2a-c shows the scanning electron microscope images of the complete PMMC device. 

The 30nm thick GST film is deposited by sputtering on Si3N4 on an oxided silicon substrate. It is 

then  patterned  into  metasurface  with  electron  beam  lithography  and  plasma  etching,  and 

conformally encapsulated with a 218 nm thick layer of Al2O3 deposited by atomic layer deposition. 

The photonic circuits of Si3N4, including multimode waveguides, directional couplers and grating 

couplers, are then patterned with standard processes17. A pair of asymmetric directional couplers 

(Fig.  2c)  is  designed  to  function  as  mode  selectors  to  selectively  couple  only  the  TE1  mode 

component  in  the  multimode  waveguide  with  the  TE0  mode  component  in  the  single-mode 

waveguide  (See  Supplementary  Information  for  details).  Fig.  2a  depicts  the  measurement  and 

control scheme. To program the PMMC, we use optical pulses to control the phase of the GST 

film  for  simplicity41.  Previously,  electrical  control  using  integrated  micro-heaters  has  been 

previously demonstrated by a number of groups, including us17,26,42-44. When operating the PMMC, 

an  optical  signal  is  input  in  the  TE0  mode  to  the  PMMC  and  converted  to  TE1  mode  with  a 

proportion controlled by the state of the GST metasurface. At the output of the PMMC, the TE1 

component is separated by the mode selector and coupled out at the second port while the TE0 

component remains in and outputs from the  multimode waveguide. The output powers of both 

modes are then measured to determine their respective transmission coefficients. Fig. 2d shows 

the transmission spectrum of the PMMC when the metasuface is set to be either in fully aGST or 

cGST phases. The insertion losses of the input and output fibers and grating couplers have been 

accounted for by calibration measurements. In the aGST phase, the device is in the on-state for the 

TE0 mode with a high transmission Ton over a broad wavelength range (1540 to 1580 nm). The 

lowest insertion loss is 0.9 dB at 1575 nm wavelength. A small portion (<-10 dB) of the TE1 mode 

is generated due to the asymmetric perturbation induced by the metasurface even though the aGST 

-4- 

 
phase  has  a  low  refractive  index.  The  situation  changes  dramatically  when  the  metasurface  is 

transitioned to the cGST phase and converts the TE0 mode to the TE1 mode effectively. In this off-

state  for  the  TE0  mode,  its  transmission  Toff  is  lower  than  -15  dB  over  the  entire  measured 

bandwidth. The corresponding switching extinction ratio, defined as 

‚àÜ

T T

off

=

(

T

on

off

‚àí

T

)

off

T

, is 

~16  dB  or  4000%,  which  is  more  than  10-fold  improvement  compared  to  previously  reported 

switch  devices  using  GST  24,43,45.  This  large  switching  ratio  stems  from  the  phase  engineering 

approach  to  effectively  use  GST‚Äôs  large  refractive  index  change  during  its  phase-transition,  as 

opposed to only  using the absorption coefficient change, to facilitate scattering into  a different 

mode that is filtered. The total area of the GST in the metasurface is only 1.3 ¬µm2, significantly 

smaller than that in prior devices, and thus in principle, our device consumes less energy to switch. 

As expected from energy conservation, the TE1 mode is switched in the opposite way to the TE0 

mode. From aGST to cGST phase, the TE1 transmission increases from ~-10 dB to ~-6.5 dB, with 

the  insertion  loss  due  to  cGST‚Äôs  absorption.  Another  important  parameter  to  quantify  a  mode 

converter‚Äôs  performance  is  the  mode  purity  in  the  multimode  waveguide,  defined  as 

Œ≤

TE0(TE1)

=

P
TE0(TE1)

(

P
TE0

+

P
TE1

)

, where PTE0 (PTE1) is the power in the TE0 (TE1) mode. The PMMC 

shows very high performance in controlling mode purity. As shown in Fig. 2e, when switching the 

GST from aGST to cGST phase, the PMMC efficiently converts TE0 mode to TE1 mode, changing 

the  mode  purity  from  Œ≤TE0>80%  to  Œ≤TE1>85%  over  a  broad  bandwidth,  showing  an  excellent 

agreement with the numerical simulation results. 

The phase composition of the GST in the metasurface can be continuously tuned by partial 

phase  transition  so  that  the  PMMC  can  be  continuously  programmed  to  multiple  intermediate 

levels of phase purity values. We program the PMMC with a sequence of 50 ns-long control pulses 

to ‚Äúquench‚Äù the GST progressively from the fully cGST phase toward the fully aGST phase. As a 

result,  the  TE1  mode  purity Œ≤TE1  increases  stepwise.  Since the  mode  selector  separates  the  two 

modes, we can measure their power and calculate the difference to determine the mode contrast 

Œì =

‚àí
Œ≤ Œ≤

TE0

TE1

, which is used as a programming parameter. Fig. 2f demonstrates the multi-level 

programmability of the PMMC, in which Œì is sequentially set to 64 distinguishable levels between  

-0.73 to +0.67 at 1555 nm. Since the theoretical range of Œì is 

, it is an ideal parameter to 

represent  the  elements  in  the  matrix  w,  with  both  positive  and  negative  values,  in  multiply-

(‚àí1,1)

accumulate  (MAC)  operation:  x  ÔÉ†  x  ‚àô  w  +  b,  where  b  is  the  bias  parameter.  MAC  is  the 

-5- 

 
constitutional step of matrix-vector multiplication (MVM) in all neural network algorithms. The 

PMMC allows storing w by programming Œì in the GST metasurface as a nonvolatile memory. In-

memory MAC computing can be performed with the PMMC by a measurement of the transmitted 

power when the input data x is encoded in the power of the input optical signal. The lower inset of 

Fig.  2f  shows  the  histograms  of  20  repeated  programming  operations  to  set  the  PMMC  mode 

contrast  at  two  adjacent  levels  (levels  30  and  31),  respectively.  The  well  separated  histograms 

clearly demonstrate the device‚Äôs programming resolution and accuracy. The demonstrated 64-level 

programmability  of  the  PMMC‚Äîthe  highest  to  the  best  of  our  knowledge  for  phase-change 

photonic devices24‚Äîcorresponds to 6-bit resolution in setting w, which is critical to the training 

and inference precision of the neural network46,47. 

We  harness  the  PMMC‚Äôs  high-precision  programmability  and  in-memory  computing 

capability to demonstrate an optical convolutional neural network (OCNN)28-30,48. A typical CNN 

consists of an input layer and an output layer, which are connected by multiple hidden layers in 

between. The hidden layers usually consist of a series of convolutional layers followed by pooling 

layers and fully connected layers at the end. We design a prototype optical CNN using a small 

network of PMMCs to implement patch-kernel matrix multiplication to compute convolution. Fig. 

3a illustrates the operation principle of the OCNN for image processing, where an input grayscale 

image of dimensions n √ó n  is convolved with a kernel of dimensions k √ó k to compute an activation 

map of dimension (n‚Äìk+1) √ó (n‚Äìk+1), assuming the convolution stride is 1. When operating the 

OCNN, we group the input image into (n‚Äìk+1)2 patches (the shaded area in the upper panel of Fig. 

3a) with the same dimensions as the convolution kernel, k2. Each patch corresponds to the receptive 

field of an element in the activation map accordingly. Thus, a convolution operation requires (n‚Äì

k+1)2 √ó k2 MAC operations in total, which is a high load of computation and can most benefit from 

optical computing‚Äôs speed and energy advantages. 

To compute the convolution, (n‚Äìk+1)2 patch matrices of the input image are optically fed 

into  the  photonic  kernel  sequentially  while  the  kernel  elements,  that  is,  the  PMMCs,  are 

programmed  to  fixed  values.  At  each  timeframe  of  the  computation,  the  corresponding  patch 

matrix is reshaped into a single column of data with the length k2. The data is input into the optical 

system  in  k2  channels  as  sequences  of  incoherent  optical  pulses,  whose  power  amplitude  is 

controlled by a variable optical attenuator (VOA) to encode the value of each pixel value Xij in the 

greyscale image. The corresponding element Wij of the kernel matrix is programmed as the mode 

-6- 

 
contrast  Œì  of  each  PMMC.  The  resulting  transmitted  power  of  TE0  and  TE1  modes  are  then 

summed incoherently using two photodetectors. Their difference is calculated electronically and 

used in post-processing steps. As a result, the output will correspond to a time series of patch-

kernel  MVM  with  the  amplitude  encoding  the  values  of  the  computation  results,  which  is  the 

activation map of convolution. Since the modal contrast Œì of our PMMCs can assume both positive 

and negative values, it can represent the kernel matrix elements without the need of an additional 

offset, which otherwise would take additional steps to set in each computation cycle. 

Experimentally,  we  build  a  small-scale,  four-channel  system  with  four  PMMCs  to 

represent a 2√ó2 kernel matrix, as shown in the optical images in Fig. 3b. As a demonstration, we 

perform the convolution of a 256√ó256 8-bit grayscale image of a cameraman (Fig. 3c) to detect its 

edge features. As shown in Fig. 3b, the TE0 mode output coming from all the PMMCs is combined 

using on-chip Y-junctions, while the TE1 mode output power is combined off-chip because the 

same ports are used to program the PMMCs optically. Because combining four incoherent sources 

using Y-junctions will inherently reduce the power by a factor of 4, we rescale the measured TE0 

mode power by this factor when calculating the power differences between two modes. To detect 

vertical and horizontal edges, kernel matrices as in the right column of Fig 3d and e are used, and 

so are the PMMCs programmed. Take the vertical edge detection for example, the kernel is set to 

be 

‚àíÔ£Æ
Ô£Ø
‚àíÔ£∞

Ô£π
1 1
Ô£∫
1 1
Ô£ª

 so  to  compute  the  discrete  first-order  derivative, 

, 

ùëãùëãùëñùëñ+1,ùëóùëó + ùëãùëãùëñùëñ+1,ùëóùëó+1 ‚àí ùëãùëãùëñùëñ,ùëóùëó ‚àí ùëãùëãùëñùëñ,ùëóùëó+1
where i, j are the indices of the input image matrix. Each kernel element Wij is stored as the mode 

contrast  value  Œì  in  the  corresponding  PMMC,  with  Wij  =1(-1)  corresponds  to  the  fully  aGST 

(cGST) phase (see Supplementary Information for a more detailed description about the operation 

procedure). The computed images after convolution without any post-processing are shown in the 

left column of Fig. 3d, e, for horizontal and vertical edge detection, respectively. The two images 

are then added to produce the right image in Fig. 3b, which highlights silhouettes of the objects 

with sharp edges such as the cameraman and the buildings in the original image, while suppressing 

smooth features such as the sky and the water. The optically computed edge detection image also 

agrees very well with the calculated result using conventional image processing algorithms (see 

Supplementary Information). This result verifies the capacity and fidelity of optical convolution 

performed with the PMMC-based photonic kernel, which is a prerequisite for an OCNN. 

-7- 

 
Beyond the convolution layer, the MAC computation performed with optical signals and 

the  PMMC  network  can  also  be  applied  to  the  pooling  (average  pooling)  and  fully  connected 

layers, where the PMMCs are used as weight banks instead, to realize a complete OCNN. In our 

experiment, we sequentially reuse the PMMC array in both convolution and fully connected layers 

to  demonstrate  an  OCNN  and  perform  proof-of-concept  imaging  recognition  tasks  of 

distinguishing handwritten numbers ‚Äú1‚Äù and ‚Äú2‚Äù from the MNIST database. Fig. 4a illustrates the 

architecture and processes of the OCNN. The 28√ó28 pixels, 8-bit grayscale images of number ‚Äú1‚Äù 

or ‚Äú2‚Äù are fed into the input layer as optical signals. The data is then convolved with two 2√ó2 

photonic kernels K1 and K2 to generate two 27 √ó 27 images of activation maps. After adding a bias 

b1 and applying the nonlinear ReLu function, the output images are sent to an average pooling 

layer with a subsampling factor of 27, which reduces the images a 2√ó1 vector. This vector is then 

fed into the fully connected layer with a 2√ó2 photonic weight bank K3 programmed in the PMMC 

array, added with a bias b2 and applied the standard sigmoid function. The final output is a vector 

that gives the identified class of the input image, that is, 

 corresponds to the number ‚Äú1‚Äù 

and  

 corresponds to the number ‚Äú2‚Äù. In this OCNN, the MVM computations such as the 

ùëáùëá

[1 0]

convolution and the fully connected layers are all performed optically with the PMMCs, whereas 

ùëáùëá

[0 1]

bias and nonlinear functions are realized electronically.  

Before using the OCNN, we first train all the parameters in the layers with the standard 

back-propagation algorithm using the gradient descent method49. The training set consists of 11000 

images of the handwritten number "1" or "2" from MNIST training images (see supplementary for 

training details). The training yields values for each element in the convolutional kernels and the 

weight bank, as shown in Fig. 4b and d. We then program the PMMC array to represent these 

elements. In Fig. 4c, we show the raw data of the convolutional activation maps encoded in time 

series of optical signals, which is the output from the PMMC array after the input image convolves 

with  the  photonic  kernel  K1  and  K2.    Since  each  photonic  processing  layer  results  in  electrical 

signals output from the photodetectors, electronic post-processing is performed to add bias and 

apply nonlinear function and pooling. The resultant data is re-coded into optical signals and fed to 

the  next  photonic  layer.  Further  experimental  details  are  included  in  the  supplementary 

information. We evaluate the system‚Äôs performance after training on a recognition test set, which 

consists of 100 randomly chosen "1" or "2" images (55 number ‚Äú1‚Äù and 45 number ‚Äú2‚Äù) from the 

MNIST testing image database. Fig. 4e shows the result that our OCNN correctly identiÔ¨Åed 91 out 

-8- 

 
of 100 cases (9% error rate), which compares squarely with the result of a computer (10% error 

rate).  The  slight  difference  is  mainly  caused  by  the  small  deviation  of  the  experimentally 

programmed values in the matrices (K1, K2 and K3) from the trained values, which occurs when 

the system‚Äôs conditions drift during operation. This result successfully demonstrates the OCNN‚Äôs 

viability and accuracy in performing standard neural network algorithms. 

In summary, we have demonstrated a compact programmable waveguide mode converter 

using GST-based phase-gradient metasurface with high programming resolution, efficiency and 

broadband operation. We have built a photonic kernel based on an array of such PMMC devices 

and  implemented  an  optical  convolutional  neural  network  to  perform  image  processing  and 

recognition  tasks.  Our  results  show  that  phase-change  photonic  devices,  such  as  the  PMMC 

demonstrated here, can enable robust and flexible programmability and realize a plethora of unique 

optical  functionalities  that  are  scalable  for  large-scale  optical  computing  and  neuromorphic 

photonics. Although optical computation in this work is performed at a low speed of ~1 kHz by 

using  low-speed  VOAs  to  encode  data  into  optical  signals,  state-of-the-art  integrated  photonic 

transmitters and photodetectors can drive the system at a speed of many 10s of Gbits/sec50,51. Using 

wavelength division multiplexing (WDM) can further increase the number of parallel computation. 

The  2√ó2  array  prototype  system  demonstrated  in  this  work  performs  optical  computation 

incoherently in a broadband. It can be readily scaled up toward a large network using a photonic 

crossbar array architecture52-57 (See Supplementary Information for details of such a design), and 

compares favorably with other photonic computing schemes using coherent methods30 or optical 

resonators28,58,59.  The  feasible  size  (n√óm)  of  such  crossbar  arrays  will  not  be  limited  by  the 

insertion  loss  of  the  PMMC  (~7  dB  for  TE1  mode,  Fig.  2d);  rather  it  will  be  limited  by  the 

directional couplers with coupling efficiency of 1/n, as is needed to equally combine signals from 

n units. The PMMC device is very compact with a footprint of ~80√ó20 ¬µm (Fig. 2a, including the 

mode selector). When performing MAC compuating with a high speed, an OCNN system using 

the device can afford an extremely high areal computing density (defined as MAC operations per 

time  per  unit  area).  For  example,  assuming  a  moderate  datarate  of  10  Gbits/sec  and  4  WDM 

wavelengths in parallel per channel, the computing density will reach an upperbound value of 25 

TOPS/mm2  (Tera-Operations  per  second  per  mm2),  which  is  significantly  higher  than  that  of 

digital  electronic  accelerators  such  as  GPUs60  and  tensor  processing  units  (TPUs)61,62.  Using 

silicon instead of silicon nitride can further reduce the device footprint to increase the computing 

-9- 

 
density63.  Besides  MAC  operation,  the  equally  important  computing  processes  of  applying 

nonlinear functions and pooling can also be achieved optically by using elements such as nonlinear 

optical resonators, modulators, and amplifiers27,28,64. Alternatively, a hybrid photonic-electronic 

system may optimally balance energy-efficiency and speed advantages of photonic systems, while 

realizing flexible non-linearity, connectivity, and training precision using microelectronics26,65,66. 

With these advances, the photonic neural network accelerator will be very promising for AI in data 

centers where massive optical interconnects have already been deployed. 

Acknowledgment: 

We  acknowledge  the  funding  support  provided by  the  ONR  MURI  (Award  No.  N00014-17-1-

2661, Program Manager: Dr. Brian Bennett).  

Data Availability Statement 

The data that support the findings of this study are available from the corresponding author upon 

reasonable request. 

Code Availability Statement 

No custom computer code or mathematical algoritm is used to generate results that are reported in 

this study. 

-10- 

 
 
 
 
 
 
Figure  1  Design  of  the  phase-gradient  metasurface  mode  converter.  a.  3D  illustration  of  the 

devices. b. Finite element simulation of the scattered electric field by one nano-antenna when the 

GST is in aGST (left panel) and cGST (right panel) phases, respectively, showing the distinctive 

difference. c. The phase of the scattered mode as a function of the GST nano-antenna width for 

cGST and aGST phases. The shaded region indicates the range of antenna widths that are used in 

the phase gradient metasurface.  Inset: cross-sectional view of the structure. d, e. FDTD simulation 

results showing effective mode conversion from the TE0 mode to the TE1 mode when the GST is 

in crystalline phase (d), but only a small perturbation when the GST is in amorphous phase (e). 

-11- 

 
 
 
 
Figure  2  Operation  of  the  programmable  metasurface  mode  converter  (PMMC).  a.  Scanning 

electron  microscope  (SEM)  image  of  the  complete  device  and  the  measurement  and  control 

schematics.  The  complete  PMMC  device  consists  of  an  encapsulated  GST  phase  gradient 

metasurface (red box) and a mode selectors (yellow box) and. The white box appears from the 

edge of 218 nm thick Al2O3 encapsulating layer. b. Zoomed-in SEM image of the phase-gradient 

metasurface on the waveguide before depositing the Al2O3 layer encapsulation for better imaging. 

c. Zoom-in SEM image of the TE0/TE1 mode selector. d. The transmission coefficient (insertion 

loss) of the devices for TE0 and TE1 modes and aGST and cGST phases. The transmission for the 

TE0  mode  is  switched  with  a  high  extinction  ratio  >16  dB  or  4000%.  e.  The  mode  purity  is 

controlled by the mode converter to >80% for both modes. f. The programable mode converter 

controls the mode contrast Œì at 64 distinct levels, corresponding 6-bit programming resolution. 

Upper inset: zoomed-in view of the contrast levels. Lower inset: histograms of 20 programming 

operations  to  set  the  contrast  two  adjacent  levels  (30  and  31).  The  well-separated  histograms 

demonstrate the programming repeatability and accuracy. 

-12- 

 
 
 
 
Figure 3 Using a PMMC array as a photonic computing core for convolutional image processing. 
a. Schematic of optical convolution for image processing. An array of k2 PMMC is programmed 

to store the kernel matrix. A patch of pixels of the image is encoded as optical pulses and input 

into k2 optical channels to perform MAC operation with the kernel. The output in TE0 and TE1 are 

summed incoherently and measured with photodetectors. The activation map is represented by the 

mode  contrast  and  could  be  both  positive  and  negative.  b.  Optical  microscope  image  of  the 

photonic  core  consisting  of  four  PMMCs  with  four  input  channels.  The  TE0  mode  outputs  are 

summed  on-chip  with  Y-junctions  whereas  TE1  mode  outputs  are  summed  off-chip.  Optical 

control pulses are input using the same set of grating couplers used for the TE1 mode detection. c. 

A greyscale image of a cameraman used as the input image. d. and e. Left: the raw image generated 

by convolution with the kernel matrix for detection of horizontal (d) and vertical (e) edges. Right: 

the corresponding kernel matrix for edge detection. f. Combined image of horizontal and vertical 

edge detection, highlighting all the sharp edges in the original image. 

-13- 

 
 
 
 
Figure 4 Building an optical CNN for imaging recognition. a. Operation procedure of using the 

optical  CNN  to  recognize  handwriting  numbers  from  the  MNIST  database.  The  optical  CNN 

consists of a convolution layer with two kernels, a pooling and a fully connected layer. The output 

gives the answer whether the input image is ‚Äú1‚Äù or ‚Äú2‚Äù. b. The convolution kernel matrices K1 and 

K2  generated  by  training  the  CNN.  c.  Raw  output  data  of  the  convolution  layer  of  two  kernel 

matrix. d. The weight bank matrix used in the fully-connected layer. e. The recognition results 

from the experiment with the optical CNN (left) and calculation with a computer (right) show an 

excellent agreement. 

-14- 

 
 
 
 
Reference: 

1 

2 

3 

4 

5 

6 

7 

8 

9 

Marr,  B.,  Degnan,  B.,  Hasler,  P.  &  Anderson,  D.  Scaling  Energy  Per  Operation  via  an 
Asynchronous  Pipeline.  IEEE  Transactions  on  Very  Large  Scale  Integration  (VLSI) 
Systems 21, 147-151, doi:10.1109/TVLSI.2011.2178126 (2013). 

Jones, N. How to stop data centres from gobbling up the world's electricity. Nature 561, 
163-166, doi:10.1038/d41586-018-06610-y (2018). 

Athale, R. & Psaltis, D. Optical Computing: Past and Future. Optics and Photonics News 
27, 32-39, doi:10.1364/OPN.27.6.000032 (2016). 

Solli,  D.  R.  &  Jalali,  B.  Analog  optical  computing.  Nat.  Photon.  9,  704-706, 
doi:10.1038/nphoton.2015.208 (2015). 

Prucnal, P. R. & Shastri, B. J. Neuromorphic photonics.  (CRC Press, 2017). 

Caulfield, H. J. & Dolev, S. Why future supercomputing requires optics. Nat. Photon. 4, 
261-263, doi:10.1038/nphoton.2010.94 (2010). 

Zhang, C., Zhang, S., Peters, J. D. & Bowers, J. E. 8 √ó 8 √ó 40‚Äâ‚ÄâGbps fully integrated silicon 
photonic network on chip. Optica 3, 785-786, doi:10.1364/OPTICA.3.000785 (2016). 

Shen, Y. W. et al. Silicon Photonics for Extreme Scale Systems. J. Lightwave Technol. 37, 
245-259, doi:10.1109/Jlt.2019.2897365 (2019). 

Wade, M. et al. in 2018 European Conference on Optical Communication (ECOC).  1-3. 

10  Wuttig, M., Bhaskaran, H. & Taubner, T. Phase-change materials for non-volatile photonic 

applications. Nat. Photon. 11, 465-476, doi:10.1038/nphoton.2017.126 (2017). 

11 

12 

13 

Yang, Z. & Ramanathan, S. Breakthroughs in Photonics 2014: Phase Change Materials for 
Photonics. Ieee Photonics Journal 7, 1-5, doi:10.1109/Jphot.2015.2413594 (2015). 

Zhang, W., Mazzarello, R., Wuttig, M. & Ma, E. Designing crystallization in phase-change 
materials for universal memory and neuro-inspired computing. Nature Reviews Materials 
4, 150-168 (2019). 

Briggs,  R.  M.,  Pryce,  I.  M.  &  Atwater,  H.  A.  Compact  silicon  photonic  waveguide 
modulator based on the vanadium dioxide metal-insulator phase transition. Opt. Express 
18, 11192-11201, doi:10.1364/OE.18.011192 (2010). 

14  Wang, Q. et al. Optically reconfigurable metasurfaces and photonic devices based on phase 
change materials. Nat. Photon. 10, 60-U75, doi:10.1038/Nphoton.2015.247 (2016). 

15 

16 

Chu, C. H. et al. Active dielectric metasurface based on phase‚Äêchange medium. Laser & 
Photonics Reviews 10, 986-994, doi:10.1002/lpor.201600106 (2016). 

Yin,  X.  et  al.  Beam  switching  and  bifocal  zoom  lensing  using  active  plasmonic 
metasurfaces. Light: Science & Applications 6, e17016-e17016, doi:10.1038/lsa.2017.16 
(2017). 

17  Wu, C. et al. Low-Loss Integrated Photonic Switch Using Subwavelength Patterned Phase 

Change Material. ACS Photonics 6, 87-92, doi:10.1021/acsphotonics.8b01516 (2018). 

-15- 

 
18 

19 

20 

21 

22 

23 

24 

Cheng, Z. et al. Device-Level Photonic Memories and Logic Applications Using Phase-
Change Materials. Adv. Mater., 1802435, doi:10.1002/adma.201802435 (2018). 

Xu, P., Zheng, J., Doylend, J. K. & Majumdar, A. Low-Loss and Broadband Nonvolatile 
Phase-Change  Directional  Coupler  Switches.  ACS  Photonics  6,  553-557, 
doi:10.1021/acsphotonics.8b01628 (2019). 

Zhang,  Y.  et  al.  Broadband  transparent  optical  phase  change  materials  for  high-
performance  nonvolatile  photonics.  Nat.  Commun.  10,  4279,  doi:10.1038/s41467-019-
12196-4 (2019). 

de Galarreta, C. R. et al. Nonvolatile Reconfigurable Phase-Change Metadevices for Beam 
1704993, 
Steering 
doi:10.1002/adfm.201704993 (2018). 

Infrared.  Adv.  Funct.  Mater. 

the  Near 

28, 

in 

Stegmaier, M., R√≠os, C., Bhaskaran, H., Wright, C. D. & Pernice, W. H. P. Nonvolatile 
All-Optical 1 √ó 2 Switch for Chipscale Photonic Networks. Advanced Optical Materials 5, 
1600346, doi:10.1002/adom.201600346 (2017). 

Zhang, Q. et al. Broadband nonvolatile photonic switching based on optical phase change 
materials: 
94, 
beyond 
doi:10.1364/OL.43.000094 (2018). 

figure-of-merit.  Opt. 

classical 

Lett. 

43, 

the 

Li,  X.  et  al.  Fast  and  reliable  storage  using  a  5-bit,  non-volatile  photonic  memory  cell. 
Optica 6, 1-6, doi:10.1364/OPTICA.6.000001 (2019). 

25  Martins,  T.  et  al.  Fiber-integrated  phase-change  reconfigurable  optical  attenuator.  Apl 

Photonics 4, 111301, doi:10.1063/1.5116000 (2019). 

26 

27 

28 

29 

30 

31 

32 

33 

34 

Zheng,  J.  et  al.  Nonvolatile  Electrically  Reconfigurable  Integrated  Photonic  Switch 
Enabled by a Silicon PIN Diode Heater. Adv. Mater., 2001218 (2020). 

George,  J.  K.  et  al.  Neuromorphic  photonics  with  electro-absorption  modulators.  Opt. 
Express 27, 5181-5191, doi:10.1364/OE.27.005181 (2019). 

Tait, A. N. et al. Silicon Photonic Modulator Neuron. Physical Review Applied 11, 064043, 
doi:10.1103/PhysRevApplied.11.064043 (2019). 

Hamerly, R., Bernstein, L., Sludds, A., Soljacic, M. & Englund, D. Large-Scale Optical 
Neural  Networks  Based  on  Photoelectric  Multiplication.  Physical  Review  X  9,  021032, 
doi:10.1103/PhysRevX.9.021032 (2019). 

Shen, Y. et al. Deep learning with coherent nanophotonic circuits. Nat. Photon. 11, 441-
446, doi:10.1038/nphoton.2017.93 (2017). 

Sun,  J.,  Timurdogan,  E.,  Yaacobi,  A.,  Hosseini,  E.  S.  &  Watts,  M.  R.  Large-scale 
nanophotonic phased array. Nature 493, 195-199, doi:10.1038/nature11727 (2013). 

Ribeiro,  A.,  Ruocco,  A.,  Vanacker,  L.  &  Bogaerts,  W.  Demonstration  of  a  4x4-port 
universal linear circuit. Optica 3, 1348-1357, doi:10.1364/OPTICA.3.001348 (2016). 

Bocker,  R.  P.  Matrix  multiplication  using  incoherent  optical  techniques.  Appl.  Opt.  13, 
1670-1676, doi:10.1364/AO.13.001670 (1974). 

R√≠os,  C.  et  al.  In-memory  computing  on  a  photonic  platform.  Science  Advances  5, 
eaau5759, doi:10.1126/sciadv.aau5759 (2019). 

-16- 

 
35 

36 

37 

38 

39 

40 

41 

42 

43 

44 

45 

46 

47 

48 

49 

50 

Chakraborty, I., Saha, G. & Roy, K. Photonic In-Memory Computing Primitive for Spiking 
Neural  Networks  Using  Phase-Change  Materials.  Physical  Review  Applied  11,  014063, 
doi:10.1103/PhysRevApplied.11.014063 (2019). 

Caulfield, H. J., Kinser, J. & Rogers, S. K. Optical neural networks. Proc. IEEE 77, 1573-
1583, doi:10.1109/5.40669 (1989). 

Feldmann,  J.  et  al.  Parallel  convolution  processing  using  an  integrated  photonic  tensor 
core. arXiv preprint arXiv:2002.00281 (2020). 

Feldmann,  J.,  Youngblood,  N.,  Wright,  C.  D.,  Bhaskaran,  H.  &  Pernice,  W.  H.  P.  All-
optical spiking neurosynaptic networks with self-learning capabilities. Nature 569, 208-
214, doi:10.1038/s41586-019-1157-8 (2019). 

Li, Z. Y. et al. Controlling propagation and coupling of waveguide modes using phase-
gradient metasurfaces. Nat. Nanotechnol. 12, 675-+, doi:10.1038/Nnano.2017.50 (2017). 

Park,  J.-W.  et  al.  Optical  properties  of  pseudobinary  GeTe,  Ge2Sb2Te5,  GeSb2Te4, 
GeSb4Te7, and Sb2Te3 from ellipsometry and density functional theory. Phys. Rev. B 80, 
115209, doi:10.1103/PhysRevB.80.115209 (2009). 

Liu,  Y.,  Aziz,  M.  M.,  Shalini,  A.,  Wright,  C.  D.  &  Hicken,  R.  J.  Crystallization  of 
Ge2Sb2Te5  films  by  amplified  femtosecond  optical  pulses.  J.  Appl.  Phys.  112, 
doi:10.1063/1.4770359 (2012). 

Farmakidis,  N.  et  al.  Plasmonic  nanogap  enhanced  phase-change  devices  with  dual 
eaaw2687, 
Science 
functionality. 
electrical-optical 
doi:10.1126/sciadv.aaw2687 (2019). 

Advances 

5, 

Zhang,  H.  et  al.  Miniature  Multilevel  Optical  Memristive  Switch  Using  Phase  Change 
Material. ACS Photonics 6, 2205-2212, doi:10.1021/acsphotonics.9b00819 (2019). 

Rodriguez-Hernandez, G., Hosseini, P., R√≠os, C., Wright, C. D. & Bhaskaran, H. Mixed-
Mode Electro-Optical Operation of Ge2Sb2Te5 Nanoscale Crossbar Devices. Advanced 
Electronic Materials 3, 1700079, doi:10.1002/aelm.201700079 (2017). 

R√≠os,  C.  et  al.  Integrated  all-photonic  non-volatile  multi-level  memory.  Nat.  Photon.  9, 
725-732, doi:10.1038/nphoton.2015.182 (2015). 

Giannopoulos,  I.  et  al.  in  2018  IEEE  International  Electron  Devices  Meeting  (IEDM)    
27.27.21-27.27.24 (IEEE, 2018). 

Le Gallo, M. et al. Mixed-precision in-memory computing. Nature Electronics 1, 246-253, 
doi:10.1038/s41928-018-0054-8 (2018). 

Nahmias,  M.  A.  et  al.  Photonic  Multiply-Accumulate  Operations  for  Neural  Networks. 
Ieee J Sel Top Quant 26, 1-18, doi:10.1109/jstqe.2019.2941485 (2020). 

Convolution  Neural  Network  -  simple  code  -  simple  to  use  (MATLAB  Central  File 
Exchange, 2020). 

Xiong,  C.  et  al.  Monolithic  56‚Äâ‚ÄâGb/s  silicon  photonic  pulse-amplitude  modulation 
transmitter. Optica 3, 1060-1065, doi:10.1364/OPTICA.3.001060 (2016). 

-17- 

 
51  Moazeni, S. et al. A 40-Gb/s PAM-4 Transmitter Based on a Ring-Resonator Optical DAC 
in  45-nm  SOI  CMOS.  Ieee  Journal  of  Solid-State  Circuits  52,  3503-3516, 
doi:10.1109/Jssc.2017.2748620 (2017). 

52 

53 

54 

55 

56 

57 

58 

59 

60 

61 

62 

63 

64 

65 

66 

Sawchuk, A. A. & Jenkins, B. K. in Optical Computing.  143-153 (International Society 
for Optics and Photonics). 

Joshi, A. et al. in 2009 3rd ACM/IEEE International Symposium on Networks-on-Chip.  
124-133 (IEEE). 

Khope, A. S. P. et al. Multi-wavelength selective crossbar switch. Opt. Express 27, 5203-
5216, doi:10.1364/OE.27.005203 (2019). 

Ohno, S., Toprasertpong, K., Takagi, S. & Takenaka, M. Si microring resonator crossbar 
arrays for deep learning accelerator. Jpn. J. Appl. Phys. 59, SGGE04, doi:10.35848/1347-
4065/ab6d82 (2020). 

Nahmias, M. A. et al. Photonic multiply-accumulate operations for neural networks. Ieee 
J Sel Top Quant 26, 1-18 (2019). 

Han, S., Seok, T. J., Quack, N., Yoo, B.-W. & Wu, M. C. Large-scale silicon photonic 
370-375, 
switches 
doi:10.1364/OPTICA.2.000370 (2015). 

with  movable 

directional 

couplers. 

Optica 

2, 

Tait, A. N., Chang, J., Shastri, B. J., Nahmias, M. A. & Prucnal, P. R. Demonstration of 
WDM  weighted  addition  for  principal  component  analysis.  Opt.  Express  23,  12758, 
doi:10.1364/OE.23.012758 (2015). 

Tait, A. N., Nahmias, M. A., Shastri, B. J. & Prucnal, P. R. Broadcast and Weight: An 
Integrated  Network  For  Scalable  Photonic  Spike  Processing.  J.  Lightwave  Technol.  32, 
4029-4041, doi:10.1109/JLT.2014.2345652 (2014). 

https://www.nvidia.com/en-us/titan/titan-v/. 

Silver, D. et al. A general reinforcement learning algorithm that masters chess, shogi, and 
Go through self-play. Science 362, 1140-+, doi:10.1126/science.aar6404 (2018). 

Jouppi,  N.  P.  et  al.  in  Proceedings  of  the  44th  Annual  International  Symposium  on 
Computer Architecture - ISCA '17    1-12 (ACM Press, New York, New York, USA, 2017). 

Li, X. et al. Experimental investigation of silicon and silicon nitride platforms for phase-
change photonic in-memory computing. Optica 7, 218-225, doi:10.1364/OPTICA.379228 
(2020). 

Gayen, D. K., Chattopadhyay, T., Pal, R. K. & Roy, J. N. All-optical Multiplication with 
the  help  of  Semiconductor  Optical  Amplifier‚Äîassisted  Sagnac  Switch.  Journal  of 
Computational Electronics 9, 57-67, doi:10.1007/s10825-010-0305-z (2010). 

Atabaki,  A.  H.  et  al.  Integrating  photonics  with  silicon  nanoelectronics  for  the  next 
generation  of  systems  on  a  chip.  Nature  556,  349-354,  doi:10.1038/s41586-018-0028-z 
(2018). 

Bangari,  V.  et  al.  Digital  Electronics  and  Analog  Photonics  for  Convolutional  Neural 
Networks 
1-13, 
J 
(DEAP-CNNs). 
doi:10.1109/JSTQE.2019.2945540 (2020). 

Quant 

Ieee 

Top 

26, 

Sel 

-18- 

 
