ActiveLearningonaProgrammablePhotonicQuantumProcessorChenDing,1,∗Xiao-YueXu,1,∗Yun-FeiNiu,1ShuoZhang,1Wan-SuBao,1,†andHe-LiangHuang1,2,3,4,‡1HenanKeyLaboratoryofQuantumInformationandCryptography,Zhengzhou,Henan450000,China2HefeiNationalResearchCenterforPhysicalSciencesattheMicroscaleandSchoolofPhysicalSciences,UniversityofScienceandTechnologyofChina,Hefei230026,China3ShanghaiResearchCenterforQuantumScienceandCASCenterforExcellenceinQuantumInformationandQuantumPhysics,UniversityofScienceandTechnologyofChina,Shanghai201315,China4HefeiNationalLaboratory,UniversityofScienceandTechnologyofChina,Hefei230088,China(Dated:August4,2022)Trainingaquantummachinelearningmodelgenerallyrequiresalargelabeleddataset,whichincurshighlabelingandcomputationalcosts.Toreducesuchcosts,aselectivetrainingstrategy,calledactivelearning(AL),choosesonlyasubsetoftheoriginaldatasettolearnwhilemaintainingthetrainedmodel’sperformance.Here,wedesignandimplementtwoAL-enpoweredvariationalquantumclassiﬁers,toinvestigatethepotentialapplicationsandeffectivenessofALinquantummachinelearning.Firstly,webuildaprogrammablefree-spacephotonicquantumprocessor,whichenablestheprogrammedimplementationofvarioushybridquantum-classicalcomputingalgorithms.Then,wecodethedesignedvariationalquantumclassiﬁerwithALintothequantumprocessor,andexecutecomparativetestsfortheclassiﬁerswithandwithouttheALstrategy.TheresultsvalidatethegreatadvantageofALinquantummachinelearning,asitsavesatmost85%labelingeffortsand91.6%percentcomputationaleffortscomparedtothetrainingwithoutALonadataclassiﬁcationtask.OurresultsinspireAL’sfurtherapplicationsinlarge-scalequantummachinelearningtodrasticallyreducetrainingdataandspeeduptraining,underpinningtheexplorationofpracticalquantumadvantagesinquantumphysicsorreal-worldapplications.I.INTRODUCTIONThefastlydevelopingquantummachinelearningalgo-rithmscouldhelpsolvenumerousphysicalandreal-worlddataanalysisissues[1–9],andtheirpotentialcomputationaladvantagesoverclassicalcounterpartshavebeeninvestigatedandevenproveninavarietyoftheoreticalandexperimen-talworks[10–23].Despitethefactthatthefuturesubver-sionofquantummachinelearningapplicationsisrapidlyap-proaching,therearestillissuesthatneedtoberesolvedforlarge-scalepracticalapplications.Oneoftheremainingprob-lemsisthehighcostoflabelingdataitemsforsupervisedlearningapplications[24–26].Sincethelabelingtaskre-quiresﬁndingacertainamountofanswerstothequestion-to-solve,suchworkusuallyinvolvesinefﬁcientdatacollec-tionorlargehumanlabour,especiallyforquantummachinelearningmodels.Inapplicationsliketrainingquantuman-toencoder[27,28],learningquantumdynamics[9,29]andsolvingreal-worldproblemswithpowerfulvariationalquan-tummodels[7,8,18,30–32],preparingquantumstatesandla-belingquantumstateorquantumprocessesusuallyconsumeshugephysicalresources.Thisdrawbackseverelyhurdlesthefurtherdevelopmentoftheirpracticalapplications.Activelearning(AL)[33–35]isaeffectivemethodtore-solvetheaboveproblem.Insteadofacquiringallthelabeleddatatodothetrainingjob,ALstrategiesenablethemodeltoqueryonlyasubsetoftheoriginaldata,whilekeepingthecapabilitytofaithfullyextractthemostcriticalfeaturesfromthewholedataset.Toachievethisgoal,themodelanalyzes∗Thesetwoauthorscontributedequally.†bws@qiclab.cn‡quanhhl@ustc.edu.cntheunlabeleddatapoolandchoosesonlytherepresentativedataitemstolearn.Besidessavingthelabelingcost,activelearningalsoacceleratesthetrainingprocessandmayacquirecomputationaladvantage.Recentworkhasdemonstrateditsfeasibilityinquantum-relatedclassicalmachinelearningap-plicationslikeretrievingquantuminformation[36–38]andcreatenewquantumexperiments[39].However,itspotentialapplicationsandpracticalityforquantummachinelearningre-mainsunknown.Inthispaper,weimplementtwoAL-enpoweredvariationalquantumclassiﬁersonaprogrammablephotonicquantumprocessor.Thewholesystemisbuiltbyhigh-qualitysingle-photonsources,andcircuittrainingandmeasurementdevicesconnectedtoacontrolserver,enablingfullyprogrammedandhigh-precisionmanipulation(theaverageﬁdelityofthepro-grammablesingle-qubitgateis99.88%)oftheexpectationmeasurement,gradientevaluationandcircuittraininginthequantumprocessor.WiththeALstrategiescodedintothepro-gram,weapplythemtothevariationalquantumclassiﬁerandthenonlinearity-enhancedvariationalquantumclassiﬁer.OurcomparativeresultsconﬁrmtheefﬁcacyofALinreducingthecostofquantummachinelearning,anditsrobustadaptabilitytodifferentquantummachinelearningmodels.Furthermore,ourtechniquesalsodemonstrateapathtowardsopticalimple-mentationofvarioustypesofhybridquantum-classicalalgo-rithmsinfree-spacephotonicquantumprocessors.II.ACTIVELEARNINGActivelearningisatypeofstrategiesthatappliesselectivetechniquetoreducethetrainingsetsize,whilepreservingtheperformanceoftheoriginalmachinelearningalgorithm.Gen-erally,wecanviewthetrainingprocessofactivelearningasarXiv:2208.02104v1  [quant-ph]  3 Aug 20222LearnerLabelerlabeling training setQuantum classifieroraclepicking data to labelcommiteeclass 0 class 1 add datapredictionuncertaintyABCunlabeled data poollabeled datasetFIG.1.Theschematicdiagramofactivelearning.Fromtheunla-beleddatapool,thelearnersequentiallyselectsamostrepresentativedataitem(byevaluatingthedatauncertaintyorconsultingacommit-teeofmachinelearningmodels)toquerywiththelabeler.Thelabeleranswerseachquerywiththetruelabel.Thelearnerthentrainsthemodelforashorttimeperiod,andcontinuestoselectanewdataitemtolearnuntilconvergence.thecooperationworkofalearnerandalabeler,asshowninFig.1.Thelearnerisfamiliarwiththemodel,thedataset,butunawareoftheirlabels.Meanwhile,thelabelerownsala-belingoracleandknowsnothingelse.Thetrainingworksasfollows:1.Inthebeginning,thelabelersendsafewlabeleddataitemstothelearner.Thelearnerbuildsaprototypeofthemodelusingthegivendataasthetrainingset.2.Byacertainselectingstrategy,thelearnerselectsonedataitemfromtheunlabeleddatapooltoquerythelabeler,thenaddsthelabeleditemtothetrainingset.3.Thelearnertrainsthemodelwiththeupdatelabeledtrainingset.RepeatSteps2and3untilconvergence.Toensureef-fectiveness,themostrepresentativedataitemscouldbeex-tractedbysomeadvancedselectingstrategy,includingun-certaintysampling(USAMP)[40–42],Query-by-Committee(QBC)[43],evaluatingexpectedmodelchange[44],errorre-duction[45],etc.Thosemethodsassesstheinformativenessofdataitemsfromdifferentperspectives.Amongthem,twomosttypicaltechniques[36],USAMPandQBC,arechosenforourALexperimentsandthuswillbebrieﬂyintroducedbelow.Denotethetrainingsetas{xi},i=1,...,m,theircorre-spondinglabelsasyiinsetL.TheUSAMPmethodevaluateseachdataitem’suncertaintyformodelθasU(xi)=−maxy∈LP(θ(xi)=y),(1)andselectthedataitemwithmostuncertaintytoquerythelabeler.TheQBCmethodappointsacommitteeofseveralmachinelearningmodels,notedasθ1,...,θC.Foreachdataitem,thecommitteemembersﬁrstguessitslabelseparately,andthentakeavote.TheﬁnalselectiongoestothemostdivergentitemwiththehighestvoteentropyE(xi)=−XjV(yj|xi)C·lnV(yj|xi)C,(2)whereV(yj|xi)=PCk=1δθk(xi),yjdenotestothenumberofvotesforlabelyiinthecommittee.III.EXPERIMENT&RESULTSInthissection,wewillimplementtheALexperimentsonaprogrammablefree-spacephotonicquantumprocessor(seeFig.2).Theexperimentalsetupconsistsoftwomainmod-ules,dataencodingandvariationalquantumcircuits(VQCs),bothofwhichareprogrammable.TwotypesofVQCswithdifferentcapabilitiesareimplementedinourexperimentsfortheclassiﬁcationtask.TheresultsshowthatALstrategyhasstrongadaptabilityindifferentmachineleaningmodels,andcangreatlyreducetheamountofdataandcomputationalcost.A.DataEncodingAsshowninFig.2(a),normalizedvectors(cosxi,sinxi)distributedonanarcoflengthπaretakenasthedataforclas-siﬁcation.Thesevectorsaredividedintotwoclasses,labelingasyi=±1(markedredandblue,respectively).Tovariatethedifﬁcultyoftheclassiﬁcation,threepatternsofdividingthesevectorsaredesigned.Toencodethesedataintoquantumstateswithhighﬁdelity,weﬁrstbuildasingle-qubitphotonsource.AsshownontheBoardIinFig.2(c),laserpulseswithacentralwavelengthof390nm,pulsedurationof150fs,andrepetitionrateof80MHzpassthroughahalf-waveplate(HWP)sandwichedbytwoβ-bariumborate(BBO)crystals.Bythespontaneousparametricdown-conversion(SPDC)process,entangledpho-tonpairsofvisibilitymorethan100:1areproducedonthetwosides.Thetwophotonsareinanentangledstate(|HVi+|VHi)/√2,where|Hirepresentsthehorizontalpo-larizationand|Virepresentstheverticalpolarization.Wealsonote|Hias|0i,and|Vias|1i.Then,apolarizingbeamsplitter(PBS)ononesidepost-selectsthephotonsas|HVi,whichdisentangledthem.Wedenotethephotonofhorizontalpolarizationasthe“dataphoton”,andtheotherphotonasthe“ancillaphoton”.Asingle-qubitgateformedbyaHWPatanglex/2(denotebyHWP(x))encodesthedatatothephotonas(cid:18)cosxsinxsinx−cosx(cid:19)|Hi=cosx|Hi+sinx|Vi.(3)Thewholedataset{(cosxi,sinxi)}i=1,...,misencodedtotheclassiﬁersuccessively.Inasingleepoch,eachanglexiisvisitedbytheHWPforashortduration,toevaluateasepa-ratelossfunctionorgradient.Thenaclassicalcomputerwillsumallthetermstogetherandyieldtheparameters-to-beinthenextepoch.Sincethesizeofdatasetisgenerallylarge3(a)(b)PBSData encodingData encodingancillaVQCMeasurement(c)MeasurementNEVQCHWP(θ1)HWP(x)HWP(x)HWP(θ)HWP(θ2)H3pi/4pi/4Pattern 1pi/83pi/8Pattern 2arctan(1/4)Pattern 3II. VQCIII. NEVQCI. Data encodingababpost-selecttriggerab213456nonlinear functionFIG.2.Theexperimentdesignandimplementation.(a)Threepatternsofdividingthedataitemsonanarc,designedtovariatethedifﬁcultyoftheclassiﬁcationtaskforvariationalquantumclassiﬁer.(b)Thecircuitofourvariationalquantumclassiﬁer(VQC)andthenonlinearity-enhancedvariationalquantumclassiﬁer(NEVQC).Thenonlinearity,enhancingtheperformanceofVQConthedatadividingpatterns,isintroducedbyanentanglingoperationsfollowedbypostselectingtheancillaphotonas|0i.(c)Theexperimentalsetupsonthephotonicquantumprocessor.Theimplementationsofdataencoding(introducedinSec.IIIA),VQC(Sec.IIIB),NEVQC(Sec.IIIC)areplacedonthreeboards,connectedthroughopticalﬁlbers.Thephotondetecters(notedinwhitenumbersas1-6)andelectricrotationstagesarealsoconnectedtotheclassicalcomputer,automatingtheprocessofexpectationmeasurement,gradientevaluation,andcircuittraining.Thedataphotonandancillaphotonarenotedasredlettersasaandb.Ontheseboards,allphotonsarespectrallyﬁlteredwith3nmbandwidthﬁlters.Devices:C-BBO,sandwich-likeBBO+HWP+BBOcombination;QWP,quarter-waveplat;SC-YVO4,YVO4crystalforspatialcompensation;TC-YVO4,YVO4crystalfortemporalcompensation;Babinet,Soleil-Babinetcompensators.(a)(b)FIG.3.ThecalibrationofHWPduringlong-termautomaticrotation.(a)TheresponsecurveofHWPduring10000steprota-tion.WeconstantlyrotatetheHWPfromangle0to100πwithstepsize0.01π.AsinglephotonofhorizontalpolarizationstatepassesthroughtheHWPandismeasuredfor0.1secondaftereachrota-tionstep.Thedottedlineshowsthetheoretical|Hiprobabilityinthephoton,whilethecirclesshowtheexperimentalmeasurementre-sults,witharound2000shots.Weabbreviatethemiddlesegmentoftheresponsecurveforclarityoftheresult.(b)ThedistributionofcalibratedgateinﬁdelitiesoftheHWPduringthelong-termrotation.Theaverageinﬁdelityisaround0.12%.Ourcalibrationresultsshowahighaccuracyandstabilityofthesingle-qubitgateformedbyHWPduringlong-termautomaticrotation.inmachinelearning,aheavyHWProtationworkisbrought.Forinstance,evaluatingthelossfunctionfor1000epocheswithdatasetsizeof100willneedabout105rotationsofdis-tance500πontheencodingHWP,makingmanualexperimentimpossible,nottomentionthesubsequentlowoperationac-curacy.Toovercomethisproblemandaccuratelyencodelargedatasets,weautomatetherotationoftheHWPbyinstallingitintoelectricrotationstageandleavethelargerotationworktoaclassicalcomputercontrollingthestage.WecalibratetheresponsecurveoftheHWPtoinvestigatetheirﬁdelityandstabilityduringlong-termelectronicallycontrolledrota-tions.TheresultsinFig.3showtheHWP’sresponseisingoodagreementwiththetheoreticalestimationduringlong-termautomaticrotation,withtheaverageﬁdelityestimatedbythesquaredstatisticaloverlap[46]¯F=110000X1−(cid:16)√piqi+p(1−pi)(1−qi)(cid:17)2,as99.88%(pi,qiarethetheoreticalandexperimental|Hiprobabilityintheoutcomephoton,respectively,duringthe10000steprotation.).Ourhigh-performancetechniquemakespossiblethetrainingoflargequantummachinelearningmod-els,aswealsoapplyittotheiterationsofansatzparametersinmodeltraining.4B.VariationalQuantumClassiﬁer(VQC)1.AnsatzForclassifyingtheone-qubitdata,weemploysingle-qubitparameterizedquantumcircuitconsistingofatrainablesingle-qubitgateformedbyaHWP,denotedbyHWP(θ),asthetrainableansatz,asshownonthetoppanelinFig.2(b).Thevariationalansatzapplysontheinputstatesandanalyzestheencodedinformation.TheoutputstatesareallmeasuredinPauli-Zbasis.Theclassiﬁcationruleforstate|xiissetashZ(x,θ)i>0→1hZ(x,θ)i<0→−1,inwhichV(·)istheparameterizedquantumcircuit,hZ(xi,θ)i=hxi|V†(θ)ZV(θ)|xiiisthemeasuredexpec-tation.Thecircuitparameterθisoptimizedtominimizethemeansquarederror(MSE)lossfunctiononthegivendatasetC(θ)=Xi(hZ(xi,θ)i−yi)2.(4)Generally,theoptimizationmethodisgradientdescent,inwhichthecostfunctiongradientdC(θ)dθ=Xi(hZ(xi,θ)i−yi)dhZ(xi,θ)idθ,(5)isevaluatedbyparametershiftrule[47]dhZ(xi,θ)idθ=12(cid:16)hZ(xi,θ+π4)i−hZ(xi,θ−π4)i(cid:17).(6)2.ExperimentalImplementationOurimplementationofthecircuitisshownontheBoardIIinFig.2(c),wherethephoton-aisusedtoperformthedataen-codingandvariationalquantumclassiﬁer.ThemeasurementofthedataphotonisachievedbyaPBSandtwodetectorsonthetransmissionandreﬂectiondirection.TheexpectationisthencalculatedashZi=N13−N23N13+N23,(7)inwhichN13,N23arethenumberofcoincidenceeventsamongDetector1-3in0.1second.InEquation(7),thede-tectionsignalofancillaphoton(photon-b)isusedasthetrig-gerforthedetectionofthedataphoton.Partialhigher-orderevents(e.g.,double-pairemission)duringSPDC,suchasthenoiseeventsN123,areautomaticallysubtractedtoimprovetheaccuracyoftheexperiment.[48].Foreachxi,θ,theoverallnumberofmeasurementshotsisaround2000.Weconnectallthedetectorstoaclassicalcomputerthatau-tomaticallyevaluatesEquation(4,5,7)withthedetectionrawdata.SincetheHWPsareinstalledonelectricrotationstage,(a)(b)FIG.4.Theoptimizedrotationsequencesforthetwovaria-tionalquantumclassiﬁers.(a)TherotationsquenceofVQC.Thepointsshowtherequiredvisitingpositions(xi,θ),(xi,θ+π/4)inoneiteration.Thearrowsshowtherotationroute.Weﬁrstro-tateHWP(θ)toθ+π/4andletHWP(x)rotatesfromx1toxm.ThenwerotateHWP(θ)toθandletHWP(x)rotatesbackfromxmtox1.(b)TherotationsquenceofNEVQC.Thepositions(xi,θ2,θ1),(xi,θ2±π/4,θ1),(xi,θ2,θ1±π/4)aredistributedinthree-dimensionalspace.Sincethenumberofdataitemsxiisgen-erallylarge,wedividedthepositionsintoﬁvegroups.Eachgroupcontainsasetofpositionswithsameθs.Welettheclassiﬁerpref-erentiallytravelsinthexidirection,whichisillustratedasthecolorfadingineachgroup.welettheclassicalcomputerdirectstheiterationofparameterθwiththeevaluatedgradientandAdamoptimizer[49],whichformsaclosedcontrolloop.Ineachepoch,accordingtoEquation(5,6),expectationshZ(xi,θ±π/4)iandhZ(xi,θ)ineedtobeevaluated,whichmeanstheHWPsneedtorotatetotheangles(xi,θ)and(xi,θ±π/4).SincetheHWPscanonlybecontinouslyro-tating,thetotalrotationdistance(alsothetimeconsumption,givenaconstantrotatingspeed)duringthetrainingcruciallydependsontherotationsequenceofHWP(θ)andHWP(x),presentingastheroutepassingthroughtheseanglepositions.Thoughﬁndingashortestroutepassingthediscretepointsinthespace(thetravellingsalesmanproblem),isgenerallyhardtosolve[50],wedevelopfollowingtwotechniquestospeedupthetrainingprocessandsubsequentlyimprovethecomputingaccuracy.Firstly,fromthedesignofthesingle-qubitparameterizedquantumcircuit,itiseasytoﬁndhZ(xi,θ+π4)i+hZ(xi,θ−π4)i=1.(8)ThenEquation(5)canbesimpliﬁedasdC(θ)dθ=Xi(hZ(xi,θ)i−yi)(2hZ(xi,θ+π4)i−1),(9)whichreducestherequiredvisitingpositionstoonly(xi,θ)and(xi,θ+π/4),savingboththerotationstepsandtherota-tiondistance,whichfurtherreducesthecumulativeerrordur-ingthewholeepoch.Secondly,wenotethepositionsweneedtopassthrougharedistributedontwoparallellines,wherethenumberofxi(alsothesizeoftrainingset)isgenerallylarge.ToavoidthefrequentroundtripofHWP(θ),welettheprogramtravelsalongthexidirectionwithpriority,whichformsaU-shapedroutedemonstratedinFig.4(a).5FIG.5.TheperformanceofVQC,NEVQCwithandwithoutALstrategiesduringthewholetrainingprocess.(a-f)TheclassiﬁcationaccuraciesofVQC/NEVQConthetestingsetwiththevaryingnumberofexpectationevaluations.Eachlineshowsanaverageresultover4indenticalindependentexperimentsandthebandsshowthestandarddeviation.ThebluedashedlinesmarktheclassiﬁcationaccuraciesofVQC(withoutAL)atconvergenceandthecorrespondingnumbersofevaluations.ThegreenandorangedashedlinesshowthetherequirednumbersofevaluationsofVQC(withUSAMPandQBC,respectively)thatachievethesameclassiﬁcationaccuraciesasVQCwithoutAL.(g-i)TheclassiﬁcationaccuraciesofVQC/NEVQC(withALtrainingstrategies)onthetestingsetwithvaryingtrainingsetsize.Thecolorofeachhorizontalbarshowstheaverageclassiﬁcationaccuracywiththecorrespondingtrainingsetsizemarkedonthex-axis.ThegreentrianglesonthebarsshowtherequiredtrainingsetsizetoachievethesameclassiﬁcationaccuraciesasVQCwithoutAL.ThebluetrianglessuggestscasesthattheﬁnalclassiﬁcationaccuraciesofVQC/NEVQCwithQBCstrategyandthe10-data-itemtrainingsetcannotmatchtheﬁnalclassiﬁcationaccuraciesofVQC/NEVQCwithoutAL(butalreadyveryclose).Amongthesesubﬁgures,eachcolumncorrespondstoeachdatasetdividingpatterns,showninFig.2(a).Tab.IshowsthecorrespondinglabelingandcomputationalcostratiosforclassiﬁerswithandwithoutAL.3.ResultsWeﬁrsttraintheclassiﬁerwithoutALfor35stepswith20labeleddatavectorsofthreedividingpatterns.ThenweadopttheUSAMPandtheQBCstrategiestotheclassiﬁerrespec-tivelytoobservetheperformanceimprovementofAL.Welettheclassiﬁeractivelyselects10samplestolearnfromanunlabeleddatapoolof20dataitems,startingfromthegiven2(forUSAMP)or3(forQBC)dataitemswithdifferentla-bels.Foreachsample,theclassiﬁertrainsitselffor10epocheswiththedataithas.ThemembersofthecommitteeforQBCstrategyareSupportVectorClassiﬁer(SVC)[51,52]withtheRadialBasisFunction(RBF)kernel,k-nearestneighborclas-siﬁcation[53,54]withk=3,LinearDiscriminantAnalysisalgorithm[55,56],anddecisiontree[57,58]withmaxdepth7.ThesemodelsaredetailedlyintroducedinSupplemental6Material.Theirhyperparametersarepre-optimizedtoﬁtourclassiﬁcationtaskshere.Tomonitortheclassiﬁers’perfor-manceduringthetrainingprocess,wetimelybenchmarktheclassiﬁer’sperformance.Wedothetestfor5(forwithoutAL)or10(forAL)epochesbyatestingsetofthecorrespondingtrainingsetpatternwith500vectors.Wealsoconductcorre-spondingnumericalsimulations(SeeresultsinSupplementalMaterial)tovalidatetheexperimentresults.Theclassiﬁcationaccuraciesduringthewholetrainingpro-cessareshowninFig.5(a-c).TheperformanceoftrainingwithoutAL,andthetrainingwithtwoactivelearningstrate-giesarecomparedtogetherwiththesame“numberofevalua-tions”,whichiscalculatedasthecumulativetimesofexpec-tationevaluation,directlycorrespondingtotherealistictimeconsumption.TheresultssuggesttheALtrainingstrategiesgenerallyaccleratethetrainingastheyachievessameclas-siﬁcationaccuracywithsmallernumberofevaluationsthantrainingwithoutAL.Weshowtheratiosoflabelingandcom-putationalcosts(AL/non-AL)inTab.I.Thelabelingcostsofthemethodsarethenumbersoflabeleddataitemsfortrain-ing,andthecomputationalcostsarecalculatedastheirnum-berofevaluations.Fromthetable,wecanseethattheALcanachieveamaximumreductionof91.6%computingresources,comparedwiththeclassiﬁerwithoutAL,inthecaseofusingtheUSAMPstrategyforPatten3.Figure5(g-i)showtheclas-siﬁcationaccuraciesvaryingwithtrainingsetsize.Weﬁndtheperformanceofbothactivelearningstrategiesbecomesbetterastheyexpandthetrainingsetsize.Inmostcases,comparedtotheclassiﬁerwithoutAL,theclassiﬁerwithALachievesthesameclassiﬁcationaccuracy(nearconvergencepoint)inthetrainingsetoflessthan10dataitems.AscanbeseenfromTab.I,thelabelingeffortscanbereducedbyupto85%,inthecaseofusingtheUSAMPstrategyforPatten3.Thesingle-qubitclassiﬁerperformsbestonPattern1,whileworstonPattern3,showingitsendogenousclassiﬁcationabil-ity,asitsdividingboundariesarealwaysvertical(seearigor-ousproofinSupplementalMaterial).Tofurtherboosttheper-formance,westrengthentheclassiﬁerbyaddinganonlinearoperationtothemodel.C.Nonlinearity-EnhancedVariationalQuantumClassiﬁer(NEVQC)Weintroducenonlinearitytotheansatztoenhancethepowerofourvariationalquantumclassiﬁer[59,60],byin-troducinganancillaqubitandsomeadditionalquantumop-erations.AsshownonthebottompanelinFig.2(b)andtheBoardIIIinFig.2(c).WeﬁrstapplyaHadamardgateontheancillaphotontoprepare(|Hi+|Vi)/√2.Then,weapplyaPBSonthetwophotonsandpostselecttheeventswherethereisexactlyonephotonexitingeachoutputofthePBS.Twoparameterizedsingle-qubitgatesareinsertedintothecir-cuitfortrainingthemodel.Finally,wepostselect|0ieventsintheancillaandmeasuretheinputqubitintheZbasis.Theancillaphoton,anadditionalHadamardgateandPBSopera-tion,andpost-selectionofmeasurements,constitutetheintro-ducednonlinearity.WenotethatsuchnonlinearitydoesnotevenrequiretheoccuranceofinterferenceonthePBS(SeeproofinSupplementalMaterial).Therefore,wedonotneedtointentionallybalancetheopticaldistancedifferencebetweenthedataphotonandtheancillaphoton,whichisexperimentfriendly.WealsoconducttheinterferenceversionofthesameexperimentandshowtheresultsinSupplementalMaterial.ThemeasuredZexpectationforphoton-aiscalculatedashZi=N45−N46N45+N46,(10)inwhichN45,N46arethenumberofcoincidenceeventsamongDetector4-6inonesecond.Thenumberofmeasure-mentshotsis5500.Thesameexperimentsettings,includingthecostfunc-tion,theactivelearningstrategies,thedatasetconﬁgura-tion,areappliedforNEVQCasforVQC.However,theautomaticrotationschemeoftheelectricallydrivenHWP(trainablesingle-qubitgate)slightlydifferent,sincewenowhavethreeelectricallydrivenHWPs(HWP(x)forencod-ingthedataandHWP(θ1),HWP(θ2)forthetwotrainablesingle-qubitgates),thusthecorrespondingrouteisthenin3-dimensionalspace.Moreover,Equation(8)nolongerholds.Theprogramneedstodothemeasurementswiththeanglesas(xi,θ2,θ1),(xi,θ2±π/4,θ1),(xi,θ2,θ1±π/4)fortheeval-uationofderivatives∂C/∂θ2and∂C/∂θ1.Ourstrategyisyetsimilar.AsshowninFig.4(b),sameasinthetrainingofVQC,welettheprogrampreferentiallytravelinthexidirec-tion,andthenseektheshortestpathamongtheﬁveparameterconﬁgurations({(θ1,θ2),(θ1±π/4,θ2±π/4)})inthelefttwodimension.Theclassiﬁcationaccuraciesduringthewholetrainingpro-cessinFig.5(d-f)showtheadvantageofNEVQCcomparedtoVQC,asitgenerallyachieveshigherclassiﬁcationaccura-ciesonthethreepatterns,whichfullydemonstratestheperfor-manceimprovementafterweintroducenonlinearoperation.TheefﬁcacyofactivelearningisalsovalidatedonNEVQC,asUSAMPandQBCachievessameclassiﬁcationaccuracyinlesstimethanthetrainingwithoutALinmostcases.AsshowninTab.I,thetrainingwithALstrategiesrequireonly17.6%numberofevaluationstomatchtheperformanceoftrainingwithoutALinthebestcase.Meanwhile,theac-tivelearningmethodsalsoenhancetheupperboundofthemodel’sperformance,whichmayoriginatefromtheirrep-resentivechoiceofdata.Fig.5(g-i)showstheclassiﬁcationaccuraciesvaryingwithtrainingsetsize.ThephenomenaissimilarwiththeonesofVQC.Inthebestcase,trainingwithALstrategiesonlyrequire25%labelingeffortstomatchtheperformanceoftrainingwithoutAL.IV.CONCLUSIONWebuildafully-programmablephotonicquantumproces-sorwithhighgateﬁdelities,whichallowsﬂexibleexecutionofhybridquantum-classicalcomputingschemes.TheALstrate-giesarecodedasclassicalprogramsanddeployedtoourde-signedvariationalquantumclassiﬁersonthequantumproces-sor.Comparativeexperimentsdemonstrateaverypositiveef-7TABLEI.Thelabelingandcomputationalcostratios(AL/non-AL)inthetrainingofVQC/NEVQC.Thecolumns“minimum”and“mean”showtheminimumandaverageratiosineachrow.Themark×inthetablerepresentsthecasesthattheﬁnalclassiﬁcationaccuraciesofVQC/NEVQCwithQBCstrategyandthe10-data-itemtrainingsetcannotmatchtheﬁnalclassiﬁcationaccuraciesofVQC/NEVQCwithoutAL(butalreadyveryclose).TheresultsgenerallyshowasharpcutoflabelingeffortsandcomputationalcostbytheALstrategies.Ratios(%)Pattern1Pattern2Pattern3minimummeanUSAMPQBCUSAMPQBCUSAMPQBCVQClabeling50×305015251534computation77.9×29.6758.418.28.446.8NEVQClabeling35×252530302529computation38.9×20.417.62926.117.626.4fectofALinthepracticalapplicationofquantummachinelearning,asitsharplycuts66%labelingrequirementsand53%computationsonaverage,and85%labelingeffortsand91.6%computationsatmost.Besides,theimplementationofhighaccuracyoperations,programmability,andspeeduptechniquesduringthetrainingintheexperimentsmakepossibletheimplementationsofvar-iousquantummachinelearningalgorithmsinthefree-spaceopticalquantumsystem.Andtheexperiment-friendlyimple-mentationofnonlinearityinourexperimentalsodemonstratesthepathtowardsdesigningpowerfulandpracticalquantummachinelearningmodels.Byintroducingthelarge-scalein-terferometersimilartothestate-of-the-artphotonicquantumprocessor,JiuZhang[61,62],itispossibletoimmediatelyformlarge-scalequantummachinelearningapplications.ACKNOWLEDGMENTSH.-L.H.acknowledgessupportfromtheYouthTalentLift-ingProject(GrantNo.2020-JCJQ-QT-030),NationalNat-uralScienceFoundationofChina(GrantsNo.11905294),ChinaPostdoctoralScienceFoundation,andtheOpenRe-searchFundfromStateKeyLaboratoryofHighPerformanceComputingofChina(GrantNo.201901-01).[1]J.Biamonte,P.Wittek,N.Pancotti,P.Rebentrost,N.Wiebe,andS.Lloyd,Nature549,195(2017).[2]A.Kandala,A.Mezzacapo,K.Temme,M.Takita,M.Brink,J.M.Chow,andJ.M.Gambetta,Nature549,242(2017).[3]V.Havl´ıˇcek,A.D.C´orcoles,K.Temme,A.W.Harrow,A.Kan-dala,J.M.Chow,andJ.M.Gambetta,Nature567,209(2019).[4]M.SchuldandN.Killoran,Phys.Rev.Lett.122,040504(2019).[5]S.McArdle,S.Endo,A.Aspuru-Guzik,S.C.Benjamin,andX.Yuan,Rev.Mod.Phys.92,015003(2020).[6]G.A.Quantum,Collaborators*†,F.Arute,K.Arya,R.Bab-bush,D.Bacon,J.C.Bardin,R.Barends,S.Boixo,M.Broughton,B.B.Buckley,etal.,Science369,1084(2020).[7]H.-L.Huang,Y.Du,M.Gong,Y.Zhao,Y.Wu,C.Wang,S.Li,F.Liang,J.Lin,Y.Xu,etal.,Phys.Rev.Applied16,024051(2021).[8]J.Liu,K.H.Lim,K.L.Wood,W.Huang,C.Guo,andH.-L.Huang,Sci.ChinaPhys.Mech.64,290311(2021).[9]M.Gong,H.-L.Huang,S.Wang,C.Guo,S.Li,Y.Wu,Q.Zhu,Y.Zhao,S.Guo,H.Qian,etal.,arXiv:2201.05957https://doi.org/10.48550/arXiv.2201.05957(2022).[10]L.Zhou,S.-T.Wang,S.Choi,H.Pichler,andM.D.Lukin,Phys.Rev.X10,021067(2020).[11]A.Abbas,D.Sutter,C.Zoufal,A.Lucchi,A.Figalli,andS.Woerner,Nat.Comput.Sci.1,403(2021).[12]L.Gentini,A.Cuccoli,S.Pirandola,P.Verrucchi,andL.Banchi,Phys.Rev.A102,052414(2020).[13]L.BittelandM.Kliesch,Phys.Rev.Lett.127,120502(2021).[14]H.Zheng,Z.Li,J.Liu,S.Strelchuk,andR.Kondor,arXiv:2112.07611https://doi.org/10.48550/arXiv.2112.07611(2021).[15]J.Golden,A.B¨artschi,S.Eidenbenz,andD.O’Malley,arXiv:2202.00648https://doi.org/10.48550/arXiv.2202.00648(2022).[16]V.Saggio,B.E.Asenbeck,A.Hamann,T.Str¨omberg,P.Schi-ansky,V.Dunjko,N.Friis,N.C.Harris,M.Hochberg,D.En-glund,etal.,Nature591,229(2021).[17]H.-Y.Huang,M.Broughton,J.Cotler,S.Chen,J.Li,M.Mohseni,H.Neven,R.Babbush,R.Kueng,J.Preskill,etal.,Science376,1182(2022).[18]Y.Liu,S.Arunachalam,andK.Temme,Nat.Phys.17,1013(2021).[19]C.Yang,A.Garner,F.Liu,N.Tischler,J.Thompson,M.-H.Yung,M.Gu,andO.Dahlsten,arXiv:2105.14434https://doi.org/10.48550/arXiv.2105.14434(2021).[20]H.-Y.Huang,R.Kueng,andJ.Preskill,Phys.Rev.Lett.126,190505(2021).[21]H.-L.Huang,X.-L.Wang,P.P.Rohde,Y.-H.Luo,Y.-W.Zhao,C.Liu,L.Li,N.-L.Liu,C.-Y.Lu,andJ.-W.Pan,Optica5,193(2018).[22]C.Ding,Y.-F.Niu,W.-S.Bao,andH.-L.Huang,arXiv:2109.06805https://doi.org/10.48550/arXiv.2109.06805(2021).[23]H.-L.Huang,D.Wu,D.Fan,andX.Zhu,Sci.ChinaInf.Sci.63,1(2020).[24]M.Morisio,M.Torchiano,andA.Jedlitschka,Product-FocusedSoftwareProcessImprovement:21stInternationalConference,PROFES2020,Turin,Italy,November25–27,2020,Proceed-ings,Vol.12562(SpringerNature,2020).[25]Y.Xu,F.Wei,X.Sun,C.Yang,Y.Shen,B.Dai,B.Zhou,andS.Lin,inProceedingsoftheIEEE/CVFConferenceonCom-puterVisionandPatternRecognition(2022)pp.2959–2968.[26]S.Wang,Y.Liu,Y.Xu,C.Zhu,andM.Zeng,arXiv:2108.13487https://doi.org/10.48550/arXiv.2108.134878(2021).[27]J.Romero,J.P.Olson,andA.Aspuru-Guzik,QuantumSci.Technol.2,045001(2017).[28]D.BondarenkoandP.Feldmann,Phys.Rev.Lett.124,130502(2020).[29]I.A.Luchnikov,S.V.Vintskevich,D.A.Grigoriev,andS.N.Filippov,Phys.Rev.Lett.124,140502(2020).[30]S.Endo,J.Sun,Y.Li,S.C.Benjamin,andX.Yuan,Phys.Rev.Lett.125,010501(2020).[31]M.Schuld,A.Bocharov,K.M.Svore,andN.Wiebe,Phys.Rev.A101,032308(2020).[32]M.Cerezo,A.Arrasmith,R.Babbush,S.C.Benjamin,S.Endo,K.Fujii,J.R.McClean,K.Mitarai,X.Yuan,L.Cincio,etal.,Nat.Rev.Phys.3,625(2021).[33]J.BaldridgeandM.Osborne,inProceedingsofthe2004Con-ferenceonEmpiricalMethodsinNaturalLanguageProcessing(2004)pp.9–16.[34]B.Settleshttp://digital.library.wisc.edu/1793/60660(2009).[35]S.-J.Huang,R.Jin,andZ.-H.Zhou,IEEETPAMI36,1936(2014).[36]Y.Ding,J.D.Mart´ın-Guerrero,M.Sanz,R.Magdalena-Benedicto,X.Chen,andE.Solano,Phys.Rev.Lett.124,140504(2020).[37]A.Dutt,E.Pednault,C.W.Wu,S.Sheldon,J.Smolin,L.Bishop,andI.L.Chuang,arXiv:2112.14553https://doi.org/10.48550/arXiv.2112.14553(2021).[38]Y.Ding,J.D.Mart´ın-Guerrero,Y.Song,R.Magdalena-Benedicto,andX.Chen,Phys.Rev.Research4,013213(2022).[39]A.A.Melnikov,H.PoulsenNautrup,M.Krenn,V.Dunjko,M.Tiersch,A.Zeilinger,andH.J.Briegel,Proc.Natl.Acad.Sci.U.S.A.115,1221(2018).[40]B.Settles,M.Craven,andL.Friedland,inProceedingsoftheNIPSworkshoponcost-sensitivelearning,Vol.1(Vancouver,CA:,2008).[41]D.D.LewisandW.A.Gale,inSIGIR’94(Springer,1994)pp.3–12.[42]T.Scheffer,C.Decomain,andS.Wrobel,inProceedingsofthe4thInternationalConferenceonAdvancesinIntelligentDataAnalysis,IDA’01(Springer-Verlag,Berlin,Heidelberg,2001)p.309–318.[43]H.S.Seung,M.Opper,andH.Sompolinsky,inProceedingsoftheﬁfthannualworkshoponComputationallearningtheory(1992)pp.287–294.[44]B.Settles,M.Craven,andS.Ray,inAdvancesinNeuralInformationProcessingSystems,Vol.20,editedbyJ.Platt,D.Koller,Y.Singer,andS.Roweis(CurranAssociates,Inc.,2007).[45]N.RoyandA.McCallum,Int.Conf.onMach.Learn.https://dl.acm.org/doi/10.5555/645530.655646(2001).[46]C.A.Fuchs,UniversityofNewMexico,Albuquerquehttps://doi.org/10.48550/arXiv.quant-ph/9601020(1996).[47]M.Schuld,V.Bergholm,C.Gogolin,J.Izaac,andN.Killoran,Phys.Rev.A99(2019).[48]X.-L.Wang,L.-K.Chen,W.Li,H.-L.Huang,C.Liu,C.Chen,Y.-H.Luo,Z.-E.Su,D.Wu,Z.-D.Li,etal.,Phys.Rev.Lett.117,210502(2016).[49]D.P.KingmaandJ.Ba,arXiv:1412.6980https://doi.org/10.48550/arXiv.1412.6980(2014).[50]M.DrexlandM.Schneider,Eur.J.Oper.Res.241,283(2015).[51]V.V.CortesCorinna,Mach.Learn.20,273(1995).[52]S.S.KeerthiandC.-J.Lin,NeuralComput.15,1667(2003).[53]T.CoverandP.Hart,IEEETIT13,21(1967).[54]T.BaileyandJ.AK,IEEETrans.Syst.ManCybern.8,311(1978).[55]R.A.Fisher,Ann.Eugen.7,179(1936).[56]C.J.Huberty,Educ.Res.Rev.45,543(1975).[57]J.R.Quinlan,Mach.Learn.1,81(1986).[58]S.SafavianandD.Landgrebe,IEEETrans.Syst.ManCybern.21,660(1991).[59]S.Aaronson,Proc.R.Soc.A.461,3473(2005).[60]Z.Holmes,N.Coble,A.T.Sornborger,andY.Subas¸ı,arXiv:2112.12307https://doi.org/10.48550/arXiv.2112.12307(2021).[61]H.-S.Zhong,H.Wang,Y.-H.Deng,M.-C.Chen,L.-C.Peng,Y.-H.Luo,J.Qin,D.Wu,X.Ding,Y.Hu,etal.,Science370,1460(2020).[62]H.-S.Zhong,Y.-H.Deng,J.Qin,H.Wang,M.-C.Chen,L.-C.Peng,Y.-H.Luo,D.Wu,S.-Q.Gong,H.Su,etal.,Phys.Rev.Lett.127,180502(2021).Supplementaryinformationto”ActiveLearningonaProgrammablePhotonicQuantumProcessor”I.MEMBERSOFCOMMITTEEINQBCSELECTIONSTRATEGYTheQuery-by-Committee(QBC)isoneoftheselectionstrategiestoevaluatetheimportanceofdatainouractivelearningexperiments.TheQBCcommitteeconsistsoffourmembers.TheyareSVCwiththeRBFkernel,k-nearestneighborwithk=3,LinearDiscriminantAnalysisalgorithm(LDA),anddecisiontreewithmaxdepth7.SVC[S1,S2]isasupervisedbinaryclassiﬁcationmodel.Itlearnsaboundarythatleadstothemaxmarginfrombothclassesofdata.Ratherthanﬁttingallthetrainingdata,itfocusesonthepointsclosetotheboundary,whichnamedsupportvectors.Combinedwiththekernelfunction,SVCcanexpressaverycomplexclassiﬁcationboundarytoachievebetterclassiﬁcationperformance.Thekernelfunctionisaspecialnonlinearfunctionwhichmapsthelow-dimensionalfeaturespacetoahigherone.Sotheoriginallinearlyinseparableprobleminthelow-dimensionalspacetransformstothatlinearlyseparableinthehigh-dimensionalspace.TheRBFkernelisoneoftypicalkernelfunctionswhichwechoosetoenhanceourSVCmodel.KNN[S3,S4]isoneofthemostclassicandsimplestsupervisedmachinelearningmodels,whichcontainsnoexplicitlearningortrainingprocedures.KNNconcentratesontheknearsetdatapointstothetestdata.Ifmostnerighbordatapointsbelongtoacertainclass,thetestdataisalsodividedintothisclass.ThehyperparametersintheKNNalgorithmarethedistancemetricandthekvalue.WeusetheEuclideandistancemetricandsetthekvalueto3.LDA[S5,S6],alsocalledFisher’slineardiscriminant,isafundamentalsuperviseddimensionalityreductionmethod.ThekeyideaofLDAistomaximizethebetween-classvarianceandminimizethewithin-classvariance.Takebinaryclassiﬁcationasanexample,LDAﬁsrtprojectsthedatapointsinthefeaturespaceontoaline.Thenitlearnstooptimizethelinetomaketheprojectionsofdatapointsinthesameclassonthelineascloseaspossible.Meanwhile,forprojectionsofdatapointsindiﬀerentclasses,thedistancesaremaximized.Topredictthetestdata,wecalculatetheprojectionofthetestdatapointontheoptimizedline.Thentheestimatedlabelisjudgedaccordingtothepositionoftheprojection.Decisiontreealgorithm[S7,S8]isacommonsupervisedlearningalgorithm.Itdependsonadirecteddecisiontreetomakedecisionsonmulti-classiﬁcationtask.Duringthetrainingprocess,thedecisiontreeisbuiltaccordingtotheprincipleofminimizingthelossfunction.Adecisiontreeconsistsofnodesanddirectededges.Therearetwotypesofnodes:internalnode(recordsafeatureofdataset)andleafnode(denotesaclass).Eachdirectededgecorrespondstothecertainvalueofafeature.Whenpredictingatestdata,whichbranchtoenterisdeterminedaccordingtothejudgmentresultoftheinternalnode.Untilthetestdatareachestheleafnode,weobtaintheﬁnalclassiﬁcationresult.II.THECLASSIFICATIONPOWEROFVQCANDNEVQCInthissection,weproviderigorousderivationofthetheoreticalupperboundontheclassiﬁcationaccuracyofthetwoclassiﬁers.β1γ1γ2γ1γ2(a)(b)correct zoneerror zoneβ2β1β2FIG.S1.Theillustrationfortwoclassiﬁcationsituationsonanarc.Thegreendashedlinewithslopeangleγ1orγ2representstheclassiﬁcationlineatcurrentmodelparameters.Theorangesolidlinewithslopeangleβ1orβ2referstotheactualdividingmarginofacertainpattern.Therearetwogeneralclassiﬁcationsituationsappearinginthetrainingprocess.(a)Twoclassiﬁcationlinescrossthroughdatapointsinthesameclass.Inthissituation,dataitemsofatleastoneclassareexactlyclassiﬁed.(b)Twoclassiﬁcationlinescrossthroughdatapointsindiﬀerentclasses.Moreover,thebluearrowsindicatethecorrectlyclassiﬁedzoneandtheredarrowspointtotheerrorzone.arXiv:2208.02104v1  [quant-ph]  3 Aug 20222A.VariationalQuantumClassiﬁerTheimplementationofvariationalquantumclassiﬁer(VQC)containsonlyoneparameterizedsingle-qubitgateformedbytheHWP.ByevaluatingthesignofthemeasuredZexpectation,VQCactuallydeterminesthepredictedlabelthroughacomparisonbewteenprobabilityP0andP1,whereP0andP1representtheprobabilityof|0iand|1ieventsinthedetectors.Toobtaintheanalyticalformoftheprobability,weconsiderthetransformationwithintheclassiﬁer.|ψiVQCen=xi|0i+yi|1iHWP(θ)−−−−−→(xicos2θ+yisin2θ)|0i+(xisin2θ−yicos2θ)|1i,(S1)where|ψiVQCenreferstotheinputstateofVQCand(xi,yi)istheencodingdata.ForthecaseofhZi>0,wehave(xicos2θ+yisin2θ)2>(xisin2θ−yicos2θ)2.(S2)Withasimpledeformation,theinequalityisre-expressedas(xisin(2θ+π4)+yisin(2θ−π4))·(−xisin(2θ−π4)+yisin(2θ+π4))>0.(S3)Therefore,theclassiﬁcationfunctionofVQCisrealizedthroughthegeometricrelationshipofthetwoclassiﬁcationlinesy+k1x=0andy+k2x=0,wherek1=sin(2θ+π4)sin(2θ−π4)andk2=−sin(2θ−π4)sin(2θ+π4).When(y+k1x)·(y+k2x)≥0weassignthepredictedlabelto0,otherwise1.Itisobviousthatk1·k2=−1,indicatingthetwoclassiﬁcationlinesaremutualperpendicular.TheexpressibilityofVQCislimitedbythisverticalcharacteristicduetotheindependenceofthemodelparameter.Nowwewillprovethat,duetothepropertyofPattern1,VQCcantheoreticallyachievea100%maximumclassiﬁcationaccuracywithsuﬃcienttrainingdatasetandtrainingepoch.However,forPattern2andPattern3whosegeometricpropertyisnotatypeofverticalmargin,VQCcanonlyachieveamaxmimumclassiﬁcationaccuracymuchlowerthan100%.AsshowninFig.S1,theorangesolidlineswithslopeangleβ1andβ2representtheactualdividingmarginofacertainpattern.Andthegreendashedlineswithslopeangleγ1andγ2refertotheclassiﬁcationlinesatcurrentmodelparameters.Thebluearrowsindicatethecorrectlyclassiﬁedzoneandtheredarrowspointtotheerrorzone.Twosituationsmayariseduringthetrainingprocess.WeﬁrstconsiderageneralsituationgiveninFig.S1(a),wheretwoclassiﬁcationlinescrossthroughdatapointsinthesameclass.Inthissituation,dataitemsofatleastoneclassareexactlyclassiﬁed,andthemaxmimumclassiﬁcationaccuracyisacc=1−minγ1,γ2||β1−β2|−|γ1−γ2||π=1−minθ||β1−β2|−arctan|k1−k21+k1k2||π.(S4)FortheothersituationshowninFig.S1(b),wheretwoclassiﬁcationlinescrossthroughdatapointsindiﬀerentclasses,theclassiﬁercaneasilymovethesituationtothepreviouscasethroughadjustingthevalueofparametersingle-qubitgate(HWP(θ)),soEquation(S4)stillholds.AsforVQC,thereisaconstrainbetweenγ1andγ2duetotheperpendicularrelationshipoftwoclassiﬁcationlines,whichcanbeexpressedasγ1=γ2+π2.Therefore,theclassiﬁcationaccuracyacc=1−||β1−β2|−pi2|π,implyingthatthemaxmimumclassiﬁcationaccuracytotallydependsontheproportionofeachclassforacertainpattern.AsisshowninFig.2(a)inthemaintext,theslopeanglediﬀerence|β1−β2|oftheactualdividingmarginsforPattern1-3areπ/2,π/4andarctan(14)respectively.Thenwecaneasilydeduceamaxmimumaccuracyof100%forPattern1,75%forPattern2and57.79%forPattern3,whichisvalidatedintheexperimentsinthemaintext.B.Nonlinearity-EnhancedVariationalQuantumClassiﬁerThenonlinearity-enhancedvariationalquantumclassiﬁer(NEVQC)isrealizedbyintroducinganancillaqubit(preparedas|+istate),aPBSoperation,andpost-selectionontheancillaqubitafteraparameterizedsingle-qubitgate(HWP(θ2))appliedonit.WenotethattheimplementationofNEVQCdoesnotrequiretheinterferenceoftwophotonsonthePBS,i.e.twophotonsdonotrequirespace-timeencountersonthePBS.Inthiscase,afterpostselectingtheeventswherethereisexactlyonephotonexitingeachoutputofthePBS,thequantumstateis310.310.410.510.610.7position2505007501000coincidenceFIG.S2.TheperformanceofNEVQCandNEVQC∗withandwithoutALstrategiesduringthewholetrainingprocess.Eachlineshowsanaverageresultoverfourindependentexperimentsandthebandsshowthestandarddeviation.ThebluedashedlinesmarktheclassiﬁcationaccuracyofNEVQCandNEVQC∗(withoutAL)atconvergenceandthecorrespondingnumbersofevaluations.ThegreenandorangedashedlinesshowthetherequirednumbersofevaluationsofNEVQCandNEVQC∗(withUSAMPandQBC,respectively)thatachievethesameclassiﬁcationaccuracyasthatwithoutAL.InSubﬁg.(d),wealsoshowtheprocessofsearchingtheinterferencepointbymovingthepositionofprism(ThecorrespondingdevicesetupisshowninFig.2cinthemaintext.).(α|0i+β|1i)|+iPBS+postselection−−−−−−−−−−−−→nointerference1√2(|α|2|00ih00|+|β|2|11ih11|).(S5)whereα|0i+β|1iisthedataqubitafterapplyingtheﬁrstparameteredsingle-qubitgate(HWP(θ1)).WealsoimplementthesameexperimentsfortheNEVQCwithinterferenceoccuranceonthePBS,whichwenameasNEVQC∗.AsshowninFig.2(c)inthemaintext,weputatriangularprismonthepathofthedataqubit.Theelectriclineartranslationstagebelowitcanbeusedtoadjusttheopticalpathdiﬀerencebetweenthetwophotons.Wescanthepositionofthetriangularprismtochecktheindistinguishabilityoftheoutcomephoton.Whenthetriangularprismreachestheinterferencepoint,theoprationbecomes(α|0i+β|1i)|+iPBS+postselection−−−−−−−−−−−−→interference1√2(α|00i+β|11i).(S6)whichisdiﬀerentfromtheconditionthatnointerferenceishappenedonthePBS.Nowwewillshowthat,althoughthetransformationformulaisdistinct,westillendupwiththesameprobabilityexpressionof|0i(or|1i)eventsintheinputqubit.WetakedensitymatrixrepresentationforNEVQCtobetterdescribe4thetransformation.ρNEVQCen=|ψ0id|0ichψ0|dh0|cHWP(θ1)d−−−−−−−→Hc|ψ1id|+ichψ1|dh+|cPBS−−−→(xicos2θ1+yisin2θ1)2|00ih00|+(xisin2θ1−yicos2θ1)2|11ih11|HWP(θ2)c−−−−−−−−−−−−−−−→post-select|0iconancilla(cos2θ2(xicos2θ1+yisin2θ1))2|0idh0|d+(sin2θ2(xisin2θ1−yicos2θ1))2|1idh1|d,(S7)where|ψ0id=(xi|0id+yi|1idisthedataqubit,|0icistheancillaqubit,and|ψ1id=(xicos2θ1+yisin2θ1)|0id+(xisin2θ1−yicos2θ1)|1id.Similarly,wecandeducethetransformationinNEVQC∗as|ψiNEVQC∗en=|ψ0id|0icHWP(θ1)d−−−−−−−→Hc|ψ1id|+icPBS−−−→(xicos2θ1+yisin2θ1)|00i+(xisin2θ1−yicos2θ1)|11iHWP(θ2)c−−−−−−−−−−−−−−−→post-select|0iconancilla(cos2θ2(xicos2θ1+yisin2θ1))|0id+(sin2θ2(xisin2θ1−yicos2θ1))|1id.(S8)Therefore,theoutputprobabilityof|0iand|1iisexactlythesamefortheNEVQCandNEVQC∗,althoughtheﬁnalstatesofNEVQCandNEVQC∗aremixedstateandpurestate,respectively.Fig.S2showsthecomparisonofexperimentalresultsbetweenNEVQCandNEVQC∗.Weobservethatthetwoclassiﬁershavealmostidenticalperformanceforclassiﬁcationonthreepatterns,whichisconsistenttoourtheoreticalderivation.Inthenextpart,wewillpresentthemaximumclassiﬁcationaccuracyforNEVQCandNEVQC∗.SimilartotheanalysisofVQC,assuminghZi>0,wehave(cos2θ2(xicos2θ1+yisin2θ1))2>(sin2θ2(xisin2θ1−yicos2θ1))2.(S9)Then(xicos(2θ1−2θ2)+yisin(2θ1−2θ2))·(xicos(2θ1+2θ2)+yisin(2θ1+2θ2))>0.(S10)WenoticethattwoclassiﬁcationlinesofNEVQChaveslopesk1=cot(2θ1−2θ2)andk2=cot(2θ1+2θ2),withanincludedangle|γ1−γ2|=arctan(|k1−k21+k1k2|)=arctan(|tan(4θ2)|).(S11)UsingEquation(S4),wegetthemaximumclassiﬁcationaccuracyacc=1−minθ1,θ2||β1−β2|−arctan|k1−k21+k1k2||π=1−minθ2||β1−β2|−arctan|tan(4θ2)|π.(S12)Althoughθ1doesn’tcontributetothemaxmimumclassiﬁcationaccuracy,itensuresthattwoclassiﬁcationlinescanalwaystransfertotheﬁsrtclassiﬁcationsituationshowninFig.S1.Alongwiththetrainingprocess,NEVQCiterativelyadjuststheslopeanglesofclassiﬁcationlineswhileoptimizingtheirincludedangle.Hence,themodelexpressibilityofNEVQCiswellenhanced.AccordingtoEquation(S12),thereexistsatleastonesolutionθ2=|β1−β2|4toachieveamaximumclassiﬁcationaccuracy100%foranypattern.ThatimpliesNEVQCtheoreticallyoutperformsitssingle-qubitcounterpartVQC.III.CLASSICALSIMULATIONA.NumericalsimulationWeperformabundantnumericalsimulationstosupportourexperimentalsettings.Inouractivelearningexperi-ments,theclassiﬁeriterativelyselects10dataitemsfromanunlabeleddatapoolwithsize20.Afteranewlychosen5(a)(b)(c)(d)(e)(f)FIG.S3.comparisonamongdiﬀerenttrainingepochafteranewlychosendataitemadded.Theclassiﬁcationaccuracyplotsshowtheperformanceofclassiﬁerwithtrainingepoch10,20and30.Weiterativelyincreasethelabeledtrainingsetsizeupto20.Theverticalgreendashedlinereferstothepositionwhere10dataitemshavebeenaddedtothelabeledtrainingdatapool.dataitemisadded,theclassiﬁertrainsitselffor10epochswithitslabeledtrainingdataset.Asfortrainingprocesswithoutactivelearning,wejusttraintheclassiﬁerfor35trainingepochswith20labeledtrainingdataset.Therationalityandeﬃciencyoftheexperimentalsettingsaredemonstratedbynumericalsimulations.Foreachclassiﬁeranddatapattern,100independentnumericalexperimentsareimplementedtocalculatethemeanandstandarddeviationoftheresults.Fig.S3showsthecomparisonamongdiﬀerenttrainingepochafteranewlychosendataitemadded.Duringthetrainingprocess,weiterativelyincreasethelabeledtrainingsetsizeupto20.Wecanseethatfortrainingepoch10,20and30,theclassiﬁcationaccuracycurvereachestheﬁnalconvergencewithlittlediﬀerence.Thegreendashedlineindicatesthepositionwhere10dataitemshavebeenlabeledtotraintheclassiﬁer.Itisobviousthat10labeleddataitemsaresuﬃcientfortrainingtheclassiﬁerclosetoitsmaxmimumperformance.Therefore,consideringthebalancebetweenclassiﬁcationperformanceandtrainingtimeconsumption,weﬁnallysetthenumberofselecteddataitemsto10.Andforeachnewlyaddeditem,wetraintheclassiﬁerfor10trainingepochwithitscurrentlabeleddataset.B.ExperimentalperformancecomparedtonumericalsimulationWealsocompareourexperimentaloutcomestonumericalsimulations,toshowthehigh-precisionmanipulationofourexperiments.Forexperimentsandsimulations,wetakethesameinitialdatasetandparametervalues.InFig.S4,weshowthecomparisonresultofonesetofexperimentsfromNEVQConPattern3,withactivelearningandwithoutactivelearningrespectively.Wecanseethattheexperimentalresultsﬁttheirsimulateddatawell.Thediﬀerencebetweentheoreticalandexperimentalresultsappearstobesmall,whichcontainsbothexperimentalnoiseandstatisticalerror.Furthermore,inordertoquantifytheaverageperformanceofthewholeexperiments,wepresenttheaverageabsolutelossandaccuracyerrorofexperimentsbycomparingtotheirtheoreticalsimulationsinFig.S5andFig.S6.Wecomputetheaverageabsolutelossandaccuracyerrorusingthefollowingequation.Error=1LLXi=1|vexpri−vsimui|,(S13)wherevexpriandvsimuirepresentthevalueoflossorclassiﬁcationaccuracyofexperimentsandsimulations,andLreferstothetrainingdatasize(ortestdatasize)forlosserror(orclassiﬁcationaccuracyerror).Foractivelearning6FIG.S4.Detailedcomparisonforexperimentalandsimulatedresultsofonesetofexperiments.Thepicturesintheuppercolumnshowthedeclinecurvesofloss,andthoseinthelowerdemonstratetheclassiﬁcationaccuracyonthetestdataset.WechooseonesetofexperimentalandsimulatedresultsfromNEVQConPattern3,withandwithoutactivelearning,respectively.process,theabsoluteclassiﬁcationaccuracyerroriscalculatedeachtimeanewlychosendataitemisaddedtothelableddatapool.Asfortrainingwithoutactivelearning,wetestthemodelperformanceontestdataseteveryﬁvetrainingepoch.Fourindependentsetsofexperimentsareimplementedforthethreeclassiﬁers(VQC,NEVQCandNEVQC∗mentionedinthemaintext)toreporttheaveragevalueandthestandarddeviation.Ascanbeseen,thereisagoodagreementbetweentheexperimentalresultsandsimulations,bothforVQCandNEVQC.Furthermore,wenoticethatVQChasshownbetterexperimentalaccuracyandstability,withanupperbound0.01forclassiﬁcationaccuracyerrorand0.005forlosserror.ThisphenomenonisunderstandablebecauseVQCusesfewerqubitsandquantumoperationsthanNEVQC.IV.DEMONSTRATIONOFTHETRAININGPROCESSWITHALSTRATEGYTheactivelearningtrainingprocessofVQCandNEVQC(bothusingUSAMPstrategy)onPattern1andPattern2isgiveninFig.S7.Wechooseonesetofexperimentalresultstodemonstratetheactualtrainingprocess.Theclassiﬁeriterativelyaddsdataitemtothelabeleddatapoolandtrainsitself.WerecordthemodelparametersanddrawthetrainingdatasetandclassiﬁcationlinesinFig.S7.Wesettheinitialtrainingdatasetbyrandomlychoosetwodataitemswithdiﬀerentlabels.Theblueandreddotsrespectivelyrepresentthedatapointsinclass1andclass0,andtheorangetriangledenotesthenewlychosendataiteminthenextepoch.Wecanseethatasthetrainingdatasizeincreases,themodelclassiﬁcationlinesaretrainedtogetclosertotheactualdividingmargins,providingamoreintuitiveunderstandingofthemodelabilitymentionedinprevioussection.Fig.S7(a-b)showthattheclassiﬁcationlinesofVQCarealwaysmaintainingaverticalrelationshipwhileoptimization.ButfortheNEVQCgiveninFig.S7(c-d),theincludedangleoftwoclassiﬁcationlinesiscontinuouslyoptimizedastrainingdatasizeincreases.Theclassiﬁcationlinesareoptimizedtocrossthroughdatapointsinthesameclass,whichsupportsthederivationofEquation(S4).Moreover,duringtheactivelearningtrainingprocess,thenewlychosendataitemisalwaysclosetothemodelclassiﬁcationlineatcurrentmodelparameters,whichisongreatagreementwiththeleastconﬁdenceprincipleinUSAMP.7(a)(b)(c)(d)(e)(f)(g)(h)(i)FIG.S5.Theaverageabsoluteclassiﬁcationaccuracyerrorbewteenexperimentsandtheirsimulations.Foractivelearningprocess,theabsoluteclassiﬁcationaccuracyerroriscalculatedeverytimeanewlychosendataitemisaddedtothelableddatapool.Asfortrainingwithoutactivelearning,wetestthemodelperformanceontestdataseteveryﬁvetrainingepoch.V.PROBABILITYVANISHMENTINPOST-SELECTIONWhenthereareno|0ieventshappenedintheancillainNEVQC,wecallthissituationprobabilityvanishment.Probabilityvanishmentisaninstinctivephenomenonratherthananerroneousoccurance.AsforNEVQC,theprobabilityof|0ieventsintheancillaisP∗0=(cos2θ2(xicos2θ1+yisin2θ1))2+(sin2θ2(xisin2θ1−yicos2θ1))2,(S14)therealwaysexistssomesingularitysuchthattheprobabilityvalueP∗0turnstozero,e.g.whenθ2=0aswellasdirectionvectors(xi,yi)and(cos2θ1,sin2θ1)areorthogonal.Intheexperiments,sincetheZexpectationismeasuredusingﬁnitenumberofcoincidenceeventsamongDetector4-6hZi=N45−N46N45+N46−2N456,(S15)Whentheparameterpointnearstothosesingularities,theprobabilityP∗0becomessonegligiblethatwecannotobserveany|0ieventintheexperiment.Thedenominatorofthecalculationformulathenturnstozero.Thisexceptioncouldindeedinterruptourexperiments,becausewecannotavoidthevanishmentfromhappening,orextractinformationoftheexpectationthroughotherapproaches.Therefore,onceprobabilityvanishmentoccurs,weskipthepost-selectionandsethZ(xi,θ)itozero,theunbiasedestimationoftheexpectationassumingitsuniformdistributionintheinterval[−1,1].Duringourexperiments,weobservethatprobabilityvanishmentisaratheroccasionalphenomenonandtheexperimentalresultsareingood8(a)(b)(c)(d)(e)(f)(g)(h)(i)FIG.S6.Theaverageabsolutelosserrorbewteenfoursetsofexperimentsandtheirsimulations.Thewaytocollectanddisplaythecomparisonresultsissimilartothatofclassiﬁcationaccuracyerror.agreementwithournumericalsimulations,asisshowninFig.S5andFig.S6.[S1]V.V.CortesCorinna,Mach.Learn.20,273(1995).[S2]S.S.KeerthiandC.-J.Lin,NeuralComput.15,1667(2003).[S3]T.CoverandP.Hart,IEEETIT13,21(1967).[S4]T.BaileyandJ.AK,IEEETrans.Syst.ManCybern.8,311(1978).[S5]R.A.Fisher,Ann.Eugen.7,179(1936).[S6]C.J.Huberty,Educ.Res.Rev.45,543(1975).[S7]J.R.Quinlan,Mach.Learn.1,81(1986).[S8]S.SafavianandD.Landgrebe,IEEETrans.Syst.ManCybern.21,660(1991).9(a)(b)VQC, Pattern 1VQC, Pattern 2NEVQC, Pattern 1(c)(d)NEVQC, Pattern 2FIG.S7.Theactivelearningtrainingprocessof(a-b)VQCand(c-d)NEVQCusingUSAMPstrategy.Wechooseonesetofexperimentalresultstodemonstratethetrainingprocess.Theclassiﬁeriterativelyaddsdataitemtothelabeleddatapoolandtrainsitself.Werecordthemodelparametersanddrawthecurrenttrainingdatasetandclassiﬁcationlinesinthepictures.Theredandbluecirclesrespectivelyrefertothedataitemsofclass1andclass0inthelabeleddatapool,andthenewlychosendataiteminthenextroundisrepresentedbyanorangetriangle.