9
1
0
2
c
e
D
3

]

R
P
.
h
t
a
m

[

2
v
6
3
9
0
1
.
1
1
9
1
:
v
i
X
r
a

FINITE-TIME 4-EXPERT PREDICTION PROBLEM

ERHAN BAYRAKTAR, IBRAHIM EKREN, AND XIN ZHANG

Abstract. We explicitly solve the nonlinear PDE that is the continuous limit of dynamic pro-
gramming equation expert prediction problem in ﬁnite horizon setting with N = 4 experts. The
expert prediction problem is formulated as a zero sum game between a player and an adversary. By
showing that the solution is C2, we are able to show that the comb strategies, as conjectured in [13],
form an asymptotic Nash equilibrium. We also prove the “Finite vs Geometric regret” conjecture
proposed in [12] for N = 4, and show that this conjecture in fact follows from the conjecture that
the comb strategies are optimal.

Contents

1.

Introduction

2. Preliminaries

3. Main Results

3.1. Solution to PDE (1.1) with N = 4

3.2. An asymptotical Nash equilibrium for the game (2.2) with N = 4

3.3. Relation between the ﬁnite and geometric stopping

4. Proofs

4.1. Proof of Theorem 3.1

4.2. Proof of Theorem 3.2

4.3. Proof of Theorem 3.3

4.4. Proof of Proposition 3.1

Appendix A. Solutions from Inverse Laplace Transform

A.1. A heuristic derivation for N = 4

A.2. Explicit expressions for N = 3

References

2

4

6

6

7

9

10

10

25

33

39

40

40

43

44

Date: December 4, 2019.
2010 Mathematics Subject Classiﬁcation. 68T05, 35K55, 35K65, 35Q91.
Key words and phrases. machine learning, expert advice framework, asymptotic expansion, inverse Laplace trans-

form, regret minimization, Jacobi-theta function.

1

 
 
 
 
 
 
2

ERHAN BAYRAKTAR, IBRAHIM EKREN, AND XIN ZHANG

1. Introduction

In this paper, we explicitly solve the degenerate nonlinear PDE with N = 4

∂tuT (t, x) +

1
2

sup
P (N )

e⊤J ∂2

xxuT (t, x)eJ = 0,

J
∈
uT (T, x) = Φ(x) := max

i

xi,

(1.1)

1, . . . , N
{

representing the
and eJ :=
where P (N ) is the power set of
standard basis of RN . Kohn and Drenska [10, 11] showed that this equation has a unique viscosity
solution, which is the continuous limit of dynamic programming equation of the Expert Prediction
Problem with ﬁnite stopping. The Expert Prediction Problem is a zero sum game between a player
and an adversary (see e.g. [13]). Here we construct this unique viscosity solution explicitly

J ej with
∈

ej }j
{

P

∈{

,N

}

···

1,

}

j

uT (t, x) = −

1
16√2

∞

e−

Z

−∞

t)r2

(T

−
r2

4

xo +

·

ψ

rθ

(cid:16)

π
2

ψ (rθ

−

xo)

·

sin (rαk ·

xo)

dr +

!

Xk=1

4

Xk=1
4

Xi=1

(cid:17)
1
4

cos (rαk ·

xo)

4

−

xi +

(T

1
2 r

−
2

t)π

,

(1.2)

(1, 1,

where ψ is the 2π periodic square wave function, xo is obtained from rearranging the coordinates
of x in the increasing order, and αk, θ
, θ =
1
2, and due to this regularity, we are able to show that the
√2
balanced comb strategy and the probability matching algorithm proposed in [13] are the asymptotic
saddle points for the game. As noted in [10], in particular for x = 0, t = 0, T = 1, the value u1(0, 0)
provides the expansion of the best regret as

R4 are deﬁned by αk,j = 3
√2

1). We show that uT

1
√2

1
{

1
{

∈ C

} −

k=j

−

−

1,

=j

∈

k

}

V M (0, 0) = u1(0, 0)√M + o(√M ) as M

,

→ ∞

where V M is the value function of expert prediction problem with time maturity M . According to
π
our solution (1.2), we obtain the explicit value of the ﬁrst order coeﬃcient u1(0, 0) = 1
2 , which
2
resolves the open problem in [12] for N = 4; see also [1].

p

Prediction problem with expert advice is classical and fundamental in the ﬁeld of machine learn-
ing, and has been studied for decades. We refer the reader to [6] for a nice survey. It is a dynamic
zero-sum game between a player and an adversary. At each of the M rounds, based on all the prior
information, the player chooses one of the N experts to follow, and simultaneously the adversary
chooses a set of winning experts. The increment of the gain for each expert is either 0 or 1 depend-
ing on whether the expert is chosen by the adversary, and the increment of the gain of the player
is that of the expert the player follows. Given a ﬁxed maturity M , the objective of the player is to
GM , while the adversary wants to maximize the regret, where Gi
minimize the regret max
M
and GM are the gain of the expert i and the player, respectively.

M −

Gi

i

For the case of 2 experts, Cover [8] showed that the asymptotically optimal strategy for the
adversary is the one that chooses an expert uniformly at random. For the case of 3 experts with
geometric stopping, Gravin, Peres and Sivan [13] showed that the comb strategy, which chooses

 
6
FINITE-TIME 4-EXPERT PREDICTION PROBLEM

3

the experts with the highest gain and the one with the lowest gain with probability 1
2 , and chooses
the second leading expert with probability 1
2 is asymptotically optimal for the adversary. They
also showed that the probability matching algorithm, which consists of following an expert with
the probability that under the comb strategy that that expert will be the leading one at the end
of game, is the player’s asymptotically optimal response. For the case of N = 3 experts with ﬁnite
stopping, it has been shown in [1] that the comb strategy is asymptotically optimal. While both
[1, 13] use the theory of random walk, [11] exploits the power of the PDE method. By considering
a scaled game, they have shown that the value function of discrete games converges to the viscosity
solution of a PDE. Following this setting, for the case of N = 4 experts in the geometric horizon
setting, Bayraktar, Ekren and Zhang [4] showed that the comb strategy is asymptotically optimal
by explicitly solving the corresponding nonlinear PDE. And very recently in [14], Kobzar, Kohn
and Wang found lower and upper bounds for the optimal regret for ﬁnite stopping problem by
constructing certain sub- and supersolutions of (1.1) following the method of [16]. Their results
are only tight for N = 3 and improved those of [1]. Let us also mention the Multiplicative Weights
Algorithm, which is asymptotically optimal as both N, M

(see [5]).

→ ∞

In this paper we construct an explicit solution to (1.1) for N = 4 with ﬁnite stopping. We
build our candidate solution based on the conjecture of [13], which states that the comb strategy
is asymptotically optimal for any number of experts in both ﬁnite and geometric horizon problem.
Note that if the comb strategy is asymptotically optimal, the solution to (1.1) should also satisfy
a linear PDE with comb strategy based coeﬃcients (see (3.2)), which is shown to be true in the
geometric horizon setting in [4]. The key observation is that the PDE of the ﬁnite horizon case
can, at least heuristically, be obtained by applying the inverse Laplace transform to the solution of
[4] extended to the complex plane. This is at a heuristic level because these linear PDEs, unlike
(1.1), may not have unique solution and the analytic extension of our function to the complex
plane is not well-behaved. In Appendix A, we perform this formal inverse Laplace transform and
obtain the explicit expression in (1.2). We show in Theorem 3.1 that (1.2) is the classical solution
of (3.2). In Theorem 3.2, we show that it also satisﬁes (1.1) by verifying that the comb strategy is
optimal for the limiting problem. In Theorem 3.3, we show that the probability matching strategy
for the player and the comb strategy for the adversary form an asymptotic saddle point, resolving
the conjecture of [13] for four experts. As a corollary, we resolve the Finite versus Geometric regret
conjecture in [12] (see also [1]); see Corollary 3.1. Our work reveals that the ratio of the value of
two problems (which was conjectured to be 2
√π ) actually comes from the inverse Laplace transform;
see (3.12). We also apply our method to obtain an explicit expression for uT in the 3 experts case,
which was not known.

We now detail some of the diﬃculties in our proofs. The ﬁrst main diﬃculty is showing that the
boundary condition uT (T, x) = Φ(x) is satisﬁed. We ﬁrst write the function uT in terms of sine
and cosine integral functions (see [2]) and perform some intricate and long arguments from complex
analysis relying on the properties of these functions. Second main diﬃculty is showing that the
function uT actually solves the nonlinear PDE. We perform this analysis through a veriﬁcation type
of argument, in which we show that certain inequalities are satisﬁed for all (t, x) and hence ruling

4

ERHAN BAYRAKTAR, IBRAHIM EKREN, AND XIN ZHANG

out all the other alternative strategies for the adversary. This analysis is the most demanding part
of the paper in which we rely on the properties of the Jacobi-theta function (see [15]) and other
properties of Fourier series. The third main diﬃculty is showing that the probability matching
algorithm for the player and the comb strategy for the adversary form an asymptotic saddle point.
Relying on some delicate estimates, we show that the value function of discrete game converges
to uT if either the player adopts the probability matching algorithm, or the adversary adopts the
comb strategy.

The rest of the paper is organized as follows. In Section 2, we introduce the problem and provide
some of lemmata. In Section 3, we state the three main results of our paper, namely Theorem 3.1,
3.2 and 3.3. Here we also state the Corollary 3.1 which resolves the “geometric versus ﬁnite horizon
conjecture” for 4 experts. In Section 4, we provide all the proofs, and in Appendix A, we provide
a heuristic derivation of the value functions for N = 3, 4 via inverse Laplace transform.

In the rest of this section, we will provide some frequently used notation.

Notation. Denote the left hand side and the right hand side derivatives by ∂−, ∂+ respectively.
Denote the number of experts by N , the time horizon of the discrete game by M , and the time
horizon of the continuous time control problem by T (so M in our paper represents the T in [1, 13]).
and by V the set of probability measures
Denote by U the set of probability measures on
the canonical basis of RN , and
on P (N ), the power set of
RN , we denote by xi the i-th coordinate
for J
∈
x(i)
of x, by
i1, . . . , iN }
≤
{
{
xiN with the convention that if two
the reordering of
components xi and xj are equal and i < j then the ordering is deﬁned to be xi ≤
xj. We deﬁne
xo :=

}i=1,...,N the ranked coordinates of x with x(1)
P
such that xi1 ≤
≤

. We denote by
1, . . . N
}
{
P (N ), eJ is deﬁned as eJ :=

}
ei}i=
{
J ej. For all x
∈
∈

1, . . . , N
{

1, . . . , N
{

x(1), . . . , x(N )

xi2 ≤

x(N ), by

x(2)

1,...,N

. . .

. . .

≤

≤

}

}

{

.

j

(cid:0)

(cid:1)

2. Preliminaries

We assume that a player and an adversary are playing a zero-sum game, and they interact
N, by
Gi
through the evolution of the gains of N experts. At step m
1, we denote the
k}k=1,... ,m
{
−
history of the gains of each expert i = 1, . . . N , and by
1, the history of the gains of
Gk}k=1,... ,m
{
(Gi
,
1
the player. After observing all the prior history
1 :=
}
≤
{
simultaneously, the adversary chooses some experts Jm ∈
P (N ), and the player chooses the expert
to follow. For each i = 1, . . . , N , the gain of expert i increases by 1 if he is chosen
Im ∈ {
by the adversary, otherwise remains the same. The increment of the player’s gain follows that of
the expert Im he chooses. Therefore we have

k, Gk) : 1

1, . . . , N

Gm
−

N, 1

m

≤

≤

≤

−

∈

k

}

−

i

Gi

m = Gi
m
Gm = Gm

−

−

1 + 1
i
{
1 + 1
Im
{

∈

Jm

∈

.

}

Jm

,

}

i = 1, . . . , N ;

In order to have a value for the game, we allow both the adversary and the player to adopt
V to draw

N, the adversary decides on the distribution βm ∈

randomized strategies. At step m

∈

FINITE-TIME 4-EXPERT PREDICTION PROBLEM

5

Jm from, and independently the player decides on the distribution αm ∈
of

is given by

N

i

m, Gm : 1

(Gi
{

U of Im. Then the dynamic

≤
}
≤
Eαm,βm[Gi

m|Gm
−

1] = Gi
m

−

1 +

P (N )

XJ
∈
N

βm(J)1
i
{

J

∈

}

,

i = 1, . . . , N ;

Eαm,βm[Gm|Gm

−

1] = Gm

−

1 +

αm(i)βm(J)1

.

i
{

J

∈

}

Xi=1 XJ
∈

P (N )

Denote by

the collection of sequences

U
collection of such sequences

M. We take

αm}m
{

N such that αm is a function of
∈

βm}m
{
Xm := (X 1

∈

m, . . . , X N

m ) := (G1

Gm, . . . , GN

m −

Gm),

m −

1, by

Gm
−

V

the

(2.1)

the diﬀerence between the gain of the player and the experts. Deﬁne the function

and the regret of the player at step m

∈

Φ : x

7→
N,

xi = x(N ),

max
N
i
1
≤
≤

Φ(Xm) = max
i=1,...,N

Gi

m −

Gm.

The objective of the player is to minimize his expected regret at maturity M while the objective
of the adversary is to maximize the regret of the player. By the Minimax theorem, the game has
a solution (see [10, 13]), i.e.,

sup
β

∈V

inf
α
∈U

Eα,β [Φ(XM )
X0 = x] = inf
|
∈U

α

sup
β

∈V

Eα,β [Φ(XM )
X0 = x] ,
|

(2.2)

where Eα,β is the probability distribution under which we evaluate the regret given the controls
α =

. Therefore we can deﬁne the value function

αm}
{

and β =

βm}
{
V M (m, x) := sup
∈V

β

inf
α
∈U
which satisﬁes the following dynamical programming principle

Eα,β [Φ(XM )
Xm = x] = inf
|
∈U

α

sup
β

∈V

Eα,β [Φ(XM )
Xm = x] ,
|

V M (m, x) = inf
U
∈

α

sup
V
β

∈

βJ

V M (m + 1, x + eJ )

XJ

(cid:0)

Additionally, it was shown in [10] that for any sequence mM ∈
mM T
M →
→ ∞

√T
√M →

, we have that

x as M

t and

xmM

α(J)

.

−

(cid:1)
N and xmM ∈

R4 such that

V M (mM , xmM )√T
√M

→

lim
M
→∞

uT (t, x),

where uT (t, x) is the unique viscosity solution to (1.1). Also, we have the Feynmann Kac represen-
tation of uT (t, x)

uT (t, x) = sup
σ

E [Φ(X σ
Xt = x] ,
T )
|

(2.3)

6

ERHAN BAYRAKTAR, IBRAHIM EKREN, AND XIN ZHANG

where X σ is deﬁned by Xu = Xt +
progressively measurable process (σs) satisfying for all s

R

u
t σsdWs with W a 1-dimensional Brownian motion and the

[t, u], σs ∈ {

eJ : J

.
P (N )
}

∈

∈

3. Main Results

3.1. Solution to PDE (1.1) with N = 4. Deﬁne αk, θ
θ = 1
√2

1). Denote the 2π periodic square wave function by

(1, 1,

1,

∈

R4 by αk,j = 3
√2

−

−

1
{

k=j

} −

1
√2

1
{

k

=j

}

and

ψ(r) := sign

tan

(cid:16)

(cid:16)

r
2

(cid:17)(cid:17)

= sign (sin (r)) .

Deﬁne the auxiliary function

Λ(r, x) :=

ψ

rθ

(cid:17)
and our conjectured solution to (1.1)

(cid:16)

x +

·

π
2

4

Xk=1

cos (rαk ·

x)

−

4

−

ψ (rθ

x)

·

4

Xk=1

sin (rαk ·

x)

,

!

uT (t, x) := −

1
16√2

∞

e−

Z

−∞

t)r2

(T

−
r2

Λ(r, xo)dr +

1
4

4

xi +

Xi=1

(T

1
2 r

−
2

t)π

.

(3.1)

Remark 3.1. Due to the presence of r−

2, there is a possible integrability issue of

However as a result of the fact that

Z

−∞
4

k=1 αk ·

xo = 0, we have the Taylor expansion around 0

∞

e−

t)r2

(T

−
r2

Λ(r, xo)dr.

Λ(r, xo) =

Thus, uT (t, x) is well-deﬁned.

P
αk ·
r
|
|

xo

−

4

Xk=1

4

Xk=1

xo)2

(rαk ·
2

+ o(r2) = O(r2).

Remark 3.2. Since the function Λ(r, x) is even with respect to r, we sometimes use the expression

uT (t, x) = −

t)r2

1
8√2

(T

e−

∞

−
r2
0
Z
R4 with xi1 ≤

Λ(r, xo)dr +

1
4

4

Xi=1

xi +

(T

1
2 r

−
2

t)π

.

Deﬁnition 3.1. For all x
P (4) the comb
xi3 ≤
∈
strategy which chooses the experts i4 and i2. Denote σ
(Xs) to be the corresponding
control of problem (2.3). We take the convention that if two components xi and xj of the points
are equal for i < j then the ordering of the point is taken with xi ≤

xi4, we denote by
(Xs) := e

xi2 ≤

xj.

(x)

JC

∈

JC

C

The following theorem assembles properties of uT , and its proof is provided in Section 4.1.

Theorem 3.1. The function uT is symmetric in x, satisﬁes uT
and

([0, T ]

R4)

×

∩ C

2([0, T )

R4)

×

∈ C

∂tuT (t, x) +

1
2

e⊤
JC

(x)∂2

xxuT (t, x)e

JC

(x) = 0,

u(T, x) = max
i=1,...,4

xi.

(3.2)

6
 
FINITE-TIME 4-EXPERT PREDICTION PROBLEM

7

The ﬁrst derivative of uT on θ

xo < 0 is

·

∂xiuT (t, x) =

1
16√2

∞

e−

Z

−∞

(T

−
r

+ψ (rθ

·

and if θ

·

xo = 0, it is

t)r2

4

αk,i

ψ

rθ

xo) cos (rαk ·

(cid:16)

Xk=1
x)) dr +

(cid:16)
1
4

,

xo +

·

π
2

(cid:17)

sin (rαk ·

x)

∂xiuT (t, x) =

1
4

.

xo < 0, and x(2) < x(3), we have

If θ

·

∂2
xixj uT (t, x) =

αk,iαk,j

ψ

rθ

(cid:16)

(cid:16)

xo +

·

π
2

(cid:17)

cos (rαk ·

x)

(T

−

t)(π(l+1/2))2
xo)2
(θ

·

4

xo

θ

·
(T

t)(πl)2
xo)2

−
(θ
·

2αk,i sin

αk ·

xπ(l + 1/2)
xo
θ

·

(cid:19)

(cid:18)

Xk=1

4

Xk=1

2αk,i cos

xπl
xo

αk ·
θ
·

,

(cid:19)

(cid:18)

1
16√2

−∞

Z
ψ (rθ

−

+

−

∂xj (θ

·
16√2

∂xj (θ

xo)

·
16√2

4

∞

(T

e−

−

t)r2

·

xo) sin (rαk ·
xo)

Xk=1

x)) dr

1)le−

(
−

Z
Xl
∈

Z
Xl
∈

(
−

1)le−
θ

·

∞

(T

e−

−

t)r2

xo

4

Xk=1

1
16√2

−∞

Z
ψ (rθ

−

xo) sin (rαk ·

·

x)) dr,

αk,iαk,j

ψ

rθ

(cid:16)

(cid:16)

xo +

·

π
2

(cid:17)

cos (rαk ·

x)

xo < 0 and x(2) = x(3),

if θ

·

xixj uT (t, x) =
∂2

and if θ

xo = 0,

·

xixj uT (t, x) =
∂2

1
16√2

∞

(T

e−

−

t)r2

Z

−∞

4

Xk=1

αk,iαk,jdr.

The proof of the following theorem is in Section 4.2.

(3.3)

(3.4)

(3.5)

(3.6)

(3.7)

Theorem 3.2. The function uT deﬁned in (3.1) is also a solution to (1.1) and the comb strategy
e
JC

is optimal for the problem (1.1).

3.2. An asymptotical Nash equilibrium for the game (2.2) with N = 4. Given the value
of uT , we now describe a family of asymptotically optimal strategies for both the player and the
adversary. Inspired by [13] we give the following deﬁnition.

Deﬁnition 3.2. (i)For M
R4 and round m
state x
∈
with probability 1
2 .

∈

N, we denote by
∈
N, chooses experts

b

J
C
JC

(M )
(x)

, the balanced comb strategy, which at
P (4)

∈ V
P (4) with probability 1

(x)

c

2 and

J

C

∈

∈

8

ERHAN BAYRAKTAR, IBRAHIM EKREN, AND XIN ZHANG

(ii)For M

N, we denote by α∗(M )

chooses the expert i with probability ∂xiuT

∈

, the strategy that, at state x
M , x√T
mT
for all i = 1, . . . , 4.
√M

∈

R4 and round m

N,

∈

Remark 3.3. Note that Deﬁnition 3.1 deﬁnes a control for the problem (2.3) while Deﬁnition 3.2
deﬁnes controls for the game (2.2). Hence the latter depends on M, T and x, and the control α∗(M )
actually reﬂects the scaling between the two problems (see [11] for details).

∈ U

(cid:16)

(cid:17)

Remark 3.4. According to the Feynmann Kac representation (2.3) and Theorem 3.1, we have

uT (t, x) = E

Φ

x +

(cid:20)

(cid:18)

t

Z

T

σ

C

(Xs)dWs

.

(cid:19)(cid:21)

Then heuristically

∂xiuT (t, x) = E

∂xiΦ

x +

(Xs)dWs

= P

(X σ

CT )i = (X σ

CT )(4)

(cid:18)
which is just the probability matching algorithm proposed in [13].

(cid:19)(cid:21)

Z

(cid:20)

h

T

σ

C

t

Xt = x
|

,

i

Deﬁnition 3.3. Deﬁne the following two value functions

and their limits

V M (m, .) : x

M

V

(m, .) : x

7→

7→

inf
α
∈U
sup
β

∈V

Eα,

b

J

C

(M ) [Φ(XM )
Xm = x] ,
|

Eα∗(M ),β [Φ(XM )
Xm = x] ,
|

uT (t, x) :=

(M,

mM T
N ,

lim inf
√T
xmM
√M

)
→

(
∞

,t,x)

V M (mM , xmM ) √T
√M

uT (t, x) :=

(M,

mM T
M ,

lim sup
√T
xmM
√M

)
→

,t,x)

(
∞

M

V

(mM , xmM )√T

√M

,

.

The proof the following theorem can be found in Section 4.3.

Theorem 3.3. The family of strategies (α∗(M ))M
∈
saddle points for the player and the adversary, in the sense that for all (t, x)

(M ))M

∈ U

J

N

∈

C

N

N and (

b

N are asymptotic
R4

∈ V
∈

[0, T ]

×

uT (t, x) = uT (t, x) = uT (t, x).

It can be easily seen that uT (t, x)

uT (t, x), and our main result states that they
≤
are actually equal, which implies that at the leading order it is optimal for both the player and the
adversary to choose respectively the controls α∗(M ) and
and
T > 0, we have that

(M ), i.e., for any αM ∈ U

, βM ∈ V

uT (t, x)

≤

J

C

b

lim inf
M

→∞ r

T
M  

EαM ,

b

J

C

(M )

Φ(XM )

"

lim sup
M

→∞ r

T
M  

Eα∗(M ),βM

Φ(XM )

"

X0 =
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

X0 =
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

√M x
√T # −

Eα∗(M ),

(M )

b

J

C

Φ(XM )

"

√M x
√T # −

Eα∗(M ),

(M )

b

J

C

Φ(XM )

"

√M x
√T #! ≥

0,

√M x
√T #! ≤

0.

X0 =
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

X0 =
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

FINITE-TIME 4-EXPERT PREDICTION PROBLEM

9

3.3. Relation between the ﬁnite and geometric stopping. We recall the following results
from [4] and [11]. Let T δ be a geometric random variable with parameter δ > 0. Deﬁne

V δ(X0) := sup
∈V

β

inf
α
∈U

Eα,β [Φ(XT δ )] = inf
∈U

α

sup
β

∈V

Eα,β [Φ(XT δ )] ,

and

uδ : x

RN

V δ

7→

∈

x
√δ (cid:19)

(cid:18)

√δ.

so that as δ
viscosity solution of the equation

↓

0, the function uδ converges locally uniformly to u : RN

u(x)

1
2

−

sup
P (N )

∈

J

e⊤J ∂2u(x)eJ = Φ(x).

R which is the unique

7→

(3.8)

The main conjecture in [13] regarding the relation between the ﬁnite and geometric horizon

control problems is that

V M (0, 0)

2
√π

1
M (0).

V

∼M
+
→

∞

The corollary below shows that this statement is true for N = 3, 4.

Corollary 3.1. For N = 3, 4, we have the limit

V M (0, 0)

1
M (0)

V

=

2
√π

.

lim
M
→∞

Proof. According to Theorem 3.2 and Proposition A.1, (3.1) and (A.8) are solutions to (1.1) with
N = 4 and N = 3, respectively. As a result of [4, Proposition 6.1] and [11, Theorem 8], (A.3) and
(A.7) are the solutions to (3.8) with N = 4 and N = 3, respectively. Plugging in T = 1, t = 0, x = 0
into these equations, we obtain that for N = 4, u1(0, 0) = 1
, and for N = 3,
2
u1(0, 0) = 4

2 , u(0) = π
4√2

. Due to the equalities

π

p

3√2π

, u(0) = 4
6√2
1
√M

lim
M
→∞
we conclude that for both N = 3 and N = 4,

V M (0, 0) = u1(0, 0),

1
√M

lim
M
→∞

1
M (0) = u(0),

V

V M (0, 0)

1
M (0)

V

=

u1(0, 0)
u(0)

=

2
√π

.

lim
M
→∞

(cid:3)

3.3.1. From “optimality of the comb strategy conjecture” to “Finite vs Geometric regret conjecture”.
Let us start by recalling that for any T > 0 and (t, x)

RN the equation

[0, T ]

∈

×

X t,x

u = x +

u

σ

C

t

Z

(X t,x

s )dWs,

for u

∈

[t, T ],

(3.9)

has a unique weak solution (see [3, Theorem 2.1]).

10

ERHAN BAYRAKTAR, IBRAHIM EKREN, AND XIN ZHANG

Proposition 3.1. Let N
the weak solution of (3.9) is an optimizer of (2.3) and uT is C 0([0, T ]
and satisﬁes for some ε > 0 and for all x

2 and assume that the comb strategies are optimal in the sense that
RN )

C 1,2([0, T )

RN )

RN

×

≥

×

∩

∈

∞

T

e−

0
Z

x

|

sup
y

−

|≤

xxuT (0, y)
∂2
dT <
|

ε |

.

∞

(3.10)

Then, the comb strategy is optimal for the problem (3.8) and the function u deﬁned at (3.8) satisﬁes

u(x) = E

0

(cid:20)Z

∞

e−

T Φ(X 0,x

T )dT

=

∞

e−

T uT (0, x)dT.

(3.11)

(cid:21)

0

Z

Remark 3.5. Given the results in Proposition 3.1, a simple change of variable formula allows us
to claim that the function

solves the equation

and satisﬁes

uλ(x) = λ−

3/2u(√λx)

λuλ(x)

1
2

−

sup
P (N )

∈

J

e⊤J ∂2uλ(x)eJ = Φ(x)

uλ(x) = E

∞

e−

λT Φ(X 0,x

T )dT

=

∞

e−

λT uT (0, x)dT

0

(cid:21)

Z

0

(cid:20)Z

Therefore, a corollary of (3.11) is the following relationship due to the Inverse Laplace transform
from uλ(x) to uT (0, x),

u1(0, 0) =

u(0)
2πi

1+i

∞

i

1

−

Z

∞

eλλ−

3/2dλ =

Γ

1
2

−
(cid:1)π
(cid:0)

−

u(0) =

2
√π

u(0),

(3.12)

where Γ is the gamma function. Thus, under the assumption of the optimality of the comb strategies
for the ﬁnite time problem and some technical assumption the Proposition 3.1 yields the constant
in the “Finite versus Geometric” conjecture of [12] for all N ; see also [1]. According to (3.5), we
have

xixj uT (0, x)
∂2
|

| ≤

C 
Z

∞

T r2

e−

−∞

dr +




·

4(θ

e −
θ

T (πl)2
xo)2
xo 
Z
Xl
∈


T and integrating from 0 to

,

·

where C is a positive constant. Multiplying both sides by e−
, we can
easily check (3.10) for our expression (3.1). As a result, Proposition 3.1 in fact implies Theorems
3.1 and 3.2 of [4].

∞

4. Proofs

4.1. Proof of Theorem 3.1.

4.1.1. Continuity of x

uT (t, x).

7→

FINITE-TIME 4-EXPERT PREDICTION PROBLEM

11

Proof. Using (3.1) and the continuity of x

xo, it suﬃces to show that

7→

Λ(r, x) =

ψ

rθ

x +

4

π
2

·

cos (rαk ·

x)

4

ψ (rθ

−

−

·

4

x)

Xk=1
is continuous with respect to x. Due to the formula sin(x) + sin(y) = 2 sin( x+y

Xk=1

(cid:16)

(cid:17)

sin (rαk ·

x)

.

!
2 ) cos( x

y
2 ), and the
−

fact

αk ·

4

k=1
P
4

x = 0, we obtain

sin(rαk ·

x) =2 sin

Xk=1

r(α1 + α2)

2

(cid:18)

x

·

cos

α2)
r(α1 −
2

·

x

(cid:18)

r(α3 + α4)

2
(cid:18)
r(α1 + α2)

x

·

2

cos

(cid:19)

cos

α4)
r(α3 −
2
(cid:18)
α2)
r(α1 −
2

·

(cid:19)
x

·

(cid:19)
x

·

x

(cid:19)

+ 2 sin

=2 sin

(cid:18)

2 sin(rθ

=

−

·

x)

cos

(cid:19)(cid:18)
(cid:18)
α2)
r(α1 −
2

x

·

cos

−

(cid:19)

cos

−
(cid:18)
α4)
r(α3 −
2

α4)
r(α3 −
2

x

·

(cid:19)(cid:19)

x

·

.

The square wave function ψ(rθ
equal to zero. Therefore the function x

·

(cid:18)

(cid:18)

(cid:19)
x) changes its sign at rθ
x) sin(rθ
ψ(rθ

(cid:18)
x) is
x = kπ, k
x) is continuous, and so is the term

(cid:19)(cid:19)
Z, when sin(rθ

∈

·

7→

·

·
·

ψ(rθ

x)

·

sin(rαk ·

x).

4

k=1
P

4

Similarly, using the formula cos(x) + cos(y) = 2 cos

x+y
2

cos

x

y

−
2

, we obtain

cos(rαk ·

x) = 2 cos(rθ

x)

cos

Xk=1
Then the continuity of x
ψ

cos(rθ

rθ

x + π
2

·

·

7→

·
x), and we ﬁnish the proof.

(cid:1) P

ψ

rθ

(cid:0)

·

(cid:18)
x + π
2

(cid:0)
α2)
r(α1 −
2

(cid:1)
x

·

(cid:18)
4
k=1 cos (rαk ·

(cid:0)

−

cos

(cid:1)

(cid:18)

(cid:19)

α4)
r(α3 −
2

·

x

.

(cid:19)(cid:19)

x) follows from the continuity of x

7→
(cid:3)

(cid:0)

(cid:1)

4.1.2. Terminal condition.

uT (t, x) and the symmetry of uT , we only need to show the
Proof. Due to the continuity of x
equality uT (T, x) = Φ(x) for the case x(1) < x(2) < x(3) < x(4). Recall the deﬁnition of sine integral
function si(x) and cosine integral function Ci(x) (see e.g. [2]),

7→

si(x) =

∞

sin(t)
t

−

x

Z

dt, Ci(x) =

∞

cos(t)
t

dt,

−

x

Z

and denote

T0 =

−

2θ

xo , Ak = αk ·

xo, Rk =

,
AkT0|
|

k = 1, . . . , 4.

π

·

Under the assumption x(1) < x(2) < x(3) < x(4), it is easy to check the following inequalities

3π
2

−

< A1T0 <

π
2

−

< A2T0 < A3T0 <

π
2

< A4T0 <

3π
2

.

(4.1)

 
12

ERHAN BAYRAKTAR, IBRAHIM EKREN, AND XIN ZHANG

According to (3.1), we have

Note that

2√2

4

Xk=1

xk −

8√2uT (T, x) =

∞

Λ(r, xo)
r2

dr.

0

Z

ψ

rθ

(cid:16)

xo +

·

π
2

=

1,

−
+1,




(cid:17)

r

r

∈

∈

[(4n + 1)T0, (4n + 3)T0]

[(4n

−

1)T0, (4n + 1)T0],

ψ (rθ

·

xo) =

1,

−
+1,




r

r

[4nT0, (4n + 2)T0]

∈

[(4n + 2)T0, (4n + 4)T0].

We can rewrite the integral as inﬁnite sum of integrals



∞

Λ(r, xo)
r2

dr =

0
Z

∞

0  

Z

ψ

rθ

(cid:16)

xo +

·

4

cos(Akr)
r2

4
r2

−

dr

!

∈

π
2

4

Xk=1
(cid:17)
sin(Ak4)
r2

dr

∞

ψ (rθ

xo)

·

Xk=1
(2n+2)T0

4

−

0

Z

1)n

=

∞

(
−
Xn=0

2nT0

Z

Xk=1

(2n+1)T0

4

(2n

Z

−

1)T0

Xk=1

sin(Akr)
r2

dr +

0
Z

cos(Akr)
r2

dr

−

T0

4

cos(Akr)

r2

Xk=1
4
∞
r2 dr.

T0

Z

1

dr

−

(4.2)

∞

+

(
−
Xn=1
r2 dr =

Λ(r,xo)

Our aim is to prove

∞0

1)n

4A4, which is equivalent to uT (T, x) = Φ(x).

−

It is easy to check the following indeﬁnite integral formulas,

R

sin(x)
x2 dx = Ci(x)
cos(x)
x2 dx =

−

si(x)

−

sin(x)
x
cos(x)
x

−

+ Constant,

+ Constant.

Z

Z

Let us compute the integral

2T0

1
r2

0

Z

4

Xk=1

4

sin(Akr)dr =

Ak

Xk=1

(cid:18)
4

)
AkT0|
Ci(2
|

−

sin(2
)
AkT0|
|
AkT0| (cid:19)
2
|
)
Akǫ
sin(
|
|
Akǫ
| (cid:19)
|

−

.

lim
0
ǫ
→

−

Ak

Xk=1

(cid:18)

Akǫ
Ci(
|

)
|

According to

4

Ak = 0 and lim
0
→

x

k=1
P

4

Ak

k=1
P

sin(x)

x = 1, the term

Akǫ

sin(
|
Akǫ

|

|

)

|

vanishes. Since the expansion

of Ci(x) near x = 0 is ln(x) + γ, where γ is the Euler-Mascheroni constant (see e.g. [7]), we obtain

FINITE-TIME 4-EXPERT PREDICTION PROBLEM

13

that

4

lim
0
ǫ
→

Akǫ
AkCi(
|

Xk=1
Accordingly, we have

) = lim
|
0
ǫ
→

4

Xk=1

Ak|
Ak(ln(
|

) + ln(ǫ) + γ) =

4

Xk=1

).
Ak|
Ak ln(
|

4

4

sin(Akr)dr =

Ak

2T0

1
r2

0
Z

Xk=1

)
AkT0|
Ci(2
|

−

sin(2
)
AkT0|
|
AkT0|
2
|

)

4

−

Xk=1

Ak|!
Ak ln(
|

,

and similarly for each n

Xk=1

N,

∈
4

sin(Akr)dr =

Xk=1

4

Xk=1

4

(2n+2)T0

2nT0

Z

1
r2

)
AkT0|
Ak(Ci((2n + 2)
|

−

sin((2n + 2)
)
AkT0|
|
AkT0|
(2n + 2)
|

)

Therefore, we get the equation

Ak(Ci(2n

)
AkT0|
|

−

−

Xk=1

sin(2n
2n

)
AkT0|
|
AkT0|
|

).

+

∞

0
Z

−

ψ

rθ

(cid:16)

xo +

·

π
2

4

(cid:17)

Xk=1

sin(Akr)
r2

dr =

−

4

Xk=1
4

Ak|
Ak ln(
|

) + 2

Ak(

1)n+1Ci(2n

)
AkT0|
|

−

4

∞

n=1
X

Xk=1
1)n+1 sin(2nAkT0)

2nT0

2

−

Xk=1

∞

(
−
n=1
X

.

(4.3)

Now we deal with the cosine term in (4.2). Due to the equality si(0) =

π
2 , it can be seen that

T0

0

Z

1
r2 (

4

Xk=1

cos(Akr)

4)dr =

−

4

−

Xk=1

Ak|
|

)
AkT0|
si(
|

−

)
AkT0|
cos(
|
T0

4

Xk=1

Akǫ
si(
|

) +
|

4

Akǫ
cos(
|
ǫ

−

+

4
T0

1

)
|

−

!

Ak|

+ lim
ǫ
→

0+  |
4

4

Xk=1
4

π
2

=

−

Ak| −
|

Xk=1

Xk=1

Ak|
|

Xk=1
)
AkT0|
si(
|

4

−

Xk=1

)
AkT0|
cos(
|
T0

+

4
T0

,

and similarly

(2n+3)T0

(2n+1)T0

Z

1
r2

4

Xk=1

cos(Akr)dr =

−

+

4

Xk=1
4

Xk=1

Ak|
|

)
AkT0|
si((2n + 3)
|

−

Ak|
|

)
AkT0|
si((2n + 1)
|

−

)
AkT0|
cos((2n + 3)
|

(2n + 3)T0

)
AkT0|
cos((2n + 1)
|

(2n + 1)T0

.

4

Xk=1
4

Xk=1

 
14

ERHAN BAYRAKTAR, IBRAHIM EKREN, AND XIN ZHANG

Then, in conjunction with the equality

+
∞T0

4
r2 dr =
−

4
T0

−

, we obtain that

+

∞

ψ

rθ

xo +

·

R
π
2

cos(Akr)
r2

4
r2

−

dr

!

4

(cid:17)

Xk=1
4

0

Z

(cid:16)
π
2

=

−

4

Xk=1
4

Ak| −
|

2

−

∞

(
−
n=1
X

Xk=1

∞

2

Xk=1

(
−
Xn=1
1)n+1 cos((2n
(2n

1)n+1

Ak|
|

(2n
si(
|

)
1)AkT0|

−

1)AkT0)
1)T0

.

−
−

(4.4)

Using the inverse Fourier transform, we have

∞

(
−
Xn=1
∞
(
−
n=1
X

1)n+1 cos((2n
(2n

−
−

1)AkT0)
1)T0

=

π
4T0

1)n+1 sin(2nAkT0)

2nT0

=

i

log

1 + e−

(cid:0)

(cid:0)

sign

tan

π
4

+

AkT0
2

,

(cid:18)

(cid:18)
i2AkT0

(cid:19)(cid:19)
1 + ei2AkT0

log

.

(cid:1)(cid:1)

−
4T0
(cid:0)
(cid:1)
( π
2 , 3π
AkT0| ∈
|
< π
2 , we get sign

Recalling the inequalities (4.1), for k = 1, 4, we have
AkT0|
|

1. For k = 2, 3, since

4 + AkT0

tan

=

−

π

2

sign
and therefore

(cid:16)

(cid:16)

(cid:17)(cid:17)

4

It can be seen that the function

Xk=1

π
2T0

sign

tan

(cid:18)

(cid:18)

π
4

+

AkT0
2

(cid:19)(cid:19)

= 0.

2 ), and hence the term
4 + AkT0
= 1,

tan

π

2

(cid:16)

(cid:16)

(cid:17)(cid:17)

(4.5)

x

7→

i

log(1 + e−

ix)

log(1 + eix)

−

i log

≡

(cid:18)

ix

1 + e−
1 + eix

≡

(cid:19)

x mod 2π

(cid:1)

is 2π-periodic, and equals to x when restricted to (

π, π). So that we obtain

(cid:0)

1)n+1 sin(2nAkT0)

2nT0

∞

(
−
n=1
X

= 


−
2AkT0+2π
4T0
2AkT0
,
4T0
2AkT0
4T0

2π

−

,

,

if k = 1,

if k = 2, 3,

if k = 4,

and hence


1)n+1 sin(2nAkT0)

2nT0

= 0.

4

Xk=1

∞

(
−
Xn=1

(4.6)

 
FINITE-TIME 4-EXPERT PREDICTION PROBLEM

15

Combining (4.2), (4.3), (4.4), (4.5) and (4.6), we simplify the expression,

∞

Λ(r, xo)dr
r2

=

−

0

Z

4

Xk=1
4

)
Ak|
Ak ln(
|

−

4

π
2

Ak|
|

4

+ 2

Xk=1
1)AkT0)
1)T0

∞

(
−
n=1
X

4

+ 2

∞

Xk=1

n=1
X

1)n+1

Ak|
|

(2n
si(
|

)
1)AkT0|

−

1)n+1Ci(2n

Ak(

−

)
AkT0|
|

∞

(
−
n=1
X
∞

(
−
n=1
X
Ak|
|

2

−

Xk=1
4

−

=

−

2

Xk=1
4
π
2

Xk=1

4

Xk=1
1)n+1 cos((2n
(2n

−
−

1)n+1 sin(2nAkT0)

2nT0

+ 2

4

Xk=1

∞

(
−
n=1
X
4

∞

Ak|
Ak ln(
|

) + 2

−

Xk=1

Xk=1

n=1
X

1)n+1

Ak|
|

(2n
si(
|

)
1)AkT0|

−

1)n+1Ci(2n

Ak(

−

).
AkT0|
|

(4.7)

It remains to calculate the inﬁnite sum including Ci(x) and si(x). Note that

2

−

∞

Xn=1

1)n+1si((2n

(
−

1)Rk) = 2

−

∞

(4n

−

1)Rk

Xn=1 Z

(4n

−

3)Rk

sin(r)
r

dr.

z = Im eiz
and sin(z)
counterclockwise direction by

z for z

∈

R. We apply contour integral to eiz

z . Denoting the curves in the

γk
n :=

nRkeiθ : θ
{

,
[0, π]
}

∈

we have equalities

(4n

Therefore, we obtain

2

(4n

Z

−

1)Rk

−
3)Rk −

+

3

Zγk

4n

−

Zγk

4n

−

eiz
z

1

dz = 0, n

N.

∈

2

−

(
−

∞

Xn=1

1)n+1si((2n

1)Rk) =

−

=

eiz
z

dz

1

∞

(
−
Xn=1
∞
(
−
n=1
X

1)n+1Im

1)n+1Re

2n

Zγk
π

−

0

Z
π, π, 3π

ei(2n

−

1)Rk eiθ

dθ.

)
(
∗

According to the inequalities (4.1), we have 2Rk 6∈ {−
inﬁnite sum and the integral and compute the geometric series to obtain

3π,

−

, and hence can exchange the
}

2

−

(
−

∞

n=1
X

1)n+1si((2n

1)Rk) = Re

−

0

Z

π

eRkeiθ
1 + e2Rkeiθ dθ.

(4.8)

Similarly, we calculate

∞

2

n=1
X

(
−

1)n+1Ci(2nRk) =

2Re

−

∞

4nRk

(4n

n=1 Z
X

2)Rk

−

eiz
z

dz

.

!

 
16

ERHAN BAYRAKTAR, IBRAHIM EKREN, AND XIN ZHANG

Denoting the quarter of circles in the counterclockwise derivation by

˜γk
n :=

nRkeiθ : θ
{

,
[0, π/2]
}

∈

π
2

e4nRkeiθ

dθ +

(4n

−

2)Rk

r

e−
r

dr.

we obtain that

4nRk

i4nRk

0 =

Z

=

(4n

2)Rk

−
4nRk

(4n

2)Rk

+

−

Z˜γk

4n

i(4n

Z

−

eiz
z

dz + i

0

π
2

eiz
z

dz

2

2)Rk −

4n

−

Z˜γk
2)Rk eiθ

e(4n

−

dθ + i

Z
Recalling the deﬁnition of integral exponential function for x > 0,

Z

Z

−

0

4nRk

Z

E1(x) =

+

∞

r

e−
r

dr =

+

∞

0
Z

x

Z

xet)dt,

exp(

−

it can be seen that

2Re

−

4nRk

(4n

Z

−

2)Rk

eiz
z

dz =2Re

i

 −
+ 2(E1(4nRk)

 Z
0

=2Im

π
2

e(4n

 Z
0
+ 2(E1(4nRk)

π
2

e(4n

−

2)Rk eiθ

dθ

π
2

e4nRkeiθ

dθ

!!

−

0
Z
2)Rk))

π
2

e4nRkeiθ

dθ

0

Z
2)Rk)).

!

E1((4n

−

2)Rkeiθ

dθ

−

E1((4n

−

−

−

−

By direct computation, we have

1)n+1Ci(2nRk) = 2Im

∞

2

n=1
X

(
−

= 2Im

= 2Im

π
2

π
2

π
2

 Z
0

 Z
0

ei2Rkeiθ
1 + ei2Rkeiθ dθ
ei2Rkeiθ
1 + ei2Rkeiθ dθ
ei2Rkeiθ
1 + ei2Rkeiθ dθ

+ 2

!

! −

! −

n=1
X
∞

2

2

0

Z

∞

∞

(E1(4nRk)

E1((4n

−

−

2)Rk))

!

2Rker

e−
1 + e−

2Rker dr

2t

e−
t(1 + e−

dt,

2t)

)
(
∗∗

 Z
0
where the last equation follows from the change of variable t = Rker.

Rk

Z

Then, we can further simplify the expression (4.7) using (
∗
4

4

4

) and (

∗∗

∞

Λ(r, xo)
r2

0
Z

dr =

)
Ak|
Ak ln(
|

2AkIm

π
2

0

Z

−

+

Xk=1
4

Xk=1

π
2

−

+

Ak|
|

Xk=1
ei2Rkeiθ
1 + ei2Rkeiθ dθ

Re

Ak|
|

Xk=1

2Ak

−

∞

Rk

Z

),

0

Z

π

eiRkeiθ
1 + ei2Rkeiθ dθ

2t

e−
t(1 + e−

dt.

2t)

(4.9)

 
FINITE-TIME 4-EXPERT PREDICTION PROBLEM

17

Ik, k = 2, 3

Ik, k = 1, 4

π
2

π
2

Figure 1. Contour of Ik

Let us denote

Ik =

Jk =

π

π
2

0

Z

0

Z

eiRkeiθ

1 + ei2Rkeiθ dθ =

ei2Rkeiθ
1 + ei2Rkeiθ dθ =

i

−

Zγk

1

i

−

Z˜γk

1

eiz
z(1 + ei2z)

dz,

ei2z
z(1 + ei2z)

dz.

For k = 2, 3, we have Rk < π

2 , and therefore 0 is the only pole of complex function z

over the interval [

−

Rk, Rk]. According to the contour integral (see Figure 1), we have that

eiz
z(1+ei2z )

7→

ǫ

−
Rk −
ǫ

−

0 =

+

Zγk

1

Z

−

=Ik −

i

ǫeiθ:θ

Z{

[0,π]

∈

}

eit
t(1 + ei2t)

dt

Rk

−

Z
it
2 is real, and lim
0
→
2 , 0, π

π

ǫ

+

ǫ

Z
π

dz

Rk

−

ieiz
z(1 + ei2z)
eiǫeiθ
1 + ei2ǫeiθ dθ

−

−

0

Z
eiǫeiθ
1+ei2ǫeiθ = 1

Rk

eit
t(1 + ei2t)

dt.

i

ǫ

Z

t
|

eit

t(1+ei2t) = eit+e−
Since
2 . For k = 1, 4,
eiz
2 , 3π
( π
z(1+ei2z ) over
since Rk ∈
the interval [
Rk, Rk]. Again by contour integral (see Figure 1) the real part of Ik is equal to the
integral around the three poles,

2 are three poles of the complex function z

2 , we obtain that ReIk = π

1+ei2t
2 ), we have

7→

−

−

|

π

Re

ReIk = lim
0
→
π

ǫ

0

Z

(cid:18)

ieiǫeiθ
1
−
ieiǫeiθ
1

ǫeiθ
ei2ǫeiθ
ǫeiθ
ei2ǫeiθ
π
2 −

=

−
π
2

(cid:18)

π

1
2 + ǫeiθ +
1
2 + ǫeiθ +
2,

π

Re

dθ +

1
ǫeiθ

π
2 −
1
ǫeiθ

π
2 −

π
2

π
2

dθ +

(cid:19)

dθ +

(cid:19)

=

=

and hence

lim
0
ǫ
→
2
π

0
Z

π

0 −
Z

4

ReIk =

Ak|
|

Ak| −
|

A1| −
2
|

.
A4|
2
|

(4.10)

4

π
2

Xk=1
For k = 2, 3, we apply contour integral to Jk (see Figure 2),

Xk=1

iǫ

0 =

+

Z

Z˜γk

1

= Jk −

i

Rk

Z

+

ǫ
Z
0

iRk −
ǫ

ǫeiθ:θ

2t

Z{
e−
t(1 + e−

[0,π/2]

∈

}

dt +

2t)

π
2

Z

Rk

iei2z
z(1 + ei2z)

−

dz

ei2ǫeiθ
1 + ei2ǫeiθ dθ

Rk

ei2t
t(1 + ei2t)

dt.

i

−

ǫ

Z

18

ERHAN BAYRAKTAR, IBRAHIM EKREN, AND XIN ZHANG

Jk, k = 2, 3

Jk, k = 1, 4

π
2

π
2

Figure 2. Contour of Jk

Noting that imaginary part of i

ei2t

t(1+ei2t) is just 1

2t , we obtain that

For k = 1, 4, z = π

ImJk =

ǫ

Rk

Z

2t

e−
t(1 + e−

2t)

dt + Im

π
2

ei2ǫeiθ
1 + ei2ǫeiθ dθ +

Rk

1
2t

dt.

ǫ
Z

0

Z

0 =Jk −

ǫ

i

2t

2 is the other pole over the interval [0, Rk] (see Figure 2), and we have
ei2ǫeiθ
1 + ei2ǫeiθ dθ
ei2ǫeiθ
ǫeiθ
( π
2 + ǫeiθ)(1

ei2t
t(1 + ei2t)

ei2t
t(1 + ei2t)

e−
t(1 + e−

ei2ǫeiθ )

dt +

dt +

Z
Rk

π
2 −

dθ,

2t)

Z
π

dt

−

−

Rk

π
2 +ǫ

Z

π
2

i

i

0

0

ǫ

ǫ

Z

−

Z

and therefore,

ImJk =

ǫ

Rk

Z

Take

−

π
2 −

ǫ

Z

2t

e−
t(1 + e−
π
2 +ǫ

dt + Im

2t)

1
2t

dt

π

Im

−

0
Z

π
2

Z

0

ei2ǫeiθ
1 + ei2ǫeiθ dθ +
ei2ǫeiθ
ǫeiθ
( π
2 + ǫeiθ)(1

−

dθ.

ei2ǫeiθ )

Rk

1
2t

dt

ǫ
Z

P 1

ǫ = Im

0

Z

π
2

ei2ǫeiθ
1 + ei2ǫeiθ dθ,

P 2

ǫ = Im

π

0
Z

ei2ǫeiθ
( π
2 + ǫeiθ)(1

ǫeiθ

ei2ǫeiθ )

−

dθ.

Then we compute

2ImJk −

2

2t

e−
t(1 + e−

∞

Rk

Z

dt

Ak|
ln(
|

) =

−

2t)

∞

2

−

ǫ

Z
+ 2P 1

2t

e−
t(1 + e−

2t)

dt + (ln(Rk)

)
Ak|
ln(
|

−

−

ln(ǫ))

ǫ − 1
{

k=1,4

}

ln

(cid:18)

(cid:18)

π/2 + ǫ
ǫ
π/2

−

(cid:19)

+ 2P 2
ǫ

.

(cid:19)

As a result of

4

k=1
P
4

Xk=1

FINITE-TIME 4-EXPERT PREDICTION PROBLEM

19

Ak = 0, ln(Rk)

−

Ak|
ln(
|

) = ln(T0) and lim
0
→

ǫ

P 2

ǫ = 1, it can be seen that

Ak

(cid:18)

2ImJk−

)
Ak|
ln(
|

−

2

=

2

−

4

Ak

ǫ

Z

Xk=1
4

∞

2t

e−
t(1 + e−

dt

2t)

Rk

Z

∞

2t

e−
t(1 + e−

2t)

(cid:19)

4

+

=

−

AkP 1

ǫ −

Xk=1
(A1 + A4)
lim
0
ǫ
→

(A1 + A4)

ln

(cid:18)
(cid:18)
π/2 + ǫ
ǫ
π/2

−

(cid:19)

ln

(cid:18)

(cid:18)

dt +

Ak(ln(T0)

ln(ǫ))

−

Xk=1
π/2 + ǫ
ǫ
π/2

−

+ 2P 2
ǫ

+ 2P 2
ǫ

(cid:19)

(cid:19)

(cid:19)

=

2A1 −

−

2A4.

Combining (4.9), (4.10), (4.11), we obtain

Λ(r, xo)
r2

∞

0

dr =

A1| −
2
|

A4| −
2
|

2A1 −

−

2A4 =

4A4,

−

which concludes the result.

Z

4.1.3. Smoothness.

Proof. Step 1: Equation (3.3). As a result of

4

Xk=1

we obtain that

sin(rαk ·

xo) =

4

Xk=1

sin(rαk ·

x),

4

Xk=1

cos(rαk ·

xo) =

4

Xk=1

cos(rαk ·

x),

uT (t, x) = −

1
16√2

∞

e−

Z

−∞

t)r2

(T

−
r2

4

xo +

·

ψ

rθ

(cid:16)

ψ (rθ

−

xo)

·

Xk=1

sin(rαk ·

x)

!

dr +

π
2

1
4

To stress the dependence of T0 on x, we denote it as T0(x) :=
functional series Fl(x), Gl(x), l

Z by

∈
(2l+1)T0(x)

Fl(x) :=

(2l

Z

−

1)T0(x)

t)r2

e−

(T

−
r2

ψ

rθ

xo +

·

π
2

(cid:16)

t)r2

cos(rαk ·

x)

−

4

t)π

.

(T

xk +

1
2 r
π
xo . Since θ
2θ

−
2

·

4

Xk=1
(cid:17)
4

Xk=1

−

4

cos(rαk ·

x)

−

dr,

4
!

(cid:17)

Xk=1
4

(2l+2)T0(x)

Gl(x) :=

−

2lT0(x)

Z

e−

(T

−
r2

ψ (rθ

xo)

·

Xk=1

sin(rαk ·

x)

!

dr.

xo < 0, deﬁne two

·

(4.11)

(4.12)

(cid:3)

 
 
 
20

ERHAN BAYRAKTAR, IBRAHIM EKREN, AND XIN ZHANG

Then we have

uT (t, x) =

1
16√2

−

Z
Xl
∈

(Fl(x) + Gl(x)) +

1
4

4

Xk=1

xk +

(T

1
2 r

−
2

t)π

.

Noting that

is given by

4

k=1
P

cos(rαk ·

x) = 0 at endpoints r = (2l

1)T0(x), l

−

∈

Z, the partial derivative of Fl(x)

(2l+1)T0(x)

(2l

Z

−

1)T0(x)

e−

(T

−
r

4(2l + 1)∂+

xi T0(x)

t)r2

4

αk,iψ

rθ

Xk=1
(cid:16)
t)(2l+1)2 T 2
0 (x)
−

(T

e−

(2l + 1)2T 2

0 (x)

∂+
xiFl(x) =

−

−

and similarly

xo +

·

π
2

(cid:17)

sin(rαk ·

x)dr

+ 4(2l

−

1)∂+

xiT0(x)

(T

e−

−

t)(2l

1)2 T 2

0 (x)

−
1)2T 2

0 (x)

,

(2l

−

∂+
xiGl(x) =

(2l+2)T0(x)

−

2lT0(x)

Z

e−

(T

−
r

t)r2

4

αk,iψ (rθ

xo) cos(rαk ·

·

x)dr.

Xk=1

Z
l
∈
P

It is well-known that summation and diﬀerentiation are interchangeable if the partial sum of deriva-
∂+
xiGl(x) converge uniformly in any bounded
tives converges uniformly. Since

∂+
xiFl(x) and

region of x, we conclude that,

Z
l
∈
P

xiuT (t, x) =
∂+

1
16√2

−

(∂xiFl(x) + ∂xiGl(x)) +

1
4

Z
Xl
∈
e−
∞

=

1
16√2

Z

−∞

t)r2

4

αk,i

ψ

rθ

(T

−
r

Xk=1
(cid:16)
x)) dr +

(cid:16)
1
.
4

+ψ (rθ

·

xo) cos (rαk ·

xo +

·

π
2

(cid:17)

sin (rαk ·

x)

We can calculate ∂−xiuT (t, x) in the exactly same way, and ﬁnd that it has the same expression with
xiuT (t, x). Therefore we proved the result (3.3).
∂+

Step 2: Equation (3.4).

i.e., x =
(x1, x1, x1, x1). Let us compute the derivative of uT (t, x) by deﬁnition. Take ǫ > 0 and denote
x1 + ǫ, x1, x1, x1

xo = 0, then all the coordinates of x are equal,

simply by x + ǫ. Then we have

If θ

·

(cid:0)

uT (t, x + ǫ) = −

(cid:1)

1
8√2

∞

e−

(T

−
r2

0

Z

t)r2

ψ

ǫr
√2

+

π
2

cos

+ 3 cos

3ǫr
√2 (cid:19)

ψ

−

ǫr
√2 (cid:19) (cid:18)

(cid:18)

sin

(cid:18)

(cid:18)

(cid:18)
3ǫr
√2 (cid:19)

3 sin

−

(cid:18)

(cid:18)

(cid:19) (cid:18)
ǫr
√2 (cid:19)(cid:19)(cid:19)

dr + x1 +

3ǫr
√2 (cid:19)(cid:19)
1
(T
2 r

4

−

t)π

.

−
2

(cid:18)

ǫ +

1
4

FINITE-TIME 4-EXPERT PREDICTION PROBLEM

21

In order to conclude our result, it remains to show that

0 = lim
0
ǫ
→

1
ǫ

ψ

−

(cid:18)

0
Z
ǫr
√2

∞

e−

t)r2

(T

−
r2

sin

(cid:19) (cid:18)

(cid:18)

ǫr
√2

+

3 sin

π
2
(cid:19) (cid:18)
ǫr
√2

ψ

(cid:18)
3ǫr
√2

(cid:19)

(cid:18)

−

(cid:18)

(cid:19)(cid:19)(cid:19)

cos

3ǫr
√2 (cid:19)
dr.

(cid:18)

+ 3 cos

ǫr
√2 (cid:19)(cid:19)

(cid:18)

4

−

According to the estimation

∞

e−

1
√ǫ

Z

t)r2

(T

−
r2

dr

ǫ

≤

∞

1
√ǫ

Z

(T

e−

−

t)r2

dr,

(T

12e−

−

t)r2

dr

∞

1
√ǫ

1
ǫ

≥

lim
0
ǫ
→

∞

12e−

(T

−

t)r2

1
√ǫ

Z

r2

dr

it can be seen that

0 = lim
0
ǫ
→

lim
0
ǫ
→

≥

Z
1
ǫ

Now, both ψ
equalities

(cid:16)

ǫr
√2

1
Z
√ǫ
ǫr
√2

ψ

−

(cid:18)
+ π
2

(cid:19) (cid:18)

and ψ

(cid:18)
ǫr
√2

(cid:17)

(cid:16)

cos

∞

e−

t)r2

(T

−
r2

sin

ǫr
√2

+

ψ

(cid:18)

π
2

3 sin

(cid:18)

−

(cid:19)

(cid:18)

(cid:12)
(cid:12)
(cid:12)
3ǫr
(cid:12)
√2

(cid:19) (cid:18)
ǫr
√2

cos

+ 3 cos

ǫr
√2 (cid:19)(cid:19)

(cid:18)

4

−

3ǫr
√2 (cid:19)

(cid:18)

dr.

are positive over the interval

0, 1
√ǫ

. In conjunction with two

(cid:19)(cid:19)(cid:19)(cid:12)
(cid:12)
(cid:12)
(cid:12)

we make the estimation

sin

(cid:18)

−

3 sin

(cid:18)

(cid:18)

(cid:17)
3ǫr
√2 (cid:19)
3ǫr
√2 (cid:19)

+ 3 cos

= 4 cos3

(cid:18)

ǫr
√2 (cid:19)
ǫr
=
√2 (cid:19)

,

h
ǫr
√2 (cid:19)
ǫr
√2 (cid:19)

(cid:18)

(cid:18)

i

,

−

4 sin3

−

4 cos3

1
√ǫ

e−

t)r2

(T

−
r2

Λ(t, x + ǫ)dr

1
ǫ

(cid:12)
(cid:12)
(cid:12)
(cid:12)

0

Z

(cid:12)
(cid:12)
(cid:12)
(cid:12)

≤

≤

(cid:12)
(cid:12)
(cid:12)
(cid:12)
ǫ

1
ǫ

1
√ǫ

e−

t)r2

(T

−
r2

(T

e−

−

t)r2

ǫr
√2

4 + 4 sin3

ǫr
√2

(cid:18)
4 cos3

(cid:18)
4

−

(cid:19)
ǫr
√2



(cid:16)
(ǫr)2

(cid:17)

+

4 sin3

(cid:18)
ǫr
√2
(ǫr)2 

(cid:16)

(cid:17)

(cid:19)(cid:19)

dr.

dr

(cid:12)
(cid:12)
(cid:12)
(cid:12)

0

Z

1
√ǫ

0

Z

1
√ǫ
0

(T

e−

−

t)r2

4

−

4 cos3
(cid:16)
(ǫr)2

ǫr
√2 (cid:17)

+

4 sin3


ǫr
√2 (cid:17)

(cid:16)
(ǫr)2

dr is bounded as ǫ

0, we conclude

→

!



Since the integral

that

R

1
ǫ

lim
0
ǫ
→

0
Z

∞

e−

t)r2

(T

−
r2

Λ(t, x + ǫ)dr = 0,

and hence ∂x1uT (t, x) = 1

4 . Similarly, we can prove that ∂xiuT (t, x) = 1

4 , i = 2, 3, 4.

Step 3: Equation (3.5). Deﬁne two functional series Hl(x), Kl(x), l

Z by

∈

Hl(x) :=

(2l+1)T0(x)

(2l

Z

−

1)T0(x)

e−

(T

−
r

t)r2

4

αk,iψ

rθ

Xk=1

(cid:16)

xo +

·

π
2

(cid:17)

sin (rαk ·

x) dr,

 
22

ERHAN BAYRAKTAR, IBRAHIM EKREN, AND XIN ZHANG

(2l+2)T0(x)

Kl(x) :=

2lT0(x)

Z

e−

(T

−
r

t)r2

4

Xk=1

αk,iψ (rθ

xo) cos (rαk ·

·

x) dr.

Then we have ∂xiuT (t, x) = 1

4 + 1
16√2

(Hl(x) + Kl(x)). We compute the right-hand derivatives
Z
l
∈
P

of Hl(x), Kl(x),

∂+
xj Hl(x) =

xo +

·

π
2

cos (rαk ·

x) dr

(2l+1)T0(x)

4

(T

e−

−

t)r2

αk,iαk,jψ

rθ

(2l

Z

−

1)T0(x)

+ ∂+

xj (θ

∂+
xj (θ

−

·

·

xo)

(
−

1)le−

xo)

(
−

1)le−

Xk=1

(T

t)(π(l+1/2))2
xo)2
(θ

−

·

·

xo

θ

·
(T

xo

θ

·

1/2))2

−

t)(π(l
(θ

−
xo)2

(cid:16)
4

Xk=1
4

Xk=1

(cid:17)
αk ·

(cid:18)

(cid:18)

αk ·

2αk,i sin

2αk,i sin

xπ(l + 1/2)
xo
θ

·

1/2)

xπ(l
θ

−
xo

·

(cid:19)

,

(cid:19)

(4.13)

∂+
xj Kl(x) =

(2l+2)T0(x)

−

Z

2lT0(x)

4

(T

e−

−

t)r2

αk,iαk,jψ (rθ

Xk=1
t)(π(l+1))2
xo)2
(θ

·

(T

−

xo)

(
−

1)le−
θ

xo

xo)

(
−

1)le−
θ

·

t)(πl)2
xo)2

−
(θ
·

·
(T

xo

Xk=1

4

2αk,i cos

Xk=1

+ ∂+

xj (θ

∂+
xj (θ

−

·

·

xo) sin (rαk ·

·

x) dr

4

2αk,i cos

αk ·

xπ(l + 1)
xo
θ

·

(cid:19)

(cid:18)

xπl
xo

αk ·
θ
·

.

(cid:19)

(cid:18)

(4.14)

Replacing all the ∂+
can be easily checked that if θ
·
xj Hl(x) = ∂−xj Hl(x), ∂+
hence ∂+
xj Kl(x) = ∂−xj Kl(x). Since

xo < 0, x(2) < x(3), the function x

θ

7→
∂xj Hj(x) and

·

xj with ∂−xj , we obtain the left hand side derivatives of Hl(x) and Kl(x).

It
xo is diﬀerentiable, and
∂xj Hj(x) converge

uniformly in any bounded region of x, we can interchange summation and diﬀerentiation and obtain
(3.5).

Z
l
∈
P

Z
l
∈
P

Step 4: Equation (3.6). If θ

the left derivative ∂−xj (θ

·

xo < 0, x(2) = x(3), the right derivative ∂+
·
xo). However, by showing that for each i = 1, 2, 3, 4,

xj (θ

·

xo) may not equal to

4

αk,i sin

αk ·

xπ(l + 1/2)
xo
θ

4

=

αk,i cos

xπl
xo

αk ·
θ
·

(cid:18)

(cid:19)

= 0,

l

Z,

∈

(cid:18)

Xk=1

Xk=1
functions Hl(x), Kl(x) are still diﬀerentiable, and hence we can conclude (3.6). Since we need to
show the equality for any i = 1, 2, 3, 4, we can simply assume x = xo without loss of generality. It
can be easily checked that

·

(cid:19)

xo
xo =
xo
xo =

α1 ·
θ
·
α2 ·
θ
·

xo
xo −
xo
xo =

α4 ·
θ
·
α3 ·
θ
·

3x(1)

2x(2)

4 =

x(4)

,

−
x(1)
x(1)

−
−
x(4)

−
x(4)
x(4)

,

−

2x(2)

−
x(1)

FINITE-TIME 4-EXPERT PREDICTION PROBLEM

23

and hence

α1 ·

α2 ·

sin

sin

(cid:18)

(cid:18)

·

·

xπ(l + 1/2)
xo
θ
xπ(l + 1/2)
xo
θ
α1 ·
θ
·
α2 ·
θ
·

xπl
xo
xπl
xo

(cid:18)

(cid:18)

,

,

(cid:19)

(cid:19)

= sin

= sin

= cos

= cos

α4 ·

α3 ·

α4 ·
θ
·
α3 ·
θ
·

(cid:18)

(cid:18)

(cid:18)

(cid:18)

(cid:19)

(cid:19)

(cid:19)

(cid:19)

·

xπ(l + 1/2)
xo
θ
xπ(l + 1/2)
xo
θ
·
xπl
xo
xπl
xo

(cid:19)

,

.

(cid:19)

cos

cos

We ﬁnish the proof of (3.6) by the following computation

4

Xk=1

αk,i sin

αk ·

xπ(l + 1/2)
xo
θ

·

(cid:18)

=

±

(cid:19)

2

sin

(cid:18)

4 sin

=

±

4

Xk=1

αk,i cos

xπl
xo

αk ·
θ
·

(cid:18)

(cid:19)

=

±

2

cos

(cid:18)

4 sin

=

±

α1 ·

xπ(l + 1/2)
xo
θ

sin

α2 ·

(cid:18)

xπ(l + 1/2)
xo
θ

·

(cid:19)(cid:19)

−

(cid:19)

π(l + 1/2)

cos (π(l + 1/2)) = 0,

·
2x(2)
x(4)

(cid:18)
2x(1)
x(1)

−
−
xπl
α1 ·
xo
θ
(cid:18)
·
2x(2)
x(1)

−
−

−

(cid:19)
2x(1)
x(4)

!
α2 ·
θ
·

xπl
xo

(cid:19)(cid:19)

cos

(cid:18)

πl

sin (πl) = 0.

!

Step 5: Equation (3.7). Finally, supposing x = (x1, x1, x1, x1) and x + ǫj = (x1 + ǫ)1

x11

=j

k

{

}

, we calculate ∂2

xixj uT (t, x). According to (3.3), we have

+

k=j

{

}

∂xiuT (t, x + ǫj) =

1
8√2

0

Z

∞

e−

(T

−
r

t)r2

4

Xk=1

αk,i

ψ

(cid:18)

(cid:18)

ǫr
√2

+

π
2

(cid:19)

sin (rαk ·

(x + ǫj))

As a result of the equalities

+ψ

ǫr
√2 (cid:19)

(cid:18)

cos (rαk ·

(x + ǫj))

dr +

(cid:19)

1
4

.

∞

e−

1
√ǫ

Z

t)r2

(T

−
r

dr =

∞

−

1
√ǫ

Z

2(T

1

−

t)r2 de−

t)r2

(T

−

=

ǫe−
2(T

(T

t)

−
ǫ

t)

−

+

∞

1
√ǫ

Z

(T

−

e−
4(T

−

t)r2
t)r3 dr,

we deduce that

0 = lim
ǫ
→

0  

1
ǫ

lim
0
ǫ
→

≥

+ψ

e−
2(T

(T

t)

−
ǫ

t)

−

∞

e−

(T

+

−
r

∞

e−
4(T

1
√ǫ

Z
t)r2

4

αk,i

1
Z
√ǫ
ǫr
√2

(cid:18)

(cid:19)

(cid:12)
Xk=1
(cid:12)
(cid:12)
(cid:12)
(x + ǫj))
cos (rαk ·
(cid:12)

(cid:18)

(cid:19)(cid:12)
(cid:12)
(cid:12)
(cid:12)

(T

t)r2

−

t)r !

−

6√2

≥

lim
0
ǫ
→

6√2

ǫ  

ǫe−
2(T

(T

t)

−
ǫ

t)

−

+

∞

1
√ǫ

Z

e−
4(T

(T

t)r2

−

ǫr
√2

+

π
2

ψ

(cid:18)

(cid:19)

dr.

sin (rαk ·

(x + ǫj))

t)r3

!

−

(4.15)

 
 
6
24

ERHAN BAYRAKTAR, IBRAHIM EKREN, AND XIN ZHANG

From the equality

4

Xk=1

αk,i cos(rαk ·

(x + ǫj)) =1
{

i=j

3 cos

}

(cid:18)

(cid:18)

it can be easily seen that

+ 1
i
{

=j

}

cos

(cid:18)

−

3ǫr
√2 (cid:19)
ǫr
√2 (cid:19)

(cid:18)

3 cos

cos

−

(cid:18)

(cid:18)

ǫr
√2 (cid:19)(cid:19)
3ǫr
√2 (cid:19)(cid:19)

,

1
rǫ

lim
0
ǫ
→

4

Xk=1

αk,i cos(rαk ·

(x + ǫj)) = 0.

(4.16)

Combining (4.15) and (4.16), we conclude that

αk,i (sin (rαk ·

(x + ǫj)) + cos (rαk ·

(x + ǫj))) dr

+

1
rǫ

4

Xk=1

αk,i cos(rαk ·

(x + ǫj))

!

dr

Xk=1
sin (rαk ·
rǫ

(x + ǫj))

sin (rαk ·
rǫ

(x + ǫj))

∂2
xixj uT (t, x) = lim
0
→

ǫ

1
8√2ǫ

0
Z

1
√ǫ

e−

(T

−
r

t)r2

4

1
√ǫ

(T

e−

−

t)r2

4

αk,i

lim
0
ǫ
→

0
Z

=

1
8√2

=

1
8√2

∞

(T

e−

−

t)r2

0

Z

Xk=1

4

αk,i lim
0
ǫ
→

Xk=1

1
rǫ

∞

4

Xk=1
(T

e−

+ lim
0
ǫ
→

=

1
8√2

0

Z

αk,i cos(rαk ·

(x + ǫj))

!

dr

t)r2

−

4

Xk=1

αk,iαk,j

dr.

!

∂xj Hl(x),

Since ∂xj Hl(x), ∂xj Kl(x) deﬁned in Step 3 are continuous with respect to x, and both series
∂xj Kl(x) converge uniformly in any bounded region of x, the second derivative
R4). (cid:3)

Z
l
∈
xixj uT (t, x) is also continuous, and hence we have proved that uT (t, x) is in C 2([0, T )
∂2
P

Z
l
∈
P

×

4.1.4. Solution Property.

Proof. Supposing that
prove the equation

i1, i2, i3, i4}
{

=

1, 2, 3, 4
}
{

are subscripts such that xi1 ≤

xi2 ≤

xi3 ≤

xi4, we

∂tuT (t, x) +

1
2

∂xi2
(cid:16)

+ ∂xi4

2

(cid:17)

uT (t, x) = 0.

6
 
 
 
FINITE-TIME 4-EXPERT PREDICTION PROBLEM

25

Taking derivative with respect to t, we obtain that

∂tuT (t, x) = −

1
16√2

∞

(T

e−

−

t)r2

ψ

rθ

Z

−∞

4

(cid:16)

xo +

·

π
2

ψ (rθ

−

xo)

·

sin (rαk ·

x)

dr +

!

4

Xk=1

(cid:17)
1
4√2

Z
4

cos (rαk ·

x)

∞

(T

e−

−

t)r2

dr

−∞

1
4

−

π

2(T

t)

−

r

Xk=1
(T

e−

−

= −

1
16√2

∞

Z

−∞

t)r2

ψ

rθ

(cid:16)

xo +

·

π
2

cos (rαk ·

x)

(cid:17)

Xk=1

ψ (rθ

−

xo)

·

4

Xk=1

sin (rαk ·

According to (3.5) and the equality ∂xi2
we have

(θ

·

x)

dr.

!
xo) + ∂xi4

(4.17)

xo) = 0, the series part cancels out and

(θ

·

+ ∂xi4

∂xi2
(cid:16)

2

(cid:17)

uT (t, x) =

1
16√2

4

∞

(T

e−

−

t)r2

(αk,i2 + αk,i4)2

ψ

rθ

xo +

·

π
2

(cid:17)

cos (rαk ·

x)

−∞

Z
ψ (rθ

−

xo) sin (rαk ·

·

Xk=1

x)) dr.

Since (αk,i2 + αk,i4)2 = 2 for every k = 1, 2, 3, 4, we conclude that

1
2

∂xi2
(cid:16)

+ ∂xi4

2

(cid:17)

uT (t, x) =

1
16√2

4

−∞

∞

tr2

e−

ψ
Xk=1 (cid:16)
xo) sin (rαk ·

·

Z
ψ (rθ

rθ

(cid:16)

·

x)) dr =

−

π
2

cos (rαk ·

(cid:17)
∂tuT (t, x).

x)

(4.18)

(cid:3)

(cid:16)

(cid:16)

xo +

−

4.2. Proof of Theorem 3.2.

Proof. By using arguments similar to the proof of (4.18), we have for (j, k) = (1, 3), (1, 4), (2, 3),

From (3.3), we obtain that

4

k=1
P

∂tuT (t, x) +

1
2

∂xij
(cid:16)

+ ∂xik

2

(cid:17)

uT (t, x) = 0.

∂xk uT (t, x) = 1, which implies

xxuT (t, x) (e1 + e2 + e3 + e4) = 0.
∂2

Subsequently, for all J

P (4), we have that

∈
xxuT (t, x)eJ −

e⊤J ∂2

e⊤J −
(cid:16)
Therefore, it remains to show that the strategies J
mal, i.e.,

xxuT (t, x)eJ c =

e⊤J c∂2

,
∈ {∅

e⊤J c

xxuT (t, x) (eJ + eJ c) = 0.
∂2

(cid:17)
,
i1, i2}
{

,
i1}
{

,
i2}
{

,
i3}
{

i4}}
{

are subopti-

∂tuT (t, x) +

1
2

sup
P (N )

∈

J

e⊤J ∂2

xxuT (t, x)eJ ≤

0.

 
 
26

ERHAN BAYRAKTAR, IBRAHIM EKREN, AND XIN ZHANG

xo < 0, x(2) < x(3)
Since the second derivatives of uT (t, x) are continuous, we assume that θ
without loss of generality. First we introduce some notations, and simplify the expressions for
∂tuT (t, x), ∂2

xxuT (t, x). Deﬁne

·

π
2

(cid:17)

cos (rαk ·

xo)

−

ψ (rθ

xo) sin (rαk ·

·

xo)

dr,

(cid:17)

sin

αk ·

(cid:18)

xoπ(l + 1/2)
xo

θ

·

(cid:19)

Sk :=√T

t

−

Z

−∞

Lk :=√T

t 

−

∞

(T

e−

−

t)r2

ψ

rθ

xo +

·

(cid:16)
(T

−

(cid:16)
t)(π(l+1/2))2
xo)2
(θ

·

1)le−

(
−

Z
Xl
∈

xo

θ

·



(
−

1)le−
θ

·

t)(πl)2
xo)2

(T

−
(θ
·

xo

cos

−

Z
Xl
∈

xoπl
xo

αk ·
θ
·

(cid:18)

(cid:19)

.





According to (4.17) and (3.5), it can be checked that

(4.19)

,

(4.20)

∂tuT (t, x) =

1

−
2(T

16

Sk,

4

Xk=1

4

t)

−
1

p
uT (t, x) =

∂2
xih xij

t)  
where we use the fact that the ih-th coordinate of x is the h-th coordinate of xo.

Xk=1

Xk=1

2(T

p

16

−

!

αk,hαk,jSk + 2

∂xij

(θ

·

xo)αk,hLk

4

Deﬁne ˜T :=

xo

−

tπ

√T
2θ

−
·
f (r) = e−

xo , βk := αk·
2π√T
r2
k (r) = f (r) cos(2πβkr), F 2

, k = 1, 2, 3, 4, and

, F 1

−

t

k (r) = f (r) sin(2πβkr).

Their Fourier transforms are given respectively by

ˆf (v) :=

∞

f (x)e−

2πivxdx = √πe−

πv2

,

Z
−∞
ˆf (v

ˆf (v

−

−

ˆF 1
k (v) :=

ˆF 2
k (v) :=

βk) + ˆf (v + βk)

βk)

2

−
2i

ˆf (v + βk)

,

.

By change of variables, we obtain

Sk =

∞

r2

e−

ψ

r

Z

−∞

(cid:18)

(cid:18)
(2l+1) ˜T

1)l

=

(
−
Z
Xl
∈

(2l

Z

−

1) ˜T

xo

θ
·
√T

−
F 1

π
2

+

t

cos

r

(cid:19)

(cid:18)

x

αk ·
√T
t
(cid:19)
−
(2l+2) ˜T

−

θ
·
√T

ψ

r

(cid:18)

xo

t

(cid:19)

−

sin

r

(cid:18)

x

αk ·
√T
−

t

dr

(cid:19)(cid:19)

k (r)dr +

1)l

(
−

Z
Xl
∈

2l ˜T

Z

F 2

k (r)dr.

Since the functions F 1

k are even and F 2

k are odd, we obtain that

Sk =

∞

F 1

k (r)dr

Z

−∞

3 ˜T

2

−

˜T
Z Z
Xl
∈

k (4l ˜T + r)dr + 2
F 1

2 ˜T

0

Z Z
Xl
∈

k (4l ˜T + r)dr.
F 2

(4.21)

FINITE-TIME 4-EXPERT PREDICTION PROBLEM

27

Also it can be seen that

Lk =

2 ˜T
π  

(
−
Z
Xl
∈

1)lF 2

k ((2l + 1) ˜T ) +

(
−
Z
Xl
∈

1)lF 1

k (2l ˜T )

!

.

(4.22)

Step 1: J =

. We prove the inequality

i1, i2}
{

According to trigonometric formulas, we have the following equalities

∂tuT (t, x) +

1
2

∂xi1
(cid:16)

2

+ ∂xi2

(cid:17)

u(t, x)

0.

≤

(4.23)

α1 ·

α3 ·

sin

sin

(cid:18)

(cid:18)

·

θ

θ

xoπ(l + 1/2)
xo
xoπ(l + 1/2)
xo
α1 ·
θ
·
α3 ·
θ
·

xoπl
xo
xoπl
xo

(cid:18)

(cid:18)

·

cos

cos

(cid:19)

(cid:19)

(cid:19)

= sin

= sin

= cos

= cos

(cid:18)

(cid:18)

(cid:18)

(cid:19)

(cid:18)

α2 ·

α4 ·

θ

xoπ(l + 1/2)
xo
xoπ(l + 1/2)
xo

·

,

,

(cid:19)

(cid:19)

θ
·
xoπl
xo
xoπl
xo

α2 ·
θ
·
α4 ·
θ
·

(cid:19)

,

.

(cid:19)

Therefore we have L1 = L2, L3 = L4. Plugging in (4.19), (4.20) and noting that ∂xi1
∂xi2

, it can be checked that

xo) = 1
√2

(θ

·

xo) =

(θ

·

∂tuT (t, x) +

1
2

∂xi1
(cid:16)

+ ∂xi2

2

(cid:17)

u(t, x) =

1
2(T

16

4

1
2

Xk=1 (cid:18)
(4L1 −

L4).

t)  

−
1

+

p
16

2(T

t)

−
(L1 −

t)

=

4

1
p
2(T

−

(αk,1 + αk,2)2

Sk

−

1
(cid:19)

!

4L4)

Let us introduce

πα1 ·
4θ
·
and the Jacobi-theta function

µ :=

xo
xo +

π
4

,

ν :=

p
πα4 ·
4θ
·

xo
xo +

π
4

,

ˆτ :=

(T

4 (θ

−

·

t)iπ
xo)2 ,

θ3 (z, τ ) :=

∞

exp

πil2τ + 2ilz

.

We rewrite sine and cosine terms as

Xl=
−∞

(cid:0)

(cid:1)

1)l sin

(
−

α1 ·

(cid:18)
1)l cos

(
−

θ

xoπ(l + 1/2)
xo
·
α1 ·
θ
·

xπl
xo

(cid:18)

Re e2i(2l+1)µ,

=

−

(cid:19)

=

Re e4ilµ.

−
t)(πl)2
xo)2 . Then according to the deﬁnition of L1, we obtain that

−

(cid:19)

·

(T

−
4(θ

Note that exp(πil2ˆτ ) = e−

L1

√T

t

−

=

−

Re θ3(µ, ˆτ )

xo

θ

·

=

−

θ3(µ, ˆτ )
xo ,
θ

·

28

and

ERHAN BAYRAKTAR, IBRAHIM EKREN, AND XIN ZHANG

Therefore, we obtain

∂tuT (t, x) +

and (4.23) is equivalent to

L4

√T

t

−

=

−

θ3(ν, ˆτ )
xo .
θ

·

1
2

∂xi1
(cid:16)

+ ∂xi2

2

(cid:17)

u(t, x) =

1
4√2

θ3(µ, ˆτ )
θ

−

θ3(ν, ˆτ )

−
xo
·

,

(4.24)

Taking q = eiπˆτ , we have the inﬁnite product representation for the Jacobi-theta function (see e.g.
[15])

θ3 (µ, ˆτ )

θ3 (ν, ˆτ )

0.

(4.25)

−

≤

θ3 (z, ˆτ ) =

∞

1
Yl=1 (cid:16)

−

q2l

1 + 2q2l

−

1 cos(2z) + q4l

−

2

.

(4.26)

(cid:17) (cid:16)

(cid:17)

By the deﬁnition of µ, ν, it can be easily checked that

µ

−

ν =

x(4)
x(3)

x(1)
π
−
x(1) + x(2)
(cid:0)
−
x(2)
x(1)
π
−
x(1) + x(2)
2
(cid:0)
(cid:0)
and hence dist(µ, Zπ) > dist(ν, Zπ). Subsequently, we have cos(2µ)
conclude (4.25) by (4.26).

x(4) ∈
x(3) + x(4)
x(4)
x(3)

π
2 ∈

µ + ν =

(0, π),

−
−

(cid:1)
(cid:1)

(cid:1)
−

−

+

(0, π),

cos(2ν), and therefore

≤

Step 2: J =

. According to the Poisson summation formula for Fourier transform (see e.g.
∅

[17]), it can be seen that

k (4l ˜T + r) =
F 1

Z
Xl
∈

Z
Xl
∈

k (4l ˜T + r) =
F 2

Z
Xl
∈

Z
Xl
∈

1
4 ˜T

ˆF 1
k

1
4 ˜T

ˆF 2
k

(cid:18)

(cid:18)

l
4 ˜T (cid:19)
l
4 ˜T (cid:19)

ei2π l

4 ˜T

r,

ei2π l

4 ˜T

r .

Then according to (4.21),

Sk = ˆF 1

k (0)

1
2 ˜T

−

ˆF 1
k

l
4T

Z
Xl
∈

(cid:18)
2l + 1
4 ˜T (cid:19)

(cid:18)
2l + 1
4 ˜T

ei2π l

4 ˜T

rdr +

3 ˜T

˜T

(cid:19) Z
2

(2l + 1)π −

1)l+1βk

+ (

−

(cid:19)

ˆF 2
k

(cid:18)

Z
Xl
∈
2
(2l + 1)π

.

=

=

(
−
Z
Xl
∈
(
−
Z
Xl
∈

1)l ˆF 1
k

1)l ˆf

(cid:18)

2 ˜T

0

ei2π l

4 ˜T

rdr

1
2 ˜T

Z
Xl
∈
2l + 1
4 ˜T (cid:19)

ˆF 2
k

(cid:18)

l
4 ˜T (cid:19) Z
2
i(2l + 1)π

FINITE-TIME 4-EXPERT PREDICTION PROBLEM

29

By direct computation,

1
2 ˜T

ˆF 1
k

−

l
4T

(cid:18)

3 ˜T

˜T

(cid:19) Z

ei2π l

4 ˜T

2 ˜T

1
2 ˜T

ˆF 2
k

l
4 ˜T (cid:19) Z

0

(cid:18)

Therefore, we obtain that

rdr = 


rdr =

4 ˜T

ei2π l

1)l ˆF 1
k

Sk =

(
−
Z
Xl
∈

1)l ˆf

=

(
−
Z
Xl
∈

=2

1)l ˆf

(
−

2l + 1
4 ˜T (cid:19)
2l + 1 + (

(cid:18)

2

(2l + 1)π −

1)l+14 ˜T βk

−
4 ˜T

−
4 ˜T

!
1)l+14 ˜T βk

2l + 1 + (

0
Xl
≥
where the last equation follows from the identity

ˆF 1
k (0),
1)(l

−

(
−
0,

1)/2 ˆF 1
k

l
4 ˜T

2
lπ ,

if l = 0,

if l is odd,

(cid:16)

(cid:17)

if l is even,

ˆF 2
k

l
4 ˜T

2
ilπ ,

(cid:16)

(cid:17)

if l is odd,

if l is even.

−
0,






ˆF 2
k

2l + 1
4 ˜T (cid:19)

(cid:18)

2
i(2l + 1)π

Z
Xl
∈

2
(2l + 1)π

2
(2l + 1)π

,

(4.27)

!

1)l ˆf

(
−

2l + 1 + (

1)l+14 ˜T βk

−
4 ˜T

2
(2l + 1)π

= (

−

1)−

l

1 ˆf

−

2l

−

−

1 + (
−
4 ˜T

!

1)−

l4 ˜T βk

2

!

2l

(
−

−

1)π

.

Denoting

η1 := 4 ˜T β1 =

η4 := 4 ˜T β4 =

−

−

α1 ·
θ
·
α4 ·
θ
·

xo
xo =
xo
xo = −

x(2)
3x(1)
−
−
x(4) + x(3)
−
x(1)
x(2)
−
x(4) + x(3)

,

−
−

x(4)
x(1)

x(3)
x(2)
x(3) + 3x(4)
x(2)

x(1)

,

−
−

−

it can be easily checked that they satisfy the constraints

η1 ∈

[
−

3,

−

1],

η4 ∈

[1, 3],

η4 −

η1 ≤

4.

Since ∂tuT (t, x) =

1
−
16√2(T

4

t)

−

k=1
P

Sk, the inequality

∂tuT (t, x)

0.

≤

(4.28)

(4.29)

 
 
 
 
30

ERHAN BAYRAKTAR, IBRAHIM EKREN, AND XIN ZHANG

4

is equivalent to

Sk ≥
4 ˜T β4 = 2. Therefore we obtain the equations

k=1
P

0. Due to deﬁnitions of ˜T and βk, we have that 4 ˜T β1 + 4 ˜T β2 =

2, 4 ˜T β3 +

−

S1 + S2 =2

0
Xl
≥

+ 2

1)l ˆf

(
−

(cid:18)

2l + 1 + (
−
4 ˜T

1)l+1η1

2
(2l + 1)π

2l + 1 + (

−

(cid:19)
1)l+1(
4 ˜T

−

η1)

2

−

2
(2l + 1)π

(cid:19)

1)l ˆf

(
−

(cid:18)

2

0
Xl
≥

(4l + 1)π −

=2

0 (cid:18)

Xl
≥

2
(4l + 3)π

ˆf

(cid:19) (cid:18)

(cid:18)

η1

4l + 1
−
4 ˜T

+ ˆf

(cid:19)

(cid:18)

4l + 3 + η1
4 ˜T

(cid:19)(cid:19)

,

(4.30)

S3 + S4 =2

0
Xl
≥

+ 2

1)l ˆf

(
−

(cid:18)

2l + 1 + (
−
4 ˜T

2l + 1 + (

1)l+1η4

(cid:19)
1)l+1(2
−
4 ˜T

2
(2l + 1)π

η4)

−

2
(2l + 1)π

(cid:19)

(
−

1)l ˆf

(cid:18)
2

0
Xl
≥

=

2

−

(4l

−

1)π −

0 (cid:18)

Xl
≥

2
(4l + 1)π

ˆf

(cid:19) (cid:18)

(cid:18)

4l

−

1 + η4
4 ˜T

+ ˆf

(cid:19)

(cid:18)

η4

4l + 1
−
4 ˜T

(cid:19)(cid:19)

.

(4.31)

It is obvious that S1 + S2 ≥
and hence the inequalities

0. As a result of (4.28), we obtain that 0

1 + η4 ≤

5

η4 ≤

−

≤ −

3 + η4,

ˆf (

−

2
1)π −

−

2
(4l+1)π

1 + η4)

≥
π < 4
π

−

= 4

(cid:17)

ˆf (5

η4)

−

≥

ˆf (3 + η4) .

π , we get that

Noting that 2 ∞
l=1
P
S3 + S4 =

(4l

(cid:16)
8
π

2

−

Xl=1 (cid:18)
−

ˆf

8
π

≥

(cid:18)

2
(4l + 1)π

(4l

−

1)π −

π)

(4

−
π

−

ˆf

(cid:18)

(cid:18)

4l

ˆf

−

1 + η4
4 ˜T

(cid:18)
(cid:19) (cid:18)
3 + η4
4 ˜T (cid:19)

5

+ ˆf

(cid:18)

+ ˆf

(cid:19)
η4
−
4 ˜T (cid:19)(cid:19)

η4

4l + 1
−
4 ˜T

(cid:18)

(cid:19)(cid:19)

0,

≥

ˆf

−

(cid:18)

∞

1 + η4
4 ˜T (cid:19)
2

1 + η4
4 ˜T (cid:19)
0.

4

and hence

k=1
P
Step 3: J =

ih}
{

Sk ≥

S3 + S4 ≥

. In the end, we prove the following inequality for each h = 1, 2, 3, 4,

∂tu(t, x) +

−

1
2

∂2
xih xih

u(t, x)

0.

≤

(4.32)

Recalling in (4.22), we have

Lk =

2 ˜T
π  

(
−
Z
Xl
∈

1)lF 2

k ((2l + 1) ˜T ) +

(
−
Z
Xl
∈

1)lF 1

k (2l ˜T )

!

.

FINITE-TIME 4-EXPERT PREDICTION PROBLEM

31

Applying Poisson summation formula, we obtain that

1)lF 2

k ((2l + 1) ˜T ) =2

k ((4l + 1) ˜T ) =
F 2

(
−
Z
Xl
∈

1
2 ˜T

ˆF 2
k

l
4 ˜T (cid:19)

(cid:18)

ei πl

2

Z
Xl
∈
ei π(2l+1)

2

Z
Xl
∈

=

=

Z
Xl
∈
1
4 ˜T

1
2 ˜T

ˆF 2
k

(
−
Z
Xl
∈

2l + 1
4 ˜T (cid:19)
ˆf

(cid:18)

(cid:18)

(cid:18)

1)l

2l + 1

4 ˜T −

βk

−

(cid:19)

2l + 1
4 ˜T

ˆf

(cid:18)

+ βk

,

(cid:19)(cid:19)

1)lF 1

k (2l ˜T ) =

(
−

Z
Xl
∈

−

Z
Xl
∈

k (2l ˜T ) + 2
F 1

k (4l ˜T )
F 1

1
2 ˜T

ˆF 1
k

Z
Xl
∈
+

l
2 ˜T (cid:19)
(cid:18)
2l + 1

ˆf

4 ˜T −

(cid:18)

Z (cid:18)
Xl
∈

=

=

−

Z
Xl
∈
1
4 ˜T

1
2 ˜T

ˆF 1
k

+ ˆf

Z
Xl
∈
βk

(cid:19)

(cid:18)

l
4 ˜T (cid:19)
(cid:18)
2l + 1
4 ˜T

+ βk

,

(cid:19)(cid:19)

and therefore

Lk =

1
π

ˆf

Z
Xl
∈

2l + 1 + (

1)l+14 ˜T βk

−
4 ˜T

=

2
π

!

ˆf

0
Xl
≥

2l + 1 + (

1)l+14 ˜T βk

−
4 ˜T

.

!

(4.33)

We ﬁrst prove the following three inequalities by direct computation.

S1 ≤
To prove the ﬁrst inequality we write

S2, S3 ≤

S4, S2 ≤

S4.

(
−
Xl
0
≥

S2 −

S1 =

=

Xl
≥
As a result of 0

0 (cid:18)

1)l

4
(2l + 1)π

ˆf

2l + 1 + (

−

2

1)l+1(
4 ˜T

−

η1)

−

ˆf

−

2l + 1 + (
−
4 ˜T

1)l+1η1

(cid:19)(cid:19)

4
(4l + 1)π

+

(cid:18)

(cid:18)
4
(4l + 3)π

ˆf

(cid:19) (cid:18)

(cid:18)

4l + 3 + η1
4 ˜T

−

(cid:19)

(cid:18)
4l + 1
−
4 ˜T

η1

.

(cid:19)(cid:19)

(cid:19)

ˆf

(cid:18)

0,

≥

≤

4l + 3 + η1 ≤
ˆf

4l + 1

η1, we have for every l

−

4l + 3 + η1
4 ˜T

ˆf

(cid:18)

−

(cid:19)

η1

4l + 1
−
4 ˜T

0,

≥

(cid:19)

(cid:18)

and hence we conclude the ﬁrst inequality.

To show the second inequality we compute

S4 −

S3 =

0
Xl
≥

1)l

(
−

4
(2l + 1)π

ˆf

2l + 1 + (
−
4 ˜T

1)l+1η4

2l + 1 + (

1)l+1(2
−
4 ˜T

ˆf

(cid:18)

η4)

−

(cid:19)(cid:19)

=

(4l

1 (cid:18)

Xl
≥

4

−

+

1)π

(cid:18)

(cid:18)
4
(4l + 1)π

−

(cid:19)
η4

ˆf

(cid:19) (cid:18)

(cid:18)

4l + 1
−
4 ˜T

ˆf

(cid:18)

−

(cid:19)

4l

−

1 + η4
4 ˜T

.

(cid:19)(cid:19)

It can be easily seen that ˆf
proved the second inequality.

(cid:16)

η4

4l+1
−
4 ˜T

−

(cid:17)

ˆf

4l

1+η4
−
4 ˜T

(cid:16)

≥

(cid:17)

0 for any l

≥

1, and therefore we have

 
 
32

ERHAN BAYRAKTAR, IBRAHIM EKREN, AND XIN ZHANG

Finally for the third inequality we have

1)l+1η4

ˆf

(cid:18)

−

(cid:19)

2l + 1 + (

−

2

1)l+1(
4 ˜T

−

η1)

−

.

(cid:19)(cid:19)

S4 −

S2 =

For even l

≥

1)l

(
−
Xl
0
≥
0, we have

4
(2l + 1)π

2l + 1
|

ˆf

ˆf

2l + 1 + (
−
4 ˜T

−

(cid:18)
(cid:18)
2l + 3 + η1|
η4| ≤ |
2l + 1
η4
ˆf
−
4 ˜T

−

(cid:19)

(cid:18)

while for odd l

0, since

≥

2l
2l + 1 + η4| ≥ |
|
2l + 1 + η4
4 ˜T

ˆf

(cid:18)

1

−

−

(cid:19)

−
ˆf

, and hence

2l + 3 + η1
4 ˜T

0,

≥

(cid:19)

(cid:18)
η1|
2l

(cid:18)

, we get that

η1

−

1
−
4 ˜T

0.

≤

(cid:19)

Subsequently we conclude the third inequality.

Now we prove (4.32). According to (4.19)and (4.20), we have that

∂tuT (t, x) +

1
2

∂xih xih

uT (t, x) =

1
2(T

16

and therefore the inequality is equivalent to

p

2Sh −

t) (cid:18)

−

3
4

(S1 + S2 + S3 + S4) + L1 −

L4

,

(cid:19)

S4, S3 ≤
We have shown that S1 ≤
inequality for the case h = 4. According to (4.27) and (4.33) can be checked that

3
L1 −
4
S2 ≤

(S1 + S2)

L4 +

(S3 + S4)

2Sh.

(4.34)

≤
S4. Subsequently, it is enough for us to prove the

−

3
4

L4 +

3
4

S3 −

5
4

S4 =

2
π

Xl
≥
+

1 (cid:18)(cid:18)
2
π −

(cid:18)

+

3
(4l + 1)π

+

(4l

5

−

1)π

(cid:19)

3

−

(4l

1)π −

5
(4l + 1)π

ˆf

(cid:19)

(cid:18)

4l

ˆf

−

1 + η4
4 ˜T

(cid:18)
4l + 1
−
4 ˜T

η4

(cid:19)

,

(cid:19)(cid:19)

L1 −

3
4

(S1 + S2) =

2
π −

3
(4l + 1)π

+

3
(4l + 3)π

ˆf

(cid:19) (cid:18)

(cid:18)

η1

4l + 1
−
4 ˜T

+ ˆf

(cid:19)

(cid:18)

4l + 3 + η1
4 ˜T

.

(cid:19)(cid:19)

4l

1 + η4 ≤

4l + 3 + η1 ≤

−

4l + 1

−

η1 for any l

≥

1. Subsequently we

Note that 0
have that

≤

4l + 1

1 (cid:18)
Xl
≥
η4 ≤

−

η4

4l + 1
−
4 ˜T

ˆf

(cid:18)

ˆf

(cid:18)

≥

(cid:19)

4l

−

1 + η4
4 ˜T

ˆf

(cid:18)

≥

(cid:19)

4l + 3 + η1
4 ˜T

ˆf

(cid:18)

≥

(cid:19)

η1

4l + 1
−
4 ˜T

,

(cid:19)

and hence the inequalities

2
π −

3
(4l + 1)π

+

3
(4l + 3)π

(cid:18)

FINITE-TIME 4-EXPERT PREDICTION PROBLEM

33

(cid:19) (cid:18)

(cid:18)

ˆf

η1

4l + 1
−
4 ˜T
6
(4l + 1)π
1 + η4
4 ˜T

−

4
π −
4l

(cid:18)
4
π

ˆf

≤

≤

≤

+

(cid:18)
2
π
2
π −

(cid:18)(cid:18)

+

(cid:18)

(cid:19)

+

3
(4l + 1)π
3

(4l
−
L4 + 3

1)π −
4 S3 −

≤

+ ˆf

4l + 3 + η1
4 ˜T

(cid:19)

+

(cid:18)
6
(4l + 3)π

(cid:19)(cid:19)

4l + 3 + η1
4 ˜T

(cid:19)

ˆf

(cid:19)

(cid:18)

(4l

5

(cid:19)

−

4l

ˆf

1 + η4
4 ˜T
1)π
−
5
4l + 1
−
4 ˜T
(4l + 1)π
4 S4 and also the inequality (4.34). (cid:3)

(cid:18)
ˆf

(cid:19)(cid:19)

η4

(cid:19)

(cid:19)

(cid:18)

5

,

from which we conclude that L1 −

3
4 (S1 + S2)

4.3. Proof of Theorem 3.3.

Proof. The dynamics of state Xm is given by

Take any sequence mM ∈
tm = mT
M , ∆Xm = eJm − 1

−

Xm = Xm

1 + eJm − 1
R4 such that mM T
t,
1, and deﬁne the scaled state

M →

Im
{

Jm

∈

}

1.

N and xmM ∈

Im
{

Jm

∈
xmM

}
√T

√M

˜xmM =

,

˜Xm =

Xm√T
√M

, ∆ ˜Xm =

∆Xm√T
√M

.

xmM

√T
√M →

x as M

. Denote

→ ∞

Step 1: uT (t, x)

uT (t, x). To prove the inequality, we rewrite

≤
(mM , xmM )√T

M

V

√M

−

uT (t, x) =

supβ

∈V

Eα∗(M ),β [Φ(XM )
XmM = xmM ] √T
|
√M
˜XmM = ˜xmM
uT (tmM , ˜XmM )
|

uT (t, x)

−

i

Eα∗(M ),β

= sup
β
∈V
+ uT (tmM , ˜xmM )

h

uT (T, ˜XM )

−
uT (t, x)

M

=

Eα∗(M ),β

sup
β

uT

tm, ˜Xm
h(cid:16)
(cid:16)
uT (t, x).

m=mM +1
X
+ uT (tmM , ˜xmM )

∈V

−

−

uT

tm

−

1, ˜Xm
−

1

(cid:16)

(cid:17)(cid:17)

−

(cid:17)

˜XmM = ˜xmM
|

i

34

ERHAN BAYRAKTAR, IBRAHIM EKREN, AND XIN ZHANG

Note that

Eα,β

uT
h
= Eα,β

h

+ 2Eα,β

+ 2Eα,β

+ Eα,β









T
M

q

0
Z

T
M

tm, ˜Xm
(cid:17)
(cid:16)
∂xuT (tm
−

uT

−
1, ˜xm

−

tm

1, ˜Xm
−

−
(cid:16)
1)⊤ ∆ ˜Xm

˜Xm
|
−

1 = ˜xm

−

1

i

1

(cid:17)

T
M

q

0
Z

 r

T
M −

s

! (cid:18)

i
∂tuT +

1
2

e⊤Jm∂xxuT eJm

(cid:19)

(tm

−

1, ˜xm

−

1 + s∆Xm)ds

T
M −

s

 r

!

(cid:16)

∂tuT (tm
−

1, ˜Xm)

∂tuT (tm
−

−

1, ˜xm

−

∂tuT (tm
−
(cid:16)

1 + s, ˜Xm)

∂tuT (tm
−

−

1, ˜Xm)
(cid:17)

ds

.

#

"Z
0

(⋆)

(4.35)

(4.36)

(4.37)

(4.38)





1 + s∆Xm)

ds

(cid:17)





By the deﬁnition of α∗(M ), the player chooses expert i with probability ∂xiuT (tm
−

round m for all i = 1, 2, 3, 4. Subsequently, we have

1, ˜xm

−

1) at

Eα∗(M ),β

∂xuT (tm
−

1, ˜xm

−

h

1)⊤ ∆ ˜Xm

= Eβ

i

"

4

∂xiuT

Xi=1
e⊤Jm∂xuT

e⊤Jm∂xuT
(cid:16)

4

i
− 1
{

Jm

∈

}

1⊤∂xuT

T
M

# r

(cid:17)

1

∂xiuT

Jm

∈

}

i
{

−

T
M

# r

= 0,

= Eβ

"

where all the partial derivatives of uT are evaluated at (tm
−

Xi=1
1, ˜xm

1).

−

As a result of the solution property of u, the term (4.36) is non-positive. Also, it is easy to ﬁnd

the partial derivatives ∂2

ttu(t, x) and ∂2

txiu(t, x)

ttuT (t, x) = −
∂2

1
16√2

∞

r2e−

(T

−

t)r2

ψ

rθ

xo +

·

π
2

4

(cid:17)

Xk=1

cos (rαk ·

x)

(cid:16)

Z

−∞

ψ (rθ

−

xo)

·

4

Xk=1

sin (rαk ·

x)

!

dr,

txiuT (t, x) =
∂2

1
16√2

Z
+ψ (rθ

∞

(T

re−

−

t)r2

4

αk,i

ψ

rθ

−∞

xo) cos (rαk ·

·

Xk=1
x)) dr.

(cid:16)

(cid:16)

xo +

·

π
2

(cid:17)

sin (rαk ·

x)

According to the boundedness of ψ, sin, cos, we obtain that

(cid:12)
(cid:12)

≤

ttuT (t, x)
∂2
(cid:12)
(cid:12)
∂2
txiuT (t, x)
(cid:12)
(cid:12)

(cid:12)
(cid:12)

1
16√2

∞

8r2e−

(T

−

t)r2

dr =

Z

−∞

1

2

2(T

t)3

−

∞

r2e−

r2

dr

Z

−∞

C

≤

(T

−

,

t)3

1
16√2

≤

∞

6√2re−

(T

−

t)r2

Z

−∞

p
dr

6
16(T

≤

t)

−

∞

re−

r2

dr

Z

−∞

p

≤

T

C

−

,

t

where C is a positive constant independent of (t, x) and is allowed to change from line to line.

 
FINITE-TIME 4-EXPERT PREDICTION PROBLEM

35

Noting that the above estimation is independent of x, we can therefore estimate the bound of

(4.37) and (4.38).

Eα,β

2




0

Z

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

CEα,β

≤

T
M

q

T
M −

s

 r

!

(cid:16)

∂tuT (tm
−

1, ˜Xm)

∂tuT (tm
−

1, ˜xn

−

−

1 + s∆Xm)

ds

(cid:17)

T
M

q



Z

0

 r

T
M

q

T
M −

s

ds

!

s
Z



C
tm

−

−

T
M

q

1 Z
0

 r

T
M −

s

2

!

ds =

≤

T

txuT (tm
∂2
−

1, ˜xm

−

1 + u∆Xm)

du

(cid:12)
(cid:12)

C

(T

tm

−

1)M

−

,

3
2

(cid:12)
(cid:12)





(4.39)

(cid:12)

(cid:12)
(cid:12)
(cid:12)

(cid:12)
(cid:12)

Eα,β
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

T
M

0

"Z

(cid:16)
CEα,β

≤

= CEα,β

T
M

T
M

0

"Z

ds

1, ˜Xm)
(cid:17)

#(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

∂tuT (tm
−

1 + s, ˜Xm)

∂tuT (tm
−

−

s

ds

ttuT (tm
∂2
−

0

Z
(cid:12)
(cid:12)
(cid:12)
T
M −

s

#

du

1 + u, ˜Xm)
(cid:12)
(cid:12)
(cid:12)
1 + s, ˜Xm)
(cid:12)
(cid:12)
(cid:12)

ttuT (tm
∂2
−

"Z

T
M

0 (cid:18)
T
M −
tm

−

s

1 −

−

(T

(cid:19) (cid:12)
(cid:12)
(cid:12)
ds.

3
2

s)

ds

#

(4.40)

C

≤

0

Z

Therefore we obtain that

sup
β

∈V

Eα∗(M ),β

uT

tm, ˜Xm

C

≤

h

(cid:16)

1

(cid:17)

(T

tm

−

−

1)M

3
2

−

+

Let us estimate

uT

tm

1, ˜Xm
−

−

˜Xm
|
−

1 = ˜xm

−

1

i

3
2

s)

ds

.

!

1

(cid:17)
s

T
M −
tm

1 −

−

(cid:16)
T
M

0
Z

(T

−

M

1

Xm=1

(T

tm

−

1)M

−

=

3
2

1

T M

1
2

M

Xk=1

1
k ≤

1

T M

and

M +1/2

1

2 Z

1/2

1
λ

dλ =

ln(M + 1/2)

T M

ln(1/2)

,

−
1
2

M

T
M

0
m=1 Z
X

(T

−

s

T
M −
tm

1 −

−

ds =

3
2

s)

M

1

−

T
M

0
m=1 Z
X
1
M
−

T
M

T

T
M

0

Z
1
3
2

s

≤

=

m=1
X
T
M

Z

s

T
M −
tm

−

1 −
1

(T

T
M

−

(T

tm

−
1
2 r

−
T
M

ds +

s

s)

ds

3
2

T
M

ds +

3
2

s)

0
Z

ds +

3
2

s)

1 −

T
M −
( T
M −
T
M

1
2 r

=

T
M  r

M
T −

1
√T !

+

1
2 r

T
M

.

 
36

ERHAN BAYRAKTAR, IBRAHIM EKREN, AND XIN ZHANG

Thus we conclude that

M

lim
M
→∞

m=1  
X

(T

−

1

tm

≤

lim
M
→∞  

and furthermore

+

3
2

T
M

0
Z

(T

1
√T !

+

1
2 r

−
T
M

+

s

T
M −
tm

−

ds

3
2

s)

!

1 −
ln(M + 1/2)

ln(1/2)

−
1
2

!

= 0,

(4.41)

T M

1)M

−
M
T −

T
M  r

uT (t, x)

−

uT (t, x) =

lim sup
√T
xmM
√M (cid:19)→

(
∞

,t,x)  

M,

mM T
M ,

(cid:18)

M

V

(mM , xmM )√T

√M

−

uT (t, x)

!

≤

M,

(cid:18)

+

lim sup
√T
xmM
√M (cid:19)→

mM T
M ,

,t,x)

(
∞

lim sup
√T
xmM
√M (cid:19)→

M, mM T
M ,

(cid:18)

(
∞

,t,x) (cid:0)

M

C

(T

m=mM +1
X
uT (tmM , ˜xmM )

−

s

T
M −
tm

1 −

−

3
2

s)

ds

!

1

tm

−

1)M

T
M

+

3
2

0
Z

(T

−

uT (t, x)

= 0.

−

(cid:1)

Step 2: uT (t, x)

≥
V M (mM , xmM )√T
√M

uT (t, x). Similarly, we have

uT (t, x)

−

M

inf
α
∈U

=

Eα,

b

J

C

(M )

uT

tm, ˜Xm

m=mM +1
X
+ uT (tmM , ˜xmM )

(cid:16)
h(cid:16)
uT (t, x),

−

uT

−

(cid:17)

tm

−

(cid:16)

1, ˜Xm
−

1

(cid:17)(cid:17)

˜XmM = ˜xmM
|

i

and we need to estimate the conditional expectation (⋆). At round m, the adversary chooses experts

(˜xm

−

JC

1) with probability 1

2 , and

c

(˜xm

1) with probability 1

2 . Therefore we compute

Eα,

b

J

C

(M )

∂xuT (tm
−

1, ˜xm

−

C

J
1)⊤ ∆ ˜Xm

−

h
= Eα

= Eα

1
2
1
2

(cid:20)

(cid:20)

∂xuT

e⊤
JC

(cid:16)

1⊤∂xuT

−

(cid:16)

i

− 1

Im
{

∈JC}

1⊤∂xuT

+

(cid:17)

1
2

c

e⊤
J
C

(cid:16)

1⊤∂xuT

= 0.

(cid:17)(cid:21)

∂xuT

− 1

Im
{

∈J

c
C }

1⊤∂xuT

T
M

(cid:17)(cid:21) r

(4.42)

Since the bounds of (4.37) and (4.38) are the same, it remains to ﬁnd the lower bound of (4.36)
when the adversary adopts the comb strategy. We show that if Jm =
1), then the following
inequality holds

(˜xm

JC

−

∂tuT +

1
2

(cid:18)

e⊤Jm∂xxuT eJm

(tm

1, ˜xm

1 + s∆Xm)

−

−

≥ −

T

Cs
tm

1

,

(4.43)

(cid:19)

−
1 and is allowed to change from line to line. The
1) is the same. To simplify the notation, in the following argument,

−

−

where C is a positive constant independent of ˜xm
proof for the case Jm =
(˜xm
we denote

J
−
1) and ˜xs = ˜xm

(˜xm

1 + s∆Xm.

=

C

c

J

JC

−

−

 
FINITE-TIME 4-EXPERT PREDICTION PROBLEM

37

T
M , then according to Subsection 4.1.4, we have that for any

Note that if ˜x(3)
m
−

1 ≥

˜x(2)
m
−

1 +

s

0,

∈

(cid:20)

T
M

q

(cid:21)

q

∂tuT +

1
2

e⊤
J

∂xxuT e
J

−

(tm

1, ˜xs) = 0,

(4.44)

(cid:18)
which satisﬁes (4.43). Otherwise there exists a unique s0 ∈
˜x(3)
m
−

1 + s0. Then for s

(cid:21)
[0, s0], we still have (4.44), but for s

0,

T
M

q

(cid:19)

∈

(cid:20)

−

1 = ˜x(2)
the deﬁnition of

m

J

such that ˜x(2)

s0 = ˜x(3)

s0 , i.e.,

s0,

T
M

, according to

∈

(cid:20)

q

(cid:21)

, the adversary actually selects the ﬁrst two leading experts. Recall (4.24),

∂tuT +

1
2

e⊤
J

∂xxuT e
J

(cid:18)

(tm

−

1, ˜xs) =

(cid:19)

θ3(νs, ˆτs)

−
4√2θ

θ3(µs, ˆτs)
˜xo
s

·

,

(4.45)

where

,

+

µs :=

˜xo
πα1 ·
s
˜xo
4θ
s
·

π
4
s0 , it can be easily checked that µs0 −

tm
−
s)2
˜xo
Since ˜x(2)
νs0 = π. According to the deﬁnition of
Jacobi-theta function, θ3(z + π, τ ) = θ3(z, τ ) and hence θ3(µs0, ˆτs0) = θ3(νs0, ˆτs0). Let us calculate
µs −

s0 = ˜x(2)

iπ(T
4 (θ

˜xo
πα4 ·
s
˜xo
4θ
s
·

νs for s

νs :=

ˆτs :=

−
·

π
4

s0,

1)

+

.

,

≥
µs −
Then we have the estimation

νs =

π
4

α1 ·

(cid:18)

˜xo
s0 −
θ
·

2(s
˜xo
s

s0)

−

α4 ·

−

˜xo
s0 + 2(s
˜xo
s

θ

·

s0)

−

= π

(cid:19)

π(s
θ

−

s0)

−
˜xo
s
·

.

s0)

π(s
θ

(cid:19)

=

=

−

, ˆτs

(cid:18)
∞

µs +

θ3(νs, ˆτs)
|

θ3(µs, ˆτs)
|

−
˜xo
s
·
iπˆτsn2

θ3
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
n=
(cid:12)
(cid:12)
(cid:12)
(cid:12)
≤ (cid:12)
n=
(cid:12)
(cid:12)
(cid:12)
(cid:12)
To ﬁnish prooﬁng (4.43), we need an auxiliary result

(cid:0)
iπˆτsn2

2nπ(s
θ

X
∞

exp

exp

X

cos

−∞

−∞

(cid:18)

(cid:1)

(cid:0)

(cid:1)

·

−

θ3(µs, ˆτs)
(cid:12)
(cid:12)
(cid:12)
π(s
(cid:12)
θ

µs +

2n

(cid:18)

(cid:18)

s0)

−
˜xo
s

.

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

s0)

−
˜xo
s (cid:19)(cid:19)
·

−

cos(2nµs)

(cid:19)(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(4.46)

According to the inequality,

sup
λ>0  

∞

n2λ

nλe−

Xn=1

= C < +

.

∞

!

(4.47)

∞

n2λ

nλe−

nλe−

nλ =

≤

∞

Xn=1

λeλ

(eλ

−

1)2 ,

Xn=1
nλe−

nλe−

n2λ <

∞

we conclude that lim
→∞

λ

to show that lim sup

∞

n=1
P

∞

λ

→
∞1

0
n=1
P
tλe−

of the integral

R

n2λ = 0 and λ

∞

nλe−

n2λ is continuous over R>0. It remains

7→

n=1
P
. Fix λ > 0, we can view ∞
n=1
t2λ is increasing over
P

nλe−

tλe−

7→

n2λ as the Riemann sum

t2λdt. It can be easily seen that t

0,

1
√2λ

and

h

i

38

ERHAN BAYRAKTAR, IBRAHIM EKREN, AND XIN ZHANG

1
decreasing over
√2λ
Then we obtain that

h

,

∞

i

. Take I(λ) to be largest integer that is smaller than or equal to

1
√2λ

.

I(λ)

−

1

n=1
X
∞

XI(λ)+2

n2λ

nλe−

≤

0

Z

I(λ)

tλe−

t2λdt,

n2λ

nλe−

∞

≤

Z

I(λ)+1

tλe−

t2λdt,

and therefore

∞

n2λ

nλe−

Xn=1

≤

≤

I(λ)λe−

I(λ)2λ + (I(λ) + 1)λe−

(I(λ)+1)2λ +

∞

tλe−

t2λdt

I(λ)λe−

I(λ)2λ + (I(λ) + 1)λe−

(I(λ)+1)2λ +

1
Z
1
2

e−

λ.

As a result of I(x) =

1
√2λ

, we conclude that

k
j
lim sup

0

λ

→

∞

n2λ

nλe−

n=1
X

≤

2 lim
0
λ
→

λ
√2λ

e−

1
2 + lim
0
λ
→

1
2

e−

λ =

1
2

.

Taking λ = π2(T
4(θ

tm
−
−
s)2
˜xo
·

1)

in (4.47), and combining (4.45),(4.46), (4.47), we obtain that

∂tuT +

(cid:18)

1
2

e⊤
J

∞

∂xxuT e
J

(tm

1, ˜xs) =

−

θ3(νs, ˆτs)

−
4√2θ

(cid:19)
iπˆτsn2

exp

(cid:0)

(cid:1)

2nπ(s
(θ

·

s0)

−
s)2 ≥ −
˜xo

θ3(µs, ˆτs)
˜xo
s
s0)

∞

·
C(s
T

−

−
tm

−

1

n=1
X

≥ −

and hence

n=

X

−∞

n2λ

nλe−

≥ −

T

Cs
tm

−

,

1

−

Eα,

J

T
M

q

0
Z





≥ −

T

T
M −

s

 r

! (cid:18)

∂tuT +

1
2

e⊤Jm∂xxuT eJm

(cid:19)

(tm

−

1, ˜xm

−

1 + s∆Xm)ds





C
tm

−

−

T
M

q

1 Z
0

 r

T
M −

s

!

sds

≥

(T

−

C
1)M 3/2 .

−
tm

−

In conjunction with (4.39), (4.40), (4.41) and (4.42), we obtain that

inf
α
∈U

Eα,

b

J

C

(M )

uT

h

tm, ˜Xm
(cid:16)

1

−

(cid:17)

C

≥ −

(T

tm

−

−

1)M

3
2

uT

tm

−

1, ˜Xm
−

1

+

(cid:16)
T
M

0

Z

(T

−

(cid:17)
s

T
M −
tm

1 −

−

˜Xm
|
−

1 = ˜xm

−

1

i

3
2

s)

ds

,

!

 
FINITE-TIME 4-EXPERT PREDICTION PROBLEM

39

and ﬁnally

uT (t, x)

−

uT (t, x) =

M,

mM T
M ,

(cid:18)

lim inf
√T
xmM
√M (cid:19)→

(
∞

,t,x)  

V M (mM , xmM )√T
√M

−

uT (t, x)

!

≥

M,

mM T
M ,

(cid:18)

lim inf
√T
xmM
√M (cid:19)→

−

,t,x)

(
∞

+

M,

mM T
M ,

(cid:18)

lim inf
√T
xmM
√M (cid:19)→

,t,x)

(
∞

(cid:0)

M

C

(T

m=mM +1
X
uT (tmM , ˜xmM )

1

tm

−

1)M

T
M

+

3
2

0

Z

uT (t, x)

= 0.

−

−

(cid:1)

(T

−

s

T
M −
tm

1 −

−

ds

!

3
2

s)

(cid:3)

4.4. Proof of Proposition 3.1.

Proof. The estimates in [11, Theorem 4] allows us to claim that there exists a constant C > 0 so
that for all T > 0 and (t, x)

[0, T ]

RN ,

−
Thus, the function v deﬁned by the expression (3.11)

| ≤

∈

×
uT (t, x)
|

C(T

t + 1 +

x
|

).
|

v(x) := E

∞

e−

T Φ(X 0,x

T )dT

=

(cid:21)

0
Z

0
(cid:20)Z

∞

e−

T uT (0, x)dT.

has at most linear growth and due to (3.10) it is C 2. The optimality of comb strategies implies
that for all T > 0 and (t, x)

[0, T )

RN ,

∈
×
xxuT (t, x)eJ =
e⊤J ∂2

1
2

sup
P (N )

∈

J

1
2

e⊤
JC

(x)∂2

xxuT (t, x)e

JC

(x) =

−

∂tuT (t, x).

Equation (3.10) and the optimality of comb strategies imply that

1
2

sup
P (N )

∈

J

e⊤J ∂2

xxv(x)eJ ≥

1
2

e⊤
JC

(x)∂2

xxve

JC

=

∞

e−

0
Z

T 1
2

sup
P (N )

∈

J

e⊤J ∂2

xxuT (0, x)eJ dT

(x) ≥
1
2

≥

∞

e−

T 1
2

e⊤
JC

0

Z

(x)∂2

xxuT (0, x)e

JC

(x)dT

e⊤J ∂2

xxv(x)eJ .

sup
P (N )

∈

J

Thus, using the fact that for some function u♯, uT (t, x) = u♯(T
RN , all the inequalities above are equalities and
[0, T ]

t, x) for all T > 0 and (t, x)

−

∈

e⊤J ∂2

xxv(x)eJ =

sup
P (N )

∈

J

−

0

Z

∞

e−

T ∂tuT (0, x)dT =

∞

e−

T uT (0, x)dT

0
Z

u0(0, x) = v(x)

−

Φ(x).

−

Given the uniqueness of viscosity solution with linear growth for (3.8) proven in [9, Theorem 5.1]
(cid:3)
v = u and comb strategies are indeed optimal for the problem (3.8).

×

1
2

 
40

ERHAN BAYRAKTAR, IBRAHIM EKREN, AND XIN ZHANG

Appendix A. Solutions from Inverse Laplace Transform

A.1. A heuristic derivation for N = 4. We derive the solution of (1.1) when there are 4 experts.
From [4, Proposition 6.1], the solution of the linear PDE

u(x)

1
2

e⊤
JC

−

(x)∂2u(x)e

JC

(x) = Φ(x),

(A.1)

is given by

u(x) =x(4)

√2
4

−

sinh(√2(x(4)

+

1
4√2

arctanh

xo

·

eθ
(cid:16)

(cid:17)

sinh (αk ·

xo) .

Xk=1

x(3))) +

1
4√2

arctan

xo

·

eθ
(cid:16)

4

(cid:17)

Xk=1

cosh (αk ·

xo)

−

4

It is well-known that an elliptic PDE can be solved by applying the Laplace transform to the
corresponding parabolic one. Here, to obtain the solution to (3.2), we formally compute the inverse
Laplace transform of (A.1). It can be easily checked that for λ

R+

uλ(x) = λ−

3/2u(√λx)

∈

solves the equation

λuλ(x)

1
2

−

We formally extend the function λ
Applying the inverse Laplace transform for t

7→

(x)∂xxuλ(x)e

e⊤
JC
uλ(x) to the complex plane with R

(x) = Φ(x).

JC

as its branch cut.

−

u#(t, x) =

1
2πi

∈

R+,
x0+i

x0

i

−

∞

Z

∞

etλuλ(x)dλ,

(A.2)

should solve the PDE, at least heuristically,

∂tu#(t, x)

1
2

e⊤
JC

−

(x)∂2

xxu#(t, x)e

(x) = 0,

JC
u#(0, x) = Φ(x),

where x0 is chosen so that the function to integrate is analytic on the line of integration. Now the
solution of (3.2) is given by

uT (t, x) = u#(T

t, x).

−

Let us compute (A.2). Since the functions arctan, arctanh can be extended to the complex plane

via the formulas,

arctan(z) =

1
2i

log

i
z
−
i + z

(cid:18)

(cid:19)

,

arctanh(z) =

1
2

log

1 + z
z
1

−

,

(cid:19)

(cid:18)

FINITE-TIME 4-EXPERT PREDICTION PROBLEM

41

γ1

γ1 :=

Reiθ : θ
{

γ2 :=

Reiθ : θ
{

∈

∈

[π/2

−

arcsin(1/R), π

arcsin(ǫ2/R)]
}

−

[π + arcsin(ǫ2/R), 3π/2 + arcsin(1/R)]
}

l1

l2

γǫ

l1 :=

(t, ǫ2) : t
{

[
−

∈

R cos

arcsin(ǫ2/R)

,

ǫ cos (arcsin(ǫ))]
}

−

l2 :=

(t,
{

−

ǫ2) : t

[
−

∈

(cid:0)
R cos

(cid:1)
arcsin(ǫ2/R)

,

ǫ cos (arcsin(ǫ))]
}

−

γǫ :=

ǫeiθ : θ
{

[
−

∈

(cid:0)

π + arcsin(ǫ), π

(cid:1)
arcsin(ǫ)]
}

−

γ2

Figure 3. Contour of inverse Laplace transform

we obtain that

u(x) =x(4)

√2
4

−

sinh(√2(x(4)

x(3))) +

−

1
8i√2

log

eθ
i
−
i + eθ

xo

xo

·

·

(cid:18)

4

(cid:19)

Xk=1

cosh (αk ·

xo)

+

1
8√2

log

1 + eθ
eθ
1

−

xo

xo

·

·

(cid:18)

(cid:19)

4

Xk=1

To cancel the singularity at λ = 0, we rewrite

sinh (αk ·

xo) .

(A.3)

u#(t, x) =

=

1
2πi

1
2πi

x0+i

∞

Z

x0

i
∞
−
x0+i

∞

x0

Z

i

−

∞

etλ u(√λx)
−
λ3/2
etλ u(√λx)
−
λ3/2

u(0)

dλ +

u(0)
2πi

u(0)

dλ +

1
2 r

Z
tπ
2

x0+i

∞

x0

i

−

∞

etλ 1
λ3/2

dλ

,

(A.4)

where we use the facts that u(0) = π
, and the inverse Laplace transform of
4√2
x0 = 1, ǫ > 0, R > 0, and the contour in Figure 3. The integral of etλ(u(√λx)
the contour is zero. Letting R
γ2 vanish, we obtain that

√π . Take
3
2 along
0, and assuming that the limit of the integral along γ1,

λ3/2 is 2√t
u(0))/λ

→ ∞

, ǫ

→

−

1

1
2πi

x0+i

∞

x0

Z

i

−

∞

etλ u(√λx)
−
λ3/2

u(0)

dλ =

−

(R,ǫ)

lim
(
∞
→

,0)

1
2πi

Zγǫ+l1+l2

etλ u(√λx)
−
λ3/2

u(0)

dλ.

It can be seen that

(R,ǫ)

lim
(
∞
→

,0)

=

1
2πi

1
2πi

0

Z

−∞

etλ u(√λx)
−
λ3/2

u(0)

dλ

Zl1+l2
etλ u(√λx)
λ

−
3
2

u(0)

dλ +

−∞

etλ u(√λx)
λ

−
3
2

u(0)

dλ,

0
Z

(A.5)

42

ERHAN BAYRAKTAR, IBRAHIM EKREN, AND XIN ZHANG

where the ﬁrst integral is above the branch R
reduces to

−

and the second below. Thus the computation

∞

e−

tr u(i√rx) + u(

i√rx)
−
3
r
2

2u(0)

−

dr =

1
2π

0

Z
1
16√2

cos

√rαk ·
(cid:0)

xo

4

−

(cid:1)

4

Xk=1
xo

∞

tr

e−
r3/2  

0
Z

log

1
iπ  
xo

ei√rθ
i
i + ei√rθ

−

xo

xo

·

·

!

+ log

i
e−
−
i + e−

i√rθ

i√rθ

xo

xo

·

·

!!

1
iπ  

−

log

1 + ei√rθ
ei√rθ
1

·

−

xo

·

! −

log

1 + e−
e−
1

−

i√rθ

i√rθ

xo

xo

·

·

!!

4

sin

Xk=1

(cid:0)

√rαk ·

dr.

!
(cid:1)

For some values of r depending on x, the ﬁrst two log are respectively
cancel each other. Due to the factorizations

∓∞

ei√rθ
i
i + ei√rθ

−

1 + ei√rθ
ei√rθ
1

−

xo
xo =

xo
xo =

·

·

·

·

and the identities

i
e

π

4 + √rθ

·
2

(cid:16)−

·
2

π

4 + √rθ
xo

π
4 −

√rθ
·
2

π
4 −

√rθ
·
2

i
e

(cid:16)

i
e

(cid:16)

xo

√rθ
·
2

xo

√rθ
·
2

i
e

i
e

(cid:16)−

(cid:16)−

xo

xo

(cid:17) −
i
(cid:17) + e
i
(cid:17) + e
i
e

(cid:16)

(cid:16)

(cid:17)

−

(cid:16)−
√rθ
·
2

√rθ
·
2

=

xo

(cid:17)

(cid:17)

i tan

−

1
√rθ
·
2

xo

,

(cid:16)

(cid:17)

xo

xo

(cid:17)

(cid:17)

= i tan

xo

π
4 −

√rθ
2

·

,

(cid:19)

(cid:18)

. But heuristically they

log



tan

i
√rθ
·
2

xo



−

log



tan

i
−
√rθ
·
2

xo



= iπsign

tan

(cid:18)

(cid:18)

xo

√rθ
2

·

log

i tan

(cid:18)

(cid:18)

π
4 −


√rθ
2

·

(cid:16)

xo

(cid:17)
+ log



i tan

(cid:19)(cid:19)

(cid:18)


π
4

(cid:18)

+

(cid:16)
√rθ
2

·



(cid:17)

xo

(cid:19)(cid:19)

= iπsign

tan

(cid:18)

(cid:18)

π
4

+

it can be checked that the integral (A.5) becomes

,

(cid:19)(cid:19)
xo

√rθ
2

·

1
16√2

∞

tr

e−
r3/2  

0
Z

sign

tan

(cid:18)

−

sign

tan

(cid:18)

(cid:18)

xo

√rθ
2

·

π
4

+

√rθ
2

·

xo

4

cos

√rαk ·
(cid:0)

xo

4

−

(cid:1)

(cid:19)(cid:19)

Xk=1

(cid:18)
4

sin

√rαk ·

xo

(cid:0)

dr.

!

(cid:1)

(cid:19)(cid:19)

Xk=1

,

(cid:19)(cid:19)

(A.6)

According to [4, Equation (3.4)], we have lim
0
→

λ

u(λx)
−
λ

u(0)

= 1

4 (x1 + x2 + x3 + x4), and therefore

1
2πi

lim
0
ǫ
→

Zγǫ

etλ u(√λx)
λ

−
3
2

u(0)

dλ = −

1
2πi
1
4

−

=

2π

etǫeiθ u(√ǫeiθx)
ǫeiθ

−
1
2

u(0)

idθ

lim
0
ǫ
→

0

Z

(x1 + x2 + x3 + x4).

 
 
 
 
FINITE-TIME 4-EXPERT PREDICTION PROBLEM

43

In conjunction with (A.4) and (A.6), we get that

u#(t, x) = −

1
16√2

∞

tr

e−
r3/2  

0
Z

sign

tan

(cid:18)

xo

·

(cid:19)(cid:19)

√rθ
2

π
4

+

√rθ
2

·

xo

4

(cid:19)(cid:19)

Xk=1

(cid:18)
4

cos

sin

√rαk ·

xo

dr +

√rαk ·
(cid:0)
1
4

4

xi +

xo

4

−

(cid:1)
1
2 r

tπ
2

tan

sign

(cid:18)

(cid:0)
rθ

+

xo

·
2

Xk=1
π
4

(cid:18)

4

!

4

(cid:1)

Xi=1
cos (rαk ·

xo)

4

−

(cid:19)(cid:19)

Xk=1

4

sign

tan

−

(cid:18)

∞

0

Z

(cid:18)
tr2

e−
r2

= −

1
8√2

rθ

sign

1
2 r
where the last equality follows from the change of variable. Since uT (t, x) = u#(T
(1.2).

sin (rαk ·

xi +

dr +

Xi=1

Xk=1

xo)

(cid:19)(cid:19)

tan

1
4

·
2

!

−

(cid:18)

(cid:18)

−

tπ
2

,

xo

t, x), we obtain

A.2. Explicit expressions for N = 3. According to [11, Theorem 8], the value function in the
geometric stopping case is given by

u(x) = x(3) +

1
2√2

e√2(x(2)

x(3)) +

−

1
6√2

e√2(2x(1)

−

x(2)

x(3)),

−

(A.7)

which solved (3.8) with N = 3. We compute the inverse Laplace transform

u#(t, x) =

x0+i

∞

etλλ−

3/2u(√λx)dλ,

1
2πi

x0

i

−
3
2 naturally to C
. The inverse Laplace transform
where we extend the function λ
of 1
respectively, where erf c is the complementary error
function (see e.g. [2]). Subsequently according to the convolution theorem, it can be easily checked
that

√s and e−

and erf c

s , 1

are 1,

1
√πt

a
2√t

a√s
s

7→

R

(cid:16)

(cid:17)

∞

\

−

Z
u(√λx)/λ

u#(t, x) = x(2) +

1
3

(2x(1)

x(2)

−

−

x(3)) +

(2x(1)

x(2)
2t

−

−

x(3) )2

√te −

3√2π

√te√t −

(x(2)

−
2t

x(3))2

√2π

+

1
3√π

−

(2x(1)

x(2)

−

−

x(3))

∞
2x(1)

Z

x(2)
√2t

−

−

x(3)

y2

e−

dy

1
√π

−

(x(2)

x(3))

−

Z

∞
x(2)

x(3)

−
√2t

y2

e−

dy.

Then uT (t, x) := u#(T

−

t, x) is our conjectured solution to (1.1) with N = 3.

Proposition A.1. The explicit solution to Equation (1.1) with N = 3 is given by

uT (t, x) := x(2) +

1
3

(2x(1)

x(2)

−

x(3)) +

√T

−

(2x(1)

x(2)
t)

−
2(T

−

−

te −

x(3) )2

3√2π

−
x(3))2
t)

(x(2)
2(T

−
−

√T

+

−

te

√T

t −

−
√2π

1
√π

−

(x(2)

x(3))

−

y2

e−

dy.

∞
x(2)
−
√2(T

Z

x(3)
t)

−

1
3√π

−

(2x(1)

x(2)

−

−

x(3))

Z

∞
2x(1)

x(2)

x(3)

−
√2(T

−
t)

−

y2

e−

dy

(A.8)

 
44

ERHAN BAYRAKTAR, IBRAHIM EKREN, AND XIN ZHANG

Proof. The proof follows from straightforward computations and is left to the reader.

(cid:3)

References

[1] Y. Abbasi Yadkori, P. L. Bartlett, and V. Gabillon, Near minimax optimal players for the ﬁnite-time
3-expert prediction problem, in Advances in Neural Information Processing Systems 30, I. Guyon, U. V. Luxburg,
S. Bengio, H. Wallach, R. Fergus, S. Vishwanathan, and R. Garnett, eds., Curran Associates, Inc., 2017, pp. 3033–
3042.

[2] M. Abramowitz and I. A. Stegun, eds., Handbook of mathematical functions with formulas, graphs, and

mathematical tables, Dover Publications, Inc., New York, 1992. Reprint of the 1972 edition.

[3] R. F. Bass and E. Pardoux, Uniqueness for diﬀusions with piecewise constant coeﬃcients, Probability Theory

and Related Fields, 76 (1987), pp. 557–572.

[4] E. Bayraktar, I. Ekren, and Y. Zhang, On the asymptotic optimality of the comb strategy for prediction

with expert advice, arXiv:1902.02368, (2019).

[5] N. Cesa-Bianchi, Y. Freund, D. Haussler, D. P. Helmbold, R. E. Schapire, and M. K. Warmuth,

How to use expert advice, J. ACM, 44 (1997), pp. 427–485.

[6] N. Cesa-Bianchi and G. Lugosi, Prediction, learning, and games, Cambridge University Press, Cambridge,

2006.

[7] J. H. Conway and R. K. Guy, The book of numbers, Copernicus, New York, 1996.
[8] T. M. Cover, Behavior of sequential predictors of binary sequences, in Trans. Fourth Prague Conf. on In-
formation Theory, Statistical Decision Functions, Random Processes (Prague, 1965), Academia, Prague, 1967,
pp. 263–272.

[9] M. G. Crandall, H. Ishii, and P.-L. Lions, User’s guide to viscosity solutions of second order partial diﬀer-

ential equations, Bull. Amer. Math. Soc. (N.S.), 27 (1992), pp. 1–67.

[10] N. Drenska, A PDE Approach to a Prediction Problem Involving Randomized Strategies, ProQuest LLC, Ann

Arbor, MI, 2017. Thesis (Ph.D.)–New York University.

[11] N. Drenska and R. V. Kohn, Prediction with expert advice: A pde perspective, Journal of Nonlinear Science,

(2019).

[12] N. Gravin, Y. Peres, and B. Sivan, Towards Optimal Algorithms for Prediction with Expert Advice,

arXiv:1409.3040, (2014).

[13] N. Gravin, Y. Peres, and B. Sivan, Towards optimal algorithms for prediction with expert advice, in Proceed-
ings of the Twenty-Seventh Annual ACM-SIAM Symposium on Discrete Algorithms, ACM, New York, 2016,
pp. 528–547.

[14] V. A. Kobzar, R. V. Kohn, and Z. Wang, New Potential-Based Bounds for Prediction with Expert Advice,

arXiv:1911.01641, (2019).

[15] F. W. J. Olver, D. W. Lozier, R. F. Boisvert, and C. W. Clark, eds., NIST handbook of mathematical
functions, U.S. Department of Commerce, National Institute of Standards and Technology, Washington, DC;
Cambridge University Press, Cambridge, 2010. With 1 CD-ROM (Windows, Macintosh and UNIX).

[16] D. B. Rokhlin, PDE approach to the problem of online prediction with expert advice: a construction of potential-

based strategies, International Journal of Pure and Applied Mathematics, (2017).

[17] E. M. Stein and R. Shakarchi, Fourier analysis, vol. 1 of Princeton Lectures in Analysis, Princeton University

Press, Princeton, NJ, 2003. An introduction.

FINITE-TIME 4-EXPERT PREDICTION PROBLEM

45

Department of Mathematics, University of Michigan

E-mail address: erhan@umich.edu

Department of Mathematics, Florida State University

E-mail address: iekren@fsu.edu

Department of Mathematics, University of Michigan

E-mail address: zxmars@umich.edu

