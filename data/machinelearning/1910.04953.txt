Scene-levelPoseEstimationforMultipleInstancesofDenselyPackedObjectsChaitanyaMitash,BowenWen,KostasBekris,andAbdeslamBoulariasDepartmentofComputerScienceRutgersUniversity{cm1074,bw344,kb572,ab1544}@cs.rutgers.eduAbstract:Thispaperintroduceskeymachinelearningoperationsthatallowtherealizationofrobust,joint6Dposeestimationofmultipleinstancesofobjectsei-therdenselypackedorinunstructuredpilesfromRGB-Ddata.Theﬁrstobjectiveistolearnsemanticandinstance-boundarydetectorswithoutmanuallabeling.Anadversarialtrainingframeworkinconjunctionwithphysics-basedsimulationisusedtoachievedetectorsthatbehavesimilarlyinsyntheticandrealdata.Giventhestochasticoutputofsuchdetectors,candidatesforobjectposesaresampled.Thesecondobjectiveistoautomaticallylearnasinglescoreforeachposecan-didatethatrepresentsitsqualityintermsofexplainingtheentiresceneviaagra-dientboostedtree.Theproposedmethodusesfeaturesderivedfromsurfaceandboundaryalignmentbetweentheobservedsceneandtheobjectmodelplacedathypothesizedposes.Scene-level,multi-instanceposeestimationisthenachievedbyanintegerlinearprogrammingprocessthatselectshypothesesthatmaximizethesumofthelearnedindividualscores,whilerespectingconstraints,suchasavoidingcollisions.Toevaluatethismethod,adatasetofdenselypackedobjectswithchallengingsetupsforstate-of-the-artapproachesiscollected.Experimentsonthisdatasetandapubliconeshowthatthemethodsigniﬁcantlyoutperformsal-ternativesintermsof6Dposeaccuracywhiletrainedonlywithsyntheticdatasets.Keywords:Poseestimation,Syntheticdatatraining,ComputerVision1IntroductionRobotmanipulationpipelines,suchasinbin-picking,oftenintegrateperceptionwithplanning[1,2,3].Somesystemsdirectlycomputepickswithoutcomputingtheposeofobjectsbysemanticsegmentationordirectlylearninggraspaffordances[4,5,6,7].Whilepose-agnostictechniquesarepromising,inmanytasksitisimportanttoﬁrstcomputethe6Dposeofobservedobjectstoachievepurposefulmanipulationandplacement,suchasinthecontextofpacking[2,8,9].Estimating6Dobjectposeshasbeenapproachedinvariousways[10],suchasmatchingoflocally-deﬁnedfeatures[11],orofpre-deﬁnedtemplatesofobjectmodels[12],orviavotinginthelocalob-jectframeusingorientedpoint-pairfeatures[13,14].Mostmethodsweredevelopedandevaluatedforsetupswhereeachobjectappearsonceandforrelativelysparselyplacedobjectsontabletops.Poseestimationformultipleinstancesofthesameobjecttypeandwhereobjectsmaybedenselypackedorinhighlyunstructuredbutdensepileshasreceivedlessattentiondespiteitssigniﬁcanceinapplicationdomains,suchaslogistics.Thisispartlyduetotheincreaseddifﬁcultyofsuchsetups.Thereispriorwork[10]thatprovidesapublicdataset[15]withaconsiderablenumberofinstancesforthesameobjecttype.Nevertheless,itmeasurestherecallforestimatingposeofanyobjectinstanceinthescene.Thismaybesufﬁcientincertaintasksbutitisaweakerrequirementthanidentifyingthe6Dposeofmost,ifnotall,objectinstances.Achievingscene-levelposeestimationallowsarobottointernallysimulatetheworld,reasonabouttheorderwithwhichobjectscanbema-nipulated,aswellastheirphysicalinteractionsandthestabilityoftheirconﬁguration.Scene-levelreasoningcanalsoinfermissinginformationbyconsideringocclusionsandphysicalinteractionsbetweenobjects.3rdConferenceonRobotLearning(CoRL2019),Osaka,Japan.arXiv:1910.04953v1  [cs.RO]  11 Oct 2019Gradient Boosted Tree RegressorFCNPose Hypotheses GenerationPose Hypothesis Quality PredictionScene-level Pose Selection!"#$, … !%#$Scene SamplingInput Image!#$BoundarypredictionsSemanticpredictions#$Congruent-set matching&'()*∑,$!#$Subject to collision constraintsExample outputSystem PipelineDensely-packed datasetBin-picking datasetModel featuresScene featuresPose quality scoreInteger Linear ProgrammingFigure1:Systempipelineandexampleoutputoftheproposedapproachondensely-packedscenesThecurrentworkaimstoimprovetherobustnessofposeestimationforreal-worldapplications,whereobjecttypesappearmultipletimes,andinchallenging,denseconﬁgurations,suchasthoseillustratedinFigure1,whileallowingforscene-levelreasoning.Itaimstodosobyproposingeffec-tivemachinelearningoperationsthatdependlessonmanualdatalabelingandlessonhandcraftedcombinationsofmultipleaccuracycriteriaintoasingleobjectivefunction.Thisallowsthetrueau-tomationofrobotmanipulationpipelinesandbringsthehopeofwider-scale,real-worlddeployment.ProblemSetup:Theconsideredframeworkreceivesasinput:a)anRGBimagexandadepthmapofthescene;b)asetofmeshmodels{Mi}Ki=1,oneforeachobjecttypei∈[1,K]presentinthescene,andc)aset{Ni}Ki=1expressinganupper-boundonthenumberofinstancesforeachobjecttypei.Theoutputisobjectposesasasetofrigid-bodytransformations{{T∗ij}Nij=1}Ki=1,whereeachT∗ij=(t∗ij,R∗ij)capturesthetranslationt∗ij∈R3androtationR∗ij∈SO(3)ofthejthinstanceofobjecttypeiinthecamera’sreferenceframe,foreachoftheKobjecttypespresentinthescene.Figure1summarizestheconsideredpipeline:a)CNNsareusedtodetectsemanticobjectclassesandvisibleboundariesofindividualinstances,b)then,alargesetofcandidate6Dposehypothesesaregeneratedforeachobjectclass,c)qualityscoresarecomputedforeachhypothesis,andd)scene-levelreasoningidentiﬁesconsistentposesthatmaximizethesumofindividualscores.Inthecontextofthispipeline,thecontributionofthisworkrelativetostate-of-the-artmethodsistwo-fold:A.Adversarialtrainingwithsyntheticdataforrobustobjectclassandboundaryprediction:Machinelearningapproacheshavebecomepopularinposeestimation,bothinend-to-endlearning[16,17]andasapipelinecomponent[18,19].Theyrequire,however,largeamountsoflabeleddata.Recentapproachesaimtosolvesingle-instanceposeestimationbytrainingentirelyinsimulation[20,19,21].TheproposedmethodalsoutilizeslabeleddatageneratedexclusivelyinsimulationtotrainaCNNforsemanticsegmentation.Nevertheless,CNNsaresensitivetothedomaingapbetweensyntheticandrealdata.Theproposedtrainingaimstomimicthephysicsofreal-worldtestscenesandbridgesthedomaingapbyusingagenerativeadversarialnetwork,asexplainedinSection2.Akeyinsighttoimproverobustnessinthemulti-instancecaseisthatthenetworkissimultaneouslytrainedtopredictobjectvisibilityboundaries.AthesisofthisworkisthatboundarieslearnedonRGBimagesaremoreeffectivethanboundariesdetectedondepth-maps[14]toguideandconstrainthesearchfor6Dposes,especiallyintightly-packedsetups.B.Scene-levelreasoningbyautomaticallylearningtoevaluateposecandidatequality:Thisworkﬁndsthebestphysically-consistentsetofposesamongmultiplecandidatesbyformulatingaconstraintoptimizationproblemandapplyinganILPsolverasshowninSection3.Theobjec-tiveistoselectposehypothesesthatmaximizethesumoftheirindividualscores,whilerespectingconstraints,suchasavoidingperceivedcollisions.Scene-leveloptimizationhasbeenpreviouslyap-proachedasmaximizingtheweightedsumofvariousgeometricfeatures[22].Theweightscharac-terizingtheobjectivefunction,however,werecarefullyhandcrafted.Thisworkshowsitispossibletolearnthedistanceofagivencandidateposefromaground-truthonebyusingasetofvariousobjectivefunctionsasfeatures.Agradientboostedtree[23]istrainedtoautomaticallyintegratetheseobjectivesandregressthedistancetotheclosestgroundtruthpose.Theobjectivesindicatehowwellacandidatehypothesisexplainthepredictedobjectsegments,thepredictedboundaries,theobserveddepthandlocalsurfacenormalsintheinputdata.Priorrelatedworkhasusedtreesearch[24,25,26]toreconstructthescenebysequentiallyplacingobjects.Thesepriorapproaches,however,wererestrictedtoasmallnumberofobjectsorfewerdegrees-of-freedomduetocomputa-tionaloverhead.TheproposedILPsolutionisquitefastinpracticeandscalestoalargenumberofobjects.FortheimagesofFigure1,thescene-leveloptimizationisachievedinafewmilliseconds.22SemanticandBoundaryPredictionsFullyConvolutionalNetworks(FCNs)[27,28]arepopularsemanticsegmentationtools.Theyhavealsobeenusedforobjectcontourdetection[29]andpredictingmultipleinstancesofanobjecttype[30,31].Thesenetworksareincreasinglybeingtrainedinsimulation[32,33,34,20]toal-leviatetheneedforlargeamountsoflabeleddata.Thedomaingapbetweenthedatageneratedinsimulationandrealdatacanleadtonoisypredictionsandgreatlyaffectposeestimationaccu-racy.Severalrecentmethodshavebeendevelopedtobridgethisdomaingap[35,36].Thecurrentworksubscribestotheseideasand:a)exploitstheconstraintsavailableinroboticsetupstosimulatesceneswithrealisticposes,whileb)usesadversarialtrainingwithunlabeledrealimagestobridgethegapbetweenthelabelspredictedinsyntheticdatawiththosepredictedinrealones.ThisworkproposestheuseofaCNNtopredictper-pixelsemanticclassiﬁcationandaclassiﬁcationofwhetherapixelisavisibleobjectboundary.ThedatafortrainingtheCNNaregeneratedinsim-ulationwithaphysicsengineandarenderer.Thesimulationsamplesabinposeandacameraposegiventherobot’sworkspace.Eachsceneiscreatedbyrandomlysampling,withinapre-speciﬁeddomain,thenumberand6Dposesofobjects,thecolorofthebin,andtheplacementandintensityoftheilluminationsources.Finally,thesceneisrenderedtoobtainacolorimage,adepthmap,per-pixelclasslabelsandvisibleinstanceboundarylabels.Thesimulationgeneratesawiderangeoftrainingdatafordomainrandomizationandrobustnesstodomaingapissues.Nevertheless,domaingapstillexistsbetweensyntheticdataanddataacquiredthroughrealsensorsasitishardtocapturethedomainofobjectmaterial’sinteractionswithvariousilluminationsourcesintheenvironment.Pooling indicesVGG16 Encoder (Shared)Label Prediction Network(Pl)Boundary Prediction Network(PB)Labeled Synthetic dataUnlabeledReal dataDLDBDomain Classifiers!"#Pooling indices!$#(H, W, K)(H, W, 2)Is #real?Figure2:CNNarchitectureforsemanticclassesandboundaryprediction.Thegenerativeadversarialnetwork(GAN),showninFigure2,performsthesemanticandboundarydetectiontasks,whilealsoadaptingtheoutputpredictionsonunlabeledrealimagestoresemblethepredictionsonsyntheticimages.ItconsistsofasharedVGG16encoderthatstacksﬁveblocksofconvolution,batchnormalizationandmaxpoolinglayers.Thenetworkbranchesoutintotwodecodersforsemanticandboundaryclassiﬁcations.Thesearefullyconvolutionaldecoderswithun-poolingindicespassedfromcorrespondingmaxpoolingblocksintheencodersection.Theoutputsofbothdecodersarepassedtoacorrespondingfullyconvolutionaldiscriminatornetwork.Thenetworkistrainedbytakingasinputasyntheticimagexsanditsground-truthlabelY(xs).Italsoreceivesasinputunlabeledrealimagexr.TheoutputPl(xs)ofthelabelpredictionnetworkonimagexs(orcorrespondingoutputonxr)isthenpassedontothelabeldiscriminatorDLwhosetaskistoclassifycorrectlyifthepredictionisonrealoronsyntheticdata.Alongwiththeobjectiveofcorrectlylabelingthesyntheticimagexs,thelabelpredictionnetworkshouldalsoconfuseDLintoclassifyingPl(xr)asanoutputofasamplecomingfromthesyntheticdomain.Theobjectiveofthesemanticlabelingnetworkisdeﬁnedas:Lsem=−Xh,wXk∈KY(xs)(h,w,k)logPl(xs)(h,w,k)−λaXh,wlogDL(Pl(xr))(h,w,0)wherePl(xs)istheper-pixelK-channel(forKobjectclasses)outputfromthelabelingnetwork,(h,w)arepixelcoordinates,andλaisaweightfactor.DL(Pl(x))(h,w,0)isthepredictedscoreofxinpixel(h,w)ofbeingasyntheticimage.Thedomainclassiﬁer’sobjectiveisspeciﬁedas:LDL=−Xh,wlogDL(P(xs))(h,w,0)−Xh,wlogDL(P(xr))(h,w,1)AsimilarGANobjectiveisusedtosimultaneouslytraintheboundarypredictoranddiscriminator.33Scene-levelPoseSelectionThissectionformulatesthescene-levelobjectiveandpresentshowtoaddressitinacomputationallyefﬁcientmanner,despiteitscomputationalhardness.Giventhesemanticandboundarypredictions,asetof6Dposehypothesesisgenerated,{{Tij}Hij=1}Ki=1,whereHidenotesthenumberofhypothesesforeachobjectclass(Hi(cid:29)Ni).Posecandidatescanbegeneratedvialearning[37],RANSAC[18]houghvoting[13],orbyincorporatingdistinctivegeometricfeatures[19].Thecurrentworkusesastochasticrepresentationofoutputfromsegmentationforhypothesesgener-ationviacongruentsetmatching[38,19].Ititerativelysamplesasetofpoints(calledabase)fromtheobservedpointcloudsuchthatthepointsineachsetbelongwithhighprobabilitytoasingleobjectinstance.Thesampledpointsetsarethenmatchedtocongruentsetsoncorrespondingobjectmodeltogeneratecandidaterigidtransformations.Akeyfeatureofourhypothesesgenerationpro-cess,comparedto[38,19],isthattheboundarypredictionsfromthepreviousstepareutilizedtolimittheselectionofpointswithinasingleobjectinstance.Anadaptivesamplingprocessisusedtocoverallinstancesofthesameobjectbyenforcingdispersion.ThedetailedformulationforthehypothesesgenerationprocesscanbefoundinAppendixA.Theﬁnalobjectiveistoselectforanobjectcategoryi,asubsetofposes{T∗ij}Nij=1⊂{Tij}Hij=1,whichmaximizesthetotalsumofscoresf(T∗ij)whileavoidingcollisionsbetweenobjectswhenassignedtothoseposes.Inotherterms,theintersectionbetweenthevolumeoccupiedbyanytwoobjectinstancesinthesceneshouldbeempty.Theapproachﬁrstidentiﬁesasetthatcontainsallpairsofposes,whichconﬂictwitheachother.ThissetisdeﬁnedasC={{(i,j),(i0,j0)}s.t.|V(Mi,Tij)∩V(Mi,Ti0j0)|>(cid:15)v}wherei,i0∈{1,..,K},j∈{1,..,Hi},j0∈{1,..,H0i}andV(M,T)isthevolumeoccupiedbyamodelMwhenplacedaccordingtoposeT.(cid:15)visthemaximumvolumeoftoleratedcollisionsbetweenobjectsinthescene.Thispositiveerrortermisnecessarybecausethebestposesamongthesampledonesmayinduceslightcollisionsbetweenobjects,whichcanoftenbecorrectedafterwards.Poseselectionisformulatedasaconstraintoptimizationproblem,whichcanbesolvedbyILP.Asetofbinaryvariables{{yij}Hij=1}Ki=1isdeﬁnedwhereyij∈{0,1}.EachvariableyijcanbeseenasanindicatorvariableonwhetherposehypothesisTijisincludedinthesetofselectedposed{T∗ij}Nij=1.Then,theoptimizationproblemisasfollows:max{yij}KXi=1HiXj=1yijf(Tij)subjectto:∀i∈{1,...,K}:HiXj=1yij≤Ni∀{(i,j),(i0,j0)}∈C:yij+yi0j0≤1.TheﬁrstconstraintensuresthatthenumberofposesselectedforeachcategoryofobjectidonotexceedthenumberNiofinstances.Thesecondconstraintensuresthatposesthatareconﬂictingcannotbeselected.ThisproblemisequivalenttotheMaximum-WeightIndependentSetProblem(MWISP),withanadditionalconstraintrelatedtothenumberofselectedposes.MWISPisNP-hard,andthereareno1n1−(cid:15)-approximationsforanyﬁxed(cid:15)>0wherenisthenumberofvariables{yij}[39].Inpractice,however,andfortheproblemsconsideredhere,anexactsolutioncanbefoundveryfast(inmilliseconds)usingmodernILPsolversforscenescontainingafewhundredsofcandidateposes.Thisisbecausetheposestendtoclusterintocliquesaroundspeciﬁcinstances,withasmallnumberofconstraintsbetweenposesindifferentcliques.Moreover,theobjectivefunctionismonotonesub-modularasitisalinearfunctionofasubset[40].Therefore,greedyoptimizationisguaranteedtoﬁndinlineartimeasolutionthatisatleast(1−1e)fractionoftheoptimal.AnapproximatesolutioncanalsobefoundinlineartimewithanLPrelaxation.AftersolvingtheILP,theposes{T∗ij}Nij=1areconstructedfrom{Tij}Hij=1bykeepingthoseforwhichyij=1.4PoseHypothesisQualityEvaluationScene-leveloptimization,presentedinSection3,requiresthatasinglequalityscoref(T)isassignedtoeachposeTinthehypothesesset.Theproposedscorefunctionconsidersﬁveindicatorsf1:5(T)ofagoodalignmentforeachposecandidateT,showninTable1.Astraightforwardsolutionistodeﬁnefasaweightedsumofitscomponents.Nevertheless,theresultingposeswouldheavilydependonthechoiceoftheweights.Choosingtherightweightsmanuallyforeverynewobjecttype4NotationB(T):VisibleboundarypixelswhentheobjectmodelisplacedatposeTandrenderedSB:SceneboundarypixelspredictedbytheCNN.V(T):VisibleportionofthetheobjectmodelwhenplacedatposeTandrendered.δS,δB:Surfaceandboundarymatchingdistancethresholds.DS(p,T,OD):DepthdistancebetweenrenderedimageandobserveddepthimageODatpixelp.DB(p,T,SB):Distancebetweenrenderedboundaryandpredictedboundaryatpixelp.Model-to-Sceneconsistencyfeaturesf1|B(T)∩SB|/|B(T)|:fractionofpixelsinmodelboundarythatmatchthesceneboundary.f2|B(T)∩SB|/|V(T)∩SB|:fractionofpixelsinsceneboundarywithinthevisiblemodelregionthatmatchthemodelboundary.f3Pp∈V(T)1DS(p,T,OD)<δS/|V(T)|:fractionofpixelsinvisiblemodelregionthatissufﬁ-cientlyalignedintermsofdepthtotheobserveddata.Scenealignmentfeaturesf4Pp∈V(T)Pl(p)S(p,T,OD):surfacealignmentscoreweightedbythecorrespondinglabelprobability.SimilarityscoregivenbyS(p,T,OD)=(1−1δSDS(p,T,OD))N(p,T)anditconsidersdepthdistanceandsurfacenormalsimilarity.f5Pp∈B(T)(1−1δBDB(p,T,SB)):boundaryalignmentscorebasedondistancebetweenpointonmodelboundaryandit’snearestpointinthepredictedboundaryset.Table1:Descriptionoffeaturesindicatinggoodposealignmentwithsensoryinputisnottrivial.Instead,akeyaspectofthisworkistolearntheobjectivefunctionf(T)usingf1:5(T)asfeatures,i.e.,f(T)=h(f1:5(T)).Thefunctionhislearnedbyminimizingthefollowingloss:minhX(T,f1:5(T),Tg)∈Ttrain(cid:16)h(f1:5(T))−eADI(T,Tg)(cid:17)2,(1)whereeADI(T,Tg)isthedistancebetweenagivenposeTandaground-truthposeTg.Thedis-tanceeADI(T,Tg)iscomputedusingtheADImetric,whichisfrequentlyusedintheliteratureforevaluatingposeestimations[12].Thismetricisexplainedintheexperimentalsection.Visible boundary for model hypothesis !Visible surface for model hypothesis Visible instance-boundary matchingSemantic classes and geometric feature matchingModel-Sceneconsistencyratio "#:%!Scene boundary prediction Scene semantic prediction Boundaryalignmentscore "&!Model-Sceneconsistency ratio "'!Surfacealignmentscore "(!+++Gradient BoostedTreeℎ("#:(!)~-../.012Pose Quality ScoreMatching the base to congruent sets on the mesh models, and computing the corresponding 6D transform.Sampling a base on the sceneSample 1Sample 2Sample 3Sample 4Sampled baseObject modelPose Hypotheses GenerationPose Hypothesis Quality EvaluationFigure3:Regressingthehypothesisqualitygivenvariousalignmentfeatures.ThetrainingdatasetTtrainiscollectedbysimulatingdifferentscenesinaphysicsengineinthesamewayasdescribedinSection.2.Foreachscene,theCNNpredictssemanticandobjectboundariesandalargenumberofposehypothesesaresampled.ForeachhypothesisT,theiralignmentfeaturesf1:5(T)andcorrespondingscoreseADI(T,Tg)arecomputedbasedontheclosestground-truthpose.Theregressionlearningproblemistoﬁndafunctionhthatmapsfeaturesf1:5(T)ofaposeTtoitsactualdistancefromthecorrespondingground-truthposeTg.ThisworkadoptstheGradientBoostedRegressionTrees(GBRT)tosolvetheoptimizationprobleminEquation1.GBRTsarewell-suitedforhandlingvariablesthathaveheterogeneousfeatures[23].GBRTsarealsoaﬂexiblenon-parametricapproachthatcanadapttonon-smoothchangesinthere-gressedfunctionusinglimiteddata,whichoftenoccurswhendealingwithobjectsthathavedifferentshapesandsizes.AnimplementationofGBRTisavailableintheScikit-learnlibrary[41].55ExperimentsThissectiondescribestheexperimentalstudyperformedon2datasetsofsceneswithmultiplein-stancesofobjects.Inthisstudy,therecallforposeestimationismeasuredbasedontheerrorgivenbyADI[12],whichmeasuresdistancesbetweenposesT1andT2givenanobjectmeshmodelM:eADI(T1,T2)=avgb1∈Mminb2∈M||T1(b1,M)−T2(b2,M)||2,whereT(b,M)correspondstopointbafterapplyingtransformationTonM.Givenaground-truthposeTg,atruepositiveisareturnedposeTthathaseADI(T,Tg)<kldl,whereklisafractionsetto110,whiledlisthediameteroftheobjectmodelcalculatedasthemaximumdistancebetweenanytwopointsonthemodel.Thetwodatasetsincludeapublicdatasetcalledbin-pickingdataset[15]andanewonedevelopedaspartofthissubmission.Thebin-pickingdatasetcontainstwoobjecttypesand3scenarios(Figure2).Thesescenariospresentclutterofobjectswithhighocclusionrate.Forthisdataset,segmentingobjectsincolorimagesischallengingbutdepthcuescanbeusedtoﬁndtheobjectboundaries.Thisleadstodepth-basedapproachesachievinghighestimationsuccessonthisdatasetwithoutcolorinformation.Thenewdataset,henceforthcalledthedensely-packeddataset,comprisesof30uniquesceneswithtwoobjectcategories.Eachscenecontains15to19differentinstancesoftheseobjects,whichweremanuallylabeledwith6Dposeannotations.Therearetwotypesofscenesinthisdataset,asillustratedbelow.Inonetype,denotedasscenario1,theinstancesaretightlypackednexttoeachother.Thiscaseisparticularlychallengingbecausethesurfacesofmultipleinstancesarealigned,whichmakesitdifﬁculttousedepthinformationforsegmentation.Thedatasetandthecodeissharedalongsidethepaper.Scenario 1Object 1Object 2Scenario 2Object 1Object 2Scenario 1Scenario 2Scenario 3Table2:Objecttypeandscenariosinthe(left)densely-packedand(right)bin-pickingdataset.Approacho1o2MeanOURS79.985.282.1Hinterstoisserat.al[12]37.065.649.3PPF-Voting[13]30.157.641.9Buchat.al[42]11.231.719.9LCHF[15]16.244.328.3MRCNN-StoCS[43,19]42.868.353.7PoseCNN∗∗[16]15.046.928.7PoseCNN+ICP∗∗[16]56.880.667.0DOPE∗∗[20]51.070.660.8DOPE[20]3.510.56.5Table3:Poseretrievalrecallrateondensely-packeddataset.∗∗[16,20]testedonsyntheticversion.Approacho1o2OURS64.155.7Buchat.al[42]63.844.9PPF-Voting[13]47.427.9LCHF[15]33.525.1Tejaniet.al.[44]31.424.8Table4:Recallonbin-pickingdataset.Resultsforotherapproachesareobtainedfrom[42].Severalobjectinstanceswerecompletelyhidden.Thisleadstolowerre-callratesevenwhenthealgorithmscouldretrieveallthevisibleinstances.5.1EvaluationagainstrecentposeestimationtechniquesSeveralstate-of-the-artposeestimationtechniquesareevaluatedontheabovedatasets(Table3andTable4).Apopulartemplate-matchingwork[12]matchestemplatesextractedfromRGBanddepthrenderingofCADmodels.Itfailsonseveraloccasionsasthetemplatesarenotrobusttoocclusionandvaryinglightingconditions.Approachesbasedonhoughvotingwithpoint-pairfeatures[13,42]achievehighsuccessonthebin-pickingdatasetbutfailtodosoonthedensely-packeddataset.Theseapproachesdetectmultipleobjectinstancesbyconsideringthepeaksinhoughvotingspace,severalofwhicharefalsepositivesbyvirtueofalignedsurfacesinthepackedboxesscenario.LCHF[15]istailoredtohandlemultipleinstancesofthesameobjectcategory.Evenaftercarefullytuningtheweightsoftheoptimizationfunctionandrelaxingthecriteriaforthenumberofposecandidatestoselect,therecallfromthisapproachisratherlow.Thiscanbemajorlyattributedtodifferencesinpre-deﬁnedtemplatedescriptorsbetweenthesceneandtheobjectmodelusedformatchinglocalpatches.LCHF[15]alsoincludesanactivevisioncomponentnotconsideredinthisevaluation.6Next,recentdeep-learningbasedtechniquesforposeestimationareevaluated.StoCS[19]matchespointcloudobjectmodelstostochasticoutputfromaCNNtrainedforsemanticsegmentationwithsyntheticdata.OnewaytoapplyStoCSformulti-instanceestimationistointegrateitwithaninstancesegmentationtechnique,suchasMaskR-CNN[43].MaskR-CNNwastrainedwithsyntheticdataandusedtoextracttop10instancesofeachobjecttypeaccordingtothedetectionprobability.PoseestimationwasperformedusingStoCSforeachoftheseindividualsegments.Therearetwomajorlimitationsofthiscombination.Theﬁrstistheuseofdeterministicinstanceboundariesleadingtosegmentationnoisethatcannotberecoveredduringposeestimation.Thesecondisthatvisibilityisnotconsideredwhenmatchingthemodeltothedetectedsegment,whichcanleadtoseveralincorrectposesachievinghighalignmentscores.PoseCNN[16]isanend-to-endlearningapproach.Itincludesanetworkbranchforsemanticseg-mentation.Pixelsbelongingtoanobjectclassthenvotefortheobjectcentroid’slocation.Basedonthepeaksinvoting,thecenterislocalizedandcorrespondinginliersareusedtoﬁndaregionofinterest(RoI).FeaturesoftheRoIregressinaseparatebranchofthenetworktooutputtheobject’srotation.PoseCNNwasoriginallydevelopedforsingleinstancesbutvianon-maximalsuppressionovertheoutputofhoughvoting,itcanbeadaptedformultipleinstances.Toeliminatedomaingapfromthescopeoftesting,PoseCNNwastestedonasyntheticdatasetwiththesamescenariosastheonesinrealtesting.PoseCNNoutputsanobjectposethatcouldbeusedasaninitializationforadepth-basedICP-likeprocessthatutilizesperturbationsandlocalsearchforreﬁnement.Overall,objectsymmetryandtight-packingscenariosmakethesimultaneoustrainingofthemultiplenetworkbrancheshardtoconvergeandtheﬁnalICPprocesslesseffectiveinthesescenarios.DOPE[20]isanotherlearning-basedapproachthatrecovers6Dposeviaperspective-n-point(PnP)frompredictionsof3Dbounding-boxverticesprojectedontheimage.Itaimstobridgethesimulation-to-realitygapbyacombinationofdomainrandomizationandphoto-realisticrendering.Theopen-sourcedrenderingengineNDDS[45]usedinDOPE,however,doesnotprovideaccesstophoto-realisticrendering.Thus,thecomparisonsweremadeagainsttheDOPE-DRversion.Theneuralnetworkoutputiscomposedofabeliefmapusedtoﬁndtheprojectedverticesbyalo-calpeaksearchaswellasanafﬁnitymap,whichindicatesthedirectionfromprojectedverticestotheircorrespondingcenterforassignment.Nevertheless,whenmultipleinstancesofthesameob-jectareplacednexttoeachother,some2Dverticessigniﬁcantlyoverlaparoundtheborderoftwoneighboringinstances.Thismakestheassignmentofverticestothecorrectcenterproblematicanddegradetheperformanceof(PnP),sinceitrequiresrelativelyprecise2D-3Dpointcorrespondences.DOPEusesonlycolorinformationwithoutdepth,whichisadisadvantagewhencomparedtoothermethodsinTable3.DOPEwastrainedfromscratchwithsyntheticdatageneratedbyfollowingthesamepipelineaspresentedin[20].Usingthebesttunedparametersfordomainrandomizationandpost-processingsteps,theposeestimationrecallwasmeasuredonasyntheticvalidationsetandontherealtestset.5.2AblationstudyoftheproposedtechniqueTheCNNinSection2istrainedwith20,000scenesgeneratedinsimulationbyrandomlydroppingobjectsinthebin.Itisthenﬁne-tunedwithimagesrenderedfrom50simulatedscenesoftightly-packedobjects.ThenetworksweretrainedusingtheAdamoptimizerwithaninitiallearningrateof2×10−3.TheweightλafortheGANlossissetto10−3.Tohandletheclassimbalanceintheboundarynetwork,theratioofboundarytonon-boundarypixelswascomputedineveryiterationofthetrainingandusedtoweighttherespectivelossterms.Table5indicatesthatlabel-spaceadaptationisthemosteffectivetrainingstrategyinthiscaseandevenmoresowhenscenesthatmimicthepackingscenariowereused.Trainingsolelyonsyntheticdatawithnoadaptationsigniﬁcantlyreducestheperformance.Anunpairedimagetranslationap-proach,Cycle-GAN[35],achievescomparableperformance.Butwithnosemanticconstraints,itbiasesthetransferfordominantclassesinthedataset(o2inthiscase),andalsocannotdealwithbackgroundclutter.Figure4showssynthetictrainingimagesfordifferentdatasetsandboundarypredictionsonrealimagesofcorrespondingdatasets.Toevaluatethegeneralizationcapacityofthetrainingprocess,thenetworkwasalsotrainedfortheOccluded-Linemoddataset[18]thatcontains8objectclassesandunseenbackgroundclutter.Eventhen,thetrainingwasabletopredictboundariesofonlyconcernedobjects.GiventhepredictionsfromCNN,thehypothesesgenerationprocessdescribedinAppendixAﬁndsforeachobjecttype,asetofposecandidates,whichshouldbelargeenoughtoincludethetrue7Trainingo1o2AllAdapt-ﬁnetune(ours)79.985.282.1Adapt-noﬁnetune74.584.678.8Cyclegan[35]75.688.281.0Noadaptation(rgb)69.879.573.9Table5:Evaluatingdifferenttrainingstrategies.ILPObjectivefunctiono1o2AllOptimal87.690.888.9Learned79.985.282.1Manual(scene+model)76.483.179.2Manual(scene)59.882.669.6Table6:learnedvsmanually-deﬁnedobjective.MethodSelectedAll-Candidateswithboundary82.192.9w/oboundary58.778.0Table7:Effectofusingboundariesforhypothe-sesgeneration.0.610.730.780.580.720.820.540.710.82550100RecallNumber of Bases!=0.5!=0.9!=1.00.580.720.770.820.840.690.840.90.930.9649.481.9109.1130.3154RecallNumber of Pose CandidatesSelected SetCandidate SetTable8:Recallasafunctionofnumberofposecandi-datesandthedispersionparameter(γ)Densely-packed datasetBin-picking datasetOccluded-LinemoddatasetFigure4:Examplesofsynthetictrainingdataandboundarypredictionsonrealimages.posesandsmallenoughtoreducethecomputationtime.Thenumberofcandidatesisaffectedbythenumberofsampledbasesandposeclustering.RecallratesareshowninFigure8separatelyforallgeneratedcandidatesandtheonesselectedbyILP.Italsoshowstheeffectofdispersionparameterγ,whichisbydefaultsetto0.9.Table7evaluatesthecontributionoftheboundaryreasoninginthehypothesisgenerationandshowsthatithasasigniﬁcantimpactontheoverallrecall.Table6compareslearnedobjectivefunctionforILPvsmanually-deﬁnedones.OnewaytocombinefeaturesdeﬁnedinSection3istoconsideronlyscenealignmentscores(f3+f4)asinmanypointregistrationalgorithmsoralternativelyusebothscenealignmentandmodelconsistencyscores(f1∗f2∗f3(f4+f5)).AnupperboundofperformancewiththegivenhypothesessetisestablishedastheoptimalrecallwhenthetrueADIdistancefromground-truthisusedintheoptimization.Theoverallcomputationtimeforthecurrentsequentialimplementationoftheapproachrangesfrom10sto15sforestimatingall(15to19)instancesinascene.TheCNNpredictions,theposehypothe-sesgenerationandthescene-leveloptimizationalongwithcollisioncheckingrunindividuallyinlessthanasecond.Broadphasecollisioncheckingisperformedtospeeduptheprocess.Themajorityofcomputationtimeisspentondepth-bufferingandlocalreﬁnementforeachposecandidate(130perobjectcategory).TheseoperationscanbesigniﬁcantlyspedupwithparallelprocessingsuchasCUDA-OpenGLinteroperability,whichhasbeenshown[25]torender1000imagesin0.1s.Giventhedataparallelism,multiplecorescanalsobeeasilyutilizedtospeedupthealgorithm.6DiscussionThisworkfocusesonhardinstancesofscene-level,multi-instanceposeestimation,whichincludeshighlyclutteredanddenselypackedscenarios.Theresultsshowthatthetypeofposesusedinsimulationfortrainingthesemanticandtheboundarynetworksisimportant.Whileasimulation-to-realitydomaingapexists,itcanbebridgedbyusingappropriateinformation,suchasboundaryprediction,whichtranslateswellfromsimulatedtorealimages,andadversarialtrainingstrategies.Furthermore,theILPformulationofthescene-levelreasoningisabletoﬁndcombinationsofhy-pothesesthatarebothconsistentaswellasofhigh-qualitygiventhelearnedglobalscorefunction.Theconsistencyofposehypothesesinthecurrentworkisdeﬁnedbycollisionconstraints.Itisin-terestingtoconsideralearningprocessforidentifyingcompatiblesetsofposesthatexpressphysicalconstraintsandwhichcouldbeusedinthecontextoftheproposedILPformulation.AcknowledgmentsThisworkwassupportedbytheNSF,grantnumbersIIS-1734492andIIS-1723869.8Bibliography[1]N.Correll,K.Bekris,D.Berenson,O.Brock,A.Causo,K.Hauser,K.Osada,A.Rodriguez,J.Romano,andP.Wurman.AnalysisandObservationsFromtheFirstAmazonPickingChal-lenge.T-ASE,2016.[2]M.Schwarz,C.Lenz,G.Garc´ıa,S.Koo,A.Periyasamy,M.Schreiber,andS.Behnke.Fastobjectlearninganddual-armcoordinationforclutteredstowing,picking,andpacking.InICRA,2018.[3]A.Zeng,K.Yu,S.Song,D.Suo,E.Walker,A.Rodriguez,andJ.Xiao.Multiviewself-superviseddeeplearningfor6dposeestimationintheamazonpickingchallenge.InICRA’17.[4]M.Gualtieri,A.TenPas,K.Saenko,andR.Platt.GraspPoseDetectioninPointClouds.IJRR,2017.[5]J.Mahler,J.Liang,S.Niyaz,M.Laskey,R.Doan,X.Liu,J.Ojea,andK.Goldberg.Dex-net2.0.InR:SS,2017.[6]D.Morrisonetal.Cartman:Thelow-costcartesianmanipulatorthatwontheamazonroboticschallenge.InICRA,2018.[7]A.Zengetal.Roboticpick-and-placeofnovelobjectsinclutterwithmulti-affordancegraspingandcross-domainimagematching.InICRA,2018.[8]R.Shome,W.N.Tang,C.Song,C.Mitash,C.Kourtev,J.Yu,A.Boularias,andK.Bekris.Towardsrobustproductpackingwithaminimalisticend-effector.InICRA,2019.[9]W.FanandK.Hauser.RobotPackingwithKnownItemsandNondeterministicArrivalOrder.InR:SS,2019.[10]T.Hodan,F.Michel,E.Brachmann,W.Kehl,A.GlentBuch,D.Kraft,B.Drost,J.Vidal,S.Ihrke,X.Zabulis,etal.Bop:benchmarkfor6dobjectposeestimation.InECCV,2018.[11]A.Aldomaetal.Tutorial:Pointcloudlibrary:Three-dimensionalobjectrecognitionand6dofposeestimation.IEEERobotics&AutomationMagazine,2012.[12]S.Hinterstoisser,V.Lepetit,S.Ilic,S.Holzer,G.Bradski,K.Konolige,andN.Navab.Modelbasedtraining,detectionandposeestimationoftexture-less3Dobjectsinheavilyclutteredscenes.InACCV,2012.[13]B.Drost,M.Ulrich,N.Navab,andS.Ilic.ModelGlobally,MatchLocally:EfﬁcientandRobust3DObjectRecognition.InCVPR,2010.[14]J.Vidal,C.-Y.Lin,X.Llad´o,andR.Mart´ı.AMethodfor6DPoseEstimationofFree-FormRigidObjectsUsingPointPairFeaturesonRangeData.Sensors,2018.[15]A.Doumanoglou,R.Kouskouridas,S.Malassiotis,andT.-K.Kim.Recovering6dobjectposeandpredictingnext-best-viewinthecrowd.InCVPR,2016.[16]Y.Xiang,T.Schmidt,V.Narayanan,andD.Fox.PoseCNN:AConvolutionalNeuralNetworkfor6DObjectPoseEstimationinClutteredScenes.InR:SS,2018.[17]W.Kehl,F.Manhardt,F.Tombari,S.Ilic,andN.Navab.Ssd-6d:Makingrgb-based3ddetec-tionand6dposeestimationgreatagain.InICCV,2017.[18]E.Brachmann,A.Krull,F.Michel,S.Gumhold,J.Shotton,andC.Rother.Learning6dobjectposeestimationusing3dobjectcoordinates.InECCV,2014.[19]C.Mitash,A.Boularias,andK.Bekris.Robust6dobjectposeestimationwithstochasticcongruentsets.InBMVC,2018.[20]J.Tremblay,T.To,B.Sundaralingam,Y.Xiang,D.Fox,andS.Birchﬁeld.DeepObjectPoseEstimationforSemanticRoboticGraspingofHouseholdObjects.InCoRL,2018.9[21]M.Sundermeyer,Z.-C.Marton,M.Durner,M.Brucker,andR.Triebel.Implicit3DOrienta-tionLearningfor6DObjectDetectionfromRGBImages.InECCV,2018.[22]A.Aldoma,F.Tombari,L.DiStefano,andM.Vincze.Aglobalhypothesesveriﬁcationmethodfor3dobjectrecognition.InECCV,2012.[23]J.Elith,J.R.Leathwick,andT.Hastie.Aworkingguidetoboostedregressiontrees.JAE’08.[24]V.NarayananandM.Likhachev.Discriminatively-guidedDeliberativePerceptinonforPoseEstimationofMultiple3DObjectInstances.InR:SS,2016.[25]Z.Sui,L.Xiang,O.C.Jenkins,andK.Desingh.Goal-directedrobotmanipulationthroughaxiomaticsceneestimation.InIJRR,2017.[26]C.Mitash,A.Boularias,andK.E.Bekris.Improving6dposeestimationofobjectsinclutterviaphysics-awaremontecarlotreesearch.InICRA,2018.[27]J.Long,E.Shelhamer,andT.Darrell.Fullyconvolutionalnetworksforsemanticsegmentation.InCVPR,2015.[28]H.Noh,S.Hong,andB.Han.Learningdeconvolutionnetworkforsemanticsegmentation.InICCV,2015.[29]J.Yang,B.Price,S.Cohen,H.Lee,andM.-H.Yang.Objectcontourdetectionwithafullyconvolutionalencoder-decodernetwork.InCVPR,2016.[30]Y.Li,H.Qi,J.Dai,X.Ji,andY.Wei.Fullyconvolutionalinstance-awaresemanticsegmenta-tion.InCVPR,2017.[31]A.Kirillov,E.Levinkov,B.Andres,B.Savchynskyy,andC.Rother.Instancecut:fromedgestoinstanceswithmulticut.InCVPR,2017.[32]C.Mitash,K.Bekris,andA.Boularias.Aself-supervisedlearningsystemforobjectdetectionusingphysicssimulationandmulti-viewposeestimation.InIROS,2017.[33]J.Tobin,R.Fong,A.Ray,J.Schneider,W.Zaremba,andP.Abbeel.Domainrandomizationfortransferringdeepneuralnetworksfromsimulationtotherealworld.InIROS,2017.[34]S.Hinterstoisser,V.Lepetit,P.Wohlhart,andK.Konolige.Onpre-trainedimagefeaturesandsyntheticimagesfordeeplearning.InECCV,2018.[35]J.-Y.Zhu,T.Park,P.Isola,andA.A.Efros.Unpairedimage-to-imagetranslationusingcycle-consistentadversarialnetworkss.InICCV,2017.[36]Y.-H.Tsai,W.-C.Hung,S.Schulter,K.Sohn,M.-H.Yang,andM.Chandraker.Learningtoadaptstructuredoutputspaceforsemanticsegmentation.InCVPR,2018.[37]C.Wang,D.Xu,Y.Zhu,R.Mart´ın-Mart´ın,C.Lu,L.Fei-Fei,andS.Savarese.Densefusion:6dobjectposeestimationbyiterativedensefusion.InCVPR,2019.[38]N.Mellado,D.Aiger,andN.Mitra.Super4PCS:FastGlobalPointcloudRegistrationviaSmartIndexing.InComputerGraphicsForum,2014.[39]J.Hastad.Cliqueishardtoapproximatewithinn1−(cid:15).InActaMathematica,1996.[40]A.KrauseandD.Golovin.SubmodularFunctionMaximization.CambridgePress,2014.[41]F.Pedregosa,G.Varoquaux,A.Gramfort,V.Michel,B.Thirion,O.Grisel,M.Blondel,P.Pret-tenhofer,R.Weiss,V.Dubourg,etal.Scikit-learn:Machinelearninginpython.JMLR,2011.[42]A.G.Buch,L.Kiforenko,andD.Kraft.Rotationalsubgroupvotingandposeclusteringforrobust3dobjectrecognition.InICCV,2017.[43]K.He,G.Gkioxari,P.Doll´ar,andR.Girshick.Maskr-cnn.InICCV,2017.[44]A.Tejani,D.Tang,R.Kouskouridas,andT.K.Kim.Latent-classHoughForestsfor3DObjectDetectionandPoseEstimation.InECCV,2014.[45]T.To,J.Tremblay,D.McKay,Y.Yamaguchi,K.Leung,A.Balanon,J.Cheng,W.Hodge,andS.Birchﬁeld.NDDS:NVIDIAdeeplearningdatasetsynthesizer,2018.10AppendixA:PoseHypothesesGenerationGiventheoutputofsemanticclasspredictionsPlandboundarypredictionPB,thisstepaimstogen-erateasetof6Dposehypotheses{{Tij}Hij=1}Ki=1,whereHidenotesthenumberofposehypothesesforeachobjectmodelMiandislargerthanthenumberoftheobject’sinstancesinthescene,i.e,Hi(cid:29)Ni.Similartotheoverallobjectiveoftheproblemsetup,eachTij=(tij,Rij)isacandidatetranslationtij∈R3androtationRij∈SO(3)ofsomeinstanceofobjecttypeMiinthecamera’sreferenceframe,foreachoftheKobjecttypespresentinthescene.Thesetsofposehypothesesshouldbesufﬁcientlylargetoensuretheycontaincandidatescloseenoughtotheunknowntrueposes,i.e,∀i∈[1,K],∀j∈[1,Ni],∃T∈{Tij0}Hij0=1:kT−Tgijk≤(cid:15),whereTisahypothesisposeforobjectMiandTgijisthegroundtruthposeofthejthinstanceofobjectMi.Sincethegroundtruthposesareunknownduringtesting,onecannotguaranteethatthepreviousdesiredpropertywillbesatisﬁedunlessthecandidatesaredenselysampledfromSE(3),whichwouldmakethesearchcomputationallyexpensive.Therefore,itisimportanttosamplethecandidatesinamannerthatbalancestheirdiversityandtheirsimilaritytothegroundtruthgiventhesemanticclasspredictionsPlandmodels{Mi}Ki=1.PosehypothesesgenerationisoftenperformedusingRANSAC-liketechniques[1]orviahoughvoting[2],orvariousdistinctivegeometricfeatures[3,4,5],whichensurethatmultiplepointscanbesampledfromthesameobject.Thesemethodsdonotincorporateboundaryinformation,whichisimportantincaseswherethesurfacesofmultipleobjectinstancesarealigned.Thefollowingex-plainstheproposedposehypothesesgenerationprocess,whichutilizesbothsemanticsegmentationandinstance-boundaries.Figure1:Hypothesisgen-erationprocessviasam-plingabaseandmatchingittoacongruentsetfromtheobjectmodel.TheoutputofthesoftmaxlayerfromPlisusedtocomputeπl(pi),theprobabilityofeachpixelpibelongingtoanobjectclassl.ThisprobabilityisdeﬁnedastheratiooftheoutputPl(pi)overthesumoftheoutputsforthesameclassoverallpixelspinthegiventestimagex,i.e./πl(pi)=Pl(pi)PpPl(p).Basedontheprinciplesofrandomizedalignment,candidateposesaregeneratedforeachinstanceofanobjectbysamplingsetsofpointsthatbelongtooneinstancewithhighprobability.Inthepointcloudreg-istrationliterature[6,7],asetofsampledpointsiscalledabaseanddenotedbyB.Oncesampled,thissetismatchedtocongruentsets,denotedbyU,onthecorrespondingobjectmodelM.Eachofthecon-gruentpairs(B,U)deﬁnesauniquerigidtransformaslongasbothBandUcontainatleast3pointseach.Forcomputationalreasons,thecardinalityistypicallylimitedto4,i.e.,|B|=|U|=4.Tomaximizetheprobabilitythatposecandidatesforalltheinstancesaregenerated,anumberAiofbasesets{Bij}Aij=1ontheimagexissampled,foreachobjectclassi∈{1,...,K}.EachbaseBijcanbematchedtosev-eralcongruentbasesUonthemodels,andthusdeﬁnesalargesetofcandidateposes.A.SamplingaBasefromaSingleObjectInstance:Thefour3DpointsthatformabaseB={b1,b2,b3,b4|b1:4∈Sl}aresampledfromapointcloudSl,whichisthesetof3DpointsthatarelabeledasacategorylaccordingtothesemanticclassprobabilitiesPl.Thechallengehereistomaximizethejointprobabilityofthefourpointsbelongingtothesameobjectinstance.ThejointprobabilitydistributiononthegraphformedbythefourpointsisrepresentedbyusingtheHammersley-Cliffordfactorizationandconsideringonlyunaryandbinaryrelationsbetweenthepoints:Pr(cid:16)(cid:0)c(p(b1),x)=l(cid:1)∧(cid:0)b1:4areallonthesameinstance(cid:1)(cid:17)=1Z4Yi=1(cid:16)φlnode(bi)j<iYj=1φledge(bi,bj)(cid:17),1arXiv:1910.04953v1  [cs.RO]  11 Oct 2019wherep(bi)isusedtodenotethepixelcorrespondingtothe3Dpointbiand,asbefore,c(p,x)isusedtodenotetheobjectclasslabelofpixelpinimagex.Theunarytermsφlnode(bi)aretheindividualprobabilitiesoflabelingpixelsp(bi)withcategorylabell,i.e.,φlnode(bi)=Pl(p(bi)).Thebinaryrelationsaredeﬁnedas,φledge(bi,bj)=1,ifPPF(bi,bj)∈PPF(Mk)andlength-of-shortest-path(p(bi),p(bj))<(cid:15)l0,otherwise.ThePoint-PairFeature(PPF)[2]fortwobasepointsbi,bjwithsurfacenormalsni,njisdeﬁnedas:PPF(bi,bj)=(||d||2,∠(ni,d),∠(nj,d),∠(ni,nj)),whered=bi−bjisthevectorfrombitobjandni,njarelocalsurfacenormals.PPF(Mk)isthesetofpoint-pairfeaturespre-computedontheobjectmodelMkofobjectcategoryk.Thelength-of-shortest-pathtermistheshortestdistanceonagraphG,wheretheverticesaretheimagepixelsandanedgeconnectstwopixelspiandpjifandonlyif:PB(pi)<δ,PB(pj)<δ,andpiandpjareadjacentpixelsintheimage(eachpixelhasatmosteightadjacentpixels).Inotherterms,thereisanedgebetweentwoadjacentpixelsifbothpixelshavealowprobability(lessthanathresholdδ)ofbeingontheboundaryofanobject.Thus,length-of-shortest-path(pi,pj)isthelengthoftheshortestpathbetweenthetwonodesonG,anditisobtainedusingabreadth-ﬁrstsearch.B.AvoidingOversamplingandAchievingCoverage:Thesamplingprocessisdynamicallyadaptedsoastoavoidrepetitivelyselectingthesameimageregions.Inparticular,afterabaseissampled,adecayfactorγ∈[0,1)ismultipliedtothepotentialφlnode(bi)ofeverypointbithatbelongstothesamesegmentasbi,i.e.,φlnode(bi)←γφlnode(bi).Pointsbelongingtothesamesegmentsarethoseencounteredduringthebreadth-ﬁrstsearch.Thisencouragesdispersioninthesamplingprocessofthebases,soastocoverallinstancesofobjectsintheimageandavoidhavingallthesamplesconcentratedintheregionofasingleobjectinstance.Thisbecomesanissuewhenaparticular,moreprominentobjectinstancehashighersemanticclasspredictionprobabilitythanotherinstances.C.MatchingtheBasetoitsCongruentSets:Onceallthebasesetsaresampled,amatchingprocessisusedforeachoneofthesampledbases{{Bij}Aij=1}Ki=1tocomputeasetUij={u1,u2,u3,u4}of4-pointsfromMithatarecongruenttothesampledbases.Thebasicideaof4-pointcongruentsetswasderivedfromthefactthatratiosanddistancesonobjectsareinvariantacrossanyrigidtransformation[8].Thismatchingprocessgeneratesalargenumberofposecandidates{{Tij}Hij=1}Ki=1,severalofwhichareredundantduetodifferentcongruentpairsreturningsimilartransformsandthefactthatmostge-ometrieshavesymmetryalongmultipleaxes.Thus,thisworkfollowsagreedyapproachtoprovideadiversesubsetofthepopulation.TheapproachsortsallposecandidatesbasedontheLargestCommonPointsetscore[6]andpicksposerepresentativesthatarebeyondaminimumdistancefromalreadyselectedposes.Thedistanceheretakesintoaccountsymmetry,andthereareseparatethresholdsforrotationandtranslation,sincethesetwovariablesoperateindifferentspaces.Theresultingset{{Tij}Hij=1}Ki=1ofposerepresentativesthenundergoeslocalreﬁnementusingICP.2Bibliography[1]E.Brachmann,A.Krull,F.Michel,S.Gumhold,J.Shotton,andC.Rother.Learning6dobjectposeestimationusing3dobjectcoordinates.InECCV,2014.[2]B.Drost,M.Ulrich,N.Navab,andS.Ilic.ModelGlobally,MatchLocally:EfﬁcientandRobust3DObjectRecognition.InCVPR,2010.[3]S.Hinterstoisser,V.Lepetit,N.Rajkumar,andK.Konolige.Goingfurtherwithpointpairfeatures.InECCV,2016.[4]C.Mitash,A.Boularias,andK.Bekris.Robust6dobjectposeestimationwithstochasticcon-gruentsets.InBMVC,2018.[5]F.Michel,A.Kirillov,E.Brachmann,A.Krull,S.Gumhold,B.Savchynskyy,andC.Rother.Globalhypothesisgenerationfor6dobjectposeestimation.InCVPR,2017.[6]N.Mellado,D.Aiger,andN.Mitra.Super4PCS:FastGlobalPointcloudRegistrationviaSmartIndexing.InComputerGraphicsForum,2014.[7]J.Huang,T.-H.Kwok,andC.Zhou.V4PCS:Volumetric4PCSAlgorithmforGlobalRegistra-tion.JournalofMechanicalDesign,2017.[8]D.Aiger,N.Mitra,andD.Cohen-Or.4-pointsCongruentSetsforRobustPairwiseSurfaceRegistration.InACMTransactionsonGraphics(TOG),2008.3