SubmittedtotheAnnalsofAppliedStatisticsPOPULATIONBASEDCHANGE-POINTDETECTIONFORTHEIDENTIFICATIONOFHOMOZYGOSITYISLANDSBYLUCASPRATES1,RENANB.LEMES2TÁBITAHÜNEMEIER2ANDFLORENCIALEONARDI11InstitutodeMatemáticaeEstatística,UniversidadedeSãoPaulo2InstitutodeBiociências,UniversidadedeSãoPauloInthispaper,weproposeanewmethodforofﬂinechange-pointdetec-tiononsomeparametersofthedistributionofarandomvector.Weintroduceapenalizedmaximumlikelihoodapproachthatcanbeefﬁcientlycomputedbyadynamicprogrammingalgorithmorapproximatedbyafastgreedybi-narysplittingalgorithm.Weprovebothalgorithmsconvergealmostsurelytothesetofchange-pointsunderverygeneralassumptionsonthedistributionandindependentsamplingoftherandomvector.Inparticular,weshowtheassumptionsleadingtotheconsistencyofthealgorithmsaresatisﬁedbycat-egoricalandGaussianrandomvariables.Thisnewapproachismotivatedbytheproblemofidentifyinghomozygosityislandsonthegenomeofindividu-alsinapopulation.Ourmethoddirectlytacklestheissueofidentiﬁcationofthehomozygosityislandsatthepopulationlevel,withouttheneedofanalyz-ingsingleindividualsandthencombiningtheresults,asismadenowadaysinstate-of-the-artapproaches.1.Introduction.Indiploidorganisms,suchashumans,eachindividual’sgenomeisor-ganizedintopairsofchromosomes,eachhalfinheritedfromeachparent.Whenanindividualisanoffspringofbiologicallyrelatedparents,bothchromosomesofthesamepaircanshareidenticalsegments,creatinglongstretchesofconsecutivehomozygosity,knownasrunsofhomozygosity(ROH).Inthelastdecades,studiesontheidentiﬁcationofROHcarriedoutinhumanpopulationshaverevealedthepresenceofROHevenincosmopolitannon-inbredpopulations,disclos-inganincrementofinbreedinglevelsandtheconsequentreductionofgeneticdiversityofpopulations,whichisproportionaltothewalkingdistancefromAfrica,asexpectedbytheout-of-Africamodelofhumancolonization(Ceballosetal.,2018;Kirinetal.,2010;Lemesetal.,2018;Leuteneggeretal.,2011;Pembertonetal.,2012).ThedistributionofROHalongthechromosomesisveryuneven,resultinginsomege-nomicregionshavingsigniﬁcantabsence(coldspots)orexcessofROH(ROHislands)(Ce-ballosetal.,2018).Themechanismsfortheemergenceoftheseregionsarestillunderdis-cussion.Forexample,thereisevidencethatROHislandscouldrepresentregionsthatharborgenestargetofpositiveselectionsincelow-recombinationregionscommonlyarelocationsofselectivesweeps,inwhichanewbeneﬁcialmutationincreasesinfrequencyandbecomesﬁxed,causingtheoverallreductioningeneticdiversityoftheregion(Ceballosetal.,2018;Pembertonetal.,2012).TodetectROHandROHislands,thegeneticmaterialofindividualsfromagivenpopu-lationisgenotyped,andasetofsinglenucleotidepolymorphisms(SNPs)isobtained.EachSNPentryiscodiﬁedto1ifthatSNPbelongstoanROHforthatindividualandto0other-wise,whereamarkerisdeﬁnedasbelongingtoanROHforanindividualifitissurroundedbyaregionwithhighfrequencyofhomozygousSNPs.Finally,ROHislandsareregionsinKeywordsandphrases:changepointdetection,segmentation,regularizedmaximumlikelihood,parametricfamilyofdistributions,modelselection,dimensionalityreduction,unsupervisedlearning.1arXiv:2111.10187v1  [stat.ME]  19 Nov 20212whichROHaremostfrequentinthatpopulation.Thatis,thepositionsinthearraywithhighfrequencyofindividualROHpassingthroughthem.Therefore,wecanthinkontheproblemofROHislanddetectioninapopulationastheidentiﬁcationofregionswithhighfrequenciesof1’sinthecodiﬁedSNPsofindividualsofthatpopulation.Thatis,thisproblemcanberegardedasachange-pointproblemfortheparametersofamultidimensionalrandomvectorwithBernoullimarginaldistributions.1.1.Changepointdetection.Classically,changepointdetectionreferstotheproblemofdeterminingthetimesatwhichsequentialobserveddataundergoesanabruptchange.Inthattypeofsetting,achangepointmayrefertochangesinmean(Page,1954;Tsay,1988;Keshavarz,ScottandNguyen,2018),variance(ChenandGupta,1997;HawkinsandZamba,2005),regressionslope(Chow,1960;QuandPerron,2007),generaldistributionsforms(MattesonandJames,2014),orothertypesofchange.Manyofthesemethodshavebeenappliedtoawiderangeofproblemssuchasstreamanomalydetectioninindustry(Lietal.,2018),monitoringofsleepstagesusingEEG/EMG(Agudelo-Españaetal.,2020),identiﬁcationofcyberattacksonnetworks(Tartakovskyetal.,2006),betweenmanyotherinterestingapplications.Formorereferencesaboutchangepointmethodsfortimeseriesandotherapplications,wereferthereadertothebookChenandGupta(2012)ortherecentreviewsTruong,OudreandVayatis(2020)andLee(2010).AsNiu,HaoandZhang(2016)pointsout,fromamethodologicalpointofview,thereisavarietyofwaystoformulatethechange-pointdetectionproblem:onlinevs.ofﬂine,sin-glechangepointvs.multiplechangepoints,parametricvs.non-parametric,Bayesianvs.non-Bayesian,andmanyotherapproacheswhenwediveintospeciﬁcestimationprocedures.Butinmostoftheclassicalformulationsforchangepointdetection,theestimationproblemisconsideredunderthehypothesisthatthenumberofobservationsalongthedimensionofinterestgrows.EarlyresultsofHinkley(1970)showthat,evenformorestraightforwardprob-lems,thesemethodsareusuallyconsistentforthechangepointsfractions,butnotthechangepointsproperly.Forofﬂineissues,apossibleinterpretationisthatwehaveaﬁxednumberofseries(usuallyone)overaunitinterval.Whatgrowswiththenumberofobservations,inthiscase,istheresolutionoverthisinterval.Astechnologyadvancesandothertypesofdataarisefromdifferentapplicationareas,newtypesofchangepointdetectionproblemsariseaswell.TheROHislandsdetectionforapopulationisanexampleofthis.Indeed,herethedimensionofinterestisdiscreteandﬁnite,andwhatgrowsisthenumberofindependentobservationsoftherandomvector.Moreover,sincetheindicescorrespondtospeciﬁcpositionssuchasbiologicalmarkers,itisessentialtorecovertheexactlocationofthechangepoints.Therefore,inthiscase,theoreticalconsistencyresultsmustguaranteeconvergencetothetruechangepointsasthenumberofindependentobservationsofthejointmultidimensionaldistributiongrows.1.2.Ourcontributionandrelatedworks.Inthisworkweconsiderseveralaligned,in-dependentsamplesofamultidimensionaldistributionandweassumethedistributionhasablockstructurewithdifferentparametersoneachblock.Wefocusondetectingsuchchangesintheparameters,thatis,theboundariesoftheblockswhenthenumberofobservationsgrows.Weproposeapenalizedmaximumlikelihoodapproachtodetectthesetofchangepointsinthedistribution.Weallowformultiplechangepointswithoutassuminganaprioriﬁxed,knownnumber.Thepenalizedmaximumlikelihoodapproachhasalsobeenconsideredre-centlyinCastroetal.(2018);Leonardietal.(2021),butonadifferenttypeofchange-pointproblem.There,theapproachwasintroducedfornon-parametricdiscretedistributionsinor-dertodetectpointsofindependenceonamultidimensionalrandomvector,underindependentCHANGE-POINTDETECTIONOFHOMOZYGOSITYISLANDS3ornon-independentsampling.Hereweuseasimilarmethodologybutonadifferentproblem;namely,thedetectionofchangesonsomeparametersofthedistributionoftherandomvector.Wealsoshowhowtocomputetheexactestimatorbyadynamicprogrammingalgorithmandhowtoapproximatetheglobalsolutionbyanefﬁcientgreedybinarysegmentationalgorithm.Albeitusingaparametricapproach,wedonotconsideraspeciﬁcfamilyofdistributions.In-stead,westateasetofgeneralhypothesesthatthefamilymustsatisfyandthenprovetheconsistencyofthechangepointsetestimatorwhenthenumberofalignedsequencesgrows,fortheexactestimatoraswellasforthebinarysegmentationalgorithm.Theapproachpro-posedherenaturallyallowsustodirectlyusebootstraptechniquestoassessthevariabilityofthechangepointestimators.Bootstrapresamplingmethodshavebeenappliedbeforetocon-structconﬁdenceintervalsforthechangepointlocationinthesinglechangepointproblem(Antoch,HuškováandVeraverbeke,1995;HuškováandKirch,2008)oronmultiplechangepointproblems(Frick,MunkandSieling,2013).Wesuggestusingthebootstrapmethodtoapproximatetheprobabilityofeachindexbeingdetectedasachangepointandtomeasurethevariabilityoftheentiresetofchangepoints.Asimulationstudyispresentedtoprovideinsightsonthebehaviorofthealgorithmsandthebootstrapconﬁdenceestimationassamplesizegrows.Finally,wediscusstheidentiﬁcationoftheROHislandsontheAfricanandEu-ropeanpopulations,basedontheanalysisofSNPdatafromtheHumanGenomeDiversityProject(HGDP)(Lietal.,2008).WecomparetheROHislandsdetectedbyourmethodwiththosedetectedbytheprocedureproposedinMcQuillanetal.(2008);Kirinetal.(2010),usingthePLINKsoftware(Purcelletal.,2007),awell-establishedcommandlinesoftwaredesignedtosolvemanymedicalandpopulationgeneticsproblems.Itisworthmentioningthatthemethodologyforchange-pointdetectiondevelopedinthisworkisverygeneral,anditisnotrestrictedtodiscretedistributions.Inparticular,weverifytheconditionsleadingtotheconsistencyoftheestimatorsforstandarddistributionssuchascategoricalrandomvariablesandGaussianrandomvariables.Still,otherfamiliesofdistribu-tionscansatisfytheseconditions,wideningthepossibilityofapplyingourmethodtomanydifferentappliedproblems.2.ChangePointEstimation.2.1.Deﬁnitionofthemodel.LetmbeapositiveintegerandconsiderarandomvectorX=(X1,...,Xm)takingvaluesinAm,whereAisanystatespace.LetΘbeaparametricspaceandconsiderafamilyF={fθ|θ∈Θ}ofprobabilitydensitiesorprobabilitymassfunctionsoverA‘,foreach‘∈N,indexedbyθ∈Θ.WeassumeeachvariableXi,i=1,...,misdistributedaccordingtosomefθ∈F.Giventwointegersrands,withr≤s,weusethenotationr:sfortheset{r,r+1...,s}.DenotebyCtheclassofallorderedsetsC={c0,c1,...,ck}⊆0:msuchthatc0=0andck=m.WesaythatC∈CisachangepointsetfortherandomvectorXifthevariablesinthesubvector(Xcj−1+1,...,Xcj)areidenticallydistributedwithdistributionfθj∈Fandθj6=θj+1forallj=1,...,k−1.Observethatthechangepointvectorisunique,andfromnowonitwillbedenotedbyC∗.GivenanysetC∈C,wedenotebykCthenumberofpositiveelementsinC;thatis,ifC={c0,c1,...,ck}thenkC=k.AssumingtheblocksintherandomvectorXareindependent,wecanwritetheprobabilityofobservingx=(x1,...,xm)∈Aminthemodelwithparameters(C,θ),θ={θj∈Θ:j∈1:kC}by(2.1)P(C,θ)(x)=kCYj=1fθj(x(cj−1+1):cj),4wherefθj(x(cj−1+1):cj)representsthedistributionofarandomvectoroverAcj−cj−1withparameterθj.Theindependenceassumptionoverthedifferentblocksisnotanecessarycon-ditionforthemethodbutthegeneralizationtoanon-independentsettingisoutofthescopeofthiswork.Wepresentbelowtwowell-knownexamplesoffamiliesofdistributions,oneforcontinuousrandomvariablesandtheotherfordiscreterandomvariables,withtheexactexpressionforthelikelihoodfunction(2.1).EXAMPLE1.LetA={a1,...,ad}beaﬁnitesetandletF=np∈[0,1]d:p(ai)≥0anddXi=1p(ai)=1obethefamilyofallprobabilitydistributionsoverA.Thelikelihoodfunction(2.1)forx∈Amcanbewritten,forC∈Candθ=(p1,...,pk)asP(C,θ)(x)=kCYj=1cjYc=cj−1+1pj(xc).EXAMPLE2.Considerthefamily(2.2)F={f(µ,σ2):(µ,σ2)∈R×R+}ofprobabilitydensitiesoverA=R,wheref(µ,σ2)denotesthedensityofaGaussianrandomvariablewithmeanµandvarianceσ2.FixingthechangepointsetCwithkC=kandthevectorofparametersθ=((µj,σ2j))kj=1,thelikelihoodfunctionassumingthevariablesinxareindependentisgivenbyP(C,θ)(x)=kCYj=1cjYc=cj−1+1(2π)−1/2σ−1jexp(cid:8)−12(cid:16)xc−µjσj(cid:17)2(cid:9).2.2.Estimationandmodelselection.Considerasampleofni.i.d.randomvectorsxn={x(i)}ni=1distributedasX,withchangepointsetC∗=(c∗0,...,c∗k∗)andparametersθ∗=(θ∗1,...,θ∗k∗).OurmaingoalistoestimatethechangepointsetC∗andtheparametersθ∗.ForanyintegerintervalI⊂1:massumewecancomputethemaximumlikelihoodes-timatorbasedonthesubsample{x(i)j}i∈1:n,j∈I.WritethemaximumlikelihoodfunctionforthesetCofcandidatechangepointsas(2.3)L(C;xn)=nYi=1P(C,bθ)(x(i))=nYi=1kCYj=1fbθj(cid:16)x(i)(cj−1+1):cj(cid:17)wherebθjdenotesthemaximumlikelihoodestimatorcomputedonthesample{x(i)c}i∈1:n,c∈IjwithIj=(cj−1+1):cj.From(2.3)thelog-likelihoodfunctionisgivenby(2.4)l(C;xn)=nXi=1|C|Xj=1logfbθj(cid:0)x(i)(cj−1+1):cj(cid:1).LetR:C→RdenotesomeregularizationfunctionandJ:N→Ranincreasingfunctiononthesamplesizen.WeintroducethepenalizedlikelihoodestimatorbasedonthefunctionsRandJinthefollowingdeﬁnition.CHANGE-POINTDETECTIONOFHOMOZYGOSITYISLANDS5DEFINITION1.Givenasamplexnandaconstantλ>0,thePenalizedLikelihood(PL)functionforthesetofchangepointsCisdeﬁnedas(2.5)PL(C;xn)=−l(C;xn)+λR(C)J(n).ThePLestimatorforthechangepointsetisthendeﬁnedas(2.6)bC(xn)=argminC∈CPL(C;xn).AswewillshowlaterinTheorems1and2,inordertoobtaintheconsistencyofthechangepointestimatordeﬁnedby(2.6)weneedthefunctionsRandJtosatisfysomeproperties.Thiswillbemadepreciseinthestatementsofthesetheorems.3.ComputationoftheEstimator.Inordertoefﬁcientlyestimatethechangepointset,wesupposeinthissectionthattheregularizationfunctionRisadditive.Thatmeansthatthereexistsafunctionρ:{1,...,m}2→RsuchthatforC={c0,...,ck}wehave(3.1)R(C)=kCXj=1ρ(cj−1+1,cj).3.1.Dynamicprogrammingsegmentationalgorithm.AspresentedinJacksonetal.(2005),dynamicprogrammingcanbeusedtocalculateexactlythePLestimator.Underanadditiveregularization,thefunctionwewanttominimizecanbewrittenas−l(C;xn)+λJ(n)R(C)=kCXj=1−logfbθj(cid:16)x(i)(cj−1+1):cj(cid:17)+λJ(n)ρ(cj−1+1,cj)=kCXj=1Q((cj−1+1):cj),whereQ((cj−1+1):cj)=−logfbθj(cid:16)x(i)(cj−1+1):cj(cid:17)+λJ(n)ρ(cj−1+1,cj).Theequationshowsthatwecancompletelydecouplethelossfromdifferentblocks.LetCibethesetofallorderedchangepointsetsin1:i.DeﬁneF(i)=minC∈Ci(kXj=1Q((cj−1+1):cj))astheoptimalvalueforthesegmentationuptovariablei.TheestimatorbC(xn)givenby(2.6)isobtainedbycomputingF(m).ButnoticethatF(i)=minc∈(k−1):(i−1){F(c)+Q((c+1):i)},whichestablishesarecursionequationforthevaluesofF(i),ivaryingfrom1tom.ThevalueofF(1)canbecomputedtrivially,andthenweusetherecursiontocomputethevaluesuntilwereachF(m).Albeitmisﬁxedandonlyngrows,thenumberofvariablesmcanbeverylargeinsomeapplications,soitisusefultoexpressthecomplexityintermsofboth.Thedynamicpro-grammingsegmentationalgorithmrunsonatimecomplexityofO(m2).However,weareassumingthatQhavebeenpreviouslycomputedforallintervalsin1:m.6TocomputeQ,weneedtocomputethemaximumlikelihoodestimatorsforeachblock.Formostmodels,thiscanbedoneefﬁcientlybycomputingthesufﬁcientstatistics,andthencomputetheentriesofQ.ForthemodelspresentedinExamples1and2,thetimecomplexityforcomputingthesufﬁcientstatisticsisT(n,m)=O(nm),andthenO(m2)tocomputetheentriesofQ.Inthecasewherenosufﬁcientstatisticsexist,weneedtoreprocessthedataeverytime,sothecomplexitytocomputeQisO(nm3).Hence,theﬁnaltimecomplexityofthealgorithmisO(T(n,m)+m2).IntheworstcasethealgorithmisO(nm3),andcanbeveryslowforbigvaluesofm.Dependingonthefunctionρchosen,thePELTalgorithmofKillick,FearnheadandEck-ley(2012)mightbeapplicable.Itconsistsofanadaptationofthedynamicprogrammingalgorithmdiscussedhere.Insomescenarios,suchaswhenthenumberofchangepointsisproportionaltothenumberofvariables,itrunsinO(m).TheﬁnalcomplexitywouldbeO(nm+m)whensuitablesufﬁcientstatisticsexist.3.2.Hierarchicalsegmentationalgorithm.ForefﬁcientcomputationofbC(xn)wecanuseanapproximationtotheoptimumin(2.6),knownashierarchicalsegmentationorbinarysegmentation,ﬁrstproposedinScottandKnott(1974).GivenanintegerintervalI=r:s,writexnIforthedatawithcolumnsrestrictedtoIandassumethepenalizingfunctionRisadditive.DeﬁnethepenalizedlossofIasPL(I)=PL({0,s−r+1};xnI)=−l({0,s−r+1};xnI)+λρ(r,s)J(n),withtheappropriaterenumberingofthecolumnsinxnI.Thatis,thepenalizedlosscorre-spondingtotheintervalIisthepenalizedlossdeﬁnedin(2.5)whenweonlyconsiderthedataxnIandperformnosplits.WeusetheconventionPL(∅)=0.Forc∈I=r:s,deﬁne(3.2)hI(c)=PL(r:c)+PL((c+1):s).Observethatwhenc=s,byconventionwehave(s+1):s=∅sothathI(s)=PL(I).Thehierarchicalsegmentationalgorithmworksrecursivelyasfollows.ItbeginswiththesetbCHS(xn)={0,m}correspondingtothesingleintervalI=1:m.IneachiterationandforeachintervalIdeterminedbybCHS(xn),thealgorithmcomputesˆc=argminc∈IhI(c)andaddsittobCHS(xn).Observethatifinoneiterationˆc=s,ass∈bCHS(xn),nochangesaremadeonbCHS(xn).TheprocesscontinuesuntilnomorepointscanbeaddedtobCHS(xn).ToevaluatePLateachinterval,weeitherstoreallpossiblevaluesinthesamefashionasforthedynamicprogrammingalgorithmorweevaluatethemontherun.SincestoringwouldmakethealgorithmO(m2)inanyscenario,itismoreinterestingtopre-computethesufﬁcientstatisticsandevaluatethelossontheintervalsastheyappear.Intheworst-casescenario,thealgorithmhastimecomplexityoforderO(T(n,m)+m2).However,thealgorithmhasasymptoticcomplexityoforderO(T(n,m)+mkC∗)),asstatedinthenextproposition.PROPOSITION1.Thehierarchicalsegmentationalgorithmwillasymptoticallyperformexactly2kC∗−1recursivecalls.Moreover,itsasymptoticcomplexityisoforderO(T(n,m)+mkC∗),whereT(n,m)isthetimecomplexitytocomputethesufﬁcientstatisticsforeachinterval.TheproofofthispropositionisgiveninAppendixA.CHANGE-POINTDETECTIONOFHOMOZYGOSITYISLANDS74.ConsistencyoftheChangePointEstimators.Inthissectionwestatethetheoreticalresultsthatguaranteetheconsistencyoftheestimator(2.6)computedexactlybythedynamicprogrammingalgorithmorapproximatedbythehierarchicalsegmentationalgorithm.Foreachmethod,westateadifferentsetofassumptionsthatmustbesatisﬁedbythefamilyofprobabilitydistributionsconsideredinthemodel.ThenweprovethatstandardfamiliesofdistributionssuchasGaussianandcategoricalprobabilitydistributionssatisfytheseassump-tions.ASSUMPTION1.Supposethereexistsafunctionl∗:C→Rsuchthat(PL1)ForanyC∈Cwehavethat1nl(C;xn)→l∗(C)almostsurelyasn→∞,wherelisthelog-likelihoodfunctiondeﬁnedin(2.4).Moreover,assumethereexistsα>0suchthatinfC6⊇C∗l∗(C)≤l∗(C∗)−α<l∗(C∗).(PL2)Thereexistsasequence{v(n)}n∈Nsatisfyingv(n)→∞andv(n)/n→0whenn→∞,andsuchthatforanyC⊇C∗wehavethat(cid:12)(cid:12)l(C;xn)−l(C∗;xn)(cid:12)(cid:12)<v(n)eventuallyalmostsurelyasn→∞.Observethat(PL2)impliesthatl∗(C)=l∗(C∗)forallC⊇C∗.WenowstatetheconsistencyresultofthePLestimatorgivenin(2.6).THEOREM1.SupposethatthefamilyFofprobabilitydistributionssatisfyAssump-tion1.LetRbeapenalizingfunctionsuchthatR(C)>R(C0)wheneverC⊃C0andletJ(n)besuchthatJ(n)/v(n)→∞andJ(n)/n→0whenn→∞.Thentheestimatorofthechangepointsetgivenby(2.6)satisﬁesbC(xn)=C∗eventuallyalmostsurelyasn→∞.NoticethattheregularizationfunctionRdoesnotneedtobeadditivetoguaranteetheconsistencyofthePLestimator.However,thisisadesirablepropertytoefﬁcientlycomputetheestimatorbyusingthedynamicprogrammingsegmentationalgorithm.Inordertoprovethattheestimatorgivenbythehierarchicalsegmentationalgorithmisalsoconsistent,weneedaslightlydifferentsetofhypothesesconsideringthelocalnatureofthisalgorithm.DenotebyIthesetofallintervalsI⊂1:m.GivenI∈I,denotebybθIthemaximumlikelihoodestimatoroftheparameterθontheintervalIandasbefore,letxnIbethedatarestrictedtotheintervalI.Deﬁnethemaximumlog-likelihoodfunctionfortheintervalIasl(I;xnI)=nXi=1logfbθI(x(i)I).LethIbethelossfunctionfortheintervalIasdeﬁnedin(3.2).ASSUMPTION2.Thereexistsafunctionl∗:I→Rsuchthat8(H1)ForanyintegerintervalI∈Iwehavethat(4.1)1nl(I;xnI)→l∗(I)almostsurelyasn→∞.IfI=r:s,deﬁningh∗I:I→Ras(4.2)h∗I(u)=−l∗(r:u)−l∗((u+1):s),u∈I,wehavethat(4.3)minc∈I\{s}∩C∗h∗I(c)<minc6∈I\{s}∩C∗h∗I(c)(H2)Thereexistsasequence{v(n)}n∈Nsatisfyingv(n)→∞andv(n)/n→0whenn→∞,andsuchthat,foranyintegerintervalI=r:ssatisfyingI\{s}∩C∗=∅wehavemaxu∈I(cid:12)(cid:12)l(I;xnI)−l(r:u;xnI)−l((u+1):s;xnI)(cid:12)(cid:12)<v(n)eventuallyalmostsurelyasn→∞.Wecannowstatetheconsistencyofthechangepointsetestimatorgivenbythehierarchi-calsegmentationalgorithm.THEOREM2.Foranyλ>0,letbCHS(xn)betheestimatorcomputedbythehierar-chicalsegmentationalgorithm.SupposethatthefamilyFofprobabilitydistributionssat-isfyAssumption2.SupposethatRsatisﬁes(3.1)forsomefunctionρ:I→Randthatρ(I)<ρ(I1)+ρ(I2)wheneverI=I1∪I2,withI1,I26=∅.Finally,assumethatthefunc-tionJ(n)satisﬁesJ(n)/v(n)→∞andJ(n)/n→0whenn→∞.Then,bCHS(xn)=C∗eventuallyalmostsurelyasn→∞.Itturnsoutthatverifyingdirectlytheinequality(4.3)onAssumption2isusuallyhard.Wenowstatealemmathatprovideseasiertoverifyconditionsthatimplythedesiredinequality.LEMMA1.GivenanintegerintervalIassumethat(a)Thereexistsapointc∈Isuchthath∗I(c)<h∗I(s).(b)Thefunctionh∗Irestrictedtotheintervals[c∗j−1,c∗j],j=1,...,k∗,isconcave.(c)Ifh∗Iisconstantin[c∗j−1,c∗j],thenitisequalstoh∗I(s)onthisinterval.Then,thefunctionh∗Isatisﬁesthatminc∈I\{s}∩C∗h∗I(c)<minc6∈I\{s}∩C∗h∗I(c).Thefollowinglemmashowsthatundergeneralconditionsonthefunctionh∗Iveriﬁedinpracticebymanymodels,theconditionsofLemma1hold.LEMMA2.LetΘbeaconvexsubsetofRdforsomed∈N.ForanyintervalI∈IdeﬁnetheparameterθI=Pk∗k=1|I∩I∗k||I|θ∗r.Assumethefunctionh∗Ideﬁnedby(4.2),forI=r:s,isoftheformh∗I(u)=(u−r+1)ψ(θr:u)+(s−u)ψ(θ(u+1):s)+α,withψastrictlyconvexfunctionhavingsecondorderderivativesintheinteriorofΘandαaconstantnotdependingonu.Thenh∗Isatisﬁestheconditions(a)-(c)inLemma1.WenowstatetworesultsthatguaranteethatbothfamiliesofprobabilitydistributionsgiveninExamples1and2satisﬁesAssumptions1and2.Hence,boththedynamicprogrammingandhierarchicalsegmentationalgorithmsprovideconsistentestimatorsofthechangepointparameters(C∗,θ∗).CHANGE-POINTDETECTIONOFHOMOZYGOSITYISLANDS9PROPOSITION2.Thefamilyofdiscretecategoricaldistributions,aspresentedinExam-ple1,satisﬁesAssumptions1and2.PROPOSITION3.ThefamilyofGaussiandensities,aspresentedinExample2,withunknownmeanandconstantknownvarianceforall2blockssatisﬁesAssumption1and2.TheproofofProposition2ispresentedinAppendixAandtheproofofProposition3isgivenintheSupplementaryMaterialtothisarticle,jointlywithresultsofsimulationsimplementedforthisspeciﬁcfamilyofdistributions.5.BootstrapMethodstoAssessVariability.Acriticismusuallymadetochangepointdetectionmethodsisthattheyoftendonotprovidemeasuresofvariabilityorconﬁdencesetsfortheestimatedchangepointsset.Here,weproposetheusageofbootstrapmethodstotacklethisproblem.AsmentionedintheIntroduction,inoursetting,eachindexusuallyhasaspeciﬁcinterpre-tation,suchasbeingageneticmarkeroraparticularpositiononariver.Hence,aresearchermightbeinterestedinthestatisticalsigniﬁcanceofagivenpointdetectedasachangepoint.Toknowhowlikelyanindexcin1:(m−1)isdetectedasachangepointonamodelwithparameters(C∗,θ∗)wecancomputep(c)=P(C∗,θ∗)(cid:0)c∈bC(cid:1).Sinceourscenarioassumestherowsofxncorrespondtoi.i.dsamplesofthevectorX,boot-strapresamplingisstraightforward.ResamplingBdatasetsxn,1,...,xn,BwiththesamedimensionofxnbyusingthebootstrapontherowsofxnandcomputingthechangepointsetbC(xn,b)forb=1,...,B,thebootstrapestimateforthequantityaboveisˆp(c)=1BBXb=11bC(xn,b)(c),where1bC(xn,b)(c)denotestheindicatorfunctionthatc∈bC(xn,b).Inpractice,however,itmightbedifﬁcultfortheresearchertopinpointtheexactlocationofthechangepointbefore-hand.Hispracticalexperiencemostlikelyindicatesthatachangeoccurswithinanregion.Then,wecanaddressthequestionofhowsigniﬁcantitisfortheintervalItocontainachangepointbycomputingp(I)=P(C∗,θ∗)(cid:0)I∩bC6=∅(cid:1).Thisquantitycanbeestimatedbyˆp(I)=1BBXb=11{I∩bC(xn,b)6=∅}.Tomeasurethevariabilityofthewholeestimatedchangepointset,wecouldconsiderametricddeﬁnedonsetsinC.OurinterestwouldbetocalculateE(C∗,θ∗)(cid:2)d(C∗,bC)(cid:3)andVar(C∗,θ∗)(cid:2)d(C∗,bC)(cid:3).ByreplacingC∗bybC(xn),thebootstrapestimatesofthesequantitiesare¯d=1BBXb=1d(bC(xn),bC(xn,b))andcVar(d)=1BBXb=1(cid:2)d(bC(xn),bC(xn,b))−¯d(cid:3)2,respectively.10FIG1.ComparisonofestimatedchangepointsetsbetweenalgorithmsandagainstgroundtruthfortheBernoullifamilyusingtheJaccardIndex(top)andthenumberofchange-points(bottom).Thetruenumberofchangepointsk∗isindicatedontopofeachﬁgureandmarkedonthepurpledottedhorizontalline.6.Simulations.Inthissectionweshowtheresultsofasimulationstudytocomparetheconvergenceofbothalgorithmsassamplesizeincreases.Weconsidertwofamiliesofdistributions:theBernoullidistributionandtheGaussiandistributionwithbothmeanandvarianceunknown(resultsavailableasSupplementaryMaterial).Weﬁxedthenumberofvariablesmandvariedthenumberofchangepointsinthemodel.Forbothdistributions,wevariedthenumberofsamplesnfrom50to500instepsof50.Foreachsamplesize,wesimulated1000datasetswithnsamples.Weﬁxedthenum-berofvariablesasm=200andthenumberofchangepoints|C∗|=k∗totakevaluesin{10,20,50}.Foreachk∗,thechangepointsweresampledwithoutreplacementfromauni-formdistributionin[1,199]andwheremaintainedﬁxedforalldatasetsandallsamplesizes.Bernoulliparametersweresampledindependentlyfromauniformdistribution.FortheGaus-siandistribution,meansweresampledindependentlyfromaN(0,√5),andvariancesfromanExp(1).Theseparametersalsoremainedﬁxedforalldatasetsandallsamplesizes.Thepenalizationconstantλwasselectedfromtheset{0.1,1,10}.Themodelswereﬁttedforeachλintheset,andthenBICwasusedtochoosetheﬁnalmodel.Thepenalizationfunc-tionsweresettoJ(n)=log(n)andρ(r:s)=1.Inordertoevaluatetheconvergenceofthechangepointsetestimatedbyboth,thedynamicprogrammingandhierarchicalsegmentationalgorithms,weconsideredtheJaccardIndex,deﬁnedbyJ(C1,C2)=|C1∩C2||C1∪C2|.CHANGE-POINTDETECTIONOFHOMOZYGOSITYISLANDS11FIG2.Percentageofdetectionbythehierarchicalsegmentationalgorithmofeachindexasachangepoint.Arandomdatasetfromthescenariok∗=10,n=250andBernoullifamilywasselected,and200bootstrapsampleswereobtained.Blacklinesshowhowfrequentlytheparticularindexeswereestimatedaschangepoints.Verticaldashedredlinesindicatethepositionofthetruechangepointsonthesimulatedmodel.Wealsotookintoaccounttheconvergenceoftheestimatednumberofchangepointstok∗.Itallowustoseewhenthemodelisheavilyunderestimatingoroverestimatingthenumberofchangepoints.Figure1showsthatbothalgorithmsareconvergingtothetruechangepointsetassamplesizesgrow.Theboxplotsonthetoparebecomingincreasinglynarrowerandcloserto1,whichindicatestotalsimilaritybetweenthechangepointsets.Fork∗=10,mostvaluesareindeed1,asindicatedbythecollapsedboxplotsfromsamplesizesgreaterorequalto350.Wealsoobservethattheperformanceofthealgorithmsareverysimilarassamplesizesgrow,sincetheboxplotsshapesbecomesimilar.Thehierarchicalalgorithmexhibitsmorevariability,sincetheboxplotsarewiderandhavemoreoutliers.Thegraphicsonthebottomrowoftheﬁgure,thatdisplayboxplotsandaveragelinesfortheestimatednumberofchangepoints,helpusunderstandalsothebehaviorofthealgorithmsassamplesizeincreases.FortheproposedbootstrapprocedureofSection5,weevaluatedhowlikelyeachindexwasestimatedasachangepointbythehierarchicalalgorithmonthek∗=10scenario(Figure2).Intuitively,weexpectthechangepointdetectionratetobehigherandwithlessvariabil-ityiftheblocksitdivideshaveverydiscrepantparametersandarelarger.FortheBernoullimodel,wecanasseshowthedetectionratevarieswiththeabsolutedifferencebetweencon-secutiveparametersoneachblock,asobservedinFigure3.Thedetectionofeachofthechangepointsincreaseswithsamplesize,andthatchangepointswhichseparatesblockswithhigherabsolutedifferenceofprobabilityparametersaredetectedmorefrequently.7.ROHislandsonAfricanandEuropeanpopulations.Asdescribedintheintroduc-tion,weproposetoframetheproblemofROHislandsdetectionasachangepointdetectionproblemassumingaBernoullimarginaldistributionforeachcodiﬁedSNP.ObservethatwedonotneedtoassumeindependencebetweendifferentSNPsinordertohaveconsistentes-timatorsofthechange-points,weonlyassumeconsecutiveparametersontheblocksofthedistributionaredifferent.Inparticular,theROHislandscanbedeterminedasthoseblockswithahighvalueoftheestimatedparameter.Choosingaregularizationfunctionthatsuitstheproblemisnotaneasytask.Wecanusedomainknowledgetoconstructaproperregularizationfunction.TheﬁrstconsiderationisthatthedistancebetweenSNPsisnotuniform.Thatis,thedistancebetweenthei-thandj-th12FIG3.Thecurvesontheleftﬁgureshowsthebootstrapaveragedpercentageofdetectionoftruechange-pointsassamplesizegrows.Theaverageistakenoverdatasetswiththesamesize.Thecurveontherightshowstheabsolutedifferencebetweentheparametersoftheblockstheydivide.Thedifferenceisplottedwithrespecttothechange-pointindex(cpindex)andnotlocationontherandomvector.FIG4.ROHregions(greenandbluesegments)asdeﬁnedbyourmethod(top)andbyPLINk(bottom)forAfrican(left)andEuropean(right)populations.EachrowcorrespondstoanindividualandeachcolumntoaSNPmarker.ThebluesegmentsonthetopgraphicscorrespondtoindividualsnothavingROHdetectedbyPLINK.SNPisnot|i−j|,butrather|B(i)−B(j)|,whereBisafunctionthatmapseachSNPtoitsphysicallocationonthechromosome.ThephysicallocationofaSNPismeasuredasthenumberofbasepairsbeforethatparticularSNP.ThesecondobservationisthatverysmallCHANGE-POINTDETECTIONOFHOMOZYGOSITYISLANDS13blocksareusuallynotinterestingfortheanalyst.ItisusualtosetaminimumblocksizeinwhichSNPsaregrouped.Consideringtheseobservations,wedeﬁnetheregularizationfunctionρfortheblockr:sasρ(r,s)=(+∞if|B(s)−B(r)|β≤T1|B(s)−B(r)|/βotherwise.Intheexpressionabove,TdenotesathresholdfortheminimalphysicaldistanceallowedforanROHisland,andβ=106isascalingfactortoworkonmegabasesunit.TheregularizationfunctionR(C)in(2.5)isthendeﬁnedasthesumofthefunctionρoverthedifferentblocksinC,asin(3.1).TheSNPsdataweanalyzedwasobtainedfromtheHumanGenomeDiversityProject(HGDP),andconsistsofapproximately600,000SNPmarkersfromIlluminaHuHap650kplatform(Lietal.,2008).WeconsideredindividualsfromAfricanandEuropeanpopulations.Onthisdataset,eachrowrepresentsanindividualfromthepopulation,andeachcolumncorrespondstoeachSNP.Foreachpopulation,weperformedROHidentiﬁcationforeachindividualwiththecriteriadescribedbyMcQuillanetal.(2008)andKirinetal.(2010),usingthesoftwarePLINKv1.9(Purcelletal.,2007),andcomparedtothedataafterpreprocessing.Theresultsforchromosome22onbothpopulationsareshowninFigure4.Wethenestimatedthechange-pointsetandparametersoneachblockforeachpopulationusingavalueofλthatwasselectedusingBICfromtheset{0.1,1,10}.ThethresholdsizeTwassettobe1%ofthechromosomesize,andthepenalizationforthesamplesizesettoJ(n)=√n.Figure5showsacomparisonbetweenthehighfrequencyregionsdetectedbyPLINKandbyourmethod.Forbothpopulations,weobservethatthepeakswithhigherROHfrequencydetectedbyPLINKingeneralcorrespondtoblockswithhigherparameterdetectedbythechangepointdetectionmethod.TherearealsoblockswithhighparameternotdetectedbyPLINK,showingthatthemethodsdonotalwaysprovidethesameROHislands.ThiscanbeunderstoodifwelookbackatFigure4.Thereareregionsthathaveaveryhighnumberofoverlappingblocksintheprocesseddata,butthatdonotappearatPLINK.SincetheycorrespondtoregionswithuninterruptedhomozigositySNPsintheprocesseddata,theoutputofourmethodwilldetectsuchregionsasablockwithveryhighprobabilityparameter,butnotinPLINK,sincealmostnoindividualswithROHhavedetectedROHatthatregion.Thesecontrastingregionscanriseduetosmallvaluesofthepreprocessingparameter,PLINK’scriteria,orthepresenceofahighamountofmissingdatainaspeciﬁcgenomicregion.Finally,Figure6showsanapplicationofthebootstraptoprovidehowreliableisthees-timateofthechangepointset.Weseesomespikesonthepercentageofdetectionnearthestartofmostblocks,indicatingtheseareindeedthemostdetectedindices.However,noticethatthespikesdonothaveaveryhighpercentageofdetection.Thisisduetothefactthatthechangepointsoscillateneartheendsofthesegments.Sinceonlyonechangepointcanbedetectedatatimeinsuchregionsduetotherestrictionimposedontheminimumblocksize,theconﬁdenceofdetectionactuallyreferstotheconﬁdenceofthechangepointsonagivenregionandnotonaspeciﬁcposition.Alastinterestingobservationisthatsomeblockshavealmostnopercentageofchangepointsdetectedintheircentralparts,indicatingthatthemodelisconﬁdentabouttheboundariesofmostoftheblocks.8.Discussion.Inthispaper,westudiedadifferentchangepointdetectionscenariothatariseswithnewapplications.Theinferentialgoalsarethesameastheclassicalproblem,butconsistencyisstudieddifferently,andexactestimationforthechangepointsetisrequired.We14FIG5.Comparisonbetweentheblocksdetectedbythechange-pointmethodandthemethodologyproposedinMcQuillanetal.(2008)andKirinetal.(2010),usingPLINK.TheblacklinesindicatethefrequencyofoccurrenceofeachSNPinanROHasdetectedbyPLINK(leftscale).Thepurplelinesindicatetheblocksdetectedbyourmethodology.Theheightofeachblockcorrespondstotheestimatedparameteroneachblock(rightscale).provedthatapenalizedmaximumlikelihoodapproachcanbeappliedandthatthismethodconsistentlyestimatesthechangepointsetfordifferentclassesofdistributionfamilies.Wealsoshowedhowthebootstrapcouldbeusedtoobtainconﬁdenceestimatesforeachchangepointandthewholechangepointset.Thepenalizationconstantλappearinginthedeﬁnitionoftheestimatorhastobesetbytheuserorestimatedfromdata.Ourtheoremsguaranteethatthealgorithmsareconsistentaslongastheconstantisﬁxed.However,sincethespeedofconvergencedependsonthisconstant,itisinterestingtoselectavaluethatenhancesconvergencespeed.Ifourmethodisusedinaregressionsettingaspartoffeatureselectionforotheralgorithm,cross-validationcanbeusedtoselectapropervalueforλ.Ifitisusedinamoredescriptivemanner,BICcanbeusedforselection,suchasappliedinthesimulations.AslongastheCHANGE-POINTDETECTIONOFHOMOZYGOSITYISLANDS15FIG6.Bootstrapconﬁdenceofdetectionoftheestimatedchangepointsetwith500replications.Leftscaleshowsthebootstrappercentageofdetectionasachangepointperindex.Thepurplelinesindicatetheblocksdetectedbyourmethodology.Theheightofeachblockcorrespondstotheestimatedparameteroneachblock(rightscale).proposedsetforlambdaisﬁniteandﬁxed,thealgorithmscontinuetobeconsistent.Thesim-ulationstudysuggeststhatthechoiceofthealgorithmshoulddependonsamplesizes.Theperformanceofthehierarchicalalgorithmseemstobeequivalenttotheexactsolutionpro-videdbythedynamicalprogrammingalgorithmforbiggersamplesizes.Theexactalgorithmremainsbetterforsmallsamplesizessinceitseemsmorerobustwhenselectingthepenaliza-tionconstant.ThereisaclearspeedgainusingthegreedyapproachsinceitisasymptoticallyO(m(n+|C|)),whiletheexactalgorithmhascomplexityO(nm+m2).Thisdifferenceiscrucialinhighdimensionalanalysis,suchasapplicationsingenetics.Ofcourse,limitingthenumberofestimatedblocksalsoaidsintimespeedandmightavoidover-segmentation.Thisnewapproachforchangepointdetectionismotivatedbytheproblemofidentifyinghomozygosityislandsonthegenomeofindividualsinapopulation.Ourmethoddirectlytacklestheissueofdeterminingthehomozygosityislandsatthepopulationlevelwithout16analyzingsingleindividualsandthencombiningtheresults,asismadenowadaysinstate-of-the-artapproaches.ApplyingthismethodtorealdataoftwopopulationsfromtheHumanGenomeDiversityProject(HGDP)showedthepotentialityofthesealgorithmstohighlighthighlyhomozygousregionsinthegenome.Thenon-homogeneityoftheregularizationfunc-tionRcanprovideﬂexibilitytoincorporatemoredomainknowledgeoftheapplicationarea.Thereismuchtoexploreinfutureresearch.Aﬁrststepwillbetocheckiftheassumptionsholdforawiderclassofdistributions,suchasExponentialFamily,ﬁnite-stateMarkovChainsandMultivariateGaussianwithineachblock.Forthei.i.dGaussianwithunknownmeanandvariance,theproofthatassumption1holdsisverysimilartotheoneprovidedforthecasewithknownvarianceinthesupplementarymaterial.However,provingassumption2seemstobemorechallenging.Asecondinterestingquestionistoproveorgiveacounter-exampleofwhether2implies1.Thatisiftheconvergenceofthegreedyalgorithmimpliestheconvergenceoftheexactalgorithmaswell.Athirdinterestingquestionishowtoderiveratesofconvergenceofthechangepointsetestimators.9.Additionalinformation.Simulationsandcomputationoftheestimatorswereper-formedusingtheRsoftwareRCoreTeam(2020)andtheRpackageblockcpddevelopedforthistask.Thepackageprovideseasy-to-usedrofusageandimplementsthealgorithmsfortheBernoulli,Gaussianwithunknownmeanandvariance,ExponentialandPoissonfamiliesforthei.i.dcase.AnimplementationforatwostateMarkovChainisalsoprovided.Thec++RframeworkprovidedbytheRcpppackage(EddelbuettelandFrançois,2011;EddelbuettelandBalamuta,2017)wasusedtoovercomeperformancebottlenecks.Acknowledgments.ThisarticlewasproducedaspartoftheactivitiesofFAPESP’s1Research,InnovationandDisseminationCenterforNeuromathematics,grant2013/07699-0,andFAPESP’sprojects“Stochasticmodelingofinteractingsystems”,grant17/10555-0and“Modelselectioninhighdimensions:theoreticalpropertiesandapplications”,grant2019/17734-3.DuringthedevelopmentofthisworkL.PwassupportedbyaCAPES2fel-lowship.F.LispartiallysupportedbyaCNPqresearchfellowship,grant311763/2020-0.APPENDIXA:PROOFSOFTHEORETICALRESULTSInthissectionwepresenttheproofsofProposition1statedinSection3andallthetheo-reticalresultsstatedinSection4.PROOFOFPROPOSITION1.Wewillﬁrstprovethatthealgorithmwilleventuallyalmostsurelydoexactly2kC∗−1recursivecallsbyinductiononkC∗.ConsiderthebasecaseC∗={0,m},whenthereisnochangepointexcepttheextremes.Theﬁrstrunofthealgorithmisalwayson1:m.Sinceitisasymptoticallycorrect,ithaltsaftertheﬁrstiteration.Therefore,thenumberofrecursivecallsis1=2kC∗−1.NowsupposethattheformulaholdsforkC∗≤K−1foranyvalueofm,wewillprovethatitholdsforkC∗=K.Attheﬁrstcall,thealgorithmselectsachangepointcandcreatesarecursivecallon1:candon(c+1):m.LetNlbethenumberofchangepointson1:candNrbethenumberofchangepointson(c+1):mUsinginductionhypothesis,wehavethatthealgorithmdoes2(Nl+1)−1callson1:cand2(Nr+1)−1on(c+1):m.NoticethatNl+Nr=K−2becausekC∗=KimpliesthereareK−1changepointsfortheoriginalchangepointset,butcisnotcountedonNlorNr.Hence,thetotalnumberofcallsis1+(2Nl+1)+(2Nr+1)=2(Nl+Nr)+3=2K−1.1SãoPauloResearchFoundation,Brazil2CoordinationofSuperiorLevelStaffImprovement,BrazilCHANGE-POINTDETECTIONOFHOMOZYGOSITYISLANDS17Toobtaintheﬁnalcomplexity,notethatacallintheintervalr:sthealgorithmdoes|s−r+1|≤m+1comparisonsandmemorychecks,andthereforehascomplexityofO(mkC∗)).PROOFOFTHEOREM1.FirstwewillprovethatbC(xn)willalmostsurelycontainC∗.LetC∈CsuchthatC6⊇C∗.Thenby(PL1)inAssumption1wehavethateventuallyalmostsurely1nl(C;xn)−1nl(C∗;xn)<−α2.Ontheotherhand,asJ(n)=o(n)andR(C)isboundedwehavethatλ(R(C)−R(C∗))J(n)n→0asn→∞.Therefore,eventuallyalmostsurelywehavePL(C∗;xn)<PL(C;xn).AsthenumberofC6⊇C∗isﬁnitewehavethateventuallyalmostsurelybC⊇C∗.LetsprovenowthatbC6⊃C∗.AssumeC⊃C∗sothatR(C)>R(C∗)andl∗(C)=l∗(C∗).Then,by(PL2)wehavethatPL(C∗;xn)−PL(C;xn)≤v(n)+λ(R(C∗)−R(C))J(n)<0(A.1)eventuallyalmostsurelyasn→∞.AsaresultweobtainthatbC(xn)=C∗eventuallyalmostsurelyasn→∞.Wenowpresenttheproofoftheconsistencyofthehierarchicalestimator.PROOFOFTHEOREM2.Theproofbeginsbyshowingthat,atanygivenpossiblesce-nario,thealgorithmtakesacorrectchoicealmostsurely.Then,aninductiveargumentwillguaranteethatthealgorithmisconsistent.ForeveryintegerintervalI=r:s,thepossiblescenariosare:(a)TherearenochangepointsinI\{s};(b)TherearechangepointsinI\{s}.Thecorrectdecisionforthealgorithmincase(a)istohalt,notperformingmorerecursivecallsforthatinterval.Forcase(b),thecorrectdecisionistochooseanyofthechangepointsavailableandperformrecursivecallsonthesubintervals.Weshowthatthealgorithmwilltakethecorrectdecisionalmostsurelyforbothcases.Forcase(a),supposeIhasnochangepointsinsideandletu∈r:(s−1).By(H2)inAssumption2wehavethathI(s)−hI(u)=−[l(I;xnI)−l(r:u;xnI)−l((u+1):s;xnI)]++J(n)λ[ρ(r,s)−ρ(r,u)−ρ(u+1,s)]<v(n)+J(n)λ[ρ(r,s)−ρ(r,u)−ρ(u+1,s)]<0,eventuallyalmostsurelyasn→∞,becauseρ(r,s)−ρ(r,u)−ρ(u+1,s)<0.Hence,nosplittingwillbedoneeventuallyalmostsurely,andthealgorithmwillnotperformmore18recursivecallsinsideI.Forcase(b)wehavetoprovethatthealgorithmwillalmostsurelychoosetruechangepointstosplittheinterval.Theinequality(H1)onAssumption2impliesthat,foranyuthatisnotachangepoint,thereexistsachangepointc∗inI\{s}suchthath∗I(c∗)<h∗I(u).ThenasJ(n)=o(n)wehavethateventuallyalmostsurelyasn→∞1nh(u)−1nh(c∗)≥12(h∗(u)−h∗(c∗))>0,andthereforeˆc∈C∗,eventuallyalmostsurelyasn→∞.Weﬁnishtheproofbyusingmathematicalinductiononthenumberofvariablesm.Ifm=1,thentherearenochangepointsonthemodel,andthealgorithmwillnotevenhavecomparisonstomake.Hence,theestimatedchangepointsetwillbeemptybyconstructionandthereforeequaltothetruesetofchangepoints.Assumenowthatthealgorithmisconsis-tentforeveryvectorofdimension˜m<=m−1.Wewillprovethatitwillbeconsistentforvectorsofdimensionm.Theﬁrstrunofthealgorithmisontheinterval1:m.Bycase(a),iftherearenochangepointsonthisinterval,thealgorithmwillalmostsurelynotsplittheintervalandwillhalt.Hence,theestimatedsetwillalmostsurelybeequaltothetruesetofchangepoints.Ontheotherhand,iftherearechangepointsontheinterval1:m,theproofincase(b)showsusagainthatthealgorithmeventuallyalmostsurelytakesthecorrectchoiceandsplitstheintervalatachangepointc∈C∗.Afterthesplit,recursivecallsaremadeon1:candon(c+1):m.Butthelengthofthesevectorsisatmostm−1,andbytheinductionhypothesis,thealgorithmwilleventuallyalmostsurelyretrieveallthechangepointsin1:cand(c+1):mexactly.Byaunionofthosechangepointsets,wehavethattheﬁnalestimatedchangepointsetisequaltoC∗eventuallyalmostsurelyasn→∞.PROOFOFLEMMA1.Leth∗I(u)betheminimumvalueofh∗IonI.First,noticethatby(a),h∗I(u)≤h∗I(c)<h∗I(s),sotheminimumisstrictlysmallerthanthevalueofthefunctionattheendoftheinterval.WenowshowthatumustbeachangepointinC∗.Supposethatu6∈C∗,andletI∗j=[c∗j−1,c∗j]betheuniqueintervalthatcontainsu.Sinceh∗Iisconcavein[c∗j−1,c∗j+1],iftheminimumisattainedataninteriorpoint,thenh∗ImustbeconstantonI∗j.However,by(c),thiswouldimplythath∗I(u)=h∗I(s),whichisacontradiction.Thenu∈C∗andminc∈I\{s}∩C∗h∗I(c)<minc6∈I\{s}∩C∗h∗I(c).BeforepresentingtheproofofLemma2westateandprovethefollowingbasiclemma.LEMMA3.Letf,g:R→Rbetwicedifferenciableconvexfunctions.Ifthereexistsaconstantαsuchthatf(x)+g(x)=α,thenfandgmustbelinearfunctions.PROOF.Differentiatingbothsidestwiceweobtainthatf00(x)+g00(x)=0.Sincebothf00(x)≥0andg00(x)≥0,thenf00(x)=0=g00(x)andtheresultfollows.CHANGE-POINTDETECTIONOFHOMOZYGOSITYISLANDS19PROOFOFLEMMA2.Observethatitisenoughtoconsiderh∗Iasgivenbyh∗I(u)=−(u−r+1)ψ(θr:u)−(s−u)ψ(θ(u+1):s),u∈I,astheconstantCdoesnotdependonu.Foranyu∈[c∗j−1,c∗j]deﬁnet(u)=c∗j−1−r+1u−r+1.Thenwecanwriteθr:u=t(u)θr:c∗j−1+(1−t(u))θ∗j.WenowcheckeachoneoftheconditionofLemma2,beginningwith(b).Toprovethath∗Iisconcaveontheinterval[c∗j−1,c∗j],itissufﬁcienttoshowthat(u−r+1)ψ(θr:u)and(s−u)ψ(θ(u+1):s)areconvexonthisinterval.Takeg(u)=(u−r+1)ψ(θr:u),andtreatthevectorsascolumnvectors.Thentheﬁrstderivativeofgisg0(u)=ψ(θr:u)+(u−r+1)t0(u)(θr:c∗j−1−θ∗j)T∇ψ(θr:u)=ψ(θr:u)−t(u)(θr:c∗j−1−θ∗j)T∇ψ(θr:u),where∇ψ(θr:u)isthegradientofψ(θ)evaluatedatθr:uandthesecondequalityfollowsfromthefactthat(u−s+1)t0(u)=−t(u).Thesecondderivativeofgistheng00(u)==0z}|{t0(u)(θr:c∗j−1−θ∗j)T∇ψ(θr:u)−t0(u)(θr:c∗j−1−θ∗j)T∇ψ(θr:u)+(−t0(u)t(u))(θr:c∗j−1−θ∗j)THψ(θr:u)(θr:c∗j−1−θ∗j)≥0,becauseHψ(θr:u),theHessianmatrixofψevaluatedatθr:u,ispositivedeﬁniteand−t0(u)t(u)≥0.Weconcludethatgisconvexon[c∗j−1,c∗j].Ananalogousargumentshowsthat(s−u)ψ(θ(u+1):s)isalsoconvex,andthenweﬁnishverifyingcondition(b)inLemma1.Nowwewillshowthat,ifh∗Iisconstantonaninterval[c∗j−1,c∗j],thenitmustbeequaltoh∗I(s)onthisinterval.Sosupposethath∗Iisconstanton[c∗j−1,c∗j].Then,forsomeαwemusthavethat(A.2)−(u−r+1)ψ(θr:u)−(s−u)ψ(θ(u+1):s)=αforallu∈[c∗j−1,c∗j].Lemma3impliesthat(u−r+1)ψ(θr:u)and(s−u)ψ(θ(u+1):s)mustbelinearfunctionson[c∗j−1,c∗j],thereforeψ(θr:u)andψ(θ(u+1):s)areconstants.Sinceψisstrictlyconvexandθr:u(respectivelyθ(u+1):s)isaconvexcombinationofθr:c∗j−1andθ∗j(respectivelyofθc∗j:sandθ∗j),weconcludethatθr:u=θ∗j=θ(u+1):sforallu∈[c∗j−1,c∗j].MoreoverwehavethatθI=1|I|(cid:2)(u−r+1)θr:u+(s−u)θ(u+1):s(cid:3)=θ∗jandthereforeh∗I(u)=h∗I(s),implyingcondition(c)inLemma1.Weﬁnishtheproofbyshowingcondition(a)inLemma1,thatisthattheminimumisattainedattheinteriorofI.Supposethatthisisnotthecase,thatisthattheminimumisattainedath∗I(s).Sinceh∗I(s)isalsoamaximum,becausebydeﬁnition1nl(r:u)+1nl((u+1):s)≤1nl(r:s)forallu∈IwehavethatthefunctioninthewholeintervalImustbeconstant.Followingthesameargumentsasintheproofofcondition(b)weconcludethatθ∗i=θ∗jforalli,j∈{1,...,k∗},whichisacontradictionwiththehypothesisthatθ∗j6=θ∗j+1forallj=1,...,k∗−1.20WewillnowverifythatAssumptions1and2holdforthefamiliesofdistributionsinExamples1and2.TheseresultswerestatedinPropositions2and3,respectively.PROOFOFPROPOSITION2.DenotebyC∗={c∗0,...,c∗kC∗}andp∗=(p∗1,...,p∗kC∗)thetruechangepointsetandparameters,respectively.WewilldenotebyC={c0,...,ckC}andp=(p1,...,pkC)anyarbitrarychangepointsetandwewilldenotebyIj,respectivelyI∗j,theintervalbetweentwochangepointsinC,respectivelyinC∗,thatisIj=(cj−1+1):cjandI∗j=(c∗j−1+1):c∗j.Webeginbyverifyinghypotheses(PL1)and(PL2)inAssumption1.Inthecaseofcategoricalrandomvariables,thelog-likelihoodfunction(2.4)forthesamplexn={x(i)}ni=1,evaluatedatthemaximumlikelihoodestimatorforθcanbewrittenas(A.3)l(C;xn)=kCXj=1Xa∈ANIj(a)logNIj(a)n|Ij|,where(A.4)NIj(a)=nXi=1cjXc=cj−1+11{x(i)c=a}.Tocheck(PL1)inAssumption1letanysetC∈C.BytheLawofLargeNumberswehavethat1nl(C;xn)→kCXj=1|Ij|Xa∈AˆpIj(a)logˆpIj(a)=:l∗(C),withˆpIj(a)=kC∗Xr=1|Ij∩I∗r||Ij|p∗r(a)a∈A.Moreover,ifC6⊇C∗wehavethatl∗(C)−l∗(C∗)=kCXj=1kC∗Xr=1|Ij∩I∗r|Xa∈Ap∗r(a)logˆpIj(a)−kC∗Xr=1|I∗r|Xa∈Ap∗r(a)logp∗r(a)=kCXj=1kC∗Xr=1|Ij∩I∗r|Xa∈Ap∗r(a)logˆpIj(a)p∗r(a)<0(A.5)unlessˆpIj=p∗rforallrandjwith|Ij∩I∗r|6=∅.ButthiscanonlyhappenifC⊇C∗,whichisacontradiction.Toverifyhypothesis(PL2)observethatforanyC⊇C∗l(C;xn)−l(C∗;xn)=kCXj=1Xa∈ANIj(a)logNIj(a)n|Ij|−kC∗Xj=1Xa∈ANI∗j(a)logNI∗j(a)n|I∗j|≤kCXj=1Xa∈ANIj(a)logNIj(a)n|Ij|−kC∗Xj=1Xa∈ANI∗j(a)logp∗j(a),CHANGE-POINTDETECTIONOFHOMOZYGOSITYISLANDS21wherethelastinequalityfollowsbecauseNI∗j(a)/n|I∗j|arethemaximumlikelihoodestima-torsforp∗j(a).AsC⊇C∗,wehavethatanyintervalI∗rcontainsoneormoreintervalsIj,andNI∗r(a)=Xj:Ij⊆I∗rNIj(a)foralla∈A.Then,wecanwritethedifferenceaboveaskCXj=1Xa∈ANIj(a)logNIj(a)/n|Ij|p∗ij(a)whereijisthecorrespondingindexinC∗.Thereforeweobtainthatl(C;xn)−l(C∗;xn)≤kCXj=1n|Ij|D(bpj;p∗ij),wherebpj(a)=NIj(a)n|Ij|,a∈AandDdenotestheKullback-Leiblerdivergencebetweentheprobabilitydistributions{bpj(a)}a∈Aand{p∗ij(a)}a∈A.Byawell-knowninequality,seeforexampleCsiszarandTa-lata(2006,Lemma6.3)wehavethatD(bpj(a)|p∗ij(a))≤Xa∈A|bpj(a)−p∗ij(a)|2p∗ij(a).AsthedifferenceNIj(a)−n|Ij|pj(a)canbewrittenasasumofzero-meanindependentrandomvariableswithﬁnitevariance,wehave,bytheLawoftheIteratedLogarithm,seeforexampleBreiman(1969,Theorem3.52),that|bpj(a)−p∗ij(a)|≤scloglogn|Ij|n|Ij|≤scloglognmn|Ij|foragivenconstantcandforalla∈A,eventuallyalmostsurelyasn→∞.Henceforallδ>0wehavethat|bpj(a)−pij(a)|≤sδlognn|Ij|eventuallyalmostsurelyasn→∞.Finally,weobtainthatl(C;xn)−l(C∗;xn)≤kCδp∗minlogn≤mδp∗minlogn,withp∗min=min{p∗j(a):p∗j(a)>0,j=1,...,kC∗,a∈A}.Ontheotherhand,itiseasytoseethatl(C;xn)−l(C∗;xn)≥0foranyC⊇C∗.Then,hypothesis(PL2)holdsforv(n)=δlogn,foranyδ>0.Thisestab-lishestheconditionsonAssumption1.22Nowweverifythehypotheses(H1)-(H2)inAssumption2.Observethatasinthecaseof(PL1),theLawofLargeNumberscanbeinvokedtoprovethat(A.6)1nl(I;xn)→l∗(I):=|I|Xa∈AˆpI(a)logˆpI(a)foranyintegerintervalI∈I.Now,forI=r:sconsiderthefunctionh∗I:I→Rdeﬁnedash∗(u)=−l∗(r:u)−l∗((u+1):s),u∈I.Asl∗(I)satisﬁesthehypothesesofLemma2withψ(ˆp)=Pa∈Aˆp(a)logˆp(a)wehavethatminu∈I\{s}∩C∗h∗(u)<minu6∈I\{s}∩C∗h∗(u)wheneverI\{s}∩C∗6=∅,concludingtheproofof(H1).Theproofof(H2)followsby(PL2)inAssumption1.REFERENCESAGUDELO-ESPAÑA,D.,GOMEZ-GONZALEZ,S.,BAUER,S.,SCHÖLKOPF,B.andPETERS,J.(2020).BayesianOnlinePredictionofChangePoints.InProceedingsofthe36thInternationalConferenceonUn-certaintyinArtiﬁcialIntelligence(UAI)ProceedingsofMachineLearningResearch124320–329.PMLR.ANTOCH,J.,HUŠKOVÁ,M.andVERAVERBEKE,N.(1995).Change-pointproblemandbootstrap.JournalofNonparametricStatistics5123-144.BREIMAN,L.(1969).Probabilityandstochasticprocesses;withaviewtowardapplicationsTechnicalReport.CASTRO,B.M.,LEMES,R.B.,CESAR,J.,HÜNEMEIER,T.andLEONARDI,F.(2018).Amodelselectionapproachformultiplesequencesegmentationanddimensionalityreduction.JournalofMultivariateAnalysis167319–330.CEBALLOS,F.C.,JOSHI,P.K.,CLARK,D.W.,RAMSAY,M.andWILSON,J.F.(2018).Runsofhomozygos-ity:windowsintopopulationhistoryandtraitarchitecture.NatureReviewsGenetics19220.CHEN,J.andGUPTA,A.K.(1997).TestingandLocatingVarianceChangepointswithApplicationtoStockPrices.JournaloftheAmericanStatisticalAssociation92739-747.CHEN,J.andGUPTA,A.K.(2012).ParametricStatisticalChangePointAnalysis,Seconded.BirkhäuserBoston,Boston.CHOW,G.C.(1960).TestsofEqualityBetweenSetsofCoefﬁcientsinTwoLinearRegressions.Econometrica28591.CSISZAR,I.andTALATA,Z.(2006).Contexttreeestimationfornotnecessarilyﬁnitememoryprocesses,viaBICandMDL.IEEETransactionsonInformationTheory521007-1016.EDDELBUETTEL,D.andBALAMUTA,J.J.(2017).ExtendingextitRwithextitC++:ABriefIntroductiontoextitRcpp.PeerJPreprints5e3188v1.EDDELBUETTEL,D.andFRANÇOIS,R.(2011).Rcpp:SeamlessRandC++Integration.JournalofStatisticalSoftware401–18.FRICK,K.,MUNK,A.andSIELING,H.(2013).MultiscaleChange-PointInference.HAWKINS,D.andZAMBA,K.(2005).AChange-PointModelforaShiftinVariance.JournalofQualityTech-nology3721-31.HINKLEY,D.V.(1970).Inferenceaboutthechange-pointinasequenceofrandomvariables.Biometrika571-17.HUŠKOVÁ,M.andKIRCH,C.(2008).Bootstrappingconﬁdenceintervalsforthechange-pointoftimeseries.JournalofTimeSeriesAnalysis29947–972.JACKSON,B.,SCARGLE,J.D.,BARNES,D.,ARABHI,S.,ALT,A.,GIOUMOUSIS,P.,GWIN,E.,SANG-TRAKULCHAROEN,P.,TAN,L.andTSAI,T.T.(2005).Analgorithmforoptimalpartitioningofdataonaninterval.IEEESignalProcessingLetters12105-108.KESHAVARZ,H.,SCOTT,C.andNGUYEN,X.(2018).OptimalchangepointdetectioninGaussianprocesses.JournalofStatisticalPlanningandInference193151-178.KILLICK,R.,FEARNHEAD,P.andECKLEY,I.A.(2012).OptimalDetectionofChangepointsWithaLinearComputationalCost.JournaloftheAmericanStatisticalAssociation1071590–1598.KIRIN,M.,MCQUILLAN,R.,FRANKLIN,C.S.,CAMPBELL,H.,MCKEIGUE,P.M.andWILSON,J.F.(2010).Genomicrunsofhomozygosityrecordpopulationhistoryandconsanguinity.PloSone5e13996.CHANGE-POINTDETECTIONOFHOMOZYGOSITYISLANDS23LEE,T.-S.(2010).Change-PointProblems:BibliographyandReview.JournalofStatisticalTheoryandPractice4643-662.LEMES,R.B.,NUNES,K.,CARNAVALLI,J.E.,KIMURA,L.,MINGRONI-NETTO,R.C.,MEYER,D.andOTTO,P.A.(2018).Inbreedingestimatesinhumanpopulations:ApplyingnewapproachestoanadmixedBrazilianisolate.PloSone13e0196360.LEONARDI,F.,LOPEZ-ROSENFELD,M.,RODRIGUEZ,D.,SEVERINO,M.T.andSUED,M.(2021).Indepen-dentblockidentiﬁcationinmultivariatetimeseries.JournalofTimeSeriesAnalysis4219–33.LEUTENEGGER,A.-L.,SAHBATOU,M.,GAZAL,S.,CANN,H.andGÉNIN,E.(2011).Consanguinityaroundtheworld:whatdothegenomicdataoftheHGDP-CEPHdiversitypaneltellus?EuropeanJournalofHumanGenetics19583–587.LI,J.Z.,ABSHER,D.M.,TANG,H.,SOUTHWICK,A.M.,CASTO,A.M.,RAMACHANDRAN,S.,CANN,H.M.,BARSH,G.S.,FELDMAN,M.,CAVALLI-SFORZA,L.L.etal.(2008).Worldwidehumanrelationshipsinferredfromgenome-widepatternsofvariation.science3191100–1104.LI,G.,WANG,J.,LIANG,J.andYUE,C.(2018).TheapplicationofadoubleCUSUMalgorithminindustrialdatastreamanomalydetection.Symmetry10264.MATTESON,D.S.andJAMES,N.A.(2014).ANonparametricApproachforMultipleChangePointAnalysisofMultivariateData.JournaloftheAmericanStatisticalAssociation109334-345.MCQUILLAN,R.,LEUTENEGGER,A.-L.,ABDEL-RAHMAN,R.,FRANKLIN,C.S.,PERICIC,M.,BARAC-LAUC,L.,SMOLEJ-NARANCIC,N.,JANICIJEVIC,B.,POLASEK,O.,TENESA,A.etal.(2008).RunsofhomozygosityinEuropeanpopulations.TheAmericanJournalofHumanGenetics83359–372.NIU,Y.S.,HAO,N.andZHANG,H.(2016).MultipleChange-PointDetection:ASelectiveOverview.Statist.Sci.31611–623.PAGE,E.S.(1954).Continuousinspectionschemes.Biometrika41100-115.PEMBERTON,T.J.,ABSHER,D.,FELDMAN,M.W.,MYERS,R.M.,ROSENBERG,N.A.andLI,J.Z.(2012).Genomicpatternsofhomozygosityinworldwidehumanpopulations.TheAmericanJournalofHumanGenet-ics91275–292.PURCELL,S.,NEALE,B.,TODD-BROWN,K.,THOMAS,L.,FERREIRA,M.A.,BENDER,D.,MALLER,J.,SKLAR,P.,DEBAKKER,P.I.,DALY,M.J.etal.(2007).PLINK:atoolsetforwhole-genomeassociationandpopulation-basedlinkageanalyses.TheAmericanjournalofhumangenetics81559–575.QU,Z.andPERRON,P.(2007).EstimatingandTestingStructuralChangesinMultivariateRegressions.Econo-metrica75459-502.SCOTT,A.J.andKNOTT,M.(1974).Aclusteranalysismethodforgroupingmeansintheanalysisofvariance.Biometrics507–512.TARTAKOVSKY,A.G.,ROZOVSKII,B.L.,BLAZEK,R.B.andHONGJOONGKIM(2006).Anovelapproachtodetectionofintrusionsincomputernetworksviaadaptivesequentialandbatch-sequentialchange-pointdetectionmethods.IEEETransactionsonSignalProcessing543372-3382.RCORETEAM(2020).R:ALanguageandEnvironmentforStatisticalComputingRFoundationforStatisticalComputing,Vienna,Austria.TRUONG,C.,OUDRE,L.andVAYATIS,N.(2020).Selectivereviewofofﬂinechangepointdetectionmethods.SignalProcessing167107299.TSAY,R.S.(1988).Outliers,levelshifts,andvariancechangesintimeseries.JournalofForecasting71-20.SubmittedtotheAnnalsofAppliedStatisticsSUPPLEMENTARYMATERIALTOTHEARTICLE"POPULATIONBASEDCHANGE-POINTDETECTIONFORTHEIDENTIFICATIONOFHOMOZYGOSITYISLANDS"BYLUCASPRATES1,RENANB.LEMES2TÁBITAHÜNEMEIER2ANDFLORENCIALEONARDI11InstitutodeMatemáticaeEstatística,UniversidadedeSãoPaulo2InstitutodeBiociências,UniversidadedeSãoPauloProofofProposition3.FortheGaussiandistribution,themaximumlikelihoodestima-torofthemeanonanintervalIisgivenbybµI=1n|I|Xc∈InXi=1x(i)c.Thenthelog-likelihoodfunctiondeﬁnedinthemaindocumentby(2.4)forachangepointsetC=(c0,...,ck)∈Cisgivenbyl(C;xn)=−nm2log(2πσ2∗)−12σ2∗kCXj=1Xc∈IjnXi=1(x(i)c−bµIj)2,whereIj=(cj−1+1):cjforj=1,...,k.NoticethatbytheLawofLargeNumbers,forallj=1,...,kwehavethatbµIj=kC∗Xr=1|Ij∩I∗r||Ij|1n|Ij∩I∗r|Xc∈Ij∩I∗rnXi=1x(i)ca.s.−→kC∗Xr=1|Ij∩I∗r||Ij|µ∗r=:¯µIj.ObservealsothatkCXj=1Xc∈IjnXi=1(x(i)c−bµIj)2=kCXj=1kC∗Xr=1Xc∈Ij∩I∗rnXi=1(x(i)c−µ∗r+µ∗r−bµIj)2=kCXj=1kC∗Xr=1Xc∈Ij∩I∗rnXi=1(x(i)c−µ∗r)2+2(x(i)c−µ∗r)(µ∗r−bµIj)+(µ∗r−bµIj)2.Then,asn→∞wehavethat1nkCXj=1kC∗Xr=1Xc∈Ij∩I∗rnXi=1(x(i)c−µ∗r)2a.s.−→kCXj=1kC∗Xr=1|Ij∩I∗r|σ2∗=mσ2∗.Inthesameway1nkCXj=1kC∗Xr=1Xc∈Ij∩I∗rnXi=12(x(i)c−µ∗r)(µ∗r−bµIj)a.s.−→01arXiv:2111.10187v1  [stat.ME]  19 Nov 20212and1nkC∗Xj=1kC∗Xr=1Xc∈Ij∩I∗rnXi=1(µ∗r−bµIj)2a.s.−→kCXj=1kC∗Xr=1|Ij∩I∗r|(µ∗r−¯µIj)2.Then,foranyC∈C,bysomemanipulationweobtainthatthealmostsurelimitofthemaxi-mumlog-likelihoodfunctionis1nl(C;x)a.s.−→−m2log(2πσ2∗)−12σ2∗mσ2∗+kCXj=1kC∗Xr=1|Ij∩I∗r|(µ∗r−¯µIj)2=:l∗(C).Webeginbyverifyingconditions(PL1)and(PL2)onAssumption1.ObservethatforanyintervalI∈IwehavethatkC∗Xr=1|I∩I∗r|(µ∗r−¯µI)2=kC∗Xr=1|I∩I∗r|µ∗,2r−2¯µIkC∗Xr=1|I∩I∗r|µ∗r+|I|¯µ2I=kC∗Xr=1|I∩I∗r|µ∗,2r−|I|¯µ2I.(0.1)Thenthefunctionl∗(C)isgivenbyl∗(C)=−m2[log(2πσ2∗)+1]−kC∗Xr=1|I∗r|µ∗,2r+kCXj=1|Ij|¯µ2Ij.Bythestrictconvexityofx7→x2wehavethatkCXj=1|Ij|¯µ2Ij≤kCXj=1|Ij|kC∗Xr=1|Ij∩I∗r||Ij|µ∗,2r=kC∗Xr=1|I∗r|µ∗,2rthenl∗(C)≤l∗(C∗).Moreover,theinequalityisstrictunlessC⊇C∗,andthen(PL1)follows.Toprove(PL2)inAssumption1,ifwedeﬁnetheempiricalvarianceofanintervalIasˆσ2I=1n|Ij|Xc∈IjnXi=1(X(i)c−ˆµj)2thenthelog-likelihoodforanyblockoveraﬁnitesamplecanbewrittenasl(C;xn)=−nm2log(σ2∗)−12σ2∗kCXr=1ˆσ2IrGivenachangepointsetC,deﬁneIr(C)={j∈(1:kC)|Ij⊆I∗r},thesetofallindiceswhoseblocksdeﬁnedbyCarecontainedinI∗r.IfCdoesnotsegmentI∗r,thenthereisonlyoneindexinIrandthesetthatitindexesisexactlyI∗r.Thelog-likelihooddifferencetothetruechangepointsetisthenl(C;xn)−l(C∗;xn)=n2σ2∗kC∗Xr=1|Ir∗|ˆσ2I∗r−Xj∈Ir(C)|Ij|ˆσ2Ij.BLOCKCHANGE-POINTDETECTIONOFPOPULATIONHOMOZYGOSITYISLANDS3Theempiricalvarianceestimatorforthewholeblocksatisﬁesˆσ2I∗r=1n|Ir|Xc∈I∗rnXi=1(X(i)c−ˆµI∗r)2=1n|Ir|Xc∈I∗rnXi=1(cid:20)(cid:16)X(i)c−µ∗r(cid:17)2(cid:21)−(ˆµI∗r−µ∗r)2≤1n|Ir|Xc∈I∗rnXi=1(cid:20)(cid:16)X(i)c−µ∗r(cid:17)2(cid:21).Asimilarcalculationforthevarianceofthenestedblocksyieldsˆσ2Ij=1n|Ij|Xc∈IjnXi=1(X(i)c−ˆµIj)2=1n|Ij|Xc∈IjnXi=1(cid:20)(cid:16)X(i)c−µ∗r(cid:17)2(cid:21)−(ˆµIj−µ∗r)2.Deﬁnej0=argmaxIr(C)(ˆµj−µ∗r)2,wehaven2σ2∗|I∗r|ˆσ2r−Xj∈Ir(C)|Ij|ˆσ2j=n2σ2∗Xj∈Ir(C)(ˆµj−µ∗r)2≤|I∗r|n2σ2∗(ˆµj0−µ∗r)2=|I∗r|2|Ij0|2σ2∗1√nXc∈Ij0nXi=1(cid:16)X(i)c−µ∗r(cid:17)2.DeﬁneSj∗=1√nloglognXc∈Ij0nXi=1(cid:16)X(i)c−µ∗r(cid:17).Bythelawoftheiteratedlogarithm,thereexists(cid:15)j∗>1suchthatlimsupn→∞Sj∗<(cid:15)j∗.Bylimsupproperties,limsupn→∞S2j∗<(cid:15)2j∗.Dividingthetermsinsideeachblockbyloglogn,wehavelimsupn→∞|I∗r|2|Ij∗|2σ2∗S2j∗≤|I∗r|2|Ij∗|2σ2∗limsupn→∞(cid:0)S2j∗(cid:1)≤|I∗r|2|Ij∗|2σ2∗(cid:15)2j.4Finally1loglognl(C;X)−l(C∗;X)≤limsupn→∞1loglognl(C;X)−l(C∗;X)≤kC∗Xr=1|I∗r|2|Ij∗|2σ2∗(cid:15)2j≤(cid:15),forsome(cid:15)>0.Thisestablishescondition(PL2).Wenowverifyconditions(H1)and(H2)onAssumption2.ObservethatforanyintervalI=r:s∈IwehavethatkC∗Xr=1|I∩I∗r|(µ∗r−¯µI)2=kC∗Xr=1|I∩I∗r|µ∗,2r−2¯µIkC∗Xr=1|I∩I∗r|µ∗r+|I|¯µ2I=kC∗Xr=1|I∩I∗r|µ∗,2r−|I|¯µ2I.Thenthefunctionh∗I(u)in(4.2)isgivenbyh∗I(u)=α(I,θ∗)+(u−r+1)ψ(¯µr:u)+(s−u)ψ(¯µ(u+1):s),withψ(µ)=µ2,µ∈R.Ash∗IsatisﬁestheconditionsofLemma2wehavethat(H1)follows.Theproofof(H2)inAssumption2isobtainedinthesamewayas(PL2)inAssumption1.SimulationsforGaussianrandomvariables.WeprovideasimilarsimulationstudyastheonepresentedinthemaintexttheGaussianfamilyofdistributions.Intheseplotsagainweobserveover-segmentationforthehierarchicalalgorithmforsmallsamplesizes,andmorecommonthanintheBernoullicase.Thedynamicprogrammingalgo-rithmseemsagaintobemorerobustwithrespecttothechoiceofthepenalizationconstantλ.InFigure1isevidentthatthehierarchicalalgorithmismorevolatile,butassamplesizegrows,hasanequivalent,andmaybeevenbetter,performancethanthedynamicprogram-mingexactsolution.BLOCKCHANGE-POINTDETECTIONOFPOPULATIONHOMOZYGOSITYISLANDS5FIG1.ComparisonofestimatedchangepointsetsbetweenalgorithmsandagainstgroundtruthfortheGaussiancaseusingtheJaccardIndex.Thenumberofchangepointsk∗isindicatedinthetitle.6FIG2.ComparisonofestimatedchangepointsetsbetweenalgorithmsandagainstgroundtruthfortheGaussiancaseusingtheestimatednumberofchangepoints.Thetruenumberofchangepointsk∗isindicatedinthetitleandmarkedonthedashedhorizontalredline.