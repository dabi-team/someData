Novel Meta-Heuristic Model for Discrimination 
between Iron Deficiency Anemia and Β-Thalassemia 
with CBC Indices Based on Dynamic Harmony 
Search (DHS) 

Sultan Noman Qasem1,2, and Amir Mosavi3* 
1Computer Science Department, College of Computer and information Sciences, Al Imam Mohammad Ibn Saud Islamic University (IMSIU), Riyadh, 
Saudi Arabia 
2Computer Science Department, Faculty of Applied Science, Taiz University, Taiz, Yemen 
3Kalman Kando Faculty of Electrical Engineering, Obuda University, 1034 Budapest, Hungary 

Corresponding author: amir.mosavi@kvk.uni-obuda.hu 

ABSTRACT  In  recent  decades,  attention  has  been  directed  at  anemia  classification  for  various  medical 
purposes, such as thalassemia screening and predicting iron deficiency anemia (IDA). In this study, a new 
method  has  been  successfully  tested  for  discrimination  between  IDA  and  β-thalassemia  trait  (β-TT).  The 
method is based on a Dynamic Harmony Search (DHS). Complete blood count (CBC), a fast and inexpensive 
laboratory test, is used as the input of the system. Other models, such as a genetic programming method called 
structured representation on genetic algorithm in non-linier function fitting (STROGANOFF), an artificial 
neural network (ANN), an adaptive neuro-fuzzy inference system (ANFIS), a support vector machine (SVM), 
k-nearest neighbor (KNN), and certain traditional methods, are compared with the proposed method.  

INDEX TERMS Anemia classification, dynamic harmony search, iron deficiency anemia, thalassemia trait,  

I. INTRODUCTION 
Iron deficiency anemia (IDA) and β-thalassemia trait (β-TT) 
are  the  most  common  types  of  anemia.  They  have  similar 
effects on red blood cell indices such as red blood cell count 
(RBC),  hemoglobin  concentration  (Hb),  mean  corpuscular 
volume  (MCV),  mean  corpuscular  hemoglobin  (MCH), 
mean  corpuscular  hemoglobin  concentration  (MCHC),  red 
blood cell distribution width (RDW), and hematocrit (HCT). 
Thalassemia disease is a genetic trait that directly impacts on 
reducing the life span of red blood cells through regulating 
the  formation  of  hemoglobin  (Hb)  as  a  fundamental 
component  of  red  blood  cells  [1].  In  contrast,  IDA  is  not 
inherited and can generally be treated by dietary changes and 
iron  supplements.  Complete  blood  count  (CBC)  is  the 
primary clinical test for diagnosis of anemia. If CBC indices 
cannot discriminate between IDA and β-TT, complementary 
tests, such as hemoglobin electrophoresis or genetic tests, are 
needed. Complementary tests are time consuming, expensive 
and not available in all laboratories and hospitals. As a result, 
scientists have conducted many studies on the discrimination 
between  IDA  and  β-TT  anemia  classification  using  the 
indices of the CBC test [2]. 
Historically, mathematical formulas have been used to solve 
the problem [3], [4], [13]–[16], [5]–[12]. Recently, there has 

been increasing interest in the use  of artificially intelligent 
automated  medical  diagnostic  systems  [17]–[22].  There 
exists  engineering  applications  for  anemia  classification 
including image analysis  [23], statistical analysis  [24], and 
clustering techniques [25], rule-based expert systems [26]–
[28] , hybrid neural rule-based method [29]. One of the first 
efforts to diagnosis anemia using an ANN was performed by 
Brindorf et al. in  1996 in which a hybrid expert system of 
rule-based  and  ANN  has  been  developed.  They  reported 
96.5%  precision  in  classifying  microcytic  anemia  and  the 
anemia  of  chronic  disease.  In  2002,  Nikolaev  and  de-
Menezes  introduced  an  image  recognition  approach  for 
classification  of  anemia  [30].  Amendolia  et  al.  in  2003 
published  a  comparative  study  of  K-nearest  neighbor, 
support  vector  machine  (SVM)  and  multi-layer  perceptron 
(MLP)  methods  for  thalassemia  screening  [31],  [32].  The 
results 
the 
classification  sensitivity  (92%)  in  comparison  with  SVM 
(83%) while the classification accuracies were equal to 95%. 
Another comparison has been performed by Azarkhish et al. 
in  2012  [33].  They  compare  three  different  methods,  an 
adaptive  neuro-fuzzy  inference  system  (ANFIS),  an  ANN 
and a logistic regression model in diagnosing iron deficiency 
anemia (IDA), and reported that the ANN is superior to the 

that  MLP 

improved 

revealed 

slightly 

 
others. All of these methods have been successfully tested on 
various types of anemia. Moreover, to narrow the domain of 
anemia  specifically  on  β-TT  and  IDA,  an  alternative 
diagnostic tool was compulsory. This study proposes such a 
tool. It compares the existing methods for discriminating β-
TT and IDA, including traditional methods and the newer, 
AI-based  diagnostic  systems,  with  a  novel  meta-heuristic 
model. The main goal of this study is to reduce the diagnosis 
time and cost for β-TT and IDA subjects by increasing their 
discrimination  precision  through  the  analysis  of  CBC 
indices. 
This  paper  is  organized  as  follows.  Section  2  describes 
anemia and its effects on blood indices. Section 3 introduces 
the harmony search (HS) algorithm. In section 4, materials 
and  methods  are  presented. 
Implementation  details, 
experimental  tests,  and  the  results  of  the  proposed method 
are discussed in section 5. Further tests and comparisons with 
other methods and models are presented in section 6. Finally, 
section 7 presents the study’s conclusions. 

 EFFECTS OF ANEMIA ON CBC INDICES 

II. 
There  are  several  different,  task-specific  blood  cell  types, 
such as white blood cells (WBCs), red blood cells (RBCs), 
and platelets. A red blood cell transmits oxygen to all cells 
of the body and receives the CO2 excreted by them. These 
tasks  are  carried  out  by  hemoglobin.  Each  red  blood  cell 
contains 
approximately  300  million  molecules  of 
hemoglobin. Hemoglobin consists of four polypeptide chains 
(globin) and heme. Hence, a change in the structure of globin 
affects the structure and functionality of the red blood cells. 
Each molecule of hemoglobin has four heme molecules. A 
heme molecule is a cofactor consisting of an Fe2+ (ferrous) 
ion  in  the  center  of  a  heterocyclic  organic  ring  called 
porphyrin.  The  iron  atom  can  bind  an  oxygen  molecule 
through ion-induced dipole forces.  In 1825,  J.F.  Engelhard 
discovered that the ratio of Fe to protein is identical in the 
hemoglobin of several species [34]. Iron deficiency anemia 
(IDA) leads to a reduction in the quantity and the quality of 
hemoglobin. 
There  are  four  types  of  globin  chains:  alpha  (α),  beta  (β), 
gamma (γ), and delta (δ). Based on the type of globin chains 
in its structure, the hemoglobin belongs to one of three major 
types, HbA (α2β2), HbA2 (α2δ2), or HbF (α2γ2). HbF, or 
fetal hemoglobin, is the main component of fetal red blood 
cells, which gradually diminishes in proportion to HbA after 
birth. The proportions of HbA, HbA2, and HbF in a mature, 
healthy  person’s  blood  are  approximately  97%,  2-3%,  and 
less than 1%, respectively.  
Based  on  the  proportions  of  the  hemoglobin  types  in  a 
person, HBA (α2β2) is a major component of red blood cells. 
As a result, the most vital globin types are α-globin and β-
globin. The first contains 141 amino acids regulated by genes 
on chromosome 16 and the second contains 161 amino acids 
regulated by genes on chromosome 11. Thalassemia results 
from  defects  on  the  genes  that  regulate  the  formation  of 

globin chains. The type of thalassemia and the severity of the 
disease  depend  on  the  types  and  the  number  of  defective 
genes,  respectively.  A  person  must  have  at  least  two 
defective genes of the same type to have the disease. If only 
one  defective  gene  or  two  different  defective  genes  are 
present,  he  has  thalassemia  trait.  Persons  with  thalassemia 
trait do not have the disease but inherit genes that cause the 
disease.  The type of defective genes determines whether the 
subject  has  α-thalassemia  or  β-thalassemia.  Generally,  β-
thalassemia is more common than α-thalassemia. 

A. IRON DEFICIENCY ANEMIA (IDA) 
As previously discussed, IDA leads to a reduction in heme. It 
is clear that a reduction in heme affects the concentration of 
hemoglobin  in  blood.  Therefore,  in  a  person  with  IDA,  the 
blood parameters dependent on the hemoglobin concentration 
are affected. Some of these parameters, which are generally 
used as diagnosis indices, are: hemoglobin concentration (Hb), 
which denotes the quantity of hemoglobin in blood, red blood 
cell  count  (RBC),  mean  corpuscular  volume  (MCV),  mean 
corpuscular 
corpuscular 
red  blood  cell 
hemoglobin  concentration 
distribution width (RDW), and hematocrit (HCT).  

(MCH),  mean 
(MCHC), 

hemoglobin 

B. CHARACTERISTIC OF THALASSEMIA 
In α-thalassemia or β-thalassemia, regardless of whether the 
subject has the disease or the trait, hemoglobin concentration 
becomes  lower  than  normal.  This  reduction  is  a  result  of  a 
decreased  concentration  of  α-globin  (α-thalassemia)  or  β-
globin (β-thalassemia) chains. When the concentration of α or 
β-globin reduces, the quantity and quality of hemoglobin are 
naturally  lower  than  normal.  As  a  result,  similar  to  an  IDA 
subject, someone with thalassemia disease or trait has reduced 
Hb, MCV, MCH, MCHC, and HCT values. For thalassemia 
disease, diagnosis is not difficult because the indices are too 
low. But in thalassemia trait, the indices are only a little below 
the normal range, leading to difficulty discriminating between 
IDA and thalassemia trait. 
One of the most important differences between IDA and β-TT 
is the red blood cell count (RBC). Generally, to compensate 
for the lower Hb with β-TT, the RBC increases, while the RBC 
index  is  lower  than  normal  for  IDA.  In  summary,  we  can 
conclude  that  IDA  and  β-TT  both  lead  to  a  reduced 
concentration  of  hemoglobin,  but  the  reduction  for  β-TT  is 
greater  than  for  IDA.  Despite  these  differing  amounts  of 
reduction,  in  some  circumstances  it  is  too  difficult  to 
discriminate between these types of anemia. 

III. HARMONY SEARCH ALGORITHM (HS) 
Mathematical  based  optimization  algorithms  exploit  the 
benefit of substantial gradient data. In addition, there exist 
the wide range of programming approaches including Linear 
and non-linear programming to solve optimization problems 
[35].  The  initial  population  should  have  been  selected 
carefully  for  optimal  convergence  of  the  optimization 

 
 
 
 
algorithm. In contrast, Non-gradient meta-heuristic methods 
are  other  popular  solutions  which  does  not  have  inherent 
difficulties of gradient-based methods [35]–[43]. Generally, 
meta-heuristic algorithms comes from nature and are guided 
random  search  algorithm  [43].  Harmony  search  (HS)  is 
inspired from jazz musicians and has variety of applications 
in engineering introduced by Geem Z-W. in 2001 [35] and 
will be described in the remainder of this section. 

A. AN OPTIMIZATION PROBLEM 
Optimization problems either try to maximize the fitness or 
minimize the cost. An optimization problem which tries to 
minimize  the  cost  function  can  be  defined  in  Eq.  (1)  as 
follows: 

𝑀𝑖𝑛 𝐹(𝑋 ⃗⃗⃗ ),   𝑋 ⃗⃗⃗  = (𝑋(1), … , 𝑋(𝑛)) ,   𝑋(𝑗)   ∈

[𝐿𝐵(𝑗), 𝑈𝐵(𝑗)]                                          (1) 

where 𝐹(𝑋 ⃗⃗⃗ ) is the cost function, 𝑋 ⃗⃗⃗  is a vector describing the 
design parameters, and 𝐿𝐵(𝑗) and 𝑈𝐵(𝑗) are the lower and 
upper bound of the 𝑗’𝑡ℎ parameter, respectively.  

B. EXPLANATION OF HARMONY SEARCH (HS) 
ALGORITHM 
Each  solution  in  HS  algorithm  is  called  a  harmony  and 
described  as  an  n-dimensional  vector.  First,  the  initial 
population  of  HS  should  be  randomly  generated  from  the 
search space. Then, a new harmony is constructed by three 
major operators in HS namely, memory consideration, pitch 
adjustment,  and  random  re-initialization.  The  algorithm 
proceeds by comparing the new  harmony (𝑋 ⃗⃗⃗ 𝑛𝑒𝑤) with the 
existing worst harmony in the HM (𝑋 ⃗⃗⃗ 𝑤𝑜𝑟𝑠𝑡). 𝑋 ⃗⃗⃗ 𝑛𝑒𝑤 will be 
substituted  by  𝑋 ⃗⃗⃗ 𝑤𝑜𝑟𝑠𝑡  provided  that  the  new  harmony  has 
better  cost  than  the  worst  harmony.  The  process  of 
generating    𝑋 ⃗⃗⃗ 𝑛𝑒𝑤  and  possible  substitution  with  𝑋 ⃗⃗⃗ 𝑤𝑜𝑟𝑠𝑡 
continues until convergence occurs.  
HS has some parameters which should be preallocated at the 
beginning of optimization. These parameters which tune HS 
for optimized quality of convergence are harmony memory 
consideration rate (HMCR), harmony memory size (HMS), 
number of improvisations (NI), pitch adjustment rate (PAR), 
and bandwidth (BW). 

C. INITIALIZING HARMONY MEMORY (HM) 
Harmony  memory  (HM)  is  a  matrix  in  which  the  rows 
𝑋 ⃗⃗⃗ 𝑖 =
indicate 
(𝑋𝑖(1), … , 𝑋𝑖(𝑛))  is  the  𝑖’𝑡ℎ  row  (harmony)  in  HM.  Then, 
each row of HM can be initialized by Eq. (2) as follows: 

harmonies. 

Suppose 

that 

the 

 𝑋𝑖(𝑗) = 𝐿𝐵(𝑗) + (𝑈𝐵(𝑗) − 𝐿𝐵(𝑗)) × 𝑟   ,    𝑓𝑜𝑟  𝑖 =

 1 … 𝐻𝑀𝑆  &  𝑗 = 1 … 𝑛                 (2) 

Where 𝑟 is a random number in range of [0,1). Hence, HM 
is a matrix of HMS size with solution vectors in each row as 
shown in Eq. (3). 

𝐻𝑀 =

𝑋1(1)    ,      𝑋1(2) …   , 𝑋1(𝑛)
𝑋2(1)    ,      𝑋2(2)  …    , 𝑋2(𝑛)
.
.
𝑋𝐻𝑀𝑆(1), 𝑋𝐻𝑀𝑆(2), … , 𝑋𝐻𝑀𝑆(𝑛)]
[

           (3)                                                                   

D. IMPROVISATION OF A NEW HARMONY 
Each  element  of    𝑋 ⃗⃗⃗ 𝑛𝑒𝑤,  (𝑋𝑛𝑒𝑤(𝑗)),  is  created  by  Eq.  (4) 
provided that the randomly generated number (𝑟1   ∈   [0, 1)) 
is less than HMCR. However, assuming  𝑟1 is greater than 
HMCR, Eq. (2) is used for randomly creating 𝑋𝑛𝑒𝑤(𝑗). 

𝑋𝑛𝑒𝑤(𝑗) = 𝑋𝑎(𝑗)

{

𝑎 = ⌊𝑟 ∗ 𝐻𝑀𝑆 + 1⌋

                        (4)                                                          

Where  𝑟  is  a  random  number  in  the  range  of [0, 1).  𝑟2   ∈
 [0, 1)  is  a  randomly  generated  number  provided  that  
𝑋𝑛𝑒𝑤(𝑗)  was  selected  from  HM.  If    𝑟2  is  less  than  pitch 
adjustment rate (PAR), an adjustment using Eq. (5) must be 
performed: 

𝑋𝑛𝑒𝑤(𝑗) =    𝑋𝑛𝑒𝑤(𝑗) + 𝐵𝑊(𝑗) × 𝑟      (5)                                                                             

Where 𝑟 is a random number in the range of [0,1) and 𝐵𝑊(𝑗) 
is  the  corresponding  bandwidth  of  the  𝑗’𝑡ℎ  parameter  in 
𝑋 ⃗⃗⃗ 𝑛𝑒𝑤. 

E. UPDATING THE HARMONY MEMORY (HM)  
The  HM  matrix  should  be  updated  upon  creating  a  new 
harmony. HM rows are sorted ascendingly based on the cost. 
Thus,  the  last  row  of  HM  incorporates  the  worst  harmony 
(𝑋 ⃗⃗⃗ 𝑤𝑜𝑟𝑠𝑡).  The new recently created harmony, 𝑋 ⃗⃗⃗ 𝑛𝑒𝑤 , will be 
substituted by existing  𝑋 ⃗⃗⃗ 𝑤𝑜𝑟𝑠𝑡 if 𝑋 ⃗⃗⃗ 𝑛𝑒𝑤  has cheaper cost.in 
comparison with  𝑋 ⃗⃗⃗ 𝑤𝑜𝑟𝑠𝑡. The sorting of HM matrix should 
be updated accordingly. 

IV. MATERIALS AND METHODS 
We have used a harmony search algorithm to minimize error 
in  anemia  classification.  For 
this  purpose,  a  new 
the 
approximation  method  has  been  developed  as 
optimization  tool  for  minimizing  the  approximator  error, 
based  on  the  harmony  search  algorithm (HS).  The method 
borrows some principles from a successfully tested structure 
representation on genetic algorithms for nonlinear function 
fitting,  or  STROGANOFF,  method  [44].  The  proposed 
method is explained in the following subsections. 

 
 
 
 
 
 
 
 
 
 
 
 
 
A. THE PRINCIPLES OF STROGANOFF 
In  STROGANOFF,  the  input-output  mapping  can  be 
described as a smooth multidimensional surface which plays 
the role of universal approximator [45]. The method uses a 
binary tree in which each non-leaf node (which is commonly 
a  second-order  polynomial)  is  modeled  by  a  differentiable 
function.  Additionally,  each  leaf  node  contains  an  input 
variable of the system. Fig. 1 shows a representation of the 
system.  

Where  𝑎𝑖 ≠ 0,  0 ≤ 𝑖 ≤ 5,  and  the  simple  functions  ℎ𝑖(𝑥) 
that produce the terms are: ℎ0(𝑥) = 1, ℎ1(𝑥) = 𝑥1, ℎ2(𝑥) =
2. Hence, the 
𝑥2, ℎ3(𝑥) = 𝑥1𝑥2,  ℎ4(𝑥) = 𝑥1
polynomial can be written as Eq. (9). 

2, and  ℎ5(𝑥) = 𝑥2

𝑓(𝑥) = 𝑎0 + 𝑎1𝑥1 + 𝑎2𝑥2 + 𝑎3𝑥1𝑥2 + 𝑎4𝑥1
(9) 

 2 + 𝑎5𝑥2

2                                                          

For the current optimization problem, the coefficients of the 
polynomials in non-leaf nodes of the binary tree (Fig. 1) must 
be  tuned  up  by  fitting  the  output  of  function  (𝑦̂𝑘)  to  the 
desired  output  (𝑦𝑘).  Nikolay  Y.  Nikolaev  and  Hitoshi  Iba 
[45] have proposed 16 quadratic forms presented in Table 1 
to  be  applied  on  the  non-leaf  nodes  of  STROGANOFF 
algorithm  instead  of  the  complete  bi-variable  quadratic 
polynomial (Eq. 9). 

TABLE 1. 
 BIVARIATE BASIS POLYNOMIALS USED IN STROGANOFF. 

index 

Polynomial function 

FIGURE 1. Binary tree representation of a polynomial with four indices 
as the input variables. 

Suppose that the binary tree (Fig. 1) is used to approximate 
a  function  𝑦 = 𝑔(𝑥1, 𝑥2, 𝑥3, 𝑥4) = 𝑔(𝑋 )  where  an  input-
output dataset {(𝑋𝑘⃗⃗⃗⃗ , 𝑦𝑘); 𝑘 = 1. . 𝑁} is available. The binary 
tree in Fig. 1 takes four input variables (the elements of 𝑋𝑘⃗⃗⃗⃗  =
𝑘, 𝑥2
leaf  nodes  and  produces  an 
𝑥1
approximate  output  (𝑦̂𝑘).  The  produced  output  can  be 
obtained by Eq. (6) as follows. 

𝑘  )  on 

𝑘, 𝑥3

𝑘, 𝑥4

its 

1 
2 
3 
4 
5 
6 
7 
8 
9 
10 
11 
12 
13 
14 
15 
16 
𝑘)))          (6)                                                                                 

𝑓1(𝑋∗) =   𝑎0 + 𝑎1𝑥1 + 𝑎2𝑥2 + 𝑎3𝑥1𝑥2 
𝑓2(𝑋) = 𝑎0 + 𝑎1𝑥1 + 𝑎2𝑥2 
2 + 𝑎4𝑥2
2 
𝑓3(𝑋) = 𝑎0 + 𝑎1𝑥1 + 𝑎2𝑥2 + 𝑎3𝑥1
2 
𝑓4(𝑋) = 𝑎0 + 𝑎1𝑥1 + 𝑎2𝑥1𝑥2 + 𝑎3𝑥1
2 
𝑓5(𝑋) = 𝑎0 + 𝑎1𝑥1 + 𝑎2𝑥2
2 
𝑓6(𝑋) = 𝑎0 + 𝑎1𝑥1 + 𝑎2𝑥2 + 𝑎3𝑥1
2 
2 + 𝑎3𝑥2
𝑓7(𝑋) = 𝑎0 + 𝑎1𝑥1 + 𝑎2𝑥1
2 
2 + 𝑎2𝑥2
𝑓8(𝑋) = 𝑎0 + 𝑎1𝑥1
2 + 𝑎5𝑥2
2 
𝑓9(𝑋) = 𝑎0 + 𝑎1𝑥1 + 𝑎2𝑥2 + 𝑎3𝑥1𝑥2 + 𝑎4𝑥1
2 
𝑓10(𝑋) = 𝑎0 + 𝑎1𝑥1 + 𝑎2𝑥2 + 𝑎3𝑥1𝑥2 + 𝑎4𝑥1
2 
2 + 𝑎4𝑥2
𝑓11(𝑋) = 𝑎0 + 𝑎1𝑥1 + 𝑎2𝑥1𝑥2 + 𝑎3𝑥1
2 + 𝑎3𝑥2
2 
𝑓12(𝑋) = 𝑎0 + 𝑎1𝑥1𝑥2 + 𝑎2𝑥1
2 
𝑓13(𝑋) = 𝑎0 + 𝑎1𝑥1 + 𝑎2𝑥1𝑥2 + 𝑎3𝑥2
𝑓14(𝑋) = 𝑎0 + 𝑎1𝑥1 + 𝑎2𝑥1𝑥2 
𝑓15(𝑋) = 𝑎0 + 𝑎1𝑥1𝑥2 
2 
𝑓16(𝑋) = 𝑎0 + 𝑎1𝑥1𝑥2 + 𝑎2𝑥1

* 𝑋 = (𝑥1, 𝑥2) 

𝑦̂𝑘 = 𝑓1 (𝑥4

𝑘, 𝑓2 (𝑥3

𝑘, 𝑓3(𝑥1

𝑘, 𝑥2

Number 
of terms 
4 
3 
5 
4 
3 
4 
4 
3 
6 
5 
5 
4 
4 
3 
2 
3 

Where each 𝑓𝑖 takes the bi-variable quadratic polynomial that 
comes from the Kolmogorov-Gabor polynomial formulated 
as Eq. (7) [45]. 

𝑓(𝑥) = 𝑎0 + ∑ 𝑎𝑖

𝑖

𝑥𝑖 + ∑ ∑ 𝑎𝑖𝑗𝑥𝑖𝑦𝑗
𝑗

𝑖

+

∑ ∑ ∑ 𝑎𝑖𝑗𝑘

𝑘

𝑗

𝑖

𝑥𝑖

𝑦𝑗𝑧𝑘 + ⋯                                  (7) 

Where the 𝑎𝑖 are the polynomial coefficients and the 𝑥𝑖 are 
independent  variables.  The  Kolmogorov-Gabor 
the 
polynomial  is  a  universal  format  for  function  modeling 
because  it  can  be  used  to  approximate  any  continuous 
function  mapping  to  an  arbitrary  precision,  if  there  are 
sufficient terms. For two independent variables, Eq. (8) with 
six  terms  of  the  Kolmogorov-Gabor  polynomial,  has  been 
employed by various researchers[45].  

B. CHOOSING THE INDICES OF CBC AS THE SYSTEM’S 

INPUTS 

After  reviewing  CBC  indices,  the  four  indices  Hb,  RBC, 
MCV, and HCT are chosen as the system’s inputs. Indices 
are chosen for minimum redundancy. To achieve this goal, 
we use the algorithm described in the two next subsections 
and  some  sample  collected  CBC  specimens,  drawn  from 
those shown in Table 2. The chosen indices can populate the 
leaf nodes of a binary tree such as the one shown in Fig. 1. 
Additionally,  these  indices  have  been  successfully  used  in 
various previous studies [2], [46].  

1)  DATA ANALYSIS 
The dataset used in this work has been obtained from  [47]. 
The  total  number  of  collected  CBC  tests  is  750,  obtained 
from the blood specimens of 390 males aged 20-35 and 360 
females aged 17-32 years. The information is organized in 
three classes as follows [47]. 

𝑓(𝑥) = 𝑎0ℎ0(𝑥) +   𝑎1ℎ1(𝑥) + ⋯ + 𝑎5ℎ5(𝑥)       (8)                                                                    

 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
I.  The samples with CBC indices in the normal ranges 

(218 samples). 

II.  The  samples  with  significantly  abnormal  CBC 
indices,  identified  definitively  as  β-TT  or  IDA  (98 
samples, IDA = 38, β-TT = 60). 

III. The  samples  with  indeterminate  CBC  indices.  They 
have been determined by complementary tests such as 
electrophoresis (434 samples, IDA = 231, β-TT = 203). 

is  sufficiently  complex 

Based  on  the  data,  the  total  numbers  of  β-TT  and  IDA 
subjects are 269 and 263, respectively. Table 2 shows some 
examples  of  different  classes  of  collected  samples. 
Abnormal values are shown in bold face (Table 2). It is clear 
that the samples in class III are sufficiently similar and the 
relationship 
that  a  simple 
mathematical  formula  cannot  distinguish  reliably  between 
IDA and β-TT subjects in this class. As the study’s purpose 
is  to  differentiate  between  IDA  and  β-TT  subjects,  we 
excluded  the  normal  samples  and  the  remaining  samples 
(532  samples  including  IDA  and  β-TT)  were  randomly 
divided into the training and the testing sets of 132 and 400 
samples, respectively.  

2)  AN ALGORITHM FOR ELIMINATION REDUNDANT 

INDICES 

is  chosen  because 

The elimination of redundant CBC indices from the input set 
leads to a more efficient system. Fig. 2 shows the algorithm 
which is employed for choose the most  reliable indices for 
discrimination. this algorithm is called Pattern Based Index 
Selection  (PBIS).  The  name 
the 
elimination  is  conducted  based  on  the  similarity  between 
indices with respect to their abnormal patterns, as seen in the 
Table 2. 
As  seen  in  Fig.  2,  for  each  iteration  of  the  algorithm,  the 
index such has the least similarity with the other indices, with 
respect to their abnormality pattern, must be found. Eq. (10) 
can be used to calculate the Coefficient of Similarity (COS) 
between any two CBC indices. 

                  𝐶𝑂𝑆𝑖,𝑗 = 2 −

𝐿𝑜𝑖(𝑥) =

1       𝑖𝑓  𝑥 < 𝑙𝑜𝑤𝑒𝑟 𝑏𝑜𝑢𝑛𝑑 𝑜𝑓 𝑛𝑜𝑟𝑚𝑎𝑙 𝑟𝑎𝑛𝑔𝑒
𝑓𝑜𝑟 𝑖′𝑡ℎ 𝐶𝐵𝐶 𝑖𝑛𝑑𝑒𝑥

0      𝑖𝑓  𝑥 ≥ 𝑙𝑜𝑤𝑒𝑟 𝑏𝑜𝑢𝑛𝑑 𝑜𝑓  𝑛𝑜𝑟𝑚𝑎𝑙 𝑟𝑎𝑛𝑔𝑒
 𝑓𝑜𝑟 𝑖′𝑡ℎ 𝐶𝐵𝐶 𝑖𝑛𝑑𝑒𝑥     

{

(11) 

𝐻𝑖𝑖(𝑥) =

1    𝑖𝑓  𝑥 > 𝑢𝑝𝑝𝑒𝑟 𝑏𝑜𝑢𝑛𝑑 𝑜𝑓 𝑛𝑜𝑟𝑚𝑎𝑙 𝑟𝑎𝑛𝑔𝑒
 𝑓𝑜𝑟 𝑖′𝑡ℎ  𝐶𝐵𝐶 𝑖𝑛𝑑𝑒𝑥    

0    𝑖𝑓  𝑥 ≤ 𝑢𝑝𝑝𝑒𝑟 𝑏𝑜𝑢𝑛𝑑 𝑜𝑓  𝑛𝑜𝑟𝑚𝑎𝑙 𝑟𝑎𝑛𝑔𝑒
 𝑓𝑜𝑟 𝑖′𝑡ℎ 𝐶𝐵𝐶 𝑖𝑛𝑑𝑒𝑥     

{

(12) 

After applying the above algorithm, four indices, RBC, Hb, 

HCT, and MCV, are chosen as system inputs. 

TABLE 2. 
 SEVERAL EXAMPLES OF COLLECTED CBC INDICES [47]. 

RBC(
M/m
m3) 
(4.5-
6.3) * 
5.43 
6.13 
6.8   ↑ 
4.73 
4.13 ↓ 
4.61 
4.36 ↓ 
4.77 
3.99 ↓ 
4.4   ↓ 
6.62 ↑ 
4.56 
5.95 
4.65 
5.12 
4.81 
5.05 
4.88 
5.03 
5.1 

Hb(g/
dL) 

HCT 
(%) 

MCV(
fL) 

MCH(
pg) 

MCH
C (%) 

(13.5-
18) 
10.2 ↓ 
12.5 ↓ 
12.6 ↓ 
10.1 ↓ 
8.2   ↓ 
12.8 ↓ 
13.1 ↓ 
13.3 ↓ 
11.4 ↓ 
13.7 
13.1 ↓ 
10.3 ↓ 
12.5 ↓ 
10.5 ↓ 
10.6 ↓ 
11.6 ↓ 
11.5 ↓ 
12.1 ↓ 
12.7 ↓ 
13.2 ↓ 

(39-50)  (80-96) 

(27-32) 

(32-38) 

34   ↓ 
40.1 
43.4 
38.7↓ 
38.4↓ 
38.9↓ 
39.7 
39.7 
35.1↓ 
40.5 
43.9 
34.7↓ 
43.4 
35.6↓ 
36.7↓ 
37.6↓ 
38.8↓ 
38.8↓ 
39.9 
39.7 

62.6 ↓ 
65.4 ↓ 
63.8 ↓ 
69.9 ↓ 
71.8 ↓ 
84.4 
91.1 
83.2 
88 
92 
65.9 ↓ 
76.1 ↓ 
72.8 ↓ 
76.6 ↓ 
71.7 ↓ 
78.2 ↓ 
76.8 ↓ 
79.5 ↓ 
79.3 ↓ 
77.8 ↓ 

18.8 ↓ 
20.4 ↓ 
18.5 ↓ 
19.7 ↓ 
19.9 ↓ 
27.8 
30 
27.9 
28.6 
31.1 
19.7 ↓ 
22.6 ↓ 
21    ↓ 
22.6 ↓ 
20.7 ↓ 
24.1 ↓ 
22.8 ↓ 
24.8 ↓ 
25.2 ↓ 
25.9 ↓ 

30↓ 
31.2 ↓ 
29    ↓ 
30.3 ↓ 
28.9 ↓ 
32.9 
33 
33.5 
32.5 
33.8 
29.8 ↓ 
29.7 ↓ 
28.9 ↓ 
29.5 ↓ 
28.9 ↓ 
30.9 ↓ 
29.6 ↓ 
31.2 ↓ 
31.8 ↓ 
30.7 ↓ 

Cl
as
s  

II 
II 
II 
II 
II 
I 
I 
I 
I 
I 
III 
III 
III 
III 
III 
III 
III 
III 
III 
III 

Typ
e 

βTT 
βTT 
βTT 
IDA 
IDA 
nor 
nor 
nor 
nor 
nor 
βTT 
βTT 
βTT 
βTT 
βTT 
IDA 
IDA 
IDA 
IDA 
IDA 

∑

𝑛
𝑘=1

(|𝐿𝑜𝑖(𝑥𝑖

𝑘)|+|𝐻𝑖𝑖(𝑥𝑖
𝑘)−𝐿𝑜𝑗(𝑥𝑗
𝑛

𝑘)−𝐻𝑖𝑗(𝑥𝑗

𝑘)|)

         (10)                                                               

𝑘 is the value of the 𝑖’𝑡ℎ 
Where 𝑛 is the number of samples, 𝑥𝑖
CBC index for the 𝑘’𝑡ℎ sample, and 𝐿𝑜𝑖(𝑥)  and 𝐻𝑖𝑖(𝑥) are 
functions that denote whether 𝑥  is below the lower bound or 
above the upper bound of the normal range for the 𝑖’𝑡ℎ CBC 
index, respectively. 𝐿𝑜𝑖(𝑥) and 𝐻𝑖𝑖(𝑥) can be obtained from 
Eqs. (11,12) as follows.   

FIGURE 2. The algorithm for choosing inputs 

 
 
 
 
 
 
 
 
 
                                              
 
 
 
 
 
                                             
 
 
C.  PROPOSED METHOD 
The proposed method is based on harmony search and certain 
genetic programming principles. Before defining a harmony, 
the elements of the binary tree (Fig. 1) must be defined. The 
four indices of CBC chosen in the previous section populate 
the leaf nodes. Non-leaf nodes take the complete bi-variable 
polynomial 
the  Kolmogorov-Gabor 
from 
that  comes 
polynomial with six coefficients (Eq. 9). 

There  are  three  non-leaf  nodes  in  the  tree  and  the 
polynomial shown in (Eq. 9) is applied to each of them. Hence, 
there  are  18  parameters  that  must  be  tuned  up  to  reach  the 
optimum value. Because 𝑓𝑖 is a symmetric function, we can 
generate 15 different schemes for the tree (Fig. 1) and the four 
CBC  indices  chosen  as  input  variables.  Table  3  lists  the 
possible schemes for the tree. 

TABLE 3. 
DIFFERENT SCHEMES FOR GENERATING THE TREE WITH CHOSEN CBC.  

Id 

Scheme 

Function 

0 

1 

2 

3 

4 

5 

6 

7 

8 

9 

10 

11 

12 

13 

14 

𝑓1(𝑓2(𝑅𝐵𝐶, 𝐻𝑏), 𝑓3(𝐻𝐶𝑇, 𝑀𝐶𝑉)) 

𝑓1(𝑓2(𝑅𝐵𝐶, 𝐻𝐶𝑇), 𝑓3(𝐻𝑏, 𝑀𝐶𝑉)) 

𝑓1(𝑓2(𝑅𝐵𝐶, 𝑀𝐶𝑉), 𝑓3(𝐻𝑏, 𝐻𝐶𝑇)) 

𝑓1(𝑓2(𝑓3(𝑅𝐵𝐶, 𝐻𝑏) , 𝐻𝐶𝑇) , 𝑀𝐶𝑉) 

𝑓1(𝑓2(𝑓3(𝑅𝐵𝐶, 𝐻𝑏) , 𝑀𝐶𝑉) , 𝐻𝐶𝑇) 

𝑓1(𝑓2(𝑓3(𝑅𝐵𝐶, 𝐻𝐶𝑇) , 𝐻𝑏) , 𝑀𝐶𝑉) 

𝑓1(𝑓2(𝑓3(𝑅𝐵𝐶, 𝐻𝐶𝑇), 𝑀𝐶𝑉), 𝐻𝑏) 

𝑓1(𝑓2(𝑓3(𝑅𝐵𝐶, 𝑀𝐶𝑉), 𝐻𝑏), 𝐻𝐶𝑇) 

𝑓1(𝑓2(𝑓3(𝑅𝐵𝐶, 𝑀𝐶𝑉), 𝐻𝐶𝑇), 𝐻𝑏) 

𝑓1(𝑓2(𝑓3(𝐻𝑏, 𝐻𝐶𝑇), 𝑅𝐵𝐶), 𝑀𝐶𝑉) 

𝑓1(𝑓2(𝑓3(𝐻𝑏, 𝐻𝐶𝑇), 𝑀𝐶𝑉), 𝑅𝐵𝐶) 

𝑓1(𝑓2(𝑓3(𝐻𝑏, 𝑀𝐶𝑉), 𝑅𝐵𝐶), 𝐻𝐶𝑇) 

𝑓1(𝑓2(𝑓3(𝐻𝑏, 𝑀𝐶𝑉), 𝐻𝐶𝑇), 𝑅𝐵𝐶) 

𝑓1(𝑓2(𝑓3(𝐻𝐶𝑇, 𝑀𝐶𝑉) , 𝑅𝐵𝐶) , 𝐻𝑏) 

𝑓1(𝑓2(𝑓3(𝐻𝐶𝑇, 𝑀𝐶𝑉), 𝐻𝑏), 𝑅𝐵𝐶) 

A  one-dimensional  array  is  assigned  to  the  harmony, 
containing 19 elements. Fig. 3 shows the fields of a harmony 
for the proposed method. 

FIGURE 3. Structure of a harmony for the proposed method  

Therefore, a harmony describes the structure of a tree, which 
can  be  one  of  the  15  different  schemes  in  Table  3,  and  the 
𝑓𝑖 coefficients  of  that  tree.  To  determine  the  most  suitable 
scheme for this problem, the  harmony search algorithm can 
use a heuristic search to find the best structure for the system 
tree  using  the  ‘Id’  field  of  the  harmony  and  evaluating  its 
corresponding  tree  to  optimize  the  coefficients  of  the 
polynomials of the tree.  

D.  IMPLEMENTING THE PROPOSED METHOD 
We  use  the  programming  language  C#  to  implement  the 
proposed  method.  A  user  interface  is  provided  for  quick 
testing and tuning the algorithm’s  parameters. The interface 
gives the user the ability to set various parameters, including 
the  size  of  harmony  memory  (HMS),  the  initial  values  for 
HMCR and PAR, the number of improvisations (NI), and the 
choice  of  standard  harmony  search  or  dynamic  harmony 
search (DHS). Additionally, the interface monitors the outputs 
of the program. 

1)  INITIALIZE THE HARMONY MEMORY 
The harmony memory is initialized randomly by Eq. (2). The 
default value for HMS is 100, but it can be changed by the 
user. Hence, the harmony memory is a matrix of floating-point 
numbers of size 100×20. The elements of column 20 of the 
HM contain the fitness values for of each row/harmony. As 
shown in Fig. 3, a harmony is a one-dimensional array of size 
19  where  the  first  18  elements  contain  the  polynomials’ 
coefficients  and  the  last  element  contains  the  Id  of  the  tree 
scheme.  Hence,  the  values  for  the  18  first  elements  can  be 
determined by trial and error, but the last element must be an 
integer in range of [0, 14]. 
Therefore, we can calculate the values for the first 18 elements 
of harmony by Eq. (2), but the last element is obtained by Eq. 
(13) as follows: 
𝑋𝑖(𝑗) = 𝑐𝑒𝑖𝑙(15 × 𝑟),           𝑓𝑜𝑟 𝑖 = 1. . 𝐻𝑀𝑆 , 𝑗 = 19                                                  
(13) 
Where 𝑟 is a random number in range of [0, 1). The values for 
column  20  of  the  HM  are  determined  by  a  fitness  function 
described in the next section. Next, the HM rows are sorted in 
descending order with respect to their fitness (column 20). The 
harmonies in the HM are now organized best to worst from 
top to bottom. 

 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
2)  CALCULATING THE FITNESS FOR EACH HARMONY 
To determine the best harmony for the discrimination of IDA 
from thalassemia trait, suppose that 𝛼 and 𝛽 are the averages 
for the tree’s outcome when the CBC indices of the samples 
with IDA and thalassemia trait are applied, and 𝛾 and 𝛿 are the 
variances  of  those  values,  respectively.  It  is  clear  that  a 
function with a larger distance between averages and smaller 
variances is a better discriminator. Therefore, we use Eq. (14) 
as the fitness function for the harmony.  

  𝑓𝑖𝑡𝑛𝑒𝑠𝑠 =

|𝛼−𝛽|

1+𝛾𝛿

                                  (14)       

3)  USING DYNAMIC HARMONY SEARCH (DHS) 

INSTEAD OF STANDARD HS 

tuning 

Dynamic  harmony  search  combined  with 
the 
parameters leads to faster convergence  [48]. In the standard 
HS, the parameters of the algorithm such as HMCR and PAR 
have  fixed  values,  but  in  the  DHS,  the  parameter  HMCR 
changes with Eq. (15) as follows: 
𝐻𝑀𝐶𝑅𝑛𝑒𝑤 = 𝐻𝑀𝐶𝑅𝑜𝑙𝑑 + (1 − 𝐻𝑀𝐶𝑅𝑜𝑙𝑑) × (𝛼 − 𝛽)                                                    
(15) 
where 𝛼 and 𝛽 are the normalized fitness/cost average of ten 
recently  considered  memory  solutions  and  ten  recently 
generated random solutions respectively in maximum finding. 
However,  In  case  of  minimum  finding,  the  definitions  of 
solutions  are  contrariwise.  This  improvement  in  the  HS 
algorithm  is  tunned  to  be  occurred  every  ten  iterations. 
Likewise,  variable  𝐸  (which  is  derived  from  memory 
consideration)  is  used  to  evaluate  the  adjustment  of  new 
solutions  for  improving  the  pitch  adjustment  rate  (PAR)  as 
stated in Fig. 4. Variable 𝐸  can be further used in Eq. (16) to 
improve the parameter PAR for the proposed harmony search 
algorithm. 

           (16)                                                                          

𝐸×(1−𝑃𝐴𝑅𝑜𝑙𝑑)
100

𝑃𝐴𝑅𝑛𝑒𝑤 = 𝑃𝐴𝑅𝑜𝑙𝑑 +
Fig. 5 illustrates the improving process of PAR for every 10 
recently  generated  memory  solutions.  For  comparison 
between standard HS and DHS, the user interface can perform 
the proposed method with both algorithms optionally. As can 
be  seen  in  Fig.  4,  the  standard  HS  and  DHS  both  have 
converged  to  the  optimal  value,  but  the  standard  HS  needs 
more time than the dynamic harmony search. 

FIGURE 5.  Magnetization as a function of applied field. Note that “Fig.” 
is abbreviated. There is a period after the figure number, followed by 
two spaces. It is good practice to explain the significance of the figure 
in the caption. 

E.  TESTING THE PROPOSED METHOD 
To  test  the  proposed  method,  750  CBC  samples  have  been 
obtained from [47]. After eliminating unwanted samples, 532 
CBC  samples  remain  for  further  examination.  Of  the 
remaining subjects, there are 269 IDA and 263 β-TT subjects.  
Six  popular  medical  metrics,  sensitivity  (SENS),  specificity 
(SPEC), positive predictive value (PPV), negative predictive 
value (NPV), accuracy (ACC) and Youden’s index (YI), have 
been used in all of the experiments. These metrics are obtained 
by Eqs. (17-22). 

𝑆𝐸𝑁𝑆 =  

𝑇𝑃

𝑇𝑃+𝐹𝑁

𝑆𝑃𝐸𝐶 =

𝑇𝑁

𝑇𝑁+𝐹𝑃

× 100                          (17) 

× 100                            (18) 

𝑃𝑃𝑉 =

𝑇𝑃

𝑇𝑃+𝐹𝑃

× 100                              (19) 

𝑁𝑃𝑉 =

𝑇𝑁

𝑇𝑁+𝐹𝑁

× 100                             (20) 

𝐴𝐶𝐶 =

𝑇𝑃+𝑇𝑁

𝑇𝑃+𝑇𝑁+𝐹𝑃+𝐹𝑁

× 100                   (21) 

𝑌𝐼 = 𝑆𝐸𝑁𝑆 + 𝑆𝑃𝐸𝐶 − 100                   (22) 

FIGURE 4. 
(DHS) 

 Comparison between the standard HS and Dynamic HS 

Where  TP,  TN,  FP  and  FN  are  true  positive,  true  negative, 
false positive and false negative, respectively. Table 4 shows 
the results of applying the method to the test samples. 

 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Proposed method 

 TP 

NI* 

Item 

HMS** 

TABLE 4.  
COMPARISON OF THE METHOD’S IDA DIAGNOSIS RESULTS WITH DIFFERENT PARAMETERS (NUMBER OF SAMPLES = 400, IDA = 207, Β-TT = 193). 
YI 
(%) 
87.6 
90.1 
93.6 
96.1 
83.2 
89.7 
88.2 
92.1 

SENS 
(%) 
92.3 
93.7 
95.6 
97.1 
89.4 
92.8 
91.3 
94.2 

SPEC 
(%) 
95.3 
96.4 
97.9 
98.9 
93.4 
96.9 
96.9 
97.9 

ACC 
(%) 
93.7 
95.0 
96.7 
98.0 
91.5 
94.7 
94.0 
96.0 

NPV 
(%) 
92.0 
93.5 
95.5 
96.9 
89.2 
92.6 
91.2 
94.0 

PPV 
(%) 
95.5 
96.5 
98.0 
99.0 
93.9 
97.0 
96.9 
98.0 

2000 
2000 
8000 
8000 
2000 
2000 
8000 
8000 

184 
186 
189 
191 
181 
187 
187 
189 

50 
100 
50 
100 
50 
100 
50 
100 

191 
194 
198 
201 
185 
192 
189 
195 

16 
13 
9 
6 
22 
15 
18 
12 

9 
7 
4 
2 
12 
6 
6 
4 

TN 

FN 

FP 

STROGANOFF 

*  for STROGANOFF, it is number of generations 
** for STROGANOFF, it is population size 

V.  COMPARISON 
This section compares the best results of the proposed method 
against  well-known  works  in  the  literature.  This  section  is 
organized in two subsections. The first compares the proposed 
method with some traditional and some more recent methods 
on  the  same  dataset.  The  second  subsection  compares  the 
performance  of  the  proposed  method  with  the  information 
reported by other researchers. 

A. Traditional method for discrimination between IDA 

and β-TT 

There  are  several  mathematical  methods  that  traditionally 
have  been  used  for  the  IDA/  β-TT  discrimination  problem. 
Some  of  these  methods  are  shown  in  Table  5.  For  better 
comparison, the traditional methods were tested on the same 
CBC samples used for the proposed method. The results for 
these methods are shown in Table 6. The results in Table 6 
show that the proposed method is significantly more accurate 
than  traditional  methods.  The  range  of  accuracy  for  the 
traditional methods, which are based on a simple mathematical 
formula, is in (78, 93.2), while the proposed method has an 
accuracy of approximately 98%.

TABLE 5. 
 TRADITIONAL METHOD FOR DISCRIMINATION BETWEEN IDA AND Β-TT 

Authors  

Mentzer et al. [14] 
England & Fraser [7] 
Srivastava & Bevington [49] 
Shine & Lal [12] 
Sirdah et al. [16] 
Ehsani et al. [6] 
Green & King [8] 

Symbol  
MI 
E&FI 
S&BI 
S&LI 
SI 
EI 
G&KI 

Year  
1973 
1973 
1973 
1977 
2008 
2009 
1989 

Formula  
𝑀𝐶𝑉/𝑅𝐵𝐶 
𝑀𝐶𝑉 − 𝑅𝐵𝐶 − 5 × 𝐻𝑏 − 3.4 
𝑀𝐶𝐻/𝑅𝐵𝐶 
𝑀𝐶𝑉2 × 𝑀𝐶𝐻 × 0.01 
𝑀𝐶𝑉 − 𝑅𝐵𝐶 − 3 × 𝐻𝑏 
𝑀𝐶𝑉 − 10 × 𝑅𝐵𝐶 
𝑀𝐶𝑉2 × 𝑅𝐷𝑊 × 𝐻𝑏 × 0.01 

IDA 
≥ 13 
≥ 0 
≥ 3.8 
≥ 1530 
≥ 27 
≥ 15 
≥ 72                                                                                                                                                                                                                                                                                                                                                                                                                                                              

β-TT 
< 13 
< 0 
< 3.8 
< 1530 
< 27 
< 15 
< 72 

FP 

TP 

TN 

Method 

TABLE 6.  
COMPARISON OF TRADITIONAL METHODS AND THE PROPOSED METHOD IN DISCRIMINATION BETWEEN IDA (SAMPLES ARE SAME AS TABLE 4). 
SENS 
(%) 
84.5 
73.4 
77.8 
91.8 
74.9 
77.3 
88.9 
97.1 

MI [14] 
E&FI [7] 
S&BI [49] 
S&LI [12] 
SI [16] 
EI [6] 
G&KI [8] 
This work 

SPEC 
(%) 
85.5 
83.4 
83.4 
94.8 
81.3 
87.0 
89.6 
98.9 

ACC 
(%) 
85.0 
78.0 
80.5 
93.2 
78.0 
82.0 
89.3 
98.0 

NPV 
(%) 
83.8 
74.5 
77.8 
91.5 
75.1 
78.1 
88.3 
96.9 

PPV 
(%) 
86.2 
82.6 
83.4 
95.0 
81.2 
86.5 
90.2 
99.0 

YI 
(%) 
70.0 
56.8 
61.2 
86.6 
56.2 
64.3 
78.5 
96.1 

175 
152 
161 
190 
155 
160 
184 
201 

165 
161 
161 
183 
157 
168 
173 
191 

32 
55 
46 
17 
52 
47 
23 
6 

28 
32 
32 
10 
36 
25 
20 
2 

FN 

 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
B.Artificial intelligence-based models for classification 

anemia 

There  are  several  AI-based  models  for  the  diagnosis  and 
classification  of  anemia.  The  second  set  of  experiments 
compares the performance of the proposed method with other, 

similar methods. As can be observed in Table 7, the proposed 
method  is  more  accurate  than  these  other  similar  methods. 
Although the results for [50] seem to be better than this work, 
but the method which is used by [50] get thee image of blood 
cells  as  the  system  input  instead  of  CBC,  which  needs 
additional laboratory test on patient. 

TABLE 7. 
 COMPARISON OF THIS WORK AND REPORTED RESULTS OF SOME SIMILAR METHODS. 
Method 

Year 

Specificity 

Authors  
Accuracy 
Azarkhish et al. [33]  
90.7 
Azarkhish et al.  [33] 
96.3 
Amendolia et al. [32] 
93.5 
Amendolia et al. [31] 
89.0 
Amendolia et al. [31] 
85.0 
Khaki Jamei et al. [47] 
98.0 
Masala et al.  [3] 
----- 
Masala et al. [3] 
----- 
Shikha Purwar et al. [50] 
99.0 
This Work 
98.7 
1adaptive neuro-fuzzy inference system; 2artificial neural network; 3multi-layer perceptron; 4support vector machine; 5K-
nearest neighbor; 6pattern-base input selection artificial neural network; 7radial basis function; 8probabilistic neural network; 
9dynamic harmony search ;  

ANFIS1 
ANN2 
MLP3 
SVM4 
KNN5 
PBIS-ANN6 
RBF7 
PNN8 
KNN5, SVM4, ANN2 
DHS9 

Sensitivity 
87.1 
96.8 
95.0 
95.0 
77.0 
97.7 
93.0 
89.0 
98.0 
97.1 

2012 
2012 
2002 
2003 
2003 
2016 
2013 
2013 
2019 

95.6 
95.6 
92.0 
83.0 
93.0 
98.4 
91.0 
73.0 
99.0 
98.9 

VI. CONCLUSIONS 
In this study, a new method based on dynamic harmony search 
(DHS) was proposed for the discrimination of iron deficiency 
anemia (IDA) and β-thalassemia trait (β-TT). The method is 
implemented  in  C#  and  has  been  successfully  tested  using 
collected  CBC  sample  data  as  input.  Choosing  the  most 
suitable CBC indices to use as the system input is performed 
by  a  pattern-based  index  selection  (PBIS)  algorithm.  The 
proposed method has been trained on 132 CBC samples. The 
results indicate that the proposed method, with an accuracy of 
approximately  98%,  outperforms  the  other  methods  in  the 
literature. The existing artificial neural network (ANN), MLP, 
and  ANFIS  methods,  respectively,  show 
the  nearest 
performance on the anemia classification problem. 

REFERENCES 

[1]  D. Weatherall and J. Clegg, The Thalassemia Syndromes, 

4th ed. Malden: MA: Blackwell Science, 2001. 

[2]  T.  Piroonratana  et  al.,  “Classification  of  haemoglobin 
typing chromatograms by neural networks  and decision 
trees for thalassaemia screening,” Chemom. Intell. Lab. 
Syst., vol. 99, no. 2, pp. 101–110, 2009. 

[3]  G. L. Masala, B. Golosio, R. Cutzu, and R. Pola, “A two-
layered classifier based on the radial basis function for the 
screening of thalassaemia,” Comput. Biol. Med., vol. 43, 
pp. 1724–1731, 2013. 

[4]  S.  Ayabose,  J.  Giavanelli,  I.  O.  Levendoglu-Tuga,  C. 
and  P.  Visintainer, 
Sandoval,  F.  Özkaynak, 
“Differentiating 
from 
anemia 
Thalassemia  minor  by  using  an  RDW-based  index,”  J 
Pediatr Hematol, vol. 21, p. 314, 1999. 

deficiency 

iron 

[5]  A.  Demir,  N.  Yarali,  T.  Fisgin,  F.  Duru,  and  A.  Kara, 
“Most 
in  differentiation  between 
thalassemia  trait  and  iron  deficiency  anemia,”  Pediatr. 
Int., vol. 44, no. 6, pp. 612–616, 2002. 

reliable 

indices 

[6]  M.  A.  Ehsani,  E.  Shahgholi,  M.  S.  Rahiminejad,  F. 
Seighali, and A. Rashidi, “A new index for discrimination 

[7] 

between  iron  deficiency  anemia  and  beta-thalassemia 
minor: results in 284 patients,” Pak J Biol. Sci, vol. 12, 
no. 5, pp. 473–475, 2009. 
J. M. England and P. M. Fraser, “Differentiation of iron 
deficiency  from  thalassemia  trait  by  routine  blood–
count,” Lancent, vol. 1, no. 7801, pp. 447–449, 1973. 
[8]  R. Green and R. King, “A new red blood cell discriminant 
incorporating  volume  dispersion  for  differentiating  iron 
deficiency anemia from thalassemia minor,” Blood Cells, 
vol. 15, pp. 481–495, 1989. 

[9]  T.  Higgins,  Y.  Brierley,  and  A.  Khajuria,  “Use  of 
mathematical  indices  based  on  CBC  data  to  identify 
patients  with  β  thalassemia  minor,”  Rev.  Român  ăde 
Med. ăde Lab., vol. 8, no. 3, pp. 7–12, 2007. 

[10]  C.  V  Jimenez,  J.  Minchinela,  and  J. Ros, “New indices 
from  the  H*2  analyser  improve  differentiation  between 
heterozygous  beta  or  delta  beta  thalassaemia  and  iron-
deficiency anaemia,” Clin. Lab. Haematol., vol. 17, no. 2, 
pp. 151–155, 1995. 

[11]  E.  Miri-Moghaddam  and  N.  Sargolzaie,  “Cut  off 
determination  of  discrimination  indices  in  differential 
diagnosis  between  iron  deficiency  anemia  and  beta  -
thalassemia minor,” Int. J. Hematol. Stem Cell Res., vol. 
8, no. 2, pp. 27–32, 2014. 

[12]  I. Shine and S. Lal, “A strategy to detect beta thalassemia 

minor,” Lancent, vol. 1, no. 8013, pp. 692–694, 1977. 

[13]  P. Srivastava and J. Bevington, “Iron deficiency and–or 
thalassemia trait,” Lancent, vol. 1, no. 7807, p. 832, 1973. 
[14]  W. C. Mentzer, “Differentiation of iron deficiency from 
thalassemia trait,” Lancent, vol. 1, no. 7808, p. 882, 1973. 
[15]  D.  R.  Bonds,  “Three  decades  of  innovation  in  the 
management  of  sickle  cell  disease: 
to 
understanding the sickle cell disease clinical phenotype,” 
Blood Rev., vol. 19, no. 2, pp. 99–110, 2004. 

the  road 

[16]  M.  Sirdah,  I.  Tarazi,  E.  Al  Najjar,  and  R.  Al  Haddad, 
“Evaluation of the diagnostic reliability of different RBC 
indices  and  formulas  in  the  differentiation  of  the  β-
thalassemia  minor  from  iron  deficiency  in  Palestinian 
population,” Int. J. Lab. Hematol., vol. 30, no. 4, pp. 324–
330, 2008. 

[17]  R. Agatonovic-Kustrin and S. Beresford, “Basic concepts 
of  artificial  neural  network  (ANN)  modeling  and  its 

 
 
 
 
 
 
 
 
 
application  in  pharmaceutical  research.,”  J.  Pharm. 
Biomed. Anal., vol. 22, pp. 717–727, 2000. 

[18]  J.  J.  Forsstrom  and  K.  J.  Dalton,  “Artificial  neural 
networks for decision support in clinical medicine,” Ann 
Med, vol. 27, pp. 509–517, 1995. 

[19]  A. N. Ramesh, C. Kambhampati, J. R. Monson, and P. J. 
Drew, “Artificial intelligence in medicine,” Ann R Coll 
Surg Engl, vol. 86, pp. 334–338, 2004. 

[20]  J.  Downs,  R.  Harrison,  R.  Kennedy,  and  S.  Cross, 
“Application  of  the  fuzzy  ARTMAP  neural  network 
model  to  medical  pattern  classification  tasks,”  Artif. 
Intell. Med., vol. 8, no. 4, pp. 403–28, 1996. 

[21]  S.  Lekkas  and  M.  Ludmil,  “Evolving  fuzzy  medical 
diagnosis of Pima Indians diabetes and of dermatological 
diseases,” Artif. Intell. Med., vol. 50, no. 2, pp. 117–126, 
2010. 

[22]  B.  Kovalerchuk,  E.  Traintaphyllou,  J.  Ruiz,  and  J. 
Clayton,  “Fuzzy  logic  in  computer-aided  breast  cancer 
diagnosis: analysis of lobulation,” Artif. Intell. Med., vol. 
11, no. 1, pp. 75–85, 1997. 

[23]  P. R. Lund and R. D. Barnes, “Automated classification 
of anaemia using image analysis,” Lancent, vol. 300, no. 
7775, pp. 463–464, 1972. 

[24]  R. L. Engle et al., “HEME: a computer aid to diagnosis of 
hematologic  disease,”  Bull.  N.  Y.  Acad.  Med.,  vol.  52, 
pp. 584–600, 1976. 

[25]  G. M. Barosi, Cazzola, C. Berzuini, S. Quaglini, and M. 
Stefanelli,  “Classification  of  anemia  on  the  basis  of 
ferrokinetic  parameters,”  Br.  J.  Haematol.,  vol.  61,  pp. 
357–370, 1985. 

[26]  S. Quaglini, M. Stefanelli, G. Barosi, and A. Berzuini, “A 
performance evaluation of the expert system ANEMIA,” 
Comput. Biomed. Res., vol. 21, pp. 307–323, 1988. 
[27]  S.  Quaglini,  M.  Stefanelli,  G.  Barosi,  and  A.  Berzuini, 
“ANEMIA:  an  expert  consultation  system,”  Comput. 
Biomed. Res., vol. 19, no. 1, pp. 13–27, 1986. 

[28]  G.  Lanzola,  M.  Stefanelli,  G.  Barosi,  and  L.  Magnani, 
“NEOANEMIA:  a  knowledge-based  system  emulating 
diagnostic reasonin,” Comput. Biomed. Res., vol. 23, pp. 
560–582, 1990. 

[29]  N. I. Birndorf, J. O. Pentecost, J. R. Coakley, and K. A. 
Spackman,  “An  expert  system  to  diagnose  anemia  and 
report  results  directly  on  hematology  forms.,”  Com 
Biomed Res, vol. 29, no. 1, pp. 16–26, 1996. 

[30]  N. Nikolaev, L. M. de Menezes, and H. Ib, “Automated 
classification of anaemia using image analysis,” in 2002 
Congress on Evolutionary Computation, 2002, pp. 1209–
1214. 

[31]  S. R. Amendolia, G. Cossu, M. L. Ganadu, B. Golosio, 
G. L. Masala, and G. M. Mura, “A comparative study of 
k-nearest neighbour, support vector machine and multi-
layer  perceptron  for  thalassemia  screening,”  Chemom. 
Intell. Lab. Syst., vol. 1, pp. 13–20, 2003. 

[32]  S. R. Amendolia et al., “A real-time classification system 
of  thalassemic  pathologies  based  on  artificial  neural 
networks.,” Med. Decis. Making, vol. 22, no. 1, pp. 18–
26, 2002. 

[33]  I.  Azarkhish,  M.  R.  Raoufy,  and  S.  Gharibzadeh, 
“Artificial 
iron 
deficiency  anemia  and  iron  serum  level  based  on 
accessible laboratory data,” J. Med. Syst., vol. 36, no. 3, 
pp. 2057–2061, 2012. 

intelligence  models  for  predicting 

[34]  J.  F.  Engelhard, Commentatio de vera  materia  sanguini 
impertientis  natura.  Göttingen: 

purpureum  colorem 
Dietrich, 1825. 

[35]  Z. W. Geem, J. H. Kim, and G. V. Logonathan, “A New 
Heuristic  Optimization  Algorithm:  Harmony  Search,” 
Simulation, vol. 78, no. 2, pp. 60–68, 2001. 

[36]  M. Mahdavia, M. Fesangharyb, and E. Damangirb, “An 
improved  harmony  search  algorithm 
for  solving 
optimization  problems,”  Appl  Math  Comput,  vol.  188, 
no. 2, pp. 1567–79, 2007. 

[37]  K.-S.  Lee  and  Z.  W.  Geem,  “A  new  meta-heuristic 
algorithm  for  continuous  engineering  optimization: 
harmony  search  theory  and  practice,”  Comput Methods 
Appl Mech Eng, vol. 194, no. 36–38, pp. 3902–33, 2005. 
[38]  Z. W. Geem, “Optimal cost design of water distribution 
networks using harmony search,” Eng Optim, vol. 38, no. 
3, pp. 259–77, 2010. 

[39]  Z.  W.  Geem,  J.  H.  Kim,  and  G.  V.  Logonathan, 
“Harmony  search  optimization :  Application  to  pipe 
network design,” Int J Model Simul, vol. 22, no. 2, pp. 
125–33, 2002. 

[40]  K.  S.  Lee  and  Z.  W.  Geem,  “A  new  structural 
optimization  method  based  on  the  harmony  search 
algorithm,”  Comput  Struct,  vol.  82,  no.  9,  pp.  781–98, 
2004. 

[41]  Z.  W.  Geem,  “Optimal  Scheduling  of  Multiple  Dam 
System  Using  Harmony  Search  Algorithm,”  Comput 
Ambient Intell, vol. 4507, pp. 316–23, 2007. 

[42]  S. O. Degertekin, “Optimum design of steel frames using 
harmony  search  algorithm,”  Struct  Multidiscip  Optim, 
vol. 36, no. 4, pp. 393–401, 2007. 

[43]  Z.  W.  Geem,  Music-Inspired  Harmony  Search 

Algorithm. Berlin Heidelberg: Springer-Verlag, 2009. 

[44]  H. Iba, H. de Garis, and T. Sato, “Genetic programming 
using  a  minimum  description  length  principle,”  in 
Advances 
in  Genetic  Programming,  K.E.  Kinne., 
Cambridge, MA: MIT Press, 1994, pp. 265–284. 
[45]  N.  Nikolaev  and  H.  Iba,  “Regularization  approach  to 
inductive  genetic  programming,”  IEEE  Trans.  Evol. 
Comput., vol. 5, no. 4, pp. 359–375, 2001. 

[46]  W.  Wongseree,  N.  Chaiyaratana,  K.  Vichittumaros,  P. 
Winichagoon,  and  S.  Fucharoen,  “Thalassaemia 
classification  by  neural  networks 
and  genetic 
programming,” Inf. Sci. (Ny)., vol. 177, no. 3, pp. 771–
786, 2007. 

[47]  M.  K.  Jamei,  K.  M.  Talarposhti,  and  S.  Branch, 
“Discrimination between Iron Deficiency Anaemia ( IDA 
) and β - Thalassemia Trait ( β -TT ) Based on Pattern- 
Based Input Selection Artificial Neural Network ( PBIS-
,” vol. 7, no. 4, pp. 55–66, 2016. 

[48]  K. Mirzaei Talarposhti  and M. Khaki  Jamei,  “A  secure 
image  encryption  method  based  on  dynamic  harmony 
search (DHS) combined with chaotic map,” Opti Lasers 
Eng, vol. 81, pp. 21–34, 2016. 

[49]  P. C. Srivastava and J. M. Bevington, “No Iron deficiency 
and–or  thalassemia  trait,”  Lancent,  vol.  1,  no.  7807,  p. 
832, 1973. 

[50]  S. Purwar, R. Kumar, T. Ravi, and R. Renu, “Detection 
of  microcytic  hypochromia  using  cbc  and  blood  film 
features  extracted  from  convolution  neural  network  by 
different classifiers,” 2019. 

 
 
 
 
 
 
 
