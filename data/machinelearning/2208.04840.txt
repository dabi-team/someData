RISK-AVERSE STOCHASTIC OPTIMIZATION FOR FARM
MANAGEMENT PRACTICES AND CULTIVAR SELECTION UNDER
UNCERTAINTY

2
2
0
2

l
u
J

7
1

]

C
O
.
h
t
a
m

[

1
v
0
4
8
4
0
.
8
0
2
2
:
v
i
X
r
a

Faezeh Akhavizadegan, Javad Ansarifar, Lizhi Wang
Department of Industrial and Manufacturing Systems Engineering
Iowa State University
Ames, IA 50011, USA
{faezeh, javad, lzwang}@iastate.edu

Sotirios V. Archontoulis
Department of Agronomy
Iowa State University
Ames, IA 50011, USA
sarchont@iastate.edu

ABSTRACT

Optimizing management practices and selecting the best cultivar for planting play a signiﬁcant role
in increasing agricultural food production and decreasing environmental footprint. In this study, we
develop optimization frameworks under uncertainty using conditional value-at-risk in the stochastic
programming objective function. We integrate the crop model, APSIM, and a parallel Bayesian
optimization algorithm to optimize the management practices and select the best cultivar at different
levels of risk aversion. This approach integrates the power of optimization in determining the best
decisions and crop model in simulating nature’s output corresponding to various decisions. As
a case study, we set up the crop model for 25 locations across the US Corn Belt. We optimized
the management options (planting date, N fertilizer amount, fertilizing date, and plant density in
the farm) and cultivar options (cultivars with different maturity days) three times: a) before, b) at
planting and c) after a growing season with known weather. Results indicated that the proposed
model produced meaningful connections between weather and optima decisions. Also, we found
risk-tolerance farmers get more expected yield than risk-averse ones in wet and non-wet weathers.

Keywords Farm Optimization, Cultivar and Fertilizer Selection, Robust, Stochastic, Bayesian Optimization.

1

Introduction

A key to improving agricultural output is developing precise decision-making in farming systems subject to different
objectives and constraints [1, 2, 3]. This efﬁcient farming system signiﬁcantly impacts the farm’s productivity and
proﬁtability in the short and long term. Although establishing this decision-making procedure plays a crucial role in
assisting farmers, the development of such a decision-making process to consider nature behavior is a challenging
issue [2, 4]. The challenge for optimizing the farming system is the dynamic and complex nature of the system as
well as uncertainties in the future weather. Use of an optimization framework containing complex system processes
and weather uncertainty to determine managerial decisions is a required step towards improving the management and
efﬁciency in crop production systems [5, 6].

Among a variety of approaches, optimization-oriented approaches can provide a more promising and valuable decision-
making platform for an agricultural system by taking account of agricultural, economic, and environmental factors
at the same time [7, 8]. Optimization techniques design optimal farming systems to achieve maximum returns and
minimum environmental footprint corresponding to resource usage and management practices. In-depth reviews of
operation research approaches in crop production systems have been published by Jain et al. [9], Caicedo Solano et al.
[10], Dury [1], Le Gal et al. [11], Singh [12], Martin et al. [13], and Kanter et al. [14]. The existing approaches were
developed to address two types of problems: optimizing management strategies and optimizing land, water resources,
and cropping patterns.

 
 
 
 
 
 
Risk-averse Stochastic Optimization for Farm Management Practices

As the ﬁrst category that focuses on optimization management strategies, Capitanescu et al. [15] developed a multi-stage
mixed-integer linear programming model for optimal farm management by considering environmental and crop rotation
constraints. Klein et al. [16], by developing a regional multi-objective optimization approach, and Holzkämper et
al. [17], by proposing multi-objective optimization model, evaluated various management practices as a response to
adaptation to climate change. To design a sustainable farming system, Liang et al. [18] formulated a multi-objective
mixed-integer nonlinear fractional programming problem by considering the most important elements of organic
farming systems including, crop cultivation, soil organic matter, nitrogen rate, and livestock production. Barbosa et al.
[19] proposed a convolutional neural network to assess yield response to nutrient and seed rate management. Groot et
al. [20] designed a farming system using a multi-objective optimization model to maximize proﬁt and organic matter
accumulation and minimize labor hour and N loss as objective functions. Applications of dynamic programming models
in optimizing agricultural management practices problems were conducted by Kennedy [21], Parsons et al. [22], and
Janová et al. [23]. As the combinations of two categories, Pastori et al. [24] developed a multi-objective evolutionary
approach to assess the effects of water and nutrient management options in Africa. Moreover, Bhar et al. [25] used
the root zone water quality model and three global optimization methods to optimize the fertilization and irrigation
decisions under the maximization of farm proﬁt. Their study reported about 7% improvement in yield and about 10%
improvement in proﬁt compared to the experimental data of Trout and Bausch [26].

The second category of existing research refers to the optimization of land, water resources, and cropping patterns.
Optimization approaches for cropping pattern management include linear model [27, 28], multi-stage linear program-
ming model [29], integer linear programming model [30, 31], mixed-integer linear programming [32], multi-period
mixed integer nonlinear programming model [33], stochastic programming [34], fuzzy goal programming model
[35, 36, 37], dynamic optimization model [38], improved evolutionary model [39], pareto-based evolutionary model
[40], crop rotation model [41], and network models [42]. Most previous approaches that focus on optimizing land
and water resources include linear programming model [43, 44, 45, 46], multi-objective linear programming [47, 48],
mixed-integer nonlinear programming algorithms [49], multi-objective genetic algorithm [50, 51], multi-objective
compromise programming [52], genetic algorithm and linear programming [53, 54], non-linear optimization model
[55], inexact rough-interval fuzzy linear programming [56], robust multistage interval-stochastic programming method
[57], Simulation-optimization modeling [58], dynamic programming [59], chance-constrained linear programming
[60, 61].

Despite signiﬁcant previous efforts, our literature review on optimization of farm management reveals that the assessment
of management practice options before and after gowning season with a realistic model that reﬂects the non-linear
relationship between its explanatory variables is missing. Most previous studies used simple regression model to assess
productivity impact. To our knowledge none has used a biophysical model. Hence, in this research, we used the APSIM
crop model to mimic nature and simulate the farming system. To have a near-reality agricultural system, we used a
calibrated crop model that simulates yields reasonably close to historical data. Then, this crop model is utilized as a
simulator step of the optimization process to evaluate optimizers’ decisions appropriately.

In this paper, to address uncertainty in decision-making, we propose optimizers using parallel Bayesian algorithms
as the core search engine to effectively search for the best combinations of management decisions over unknown
objective functions. We incorporate risk considerations in the proposed decision-making framework via conditional
value-at-risk (C-VaR) measure to make a decision under uncertainty and evaluate the the risk associated with the
decisions during a growing season. This decision-making tool is able to take into account agricultural and farmers’
objective functions (maximizing yield or proﬁt, minimizing N loss and the environmental footprint), realistic farming
system, and weather uncertainties to optimize the farm management practices before and after growing season and
select the best management practice. In this research, farm management options are planting date, N fertilizer amount,
fertilizing date, and plant density in the farm, and cultivar options are cultivars with different maturity days under
uncertainty towards maximizing yield. We set up crop model from 25 locations across the US Corn Belt from 1984 to
2019 (34 years) and optimized management and cultivar options for three test years (2016-2018) at three time-wise
strategies during growing season (ﬁrst of March, ﬁrst of May, and ﬁrst of November). Finally, we interpret the optimal
decisions of the proposed decision-making framework using stochastic and robust optimizers.

2 Problem Deﬁnition

The ﬁrst crucial step of crop production for farmers is planning and decision making about which and when cultivars
must be planted or what management practices must be carried out. The challenge for farmers during this decision-
making process is weather uncertainties that determine yield potential and to some extend uncertainty in product prices.
Farmers can not control the weather or the market price but can control the management (cultivar, fertilizer, and planting
decisions). In this research, we consider a farmer who wants to make decisions about the management practices options
and determines the best choice for the cultivar. The farmer seeks to optimize his objective function (maximizing the

2

Risk-averse Stochastic Optimization for Farm Management Practices

farm’s proﬁt, minimizing N loss, and minimizing environmental footprint) for the next growing season by making the
right decisions with unknown weather before the growing season. Management decision can be row spacing, plant
density, planting date, fertilizing date, fertilizer amount, and type of cultivar. We aim to address this problem by making
decision in three time in growing season such as ﬁrst of March (earlier time), ﬁrst of May (Plant time), and ﬁrst of
November (harvest time) and considering weather uncertainties simultaneously. The difference between the three time
periods is the weather uncertainty.

3 Method

The proposed decision-making process for optimizing management practices and cultivars selection under uncertainty
is illustrated in Figure 1. Because of uncertain weather information and complex behavior of nature on management
practices and cultivar options, we used the power of crop model and both stochastic and robust optimization frameworks.
First, we deﬁned different scenarios using historical information due to unknown weather. Then, the optimization model
uses these scenarios to deal with a decision-making process under uncertainty. The optimization framework consists of
two elements: optimizer and simulator. The framework is an iterative process because the optimizer determines the
optimal solution during several iterations. Optimizer requires a simulator to evaluate the solution’s performance. The
optimizer is exploring the best solution in solution spaces, while the simulator’s simulate an agriculture system based
on each solution.

Figure 1: The proposed decision-making process for management practices and cultivars selection.

Simulator

We use the APSIM crop model [62] as a near-reality agricultural system in our framework to evaluate the performance
of speciﬁc management practices and selected cultivar. Crop models like Apsim can simulate nature processes by
using a series of non-linear equations from the physiological understanding of plant processes [63, 64]. Crop models
have been successful in testing crop management strategies [65], forecasting crop yield [66], evaluating cultivars in
breeding programs [67], and exploring climate change impacts on productivity [68]. The input of crop models is cultivar
information, environment (soil proﬁle and weather), and management practices.

In the proposed model, the optimizer sends a decision to Apsim, and we modify the crop model’s input based on the
decision and run the model. According to Apsim output and evaluation criterion, the simulator returns the corresponding
value.

Optimizer

As an optimizer, we propose a stochastic and robust optimization framework for optimizing farm management practices
and cultivar options using a recently developed parallel Bayesian optimization algorithm [69]. We use several scenarios
to cope with uncertainty (e.g., unknown weather data for the next growing season). In mathematical programming, we
apply C-VaR as a tractable measure to model the risk associated with these scenarios. The core of the optimizer is a
parallel Bayesian optimization algorithm. The proposed optimizer using a parallel Bayesian optimization is explained
in Algorithm 2.

3

Risk-averse Stochastic Optimization for Farm Management Practices

A parallel Bayesian optimization is an iterative approach so that it tries to improve the incumbent solution effectively.
PBO runs N parallel BO [70], and at each iteration, BO models propose combinations of variables. Each BO proposes
one combination of variables at each iteration and calls the crop model for all scenarios to evaluate its performance. In
calculating an objective function, we use the C-VaR of yield performance to manage the risk associated with weather
uncertainty. By deﬁning the probability density function of yield under different scenarios and denoting α as a parameter
indicating the right tail probability of that function, C-VaRα is deﬁned as the expected value in the worst 100*α% of
the yield distribution (yield set under different scenarios) [71]. For instance, if α = 1, the optimizer would be stochastic
optimization. If α = 1/|S| where |S| is a number of scenarios and probability of scenarios are equal, the optimizer
would be robust optimization.

In a Stochastic approach, the objective function of one solution is the expected objective function values of all scenarios.
In contrast, robust optimization computes it as the objective function value of the worst scenario. After calculating the
objective function of one combination, we add this combination and associated objective function value to the dataset.
Then, the gaussian process updates the posterior probability, and each BO proposes a new management combination.
We continue until the maximum iteration is reached. In the end, The best combination of management practices and
cultivar with the best objective function value between the dataset is chosen for the optimal solution.

Algorithm 1 optimizer
1: Input: Data set D = {(x0, y0)}, N as number BO models are run in parallel and T as maximum iteration, α as a

right tail probability of that yield distribution, Is as scenario s ∈ S, where S denotes set of scenarios.

2: Output: A local optimal solution x∗ ∈ R1×p.
3: Step 0: Set Kn, σ, and un as a type of kernel, set of kernel parameters, and acquisition function of nth BO for all

n ∈ {1, ..., N }. Set incumbent solution x∗ = x0.

for n = 1 to N do

4: for t = 1 to T do
5:
6:
7:
8:

9:

10:
11:
12: end for

end for

Step 1: Use GP to update the posterior probability ˆfn and construct the acquisition function un.
Step 2: Find xn
t by optimizing the acquisition function un over function f : xn
Step 3: For each scenario Is, call a crop model by modifying its ﬁle according to each scenario to evaluate the
performance of solution xn
t , Is).
Step 4: Calculate the objective function of solution xn
stochastic optimization as yn
Step 5: Augment the data D = {D, (xn

t = mins∈S{f (xn
t , Is)/|S| and robust optimization as yn
t )} and update the incumbent solution x∗ = xarg max(y).

t for scenario s as f (xn
t = (cid:80)

t as mean of the α-tail distribution of f (xn

t = arg maxx un(x|D).

t , Is). For
t , Is)}.

s∈S f (xn
t , yn

We provide additional details about the algorithm as follows.

• Hyperparameters:

Parameter N denotes the number of parallel BO algorithms. By T , we deﬁne the maximum number of
iterations as the stop criterion of the algorithm. This criterion can be replaced with a threshold so that the
algorithm is stopped when the difference between the performance of incumbent and new solutions is less than
a predeﬁned threshold. Is denotes the information of scenario s.

• Step 0: At this step, each BO chooses one type of acquisition function, kernel, and kernel parameters for its

Gaussian process.

• Step 1: In this step, Gaussian process updates the posterior probability, and build acquisition function.
• Step 2: The limited-memory quasi-Newton algorithm for bound-constrained optimization L-BFGS-B [72, 73]
in Python is applied to optimize the acquisition function. L-BFGS-B algorithm is run with a set of random
starting points to enhance the efﬁciency of optimizing the acquisition function.

• Step 3: We modify the APSIM Files according to each new combination of variables from step 3 and run the

APSIM for each scenario.

• Step 4: In this step, we calculate the objective function of the solution as mean of the α-tail distribution of
f (xn
t , Is). If the optimization is Stochastic, the objective function value is the expected objective function
values of all scenarios, where robust optimization calculates it as the objective function value of the worst
scenario.

• Step 5: Then, the new solution and its objective function value are added to the dataset to expand BO’s
knowledge about posterior distribution. The incumbent solution is updated as the best combinations of
parameters evaluated by APSIM under all scenarios in this step.

4

Risk-averse Stochastic Optimization for Farm Management Practices

Indeed, stochastic optimization maximizes/minimizes the expected objective function value of all scenarios, while
robust optimization tries to maximize/minimize the objective function value of the worst scenario. Both proposed
stochastic and robust optimization frameworks ensure optimality and feasibility of solution even when the weather
changes in the next growing season by balancing the level of uncertainty and objective function values.

4 Case Study

To show the performance of the proposed framework in optimizing the managerial decision and selecting cultivar,
we designed a case study 25 locations in the US Corn belt outlined by Akhavizadegan et al [69]. In each location
(combinations of 5 counties × 5 soil series within a county) the model ran for 1984 to 2019 (34 years). The APSIM
maize crop model [74] (version 7.9) was used because it is an open-source and widely used in the US Corn Belt and
worldwide [75, 76]. For each location, we used USDA-NASS management information to run the model (planting date,
plant density, N-fertilizer) and used USDA-NASS corn yield data to calibrate cultivar parameters towards representing
well actual yields. Overall, the model perform well in simulating corn yields (see Akhavizadegan et al [69]).

4.1 Experiment Settings

In this study, we considered 25 APSIM simulations corresponding to 25 locations, and we selected the following
variables summarized in Table 1 to optimize. The management options are planting date (10 possible values), N
fertilizer amount (21 possible values), N fertilizing date (10 possible values), plant density (7 possible values), and
cultivar options (4 possible values). All combination of variables resulted in 10*21*10*7 *4 = 58,800 simulations per
weather scenario. Yield performance as objective functions was used for optimizing and evaluating the combination of
management decisions and cultivar performance.

Table 1: List of variables with their ranges and units used in this study.

Variable
Planting date
N fertilizer amount
N fertilizing date
Plant density
Cultivars

Value or Range
April 15th to June 15th (weekly steps)
0 to 400 (20 kg/ha steps)
Apr to June (weekly steps)
2 to 14 (1 pl/m2 plant steps)
100, 105, 110, and 115 relative maturity days

Unit
day
kg/ha
day
pl/m2

Since farmers are choosing cultivars and deciding some management practices for the next growing season prior to
planting, we explore the performance of the optimization framework under three timewise strategies during the growing
season: before planting, at about planting, and at harvest. Figure 2 indicates the milestone of these strategies. In the
ﬁrst strategy, the decision is made on the ﬁrst of March. The second decision is made on the ﬁrst of May as the second
strategy. Finally, we decide when all weather information is observed as the third strategy after crop harvesting (ﬁrst of
November), which will serve as a benchmark to compare decisions at the ﬁrst and second decision times. Hence, we
have applied the optimization framework to decide on all 25 locations under all scenarios in three strategies.

Figure 2: Overview of timewise strategies for decision.

In this study, the weather is a source of uncertainties. Because the weather is part of the crop model’s input, the unknown
part of the weather data must be predicted before the growing season. Hence, weather scenarios are constructed using
historical weather data to use as an unseen part of weather information. Since we have three strategies, we have to
update each scenario’s weather information by replacing it with observed weather information before decision time.

5

Risk-averse Stochastic Optimization for Farm Management Practices

The ﬁrst strategy is the earliest time for making a decision, and the second one is close to the real, where the decision
on the ﬁrst of November is for comparing decisions under known weather with unknown weather.

We illustrate the effectiveness of our model by optimizing these variables for three test years (2016-2018) per location.
The historical weather information from 1985 to year Y − 1 is applied to generate the weather scenarios to optimize the
variables at test year Y . Table 2 represents a summary of the precipitation amount of ﬁve locations in each selected
county. Comparing the accumulated precipitation and its third percentile reveals that weather in 2018 was a wet year
followed by 2016 and 2017. This insight helps us in investigating how weather affects optimal managerial decisions
and cultivar selection. The proposed optimization framework was implemented in Python 3. We conducted this
study on a workstation with a 3.4 GHz CPU and 16 GB memory. For each setting, we calculated the C-VaRa for
α = 1/|S|, 0.25, 0.5, 0.75, 1 where |S| is the number of weather scenarios.

Table 2: Summary of the precipitation amount (in mm/year) of ﬁve locations in each selected county.

Metric

Mean
Std
Sum
25%
50%
75%
Max

2016
2.4
6.7
4483.4
0.0
0.0
1.0
101.2

Logan
2017
2.2
6.6
4109.0
0.0
0.0
0.6
73.2

2018
3.1
9.1
5819.1
0.0
0.0
1.1
125.4

2016
3.8
9.4
7026.1
0.0
0.0
2.1
89.3

Greene
2017
2.9
7.2
5359.5
0.0
0.0
1.4
56.4

2018
3.8
10.5
6990.6
0.0
0.0
2.2
124.2

2016
2.6
7.59
4800.5
0.0
0.0
0.9
100.7

Boone
2017
2.3
6.3
4210.3
0.0
0.0
0.7
52.9

2018
3.3
8.4
6050.5
0.0
0.0
1.5
100.1

2016
2.3
6.6
4266.8
0.0
0.0
0.9
74.7

Keokuk
2017
2.0
5.9
3698.7
0.0
0.0
0.8
114.7

2018
3.3
9.7
6023.5
0.0
0.0
1.5
125.8

2016
2.5
7.5
4724.5
0.0
0.0
0.7
101.0

Obrien
2017
2.0
5.7
3671.8
0.0
0.0
0.8
68.3

2018
3.1
9.6
5833.0
0.0
0.0
0.9
103.6

5 Results

The results of the proposed framework on optimizing management practices and selecting cultivars for three test years
(2016, 2017, and 2018) are summarized in Table 3. The average estimated yields of ﬁve locations for ﬁve counties at
the end of the growing season using optimal managerial decisions of different strategies reveal that observing more
weather information at the initial stages of the growing season cannot guarantee better decisions. But decisions on the
ﬁrst of May result in better performance than decisions on the ﬁrst of March when the weather is wet (the year 2018).

Our proposed model with the optimized practices was able to increase the estimated yields by 8.4%, 9.7%, and 5.4%
using optimal decisions at the ﬁrst of March at three test years 2016, 2017, and 2018, respectively. Optimal decisions
on May 1 improve the estimated yields by 9 %, 14.7%, and 8.6% at three test years 2016, 2017, and 2018, respectively.
For most counties, our framework can improve the original estimated yield of the crop model except Greene county in
Indiana in 2016 and 2017. It is because of the unique weather proﬁle of selected locations in this county in 2016 and
2017 that are different from their historical weather distribution.

Performances of the proposed framework at the third strategy (model without any uncertainty) indicate improvement in
yield from 2.1% to 18.6%. It also emphasizes that uncertain weather can play signiﬁcant and unavoidable factors in
farmers’ decisions. Moreover, results reveal that risk-averse farmers (farmers with decisions based on the worst weather
scenario) cannot make good decisions at the ﬁrst of March and May at both wet year and non-wet years compared to
risk-tolerance ones. While, risk-tolerance ones (farmers with decisions based on most weather scenarios) are successful
in deciding optimal or close-to-optimal managerial practices and cultivars, especially in non-wet weather 2017.

6

Risk-averse Stochastic Optimization for Farm Management Practices

Table 3: Observed yield in Bu/Acre, original crop model estimated yield in Bu/Acre, and average estimated yields (in
Bu/Acre) of ﬁve locations for each selected county at the end of growing season 2016, 2017, and 2018 under optimal
managerial decisions of different strategies. The optimizer tries to maximize the expected value in the worst 100*α% of
the yield distribution, and in a Stochastic approach, the optimizer maximizes the expected yield of all scenarios. While,
in a robust approach, the optimizer maximizes the yield of a worst-case scenario. The second column from the right
contains the average estimated yields of ﬁve locations in a county under USDA and literature review decisions. The
last column includes observed state-level yield. Percentages show the improvement of average estimated yields of ﬁve
locations at the end of the growing season using optimal decisions compared with the original average estimated yield.

r
a
e
Y

e
t
a
t
S

y
t
n
u
o
C

Illinois

Logan

Indiana

Greene

Iowa

Boone

Keokuk

Obrien

Illinois

Logan

Indiana

Greene

Iowa

Boone

Keokuk

Obrien

Illinois

Logan

Indiana

Greene

Iowa

Boone

Keokuk

Obrien

6
1
0
2

7
1
0
2

8
1
0
2

Strategy 1

Strategy 2

t
s
u
b
o
R

187.9
-0.3%
169.5
-9.8%
217.1
4.9%
217.3
4.6%
257.5
5.9%
237.2
-0.3%
197.2
-7.7%
255.4
2.2%
219.5
-3.3%
243.3
1.8%
214.6
-1.1%
147.5
-23.3%
222.0
2.9%
215.4
4%
239.8
3.5%

5
2
.
0
=
α
200.2
6.2%
178.5
-5%
222.2
7.4%
219.1
5.4%
259.8
6.9%
238.1
0.1%
207.0
-3.1%
267.0
6.8%
222.2
-2.1%
246.4
3%
215.1
-0.9%
199.5
3.8%
223.7
3.6%
211.7
2.2%
240.2
3.7%

5
.
0
=
α
202.4
7.4%
177.7
-5.4%
223.0
7.8%
219.8
5.8%
259.4
6.7%
245.2
3%
210.8
-1.3%
266.4
6.5%
226.0
-0.4%
248.2
3.8%
221.4
2%
198.0
3%
225.9
4.7%
213.1
2.9%
239.7
3.5%

5
7
.
0
=
α
203.1
7.8%
177.7
-5.4%
223.0
7.8%
220.2
6%
259.4
6.7%
245.2
3%
209.6
-1.9%
262.7
5%
228.7
0.8%
255.7
6.9%
221.4
2%
203.1
5.7%
226.5
4.9%
213.1
2.9%
238.5
3%

c
i
t
s
a
h
c
o
t
S
203.4
7.9%
177.0
-5.7%
224.3
8.4%
218.7
5.2%
259.2
6.6%
246.4
3.5%
209.0
-2.2%
265.3
6.1%
230.7
1.6%
262.4
9.7%
221.3
2%
203.1
5.7%
226.5
4.9%
210.8
1.8%
236.5
2.1%

t
s
u
b
o
R

192.9
2.4%
174.0
-7.4%
215.8
4.3%
216.4
4.2%
259.7
6.8%
234.9
-1.3%
202.3
-5.3%
253.4
1.3%
219.9
-3.1%
256.2
7.1%
217.7
0.3%
142.1
-26.1%
223.2
3.4%
213.3
3%
240.7
3.9%

5
2
.
0
=
α
195.0
3.4%
181.1
-3.5%
220.8
6.7%
218.8
5.3%
259.6
6.8%
238.8
0.4%
204.9
-4.1%
262.3
4.9%
222.6
-1.9%
265.8
11.1%
225.4
3.8%
199.4
3.8%
224.8
4.2%
216.2
4.4%
240.3
3.7%

5
.
0
=
α
195.0
3.4%
180.6
-3.8%
223.6
8%
218.9
5.3%
259.2
6.6%
242.3
1.8%
205.3
-3.9%
269.1
7.6%
223.9
-1.4%
269.9
12.9%
226.7
4.4%
202.1
5.2%
225.8
4.6%
216.8
4.7%
241.9
4.4%

5
7
.
0
=
α
190.8
1.2%
178.1
-5.2%
223.3
7.9%
218.5
5.1%
259.8
6.8%
244.2
2.6%
205.3
-3.9%
269.4
7.7%
226.2
-0.3%
270.1
12.9%
227.7
4.9%
208.6
8.6%
226.1
4.7%
216.0
4.3%
241.9
4.4%

c
i
t
s
a
h
c
o
t
S
190.8
1.2%
177.1
-5.7%
225.5
9%
217.9
4.9%
259.7
6.8%
246.4
3.5%
207.5
-2.9%
271.2
8.5%
227.0
0%
274.2
14.7%
227.5
4.8%
208.6
8.6%
225.4
4.4%
214.6
3.6%
240.7
3.9%

3

y
g
e
t
a
r
t
S

214.0
13.6%
199.1
6%
230.6
11.5%
220.0
5.9%
265.1
9%
254.1
6.8%
222.3
4.1%
269.4
7.7%
231.7
2.1%
283.7
18.6%
233.7
7.7%
212.4
10.5%
239.4
10.9%
226.7
9.5%
250.9
8.3%

d
l
e
i
Y

.
t
s
E

d
l
e
i
Y

.
s
b
O

188.5

219.4

187.8

156

206.9

208.4

207.8

208.6

243.1

210.7

237.9

213

213.7

161.1

250.1

192.4

227.0

176.4

239.1

213.8

217.1

236.2

192.2

178.9

215.8

193.7

207.1

203.8

231.7

201.8

Table 4: The percentage of time certain date was optimal N fertilizer date in three strategies. This percentage is
respected to 25 different solutions (ﬁve levels of risk at ﬁve locations in each county). Three values in parentheses from
left to right correspond to the ﬁrst, second, and third strategies, respectively.

State

County

Year

Illinois

Logan

Indiana

Greene

Boone

Iowa

Keokuk

Obrien

2016
2017
2018
2016
2017
2018
2016
2017
2018
2016
2017
2018
2016
2017
2018

1 Apr
(0,40,40)
(40,20,0)
(40,60,0)
-
-
-
-
-
(10,20,0)
-
-
-
-
(20,10,0)
(0,20,20)

8 Apr
(0,60,0)
-
(0,20,0)
-
-
-
(20,0,0)
-
-
-
-
(20,0,0)
(20,0,0)
(0,10,0)
(20,0,0)

15 Apr
(20,0,20)
(20,40,0)
(0,0,40)
-
-
-
-
-
-
-
(10,0,0)
-
-
-
(20,0,20)

22 Apr
-
(0,20,0)
-
-
-
-
-
(10,20,0)
(10,0,0)
-
(10,20,0)
(0,20,0)
(20,0,0)
(20,0,0)
(20,0,20)

29 Apr
(20,0,0)
(20,20,20)
-
-
-
-
(0,20,0)
(20,40,0)
(0,0,20)
-
-
-
(0,20,20)
(20,20,0)
(0,0,20)

N fertilizing date
6 May
(20,0,20)
(20,0,40)
(40,0,0)
-
-
-
(20,20,20)
(30,0,0)
(0,20,20)
-
(40,20,0)
(20,0,0)
(40,40,40)
(40,30,0)
(20,50,0)

13 May
(40,0,20)
-
(0,0,20)
(22.22,40,0)
(0,20,0)
-
(20,20,20)
(10,0,0)
(20,20,0)
-
(10,60,40)
-
(20,0,0)
(0,10,0)
(20,0,20)

20 May
-
-
(20,20,40)
(22.22,40,20)
(10,70,0)
-
(20,0,20)
(30,0,0)
(20,20,40)
-
-
(0,20,0)
(0,40,0)
(0,20,20)
(0,20,0)

27 May
-
(0,0,20)
-
(55.55,20,40)
(70,0,0)
(80,100,100)
(0,20,20)
(0,20,20)
(20,0,20)
(80,100,40)
(0,0,20)
(60,60,100)
(0,0,0,)
-
(0,10,0)

3 Jun
-
(0,0,20)
-
(0,0,40)
(20,10,100)
(20,0,0)
(20,20,20)
(0,20,80)
(20,20,0)
(20,0,60)
(30,0,40)
-
(0,0,40)
(0,0,80)
-

7

Risk-averse Stochastic Optimization for Farm Management Practices

Tables 4-7 indicate the percentage of time certain decision variable’s value was optimal in three strategies. This
percentage is respected to 25 different solutions (ﬁve levels of risk at ﬁve locations in each county). According to Table
4, comparing fertilizing a farm in wet weather (2018) with non-wet weather (2017) reveals that it is better to fertilize in
wet weather sooner than non-wet weather. Fertilizing at the end of May leads to a higher yield in Greene, Indiana, in
wet and non-wet weathers. Optimal cultivars at different levels of risk aversion are shown in Table 5. It seems that
cultivars with higher maturity dates are more favorable for most counties in three states in wet and non-wet weathers.
Moreover, there is a relationship between the maturity date of cultivars and weather. In wet weather (2018), cultivars
with lower maturity dates result in more yield. Table 6 shows that a higher plant density can guarantee a high yield at
the end of the growing season, especially in wet weather. According to Table 7, the proposed model suggests farmers
plant in the middle of April for wet weather, where for non-wet weather, it ﬁnds the ﬁrst two weeks of May as optimal
planting dates.

Table 5: The percentage of time certain cultivar was optimal cultivar in three strategies. This percentage is respected to
25 different solutions (ﬁve levels of risk at ﬁve locations in each county). Three values in parentheses from left to right
correspond to the ﬁrst, second, and third strategies, respectively.

State

County

Year

Illinois

Logan

Indiana

Greene

Boone

Iowa

Keokuk

Obrien

2016
2017
2018
2016
2017
2018
2016
2017
2018
2016
2017
2018
2016
2017
2018

Cultivar

100RM 105RM 110RM
(0,0,20)
(0,0,40)
-
-
-
-
-
-
-
-
-
-
-
-
-
-
(0,0,20)
-
-
-
-
-
-
-
-
-
(20,0,0)
(20,0,0)
-
-

-
(0,20,0)
-
(0,0,40)
-
-
-
-
(0,0,40)
-
-
(0,0,100)
-
-
(0,0,60)

115RM
(100,100,40)
(100,80,100)
(100,100,100)
(100,100,60)
(100,100,100)
(100,100,100)
(100,100,100)
(100,100,100)
(100,100,40)
(100,100,100)
(100,100,100)
(100,100,0)
(100,100,100)
(60,100,100)
(100,100,40)

Table 6: The percentage of time certain plant density was optimal plant density in three strategies. This percentage is
respected to 25 different solutions (ﬁve levels of risk at ﬁve locations in each county). Three values in parentheses from
left to right correspond to the ﬁrst, second, and third strategies, respectively.

State

County

Year

Illinois

Logan

Indiana

Greene

Boone

Iowa

Keokuk

Obrien

2016
2017
2018
2016
2017
2018
2016
2017
2018
2016
2017
2018
2016
2017
2018

2
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-

4
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-

Plant density

6
-
-
-
-
(0,10,0)
-
-
-
-
-
(0,0,40)
-
-
(20,0,0)
-

8
(0,20,0)
(20,0,0)
(0,20,0)
(44.44,60,60)
(30,0,0)
(20,40,0)
-
(10,0,20)
-
(20,0,0)
(40,20,60)
(60,20,20)
-
(20,0,0)
-

10
(100,80,20)
(80,100,0)
(100,80,0)
(55.55,40,40)
(70,90,20)
(80,60,0)
(100,100,0)
(70,100,40)
(60,80,20)
(80,100,40)
(50,60,0)
(20,60,0)
(100,100,0)
(40,90,0)
(80,100,0)

12
(0,0,60)
(0,0,20)
-
-
(0,0,40)
(0,0,40)
(0,0,60)
(20,0,20)
(40,20,40)
(0,0,40)
(10,20,0)
(20,20,60)
-
(0,10,0)
(20,0,0)

14
(0,0,20)
(0,0,80)
(0,0,100)
-
(0,0,40)
(0,0,60)
(0,0,40)
(0,0,20)
(0,0,40)
(0,0,20)
-
(0,0,20)
(0,0,100)
(20,0,100)
(0,0,100)

8

Risk-averse Stochastic Optimization for Farm Management Practices

Table 7: The percentage of time certain date was optimal planting date in three strategies. This percentage is respected
to 25 different solutions (ﬁve levels of risk at ﬁve locations in each county). Three values in parentheses from left to
right correspond to the ﬁrst, second, and third strategies, respectively.

State

County

Year

Illinois

Logan

Indiana

Greene

Boone

Iowa

Keokuk

Obrien

2016
2017
2018
2016
2017
2018
2016
2017
2018
2016
2017
2018
2016
2017
2018

15 Apr
(0,80,60)
(0,20,0)
(0,100,100)
(100,100,40)
(100,90,0)
(80,80,80)
(20,20,80)
(20,0,0)
(0,0,100)
(0,0,20)
-
(0,0,100)
(0,20,20)
(20,20,100)
(0,20,80)

22 Apr
(100,20,40)
(100,80,0)
(100,0,0)
(0,0,60)
(0,10,0)
(20,20,20)
-
(0,0,20)
-
-
-
-
(80,60,0)
(40,60,0)
(80,60,0)

29 Apr
-
-
-
-
-
-
(40,60,20)
(40,80,80)
(60,100,0)
(20,0,0)
(30,0,20)
(40,0,0)
(20,20,80)
(0,20,0)
(20,20,20)

6 May
-
(0,0,60)
-
-
(0,0,60)
-
(40,20,0)
(40,20,0)
(40,0,0)
-
(0,0,20)
(20,0,0)
-
-
-

Planting date
13 May
-
(0,0,40)
-
-
(0,0,40)
-
-
-
-
(60,60,0)
(40,20,20)
(20,60,0)
-
-
-

20 May
-
-
-
-
-
-
-
-
-
(20,40,60)
(30,80,40)
(20,40,0)
-
(20,0,0)
-

27 May
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-

3 Jun
-
-
-
-
-
-
-
-
-
(0,0,20)
-
-
-
-
-

10 Jun
-
-
-
-
-
-
-
-
-
-
-
-
-
(20,0,0)
-

17 Jun
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-

6 Conclusions

This paper introduces a risk-averse stochastic model to optimize farm management practices and select cultivars on
different levels of risk aversion and weather uncertainty. The proposed optimization framework consists of a crop
model as a simulator and a parallel Bayesian optimization algorithm as an optimizer. Our framework can address
farm management optimization issues under uncertainty at the same time. A computational experiment using 25
environments was conducted to illustrate the performance of the proposed framework. Five variables, including planting
date, N fertilizer amount, N fertilizing date, plant density, and cultivars, were optimized to maximize yield at three
time periods (ﬁrst of March, May, and November). The optimization results produced insights about the impact of
weather on yield by revealing that observing more weather information (between March to May) cannot guarantee
better decisions in May than in March. The proposed model can boost the yield performance at the ﬁrst of March and
May compared with the original estimated yields of the crop model. Results indicate that risk-tolerance farmers can
harvest more expected yield than risk-averse farmers. Moreover, by exploring the connection between weather and
optimal decisions, the results reported meaningful agronomic insights between them.

7 Conﬂict of Interest Statement

The authors declare that the research was conducted in the absence of any commercial or ﬁnancial relationships that
could be construed as a potential conﬂict of interest.

Funding

This work was partially supported by the National Science Foundation under the LEAP HI and GOALI programs (grant
number 1830478) and under the EAGER program (grant number 1842097) and by the Plant Sciences Institute at Iowa
State University.

8 Author Contributions

F.A., J.A., L.W, and S.V. designed the research questions. F.A., and J.A. prepared and cleaned the database, performed
the experiment, statistical analysis, and analyzed the data set. F.A. designed and implemented a new algorithm, and
created the ﬁgures. F.A., J.A, L.W., and S.V. interpreted experiment results. F.A. wrote the manuscript. L.W. and S.V.
thoroughly reviewed the manuscript and provided feedback. All authors read and approved the ﬁnal manuscript.

9

Risk-averse Stochastic Optimization for Farm Management Practices

References

[1] Jérôme Dury, Noémie Schaller, Frédérick Garcia, Arnaud Reynaud, and Jacques Eric Bergez. Models to support
cropping plan and crop rotation decisions. a review. Agronomy for Sustainable Development, 32(2):567–580,
2012.

[2] Javad Ansarifar, Faezeh Akhavizadegan, and Lizhi Wang. Performance prediction of crosses in plant breeding

through genotype by environment interactions. Scientiﬁc Reports, 10(1):1–11, 2020.

[3] Javad Ansarifar, Lizhi Wang, and Sotirios V Archontoulis. An interaction regression model for crop yield

prediction. Scientiﬁc reports, 11(1):1–14, 2021.

[4] Javad Ansarifar, Faezeh Akhavizadegan, and Lizhi Wang. Scheduling planting time through developing an
optimization model and analysis of time series growing degree units. arXiv preprint arXiv:2207.00745, 2022.
[5] Javad Ansarifar. Machine Learning and Optimization Algorithms and Their Applications in Agriculture. PhD

thesis, Iowa State University, 2021.

[6] Faezeh Akhavizadegan. Integration of Machine Learning and Optimization for Decision Making Under Uncer-

tainties with Applications in Agriculture and Power System. PhD thesis, Iowa State University, 2021.

[7] Daniel Garcia and Fengqi You. Systems engineering opportunities for agricultural and organic waste management

in the food–water–energy nexus. Current Opinion in Chemical Engineering, 18:23–31, 2017.

[8] Michael P Russelle, Martin H Entz, and Alan J Franzluebbers. Reconsidering integrated crop–livestock systems

in north america. Agronomy Journal, 99(2):325–334, 2007.

[9] RAJNI Jain, L Malangmeih, SS Raju, SK Srivastava, Kingsly Immaneulraj, and AP Kaur. Optimization techniques

for crop planning: A review. OPTIMIZATION, 2018.

[10] Nestor E Caicedo Solano, Guisselle A García Llinás, and Jairo R Montoya-Torres. Towards the integration of lean
principles and optimization for agricultural production systems: a conceptual review proposition. Journal of the
Science of Food and Agriculture, 100(2):453–464, 2020.

[11] P-Y Le Gal, Patrick Dugué, Guy Faure, and Sandra Novak. How does research address the design of innovative
agricultural production systems at the farm level? a review. Agricultural Systems, 104(9):714–728, 2011.
[12] Ajay Singh. An overview of the optimization modelling applications. Journal of Hydrology, 466:167–182, 2012.
[13] Guillaume Martin, Roger Martin-Clouaire, and Michel Duru. Farming system design to feed the changing world.

a review. Agronomy for Sustainable Development, 33(1):131–149, 2013.

[14] David R Kanter, Mark Musumba, Sylvia LR Wood, Cheryl Palm, John Antle, Patricia Balvanera, Virginia H Dale,
Petr Havlik, Keith L Kline, Robert J Scholes, et al. Evaluating agricultural trade-offs in the age of sustainable
development. Agricultural Systems, 163:73–88, 2018.

[15] F Capitanescu, A Marvuglia, T Navarrete Gutiérrez, and E Benetto. Multi-stage farm management optimization

under environmental and crop rotation constraints. Journal of Cleaner Production, 147:197–205, 2017.

[16] Tommy Klein, Annelie Holzkämper, Pierluigi Calanca, Ralf Seppelt, and Jürg Fuhrer. Adapting agricultural
land management to climate change: a regional multi-objective optimization approach. Landscape Ecology,
28(10):2029–2047, 2013.

[17] Annelie Holzkämper, T Klein, Ralf Seppelt, and J Fuhrer. Assessing the propagation of uncertainties in multi-
objective optimization for agro-ecosystem adaptation to climate change. Environmental Modelling & Software,
66:27–35, 2015.

[18] Yingzong Liang, Chi Wai Hui, and Fengqi You. Multi-objective economic-resource-production optimization of
sustainable organic mixed farming systems with nutrient recycling. Journal of Cleaner Production, 196:304–330,
2018.

[19] Alexandre Barbosa, Rodrigo Trevisan, Naira Hovakimyan, and Nicolas F Martin. Modeling yield response to crop
management using convolutional neural networks. Computers and Electronics in Agriculture, 170:105197, 2020.
[20] Jeroen CJ Groot, Gerard JM Oomen, and Walter AH Rossing. Multi-objective optimization and design of farming

systems. Agricultural Systems, 110:63–77, 2012.

[21] John OS Kennedy. Dynamic programming: applications to agriculture and natural resources. Springer Science &

Business Media, 2012.

[22] David J Parsons, LR Benjamin, J Clarke, D Ginsburg, A Mayes, AE Milne, and DJ Wilkinson. Weed manager—a
model-based decision support system for weed management in arable crops. Computers and Electronics in
Agriculture, 65(2):155–167, 2009.

10

Risk-averse Stochastic Optimization for Farm Management Practices

[23] Jitka Janová et al. The dynamic programming approach to long term production planning in agriculture. Acta

Universitatis Agriculturae et Silviculturae Mendelianae Brunensis, 59(2):129–136, 2014.

[24] M Pastori, A Udías, F Bouraoui, and G Bidoglio. A multi-objective approach to evaluate the economic and
environmental impacts of alternative water and nutrient management strategies in Africa. Journal of Environmental
Informatics, 29(1):193–201, 2017.

[25] Anupam Bhar, Ratnesh Kumar, Zhiming Qi, and Robert Malone. Coordinate descent based agricultural model
calibration and optimized input management. Computers and Electronics in Agriculture, 172:105353, 2020.
[26] Thomas J Trout, Walter C Bausch, et al. Usda-ars colorado maize water productivity data set. Irrigation Science,

35(3):241â, 2017.

[27] DK Singh, CS Jaiswal, KS Reddy, RM Singh, and DM Bhandarkar. Optimal cropping pattern in a canal command

area. Agricultural Water Management, 50(1):1–8, 2001.

[28] Ahmed M Alabdulkader, Ahmed I Al-Amoud, and Fawzi S Awad. Optimization of the cropping pattern in saudi

arabia using a mathematical programming sector model. Agricultural Economics, 58(2):56–60, 2012.

[29] Ángel Galán-Martín, Carlos Pozo, Gonzalo Guillén-Gosálbez, Assumpció Antón Vallejo, and Laureano Jiménez
Esteller. Multi-stage linear programming model for optimizing cropping plan decisions under the new common
agricultural policy. Land Use Policy, 48:515–524, 2015.

[30] Lana Mara Rodrigues dos Santos, Philippe Michelon, Marcos Nereu Arenales, and Ricardo Henrique Silva Santos.
Crop rotation scheduling with adjacency constraints. Annals of Operations Research, 190(1):165–180, 2011.
[31] Javad Ansarifar and Lizhi Wang. New algorithms for detecting multi-effect and multi-way epistatic interactions.

Bioinformatics, 35(24):5078–5085, 2019.

[32] S Dogliotti, MK Van Ittersum, and WAH Rossing.

Inﬂuence of farm resource endowment on possibilities
for sustainable development: a case study for vegetable farms in south uruguay. Journal of Environmental
Management, 78(3):305–315, 2006.

[33] Maritza E Cervantes-Gaxiola, Erik F Sosa-Niebla, Oscar M Hernández-Calderón, José M Ponce-Ortega, Jesús R
Ortiz-del Castillo, and Eusiel Rubio-Castro. Optimal crop allocation including market trends and water availability.
European Journal of Operational Research, 2020.

[34] Béla Vizvári and Zoltán Lakner. A stochastic programming based analysis of the ﬁeld use in a farm. Annals of

Operations Research, 219(1):231–242, 2014.

[35] SH Mirkarimi, R Joolaie, F Eshraghi, and F Shirani Bid Abadi. Application of fuzzy goal programming in
cropping pattern management of selected crops in mazandaran province (case study amol township). International
Journal of Agriculture and Crop Sciences, 6(15):1062, 2013.

[36] Dinesh K Sharma. Fuzzy goal programming for agricultural land allocation problems. Yugoslav Journal of

Operations Research, 17(1), 2016.

[37] J Soltani, Ali Reza Karbasi, and SM Fahimifard. Determining optimum cropping pattern using fuzzy goal

programming (fgp) model. African Journal of Agricultural Research, 6(14):3305–3310, 2011.

[38] Xing Liu, Heikki Lehtonen, Tuomo Purola, Yulia Pavlova, Reimund Rötter, and Taru Palosuo. Dynamic economic
modelling of crop rotations with farm management practices under future pest pressure. Agricultural Systems,
144:65–76, 2016.

[39] Ruhul Sarker and Tapabrata Ray. An improved evolutionary algorithm for solving multi-objective crop planning

models. Computers and Electronics in Agriculture, 68(2):191–199, 2009.

[40] Antonio L Márquez, Raúl Baños, Consolación Gil, María G Montoya, Francisco Manzano-Agugliaro, and
Francisco G Montoya. Multi-objective crop planning using pareto-based evolutionary algorithms. Agricultural
Economics, 42(6):649–656, 2011.

[41] Martin Schönhart, Erwin Schmid, and Uwe A Schneider. Croprota–a crop rotation model to support integrated

land use assessments. European Journal of Agronomy, 34(4):263–277, 2011.

[42] Michael E Salassi, Michael A Deliberto, and Kurt M Guidry. Economically optimal crop sequences using
risk-adjusted network ﬂows: Modeling cotton crop rotations in the southeastern United States. Agricultural
Systems, 118:33–40, 2013.

[43] Ajay Singh and Sudhindra Nath Panda. Development and application of an optimization model for the maximiza-

tion of net agricultural return. Agricultural Water Management, 115:267–275, 2012.

[44] Ajay Singh. Optimal allocation of resources for the maximization of net agricultural return. Journal of Irrigation

and Drainage Engineering, 138(9):830–836, 2012.

11

Risk-averse Stochastic Optimization for Farm Management Practices

[45] Sara Osama, Mohamed Elkholy, and Rawya M Kansoh. Optimization of the cropping pattern in egypt. Alexandria

Engineering Journal, 56(4):557–566, 2017.

[46] Deepak Khare, MK Jat, and J Deva Sunder. Assessment of water resources allocation options: conjunctive use

planning in a link canal command. Resources, Cconservation and Recycling, 51(2):487–506, 2007.

[47] Fabio Bartolini, GM Bazzani, V Gallerani, Meri Raggi, and Davide Viaggi. The impact of water and agriculture
policy scenarios on irrigated farming systems in italy: An analysis based on farm level multi-attribute linear
programming models. Agricultural Systems, 93(1-3):90–114, 2007.

[48] Angel Galán-Martín, Pavel Vaskan, Assumpcio Anton, Laureano Jiménez Esteller, and Gonzalo Guillen-Gosalbez.
Multi-objective optimization of rainfed and irrigated agricultural areas considering production and environmental
criteria: a case study of wheat production in spain. Journal of Cleaner Production, 140:816–830, 2017.

[49] Dajun Yue, Min Ah Kim, and Fengqi You. Design of sustainable product systems and supply chains with life
cycle optimization based on functional unit: general modeling framework, mixed-integer nonlinear programming
algorithms and case study on hydrocarbon biofuels. ACS Sustainable Chemistry & Engineering, 1(8):1003–1014,
2013.

[50] R Lalehzari, S Boroomand Nasab, H Moazed, and A Haghighi. Multiobjective management of water allocation to
sustainable irrigation planning and optimal cropping pattern. Journal of Irrigation and Drainage Engineering,
142(1):05015008, 2016.

[51] Seyed Hashem Mousavi-Avval, Shahin Raﬁee, Mohammad Shariﬁ, Soleiman Hosseinpour, Bruno Notarnicola,
Giuseppe Tassielli, and Pietro A Renzulli. Application of multi-objective genetic algorithms for optimization of
energy, economics and environmental life cycle assessment in oilseed production. Journal of Cleaner Production,
140:804–815, 2017.

[52] Silvina M Cabrini and Carlos P Calcaterra. Modeling economic-environmental decision making for agricultural

land use in argentinean pampas. Agricultural Systems, 143:183–194, 2016.

[53] M Karamouz, A Ahmadi, and S Nazif. Development of management schemes in irrigation planning: economic

and crop pattern consideration. Scientia Iranica, 2009.

[54] H Md Azamathulla, Fu Chun Wu, Aminuddin Ab Ghani, Sandeep M Narulkar, Nor Azazi Zakaria, and Chun Kiat
Chang. Comparison between genetic algorithm and linear programming approach for real time operation. Journal
of Hydro-environment Research, 2(3):172–181, 2008.

[55] Aliasghar Montazar, H Riazi, and SM Behbahani. Conjunctive water use planning in an irrigation command area.

Water Resources Management, 24(3):577–596, 2010.

[56] Hongwei Lu, Guohe Huang, and Li He. An inexact rough-interval fuzzy linear programming method for
generating conjunctive water-allocation strategies to agricultural irrigation systems. Applied Mathematical
Modelling, 35(9):4330–4340, 2011.

[57] YP Li, GH Huang, SL Nie, and X Chen. A robust modeling approach for regional water management under

multiple uncertainties. Agricultural Water Management, 98(10):1577–1588, 2011.

[58] Ajay Singh. Simulation–optimization modeling for conjunctive water use management. Agricultural Water

Management, 141:23–29, 2014.

[59] Thana Sarttra, Suchada Manokuakoon, Sunthorn Horadee, and Kittikorn Choosakulwong. Application of dynamic
programming to agricultural land allocation: case study phutthamonthon district, nakhon pathom province,
thailand. In Proceedings of the International MultiConference of Engineers and Computer Scientists, volume 2,
2013.

[60] Ajay Singh. Land and water management planning for increasing farm income in irrigated dry areas. Land Use

Policy, 42:244–250, 2015.

[61] Laxmi Narayan Sethi, Sudhindra N Panda, and Manoj K Nayak. Optimal crop planning and water resources
allocation in a coastal groundwater basin, orissa, india. Agricultural Water Management, 83(3):209–220, 2006.

[62] Dean P Holzworth, Neil I Huth, Peter G deVoil, Eric J Zurcher, Neville I Herrmann, Greg McLean, Karine Chenu,
Erik J van Oosterom, Val Snow, Chris Murphy, et al. Apsim–evolution towards a new generation of agricultural
systems simulation. Environmental Modelling & Software, 62:327–350, 2014.

[63] Nicolas Heslot, Deniz Akdemir, Mark E Sorrells, and Jean-Luc Jannink. Integrating environmental covariates and
crop modeling into the genomic selection framework to predict genotype by environment interactions. Theoretical
and Applied Genetics, 127(2):463–480, 2014.

12

Risk-averse Stochastic Optimization for Farm Management Practices

[64] Bernhard Schauberger, Sotirios Archontoulis, Almut Arneth, Juraj Balkovic, Philippe Ciais, Delphine Deryng,
Joshua Elliott, Christian Folberth, Nikolay Khabarov, Christoph Müller, et al. Consistent negative response of US
crops to high temperatures in observations and crop models. Nature Communications, 8:13931, 2017.

[65] Gang Zhao, Brett A Bryan, and Xiaodong Song. Sensitivity and uncertainty analysis of the APSIM-wheat model:
Interactions between cultivar, environmental, and management parameters. Ecological Modelling, 279:1–11,
2014.

[66] Bruno Basso and Lin Liu. Seasonal crop yield forecast: Methods, applications, and accuracies. Advances in

Agronomy, 154:201–255, 2019.

[67] Abhishes Lamsal, SM Welch, JW Jones, KJ Boote, Antonio Asebedo, Jared Crain, Xu Wang, Will Boyer, Anju
Giri, Elizabeth Frink, et al. Efﬁcient crop model parameter estimation and site characterization using large
breeding trial data sets. Agricultural Systems, 157:170–184, 2017.

[68] Muhuddin Rajin Anwar, De Li Liu, Robert Farquharson, Ian Macadam, Amir Abadi, John Finlayson, Bin Wang,
and Thiagarajah Ramilan. Climate change impacts on phenology and yields of ﬁve broadacre crops at four
climatologically distinct locations in Australia. Agricultural Systems, 132:133–144, 2015.

[69] Faezeh Akhavizadegan, Javad Ansarifar, Lizhi Wang, Isaiah Huber, and Sotirios V Archontoulis. A time-dependent

parameter estimation framework for crop modeling. Scientiﬁc Reports, 11(1):1–15, 2021.

[70] Jonas Mockus. Bayesian approach to global optimization: theory and applications, volume 37. Springer Science

& Business Media, 2012.

[71] R Tyrrell Rockafellar, Stanislav Uryasev, et al. Optimization of conditional value-at-risk. Journal of risk, 2:21–42,

2000.

[72] Ciyou Zhu, Richard H Byrd, Peihuang Lu, and Jorge Nocedal. Algorithm 778: L-BFGS-B: Fortran subroutines
for large-scale bound-constrained optimization. ACM Transactions on Mathematical Software (TOMS), 23(4):550–
560, 1997.

[73] Richard H Byrd, Peihuang Lu, Jorge Nocedal, and Ciyou Zhu. A limited memory algorithm for bound constrained

optimization. SIAM Journal on Scientiﬁc Computing, 16(5):1190–1208, 1995.

[74] Brian A Keating, Peter S Carberry, Graeme L Hammer, Mervyn E Probert, Michael J Robertson, D Holzworth,
Neil I Huth, John NG Hargreaves, Holger Meinke, Zvi Hochman, et al. An overview of APSIM, a model designed
for farming systems simulation. European Journal of Agronomy, 18(3-4):267–288, 2003.

[75] Brian A Keating and Peter J Thorburn. Modelling crops and cropping systems—evolving purpose, practice and

prospects. European Journal of Agronomy, 100:163–176, 2018.

[76] Sotirios V Archontoulis, Michael J Castellano, Mark A Licht, Virginia Nichols, Mitch Baum, Isaiah Huber, Rafael
Martinez-Feria, Laila Puntel, Raziel A Ordóñez, Javed Iqbal, et al. Predicting crop yields and soil-plant nitrogen
dynamics in the US corn belt. Crop Science, 60(2):721–738, 2020.

13

Risk-averse Stochastic Optimization for Farm Management Practices

Appendix

Table 8: Observed yield, original crop model estimated yield, and estimated yields of ﬁve locations at each county at
the end of growing season 2016 under optimal managerial decisions of different levels of risk aversion. The last column
includes observed state-level yield. Percentages show the improvement of estimated yields of ﬁve locations at the end
of the growing season using optimal decisions than the original estimated yield.

Strategy 1

Strategy 2

e
t
a
t
S

n
o
i
t
a
c
o
L

Illinois

Indiana

logan-1

logan-2

logan-3

logan-4

logan-5

greene-1

greene-2

greene-3

greene-4

greene-5

boone-1

boone-2

boone-3

boone-4

boone-5

keokuk-1

keokuk-2

Iowa

keokuk-3

keokuk-4

keokuk-5

obrien-1

obrien-2

obrien-3

obrien-4

obrien-5

t
s
u
b
o
R

213.8
5.6%
177.7
1.1%
173.5
-4.6%
180.5
-2.5%
194
-1.7%
177.3
-6.5%
184
-4.1%
168.9
-9.3%
165.7
-12.2%
151.8
-17.1%
202.8
10.5%
221.7
2.9%
230.1
5.3%
214.5
3.3%
216.8
3.3%
219.2
2.6%
219.2
5.1%
215.6
3.3%
215.5
8.1%
217.4
4%
259.8
4.7%
260.2
6.7%
258.7
6.8%
254.5
4.4%
254.8
7.2%

5
2
.
0
=
α
221
9.2%
177.7
1.1%
190.8
4.8%
199.4
7.7%
212.4
7.6%
176.5
-6.9%
184
-4.1%
176.3
-5.3%
172.3
-8.7%
183.7
0.3%
196.1
6.9%
231.5
7.4%
230.1
5.3%
226.6
9.1%
226.8
8.1%
220.5
3.3%
219.2
5.1%
221.2
5.9%
217.6
9.1%
217.4
4%
261.2
5.3%
264.1
8.3%
259.7
7.2%
259.5
6.5%
254.8
7.2%

5
.
0
=
α
221
9.2%
185.4
5.5%
190.8
4.8%
202.6
9.5%
212.4
7.6%
170.2
-10.2%
186.3
-3%
176.3
-5.3%
172.3
-8.7%
183.7
0.3%
198.7
8.3%
231.5
7.4%
230.1
5.3%
228.2
9.9%
226.8
8.1%
228.5
7%
216.7
4%
221.2
5.9%
215.5
8.1%
217.4
4%
261.2
5.3%
262.1
7.5%
259.7
7.2%
259.5
6.5%
254.8
7.2%

5
7
.
0
=
α
224.5
10.9%
182.3
3.7%
190.8
4.8%
202.6
9.5%
215.5
9.2%
170.2
-10.2%
186.3
-3%
176.3
-5.3%
172.3
-8.7%
183.7
0.3%
198.7
8.3%
231.5
7.4%
230.1
5.3%
228.2
9.9%
226.8
8.1%
228.5
7%
216.7
4%
221.2
5.9%
217.6
9.1%
217.4
4%
261.2
5.3%
262.1
7.5%
260.8
7.7%
258.2
6%
254.8
7.2%

c
i
t
s
a
h
c
o
t
S
224.5
10.9%
182.3
3.7%
192.3
5.7%
202.6
9.5%
215.5
9.2%
170.2
-10.2%
182.9
-4.8%
176.3
-5.3%
172.3
-8.7%
183.7
0.3%
205.3
11.9%
231.5
7.4%
230.1
5.3%
228.2
9.9%
226.8
8.1%
228.5
7%
218.8
5%
219.6
5.2%
209.3
5%
217.4
4%
260.1
4.8%
262.1
7.5%
260.8
7.7%
258.2
6%
254.8
7.2%

5
2
.
0
=
α
221
9.2%
182.5
3.8%
190.3
4.6%
190
2.7%
191.2
-3.1%
179.2
-5.5%
188
-2.1%
177.6
-4.6%
178.6
-5.3%
182.6
-0.3%
196.1
6.9%
228.7
6.1%
227.3
4.1%
225.4
8.5%
226.8
8.1%
220.5
3.2%
218.1
4.6%
221.1
5.9%
217.2
9%
217.4
4%
260.3
4.9%
262.1
7.5%
259.7
7.2%
259.5
6.5%
256.7
8%

5
.
0
=
α
221
9.2%
182.5
3.8%
190.3
4.6%
190
2.7%
191.2
-3.1%
178.8
-5.7%
188
-2.1%
177.6
-4.6%
176.5
-6.4%
182.6
-0.3%
199.5
8.7%
231.5
7.4%
232.1
6.2%
228.2
9.9%
226.8
8.1%
220.5
3.2%
218.1
4.6%
221.2
5.9%
217.6
9.1%
217.4
4%
260.3
4.9%
262.1
7.5%
259.7
7.2%
259.5
6.5%
254.6
7.1%

5
7
.
0
=
α
200.2
-1.1%
182.5
3.8%
190.3
4.6%
190
2.7%
191.2
-3.1%
170.2
-10.2%
188
-2.1%
177.6
-4.6%
172.3
-8.7%
182.6
-0.3%
198.2
8%
231.5
7.4%
232.1
6.2%
228.2
9.9%
226.8
8.1%
220.5
3.2%
218.1
4.6%
218.6
4.7%
218.1
9.4%
217.4
4%
260.8
5.1%
264.1
8.3%
259.7
7.2%
259.5
6.5%
255
7.2%

c
i
t
s
a
h
c
o
t
S
200.2
-1.1%
182.5
3.8%
190.3
4.6%
190
2.7%
191.2
-3.1%
170.2
-10.2%
182.9
-4.8%
177.6
-4.6%
172.3
-8.7%
182.6
-0.3%
209.3
14.1%
231.5
7.4%
232.1
6.2%
228.2
9.9%
226.8
8.1%
220.5
3.2%
215.3
3.3%
218.6
4.7%
218.1
9.4%
217.4
4%
260.8
5.1%
262.8
7.8%
260.7
7.6%
259.5
6.5%
255
7.2%

t
s
u
b
o
R

221
9.2%
167.3
-4.9%
183.6
0.9%
180.5
-2.5%
212.4
7.7%
168.4
-11.1%
184
-4.1%
168.9
-9.3%
184
-2.5%
165
-9.9%
202.9
10.6%
230.2
6.8%
227.3
4.1%
218.1
5%
200.7
-4.4%
218.2
2.2%
218
4.6%
215.6
3.3%
215.9
8.3%
214.7
2.7%
262.4
5.7%
261.6
7.3%
258.7
6.8%
259.3
6.4%
256.7
8%

14

d
l
e
i
Y

.
s
b
O

219.4

156

208.4

208.6

210.7

3

y
g
e
t
a
r
t
S

229.2
13.2%
206.2
17.3%
207.8
14.2%
209.5
13.2%
217.8
10.4%
201
6.1%
199.9
4.1%
196.5
5.6%
202.4
7.3%
195.9
7%
215.3
17.3%
239.1
11%
235.4
7.8%
230.1
10.8%
233.5
11.3%
234.3
9.7%
212.7
2%
218.1
4.5%
217.9
9.3%
217.4
4%
265.9
7.1%
268.1
9.9%
265.2
9.5%
264.8
8.6%
261.9
10.1%

d
l
e
i
Y

.
t
s
E

202.4

175.79

181.98

185.11

197.3

189.51

191.98

186.12

188.66

183.05

183.49

215.47

218.43

207.68

209.86

213.52

208.5

208.78

199.36

208.99

248.18

243.91

242.28

243.73

237.77

Risk-averse Stochastic Optimization for Farm Management Practices

Table 9: Observed yield, original crop model estimated yield, and estimated yields of ﬁve locations at each county at
the end of growing season 2017 under optimal managerial decisions of different levels of risk aversion. The last column
includes observed state-level yield. Percentages show the improvement of estimated yields of ﬁve locations at the end
of the growing season using optimal decisions than the original estimated yield.

d
l
e
i
Y

.
s
b
O

213

161.1

192.4

176.4

213.8

3

y
g
e
t
a
r
t
S

255.5
5.4%
238.1
5.9%
240.7
6.8%
264
7.7%
272.6
8.1%
226.3
5.1%
225.8
1.6%
224
2.2%
241.8
4.1%
194
8%
269
8%
271.2
8.7%
272.2
12.3%
262.2
2.6%
272.7
7.3%
254.2
1.2%
215.4
0.7%
219.8
0.5%
232.2
5%
237
2.9%
271.9
12.7%
302.5
19.8%
290.9
16.9%
292.6
15.8%
260.7
29.9%

d
l
e
i
Y

.
t
s
E

242.3

224.9

225.3

245.2

252.2

215.3

222.2

219.2

232.3

179.5

249

249.6

242.4

255.5

254.1

251.2

213.9

218.8

221.1

230.2

241.3

252.5

248.8

252.6

200.8

Strategy 1

Strategy 2

e
t
a
t
S

n
o
i
t
a
c
o
L

Illinois

Indiana

logan-1

logan-2

logan-3

logan-4

logan-5

greene-1

greene-2

greene-3

greene-4

greene-5

boone-1

boone-2

boone-3

boone-4

boone-5

keokuk-1

keokuk-2

Iowa

keokuk-3

keokuk-4

keokuk-5

obrien-1

obrien-2

obrien-3

obrien-4

obrien-5

t
s
u
b
o
R

230.4
-4.9%
236.2
5%
215.2
-4.5%
239
-2.5%
265.7
5.3%
218.2
1.4%
208.1
-6.3%
208.1
-5.1%
171.9
-26%
179.9
0.2%
268.4
7.8%
235
-5.8%
265.4
9.5%
243.6
-4.6%
265.1
4.3%
238.1
-5.2%
210.7
-1.5%
213.6
-2.4%
211.2
-4.5%
224.1
-2.7%
250.5
3.8%
255.2
1%
264.6
6.3%
274
8.5%
172.7
-14%

5
2
.
0
=
α
247.7
2.2%
208.2
-7.4%
234.2
3.9%
249.7
1.8%
250.8
-0.6%
212.2
-1.4%
208.1
-6.3%
208.7
-4.8%
220.4
-5.1%
186
3.6%
268.3
7.8%
265.2
6.3%
265.4
9.5%
263
2.9%
273.3
7.5%
251.5
0.1%
204.2
-4.6%
213.6
-2.4%
217.8
-1.5%
224.1
-2.7%
253.1
4.9%
255.2
1%
277.3
11.4%
274
8.5%
172.7
-14%

5
.
0
=
α
251
3.6%
229.8
2.2%
235
4.3%
249.7
1.8%
260.6
3.3%
212.2
-1.4%
211.6
-4.8%
214.7
-2%
223.2
-4%
192.6
7.3%
262.9
5.6%
265.2
6.3%
265.4
9.5%
265.3
3.9%
273.3
7.5%
251.5
0.1%
222.1
3.8%
213.6
-2.4%
218.9
-1%
224.1
-2.7%
253.1
4.9%
255.2
1%
286.1
15%
274
8.5%
172.7
-14%

5
7
.
0
=
α
251
3.6%
229.8
2.2%
235
4.3%
249.7
1.8%
260.6
3.3%
212.2
-1.4%
211.6
-4.8%
208.7
-4.8%
223.2
-4%
192.6
7.3%
249.3
0.1%
265.2
6.3%
260.4
7.4%
265.3
3.9%
273.3
7.5%
251.5
0.1%
222.1
3.8%
218.8
0%
218.9
-1%
232.6
1%
253.1
4.9%
279.8
10.8%
286.1
15%
286.9
13.6%
172.7
-14%

c
i
t
s
a
h
c
o
t
S
251
3.6%
229.8
2.2%
235
4.3%
255.7
4.3%
260.6
3.3%
212.2
-1.4%
208.7
-6.1%
208.7
-4.8%
223.2
-4%
192.6
7.3%
252.2
1.3%
270.7
8.5%
265.4
9.5%
265.3
3.9%
273.3
7.5%
251.5
0.1%
222.1
3.8%
228.8
4.5%
218.9
-1%
232.6
1%
267.5
10.9%
298.8
18.3%
286.1
15%
286.9
13.6%
172.7
-14%

5
2
.
0
=
α
247.7
2.2%
211.9
-5.8%
234.2
3.9%
249.7
1.8%
250.8
-0.6%
207.9
-3.4%
208.7
-6.1%
205
-6.5%
217.3
-6.5%
186
3.6%
264.9
6.4%
265.2
6.3%
257.4
6.2%
256.9
0.6%
267.3
5.2%
239.3
-4.7%
209.2
-2.2%
214.9
-1.8%
223.8
1.3%
226.2
-1.7%
251.5
4.2%
281.9
11.7%
269.9
8.5%
284.1
12.5%
241.9
20.5%

5
.
0
=
α
247.7
2.2%
218.7
-2.8%
235
4.3%
249.7
1.8%
260.7
3.3%
209.7
-2.6%
208.7
-6.1%
205
-6.5%
217.3
-6.5%
186
3.6%
264.9
6.4%
271.6
8.8%
272.9
12.6%
263.8
3.3%
272.8
7.4%
239.3
-4.7%
215.4
0.7%
214.9
-1.8%
223.8
1.3%
226.2
-1.7%
264.6
9.7%
281.9
11.7%
277.4
11.5%
284.1
12.5%
241.9
20.5%

5
7
.
0
=
α
251
3.6%
218.7
-2.8%
235
4.3%
255.8
4.3%
260.7
3.3%
209.7
-2.6%
208.7
-6.1%
205
-6.5%
217.3
-6.5%
186
3.6%
264.9
6.4%
271.6
8.8%
272.9
12.6%
265.2
3.8%
272.8
7.4%
246.1
-2%
215.4
0.7%
214.9
-1.8%
228.7
3.4%
226.2
-1.7%
253.1
4.9%
281.9
11.7%
277.4
11.5%
284.1
12.5%
254.2
26.6%

c
i
t
s
a
h
c
o
t
S
251
3.6%
229.6
2.1%
235
4.3%
255.8
4.3%
260.7
3.3%
209.7
-2.6%
208.7
-6.1%
205
-6.5%
217.3
-6.5%
197.2
9.8%
264.9
6.4%
274.1
9.8%
272.9
12.6%
271.7
6.3%
272.8
7.4%
246.1
-2%
215.4
0.7%
218.8
0%
228.7
3.4%
226.2
-1.7%
267.5
10.9%
279.8
10.8%
285.9
14.9%
284.1
12.5%
254.2
26.6%

t
s
u
b
o
R

251
3.6%
208.4
-7.4%
234.2
3.9%
230.6
-5.9%
250.7
-0.6%
202.1
-6.1%
208.1
-6.3%
208.1
-5.1%
207.3
-10.8%
186
3.6%
236.6
-5%
265.2
6.3%
265.4
9.5%
249.6
-2.3%
250.4
-1.5%
239.3
-4.7%
209.2
-2.2%
213.6
-2.4%
211.6
-4.3%
226.2
-1.7%
251
4%
276
9.3%
259.7
4.4%
258.3
2.2%
236.3
17.7%

15

Risk-averse Stochastic Optimization for Farm Management Practices

Table 10: Observed yield, original crop model estimated yield, and estimated yields of ﬁve locations at each county at
the end of growing season 2018 under optimal managerial decisions of different levels of risk aversion. The last column
includes observed state-level yield. Percentages show the improvement of estimated yields of ﬁve locations at the end
of the growing season using optimal decisions than the original estimated yield.

e
t
a
t
S

n
o
i
t
a
c
o
L

Illinois

Indiana

logan-1

logan-2

logan-3

logan-4

logan-5

greene-1

greene-2

greene-3

greene-4

greene-5

boone-1

boone-2

boone-3

boone-4

boone-5

keokuk-1

keokuk-2

Iowa

keokuk-3

keokuk-4

keokuk-5

obrien-1

obrien-2

obrien-3

obrien-4

obrien-5

Strategy 1

Strategy 2

t
s
u
b
o
R

204.3
-3.9%
201.8
-6.3%
208.4
-1.3%
235.1
5.3%
223.8
0.1%
171.5
-15.2%
173.3
-10.1%
143.9
-21.7%
126.9
-38.6%
122
-30.5%
236.4
9.1%
220.9
1.9%
211.6
-0.6%
216.1
-0.2%
225.3
4.1%
224
3.4%
207.4
3.7%
220.3
6.4%
209.4
2.4%
216
4%
240.8
3.4%
243.8
4.3%
242.4
2.3%
241.5
3.6%
231
4%

5
2
.
0
=
α
204.3
-3.9%
201.8
-6.3%
216.4
2.5%
226.3
1.4%
226.9
1.6%
214.5
6.1%
173.3
-10.1%
205.1
11.6%
212.8
2.9%
192
9.4%
230.5
6.4%
220
1.5%
220.8
3.8%
225.5
4.1%
221.9
2.5%
225.6
4.1%
203.6
1.9%
211.8
2.3%
201.8
-1.3%
216
4%
240.2
3.1%
242.5
3.8%
239.6
1.2%
239.4
2.7%
239.8
8%

5
.
0
=
α
220.7
3.9%
211.2
-1.9%
216.4
2.5%
229.4
2.7%
229.6
2.8%
214.5
6.1%
173.3
-10.1%
205.1
11.6%
217.8
5.3%
179.6
2.4%
230.5
6.4%
223.4
3%
220.8
3.8%
226.6
4.7%
228.6
5.6%
224
3.4%
205
2.6%
217.4
5%
203.1
-0.7%
216
4%
240.2
3.1%
242.5
3.8%
239.6
1.2%
239.4
2.7%
237.2
6.8%

5
7
.
0
=
α
220.7
3.9%
211.2
-1.9%
216.4
2.5%
229.4
2.7%
229.6
2.8%
214.5
6.1%
209.9
8.9%
205.1
11.6%
217.8
5.3%
168.3
-4.1%
230.5
6.4%
223.4
3%
223.6
5.1%
226.6
4.7%
228.6
5.6%
224
3.4%
205
2.6%
217.4
5%
203.1
-0.7%
216
4%
240.2
3.1%
241.7
3.4%
239.6
1.2%
234.2
0.5%
237.2
6.8%

c
i
t
s
a
h
c
o
t
S
220.7
3.9%
210.8
-2.1%
216.4
2.5%
229.4
2.7%
229.6
2.8%
214.5
6.1%
209.9
8.9%
205.1
11.6%
217.8
5.3%
168.3
-4.1%
230.5
6.4%
223.4
3%
223.6
5.1%
226.6
4.7%
228.6
5.6%
224.9
3.8%
205
2.6%
209.7
1.3%
203.1
-0.7%
211.2
1.7%
235.6
1.2%
241.7
3.4%
234.3
-1.1%
234.2
0.5%
237
6.7%

t
s
u
b
o
R

209.8
-1.3%
213.3
-0.9%
212.7
0.7%
220.7
-1.2%
232.4
4%
143.5
-29.1%
173.4
-10.1%
140.3
-23.7%
126.9
-38.6%
126.6
-27.9%
236.4
9.1%
220.9
1.9%
217
2%
220.2
1.7%
221.9
2.5%
224.2
3.4%
214.3
7.2%
218.1
5.4%
205.3
0.4%
204.9
-1.4%
242.9
4.3%
243.8
4.3%
240.1
1.4%
245.8
5.5%
231
4%

5
2
.
0
=
α
223.4
5.1%
215.6
0.2%
217.9
3.2%
234.7
5.1%
235.4
5.3%
210.2
4%
173.3
-10.1%
209.1
13.8%
212.8
2.9%
192
9.4%
236.4
9.1%
223.4
3%
217.1
2%
225.5
4.1%
221.9
2.5%
222
2.5%
214.3
7.2%
214.9
3.8%
213.5
4.4%
216.2
4.1%
240.4
3.2%
242.5
3.8%
239.6
1.2%
239.4
2.7%
239.8
8%

5
.
0
=
α
223.4
5.1%
215.6
0.2%
217.9
3.2%
238
6.6%
238.7
6.8%
214.4
6%
173.4
-10.1%
209.1
13.8%
217.8
5.3%
196.2
11.8%
233.6
7.8%
223.4
3%
222.4
4.5%
225.5
4.1%
224.6
3.7%
225.6
4.1%
214.3
7.2%
214.9
3.8%
212.9
4.1%
216.2
4.1%
240.4
3.2%
242.5
3.8%
239.6
1.1%
239.4
2.7%
247.8
11.6%

5
7
.
0
=
α
223.4
5.1%
218.2
1.4%
220.5
4.4%
238
6.6%
238.7
6.8%
214.4
6%
209.9
8.9%
205.1
11.6%
217.8
5.3%
196.2
11.8%
233.6
7.8%
223.4
3%
222.4
4.5%
226.6
4.7%
224.6
3.7%
225.6
4.1%
214.3
7.2%
214.9
3.8%
209.2
2.3%
216.2
4.1%
240.4
3.2%
242.4
3.7%
239.6
1.1%
239.4
2.7%
247.8
11.6%

c
i
t
s
a
h
c
o
t
S
223.4
5.1%
217.3
1%
220.5
4.4%
238
6.6%
238.7
6.8%
214.4
6%
209.9
8.9%
205.1
11.6%
217.8
5.3%
196.2
11.8%
230.5
6.4%
223.4
3%
222.4
4.5%
226.6
4.7%
224.5
3.7%
225.6
4.1%
213.3
6.7%
214.9
3.8%
209.2
2.3%
210.4
1.3%
240.4
3.2%
241.7
3.4%
239.6
1.1%
234.2
0.5%
247.8
11.6%

3

y
g
e
t
a
r
t
S

234.5
10.3%
221.6
3%
226.1
7.1%
242.8
8.7%
243.8
9.1%
217.6
7.6%
214.9
11.4%
209.1
13.8%
222
7.4%
198.7
13.2%
242.1
11.7%
238.1
9.8%
235.2
10.5%
235
8.5%
246.9
14%
238
9.8%
219.4
9.7%
226.5
9.4%
224.8
10%
225.1
8.4%
252.1
8.2%
251.7
7.8%
249
5.1%
249.1
6.9%
253
13.9%

d
l
e
i
Y

.
t
s
E

212.5

215.2

211.2

223.3

223.5

202.2

192.8

183.8

206.8

175.5

216.7

216.8

212.8

216.6

216.5

216.7

199.9

207

204.5

207.7

232.9

233.6

236.9

233.1

222.1

d
l
e
i
Y

.
s
b
O

236.2

178.9

193.7

203.8

201.8

Parallel Bayesian Optimization

This section proposes an extended version of BO [70] to improve the time-dependent parameter calibration structure
in the proposed framework (see Figure ??). We brieﬂy review the classic BO method and the key statistical and
optimization methods on which it relies in the Appendix 1. We use BO because it is one of the most successful
approaches in optimizing calibration problems [?]. BO suffers from some limitations, and thus we modify this
algorithm. First, BO has a high sensitivity to the type of acquisition function as an objective function and the nature of
the gaussian procedure (GP), including kernel types and kernel hyperparameters [?]. Second, BO loses its efﬁciency

16

Risk-averse Stochastic Optimization for Farm Management Practices

in exploration and exploitation as the input dimensions increase. Third, the acquisition function is often difﬁcult to
optimize, and its performance depends on an optimizer to search the surface.

We develop a new parallel optimization scheme for the optimization part of the time-dependent parameter calibration
framework, which addresses the BO method’s drawbacks. In this approach, instead of allocating all searching budget
(the number of iteration) to one BO model, we divide the searching budget into several BO algorithms to search a
solution space in parallel. To address BO’s sensitivity to the type of acquisition functions, each parallel BO has a speciﬁc
type of acquisition function. Besides, each BO applies a particular kernel type and hyper-parameters for constructing
the GP distribution. When BO models determine the next sample point by maximizing its equations function, they
share their ﬁndings to help each other to acquire more knowledge about the solution space. The structural differences
between BO and PBO are illustrated in Figure ??. The PBO algorithm is deﬁned in Algorithm 2.

Algorithm 2 Parallel Bayesian optimization
1: Input: Data set D = {(x0, y0)}, N as number BO models are run in parallel and T as maximum iteration, Is as

scenario s ∈ S, where S denotes set of scenarios.

2: Output: A local optimal solution x∗ ∈ R1×p.
3: Step 0: Set Kn, σ, and un as type of kernel, set of kernel parameters, and acquisition function of nth BO for all

n ∈ {1, ..., N }. Set incumbent solution x∗ = x0.

for n = 1 to N do

4: for t = 1 to T do
5:
6:
7:
8:

9:

Step 1: Use GP to update the posterior probability ˆfn and construct acquisition function un.
t by optimizing the acquisition function un over function f : xn
Step 2: Find xn
Step 3: For each scenario Is, call crop model by modifying its ﬁle according to each scenario to evalaue the
performance of solution xn
Step 4: Calculate the objective function of solution xn
t
(cid:80)
t = mins∈S{f (xn
t , Is)/|S| and for robust optimization as yn

for stochastic optimization as yn
t = maxs∈S{f (xn

t for scenario s as f (xn

t = arg maxx un(x|D).

t , Is)} or yn

t =
t , Is)}.

t , Is).

s∈S f (xn

Step 5: Augment the data D = {D, (xn

t , yn

t )} and update incumbent solution x∗ = xarg max(y).

10:
11:
12: end for

end for

We provide an additional explanation about the algorithm as follows.

• Hyperparameters: Parameter N should reﬂect the number of parallel BO models such that any increase in
N will greatly expand the searching power to search through more enumeration. The maximum number of
iterations T indicates the stop criteria of the algorithm. The maximum number of iterations can be replaced
with a threshold so that we terminate the algorithm if the difference between the current value of the best new
points and the incumbent solution is less than a predeﬁned threshold.

• Step 0: In this step, we set one type of acquisition function, kernel, and kernel parameters for constructing the

GP of each BO model.

• Step 1: GP updates the posterior probability, and constructs acquisition function in this step.
• Step 2: We use the limited-memory quasi-Newton algorithm for bound-constrained optimization L-BFGS-B
[72, 73] in Python to optimize the acquisition function with a set of random starting points. We run L-BFGS-B
several times with different arbitrary starting points to improve the efﬁciency and overcome the difﬁculty of
optimizing the acquisition function. We select the next sample point as the best optimal solution between all
found solutions of L-BFGS-B algorithm with different starting points.

• Step 3: The APSIM is run to evaluate a new parameter combination from each BO model in this step. Then,
the BO models share their ﬁndings to expand their knowledge about posterior distribution such that the BO
model applies GP in the next iteration to update its posterior distribution and construct the acquisition function.
• Step 4: The incumbent solution is updated as the best combinations of parameters evaluated by APSIM in this

step.

17

