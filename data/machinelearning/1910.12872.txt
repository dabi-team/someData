Draft version October 30, 2019
Typeset using LATEX twocolumn style in AASTeX62

Automated Mining of the ALMA Archive in the COSMOS Field (A3COSMOS): I. Robust ALMA Continuum
Photometry Catalogs and Stellar Mass and Star Formation Properties for ∼700 Galaxies at z = 0.5–6

Daizhong Liu,1 P. Lang,1 B. Magnelli,2 E. Schinnerer,1 S. Leslie,1 Y. Fudamoto,3 M. Bondi,4 B. Groves,5
E. Jiménez-Andrade,2 K. Harrington,2 A. Karim,2 P. A. Oesch,3 M. Sargent,6 E. Vardoulaki,2 T. Bˇadescu,2
L. Moser,2 F. Bertoldi,2 A. Battisti,5 E. da Cunha,5 J. Zavala,7 M. Vaccari,8, 4 I. Davidzon,9 D. Riechers,10 and
M. Aravena11

1Max-Planck-Institut für Astronomie, Königstuhl 17, D-69117 Heidelberg, Germany
2Argelander-Institut für Astronomie, Universität Bonn, Auf dem Hügel 71, D-53121 Bonn, Germany
3Department of Astronomy, Université de Genève, Chemin des Maillettes 51, 1290 Versoix, Switzerland
4INAF–Istituto di Radioastronomia, Via Gobetti 101, I-40129, Bologna, Italy
5Research School of Astronomy and Astrophysics, Australian National University, Canberra ACT, 2611, Australia
6Astronomy Centre, Department of Physics and Astronomy, University of Sussex, Brighton BN1 9QH, UK
7The University of Texas at Austin, 2515 Speedway Boulevard, Stop C1400, Austin, TX 78712, USA
8Department of Physics and Astronomy, University of the Western Cape, Robert Sobukwe Road, 7535 Bellville, Cape Town, South Africa
9IPAC, Mail Code 314-6, California Institute of Technology, 1200 East California Boulevard, Pasadena, CA 91125, USA
10Department of Astronomy, Cornell University, Space Sciences Building, Ithaca, NY 14853, USA
11Núcleo de Astronomía, Facultad de Ingeniería, Universidad Diego Portales, Av. Ejército 441, Santiago, Chile

ABSTRACT

The rich information on (sub-)millimeter dust continuum emission from distant galaxies in the public
Atacama Large Millimeter/submillimeter Array (ALMA) archive is contained in thousands of inho-
mogeneous observations from individual PI-led programs. To increase the usability of these data
for studies deepening our understanding of galaxy evolution, we have developed automated mining
pipelines for the ALMA archive in the COSMOS ﬁeld (A3COSMOS) which eﬃciently exploit the
available information for large numbers of galaxies across cosmic time, and keep the data products in
sync with the increasing public ALMA archive: (a) a dedicated ALMA continuum imaging pipeline;
(b) two complementary photometry pipelines for both blind source extraction and prior source ﬁtting;
(c) a counterpart association pipeline utilizing the multi-wavelength data available (including qual-
ity assessment based on machine-learning techniques); (d) an assessment of potential (sub-)mm line
contribution to the measured ALMA continuum; and (e) extensive simulations to provide statistical
corrections to biases and uncertainties in the ALMA continuum measurements. Application of these
tools yields photometry catalogs with ∼ 1000 (sub-)mm detections (spurious fraction ∼ 8 − 12%) from
over 1500 individual ALMA continuum images. Combined with ancillary photometric and redshift
catalogs and the above quality assessments, we provide robust information on redshift, stellar mass
and star formation rate for ∼700 galaxies at redshifts 0.5-6 in the COSMOS ﬁeld (with undetermined
selection function). The ALMA photometric measurements and galaxy properties are released pub-
licly within our blind-extraction, prior-ﬁtting and galaxy property catalogs, plus the images. These
products will be updated on a regular basis in the future.

Keywords: galaxies: photometry — galaxies: star formation — galaxies: evolution — galaxies: ISM

— submillimeter: galaxies — techniques: photometric

1. INTRODUCTION
The interstellar medium (ISM) is the raw material in
galaxies out of which stars form. It plays a fundamental
role when reconstructing the Universe through cosmo-

dzliu@mpia.de

logical simulations. In galaxies harboring intensive star
formation, cold neutral gas is the main component of
the ISM dominating its mass; and a signiﬁcant fraction
of this cold gas is in the molecular phase (e.g., Walter
et al. 2008; Leroy et al. 2008; Bigiel et al. 2008). Over
the past four decades, molecular gas has been observed
mainly via the Carbon Monoxide (CO) rotational transi-

9
1
0
2

t
c
O
8
2

]

A
G
.
h
p
-
o
r
t
s
a
[

1
v
2
7
8
2
1
.
0
1
9
1
:
v
i
X
r
a

 
 
 
 
 
 
2

D. Liu et al.

tion lines in the rest-frame millimeter (mm) wavelengths
(which are the most feasible observable tracers of molec-
ular gas; e.g., see review by Solomon & Vanden Bout
2005; Carilli & Walter 2013). However, CO observations
at high redshift (z > 1) mostly target the brightest sub-
millimeter galaxies (SMGs; e.g., review by Blain et al.
2002) and quasi-stellar objects (QSOs). These objects
are the most extreme cases and not representative of the
more numerous, less starbursty galaxies, i.e., the star-
forming galaxies that follow a tight main sequence (MS)
in the stellar mass–SFR plane (e.g. Brinchmann et al.
2004; Noeske et al. 2007; Elbaz et al. 2007; Daddi et al.
2007). Observing CO in a large number (e.g., a few hun-
dred) of main-sequence galaxies at z > 1 (hence probing
the ISM evolution) is in practise very time-consuming
even with the most advanced facility, the Atacama Large
Millimeter/submillimeter Array (ALMA), as ﬁrstly all
galaxies are required to have a spectroscopic redshift
in advance, secondly suﬃcient sensitivity is needed to
detect the line within a small spectral bandwidth (typi-
cally ∼ 300 − 500 km/s), and thirdly the galaxy sample
should cover enough parameter space in the main se-
quence plane.

In recent years, a much more eﬃcient approach —
carrying out broadband dust continuum observations to
infer the ISM — has been established. With the use of
all the bandwidth of the receiver, usually much short
integration time are needed for high-redshift galaxies
than observing (sub)mm emission lines (see also Car-
penter et al. 2019). Then, the cold gas mass can be
inferred either using the gas-to-dust mass ratio, δGDR,
which has been reasonably characterized as a function
of gas phase metallicity (e.g., Santini et al. 2010; Leroy
et al. 2011; Magdis et al. 2011, 2012; Magnelli et al. 2012;
Bolatto et al. 2013; Rémy-Ruyer et al. 2014; Tan et al.
2014; Coogan et al. 2019), or with the ratio between gas
mass and dust continuum luminosity at Rayleigh-Jeans
tail wavelengths (e.g., rest-frame 250–850 µm), which
has been calibrated with rich observations (e.g., Scov-
ille et al. 2014; Groves et al. 2015; Hughes et al. 2017;
Bertemes et al. 2018; Saintonge et al. 2018). The use of
dust continuum observations to systematically survey
the ISM content in hundreds of high-redshift galaxies
is already proved to be fruitful (e.g., Schinnerer et al.
2016; Scoville et al. 2016, 2017).

Meanwhile, the continuously growing ALMA public
archive oﬀers a great opportunity of studying very large
samples of high-redshift galaxies. The ALMA public
archive consists of thousands of observations of high-
redshift galaxies within deep ﬁelds led by individual
Principle Investigator (PI) programs. Although ALMA
has a small ﬁeld of view, e.g., ∼0.50 in diameter (primary

beam FWHM) in Band 6, accumulating archival data
compensates for this shortcoming and leads to several
hundred arcmin2 area. Comparing to contiguous deep
ﬁeld surveys with ALMA (e.g., Hatsukade et al. 2011,
2016, 2018; Carniani et al. 2015; Walter et al. 2016; Ar-
avena et al. 2016; Dunlop et al. 2017; Umehata et al.
2017, 2018; Franco et al. 2018), the discreteness of ﬁeld
of views makes the sample selection bias and cosmic co-
moving volume very unpredictable, but it also leads to
a sample with large varieties in galaxy properties, which
thus provides crucial constraints on galaxy ISM and star
formation scaling relations and analytic evolution pre-
scriptions (e.g., Scoville et al. 2017; Tacconi et al. 2018).
Moreover, the ALMA archive also serves as a powerful
test bed for automated pipelines as in this work and for
future large facilities.

Several recent studies have already been exploring the
full ALMA archive (e.g. Scoville et al. 2017; Fujimoto
et al. 2017; Zavala et al. 2018), however, the photomet-
ric methods (including aperture photometry, peak pixel
analysis, uv-plane ﬁtting, etc.) and sample selection can
signiﬁcantly diﬀer between diﬀerent authors. Further-
more, none of these studies have statistically evaluated
the eﬀects of applying diﬀerent photometric methods to
ALMA images, especially for large numbers of ALMA
images with widely varying sensitivity and synthesized
beam properties. Consequently, noticeable discrepan-
cies on the cosmic evolution of the ISM are present
among the aforementioned studies. In order to under-
stand how potential biases of the photometric methods
and gas mass calibration aﬀect the outcome of ISM evo-
lution studies, more dedicated eﬀorts are required to
exploit the public ALMA archive.

In this work, we present automated pipelines for
“mining” the public ALMA archive in the COSMOS
ﬁeld (Scoville et al. 2007) (hereafter referred to as
the “A3COSMOS” (Automated mining of the ALMA
Archive in COSMOS) project 1. This work provides the
foundation for a systematic exploitation of the (sub-)mm
continuum as a proxy for cold dust and gas for a diverse
and large sample of high-redshift galaxies. The resulting
catalog of galaxies with (sub-)mm continuum detections
can be used to, e.g., study the cosmic evolution of the
gas fraction and gas depletion time (Paper II; D. Liu et
al. 2019, submitted to ApJ.).

We present our workﬂow from the raw public ALMA
data to the two robust photometric catalogs in Fig. 1,
which corresponds to Sects. 2 to 3 of the paper. We
ﬁrst describe our ALMA data reduction and continuum

1 https://sites.google.com/view/a3cosmos

A3COSMOS photometry & catalogs

3

imaging procedures in Sect. 2.1, and then we present the
blind source extraction in Sect. 2.2, prior catalog com-
pilation in Sect. 2.3, and prior source ﬁtting in Sect. 2.4.
Sect. 3 includes our extensive Monte Carlo (MC) simu-
lations and analyses to verify our photometry. Sect. 4
describes how we combine the two photometry cata-
logs, remove spurious sources, and build a ﬁnal well-
characterized galaxy catalog (a workﬂow for these sub-
steps is presented at the beginning of Sect. 4). Finally,
the resulting catalogs are described in Sect. 5, and we
summarize the paper in Sect. 6.

Throughout the paper, we adopt a ﬂat ΛCDM cosmol-
ogy with H0 = 70 km s−1 Mpc−1, ΩM = 0.3, Ω0 = 0.7,
and a Chabrier (2003) initial mass function (IMF).

2. DATA AND PHOTOMETRY
The public ALMA archive is growing rapidly through
PI-led observations. These observations mainly focus on
targeted scientiﬁc objectives (sources), which are usually
at the phase center of each ALMA pointing. However,
with ALMA’s unprecedented sensitivity, and beneﬁt-
ing from the negative-K correction at mm wavelengths
(e.g., review by Blain et al. 2002; Casey et al. 2014),
further (sub-)mm galaxies can serendipitously appear
in any ALMA pointing. Such sources have a sizable
chance for detection when their position falls within
about twice the primary beam area 2 of the correspond-
ing ALMA pointing (i.e., with a primary beam attenu-
ation [PBA] ≥ 0.2).

Here, we conduct a systematic eﬀort to exploit
these observational data. We limit our selection to
within the COSMOS ﬁeld (R.A. = 10:00:28.6, decl. =
+02:12:21.0, J2000; Scoville et al. 2007) because it is
one of the deep ﬁelds with the richest, deepest multi-
wavelength datasets, and there are numerous PI-led
ALMA observations within its large area of 2 deg2 (com-
pared to the Great Observatories Origins Deep Survey
[GOODS] North and South ﬁelds with only 160 arcmin2
[0.044 deg2] each). We include all the available ALMA
data in COSMOS regardless of the ALMA bands used
(but excluded very long baseline data with a synthe-
sized beam < 0.100; see Sect. 2.1; and the only one
mosaic project on the AzTEC-3 protocluster).

COSMOS has extensive imaging datasets covering all
accessible wavelength ranges: X-ray (Elvis et al. 2009;
Civano et al. 2012, 2016; Marchesi et al. 2016), UV
(Zamojski et al. 2007), optical (Leauthaud et al. 2007;
Capak et al. 2007; Taniguchi et al. 2007, 2015), near-IR

(McCracken et al. 2010, 2012), mid-IR (Sanders et al.
2007, Le Floc’h et al. 2009), far-IR (Lutz et al. 2011;
Oliver et al. 2012), sub-mm (Geach et al. 2017), mm
(Bertoldi et al. 2007; Aretxaga et al. 2011) and radio
(Schinnerer et al. 2010; Smolčić et al. 2017). The depths
of the X-ray, UV, optical and near-IR datasets are listed
in Laigle et al. (2016), and the depths of mid-to-far-
IR, (sub-)mm and radio datasets are summarized in Jin
et al. (2018).

Photometric redshifts have been obtained for ∼ 1.1 ×
106 galaxies through optical to near-IR spectral energy
distribution (SED) ﬁtting by Muzzin et al. (2013), Il-
bert et al. (2013), Laigle et al. (2016), Davidzon et al.
(2017) and Delvecchio et al. (2017), and through optical
to mm/radio SED ﬁtting by Jin et al. (2018).

(version Sept.

Spectroscopic redshifts also exist for ∼ 7.1 × 104
galaxies, from the latest compilation by M. Salvato et
1st, 2017; available internally in
al.
the COSMOS collaboration), which includes almost all
spectroscopic observations in the COSMOS ﬁeld: Lilly
et al. (2007, 2009; zCOSMOS Survey; with VLT/VI-
MOS); Fu et al. (2010; with Spitzer/IRS); Casey et al.
(2012, 2017; with Keck II/DEIMOS); Comparat et al.
(2015; with VLT/FORS2); Le Fèvre et al. (2015) and
Tasca et al. (2017) (VUDS Survey; with VLT/VMOS);
Hasinger et al. (2018; with Keck II/DEIMOS); Kriek
et al. (2015; MOSDEF Survey; with Keck I/MOSFIRE);
Marsan et al. (2017; with Keck II/NIRSPEC); Masters
et al. (2017; with Keck II/DEIMOS); Nanayakkara et al.
(2016; with Keck I/MOSFIRE); Silverman et al. (2015a;
FMOS-COSMOS Survey; with Subaru/FMOS); van der
Wel et al. (2016; LEGA-C Survey; with VLT/VMOS);
Yun et al. (2015; with LMT/RSR) (listed only references
whose spectroscopic redshifts are used in this work).

We show the pointings of all public ALMA data for the
COSMOS ﬁeld as of Jan. 2nd, 2018 in Fig. 2, overlaid
on the Herschel Space Observatory (Pilbratt et al. 2010)
Photodetector Array Camera and Spectrometer (PACS;
Poglitsch et al. 2010) 100µm image. All the pointings
processed for catalogs presented here are shown in green,
and data that will be processed in our next release are
shown in magenta, which includes ALMA data becom-
ing public before August 1st, 2018. Circle size repre-
sents the primary beam 3. The sum of primary beam
area of these observations reaches 164 arcmin2 as of Jan.
2nd, 2018, and will reach 280 arcmin2 in our next re-
lease. Some pointings overlap because they are observed
at diﬀerent frequencies or with diﬀerent spatial reso-

2 Here the primary beam area means the area enclosed in a

circle with a radius equaling the primary beam’s FWHM.

3 Primary beam FWHMs are

computed according to

https://www.iram.fr/IRAMFR/ARC/documents/cycle3/
alma-technical-handbook.pdf, Eq. (3.4).

4

D. Liu et al.

A3COSMOS

ALMA Continuum
Images (Sect. 2.1)

Multi-wavelength
Catalogs (Sect. 2.3)

Monte Carlo
Simulations
(Sect. 3)

Meta data

Blind source
extraction
(PyBDSF;
Sect. 2.2)

Prior source
ﬁtting (get-
pix+galﬁt;
Sect. 2.4)

combine

COSMOS
master
catalog
(Sect. 2.3)

Physically-
motivated
MC
simulation

Full
parameter-
space MC
simulation

Simulated
images

Simulated
images

Prior
extrac-
tion

Blind
extrac-
tion

Prior
extrac-
tion

Blind
extrac-
tion

sim.
stat.

sim.
stat.

sim.
stat.

sim.
stat.

Blind
extraction
catalog

Prior
extraction
catalog

apply
sim.
corr.

apply
sim.
corr.

Final blind
extraction
catalog

Final prior
extraction
catalog

Source selection,
SED ﬁtting, and
galaxy catalogs
(Sects. 4–5)

simulation-based
correction tables
(Sect. 3.1.5)

Fig. 1. Workﬂow of our automated mining of the ALMA archive in the COSMOS ﬁeld (A3COSMOS), which corresponds to
Sects. 2 to 3 of this paper. (Left branch:) Starting from Sect. 2.1, we create ALMA continuum images from raw ALMA
data which are obtained from the full public ALMA archive data for COSMOS. Next two photometric pipelines are used: (a)
blind source extraction (see Sect. 2.2) and (b) prior source ﬁtting (see Sect. 2.4) utilizing the COSMOS master catalog compiled
beforehand as described in Sect. 2.3 (middle branch). (Right branch:) Two Monte Carlo simulation pipelines with largely
diﬀerent prior assumptions are employed to verify the two photometric methods, and to provide ﬂux bias correction and ﬂux
error estimation for the two photometric catalogs (see Sect. 3, and Appx. C for details). After veriﬁcation, the two photometric
catalogs are combined to build a galaxy catalog with physical properties as described in Sect. 4.

lution. The overlapped area of all pointings is about
12%. Thus, even considering the non-overlapped pri-
mary beam area, the current data already reach a spa-
tial coverage similar to the area of the GOODS ﬁelds,
and are much larger than any existing contiguous ALMA
deep ﬁeld survey (e.g., Dunlop et al. 2017, 4.5 arcmin2
with 1σ ∼35 µJy/beam; Franco et al. 2018, 69 arcmin2
with 1σ ∼0.18 mJy/beam).

In Fig. 3, we compare the depth and areal coverage of
the ALMA archival data in COSMOS at ALMA Band 6
and 7 to the selected existing contiguous ALMA contin-
uum deep ﬁelds: Aravena et al. (2016; see also Walter
et al. 2016); Dunlop et al. (2017); and Franco et al.

(2018; PI: D. Elbaz). Other ALMA deep ﬁelds (e.g.,
Hatsukade et al. 2016; Umehata et al. 2017) have simi-
lar properties and are therefore not shown. We compute
the depth of each ALMA image by converting its rms
noise to an equivalent ﬂux at observed-frame 1.1 mm as-
suming a modiﬁed blackbody with β = 1.8. The green
(orange) curve represents the cumulative area of version
20180102 (version 20180801) ALMA images reaching a
given sensitivity. Given that the ALMA archival data in
the COSMOS ﬁeld alone cover a larger cumulative area
at all sensitivities, a systematic mining of the ALMA
archive is strongly motivated. Given the inhomogeneous
science goals of the individual PI-led projects, the result-

A3COSMOS photometry & catalogs

5

Fig. 2. ALMA pointings in the COSMOS ﬁeld that are publicly accessible. Green and magenta circles represent ALMA
pointings that became public before Jan. 2nd, 2018 and Aug. 1st, 2018 respectively. Circle sizes represent the FWHM of the
ALMA 12m antennas’ primary beam, and the shading reﬂects the on-source integration time (dark referring to longer integration
times). The background image is the Herschel PACS 100 µm data from the PACS Evolutionary Probe survey (PEP; Lutz et al.
2011).

ing catalogs will not have a well-characterized selection
function and are not complete per se (see Sect. 4.7 for
a discussion of the properties and completeness of the
ﬁnal galaxy catalog).

In the following sections, we describe the reduction
and processing of ALMA raw data into image prod-
ucts (in Sect. 2.1) and the photometric methods used
(in Sects. 2.2 to 2.4). We employ two complementary
photometric methods, blind source extraction and prior
source ﬁtting, to obtain source ﬂux densities and sizes
from the ALMA continuum images. A comparison of

the two methods and further technical assessments are
presented in Sects. 2.5 to 2.7.

2.1. ALMA Continuum Images
We start by querying the ALMA archive with the
Python package astroquery Ginsburg et al. 2019, re-
trieving all projects publicly available within a search
radius of 2 degrees centered on the COSMOS ﬁeld.
These datasets are calibrated with the Common As-
tronomy Software Applications (CASA; McMullin et al.
2007) using the scriptForPI.py scripts provided by the
Joint ALMA Observatory together with the archived
raw data.

9h58m00.0s10h00m00.0s10h02m00.0s1°40'00"2°00'00"2°20'00"2°40'00"3°00'00"RADec6

D. Liu et al.

Given this approach, combined with the sparseness of
high S/N > 15 sub-mm sources in our catalog, we do
not expect any overcleaning resulting in artiﬁcially low
rms noise. Given the large number of antennas in the
12m array, the instantaneous dirty beam for a short in-
tegration (∼30 seconds) as used for many programs has
very low sidelobes, the presence of imaging artifacts is
also minimized. The robustness of our cleaning process
is also supported by our comparison of image-plane to
uv-plane photometry (Sect. 2.6).

The CASA imaging pipeline unfortunately could not
be run for a few of our projects (mostly from Cycle 0)
owing to backward compatibility issues. These projects
are thus imaged with the CASA task clean with input
parameters manually set using a similar imaging and
“cleaning” strategy to the CASA imaging pipeline, e.g.,
“Briggs” weighting with robust=2, sampling of the syn-
thesized beam by ∼5 pixels and masking based on the
noise of the dirty image.

As a test, we measure the 1 σ sensitivities (rms noise)
of our images (σA3 ) and compare with those measured
in the continuum images available in the ALMA archive
which are produced during the phase 2 of the ALMA
Quality Assessment (QA2; σQA2). Approximately 60%
of our images have QA2-based continuum images, while
the remaining ∼ 40% were not imaged during the QA2
mostly because they are part of the scheduling blocks
(SBs) with multiple targets, and the quality assessment
was performed by imaging only a few of them. Con-
sequently, for most projects, at least one QA2-based
continuum image is available to perform our test. The
(σA3 − σQA2)/σA3 follows a Gaussian distribution cen-
tered at ∼ −0.1 with a dispersion of ∼ 0.17 (Fig. 4).
Our images have ∼10% better sensitivities than those
from the ALMA archive because they are produced with
robust=2 – i.e., favoring sensitivity over spatial reso-
lution – while most QA2 analyses are performed with
robust=0.5. We ﬁnd no outliers with large positive
values (e.g., (σA3 − σQA2)/σA3 > 0.6), as images with
obvious artifacts were spotted by our visual inspection
and already re-imaged. Finally, we ﬁnd few outliers with
(σA3COSMOS − σQA2)/σQA2 < −0.6. We systematically
checked these images and found that all of them corre-
spond to projects in which the QA2-based analysis was
performed with low robust values (i.e., < 0) and/or
using only a fraction of the SpWs available. All these
comparisons demonstrate the reliability of the ALMA
imaging pipeline and thus of our image products.

The data products released here include all “clean”
continuum images corrected and uncorrected for pri-

Fig. 3. Accumulated areal coverage of the public ALMA
archival pointings at ALMA Band 6 and 7 used in this work
as a function of the eﬀective 1.1 mm 1-σ sensitivity (i.e., rms
of pixel noise converted to the 1-σ sensitivity at 1.1 mm as-
suming a modiﬁed blackbody with β = 1.8; pixel size varies
and is about 0.2× the beam size of each ALMA cleaned im-
age). The orange line represents our next data release (cor-
responding to the magenta circles in Fig. 2). The area and
sensitivity of three representative contiguous ALMA deep
ﬁeld surveys from Aravena et al. (2016; see also Walter et al.
2016), Dunlop et al. (2017) and Franco et al. (2018) are
shown as black symbols for comparison, as well as the 1-σ rms
of super-deblended SCUBA2 photometry in the GOODS-
North deep ﬁeld from Liu et al. (2018) (gray diamond).

Calibrated visibilities are imaged and “cleaned” — i.e.,
deconvolved with the “dirty” beam — with the CASA
imaging pipeline version 4.7.2. With this systematic
approach, we aim at obtaining data products as ho-
mogeneous as possible and also with maximized sen-
sitivities. The pipeline is operated in “continuum” +
“automatic” mode, leaving all but the weight param-
eters (set to “Briggs” with robust=2) to their default
values. In this mode, the spectral windows (SpWs) of
each target are aggregated into a single continuum image
calculated at the central frequencies of these SpWs us-
ing the multi-frequency synthesis (MFS) algorithm with
nterms=2. The parameters controlling the deconvolu-
tion process (i.e., masked pixels, maximum number of it-
erations and stopping threshold) are automatically and
homogeneously set by the pipeline based on the noise
properties and dynamic range of the “dirty” images (i.e.,
before deconvolution). The output images sample the
synthesized beam with 5 pixels and are masked where
In case of obvious image artifacts
the PBA is < 0.2.
in the cleaned images (as found by visual inspection,
< 10%), we rerun the CASA imaging pipeline ﬂagging
corrupted baselines and/or adopting robust=0.5.

The imaging pipeline uses masks to identify regions
of bright emission prior to cleaning and the stopping
criterion is set to a signal-to-noise ratio (S/N) = 4.

5105010050010001σxat1.1mm[µJy]0.010.11101001000Areawithσ<σx[arcmin2]Thiswork(v20180102)Thiswork(v20180801)Aravena+2016(ALMA)Dunlop+2017(ALMA)Franco+2018(ALMA)Liu+2018(GOODS-N)A3COSMOS photometry & catalogs

7

Sect. 4.5 we will further describe an eﬀective approach
to addressing potential line contamination.

Furthermore, in Fig. 5, we show the distribution of
the angular resolution of the ALMA data, as represented
by the major-axis FWHM of ALMA data’s synthesized
beam θMaj, beam. Of current images, (cid:46) 1% have a very
high angular resolution, i.e., θMaj, beam < 0.100. These
images represent a more challenging case for our source
extraction because our blind and prior source extraction
methods are all optimized for only marginally resolved
sources, while sources in the very high resolution im-
ages usually are signiﬁcantly resolved (e.g., with a ra-
tio of source to beam area (cid:38) 10). Also note that the
large number of independent beams within these im-
ages (∝ FoV / θ2
) statistically translates into a
signiﬁcant contamination of “spurious” sources to our
photometry catalog (even using a conservative S/N ∼ 5
cut; see Sect. 2.8). Therefore, these (cid:46) 1% very high
resolution (θMaj, beam < 0.100) images are excluded from
our analysis.

Maj, beam

Currently, data for the same source taken at the same
frequency arising from diﬀerent projects are not com-
bined.

The breakdown of the number of objects detected, the
expected number of false objects, the area, median depth
and resolution as a function of observing band are pro-
vided in Table 1.

2.2. Blind Source Extraction
We perform the blind source extraction on our
“cleaned” ALMA continuum images. We use the
primary-beam-attenuation-uncorrected images because
they have the advantage of a constant noise across the
ﬁeld of view, and thus source extraction can be run with
uniform parameters across them. The primary beam at-
tenuation corrections are applied after the photometry
steps.

We use the Python Blob Detector and Source
Finder (aka PyBDSM or PyBDSF; hereafter PyBDSF;
Mohan & Raﬀerty 2015) 5 to ﬁnd sources blindly and
extract their ﬂux and size information. First, the code
identiﬁes “islands” of emission, i.e., with the peak pixel
emission above 4 times the rms noise (thresh_pix = 4),
and surrounded by contiguous pixels with values all
greater than 3 times the rms noise (thresh_isl = 3).
These thresholds are obtained from a series of tests by
introducing mock sources into the ALMA images and
recovering them with PyBDSF. The best performance

Fig. 4. Comparison of the 1−σ sensitivities of our images
(i.e., σA3 ) to those measured in continuum maps from the
ALMA archive (i.e., σQA2). The dark histogram shows the
(σA3 − σQA2)/σA3 distribution, while the vertical continuous
and dashed lines represent its mean (∼ −0.1) and dispersion
(∼ 0.17). A Gaussian distribution with similar characteris-
tics is shown as a dotted line.

Beam size distributions of two versions of
Fig. 5.
A3COSMOS data sets. The beam size is deﬁned as the
FWHM along the major axis of ALMA data’s synthesized
beam (θMaj., beam) after the interferometric “cleaning” pro-
cess. The gray shaded area indicates θMaj., beam < 0.100, for
which data were discarded owing to too high spatial resolu-
tion as discussed at the end of Sect. 2.1.

mary beam attenuation (PBA) 4. Note that although
the aggregation of all SpWs available for a given tar-
get optimizes the sensitivities of our continuum images,
it does not consider any possible line contamination. In

4 The PBA corrections are due to the non-uniform sensitivity
within the Gaussian-approximated FWHM of the primary beam
for each antenna.

5 PyBDSF documentation: http://www.astron.nl/citt/pybdsf/
index.html; and its source code: https://github.com/lofar-astron/
PyBDSF.

1.00.50.00.51.0(σA3−σQA2)/σA3010203040506070#0.010.1110θMaj.beam[arcsec]1101001000NThiswork(v20180102)Nextrelease(v20180801)8

D. Liu et al.

Table 1. Information per ALMA Band

Band 3
34
26.639
2.164
0.039
24

Info Type
Number of Images
Sum Beam Area [arcmin2] a
Mean Beam Size [arcsec]
Mean RMS Noise [mJy/beam]
PYBDSF S/Npeak > 5.40
GALFIT S/Npeak > 4.35 b
a The areas are the sum of primary beam circular area only.
b The number in parentheses corresponds to the sources that passed our quality assessments from Sects. 4.1 to 4.4. Based on
the spurious fraction analysis in Sect. 2.8, we expect about 8% spurious sources in total for the PYBDSF selection and ∼12%
for the GALFIT selection.

Band 7
857
54.729
0.772
0.160
524

Band 9
1
0.016
0.305
1.757
2

Band 4
6
2.294
1.098
0.025
5

Band 6
633
79.511
1.202
0.077
371

Band 8
1
0.044
0.526
0.034
1

Band 5
2
0.329
1.548
0.090
3

452 (342)

553 (461)

10 (7)

20 (7)

1 (1)

1 (1)

2 (2)

was evaluated based on completeness and contamination
(see Sects. 2.8 and 3.2). Next, PyBDSF ﬁts multiple
two-dimensional Gaussians to each “island” depending
on the number of peaks identiﬁed within it. Thirdly,
all Gaussians of the same “island” are grouped into
one source, with the summed ﬂux being the integrated
source ﬂux, the ﬂux-weighted averaged position being
the source position. The total intrinsic source size is
obtained via a moment analysis 6 on each individual
Gaussian component’s intrinsic size 7. Finally, the er-
rors of each ﬁtted parameter (peak ﬂux, total ﬂux, and
each size parameter) are computed using the formulae
of Gaussian ﬁtting errors calibrated by Condon (1997).
About 6% of our “islands” are ﬁtted with multiple
Gaussians, while the vast majority (94%) have a sin-
gle Gaussian component. Most of these multi-Gaussian
sources are isolated sources but exhibit non-smooth mor-
phologies, either due to resolved spatial components
and/or noise in the image. In a few cases, these multi-
Gaussian sources might indeed be interacting galaxies.
Utilizing information from the prior source catalog, we
are able to reliably ﬂag these sources in a later step of
our analysis. Therefore, they are kept as a single source
in the blind source catalog.

Our ﬁnal blind source catalog is obtained by correcting
for ﬂux bias and re-estimating ﬂux errors (see Sect. 3),
then applying a primary beam attenuation correction to
the photometry of each source (i.e., to the peak ﬂux, to-
tal ﬂux, and associated uncertainties). Given that each
source represents a high-redshift galaxy with a typical
size of 0.5–200, much smaller than the primary beam, us-

6 See details in http://www.astron.nl/citt/pybdsm/process_

image.html.

7 Each Gaussian component’s intrinsic size is their ﬁtted
Gaussian size deconvolved with the clean beam which is a
two-dimensional Gaussian, and the deconvolution follows the
Astronomical Image Processing System (AIPS; Greisen 2002)
DECONV.FOR module (see also Spreeuw 2010, Chapter 2).

ing a single primary beam attenuation correction factor
at the source’s central position is reasonable.

2.3. Prior Source Master Catalog
In addition to the blind source extraction, we utilize
known source positions as a prior for the source ﬁtting.
This technique allows for deeper detection limits and
lowers the spurious source fraction. Before starting the
prior ﬁtting, we compiled a “COSMOS master catalog”
from a number of multi-wavelength catalogs for sources
in the COSMOS ﬁeld as listed in Table 2. The aim is to
be as complete as possible in prior sources while ensur-
ing that source duplication is solved among the various
catalogs. Thus we loop over the prior catalogs in the or-
der listed in Table 2. Their respective areal coverage is
indicated in Fig. 6. To ensure that a given galaxy (which
might be detected in multiple prior catalogs) has only
one unique entry in the master catalog, we ﬁnd out each
uniquely-matched group among the prior catalogs (with
matching radius 100) and add into the master catalog
only the source coming from the highest-quality (empir-
ically sorted by angular resolution and relative depth)
catalog, i.e. listed closest to the top in Table 2.

Our 100 matching radius corresponds to a worst false-
match probability of 13.3% for other catalogs cross-
matched to the Laigle et al. (2016) catalog based on
Eq. 1 of Pope et al. (2006) 8. We emphasize that the
false-match rate does not aﬀect our photometric work
because if a galaxy from another catalog in Table 2 is
falsely matched to the Laigle et al. (2016) catalog, we
just use the prior position in the Laigle et al. (2016)
catalog for our prior photometry. The source position is
not forced to be at the exact prior position, as our pho-
tometry code will ﬁnd the best ﬁtting for position and

8 As an additional experiment, we estimated the false-match
probability to be 9.9% by ﬁrst ﬂipping the catalog to be cross-
matched to the Laigle et al. (2016) catalog in R.A. positions, and
then we did the cross-match.

A3COSMOS photometry & catalogs

9

ﬂux (see next section). It may aﬀect our galaxy property
analysis via SED ﬁtting in a later step because we use
the redshift information from the literature as the prior.
However, the inﬂuence is minimized by (a) collecting all
possible prior redshift information in the literature, (b)
verifying via photo-z SED ﬁtting (see Sect. 4.4), and,
in later steps, (c) only considering a source a robust
galaxy if it passes all our quality assessments (Sect. 4).
A falsely-matched source with a wrong prior redshift is
unlikely to pass them as detailed in Sect. 4. Yet we can-
not totally avoid false matches (which should be only a
few out of a thousand in our ﬁnal products), especially
when the astrometry in optical/near-IR image data also
aﬀects our work (see next section and Appx. A).

The combination of these prior catalogs results in
the “COSMOS master catalog” with unique source IDs.
In our current master catalog (version 20170426), be-
cause the COSMOS2015 catalog is our primary catalog,
all 1,182,108 COSMOS2015 sources are in our “COS-
MOS master catalog” with the same IDs. A total of
443,688 (37.5%) of them have counterparts in other cat-
alogs. The remaining ﬁve catalogs contribute 110,768
new sources that are not in the COSMOS2015 cata-
log. The Muzzin et al. (2013) catalog contributes 18,536
sources, a fraction of which are from the COSMOS2015
masked regions close to bright stars. The Ks data used
for the Muzzin et al. (2013) catalog are shallower than
those of the COSMOS2015 catalog (UltraVISTA DR2),
so the reason for some new sources should be the diﬀer-
ent source extraction methods used: the COSMOS2015
catalog uses a z, Y, J, H, Ks-combined χ2 detection im-
age while the Muzzin et al. (2013) catalog directly uses
the Ks image and therefore favors redder sources. The
i-band-selected catalog contributes 31,159 sources, prob-
ably beneﬁting from its higher angular resolution detec-
tion image (see discussion in Sect. 4 of Capak et al.
2007). The IRAC catalog contributes another 4,685
sources. The radio catalog contributes 1,042 sources.
Finally, the Sanders et al. (2007) catalog contributes
55,346 sources, but most of them are in an area out-
side the COSMOS2015 coverage (e.g., Fig. 6), while only
8,893 sources are new in the area covered by both cata-
logs.

The total number of unique priors that fall in pri-
mary beam attenuation > 0.2 areas of our dataset ver-
sion 20180102 (20180801) is 41,161 (73,387).

2.4. Prior Source Fitting
Utilizing source positions from the COSMOS master
catalog, we obtain the (sub-)mm photometry via prior
source ﬁtting of the ALMA continuum images. We im-
plement two steps below to optimize the robustness of

Fig. 6. Coverage of our prior catalogs for the COSMOS
ﬁeld as listed in Table 2. Background image is the Herschel
PACS 100 µm image, same as in Fig. 2. The colored lines
encompass the area searched for sources in the respective
prior catalog (see inset for catalog information).

the ﬁtting. Potential small astrometric inconsistencies
between the prior source positions and the ALMA data
are taken into account as follows before the full prior
source ﬁtting procedure is applied: we calculate the
oﬀsets between pre-run ALMA positions and the prior
source positions directly from Laigle et al. (2016) and
other prior catalogs, and then we derive a mean oﬀset
for each prior catalog and update all prior positions in
our master catalog. Details of the astrometry analysis
are given in Appx. A.

As a ﬁrst step, we identify potential candidate sources
based on the S/N of their peak (sub-)mm ﬂux density
(Speak) or integrated ﬂux density (Stotal). Following
Scoville et al. (2014, 2016, 2017), we measure both ﬂux
densities in a series of apertures with radii from 0.0025
to 200 in steps of 0.0025. We follow exactly the Scoville
et al. (2016, 2017) method so as to allow for a direct
comparison. Using the pixel rms noise calculated from
Gaussian ﬁtting to the pixel value distribution of each
image, we obtain the S/N ratio for the peak ﬂux density
peak ≡ Speak/(rms noise), and the one for in-
via S/N
tegrated ﬂux density S/N
by dividing Stotal by the
total
integrated noise in each aperture (i.e., rms noise times
the square root of pixel number in each aperture). We
refer to this aperture photometry as the getpix method
hereafter (and compare its results with those from our
other photometry methods in Sect. 2.7).

This ﬁrst getpix step also provides guidance for the
prior source ﬁtting using galfit (Peng et al. 2002,
total > 2 or
2010) in the next step. We select S/N

9h58m10h00m10h02m10h04m1°30'2°00'2°30'3°00'RADecLaigle+2016Muzzin+2013Capak+2007SPLASHSmolcic+2017Sanders+200710

D. Liu et al.

Table 2. Prior Catalogs Used for Constructing the COSMOS Master Catalog †

Res. e

Depth d

c Detection

a NMaster

b NUnique

1.6

1.8

Map

5390

1.6 f

∼ 100

∼ 100

10799

30146

18536

31159

386125

263229

NCatalog

VISTA Ks

24.35 (3 σ, 2.001)

24.0 (3 σ, 300, Ks)

Area
(deg2)
1.8

1182108 1182108 738420 VISTA z Y JHKs

Catalog Name (and
Reference)
COSMOS2015 catalog
(Laigle et al. 2016)
Ks-band catalog
(Muzzin et al. 2013) f
i-band catalog
(Capak et al. 2007)
SPLASH IRAC
supplementary catalog g
VLA catalog
(Smolčić et al. 2017)
IRAC catalog
(Sanders et al. 2007)
a Total number of sources in each prior catalog. b The number of sources in each prior catalog that are not in higher order
catalogs (the order is as listed from top to bottom). Which is, the number of sources in our “COSMOS master catalog” that
are originated from the current prior catalog. c The number of unique sources in each prior catalog, which means these sources
have no counterpart in any other prior catalog. d The depth is in AB magnitude, and is in an aperture if indicated in brackets.
e Spatial resolution, or point spread function size of the detection map. f The Muzzin et al. (2013) catalog contains sources in
the masked area of the COSMOS2015 catalog which are close to bright, saturated stars. g Based on the source extraction in
the Spitzer Large Area Survey with Hyper-Suprime-Cam (SPLASH; PI: P. Capak) survey data after ﬁtting and removing all
COSMOS2015 catalog sources (I. Davidzon; priv. comm.) † The master catalog used in this paper’s work has a version code of
20170426.

CFHT i? +
Subaru i+
Spitzer/IRAC
3.6 + 4.5 µm
VLA 3 GHz

Spitzer/IRAC
3.6 − 8.0 µm

24.01 (5 σ,
3.6 µm)

26.2 (5 σ, 300)

2.3 µJy (1 σ)

25.5 (3 σ)

∼ 0.0075

347332

∼ 0.005

∼ 1.006

∼ 1.006

55346

10922

54642

1042

4685

3690

644

2.3

2

S/N
peak > 3.6 sources (same as Scoville et al. 2017)
as valid detections. This pre-selection of prior sources
is important for applying galfit, as it signiﬁcantly re-
duces the required computational time for galfit by
avoiding the ﬁtting of sources that mostly correspond
to noise in the image. We have conﬁrmed that this ap-
proach is sensible with our MC simulations (see Sect. 3).
Also, our ﬁnal catalogs are not sensitive to small changes
of these thresholds, because in the end we apply a rela-
tively high S/N
cut according to our MC simulation
statistics. Note that in most ALMA images our priors
do not have blending issues.

peak

To optimize the galfit ﬁtting for source ﬂuxes as
well as sizes, an iterative approach is adopted: After the
ﬁrst-pass ﬁtting with point-source models to all galfit
priors ﬁxed at their original positions, we select sources
with a ﬁtted magnitude error of < 0.25 9 or Stotal > 3 σ
(σ being the pixel rms noise) and allow their positions to
vary by at most 0.007 10 in the second-pass ﬁtting. Then,
in order to identify possible extended sources, we al-
low sources with ﬁtted magnitude error < 0.20 or Stotal
above 3 times the rms noise to be ﬁtted with circular
Gaussian models (and in a next step Sérsic proﬁles) in

9 galfit ﬁts magnitude instead of ﬂux density
10 This is the 1 σ scatter of the spatial separations between our
ALMA sources and their optical/near-infrared counterparts as we
examined in Sect. 4.2.

the third-pass ﬁtting. We note that our thresholds are
very loose, and 98% of the sources in our ﬁnal prior pho-
tometry catalog (with a relatively high selection thresh-
old, S/N
(cid:38) 5, according to our MC simulation statis-
tics, see Sect. 4.1) are ﬁtted with extended shapes.

peak

For each ﬁt, we ensure that the image background
is zero (as already veriﬁed by the close-to-zero means of
the distributions of the pixel values from the ALMA im-
ages). If a given galfit iteration yields bad ﬁts and/or
non-convergence, the ﬁtting is repeated with a higher
limit for galfit iteration 11.

As the galfit errors only consider the covariance ma-
trix of the ﬁtting, they do not reﬂect observational noise
or correlated noise. Therefore, we estimate the error
in Stotal (σStotal
) for Gaussian-ﬁtted sources following
Condon (1997). This error estimation determines σStotal
purely from the rms noise, beam major and minor axes
FWHM sizes (θbmaj. and θbmin. respectively), source ma-
jor and minor axes FWHM sizes (θmaj. and θmin. respec-
tively; ﬁtted values and convolved with the beam) and
source Speak and Stotal. We further verify that this is
in general consistent with our own MC simulations (see
Sect. 3).

11 By default, galfit iterates a maximum for a total of 100
times, and 10 times when converging to a local minimum. These
numbers can be increased to, for example, 1000 total iterations
and 255 iterations during convergence, e.g., Liu et al. (2018).

A3COSMOS photometry & catalogs

11

2.5. Comparing Blind Extraction and Prior Fitting

Results

As a quality check to both blind source extraction
and prior source ﬁtting, and to identify potential prob-
lem cases, we compare the total ﬂuxes from PyBDSF
to those from galfit for common sources (within 1.000
and using the same ALMA images) in Fig. 7. 96% of
sources have ﬂuxes agreeing within 3 σ. Outliers with
ﬂux diﬀerences of > 5 σ are labeled in the ﬁgure. Their
PyBDSF and galfit ﬁtting models and residuals are
further shown and discussed in Appx. B. The three out-
liers with a galfit ﬂux much larger than the PyBDSF
ﬂux are caused by poor ﬁts of PyBDSF to their irreg-
ular morphologies. The one outlier with a much larger
PyBDSF ﬂux than the galfit ﬂux is due to a blend-
ing of prior sources and given the complex morphology,
both galfit and PyBDSF could not provide an ideal
ﬁt.

Fig. 7. Top: Comparison of total ﬂuxes derived from the
PyBDSF blind source extraction and the prior-based galfit
source ﬁtting. Data points show sources matched within
100 and measured on the same image. Color indicates their
S/Npeak, i.e., the ratio of source peak ﬂux to rms noise of the
image. The solid line shows the one-to-one correspondence
and the two dashed lines indicate the 5 σ range, where σ
is the scatter measured from the bottom panel. Outliers
above 5 σ are labeled and discussed in detail in Appx. B.
Bottom: Histogram of the ﬂux diﬀerence on a logarithmic
scale, log10(SPyBDSF/SGALFIT). The mean is −0.013 with a
standard deviation of 0.10 dex. Dashed vertical lines indicate
the same 5 σ range as in the top panel.

With both PyBDSF and prior-based galfit pho-
tometry, we not only obtain accurate independent
ﬂuxes which agree very well but also identify those few
(0.5% 12) sources which suﬀer from source multiplic-
ity/blending issues. These sources need careful visual
inspections as well as multi-wavelength diagnostics (e.g.,
SEDs) in order to fully deblend their ALMA ﬂux, and
thus will be analyzed in a future work.

In our released two photometry catalogs, we ﬂag
sources for which the total ﬂuxes from the two methods
disagree by more than a factor of ∼3.12 (5 σ, where σ is
the scatter between PyBDSF and galfit total ﬂuxes,
see Fig. 7) with a column Flag_inconsistent_flux and
exclude them in subsequent steps. In the next sections,
we use the prior photometry ﬂux for the SED ﬁtting.
But measurements from both photometry methods will
be made public together with the ﬁnal galaxy SED and
property catalog (see Sect. 5).

2.6. Comparison to uv-plane Source Fitting Results
Instead of measuring the source ﬂux density in the
image plane, it can also be directly measured in the
uv-plane by ﬁtting source models to the visibilities.
We use the GILDAS 13 uv_fit task to ﬁt Gaussian
and/or point-source models then compare the total ﬂux
with those measured from the image-plane galfit and
PyBDSF ﬁtting. We veriﬁed that GILDAS uv_fit
gives similar results to the CASA uvmodelfit task for
high-S/N sources (e.g., total ﬂux S/N > 10).

We run GILDAS uv_fit in an iterative approach:
ﬁrst we ﬁt point-source models, and next for high-S/N
sources we ﬁt extended Gaussian source models. We
ﬁt only for one source at the phase center and allow
its position to vary freely by uv_fit. In total we ran
the uv-ﬁtting for 301 pointings from four representa-
tive ALMA projects: 2015.1.00137.S, 2013.1.00151.S,
2015.1.00379.S, and 2016.1.01208.S (these projects tar-
get the dust continuum for hundreds of galaxies from
redshift 1 to 3; the PI of the ﬁrst project is N. Scov-
ille, and the PI for the other three is E. Schinnerer).
The uv_fit ﬂux densities and the prior-based and blind
(sub-)mm photometries agree very well. The diﬀerence
between blind photometry and uv_fit ﬂux densities (on

12 We have 0.5% such sources in our ﬁnal photometry catalogs
selected according to the threshold in Sect. 4.1. This fraction goes
up to only 2% if we apply a threshold of S/Npeak ≥ 3.0 to both
catalogs.

13 GILDAS is an interferometry data reduction and anal-
ysis software developed by Institut de Radioastronomie Mil-
limétrique (IRAM) and is available from http://www.iram.fr/
IRAMFR/GILDAS/. The conversion of ALMA measurement sets
to GILDAS/MAPPING uv table data follows https://www.iram.
fr/IRAMFR/ARC/documents/ﬁller/casa-gildas.pdf.

0.1110100SPyBDSF0.1110100SGALFIT5- outliers:1: 8311672: 6054453: 334409a: 735948123a31050S/Npeak,PyBDSF0.50.00.51.01.52.0log(SPyBDSF/SGALFIT)110100N5threshold:SPyBDSF/SGALFIT>3.12orSGALFIT/SPyBDSF>3.1212

D. Liu et al.

a logarithmic scale) has a median of 0.015 dex and scat-
ter of 0.08 dex. The diﬀerence between prior photometry
and uv_fit ﬂux densities has a median of -0.005 dex and
scatter of 0.13 dex, showing a few more outliers (caused
by blended priors, same as in Fig. 7).

2.7. Comparison to Aperture Photometry Results
We further compare the ﬂuxes from our PyBDSF and
prior-based galfit ﬁtting with those derived from aper-
the
ture photometry (Scoville et al. 2016, 2017) (i.e.
getpix method described in Sect. 2.4). For sources
with galfit S/N
peak ≥ 3, the getpix method provides
ﬂux densities consistent with the ones from galfit (the
mean of getpix to galfit ﬂux ratio on a logarithmic
scale is 0.004 dex and the scatter is 0.18 dex). Sources
with S/N
peak > 10 are on average biased toward higher
getpix ﬂux densities, but no more than 10% (the mean
value increases to 0.03 dex and scatter 0.06 dex; likely
due to bright outlier sources that have non-Gaussian
shapes).

log

the mean of

The comparison between getpix and PyBDSF ﬂux
densities yields similar results: for PyBDSF S/N
peak ≥
3 sources
10 SGETPIX/SPyBDSF is
0.003 dex with a scatter of 0.15 dex; when considering
only S/N
peak ≥ 10 sources the mean is still <0.01 dex.
For about 10 sources, we directly compared our ﬂux
densities to measurements from Scoville et al. (2016,
2017; priv.
comm.), ﬁnding similar results to those
mentioned above.

2.8. Inverted-image Fitting and the Fraction of

Spurious Detection

We run our photometry tools (based on PyBDSF and
galfit) on the inverted images (i.e., the sign of each
pixel value is inverted) to estimate the fraction (and
probability) of spurious detections by comparing the
number of sources detected in inverted images to that
in original images. We deﬁne the spurious fraction as
the number of sources detected in inverted images com-
pared to the corresponding number in the original im-
(deﬁned as Speak/rms noise
ages as a function of S/N
in Sect. 2.4), since this quantity does not depend on any
ﬁtted source size.

peak

Since prior ﬁtting needs a prior catalog to proceed
with, and because our prior catalog has a very high
number density (∼ 700 per arcmin2) which acts like
a random sampling in the image, we directly use our
COSMOS master catalog as the prior catalog for the
inverted-image galfit photometry. The procedure is
the same as described in Sect. 2.4, we ﬁrst run the get-
pix step then iteratively run galfit source ﬁtting. In
addition, we checked that the spurious detection curve

Fig. 8. Fraction of spurious detection for the PyBDSF-
based blind source extraction (upper panel) and galfit-
based prior source ﬁtting (lower panel). The solid curves and
ﬁlled data points represent the diﬀerential spurious fraction
at each S/Npeak bin, while the dotted curves and open data
points represent the cumulative values, i.e., for S/Npeak ≥
the current bin’s S/Npeak.

Fig. 9.
Spurious fraction for three bins of pb_attenu:
(0.2–0.34], (0.34–0.58] and (0.58–1.0], which are equally dis-
tributed in logarithm. The solid and dashed lines represent
diﬀerential and cumulative curves, respectively (see Fig. 8
caption). We caution that the trend seen here suﬀers from
a strong bias in statistics, because the lowest pb_attenu
(farthest away from phase center) bin has only about 62
S/Npeak > 5 detections in original images and 27 in inverted
images, while the numbers are 10 times larger in the inner-
most bin with pb_attenu ∼ 0.58 − 1.0 (although they are
equal in area).

234567102030S/NpeakSpeak,rec./rmsnoise0%20%40%60%80%100%SpuriousBlind ExtractionDifferentialCumulative234567102030S/NpeakSpeak,rec./rmsnoise0%20%40%60%80%100%SpuriousPrior FittingDifferentialCumulative234567102030S/NpeakSpeak,rec./rmsnoise0%20%40%60%80%100%SpuriousBlind Extractionpb_attenu=0.20-0.34pb_attenu=0.34-0.58pb_attenu=0.58-1.00A3COSMOS photometry & catalogs

13

remains the same when shifting the positions of the en-
tire prior catalog by +/ − 200 in Right Ascension and/or
Declination to avoid overlap with real galaxies.

peak

Fig. 8 shows the derived spurious fraction curves as a
function of S/N
for both PyBDSF (top) and gal-
fit (bottom) photometry. The diﬀerential curve (solid
line) indicates the spurious fraction at each S/N
.
peak
The cumulative curve (dotted line) provides the spuri-
ous fraction summed over all bins with S/N
greater
than or equal to the current bin. As expected, spuri-
ous fractions are lower for the prior-based photometry
compared to the blind source extraction due to the avail-
ability of information on the presence of a galaxy. Thus
the prior-based photometry achieves deeper detection
limits.

peak

In this work, we provide a photometry catalog out to
a primary beam attenuation of 0.2 (i.e. covering the
full area of the images that are made available) and
provide the pb_attenu for each source in our catalog.
Note that 91% of our ﬁnal selected sources lie within a
primary beam attenuation of 0.5 and only 2% beyond
0.3. Special care should be applied, e.g., considering a
higher S/N
threshold as shown in Fig. 9 when study-
ing sources below a pb_attenu of ∼0.5.

peak

To investigate whether the primary beam attenuation
is aﬀecting the false-positive detection, we have done two
tests: one is dividing the spurious fraction curve in bins
of primary beam attenuation (pb_attenu) as shown in
Fig. 9, the other is plotting the radial distribution of all
spurious detections from the inverted images in Fig. 10.
In the former test, we choose only three bins because of
the low number of sources away from the phase center
(low pb_attenu). We bin in equal ln(pb_attenu) in-
tervals which correspond to the same sky area, because
pb_attenu ∝ exp(dist.2/pb2), where dist. is the dis-
tance of the source to the phase center and pb is the
FWHM of the primary beam. The spurious fraction de-
creases when pb_attenu becomes closer to 1.0, which is
as expected. But we also caution that there is a strong
bias in the statistics because the number of sources dra-
matically diﬀers (see Fig. 9 caption).

In Fig. 10, we show the radial distribution of all
sources detected in the inverted images with galfit
S/N
peak > 2.5 or found by PyBDSF. Since the spu-
rious fraction curve is slightly higher at larger radii, we
might expect the spurious source density to be higher,
however, the distribution remains fairly constant out to
a pb_attenu of ∼ 0.3. We attribute the slight drop
below ∼ 0.3 to the fact that instrumental systematics
are likely becoming more prominent, namely (a) the ap-
proximation of the primary beam by a Gaussian might
no longer be correct 14, and (b) the frequency depen-
dence of the primary beam across the frequency range
sampled by the continuum (i.e., 16 GHz between the up-
per and lower boundary of the spectral sidebands) will
be more evident at large distances from the phase cen-
ter. A more detailed investigation is beyond the scope
of this paper.

14

E.g.,

see

https://help.almascience.org/index.php?

/Knowledgebase/Article/View/234.

Fig. 10. The radial distribution of spurious detections for
the PyBDSF-based blind source extraction (orange) and
galfit-based prior source ﬁtting (blue). The bottom x-
axis is the primary beam attenuation, pb_attenu, and the
top axis is the normalized distance to the phase center,
dist./(0.5 × pb), where dist. is the spatial distance to the
phase center and pb is the FWHM of the primary beam. The
histogram bins are equally distributed in ln(pb_attenu) (so
that the area of each bin normalized by the primary beam
area are equal).

3. MONTE CARLO SIMULATIONS
We run extensive Monte Carlo (MC) simulations to
verify our two main photometry methods: PyBDSF
and galfit. The principle idea is to simulate model
galaxies and recover them with the same analysis used
to create our catalogs. The aims are (1) to test whether
the recovered ﬂux densities have a systematic oﬀset to
the simulated ﬂux densities, which is hereafter referred
to as “ﬂux bias”, and to understand its source and quan-
tify it if it exists; (2) to quantify the overall uncertainty
on the extracted ﬂux densities and verify whether the
aforementioned Condon (1997) error estimates can sta-
tistically describe the uncertainty; (3) to quantify the
fraction of sources being recovered from all sources sim-
ulated, which is hereafter referred to as “completeness”;
and (4) to verify whether the prior information used in
the simulations will alter the output statistics or not.

0.20.30.40.50.71Primary beam attenuation050100150200NGALFIT S/Npeak>2.5PYBDSF1.521.321.151.000.720Normalized distance to phase center14

D. Liu et al.

peak

In our simulations, we create artiﬁcial sources (of
Gaussian shape), insert them into residual images (af-
ter blind extraction photometry), and recover them with
our photometry pipelines. These steps are repeated sev-
eral tens to hundreds of times for a large number of
images with diﬀerent properties (details are given in
Appx. C). Our artiﬁcial sources are created within a
grid of input values of both ﬂux density and size. We
create two sets of simulations with quite diﬀerent in-
put distributions deﬁning this grid: (1) We start with a
full-parameter-space simulation (hereafter “FULL” sim-
ulation) in which the full parameter space of ﬂux den-
sity and size is uniformly sampled: S/N
ranges
from 2.5 to 100 in logarithmic intervals, and source
major-axis size to beam major-axis size ratio ranges
from 0.1 to 6. Each grid point with a given ﬂux den-
sity and size contains the same number of simulated
(2) We create another physically-motivated
sources.
MC simulation, hereafter “PHYS” simulation, where
we simulate sources mimicking observed galaxy stellar
mass functions (SMFs; e.g., Davidzon et al. 2017), star-
forming MS relation (MS; e.g., Sargent et al. 2014) and
starburst/MS classiﬁcation (i.e., following the 2-star-
formation model [2SFM] of Sargent et al. 2012, 2014
and Béthermin et al. 2012a, 2017), as well as galax-
ies’ size evolution (e.g., van der Wel et al. 2014; Fuji-
moto et al. 2017). The motivation for performing our
“PHYS” simulation is that galaxies have non-uniform
luminosity functions (or number counts) and size distri-
butions. Fainter galaxies are much more numerous than
brighter ones, and lower redshift galaxies are in general
larger than higher redshift ones. Our comparison of the
“FULL” and “PHYS” simulations tests whether the in-
put distribution of the simulations inﬂuences the derived
recovery statistics.

Due to the large number (1500+) of individual ALMA
imaging data, we select a subset (150+) of representa-
tive images for each Scheduling Block of each Science
Goal in each ALMA project. In this way we make sure
that all diﬀerent observing scenarios (frequencies, spa-
tial resolutions, integration times, etc.) are covered.

For each selected image, we perform the “FULL”
and “PHYS” type simulations 4225 and 273 times re-
spectively, depending on the grid of simulation (see
Appx. C), resulting in 4225 and ∼3000–25000 simu-
lated objects respectively. The number of sources in
the “PHYS” simulation varies with the image ﬁeld of
view and the observing wavelength, and dominates with
fainter sources due to the assumed galaxy SMFs and
MS correlation as well as the SEDs. Details of the two
simulations are presented in Appx. C.

We then recover the simulated objects with our
PyBDSF and galfit photometry pipelines respec-
tively, using the identical settings as for the real ALMA
data.
Therefore, we have four sets of simulated-
and-recovered data to analyze and compare: FULL-
PyBDSF, FULL-galfit, PHYS-PyBDSF and PHYS-
galfit.

In the next sections, we discuss the ﬂux bias and ﬂux
errors for each simulation set, and characterize them by
two normalized parameters: the ﬁtted source peak ﬂux
density normalized by the rms noise,

S/N

peak ≡ Speak/rms noise

(1)

and the ﬁtted source area (convolved with the beam)
normalized by the beam area,

q

Θbeam ≡

Areasource, convol./Areabeam

(2)

Note that the diﬀerent types of simulations yield clear
diﬀerences in the parameters of interest, especially the
ﬂux bias correction, as we will show in the following
when comparing the results from all four simulated data
sets.

3.1. Analyses of the “FULL” and “PHYS” Simulations
Although the simulated total source ﬂux density,
Ssim., overall agrees well with the recovered total source
ﬂux density, Srec., a substantial bias between Ssim. and
Srec. becomes obvious when looking at the dependency
on the ﬂux S/N. When normalizing the diﬀerence be-
tween Ssim. and Srec. by the measured ﬂux error, the
histogram distribution of (Ssim. − Srec.)/σSrec.
exhibits a
non-zero mean and non-unity scatter (such histograms
are illustrated later in Appendices C.1.2, C.2.3 and C.3).
This indicates that the measured ﬂuxes need to be cor-
rected for ﬂux biases, and the errors in the measured
ﬂuxes need to be re-estimated.

To analyze the ﬂux bias and errors from our simula-
tions, we bin all simulated and recovered sources in the
and Θbeam, and con-
2D parameter space of S/N
sider ﬂux bias and error to be functions of these two pa-
rameters (Condon 1997; Bondi et al. 2003, 2008; Schin-
nerer et al. 2010; Jiménez-Andrade et al. 2019). Be-
and Θbeam are both normalized quanti-
cause S/N
ties, sources from diﬀerent ALMA projects can be com-
bined.

peak

peak

For each S/N

and Θbeam bin, we compute the
mean and median of the relative ﬂux density diﬀerence
((Ssim. − Srec.)/Ssim.). The ﬂux bias is then deﬁned as:

peak

ηbias ≡ h(Ssim. − Srec.)/Ssim.i

(3)

A3COSMOS photometry & catalogs

15

which represents how the recovered ﬂux density is biased
relative to the simulated ﬂux density. The corrected ﬂux
density can then be calculated as:

Scorr.
rec.

= Srec./(1.0 − ηbias)

(4)

We note that computing the ﬂux bias using the
noise-normalized ﬂux density diﬀerence
((Ssim. −
Srec.)/rms noise) leads to no obvious diﬀerence.

Then, we also compute the scatter of (Ssim. −
Srec.)/rms noise (we computed the standard deviation
and the lower and higher 68th percentiles, see Sect. 3.1.3)
and denote it as:

ηerror ≡ σ[(Ssim.−Scorr.

rec. )/rms noise]

(5)

We do not use the relative diﬀerence ((Ssim.−Srec.)/Ssim.)
because its scatter has an asymmetric distribution. The
corrected ﬂux density error can then be computed as:

σScorr.

rec.

= ηerror × rms noise

(6)

peak

Combining all bins, we can measure ηbias and ηerror as
and Θbeam, which are illustrated in
functions of S/N
Fig. 11 for the “FULL” simulation with PyBDSF recov-
ery as the example (the other three simulation-recovery
pairs are analyzed similarly, and the Θbeam-collapsed ﬁg-
ures can be seen in Fig. 12 and 13). This ﬁgure demon-
strates that the ﬂux bias and error do strongly correlate
with S/N

and Θbeam.

peak

3.1.1. Flux bias in the PyBDSF photometry
The PyBDSF photometry measurement of a source
always includes the intrinsic source ﬂux plus a contribu-
tion from noise, thus it always ﬁts positive source ﬂuxes,
and the measured ﬂuxes are statistically boosted by a
certain amount that we deﬁne as the ﬂux bias.

peak

Based on our simulations, we characterize the ﬂux bias
correction factor (ηbias, Eq. 3) by the two measurable
parameters S/N
and Θbeam, and apply the ﬂux bias
correction to the measured/recovered ﬂux with Eq. 4.
We ﬁnd these two parameters to much more strongly
aﬀect the ﬂux bias than other parameters, e.g., absolute
source size or beam size. After the ﬂux bias correction,
the extracted total ﬂuxes for simulated sources in maps
of diﬀerent spatial resolutions exhibit no obvious fur-
ther bias from their simulated total ﬂuxes. Here, we
also found that the ﬂux bias parameterization strongly
depends on the input mock source populations of the
MC simulation as demonstrated below.

In Fig. 12, we compare the ﬂux bias of the PyBDSF
photometry characterized from our “FULL” and “PHYS”
simulations. S/N
is on the x-axes and Θbeam is indi-
cated by the color. The ﬂux bias is a strong function of

peak

.

peak

peak

peak

peak

peak

and Θbeam. It rapidly becomes signiﬁcant
both S/N
peak
. For example, |Ssim. − Srec.|
with decreasing S/N
can be > 10% of Ssim. when S/N
(cid:46) 10. Secondly,
sources with larger sizes suﬀer a stronger ﬂux bias: a
source with a measured size 4 times the beam size can
= 5.77
be boosted by ∼80% of Ssim. at an S/N
(where the spurious fraction at this S/N
is ∼40%,
see Fig. 8); while an unresolved source is only boosted
by ∼20% at the same S/N

peak
The ﬂux bias functions derived from the two sim-
ulations are fully consistent at the bright end, e.g.,
S/N
(cid:38) 10 − 20. Discrepancies between the simu-
lations become only obvious at the faint end of S/N
peak
for sources with small Θbeam. The ﬂux bias in the
“FULL” simulation is much smaller than compared to
the “PHYS” simulation. This is due to the diﬀerence of
the input populations of the two simulations. The eﬀect
of “resolution bias” is likely the main reason – such a
bias causes sources with low S/N and large simulated
sizes to have much smaller recovered sizes or even be
unresolved (or undetected) and also causes their ﬂuxes
to be underestimated instead of boosted by noise. This
is common in radio photometry, where the spatial reso-
lution is comparable to and even smaller than the sizes
of galaxies at high redshift, e.g., as discussed in Bondi
et al. (2003, 2008). The resolution bias is much more
evident at the faint end of the “FULL” simulation than
the “PHYS” simulation because of the higher number of
large sources simulated in the former case. More discus-
sion is presented in Appx. C.1.3.

In reality, the physical sizes of galaxies increase with
cosmic time and scale with stellar masses (van der Wel
et al. 2014), and their angular sizes (stellar component)
increase quickly from z ∼ 1 to the present. This means
that lower-redshift galaxies with high stellar masses tend
to be largest. These galaxies can be bright at radio
wavelengths but are in general much fainter and even
undetectable at (sub-)mm wavelengths (due to the K-
correction and the general drop in star formation activ-
ity). Therefore, in our ALMA (sub-)mm data, the real
galaxy angular size distribution should be dominated by
small sources, i.e., it is better described by the “PHYS”
simulation rather than the “FULL” simulation. And
thus we use “PHYS” simulation-based ﬂux bias func-
tions for the ﬁnal correction of the photometry.

3.1.2. Flux bias in the galfit photometry
In Fig. 12, we show the ﬂux bias parameterizations de-
rived for the galfit photometry based on both simula-
tions. Similar to the PyBDSF photometry, the galfit
photometry also shows both ﬂux boosting due to noise
and ﬂux underestimation due to the “resolution bias”.

16

D. Liu et al.

Fig. 11. PyBDSF ﬂux bias and ﬂux error as functions of measured S/Npeak (Eq. 1) and Θbeam (Eq. 2) in the left and right
panels, respectively, from the “FULL” simulation. Sub-panels (from top to bottom) are bins with increasing Θbeam (as labeled).
In the left panels, red and blue circles correspond to the mean and median of (Ssim. − Srec.)/Ssim., respectively. Solid red lines
are function ﬁtting (with the form a S/N m
peak) to the ﬂux bias data points (but no feasible function form could be
ﬁtted for ﬂux error), and solid green lines are interpolations or extrapolations (visible in the right panels). The vertical dashed
In the right panels, red and blue circles
line corresponds to our sample selection threshold as will be detailed in Sect. 4.1.
represent the scatter (standard deviation) and (the minimum of upper and lower) 68th percentile of (Ssim. − Srec.)/rms noise,
respectively. See text in Sect. 3.1.

peak + b S/N n

The galfit photometry has a smaller ﬂux bias, which
is likely due to the use of known prior position infor-
mation for the photometry and the optimized iterative
photometry approach (Sect. 2.4).
It even achieves a
better accuracy for sources with largest measured sizes
(Θbeam ∼ 5) than those with slightly smaller measured
sizes (Θbeam ∼ 3), if their S/N

are above 20 or so.

peak

3.1.3. Flux error estimation for PyBDSF photometry
With Eqs. 5 and 6, we estimate the ﬂux error factor
(ηerror) from our simulation bins and parameterize it by
and Θbeam (after the correction for ﬂux bias).
S/N
We compute ηerror in a given bin by computing both
the standard deviation and the upper and lower 68th
percentiles. Because the data do not usually follow a

peak

normal distribution in (Ssim. − Srec.), both of these er-
ror estimates do not always agree with each other. This
can be seen in the right panels of Fig. 11, especially
for low-S/N
data points, where the standard devi-
ation is usually larger than the one derived from the
percentiles. And we ﬁnd that the minor value of the up-
per and lower 68th percentiles can better represent the
underlying scatter (which are shown in later ﬁgures).

peak

Condon (1997) proposed a mathematical recipe for es-
timating the errors of a six-parameter Gaussian ﬁt with
correlated noise. As shown by their Eqs. 32, 41 and 42,
the total ﬂux error can be characterized by the follow-
ing parameters: the convolved source size parameters
(major and minor axes FWHM sizes, denoted as θmaj.
and θmin. respectively, corresponding to θM and θm re-

202Flux Bias Analysis beam: 1.00 - 1.25 01020Flux Error Analysis beam: 1.00 - 1.25 202 beam: 1.25 - 1.50 01020 beam: 1.25 - 1.50 202 beam: 1.50 - 2.00 01020 beam: 1.50 - 2.00 202Median (Mean) of  (Ssim.Srec.)/Ssim. beam: 2.00 - 2.50 01020Scatter (Percentile) of  (Ssim.Srec.)/rmsnoise beam: 2.00 - 2.50 202 beam: 2.50 - 3.00 01020 beam: 2.50 - 3.00 202 beam: 3.00 - 4.00 01020 beam: 3.00 - 4.00 34567102030S/Npeak202 beam: 4.00 - 5.00 34567102030S/Npeak01020 beam: 4.00 - 5.00 202Flux Bias Analysis beam: 1.00 - 1.25 01020Flux Error Analysis beam: 1.00 - 1.25 202 beam: 1.25 - 1.50 01020 beam: 1.25 - 1.50 202 beam: 1.50 - 2.00 01020 beam: 1.50 - 2.00 202Median (Mean) of  (Ssim.Srec.)/Ssim. beam: 2.00 - 2.50 01020Scatter (Percentile) of  (Ssim.Srec.)/rmsnoise beam: 2.00 - 2.50 202 beam: 2.50 - 3.00 01020 beam: 2.50 - 3.00 202 beam: 3.00 - 4.00 01020 beam: 3.00 - 4.00 34567102030S/Npeak202 beam: 4.00 - 5.00 34567102030S/Npeak01020 beam: 4.00 - 5.00 A3COSMOS photometry & catalogs

17

Fig. 12. Flux bias (as deﬁned in Eq. 3) vs. the measured S/Npeak (as deﬁned in Eq. 1) statistics for PyBDSF (top panels) and
galfit (bottom panels) photometry, each based on our two types of Monte-Carlo simulations (left panels are “FULL” simulation
and right panels are “PHYS” simulation; see the label in each panel). Color represents the geometric mean source-to-beam size
ratio (Θbeam, as deﬁned in Eq. 2 in Sect. 2.2) and is the same in all four panels. Vertical lines are our S/Npeak thresholds for
the sample selection in Sect. 4.1.

Fig. 13. Similar to Fig. 12 but shows the ﬂux error factor ηerror (as deﬁned in Eq. 5) versus the measured S/Npeak (as deﬁned
in Eq. 1 in Sect. 2.2) for our simulated sources. Statistics for the two photometry methods (PyBDSF: top; galfit: bottom)
based on our two types of simulation (“FULL”: left, “PHYS”: right) are shown. Color represents the source-to-beam area ratio
(Θbeam, as deﬁned in Eq. 2) and is the same in all panels. The horizontal colored lines show the expected ﬂux errors using the
Condon (1997) prescription for Θbeam = 1, 2 and 5 (same color-coding as the data points). See text for further details.

spectively in Condon 1997), the beam size parameters
(major and minor axes FWHM sizes, denoted as θbmaj.
and θbmin. respectively, corresponding to θN and θn re-
spectively in Condon 1997), and the measured total ﬂux
(Stotal). Such a recipe has later been adopted in Bondi
et al. (2003, 2008), Schinnerer et al. (2010) and Smolčić
et al. (2017) for the VLA source ﬁtting photometry.

In this work, because our ALMA data have diﬀerent
beam sizes, we express these size quantities in the nor-
malized form: the geometric mean of the source size
normalized by the beam size, Θbeam as deﬁned in Eq. 2
which equals Θ2
beam ≡ (θmaj.θmin.)/(θbmaj.θbmin.); the
size of the source major axis normalized by the beam,
Θmaj. ≡ θmaj./θbmaj.; and the size of the source minor
axis normalized by the beam, Θmin. ≡ θmin./θbmin..

18

D. Liu et al.

Fig. 14. Comparison of the ﬁnal corrected and uncorrected ﬂuxes (upper panels) and errors (lower panels) for real data’s blind
extraction and prior ﬁtting photometry catalogs (left and right panels in each row respectively). The two upper panels have the
same axes ranges and color bar indicating the measured S/Npeak, and similar for the two lower panels but with the color bar
indicating the measured Θbeam.

Because the total ﬂux is the product of peak ﬂux and

source area, we can write:

show the same diagram for our two photometry meth-
ods and the two simulations.

Stotal = Speak ×

(θmaj.θmin.)
(θbmaj.θbmin.) ≡ Speak × Θ2

beam

(7)

Therefore, the Condon (1997; C97) recipe can be

rewritten as:

σ2
Stotal, C97
[rms noise]2
(cid:18)

=

Θ2

beam ×

8

(cid:19)

[1 + 1
Θ2

maj.

]1.5[1 + 1
Θ2

min.

]1.5

+

+

8

(8)

[1 + 1
Θ2

maj.

]2.5[1 + 1
Θ2

min.

]0.5

8

[1 + 1
Θ2

maj.

]0.5[1 + 1
Θ2

min.

]2.5

Condon (1997) validated the coeﬃcients/indices in
their equations using ∼3000 simulations. Because our
ALMA photometry is more diverse than their simula-
tions in both data complexity (the variety of beam size,
rms noise) and photometry method (e.g., involving iter-
ations), we need to verify that the Condon (1997) recipe
is still appropriate for our analysis.

In Fig. 13, we present how our estimated ηerror changes
with S/N
and Θbeam, and compared with the Con-
don (1997) errors (horizontal lines). The four panels

peak

peak

According to Eq. 8, the ﬂux error normalized by the
rms noise should be independent of S/N
but strongly
dependent on Θbeam. Fig. 13 indeed shows a strong de-
pendency on Θbeam but also indicates a weak depen-
. For sources with small sizes (relative
dency on S/N
to the beam), the ﬂux error becomes larger for larger
S/N
(by about 15% within the range indicated in
the ﬁgure). However, for sources with large sizes (rela-
tive to the beam), it becomes smaller for larger S/N
(by about 40% within the range of the ﬁgure).

peak

peak

peak

The expected Condon (1997) errors for Θbeam = 1, 2
and Θbeam = 5 cases are shown as horizontal lines in
Fig. 13, computed using Eq. 8 and assuming a minor/-
major axis ratio of 1. Note that a smaller axis ratio
will lead to a smaller Condon (1997) error value (by
about 15% for Θbeam = 5 when reducing the axis ra-
tio from 1 to 0.1. Our simulation-derived errors (col-
ored data points) are consistent with Condon (1997)
errors (colored lines) at the low-S/N
end and at
smallest and largest sizes (represented by the colors).
However, the “FULL” simulation panel indicates that
Condon (1997) errors are overestimated by about 40%
for large, high-S/N
sources; while the “PHYS” sim-
ulation panel indicates that Condon (1997) errors are
underestimated by about 15% for small, high-S/N
peak
sources. Both simulations show that the Condon (1997)

peak

peak

A3COSMOS photometry & catalogs

19

errors are slightly overestimated at S/N
small and intermediate-sized sources.

peak ∼ 5 − 10 for

In our ﬁnal catalog, we provide both our simulation-
derived total ﬂux errors and those given by our photom-
etry pipelines which are based on Condon (1997) 15.

3.1.4. Flux error estimation for galfit photometry
The ﬂux errors are analyzed in a similar way for gal-
fit photometry. The same diagnostic plots are shown in
the bottom panels of Fig. 13. The trends for the galfit
photometry is very similar to those for PyBDSF. The
galfit photometry has even smaller ﬂux errors for large
size sources than PyBDSF photometry. Both methods
involve multiple iteration or multi-source ﬁtting (rather
than one-time simple 2D Gaussian ﬁts), and thus the
reason for these trends is not very clear. Yet the diﬀer-
ent inputs for the two types of simulations do not have
a sizeable impact here.

3.1.5. Final Corrections
We ﬁnally correct ﬂux biases and re-estimate ﬂux er-
rors for both the simulation catalogs and the real data’s
blind extraction and prior ﬁtting catalogs, based on
and
our aforementioned recipes (as functions of S/N
Θbeam; Eqs. 4 and 6, respectively). We choose the
“PHYS” simulation for the ﬁnal correction, consider-
ing the discussion in the previous sections, i.e., “PHYS”
simulation is more representative of our real data. Note
that using “FULL” simulation would underestimate the
ﬂux bias correction and hence lead to larger ﬂuxes espe-
cially, for large sources.

peak

The comparison of corrected and uncorrected ﬂuxes
and errors for real catalogs are shown in Fig. 14. Based
on which, we ﬁnd that our corrected ﬂuxes and errors
follow well-behaved statistics (see details in Appx. C.3),
which means ﬂux biases (e.g., ﬂux boosting) are fully
removed and ﬂux errors can fully reﬂect the scatters of
photometry measurements introduced by the noise in
the data.

Further, in Figs. 15 and 16 we present the distribu-
tions of primary-beam-corrected total ﬂux and ﬁtted in-
trinsic size versus source peak-to-rms noise S/N
(see
Eq. 1), beam-normalized source size Θbeam (see Eq. 2),
and the rms noise and beam major-axis FWHM of the
ALMA data. These ﬁgures show that our detections
span a large range in ﬂux and size. Note that the

peak

15 Note that in PyBDSF, if a source is ﬁtted with a single-
Gaussian component, then its total ﬂux error is based on Condon
(1997), but if it is ﬁtted with multiple Gaussian components, then
the error is propagated.

continuum wavelengths of the ALMA detections also
vary: about 44% of the data are at ∼ 870 µm, about
49% at ∼ 1.0 − 1.5 mm (mostly 1.25 mm), ∼ 1% at
∼ 1.9 − 2.3 mm and ∼ 6% at ∼ 2.5 − 3.4 mm. Thus
the sensitivity shown cannot straightforwardly be com-
pared to single-band ALMA continuum surveys. From
these ﬁgures, good consistency between the two photom-
etry catalogs is also evident. The prior catalog extends
to a slightly fainter regime and only a minor fraction of
sources are ﬁtted with smaller sizes. As the aim here
is to obtain good continuum photometry catalogs, the
study of the uncertainty on source sizes is the topic of
future work.

3.2. Completeness
In this section, we analyze the completeness of our
photometry by examining the fraction of simulated
sources that are successfully recovered to the total simu-
lated number. The photometry is incomplete for several
reasons: (1) some faint sources are undetected due to
noise ﬂuctuation; (2) PyBDSF groups blend multiple
sources into one source; (3) galfit might give wrong
best-ﬁt results in case of severely clustered priors; and
(4) PyBDSF has certain ﬂagging criteria to ﬁlter out
nonphysical sources 16. To assess the contribution of
these eﬀects, we calculate the completeness curves as
a function of S/N and source sizes (normalized by the
beams).

We use both PHYS and FULL simulations to ver-
ify the completeness. Note that the two simulations
have very diﬀerent source ﬂux and spatial distributions.
Sources are isolated and have ﬂat ﬂux distribution in
the FULL simulation, whereas in the PHYS simulations
sources have instead realistic spatial distribution, as well
as a ﬂux distribution that fully agrees with the observed
mm number counts (see Appx. C.2).

We cross-match the PyBDSF source recovery catalog
to the simulated catalog for each image by coordinate
using a search radius of 1.500 17, and we match by ID
for the galfit recovery catalog. We measure the com-
pleteness as the ratio of the number of sources in the
cross-matched catalog and those in the simulated cata-
log for each bin of S/N
and Θbeam. We conﬁrmed
that the wide range in rms noise and beam size does not
aﬀect the completeness estimates by splitting our sim-

peak

16 According to the PyBDSF documentation http://www.

astron.nl/citt/pybdsf/process_image.html#ﬂagging-opts,
PyBDSF ﬂags apparently nonphysical sources.
details therein.

See more

17 This corresponds to a false-match probability of ≤ 1.3% for

PHYS simulations according to Eq. 1 of Pope et al. (2006).

20

D. Liu et al.

Fig. 15. Total ﬂux (primary beam corrected) vs. source peak ﬂux to rms noise ratio S/Npeak (see Eq. 1) (left panel) and the
ﬁtted intrinsic source major-axis FWHM versus the beam-normalized source size Θbeam (see Eq. 2) (right panel) for the ALMA
detections with S/Npeak > 4.35 and 5.40 in our two prior- and blind-photometry catalogs respectively (the S/Npeak thresholds
are determined in Sect. 4.1). Contours are the density of the data points. The size of a data point scales inversely with the
density for illustration purposes.

Fig. 16. Total ﬂux (primary beam corrected) vs. rms noise (left panel) and the ﬁtted intrinsic source major-axis FWHM versus
beam major-axis FWHM (right panel). Contours and data points are in the same style as in Fig. 15.

ulations in random half. Using a smaller search radius
has a very minor eﬀect, as only 4% (10%) of sources have
recovered position shifted by more than 1.000 (0.600) from
the simulated position.

Moreover, the completeness is associated to certain
detection criteria. Within PyBDSF, the detection is
deﬁned as an extracted source that passes thresh_pix,
thresh_isl and other ﬂagging criteria. Therefore, the
remaining discussion within this section is focused on
the PyBDSF setups (Sect. 2.2). In galfit, a detection
is slightly more complex to deﬁne, as galfit always ﬁts
a positive ﬂux density for each prior. Thus, we apply
an S/N cut to the galfit catalog before computing the
completeness (without such an S/N cut, the recovery
rate would be 100%, as every prior is ﬁtted with a ﬂux
density).

In the left panels of Fig. 17, we show the complete-
ness curves for the PyBDSF photometry as a function

peak

of S/N
. As sources tend to be small relative to
the beam size (with a median [mean] observed size of
Θbeam, sim. convol. ∼ 1.2 [1.6]) in the “PHYS” simulation
(top-left panel), we do not distinguish between source
sizes. The “FULL” simulations (bottom-left panel) have
suﬃcient statistics to study the eﬀect of source sizes,
thus we show completeness curves for diﬀerent simulated
source sizes in the bottom-left panel. Here, we consider
simulated size instead of recovered size, as the latter is
unavailable for undetected sources. Large sources are
slightly more complete than small sources at very low
peak ∼ 2−4. This trend reverses at a higher S/N
S/N
peak ∼ 20) above which the completeness for
(up to S/N
sources reaches ∼100%. In principle, at a given S/N
,
peak
sources with larger recovered size should have higher
completeness. We speculate that the previously dis-
cussed resolution bias, spatial noise ﬂuctuation and the
“island” feature of PyBDSF all play a role in the low-

peak

3510203050100S/NpeakSpeak/rmsnoise0.010.1110100Total_flux_pbcor [mJy]Prior CatalogBlind Catalog12345beam(Maj.Min.)/(Maj.,beamMin.,beam)0.11Maj [arcsec]0.010.11RMS_noise [mJy/beam]0.010.1110100Total_flux_pbcor [mJy]Prior CatalogBlind Catalog0.1110Maj_beam [arcsec]0.1110Maj [arcsec]A3COSMOS photometry & catalogs

21

peak

to intermediate-S/N
regime — a larger simulated
source is easier to detect due to a higher number of pixels
above the threshold, but at the same time it has a chance
of being recovered with a smaller size or even as an
(or multiple) unresolved source(s) by PyBDSF (espe-
cially for the largest simulated sizes). Thus, these eﬀects
lead to a lower completeness for the largest simulated
sources even at S/N
peak ∼ 10 − 20. While ﬁne-tuning
the PyBDSF parameters can achieve better detection
for large sources, this would require more dedicated ef-
fort beyond our systematic approach, which is tailored
to the bulk of source properties expected. Moreover,
our prior photometry is ﬁtting well large sources (< 300),
thus such cases will be identiﬁed when we cross-match
the prior- and blind-photometry catalog (see Sect. 4.1),
and currently no such source is found in our dataset as
we excluded beam < 0.100 ALMA data.

The shaded areas in Fig. 17 indicate an uncertainty
of a factor of two in the estimated incompleteness in
“PHYS”–PyBDSF, and are the same in all other pan-
els. Comparison between the completeness for the small-
est sources in the “FULL” simulation and the one from
the “PHYS” simulation gives a ∼ 3% lower complete-
ness at S/N
peak ∼ 20 − 40. This diﬀerence is caused
by source blending and exactly corresponds to the 3.5%
multi-Gaussian sources detected in our data set. As de-
scribed in Sect. 2.2, when several sources are blended,
PyBDSF ﬁts multiple Gaussians and groups them as
one island which is then output as a single source.

In the right panels of Fig. 17, we show how diﬀerent
ALMA beam sizes (absolute values in units of 00) would
impact the completeness. We ﬁnd that as long as the
ALMA beam is between 0.200 − 100, the completeness is
not obviously aﬀected. For ALMA beams larger than
100, completeness drops by ∼ 5 − 10% even for a high
S/N
peak ∼ 20−50 source in our PHYS simulation, which
is likely because sources are clustered and large ALMA
beam starts to cause blending eﬀect, and also because
PyBDSF has the “island”-grouping feature (Sect. 2.2).
In addition, in Fig. C.4 in Appendix C.4, we show the
completeness as 2D functions of both Speak/rms noise
and Stotal/rms noise and Θbeam. We ﬁnd a good agree-
ment between our completeness analysis and similar
work by Jiménez-Andrade et al. (2019) for PyBDSF
photometry in their COSMOS VLA data as well as by
Franco et al. (2018) for Blobcat (Hales et al. 2012)
photometry on their ALMA deep ﬁeld data. Further,
we discuss the comparisons of our completeness to other
(sub-)mm/radio photometry works (Karim et al. 2013;
Ono et al. 2014; Aravena et al. 2016; Hatsukade et al.
2016; Franco et al. 2018), which conﬁrm that more real-

istic simulations are required to better recover the statis-
tics.

peak

peak

Given our ﬁnding that completeness shows an obvious
dependency on source sizes, if selecting a sample with a
total ﬂux S/N threshold, the sample will have diﬀerent
completeness for diﬀerent sizes. But when selecting with
threshold, the sample will have a ho-
a constant S/N
mogeneous completeness. Thus we use S/N
to select
our ﬁnal sample (see the next section). Furthermore,
we conﬁrm that the spurious fractions derived from the
simulations are consistent with those based on inverted-
image ﬁtting in Sect. 2.8. The robust estimates of the
fractions of completeness and spurious sources provide
us with a good handle of the performance of our photom-
etry methods. For a given S/N
-selection threshold,
we know how many real sources are missed and how
many could be spurious. While there is no way to im-
prove on the non-detections, there are a number of au-
tomated examinations that can signiﬁcantly reduce the
number of spurious sources in our ﬁnal galaxy catalog
(see next sections).

peak

4. GALAXY CATALOG AND PROPERTIES
In this section, we discuss the selection of reliable
ALMA detections from the two photometry catalogs and
the construction of our ‘galaxy catalog’. Given the ex-
tensive information on galaxies in the COSMOS ﬁeld
that is available in the literature, we have devised rigor-
ous inspections to ensure that our galaxy sample and its
SEDs are reliable. These inspections include the identi-
ﬁcation of spurious sources and galaxies with inconsis-
tent photometric and/or spectroscopic redshifts in the
literature. We further discuss how galaxy properties are
obtained via multiple SED ﬁtting techniques including
consistency and reliability checks. The workﬂow of this
analysis step (including Sects. 4.1 to 4.6) is illustrated
in Fig. 18.

4.1. Combining the two photometric catalogs

peak

peak

We apply an S/N

cut at 5.40 to our blind source
extraction catalog (Sect. 2.2) and an S/N
cut at 4.35
to our prior source ﬁtting catalog (Sect. 2.4). These
thresholds are selected such that the diﬀerential spuri-
ous fractions are both 50% at the applied S/N
cut
level, and the cumulative spurious fractions are <8%
and <12% for the blind- and prior-selected samples, re-
spectively (see Sect. 2.8 and Fig. 8). The corresponding
diﬀerential completenesses at those thresholds are 57%
and 98%, and the cumulative ones are as high as >92%
and >99%, respectively (see Sect. 3.2 and Figs. 17, C.4).

peak

22

D. Liu et al.

Fig. 17. Completeness of the PyBDSF source extraction as a function of S/Npeak based on our simulations (“PHYS”: top
panels; “FULL”: bottom panels). Color in the bottom left panel represents simulated source size (convolved, normalized by the
ALMA beam, i.e., Θbeam as deﬁned in Eq. 2) and color in the top and bottom right panels are both absolute ALMA beam sizes
(θ in units of 00). Diﬀerential completeness at a given S/Npeak is marked by solid symbols, while the cumulative completeness
for the range above a given S/Npeak is shown by open symbols. The shaded areas indicate a factor of two uncertainty in the
incompleteness for the “PHYS” simulations in the ﬁrst panel and is repeated in other three panels for comparison.

In Fig. 19, we show the S/N
and prior catalogs and the applied thresholds.

peak

histograms of the blind

peak

To merge the two photometric catalogs, we spatially
cross-match their sources with a radius of 1.000 (false-
match probability 0.5% applying Eq. 1 of Pope et al.
2006; see also further discussion of the counterparts as-
sociation in the next section), and we ﬁnd 820 sources
in common. Another 326 sources are only present in
one catalog (207 sources in the prior catalog and 119
sources in the blind catalog). The S/N
histograms
of those sources (Fig. 20) show that the sources only
present in the prior catalog (prior-only sources) mostly
lie at the lowest-S/N
end, where the spurious frac-
tion is 50%. The few prior-only sources at high S/N
peak
are blends with nearby prior sources, such that only one
source is cross-matched to the corresponding PyBDSF
counterpart. The sources only present in the blind cat-
alog could be spurious (if at low ALMA S/N) or, if
at high ALMA S/N, real dusty, high-redshift galaxies
whose optical/near-IR/radio emission are too faint to be
detected in the prior catalogs. However, as there is cur-
rently no optical/near-IR information available for these
blind-only sources, we exclude them from the analysis in
the rest of this paper.

peak

After accounting for 25% of galaxies having more than
one ALMA observations, due to either diﬀerent wave-

lengths or spatial resolutions, we have 823 unique galax-
ies (with dataset version 20180201). The ALMA ﬂux
densities and their errors are then corrected for the
PBA. As 26% of these galaxies do not have suﬃcient
optical/near-IR data, i.e., not in the Laigle et al. (2016)
catalog, it is not possible to obtain reliable stellar masses
for them. While some of these sources emit weakly in the
deeper IRAC 3.6 and 4.5 µm data from the Spitzer Large
Area Survey with Hyper-Suprime-Cam (SPLASH) sur-
vey (PI: P. Capak; I. Davidzon, priv.
comm.) and
are also present in the IRAC catalogs from the Spitzer
Matching Survey of the UltraVISTA Ultra-deep Stripes
(SMUVS; Ashby et al. 2018), their stellar masses and
photometric redshifts have large uncertainties due to the
lack of shorter-wavelength information. We therefore
omit these sources from our galaxy catalog (see the “no
optical/near-IR prior-redshift galaxies” entry in Fig. 18;
they are kept in the ALMA photometry catalogs, e.g.,
those with IRAC/radio priors). We plan to update our
galaxy catalog when deeper optical-to-K-band data be-
come available, e.g., from the UltraVISTA Data Release
4.

In the next sections, we further exclude some outliers
from the ALMA photometry catalogs to construct our
ﬁnal galaxy catalog. We list the numbers and fractions
of sources excluded at each step in Table 3.

2345671020304050Speak,sim./rmsnoise0%20%40%60%80%100%CompletenessPHYSPYBDSFDifferentialCumulative2345671020304050Speak,sim./rmsnoise0%20%40%60%80%100%Completenessbeam,ALMA [arcsec]PHYSPYBDSFDifferentialCumulative0.20.40.60.81.01.21.42345671020304050Speak,sim./rmsnoise0%20%40%60%80%100%Completenessbeam,sim.,convol.FULLPYBDSFDifferentialCumulative123452345671020304050Speak,sim./rmsnoise0%20%40%60%80%100%Completenessbeam,ALMA [arcsec]FULLPYBDSFDifferentialCumulative0.20.40.60.81.01.21.4A3COSMOS photometry & catalogs

23

Blind Extraction
Photometry
Catalog (Sect. 2.2)

Prior Fitting
Photometry
Catalog (Sect. 2.4)

S/Npeak Cut
(Sect. 4.1)

S/Npeak Cut
(Sect. 4.1)

Flux
Comparison
(Sect. 4.1)

Inconsistent-ﬂux
outliers (0.5%)

Examining
Counterpart
Association
(Sect. 4.2)

Galaxies having
more than one
ALMA data (25%)

Galaxy
Multi-wavelength
SEDs and
prior-redshifts
(Sect. 4.3)

Galaxies having no
optical/near-IR
counterpart/prior-
redshift
(26%)

Predicting and
Subtracting
mm Line
Fluxes
(Sect. 4.5)

MAGPHYS
SED Fitting
(Sect. 4.4)

First Galaxy
Properties: z, M?,
SFR (Sect. 4.6)

Examining
ALMA-band
χ2 (Sect. 4.4)

Unreliable-
counterpart outliers
(4%)

COSMOS Master
Catalog (Sect. 2.3)

SED-excess outliers
(3%)

Final Galaxy Properties: z, M?,
SFR, sSFR, rest-frame mm ﬂuxes,
etc. (Sect. 4.6, 5)

Fig. 18. Workﬂow for the selection of a reliable galaxy sample and the determination of its properties (see Section 4). We
ﬁrst apply an S/Npeak cut to our two photometry catalogs and then apply a counterpart association code (based on machine
learning) to construct our galaxy multi-wavelength catalog. Next, we run SED ﬁtting to identify outliers that are due to either
spurious ALMA sources or “suspicious” (inconsistent) redshifts in the literature. Finally, after discarding spurious sources and
reﬁnement of inconsistent prior redshifts, SED ﬁtting is repeated to obtain physical properties of our galaxies. The corresponding
subsections in the text are provided in parentheses.

Fig. 19. S/Npeak histograms of our blind-extraction and
prior-ﬁtting catalogs. The blue and red vertical dashed lines
indicate the S/Npeak thresholds we applied to select our sam-
ple from the prior and blind catalogs, respectively.

4.2. Examining counterpart association
Our ALMA data set has excellent spatial resolution
(∼ 100) compared to data from single-dish (sub-)mm
telescopes (> 1000), and for most sources a unique coun-
terpart at optical/near-IR/radio wavelengths can be eas-

Fig. 20. Vertically-stacked S/Npeak histograms of our se-
lected sample from the blind-extraction and prior-ﬁtting cat-
alogs. Sources in both catalogs are indicated by green bars
and shown with the prior-catalog S/Npeak, while those in the
blind-extraction (prior-ﬁtting) catalog with S/Npeak above
the labeled threshold are shown with red (blue) bars. The
height of each stacked bar indicates the relative number, and
the total height of the histogram represents our selected sam-
ple size. (Comparing to Fig. 19, the diﬀerence in the third-
highest bin is due to diﬀerent S/Npeak between prior- and
blind-photometry as detailed in Sect. 2.5.)

151050100S/Npeak1101001000NBlind CatalogPrior CatalogS/Npeak=5.40S/Npeak=4.3551050100S/Npeak110100NBothBlind-onlyPrior-onlyS/Npeak=5.40S/Npeak=4.3524

D. Liu et al.

Table 3. Number of Sources in A3COSMOS Catalogs and
Excluded at Each Step in Sect. 4 (Version 20180201; See
Also Workﬂow in Fig. 18)

4

36

21

4%

215

26%

0.5%

Number Fraction

· · ·
· · ·
· · ·
25%

1027
939
1146
204

Catalog/Step
Prior-photometry catalog
Blind-photometry catalog
Combined ALMA detections
Galaxies having more than one ALMA
data points (Sect. 4.1) a
Galaxies having no optical/near-IR
counterpart/prior-redshift
(Sects. 4.1, 4.2 and 4.3) b, c
Inconsistent ﬂux outliers (Sect. 2.5;
Flag_inconsistent_flux) c
Unreliable counterpart outliers
(Sect. 4.2; Flag_outlier_CPA) c
SED excess outliers (Sect. 4.4;
Flag_outlier_SED) c
Final galaxy catalog (Sect. 5) d
· · ·
a In this step, we sorted 1027 ALMA prior detections into
823 unique galaxies, while discarded 119 blind-only sources
(see discussion in Sect. 4.8). The fractions in the third
column are of the 823 unique galaxies.
b This includes the 119 blind-only sources, 43 galaxies
which have no redshift from literature as prior information
and 53 galaxies which only have a far-IR/mm photo-z
from Jin et al. (2018). They are excluded from the further
quality assessments due to too poor constraints on galaxy
properties.
c 10 sources are duplicated among these ﬂags.
d Our approach aims at keeping only galaxies with most
reliable properties (redshift, stellar mass and dust-obscured
SFR), therefore the number of galaxies is signiﬁcantly
reduced compared to the number of ALMA detections. The
exclusion of galaxies does not mean they are all not real, but
just their properties could not be reliably estimated with
current data. Future follow-ups will be needed to explore
their properties.

676

3%

ily identiﬁed by examining the spatial separation. How-
ever, a small number of ambiguous cases remain for both
prior ﬁtting and blind extraction photometry. Note that
we have already corrected for the known astrometry oﬀ-
sets between prior and ALMA positions before our ﬁnal
run of prior ﬁtting (for more details on astrometry, see
Appx. A).

During our prior ﬁtting photometry, we allow the
source position to vary if the source has high S/N (see
Sect. 2.4). This implies that any ALMA source not in
our prior master catalog close to a prior position will be
wrongly attributed to that prior. In these cases, they
are more likely to have a certain spatial oﬀset. But this
scenario needs to be distinguished from the case where

the prior source is an extended galaxy and its dust emis-
sion peak is oﬀset from its optical position (e.g., Hodge
et al. 2016; Chen et al. 2017).

Besides, spurious sources caused by noise boosting
(∼10% spurious sources are expected from our statis-
tical analysis with our selection thresholds in Sect. 4.1)
can also exhibit larger oﬀsets, as the signal boosted by
noise is randomly spatially distributed. Thus, by exam-
ining the counterpart association, we can identify most
of these outliers (∼4% in this step; or in total ∼ 8.4%
including the steps in the next sections) and reduce the
number of spurious sources in our ﬁnal catalog 18.

In order to correctly identify such ambiguous cases
in an automated fashion, we quantify the counterpart
association process by several measurable parameters as
follows:
• The projected separation between the positions
of the ALMA and counterpart source, normalized
by the projected ALMA source radius (denoted as
Sep.);

• The ALMA total ﬂux S/N (denoted as S/NALMA);
• The S/N of the aperture-integrated ﬂux in optical/near-
IR/radio images, measured with an aperture cen-
tered at the ALMA source position (S/NS.) and at
the reference counterpart positions (S/NRef .), as
well as their respective ratio (denoted as S./Ref .).
The aperture size is determined via measurements
with a series of concentric apertures where the aper-
ture with the maximum S/N is taken;

• An extension parameter Ext. that traces the amount
of extended optical/near-IR/radio emission within
the location between the ALMA and counter-
part positions. This is quantiﬁed by deriving the
optical/near-IR/radio surface brightness level within
a series of ﬁxed-size apertures (equal to the ﬁtted
ALMA source size) centered along the connecting
line between the ALMA position and the reference
counterpart position. The linear slope of the rela-
tion between surface brightness and increasing (lin-
ear) distance from the ALMA position is adopted as
if the source is an extended galaxy and the
Ext.:

18 Note that examining the counterpart association is not
helpful in identifying line-of-sight boosting by noise or blend-
ing by background source. Therefore the outlier fraction found
in this step is only ∼4%, about half of our expected spu-
rious fraction ∼ 8 − 12% (Sect. 4.1). However, as shown
in the next section, SED ﬁtting is a powerful tool to ex-
clude ∼ 3% of sources line-of-sight outliers and further reduce
the spurious source fraction in our ﬁnal catalog.
In total,
after Flag_inconsistent_flux (Sect. 2.5), Flag_outliers_CPA
(Sect. 4.2) and Flag_outliers_SED (Sect. 2.2), we excluded 61
sources as spurious for 727 quality-assessed galaxies. This is basi-
cally in agreement with our statistics (8 − 12%).

A3COSMOS photometry & catalogs

25

optical emission is attenuated by dust at the ALMA
position, then Ext. is around or slightly larger than
1. However if the ALMA source is a dusty galaxy
with non-detectable optical emission and is wrongly
associated to a counterpart in optical catalog at
some distances away, Ext. will be very large or even
not measurable in the counterpart optical image (as
we require S/NS. > 3 in the apertures to measure
the Ext. parameter).

These parameters have been deﬁned to best describe
the counterpart association process, and are best suited
to distinguish between those considered true by visual
classiﬁcation from those cases where the visual classiﬁ-
cation suggests that the ALMA source is unrelated to
the counterpart source. These parameters are then mea-
sured for each ALMA detection (Sect. 4.1) and its mas-
ter catalog counterpart (Sect. 2.3) in four counterpart
images: Hubble Space Telescope (HST ) ACS i-band im-
age from Capak et al. (2007); UltraVISTA Ks-band im-
age from McCracken et al. (2010, 2012); Spitzer IRAC
3.6 µm image from the SPLASH survey (PI: P. Capak);
and VLA 3 GHz image from Smolčić et al. (2017). Other
images have worse spatial resolution and/or sensitivity
and therefore are less helpful in distinguishing the qual-
ity of counterpart associations.

Empirically, we ﬁnd counterparts with larger Sep. and
lower S/NALMA are less reliable (i.e., less conﬁdent to
say that the ALMA emission belongs to the counter-
part galaxy, based on our visual identiﬁcation). How-
ever, those could be more reliable if we see extended
emission between the ALMA and counterpart position
(i.e. Ext. ∼ 1), which could be the aforementioned case
where the galaxy’s dust emission is oﬀset from its op-
tical emission and has a smooth transition in-between.
We show an example of our counterpart association di-
agnostic in Appx. D.

With these parameters, we proceed with machine
learning techniques to establish the linkage between
these parameters and the conﬁdence of a counterpart
association. To build up a training data set, three team
members visually classiﬁed all the 1000+ ALMA detec-
tions individually. We visually inspected ALMA con-
tours overlaid on ACS i-band, UltraVISTA Ks-band,
IRAC 3.6 µm, and 3 GHz images and assigned each
source a classiﬁcation of 1 (robust) or 0 (spurious or
incorrect association). We adopt the median classiﬁca-
tion from the three sets as truth. In order to automate
this classiﬁcation for future data releases, we use the re-
sults from visual inspection to train an algorithm that
takes as input the parameters described above (Sep.,
S/NALMA, S/NRef ., S./Ref . and Ext.) calculated for

the ACS, Ks, IRAC 3.6µm, and 3GHz cutouts. In ad-
dition, we include a ﬂag for crowdedness (deﬁned as
the density of master catalog sources weighted by a 2D
Gaussian with an FWHM of PSF size; see Liu et al.
2018 Eq. 1) and clean parameter (deﬁned as the num-
ber of master catalog sources within 300 radius; Elbaz
et al. 2011), as they are helpful in identifying extremely
blended cases.

For this supervised machine learning task, we use the
Python scikit-learn package (Pedregosa et al. 2011).
For sources with missing parameters, we replace the
missing values with the mean of that parameter from
the entire sample. Then, we randomly select 60% of
the sample with visual classiﬁcations for training, leav-
ing the ﬁnal 40% for model validation. After testing a
number of diﬀerent classiﬁers available in scikit-learn,
we decide to use the Gaussian Process (GP) classiﬁer,
which implements Gaussian Processes for probabilistic
classiﬁcation. Running our trained model on the valida-
tion sample gave an accuracy of ∼ 96.5%. For the total
sample of 1027 analyzed sources, we ﬁnd that 94% (965)
of sources are classiﬁed as robust by both the visual and
GP classiﬁcations. 3% of the sources (32) are classiﬁed
as not-robust/spurious by both visual and GP classiﬁ-
cations (bringing the overall accuracy to 97%). Only
1% of the sources (7) are classiﬁed as robust visually
but missed by the GP classiﬁcation. 2% of the sources
were classiﬁed as not-robust visually but assigned a ro-
bust classiﬁcation by the GP classiﬁer. Reassuringly,
the cases where the visual and GP classiﬁcations dis-
agree are all borderline cases where the three visual
inspectors are also not in full agreement. The model
was saved and can be re-used to predict the robustness
of counterpart associations for future A3COSMOS runs
without the need for visual classiﬁcation, provided that
our current training sample is representative of future
datasets.

After this automated counterpart association step, 36
sources are ﬂagged as spurious sources (they could po-
tentially be noise-boosted or a co-aligned real dusty
galaxy). We ﬂag them by the Flag_outliers_CPA col-
umn in our ﬁnal galaxy catalog, and discard them for
our further analysis in this paper.

4.3. Combining multi-wavelength photometry and prior

redshifts in the literature

To combine the multi-wavelength photometric and
spectroscopic information for our prior catalog, we adopt
the optical/near-IR photometry from the Laigle et al.

26

D. Liu et al.

(2016) catalog, and use the 300 diameter aperture ﬂuxes
to be consistent with Laigle et al. (2016) 19.

Further, we adopt the far-IR/(sub-)mm/radio pho-
tometry from Jin et al. (2018). The authors use de-
tailed “super-deblended” procedures following Liu et al.
(2018) to overcome the severe source confusion in their
far-IR/(sub-)mm data, which is due to the large beam
sizes of the Herschel and ground-based single-dish far-
IR/(sub-)mm telescopes. Their photometry is prior-
based, with the prior catalog constructed by combin-
ing the Laigle et al. (2016), Muzzin et al. (2013) and
Smolčić et al. (2017) catalogs, all of which are also in
our master catalog. The “super-deblended” photom-
etry uses the prior information of galaxies’ photomet-
ric redshifts and SEDs to “freeze” low-redshift sources,
and includes the step of blindly extracting sources in
the residual images and re-ﬁtting together with initial
priors. Therefore, sources not in the prior catalog or
even co-aligned sources at a signiﬁcantly higher redshift
than the prior source have already been reasonably well
accounted for (e.g., if prior redshift < 1, its SED will
predict a too low far-IR ﬂux and it gets “frozen” dur-
ing ﬁtting; see details in Liu et al. 2018 and Jin et al.
2018). More complex situations arise if an unknown far-
IR source is blending with a prior source whose SED is
not constrained well. However, the ALMA data have
typically the spatial resolution and sensitivity to distin-
guish them. In this work, we do ﬁnd about a hundred
ALMA sources not in the prior catalog used by Jin et al.
(2018), of which only about 10 are blended with a Jin
et al. (2018) prior source (within 100), and their ALMA
∼ 1 mm ﬂuxes (< 1 mJy) indicate that they are un-
detectable by Herschel and SCUBA-2. Therefore, using
the Jin et al. (2018) catalog for far-IR photometry seems
appropriate, especially for those with common priors.

For the SED ﬁtting in this work, we ﬁrst consider a
prior spectroscopic or optical/near-IR photometric red-
shift if available in the literature. Using photomet-
ric redshift is motivated by the suﬃciently good agree-
ment between photometric and spectroscopic redshifts
as demonstrated by Laigle et al. (2016).

In this work, we examine all the spectroscopic and
photometric redshifts in the literature listed in Sect. 2.
We show the comparison of these redshifts (hereafter
prior redshift, or “prior-z”) in Fig. 21, where each data
point represents a galaxy in our galaxy catalog and has
prior-z from both the Laigle et al. (2016) catalog and

19 Laigle et al. (2016) found that the 300 aperture ﬂuxes lead to
better photometric redshift determination and are less aﬀected by
uncertainties in the astrometry. See their Sect. 4.1.

other catalogs 20: the M. Salvato et al.
spectroscopic
redshift catalog; the Davidzon et al. (2017) photomet-
ric catalog for the same UltraVISTA galaxies as Laigle
et al. (2016) but with optimized SED ﬁtting for z > 2.5
sources; the Delvecchio et al. (2017) photometric catalog
for radio-detected galaxies; and the Salvato et al. (2011)
photometric catalog for X-ray-detected active galactic
nuclei (AGNs).

The majority of our sample galaxies show good con-
sistency among all available prior redshifts. However,
we do ﬁnd several types of outliers: (1) About 14 X-ray-
detected AGNs have higher redshifts in the Salvato et al.
(2011) than in the Laigle et al. (2016) catalog (see open
squares in Fig. 21), but about half (6) of them have spec-
troscopic redshifts in good agreement with the Salvato
et al. (2011) values (see overlap between open squares
and yellow circles in Fig. 21). (2) About 25 z > 3 galax-
ies have lower redshifts in Davidzon et al. (2017) than
in Laigle et al. (2016), as indicated by the black solid
circles in Fig. 21, but about half (14) of them have con-
sistent second redshift peaks in Laigle et al. (2016) (see
the black solid circles with white cross in Fig. 21). (3)
About 10 low quality spectroscopic redshifts (i.e., with
two or less detected spectral features to determine the
respective redshift) disagree with Laigle et al. (2016),
yet both could have large uncertainties (see yellow cir-
cles outside the area enclosed by dashed lines in Fig. 21).
In our next step, we will run SED ﬁtting to obtain
galaxies’ stellar mass and SFR properties, but with red-
shift ﬁxed to a prior-z 21. For galaxies with consistent
prior-z or a single prior-z from the above catalogs, we
directly use it for the SED ﬁtting. But for galaxies with
inconsistent prior-z (∆z > 0.15×(1+z)) from the above
catalogs, we run SED ﬁtting for each inconsistent prior-z
and take the one with minimum-χ2 at the ALMA bands
as our best ﬁt. The details are presented in the next
section.

20 To make sure we select common sources in these catalogs, we
ﬁrst do a backward cross-matching from each compared catalog
to our full COSMOS master catalog (Sect. 2.3; with 100 radius).
Then we identify common sources by matching the exact master
catalog ID. This avoids linking of diﬀerent sources in the diﬀerent
catalogs which are closer than our cross-matching radius of 100.
While the nominal false-match probability with this matching ra-
dius is 11% (applying Eq. 1 of Pope et al. 2006), we note that
the it is only indicative of the likelihood of spurious cross matches
between catalogs in a statistical sense, based on the number den-
sity of sources and distance between counterparts, but does not
include physical information about these matches. Since we have
a priori information about whether catalog matches are physically
realistic, the actual value of the “false-match probability” will be
lower than the listed values in this manuscript.

21 We have also run another set of SED ﬁtting without a prior-z,

which is presented later in the last paragraph of Sect. 4.4.

A3COSMOS photometry & catalogs

27

ing evidence for the assumption of energy balance in our
whole galaxy sample (see below in this section).

Due to the large number of templates being ﬁtted,
MAGPHYS per default ﬁts the SED at a ﬁxed prior-z
(which can be either photo-z or spec-z from the litera-
ture). A wrong prior-z can easily lead to a poor ﬁt with
a large residual at the wavelengths of the ALMA bands,
which is measured by the reduced chi-square:

χ2

ALMA ≡

X

(|SSED − SOBS|)2

ALMA

σ2

SOBS

/NALMA

(9)

where σSOBS
is the ﬂux error and NALMA is the number
of ALMA data points. Therefore, we consider all pos-
sible prior-z’s for a given galaxy and ﬁt each of them
before choosing the ﬁt with the lowest χ2
as the
ﬁnal best ﬁt. 23

ALMA

ALMA

The ﬁnal values of χ2

are generally well behaved.
In Fig. 22, we compare the diﬀerence between SSED and
SOBS at all available ALMA bands for each galaxy. The
median of SSED − SOBS for all total ﬂux S/N
total > 3
ALMA photometry is consistent with being zero, sug-
gesting that MAGPHYS ﬁtting has no obvious sys-
tematic over or underestimation of the ﬂux. There
are about 25% of data points with S/N
total < 3 (but
meets our sample selection criterion) which are
S/N
shown as 3-σ upper limits, and 60% of them are con-
sistent with the SED ﬂux (being above the one-to-one
line). The histogram of log
(SOBS/SSED) in the lower
10
panel is ﬁtted with an 1D Gaussian with µ = −0.01
and σ = 0.05.
Its upper 5-σ envelope corresponds to
SOBS/SSED = 1.77, above which we do ﬁnd 3% outliers.
Most of these “SED-excess” outliers have low total ﬂux
S/N (i.e., S/N
total < 4 − 5 as indicated by the color-
coding in Fig. 22).

peak

peak

We speculate that the outliers are most likely spuri-
ous sources boosted by noise which by chance align with
their optical/near-IR counterparts and are thus not re-
moved by our earlier counterpart association step. Since
their S/N
pass our previous sample selection crite-
rion, they tend to be large in angular size. And this
number is actually supported by the statistics: we ex-
pect (cid:46) 12% ((cid:46)140) spurious sources due to our S/N
peak
selection in Sect. 4.1, which is then reduced by ∼ 4%
by our counterpart association examination in Sect. 4.2.
Meanwhile, we have ∼130,000 master catalog sources
within the current dataset totaling 946 arcmin2 regard-
less of primary beam areas (∼23,000 within primary

23 We treat spec-z’s the same as photo-z’s, except that only
when the χ2
ALMA of a ﬁtting at a spec-z is at least a factor of
1.5 worse than that ﬁtted at a photo-z do we discard the spec-z
ﬁtting.

Fig. 21. Comparison between literature photometric and
spectroscopic redshifts available for our galaxy sample. Red-
shifts from various studies in the literature: Davidzon et al.
(2017); Delvecchio et al. (2017); Salvato et al. (2011) and
the M. Salvato et al. compilation catalog of spectroscopic
redshifts are plotted against the photometric redshifts from
Laigle et al. (2016). Each data point represents a master cat-
alog source that has a counterpart in the second respective
catalog (see Sect. 4.3 footnote 20 for the cross-matching).
Solid orange circles indicate sources with robust spectro-
scopic redshifts (≥ 2 spectral features);
low quality spec-
troscopic redshifts with only one spectral feature are shown
as open orange circles. From the set of sources with photo-
metric redshifts in Davidzon et al. (2017), we highlight those
that have a consistent second probability peak in redshift in
the Laigle et al. (2016) catalog by a white cross inside the
black circle (mostly around redshift 4 in Laigle et al. (2016)
catalog). The solid line presents the one-to-one relation, and
the dashed gray lines indicate ±0.15 × (1 + z) catastrophic
errors (e.g., Laigle et al. 2016, Sect. 4.3).

4.4. SED ﬁtting
We use MAGPHYS (da Cunha et al. 2008, 2015) 22
for the SED ﬁtting, as it has rich stellar SED libraries
and has been widely tested on local and high-redshift
galaxies (e.g., Smith et al. 2012; Berta et al. 2013; Row-
lands et al. 2014b,a; Smith & Hayward 2015; Hayward &
Smith 2015; Smolčić et al. 2015; Miettinen et al. 2017a,b;
Delvecchio et al. 2017; Hunt et al. 2019). It assumes an
energy balance between the energy attenuated by dust
in the UV/optical and that radiated by dust at IR/mm
wavelengths. As it is debated whether this energy bal-
ance is still robust for very dusty galaxies (e.g., Simpson
et al. 2017; Casey et al. 2017), we provide some support-

22 http://www.iap.fr/magphys/

0123456zLaigle+201601234567zcompared(seelabel)Davidzon+2017Delvecchio+2017 radioSalvato+2011 X-raySalvato+ spec-zconsistent with Laigle+2016 second zpeaklow quality spec-z28

D. Liu et al.

beam areas, which sum up to 164 arcmin2); so we expect
a false-match probability of 3% with a matching radius
of 0.500 (Eq. 1 of Pope et al. 2006), i.e., only ∼4 spurious
sources to coincide with some prior sources by chance
alignment.

However, we note that there is also a chance that there
is an unidentiﬁed ALMA source at the same line-of-
sight as the foreground prior source thereby boosting
the ALMA ﬂux to much higher than what SED could
ﬁt. These SED-excess outliers are rare but do exist, e.g.,
the z ∼ 5.7 background ALMA source “CRLE” found
by Pavesi et al. (2018), which is not in any optical/near-
IR/radio catalog but is at the same line-of-sight with a
foreground z ∼ 0.3 galaxy in the Laigle et al. (2016)
catalog.

Similar to the counterpart association ﬂagging, we ﬂag
21 sources as SED-excess outliers. They are indicated
by the Flag_outlier_SED column in our ﬁnal galaxy
catalog, and will no longer be considered in our further
scientiﬁc analysis.

Furthermore, in order to verify whether doing a com-
pletely blind photometric redshift scan could lead to
better ﬁts (smaller χ2) or not, we adopt the recently
developed photo-z version of the MAGPHYS code
(MAGPHYS+photo-z; A. Battisti et al.
in prep.).
It considers redshift as a free parameter between z=0
and 8 and generates identical libraries to the original
version of MAGPHYS for each redshift. The output
of this step is a probability distribution function (PDF)
of the photometric redshift. We perform this photo-
z ﬁtting for all our sources and compare the best-ﬁt
redshifts (derived as the median of the PDF) to avail-
able spectroscopic redshifts, ﬁnding no obvious system-
atic oﬀset (an 1D Gaussian ﬁtting to the distribution
of (zphoto. − zspec.)/(1 + zspec.) gives µ = −0.015 and
σ = 0.045). The comparison with all prior-z also shows
no obvious systematic oﬀset (an 1D Gaussian ﬁtting to
the distribution of (zphoto. − zprior.)/(1 + zprior.) gives
µ = 0.000 and σ = 0.076).

Comparing the physical properties obtained from the
two SED ﬁtting for common sources, we ﬁnd a me-
dian diﬀerence (scatter) of 0.0 dex (0.05 dex) and 0.0 dex
(0.04 dex) for log M∗ and log SFR, respectively. How-
ever, we do note that the uncertainties in log M∗ and
log SFR are systematically larger in photo-z SED ﬁtting
when the uncertainties in redshift are included. (The
histogram of the diﬀerence in uncertainty has a median
of 0.0 dex but has a second peak at 0.2 dex and extends
to 0.4 dex.) Therefore, for log M∗ and log SFR in our
ﬁnal galaxy catalog, we take the uncertainties from the
photo-z SED ﬁtting which includes the redshift uncer-

tainty, while keep the best-ﬁt values still from the best
prior-z ﬁt.

In this photo-z experiment, we also tested the photo-z
of the SED-excess outliers, ﬁnding that for 7 of them the
photo-z are between z=2–4 whereas the prior-z’s are be-
low z=1, while the remaining 14 have photo-z and prior-
z consistent with z=0–2. Note that the MAGPHYS
photo-z ﬁtting places more weight on the stellar SED
when the optical/near-IR bands have more data points
than the FIR/mm bands. Thus these SED-excess out-
liers will still show an excess in their observed ALMA
ﬂuxes relative to the SED predicted ﬂux. Given their
unreliable photo-z’s, such sources will beneﬁt from a
better FIR/mm coverage as will be available from future
submm/mm surveys like JCMT/SCUBA2 S2COSMOS
(at 850 µm; PI: I. Smail), STUDIES (at 450 µm; PI: W.
Wang), IRAM 30m/NIKA2 Cosmology Legacy Survey
(N2CLS; at 1 & 2 mm; PI: G. Lagache), and the LMT/-
TolTEC Ultra-Deep Galaxy Survey (at 1 & 2 mm).

4.5. Correcting signiﬁcant contribution from emission

lines

In sensitive (sub-)mm observations like the major-
ity of the ALMA observations in the COSMOS ﬁeld,
strong (sub-)mm spectral lines like [C ii], [N ii] and high-
J CO emission from high-redshift galaxies can strongly
bias the dust continuum measurement if they are bright
enough and fall in the bandwidth of the spectral setup 24.
In special cases, these lines will dominate the emission
from the whole bandwidth, e.g., mostly ∼8 GHz of the
current ALMA receiver. This is more signiﬁcant in
the lower frequency 3mm observations, and will become
more critical in the future with even deeper observations
from ALMA and for the large surveys mentioned in the
previous section.
It is therefore necessary to consider
strong submm/mm line emission together with the dust
continuum in photometry pipelines. Although when the
observation is not intended for line detection, the chance
of a strong emission line being in the bandwidth is very
low (e.g., ∼ 1.6%, from the blind [C ii] line search work
by Cooke et al. 2018 who found 10 line emitters out
of 695 ALMA continuum sources), but when the num-
ber of sources becomes large as in this and future works
(with automated pipelines), the line emitters must be
systematically corrected for.

24 For example, ALMA can detect [C ii]

from a SFR (cid:46)
50 M(cid:12) yr−1, z ∼ 5 galaxy with (cid:46) 30 min on-source time (Ca-
pak et al. 2015; or only ∼ 2 min if SFR ∼ 1000 M(cid:12) yr−1; Swin-
bank et al. 2012; Cooke et al. 2018), or high-J CO lines from a
SFR ∼ 500 M(cid:12) yr−1, z ∼ 1.5 galaxy with (cid:46) 30 min on-source time
(Silverman et al. 2015b).

A3COSMOS photometry & catalogs

29

also in an inhomogeneous dataset. Given the small frac-
tion of potentially aﬀected sources of 7% (see below),
our adopted approach is suﬃcient for our purpose.

Our pipeline uses the redshift and SFR (and IR color,
e.g., rest-frame S70 µm/S160 µm from SEDs, when nec-
essary) to predict for each source the low- to high-J
CO (upper level quantum number 2 ≤ Jupper ≤ 10),
[C i] 3P2 →3 P1 and 3P1 →3 P0 (at rest-frame 370 and
609 µm respectively), [N ii] 3P2 →3 P1 and 3P1 →3 P0
(at rest-frame 122 µm and 205 µm respectively) and
[C ii] 2P3/2 →2 P1/2 (at rest-frame 158 µm). We do not
account for other lines in this work because those are
predicted to fall outside the frequency range or are gen-
erally much weaker. The line prediction follows empiri-
cal luminosity–luminosity correlations: [C ii]–LIR corre-
lation from De Looze et al. (2011), with a [C ii] deﬁcit
roughly proportional to L−0.335
when LIR > 1010 L(cid:12)
IR
which ﬁts the data best; [N ii]–LIR correlation from Zhao
et al. (2013, 2016); CO(1-0)–LIR correlation from Sar-
gent et al. (2014); high-J (Jupper ≥ 4) CO–LIR corre-
lation from Liu et al. (2015); and [C i]–LIR correlation
based on the data sets in Liu et al. (2015) and Valentino
et al. (2018). For CO 2 ≤ Jupper ≤ 3 lines, we interpo-
late the line luminosity using the the CO(1-0)–LIR and
CO(4-3)–LIR correlations.

Meanwhile, we obtain the exact frequency setups for
each ALMA observation from the ALMA archive, and
identify the predicted strong (sub-)mm lines within the
frequency setups. We estimate the line contribution
to the measured continuum by dividing the predicted
line ﬂux by the total bandwidth and compare that to
the measured continuum. Our prediction suggests that
∼50 (∼ 7%) sources have (sub-)mm lines contribut-
ing more than 20% to the measured continuum. We
looked into their data cubes and found that most of
them do have line emission as predicted, as all except
four have accurate redshift from the M. Salvato spec-
troscopic redshift compilation. A strong emission line
is predicted but not found to be present for only three
sources with spectroscopic redshift (A3COSMOS mas-
ter catalog IDs 1236908, 350733 and 418763) and two
with photometric redshift (IDs 339509 and 1236904).
Interestingly, two sources (IDs 990180 and 861198) with-
out spectroscopic redshifts from the M. Salvato compi-
lation do show a line detection, and their spectroscopic
redshifts are also reported in the literature (Lee et al.
2017; Cassata et al.
in prep.). More details of the
A3COSMOS line search work will be presented in future

Fig. 22. Upper panel: Comparison of MAGPHYS SED-
predicted (SSED) and observed ﬂuxes (SOBS; already cor-
rected for ﬂux bias and error based on our simulation in
Sect. 3.1.5) at all available ALMA photometric bands for
each galaxy in our sample (Sect. 4.1; removed spurious
sources/outliers in Sect. 4.2). Color indicates the S/N of
the measured total ALMA ﬂux. Arrows are the 3σ upper
limits for sources with total ﬂux S/N < 3. The dashed line
shows the one-to-one relation and the dotted line indicates
the 5-σ threshold derived from the histogram in the lower
panel. Lower panel: Histogram of log10(SOBS/SSED) for
sources with a total ﬂux of S/N ≥ 3 (i.e., excluding upper
limits). The dashed curve shows the best-ﬁt 1D Gaussian.
The vertical dotted lines indicate the 5σ range. We identify
sources outside the 5σ range (i.e., SOBS/SSED > 1.77) as
“SED-excess” outliers (see text for details).

As our continuum images are obtained by directly
collapsing all channels of all spectral windows ignoring
whether the PI intended a line detection or not, a strong
(sub-)mm emission line could potentially “contaminate”
the measured continuum ﬂux. Therefore we developed
a pipeline to automatically identify such cases and to
apply a ﬁrst rough correction for these lines. Direct
blanking of channels aﬀected by line emission before con-
struction of the continuum image would require either
a good a-priori knowledge of the redshift or dedicated
line searches (that are not part of this project) as well
as special treatment of each source present in a single
pointing. Both aspects not only result in a signiﬁcant
increase in data volume and analysis time required but

0.010.1110100SSED [mJy]0.010.1110100SObs [mJy]45678910ALMA S/N0.50.00.51.01.52.0log(SOBS/SSED)110100N5outliers:SOBS/SSED>1.7730

D. Liu et al.

papers. Here we have measured those (sub-)mm lines 25
to verify our prediction, and the comparison is presented
in Fig. 23 where solid symbols are these A3COSMOS
sources. Their measured line luminosity (x-axis) and
predicted line luminosity (y-axis) show good agreement
(the dashed lines indicate a factor of 2 range). The
pipeline also predicts < 20% line contributions for more
sources, but as these lines could not be measured at suf-
ﬁcient S/N in the data cube, they are omitted from the
ﬁgure.

In Fig. 23, we added 234 line detections with S/N > 3
for CO, [C i], [C ii] or [N ii] from the literature as follows:
Albrecht et al. (2007); Baan et al. (2008); Bauermeis-
ter et al. (2013); Bertemes et al. (2018); Capak et al.
(2015); Carilli & Walter (2013); Daddi et al. (2015);
Lee et al. (2017); Magdis et al. (2017); Magnelli et al.
(2012); Pavesi et al. (2018); Saintonge et al. (2017); ?);
Spilker et al. (2018); Tacconi et al. (2013); Tan et al.
(2014); Yao et al. (2003). SFRs from these works and
in addition from Sanders et al. (2003) and Brinchmann
et al. (2004) are used for our line prediction. The
) has a
distribution of log
mean of 0.07 and scatter of 0.27. Some disagreement
can be found at the lowest end where line luminosity
line, observed ∼ 108 K km s−1 pc2. As our current data
L0
do not cover this faint regime, improvement is postponed
to a future work.

line, observed/L0

line, predicted

(L0

10

After the correction for strong (sub-)mm line “con-
tamination”, we reiterate over the SED ﬁtting step.
Note that in Fig. 22 the data points represent already
the ﬁnal continuum ﬂuxes corrected for line contamina-
tion.

4.6. Obtaining galaxy properties from SED ﬁtting
From MAGPHYS SED ﬁtting, we obtain the follow-
ing galaxy properties: stellar mass (M∗), mass-weighted
stellar age, V -band attenuation AV , star formation his-
tory (SFH) integrated SFRSFH, and total IR luminosity
LIR (integrated over 8–1000 µm). For each property,
MAGPHYS gives a minimum-χ2 (i.e., best-ﬁt) value,
as well as the median and the lower and upper 68th per-
centiles of the PDF.

Our ﬁnal SFRs are computed from the IR luminosity
with the Kennicutt (1998) calibration and assuming a
Chabrier (2003) IMF:

SFRIR
[M(cid:12) yr−1]

= LIR, 8−1000µm
[L(cid:12)]

× 10−10

(10)

25 The line search is done in the uv-plane adapting the method-
(2019, in

ology of Silverman et al. (2015b) and D. Liu et al.
preparation), with CASA and GILDAS.

Fig. 23. Comparison of predicted and observed (sub-)mm
molecular/atomic line luminosities for a large sample of
galaxies with available CO, [C i], [C ii] or [N ii] luminosity
and SFR or IR luminosity in the literature and from this
work. This ﬁgure veriﬁes our line prediction pipeline which
corrects the measured ALMA continuum ﬂux for the emis-
sion line “contamination” (see description in Sect. 4.5). Color
and symbol indicate diﬀerent emission lines. Solid symbols
are ∼50 sources which have (sub-)mm lines contributing to
their measured continuum ﬂux by more than 20% by our pre-
diction. We inspected their data cubes and extracted their
(sub-)mm lines and therefore compared to the prediction.
Open symbols are 234 galaxies with CO, [C i], [C ii] or [N ii]
detections with S/N > 3 in the literature (see references in
Sect. 4.5). The dashed line is a one-to-one line, and the thin
dotted lines indicate a factor of 2 scatter.

10

log

By comparing SFRSFH and SFRIR, we ﬁnd that the
distribution of
(SFRIR/SFRSFH) has more pro-
nounced wings than an 1D Gaussian, with a mean of
0.14 and a standard deviation of 0.15. As mentioned in
Kennicutt (1998), the calibration of SFRIR is based on
the starburst synthesis models of Leitherer & Heckman
(1995) assuming a constant SFH with a young age of
10–100 Myr (in which time the bolometric luminosity-
to-SFR ratio is relatively constant), and assuming that
dust re-radiates all the bolometric luminosity. The dif-
ference between SFRIR and SFRSFH could thus come
from either the actual ﬁtted SFHs, the fraction of bolo-
metric luminosity re-radiated by dust, the variation of
bolometric luminosity-to-SFR ratio with stellar popula-
tion ages, or other additional eﬀects. In the following
analysis, we will use SFRIR (and hereafter SFR) be-
cause the simple Kennicutt (1998) calibration is widely
used in studies focused on the dusty galaxy population
at high redshift and given the fact that our sample is
biased toward massive, dusty galaxies at high redshift.
Through a detailed simulation and recovery study,
Hayward & Smith (2015) tested the accuracy of MAG-

10810910101011L0line,observed[Kkms−1pc2]10810910101011L0line,predicted[Kkms−1pc2]CO(2-1)CO(3-2)CO(4-3)CO(5-4)[Cii]158µm[Ci](1-0)[Nii]205µmA3COSMOS photometry & catalogs

31

We try to assess the mid-IR AGN problem by running
MAGPHYS twice, one time including and the other
time excluding the mid-IR 24 µm ﬂux information. Then
we adopt the ﬁt with the smaller χ2 as our ﬁnal best ﬁt.
The ﬁtting excluding the 24 µm data usually leads to a
better χ2. The overall diﬀerence between the derived
IR luminosity is very small: the distribution of the dif-
ference in log
10 LIR between the two SED ﬁtting results
has a median of 0.0 dex and sigma of 0.17 dex. This
distribution is slightly broadened to a sigma of 0.25 dex
for the AGN subsample, but the median is still close
to zero. About 20 sources are 3-sigma outliers, but for
most cases the diﬀerence is caused by low S/N data at
the FIR/mm wavelengths. Only 4 of them are AGNs
according to the Delvecchio et al. (2017) classiﬁcation.
In Fig. 24 we further compare our ﬁnal M∗ to the
Delvecchio et al. (2017) SED3FIT ﬁtted M∗ for 396
sources in common (with consistent redshifts and coor-
dinates). AGNs are highlighted in red. This demon-
strates a good agreement (within 3σ). We ﬁnd ﬁve out-
liers (labeled with 1-4 if our M∗ larger and “a” if our
M∗ is smaller) exceeding the 3σ envelope of the distri-
bution. Their corresponding A3COSMOS master cat-
alog IDs and Delvecchio et al. (2017) IDs are listed in
the ﬁgure. Through detailed inspection, we ﬁnd that
the diﬀerence is mainly caused by including the ALMA
data in the SED ﬁtting, which leads to a higher dust
attenuation and thus higher stellar mass.

10

(M∗/M(cid:12)) = 11.65+0.35
−0.35

In addition, the source shown with the highest stel-
lar mass of ∼ 1012 M(cid:12) (ID 223951) in Fig. 24 is the
strong AGN XID2028 at z = 1.593 studied by Brusa
et al. (2015), Cresci et al. (2015), Perna et al. (2015)
and Brusa et al. (2018). Brusa et al. (2018) estimated a
via optical-
stellar mass of log
to-mm SED ﬁtting including an AGN component. For
comparison, we obtain log
(M∗/M(cid:12)) = 12.28 ± 0.07,
10
almost consistent with their upper boundary. Interest-
ingly, the reduced-χ2 at the stellar wavelengths of our
MAGPHYS SED ﬁtting is as poor as for the outliers
2 and 3 with a rchi2_star ∼ 6.8 (top ∼10% of the
worst ﬁts). Delvecchio et al. (2017) accounting for mid-
(M∗/M(cid:12)) = 12.12
IR AGN contamination obtain log
(with an uncertainty of the order of 0.1 dex, see their
Sect. 6.1). This indicates that our estimate is still ac-
ceptable for such an extreme case (although they should
be treated with caution in individual studies).

10

To summarize our detailed comparison of the robust-

ness of the derived parameters for AGNs, we ﬁnd:

(1) Our current multi-run, iterative MAGPHYS SED
ﬁtting, although without an AGN component,
achieves in general good agreement with SED ﬁt-
ting that includes an AGN component. The agree-

Fig. 24. Comparison of our ﬁnal M∗ from the multi-run
MAGPHYS SED ﬁtting and those of Delvecchio et al. (2017)
who used SED3FIT to account for the mid-IR AGN compo-
nent. AGNs classiﬁed by Delvecchio et al. (2017) are high-
lighted in red. Four sources have highly overestimated M∗
by our method (labeled 1, 2, 3 and 4), while one sources ex-
hibits a signiﬁcantly underestimated M∗ (labeled a). Their
corresponding A3COSMOS master catalog ID (and Delvec-
chio et al. 2017 ID_VLA3 in brackets) are listed. They are
discussed in Sect. 4.6. The dashed line is the one-to-one re-
lation and the dotted lines indicate the ±3σ range (with σ
being the standard deviation).

PHYS in recovering galaxies’ physical properties. They
found that for isolated disk galaxies, MAGPHYS recov-
ers well the physical properties above mentioned. How-
ever, for galaxy mergers, there might be some bias in the
determined dust masses (Hayward & Smith (2015) found
that MAGPHYS underestimates by 0.1–0.2 dex [and up
to 0.6 dex] the dust mass during the post-starburst phase
of a galaxy merger). Therefore, we do not provide dust
masses in our ﬁnal catalog and defer this to later work
(our Paper II).

Hayward & Smith (2015) also found that for AGN
host galaxies, when the AGN does not signiﬁcantly con-
tribute to the UV–mm luminosity (e.g., < 25%), the
absence of a mid-IR AGN component in MAGPHYS is
not signiﬁcantly aﬀecting the best-ﬁt results. However,
stronger mid-IR AGNs can lead to an overestimation of
stellar mass and SFR. In our ﬁnal sample (after remov-
ing outliers in Sect. 4.2 and 4.4), 34 galaxies are AGN
hosts in the Salvato et al. (2011) XMM-Newton catalog
and 48 are in the Salvato et al. (2011) Chandra catalog.
Meanwhile, 112 are classiﬁed as AGNs via SED ﬁtting
with an AGN component using SED3FIT (Berta et al.
2013) by Delvecchio et al. (2017). These catalogs have
overlaps, thus the ﬁnal number of AGNs is 158 (∼23%).

89101112logM,Delvecchio+201789101112logM,thiswork3- outliers:1: 767332 (4136)2: 951838 (748)3: 813955 (6343)4: 422662 (4693)a: 842140 (1882)AGNs1234a32

D. Liu et al.

ment is valid even for the AGN population iden-
tiﬁed in Delvecchio et al. (2017) and is within the
uncertainties even for the most extreme AGNs,
e.g., reported in Brusa et al. (2018).

(2) For very few (5 out of 396) sources our stellar
masses lie outside the 3σ range when comparing to
the Delvecchio et al. (2017) stellar masses. Three
of them exhibit strong mid-IR AGN emission con-
taminating near-IR IRAC and even optical bands.
Thus their stellar SEDs are poorly ﬁtted, with
rchi2_star (cid:38) 10. These extreme outliers are fur-
ther discussed in Appx. E. Their stellar mass esti-
mates in this work should be treated with caution
when used in individual studies.

(3) The inclusion of ALMA (and far-IR/(sub-)mm)
data points is crucial for codes like MAGPHYS
which assumes energy balance.
If the energy
balance is valid for these dusty, ALMA-detected
sources studied here, our stellar masses and IR lu-
minosities are more reliable than optical-only es-
timates.

4.7. Final Galaxy Catalog and Properties
Our ﬁnal “robust galaxy catalog” contains 676 galax-
ies with reliable stellar mass and SFR properties, from
a parent sample 823 galaxies with at least one ALMA
detection in 1534 ALMA archive images (from 142
ALMA projects) available for the COSMOS ﬁeld (ver-
sion v20180201).
In this catalog, 56% of the galaxies
have a primary beam correction factor < 1.01 (cor-
responding to a 2” oﬀset from the phase center at
230 GHz), i.e., they are the primary targets of the PI-led
observations. We caution that due to the selection func-
tions of the PI-led ALMA observations in the archive,
our sample is not complete in any quantity, e.g., cosmic
comoving volume, stellar mass, and SFR. This bias ex-
ists even for sources away from the phase center because
galaxies suﬀer from clustering eﬀects, and also the input
coordinates for single-dish-selected sub-mm galaxies are
uncertain (possibly resulting in a few arcsec oﬀset from
the phase center). Bearing these limitations in mind,
we show the redshift, stellar mass and SFR properties
of our galaxy catalog in this section and compare with
known galaxy correlations and population properties in
the literature.

In Fig. 25 we show the distributions of their SFRs
and speciﬁc SFRs (hereafter sSFR, which is deﬁned as
sSFR ≡ SFR/M∗, in units of Gyr−1) versus redshift.
Our sample spans a large range of SFR from ∼1 to
∼2000, but the main portion of the sample is SFR-
limited at z > 1 with SFR ∼ 100 − 1000.

The low number of z < 1 galaxies is mainly due to the
selection function, the quick drop of ﬂux density at the
Rayleigh-Jeans tail in a galaxy’s redshifted SED, and the
rapid decline of the cosmic SFR density at z < 2 (e.g.,
Madau & Dickinson (2014); Liu et al. 2018). Further-
more, given the smaller volume sampled at low redshift,
lower source density as well as cosmic variance could
play a role as well. Therefore at z < 1, our sample
is very diﬀerent from far-IR selected samples (e.g., see
a Herschel sample in Liu et al. 2018 Fig. 23; see also
Béthermin et al. 2015; to name a few). Several z < 1
galaxies in our sample are strongly biased toward less
massive systems (e.g., log
10 M∗/M(cid:12) < 10.5) but also
relatively low SFR, and they all have low ALMA S/Ns
(total ﬂux S/N ∼ 4 − 5). Although they passed our
rigorous spurious source examinations, they could sta-
tistically still be spurious. Should they be real, they are
of interest in their own right. However, given these un-
certainties, we recommend treating these galaxies with
caution, especially for individual studies.

10

In Fig. 26, we show for our A3COSMOS galaxies the
distribution of their stellar masses and their SFR oﬀsets
to the SFRMS expected for star-forming MS galaxies
(∆MS ≡ log
(SFR/SFRMS)), where the MS SFRMS is
deﬁned as a function of redshift and M∗ and is empiri-
cally measured by a number of works from z ∼ 0 (e.g.,
Brinchmann et al. 2004; Chang et al. 2015) to ∼ 4 (e.g.,
Speagle et al. 2014; Sargent et al. 2014; Schreiber et al.
2015; Béthermin et al. 2015; Pearson et al. 2018). Here
we adopt the Speagle et al. (2014) MS (the #49 model
in their Table 7).

The majority of our sample lies on the MS (i.e., their
sSFRs are within a factor of 4, or equivalently ±0.6 dex,
of the sSFRMS; Rodighiero et al. 2011). However, less
massive galaxies tend to be above the MS. This strong
anti-correlation between M∗ and ∆MS is primarily an
eﬀect of detection limit/sample selection and is more
evident in Fig. 27, where the M∗ versus SFR are plotted
for A3COSMOS galaxies in nine redshift bins ranging
from z = 0.35 − 5.5, overlaid with four empirical MS
parameterizations from Speagle et al. (2014); Sargent
et al. (2014); Schreiber et al. (2015) and Béthermin et al.
(2015). The diﬀerences between these MSs are relatively
small (but see S. Leslie et al. 2019, submitted, for a
detailed comparison)

The fraction of sources classiﬁed as starbursts indi-
cates that our ALMA catalog is biased toward star-
bursts.
It is roughly constant at ∼ 20% in our cata-
log at each redshift in Fig. 27. But this is a factor of
2–5 higher than that from a Herschel-selected sample,
e.g., Liu et al. (2018), and much higher than that from
a mass-complete sample. For example, Rodighiero et al.

A3COSMOS photometry & catalogs

33

Fig. 25. Distribution of SFR (left) and speciﬁc-SFR (sSFR) (right) versus redshift. Empirical evolution curves of the star-
forming main sequence at diﬀerent stellar masses (log10(M∗/M(cid:12)) = 9.5, 10.5 and 11.5, respectively) are shown as blue, green
and red dashed lines, which are computed as a function of redshift and M∗ following Speagle et al. (2014) (the #49 model in
their Table 7). The color bar indicates log10 M∗ in both panels.

Fig. 26. Stellar mass M∗ (left) and main sequence oﬀset ∆MS ≡ log10(SFR/SFRMS) (right) versus redshift, where the main
sequence SFR SFRMS is computed as a function of redshift and M∗ for each source following Speagle et al. (2014) (the #49
model in their Table 7). The color bars indicate ∆MS and log10 M∗ in the left and right panels, respectively. The dashed blue
line represents ∆MS = 0 in the right panel.

(2011) ﬁnd with a starburst fraction of 2%–3% for a sam-
ple complete down to M∗ = 1010 M(cid:12) at 1.5 < z < 2.5;
and Schreiber et al. (2015) report 2–4% for a sample
complete down to M∗ = 2 × 1010 M(cid:12) and is constant up
to z = 4. Fig. 27 further shows that it is mainly the less-
massive range within which our catalog is dominated by
starbursts (e.g., M∗ < 1010.5 M(cid:12)).

Finally, in Fig. 28, we compare the M∗ histogram of
our sample to the SMFs of star-forming galaxies (Ilbert
et al. 2013; Muzzin et al. 2013; Davidzon et al. 2017;
Grazian et al. 2015; Song et al. 2016), corresponding to
the area of full 2 deg2 COSMOS ﬁeld. The complete-
ness of our sample to the full star-forming galaxy pop-

ulation, which can be considered as the fraction of the
M∗ histogram to the SMFs, strongly depends on redshift
and stellar mass. Although the area covered by all the
ALMA archival pointings is only about 164 arcmin2 (or
only 4.2% of the full 2 deg2 area of COSMOS), our sam-
ple at z ∼ 1−3 probes a signiﬁcant fraction (∼ 10−100%
depending on the used SMF and redshift bin) of all very
massive (log
10 M∗ > 11.5) star-forming galaxies present
in the full 2 deg2 area.

Due to the large variety of ALMA programs contribut-
ing to out dataset, we ﬁnd no obvious diﬀerences be-
tween sources at the phase center and in the outer area,
even out to a PBA of 0.2. The sample selection bias

0123456Redshift0.11101001000104105SFR / [Myr1]Speagle+2014 SFRMS(logM=11.5)Speagle+2014 SFRMS(logM=10.5)Speagle+2014 SFRMS(logM=9.5)9101112log(M/M)0123456Redshift0.1110100sSFR / [Gyr1]9101112log(M/M)0123456Redshift8910111213logM / [M]101MS0123456Redshift1.51.00.50.00.51.01.52.02.5MSlog(SFR/SFRMS(z,M))On the Speagle+2014 MS9101112log(M/M)34

D. Liu et al.

Fig. 27. SFR vs. M∗, i.e., the star-forming MS diagram, in nine redshift bins from z ∼ 0.35 − 5.5. Galaxies on the MS and
starbursts whose SFR is 0.6 dex above the empirical MS of Speagle et al. (2014) are shown as blue and red crosses, respectively.
Several empirical MSs from Speagle et al. (2014), Sargent et al. (2014), Schreiber et al. (2015) and Béthermin et al. (2015) are
shown for reference (see bottom right panel for information on the color coding).

is dominated by the range of sensitivities of the ALMA
data rather than the PIs’ targeted sources.

4.8. Properties of the source not included in the ﬁnal

robust galaxy catalog

As listed in Table 3, a signiﬁcant number (∼ 26%) of
ALMA detections are not included in our ﬁnal galaxy
catalog (see Table 3 caption b). Half of them come
from the prior-photometry catalog with most having
only IRAC 3.6 and 4.5 µm and/or VLA 3 GHz priors

without optical/near-IR (up to Ks-band) counterparts
(hence they do not have a photo-z as their prior-z).
These “Ks-dropouts” are potential very dusty z ∼ 3 − 4
galaxies or less dusty sources at even higher redshifts, i.e.
similar to the sample of Wang et al. (2016) and the HST -
dark sample of Franco et al. (2018). This is in particu-
lar true for the sources with signiﬁcant detections well
above our threshold. The remaining half comes from
the blind-photometry catalog and has typically low sig-
niﬁcance, implying that they could be spurious, as the

A3COSMOS photometry & catalogs

35

Fig. 28. Stellar mass histograms of our A3COSMOS sources compared to expected stellar mass distributions in nine redshift
bins from z ∼ 0.35 − 5.5. The A3COSMOS sources are selected within a 164 arcmin2 area covered by 1534 discrete ALMA
pointings. A3COSMOS star-forming main sequence galaxies and starbursts as distinguished in Fig. 27 are shown by blue and
red histograms, respectively. The colored lines (with line shading) are the stellar mass distributions of all star-forming galaxies
within the COSMOS 2 deg2 area for each redshift bin, computed with empirical stellar mass functions (SMFs) from (Ilbert
et al. 2013; magenta), (Muzzin et al. 2013; yellow), (Davidzon et al. 2017; dark green), (Grazian et al. 2015; cyan) and (Song
et al. 2016; light green). These SMFs are derived for star-forming galaxies; they have been expressed for a Chabrier IMF when
necessary, and convolved with typical stellar mass uncertainties (σM∗ ) as indicated by the labels in each panel, following Appx. A
of (Ilbert et al. 2013; except for Song et al. 2016, which is the directly observed SMF). The SMFs of Ilbert et al. (2013) and
Muzzin et al. (2013) are measured up to z ∼ 4, while the SMFs of Grazian et al. (2015) and Song et al. (2016) are measured at
z ∼ 4 − 6. Davidzon et al. (2017) SMF probes z ∼ 0.2 − 5.5 but does not fully cover the highest redshift bin, so we applied a
linear extrapolation.

diﬀerential spurious fraction strongly depends on the ac-
tual S/N (see Fig. 8).

As we do not have high spatial resolution optical/near-
IR imaging nor accurate photometric redshifts for these
sources, it is not possible to do similar counterpart as-
sociation or SED ﬁtting quality assessments to better
identify spurious ones. If we assume that the fraction
of spurious source is the same (about 10% based on our
quality assessment) for the sources we have done the
quality assessment (74% of the total ALMA detections)
and for those unable to perform a quality assessment

(26% of the total ALMA detections), then we also ex-
pect a small number of spurious source from the latter
sources. Adding the two together gives a total spuri-
ous fraction of ∼ 10.1%, in good agreement with the
statistics (∼ 8 − 12%).

Further discussion of these interesting sources is not
the focus of this work. Future deeper optical/near-IR
(up to Ks-band) observations, e.g., the new data release
of the UltraVISTA survey, will enable an analysis similar
to the one done here, so that they could be included in
the robust galaxy catalog in the future.

36

D. Liu et al.

4.9. The eﬀect of galaxy-galaxy gravitational lensing
The galaxy-galaxy gravitational

lensing has been
found to be signiﬁcant in several ALMA follow-up stud-
ies of brightest sub-mm galaxies over large areas, e.g.,
Negrello et al. (2010), Bussmann et al. (2013, 2015) and
Spilker et al. (2016). Empirically, the strong-lensing
cases (magniﬁcation µ > 2) therein exhibit the follow-
ing common features: (1) Very bright observed sub-mm
ﬂux, e.g., S870 µm (cid:38) 15 mJy for all the µ > 2 galaxies in
Bussmann et al. (2013, 2015) and Spilker et al. (2016).
(Although we note that lensing is not just limited to
the very brightest submillimeter objects but happens
at all ﬂux levels, see also below.)
(2) Bright optical
emission within 1–2” which belongs to a low-redshift
(usually z < 1) massive galaxy. (3) Usually two or more
sub-mm components at each side of the optical emission
or roughly distributed as an Einstein ring with ∼2” size.
We estimate the number of strongly lensed (µ > 2)
cases among our sub-mm galaxies to be very low as fol-
lows.

First, given the ﬂux distribution of our photome-
try catalogs, we only ﬁnd 0.2% sources with equivalent
S870 µm (cid:38) 15 mJy, i.e., four sources in current data set
(v20180102). Three of them have only very weak or no
optical emission in their 1–200 vicinity, while the fourth
one ID 180903 has a low-redshift (z = 0.347) optically
bright galaxy within 0.500 and has already been studied
in detail by Pavesi et al. (2018).
ID 180903 does not
exhibit multiple images as expected for strong lenses,
fully consistent with its magniﬁcation factor of only 1.09
Pavesi et al. 2018.

Second, considering the second feature of a close dis-
tance to a low-z galaxy, our prior source ﬁtting and
SED excess assessment can test for this: if the ALMA
ﬂux coming from our prior catalog is originating from
a lensed higher redshift galaxy, the SED ﬁtting with a
much lower redshift as the prior-z will not be able to ﬁt
the ALMA data and therefore be classiﬁed as a SED-
excess outliers (Sect. 4.4). Among the 21 SED-excess
outliers listed in Table 3, we searched for multiple sub-
mm images or distorted feature but found no obvious
lensed candidates, except for one case ID 650923 where
there are three optical components (z = 0.568 in Laigle
et al. 2016) surrounding the East and South sides of the
ALMA emission at a distance of ∼ 100 (although the
ALMA data has a beam of 1.500 × 1.000).

Third, there are no multiple sub-mm sources within
1-2” or sources being part of an Einstein ring. This
is based on visual
In addition, this
identiﬁcation.
is conﬁrmed through the comparison between prior-
and blind-extraction photometry, which can in princi-

ple identify sources with irregular multi-component mor-
phology.

Lastly, our low number of strongly lensed sources is
consistent with the analytic galaxy modeling of Béther-
min et al. (2017; see also Béthermin et al. 2012b). In
their modeling, 1.5 million galaxies are simulated from
redshift 0 to 10 within a light cone of 2 deg2, the same
area as the COSMOS ﬁeld. Their modeled galaxies fol-
low the clustering eﬀect matched to dark matter halos,
and strong- and weak-lensing eﬀects are modeled follow-
ing Hezaveh & Holder (2011) and Hilbert et al. (2007),
respectively. According to our galaxy sample properties,
we down-selected 3176 of their galaxies with the criteria
1 < z < 6, M∗ > 2 × 1010 M(cid:12) and SFR > 200 M(cid:12) yr−1
over the full 2 deg2. Among this subsample, only 16 have
µ > 2. Scaling to our galaxy catalog source number of
823, only three strongly (µ > 2) lensed sources are ex-
pected. Note that as discussed in Hezaveh & Holder
(2011), there remains signiﬁcant uncertainty in the es-
timation of the probability of lensed sources, e.g., the
assumed mass model for the lensing halos, the elliptic-
ity of lenses, etc.

Therefore, we conclude that strong lensing is not af-

fecting the properties of most of our galaxies.

5. DATA PRODUCTS
As the result of this work, we produce three public
catalogs: two photometric ones (blind-extraction and
prior-ﬁtting) and one galaxy catalog (with SED-derived
properties). We describe the columns in the ﬁrst two
catalogs in Table 4, and those in the third catalog in
Table 5.

The two photometric catalogs have most columns in
common, except that the prior photometry catalog has
information on the prior source (ID, ID_PriorCat and
Ref_ID_PriorCat columns), and some Flag_* columns
diﬀer.

The ID column lists the IDs in our A3COSMOS mas-
ter catalog which is a combination of 6+ prior catalogs
after solving source cross-matching (Sect. 2.3). The ID
equals to the COSMOS2015 (Laigle et al. 2016) cata-
log ID when ID ≤ 1182108. The ID_PriorCat column
lists the original IDs in those prior catalogs, so that
users of our prior photometric catalog can trace back
into the prior catalogs. The Ref_ID_PriorCat column
lists the reference rank number of the prior catalog in
Table 2, e.g., the COSMOS2015 (Laigle et al. 2016) cat-
alog has Ref_ID_PriorCat = 1, Smolčić et al. (2017)
catalog has Ref_ID_PriorCat = 5, etc. Note that this
reference number indicates in which catalog the source

A3COSMOS photometry & catalogs

37

is ﬁrst included, i.e., has no counterpart in all previ-
ous catalogs with smaller Ref_ID_PriorCat. Thus our
catalog does not contain the information of whether a
source with Ref_ID_PriorCat = 1 has a counterpart in
Ref_ID_PriorCat > 1 catalogs (but this information is
in our master catalog upon request). Also note that our
master catalog will be updated in the future with more
deeper prior catalogs; thus, we caution that the source
ID will be diﬀerent when a future updated master cata-
log is used.

The Flag_* columns carry important information
for quality assessment and should be taken into ac-
count when using the catalog for speciﬁc science appli-
cations. For the blind photometry catalog, Flag_multi
indicates whether the source is ﬁtted with multiple
Gaussian components or a single-Gaussian model by
PyBDSF. Flag_inconsistent_flux indicates whether
inconsistent ﬂuxes between prior-
the source has
ﬁtting and blind-extraction photometry catalog (see
Sect. 2.5 and Fig. 7) When Flag_multi = 1 and
Flag_inconsistent_flux = 1,
it is likely that the
source is a merger system or has a close companion in
the ALMA image, as shown in Appx. B. For the prior
photometry catalog, Galfit_reduced_chi_square in-
dicates the quality of the ﬁnal galfit source ﬁtting.
Flag_size_upper_boundary indicates whether the ﬁt-
ted source size reaches the upper boundary of 3.0 arcsec
we set in the photometry, in which case the source is
either blended or dominated by noise and should be
used with caution.

The ﬁnal galaxy property catalog also has two im-
portant ﬂags: Flag_outlier_CPA which indicates the
outliers from our counterpart association examination
(Sect. 4.2), and Flag_outlier_SED which indicates
the outliers with SED-excess from our SED ﬁtting
(Sect. 4.4). We recommend to only use galaxies with
both Flag = 0 for scientiﬁc analysis.

The catalogs are available from the COSMOS archive
at IPAC/IRSA and in electronic form from the journal.
Further, the ALMA continuum images are also provided
via the COSMOS archive.

6. SUMMARY
The growing information in the ALMA archive is
ideal for systematic exploitations of speciﬁc scientiﬁc
questions, such as the number and properties of high-
redshift galaxies detected in their (sub-)mm continuum
emission in selected cosmological deep ﬁelds. Given
the large number of observations already available in
for the COSMOS ﬁeld 1534 point-
the archive, e.g.

ings covering an area of 164 arcmin2 have been pub-
licly available since Jan. 2nd, 2018, we have developed
a highly automatic approach towards mining these data
(A3COSMOS — Automated ALMA Archive mining in
the COSMOS ﬁeld). Here we summarize our workﬂows
(Figs. 1 and 18) implemented to obtain quality con-
trolled (sub-)mm source catalogs based on two diﬀerent
identiﬁcation approaches as well as a catalog of galaxies
with (sub-)mm detections and reliable properties.

We present two (sub-)mm continuum source catalogs
from public ALMA archival data. For the source identi-
ﬁcation, the calibrated archival data were homogenously
imaged to provide a single continuum image with best
sensitivity (i.e. using all available bandwidth and nat-
ural weighting). The ﬁrst catalog is based on a blind
extraction using PyBDSF on the continuum images,
and the second catalog used prior positions from a mas-
ter catalog that combines sources detected in the op-
tical, IR and radio. Extensive simulations using two
mock samples with highly diﬀerent distributions in (sub-
)mm source properties provide robust information on
the completeness limits, spurious source fraction, ﬂux
boosting factors as well as uncertainties on the measured
quantities in both catalogs. In particular, we used these
simulations to reﬁne the widely used Condon (1997)
prescription for error estimation of radio continuum
sources. After further quality control steps, the ﬁnal
catalogs (version v20180201) contain 939 sources above
a peak ﬂux S/N
= 5.40 for the blindly detected
sources (with a cumulative spurious fraction of ∼ 8%)
and 1027 sources above a peak ﬂux S/N
= 4.35 for
the prior selected sources (with a cumulative spurious
fraction of ∼ 12%).

peak

peak

We combine the two (sub-)mm continuum source cat-
alogs to remove inconsistent-ﬂux outliers and use the
prior catalog to produce a single sample of high-redshift
galaxies with robust (sub-)mm detections by ALMA
(25% having more than one ALMA photometric mea-
surement usually at diﬀerent wavelengths) and mostly
homogeneously determined galaxy properties (stellar
mass, SFR). The construction included the develop-
ment of a sophisticated method to automatically qualify
counterpart associations with the (sub-)mm continuum
sources taking into account astrometric uncertainties
(both absolute and relative) as well as complex, diﬀering
source structure across wavelength. Further steps were
applied to remove spurious (sub-)mm continuum detec-
tions and/or sources with highly uncertain redshift in-
formation based on SED ﬁtting results. The ﬁnal galaxy
catalog (version 20180201) contains 676 galaxies in the
range of z = 0.25 − 5.67, M∗ = 3 × 107 − 1.9 × 1012 M(cid:12)
(Despite the vast
and SFR = 0.02 − 4000 M(cid:12) yr−1.

38

D. Liu et al.

ADS/JAO.ALMA#2013.1.00118.S,

ADS/JAO.ALMA#2013.1.00914.S,

ADS/JAO.ALMA#2015.1.00299.S,

ALMA#2013.1.00034.S, ADS/JAO.ALMA#2013.1.00092.
ADS/JAO.ALMA#
S,
2013.1.00151.S,
ADS/JAO.ALMA#2013.1.00171.S,
ADS/JAO.ALMA#2013.1.00208.S, ADS/JAO.ALMA#2013.
1.00276.S, ADS/JAO.ALMA#2013.1.00668.S, ADS/JAO.
ALMA#2013.1.00815.S, ADS/JAO.ALMA#2013.1.00884.
S,
ADS/JAO.ALMA#
2013.1.01258.S,
ADS/JAO.ALMA#2013.1.01292.S,
ADS/JAO.ALMA#2015.1.00026.S, ADS/JAO.ALMA#2015.
1.00055.S, ADS/JAO.ALMA#2015.1.00122.S, ADS/JAO.
ALMA#2015.1.00137.S, ADS/JAO.ALMA#2015.1.00260.
S,
ADS/JAO.ALMA#
2015.1.00379.S,
ADS/JAO.ALMA#2015.1.00388.S,
ADS/JAO.ALMA#2015.1.00540.S, ADS/JAO.ALMA#2015.
1.00568.S, ADS/JAO.ALMA#2015.1.00664.S, ADS/JAO.
ALMA#2015.1.00704.S, ADS/JAO.ALMA#2015.1.00853.
S,
ADS/JAO.ALMA#
ADS/JAO.ALMA#2015.1.00928.S,
2015.1.00862.S,
ADS/JAO.ALMA#2015.1.01074.S, ADS/JAO.ALMA#2015.
1.01105.S, ADS/JAO.ALMA#2015.1.01111.S, ADS/JAO.
ALMA#2015.1.01171.S, ADS/JAO.ALMA#2015.1.01212.
ADS/JAO.ALMA#
S,
2015.1.01590.S,
ADS/JAO.ALMA#2015.A.00026.S,
ADS/JAO.ALMA#2016.1.00478.S, ADS/JAO.ALMA#2016.
1.00624.S, ADS/JAO.ALMA#2016.1.00735.S. ALMA is
a partnership of ESO (representing its member states),
NSF (USA) and NINS (Japan), together with NRC
(Canada), MOST and ASIAA (Taiwan), and KASI
(Republic of Korea), in cooperation with the Republic
of Chile. The Joint ALMA Observatory is operated by
ESO, AUI/NRAO and NAOJ.

ADS/JAO.ALMA#2015.1.01495.S,

ADS/JAO.ALMA#2015.1.00861.S,

Facility: ALMA

number of star-forming galaxies presented in this work,
we caution that this catalog is not complete in cosmic
comoving volume, stellar mass or SFR.)

The latest versions of our catalogs are available from
the COSMOS archive at IPAC/IRSA 26 and in electronic
form.

D.L., P.L., and E.S. acknowledge support and fund-
ing from the European Research Council (ERC) under
the European Union’s Horizon 2020 research and inno-
vation programme (grant agreement No. 694343). S.L.
acknowledges funding from Deutsche Forschungsgemein-
schaft (DFG) Grant SCH 536/9-1. B.G. acknowledges
the support of the Australian Research Council as the
recipient of a Future Fellowship (FT140101202). Part
of this research was carried out within the Collabora-
tive Research Centre 956, sub-project A1, funded by
the Deutsche Forschungsgemeinschaft (DFG) – project
ID 184018867. We thank Annalisa Pillepich and the
Max Planck Computing & Data Facility for very helpful
computing cluster resources.

This paper makes use of the following ALMA data:
ADS/JAO.ALMA#2011.0.00064.S, ADS/JAO.ALMA#2011.
0.00097.S, ADS/JAO.ALMA#2011.0.00539.S, ADS/JAO.
ALMA#2011.0.00742.S, ADS/JAO.ALMA#2012.1.00076.
S,
ADS/JAO.ALMA#
ADS/JAO.ALMA#2012.1.00536.S,
2012.1.00523.S,
ADS/JAO.ALMA#2012.1.00919.S, ADS/JAO.ALMA#2012.
1.00952.S, ADS/JAO.ALMA#2012.1.00978.S, ADS/JAO.

ADS/JAO.ALMA#2012.1.00323.S,

26

a3cosmos/

https://irsa.ipac.caltech.edu/data/COSMOS/images/

A3COSMOS photometry & catalogs

39

Table 4. Columns in the two photometry catalogs

—

—

Prior

Prior

File
Prior

Units
—

Blind+Prior degree

Blind+Prior degree

ID in the Ref_ID_PriorCat-th prior

Description
A3COSMOS master catalog ID (version 20170426),
which equals Laigle et al. (2016) COSMOS2015 catalog
ID when ID ≤ 1182108.
The original
catalog.
The reference number of the prior catalog in which the
source is ﬁrst included (see Table 2).
The ﬁtted R.A. coordinate of the ALMA emission with
Gaussian source models, in equatorial coordinate in the
epoch of J2000.
Same as above but is Dec.
coordinate in the epoch of J2000.
The ﬁtted total ﬂux with Gaussian source models, cor-
rected for ﬂux bias and primary beam attenuation.
Error in Total_flux_pbcor, provided by photometry
pipelines based on Condon (1997) simulation statistics
and equations.
Error in Total_flux_pbcor, but estimated from our own
simulation statistics.
Primary beam attenuation factor.
ALMA 12 meter antenna’s primary beam FWHM size
at the observing frequency.
Blind+Prior mJy/beam Fitted ALMA continuum emission’s peak ﬂux, uncor-

Blind+Prior —
Blind+Prior

coordinate, in equatorial

Blind+Prior mJy

Blind+Prior mJy

Blind+Prior mJy

arcsec

rected for primary beam attenuation.

Blind+Prior mJy/beam Pixel rms noise in the continuum image.
Blind+Prior GHz

Column Name

ID

ID_PriorCat

Ref_ID_PriorCat

RA

Dec

Total_flux_pbcor

E_Total_flux_pbcor

E_Total_flux_sim_pbcor

Pbcor
Primary_beam

Peak_flux

RMS_noise
Obs_frequency

Obs_wavelength

Blind+Prior µm

Maj_beam
Min_beam
PA_beam

Image_file
Flag_multi

arcsec
Blind+Prior
Blind+Prior
arcsec
Blind+Prior degree

Blind+Prior —
—
Blind

Galfit_reduced_chi_square Prior

Flag_size_upper_boundary

Prior

—

—

Flag_inconsistent_flux

Blind+Prior —

Flag_outlier_CPA

Flag_outlier_SED

Prior

Prior

—

—

=

wavelength,

(2.99792458 ×

Observing frequency, i.e., the center frequency of all col-
lapsed spectral windows.
Observing
105)/ Obs_frequency.
Synthesized beam’s major axis FWHM size.
Synthesized beam’s minor axis FWHM size.
Synthesized beam’s position angle, zero means to the
North.
Image ﬁle name.
Flag = S (or M) means the source is ﬁtted with single
(or multiple) Gaussian component(s).
The reduced χ2 of galﬁt prior source ﬁtting, measured
from the residual image for each source with an aperture
of 1.0 arcsec in diameter.
Flag = 1 means the ﬁtted source major axis FWHM size
reaches the upper boundary of 3.0 arcsec and should be
used with caution.
Flag = 1 means the source has > 5 σ inconsistent total
ﬂuxes from our prior and blind photometry.
Flag = 1 means the source is ﬂagged as an outlier in our
counterpart association analysis (Sect. 4.2).
Flag = 1 means the source is ﬂagged as an outlier in our
SED ﬁtting analysis (Sect. 4.4).

40

D. Liu et al.

Table 5. Columns in the ﬁnal galaxy property catalog

Column Name Units

ID

RA

—

degree

degree
Dec
—
z
—
z_prior
Ref_z_prior —
M_star

M(cid:12)

L_dust
SFR

L(cid:12)
M(cid:12) yr−1

Description
A3COSMOS master catalog ID (version 20170426), which equals Laigle et al. (2016)
COSMOS2015 catalog ID when ID ≤ 1182108.
Fitted ALMA continuum emission’s R.A. with Gaussian source models, in the equatorial
coordinate in the epoch of J2000.
Same as above but is Dec., in the equatorial coordinate in the epoch of J2000.
SED best-ﬁt redshift from the list of prior redshifts in z_prior.
Prior redshifts (prior-z) in the literature, multiple values are separated by white spaces.
References of z_prior a.
Stellar mass from our SED ﬁtting at redshift z. Assumed Chabrier (2003) initial mass
function (IMF).
Infrared 8–1000 µm luminosity from dust from the same SED ﬁtting as above.
Star formation rate integrated from star formation history from the same SED ﬁtting as
above. Same IMF as above.
Speciﬁc SFR from star formation history, = SFR / M_star ×109.

Gyr−1

sSFR
a A3COSMOS_specz means the source has the spectroscopic redshift (spec-z) conﬁrmed in our A3COSMOS data cube analysis
with at least one S/N > 6 spectral line (Sect. 4.5; Liu et al.
in prep). Salvato2017_specz means the source has spec-z in
the COSMOS spec-z catalog compiled by M. Salvato et al. (available in the COSMOS collaboration; version 07SEP2017 with
103,964 rows). Salvato2011_Chandra_photoz means the source has photometric redshift (photo-z) (optimized for AGNs) in
Salvato et al. (2011) Chandra source catalog and the photo-z is inconsistent with any previous redshift (by > 0.15 × (1 + z)
diﬀerence, same condition afterwards). Salvato2011_XMM_photoz means the source has photo-z (optimized for AGNs) in Salvato
et al. (2011) XMM-Newton source catalog and the photo-z is inconsistent with any previous redshift. Laigle2016_photoz means
the source has photo-z in the COSMOS2015 catalog provided by Laigle et al. (2016) and the photo-z is inconsistent with any
previous redshift. Davidzon2017_photoz means the source has photo-z (optimized for z > 2.5 sources) in Davidzon et al. (2017)
catalog and the photo-z is inconsistent with any previous redshift. Delvecchio2017_photoz means the source has photo-z
(considered mid-IR AGN component) in Delvecchio et al. (2017) catalog and the photo-z is inconsistent with any previous
redshift. Jin2018_photoz means the source has photo-z (with far-IR/mm photometry) in Jin et al. (2018) catalog and the
photo-z is inconsistent with any previous redshift.

A3COSMOS photometry & catalogs

41

APPENDIX

A. ASTROMETRY ACCURACY BETWEEN PRIOR CATALOGS
Variations in the absolute astrometric calibration between diﬀerent catalogs can cause small, but noticeable oﬀsets
between source positions at diﬀerent wavelengths. As we use prior positions from sources selected from catalogs covering
the optical to radio regime, it is important to verify that potential oﬀsets are small. Here we report astrometric oﬀsets
between the prior catalogs used from the literature (Sect. 2.3) and our ALMA prior ﬁtting photometry catalog. These
astrometric oﬀsets between the prior positions and the ﬁtted ALMA positions are small (< 0.100).

In Fig. A.1, we plot the oﬀsets in R.A. and Dec.

for sources common in two catalogs using the UltraVISTA/-
COSMOS2015 catalog (Laigle et al. 2016), the VLA-COSMOS 3GHz catalog Smolčić et al. (2017), the HST/ACS
i-band (Capak et al. 2007) and the ﬁtted positions of the (sub-)mm sources in our prior-based ALMA catalog (see
Sect.2.4). First we conﬁrm that the ALMA astrometry is indeed excellent (as expected for a (sub-)mm interferometer
at the angular resolutions and frequencies of our observations) by comparison to the positions of 699 VLA-COSMOS
3GHz sources (top right panel). Comparison between the UltraVISTA and our ALMA positions for 827 sources (top
left panel) yields a a relatively large oﬀset of +0.1000 in R.A., but the oﬀset in Dec.
is very small (+0.0100). We
conﬁrm this astrometric oﬀset of the UltraVISTA catalog by examining positions for 9373 sources in common with the
VLA-COSMOS 3GHz catalog (bottom left panel). Given the order of magnitude larger number of sources the oﬀset
of +0.08800 in R.A. is statistically meaningful and consistent with the oﬀset seen between UltraVISTA and ALMA
source positions. Finally, comparison between positions of 7369 sources in common in the HST/ACS i-band and VLA
catalogs (bottom right panel) yields a lower signiﬁcantly oﬀset in R.A. but a more substantial oﬀset in Dec.

Since we allow the source position to vary by a relatively large amount (∼ 0.700, see Sect. 2.4) during the prior-based
detection of (sub-)mm continuum source, it is not necessary to repeat the initial detection step. However, we have
applied a correction to take the small oﬀsets into account during our counterpart association process (Sect. 4.2). We
note that Smolčić et al. (2017) report astrometric oﬀsets of similar size between VLA-COSMOS 3GHz and UltraVISTA
source positions using a more complex analysis identifying variations in the astrometry across the full COSMOS ﬁeld
(see their Appx. A.1 and Fig. A.1). As the numbers of sources analyzed per R.A. and Dec. bin are only a few hundred,
we prefer to apply only a single value when correcting for the astrometric oﬀset of the UltraVISTA sources.

We note that a new COSMOS photometry catalog is under construction using the UltraVISTA DR4 data which
are astrometrically corrected using GAIA data, providing a much better astrometry of a few milli-arcsecs (see https:
//calet.org/). Our next A3COSMOS updates will use it when available.

42

D. Liu et al.

Fig. A.1. Astrometric oﬀsets between source positions in the prior catalogs used from the literature (Sect. 2.3; Laigle et al.
2016; Smolčić et al. 2017; Capak et al. 2007) and positions from our ALMA prior-based detections. Each panel shows the R.A.
and Dec. oﬀset distribution for sources common in two catalogs as labeled. Histograms of the R.A. and Dec. oﬀsets are shown
at each top and right axis, respectively. Median values of the R.A. and Dec. oﬀsets are indicated by the dashed blue line and
the text therein. See Appx. A for the details.

1.00.50.00.51.0RAUltraVISTARAALMA1.00.50.00.51.0DecUltraVISTADecALMAUltraVISTA  ALMA+0.01600+0.102001.00.50.00.51.0RAVLA/3GHzRAALMA1.00.50.00.51.0DecVLA/3GHzDecALMAVLA/3GHz  ALMA+0.00000+0.003001.00.50.00.51.0RAUltraVISTARAVLA1.00.50.00.51.0DecUltraVISTADecVLAUltraVISTA  VLA+0.01700+0.088001.00.50.00.51.0RAHST/ACSRAVLA1.00.50.00.51.0DecHST/ACSDecVLAHST/ACS  VLA+0.076000.01100A3COSMOS photometry & catalogs

43

B. SOURCES WITH INCONSISTENT (SUB-)MM CONTINUUM PHOTOMETRY IN OUR TWO CATALOGS
Here we present the ALMA images of the (sub-)mm continuum sources that have inconsistent total ﬂuxes in the
prior-based and blindly extracted catalogs and are labeled in Fig. 7. Three outliers with labels 1 to 3 have > 5σ
higher galfit ﬂuxes than PyBDSF ﬂuxes, and one outlier with label a has the opposite situation. Their ALMA
images, prior ﬁtting and blind extraction model images and residual images are shown in Fig. B.1 (each outlier has
six sub-panels; see caption for details).

In general the galfit source models provide better ﬁts to the original ALMA images, with less residual emission
in the residual images, except for outlier 3 which seems to be composed of two ALMA sources while our COSMOS
master catalog contains only one prior source.

For the fourth outlier with label a in Fig. 7 and shown in the bottom-right of Fig. B.1, the galfit model is more
complex than the simple Gaussian shaped PyBDSF model because multiple prior sources are ﬁtted. Therefore, as
long as we have a good knowledge of prior sources in the ALMA ﬁeld of view, i.e., from our compiled COSMOS master
catalog, the galfit ﬁtting typically provides very good photometry results (with a small enough reduced-χ2 in the
residual image).

Fig. B.1. PyBDSF and galfit ﬁtting images for the four outliers labeled as 1, 2, 3 and a in Fig. 7 where the measured
(sub-)mm continuum ﬂuxes from our PyBDSF and galfit photometry diﬀer signiﬁcantly (> 5σ. Their IDs in our master
catalog (being the same as in the Laigle et al. (2016) catalog) are 831167, 605445, 334409 and 735948, respectively. For each
source six sub-panels are shown, namely input image, PyBDSF model image, PyBDSF residual image (top row, left to right),
source information, galfit model image and galfit residual image (bottom row, left to right). The color scale is the same for
all sub-panels for each source, but varies from source to source. A white box with a size of 300 is shown in each sub-panel for
reference.

C. DETAILED DESCRIPTION OF OUR MONTE CARLO SIMULATIONS
We brieﬂy introduced our two sets of Monte Carlo simulations in Sect. 3 — the full-parameter-space (“FULL”)
simulation and the physically-motivated (“PHYS”) simulation. Below we provide in-depth details of how we model the
artiﬁcial sources (Appx. C.1.1 and C.2.1), inject them into ALMA residual images (after blind extraction photometry)

Input ImageInput ImageInput ImageInput ImageInput ImagePyBDSF ModelPyBDSF ModelPyBDSF ModelPyBDSF ModelPyBDSF ModelPyBDSF ResidualPyBDSF ResidualPyBDSF ResidualPyBDSF ResidualPyBDSF ResidualBox size 3.0 arcsecDec 02:33:34.365RA 10:00:51.584(outlier 1)ID 831167GALFIT ModelGALFIT ModelGALFIT ModelGALFIT ModelGALFIT ModelGALFIT ResidualGALFIT ResidualGALFIT ResidualGALFIT ResidualGALFIT ResidualInput ImageInput ImageInput ImageInput ImageInput ImagePyBDSF ModelPyBDSF ModelPyBDSF ModelPyBDSF ModelPyBDSF ModelPyBDSF ResidualPyBDSF ResidualPyBDSF ResidualPyBDSF ResidualPyBDSF ResidualBox size 3.0 arcsecDec 02:13:11.307RA 10:00:46.225(outlier 2)ID 605445GALFIT ModelGALFIT ModelGALFIT ModelGALFIT ModelGALFIT ModelGALFIT ResidualGALFIT ResidualGALFIT ResidualGALFIT ResidualGALFIT ResidualInput ImageInput ImageInput ImageInput ImageInput ImagePyBDSF ModelPyBDSF ModelPyBDSF ModelPyBDSF ModelPyBDSF ModelPyBDSF ResidualPyBDSF ResidualPyBDSF ResidualPyBDSF ResidualPyBDSF ResidualBox size 3.0 arcsecDec 01:47:49.145RA 09:59:49.149(outlier 3)ID 334409GALFIT ModelGALFIT ModelGALFIT ModelGALFIT ModelGALFIT ModelGALFIT ResidualGALFIT ResidualGALFIT ResidualGALFIT ResidualGALFIT ResidualInput ImageInput ImageInput ImageInput ImageInput ImagePyBDSF ModelPyBDSF ModelPyBDSF ModelPyBDSF ModelPyBDSF ModelPyBDSF ResidualPyBDSF ResidualPyBDSF ResidualPyBDSF ResidualPyBDSF ResidualBox size 3.0 arcsecDec 02:25:01.133RA 10:00:31.954(outlier a)ID 735948GALFIT ModelGALFIT ModelGALFIT ModelGALFIT ModelGALFIT ModelGALFIT ResidualGALFIT ResidualGALFIT ResidualGALFIT ResidualGALFIT Residual44

D. Liu et al.

(Appx. C.1.1 and C.2.2), recover the sources with our two types of photometry pipelines (Appx. C.1.2 and C.2.3),
and analyze the statistics (Appx. C.3). We also discuss the limitations of each simulation in Appx. C.1.3 and C.2.4.
Note that both simulations have limitations which could bias our ﬁnal ﬂux and error estimations. Only by doing
both simulations and comparing them with each other as done here, these limitations can be understood and the least
biased way to implement corrections to obtain ﬁnal photometry results can be identiﬁed.

C.1. Full parameter space (“FULL”) MC Simulation
C.1.1. Source simulation and injection
In the “FULL” simulation, we simulate one source at a time for each of the ∼150 representative ALMA continuum
images (Sect. 3), with source peak ﬂux density ranging from 3.0 to 100 times the rms noise (the ratio is denoted as
S/N
; see Eq. 1), and size (Gaussian major-axis FWHM, convolved with the beam) ranging from 0.1 to 6.0 times
the synthesized beam size (clean beam, Gaussian major-axis FWHM) (the ratio is denoted as Θbeam; see Eq. 2).

peak

There are 13 grid points in the ﬁrst parameter (S/N

) and also 13 in the second parameter (Θbeam). For each

peak

grid point, we generate 25 mock sources by randomizing the injecting position.

The simulated source is assumed to be of Gaussian shape (the minor-axis FWHM is generated with an axis ratio
randomly picked between 0.2 to 1.0). Then, the source is convolved with the clean beam and injected into the residual
image derived from PyBDSF where sources were already blindly extracted and removed. We randomly cut a box area
around the source with a size of 8 times the intrinsic source size to ensure enough empty sky area for source extraction.
In total, we have ∼4225 “FULL” simulations per ALMA image, and repeating this for ∼150 representative ALMA
images (one for each independent ALMA scheduling block) we have ∼3750 sources per grid point in the two-dimensional
parameter space.

C.1.2. Source recovery
We run our PyBDSF and galfit photometry tools to recover those simulated sources one by one. For PyBDSF,
we keep the exact same conditions as for the real catalog, i.e., setting the background to zero and the rms noise to
the values we measured from the previous photometry run (from ﬁtting the pixel histograms; Sect. 2.2), and using
the same thresholds as for the original ALMA images (Sect. 2.2). For galfit, the only diﬀerence is the input prior
catalog. We assume no source blending issue and only ﬁt the simulated source.

In Fig. C.1 we show the comparisons of the simulated and recovered ﬂuxes for PyBDSF (top panels) and galfit
. Here we only shows
peak > 3, because lower S/N detections are mostly spurious, according to the spurious fraction

(bottom panels). The left panels show the simulated versus recovered ﬂuxes, colored by S/N
sources which have S/N
analysis in Sect. 2.8, and eventually we select our ALMA detections with a much higher S/N

peak

peak ∼ 5 (Sect. 4.1).

peak

The middle panels of Fig. C.1 show the diﬀerence between the simulated and recovered ﬂuxes (Ssim.−Srec.) normalized
(source peak ﬂux to rms noise ratio; Eq. 1), colored by Θbeam (source area to beam
by Ssim. as a function of S/N
, Ssim. is always smaller than Srec., indicating that ﬂuxes are boosted by
area ratio; Eq. 2). In general, at a low S/N
. Therefore, based on these, we quantify the ﬂux bias
noise. Such a ﬂux-boosting is much smaller for a higher S/N
by the two parameters S/N
and Θbeam in the main text (Sect. 3.1). Meanwhile, the scatter of (Ssim. − Srec.) reﬂects
the uncertainty of the photometry, i.e., ﬂux errors, which can also be quantiﬁed by the two parameters (Sect. 3.1.3).
Note that the ﬂux errors that came along with our two photometry pipelines are based on the equations in Condon
(1997), where the author used about 3000 MC simulations to calibrate these equations. Our MC simulations oﬀer the
possibility for alternative assessments that show a broad consistency but also evidence for a second-order trend with
S/N

(Sect. 3.1.3 and 3.1.4).

peak

peak

peak

The right panels of Fig. C.1 show the histogram of (Ssim. − Srec.) normalized by the ﬂux errors σSrec.

. Sources are
. An 1D Gaussian ﬁt (e−(x−µ)2/2 σ2 ) to the histogram indicates
grouped into subsamples according to their S/N
whether the ﬂux errors can statistically represent the uncertainty of the photometry. If the ﬁtted Gaussian is too wide
(i.e., σ > 1), then the ﬂux errors are underestimated, and vice versa. We overlay the σ = 1, µ = 0 1D Gaussian curve
for comparison. Note that both ﬂux bias and error aﬀect these histograms. We demonstrate in Appx. C.3 that after
correcting ﬂux biases and re-estimating ﬂux errors, these histograms becomes much more close to σ = 1, µ = 0 1D
Gaussian shapes, i.e., we can say that they follow a well-behaved Gaussian statistics.

peak

peak

C.1.3. Limitations
We discuss several limitations related to the use of the “FULL” simulation to indicate ﬂux bias, error and complete-
and Θbeam distributions

ness in this section. First is the assumed source property distribution. Using uniform S/N

peak

A3COSMOS photometry & catalogs

45

Fig. C.1. Analysis of the PyBDSF (top) and galfit (bottom) recovery of properties of the “FULL” simulation sources.
Left panels show the comparison of simulated versus recovered ﬂux colored by S/Npeak. Middle panels present the relative
ﬂux diﬀerence ((Ssim. − Srec.)/Ssim.) versus S/Npeak. Right panels show the histogram of the normalized ﬂux diﬀerence
((Ssim. − Srec.)/σSrec. ), where σSrec. is the PyBDSF output ﬂux error following the Condon (1997) equations. Compared to also
our corrected histogram in Fig. C.3.

is indeed a strong assumption, although it is perhaps the most commonly adopted way in IR/mm/radio photometry
studies. We have to consider the following situation, which we refer to as the “resolution bias”. A large, low S/N source
can usually break up into several smaller clumps due to noise ﬂuctuations. Our photometry code will then usually
only detect a smaller, low S/N clump, therefore the source’s total ﬂux is only partially recovered. This acts opposite
to the eﬀect of ﬂux-boosting, where our photometry code detects a low S/N source which is actually the peak of a
noise ﬂuctuation instead of a real galaxy. In reality, what we know about the detected sources are only the recovered
ﬂuxes and sizes, therefore we can not distinguish the two eﬀects. As we parametrize the ﬂux biases and errors by the
recovered ﬂuxes and sizes (as will be described in detail in Sect. 3.1), simulating more large size sources will lead to
less ﬂux-boosting (hence smaller ﬂux biases), and larger ﬂux errors that can be signiﬁcant particularly at low S/N.

A second limitation is that sources are simulated and then recovered individually in our “FULL” simulation pro-
In reality, sources can be blended even at the arc-
cedure. Thus there is no source blending or clustering eﬀect.
sec resolution of the ALMA data, although this situation occurs at low probability, e.g., it depends on the galaxy
merger fraction. This limitation could aﬀect our estimation of the completeness of the PyBDSF photometry, because
PyBDSF is a blind extraction tool and sometimes will extract two blended sources as a single source. The galfit
photometry should not be aﬀected, if the prior source catalog has a high resolution (sub-arcsec) and is complete (not
missing sources in ALMA bands).

Another limitation is the input map we used for injecting source models. We use the PyBDSF residual maps
for all of our analysis presented here, because the residual maps ideally should contain the exact noise as in the
observations. However, imperfect source subtraction (by PyBDSF) could potentially increase the noise at certain
positions. However, this is likely a very minor problem as we randomize the injection positions.
Injecting source
models in the uv-plane (pure interferometry noise) instead of the image plane (PyBDSF residual image) could in
principle help to assess the additional uncertainty introduced by the imaging/cleaning process. But the diﬀerence
should be small because we have veriﬁed with our real data that the rms noise and source ﬂuxes measured from the
uv-plane and image plane are fully consistent.

C.2. Physically-motivated (“PHYS”) MC Simulation
C.2.1. Source simulation
In order to disentangle the major limitations from the “FULL” simulation, we have done another physically-motivated
simulation (“PHYS” simulation) where we try to reproduce the real physical properties of galaxies across cosmic time.

¡5¡4¡3¡2¡1012345(Ssim:¡Srec:)=¾Srec:0:011NGaussian(¾=1)3·SNRpeak<55·SNRpeak<10SNRpeak¸10¡5¡4¡3¡2¡1012345(Ssim:¡Srec:)=¾Srec:0:011NGaussian(¾=1)3·SNRpeak<55·SNRpeak<10SNRpeak¸1046

D. Liu et al.

In detail, we follow the two-star-formation-mode (2SFM) recipe (Sargent et al. 2012, 2014; Béthermin et al. 2012a),
which assumes all star-forming galaxies are in two populations, with the population of starbursts being enhanced in
their sSFRs by a range of factors under a normal distribution with a mean of 5 (here we adopt 5 because we ﬁnd this
better ﬁts the millimeter number counts; Sargent et al. 2014 suggest a value of 4; see their Fig. 10). We generate these
star-forming galaxies within the cosmic volume of the 2 square degree COSMOS ﬁeld with the following procedures:

1) Deﬁning 25 redshift bins from z=9.75 to 0;
2) Computing the number of star-forming galaxies using the stellar mass function (e.g., Davidzon et al. 2017) at

each redshift and starting from M∗ = 108.0 M(cid:12);

3) Assuming a small fraction of these star-forming galaxies are in starburst (SB) mode while the rest are in MS

mode. The fraction is set to be consistent with the merger fraction extrapolated from Conselice (2014);

4) Computing SFRs for MS and SB galaxies following the MS correlation (including the scatter) and SB boost

function in Sargent et al. (2014);

5) Then we generate an IR-to-radio SED for each model galaxy according to the redshift, stellar mass and SFR,
following the SED modeling in Liu et al. (2018), which is based on Magdis et al. (2012), assuming Draine &
Li (2007) dust models and simplifying the dust SEDs by associating them only to redshift and the interstellar
radiation ﬁeld (hU i; see Magdis et al. 2012, Béthermin et al. 2015 and Liu et al. 2018 for more details);

6) Estimating MS galaxies’ sizes depending on their redshifts and stellar masses following (extrapolating from) van
der Wel et al. (2014) as well as considering that dust sizes are a factor of about 2 smaller (Fujimoto et al. 2017);

7) Random minor/major axis ratio from 0.2 to 1;
In total about 0.7 million model galaxies are generated in 2 square degrees. As a validation, their number counts are
also estimated at each IR/mm/radio wavelength, these simulated counts are found to agree well with real (sub-)mm
measurements at 500 µm, 850 µm, 1.1 µm and 1.3 µm (within the error bars), e.g., Béthermin et al. (2012b), Karim
et al. (2013), Carniani et al. (2015), Hatsukade et al. (2016) and Geach et al. (2017).

These model galaxies are then randomly injected into the 2 sq. deg. COSMOS ﬁeld and recovered, which is described

in the following.

C.2.2. Source placement
We assign a random position within the 2 square degree COSMOS ﬁeld for each mock galaxy. Then, we create
artiﬁcial ALMA maps by inserting our mock galaxies into the ALMA residual images of the 150 representative programs
we have selected in Section C.1. For each of the residual maps, we create 273 of such artiﬁcial maps. Within each
iteration, we select a mock galaxy at speciﬁc redshift and stellar mass out of the full mock galaxy catalog, and place
it in the center of the residual map. We apply a small random oﬀset (1–600) to avoid imperfect source extraction at
the center of the residual image. A subset of other remaining galaxies from the full mock catalog may fall within the
same residual map according to their position within the full simulated 2 square degree map and are inserted as well.
In this way, we account for possible clustering of (sub-)mm sources in real observations. We loop for each simulated
galaxy over a redshift grid ranging from 1.0 to 6.0 in steps of 0.25, with log stellar mass from log(M∗(M(cid:12))) =9.0 to
12.0 in steps of 0.25, making a total of 273 iterations. Then, we extract all the sources simultaneously in the next
section (unlike for the “FULL” simulation where we extract each simulated source individually, see Appx. C.1).

C.2.3. Source recovery
The simulated images are then treated by our PyBDSF and galfit pipelines in the same manner as the original
ALMA images. The simulated and original ALMA images have the same size, therefore the impact of simultaneous
multi-source ﬁtting is also considered. Moreover, for the prior ﬁtting with galfit, we use the catalog of simulated
galaxies as the prior source list.

Similar to Fig. C.1, we present the comparison of the simulated and recovered ﬂuxes from the “PHYS” simulation
in Fig. C.2. The “PHYS” simulation contains many more faint sources (due to the realistic stellar mass function and
main sequence correlation). The histograms in the right panels of Fig. C.2 are narrower than those of the “FULL”
simulation as shown in Fig. C.1, especially for the low S/N
sources (shown as the red histograms in both ﬁgures).
This means that the ﬂux bias and error are diﬀerent if we adopt diﬀerent simulation methods (Fig. 12 and 13), even
when each simulation is repeated suﬃciently to yield robust statistics. Here we emphasize that the prior information
assumed in the simulations is important for analyzing the ﬂux bias and error statistics, and making the simulation as
close to real galaxy population distribution as possible will lead to more realistic results (Sect. 3.1).

peak

A3COSMOS photometry & catalogs

47

Fig. C.2. Similar to Fig. C.1 but for “PHYS” simulation. See Fig. C.1 caption.

C.2.4. Limitations

The physically-motivated simulation has the advantage of resembling closer the real situation for galaxy photometry
in ALMA images. However, it also has limitations, both in the assumed galaxy evolution models and when comparing
to the full-parameter-space simulation.

Firstly, our model galaxies are built on the star-forming galaxy’s stellar mass function at each redshift. These mass
functions are not well constrained at redshift of z ∼4 and unconstrained at higher redshifts (e.g., Grazian et al. 2015;
Song et al. 2016; Davidzon et al. 2017). Then, we assume a starburst fraction associated to the merger fraction, which
is highly unconstrained at redshift z ∼2 and beyond. Moreover, because we aim to reproduce the majority of star-
forming galaxies, we choose simpliﬁed galaxy SED models (Magdis et al. 2012; Liu et al. 2018) which can represent the
bulk of star-forming and starburst galaxies (see details in Appx. C.2.1 and references there), but these SED models
do not include extreme cases, e.g., galaxies with very high sSFR, very low or very high dust temperature, etc. The
“PHYS” simulation also does not include a full implementation of the clustering eﬀect as in Béthermin et al. (2017).
However, we emphasize that the aim of the “PHYS” simulation is to provide very diﬀerent inputs from the “FULL”
simulation, to see whether they can lead to diﬀerent statistical results, and they do. Further the “PHYS” simulation we
adopt here is suﬃciently complex for testing our ALMA (sub-)mm photometry under all possible, physical situations
that are not covered by the “FULL” simulation.

rec.

)/σScorr.

C.3. Final statistical behaviour of corrected ﬂuxes and errors
We provide details on the statistical behaviour of ﬂux errors here as an extension to the discussion in Appx. 3.1.5. We
examined the histograms of (Ssim. − Scorr.
as shown in Fig. C.3 for ﬁnal corrected PyBDSF and galfit ﬂuxes
rec.
and errors. Such a histogram indicates how well our ﬁnal ﬂux errors σScorr.
can reﬂect the true scatter between Ssim.
and Scorr.
. Ideally, if the ﬂux error well represents the uncertainty in the photometry, the histogram should have the
rec.
shape of an 1D Gaussian with mean = 0 and sigma = 1 (which is overlaid in the ﬁgure). Comparing these histograms
to those before correction (Fig. C.1 and C.2), we do ﬁnd signiﬁcant improvement in the shape of the histogram. In
Fig. C.3, we show the histogram after each step of correction: (1) ﬂux bias correction (top row) and (2) both ﬂux bias
and error correction (bottom row). The ﬁnal histograms nicely agree with the mean = 0, sigma = 1 1D Gaussian.
Although there are some outliers, but they only contribute a few percent in number. The outlier fraction is lower in
the galfit photometry compared to the PyBDSF photometry, probably because prior ﬁtting uses known positional
information and reduces the chance of recovering noise peaks as sources. Both of these eﬀects are also related to
the features in each photometry method. For example, at the high value-end of the histogram, outliers have highly
underestimated ﬂuxes likely due to the aforementioned resolution bias (large sources are break down and only partial
ﬂux are recovered). And at the low-value end, outliers have extra-boosted ﬂuxes mostly because the recovered source

rec.

¡5¡4¡3¡2¡1012345(Ssim:¡Srec:)=¾Srec:0:011NGaussian(¾=1)3·SNRpeak<55·SNRpeak<10SNRpeak¸10¡5¡4¡3¡2¡1012345(Ssim:¡Srec:)=¾Srec:0:011NGaussian(¾=1)3·SNRpeak<55·SNRpeak<10SNRpeak¸1048

D. Liu et al.

sizes are signiﬁcantly larger than their simulated sizes. For these outliers, we can tentatively identify them out by
checking their PyBDSF multi-component ﬂag (Flag_multi), and also comparing their PyBDSF and galfit ﬂuxes
and sizes. For example, there are 5% of sources with Flag_multi=='M' in our blind photometry catalog. Therefore,
if excluding them, for the bulk of sources done with out photometry, the errors are quite well behaved in statistics.

PHYS – PYBDSF
only ﬂux bias corrected

PHYS – GALFIT
only ﬂux bias corrected

PHYS – PYBDSF
ﬂux bias and error corrected

PHYS – GALFIT
ﬂux bias and error corrected

Fig. C.3. Left panels are based on the “PHYS” simulation with PyBDSF photometry, and right panels are based on
the “PHYS” simulation with galfit photometry.
is the histogram of (Ssim. −
Scorr.
rec. )/σSrec., Condon1997, where Scorr.
is the measured total ﬂux after ﬂux bias correction (Sect. 3.1.1), and σSrec., Condon1997 is the
rec.
error in total ﬂux shipped with PyBDSF based on Condon (1997). And the lower panel is the histogram of (Ssim.−Scorr.
rec. ,
rec. )/σScorr.
is the simulation-based error in total ﬂux (Sect. 3.1.3). An 1D Gaussian with mean = 0 and sigma = 1 is overlaid
where σScorr.
rec.
in each panel.

In each left/right panel, the upper panel

C.4. Discussion on the completeness of (sub-)mm/radio photometry
We present the 2D diagnostic diagram of completeness in Fig. C.4. Such a diagram is also used in similar works
(e.g., Jiménez-Andrade et al. 2019; Franco et al. 2018). The left panel shows the dependency on Speak and the right
, the completeness has a more complicated dependency on
panel on Stotal. Because Stotal ∝ Speak × Θ2
to select the sample results in a more uniform completeness for
. Thus using S/N
Stotal/rms noise than S/N
various source sizes.

beam, convol.

peak

peak

We compare our ﬁndings with other ALMA photometry work with completeness assessments in the literature:
Hatsukade et al. (2011, 2016), Karim et al. (2013), Ono et al. (2014), Simpson et al. (2015), Aravena et al. (2016),
Umehata et al. (2017), Dunlop et al. (2017) and Franco et al. (2018). Our diﬀerential completeness at low S/N
peak
is either lower than or consistent with the values in the literature. For example, Karim et al. (2013) estimated ∼70%
peak ∼ 3 for their Gaussian-ﬁtting photometry down to 2.5 σ while we derive a value of ∼20%.
completeness at S/N
peak ∼ 3 for their SExtractor (Bertin & Arnouts 1996)
Aravena et al. (2016) estimated ∼50% completeness at S/N
peak ∼ 3 for their AEGEAN
source extraction down to 3.5 σ. Hatsukade et al. (2016) found ∼25% completeness at S/N
(Hancock et al. 2012) Gaussian-ﬁtting photometry down to 4 σ. And Franco et al. (2018) report <20% completeness
at the same S/N
for their Blobcat Gaussian-ﬁtting photometry, which is consistent with ours. Note that all these
studies mentioned are based on ALMA maps coming from a single program with similar beam size and rms noise.
However, in our work these parameters vary signiﬁcantly across the archival programs. Based on archival data, Ono
peak ∼ 3 for their SExtractor extraction down to as low as 1.8 σ.
et al. (2014) found a completeness of ∼85% at S/N
Our comparison above shows that both detection criterion and photometry method are important when deriving
completeness fractions. A lower detection criterion leads to a higher completeness. However, we have also to consider

peak

¡5¡4¡3¡2¡1012345(Ssim:¡Srec:)=¾Srec:0:011NGaussian(¾=1)3·SNRpeak<55·SNRpeak<10SNRpeak¸10¡5¡4¡3¡2¡1012345(Ssim:¡Srec:)=¾Srec:0:011NGaussian(¾=1)3·SNRpeak<55·SNRpeak<10SNRpeak¸10¡5¡4¡3¡2¡1012345(Ssim:¡Srec:)=¾Srec:0:011NGaussian(¾=1)3·SNRpeak<55·SNRpeak<10SNRpeak¸10¡5¡4¡3¡2¡1012345(Ssim:¡Srec:)=¾Srec:0:011NGaussian(¾=1)3·SNRpeak<55·SNRpeak<10SNRpeak¸10A3COSMOS photometry & catalogs

49

the spurious detection fraction (Fig. 8) which rapidly increases by lowering the detection criterion. Our choice of
PyBDSF parameters as described in Sect. 2.2 is thus a compromise between the completeness and spurious fractions.

Fig. C.4. Completeness of the PyBDSF source extraction as a 2D function of the simulated Speak/rms noise (i.e., S/Npeak;
left panel) or Stotal/rms noise (right panel) and Θbeam, based on the “FULL” simulation (Sect. C.1). Color indicates the
completeness fraction.

D. AN EXAMPLE OF OUR AUTOMATED COUNTERPART ASSOCIATION EXAMINATION
In Fig. D.1 we show an example for our automated examination of the counterpart association between each ALMA
source and its counterpart source in prior catalogs. For each counterpart image (HST ACS i-band, UltraVISTA Ks-
band, SPLASH IRAC ch1, and VLA 3 GHz), we measure several parameters as described in Sect. 4.2 and then link
them to the likelihood of the counterpart association based on our visual inspection. For example, in Fig. D.1, the
bold green circle indicates the ﬁtted ALMA source position and size (convolved with the ALMA beam), and the red
crosses are sources in the prior catalog (Sect. 2.3). The bold red cross indicates the counterpart of the ALMA source
(or just the prior source used in prior ﬁtting photometry).

2.5345102050100Speak,sim./rmsnoise1.01.52.02.53.03.54.04.5beam,sim.,convol.FULLPYBDSF0%20%40%60%80%100%Completeness2.5345102050100Stotal,sim./rmsnoise1.01.52.02.53.03.54.04.5beam,sim.,convol.FULLPYBDSF0%20%40%60%80%100%Completeness50

D. Liu et al.

Fig. D.1. Example of our automated counterpart association (Sect. 4.2) for the ALMA source with COSMOS2015 ID 888774
(Laigle et al. 2016). It is selected as an example because of its relatively large oﬀset (Sep. = 0.46; see deﬁnition in Sect. 4.2)
between the ALMA and optical positions (corrected for astrometry). The background image is the HST ACS i-band in the left
panel and the UltraVISTA Ks-band in the right panel. Other symbols are the same in two panels: the thick green ellipse shows
the position and size of the ALMA source, and the thin green ellipses show the aperture used for measuring the Ext. parameter
as described in Sect. 4.2. The largest red cross represents the counterpart position and smaller red crosses are other master
catalog sources within this image. This prior source is from the Laigle et al. (2016) catalog, therefore its prior position is based
on an optical-to-near-IR combined SNR map and centered at the Ks emission. There is a faint blue source with ID 1732293
in the Capak et al. (2007) i-band catalog (but not in the Laigle et al. (2016) catalog) at the northeast of the prior position
with a small oﬀset of 0.400. Current information (including astrometry) is not suﬃcient to distinguish whether this faint blue
source is another galaxy or physically associated to the Ks source. The latter situation (where UV stellar light oﬀsets from dust
emission) has been observed in many high-redshift dusty galaxies (e.g., Hodge et al. 2016, 2019; Rujopakarn et al. 2019; Lang
et al. 2019). Due to the fact that the i-band source is quite faint, the Ks galaxy’s SED is mostly unaﬀected by the i-band and
shorter wavelength photometry, and the ALMA photometry can be reasonably ﬁtted for the Ks galaxy at its redshift.

E. PROBLEMATIC SED FITTING CASES
In Fig. E.1 we show the four problematic SED ﬁtting cases which are labeled in Fig. 24 and discussed in Sect. 4.6.
Their stellar masses derived from our optimized iterative MAGPHYS ﬁtting (Sect. 4.4) without an AGN component
are higher by a factor of 10–100 compared to the masses reported by Delvecchio et al. (2017), who used SED3FIT
to account for an AGN SED component (and both redshifts are consistent). However, we have the following reasons
to believe that these are just rare cases that do not indicate an obvious bias in our SED ﬁtting aﬀected by mid-IR
AGN contamination. First, these sources are very rare, with only 4 out of a total of 396 sources cross-matched with
the Delvecchio et al. (2017) catalog. All other AGNs have no such large diﬀerence between this work and Delvecchio
et al. (2017). Second, the advantage of this work is that we have the ALMA and far-IR/(sub-)mm constraint, and
MAGPHYS has the energy balance assumption that links optical dust attenuation to dust luminosity in IR; therefore,
the degeneracy between age and attenuation can be reduced (if the energy balance is valid, which could be true for our
ALMA-selected dusty sample). Thirdly, the optical photometry itself has uncertainties from either noise or galaxy–
galaxy blending. For example, for outlier 3, its HST i-band and Subaru Suprime-Cam z0-band data could not be ﬁt
well, but its IR SED looks reasonable and counterpart association shows no problem. It has no obvious blended optical
source within 300, but we could not rule out the chance of line-of-sight blending of two sources, i.e., like the case of the
galaxy CRLE reported in Pavesi et al. (2018).

9:59:34.0033.8033.6033.402:39:00.038:57.054.051.0RADecHST ACS iFoV 12.0 arcsecCOSMOS--ID_prior_888774--0counterpart z = 1.567Sep. = 0.461S/NALMA = 5.690S/NSrc. = 8.225Src./Ref. = 0.40Ext. = 2.1899:59:34.0033.8033.6033.402:39:00.038:57.054.051.0RADecUltraVISTA KsFoV 12.2 arcsecCOSMOS--ID_prior_888774--0counterpart z = 1.567Sep. = 0.461S/NALMA = 5.690S/NSrc. = 43.749Src./Ref. = 1.23Ext. = 0.839A3COSMOS photometry & catalogs

51

10

To verify the degeneracy between age and attenuation, we ran some additional SED ﬁtting with our multi-component
χ2 ﬁtting code under development 27, similar to Liu et al. (2018). We ﬁt two components for test purposes: one uses
Bruzual & Charlot (2003) stellar SED models at solar metallicity, with constant SFH, with various ages from 0.1
to 1 Gyr and with a varied dust attenuation (E(B − V ) = 0 to 1.2) following the Calzetti et al. (2000) attenuation
law; and the other uses the Mullaney et al. (2011) AGN SED models. We ﬁt only the optical to mid-IR part
(λ < 20 µm) of the SED. We loop each combination of the two component models and ﬁnd a best χ2 ﬁt, and then
we merge all combinations together to analyze the χ2 distributions for M∗ and age (to obtain a median value and
error for each parameter, similar to Liu et al. 2018). We ﬁnd that such a ﬁtting without constraints from far-IR dust
emission leads to very large uncertainties in age and stellar mass. For example, for outlier 2 (ID 951838), the best-ﬁt
(M∗/M(cid:12)) dramatically varies from 9.5 ± 0.5 to 11.4 ± 0.6 with an age that varies from 200 Myr to 1 Gyr (with
log
best-ﬁt E(B − V ) = 0.5 and 0.7, respectively). For comparison, the Delvecchio et al. (2017) log
10 M∗ of 10.24 and our
MAGPHYS value of 12.15 agreed within the errors. For our outlier 3 (ID 813955), a ﬁxed age of 200 Myr ﬁtting gives
E(B − V ) = 0.5 and log
10 M∗ = 12.6 ± 0.3
10 M∗ of 10.34, and our MAGPHYS
with an age of 450 Myr. In comparison, Delvecchio et al. (2017) report a log
value is 11.63, also in agreement within the range of uncertainties. Outlier 4 (ID 842140) presents a similar situation.
While for outlier 1 (ID 422662), our experimental stellar+AGN SED ﬁtting (log
10 M∗ ∼ 11.2 − 12.6 ± 0.6) cannot
recover the low log
10 M∗ = 9.45 reported in the Delvecchio et al. (2017) catalog (their ID_VLA3 4136). Therefore, as
mentioned in the text of Sect. 4.6, we think that its stellar mass is more reliable from the MAGPHYS ﬁtting because
of the inclusion of ALMA data here. Finally, we conclude that these sources are just low-probability outliers suﬀering
from the large uncertainty in stellar mass estimation and possibly also optical line-of-sight blending. The latter needs
further follow-up observations, which is beyond the scope of this paper.

10 M∗ = 11.0 ± 0.1, while a free-age ﬁtting gives E(B − V ) = 1.2 and log

27 It is still in the experimental phase but is available at http://github.com/1054/Crab.Toolkit.michi2.

52

D. Liu et al.

outlier 1

outlier 2

outlier 3

outlier 4

Fig. E.1. Example of SEDs for sources 1, 2, 3 and 4 listed in Fig. 24 which exhibit strong mid-IR AGN emission and disagreed
in the stellar masses between this work and Delvecchio et al. (2017). See discussion of each source in Sect. 4.6. For each source,
the best-ﬁt full SED (black line) and unattenuated stellar SED (cyan line) as well as the photometric data points are shown in
the upper, large sub-panel. The ALMA data point from this work is highlighted in red. Optical to near-IR K band data are
from the “COSMOS2015” catalog (Laigle et al. 2016) with 300 aperture photometry; near-IR IRAC to mm and radio data are
from the “super-deblended” FIR/mm catalog (Jin et al. 2018). The SED ﬁtting residuals at each band (log10 SOBS/SSED) are
shown in each middle sub-panel. The probability distribution histograms of each ﬁtted physical parameter (log10 M∗, log10 SFR,
IR luminosity log10 Ldust, dust mass log10 Mdust and dust temperature Tdust) are shown in the sub-panels at the bottom.

A3COSMOS photometry & catalogs

53

REFERENCES

Albrecht, M., Krügel, E., & Chini, R. 2007, A&A, 462, 575,

Bruzual, G., & Charlot, S. 2003, MNRAS, 344, 1000,

doi: 10.1051/0004-6361:20047017

doi: 10.1046/j.1365-8711.2003.06897.x

Aravena, M., Decarli, R., Walter, F., et al. 2016, ApJ, 833,

Bussmann, R. S., Pérez-Fournon, I., Amber, S., et al. 2013,

68, doi: 10.3847/1538-4357/833/1/68

ApJ, 779, 25, doi: 10.1088/0004-637X/779/1/25

Aretxaga, I., Wilson, G. W., Aguilar, E., et al. 2011,

Bussmann, R. S., Riechers, D., Fialkov, A., et al. 2015,

MNRAS, 415, 3831,
doi: 10.1111/j.1365-2966.2011.18989.x

ApJ, 812, 43, doi: 10.1088/0004-637X/812/1/43

Calzetti, D., Armus, L., Bohlin, R. C., et al. 2000, ApJ,

Ashby, M. L. N., Caputi, K. I., Cowley, W., et al. 2018,

533, 682, doi: 10.1086/308692

ApJS, 237, 39, doi: 10.3847/1538-4365/aad4fb

Capak, P., Aussel, H., Ajiki, M., et al. 2007, ApJS, 172, 99,

Baan, W. A., Henkel, C., Loenen, A. F., Baudry, A., &

doi: 10.1086/519081

Wiklind, T. 2008, A&A, 477, 747,
doi: 10.1051/0004-6361:20077203

Capak, P. L., Carilli, C., Jones, G., et al. 2015, Nature, 522,

455, doi: 10.1038/nature14500

Bauermeister, A., Blitz, L., Bolatto, A., et al. 2013, ApJ,

Carilli, C. L., & Walter, F. 2013, ARA&A, 51, 105,

763, 64, doi: 10.1088/0004-637X/763/1/64

doi: 10.1146/annurev-astro-082812-140953

Berta, S., Lutz, D., Santini, P., et al. 2013, A&A, 551,

Carniani, S., Maiolino, R., De Zotti, G., et al. 2015, A&A,

A100, doi: 10.1051/0004-6361/201220859

Bertemes, C., Wuyts, S., Lutz, D., et al. 2018, MNRAS,

584, A78, doi: 10.1051/0004-6361/201525780
Carpenter, J., Iono, D., Testi, L., et al. 2019, arXiv

478, 1442, doi: 10.1093/mnras/sty963

e-prints. https://arxiv.org/abs/1902.02856

Bertin, E., & Arnouts, S. 1996, A&AS, 117, 393,

Casey, C. M., Narayanan, D., & Cooray, A. 2014, PhR,

doi: 10.1051/aas:1996164

541, 45, doi: 10.1016/j.physrep.2014.02.009

Bertoldi, F., Carilli, C., Aravena, M., et al. 2007, ApJS,

Casey, C. M., Berta, S., Béthermin, M., et al. 2012, ApJ,

172, 132, doi: 10.1086/520511

761, 140, doi: 10.1088/0004-637X/761/2/140

Béthermin, M., Daddi, E., Magdis, G., et al. 2012a, ApJL,

Casey, C. M., Cooray, A., Killi, M., et al. 2017, ApJ, 840,

757, L23, doi: 10.1088/2041-8205/757/2/L23

101, doi: 10.3847/1538-4357/aa6cb1

Béthermin, M., Le Floc’h, E., Ilbert, O., et al. 2012b, A&A,

542, A58, doi: 10.1051/0004-6361/201118698

Béthermin, M., Daddi, E., Magdis, G., et al. 2015, A&A,

573, A113, doi: 10.1051/0004-6361/201425031

Chabrier, G. 2003, PASP, 115, 763, doi: 10.1086/376392
Chang, Y.-Y., van der Wel, A., da Cunha, E., & Rix, H.-W.

2015, ApJS, 219, 8, doi: 10.1088/0067-0049/219/1/8
Chen, C.-C., Hodge, J. A., Smail, I., et al. 2017, ApJ, 846,

Béthermin, M., Wu, H.-Y., Lagache, G., et al. 2017, A&A,

108, doi: 10.3847/1538-4357/aa863a

607, A89, doi: 10.1051/0004-6361/201730866

Civano, F., Elvis, M., Brusa, M., et al. 2012, ApJS, 201, 30,

Bigiel, F., Leroy, A., Walter, F., et al. 2008, AJ, 136, 2846,

doi: 10.1088/0067-0049/201/2/30

doi: 10.1088/0004-6256/136/6/2846

Civano, F., Marchesi, S., Comastri, A., et al. 2016, ApJ,

Blain, A. W., Smail, I., Ivison, R. J., Kneib, J.-P., &

819, 62, doi: 10.3847/0004-637X/819/1/62

Frayer, D. T. 2002, PhR, 369, 111,
doi: 10.1016/S0370-1573(02)00134-5

Comparat, J., Richard, J., Kneib, J.-P., et al. 2015, A&A,

575, A40, doi: 10.1051/0004-6361/201424767

Bolatto, A. D., Wolﬁre, M., & Leroy, A. K. 2013, ARA&A,

51, 207, doi: 10.1146/annurev-astro-082812-140944

Condon, J. J. 1997, PASP, 109, 166, doi: 10.1086/133871
Conselice, C. J. 2014, ARA&A, 52, 291,

Bondi, M., Ciliegi, P., Schinnerer, E., et al. 2008, ApJ, 681,

doi: 10.1146/annurev-astro-081913-040037

1129, doi: 10.1086/589324

Bondi, M., Ciliegi, P., Zamorani, G., et al. 2003, A&A, 403,

Coogan, R. T., Sargent, M. T., Daddi, E., et al. 2019,
MNRAS, 485, 2092, doi: 10.1093/mnras/stz409

857, doi: 10.1051/0004-6361:20030382

Cooke, E. A., Smail, I., Swinbank, A. M., et al. 2018, ApJ,

Brinchmann, J., Charlot, S., White, S. D. M., et al. 2004,

861, 100, doi: 10.3847/1538-4357/aac6ba

MNRAS, 351, 1151,
doi: 10.1111/j.1365-2966.2004.07881.x

Cresci, G., Mainieri, V., Brusa, M., et al. 2015, ApJ, 799,

82, doi: 10.1088/0004-637X/799/1/82

Brusa, M., Feruglio, C., Cresci, G., et al. 2015, A&A, 578,

da Cunha, E., Charlot, S., & Elbaz, D. 2008, MNRAS, 388,

A11, doi: 10.1051/0004-6361/201425491

1595, doi: 10.1111/j.1365-2966.2008.13535.x

Brusa, M., Cresci, G., Daddi, E., et al. 2018, A&A, 612,

da Cunha, E., Walter, F., Smail, I. R., et al. 2015, ApJ,

A29, doi: 10.1051/0004-6361/201731641

806, 110, doi: 10.1088/0004-637X/806/1/110

54

D. Liu et al.

Daddi, E., Dickinson, M., Morrison, G., et al. 2007, ApJ,

Hatsukade, B., Kohno, K., Yamaguchi, Y., et al. 2018,

670, 156, doi: 10.1086/521818

PASJ, 70, 105, doi: 10.1093/pasj/psy104

Daddi, E., Dannerbauer, H., Liu, D., et al. 2015, A&A, 577,

Hayward, C. C., & Smith, D. J. B. 2015, MNRAS, 446,

A46, doi: 10.1051/0004-6361/201425043

1512, doi: 10.1093/mnras/stu2195

Davidzon, I., Ilbert, O., Laigle, C., et al. 2017, A&A, 605,

Hezaveh, Y. D., & Holder, G. P. 2011, ApJ, 734, 52,

A70, doi: 10.1051/0004-6361/201730419

doi: 10.1088/0004-637X/734/1/52

De Looze, I., Baes, M., Bendo, G. J., Cortese, L., & Fritz,

Hilbert, S., White, S. D. M., Hartlap, J., & Schneider, P.

J. 2011, MNRAS, 416, 2712,
doi: 10.1111/j.1365-2966.2011.19223.x

2007, MNRAS, 382, 121,
doi: 10.1111/j.1365-2966.2007.12391.x

Delvecchio, I., Smolčić, V., Zamorani, G., et al. 2017, A&A,

Hodge, J. A., Swinbank, A. M., Simpson, J. M., et al. 2016,

602, A3, doi: 10.1051/0004-6361/201629367

ApJ, 833, 103, doi: 10.3847/1538-4357/833/1/103

Draine, B. T., & Li, A. 2007, ApJ, 657, 810,

Hodge, J. A., Smail, I., Walter, F., et al. 2019, ApJ, 876,

doi: 10.1086/511055

130, doi: 10.3847/1538-4357/ab1846

Dunlop, J. S., McLure, R. J., Biggs, A. D., et al. 2017,

MNRAS, 466, 861, doi: 10.1093/mnras/stw3088

Hughes, T. M., Ibar, E., Villanueva, V., et al. 2017,
MNRAS, 468, L103, doi: 10.1093/mnrasl/slx033

Elbaz, D., Daddi, E., Le Borgne, D., et al. 2007, A&A, 468,

Hunt, L. K., De Looze, I., Boquien, M., et al. 2019, A&A,

33, doi: 10.1051/0004-6361:20077525

621, A51, doi: 10.1051/0004-6361/201834212

Elbaz, D., Dickinson, M., Hwang, H. S., et al. 2011, A&A,

533, A119, doi: 10.1051/0004-6361/201117239

Ilbert, O., McCracken, H. J., Le Fèvre, O., et al. 2013,
A&A, 556, A55, doi: 10.1051/0004-6361/201321100

Elvis, M., Civano, F., Vignali, C., et al. 2009, ApJS, 184,

Jiménez-Andrade, E. F., Magnelli, B., Karim, A., et al.

158, doi: 10.1088/0067-0049/184/1/158

Franco, M., Elbaz, D., Béthermin, M., et al. 2018, A&A,

2019, A&A, 625, A114,
doi: 10.1051/0004-6361/201935178

620, A152, doi: 10.1051/0004-6361/201832928

Jin, S., Daddi, E., Liu, D., et al. 2018, ApJ, 864, 56,

Fu, H., Yan, L., Scoville, N. Z., et al. 2010, ApJ, 722, 653,

doi: 10.3847/1538-4357/aad4af

doi: 10.1088/0004-637X/722/1/653

Karim, A., Swinbank, A. M., Hodge, J. A., et al. 2013,

Fujimoto, S., Ouchi, M., Shibuya, T., & Nagai, H. 2017,

MNRAS, 432, 2, doi: 10.1093/mnras/stt196

ApJ, 850, 83, doi: 10.3847/1538-4357/aa93e6

Kennicutt, Jr., R. C. 1998, ApJ, 498, 541,

Geach, J. E., Dunlop, J. S., Halpern, M., et al. 2017,
MNRAS, 465, 1789, doi: 10.1093/mnras/stw2721

doi: 10.1086/305588

Kriek, M., Shapley, A. E., Reddy, N. A., et al. 2015, ApJS,

Ginsburg, A., Sipőcz, B. M., Brasseur, C. E., et al. 2019,

218, 15, doi: 10.1088/0067-0049/218/2/15

AJ, 157, 98, doi: 10.3847/1538-3881/aafc33

Laigle, C., McCracken, H. J., Ilbert, O., et al. 2016, ApJS,

Grazian, A., Fontana, A., Santini, P., et al. 2015, A&A,

224, 24, doi: 10.3847/0067-0049/224/2/24

575, A96, doi: 10.1051/0004-6361/201424750

Lang, P., Schinnerer, E., Smail, I., et al. 2019, arXiv

Greisen, E. W. 2002, AIPS, the VLA, and the VLBA, ed.
A. Heck (Dordrecht: Springer Netherlands), 109–125.
https://doi.org/10.1007/0-306-48080-8_7

Groves, B. A., Schinnerer, E., Leroy, A., et al. 2015, ApJ,

e-prints, arXiv:1905.06960.
https://arxiv.org/abs/1905.06960

Le Fèvre, O., Tasca, L. A. M., Cassata, P., et al. 2015,
A&A, 576, A79, doi: 10.1051/0004-6361/201423829

799, 96, doi: 10.1088/0004-637X/799/1/96

Le Floc’h, E., Aussel, H., Ilbert, O., et al. 2009, ApJ, 703,

Hales, C. A., Murphy, T., Curran, J. R., et al. 2012,

222, doi: 10.1088/0004-637X/703/1/222

MNRAS, 425, 979, doi: 10.1111/j.1365-2966.2012.21373.x

Leauthaud, A., Massey, R., Kneib, J.-P., et al. 2007, ApJS,

Hancock, P. J., Murphy, T., Gaensler, B. M., Hopkins, A.,

172, 219, doi: 10.1086/516598

& Curran, J. R. 2012, MNRAS, 422, 1812,
doi: 10.1111/j.1365-2966.2012.20768.x

Lee, N., Sheth, K., Scott, K. S., et al. 2017, MNRAS, 471,

2124, doi: 10.1093/mnras/stx1753

Hasinger, G., Capak, P., Salvato, M., et al. 2018, ApJ, 858,

Leitherer, C., & Heckman, T. M. 1995, ApJS, 96, 9,

77, doi: 10.3847/1538-4357/aabacf

doi: 10.1086/192112

Hatsukade, B., Kohno, K., Aretxaga, I., et al. 2011,

Leroy, A. K., Walter, F., Brinks, E., et al. 2008, AJ, 136,

MNRAS, 411, 102, doi: 10.1111/j.1365-2966.2010.17658.x

2782, doi: 10.1088/0004-6256/136/6/2782

Hatsukade, B., Kohno, K., Umehata, H., et al. 2016, PASJ,

Leroy, A. K., Bolatto, A., Gordon, K., et al. 2011, ApJ,

68, 36, doi: 10.1093/pasj/psw026

737, 12, doi: 10.1088/0004-637X/737/1/12

A3COSMOS photometry & catalogs

55

Lilly, S. J., Le Fèvre, O., Renzini, A., et al. 2007, ApJS,

172, 70, doi: 10.1086/516589

Negrello, M., Hopwood, R., De Zotti, G., et al. 2010,
Science, 330, 800, doi: 10.1126/science.1193420

Lilly, S. J., Le Brun, V., Maier, C., et al. 2009, ApJS, 184,

Noeske, K. G., Weiner, B. J., Faber, S. M., et al. 2007,

218, doi: 10.1088/0067-0049/184/2/218

ApJL, 660, L43, doi: 10.1086/517926

Liu, D., Gao, Y., Isaak, K., et al. 2015, ApJL, 810, L14,

Oliver, S. J., Bock, J., Altieri, B., et al. 2012, MNRAS, 424,

doi: 10.1088/2041-8205/810/2/L14

1614, doi: 10.1111/j.1365-2966.2012.20912.x

Liu, D., Daddi, E., Dickinson, M., et al. 2018, ApJ, 853,

Ono, Y., Ouchi, M., Kurono, Y., & Momose, R. 2014, ApJ,

172, doi: 10.3847/1538-4357/aaa600

795, 5, doi: 10.1088/0004-637X/795/1/5

Lutz, D., Poglitsch, A., Altieri, B., et al. 2011, A&A, 532,

Pavesi, R., Riechers, D. A., Sharon, C. E., et al. 2018, ApJ,

A90, doi: 10.1051/0004-6361/201117107

861, 43, doi: 10.3847/1538-4357/aac6b6

Madau, P., & Dickinson, M. 2014, ARA&A, 52, 415,

Pearson, W. J., Wang, L., Hurley, P. D., et al. 2018, A&A,

doi: 10.1146/annurev-astro-081811-125615

615, A146, doi: 10.1051/0004-6361/201832821

Magdis, G. E., Daddi, E., Elbaz, D., et al. 2011, ApJL, 740,

Pedregosa, F., Varoquaux, G., Gramfort, A., et al. 2011,

L15, doi: 10.1088/2041-8205/740/1/L15

Magdis, G. E., Daddi, E., Béthermin, M., et al. 2012, ApJ,

Journal of Machine Learning Research, 12, 2825.
https://arxiv.org/abs/1201.0490

760, 6, doi: 10.1088/0004-637X/760/1/6

Peng, C. Y., Ho, L. C., Impey, C. D., & Rix, H.-W. 2002,

Magdis, G. E., Rigopoulou, D., Daddi, E., et al. 2017,
A&A, 603, A93, doi: 10.1051/0004-6361/201731037
Magnelli, B., Saintonge, A., Lutz, D., et al. 2012, A&A,

AJ, 124, 266, doi: 10.1086/340952

—. 2010, AJ, 139, 2097,

doi: 10.1088/0004-6256/139/6/2097

548, A22, doi: 10.1051/0004-6361/201220074

Perna, M., Brusa, M., Cresci, G., et al. 2015, A&A, 574,

Marchesi, S., Civano, F., Elvis, M., et al. 2016, ApJ, 817,

A82, doi: 10.1051/0004-6361/201425035

34, doi: 10.3847/0004-637X/817/1/34

Pilbratt, G. L., Riedinger, J. R., Passvogel, T., et al. 2010,

Marsan, Z. C., Marchesini, D., Brammer, G. B., et al. 2017,

ApJ, 842, 21, doi: 10.3847/1538-4357/aa7206

A&A, 518, L1, doi: 10.1051/0004-6361/201014759
Poglitsch, A., Waelkens, C., Geis, N., et al. 2010, A&A,

Masters, D. C., Stern, D. K., Cohen, J. G., et al. 2017,

518, L2, doi: 10.1051/0004-6361/201014535

ApJ, 841, 111, doi: 10.3847/1538-4357/aa6f08

Pope, A., Scott, D., Dickinson, M., et al. 2006, MNRAS,

McCracken, H. J., Capak, P., Salvato, M., et al. 2010, ApJ,

370, 1185, doi: 10.1111/j.1365-2966.2006.10575.x

708, 202, doi: 10.1088/0004-637X/708/1/202

McCracken, H. J., Milvang-Jensen, B., Dunlop, J., et al.

2012, A&A, 544, A156,
doi: 10.1051/0004-6361/201219507

McMullin, J. P., Waters, B., Schiebel, D., Young, W., &
Golap, K. 2007, in Astronomical Society of the Paciﬁc
Conference Series, Vol. 376, Astronomical Data Analysis
Software and Systems XVI, ed. R. A. Shaw, F. Hill, &
D. J. Bell, 127

Miettinen, O., Delvecchio, I., Smolčić, V., et al. 2017a,
A&A, 597, A5, doi: 10.1051/0004-6361/201628128

—. 2017b, A&A, 606, A17,

doi: 10.1051/0004-6361/201730762

Mohan, N., & Raﬀerty, D. 2015, PyBDSF: Python Blob

Detection and Source Finder, Astrophysics Source Code
Library. http://ascl.net/1502.007

Rémy-Ruyer, A., Madden, S. C., Galliano, F., et al. 2014,
A&A, 563, A31, doi: 10.1051/0004-6361/201322803
Rodighiero, G., Daddi, E., Baronchelli, I., et al. 2011,
ApJL, 739, L40, doi: 10.1088/2041-8205/739/2/L40
Rowlands, K., Gomez, H. L., Dunne, L., et al. 2014a,
MNRAS, 441, 1040, doi: 10.1093/mnras/stu605

Rowlands, K., Dunne, L., Dye, S., et al. 2014b, MNRAS,

441, 1017, doi: 10.1093/mnras/stu510

Rujopakarn, W., Daddi, E., Rieke, G. H., et al. 2019, ApJ,

882, 107, doi: 10.3847/1538-4357/ab3791

Saintonge, A., Catinella, B., Tacconi, L. J., et al. 2017,

ApJS, 233, 22, doi: 10.3847/1538-4365/aa97e0
Saintonge, A., Wilson, C. D., Xiao, T., et al. 2018,
MNRAS, 481, 3497, doi: 10.1093/mnras/sty2499

Salvato, M., Ilbert, O., Hasinger, G., et al. 2011, ApJ, 742,

61, doi: 10.1088/0004-637X/742/2/61

Mullaney, J. R., Alexander, D. M., Goulding, A. D., &

Sanders, D. B., Mazzarella, J. M., Kim, D.-C., Surace,

Hickox, R. C. 2011, MNRAS, 414, 1082,
doi: 10.1111/j.1365-2966.2011.18448.x

J. A., & Soifer, B. T. 2003, AJ, 126, 1607,
doi: 10.1086/376841

Muzzin, A., Marchesini, D., Stefanon, M., et al. 2013, ApJ,

Sanders, D. B., Salvato, M., Aussel, H., et al. 2007, ApJS,

777, 18, doi: 10.1088/0004-637X/777/1/18

172, 86, doi: 10.1086/517885

Nanayakkara, T., Glazebrook, K., Kacprzak, G. G., et al.
2016, ApJ, 828, 21, doi: 10.3847/0004-637X/828/1/21

Santini, P., Maiolino, R., Magnelli, B., et al. 2010, A&A,

518, L154, doi: 10.1051/0004-6361/201014748

56

D. Liu et al.

Sargent, M. T., Béthermin, M., Daddi, E., & Elbaz, D.

Spreeuw, J. N. 2010, PhD thesis, University of Amsterdam

2012, ApJL, 747, L31, doi: 10.1088/2041-8205/747/2/L31
Sargent, M. T., Daddi, E., Béthermin, M., et al. 2014, ApJ,

793, 19, doi: 10.1088/0004-637X/793/1/19

Schinnerer, E., Sargent, M. T., Bondi, M., et al. 2010,
ApJS, 188, 384, doi: 10.1088/0067-0049/188/2/384

Schinnerer, E., Groves, B., Sargent, M. T., et al. 2016, ApJ,

833, 112, doi: 10.3847/1538-4357/833/1/112

Schreiber, C., Pannella, M., Elbaz, D., et al. 2015, A&A,

575, A74, doi: 10.1051/0004-6361/201425017

Scoville, N., Aussel, H., Brusa, M., et al. 2007, ApJS, 172,

1, doi: 10.1086/516585

Scoville, N., Aussel, H., Sheth, K., et al. 2014, ApJ, 783, 84,

doi: 10.1088/0004-637X/783/2/84

Scoville, N., Sheth, K., Aussel, H., et al. 2016, ApJ, 820, 83,

doi: 10.3847/0004-637X/820/2/83

Scoville, N., Lee, N., Vanden Bout, P., et al. 2017, ApJ,

837, 150, doi: 10.3847/1538-4357/aa61a0

Silverman, J. D., Kashino, D., Sanders, D., et al. 2015a,

ApJS, 220, 12, doi: 10.1088/0067-0049/220/1/12

Silverman, J. D., Daddi, E., Rodighiero, G., et al. 2015b,
ApJL, 812, L23, doi: 10.1088/2041-8205/812/2/L23
Simpson, J. M., Smail, I., Swinbank, A. M., et al. 2015,
ApJ, 807, 128, doi: 10.1088/0004-637X/807/2/128
—. 2017, ApJ, 839, 58, doi: 10.3847/1538-4357/aa65d0
Smith, D. J. B., & Hayward, C. C. 2015, MNRAS, 453,

Swinbank, A. M., Karim, A., Smail, I., et al. 2012, MNRAS,

427, 1066, doi: 10.1111/j.1365-2966.2012.22048.x

Tacconi, L. J., Neri, R., Genzel, R., et al. 2013, ApJ, 768,

74, doi: 10.1088/0004-637X/768/1/74

Tacconi, L. J., Genzel, R., Saintonge, A., et al. 2018, ApJ,

853, 179, doi: 10.3847/1538-4357/aaa4b4

Tan, Q., Daddi, E., Magdis, G., et al. 2014, A&A, 569,

A98, doi: 10.1051/0004-6361/201423905

Taniguchi, Y., Scoville, N., Murayama, T., et al. 2007,

ApJS, 172, 9, doi: 10.1086/516596

Taniguchi, Y., Kajisawa, M., Kobayashi, M. A. R., et al.

2015, PASJ, 67, 104, doi: 10.1093/pasj/psv106

Tasca, L. A. M., Le Fèvre, O., Ribeiro, B., et al. 2017,
A&A, 600, A110, doi: 10.1051/0004-6361/201527963

Umehata, H., Tamura, Y., Kohno, K., et al. 2017, ApJ, 835,

98, doi: 10.3847/1538-4357/835/1/98

Umehata, H., Hatsukade, B., Smail, I., et al. 2018, PASJ,

70, 65, doi: 10.1093/pasj/psy065

Valentino, F., Magdis, G. E., Daddi, E., et al. 2018, ApJ,

869, 27, doi: 10.3847/1538-4357/aaeb88

van der Wel, A., Franx, M., van Dokkum, P. G., et al. 2014,

ApJ, 788, 28, doi: 10.1088/0004-637X/788/1/28

van der Wel, A., Noeske, K., Bezanson, R., et al. 2016,
ApJS, 223, 29, doi: 10.3847/0067-0049/223/2/29

1597, doi: 10.1093/mnras/stv1727

Walter, F., Brinks, E., de Blok, W. J. G., et al. 2008, AJ,

Smith, D. J. B., Dunne, L., da Cunha, E., et al. 2012,

136, 2563, doi: 10.1088/0004-6256/136/6/2563

MNRAS, 427, 703, doi: 10.1111/j.1365-2966.2012.21930.x

Walter, F., Decarli, R., Aravena, M., et al. 2016, ApJ, 833,

Smolčić, V., Karim, A., Miettinen, O., et al. 2015, A&A,

67, doi: 10.3847/1538-4357/833/1/67

576, A127, doi: 10.1051/0004-6361/201424996

Wang, T., Elbaz, D., Schreiber, C., et al. 2016, ApJ, 816,

Smolčić, V., Novak, M., Bondi, M., et al. 2017, A&A, 602,

84, doi: 10.3847/0004-637X/816/2/84

A1, doi: 10.1051/0004-6361/201628704

Solomon, P. M., & Vanden Bout, P. A. 2005, ARA&A, 43,

677, doi: 10.1146/annurev.astro.43.051804.102221

Song, M., Finkelstein, S. L., Ashby, M. L. N., et al. 2016,

ApJ, 825, 5, doi: 10.3847/0004-637X/825/1/5
Speagle, J. S., Steinhardt, C. L., Capak, P. L., &

Silverman, J. D. 2014, ApJS, 214, 15,
doi: 10.1088/0067-0049/214/2/15

Spilker, J., Bezanson, R., Barišić, I., et al. 2018, ApJ, 860,

103, doi: 10.3847/1538-4357/aac438

Spilker, J. S., Marrone, D. P., Aravena, M., et al. 2016,
ApJ, 826, 112, doi: 10.3847/0004-637X/826/2/112

Yao, L., Seaquist, E. R., Kuno, N., & Dunne, L. 2003, ApJ,

588, 771, doi: 10.1086/374333

Yun, M. S., Aretxaga, I., Gurwell, M. A., et al. 2015,
MNRAS, 454, 3485, doi: 10.1093/mnras/stv1963

Zamojski, M. A., Schiminovich, D., Rich, R. M., et al. 2007,

ApJS, 172, 468, doi: 10.1086/516593

Zavala, J. A., Casey, C. M., da Cunha, E., et al. 2018, ApJ,

869, 71, doi: 10.3847/1538-4357/aaecd2

Zhao, Y., Lu, N., Xu, C. K., et al. 2013, ApJL, 765, L13,

doi: 10.1088/2041-8205/765/1/L13

—. 2016, ApJ, 819, 69, doi: 10.3847/0004-637X/819/1/69

