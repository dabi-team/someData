CORESETOFHYPERSPECTRALIMAGESONASMALLQUANTUMCOMPUTERSoronzonboldOtgonbaatar,MihaiDatcu,Beg¨umDemirDLROberpfaffenhofen,TechnicalUniversityofBerlinABSTRACTMachineLearning(ML)techniquesareemployedtoanalyzeandprocessbigRemoteSensing(RS)data,andonewell-knownMLtechniqueisaSupportVectorMachine(SVM).AnSVMisaquadraticprogramming(QP)problem,andaD-Wavequantumannealer(D-WaveQA)promisestosolvethisQPproblemmoreefﬁcientlythanaconventionalcomputer.However,theD-WaveQAcannotsolvedirectlytheSVMduetoitsveryfewinputqubits.Hence,weuseacoreset(“coreofadataset”)ofgivenEOdatafortraininganSVMonthissmallD-WaveQA.Thecoresetisasmall,representativeweightedsubsetofanoriginaldataset,andanytrainingmodelsgener-atecompetitiveclassesbyusingthecoresetincontrasttobyusingitsoriginaldataset.WemeasuredtheclosenessbetweenanoriginaldatasetanditscoresetbyemployingaKullback-Leibler(KL)divergencemeasure.Moreover,wetrainedtheSVMonthecoresetdatabyusingbothaD-WaveQAandaconventionalmethod.Weconcludethatthecoresetcharacter-izestheoriginaldatasetwithverysmallKLdivergencemea-sure.Inaddition,wepresentourKLdivergenceresultsfordemonstratingtheclosenessbetweenouroriginaldataanditscoreset.AspracticalRSdata,weuseHyperspectralImage(HSI)ofIndianPine,USA.IndexTerms—Coreset,hyperspectralimages,quantumsupportvectormachine,quantummachinelearning1.INTRODUCTIONMostremotelysensedimagesaremassiveanddiversetoclas-sifybyusingMLtechniqueswhencomparedwithconven-tionalimages.Inprinciple,MLisamachineryforidenti-fyingandclassifyingcommonpatternsinalabeledaswellasunlabeleddataset[1].However,trainingmodelsarecom-putationallyexpensiveandintractableonbigdata.Severalstudiesproposedtouseonlyacoreset(“coreofadataset”)ofanoriginaldatasetfortacklingthesecomputationalexpensiveandintractabilitychallengesviaBayesianinference[2],[3],[4].Thiscoresetisasmall,representativeweightedsubsetofanoriginaldataset,andanylearningmodelstrainedonthecoresetgenerateclassescompetitivewiththeonestrainedontheoriginaldataset(seeFig.1).TheconceptofacoresetcreatesanewopportunityfortrainingMLmodelsbyusingsmallquantumcomputers[5],Fig.1.Thesamelearningmodels(ML)trainedonanorigi-naldataset(X,y)anditscoreset(X′,w,y)generateapprox-imatelysimilarresults.[6]sinceacurrentlyavailablequantumcomputer(D-WaveQA)comprisesaveryfewquantumbits(qubits)[7].More-over,thequantumcomputerpromisestosolveanSVMfasterthanaconventionalmethodandsomeintractableproblemsinML[8],[9],[10].WetermedaquantumSVM(qSVM)whensolvingtheSVMonaquantumcomputer,otherwiseaclassi-calSVM(cSVM).ForanalysingpracticalRSdatasets,thereareseveralap-proachesoftrainingMLmodelsandsolvingRSoptimizationproblemsonaD-WaveQA[11],[12],[13],andevenonagate-basedquantumcomputer[14],[15].TheD-WaveQAhasaround5,000inputqubitsandaspeciﬁcPegasustopol-ogyfortheconnectivityofitsqubits[16],anditisdesignedforsolvingaQuadraticUnconstrainedBinaryOptimization(QUBO)problem[9].Inaddition,IfweassumethatasinglevariableofaQUBOproblemisrepresentedby6qubitsthenwehaveapproximately833qubits,andeventhisnumberde-creasesduetoitstopology.Therefore,inthiswork,weselectthecoresetoftheIndianPinehyperspectralimage(HSI)byemployingsparsevariationalinference[3],andthenwetrainaweightedqSVMonourcoresetwhenusingaD-WaveQA.Theotherversionofthisworkisavailablein[17].Fig.2.TheIndianPineHSIwith16classes:{1:Alfalfa,2:Corn-notill,3:Corn-mintill,4:Corn,5:Grass-Pasture,6:Grass-Trees,7:Grass-Pasture-mowed,8:Hay-windrowed,9:Oats,10:Soybean-notill,11:Soybean-mintill,12:Soybean-clean,13:Wheat,14:Woods,15:Building-Grass-Drives,16:Stones-Steel-Towers.2.HSIDATASETTheIndianPineHSIobtainedbyAVIRISsensorhas16classes,andeachclassischarachterizedby200spectralbandsshowninFig.2[18].Forsimplicity,weusedonlytwo-classesoftheIndianPineHSIandcharachterizedeachclassbytwofeaturesbyemployingPrincipalComponentAnalysis(PCA)[13].3.CORESETMETHODInBayesianinference,aposteriordensityp(θ|X)isexpressedbyp(θ|X)=1Zexp(NXi=1fi(θ))p0(θ),(1)whereZisapartitionfunction,fi(θ)isapotentialfunc-tion,p0(θ)isaprior,θparameters,andoriginaldatapoints{(Xi,yi)}Ni=1withitslabelsyi.Inpractice,aMarkovChainMonteCarlo(MCMC)methodiswidelyusedtoobtainsam-plesfromthisposteriorduetotheintractableZ[19].Toob-tainacoresetofthedata{(Xi,yi)}Ni=1,theequation(1)canbere-expressedbypw=pw(θ|X)=1Z(w)exp(NXi=1wifi(θ))p0(θ).(2)Wedenotedthefulldistributionofthedata{(Xi,yi)}Ni=1asp1=p1(θ|X).Moreimportantly,thisposteriorbecomesFig.3.Thepictorialrepresentationofourproposedmethodinthispaper.tractable.Finally,weoptimizethebelowequationviasparsevariationalinference[3]ˆw=minwDKL(pw||p1)s.t.w≥0,w0≤M,(3)whereˆwisanoptimalsparseweightvector,Misacoresetsize,andDKL(pw||p1)istheKullback-Leibler(KL)diver-gencemeasuringthesimilaritybetween(1)and(2).Byoptimizing(3),wederivetheoptimalsparseweightvectorswandthecoresetofourdatasetsuchthat{(Xi,yi)}Ni=1→{(X′i,wi,yi)}Mi=1,wi∈R≥0,(4)where(Xi,yi)isouroriginaldatasetwhen(X′i,wi,yi)isourcoreset.4.WEIGHTEDSVMONTHECORESETWetrainaweightedSVMonthecoresetexpressedbyminimizeH(α)=12Xijαiαjyiyjk(X′i,X′j)−Xiαisubjectto0≤αi≤Ci,andXiαiyi=0,αi∈R,(5)whereCi=wiCisaregularizationparameter,andk(·,·)isthekernelfunctionoftheSVM[19].ThisformulationoftheSVMiscalledakernel-basedweightedcSVM.ThepointXiwithαi=0iscalledasupportvector.ForatestpointXt,thedecisionfunctionisdeﬁnedby:ˆt=sign[f(X′t)]=sign"Xiαiyik(X′i,X′t)+b#,(6)Table1.ThecoresetoftheIndianPineHSIdatasetshowninFig.2,andtheKLdivergencemeasure.ClassesDatasizeCoresetSizeKLdivergence{1,2}295790.573{2,3}452560.003{3,4}214330.000{4,5}144410.017{5,6}243410.001{6,7}7581250.492wheresign(f(X′t))=1iff(X′t)>0,sign(f(X′t))=−1ifsign(f(X′t))<0,andsign(f(X′t))=0otherwise.Thebiasbisexpressedbyfollowing[20]:b=Piαi(Ci−αi)hyi−Pjαjyjk(X′j,X′i)iPiαi(Ci−αi).(7)Inaddition,weemployaradialbasisfunction(rfb)asakernelwrittenbyrbf(X′i,X′j)=expn−γ(cid:1)(cid:1)X′i−X′j(cid:1)(cid:1)2o,(8)whereγ>0isaparameter.5.WEIGHTEDSVMOND-WAVEQUANTUMANNEALERAD-WaveQAisaquantumannealerwithspeciﬁctopologycalledPegasus,anditsverticesofthistopologyareoccupiedbyqubits.TheD-WaveQAusesameta-heuristicprocesstosolveonlyaQUBOproblemH(z)=Xi,jziQijzj,zi,zj∈{0,1},(9)wherezi,zjarecalledlogicalvariables,andQijincludesabiastermhiandtheinteractionstrengthofthelogicalvari-ablesgij[16].TosolvetheweightedcSVMonaD-WaveQA,wetransformtheweightedcSVMgivenin(5)totheQUBOproblemexpressedby(9)byusingαi=K−1Xk=0BkzKi+k,zKi+k∈{0,+1},(10)whereKisthenumberofbinaryvariables(bits),andBisthebase.Intheend,theweightedqSVMbecomesTable2.TheclassiﬁcationaccuracyoftheweightedqSVM,andtheweightedcSVMonourcoreset.ClassesCoresetSizeqacccacc{1,2}790.960.96{2,3}560.700.70{3,4}330.880.88{4,5}410.780.78{5,6}410.710.71{6,7}1250.920.90minimizeH(z)=12XijklzKi+kzKj+lBk+lyiyjk(X′i,X′j)−XikBkzKi+k+λ XikBkzKi+kyi!2=XijXklzKi+kQKi+k,Kj+lzKj+l,(11)whereQKi+k,Kj+l=12Bk+lyiyj(k(X′i,X′j)+λ)−δijδklBk.(12)5.1.OurexperimentWepresentedtheourKLdivergencemeasureinTable1.ThisKLdivergencemeasureimpliesthatthecoresetoftheIndianPineHSIisapproximatelysimilartoitsoriginaldataset.Moreover,wetrainedtheweightedqSVMexpressedby(11)andtheweightedcSVMwrittenby(5)onthiscoreset.Inaddition,wedemonstratedourexperimentalstepsoftheweightedqSVMinFig.3,andwetrainedtheweightedcSVMbyusingthePythonmodulescikit-learn.Finally,wepresentedourclassiﬁcationresultsinTable2,andwenotedourquantumaccuracybyqaccandourclassicalaccuracybycacc.Thisresultdemonstratesthatourcoresetisarepresen-tative,smallsubsetofitsoriginaldataset,andtheqSVMiscompetitiveincomparisonwithitscSVM.6.CONCLUSIONInourpaper,weusedthecoresetoftheIndianPineHSI,andthecoresetisaverysmallandrepresentativeweightedsub-setofitsoriginaldataset.Weevendemonstratedthesimi-laritybetweenourcoresetanditsoriginaldatabycomput-ingtheirKLdivergencemeasure.Thissimilarityimpliesthatwecheaplycomputedtheuncertaintyofouroriginaldatasetbyusingitscoreset.Finally,wetrainedtheweightedqSVMonourcoresetbyusingaD-WaveQA,andweprovedthattheweightedqSVMgeneratesclassescompetitivewiththeweightedcSVMinTable2.7.ACKNOWLEDGMENTTheauthorsgratefullyacknowledgetheJuelichSupercom-putingCentre(https://www.fzjuelich.de/ias/jsc)forfundingthisprojectbyprovidingcomputingtimethroughtheJuelichUNiﬁedInfrastructureforQuantumcomputing(JUNIQ)onaD-Wavequantumannealer.8.REFERENCES[1]DimitriosMarmanis,MihaiDatcu,ThomasEsch,andUweStilla,“Deeplearningearthobservationclassiﬁca-tionusingimagenetpretrainednetworks,”IEEEGeo-scienceandRemoteSensingLetters,vol.13,no.1,pp.105–109,2016.[2]DionysisManousakas,ZuhengXu,CeciliaMascolo,andTrevorCampbell,“Bayesianpseudocoresets,”inAdvancesinNeuralInformationProcessingSystems,H.Larochelle,M.Ranzato,R.Hadsell,M.F.Balcan,andH.Lin,Eds.2020,vol.33,pp.14950–14960,Cur-ranAssociates,Inc.[3]TrevorCampbellandBoyanBeronov,“Sparsevaria-tionalinference:Bayesiancoresetsfromscratch,”inAdvancesinNeuralInformationProcessingSystems,H.Wallach,H.Larochelle,A.Beygelzimer,F.d'Alch´e-Buc,E.Fox,andR.Garnett,Eds.2019,vol.32,CurranAssociates,Inc.[4]TrevorCampbellandTamaraBroderick,“Bayesiancoresetconstructionviagreedyiterativegeodesicas-cent,”ArXiv,May2018.[5]AramW.Harrow,“Smallquantumcomputersandlargeclassicaldatasets,”ArXiv,Mar2020.[6]TeagueTomesh,PranavGokhale,EricR.Anschuetz,andFredericT.Chong,“Coresetclusteringonsmallquantumcomputers,”Electronics,vol.10,no.14,2021.[7]“AD-Wavequantumannealer,”2021.[8]JohnPreskill,“Quantumcomputinginthenisqeraandbeyond,”Quantum,vol.2,pp.79,Aug2018.[9]VasilS.Denchev,SergioBoixo,SergeiV.Isakov,NanDing,RyanBabbush,VadimSmelyanskiy,JohnMarti-nis,andHartmutNeven,“Whatisthecomputationalvalueofﬁnite-rangetunneling?,”Phys.Rev.X,vol.6,pp.031015,Aug2016.[10]VedranDunjkoandHansJBriegel,“Machinelearning&artiﬁcialintelligenceinthequantumdomain:areviewofrecentprogress,”ReportsonProgressinPhysics,vol.81,no.7,pp.074001,jun2018.[11]SoronzonboldOtgonbaatarandMihaiDatcu,“Quan-tumannealerfornetworkﬂowminimizationininsarim-ages,”inEUSAR2021;13thEuropeanConferenceonSyntheticApertureRadar,2021,pp.1–4.[12]GabrieleCavallaro,DennisWillsch,MaditaWillsch,KristelMichielsen,andMorrisRiedel,“Approachingremotesensingimageclassiﬁcationwithensemblesofsupportvectormachinesonthed-wavequantuman-nealer,”inIGARSS2020-2020IEEEInternationalGeoscienceandRemoteSensingSymposium,2020,pp.1973–1976.[13]SoronzonboldOtgonbaatarandMihaiDatcu,“Aquan-tumannealerforsubsetfeatureselectionandtheclassi-ﬁcationofhyperspectralimages,”IEEEJournalofSe-lectedTopicsinAppliedEarthObservationsandRemoteSensing,vol.14,pp.7057–7065,2021.[14]SoronzonboldOtgonbaatarandMihaiDatcu,“Natu-ralembeddingofthestokesparametersofpolarimetricsyntheticapertureradarimagesinagate-basedquantumcomputer,”IEEETransactionsonGeoscienceandRe-moteSensing,pp.1–8,2021.[15]SoronzonboldOtgonbaatarandMihaiDatcu,“Classi-ﬁcationofremotesensingimageswithparameterizedquantumgates,”IEEEGeoscienceandRemoteSensingLetters,pp.1–5,2021.[16]KellyBoothby,PaulBunyk,JackRaymond,andAidanRoy,“Next-generationtopologyofd-wavequantumprocessors,”arXiv:2003.00133,Feb2020.[17]SoronzonboldOtgonbaatarandMihaiDatcu,“Assem-blyofacoresetofearthobservationimagesonasmallquantumcomputer,”Electronics,vol.10,no.20,2021.[18]“Airbornevisible/infraredimagingspectrometer(aviris),”2021.[19]MohammadrezaSheykhmousa,MasoudMahdianpari,HamidGhanbari,FaribaMohammadimanesh,PedramGhamisi,andSaeidHomayouni,“Supportvectorma-chineversusrandomforestforremotesensingimageclassiﬁcation:Ameta-analysisandsystematicreview,”IEEEJournalofSelectedTopicsinAppliedEarthOb-servationsandRemoteSensing,vol.13,pp.6308–6325,2020.[20]D.Willsch,M.Willsch,H.DeRaedt,andK.Michielsen,“Supportvectormachinesonthed-wavequantumannealer,”ComputerPhysicsCommu-nications,vol.248,pp.107006,2020.