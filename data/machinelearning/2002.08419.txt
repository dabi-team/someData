Mode Selection and Resource Allocation in Sliced
Fog Radio Access Networks: A Reinforcement
Learning Approach

Hongyu Xiang, Mugen Peng, Fellow, IEEE, Yaohua Sun, and Shi Yan, Member, IEEE

1

0
2
0
2

b
e
F
3
1

]
I

N
.
s
c
[

1
v
9
1
4
8
0
.
2
0
0
2
:
v
i
X
r
a

Abstract—The mode selection and resource allocation in fog
radio access networks (F-RANs) have been advocated as key
techniques to improve spectral and energy efﬁciency. In this
paper, we investigate the joint optimization of mode selection
and resource allocation in uplink F-RANs, where both of the
traditional user equipments (UEs) and fog UEs are served by
constructed network slice instances. The concerned optimization
is formulated as a mixed-integer programming problem, and both
the orthogonal and multiplexed subchannel allocation strategies
are proposed to guarantee the slice isolation. Motivated by the de-
velopment of machine learning, two reinforcement learning based
algorithms are developed to solve the original high complexity
problem under traditional and fog UEs’ speciﬁc performance
requirements. The basic idea of the proposals is to generate a
good mode selection policy according to the immediate reward fed
back by an environment. Simulation results validate the beneﬁts
of our proposed algorithms and show that a tradeoff between
system power consumption and queue delay can be achieved.

Index Terms—fog radio access network, network slicing, rein-

forcement learning.

I. INTRODUCTION

To handle diverse use cases and business models, a new
technology called network slicing has been investigated ex-
tensively for ﬁfth generation (5G) [1]. In the concept of net-
work slicing, the network slice instances are orchestrated and
chained by a set of network functions to provide customized
services. By enabling ﬂexible support of various applications,
network slicing beneﬁts 5G networks in a cost-efﬁcient way.
As an important part of network slicing, network slicing in
radio access networks (RANs) has been studied to further
improve end-to-end network performance [2].

Although network slicing is a good solution to meet service
requirements in 5G, there are remarkable challenges to be
solved. Traditional core network slicing methods are business-
driven only, which neglect characteristics of the RAN. How-
ever, network slicing in different network architectures are
different, like in heterogeneous networks or cloud RANs (C-
RANs) [3], [4]. Jointly considering characteristics of RANs
and network slicing can be beneﬁcial. Second, the performance
requirements of emerging applications become more stringent.

Copyright (c) 2015 IEEE. Personal use of this material

is permitted.
However, permission to use this material for any other purposes must be
obtained from the IEEE by sending a request to pubs-permissions@ieee.org.
Hongyu Xiang (e-mail: xhyou@bupt.edu.cn), Mugen Peng (e-mail:
pmg@bupt.edu.cn), Yaohua Sun (e-mail:
sunyaohua@bupt.edu.cn), and
Shi Yan (e-mail: yanshi01@bupt.edu.cn) are with the State Key Laboratory
of Networking and Switching Technology, Beijing University of Posts and
Telecommunications, Beijing, China.

To achieve huge capacity, massive connections and ultra-low
latency, resource allocation should be elaborately designed,
which includes not only radio but also caching and computing
resources. Third, as indicated in TS 38.300 [5], it should be
possible for a single RAN node to support multiple slices.
Due to the differentiated capability of each node, the node
association strategy in a sliced RAN becomes critical.

Meanwhile, fog-RANs (F-RANs) have been considered as
a revolutionary paradigm to tackle performance requirements
in 5G [6]. By exploiting the edge caching and computing,
capacity burdens on fronthaul are alleviated and end-to-end
latency is shortened. According to desired performance, each
user equipment (UE) in a F-RAN can select a proper com-
munication mode, which includes C-RAN mode, fog-radio
access point (F-AP) mode, device-to-device (D2D) mode.
With adaptive mode selection and interference suppression,
services and applications, such as the industrial Internet, health
monitoring and Internet of vehicles, can be well supported.

To exploit

the prospect of network slicing in F-RANs,
a hierarchical RAN slicing architecture is presented in this
paper. The proposed architecture shown in Fig. 1 takes full
advantages of both F-RANs and network slicing. According to
the decomposition principle of the control and data planes, the
high power node (HPN) in the network access layer executes
the functions of the control plane, including control signaling
and system broadcasting information delivery for accessed
traditional UEs and fog-UEs (F-UEs). With radio resource
control connections established, the network slice selection
assistance information [5] is utilized to help traditional UEs
and F-UEs for network slice selection. Numerous modes are
provided in the data plane for a differentiated handling of
trafﬁc. Specially, the remote radio heads (RRHs) are cooper-
ated with each other in the baseband unit (BBU) pool, which
provides the C-RAN mode in the data plane. Thanks to the
fog computing, F-APs are used to process local collaboration
radio signal and D2D mode can be further triggered to meet
performance requirements.

In the RAN slicing architecture, mode selection and re-
source allocation are critical for improving performance of
network slices. To achieve a high data rate, UEs should
associate with RRHs to leverage large scale centralized signal
processing in the BBU pool. To alleviate transmission burdens
on fronthaul and save system power, local data processing
should be available, which are enabled by F-APs and F-
UEs. Consequently, for UEs with different performance re-
quirements, advanced mode selection are in need. Note that

 
 
 
 
 
 
the data transmission under different modes would consume
not only radio but also computing resource. Like in C-RAN
mode, centralized processing and large-scale collaborative
transmission requires global coordination, scheduling and con-
trol, of which the computing complexity typically increases
polynomially with the network size [6]. Hence it is important
to coordinate the computing and radio resource. To meet
the performance requirements of traditional UEs and F-UEs,
both multi-dimensional resource management and communi-
cation mode selection in sliced F-RANs should be tackled
elaborately. Considering their coupling, a joint optimization
of mode selection and resource allocation is essential. To
determine the best mode selection and coordinate the multi-
dimensional resource, intelligent decision-making mechanisms
are promising, which consider the channel states of different
modes, the computing load at each F-AP, the performance
requirements of traditional UEs and F-UEs and the total power
consumption.

Based on the aforementioned characteristics of mode selec-
tion and resource allocation, the joint optimization solution to
system power minimization in sliced F-RANs is researched in
this paper.

A. Related Work

F-RANs have emerged as a promising 5G RAN that can
satisfy diverse quality of service (QoS) requirements in 5G.
With coordination among the communication, computation
and caching, QoS requirements like high spectral efﬁciency,
high energy efﬁciency and low latency for different service
types can be met. Many studies on F-RANs have been con-
ducted, like computation ofﬂoading in [7], and edge caching
strategies in [8], [9]. In [7], the impact of fog computing on
energy consumption and delay performance are investigated.
With queuing models established, a multi-objective optimiza-
tion problem considering energy consumption, execution de-
lay and payment cost is formulated. Using the scalarization
method and interior point method, superior performance over
the existing schemes is achieved. In [8], a joint optimization
of caching and user association is studied. By decomposing
the original problem, a distributed algorithm based on the
Hungarian method is proposed. Simulation results show that
with an efﬁcient caching policy, the average download delay
can be signiﬁcantly reduced. In [9], a new metric called
economical energy efﬁciency is adopted. With cache status and
fronthaul capacity considered, a resource allocation problem is
formulated and solved by using fractional programming. Ad-
vantages of the proposed algorithm including system greenness
improvement are conﬁrmed.

There have also been numerous works on RAN slicing that
demands efﬁcient resource allocation, resource isolation and
sharing [10]. In [2], the application of network slicing in an
ultra-dense RAN is studied. To improve the quality of compu-
tation experience for mobile devices, the design of computa-
tion ofﬂoading policies is investigated. Considering the time-
varying communication qualities and computation resources,
a stochastic computation ofﬂoading problem is formulated
and then a deep reinforcement learning (DRL) framework is

2

proposed, which achieves a signiﬁcant improvement in compu-
tation ofﬂoading performance compared with baseline policies.
In [3], a dynamic radio resource slicing framework is presented
for a two-tier heterogeneous wireless network. By partitioning
radio spectrum resources into different bandwidth slices for
sharing, the framework achieves differentiated QoS provision-
ing for services in the presence of network load dynamics.
In [4], two typical 5G services in a C-RAN are considered
and speciﬁc slice instances are orchestrated. To maximize the
cloud RAN operator’s revenue, efﬁcient approaches including
successive convex approximation and semideﬁnite relaxation
are exploited. With acceptable time complexities, the proposed
algorithm signiﬁcantly saves system power consumption. In
[11], hierarchical radio resource allocation is studied for RAN
slicing in F-RANs, where a global radio resource manager
performs a centralized subchannel allocation while local radio
resource managers allocate assigned resources to UEs to facil-
itate slice customization. In [12], the network slicing in multi-
cell virtualized wireless networks is considered. To maximize
the network sum rate, a joint BS assignment, sub-carrier, and
power allocation algorithm is developed. Simulation results
demonstrate that under the minimum required rate constraint
of each slice, the proposed iterative algorithm outperforms the
traditional approach, especially in the respect of the coverage
improvement and spectrum efﬁciency enhancement. In [13],
the combinatorial optimization of multi-dimensional resources
in network slicing is investigated. To deal with the dilemma
between network provider and tenants, a real-time resource
slicing framework based on semi-Markov decision process
is developed, which considers the long-term return of the
network provider and the uncertainty of resource demands
from tenants. Taking advantages of deep dueling neural net-
work, the proposed framework can improve the performance
of the system signiﬁcantly. In [14], a novel spectral efﬁciency
approach is proposed to the allocation of resource blocks for
different services. By learning in advance whether resources
is adequate to provide service, unsuccessful allocation process
is avoided. Simulations show that the approach signiﬁcantly
improves the spectral efﬁciency with respect to a single-slot
based model.

Note that there still exist challenges in RAN slicing. For
example, the ever-increasingly complicated conﬁguration is-
sues and blossoming new performance requirements would
be challenging in 5G, since only predeﬁned problems can be
dealt with by the network. To realize an intelligent implemen-
tation of network slicing, artiﬁcial intelligence has attracted
particular attentions. By enabling networks be capable of
interacting with environments, a network can automatically
recognize a new type of application, infer an appropriate
provisioning mechanism and establish a required network slice
[15]. Meanwhile, with network scenarios becoming hetero-
geneous and complicated, cost-efﬁcient and low-complexity
algorithms based on machine learning can be developed for
practical implementations [16]. With network patterns and
user behaviors learned and predicted, an intelligent decision
making system can be established to improve the network
performance.

There have been numerous works about applications of ar-

tiﬁcial intelligence and machine learning in wireless networks
[17]. In [18], the resource allocation schemes for vehicle-
to-vehicle (V2V) communications are investigated. To avoid
the large transmission overhead in the traditional centralized
method, a novel decentralized resource allocation mechanism
based on deep reinforcement learning is proposed. Each V2V
link or a vehicle acts as an independent agent and ﬁnds
the optimal sub-band and transmission power autonomously.
Simulation results showed that each agent can effectively
learn to satisfy the stringent latency constraints on V2V links
while minimizing the interference to vehicle-to-infrastructure
communications. In [19], applications of machine learning to
improve heterogeneous network trafﬁc control are researched.
Based on trafﬁc patterns at the edge routers, a supervised
deep learning system is trained. Compared with benchmark
routing strategy, the proposed system outperforms in terms
of signaling overhead, throughput, and delay. In [20], a DRL
assisted resource allocation method is designed for ultra dense
networks. The original multi-objective problem is decoupled
into two parts based on the general theory of DRL. The
spectrum efﬁciency (SE) maximization is utilized to build
the deep neural network. The residual objectives like energy
efﬁciency (EE) and fairness, are considered as the rewards to
train the deep neural network. Simulation results show that,
the proposed method signiﬁcantly outperforms the existing
resource allocation algorithms in term of the tradeoff among
the SE, EE and fairness. In [21], the joint SE and EE opti-
mization in cognitive radio networks are studied and a deep-
learning inspired message passing algorithm is proposed. To
learn the optimal parameters of the algorithm, a feed-forward
neural network is devised and an analogous back propagation
algorithm is developed. The simulation results show that
the proposed algorithm achieves a lower power consumption
for secondary users accessing the licensed spectrum while
preserving the capacity of the primary users.

In this paper, we focus on the mode selection and resource
allocation in a sliced F-RAN, which is formulated as a mixed
integer programming. To deal with the NP-hard problem,
RL is adopted to generate an efﬁcient solution. Combining
the strength of both supervised and unsupervised learning
methods, the RL techniques have been widely used in wireless
networks [22]. In [23], mode selection and resource allocation
in D2D enabled C-RANs are investigated and a distributed
approach based on RL is proposed, where D2D pairs perform
self-optimization without global channel state information. In
[24], a decentralized and self-organizing mechanism based on
RL techniques is introduced to reduce inter-tier interference
and improve spectral efﬁciency. Simulation results show that
the proposed mechanism possesses better convergence proper-
ties and incurs less overhead than existing techniques. To of-
ﬂoad the trafﬁc in a stochastic heterogeneous cellular network,
an online RL framework is presented in [25]. By modeling
as a discrete-time Markov decision process, the energy-aware
trafﬁc ofﬂoading problem is solved by a centralized Q-learning
algorithm with a compact state representation.

3

B. Main Contributions

Motivated by the beneﬁts of machine learning, the uplink
of a sliced F-RAN is concerned in this paper. In particular, an
optimization framework for RAN slicing is presented, which
takes the queue stabilities of traditional UEs and bit rate
requirements of F-UEs into consideration. Both orthogonal and
multiplexed subchannel strategies are considered. The main
contributions of the paper are:

1) The joint optimization on mode selection and resource
allocation in the uplink sliced F-RAN are investigated,
where traditional UEs and F-UEs are served by con-
structed network slice instances. Both the orthogonal and
multiplexed subchannel strategies are presented. Under
different UEs’ demands and limited computing resources,
a system power minimization problem is formulated,
which is stochastic and mixed-integer programming. Us-
ing the general Lyapunov optimization framework, this
nonconvex optimization problem is transformed into a
minimization of the drift-plus-penalty function, which can
be further reformulated as a deterministic mode selection
and resource allocation problem at each slot.

2) RL-based approaches are proposed to solve the refor-
mulated mode selection and resource allocation problem.
Unlike previous work in [3], [4], [11], this paper applies
the RL techniques to solve the drift-plus-penalty mini-
mization under different subchannel allocation strategies.
Speciﬁcally, communication modes are selected based
on learned policies. Afterwards, transmission power of
traditional UEs and F-UEs are derived by a general-
ized weighted minimum mean-square error (WMMSE)
approach. Through the RL-based approaches, a long-term
system performance optimization can be achieved.

3) The proposed approaches are evaluated under different
conditions. Impacts of different parameters like comput-
ing resource are evaluated. By simulation, it is observed
that
the RL-based approach can provide real-optimal
performance. By changing the value of the deﬁned trade-
off parameter, tradeoff between traditional UEs’ queuing
delay and system power consumption can be controlled
in a ﬂexible and efﬁcient way.

The remainder of this paper is organized as follows. Section
II introduces the system model including the communication
model and computing model. In Section III,
the system
power minimization problem is formulated and transformed
into a deterministic problem based on the general Lyapunov
optimization framework. In Section IV, both the orthogonal
and multiplexed subchannel strategies are considered, which
enable different levels of slice isolation. Corresponding RL-
based algorithms are designed to solve the deterministic prob-
lem. Section V evaluates the performance of the proposed
algorithms, followed by the conclusions in Section VI.

II. SYSTEM MODEL

The system model is elaborated in this section, including
the considered F-RAN model, communication model and
computing model.

A. The F-RAN model

The scenario considered in this paper is illustrated in Fig.
1. It assumes an F-RAN architecture consisting of a terminal
layer, a network access layer and a cloud computing layer. In
the cloud computing layer, the BBU pool provides centralized
signal processing. And in the network access layer, there are
L1 distributed RRHs connected with the BBU pool, each of
which is single-antenna. There are also M0 F-APs conﬁgured
with L0(L0 < L1) antennas. Owing to fog computing,
collaborative radio signal processing can not only be executed
in the centralized BBU pool but also at distributed F-APs.
We also assume that the network operates in slotted time
with time dimension partitioned into decision slots indexed
by t ∈ {0, 1, 2, ...}

Fig. 1. The single antenna system model of the RAN slicing architecture,
wherein network slices for traditional UEs and F-UEs are constructed.

There are K0 single-antenna traditional UEs and K1 single-
antenna F-UEs in the terminal layer, whose sets are denoted
as K0 and K1, respectively. Examples of traditional UEs
include agricultural ﬁeld monitoring sensors, and industrial
monitoring devices, which desire low power consumption and
have random bursty trafﬁc arrivals. F-UEs can be smartphones
or laptops [6], which are always equipped with a large
buffer. To provide a high data rate for each F-UE, a network
slice instance is constructed, which is composed of multiple
modes and corresponding physical resource. In the C-RAN
mode, RRHs are cooperated for uplink data reception and the
BBU pool provides centralized signal detection and baseband
processing. Moreover, F-APs are deployed for a local service
to alleviate the burden on the fronthaul. Similarly, both C-
RAN mode and F-AP mode are available in the network slice
instance speciﬁc for traditional UEs. However, the objective is
to maintain a low power consumption and stable transmission
delay for traditional UEs. In addition, F-UEs can beneﬁt
both network slice instances via the D2D mode. Specially,
F-UEs relay the data trafﬁc of other F-UEs, which extends
the coverage of the slice instance for F-UEs; while in the
slice instance for traditional UEs, F-UEs aggregate the data to
allow more traditional UEs to be connected simultaneously.

There are N subchannels to be allocated, each of which
is with bandwidth W0. In this paper, we consider both
the orthogonal and multiplexed subchannel strategies. In the
former, subchannel n is allocated to at most one traditional
UE i or F-UE j, which enables hard isolation between slice
instances. While in the latter, subchannel n can be shared

4

among multiple traditional UEs and F-UEs. In this strategy,
the isolation between the slice instances would be guaranteed
with a sophisticated mode selection and resource allocation.
Although slice isolation in current works is guaranteed mainly
through an orthogonal subchannel allocation strategy. To
achieve higher spectrum utilization, it is still necessary to
investigate a multiplexed subchannel allocation strategy.

B. The communication model

To achieve the rate requirement Rth, F-UE j should connect
to the proper F-AP/RRHs. Denote the communication mode
selection of F-UE j at slot t as sT X
j,m,n(t), which equals
to 1 when F-AP m (m ∈ {1, 2, ..., M0}) is selected and
subchannel n is allocated and equals to 0 otherwise. For
notation simplicity, we deﬁne that sT X
j,0,n(t) = 1 in the case
that C-RAN mode is selected (i.e., all RRHs are connected)
and subchannel n is allocated. Suppose that the optimal linear
detection, i.e., MMSE detection, is employed, the uplink rate
of F-UE j at slot t when sT X

Rj,m,n(t) = W0sT X

j,m,n(t)log(1+

Intj,m,n =

k6=j,k∈K0∪K1
X

j,m,n(t) = 1 is
Pj,n(t)kvH
j,m,n(t)hj,m,n(t)k2
Intj,m,n + σ2kvj,m,n(t)k2 ),
j,m,n(t)hk,m,n(t)k2,

Pk,n(t)kvH

(1)

where Pj,n(t) is the transmission power of F-UE j on subchan-
nel n, hk,m,n(t) is the channel vector between UE k and the
F-AP m on subchannel n, vj,m,n(t) is the MMSE detection
vector, and σ2 is the noise power. Note that these channel
vector data account for the antenna gain, path loss, shadow
fading, and fast fading together.

Similarly, the rate Ri(t) of traditional UE i can be obtained,

M0+K1

N

Ri(t) =

Ri,m,n(t). Besides guaranteeing a precise

m=0
P

n=1
rate threshold Rmin
, a stable queue backlog is also considered
P
i
for traditional UE i given its random trafﬁc arrival character-
istics. Let Qi(t) represent the queue backlog for traditional
UE i in slot t. As shown in Fig. 1, we have the following
expression for the dynamics of queue backlog Qi(t),

Qi(t + 1) = max{Qi(t) − Ri(t), 0} + Ai(t),

(2)

where Ai(t) is the number of bits for traditional UE i to
be uploaded in time slot t. Note that Ai(t) varies over time
and we have E{Ai} = λi. To minimize the average queue
backlog and maintain stability, we seek to perform a queue-
aware resource allocation. A deﬁnition on the queue stability
which bounds the average queue backlog is described in (3).
Deﬁnition 1: (Queue stability [26]). The queue backlog
Qi(t) which is a discrete time process would be mean-rate
stable if

C0 : lim
t→∞

E{|Qi(t)|}
t

= 0, i ∈ K0

(3)

Besides RRHs and F-APs, F-UE j ∈ K1 can be also selected
as serving nodes of UE k (sT X
k,j,n(t) = 1). Taking advantage of
a large buffer, an F-UE can help upload the data of other F-
UEs and traditional UEs. For example, F-UE 1 in Fig. 1 is out

of the coverage area, and then its neighbor, F-UE 2, is selected
to deliver the data trafﬁc. F-UE 3 acts as a relay for the data
trafﬁc from traditional UE 1 to the F-AP, since the maximum
transmission power of traditional UE 1 is limited. Thus in
addition to uploading Rth bits at slot t to guarantee its own
rate requirement, F-UE j needs to relay the trafﬁc of other UEs
which are received at the last slot. The bit rate requirement of

F-UE j at slot t is

K0+K1

N

1{

sT X
k,j,n(t) ≥ 1}Rk(t−1)+Rth,

k=1
P

n=1
P

sT X
k,j,n(t) ≥ 1} is an indicator function that equals

to 1 when

sT X
k,j,n(t) ≥ 1 holds and equals to 0 otherwise.

N

where 1{

n=1
N
P

n=1
P
C. The computing model

Computing resource provision in the BBU pool and F-APs
plays a key role in boosting the potential of F-RANs. As it is
shown in the aforementioned communication model, there are
baseband processing and MMSE detector generation. In this
paper, we construct the computing model which follows that
in [27] and corresponding details are as follows.

• For baseband processing, it consists of inverse fast fourier
transform (IFFT), demodulation and decoding. The IFFT
consumes constant computing resource, which is assumed
as Ccons, while the computing resource required by
demodulation and decoding is approximated as µ1Rk(t).
• For MMSE detector generation, the computational com-
plexity depends on the number of antennas. Taking the
case of sT X
k,0,n(t) = 1 as an example, we assume that
the computing resource consumed by the calculation of
vk,0,n(t) is µ0L3
1.

Overall, computing resource consumption for UE k are

modeled as

Ck(t) =µ0

N

M0

(
n=1
m=1
X
X

sT X
k,m,n(t)L3

0 + sT X

k,0,n(t)L3

1)+

(4)

µ1Rk(t) + Ccons, k ∈ K0 ∪ K1

where µ0 and µ1 are the slopes. Considering the limited com-
puting resource at F-APs, the number of UEs accessing F-APs
should be under a threshold. Suppose DCP U
is the computing
resource available at F-AP m, we have the following constraint
on computing resource consumption.

m

K0+K1

N

C1 :DCP U

m ≥

1{

sT X
k,m,n(t) ≥ 1}Ck(t),

k=1
X

n=1
X

m ∈ {0, 1, 2, ..., M0}.

5

original stochastic problem is reformulated as a deterministic
problem at each slot.

A. Problem formulation

For the concerned uplink F-RAN, the system power con-
sumption is incurred by fronthaul transmission and wireless
transmission, which is given by

K0

N

P (t) =

1
η0

K1

N

j=1
X

n=1
X

1
η1

Pj,n(t)

Pi,n(t) +

N

(6)

i=1
X

n=1
X
K0+K1

+

k,0,n(t)P f ronthaul,
sT X

k=1
X

n=1
X

where η0 and η1 are the efﬁciencies of the power ampliﬁer at
each traditional UE and F-UE, respectively, P f ronthaul is the
constant power consumption caused by fronthaul transmission.
Despite the mean-rate stable constraint deﬁned in C0 and
computing resource constraint deﬁned in C1, there are also
performance constraints to be considered. As stated in follow-
ing C2 and C3, the rate of traditional UE i should be larger
than its threshold Rmin
, while for an F-UE j, its rate has to
be large enough to upload all the bits in its buffer.

i

C2 : Ri(t) > Rmin
K0+K1

i

, i ∈ K0,

N

C3 : Rj(t) >

1{

sT X
k,j,n(t) ≥ 1}Rk(t − 1)

(7)

k=1
X
+ Rth, j ∈ K1.

n=1
X

To upload traditional UE’s bits and maintain the required
rate for F-UEs, a decision on mode selection should be prop-
erly made. Although ofﬂoading all the uploaded bits to F-APs
can reduce system power consumption, computing resource at
F-APs are limited. In this paper, our aim is to perform efﬁcient
mode selection and resource allocation, which are described
by a tuple {sT X
k,m,n(t), Pk,n(t)}. Combining the constraints and
performance requirements, we formulate the system power
optimization problem as below.

min
k,m,n(t),Pk,n(t)}

{sT X

¯P = lim
T →∞

subjects to

C0, C1, C2, C3,

1
T

T −1

t=0
X

E {P (t)}

(8)

(5)

C4 : Pk,n(t) ≤ 1{

k,m,n(t) = 1}P max
sT X

k,n , ∀k, n,

M0+K1

According to the computing model (4), UEs will consume
more computing resource in C-RAN mode than F-AP mode,
since there are more antennas utilized (L0 < L1). Moreover,
there is no computing resource consumption for the UEs
choosing D2D mode.

C6 :

C7 :

m=0
X

C5 : sT X

k,m,n(t) ∈ {0, 1}, ∀k, m, n,
M0+K1

sT X
k,m,n(t) ∈ {0, 1}, ∀k, n,

m=0
X
M0+K1

N

sT X
k,m,n(t) ∈ {0, 1}, ∀k,

III. PROBLEM FORMULATION AND LYAPUNOV
OPTIMIZATION

In this section,

the concerned optimization problem is
presented at ﬁrst. Then with the Lyapunov framework, the

m=0
X

n=1
X

where C0 is to achieve a stable queue backlog for each
traditional UE, C1 is the computing resource constraint, C2
and C3 are to satisfy the rate requirement for traditional UEs
and F-UEs, respectively, and C4 means if subchannel n is not

allocated to UE k ∈ K0 ∪ K1, the transmission power Pk,n(t)
has to be 0 and limited by the maximum transmission power
P max
otherwise. C5 is the communication mode selection
k,n
constraint, C6 implies that at most one mode can be selected
by UE k on subchannel n, and C7 means at most 1 subchannel
can be allocated to UE k.

Solving problem (8) is difﬁcult due to the following reasons.
First, the problem with aforementioned constraints is a non-
linear optimization problem and falls within the category of
mixed integer programming. Traditional methods like branch-
and-bound and genetic algorithms that can be applied are
centralized and will result in high complexity. Second, the
scale of the problem will increase as the number of tradi-
tional UEs/F-UEs grows. Third, the problem includes future
information like bit rates and queue backlog, which vary over
time and are hard to precisely predict. How to make decisions
on {sT X
k,m,n(t), Pk,n(t)} to adapt to dynamic trafﬁc is of great
challenge.

B. General Lyapunov optimization

Fortunately, with Lyapunov optimization [26], the original
optimization problem with the time-averaged constraints C0
can be transformed into a queue mean-rate stable problem,
which can be solved only based on the observed channel
state information and queue backlogs at each time slot. Let
Q(t) = {Qi(t)} deﬁne queue backlog set. Taking advantage
of Lyapunov optimization, a Lyapunov function is deﬁned as
a scalar metric of queue congestion:

The average queue delay is deﬁned as the average length of
all queues, which satisﬁes

6

Q = lim
T →∞

1
T

T −1

K0

t=0
X

i=1
X

E {Qi(t)} ≤

B +V (P ∗ − Pmin)
ǫ

.

(13)
Proof: Since (11) holds for any slot, we can take expec-

tations of both sides and we have

E {L(Q(t + 1))} − E {L(Q(t))} + V E {P (t)}

≤B + V P ∗ −

ǫQi(t).

K0

i=1
X

Sum over t ∈ {0, 1, 2, · · · , T − 1} and using the law of

telescoping sums, it yields

E {L(Q(T ))} − E {L(Q(0))} + V

E {P (t)}

T −1

≤BT + V T P ∗ −

ǫQi(t).

T −1

K0

t=0
X

i=1
X

t=0
X

(14)

Based on the fact that Qi(t) ≥ 0, Pmin ≤ E {P (t)} for all

t, we rearrange (14) to obtain yields

E {L(Q(T ))} − E {L(Q(0))} + V T Pmin ≤ BT + V T P ∗,

which could be furthermore rearranged according to deﬁnition
of Lyapunov function

L (Q(t)) ,

1
2

K0

Q2

i (t).

i=1
X

Then the Lyapunov drift is deﬁned, which pushes the queue
backlog to a lower congestion state and keeps queues stable,

∆ (Q(t))

∆= E {L (Q(t + 1)) − L (Q(t)) |Q(t)} .

(10)

we have

(9)

E

Q2

i (T )

≤ 2E {L(Q(0))} + 2BT + 2V T P ∗ − 2V T Pmin.
(15)

(cid:9)

(cid:8)
Note that {E {|Qi(T )|}}2 ≤ E

Q2

i (T )

holds for any T ,

To combine the queue backlog and system power con-
sumption, the drift-plus-penalty ∆(Q(t))+VE {P (t)|Q(t)} is
deﬁned, where V is a non-negative parameter controlling the
tradeoff between the average system power and the average
queue delay. Suppose that the expectation of P (t) is de-
terministically bounded by ﬁnite constants Pmin, Pmax, i.e.,
Pmin ≤ E {P (t)} ≤ Pmax. Let P ∗ denote the theoretical
optimal value of (8), and then the relationship between the
drift-plus-penalty function and C0 is established in Theorem
1,

Theorem 1: (Lyapunov optimization). Suppose there exist
positive constants B, ǫ and V such that for all slots t and all
possible Q(t), the drift-plus-penalty function satisﬁes:

∆ (Q (t)) + VE {P (t)|Q(t)} ≤ B + VP ∗ −ǫ

K0

i=1
X

Qi(t).

E {|Qi(T )|} ≤

(cid:9)
2E {L(Q(0))} + 2BT + 2V T P ∗ − 2V T Pmin.

(cid:8)

(16)
Dividing both sides by T and taking the limit as T → ∞,

p

we have

lim
T →∞

E{|Qi(T )|}
T

= 0.

(17)

According to Deﬁnition 1, the queue of traditional UE i
is mean-rate stable. A similar proof can be applied to the
queues of other traditional UEs, which indicates constraint C0
is satisﬁed.

Moreover, the following inequality is obtained by rearrang-

ing the terms in (14)

T −1

V

E {P (t)} ≤ BT + V T P ∗ + E {L(Q(0))} ,

(18)

Then C0 is satisﬁed and the average system power meets

P = lim
T →∞

1
T

T −1

t=0
X

E {P (t)} ≤ P ∗ +

B
V

.

(12)

with some non-negative terms neglected when appropriate.
Dividing both sides of (18) by V T and taking the limit as
T → ∞, the inequality (12) is obtained based on the fact that
E {L(Q(0))} < ∞.

(11)

t=0
X

Similarly, inequality (14) can also be re-written as

Taking conditional expectations of both sides, we have

7

T −1

K0

t=0
X

i=1
X

ǫQi(t) ≤BT + V T P ∗ − E {L(Q(T ))}

T −1

∆ (Q (t)) ≤

1
2

i=1
X
K0

+ E {L(Q(0))} − V

E {P (t)}

(19)

−

K0

E

R2

i (t) + A2

i (t)|Q(t)

(cid:8)
Qi(t)E {Ri(t)−Ai(t)|Q(t)}

(cid:9)

(22)

≤BT + V T P ∗ − E {L(Q(T ))}
+ E {L(Q(0))} − V T Pmin.

t=0
X

Dividing (19) by ǫT and taking the limit as T →
that

inequality (13) is obtained according to the fact

∞,
E {L(Q(T ))} < ∞.

Theorem 1 suggests that by adjusting the value of parameter
V , a near-to-optimal solution can be obtained which provides
an average system power arbitrarily close to the optimum P ∗.
Moreover, it is also shown that there exists an [O(1/V ), O(V )]
tradeoff between the average system power and the average
queue delay. With an increase of parameter V , the achieved
system power consumption becomes lower at
the cost of
incurring a larger queuing delay. Therefore, a larger V is
suitable for the delay tolerable UEs to obtain the required
performance.

Instead of minimizing the drift-plus-penalty directly, we aim
to push the drift-plus-penalty’s upper bound to its minimum.
Based on the queue dynamics of Q(t) and the deﬁnition of
Lyapunov drift in (10), the following lemma holds for the
upper bound of drift-plus-penalty.

Lemma 2: (Upper bound of Lyapunov drift-plus-penalty).
At any time slot t, with the observed queue state Q(t) and
parameter V , there exists an upper bound for the drift-plus-
penalty under any control policy:
∆ (Q (t)) + VE {P (t)|Q(t)}

≤B + VE {P (t)|Q(t)} −

Qi(t)E {Ri(t)−Ai(t)|Q(t)}.

K0

i=1
X

(20)

where B > 0 is a ﬁnite constant which is larger than

1
2

K0

i=1
P

E

R2

i (t) + A2

i (t)|Q(t)

for any t.

(cid:8)

Proof: Squaring both sides of (2) and combining the
inequality (max{Qi(t) − Ri(t), 0})2 ≤ (Qi(t) − Ri(t))2, the
following inequality can be obtained

(cid:9)

Q2

i (t + 1) = max{Qi(t) − Ri(t), 0}2 + A2

i (t)
+ 2Ai(t) max{Qi(t) − Ri(t), 0}

≤(Qi(t) − Ri(t))2 + A2

i (t)

≤Q2

+ 2Ai(t) max{Qi(t) − Ri(t), 0}
i (t) + Ri(t)2 + A2
− 2Qi(t)Ri(t) + 2Ai(t)Qi(t)

i (t)

Summing (21) over i ∈ {1, 2, · · · , K0}, we obtain

L (Q(t + 1)) − L (Q(t))

(21)

≤

1
2

K0

i=1
X

(cid:8)

R2

i (t) + A2

i (t)

K0

−

Qi(t) {Ri(t)−Ai(t)}.

i=1
X

(cid:9)

i=1
X

K0

≤B −

Qi(t)E {Ri(t)−Ai(t)|Q(t)}.

i=1
X
By adding VE {P (t)|Q(t)}, we have (20).

Based on the concept of opportunistically minimizing an
expectation, the policy that minimizes E {P (t)|Q(t)} is the
one that minimizes P (t) with the observation of Q(t) during
each slot. Since neither Qi(t)Ai(t) nor B in (20) will be
affected by the policy at slot t, the upper bound minimization
for the drift-plus-penalty can be accomplished by solving the
following deterministic problem at slot t:

K0

V P −

QiRi

min
k,m,n,Pk,n}

{sT X

i=1
X
s.t. C1 ∼ C7.

(23)

As it is shown in (23), the power-minus-rate function as an
optimization target is not convex on either variable sT X
k,m,n or
variable Pk,n.

IV. SOLUTION FOR ORTHOGONAL AND MULTIPLEXED
SUBCHANNEL STRATEGIES

The non-convex problem (23), which includes integer vari-
ables {sT X
k,m,n} and continuous variables {Pk,n}, is hard to be
solved. Although methods like branch-and-bound and genetic
algorithms can be utilized to solve the integer parts, these
existing solutions require a huge complexity when simulta-
neously considering all traditional UEs, F-UEs, F-APs and
RRHs. Moreover, the residual part of the problem (23) is still
non-convex, because the rate term Ri in the power-minus-
rate function depends on the transmission power {Pk,n} of
traditional UEs and F-UEs using the same subchannel n.

In this section, we consider the mode selection and resource
allocation under orthogonal and multiplexed subchannel strate-
gies. To overcome the above challenges, a centralized approach
based on Q-learning and softmax decision-making is proposed
for the orthogonal subchannel strategy. For the multiplexed
subchannel strategy, limitations on the subchannel allocation
are relaxed. In this case, a distributed approach is developed,
where each traditional UE or F-UE needs to consider only its
own mode selection possibilities.

A. Centralized RL-based solution for the orthogonal subchan-
nel strategy

A centralized approach for mode selection is proposed
based on Q-learning. In particular, the deﬁnition of states
in Q-learning is related to current mode selection of UEs.
the state is
To decrease the dimensions of the Q table,
s = {k0, sk|k = 1, 2, ..., K0 + K1}, in which k0 implies that

during the current iteration, only UE k0 would reselect a mode
according to the action, and the element sk = n+mN denotes
that subchannel n has been allocated to UE k connecting to F-
AP m (namely sT X
k,m,n = 1). Considering constraints C5∼C7,
we deﬁne the action as a = n + mN . With action a selected,
the element k0 and corresponding sk0 in state s change and
the current state transits to the next state.

The Q-value in the Q-learning is deﬁned as the discounted
accumulative reward and starts at a tuple of a state and an
action, which is updated as follows

Qk,m,n ← (1 − α)Qk,m,n + αWk,m,n,

(24)

where α ∈ (0, 1) is the learning rate, and Wk,m,n is the reward
resulting from taking action a. Note that in the orthogonal
subchannel strategy, subchannel, for example n∗ can not be
shared among UEs. Hence in given state s, there is an element
sk′ being n∗ + mN (m ∈ {0, 1, ..., M0 + K1}). If the action
is chosen and a = n∗ + m′N (m′ ∈ {0, 1, ..., M0 + K1}), the
reward has to be 0 (Wk,m,n∗ = 0). Otherwise, the value of
reward Wk,m,n is deﬁned as a value between 0 and 1 that
decreases when the power-minus-rate increases:




Wk,m,n =

, k ∈ K0,

1 −

V0Pk,n+sT X
V0P max

k,n +sT X

k,0,nV P f ronthaul −QkRk,m,n
k,0,nV P f ronthaul−QkRmin
k,0,nV P f ronthaul
k,0,nV P f ronthaul ,

V1Pk,n+sT X
V1P max
k,n +sT X

1 −

k



k ∈ K1,
(25)
where V0 = V
. Note that the reward function is
η0
deﬁned according to the UE’s performance requirement. Since
the mean-rate stable is considered only for each traditional UE,
the reward function of UE is different from F-UE’s.

and V1 = V
η1

Here, the softmax selection policy [28] is used to determine
the communication mode. The probability P rk,m,n of UE k
selecting F-AP m on subchannel n is calculated as

P rk,m,n =

e
M0+K1

N

Qk,m,n
τ

m′=0
P

n′=1
P

, k ∈ K0 ∪ K1,

(26)

Q

k,m′,n′
τ

e

where τ = τ0/ log(1 + tepi) is the temperature parameter. At
the beginning, the temperature parameter is high, which leads
to a nearly equiprobable selection among the different modes.
As the episode tepi increases, the value of the temperature
parameter decreases and greater difference in selection prob-
abilities {P rk,m,n} occurs. The larger the estimated value of
Qk,m,n is, the higher the probability P rk,m,n is.

After {sT X

k,m,n} are identiﬁed via Q-learning, problem (23)

is simpliﬁed into the following problem.

K0

N

K1

N

K0

V0Pi,n +

V1Pj,n −

QiRi

j=1
X

n=1
X

i=1
X

(27)

min
{Pk,n}

i=1
X
s.t. C1 ∼ C4.

n=1
X

Since subchannel n is allocated to at most one UE in the
orthogonal subchannel allocation strategy, the interference part
Intk,m,n in (1) equals to 0 and the rate Rk in (27) is convex
and monotonically increases with the power Pk,n. Suppose
{P ∗
k,n} is the extreme point of the targeted convex function.
When {P ∗
k,n} is in the feasible region deﬁned by C1 ∼ C4,

8

k,n} is the optimal solution of problem (27). When {P ∗
{P ∗
k,n}
is not in the feasible region, we can ﬁnd the optimal solution
by the following iterative methods:

Algorithm 1 An iterative method to ﬁnd the optimal solution
of problem (27).

1: Derive the partial derivative of the targeted optimization

function in (27);

2: Find the extreme point {P ∗

k,n} of the targeted convex

function.

3: Initialize {Pk,n} = {P ∗
4: repeat
5: With Pk,n ﬁxed, calculate the partial derivative

k,n} and deﬁne a ﬁxed step △P ;

6:

f ′(Pk,n);
Find the minimal one k∗ = arg mink f ′(Pk,n);
Update Pk∗,n = Pk∗,n − △P ;
7:
8: until {Pk,n} is in the feasible region.

B. Distributed RL-based solution for multiplexed subchannel
allocation strategy

In the multiplexed subchannel allocation strategy, a dis-
tributed RL-based approach is proposed, in which UEs au-
tonomously select
their communication modes. The main
advantage of using distributed approaches is that they allow
for a reduction in complexity since each UE needs to consider
only its own selection possibilities. Note that the size of Q-
table can be decreased by only considering the neighbor nodes
of UE k, which makes the storage of Q-table affordable for
each UE.

Whenever RRHs(m = 0), an F-AP(m = {1, 2, ..., M0})
or an F-UE(m = {M0 + 1, M0 + 2, ..., M0 + K1}) and
subchannel n has been selected by UE k, the value of Qk,m,n
is updated as (24). Unlike the special case Wk,m,n = 0 in the
orthogonal subchannel allocation strategy, a subchannel can
be shared among multiple UEs in the multiplexed subchannel
allocation strategy. We have to consider the following cases
in which Wk,m,n are supposed to be 0: 1) An excessive
load occurs in F-AP m and there is no enough computing
resource for the connected UEs, meaning that constraint C1 is
not fulﬁlled; 2) The propagation conditions in the selected
mode do not allow guaranteeing the traditional UE’s rate
requirement, meaning that constraint C2 is not satisﬁed; 3)
The propagation conditions in the selected mode do not allow
achieving the desired rate of F-UE, meaning that constraints
C3 is not satisﬁed. If constraints C1, C2 and C3 are satisﬁed,
we have the same deﬁnition on the reward Wk,m,n as in (25).
By deﬁning a reward with C1 ∼ C3 and the power-minus-rate
function considered, the reward Wk,m,n reﬂects the degree of
fulﬁllment of the optimization target and the constraints.

Based on communication modes {sT X

k,m,n} output by dis-
there is a ﬁxed one-to-one mapping
tributed Q-learning,
between k and {m, n} due to constraints C5∼C7. Deﬁne
the corresponding mode selection and subchannel allocation
for UE k as m(k) and n(k), respectively. Note that when
subchannel n(k) is used by a single UE, the interference
is omitted, which makes the problem convex. When
part

subchannel n(k) is reused, for example by UE k′ and k, we
have n(k) = n(k′). Problem (23) can now be simpliﬁed into
the following problem at subchannel n(k). where γQoS
is the
SINR corresponding to the desired rate Rmin
in C2 and sum
rate threshold in the right side of C3. The second order cone
constraint D2 is transformed from C2 and C3 equivalently.

k

i

The target function in (28) is non-convex when subchannel
n(k) is reused. Hence, a C-additive approximation of the drift-
plus-penalty algorithm is presented, the performance of which
is within an additive constant of the inﬁmum. The deﬁnition
of C-additive approximation [26] is deﬁned as follows.

Deﬁnition 2: (C-additive approximation). For a given con-
stant C ≥ 0, a C-additive approximation of the drift-plus-
penalty algorithm is to choose an action that yields a condi-
tional expected value on the right-hand-side of the drift-plus-
penalty under given Q(t) at time slot t, which is within a
constant C from the inﬁmum over all possible control actions.
The C-additive approximation of the drift-plus-penalty al-
gorithm is inspired by the equivalence between the weighted
sum rate maximization and WMMSE [29] for the MIMO
channel, which is extended to solve problem (28). We state
this equivalence as follows.

Proposition 3: (Equivalent WMMSE problem). Problem (28)
has the same optimal solution as the following WMMSE
problem:

min
1
2
{wk,uk,P
k,n(k)}

K0

Qi {wiei − log wi}

i=1
X

K0

K1

(29)

+

V0Pi,n(i) +

V1Pj,n(j),

i=1
X

s.t. C1, C4, D2,

j=1
X

where wk denotes the mean-square error (MSE) weight for UE
k, uk ∈ C is a receiver variable, and ek is the corresponding
MSE deﬁned as

ek

∆=kuk

vH
k,m(k),n(k)hk′,m(k),n(k)P

k′,n(k′)k2

1
2

k′
X
− 2Re{ukvH
+ σ2kukvk,m(k),n(k)k2 + 1.

k,m(k),n(k)hk,m(k),n(k)}P

1
2
k,n(k)

(30)

Note that WMMSE problem (29) is not jointly convex in
wk, uk, and P
k,n(k) but convex with respect to each of the
individual optimization variables when other individuals are

1
2

9

ﬁxed. Hence, the block coordinate descent (BCD) method is
utilized to obtain a stationary point of problem (29). The BCD
method is summarized as follows and described in Algorithm
2.

• The optimal receiver uk under the ﬁxed P

1
2

k,n(k) and wk

is given by

uopt
k =vH

k,m(k),n(k)hk,m(k),n(k)P

1
2
k,n(k)

kvH

k,m(k),n(k)hk′,m(k),n(k)k2Pk′,n(k′)

(31)

k′
n X
+ σ2kvk,m(k),n(k)k2

−1

.

o

• The optimal MSE weight wk under the ﬁxed P

1
2

k,n(k) and

uk is given by

wopt

k = e−1
k .

(32)

• Note that the optimization problem for ﬁnding the optimal
transmit power Pk,n(k) under the ﬁxed uk and wk is

K0

K0

K1

Qiwiei +

V0Pi,n(i) +

V1Pj,n(j),

i=1
X

j=1
X

min
1
2
k,n(k)}

{P

i=1
X
s.t. C4, D2,

D3 : sCP U

m D ≥

1{

k,m,n ≥ 1} ˜Ck,
sT X

K0+K1

N

k=1
X

n=1
X

(33)

which is a second order cone problem and can be solved
efﬁciently when there is convex region. Note that the
convex region is deﬁned by the constraint C4, D2 and
D3 jointly. In particular, the new constraint D3 is de-
rived from C1. In constraint C1, the computing resource
consumption Ck(t) of UE k is calculated according to
the resource allocation under determined mode selection.
While in the presented BCD method, the resource alloca-
tion is determined in an iterative way. Hence ˜Ck in D3 is
calculated based on the power output by the last iteration.
As proven in [29], a ﬁxed point of problem (29) will be
reached when Algorithm 2 converges, which might not be
globally optimal for problem (28) or (29). To enable a quick
convergence, it is critical to choose proper initialization points
with reasonable approaches like the interference alignment
initialization.

min
{Pk,n(k)}

i=1
X

s.t. C1, C4

K0

K1

K0

V0Pi,n(i) +

V1Pj,n(i) −

QiRi

j=1
X

i=1
X

K0+K1

D2 :

v
u
u
t

Pk′,n(k′)kvH

k,m(k),n(k)hk′,m(k),n(k)k2 + σ2kvk,m(k),n(k)k2

k′=1
X

≤

1 +

s

1
γQoS
k

Re{vH

k,m(k),n(k)hk,m(k),n(k)}P

k,n(k), k ∈ K0 ∪ K1,

1
2

(28)

Algorithm 2 WMMSE algorithm for solving (29).

1: For each slot t, observe the current Q(t) and hk,m(k),n(k),
and then make the queue-aware power allocation accord-
ing to the following steps:

2: Initialize the precision κ, power Pk,n(k) and corresponding

power-minus-rate function P M R;

Update Pk = Pk,n(k) and P M R∗ = P M R;

3: repeat
4:
5: With Pk ﬁxed, compute uk according to (31);
6:

Compute the corresponding MSE ek according to (30)
and set wk = e−1
k ;
Find the optimal value of power Pk,n(k) by solving
problem (33);
Calculate the corresponding power-minus-rate function
P M R in (28);

7:

8:

10

i

e
t
a
r
−
s
u
n
m
−
r
e
w
o
P

14

13

12

11

10

9

8

7

6

(cid:306) = 0.5

(cid:306) = 0.1

Logarithmic cooling

9: until Constraint D3 is not satisﬁed or |P M R−P M R∗| ≤

κ|P M R∗|;
10: Update Q(t).

Fig. 2. The impacts of the temperature parameter τ in the orthogonal
subchannel strategy.

Algorithm 2 is based on the BCD method. In this case, the
computational complexity of Step 4 is O(K0 + K1). For Step
5 and 6, the computational complexity is O(K0L0(K0 +K1)).
In Step 6, the additional computational complexity to update
all MSE weights wk is only O(K0) Step 7 is the largest part
of the computational complexity in Algorithm 2. The total
number of variables in the problem is (K0 + K1)L0 and the
computation complexity of using the CVX method to solve
such an problem is approximately O(((K0 + K1)L0)3.5).

V. SIMULATION RESULTS

To demonstrate the performance of the proposed RL-based
solutions, extensive simulation has been conducted. Assume
L1 = 10 RRHs and M0 = 3 F-APs that are deployed in a
square region 1000m × 1000m. Each F-AP is equipped with
L0 = 6 antennas. We also assume that the mean arrival rate
λi of each traditional UE is the same. For each F-UE, the bit
rate requirement is Rth = 0.6 Mbits/slot, and the bit rate
requirement of the traditional UE is set to Rmin
= 0.06
Mbits/slot. The pathloss is modeled as 127 + 25 log10(d)
with d (km) being the propagation distance. The subchannel
bandwidth is 180 kHz and the noise power spectral density
is −164 dBm/Hz. Each simulation experiment
is run for
10000 time slots. A summarization on the parameters in the
simulation are shown in Table I.

i

TABLE I
SIMULATION PARAMETERS

i

Fronthaul power P f ronthaul
Rate threshold Rth, Rmin
Noise power spectral density
Subchannel bandwidth W0
Power ampliﬁer efﬁciencies
η0, η1
Pathloss model

0.35 W
0.6, 0.06 Mbits/slot
−164 dBm/Hz
180 kHz

0.05, 0.05

127 + 25 log10(d)(km)

A. The impacts of different parameters

The impact of temperature parameter τ on system perfor-
mance is illustrated in Fig. 2. It can be observed that a smaller
value of τ achieves a better performance. This is because
a bigger τ will lead to a near equal selection probabilities
for different actions, even if the gap between their Q values
becomes large after a period of learning. It is also shown that
the performance is beneﬁted from a logarithmic decreasing
τ = τ0/ log(1 + tepi), compared with τ = 0.1 and τ = 0.5.
This is because logarithmic decreasing τ tends to reduce its
value as the episode tepi increases, and therefore, the best
solutions are progressively selected with higher probability.

250

200

150

100

50

i

e
t
a
r
−
s
u
n
m
−
r
e
w
o
P

0
500

1000

 = 6 )
 = 4, K
(K
1
0
 = 2 )
 = 2, K
(K
1
0

1500
3500
2500
Total computing resource (MOPTS)

2000

3000

4000

4500

Fig. 3. Power-minus-rate v.s. total available computing resource Pm DCP U
at slot t.

m

Fig. 3 shows the relationship between the total available
computing resource and the power-minus-rate. The total com-
puting resource is determined by the number of active proces-
sors and computing capability of each processor, the unit of
which is million operations per time slot (MOPTS). From Fig.
3, it can be seen that when total available computing resource
is scarce, the value of target power-minus-rate function will be
signiﬁcantly limited. With the computing resource increasing,

the power-minus-rate decreases signiﬁcantly, which may be
because of the following reasons. First, as the computing re-
source available increases, more traditional UEs/F-UEs can be
served locally. With more ﬂexible mode selection, the power-
minus-rate can be decreased; Second, with more computing
resource, UEs/F-UEs used to select D2D mode may choose F-
AP mode. Since the F-UE is free from relaying data, the power
consumption of the F-UE decreased, which further decreases
the power-minus-rate.

4

3.5

3

2.5

2

1.5

1

)

W

(

|

P

r
e
w
o
p
m
e
t
s
y
s

e
g
a
r
e
v
A

λ = 0.10 Mbits/slot
λ = 0.07 Mbits/slot

0.5

25

50

75

100
Parameter V

125

150

(a) Average system power P v.s. parameter V

|

)
s
t
i

b
M

(

Q
y
a
e
d

l

e
u
e
u
q

e
g
a
r
e
v
A

14

12

10

8

6

4

2

0

λ = 0.10 Mbits/slot
λ = 0.07 Mbits/slot

25

50

75

100
Parameter V

125

150

(b) Average queue delay Q v.s. parameter V

Fig. 4. A tradeoff between the average system power P and average queue
delay Q, which can be controlled via the parameter V .

Despite the performance at deterministic slot, we also eval-
uate the average queue delay and the average system power.
It is observed in Fig. 4 that when the mean arrival rate λ
is larger, longer average delay and higher system power will
occur. This can be explained by the fact that more power is
needed to timely transmit larger amount of trafﬁc arrivals.
Under a given mean arrival rate, the average system power is
a monotonically decreasing function on parameter V , which
is consistent with Theorem 1. As illustrated in Fig. 4(a), the
decreasing rate of average system power starts to diminish
with excessive increase of V . On the other hand, a larger V
can adversely affect the delay performance, which leads to

11

higher average queue delay shown in Fig. 4(b). This is because
that the algorithm with a larger V will emphasize less on
delay performance but more on the system power performance.
Therefore the parameter V features the tradeoff between power
consumption and delay performance.

B. Performance comparison with benchmarks

)

%
(
e
s
a
e
r
c
e
d

d
r
a
w
e
r

l

a
t

o
T

60

50

40

30

20

10

0

All to RRHs

PL First

Orthogonal

Multiplexed

Performance evaluation with respect

Fig. 5.
to the optimum solution,
including the All to RRHs, the PLFirst, and the proposed algorithm under
orthogonal and multiplexed subchannel strategy.

Fig. 5 presents an evaluation of the proposed RL-based
algorithms. Two mode selection approaches are included for
comparison: The ﬁrst one is the approach that all traditional
UEs and F-UEs are connected to the RRHs (denoted as “All to
RRHs”), where F-AP mode and D2D mode are not provided
and the subchannel is selected randomly; The second one is
the “PL First”approach in which the traditional UE and F-
UE selects an F-AP/RRHs with the lowest propagation loss.
The performance are compared with respect to the optimum
solution. To behave an exhaustive search to obtain the optimal
mode selection, we consider only K0 = 2 traditional UEs
and K1 = 2 F-UEs to be served with a total of N = 4
subchannels in this simulation. It
is demonstrated in Fig.
5 that compared with the All to RRHs approach, the total
reward of the proposed RL-based algorithms can be decreased
signiﬁcantly. This is because that the proposed algorithms take
advantages of computing resources at F-APs, which leads a
save on the fronthaul power consumption. It is also shown
that the proposed algorithms outperform than the PL First
approach. Since data relay of F-UEs enables more UEs and
F-UEs served locally and a more efﬁcient mode selection is
achieved via RL. Note that there are less constraints on the
subchannel selections in the multiplexed subchannel allocation
strategy, the performance of the proposed algorithm under
multiplexed subchannel allocation strategy is better than the
orthogonal strategy.

When the number of
traditional UEs, F-UEs, F-APs
and subchannels increases,
the number of combinations
{sT X
k,m,n(t)} becomes large dramatically, which makes it un-
feasible to obtain the optimum solution via exhaustive search.

 
 
 
 
 
 
 
 
 
 
Hence we apply the particle swarm optimization (PSO) ap-
proach as a benchmark. Specially, E particles are deﬁned, each
of which is with a corresponding position xe,0 and velocity
ve,0. The position xe,0 of particle e is used to generate a mode
selection, while the velocity ve,0 is used to update the position.
The operation of the PSO approach at slot t is summarized as
follows.

1) At initialization, a position set {xe,0} and corresponding
velocity set {ve,0} of E particles are randomly generated;
2) At each iteration u, the following operators are applied
to the particle position updates to obtain the new position
set of particles:
a) For each particle e, there is a mapping from xe,u =

{xe,u

k |k = 1, 2, ..., K0 + K1} to {sT X

k,m,n(t)},

i

e
t
a
r
−
s
u
n
m
−
r
e
w
o
P

70

60

50

40

30

20

10

0

2

12

All to RRHs
PL First
Q learning approach
PSO approach

4

6

8

F−UEs K
1

sT X
k,m,n(t) =

1
0

(

if n + mN = ⌊xe,u
others,

k ⌋,

(34)

Fig. 6. The performance of proposed approach at slot t when increasing the
number of F-UEs with multiplexed subchannel allocation strategy.

where ⌊xe,u
greatest integer less than or equal to xe,u
k .

k ⌋ is a ﬂoor function that outputs the

b) Given {sT X

k,m,n(t)}, evaluate the ﬁtness value which is

deﬁned as follows;

K0

V P −

QiRi

min
{Pk,n}

i=1
X
s.t. C1 ∼ C4

(35)

c) According to the ﬁtness value, update the personal
best position of each particle pe,u and the global best
position gu during past u iterations;

d) Update the velocity ve,u+1 and position xe,u+1 of

each particle

ve,u+1 = wve,u +r1c1(pe,u −xe,u) +r2c2(gu −xe,u),
xe,u+1 = ve,u+1 + xe,u,

(36)

where w is a weight factor, r1, r2 are random constants
to increase search randomness, and c1, c2 are used to
adjust learning maximum step size.

3) Until U iterations, the global best position gU−1 corre-

sponds to the ﬁnal selection result.

The corresponding evaluation is performed in the scenario
with M0 = 6 F-APs and N = 6 subchannels. There are
K0 = 6 traditional UEs to be served and the multiplexed
subchannel strategy is considered. Fig. 6 shows a comparison
between the proposed Q-learning approach and the PSO
approach. It is shown that the proposed Q-learning approach
always outperforms the All to RRHs approach and PL First
approach under different number of F-UEs K1. Moreover, the
proposed Q-learning approach achieves similar performance to
the PSO approach. Despite close performance, the Q-learning
approach performs much better than the PSO approach in
terms of computational complexity. Specially, to obtain the
presented performance result in Fig. 6, the execution of the
PSO approach costs approximately 35 minutes, while the Q-
learning approach costs only 2 minutes.

VI. CONCLUSION AND FUTURE WORK

In this paper, we have investigated the mode selection and
resource allocation problem in a sliced F-RAN. In particular,
network slice instances are constructed to satisfy speciﬁc
performance requirements of traditional UEs and F-UEs. To
guarantee the slice isolation, both orthogonal and multiplexed
subchannel allocation strategies are presented. With perfor-
mance requirements and limited resources considered, a sys-
tem power minimization problem is formulated and two RL-
based approaches are developed. In the RL-based approaches,
an opportunistic mode selection is performed based on the
learned policy, with transmission power of traditional UEs and
F-UEs optimized subsequently. By simulation, beneﬁts of the
proposed approaches are validated and a delay-power tradeoff
has been achieved.

There are still some other topics to be researched in
the future work. For example, the extend of our work to
other network slicing scenarios like Internet of vehicles. Key
challenges for machine learning and artiﬁcial
intelligence
techniques are also interesting to be investigated, such as the
robustness improvement to model drift and generalization of
algorithms. Besides, consider the emerging applications and
uses cases, network slicing method in F-RANs should be fur-
thermore explored. The novel approaches may have to consider
signaling overhead, joint allocation of computing, caching
and radio resource. To guarantee differentiated demands, the
system design should address issues like the quality of service,
scalability.

REFERENCES

[1] R. Hattachi and J. Erfanian, “Next generation mobile networks (NGMN)
Alliance: 5G White Paper,” NGMN Alliance Ltd., Frankfurt am Main,
Germany, NGMN 5G White Paper V1.0, 2015. [Online]. Available:
https://www.ngmn.org/uploads/media/NGMN 5G White Paper V1 0. pdf.
[2] X. Chen, H. Zhang, C. Wu, S. Mao, Y. Ji, and M. Bennis, “Optimized
computation ofﬂoading performance in virtual edge computing systems
via deep reinforcement learning,” IEEE Internet Things J., vol. 6, no. 3,
pp. 4005-4018, Jun. 2019.

[3] Q. Ye, W. Zhuang, S. Zhang, A. Jin, X. Shen, and X. Li, “Dynamic radio
resource slicing for a two-tier heterogeneous wireless network,” IEEE
Trans. Veh. Tech., vol. 67, no. 10, pp. 9896-9910, Jul. 2018.

[4] J. Tang, B. Shim, and T. Q. S. Quek, “Service multiplexing and revenue
maximization in sliced C-RAN incorporated with URLLC and multicast
eMBB,” IEEE J. Select. Areas Commun., vol. 37, no. 4, pp. 881-895,
Apr. 2019.

[5] 3GPP, TS 38.300, “NR and NG-RAN Overall Description,” Release-15,

v. 15.6.0, Jun. 2019.

[6] M. Peng, S. Yan, K. Zhang, and C. Wang, “Fog computing based radio
access networks: Issues and challenges,” IEEE Netw., vol. 30, no. 4, pp.
46-53, Jul. 2016.

[7] L. Liu, Z. Chang, X. Guo, S. Mao, and T. Ristaniemi, “Multi-objective
optimization for computation ofﬂoading in fog computing,” IEEE Inter-
net Things J., vol. 5, no. 1, pp. 283-294, Feb. 2018.

[8] Y. Wang, X. Tao, X. Zhang, and G. Mao, “Joint caching placement and
user association for minimizing user download delay,” IEEE Access, vol.
4, pp. 8625-8633, Dec. 2016.

[9] Z. Yan, M. Peng, and M. Daneshmand, “Cost-aware resource allocation
for optimization of energy efﬁciency in fog radio access networks,” IEEE
J. Sel. Areas Commun., vol. 36, no. 11, pp. 2581-2590, Nov. 2018.
[10] I. Afolabi, T. Taleb, K. Samdanis, A. Ksentini, and H. Flincket,
“Network slicing and softwarization: A survey on principles, enabling
technologies, and solutions, ” IEEEE Commun. Surveys & Tuts., vol. 20,
no. 3, pp. 2429-2453, 3rd Quart., 2018.

[11] Y. Sun, M. Peng, S. Mao, and S. Yan, “Hierarchical radio resource
allocation for network slicing in fog radio access networks,” IEEE Trans.
Veh. Tech., vol. 68, no. 4, pp. 3866-3881, Jan. 2019.

[12] S. Parsaeefard, R. Dawadi, M. Derakhshani, and T. Le-Ngoc, “Joint
user-association and resource-allocation in virtualized wireless net-
works,” IEEE Access, vol. 4, pp. 2738-2750, 2016.

[13] N. V. Huynh, D. T. Hoang, D. N. Nguyen, and E. Dutkiewicz,
“Optimal and fast real-time resource slicing with deep dueling neural
networks,” IEEE J. Sel. Areas Commun., vol. 37, no. 6, pp. 1455-1470,
Jun. 2019

[14] J. J. Escudero-Garzas, C. Bousono-Calzon, and A. Garcia, “On the
feasibility of 5G slice resource allocation with spectral efﬁciency: A
probabilistic characterization,” IEEE Access, vol. 7, pp. 151948-151961,
2019.

[15] R. Li, Z. Zhao, X. Zhou, and et. al., “Intelligent 5G: When cellular
networks meet artiﬁcial intelligence,” IEEE Wireless Commun., vol. 24,
no. 5, pp. 175-183, Oct. 2017.

[16] B. Mao, Z. Fadlullah, F. Tang, and et. al., “Routing or computing? The
paradigm shift towards intelligent computer network packet transmission
based on deep learning,” IEEE Trans. on Computers, vol. 66, no. 11, pp.
1946-1960, Nov. 2017.

[17] Z. Fadlullah, F. Tang, B. Mao, and et. al., “State-of-the-art deep learning:
Evolving machine intelligence toward tomorrow’s intelligent network
trafﬁc control systems,” IEEE Commun. Surveys & Tuts., vol. 19, no. 4,
pp. 2432-2455, May 2017.

[18] H. Ye, G. Y. Li, and B. Juang, “Deep reinforcement learning based
resource allocation for V2V communications,” IEEE Trans. Veh. Tech.,
vol. 68, no. 4, pp. 3163-3173, April 2019.

[19] N. Kato, Z. Fadlullah, B. Mao, and et. al., “The deep learning vision for
heterogeneous network trafﬁc control - Pproposal, challenges, and future
perspective,” IEEE Wireless Commun., vol. 24, no. 3, pp. 146-153, Dec.
2016.

[20] X. Liao, J. Shi, Z. Li, and et. al., “A model-driven deep reinforcement
learning heuristic algorithm for resource allocation in ultra-dense cellular
IEEE Trans. Veh. Tech., vol. 69, no. 1, pp. 983-997, Jan.
networks,”
2020.

[21] M. Liu, T. Song, J. Hu, and et. al., “Deep learning-inspired message
passing algorithm for efﬁcient resource allocation in cognitive radio
IEEE Trans. Veh. Tech., vol. 68, no. 1, pp. 641-653, Jan.
networks,”
2019.

[22] Y. Sun, M. Peng, Y. Zhou, Y. Huang and S. Mao, “Application
of machine learning in wireless networks: Key techniques and open
issues,” IEEE Commun. Surveys & Tuts., vol. 21, no. 4, pp. 3072-3108,
4th Quart., 2019.

[23] Y. Sun, M. Peng, and H. V. Poor, “A distributed approach to improving
spectral efﬁciency in uplink device-to-device-enabled cloud radio access
networks,” IEEE Trans. Commun., vol. 66, no. 12, pp. 6511-6526, Dec.
2018.

[24] M. Bennis, S. M. Perlaza, P. Blasco, Z. Han, and H. V. Poor,
learning
IEEE Trans. Wireless Commun., vol. 12, no. 7, pp. 3202-

“Self-organization in small cell networks: A reinforcement
approach,”
3212, Jun. 2013.

[25] X. Chen, J. Wu, Y. Cai, H. Zhang, and T. Chen, “Energy-efﬁciency
oriented trafﬁc ofﬂoading in wireless networks: A brief survey and a

13

learning approach for heterogeneous cellular networks,”
Areas Commun., vol. 33, no. 4, pp. 627-640, Apr. 2015.

IEEE J. Sel.

[26] M. Neely, Stochastic network optimization with application to commu-

nication and queuing systems. Morgan & Claypool, 2010.

[27] Y. Liao, L. Song, Y. Li, and Y. Zhang, “How much computing capability
is enough to run a cloud radio access network?” IEEE Commun. Lett.,
vol. 21, no. 1, pp. 104-107, Jan. 2017.

[28] R. S. Sutton and A. G. Barto, Reinforcement learning: An introduction.

Cambridge, MA, USA: MIT Press, 1998.

[29] S. Christensen, R. Agarwal, E. Carvalho, and J. M. Ciofﬁ, “Weighted
sum-rate maximization using weighted MMSE for MIMO-BC beamform-
ing design,” IEEE Trans. Wireless Commun., vol. 7, no. 12, pp. 4792-
4799, Dec. 2008.

Hongyu Xiang is currently pursuing the Ph.D.
degree at the Beijing University of Posts & Telecom-
munications (BUPT). He received the B.S. degree
in communication engineering from the Fudan Uni-
versity, China, in 2013. His research interests are
network slicing, cooperative radio resource man-
agement and collaboration radio signal processing
in large-scale networks like the fog radio access
networks (F-RANs).

Mugen Peng (M’05-SM’11-F’20)
received the
Ph.D. degree in communication and information
systems from the Beijing University of Posts and
in
Telecommunications (BUPT), Beijing, China,
2005. Afterward, he joined BUPT, where he has
been a Full Professor with the School of Informa-
tion and Communication Engineering since 2012.
In 2014, he was an Academic Visiting Fellow with
Princeton University, Princeton, NJ, USA. He leads
a Research Group focusing on wireless transmis-
sion and networking technologies with the State
Key Laboratory of Networking and Switching Technology, BUPT. He has
authored/coauthored over 90 refereed IEEE journal papers and over 300
conference proceeding papers. Dr. Peng was a recipient of the 2018 Heinrich
Hertz Prize Paper Award, the 2014 IEEE ComSoc AP Outstanding Young
Researcher Award, and the Best Paper Award in the JCN 2016, IEEE WCNC
2015, IEEE GameNets 2014, IEEE CIT 2014, ICCTA 2011, IC-BNMT 2010,
and IET CCWMC 2009. He is on the Editorial/Associate Editorial Board of
the IEEE Communications Magazine, IEEE Access, IET Communications,
IEEE Internet of Things Journal, and China Communications.

Yaohua Sun received the bachelor’s degree (with
ﬁrst class Hons.) in telecommunications engineering
(with management) and Phd degree in communi-
cation engineering both from Beijing University
of Posts and Telecommunications (BUPT), Beijing,
China, in 2014 and 2019, respectively. He is cur-
rently an assistant professor at the State Key Lab-
oratory of Networking and Switching Technology
(SKL-NST), BUPT. His research interests include
IoT, edge computing, resource management, (deep)
learning, network slicing, and fog
reinforcement
radio access networks. He was the recipient of the National Scholarship
in 2011 and 2017, and he has been reviewers for IEEE Transactions on
Communications, IEEE Transactions on Mobile Computing, IEEE Systems
Journal, Journal on Selected Areas in Communications, IEEE Communica-
tions Magazine, IEEE Wireless Communications Magazine, IEEE Wireless
Communications Letters, IEEE Communications Letters, and IEEE Internet
of Things Journal.

14

Shi Yan (M’19) received the Ph.D. degree in com-
munication and information engineering from Bei-
jing University of Posts and Telecommunications
(BUPT), China, in 2017. He is currently an assis-
tant professor in the key laboratory of universal
wireless communications (Ministry of Education)
at BUPT. In 2015, he was an Academic Visiting
Scholar with Arizona State University, Tempe, AZ,
USA. His research interests include game theory,
resource management, deep reinforcement learning,
stochastic geometry and fog radio access networks.

(cid:3)

