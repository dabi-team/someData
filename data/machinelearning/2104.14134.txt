1
2
0
2

r
p
A
0
3

]

C
O
.
h
t
a
m

[

2
v
4
3
1
4
1
.
4
0
1
2
:
v
i
X
r
a

Proceedings of Machine Learning Research vol 144:1–21, 2021

3rd Annual Conference on Learning for Dynamics and Control

Stable Online Control of Linear Time-Varying Systems

Guannan Qu∗
Yuanyuan Shi∗
Sahin Lale∗
Anima Anandkumar
Adam Wierman
California Institute of Technology, Pasadena, CA
∗Equal contribution

GQU@CALTECH.EDU
YSHI7@CALTECH.EDU
ALALE@CALTECH.EDU
ANIMA@CALTECH.EDU
ADAMW@CALTECH.EDU

Editors: A. Jadbabaie, J. Lygeros, G. J. Pappas, P. A. Parrilo, B. Recht, C. J. Tomlin, M. N. Zeilinger

Abstract
Linear time-varying (LTV) systems are widely used for modeling real-world dynamical systems
due to their generality and simplicity. Providing stability guarantees for LTV systems is one of the
central problems in control theory. However, existing approaches that guarantee stability typically
lead to signiﬁcantly sub-optimal cumulative control cost in online settings where only current or
short-term system information is available. In this work, we propose an efﬁcient online control
algorithm, COvariance Constrained Online Linear Quadratic (COCO-LQ) control, that guarantees
input-to-state stability for a large class of LTV systems while also minimizing the control cost. The
proposed method incorporates a state covariance constraint into the semi-deﬁnite programming
(SDP) formulation of the LQ optimal controller. We empirically demonstrate the performance of
COCO-LQ in both synthetic experiments and a power system frequency control example.
Keywords: Time-varying systems, online linear quadratic control, stability guarantee

1. Introduction

Time-invariant systems have traditionally been the main focus of the study for the linear dynamical
systems community. However, real-world systems are often time-varying. For example, consider a
power system that includes renewable generation (e.g. solar/wind). Due to the intermittency of re-
newable energy, the system dynamics for frequency regulation in the power system are time-varying.
Applying a time-invariant controller in this setting may lead to frequency instability and line fail-
ures (Ulbig et al., 2014). Time-varying systems are also crucial for many other applications, such as
autonomous vehicles and aircraft control (Falcone et al., 2008). While not all time-varying systems
have linear dynamics, many applications can be approximated by linear time-varying (LTV) systems
via a local linear approximation at each time step (Todorov and Li, 2005), e.g., the frequency control
example described above. As a result, LTV systems are widely-used and there is a large literature
focused on designing controllers for LTV systems (Amato et al., 2010; Ouyang et al., 2017).

Perhaps the most fundamental challenge in dynamical systems is stability. While the design
of stable linear time-invariant (LTI) systems is well understood, the same cannot be said for LTV
systems. To this point, several notions of stability have recieved attention, e.g., input-to-state stabil-
ity (ISS), mean-square stability and Lyapunov stability. ISS is the most widely adopted notion and
aims to guarantee the boundedness of the state given bounded initial conditions (Hong et al., 2010).

© 2021 G. Qu, Y. Shi, S. Lale, A. Anandkumar & A. Wierman.

 
 
 
 
 
 
STABLE ONLINE CONTROL OF LTV SYSTEMS

In most applications of LTV systems, it is crucial to guarantee ISS both in order to avoid saturation,
maintain the robustness and validity of linearization (Tarbouriech et al., 2006; Khalil, 2002).

While there is considerable prior work focused on stability in LTV systems, most prior work
studies stability in the ofﬂine setting where either the sequence of system parameters are known,
e.g., (Amato et al., 2010; Li et al., 2019a), or the system parameters have a particular variation
pattern, e.g., (Garcia et al., 2009). Maintaining ISS guarantees becomes signiﬁcantly harder in
the online setting where the system parameters are observed in real-time and may have arbitrary
variations. This online setting is the most relevant to many applications, e.g., frequency regulation.
Though stability is crucial, it is not enough for a controller to be stable. A controller must also
have low cost. For instance, in order to stabilize the dynamics, a controller may use arbitrarily big
control inputs, which may result in sub-optimal cost. In classical optimal control problems, e.g. the
time-varying linear quadratic (LQ) control setting, the goal is to design a stabilizing controller that
minimizes the cost for a particular ﬁnite horizon while assuming access to the whole trajectory for
that duration. It is possible to characterize the optimal policy in such settings (Bertsekas et al., 1995);
however, in the online setting when only current or short-termed system information is available,
these methods may not guarantee stability, e.g., see Section 3. There have been recent efforts to
provide sub-optimality guarantees on the acquired cost in the online LTV setting, e.g., (Gradu et al.,
2020), but it is unclear if the proposed controllers maintain stability for all time-steps since the main
focus is on minimizing the cumulative cost.

Thus, despite considerable recent work, much remains to be understood about the design of

online LTV controllers. In particular, this paper is motivated by the following question:

Is it possible for an online controller to guarantee stability and maintain low cost in LTV systems?

Contributions.
In this work, we answer question above afﬁrmatively. Speciﬁcally, we propose
Covariance Constrained Online Linear Quadratic (COCO-LQ) control, a novel online control al-
gorithm that aims to minimize the control cost while ensuring provable stability guarantees in LTV
systems without restricting how slow or fast the underlying system changes. Further, we demon-
strate the performance of the proposed method in various synthetic LTV systems and in the power
system frequency control example that motivated our study.

The main technical contribution of the paper is a stability guarantee for COCO-LQ in LTV sys-
tems. Speciﬁcally, we show that COCO-LQ guarantees ISS in online time-varying systems. The
key technique that underpins the proposed algorithm is the addition of a novel semi-deﬁniteness
constraint on the state covariance matrix into the standard online semi-deﬁnite programming (SDP)
formulation of linear quadratic optimal control. We show that this constraint promotes the sequen-
tial strong stability of the controllers (Cohen et al., 2018), which in turn guarantees ISS with a proper
choice of an algorithm hyperparameter. Adding this additional constraint is simple and does not re-
sult in a signiﬁcant increase of computational complexity compared to the standard LQ formulation.
Moreover, we prove that if the proposed SDP is not directly feasible, short-term predictions on the
future system parameters are necessary and can be used in COCO-LQ in order to ensure ISS.

Related work. The work in this paper builds on the design of linear time-invariant (LTI) con-
trollers to provide a new approach for the design of stable controllers for linear-time-varying (LTV)
systems. As such, we describe related work on both LTI and LTV systems below.

LTI Systems. In study of control of LTI systems, linear quadratic regulator (LQR) has been con-
sidered in detail. In the classical setting where the underlying system is known, the optimal control

2

STABLE ONLINE CONTROL OF LTV SYSTEMS

law is given by a linear feedback controller obtained by solving Riccati equations (Bertsekas et al.,
1995). Alternatively, the optimal control problem can also be posed via semi-deﬁnite programming
(SDP) (Vandenberghe and Boyd, 1996), which is the approach we build on in the current paper.

Recently, there has been growing interest in online control of these linear systems when the un-
derlying dynamics are unknown. Most of these works study the problem with a regret minimization
perspective, e.g., (Abbasi-Yadkori and Szepesv´ari, 2011; Dean et al., 2018; Lale et al., 2020a,b).
However, these methods have so far only been applied in LTI systems with time-varying costs and
disturbances. Extensions to LTV dynamics, which are the focus of this paper, are not known.

LTV Systems. As in the case of LTI systems, optimal control of LTV systems where the se-
quence of system parameters can be obtained by solving backwards Riccati equations (Bertsekas
et al., 1995). However, in the online case when the sequence of systems is unknown, the design of
controllers is challenging. There are several lines of work in adaptive control and model-predictive
control (MPC) that have been studied to this point. In adaptive control of LTV systems, the un-
derlying systems are unknown and the results generally assume slow and bounded or ﬁxed system-
atic variation of dynamics with bounded disturbances (Middleton and Goodwin, 1988; Marino and
Tomei, 2000; Ouyang et al., 2017). In MPC of LTV systems, a ﬁnite horizon of sequence of systems
(predictions) is known and the system is again assumed to be slowly varying or open-loop stable,
e.g., (Zheng and Morari, 1994; Falcone et al., 2007). Different from prior works, in the current work
we consider the online problem and make no assumptions about how the system varies over time.

As in the LTI setting, the study of regret minimization in LTV systems has recently received
attention. Goel and Hassibi (2020); Gradu et al. (2020) are most related to the current paper. Goel
and Hassibi (2020) considers the setting where the sequence of systems is known and provides
regret-optimal controller framework. Gradu et al. (2020) studies the adaptive regret of online control
in LTV systems with bounded cost. Note that when the cost is bounded, a ﬁnite regret need not
guarantee stability. In contrast, we use a quadratic (unbounded) cost and we can guarantee stability.

Notation. We denote the Euclidean norm of a vector x as (cid:107)x(cid:107). For a matrix A, (cid:107)A(cid:107) is its spectral
norm, A(cid:62) is its transpose, and Tr(A) is its trace. N (µ, Σ) denotes normal distribution with mean
µ and covariance Σ. A (cid:31) B and A (cid:23) B denote that A − B is positive deﬁnite and positive semi-
deﬁnite respectively. A • B denotes the element-wise inner product of A and B, i.e., Tr(A(cid:62)B).

2. Model & Background

We consider the following linear time-varying (LTV) system,

xt+1 = Atxt + Btut + wt,

(1)

where xt ∈ Rd is the system state, ut ∈ Rp is the control input and wt ∈ Rd is the disturbance at
time t. The system is stochastic, i.e., wt ∼ N (0, W ) for W (cid:31) 0. The cost at each time-step is a
t Qxt + u(cid:62)
quadratic function of the state and control, x(cid:62)
The decision maker operates in an online setting. That is, at each time-step t, the learner
observes the state xt and system matrix (At, Bt) before choosing action ut and suffering cost
x(cid:62)
t Qxt + u(cid:62)
t Rut. We assume that the cost matrices (Q, R) are time-invariant and known to the
learner. However, future system matrices (At+1, ..., AT ) and (Bt+1, ..., BT ) are unknown to the
learner and are chosen by the environment, potentially stochastically or adversarially.

t Rut, where Q, R (cid:31) 0.

3

STABLE ONLINE CONTROL OF LTV SYSTEMS

Stability. One of the most central goals for controller design is to ensure stability. In this work,
we focus on the notion of input to state stability (ISS) and strive to design controllers that provide
ISS. ISS has been the main notion of stability considered in designing stabilizing controllers both
in linear and nonlinear systems (Hong et al., 2010; Sontag, 2008; Jiang and Wang, 2001). To
formally deﬁne ISS, let K∞ be the set of functions from nonnegative reals to nonnegative reals that
are continuous, strictly increasing, bijective. Then, ISS is deﬁned as follows.

Deﬁnition 1 (ISS) A LTV system with deterministic policy A is said to be input to state stable if
there exists functions β1 : [0, ∞) × N → [0, ∞) and β2 ∈ K∞ that satisfy β1(·, t) ∈ K∞ for any t ∈
N, limt→∞ β1(a, t) = 0 for any a ≥ 0 such that, for any disturbance sequence {wt}∞
t=0, any initial
time t0, any initial state xt0, and any t ≥ t0, we have (cid:107)xt(cid:107) ≤ β1((cid:107)xt0(cid:107), t − t0) + β2(supt(cid:48)∈N (cid:107)wt(cid:48)(cid:107)).

Cost.
In addition to stability, another important objective for controller design is maintaining a
small, near-optimal control cost. Here we adopt the standard linear quadratic (LQ) cost model, i.e.,
(cid:20)(cid:88)T

(cid:21)

JT (A) = lim
T →∞

E

1
T

t Qxt + u(cid:62)
x(cid:62)

t Rut

,

t=1

(2)

where u1, . . . , ut are chosen according to policy A, and the expectation is taken with respect to
randomness of noise sequence wt.

In this work, our goal is to ensure both stability and near-optimal cost. It should be noted that
there is a trade-off between these two goals. On the one hand, a stabilizing controller without cost-
awareness may produce arbitrarily large control inputs and induce high cost, which is impractical
to implement. On the other hand, a greedy approach that merely focuses on cost minimization may
lead to instability, as we highlight in the Section 3 below.

Though our focus is on LTV systems, our approach builds on the SDP formulation of the optimal

controller for LTI systems in (Vandenberghe and Boyd, 1996).

Proposition 2 (Vandenberghe and Boyd, 1996) When At = A, Bt = B and (A, B) is controllable,
the optimal K∗ = LQR(A, B, Q, R) where ut = K∗xt, can be obtained by the following SDP

(cid:21)

(cid:20)Q 0
0 R

min
Σ(cid:23)0

• Σ

s.t.

Σxx = (cid:2)At Bt

(cid:3) Σ (cid:2)At Bt

(cid:3)(cid:62) + W,

which has a unique symmetric solution Σ∗ that decomposes to the following blocks Σ∗ =

where Σ∗

xx∈ Rd×d, Σ∗

xu∈ Rd×p and Σ∗

uu∈ Rp×p. Then, the optimal controller is K∗ = Σ∗
xu

(cid:21)

,

(cid:20) Σ∗
xx Σ∗
xu
(cid:62) Σ∗
Σ∗
xu
uu
(cid:62)(Σ∗
xx)−1.

The optimal LQR controller described above both stabilizes the system and achieves the minimum
cost. The current paper makes a step toward understanding if it is possible to extend this formulation
to the case of LTV systems.

3. A Naive Approach

How to achieve stable, cost-optimal control of LTI systems is well-known; however this is not the
case in LTV systems. To illustrate the challenge of online control of LTV systems, we start by
studying the performance of a naive “plug in” approach where upon receiving (At, Bt) an optimal
controller for At, Bt is computed under the assumption that the system is time-invariant. Due to

4

STABLE ONLINE CONTROL OF LTV SYSTEMS

its simplicity, this approach has been employed in many contexts, e.g. Li et al. (2019b) for a MDP
setting. In this section we provide an example which shows that such a myopic approach based
on optimal LTI control described above fails to stabilize the system even in simple settings where
At can only switch between two possible choices and Bt is ﬁxed. This highlights that one cannot
naively apply LTI design approaches in LTV systems and expect to maintain stability.

(cid:21)

(cid:20) ρ 0
a ρ

, A(cid:48) =

(cid:20) ρ a
0 ρ

(cid:21)

,

Example 1 Consider a system with Q = (cid:15)I, R = I, wt = 0, and A =

√

where 0 < ρ < 1, and a >
optimal LTI controllers for A and A(cid:48) as K := LQR(A, B, Q, R) and K(cid:48) := LQR(A(cid:48), B, Q, R).

2. Suppose At alternates between A and A(cid:48) and Bt = B = I. Deﬁne the

To show that the optimal LTI controllers will not stabilize the system, we consider a case where
(cid:15) → 0. In this case, one can check that K, K(cid:48) → 0, and more precisely, K, K(cid:48) = O((cid:15)). Since At
alternates between A, A(cid:48), Kt also alternates between K and K(cid:48) under the myopic design we are
considering. Thus, the system state follows xt+2 = (A + K)(A(cid:48) + K(cid:48))xt. Notice that as (cid:15) → 0,
(A + K)(A(cid:48) + K(cid:48)) → AA(cid:48) =
. Here, AA(cid:48) is unstable since its largest eigenvalue

(cid:20) ρ2

aρ

(cid:21)

aρ a2 + ρ2
2 > 1. Thus, for small enough (cid:15), the naive strategy that uses the

2 Tr(AA(cid:48)) = ρ2 + a2
is greater than 1
LTI controller at each time-step leads to instability.

4. Main Result

The previous section highlights that a naive application of LTI control cannot guarantee stability for
LTV systems. We now propose a new approach, COvariance Constrained Online LQ (COCO-LQ)
control (Section 4.1). Our main technical result shows that COCO-LQ provably guarantees stability
in LTV systems (Section 4.2) when the SDP is feasible. In Section 4.3, we discuss how to handle
the situation when the SDP is infeasible and Section 4.4 discuss the effect of model estimation error.
Detailed proofs could be found in the Appendix.

4.1. COvariance Constrained Online LQ (COCO-LQ)

The naive approach discussed in Section 3 seeks to solve the LTI problem at every time step, which
is equivalent to solving the SDP in Proposition 2 for every (At, Bt). The reason this method fails
is that it only considers cost minimization without explicitly considering stability. The main idea of
COCO-LQ is to enforce stability via a state covariance constraint embedded into the SDP frame-
work. The proposed algorithm is stated formally in Algorithm 1. COCO-LQ solves an SDP (3) at
each time step that is similar to that in Proposition 2. The crucial difference is the new constraint
(3d), which involves parameter α. Plugging (3b) into constraint (3d) yields the following:

Σxx (cid:22)

1
1 − α

W.

This highlights that constraint (3d) can be interpreted as an upper bound on the state covariance
matrix Σxx. When α = 0, the controller essentially cancels out the dynamics, without taking into
account the cost of doing so. This ensures stability but can lead to large cost. At another extreme,
when α → 1, the SDP solved at each time step is the same as for the LTI setting, and so COCO-
LQ matches the naive approach in Section 3. Thus, α trades off between stability and cost. In the
following section, we show that this novel state covariance constraint promotes sequential strong
stability (Cohen et al., 2018), which in turn guarantees ISS with a proper choice of α.

5

STABLE ONLINE CONTROL OF LTV SYSTEMS

Algorithm 1: COCO-LQ: COvariance Constrained Online LQ

Parameters: α ∈ [0, 1)
Input: Q, R, W (cid:31) 0

1 for t = 1, 2, ... do
2

Receive state xt, and system parameter At, Bt
Compute policy: Let Σt ∈ Rn×n be an optimal solution to the SDP program:

3

4

5
6 end

minimize

(cid:21)

(cid:20)Q 0
0 R

• Σ

subject to Σxx = (cid:2)At Bt
Σ (cid:23) 0
(cid:2)At Bt

(cid:3) Σ (cid:2)At Bt

(cid:3)(cid:62)

+ W

(cid:3) Σ (cid:2)At Bt

(cid:3)(cid:62)

(cid:22) αΣxx

(3a)

(3b)

(3c)

(3d)

xuΣ−1
xx

and Kt = Σ(cid:62)
Play ut = Ktxt
Update xt+1 = Atxt + Btut + wt, wt ∼ N (0, W )

4.2. Stability

We now state our main technical result, which provides a formal stability guarantee for COCO-LQ.

Theorem 3 Let 0 ≤ α < 1/2, and suppose (3) is feasible for all t, then the resulting dynamical
system satisﬁes ISS in the sense that for any disturbance sequence {wt}∞

t=0 and for any t ≥ t0,

(cid:107)xt(cid:107) ≤ ρt−t0 (cid:107)xt0(cid:107) +

κρ
1 − ρ

sup
t0≤k<t

(cid:107)wk(cid:107)

for ρ =

(cid:113) α

1−α ∈ [0, 1) and κ = κW√

1−α

, where κW = (cid:107)W (cid:107)(cid:107)W −1(cid:107) is the condition number of W .

The key intuition underlying this result is that the additional state covariance constraint (3d) im-
plicitly enforces sequential strong stability (Cohen et al., 2018), which in turn ensures ISS. More
formally, sequential strong stability is deﬁned as follows,

Deﬁnition 4 (Sequential Strong Stability) A sequence of policies K1, K2, ..., such that ut = Ktxt
is (κ, γ, ρ)-sequential strongly stable (for κ > 0, 0 < γ ≤ 1 and 0 ≤ ρ < 1) if there exist matrices
H1, H2, ..., and L1, L2..., such that At + BtKt = HtLtH −1
for all t, with the following properties:
(a) (cid:107)Lt(cid:107) ≤ 1 − γ; (b) (cid:107)Ht(cid:107) ≤ β1 and ||H −1

|| ≤ 1/β2 with κ = β1/β2; (c) (cid:107)H −1

t+1Ht(cid:107) ≤ ρ

t

t

1−γ .

The following lemma formalizes the connection between (3d) and sequential strong stability.

Lemma 5 Under the conditions in Theorem 3, the policies designed by COCO-LQ are (κ, γ, ρ)-
sequential strongly stability for κ = κW√
1−α

1−α where κW = (cid:107)W (cid:107)(cid:107)W −1(cid:107).

, γ = 1 −

α, ρ =

(cid:113) α

√

A proof of Lemma 5 is given in Appendix A. With Lemma 5, proving the result in Theorem 3 only
requires showing that sequential strong stability implies ISS. This result is provided in Appendix A
as part of the complete proof of Theorem 3. A critical assumption in Theorem 3 is that the SDP
given in (3) is feasible for 0 ≤ α < 1/2. The following result shows that when Bt is full row rank,
the problem is always feasible. The proof of Lemma 6 is postponed to Appendix B.

6

STABLE ONLINE CONTROL OF LTV SYSTEMS

Algorithm 2: COCO-LQ-Prediction: COVariance Constrained Online LQ with Predictions

Parameters: α ∈ [0, 1)
Input: Q, R, W (cid:31) 0

1 for t = 1, 2, ... do
2

if t ≡ 1 (mod H) then

Receive state xt, and system parameters (At, Bt), . . . , (At+H−1, Bt+H−1)
Compute policy: Let Σt ∈ Rn×n be a solution to the constrained SDP in (3) with



R



(R, At, Bt) replaced by ( ˜R, ˜At, ˜Bt), where ˜R =




. . .

R


 (H repeating blocks),

˜At := At+H−1 · · · At, ˜Bt := [Bt+H−1, At+H−1Bt+H−2, · · · , At+H−1...At+1Bt]
Set Kt = Σ(cid:62)

xx and [ut+H−1, ..., ut](cid:62) = Ktxt

xuΣ−1

end
Play Implement the planned control action ut
Update xt+1 = Atxt + Btut + wt, wt ∼ N (0, W )

3

4

5

6

7

8
9 end

Lemma 6 When Bt is full row rank, then the SDP (3) is always feasible.

Note that having Bt full row rank is a sufﬁcient but not necessary condition for feasibility of (3) of
COCO-LQ. When Bt is not full row rank, the feasibility assumption may still hold, and therefore
our assumption is weaker than the invertibility assumption used in the literature, e.g. Lai (1986).
More broadly, in Theorem 3, α < 0.5 is a sufﬁcient condition for stability. For α > 0.5, stability
may still hold for some problem instances (At, Bt) as will be shown in the simulations in Section 5.
How to provide a more reﬁned instance-dependent threshold on α is an interesting future direction.

4.3. Infeasibility and the Role of Predictions

In this case it
We now turn our attention to the case when the SDP given in (3) is infeasible.
is necessary for the controller to use additional information in order to stabilize the system.
In
particular, we provide an example that shows the necessity of predictions when Bt is not full row
rank in Appendix C. This example shows that when Bt is not full row rank, for any (deterministic)
online control algorithm that has causal access to system matrices, there exists a future sequence of
(At, Bt) in which the algorithm cannot stabilize the system.
In this section, we show that using
(At, Bt) together with short-term predictions of future system matrices is enough to stabilize the
system under standard controllability assumptions. Speciﬁcally, we extend COCO-LQ to include
future H steps of predictions in Algorithm 2. The key idea is to rewrite the dynamics as

xt+H = ˜Atxt + ˜Bt ¯ut + [I, At+H−1, · · · , At+H−1...At+1] ¯wt

(4)

where we deﬁne ˜At := At+H−1 · · · At, ˜Bt := [Bt+H−1, At+H−1Bt+H−2, · · · , At+H−1...At+1Bt],
¯ut := [u(cid:62)
t ](cid:62). When H is long
enough such that ˜Bt is full row rank, we can use Algorithm 1 on ˜At and ˜Bt and avoid the infeasibil-
ity issue, and our stability guarantee is provided below. The proof of Theorem 7 is in Appendix D.

t ](cid:62) and ¯wt := [w(cid:62)

t+H−2, . . . , w(cid:62)

t+H−2, . . . , u(cid:62)

t+H−1, w(cid:62)

t+H−1, u(cid:62)

7

STABLE ONLINE CONTROL OF LTV SYSTEMS

Theorem 7 Suppose for each t, matrix ˜Bt = [Bt+H−1, At+H−1Bt+H−2, · · · , At+H−1...At+1Bt]
satisﬁes ˜Bt ˜B(cid:62)
t (cid:23) σI for some σ > 0, and (cid:107)At(cid:107) ≤ a, (cid:107)Bt(cid:107) ≤ b for some a, b > 0. Then, the SDP
in Algorithm 2 is always feasible. Further, when α < 1/2, the closed-loop system is ISS for any t,

(cid:107)xt(cid:107) ≤ κ(cid:48)

Aρ

t

H −1(cid:107)x1(cid:107) + κ(cid:48)

AκAκ max(1,

ρ
1 − ρ

) sup
1≤s<t

(cid:107)ws(cid:107),

where the same as Theorem 3, ρ =
the condition number of W ; further, κA = 1 + a + . . . + aH−1, and κ(cid:48)
aH−1)2κR
σ with κR being the condition number of R.

1−α ∈ [0, 1) and κ = κW√

κ+aH

1−α

(cid:113) α

with κW = (cid:107)W (cid:107)(cid:107)W −1(cid:107) being
A = aH−1 + b2(1 + a + · · · +

4.4. Estimation Error

In both Algorithm 1 and Algorithm 2, the exact knowledge of state-transition matrices (At, Bt) or
the extended state-transition matrices ( ˜At, ˜Bt) are needed when deriving the control actions. In
this section, we show that COCO-LQ can still obtain a stabilizing controller in the case where only
approximations are known, if the estimation error is controlled. Our main result is the following.

Theorem 8 Let ( ˆAt, ˆBt) be an estimate of (At, Bt). Given α ∈ [0, 1
(cid:107)W (cid:107)(cid:107)W −1(cid:107)
1−α

1−α , κ =
α. Let K1, K2, ... be the policies designed by COCO-LQ for ( ˆAt, ˆBt)

2 ), let ρ =

and γ = 1 −

√

√

(cid:113) α

with parameter α. When the estimation error satisﬁes,

max{|| ˆAt − At||2, || ˆBt − Bt||2} ≤ δ

γ
κ(1 + Kmax)

(5)

where δ can be any number in (0,
Then, the policies Kt are ISS when applied to the system (At, Bt),

√

1−α−
√
1−

α

√
α ), and Kmax is any uniform upper bound on (cid:107)Kt(cid:107).

(cid:107)xt(cid:107) ≤ (ρ(cid:48))t−t0 (cid:107)xt0(cid:107) +

κρ(cid:48)
1 − ρ(cid:48)

sup
t0≤k<t

(cid:107)wk(cid:107),

where ρ(cid:48) = 1−(1−δ)γ
upper bound for (cid:107)Kt(cid:107) is Kmax = κR

1−γ

ρ ∈ (0, 1). Finally, when (cid:107) ˆAt(cid:107) ≤ ¯σA, (cid:107) ˆBt(cid:107) ≤ ¯σB and ˆBt ˆB(cid:62)

t (cid:23) σ2

B, one uniform

¯σB
σ2
B

(κ(1 − γ) + ¯σA) with κR = (cid:107)R(cid:107)(cid:107)R−1(cid:107).

A proof of Theorem 8 is provided in Appendix E. This result highlights the tradeoff between the
estimation error and the algorithm performance. If we choose a small α, the algorithm can tolerant
a larger estimation error (i.e. larger right hand side of (5) can be obtained) but may lead to high
control cost due to the tight state co-variance constraint. If we choose a larger α, the algorithm
tolerates smaller estimation error while its performance improves due to the less strict state co-
variance constraint.

5. Experiments

The results in the previous section focus on stability of COCO-LQ approach. Here, we use experi-
mental results to highlight that COCO-LQ also performs near-optimally in terms of cost while also
stabilizing systems that the naive approach based on LTI control cannot. In Section 5.1, we test our
method on random, synthetic linear time varying systems, and in Section 5.2 we demonstrate the
algorithm performance in real-world power system frequency control settings. More experiment
results on nonlinear systems via local linear approximation could be found in Appendix F.

8

STABLE ONLINE CONTROL OF LTV SYSTEMS

5.1. Synthetic Time-Varying Systems

We ﬁrst consider the control of switching and time-variant systems. The cost function is set as
Q = 0.2I, R = I, and system is subject to Gaussian disturbance wt ∼ N (0, 0.12). We average the
simulation results over 5 runs and visualize the mean performance and standard deviation.

a. Switching systems. we consider a switching system following Example 1 in Section 3, where
At alternates between A = [[0.99, 1.5], [0, 0.99]] and A(cid:48) = [[0.99, 0], [1.5, 0.99]], and Bt = I.

b. Time-variant systems. We consider a system At = [[0.99, sin( πt

2 )|et/60], [| cos( πt

2 )|et/60, 0.99]]

that is continually changing over time, and Bt = I.

Figure 1: Performance comparison of COCO-LQ and LQ on synthetic time-varying systems. The
left two ﬁgures show the state evolution, and right two ﬁgures show the normalized cost
(cost of COCO-LQ divided by cost of the ofﬂine optima) under different α.

As we can see in Figure 1, COCO-LQ is able to quickly and effectively stabilize the system under
various time-varying scenarios, which validates our theoretical ﬁndings. As α increases, the ac-
quired cost of COCO-LQ ﬁrst decreases and then increases (explosion of state), highlighting that α
can explicitly control the tradeoff between cost and stability. With proper selection of α, COCO-LQ
achieves near-optimal cost (within 30% of the ofﬂine optimal for both system a and b).

5.2. Frequency Control with Renewable Generation

We now consider a power system frequency control problem on standard IEEE WECC 3-machine
9-bus system (Figure 2(a)), which is a widely adopted system used in frequency stability studies.
The state space model of power system frequency dynamics follows Hidalgo-Gonzalez et al. (2019),

(cid:21)

(cid:20) ˙θ
˙ω
(cid:124)(cid:123)(cid:122)(cid:125)
˙x

=

(cid:20)

(cid:124)

0
−M −1
t L −M −1
(cid:123)(cid:122)
At

I
t D

(cid:21)

(cid:125)

(cid:21)

(cid:20)θ
ω

+

(cid:21)

(cid:20) 0
M −1
t
(cid:124) (cid:123)(cid:122) (cid:125)
Bt

pin
(cid:124)(cid:123)(cid:122)(cid:125)
ut

(6)

where the state variable is deﬁned as the stacked vector of the voltage angle θ and frequency ω.
Mt = diag(mt,i) is the inertia matrix, where mt,i represents the equivalent rotational inertia at
bus i and time t. Mt is time-varying and depends on the mix of online generators, since only
thermal generators provide rotational inertia and renewable generation does not Ulbig et al. (2014).
D = diag(di) is the damping matrix, where di is the generator damping coefﬁcient. L is the
network susceptance matrix. The control variable pin corresponds to the electric power generation.
We assume the system is changing between two states: a high renewable generation scenario
where mt,i = 2 (i.e., 80 percent renewable with zero inertia and 20 percent of thermal generation

9

STABLE ONLINE CONTROL OF LTV SYSTEMS

(a)

(b)

Figure 2: (a) IEEE WECC 3-machine 9-bus system schematic with generators at bus 1, 5, 9 are
mixture of thermal generation and renewable. (b) Frequency dynamics under ofﬂine op-
tima, baseline H-horizon control, and COCO-LQ. The dotted grey lines (±0.05Hz) are
the safety margin of power system frequency variation.

with 10s inertia), and a low renewable generation scenario where mt,i = 8 (i.e., 20 percent renew-
able and 80 percent thermal generation), with additional random ﬂuctuations between [0, 0.2]. This
setup represents the real-world situation where we have high solar output during the daytime, and
low output in the morning/evening, with intra-day variations due to clouds and weather changes.
Notice that Bt is not full rank, thus we need to leverage predictions, i.e., At+1 and Bt+1. For fair
comparison, we compete against the H-horizon optimal control in Bertsekas et al. (1995), which
is the extension of naive LTI controller to use H-step predictions. In both cases, we assume the
prediction is accurate and use the exact value of At+1 and Bt+1 for computing control actions.

Figure 2(b) visualizes the power system frequency dynamics under three controllers: the ofﬂine
optimal control, the baseline H-horizon optimal controller and the proposed COCO-LQ-Prediction
method. We ideally desire a controller that is able to maintain the frequency variation within
±0.05Hz and eventually stabilize the system. It can be observed that our algorithm succeeds at
maintaining the frequency stability under random, time-varying renewable generations. Further-
more, the performance of COCO-LQ is very close to the ofﬂine optimal, while the system frequency
diverges under the baseline H-horizon optimal control.

6. Conclusion

In this paper, we study the stability of LTV systems. Our results demonstrate the challenge of
ensuring stability for LTV systems compared to LTI systems. Motivated by this challenge, we
propose a COCO-LQ/COCO-LQ-Prediction policy that can guarantee stability for LTV systems
under certain assumptions. There are many interesting open questions that remain. For example,
the bound α < 1/2 in Theorem 3 is a sufﬁcient condition, and studying how to relax the bound
and how to derive instance-dependent bounds is an interesting future question. Another important
direction is to analyze the performance (e.g. the regret) of the proposed approach in order to quantify
the tradeoff between stability and performance.

10

STABLE ONLINE CONTROL OF LTV SYSTEMS

References

Yasin Abbasi-Yadkori and Csaba Szepesv´ari. Regret bounds for the adaptive control of linear
quadratic systems. In Proceedings of the 24th Annual Conference on Learning Theory, pages
1–26, 2011.

Francesco Amato, Marco Ariola, and Carlo Cosentino. Finite-time control of discrete-time linear

systems: analysis and design conditions. Automatica, 46(5):919–924, 2010.

Dimitri P Bertsekas, Dimitri P Bertsekas, Dimitri P Bertsekas, and Dimitri P Bertsekas. Dynamic

programming and optimal control, volume 1. Athena scientiﬁc Belmont, MA, 1995.

Alon Cohen, Avinatan Hassidim, Tomer Koren, Nevena Lazic, Yishay Mansour, and Kunal Talwar.

Online linear quadratic control. arXiv preprint arXiv:1806.07104, 2018.

Sarah Dean, Horia Mania, Nikolai Matni, Benjamin Recht, and Stephen Tu. Regret bounds for
In Advances in Neural Information

robust adaptive control of the linear quadratic regulator.
Processing Systems, pages 4188–4197, 2018.

Paolo Falcone, Manuela Tufo, Francesco Borrelli, Jahan Asgari, and H Eric Tseng. A linear time
varying model predictive control approach to the integrated vehicle dynamics control problem in
autonomous systems. In 2007 46th IEEE Conference on Decision and Control, pages 2980–2985.
IEEE, 2007.

Paolo Falcone, Francesco Borrelli, H Eric Tseng, Jahan Asgari, and Davor Hrovat. Linear time-
varying model predictive control and its application to active steering systems: Stability analysis
International Journal of Robust and Nonlinear Control: IFAC-
and experimental validation.
Afﬁliated Journal, 18(8):862–875, 2008.

Germain Garcia, Sophie Tarbouriech, and Jacques Bernussou. Finite-time stabilization of linear
IEEE Transactions on Automatic Control, 54(2):364–369,

time-varying continuous systems.
2009.

Gautam Goel and Babak Hassibi. Regret-optimal control in dynamic environments. arXiv preprint

arXiv:2010.10473, 2020.

Paula Gradu, Elad Hazan, and Edgar Minasyan. Adaptive regret for control of time-varying dynam-

ics. arXiv preprint arXiv:2007.04393, 2020.

Patricia Hidalgo-Gonzalez, Rodrigo Henriquez-Auba, Duncan S Callaway, and Claire J Tomlin.
Frequency regulation using data-driven controllers in power grids with variable inertia due to
In 2019 IEEE Power & Energy Society General Meeting (PESGM), pages
renewable energy.
1–5. IEEE, 2019.

Yiguang Hong, Zhong-Ping Jiang, and Gang Feng. Finite-time input-to-state stability and applica-
tions to ﬁnite-time control design. SIAM Journal on Control and Optimization, 48(7):4395–4418,
2010.

Zhong-Ping Jiang and Yuan Wang. Input-to-state stability for discrete-time nonlinear systems. Au-

tomatica, 37(6):857–869, 2001.

11

STABLE ONLINE CONTROL OF LTV SYSTEMS

Hassan K Khalil. Nonlinear systems, volume 3. 2002.

T.L Lai. Asymptotically efﬁcient adaptive control in stochastic regression models. Advances
in Applied Mathematics, 7(1):23 – 45, 1986.
doi: https://doi.org/
10.1016/0196-8858(86)90004-7. URL http://www.sciencedirect.com/science/
article/pii/0196885886900047.

ISSN 0196-8858.

Sahin Lale, Kamyar Azizzadenesheli, Babak Hassibi, and Anima Anandkumar. Adaptive
arXiv preprint

control and regret minimization in linear quadratic gaussian (lqg) setting.
arXiv:2003.05999, 2020a.

Sahin Lale, Kamyar Azizzadenesheli, Babak Hassibi, and Anima Anandkumar. Explore more and

improve regret in linear quadratic regulators. arXiv preprint arXiv:2007.12291, 2020b.

Xiaodi Li, Xueyan Yang, and Shiji Song. Lyapunov conditions for ﬁnite-time stability of time-

varying time-delay systems. Automatica, 103:135–140, 2019a.

Yingying Li, Aoxiao Zhong, Guannan Qu, and Na Li. Online markov decision processes with time-
varying transition probabilities and rewards. In ICML Real-world Sequential Decision Making
workshop, 2019b.

Riccardo Marino and Patrizio Tomei. Robust adaptive regulation of linear time-varying systems.

IEEE Transactions on Automatic Control, 45(7):1301–1311, 2000.

Richard H Middleton and Graham C Goodwin. Adaptive control of time-varying linear systems.

IEEE Transactions on Automatic Control, 33(2):150–155, 1988.

Yi Ouyang, Mukul Gagrani, and Rahul Jain. Learning-based control of unknown linear systems

with thompson sampling. arXiv preprint arXiv:1709.04047, 2017.

Eduardo D Sontag. Input to state stability: Basic concepts and results. In Nonlinear and optimal

control theory, pages 163–220. Springer, 2008.

Sophie Tarbouriech, Germain Garcia, and Adolf H Glattfelder. Advanced Strategies in Control
Systems with Input and Output Constraints, volume 346. Springer Science & Business Media,
2006.

Emanuel Todorov and Weiwei Li. A generalized iterative lqg method for locally-optimal feed-
back control of constrained nonlinear stochastic systems. In Proceedings of the 2005, American
Control Conference, 2005., pages 300–306. IEEE, 2005.

Andreas Ulbig, Theodor S Borsche, and G¨oran Andersson.

Impact of low rotational inertia on

power system stability and operation. IFAC Proceedings Volumes, 47(3):7290–7297, 2014.

Lieven Vandenberghe and Stephen Boyd. Semideﬁnite programming. SIAM review, 38(1):49–95,

1996.

Alex Zheng and Manfred Morari. Robust control of linear time-varying systems with constraints. In
Proceedings of 1994 American Control Conference-ACC’94, volume 3, pages 2416–2420. IEEE,
1994.

12

STABLE ONLINE CONTROL OF LTV SYSTEMS

Appendix A. Proof of Theorem 3

In this section, we provide the proof of Theorem 3. As mentioned in Section 4.2, the proof consists
of two steps. In the ﬁrst step, we show that the algorithm guarantees strong sequential stability
(Lemma 5), which we prove in Appendix A.1, and in the second step, we show that strong sequential
stability guarantees input-to-state stability, or more formally:

Lemma 9 Supppose a sequence of policies K1, K2, . . . , Kt, . . . is (κ, γ, ρ)-sequential strongly
stable. Then, the closed loop system is input-to-state stable in the sense that for any t ≥ t0 ≥ 1,

(cid:107)xt(cid:107) ≤ κρt−t0(cid:107)xt0(cid:107) +

κρ
1 − ρ

max
t0≤s<t

(cid:107)ws(cid:107).

We provide the proof of Lemma 9 in Appendix A.2. Combining the above two steps ﬁnishes the
proof of Theorem 3.

A.1. Proof of Lemma 5

To prove Lemma 5, we ﬁrst show an auxilliary result that the optimal solution to the SDP in (3)
must have a speciﬁc low rank structure. Then, utilizing this structure, we prove Lemma 5.

Lemma 10 Suppose Q, R, W are strictly positive deﬁnite and α ∈ [0, 1). If (3) has a minimizer
Σ∗, then there exists K ∈ Rp×d s.t. Σ∗ can be written as

Σ∗ =

(cid:20) Σ∗
Σ∗
xu
xx
xu)(cid:62) Σ∗
(Σ∗
uu

(cid:21)

=

(cid:20) Σ∗
Σ∗
xx
xx KΣ∗
KΣ∗

xxK(cid:62)
xxK(cid:62)

(cid:21)

Proof Clearly, Σ∗
only thing we need to show is Σ∗
must exist D (cid:54)= 0, D (cid:23) 0 s.t.

xx (cid:23) W (cid:31) 0, and therefore we can simply deﬁne K = (Σ∗

xx)−1, and the
xxK(cid:62). Suppose this is not true, then since Σ∗ (cid:23) 0, there

uu = KΣ∗

xu)(cid:62)(Σ∗

Then, by (3b), we also have,

Σ∗

uu = KΣ∗

xxK(cid:62) + D.

Σ∗

xx = (At + BtK)Σ∗

xx(At + BtK)(cid:62) + BtDB(cid:62)

t + W.

(7)

(8)

Viewing the above as a Lyapunov equation in terms of Σ∗
Σ∗

xx (cid:31) 0, we get At + BtK is a stable matrix.

xx, and since BtDB(cid:62)

t + W (cid:31) 0 and

Next, since At + BtK is stable, we can construct ˜Σxx to be the unique solution to the following

Lyapunov equation,

We further deﬁne,

˜Σxx = (At + BtK) ˜Σxx(At + BtK)(cid:62) + W.

(9)

˜Σ =

(cid:20) ˜Σxx
˜ΣxxK(cid:62)
K ˜Σxx K ˜ΣxxK(cid:62)

(cid:21)

,

13

STABLE ONLINE CONTROL OF LTV SYSTEMS

and we claim that ˜Σ is a feasible solution to (3). Clearly ˜Σ is positive semi-deﬁnite, and further, it
satisﬁes (3b). We now check that (3d) is met below.

(cid:3)(cid:62) − α ˜Σxx

(cid:3) ˜Σ (cid:2)At Bt

(cid:2)At Bt
= (At + BtK) ˜Σxx(At + BtK)(cid:62) − α ˜Σxx
xx(At + BtK)(cid:62) − αΣ∗
= (At + BtK)Σ∗
= (cid:2)At Bt
(cid:22) −BtDB(cid:62)

(cid:3)(cid:62) − BtDB(cid:62)
(cid:3) Σ∗ (cid:2)At Bt
t + (At + BtK)( ˜Σxx − Σ∗

xx + (At + BtK)( ˜Σxx − Σ∗

xx)(At + BtK)(cid:62) − α( ˜Σxx − Σ∗

xx)

t − αΣ∗
xx)(At + BtK)(cid:62) − α( ˜Σxx − Σ∗

xx + (At + BtK)( ˜Σxx − Σ∗
xx),

xx)(At + BtK)(cid:62) − α( ˜Σxx − Σ∗

xx)

(10)

(11)

where the last step is due to Σ∗ must satisfy (3d). Subtracting (8) from (9), we have,

˜Σxx − Σ∗

xx = (At + BtK)( ˜Σxx − Σ∗

xx)(At + BtK)(cid:62) − BtDB(cid:62)
t .

Plugging (11) into (10), we have,

(cid:2)At Bt

(cid:3) ˜Σ (cid:2)At Bt

(cid:3)(cid:62) − α ˜Σxx (cid:22) (1 − α)( ˜Σxx − Σ∗

xx).

Therefore, to check (3d) it remains to show ˜Σxx − Σ∗
Lyapunov equation in terms of ˜Σxx − Σ∗
˜Σxx − Σ∗

xx, and as At + BtK is stable, and BtDB(cid:62)
xx (cid:22) 0. As a result, (3d) holds and ˜Σxx is indeed a feasible solution to (3).

xx (cid:22) 0. To see this, we view (11) as a
t (cid:23) 0, we have

Further, we can show ˜Σ achieves a strictly lower cost than Σ∗. To see this, note we have already
shown ˜Σxx (cid:22) Σ∗
uu − D with D (cid:23) 0,
D (cid:54)= 0. Coupled this with the fact that Q, R are strictly positive deﬁnite, we have ˜Σ must achieve a
lower cost. So we get a contradiction, and the proof is concluded.

xx, which also implies ˜Σuu = K ˜ΣxxK(cid:62) (cid:22) KΣ∗

xxK(cid:62) = Σ∗

Leveraging the decomposition of the SDP solution in Lemma 10, we now prove Lemma 5.
Proof of Lemma 5. Let Σt be the solution to the SDP (3) at step t. Then by Lemma 10, Σt can be
rewritten as,

Σt =

(cid:20) Σt,xx
Σt,xxK(cid:62)
t
KtΣt,xx KtΣt,xxK(cid:62)
t

(cid:21)

,

for some Σt,xx (cid:31) 0, and Kt is the linear controller at step t. With this, we can re-write the left side
of constraint (3d) as follows,

(cid:2)At Bt

(cid:3) Σt

(cid:2)At Bt

(cid:3)(cid:62) = (cid:2)At Bt

(cid:3)

(cid:20) Σt,xx
Σt,xxK(cid:62)
t
KtΣt,xx KtΣt,xxK(cid:62)
t
t + AtKtΣt,xxB(cid:62)

= AtΣt,xxA(cid:62)
= (At + BtKt)Σt,xx(At + BtKt)(cid:62).

(cid:21)

(cid:21) (cid:20)A(cid:62)
t
B(cid:62)
t

t + BtΣt,xxK(cid:62)

t A(cid:62)

t + BtKtΣt,xxK(cid:62)

t B(cid:62)
t

As a result, (3d) can be equivalently expressed as,

(At + BtKt)Σt,xx(At + BtKt)(cid:62) (cid:22) αΣt,xx.

Left and right multiplying the above by Σ−1/2

t,xx , we get

t,xx (At + BtKt)Σ1/2
Σ−1/2

t,xxΣ1/2

t,xx(At + BtKt)(cid:62)Σ−1/2

t,xx (cid:22) αI .

14

(12)

(13)

STABLE ONLINE CONTROL OF LTV SYSTEMS

Let Ht = Σ1/2

t,xx, Lt = Σ−1/2

t,xx (At + BtKt)Σ1/2

t,xx. This gives us the following decomposition,

(At + BtKt) = HtLtH −1

t

.

(14)

We now show that this decomposition yields the desired sequential stability property. To do so, we
need to check the three conditions in Deﬁnition 4.

LtL(cid:62)

To check condition (a) in Deﬁnition 4, note that (13) provides an upper bound on (cid:107)Lt(cid:107), that is
t (cid:22) αI. Therefore, (cid:107)Lt(cid:107) ≤
To check condition (b) which is an upper bound on (cid:107)Ht(cid:107) and (cid:107)H −1

t (cid:107), we recall constraint (3b),

α = 1 − γ with γ = 1 −

α.

√

√

(cid:2)At Bt

(cid:3) Σt

(cid:2)At Bt

(cid:3)(cid:62) = Σt,xx − W.

As the left hand side of the above is positive semi-deﬁnite, we must have Σt,xx (cid:23) W . Further,
plugging (3b) into (3d), we can get, Σt,xx − W (cid:22) αΣt,xx. These can be equivalently written as,

W (cid:22) Σt,xx (cid:22)

W
1 − α

.

(15)

(cid:107)W 1/2(cid:107)(cid:107)W −1/2(cid:107)
1−α

t,xx(cid:107) ≤ (cid:107)W 1/2(cid:107)

Therefore, (cid:107)Ht(cid:107) = (cid:107)Σ1/2

, (cid:107)H −1
. Therefore, condition (b) holds with κ = κW√
√
1−α
Lastly, we check condition (c), which is an upper bound on (cid:107)H −1
t+1Ht(cid:107). Note that,

t (cid:107) = (cid:107)Σ−1/2

= κW√
1−α

t,xx (cid:107) ≤ (cid:107)W −1/2(cid:107), (cid:107)Ht(cid:107)(cid:107)H −1

1−α

√

.

t (cid:107) ≤

H −1

t+1HtH (cid:62)

t (H −1

t+1)(cid:62) = H −1

t+1Σt,xx(H −1

t+1)(cid:62) (cid:22)

1
1 − α

(Σt+1,xx)−1/2W (Σt+1,xx)−1/2 (cid:22)

1
1 − α

I,

= ρ

where the two inequalities in the above derivations are due to (15). As a result, we have (cid:107)H −1
1√

In summary, the (κ, γ, ρ) strong sequential stability holds, with κ = κW√
1−α
(cid:113) α

. As α < 1/2, we have ρ < 1. As such, condition (c) holds.
, γ = 1 −

1−γ with ρ =

√
α√
1−α

1−α

√

ρ =

1−α . This concludes the proof.

α, and

(cid:4)

t+1Ht(cid:107) ≤

A.2. Proof of Lemma 9

For notational simplicity, we only prove the case with t0 = 1; the general case follows similarly, at
the cost of heavier notations. Let x1, x2, ... be a sequence of states starting from initial state x1, and
generated by the dynamics xt+1 = Atxt + Btut + wt = (At + BtKt)xt + wt. Hence,

xt = M1x1 +

t−1
(cid:88)

s=1

Ms+1ws ,

where

Mt = I; Ms = Ms+1(As + BsKs) = (At−1 + Bt−1Kt−1) · · · (As + BsKs).

By the strong sequential stability, there exist matrices H1, H2, ... and L1, L2, ... such that Aj +
, and Hj, Lj satisfy the properties speciﬁed in Deﬁnition 4. Thus we have for

BjKj = HjLjH −1
all 1 ≤ s < t,

j

(cid:107)Ms(cid:107) = (cid:107)Ht−1Lt−1H −1

t−1Ht−2Lt−1H −1

t−2 · · · HsLsH −1
s (cid:107)

15

STABLE ONLINE CONTROL OF LTV SYSTEMS

≤ (cid:107)Ht−1(cid:107)





t−1
(cid:89)

j=s





(cid:107)Lj(cid:107)





t−2
(cid:89)

j=s

(cid:107)H −1

j+1Hj(cid:107)


 (cid:107)H −1

s (cid:107) ,

≤ β1(1 − γ)t−s(

ρ
1 − γ

)t−s−1(1/β2) ≤

κ(1 − γ)
ρ

ρt−s

As κ ≥ 1, the same holds for Mt. Thus, we have,

(cid:107)xt(cid:107) ≤ (cid:107)M1(cid:107)(cid:107)x1(cid:107) +

t−1
(cid:88)

s=1

(cid:107)Ms+1(cid:107)(cid:107)ws(cid:107)

≤ κρt−1(cid:107)x1(cid:107) + κ

t−1
(cid:88)

s=1

ρt−s−1(cid:107)ws(cid:107)

≤ κρt−1(cid:107)x1(cid:107) + κ max
1≤s<t
κρ
1 − ρ

= κρt−1(cid:107)x1(cid:107) +

(cid:107)ws(cid:107)

∞
(cid:88)

t=1

ρt

max
1≤s<t

(cid:107)ws(cid:107).

Appendix B. Proof of Lemma 6

We prove the lemma by explicitly constructing a feasible solution for (3). As Bt has full row rank,
BtB(cid:62)
t

is invertible. Let

Σ0 =

=

(cid:20)
−B(cid:62)
(cid:20)
−B(cid:62)

W
t )−1AtW B(cid:62)
t (BtB(cid:62)
(cid:21)
I
t (BtB(cid:62)

t )−1At

t )−1Bt
t (BtB(cid:62)
−W A(cid:62)
t )−1AtW A(cid:62)
t (BtB(cid:62)
t (BtB(cid:62)
(cid:21)(cid:62)
I
t (BtB(cid:62)

t )−1At

−B(cid:62)

W

(cid:20)

.

t )−1Bt

(cid:21)

It sufﬁces to show that Σ0 satisﬁes (3b), (3c) and (3d). Notice that

(cid:2)At Bt

(cid:3) Σ0

(cid:2)At Bt

(cid:3)(cid:62) = (At − BtB(cid:62)

t (BtB(cid:62)

t )−1At)W (At − BtB(cid:62)

t (BtB(cid:62)

t )−1At)(cid:62) = 0.

Therefore, constraint (3b) is equivalent to Σxx = W , which holds by the construction of Σ0. Next,
as W (cid:31) 0, Σ0 is clearly positive semi-deﬁnitive and (3c) holds. Finally, note the left hand side of
(3d) is 0, and the right hand side of (3d) is positive semi-deﬁnite. As a result, (3d) holds.

Appendix C. On the Role of Prediction

In the following example, we show that when Bt is not full row rank, then no matter what (determin-
istic) online algorithm we use, there always exists a time varying (At, Bt) for which this algorithm
fails to stabilize from a initial state.

Example 2 We consider a counter example which shows when Bt is not full row rank, then no
matter what online deterministic algorithm we use which decides ut based on information of the
dynamics up to (At, Bt), we can construct a sequence of (At, Bt) such that the system state will
blow up from a given initial state.

16

STABLE ONLINE CONTROL OF LTV SYSTEMS

We set d = 2, p = 1, i.e. At is 2-by-2 and Bt is 2-by-1. For all t, we set Bt = [1, 0](cid:62), and for
even time indices t = 2k, we set At = I. Further, x0 = [1, 1](cid:62) and wt = 0. Our construction is
based on induction. Suppose at an even index t = 2k, x2k = [x2k,1, x2k,2](cid:62) with x2k,2 ≥ 0. Then,
after u2k is determined, we set

A2k+1 =

(cid:21)

(cid:20)1 0
(cid:15) 2

|x2k,2|

with (cid:15) = 0.5
max(|x2k,1|,1) sign(u2k) Then, after (A2k+1, B2k+1) is revealed to the learner, it takes an
action u2k+1, resulting in x2k+2 = A2k+1A2kx2k + A2k+1B2ku2k + B2k+1u2k+1. Since A2k = I
and B2k = B2k+1 = [1, 0](cid:62), the second coordinate of x2k+2 can then be written as

x2k+2,2 = (cid:15)x2k,1 + 2x2k,2 + (cid:15)u2k.

By the way (cid:15) is chosen, we have (cid:15)u2k ≥ 0, and |(cid:15)x2k,1| ≤ 0.5|x2k,2|, and therefore, x2k+2,2 ≥
1.5x2k,2.

Since the system starts with x0 = [1, 1](cid:62), applying the argument above recursively, we have for

any k, x2k,2 ≥ 1.5k, i.e. the state blows up.

Appendix D. Proof of Theorem 7

The feasibility directly follows Lemma 6. For stability, recall that we have rewritten the dynamics
as,

xt+H = ˜Atxt + ˜Bt








ut+H−1
ut+H−2
...
ut








+ [I, At+H−1, · · · , At+H−1...At+1]

(cid:124)

(cid:123)(cid:122)
:= ˜wt








wt+H−1
wt+H−2
...
wt








(cid:125)

where we have deﬁned ˜At := At+H−1 · · · At, ˜Bt := [Bt+H−1, At+H−1Bt+H−2, · · · , At+H−1...At+1Bt].
By Theorem 3, we have, ∀k ≥ 1

(cid:107)xkH+1(cid:107) ≤ ρk(cid:107)x1(cid:107) +

κρ
1 − ρ

sup
0≤τ <k

(cid:107) ˜wτ H+1(cid:107).

Note that, for any τ ,

(cid:107) ˜wτ H+1(cid:107) ≤

H
(cid:88)

(cid:96)=1

(cid:107)Aτ H+H (cid:107) · · · (cid:107)Aτ H+(cid:96)+1(cid:107)(cid:107)wτ H+(cid:96)(cid:107)

≤ (1 + a + . . . + aH−1)

sup
τ H+1≤s≤(τ +1)H

(cid:107)ws(cid:107) := κA

sup
τ H+1≤s≤(τ +1)H

(cid:107)ws(cid:107).

These show that,

(cid:107)xkH+1(cid:107) ≤ ρk(cid:107)x1(cid:107) +

κAκρ
1 − ρ

sup
1≤s≤kH

(cid:107)ws(cid:107).

The above already shows the boundedness of states for time indexes t = 1 mod (H). To show the
boundedness of the states for all t, we introduce the following lemma, whose proof is deferred to
the end of this section.

17

STABLE ONLINE CONTROL OF LTV SYSTEMS

Lemma 11 For any k, and 1 ≤ (cid:96) ≤ H, we have,

(cid:107)xkH+(cid:96)(cid:107) ≤ κ(cid:48)

A(cid:107)xkH+1(cid:107) + κA

sup
kH+1≤s<kH+(cid:96)

(cid:107)ws(cid:107).

where κ(cid:48)

A = aH−1 + b2(1 + a + · · · + aH−1)2κR

κ+aH
σ

.

For any t, let k be such that t = kH + (cid:96) with 1 ≤ (cid:96) ≤ H. Then, using Lemma 11, we have,

(cid:107)xt(cid:107) ≤ κ(cid:48)

A(cid:107)xkH+1(cid:107) + κA

sup
kH+1≤s<t

(cid:107)ws(cid:107)

≤ κ(cid:48)

Aρk(cid:107)x1(cid:107) + κ(cid:48)
A

κAκρ
1 − ρ

sup
1≤s≤kH

(cid:107)ws(cid:107) + κA

sup
kH+1≤s<t

(cid:107)ws(cid:107)

t

≤ κ(cid:48)

Aρ

H −1(cid:107)x1(cid:107) + κ(cid:48)

AκAκ max(1,

ρ
1 − ρ

) sup
1≤s≤t

(cid:107)ws(cid:107).

So Theorem 7 is proven. In the rest of the section, we provide a proof for Lemma 11.

Proof of Lemma 11: Note that, by Lemma 5, we have the policies KkH+1 is (κ, γ, ρ)-sequential
. This implies (cid:107) ˜AkH+1 + ˜BkH+1KkH+1(cid:107) ≤
strongly stable, with γ = 1 −
(1 − γ)κ, showing

α and κ = κW√
1−α

√

(cid:107) ˜BkH+1KkH+1(cid:107) ≤ (1 − γ)κ + aH ,

which further leads to

(cid:107)KkH+1(cid:107) ≤ Kmax = κR

b(1 + a + . . . + aH−1)
σ

((1 − γ)κ + aH ).

As such,

(cid:107)xkH+(cid:96)(cid:107) ≤ (cid:107)AkH+(cid:96)−1 · · · AkH+1(cid:107)(cid:107)xkH+1(cid:107)

+ (cid:107) (cid:2)BkH+(cid:96)−1, AkH+(cid:96)−1BkH+(cid:96)−2, . . . , AkH+(cid:96)−1 · · · AkH+2BkH+1

(cid:3)

+ (cid:107)[I, At+H−1, · · · , AkH+(cid:96)−1...AkH+1]






wkH+(cid:96)−1
...
wkH+1




 (cid:107)






ukH+(cid:96)−1
...
ukH+1




 (cid:107)

≤ a(cid:96)−1(cid:107)xkH+1(cid:107) + b(1 + a + · · · + a(cid:96)−2)(cid:107)KkH+1(cid:107)(cid:107)xkH+1(cid:107) + (1 + a + · · · + a(cid:96)−1)

sup
kH+1≤s<kH+(cid:96)

(cid:107)ws(cid:107)

< κ(cid:48)

A(cid:107)xkH+1(cid:107) + κA

sup
kH+1≤s<kH+(cid:96)

(cid:107)ws(cid:107).

(cid:4)

Appendix E. Proof of Theorem 8

Proof The proof is divided by two parts. For the ﬁrst part, we prove the ISS property given the
upper bound Kmax on the controllers (cid:107)Kt(cid:107). In the second part, we provide such an upper bound
Kmax.

18

STABLE ONLINE CONTROL OF LTV SYSTEMS

t=0. By assumption, {Kt}∞

t=0 with (κ, γ, ρ) deﬁned by Lemma 5 as κ = κW√
1−α

Proof of ISS. By Lemma 9, to show ISS we only need to show that (Kt)∞
t=0 is sequential strongly
stable for system (At, Bt)∞
t=0 is (κ, γ, ρ)-sequential strongly stable for
(cid:113) α
the system ( ˆAt, ˆBt)∞
, γ = 1 −
1−α
where κW = (cid:107)W (cid:107)(cid:107)W −1(cid:107). Thus, there exist matrices H1, H2, ..., and L1, L2..., such that ˆMt :=
ˆAt + ˆBtKt = HtLtH −1
t with the following properties: (a) (cid:107)Lt(cid:107) ≤ 1 − γ; (b) (cid:107)Ht(cid:107) ≤ β1 and
1−γ . With this decomposition for ˆMt, we show
(cid:107)H −1
that Mt := At + BtKt can be decomposed similarly. Let ∆t = Mt − ˆMt. Then,

t (cid:107) ≤ 1/β2 with κ = β1/β2; (c) (cid:107)H −1

t+1Ht(cid:107) ≤ ρ

α, ρ =

√

Mt = ˆMt +∆t = HtLtH −1

t +HtH −1

t ∆tHtH −1

t = Ht(Lt +H −1

t ∆tHt)H −1

t = HtL(cid:48)

tH −1
t

. (16)

We next upper bound (cid:107)L(cid:48)

t(cid:107). Notice that

(cid:107)∆t(cid:107) = (cid:107)Mt − ˆMt(cid:107) = (cid:107)At + BtKt − ˆAt − ˆBtKt(cid:107)

≤ (cid:107)At − ˆAt(cid:107) + (cid:107)Bt − ˆBt(cid:107)(cid:107)Kt(cid:107)
≤ max{(cid:107)At − ˆAt(cid:107), (cid:107)Bt − ˆBt(cid:107)}(1 + (cid:107)Kt(cid:107))

≤ δ

≤ δ

γ
κ(1 + Kmax)
γ
κ

.

(1 + (cid:107)Kt(cid:107))

Then, we have the following bound on (cid:107)L(cid:48)

t(cid:107),

(cid:107)L(cid:48)

t(cid:107) = (cid:107)Lt + H −1

t ∆tHt(cid:107)

≤ (cid:107)Lt(cid:107) + (cid:107)H −1
≤ 1 − γ + δγ = 1 − (1 − δ)γ.

t (cid:107)(cid:107)∆t(cid:107)(cid:107)Ht(cid:107)

(17)

1−γ

t+1Ht(cid:107) ≤ ρ

ρ. We claim that (Kt)∞

t=0. In the decomposition (16), L(cid:48)

Deﬁne γ(cid:48) = (1 − δ)γ and ρ(cid:48) = 1−(1−δ)γ
stable for system (At, Bt)∞
proved in (17)), and by deﬁnition Ht satisﬁes (cid:107)Ht(cid:107) ≤ β1 and (cid:107)H −1
(cid:107)H −1
(b) 0 ≤ ρ(cid:48) < 1. Condition (a) is trivial since for any α ∈ [0, 1
and hence γ(cid:48) = (1 − δ)γ lies in (0, 1]. For condition (b), as ρ(cid:48) = 1−(1−δ)γ
γ = 1 −

t=0 is (κ, γ(cid:48), ρ(cid:48)) sequential strongly
t(cid:107) ≤ 1−γ(cid:48) (which we have
t (cid:107) ≤ 1/β2 with κ = β1/β2;
1−γ(cid:48) . Therefore, the only conditions we need to verify are (a) 0 < γ(cid:48) ≤ 1 and
√
α ) ⊂ (0, 1)
(cid:113) α
1−α and

α, it follows that ρ(cid:48) < 1 is equivalent to the following condition:

2 ), we have δ ∈ (0,

t satisﬁes (cid:107)L(cid:48)

1−γ = ρ(cid:48)

ρ, where ρ =

1−α−
√
1−

1−γ

√

√

α

ρ(cid:48) =

1 − (1 − δ)γ
1 − γ

ρ =

δ + (1 − δ)
√
1 − α

√

α

< 1.

(18)

Reorganizing the terms we have,

√

√

1 − α −
√
α
1 −

α

,

δ <

which is satisﬁed by our condition on δ.
Upper bounding (cid:107)Kt(cid:107). The only thing remains to show is that there exists an upper bound on the
controller gain matrix under the conditions stated in the Theorem.

19

STABLE ONLINE CONTROL OF LTV SYSTEMS

Note that Kt must satisfy ˆMt = ˆAt + ˆBtKt. On the other hand, by the COCO-LQ formulation,

Kt solves the following problem

Tr(RKtΣxxK(cid:62)
t )

min
Kt
s.t. ˆMt = ˆAt + ˆBtKt.

where Σxx is the solution to the COCO-LQ formulation at time t. The Lagrangian of the above
optimization is

L(Kt, Γ) = Tr(RKtΣxxK(cid:62)

t ) + Tr(Γ(cid:62)( ˆAt + ˆBtKt − ˆMt)).

The optimizer Kt must satisfy the following condition,

∇KtL(Kt, Γ) = 2RKtΣxx + ˆB(cid:62)

t Γ = 0.

ˆMt = ˆAt + ˆBtKt.

Together, we obtain Kt = R−1 ˆB(cid:62)

t ( ˆBtR−1 ˆB(cid:62)

t )−1( ˆMt − ˆAt) and

(cid:107)Kt(cid:107) ≤ (cid:107)R−1(cid:107)(cid:107) ˆB(cid:62)
t (cid:107)

1
σmin(R−1)σmin( ˆBt ˆB(cid:62)
t )

(κ(1 − γ) + (cid:107) ˆAt(cid:107)),

(20)

where we have used by the (κ, γ, ρ) sequential strong stability of (Kt)∞
t=0,
we have (cid:107) ˆMt(cid:107) = (cid:107) ˆAt + ˆBtKt(cid:107) ≤ κ(1 − γ). By our condition, we have (cid:107) ˆAt(cid:107) ≤ ¯σA, (cid:107) ˆBt(cid:107) ≤ ¯σB,
ˆBt ˆB(cid:62)
B, and κR = (cid:107)R(cid:107)(cid:107)R−1(cid:107). Then, we have (cid:107)Kt(cid:107) upper bounded as follows,

t=0 for system ( ˆAt, ˆBt)∞

t (cid:23) σ2

(cid:107)Kt(cid:107) ≤ κR

¯σB
σ2
B

(κ(1 − γ) + ¯σA).

Appendix F. Supplementary Experiment Results: Nonlinear System Control via

Local Linear Approximation

We further test the performance of COCO-LQ for online control of linear time varying systems that
are derived from local linearization of nonlinear systems. In particular, we consider the pendulum
swingup task, where the system dynamics are described by,

(cid:21)
(cid:20) ˙θ
¨θ

=

(cid:20)

(cid:21)

˙θ
g
l sinθ

+

(cid:21)

(cid:20) 0
1
ml2

u = f (x, u)

(21)

where x = [θ, ˙θ] represents the system state, in which θ, ˙θ and ¨θ are the angle, angular velocity
and angular acceleration. g is the gravitational acceleration, l and m are the length and mass of the
pendulum. The control goal is to stabilize the pendulum at the straight up position with θ = 0 and
˙θ = 0, starting from any initial angle and velocity. The pendulum dynamics described by Eq (21)

20

STABLE ONLINE CONTROL OF LTV SYSTEMS

Figure 3: Performance comparison of COCO-LQ and LQ on inverted pendulum via locally lin-
earization. The left two ﬁgures show the state evolution of angle θ and angular velocity
˙θ. Initial angle is set as θ = 1.2rad, and the desired state is θ = ˙θ = 0. The right two
ﬁgures show the control action and cost comparison, with Q = R = I.

is a nonlinear system, by taking local linear approximation at each xt, we can approximate the
nonlinear system via a linear time varying system,

(cid:20) ˙θ
(cid:21)
¨θ

=

(cid:20)

(cid:124)

0

(cid:21)
1
g
l cos θt 0
(cid:123)(cid:122)
At

(cid:125)

(cid:21)

(cid:20)θ
˙θ

+

u

(cid:21)

(cid:20) 0
1
ml2
(cid:124) (cid:123)(cid:122) (cid:125)
Bt

(22)

Fig 3 compares the performance of the proposed COCO-LQ approach and baseline LQ ap-
proach. As we can observed from the left two plots, COCO-LQ is able to stabilize the pendulum
at the desired position due to its robustness under model estimation error (caused by local linear
approximation) and time-varying dynamics, while the naive LQR approach fails to achieve the
swingup task and stabilize the system. The right two plots show the evolution of the control efforts
and cost. COCO-LQ initially outputs signiﬁcantly larger control actions compared to the base-
line LQ controller, to stop the pendulum from falling over. The overall control cost of COCO-LQ
quickly converges once the swingup task is ﬁnished, while the cost of LQ control keeps growing.

21

