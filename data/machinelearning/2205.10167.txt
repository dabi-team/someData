2
2
0
2

y
a
M
0
2

]

R
S
.
h
p
-
o
r
t
s
a
[

1
v
7
6
1
0
1
.
5
0
2
2
:
v
i
X
r
a

Solar Physics
DOI: 10.1007/•••••-•••-•••-••••-•

Reconstruction of the Solar Activity from the
Catalogs of the Zurich Observatory

Egor Illarionov1,2

· Rainer Arlt3

© Springer ••••

Abstract Catalogs of the Zurich Observatory contain positional information
on sunspots, prominences and faculae in late 19th and early 20th centuries.
This database is given in handwritten tabular form and was not systematically
analysed earlier. It is diﬀerent from the sunspot number time series made in
Zurich and was obtained with a larger telescope. We trained a neural-network
model for handwritten text recognition and present the database of reconstructed
coordinates. The database obtained connects the earlier observations by Sp¨orer
with later programs of the 20th century and supplements the sunspot-group
catalogs of the Royal Greenwich Observatory. We also expect that the presented
machine-learning approach and its deep capabilities will motivate the processing
of a wide bulk of astronomical data, which is still given in non-digitized form or
as plain scanned images.

Keywords: Sunspots, Data management, Statistics

1. Introduction

Telescopic observations of sunspots are available for more than 400 years. The
increasing amount of digitized versions of historical books and manuscripts has
propelled the detailed analysis of those observations in the last decade. An
overview of the utilization of historic sunspot drawings in particular was given
by Arlt and Vaquero (2020).

A long time and frequently used series of sunspot data is available from
photographs of the Royal Greenwich Observatory for 1874–1976. The data are
actually a compilation of results from several observatories around the world

E.A. Illarionov
egor.illarionov@math.msu.ru

1 Moscow State University, Moscow, Russia

2

3

Institute of Continuous Media Mechanics, Perm, Russia

Leibniz Institute for Astrophysics, Potsdam, Germany

SOLA: main.tex; 23 May 2022; 0:38; p. 1

 
 
 
 
 
 
Illarionov & Arlt

as to cover nearly every single day of the 103-year period (Willis et al., 2013).
The disadvantage of the catalogue is that no information on individual spots is
available, but only average positions of sunspot groups as well as their areas.
Moreover, it has been argued, e.g. by Clette et al. (2014) and Cliver (2017), that
the Greenwich catalogue has a deﬁcit of groups until about 1915 as compared
to the rest of the time series.

The period around 1900 saw a relatively low Cycle 14 and may be associated
with a secular minimum which solar activity encounters roughly once a century.
A detailed knowledge of the various manifestations of solar activity in those
periods when activity is lower for many years is interesting as to what is diﬀerent
compared to other cycles.

The present paper attempts to bring the sunspot positions of the Zurich
Observatory into digital form. The full period covered with a consistent analysis
method is from 1883–1936. The observations are based on direct measurements
of coordinates and are accompanied by detailed drawings of the Sun.

Previous attempts of pattern recognition on graphical sunspot data include,
e.g., the reconstruction of the Carrington catalog by Lepshokov, Tlatov, and
Vasil’eva (2012), the analysis by Diercke, Arlt, and Denker (2015) of sunspot
positions in the synoptic maps by Gustav Sp¨orer, and the partial reconstruc-
tion of the synoptic maps made by Alfred Wolfer in Zurich (Tlatova, Vasil’eva,
and Tlatov, 2020). On the more contemporary side, MDI images were analysed
through automated recognition by Watson and Fletcher (2011). Data utilization
by character recognition on printed tables was performed by Curto et al. (2016),
for instance.

2. Data Set

When Alfred Wolfer started working under Rudolf Wolf at Eidgen¨ossische Stern-
warte Z¨urich in Switzerland, he started a programme with detailed drawings of
all sunspots, faculae and prominences for as many days as possible. The time
series of Wolf numbers was continued as a separate programme with a smaller
telescope, in order to keep the consistency of the numbers with the past. In the
positional programme, most spots, faculae, and prominence were measured with
their locations and compiled in result books, available as digital documents at
e-manuscripta in Zurich1. We list the permanent links to the individual books in
Table 2. Wolfer reported that he actually started with positional measurements
in the autumn of 1879 and gives sunspot positions from August 1879 to June 1880
in Wolf (1881).

Our goal is to convert the images of the scanned, hand-written result books
into numerical tables with the positions of solar activity features. The book for
1885–1886 is missing in the digital library of e-manuscripta. There are also no
individual drawings from those years in the digital archive. Alfred Wolfer gives
an instrumental description as well as an explanation for the break in 1885–1886
in Wolf (1887), which we translate to

1https://www.e-manuscripta.ch/

SOLA: main.tex; 23 May 2022; 0:38; p. 2

Solar Physics Reconstruction of the solar activity

Table 1. References to the twelve books of positions of solar
activity features, available at e-manuscripta. Books listed in
italics are not part of the present paper.

Years

Reference

1883–1884
1887–1892
1893–1898
1899–1902
1903–1905
1906–1910
1911–1915
1916–1920
1921–1925
1926–1930
1931–1935
1937–1938

https://doi.org/10.7891/e-manuscripta-48582
https://doi.org/10.7891/e-manuscripta-48586
https://doi.org/10.7891/e-manuscripta-48585
https://doi.org/10.7891/e-manuscripta-48587
https://doi.org/10.7891/e-manuscripta-48583
https://doi.org/10.7891/e-manuscripta-48850
https://doi.org/10.7891/e-manuscripta-48849
https://doi.org/10.7891/e-manuscripta-48848
https://doi.org/10.7891/e-manuscripta-48851
https://doi.org/10.7891/e-manuscripta-49040
https://doi.org/10.7891/e-manuscripta-49038
https://doi.org/10.7891/e-manuscripta-49039

“After the positional determinations of sunspots had been interrupted in
the end of 1884 because of the planned modiﬁcation of the refractor, I have
now again started the observations this January with the resurrection of the
latter, and the observations are still the main task for this instrument.”

The ﬁrst book of 1883–1884 contains only spot information, while the second
book of 1887–1892 begins with positions of spots and faculae. On July 17, 1888,
also prominences were recorded. Since then, sunspot positions are given in black
ink, positions of faculae are given in blue ink, and positions of prominences are
in red. We will come back to the colors in Section 3.3.

There is a brief interruption of the observations in 1891, from July 31 to
September 19, because 54 pages are missing in the digital version of the corre-
sponding observing book.

Individual sunspots were measured, except when forming very small clus-
ters of two or more spots. Such clusters are much smaller than the typical
size of a sunspot group. Also, two umbrae in a common penumbra are usu-
ally given as one spot. Typical abbreviations in the tables of positions are
‘kl’ for ‘klein’ = small, ‘Gr kl Fl’ for ‘Gruppe kleiner Flecken’ = group of
small spots, ‘Hofﬂ’ for ‘Hofﬂeck’ = spot with penumbra, ‘kl Hofﬂ’ for ‘kleiner
Hofﬂeck’ = small spot with penumbra, ‘Kernﬂ’ for ‘Kernﬂeck’ = penumbra with
several umbrae. Sometimes, remarks like ‘ohne Hof’ = without penumbra appear.
In Wolf (1881), which is number 53 of his famous series of sunspot reports
(‘Mittheilungen’), Alfred Wolfer describes the measurement technique. The tele-
scope was a 16-cm refractor with a focal length of 2.63 m. The solar image was
projected onto a white screen behind the eyepiece and delivered a diameter of
about 50 cm. Cross-hairs in the eyepiece, which are projected as well, are used to
determine right ascension and declinations distances from the western, eastern,
northern and southern solar limbs, while the right ascension diﬀerences are time

SOLA: main.tex; 23 May 2022; 0:38; p. 3

Illarionov & Arlt

measurements and the declination diﬀerences are obtained with a micrometer
screw.

The conversion of coordinates follows Sp¨orer (1874) and goes through polar
coordinates on the solar disk to heliocentric ecliptical coordinates, which are
then transformed to heliographic coordinates using an ephemeris of the solar
axis. Since this was computationally expensive at the time, auxiliary tables were
used for various steps in which the observers and assistants interpolated ‘by eye’.
Whereas the atmospheric refraction is automatically taken into account by using
measurements from top and bottom, diﬀerential refraction is not, i.e. the change
of refraction across the solar disk, and the physical deviation of the Sun from
a perfect sphere is, of course, also not taken into account, but it is extremely
small (less then 10 milli-arcseconds).

Figure 1 shows a sample page layout. The key elements of the page are date
and time of the observations and 6 columns with coordinates labeled as β, λ(cid:48),
λ + k, b, l and L. We interpret b and L as heliographic latitude and longitude.
The remaining columns represent coordinates in auxiliary coordinate systems.
In the beginning of the observing programme, also the polar coordinates were
reported; they are omitted in most of the books though.

The heliographic longitude L is a sidereal value obtained at the time of writing
the observing books, using a ﬁxed angular velocity of 14.2665 degrees/day (Wolf,
1881) which corresponds to a sidereal rotation period of 25.2339 days. Note that
this value is slightly smaller than the value used by, e.g., the JPL Horizons
ephemeris service2 which is 25.38 days.

There are certain relationships between the columns. Thus, for each particular
date and time the sum of the columns λ(cid:48) and λ + k is constant modulo 360 as
well as the diﬀerence of the columns L and l is constant modulo 360. Also
sin b = sin β sin(ω + i)/ sin ω, where tan ω = tan β/ cos(λ + k) and i ≈ 6.96◦
is the inclination of the solar ecliptic (see Sp¨orer, 1874, for derivation of these
equations). The above relationships between the columns will play a crucial role
in ﬁne-tuning of the numbers recognition model.

It can be noted in Figure 1 that all numbers have a single-decimal precision.
This is valid for all catalogs except a part of the earliest ones where sunspot
coordinates were given with two-decimal precision. Due to this fact we do not
include the dot symbol into the recognition model.

3. Recognition Method

The general pipeline is as follows:

• Detection of page layout (vertical and horizontal lines that form the table);
•
Initial recognition of the numbers in table cells using the pre-trained neural
network model;

• Font color identiﬁcation;
• Derivation of linear relationships between the columns λ(cid:48), λ + k, l and L;

2https://ssd.jpl.nasa.gov/horizons/

SOLA: main.tex; 23 May 2022; 0:38; p. 4

Solar Physics Reconstruction of the solar activity

Figure 1. A sample page showing the key elements of the page layout (only the top half of
the page is shown). Green boxes show date and time of the observation and the two columns
with heliographic latitude and longitude. The red box contains coordinates of prominences,
the black box is for sunspots, the blue box is for faculae.

• Fine-tuning the neural network model to improve the recognition accuracy;
• Post-processing the outputs of the the neural network model to derive the

most probable interpretation.

Below we describe each step in more details.

3.1. Detection of Page Layout

To recover the page layout, we need to detect all vertical and horizontal lines
and distinguish between thick and thin lines that separate series of observations
and individual observations. Note that position and intervals between the lines
are not uniform thus each page should be processed individually.

We ﬁrst convert the page to grayscale, then apply the Canny ﬁlter (Canny,
1986) to detect edges in the image. We eliminate fuzzy edges by smoothing the
image with a Gaussian ﬁlter. For horizontal lines detection, we then convolve
the image with a horizontal kernel and summarize the obtained pixel intensities
along image rows. In the obtained array, horizontal lines appear as pronounced
peaks that can be easily identiﬁed. Of course, one has to carefully adjust ﬁl-
ter’s strength, kernel sizes and peak’s threshold to obtain a robust procedure.
Fortunately, a single set of parameters works ﬁne for most of the pages.

Once the page layout is deﬁned, we can isolate (crop) individual cells of the
table that will be used as inputs into the text recognition model. For convenience,
we also rescale all cell’s images to a standard size of 64 × 32 pixels.

SOLA: main.tex; 23 May 2022; 0:38; p. 5

Date and timeSunspotsFaculaeProminencesIllarionov & Arlt

3.2. Initial Model for Text Recognition

We apply the convolutional recurrent neural network model (CRNN) designed
for sequential text recognition (Shi, Bai, and Yao, 2015). The model takes an
image (in our case, of size 64 × 32 pixels) and outputs a 2D array of size 64 × 12
that will be referred as a heatmap.

More detailed, the neural network model consists of 3 blocks: sequence of
convolutional and downsampling layers, then we have two bidirectional recurrent
layers and the ﬁnal linear (fully connected) layer. The convolutional layers trans-
form input tensor of size (1, 32, 64)3 to a tensor of size (128, 1, 64). We roughly
interpret it as 128 features attributed to each image column. Then we apply
the recurrent layers to obtain a tensor of size (512, 64) that is interpreted as a
sequence (of size 64) of feature vectors (of size 512) generated from the sequence
of image columns (note that one-to-one correspondence between elements of
this sequence and image columns is not assumed here). Finally, the output layer
transforms 512 features to 12 that represent class scores, where classes are ‘0’,
‘1’, . . ., ‘9’, the minus sign ‘−’ and a special blank symbol ‘∗’, which is aimed to
separate the main symbols. These 12 symbols form the minimal suﬃcient set for
decoding a number. Sequence of size 64 of 12 class scores forms the heatmap of
size 64 × 12.

Note that we do not learn the dot symbol and the plus symbol. The reason is
that the plus symbol is a rare symbol with respect to digits and the minus symbol
(in fact, plus symbols arise when the initial minus symbol was written by mistake
and thus was canceled). Rare symbols will cause a high class imbalance during
the model training and most likely result in low accuracy for this symbol. The
dot symbol is rather noisy. There are lots of artifacts in the catalogs (e.g. random
ink dots) that can be interpreted as the dot symbol. Moreover, sometimes the
dot symbol is just missing or almost invisible. Finally, we know the a priori
position of the dot symbol.

The heatmap is used to decode the sequence of symbols. The most straight-
forward (but not the only possible as we discuss below) approach is to read the
columns of the heatmap from left to right and extract symbols corresponding
the highest score in the columns.

Next step is to compress the sequence of symbols into a number. For illustra-
tion, consider a shorter sequence: ‘∗ ∗ − − 1111 ∗ 776 ∗ ∗888 ∗ ∗∗’. To obtain a
number from this sequence, we ﬁrst replace the repeated symbols with just one
symbol to obtain ‘∗ − 1 ∗ 76 ∗ 8∗’ and then eliminate blank symbols to ﬁnally
obtain the number −1768. In most cases we can assume that it is a decimal
number with one decimal which results in −176.8.

Note that by construction of the CRNN model, the heatmap should not be
considered as per column classiﬁcation of the input image. Moreover, the width
of the heatmap is a free parameter and we set it equal to the width of the input
image just for convenience. In fact, the only thing that matters for decoding is
the order of the columns in the heatmap, not their relative distances.

3For neural networks, tensor dimensions are (channels, height, width).

SOLA: main.tex; 23 May 2022; 0:38; p. 6

Solar Physics Reconstruction of the solar activity

Figure 2. Top panel: sample image from the scanned observing book. Bottom panel: heatmap
produced by the trained model. Note that the heatmap should not be considered as per column
classiﬁcation of the input image. Only order of the columns in the heatmap is essential for
decoding, not their relative distances. Possible decodings of this heatmap are ‘−566’, ‘−560’,
‘566’, ‘−562’, ‘−506’ with conﬁdences 0.89, 0.08, 0.01, 0.01, 0.01.

To train the neural network model, we collect a set of manually labeled im-
ages. The dataset contains 8 000 samples randomly selected from the catalogs.
The idea is to provide the model with various examples of handwriting, font
colors and background. For training, we use the connectionist temporal clas-
siﬁcation loss function (CTC loss, see Graves, Fern´andez, and Gomez (2006)
for more details). We also apply various image augmentation procedures (e.g.
randomly change contrast and distort the image) to obtain better generalization
capabilities of the model.

For the trained model we obtain a 97% accuracy (i.e. the percentage of

correctly recognized numbers) on the unseen examples of the labeled dataset.

Note that the heatmap allows conﬁdence estimation and can provide us with
multiple possible interpretations. Indeed, instead of selecting a symbol with the
highest score, we can consider each column as probability distribution and sam-
ple a symbol from this distribution. In fact, we sample 100 sequences from each
heatmap and select the ﬁve most frequently decoded numbers. The frequency
of each number gives us the conﬁdence estimate. Figure 2 shows an example of
the heatmap and ranked interpretations with the conﬁdence estimates. Figure 3
shows how the accuracy of the model depends on the conﬁdence threshold and
how many samples in the test set have conﬁdences above this threshold.

SOLA: main.tex; 23 May 2022; 0:38; p. 7

010203040506005101520253001020304050600123456789*-Illarionov & Arlt

Figure 3. The accuracy of the model against the conﬁdence threshold (blue line) and the
ratio of samples in the dataset with conﬁdence above the threshold (orange line).

While the model demonstrates quite optimistic performance on the test set,
which is 1 600 samples, this test set is less than 0.05% of the whole set of unla-
beled data, which is about 3.3M. Thus we expect that the model performance
can be lower on certain pages with complex conditions (a lot of noise, unexpected
background etc) or on previously unseen hand-writings. We assume that deeper
models (with larger number of trainable parameters) could provide better gen-
eralization, however, they would require substantially larger dataset of labeled
examples, which is impractical. Instead, to adjust the model to local conditions,
we introduce a per-page ﬁne-tuning method described below. However, before
applying this method, some auxiliary steps are required and we now proceed to
these steps.

3.3. Font Color Identiﬁcation

We need to attribute the color of each table row to one of three main colors:
blue, red and black. However, we do not know a priori where to set the optimal
thresholds separating the colors. Moreover, due to the natural ink variation,
these thresholds might not be constant in time. We apply clustering in RGB
space to deﬁne the optimal thresholds for each catalog.

More detailed, we ﬁrst threshold pixel intensities to separate strokes and
background. Then we average pixel intensities in a row to obtain a single RGB
code for the row. Thus, each row of the table is represented by one point in
3D RGB space. The idea is that we expect to ﬁnd three clusters corresponding
to black, blue and red colors. However, we ﬁnd it more useful to isolate more
clusters and then interpret each as black, blue and red. Figure 4 shows color
clusters isolated with the Gaussian Mixture Model in the catalogs 1911–1916 and
1916–1920. Note that the position of the clusters varies between the catalogs.
Attributing each cluster to one of three main colors, we thereby attribute each
row in the catalog to one of three main colors. When we visually veriﬁed the
color of each row, we made only a few corrections and thus concluded that the
method is robust. We repeat this procedure for each catalog.

SOLA: main.tex; 23 May 2022; 0:38; p. 8

0.00.20.40.60.81.0Confidence threshold0.40.50.60.70.80.91.0AccuracyDataset ratio0.950.99Solar Physics Reconstruction of the solar activity

Figure 4. Font color distribution in the RGB space obtained for the book 1911–1915 (left
panel) and for the book 1916-1920 (right panel). Each dot represents a table record. The colors
discriminate clusters isolated with the Gaussian Mixture Model.

3.4. Derivation of the Linear Relationships

The initial number recognition and color detection allow us to separate series of
observations. Now within each series we can extract the most frequent sum of
columns λ(cid:48) and λ + k (modulo 360) as well as the diﬀerence of columns L and l
(also modulo 360), since we expect those to be constant for any given moment
of time (cf. Sect. 2). Taking into account that the initial number recognition
model is good on average, we expect that for most series we derive the linear
relationships correctly. At the next step we will use these relationships to improve
the recognition of each page.

3.5. Fine-tuning

Figure 5 (left panel) shows a sample page and numbers recognized by the initial
model. Accuracy for this page is 94% that is somehow lower than expected
and, moreover, the model gives low conﬁdence for many correct results. The
ﬁne-tuning approach is aimed to improve this situation. The idea is to use the
known linear relationships between the columns to derive the target labels and
make several training iterations on this page. Indeed, using the model predictions
for the column L and the known linear relationship between columns L and l,
we can reconstruct values in the column l. Now we can penalize the model if
the reconstruction does not match the actual model prediction for the column l.
The same works in the opposite direction as well and also for the columns λ(cid:48) and
λ + k. We train the model on the page until the reconstruction of one cell from
another with a linear relation does not deliver a gain in conﬁdence of the actual
output anymore. Figure 5 (right panels) shows the results after the ﬁne-tuning
step. Now the accuracy is 99% and almost all correct numbers have conﬁdence
close to 1. We repeat this procedure for each page in the catalogs.

SOLA: main.tex; 23 May 2022; 0:38; p. 9

(a)(b)Illarionov & Arlt

Figure 5. Reconstruction of page 1330 from the catalog 1893–1898. Colored cells denote
conﬁdences lower than unity (in particular, green background indicates cells where the values
were reconstructed using the linear relationships with other columns). Red circles indicate
wrong interpretations found by visual veriﬁcation. Left panel: the initial model makes 21
errors (94% accuracy for this page) and often gives low conﬁdence for correct answers. Right
panel: the ﬁne-tuning procedure improves the results substantially. The model makes now just
3 errors (99% accuracy) and conﬁdence in correct answers is close to 1. Note that cells with
wrong answers have lower conﬁdence (darker background) as desired. By setting the minimal
conﬁdence threshold one can eliminate such cases from further analysis.

3.6. Post-processing

Recall that for each cell of the table we obtain a set of decodings with corre-
sponding conﬁdence estimates (more precisely, we consider 5 values ranked by
conﬁdence). The ﬁnal step is to derive the most suitable value from the set of
decoded numbers. Note that this is not necessarily the value with the highest
conﬁdence. In fact, we select those values that match a set of natural constraints.
For example, knowing the linear relationship between columns L and l, we select
those values that match this relationship. If we fail to ﬁnd a proper combination
for some row, we select the value with the highest conﬁdence and reconstruct
the remaining one following the linear constraint. This logic also works for the
columns λ(cid:48) and λ + k. A similar but a bit more complex rule can be derived to
conclude on the values b and β given λ + k. If the value matches all the natural
constraints, we set the conﬁdence to unity. Note that it does not guarantee a
correct output and one should expect a small, but nonzero, probability of wrong
interpretations.

Note that using the heatmap one can also estimate the conﬁdence of each sym-
bol in the number. This can be used not only to isolate potentially misrecognized
numbers, but also to indicate the uncertain digits in these numbers. However,

SOLA: main.tex; 23 May 2022; 0:38; p. 10

Initial modelFine-tuned modelSolar Physics Reconstruction of the solar activity

Figure 6. Distribution of minimum of conﬁdences for β, λ(cid:48), λ + k, b, l and L for all records
in the catalogs. Note the log scale of the y-axis.

we assume that for the potential user of this dataset it is more convenient to
have a single conﬁdence value for the whole number.

4. Results

For further analysis we want to exclude observations which have low conﬁdence
(i.e., potentially misrecognized). We deﬁne the conﬁdence of the observation as
the minimal conﬁdence for values β, λ(cid:48), λ + k, b, l and L. Figure 6 shows the
distribution of the minimal conﬁdence. We observe two peaks in the distribution,
one near 1 and one near 0 conﬁdence. The value 0.4 looks as an optimal threshold
separating the two mixtures. We exclude observations with minimal conﬁdence
below 0.4 (this criteria ﬁlters out about 5% of data).

4.1. Sunspots

We identiﬁed in total 73 742 sunspot observations for the period 1887–1920. Fil-
tering out observations with the lowest conﬁdence below 0.4 yields 69 990 obser-
vations. Figure 7 shows the time-latitude distribution of the database obtained as
well as the number of sunspot records in the northern and southern hemispheres
in 6-month bins. For comparison, we provide the distribution of sunspot-groups
observations according to the catalogue4 of the Royal Greenwich Observatory
(RGO) in Figure 8.

Both Figures 7 and 8 demonstrate a high similarity in the time-latitude dis-
tribution, and we conclude that the Zurich catalogs, which provide the positions
of individual sunspots, can be used to supplement the widely used catalog of
average sunspot-group positions provided by the RGO. There are still some local
diﬀerences visible in Figures 7 and 8. In general, manual veriﬁcation is required
to conclude on particular cases, and we expect that many of these cases will

4https://solarscience.msfc.nasa.gov/greenwch.shtml

SOLA: main.tex; 23 May 2022; 0:38; p. 11

0.00.20.40.60.81.0Confidence101100101Frequency (log scale)Illarionov & Arlt

Figure 7. Upper panel: time-latitude distribution of sunspot records from the Zurich cata-
logues. Data are binned over 6 months in time and 4◦ in latitude. Bottom panel: total number
of sunspot records in the northern hemisphere (blue line) and in the southern hemisphere
(orange line) in 6-month bins.

Figure 8. Same as Figure 7 but for sunspot-groups observations from the catalogue of the
Royal Greenwich Observatory.

be investigated in a future database study process. We also note that a number
of these cases can be eliminated by stronger or more complex sunspot selection
criteria (in the simplest case by increasing the minimum conﬁdence threshold).
Comparing the Zurich and RGO catalogs one should take into account that
longitudes are not equivalent in the two datasets since diﬀerent solar rotation
speeds are used for the coordinates determination. In order to ﬁnd a relation

SOLA: main.tex; 23 May 2022; 0:38; p. 12

-40-30-20-10010203040Latitude1890189519001905191019151920Date050010001500Number of recordsCycle 13Cycle 14Cycle 15NorthSouth-40-30-20-10010203040Latitude1890189519001905191019151920Date02004006008001000Number of recordsCycle 13Cycle 14Cycle 15NorthSouthSolar Physics Reconstruction of the solar activity

Figure 9. Sample synoptic maps with sunspot positions (the blue dots) according to the
Zurich catalog and sunspot-group positions (the orange circles) according to the RGO catalog.

between the two catalogs we selected several days in the period 1887–1920 and
manually estimated the longitudinal shift between the corresponding observa-
tions. We conclude that (i) the reference time and rotation period did not change
during these years; (ii) relative speed is estimated as 0.0821 degrees/day and
the Zurich has a shorter rotation period; (iii) on 1880 Jan 01 the heliographic
longitude of 0◦ in the Zurich catalog corresponds to −68.7055◦ in the RGO
catalog. Using these parameters we translated coordinates of the Zurich catalogs
to match coordinates in the RGO catalogs.

In Figure 9 we demonstrate the correspondence of the Zurich and RGO cat-
alogs for two sample Carrington rotations, numbers 540 (9 February–8 March
1894) and 850 (5 April–3 May 1917), which are near the maxima of solar Cy-
cles 13 and 15. There is a diﬀerence in the completeness of RGO and Zurich
sunspot observations. Out of 12 392 days in the period 1887–1920, RGO data
cover 9 736 days, while Zurich data cover only 6 710 days. The main reason is
that RGO beneﬁts from several observational locations around the world and is
therefore less aﬀected by, e.g., weather conditions.

In Figure 10 we show the distribution of distances from Zurich sunspots to
the nearest sunspot group in the RGO catalog and the distribution of distances
from sunspot groups in the RGO catalog to the nearest Zurich sunspot. Note
that we consider only those days, that are present in both the RGO and Zurich
databases. We ﬁnd that for 93% of the Zurich sunspots, there is at least one
RGO group in a radius of 10◦ (this radius is about half of longitudinal size of
the largest groups, see, e.g., Illarionov and Tlatov, 2022). Correspondingly, for
87% of RGO sunspot groups we ﬁnd at least one sunspot within 10◦ radius in
the Zurich catalogs. Note also that the Zurich-RGO distribution in Figure 10 is
shifted towards larger distances in comparison to the RGO-Zurich distribution.
This feature is rather expected because distances of sunspots in Zurich from the
nearest sunspot-group center in RGO will in general be larger than the distance
of a given sunspot-group center in RGO from the nearest sunspot in Zurich.

SOLA: main.tex; 23 May 2022; 0:38; p. 13

060120180240300360Carrington longitude40302010010203040LatitudeCarrington rotation 540ZurichRGO060120180240300360Carrington longitudeCarrington rotation 850ZurichRGOIllarionov & Arlt

Figure 10. Distribution of distances from Zurich sunspots to the nearest sunspot group in
the RGO catalog (blue bars) and the distribution of distances from sunspot groups in the RGO
catalog to the nearest sunspot in Zurich catalog (orange bars).

Figure 11. Upper panel: time-latitude distribution of faculae. Bottom panel: total number
of faculae (blue line) records in comparison with the total number of sunspot records in the
database (orange line).

4.2. Faculae and Prominences

We identiﬁed in total 413 098 faculae and 67 448 prominences for the period
1887–1920. Filtering out observations with the lowest conﬁdence below 0.4 yields
394 775 faculae and 62 203 prominences. Figures 11 and 12 show the correspond-
ing time-latitude distributions and comparisons with the total numbers of faculae
and prominences, respectively, as well as of sunspot records. The number of
faculae at high latitudes varies in an annually repeated pattern which is caused
by the varying visibility of the solar poles. Note how the southern abundance
peaks of faculae are shifted by about half a year against the peaks near the north
pole.

SOLA: main.tex; 23 May 2022; 0:38; p. 14

0123456789101112Distance, degrees0.00.10.20.30.40.5FrequencyZurich-RGORGO-ZurichSolar Physics Reconstruction of the solar activity

Figure 12. Same as Figure 11 but for prominences.

Note that recently Tlatova, Vasil’eva, and Tlatov (2020) presented time-
latitude diagrams of prominences digitized from Wolfer’s synoptic maps for
the period 1887–1898 and from the the solar disk observations in the CaII K-
line at the Kodaikanal Solar Observatory for the period 1910–1954. Our work
completes these results for the period 1899–1909. Similarly to Tlatova, Vasil’eva,
and Tlatov (2020), we also observe prominent polar drifts at high latitudes
and that the number of prominences correlates with the number of sunspots.
Rather surprisingly, the relative number of prominences and sunspots in the
Cycle 15 is signiﬁcantly lower than in the Cycles 13 and 14, for which we observe
almost equal numbers of prominences and sunspots. Finally, Figure 13 shows a
sample synoptic map for Carrington rotation 700 (22 January–18 February 1906)
taken near the maximum of Cycle 14 with sunspots, prominences and faculae
combined.

5. Discussion and Conclusions

We presented a neural-network model for the recognition of handwritten coordi-
nates of sunspots, prominences and faculae in catalogs of the Zurich Observatory
for the period 1887–1920. The problem turned out to be quite challenging and
required the elaboration of a unique approach. Usually, a neural network model
is ﬁrst trained on a large number of labeled examples and then applied with
frozen parameters to new data. At ﬁrst we followed this strategy and obtained an
accuracy above 97% on the test set of labeled data. When we applied the model to
the whole set of unlabeled data, we observed that there were certain handwriting
and page conditions where the model made many errors and gave low conﬁdence
even for correct answers (see Figure 5 for the example). This is rather expected
since due to the limited size of the training dataset we have to use models

SOLA: main.tex; 23 May 2022; 0:38; p. 15

Illarionov & Arlt

Figure 13. Sample synoptic map with sunspots (black dots), prominences (red strips) and
faculae (blue circles) overlaid.

with a moderate number of neurons, which in turn have a limited generalization
capability. We applied various data augmentations to synthetically extend the
dataset, but they can not totally substitute the need for a larger dataset. Of
course, it would be interesting for machine learning to develop a universal model
equally suitable for any catalog, page condition, and handwriting, probably, at
the cost of signiﬁcant extension of the manually labeled dataset, but it is out of
the scope of this research.

Instead, we developed the page-adaptive training approach. We used the
fact that for each particular date and time of observation there is a certain
relationship between the coordinates presented in the table. The baseline model
trained on a set of labeled samples was good enough to recognize a suﬃcient
number of coordinates that allow a reconstruction of these relationships on each
new page. Then we used the predictions in one column to compute targets for
the second column and vise versa. The obtained prediction-target pairs we used
to ﬁne-tune the model (i.e. we trained the model further on these pairs). After a
certain number of iterations, the model provided substantially better recognition
of the whole page in contrast to the baseline model. Repeating this procedure
for each new page, we obtained the adaptive model that quickly learned new
page conditions and handwritings.

In addition to the number recognition model, we proposed an approach to
conﬁdence estimation and generation of a ranked sequence of possible interpre-
tations of each decimal number. Using this approach we identiﬁed cases with
low conﬁdence and used additional heuristics to decide between several possible
interpretations. In general, low conﬁdence can be used as an indicator of possibly
incorrect results which require visual veriﬁcation.

Of course, the algorithm can not guarantee the absence of errors even for
results with unity conﬁdence. However, investigating particular cases we ﬁnd
that either the row contains another coordinate with low conﬁdence or there
is some systematics in such errors. Both suggest that at least some erroneous
records can be eliminated (or even corrected) by implementing some additional

SOLA: main.tex; 23 May 2022; 0:38; p. 16

060120180240300360Carrington longitude80604020020406080LatitudeCarrington rotation 700FaculaeProminencesSunspotsSolar Physics Reconstruction of the solar activity

heuristics. In this work, we excluded observations with conﬁdences below 0.4
from the analysis of physical properties.

To evaluate the results of coordinates reconstruction we provided the time-
latitude diagrams for sunspots, prominences and faculae. In particular, we ob-
served a similar pattern compared with the catalog of sunspot groups provided
by the Royal Greenwich Observatory. For a more detailed correlation with the
RGO catalog we associate the longitudes in that catalog with the longitudes
computed by the Zurich Observatory and obtained a distribution of heliocentric
distances between the records in the two catalogs. The scatter in locations is
compatible with the scatter of individual sunspots (Zurich) around the center
of a sunspot group (RGO). The observed similarity between the both catalogs
suggests both the stability of the recognition method and the coincidence in
the criteria of the observers of both observatories when determining the solar
structures. The latter conﬁrms the idea that the Zurich catalogs can complement
the RGO data.

We believe that the new database constructed from the observations of the
Zurich Observatory will contribute to the still fragmentary knowledge on solar
activity in the late 19th and early 20th centuries. We publish the database in the
public GitHub repository https://github.com/observethesun/zurich catalogs as
open-source. The repository is open for everyone to contribute corrections and
to report issues. For visual estimation of the recognition accuracy, we provide
catalogs with page-by-page comparisons of the original images and the numerical
tables (see the GitHub repository for the actual link). When using the helio-
graphic coordinates, one should be aware of the facts that (i) the longitudes are
in a frame with a sidereal rotation period of 25.2339 days, which is diﬀerent from
the Carrington rotation period of 25.38 days, and that (ii) the inclination of the
solar axis was assumed to be 7◦ upon transforming coordinates by the Zurich
assistants, while it should be more like 7.25◦.

Acknowledgments We greatly acknowledge the eﬀorts by e-manuscripta.ch, the digital
platform for manuscript material from Swiss libraries and archives. We are also grateful to the
group of students of MSU who helped with initial dataset annotation and model validation and
the referee for valuable comments. EI acknowledges the support of RSF grant 21-72-20067.

Data availability

The datasets generated during the current study are available in the GitHub
repository https://github.com/observethesun/zurich catalogs.

References

Arlt, R., Vaquero, J.M.: 2020, Historical sunspot records. Living Reviews in Solar Physics 17,

1. DOI. ADS.

Canny, J.: 1986, A Computational Approach to Edge Detection. IEEE Transactions on Pattern

Analysis and Machine Intelligence PAMI-8, 679. DOI.

Clette, F., Svalgaard, L., Vaquero, J.M., Cliver, E.W.: 2014, Revisiting the Sunspot Number.

A 400-Year Perspective on the Solar Cycle. Space Sci. Rev. 186, 35. DOI. ADS.

SOLA: main.tex; 23 May 2022; 0:38; p. 17

Illarionov & Arlt

Cliver, E.W.: 2017, Sunspot number recalibration: The 1840-1920 anomaly in the observer
normalization factors of the group sunspot number. Journal of Space Weather and Space
Climate 7, A12. DOI. ADS.

Curto, J.J., Sol´e, J.G., Genesc`a, M., Blanca, M.J., Vaquero, J.M.: 2016, Historical Heliophysical

Series of the Ebro Observatory. Solar Phys. 291, 2587. DOI. ADS.

Diercke, A., Arlt, R., Denker, C.: 2015, Digitization of sunspot drawings by Sp¨orer made in

1861-1894. Astronomische Nachrichten 336, 53. DOI. ADS.

Graves, A., Fern´andez, S., Gomez, F.: 2006, Connectionist temporal classiﬁcation: Labelling
unsegmented sequence data with recurrent neural networks. In: In Proceedings of the
International Conference on Machine Learning, ICML 2006, 369.

Illarionov, E., Tlatov, A.: 2022, Parametrization of Sunspot Groups Based on Machine-

Learning Approach. Solar Physics 297. DOI.

Lepshokov, D.K., Tlatov, A.G., Vasil’eva, V.V.: 2012, Reconstruction of sunspot characteristics

for 1853–1879. Geomagnetism and Aeronomy 52, 843. DOI.

Shi, B., Bai, X., Yao, C.: 2015, An End-to-End Trainable Neural Network for Image-based
Sequence Recognition and Its Application to Scene Text Recognition. arXiv e-prints,
arXiv:1507.05717. ADS.

Sp¨orer, G.: 1874, Beobachtungen der Sonnenﬂecken zu Anclam, Leipzig: Wilh. Engelmann.
Tlatova, K.A., Vasil’eva, V.V., Tlatov, A.G.: 2020, Drift of Polar Prominences in Solar Cycles

13-24. Geomagnetism and Aeronomy 59, 1022. DOI. ADS.

Watson, F., Fletcher, L.: 2011, Automated sunspot detection and the evolution of sunspot
magnetic ﬁelds during solar cycle 23. In: Prasad Choudhary, D., Strassmeier, K.G. (eds.)
Physics of Sun and Star Spots 273, 51. DOI. ADS.

Willis, D.M., Coﬀey, H.E., Henwood, R., Erwin, E.H., Hoyt, D.V., Wild, M.N., Denig, W.F.:
2013, The Greenwich Photo-heliographic Results (1874 - 1976): Summary of the Ob-
servations, Applications, Datasets, Deﬁnitions and Errors. Solar Phys. 288, 117. DOI.
ADS.

Wolf, R.: 1881, Astronomische Mittheilungen LIII. Astronomische Mitteilungen der Eid-

gen¨ossischen Sternwarte Zurich 6, 69. ADS.

Wolf, R.: 1887, Astronomische Mitteilungen LXX. Astronomische Mitteilungen der Eid-

gen¨ossischen Sternwarte Zurich 7, 369. ADS.

SOLA: main.tex; 23 May 2022; 0:38; p. 18

