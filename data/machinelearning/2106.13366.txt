MNRAS 000, 1â€“30 (2021)

Preprint 2 November 2021

Compiled using MNRAS LATEX style ï¬le v3.0

PHANGS-HST: New Methods for Star Cluster Identiï¬cation in
Nearby Galaxies

David A. Thilker,1â˜… Bradley C. Whitmore,2 Janice C. Lee,3,4 Sinan Deger,5
Rupali Chandar,6 Kirsten L. Larson,4 Stephen Hannon,4,7 Leonardo Ubeda,2
Daniel A. Dale,8 Simon C. O. Glover,9 Kathryn Grasha,10 Ralf S. Klessen,9,11
J. M. Diederik KruÄ³ssen,12 Erik Rosolowsky, 13 Andreas Schruba, 14
Richard L. White, 2 and Thomas G. Williams 15

1Department of Physics and Astronomy, The Johns Hopkins University, Baltimore, MD, USA
2Space Telescope Science Institute, 3700 San Martin Drive, Baltimore, MD, USA
3Gemini Observatory/NSFâ€™s NOIRLab, 950 N. Cherry Avenue, Tucson, AZ, USA
4Caltech/IPAC, California Institute of Technology, Pasadena, CA, USA
5TAPIR, California Institute of Technology, Pasadena, CA 91125
6Department of Physics and Astronomy, University of Toledo, Toledo, OH, USA
7Department of Physics and Astronomy, University of California, Riverside, CA, USA
8Department of Physics and Astronomy, University of Wyoming, Laramie, WY 82071, USA
9UniversitÃ¤t Heidelberg, Zentrum fÃ¼r Astronomie, Institut fÃ¼r Theoretische Astrophysik, Albert-Ueberle-Str 2, D-69120 Heidelberg, Germany
10Research School of Astronomy and Astrophysics, Australian National University, Canberra, ACT 2611, Australia
11UniversitÃ¤t Heidelberg, InterdisziplinÃ¤res Zentrum fÃ¼r Wissenschaftliches Rechnen, Im Neuenheimer Feld 205, D-69120 Heidelberg, Germany
12Astronomisches Rechen-Institut, Zentrum fÃ¼r Astronomie der UniversitÃ¤t Heidelberg, MÃ¶nchhofstraÃŸe 12-14, D-69120 Heidelberg, Germany
13Department of Physics, University of Alberta, Edmonton, AB T6G 2E1, Canada
14Max-Planck-Institut fÃ¼r extraterrestrische Physik, GiessenbachstraÃŸe 1, D-85748 Garching, Germany
15Max-Planck-Institut fÃ¼r Astronomie, KÃ¶nigstuhl 17, D-69117, Heidelberg, Germany

Last updated 2 November 2021

ABSTRACT
We present an innovative and widely applicable approach for the detection and classiï¬cation
of stellar clusters, developed for the PHANGS-HST Treasury Program, an ğ‘ğ‘ˆğ‘‰-to-ğ¼ band
imaging campaign of 38 spiral galaxies. Our pipeline ï¬rst generates a uniï¬ed master source
list for stars and candidate clusters, to enable a self-consistent inventory of all star formation
products. To distinguish cluster candidates from stars, we introduce the Multiple Concentration
Index (MCI) parameter, and measure inner and outer MCIs to probe morphology in more detail
than with a single, standard concentration index (CI). We improve upon cluster candidate
selection, jointly basing our criteria on expectations for MCI derived from synthetic cluster
populations and existing cluster catalogues, yielding model and semi-empirical selection
regions (respectively). Selection purity (conï¬rmed clusters versus candidates, assessed via
human-based classiï¬cation) is high (up to 70%) for moderately luminous sources in the
semi-empirical selection region, and somewhat lower overall (outside the region or fainter).
The number of candidates rises steeply with decreasing luminosity, but pipeline-integrated
Machine Learning (ML) classiï¬cation prevents this from being problematic. We quantify the
performance of our PHANGS-HST methods in comparison to LEGUS for a sample of four
galaxies in common to both surveys, ï¬nding overall agreement with 50â€“75% of human veriï¬ed
star clusters appearing in both catalogues, but also subtle diï¬€erences attributable to speciï¬c
choices adopted by each project. The PHANGS-HST ML-classiï¬ed Class 1 or 2 catalogues
reach âˆ¼ 1 magnitude fainter, âˆ¼ 2Ã— lower stellar mass, and are 2âˆ’5Ã— larger in number, than
attained in the human classiï¬ed samples.

Key words: galaxies: star clusters: general â€“ methods: data analysis â€“ surveys â€“ catalogues â€“
galaxies: individual NGC 628, NGC 1433, NGC 1566, NGC 3351

1
2
0
2

t
c
O
9
2

]

A
G
.
h
p
-
o
r
t
s
a
[

2
v
6
6
3
3
1
.
6
0
1
2
:
v
i
X
r
a

Â© 2021 The Authors
â˜… Contact e-mail: dthilker@jhu.edu

 
 
 
 
 
 
2

Thilker et al.

1

INTRODUCTION

Just as resolved stellar populations are routinely used to measure
the evolutionary history of a galaxy, revealing information other-
wise hidden in plain view, young star clusters yield unique insight
into the physical conditions supporting star formation. They are crit-
ically useful as â€˜clocksâ€™ that allow for estimating timescales within
the galactic ecosystem. The ensemble distribution of cluster mass
and age for a galaxy informs us regarding the processes that limit
unbridled star formation (e.g. feedback mechanisms in Krumholz
et al. 2019a) and those that encourage cluster dissolution (e.g. na-
tal gas expulsion, Baumgardt & Kroupa 2007; stellar dynamics,
Lamers et al. 2010; Reina-Campos et al. 2018) or more active dis-
ruption (e.g. due to tidal shocks, Gieles & Renaud 2016; Webb et al.
2019). In clusters that can be resolved into individual constituent
stars and thereby age dated precisely, our understanding of stellar
evolution was originally nurtured, and continues to be reï¬ned for
rare phases, binary stars, and models incorporating rotation. These
(and other) beneï¬cial aspects of star cluster science have encour-
aged the production of a â€˜legacyâ€™ of studies, both observational
(e.g., Whitmore et al. 1993; Whitmore & Schweizer 1995; Whit-
more et al. 1999; Larsen & Richtler 1999; Larsen 1999; Larsen &
Richtler 2000; Larsen & Brodie 2000; Larsen et al. 2001; Larsen
2002, 2004; Bastian et al. 2005a,b; Whitmore et al. 2007; Bastian
2008; Larsen 2009; Adamo et al. 2010; Chandar et al. 2010; Adamo
et al. 2011; Whitmore et al. 2011; Johnson et al. 2012; Adamo et al.
2015; Adamo & Bastian 2015; Johnson et al. 2015; Chandar et al.
2016; Adamo et al. 2017; Ryon et al. 2017; Johnson et al. 2017;
Grasha et al. 2017, 2018; Messa et al. 2018a,b; Grasha et al. 2019;
Hannon et al. 2019; Elmegreen et al. 2020; Whitmore et al. 2020;
Adamo et al. 2020a,b, plus innumerable studies in the Local Group,
Magellanic Clouds, and Milky Way) and theoretically focused (e.g.
Hunter et al. 2003; Bastian et al. 2005a; Lamers et al. 2005a,b;
Gieles et al. 2006; Larsen 2009; KruÄ³ssen et al. 2011; KruÄ³ssen
2012; Pfeï¬€er et al. 2019).

All of these works have led toward an emphasis on understand-
ing the complex, cyclic relation between the interstellar medium
(ISM) and star formation products. The goal is a thorough assess-
ment spanning the complete range of physical conditions and spa-
tiotemporal scales on which the process of star formation, and hence
galaxy evolution, operates. In the Galaxy, observers study compact
(very young) pre-stellar cores occupying giant molecular clouds
(GMCs), whereas in nearby extragalactic targets we are able to more
clearly delineate larger, progressively evolved, superstructures. Un-
fortunately, these two perspectives rarely overlap. Only recently,
this situation has begun to change (with a handful of exceptions,
e.g. Hamedani Golshan et al. 2021; Sewilo 2021; Shimonishi et al.
2021; Indebetouw et al. 2020, describing observations of molecular
cores in the Magellanic Clouds). Further aï¬eld, ALMA (Atacama
Large Millimeter Array) and ğ»ğ‘†ğ‘‡ (Hubble Space Telescope), re-
spectively, now allow us to image the high resolution (1(cid:48)(cid:48) â‰ˆ 50 pc at
10 Mpc) distribution of the molecular ISM at GMC scales across en-
tire galaxies and (in the same targets) allow us to inventory clusters
and luminous stars an order of magnitude in size smaller yet.

The PHANGS-HST1 survey (Lee et al. 2021) was designed to
capitalise on this opportunity in a large sample of galaxies. Speciï¬-
cally, we obtained ï¬ve-band near-ultraviolet through red imaging for
selected targets from the primary ALMA survey of nearby galaxies
(PHANGS2, Physics at High Angular resolution in Nearby Galax-

1 https://phangs.stsci.edu
2 https://www.phangs.org

ieS; Leroy et al. 2020) for which sensitive CO(2â€“1) maps were
available. About half of our ğ»ğ‘†ğ‘‡ targets are also being studied us-
ing integral ï¬eld spectroscopy at the VLT (Very Large Telescope)
with MUSE (Multi Unit Spectroscopic Explorer) in a companion
survey called PHANGS-MUSE (Emsellem et al. 2021).

We build upon the eï¬€ort and results of LEGUS (Legacy Ex-
traGalactic UV Survey, Calzetti et al. 2015) in a very direct manner,
through co-aligned scientiï¬c goals (with the invaluable addition
of ALMA data for PHANGS-HST targets), further development in
measurement and analysis techniques, and via use of the public
LEGUS catalogues for baseline testing of our new methodologies.
For instance, while we have adopted the cluster classiï¬cation sys-
tem of LEGUS (Class 1: Symmetric, single-peaked cluster; Class 2:
Asymmetric, single-peaked cluster; Class 3: Multi-peaked compact
association; see Adamo et al. 2017, new details in Whitmore et al.
2021), the current paper describes our evolved approach to clus-
ter detection and selection of likely candidates. We note that the
PHANGS-HST sample signiï¬cantly improves LEGUS coverage of
the star-forming galaxy main sequence at higher stellar mass and
SFRs (see Fig. 1 of Lee et al. 2021), but does not contain systems
classiï¬ed as a starburst or a dwarf starburst (that are well repre-
sented in LEGUS). PHANGS-HST galaxies are generally at larger
distances than the LEGUS sample.

Common extragalactic cluster detection methods (e.g. used by
the studies above) vary signiï¬cantly in terms of source identiï¬ca-
tion schemes, but the ï¬nal catalogues almost always rely on con-
centration index3 (CI)-based selection followed by conï¬rmation via
human inspection/classiï¬cation. This is necessary because galaxies
in the Local Volume and just beyond show both resolved individual
stars and clusters when observed with ğ»ğ‘†ğ‘‡, imparting signiï¬cant
confusion to the cluster identiï¬cation process. Unfortunately, anal-
ysis of resolved stellar populations and compact clusters generally
tend to be decoupled from the start, with one detection method used
for stars (e.g. PSF-ï¬tting photometry) and another independent pro-
cess for clusters (e.g. SExtractor, Bertin & Arnouts 1996). However,
this begets inconsistency in the eventual outcomes, and a degree of
double counting in the overall census of star formation activity. For
this reason it would be ideal if our PHANGS-HST pipeline were
able to identify them both using a uniï¬ed approach.

This paper describes such a process, dedicated to jointly recov-
ering clusters and individual stars with a single, versatile detection
method. Working on both populations at once does increase the
importance of accurately distinguishing clusters from stars, and ac-
cordingly we use more information (beyond a single CI value) from
our high-resolution imaging than is typical for cluster candidate se-
lection. Speciï¬cally, to better quantify the radial proï¬le of each de-
tected source, we introduce the concept of a Multiple Concentration
Index (MCI), averaging multiple, strategically re-normalised CI. We
then use a pair of independent MCI values, MCIin and MCIout, fo-
cused on inner and outer source morphology, respectively, to deï¬ne
an â€˜MCI planeâ€™. We ultimately base our cluster candidate selection
on cuts in these morphological metrics which have been informed
using extensive synthetic cluster observations and MCI values mea-
sured for previously conï¬rmed cluster catalogues. Besides guiding
selection, such synthetic clusters will soon also be used to quantify
completeness as a function of cluster properties (e.g. age, mass, plus

3 Deï¬ned here as the change in magnitude for a source when measured in
two concentric circular apertures of diï¬€erent radius, typically ğ‘Ÿ = 1 and 3
pixels.

MNRAS 000, 1â€“30 (2021)

critically also morphology and environment)4, and to gain insight
into the physical properties of cluster ensembles.

This paper is part of a series which documents the major com-
ponents of the overall PHANGS-HST data products pipeline. De-
tails are provided regarding: survey design and implementation (Lee
et al. 2021); aperture correction methods (Deger et al. 2021); source
detection, selection, and aperture photometry of compact star cluster
candidates (this work); star cluster candidate classiï¬cation (Whit-
more et al. 2021); neural network classiï¬cation proof-of-concept
demonstration (Wei et al. 2020); stellar association and hierarchical
structure determination, photometry, and determination of physical
properties (Larson et al. 2021); spectral energy distribution (SED)
ï¬tting with CIGALE (Turner et al. 2021); and distance determination
using PHANGS-HST parallel observations for Tip of the Red Giant
Branch (TRGB) analysis (Anand et al. 2021).

Section 2 provides details of source detection and photometry
in our uniï¬ed stellar and cluster context. Section 3 describes creation
of synthetic cluster models. In Section 4 the criteria for cluster can-
didate selection are given. A large portion of Section 4 is devoted to
introducing the MCI plane and describing how we employ synthetic
clusters and observed stars to guide selection in this multi-variate,
morphologically-sensitive context. Our classiï¬cation of cluster can-
didates, both via human inspection and Machine Learning (ML), is
described in Section 5. The familiar face-on disk galaxy NGC 628
(M 74) is used for illustration of our methods in Secs. 2â€“5. Section 6
provides a detailed description of our observational data and the re-
sultant cluster catalogues for a collection of four PHANGS-HST
galaxies and compares them to existing products from LEGUS. We
discuss the implications of our work and speciï¬c scientiï¬c beneï¬ts
of our method in Section 7. Finally, in Section 8 we end with a brief
summary, including possible future improvements.

2 SOURCE DETECTION AND PHOTOMETRY

The completeness and ï¬delity of any stellar cluster catalogue is
ultimately limited by its initial construction, speciï¬cally by the de-
tection of sources that may be candidate clusters. This Section ex-
plains our approach to this initial step, and describes the aperture
photometry performed on all detected sources.

Preferred extragalactic star cluster detection methods vary con-
siderably depending upon the physical spatial resolution of the
data. When clusters are resolved or partially-resolved into individ-
ual stars, well-known spatial clustering methods (e.g. friends-of-
friends, nearest-neighbours, Minimum Spanning Tree (MST) sep-
aration, DBSCAN, OPTICS; Battinelli 1991, Wilson 1991, Oey et al.
2004, Schmeja 2011, Sans Fuentes et al. 2017, Zari et al. 2019)
applied to point source (stellar) catalogues are typically preferred.
At somewhat lower resolution, when only a handful of individual
stars can be identiï¬ed in any given cluster but not enough to support
the use of clustering algorithms, a matched ï¬lter, cross-correlation
approach, with kernels tuned to emphasise extended, cluster-like
objects, are preferred (e.g. star cluster catalogues based on Source
Extractor (Bertin & Arnouts 1996) with ï¬ltering enabled and a
kernel having FWHM broader than the PSF (Forbes et al. 2014;
Lim & Lee 2015).) The PHANGS-HST data used here approaches
the limit of resolution where this latter method begins to be disfa-
vored. Indeed, the vast majority of clusters in our ğ»ğ‘†ğ‘‡ observations

Star Cluster Identiï¬cation in PHANGS-HST

3

appear quasi-point-like, and are easily detected with PSF-ï¬tting
photometry codes which were originally designed for resolved stel-
lar population work. Note that at the median 16 Mpc distance to a
PHANGS-HST galaxy, the 0.08(cid:48)(cid:48) PSF FWHM (2-pixel) resolution
of the WFC3/UVIS camera is âˆ¼ 6 pc. A typical cluster has an in-
trinsic eï¬€ective radius of ğ‘Ÿeï¬€ âˆ¼ 3 pc, which after convolution by the
PSF, yields a source with apparent FWHM âˆ¼
2Ã— broader than a
point source.

âˆš

2.1 Source detection using DOLPHOT

PHANGS-HST has adopted the DOLPHOT photometry package
(v2.0, Dolphin 2000) as the principal source detection code in
our pipeline. Speciï¬cally, we use the WFC3 and ACS modules, and
main distribution tarball downloaded5 on 4 Dec 2019. This choice
was motivated by a preference to have a single, uniï¬ed catalogue
for selection of both candidate clusters and stellar sources (which
are used to deï¬ne multi-scale associations; see Lee et al. 2021;
Larson et al. 2021). PSF-ï¬tting source detection also takes full ad-
vantage of our high-resolution ğ»ğ‘†ğ‘‡ imaging, de-blending closely
neighbouring sources in an optimal manner.

Source detection using DOLPHOT is governed by an extensive
set of parameters. A detailed list of the parameters used is given in
Appendix B (Table B1). Brieï¬‚y, we detect sources to the 3.5ğœ level
using simultaneous PSF-ï¬tting on the individual exposure (*ï¬‚c.ï¬ts)
images in all ï¬lters. The drizzled ğ¹555ğ‘Š (ğ‘‰) band image is used
as the positional reference for each target, meaning that exposure
level detections in ğ¹275ğ‘Š, ğ¹336ğ‘Š, ğ¹438ğ‘Š, ğ¹814ğ‘Š are joined
into a unique source list with sky positions based on the drizzled
ğ¹555ğ‘Š world coordinate solution (WCS). Each detected source
is photometered in all the bands, with non-detections ï¬‚agged. We
adopt the Tiny Tim PSF library (default within DOLPHOT) since
the DOLPHOT-speciï¬c implementation of Anderson PSFs (Ander-
son 2016, 2018) leads to systematic diï¬€erences across the ï¬eld
(A. Dolphin priv. comm.). DOLPHOT makes reï¬nements to the PSF
and implements aperture corrections based on a subset of well-
detected, isolated stars in each chip. Magnitudes are calibrated onto
the Vega system using STScI-supplied zeropoints in the image head-
ers. The photometric uncertainties reported by DOLPHOT tend to be
underestimated, as they do not account for the noise contributed by
neighbouring sources in crowded ï¬elds (see Williams et al. 2014,
where it is shown that artiï¬cial star testing can be used to constrain
the true uncertainties).

DOLPHOT is run using a set of python wrappers originally devel-
oped for the LEGUS project (by PHANGS-HST member L. Ubeda),
and later adapted for PHANGS-HST (by D. Thilker). These wrap-
pers organize the data prior to photometry, generate a complete
parameter ï¬le speciï¬c to the data set, and manage execution of the
DOLPHOT package codes.

We adopt the ğ‘‰-band DOLPHOT source list as our principal in-
ventory of astrophysical sources (clusters and stars) in each observed
target. Testing during pipeline development showed that occasional
high-conï¬dence clusters were not included in the DOLPHOT cata-
logue. In order to assess the degree to which DOLPHOT is eï¬€ective at
recovering clusters for our PHANGS-HST distance range, we match
the DOLPHOT catalogue against the LEGUS Class 1 and 2 cluster
population for NGC 628 (Adamo et al. 2017). We ï¬nd that âˆ¼ 98%
of LEGUS clusters have a DOLPHOT source within 2 pixels, and for

4 Detailed completeness analysis of this sort will be included in a forth-
coming publication.

5 http://americano.dolphinsim.com/dolphot/

MNRAS 000, 1â€“30 (2021)

4

Thilker et al.

âˆ¼ 80% the closest match is within 1 pixel. Given the methodolog-
ical diï¬€erence in detection algorithms (LEGUS used SExtractor;
PHANGS-HST uses DOLPHOT), it is unsurprising that small po-
sitional shifts in the source positions are encountered at this level.
Because clusters with large angular sizes can be missed by
DOLPHOT, we also run the DAOStarFinder code (in astropy/
photutils), which is better suited to detecting extended objects.
DAOStarFinder employs a convolution-based source identiï¬cation
method, whereas DOLPHOT requires explicit local maxima. We adopt
a DAOStarFinder kernel with a FWHM of 2.5 pixels (0.1(cid:48)(cid:48), e.g.
slightly broader than the PSF, so as to emphasise extended objects),
and only add distinct new sources, plus those where the summed
DOLPHOT catalogue ï¬‚ux within 2 pixels is > 2.5Ã— fainter than mea-
sured by DAOStarFinder. Typically only (cid:46) 1% of all eventual
candidate clusters originate from DAOStarFinder. The DOLPHOT
catalogue augmented by DAOStarFinder sources is referred to as
the PHANGS-HST â€œall-sourceâ€ detection list.

2.2 Aperture photometry using photutils
DOLPHOT is used only for source detection in our cluster pipeline6.
Once the all-source detection list (DOLPHOT+DAOStarFinder)
is ready, circular aperture photometry is performed using the
photutils python package.

Because most clusters appear round in ğ»ğ‘†ğ‘‡ images, we mea-
sure photometry in a series of circular apertures with radii of 1.0,
1.5, 2.0, 2.5, 3.0, 4.0, 5.0 pixels. The background level is mea-
sured in a circular annulus 7â€“8 pixels away from the centre of each
source, then subtracted oï¬€. This is a fairly standard background
annulus when working in crowded ï¬elds imaged with ğ»ğ‘†ğ‘‡ (e.g.,
Sabbi et al. 2018), and balances the need to measure the back-
ground level close to each source while being suï¬ƒciently distant
(â‰ˆ 14 âˆ’ 29 pc for typical galaxies in our sample) to minimise light
from the source itself within the background annulus. We estimate
the sky value as a robust median, using the sigma_clipped_stats
function to mitigate the inï¬‚uence of neighbours. The sigma-clipped
mean and standard deviation are also recorded by our pipeline, to
allow for investigation of inevitable systematic and random errors
in the adopted background. Calculations of the photometric uncer-
tainty follow the prescription of F. Masci7 with speciï¬c allowance
for spatially-correlated noise in the pixels of the source aperture and
sky annulus.

For sources selected as candidate star clusters (see Section 4),
the total magnitude in each ï¬lter is determined by measuring the
ï¬‚ux in a 4 pixel radius (â‰ˆ 12 pc at the median PHANGS-HST
galaxy distance) aperture, which captures âˆ¼50% of the total ï¬‚ux,
and then applying an aperture correction (e.g., Adamo et al. 2017;
Cook et al. 2019).

A detailed description of how PHANGS-HST aperture correc-
tions are determined is given in Deger et al. (2021). Brieï¬‚y, human
inspection-based selection of an aperture correction sample (con-
sisting of highly conï¬dent clusters, compact associations, and stars)
in each target enables measurement of the correction for compara-
tively isolated sources. One of us (Bradley C. Whitmore, hereafter
BCW) inspects the drizzled image products before our pipeline run
and manually identiï¬es 10 sources of each cluster Class (1, 2, 3).

6 The DOLPHOT PSF-ï¬tted magnitudes are used in a parallel pipeline devoted
to point sources.
7 Eq.
in
ApPhotUncert_corr.pdf

http://wise2.ipac.caltech.edu/staff/fmasci/

13

For each source, we compute aperture corrections to convert the
ğ‘Ÿ = 4 pixel (7âˆ’8 pixel background annulus) ğ‘‰-band photometry
to an estimated total (sky-subtracted at ğ‘Ÿ = 20âˆ’21 pixel) magni-
tude. Rather than letting the relative aperture correction between
bands ï¬‚oat on a galaxy-by-galaxy basis, which would add noise, we
normalise our average aperture corrections as oï¬€sets with respect
to the measured ğ¹555ğ‘Š aperture correction in each target. These
normalised corrections versus band are then combined into a mean
survey-wide aperture correction oï¬€set table, after outlier rejection.
For each galaxy we then adopt the ï¬nal aperture correction as the
galaxy-speciï¬c ğ¹555ğ‘Š value plus the survey-wide oï¬€sets for other
bands. The oï¬€sets are âˆ’0.19, âˆ’0.12, âˆ’0.03, 0.00, âˆ’0.12 mag in
ğ¹275ğ‘Š, ğ¹336ğ‘Š, ğ¹438ğ‘Š, ğ¹555ğ‘Š, and ğ¹814ğ‘Š, respectively. For
the galaxies processed at this time, the ğ¹555ğ‘Š aperture corrections
range from 0.6 to 0.85 mag.

We refer to the complete photometric database resulting from
these measurements as the â€™all-sourceâ€™ catalogue, to which morpho-
logical information (e.g. MCI) is later added (Sec. 4.2.1).

3 CREATION OF SYNTHETIC CLUSTER MODELS

The selection of candidate star clusters from a larger source cata-
logue that includes individual stars, chance super-positions, back-
ground galaxies, etc. is critical for the study of cluster populations
in nearby galaxies. Much of our new approach to cluster selection
(Sec. 4) uses morphological metrics determined from both synthetic
clusters and previously identiï¬ed (real) clusters. Synthetic clusters
also provide an estimate of the true photometric uncertainties and
any biases in the measurements. This Section describes a database
of synthetic cluster models which are used for these purposes, and
will be helpful for future studies.

3.1 Overview of the synthetic cluster database

Synthetic cluster sources are added to the ğ‘‰-band image for each
target galaxy, since these images are the ones used for source detec-
tion and cluster selection. The procedure is generalized suï¬ƒciently
that we can easily add artiï¬cial sources to any PHANGS-HST band,
although this is not currently implemented in the pipeline. However,
we envision future work along these lines for the purpose of ma-
chine learning cluster classiï¬cation training (e.g. Wei et al. 2020,
Whitmore et al. 2021).

Random positions which are uniformly distributed are gen-
erated for the synthetic clusters. We considered using positions
weighted to the observed source locations, but decided against it so
that this step can be run independently from the rest of the pipeline.
Note that if positionally-weighted properties are desired for the syn-
thetic clusters, these can be selected post-facto. The location of a
cluster inï¬‚uences detectability and photometric scatter/bias (with
objects in complex and/or high background regions of a galaxy be-
ing harder to identify and measure than those in uncrowded and/or
faint environments). Thus for future catalogue completeness anal-
ysis (beyond the scope of the current paper) we expect to impose
such post-facto positional weighting.

Our fundamental goal in this portion of the pipeline is to gen-
erate a database of synthetic sources which adequately covers the
plausible range of parameters expected for clusters in the PHANGS-
HST imaging. This implicitly means we need to sample the ageâ€“
mass plane, range of ğ´ğ‘‰ values and all plausible morphologies, and
add enough realisations of clusters with a given set of parameters to
fully represent the galactic environment and quantify the measured

MNRAS 000, 1â€“30 (2021)

scatter in morphological metrics. To the degree that the entire clus-
ter parameter space is represented in a targetâ€™s source population,
the locus traced by morphological metrics most frequently seen in
our synthetic database should resemble the observed distribution of
conï¬rmed clusters. Even so, we stress that our aim in the current
paper is not to forward-model predict the expected distribution of
metrics for a hypothetical cluster population, but rather to delineate
the bounds of the distribution containing objects of interest.

We assign physical characteristics (age, mass, ğ´ğ‘‰ , and mor-
phology) to each synthetic cluster, to enable completeness studies
(as a function of cluster type) and build a foundation for the forward-
modelling framework alluded to above. We permit ages log(ğ‘¡) = [6.0,
6.5, 7.0, 7.5, 8.0, 8.5, 9.0] yr and extinction values of ğ´ğ‘‰ = [0.0, 0.25,
0.5] mag (in addition to Milky Way foreground), plus a wide range
of Moï¬€at proï¬les which sample intrinsic size and radial shape; see
Sec. 3.2 for details. The chosen limits of our model parameter space
cover the vast majority of clusters found in nearby galaxies, with
the particular exception of the very youngest, still embedded pop-
ulation. These particularly elusive, dust-enshrouded clusters (e.g.
Lada & Lada 2003) will be one focus of our approved JWST pro-
gram (GO-2107) targeting half of our PHANGS-HST sample. Their
expected numbers are uncertain and highly dependent on environ-
ment (Romita et al. 2016). For each combination of age, ğ´ğ‘‰ , and
morphology, we generate 1000 cluster realisations from a ï¬‚at mass
distribution between 103 to 105 ğ‘€(cid:12), sampling every 102 ğ‘€(cid:12). Fixed
step sizes in age, mass, ğ´ğ‘‰ are used for convenience. If we eventu-
ally further explore forward-modelling applications (as mentioned
above), we would then likely switch to randomized sampling to
eliminate any possibility of unwanted biases. Population synthesis
models within CIGALE (Boquien et al. 2019) are used to predict the
ğ‘‰-band magnitude for each synthetic cluster, based on its assigned
age, mass, and ğ´ğ‘‰ . In this way, we establish consistency between
our synthetic clusters and the SED-ï¬tting (Turner et al. 2021) of the
PHANGS-HST pipeline. In total, we inserted some 4.5+ million
synthetic clusters in each PHANGS-HST target, 200 objects at a
time, simulating diverse cluster morphologies accounting for the
PSF and incorporating Poisson noise on a pixel-by-pixel basis as
described in Sec. 3.2 and 3.3. The same procedure used to determine
photometry of real sources is applied to the synthetic ones.

3.2 Moï¬€at model

We adopt Moï¬€at proï¬les to represent our synthetic clusters, since
these give a particularly good ï¬t to the measured proï¬les of young
clusters. This choice is well-supported by observational studies (e.g.
Elson et al. 1987; Larsen 1999; McLaughlin & van der Marel 2005),
although there are other reasonable options like King models (King
1962, 1966). To reduce computational burden, our Moï¬€at models
are circularly symmetric, though in future work we may include
asymmetric synthetic cluster models as they would be a superior
representation of Class 2 clusters found observationally. Our model
based selection (Sec. 4.2.2) is â€˜looseâ€™ enough that we do not expect
to be biasing against Class 2 objects in the present work. However,
if we later attempt forward-modelling of the cluster population, this
complexity should be included.

The Moï¬€at surface brightness proï¬le is given by:

ğœ‡(ğ‘Ÿ) = ğœ‡0

(cid:16)1 + ğ‘Ÿ2/ğ‘2(cid:17)âˆ’ğœ‚

,

where ğœ‡0 is the central surface brightness, ğ‘ is a characteristic
radius, and ğœ‚ is the power-law exponent of the proï¬le wings. Note
that ğœ‚ is equal to ğ›¾/2 in equation (1) of Elson et al. (1987). As

MNRAS 000, 1â€“30 (2021)

Star Cluster Identiï¬cation in PHANGS-HST

5

ğœ‚ approaches inï¬nity the Moï¬€at proï¬le becomes a Gaussian. The
characteristic radius can be expressed as a function of full-width-
half-max (FWHM) and ğœ‚:
(cid:16)21/ğœ‚ âˆ’ 1(cid:17)âˆ’1/2

ğ‘ =

.

FWHM
2

Studies of clusters in nearby galaxies typically measure the
eï¬€ective radius ğ‘Ÿeï¬€, which is deï¬ned to be the radius of a circle
containing half the integrated light of the model. For a Moï¬€at
proï¬le, ğ‘Ÿeï¬€ is given by:

ğ‘Ÿeï¬€ = ğ‘

(cid:16)

(1/2)

1

1âˆ’ğœ‚ âˆ’ 1(cid:17)1/2

,

which is only valid for ğœ‚ > 1.0. Although the eï¬€ective radius
is undeï¬ned for ğœ‚ (cid:54) 1.0, and the integral of the proï¬le inï¬nite,
the Moï¬€at parameterisation can still be evaluated (and matching
cluster morphologies observed) for this regime. In the real-world
case it simply means that the cluster proï¬le is truncated or lost to
the background at some large radius.

The parameter space of circular Moï¬€at clusters spans core size
(via ğ‘ or FWHM) and halo power-law slope (via ğœ‚). We adopted 8
values of ğœ‚ (= 0.75, 0.875, 1.0, 1.25, 1.5, 2.0, 3.0, 4.0) and pre-PSF-
convolution FWHM ranging from 0.5 to 7.0 pix, with step sizes
of 0.25 pix. In total, taking all permutations across this parameter
space, we allow for 216 (8Ã—27) distinct cluster morphologies. Mod-
els with high ğœ‚ values (e.g. 3, 4) have minimal halo structure, and are
dominated by their progressively Gaussian core. Conversely, low ğœ‚
values correspond to very â€˜ï¬‚uï¬€yâ€™ cluster morphologies. Guiding the
choice of minimum cluster core FWHM for our models, paramet-
ric ï¬tting studies of marginally resolved stellar clusters have shown
that reliable structural parameters can be obtained for eï¬€ective radii
approaching down to 10âˆ’20% of the PSF FWHM, dependent on
signal-to-noise and cluster morphology (e.g. Larsen 1999; Ryon
et al. 2017; Brown & Gnedin 2021). We expect to have a mor-
phological limit of ğ‘Ÿeï¬€ âˆ¼ 1 pc at 16 Mpc (median PHANGS-HST
distance, Anand et al. (2021)) with WFC3/UVIS.

3.3 Model realisation

Regardless of our particular choice for parameterising the structure
of model clusters, we require a method to generate and realisti-
cally insert them into the observations in a way that mirrors the
observational strategy (e.g. multiple exposures, dithering) and in-
strumental characteristics (e.g. resolution, noise). It is particularly
important that the intrinsic cluster proï¬le be convolved with the PSF.
The assumed PSF is adopted from the empirically determined PSF
products of J. Anderson, using a PSF representation appropriate to
the centre of the WFC3/UVIS camera ï¬eld of view8 9. This choice
allows the synthetic cluster database to be generated in advance of
cluster detection/selection pipeline runs.10

Although it was developed to study galaxy morphology via
parametric model ï¬tting, IMFIT (Erwin 2015) is well suited for
our purpose of generating PSF-convolved models, especially as the
package includes Moï¬€at model capabilities. It is adopted for the
initial steps of our cluster model realisation process (the stages of
generating the intrinsic structure and convolving with the PSF),

8 https://www.stsci.edu/~jayander/STDPSFs/
9 https://www.stsci.edu/hst/instrumentation/wfc3/
data-analysis/psf
10 In later versions of our cluster catalogue we may adopt the PSF deter-
mined by DOLPHOT instead of generic representations.

6

Thilker et al.

Figure 1. Flowchart summarising the PHANGS-HST source detection, photometry, cluster candidate selection, and classiï¬cation process.

then a custom python script is used to do the remaining tasks,
including adding noise, reprojecting exposure-level models to the
drizzled grid, coadding, and ï¬nally adding the synthetic clusters to
the PHANGS-HST images.

Images of real clusters may or may not be centred at the centre
of a pixel. To account for this eï¬€ect, which can become important
for compact clusters, for each â€˜batchâ€™ of clusters that is inserted
into an image, we adopt one of ï¬ve diï¬€erent centres oï¬€set from the
pixel centre by (0.0, 0.0), (0.25, 0.25), (0.5, 0.5), (0.25, 0.0), and
(0.5, 0.0), to allow the centres to range from the centre to a pixel
edge. Provided our step size is suï¬ƒciently ï¬ne, these oï¬€sets are
suï¬ƒcient to represent any actual cluster centre, as all other oï¬€set
choices are equivalent via reï¬‚ection and rotation.

For each batch of 200 synthetic clusters, of ï¬xed age, ğ´ğ‘‰ ,
FWHM, ğœ‚, and subpixel location, we use IMFIT to generate a noise-
free Moï¬€at model using factor of 4 oversampling. The Anderson

PSF appropriate to the ï¬lter and camera of the synthetic run (in our
case ğ‘Š ğ¹ğ¶3/ğ‘ˆğ‘‰ ğ¼ğ‘†/ğ¹555ğ‘Š almost always) is convolved with the
model to produce a noise-free template synthetic cluster (still over-
sampled by a factor of 4) for each of our dither positions (generally
three). Next we use these to generate native-scale (0.03962(cid:48)(cid:48)/pix)
models (again one per dither position / ğ»ğ‘†ğ‘‡ exposure) which were
subsequently scaled to the integrated intensity corresponding to
the adopted mass [magnitude, see beginning of this Section], inde-
pendently per cluster. At this point we compute a Poisson variate
for every signiï¬cant pixel in the penultimate ï¬‚c-exposure-level-
appropriate model realisations, in a manner that accounted for the
local area speciï¬cally around each cluster position as recorded in
the unmodiï¬ed image. Finally, we co-add the noisy models (per
cluster) and add the result to the drizzled ğ‘‰-band image.

MNRAS 000, 1â€“30 (2021)

4 CLUSTER CANDIDATE SELECTION CRITERIA

4.2 Morphology criteria: Multiple Concentration Index

Star Cluster Identiï¬cation in PHANGS-HST

7

Our cluster candidate selection method was developed with the goal
of maximising completeness and minimising contamination. Our
criteria include cuts on: (1) data-quality and photometric measures
(Sec. 4.1, e.g. number of bands with acceptable photometric error,
ğ‘‰-band S/N, absolute ğ‘‰-band magnitude, and crowding) and (2)
novel morphological metrics, MCIin, MCIout (Sec. 4.2), as guided
by synthetic cluster modelling (Sec. 4.2.2) and published cluster
catalogues (Sec. 4.2.3). We also impose selection rules to: (3) guar-
antee candidate inclusion of sources too luminous to be ordinary
stars (Sec. 4.3), and (4) to eliminate double counting associated
with instances of overly aggressive source deblending (Sec. 4.4).

In Fig. 1, we present an overview of the cluster identiï¬ca-
tion pipeline, beginning with the source detection and photometry
phases already described in Sec. 2, continuing to the subsequent
cluster candidate selection phase which is the topic here, and ending
with the classiï¬cation phase that yields our ï¬nal cluster catalogue.
We position this ï¬gure prior to describing details of selection, so
that it is easier for the reader to obtain an understanding of the over-
all method and speciï¬cally how the pieces ï¬t together. We direct the
reader to a fully comprehensive ï¬‚ow chart for the entire PHANGS-
HST survey (thus also including multi-scale asssociations) in Fig. 5
of Lee et al. (2021). Our Fig. 1 represents a more detailed view at the
data ï¬‚ow and logical path required for the cluster-speciï¬c aspects
of the overall project.

4.1 General candidate selection criteria

We begin with the set of sources detected by DOLPHOT, and im-
pose a limit of S/N (cid:62) 5 and crowding (cid:54) 0.667 mag (rationale
on this in Sec. 4.4) for a source to enter cluster candidate process-
ing. DAOStarFinder then adds in a very limited number of objects
missed by DOLPHOT, meeting the conditions for augmentation de-
scribed at the end of Section 2.1. Imposition of the DOLPHOT
S/N (cid:62) 5 cut (even though our cluster candidate sample selection
later demands S/N (cid:62) 10) excludes potentially unreliable compact
sources from the determination of whether a given DAOStarFinder
detection should be added to the all-source detection list, or if it was
already preferentially well split into two or more DOLPHOT de-
tections of reasonable quality. Next, aperture photometry and MCI
computation is conducted for each source. From the resulting com-
bined â€œall-source catalogueâ€ (= bright+uncrowded DOLPHOT plus
DAOStarFinder), we cull out poorly measured sources by requir-
ing detections in (cid:62) 3 bands with photometric error (cid:54) 0.3 mag. We
further require that V is one of these bands. These general criteria
reduce the all-source catalogue to only âˆ¼ 4âˆ’9% of its initial entries.
As described below, we further down-select this subset by consid-
ering two populations: (1) typical sources which meet a full set of
morphological criteria (see Sec. 4.2) and (2) those that are so bright
they are surely clusters or artefacts (brighter than the Humphreysâ€“
Davidson (H-D) limit, Humphreys & Davidson 1979), for which we
impose a more lenient set of criteria (see Sec. 4.3).

DOLPHOTâ€™s goodness of (PSF-)ï¬t metric (ğœ’2) and sharpness
parameter are both limited to the inner portion of sources ((cid:54) 3
pixels for ğœ’2, and the central pixel alone for sharpness), which is
not ideal for selecting sources broader than the PSF. For this reason
we do not use these quantities for candidate cluster selection.

MNRAS 000, 1â€“30 (2021)

(MCI)

One of the primary aims of our study is to improve on the cluster
selection methodology used in previous studies, which has mostly
relied on a single concentration index (CI, e.g. Holtzman et al. 1992;
Whitmore et al. 1993; Adamo et al. 2017; Cook et al. 2019). High-
resolution ğ»ğ‘†ğ‘‡ images of clusters in galaxies at distances between
âˆ¼ 5âˆ’25 Mpc allow for constructing maximally-informative (though
still azimuthmally-averaged) constraints on cluster morphology, en-
abling more robust discrimination of point-like or cluster-like ap-
pearance than has been done to date.

We compute Multiple Concentration Index (MCI) metrics to
probe radial proï¬le shape over a wide range of distance from a
source. These metrics allow us to compare the shape to that of a
ï¬ducial cluster morphology (via the speciï¬c choice of normalisa-
tion constants). In the subsections below, we formally deï¬ne the
MCIin and MCIout parameters used in our cluster candidate selec-
tion method, give examples of how cluster morphology varies with
location in the MCI plane, and provide motivation for the area(s) of
the MCI plane in which candidates are selected.

4.2.1 Deï¬nitions and examples

Our MCI metrics are based on the concentration index concept
(which by itself is a reformulation of curve-of-growth analysis),
although we take advantage of many independent measures of CI
(each based on a diï¬€erent pair of radii), rather than a single CI mea-
sure. To simplify the interpretation, we re-normalise the CI with
respect to a ï¬ducial cluster (of ï¬xed angular size), so that the nor-
malised CI (NCI) indicates whether the source surface brightness
proï¬le is steeper or ï¬‚atter than the ï¬ducial one at the measured
radii. Speciï¬cally, for radii ğ‘– and ğ‘— we deï¬ne:

NCI(ğ‘–, ğ‘—) = 1 âˆ’

CI(ğ‘–, ğ‘—)
CI(ğ‘–, ğ‘—)ï¬ducial

We adopt a mildly extended cluster morphology as our ï¬ducial
cluster model, with pre-PSF-convolution FWHM of 2 pixels and ğœ‚ =
3. The choice is arbitrary, as a diï¬€erent morphology for the ï¬ducial
cluster would lead to systematically diï¬€erent extent and scatter in
the resulting observed NCI (eventually MCI) distribution, but these
changes would also correspondingly change the MCI distribution
of our entire synthetic cluster database (used below to deï¬ne the
selection region) and the observed source distribution against which
it is compared. It is important to note that the sense of compactness
used here is reversed when compared with the traditional measure
of CI (1 pixel to 3 pixel), with higher NCI values indicating a more
concentrated (star-like) object.

In order to allow readers to use our methods without generating
synthetic ï¬ducial clusters, in Table 1 we provide representative nor-
malisation constants required to compute NCI values from observed
concentration indices. In practice within our pipeline, we compute
constants speciï¬cally for each galaxy (observed ï¬eld) using 21,000
ï¬ducial morphology clusters fully sampling all permutations of age,
mass, ğ´ğ‘‰ from the synthetic cluster database described in Sec. 3.
The constants diï¬€er very little amongst galaxies, except for those tar-
gets with data (in ğ‘‰-band) from ACS/WFC rather than WFC3/UVIS.
Because the NCI values are normalised, we can combine mul-
tiple NCI values into a summary metric to reduce the â€˜noiseâ€™ in the
measured proï¬les, and thereby mitigate the impact that an image
artefact or nearby object could have on any single NCI measure.

8

Thilker et al.

Figure 2. The inter-relation between cluster appearance, proï¬le shape, curve of growth, NCI values, MCI, and ultimately position of diï¬€erent characteristic
morphologies in the MCI plane. Line and marker colours in each panel are linked to the colour of the box outlying each synthetic cluster image shown. In
order to obtain MCIin and MCIout for any source, (top left panel) we ï¬rst measure curve of growth photometry and then convert these measurements to CI
values. (bottom left) We re-normalise the CI values with respect to the adopted ï¬ducial cluster to obtain NCI and subsequently average NCI values for adjacent
positions within the radial proï¬le to obtain MCI metrics. (right) The MCI plane position for a source is thereby linked to how locally steep or shallow the
proï¬le appears with respect to the ï¬ducial morphology. See the text for a complete description. Synthetic clusters used for this ï¬gure only are idealized in the
sense that they are noise-free and were not inserted into our ğ» ğ‘†ğ‘‡ images. Note that the images of model clusters are scaled from zero to their maximum value,
so as to enable relative morphological comparison.

Table 1. Representative normalisation constants for transforming CI to NCI

We deï¬ne the Multiple Concentration Index (MCI), for radius pairs
(ğ‘, ğ‘), (ğ‘, ğ‘), (ğ‘, ğ‘‘), as:

Quantity

ğ‘–
(pix)

ğ‘—
(pix)

CI(ğ‘–, ğ‘—)ï¬ducial value

CI(1.0, 1.5)
CI(1.5, 2.0)
CI(2.0, 2.5)
CI(2.5, 3.0)
CI(3.0, 4.0)
CI(4.0, 5.0)

1.0
1.5
2.0
2.5
3.0
4.0

1.5
2.0
2.5
3.0
4.0
5.0

0.746
0.447
0.288
0.186
0.201
0.0858

Note: Listed values (CI(ğ‘–, ğ‘—)ï¬ducial) are concentration indices appropri-
ate for the ï¬ducial cluster morphology (pre-PSF-convolution FWHM of
2 pixels and ğœ‚ = 3). ğ‘– and ğ‘— are the aperture radii for the small and large
(respectively) circular apertures used for each CI. We insert 21,000 real-
isations of the ï¬ducial cluster spanning our synthetic parameter space of
age, mass, ğ´ğ‘‰ into all galaxies of our sample and then take the median
of the measured CI values to produce this table. For reference, the stan-
dard CI(1.0,3.0) typically used by previous studies has a value of 1.67
for the ï¬ducial cluster morphology.

MCI = [NCI(ğ‘, ğ‘), NCI(ğ‘, ğ‘), NCI(ğ‘, ğ‘‘)] ,

where the overline notation indicates averaging.

In Section 2.2, we described our circular aperture photometry
employing a series of aperture radii (in particular, 1.0, 1.5, 2.0, 2.5,
3.0, 4.0, 5.0 pixels). We use these measurements to construct two
independent MCI metrics, MCIin and MCIout. For MCIin we take
radii 1.0, 1.5, 2.0, 2.5 as ğ‘, ğ‘, ğ‘, ğ‘‘ in the expression above. MCIout is
based on photometry with aperture radii of 2.5, 3.0, 4.0, 5.0 pixels.
As such, MCIin probes the inner portion of a source (out to ğ‘Ÿ â‰ˆ 0.1(cid:48)(cid:48)
or 1 resolution element for ğ»ğ‘†ğ‘‡), dominated by the cluster core at
the distances of our target galaxies, whereas MCIout traces the faint
outer, low surface brightness structure of a source.

The plots in Fig. 2 illustrate how steep the local radial proï¬le of
a source is compared to the ï¬ducial cluster model, based on the MCI
metrics. Our aperture photometry is ï¬rst used to create curves of
cumulative ï¬‚ux versus aperture radius (interior to the sky annulus),
as shown by the dashed curves in the upper left panel. Synthetic
models for ï¬ve clusters are compared, including the ï¬ducial model

MNRAS 000, 1â€“30 (2021)

(green), two with pre-PSF-convolution FWHM 1 pix (blue with
ğœ‚ = 4, purple with ğœ‚ = 0.75), and two with FWHM of 4 pix (red
with ğœ‚ = 4, yellow with ğœ‚ = 0.75). Images of these cluster realisa-
tions are shown in the right panel. The blue boxed model is barely
resolved, and is the closest to a point source, but nevertheless can be
distinguished as a cluster given suï¬ƒcient signal-to-noise. For this
demonstration no Poisson noise was incorporated, and the images
have been scaled linearly from 0.0 to their respective maximum val-
ues. In the upper left panel, we further show the photometry after
conversion into a series of CI values (again as a function of radius)
as the solid lines. The â€˜bumpâ€™ at ğ‘Ÿ = 3.5 pix is due to the ï¬rst
aperture radii pair with separation of 1.0 pix rather than 0.5 pix, as
used near the centre. In the lower left panel, the CI are ï¬rst nor-
malised against the ï¬ducial cluster, introducing the sense of local
slope with respect to this mildly extended source. Positive values
of NCI (MCI also) indicate progressively steeper proï¬les, whereas
negative NCI values happen whenever the source proï¬le is shallow
compared to the ï¬ducial. To obtain MCIin and MCIout we average
the three adjacent NCI values (each) as speciï¬ed above. MCI in the
lower left plot is marked only for the radial range probed by each
of the inner and outer metrics. In the right panel, we show the MCI
plane, marking the position of each model in this morphologically
indicative space. Note the ï¬ducial (green) is at (0, 0), by deï¬nition.
The position of a cluster in the MCI plane is largely dependent on
the size of the source, here represented by the pre-PSF-convolution
FWHM. Large sources are in the lower left and small in the upper
right. However, the assumed halo slope in the outer portion of a
cluster can have a signiï¬cant inï¬‚uence on the MCI plane position
for ï¬xed FWHM, most signiï¬cantly for intrinsically small sources
in which the halo is able to skew the MCIout and MCIin values.
Note the large shift in MCIin and MCIout for the purple cluster in
comparison to the blue one (with a steep, i.e. insigniï¬cant, halo). By
the time a source is quite extended even in its core, changes in halo
slope only induce shifts in MCIout (see red versus yellow cluster).
The illustration of Fig. 2 is idealised. In real observed clusters,
in addition to the inï¬‚uence of noise, both source crowding and a
variable diï¬€use environment can perturb the MCI measurements
away from expectations for a cluster of given intrinsic morphology.
As our circular aperture photometry does not (yet) include masking
of neighbour sources, or a sloped sky estimate, we account for this
by inserting our synthetic clusters of varied size and morphology â€“
not just the ï¬ducial chosen for MCI normalization â€“ in the actual
ğ»ğ‘†ğ‘‡ ğ‘‰-band images of each sample galaxy. The outcome of such
analysis is discussed in detail in Sec. 4.2.2, but we ï¬rst conclude
the introduction to MCI with a discussion of the typical source
distribution in the observed MCI plane.

In the left panel of Fig. 3 we show the distribution of measured
MCIin versus MCIout values for all sources with S/N (cid:62) 10 in our
NGC 628-C ï¬eld (see Sec. 6 for a description of these data). We
also identify the expected location of point-like sources (towards
the upper right) and extended sources in this plane. Note the largely
bimodal distribution, with a strong density of points with positive
MCI values (corresponding to stars) and a broad distribution of
points dominating the remainder of the plot (including, but not lim-
ited to, clusters). Within this broader distribution, a ridge extending
diagonally down and to the left from the location of point-sources is
often evident. Note the distribution of scattered sources around the
ridge of extended points. This scatter is found in all of our ï¬elds,
and is due to contaminants, such as close pairs of stars, diï¬€rac-
tion spike artefacts, and local maxima in diï¬€use regions. The right
panel in Figure 3 shows the same data as in the left panel, but now
colour-coded by the traditional measure of CI, which has a range

MNRAS 000, 1â€“30 (2021)

Star Cluster Identiï¬cation in PHANGS-HST

9

of âˆ¼ 1.2 (dark blue) to 2.3 (reddish-brown) in our ğ»ğ‘†ğ‘‡ images.
The LEGUS project typically used a value of CI = 1.3 to separate
cluster candidates (> 1.3) from stars (CI (cid:54) 1.3). In our plot, this
CI cut corresponds to the dark blue colour. We show the images of
four hand-selected clusters from NGC 628 in the right hand panel
of Fig. 3 and mark their position with star symbols, to illustrate
the systematic change in cluster morphology as a function of MCI
plane position.

The set of sources plotted in Fig. 3 is intended to be limited
to those for which MCIin and MCIout can be well-measured (e.g.
(cid:54) 10% error). This is generally achieved for sources with ğ‘‰-band
S/N (cid:62) 10, so we opted to display those data points in this ï¬gure.
Nevertheless, for our morphology-based cluster candidate selection
we further impose limits on MCI statistical error (MCIin,err (cid:54) 0.3,
MCIout,err (cid:54) 1.0) alongside the S/N (cid:62) 10 cut.11 12

4.2.2 MCI selection: guidance from synthetic clusters

In this Section, we investigate the location of realistic, synthetic
clusters in the MCI plane. This is done in order to guide our selec-
tion of actual cluster candidates using the MCI metrics. In Fig. 4
we show the measured values of MCIin and MCIout for thousands
of realisations of diï¬€erent Moï¬€at parameter permutations, span-
ning a range of FWHM and power-law halo slope. The set of plot-
ted synthetic clusters has been conï¬ned to the magnitude range
of ğ‘š(ğ‘‰) = 22 âˆ’ 24, in order to probe the faint end range of clus-
ter magnitudes (thus the most typical population) in PHANGS-HST
galaxies. The MCI plane position depends systematically on FWHM
and ğœ‚, while scatter, for a constant distribution of masses, increases
signiï¬cantly for decreasing values of ğœ‚ (ï¬‚atter halo slopes) at ï¬xed
FWHM and less so for increasing FWHM at ï¬xed ğœ‚. For relatively
steep halo slopes (ğœ‚ (cid:62) 1.5), the scatter in this magnitude range
is acceptably small to distinguish between cluster morphologies.
However, it is clear (in the right hand panel) that for shallow slopes
and large core size clusters the MCI plane scatter eventually renders
the metrics less useful. This is due to two reasons: (1) for this set
of synthetic clusters the surface brightness above the background
becomes very low, and (2) the range of cluster-centric radii probed
by MCIin and MCIout fails to sample an informative portion of the
radial surface proï¬le. In brighter magnitude ranges, such shallow
slopes and large core size clusters do become well characterised
in the MCI plane. This observation suggested to us that the set of
synthetic clusters used to inform cluster candidate selection criteria
should be pared down from the complete grid that was originally
computed.

Speciï¬cally, we sought to delineate those regions in the MCI
plane in which clusters could: (1) plausibly exist and (2) likely be
detected by our observations. This knowledge would then most ef-
fectively guide our selection of cluster candidates. We emphasise
that a realistic prediction of the cluster population (linked to ex-
pectations for the mass function, age distribution and sizeâ€“mass
relationship), subsequently used to establish selection regions in

11 These MCI error and S/N (cid:62) 10 cuts do not apply to the super H-D
sources described in Sec. 4.3.
12 We note that MCI error and signal-to-noise are highly correlated. In
future works we may consider only using a limit on S/N rather than in
combination with limits on MCIin and MCIout error. As it turns out, our
present MCI error limits tend to preclude potential candidates even before
S/N = 10 is reached. When assessing whether to make a change in our
selection criteria, we will also need to consider that MCI error can be
inï¬‚ated at ï¬xed cluster magnitude due to a crowded, complex environment.

10

Thilker et al.

Figure 3. (Left) The MCI plane distribution of detections in our all-source catalogue for the NGC 628-C ï¬eld with ğ‘‰ -band S/N (cid:62) 10. The distribution reï¬‚ects
the population of stars, clusters, and contaminants. Stars are largely separated to the upper right, but the contribution of clusters is not as tightly deï¬ned. (Right)
The same plot on the left except coloured by CI. Cutout images of actual NGC 628-C clusters linked to their MCI plane location (with star symbols) have been
overlaid on the right panel. As opposed to Fig. 2, here the actual clusters are all displayed as observed, not rescaled according to their maxima (such as was
done for the synthetic clusters in the previous plot).

the MCI plane, is a disfavored method because this would create a
selection bias tending to produce an observed sample in agreement
with our prior notions.

We use what we call â€œhit maps,â€ generated at a series of binning
resolutions (0.01, 0.02, 0.04, in both MCIin and MCIout), to iden-
tify the MCI plane regions in which to accept cluster candidates.
Displayed in Fig. 5, these hit maps are essentially histograms of
the number of model clusters in the entire synthetic object database
meeting existence and detection criteria, which are then processed
to produce region boundaries at each MCI plane resolution. During
processing these histograms ï¬rst become a binary mask â€“ we de-
mand at least 9 models per bin to register as a hit (mask value of
1 rather than 0) at the associated bin position. This guards against
noisy boundaries, since Poisson event counting makes such bins sig-
niï¬cant at the 3ğœ level. Such bins are saturated light grey in the plots
of Fig. 5. To further mitigate noise, we then erode and dilate the
hit map before contouring to obtain the bin-resolution-dependent
model cluster region boundaries. This process is completed sepa-
rately for each target, using the speciï¬cs of the observations.

The existence and detection criteria13 are: (ğ‘Ÿeï¬€ (cid:54) 10 pc) &
(Î  (cid:62) 3 | log(age) (cid:54) 7) & (average background-subtracted surface
brightness inside a radius of 2.5 pixels exceeding 0.04 eâˆ’/sec).
The ï¬rst two criteria ensure we only sample physically plausible
clusters. In the expression, â€œboundednessâ€ (in a statistical sense, not
necessarily for a speciï¬c object) is deï¬ned with the Î  ratio (= age
/ crossing time, see Gieles & Portegies Zwart 2011 where crossing
time is estimated by assuming virial equilibrium) . We take along
cluster models of all ages, though for ages greater than 10 Myr we

13 Our formulation of the criteria is written using logical operators &
(â€˜ANDâ€™) and | (â€˜ORâ€™). When interpreting the expression, please be aware of
this notation.

require additionally that Î  (cid:62) 3 (in order to keep synthetic clusters
in this post-natal age range which have an appearance/structure and
age suggesting they are likely bound). For models younger than 10
Myr we make no such cut, since in this regime it is more diï¬ƒcult
to distinguish bound from unbound objects without high-resolution
spectroscopic observations. The last criterion we check (minimum
allowed surface brightness) is based on inspection of the distribution
of this same quantity in all LEGUS cluster catalogues, and meeting
this cut suggests detectability in our imaging since the data from
both surveys are comparable in depth.

The end result of the steps we just described is a set of â€˜model
cluster regionsâ€™ in the MCI plane, generated speciï¬cally for each
target/observation and at three incrementally decreasing resolutions.
The decreasing resolutions (increasing bin size) create nested model
cluster regions (blue and magenta curves in Fig. 5), each of which
adds a peripheral MCI zone of lower likelihood for viable cluster de-
tections (though to zeroth order only, as we generate them intention-
ally neglecting prior knowledge about typical cluster populations).
Though not illustrated here, since we show only the NGC 628 central
ï¬eld (NGC 628-C), these regions vary systematically with distance
to the target. We return to this issue in Sec. 4.2.3, while discussing
semi-empirically determined selection regions.

Of key importance, we clarify that the model cluster regions
were generated using synthetic clusters that approach a point-like
appearance (minimum allowed pre-PSF-convolution FWHM of 0.5
pixel), and due to measurement error / environmental confusion,
they contain the portion of the MCI plane in which point-sources
dominate. We allow such models to establish realistic expectations
for which comparatively small clusters remain adequately distin-
guishable from stars. However, it also means that we must take
measures to exclude stars from our selection. We initially exper-
imented with IMFIT-generated point source models inserted into
the drizzled mosaic and generating model star regions, analogous

MNRAS 000, 1â€“30 (2021)

Star Cluster Identiï¬cation in PHANGS-HST

11

Figure 4. Bag plots illustrating the location of synthetic clusters in the MCI plane as a function of pre-PSF-convolution FWHM and halo slope (ğœ‚). From left
to right, panels show models with ğœ‚ = 4.0, 2.0, 1.0. In each panel, the transparent points are coloured according to FWHM, ranging from FWHM = 1, 3, 5, 7
pixels (purple, blue, green, orange). This ï¬gure only shows synthetic clusters with ğ‘š(ğ‘‰ ) = 22âˆ’24. The inner polygon drawn for each (FWHM, ğœ‚) combination
is the â€˜bagâ€™ containing âˆ¼ 50% of the clusters, whereas the outer dashed â€˜loopâ€™ indicates the region beyond which only outlier clusters are found. To the degree
that bag plots are the bivariate equivalent of box plots, outliers can be thought to have coordinates more than 1.5Ã— the inter-quartile range outside of the
25th-to-75th percentile zone. For a univariate normal distribution, this corresponds to the âˆ¼ 2.7ğœ level. The black dots mark the centre of each distribution.

Figure 5. Hit maps computed for synthetic clusters in NGC 628-C, binned at diï¬€erent resolutions 0.01, 0.02, 0.04, and used for the determination of model
cluster regions (curves) in the MCI plane for this particular target. Saturated light grey indicates a position registering a â€˜hitâ€™ (at least 9 synthetic clusters that
are both expected to exist and be detectable) for the plotted binning size. In each panel the model cluster region linked to the current binning resolution is
drawn with a dashed magenta curve, whereas the regions at other resolutions are shown with the solid blue curves for comparison. See the text for existence
and detection criteria assumed.

to our methods for the synthetic Moï¬€at clusters. However, it was
found that slight diï¬€erences in the actual PSF versus the Anderson
PSF, combined with a overly simplistic parameterised form for the
magnitude distribution of inserted point sources, sometimes led to
slight mismatch between the clear stellar peak in the observed MCI
plane and model star regions.

Therefore, we adopt a simpler, yet more empirical method,
for deï¬ning what we call a â€˜stellar exclusion regionâ€™. From the
DOLPHOT catalogue of each target, we cull a set of actual, high
signiï¬cance stars (DOLPHOT S/N (cid:62) 40, sharpness consistent with a
point source, and ğœ’2 less than a tunable limit based on inspection)
and use this set to generate a KDE-smoothed distribution of stars in
the MCI plane. Our ï¬nal adopted stellar exclusion region is deï¬ned
by a contour at 50% of the peak in this distribution. We generate
this product for each galaxy individually. In some cases, we need
to increase the degree of KDE smoothing due to low numbers of
qualiï¬ed point sources, or in extreme cases substitute a camera/

band-speciï¬c â€˜aggregateâ€™ stellar exclusion region for the galaxy-
tuned determination. This latter product is generated from the union
of qualiï¬ed point sources in all targets. An example of the aggregate
product for WFC3/UVIS datasets is shown in Fig. 6 (red curve). The
stellar exclusion region shifts substantially for ACS/WFC versus
WFC3/UVIS, due to camera-related diï¬€erences in eï¬€ective PSF.
The galaxy-speciï¬c stellar exclusion regions will be published in
our entire-sample cluster catalogue release paper, but the ACS/WFC-
based region for NGC 628-C is plotted later in the current paper (as
part of Figs. 9, 10, and 11).

The stellar exclusion region successfully removes the majority
of stars, with limited inevitable exceptions due to low S/N or confu-
sion. Conversely, the stellar exclusion region is expected to remove
only a very small percentage of detectable clusters given the typi-
cal mass (âˆ¼ 104 M(cid:12)) of sources recovered in our survey, coupled
with the cluster mass-radius relation (e.g. Krumholz et al. 2019a
with supporting data on Milky Way and M31 clusters from Johnson

MNRAS 000, 1â€“30 (2021)

12

Thilker et al.

Figure 6. Aggregate stellar exclusion region (red curve) generated for
WFC3/UVIS and ğ¹ 555ğ‘Š . Note that this plot is more zoomed in than other
depictions of the MCI plane, to show detail. The background histogram
shows a histogram of the qualiï¬ed (see text) point-like sources aggregated
over all PHANGS-HST targets in this instrumental conï¬guration processed
to date. The polygonal shape is the upper right portion of the semi-empirical
selection region (Sec. 4.2.3), which is drawn for reference. Although not
shown here, the equivalent plot for ACS/WFC (and ğ¹ 555ğ‘Š ) indicates that
point sources occupy a peak at signiï¬cantly lower MCIin (âˆ¼ 0.21, c.f. Fig. 3
left panel and Figs. 9-11) but comparable MCIout, owing to the lower reso-
lution of the ACS/WFC PSF compared to WFC3/UVIS. Note that we could
have specially modiï¬ed the MCI (NCI) normalisation constants used for
ACS/WFC to eliminate such oï¬€set of point sources but chose not to do
so, since only three of 38 PHANGS-HST targets (NGC 628, NGC 1300,
NGC 3621) rely on archival (ACS/WFC) ğ‘‰ -band data for cluster candi-
date detection/selection, and because our selection/exclusion regions already
compensate by construction.

et al. 2012; Fouesneau et al. 2014; Kharchenko et al. 2013). At a
mass of 104 M(cid:12) a representative cluster eï¬€ective radius is âˆ¼ 3 pc
(âˆ¼ 1 pixel at 15 Mpc), following the observed relation presented in
Krumholz et al. (2019a), and implying that such a cluster would have
MCI values well outside the stellar exclusion region. Of course, the
typical cluster mass we use to support this argument is likely itself
modiï¬ed by selection. Forthcoming cluster completeness testing as
a function of mass, age, and morphology will quantitatively account
for candidate loss due to the stellar exclusion region, as well as other
cuts of our selection method.

To summarise our MCI-based, synthetic cluster guided selec-
tion pathway: for the subset of sources fainter than the H-D limit
(Humphreys & Davidson 1979), we select as a cluster candidate any
object meeting the general conditions outlined at the start of Sec. 4,
having ğ‘‰-band S/N (cid:62) 10 and MCIin,err (cid:54) 0.3 plus MCIout,err
(cid:54) 1.0, and falling within one of the model cluster regions (Fig. 5)
but outside the empirically-deï¬ned stellar exclusion region (Fig. 6).
After adding possible objects brighter than the H-D limit (Sec. 4.3),
this set of candidates is known as our â€˜ML sampleâ€™ (machine learn-
ing). Additional illustration of galaxy-speciï¬c MCI plane selection

model cluster regions and stellar exclusion regions is included in
the PHANGS-HST survey paper (Lee et al. 2021).

4.2.3 MCI selection: semi-empirical selection region

The synthetic model cluster regions presented above provide an
optimally tuned selection of cluster candidates, speciï¬c to a given
galaxy in terms of its internal structure/confusion-level, distance,
and also the quality of the observation. However, the construction/
use of such regions requires substantially detailed analysis of syn-
thetic clusters (Sec. 3) and high-signiï¬cance stars in the ï¬eld of
interest. General users of our MCI-based method may not wish to
do this. For this reason, and also to quickly generate a standardised
candidate set of manageable size for human classiï¬cation, we de-
signed a polygonal â€˜semi-empirical selection regionâ€™ (for cluster
candidates) in the MCI plane. To exclude stars from this selection, in
the case of general users, we suggest adopting the aggregate stellar
exclusion region of Fig. 6 (though not used by our pipeline, except
when stars are too rare), or more simply a lower limit on allowed
traditional CI for candidate clusters (âˆ¼ 1.3 âˆ’ 1.4) determined by the
user for their own particular dataset. Stellar exclusion is barely even
indicated for WFC3/UVIS data sets but is very much necessary for
ACS/WFC data sets.

In order to decide on the form of the polygon adopted, we
jointly used information from actual clusters and synthetic mod-
els, with actual clusters in our analysis coming from the ï¬rst few
PHANGS-HST galaxies studied (e.g. NGC 1559, Wei et al. (2020);
NGC 3351, Turner et al. (2021); NGC 4548). At this early stage
of our ğ»ğ‘†ğ‘‡ program, sources were inspected over a wide swath of
the MCI plane (essentially spanning the entire distribution). Then,
the distribution of human veriï¬ed clusters in combination with the
(tightest) model cluster region evaluated for several targets span-
ning the distance range of our sample was used to semi-empirically
deï¬ne the edges of the adopted polygon. In Fig. 7 the left hand panel
shows the veriï¬ed clusters of NGC 1559 together with representa-
tive model cluster regions, illustrating how such guidance was used
to motivate the semi-empirical selection region. The adopted poly-
gon is shown in various ways in Figs. 6â€“11. Some slack is allowed in
the upper right hand corner of the semi-empirical selection region,
in order to allow the smallest recoverable WFC3/UVIS detected
clusters to the maximum degree allowed by our stellar exclusion
regions. We elected to shave oï¬€ some from a simple quadrilateral
in the lower right portion of the selection region, aiming to reduce
contamination mildly. The top edge is ï¬xed at MCIout = 0.6.

As a validation check (and possible tertiary inï¬‚uence) on the
semi-empirical selection region, we examined the MCI plane dis-
tribution of LEGUS Class 1 and 2 clusters, and Class 3 compact
associations. The right hand panel of Fig. 7 shows this data set.
Note the tightly conï¬ned locus of Class 1 clusters, with the Class 2
clusters scattering to somewhat more negative (extended) MCIout
at ï¬xed MCIin. Compact associations are even more scattered. If
we ignore Class 3, which are being treated in a more robust manner
by the PHANGS-HST pipeline (see the multi-scale associations of
Larson et al. 2021), this ï¬gure makes it clear that our semi-empirical
selection region captures the vast majority of compact clusters.

Because the MCI (and NCI) are normalised to a ï¬ducial cluster
of ï¬xed angular size, we expected distance-dependent variations in
the MCI plane distribution. This is illustrated in Fig. 8. We adopt a
variable lower limit on the bottom edge of the semi-empirical selec-
tion region. Speciï¬cally, the region is cropped at MCIout = âˆ’1.7 for
galaxies with ğ‘‘ (cid:54) 8 Mpc, at MCIout = âˆ’1.1 for 8 < ğ‘‘ < 14 Mpc,
and at MCIout âˆ’ 0.7 for ğ‘‘ (cid:62) 14 Mpc. Future PHANGS-HST pa-

MNRAS 000, 1â€“30 (2021)

Star Cluster Identiï¬cation in PHANGS-HST

13

Figure 7. Development of the semi-empirical selection region in the MCI plane. (left) The distribution of clusters in early PHANGS-HST target NGC 1559
(at a distance of 18 Mpc) in comparison to high-resolution model selection regions computed from synthetic clusters (18 Mpc, purple, near the median
PHANGS-HST distance; 4.4 Mpc, violet, more suitable for LEGUS galaxies and nearby PHANGS-HST target NGC 4826). Based on this guidance we deï¬ne
the semi-empirical selection region (black polygon), shown here without distance-based cropping at the bottom edge. Symbol colour and size diï¬€erentiate
cluster type (Class 1 and 2) and classiï¬cation method (human and ML) as indicated in the legend. (right) The MCI plane and the semi-empirical selection
region, showing all publicly released LEGUS cluster candidates aggregated across 34 galaxies (light blue, and human classiï¬ed: grey), with Class 1 clusters
marked in dark blue, Class 2 in green, and Class 3 (compact associations) in yellow.

Table 2. Vertices of the semi-empirical selection region

MCIin MCIout

0.050
0.300
0.110
-0.200
-0.525
0.050

0.600
0.600
-0.700
-2.000
-2.000
0.600

Note: The bottom edge used to crop the semi-empirical selection region
on a galaxy-by-galaxy basis depends on the distance to the target (e.g.
Fig. 8), in the sense of the selection region shrinking at the high MCIout
end with increased distance. Speciï¬c recommendations are given in the
text.

pers dealing with cluster catalogues may use a revised ladder of
semi-empirical selection region edges, but our goal for the present
work was to be conservative, especially in the case of targets for
which signiï¬cant distance uncertainty persists. Note that for targets
considerably closer than 8 Mpc, such as many of the LEGUS galax-
ies, a limit of MCIout = âˆ’2 is appropriate since several LEGUS
conï¬rmed Class 2 clusters and even a few Class 1 clusters appear
in this regime as can be seen in the right panel of Fig. 7. The model
region plotted for PHANGS-HST target NGC 4826 (at 4.4 Mpc) in
the left panel of Fig. 7 also supports this conclusion.

To enable readers to utilise our MCI-based selection method
without running synthetic cluster models of their own, we provide
the vertices of the semi-empirical selection region in Table 2 before
adjusting the bottom edge according to galaxy distance.

Recall that in addition to providing for a simple cut in the MCI

MNRAS 000, 1â€“30 (2021)

Figure 8. The semi-empirical selection region (thick polygon), with variable
lower limits in MCIout (thin dashed lines). We show LEGUS conï¬rmed
Class 1 or 2 clusters as points colour coded according to the distance range
which they occupy. Note the typical agreement between the observed lower
end of the cluster distribution with the progressively lowered MCIout semi-
empirical selection region limit, where the âˆ’1.7 limit is for ğ‘‘ (cid:54) 8 Mpc,
âˆ’1.1 for 8 < ğ‘‘ < 14 Mpc, âˆ’0.7 for ğ‘‘ (cid:62) 14 Mpc.

Â¡0:6Â¡0:4Â¡0:200:20:4MCIinÂ¡3:0Â¡2:5Â¡2:0Â¡1:5Â¡1:0Â¡0:500:51:0MCIoutHumanC1HumanC2MLC1MLC218Mpc4:4MpcSelectionSemiÂ¡empiricalselection:NGC1559andmodelsÂ¡0:6Â¡0:4Â¡0:200:20:4MCIinÂ¡3:0Â¡2:5Â¡2:0Â¡1:5Â¡1:0Â¡0:500:51:0MCIoutAllCand:ClassiÂ¯edClass1Class2Class3LEGUSgalaxiesÂ¡0:6Â¡0:4Â¡0:200:20:4MCIinÂ¡3:0Â¡2:5Â¡2:0Â¡1:5Â¡1:0Â¡0:500:51:0MCIoutClassiÂ¯edd<5Mpc5Â·d<88Â·d<14dÂ¸14LEGUSClass1or214

Thilker et al.

plane that would work without running synthetic cluster models,
the basic motivation for the semi-empirical selection region was to
generate a smaller subset of the overall candidate list to be consid-
ered for human classiï¬cation. Because our semi-empirical selection
region (after distance-based cropping) is generally comparable or
smaller in area to the highest resolution model cluster region (0.01
bin size), we expect the purity of the selection (â‰¡ # of true clus-
ters / # cluster candidates) to be similarly elevated in this subset,
though potentially at the cost of missing cluster candidates of un-
usually large size or in complex/crowded regions that perturb MCI
measurements away from the nominal locus.

Summarising our semi-empirical selection pathway, we select
as a candidate in this â€˜human classiï¬cation sampleâ€™ any source
(meeting the general criteria outlined at the start of Sec. 4, i.e.
having ğ‘‰-band S/N (cid:62) 10, and being inside the semi-empirical
selection region but outside the stellar exclusion region deï¬ned
earlier), or brighter than the H-D limit (Sec. 4.3). We reiterate
though that two selection pathways are implemented, and that a
broader sample of candidates based on model cluster expectations
alone is ultimately passed to ML classiï¬cation. In Fig. 9, we indicate
for one target (NGC 628-C) the human subset (cyan) of the entire
candidate cluster set (grey). Both the semi-empirical and model
cluster selection regions are plotted, along with the stellar exclusion
region, so they can be compared. Here one can see the ACS/WFC-
speciï¬c need to exclude stars from the semi-empirical selection
region, not signiï¬cant for WFC3/UVIS data sets (see Fig 6).

As a ï¬nal double check that our method works as expected, we
compared the selection areas for each galaxy in our paperâ€™s sample
to the MCI plane distribution of LEGUS clusters in that same target.
Figure 10 shows such a plot for NGC 628-C, and conï¬rms that only
a handful of clusters conï¬rmed by LEGUS lie outside our semi-
empirical selection region, and only two are missed by our model
cluster regions (others may possibly fail general conditions of S/N,
# of low error bands, etc.).

Lastly, in Fig. 11 we compare the MCI plane distribution of our
synthetic cluster models for NGC 628-C to standard CI. This ï¬gure
is similar to the plot in the right panel of Fig. 3, except that here
we show models rather than detected sources. We also indicate the
model cluster regions, stellar exclusion region, and semi-empirical
selection region so their connection to the traditional CI metric can
be ascertained.

4.3 Bright object criteria: super H-D cluster candidates

As noted in Sec. 4.1, we treat the brightest sources in our augmented
DOLPHOT+DAOStarFinder catalogue slightly diï¬€erently than the
vast majority of (fainter) possible cluster candidates. The luminos-
ity distribution for stars is strongly limited at the bright end. The
Humphreysâ€“Davidson limit (Humphreys & Davidson 1979, a.k.a.
H-D limit) eï¬€ectively delineates a demarcation in the Hertzsprungâ€“
Russell diagram above which stars can only brieï¬‚y exist, in an
unstable state. This limit can be cast into an equivalent boundary
in the (ğ‘‰âˆ’ğ¼, ğ¼) CMD. There is colour-dependence, but for our pur-
poses we adopt ğ‘€ğ‘‰ = âˆ’10 as the H-D limit. Clusters exist both
fainter and brighter than this magnitude, but given the rarity of stars
brighter than the H-D limit, it is reasonable to assume that nearly all
sources brighter than the H-D limit are clusters. For this reason, we
accept as a cluster candidate any source surviving the cuts outlined
as general criteria in Sec. 4.1 and having ğ‘€ğ‘‰ (cid:54) âˆ’10 if it also meets
the very lax condition of having âˆ’0.55 (cid:54) MCIin (cid:54) 0.45 (since
they can sometimes be [nearly-]saturated or have close neighbours
within 5 pixels, leading to corrupted MCI values). We call these

Figure 9. PHANGS-HST NGC 628-C cluster candidates (grey) and the
subset of semi-empirical region selected (cyan) or super H-D sources (red).
Solid blue curves are our model cluster regions for 0.01, 0.02, and 0.04 bin
sizes. The dashed black polygon marks the semi-empirical selection region
(for this distance), whereas the solid red curve is the stellar exclusion region.
Note that the stellar exclusion region intrudes signiï¬cantly into the selection
area, only due to this target being observed with ACS/WFC. The majority
of the super H-D sources fall along the locus of highest cluster candidate
density (within both the semi-empirical selection region and the 0.01 bin
size model cluster region) and conï¬rmed by inspection to be luminous
clusters. The galaxy nucleus is the super H-D source near MCIout = -0.3.
We have inspected the super H-D sources outside the model cluster region,
ï¬nding all but two to be artefacts associated with bright foreground stars.
The two super H-D sources in the far bottom left corner of the ï¬gure are
oï¬€-centre detections of the galaxy nucleus. Two super H-D sources fall
within the stellar exclusion region. According to the Gaia GR2 distances of
Bailer-Jones et al. (2018), they are both foreground stars within 2 kpc of the
Sun.

objects â€˜super H-D candidatesâ€™. They are marked as red symbols
in Fig. 9. In practice, super H-D candidates are a mix of luminous
clusters and artefacts. See the caption of Fig. 9 for more information,
but note that contaminating foreground stars (being misinterpreted
at the distance of the target galaxy) can also sometimes make it into
this subset, and are later discarded to the best of our ability during
classiï¬cation. Objects of this sort should appear within or near the
stellar exclusion region, however genuine luminous clusters having
intrinsically compact morphology (e.g. Smith et al. 2020) would
also manifest as super H-D objects found in the exclusion region
â€“ particularly for the more distant galaxies in the PHANGS-HST
sample.

Point-like super H-D cluster candidates present a particular
challenge during classiï¬cation. We can utilize Gaia Bayesian dis-
tance estimates (Bailer-Jones et al. 2018) to weed out foreground
stars, but such parallax-based ancillary information is not always
conclusive since the method depends on sky location with respect
to the Galactic model and because parallax uncertainty is exces-
sive for some super H-D sources (e.g. our assumed H-D limit of
ğ‘€ğ‘‰ = âˆ’10 implies ğ‘šğ‘‰ = 20 for a galaxy at 10 Mpc). The appear-

MNRAS 000, 1â€“30 (2021)

Â¡0:6Â¡0:4Â¡0:200:20:4MCIinÂ¡3:0Â¡2:5Â¡2:0Â¡1:5Â¡1:0Â¡0:500:51:0MCIoutAllCand:HumanSampleSuperHÂ¡DPHANGSÂ¡HST;NGC628Â¡CStar Cluster Identiï¬cation in PHANGS-HST

15

Figure 10. This plot, for NGC 628-C only, shows LEGUS candidates (light
blue, and human classiï¬ed: grey) and LEGUS human conï¬rmed clusters
(of Class 1, 2 â€“ blue, green, respectively). Solid blue curves are our model
cluster regions for 0.01, 0.02, and 0.04 bin sizes. The dashed black line marks
the semi-empirical selection region (for this distance) and the red curve is
the stellar exclusion region for NGC 628-C. Note that the stellar exclusion
region for NGC 628-C intrudes signiï¬cantly into the selection area, only due
to this target being observed with ACS/WFC. For WFC3/UVIS targets, the
stellar exclusion region is generally adjacent to, or only slightly overlapping,
the semi-empirical selection region.

ance of an Airy ring or sharp diï¬€raction spikes can also help to
weed out foreground stars. When neither Gaia nor PSF-wing source
morphology helps, we rely on contextual hints from where in the
galaxy image a point-like super H-D source is found. For instance,
if it lies in a complex of active star formation or in a comparatively
luminous region, and the angular surface density of other point-like
super H-D sources nearby in the celestial sphere is low enough that
chance projection on such areas is unlikely, then we generally ac-
cept the cluster candidate as being a bona ï¬de cluster. A dedicated,
follow-up study of super-HD clusters will explore this issue in more
detail. Finally, one might wonder how complete our catalogues are
for super H-D clusters. Whitmore et al. (2021) looks at this issue for
NGC 628, concluding that our catalogues approach 90% complete-
ness in this bright regime, despite the complexities of presented by
point-like super H-D candidates.

4.4 Eliminating duplicate and/or redundant cluster

candidates

As it is originally intended to be a point-source ï¬nding and PSF-
ï¬tting photometry routine, DOLPHOT sometimes chooses to repre-
sent an extended source as two or more very closely spaced point
sources, rather than passing through only one dominant compo-
nent. Although well motivated for resolved stellar photometry of
crowded ï¬elds, and good for close pairs of stellar sources (as in
the context of our PHANGS-HST individual star photometry and
association analysis), this is a drawback in our case of cluster detec-

MNRAS 000, 1â€“30 (2021)

Figure 11. The set of synthetic clusters computed for ACS/WFC observations
of NGC 628-C which could (1) plausibly exist and (2) likely be detected
by our observation, colour-coded by CI. We have overplotted all selection/
exclusion regions, with a lower limit appropriate to the distance of NGC 628
in the case of the semi-empirical selection region.

tion. We included a general condition on DOLPHOT crowding in our
candidate selection to mitigate this situation from the start of our
cluster-speciï¬c work. See Sec. 4.1 for speciï¬c implementation, but
we only allow DOLPHOT sources with crowding (cid:54) 0.667 mag. This
crowding cut eliminates a majority of cases of duplicative detec-
tion, but at the very end of our cluster candidate selection we also
explicitly impose a â€˜doubles radiusâ€™ cut. After the preliminary can-
didate list is established, we sort candidates by count rate and work
through the list in order of decreasing count rate, disqualifying any
fainter DOLPHOT artefact (= â€˜duplicateâ€™) neighbouring candidate(s)
at separations (cid:54) 2.5 pixels (hence quasi-unresolved by ğ»ğ‘†ğ‘‡). We
cannot make the doubles radius any larger without starting to lose
bona ï¬de double objects (not artefacts) of which the fainter source
could conceivably be a cluster.

DOLPHOT deblending artefacts that do squeak through this cut
are later eliminated by human inspection, or, in the speciï¬c case
of machine learning classiï¬ed populations, via a secondary prox-
imity cut to remove redundant links to the same physical object.
The additional need for this secondary cut is best illustrated by
Class 3 sources, which are operationally deï¬ned as groups of 4 or
more point-like sources within 5 pixels radius (further discussion
in Whitmore et al. 2021). Our detection code will generally return
each point source in such groupings as a candidate, and subse-
quently most of these candidates (except perhaps those on the edge
of a group) will be conï¬rmed as Class 3 objects by machine learn-
ing. Even so, there is only one actual grouping. Therefore, after ML
classiï¬cation is completed (Sec. 5.2), we sort Class 3 by decreasing
count rate and eliminate â€˜redundantâ€™ objects within a rejection ra-
dius of 5 pixels. Interactive inspection of the results showed that the
method works as expected, keeping the brightest peak within each
Class 3 grouping. The same operation is conducted for Class 1+2
classiï¬ed candidates jointly â€“ as a purely conservative step at this

Â¡0:6Â¡0:4Â¡0:200:20:4MCIinÂ¡3:0Â¡2:5Â¡2:0Â¡1:5Â¡1:0Â¡0:500:51:0MCIoutAllCand:ClassiÂ¯edClass1Class2LEGUSNGC628Â¡C;Class1or216

Thilker et al.

time â€“ even though any pair of true clusters at separations < 5
pixels would lose its fainter member. We expect to re-evaluate the
Class 1+2 redundancy cut as the PHANGS-HST analysis progresses
further. We do wish to clarify that Class 3 and Class 1+2 objects
are not allowed to eliminate cross-class. That is, a Class 1 or 2 clus-
ter can be allowed within the 2.5âˆ’5.0 pixel range from a Class 3
compact association.

4.5 Summary of cluster candidate selection

The simplest distillation of our cluster candidate selection method
is to say that we evaluate each entry in our all-source catalogue
(Sec. 2.1), ï¬rst requiring that photometric and morphological qual-
ity assurance conditions are met (Sec. 4.1), then allow high quality
sources to qualify as clusters either owing to their position in the
MCI plane (Secs. 4.2.2 for the maximally inclusive, model-guided
ML sample and 4.2.3 for the smaller, semi-empirically selected hu-
man sample), or because they are more luminous than the H-D limit
(Sec. 4.3, included in both samples). Final checks to prevent any
double counting are also implemented as just described. To aid the
reader in understanding this complex selection method, we refer
them again to the overview ï¬‚owchart at the start of this Section
(Fig. 1). The path in the ï¬‚owchart from source detection to science-
ready cluster catalogues ends with cluster candidate classiï¬cation,
which is the topic of the following Section.

5 CLUSTER CANDIDATE CLASSIFICATION

We adopted the cluster classiï¬cation system introduced by LEGUS,
accomplishing the task through a mix of human inspection (Whit-
more et al. 2021) and deep transfer learning (Wei et al. 2020).
Integrated over the four galaxies included in this paper, approxi-
mately 18% (4246) of the nearly 24,000 candidate clusters were
classiï¬ed by a human for our study (recall these four galaxies also
have independent catalogues from LEGUS). These classiï¬cations
act as a reference allowing us to judge the performance of our ML
method and improve it in the future (Whitmore et al. 2021).

5.1 Human, inspection-based classiï¬cation

Via interactive inspection of the ğ‘‰-band (ğ¹555ğ‘Š) image and also
a colour composite made from ğµ, ğ‘‰, ğ¼ bands, one of us (BCW)
classiï¬ed objects in the human sample. Inspection consisted of
radial proï¬le analysis and comparison of morphology with known
stars during variation of the image intensity transfer function. A
detailed description of the procedure is given in Whitmore et al.
(2021). The large number of candidates in some targets prevented
classiï¬cation of all objects in this sample, and candidates were
inspected down to a magnitude limit that included âˆ¼ 1000âˆ’1500
objects per target. The limit for the four galaxies in this paper ranged
from ğ‘š(ğ‘‰) = 23.0 to 24.1 (see notes on Table 6 for details).

5.2 Machine learning classiï¬cation

We applied the deep transfer learning ResNet-18 (18 layer residual,
He et al. 2015, hereafter ResNet) and VGG-19_BN (Visual Geom-
etry Group 19 layer with batch normalisation, Simonyan & Zisser-
man 2014, hereafter VGG) convolutional neural network models of
Wei et al. (2020) to all of our candidate clusters, even those not
included in the human sample. Speciï¬cally, we adopted the Wei et
al. models trained using LEGUS-BCW human classiï¬cations for

ten galaxies. As ML for cluster classiï¬cation is an actively emerg-
ing ï¬eld, future successful development will beneï¬t from testing
various approaches. We direct the interested reader to Grasha et al.
(2019) and PÃ©rez et al. (2021). We note that the method of Grasha
et al. (2019) was also used for cluster classiï¬cation required by the
analysis of Messa et al. (2018a).

Our classiï¬cation processing was accomplished on Amazon
Web Services (AWS) cloud computing hardware, using GPU in-
stances launched on demand. Running on a single GPU (NVIDIA
Telsa V100-SXM2 16 Gb) we were able to attain a classiï¬cation
rate of âˆ¼0.7s per candidate.14 For each of ResNet and VGG we eval-
uated ten independent models. From this set of results we obtained
the mean, median, mode classiï¬cation, plus standard deviation, for
each network. The mode was adopted as the ï¬nal single network
classiï¬cation. In Sec. 6.3, we experiment with various ways to attain
a joint classiï¬cation based on ResNet and VGG together. It is worth
stressing that we do expect our ML classiï¬cation accuracy to im-
prove in the future, as we are starting further training experiments
based on a representative set of BCW human classiï¬cations for
PHANGS-HST candidates and from synthetic cluster populations,
rather than relying on LEGUS classiï¬cations for typically more
nearby galaxies than in our sample. As such, we do not consider the
current ML classiï¬cations to be ï¬nalized.

6 APPLICATION TO PHANGS-HST GALAXIES

In this Section we present the results of our cluster detection and
classiï¬cation methods. We analysed the four PHANGS-HST galax-
ies for which LEGUS also produced a publicly available cluster
catalogue, enabling direct comparison between the surveys. Ta-
bles 3 and 4 provide relevant information on each of the galaxies
and the ğ»ğ‘†ğ‘‡ observations, respectively. Figure 12 displays the foot-
print of the ğ»ğ‘†ğ‘‡ images (for primary observations we only show
WFC3/UVIS coverage) and the ALMA CO, MUSE IFU (Integral
Field Unit) spectroscopy sky coverage from the broader PHANGS
project. Complete details of the observations and data reduction are
given in Lee et al. (2021).

We begin here with summary statistics of the cluster candi-
date sample, then describe candidate classiï¬cation results, in both
the human inspection and machine learning contexts. Finally, we
present a detailed comparison of the Class 1 and 2 cluster popula-
tions identiï¬ed by PHANGS-HST and by LEGUS.

6.1 Candidate statistics

In Table 5, for each analysed galaxy, we summarise information
about the objects which are detected by our method and pass our
selection criteria. As described in Table 4 we process NGC 628
as two separate ï¬elds without mosaicking them together due to
camera/ï¬lter diï¬€erences. Furthermore, we present the statistics for
NGC 3351 broken into two columns because additional observa-
tions were obtained as part of PHANGS-HST, increasing spatial
coverage to better match the ALMA observations, thereby increas-
ing the exposure time in the region of overlap between LEGUS and
PHANGS-HST imaging. Speciï¬cally, we analyse: (i) a LEGUS-
only data set (NGC 3351-S in Tab. 4) and (ii) a mosaic constructed
from all available images for NGC 3351.

14 A step-by-step tutorial of our ML procedure is given in Whitmore et al.
(2021), and linked at http://www.stsci.edu/hlsp/phangs-hst.

MNRAS 000, 1â€“30 (2021)

Star Cluster Identiï¬cation in PHANGS-HST

17

Table 3. Galaxy properties

Galaxy Name

NGC 628
NGC 1433
NGC 1566
NGC 3351

RA
[deg]

24.1739
55.5062
65.0016
160.991

Dec
[deg]

Distance
[Mpc]

Stellar Mass
[1010 M(cid:12)]

SFR
[M(cid:12)yrâˆ’1]

SFRğ» ğ‘†ğ‘‡ Morphology
[M(cid:12)yrâˆ’1]

15.7836
âˆ’47.2219
âˆ’54.9380
11.7037

9.9
8.3
18
10

2.2 (Â±0.6)
1.5 (Â±0.4)
6.3 (Â±1.6)
2.3 (Â±0.6)

1.8 (Â±0.5)
0.2 (Â±0.06)
4.7 (Â±1.2)
1.3 (Â±0.3)

0.93
0.11
3.3
0.87

Sc
SBa
SABb
Sb

Note: Properties of the PHANGS-HST galaxies analysed in this paper. They were selected for this study because each has a published cluster catalogue
from LEGUS and a catalogue from our work, enabling comparison of the new cluster pipeline output with established results. Despite having updated
PHANGS-HST distances in Anand et al. (2021), we adopt the LEGUS distances here. This only signiï¬cantly impacts NGC 1433, which has a much larger
revised distance (18.63 versus 8.3 Mpc). Nominal stellar masses and star formation rates (SFR) are for the entire galaxy and have been scaled for the adopted
distance. They are computed following Leroy et al. (2019) (ğ‘§0MGS), using galaxy integrated GALEX FUV + WISE W4 for SFR and WISE W1 for stellar
mass. However, we also provide the SFR integrated within only the ğ» ğ‘†ğ‘‡ footprint, combining multiple ï¬elds for NGC 628 and NGC 3351 (see 4).

Table 4. HST Exposure Times

Field Name

ğ¹ 275ğ‘Š (ğ‘ ğ‘ˆ ğ‘‰ )
[s]

ğ¹ 336ğ‘Š (ğ‘ˆ )
[s]

ğ¹ 438ğ‘Š (ğµ)
[s]

ğ¹ 555ğ‘Š (ğ‘‰ )
[s]

ğ¹ 814ğ‘Š (ğ¼ )
[s]

PID

NGC 628-C
NGC 628-E
NGC 1433
NGC 1566
NGC 3351-N
NGC 3351-S

2481
2361
2376
2382
2190
2361

2361
1119
1116
1119
1110
1062

1358â€ 
4720â€ 
962
965
1050
908

858â€ 
965
1140
1143
670
1062

922â€ 
1560â€ 
986
989
830
908

13364, 10402â€ 
13364, 9796â€ 
13364
13364
15654
13364

Note: ğ» ğ‘†ğ‘‡ imaging exposure times for the galaxies and data sets analysed in this paper. Data for NGC 1433, NGC 1566, and NGC 3351 originate
completely from WFC3/UVIS, whereas NGC 628 observations also include imaging taken with ACS/WFC (as indicated with the â€  symbol). Accordingly,
the ğµ-band data for NGC 628 (both ï¬elds) actually comes from the ğ´ğ¶ğ‘†/ğ¹ 435ğ‘Š ï¬lter not ğ‘Š ğ¹ğ¶3/ğ¹ 438ğ‘Š . ğ» ğ‘†ğ‘‡ program ID (PID) is given in the
ï¬nal column. Note that we combined the two ï¬elds of NGC 3351 into a single drizzled mosaic, whereas (owing to the non-negligible diï¬€erence in ï¬lters
between WFC3/UVIS and ACS/WFC) the NGC 628 data are kept separate for each ï¬eld (e.g. NGC 628-C and NGC 628-E) though there is some spatial
overlap.

Figure 12. Footprints of the ğ» ğ‘†ğ‘‡ (blue, only WFC3/UVIS shown), ALMA (red), and MUSE (cyan) coverage for the galaxies analysed in this paper overlaid
on Digital Sky Survey (DSS) imaging. The PHANGS-HST imaging for NGC 3351 also included ACS ğ‘‰ - and ğ¼ -band parallel observations (footprint shown
as dotted blue box) to enable distance measurements (Anand et al. 2021). Images are oriented with North up and East left. Thus NGC 628-E is the ï¬eld on
left, and NGC 628-C is the ï¬eld centred on the galaxy. For, NGC 3351 the PHANGS-HST WFC3/UVIS data is centred on the galaxy, and LEGUS imaging is
oï¬€set to the SW. For reference of scale, the blue WFC3/UVIS footprint is 7.8, 6.5, 14.1, 7.9 kpc across, respectively for NGC 628, NGC 1433, NGC 1566, and
NGC 3351.

MNRAS 000, 1â€“30 (2021)

MUSEALMAHSTNGC628MUSEALMAHSTNGC1433MUSEALMAHSTNGC1566MUSEALMAHSTNGC3351Table 5. Detection and candidate statistics

Quantity

Row
(#)

NGC 628-C

NGC 628-E

NGC 1433

NGC 1566

NGC 3351ğ‘’ NGC 3351
(all data)

(LEGUS-only)

(1)
(2)
(3)
(4)
(5)
(6)
(7)
(8)
(9)

All-source catalogue entries, Sec. 2.1
General criteria satisï¬ed, Sec. 4.1
Morphology (MCI) criteria satisï¬edğ‘, Secs. 4.2.2 and 4.2.3
Super-HD (bright object) criteria satisï¬edğ‘, Sec. 4.3
General + super-HD criteria only
Human sample size (semi-empirical selection region or super-HD) ğ‘
Machine Learning sample size (model cluster region or super-HD)ğ‘
LEGUS automatic candidates
LEGUS classiï¬ed candidates (Classes 1, 2, 3, and 4)

646263
38776
10482
57
12
5695
7679
3080ğ‘‘
1559

761914
19425
3450
25
4
1366
2117
593ğ‘‘
381

266386
7992
3180
12
6
1230
1989
1099
306

377133
34588
13455
436
130
3757
8822
2752
1061

220905
8079
3784
99
26
1705
2398
1389
618

452247
16487
5415
89
29
2366
3389
Â· Â· Â·
Â· Â· Â·

ğ‘ For Rows (3) and (4), we check the named criteria without enforcing the general conditions of Row (2).
ğ‘ The human sample is deï¬ned as the set of sources meeting general criteria, and either: (1) morphological criteria (e.g. MCI error, ğ‘‰ -band S/N) and lying in the semi-empirical
selection region of the MCI plane (but outside the stellar exclusion region), or (2) meeting the super H-D criteria. In galaxies with very large source populations, only a bright
subset of the human sample candidates are eventually classiï¬ed interactively by a human.

ğ‘ The Machine Learning sample is similar to the human sample, except that morphologically-selected sources are tested against the [broader] model cluster region rather the

semi-empirical selection region.

ğ‘‘ Owing to their condition of having four good photometric bands in order for selection, the footprint of the LEGUS census is signiï¬cantly reduced in these two targets. See

the notes of Table 6 for more detail. Because of this the ratio of Row (7) to Row (8) is inï¬‚ated in NGC 628-C and NGC 628-E.

ğ‘’ This column pertains to analysis of the archival LEGUS data for NGC 3351 (NGC 3351-S in Table 4) without any use of the new NGC 3351-N data obtained by PHANGS-HST,

even in the area of overlap.

1
8

T
h
i
l
k
e
r

e
t

a
l
.

M
N
R
A
S
0
0
0
,

1
â€“
3
0

(
2
0
2
1
)

Table 5 principally gives counts pertaining to our method, but
we also include the total number of sources in the LEGUS â€˜auto-
maticâ€™ catalogue and the subset which were classiï¬ed by the LEGUS
team. This allows an initial assessment regarding the eï¬ƒcacy of our
new techniques.

Row (1), giving the combined number of DOLPHOT and
DAOStarFinder sources, shows that the initial set of all-source
detections coming from DOLPHOT is overwhelmingly large com-
pared to the actual number of reliably identiï¬able stellar clusters.
At least for the distance range we probe, this all-source census is
dominated by stars, including some of marginal signiï¬cance (as
is customary for PSF-ï¬tting resolved stellar photometry prior to
selection of â€˜good starsâ€™ via quality assurance metrics). Row (2),
listing counts after application of general photometric selection cri-
teria (ï¬rst paragraph of Sec. 4.1 and also Sec. 4.4), demonstrates the
drastic reduction in the tally of potential candidates due to our limits
on photometric error (in multiple bands). Row (3) and (4) show the
number of objects from Row (1) meeting our separated conditions
of morphological appearance and luminosity, described in Secs. 4.2
and 4.3, respectively. In this table, the general conditions of Row (2)
are not enforced for tabulating Rows (3) and (4), indicating the small
fraction of the initial all-source catalogue having suitably accurate
MCI measurements, and the minimal population of objects brighter
than the H-D limit. Row (5) gives the number of sources meeting
our general selection criteria and being selected as a candidate only
due to being very luminous.

Our eventual selection, summarised in Fig. 1, is the result
of demanding the set of general criteria and either the morpho-
logical or luminosity based criteria. We report the ï¬nal number
of cluster candidates so selected in Row 7 (ML sample) whereas
Row 6 (human sample) gives the subset distinguished as occupying
the semi-empirical selection region or being in the super H-D tail.
Though not broken down in the table, most (âˆ¼ 50âˆ’70%) candi-
dates originate either within the semi-empirical selection region or
the highest resolution model cluster region (0.01 binning), or their
common zone. Candidates added due to their MCI plane location
in the 0.02 or 0.04 bin-size model cluster regions are typically com-
parable in number to each other, each additional layer of area (at
lower resolution) adding between 20âˆ’30% to the candidate sample.
Our most distant target, NGC 1566, is diï¬€erent, with the candidates
originating more evenly across the MCI plane.

Rows (8) and (9) give the LEGUS candidate counts in total,
and those with LEGUS classiï¬cations, respectively. Comparison of
our ML sample size (Row 7) with that of the LEGUS automatic cat-
alogue (Row 8) shows that despite cuts (e.g. Rows 2, 3, 4) our tally
of candidate clusters is about a factor 2Ã— larger than LEGUS. This
is probably due to a combination of our allowance of more com-
pact cluster morphologies as candidates (âˆ¼4% with CI < LEGUS
limit) and the substantial diï¬€erence in source detection methods,
since DOLPHOT deblends neighbouring sources more eï¬€ectively than
SExtractor. We ï¬nd that candidates allowed into the sample only
by virtue of their absolute magnitude (being too bright for a single
star) are rare (Row 5), with generally between several to âˆ¼30 in each
target. NGC 1566 is an exception, with 130 super H-D candidates
not otherwise qualiï¬ed based on morphological metrics, presum-
ably due to a combination of being much further away than the
other galaxies (18 Mpc versus (cid:47) 10 Mpc) and having nearly triple
the HST-footprint-integrated SFR of any other target.

MNRAS 000, 1â€“30 (2021)

Star Cluster Identiï¬cation in PHANGS-HST

19

6.2 Results from human classiï¬cation

Drawing cluster candidates from the â€˜human sampleâ€™ (see Table 5),
one co-author (BCW) assessed source morphology and assigned
classes following the method in Sec. 5.1. The depth of the human
classiï¬cations varied with the speciï¬c target, going deeper in cases
with few candidates and shallower in highly populous targets. We
are able to use these classiï¬cation data to assess the eï¬€ectiveness of
our selection criteria, and (in the future, with human classiï¬cations
aggregated across all PHANGS-HST targets) to improve the training
of ML networks. Because human classiï¬cations are conï¬ned to
the portion of the MCI plane we call the semi-empirical selection
region, with the exception of rare super H-D sources, we assess
compact cluster selection purity (â‰¡ # Class 1+2 / # Candidates) and
Class 3 contamination (â‰¡ # Class 3 / # Candidates) only within this
area, leaving the outer model cluster regions beyond this for a later
study.

Figure 13 shows the Class 1+2 selection purity attained in
all targets, as a function of ğ‘‰-band magnitude. We present the in-
formation both as a computed purity with Poisson error (bottom
row, red markings), and as the associated counts versus magnitude
(top row, green and grey histograms). Purity generally increases
from âˆ¼ 35âˆ’50% at 23 mag to âˆ¼ 70âˆ’85% brighter than 21 mag.
In NGC 1566 the data suggest a ï¬‚atter relationship. Note that our
ability to accurately constrain the purity worsens as the population
becomes brighter due to reduced counting statistics. Nevertheless,
the overall trend across the sample is clear and the typical pu-
rity within the semi-empirical selection region is in excess of the
comparable statistic for LEGUS (44%, 45%, 37%, 44%, 32% for
NGC 628-C, NGC 628-E, NGC 1433, NGC 1566, and NGC 3351
(LEGUS-only), respectively). In Fig. 13, we also present a purity
assessment for Class 1+2+3 (black markings in bottom row), ï¬nding
that this metric including compact associations alongside compact
clusters is typically 10âˆ’15% higher.

Our method does not recover a majority of the Class 3 objects
identiï¬ed by LEGUS, but this is by design since we are treating
these multi-peak compact associations with the dedicated method
of Larson et al. (2021). Speciï¬cally, our selection areas in the MCI
plane were determined on the basis of only Class 1 and 2 single-
peak objects, both synthetic and observed. Class 3 objects generally
lie below (more negative MCIout at ï¬xed MCIin) Class 1 and 2
objects. Some compact associations (Class 3) do survive our se-
lection as the selection areas for clusters (Class 1 and 2) had to be
made broad enough to retain outlying Class 1 and 2 objects. Such
surviving Class 3 objects should be considered contaminants, and
we only keep them for completeness and comparison to prior work
(LEGUS). We strongly advocate using the multi-scale associations
of Larson et al. (2021) instead. This is particularly important if
the emphasis is on studying young star formation products, as our
Class 3 objects would be highly incomplete in such a context.

We achieved our goal of minimising Class 3 contamination
(# Class 3 / # Candidates) amongst the objects considered as possible
clusters. For the depth attained by PHANGS-HST human classiï¬ca-
tion, such contamination ranged from 8 to 16% across the galaxies
in our study. We do not compare to similar metrics for LEGUS, as
they aimed to recover Class 3 compact associations in addition to
Class 1 and 2 clusters (incidentally, this is a likely reason for their
usage of SExtractor as a detection algorithm).

20

Thilker et al.

Figure 13. (Top row) Selection purity for human classiï¬ed clusters assigned as candidates due to the semi-empirical selection region, or else being brighter
than the H-D limit. Each histogram shows the object counts from a diï¬€erent target, plotting the overall set with available BCW classiï¬cations in grey, the BCW
classiï¬ed Class 1, 2, or 3 clusters in yellow, and BCW Class 1 or 2 clusters in green. (Bottom row) The same information but with the purity expressed as a
fractional measure, with Class 1 or 2 results as red squares, and Class 1, 2, 3 as black dots. The 1ğœ Poisson uncertainty is indicated with thinner red dashed
and black solid lines.

6.3 Results from ML classiï¬cation

As currently implemented in our pipeline, we conduct ML classiï¬-
cation using two diï¬€erent neural network architectures (ResNet and
VGG), each pre-trained as described in Wei et al. (2020). For each
network we evaluate the ensemble of class predictions ten times,
allowing us to determine a mode cluster classiï¬cation for each
source. Just as with human classiï¬ers, these modes do not always
agree between networks or between networks and the BCW human
classiï¬cation. We are then faced with deciding how to best use the
ML results, in the context of our goal to provide cluster classiï¬ca-
tions with the highest completeness (fraction of true Class 1 or 2
clusters classiï¬ed as such) and lowest contamination (population of
non-clusters classiï¬ed as clusters). We have several options:

(1) Identify the network which agrees with human classiï¬cation
of Class 1 or 2 most frequently. That is, select a â€˜preferred networkâ€™
(ResNet or VGG) and adopt its output as the ï¬nal classiï¬cation.
(2) Combine the modes of each network (per candidate) into a
â€˜mode consensus classiï¬cationâ€™, by accepting a candidate as a com-
pact cluster (either Class 1 or 2, but unspeciï¬ed) if either network
predicts that and the other network does not predict Class 4 (star or
artefact).
(3) Evaluate the mode of all 20 (ten ResNet and ten VGG) predic-
tions in a uniï¬ed sense, to yield a â€˜combined network classiï¬cationâ€™.

We now examine the outcomes associated with these options,
and then use the diï¬€erence between resulting compact cluster counts
to: quantify the uncertainty of our ML classiï¬cation methods, and
to bracket the actual number of detectable Class 1 and 2 clusters in
our data set.

Option 1 (â€˜preferred networkâ€™) is the most straightforward way
to proceed, though it should be expected to provide lower accu-
racy than other choices â€“ since the confusion matrices of Wei et al.
(2020) suggest the accuracy of each network is approximately on par
with the consistency achieved by a single human if classiï¬cations
are blindly redone after a period of years. There is no redundancy
against misclassiï¬cation associated with speciï¬c downfalls of a net-
work. However, it has the beneï¬t of simplicity and retains distinction

between Class 1 and 2 (the â€˜mode consensus classiï¬cationâ€™ would
not). In order to decide which network is preferred we compared
the classiï¬cations for PHANGS-HST human Class 1 and 2 objects
(independently per target) to ResNet and VGG classiï¬cations. We
ï¬nd that in 3 of 5 targets the number of identically classiï¬ed sources
is highest for the VGG network. For NGC 1433, ResNet is more fre-
quently in agreement with human classiï¬cation. The two networks
are about equivalent versus Human classiï¬cation for NGC 3351.
Relaxing the set of PHANGS-HST Human classiï¬ed sources to
also include Class 3 (so 1, 2, or 3), we ï¬nd that VGG classiï¬ca-
tions are more closely aligned with the Human assessment in 4 of 5
targets, and VGG and ResNet are about equivalent for NGC 1433.
Therefore, we take VGG as our â€˜preferred networkâ€™. Whitmore et al.
(2021) independently come to the same conclusion, using diï¬€erent
methods. Comparison of ResNet and VGG mode predictions for hu-
man Class 4 sources, shows that ResNet is very slightly more likely
to agree with human classiï¬cation that a contaminant is not a clus-
ter. Table 6 lists the number of compact clusters (Classes 1 and 2)
and compact associations (Class 3) identiï¬ed in each of our targets
(plus NGC 3351 LEGUS-only) via the preferred network, VGG.
For completeness we also give the tallies according to ResNet.

Option 2 (â€˜mode consensus classiï¬cationâ€™) is an attempt to
synthesise the classiï¬cation output of both trained networks, and,
in doing so, provide mitigation against misclassiï¬cation by VGG
or ResNet operating alone. As deï¬ned above, this option can be
thought of as demanding that a source is agreed upon to not be a
star or artefact (by both network architectures), and has been clas-
siï¬ed as 1 or 2 by at least one of them. As such, it is a balance
between completeness (inclusivity) and contamination. Mode con-
sensus classiï¬cation results for all ï¬ve targets are given in Table 6.
The compact cluster counts are lower than for the preferred network
option, but presumably beneï¬t from reduced contamination.

Option 3 (â€˜combined networkâ€™), in which the mode is evaluated
directly over set of 10+10 (ResNet+VGG) models, is also a means
of synthesising all available runs of ML. It has the advantage over
option 2 of retaining the discrimination between classiï¬cations 1, 2,
3, and 4. However, it is unclear if the possible drawback of adding
information resulting from a non-preferred network (here ResNet) is

MNRAS 000, 1â€“30 (2021)

Star Cluster Identiï¬cation in PHANGS-HST

21

Table 6. Classiï¬cation outcomes for candidates in the ML sample, and comparison to BCW humanğ‘, ğ‘, ğ‘, ğ‘‘ and LEGUS humanğ‘’ classiï¬cation. Totals are
given following the multiple strategies we considered for interpretation of the ML results. For comparison with human classiï¬cation of LEGUS we provide
cluster counts for the subset brighter than ğ‘€ğ‘‰ = âˆ’6 in parentheses. Note that the depth reached for BCW classiï¬cations conducted as part of PHANGS-HST
is variable, sometimes not reaching as faint as ğ‘€ğ‘‰ = âˆ’6.

Quantity

Option

NGC 628-C

NGC 628-E

NGC 1433

NGC 1566

NGC 3351 ğ‘“
(LEGUS-only)

NGC 3351
(all data)

ML sample size

7679 ( 5286 )

2117 ( 982 )

1989 ( 464 )

8822 ( 8768 )

2398 ( 1264 )

3950 ( 1887 )

ML Class 1

ML Class 2

ML Class 3

ML Class 1 or 2

Human Class 1
Human Class 2
Human Class 3
Human Class 1 or 2
Human Classiï¬ed

LEGUS Class 1
LEGUS Class 2
LEGUS Class 3
LEGUS Class 1 or 2

VGG, preferred network
ResNet
Combined network

1218 ( 871 )
1141 ( 849 )
1156 ( 847 )

317 ( 161 )
313 ( 169 )
310 ( 156 )

VGG, preferred network
ResNet
Combined network

VGG, preferred network
ResNet
Combined network

377 ( 251 )
306 ( 183 )
301 ( 197 )

385 ( 327 )
392 ( 309 )
344 ( 294 )

VGG, preferred network
ResNet
Mode consensus
Combined network

1595 ( 1122 )
1447 ( 1032 )
1218 ( 929 )
1457 ( 1044 )

157 ( 71 )
186 ( 50 )
150 ( 60 )

115 ( 72 )
110 ( 54 )
98 ( 58 )

474 ( 232 )
499 ( 219 )
417 ( 203 )
460 ( 216 )

210 ( 44 )
286 ( 55 )
225 ( 47 )

132 ( 39 )
214 ( 36 )
149 ( 31 )

206 ( 58 )
206 ( 55 )
202 ( 53 )

342 ( 83 )
500 ( 91 )
329 ( 82 )
374 ( 78 )

796 ( 796 )
996 ( 971 )
778 ( 778 )

398 ( 398 )
534 ( 533 )
392 ( 391 )

1143 ( 1143 )
950 ( 950 )
977 ( 977 )

1194 ( 1194 )
1530 ( 1504 )
1068 ( 1068 )
1170 ( 1169 )

320 ( 170 )
359 ( 184 )
323 ( 172 )

206 ( 98 )
285 ( 110 )
214 ( 94 )

202 ( 119 )
219 ( 125 )
200 ( 117 )

526 ( 268 )
644 ( 294 )
478 ( 250 )
537 ( 266 )

440 ( 221 )
458 ( 239 )
429 ( 219 )

247 ( 128 )
399 ( 137 )
272 ( 125 )

337 ( 201 )
240 ( 150 )
282 ( 175 )

687 ( 349 )
857 ( 376 )
629 ( 312 )
701 ( 344 )

260 ( 260 )ğ‘
211 ( 211 )ğ‘
167 ( 167 )ğ‘
471 ( 471 )ğ‘
1039 (1039)ğ‘

51 ( 51 )ğ‘
40 ( 40 )ğ‘
14 ( 14 )ğ‘
91 ( 91 )ğ‘
174 (174)ğ‘

87 ( 51 )ğ‘
90 ( 50 )ğ‘
52 ( 28 )ğ‘
177 ( 101 )ğ‘
436 (251)ğ‘

377 ( 377 )ğ‘
257 ( 257 )ğ‘
114 ( 114 )ğ‘
634 ( 634 )ğ‘
1442 (1442)ğ‘

113 ( 113 )ğ‘‘
92 ( 91 ) ğ‘‘
68 ( 67 )ğ‘‘
205 ( 204 )ğ‘‘
569 (564)ğ‘‘

136 ( 136 )ğ‘‘
162 ( 162 )ğ‘‘
124 ( 124 )ğ‘‘
298 ( 298 )ğ‘‘
1063 (1063)ğ‘‘

334ğ‘’
357ğ‘’
326ğ‘’
691ğ‘’

92ğ‘’
80ğ‘’
87ğ‘’
172ğ‘’

51
61
56
112

258ğ‘
214ğ‘
261ğ‘
472ğ‘

118
80
94
198

Â· Â· Â·
Â· Â· Â·
Â· Â· Â·
Â· Â· Â·

ğ‘ PHANGS-HST human classiï¬cation (by BCW) for NGC 628-C and NGC 628-E reached mag 23.0 uniformly.
ğ‘ PHANGS-HST human classiï¬cation (by BCW) for NGC 1433 reached mag 24.1 uniformly.
ğ‘ PHANGS-HST human classiï¬cation (by BCW) for NGC 1566 reaches mag 23.5 for the complete ï¬eld and is supplemented with spot check regions (one
running E/W across centre, another covering the S corner of ï¬eld) inspected to 24.34. LEGUS classiï¬cation availability for NGC 1566 is complicated as it
was a mix of pure human and ML (Human: 258 C1, 214 C2, 261 C3, 328 C4; Total: 478 C1, 404 C2, 691 C3, 868 C4). Here we use the human classiï¬cations.

ğ‘‘ PHANGS-HST human classiï¬cation (by BCW) for NGC 3351 reached mag 24.0 uniformly.
ğ‘’ The LEGUS human classiï¬cation eï¬€ort (Adamo et al. 2017) for NGC 628-C and NGC 628-E was conï¬ned to a region somewhat smaller than the complete
ï¬eld that we analysed. Speciï¬cally, the LEGUS team required cluster detection in at least four bands to be considered for inspection, and in these targets
the survey included archival data with diï¬€ering coverage. As a result, only clusters in the overlap region between WFC3/UVIS and ACS/WFC imaging were
classiï¬ed. For NGC 628-C, this omits a peripheral area surrounding the WFC3/UVIS coverage. For NGC 628-E, this omits approximately the easternmost
quarter of the WFC3/UVIS ï¬eld and about half of the WNW portion of the ACS/WFC coverage. Imposing the same sky area cut to PHANGS-HST yields
the following counts for â€˜ML Class 1 or 2â€™ in NGC 628-C, VGG 999(758), ResNet 1056(760), consensus 856(670), combined 952(722); and in NGC 628-E,
VGG 392(199), ResNet 411(187), consensus 344(177), combined 375(183). The numbers just given in parentheses have sky and magnitude limit cuts
making them directly comparable to the NGC 628 values in the last line of the table (LEGUS Class 1 or 2).
ğ‘“ This column pertains to analysis of the archival LEGUS data for NGC 3351 (NGC 3351-S in Table 4) without any use of the new NGC 3351-N data
obtained by PHANGS-HST, even in the area of overlap.

overcome by the increase in statistical signiï¬cance due to more ML
classiï¬cation votes. We include counts from the â€˜combined networkâ€™
option to inform future work. In general, combined network cluster
counts are between those of VGG and ResNet, or slightly lower
than either. We note this â€˜combined networkâ€™ option may have more
meaning in a situation where networks (possibly even the same
architecture) are trained according to diï¬€erent strategies, such as
training with observed clusters (e.g. Wei et al. 2020) versus training
with synthetic clusters and artiï¬cial stars. Discussion of other varied
training strategies is given in Whitmore et al. (2021).

The choice of which option to use will ultimately be driven by
the speciï¬c science use-case. If high completeness or retention of

MNRAS 000, 1â€“30 (2021)

information regarding Class 1 versus 2 is important then we advise
adopting the straight VGG mode classiï¬cation. When forming dis-
tribution functions of cluster properties from such VGG classiï¬ed
objects, one could opt to weight by the fraction of VGG votes agree-
ing with the VGG mode, eï¬€ectively placing emphasis on the most
certain classiï¬cations. For those studies that require low contami-
nation and can accept the inability to distinguish Class 1 from 2, we
suggest use of the â€˜mode consensus classiï¬cationâ€™. We emphasise
that the census of clusters obtained in this manner will still be more
complete than what is provided via PHANGS-HST human classi-
ï¬cation. Presently, we discourage use of the â€˜combined networkâ€™

22

Thilker et al.

classiï¬cation option until such time as diverse training strategies
have been implemented.

Table 6 indicates that the ratio of Class 1 to Class 2 for ML
(here VGG) is typically a factor of 2 to 4, but this same ratio is
around 1 to 1.5 for human based tallies. The main reason for this
is the brighter magnitude limit for human classiï¬cation and does
not imply systematic diï¬€erences in how candidates are classiï¬ed
(between ML and human). For instance, human Class 1 clusters are
generally brighter than ML Class 1 because of the limits imposed
by inspection.

What can we say regarding the uncertainty of Class 1 and 2
cluster counts in our analysis? For each galaxy/ï¬eld we interpret
the â€˜mode consensus classiï¬cationâ€™ tally as a lower limit on the
number of Class 1+2 sources, and the maximum of VGG and ResNet
Class 1+2 cluster counts (VGG and ReSNet individually) as an upper
limit. Adopting the mean of these three tallies as a representative
count, we can express the bracketed range as a percent uncertainty
with respect to the mean. We ï¬nd Â±13%, Â±9%, Â±22%, Â±18%, Â±16%
respectively for NGC 628-C, NGC 628-E, NGC 1433, NGC 1566,
and NGC 3351. Unfortunately, analogous percentage uncertainties
from LEGUS analysis are not available for comparison.

6.4 Comparison of class 1 and 2 clusters in PHANGS-HST

versus LEGUS

It is vital to develop an understanding for potential diï¬€erences be-
tween the Class 1 and 2 cluster populations identiï¬ed by our new
method and the techniques used by others. As noted earlier in the
text, we chose to compare against the LEGUS survey, as several
galaxies are in common between the projects and, even for targets
that diï¬€er, equivalent ï¬ve band ğ‘ğ‘ˆğ‘‰-ğ‘ˆ-ğµ-ğ‘‰-ğ¼ ğ»ğ‘†ğ‘‡ data are em-
ployed. We anticipated both random and systematic diï¬€erences in
the resulting catalogues, with the former associated primarily to
classiï¬cation uncertainty and the later linked to changes in source
detection / candidate selection procedures. We did not undertake
a head-to-head comparison of the Class 3 objects (compact as-
sociations) resulting from our cluster identiï¬cation pipeline versus
LEGUS, as our methods were tuned to preferentially identify single-
peaked cluster-like objects.

We ï¬rst generate a set of sources to guarantee a fair comparison
between the surveys. We account for diï¬€erences in photometry and
coverage. LEGUS classiï¬ed cluster candidates down to ğ‘€ğ‘‰ = âˆ’6,
eï¬€ectively setting the faint end for comparison. Not surprisingly,
slight diï¬€erences in aperture corrections, photometric scatter (from
minimal shifting of candidate centres), and occasional changes in
aperture size suggest that in some cases we should back oï¬€ from the
âˆ’6 limit to ensure that objects brighter than ğ‘€ğ‘‰ = âˆ’6 in PHANGS
are also above this limit in LEGUS. The magnitude limits were
allowed to vary by target and for machine learning classiï¬cation-
based comparisons versus human classiï¬cation. The adopted values
are given in Table 7. For our ML-based comparison the limit is
generally up to 0.2 mag brighter than ğ‘€ğ‘‰ = âˆ’6, though LEGUS
only classiï¬ed sources down to ğ‘€ğ‘‰ = âˆ’7 in NGC 1566. For our
human classiï¬cation-based analysis, the limit is even brighter for
NGC 628-C, NGC 628-E, and NGC 1566, as these galaxies have
very rich cluster populations and it was not practical for our expert
human classiï¬er (BCW) to inspect the entire population. Finally, of
importance when setting the scope of comparison, for NGC 628-C
and NGC 628-E the observational data were a mix of WFC3/UVIS
and ACS/WFC imaging. These cameras have a diï¬€erent size on
the sky and were not forced to have identical orientation. LEGUS
only searched for clusters in the intersection of WFC3/UVIS and

ACS/WFC coverage, whereas we allow cluster candidates anywhere
with coverage in at least three bands, including ğ‘‰ (ğ¹555ğ‘Š). Ac-
cordingly we cut back the footprint of the survey comparison to
the region with LEGUS classiï¬cations. Our eventual â€˜comparison
setsâ€™ are deï¬ned as the union of Class 1 or 2 clusters from either
PHANGS-HST or LEGUS meeting the magnitude and sky area cri-
teria described above. Table 7 gives the number of sources in the
comparison sets as the ï¬rst row in each section of the table.

Within this comparison set for each target we tallied the num-
ber of Class 1 or 2 clusters: (a) found by PHANGS-HST, (b) found
by LEGUS, (c) found by both surveys, (d) found by PHANGS-HST
but not LEGUS, and (e) found by LEGUS but not PHANGS-HST.
These cluster counts are listed in Table 7, along with their associated
percentage of the entire comparison set. The percentages are also
presented graphically in Fig. 14. In a panel devoted to each target
and the type of PHANGS-HST classiï¬cation (ML or human), the
inner ring of each doughnut plot shows basic results of the survey
comparison. Relative to the entire comparison set (think of this as
anything that could possibly be a Class 1 or 2 cluster), the surveys
agree at a signiï¬cant percentage (case (c) above), approximately
50% for ML (median 47%) and slightly higher for human classiï¬-
cations (median 57%). Agreement is weakest for NGC 1433, with
38% for ML and 40% for human classiï¬cation. Survey agreement
also falls for NGC 1566, which we believe is a consequence of
its substantially larger distance. This also makes sense in terms of
NGC 1433, which Anand et al. (2021) have shown is actually at a
distance of 18.6 Mpc rather than the 8.3 Mpc we assumed (in this pa-
per only) for consistency with LEGUS. The percentages discussed
above should not be interpreted in terms of completeness, since
some objects will be identiï¬ed as clusters by one survey but not by
the other, and because the source list itself includes at least some
non-clusters from both surveys. Rather, this âˆ¼ 50âˆ’60% agreement
reï¬‚ects that both LEGUS and PHANGS-HST are likely returning
Class 1 and 2 cluster samples with at least this level of accuracy.

At face value, the higher and generally rather similar percent-
ages of the comparison set reported for PHANGS-HST (case (a) â€“
blue+green in Fig. 14) and LEGUS (case (b) â€“ red+green) suggest
that recovery of the true Class 1 or 2 population is indeed higher
than the intersection statistics above require as a minimum. The
median percentage recovered by the surveys for ML is 73% and for
human classiï¬cation is 77%, calculated by integrating over both sur-
veys without preference. Of course, both surveys are likely subject
to contamination and incompleteness. Contamination in particular
will make the case (a) and (b) percentages skewed misleadingly high
for the survey with the issue and low for the other survey. Without a
more detailed look at the objects seemingly missed by either survey
it is diï¬ƒcult to interpret any further than to say that both surveys
most likely recover on the order of 75% of true Class 1 or 2 clus-
ters meeting the magnitude/footprint constraints, and if systematic
identiï¬cation/misclassiï¬cation exists then this ï¬gure will drop or
rise accordingly depending on which survey has the problem.

Blue and red shaded portions of the outer rings of the dough-
nut plots in Fig. 14 aim to better understand the types of sources for
which the surveys ï¬nd diï¬€erent classiï¬cations. We begin with ob-
jects identiï¬ed as Class 1 or 2 by PHANGS-HST but not by LEGUS
(shown in blue). The wedges labelled L3 and L4 were classiï¬ed
as Class 3 and Class 4, respectively, by LEGUS (but Class 1 or 2
by PHANGS-HST). Approximately one quarter to one third of the
PHANGS-HST-only Class 1 or 2 population falls into this category.
We note that this happens more often in NGC 3351 than for other
targets (42% for ML, 58% for human). In the case of human classi-
ï¬cation, this may be due to the greater exposure depth (which was

MNRAS 000, 1â€“30 (2021)

Star Cluster Identiï¬cation in PHANGS-HST

23

Figure 14. Class 1 and 2 cluster population comparison between PHANGS-HST and LEGUS. The inner ring of each doughnut plot illustrates the fractional
division of the comparison set into: objects belonging to the Class 1+2 survey intersection, (green, â€™BOTHâ€™); objects identiï¬ed as Class 1 or 2 only by
PHANGS-HST (blue, â€™PHANGSâ€™); and objects identiï¬ed as Class 1 or 2 only by LEGUS (red, â€™LEGUSâ€™). The outer ring breaks these populations down
further, showing the cause of the inconsistency, whether due to diï¬€ering classiï¬cation (labels ending in 3 or 4, e.g. â€™H3â€™, â€™H4â€™, â€™ML3â€™, â€™ML4â€™, â€™L3â€™, â€™L4â€™ â€“
where, for instance, â€™H3â€™ indicates the source was classiï¬ed by a human as Class 3 in the survey for which it did not survive as Class 1 or 2), non-detection as
a candidate (â€˜No IDâ€™), ï¬‚agging as a double (â€™Dblâ€™), or some other unspeciï¬ed reason (â€™*â€™). For objects that do appear as either Class 1 or 2 in both surveys,
the green outer wedge indicates the fraction having equal Class (1 and 1, or 2 and 2, labelled â€™Equalâ€™) or swapped class (1 and 2, labelled â€™Unequalâ€™). See
the text for detailed description of each subclass. (Top row) Comparison outcome based on PHANGS-HST machine learning classiï¬cations. (Bottom row)
Comparison outcome based on human classiï¬cation. Note that the comparison set of objects is determined independently per object and also for ML and
human classiï¬cations, with the ML outcomes ultimately based on a larger number of objects extending to fainter magnitudes. See the text for details.

Table 7. Comparison between the Class 1 and Class 2 cluster populations of PHANGS-HST and LEGUS

Quantity

NGC 628-C

NGC 628-E

NGC 1433

NGC 1566

ML comparison set
ML set: ğ‘€ğ‘‰ limit
ML set: PHANGS
ML set: LEGUS
ML set: Bothğ‘
ML set: PHANGS not LEGUS
ML set: LEGUS not PHANGS

Human comparison set
Human set: ğ‘€ğ‘‰ limit
Human set: PHANGS
Human set: LEGUS
Human set: Bothğ‘
Human set: PHANGS not LEGUS
Human set: LEGUS not PHANGS

929
-6.15
690 (74%)
677 (74%)
438 (47%)
252 (27%)
239 (26%)

457
-7.0
361 (79%)
354 (77%)
258 (56%)
103 (22%)
96 (21%)

250
-6.0
205 (82%)
169 (68%)
124 (50%)
81 (32%)
45 (18%)

88
-7.0
76 (86%)
77 (87%)
65 (74%)
11 (13%)
12 (14%)

126
-6.15
70 (55%)
104 (83%)
48 (38%)
22 (17%)
56 (44%)

130
-6.15
88 (68%)
88 (68%)
62 (48%)
26 (20%)
42 (32%)

1270
-7.0
906 (71%)
869 (68%)
505 (40%)
401 (31%)
364 (29%)

780
-7.8
558 (71%)
596 (76%)
374 (48%)
184 (23%)
222 (28%)

NGC 3351ğ‘
(LEGUS-only)

264
-6.2
228 (86%)
186 (70%)
150 (57%)
78 (29%)
36 (14%)

241
-6.2
193 (80%)
186 (77%)
138 (57%)
55 (23%)
48 (20%)

ğ‘ This column pertains to analysis of the archival LEGUS data for NGC 3351 (NGC 3351-S in Table 4) without any use

of the new NGC 3351-N data obtained by PHANGS-HST, even in the area of overlap.

ğ‘ Lines in boldface show that if one considers the union of Class 1 and 2 clusters in both surveys to be the true population,
PHANGS-HST and LEGUS agree at the 48â€“74% (56% median) level for human classiï¬ed objects brighter than
ğ‘š(ğ‘‰ ) âˆ¼ 23.5 and 38â€“57% (47% median) level for PHANGS-HST ML classiï¬ed objects brighter than ğ‘š(ğ‘‰ ) âˆ¼ 24.

not used in ML), in the overlapping LEGUS and PHANGS-HST
ï¬elds. An even larger contribution (âˆ¼ 40âˆ’70%) to this misclas-
siï¬cation category comes from sources which were somehow not
even considered by LEGUS (labelled â€˜no IDâ€™). These result from
intrinsic diï¬€erences in the types of sources detected by SExtractor
versus DOLPHOT, or due to automated cuts made by LEGUS after
the detection stage (CI, number of bands with good photometry).
A minority of sources, belonging to doughnut wedges labelled with

asterisks, were at least considered as LEGUS candidates and seem to
have met the conditions for LEGUS classiï¬cation given by Adamo
et al. (2017) but did not receive an eventual class for some reason
we have not been able to determine. Next, we examine the sources
deemed Class 1 or 2 by LEGUS but not by PHANGS-HST (red re-
gion in the outer doughnut). A ï¬rst category is comprised of sources
we ï¬‚ag as â€˜doublesâ€™ (see Sec. 4.4), where two objects are detected
within 2.5 pixels of one another. Extended sources at such small

MNRAS 000, 1â€“30 (2021)

24

Thilker et al.

Figure 15. Human classiï¬cation results for the comparison subset of LEGUS Class 1 or 2 objects labelled as Class 4 (contaminant) by PHANGS-HST. See
the text for details of each subclass. Low number statistics are a concern for NGC 628-E and NGC 1433, so the most attention should be focused on the other
targets (having more sources represented) in these plots.

association because the only evidence remaining of cluster-nature
is the very inner proï¬le of the source, which can be overridden or
overlooked due to environment. We have no reason to believe this
happens more often in either survey, and the ML3/H3 fractions are
indeed similar to H3 in Fig. 14. A far more signiï¬cant (and sys-
tematic) classiï¬cation trend between LEGUS and PHANGS-HST
is represented by the ML4/H4 wedges which dominate the LEGUS-
only Class 1 or 2 population. In most targets more than 50% (and
up to > 70%) of LEGUS Class 1 or 2 sources not called 1 or 2 by
PHANGS-HST are instead classiï¬ed as contaminants by PHANGS-
HST. We return to this point below. Finally, a small percentage of
LEGUS Class 1 or 2 clusters are omitted from the PHANGS-HST
Class 1 or 2 census for reasons we did not track down (red outer
wedge labelled with asterisk), but possibly these sources failed cuts
on MCI error.

In the case of the human comparison set, we have more detailed
information on the appearance of sources LEGUS called Class 1
or 2 and PHANGS-HST classiï¬ed as contaminants (that is, Class 4
in the original LEGUS system, and now subdivided by BCW into
Classes 4.1, 4.2, . . . , 4.12 in order to specify the variety of con-
taminant cluster candidate, e.g. single star, stellar pair, stellar triple,
saturated star, diï¬€raction spike, galaxy nucleus, background galaxy,
etc. â€“ see Whitmore et al. (2021) for details). In Fig. 15, we show
doughnut charts for these human Class 4 (â€˜H4â€™) sources, splitting
them into up to six BCW subclasses (others of the 12 were not
encountered). Speciï¬cally, the H4 sources are classiï¬ed as a single
star, pair or triple stars, redundant (another accepted Class 1, 2, 3
within 5 pixels), edge artefact, or too faint to classify. This categor-
ical assessment of contributors to the H4 LEGUS-only population
is most informative/reliable in cases having many sources. For this
reason NGC 628-E and NGC 1433 should be viewed cautiously, as
they each have (cid:54) 15 H4 sources (only 8 in NGC 628-E).

The ï¬rst observation to be made from Fig. 15 is that sources
appearing to BCW as single stars are a minority in this population,
amounting to less than 25% in all cases. The bulk of H4 sources are
thought to be pairs or triples of stars according to the PHANGS-
HST human classiï¬cation. In general pairs constitute âˆ¼ 45%, and
triples âˆ¼ 33%, of the H4 LEGUS-only population. Combined with
the already ï¬‚agged â€˜doublesâ€™ from the analysis above, we conclude
that the majority of objects called Class 1 or 2 by LEGUS and not
by PHANGS-HST are actually multiple stellar sources not meeting
the source surface density needed to qualify as Class 3 associa-
tions. Whitmore et al. (2021) describes how this distinction is set by
counting peaks within a 5 pixel radius. This eï¬€ect is probably ac-
centuated by situations in which SExtractor does not deblend such
multiples and places a source between the actual peaks. This is a par-
ticular strength of using the PSF-ï¬tting source detection algorithm
(DOLPHOT) for our work, though it comes with the price of spu-

MNRAS 000, 1â€“30 (2021)

Figure 16. Cluster mass versus age for Class 1 or 2 clusters in NGC 628-C.
With open circles we plot the clusters recovered via human classiï¬cation.
Dots represent the ML classiï¬ed population. Green colour is used for Class 2
(asymmetric) clusters, whereas blue circles and black dots represent Class 1
objects. Note the marked extension of the ML population to lower masses
and higher ages. The greyscale histogram behind the plotted points shows
the number density of ML clusters (Class 1 and 2 together).

separations, even if real and not a redundant DOLPHOT detection
of the wings of the brighter extended object, would be challeng-
ing to classify accurately. We ï¬nd that 10âˆ’20% of the LEGUS
Class 1 or 2 objects not included by PHANGS-HST fall into this
category. Whitmore et al. (2021) also comment on the preferen-
tial inclusion of â€˜doublesâ€™ by LEGUS, and ï¬nd they are typically
assigned to Class 2. Diï¬€erences in classiï¬cation between surveys
can also be seen as many PHANGS-HST Class 1 or 2â€™s are called
Class 3 or 4 by LEGUS. In terms of Class 3 (see ML3, H3 doughnut
wedges), they amount to âˆ¼15%. One comment applicable to both
survey classiï¬cation eï¬€orts is the diï¬ƒculty in classifying objects in
crowded environments â€“ this is particularly relevant to the distinc-
tion between Class 3 and Class 1+2. For example, imagine taking a
conï¬dent Class 1 or 2 cluster and placing it in a region with many
point sources or even other clusters. Based on the relative location of
objects, it is possible that such a Class 1 or 2 is frequently judged by
the classiï¬er (either ML or human) as an apparent Class 3 compact

Star Cluster Identiï¬cation in PHANGS-HST

25

Figure 17. Spatial distribution of PHANGS-HST Class 1 and 2 clusters identiï¬ed in NGC 628-C, restricted to the area of WFC3/UVIS+ACS/WFC overlap,
as the accuracy of our age determination is negatively impacted by the loss of ğ‘ ğ‘ˆ ğ‘‰ - and ğ‘ˆ -band photometry outside the (relatively smaller) WFC3/UVIS
footprint. (Left) The distribution of recovered Class 1 or 2 clusters according to the ML catalogue. (Right) The equivalent ï¬gure using human classiï¬cations.
Note how the increased number of clusters in the ML catalogue makes it substantially easier to see spatial trends in age, such as those associated to spiral
structure (the arms deï¬ned by Querejeta et al. 2021 are outlined). Note that much of the very young star-forming population is excluded here, as we do not
show Class 3 objects (see multi-scale associations of Larson et al. 2021, instead). This higher recovery rate of clusters will directly improve cross-correlation
analyses with other objects such as CO clouds.

rious detections in the wings of bright objects (largely eliminated
by our doubles check, Sec. 4.4) and the need to explicitly elimi-
nate redundant counting of associations due to proper deblending
of subclumps (last paragraph of Sec. 4.4). The subclasses not yet
described (redundant, edge, too faint) remain in the minority across
the entire H4 population, with faint objects only cropping up in
NGC 1566 and edge artefacts in NGC 1566 and NGC 628-E. The
slightly more numerous â€˜redundantâ€™ population can be attributed to
diï¬€erences in source detection between surveys.

Lastly, we emphasise one ï¬nal point from Fig. 14 concerning
exact classiï¬cation agreement. In the outer ring of the doughnut
plots, in two shades of green, we indicate the fraction of Class 1
or 2 clusters in common between surveys that were given the same
Class (e.g. 1 and 1; 2 and 2) with the darker wedge, and those
that disagreed (e.g. 1 and 2; 2 and 1) with the lighter colour. Quite
commonly the survey classiï¬cation agreed on speciï¬c Class for
this subset of the the overall comparison set. We direct the reader
to Whitmore et al. (2021) for a detailed, extensive discussion of
confusion between classes, including a discussion of confusion ma-
trices for cross-survey (PHANGS-HST versus LEGUS) and internal
(VGG versus ResNet, human versus VGG, etc.) comparisons.

Complementing the limited PHANGS-HST-ML to LEGUS-
human classiï¬cation results (top row of Fig. 14) of this Section,
we direct the reader to the more extensive analysis of similar issues
by Whitmore et al. (2021). In particular, Whitmore et al. (2021)
introduce use of the colour-colour diagram as a â€™ï¬gure of meritâ€™ to
further test the relative performances of the diï¬€erent methods.

MNRAS 000, 1â€“30 (2021)

6.5 Resulting PHANGS-HST cluster catalogues

This paper is not intended to provide astrophysical analysis of the
cluster populations recovered by our methods, but rather to focus
on the adopted procedures. Nevertheless, without presentation of
some scientiï¬cally relevant plots, it would be impossible to fully
appreciate the improvement we have attained relative to previous
works, except in the sense of the comparison described in Sec. 6.4.
In Fig. 16, we show the PHANGS-HST Class 1+2 clusters identi-
ï¬ed by human and ML classiï¬cation for NGC 628-C. Fig. 17 shows
the spatial distribution of clusters for the same ï¬eld (trimmed to
the WFC3/UVIS+ACS/WFC footprint) colour-coded by age in both
contexts. These ï¬gures displaying our results for one target are both
internally instructive, emphasising the more expansive cluster pop-
ulation recovered using ML classiï¬cation relative to human-based
eï¬€orts, and also can be compared versus the results of Adamo et al.
(2017) who used the same data. Appendix A contains equivalent
ï¬gures for all the ï¬elds analysed in our paper.

7 DISCUSSION

7.1 General comments on our overall strategy

A limiting step in most studies of extragalactic star clusters is the
manual eï¬€ort needed to remove artefacts from candidate lists. It
is diï¬ƒcult to automatically identify candidate star clusters with a
high degree of certainty due to environmental complexity (eï¬€ects
such as crowding and high background), in addition to resolution
limits. The MCI approach we introduced was originally designed to
reduce the number of candidate star clusters that would need to be
manually examined to remove artefacts such as pairs of stars, back-
ground galaxies, edge eï¬€ects, etc. The basic strategy was to leverage

26

Thilker et al.

photometry from several apertures rather than just the two used to
determine the concentration index (CI), which has been the stan-
dard way to ï¬lter out artefacts. In this way, selection criteria could
be enforced that insured that the proï¬le followed a typical proï¬le
of a cluster rather than a star, pair of star, or other more compli-
cated morphologies. Original trials using this approach were largely
successful, reducing the size of the candidate list by about 50%.

During implementation, several other considerations reduced
this percentage somewhat, while enabling other improvements to
the overall strategy. One example is that the selection routine for
both stars and cluster candidates has been uniï¬ed to use a sin-
gle primary method (DOLPHOT), rather than using two completely
diï¬€erent methods employed by many other projects. This elimi-
nates the necessity for subsequently cross matching the stellar and
cluster catalogues after totally independent selection/classiï¬cation
decisions have been made, which would otherwise be a signiï¬cant
source of noise and complexity at a later stage of a project. How-
ever, a side-eï¬€ect of the use of DOLPHOT is that it introduces a much
larger initial candidate list since DOLPHOTâ€™s selection routine uses
an iterative method to optimally deblend neighbouring sources and
ï¬nd fainter, inconspicuous sources in the wings of bright objects.
This is the main source of the growth of our candidate cluster lists.
Another similar, but less important eï¬€ect from a growth standpoint
is the development of a more sophisticated method of removing
point-like objects, allowing us to include proportionately more (of
particularly compact) cluster candidates than possible using only
the concentration index, hence improving the completeness levels.
The MCI approach also enables other potential improvements,
many of which will be more evident in later stages of the PHANGS-
HST project. For example, the development of cluster models
needed to deï¬ne selection regions for the MCI values will be useful
in the analysis of various physical characteristics of the clusters,
such as whether the objects are likely to be bound or unbound,
whether certain kinds of potential proï¬les (e.g. very diï¬€use) are not
actually found in nature, and how the proï¬les of clusters change as
a function of age.

In summary, while some of the initial goals of the MCI method
have not been fully realised (i.e. the reduction in the candidate list),
the overall improvements to the project is evident and is expected
to have long range beneï¬ts relative to the PHANGS-HST science
goals and cluster studies in general.

7.2 Realised scientiï¬c advantages of our method

Our fully integrated pipeline for cluster detection, identiï¬cation,
and ML classiï¬cation produces reliable catalogues of clusters with
minimal human eï¬€ort. These catalogues have clear advantages over
prior eï¬€orts, even using the same observational data and neglecting
the relative ease with which they can be generated. This subsection
is devoted to highlighting such scientiï¬c beneï¬ts in broad terms.

The advantage of reproducibility, and presumed replicability,
should not be understated. Even within LEGUS, the premier cluster
study prior to PHANGS-HST, attaining reproducibility was chal-
lenging (PÃ©rez et al. 2021). The burden of human classiï¬cation rel-
ative to the limited pool of trained team member classiï¬ers (âˆ¼ 12)
led to compromises in the uniformity of the adopted procedure. For
instance, in general for each galaxy only a small subset (3 people) of
classiï¬ers examined the candidates (Adamo et al. 2017). This could
impart systematic diï¬€erences in the eï¬€ective classiï¬cation scheme
between targets, if individual volunteers gave more weight to dif-
ferent aspects of the classiï¬cation procedure. In cases where the
number of candidates per target were very high, the classiï¬cation

task was divided across the galaxy, assigning stripes of coverage to
diï¬€erent subsets of the classiï¬cation group. It should be said that
membership in each subset was shuï¬„ed, and the mode was adopted
as ï¬nal judgement amongst the classiï¬cation votes per candidate,
in hopes of minimising systematic eï¬€ects. The adopted LEGUS
method represents the best that can be achieved with a small group
of human volunteers. 15

For PHANGS-HST, at no stage in the ML classiï¬cation branch
of our pipeline does human judgement enter the procedure in real
time, so in one sense our analysis is reproducible. However, the
training of the ML network embodies the non-reproducible16 ex-
pert knowledge of cluster classiï¬cation of co-author BCW, as well
as the collective eï¬€orts of LEGUS classiï¬ers (used for training by
Wei et al. 2020 alongside BCW-only classiï¬cations). Because there
are humans involved in the construction of the training sets, the
outcome of the procedure may change if the training set is con-
structed by a diï¬€erent human[s], though Wei et al. (2020) conclude
that LEGUS and BCW training sets seem to produce comparable
accuracies. We expect ML classiï¬cation accuracy to improve with
further training method experimentation and as the database of hu-
man classiï¬ed objects grows and becomes fully representative, both
factors described by Whitmore et al. (2021). Systematics can still
exist in our ML classiï¬cation, dependent upon the overall suitability
of the training sets to the actual objects being classiï¬ed, and pos-
sibly on the degree to which the training sets are balanced among
classes (clusters versus stars versus artefacts) or even among cluster
morphologies within a class (physically large clusters versus com-
pact). In regard to overall suitability, the majority of galaxies in
the full PHANGS-HST sample are more distant than the LEGUS
targets that were used by Wei et al. (2020). This is one of the main
reasons that we still undertake human classiï¬cation in our project,
with the goal of accumulating a training sample that probes a more
fully representative range of distance spanning the Local Volume
(e.g. LEGUS) out to objects beyond the Virgo cluster (some of the
PHANGS-HST targets). In essence, the construction of a training set
should be seen as an integral part of the ML procedure, not as some-
thing that precedes it. To summarise, we hope that full adoption of
ML classiï¬cation by the star cluster community (see also important
work by PÃ©rez et al. 2021 and BialopetraviÄius et al. 2019) will lead
to replicability amongst groups that often have somewhat diï¬€erent
data sets, and such replicability can build consensus regarding our
understanding of cluster formation / evolution / destruction.

Secondly, and in a more practical sense, another methodolog-
ical advantage is that by relying on ML classiï¬cation we enable
complete evaluation of all candidates down to our detection (se-
lection) limit. Naturally, classiï¬cations of fainter objects can be
expected to individually be less conï¬dent (distinguishing between
Class 1 and Class 2 for example) than for bright analogues in the
same environment (see Whitmore et al. 2021). However, integrated
over an ensemble of many objects the cluster / not-a-cluster ML
evaluation (that is, Class 1 or 2, or not) is still reliable near the

15 Experimentation with citizen science based classiï¬cation was undertaken
by LEGUS as well, to potentially overcome the limits of person power, but
the lack of interactive inspection tools (image contrast, radial proï¬les) on
current platforms led to the conclusion this was not yet feasible. We note that
in the more resolved case of the Magellanic Clouds, and M31 / M33 (with
ğ» ğ‘†ğ‘‡ ), citizen science cluster identiï¬cation has proven rather successful
(e.g. Johnson et al. 2012).
16 Whitmore et al. (2021) highlight the fact that even an expert reviewer,
conducting classiï¬cations of the same objects separated by a period of
several years, will assign a small fraction of clusters to diï¬€ering classes.

MNRAS 000, 1â€“30 (2021)

faint limit of our candidate selection (ğ‘‰-band S/N âˆ¼ 10), based on
spot checks of deeper human classiï¬cation versus the ML classiï¬-
cation. We emphasise further that by classifying our complete list
of candidates we are able to include the often substantial, easy to
classify population of faint candidates occupying isolated, low sur-
face brightness, low confusion environments. These typically get
missed by human classiï¬cation eï¬€orts, unless speciï¬cally remedied
post facto (e.g. over 100 faint diï¬€use sources were added manually
to the NGC 4449 sample in Whitmore et al. 2020).

Unfortunately, improved recovery of faint clusters enabled by
ML is counteracted by losses in our ability to determine accurate
photometric ages for young star clusters with mass (cid:47) 104 M(cid:12) due
to stochasticity (e.g. Fouesneau et al. 2014; Krumholz et al. 2015;
Hannon et al. 2019; Whitmore et al. 2020). In some science use
cases requiring single object characterisation, this may limit the
usefulness of clusters at faint apparent magnitude, particularly as
galaxy distance decreases.

Even so, ML classiï¬cation for complete candidate samples
dramatically increases the number of recovered clusters, translat-
ing into statistical improvement in the ageâ€“mass diagram, reaching
signiï¬cantly lower mass at ï¬xed age, or alternatively greater age
at ï¬xed mass. In Fig. 16, we show the PHANGS-HST Class 1+2
clusters identiï¬ed by human (open circles) and ML classiï¬cation
(dots). Class 2 clusters are colour-coded green. Notice how the ML
population reaches masses about 0.5 dex (âˆ¼ 3Ã—) lower than the hu-
man classiï¬cation. In the alternative perspective, at ï¬xed mass (at
least for intermediate age clusters), the ML catalogue probes up to
a factor ten older in age. Appendix A includes ageâ€“mass diagrams
for all the ï¬elds analysed in this paper. The degree of human-to-ML
improvement varies within the ï¬ve ï¬elds, owing to diï¬€erences in
depth of the human classiï¬cations.

There are numerous trickle-down scientiï¬c gains to expect
coming from expansion of the identiï¬ed cluster population. For ex-
ample, improvements in the ageâ€“mass diagram will impact studies
of the cluster mass function by allowing the bins in age that are
typically used to each extend to lower mass (e.g. R. Chandar et al.
in prep, note that the intermediate age clusters are often examined
separately as they have survived removal from their natal environ-
ment). This will generally boost the statistical signiï¬cance of mass
function ï¬t results through increased numbers, and may perhaps al-
low sensitivity to detect broken power law mass functions. Far better
populated ageâ€“mass diagrams will yield improvement in modelling
of cluster disruption (mass dependent versus mass independent) as
it provides additional statistics for low mass clusters in an evolved,
intermediate age state. We anticipate Î“ (the fraction of star forma-
tion occurring in bound clusters, e.g. Bastian 2008; KruÄ³ssen 2012)
determinations will increase, given that some of the newly recov-
ered clusters are of Class 1 and have ages signiï¬cantly larger than
their crossing time (thus are likely bound at high conï¬dence).

Another trickle-down scientiï¬c gain from the increased num-
ber of clusters is improvement of studies that use clusters as â€˜clocksâ€™
to estimate timescales for physical processes via cross-correlation
analyses (such as cloud disruption, via comparison to the ALMA CO
catalogues unique to PHANGS-HST). This is due to the increased
surface density of the recovered cluster population in the ML census
versus human classiï¬cation outcome, as best appreciated in Fig. 17.
Note the improved clarity of patterns in age in the ML cluster distri-
bution. Appendix A presents the full set of ML classiï¬ed catalogue
spatial distributions. In the timescale â€˜clockâ€™ application, having a
more complete cluster catalogue means that the power of apparent
physical association between cluster and cloud will contribute to
the cross-correlation function at the â€˜correctâ€™ length scale more fre-

MNRAS 000, 1â€“30 (2021)

Star Cluster Identiï¬cation in PHANGS-HST

27

quently than otherwise in the limited human catalogue. Viewed in
another way, thinking in terms of nearest neighbour analysis, incom-
pleteness in a cluster catalogue might lead to the â€˜wrongâ€™ neighbour
being selected. This being said, measurements (e.g. Cook et al.
2019) of Î“ in main sequence galaxies like those in the PHANGS-
HST sample are generally (cid:47) 30%, and will almost certainly remain
less than 50% even with expanded cluster catalogues. Therefore,
in order to capture the majority of the star formation activity, we
stress the importance of using other localized tracers such as the
most compact multi-scale associations (e.g. Larson et al. 2021) as
well for timescale â€™clockâ€™ applications.

Lastly, although discussed at length in the previous Section, we
end the presentation of scientiï¬c beneï¬ts associated to our methods
by reiterating the improvement we achieved with respect to exclud-
ing (often random) pairs and triples of point-like sources from the
Class 1 and 2 census. This reduction in contamination is partially
due to our speciï¬c attention to this issue but also due to our adop-
tion of DOLPHOT rather than SExtractor as source detection code.
Our choice to use DOLPHOT as a starting point also strategically
facilitates a self-consistent inventory of point sources and clusters,
and enables determination of multi-scale stellar associations (e.g.
Larson et al. 2021). Fig. 18 illustrates the combined census of star
formation products attained by PHANGS-HST by displaying the
associations and clusters of NGC 628-C together. It is abundantly
clear that a complete view of recent (few 107 yr) star formation
requires methods that capture structures spanning from very likely
bound (Î  > many), possibly but indeterminately bound (Î  (cid:47) few),
to unbound and already dissolved/disrupted. Another illustration
of the innovative PHANGS-HST approach to combined recovery
of clusters and associations can be found in Fig. 9 of Lee et al.
(2021), highlighting a region of NGC 3351 with all components
of our multi-observatory PHANGS program displayed. With the
union of PHANGS cluster, association, CO cloud (from ALMA),
and H ii region (from MUSE and traditional narrowband imaging)
catalogues we will be able to place unprecedented constraints on
the cyclic process of star formation in nearby galaxies.

8 CONCLUDING REMARKS

In this paper we have described a new analysis pipeline developed for
the PHANGS-HST survey, designed to detect, measure, optimally
select, and morphologically classify star cluster candidates.

Our pipeline employs innovative strategies such as: (1) source
detection and deblending using PSF photometry code DOLPHOT,
leading to self-consistency between cluster and association cata-
logues, (2) cluster candidate selection based on multiple concen-
tration indices (MCIin and MCIout) that more fully characterise the
source morphology than possible with a single CI, (3) selection
criteria optimised with guidance from synthetic clusters and previ-
ously conï¬rmed clusters, and with special allowance for potential
candidates more luminous than the Humphreys-Davidson (H-D)
limit, and lastly (4) fully-pipelined ML classiï¬cation of cluster can-
didates.

To test the performance of our method, we apply the pipeline
to four galaxies: NGC 628, NGC 1433, NGC 1566, and NGC 3351,
with assumed distances between 8.3 and 18 Mpc. Across the four
galaxies, the median candidate sample size selected for ML (human)
classiï¬cation is 3389 (2366) with range of 1989â€“8822 (1230â€“5695).
The median number of candidates in each galaxy classiï¬ed by a
human (limited by practicality) is 1039 with range of 174â€“1442;
the median number of these sources which are veriï¬ed to be single-

28

Thilker et al.

Figure 18. For a small portion of the NGC 628-C ï¬eld, located in a spiral arm west of the galaxy center, we show PHANGS-HST Class 1 and 2 ML clusters
(as green circles) and the hierarchical associations of Larson et al. (2021) determined on 32 and 64 pc scales using NUV point-sources (as purple and orange
polygons, respectively). The HST image is a colour composite constructed from ğ¼ , ğ‘‰ , ğµ as red, green, and blue.

peaked star clusters (Class 1 or 2) is 298 with range of 91â€“634.
For NGC 1566, at 18 Mpc which is close to the median distance
of the PHANGS-HST sample, for such human veriï¬ed clusters, the
median stellar mass is 3.1Ã—104 ğ‘€(cid:12) with a 25â€“75 percentile interval
of âˆ¼ 1.5âˆ’7.0 Ã— 104 ğ‘€(cid:12). These values drop by about 3âˆ’5Ã— for the
other targets in the current paper (at 8â€“10 Mpc). All candidates have
been classiï¬ed using ML (deep transfer learning CNN models of
Wei et al. 2020), yielding Class 1 or 2 cluster classiï¬cations for 4292
objects (for VGG, 17% of the ML sample). The ML-classiï¬ed Class
1 or 2 samples reach âˆ¼1 magnitude fainter, âˆ¼ 2Ã— lower mass, and
are 2âˆ’5Ã— larger in number, than the human classiï¬ed samples. The
resulting age-mass diagrams and spatial distributions are provided
in Appendix A.

These four galaxies were selected for study because they have
star cluster catalogues which have been independently produced
by the LEGUS program, using a standard approach for selecting
candidates. Comparison between the LEGUS catalogues and the
ones resulting from our PHANGS-HST pipeline allow for one test
of the eï¬€ectiveness of our new approach. Based on the union of
the two catalogues, 48â€“74% (56% median, see lower portion of
Fig. 14 and note (ğ‘) of Tab. 7) of human veriï¬ed Class 1 and
2 star clusters appear in both catalogues. The remainder, clusters
which are unique to one of the catalogues, are discovered in roughly
equal proportion by the two methods. Interestingly, we ï¬nd that the
majority of clusters unique to LEGUS are classiï¬ed as contaminants
in the PHANGS-HST catalogues, and the majority of those unique
to PHANGS-HST appear to be likely clusters not captured by the
LEGUS pipeline.

Overall, we ï¬nd that our new selection method is eï¬€ective,
and furthermore, yield a substantially larger cluster population than
previously identiï¬ed in each of our target galaxies. These cluster

catalogues, and the forthcoming ones from the other 34 galaxies in
the PHANGS-HST program, will transform our understanding of
the link between cluster populations and environmental properties
of the ISM (CO measured with ALMA; H i with the JVLA, Karl
G. Jansky Very Large Array; and optical nebular emission lines
with MUSE IFU spectroscopy), especially when combined with
our upcoming JWST observations recovering embedded clusters
while also clarifying PAH and small dust grain properties. The
complete potential of our PHANGS-HST data set would not have
been accessible without successful pipeline implementation of ML
classiï¬cation, owing to the very large number of cluster candidates.
This seamless integration of automated classiï¬cation has not been
achieved, and deployed to an entire galaxy sample, previously in the
ï¬eld of star clusters. As noted in Section 5.2 and Whitmore et al.
(2021), we expect that the accuracy of ML classiï¬cation will further
improve as more extensive experimentation with varied training
strategies is undertaken. Even so, the current accuracy is on par
with an expert human classiï¬er.

Our analysis of synthetic clusters provides a database with
measured properties for a rather diverse set of parametric Moï¬€at
cluster morphologies. We indicated such linkage between cluster
morphology and metric values could be used to further simulate
the distribution of observed characteristics for a mock cluster pop-
ulation. Folding in completeness estimates as a function of cluster
properties would allow us to interpret the ensemble measured prop-
erties of a detected cluster population in terms of assumed (cluster
formation rate, destruction ğ‘‘2ğ‘/ğ‘‘ğ‘€ ğ‘‘ğ‘¡, and the distribution of ğ´ğ‘‰
and morphology). This forward-modelling approach will be ex-
plored in future work. Aspects of this idea, omitting information on
cluster morphology, have been published in the context of hierarchi-
cal Bayesian analysis by Krumholz et al. (2019b). By incorporating

MNRAS 000, 1â€“30 (2021)

cluster structural measurements, either MCI-based or via Moï¬€at
ï¬tting, and ideally also the population of OB associations that were
once clusters, we can expect the utility of such work to grow con-
siderably.

ACKNOWLEDGEMENTS

Based on observations made with the NASA/ESA Hubble Space
Telescope, obtained from the data archive at the Space Telescope
Science Institute. STScI is operated by the Association of Univer-
sities for Research in Astronomy, Inc. under NASA contract NAS
5-26555. Support for Program number 15654 was provided through
a grant from the STScI under NASA contract NAS5-26555.

Most of the plots in this paper were generated with TOPCAT
(Taylor 2005) and/or its sister command-line package STILTS (Tay-
lor 2006), both developed and generously released/maintained for
public use by Mark Taylor. A signiï¬cant amount of interactive data
exploration and testing was conducted using TOPCAT.

Our pipeline makes extensive use of the following software
packages:
DOLPHOT, photutils, astropy, matplotlib,
numpy, IMFIT, pytorch, CIGALE. We extend our appreciation
to their respective developers.

This research has made use of the NASA/IPAC Extragalactic
Database (NED) which is operated by the Jet Propulsion Laboratory,
California Institute of Technology, under contract with NASA.

JMDK gratefully acknowledges funding from the Deutsche
Forschungsgemeinschaft (DFG, German Research Foundation)
through an Emmy Noether Research Group (grant number
KR4801/1-1) and the DFG Sachbeihilfe (grant number KR4801/2-
1), as well as from the European Research Council (ERC) under
the European Unionâ€™s Horizon 2020 research and innovation pro-
gramme via the ERC Starting Grant MUSTANG (grant agreement
number 714907).

SCOG and RSK acknowledge support from the DFG via SFB
881 â€œThe Milky Way Systemâ€ (sub-projects A1, B1, B2 and B8)
and from the Heidelberg cluster of excellence EXC 2181-390900948
â€œSTRUCTURES: A unifying approach to emergent phenomena in
the physical world, mathematics, and complex dataâ€, funded by
the German Excellence Strategy. They also acknowledge funding
from the European Research Council via the ERC Synergy Grant
â€œECOGALâ€ (grant 855130).

TGW acknowledges funding from the European Research
Council (ERC) under the European Unionâ€™s Horizon 2020 research
and innovation programme (grant agreement No. 694343).

9 DATA AVAILABILITY

The imaging observations underlying this article can be retrieved
from the Mikulski Archive for Space Telescopes at https://
archive.stsci.edu/hst/search_retrieve.html under pro-
posal GO-15654. High level science products, including science
ready mosaicked imaging, associated with HST GO-15654 are
provided at https://archive.stsci.edu/hlsp/phangs-hst
with digital object identiï¬er doi:10.17909/t9-r08f-dq31

REFERENCES

Adamo A., Bastian N., 2015, arXiv e-prints, p. arXiv:1511.08212
Adamo A., Ã–stlin G., Zackrisson E., Hayes M., Cumming R. J., Micheva

G., 2010, MNRAS, 407, 870

MNRAS 000, 1â€“30 (2021)

Star Cluster Identiï¬cation in PHANGS-HST

29

Adamo A., Ã–stlin G., Zackrisson E., 2011, MNRAS, 417, 1904
Adamo A., KruÄ³ssen J. M. D., Bastian N., Silva-Villa E., Ryon J., 2015,

MNRAS, 452, 246

Adamo A., et al., 2017, ApJ, 841, 131
Adamo A., et al., 2020a, Space Sci. Rev., 216, 69
Adamo A., et al., 2020b, MNRAS, 499, 3267
Anand G. S., et al., 2021, MNRAS, 501, 3621
Anderson J., 2016, Empirical Models for the WFC3/IR PSF, Space Tele-

scope WFC Instrument Science Report

Anderson J., 2018, Focus-Diverse PSFs for Five Commonly Used
WFC3/UVIS Filters, Space Telescope WFC Instrument Science Report
Bailer-Jones C. A. L., Rybizki J., Fouesneau M., Mantelet G., Andrae R.,

2018, AJ, 156, 58

Bastian N., 2008, MNRAS, 390, 759
Bastian N., Gieles M., Lamers H. J. G. L. M., Scheepmaker R. A., de GrÄ³s

R., 2005a, A&A, 431, 905

Bastian N., Gieles M., Efremov Y. N., Lamers H. J. G. L. M., 2005b, A&A,

443, 79

Battinelli P., 1991, A&A, 244, 69
Baumgardt H., Kroupa P., 2007, MNRAS, 380, 1589
Bertin E., Arnouts S., 1996, A&AS, 117, 393
BialopetraviÄius J., Narbutis D., VanseviÄius V., 2019, A&A, 621, A103
Boquien M., Burgarella D., Roehlly Y., Buat V., Ciesla L., Corre D., Inoue

A. K., Salas H., 2019, A&A, 622, A103

Brown G., Gnedin O. Y., 2021, arXiv e-prints, p. arXiv:2106.12420
Calzetti D., et al., 2015, AJ, 149, 51
Chandar R., et al., 2010, ApJ, 719, 966
Chandar R., Whitmore B. C., Dinino D., Kennicutt R. C., Chien L. H.,

Schinnerer E., Meidt S., 2016, ApJ, 824, 71

Cook D. O., et al., 2019, MNRAS, 484, 4897
Deger S., et al., 2021, PHANGS-ALMA Data Processing and Pipeline,

(MNRAS submitted)

Dolphin A. E., 2000, PASP, 112, 1383
Elmegreen B. G., et al., 2020, ApJ, 888, L27
Elson R. A. W., Fall S. M., Freeman K. C., 1987, ApJ, 323, 54
Emsellem E., et al., 2021, PHANGS-ALMA Data Processing and Pipeline,

(MNRAS submitted)
Erwin P., 2015, ApJ, 799, 226
Forbes D. A., Almeida A., Spitler L. R., Pota V., 2014, MNRAS, 442, 1049
Fouesneau M., et al., 2014, ApJ, 786, 117
Gieles M., Portegies Zwart S. F., 2011, MNRAS, 410, L6
Gieles M., Renaud F., 2016, MNRAS, 463, L103
Gieles M., Portegies Zwart S. F., Baumgardt H., Athanassoula E., Lamers
H. J. G. L. M., Sipior M., Leenaarts J., 2006, MNRAS, 371, 793

Grasha K., et al., 2017, ApJ, 840, 113
Grasha K., et al., 2018, MNRAS, 481, 1016
Grasha K., et al., 2019, MNRAS, 483, 4707
Hamedani Golshan R., Schilke P., Sanchez-Monge A., Sewilo M., 2021,
in 43rd COSPAR Scientiï¬c Assembly. Held 28 January - 4 February.
p. 1992

Hannon S., et al., 2019, MNRAS, 490, 4648
He K., Zhang X., Ren S., Sun J., 2015, arXiv e-prints, p. arXiv:1512.03385
Holtzman J. A., et al., 1992, AJ, 103, 691
Humphreys R. M., Davidson K., 1979, ApJ, 232, 409
Hunter D. A., Elmegreen B. G., Dupuy T. J., Mortonson M., 2003, AJ, 126,

1836

Indebetouw R., Wong T., Chen C. H. R., Kepley A., Lebouteiller V., Madden

S., Oliveira J. M., 2020, ApJ, 888, 56

Johnson L. C., et al., 2012, ApJ, 752, 95
Johnson L. C., et al., 2015, ApJ, 802, 127
Johnson L. C., et al., 2017, ApJ, 839, 78
Kharchenko N. V., Piskunov A. E., Schilbach E., RÃ¶ser S., Scholz R. D.,

2013, A&A, 558, A53
King I., 1962, AJ, 67, 471
King I. R., 1966, AJ, 71, 64
KruÄ³ssen J. M. D., 2012, MNRAS, 426, 3008
KruÄ³ssen J. M. D., Pelupessy F. I., Lamers H. J. G. L. M., Portegies Zwart

S. F., Icke V., 2011, MNRAS, 414, 1339

30

Thilker et al.

Krumholz M. R., et al., 2015, ApJ, 812, 147
Krumholz M. R., McKee C. F., Bland-Hawthorn J., 2019a, ARA&A, 57,

Whitmore B. C., et al., 2020, ApJ, 889, 154
Whitmore B., et al., 2021, PHANGS-ALMA Data Processing and Pipeline,

227

Krumholz M. R., Adamo A., Fumagalli M., Calzetti D., 2019b, MNRAS,

482, 3550

Lada C. J., Lada E. A., 2003, ARA&A, 41, 57
Lamers H. J. G. L. M., Gieles M., Portegies Zwart S. F., 2005a, A&A, 429,

173

Lamers H. J. G. L. M., Gieles M., Bastian N., Baumgardt H., Kharchenko

N. V., Portegies Zwart S., 2005b, A&A, 441, 117

Lamers H. J. G. L. M., Baumgardt H., Gieles M., 2010, MNRAS, 409, 305
Larsen S. S., 1999, A&AS, 139, 393
Larsen S. S., 2002, AJ, 124, 1393
Larsen S. S., 2004, A&A, 416, 537
Larsen S. S., 2009, A&A, 494, 539
Larsen S. S., Brodie J. P., 2000, AJ, 120, 2938
Larsen S. S., Richtler T., 1999, A&A, 345, 59
Larsen S. S., Richtler T., 2000, A&A, 354, 836
Larsen S. S., Brodie J. P., Huchra J. P., Forbes D. A., Grillmair C. J., 2001,

AJ, 121, 2974

Larson K., et al., 2021, PHANGS-ALMA Data Processing and Pipeline,

(MNRAS in prep.)

Lee J. C., et al., 2021, arXiv e-prints, p. arXiv:2101.02855
Leroy A. K., et al., 2019, ApJS, 244, 24
Leroy A., et al., 2020, PHANGS-ALMA: Arcsecond CO (2â€“1) Imaging of

Nearby Star-Forming Galaxies, (ApJ in preparation)

Lim S., Lee M. G., 2015, ApJ, 804, 123
McLaughlin D. E., van der Marel R. P., 2005, ApJS, 161, 304
Messa M., et al., 2018a, MNRAS, 477, 1683
Messa M., et al., 2018b, MNRAS, 477, 1683
Oey M. S., King N. L., Parker J. W., 2004, AJ, 127, 1632
PÃ©rez G., Messa M., Calzetti D., Maji S., Jung D. E., Adamo A., Sirressi

M., 2021, ApJ, 907, 100

Pfeï¬€er J., Bastian N., KruÄ³ssen J. M. D., Reina-Campos M., Crain R. A.,

Usher C., 2019, MNRAS, 490, 1714

Querejeta M., Schinnerer E., Meidt S., Leroy A., 2021, PHANGS-ALMA

Data Processing and Pipeline, (A&Asubmitted)

Reina-Campos M., KruÄ³ssen J. M. D., Pfeï¬€er J., Bastian N., Crain R. A.,

2018, MNRAS, 481, 2851

Romita K., Lada E., Cioni M.-R., 2016, ApJ, 821, 51
Ryon J. E., et al., 2017, ApJ, 841, 92
Sabbi E., et al., 2018, ApJS, 235, 23
Sans Fuentes S. A., De Ridder J., Debosscher J., 2017, A&A, 599, A143
Schmeja S., 2011, Astronomische Nachrichten, 332, 172
Sewilo M., 2021, in 43rd COSPAR Scientiï¬c Assembly. Held 28 January -

4 February. p. 1982

Shimonishi T., Onaka T., Das A., Aikawa Y., Sakai N., Nishimura Y., Tanaka
K., Watanabe Y., 2021, in 43rd COSPAR Scientiï¬c Assembly. Held 28
January - 4 February. p. 1907

Simonyan K., Zisserman A., 2014, arXiv e-prints, p. arXiv:1409.1556
Smith L. J., Bajaj V., Ryon J., Sabbi E., 2020, ApJ, 896, 84
Taylor M. B., 2005, in Shopbell P., Britton M., Ebert R., eds, Astronomical
Society of the Paciï¬c Conference Series Vol. 347, Astronomical Data
Analysis Software and Systems XIV. p. 29

Taylor M. B., 2006, in Gabriel C., Arviset C., Ponz D., Enrique S., eds,
Astronomical Society of the Paciï¬c Conference Series Vol. 351, Astro-
nomical Data Analysis Software and Systems XV. p. 666

Turner J. A., et al., 2021, MNRAS, 502, 1366
Webb J. J., Reina-Campos M., KruÄ³ssen J. M. D., 2019, MNRAS, 486,

5879

Wei W., et al., 2020, MNRAS, 493, 3178
Whitmore B. C., Schweizer F., 1995, AJ, 109, 960
Whitmore B. C., Schweizer F., Leitherer C., Borne K., Robert C., 1993, AJ,

106, 1354

Whitmore B. C., Zhang Q., Leitherer C., Fall S. M., Schweizer F., Miller

B. W., 1999, AJ, 118, 1551

Whitmore B. C., Chandar R., Fall S. M., 2007, AJ, 133, 1067
Whitmore B. C., et al., 2011, ApJ, 729, 78

(MNRAS submitted)

Williams B. F., et al., 2014, ApJS, 215, 9
Williams B. F., et al., 2021, arXiv e-prints, p. arXiv:2101.01293
Wilson C. D., 1991, AJ, 101, 1663
Zari E., Brown A. G. A., de Zeeuw P. T., 2019, A&A, 628, A123

APPENDIX A: SUMMARY FIGURES

This appendix presents the ageâ€“mass and age-coded spatial distri-
bution plots for all the ï¬elds we processed as part of this paper.

APPENDIX B: DOLPHOT PARAMETERS

DOLPHOT serves as the primary source detection algorithm for
PHANGS-HST, feeding both the cluster identiï¬cation pipeline and
the multi-scale association ï¬nder of Larson et al. (2021). As such,
even though many choices are similar to usage of DOLPHOT by prior
studies (e.g. LEGUS, Sabbi et al. 2018), PHAT (Williams et al.
2014, 2021), we provide a listing of relevant parameters here so as
to allow for reproducible research.

We note that some parameters may be further tweaked before
the ï¬nal PHANGS-HST data products are released. In particular, we
anticipate reducing SecondPass in order to help mitigate â€˜doublesâ€™
(redundant detections of extended objects) in the cluster context
and over-decomposition of diï¬€use emission into point sources in
the association context. If this, and any other changes are made,
they will be reported in the catalogue release papers.

This paper has been typeset from a TEX/LATEX ï¬le prepared by the author.

MNRAS 000, 1â€“30 (2021)

Star Cluster Identiï¬cation in PHANGS-HST

31

Figure A1. The cluster population of the NGC 628-C ï¬eld as displayed in Fig. 16 and Fig. 17, duplicated here for easy comparison to Figs. A2â€“A5.

MNRAS 000, 1â€“30 (2021)

32

Thilker et al.

Figure A2. As in Fig. A1, except for NGC 628-E. In the lower panel, clusters are only plotted if they have WFC3/UVIS+ACS/WFC coverage. Spiral arms
features extending outward from the centre of the galaxy (lying oï¬€ plot to the right) are marked.

MNRAS 000, 1â€“30 (2021)

Star Cluster Identiï¬cation in PHANGS-HST

33

Figure A3. As in Fig. A1, except for NGC 1433. We show the ring-like structural features identiï¬ed by the environmental masks of Querejeta et al. (2021).
Note that the ğ» ğ‘†ğ‘‡ ï¬eld does not fully cover the NW and SW portions of the outer ring.

MNRAS 000, 1â€“30 (2021)

34

Thilker et al.

Figure A4. As in Fig. A1, except for NGC 1566. The spiral arms of Querejeta et al. (2021) are marked.

MNRAS 000, 1â€“30 (2021)

Star Cluster Identiï¬cation in PHANGS-HST

35

Figure A5. As in Fig. A1, except for NGC 3351. Querejeta et al. (2021) ring-like structural features are drawn.

MNRAS 000, 1â€“30 (2021)

36

Thilker et al.

Table B1. DOLPHOT parameters adopted for PHANGS-HST

Parameter

Meaning

Exposure-speciï¬c parameters:

img*_RAper = 8.0
img*_RChi = 3.0
img*_RSky = 15 35
img*_RSky2 = 4 10
img*_RPSF = 13
img*_aprad = 10
img*_apsky = 15 25

photometry aperture size (ï¬‚oat)
aperture size for determining Chi (ï¬‚oat); if <=0 use RAper
radii deï¬ning sky annulus (ï¬‚oat>=RAper+0.5)
radii deï¬ning sky annulus (for FitSky=2 option)
PSF size (integer>0)
radius for aperture correction ğ» ğ‘†ğ‘‡ -DISABLED (0.5" for WFC3/UVIS and ACS/WFC)
sky annulus for aperture correction

The following parameters aï¬€ect the ï¬nding and measurement of stars:

RCentroid = 2
SigFind = 3.0
SigFindMult = 0.85
SigFinal = 3.5
MaxIT = 25
PSFPhot = 1
PSFPhotIt = 3
FitSky = 3
SkipSky = 2
SkySig = 2.25
NegSky = 1
NoiseMult = 0.10
FSat = 0.999
PosStep = 0.1
dPosMax = 2.5
RCombine = 1.5
SigPSF = 5.0

UseWCS = 1
Align = 2
AlignIter = 2
AlignTol = 0
AlignStep = 1.0
AlignOnly = 0
Rotate = 1
SubResRef = 1
SecondPass = 5
SearchMode = 1
Force1 = 1
PSFres = 1
psfstars =
psfoï¬€ = 0.0
ApCor = 1
VerboseData = 1

centroid box size (integer>0)
sigma detection threshold (ï¬‚oat)
Multiple for quick-and-dirty photometry (ï¬‚oat>0)
sigma output threshold (ï¬‚oat)
maximum iterations (integer>0)
photometry type (integer/0=aper,1=psf,2=wtd-psf)
number of iterations in PSF-ï¬tting photometry (integer>=0)
ï¬t sky? (integer/0=no,1=yes,2=small,3=with-phot)
spacing for sky measurement (integer>0)
sigma clipping for sky (ï¬‚oat>=1)
allow negative sky values? (0=no,1=yes)
noise multiple in imgadd (ï¬‚oat)
fraction of saturate limit (ï¬‚oat)
search step for position iterations (ï¬‚oat)
maximum single-step in position iterations (ï¬‚oat)
minimum separation for two stars for cleaning (ï¬‚oat)
min S/N for psf parameter ï¬ts (ï¬‚oat)

Settings to enable/disable features:

use WCS header info in alignment (integer 0=no, 1=use to est. shift/rotate/scale, 2=use to est. full distortion sol.)
align images? (integer 0=no,1=const(x/yoï¬€),2=lin(x/yoï¬€+scale),3=cube(x/yoï¬€+distortion,4=full3rdorderpolynom)
number of iterations on alignment? (integer>0)
number of pixels to search in preliminary alignment (ï¬‚oat>=0)
stepsize for preliminary alignment search (ï¬‚oat>0)
exit after alignment
allow cross terms in alignment? (integer 0=no, 1=yes)
subpixel resolution for reference image (integer>0)
second pass ï¬nding stars (integer 0=no,1=yes,>1=multiple passes)
algorithm for astrometry (0=max SNR/chi, 1=max SNR)
force type 1/2 (stars)? (integer 0=no,1=yes)
make PSF residual image? (integer 0=no,1=yes)
Coordinates of PSF stars
coordinate oï¬€set (PSF system - DOLPHOT system)
ï¬nd/make aperture corrections? (integer 0=no,1=yes)
to write all displayed numbers to a .data ï¬le

Flags for ğ» ğ‘†ğ‘‡ modes:

ForceSameMag = 0
FlagMask = 4
CombineChi = 0
ACSuseCTE = 0
WFC3useCTE = 0
ACSpsfType = 0
WFC3UVISpsfType = 0
WFC3IRpsfType = 0
InterpPSFlib = 1

force same count rate in images with same ï¬lter? (integer 0=no, 1=yes)
photometry quality ï¬‚ags to reject when combining magnitudes
combined magnitude weights uses chi? (integer 0=no, 1=yes)
apply CTE corrections on ACS data? (integer 0=no, 1=yes)
apply CTE corrections on WFC3 data? (integer 0=no, 1=yes)
use Anderson PSF cores? (integer 0=no, 1=yes)
use Anderson PSF cores? (integer 0=no, 1=yes)
use Anderson PSF cores? (integer 0=no, 1=yes)
interpolate PSF library spatially

MNRAS 000, 1â€“30 (2021)

