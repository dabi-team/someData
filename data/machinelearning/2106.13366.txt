MNRAS 000, 1‚Äì30 (2021)

Preprint 2 November 2021

Compiled using MNRAS LATEX style Ô¨Åle v3.0

PHANGS-HST: New Methods for Star Cluster IdentiÔ¨Åcation in
Nearby Galaxies

David A. Thilker,1‚òÖ Bradley C. Whitmore,2 Janice C. Lee,3,4 Sinan Deger,5
Rupali Chandar,6 Kirsten L. Larson,4 Stephen Hannon,4,7 Leonardo Ubeda,2
Daniel A. Dale,8 Simon C. O. Glover,9 Kathryn Grasha,10 Ralf S. Klessen,9,11
J. M. Diederik Kruƒ≥ssen,12 Erik Rosolowsky, 13 Andreas Schruba, 14
Richard L. White, 2 and Thomas G. Williams 15

1Department of Physics and Astronomy, The Johns Hopkins University, Baltimore, MD, USA
2Space Telescope Science Institute, 3700 San Martin Drive, Baltimore, MD, USA
3Gemini Observatory/NSF‚Äôs NOIRLab, 950 N. Cherry Avenue, Tucson, AZ, USA
4Caltech/IPAC, California Institute of Technology, Pasadena, CA, USA
5TAPIR, California Institute of Technology, Pasadena, CA 91125
6Department of Physics and Astronomy, University of Toledo, Toledo, OH, USA
7Department of Physics and Astronomy, University of California, Riverside, CA, USA
8Department of Physics and Astronomy, University of Wyoming, Laramie, WY 82071, USA
9Universit√§t Heidelberg, Zentrum f√ºr Astronomie, Institut f√ºr Theoretische Astrophysik, Albert-Ueberle-Str 2, D-69120 Heidelberg, Germany
10Research School of Astronomy and Astrophysics, Australian National University, Canberra, ACT 2611, Australia
11Universit√§t Heidelberg, Interdisziplin√§res Zentrum f√ºr Wissenschaftliches Rechnen, Im Neuenheimer Feld 205, D-69120 Heidelberg, Germany
12Astronomisches Rechen-Institut, Zentrum f√ºr Astronomie der Universit√§t Heidelberg, M√∂nchhofstra√üe 12-14, D-69120 Heidelberg, Germany
13Department of Physics, University of Alberta, Edmonton, AB T6G 2E1, Canada
14Max-Planck-Institut f√ºr extraterrestrische Physik, Giessenbachstra√üe 1, D-85748 Garching, Germany
15Max-Planck-Institut f√ºr Astronomie, K√∂nigstuhl 17, D-69117, Heidelberg, Germany

Last updated 2 November 2021

ABSTRACT
We present an innovative and widely applicable approach for the detection and classiÔ¨Åcation
of stellar clusters, developed for the PHANGS-HST Treasury Program, an ùëÅùëàùëâ-to-ùêº band
imaging campaign of 38 spiral galaxies. Our pipeline Ô¨Årst generates a uniÔ¨Åed master source
list for stars and candidate clusters, to enable a self-consistent inventory of all star formation
products. To distinguish cluster candidates from stars, we introduce the Multiple Concentration
Index (MCI) parameter, and measure inner and outer MCIs to probe morphology in more detail
than with a single, standard concentration index (CI). We improve upon cluster candidate
selection, jointly basing our criteria on expectations for MCI derived from synthetic cluster
populations and existing cluster catalogues, yielding model and semi-empirical selection
regions (respectively). Selection purity (conÔ¨Årmed clusters versus candidates, assessed via
human-based classiÔ¨Åcation) is high (up to 70%) for moderately luminous sources in the
semi-empirical selection region, and somewhat lower overall (outside the region or fainter).
The number of candidates rises steeply with decreasing luminosity, but pipeline-integrated
Machine Learning (ML) classiÔ¨Åcation prevents this from being problematic. We quantify the
performance of our PHANGS-HST methods in comparison to LEGUS for a sample of four
galaxies in common to both surveys, Ô¨Ånding overall agreement with 50‚Äì75% of human veriÔ¨Åed
star clusters appearing in both catalogues, but also subtle diÔ¨Äerences attributable to speciÔ¨Åc
choices adopted by each project. The PHANGS-HST ML-classiÔ¨Åed Class 1 or 2 catalogues
reach ‚àº 1 magnitude fainter, ‚àº 2√ó lower stellar mass, and are 2‚àí5√ó larger in number, than
attained in the human classiÔ¨Åed samples.

Key words: galaxies: star clusters: general ‚Äì methods: data analysis ‚Äì surveys ‚Äì catalogues ‚Äì
galaxies: individual NGC 628, NGC 1433, NGC 1566, NGC 3351

1
2
0
2

t
c
O
9
2

]

A
G
.
h
p
-
o
r
t
s
a
[

2
v
6
6
3
3
1
.
6
0
1
2
:
v
i
X
r
a

¬© 2021 The Authors
‚òÖ Contact e-mail: dthilker@jhu.edu

 
 
 
 
 
 
2

Thilker et al.

1

INTRODUCTION

Just as resolved stellar populations are routinely used to measure
the evolutionary history of a galaxy, revealing information other-
wise hidden in plain view, young star clusters yield unique insight
into the physical conditions supporting star formation. They are crit-
ically useful as ‚Äòclocks‚Äô that allow for estimating timescales within
the galactic ecosystem. The ensemble distribution of cluster mass
and age for a galaxy informs us regarding the processes that limit
unbridled star formation (e.g. feedback mechanisms in Krumholz
et al. 2019a) and those that encourage cluster dissolution (e.g. na-
tal gas expulsion, Baumgardt & Kroupa 2007; stellar dynamics,
Lamers et al. 2010; Reina-Campos et al. 2018) or more active dis-
ruption (e.g. due to tidal shocks, Gieles & Renaud 2016; Webb et al.
2019). In clusters that can be resolved into individual constituent
stars and thereby age dated precisely, our understanding of stellar
evolution was originally nurtured, and continues to be reÔ¨Åned for
rare phases, binary stars, and models incorporating rotation. These
(and other) beneÔ¨Åcial aspects of star cluster science have encour-
aged the production of a ‚Äòlegacy‚Äô of studies, both observational
(e.g., Whitmore et al. 1993; Whitmore & Schweizer 1995; Whit-
more et al. 1999; Larsen & Richtler 1999; Larsen 1999; Larsen &
Richtler 2000; Larsen & Brodie 2000; Larsen et al. 2001; Larsen
2002, 2004; Bastian et al. 2005a,b; Whitmore et al. 2007; Bastian
2008; Larsen 2009; Adamo et al. 2010; Chandar et al. 2010; Adamo
et al. 2011; Whitmore et al. 2011; Johnson et al. 2012; Adamo et al.
2015; Adamo & Bastian 2015; Johnson et al. 2015; Chandar et al.
2016; Adamo et al. 2017; Ryon et al. 2017; Johnson et al. 2017;
Grasha et al. 2017, 2018; Messa et al. 2018a,b; Grasha et al. 2019;
Hannon et al. 2019; Elmegreen et al. 2020; Whitmore et al. 2020;
Adamo et al. 2020a,b, plus innumerable studies in the Local Group,
Magellanic Clouds, and Milky Way) and theoretically focused (e.g.
Hunter et al. 2003; Bastian et al. 2005a; Lamers et al. 2005a,b;
Gieles et al. 2006; Larsen 2009; Kruƒ≥ssen et al. 2011; Kruƒ≥ssen
2012; PfeÔ¨Äer et al. 2019).

All of these works have led toward an emphasis on understand-
ing the complex, cyclic relation between the interstellar medium
(ISM) and star formation products. The goal is a thorough assess-
ment spanning the complete range of physical conditions and spa-
tiotemporal scales on which the process of star formation, and hence
galaxy evolution, operates. In the Galaxy, observers study compact
(very young) pre-stellar cores occupying giant molecular clouds
(GMCs), whereas in nearby extragalactic targets we are able to more
clearly delineate larger, progressively evolved, superstructures. Un-
fortunately, these two perspectives rarely overlap. Only recently,
this situation has begun to change (with a handful of exceptions,
e.g. Hamedani Golshan et al. 2021; Sewilo 2021; Shimonishi et al.
2021; Indebetouw et al. 2020, describing observations of molecular
cores in the Magellanic Clouds). Further aÔ¨Åeld, ALMA (Atacama
Large Millimeter Array) and ùêªùëÜùëá (Hubble Space Telescope), re-
spectively, now allow us to image the high resolution (1(cid:48)(cid:48) ‚âà 50 pc at
10 Mpc) distribution of the molecular ISM at GMC scales across en-
tire galaxies and (in the same targets) allow us to inventory clusters
and luminous stars an order of magnitude in size smaller yet.

The PHANGS-HST1 survey (Lee et al. 2021) was designed to
capitalise on this opportunity in a large sample of galaxies. SpeciÔ¨Å-
cally, we obtained Ô¨Åve-band near-ultraviolet through red imaging for
selected targets from the primary ALMA survey of nearby galaxies
(PHANGS2, Physics at High Angular resolution in Nearby Galax-

1 https://phangs.stsci.edu
2 https://www.phangs.org

ieS; Leroy et al. 2020) for which sensitive CO(2‚Äì1) maps were
available. About half of our ùêªùëÜùëá targets are also being studied us-
ing integral Ô¨Åeld spectroscopy at the VLT (Very Large Telescope)
with MUSE (Multi Unit Spectroscopic Explorer) in a companion
survey called PHANGS-MUSE (Emsellem et al. 2021).

We build upon the eÔ¨Äort and results of LEGUS (Legacy Ex-
traGalactic UV Survey, Calzetti et al. 2015) in a very direct manner,
through co-aligned scientiÔ¨Åc goals (with the invaluable addition
of ALMA data for PHANGS-HST targets), further development in
measurement and analysis techniques, and via use of the public
LEGUS catalogues for baseline testing of our new methodologies.
For instance, while we have adopted the cluster classiÔ¨Åcation sys-
tem of LEGUS (Class 1: Symmetric, single-peaked cluster; Class 2:
Asymmetric, single-peaked cluster; Class 3: Multi-peaked compact
association; see Adamo et al. 2017, new details in Whitmore et al.
2021), the current paper describes our evolved approach to clus-
ter detection and selection of likely candidates. We note that the
PHANGS-HST sample signiÔ¨Åcantly improves LEGUS coverage of
the star-forming galaxy main sequence at higher stellar mass and
SFRs (see Fig. 1 of Lee et al. 2021), but does not contain systems
classiÔ¨Åed as a starburst or a dwarf starburst (that are well repre-
sented in LEGUS). PHANGS-HST galaxies are generally at larger
distances than the LEGUS sample.

Common extragalactic cluster detection methods (e.g. used by
the studies above) vary signiÔ¨Åcantly in terms of source identiÔ¨Åca-
tion schemes, but the Ô¨Ånal catalogues almost always rely on con-
centration index3 (CI)-based selection followed by conÔ¨Årmation via
human inspection/classiÔ¨Åcation. This is necessary because galaxies
in the Local Volume and just beyond show both resolved individual
stars and clusters when observed with ùêªùëÜùëá, imparting signiÔ¨Åcant
confusion to the cluster identiÔ¨Åcation process. Unfortunately, anal-
ysis of resolved stellar populations and compact clusters generally
tend to be decoupled from the start, with one detection method used
for stars (e.g. PSF-Ô¨Åtting photometry) and another independent pro-
cess for clusters (e.g. SExtractor, Bertin & Arnouts 1996). However,
this begets inconsistency in the eventual outcomes, and a degree of
double counting in the overall census of star formation activity. For
this reason it would be ideal if our PHANGS-HST pipeline were
able to identify them both using a uniÔ¨Åed approach.

This paper describes such a process, dedicated to jointly recov-
ering clusters and individual stars with a single, versatile detection
method. Working on both populations at once does increase the
importance of accurately distinguishing clusters from stars, and ac-
cordingly we use more information (beyond a single CI value) from
our high-resolution imaging than is typical for cluster candidate se-
lection. SpeciÔ¨Åcally, to better quantify the radial proÔ¨Åle of each de-
tected source, we introduce the concept of a Multiple Concentration
Index (MCI), averaging multiple, strategically re-normalised CI. We
then use a pair of independent MCI values, MCIin and MCIout, fo-
cused on inner and outer source morphology, respectively, to deÔ¨Åne
an ‚ÄòMCI plane‚Äô. We ultimately base our cluster candidate selection
on cuts in these morphological metrics which have been informed
using extensive synthetic cluster observations and MCI values mea-
sured for previously conÔ¨Årmed cluster catalogues. Besides guiding
selection, such synthetic clusters will soon also be used to quantify
completeness as a function of cluster properties (e.g. age, mass, plus

3 DeÔ¨Åned here as the change in magnitude for a source when measured in
two concentric circular apertures of diÔ¨Äerent radius, typically ùëü = 1 and 3
pixels.

MNRAS 000, 1‚Äì30 (2021)

critically also morphology and environment)4, and to gain insight
into the physical properties of cluster ensembles.

This paper is part of a series which documents the major com-
ponents of the overall PHANGS-HST data products pipeline. De-
tails are provided regarding: survey design and implementation (Lee
et al. 2021); aperture correction methods (Deger et al. 2021); source
detection, selection, and aperture photometry of compact star cluster
candidates (this work); star cluster candidate classiÔ¨Åcation (Whit-
more et al. 2021); neural network classiÔ¨Åcation proof-of-concept
demonstration (Wei et al. 2020); stellar association and hierarchical
structure determination, photometry, and determination of physical
properties (Larson et al. 2021); spectral energy distribution (SED)
Ô¨Åtting with CIGALE (Turner et al. 2021); and distance determination
using PHANGS-HST parallel observations for Tip of the Red Giant
Branch (TRGB) analysis (Anand et al. 2021).

Section 2 provides details of source detection and photometry
in our uniÔ¨Åed stellar and cluster context. Section 3 describes creation
of synthetic cluster models. In Section 4 the criteria for cluster can-
didate selection are given. A large portion of Section 4 is devoted to
introducing the MCI plane and describing how we employ synthetic
clusters and observed stars to guide selection in this multi-variate,
morphologically-sensitive context. Our classiÔ¨Åcation of cluster can-
didates, both via human inspection and Machine Learning (ML), is
described in Section 5. The familiar face-on disk galaxy NGC 628
(M 74) is used for illustration of our methods in Secs. 2‚Äì5. Section 6
provides a detailed description of our observational data and the re-
sultant cluster catalogues for a collection of four PHANGS-HST
galaxies and compares them to existing products from LEGUS. We
discuss the implications of our work and speciÔ¨Åc scientiÔ¨Åc beneÔ¨Åts
of our method in Section 7. Finally, in Section 8 we end with a brief
summary, including possible future improvements.

2 SOURCE DETECTION AND PHOTOMETRY

The completeness and Ô¨Ådelity of any stellar cluster catalogue is
ultimately limited by its initial construction, speciÔ¨Åcally by the de-
tection of sources that may be candidate clusters. This Section ex-
plains our approach to this initial step, and describes the aperture
photometry performed on all detected sources.

Preferred extragalactic star cluster detection methods vary con-
siderably depending upon the physical spatial resolution of the
data. When clusters are resolved or partially-resolved into individ-
ual stars, well-known spatial clustering methods (e.g. friends-of-
friends, nearest-neighbours, Minimum Spanning Tree (MST) sep-
aration, DBSCAN, OPTICS; Battinelli 1991, Wilson 1991, Oey et al.
2004, Schmeja 2011, Sans Fuentes et al. 2017, Zari et al. 2019)
applied to point source (stellar) catalogues are typically preferred.
At somewhat lower resolution, when only a handful of individual
stars can be identiÔ¨Åed in any given cluster but not enough to support
the use of clustering algorithms, a matched Ô¨Ålter, cross-correlation
approach, with kernels tuned to emphasise extended, cluster-like
objects, are preferred (e.g. star cluster catalogues based on Source
Extractor (Bertin & Arnouts 1996) with Ô¨Åltering enabled and a
kernel having FWHM broader than the PSF (Forbes et al. 2014;
Lim & Lee 2015).) The PHANGS-HST data used here approaches
the limit of resolution where this latter method begins to be disfa-
vored. Indeed, the vast majority of clusters in our ùêªùëÜùëá observations

Star Cluster IdentiÔ¨Åcation in PHANGS-HST

3

appear quasi-point-like, and are easily detected with PSF-Ô¨Åtting
photometry codes which were originally designed for resolved stel-
lar population work. Note that at the median 16 Mpc distance to a
PHANGS-HST galaxy, the 0.08(cid:48)(cid:48) PSF FWHM (2-pixel) resolution
of the WFC3/UVIS camera is ‚àº 6 pc. A typical cluster has an in-
trinsic eÔ¨Äective radius of ùëüeÔ¨Ä ‚àº 3 pc, which after convolution by the
PSF, yields a source with apparent FWHM ‚àº
2√ó broader than a
point source.

‚àö

2.1 Source detection using DOLPHOT

PHANGS-HST has adopted the DOLPHOT photometry package
(v2.0, Dolphin 2000) as the principal source detection code in
our pipeline. SpeciÔ¨Åcally, we use the WFC3 and ACS modules, and
main distribution tarball downloaded5 on 4 Dec 2019. This choice
was motivated by a preference to have a single, uniÔ¨Åed catalogue
for selection of both candidate clusters and stellar sources (which
are used to deÔ¨Åne multi-scale associations; see Lee et al. 2021;
Larson et al. 2021). PSF-Ô¨Åtting source detection also takes full ad-
vantage of our high-resolution ùêªùëÜùëá imaging, de-blending closely
neighbouring sources in an optimal manner.

Source detection using DOLPHOT is governed by an extensive
set of parameters. A detailed list of the parameters used is given in
Appendix B (Table B1). BrieÔ¨Çy, we detect sources to the 3.5ùúé level
using simultaneous PSF-Ô¨Åtting on the individual exposure (*Ô¨Çc.Ô¨Åts)
images in all Ô¨Ålters. The drizzled ùêπ555ùëä (ùëâ) band image is used
as the positional reference for each target, meaning that exposure
level detections in ùêπ275ùëä, ùêπ336ùëä, ùêπ438ùëä, ùêπ814ùëä are joined
into a unique source list with sky positions based on the drizzled
ùêπ555ùëä world coordinate solution (WCS). Each detected source
is photometered in all the bands, with non-detections Ô¨Çagged. We
adopt the Tiny Tim PSF library (default within DOLPHOT) since
the DOLPHOT-speciÔ¨Åc implementation of Anderson PSFs (Ander-
son 2016, 2018) leads to systematic diÔ¨Äerences across the Ô¨Åeld
(A. Dolphin priv. comm.). DOLPHOT makes reÔ¨Ånements to the PSF
and implements aperture corrections based on a subset of well-
detected, isolated stars in each chip. Magnitudes are calibrated onto
the Vega system using STScI-supplied zeropoints in the image head-
ers. The photometric uncertainties reported by DOLPHOT tend to be
underestimated, as they do not account for the noise contributed by
neighbouring sources in crowded Ô¨Åelds (see Williams et al. 2014,
where it is shown that artiÔ¨Åcial star testing can be used to constrain
the true uncertainties).

DOLPHOT is run using a set of python wrappers originally devel-
oped for the LEGUS project (by PHANGS-HST member L. Ubeda),
and later adapted for PHANGS-HST (by D. Thilker). These wrap-
pers organize the data prior to photometry, generate a complete
parameter Ô¨Åle speciÔ¨Åc to the data set, and manage execution of the
DOLPHOT package codes.

We adopt the ùëâ-band DOLPHOT source list as our principal in-
ventory of astrophysical sources (clusters and stars) in each observed
target. Testing during pipeline development showed that occasional
high-conÔ¨Ådence clusters were not included in the DOLPHOT cata-
logue. In order to assess the degree to which DOLPHOT is eÔ¨Äective at
recovering clusters for our PHANGS-HST distance range, we match
the DOLPHOT catalogue against the LEGUS Class 1 and 2 cluster
population for NGC 628 (Adamo et al. 2017). We Ô¨Ånd that ‚àº 98%
of LEGUS clusters have a DOLPHOT source within 2 pixels, and for

4 Detailed completeness analysis of this sort will be included in a forth-
coming publication.

5 http://americano.dolphinsim.com/dolphot/

MNRAS 000, 1‚Äì30 (2021)

4

Thilker et al.

‚àº 80% the closest match is within 1 pixel. Given the methodolog-
ical diÔ¨Äerence in detection algorithms (LEGUS used SExtractor;
PHANGS-HST uses DOLPHOT), it is unsurprising that small po-
sitional shifts in the source positions are encountered at this level.
Because clusters with large angular sizes can be missed by
DOLPHOT, we also run the DAOStarFinder code (in astropy/
photutils), which is better suited to detecting extended objects.
DAOStarFinder employs a convolution-based source identiÔ¨Åcation
method, whereas DOLPHOT requires explicit local maxima. We adopt
a DAOStarFinder kernel with a FWHM of 2.5 pixels (0.1(cid:48)(cid:48), e.g.
slightly broader than the PSF, so as to emphasise extended objects),
and only add distinct new sources, plus those where the summed
DOLPHOT catalogue Ô¨Çux within 2 pixels is > 2.5√ó fainter than mea-
sured by DAOStarFinder. Typically only (cid:46) 1% of all eventual
candidate clusters originate from DAOStarFinder. The DOLPHOT
catalogue augmented by DAOStarFinder sources is referred to as
the PHANGS-HST ‚Äúall-source‚Äù detection list.

2.2 Aperture photometry using photutils
DOLPHOT is used only for source detection in our cluster pipeline6.
Once the all-source detection list (DOLPHOT+DAOStarFinder)
is ready, circular aperture photometry is performed using the
photutils python package.

Because most clusters appear round in ùêªùëÜùëá images, we mea-
sure photometry in a series of circular apertures with radii of 1.0,
1.5, 2.0, 2.5, 3.0, 4.0, 5.0 pixels. The background level is mea-
sured in a circular annulus 7‚Äì8 pixels away from the centre of each
source, then subtracted oÔ¨Ä. This is a fairly standard background
annulus when working in crowded Ô¨Åelds imaged with ùêªùëÜùëá (e.g.,
Sabbi et al. 2018), and balances the need to measure the back-
ground level close to each source while being suÔ¨Éciently distant
(‚âà 14 ‚àí 29 pc for typical galaxies in our sample) to minimise light
from the source itself within the background annulus. We estimate
the sky value as a robust median, using the sigma_clipped_stats
function to mitigate the inÔ¨Çuence of neighbours. The sigma-clipped
mean and standard deviation are also recorded by our pipeline, to
allow for investigation of inevitable systematic and random errors
in the adopted background. Calculations of the photometric uncer-
tainty follow the prescription of F. Masci7 with speciÔ¨Åc allowance
for spatially-correlated noise in the pixels of the source aperture and
sky annulus.

For sources selected as candidate star clusters (see Section 4),
the total magnitude in each Ô¨Ålter is determined by measuring the
Ô¨Çux in a 4 pixel radius (‚âà 12 pc at the median PHANGS-HST
galaxy distance) aperture, which captures ‚àº50% of the total Ô¨Çux,
and then applying an aperture correction (e.g., Adamo et al. 2017;
Cook et al. 2019).

A detailed description of how PHANGS-HST aperture correc-
tions are determined is given in Deger et al. (2021). BrieÔ¨Çy, human
inspection-based selection of an aperture correction sample (con-
sisting of highly conÔ¨Ådent clusters, compact associations, and stars)
in each target enables measurement of the correction for compara-
tively isolated sources. One of us (Bradley C. Whitmore, hereafter
BCW) inspects the drizzled image products before our pipeline run
and manually identiÔ¨Åes 10 sources of each cluster Class (1, 2, 3).

6 The DOLPHOT PSF-Ô¨Åtted magnitudes are used in a parallel pipeline devoted
to point sources.
7 Eq.
in
ApPhotUncert_corr.pdf

http://wise2.ipac.caltech.edu/staff/fmasci/

13

For each source, we compute aperture corrections to convert the
ùëü = 4 pixel (7‚àí8 pixel background annulus) ùëâ-band photometry
to an estimated total (sky-subtracted at ùëü = 20‚àí21 pixel) magni-
tude. Rather than letting the relative aperture correction between
bands Ô¨Çoat on a galaxy-by-galaxy basis, which would add noise, we
normalise our average aperture corrections as oÔ¨Äsets with respect
to the measured ùêπ555ùëä aperture correction in each target. These
normalised corrections versus band are then combined into a mean
survey-wide aperture correction oÔ¨Äset table, after outlier rejection.
For each galaxy we then adopt the Ô¨Ånal aperture correction as the
galaxy-speciÔ¨Åc ùêπ555ùëä value plus the survey-wide oÔ¨Äsets for other
bands. The oÔ¨Äsets are ‚àí0.19, ‚àí0.12, ‚àí0.03, 0.00, ‚àí0.12 mag in
ùêπ275ùëä, ùêπ336ùëä, ùêπ438ùëä, ùêπ555ùëä, and ùêπ814ùëä, respectively. For
the galaxies processed at this time, the ùêπ555ùëä aperture corrections
range from 0.6 to 0.85 mag.

We refer to the complete photometric database resulting from
these measurements as the ‚Äôall-source‚Äô catalogue, to which morpho-
logical information (e.g. MCI) is later added (Sec. 4.2.1).

3 CREATION OF SYNTHETIC CLUSTER MODELS

The selection of candidate star clusters from a larger source cata-
logue that includes individual stars, chance super-positions, back-
ground galaxies, etc. is critical for the study of cluster populations
in nearby galaxies. Much of our new approach to cluster selection
(Sec. 4) uses morphological metrics determined from both synthetic
clusters and previously identiÔ¨Åed (real) clusters. Synthetic clusters
also provide an estimate of the true photometric uncertainties and
any biases in the measurements. This Section describes a database
of synthetic cluster models which are used for these purposes, and
will be helpful for future studies.

3.1 Overview of the synthetic cluster database

Synthetic cluster sources are added to the ùëâ-band image for each
target galaxy, since these images are the ones used for source detec-
tion and cluster selection. The procedure is generalized suÔ¨Éciently
that we can easily add artiÔ¨Åcial sources to any PHANGS-HST band,
although this is not currently implemented in the pipeline. However,
we envision future work along these lines for the purpose of ma-
chine learning cluster classiÔ¨Åcation training (e.g. Wei et al. 2020,
Whitmore et al. 2021).

Random positions which are uniformly distributed are gen-
erated for the synthetic clusters. We considered using positions
weighted to the observed source locations, but decided against it so
that this step can be run independently from the rest of the pipeline.
Note that if positionally-weighted properties are desired for the syn-
thetic clusters, these can be selected post-facto. The location of a
cluster inÔ¨Çuences detectability and photometric scatter/bias (with
objects in complex and/or high background regions of a galaxy be-
ing harder to identify and measure than those in uncrowded and/or
faint environments). Thus for future catalogue completeness anal-
ysis (beyond the scope of the current paper) we expect to impose
such post-facto positional weighting.

Our fundamental goal in this portion of the pipeline is to gen-
erate a database of synthetic sources which adequately covers the
plausible range of parameters expected for clusters in the PHANGS-
HST imaging. This implicitly means we need to sample the age‚Äì
mass plane, range of ùê¥ùëâ values and all plausible morphologies, and
add enough realisations of clusters with a given set of parameters to
fully represent the galactic environment and quantify the measured

MNRAS 000, 1‚Äì30 (2021)

scatter in morphological metrics. To the degree that the entire clus-
ter parameter space is represented in a target‚Äôs source population,
the locus traced by morphological metrics most frequently seen in
our synthetic database should resemble the observed distribution of
conÔ¨Årmed clusters. Even so, we stress that our aim in the current
paper is not to forward-model predict the expected distribution of
metrics for a hypothetical cluster population, but rather to delineate
the bounds of the distribution containing objects of interest.

We assign physical characteristics (age, mass, ùê¥ùëâ , and mor-
phology) to each synthetic cluster, to enable completeness studies
(as a function of cluster type) and build a foundation for the forward-
modelling framework alluded to above. We permit ages log(ùë°) = [6.0,
6.5, 7.0, 7.5, 8.0, 8.5, 9.0] yr and extinction values of ùê¥ùëâ = [0.0, 0.25,
0.5] mag (in addition to Milky Way foreground), plus a wide range
of MoÔ¨Äat proÔ¨Åles which sample intrinsic size and radial shape; see
Sec. 3.2 for details. The chosen limits of our model parameter space
cover the vast majority of clusters found in nearby galaxies, with
the particular exception of the very youngest, still embedded pop-
ulation. These particularly elusive, dust-enshrouded clusters (e.g.
Lada & Lada 2003) will be one focus of our approved JWST pro-
gram (GO-2107) targeting half of our PHANGS-HST sample. Their
expected numbers are uncertain and highly dependent on environ-
ment (Romita et al. 2016). For each combination of age, ùê¥ùëâ , and
morphology, we generate 1000 cluster realisations from a Ô¨Çat mass
distribution between 103 to 105 ùëÄ(cid:12), sampling every 102 ùëÄ(cid:12). Fixed
step sizes in age, mass, ùê¥ùëâ are used for convenience. If we eventu-
ally further explore forward-modelling applications (as mentioned
above), we would then likely switch to randomized sampling to
eliminate any possibility of unwanted biases. Population synthesis
models within CIGALE (Boquien et al. 2019) are used to predict the
ùëâ-band magnitude for each synthetic cluster, based on its assigned
age, mass, and ùê¥ùëâ . In this way, we establish consistency between
our synthetic clusters and the SED-Ô¨Åtting (Turner et al. 2021) of the
PHANGS-HST pipeline. In total, we inserted some 4.5+ million
synthetic clusters in each PHANGS-HST target, 200 objects at a
time, simulating diverse cluster morphologies accounting for the
PSF and incorporating Poisson noise on a pixel-by-pixel basis as
described in Sec. 3.2 and 3.3. The same procedure used to determine
photometry of real sources is applied to the synthetic ones.

3.2 MoÔ¨Äat model

We adopt MoÔ¨Äat proÔ¨Åles to represent our synthetic clusters, since
these give a particularly good Ô¨Åt to the measured proÔ¨Åles of young
clusters. This choice is well-supported by observational studies (e.g.
Elson et al. 1987; Larsen 1999; McLaughlin & van der Marel 2005),
although there are other reasonable options like King models (King
1962, 1966). To reduce computational burden, our MoÔ¨Äat models
are circularly symmetric, though in future work we may include
asymmetric synthetic cluster models as they would be a superior
representation of Class 2 clusters found observationally. Our model
based selection (Sec. 4.2.2) is ‚Äòloose‚Äô enough that we do not expect
to be biasing against Class 2 objects in the present work. However,
if we later attempt forward-modelling of the cluster population, this
complexity should be included.

The MoÔ¨Äat surface brightness proÔ¨Åle is given by:

ùúá(ùëü) = ùúá0

(cid:16)1 + ùëü2/ùëé2(cid:17)‚àíùúÇ

,

where ùúá0 is the central surface brightness, ùëé is a characteristic
radius, and ùúÇ is the power-law exponent of the proÔ¨Åle wings. Note
that ùúÇ is equal to ùõæ/2 in equation (1) of Elson et al. (1987). As

MNRAS 000, 1‚Äì30 (2021)

Star Cluster IdentiÔ¨Åcation in PHANGS-HST

5

ùúÇ approaches inÔ¨Ånity the MoÔ¨Äat proÔ¨Åle becomes a Gaussian. The
characteristic radius can be expressed as a function of full-width-
half-max (FWHM) and ùúÇ:
(cid:16)21/ùúÇ ‚àí 1(cid:17)‚àí1/2

ùëé =

.

FWHM
2

Studies of clusters in nearby galaxies typically measure the
eÔ¨Äective radius ùëüeÔ¨Ä, which is deÔ¨Åned to be the radius of a circle
containing half the integrated light of the model. For a MoÔ¨Äat
proÔ¨Åle, ùëüeÔ¨Ä is given by:

ùëüeÔ¨Ä = ùëé

(cid:16)

(1/2)

1

1‚àíùúÇ ‚àí 1(cid:17)1/2

,

which is only valid for ùúÇ > 1.0. Although the eÔ¨Äective radius
is undeÔ¨Åned for ùúÇ (cid:54) 1.0, and the integral of the proÔ¨Åle inÔ¨Ånite,
the MoÔ¨Äat parameterisation can still be evaluated (and matching
cluster morphologies observed) for this regime. In the real-world
case it simply means that the cluster proÔ¨Åle is truncated or lost to
the background at some large radius.

The parameter space of circular MoÔ¨Äat clusters spans core size
(via ùëé or FWHM) and halo power-law slope (via ùúÇ). We adopted 8
values of ùúÇ (= 0.75, 0.875, 1.0, 1.25, 1.5, 2.0, 3.0, 4.0) and pre-PSF-
convolution FWHM ranging from 0.5 to 7.0 pix, with step sizes
of 0.25 pix. In total, taking all permutations across this parameter
space, we allow for 216 (8√ó27) distinct cluster morphologies. Mod-
els with high ùúÇ values (e.g. 3, 4) have minimal halo structure, and are
dominated by their progressively Gaussian core. Conversely, low ùúÇ
values correspond to very ‚ÄòÔ¨ÇuÔ¨Äy‚Äô cluster morphologies. Guiding the
choice of minimum cluster core FWHM for our models, paramet-
ric Ô¨Åtting studies of marginally resolved stellar clusters have shown
that reliable structural parameters can be obtained for eÔ¨Äective radii
approaching down to 10‚àí20% of the PSF FWHM, dependent on
signal-to-noise and cluster morphology (e.g. Larsen 1999; Ryon
et al. 2017; Brown & Gnedin 2021). We expect to have a mor-
phological limit of ùëüeÔ¨Ä ‚àº 1 pc at 16 Mpc (median PHANGS-HST
distance, Anand et al. (2021)) with WFC3/UVIS.

3.3 Model realisation

Regardless of our particular choice for parameterising the structure
of model clusters, we require a method to generate and realisti-
cally insert them into the observations in a way that mirrors the
observational strategy (e.g. multiple exposures, dithering) and in-
strumental characteristics (e.g. resolution, noise). It is particularly
important that the intrinsic cluster proÔ¨Åle be convolved with the PSF.
The assumed PSF is adopted from the empirically determined PSF
products of J. Anderson, using a PSF representation appropriate to
the centre of the WFC3/UVIS camera Ô¨Åeld of view8 9. This choice
allows the synthetic cluster database to be generated in advance of
cluster detection/selection pipeline runs.10

Although it was developed to study galaxy morphology via
parametric model Ô¨Åtting, IMFIT (Erwin 2015) is well suited for
our purpose of generating PSF-convolved models, especially as the
package includes MoÔ¨Äat model capabilities. It is adopted for the
initial steps of our cluster model realisation process (the stages of
generating the intrinsic structure and convolving with the PSF),

8 https://www.stsci.edu/~jayander/STDPSFs/
9 https://www.stsci.edu/hst/instrumentation/wfc3/
data-analysis/psf
10 In later versions of our cluster catalogue we may adopt the PSF deter-
mined by DOLPHOT instead of generic representations.

6

Thilker et al.

Figure 1. Flowchart summarising the PHANGS-HST source detection, photometry, cluster candidate selection, and classiÔ¨Åcation process.

then a custom python script is used to do the remaining tasks,
including adding noise, reprojecting exposure-level models to the
drizzled grid, coadding, and Ô¨Ånally adding the synthetic clusters to
the PHANGS-HST images.

Images of real clusters may or may not be centred at the centre
of a pixel. To account for this eÔ¨Äect, which can become important
for compact clusters, for each ‚Äòbatch‚Äô of clusters that is inserted
into an image, we adopt one of Ô¨Åve diÔ¨Äerent centres oÔ¨Äset from the
pixel centre by (0.0, 0.0), (0.25, 0.25), (0.5, 0.5), (0.25, 0.0), and
(0.5, 0.0), to allow the centres to range from the centre to a pixel
edge. Provided our step size is suÔ¨Éciently Ô¨Åne, these oÔ¨Äsets are
suÔ¨Écient to represent any actual cluster centre, as all other oÔ¨Äset
choices are equivalent via reÔ¨Çection and rotation.

For each batch of 200 synthetic clusters, of Ô¨Åxed age, ùê¥ùëâ ,
FWHM, ùúÇ, and subpixel location, we use IMFIT to generate a noise-
free MoÔ¨Äat model using factor of 4 oversampling. The Anderson

PSF appropriate to the Ô¨Ålter and camera of the synthetic run (in our
case ùëä ùêπùê∂3/ùëàùëâ ùêºùëÜ/ùêπ555ùëä almost always) is convolved with the
model to produce a noise-free template synthetic cluster (still over-
sampled by a factor of 4) for each of our dither positions (generally
three). Next we use these to generate native-scale (0.03962(cid:48)(cid:48)/pix)
models (again one per dither position / ùêªùëÜùëá exposure) which were
subsequently scaled to the integrated intensity corresponding to
the adopted mass [magnitude, see beginning of this Section], inde-
pendently per cluster. At this point we compute a Poisson variate
for every signiÔ¨Åcant pixel in the penultimate Ô¨Çc-exposure-level-
appropriate model realisations, in a manner that accounted for the
local area speciÔ¨Åcally around each cluster position as recorded in
the unmodiÔ¨Åed image. Finally, we co-add the noisy models (per
cluster) and add the result to the drizzled ùëâ-band image.

MNRAS 000, 1‚Äì30 (2021)

4 CLUSTER CANDIDATE SELECTION CRITERIA

4.2 Morphology criteria: Multiple Concentration Index

Star Cluster IdentiÔ¨Åcation in PHANGS-HST

7

Our cluster candidate selection method was developed with the goal
of maximising completeness and minimising contamination. Our
criteria include cuts on: (1) data-quality and photometric measures
(Sec. 4.1, e.g. number of bands with acceptable photometric error,
ùëâ-band S/N, absolute ùëâ-band magnitude, and crowding) and (2)
novel morphological metrics, MCIin, MCIout (Sec. 4.2), as guided
by synthetic cluster modelling (Sec. 4.2.2) and published cluster
catalogues (Sec. 4.2.3). We also impose selection rules to: (3) guar-
antee candidate inclusion of sources too luminous to be ordinary
stars (Sec. 4.3), and (4) to eliminate double counting associated
with instances of overly aggressive source deblending (Sec. 4.4).

In Fig. 1, we present an overview of the cluster identiÔ¨Åca-
tion pipeline, beginning with the source detection and photometry
phases already described in Sec. 2, continuing to the subsequent
cluster candidate selection phase which is the topic here, and ending
with the classiÔ¨Åcation phase that yields our Ô¨Ånal cluster catalogue.
We position this Ô¨Ågure prior to describing details of selection, so
that it is easier for the reader to obtain an understanding of the over-
all method and speciÔ¨Åcally how the pieces Ô¨Åt together. We direct the
reader to a fully comprehensive Ô¨Çow chart for the entire PHANGS-
HST survey (thus also including multi-scale asssociations) in Fig. 5
of Lee et al. (2021). Our Fig. 1 represents a more detailed view at the
data Ô¨Çow and logical path required for the cluster-speciÔ¨Åc aspects
of the overall project.

4.1 General candidate selection criteria

We begin with the set of sources detected by DOLPHOT, and im-
pose a limit of S/N (cid:62) 5 and crowding (cid:54) 0.667 mag (rationale
on this in Sec. 4.4) for a source to enter cluster candidate process-
ing. DAOStarFinder then adds in a very limited number of objects
missed by DOLPHOT, meeting the conditions for augmentation de-
scribed at the end of Section 2.1. Imposition of the DOLPHOT
S/N (cid:62) 5 cut (even though our cluster candidate sample selection
later demands S/N (cid:62) 10) excludes potentially unreliable compact
sources from the determination of whether a given DAOStarFinder
detection should be added to the all-source detection list, or if it was
already preferentially well split into two or more DOLPHOT de-
tections of reasonable quality. Next, aperture photometry and MCI
computation is conducted for each source. From the resulting com-
bined ‚Äúall-source catalogue‚Äù (= bright+uncrowded DOLPHOT plus
DAOStarFinder), we cull out poorly measured sources by requir-
ing detections in (cid:62) 3 bands with photometric error (cid:54) 0.3 mag. We
further require that V is one of these bands. These general criteria
reduce the all-source catalogue to only ‚àº 4‚àí9% of its initial entries.
As described below, we further down-select this subset by consid-
ering two populations: (1) typical sources which meet a full set of
morphological criteria (see Sec. 4.2) and (2) those that are so bright
they are surely clusters or artefacts (brighter than the Humphreys‚Äì
Davidson (H-D) limit, Humphreys & Davidson 1979), for which we
impose a more lenient set of criteria (see Sec. 4.3).

DOLPHOT‚Äôs goodness of (PSF-)Ô¨Åt metric (ùúí2) and sharpness
parameter are both limited to the inner portion of sources ((cid:54) 3
pixels for ùúí2, and the central pixel alone for sharpness), which is
not ideal for selecting sources broader than the PSF. For this reason
we do not use these quantities for candidate cluster selection.

MNRAS 000, 1‚Äì30 (2021)

(MCI)

One of the primary aims of our study is to improve on the cluster
selection methodology used in previous studies, which has mostly
relied on a single concentration index (CI, e.g. Holtzman et al. 1992;
Whitmore et al. 1993; Adamo et al. 2017; Cook et al. 2019). High-
resolution ùêªùëÜùëá images of clusters in galaxies at distances between
‚àº 5‚àí25 Mpc allow for constructing maximally-informative (though
still azimuthmally-averaged) constraints on cluster morphology, en-
abling more robust discrimination of point-like or cluster-like ap-
pearance than has been done to date.

We compute Multiple Concentration Index (MCI) metrics to
probe radial proÔ¨Åle shape over a wide range of distance from a
source. These metrics allow us to compare the shape to that of a
Ô¨Åducial cluster morphology (via the speciÔ¨Åc choice of normalisa-
tion constants). In the subsections below, we formally deÔ¨Åne the
MCIin and MCIout parameters used in our cluster candidate selec-
tion method, give examples of how cluster morphology varies with
location in the MCI plane, and provide motivation for the area(s) of
the MCI plane in which candidates are selected.

4.2.1 DeÔ¨Ånitions and examples

Our MCI metrics are based on the concentration index concept
(which by itself is a reformulation of curve-of-growth analysis),
although we take advantage of many independent measures of CI
(each based on a diÔ¨Äerent pair of radii), rather than a single CI mea-
sure. To simplify the interpretation, we re-normalise the CI with
respect to a Ô¨Åducial cluster (of Ô¨Åxed angular size), so that the nor-
malised CI (NCI) indicates whether the source surface brightness
proÔ¨Åle is steeper or Ô¨Çatter than the Ô¨Åducial one at the measured
radii. SpeciÔ¨Åcally, for radii ùëñ and ùëó we deÔ¨Åne:

NCI(ùëñ, ùëó) = 1 ‚àí

CI(ùëñ, ùëó)
CI(ùëñ, ùëó)Ô¨Åducial

We adopt a mildly extended cluster morphology as our Ô¨Åducial
cluster model, with pre-PSF-convolution FWHM of 2 pixels and ùúÇ =
3. The choice is arbitrary, as a diÔ¨Äerent morphology for the Ô¨Åducial
cluster would lead to systematically diÔ¨Äerent extent and scatter in
the resulting observed NCI (eventually MCI) distribution, but these
changes would also correspondingly change the MCI distribution
of our entire synthetic cluster database (used below to deÔ¨Åne the
selection region) and the observed source distribution against which
it is compared. It is important to note that the sense of compactness
used here is reversed when compared with the traditional measure
of CI (1 pixel to 3 pixel), with higher NCI values indicating a more
concentrated (star-like) object.

In order to allow readers to use our methods without generating
synthetic Ô¨Åducial clusters, in Table 1 we provide representative nor-
malisation constants required to compute NCI values from observed
concentration indices. In practice within our pipeline, we compute
constants speciÔ¨Åcally for each galaxy (observed Ô¨Åeld) using 21,000
Ô¨Åducial morphology clusters fully sampling all permutations of age,
mass, ùê¥ùëâ from the synthetic cluster database described in Sec. 3.
The constants diÔ¨Äer very little amongst galaxies, except for those tar-
gets with data (in ùëâ-band) from ACS/WFC rather than WFC3/UVIS.
Because the NCI values are normalised, we can combine mul-
tiple NCI values into a summary metric to reduce the ‚Äònoise‚Äô in the
measured proÔ¨Åles, and thereby mitigate the impact that an image
artefact or nearby object could have on any single NCI measure.

8

Thilker et al.

Figure 2. The inter-relation between cluster appearance, proÔ¨Åle shape, curve of growth, NCI values, MCI, and ultimately position of diÔ¨Äerent characteristic
morphologies in the MCI plane. Line and marker colours in each panel are linked to the colour of the box outlying each synthetic cluster image shown. In
order to obtain MCIin and MCIout for any source, (top left panel) we Ô¨Årst measure curve of growth photometry and then convert these measurements to CI
values. (bottom left) We re-normalise the CI values with respect to the adopted Ô¨Åducial cluster to obtain NCI and subsequently average NCI values for adjacent
positions within the radial proÔ¨Åle to obtain MCI metrics. (right) The MCI plane position for a source is thereby linked to how locally steep or shallow the
proÔ¨Åle appears with respect to the Ô¨Åducial morphology. See the text for a complete description. Synthetic clusters used for this Ô¨Ågure only are idealized in the
sense that they are noise-free and were not inserted into our ùêª ùëÜùëá images. Note that the images of model clusters are scaled from zero to their maximum value,
so as to enable relative morphological comparison.

Table 1. Representative normalisation constants for transforming CI to NCI

We deÔ¨Åne the Multiple Concentration Index (MCI), for radius pairs
(ùëé, ùëè), (ùëè, ùëê), (ùëê, ùëë), as:

Quantity

ùëñ
(pix)

ùëó
(pix)

CI(ùëñ, ùëó)Ô¨Åducial value

CI(1.0, 1.5)
CI(1.5, 2.0)
CI(2.0, 2.5)
CI(2.5, 3.0)
CI(3.0, 4.0)
CI(4.0, 5.0)

1.0
1.5
2.0
2.5
3.0
4.0

1.5
2.0
2.5
3.0
4.0
5.0

0.746
0.447
0.288
0.186
0.201
0.0858

Note: Listed values (CI(ùëñ, ùëó)Ô¨Åducial) are concentration indices appropri-
ate for the Ô¨Åducial cluster morphology (pre-PSF-convolution FWHM of
2 pixels and ùúÇ = 3). ùëñ and ùëó are the aperture radii for the small and large
(respectively) circular apertures used for each CI. We insert 21,000 real-
isations of the Ô¨Åducial cluster spanning our synthetic parameter space of
age, mass, ùê¥ùëâ into all galaxies of our sample and then take the median
of the measured CI values to produce this table. For reference, the stan-
dard CI(1.0,3.0) typically used by previous studies has a value of 1.67
for the Ô¨Åducial cluster morphology.

MCI = [NCI(ùëé, ùëè), NCI(ùëè, ùëê), NCI(ùëê, ùëë)] ,

where the overline notation indicates averaging.

In Section 2.2, we described our circular aperture photometry
employing a series of aperture radii (in particular, 1.0, 1.5, 2.0, 2.5,
3.0, 4.0, 5.0 pixels). We use these measurements to construct two
independent MCI metrics, MCIin and MCIout. For MCIin we take
radii 1.0, 1.5, 2.0, 2.5 as ùëé, ùëè, ùëê, ùëë in the expression above. MCIout is
based on photometry with aperture radii of 2.5, 3.0, 4.0, 5.0 pixels.
As such, MCIin probes the inner portion of a source (out to ùëü ‚âà 0.1(cid:48)(cid:48)
or 1 resolution element for ùêªùëÜùëá), dominated by the cluster core at
the distances of our target galaxies, whereas MCIout traces the faint
outer, low surface brightness structure of a source.

The plots in Fig. 2 illustrate how steep the local radial proÔ¨Åle of
a source is compared to the Ô¨Åducial cluster model, based on the MCI
metrics. Our aperture photometry is Ô¨Årst used to create curves of
cumulative Ô¨Çux versus aperture radius (interior to the sky annulus),
as shown by the dashed curves in the upper left panel. Synthetic
models for Ô¨Åve clusters are compared, including the Ô¨Åducial model

MNRAS 000, 1‚Äì30 (2021)

(green), two with pre-PSF-convolution FWHM 1 pix (blue with
ùúÇ = 4, purple with ùúÇ = 0.75), and two with FWHM of 4 pix (red
with ùúÇ = 4, yellow with ùúÇ = 0.75). Images of these cluster realisa-
tions are shown in the right panel. The blue boxed model is barely
resolved, and is the closest to a point source, but nevertheless can be
distinguished as a cluster given suÔ¨Écient signal-to-noise. For this
demonstration no Poisson noise was incorporated, and the images
have been scaled linearly from 0.0 to their respective maximum val-
ues. In the upper left panel, we further show the photometry after
conversion into a series of CI values (again as a function of radius)
as the solid lines. The ‚Äòbump‚Äô at ùëü = 3.5 pix is due to the Ô¨Årst
aperture radii pair with separation of 1.0 pix rather than 0.5 pix, as
used near the centre. In the lower left panel, the CI are Ô¨Årst nor-
malised against the Ô¨Åducial cluster, introducing the sense of local
slope with respect to this mildly extended source. Positive values
of NCI (MCI also) indicate progressively steeper proÔ¨Åles, whereas
negative NCI values happen whenever the source proÔ¨Åle is shallow
compared to the Ô¨Åducial. To obtain MCIin and MCIout we average
the three adjacent NCI values (each) as speciÔ¨Åed above. MCI in the
lower left plot is marked only for the radial range probed by each
of the inner and outer metrics. In the right panel, we show the MCI
plane, marking the position of each model in this morphologically
indicative space. Note the Ô¨Åducial (green) is at (0, 0), by deÔ¨Ånition.
The position of a cluster in the MCI plane is largely dependent on
the size of the source, here represented by the pre-PSF-convolution
FWHM. Large sources are in the lower left and small in the upper
right. However, the assumed halo slope in the outer portion of a
cluster can have a signiÔ¨Åcant inÔ¨Çuence on the MCI plane position
for Ô¨Åxed FWHM, most signiÔ¨Åcantly for intrinsically small sources
in which the halo is able to skew the MCIout and MCIin values.
Note the large shift in MCIin and MCIout for the purple cluster in
comparison to the blue one (with a steep, i.e. insigniÔ¨Åcant, halo). By
the time a source is quite extended even in its core, changes in halo
slope only induce shifts in MCIout (see red versus yellow cluster).
The illustration of Fig. 2 is idealised. In real observed clusters,
in addition to the inÔ¨Çuence of noise, both source crowding and a
variable diÔ¨Äuse environment can perturb the MCI measurements
away from expectations for a cluster of given intrinsic morphology.
As our circular aperture photometry does not (yet) include masking
of neighbour sources, or a sloped sky estimate, we account for this
by inserting our synthetic clusters of varied size and morphology ‚Äì
not just the Ô¨Åducial chosen for MCI normalization ‚Äì in the actual
ùêªùëÜùëá ùëâ-band images of each sample galaxy. The outcome of such
analysis is discussed in detail in Sec. 4.2.2, but we Ô¨Årst conclude
the introduction to MCI with a discussion of the typical source
distribution in the observed MCI plane.

In the left panel of Fig. 3 we show the distribution of measured
MCIin versus MCIout values for all sources with S/N (cid:62) 10 in our
NGC 628-C Ô¨Åeld (see Sec. 6 for a description of these data). We
also identify the expected location of point-like sources (towards
the upper right) and extended sources in this plane. Note the largely
bimodal distribution, with a strong density of points with positive
MCI values (corresponding to stars) and a broad distribution of
points dominating the remainder of the plot (including, but not lim-
ited to, clusters). Within this broader distribution, a ridge extending
diagonally down and to the left from the location of point-sources is
often evident. Note the distribution of scattered sources around the
ridge of extended points. This scatter is found in all of our Ô¨Åelds,
and is due to contaminants, such as close pairs of stars, diÔ¨Ärac-
tion spike artefacts, and local maxima in diÔ¨Äuse regions. The right
panel in Figure 3 shows the same data as in the left panel, but now
colour-coded by the traditional measure of CI, which has a range

MNRAS 000, 1‚Äì30 (2021)

Star Cluster IdentiÔ¨Åcation in PHANGS-HST

9

of ‚àº 1.2 (dark blue) to 2.3 (reddish-brown) in our ùêªùëÜùëá images.
The LEGUS project typically used a value of CI = 1.3 to separate
cluster candidates (> 1.3) from stars (CI (cid:54) 1.3). In our plot, this
CI cut corresponds to the dark blue colour. We show the images of
four hand-selected clusters from NGC 628 in the right hand panel
of Fig. 3 and mark their position with star symbols, to illustrate
the systematic change in cluster morphology as a function of MCI
plane position.

The set of sources plotted in Fig. 3 is intended to be limited
to those for which MCIin and MCIout can be well-measured (e.g.
(cid:54) 10% error). This is generally achieved for sources with ùëâ-band
S/N (cid:62) 10, so we opted to display those data points in this Ô¨Ågure.
Nevertheless, for our morphology-based cluster candidate selection
we further impose limits on MCI statistical error (MCIin,err (cid:54) 0.3,
MCIout,err (cid:54) 1.0) alongside the S/N (cid:62) 10 cut.11 12

4.2.2 MCI selection: guidance from synthetic clusters

In this Section, we investigate the location of realistic, synthetic
clusters in the MCI plane. This is done in order to guide our selec-
tion of actual cluster candidates using the MCI metrics. In Fig. 4
we show the measured values of MCIin and MCIout for thousands
of realisations of diÔ¨Äerent MoÔ¨Äat parameter permutations, span-
ning a range of FWHM and power-law halo slope. The set of plot-
ted synthetic clusters has been conÔ¨Åned to the magnitude range
of ùëö(ùëâ) = 22 ‚àí 24, in order to probe the faint end range of clus-
ter magnitudes (thus the most typical population) in PHANGS-HST
galaxies. The MCI plane position depends systematically on FWHM
and ùúÇ, while scatter, for a constant distribution of masses, increases
signiÔ¨Åcantly for decreasing values of ùúÇ (Ô¨Çatter halo slopes) at Ô¨Åxed
FWHM and less so for increasing FWHM at Ô¨Åxed ùúÇ. For relatively
steep halo slopes (ùúÇ (cid:62) 1.5), the scatter in this magnitude range
is acceptably small to distinguish between cluster morphologies.
However, it is clear (in the right hand panel) that for shallow slopes
and large core size clusters the MCI plane scatter eventually renders
the metrics less useful. This is due to two reasons: (1) for this set
of synthetic clusters the surface brightness above the background
becomes very low, and (2) the range of cluster-centric radii probed
by MCIin and MCIout fails to sample an informative portion of the
radial surface proÔ¨Åle. In brighter magnitude ranges, such shallow
slopes and large core size clusters do become well characterised
in the MCI plane. This observation suggested to us that the set of
synthetic clusters used to inform cluster candidate selection criteria
should be pared down from the complete grid that was originally
computed.

SpeciÔ¨Åcally, we sought to delineate those regions in the MCI
plane in which clusters could: (1) plausibly exist and (2) likely be
detected by our observations. This knowledge would then most ef-
fectively guide our selection of cluster candidates. We emphasise
that a realistic prediction of the cluster population (linked to ex-
pectations for the mass function, age distribution and size‚Äìmass
relationship), subsequently used to establish selection regions in

11 These MCI error and S/N (cid:62) 10 cuts do not apply to the super H-D
sources described in Sec. 4.3.
12 We note that MCI error and signal-to-noise are highly correlated. In
future works we may consider only using a limit on S/N rather than in
combination with limits on MCIin and MCIout error. As it turns out, our
present MCI error limits tend to preclude potential candidates even before
S/N = 10 is reached. When assessing whether to make a change in our
selection criteria, we will also need to consider that MCI error can be
inÔ¨Çated at Ô¨Åxed cluster magnitude due to a crowded, complex environment.

10

Thilker et al.

Figure 3. (Left) The MCI plane distribution of detections in our all-source catalogue for the NGC 628-C Ô¨Åeld with ùëâ -band S/N (cid:62) 10. The distribution reÔ¨Çects
the population of stars, clusters, and contaminants. Stars are largely separated to the upper right, but the contribution of clusters is not as tightly deÔ¨Åned. (Right)
The same plot on the left except coloured by CI. Cutout images of actual NGC 628-C clusters linked to their MCI plane location (with star symbols) have been
overlaid on the right panel. As opposed to Fig. 2, here the actual clusters are all displayed as observed, not rescaled according to their maxima (such as was
done for the synthetic clusters in the previous plot).

the MCI plane, is a disfavored method because this would create a
selection bias tending to produce an observed sample in agreement
with our prior notions.

We use what we call ‚Äúhit maps,‚Äù generated at a series of binning
resolutions (0.01, 0.02, 0.04, in both MCIin and MCIout), to iden-
tify the MCI plane regions in which to accept cluster candidates.
Displayed in Fig. 5, these hit maps are essentially histograms of
the number of model clusters in the entire synthetic object database
meeting existence and detection criteria, which are then processed
to produce region boundaries at each MCI plane resolution. During
processing these histograms Ô¨Årst become a binary mask ‚Äì we de-
mand at least 9 models per bin to register as a hit (mask value of
1 rather than 0) at the associated bin position. This guards against
noisy boundaries, since Poisson event counting makes such bins sig-
niÔ¨Åcant at the 3ùúé level. Such bins are saturated light grey in the plots
of Fig. 5. To further mitigate noise, we then erode and dilate the
hit map before contouring to obtain the bin-resolution-dependent
model cluster region boundaries. This process is completed sepa-
rately for each target, using the speciÔ¨Åcs of the observations.

The existence and detection criteria13 are: (ùëüeÔ¨Ä (cid:54) 10 pc) &
(Œ† (cid:62) 3 | log(age) (cid:54) 7) & (average background-subtracted surface
brightness inside a radius of 2.5 pixels exceeding 0.04 e‚àí/sec).
The Ô¨Årst two criteria ensure we only sample physically plausible
clusters. In the expression, ‚Äúboundedness‚Äù (in a statistical sense, not
necessarily for a speciÔ¨Åc object) is deÔ¨Åned with the Œ† ratio (= age
/ crossing time, see Gieles & Portegies Zwart 2011 where crossing
time is estimated by assuming virial equilibrium) . We take along
cluster models of all ages, though for ages greater than 10 Myr we

13 Our formulation of the criteria is written using logical operators &
(‚ÄòAND‚Äô) and | (‚ÄòOR‚Äô). When interpreting the expression, please be aware of
this notation.

require additionally that Œ† (cid:62) 3 (in order to keep synthetic clusters
in this post-natal age range which have an appearance/structure and
age suggesting they are likely bound). For models younger than 10
Myr we make no such cut, since in this regime it is more diÔ¨Écult
to distinguish bound from unbound objects without high-resolution
spectroscopic observations. The last criterion we check (minimum
allowed surface brightness) is based on inspection of the distribution
of this same quantity in all LEGUS cluster catalogues, and meeting
this cut suggests detectability in our imaging since the data from
both surveys are comparable in depth.

The end result of the steps we just described is a set of ‚Äòmodel
cluster regions‚Äô in the MCI plane, generated speciÔ¨Åcally for each
target/observation and at three incrementally decreasing resolutions.
The decreasing resolutions (increasing bin size) create nested model
cluster regions (blue and magenta curves in Fig. 5), each of which
adds a peripheral MCI zone of lower likelihood for viable cluster de-
tections (though to zeroth order only, as we generate them intention-
ally neglecting prior knowledge about typical cluster populations).
Though not illustrated here, since we show only the NGC 628 central
Ô¨Åeld (NGC 628-C), these regions vary systematically with distance
to the target. We return to this issue in Sec. 4.2.3, while discussing
semi-empirically determined selection regions.

Of key importance, we clarify that the model cluster regions
were generated using synthetic clusters that approach a point-like
appearance (minimum allowed pre-PSF-convolution FWHM of 0.5
pixel), and due to measurement error / environmental confusion,
they contain the portion of the MCI plane in which point-sources
dominate. We allow such models to establish realistic expectations
for which comparatively small clusters remain adequately distin-
guishable from stars. However, it also means that we must take
measures to exclude stars from our selection. We initially exper-
imented with IMFIT-generated point source models inserted into
the drizzled mosaic and generating model star regions, analogous

MNRAS 000, 1‚Äì30 (2021)

Star Cluster IdentiÔ¨Åcation in PHANGS-HST

11

Figure 4. Bag plots illustrating the location of synthetic clusters in the MCI plane as a function of pre-PSF-convolution FWHM and halo slope (ùúÇ). From left
to right, panels show models with ùúÇ = 4.0, 2.0, 1.0. In each panel, the transparent points are coloured according to FWHM, ranging from FWHM = 1, 3, 5, 7
pixels (purple, blue, green, orange). This Ô¨Ågure only shows synthetic clusters with ùëö(ùëâ ) = 22‚àí24. The inner polygon drawn for each (FWHM, ùúÇ) combination
is the ‚Äòbag‚Äô containing ‚àº 50% of the clusters, whereas the outer dashed ‚Äòloop‚Äô indicates the region beyond which only outlier clusters are found. To the degree
that bag plots are the bivariate equivalent of box plots, outliers can be thought to have coordinates more than 1.5√ó the inter-quartile range outside of the
25th-to-75th percentile zone. For a univariate normal distribution, this corresponds to the ‚àº 2.7ùúé level. The black dots mark the centre of each distribution.

Figure 5. Hit maps computed for synthetic clusters in NGC 628-C, binned at diÔ¨Äerent resolutions 0.01, 0.02, 0.04, and used for the determination of model
cluster regions (curves) in the MCI plane for this particular target. Saturated light grey indicates a position registering a ‚Äòhit‚Äô (at least 9 synthetic clusters that
are both expected to exist and be detectable) for the plotted binning size. In each panel the model cluster region linked to the current binning resolution is
drawn with a dashed magenta curve, whereas the regions at other resolutions are shown with the solid blue curves for comparison. See the text for existence
and detection criteria assumed.

to our methods for the synthetic MoÔ¨Äat clusters. However, it was
found that slight diÔ¨Äerences in the actual PSF versus the Anderson
PSF, combined with a overly simplistic parameterised form for the
magnitude distribution of inserted point sources, sometimes led to
slight mismatch between the clear stellar peak in the observed MCI
plane and model star regions.

Therefore, we adopt a simpler, yet more empirical method,
for deÔ¨Åning what we call a ‚Äòstellar exclusion region‚Äô. From the
DOLPHOT catalogue of each target, we cull a set of actual, high
signiÔ¨Åcance stars (DOLPHOT S/N (cid:62) 40, sharpness consistent with a
point source, and ùúí2 less than a tunable limit based on inspection)
and use this set to generate a KDE-smoothed distribution of stars in
the MCI plane. Our Ô¨Ånal adopted stellar exclusion region is deÔ¨Åned
by a contour at 50% of the peak in this distribution. We generate
this product for each galaxy individually. In some cases, we need
to increase the degree of KDE smoothing due to low numbers of
qualiÔ¨Åed point sources, or in extreme cases substitute a camera/

band-speciÔ¨Åc ‚Äòaggregate‚Äô stellar exclusion region for the galaxy-
tuned determination. This latter product is generated from the union
of qualiÔ¨Åed point sources in all targets. An example of the aggregate
product for WFC3/UVIS datasets is shown in Fig. 6 (red curve). The
stellar exclusion region shifts substantially for ACS/WFC versus
WFC3/UVIS, due to camera-related diÔ¨Äerences in eÔ¨Äective PSF.
The galaxy-speciÔ¨Åc stellar exclusion regions will be published in
our entire-sample cluster catalogue release paper, but the ACS/WFC-
based region for NGC 628-C is plotted later in the current paper (as
part of Figs. 9, 10, and 11).

The stellar exclusion region successfully removes the majority
of stars, with limited inevitable exceptions due to low S/N or confu-
sion. Conversely, the stellar exclusion region is expected to remove
only a very small percentage of detectable clusters given the typi-
cal mass (‚àº 104 M(cid:12)) of sources recovered in our survey, coupled
with the cluster mass-radius relation (e.g. Krumholz et al. 2019a
with supporting data on Milky Way and M31 clusters from Johnson

MNRAS 000, 1‚Äì30 (2021)

12

Thilker et al.

Figure 6. Aggregate stellar exclusion region (red curve) generated for
WFC3/UVIS and ùêπ 555ùëä . Note that this plot is more zoomed in than other
depictions of the MCI plane, to show detail. The background histogram
shows a histogram of the qualiÔ¨Åed (see text) point-like sources aggregated
over all PHANGS-HST targets in this instrumental conÔ¨Åguration processed
to date. The polygonal shape is the upper right portion of the semi-empirical
selection region (Sec. 4.2.3), which is drawn for reference. Although not
shown here, the equivalent plot for ACS/WFC (and ùêπ 555ùëä ) indicates that
point sources occupy a peak at signiÔ¨Åcantly lower MCIin (‚àº 0.21, c.f. Fig. 3
left panel and Figs. 9-11) but comparable MCIout, owing to the lower reso-
lution of the ACS/WFC PSF compared to WFC3/UVIS. Note that we could
have specially modiÔ¨Åed the MCI (NCI) normalisation constants used for
ACS/WFC to eliminate such oÔ¨Äset of point sources but chose not to do
so, since only three of 38 PHANGS-HST targets (NGC 628, NGC 1300,
NGC 3621) rely on archival (ACS/WFC) ùëâ -band data for cluster candi-
date detection/selection, and because our selection/exclusion regions already
compensate by construction.

et al. 2012; Fouesneau et al. 2014; Kharchenko et al. 2013). At a
mass of 104 M(cid:12) a representative cluster eÔ¨Äective radius is ‚àº 3 pc
(‚àº 1 pixel at 15 Mpc), following the observed relation presented in
Krumholz et al. (2019a), and implying that such a cluster would have
MCI values well outside the stellar exclusion region. Of course, the
typical cluster mass we use to support this argument is likely itself
modiÔ¨Åed by selection. Forthcoming cluster completeness testing as
a function of mass, age, and morphology will quantitatively account
for candidate loss due to the stellar exclusion region, as well as other
cuts of our selection method.

To summarise our MCI-based, synthetic cluster guided selec-
tion pathway: for the subset of sources fainter than the H-D limit
(Humphreys & Davidson 1979), we select as a cluster candidate any
object meeting the general conditions outlined at the start of Sec. 4,
having ùëâ-band S/N (cid:62) 10 and MCIin,err (cid:54) 0.3 plus MCIout,err
(cid:54) 1.0, and falling within one of the model cluster regions (Fig. 5)
but outside the empirically-deÔ¨Åned stellar exclusion region (Fig. 6).
After adding possible objects brighter than the H-D limit (Sec. 4.3),
this set of candidates is known as our ‚ÄòML sample‚Äô (machine learn-
ing). Additional illustration of galaxy-speciÔ¨Åc MCI plane selection

model cluster regions and stellar exclusion regions is included in
the PHANGS-HST survey paper (Lee et al. 2021).

4.2.3 MCI selection: semi-empirical selection region

The synthetic model cluster regions presented above provide an
optimally tuned selection of cluster candidates, speciÔ¨Åc to a given
galaxy in terms of its internal structure/confusion-level, distance,
and also the quality of the observation. However, the construction/
use of such regions requires substantially detailed analysis of syn-
thetic clusters (Sec. 3) and high-signiÔ¨Åcance stars in the Ô¨Åeld of
interest. General users of our MCI-based method may not wish to
do this. For this reason, and also to quickly generate a standardised
candidate set of manageable size for human classiÔ¨Åcation, we de-
signed a polygonal ‚Äòsemi-empirical selection region‚Äô (for cluster
candidates) in the MCI plane. To exclude stars from this selection, in
the case of general users, we suggest adopting the aggregate stellar
exclusion region of Fig. 6 (though not used by our pipeline, except
when stars are too rare), or more simply a lower limit on allowed
traditional CI for candidate clusters (‚àº 1.3 ‚àí 1.4) determined by the
user for their own particular dataset. Stellar exclusion is barely even
indicated for WFC3/UVIS data sets but is very much necessary for
ACS/WFC data sets.

In order to decide on the form of the polygon adopted, we
jointly used information from actual clusters and synthetic mod-
els, with actual clusters in our analysis coming from the Ô¨Årst few
PHANGS-HST galaxies studied (e.g. NGC 1559, Wei et al. (2020);
NGC 3351, Turner et al. (2021); NGC 4548). At this early stage
of our ùêªùëÜùëá program, sources were inspected over a wide swath of
the MCI plane (essentially spanning the entire distribution). Then,
the distribution of human veriÔ¨Åed clusters in combination with the
(tightest) model cluster region evaluated for several targets span-
ning the distance range of our sample was used to semi-empirically
deÔ¨Åne the edges of the adopted polygon. In Fig. 7 the left hand panel
shows the veriÔ¨Åed clusters of NGC 1559 together with representa-
tive model cluster regions, illustrating how such guidance was used
to motivate the semi-empirical selection region. The adopted poly-
gon is shown in various ways in Figs. 6‚Äì11. Some slack is allowed in
the upper right hand corner of the semi-empirical selection region,
in order to allow the smallest recoverable WFC3/UVIS detected
clusters to the maximum degree allowed by our stellar exclusion
regions. We elected to shave oÔ¨Ä some from a simple quadrilateral
in the lower right portion of the selection region, aiming to reduce
contamination mildly. The top edge is Ô¨Åxed at MCIout = 0.6.

As a validation check (and possible tertiary inÔ¨Çuence) on the
semi-empirical selection region, we examined the MCI plane dis-
tribution of LEGUS Class 1 and 2 clusters, and Class 3 compact
associations. The right hand panel of Fig. 7 shows this data set.
Note the tightly conÔ¨Åned locus of Class 1 clusters, with the Class 2
clusters scattering to somewhat more negative (extended) MCIout
at Ô¨Åxed MCIin. Compact associations are even more scattered. If
we ignore Class 3, which are being treated in a more robust manner
by the PHANGS-HST pipeline (see the multi-scale associations of
Larson et al. 2021), this Ô¨Ågure makes it clear that our semi-empirical
selection region captures the vast majority of compact clusters.

Because the MCI (and NCI) are normalised to a Ô¨Åducial cluster
of Ô¨Åxed angular size, we expected distance-dependent variations in
the MCI plane distribution. This is illustrated in Fig. 8. We adopt a
variable lower limit on the bottom edge of the semi-empirical selec-
tion region. SpeciÔ¨Åcally, the region is cropped at MCIout = ‚àí1.7 for
galaxies with ùëë (cid:54) 8 Mpc, at MCIout = ‚àí1.1 for 8 < ùëë < 14 Mpc,
and at MCIout ‚àí 0.7 for ùëë (cid:62) 14 Mpc. Future PHANGS-HST pa-

MNRAS 000, 1‚Äì30 (2021)

Star Cluster IdentiÔ¨Åcation in PHANGS-HST

13

Figure 7. Development of the semi-empirical selection region in the MCI plane. (left) The distribution of clusters in early PHANGS-HST target NGC 1559
(at a distance of 18 Mpc) in comparison to high-resolution model selection regions computed from synthetic clusters (18 Mpc, purple, near the median
PHANGS-HST distance; 4.4 Mpc, violet, more suitable for LEGUS galaxies and nearby PHANGS-HST target NGC 4826). Based on this guidance we deÔ¨Åne
the semi-empirical selection region (black polygon), shown here without distance-based cropping at the bottom edge. Symbol colour and size diÔ¨Äerentiate
cluster type (Class 1 and 2) and classiÔ¨Åcation method (human and ML) as indicated in the legend. (right) The MCI plane and the semi-empirical selection
region, showing all publicly released LEGUS cluster candidates aggregated across 34 galaxies (light blue, and human classiÔ¨Åed: grey), with Class 1 clusters
marked in dark blue, Class 2 in green, and Class 3 (compact associations) in yellow.

Table 2. Vertices of the semi-empirical selection region

MCIin MCIout

0.050
0.300
0.110
-0.200
-0.525
0.050

0.600
0.600
-0.700
-2.000
-2.000
0.600

Note: The bottom edge used to crop the semi-empirical selection region
on a galaxy-by-galaxy basis depends on the distance to the target (e.g.
Fig. 8), in the sense of the selection region shrinking at the high MCIout
end with increased distance. SpeciÔ¨Åc recommendations are given in the
text.

pers dealing with cluster catalogues may use a revised ladder of
semi-empirical selection region edges, but our goal for the present
work was to be conservative, especially in the case of targets for
which signiÔ¨Åcant distance uncertainty persists. Note that for targets
considerably closer than 8 Mpc, such as many of the LEGUS galax-
ies, a limit of MCIout = ‚àí2 is appropriate since several LEGUS
conÔ¨Årmed Class 2 clusters and even a few Class 1 clusters appear
in this regime as can be seen in the right panel of Fig. 7. The model
region plotted for PHANGS-HST target NGC 4826 (at 4.4 Mpc) in
the left panel of Fig. 7 also supports this conclusion.

To enable readers to utilise our MCI-based selection method
without running synthetic cluster models of their own, we provide
the vertices of the semi-empirical selection region in Table 2 before
adjusting the bottom edge according to galaxy distance.

Recall that in addition to providing for a simple cut in the MCI

MNRAS 000, 1‚Äì30 (2021)

Figure 8. The semi-empirical selection region (thick polygon), with variable
lower limits in MCIout (thin dashed lines). We show LEGUS conÔ¨Årmed
Class 1 or 2 clusters as points colour coded according to the distance range
which they occupy. Note the typical agreement between the observed lower
end of the cluster distribution with the progressively lowered MCIout semi-
empirical selection region limit, where the ‚àí1.7 limit is for ùëë (cid:54) 8 Mpc,
‚àí1.1 for 8 < ùëë < 14 Mpc, ‚àí0.7 for ùëë (cid:62) 14 Mpc.

¬°0:6¬°0:4¬°0:200:20:4MCIin¬°3:0¬°2:5¬°2:0¬°1:5¬°1:0¬°0:500:51:0MCIoutHumanC1HumanC2MLC1MLC218Mpc4:4MpcSelectionSemi¬°empiricalselection:NGC1559andmodels¬°0:6¬°0:4¬°0:200:20:4MCIin¬°3:0¬°2:5¬°2:0¬°1:5¬°1:0¬°0:500:51:0MCIoutAllCand:Classi¬ØedClass1Class2Class3LEGUSgalaxies¬°0:6¬°0:4¬°0:200:20:4MCIin¬°3:0¬°2:5¬°2:0¬°1:5¬°1:0¬°0:500:51:0MCIoutClassi¬Øedd<5Mpc5¬∑d<88¬∑d<14d¬∏14LEGUSClass1or214

Thilker et al.

plane that would work without running synthetic cluster models,
the basic motivation for the semi-empirical selection region was to
generate a smaller subset of the overall candidate list to be consid-
ered for human classiÔ¨Åcation. Because our semi-empirical selection
region (after distance-based cropping) is generally comparable or
smaller in area to the highest resolution model cluster region (0.01
bin size), we expect the purity of the selection (‚â° # of true clus-
ters / # cluster candidates) to be similarly elevated in this subset,
though potentially at the cost of missing cluster candidates of un-
usually large size or in complex/crowded regions that perturb MCI
measurements away from the nominal locus.

Summarising our semi-empirical selection pathway, we select
as a candidate in this ‚Äòhuman classiÔ¨Åcation sample‚Äô any source
(meeting the general criteria outlined at the start of Sec. 4, i.e.
having ùëâ-band S/N (cid:62) 10, and being inside the semi-empirical
selection region but outside the stellar exclusion region deÔ¨Åned
earlier), or brighter than the H-D limit (Sec. 4.3). We reiterate
though that two selection pathways are implemented, and that a
broader sample of candidates based on model cluster expectations
alone is ultimately passed to ML classiÔ¨Åcation. In Fig. 9, we indicate
for one target (NGC 628-C) the human subset (cyan) of the entire
candidate cluster set (grey). Both the semi-empirical and model
cluster selection regions are plotted, along with the stellar exclusion
region, so they can be compared. Here one can see the ACS/WFC-
speciÔ¨Åc need to exclude stars from the semi-empirical selection
region, not signiÔ¨Åcant for WFC3/UVIS data sets (see Fig 6).

As a Ô¨Ånal double check that our method works as expected, we
compared the selection areas for each galaxy in our paper‚Äôs sample
to the MCI plane distribution of LEGUS clusters in that same target.
Figure 10 shows such a plot for NGC 628-C, and conÔ¨Årms that only
a handful of clusters conÔ¨Årmed by LEGUS lie outside our semi-
empirical selection region, and only two are missed by our model
cluster regions (others may possibly fail general conditions of S/N,
# of low error bands, etc.).

Lastly, in Fig. 11 we compare the MCI plane distribution of our
synthetic cluster models for NGC 628-C to standard CI. This Ô¨Ågure
is similar to the plot in the right panel of Fig. 3, except that here
we show models rather than detected sources. We also indicate the
model cluster regions, stellar exclusion region, and semi-empirical
selection region so their connection to the traditional CI metric can
be ascertained.

4.3 Bright object criteria: super H-D cluster candidates

As noted in Sec. 4.1, we treat the brightest sources in our augmented
DOLPHOT+DAOStarFinder catalogue slightly diÔ¨Äerently than the
vast majority of (fainter) possible cluster candidates. The luminos-
ity distribution for stars is strongly limited at the bright end. The
Humphreys‚ÄìDavidson limit (Humphreys & Davidson 1979, a.k.a.
H-D limit) eÔ¨Äectively delineates a demarcation in the Hertzsprung‚Äì
Russell diagram above which stars can only brieÔ¨Çy exist, in an
unstable state. This limit can be cast into an equivalent boundary
in the (ùëâ‚àíùêº, ùêº) CMD. There is colour-dependence, but for our pur-
poses we adopt ùëÄùëâ = ‚àí10 as the H-D limit. Clusters exist both
fainter and brighter than this magnitude, but given the rarity of stars
brighter than the H-D limit, it is reasonable to assume that nearly all
sources brighter than the H-D limit are clusters. For this reason, we
accept as a cluster candidate any source surviving the cuts outlined
as general criteria in Sec. 4.1 and having ùëÄùëâ (cid:54) ‚àí10 if it also meets
the very lax condition of having ‚àí0.55 (cid:54) MCIin (cid:54) 0.45 (since
they can sometimes be [nearly-]saturated or have close neighbours
within 5 pixels, leading to corrupted MCI values). We call these

Figure 9. PHANGS-HST NGC 628-C cluster candidates (grey) and the
subset of semi-empirical region selected (cyan) or super H-D sources (red).
Solid blue curves are our model cluster regions for 0.01, 0.02, and 0.04 bin
sizes. The dashed black polygon marks the semi-empirical selection region
(for this distance), whereas the solid red curve is the stellar exclusion region.
Note that the stellar exclusion region intrudes signiÔ¨Åcantly into the selection
area, only due to this target being observed with ACS/WFC. The majority
of the super H-D sources fall along the locus of highest cluster candidate
density (within both the semi-empirical selection region and the 0.01 bin
size model cluster region) and conÔ¨Årmed by inspection to be luminous
clusters. The galaxy nucleus is the super H-D source near MCIout = -0.3.
We have inspected the super H-D sources outside the model cluster region,
Ô¨Ånding all but two to be artefacts associated with bright foreground stars.
The two super H-D sources in the far bottom left corner of the Ô¨Ågure are
oÔ¨Ä-centre detections of the galaxy nucleus. Two super H-D sources fall
within the stellar exclusion region. According to the Gaia GR2 distances of
Bailer-Jones et al. (2018), they are both foreground stars within 2 kpc of the
Sun.

objects ‚Äòsuper H-D candidates‚Äô. They are marked as red symbols
in Fig. 9. In practice, super H-D candidates are a mix of luminous
clusters and artefacts. See the caption of Fig. 9 for more information,
but note that contaminating foreground stars (being misinterpreted
at the distance of the target galaxy) can also sometimes make it into
this subset, and are later discarded to the best of our ability during
classiÔ¨Åcation. Objects of this sort should appear within or near the
stellar exclusion region, however genuine luminous clusters having
intrinsically compact morphology (e.g. Smith et al. 2020) would
also manifest as super H-D objects found in the exclusion region
‚Äì particularly for the more distant galaxies in the PHANGS-HST
sample.

Point-like super H-D cluster candidates present a particular
challenge during classiÔ¨Åcation. We can utilize Gaia Bayesian dis-
tance estimates (Bailer-Jones et al. 2018) to weed out foreground
stars, but such parallax-based ancillary information is not always
conclusive since the method depends on sky location with respect
to the Galactic model and because parallax uncertainty is exces-
sive for some super H-D sources (e.g. our assumed H-D limit of
ùëÄùëâ = ‚àí10 implies ùëöùëâ = 20 for a galaxy at 10 Mpc). The appear-

MNRAS 000, 1‚Äì30 (2021)

¬°0:6¬°0:4¬°0:200:20:4MCIin¬°3:0¬°2:5¬°2:0¬°1:5¬°1:0¬°0:500:51:0MCIoutAllCand:HumanSampleSuperH¬°DPHANGS¬°HST;NGC628¬°CStar Cluster IdentiÔ¨Åcation in PHANGS-HST

15

Figure 10. This plot, for NGC 628-C only, shows LEGUS candidates (light
blue, and human classiÔ¨Åed: grey) and LEGUS human conÔ¨Årmed clusters
(of Class 1, 2 ‚Äì blue, green, respectively). Solid blue curves are our model
cluster regions for 0.01, 0.02, and 0.04 bin sizes. The dashed black line marks
the semi-empirical selection region (for this distance) and the red curve is
the stellar exclusion region for NGC 628-C. Note that the stellar exclusion
region for NGC 628-C intrudes signiÔ¨Åcantly into the selection area, only due
to this target being observed with ACS/WFC. For WFC3/UVIS targets, the
stellar exclusion region is generally adjacent to, or only slightly overlapping,
the semi-empirical selection region.

ance of an Airy ring or sharp diÔ¨Äraction spikes can also help to
weed out foreground stars. When neither Gaia nor PSF-wing source
morphology helps, we rely on contextual hints from where in the
galaxy image a point-like super H-D source is found. For instance,
if it lies in a complex of active star formation or in a comparatively
luminous region, and the angular surface density of other point-like
super H-D sources nearby in the celestial sphere is low enough that
chance projection on such areas is unlikely, then we generally ac-
cept the cluster candidate as being a bona Ô¨Åde cluster. A dedicated,
follow-up study of super-HD clusters will explore this issue in more
detail. Finally, one might wonder how complete our catalogues are
for super H-D clusters. Whitmore et al. (2021) looks at this issue for
NGC 628, concluding that our catalogues approach 90% complete-
ness in this bright regime, despite the complexities of presented by
point-like super H-D candidates.

4.4 Eliminating duplicate and/or redundant cluster

candidates

As it is originally intended to be a point-source Ô¨Ånding and PSF-
Ô¨Åtting photometry routine, DOLPHOT sometimes chooses to repre-
sent an extended source as two or more very closely spaced point
sources, rather than passing through only one dominant compo-
nent. Although well motivated for resolved stellar photometry of
crowded Ô¨Åelds, and good for close pairs of stellar sources (as in
the context of our PHANGS-HST individual star photometry and
association analysis), this is a drawback in our case of cluster detec-

MNRAS 000, 1‚Äì30 (2021)

Figure 11. The set of synthetic clusters computed for ACS/WFC observations
of NGC 628-C which could (1) plausibly exist and (2) likely be detected
by our observation, colour-coded by CI. We have overplotted all selection/
exclusion regions, with a lower limit appropriate to the distance of NGC 628
in the case of the semi-empirical selection region.

tion. We included a general condition on DOLPHOT crowding in our
candidate selection to mitigate this situation from the start of our
cluster-speciÔ¨Åc work. See Sec. 4.1 for speciÔ¨Åc implementation, but
we only allow DOLPHOT sources with crowding (cid:54) 0.667 mag. This
crowding cut eliminates a majority of cases of duplicative detec-
tion, but at the very end of our cluster candidate selection we also
explicitly impose a ‚Äòdoubles radius‚Äô cut. After the preliminary can-
didate list is established, we sort candidates by count rate and work
through the list in order of decreasing count rate, disqualifying any
fainter DOLPHOT artefact (= ‚Äòduplicate‚Äô) neighbouring candidate(s)
at separations (cid:54) 2.5 pixels (hence quasi-unresolved by ùêªùëÜùëá). We
cannot make the doubles radius any larger without starting to lose
bona Ô¨Åde double objects (not artefacts) of which the fainter source
could conceivably be a cluster.

DOLPHOT deblending artefacts that do squeak through this cut
are later eliminated by human inspection, or, in the speciÔ¨Åc case
of machine learning classiÔ¨Åed populations, via a secondary prox-
imity cut to remove redundant links to the same physical object.
The additional need for this secondary cut is best illustrated by
Class 3 sources, which are operationally deÔ¨Åned as groups of 4 or
more point-like sources within 5 pixels radius (further discussion
in Whitmore et al. 2021). Our detection code will generally return
each point source in such groupings as a candidate, and subse-
quently most of these candidates (except perhaps those on the edge
of a group) will be conÔ¨Årmed as Class 3 objects by machine learn-
ing. Even so, there is only one actual grouping. Therefore, after ML
classiÔ¨Åcation is completed (Sec. 5.2), we sort Class 3 by decreasing
count rate and eliminate ‚Äòredundant‚Äô objects within a rejection ra-
dius of 5 pixels. Interactive inspection of the results showed that the
method works as expected, keeping the brightest peak within each
Class 3 grouping. The same operation is conducted for Class 1+2
classiÔ¨Åed candidates jointly ‚Äì as a purely conservative step at this

¬°0:6¬°0:4¬°0:200:20:4MCIin¬°3:0¬°2:5¬°2:0¬°1:5¬°1:0¬°0:500:51:0MCIoutAllCand:Classi¬ØedClass1Class2LEGUSNGC628¬°C;Class1or216

Thilker et al.

time ‚Äì even though any pair of true clusters at separations < 5
pixels would lose its fainter member. We expect to re-evaluate the
Class 1+2 redundancy cut as the PHANGS-HST analysis progresses
further. We do wish to clarify that Class 3 and Class 1+2 objects
are not allowed to eliminate cross-class. That is, a Class 1 or 2 clus-
ter can be allowed within the 2.5‚àí5.0 pixel range from a Class 3
compact association.

4.5 Summary of cluster candidate selection

The simplest distillation of our cluster candidate selection method
is to say that we evaluate each entry in our all-source catalogue
(Sec. 2.1), Ô¨Årst requiring that photometric and morphological qual-
ity assurance conditions are met (Sec. 4.1), then allow high quality
sources to qualify as clusters either owing to their position in the
MCI plane (Secs. 4.2.2 for the maximally inclusive, model-guided
ML sample and 4.2.3 for the smaller, semi-empirically selected hu-
man sample), or because they are more luminous than the H-D limit
(Sec. 4.3, included in both samples). Final checks to prevent any
double counting are also implemented as just described. To aid the
reader in understanding this complex selection method, we refer
them again to the overview Ô¨Çowchart at the start of this Section
(Fig. 1). The path in the Ô¨Çowchart from source detection to science-
ready cluster catalogues ends with cluster candidate classiÔ¨Åcation,
which is the topic of the following Section.

5 CLUSTER CANDIDATE CLASSIFICATION

We adopted the cluster classiÔ¨Åcation system introduced by LEGUS,
accomplishing the task through a mix of human inspection (Whit-
more et al. 2021) and deep transfer learning (Wei et al. 2020).
Integrated over the four galaxies included in this paper, approxi-
mately 18% (4246) of the nearly 24,000 candidate clusters were
classiÔ¨Åed by a human for our study (recall these four galaxies also
have independent catalogues from LEGUS). These classiÔ¨Åcations
act as a reference allowing us to judge the performance of our ML
method and improve it in the future (Whitmore et al. 2021).

5.1 Human, inspection-based classiÔ¨Åcation

Via interactive inspection of the ùëâ-band (ùêπ555ùëä) image and also
a colour composite made from ùêµ, ùëâ, ùêº bands, one of us (BCW)
classiÔ¨Åed objects in the human sample. Inspection consisted of
radial proÔ¨Åle analysis and comparison of morphology with known
stars during variation of the image intensity transfer function. A
detailed description of the procedure is given in Whitmore et al.
(2021). The large number of candidates in some targets prevented
classiÔ¨Åcation of all objects in this sample, and candidates were
inspected down to a magnitude limit that included ‚àº 1000‚àí1500
objects per target. The limit for the four galaxies in this paper ranged
from ùëö(ùëâ) = 23.0 to 24.1 (see notes on Table 6 for details).

5.2 Machine learning classiÔ¨Åcation

We applied the deep transfer learning ResNet-18 (18 layer residual,
He et al. 2015, hereafter ResNet) and VGG-19_BN (Visual Geom-
etry Group 19 layer with batch normalisation, Simonyan & Zisser-
man 2014, hereafter VGG) convolutional neural network models of
Wei et al. (2020) to all of our candidate clusters, even those not
included in the human sample. SpeciÔ¨Åcally, we adopted the Wei et
al. models trained using LEGUS-BCW human classiÔ¨Åcations for

ten galaxies. As ML for cluster classiÔ¨Åcation is an actively emerg-
ing Ô¨Åeld, future successful development will beneÔ¨Åt from testing
various approaches. We direct the interested reader to Grasha et al.
(2019) and P√©rez et al. (2021). We note that the method of Grasha
et al. (2019) was also used for cluster classiÔ¨Åcation required by the
analysis of Messa et al. (2018a).

Our classiÔ¨Åcation processing was accomplished on Amazon
Web Services (AWS) cloud computing hardware, using GPU in-
stances launched on demand. Running on a single GPU (NVIDIA
Telsa V100-SXM2 16 Gb) we were able to attain a classiÔ¨Åcation
rate of ‚àº0.7s per candidate.14 For each of ResNet and VGG we eval-
uated ten independent models. From this set of results we obtained
the mean, median, mode classiÔ¨Åcation, plus standard deviation, for
each network. The mode was adopted as the Ô¨Ånal single network
classiÔ¨Åcation. In Sec. 6.3, we experiment with various ways to attain
a joint classiÔ¨Åcation based on ResNet and VGG together. It is worth
stressing that we do expect our ML classiÔ¨Åcation accuracy to im-
prove in the future, as we are starting further training experiments
based on a representative set of BCW human classiÔ¨Åcations for
PHANGS-HST candidates and from synthetic cluster populations,
rather than relying on LEGUS classiÔ¨Åcations for typically more
nearby galaxies than in our sample. As such, we do not consider the
current ML classiÔ¨Åcations to be Ô¨Ånalized.

6 APPLICATION TO PHANGS-HST GALAXIES

In this Section we present the results of our cluster detection and
classiÔ¨Åcation methods. We analysed the four PHANGS-HST galax-
ies for which LEGUS also produced a publicly available cluster
catalogue, enabling direct comparison between the surveys. Ta-
bles 3 and 4 provide relevant information on each of the galaxies
and the ùêªùëÜùëá observations, respectively. Figure 12 displays the foot-
print of the ùêªùëÜùëá images (for primary observations we only show
WFC3/UVIS coverage) and the ALMA CO, MUSE IFU (Integral
Field Unit) spectroscopy sky coverage from the broader PHANGS
project. Complete details of the observations and data reduction are
given in Lee et al. (2021).

We begin here with summary statistics of the cluster candi-
date sample, then describe candidate classiÔ¨Åcation results, in both
the human inspection and machine learning contexts. Finally, we
present a detailed comparison of the Class 1 and 2 cluster popula-
tions identiÔ¨Åed by PHANGS-HST and by LEGUS.

6.1 Candidate statistics

In Table 5, for each analysed galaxy, we summarise information
about the objects which are detected by our method and pass our
selection criteria. As described in Table 4 we process NGC 628
as two separate Ô¨Åelds without mosaicking them together due to
camera/Ô¨Ålter diÔ¨Äerences. Furthermore, we present the statistics for
NGC 3351 broken into two columns because additional observa-
tions were obtained as part of PHANGS-HST, increasing spatial
coverage to better match the ALMA observations, thereby increas-
ing the exposure time in the region of overlap between LEGUS and
PHANGS-HST imaging. SpeciÔ¨Åcally, we analyse: (i) a LEGUS-
only data set (NGC 3351-S in Tab. 4) and (ii) a mosaic constructed
from all available images for NGC 3351.

14 A step-by-step tutorial of our ML procedure is given in Whitmore et al.
(2021), and linked at http://www.stsci.edu/hlsp/phangs-hst.

MNRAS 000, 1‚Äì30 (2021)

Star Cluster IdentiÔ¨Åcation in PHANGS-HST

17

Table 3. Galaxy properties

Galaxy Name

NGC 628
NGC 1433
NGC 1566
NGC 3351

RA
[deg]

24.1739
55.5062
65.0016
160.991

Dec
[deg]

Distance
[Mpc]

Stellar Mass
[1010 M(cid:12)]

SFR
[M(cid:12)yr‚àí1]

SFRùêª ùëÜùëá Morphology
[M(cid:12)yr‚àí1]

15.7836
‚àí47.2219
‚àí54.9380
11.7037

9.9
8.3
18
10

2.2 (¬±0.6)
1.5 (¬±0.4)
6.3 (¬±1.6)
2.3 (¬±0.6)

1.8 (¬±0.5)
0.2 (¬±0.06)
4.7 (¬±1.2)
1.3 (¬±0.3)

0.93
0.11
3.3
0.87

Sc
SBa
SABb
Sb

Note: Properties of the PHANGS-HST galaxies analysed in this paper. They were selected for this study because each has a published cluster catalogue
from LEGUS and a catalogue from our work, enabling comparison of the new cluster pipeline output with established results. Despite having updated
PHANGS-HST distances in Anand et al. (2021), we adopt the LEGUS distances here. This only signiÔ¨Åcantly impacts NGC 1433, which has a much larger
revised distance (18.63 versus 8.3 Mpc). Nominal stellar masses and star formation rates (SFR) are for the entire galaxy and have been scaled for the adopted
distance. They are computed following Leroy et al. (2019) (ùëß0MGS), using galaxy integrated GALEX FUV + WISE W4 for SFR and WISE W1 for stellar
mass. However, we also provide the SFR integrated within only the ùêª ùëÜùëá footprint, combining multiple Ô¨Åelds for NGC 628 and NGC 3351 (see 4).

Table 4. HST Exposure Times

Field Name

ùêπ 275ùëä (ùëÅ ùëà ùëâ )
[s]

ùêπ 336ùëä (ùëà )
[s]

ùêπ 438ùëä (ùêµ)
[s]

ùêπ 555ùëä (ùëâ )
[s]

ùêπ 814ùëä (ùêº )
[s]

PID

NGC 628-C
NGC 628-E
NGC 1433
NGC 1566
NGC 3351-N
NGC 3351-S

2481
2361
2376
2382
2190
2361

2361
1119
1116
1119
1110
1062

1358‚Ä†
4720‚Ä†
962
965
1050
908

858‚Ä†
965
1140
1143
670
1062

922‚Ä†
1560‚Ä†
986
989
830
908

13364, 10402‚Ä†
13364, 9796‚Ä†
13364
13364
15654
13364

Note: ùêª ùëÜùëá imaging exposure times for the galaxies and data sets analysed in this paper. Data for NGC 1433, NGC 1566, and NGC 3351 originate
completely from WFC3/UVIS, whereas NGC 628 observations also include imaging taken with ACS/WFC (as indicated with the ‚Ä† symbol). Accordingly,
the ùêµ-band data for NGC 628 (both Ô¨Åelds) actually comes from the ùê¥ùê∂ùëÜ/ùêπ 435ùëä Ô¨Ålter not ùëä ùêπùê∂3/ùêπ 438ùëä . ùêª ùëÜùëá program ID (PID) is given in the
Ô¨Ånal column. Note that we combined the two Ô¨Åelds of NGC 3351 into a single drizzled mosaic, whereas (owing to the non-negligible diÔ¨Äerence in Ô¨Ålters
between WFC3/UVIS and ACS/WFC) the NGC 628 data are kept separate for each Ô¨Åeld (e.g. NGC 628-C and NGC 628-E) though there is some spatial
overlap.

Figure 12. Footprints of the ùêª ùëÜùëá (blue, only WFC3/UVIS shown), ALMA (red), and MUSE (cyan) coverage for the galaxies analysed in this paper overlaid
on Digital Sky Survey (DSS) imaging. The PHANGS-HST imaging for NGC 3351 also included ACS ùëâ - and ùêº -band parallel observations (footprint shown
as dotted blue box) to enable distance measurements (Anand et al. 2021). Images are oriented with North up and East left. Thus NGC 628-E is the Ô¨Åeld on
left, and NGC 628-C is the Ô¨Åeld centred on the galaxy. For, NGC 3351 the PHANGS-HST WFC3/UVIS data is centred on the galaxy, and LEGUS imaging is
oÔ¨Äset to the SW. For reference of scale, the blue WFC3/UVIS footprint is 7.8, 6.5, 14.1, 7.9 kpc across, respectively for NGC 628, NGC 1433, NGC 1566, and
NGC 3351.

MNRAS 000, 1‚Äì30 (2021)

MUSEALMAHSTNGC628MUSEALMAHSTNGC1433MUSEALMAHSTNGC1566MUSEALMAHSTNGC3351Table 5. Detection and candidate statistics

Quantity

Row
(#)

NGC 628-C

NGC 628-E

NGC 1433

NGC 1566

NGC 3351ùëí NGC 3351
(all data)

(LEGUS-only)

(1)
(2)
(3)
(4)
(5)
(6)
(7)
(8)
(9)

All-source catalogue entries, Sec. 2.1
General criteria satisÔ¨Åed, Sec. 4.1
Morphology (MCI) criteria satisÔ¨Åedùëé, Secs. 4.2.2 and 4.2.3
Super-HD (bright object) criteria satisÔ¨Åedùëé, Sec. 4.3
General + super-HD criteria only
Human sample size (semi-empirical selection region or super-HD) ùëè
Machine Learning sample size (model cluster region or super-HD)ùëê
LEGUS automatic candidates
LEGUS classiÔ¨Åed candidates (Classes 1, 2, 3, and 4)

646263
38776
10482
57
12
5695
7679
3080ùëë
1559

761914
19425
3450
25
4
1366
2117
593ùëë
381

266386
7992
3180
12
6
1230
1989
1099
306

377133
34588
13455
436
130
3757
8822
2752
1061

220905
8079
3784
99
26
1705
2398
1389
618

452247
16487
5415
89
29
2366
3389
¬∑ ¬∑ ¬∑
¬∑ ¬∑ ¬∑

ùëé For Rows (3) and (4), we check the named criteria without enforcing the general conditions of Row (2).
ùëè The human sample is deÔ¨Åned as the set of sources meeting general criteria, and either: (1) morphological criteria (e.g. MCI error, ùëâ -band S/N) and lying in the semi-empirical
selection region of the MCI plane (but outside the stellar exclusion region), or (2) meeting the super H-D criteria. In galaxies with very large source populations, only a bright
subset of the human sample candidates are eventually classiÔ¨Åed interactively by a human.

ùëê The Machine Learning sample is similar to the human sample, except that morphologically-selected sources are tested against the [broader] model cluster region rather the

semi-empirical selection region.

ùëë Owing to their condition of having four good photometric bands in order for selection, the footprint of the LEGUS census is signiÔ¨Åcantly reduced in these two targets. See

the notes of Table 6 for more detail. Because of this the ratio of Row (7) to Row (8) is inÔ¨Çated in NGC 628-C and NGC 628-E.

ùëí This column pertains to analysis of the archival LEGUS data for NGC 3351 (NGC 3351-S in Table 4) without any use of the new NGC 3351-N data obtained by PHANGS-HST,

even in the area of overlap.

1
8

T
h
i
l
k
e
r

e
t

a
l
.

M
N
R
A
S
0
0
0
,

1
‚Äì
3
0

(
2
0
2
1
)

Table 5 principally gives counts pertaining to our method, but
we also include the total number of sources in the LEGUS ‚Äòauto-
matic‚Äô catalogue and the subset which were classiÔ¨Åed by the LEGUS
team. This allows an initial assessment regarding the eÔ¨Écacy of our
new techniques.

Row (1), giving the combined number of DOLPHOT and
DAOStarFinder sources, shows that the initial set of all-source
detections coming from DOLPHOT is overwhelmingly large com-
pared to the actual number of reliably identiÔ¨Åable stellar clusters.
At least for the distance range we probe, this all-source census is
dominated by stars, including some of marginal signiÔ¨Åcance (as
is customary for PSF-Ô¨Åtting resolved stellar photometry prior to
selection of ‚Äògood stars‚Äô via quality assurance metrics). Row (2),
listing counts after application of general photometric selection cri-
teria (Ô¨Årst paragraph of Sec. 4.1 and also Sec. 4.4), demonstrates the
drastic reduction in the tally of potential candidates due to our limits
on photometric error (in multiple bands). Row (3) and (4) show the
number of objects from Row (1) meeting our separated conditions
of morphological appearance and luminosity, described in Secs. 4.2
and 4.3, respectively. In this table, the general conditions of Row (2)
are not enforced for tabulating Rows (3) and (4), indicating the small
fraction of the initial all-source catalogue having suitably accurate
MCI measurements, and the minimal population of objects brighter
than the H-D limit. Row (5) gives the number of sources meeting
our general selection criteria and being selected as a candidate only
due to being very luminous.

Our eventual selection, summarised in Fig. 1, is the result
of demanding the set of general criteria and either the morpho-
logical or luminosity based criteria. We report the Ô¨Ånal number
of cluster candidates so selected in Row 7 (ML sample) whereas
Row 6 (human sample) gives the subset distinguished as occupying
the semi-empirical selection region or being in the super H-D tail.
Though not broken down in the table, most (‚àº 50‚àí70%) candi-
dates originate either within the semi-empirical selection region or
the highest resolution model cluster region (0.01 binning), or their
common zone. Candidates added due to their MCI plane location
in the 0.02 or 0.04 bin-size model cluster regions are typically com-
parable in number to each other, each additional layer of area (at
lower resolution) adding between 20‚àí30% to the candidate sample.
Our most distant target, NGC 1566, is diÔ¨Äerent, with the candidates
originating more evenly across the MCI plane.

Rows (8) and (9) give the LEGUS candidate counts in total,
and those with LEGUS classiÔ¨Åcations, respectively. Comparison of
our ML sample size (Row 7) with that of the LEGUS automatic cat-
alogue (Row 8) shows that despite cuts (e.g. Rows 2, 3, 4) our tally
of candidate clusters is about a factor 2√ó larger than LEGUS. This
is probably due to a combination of our allowance of more com-
pact cluster morphologies as candidates (‚àº4% with CI < LEGUS
limit) and the substantial diÔ¨Äerence in source detection methods,
since DOLPHOT deblends neighbouring sources more eÔ¨Äectively than
SExtractor. We Ô¨Ånd that candidates allowed into the sample only
by virtue of their absolute magnitude (being too bright for a single
star) are rare (Row 5), with generally between several to ‚àº30 in each
target. NGC 1566 is an exception, with 130 super H-D candidates
not otherwise qualiÔ¨Åed based on morphological metrics, presum-
ably due to a combination of being much further away than the
other galaxies (18 Mpc versus (cid:47) 10 Mpc) and having nearly triple
the HST-footprint-integrated SFR of any other target.

MNRAS 000, 1‚Äì30 (2021)

Star Cluster IdentiÔ¨Åcation in PHANGS-HST

19

6.2 Results from human classiÔ¨Åcation

Drawing cluster candidates from the ‚Äòhuman sample‚Äô (see Table 5),
one co-author (BCW) assessed source morphology and assigned
classes following the method in Sec. 5.1. The depth of the human
classiÔ¨Åcations varied with the speciÔ¨Åc target, going deeper in cases
with few candidates and shallower in highly populous targets. We
are able to use these classiÔ¨Åcation data to assess the eÔ¨Äectiveness of
our selection criteria, and (in the future, with human classiÔ¨Åcations
aggregated across all PHANGS-HST targets) to improve the training
of ML networks. Because human classiÔ¨Åcations are conÔ¨Åned to
the portion of the MCI plane we call the semi-empirical selection
region, with the exception of rare super H-D sources, we assess
compact cluster selection purity (‚â° # Class 1+2 / # Candidates) and
Class 3 contamination (‚â° # Class 3 / # Candidates) only within this
area, leaving the outer model cluster regions beyond this for a later
study.

Figure 13 shows the Class 1+2 selection purity attained in
all targets, as a function of ùëâ-band magnitude. We present the in-
formation both as a computed purity with Poisson error (bottom
row, red markings), and as the associated counts versus magnitude
(top row, green and grey histograms). Purity generally increases
from ‚àº 35‚àí50% at 23 mag to ‚àº 70‚àí85% brighter than 21 mag.
In NGC 1566 the data suggest a Ô¨Çatter relationship. Note that our
ability to accurately constrain the purity worsens as the population
becomes brighter due to reduced counting statistics. Nevertheless,
the overall trend across the sample is clear and the typical pu-
rity within the semi-empirical selection region is in excess of the
comparable statistic for LEGUS (44%, 45%, 37%, 44%, 32% for
NGC 628-C, NGC 628-E, NGC 1433, NGC 1566, and NGC 3351
(LEGUS-only), respectively). In Fig. 13, we also present a purity
assessment for Class 1+2+3 (black markings in bottom row), Ô¨Ånding
that this metric including compact associations alongside compact
clusters is typically 10‚àí15% higher.

Our method does not recover a majority of the Class 3 objects
identiÔ¨Åed by LEGUS, but this is by design since we are treating
these multi-peak compact associations with the dedicated method
of Larson et al. (2021). SpeciÔ¨Åcally, our selection areas in the MCI
plane were determined on the basis of only Class 1 and 2 single-
peak objects, both synthetic and observed. Class 3 objects generally
lie below (more negative MCIout at Ô¨Åxed MCIin) Class 1 and 2
objects. Some compact associations (Class 3) do survive our se-
lection as the selection areas for clusters (Class 1 and 2) had to be
made broad enough to retain outlying Class 1 and 2 objects. Such
surviving Class 3 objects should be considered contaminants, and
we only keep them for completeness and comparison to prior work
(LEGUS). We strongly advocate using the multi-scale associations
of Larson et al. (2021) instead. This is particularly important if
the emphasis is on studying young star formation products, as our
Class 3 objects would be highly incomplete in such a context.

We achieved our goal of minimising Class 3 contamination
(# Class 3 / # Candidates) amongst the objects considered as possible
clusters. For the depth attained by PHANGS-HST human classiÔ¨Åca-
tion, such contamination ranged from 8 to 16% across the galaxies
in our study. We do not compare to similar metrics for LEGUS, as
they aimed to recover Class 3 compact associations in addition to
Class 1 and 2 clusters (incidentally, this is a likely reason for their
usage of SExtractor as a detection algorithm).

20

Thilker et al.

Figure 13. (Top row) Selection purity for human classiÔ¨Åed clusters assigned as candidates due to the semi-empirical selection region, or else being brighter
than the H-D limit. Each histogram shows the object counts from a diÔ¨Äerent target, plotting the overall set with available BCW classiÔ¨Åcations in grey, the BCW
classiÔ¨Åed Class 1, 2, or 3 clusters in yellow, and BCW Class 1 or 2 clusters in green. (Bottom row) The same information but with the purity expressed as a
fractional measure, with Class 1 or 2 results as red squares, and Class 1, 2, 3 as black dots. The 1ùúé Poisson uncertainty is indicated with thinner red dashed
and black solid lines.

6.3 Results from ML classiÔ¨Åcation

As currently implemented in our pipeline, we conduct ML classiÔ¨Å-
cation using two diÔ¨Äerent neural network architectures (ResNet and
VGG), each pre-trained as described in Wei et al. (2020). For each
network we evaluate the ensemble of class predictions ten times,
allowing us to determine a mode cluster classiÔ¨Åcation for each
source. Just as with human classiÔ¨Åers, these modes do not always
agree between networks or between networks and the BCW human
classiÔ¨Åcation. We are then faced with deciding how to best use the
ML results, in the context of our goal to provide cluster classiÔ¨Åca-
tions with the highest completeness (fraction of true Class 1 or 2
clusters classiÔ¨Åed as such) and lowest contamination (population of
non-clusters classiÔ¨Åed as clusters). We have several options:

(1) Identify the network which agrees with human classiÔ¨Åcation
of Class 1 or 2 most frequently. That is, select a ‚Äòpreferred network‚Äô
(ResNet or VGG) and adopt its output as the Ô¨Ånal classiÔ¨Åcation.
(2) Combine the modes of each network (per candidate) into a
‚Äòmode consensus classiÔ¨Åcation‚Äô, by accepting a candidate as a com-
pact cluster (either Class 1 or 2, but unspeciÔ¨Åed) if either network
predicts that and the other network does not predict Class 4 (star or
artefact).
(3) Evaluate the mode of all 20 (ten ResNet and ten VGG) predic-
tions in a uniÔ¨Åed sense, to yield a ‚Äòcombined network classiÔ¨Åcation‚Äô.

We now examine the outcomes associated with these options,
and then use the diÔ¨Äerence between resulting compact cluster counts
to: quantify the uncertainty of our ML classiÔ¨Åcation methods, and
to bracket the actual number of detectable Class 1 and 2 clusters in
our data set.

Option 1 (‚Äòpreferred network‚Äô) is the most straightforward way
to proceed, though it should be expected to provide lower accu-
racy than other choices ‚Äì since the confusion matrices of Wei et al.
(2020) suggest the accuracy of each network is approximately on par
with the consistency achieved by a single human if classiÔ¨Åcations
are blindly redone after a period of years. There is no redundancy
against misclassiÔ¨Åcation associated with speciÔ¨Åc downfalls of a net-
work. However, it has the beneÔ¨Åt of simplicity and retains distinction

between Class 1 and 2 (the ‚Äòmode consensus classiÔ¨Åcation‚Äô would
not). In order to decide which network is preferred we compared
the classiÔ¨Åcations for PHANGS-HST human Class 1 and 2 objects
(independently per target) to ResNet and VGG classiÔ¨Åcations. We
Ô¨Ånd that in 3 of 5 targets the number of identically classiÔ¨Åed sources
is highest for the VGG network. For NGC 1433, ResNet is more fre-
quently in agreement with human classiÔ¨Åcation. The two networks
are about equivalent versus Human classiÔ¨Åcation for NGC 3351.
Relaxing the set of PHANGS-HST Human classiÔ¨Åed sources to
also include Class 3 (so 1, 2, or 3), we Ô¨Ånd that VGG classiÔ¨Åca-
tions are more closely aligned with the Human assessment in 4 of 5
targets, and VGG and ResNet are about equivalent for NGC 1433.
Therefore, we take VGG as our ‚Äòpreferred network‚Äô. Whitmore et al.
(2021) independently come to the same conclusion, using diÔ¨Äerent
methods. Comparison of ResNet and VGG mode predictions for hu-
man Class 4 sources, shows that ResNet is very slightly more likely
to agree with human classiÔ¨Åcation that a contaminant is not a clus-
ter. Table 6 lists the number of compact clusters (Classes 1 and 2)
and compact associations (Class 3) identiÔ¨Åed in each of our targets
(plus NGC 3351 LEGUS-only) via the preferred network, VGG.
For completeness we also give the tallies according to ResNet.

Option 2 (‚Äòmode consensus classiÔ¨Åcation‚Äô) is an attempt to
synthesise the classiÔ¨Åcation output of both trained networks, and,
in doing so, provide mitigation against misclassiÔ¨Åcation by VGG
or ResNet operating alone. As deÔ¨Åned above, this option can be
thought of as demanding that a source is agreed upon to not be a
star or artefact (by both network architectures), and has been clas-
siÔ¨Åed as 1 or 2 by at least one of them. As such, it is a balance
between completeness (inclusivity) and contamination. Mode con-
sensus classiÔ¨Åcation results for all Ô¨Åve targets are given in Table 6.
The compact cluster counts are lower than for the preferred network
option, but presumably beneÔ¨Åt from reduced contamination.

Option 3 (‚Äòcombined network‚Äô), in which the mode is evaluated
directly over set of 10+10 (ResNet+VGG) models, is also a means
of synthesising all available runs of ML. It has the advantage over
option 2 of retaining the discrimination between classiÔ¨Åcations 1, 2,
3, and 4. However, it is unclear if the possible drawback of adding
information resulting from a non-preferred network (here ResNet) is

MNRAS 000, 1‚Äì30 (2021)

Star Cluster IdentiÔ¨Åcation in PHANGS-HST

21

Table 6. ClassiÔ¨Åcation outcomes for candidates in the ML sample, and comparison to BCW humanùëé, ùëè, ùëê, ùëë and LEGUS humanùëí classiÔ¨Åcation. Totals are
given following the multiple strategies we considered for interpretation of the ML results. For comparison with human classiÔ¨Åcation of LEGUS we provide
cluster counts for the subset brighter than ùëÄùëâ = ‚àí6 in parentheses. Note that the depth reached for BCW classiÔ¨Åcations conducted as part of PHANGS-HST
is variable, sometimes not reaching as faint as ùëÄùëâ = ‚àí6.

Quantity

Option

NGC 628-C

NGC 628-E

NGC 1433

NGC 1566

NGC 3351 ùëì
(LEGUS-only)

NGC 3351
(all data)

ML sample size

7679 ( 5286 )

2117 ( 982 )

1989 ( 464 )

8822 ( 8768 )

2398 ( 1264 )

3950 ( 1887 )

ML Class 1

ML Class 2

ML Class 3

ML Class 1 or 2

Human Class 1
Human Class 2
Human Class 3
Human Class 1 or 2
Human ClassiÔ¨Åed

LEGUS Class 1
LEGUS Class 2
LEGUS Class 3
LEGUS Class 1 or 2

VGG, preferred network
ResNet
Combined network

1218 ( 871 )
1141 ( 849 )
1156 ( 847 )

317 ( 161 )
313 ( 169 )
310 ( 156 )

VGG, preferred network
ResNet
Combined network

VGG, preferred network
ResNet
Combined network

377 ( 251 )
306 ( 183 )
301 ( 197 )

385 ( 327 )
392 ( 309 )
344 ( 294 )

VGG, preferred network
ResNet
Mode consensus
Combined network

1595 ( 1122 )
1447 ( 1032 )
1218 ( 929 )
1457 ( 1044 )

157 ( 71 )
186 ( 50 )
150 ( 60 )

115 ( 72 )
110 ( 54 )
98 ( 58 )

474 ( 232 )
499 ( 219 )
417 ( 203 )
460 ( 216 )

210 ( 44 )
286 ( 55 )
225 ( 47 )

132 ( 39 )
214 ( 36 )
149 ( 31 )

206 ( 58 )
206 ( 55 )
202 ( 53 )

342 ( 83 )
500 ( 91 )
329 ( 82 )
374 ( 78 )

796 ( 796 )
996 ( 971 )
778 ( 778 )

398 ( 398 )
534 ( 533 )
392 ( 391 )

1143 ( 1143 )
950 ( 950 )
977 ( 977 )

1194 ( 1194 )
1530 ( 1504 )
1068 ( 1068 )
1170 ( 1169 )

320 ( 170 )
359 ( 184 )
323 ( 172 )

206 ( 98 )
285 ( 110 )
214 ( 94 )

202 ( 119 )
219 ( 125 )
200 ( 117 )

526 ( 268 )
644 ( 294 )
478 ( 250 )
537 ( 266 )

440 ( 221 )
458 ( 239 )
429 ( 219 )

247 ( 128 )
399 ( 137 )
272 ( 125 )

337 ( 201 )
240 ( 150 )
282 ( 175 )

687 ( 349 )
857 ( 376 )
629 ( 312 )
701 ( 344 )

260 ( 260 )ùëé
211 ( 211 )ùëé
167 ( 167 )ùëé
471 ( 471 )ùëé
1039 (1039)ùëé

51 ( 51 )ùëé
40 ( 40 )ùëé
14 ( 14 )ùëé
91 ( 91 )ùëé
174 (174)ùëé

87 ( 51 )ùëè
90 ( 50 )ùëè
52 ( 28 )ùëè
177 ( 101 )ùëè
436 (251)ùëè

377 ( 377 )ùëê
257 ( 257 )ùëê
114 ( 114 )ùëê
634 ( 634 )ùëê
1442 (1442)ùëê

113 ( 113 )ùëë
92 ( 91 ) ùëë
68 ( 67 )ùëë
205 ( 204 )ùëë
569 (564)ùëë

136 ( 136 )ùëë
162 ( 162 )ùëë
124 ( 124 )ùëë
298 ( 298 )ùëë
1063 (1063)ùëë

334ùëí
357ùëí
326ùëí
691ùëí

92ùëí
80ùëí
87ùëí
172ùëí

51
61
56
112

258ùëê
214ùëê
261ùëê
472ùëê

118
80
94
198

¬∑ ¬∑ ¬∑
¬∑ ¬∑ ¬∑
¬∑ ¬∑ ¬∑
¬∑ ¬∑ ¬∑

ùëé PHANGS-HST human classiÔ¨Åcation (by BCW) for NGC 628-C and NGC 628-E reached mag 23.0 uniformly.
ùëè PHANGS-HST human classiÔ¨Åcation (by BCW) for NGC 1433 reached mag 24.1 uniformly.
ùëê PHANGS-HST human classiÔ¨Åcation (by BCW) for NGC 1566 reaches mag 23.5 for the complete Ô¨Åeld and is supplemented with spot check regions (one
running E/W across centre, another covering the S corner of Ô¨Åeld) inspected to 24.34. LEGUS classiÔ¨Åcation availability for NGC 1566 is complicated as it
was a mix of pure human and ML (Human: 258 C1, 214 C2, 261 C3, 328 C4; Total: 478 C1, 404 C2, 691 C3, 868 C4). Here we use the human classiÔ¨Åcations.

ùëë PHANGS-HST human classiÔ¨Åcation (by BCW) for NGC 3351 reached mag 24.0 uniformly.
ùëí The LEGUS human classiÔ¨Åcation eÔ¨Äort (Adamo et al. 2017) for NGC 628-C and NGC 628-E was conÔ¨Åned to a region somewhat smaller than the complete
Ô¨Åeld that we analysed. SpeciÔ¨Åcally, the LEGUS team required cluster detection in at least four bands to be considered for inspection, and in these targets
the survey included archival data with diÔ¨Äering coverage. As a result, only clusters in the overlap region between WFC3/UVIS and ACS/WFC imaging were
classiÔ¨Åed. For NGC 628-C, this omits a peripheral area surrounding the WFC3/UVIS coverage. For NGC 628-E, this omits approximately the easternmost
quarter of the WFC3/UVIS Ô¨Åeld and about half of the WNW portion of the ACS/WFC coverage. Imposing the same sky area cut to PHANGS-HST yields
the following counts for ‚ÄòML Class 1 or 2‚Äô in NGC 628-C, VGG 999(758), ResNet 1056(760), consensus 856(670), combined 952(722); and in NGC 628-E,
VGG 392(199), ResNet 411(187), consensus 344(177), combined 375(183). The numbers just given in parentheses have sky and magnitude limit cuts
making them directly comparable to the NGC 628 values in the last line of the table (LEGUS Class 1 or 2).
ùëì This column pertains to analysis of the archival LEGUS data for NGC 3351 (NGC 3351-S in Table 4) without any use of the new NGC 3351-N data
obtained by PHANGS-HST, even in the area of overlap.

overcome by the increase in statistical signiÔ¨Åcance due to more ML
classiÔ¨Åcation votes. We include counts from the ‚Äòcombined network‚Äô
option to inform future work. In general, combined network cluster
counts are between those of VGG and ResNet, or slightly lower
than either. We note this ‚Äòcombined network‚Äô option may have more
meaning in a situation where networks (possibly even the same
architecture) are trained according to diÔ¨Äerent strategies, such as
training with observed clusters (e.g. Wei et al. 2020) versus training
with synthetic clusters and artiÔ¨Åcial stars. Discussion of other varied
training strategies is given in Whitmore et al. (2021).

The choice of which option to use will ultimately be driven by
the speciÔ¨Åc science use-case. If high completeness or retention of

MNRAS 000, 1‚Äì30 (2021)

information regarding Class 1 versus 2 is important then we advise
adopting the straight VGG mode classiÔ¨Åcation. When forming dis-
tribution functions of cluster properties from such VGG classiÔ¨Åed
objects, one could opt to weight by the fraction of VGG votes agree-
ing with the VGG mode, eÔ¨Äectively placing emphasis on the most
certain classiÔ¨Åcations. For those studies that require low contami-
nation and can accept the inability to distinguish Class 1 from 2, we
suggest use of the ‚Äòmode consensus classiÔ¨Åcation‚Äô. We emphasise
that the census of clusters obtained in this manner will still be more
complete than what is provided via PHANGS-HST human classi-
Ô¨Åcation. Presently, we discourage use of the ‚Äòcombined network‚Äô

22

Thilker et al.

classiÔ¨Åcation option until such time as diverse training strategies
have been implemented.

Table 6 indicates that the ratio of Class 1 to Class 2 for ML
(here VGG) is typically a factor of 2 to 4, but this same ratio is
around 1 to 1.5 for human based tallies. The main reason for this
is the brighter magnitude limit for human classiÔ¨Åcation and does
not imply systematic diÔ¨Äerences in how candidates are classiÔ¨Åed
(between ML and human). For instance, human Class 1 clusters are
generally brighter than ML Class 1 because of the limits imposed
by inspection.

What can we say regarding the uncertainty of Class 1 and 2
cluster counts in our analysis? For each galaxy/Ô¨Åeld we interpret
the ‚Äòmode consensus classiÔ¨Åcation‚Äô tally as a lower limit on the
number of Class 1+2 sources, and the maximum of VGG and ResNet
Class 1+2 cluster counts (VGG and ReSNet individually) as an upper
limit. Adopting the mean of these three tallies as a representative
count, we can express the bracketed range as a percent uncertainty
with respect to the mean. We Ô¨Ånd ¬±13%, ¬±9%, ¬±22%, ¬±18%, ¬±16%
respectively for NGC 628-C, NGC 628-E, NGC 1433, NGC 1566,
and NGC 3351. Unfortunately, analogous percentage uncertainties
from LEGUS analysis are not available for comparison.

6.4 Comparison of class 1 and 2 clusters in PHANGS-HST

versus LEGUS

It is vital to develop an understanding for potential diÔ¨Äerences be-
tween the Class 1 and 2 cluster populations identiÔ¨Åed by our new
method and the techniques used by others. As noted earlier in the
text, we chose to compare against the LEGUS survey, as several
galaxies are in common between the projects and, even for targets
that diÔ¨Äer, equivalent Ô¨Åve band ùëÅùëàùëâ-ùëà-ùêµ-ùëâ-ùêº ùêªùëÜùëá data are em-
ployed. We anticipated both random and systematic diÔ¨Äerences in
the resulting catalogues, with the former associated primarily to
classiÔ¨Åcation uncertainty and the later linked to changes in source
detection / candidate selection procedures. We did not undertake
a head-to-head comparison of the Class 3 objects (compact as-
sociations) resulting from our cluster identiÔ¨Åcation pipeline versus
LEGUS, as our methods were tuned to preferentially identify single-
peaked cluster-like objects.

We Ô¨Årst generate a set of sources to guarantee a fair comparison
between the surveys. We account for diÔ¨Äerences in photometry and
coverage. LEGUS classiÔ¨Åed cluster candidates down to ùëÄùëâ = ‚àí6,
eÔ¨Äectively setting the faint end for comparison. Not surprisingly,
slight diÔ¨Äerences in aperture corrections, photometric scatter (from
minimal shifting of candidate centres), and occasional changes in
aperture size suggest that in some cases we should back oÔ¨Ä from the
‚àí6 limit to ensure that objects brighter than ùëÄùëâ = ‚àí6 in PHANGS
are also above this limit in LEGUS. The magnitude limits were
allowed to vary by target and for machine learning classiÔ¨Åcation-
based comparisons versus human classiÔ¨Åcation. The adopted values
are given in Table 7. For our ML-based comparison the limit is
generally up to 0.2 mag brighter than ùëÄùëâ = ‚àí6, though LEGUS
only classiÔ¨Åed sources down to ùëÄùëâ = ‚àí7 in NGC 1566. For our
human classiÔ¨Åcation-based analysis, the limit is even brighter for
NGC 628-C, NGC 628-E, and NGC 1566, as these galaxies have
very rich cluster populations and it was not practical for our expert
human classiÔ¨Åer (BCW) to inspect the entire population. Finally, of
importance when setting the scope of comparison, for NGC 628-C
and NGC 628-E the observational data were a mix of WFC3/UVIS
and ACS/WFC imaging. These cameras have a diÔ¨Äerent size on
the sky and were not forced to have identical orientation. LEGUS
only searched for clusters in the intersection of WFC3/UVIS and

ACS/WFC coverage, whereas we allow cluster candidates anywhere
with coverage in at least three bands, including ùëâ (ùêπ555ùëä). Ac-
cordingly we cut back the footprint of the survey comparison to
the region with LEGUS classiÔ¨Åcations. Our eventual ‚Äòcomparison
sets‚Äô are deÔ¨Åned as the union of Class 1 or 2 clusters from either
PHANGS-HST or LEGUS meeting the magnitude and sky area cri-
teria described above. Table 7 gives the number of sources in the
comparison sets as the Ô¨Årst row in each section of the table.

Within this comparison set for each target we tallied the num-
ber of Class 1 or 2 clusters: (a) found by PHANGS-HST, (b) found
by LEGUS, (c) found by both surveys, (d) found by PHANGS-HST
but not LEGUS, and (e) found by LEGUS but not PHANGS-HST.
These cluster counts are listed in Table 7, along with their associated
percentage of the entire comparison set. The percentages are also
presented graphically in Fig. 14. In a panel devoted to each target
and the type of PHANGS-HST classiÔ¨Åcation (ML or human), the
inner ring of each doughnut plot shows basic results of the survey
comparison. Relative to the entire comparison set (think of this as
anything that could possibly be a Class 1 or 2 cluster), the surveys
agree at a signiÔ¨Åcant percentage (case (c) above), approximately
50% for ML (median 47%) and slightly higher for human classiÔ¨Å-
cations (median 57%). Agreement is weakest for NGC 1433, with
38% for ML and 40% for human classiÔ¨Åcation. Survey agreement
also falls for NGC 1566, which we believe is a consequence of
its substantially larger distance. This also makes sense in terms of
NGC 1433, which Anand et al. (2021) have shown is actually at a
distance of 18.6 Mpc rather than the 8.3 Mpc we assumed (in this pa-
per only) for consistency with LEGUS. The percentages discussed
above should not be interpreted in terms of completeness, since
some objects will be identiÔ¨Åed as clusters by one survey but not by
the other, and because the source list itself includes at least some
non-clusters from both surveys. Rather, this ‚àº 50‚àí60% agreement
reÔ¨Çects that both LEGUS and PHANGS-HST are likely returning
Class 1 and 2 cluster samples with at least this level of accuracy.

At face value, the higher and generally rather similar percent-
ages of the comparison set reported for PHANGS-HST (case (a) ‚Äì
blue+green in Fig. 14) and LEGUS (case (b) ‚Äì red+green) suggest
that recovery of the true Class 1 or 2 population is indeed higher
than the intersection statistics above require as a minimum. The
median percentage recovered by the surveys for ML is 73% and for
human classiÔ¨Åcation is 77%, calculated by integrating over both sur-
veys without preference. Of course, both surveys are likely subject
to contamination and incompleteness. Contamination in particular
will make the case (a) and (b) percentages skewed misleadingly high
for the survey with the issue and low for the other survey. Without a
more detailed look at the objects seemingly missed by either survey
it is diÔ¨Écult to interpret any further than to say that both surveys
most likely recover on the order of 75% of true Class 1 or 2 clus-
ters meeting the magnitude/footprint constraints, and if systematic
identiÔ¨Åcation/misclassiÔ¨Åcation exists then this Ô¨Ågure will drop or
rise accordingly depending on which survey has the problem.

Blue and red shaded portions of the outer rings of the dough-
nut plots in Fig. 14 aim to better understand the types of sources for
which the surveys Ô¨Ånd diÔ¨Äerent classiÔ¨Åcations. We begin with ob-
jects identiÔ¨Åed as Class 1 or 2 by PHANGS-HST but not by LEGUS
(shown in blue). The wedges labelled L3 and L4 were classiÔ¨Åed
as Class 3 and Class 4, respectively, by LEGUS (but Class 1 or 2
by PHANGS-HST). Approximately one quarter to one third of the
PHANGS-HST-only Class 1 or 2 population falls into this category.
We note that this happens more often in NGC 3351 than for other
targets (42% for ML, 58% for human). In the case of human classi-
Ô¨Åcation, this may be due to the greater exposure depth (which was

MNRAS 000, 1‚Äì30 (2021)

Star Cluster IdentiÔ¨Åcation in PHANGS-HST

23

Figure 14. Class 1 and 2 cluster population comparison between PHANGS-HST and LEGUS. The inner ring of each doughnut plot illustrates the fractional
division of the comparison set into: objects belonging to the Class 1+2 survey intersection, (green, ‚ÄôBOTH‚Äô); objects identiÔ¨Åed as Class 1 or 2 only by
PHANGS-HST (blue, ‚ÄôPHANGS‚Äô); and objects identiÔ¨Åed as Class 1 or 2 only by LEGUS (red, ‚ÄôLEGUS‚Äô). The outer ring breaks these populations down
further, showing the cause of the inconsistency, whether due to diÔ¨Äering classiÔ¨Åcation (labels ending in 3 or 4, e.g. ‚ÄôH3‚Äô, ‚ÄôH4‚Äô, ‚ÄôML3‚Äô, ‚ÄôML4‚Äô, ‚ÄôL3‚Äô, ‚ÄôL4‚Äô ‚Äì
where, for instance, ‚ÄôH3‚Äô indicates the source was classiÔ¨Åed by a human as Class 3 in the survey for which it did not survive as Class 1 or 2), non-detection as
a candidate (‚ÄòNo ID‚Äô), Ô¨Çagging as a double (‚ÄôDbl‚Äô), or some other unspeciÔ¨Åed reason (‚Äô*‚Äô). For objects that do appear as either Class 1 or 2 in both surveys,
the green outer wedge indicates the fraction having equal Class (1 and 1, or 2 and 2, labelled ‚ÄôEqual‚Äô) or swapped class (1 and 2, labelled ‚ÄôUnequal‚Äô). See
the text for detailed description of each subclass. (Top row) Comparison outcome based on PHANGS-HST machine learning classiÔ¨Åcations. (Bottom row)
Comparison outcome based on human classiÔ¨Åcation. Note that the comparison set of objects is determined independently per object and also for ML and
human classiÔ¨Åcations, with the ML outcomes ultimately based on a larger number of objects extending to fainter magnitudes. See the text for details.

Table 7. Comparison between the Class 1 and Class 2 cluster populations of PHANGS-HST and LEGUS

Quantity

NGC 628-C

NGC 628-E

NGC 1433

NGC 1566

ML comparison set
ML set: ùëÄùëâ limit
ML set: PHANGS
ML set: LEGUS
ML set: Bothùëè
ML set: PHANGS not LEGUS
ML set: LEGUS not PHANGS

Human comparison set
Human set: ùëÄùëâ limit
Human set: PHANGS
Human set: LEGUS
Human set: Bothùëè
Human set: PHANGS not LEGUS
Human set: LEGUS not PHANGS

929
-6.15
690 (74%)
677 (74%)
438 (47%)
252 (27%)
239 (26%)

457
-7.0
361 (79%)
354 (77%)
258 (56%)
103 (22%)
96 (21%)

250
-6.0
205 (82%)
169 (68%)
124 (50%)
81 (32%)
45 (18%)

88
-7.0
76 (86%)
77 (87%)
65 (74%)
11 (13%)
12 (14%)

126
-6.15
70 (55%)
104 (83%)
48 (38%)
22 (17%)
56 (44%)

130
-6.15
88 (68%)
88 (68%)
62 (48%)
26 (20%)
42 (32%)

1270
-7.0
906 (71%)
869 (68%)
505 (40%)
401 (31%)
364 (29%)

780
-7.8
558 (71%)
596 (76%)
374 (48%)
184 (23%)
222 (28%)

NGC 3351ùëé
(LEGUS-only)

264
-6.2
228 (86%)
186 (70%)
150 (57%)
78 (29%)
36 (14%)

241
-6.2
193 (80%)
186 (77%)
138 (57%)
55 (23%)
48 (20%)

ùëé This column pertains to analysis of the archival LEGUS data for NGC 3351 (NGC 3351-S in Table 4) without any use

of the new NGC 3351-N data obtained by PHANGS-HST, even in the area of overlap.

ùëè Lines in boldface show that if one considers the union of Class 1 and 2 clusters in both surveys to be the true population,
PHANGS-HST and LEGUS agree at the 48‚Äì74% (56% median) level for human classiÔ¨Åed objects brighter than
ùëö(ùëâ ) ‚àº 23.5 and 38‚Äì57% (47% median) level for PHANGS-HST ML classiÔ¨Åed objects brighter than ùëö(ùëâ ) ‚àº 24.

not used in ML), in the overlapping LEGUS and PHANGS-HST
Ô¨Åelds. An even larger contribution (‚àº 40‚àí70%) to this misclas-
siÔ¨Åcation category comes from sources which were somehow not
even considered by LEGUS (labelled ‚Äòno ID‚Äô). These result from
intrinsic diÔ¨Äerences in the types of sources detected by SExtractor
versus DOLPHOT, or due to automated cuts made by LEGUS after
the detection stage (CI, number of bands with good photometry).
A minority of sources, belonging to doughnut wedges labelled with

asterisks, were at least considered as LEGUS candidates and seem to
have met the conditions for LEGUS classiÔ¨Åcation given by Adamo
et al. (2017) but did not receive an eventual class for some reason
we have not been able to determine. Next, we examine the sources
deemed Class 1 or 2 by LEGUS but not by PHANGS-HST (red re-
gion in the outer doughnut). A Ô¨Årst category is comprised of sources
we Ô¨Çag as ‚Äòdoubles‚Äô (see Sec. 4.4), where two objects are detected
within 2.5 pixels of one another. Extended sources at such small

MNRAS 000, 1‚Äì30 (2021)

24

Thilker et al.

Figure 15. Human classiÔ¨Åcation results for the comparison subset of LEGUS Class 1 or 2 objects labelled as Class 4 (contaminant) by PHANGS-HST. See
the text for details of each subclass. Low number statistics are a concern for NGC 628-E and NGC 1433, so the most attention should be focused on the other
targets (having more sources represented) in these plots.

association because the only evidence remaining of cluster-nature
is the very inner proÔ¨Åle of the source, which can be overridden or
overlooked due to environment. We have no reason to believe this
happens more often in either survey, and the ML3/H3 fractions are
indeed similar to H3 in Fig. 14. A far more signiÔ¨Åcant (and sys-
tematic) classiÔ¨Åcation trend between LEGUS and PHANGS-HST
is represented by the ML4/H4 wedges which dominate the LEGUS-
only Class 1 or 2 population. In most targets more than 50% (and
up to > 70%) of LEGUS Class 1 or 2 sources not called 1 or 2 by
PHANGS-HST are instead classiÔ¨Åed as contaminants by PHANGS-
HST. We return to this point below. Finally, a small percentage of
LEGUS Class 1 or 2 clusters are omitted from the PHANGS-HST
Class 1 or 2 census for reasons we did not track down (red outer
wedge labelled with asterisk), but possibly these sources failed cuts
on MCI error.

In the case of the human comparison set, we have more detailed
information on the appearance of sources LEGUS called Class 1
or 2 and PHANGS-HST classiÔ¨Åed as contaminants (that is, Class 4
in the original LEGUS system, and now subdivided by BCW into
Classes 4.1, 4.2, . . . , 4.12 in order to specify the variety of con-
taminant cluster candidate, e.g. single star, stellar pair, stellar triple,
saturated star, diÔ¨Äraction spike, galaxy nucleus, background galaxy,
etc. ‚Äì see Whitmore et al. (2021) for details). In Fig. 15, we show
doughnut charts for these human Class 4 (‚ÄòH4‚Äô) sources, splitting
them into up to six BCW subclasses (others of the 12 were not
encountered). SpeciÔ¨Åcally, the H4 sources are classiÔ¨Åed as a single
star, pair or triple stars, redundant (another accepted Class 1, 2, 3
within 5 pixels), edge artefact, or too faint to classify. This categor-
ical assessment of contributors to the H4 LEGUS-only population
is most informative/reliable in cases having many sources. For this
reason NGC 628-E and NGC 1433 should be viewed cautiously, as
they each have (cid:54) 15 H4 sources (only 8 in NGC 628-E).

The Ô¨Årst observation to be made from Fig. 15 is that sources
appearing to BCW as single stars are a minority in this population,
amounting to less than 25% in all cases. The bulk of H4 sources are
thought to be pairs or triples of stars according to the PHANGS-
HST human classiÔ¨Åcation. In general pairs constitute ‚àº 45%, and
triples ‚àº 33%, of the H4 LEGUS-only population. Combined with
the already Ô¨Çagged ‚Äòdoubles‚Äô from the analysis above, we conclude
that the majority of objects called Class 1 or 2 by LEGUS and not
by PHANGS-HST are actually multiple stellar sources not meeting
the source surface density needed to qualify as Class 3 associa-
tions. Whitmore et al. (2021) describes how this distinction is set by
counting peaks within a 5 pixel radius. This eÔ¨Äect is probably ac-
centuated by situations in which SExtractor does not deblend such
multiples and places a source between the actual peaks. This is a par-
ticular strength of using the PSF-Ô¨Åtting source detection algorithm
(DOLPHOT) for our work, though it comes with the price of spu-

MNRAS 000, 1‚Äì30 (2021)

Figure 16. Cluster mass versus age for Class 1 or 2 clusters in NGC 628-C.
With open circles we plot the clusters recovered via human classiÔ¨Åcation.
Dots represent the ML classiÔ¨Åed population. Green colour is used for Class 2
(asymmetric) clusters, whereas blue circles and black dots represent Class 1
objects. Note the marked extension of the ML population to lower masses
and higher ages. The greyscale histogram behind the plotted points shows
the number density of ML clusters (Class 1 and 2 together).

separations, even if real and not a redundant DOLPHOT detection
of the wings of the brighter extended object, would be challeng-
ing to classify accurately. We Ô¨Ånd that 10‚àí20% of the LEGUS
Class 1 or 2 objects not included by PHANGS-HST fall into this
category. Whitmore et al. (2021) also comment on the preferen-
tial inclusion of ‚Äòdoubles‚Äô by LEGUS, and Ô¨Ånd they are typically
assigned to Class 2. DiÔ¨Äerences in classiÔ¨Åcation between surveys
can also be seen as many PHANGS-HST Class 1 or 2‚Äôs are called
Class 3 or 4 by LEGUS. In terms of Class 3 (see ML3, H3 doughnut
wedges), they amount to ‚àº15%. One comment applicable to both
survey classiÔ¨Åcation eÔ¨Äorts is the diÔ¨Éculty in classifying objects in
crowded environments ‚Äì this is particularly relevant to the distinc-
tion between Class 3 and Class 1+2. For example, imagine taking a
conÔ¨Ådent Class 1 or 2 cluster and placing it in a region with many
point sources or even other clusters. Based on the relative location of
objects, it is possible that such a Class 1 or 2 is frequently judged by
the classiÔ¨Åer (either ML or human) as an apparent Class 3 compact

Star Cluster IdentiÔ¨Åcation in PHANGS-HST

25

Figure 17. Spatial distribution of PHANGS-HST Class 1 and 2 clusters identiÔ¨Åed in NGC 628-C, restricted to the area of WFC3/UVIS+ACS/WFC overlap,
as the accuracy of our age determination is negatively impacted by the loss of ùëÅ ùëà ùëâ - and ùëà -band photometry outside the (relatively smaller) WFC3/UVIS
footprint. (Left) The distribution of recovered Class 1 or 2 clusters according to the ML catalogue. (Right) The equivalent Ô¨Ågure using human classiÔ¨Åcations.
Note how the increased number of clusters in the ML catalogue makes it substantially easier to see spatial trends in age, such as those associated to spiral
structure (the arms deÔ¨Åned by Querejeta et al. 2021 are outlined). Note that much of the very young star-forming population is excluded here, as we do not
show Class 3 objects (see multi-scale associations of Larson et al. 2021, instead). This higher recovery rate of clusters will directly improve cross-correlation
analyses with other objects such as CO clouds.

rious detections in the wings of bright objects (largely eliminated
by our doubles check, Sec. 4.4) and the need to explicitly elimi-
nate redundant counting of associations due to proper deblending
of subclumps (last paragraph of Sec. 4.4). The subclasses not yet
described (redundant, edge, too faint) remain in the minority across
the entire H4 population, with faint objects only cropping up in
NGC 1566 and edge artefacts in NGC 1566 and NGC 628-E. The
slightly more numerous ‚Äòredundant‚Äô population can be attributed to
diÔ¨Äerences in source detection between surveys.

Lastly, we emphasise one Ô¨Ånal point from Fig. 14 concerning
exact classiÔ¨Åcation agreement. In the outer ring of the doughnut
plots, in two shades of green, we indicate the fraction of Class 1
or 2 clusters in common between surveys that were given the same
Class (e.g. 1 and 1; 2 and 2) with the darker wedge, and those
that disagreed (e.g. 1 and 2; 2 and 1) with the lighter colour. Quite
commonly the survey classiÔ¨Åcation agreed on speciÔ¨Åc Class for
this subset of the the overall comparison set. We direct the reader
to Whitmore et al. (2021) for a detailed, extensive discussion of
confusion between classes, including a discussion of confusion ma-
trices for cross-survey (PHANGS-HST versus LEGUS) and internal
(VGG versus ResNet, human versus VGG, etc.) comparisons.

Complementing the limited PHANGS-HST-ML to LEGUS-
human classiÔ¨Åcation results (top row of Fig. 14) of this Section,
we direct the reader to the more extensive analysis of similar issues
by Whitmore et al. (2021). In particular, Whitmore et al. (2021)
introduce use of the colour-colour diagram as a ‚ÄôÔ¨Ågure of merit‚Äô to
further test the relative performances of the diÔ¨Äerent methods.

MNRAS 000, 1‚Äì30 (2021)

6.5 Resulting PHANGS-HST cluster catalogues

This paper is not intended to provide astrophysical analysis of the
cluster populations recovered by our methods, but rather to focus
on the adopted procedures. Nevertheless, without presentation of
some scientiÔ¨Åcally relevant plots, it would be impossible to fully
appreciate the improvement we have attained relative to previous
works, except in the sense of the comparison described in Sec. 6.4.
In Fig. 16, we show the PHANGS-HST Class 1+2 clusters identi-
Ô¨Åed by human and ML classiÔ¨Åcation for NGC 628-C. Fig. 17 shows
the spatial distribution of clusters for the same Ô¨Åeld (trimmed to
the WFC3/UVIS+ACS/WFC footprint) colour-coded by age in both
contexts. These Ô¨Ågures displaying our results for one target are both
internally instructive, emphasising the more expansive cluster pop-
ulation recovered using ML classiÔ¨Åcation relative to human-based
eÔ¨Äorts, and also can be compared versus the results of Adamo et al.
(2017) who used the same data. Appendix A contains equivalent
Ô¨Ågures for all the Ô¨Åelds analysed in our paper.

7 DISCUSSION

7.1 General comments on our overall strategy

A limiting step in most studies of extragalactic star clusters is the
manual eÔ¨Äort needed to remove artefacts from candidate lists. It
is diÔ¨Écult to automatically identify candidate star clusters with a
high degree of certainty due to environmental complexity (eÔ¨Äects
such as crowding and high background), in addition to resolution
limits. The MCI approach we introduced was originally designed to
reduce the number of candidate star clusters that would need to be
manually examined to remove artefacts such as pairs of stars, back-
ground galaxies, edge eÔ¨Äects, etc. The basic strategy was to leverage

26

Thilker et al.

photometry from several apertures rather than just the two used to
determine the concentration index (CI), which has been the stan-
dard way to Ô¨Ålter out artefacts. In this way, selection criteria could
be enforced that insured that the proÔ¨Åle followed a typical proÔ¨Åle
of a cluster rather than a star, pair of star, or other more compli-
cated morphologies. Original trials using this approach were largely
successful, reducing the size of the candidate list by about 50%.

During implementation, several other considerations reduced
this percentage somewhat, while enabling other improvements to
the overall strategy. One example is that the selection routine for
both stars and cluster candidates has been uniÔ¨Åed to use a sin-
gle primary method (DOLPHOT), rather than using two completely
diÔ¨Äerent methods employed by many other projects. This elimi-
nates the necessity for subsequently cross matching the stellar and
cluster catalogues after totally independent selection/classiÔ¨Åcation
decisions have been made, which would otherwise be a signiÔ¨Åcant
source of noise and complexity at a later stage of a project. How-
ever, a side-eÔ¨Äect of the use of DOLPHOT is that it introduces a much
larger initial candidate list since DOLPHOT‚Äôs selection routine uses
an iterative method to optimally deblend neighbouring sources and
Ô¨Ånd fainter, inconspicuous sources in the wings of bright objects.
This is the main source of the growth of our candidate cluster lists.
Another similar, but less important eÔ¨Äect from a growth standpoint
is the development of a more sophisticated method of removing
point-like objects, allowing us to include proportionately more (of
particularly compact) cluster candidates than possible using only
the concentration index, hence improving the completeness levels.
The MCI approach also enables other potential improvements,
many of which will be more evident in later stages of the PHANGS-
HST project. For example, the development of cluster models
needed to deÔ¨Åne selection regions for the MCI values will be useful
in the analysis of various physical characteristics of the clusters,
such as whether the objects are likely to be bound or unbound,
whether certain kinds of potential proÔ¨Åles (e.g. very diÔ¨Äuse) are not
actually found in nature, and how the proÔ¨Åles of clusters change as
a function of age.

In summary, while some of the initial goals of the MCI method
have not been fully realised (i.e. the reduction in the candidate list),
the overall improvements to the project is evident and is expected
to have long range beneÔ¨Åts relative to the PHANGS-HST science
goals and cluster studies in general.

7.2 Realised scientiÔ¨Åc advantages of our method

Our fully integrated pipeline for cluster detection, identiÔ¨Åcation,
and ML classiÔ¨Åcation produces reliable catalogues of clusters with
minimal human eÔ¨Äort. These catalogues have clear advantages over
prior eÔ¨Äorts, even using the same observational data and neglecting
the relative ease with which they can be generated. This subsection
is devoted to highlighting such scientiÔ¨Åc beneÔ¨Åts in broad terms.

The advantage of reproducibility, and presumed replicability,
should not be understated. Even within LEGUS, the premier cluster
study prior to PHANGS-HST, attaining reproducibility was chal-
lenging (P√©rez et al. 2021). The burden of human classiÔ¨Åcation rel-
ative to the limited pool of trained team member classiÔ¨Åers (‚àº 12)
led to compromises in the uniformity of the adopted procedure. For
instance, in general for each galaxy only a small subset (3 people) of
classiÔ¨Åers examined the candidates (Adamo et al. 2017). This could
impart systematic diÔ¨Äerences in the eÔ¨Äective classiÔ¨Åcation scheme
between targets, if individual volunteers gave more weight to dif-
ferent aspects of the classiÔ¨Åcation procedure. In cases where the
number of candidates per target were very high, the classiÔ¨Åcation

task was divided across the galaxy, assigning stripes of coverage to
diÔ¨Äerent subsets of the classiÔ¨Åcation group. It should be said that
membership in each subset was shuÔ¨Ñed, and the mode was adopted
as Ô¨Ånal judgement amongst the classiÔ¨Åcation votes per candidate,
in hopes of minimising systematic eÔ¨Äects. The adopted LEGUS
method represents the best that can be achieved with a small group
of human volunteers. 15

For PHANGS-HST, at no stage in the ML classiÔ¨Åcation branch
of our pipeline does human judgement enter the procedure in real
time, so in one sense our analysis is reproducible. However, the
training of the ML network embodies the non-reproducible16 ex-
pert knowledge of cluster classiÔ¨Åcation of co-author BCW, as well
as the collective eÔ¨Äorts of LEGUS classiÔ¨Åers (used for training by
Wei et al. 2020 alongside BCW-only classiÔ¨Åcations). Because there
are humans involved in the construction of the training sets, the
outcome of the procedure may change if the training set is con-
structed by a diÔ¨Äerent human[s], though Wei et al. (2020) conclude
that LEGUS and BCW training sets seem to produce comparable
accuracies. We expect ML classiÔ¨Åcation accuracy to improve with
further training method experimentation and as the database of hu-
man classiÔ¨Åed objects grows and becomes fully representative, both
factors described by Whitmore et al. (2021). Systematics can still
exist in our ML classiÔ¨Åcation, dependent upon the overall suitability
of the training sets to the actual objects being classiÔ¨Åed, and pos-
sibly on the degree to which the training sets are balanced among
classes (clusters versus stars versus artefacts) or even among cluster
morphologies within a class (physically large clusters versus com-
pact). In regard to overall suitability, the majority of galaxies in
the full PHANGS-HST sample are more distant than the LEGUS
targets that were used by Wei et al. (2020). This is one of the main
reasons that we still undertake human classiÔ¨Åcation in our project,
with the goal of accumulating a training sample that probes a more
fully representative range of distance spanning the Local Volume
(e.g. LEGUS) out to objects beyond the Virgo cluster (some of the
PHANGS-HST targets). In essence, the construction of a training set
should be seen as an integral part of the ML procedure, not as some-
thing that precedes it. To summarise, we hope that full adoption of
ML classiÔ¨Åcation by the star cluster community (see also important
work by P√©rez et al. 2021 and Bialopetraviƒçius et al. 2019) will lead
to replicability amongst groups that often have somewhat diÔ¨Äerent
data sets, and such replicability can build consensus regarding our
understanding of cluster formation / evolution / destruction.

Secondly, and in a more practical sense, another methodolog-
ical advantage is that by relying on ML classiÔ¨Åcation we enable
complete evaluation of all candidates down to our detection (se-
lection) limit. Naturally, classiÔ¨Åcations of fainter objects can be
expected to individually be less conÔ¨Ådent (distinguishing between
Class 1 and Class 2 for example) than for bright analogues in the
same environment (see Whitmore et al. 2021). However, integrated
over an ensemble of many objects the cluster / not-a-cluster ML
evaluation (that is, Class 1 or 2, or not) is still reliable near the

15 Experimentation with citizen science based classiÔ¨Åcation was undertaken
by LEGUS as well, to potentially overcome the limits of person power, but
the lack of interactive inspection tools (image contrast, radial proÔ¨Åles) on
current platforms led to the conclusion this was not yet feasible. We note that
in the more resolved case of the Magellanic Clouds, and M31 / M33 (with
ùêª ùëÜùëá ), citizen science cluster identiÔ¨Åcation has proven rather successful
(e.g. Johnson et al. 2012).
16 Whitmore et al. (2021) highlight the fact that even an expert reviewer,
conducting classiÔ¨Åcations of the same objects separated by a period of
several years, will assign a small fraction of clusters to diÔ¨Äering classes.

MNRAS 000, 1‚Äì30 (2021)

faint limit of our candidate selection (ùëâ-band S/N ‚àº 10), based on
spot checks of deeper human classiÔ¨Åcation versus the ML classiÔ¨Å-
cation. We emphasise further that by classifying our complete list
of candidates we are able to include the often substantial, easy to
classify population of faint candidates occupying isolated, low sur-
face brightness, low confusion environments. These typically get
missed by human classiÔ¨Åcation eÔ¨Äorts, unless speciÔ¨Åcally remedied
post facto (e.g. over 100 faint diÔ¨Äuse sources were added manually
to the NGC 4449 sample in Whitmore et al. 2020).

Unfortunately, improved recovery of faint clusters enabled by
ML is counteracted by losses in our ability to determine accurate
photometric ages for young star clusters with mass (cid:47) 104 M(cid:12) due
to stochasticity (e.g. Fouesneau et al. 2014; Krumholz et al. 2015;
Hannon et al. 2019; Whitmore et al. 2020). In some science use
cases requiring single object characterisation, this may limit the
usefulness of clusters at faint apparent magnitude, particularly as
galaxy distance decreases.

Even so, ML classiÔ¨Åcation for complete candidate samples
dramatically increases the number of recovered clusters, translat-
ing into statistical improvement in the age‚Äìmass diagram, reaching
signiÔ¨Åcantly lower mass at Ô¨Åxed age, or alternatively greater age
at Ô¨Åxed mass. In Fig. 16, we show the PHANGS-HST Class 1+2
clusters identiÔ¨Åed by human (open circles) and ML classiÔ¨Åcation
(dots). Class 2 clusters are colour-coded green. Notice how the ML
population reaches masses about 0.5 dex (‚àº 3√ó) lower than the hu-
man classiÔ¨Åcation. In the alternative perspective, at Ô¨Åxed mass (at
least for intermediate age clusters), the ML catalogue probes up to
a factor ten older in age. Appendix A includes age‚Äìmass diagrams
for all the Ô¨Åelds analysed in this paper. The degree of human-to-ML
improvement varies within the Ô¨Åve Ô¨Åelds, owing to diÔ¨Äerences in
depth of the human classiÔ¨Åcations.

There are numerous trickle-down scientiÔ¨Åc gains to expect
coming from expansion of the identiÔ¨Åed cluster population. For ex-
ample, improvements in the age‚Äìmass diagram will impact studies
of the cluster mass function by allowing the bins in age that are
typically used to each extend to lower mass (e.g. R. Chandar et al.
in prep, note that the intermediate age clusters are often examined
separately as they have survived removal from their natal environ-
ment). This will generally boost the statistical signiÔ¨Åcance of mass
function Ô¨Åt results through increased numbers, and may perhaps al-
low sensitivity to detect broken power law mass functions. Far better
populated age‚Äìmass diagrams will yield improvement in modelling
of cluster disruption (mass dependent versus mass independent) as
it provides additional statistics for low mass clusters in an evolved,
intermediate age state. We anticipate Œì (the fraction of star forma-
tion occurring in bound clusters, e.g. Bastian 2008; Kruƒ≥ssen 2012)
determinations will increase, given that some of the newly recov-
ered clusters are of Class 1 and have ages signiÔ¨Åcantly larger than
their crossing time (thus are likely bound at high conÔ¨Ådence).

Another trickle-down scientiÔ¨Åc gain from the increased num-
ber of clusters is improvement of studies that use clusters as ‚Äòclocks‚Äô
to estimate timescales for physical processes via cross-correlation
analyses (such as cloud disruption, via comparison to the ALMA CO
catalogues unique to PHANGS-HST). This is due to the increased
surface density of the recovered cluster population in the ML census
versus human classiÔ¨Åcation outcome, as best appreciated in Fig. 17.
Note the improved clarity of patterns in age in the ML cluster distri-
bution. Appendix A presents the full set of ML classiÔ¨Åed catalogue
spatial distributions. In the timescale ‚Äòclock‚Äô application, having a
more complete cluster catalogue means that the power of apparent
physical association between cluster and cloud will contribute to
the cross-correlation function at the ‚Äòcorrect‚Äô length scale more fre-

MNRAS 000, 1‚Äì30 (2021)

Star Cluster IdentiÔ¨Åcation in PHANGS-HST

27

quently than otherwise in the limited human catalogue. Viewed in
another way, thinking in terms of nearest neighbour analysis, incom-
pleteness in a cluster catalogue might lead to the ‚Äòwrong‚Äô neighbour
being selected. This being said, measurements (e.g. Cook et al.
2019) of Œì in main sequence galaxies like those in the PHANGS-
HST sample are generally (cid:47) 30%, and will almost certainly remain
less than 50% even with expanded cluster catalogues. Therefore,
in order to capture the majority of the star formation activity, we
stress the importance of using other localized tracers such as the
most compact multi-scale associations (e.g. Larson et al. 2021) as
well for timescale ‚Äôclock‚Äô applications.

Lastly, although discussed at length in the previous Section, we
end the presentation of scientiÔ¨Åc beneÔ¨Åts associated to our methods
by reiterating the improvement we achieved with respect to exclud-
ing (often random) pairs and triples of point-like sources from the
Class 1 and 2 census. This reduction in contamination is partially
due to our speciÔ¨Åc attention to this issue but also due to our adop-
tion of DOLPHOT rather than SExtractor as source detection code.
Our choice to use DOLPHOT as a starting point also strategically
facilitates a self-consistent inventory of point sources and clusters,
and enables determination of multi-scale stellar associations (e.g.
Larson et al. 2021). Fig. 18 illustrates the combined census of star
formation products attained by PHANGS-HST by displaying the
associations and clusters of NGC 628-C together. It is abundantly
clear that a complete view of recent (few 107 yr) star formation
requires methods that capture structures spanning from very likely
bound (Œ† > many), possibly but indeterminately bound (Œ† (cid:47) few),
to unbound and already dissolved/disrupted. Another illustration
of the innovative PHANGS-HST approach to combined recovery
of clusters and associations can be found in Fig. 9 of Lee et al.
(2021), highlighting a region of NGC 3351 with all components
of our multi-observatory PHANGS program displayed. With the
union of PHANGS cluster, association, CO cloud (from ALMA),
and H ii region (from MUSE and traditional narrowband imaging)
catalogues we will be able to place unprecedented constraints on
the cyclic process of star formation in nearby galaxies.

8 CONCLUDING REMARKS

In this paper we have described a new analysis pipeline developed for
the PHANGS-HST survey, designed to detect, measure, optimally
select, and morphologically classify star cluster candidates.

Our pipeline employs innovative strategies such as: (1) source
detection and deblending using PSF photometry code DOLPHOT,
leading to self-consistency between cluster and association cata-
logues, (2) cluster candidate selection based on multiple concen-
tration indices (MCIin and MCIout) that more fully characterise the
source morphology than possible with a single CI, (3) selection
criteria optimised with guidance from synthetic clusters and previ-
ously conÔ¨Årmed clusters, and with special allowance for potential
candidates more luminous than the Humphreys-Davidson (H-D)
limit, and lastly (4) fully-pipelined ML classiÔ¨Åcation of cluster can-
didates.

To test the performance of our method, we apply the pipeline
to four galaxies: NGC 628, NGC 1433, NGC 1566, and NGC 3351,
with assumed distances between 8.3 and 18 Mpc. Across the four
galaxies, the median candidate sample size selected for ML (human)
classiÔ¨Åcation is 3389 (2366) with range of 1989‚Äì8822 (1230‚Äì5695).
The median number of candidates in each galaxy classiÔ¨Åed by a
human (limited by practicality) is 1039 with range of 174‚Äì1442;
the median number of these sources which are veriÔ¨Åed to be single-

28

Thilker et al.

Figure 18. For a small portion of the NGC 628-C Ô¨Åeld, located in a spiral arm west of the galaxy center, we show PHANGS-HST Class 1 and 2 ML clusters
(as green circles) and the hierarchical associations of Larson et al. (2021) determined on 32 and 64 pc scales using NUV point-sources (as purple and orange
polygons, respectively). The HST image is a colour composite constructed from ùêº , ùëâ , ùêµ as red, green, and blue.

peaked star clusters (Class 1 or 2) is 298 with range of 91‚Äì634.
For NGC 1566, at 18 Mpc which is close to the median distance
of the PHANGS-HST sample, for such human veriÔ¨Åed clusters, the
median stellar mass is 3.1√ó104 ùëÄ(cid:12) with a 25‚Äì75 percentile interval
of ‚àº 1.5‚àí7.0 √ó 104 ùëÄ(cid:12). These values drop by about 3‚àí5√ó for the
other targets in the current paper (at 8‚Äì10 Mpc). All candidates have
been classiÔ¨Åed using ML (deep transfer learning CNN models of
Wei et al. 2020), yielding Class 1 or 2 cluster classiÔ¨Åcations for 4292
objects (for VGG, 17% of the ML sample). The ML-classiÔ¨Åed Class
1 or 2 samples reach ‚àº1 magnitude fainter, ‚àº 2√ó lower mass, and
are 2‚àí5√ó larger in number, than the human classiÔ¨Åed samples. The
resulting age-mass diagrams and spatial distributions are provided
in Appendix A.

These four galaxies were selected for study because they have
star cluster catalogues which have been independently produced
by the LEGUS program, using a standard approach for selecting
candidates. Comparison between the LEGUS catalogues and the
ones resulting from our PHANGS-HST pipeline allow for one test
of the eÔ¨Äectiveness of our new approach. Based on the union of
the two catalogues, 48‚Äì74% (56% median, see lower portion of
Fig. 14 and note (ùëè) of Tab. 7) of human veriÔ¨Åed Class 1 and
2 star clusters appear in both catalogues. The remainder, clusters
which are unique to one of the catalogues, are discovered in roughly
equal proportion by the two methods. Interestingly, we Ô¨Ånd that the
majority of clusters unique to LEGUS are classiÔ¨Åed as contaminants
in the PHANGS-HST catalogues, and the majority of those unique
to PHANGS-HST appear to be likely clusters not captured by the
LEGUS pipeline.

Overall, we Ô¨Ånd that our new selection method is eÔ¨Äective,
and furthermore, yield a substantially larger cluster population than
previously identiÔ¨Åed in each of our target galaxies. These cluster

catalogues, and the forthcoming ones from the other 34 galaxies in
the PHANGS-HST program, will transform our understanding of
the link between cluster populations and environmental properties
of the ISM (CO measured with ALMA; H i with the JVLA, Karl
G. Jansky Very Large Array; and optical nebular emission lines
with MUSE IFU spectroscopy), especially when combined with
our upcoming JWST observations recovering embedded clusters
while also clarifying PAH and small dust grain properties. The
complete potential of our PHANGS-HST data set would not have
been accessible without successful pipeline implementation of ML
classiÔ¨Åcation, owing to the very large number of cluster candidates.
This seamless integration of automated classiÔ¨Åcation has not been
achieved, and deployed to an entire galaxy sample, previously in the
Ô¨Åeld of star clusters. As noted in Section 5.2 and Whitmore et al.
(2021), we expect that the accuracy of ML classiÔ¨Åcation will further
improve as more extensive experimentation with varied training
strategies is undertaken. Even so, the current accuracy is on par
with an expert human classiÔ¨Åer.

Our analysis of synthetic clusters provides a database with
measured properties for a rather diverse set of parametric MoÔ¨Äat
cluster morphologies. We indicated such linkage between cluster
morphology and metric values could be used to further simulate
the distribution of observed characteristics for a mock cluster pop-
ulation. Folding in completeness estimates as a function of cluster
properties would allow us to interpret the ensemble measured prop-
erties of a detected cluster population in terms of assumed (cluster
formation rate, destruction ùëë2ùëÅ/ùëëùëÄ ùëëùë°, and the distribution of ùê¥ùëâ
and morphology). This forward-modelling approach will be ex-
plored in future work. Aspects of this idea, omitting information on
cluster morphology, have been published in the context of hierarchi-
cal Bayesian analysis by Krumholz et al. (2019b). By incorporating

MNRAS 000, 1‚Äì30 (2021)

cluster structural measurements, either MCI-based or via MoÔ¨Äat
Ô¨Åtting, and ideally also the population of OB associations that were
once clusters, we can expect the utility of such work to grow con-
siderably.

ACKNOWLEDGEMENTS

Based on observations made with the NASA/ESA Hubble Space
Telescope, obtained from the data archive at the Space Telescope
Science Institute. STScI is operated by the Association of Univer-
sities for Research in Astronomy, Inc. under NASA contract NAS
5-26555. Support for Program number 15654 was provided through
a grant from the STScI under NASA contract NAS5-26555.

Most of the plots in this paper were generated with TOPCAT
(Taylor 2005) and/or its sister command-line package STILTS (Tay-
lor 2006), both developed and generously released/maintained for
public use by Mark Taylor. A signiÔ¨Åcant amount of interactive data
exploration and testing was conducted using TOPCAT.

Our pipeline makes extensive use of the following software
packages:
DOLPHOT, photutils, astropy, matplotlib,
numpy, IMFIT, pytorch, CIGALE. We extend our appreciation
to their respective developers.

This research has made use of the NASA/IPAC Extragalactic
Database (NED) which is operated by the Jet Propulsion Laboratory,
California Institute of Technology, under contract with NASA.

JMDK gratefully acknowledges funding from the Deutsche
Forschungsgemeinschaft (DFG, German Research Foundation)
through an Emmy Noether Research Group (grant number
KR4801/1-1) and the DFG Sachbeihilfe (grant number KR4801/2-
1), as well as from the European Research Council (ERC) under
the European Union‚Äôs Horizon 2020 research and innovation pro-
gramme via the ERC Starting Grant MUSTANG (grant agreement
number 714907).

SCOG and RSK acknowledge support from the DFG via SFB
881 ‚ÄúThe Milky Way System‚Äù (sub-projects A1, B1, B2 and B8)
and from the Heidelberg cluster of excellence EXC 2181-390900948
‚ÄúSTRUCTURES: A unifying approach to emergent phenomena in
the physical world, mathematics, and complex data‚Äù, funded by
the German Excellence Strategy. They also acknowledge funding
from the European Research Council via the ERC Synergy Grant
‚ÄúECOGAL‚Äù (grant 855130).

TGW acknowledges funding from the European Research
Council (ERC) under the European Union‚Äôs Horizon 2020 research
and innovation programme (grant agreement No. 694343).

9 DATA AVAILABILITY

The imaging observations underlying this article can be retrieved
from the Mikulski Archive for Space Telescopes at https://
archive.stsci.edu/hst/search_retrieve.html under pro-
posal GO-15654. High level science products, including science
ready mosaicked imaging, associated with HST GO-15654 are
provided at https://archive.stsci.edu/hlsp/phangs-hst
with digital object identiÔ¨Åer doi:10.17909/t9-r08f-dq31

REFERENCES

Adamo A., Bastian N., 2015, arXiv e-prints, p. arXiv:1511.08212
Adamo A., √ñstlin G., Zackrisson E., Hayes M., Cumming R. J., Micheva

G., 2010, MNRAS, 407, 870

MNRAS 000, 1‚Äì30 (2021)

Star Cluster IdentiÔ¨Åcation in PHANGS-HST

29

Adamo A., √ñstlin G., Zackrisson E., 2011, MNRAS, 417, 1904
Adamo A., Kruƒ≥ssen J. M. D., Bastian N., Silva-Villa E., Ryon J., 2015,

MNRAS, 452, 246

Adamo A., et al., 2017, ApJ, 841, 131
Adamo A., et al., 2020a, Space Sci. Rev., 216, 69
Adamo A., et al., 2020b, MNRAS, 499, 3267
Anand G. S., et al., 2021, MNRAS, 501, 3621
Anderson J., 2016, Empirical Models for the WFC3/IR PSF, Space Tele-

scope WFC Instrument Science Report

Anderson J., 2018, Focus-Diverse PSFs for Five Commonly Used
WFC3/UVIS Filters, Space Telescope WFC Instrument Science Report
Bailer-Jones C. A. L., Rybizki J., Fouesneau M., Mantelet G., Andrae R.,

2018, AJ, 156, 58

Bastian N., 2008, MNRAS, 390, 759
Bastian N., Gieles M., Lamers H. J. G. L. M., Scheepmaker R. A., de Grƒ≥s

R., 2005a, A&A, 431, 905

Bastian N., Gieles M., Efremov Y. N., Lamers H. J. G. L. M., 2005b, A&A,

443, 79

Battinelli P., 1991, A&A, 244, 69
Baumgardt H., Kroupa P., 2007, MNRAS, 380, 1589
Bertin E., Arnouts S., 1996, A&AS, 117, 393
Bialopetraviƒçius J., Narbutis D., Vanseviƒçius V., 2019, A&A, 621, A103
Boquien M., Burgarella D., Roehlly Y., Buat V., Ciesla L., Corre D., Inoue

A. K., Salas H., 2019, A&A, 622, A103

Brown G., Gnedin O. Y., 2021, arXiv e-prints, p. arXiv:2106.12420
Calzetti D., et al., 2015, AJ, 149, 51
Chandar R., et al., 2010, ApJ, 719, 966
Chandar R., Whitmore B. C., Dinino D., Kennicutt R. C., Chien L. H.,

Schinnerer E., Meidt S., 2016, ApJ, 824, 71

Cook D. O., et al., 2019, MNRAS, 484, 4897
Deger S., et al., 2021, PHANGS-ALMA Data Processing and Pipeline,

(MNRAS submitted)

Dolphin A. E., 2000, PASP, 112, 1383
Elmegreen B. G., et al., 2020, ApJ, 888, L27
Elson R. A. W., Fall S. M., Freeman K. C., 1987, ApJ, 323, 54
Emsellem E., et al., 2021, PHANGS-ALMA Data Processing and Pipeline,

(MNRAS submitted)
Erwin P., 2015, ApJ, 799, 226
Forbes D. A., Almeida A., Spitler L. R., Pota V., 2014, MNRAS, 442, 1049
Fouesneau M., et al., 2014, ApJ, 786, 117
Gieles M., Portegies Zwart S. F., 2011, MNRAS, 410, L6
Gieles M., Renaud F., 2016, MNRAS, 463, L103
Gieles M., Portegies Zwart S. F., Baumgardt H., Athanassoula E., Lamers
H. J. G. L. M., Sipior M., Leenaarts J., 2006, MNRAS, 371, 793

Grasha K., et al., 2017, ApJ, 840, 113
Grasha K., et al., 2018, MNRAS, 481, 1016
Grasha K., et al., 2019, MNRAS, 483, 4707
Hamedani Golshan R., Schilke P., Sanchez-Monge A., Sewilo M., 2021,
in 43rd COSPAR ScientiÔ¨Åc Assembly. Held 28 January - 4 February.
p. 1992

Hannon S., et al., 2019, MNRAS, 490, 4648
He K., Zhang X., Ren S., Sun J., 2015, arXiv e-prints, p. arXiv:1512.03385
Holtzman J. A., et al., 1992, AJ, 103, 691
Humphreys R. M., Davidson K., 1979, ApJ, 232, 409
Hunter D. A., Elmegreen B. G., Dupuy T. J., Mortonson M., 2003, AJ, 126,

1836

Indebetouw R., Wong T., Chen C. H. R., Kepley A., Lebouteiller V., Madden

S., Oliveira J. M., 2020, ApJ, 888, 56

Johnson L. C., et al., 2012, ApJ, 752, 95
Johnson L. C., et al., 2015, ApJ, 802, 127
Johnson L. C., et al., 2017, ApJ, 839, 78
Kharchenko N. V., Piskunov A. E., Schilbach E., R√∂ser S., Scholz R. D.,

2013, A&A, 558, A53
King I., 1962, AJ, 67, 471
King I. R., 1966, AJ, 71, 64
Kruƒ≥ssen J. M. D., 2012, MNRAS, 426, 3008
Kruƒ≥ssen J. M. D., Pelupessy F. I., Lamers H. J. G. L. M., Portegies Zwart

S. F., Icke V., 2011, MNRAS, 414, 1339

30

Thilker et al.

Krumholz M. R., et al., 2015, ApJ, 812, 147
Krumholz M. R., McKee C. F., Bland-Hawthorn J., 2019a, ARA&A, 57,

Whitmore B. C., et al., 2020, ApJ, 889, 154
Whitmore B., et al., 2021, PHANGS-ALMA Data Processing and Pipeline,

227

Krumholz M. R., Adamo A., Fumagalli M., Calzetti D., 2019b, MNRAS,

482, 3550

Lada C. J., Lada E. A., 2003, ARA&A, 41, 57
Lamers H. J. G. L. M., Gieles M., Portegies Zwart S. F., 2005a, A&A, 429,

173

Lamers H. J. G. L. M., Gieles M., Bastian N., Baumgardt H., Kharchenko

N. V., Portegies Zwart S., 2005b, A&A, 441, 117

Lamers H. J. G. L. M., Baumgardt H., Gieles M., 2010, MNRAS, 409, 305
Larsen S. S., 1999, A&AS, 139, 393
Larsen S. S., 2002, AJ, 124, 1393
Larsen S. S., 2004, A&A, 416, 537
Larsen S. S., 2009, A&A, 494, 539
Larsen S. S., Brodie J. P., 2000, AJ, 120, 2938
Larsen S. S., Richtler T., 1999, A&A, 345, 59
Larsen S. S., Richtler T., 2000, A&A, 354, 836
Larsen S. S., Brodie J. P., Huchra J. P., Forbes D. A., Grillmair C. J., 2001,

AJ, 121, 2974

Larson K., et al., 2021, PHANGS-ALMA Data Processing and Pipeline,

(MNRAS in prep.)

Lee J. C., et al., 2021, arXiv e-prints, p. arXiv:2101.02855
Leroy A. K., et al., 2019, ApJS, 244, 24
Leroy A., et al., 2020, PHANGS-ALMA: Arcsecond CO (2‚Äì1) Imaging of

Nearby Star-Forming Galaxies, (ApJ in preparation)

Lim S., Lee M. G., 2015, ApJ, 804, 123
McLaughlin D. E., van der Marel R. P., 2005, ApJS, 161, 304
Messa M., et al., 2018a, MNRAS, 477, 1683
Messa M., et al., 2018b, MNRAS, 477, 1683
Oey M. S., King N. L., Parker J. W., 2004, AJ, 127, 1632
P√©rez G., Messa M., Calzetti D., Maji S., Jung D. E., Adamo A., Sirressi

M., 2021, ApJ, 907, 100

PfeÔ¨Äer J., Bastian N., Kruƒ≥ssen J. M. D., Reina-Campos M., Crain R. A.,

Usher C., 2019, MNRAS, 490, 1714

Querejeta M., Schinnerer E., Meidt S., Leroy A., 2021, PHANGS-ALMA

Data Processing and Pipeline, (A&Asubmitted)

Reina-Campos M., Kruƒ≥ssen J. M. D., PfeÔ¨Äer J., Bastian N., Crain R. A.,

2018, MNRAS, 481, 2851

Romita K., Lada E., Cioni M.-R., 2016, ApJ, 821, 51
Ryon J. E., et al., 2017, ApJ, 841, 92
Sabbi E., et al., 2018, ApJS, 235, 23
Sans Fuentes S. A., De Ridder J., Debosscher J., 2017, A&A, 599, A143
Schmeja S., 2011, Astronomische Nachrichten, 332, 172
Sewilo M., 2021, in 43rd COSPAR ScientiÔ¨Åc Assembly. Held 28 January -

4 February. p. 1982

Shimonishi T., Onaka T., Das A., Aikawa Y., Sakai N., Nishimura Y., Tanaka
K., Watanabe Y., 2021, in 43rd COSPAR ScientiÔ¨Åc Assembly. Held 28
January - 4 February. p. 1907

Simonyan K., Zisserman A., 2014, arXiv e-prints, p. arXiv:1409.1556
Smith L. J., Bajaj V., Ryon J., Sabbi E., 2020, ApJ, 896, 84
Taylor M. B., 2005, in Shopbell P., Britton M., Ebert R., eds, Astronomical
Society of the PaciÔ¨Åc Conference Series Vol. 347, Astronomical Data
Analysis Software and Systems XIV. p. 29

Taylor M. B., 2006, in Gabriel C., Arviset C., Ponz D., Enrique S., eds,
Astronomical Society of the PaciÔ¨Åc Conference Series Vol. 351, Astro-
nomical Data Analysis Software and Systems XV. p. 666

Turner J. A., et al., 2021, MNRAS, 502, 1366
Webb J. J., Reina-Campos M., Kruƒ≥ssen J. M. D., 2019, MNRAS, 486,

5879

Wei W., et al., 2020, MNRAS, 493, 3178
Whitmore B. C., Schweizer F., 1995, AJ, 109, 960
Whitmore B. C., Schweizer F., Leitherer C., Borne K., Robert C., 1993, AJ,

106, 1354

Whitmore B. C., Zhang Q., Leitherer C., Fall S. M., Schweizer F., Miller

B. W., 1999, AJ, 118, 1551

Whitmore B. C., Chandar R., Fall S. M., 2007, AJ, 133, 1067
Whitmore B. C., et al., 2011, ApJ, 729, 78

(MNRAS submitted)

Williams B. F., et al., 2014, ApJS, 215, 9
Williams B. F., et al., 2021, arXiv e-prints, p. arXiv:2101.01293
Wilson C. D., 1991, AJ, 101, 1663
Zari E., Brown A. G. A., de Zeeuw P. T., 2019, A&A, 628, A123

APPENDIX A: SUMMARY FIGURES

This appendix presents the age‚Äìmass and age-coded spatial distri-
bution plots for all the Ô¨Åelds we processed as part of this paper.

APPENDIX B: DOLPHOT PARAMETERS

DOLPHOT serves as the primary source detection algorithm for
PHANGS-HST, feeding both the cluster identiÔ¨Åcation pipeline and
the multi-scale association Ô¨Ånder of Larson et al. (2021). As such,
even though many choices are similar to usage of DOLPHOT by prior
studies (e.g. LEGUS, Sabbi et al. 2018), PHAT (Williams et al.
2014, 2021), we provide a listing of relevant parameters here so as
to allow for reproducible research.

We note that some parameters may be further tweaked before
the Ô¨Ånal PHANGS-HST data products are released. In particular, we
anticipate reducing SecondPass in order to help mitigate ‚Äòdoubles‚Äô
(redundant detections of extended objects) in the cluster context
and over-decomposition of diÔ¨Äuse emission into point sources in
the association context. If this, and any other changes are made,
they will be reported in the catalogue release papers.

This paper has been typeset from a TEX/LATEX Ô¨Åle prepared by the author.

MNRAS 000, 1‚Äì30 (2021)

Star Cluster IdentiÔ¨Åcation in PHANGS-HST

31

Figure A1. The cluster population of the NGC 628-C Ô¨Åeld as displayed in Fig. 16 and Fig. 17, duplicated here for easy comparison to Figs. A2‚ÄìA5.

MNRAS 000, 1‚Äì30 (2021)

32

Thilker et al.

Figure A2. As in Fig. A1, except for NGC 628-E. In the lower panel, clusters are only plotted if they have WFC3/UVIS+ACS/WFC coverage. Spiral arms
features extending outward from the centre of the galaxy (lying oÔ¨Ä plot to the right) are marked.

MNRAS 000, 1‚Äì30 (2021)

Star Cluster IdentiÔ¨Åcation in PHANGS-HST

33

Figure A3. As in Fig. A1, except for NGC 1433. We show the ring-like structural features identiÔ¨Åed by the environmental masks of Querejeta et al. (2021).
Note that the ùêª ùëÜùëá Ô¨Åeld does not fully cover the NW and SW portions of the outer ring.

MNRAS 000, 1‚Äì30 (2021)

34

Thilker et al.

Figure A4. As in Fig. A1, except for NGC 1566. The spiral arms of Querejeta et al. (2021) are marked.

MNRAS 000, 1‚Äì30 (2021)

Star Cluster IdentiÔ¨Åcation in PHANGS-HST

35

Figure A5. As in Fig. A1, except for NGC 3351. Querejeta et al. (2021) ring-like structural features are drawn.

MNRAS 000, 1‚Äì30 (2021)

36

Thilker et al.

Table B1. DOLPHOT parameters adopted for PHANGS-HST

Parameter

Meaning

Exposure-speciÔ¨Åc parameters:

img*_RAper = 8.0
img*_RChi = 3.0
img*_RSky = 15 35
img*_RSky2 = 4 10
img*_RPSF = 13
img*_aprad = 10
img*_apsky = 15 25

photometry aperture size (Ô¨Çoat)
aperture size for determining Chi (Ô¨Çoat); if <=0 use RAper
radii deÔ¨Åning sky annulus (Ô¨Çoat>=RAper+0.5)
radii deÔ¨Åning sky annulus (for FitSky=2 option)
PSF size (integer>0)
radius for aperture correction ùêª ùëÜùëá -DISABLED (0.5" for WFC3/UVIS and ACS/WFC)
sky annulus for aperture correction

The following parameters aÔ¨Äect the Ô¨Ånding and measurement of stars:

RCentroid = 2
SigFind = 3.0
SigFindMult = 0.85
SigFinal = 3.5
MaxIT = 25
PSFPhot = 1
PSFPhotIt = 3
FitSky = 3
SkipSky = 2
SkySig = 2.25
NegSky = 1
NoiseMult = 0.10
FSat = 0.999
PosStep = 0.1
dPosMax = 2.5
RCombine = 1.5
SigPSF = 5.0

UseWCS = 1
Align = 2
AlignIter = 2
AlignTol = 0
AlignStep = 1.0
AlignOnly = 0
Rotate = 1
SubResRef = 1
SecondPass = 5
SearchMode = 1
Force1 = 1
PSFres = 1
psfstars =
psfoÔ¨Ä = 0.0
ApCor = 1
VerboseData = 1

centroid box size (integer>0)
sigma detection threshold (Ô¨Çoat)
Multiple for quick-and-dirty photometry (Ô¨Çoat>0)
sigma output threshold (Ô¨Çoat)
maximum iterations (integer>0)
photometry type (integer/0=aper,1=psf,2=wtd-psf)
number of iterations in PSF-Ô¨Åtting photometry (integer>=0)
Ô¨Åt sky? (integer/0=no,1=yes,2=small,3=with-phot)
spacing for sky measurement (integer>0)
sigma clipping for sky (Ô¨Çoat>=1)
allow negative sky values? (0=no,1=yes)
noise multiple in imgadd (Ô¨Çoat)
fraction of saturate limit (Ô¨Çoat)
search step for position iterations (Ô¨Çoat)
maximum single-step in position iterations (Ô¨Çoat)
minimum separation for two stars for cleaning (Ô¨Çoat)
min S/N for psf parameter Ô¨Åts (Ô¨Çoat)

Settings to enable/disable features:

use WCS header info in alignment (integer 0=no, 1=use to est. shift/rotate/scale, 2=use to est. full distortion sol.)
align images? (integer 0=no,1=const(x/yoÔ¨Ä),2=lin(x/yoÔ¨Ä+scale),3=cube(x/yoÔ¨Ä+distortion,4=full3rdorderpolynom)
number of iterations on alignment? (integer>0)
number of pixels to search in preliminary alignment (Ô¨Çoat>=0)
stepsize for preliminary alignment search (Ô¨Çoat>0)
exit after alignment
allow cross terms in alignment? (integer 0=no, 1=yes)
subpixel resolution for reference image (integer>0)
second pass Ô¨Ånding stars (integer 0=no,1=yes,>1=multiple passes)
algorithm for astrometry (0=max SNR/chi, 1=max SNR)
force type 1/2 (stars)? (integer 0=no,1=yes)
make PSF residual image? (integer 0=no,1=yes)
Coordinates of PSF stars
coordinate oÔ¨Äset (PSF system - DOLPHOT system)
Ô¨Ånd/make aperture corrections? (integer 0=no,1=yes)
to write all displayed numbers to a .data Ô¨Åle

Flags for ùêª ùëÜùëá modes:

ForceSameMag = 0
FlagMask = 4
CombineChi = 0
ACSuseCTE = 0
WFC3useCTE = 0
ACSpsfType = 0
WFC3UVISpsfType = 0
WFC3IRpsfType = 0
InterpPSFlib = 1

force same count rate in images with same Ô¨Ålter? (integer 0=no, 1=yes)
photometry quality Ô¨Çags to reject when combining magnitudes
combined magnitude weights uses chi? (integer 0=no, 1=yes)
apply CTE corrections on ACS data? (integer 0=no, 1=yes)
apply CTE corrections on WFC3 data? (integer 0=no, 1=yes)
use Anderson PSF cores? (integer 0=no, 1=yes)
use Anderson PSF cores? (integer 0=no, 1=yes)
use Anderson PSF cores? (integer 0=no, 1=yes)
interpolate PSF library spatially

MNRAS 000, 1‚Äì30 (2021)

