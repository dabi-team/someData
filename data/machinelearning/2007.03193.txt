1
2
0
2

p
e
S
3

]
h
p
-
t
n
a
u
q
[

4
v
3
9
1
3
0
.
7
0
0
2
:
v
i
X
r
a

Policies for elementary links in a quantum network

Sumeet Khatri

Hearne Institute for Theoretical Physics, Department of Physics and Astronomy, and Center for Computation and

Technology, Louisiana State University, Baton Rouge, Louisiana, 70803, USA

September 6, 2021

Distributing entanglement over long distances is one of the central tasks in
quantum networks. An important problem, especially for near-term quantum net-
works, is to develop optimal entanglement distribution protocols that take into
account the limitations of current and near-term hardware, such as quantum mem-
ories with limited coherence time. We address this problem by initiating the study
of quantum network protocols for entanglement distribution using the theory of de-
cision processes, such that optimal protocols (referred to as policies in the context
of decision processes) can be found using dynamic programming or reinforcement
learning algorithms. As a ﬁrst step, in this work we focus exclusively on the elemen-
tary link level. We start by deﬁning a quantum decision process for elementary
links, along with ﬁgures of merit for evaluating policies. We then provide two
algorithms for determining policies, one of which we prove to be optimal (with
respect to ﬁdelity and success probability) among all policies. Then we show that
the previously-studied memory-cutoﬀ protocol can be phrased as a policy within
our decision process framework, allowing us to obtain several new fundamental
results about it. The conceptual developments and results of this work pave the
way for the systematic study of the fundamental limitations of near-term quantum
networks, and the requirements for physically realizing them.

Table of Contents

1

Introduction

2 The entanglement distribution task

3 Quantum decision process for elementary links

3.1 Quantum state of an elementary link . . . . . . . . . . . . . . . . . . . . . . . .

Sumeet Khatri: khatri6000@gmail.com, http://sumeetkhatri.com

Accepted in Quantum 2021-08-30, click title to verify. Published under CC-BY 4.0.

2

4

5

7

1

 
 
 
 
 
 
3.2 Figures of merit . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

3.3 Examples of policies

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

8

9

3.4 Policy optimization . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 10

4 The memory-cutoﬀ policy

11

4.1 Expected quantum state . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 12

4.2 Expected ﬁdelity . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 15

5 Summary and outlook

Appendix A Related work

Appendix B Elementary link generation

Appendix C Details of the elementary link quantum decision process

Appendix D Details of the memory-cutoﬀ policy

References

1 Introduction

15

18

19

21

34

47

It has
The quantum internet [1–5] is one of the frontiers of quantum information science.
the potential to revolutionize the way we communicate and do other tasks, and it will allow
for tasks that are not possible using the current, classical internet alone, such as quantum
teleportation [6–8], quantum key distribution [9–12], quantum clock synchronization [13–16],
distributed quantum computation [17], and distributed quantum metrology and sensing [18–
23]. The backbone of a quantum internet is entanglement distributed globally in order to
allow for such novel applications to be performed over long distances. Consequently, long-
range entanglement distribution is one of the main problems in quantum networks.

Most of the aforementioned applications are beyond the reach of current and near-term
quantum technologies. Consequently, we are currently in the era of so-called near-term quan-
tum networks, which are characterized by the following elements [4]: Small number of nodes;
imperfect sources of entanglement; non-deterministic elementary link generation and entan-
glement swapping;
imperfect measurements and gate operations; quantum memories with
short coherence times; no (or limited) entanglement distillation/error correction. The most
prominent applications of these near-term quantum networks are quantum teleportation and
quantum key distribution. In fact, several experiments have already realized these applications

Accepted in Quantum 2021-08-30, click title to verify. Published under CC-BY 4.0.

2

Figure 1: (Left) Model of elementary link generation considered in this work (see Section 2 and Appendix B
for details). We associate every quantum network with a graph G = (V, E), in which the vertices V represent
the network nodes and the edges E represent quantum channels, which we refer to as elementary links. We
associate a source station to the elementary link corresponding to e ∈ E, which distributes entangled states
to the nodes belonging to e. (Right) In order to analyze an elementary link with respect to time, we deﬁne
a quantum decision process; see the beginning of Section 3, and Appendix C, for details.

on relatively small scales [24–43].

What are the requirements for physically realizing near-term quantum networks? More
generally, what are the limitations of near-term quantum networks? Although several software
tools for simulating quantum networks have been released in order to probe these questions [44–
50], it is of interest to develop a formal and systematic theoretical framework for entanglement
distribution protocols in near-term quantum networks that can allow us to address these
questions in full generality. Such a theoretical framework, which is currently lacking (see
Appendix A for a review of prior theoretical work on quantum networks), should incorporate
both the limitations of near-term quantum technologies and be general enough to allow for
It should also allow us to answer the following basic
optimization of protocol parameters.
questions for arbitrary protocols: (1) What is the quantum state of the network? (2) What is
the ﬁdelity of the quantum state of the network with respect to a given target state? (3) What
protocol is optimal with respect to ﬁdelity (or some other ﬁgure of merit)? The purpose of
this work is to answer these questions at the level of elementary links in a quantum network,
as a ﬁrst step towards the development of a general framework for practical quantum network
protocols. We do so by introducing a general framework for analyzing elementary links in a
quantum network based on quantum decision processes; see Figure 1. In a decision process
[51], an agent interacts with its environment through actions, and it receives rewards from the
environment based on these actions. The goal of the agent is to devise a policy (a sequence of
actions) that maximizes its expected total reward.

To see why decision processes are a natural way to describe protocols in a quantum network,
consider a very simple example. Consider three nodes labeled A, B, and C. Quantum channels

Accepted in Quantum 2021-08-30, click title to verify. Published under CC-BY 4.0.

3

connect A and C and B and C, and the goal is to create entanglement between A and B. The
usual protocol to achieve this goal is to ﬁrst create entanglement between A and C and B
and C, and then to perform entanglement swapping at C. However, because entanglement
creation is typically non-deterministic with near-term quantum technologies, it is possible that,
e.g., the entanglement between A and C is created ﬁrst. With near-term quantum memories,
storing this entangled state for too long while entanglement between B and C is being created
can lead to too much decoherence, rendering the ﬁnal, swapped state between A and B useless.
A decision must therefore be made to either wait (i.e., keep the entanglement between A and
C in quantum memory) or to discard the entanglement shared by A and C and create the
entanglement again. The framework of decision processes provides us with the language and
mathematical tools needed to address this problem for arbitrary networks, not just a network
of three nodes.

In addition to being natural, one of the other advantages of the approach taken in this work
is that optimal protocols can be discovered using reinforcement learning algorithms. This is
due to the fact that decision processes form the theoretical foundation for reinforcement learn-
ing [52] and artiﬁcial intelligence [53].
(See [54] for related work on machine learning for
quantum communication.) Another advantage of our approach is that, even though reinforce-
ment learning techniques cannot always be applied eﬃciently to large-scale problems, decision
processes provide us with a systematic framework for combining optimal small-scale protocols
in order to create large-scale protocols; see [55] for similar ideas. The framework introduced
in this work can also be extended to allow for a systematic consideration of agents with local
and global knowledge of the network, as well as agents that are independent and/or cooperate
with each other. These extensions are interesting directions for future work, and they will lead
to a more complete theory of practical quantum network protocols. This work represents the
starting point towards this ultimate goal.

2 The entanglement distribution task

In the left panel of Figure 1, we illustrate an arbitrary quantum network using its corresponding
hypergraph G = (V, E). Speciﬁcally, G corresponds to the physical layout of the network,
which we assume to be ﬁxed. The nodes of the network are associated to the vertices V of the
graph, and quantum channels physically connecting the nodes in the network are represented
in the graph by gray edges, belonging to the set E, connecting the corresponding vertices. We
refer to these edges as elementary links. The quantum channels are used to distribute entangled
states to the nodes of an elementary link. For two-node elementary links, the associated
quantum channels are used to distribute bipartite entangled states; for elementary links with
three or more nodes, the associated quantum channels are used to distribute multipartite
entangled states. When an entangled state is distributed successfully along an elementary
link, we color the corresponding edge red (in the case of two-node elementary links) or blue
(in the case of elementary links with three or more nodes), and we refer to the elementary
link as an active elementary link. The task of entanglement distribution is to use the active
elementary links to create virtual links. A virtual link corresponds to an entangled state
shared by nodes that are not physically connected. Entanglement distribution protocols can

Accepted in Quantum 2021-08-30, click title to verify. Published under CC-BY 4.0.

4

be described in terms of graph transformations, as done in [56, 57], which take the graph G
and transform it into a target graph Gtarget, whose edges contain a subset of the elementary
links in G along with a desired set of virtual links. The quantum states corresponding to the
elementary and virtual links must be close (in terms of, e.g., ﬁdelity) to a target quantum
state. Typically, in the bipartite case, the target is a Bell state, while in the multipartite case
the target is a GHZ state.

A basic example of an entanglement distribution protocol, and the one that we consider in
this work, consists of ﬁrst generating elementary links, and then performing joining protocols,
such as entanglement swapping, to create virtual links. If the active elementary links obtained
after the ﬁrst step, along with their ﬁdelities to the target states, do not allow for the target
graph to be created—for example, some of the required elementary link attempts might have
failed—then it makes sense to retry the elementary link generation for the ones that failed.
For the ones that succeeded, it might make sense to keep the quantum states in memory rather
than discard the states, request new ones, and risk some of these new attempts failing. This
sequence of decisions at every time step deﬁnes a policy. Some questions then naturally arise:

1. Given a policy for an elementary link, what is the quantum state of the elementary link

as a function of time? We address this question in Section 3.1.

2. Given a policy for an elementary link, what is the expected ﬁdelity of the quantum state
of the elementary link with respect to the target state, as a function of time, and what
is the probability that the elementary link is active after a given number of time steps?
We address this question in Section 3.2.

3. What is the (optimal) sequence of actions (i.e., the optimal policy) that should be
performed for every elementary link, as a function of time? We address this question in
Section 3.4.

These are the main questions that we address in this work, and we do so using the theory of
quantum decision processes.

3 Quantum decision process for elementary links

Let us now illustrate how the three questions posed at the end of the previous section can be
answered using quantum decision processes. The basic idea is illustrated in Figure 1, and we
present the formal deﬁnition of the quantum decision process in Appendix C. Let G = (V, E)
be the graph corresponding to the elementary links of a quantum network. To every edge
e ∈ E of the graph we associate an independent agent. The agent should be thought of as
a collection of (classical) devices located at the nodes corresponding to the edge, which can
communicate with each other and thus operate as a single entity. The environment associated
with the agent is the collection of quantum systems distributed to the corresponding nodes by
a source station.

Now, at t = 0, an attempt is made to generate entanglement along an elementary link
corresponding to e ∈ E. This means that the source station associated with e prepares a

Accepted in Quantum 2021-08-30, click title to verify. Published under CC-BY 4.0.

5

multipartite entangled state and sends the corresponding quantum systems to the nodes of e.
There are two key elements of this elementary link generation process (see Appendix B for
details):

• The elementary link generation success probability pe ∈ [0, 1], which is a function of the
transmissivity of the transmission medium (in the case of photonic implementations)
and parameters that quantify imperfections in the local gates and measurement devices.

• Depending on success or failure of elementary link generation, the nodes of e can be in
one of two quantum states, by deﬁnition: ρ0
in the case
e
of failure. In the case of success, the quantum state is held in quantum memories at the
nodes. Then, the quantum state after m time steps in the local quantum memories is
given by

in the case of success, and τ ∅
e

(ρ0
e
= Ne ◦ Ne ◦ · · · ◦ Ne (m times), and Ne describes the noise processes of the

ρe(m) := N ◦m

(3.1)

),

e

where N ◦m
local quantum memories; see Appendix B for details.

e

If the elementary link generation succeeds at time t = 0, then at time step t = 1 the agent
might decide to keep the quantum state currently in memory; if it fails, then at time step
t = 1 the agent might decide to perform the elementary link generation again. In general,
then, at every time step t ≥ 1, the agent associated with e ∈ E can perform two actions:
“wait” (i.e., keep the entangled state currently in quantum memory), or “request” (discard
the entangled state currently in quantum memory and request a new one from the source).
This choice of action can be random, so we deﬁne action random variables Ae(t) taking two
values: 0 for “wait” and 1 for “request”. Based on the agent’s choice, the distribution of the
quantum systems from the source station to the nodes probabilistically succeeds or fails (we
expand on this in Appendix B). We deﬁne elementary link status random variables Xe(t) to
indicate the outcomes: 0 for failure and 1 for success. If Xe(t) = 0, then the elementary link
is considered inactive, and it is considered active if Xe(t) = 1. The history of the agent is
then deﬁned as the sequence He(t) := (Xe(1), Ae(1), Xe(2), Ae(2), . . . , Ae(t − 1), Xe(t)) for
all t ≥ 1, with He(1) = Xe(1). Every realization of the history is a sequence of the form
ht = (x1, a1, x2, a2, . . . , at−1, xt), with xj ∈ {0, 1} for all 1 ≤ j ≤ t and aj ∈ {0, 1} for all
1 ≤ j ≤ t − 1. Note that {0, 1}2t−1 is the set of all histories up to time t. We then think of
Xe(j) and Ae(j) as functions such that Xe(j)(ht) = xj for all 1 ≤ j ≤ t and Ae(j)(ht) = aj for
:= (x1, a1, . . . , aj−1, xj) to denote the history
all 1 ≤ j ≤ t − 1 and ht ∈ {0, 1}2t−1. We use ht
j
ht = (x1, a1, . . . , at−1, xt) up to the jth time step for all 1 ≤ j ≤ t, with ht
1

= x1.

Now, because the actions of waiting and requesting can be random, we deﬁne the random
variable Me(t) to be the amount of time the quantum state of the elementary link corresponding
to e is held in memory. It satisﬁes the recursion relation

Me(t) =






Me(t − 1) + Xe(t)
Xe(t) − 1

if Ae(t − 1) = 0,
if Ae(t − 1) = 1,

(3.2)

where Me(0) ≡ −1 and Ae(0) ≡ 1. Intuitively, the quantity Me(t) is the number of consecutive
time steps up to the tth time step that the action “wait” is performed since the most recent

Accepted in Quantum 2021-08-30, click title to verify. Published under CC-BY 4.0.

6

“request” action. The value Me(t) = −1 can be thought of as the resting state of the quantum
memory, when it is not loaded.

The agent’s policy, i.e., the policy of the elementary link corresponding to the edge e ∈ E,

is a sequence of the form πe = (d1, d2, . . . ), where the decision functions dt are deﬁned as

dt(ht)(at) := Pr[Ae(t) = at|He(t) = ht].

(3.3)

In other words, the decision functions give us the probability that the agent takes a particular
action, given the history of actions and statuses.

Let {πe : e ∈ E} denote a collection of policies for all of the elementary links of the network.

Then, the quantum state of the network at time steps t ≥ 1 is

O

e∈E

bσπe

e

(t),

(3.4)

(t) is a classical-quantum state for the elementary link corresponding to e ∈ E, which

where
bσπe
has the form

e

(t) = X

bσπe

e

ht∈{0,1}2t−1

Pr[He(t) = ht]πe|htihht|Ht ⊗ σe(t|ht),

where for every history ht = (x1, a1, x2, a2, . . . , at−1, xt) ∈ {0, 1}2t−1,

|htiHt ≡ |x1iX1|a1iA1|x2iX2|a2iA2 · · · |at−1iAt−1|xtiXt.

(3.5)

(3.6)

This classical-quantum state captures both the history of the agent-environment interaction
corresponding to the elementary link (in the classical register Ht), as well as the quantum
state of the nodes belonging to the elementary link conditioned on a particular history. We
present explicit expressions for Pr[He(t) = ht]πe

and σe(t|ht) in Section 3.1 below.

The tensor product structure in (3.4) holds because, by assumption, all of the agents
corresponding to the elementary links are independent. This means that all of the agents have
knowledge only of the status of their own elementary link. We stick to this setting throughout
this work. However, we can use quantum decision processes to develop quantum network
protocols in which the agents can cooperate, so that they have knowledge of the network in
a certain local neighborhood of their elementary link. The quantum state of the network
would then not have the simple tensor product structure as in (3.4). Furthermore, in the case
of independent agents, we can use the quantum decision processes for the elementary links
as building blocks for quantum decision processes for groups of elementary links, leading to
more sophisticated quantum network protocols. We leave these investigations as interesting
directions for future work.

3.1 Quantum state of an elementary link

We now state one of the main results of this work, which is an explicit expression for the prob-
abilities Pr[He(t) = ht]π and the quantum states σe(t|ht) of the elementary link corresponding
to the edge e in a quantum network undergoing a policy π = (d1, d2, . . . , dt, . . . ). This result
gives us the answer to the ﬁrst question posed at the end of Section 2.

Accepted in Quantum 2021-08-30, click title to verify. Published under CC-BY 4.0.

7

Theorem 3.1 (Quantum state of an elementary link). Let G = (V, E) be the graph corre-
sponding to the elementary links of a quantum network, and let e ∈ E. For all t ≥ 1, histories
ht = (x1, a1, . . . , at−1, xt) ∈ {0, 1}2t−1, and policies π = (d1, d2, . . . , dt, . . . ), we have
(cid:16)

σe(t|ht) = xt ρe

Me(t)(ht)(cid:17) + (1 − xt)τ ∅
e .

(3.7)

Furthermore,

Pr[He(t) = ht]π =





t−1
Y

j=1

dj(ht
j


 pN succ
e

e

)(aj)

(t)(ht)

(1 − pe)N req

e

(t)(ht)−N succ

e

(t)(ht)

(3.8)

for every history ht = (x1, a1, . . . , at−1, xt) ∈ {0, 1}2t−1, where pe is the success probability,
ht
j

= (x1, a1, . . . , aj−1, xj), and

N req
e

(t) :=

t
X

j=1

Ae(j − 1), N succ

e

(t) :=

t
X

j=1

Ae(j − 1)Xe(j)

(3.9)

are the number of elementary link requests and the number of successful elementary link
requests, respectively, up to time t, with Ae(0) ≡ 1. (cid:74)

The expected quantum state of the elementary link corresponding to an edge e ∈ E
undergoing the policy π is deﬁned as the state obtained by tracing out the classical history
register in (3.5):

(t) := X

σπ
e

Pr[He(t) = ht]π σe(t|ht).

(3.10)

Using Theorem 3.1, we immediately obtain the following result.

ht∈{0,1}2t−1

Corollary 3.2 (Expected quantum state of an elementary link). Let G = (V, E) be the graph
corresponding to the elementary links of a quantum network, and let e ∈ E. For all t ≥ 1 and
for every policy π, the expected quantum state of the elementary link corresponding to e is

σπ
e

(t) = (1 − Pr[Xe(t) = 1]π)τ ∅
e

+ X
m

Pr[Xe(t) = 1, Me(t) = m]π ρe(m),

(3.11)

where the sum is with respect to all possible values of the memory time, which in general
depends on the policy π. (cid:74)

3.2 Figures of merit

Consider an edge e ∈ E in the graph G = (V, E) corresponding to the elementary links of a
quantum network, and let π be a policy for the elementary link corresponding to e. Having
determined the quantum state of the elementary link corresponding to e, let us now consider
the following ﬁgures of merit to evaluate the policy π.

• The probability that an elementary link is active at time t ≥ 1, i.e., Pr[Xe(t) = 1]π =
E[Xe(t)]π. Due to the latter equality, we also refer to his quantity as the expected
elementary link status.

Accepted in Quantum 2021-08-30, click title to verify. Published under CC-BY 4.0.

8

• The expected ﬁdelity of the quantum state of the elementary link with respect to a target

quantum state at time t ≥ 1, i.e., E[ eFe(t)]π, where

where

eFe(t) := Xe(t)fe(Me(t)),

fe(m) := hψ|ρe(m)|ψi = hψ|N ◦m

e

(ρ0
e

)|ψi

(3.12)

(3.13)

denotes the ﬁdelity of the state ρe(m) with respect to a pure target state ψ = |ψihψ|.
A related quantity is

E[Fe(t)]π :=

E[ eFe(t)]π
Pr[Xe(t) = 1]π

,

(3.14)

which can be thought of as the expected ﬁdelity of the quantum state of the elementary
link given that the elementary link is active.

We discuss other ﬁgures of merit of interest in Appendix C.6.

The expected status and the expected ﬁdelity of an elementary link can both be expressed

in a simple manner in terms of the classical-quantum state of the elementary link.

Theorem 3.3. Let G = (V, E) be the graph corresponding to the elementary links of a
quantum network, let e ∈ E, and let t ≥ 1. Given a policy π, as well as a target pure state ψ,
for the elementary link corresponding to e, we have

E[Xe(t)]π = Tr[|1ih1|Xt bσπ
E[ eFe(t)]π = Tr[(|1ih1|Xt ⊗ ψ)

(t)] = Pr[Xe(t) = 1]π,
(t)]. (cid:74)

e

bσπ

e

(3.15)

(3.16)

Theorem 3.3 answers the second question posed at the end of Section 2.

3.3 Examples of policies

Let us examine the ﬁgures of merit deﬁned above using two simple policies.

First, consider the policy consisting of the action “request” at every time step before the
elementary link becomes active, and the action “wait” at every time step after the elementary
link becomes active. This policy is deﬁned by π = (d1, d2, . . . ), where

dt(ht) =






1 if Xe(t)(ht) = 0,
0 if Xe(t)(ht) = 1,

(3.17)

for all t ≥ 1 and every history ht ∈ {0, 1}2t−1. This policy achieves the highest value of
E[Xe(t)]π for all t ≥ 1. In fact, this policy is simply the t? = ∞ memory-cutoﬀ policy, which
we investigate in Section 4. We show in that section that E[Xe(t)]π = 1 − (1 − pe)t for all
t ≥ 1. Of course, this highest value of E[Xe(t)]π comes at the cost of a lower ﬁdelity, because
each “wait” action decreases the ﬁdelity of the quantum state stored in memory; we see this
explicitly in Section 4.2.

Accepted in Quantum 2021-08-30, click title to verify. Published under CC-BY 4.0.

9

Another policy is one in which the action “request” is taken at every time step, i.e., dt(ht) =
1 for all t ≥ 1 and every history ht ∈ {0, 1}2t−1. (This is the t? = 0 memory-cutoﬀ policy;
see Section 4.) In this case, the quantity E[Fe(t)]π is maximized, because E[Fe(t)]π = fe(0)
for every time step t ≥ 1, which is the highest that can be obtained (without entanglement
distillation). This highest value of the ﬁdelity comes at the cost of a lower success probability,
because the probability that the elementary link is active stays at pe for all times with respect
to this policy, i.e., Pr[Xe(t) = 1]π = pe for all t ≥ 1 if at every time step the agent requests a
link.

The two policies considered above illustrate the trade-oﬀ between the expected status
E[Xe(t)]π and the expected ﬁdelity E[Fe(t)]π of an elementary link. The quantity E[ eFe(t)]π,
with eFe(t) deﬁned in (3.12), incorporates this trade-oﬀ, as it can be thought of intuitively as
the product of the status and ﬁdelity of an elementary link. Let us therefore now turn to
ﬁnding policies that maximize the quantity E[ eFe(t)]π as a function of time.

3.4 Policy optimization

We would like to understand the highest value that E[ eFe(t)]π can take as a function of policies
π and times t ≥ 1, given a particular entanglement generation success probability pe (and
thus, given particular values of the physical parameters that comprise the success probability).
With this, we can answer the third question posed at the end of Section 2, and more broadly,
we can begin to understand the limits of practical, near-term quantum networks.

3.4.1 Backward recursion

Optimization of E[ eFe(t)]π with respect to policies π for a given elementary link is given by the
following recursive procedure.

Theorem 3.4 (Optimal policy for an elementary link). Let G = (V, E) be the graph corre-
sponding to the elementary links of a quantum network, let e ∈ E, and let ψ ≡ |ψihψ| be a
pure target state. Then, for all T ≥ 1,

max
π

E[ eFe(T + 1)]π =

1
X

x1=0

max
a1∈{0,1}

w2(x1, a1),

(3.18)

where

wt(ht−1, at−1) =

1
X

xt=0

max
at∈{0,1}

wt+1(ht−1, at−1, xt, at) ∀ 2 ≤ t ≤ T,

(3.19)

wT +1(hT , aT ) = py
e

(1 − pe)x−yfe

(cid:16)

Me(T + 1)(hT , aT , 1)(cid:17)

,

(3.20)

and y = N succ
is deterministic and given by

(T + 1)(hT , aT , 1), x = N req

e

e

(T + 1)(hT , aT , 1). Furthermore, the optimal policy

dBR
t

(ht) := arg max
at∈{0,1}

wt+1(ht, at) ∀ 1 ≤ t ≤ T. (cid:74)

Accepted in Quantum 2021-08-30, click title to verify. Published under CC-BY 4.0.

(3.21)

10

Observe that in the recursive procedure presented in Theorem 3.4, we must ﬁrst determine
the optimal action at the ﬁnal time step and then determine the optimal actions at the previous
time steps in turn. For this reason, the recursive procedure is often known as backward
recursion. Note that this recursive procedure is exponentially slow in the ﬁnal time because of
the fact that the number of histories grows exponentially with time—the number of histories
up to time t is |{0, 1}2t−1| = 22t−1. For this reason, it is useful to have eﬃcient methods for
estimating the maximum ﬁdelity of an elementary link. One such method is forward recursion.

3.4.2 Forward recursion

Instead of starting from the ﬁnal time step and ﬁnding the optimal actions by going backwards,
we could instead ﬁnd optimal actions by going forwards, i.e., by selecting the action such that
the immediate expected ﬁdelity is maximized. Such a “forward recursion” approach is more
natural from the perspective of a real-world learning agent, who has to make decisions in real
time and does not necessarily have complete knowledge of the environment in order to perform
the backward recursion algorithm. However, the forward recursion algorithm will not neces-
sarily lead to a globally optimal policy. In fact, the globally optimal policy can be obtained
using the backward recursion algorithm, which is the result of Theorem 3.4. Nevertheless, it
is worthwhile to brieﬂy discuss the forward recursion algorithm because many reinforcement
learning algorithms are based on it, and they give eﬃciently computable lower bounds on the
maximum expected ﬁdelity of an elementary link.

Theorem 3.5 (Policy optimization via forward recursion). Let G = (V, E) be the graph
corresponding to the elementary links of a quantum network, and let e ∈ E. The forward
recursion algorithm gives rise to the deterministic policy (dFR
2 , . . . ) for the elementary
link corresponding to e, where


1 , dFR

1 if xt = 0,




dFR
t

(ht) :=

0 if xt = 1 and fe

(cid:0)Me(t)(ht) + 1(cid:1) > pefe(0),

(3.22)

1 if xt = 1 and fe

(cid:0)Me(t)(ht) + 1(cid:1) ≤ pefe(0),

for all t ≥ 1 and all ht ∈ {0, 1}2t−1, where pe is the success probability for the elementary link
corresponding to e. (cid:74)

4 The memory-cutoﬀ policy

In Section 3, we deﬁned a quantum decision process for elementary links in a quantum network.
We determined results for the quantum state of an elementary link for arbitrary policies,
deﬁned ﬁgures of merit to evaluate policies (in particular, the expected ﬁdelity), and presented
algorithms for determining optimal policies. Let us now consider an explicit example of a
policy.

A natural policy to consider, and one that has been considered extensively previously
[58–68], is the following deterministic policy. An elementary link is requested at every time

Accepted in Quantum 2021-08-30, click title to verify. Published under CC-BY 4.0.

11

step until it becomes active, and once it is active it is held in quantum memory for some
pre-speciﬁed amount t? of time steps (usually called the memory cutoﬀ and not necessarily
equal to the memory coherence time) after which the quantum state of the elementary link is
discarded and requested again. The cutoﬀ t? can be any value in the set N0 ∪ {∞}, where
N0 = {0, 1, 2, . . . }. There are two extreme cases of this policy: when t? = 0, a request is made
at every time step regardless of whether the previous request succeeded; if t? = ∞, then an
elementary link request is made at every time step until the elementary link becomes active,
and once it becomes active the corresponding entangled state remains in memory indeﬁnitely—
no further request is ever made. In this section, we provide a complete analysis of this policy
for all values of t? ∈ N0 ∪ {∞} using the general developments in Section 3. Details of the
analysis can be found in Appendix D.

Throughout this section, we consider an arbitrary elementary link in a quantum network,
speciﬁed by the edge e ∈ E in the graph G = (V, E) corresponding to the elementary links of
the network.

Deﬁnition 4.1 (Memory-cutoﬀ policy). Given a cutoﬀ t? ∈ N0 ∪ {∞}, the t? memory-cutoﬀ
policy is the sequence (dt?
2 , . . . ) given by the following for all t ≥ 1 and every history
ht ∈ {0, 1}2t−1.

1 , dt?

•

•

•

If t? = 0 : d0
t

If t? ∈ N : dt?
t

(ht) := 1.



(ht) :=

0 if 0 ≤ Me(t)(ht) ≤ t? − 1,
1 if Me(t)(ht) = −1 or Me(t)(ht) = t?.



If t? = ∞ : d∞
t

(ht) :=






0 if Me(t)(ht) ≥ 0,
1 if Me(t)(ht) = −1. (cid:74)

(4.1)

(4.2)

(4.3)

4.1 Expected quantum state

Recall from (3.11) that the expected quantum state of an elementary link in a quantum
network undergoing a policy π is given by the probabilities Pr[Xe(t) = 1, Me(t) = m]π and
Pr[Xe(t) = 1]π. We now provide analytic expressions for these probabilities, which we denote
by Pr[Xe(t) = 1, Me(t) = m]t? and Pr[Xe(t) = 1]t?, in the case of the memory-cutoﬀ policy for
all possible values of the cutoﬀ t?. We consider both the short-term (t < ∞) and the long-term
(t → ∞) behavior of these probabilities.

4.1.1 Short-term behavior

In the short term, we obtain the following result for the joint probability distribution of the
elementary link status Xe(t) and memory time Me(t) random variables.

Theorem 4.2. Let pe ∈ [0, 1] be the success probability for an elementary link in a quantum
network, as deﬁned in Section 3.1, and let t ≥ 1.

Accepted in Quantum 2021-08-30, click title to verify. Published under CC-BY 4.0.

12

• For all t? ∈ N0 ∪ {∞}, if t ≤ t? + 1 and m ∈ {−1, 0, 1, . . . , t − 1}, then

Pr[Me(t) = m, Xe(t) = 1]t? = pe(1 − pe)t−(m+1)(1 − δm,−1).

(4.4)

If t > t? + 1 and m ∈ {−1, 0, 1, . . . , t?}, then

Pr[Me(t) = m, Xe(t) = 1]t?

= (1 − δm,−1)

b t−1
t?+1 c
X

x=0

t − (m + 1) − xt?
x

!

1t−(m+1)−x(t?+1)≥0

× px+1
e

(1 − pe)t−(m+1)−x(t?+1),

(4.5)

where

1t−(m+1)−x(t?+1)≥0 =






1 if t − (m + 1) − x(t? + 1) ≥ 0,
0 otherwise.

• For all t? ∈ N0 and m ∈ {−1, 0, 1, . . . , t?},

Pr[Me(t) = m, Xe(t) = 0]t?

=






δm,−1(1 − pe)t,

t ≤ t? + 1,

δm,−1

b t−1
t?+1 c
X

x=0

t − 1 − xt?
x

!

px
e

For t? = ∞ and m ∈ {−1, 0, 1, . . . , t − 1},

(1 − pe)t−(t?+1)x,

t > t? + 1.

(4.6)

(4.7)

Pr[Me(t) = m, Xe(t) = 0]∞ = δm,−1(1 − pe)t. (cid:74)

(4.8)

From Theorem 4.2, we immediately obtain an expression for the probability that an ele-

mentary link is active at all times t ≥ 1.

Accepted in Quantum 2021-08-30, click title to verify. Published under CC-BY 4.0.

13

 
 
Figure 2: (Left) The expected elementary link status, given by (4.9), as a function of the success probability
pe for various values of t and t?. (Right) The expected elementary link status, given by (4.9), as a function
of t for various values of pe and t?.

Corollary 4.3. For every time t ≥ 1, cutoﬀ t? ∈ N0 ∪ {∞}, and success probability pe ∈ [0, 1],
the probability that an elementary link in a quantum network undergoing the t? memory-cutoﬀ
policy is active at time t is

1 − (1 − pe)t,



Pr[Xe(t) = 1]t?



b t−1
t?+1 c
X

t?+1
X

=

x=0

k=1

t − k − xt?
x

!

1t−k−x(t?+1)≥0px+1

e

(1 − pe)t−k−(t?+1)x,

t > t? + 1. (cid:74)

(4.9)

t ≤ t? + 1,

See Figure 2 for plots of the expected elementary link status E[Xe(t)]t? = Pr[Xe(t) = 1]t?
as a function of time t and as a function of the success probability pe. The oscillatory behavior
of the expected elementary link status as a function of time in the right panel of Figure 2
is due to the nature of the memory-cutoﬀ policy, which requires that the elementary link be
discarded every t? time steps. Indeed, the period of the oscillations is t?, which is apparent
for short times and large values of t?. In the long term, however, we see that the amplitude
of the oscillations decreases, and the expected elementary link status reaches a steady state,
whose value we state below in Theorem 4.4.

4.1.2 Long-term (steady-state) behavior

Let us now consider the t → ∞, or long-term behavior of an elementary link undergoing the
memory-cutoﬀ policy.

Theorem 4.4. Let t? ∈ N0 be the cutoﬀ and pe ∈ [0, 1] be the success probability for an
elementary link in a quantum network. For all m ∈ {−1, 0, 1, . . . , t?},

lim
t→∞

Pr[Me(t) = m, Xe(t) = 1]t? =

pe
1 + t?pe

(1 − δm,−1),

Accepted in Quantum 2021-08-30, click title to verify. Published under CC-BY 4.0.

(4.10)

14

0.00.20.40.60.81.0pe0.000.250.500.751.00E[Xe(t)]t?t=8,t?=5t=30,t?=10t=50,t?=150100200300t0.20.40.60.81.0E[Xe(t)]t?pe=0.3,t?=5pe=0.3,t?=10pe=0.3,t?=15 
lim
t→∞

Pr[Me(t) = m, Xe(t) = 0]t? =

1 − pe
1 + t?pe

δm,−1.

Consequently,

4.2 Expected ﬁdelity

lim
t→∞

E[Xe(t)]t? =

(t? + 1)pe
1 + t?pe

. (cid:74)

(4.11)

(4.12)

If an elementary link in a quantum network undergoes the t? memory-cutoﬀ policy, and it has
success probability pe, then from Theorem 4.2 and Corollary 4.3, we immediately obtain the
following expressions for the expected ﬁdelity of the elementary link for all t ≥ 1:

E[ eFe(t)]t? =

E[Fe(t)]t? =











t−1
X

m=0

t?
X

m=0

t−1
X

m=0

t?
X

m=0

fe(m)pe(1 − pe)t−(m+1)

t ≤ t? + 1,

fe(m) Pr[Me(t) = m, Xe(t) = 1]t?

t > t? + 1,

fe(m) pe(1 − pe)t−(m+1)

1 − (1 − pe)t

t ≤ t? + 1,

fe(m)

Pr[Me(t) = m, Xe(t) = 1]t?
Pr[Xe(t) = 1]t?

t > t? + 1,

(4.13)

(4.14)

where in (4.13) and (4.14) the expression for Pr[Me(t) = m, Xe(t) = 1]t? for t > t? + 1 is given
in (4.5), and the expression for Pr[Xe(t) = 1]t? for t > t? + 1 is given in (4.9).

In the limit t → ∞, using Theorem 4.4, we obtain the following:

lim
t→∞

E[ eFe(t)]t? =

lim
t→∞

E[Fe(t)]t? =

5 Summary and outlook

t?
X

pe
1 + t?pe
m=0
t?
X

1
t? + 1

m=0

fe(m),

t? ∈ N0,

fe(m),

t? ∈ N0.

(4.15)

(4.16)

Understanding the capabilities and limitations of near-term quantum networks is an important
problem, whose solutions will help drive the physical realization of small-scale quantum net-
works, and eventually lead to the realization of a global-scale quantum internet. Before such
developments can be made, we must ﬁrst have a common language and theoretical framework
for analyzing quantum network protocols. This work provides the ﬁrst steps towards such
a general theoretical framework for practical quantum network protocols. We make use of
the concept of a decision process to model protocols for elementary links. This formulation

Accepted in Quantum 2021-08-30, click title to verify. Published under CC-BY 4.0.

15

is natural based on the structure of near-term quantum network protocols, and it allows for
optimal policies to be obtained using dynamic programming algorithms.

Section 3 constitutes the main conceptual and technical contributions of this work. It lays
out a quantum decision process for elementary links in a quantum network. The framework
allows us to model protocols for an elementary link with respect to time in terms of the actions
of an agent that can either request an entangled state from a source or keep the one it currently
has in its quantum memory. The sequence of actions of the agent over time deﬁnes a policy,
which is synonymous with the protocol. After formulating the quantum decision process for
an elementary link and deﬁning ﬁgures of merit for evaluating policies, we considered three
examples of policies: the backward recursion policy in (3.21), the forward recursion policy in
(3.22), and the memory-cutoﬀ policy in Deﬁnition 4.1. We proved that the backward recursion
policy is optimal among all policies (Theorem 3.4).

In Section 4, we considered the memory-cutoﬀ policy, and we applied the results of Section 3
in order to obtain closed-form expressions for the expected quantum state of an elementary
link for an arbitrary value of the cutoﬀ, for both short times and long times. We also obtained
closed-form expressions for the ﬁgures of merit deﬁned in Section 3.2.

We expect the results of this work to be useful as a building block for large-scale quantum
network protocols. For example, the policies for elementary links considered in this work can
be used as an underlying policy layer on top of which routing protocols can be applied in order
to obtain an overall (in general non-optimal) policy for generating end-to-end entanglement
in a network. Furthermore, because our results apply to elementary links consisting of an
arbitrary number of nodes and to any noise model for the quantum memories, they can be
applied to protocols that go beyond bipartite entanglement distribution, namely to protocols
for distributing multipartite entanglement. We also expect our results to be useful in the
analysis of entanglement distribution using all-photonic quantum repeaters [69], and in the
analysis of entanglement distribution using satellite-based quantum networks [70–74], in which
an elementary link can easily be on the order of 1000 km [38] while still having a high ﬁdelity.
Initial applications of the results of this work to satellite-based elementary links can be found
in [75, Chapter 7].

This work also opens up several other interesting directions for future work. Of immediate
interest is to go beyond the elementary link level by incorporating entanglement distillation
and swapping into the decision process developed here, which would allow for the analysis of
more sophisticated quantum network protocols, and it would build on prior works [54, 76–79]
that examine quantum network protocols beyond the elementary link level. Such an extension
would involve multiple cooperating agents, in contrast to the independent agents considered in
this work, and can in principle be formulated for an arbitrary network topology. A simple, but
relevant example of a network topology, which has also been considered recently, is the star-
shaped network used for the so-called “quantum entanglement switch” [80–83]. As we might
expect, these extra elements of entanglement distillation and swapping will make analytic
analysis (as done in this work) intractable. This is when reinforcement learning algorithms
are expected to be helpful for ﬁnding optimal policies. The beginnings of some of these future
developments can be found in [75, Appendix D].

Accepted in Quantum 2021-08-30, click title to verify. Published under CC-BY 4.0.

16

Acknowledgments

I dedicate this work to the memory of Jonathan P. Dowling. This work, and the other works
that I was fortunate to co-author with Jon, would not have been possible without his constant
encouragement and his enthusiasm for the quantum internet.

The plots in this work were made using the Python package matplotlib [84].

Financial support was provided by the National Science Foundation and the National Science
and Engineering Research Council of Canada Postgraduate Scholarship.

Accepted in Quantum 2021-08-30, click title to verify. Published under CC-BY 4.0.

17

Appendix A Related work

Prior theoretical work on quantum networks can essentially be split into two types. The
ﬁrst type of work is information theoretic [85–91], with the focus being on obtaining (or
placing bounds on) the ultimate limits of communication in a quantum network, without
taking device imperfections (such as quantum memories with limited coherence times and non-
deterministic gate operations) explicitly into account. Consequently, this type of work does
not always provide a realistic analysis for near-term quantum networks. The second type of
theoretical work on quantum networks [58–65, 69, 92–110] (see also [111–113] and the references
therein) focuses on calculating communication rates under more realistic assumptions on the
devices, sometimes with speciﬁc physical architectures and diﬀerent types of noise- and loss-
mitigation techniques, such as entanglement distillation and quantum error-correction, taken
into account. Typically, these works have been focused primarily on the topology of a linear
chain of nodes. However, more recent work [66, 78, 79, 114–123] has begun to focus on arbitrary
topologies, with routing protocols taken into account in some cases [56, 57, 89, 90, 124–127].
The techniques used in these works are often varied, and sometimes diﬀerent terminology and
mathematical tools are used. One of the aims of this work is to provide the starting point for
a uniﬁed theoretical framework for practical quantum network protocols that can, in principle,
incorporate and generalize the developments in the aforementioned works of the second type,
and that can be applied to arbitrary topologies and physical architectures.

Policy-based approaches to quantum network protocols, as considered in this work, have
been considered before in [62, 76, 128, 129] (see also [113]), where terms such as “rule-set”
or “schedule” have been used instead of “policy”. In [62], the authors consider diﬀerent con-
trol protocols for elementary links in a quantum network based on diﬀerent conﬁgurations
of the sources and heralding stations and the impact they have on end-to-end entanglement
distribution rates.
In [128], the authors look at protocols for end-to-end entanglement dis-
tribution along a chain of quantum repeaters and simulate diﬀerent scheduling protocols for
entanglement distillation along elementary links. Similarly, in [76], the authors use ﬁnite state
machines to analyze the diﬀerent layers of an end-to-end entanglement distribution protocol
in quantum networks, such as entanglement distillation and entanglement swapping. Finally,
in [129], the authors use an approach based on rule-sets to determine end-to-end entanglement
distribution rates and ﬁdelities of the end-to-end pairs along a chain of quantum repeaters.
One of the goals of this work is to explicitly formalize the approaches taken in the aforemen-
tioned works within the context of decision processes, because this allows us to systematically
study diﬀerent policies and calculate quantities that are relevant for quantum networks, such
as entanglement distribution rates and ﬁdelities of the quantum states of the links.

This work is complementary to prior work that uses Markov chains to analyze waiting
times and entanglement distribution rates for a chain of quantum repeaters [65, 130–132]; we
also refer to the work on entanglement switches in [80–83], which use both discrete-time and
continuous-time Markov chains. This work is also complementary to prior work that analyzes
the quantum state in a quantum repeater chain with noisy quantum memories [133–137].

In [54], the authors use reinforcement learning to discover protocols for quantum telepor-
tation, entanglement distillation, and end-to-end bipartite entanglement distribution along a

Accepted in Quantum 2021-08-30, click title to verify. Published under CC-BY 4.0.

18

chain of quantum repeaters. While the work in [54] is largely numerical, this work is focused
on formally developing the mathematical tools needed to perform reinforcement learning of
entanglement distribution protocols in general quantum networks. The development of the
mathematical tools is essential when an agent acts in a quantum-mechanical environment, be-
cause it is important to understand how the agent’s actions aﬀect the quantum state of the
environment. Furthermore, we expect that the protocols learned in [54], particularly those for
entanglement distillation and entanglement swapping, could be incorporated as subroutines
within the mathematical framework of decision processes developed in this work, so that large-
scale quantum network protocols (going beyond the elementary link level) can be discovered
using reinforcement learning.

This work is also related to the work in [118], in which the authors develop a link-layer
protocol for generating elementary links in a quantum network, and they perform simulations of
entanglement distribution using a discrete-event simulator under various scenarios. The eﬀect
of diﬀerent scheduling strategies is also considered. The protocols in [118] consider actions in a
more ﬁne-grained manner than what we consider in this work. In particular, the steps required
for heralding (namely, the communication signals for the results of the heralding) are explicitly
taken into account. These steps can be incorporated within the framework developed here—all
that has to be done is to appropriately deﬁne the transition maps (deﬁned below) in order
to accommodate the additional actions. We can similarly incorporate other classical discrete-
valued properties of an elementary link into the elementary link status random variable Xe(t)
if needed.

The approach to policy optimization taken in this work is similar to the approach in [55],
in the sense that both approaches make use of the principle of dynamic programming. While
in [55] the focus is on obtaining end-to-end bipartite entanglement in a chain of quantum
repeaters, the goal here is simply to examine elementary links and to determine the optimal
sequence of actions that should be performed in order to maximize both the ﬁdelity of an
elementary link and the probability that an elementary link is active at any given time. Other
recent work on optimization of quantum network protocols can be found in [121, 122].

Appendix B Elementary link generation

Let e ∈ E denote an arbitrary (hyper)edge of the graph G = (V, E) corresponding to the
elementary links of a quantum network, and suppose that the edge contains k ≥ 2 nodes
v1, v2, . . . , vk. The source associated with the elementary link corresponding to e prepares a
k-partite quantum state ρS
. This quantum
for k quantum systems labeled Av1
e , . . . , Avk
e
e
state is distributed to the nodes by sending each quantum system Avi
through a quantum
e
channel Se,i, so that the state after transmission is

e , Av2

ρS,out
e

:= (Se,1 ⊗ Se,2 ⊗ · · · ⊗ Se,k) (ρS
e

) = Se(ρS
e

),

(B.1)

where Se := Se,1 ⊗ Se,2 ⊗ · · · ⊗ Se,k.

After transmission from the source to the nodes, the nodes execute a heralding procedure,
which is an LOCC protocol executed by the nodes that conﬁrms whether all of the nodes

Accepted in Quantum 2021-08-30, click title to verify. Published under CC-BY 4.0.

19

received their quantum systems. If the heralding procedure succeeds, then the nodes store
their quantum systems in a quantum memory. Mathematically, the heralding procedure can be
described by a quantum instrument {M0
are completely
is trace preserving. The map M0
positive trace non-increasing maps such that M0
e
e
corresponds to failure of the heralding procedure, and the map M1
corresponds to success. The
e
outcome of the heralding procedure can then be captured by the following classical-quantum
state:

e}, which means that M0
e
+ M1
e

and M1
e

e, M1

bσe(1) := |0ih0| ⊗ M0

e

(ρS,out
e

) + |1ih1| ⊗ M1
e

(ρS,out
e

)

= |0ih0| ⊗ eσe(0) + |1ih1| ⊗ eσe(1),

(B.2)

(B.3)

where the classical register holds the binary outcome of the heralding procedure (‘1’ for success
and ‘0’ for failure) and the quantum register holds the quantum state of the nodes correspond-
ing to the outcome. In particular,

is the (unnormalized) quantum state corresponding to failure, and

eσe(0) := (M0

e ◦ Se)(ρS
e

)

eσe(1) := (M1

e ◦ Se)(ρS
e

)

(B.4)

(B.5)

is the (unnormalized) quantum state corresponding to success. The (normalized) quantum
states conditioned on success and failure, respectively, are deﬁned to be
:= eσe(1)
Tr[

:= eσe(0)
Tr[

(B.6)

τ ∅
e

ρ0
e

eσe(1)] ,

eσe(0)] .

The superscript ‘0’ in ρ0
indicates that the quantum memories of the nodes are in their initial
e
state immediately after success of the heralding procedure; we expand on this below. We let

eσe(1)] = Tr[(M1
denote the overall probability of success of the transmission from the source and of the herald-
ing procedure.

e ◦ Se)(ρS
e

pe := Tr[

(B.7)

)]

Now, as mentioned above, once the heralding procedure succeeds, the nodes store their
quantum systems in their local quantum memory. We describe the decoherence of the quantum
of the elementary
memories by quantum channels Ne,i acting on each quantum system Avi
e
link corresponding to e, i ∈ {1, 2, . . . , k}. The decoherence channel is applied at every time
step in which the quantum system is in memory. The overall quantum channel acting on all
of the quantum systems in the elementary link is

Ne := Ne,1 ⊗ Ne,2 ⊗ · · · ⊗ Ne,k.
The quantum state of the elementary link after m time steps in the memories is therefore given
by

(B.8)

(ρ0
(B.9)
e
= Ne ◦ Ne ◦ · · · ◦ Ne (m times). For a particular target/desired quantum state of

where N ◦m
the elementary link, which we assume to be a pure state ψ = |ψihψ|, we let

ρe(m) := N ◦m

),

e

e

denote the ﬁdelity of the state ρe(m) with respect to the target state ψ.

fe(m) := hψ|ρe(m)|ψi = hψ|N ◦m

e

(ρ0
e

)|ψi

(B.10)

Accepted in Quantum 2021-08-30, click title to verify. Published under CC-BY 4.0.

20

Appendix C Details of the elementary link quantum decision process

The primary mathematical concept being used in this work is that of a Markov decision process.
In particular, we consider a particular quantum generalization of a Markov decision process
given in [138] (see also [139, 140]), called a quantum partially observable Markov decision
process. For brevity, we use the term quantum decision process throughout this work. In a
quantum decision process, the agent’s action at each time step results in a transformation of the
quantum state of the environment, and the agent receives both partial (classical) information
about the new quantum state of the environment along with a reward.
In the context of
elementary links in a quantum network, the elements of the quantum decision process that
we formally deﬁne below are shown in Figure 1. For a more general deﬁnition of a quantum
decision process, we refer to [75, Chapter 3].

Deﬁnition C.1 (Quantum decision process for elementary links). Let G = (V, E) be the
graph corresponding to the elementary links of a quantum network, and let e ∈ E. As shown
in Figure 1, we deﬁne a quantum decision process for e by deﬁning the agent for e to be
collectively the nodes belonging to e, and we deﬁne its environment to be the quantum systems
distributed by the source station to the nodes of e. Then, the other elements of the quantum
decision process are deﬁned as follows.

• We denote the quantum systems of the environment collectively by Ee, and we let Ee
t
denote these quantum systems at time t ≥ 0. We drop the superscript and simply write
Et when the edge e is understood from the context or unimportant in the context being
considered. The quantum state of the environment at time t = 0 is the source state
e ≡ ρS
ρS
Ee
0

.

• We let X = {0, 1} tell us whether or not the elementary link is active at a particular
time. From this, we deﬁne elementary link status random variables Xe(t) for all t ≥ 1 as
follows:

– Xe(t) = 0: elementary link is inactive (transmission and heralding not successful);
– Xe(t) = 1: elementary link is active (transmission and heralding successful).

We let A = {0, 1} be the set of possible actions of the agent, and we deﬁne corresponding
action random variables Ae(t) for all t ≥ 1 as follows:

– Ae(t) = 0: wait/keep the entangled state;
– Ae(t) = 1: discard the entangled state and request a new entangled state.

The set of all histories up to time t ≥ 1 is (X × A)×(t−1) × X = {0, 1}2t−1, and every
element ht ∈ {0, 1}2t−1 is a sequence of the form

ht = (x1, a1, x2, a2, . . . , at−1, xt),

(C.1)

with xj ∈ {0, 1} being the elementary link status at time j ∈ {1, 2, . . . , t} and aj ∈ {0, 1}
being the action taken at time j ∈ {1, 2, . . . , t − 1}. The corresponding random variable
for the history is

He(t) := (Xe(1), Ae(1), Xe(2), Ae(2), . . . , Ae(t − 1), Xe(t)).

Accepted in Quantum 2021-08-30, click title to verify. Published under CC-BY 4.0.

(C.2)

21

The random variables Xe(t), Ae(t), and He(t) are mutually independent by deﬁnition
for all e ∈ E.

• The transformation of the quantum state of the environment from one time step to the
next is given by a set of transition maps. The transition maps tell us what eﬀect each
action has on the quantum state of the environment based on the status of the elementary
≡ T xt,at,xt+1
link in the previous time step. We denote the transition maps by T xt,at,xt+1
t →Ee
Ee
for all xt, at, xt+1 ∈ {0, 1} and all t ≥ 1, where

t+1

e

T xt,1,1
e
T xt,1,0
e
T 1,0,1
e
T 0,0,0
e

e ◦ Se)(ρS
e
e ◦ Se)(ρS
e

(σ) := Tr[σ](M1
(σ) := Tr[σ](M0
(σ) := Ne(σ),
(σ) := σ,

) ∀ xt ∈ {0, 1},
) ∀ xt ∈ {0, 1},

(C.3)

(C.4)

(C.5)

(C.6)

for all linear operators σ, where the deﬁnitions of the source transmission channel Se, the
heralding quantum instrument {M0
e}, and the decoherence channel Ne are given in
Appendix B. Superscript combinations not deﬁned above are equal to the zero map by
:= 0. The transition maps are such that the sum
deﬁnition, i.e., T 0,0,1
xt+1=0 T xt,at,xt+1
P1
e

:= 0 and T 1,0,0

e, M1

e

e

is a trace-preserving map for all xt, at ∈ {0, 1}.
, x1 ∈ {0, 1}, are deﬁned to be

The maps T 0;x1

e

≡ T 0;x1
Ee

0→Ee
1

T 0;0
e
T 0;1
e

:= M0
:= M1

e ◦ Se,
e ◦ Se.

(C.7)

(C.8)

The sum T 0;0

e

+ T 0;1
e

is a trace-preserving map.

• Given a pure target state ψtarget = |ψtargetihψtarget|, the reward at time t ≥ 1 is deﬁned

as follows:

e

Rt;ht+1,1
Rt;ht+1,0

e

(·) = ψtarget(·)ψtarget,
(·) = (1 − ψtarget)(·)(1 − ψtarget),

(C.9)

(C.10)

for all ht+1 ∈ {0, 1}2t+1, and we deﬁne functions Re(t) : {0, 1}2t+1 × {0, 1} → R as
follows:

Re(t)(ht+1, 0) = 0,
Re(t)(ht+1, 1) = δxt+1,1,

(C.11)

(C.12)

for every history ht+1 = (x1, a1, . . . , xt, at, xt+1) ∈ {0, 1}2t+1.

• A T -step policy for the agent is a sequence of the form π = (d1, d2, . . . , dT ), where the

decision functions dt : {0, 1}2t−1 × {0, 1} → [0, 1] are deﬁned to be

dt(ht)(at) := Pr[Ae(t) = at|He(t) = ht]

(C.13)

for all times 1 ≤ t ≤ T , histories ht ∈ {0, 1}2t−1, and actions at ∈ {0, 1}. (cid:74)

Accepted in Quantum 2021-08-30, click title to verify. Published under CC-BY 4.0.

22

Figure 3: The agent-environment interaction corresponding to the quantum decision process for an elementary
link in a quantum network, as given in Deﬁnition C.1, can be viewed as a quantum causal network. The
actions of the agent are given by decision channels, deﬁned in (C.14) according to the agent’s policy, and
the corresponding changes in the quantum state of the environment are given by environment response
channels, deﬁned in (C.16) and (C.17) according to the transition maps in (C.3)–(C.8).

Given an elementary link speciﬁed by an edge e ∈ E and a policy π = (d1, d2, . . . , dt, . . . ) for
the corresponding agent, the agent-environment interaction, as depicted in Figure 1, consists
of a sequence of actions and responses of the agent and environment, respectively. This back-
and-forth between the agent and the environment falls into the general paradigm of agent-
environment interactions considered previously in [141, 142], and more generally it falls within
the theoretical framework of quantum causal networks (also referred to as quantum combs and
quantum games) [143–146]; see Figure 3.

In terms of the quantum causal network shown in Figure 3, the actions of the agent are

given by the decision channels, which are deﬁned as

Dt

Ht→HtAt

(|htihht|Ht

) := |htihht|Ht ⊗

1
X

a=0

dt(ht)(a)|aiha|At,

(C.14)

where for ht = (x1, a1, . . . , at−1, xt),

|htiHt

= |x1iX1|a1iA1 · · · |at−1iAt−1|xtiXt

(C.15)

and Ht ≡ X1A1 · · · At−1Xt, with Xj and Aj denoting classical registers that store the elemen-
tary link status and the action, respectively, at time j.

The changes in the quantum state of the environment, based on the actions of the agent,

are given by the environment response channels, which are deﬁned as

E 0
E0→H1E1

(ρE0

) :=

1
X

|x1ihx1|X1 ⊗ T 0;x1

E0→E1

(ρE0

),

E t
HtAtEt→Ht+1Et+1

x1=0
(ωHt ⊗ σAt ⊗ ρEt

)

1
X

:=

xt,at,xt+1=0

TrXtAt

[(ωHt ⊗ σAt

)|xt, atihxt, at|XtAt

]

(C.16)

× |xt, at, xt+1ihxt, at, xt+1|XtAtXt+1 ⊗ T xt,at,xt+1
Et→Et+1

(ρEt

),

(C.17)

for arbitrary states ρE0, ωHt, σAt, ρEt

.

Accepted in Quantum 2021-08-30, click title to verify. Published under CC-BY 4.0.

23

E0E1E2D1D2ρSE0H1A1H1H2H2A2H3E1E2E3bσπe(1)bσπe(2)bσπe(3)In general, the classical-quantum state in (3.5) is given by

bσπ

e

(t) ≡ bσπ

HtEt

(t) := P π;t

E0→HtEt

(ρS
E0

),

where

P π;t

E0→HtEt

:= E t−1

Ht−1At−1Et−1

◦ Dt−1

Ht−1→Ht−1At−1
◦ E 1

◦ · · ·
H1A1E1→H2E2 ◦ D1

H1→H1A1 ◦ E 0

E0→H1E1.

(C.18)

(C.19)

Using the deﬁnitions of the decision and environment response channels, it is straightforward
to show that

(t) = X

bσπ

e

|htihht|Ht ⊗ eσπ

e

(t; ht),

(C.20)

where

eσπ

e

(t; ht) =



dj(ht
j

)(aj)



(cid:16)





t−1
Y

j=1

Then, we have

ht∈{0,1}2t−1

T xt−1,at−1,xt
e

◦ · · · ◦ T x2,a2,x3
e

◦ T x1,a1,x2

e

◦ T 0;x1
e

(cid:17) (ρS

e

).

(C.21)

Pr[He(t) = ht]π = Tr[

e

eσπ
eσπ

(t; ht)],
(t; ht)
Pr[He(t) = ht]π

e

.

(C.22)

(C.23)

σe(t|ht) =

On the other hand, by the basic rules of probability, we have

Pr[He(t) = ht]π = Pr[Xe(1) = x1, Ae(1) = a1, . . . , Ae(t − 1) = at−1, Xe(t) = xt]π

(C.24)

= Pr[Xe(1) = x1]

×

t
Y

j=2

(cid:16)Pr[Xe(j) = xj|H(j − 1) = ht

j−1, A(j − 1) = aj−1] · dj−1(ht

j−1

)(aj−1)(cid:17)

.

(C.25)

It follows that the transition probabilities in (C.25) are given by

Pr[Xe(t + 1) = xt+1|He(t) = ht, Ae(t) = at] = Trh

T xt,at,xt+1
e

(σe(t|ht))i

.

(C.26)

Using this, and the deﬁnition of the transition maps, we have the following values for the tran-
sition probabilities for all t ≥ 1 and for every history ht = (x1, a1, . . . , at−1, xt) ∈ {0, 1}2t−1:

Pr[Xe(t + 1) = 0|Xe(t) = xt, Ae(t) = 1] = 1 − pe,
Pr[Xe(t + 1) = 1|Xe(t) = xt, Ae(t) = 1] = pe,

Pr[Xe(t + 1) = xt+1|Xe(t) = xt, Ae(t) = 0] = δxt,xt+1 ∀ xt+1 ∈ {0, 1},

(C.27)

(C.28)

(C.29)

where pe is the success probability deﬁned in (B.7). Observe that the transition probabilities
are time independent. Furthermore, the status of an elementary link at time t + 1 depends
only on the status and action at time t, not on the entire history of statuses and actions. This
reﬂects the fact that the transition maps also depend only on the status and action at the
previous time step.

Accepted in Quantum 2021-08-30, click title to verify. Published under CC-BY 4.0.

24

For every edge e ∈ E in the graph G = (V, E) corresponding to the elementary links of a
quantum network, and for every T -step policy π for the elementary link corresponding to e,
the expected reward at time T is

E[Re(T )]π := X

X

Re(T )(hT +1, s) Pr h

i
H(T + 1) = hT +1, s

π

(C.30)

hT +1∈{0,1}2T +1

= X

s∈{0,1}
X

Re(T )(hT +1, s) Tr h

RT ;hT +1,s

e

hT +1∈{0,1}2T +1

= X

s∈{0,1}
Tr h

ψtarget (cid:16)

(T + 1; hT +1)(cid:17)i

eσπ

e

hT +1∈{0,1}2T +1
xT +1=1

= Tr (cid:2)(|1ih1|XT +1 ⊗ ψtarget)

(T + 1)(cid:3) .

bσπ

e

In other words,

E[Re(T )]π = E[ eFe(T + 1)]π.

(cid:16)

eσπ

e

(T + 1; hT +1)(cid:17)i

(C.31)

(C.32)

(C.33)

(C.34)

Finally, the memory time random variable Me(t) deﬁned in (3.2) can be expressed in a

closed form as follows:

Me(t) = Ae(0)(Xe(1) + Xe(2) + · · · + Xe(t) − 1)Ae(1) Ae(2) · · · Ae(t − 1)

+ Ae(1)(Xe(2) + Xe(3) + · · · + Xe(t) − 1)Ae(2) Ae(3) · · · Ae(t − 1)
+ Ae(2)(Xe(3) + Xe(4) + · · · + Xe(t) − 1)Ae(3) Ae(4) · · · Ae(t − 1)
+ · · ·
+ Ae(t − 1)(Xe(t) − 1)

=

t
X

j=1

Ae(j − 1)



Xe(‘) − 1







t
X

‘=j

t−1
Y

k=j

Ae(k),

(C.35)

(C.36)

where Ae(0) ≡ 1 and Ae(k) := 1 − A(k) for all k ≥ 1. This deﬁnition is indeed equivalent to
the one in (3.2), because we can write the expression in (C.35) as

Me(t) = (Me(t − 1) + Xe(t)) Ae(t − 1) + (Xe(t) − 1)Ae(t − 1),

(C.37)

which is equivalent to (3.2).

C.1 Proof of Theorem 3.1

First, let us observe that the statement of the proposition is true for t = 1, because by (C.7),
(C.8), and (C.21), we can write

(1; x1) = x1 eρ0
eτ ∅
:= (M0
where
e
according to the deﬁnition in (3.2), as required, if x1 = 1. Furthermore,

eσπ
) and

e ◦ Se)(ρS
e

e ◦ Se)(ρS
e

+ (1 − x1)

:= (M1

eρ0

e

e

e

eτ ∅
e ,

). Then, indeed, we have Me(1) = 0

(C.38)

Tr[

eσπ

e

(1; x1)] = x1pe + (1 − x1)(1 − pe) = px1
e

(1 − pe)1−x1,

Accepted in Quantum 2021-08-30, click title to verify. Published under CC-BY 4.0.

(C.39)

25

so that

eτ ∅
+ (1 − x1)
σe(1|x1) = x1 eρ0
e
e
px1
e (1 − pe)1−x1
if x1 = 1,
ρ0
e
τ ∅
if x1 = 0

e
+ (1 − x1)τ ∅
= x1ρ0
e ,
e




=

(C.40)

(C.41)

(C.42)

where we recall the deﬁnitions of ρ0
e

and τ ∅
e

from (B.6).

Now, for t ≥ 2, we use (C.21). Based on the deﬁnition of the transition maps, for every
time step j > 1 in which the action “wait” (i.e., Ae(j) = 0) is performed and the elementary
link is active (i.e., Xe(j) = 1), the elementary link stays active at time step j + 1, and thus by
deﬁnition the memory time must be incremented by one, which is consistent with the deﬁnition
of the memory time Me(t) given in (3.2), and the quantum state of the elementary link goes
from ρe(Me(t)) to ρe(Me(t) + 1). If instead the elementary link is active at time j and the
action “request” is performed (i.e., Ae(j) = 1), then the quantum state of the elementary link
(if Xe(j + 1) = 1) with probability pe or by
is discarded and is replaced either by the state ρ0
e
the state τ ∅
(if Xe(j + 1) = 0) with probability 1 − pe. In the former case, the memory time
e
must be reset to zero, consistent with (3.2), and in the latter case, the memory time is −1,
also consistent with (3.2).

Furthermore, by deﬁnition of the transition maps, every time the action “request” is per-
formed, we obtain a factor of pe (if the request succeeds) or 1 − pe (if the request fails). If the
action “wait” is performed, then we obtain no additional multiplicative factors. The quantity
(t − 1) is, by deﬁnition, equal to the number of requests that succeeded in t − 1 time steps.
N succ
e
Therefore, overall, we obtain a factor pN succ
at the (t − 1)st time step for the number of
e
successful requests. The number of failed requests in t − 1 time steps is given by

(t−1)

e

t−1
X

j=1

Ae(j − 1)(1 − Xe(j)) =

t−1
X

Ae(j − 1) −

t−1
X

Ae(j − 1)Xe(j)

j=1
= N req
e

j=1
(t − 1) − N succ

e

(t − 1),

(C.43)

(C.44)

so that we obtain an overall factor of (1 − pe)N req
the failed requests. Also, the memory time at the (t − 1)st time step is Me(t − 1)(ht
then because the quantum state is either ρe(Me(t − 1)(ht

(t−1) at the (t − 1)st time step for
), and

, we obtain

(t−1)−N succ

)) or τ ∅
e

t−1

t−1

e

e

eσπ

e

(t; ht) =


 p

)(aj)

dj(ht
j





t−1
Y

j=1

N succ
e
e

(t−1)(ht

t−1)

(1 − pe)N req

e

(t−1)(ht

t−1)−N succ

e

(t−1)(ht

t−1)

×

(cid:16)
xt−1T 1,at−1,xt
e

N succ
e
 p
e

)(aj)

dj(ht
j

=





t−1
Y

j=1

(ρe(Me(t − 1)(ht

t−1

))) + (1 − xt−1)T 0,at−1,xt

e

)(cid:17) (C.45)

(τ ∅
e

(t−1)(ht

t−1)

(1 − pe)N req

e

(t−1)(ht

t−1)−N succ

e

(t−1)(ht

t−1)

× pat−1xt
e

(1 − pe)at−1(1−xt)(xtρe(Me(t)(ht)) + (1 − xt)τ ∅
e

)

Accepted in Quantum 2021-08-30, click title to verify. Published under CC-BY 4.0.

(C.46)

26









=

t−1
Y

j=1

dj(ht
j

)(aj)


 pN succ
e

e

(t)(ht)

(1 − pe)N req

e

(t)(ht)−N succ

e

(t)(ht)





× (xtρe(Me(t)(ht)) + (1 − xt)τ ∅
e

).

(C.47)

Then, because Pr[He(t) = ht]π = Tr[

eσπ

e

Pr[He(t) = ht]π =





t−1
Y

j=1

dj(ht
j

as required. Finally,

(t; ht)], we have

 pN succ
e

(t)(ht)

e

)(aj)

(1 − pe)N req

e

(t)(ht)−N succ

e

(t)(ht),

(C.48)

(t; ht)
σe(t|ht) = eσπ
e
(t; ht)]
Tr[
eσπ
e

= xt ρe

(cid:16)

Me(t)(ht)(cid:17) + (1 − xt)τ ∅
e ,

(C.49)

which completes the proof.

C.2 Proof of Corollary 3.2

Using the result of Theorem 3.1, the expected quantum state of the elementary link at time
t ≥ 1 is given by
bσπ
[
(t) = TrHt
e
= X

(C.50)

(C.51)

(t)]

σπ
e

eσπ

e

(t; ht)

ht∈{0,1}2t−1

= X

ht∈{0,1}2t−1

= X

Pr[He(t) = ht]π

(cid:16)

Xe(t)(ht)ρe

(cid:16)

Me(t)(ht)(cid:17) + (1 − Xe(t)(ht))τ ∅

e

(cid:17)

(C.52)

Pr[He(t) = ht]π τ ∅
e

+ X

Pr[He(t) = ht]π ρe

(cid:16)

Me(t)(ht)(cid:17) (C.53)

ht∈{0,1}2t−1:
Xe(t)(ht)=0

ht∈{0,1}2t−1:
Xe(t)(ht)=1

= (1 − Pr[Xe(t) = 1]π)τ ∅
e

+ X
m

Pr[Xe(t) = 1, Me(t) = m]π ρe(m),

(C.54)

where to obtain the last equality we used the fact that
Pr[Xe(t) = 0]π = X

Pr[He(t) = ht]π = 1 − Pr[Xe(t) = 1]π.

(C.55)

ht∈{0,1}2t−1:
Xe(t)(ht)=0

We also rearranged the sum with respect to the set {ht ∈ {0, 1}2t−1 : Xe(t)(ht) = 1} so that
the sum is with respect to the possible values of the memory time m, which in general depends
on the policy π. This completes the proof.

C.3 Proof of Theorem 3.3

To see the ﬁrst equality in (3.15), observe that

Tr [|1ih1|Xt bσπ

e

(t)] = X

Pr[He(t) = ht]π.

(C.56)

ht∈{0,1}2t−1:
Xe(t)(ht)=1

Accepted in Quantum 2021-08-30, click title to verify. Published under CC-BY 4.0.

27

The expression on the right-hand side of this equation is equal to Pr[Xe(t) = 1]π by deﬁni-
tion of the random variable Xe(t). The second equality in (3.15) holds because Xe(t) is a
binary/Bernoulli random variable.

To see (3.16), we ﬁrst use the deﬁnition of expectation to get

E[ eFe(t)]π = X

fe(m) Pr[Xe(t) = 1, Me(t) = m]π,

(C.57)

m

where the sum is with respect to all possible values of the random variable Me(t), which
depends on the policy π. Then, by Theorem 3.1,

Tr [(|1ih1|Xt ⊗ ψ)

bσπ

e

(t)] = X

Pr[He(t) = ht]πhψ|ρe(Me(t)(ht))|ψi

(C.58)

ht∈{0,1}2t−1:
Xe(t)(ht)=1

= X

ht∈{0,1}2t−1:
Xe(t)(ht)=1

Pr[He(t) = ht]πfe(Me(t)(ht))

= X
m

fe(m) Pr[Xe(t) = 1, Me(t) = m]π,

(C.59)

(C.60)

where the last equality holds because the sum with respect to the set {ht ∈ {0, 1}2t−1 :
Xe(t)(ht) = 1} can be rearranged into a sum with respect to the possible values of the memory
time Me(t) when the elementary link is active. This completes the proof.

C.4 Proof of Theorem 3.4

We start with a lemma.

Lemma C.2. Let G = (V, E) be the graph corresponding to the elementary links of a quantum
network, let e ∈ E, let ψ ≡ |ψihψ| be a pure target state, and let π = (d1, d2, . . . , dT ) be a
T -step policy with T ≥ 1. Then,

E[ eFe(T + 1)]π =

1
X

x1,a1=0

d1(x1)(a1) vπ
2

(x1, a1),

(C.61)

where

vπ
t

(ht−1, at−1) :=

1
X

xt,at=0

dt(ht−1, at−1, xt)(at) vπ

t+1

(ht−1, at−1, xt, at)

(C.62)

for all 2 ≤ t ≤ T , ht−1 ∈ {0, 1}2t−3, and at−1 ∈ {0, 1}, and

vπ
T +1

(hT , aT ) := py
e

(1 − pe)x−yfe

(cid:16)

Me(T + 1)(hT , aT , 1)(cid:17)

(C.63)

for all hT ∈ {0, 1}2T −1 and aT ∈ {0, 1}, where y = N succ
1)(hT , aT , 1). (cid:74)

e

(T + 1)(hT , aT , 1), x = N req

e

(T +

Accepted in Quantum 2021-08-30, click title to verify. Published under CC-BY 4.0.

28

Remark C.3. The functions vπ
that we have deﬁned in the statement of the lemma can be
t
thought of as analogous to action-value functions in classical Markov decision processes; see,
e.g., [51, 52]. Also, observe that (C.62) and (C.63) specify a backward recursion algorithm for
, then
evaluating a given policy. The algorithm proceeds by ﬁrst evaluating the function vπ
for all T ≥ t ≥ 2 in order to ﬁnally obtain E[ eFe(T +1)]π. (cid:74)
proceeding backwards, calculating vπ
t

T +1

Proof of Lemma C.2. Using (C.32) and (C.21), we have that
(T + 1; hT +1)(cid:17)i

E[ eFe(T + 1)]π =

Tr h
ψ

X

(cid:16)

eσπ

e

(C.64)

hT +1∈{0,1}2T +1:
xT +1=1

=

X

hT +1∈{0,1}2T +1:
xT +1=1

!

dt(hT +1
t

)(at)

  T
Y

t=1

Tr h
ψ

(cid:16)

eσ(E)

e

(T + 1; hT +1)(cid:17)i

.

(C.65)

For brevity, we denote histories hT +1 = (x1, a1, . . . , xT , aT , xT +1) such that xT +1 = 1 by
(hT , aT , 1), where hT = (x1, a1, . . . , aT −1, xT ). Then,

eσ(E)

e

(T + 1; hT +1) ≡ eσ(E)

(T + 1; hT , aT , 1)

e
:= (cid:16)
T xT ,aT ,1
e

◦ · · · ◦ T x2,a2,x3
e

◦ T x1,a1,x2

e

◦ T 0;x1
e

(cid:17) (ρS

e

).

From this, we see that

where

E[ eFe(T + 1)]π =

1
X

x1,a1=0

d1(x1)(a1) vπ
2

(x1, a1),

(C.66)

(C.67)

(C.68)

(x1, a1) := X

vπ
2

x2,...,xT ∈{0,1}
a2,...,aT ∈{0,1}

!

dt(hT +1
t

)(at)

  T
Y

t=2

Tr h
ψ

(cid:16)

eσ(E)

e

(T + 1; hT , aT , 1)(cid:17)i

.

(C.69)

Then, separating the sum with respect to x2, a2 ∈ {0, 1} in the above equation leads to

vπ
2

(x1, a1) =

1
X

x2,a2=0

d2(hT +1
2

)(a2) vπ
3

, a2),

(x1, a1, x2
|
{z
}
hT +1
2

(C.70)

where

vπ
3

(hT +1
2

, a2) := X

x3,...,xT ∈{0,1}
a3,...,aT ∈{0,1}

!

dt(hT +1
t

)(at)

  T
Y

t=3

Tr h
ψ

(cid:16)

eσ(E)

e

(T + 1; hT , aT , 1)(cid:17)i

.

(C.71)

Proceeding in this manner, we deﬁne functions vπ
t

(ht−1, at−1) for 2 ≤ t ≤ T as follows:

vπ
t

(ht−1, at−1) :=

1
X

xt,at=0

dt(ht−1, at−1, xt)(at) vπ

t+1

(ht−1, at−1, xt, at).

(C.72)

Accepted in Quantum 2021-08-30, click title to verify. Published under CC-BY 4.0.

29

In particular, for t = T , we have

vπ
T

(hT −1, aT −1) := X

dT (hT −1, aT −1, xT )(aT ) Tr h

ψ

(cid:16)

(T + 1; hT , aT , 1)(cid:17)i (C.73)

eσ(E)

e

xT ,aT ∈{0,1}

1
X

=

xT ,aT =0

dT (hT −1, aT −1, xT )(aT ) vπ

T +1

(hT , aT ),

where

Now, it follows from Theorem 3.1 that

vπ
T +1

(hT , aT ) := hψ|eσ(E)

e

(T + 1; hT , aT , 1)|ψi.

(C.74)

(C.75)

eσ(E)

e

(T + 1; hT , aT , 1) = py
e

(1 − pe)x−yρe

(cid:16)

Me(T + 1)(hT , aT , 1)(cid:17)

,

(C.76)

where y = N succ

e

(T + 1)(hT , aT , 1) and x = N req

e

hψ|eσ(E)

e

(T + 1; hT , aT , 1)|ψi = py
e

This completes the proof.

(T + 1)(hT , aT , 1). Therefore,
Me(T + 1)(hT , aT , 1)(cid:17)

(cid:16)

.

(1 − pe)x−yfe

(C.77)

(cid:4)

Remark C.4. There is an advantage to using the backward recursion algorithm (as presented
in Lemma C.2) to evaluate a policy, rather than simply using the deﬁnition of the expected
ﬁdelity in (C.32) or (C.33). This advantage comes from the fact that the function vπ
deﬁned
in (C.63) is independent of the policy π—it depends only on the elements of the environment
and on the horizon time. Therefore, for a given elementary link speciﬁed by the edge e, and a
(hT , aT ) ≡ vT +1(hT , aT ) can be computed once
given horizon time T , the function values vπ
and need never be computed again. Then, given a T -step policy π, the backward recursion
algorithm can be used to quickly evaluate the expected ﬁdelity. (cid:74)

T +1

T +1

Proof of Theorem 3.4. We start with the backward recursion algorithm given in Lemma C.2.
Let

π = (cid:16)

dt(ht) : 1 ≤ t ≤ T, ht ∈ {0, 1}2t−1(cid:17)

denote an arbitrary T -step policy, and let us deﬁne

π(t) := (cid:16)

dj(hj) : t ≤ j ≤ T, hj ∈ {0, 1}2j−1(cid:17)

(C.78)

(C.79)

to be the “slices” of π from time t onwards. By observing that vπ
t
from time t onwards, i.e., on π(t), we ﬁnd that

depends only on the policy

max
π

E[ eFe(T + 1)]π = max
d1

1
X

x1,a1=0

d1(x1)(a1) max
π(2)

vπ(2)
2

(x1, a1),

(C.80)

Then, using (C.62), we have that

max
π(t)

vπ(t)
t

(ht−1, at−1)

Accepted in Quantum 2021-08-30, click title to verify. Published under CC-BY 4.0.

30

= max

dt

1
X

xt,at=0

dt(ht−1, at−1, xt)(at) max
π(t+1)

vπ(t+1)
t+1

(ht−1, at−1, xt, at)

(C.81)

for all 2 ≤ t ≤ T , ht−1 ∈ {0, 1}2t−3, and at−1 ∈ {0, 1}. By deﬁning the functions

vπ(t)
t

∀ 2 ≤ t ≤ T,

wt := max
π(t)
wT +1 := vπ

T +1

(C.82)

(C.83)

(recall that vπ
reduces to the following:

T +1

does not depend on π; see Remark C.4), we see that the optimization problem

max
π

E[ eFe(T + 1)]π



1
X

= max



x1,a1=0

Tr h

M 1;a1
A1

ρx1
A1

i

w2(x1, a1) : ρx1
A1

≥ 0, Tr[ρx1
A1

] = 1, x1 ∈ {0, 1}






,

(C.84)

where M 1;a1
A1

= |a1iha1| and

wt(ht−1, at−1)



:= max

1
X



xt,at=0

Tr h

i

M t;at
At

ρxt
At

wt+1(ht, at) : ρxt
At

≥ 0, Tr[ρxt
At

] = 1, xt ∈ {0, 1}






for all 2 ≤ t ≤ T , ht−1 ∈ {0, 1}2t−3, and at−1 ∈ {0, 1}, with M t;at
At

= |atihat|.

Now, observe that the objective function in (C.84) can be written as

1
X

x1,a1=0

Tr h

M 1;a1
A1

ρx1
A1

i

w2(x1, a1) =

1
X

Tr









1
X

a1=0

M 1;a1
A1

w2(x1, a1)


 ρx1
A1





x1=0

1
X

x1=0

=

Tr h

fM 1;x1
A1

i

,

ρx1
A1

(C.85)

(C.86)

(C.87)

where in the last line we deﬁned fM t;x1
A1
objective function can be written as

:= P1

a1=0 M t;a1
A1

w2(x1, a1). Similarly, in (C.85), the

1
X

xt,at=0

Tr h

M t;at
At

i

ρxt
At

wt+1(ht, at) =

1
X

xt=0

Tr h

fM t;ht
At

i

,

ρxt
At

where fM t;ht
At

:= P1

at=0 M t;at
At

wt+1(ht, at). Therefore, we have

max
π

E[ eFe(T + 1)]π = max

wt(ht−1, at−1) = max




1
X





x1=0

1
X



xt=0

Tr h

fM 1;x1
A1

ρx1
A1

i : ρx1

A1

≥ 0, Tr[ρx1
A1

] = 1, x1 ∈ {0, 1}






Tr h

fM t;ht
At

ρxt
At

i : ρxt

At

≥ 0, Tr[ρxt
At

] = 1, xt ∈ {0, 1}






,

(C.90)

Accepted in Quantum 2021-08-30, click title to verify. Published under CC-BY 4.0.

31

(C.88)

, (C.89)

for all 2 ≤ t ≤ T , ht−1 ∈ {0, 1}2t−3, and at−1 ∈ {0, 1}. Now, notice that for every time step
the optimization problem is of the form

maximize X
s∈S

Tr[H sρs]

subject to ρs ≥ 0, Tr[ρs] = 1 ∀ s ∈ S,

(C.91)

where S is some ﬁnite set and {H s}s∈S is some set of Hermitian operators. Because the
optimization is with respect to the independent variables {ρs}s∈S, the maximum can be
brought inside the sum, so that the solution to the optimization problem is simply

λmax(H s),

X

s∈S

where we have used to fact that, for every Hermitian operator H,

max
ρ:ρ≥0,Tr[ρ]=1

Tr[Hρ] = λmax(H),

(C.92)

(C.93)

where λmax(H) denotes the largest eigenvalue of H [147]. A state ρ achieving the maximum is
|λmax(H)ihλmax(H)|, where |λmax(H)i is an eigenvector corresponding to the largest eigenvalue
of H. Applying this result to (C.89) and (C.90) leads to the desired result, because

λmax( fM t;ht
At

) = λmax





1
X

at=0

wt+1(ht, at)|atihat|


 = max
at∈{0,1}

wt+1(ht, at).

(C.94)

Note that the optimal action at the tth time step for the history ht ∈ {0, 1}2t−1 is given by
the value at that achieves the maximum in (C.94), which gives us the result in (3.21). This
(cid:4)
completes the proof.

C.5 Proof of Theorem 3.5

Let t ≥ 1, and consider a policy π up to time t. With respect to this policy, the classical-
quantum state of the elementary link is (recall (3.5))

(t) = X

bσπ

e

|htihht| ⊗ eσπ

e

(t; ht).

ht∈{0,1}2t−1

(C.95)

Now, for an arbitrary decision function dt corresponding to the decision at time t, we obtain
the following classical-quantum state of the elementary link at time t + 1:

bσ(π,dt)

e

(t + 1) = X

|ht+1ihht+1| ⊗ eσ(π,dt)

e

(t + 1; ht+1)

ht+1∈{0,1}2t+1

(C.96)

= X

ht∈{0,1}2t−1,
at,xt+1∈{0,1}

|ht, at, xt+1ihht, at, xt+1| ⊗ dt(ht)(at)T xt,at,xt+1

e

(cid:16)

eσπ

e

(t; ht)(cid:17)

.

Accepted in Quantum 2021-08-30, click title to verify. Published under CC-BY 4.0.

(C.97)

32

Then,

where

E[ eFe(t + 1)](π,dt) = Tr h(cid:0)|1ih1|Xt+1 ⊗ ψ(cid:1)

bσ(π,dt)

e

(t + 1)i

= X

1
X

dt(ht)(at)hψ|T xt,at,1

e

(

eσπ

e

(t; ht))|ψi

ht∈{0,1}2t−1

= X

at=0
Tr[N ht

ρht],

ht∈{0,1}2t−1

1
X

N ht :=

hψ|T xt,at,1
e

eσπ
(

e

(t; ht))|ψi |atihat|,

ρht :=

at=0
1
X

at=0

dt(ht)(at)|atihat|.

(C.98)

(C.99)

(C.100)

(C.101)

(C.102)

So we have that

max
dt

E[ eFe(t + 1)](π,dt) = max
{ρht }ht

X

Tr[N ht

ρht],

(C.103)

ht∈{0,1}2t−1

which is an optimization problem of the form in (C.91). The optimal value is therefore equal to
P
ht∈{0,1}2t−1 λmax(N ht), with associated optimal decision function, which we denote by dFR
,
equal to

t

dFR
t

(ht) = arg max
at∈{0,1}

hψ|T xt,at,1
e

(

eσπ

e

(t; ht))|ψi ∀ ht ∈ {0, 1}2t−1.

(C.104)

Now,

at = 0 ⇒ hψ|T xt,0,1

e

(cid:16)

eσπ

e

(t; ht)(cid:17)

|ψi = Pr[He(t) = ht]πxthψ|Ne

(cid:16)
ρe

(cid:16)

Me(t)(ht)(cid:17)(cid:17)

|ψi

at = 1 ⇒ hψ|T xt,1,1

e

(cid:16)

eσπ

e

(t; ht)(cid:17)

|ψi = Pr[He(t) = ht]πpefe(0).

(C.106)

= Pr[He(t) = ht]πxtfe(Me(t)(ht) + 1),

(C.105)

So the task is to determine which of the two quantities, xtfe(Me(t)(ht) + 1) and pefe(0), is
If the elementary link is not active at time t,
higher, where pe is the success probability.
meaning that xt = 0, then requesting a link, i.e., selecting at = 1, gives a higher value than
selecting at = 0 (because the latter leads to a value of zero for the objective function in (C.104)
for all pe > 0). On the other hand, if the elementary link is active at time t, then the task is
to compare fe(Me(t)(ht) + 1) and pefe(0) for every history ht ∈ {0, 1}2t−1. Which of these
two quantities is higher (and thus which action is taken) depends on the success probability
pe ∈ (0, 1), the noise model of the quantum memory, and on the target pure state ψ. We
conclude that the decision function dFR

in (C.104) is given by (3.22), as claimed.

t

C.6 Other ﬁgures of merit

In addition to the ﬁgures of merit deﬁned in Section 3.2, there are two other ﬁgures of merit
of interest that we can consider.

Accepted in Quantum 2021-08-30, click title to verify. Published under CC-BY 4.0.

33

Deﬁnition C.5 (Figures of merit for an elementary link policy). Let G = (V, E) be the graph
corresponding to the elementary links of a quantum network, let e ∈ E, and let t ≥ 1. Given a
policy π for the elementary link corresponding to e, we deﬁne the following ﬁgures of merit for
the policy π.

• The expected waiting time for the elementary link to become active, i.e., E[We(treq)]π,

where

We(treq) :=

∞
X

tXe(t)

t−1
Y

(1 − Xe(j)),

t=treq+1

j=treq+1

(C.107)

and treq ≥ 0 is the time at which the initial request for the elementary link is made. In
particular,

Pr[We(treq) = t]π = Pr[Xe(treq + 1) = 0, . . . , Xe(treq + t) = 1]π.

(C.108)

• The expected success rate of the elementary link, i.e., E[Se(t)]π, where

Se(t) :=

t
X

j=1

Ae(j − 1)Xe(j)

t
X

j=1

Ae(j − 1)

.

(C.109)

The success rate is simply the ratio of the number of successful transmissions when a
request is made to the total number of requests made within time t. We let Ae(0) ≡ 1. (cid:74)

Appendix D Details of the memory-cutoﬀ policy

In this appendix, we go through the details of the memory-cutoﬀ policy. We start by making
the following initial remarks about the deﬁnition of the memory-cutoﬀ policy.

• Observe that for t? = ∞, we can write the decision function d∞
t

form:

d∞
t

(ht) =






0 if Xe(t)(ht) = 1,
1 if Xe(t)(ht) = 0.

in the following simpler

(D.1)

In other words, for the t? = ∞ memory-cutoﬀ policy, it suﬃces to look at the status of
the elementary link at the current time in order to determine the next action.

• We denote the probability distribution of the history random variable He(t) with respect
to the t? memory-cutoﬀ policy by Pr[He(t) = ht]t?, and similarly for the marginal
distributions.

• It is straightforward to see that the following conditional probabilities hold for all t? ∈ N:

Pr[Xe(t + 1) = 1, Me(t + 1) = 0|Xe(t) = 0, Me(t) = −1] = pe,

Accepted in Quantum 2021-08-30, click title to verify. Published under CC-BY 4.0.

(D.2)

34

Pr[Xe(t + 1) = 1, Me(t + 1) = 0|Xe(t) = 1, Me(t) = t?] = pe,
Pr[Xe(t + 1) = 0, Me(t + 1) = −1|Xe(t) = 0, Me(t) = −1] = 1 − pe,
Pr[Xe(t + 1) = 0, Me(t + 1) = −1|Xe(t) = 1, Me(t) = t?] = 1 − pe,
Pr[Xe(t + 1) = 1, Me(t + 1) = m + 1|Xe(t) = 1, Me(t) = m] = 1, 0 ≤ m ≤ t? − 1.

(D.3)

(D.4)

(D.5)

(D.6)

For t? = 0, we only have the transition probabilities in (D.2)–(D.5). Since these transition
probabilities are time independent, and because the pair (Xe(t + 1), Me(t + 1)) depends
only on (Xe(t), Me(t)), we have that ((Xe(t), Me(t)) : t ≥ 1) is a stationary/time-
homogeneous Markov process. As such, the conditional probabilities can be organized
into the transition matrix Te(t?), t? ∈ N0, deﬁned as follows:

(Te(t?)) x,m
x0,m0

:= Pr[Xe(t + 1) = x, Me(t + 1) = m|Xe(t) = x0, Me(t) = m0],

x, x0 ∈ {0, 1}, m, m0 ∈ {−1, 0, 1, . . . , t?},

(D.7)

with the matrix entries corresponding to the conditional probabilities not in (D.2)–(D.6)
being set to zero. It is easy to verify that the results of Theorem 4.4 correspond to the
stationary distribution of the Markov process deﬁned by the transition matrices Te(t?),
t? ∈ N0. In other words, if we let ~p(t?) be a column vector with elements given by

px,m(t?) := lim
t→∞

Pr[Me(t) = m, Xe(t) = x],

(D.8)

for all m ∈ {−1, 0, 1, . . . , t?} and x ∈ {0, 1}, then it is straightforward to show that

Te(t?)~p(t?) = ~p(t?).

(D.9)

For t? = ∞, using (D.1), the transition probabilities in (C.27)–(C.29) can be simpliﬁed
to the following:

Pr[Xe(t + 1) = 0|Xe(t) = 0] = 1 − pe,
Pr[Xe(t + 1) = 1|Xe(t) = 0] = pe,
Pr[Xe(t + 1) = 0|Xe(t) = 1] = 0,
Pr[Xe(t + 1) = 1|Xe(t) = 1] = 1.

(D.10)

(D.11)

(D.12)

(D.13)

These transition probabilities are time independent and Markovian, so they can be or-
ganized into the transition matrix Te(∞) deﬁned as follows:

(Te(∞)) x
x0

:= Pr[Xe(t + 1) = x|Xe(t) = x0],

x, x0 ∈ {0, 1}.

(D.14)

Next, let us consider what the histories ht look like through an particular example. Con-
sider an elementary link for which t? = 3, and let us consider the status of the elementary
link up to time t = 10. Given that each elementary link request succeeds with probability pe
and fails with probability 1 − pe, in Table 1 we write down the probability for each sequence
of elementary link statuses according to the formula in (3.8). Note that we only include those
histories that have non-zero probability (indeed, some sequences ht = (x1, a1, . . . , at−1, xt) ∈

Accepted in Quantum 2021-08-30, click title to verify. Published under CC-BY 4.0.

35

x1

x2

x3

x4

x5

x6

x7

x8

x9

x10

Y t?
e (t)(ht)

Zt?

e (t)(ht)

Pr[He(t) = ht]t? Me(t)(ht)

0

1

0

0

0

0

0

1

1

0

0

0

0

0

1

0

0

0

0

0

1

0

0

0

0

1

0

0

0

1

0

0

1

1

0

1

0

1

1

0

0

0

0

1

1

1

0

0

0

0

1

1

0

0

0

0

1

1

0

0

0

1

1

0

0

1

1

0

1

1

1

1

0

1

1

1

0

0

0

1

1

1

0

0

0

0

1

1

1

0

0

0

1

1

1

0

0

1

1

1

0

1

1

1

1

1

1

1

0

1

1

1

1

0

0

1

1

1

0

0

0

0

1

1

1

1

0

0

1

1

1

1

0

1

1

1

1

1

1

1

1

1

1

1

0

0

1

1

1

1

0

1

0

1

0

0

0

0

0

1

1

1

1

0

0

1

1

1

1

0

1

1

1

0

1

1

1

0

1

1

0

0

0

1

1

1

1

1

1

1

0

0

0

0

0

0

1

1

1

1

0

0

1

1

1

0

0

1

1

0

0

1

1

1

1

1

0

0

0

0

1

1

1

1

1

1

0

0

0

1

0

0

0

1

1

1

0

0

0

1

1

0

0

0

1

1

1

1

1

1

1

1

0

0

0

0

0

1

1

1

1

1

0

0

1

1

0

0

0

0

1

1

0

0

0

0

1

1

1

1

1

1

1

1

1

1

1

1

0

0

0

0

0

0

1

0

1

1

0

1

1

1

0

0

0

0

0

1

1

1

1

1

1

1

1

1

1

1

1

1

0

1

1

1

0

0

0

0

0

0

0

0

0

0

1

1

1

1

1

1

1

1

1

1

1

1

1

1

1

1

1

1

1

1

1

1

1

1

1

1

0

1

1

1

1

1

1

2

2

2

0

0

0

0

1

1

1

1

1

1

1

1

1

1

1

1

1

1

1

1

1

1

2

2

2

2

0

0

0

0

0

0

0

0

0

0

1

2

3

4

1

1

1

1

1

1

2

2

2

2

2

3

3

3

3

4

4

4

1

1

1

2

(1 − pe)10
pe(1 − pe)6
pe(1 − pe)6
pe(1 − pe)6
pe(1 − pe)6
pe(1 − pe)6
pe(1 − pe)6
p2
e(1 − pe)2
e(1 − pe)2
p2
p2
e(1 − pe)2
pe(1 − pe)9
pe(1 − pe)8
pe(1 − pe)7
pe(1 − pe)6
e(1 − pe)5
p2
e(1 − pe)5
p2
p2
e(1 − pe)5
p2
e(1 − pe)5
e(1 − pe)5
p2
e(1 − pe)5
p2
p2
e(1 − pe)4
p2
e(1 − pe)4
e(1 − pe)4
p2
e(1 − pe)4
p2
p2
e(1 − pe)4
p2
e(1 − pe)3
p2
e(1 − pe)3
e(1 − pe)3
p2
p2
e(1 − pe)3
p2
e(1 − pe)2
p2
e(1 − pe)2
e(1 − pe)2
p2
p3
e(1 − pe)
p3
e(1 − pe)
p3
e(1 − pe)
p3
e

−1

−1

−1

−1

−1

−1

−1

−1

−1

−1

0

1

2

3

0

0

0

0

0

0

1

1

1

1

1

2

2

2

2

3

3

3

0

0

0

1

Table 1: Elementary link status sequences (x1, x2, . . . , x10) for an elementary link in a quantum network,
speciﬁed by an edge e of the corresponding graph G, with t? = 3 up to time t = 10. The quantity Y t?
(t) is
e
the number of full blocks of ones in the elementary link status sequence up to time t − 1, and Z t?
(t) is the
e
number of trailing ones in the elementary link status sequence up to time t. Me(t) is the memory time at
time t, given by the formula in (C.35).

Accepted in Quantum 2021-08-30, click title to verify. Published under CC-BY 4.0.

36

{0, 1}2t−1 have zero probability with respect to the memory-cutoﬀ policy). We also include in
the table the memory times Me(t), which are calculated using the formula in (C.35). Since
the memory-cutoﬀ policy is deterministic, it suﬃces to keep track only of the elementary link
statuses (x1, . . . , xt) and not the action values, because the action values are given determin-
istically by the elementary link statuses. For the elementary link status sequences, we deﬁne
two quantities that are helpful for obtaining analytic formulas for the ﬁgures of merit deﬁned
in Section 3.2. The ﬁrst quantity is Y t?
(t), which we deﬁne to be the number of full blocks of
e
ones (having length t? + 1) in elementary link status sequences up to time t − 1. The values
that Y t?
t?+1 c if t? < ∞, and 0 if t? = ∞. We also deﬁne the quantity
e
Zt?
(t) to be the number of trailing ones in elementary link status sequences up to time t. The
e
values that Zt?
(t) can take are 0, 1, . . . , t? + 1 if t? < ∞, and 0, 1, . . . , t if t? = ∞.
e

(t) can take are 0, 1, . . . , b t−1

Using the random variables Y t?
e

(t) and Zt?
e

(t), along with the general formula in (3.8), we

obtain the following formula for the probability of histories with non-zero probability.

Proposition D.1. For every time t ≥ 1, cutoﬀ t? ∈ N0, success probability pe ∈ [0, 1], and
history ht = (x1, a1, x2, a2, . . . , at−1, xt) ∈ {0, 1}2t−1 with non-zero probability,

Pr[He(t) = ht]t? = pY t?

e

e (t)(ht)
+ (cid:16)1 − δZt?

(1 − pe)t−(t?+1)Y t?
(cid:17)

pY t?

e

e (t)(ht)+1

e (t)(ht),0

e (t)(ht)δZt?

e (t)(ht),0
(1 − pe)t−Zt?

e (t)(ht)−(t?+1)Y t?

e (t)(ht),

(D.15)

where Y t?
e
t − 1 in the sequence (x1, x2, . . . , xt) of elementary link statuses, and Zt?
e
be the number of trailing ones in the sequence (x1, x2, . . . , xt). For t? = ∞,

(t)(ht) is deﬁned to be the number of full blocks of ones of length t? + 1 up to time
(t)(ht) is deﬁned to

Pr[He(t) = ht]∞ = (1 − pe)tδZ∞

e (t)(ht),0 + (cid:16)1 − δZ∞

e (t)(ht),0

(cid:17)

pe(1 − pe)t−Z∞

e (t)(ht). (cid:74) (D.16)

(t) = Y t?
e

Proof. The result in (D.15) follows immediately from the formula in (3.8) by observing that
(t). For t? = ∞, we always
N succ
e
e
(t)(ht) = 0 for all
only have trailing ones in the elementary link status sequences, so that Y ∞
(cid:4)
t ≥ 1 and every history ht. The result in (D.16) then follows.

(t) = t − (t? + 1)Y t?
e

(t) + 1 − δZt?

(t) − Zt?
e

and N req

e (t),0

e

Next, let us count the number of elementary link status sequences with non-zero probability.

Using Table 1 as a guide, we obtain the following.

Lemma D.2. For every time t ≥ 1 and every cutoﬀ t? ∈ N0 ∪ {∞}, let Ξ(t; t?) denote the
set of elementary link status sequences for the t? memory-cutoﬀ policy that have non-zero
probability. Then, for t? ∈ N0, the number of elements in the set Ξ(t; t?) is

|Ξ(t; t?)| =

b t−1
t?+1 c
X

t?+1
X

x=0

k=0

where

1t−k−x(t?+1)≥0 =

For t? = ∞, |Ξ(t; ∞)| = 1 + t. (cid:74)

t − 1 − xt?
x

!

δk,0 + (1 − δk,0)

t − k − xt?
x

!

!

1t−k−x(t?+1)≥0

, (D.17)






1 if t − k − x(t? + 1) ≥ 0,
0 otherwise.

(D.18)

Accepted in Quantum 2021-08-30, click title to verify. Published under CC-BY 4.0.

37

  
 
Proof. We start by counting the number of elementary link status sequences when the number
of trailing ones is equal to zero, i.e., when k ≡ Zt?
(t)(ht) = 0. If we also let the number
e
x ≡ Y t?
(t)(ht) of full blocks of ones in time t − 1 be equal to one, then there are t? + 1 ones
e
and t − t? − 2 zeros up to time t − 1. The total number of elementary link status sequences is
then equal to the number of ways that the single block of ones can be moved around in the
elementary link status sequence up to time t − 1. This quantity is equivalent to the number of
permutations of t − 1 − t? objects with t − t? − 2 of them being identical (these are the zeros),
which is given by

(t − 1 − t?)!
(t − 2 − t?)!(t − 1 − t? − t + t? + 2)!

=

(t − 1 − t?)!
(t − t? − 2)!(1)!

=

t − 1 − t?
1

!
.

(D.19)

We thus have the x = 0 and k = 0 term in the sum in (D.17). If we stick to k = 0 but now
consider more than one full block of ones in time t − 1 (i.e., let x ≡ Y t?
(t)(ht) ≥ 1), then the
e
number of elementary link status sequences is given by a similar argument as before: it is
equal to the number of ways of permuting t − 1 − xt? objects, with x of them being identical
(the blocks of ones) and the remaining t − 1 − x(t? + 1) objects also identical (the number of
zeros), i.e., (cid:0)t−1−xt?
(cid:1). The total number of elementary link status sequences with zero trailing
x
ones is therefore

b t−1
t?+1 c
X

x=0

t − 1 − xt?
x

!
.

(D.20)

Let us now consider the case k ≡ Zt?
e

(t)(ht) > 0. Then, the number of time slots in which
full blocks of ones can be shuﬄed around is t − k. If there are x blocks of ones in time t − k,
then by the same arguments as before, the number of such elementary link status sequences is
given by the number of ways of permuting t − k − xt? objects, with x of them being identical
(the full blocks of ones) and the remaining t − k − x(t? + 1) of them also identical (these are
the zeros up to time t − k). In other words, the number of elementary link status sequences
with k > 0 and x ≥ 0 is

!

t − k − xt?
x

1t−k−x(t?+1)≥0.

(D.21)

We must put the indicator function 1t−k−x(t?+1)≥0 in order to ensure that the binomial
coeﬃcient makes sense. This also means that, depending on the time t, not all values of k
between 0 and t? + 1 can be considered in the total number of elementary link status sequences
(simply because it might not be possible to ﬁt all possible values of trailing ones and full blocks
of ones within that amount of time). By combining (D.20) and (D.21), we obtain the desired
result.

In the case t? = ∞, because there are never any full blocks of ones and only trailing ones,
we have t elementary link status sequences, each containing k trailing ones, where 1 ≤ k ≤ t.
We also have an elementary link status sequence consisting of all zeros, giving a total of t + 1
(cid:4)
elementary link status sequences.

Remark D.3. Note that when t? = 0, we get

|Ξ(t; 0)| =

t−1
X

1
X

x=0

k=0

t − 1
x

!

δk,0 + (1 − δk,0)

!

!

1t−k−x≥0

t − k
x

Accepted in Quantum 2021-08-30, click title to verify. Published under CC-BY 4.0.

(D.22)

38

 
 
 
  
 
=

t−1
X

x=0

!

t − 1
x

+

t−1
X

x=0

!

t − 1
x

1t−1−x≥0
}
{z
|
1 ∀x

= 2t−1 + 2t−1
= 2t.

(D.23)

(D.24)

(D.25)

In other words, when t? = 0, all t-bit strings are valid elementary link status sequences.

For t ≤ t? + 1, no full blocks of ones in time t − 1 are possible, so we get

|Ξ(t; t?)| =

t?+1
X

t − 1
0

!

δk,0 + (1 − δk,0)

!

!

1t−k≥0

t − k
0

!

k=0
t − 1
0

=

= 1 + t.

+

t
X

k=1

!

t − k
0

(D.26)

(D.27)

(D.28)

This coincides with the result for t? = ∞, because when t? = ∞ the condition t ≤ t? + 1 is
satisﬁed for all t ≥ 1. (cid:74)

D.1 Proof of Theorem 4.2

We start with the proof of the claimed expressions for Pr[Me(t) = m, Xe(t) = 1]t?. For
t ≤ t? + 1, because no full blocks of ones up to time t − 1 are possible, the possible values
for the memory time are 0, 1, . . . , t − 1. Furthermore, for each value of m ∈ {0, 1, . . . , t − 1},
there is only one elementary link status sequence for which Me(t) = m, and this sequence has
Zt?
e

(t) = m + 1 trailing ones and thus probability pe(1 − pe)t−1−m by Proposition D.1.

For t > t? + 1, the possible values of the memory time are 0, 1, . . . , t?. Consider the number
Y t?
(t) of full blocks of ones in time t − 1 and the number Zt?
(t) of trailing ones in elementary
e
e
link status sequences (x1, x2, . . . , xt) such that xt = 1. Since we must have xt = 1, we require
Zt?
(t) ≥ 1. Now, in order to have a memory time of Me(t) = m ∈ {0, 1, . . . , t?}, we can have
e
elementary link status sequences consisting of any number x = Y t?
(t) of full blocks of ones
e
(t) = m + 1. (Note that at the end of each full block of
ranging from 0 to b t−1
ones the memory time is equal to t?.) The number of such elementary link status sequences is

t?+1 c as long as Zt?

e

t − (m + 1) − xt?
x

!

1t−(m+1)−x(t?+1)≥0,

(D.29)

as given by (D.21), and the probability of each such elementary link status sequence is px+1
pe)t−(m+1)−x(t?+1). By summing with respect to all 0 ≤ x ≤ b t−1
result.

(1−
t?+1 c, we obtain the desired

e

We now prove the claimed expressions for Pr[Me(t) = m, Xe(t) = 0]t?. For ﬁnite t?, when
t ≤ t? + 1, there is only one elementary link status sequence ending with a zero, and that is
the sequence consisting of all zeros, which has probability (1 − pe)t. Furthermore, since the
value of the memory for this sequence is equal to −1, only the case Me(t) = −1 has non-zero

Accepted in Quantum 2021-08-30, click title to verify. Published under CC-BY 4.0.

39

 
 
  
 
 
 
 
probability. When t > t? + 1, we can again have non-zero probability only for Me(t) = −1. In
this case, because every elementary link status sequence has to end with a zero, we must have
Zt?
e

(t) = 0. Therefore, using (D.15), along with (D.20), we obtain the desired result.

For t? = ∞, only the elementary link status sequence consisting of all zeros ends with a

zero, and in this case we have Me(t) = −1. The result then follows.

D.2 Proof of Theorem 4.4

We start by proving (4.12). Since we consider the limit t → ∞, it suﬃces to consider the
expression for Pr[Xe(t) = 1]t? in (4.9) for t > t? + 1. Also due to the t → ∞ limit, we can
disregard the indicator function in (4.9), so that

lim
t→∞

E[Xe(t)]t? = lim
t→∞

b t−1
t?+1 c
X

t?+1
X

x=0

k=1

t − k − xt?
x

!

px+1
e

(1 − pe)t−k−(t?+1)x.

(D.30)

Next, consider the binomial expansion of (1 − pe)t−k−(t?+1)x:

(1 − pe)t−k−(t?+1)x =

∞
X

j=0

t − k − (t? + 1)x
j

!

(−1)jpj
e.

(D.31)

Substituting this into (D.30) gives us

lim
t→∞

E[Xe(t)]t? = pe lim
t→∞

∞
X

t?+1
X

x,j=0

k=1

∞
X

‘
X

t?+1
X

t − k − t?x
x

! 

t − k − (t? + 1)x
j

!

(−1)jpx+j

e

(D.32)

! 

t − k − t?j
j

t − k − (t? + 1)j
‘ − j

!

(−1)‘−jp‘
e.

(D.33)

= pe lim
t→∞

‘=0
Now, for brevity, let a ≡ t − k, and let us focus on the sum

k=1

j=0

‘
X

(−1)‘−j

j=0

a − t?j
j

! 

a − t?j − j
‘ − j

!
.

We start by expanding the binomial coeﬃcients to get

a − t?j
j

! 

a − t?j − j
‘ − j

!

=

=

=

(a − t?j)!
j!(‘ − j)!(a − t?j − ‘)!

‘−1
Y

s=0

1
j!(‘ − j)!
! ‘−1
Y

1
‘!

‘
j

s=0

(a − t?j − s)

(a − t?j − s).

Next, we have

‘−1
Y

(a − t?j − s) =

s=0

‘
X

(−1)‘−n

n=0





‘

n


 (a − t?j)n,

Accepted in Quantum 2021-08-30, click title to verify. Published under CC-BY 4.0.

(D.34)

(D.35)

(D.36)

(D.37)

(D.38)

40

 
 
 
 
 
 
 
where





‘

n


 is the (unsigned) Stirling number of the ﬁrst kind1. Performing the binomial

expansion of (a − t?j)n, the sum in (D.34) becomes

(D.39)

(D.40)




i






‘


= 0,

‘
X

‘
X

n
X

(−1)‘−j

j=0

n=0

i=0

1
‘!

‘
j

! 


‘

n





n
i

!

(−1)i(t?)ijian−i.

Now, it holds that

‘
X

(−1)‘−j

j=0

1
‘!

‘
j

!

ji = (−1)2‘




i




‘




,




i




‘





‘

where




and



‘



is the Stirling number of the second kind2. For i < ‘, it holds that

= 1. Since i ranges from 0 to n, and n itself ranges from 0 to ‘, the sum in (D.40)

is zero except for when i = ‘. The sum in (D.40) is therefore eﬀectively equal to (−1)2‘δi,‘.
Substituting this into (D.39) leads to

‘
X

n
X

n=0

i=0

(−1)2‘δi,‘





‘

n





n
i

!

(−1)i(t?)ian−i = (−1)‘(t?)‘,

(D.41)

where we have used the fact that


 = 1. Altogether, we have shown that


‘

‘

‘
X

(−1)‘−j

j=0

a − t?j
j

! 

!

a − t?j − j
‘ − j

= (−1)‘(t?)‘

(D.42)

for all ‘ ≥ 0. The sum is independent of a = t − k. Substituting this result into (D.33), and
using the fact that

∞
X

‘=0

(−1)‘x‘ =

1
1 + x

,

x 6= −1,

(D.43)

we get

lim
t→∞

E[Xe(t)]t? = pe

∞
X

t?+1
X

(−1)‘(t?pe)‘ = pe(t? + 1)

‘=0

k=1

∞
X

‘=0

(−1)‘(t?pe)‘ =

(t? + 1)pe
1 + t?pe

,

(D.44)

as required.

The proof of (4.10) is very similar to the proof of (4.12). Using the result of Theorem 4.2,

in the limit t → ∞ we have

1This number is deﬁned to be the number of permutations of ‘ elements with n disjoint cycles.

2This number is deﬁned to be the number of ways to partition a set of i objects into ‘ non-empty subsets.

Accepted in Quantum 2021-08-30, click title to verify. Published under CC-BY 4.0.

41

 
 
 
 
 
lim
t→∞

Pr[Me(t) = m, Xe(t) = 1]t?
∞
X

= (1 − δm,−1) lim
t→∞

x=0

t − (m + 1) − xt?
x

!

px+1
e

(1 − pe)t−(m+1)−x(t?+1).

(D.45)

Using the binomial expansion of (1 − pe)t−(m+1)−x(t?+1), exactly as in the proof of (4.12), we
can write

lim
t→∞

Pr[Me(t) = m, Xe(t) = 1]t?

= (1 − δm,−1) lim
t→∞

= (1 − δm,−1) lim
t→∞

∞
X

∞
X

x=0

j=0

pe

∞
X

‘
X

‘=0

j=0

pe

Then, using (D.42), we have that

t − (m + 1) − xt?
x

! 

t − (m + 1) − (t? + 1)x
j

!

(−1)jpx+j

e

(D.46)

t − (m + 1) − jt?
j

! 

t − (m + 1) − (t? + 1)j
‘ − j

!

(−1)‘−jp‘
e.

(D.47)

‘
X

(−1)‘−j

j=0

t − (m + 1) − jt?
j

! 

t − (m + 1) − (t? + 1)j
‘ − j

!

= (−1)‘(t?)‘

(D.48)

for all t ≥ 1 and all m ∈ {0, 1, . . . , t?}. Finally, using (D.43), we obtain

lim
t→∞

Pr[Me(t) = m, Xe(t) = 1]t? = pe

∞
X

‘=0

(−1)‘(t?pe)‘ =

pe
1 + t?pe

,

(D.49)

as required. The proof of (4.11) is similar.

D.3 Other ﬁgures of merit

We now consider the ﬁgures of merit deﬁned in Section C.6 in the context of the memory-cutoﬀ
policy.

D.3.1 Waiting time

Let us consider the expected waiting time for an elementary link in a quantum network un-
dergoing the memory-cutoﬀ policy.

Theorem D.4. Consider an edge e ∈ E in the graph G = (V, E) corresponding to the
elementary links of a quantum network, and let pe ∈ [0, 1] be the success probability for the
elementary link corresponding to e. For every cutoﬀ t? ∈ N0 and every request time treq ≥ 0,
the expected waiting time for the elementary link is

E[We(treq)]t? =

Pr[Me(treq + 1) = −1, Xe(treq + 1) = 0]t?
pe(1 − pe)

.

Accepted in Quantum 2021-08-30, click title to verify. Published under CC-BY 4.0.

(D.50)

42

 
 
 
 
For t? = ∞,

E[We(treq)]∞ =

Pr[Xe(treq + 1) = 0]∞
pe(1 − pe)

=

(1 − pe)treq
pe

. (cid:74)

(D.51)

As a check, let us observe the following:

• If treq = 0, then because Pr[Me(1) = −1, Xe(1) = 0]t? = 1 − pe for all t? ∈ N0 (see
, as expected. We get the same result for

Theorem 4.2), we obtain E[We(0)]t? = 1
pe
t? = ∞.

• If t? = 0, then we get Pr[Me(treq + 1) = −1, Xe(treq + 1) = 0]0 = 1 − pe for all treq ≥ 0
(see Theorem 4.2), which means that E[We(treq)]0 = 1
for all treq ≥ 0. This makes
pe
sense, because in the t? = 0 memory-cutoﬀ policy the quantum state of the elementary
link is never held in memory.

Proof. Using (C.108), we have

Pr[We(treq) = t]t? = Pr[Xe(treq + 1) = 0, . . . , Xe(treq + t) = 1]t?

t?
X

=

m1,...,mt=0

Pr[Xe(treq + 1) = 0, Me(treq + 1) = m1, . . . ,

Using the transition matrix Te(t?) deﬁned in (D.7), we obtain

Xe(treq + t) = 1, Me(treq + t) = mt]t?.

(D.52)

Pr[We(treq) = t]t?

t?
X

=

m1,...,mt=0

(Te(t?)) 1,mt
0,mt−1
× Pr[Me(treq + 1) = m1, Xe(treq + 1) = 0]t?.

· · · (Te(t?))0,m3
0,m2

(Te(t?))0,m2
0,m1

(D.53)

Using (4.7), along with (D.2)–(D.7), we have that

Pr[We(treq) = t]t? = Pr[Me(treq + 1) = −1, Xe(treq + 1) = 0]t?pe(1 − pe)t−2,

(D.54)

for all t ≥ 1. The result then follows.

For t? = ∞, using the transition matrix Te(∞) deﬁned in (D.14) leads to

Pr[Xe(treq + 1) = 0, . . . , Xe(treq + t) = 1]∞

= (Te(∞))1
0

(Te(∞))0
0

· · · (Te(∞))0
0

Pr[Xe(treq + 1) = 0]∞.

(D.55)

Then, from (4.9), we have that Pr[Xe(treq + 1) = 0] = (1 − pe)treq+1, so that

Pr[We(treq) = t]∞ = pe(1 − pe)t−2(1 − pe)treq+1

(D.56)

for all t ≥ 1. The result then follows.

Accepted in Quantum 2021-08-30, click title to verify. Published under CC-BY 4.0.

(cid:4)

43

Figure 4: The expected waiting time for an elementary link, given by (D.50), as a function of the request
time treq. We let the success probability for the elementary link be pe = 0.3, and we take various values for
the cutoﬀ t?.

In the limit treq → ∞, we obtain using (4.11),

lim
treq→∞

E[We(treq)]t? =

1
pe(1 + t?pe) ,

t? ∈ N0.

(D.57)

See Figure 4 for plots of the expected waiting time, given by (D.50), as a function of the
request time treq for various values of t?. As long as t? is strictly greater than zero, the waiting
, despite the oscillatory behavior for small values of treq. In the
time is strictly less than 1
pe
limit treq → ∞, we see that the waiting time is monotonically decreasing with increasing t?,
which is also apparent from (D.57).

D.3.2 Success rate

Let us now consider the expected success rate for an elementary link undergoing the memory-
cutoﬀ policy.

Theorem D.5. Consider an edge e ∈ E in the graph G = (V, E) corresponding to the
elementary links of a quantum network, and let pe ∈ [0, 1] be the success probability for the
elementary link corresponding to e. For every cutoﬀ t? ∈ N0 ∪ {∞} and every time t ≥ 1, the
expected success rate for the elementary link is

E[Se(t)]t? =

t−1
X

j=0

1
j + 1 pe(1 − pe)j,

t ≤ t? + 1.

(D.58)

For t > t? + 1,

E[Se(t)]t? =

b t−1
t?+1 c
X

x=0

x
t − t?x

t − 1 − xt?
x

!

px
e

(1 − pe)t−(t?+1)x

t?+1
X

+

k=1

x + 1
t − k − t?x + 1

t − k − xt?
x

!

px+1
e

(1 − pe)t−k−(t?+1)x1t−k−(t?+1)x≥0

!

. (cid:74) (D.59)

Accepted in Quantum 2021-08-30, click title to verify. Published under CC-BY 4.0.

44

0100200300treq0123E[We(treq)]t?pe=0.3,t?=0pe=0.3,t?=5pe=0.3,t?=10pe=0.3,t?=15 
 
 
Proof. We start with the observation that, for every history ht, the number of successful
requests can be written in terms of the number Y t?
(t)(ht) of blocks of ones of length t? + 1 and
e
the number Zt?
(t)(ht) of trailing ones in the elementary link status sequence corresponding to
e
ht as

Y t?
e

(t)(ht) + 1 − δZt?

e (t)(ht),0.

Similarly, the total number of failed requests is

t − Zt?
e

(t)(ht) − (t? + 1)Y t?
e

(t)(ht).

Therefore,

Se(t)(ht) =

=

t − Zt?
e

(t)(ht) − (t? + 1)Y t?
e

Y t?
e

(t)(ht) + 1 − δZt?
(t)(ht) + Y t?
e

e (t)(ht),0

(t)(ht) + 1 − δZt?

e (t)(ht),0

Y t?
e

(t)(ht) + 1 − δZt?

e (t)(ht),0

t − Zt?
e

(t)(ht) − t?Y t?
e

(t)(ht) + 1 − δZt?

e (t)(ht),0

.

(D.60)

(D.61)

(D.62)

(D.63)

Now, for t ≤ t? + 1, we always have Y t?
(t)(ht) = 0 for every history ht, and the elementary
e
link status sequence can consist only of a positive number of trailing ones not exceeding t.
Thus, from Proposition D.1, the probability of any such history is pe(1 − pe)t−Zt?
e (t)(ht). Using
(D.63) then leads to

E[Se(t)]t? = X

Se(t)(ht) Pr[He(t) = ht]t?

ht∈{0,1}2t−1

=

=

t
X

k=1
t−1
X

j=0

1

t − k + 1 pe(1 − pe)t−k
1
j + 1 pe(1 − pe)j

(D.64)

(D.65)

(D.66)

for t ≤ t? + 1, as required, where the last equality follows by a change of summation variable.

For t > t? + 1, we use (D.63) again, keeping in mind this time that the number of trailing

ones can be equal to zero, to get
E[Se(t)]t? = X

Se(t)(ht) Pr[He(t) = ht]t?

ht∈{0,1}2t−1

= X
ht:Zt?

e (t)(ht)=0

Se(t)(ht) Pr[He(t) = ht]t?

(D.67)

+ X
ht:Zt?

e (t)(ht)≥1

Se(t)(ht) Pr[He(t) = ht]t?

(D.68)

b t−1
t?+1 c
X

(cid:18) x

=

t − t?x

x=0
t?+1
X

+

k=1

Pr[He(t) = ht : Y t?
e

(t)(ht) = x, Zt?
e

(t)(ht) = 0]t?

x + 1
t − k − t?x + 1

Pr[He(t) = ht : Y t?
e

(t)(ht) = x, Zt?
e

(t)(ht) = k]t?

Using Proposition D.1, we arrive at the desired result.

Accepted in Quantum 2021-08-30, click title to verify. Published under CC-BY 4.0.

!

. (D.69)

(cid:4)

45

Figure 5: The expected success rate, as given by the expressions in Theorem D.5, for an elementary link
with success probability pe = 0.3 undergoing various memory-cutoﬀ policies.

See Figure 5 for a plot of the expected success rate E[Se(t)]t? as a function of time for
various values of the cutoﬀ t?. We ﬁnd that the rate has essentially the shape of a decaying
square wave, which is clearer for larger values of the cutoﬀ. In particular, the “plateaus” in the
curves have a period of t? + 1 time steps. Consider the values of these pleateaus. The largest
plateau can be found by considering the case t? = ∞, because in this case the condition
t ≤ t? + 1 is satisﬁed for all t ≥ 1, and it is when this condition is true that the largest
plateau occurs. Using Theorem D.5 with t? = ∞, we ﬁnd that the value of the largest plateau
approaches

lim
t→∞

E[Se(t)]∞ = lim
t→∞

t−1
X

j=0

1
j + 1 pe(1 − pe)j = −

pe ln pe
1 − pe

,

(D.70)

for all pe ∈ (0, 1). In the case t? ∈ N0, as we see in Figure 5, there are multiple plateaus, with
each plateau lasting for a period of t? + 1 time steps, as mentioned earlier. The values of these
pleateaus depend on the number x ≥ 0 of full blocks of ones in the elementary link status
sequence (see Appendix D for details). Speciﬁcally, the values of the plateaus approach

t−(t?+1)x
X

lim
t→∞

x + 1
t − k − t?x + 1

k=1

t−1
X

j=(t?+1)x

= lim
t→∞

x + 1
j − t?x + 1

j − t?x
x

px+1
e

!

t − k − t?x
x
!

px+1
e

(1 − pe)t−k−(t?+1)x

(1 − pe)j−(t?+1)x = pe · 2F1(1, 1, 2 + x, 1 − pe),

(D.71)

for all x ≥ 0, where 2F1(a, b, c, z) is the hypergeometric function. Then, using the fact that
limx→∞ 2F1(1, 1, 2 + x, 1 − pe) = 1 [148], we conclude that the plateaus approach the value of
pe, i.e.,

lim
t→∞

E[Se(t)]t? = pe,

t? ∈ N0.

(D.72)

Accepted in Quantum 2021-08-30, click title to verify. Published under CC-BY 4.0.

46

02004006008001000t0.20.30.40.5E[Se(t)]t?pe=0.3,t?=25pe=0.3,t?=50pe=0.3,t?=75 
 
References

[1] H. J. Kimble, “The quantum internet”, Nature 453 (2008).
[2] C. Simon, “Towards a global quantum network”, Nature Photonics 11, 678 (2017).
[3] D. Castelvecchi, “The quantum internet has arrived (and it hasn’t)”, Nature 554, 289

(2018).

[4] S. Wehner, D. Elkouss, and R. Hanson, “Quantum internet: a vision for the road ahead”,

Science 362 (2018).

[5] J. Dowling, Schrödinger’s Web: Race to Build the Quantum Internet (Taylor & Francis,

Boca Raton, 2020).

[6] C. H. Bennett, G. Brassard, C. Crépeau, R. Jozsa, A. Peres, and W. K. Wootters,
“Teleporting an unknown quantum state via dual classical and Einstein-Podolsky-Rosen
channels”, Physical Review Letters 70, 1895 (1993).

[7] L. Vaidman, “Teleportation of quantum states”, Physical Review A 49, 1473 (1994).
[8] S. L. Braunstein, C. A. Fuchs, and H. J. Kimble, “Criteria for continuous-variable

quantum teleportation”, Journal of Modern Optics 47, 267 (2000).

[9] C. H. Bennett and G. Brassard, “Quantum cryptography: public key distribution and
coin tossing”, in International Conference on Computer System and Signal Processing,
IEEE (1984), pp. 175–179.

[10] A. K. Ekert, “Quantum cryptography based on Bell’s theorem”, Physical Review Letters

67, 661 (1991).

[11] N. Gisin, G. Ribordy, W. Tittel, and H. Zbinden, “Quantum cryptography”, Reviews

of Modern Physics 74, 145 (2002).

[12] V. Scarani, H. Bechmann-Pasquinucci, N. J. Cerf, M. Dušek, N. Lütkenhaus, and M.
Peev, “The security of practical quantum key distribution”, Reviews of Modern Physics
81, 1301 (2009).

[13] R. Jozsa, D. S. Abrams, J. P. Dowling, and C. P. Williams, “Quantum clock syn-
chronization based on shared prior entanglement”, Physical Review Letters 85, 2010
(2000).

[14] J. Preskill, “Quantum clock synchronization and quantum error correction”, arXiv:quant-

ph/0010098 (2000).

[15] U. Yurtsever and J. P. Dowling, “Lorentz-invariant look at quantum clock-
synchronization protocols based on distributed entanglement”, Physical Review A
65, 052317 (2002).

[16] E. O. Ilo-Okeke, L. Tessler, J. P. Dowling, and T. Byrnes, “Remote quantum clock
synchronization without synchronized clocks”, npj Quantum Information 4, 40 (2018).
[17] J. I. Cirac, A. K. Ekert, S. F. Huelga, and C. Macchiavello, “Distributed quantum

computation over noisy channels”, Physical Review A 59, 4249 (1999).

[18] P. Kómár, E. M. Kessler, M. Bishof, L. Jiang, A. S. Sørensen, J. Ye, and M. D. Lukin,

“A quantum network of clocks”, Nature Physics 10, 582 (2014).

Accepted in Quantum 2021-08-30, click title to verify. Published under CC-BY 4.0.

47

[19] C. L. Degen, F. Reinhard, and P. Cappellaro, “Quantum sensing”, Reviews of Modern

Physics 89, 035002 (2017).

[20] Q. Zhuang, Z. Zhang, and J. H. Shapiro, “Distributed quantum sensing using continuous-

variable multipartite entanglement”, Physical Review A 97, 032329 (2018).

[21] Z. Eldredge, M. Foss-Feig, J. A. Gross, S. L. Rolston, and A. V. Gorshkov, “Optimal
and secure measurement protocols for quantum sensor networks”, Physical Review A
97, 042337 (2018).

[22] T. J. Proctor, P. A. Knott, and J. A. Dunningham, “Multiparameter estimation in

networked quantum sensors”, Physical Review Letters 120, 080501 (2018).

[23] Y. Xia, Q. Zhuang, W. Clark, and Z. Zhang, “Repeater-enhanced distributed quantum
sensing based on continuous-variable multipartite entanglement”, Physical Review A
99, 012328 (2019).

[24] D. L. Moehring, P. Maunz, S. Olmschenk, K. C. Younge, D. N. Matsukevich, L.-M.
Duan, and C. Monroe, “Entanglement of single-atom quantum bits at a distance”,
Nature 449, 68 (2007).

[25] P. Maunz, S. Olmschenk, D. Hayes, D. N. Matsukevich, L.-M. Duan, and C. Monroe,
“Heralded quantum gate between remote quantum memories”, Physical Review Letters
102, 250502 (2009).

[26] M. Peev, C. Pacher, R. Alléaume, C. Barreiro, et al., “The SECOQC quantum key

distribution network in Vienna”, New Journal of Physics 11, 075001 (2009).

[27] T.-Y. Chen, J. Wang, H. Liang, W.-Y. Liu, et al., “Metropolitan all-pass and inter-city

quantum communication network”, Optics Express 18, 27217 (2010).

[28] A. Mirza and F. Petruccione, “Realizing long-term quantum cryptography”, Journal of

the Optical Society of America B 27, A185 (2010).

[29] D. Stucki, M. Legré, F. Buntschu, B. Clausen, et al., “Long-term performance of the
SwissQuantum quantum key distribution network in a ﬁeld environment”, New Journal
of Physics 13, 123001 (2011).

[30] M. Sasaki, M. Fujiwara, H. Ishizuka, W. Klaus, et al., “Field test of quantum key

distribution in the Tokyo QKD Network”, Optics Express 19, 10387 (2011).

[31] S. Ritter, C. Nölleke, C. Hahn, A. Reiserer, et al., “An elementary quantum network of

single atoms in optical cavities”, Nature 484, 195 (2012).

[32] J. Hofmann, M. Krug, N. Ortegel, L. Gérard, M. Weber, W. Rosenfeld, and H. Weinfurter,
“Heralded Entanglement Between Widely Separated Atoms”, Science 337, 72 (2012).
[33] H. Bernien, B. Hensen, W. Pfaﬀ, G. Koolstra, M. S. Blok, L. Robledo, T. H. Taminiau,
M. Markham, D. J. Twitchen, L. Childress, and R. Hanson, “Heralded entanglement
between solid-state qubits separated by three metres”, Nature 497, 86 (2013).
[34] S. Wang, W. Chen, Z.-Q. Yin, H.-W. Li, et al., “Field and long-term demonstration of
a wide area quantum key distribution network”, Optics Express 22, 21739 (2014).
[35] A. Delteil, Z. Sun, W.-b. Gao, E. Togan, S. Faelt, and A. Imamoˇglu, “Generation of

heralded entanglement between distant hole spins”, Nature Physics 12, 218 (2016).

Accepted in Quantum 2021-08-30, click title to verify. Published under CC-BY 4.0.

48

[36] R. Stockill, M. J. Stanley, L. Huthmacher, E. Clarke, M. Hugues, A. J. Miller, C.
Matthiesen, C. Le Gall, and M. Atatüre, “Phase-tuned entangled state generation
between distant spin qubits”, Physical Review Letters 119, 010503 (2017).

[37] N. Kalb, A. A. Reiserer, P. C. Humphreys, J. J. W. Bakermans, et al., “Entanglement
distillation between solid-state quantum network nodes”, Science 356, 928 (2017).
[38] J. Yin, Y. Cao, Y.-H. Li, S.-K. Liao, L. Zhang, J.-G. Ren, W.-Q. Cai, W.-Y. Liu, B. Li,
H. Dai, G.-B. Li, Q.-M. Lu, Y.-H. Gong, Y. Xu, S.-L. Li, F.-Z. Li, Y.-Y. Yin, Z.-Q.
Jiang, M. Li, J.-J. Jia, G. Ren, D. He, Y.-L. Zhou, X.-X. Zhang, N. Wang, X. Chang,
Z.-C. Zhu, N.-L. Liu, Y.-A. Chen, C.-Y. Lu, R. Shu, C.-Z. Peng, J.-Y. Wang, and
J.-W. Pan, “Satellite-based entanglement distribution over 1200 kilometers”, Science
356, 1140 (2017).

[39] P. C. Humphreys, N. Kalb, J. P. J. Morits, R. N. Schouten, R. F. L. Vermeulen, D. J.
Twitchen, M. Markham, and R. Hanson, “Deterministic delivery of remote entanglement
on a quantum network”, Nature 558, 268 (2018).

[40] D. Bunandar, A. Lentine, C. Lee, H. Cai, et al., “Metropolitan quantum key distribution

with silicon photonics”, Physical Review X 8, 021009 (2018).

[41] Q. Zhang, F. Xu, Y.-A. Chen, C.-Z. Peng, and J.-W. Pan, “Large scale quantum key

distribution: challenges and solutions”, Optics Express 26, 24260 (2018).

[42] L. J. Stephenson, D. P. Nadlinger, B. C. Nichol, S. An, P. Drmota, T. G. Ballance,
K. Thirumalai, J. F. Goodwin, D. M. Lucas, and C. J. Ballance, “High-rate, high-ﬁdelity
entanglement of qubits across an elementary quantum network”, Physical Review Letters
124, 110501 (2020).

[43] M. Pompili, S. L. N. Hermans, S. Baier, H. K. C. Beukers, P. C. Humphreys, R. N.
Schouten, R. F. L. Vermeulen, M. J. Tiggelman, L. dos Santos Martins, B. Dirkse,
S. Wehner, and R. Hanson, “Realization of a multi-node quantum network of remote
solid-state qubits”, arXiv:2102.04471 (2021).

[44] L. O. Mailloux, J. D. Morris, M. R. Grimaila, D. D. Hodson, D. R. Jacques, J. M.
Colombi, C. V. Mclaughlin, and J. A. Holes, “A Modeling Framework for Studying
Quantum Key Distribution System Implementation Nonidealities”, IEEE Access 3, 110
(2015).

[45] A. Dahlberg and S. Wehner, “SimulaQron—a simulator for developing quantum internet

software”, Quantum Science and Technology 4, 015001 (2018).

[46] B. Bartlett, “A distributed simulation framework for quantum networks and channels”,

arXiv:1808.07047 (2018).

[47] T. Matsuo, “Simulation of a Dynamic, RuleSet-based Quantum Network”,

arXiv:1908.10758 (2019).

[48] S. DiAdamo, J. Nötzel, B. Zanger, and M. M. Beşe, “QuNetSim: A Software Framework

for Quantum Networks”, arXiv:2003.06397 (2020).

[49] X. Wu, A. Kolar, J. Chung, D. Jin, T. Zhong, R. Kettimuthu, and M. Suchara,
“SeQUeNCe: A Customizable Discrete-Event Simulator of Quantum Networks”,
arXiv:2009.12000 (2020).

Accepted in Quantum 2021-08-30, click title to verify. Published under CC-BY 4.0.

49

[50] T. Coopmans, R. Knegjens, A. Dahlberg, D. Maier, L. Nijsten, J. Oliveira, M. Papen-
drecht, J. Rabbie, F. Rozpędek, M. Skrzypczyk, L. Wubben, W. de Jong, D. Podareanu,
A. T. Knoop, D. Elkouss, and S. Wehner, “NetSquid, a NETwork Simulator for QUantum
Information using Discrete events”, Communications Physics 4, 164 (2021).

[51] M. L. Puterman, Markov Decision Processes: Discrete Stochastic Dynamic Programming,

Wiley Series in Probability and Statistics (Wiley, 2014).

[52] R. S. Sutton and A. G. Barto, Reinforcement Learning: An Introduction, 2nd ed. (MIT

Press, 2018).

[53] S. Russell and P. Norvig, Artiﬁcial Intelligence: A Modern Approach, 3rd ed. (Pearson,

2009).

[54] J. Wallnöfer, A. A. Melnikov, W. Dür, and H. J. Briegel, “Machine Learning for

Long-Distance Quantum Communication”, PRX Quantum 1, 010301 (2020).

[55] L. Jiang, J. M. Taylor, N. Khaneja, and M. D. Lukin, “Optimal approach to quantum
communication using dynamic programming”, Proceedings of the National Academy of
Sciences 104, 17291 (2007).

[56] E. Schoute, L. Mancinska, T. Islam, I. Kerenidis, and S. Wehner, “Shortcuts to quantum

network routing”, arXiv:1610.05238 (2016).

[57] K. Chakraborty, F. Rozpędek, A. Dahlberg, and S. Wehner, “Distributed routing in a

quantum internet”, arXiv:1907.11630 (2019).

[58] O. A. Collins, S. D. Jenkins, A. Kuzmich, and T. A. B. Kennedy, “Multiplexed memory-

insensitive quantum repeaters”, Physical Review Letters 98, 060502 (2007).

[59] C. Simon, H. de Riedmatten, M. Afzelius, N. Sangouard, H. Zbinden, and N. Gisin,
“Quantum repeaters with photon pair sources and multimode memories”, Physical
Review Letters 98, 190503 (2007).

[60] N. Sangouard, C. Simon, J. Minář, H. Zbinden, H. de Riedmatten, and N. Gisin,
“Long-distance entanglement distribution with single-photon sources”, Physical Review
A 76, 050301 (2007).

[61] N. K. Bernardes, L. Praxmeyer, and P. van Loock, “Rate analysis for a hybrid quantum

repeater”, Physical Review A 83, 012323 (2011).

[62] C. Jones, D. Kim, M. T. Rakher, P. G. Kwiat, and T. D. Ladd, “Design and analysis of
communication protocols for quantum repeater networks”, New Journal of Physics 18,
083015 (2016).

[63] S. B. van Dam, P. C. Humphreys, F. Rozpędek, S. Wehner, and R. Hanson, “Multiplexed
entanglement generation over quantum networks using multi-qubit nodes”, Quantum
Science and Technology 2, 034002 (2017).

[64] F. Rozpędek, R. Yehia, K. Goodenough, M. Ruf, P. C. Humphreys, R. Hanson, S.
Wehner, and D. Elkouss, “Near-term quantum-repeater experiments with nitrogen-
vacancy centers: overcoming the limitations of direct transmission”, Physical Review A
99, 052330 (2019).

[65] E. Shchukin, F. Schmidt, and P. van Loock, “Waiting time in quantum repeaters with
probabilistic entanglement swapping”, Physical Review A 100, 032322 (2019).

Accepted in Quantum 2021-08-30, click title to verify. Published under CC-BY 4.0.

50

[66] S. Khatri, C. T. Matyas, A. U. Siddiqui, and J. P. Dowling, “Practical ﬁgures of merit
and thresholds for entanglement distribution in quantum networks”, Physical Review
Research 1, 023032 (2019).

[67] S. Santra, L. Jiang, and V. S. Malinovsky, “Quantum repeater architecture with
hierarchically optimized memory buﬀer times”, Quantum Science and Technology 4,
025010 (2019).

[68] B. Li, T. Coopmans, and D. Elkouss, “Eﬃcient optimization of cut-oﬀs in quantum

repeater chains”, arXiv:2005.04946 (2020).

[69] K. Azuma, K. Tamaki, and H.-K. Lo, “All-photonic quantum repeaters”, Nature

Communications 6 (2015).

[70] K. Boone, J.-P. Bourgoin, E. Meyer-Scott, K. Heshami, T. Jennewein, and C. Simon,
“Entanglement over global distances via quantum repeaters with satellite links”, Physical
Review A 91, 052325 (2015).

[71] S. Khatri, A. J. Brady, R. A. Desporte, M. P. Bart, and J. P. Dowling, “Spooky action
at a global distance: analysis of space-based entanglement distribution for the quantum
internet”, npj Quantum Information 7, 4 (2021).

[72] C. Liorni, H. Kampermann, and D. Bruß, “Quantum repeaters in space”, New Journal

of Physics 23, 053021 (2021).

[73] M. Gündoˇgan, J. S. Sidhu, V. Henderson, L. Mazzarella, J. Wolters, D. K. Oi, and
M. Krutzik, “Space-borne quantum memories for global quantum communication”,
arXiv:2006.10636 (2020).

[74] M. Polnik, L. Mazzarella, M. Di Carlo, D. K. Oi, A. Riccardi, and A. Arulselvan,
“Scheduling of space to ground quantum key distribution”, EPJ Quantum Technology
7, 3 (2020).

[75] S. Khatri, “Towards a General Framework for Practical Quantum Network Protocols”,
https://digitalcommons.lsu.edu/gradschool_dissertations/5456/, PhD thesis (Louisiana
State University, 2021).

[76] L. Aparicio, R. Van Meter, and H. Esaki, “Protocol Design for Quantum Repeater
Networks”, in Proceedings of the 7th Asian Internet Engineering Conference, AINTEC
’11 (2011), pp. 73–80.

[77] R. V. Meter and J. Touch, “Designing quantum repeater networks”, IEEE Communica-

tions Magazine 51, 64 (2013).

[78] A. Pirker, J. Wallnöfer, and W. Dür, “Modular architectures for quantum networks”,

New Journal of Physics 20, 053054 (2018).

[79] A. Pirker and W. Dür, “A quantum network stack and protocols for reliable

entanglement-based networks”, New Journal of Physics 21, 033003 (2019).

[80] G. Vardoyan, S. Guha, P. Nain, and D. Towsley, “On the exact analysis of an idealized

quantum switch”, Performance Evaluation 144, 102141 (2020).

[81] P. Nain, G. Vardoyan, S. Guha, and D. Towsley, “On the analysis of a multipartite
entanglement distribution switch”, Proc. ACM Meas. Anal. Comput. Syst. 4 (2020).

Accepted in Quantum 2021-08-30, click title to verify. Published under CC-BY 4.0.

51

[82] G. Vardoyan, S. Guha, P. Nain, and D. Towsley, “On the Stochastic Analysis of a Quan-
tum Entanglement Distribution Switch”, IEEE Transactions on Quantum Engineering
2, 1 (2021), arXiv:1903.04420.

[83] G. Vardoyan, S. Guha, P. Nain, and D. Towsley, “On the Capacity Region of Bipartite
and Tripartite Entanglement Switching”, SIGMETRICS Perform. Eval. Rev. 48, 45
(2021), arXiv:1901.06786.

[84] T. A. Caswell, M. Droettboom, A. Lee, E. S. de Andrade, J. Hunter, T. Hoﬀmann, E.
Firing, J. Klymak, D. Stansby, N. Varoquaux, J. H. Nielsen, B. Root, R. May, P. Elson,
J. K. Seppänen, D. Dale, J.-J. Lee, D. McDougall, A. Straw, P. Hobson, C. Gohlke,
T. S. Yu, E. Ma, hannah, A. F. Vincent, S. Silvester, C. Moad, N. Kniazev, E. Ernest,
and P. Ivanov, matplotlib, version v3.4.1, Mar. 2021.

[85] K. Azuma, A. Mizutani, and H.-K. Lo, “Fundamental rate-loss trade-oﬀ for the quantum

internet”, Nature Communications 7, 13523 (2016).

[86] K. Azuma and G. Kato, “Aggregating quantum repeaters for the quantum internet”,

Physical Review A 96, 032332 (2017).

[87] S. Bäuml and K. Azuma, “Fundamental limitation on quantum broadcast networks”,

Quantum Science and Technology 2, 024004 (2017).

[88] L. Rigovacca, G. Kato, S. Bäuml, M. S. Kim, W. J. Munro, and K. Azuma, “Versatile
relative entropy bounds for quantum networks”, New Journal of Physics 20, 013033
(2018).

[89] S. Pirandola, “End-to-end capacities of a quantum communication network”, Commu-

nications Physics 2, 51 (2019).

[90] S. Pirandola, “Bounds for multi-end communication over quantum networks”, Quantum

Science and Technology 4, 045006 (2019).

[91] S. Das, S. Bäuml, M. Winczewski, and K. Horodecki, “Universal limitations on quantum

key distribution over a network”, arXiv:1912.03646 (2019).

[92] H.-J. Briegel, W. Dür, J. I. Cirac, and P. Zoller, “Quantum repeaters: the role of
imperfect local operations in quantum communication”, Physical Review Letters 81,
5932 (1998).

[93] W. Dür, H.-J. Briegel, J. I. Cirac, and P. Zoller, “Quantum repeaters based on entan-

glement puriﬁcation”, Physical Review A 59, 169 (1999).

[94] L.-M. Duan, M. D. Lukin, J. I. Cirac, and P. Zoller, “Long-distance quantum communi-

cation with atomic ensembles and linear optics”, Nature 414 (2001).

[95] R. M. Gingrich, P. Kok, H. Lee, F. Vatan, and J. P. Dowling, “All linear optical
quantum memory based on quantum error correction”, Physical Review Letters 91,
217901 (2003).

[96] T. C. Ralph, A. J. F. Hayes, and A. Gilchrist, “Loss-tolerant optical qubits”, Physical

Review Letters 95, 100501 (2005).

[97] L. Jiang, J. M. Taylor, K. Nemoto, W. J. Munro, R. Van Meter, and M. D. Lukin,

“Quantum repeater with encoding”, Physical Review A 79, 032325 (2009).

Accepted in Quantum 2021-08-30, click title to verify. Published under CC-BY 4.0.

52

[98] A. G. Fowler, D. S. Wang, C. D. Hill, T. D. Ladd, R. Van Meter, and L. C. L. Hollenberg,
“Surface code quantum communication”, Physical Review Letters 104, 180503 (2010).
[99] M. Zwerger, W. Dür, and H. J. Briegel, “Measurement-based quantum repeaters”,

Physical Review A 85, 062326 (2012).

[100] W. J. Munro, A. M. Stephens, S. J. Devitt, K. A. Harrison, and K. Nemoto, “Quantum
communication without the necessity of quantum memories”, Nature Photonics 6, 777
(2012).

[101] S. Muralidharan, J. Kim, N. Lütkenhaus, M. D. Lukin, and L. Jiang, “Ultrafast and
fault-tolerant quantum communication across long distances”, Physical Review Letters
112, 250501 (2014).

[102] M. Zwerger, H. J. Briegel, and W. Dür, “Measurement-based quantum communication”,

Applied Physics B 122, 50 (2016).

[103] M. Epping, H. Kampermann, and D. Bruß, “Large-scale quantum networks based on

graphs”, New Journal of Physics 18, 053036 (2016).

[104] R. Namiki, L. Jiang, J. Kim, and N. Lütkenhaus, “Role of syndrome information on a
one-way quantum repeater using teleportation-based error correction”, Physical Review
A 94, 052304 (2016).

[105] S. Muralidharan, L. Li, J. Kim, N. Lütkenhaus, M. D. Lukin, and L. Jiang, “Optimal
architectures for long distance quantum communication”, Scientiﬁc Reports 6, 20463
(2016).

[106] F. M. Miatto, M. Epping, and N. Lütkenhaus, “Hamiltonians for one-way quantum

repeaters”, Quantum 2, 75 (2018).

[107] X. Liu, Z.-Q. Zhou, Y.-L. Hua, C.-F. Li, and G.-C. Guo, “Semihierarchical quantum
repeaters based on moderate lifetime quantum memories”, Physical Review A 95,
012319 (2017).

[108] S. E. Vinay and P. Kok, “Practical repeaters for ultralong-distance quantum communi-

cation”, Physical Review A 95, 052336 (2017).

[109] F. Rozpędek, K. Goodenough, J. Ribeiro, N. Kalb, V. C. Vivoli, A. Reiserer, R.
Hanson, S. Wehner, and D. Elkouss, “Parameter regimes for a single sequential quantum
repeater”, Quantum Science and Technology 3, 034002 (2018).

[110] P. Hilaire, E. Barnes, and S. E. Economou, “Resource requirements for eﬃcient quantum
communication using all-photonic graph states generated from a few matter qubits”,
Quantum 5, 397 (2021).

[111] N. Sangouard, C. Simon, H. de Riedmatten, and N. Gisin, “Quantum repeaters based

on atomic ensembles and linear optics”, Reviews of Modern Physics 83, 33 (2011).

[112] W. J. Munro, K. Azuma, K. Tamaki, and K. Nemoto, “Inside Quantum Repeaters”,

IEEE Journal of Selected Topics in Quantum Electronics 21, 78 (2015).

[113] R. Van Meter, Quantum Networking (John Wiley & Sons, Ltd, 2014).
[114] J. Wallnöfer, M. Zwerger, C. Muschik, N. Sangouard, and W. Dür, “Two-dimensional

quantum repeaters”, Physical Review A 94, 052307 (2016).

Accepted in Quantum 2021-08-30, click title to verify. Published under CC-BY 4.0.

53

[115] M. Zwerger, A. Pirker, V. Dunjko, H. J. Briegel, and W. Dür, “Long-range big quantum-

data transmission”, Physical Review Letters 120, 030503 (2018).

[116] S. Das, S. Khatri, and J. P. Dowling, “Robust quantum network architectures and
topologies for entanglement distribution”, Physical Review A 97, 012335 (2018).
[117] J. Wallnöfer, A. Pirker, M. Zwerger, and W. Dür, “Multipartite state generation in

quantum networks with optimal scaling”, Scientiﬁc Reports 9, 314 (2019).

[118] A. Dahlberg, M. Skrzypczyk, T. Coopmans, L. Wubben, F. Rozpędek, M. Pompili,
A. Stolk, P. Pawełczak, R. Knegjens, J. de Oliveira Filho, R. Hanson, and S. Wehner,
“A Link Layer Protocol for Quantum Networks”, in Proceedings of the ACM Special
Interest Group on Data Communication, SIGCOMM ’19 (2019), pp. 159–173.

[119] C. Meignant, D. Markham, and F. Grosshans, “Distributing graph states over arbitrary

quantum networks”, Physical Review A 100, 052333 (2019).

[120] K. Chakraborty, D. Elkouss, B. Rijsman, and S. Wehner, “Entanglement Distribution
in a Quantum Network, a Multi-Commodity Flow-Based Approach”, arXiv:2005.14304
(2020).

[121] K. Goodenough, D. Elkouss, and S. Wehner, “Optimising repeater schemes for the

quantum internet”, arXiv:2006.12221 (2020).

[122] F. F. da Silva, A. Torres-Knoop, T. Coopmans, D. Maier, and S. Wehner, “Op-
timizing Entanglement Generation and Distribution Using Genetic Algorithms”,
arXiv:2010.16373 (2020).

[123] W. Dai, T. Peng, and M. Z. Win, “Optimal Remote Entanglement Distribution”, IEEE

Journal on Selected Areas in Communications 38, 540 (2020).

[124] M. Pant, H. Krovi, D. Towsley, L. Tassiulas, L. Jiang, P. Basu, D. Englund, and S.
Guha, “Routing entanglement in the quantum internet”, npj Quantum Information 5,
25 (2019).

[125] F. Hahn, A. Pappa, and J. Eisert, “Quantum network routing and local complementa-

tion”, npj Quantum Information 5, 76 (2019).

[126] C. Li, T. Li, Y.-X. Liu, and P. Cappellaro, “Eﬀective routing design for remote entan-

glement generation on quantum networks”, arXiv:2001.02204 (2020).

[127] Y. Lee, E. Bersin, A. Dahlberg, S. Wehner, and D. Englund, “A quantum router
architecture for high-ﬁdelity entanglement ﬂows in multi-user quantum networks”,
arXiv:2005.01852 (2020).

[128] R. Van Meter, T. D. Ladd, W. J. Munro, and K. Nemoto, “System Design for a
Long-Line Quantum Repeater”, IEEE/ACM Transactions on Networking 17, 1002
(2009).

[129] T. Matsuo, C. Durand, and R. Van Meter, “Quantum link bootstrapping using a
ruleset-based communication protocol”, Physical Review A 100, 052320 (2019).
[130] M. Razavi, K. Thompson, H. Farmanbar, M. Piani, and N. Lütkenhaus, “Physical and
architectural considerations in quantum repeaters”, in Quantum Communications Real-
ized II, Vol. 7236, edited by Y. Arakawa, M. Sasaki, and H. Sotobayashi (International
Society for Optics and Photonics, 2009), pp. 18–30.

Accepted in Quantum 2021-08-30, click title to verify. Published under CC-BY 4.0.

54

[131] S. E. Vinay and P. Kok, “Statistical analysis of quantum-entangled-network generation”,

Physical Review A 99, 042313 (2019).

[132] S. Brand, T. Coopmans, and D. Elkouss, “Eﬃcient Computation of the Waiting
Time and Fidelity in Quantum Repeater Chains”, IEEE Journal on Selected Areas in
Communications 38, 619 (2020).

[133] L. Hartmann, B. Kraus, H.-J. Briegel, and W. Dür, “Role of memory errors in quantum

repeaters”, Physical Review A 75, 032310 (2007).

[134] M. Razavi, M. Piani, and N. Lütkenhaus, “Quantum repeaters with imperfect memories:

cost and scalability”, Physical Review A 80, 032301 (2009).

[135] S. Guha, H. Krovi, C. A. Fuchs, Z. Dutton, J. A. Slater, C. Simon, and W. Tittel,
“Rate-loss analysis of an eﬃcient quantum repeater architecture”, Physical Review A
92, 022357 (2015).

[136] H. Krovi, S. Guha, Z. Dutton, J. A. Slater, C. Simon, and W. Tittel, “Practical quantum
repeaters with parametric down-conversion sources”, Applied Physics B 122, 52 (2016).
[137] V. V. Kuzmin, D. V. Vasilyev, N. Sangouard, W. Dür, and C. A. Muschik, “Scalable
repeater architectures for multi-party states”, npj Quantum Information 5, 115 (2019).
[138] J. Barry, D. T. Barry, and S. Aaronson, “Quantum partially observable Markov decision

processes”, Physical Review A 90, 032311 (2014).

[139] G. A. Cidre, “Planning in a Quantum System”, https://www.andrew.cmu.edu/user/

gcidre/, MA thesis (Carnegie Mellon University, 2016).

[140] S. Ying and M. Ying, “Reachability analysis of quantum Markov decision processes”,

Information and Computation 263, 31 (2018).

[141] V. Dunjko, J. M. Taylor, and H. M. Briegel, “Framework for learning agents in quantum

environments”, arXiv:1507.08482 (2015).

[142] V. Dunjko, J. M. Taylor, and H. J. Briegel, “Quantum-enhanced machine learning”,

Physical Review Letters 117, 130501 (2016).

[143] G. Gutoski and J. Watrous, “Toward a general theory of quantum games”, in Proceedings
of the Thirty-Ninth Annual ACM Symposium on Theory of Computing, STOC ’07,
arXiv:quant-ph/0611234 (2007), pp. 565–574.

[144] G. Chiribella, G. M. D’Ariano, and P. Perinotti, “Quantum circuit architecture”,

Physical Review Letters 101, 060401 (2008).

[145] G. Chiribella, G. M. D’Ariano, and P. Perinotti, “Theoretical framework for quantum

networks”, Physical Review A 80, 022339 (2009).

[146] T. Vidick and J. Watrous, “Quantum proofs”, Foundations and Trends® in Theoretical

Computer Science 11, 1 (2016).

[147] L. Vandenberghe and S. Boyd, “Semideﬁnite programming”, SIAM Review 38, 49

(1996).

[148] M. Cvitković, A.-S. Smith, and J. Pande, “Asymptotic expansions of the hypergeometric
function with two large parameters—application to the partition function of a lattice
gas in a ﬁeld of traps”, Journal of Physics A: Mathematical and Theoretical 50, 265206
(2017).

Accepted in Quantum 2021-08-30, click title to verify. Published under CC-BY 4.0.

55

