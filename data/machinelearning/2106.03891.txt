2
2
0
2

r
p
A
2
1

]
h
p
-
t
n
a
u
q
[

2
v
1
9
8
3
0
.
6
0
1
2
:
v
i
X
r
a

NISQ Algorithm for Semideﬁnite Programming

Kishor Bharti,1, ∗ Tobias Haug,2 Vlatko Vedral,1, 3 and Leong-Chuan Kwek1, 4, 5, 6
1Centre for Quantum Technologies, National University of Singapore, 3 Science Drive 2, Singapore 117543
2QOLS, Blackett Laboratory, Imperial College London SW7 2AZ, UK
3Clarendon Laboratory, University of Oxford, Parks Road, Oxford OX1 3PU, United Kingdom
4MajuLab, CNRS-UNS-NUS-NTU International Joint Research Unit, UMI 3654, Singapore
5National Institute of Education, Nanyang Technological University, 1 Nanyang Walk, Singapore 637616
6School of Electrical and Electronic Engineering Block S2.1, 50 Nanyang Avenue, Singapore 639798

Semideﬁnite programs (SDPs) are convex optimization programs with vast applications in
control theory, quantum information, combinatorial optimization and operational research. Noisy
intermediate-scale quantum (NISQ) algorithms aim to make an eﬃcient use of the current generation
of quantum hardware. However, optimizing variational quantum algorithms is a challenge as it is
an NP-hard problem that in general requires an exponential time to solve and can contain many far
from optimal local minima. Here, we present a current term NISQ algorithm for solving SDPs. The
classical optimization program of our NISQ solver is another SDP over a lower dimensional ansatz
space. We harness the SDP based formulation of the Hamiltonian ground state problem to design
a NISQ eigensolver. Unlike variational quantum eigensolvers, the classical optimization program of
our eigensolver is convex, can be solved in polynomial time with the number of ansatz parameters
and every local minimum is a global minimum. We ﬁnd numeric evidence that NISQ SDP can
improve the estimation of ground state energies in a scalable manner. Further, we eﬃciently solve
constrained problems to calculate the excited states of Hamiltonians, ﬁnd the lowest energy of
symmetry constrained Hamiltonians and determine the optimal measurements for quantum state
discrimination. We demonstrate the potential of our approach by ﬁnding the largest eigenvalue of
up to 21000 dimensional matrices and solving graph problems related to quantum contextuality. We
also discuss NISQ algorithms for rank-constrained SDPs. Our work extends the application of NISQ
computers onto one of the most successful algorithmic frameworks of the past few decades.

I.

INTRODUCTION

last

The panorama of quantum computing has been
transformed enormously in the
forty years.
Once acknowledged as a theoretical pursuit, quantum
computers with a few dozen qubits are now a reality.
Advancement at the hardware frontier has led to the
demonstration of “computational quantum supremacy”
for contrived tasks [1, 2]. We sit at the edge of the
noisy intermediate-scale quantum (NISQ) era [3, 4]. In
recent years, signiﬁcant eﬀort has been put towards
designing algorithms for practically relevant tasks which
can be implemented on NISQ devices [4, 5]. Canonical
examples of these NISQ algorithms are variational
quantum algorithms (VQAs) such as the variational
quantum eigensolver (VQE) [6–8] and the quantum
approximate optimization algorithm (QAOA) [9, 10].
NISQ algorithms have been developed for various tasks
such as ﬁnding the ground state of Hamiltonians [6–
8, 11–22], combinatorial optimization [9, 10], quantum
simulation [23–36] quantum metrology [37, 38] and
machine learning [39–43].
These algorithms have
been investigated in detail with a comprehensive
exposition on possible hurdles [44–49] and corresponding
countermeasures [49–52]. A thorough study of possible
applications of NISQ devices is expected to unravel the
potential as well as limitations of such devices. Moreover,

∗ kishor.bharti1@gmail.com

in the quest for practical quantum advantage in the NISQ
era it is pertinent to investigate novel NISQ algorithms
for practically relevant tasks.

A major challenge in the NISQ era is the optimization
program for VQAs, where a classical optimizer is
searching for the parameters of a quantum state that
minimizes a cost function. For the VQA to be successful,
one requires an ansatz that is expressible enough to
approximate the optimal solution of the corresponding
optimization problem. However, even if such ansatz
has been found, the optimization program of the VQA
is NP-hard and in contrast to classical neural networks
the optimization landscape contains numerous far from
optimal
local minima [48, 53, 54]. The highly non-
convex nature of landscape renders optimization diﬃcult
even for VQAs involving logarithmically many qubits or
classically easy problems such as free fermions. Further,
VQAs struggle to optimize problems where the solution
space is constrained due to symmetries such as for
chemistry problems [7, 55–59].
few decades,

semideﬁnite programs
(SDPs) have led to ground breaking developments in
The study of
mathematical optimization [60, 61].
SDPs has uncovered numerous applications in theoretical
computer science, control theory and operations research.
Many problems in quantum information such as state
discrimination [62–64], dimension witness [65] and self-
testing [66–70] can be investigated using SDPs. While
SDPs can be solved eﬃciently in polynomial time on
classical computers, high dimensional problems may still
be out of scope for classical computers. For example,

In the last

 
 
 
 
 
 
ﬁnding the ground state of a Hamiltonian can be framed
as a SDP, however it is intractable for classical computers
due to the exponential scaling of the dimension of
the problem. To explore possible quantum advantages
for solving SDPs with quantum computers, quantum
SDP solvers have been studied comprehensively [71–
77]. However, existing quantum SDP solvers cannot
be executed on NISQ devices as they require extensive
quantum resources.

Here, we propose the NISQ SDP Solver (NSS) as a
hybrid quantum-classical algorithm to solve SDPs. The
NSS encodes a SDP onto a quantum computer combined
with an optimization routine on a classical computer.
The classical optimization part of the NSS is also a
SDP with its dimension given by the size of the ansatz
space. The quantum computational part of the NSS
has no classical-quantum feedback loop and requires the
quantum computer only for estimating overlaps, which
can be done eﬃciently on current NISQ devices. We
showcase the NSS for a wide range of problems. We
design a NISQ SDP based quantum eigensolver (NSE)
to ﬁnd the ground state of quantum Hamiltonians.
In
contrast to VQE, the classical optimization part of the
NSE can be solved in polynomial time without the local
minima problem. We ﬁnd numerical evidence that the
NSE improves the estimation of the ground state energy
by a constant factor for any number of qubits for a
non-integrable one-dimensional Ising model combined
with a quantum annealing ansatz. Furthermore, the
NSS is capable of eﬃciently implementing constraints in
the optimization program in order to calculate excited
states and solve symmetry constrained problems.
In
addition, we provide an NSS for determining optimal
measurements for quantum state discrimination. The
NSS can be also ﬁnd the largest eigenvalue of matrices,
which we demonstrate for matrices as large as 21000.
Finally, we show the NSS for various important problems
related to quantum information such as Bell non-local
games and the Lov´asz Theta number. We also provide
the extension of the NSS for rank-constrained SDPs.

One can argue that SDPs are solvable eﬃciently in
polynomial time on classical computers and hence why
should one construct a NISQ algorithm for SDPs. We
would like to stress that the polynomial runtime is
in terms of the input matrix size and the number of
constraints. For problems with exponential input size,
polynomial of exponential would be still exponential and
hence classical SDPs would be unable to process such
cases. To begin, the Hamiltonian ground state problem
In
is an SDP, but that does not mean it is tractable.
other words, while SDPs can be solved in polynomial
time and memory, when the problem scales exponentially
classical computers are unable to process it. For example,
no classical computer in the world is able to store a
problem of size 260. However, quantum computers can
store this vector eﬃciently within a quantum state of
60 qubits, which is the current state of the art of NISQ
computers. Here, our NSS algorithm oﬀers the potential

2

to outperform any classical SDP solver.

II. BACKGROUND

We now highlight the key diﬀerence between VQA and
NSS in Fig.1 by using the ground state problem as an
example. Finding the ground state of a Hamiltonian can
be framed as a SDP using density matrices (see program
10), however the SDP suﬀers from exponential scaling of
the dimension of the quantum state and thus it is diﬃcult
to solve on classical computers. To address the scaling
of the quantum state, VQE and NSE map the quantum
state onto a quantum computer. VQE uses a quantum
circuit parameterized by the parameter θ. Then, the
VQE minimizes the energy of the quantum state by
variationally adjusting the parameter θ via a classical
optimization routine in a feedback loop. However, this
minimization task is challenging as the corresponding
optimization program is non-convex and NP-hard [48].
In contrast to classical neural networks, the optimization
landscape of VQEs is characterised by local minimas far
from the global minima, where optimization routines are
unlikely to ﬁnd reasonable approximations of the global
minima [53]. Only for overparameterized circuits the
landscape becomes favorable, which for most types of
circuits requires an exponential amount of parameters
and exponentially deep circuits [50, 78].

In contrast,

the NSS uses

a hybrid density
matrix Eq. (4). It consists of a linear combination of a M -
dimensional set of ansatz quantum states with classical
combination coeﬃcients β. In the NSS, the β parameters
are optimised to minimize the energy. The optimization
of the coeﬃcients β is another SDP with dimension M
only, which can be eﬃciently optimised in polynomial
time on a classical computer. The ansatz preserves the
convexity of the landscape and hence any local minimum
is also a global minimum.

III. SEMIDEFINITE PROGRAM

SDPs

can be

thought of as generalization of
the “standard form” linear programming (LP). The
“standard form” of LP is given by

min cT x

(1)

s.t aT

i x = bi ∀i ∈ [m]
+ ,

x ∈ Rn

+ := {x ∈ Rn|x ≥ 0}. The set Rn

where the set [m] is given by [m] ≡ {1, 2, 3, . . . , m}.
Here, Rn
+ is
known as nonnegative orthant. The phrase “standard
form” hints that there are other possible non-standard
representations of LPs.
Any LP in non-standard
form, however, can be converted into standard form by
following a few tricks. These tricks include change of

3

optimization problems can be viewed from either of two
perspectives, namely the primal problem or the dual
problem. For a given primal minimization problem P ,
the solution to the corresponding dual problem problem
D provides a lower bound to the solution of P . The
standard form of the dual of the SDP in program 2 is
given by

max bT y
m
(cid:88)

yiAi (cid:52) C

s.t.

i=1
y ∈ Rm .

(3)

+. Here, Hn

The SDPs in programs 2 and 3 constitute a primal-dual
pair. SDPs can be extended to complex-valued matrices
via a cone of Hermitian positive semideﬁnite matrices i.e.
X ∈ Hn
+ denotes the set of n × n Hermitian
positive semideﬁnite matrices. Since SDPs for complex-
valued matrices are more general than SDPs for real
valued matrices, we will consider the former case in this
work.

IV. THE NSS

We now outline

the NSS, which consists

of
three distinct steps, namely ansatz selection, overlap
measurement and post-processing. First, we select a set
of quantum states S = {|ψj(cid:105) ∈ H}j over a Hilbert space
H, where the set contains M quantum states |S| = M .
Now, our NISQ semideﬁnite programming solver (NSS)
uses the following hybrid density matrix ansatz

Xβ =

(cid:88)

(|ψi(cid:105),|ψj (cid:105))∈S×S

βi,j|ψi(cid:105)(cid:104)ψj|,

(4)

where βi,j ∈ C. Note that the quantum states in S are
prepared by a quantum system while the coeﬃcients βi,j
are stored on some classical device as matrix β. For
β ∈ HM
+ (see Appendix B). We now
assume that C and constraint matrices Ai of program 2
can be written as a sum of unitaries

+ , we have Xβ ∈ Hn

(cid:88)

C =

skUk

Ai =

k
(cid:88)

l

fi,lU (i)
l

.

As second step of the NSS, we measure the following
overlaps on the quantum system

(cid:88)

Da,b =

sk(cid:104)ψb|Uk|ψa(cid:105)

k
(cid:88)
fi,l(cid:104)ψb|U (i)

l

|ψa(cid:105) .

E (i)
a,b =

l

(5)

(6)

The overlaps can be measured using the Hadamard test
or with direct measurement methods [79]. An alternative

|ψi(θ)(cid:105).

Classical

computer

FIG. 1. a) Hybrid quantum-classical computing approach
to NISQ. Quantum computer prepares and measures
M quantum states
is
used to optimize hybrid density matrix ρ(β, θ) =
(cid:80)M
i,j βi,j|ψi(θ)(cid:105)(cid:104)ψj(θ)|, which depends on the parameters for
the parameterized quantum circuit θ and the combination
coeﬃcients β. b) Optimization task to ﬁnd ground state
of Hamiltonian H by minimizing parameters β, θ in respect
to energy Tr(Hρ(β, θ)). c) Landscape of optimization task
for β and θ. Optimization of circuit parameters θ in the
variational quantum eigensolver (VQE) is NP-hard with a
non-convex landscape and persistent far from optimal local
minima. Optimisation of coeﬃcients β in our NISQ SDP
based eigensolver (NSE) can be solved in polynomial time
by a semideﬁnite program (SDP), where the optimisation
landscape is convex. Due to the convexity of the optimisation
landscape, any local minimum is also a global minimum.

variables, transforming the inequalities into equalities
and switching maximum to minimum.

In a SDP, the non-negativity constraint x ≥ 0 is
replaced by positive semideﬁnite cone constraint X (cid:60) 0.
SDPs involve optimization of a linear function of matrix
X over the aﬃne slice of the cone of positive semideﬁnite
matrices. The standard form of a SDP is given by

min T r (CX)
s.t. T r (AiX) = bi ∀i ∈ [m]
X ∈ S n
+ .

(2)

Here, S n
+ denotes the set of n × n symmetric positive
semideﬁnite matrices. Mathematically speaking, S n
+ :=
{X ∈ S n|X (cid:60) 0}. The matrices C and Ai belong to
the set of symmetric matrices S n for i ∈ [m]. The i-th
element of vector b ∈ Rm is denoted by bi.

Duality is one of the oldest and most fruitful ideas
in mathematics. The duality principle of mathematical
that mathematical
suggests
optimization

theory

Classical computerQuantum computeroptimizeVQE: optimizeNSE: optimizeabcl

are Pauli strings P = (cid:78)N

NISQ-friendly method that requires only sampling in the
computational basis has been proposed in [21], which
we use in the following. This method assumes that the
unitaries Uk and U (i)
j=1 σj
with σ ∈ {I, σx, σy, σz}. As the Pauli strings form a
complete basis, any matrix can be decomposed into a
linear combination of Pauli strings. Further, we assume
that the ansatz space is generated by an initial state |ψ(cid:105)
and a set of M diﬀerent Pauli strings {P1, . . . , PM } via
S = {Pj|ψ(cid:105)}M
j=1. Now, each overlap element in Eq. (5),
Eq. (6) can be written as a sum of expectation values of
Pauli strings (cid:104)ψ|P1P2P3|ψ(cid:105) = a(cid:104)ψ|P (cid:48)|ψ(cid:105), where we use
that a product of Pauli strings can be written as a single
Pauli string P (cid:48) with a prefactor a ∈ {+1, −1, +i, −i}.
Then, one can eﬃciently calculate the overlap elements
by measuring the expectation values of Pauli strings.
On NISQ computers, this can be done by preparing the
initial state |ψ(cid:105), performing single-qubit rotations into
the eigenbasis of the Pauli operator and then sampling
in the computational basis NQ times. We note that
sampling from quantum circuits is general intractable
for classical computers [80]. The additive error ∆P of
estimating the expectation value of Pauli strings scales
as ∆P ∝ N − 1
Q according to Hoeﬀding’s inequality and is
independent of the number of qubits [49].

2

The third and ﬁnal step of the NSS consists of post-
processing on a classical computer. Here, we write the
standard form primal SDP in terms of the measured
overlaps

4

information [65]. Many problems in optimization theory
can be modelled as rank-constrained SDPs [60, 83]. The
rank-constraint turns the optimization program into a
non-convex and NP-hard problem, which is in general
intractable to solve. The optimization program for rank
constrained SDPs is given by

min T r (CX)
s.t. T r (AiX) = bi ∀i ∈ [m]
rank(X) ≤ k
X ∈ S n
+ .

(9)

Notice that the only diﬀerence between the regular SDP
in program 2 and the rank-constrained SDP in program 9
is the presence of the rank constraint rank(X) ≤ k in
the latter. Intuitively speaking, the aforementioned rank
constraint means that the optimizer of the program 9
must have a rank of at most k. The famous Max-Cut
problem can be modelled as a rank constrained SDP for
k = 1 (see Appendix C). We defer the extension of the
NSS for the rank constrained SDPs in Appendix C.

VI. EXAMPLES

We now demonstrate the NSS for various problems of

interest.

A. Ground State Problem

min T r (Dβ)
(cid:17)

(cid:16)

s.t. T r

E (i)β

= bi ∀i ∈ [m]

β ∈ HM
+ .

(7)

First, we demonstrate the NSE solver to ﬁnd the
ground state of Hamiltonians. For Hamiltonian H =
(cid:80)
k skUk and density matrix ρ, the problem of ﬁnding

the ground state can be written as

This is a SDP over β with the corresponding hybrid
density matrix is given by Eq. (4). The dual of the SDP
in program 7 is given by

min T r (ρH)
s.t. T r (ρ) = 1
ρ (cid:60) 0 .

max bT y
m
(cid:88)

yiE (i) (cid:52) D .

s.t.

i=1

(8)

The dual formulation for Program 10 is given by

max λ
s.t. (H − λI) (cid:60) 0 .

(10)

(11)

The SDPs in program 7 and 8 constitute a primal-
dual pair over the ansatz space that can be solved in
polynomial time on a classical computer.
In the case
where the ansatz states |ψi(cid:105) are linear independent and
cover the whole Hilbert space, the programs 7 and 8 over
the ansatz space recover the SDPs over the entire space
corresponding to programs 2 and 3.

The optimum value of λ corresponds to the ground state
energy. In the ansatz space generated by S, the primal
SDP for the Hamiltonian ground state problem is given
by

min T r (βD)
s.t. T r (βE) = 1
β ∈ HM
+ ,

(12)

V. EXTENSIONS TO RANK-CONSTRAINED
SDPS

with Ea,b = (cid:104)ψb|ψa(cid:105) and Da,b = (cid:80)
dual program of Program 12 is given by

k sk(cid:104)ψb|Uk|ψa(cid:105). The

Rank constrained SDPs ﬁnd numerous applications
in combinatorics [81], control theory [82] and quantum

max λ
s.t. (D − λE) (cid:60) 0 .

(13)

Notice that the primal optimization program over β is
convex and hence exhibits a unique minimum value. This
is unlike the case of VQE, where optimization is non-
convex and there can be multiple local minima [48]. In
the NSE, the classical optimization ﬁnds the optimal
solution in time polynomial in the number of ansatz
parameters, given that the solution is contained in the
ansatz space. On the other hand, in VQAs such as VQE
and QAOA, even if the optimal solution is contained in
the ansatz space, the classical optimization can be NP-
hard [48]. Moreover, the primal optimal solution is
equal to the dual optimal solution.
Claim 1. The primal optimal solution corresponding to
the SDP in Program 12 is equal to its dual optimal
solution (Program 13).
In other words, the SDP in
Eq. (12) admits strong duality.

Proof. To show that the SDP in Program 12 admits
strong duality, we need to show that the interior is non-
empty [84]. The non-empty interior can be established
via the existence of a full rank feasible solution for
Program 12. Consider

L = IM .

Clearly, L is feasible and full rank. This completes the
proof.

Now we demonstrate the NSE for ﬁnding the ground
state of a non-integrable model, namely the one-
dimensional Ising model of N qubits with transverse ﬁeld
h and longitudinal ﬁeld g

Hising = Hz +Hx = −

N
(cid:88)

[σz

nσz

n+1+gσz

n]−

n=1

N
(cid:88)

n=1

hσx

n (14)

nσz

n=1[σz

n=1 hσx

with Hz = − (cid:80)N
n+1 + gσz
n] and Hx =
− (cid:80)N
n. First, we prepare an initial state on the
quantum computer, which we then use to construct
the ansatz space. As initial state, we either choose a
hardware eﬃcient circuit |ψrand(cid:105) consisting p layers of
randomized y-rotations and CNOT gates arranged in a
chain topology (see Appendix A) , a product state |+(cid:105)⊗N
and a discretized quantum annealing state

|ψQA(cid:105) =

p
(cid:89)

k=1

e−iT (cid:80)N

n=1 Hx e−i T k

p Hz |+(cid:105)⊗N ,

(15)

where p is the number of layers of the circuit and T
the quantum annealing time. The state is constructed
by evolving with Eq. (14), where we stepwise evolve
with the non-commuting parts Hx and Hz. This state
is a discretized form of a quantum annealing protocol,
where one starts with the ground state of Hx, and
then slowly increases Hz until one reaches the target
In the limit p → ∞, the
Hamiltonian Eq. (14).
adiabatic theorem guarantees that this state becomes the
exact ground state [85]. A similar type of ansatz with

5

additional variational parameters is used for QAOA and
VQE [9, 86].

To generate the ansatz space for Eq.

(4), we
use a NISQ-friendly adaption of the Krylov subspace
approach [18, 19, 87, 88]. In the original Krylov subspace
approach, the ground state is approximated by a sum of
powers of the Hamiltonian H k applied on the initial state
|ψ(cid:105) prepared on the quantum computer with appropriate
coeﬃcients αk and truncated up to order K

|ξ (α)(cid:105)(K) = α0|ψ(cid:105) + α1H|ψ(cid:105) + · · · + αKH K|ψ(cid:105) .

(16)

i1,...,ik

ci1...ik Pi1 . . . Pik

k Pi)k = (cid:80)

However, on NISQ computers it is challenging to measure
H k. To simplify this approach, we use the fact that
the Ising Hamiltonian is a sum of Pauli strings Pi.
We decompose the power of the Hamiltonian H k =
((cid:80)
into a sum of
products of Pauli strings. We then take each product
of Pauli string Pi1 . . . Pik |ψ(cid:105) and add each unique term
to the set S [21]. Note that a product of Pauli strings is
again a Pauli string. We do this for each power of the
Hamiltonian up to order K. The generated set S contains
the original Krylov subspace. However, it can be easily
measured on NISQ devices as the corresponding overlaps
are simple measurements of Pauli strings. We show as
example the ﬁrst order of the ansatz states for Eq. (14)
with M = 3N states

S1
Ising ={σz
1|ψ(cid:105), . . . , σz
1 |ψ(cid:105), . . . , σx
σx

N |ψ(cid:105), σz
N |ψ(cid:105)} .

1σz

2|ψ(cid:105), . . . , σz

N σz

1|ψ(cid:105),

We use a subset of M states from S to run the NSE and
investigate the convergence of our approach, where we
select the ﬁrst M states in ascending order of the order
of the Krylov subspace k.

In Fig.2a, we investigate the error ∆ENSE = ENSE−Eg
between the energy via the NSE ENSE and the exact
ground state energy Eg as function of M . We ﬁnd that
with increasing M the energy decreases and beyond a
threshold M the exact ground state is reached. The
quality of the approximation highly depends on the
choice of initial state. We ﬁnd that the random circuit
state |ψrand(cid:105) converges slowly and only ﬁnds the exact
ground state when M becomes the same order as the
Hilbert space, In contrast, the quantum annealing state
converges much faster to a small error and yields a good
approximation of the energy even at modest M .

In Fig.2b, we investigate the scaling of the NSE with
number of qubits N . We prepare the quantum annealing
ansatz |ψQA(cid:105) with p = N/2 layers with energy EQA =
(cid:104)ψQA|Hising|ψQA(cid:105). Now, we apply the NSE with initial
state |ψQA(cid:105) to improve the energy estimation by using the
ﬁrst order of the NISQ-friendly Krylov subspace Eq. (16).
We show the improvement of NSE in estimating the
energy ∆EQA/∆ENSE relative to the error of quantum
annealing ∆EQA = EQA−Eg. With increasing number of
ansatz states M , ∆EQA/∆ENSE improves non-linearly.
For any number of qubits, ∆EQA/∆ENSE collapses to
a single curve as function of number of ansatz states

a

b

states is given by

T r (βNE+1D)

min
βNE+1
s.t. T r (βNE+1E) = 1
NE(cid:88)

tr(βnEβNE+1E) = 0

6

(17)

FIG. 2. a) Error ∆ENSE = ENSE − Eg of the energy ENSE
found via NSE and the exact ground state energy Eg for the
Ising model (Eq. (14), h = g = 1) plotted against number of
ansatz states M . The M ansatz states are generated using a
Krylov subspace approach from an initial state. The initial
state of N = 8 qubits is either a hardware eﬃcient circuit
|ψrand(cid:105) composed of p = 4 layers of random single qubit y
rotations and CNOT gates arranged in a chain topology, a
product state |+(cid:105)⊗N or a quantum annealing state |ψQA(cid:105) with
p = 4 layers. b) Scaling with number of qubits N of the
relative improvement ∆EQA/∆ENSE of estimation error of
NSE ∆ENSE and quantum annealing ∆EQA = EQA−Eg. The
relative improvement collapses to a single curve for varying
number of ansatz states M (cid:63) = M/(3N ) divided by number
of qubits. The initial state is the quantum annealing state
|ψQA(cid:105) with p = N/2 layers. We ﬁt with ∆EQA/∆ENSE =
3.6M ∗4 + 1.2M (cid:63) + 1.

M ∗ = M/(3N ) normalised by the number of qubits N .
This suggests that we can achieve a scalable improvement
in energy estimation ∆EQA/∆ENSE(M ∝ N ) = const
when the number of ansatz states M scales linearly with
N . For example, we achieve a factor of 6 improvement
for M = 3N ansatz states for any N . This demonstrates
that the NSE can substantially enhance the accuracy of
ﬁnding the ground state energy even for larger system
sizes. In the Appendix E, we show that the same scaling
appears for diﬀerent parameters of the Hamiltonian and
the quantum annealing state.

n=0

β ∈ HM
+ .

We can be run Program 17 iteratively with the output of
the previous iterations to ﬁnd up to M − 1 excited states.

C. Symmetry-resolved lowest eigenenergy

Quantum many-body Hamiltonians H often have
symmetries. Each symmetry corresponds to a particular
symmetry operator S which commutes with the
Hamiltonian [S, H] = 0. Under time evolution with H,
the expectation value of S is conserved. A common
task encountered in quantum many-body physics and
quantum chemistry is
to ﬁnd the eigenstate with
lowest energy that is simultaneously an eigenstate of
the symmetry S with a conserved quantity sk. One
common approach to solve this problem is use an ansatz
that respects the symmetry operator S initialised with
the desired sk [89, 90]. However, ﬁnding such an
ansatz can be diﬃcult and the optimisation is more
challenging compared to a general ansatz that breaks the
symmetry [90, 91]. Another approach is to add penalty
terms to the Hamiltonian, but this is known to render
the optimization far more challenging [55, 59].

Our SDP solver opens up a new way to ﬁnd the lowest
eigenenergy with the conserved quantity. We constrain
the minimization problem of the Hamiltonian H to the
subspace where S takes the eigenvalue sk

(18)

min
ρ

T r (ρH)

s.t. T r (ρ) = 1
T r (Sρ) = sk
T r (cid:0)S2ρ(cid:1) = s2
ρ (cid:60) 0 .

k

B. Excited states

We now adapt the NSS solver to ﬁnd the excited
states of the Hamiltonian. We assume that we already
found approximations for ground state ρ0 and the ﬁrst
ﬁrst NE ≥ 0 excited states ρn with the coeﬃcients βi,
i ∈ {0, . . . , NE}. To ﬁnd the NE + 1 excited state
ρNE+1 with coeﬃcient βNE+1, we run the NSS with the
added constraint that the overlap between βNE+1 and the
already found states is zero with (cid:80)NE
n=0 tr(ρnρNE+1) =
(cid:80)NE
n=0 tr(βnEβNE+1E) = 0. The state with the smallest
energy that satisﬁes the constraints is the approximation
of the NE + 1 excited state. The NSS solver for excited

Here, we demand that the expectation value of the
symmetry operator and its square are ﬁxed to the
conserved quantity, i.e. (cid:104)S(cid:105) = sk and (cid:104)S2(cid:105) = s2
k. Here,
S2 is needed to make sure that we ﬁnd an eigenstate of
the symmetry operator. We now give the corresponding
formulation as NSS

(19)

min
β

T r (DH)

s.t. T r (Eβ) = 1
T r (Rβ) = sk
T r (T β) = s2
k
β (cid:60) 0 .

0100200M103102101100101ENSE|rand|+N|QA0.000.250.500.751.00M0246EQA/ENSEN=8N=10N=12N=14N=16N=18N=20fitD. Largest Eigenvalue

7

Our next task is to ﬁnd the largest eigenvalue of
a sparse matrix C by maximizing Program 12. We
assume that C is of size N = 2N and is represented
by a combination of S Pauli string C = (cid:80)S
i=1 ciP r
i ,
i = ⊗N
where the Pauli strings are given by P r
j=1σj
with σj ∈ {I, σx, σy, σz} and ci
is a prefactor. To
numerically demonstrate the performance of NSS, we
uniformly sample the Pauli operators for each qubit,
choose random ci ∈ [−1, 1] and use the N -bit state
with all zeros |0(cid:105)⊗N as ansatz state. Using the Krylov
subspace idea for ﬁnding the ground state, we similarly
construct the ansatz space S. While the expectation
values can be calculated classically for the product state,
it becomes an intractable problem when using highly
entangled quantum states as ansatz states.
In Fig.4,
we plot the diﬀerence between the largest eigenvalue
found by NSE and the exact solution ∆λ as function
of the number of states M within the ansatz space for
diﬀerent matrix dimensions N . For small M , we ﬁnd that
the error decreases approximately with (cid:104)∆λ(cid:105) ∝ M −0.77.
Beyond a threshold M , we ﬁnd very good convergence
even for matrix dimensions 21000.

Here, we deﬁne Ra,b = (cid:104)ψb|S|ψa(cid:105) and Ta,b = (cid:104)ψb|S2|ψa(cid:105),
where S and S2 can be decomposed into a sum of
In contrast to VQE, SDPs with constraints
unitaries.
are convex and can be eﬃciently solved.

We implement our solver for two important quantum
many-body problems, the transverse Ising model Eq. (14)
and the Heisenberg model

N
(cid:88)

H =

(σx

nσx

n+1 + σy

nσy

n+1 + hσz

nσz

n+1) .

(20)

n=1

n=1 σz

n=1 σz

As demonstration, for the transverse Ising model (g = 0)
we consider its parity symmetry P = (cid:81)N
n with
conserved quantities p = ±1. For the Heisenberg model,
we consider the conservation of number of particles Q =
(cid:80)N
n with qk = {−N, −N +2, . . . , N −2, N }. We run
the NSS with a random hardware eﬃcient circuit and the
NISQ-friendly adaption of the Krylov subspace approach
to construct the ansatz states. In Fig.3 we solve for the
lowest eigenenergy within a particular symmetry sector
for varying number of ansatz states M . For low M , the
constrained NSE does not ﬁnd any solution as the ansatz
is unable to satisify the constraints for the symmetry.
Above a speciﬁc M , we ﬁnd an appropriate solution,
which for further increase of M converges to the lowest
eigenenergy ES
0 for the given conserved quantity. For the
Heisenberg model, we ﬁnd that higher particles Q require
a larger number of ansatz states M to ﬁnd a feasible
solution. We believe that by replacing the random
hardware eﬃcient circuit with a better suited initial
state, the convergence of the energy can be tremendously
improved.

a

b

FIG. 3. Lowest eigenenergy and eigenstate of a Hamiltonian
within a symmetry sector. We solve for the lowest eigenenergy
using Eq. (19) where we ﬁx the conserved quantities to a
particular value. As reference, we also show the unconstrained
NSS solver. We show the energy of the Hamiltonian (cid:104)H(cid:105) in
reference to the lowest eigenergy of the symmetry sector ES
0
as function of the number of ansatz states M . The ansatz is
randomized quantum circuit. a) One-dimensional transverse
Ising Hamiltonian Eq. (14) (h = 1, g = 0) with parity P and
N = 8 qubits. b) One-dimensional Heisenberg model Eq. (20)
with conserved number of particles Q for N = 8 qubits.

FIG. 4. NSS for calculating the largest eigenvalue of a matrix
C consisting of S = 8 random Pauli strings. We show average
diﬀerence (cid:104)∆λ(cid:105) between largest eigenvalue found by NSE and
exact largest eigenvalue as function of the size of the ansatz
space M for diﬀerent matrix sizes N . Shaded area is standard
deviation of ∆λ averaged over 20 random instances of C. The
black dots are a ﬁt for small M .

E. Unambiguous state discrimination

The task of state discrimination is to identify NS
states drawn randomly from a set G = {ρn}NS
n=1 by
General
performing a measurement on the state.
measurements are described by positive operator-valued
measures (POVMs) Fn (cid:60) 0 with the condition (cid:80)
n Fn =
I.
If all the states are pure and pairwise orthogonal,

0100200M024HEP0no constraintP=1P=1100101102M104103102101100=210=220=250=2100=2300=21000M0.77one can simply measure with the projectors on the
individual states Πn = |ψn(cid:105)(cid:104)ψn|. However, for non-
orthogonal states this naive approach will result in
classiﬁcation errors. However, we can ﬁnd a set of
NS + 1 POVMs that can unambiguously classify pure
states. The POVMs are of the form (cid:80)NS+1
n=1 Fn = I with
FNS+1 = I − (cid:80)NS
n=1 Fn. When we measure the outcome
n ∈ {1, . . . , NS} associated to POVM Fn with probability
Qn(ρ) = tr(ρFn), we classify the measured state as
ρn.
If we measure the outcome NS + 1 with POVM
FNS+1, then we say that we are unable to classify the
state. The problem of ﬁnding the optimal set of POVMs
can be formulated as an SDP. Our goal is to optimize
POVMs in respect to the average probability Qcorrect =
1
n=1 Qn(ρn) to correctly classify the states. Further,
NS
we demand that the probability of wrongly classifying
state ρk is bounded by Qerror
n(cid:54)=k tr(ρkFn) ≤ (cid:15), ∀k
with (cid:15) ≥ 0. The SDP is given by

= (cid:80)NS

(cid:80)NS

k

max
F1,...,FNS

1
NS

NS(cid:88)

n=1

T r (Fnρn)

(21)

s.t.

NS(cid:88)

n(cid:54)=k

T r (ρkFn) ≤ (cid:15) ∀k ∈ {1, . . . , NS}

NS+1
(cid:88)

n=1

Fn = I

Fk (cid:60) 0 ∀k ∈ {1, . . . , NS + 1} .

We can formulate the problem as a NSS. We assume
we are given a set of NS states to be discriminated
written in the form of hybrid states ρn = (cid:80)
i,j|ψi(cid:105)(cid:104)ψj|
with the M × M matrix βn (cid:60) 0 and M ansatz states
S = {|ψj(cid:105)}M
j=1. To get valid density matrices, we have
tr(ρn) = tr(Eβn) = 1, Ea,b = (cid:104)ψb|ψa(cid:105) and βn (cid:60) 0. We
write the NS POVMs to be optimized as hybrid POVMs

i,j βn

Fn =

(cid:88)

i,j

γn
i,j|ψi(cid:105)(cid:104)ψj|

(22)

with γn (cid:60) 0. The last POVM for the case where we
are unable to classify the state is given by FNS+1 =
I − (cid:80)NS
n=1 Fn. We demand that FNS+1 (cid:60) 0 is positive
semideﬁnite, which is always fulﬁlled when B = E −
(cid:80)NS
n=1 EγnE (cid:60) 0. FNS+1 is positive semideﬁnite when
for any state |x(cid:105) we have (cid:104)x|FNS+1|x(cid:105) ≥ 0. We can write
arbitrary states as |x(cid:105) = (cid:80)M
n=1 αn|ψn(cid:105) + α⊥|ψ⊥(cid:105) with
state |ψ⊥(cid:105) being orthogonal to the subspace spanned
by the ansatz states and normalised coeﬃcients α,
α⊥. A straightforward calculation shows (cid:104)x|FNS+1|x(cid:105) =
α†Bα + |α⊥|2 ≥ α†Bα, which is non-negative when
B (cid:60) 0. The program of the NSS for state discrimination

8

is now given by

max
γ1,...,γNS

1
NS

NS(cid:88)

n=1

T r (γnEβnE)

(23)

s.t.

NS(cid:88)

n(cid:54)=k

EβkEγn(cid:17)
(cid:16)

T r

≤ (cid:15) ∀k ∈ {1, . . . , NS}

B = E −

NS(cid:88)

EγnE (cid:60) 0

n=1
γk (cid:60) 0 ∀k ∈ {1, . . . , NS} .

As both the states and POVMs are constructed from
the same ansatz space, it is unsurprising that Program
23 ﬁnds the optimal POVMs for unambiguous state
discrimination for any number of qubits.

i,j βk

We demonstrate in Fig.5 our algorithm by classifying
two pure states generated by a hardware eﬃcient
quantum circuit |ψrand(cid:105) (see Appendix A), which is
intractable to simulate for large number of qubits.
The two states ρ1 and ρ2 are prepared as |ψk(cid:105) =
(cid:80)M
ijPj|ψrand(cid:105)(cid:104)ψrand|Pi where Pi ∈ S are a random
set of M Pauli strings. The matrix E can be eﬃciently
measured on NISQ computers as shown in Sec. IV. In
Fig.5a, we show the probability Qcorrect of correctly
identifying the states as function of the angle φ =
tr(ρ1ρ2)) between the two states. We ﬁnd that
arccos(
for demanding zero misclassiﬁcation error (cid:15) = 0, our
NSS ﬁnds the analytically known optimal POVMs with
Qoptimal
correct = 1−cos(φ) [92]. In Fig.5b, we show the average
probability Qunknown = 1
n=1 tr(ρnFNS+1) that we
NS
cannot make a decision. The change in slope of the
classiﬁcation probability for (cid:15) > 0 seen in Fig.5a coincides
with Qunknown = 0.

(cid:80)NS

(cid:112)

a

b

FIG. 5. We show the probability of classifying two states
with optimized POVMs found with the NSS. We demand
that the misclassiﬁcation error is upper bounded by (cid:15). a)
Probability Qcorrect of correctly classifying states as function
of angle between the two states φ. b) Probability Qunknown
of being unable to make a decision. The dashed line is the
analytic optimal solution for (cid:15) = 0. The classiﬁed states are
hybrid states generated using random quantum circuits with
N = 10 qubits, d = 10 layers and M = 20 ansatz states
generated with random Pauli strings.

0.000.250.500.751.001cos()0.00.51.0Qcorrect=0=0.01=0.1=0 optimal0.000.250.500.751.001cos()0.00.51.0Qunknown=0=0.01=0.1=0 optimal9

latest when the number of basis states reaches the
dimension of the problem. Depending on the choice of
initial state, the optimal solution can be reached with a
lower number of ansatz states.

a

b

FIG. 6. Graph with 8 nodes that has applications in
quantum foundations and in device certiﬁcation protocols.
We calculate the Lov´asz Theta number (2+
2) for this graph
using NSS.

√

F. Lov´asz Theta Number

Graph invariants are properties that depend only
on the abstract structure of a graph. The Lov´asz
Theta number is such a graph invariant that was ﬁrst
introduced by L´aszl´o Lov´asz in the breakthrough 1979
paper titled “On the Shannon capacity of a Graph” [93].
The Lov´asz Theta number provides an upper bound
to the Shannon capacity of a graph, another graph
invariant quantity. Surprisingly,
it is connected with
quantum contextuality [66–68, 94–96] and can help us
to understand the potential of quantum computers [97].
Given a graph G = (V, E) with vertex set V and
adjacency matrix E, the SDP for the Lov´asz Theta
number is given by

max T r (JX)
s.t. Xi,j = 0 ∀Ei,j = 1
T r(X) = 1
X (cid:60) 0 .

(24)

Here, J is an all one matrix. Since X is real valued,
the ansatz space can be taken as real valued, which can
be achieved within NSS by demanding that the ansatz
quantum states are real valued. To demonstrate the
NSS, we calculate the Lov´asz Theta number for the
graph shown in Fig. 6. To generate the ansatz states
S, we apply a set of Pauli operators on a quantum
state. We use the zero state |0(cid:105) = |0(cid:105)N or representative
examples of randomized states generated via hardware
eﬃcient quantum circuits |ψrand(cid:105) (see Appendix A).
Then, the set of basis states is generated by applying
M diﬀerent combinations of Pauli strings on the state
S = {P x
j=1σj with σj ∈ {I, σx}.
i = ⊗N
In Fig.7a we show the error of the NSS. We calculate
the error as the diﬀerence between the exact solution
Cexact, including the constraints of the problem, and the
expectation values (cid:104)C(cid:105) gained from the quantum state
via NSS. We observe an improvement with increasing
number of ansatz states M , reaching the optimal solution

i=1, where P x

i |ψ(cid:105)}M

FIG. 7. Error of exact solution Cexact and NSS (cid:104)C(cid:105) plotted
against number of ansatz states M . Cexact and (cid:104)C(cid:105) are vectors
that contain the cost function as well as the constraints to be
fulﬁlled. The ansatz space is generated using the all zero
state |0(cid:105) as well as representative examples of randomized
quantum circuit |ψrand(cid:105) constructed in a hardware eﬃcient
manner using p = 4 layers of single qubit y rotations and
CNOT gates arranged in a chain topology. With these states,
we generate the M basis states S = {P x
is
one of the N -qubit Pauli strings consisting of identity I and
σx operators. a) NSS algorithm for Lov´asz Theta number for
the graph given in Fig.6 with N = 3 qubits. b) Bell non-local
game with N = 2 qubits.

i=1, where P x

i |ψ(cid:105)}M

i

G. Bell Non-Locality

Finally we apply the NSS to calculate the quantumly
achievable success probability for the canonical Bell non-
local game:
the Clauser Horn Shimony Holt (CHSH)
game [98–101]. The CHSH game involves two spacelike
separated parties, say Alice and Bob. A referee asks the
players uniformly random pairs of questions x, y ∈ {0, 1}.
The players have to answer a, b ∈ {0, 1} such that

a ⊕ b = x ∧ y.

(25)

Here ⊕ denotes addition modulo 2 and ∧ is the logical
AND operator. Using classical strategies, the maximum
probability of success for the CHSH game is upper
bounded by 0.75. However, using quantum resources
such as entangled states, the players can win the game
with probability cos2 (cid:0) π
(cid:1). The success probability for the
CHSH game can be calculated using a SDP. For details,
see Appendix D. We implemented the aforementioned
SDP using NSS in Fig.7b using the same ansatz as for the
Lov´asz Theta number and ﬁnd that for suﬃcient number
of basis states M we achieve the correct result.

8

VII. CONCLUSION

We presented the NSS for solving SDPs,

including
rank-constrained SDPs. Our algorithm runs on NISQ

123456782468M024|CCexact||0|1rand|2rand1234M02|CCexact||0|1rand|2randdevices without the need for classical-quantum feedback
loops, requiring only the measurement of overlaps on the
quantum computer. When the ansatz space is generated
by expanding an initial state |ψ(cid:105) with Pauli strings, these
overlaps can be measured by sampling the initial state |ψ(cid:105)
in a Pauli rotated basis (see Sec.IV).

The ground state problem expressed in terms of density
matrices is a SDP and hence a convex optimization
program. However, the SDP corresponding to the ground
state problem suﬀers from exponential scaling of the
dimension of the quantum state, rendering it diﬃcult to
solve on classical computers. To tackle the exponential
scaling of the dimension, VQEs employ optimization over
smaller dimensional ansatz space. However, the classical
optimization corresponding to VQEs is NP-hard, and the
landscape contains numerous far from optimal persistent
local minima [48, 53, 54]. We employed our NSS to
develop the NSE, a NISQ algorithm for the ground state
problem. The key idea of our NSE is to optimize over
a smaller number of parameters while preserving the
convexity of the original problem. Unlike VQEs, our
optimization program is convex, and thus every local
minimum is a global minimum. Moreover, the classical
optimization program of the NSE is a SDP that can
be solved in polynomial-time. Further, our NSS can
eﬃciently implement constraints on the solution space,
which is a well known challenge for VQAs [59].

The previously proposed quantum assisted eigensolver
and iterative quantum assisted eigensolvers [20, 21] are
special cases of our rank constrained SDP solver with
unit rank (see Appendix C). With our NSS, it is now
possible to solve many important problems that can be
formulated in terms of SDPs in a NISQ setting. Our
work unlocks the possibility of running one of the most
important algorithmic frameworks of classical computing
on NISQ computers and exploring the capabilities of
the current generation quantum computers. We can
use it to ﬁnd approximation of the ground state and
excited states of Hamiltonians, as well as solve symmetry
constrained problems. Further, we show how to use
NISQ computers to ﬁnd POVMs that unambiguously
discriminate states. We also implemented the NSS to
calculate Lov´asz Theta number, a graph invariant with
various applications, including in quantum contextuality.
Further, we used our algorithm to determine the
maximum winning probability of Bell nonlocal games.
We demonstrated the applicability of our algorithm

10

for ﬁnding the largest eigenvalue of 21000 dimensional
matrices.
In a recent work [102], it was shown that a
large family of rank- constrained SDPs can be written as
a convex optimization over separable two-party quantum
states. To solve the aforementioned convex optimization
problems, [102] provides a complete hierarchy of SDPs.
Based on this result and the techniques in our paper,
one can solve the rank-constrained NISQ SDP with a
hierarchy of NISQ SDPs.

Our work leads to many novel avenues for future
Investigating a systematic problem aware
research.
strategy for determining the initial state |ψ(cid:105) and the set
of basis states S used to construct the hybrid density
matrix will help improve as well as understand the NSS
and its rank constrained variants. It would be fascinating
to study our algorithms in the presence of noise [103].
Further, analysing our algorithms to render complexity-
theoretic statements is another exciting direction for
further investigation.

The ground state problem can be thought of as
quantum native problem in the sense that the exponential
scaling of the Hilbert space size makes it challenging to
solve with classical devices. This problem can be framed
as a convex optimization program over density matrices.
Thus, we could conceive the ground state problem as a
“convex quantum native problem”. In future, it would
be interesting to employ techniques from our work to
other convex quantum native problems from disciplines
such as quantum chemistry, condensed matter physics
and quantum information. As we numerically ﬁnd a clear
scaling law in number of qubits for the NSE, we believe
rigorous guarantees for the performance of our algorithm
for large system sizes can be proven.

The Quantum interior-point method [74] and quantum
multiplicative weight approaches [71–73] have been
proposed in the literature to solve SDPs.
It would
be interesting to develop the corresponding NISQ
algorithms. Extending our work to the general case of
cone programming seems another exciting direction.

Python code for the numerical calculations performed

are available at [104].

Acknowledgements— We thank Atul Singh Arora for
interesting discussions. We are grateful to the National
Research Foundation and the Ministry of Education,
Singapore for ﬁnancial support.

[1] F. Arute, K. Arya, R. Babbush, D. Bacon, J. C. Bardin,
R. Barends, R. Biswas, S. Boixo, F. G. Brandao, D. A.
Buell, et al., Nature 574, 505 (2019).

[2] H.-S. Zhong, H. Wang, Y.-H. Deng, M.-C. Chen, L.-C.
Peng, Y.-H. Luo, J. Qin, D. Wu, X. Ding, Y. Hu, et al.,
Science 370, 1460 (2020).

[3] J. Preskill, Quantum 2, 79 (2018).
[4] K. Bharti, A. Cervera-Lierta, T. H. Kyaw, T. Haug,

S. Alperin-Lea, A. Anand, M. Degroote, H. Heimonen,
J. S. Kottmann, T. Menke, W.-K. Mok, S. Sim, L.-
C. Kwek, and A. Aspuru-Guzik, Rev. Mod. Phys. 94,
015004 (2022).

[5] M. Cerezo, A. Arrasmith, R. Babbush, S. C. Benjamin,
S. Endo, K. Fujii, J. R. McClean, K. Mitarai, X. Yuan,
L. Cincio, et al., arXiv preprint arXiv:2012.09265
(2020).

11

[6] A. Peruzzo, J. McClean, P. Shadbolt, M.-H. Yung, X.-
Q. Zhou, P. J. Love, A. Aspuru-Guzik, and J. L. Obrien,
Nature communications 5, 4213 (2014).

[7] J. R. McClean, J. Romero, R. Babbush, and A. Aspuru-
Guzik, New Journal of Physics 18, 023023 (2016).
[8] A. Kandala, A. Mezzacapo, K. Temme, M. Takita,
M. Brink, J. M. Chow, and J. M. Gambetta, Nature
549, 242 (2017).

[9] E. Farhi,

J. Goldstone,

and

S. Gutmann,

arXiv:1411.4028 (2014).

arXiv preprint arXiv:2103.05500 (2021).

[37] J. J. Meyer, J. Borregaard, and J. Eisert, npj Quantum

Information 7, 1 (2021).

[38] J. J. Meyer, arXiv preprint arXiv:2103.15191 (2021).
[39] M. Schuld and N. Killoran, Phys. Rev. Lett. 122, 040504

(2019).

[40] V. Havl´ıˇcek, A. D. C´orcoles, K. Temme, A. W. Harrow,
A. Kandala, J. M. Chow, and J. M. Gambetta, Nature
567, 209 (2019).

[41] T. Kusumoto, K. Mitarai, K. Fujii, M. Kitagawa, and

[10] E. Farhi

and A. W. Harrow,

arXiv preprint

M. Negoro, arXiv:1911.12021 (2019).

arXiv:1602.07674 (2016).

[11] J. R. McClean, M. E. Kimchi-Schwartz, J. Carter, and
W. A. De Jong, Physical Review A 95, 042308 (2017).

[12] O. Kyriienko, npj Quantum Information 6, 1 (2020).
[13] R. M. Parrish and P. L. McMahon, arXiv preprint

arXiv: 1909.08925 (2019).

[42] E. Farhi and H. Neven, arXiv:1802.06002 (2018).
[43] K. Mitarai, M. Negoro, M. Kitagawa,

and K. Fujii,

Physical Review A 98, 032309 (2018).

[44] J. R. McClean, S. Boixo, V. N. Smelyanskiy,
R. Babbush, and H. Neven, Nature communications
9, 4812 (2018).

[14] T. A. Bespalova and O. Kyriienko, arXiv preprint

[45] K. Sharma, M. Cerezo, L. Cincio, and P. J. Coles, arXiv

arXiv:2009.03351 (2020).

preprint arXiv:2005.12458 (2020).

[15] W. J. Huggins, J. Lee, U. Baek, B. O’Gorman, and

[46] M. Cerezo, A. Sone, T. Volkoﬀ, L. Cincio, and P. J.

K. B. Whaley, New Journal of Physics (2020).

Coles, arXiv preprint arXiv:2001.00550 (2020).

[16] T. Takeshita, N. C. Rubin, Z. Jiang, E. Lee,
R. Babbush, and J. R. McClean, Physical Review X
10, 011004 (2020).

[17] N. H. Stair, R. Huang, and F. A. Evangelista, Journal
of Chemical Theory and Computation 16, 2236 (2020).
[18] M. Motta, C. Sun, A. T. Tan, M. J. O’Rourke, E. Ye,
and G. K.-L. Chan,

A. J. Minnich, F. G. Brand˜ao,
Nature Physics 16, 205 (2020).

[19] K. Seki and S. Yunoki, PRX Quantum 2, 010333 (2021).
[20] K. Bharti, arXiv preprint arXiv:2009.11001 (2020).
[21] K. Bharti and T. Haug, Physical Review A 104,

L050401 (2021).

[22] A. Cervera-Lierta, J. S. Kottmann, and A. Aspuru-

Guzik, PRX Quantum 2, 020329 (2021).

[23] Y. Li and S. C. Benjamin, Physical Review X 7, 021050

(2017).

[24] X. Yuan, S. Endo, Q. Zhao, Y. Li, and S. C. Benjamin,

[47] S. Wang, E. Fontana, M. Cerezo, K. Sharma, A. Sone,
L. Cincio, and P. J. Coles, Nature communications 12,
1 (2021).

[48] L. Bittel and M. Kliesch, Phys. Rev. Lett. 127, 120502

(2021).

[49] H.-Y. Huang, K. Bharti,

and P. Rebentrost, New

Journal of Physics 23, 113021 (2021).

[50] T. Haug, K. Bharti, and M. Kim, PRX Quantum 2,

040309 (2021).

[51] T. Haug and M. S. Kim, arXiv:2104.14543 (2021).
[52] M. Larocca, P. Czarnik, K. Sharma, G. Muraleedharan,
and M. Cerezo, arXiv preprint

P. J. Coles,
arXiv:2105.14377 (2021).

[53] E. R. Anschuetz, arXiv:2109.06957 (2021).
[54] X. You and X. Wu,

in International Conference on

Machine Learning (PMLR, 2021) pp. 12144–12155.
[55] O. Higgott, D. Wang, and S. Brierley, Quantum 3, 156

Quantum 3, 191 (2019).

(2019).

[25] M. Benedetti, M. Fiorentini, and M. Lubasch, arXiv

[56] N. C. Rubin, R. Babbush,

and J. McClean, New

preprint arXiv:2009.12361 (2020).

Journal of Physics 20, 053020 (2018).

[26] K. Bharti and T. Haug, Phys. Rev. A 104, 042418

(2021).

[27] S. Barison, F. Vicentini, and G. Carleo, Quantum 5,

512 (2021).

[28] B. Commeau, M. Cerezo, Z. Holmes, L. Cincio, P. J.

Coles, and A. Sornborger, arXiv:2009.02559 (2020).

[57] I. G. Ryabinkin, S. N. Genin,

and A. F. Izmaylov,
Journal of chemical theory and computation 15, 249
(2018).

[58] G. Greene-Diniz and D. Mu˜noz Ramo, International
Journal of Quantum Chemistry 121, e26352 (2021).
[59] K. Kuroiwa and Y. O. Nakagawa, Physical Review

[29] K. Heya, K. M. Nakanishi, K. Mitarai, and K. Fujii,

Research 3, 013197 (2021).

arXiv preprint arXiv:1904.08566 (2019).

[60] L. Vandenberghe and S. Boyd, SIAM review 38, 49

[30] C. Cirstoiu, Z. Holmes, J. Iosue, L. Cincio, P. J. Coles,
and A. Sornborger, npj Quantum Information 6, 1
(2020).

[31] J. Gibbs, K. Gili, Z. Holmes, B. Commeau,
A. Arrasmith, L. Cincio, P. J. Coles, and A. Sornborger,
arXiv preprint arXiv:2102.04313 (2021).

[32] J. W. Z. Lau, K. Bharti, T. Haug, and L. C. Kwek,

arXiv preprint arXiv:2101.07677 (2021).

[33] T.

Haug

and K.

Bharti,

arXiv

preprint

arXiv:2011.14737 (2020).

(1996).

[61] H. Wolkowicz, R. Saigal,
semideﬁnite

and L. Vandenberghe,
Handbook
theory,
programming:
algorithms, and applications, Vol. 27 (Springer Science
& Business Media, 2012).

[62] P. Skrzypczyk, I. ˇSupi´c, and D. Cavalcanti, Physical

of

review letters 122, 130403 (2019).

[63] J. Bae and L.-C. Kwek, Journal of Physics A:
Mathematical and Theoretical 48, 083001 (2015).
[64] M. Jeˇzek, J. ˇReh´aˇcek, and J. Fiur´aˇsek, Physical Review

[34] M. Otten, C. L. Cortes, and S. K. Gray, arXiv preprint

A 65, 060301 (2002).

arXiv:1910.06284 (2019).

[35] K. H. Lim, T. Haug, L. C. Kwek,

and K. Bharti,

Quantum Science and Technology 7, 015001 (2021).
[36] J. W. Z. Lau, T. Haug, L. C. Kwek, and K. Bharti,

[65] M. Ray, N. G. Boddu, K. Bharti, L.-C. Kwek,

and
A. Cabello, New Journal of Physics 23, 033006 (2021).
[66] K. Bharti, M. Ray, A. Varvitsiotis, A. Cabello, and

L.-C. Kwek, arXiv preprint arXiv:1911.09448 (2019).

12

[67] K. Bharti, M. Ray, A. Varvitsiotis, N. A. Warsi,
A. Cabello, and L.-C. Kwek, Physical review letters
122, 250403 (2019).

[68] K. Bharti, M. Ray, Z.-P. Xu, M. Hayashi, L.-C.
Kwek, and A. Cabello, arXiv preprint arXiv:2104.13035
(2021).

[69] T. H. Yang, T. V´ertesi, J.-D. Bancal, V. Scarani,
and M. Navascu´es, Physical review letters 113, 040401
(2014).

[70] J.-D. Bancal, M. Navascu´es, V. Scarani, T. V´ertesi, and
T. H. Yang, Physical Review A 91, 022115 (2015).
[71] F. G. Brand˜ao, A. Kalev, T. Li, C. Y.-Y. Lin, K. M.
and X. Wu, arXiv preprint arXiv:1710.02581

Svore,
(2017).

[72] J. Van Apeldoorn, A. Gily´en, S. Gribling,

and
R. de Wolf, in 2017 IEEE 58th Annual Symposium on
Foundations of Computer Science (FOCS) (IEEE, 2017)
pp. 403–414.

[73] J. van Apeldoorn and A. Gily´en, arXiv preprint

[92] A. Peres, Physics Letters A 128, 19 (1988).
[93] L. Lov´asz, IEEE Transactions on Information theory

25, 1 (1979).

[94] C. Budroni, A. Cabello, O. G¨uhne, M. Kleinmann, and
J.-˚A. Larsson, arXiv preprint arXiv:2102.13036 (2021).
[95] A. Cabello, S. Severini, and A. Winter, Physical review

letters 112, 040401 (2014).

[96] K. Bharti, T. Haug, V. Vedral, and L.-C. Kwek, AVS

Quantum Science 2, 034101 (2020).

[97] M. Howard, J. Wallman, V. Veitch, and J. Emerson,

Nature 510, 351 (2014).

[98] J. S. Bell, Physics (Long Island City, N.Y.) 1, 195

(1964).

[99] J. F. Clauser, M. A. Horne, A. Shimony, and R. A.

Holt, Phys. Rev. Lett. 23, 880 (1969).

[100] N. Brunner, D. Cavalcanti, S. Pironio, V. Scarani, and
S. Wehner, Reviews of Modern Physics 86, 419 (2014).
[101] V. Scarani, Bell nonlocality (Oxford University Press,

2019).

arXiv:1804.05058 (2018).

[102] X.-D. Yu, T. Simnacher, H. C. Nguyen, and O. G¨uhne,

PRX Quantum 3, 010340 (2022).

[103] E. N. Epperly, L. Lin,

and Y. Nakatsukasa,

arXiv:2110.07492 (2021).

[104] T. Haug and K. Bharti, “Nisq sdp solver,” https://

github.com/txhaug/nisq-sdp.

Appendix A: Hardware Eﬃcient Circuit

In Fig.8, we show the randomized quantum circuit that
we use as one of our ansatz states for our demonstration
examples for the NSS.

[74] I. Kerenidis and A. Prakash, ACM Transactions on

Quantum Computing 1, 1 (2020).
[75] F. G. Brandao and K. M. Svore,

in 2017 IEEE
58th Annual Symposium on Foundations of Computer
Science (FOCS) (IEEE, 2017) pp. 415–426.

[76] S. Chakrabarti, A. M. Childs, T. Li,

and X. Wu,

Quantum 4, 221 (2020).

[77] J. van Apeldoorn, A. Gily´en, S. Gribling,

and

R. de Wolf, arXiv:1809.00643 (2018).

[78] M. Larocca, N. Ju, D. Garc´ıa-Mart´ın, P. J. Coles, and

M. Cerezo, arXiv:2109.11676 (2021).

[79] K. Mitarai and K. Fujii, Physical Review Research 1,

013006 (2019).
[80] S. Aaronson

and

L. Chen,

arXiv

preprint

arXiv:1612.05903 (2016).

[81] E. Marianna, M. Laurent, A. Varvitsiotis, et al., in
Discrete Geometry and Optimization (Springer, 2013)
pp. 105–120.

[82] S. Boyd, L. El Ghaoui, E. Feron, and V. Balakrishnan,
Linear matrix inequalities in system and control theory
(SIAM, 1994).

[83] M. F. Anjos and J. B. Lasserre, Handbook on
semideﬁnite, conic and polynomial optimization, Vol.
166 (Springer Science & Business Media, 2011).

[84] S. Boyd and L. Vandenberghe, Convex optimization

(Cambridge university press, 2004).

[85] T. Kadowaki and H. Nishimori, Physical Review E 58,

5355 (1998).

[86] R. Wiersema, C. Zhou, Y. de Sereville, J. F.
Carrasquilla, Y. B. Kim, and H. Yuen, PRX Quantum
1, 020319 (2020).

[87] C. Lanczos, Journal of Research of the National Bureau

FIG. 8. Circuit of N qubits to generate ansatz state |ψ(cid:105). It
consists of p layers of N single qubit rotations around the
y axis with randomized parameters θl,i, followed by CNOT
gates arranged in a nearest-neighbor chain topology.

of Standards 45 (1950).

[88] Y. Saad, SIAM Journal on Numerical Analysis 29, 209

(1992).

[89] B. T. Gard, L. Zhu, G. S. Barron, N. J. Mayhall, S. E.
Economou, and E. Barnes, npj Quantum Information
6, 1 (2020).

[90] C. Kokail, C. Maier, R. van Bijnen, T. Brydges, M. K.
Joshi, P. Jurcevic, C. A. Muschik, P. Silvi, R. Blatt,
C. F. Roos, et al., Nature 569, 355 (2019).

[91] A. Choquette, A. Di Paolo, P. K. Barkoutsos,
and A. Blais, Physical

D. S´en´echal, I. Tavernelli,
Review Research 3, 023092 (2021).

Appendix B: Proof for Positive Semideﬁnte Hybrid
Density Matrix

Here, we show that the hybrid density matrix Xβ is
positive semideﬁnite when the coeﬃcient matrix β is
positive semideﬁnite.
Claim 2. Xβ (cid:60) 0 if and only if β (cid:60) 0.

p layers13

Proof. We have

T r (CXα) translates to

Xβ (cid:60) 0 ⇐⇒

(cid:88)

βi,j(cid:104)x|ψi(cid:105)(cid:104)ψj|x(cid:105) ≥ 0 ∀ |x(cid:105) ∈ H.

α†Dα,

For a vector cx of size M, deﬁned via cx
have

i ≡ (cid:104)x|ψi(cid:105), we

where

Xβ (cid:60) 0 ⇐⇒ (cx)† βcx ≥ 0 ∀ |x(cid:105) ∈ H.

Da,b =

(cid:88)

k

sk(cid:104)ψb|Uk|ψa(cid:105).

Thus,

The constraints T r (AiXα) = bi translate to

Xβ (cid:60) 0 ⇐⇒ β (cid:60) 0 .

α†E (i)α = bi

Appendix C: Rank Constrained SDPs

where

E (i)
a,b =

(cid:88)

l

fi,l(cid:104)ψb|U (i)

l

|ψa(cid:105).

We now study rank constrained SDPs. Note that
solving rank-constrained SDPs is NP-hard. The famous
max cut problem with n × n weight matrix W admits the
following rank one constrained SDP.

in the ansatz space, the standard form rank-

Thus,
constrained SDP reduces to

min α†Dα

(C2)

max

1
2

Tr (W X)

s.t. Xi,i = 1 ∀i ∈ [n],
X (cid:60) 0,
rank(X) <= 1.

1. The Rank 1 Case

We have the following ansatz

xα =

(cid:88)

i

αi|ψi(cid:105)

Xα = xαx†
α

Xα =

(cid:88)

i,j

α†

jαi|ψi(cid:105)(cid:104)ψj|

(C1)

s.t. α†E (i)α = bi

∀i ∈ [m] . This is a quadratically constrained quadratic
program (QCQP). The quantum assisted eigensolver and
iterative quantum assisted eigensolver [20, 21] can be
framed as QCQP of the form of program C2.

2. The Rank k Case

We have the following ansatz.

xp
α =

Xα,γ =

(cid:88)

i

k
(cid:88)

p=1

αp

i |ψi(cid:105)

γpxp†

α xp
α

By construction,

Xα (cid:60) 0

to the positive semideﬁnite cone
This corresponds
constraint and holds for all values of α. Also notice that

X †

α = Xα

by construction and thus Xα is Hermitian. Let us assume
that

and

C =

(cid:88)

k

βkUk

Ai =

(cid:88)

l

fi,lU (i)
l

.

Xα,γ =

(cid:88)

i,j,p

By construction,

γpαp†

j αp

i |ψp

i (cid:105)(cid:104)ψp
j |

Xα,γ (cid:60) 0

for γp ≥ 0 ∀p ∈ [k]. This corresponds to the positive
semideﬁnite cone constraint and holds for all values of
αp. Also notice that

X †

α,γ = Xα,γ

by construction and thus Xα,γ is Hermitian. Let us
assume that

C =

(cid:88)

k

skUk

and

Ai =

(cid:88)

l

fi,lU (i)
l

.

T r (CXα,γ) translates to

k
(cid:88)

p=1

γpαp†Dpαp,

where

Dp

a,b =

(cid:88)

k

sk(cid:104)ψp

b |Uk|ψp

a(cid:105).

The constraints T r (AiXα,γ) = bi translate to

k
(cid:88)

p=1

γpαp†E p(i)αp = bi

where

E p(i)
a,b =

(cid:88)

l

fi,l(cid:104)ψp

b |U (i)

l

|ψp

a(cid:105).

in the ansatz space, the standard form rank-

Thus,
constrained SDP for general k reduces to

min

k
(cid:88)

p=1

γp (cid:0)αp†Dpαp(cid:1)

(C3)

s.t.

k
(cid:88)

p=1

γp (cid:16)

αp†E p(i)αp(cid:17)

= bi ∀i ∈ [m]

γp ≥ 0 ∀p ∈ [k].

Appendix D: XOR Games SDP Formulation

Deﬁnition 3. Two prover game: Given a predicate V :
X × Y × A × B → {0, 1} and a probability distribution
π on X × Y, a two prover game G = (X , Y, A, B, V, π)
involves two provers and one veriﬁer, which proceeds as
follows:

1. The veriﬁer samples a pair of questions (x, y) ∈
X × Y according to the probability distribution π.

2. The veriﬁer sends x and y to the two provers and
receives answers a ∈ A and b ∈ B respectively.

3. The veriﬁer applies the predicate V : X × Y × A ×
B → {0, 1} and accepts the answers if the outcome
is 1, rejects otherwise.

14

Deﬁnition 4. Unique two prover game: A two prover
game G = (X , Y, A, B, V, π) where the predicate V : X ×
Y × A × B → {0, 1} returns value 1 iﬀ b = πx,y (a), 0
otherwise for (x, y) ∈ X × Y and outputs a, b ∈ A × B.
Here πx,y is a permutation of [k].

Deﬁnition 5. XOR game: A unique two prover game
with alphabet size 2 is known as XOR game. XOR games
are restricted form of two prover nonlocal game where
A = B = {0, 1}and the predicate V takes the form
(cid:40)
1
0

if a ⊕ b = f (x, y)
if a ⊕ b (cid:54)= f (x, y)

V (a, b, x, y) =

(D1)

for some given function f : X ×Y → {0, 1} . The function
f determines whether the two parties should agree or
disgree for each question pair (x, y).

The maximum probability of success that the two
provers can achieve is known as value of the game and
often denoted by val(G) . For a given XOR game G and
any strategy, the bias of that strategy is the probability
it wins minus probability it loses. The bias of a XOR
game G is the supremum bias over all possible strategies.
Let us denote the supremum bias as (cid:15)(G). It is easy to
see that

val (G) = 0.5 + 0.5 ∗ (cid:15)(G)

(D2)

For every XOR game G, we further deﬁne a matrix D as

D(x, y) = π(x, y)(−1)f (x,y,

(D3)

where f determines the value of the predicate V
according to D1 Using D, one can further deﬁne a
symmetric matrix H as

H =

(cid:19)

(cid:18) 0 D
DT 0

.

1
2

(D4)

The bias of an XOR game is formulated via H as the
following SDP

max T r (HZ) ,
s.t. Zi,i = 1 ∀i ∈ [h],
Z (cid:60) 0,
Z ∈ S n
+.

(D5)

Here, h denotes the size of the H matrix. For the CHSH
game, we have fCHSH (x, y) = x∧y where ∧ is the logical
AND operator. Thus, the D matrix for the CHSH game
is given by

DCHSH =

(cid:18)0.25 0.25
0.25 −0.25

(cid:19)

.

Appendix E: Scaling of NSE for transverse and
longitudinal Ising model

The size of the sets A and B, say some integer value k
is assumed to be equal and is referred to as alphabet size
of the two prover game.

Here, we study the non-integrable Ising model with
transverse and longitudinal ﬁelds combined with a

15

discretized quantum annealing state as function of
number of qubits N . We vary the parameters of
layers of the
the Hamiltonian and the number of
quantum annealing state. The initial state has an
error ∆EQA = EQA − Eg, where EQA is the energy of
thequantum annealing state and Eg the exact ground
state. We plot the improvement ∆EQA/∆ENSE of NSE
in estimating the ground state. We ﬁnd for all cases that
∆EQA/∆ENSE collapses to a single curve for suﬃcient
number of qubits when plotted against number of ansatz
states divided by number of qubits M ∗ = M
3N . The result
is shown in Fig.9. We ﬁnd a collapse to a single curve for
all cases for suﬃciently large N . We ﬁnd that the NSE
yields even better results when increasing the ﬁeld h of
the Ising model or layers p of the quantum annealing
state. For h = 1
2 , we ﬁnd that the collapse becomes
evident only for larger number of qubits N compared
to the other cases, which we suspect is due to quantum
annealing providing worse estimates of the ground state
energy when h is small.

a

c

b

d

FIG. 9.
We show the scaling with N of the relative
improvement ∆EQA/∆ENSE. Here, ∆ENSE is the error
∆ENSE = ENSE − Eg of the NSE and ∆EQA = EQA − Eg
the error of the quantum annealing state. The relative
improvement collapses to a single curve for varying number
of ansatz states M ∗ = M/(3N ) divided by number of qubits.
We vary transverse ﬁeld h and number p = cN of layers
of quantum annealing. a) h = 2 and p = N/2 with ﬁt
∆EQA/∆ENSE = 9M ∗6 + 1.5M ∗ + 1. b) h = 1
2 and p = N/2
with ﬁt EQA/∆ENSE = 0.7M ∗ + 1. c) h = 1 and p = N
with ﬁt ∆EQA/∆ENSE = 4.2M ∗4 + 1.2M ∗ + 1. d) h = 1 and
p = N/4 with ﬁt ∆EQA/∆ENSE = 1.4M ∗3 + 1.2M ∗ + 1. We
ﬁx the ﬁeld g = 1 for all curves.

0.000.250.500.751.00M051015EQA/ENSEN=8N=10N=12N=14N=16N=18N=20fit0.000.250.500.751.00M012EQA/ENSE0.000.250.500.751.00M0510EQA/ENSEN=8N=10N=12N=14N=16N=18N=20fit0.000.250.500.751.00M024EQA/ENSEN=8N=10N=12N=14N=16N=18N=20fit