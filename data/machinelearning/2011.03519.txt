A Data-Driven Machine Learning Approach for 
Consumer Modeling with Load Disaggregation 

A. Khaled Zarabie, Sanjoy Das*, and Hongyu Wu 
Electrical & Computer Engineering, Kansas State University. 
*Corresponding author: sdas@ksu.edu 

1 

Abstractâ€”While  non-parametric  models,  such  as  neural 
networks, are sufficient in the load forecasting, separate estimates 
of  fixed  and  shiftable  loads  are  beneficial  to  a  wide  range  of 
applications  such  as  distribution  system  operational  planning, 
load  scheduling,  energy  trading,  and  utility  demand  response 
is  usually 
programs.  A  semi-parametric  estimation  model 
required,  where  cost  sensitivities  of  demands  must  be  known. 
Existing  research  work  consistently  uses  somewhat  arbitrary 
parameters  that  seem  to  work best.  In  this  paper,  we  propose  a 
generic class of data-driven semiparametric models derived from 
consumption data of residential consumers. A two-stage machine 
learning approach is developed. In the first stage, disaggregation 
of the load into fixed and shiftable components is accomplished by 
means  of  a  hybrid  algorithm  consisting  of  non-negative  matrix 
factorization (NMF) and Gaussian mixture models (GMM), with 
(EM) 
the 
algorithm.  The  fixed  and  shiftable  loads  are  subject  to  analytic 
treatment with economic considerations. In the second stage, the 
model  parameters  are  estimated  using  an  L2-norm,  Ïµ-insensitive 
regression approach. Actual energy usage data of two residential 
customers show the validity of the proposed method.   

trained  by  an  expectation-maximization 

latter 

Index  Termsâ€”Cobb-Douglas  Preference,  Disaggregation, 
Gaussian  Mixture  Model,  Non-negative  Matrix  Factorization, 
Semi-parametric Model, Unsupervised Learning, Utility. 

I.  INTRODUCTION 

T 

HE overarching goal of this paper is to develop a framework 
to  model  a  residential  unitâ€™s  daily  energy  consumption 
patterns, factoring in cost and temperature dependencies, using 
non-intrusive smart meter data. Load disaggregation lies at the 
core of the proposed approach.  
  Unlike  earlier  methods  that  attempt  to  extract  usages  of 
individual appliances, disaggregation in this research separates 
the load into only two components, (i) shiftable loads, and (ii) 
fixed  loads,  with  only  the  latter  responsive  to  time-of-use 
(TOU)  pricing  and  ambient  temperatures.  The  proposed 
unsupervised  learning  method  for  load  disaggregation  is  a 
hybrid  algorithm  that  applies expectation-maximization  (EM) 
to train a Gaussian mixture model (GMM), with non-negative 
matrix factorization (NMF). 

A  meaningful,  nonlinear  utility  model  of  the  residence, 
which is grounded on classical econometrics and game theory, 
is proposed here. The disaggregated loads are used to estimate 
the parameters of this model. Regression with an Ïµ-insensitive, 
L2-norm  loss  function  is  applied  to  minimize  the  mismatch 
between 
the 
corresponding disaggregated loads. 

the  modelâ€™s  predicted  energy  use  and 

A.  Literature Survey 

Recent  advancements  in  machine  learning  have  made  it 
possible to disaggregate residential loads obtained from smart 
meters  into  smaller  components.  Some  algorithms  for  load 
disaggregation rely on supervised or semi-supervised learning, 
which require a set of training data where the individual loads 
are known a priori [1]. Deep neural networks are an example of 
such a method [2], [3], [4], [5]. Unfortunately, these approaches 
are  not  suitable  for  non-intrusive  load  monitoring  where  the 
only available data is in the form of smart meter readings, even 
during the training phase.  

Several other approaches tailored for energy disaggregation 
have  been  proposed.  Among  them  include  [6]  that  uses  the 
fuzzy c-means clustering to identify the number of appliances. 
Quadratic  programming  has  been  used 
[7].  A 
computationally efficient additive neural network is used in [8], 
with  a 
training  algorithm  called  cogent 
confabulation.  The  approach  in  [8]  relies  on  OFF-ON 
transitions to detect individual appliances. It also uses bagging 
(an ensemble learning technique) for improved classification of 
appliances.  Two  novel  algorithms  based  on  spectral  graph 
theory  have  been  applied  for  disaggregation  in  [9]  whereas 
fuzzy logic has been adopted in [10]. 

specialized 

in 

Hidden  Markov  models  (HMM)  are  a  popular  choice  of 
modeling  individual  appliances.  Individual  appliances  are 
represented  using  two  or  more  states,  with  transition  and/or 
emission  probabilities  usually  learned  from  a variation  of  the 
EM  algorithm.  In  [11],  the  total  number  of  appliances  are 
determined  using  K-means  clustering.  An  improved  method 
proposed in [12] that models appliances using factorial HMMs. 
Other  extensions  to  represent  appliances  include  explicit 
HMMs [13] and hierarchical HMMs [14] for load modeling. 

The  EM  algorithm  is  also  used  to  train  Gaussian  mixture 
models  (GMM)  [15].  GMMs  are  based  on  probability  theory 
that  usually  apply  the  maximum  likelihood  criterion  for 
appliance classification. These approaches assume the presence 
of a set of â€˜latentâ€™ variables zğ‘—, where ğ‘— is an index, with only 
one being â€˜activeâ€™ at each time. The output follows a Gaussian 
probability distribution that is uniquely identified by the active 
latent  variable.  The  algorithm  proposed  in  [15]  is  based  on 
GMMs.  The  approach  uses  the  Dempster-Shaffer  theory  for 
appliance classification. 

unsupervised 

Non-negative matrix factorization (NMF) is another widely 
used, 
energy 
disaggregation.  The  classical  NMF  algorithm  decomposes  an 
input  data  matrix ğ—,  whose  columns  are  sample  vectors,  into 
two factors, ğ– and ğ‡, so that their product equals ğ—. Usually, 

approach 

learning 

for 

 
 
 
ğ— has a very large number of columns, which are independent 
samples. The columns of ğ– serve as basis vectors so that each 
sample  ğ±(ğ‘›), ğ‘› âˆˆ ğ’© ,  which  are  columns  of  ğ—  can  be 
represented as  a  weighted  combination  of  the bases,  with the 
non-negative weights being the corresponding column vectors 
ğ¡(ğ‘›) of ğ‡.  NFM  has  been  used  for  energy  disaggregation  of 
HVAC load components in an industrial building and in a smart 
home setting [16]. Another method has been proposed in [17], 
[18] to impose ğ¿0 constraints, which uses a softmax distribution 
for  the  elements  in  ğ‡  to  assign  weights  to  them  in  such  a 
manner that those with higher values are likelier to improve the 
objective 
function.  Semi-supervised  NMF  using  prior 
knowledge of the usage time profiles of individual appliances 
has been proposed in [1]. NMF has been applied for data over 
larger  periods  in  time  to  retrieve  seasonal  trends  in  usage 
profiles in [19]. 

Disaggregated  loads  are  used  in  this  research  to  derive 
nonlinear  utility  models  of  residential  consumers.  In  [20], 
generation  side  utilities  are  modeled  as  piecewise  linear 
functions so that linear programming can be applied for energy 
auctioning.  A  linear  utility  function  is  also  used  in  [21]  for 
individual  appliances,  with  customers  trying  to maximize  the 
sum  of  all  such  utilities.  However,  it  should  be  noted  that 
linearization is not suitable in many other applications as they 
do not encapsulate the dependence of utility to price changes. 
For  this  reason,  recent  research  proposals  routinely  represent 
utilities  using  saturating  nonlinearities.  In  [22]  customersâ€™ 
behavior based utility functions are modeled in this manner. In 
the  double  auction  mechanism  described  in  [23]  participantsâ€™ 
bidding  strategies  are  determined  from  nonlinear  utilities  of 
individual goods. Similarly, in  [24], nonlinear functions have 
been used to quantify the utility of a potential user from pricing 
and QoS. 

Logarithmic functions are commonly used to model utilities 
nowadays.  The  double  auctions  in  [23]  make  use  of  such 
utilities.  Portfolio  optimization  using  power-log  utilities  are 
taken up in [25]. The approach in [24] uses log-concave utility 
functions. In [26], logarithmic utilities are also used to quantify 
the benefit derived from operating shiftable appliances. In [27], 
[28], [29] residential consumersâ€™ utilities have been modeled as 
logarithms in energy market games. In [28], log utilities have 
been used to represent aggregator payoffs. Logarithmic utilities 
have also beeen used in [30], [31], in a Stackelberg game based 
model of energy trade in the grid. 

B.  Research Contributions 

The novelties of the research that this paper entails are listed 

as follows. 

(i) A fully non-intrusive approach for load disaggregation is 
proposed.  This  is  an  improvement  not  only  over  supervised 
learning  approaches  but  also  those  that  use  unsupervised 
learning  such  as  GMMs,  HMMs,  or  NMF,  most  of  which 
require some form of prior information about the consumption 
patterns  of  individual  appliances.  Therefore,  the  proposed 
approach can be entirely trained in real-time after deployment. 
(ii)  Disaggregation  in  this  research  is  accomplished  with  a 
hybrid  algorithm  that  harnesses  the  synergy  of  GMMs  and 

2 

NMF. GMMs are most effective in learning the load patterns of 
binary OFF-ON shiftable appliances as well as those operating 
at  only  a  few  discrete  levels,  whereas  NMF  approaches  are 
suitable to iteratively obtain basis sets to represent fixed loads 
whose energy consumption levels cannot be discretized readily.  
(iii)  A  semi-parametric  consumer  utility  model  has  been 
proposed,  which  represents  the  appropriate  tradeoff  between 
parametric and non-parametric models. For many applications, 
it suffices to distinguish only between fixed and cost dependent 
components of the load. Additionally, the present utility model 
considers temperature dependence of energy consumption. 

(iv) Parameter estimation of the consumer utility model has 
been  formulated  in  terms  of  ğ¿2 -norm  maximum  margin 
regression. The use of the utility model as a means to validate 
the  performance  of  the  disaggregation  algorithm  has  been 
proposed. 

Fig.  1.  Isoquants  for  Cobb-Douglas  preference  (black),  perfect 
substitution  (blue,  dashed)  and  perfect  complementarity  (red, 
dashed). The coordinates represent resource usages. 

ğ‘¡âˆˆğ’¯

ğ‘“ + ğ‘¥ğ‘¡

ğ‘“ and ğ‘¥ğ‘¡

,  and ğ±ğ‘  = [ğ‘¥ğ‘¡

II.  OVERVIEW OF APPROACH 
It  is  assumed  that  any  userâ€™s  energy  usage ğ‘¥ğ‘¡  at  any  time 
ğ‘  +
instant ğ‘¡ is  divided  into  two  components,  i.e. ğ‘¥ğ‘¡ = ğ‘¥ğ‘¡
ğ‘  are the fixed and shiftable loads, and ğœ‚ğ‘¡ is 
ğœ‚ğ‘¡, where ğ‘¥ğ‘¡
random  noise.  We  define  the  following  vectors, ğ± = [ğ‘¥ğ‘¡]ğ‘¡âˆˆğ’¯, 
ğ‘“]
ğ‘ ]ğ‘¡âˆˆğ’¯ .  Each  quantity  is  a |ğ’¯| Ã— 1 
ğ±ğ‘“ = [ğ‘¥ğ‘¡
vector,  where  ğ’¯  is  the  set  of  all  time  instances.  The  time 
instances  ğ‘¡ âˆˆ ğ’¯  are  divided  into  a  set  of  non-overlapping 
periods, with each period including exactly ğ¿ instances. The set 
of periods is denoted as ğ’¦ so that ğ¿ = |ğ’¦|âˆ’1|ğ’¯|. For example, 
if  the  time  instances  are  of  a  minute  duration  each,  that  are 
divided up into hour-long periods, then |ğ’¯| = 1440 mins/day, 
|ğ’¦| = 24  hours/day,  and  ğ¿ = 60  mins/hour.  Within  each 
period  ğ‘˜ âˆˆ ğ’¦  we  define  the  ğ¿ Ã— 1  vectors  ğ±ğ‘˜
, 
ğ‘  = [ğ‘¥ğ‘¡
ğ‘ ]ğ“€(ğ‘¡)=ğ‘˜ ,  where  ğ“€(âˆ™)  is  a  mapping  ğ“€: ğ’¯ â†’ ğ’¦  that 
ğ±ğ‘˜
provides  the  period  index  corresponding  to  a  time  instance ğ‘¡. 
The  temperature  vector  ğ›‰ = [ğœƒğ‘˜]ğ‘˜âˆˆğ’¦  and  the  vector  of  unit 
costs ğœ = [ğ‘ğ‘˜]ğ‘˜âˆˆğ’¦ are the other ğ¿ Ã— 1 vectors used here. 

ğ‘“]
ğ‘“ = [ğ‘¥ğ‘¡

ğ“€(ğ‘¡)=ğ‘˜

 
 
 
 
 
The  dataset  used  in  this  research  consists  of  multiple 
samples, where each sample pertains to a day. Accordingly, we 
define  the  load  matrices, ğ— = [ğ±(ğ‘›)]ğ‘›âˆˆğ’© , ğ—ğ‘“ = [ğ±ğ‘“(ğ‘›)]ğ‘›âˆˆğ’© , 
and ğ—ğ‘  = [ğ±ğ‘ (ğ‘›)]ğ‘›âˆˆğ’© ,  of  dimensionalities |ğ’¯| Ã— |ğ’©|,  where 
ğ’© is the set of samples and sample index ğ‘› indicates a day. The 
|ğ’¦| Ã— |ğ’©| matrix of temperatures is ğš¯ = [ğ›‰(ğ‘›)]ğ‘›âˆˆğ’©. The cost 
vector ğœ is constant across all samples in ğ’©. 

Fig. 2. A typical utility function (top) and its derivative, the 
marginal  utility  (bottom).  The  marginal  utility  is  also  the 
unit cost of energy. 

A.  Load Model 

Appliances that are used intermittently by a typical residence 
make  up  the  shiftable  loads,  such  as  washer/dryer  units  or 
PHEVs.  When  in  operation  they  consume  a  large  amount  of 
energy that can be discretized into a few levels. Smart homes 
schedule  these  appliances  based  on  the  instantaneous  cost  of 
electricity.  Some  shiftable  loads  (e.g.  air-conditioners)  are 
temperature dependent, their use being comfort-driven. Fixed 
loads  pertain  to  appliances  that  are  deemed  essential  in  any 
residence,  such  as  lighting  and  refrigeration.  Consequently 
energy  pricing  has  little  bearing  on  their  operation.  With  the 
exception of refrigerators, fixed loads cannot be characterized 
as discrete loads. Their energy consumption is lower than that 
in fixed loads. Unlike shiftable loads, fixed load appliances are 
operated throughout the day. 

It is assumed that the fixed load at any period ğ‘˜ consists of a 

temperature independent and dependent terms so that, 

Tğ±ğ‘˜

ğ‘“ = ğŸğ¿

ğ‘“ = ğ‘ğ‘˜ + ğ‘ğ‘˜ğœƒğ‘˜.
(1) 
ğ‘¥Ì‚ğ‘˜
ğ‘“  is  the 
Here ğ‘ğ‘˜  and ğ‘ğ‘˜  are  two  model  parameters, ğ‘¥ğ‘˜
total fixed load and ğœƒğ‘˜ is the temperature during that period. It 
may be noted that ğ‘ğ‘˜ = 0 in most cases as fixed loads do not 
ğ‘“ 
depend on outside temperature. The â€˜hatâ€™ (âˆ™Ì‚) appearing over ğ‘¥ğ‘˜
in (1) indicates that it is a modeled load (as opposed to a real 
load obtained from the available input data). Shiftable loads are 
modeled using econometric principles that are described next. 
Consider  a  market  with  two  divisible  resources,  indexed  1 
and 2. Suppose  the amounts  of each resource  consumed by  a 
consumer  are ğ‘¥1  and ğ‘¥2 .  The  consumerâ€™s  preference  can  be 
quantified  in  terms  of  the  function  ğ‘¦(ğ‘¥1, ğ‘¥2) .  When  the 
resources  display  perfect  complementarity,  the  consumerâ€™s 

3 

preference  can  be  expressed  as ğ‘¦(ğ‘¥1, ğ‘¥2) = min(ğ‘1ğ‘¥1, ğ‘2ğ‘¥2), 
where ğ‘1  and ğ‘2  are  two  constants  based  on  the  consumerâ€™s 
individual  characteristics.  On  the  other  hand,  when  the 
resources are perfect substitutes of each other, then ğ‘¦(ğ‘¥1, ğ‘¥2) =
ğ‘1ğ‘¥1 + ğ‘2ğ‘¥2 .  The  Cobb-Douglas  function  [32]  is  frequently 
used as the preference when the two resources are intermediate 
between  being  perfect  complements  and  perfect  substitutes. 
The schematic in Fig. 1. shows the shape of a typical isoquant 
for  the  Cobb-Douglas  preference.  For  comparison,  isoquants 
for  perfect  substitutes  and  perfect  complements  are  also 
provided. In the present case with two resources, the preference 
ğ‘2 .  In  general,  with  ğ± 
can  be  expressed  as  ğ‘¦(ğ‘¥1, ğ‘¥2) = ğ‘¥1
representing  the  vector  of  all  resources,  the  Cobb-Douglas 
preference  is ğ‘¦(ğ±) = âˆ (ğ‘¥ğ‘˜)ğ‘ğ‘˜
,  (ğ‘˜ = 1,2, â€¦).  The parameters 
ğ‘ğ‘˜ > 0  are  referred  to  as  elasticity  constants.  The  Cobb-
Douglas preference is widely used to model resource usage. 

ğ‘1ğ‘¥2

ğ‘˜

Since the original Cobb-Douglas preference function serves 
as a production function, it becomes zero if any component of 
the final product, ğ‘¥ğ‘˜ = 0. In the present application, each factor 
is incremented by 1 to prevent this from happening, so that each 
ğ‘  + 1)ğ‘ğ‘˜. The logarithm of the 
factor in ğ‘¦(ğ±ğ‘ ) is of the form, (ğ‘¥ğ‘˜
modified  Cobbâ€“Douglas  preference  is  chosen  as  the  utility 
function in this research. Treating the logarithm of the  Cobb-
Douglas preference in this manner, renders the utility function: 
(i) non-decreasing, (ii) strictly concave, (iii) intersecting at the 
origin at ğ±ğ‘  = ğŸ, indicating that a consumer can glean no utility 
without  consuming  energy,  and  (iv)  Lipschitz  continuous. 
These are highly desirable features of the utility function, the 
first three being mandated by the well-known economic precept 
known  as  the  law  of  diminishing  returns,  while  the  fourth 
making the function suitable for mathematical treatment. 

Accordingly,  the  expression  for  the  utility  used  in  this 

research is given by the following, 
ğ‘¢(ğ±ğ‘ ) = âˆ‘ ğ‘ğ‘˜ log ((ğ‘¥ğ‘˜
ğ‘˜âˆˆğ’¦

ğ‘  âˆ’ (ğ‘ğ‘˜ + ğ‘‘ğ‘˜ğœƒğ‘˜))

+ 1)

.

+

(2) 

The quantity ğ‘ğ‘˜ is the base component of the shiftable load that 
is determined by extraneous, non-economic factors (e.g. it is not 
practicable  for  a  washer/dryer  unit  to  be  put  into  use  at  2:00 
AM). The term ğ‘‘ğ‘˜ğœƒğ‘˜ is the temperature dependent component 
ğ‘  (which is predominantly due to air conditioning). For this 
of ğ‘¥ğ‘˜
ğ‘  in (2). The operator 
reason, (ğ‘ğ‘˜ + ğ‘‘ğ‘˜ğœƒğ‘˜) is subtracted from ğ‘¥ğ‘˜
(âˆ™)+ restricts the enclosed argument to be non-negative. 

Generally speaking, the energy consumption increases when 
the ambient temperature deviates in either direction from some 
desired  value,  say  ğœƒdes  that  is  considered  to  be  most 
comfortable to the occupants of a residential unit. Under these 
circumstances  a  temperature  dependent  term  ğ‘‘|ğœƒğ‘˜ âˆ’ ğœƒdes| 
ğ‘  so that the perceived utility 
should have been removed from ğ‘¥ğ‘˜
is  lowered  in  either  direction  by  the  difference  between  the 
temperature  from  the desired value.  However,  as  the  specific 
data  used  in  this  research  involved  only  warmer  days,  it  is 
assumed that ğœƒğ‘˜ > ğœƒdes thereby justifying the inclusion of the 
linear  term ğ‘‘ğ‘˜ğœƒğ‘˜ in  (2).  This  approach  also  avoids  using  the 
non-differentiable absolute operator |âˆ™|. 

loadunit costloadutility 
 
 
 
 
ğ‘  is the agentâ€™s 
  The derivative of ğ‘¢(ğ±ğ‘ ) with respect to any ğ‘¥ğ‘˜
marginal  utility,  which  is  also  equal  to  the  unit  cost  ğ‘ğ‘˜ . 
Accordingly, it can be readily established using (2) that, 

ğ‘  = ğ‘ğ‘˜
ğ‘¥Ì‚ğ‘˜

âˆ’1ğ‘ğ‘˜ + ğ‘ğ‘˜ + ğ‘‘ğ‘˜ğœƒğ‘˜.   

(3) 
ğ‘   into 
The  above  expression  splits  the  model  shiftable  load ğ‘¥Ì‚ğ‘˜
cost  dependent,  constant,  and  temperature  dependent  terms. 
Fig. 2. illustrates how the utility and its derivative, the unit cost, 
vary  with  energy  use.  The  utility  is  strictly  concave  in 
accordance with the law of diminishing returns. Although the 
unit cost is shown as a function in Fig. 2., in energy auctions 
the unit cost is usually determined by the DSO or aggregator, 
with  each  consumer  agent 
the 
corresponding amount of energy [26],[27],[28],[29]. 

responding  by  using 

B.  Modeling Steps  

The load matrix ğ—, the temperature matrix ğš¯, and the vector 
ğœ of unit costs are the three input data sets. Load disaggregation 
is carried out using the hybrid approach proposed here, with the 
GMM  associated  with  shiftable  loads  and  NMF  with  fixed 
loads.  The  hybrid  NMF-GMM  disaggregation  algorithm 
produces  matrices  of  fixed  loads ğ—Ìƒğ‘“ ,  and  shiftable  loads ğ—Ìƒğ‘  , 
which serve as the input to the regression algorithm that yields 
the parameters associated with the consumer utility model. Fig. 
3. illustrates the various steps involved. 

Fig.  3.  Steps  involved  in  the  proposed  approach.  Thicker  grey 
arrows  indicate  the  directions  of  data  flow  whereas  thinner, 
colored arrows represent parameter flow. 

III.  LOAD DISAGGREGATION 

A.  Gaussian Mixture Model 

The shiftable loads are represented in our framework in terms 
of a Gaussian mixture model (GMM). The ğ‘—th prior, mean, and 
2, which are trainable parameters with 
variance are Ï€ğ‘— ğœ‡ğ‘—, and ğœğ‘—
the exception of ğœ‡0 which is permanently assigned a value ğœ‡0 =
0 to represent the case when none of the shiftable loads is in 
2 is treated as a nonzero quantity to subsume 
use. Its variance ğœ0
noise  or  small  fixed  loads.  With ğ’¢ being  the  set  of  nonzero 
Gaussians, the probability distribution of ğ‘¥ğ‘¡
2
ğ‘ âˆ’ğœ‡ğ‘—)
2
ğœğ‘—

ğ‘  is expressed as, 

(ğ‘¥ğ‘¡

âˆ’

.

(4) 

pr[ğ‘¥ğ‘¡

ğ‘ ] = âˆ‘ Ï€ğ‘—ğ‘’
ğ‘—âˆˆğ’¢âˆª{0}

The  GMM  is  trained  using  the  expectation-maximization 
(EM)  algorithm  [1], 
for 
convenience. The algorithm consists of an expectation step (E-

[33],  briefly  described  here 

4 

step)  and  a  maximization  step  (M-step).  In  the  E-step,  using 
2  for  each ğ‘—,  the  posterior 
existing  estimates  of Ï€ğ‘—  ğœ‡ğ‘— ,  and ğœğ‘—
probabilities zğ‘—,ğ‘¡(ğ‘›) = pr[ğ›¿ğ‘”(ğ‘¡)=ğ‘—|ğ‘¥ğ‘¡] of  each  Gaussian  in ğ’¢ âˆª
{0} is estimated as, 

2

âˆ’

(ğ‘¥ğ‘¡(ğ‘›)âˆ’ğœ‡ğ‘—)
2
ğœğ‘—

âˆ’1Ï€ğ‘—ğ‘’

zğ‘—,ğ‘¡(ğ‘›) = Î£ğ‘¡,ğ‘›

(5)
The quantity Î£ğ‘¡,ğ‘› in the denominator of (5) is for normalization 
such that the joint probability is unity, âˆ‘

,   ğ‘— âˆˆ ğ’¢ âˆª {0}.  

= 1. 

zğ‘—,ğ‘¡(ğ‘›)

|ğ’¢|
ğ‘—=0

During the maximization step the  GMM  parameters, Ï€ğ‘— ğœ‡ğ‘—, 

and ğœğ‘—

2 are updated using the following rules, 

ğœ‡ğ‘— = âˆ‘ zğ‘—,ğ‘¡ğ‘¥ğ‘¡(ğ‘›)

,   ğ‘— âˆˆ ğ’¢,

ğ‘¡âˆˆğ’¯,ğ‘›âˆˆğ’©

2 = âˆ‘ zğ‘—,ğ‘¡(ğ‘¥ğ‘¡(ğ‘›) âˆ’ ğœ‡ğ‘—)
ğœğ‘—

2

,   ğ‘— âˆˆ ğ’¢ âˆª {0},

ğ‘¡âˆˆğ’¯,ğ‘›âˆˆğ’©

Ï€ğ‘— = |ğ’¯|âˆ’1|ğ’©|âˆ’1 âˆ‘ zğ‘—,ğ‘¡(ğ‘›)

,   ğ‘— âˆˆ ğ’¢ âˆª {0}.  

(6ğ‘) 

(6ğ‘) 

(6ğ‘) 

ğ‘¡âˆˆğ’¯,ğ‘›âˆˆğ’©

The  E-step  and  M-step  are  repeated  multiple  times  until 
convergence. 

Given a total load ğ‘¥ğ‘¡(ğ‘›) at time instance ğ‘¡, the shiftable load 

is estimated according to the expression below, 

ğ‘¥Ìƒğ‘¡

ğ‘ (ğ‘›) = max
ğ‘—âˆˆğ’¢

ğœ‡ğ‘— â‰¤ ğ‘¥ğ‘¡(ğ‘›) .
Ignoring noise, the remaining load ğ‘¥ğ‘¡(ğ‘›) âˆ’ ğ‘¥ğ‘¡
the fixed load ğ‘¥Ìƒğ‘¡

ğ‘“(ğ‘›), i.e., 

(7) 
ğ‘ (ğ‘›) is taken to be 

ğ—Ìƒğ‘“ = ğ— âˆ’ ğ—Ìƒğ‘ .  
(8) 
The estimated fixed load ğ—Ìƒğ‘“ is disaggregated in the following 
NMF algorithm. 

B.  Non-Negative Matrix Factorization 

It is assumed that the  fixed load ğ±Ìƒğ‘“(ğ‘›) of each sample ğ‘› âˆˆ
ğ’©  can  be  represented  using  a  set  â„¬  of  basis  vectors  of 
dimensionality  |ğ’¯| Ã— 1 .  If  â„ğ‘˜(ğ‘›), ğ‘˜ = 1, â€¦ , |â„¬|  are  there 
coefficients, we must have, 

ğ±Ìƒğ‘“(ğ‘›) = âˆ‘ â„ğ‘˜

ğ‘“(ğ‘›)ğ°ğ‘˜

ğ‘“

.  

(9) 

ğ‘˜âˆˆâ„¬

Tğ°ğ‘™ =
The  basis  set  is  assumed  to  be  orthonormal,  so  that ğ°ğ‘˜
ğ›¿ğ‘˜=ğ‘™. These basis vectors form the columns of a |ğ’¯| Ã— |â„¬| basis 
letting  ğ¡ğ‘“(ğ‘›) =
matrix,  ğ–ğ‘“ = [â„ğ‘˜(ğ‘›)]ğ‘˜âˆˆğ’¦ .  Similarly, 
 be  the  ğµ Ã— 1  vector  of  coefficients  in  (9),  we 
[â„ğ‘˜
define the |â„¬| Ã— |ğ’©| matrix, ğ‡ğ‘“ = [ğ¡ğ‘“(ğ‘›)]ğ‘›âˆˆğ’©. Therefore the 
above expression can be written more concisely as, 

ğ‘“(ğ‘›)]

ğ‘˜âˆˆğ’¦

ğ—Ìƒğ‘“ = ğ–ğ‘“ğ‡ğ‘“.
(10) 
As  the  basis  vectors  are  mutually  orthonormal,  it  is  apparent 
that  ğ–ğ‘“ T
ğ–ğ‘“ = ğˆğµÃ—ğµ .  The  set  of  all  possible  orthonormal 
matrices  ğ–ğ‘“ is a Steifel manifold, a subset of â„|ğ’¯|Ã—|â„¬|, as long 
as  |â„¬| < |ğ’¯| .  Steifel  manifolds  are  Riemannian  under  an 
appropriately defined matrix inner product [1], [34]. 

The  matrices  ğ–ğ‘“  and  ğ‡ğ‘“  are  trained  using  the  usual 
multiplicative update rule [17], [35], [36], [37] to minimize the 
squared  Frobenius  norm  Î¦ = â€–ğ—ğ‘“ âˆ’ ğ—Ìƒğ‘“â€–
.  Consider  any 
matrix  parameter  ğ  (which  can  be  either  ğ–ğ‘“  or  ğ‡ğ‘“ ).  The 
gradient, âˆ‡ğÎ¦ of Î¦ can be expressed in terms of its positive and 
âˆ’.  In gradient descent, 
negative components as âˆ‡ğÎ¦ = âˆ‡ğ

+ âˆ’ âˆ‡ğ

ğ¹

2

LICQPGMMNMFparameterestimationloaddisaggregationconsumerutility model 
 
 
 
 
+ + Ïµâˆ‡ğ

âˆ’ .  This 
ğ would  be  updated  additively  as ğ â† ğ âˆ’ Ïµâˆ‡ğ
would require the use of an additional algorithmic constant Ïµ, 
as  well  as  an  additional  projection  step  to  ensure  that ğ â‰¥ ğŸ. 
The multiplicative method removes both these drawbacks. The 
multiplicative update rule is ğ â† ğ âˆ˜ âˆ‡ğ
Since  the  gradient  âˆ‡ğ‡ğ‘“Î¦ = ğ–ğ‘“ T

ğ—ğ‘“ ,  the 
coefficient  matrix ğ‡ğ‘“  is  updated  according  to  the  following 
expression, 

âˆ’ âŠ˜ âˆ‡ğ
+. 
ğ–ğ‘“ğ‡ğ‘“ âˆ’ ğ–ğ‘“ T

ğ‡ğ‘“ â† ğ‡ğ‘“ âˆ˜

.  

(11) 

ğ—ğ‘“

ğ–ğ‘“ T
ğ–ğ‘“ Tğ–ğ‘“ğ‡ğ‘“

The corresponding update rule for the basis matrix ğ–ğ‘“ could 
be obtained in the same manner. However, in order to maintain 
orthonormality of the basis vectors, the version in  [38] has been 
adopted in this research, which yields the modified update rule, 

ğ–ğ‘“ â† ğ–ğ‘“ âˆ˜

.   

(12) 

ğ—ğ‘“ğ‡ğ‘“T
ğ–ğ‘“ğ‡ğ‘“ğ—ğ‘“ Tğ–ğ‘“

, 

The  modification lies in the  denominator of the above rule. 
âˆ’ ğ—ğ‘“ğ‡ğ‘“ T
Since  the  gradient âˆ‡ğ–ğ‘“Î¦ in â„|ğ’¯|Ã—|â„¬| is ğ–ğ‘“ğ‡ğ‘“ğ–ğ‘“ T
the denominator in (12) would have been ğ–ğ‘“ğ‡ğ‘“ğ–ğ‘“T
. However 
its  natural  gradient âˆ‡Ìƒ
ğ–ğ‘“Î¦ must  be  tangential  to  the  â€œcurvedâ€ 
Steifel  manifold  in  â„|ğ’¯|Ã—|â„¬| ,  which  is  possible  as  long  as 
ğ–ğ‘“ T
ğ–ğ‘“ + âˆ‡Ìƒ
the  natural 
gradient  of Î¦ is âˆ‡Ìƒ
,  leading  to 
the update rule in (11b) that preserves the orthonormality of the 
basis matrix ğ–ğ‘“. 

ğ–ğ‘“Î¦ = ğ–ğ‘“ğ‡ğ‘“ğ—ğ‘“ T

= ğŸ  [34].  Accordingly, 

ğ–ğ‘“ âˆ’ ğ—ğ‘“ğ‡ğ‘“ T

T ğ–ğ‘“ T
ğ–ğ‘“

âˆ‡Ìƒ

It must be mentioned here that although it has been shown in 
[36] that the multiplicative update rule lowers the cost function 
Î¦, to the best of our knowledge there have been no concrete 
studies  showing  that  it  converges  to  a  unique  fixed  point. 
Needless to say, the simplicity of multiplicative updates makes 
it  widely  used.  The  theoretical  backdrop  becomes  even  more 
pessimistic with orthonormal NMF updates  as applied  in this 
research.  Nonetheless,  numerous  preliminary  simulations  in 
this  research  revealed  that  this  method  was  consistently  as 
accurate as that in [35], while maintaining orthonormality. 

Ignoring  noise,  the  residual  load  in ğ—  that  is  not  fixed,  is 

treated as the shiftable load, so that, 

This load is used by the next iteration of the EM algorithm. 

ğ—Ìƒğ‘  = ğ— âˆ’ ğ–ğ‘“ğ‡ğ‘“.  

(13) 

C.  Hybrid Algorithm 

The steps of the hybrid algorithm are outlined below. 

1.   initialize ğ—Ìƒğ‘“, ğ—Ìƒğ‘  
2.   initialize {Ï€ğ‘—, ğœ‡ğ‘—, ğœğ‘—
3.   initialize ğ–ğ‘“, ğ‡ğ‘“ 
4.   repeat 

2}

ğ‘—âˆˆğ’¢âˆª{0}

a.   estimate {zğ‘—,ğ‘¡(ğ‘›)}
(ğ‘—,ğ‘¡,ğ‘›)âˆˆğ’¢Ã—ğ’¯Ã—ğ’©
2}
b.   update {Ï€ğ‘—, ğœ‡ğ‘—, ğœğ‘—
c.   estimate ğ—Ìƒğ‘“ according to (7),(8) 

ğ‘—âˆˆğ’¢âˆª{0}

 according to (6) 

 according to (4),(5) 

        d.   update ğ‡ğ‘“ according to (11) 
        e.   update ğ–ğ‘“ according to (12) 
        f.   estimate ğ—Ìƒğ‘  according to (13) 
      until converged 

5 

The first step of the hybrid disaggregation algorithm involves 
dividing  the  training  samples  ğ—  into  shiftable  and  fixed 
components.  Initialization  of  the  GMM  parameters  and  the 
NFM matrices takes place in steps 2 and 3. Step 4 is the main 
iterative process. 

Steps 4a and 4b pertain to the GMM as outlined in III.A. In 
step 4a, the hidden variables zğ‘—,ğ‘¡(ğ‘›) are estimated. This is the 
E-step of the EM algorithm. The M-step is implemented in step 
4b.  In  step  4c,  the  estimated  fixed  load ğ—Ìƒğ‘“ is  computed.  The 
next two steps (steps 4d and 4e) implement the NMF algorithm. 
In step 4d and 4e, the matrices ğ‡ğ‘“ and ğ–ğ‘“ associated with the 
fixed  loads  are  incremented.  Finally, ğ—Ìƒğ‘  ,  the  estimate  of  the 
total shiftable load is determined in step 4f.  

The criterion to determine when convergence is achieved is 
omitted in the overall algorithmâ€™s outline because it was found 
that  the  algorithm  always  converged  within  merely  10-20 
iterations,  which  was  well  within  2  minutes.  Therefore  the 
repeat-until loop may be replaced with a  simple for loop that 
terminates  after  a  predetermined  maximum  number  of 
iterations.  

It  may  be  noted  that  in  (8),  the  shiftable  load ğ—Ìƒğ‘ ,  which  is 
determined using a probability threshold, is subtracted from the 
total load ğ— for the NMF steps. In a similar manner, the NMF 
algorithm  estimates ğ—Ìƒğ‘“  and  the  difference ğ— âˆ’ ğ—Ìƒğ‘“  is  used  by 
the EM algorithm. Suppose the estimated total load, ğ—Ìƒ is given 
by, 

ğ—Ìƒ = ğ—Ìƒğ‘  + ğ—Ìƒğ‘“.
(13) 
The  difference  between  ğ—  and  ğ—Ìƒ  can  be  attributed  to  either 
noise  or  discrepancy  arising  from  the  proposed  hybrid 
disaggregation  algorithm.  The  disaggregated  loads ğ—Ìƒğ‘  and ğ—Ìƒğ‘“ 
are used to estimate the model parameters, which is described 
next. 

IV.  PARAMETER ESTIMATION 

A.  ğœ–-Insensitive Constraints 

The |ğ’¦| Ã— 1 vectors of parameters are, ğš, ğ›, ğ, ğ©, and ğª. Let 
ğœ– ğ‘“ be a tolerance bound on the difference between the modeled 
and the disaggregated fixed loads in (1) and (9). No penalty is 
ğ‘“|  is within ğœ– ğ‘“, 
incurred when the absolute difference, |ğ‘¥Ì‚ğ‘˜
ğ‘“. Hence, for each 
whereas anything in excess of it is an error, ğœ‰ğ‘˜
sample ğ‘› âˆˆ ğ’© is, 

ğ‘“ âˆ’ ğ‘¥Ìƒğ‘˜

ğ•€ğ‘“: |ğ© + ğ›‰(ğ‘›) âˆ˜ ğª âˆ’ ğ†ğ±Ìƒğ‘“(ğ‘›)| â‰¤ ğŸ|ğ’¦|ğœ– ğ‘“ + ğ›ğ‘“.

(14) 
In  a  similar  manner,  with ğœ– ğ‘  being  the  maximum  allowable 
tolerance  of  the  difference  between  the  model  and  the 
disaggregated  shiftable  loads,  shown  in  (3)  and  (10)  for  each 
ğ‘› âˆˆ ğ’© is given by, 
ğ•€ğ‘ : |ğœâˆ˜âˆ’1 âˆ˜ ğš + ğ› + ğ›‰(ğ‘›) âˆ˜ ğ âˆ’ ğ†ğ±Ìƒ ğ‘ (ğ‘›)| â‰¤ ğŸ|ğ’¦|ğœ– ğ‘  + ğ›ğ‘ . (15)  
In  (14)  and  (15), ğ† is  a |ğ’¦| Ã— |ğ’¯| summing  matrix  that  sums 
time  samples  of  variables  index  ğ‘¡  to  their  periodic  totals 
indexed ğ‘˜, as shown, 

ğ† = [

T
T â‹¯ ğŸğ¿
ğŸğ¿
â‹®
â‹®
â‹±
T
T â‹¯ ğŸğ¿
ğŸğ¿

]. 

 
 
 
 
The use of ğœ–-insensitive loss as in (14) and (15) is universally 
accepted  practice  in  machine  learning  as  it  reduces  the 
regression modelâ€™s VC-dimensionality [39], [40]. 

B.  ğ¿2 Regularized Loss 

ğ‘“ and ğœ‰ğ‘˜

The weighted sum of all squared errors ğœ‰ğ‘˜

ğ‘ , is the loss 
function is selected as the loss function to be minimized. This 
loss, ğ•ƒ can be expressed as a squared ğ¿2 norm,  
ğ•ƒ = â€–[ğ‘¤ğ‘“ğˆ
ğŸ

ğ›ğ‘“
ğ›ğ‘ ]â€–
The quantities ğ‘¤ğ‘“ and ğ‘¤ ğ‘  are the weights. 

ğŸ
ğ‘¤ ğ‘ ğˆ

(16) 

] [

2

.

The above loss is regularized by with the function which is 
the sum of two squared ğ¿2 norms of the shiftable and fixed load 
parameters.  The  regularization  function  â„  is  given  by  the 
following expression, 

â„ = â€–[

ğ›¾ğ‘ğˆ
ğŸ

ğŸ
ğ›¾ğ‘ğˆ

] [

2

ğ©
ğª]â€–

+ â€–[

ğ›¾ğ‘ğˆ
ğŸ
ğŸ

ğŸ
ğ›¾ğ‘ğˆ
ğŸ

ğŸ
ğŸ
ğ›¾ğ‘‘ğˆ

] [

ğš
ğ›
ğ

2

]â€–

.

(17) 

In  (17), ğ›¾ğ‘ , ğ›¾ğ‘ , ğ›¾ğ‘ , ğ›¾ğ‘  and ğ›¾ğ‘‘  are  arbitrarily  small,  positive 
regularization coefficients. 

C.  Linear Inequality Constrained Quadratic Programming  

The  overall  problem  of  estimating  the  parameter  vectors, 
ğš, ğ›, ğ ,  ğ© ,  and  ğª  of  the  utility  model  can  now  be  readily 
formulated 
linear  inequality 
terms  of 
constrained quadratic programming (LICQP), 

the  following 

in 

Minimize:  ğ•ƒ + â„. 
Subject to:  ğ•€ğ‘“, ğ•€ğ‘ . 

It can be observed that the regularized loss can be expressed 
as a quadratic function with an associated 7|ğ’¦| Ã— 7|ğ’¦| matrix 
whose  diagonal  elements  are  the  two  weights  and  the  five 
coefficients; ergo the quadratic term in the objective function 
ğ•ƒ + â„  is strictly positive definite. Thus, the objective function 
in the above LICQP is strictly convex. As both set of inequality 
constraints ğ•€ğ‘“, ğ•€ğ‘  are linear, there exists a unique minimum. 

V.  RESULTS & DISCUSSION 

A.  Data 

The  proposed  approach  was  tested  on  actual  energy  usage 
data  of  two  residential  customers  that  was  obtained  from  the 
Pecan Street Inc., Dataport database [41] sampled at one minute 
intervals, and for 61 days during March and April, 2018. The 
total  energy  data  was  arranged  as  a 1440 Ã— 61 data  matrix ğ— 
whose  columns  were  the  1440-dimensional  sample  vectors, 
ğ±(ğ‘›), ğ‘› âˆˆ ğ’©.  

The  database  also  included  individual  appliance  usage 
measurements at the circuit level. These appliances are, (i) air 
conditioner, (ii) electric car, (iii) washer/dryer, (iv) dishwasher, 
(v)  microwave,  (vi)  refrigerator,  (vii)  furnace,  (viii)  bedroom 
appliances, (ix) light plugs and (x) kitchen appliances.  The first 
four appliances are classified as shiftable loads for our purpose, 
while the remaining ones are fixed loads. It should be noted that 
user-1 did not own bedroom appliances or furnace, while user-
2 did not own an electric car. 

The  hourly  temperature  data  for  the  same  61  days ğ‘› âˆˆ ğ’© 
was  also  obtained  from  [41].  Therefore,  the  load  data  and 

6 

temperatures in the data used in this study are from the city of 
Austin in Texas. Accordingly, the hourly time of use rates were 
obtained  from  the  Austin  Energy  website  [42].  This  site 
provides  electricity  rates  in  the  Austin  area  for  a  time  of  use 
pilot project. The user data used in this study were part of DER 
that  received  pricing  information  from  the  utility  and  were 
expected to defer their loads during peak or high energy price 
hours. All algorithms were implemented in MATLAB. 

B.  Disaggregation 

The plots in Figs. 4. and 5. show comparisons between the 
real data (left column, red) and the outcome of disaggregation 
for user-1 (right column, blue) for the first two days, (ğ‘› = 1, 2). 
The  remarkable  similarities  in  the  shiftable  loads ğ—ğ‘   and ğ—Ìƒğ‘  
(top row) is evident. The corresponding fixed loads ğ—ğ‘“ and ğ—Ìƒğ‘“ 
(middle row) are quite similar but there are minor differences. 
Among  the  most  conspicuous  ones  in  Fig.  4  occur  at  time 
instances ğ‘¡ â‰ˆ 250, 660, 718,  and ğ‘¡ â‰ˆ 1080.  At ğ‘¡ â‰ˆ 250, 660, 
a small fraction of the fixed load ğ—ğ‘“ is erroneously incorporated 
by the hybrid algorithm into the shiftable load ğ—Ìƒğ‘ , whereas at 
ğ‘¡ â‰ˆ 718, 1080 some of ğ—ğ‘  is transferred to ğ—Ìƒğ‘“. However these 
discrepancies  are  quite  small  in  spite  of  their  exaggerated 
appearances in the plots are due to the smaller range of the fixed 
loads in comparison to the shiftable loads. 

In  Fig.  5,  between  , ğ‘¡ â‰ˆ 660 âˆ’ 800 ,  some  differences 
between  the real  and  proposed  approachâ€™s  reconstructed  shift 
and  shiftable  loads  can  be  observed.  In  particular,  the  high 
frequency  fluctuation  in ğ—ğ‘“  does  not  get  incorporated  in ğ—Ìƒğ‘“ . 
However, this is at only at the relatively low power level of 0.5 
kW. In the interval ğ‘¡ â‰ˆ 820 âˆ’ 900, a few upward spikes in ğ—Ìƒğ‘“ 
can be seen. This occurs again at the instances ğ‘¡ â‰ˆ 1210, 1380.  
In  both  Fig.  4  and  Fig.  5,  the  total  loads ğ— and ğ—Ìƒ   (bottom 
rows) are very similar, indicating the effectiveness of the hybrid 
approach  with  the  NMF  and  GMM  algorithms  working  in 
tandem in disaggregating the total load. 

Figs.  6  and  7  show  the  consumption  patterns  of  user-2  on 
days  ğ‘› = 1, 2 .  The  positions  of  the  real  loads  (left,  red), 
disaggregated  loads  (right,  blue),  shiftable  loads  (top),  fixed 
loads (middle) and total (bottom) are exactly as in Figs. 4 and 5 
which were associated with user-1. 

One  noticeable  difference  in  user-2  consumption  profile  is 
that the power usages of the fixed loads and shiftable loads are 
at similar levels. Consequently, sudden bursts in the fixed loads 
were consistently misinterpreted by the hybrid disaggregation 
algorithm as shiftable loads, with the GMM assigning a prior 
2  large  enough  to 
mean  ğœ‡ğ‘—  (for  some  ğ‘— ),  with  a  variance  ğœğ‘—
subsume all such fixed load spikes. These spikes appear at time 
instances  ğ‘¡ â‰ˆ 491,600,776  on  day  ğ‘› = 1  and  at  ğ‘¡ â‰ˆ
770, 481, 485, 1210, 1360  on  day  ğ‘› = 2 .  Although  this 
phenomenon has been observed earlier in the case of user-1, it 
is  visually  more  pronounced  now  due  to  the  similar  power 
levels of user-2â€™s shiftable and fixed loads. 

Simple  post-processing  heuristic  filtering  would  be  readily 
able to rectify these discrepancies in the hybrid disaggregation 
approach. In view of algorithmic simplicity, no modifications 
were  made  to  the  disaggregation  approach  to  address  this 
situation. Moreover, as these fixed load spikes lasted for only 
1-2 minutes each, the effect on model parameter estimation is 
imperceptible. 

 
7 

Fig.  4.  Energy  consumption  of  user-1  on day ğ‘› = 1.   The  real  loads  (red,  left)  and  disaggregated  loads  (blue,  right)  are 
shown. The shiftable (top) and fixed (middle) components of the total load (bottom) are shown. 

Fig.  5.  Energy  consumption  of  user-1  on day ğ‘› = 2.   The  real  loads  (red,  left)  and  disaggregated  loads  (blue,  right)  are 
shown. The shiftable (top) and fixed (middle) components of the total load (bottom) are shown. 

 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
8 

Fig.  6.  Energy  consumption  of  user-1  on day ğ‘› = 1.   The  real  loads  (red,  left)  and  disaggregated  loads  (blue,  right)  are 
shown. The shiftable (top) and fixed (middle) components of the total load (bottom) are shown. 

Fig.  7.  Energy  consumption  of  user-1  on day ğ‘› = 1.   The  real  loads  (red,  left)  and  disaggregated  loads  (blue,  right)  are 
shown. The shiftable (top) and fixed (middle) components of the total load (bottom) are shown. 

 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
C.  Parameter Estimation 

The parameter vectors, ğš, ğ›, ğ, ğ©, and ğª of the utility model 
are  the  optimal  solutions  of  the  LICQP  in  IV.C,  that  were 
obtained  using  the  fmincon()  subroutine  that  is  available  in 
MATLABâ€™s  optimization  toolbox.  As  it  was  noticed  that 
temperature had little bearing on the fixed load usage of either 
user, the corresponding parameter q was set to zero. Although 
the  purpose  of  this  research  is  to  derive  a  consumer  model 
entirely through smart metering data, sans any prior information 
about  how  and  when  individual  appliances  were  operated, 
ğš, ğ›, ğ, ğ©, and ğª were computed using real loads ğ—ğ‘  and ğ—ğ‘“ as 
well as their estimates ğ—Ìƒğ‘  and ğ—Ìƒğ‘“ obtained as described in V.B 
using the hybrid approach. The median values of all parameters 
are supplied in Table I, separately for each user. It can be seen 
that the medians obtained from the disaggregated estimates (4th 
column)  are  very  close  to  those  obtained  from  real  data  (3rd 
column). Furthermore,  the correlation coefficients between the 
median  values  are  also  shown  in  Table  I  (5th  column).  The 
correlation coefficients of the shiftable load parameters ğš, ğ› and 
ğ are in the range 0.978 â€“ 0.995, which is remarkably close to 
1,  indicating  the  fidelity  of  the  proposed  disaggregation 
approach. The corresponding values of the fixed load parameter 
p (0.891 and 0.892) are also very close to 1. 

user 

User-1 

User-2 

TABLE I. 

median 

real  
2.816 
0.222 
0.219 
27.191 
0 
2.819 
0.228 
0.225 
27.192 
0 

disagg. 
2.711 
0.242 
0.236 
20.565 
0 
2.709 
0.269 
0.263 
21.108 
0 

para- 
meter 
ğš 
ğ› 
ğ 
p 
q 
ğš 
ğ› 
ğ 
p 
q 

corr. 
coeff. 
0.994 
0.983 
0.983 
0.891 
- 
0.995 
0.979 
0.978 
0.892 
- 

9 

Fig.  8.  User-1  utility  and  cost.  The  utility  functions  (top) 
and  cost  (bottom)  functions  are  shown,  using  real  loads 
(red, solid lines) and disaggregated loads (blue dotted lines). 

Fig.  9.  User-2  utility  and  cost.  The  utility  functions  (top) 
and  cost  (bottom)  functions  are  shown,  using  real  loads 
(red, solid lines) and disaggregated loads (blue dotted lines). 

The  utility  curves  associated with  the  shiftable  loads  were 
obtained from the parameters ğš, ğ› and ğ are shown in Fig. 8 for 
user-1 and Fig. 9 for user-2. In both figures, the usersâ€™ perceived 
utilities (top) as well as their derivatives (bottom) are provided. 
These plots were obtained using parameters obtained directly 
from  real  loads ğ—ğ‘   and ğ—ğ‘“  (red,  solid  lines)  as  well  as  their 
estimates ğ—Ìƒğ‘  and ğ—Ìƒğ‘“ (blue, dotted lines). It should be noted that 
the difference between the real and utilities is only an artifact of 
integration. The curves corresponding to the estimated utilities 
(blue, dotted) can be shifted upwards to more closely with the 
real curves (red, solid).  

Finally,  Fig.  10  shows  the  hourly  consumption  profiles  of 
user-1 (top) and user-2 (bottom) for a typical day in the 61 day 
period used in this research. They were obtained from (1) and 
(2) with the parameters obtained from the LICQP optimization 
procedure and using the disaggregated loads estimated by the 
disaggregation approach. 

VI.  CONCLUSION 

    This  paper  proposes  a  generic  class  of  data-driven 
semiparametric  models  derived  from  consumption  data  of 
residential consumers. A two-stage machine learning approach 
is developed, in which disaggregation of the load into fixed and 
shiftable  components  is  accomplished  by  means  of  a  hybrid 
algorithm consisting of non-negative NMF and GMM, with the 
latter trained by an expectation-maximization (EM) algorithm. 
In the second stage, the model parameters are estimated using 
an  L2-norm,  Ïµ-insensitive  regression  approach.  Actual  energy 
usage data of two residential customers show the validity of the 
proposed method.  

The  proposed  method 

that  disaggregates  electricity 
consumption into the shiftable and fixed portions, can enhance 
the  demand  response  program  of  utilities  as  well  as  help 
residential  customers  make  well  informed  decisions  and 
increase  the  energy  efficiency  gains  while  participating  in  a 

 
 
 
 
 
 
 
demand response program. It also allows for automated energy 
transactions  between  customers  and  the  utilities  based  on  a 
the  actual 
semi-parametric  utility  model 
consumption pattern of the customers. 

learned  from 

Fig. 10. Typical 24-hour load profiles of user-1 (top) and 
user-2  (bottom)  obtained  from  the  semi-parametric  utility 
model  with  disaggregated  load  estimates.  The  shaded 
regions depict the range of values from the real data. 

VII.  ACKNOWLEDGMENT 

This work was supported by the National Science Foundation-
CPS under Grant CNS-1544705.  

VIII.  REFERENCES 

[1] 

[2] 

[3] 

[4] 

[5] 

[6] 

[7] 

B.  Humala,  S.  N.  A.  U.  Nambi,  and  R.  V.  Prasad, 
â€œUniversalNILM: A Semi-supervised Energy Disaggregation 
Framework using General Appliance Models,â€ Proceedings 
of  the  Ninth  International  Conference  on  Future  Energy 
System,  2018. 
F. C. C. Garcia, C. M. C. Creayla, and E. Q. B. Macabebe, 
â€œDevelopment  of  an  Intelligent  System  for  Smart  Home 
Energy  Disaggregation  Using 
Stacked  Denoising 
Autoencoders,â€  Procedia  Computer  Science,  vol.  105,  no. 
December 2016, pp. 248â€“255, 2017. 
I.  H.  Ã‡avdar  and  V.  Faryad,  â€œNew  Design  of  a  Supervised 
Energy  Disaggregation  Model  Based  on  the  Deep  Neural 
Network for a Smart Grid,â€ Energies, vol. 12, no. 7, p. 1217, 
2019. 
S.  Singh  and  A.  Majumdar,  â€œDeep  sparse  coding  for  non-
intrusive  load  monitoring,â€  IEEE  Transactions  on  Smart 
Grid, vol. 9, no. 5, pp. 4669â€“4678, 2018. 
M.  DrIncecco,  S.  Squartini,  and  M.  Zhong,  â€œTransfer 
IEEE 
Learning 
Transactions on Smart Grid, vol. 11, no. 2, pp. 1419â€“1429, 
2020. 
T.  Y.  Ji  et  al.,  â€œNon-Intrusive  Load  Monitoring  Using 
Additive Factorial Approximate Maximum a Posteriori Based 
on Iterative Fuzzy C-Means,â€ vol. 3053, no. 2018, pp. 1â€“11, 
2019. 
K. He, D. Jakovetic, B. Zhao, V. Stankovic, L. Stankovic, and 
S.  Cheng,  â€œA  Generic  Optimisation-based  Approach  for 
IEEE 
Improving  Non-intrusive  Load  Monitoring,â€ 

for  Non-Intrusive  Load  Monitoring,â€ 

10 

[8] 

[9] 

[10] 

Transactions on Smart Grid, vol. 10, no. 6, pp. 1â€“1, 2019. 
S.  W.  Park,  L.  B.  Baker,  and  P.  D.  Franzon,  â€œAppliance 
Identification  Algorithm  for  a  Non-Intrusive  Home  Energy 
Monitor  Using  Cogent  Confabulation,â€  IEEE  Transactions 
on Smart Grid, vol. 10, no. 1, pp. 714â€“721, 2019. 
K.  He,  L.  Stankovic,  J.  Liao,  and  V.  Stankovic,  â€œNon-
Intrusive  Load  Disaggregation  Using  Graph  Signal 
Processing,â€ IEEE Transactions on Smart Grid, vol. 9, no. 3, 
pp. 1739â€“1747, 2018. 
G. C. Koutitas and L. Tassiulas, â€œLow Cost Disaggregation 
of Smart Meter Sensor Data,â€ IEEE Sensors Journal, vol. 16, 
no. 6, pp. 1665â€“1673, 2016. 

[11]  W. Kong, Z. Y. Dong, J. Ma, D. J. Hill, J. Zhao, and F. Luo, 
â€œAn  Extensible  Approach 
for  Non-Intrusive  Load 
Disaggregation with Smart Meter Data,â€ IEEE Transactions 
on Smart Grid, vol. 9, no. 4, pp. 3362â€“3372, 2018. 
[12]  M. A. Mengistu, A. A. Girmay, C. Camarda, A. Acquaviva, 
and  E.  Patti,  â€œA  Cloud-Based  On-Line  Disaggregation 
Algorithm for Home Appliance Loads,â€  IEEE Transactions 
on Smart Grid, vol. 10, no. 3, pp. 3430â€“3439, 2019. 
Z. Guo, Z. J. Wang, and A. Kashani, â€œHome appliance load 
modeling  from  aggregated  smart  meter  data,â€  IEEE 
Transactions on Power Systems, vol. 30, no. 1, pp. 254â€“262, 
2015. 

[13] 

[16] 

[15] 

[14]  W. Kong, Z. Y. Dong, D. J. Hill, J. Ma, J. H. Zhao, and F. J. 
Luo, â€œA Hierarchical Hidden Markov Model Framework for 
Home  Appliance  Modeling,â€  IEEE  Transactions  on  Smart 
Grid, vol. 9, no. 4, pp. 3079â€“3090, 2018. 
P.  A.  Chou  and  R.  I.  Chang,  â€œUnsupervised  adaptive  non-
intrusive load monitoring system,â€ Proceedings - 2013 IEEE 
International Conference on Systems, Man, and Cybernetics, 
SMC 2013, pp. 3180â€“3185, 2013. 
A.  Rahimpour,  H.  Qi,  D.  Fugate,  and  T.  Kuruganti,  â€œNon-
Intrusive Energy Disaggregation Using Non-Negative Matrix 
Factorization with Sum-to-k Constraint,â€ IEEE Transactions 
on Power Systems, vol. 32, no. 6, pp. 4430â€“4441, 2017. 
A.  Miyasawa,  Y.  Fujimoto,  and  Y.  Hayashi,  â€œEnergy 
disaggregation based on smart metering data via semi-binary 
nonnegative matrix factorization,â€ Energy and Buildings, vol. 
183, pp. 547â€“558, 2019. 
A. Miyasawa, M. Matsumoto, Y. Fujimoto, and Y. Hayashi, 
â€œEnergy  disaggregation  based  on  semi-supervised  matrix 
factorization  using  feedback  information  from  consumers,â€ 
2017  IEEE  PES  Innovative  Smart  Grid  Technologies 
Conference  Europe,  ISGT-Europe  2017  - Proceedings,  vol. 
2018-Janua, pp. 1â€“6, 2018. 

[17] 

[18] 

[21] 

[20] 

[19]  M. Figueiredo, B. Ribeiro, and A. de Almeida, â€œAnalysis of 
trends  in  seasonal  electrical  energy  consumption  via  non-
negative tensor factorization,â€ Neurocomputing, vol. 170, pp. 
318â€“327, 2015. 
L.  A.  Barroso,  A.  Street,  S.  Granville,  and  M.  V.  Pereira, 
â€œOffering  strategies  and  simulation  of  multi-item  iterative 
auctions of energy contracts,â€ IEEE Transactions on Power 
Systems, vol. 26, no. 4, pp. 1917â€“1928, 2011. 
N. Li, L. Chen, and S. H. Low, â€œOptimal demand response 
based  on  utility  maximization  in  power  networks,â€  IEEE 
Power and Energy Society General Meeting, 2011. 
[22]  M.  Li,  H.  Feng,  F.  Chen,  and  J.  Kou,  â€œOptimal  versioning 
strategy for information products with behavior-based utility 
function  of  heterogeneous  customers,â€  Computers  & 
Operations Research, vol. 40, no. 10, pp. 2374â€“2386, 2013. 
J. H. Choi, H. Ahn, and I. Han, â€œUtility-based double auction 
mechanism  using  genetic  algorithms,â€  Expert  Systems  with 
Applications, vol. 34, no. 1, pp. 150â€“158, 2008. 
J. Cox and R. Oaxaca, â€œIs bidding behavior consistent with 
bidding  theory  for  private  value  auctions?,â€  Research  in 
experimental economics, vol. 6, pp. 131â€“148, 1996. 

[23] 

[24] 

 
 
 
 
[26] 

[25] 

J. K. Kale, â€œGrowth maximization and downside protection 
using  power-log  utility  functions  for  optimizing  portfolios 
with  derivatives,â€  5th 
International  Conference  on 
Information  Technology  and  Applications,  ICITA  2008,  no. 
Icita, pp. 282â€“286, 2008. 
A. Abdel-Hadi and C. Clancy, â€œA utility proportional fairness 
approach  for  resource  allocation 
in  4G-LTE,â€  2014 
International  Conference  on  Computing,  Networking  and 
Communications, ICNC 2014, pp. 1034â€“1040, 2014. 
[27]  M.  N.  Faqiry  and  S.  Das,  â€œDistributed  bilevel  energy 
allocation mechanism with grid constraints and hidden user 
information,â€ IEEE Transactions on Smart Grid, vol. 10, no. 
1869â€“1879, 2019. 

11 

[29] 

[32] 

[30] 

[34] 

[31] 

[33] 

to  Energy  Transaction 

[28]  M. N. Faqiry and S. Das, â€œDouble Auction With Hidden User 
Information:  Application 
in 
Microgrid,â€  IEEE  Transactions  on  Systems,  Man,  and 
Cybernetics: Systems, pp. 1â€“14, 2018. 
A.  K.  Zarabie,  S.  Das,  and  M.  N.  Faqiry,  â€œFairness-
Regularized  DLMP-Based  Bilevel  Transactive  Energy 
Mechanism in Distribution Systems,â€ IEEE Transactions on 
Smart Grid, vol. 10, no. 6, pp. 6029â€“6040, 2019. 
S.  Bahrami  and  A.  Sheikhi,  â€œFrom  Demand  Response  in 
Smart  Grid  Toward  Integrated  Demand  Response  in  Smart 
Energy Hub,â€ IEEE Transactions on Smart Grid, vol. 7, no. 
2, pp. 650â€“658, 2016. 
K.  Jhala,  B.  Natarajan,  and  A.  Pahwa,  â€œProspect  Theory-
Based Active Consumer Behavior under Variable Electricity 
Pricing,â€  IEEE  Transactions  on Smart  Grid,  vol.  10, no. 3, 
pp. 2809â€“2819, 2019. 
A.  S.  W.  A.  Barnett,  â€œQuantifying  Consumer  Preferences 
Chapter 1: Measuring Consumer Preferences and Estimating 
Demand  Systems,â€  in  Contributions  to  Economic  Analysis, 
2009, pp. 1â€“35. 
N.  Vlassis  and  A.  Likas,  â€œA  Greedy  EM  Algorithm  for 
Gaussian Mixture Learning,â€ Neural Processing Letters, vol. 
15, no. 1, pp. 77â€“87, 2002. 
A. Edelman, T. A. Arias, and S. T. Smith, â€œThe Geometry of 
Algorithms  with  Orthogonality  Constraints,â€  SIAM  Journal 
on Matrix Analysis and Applications, vol. 20, no. 2, pp. 303â€“
353, 1998. 
D. D. Lee and H. S. Seung, â€œLearning the parts of objects by 
non-negative  matrix  factorization,â€  Nature,  vol.  401,  no. 
6755, pp. 788â€“791, 1999. 
D. D. Lee, M. Hill, and H. S. Seung, â€œAlgorithms for Non-
Negative  Matrix  Factorization,â€  in  Proceeding  NIPSâ€™00 
Proceedings of the 13th International Conference on Neural 
Information Processing Systems, 2000, no. 1, pp. 535â€“541. 
N.  Gillis,  â€œThe  Why  and  How  of  Nonnegative  Matrix 
Factorization,â€ ArXiv, pp. 1â€“25, 2014. 
S.  Choi,  â€œAlgorithms  for  orthogonal  nonnegative  matrix 
factorization,â€  Proceedings  of 
the  International  Joint 
Conference on Neural Networks, pp. 1828â€“1832, 2008. 
D.  Jap,  M.  StÃ¶ttinger,  and  S.  Bhasin,  â€œSupport  vector 
regression,â€  Neural  Information  Processing  â€“  Letters  and 
Reviews, vol. 11, no. 10, pp. 1â€“8, 2015. 
Y.  Tan  and  J.  Wang,  â€œA  Support  Vector  Machine  with  a 
and  Minimal  Vapnik-Chervonenkis 
Hybrid  Kernel 
Dimension,â€  IEEE  Transactions  on  Knowledge  and  Data 
Engineering, vol. 16, no. 4, pp. 385â€“395, 2004. 
â€œElectric  Consumption  Data.â€  https://www.pecanstreet.org/ 
(accessed Jan. 15, 2019). 
â€œAsuting 
(accessed Mar. 09, 2019). 

https://austineenergy.com/ae/rates/ 

Energy.â€ 

[41] 

[42] 

[37] 

[35] 

[38] 

[36] 

[40] 

[39] 

 
 
 
 
