Draft version March 29, 2022
Typeset using LATEX twocolumn style in AASTeX63

2
2
0
2

r
a

M
8
2

]

M

I
.
h
p
-
o
r
t
s
a
[

1
v
8
3
5
4
1
.
3
0
2
2
:
v
i
X
r
a

ZETA-PAYNE: a fully automated spectrum analysis algorithm for the Milky Way Mapper program
of the SDSS-V survey

Ilya Straumit,1, 2 Andrew Tkachenko,2 Sarah Gebruers,2, 3 Jeroen Audenaert,2 Maosheng Xiang,3
Eleonora Zari,3 Conny Aerts,2, 3, 4 Jennifer A. Johnson,1 Juna A. Kollmeier,5 Hans-Walter Rix,3
Rachael L. Beaton,6, 5 Jennifer L. Van Saders,7 Johanna Teske,8 Alexandre Roman-Lopes,9 Yuan-Sen Ting,10, 11
and Carlos G. Rom´an-Z´u˜niga12

1The Department of Astronomy and Center of Cosmology and AstroParticle Physics, The Ohio State University, Columbus, OH 43210,
USA
2Institute of Astronomy, KU Leuven, Celestijnenlaan 200D, 3001 Leuven, Belgium
3Max Planck Institute for Astronomy, K¨onigstuhl 17, 69117 Heidelberg, Germany
4Department of Astrophysics, IMAPP, Radboud University Nijmegen, PO Box 9010, 6500 GL Nijmegen, The Netherlands
5The Observatories of the Carnegie Institution for Science, 813 Santa Barbara St., Pasadena, CA 91101
6Department of Astrophysical Sciences, Princeton University, 4 Ilvy Lane, Princeton, NJ 08544
7Institute for Astronomy, University of Hawai’i, 2680 Woodlawn Drive, Honolulu, HI 96822, USA
8Earth and Planets Laboratory, Carnegie Institution for Science, 5241 Broad Branch Road, NW, Washington, DC 20015, USA
9Departamento de Astronomia, Facultad de Ciencias, Universidad de La Serena. Av. Juan Cisternas 1200, La Serena, Chile
10Research School of Astronomy & Astrophysics, Australian National University, Cotter Rd., Weston, ACT 2611, Australia
11School of Computing, Australian National University, Acton ACT 2601, Australia
12Universidad Nacional Aut´onoma de M´exico, Instituto de Astronom´ıa, AP 106, Ensenada 22800, BC, M´exico

(Received December 6, 2021; Revised December 6, 2021; Accepted March 29, 2022)

Submitted to AJ

ABSTRACT

The Sloan Digital Sky Survey has recently initiated its 5th survey generation (SDSS-V), with a
central focus on stellar spectroscopy. In particular, SDSS-V’s Milky Way Mapper program will deliver
multi-epoch optical and near-infrared spectra for more than 5×106 stars across the entire sky, covering
a large range in stellar mass, surface temperature, evolutionary stage, and age. About 10% of those
spectra will be of hot stars of OBAF spectral types, for whose analysis no established survey pipelines
exist. Here we present the spectral analysis algorithm, ZETA-PAYNE, developed speciﬁcally to obtain
stellar labels from SDSS-V spectra of stars with these spectral types and drawing on machine learning
tools. We provide details of the algorithm training, its test on artiﬁcial spectra, and its validation on two
control samples of real stars. Analysis with ZETA-PAYNE leads to only modest internal uncertainties
in the near-IR with APOGEE (optical with BOSS): 3-10% (1-2%) for Teﬀ , 5-30% (5-25%) for v sin i,
1.7-6.3 km s−1(0.7-2.2 km s−1) for RV, < 0.1 dex (< 0.05 dex) for log g, and 0.4-0.5 dex (0.1 dex)
for [M/H] of the star, respectively. We ﬁnd a good agreement between atmospheric parameters of
OBAF-type stars when inferred from their high- and low-resolution optical spectra. For most stellar
labels the APOGEE spectra are (far) less informative than the BOSS spectra of these stars, while
log g, v sin i, and [M/H] are in most cases too uncertain for meaningful astrophysical interpretation.
This makes BOSS low-resolution optical spectra better for stellar labels of OBAF-type stars, unless
the latter are subject to high levels of extinction.

Keywords: methods: data analysis — techniques: spectroscopic — surveys

Corresponding author: Ilya Straumit
ilya.straumit@kuleuven.be

1. INTRODUCTION

Recent successes of space-based astrometric (e.g.,
Gaia, Gaia Collaboration et al. 2016) and photomet-

 
 
 
 
 
 
2

Straumit et al.

ric (CoRoT, Kepler , K2, and TESS, Auvergne et al.
2009; Borucki et al. 2010; Howell et al. 2014; Vanderspek
2019, respectively) missions implied a boost for stel-
lar astrophysics. Nevertheless, (ground-based) stellar
spectroscopy still occupies an important niche, thanks
to the complementary nature of information it adds to
the photometric and astrometric measurements. Indeed,
even low-resolution (R∼2000-5000) spectroscopy oﬀers
unprecedented level of detail in the analysis of stellar
atmospheres as compared to (broad-band) space-based
photometric measurements, allowing us to resolve im-
portant diagnostic spectral lines and their blends.

Though space-based (photometric) missions deliver
high-quality, high-duty cycle, and nearly uninterrupted
time-series of data full of information, a considerable
amount of stellar astrophysics applications, both at the
level of individual objects and their ensembles, require
precise atmospheric parameters and chemical composi-
tions of stars, as well as estimates of their surface rota-
tion and radial velocities. For example, (transiting) exo-
planet studies often rely on ground-based spectroscopic
measurements for the inference of planetary masses and
properties of their host stars (e.g., Danielski et al. 2021).
The study of planetary atmospheres through the method
of transmission spectroscopy is another application (e.g.,
Kreidberg 2017; Limbach et al. 2020). Eclipsing bi-
nary studies also require spectroscopic observations to
deduce masses and radii of both components with pre-
cision and accuracy better than 3% level (e.g., Torres
et al. 2010; Thomas et al. 2021; Serenelli et al. 2021),
enabling stringent tests of stellar structure and evolu-
tion theory (e.g., Claret & Torres 2019; Tkachenko et al.
2020, and references therein). Furthermore, detailed
asteroseismic studies of pulsating stars require knowl-
edge of their atmospheric chemical compositions and
precise locations in the (Teﬀ -log g) Kiel or (Teﬀ -log L)
Hertzsprung-Russel (HR) diagram, to enable observa-
tional probing of the physical conditions in the deep in-
teriors of stars (e.g., Aerts et al. 2010; Aerts 2021).

Although detailed studies of individual objects are
extremely important to assess the precision and accu-
racy of numerous theories and to provide recipes for
their improvement, large-scale studies of (single, binary,
and high-order multiple system) stars and their ensem-
bles (open and globular clusters, star-forming regions,
Galactic bulge, etc.) are vital to understand the struc-
ture, dynamics, and evolution of galaxies (e.g., Zari
et al. 2021). To that end, large-scale, all-sky, multi-
epoch ground-based spectroscopic surveys are irreplace-
able both as a stand-alone mechanism for astrophysi-
cal studies as well as a complement to all-sky astro-
metric and photometric space missions like Gaia and

TESS, respectively. To mention a few, the Sloan Dig-
ital Sky Survey (SDSS) has a two-decades long tradi-
tion in large-scale ground-based observations, starting
with the SDSS-I survey devoted to imaging and spec-
troscopy of galaxies and quasars (Richards et al. 2002;
Strauss et al. 2002), and now proceeding into its ﬁfth
phase/generation (SDSS-V, see Section 2) that will sur-
vey over ﬁve million stars in the Milky Way, study inter-
stellar gas in the Galaxy and Local Group, and will track
evolution of massive black holes growing at the centers
of galaxies (Kollmeier et al. 2017). The Large Sky Area
Multi-Object Fibre Spectroscopic Telescope (LAMOST)
provides a large collection of low-resolution (R∼1800)
spectra of stars of all spectral types through its Ex-
periment for Galactic Understanding and Exploration
(LEGUE) survey of the Milky Way structure (e.g., Deng
et al. 2012). Furthermore, the Gaia-ESO spectroscopic
survey (Gilmore et al. 2012) targets over 105 stars in
the Milky Way, complementing Gaia astrometric obser-
vations and providing the ﬁrst homogeneous overview
of the distributions of kinematics and elemental abun-
dances in the Galaxy. The GALactic Archaeology with
HERMES (GALAH, De Silva et al. 2015) survey aims to
survey over a million of stars of diﬀerent ages and at dif-
ferent locations in the Milky Way to uncover its forma-
tion and evolution history. Last but not least, the WHT
Enhanced Area Velocity Explorer (WEAVE, Bonifacio
et al. 2016) and the 4-metre Multi-Object Spectroscopic
Telescope (4MOST, de Jong et al. 2019) surveys allow
for multi-object low- to medium-resolution spectroscopic
observations, enabling chemical and kinematic studies of
all components of the Milky Way, extragalactic science
through observations of quasars, etc.

Analysis of this large volume of data is hardly a
manageable task when relying on human power only.
However, various machine learning (ML) based applica-
tions have proven the task to be rather easily accom-
plished by computers, provided respective algorithms
can be properly trained. For example, the Cannon
APOGEE spectrum analysis pipeline (Ness et al. 2015;
Casey et al. 2016) creates from the spectra of refer-
ence stars with known stellar labels (e.g., Teﬀ , log g,
and [M/H]) a ﬂexible generative model that describes
a probability density function for continuum normal-
ized stellar ﬂux as a function of the above-mentioned
labels. The algorithm assumes that the continuum nor-
malized ﬂux varies smoothly with the stellar labels, en-
abling fast and precise determination of stellar param-
eters from the previously unseen normalized spectra of
the surveyed stars. The Cannon algorithm is often re-
ferred to as a “data-driven approach” owing to the lim-
ited model dependency that occurs only at the stage

ZETA-PAYNE

3

of the algorithm training. Another example of, this
time, a fully model-dependent ML-based approach is the
(Hot)Payne (Ting et al. 2019; Xiang et al. 2021) al-
gorithm that employs a neural network as an eﬃcient
predictor of (continuum normalized) synthetic spectra.
When teamed up with an optimization algorithm, the
approach oﬀers a fast way to analyze large volumes of
spectroscopic data in the parameters space the neural
network has been trained in. Even a higher level of data
analysis is achieved with ML-based algorithms that em-
ploy the method of domain adaptation and oﬀer unique
opportunity to improve theoretical models by learning
from actual observations, as for example realized in the
cycle-starnet algorithm (O’Briain et al. 2021).

Any spectrum analysis starts with the most suitable
processing of raw stellar spectra that includes optimal
extraction (bias subtraction, ﬂat ﬁelding, wavelength
calibration, order merging in case of echelle spectra, etc.)
and (optionally) normalization to the local continuum
of the star.
In medium- to large-scale surveys, where
thousands to millions of stellar spectra have to be pro-
cessed, optimal data processing requires dedicated data
reduction pipelines, and the SDSS-V Milky Way Map-
per (MWM) Survey is no exception. As discussed in
Kollmeier et al. (2017) and Section 2, MWM relies on
the optical BOSS (Smee et al. 2013) and near-infrared
APOGEE (Wilson et al. 2019) spectrographs to execute
its science. Each of those instruments has a dedicated
data reduction pipeline that deliver one-dimensional,
merged, wavelength and ﬂux calibrated stellar spectra
ready for a subsequent detailed astrophysical analysis
and interpretation (Stoughton et al. 2002; Nidever et al.
2015).

Compared to most previous stellar spectroscopic sur-
veys, MWM will take spectra of many diﬀerent stars,
from red giants to OBA-type stars, to cool YSOs and X-
ray binaries. These cannot be modeled astrophysically
with a single pipeline. Therefore, the MWM Survey em-
ploys an overarching software framework called astra1.
In a nutshell, astra takes the 1D optimally reduced
spectra as input, passes those through fully automated
classiﬁers, makes a machine learning based probabilis-
tic decision on which data analysis pipeline(s) to call for
that particular input spectrum, and collects and formats
the pipeline’s output, i.e. the stellar “labels” (e.g., Teﬀ ,
log g, abundances, multiplicity, etc.). To minimize the
impact of possibly imprecise and/or erroneous classiﬁca-
tion, the three highest probability classes are considered

1 https://github.com/sdss/astra

for each stellar spectrum that passes through the classi-
ﬁcation module of astra.

In this paper, we build upon the legacy of the
(Hot)Payne algorithm (Ting et al. 2019; Xiang et al.
2021) to develop a machine-learning based (ML-based)
spectrum analysis method for the Milky Way Mapper
program of the SDSS-V survey, with a particular fo-
cus on intermediate- and high-mass stars of spectral
types O, B, A, and F, irrespective of whether those
are observed with the BOSS low-resolution optical or
the APOGEE medium-resolution near-IR instrument.
Our algorithm is implemented in the astra software
framework and is employed for the analysis of spectra
of OBAF-type stars targeted by MWM.

Section 2 provides a brief introduction to the SDSS-V
survey and its Milky Way Mapper program, as well as
a summary of the primary science questions that will
be addressed with the sample of OBA(F)-type stars.
Our spectrum analysis method is presented in Section 3,
where we describe and justify the changes made to the
original (Hot)Payne algorithm, discuss the training
process in detail, and introduce the optimization and
statistical uncertainty determination framework. The
algorithm is tested on simulated APOGEE and BOSS
spectra in Section 4 and is further validated on low-
to high-resolution spectra of real stars in Section 5.
We conclude the paper with a discussion and future
prospects presented in Section 6.

2. THE SDSS-V AND MILKY WAY MAPPER

SURVEYS

The SDSS-V survey has kicked oﬀ its observations
in the fall of 2020 and will remain on sky for a to-
tal survey duration of up to ﬁve years. SDSS-V is
an all-sky, multi-epoch survey whose spectroscopic ob-
servations will be acquired in the optical and near-IR
wavelength domains with matched infrastructures in
both hemispheres (Kollmeier et al. 2017). The survey
serves as an umbrella for its three overarching scien-
tiﬁc projects, called “Mappers”: Milky Way Mapper
(MWM), Local Volume Mapper (LVM), and Black Hole
Mapper (BHM). In brief, the LVM survey2 is an opti-
cal, integral-ﬁeld spectroscopic survey that will target
the mid plane of the Milky Way, Orion, and the Magel-
lanic Clouds, using newly built telescopes operating at a
resolving power of R∼4000. The ultimate goal of LVM
is to address questions of star formation and physics of
the interstellar medium through mapping the interstel-
lar gas emission with unprecedented spatial resolution:

2 https://www.sdss.org/dr15/future/lvm

4

Straumit et al.

sub-parsec in the Galaxy, 10 parsec in the Magellanic
Clouds, and <100 parsec out to distances of several Mpc.
The BHM survey3 will employ 2.5-meter telescopes in
both hemispheres, at Apache Point Observatory (Gunn
et al. 2006) and at Las Campanas Observatory (Bowen
& Vaughan 1973), to acquire multi-epoch, optical low-
resolution (R∼2000) BOSS spectroscopy of some 300
000 quasars. The ultimate goal of BHM is to understand
the masses, accretion physics, and growth and evolution
of supermassive black holes in the centers of galaxies.

The Milky Way Mapper survey4 of SDSS-V will em-
ploy both the BOSS low-resolution (R∼2000) optical
and the APOGEE medium-resolution (R∼22500) near-
IR spectroscopy. The survey will target over 4 mil-
lion objects to provide a dense and contiguous stel-
lar map across the sky but largely focused on low
Galactic latitudes. High signal-to-noise ratio (S/N),
medium-resolution near-IR spectra will be used to de-
duce stellar parameters and surface chemical composi-
tion of each star included in the program, providing the
means to understand the dominant formation mecha-
nisms of the Milky Way and its place in a cosmolog-
ical context. The MWM survey will also make use
of both optical and near-IR spectrographs to acquire
multi-epoch observations of tens of thousands multi-star
and planetary systems to understand formation, shap-
ing, and evolution of (sub-)stellar multi-companion sys-
tems. Last but not least, MWM will target stellar ob-
jects in a high-dimensional parameter space, including
stellar mass, age, evolutionary status, chemical com-
position, rotation, and internal structure. Among the
groups of stars that will be observed are young stellar ob-
jects, main-sequence stars, red giants, white dwarfs, low-
(M (cid:46)1.2 M(cid:12)), intermediate- (1.2 M(cid:12) (cid:46) M (cid:46) 8 M(cid:12)),
and high-mass (M (cid:38) 8 M(cid:12)) stars, etc. The MWM sur-
vey will address a wide range of scientiﬁc questions, such
as: true relationships between masses, radii, rotation,
ages, and internal mixing of intermediate- to high-mass
stars; precise age and chemical composition measure-
ments of giant stars with asteroseismic detections; im-
proved understanding of evolution of white dwarfs and
their return to the interstellar matter; observations of
deeply embedded stellar clusters and a volume-limited
(within ∼100 pc) census of stars in the solar neighbor-
hood. We refer the reader to Kollmeier et al. (2017)
for more information about the SDSS-V survey and its
Mappers.

3 https://www.sdss.org/dr15/future/bhm
4 https://www.sdss.org/dr15/future/mwm

2.1. Intermediate- to high-mass OBA(F)-type stars

The MWM survey of SDSS-V has a large science com-
ponent devoted to intermediate- and high-mass stars of
spectral types O, B, and A(F). Sample selection is done
in the spirit of the SDSS-V requirement of a known and
well-deﬁned selection function, and is therefore based on
Gaia EDR3 photometry and astrometry combined with
the 2MASS photometric information. First of all, the
sample is restricted to sources with Gaia Gmag < 16
due to the spectral-level requirement of the MWM sur-
vey that S/N of ∼ 75 has to be reached with 15 min
exposures with the BOSS instrument. Secondly, all ob-
jects whose absolute magnitude in the K photometric
band is smaller than zero are selected, which roughly
corresponds to a late B-type main-sequence star. Ulti-
mately, several color cuts are applied to clean the sam-
ple from intrinsically bright red giant- and asymptotic
giant-branch stars, as well as from objects with unnatu-
rally blue colors. The ﬁnal catalog comprises some 0.9M
objects, where the fraction of O- and B-type stars is es-
timated to be close to 50%. The other half of the sample
is largely comprised of A-type stars, though a small con-
tamination from F-type stars cannot be excluded. More
details about the target selection and estimation of the
purity and completeness of the catalog are provided in
Zari et al. (2021).

Following its science requirements, the MWM sur-
vey will deliver atmospheric properties of OBA(F)-type
stars with the precision better than 5-10% for the eﬀec-
tive temperature Teﬀ , better than some 25-30% for the
projected rotational velocity v sin i, ∼0.1 dex for the
surface gravity log g, and ∼0.15 dex for the bulk metal-
licity [M/H] and surface abundances of critical chemical
elements such as He, C, N, O, Si, and Mg (perhaps more
limited for the hottest O-type stars). With such a large
sample of multi-epoch spectra we can probe:

• The intrinsic variability (stellar pulsations, rota-
tional modulation, quasi-periodic variability, etc.),
internal properties (interior rotation and mix-
ing, convective core masses, etc.), and ages of
intermediate- to high-mass stars, thanks to syn-
ergy with the Kepler and TESS space-based pho-
tometric surveys. For example, we will be able to
better assess fractions of Ae/Be stars and mag-
netic intermediate- to high-mass stars, where the
latter can be unraveled by indirect means through
photometric detections of rotational modulation
and spectroscopic inferences of surface chemical
abundance anomalies. Stellar pulsations will be
used in combination with spectroscopically in-
ferred atmospheric parameters to learn about in-

ZETA-PAYNE

5

In particular,

ternal physical properties of stars, using well-
established asteroseismic methods (Aerts et al.
2018, 2019; Aerts 2021).
it was
recently demonstrated that internal rotation and
mixing properties of B-type main-sequence stars
can be readily inferred from a combined asteroseis-
mic and spectroscopic analysis (e.g., P´apics et al.
2017; Pedersen et al. 2018, 2021). Moreover, Bow-
man et al. (2019, 2020) demonstrate that high-
mass O-type stars and evolved B-type supergiants
also hold strong asteroseismic potential even at
metallicities as low as that of the LMC, thanks
to the observational detection of low-frequency
stochastic variability such as the one caused by
internal gravity waves excited at the interface of
convective and radiative regions near the stellar
core (Edelmann et al. 2019; Horst et al. 2020);

• binary

fractions

and multiplicity

among
intermediate- to high-mass stars across the sky
and as a function of metallicity (Galaxy vs. Mag-
ellanic Clouds). Sana et al. (2012, 2013) ﬁnd a
large fraction of binaries among massive stars and
hypothesize that almost all high-mass stars have
gone through some sort of binary interactions in
the course of their evolution. Notably, Almeida
et al. (2017) report some 60% observed binary
fraction among O-type stars in the 30 Dor region
of the LMC, while Bodensteiner et al. (2021) and
Banyard et al. (2021) ﬁnd similar binary fractions
for B-type stars in the SMC and Galaxy, respec-
tively. Luo et al. (2021) report a comparable
binary fraction of ∼40% from their study of some
330 OB-type stars observed by LAMOST having
at least three spectroscopic epochs. The Milky
Way Mapper Survey of SDSS-V will deliver opti-
cal and near-IR measurements for a three orders
of magnitude larger sample of OBA(F)-type stars,
thus allowing for a homogeneous search for binary
and higher-order multiple systems in the Galaxy
and Magellanic Clouds;

• the structure of the Galaxy as revealed by its
young stellar components, in particular the kine-
matics, dynamics, and nature of the Galactic spi-
ral arms. Zari et al. (2021) demonstrate that the
structure of the Milky Way as traced with young
OB-type stars is not necessarily the same as de-
duced from observations of red giants, from anal-
ysis of the distribution of dust in the Galaxy, or
from the distributions of Cepheids and/or masers
(see also Poggio et al. (2021)). The authors ﬁnd
that the distribution of OBA-type stars in the

plane is highly structured, with pronounced over-
and under-densities, and conclude that young stars
in the Galaxy are not neatly organized into dis-
tinct spiral arms.
In agreement with previous
studies of OB-type stars in literature, Zari et al.
(2021)’s ﬁndings might point either to a more ﬂoc-
culent structure of the Milky Way at optical wave-
lengths or to the fact that star formation occurs
in a clumpy and patchy fashion. The authors em-
phasize that better quality Gaia DR3 data and
spectroscopic information from the SDSS-V sur-
vey will allow them to assess diﬀerent models of
spiral arms and shed light on their nature.

3. SPECTRUM ANALYSIS ALGORITHM

As it was brieﬂy mentioned in Section 1, we aim to
develop an eﬃcient spectrum analysis algorithm for the
Milky Way Mapper survey of SDSS-V, with the primary
focus on intermediate- to high-mass stars of spectral
types O, B, A, and F. One of the main requirements at
this stage is a wide applicability range of the algorithm
in terms of the wavelength coverage and resolving power
of the obtained spectra, and without the need for human
intervention between data reduction pipelines and spec-
trum analysis itself. Here, we use the heritage of one of
the publicly available ML-based methods, namely the
(Hot)Payne algorithm (Ting et al. 2019; Xiang et al.
2021), to which we introduce a number of modiﬁcations
to comply with the aforementioned primary requirement
of MWM.

It is quite common to use optical

low- to high-
resolution spectra to deduce atmospheric parameters
of intermediate- to high-mass OBAF-type stars, un-
less there is an interest in, e.g., speciﬁc UV lines to
study winds of massive stars, etc. On one hand, op-
tical spectra of late-type stars will often contain im-
portant diagnostic lines of hydrogen (the Balmer se-
ries) and/or helium, a large number of metal
lines
(e.g. C, N, O, Mg, Si, Al, etc.), and (in many cases)
quite well-deﬁned regions of pseudo-continuum, making
it possible to achieve high-quality spectrum normaliza-
tion. To give a few examples, methods such as Spec-
troscopy Made Easy5 (SME, Valenti & Piskunov 1996;
Piskunov & Valenti 2017), Grid Search in Stellar Param-
eters6 (GSSP, Tkachenko 2015), the detail (Giddings
1981) and surface (Butler 1984) suite of codes, are all
designed to work with continuum-normalized observed

5 https://www.stsci.edu/∼valenti/sme.html
6 https://fys.kuleuven.be/ster/meetings/binary-2015/

gssp-software-package

6

Straumit et al.

Figure 1. Left: normalized synthetic spectra of (from top to bottom) OBAF-type stars computed with the gssp software
package in the APOGEE wavelength range. Vertical dashed lines in the top plot indicate positions of hydrogen lines of the
Brackett series, while vertical solid lines mark positions of the He II lines at 1.5722 µm and 1.6923 µm, whose wavelengths are
taken from Lenorzer et al. (2004). Right: normalized synthetic spectra for the same stellar parameters in the BOSS wavelength
range (only part of the full range is shown for clarity).

Table 1. Parameters of the training sets used for training neural networks in this study. See text for details.

optical

near-IR
APOGEE

Parameter

0.05

BOSS
3 600...10 400
0.06

Wavelength range, ˚A 15 000...17 000
Wavelength step, ˚A
Number of models
Teﬀ , K
log g, dex
v sin i, km s−1
[M/H], dex

HERMES
4 200...5 800
0.015
5000 Sobol + 5000 Gaussian
Sobol(6000...25000) + Gaussian(6000, 3000)
Sobol(3.0...5.0)
Sobol(0...400) + Gaussian(0, 25)
Sobol(-0.8...0.8)

spectra and are most often applied in the optical wave-
length range. On the other hand, use of near-IR spec-
tra for the analysis of intermediate- to high-mass stars
is rather scarce owing to few diagnostic (metal) lines
occurring at those wavelengths and to problems associ-
ated with often uncertain normalization of spectra to the
pseudo-continuum. Roman-Lopes et al. (2018) demon-
strate that the APOGEE near-IR spectra (wavelength
coverage from 1.5 to 1.7 µm) of OB-type stars are rather
featureless and display exclusively hydrogen lines of the
Brackett series and at most two He II lines at higher
temperatures corresponding to O-type stars. The au-
thors, alongside Ram´ırez-Preciado et al. (2020), develop

a (semi-)empirical spectral classiﬁcation method for hot
OB-type stars based on equivalent width (EW) measure-
ments of key spectral lines in the APOGEE spectra, and
making use of the SPM instrument medium-resolution
and LAMOST survey low-resolution optical spectra, re-
spectively, to benchmark their relations. Their method
has recently been extended and applied to the APOGEE
spectra of cooler A-type stars (Ramirez-Preciado et al.,
in revision).

Here, we aim to develop a spectrum analysis approach
that can be applied to APOGEE spectra of OBAF-type
stars (where high density of hydrogen lines prevents pre-
cise normalization of spectra to the local continuum) and

0.80.91.0Normalized flux0.80.91.0Normalized flux0.80.91.0Normalized flux1.5001.5251.5501.5751.6001.6251.6501.6751.700Wavelength [m]0.80.91.0Normalized flux0.51.0Normalized flux0.51.0Normalized flux0.51.0Normalized flux380400420440460480500Wavelength [nm]0.51.0Normalized fluxZETA-PAYNE

7

to BOSS optical spectra without the need for a substan-
tial modiﬁcation of the algorithm. That said, speciﬁcs
of the APOGEE near-IR spectra of OBAF-type stars
is what drives our deﬁnition of the model spectrum as
described in Section 3.1. However, it does not mean
that we value the medium-resolution near-IR spectra
more than their low-resolution optical counterpart. On
the contrary, as we demonstrate and conclude in Sec-
tions 5 and 6, respectively, low-resolution optical spec-
tra of OBAF-type stars will often contain more infor-
mation than medium-resolution near-IR spectra of these
objects, hence both types of data deserve our attention
in equal proportions.

3.1. Representation of a model spectrum

A fully automated analysis of the APOGEE near-
IR and BOSS optical spectra of OBAF-type stars in
the entire wavelength range requires a careful treatment
of pseudo-continuum in the model. As demonstrated
in Figure 1 (left panel), the high density of hydrogen
lines in the near-IR part of the stellar spectrum, com-
bined with the (typically) moderate- to high rotation
of OBAF-type stars, makes determination and place-
ment of the pseudo-continuum extremely diﬃcult, and
in the case of hotter OB-type stars often impossible.
The same is true for the BOSS optical spectra when the
most blue and red parts of the spectrum are included in
the analysis, where hydrogen lines of, respectively, the
Balmer and Paschen series start merging together. In
addition, even when the above-mentioned wavelength in-
tervals are omitted in the analysis, the remaining wave-
length range of the BOSS instrument is suﬃciently wide
to observe signiﬁcant variations that are instrumental in
origin. Therefore, we incorporate a theoretical function
into the model spectrum that aims to account for instru-
mental eﬀects, possible interstellar reddening, and local
stellar continuum, thus eliminating the need to process
the input observed spectrum in a way beyond its optimal
extraction. The instrumental eﬀects that are taken into
account in the model are: (i) the wavelength-dependent
residual response function of the instrument that pro-
duces a large-scale distortion of the observed spectrum,
and (ii) the line-spread function (LSF) that causes blur-
ring of spectral lines in the observed spectrum. Ob-
served spectra in the APOGEE entire wavelength range
and the BOSS red part of the spectrum are rich in tel-
luric contributions that are removed by the data reduc-
tion pipeline using observations of telluric standard stars
(typically, rapidly rotating stars of spectral types B and
A; Nidever et al. 2015). Thus, a general model of a stel-
lar spectrum, as it comes out of the SDSS data reduction

pipeline(s), can be written down as follows:

Flux = LSF ∗ [

(cid:89)

i

Linei(Teﬀ , log(g), ...)] × Response(λ).

(1)
Here, LSF is the line-spread function, Linei are the spec-
tral lines formed in the stellar photosphere character-
ized by a set of parameters Teﬀ , log g, v sin i, [M/H],
vmicro (microturbulent velocity), and Response(λ) is
a wavelength-dependent theoretical function that ac-
counts for instrumental eﬀects, interstellar reddening,
and local stellar continuum contributions. For simplic-
ity and from now onwards, we dub the Response(λ)
the “residual response function”. We include two op-
tions to account for the line-spread function of the in-
strument, a simpliﬁed approach where the LSF is rep-
resented by a wavelength-independent Gaussian kernel
with the full width at half maximum corresponding to
a given resolving power R of the instrument, and a de-
tailed wavelength-dependent model of the LSF that will
also be variable from ﬁber to ﬁber. The latter is usu-
ally estimated from a spectrum of the wavelength cali-
bration unit and is available for both instruments (i.e.,
BOSS and APOGEE) of the MWM survey. The residual
response function is modelled as a series of Chebyshev
polynomials, i.e.:

Response(λ) =

(cid:88)

i

ciTi(λ),

(2)

where ci are the coeﬃcients of the series, Ti are the
Chebyshev polynomials of the ﬁrst kind, and λ is the
wavelength. Figure 2 shows a representative example of
the model spectrum of a B-type star in the APOGEE
(left) and BOSS (right) wavelength ranges. The nor-
malized synthetic spectrum, a model of the residual re-
sponse function, and their product are shown in the top,
middle, and bottom panel, respectively.

3.2. Neural network conﬁguration, training, and

validation

Following Ting et al. (2019), we use a neural network
to approximate a grid of model spectra, where the neu-
ral network essentially acts as an eﬃcient interpolator in
the parameter space deﬁned by the pre-computed grid
of models. The main purpose of using a neural net-
work is to make the model spectra diﬀerentiable by the
stellar parameters, which allows us to perform optimiza-
tion instead of a full grid search. Aside from that, the
neural network is trained on a quasi-random grid as de-
ﬁned in Sobol (1967), which is more time eﬃcient than
computing a full grid of model spectra with the same
parameter range. At present, we use the gssp software
package (Tkachenko 2015) to compute a grid of models

8

Straumit et al.

Figure 2. From top to bottom: synthetic APOGEE (left) or BOSS (right) spectrum of a B-type star, random ﬁfth-order
Chebyshev polynomial (model of the unknown response function), and a product of the synthetic spectrum with the model of
the response function.

required for the neural network training. gssp employs a
grid of plane-parallel atmosphere models pre-computed
with the LLmodels code (Shulyak et al. 2004) coupled
to the SynthV (Tsymbal 1996) line formation code to
calculate synthetic spectra in an arbitrary wavelength
range. Both codes rely on the local thermodynamical
equilibrium (LTE) approximation and include the op-
tion to compute the atmospheric structure and detailed
line formation for a user-speciﬁed chemical composition
pattern (including vertical stratiﬁcation of elements in
the stellar atmosphere, if necessary).

The neural network consists of two layers of neurons
with “leaky ReLU” (leaky rectiﬁer linear unit) activa-
tion function, which is deﬁned as follows:




x

g(x) =

if x > 0,

(3)



0.01x otherwise.

Once the neural network has been trained, it takes stel-
lar parameters normalized to the range [−0.5, 0.5] as in-
put and returns the corresponding synthetic spectrum as
the output. This means that the number of the neural
network outputs is equal to the number of spectral chan-
nels in the training set of synthetic spectra. Theoretical
spectra for the training set are computed at inﬁnite re-
solving power and cover wavelength ranges of the SDSS-
V BOSS and APOGEE instruments, i.e. 3 600 - 10 400 ˚A
and 1.5 - 1.7 µm, respectively. Table 1 provides a sum-
mary of the properties of the training set in terms of the
total number of models used, wavelength range cover-

age, and deﬁnition of the parameter space. The network
is implemented and trained with the torch framework
using the RAdam optimization algorithm discussed in
detail in Liu et al. (2019).

We note that the optical wavelength range speciﬁed
for the HERMES instrument in Table 1 that we use for
the algorithm validation in Section 5 is shorter than its
full wavelength coverage from 3 770 ˚A to 9 000 ˚A. This
is due to the memory limitation of the computing de-
vice currently used for the training, as the large number
of models and the ﬁne wavelength step of 0.015 ˚A dic-
tated by the high-resolution of the HERMES instrument
do not allow us to train a neural network for the full
wavelength range. We choose to work with the wave-
length interval from 4 200 ˚A to 5 800 ˚A for the following
reasons: 1) it includes spectral lines of hydrogen from
the Balmer series (Hγ, and Hβ), and in case of hot-
ter OB-type stars several spectral lines of helium, that
are usually employed as the main diagnostic lines for
determination of the eﬀective temperature and surface
gravity of OBAF-type stars (Massey et al. 2009), 2) it
also includes a plethora of metal lines that serve as the
main diagnostic for the inference of the metallicity and
projected rotational velocity (and extra line broadening
parameters, if applicable) of the star, and 3) parts of the
HERMES optical spectrum blue- and red-wards the cho-
sen wavelength interval suﬀer from high levels of noise
and large contributions from telluric lines, respectively.
Finally, because we (in particular) perform a compar-
ative analysis between high- and low-resolution optical

0.80.91.0Normalized flux0.80.91.01.501.551.601.651.70Wavelength [m]0.80.91.0Normalized flux0.500.751.00Normalized flux0.500.751.0030040050060070080090010001100Wavelength [nm]0.500.751.00Normalized fluxZETA-PAYNE

9

spectroscopy in this work (see Section 5 for details), the
exact overlap between the two types of data in terms of
the considered wavelength interval is much more critical
than the exact length of the interval used, unless it is
unrealistically short (which is not the case here).

For the training set, we ultimately use a hybrid grid
that consists of a combination of a quasi-random Sobol
grid that covers the entire parameter space of interest
and an additional random grid sampled from a Gaus-
sian distribution in a restricted region of the parameter
space, as demonstrated in Figure 3. A quasi-random
Sobol grid has the useful property that it covers the
parameter space uniformly regardless of the number of
points in the grid, unlike a true random uniform dis-
tribution, which may produce ‘clumps’ of points and
regions of the parameter space that are poorly sampled.
The need for a hybrid grid arises from inferior perfor-
mance of the neural network in the APOGEE wave-
length range in the regime of slowly rotating late A- to
F-type stars (Teﬀ (cid:46) 10000 K and v sin i (cid:46) 30 km s−1)
when it is trained on a quasi-random Sobol grid only.
The low performance of the neural network in this
regime is associated with a high (morphological) com-
plexity of stellar spectra that are found to exhibit a large
number of narrow spectral lines of metals as compared
to spectra of hotter and more rapidly rotating stars (see,
e.g., a comparison between APOGEE spectra of B- and
F-type stars in Figure 1). When trained exclusively on a
quasi-random Sobol grid (see left panel in Figure 3), the
neural network does not have enough examples of highly
complex spectra and experiences performance diﬃcul-
ties in the corresponding region of the parameter space.
Adding a random sample of models from a Gaussian dis-
tribution Teﬀ ∼ N (6000, 3000), v sin i ∼ N (0, 25) (see
right panel in Figure 3) resolves the issue and equal-
izes the neural network performance across the entire
parameter space. The grid used for training the neu-
ral network eventually consists of 10 000 models, equally
split between the Sobol quasi-random and extra random
grids.

Training of the neural network is performed in an it-
erative fashion. The combined grid of 10 000 models is
split into training and validation sets, where the former
comprises 90% of models while the latter contains the
remaining 10%. Note that the validation set is diﬀerent
from the test set, which is used to evaluate performance
of the network after it is trained (Section 4); the test set
is generated separately from the validation set. At every
iteration, the neural network coeﬃcients are optimized
based on the training set using the RAdam optimization
algorithm. The training is done in batches of 1000 mod-
els, selected randomly from the training set of models;

the number of batches used at every iteration equals the
total number of models in the training set divided by the
batch size. Every 100-th iteration, a score is calculated
based on the validation set, and if the new score is better
than any of the previous scores, the network weights are
saved into a ﬁle. This process is run for a ﬁxed number
of 104 iterations that we found experimentally to be suf-
ﬁcient for the convergence. Figure 4 shows the evolution
of the score during the neural network training process.

3.3. Model ﬁtting and parameter statistical uncertainty

The best stellar parameters for an input observed
spectrum are found by performing minimization of the
χ2 merit function deﬁned as:

(cid:88)

χ2 =

i

(cid:18) fi − F (θ, λi)
σi

(cid:19)2

.

(4)

Here, fi represents the observed ﬂuxes with errors σi, θ
is the stellar parameter vector and λi is the wavelength
grid. F (θ) is the model spectrum deﬁned as:

F (θ) = {LSF ∗ D[NN(θ, λi), vr]} × R(λi),

(5)

where NN(θ, λi) is the neural network output for stellar
parameters θ, the operator D[·, vr] performs a Doppler
shift of the input observed spectrum according to the
radial velocity vr, and R(λi) = Response(λ) represents
the residual response function as deﬁned in Eq. (2).

Optimization of the objective function is done us-
ing the “Trust Region Reﬂective” method discussed in
Branch et al. (1999). In the ﬁrst instance, we use the
central point of the parameter space of the neural net-
work training set to initialize the optimization algo-
rithm, and investigate the algorithm convergence prop-
erties based on artiﬁcial spectra of OBAF-stars. These
tests reveal a non-negligible number of cases where the
optimization algorithm gets stuck in a local minimum
located in a wrong region of the parameter space. The
most common failures of the optimization algorithm are
associated with it getting stuck above or below Teﬀ of
some 10 000 K, and this divergence of the algorithm is
most pronounced for the APOGEE near-IR spectra. We
solve the issue by providing the algorithm with a bet-
ter (lower χ2) initial guess for the (stellar) parameters
vector instead of consistently using the central point of
the neural network training grid. In order to ﬁnd a bet-
ter starting point for the optimization, we ﬁrst perform
a global (pre-)search by visiting a number of points in
the stellar parameters space, passing the value of the
parameters at a given point to the neural network and
checking the value of χ2 at every point, with the aim to
ﬁnd the point that achieves the lowest χ2. In order to

10

Straumit et al.

Figure 3. Left: a quasi-random grid of synthetic APOGEE spectra, projected onto the Teﬀ -log g plane. Right: an additional
random sample of models to increase the density of the grid in the low Teﬀ -v sin i region. The probability density functions for
Teﬀ and v sin i from which the points are sampled are shown in the left and bottom panels, respectively.

sponding to the lowest χ2 merit function is identiﬁed as
the most suitable initial guess for the input (observed)
spectrum. The identiﬁed initial guess is then applied in
a ﬁnal round of optimization in the combined space of
stellar parameters and Chebyshev coeﬃcients, to derive
their optimal values and functional form for the observed
spectrum in question.

The statistical uncertainty of the stellar parameters
is calculated by ﬁtting a second-degree polynomial to
the χ2 distribution for each of the parameters, which is
equivalent to assuming a Gaussian form of the poste-
rior probability distribution. Due to the ﬁnite resolving
power of the instrument, the spectrum has less degrees
of freedom than the number of spectral bins. To account
for this, we calculate the eﬀective number of degrees of
freedom as follows:

Ndeg = 4R

λend − λstart
λstart + λend

,

(6)

where R is the resolving power of the instrument, while
λstart and λend determine the wavelength range covered
by the spectrum. The eﬀective number of degrees of
freedom Ndeg is used to compute the 1σ statistical un-
certainty level in terms of χ2:
(cid:113)

χ2

1σ = 1 +

2/Ndeg.

(7)

Ultimately, the statistical uncertainty interval for the
parameter in question is found from the intersection
points of the second order polynomial ﬁtted to the χ2
distribution with the horizontal line drawn at χ2
min,
where χ2
min is the minimum value of the second-order
polynomial.

1σ ·χ2

Figure 4. Score as a function of iteration number during
the training of a neural network.

make the search scalable for diﬀerent numbers of points
(currently we set it to 4000), we use the Sobol algorithm
to generate the set of points to visit, so that it covers
the parameter space uniformly.

The preliminary search is performed in the space of
stellar parameters and radial velocity. Because the main
purpose of the pre-search step is to locate a sensible ini-
tial guess in the fastest possible way, we decouple mod-
eling of the residual response function from the stellar
parameter and radial velocity estimation at this stage.
This way, we ﬁrst perform a run of the optimization al-
gorithm starting from a point in the center of the param-
eter space, which provides a ﬁrst estimate for a vector
of the Chebyshev coeﬃcients that describe the residual
response function. This set of coeﬃcients is then used
to perform a pre-search in the stellar parameter space
(including radial velocity). After that, a point corre-

0.000.01Prob. dens.020406080v*sin(i) [km/s]600080001000012000140001600018000T_eff [K]020406080v*sin(i) [km/s]600080001000012000140001600018000T_eff [K]0.000000.000050.00010Prob. dens.020406080100Iteration number/1001.52.02.53.03.54.0Log10(loss)ZETA-PAYNE

11

generated with the gssp software package and for a ran-
dom set of stellar parameters. The spectra are shifted
in wavelength according to a random radial velocity
(uniformly distributed from -50 to 50 km−1), convolved
with a Gaussian function to simulate limited spectral
resolution of the instrument (R≈22 500 and 2 000 for
APOGEE and BOSS, respectively), and multiplied by
a random ﬁfth-order Chebyshev series imitating the in-
strumental response function. Finally, Poisson noise is
added to the spectrum to simulate varying quality levels
of observations in terms of signal-to-noise-ratio (S/N),
where we consider the cases of S/N = ∞ (noiseless ar-
tiﬁcial data), 100, and 50.

The sets of simulated APOGEE and BOSS spectra
are generated to have a uniform density in the param-
eter space. The sampling is done using a quasi-random
(Sobol) algorithm in the stellar parameter space and
is assumed to be the same for both instruments (see
top panel in Figure 5 for the projection of the dataset
on the Teﬀ -v sin i plane). This way, we are not only
able to quantify the parameter internal uncertainties in
both wavelength ranges, but also to perform a cross-
validation between the medium-resolution near-IR and
low-resolution optical regimes. We also make sure that
the test dataset has zero overlap with the neural network
training set (see bottom panel in Figure 5).

The mock spectra are analyzed with the ZETA-
PAYNE algorithm and the internal uncertainty is calcu-
lated as follows: (i) a diﬀerence in the true versus pre-
dicted parameter value ∆θ is calculated and the 16th,
50th and 84th percentiles (further labelled as P16, P50
and P84) of the obtained distributions are computed;
(ii) models with the parameter value diﬀerences satisfy-
ing the criterion 4(P50 + P16) < ∆θ < 4(P50 + P84) are
selected as achieving a satisfactory ﬁt of the model to
the mock spectrum, while the rest are classiﬁed as failing
to converge to the correct model. The internal uncer-
tainty is then calculated based on the converged models.
Thus the performance of the method is characterized by
the internal uncertainty as well as by the reliability met-
ric, i.e. the probability that the optimization algorithm
converges to a correct value. The internal uncertainty
reﬂects (i) how well the neural network is able to pre-
dict synthetic ﬂuxes for a given set of stellar labels, and
(ii) how good the performance of the chosen minimiza-
tion algorithm is in ﬁnding and converging to the global
minimum in the parameter space.

Results of the application of the ZETA-PAYNE al-
gorithm to the set of 1000 artiﬁcial noiseless APOGEE
spectra are summarized in Figure 6, where we compare
the parameters inferred from the simulated data with
their true values. The diﬀerences between the inferred

Figure 5. Top: the Teﬀ -v sin i distribution of the 1 000
simulated spectra that are used to estimate the internal un-
certainty. Bottom: comparison of the training (crosses) and
test (dots) grids. See text for details.

4. PERFORMANCE OF THE “ZETA-PAYNE”

ALGORITHM ON SIMULATED DATA

In order to evaluate the internal uncertainty for stellar
parameters intrinsic to the developed modelling frame-
work in Section 3, we perform a simulation study where
a 1 000 artiﬁcial APOGEE and BOSS spectra are gener-
ated and subsequently processed as if they were obser-
vations of real stars. The simulated spectra are created
on the actual APOGEE and BOSS wavelength grids,
covering a wavelength range from 1.5 µm to 1.7 µm and
from 3 600 ˚A to 10 400 ˚A, respectively. For APOGEE
spectra, we also introduce two wavelength gaps between
CCD sensors to resemble real observations as close as
possible. The spectra for these simulated datasets are

10000150002000025000Teff [K]3.003.253.503.754.004.254.504.755.00log(g) [cm/s^2]90001000011000120001300014000Teff [K]4.04.14.24.34.44.54.6log(g) [cm/s^2]12

Straumit et al.

Table 2. Root mean square errors (internal uncertainty) per bin for the stellar parameters recovered by the developed ZETA-
PAYNE algorithm from simulated noiseless APOGEE and BOSS spectra (mimicking inﬁnite S/N value). The uncertainties are
reported for both instruments and as a function of Teﬀ and v sin i of the spectrum.

Parameter

Bin 1 Bin 2

Bin 3

Bin 4

Internal uncertainty (RMS)
Bin 5

Bin 6

Bin 7

Bin 8

Bin 9

Bin 10

Bin, kK
Teﬀ , K
log g, dex
v sin i, km s−1
[M/H], dex
RV, km s−1

Bin, km s−1
Teﬀ , K
log g, dex
v sin i, km s−1
[M/H], dex
RV, km s−1

Bin, kK
Teﬀ , K
log g, dex
v sin i, km s−1
[M/H], dex
RV, km s−1

Bin, km s−1
Teﬀ , K
log g, dex
v sin i, km s−1
[M/H], dex
RV, km s−1

6-7.9
670
0.15
13
0.23
4.5

0-40
709
0.05
18
0.32
0.4

6-7.9
50
0.09
19
0.06
1.1

0-40
174
0.03
19
0.08
0.3

7.9-9.8
579
0.05
13
0.35
1.1

9.8-11.7
269
0.04
12
0.32
0.7

11.7-13.6
249
0.03
11
0.42
0.7

40-80
643
0.05
14
0.30
0.7

80-120
644
0.08
14
0.38
0.6

120-160
653
0.08
15
0.37
0.7

APOGEE instrument
as function of Teﬀ

13.6-15.5
354
0.05
14
0.40
0.9

15.5-17.4
563
0.06
15
0.43
0.9
as function of v sin i

17.4-19.3
908
0.06
15
0.40
1.1

19.3-21.2
1048
0.06
17
0.49
1.2

21.2-23.1
949
0.05
12
0.41
1.4

160-200
728
0.06
14
0.41
0.7

200-240
764
0.07
15
0.46
2.1
BOSS instrument
as function of Teﬀ

240-280
821
0.07
12
0.44
1.4

280-320
657
0.08
11
0.38
1.8

320-360
609
0.06
10
0.46
3.5

23.1-25
764
0.07
16
0.51
1.4

360-400
776
0.08
12
0.46
2.0

7.9-9.8
80
0.06
16
0.11
1.2

9.8-11.7
96
0.04
15
0.11
0.5

11.7-13.6
83
0.02
11
0.07
0.4

13.6-15.5
98
0.02
11
0.11
0.2

15.5-17.4
146
0.02
13
0.08
0.2

17.4-19.3
197
0.02
12
0.09
0.4

19.3-21.2
209
0.02
10
0.09
0.4

21.2-23.1
222
0.02
11
0.08
0.3

23.1-25
268
0.04
15
0.12
0.7

as function of v sin i

40-80
144
0.04
16
0.08
0.4

80-120
158
0.04
15
0.08
0.3

120-160
166
0.05
16
0.11
0.4

160-200
157
0.04
8
0.07
0.6

200-240
149
0.04
9
0.08
0.5

240-280
152
0.04
9
0.09
0.7

280-320
175
0.05
10
0.13
1.0

320-360
159
0.04
9
0.09
0.7

360-400
180
0.06
10
0.11
1.0

Table 3. Root mean square errors (internal uncertainty) averaged over the entire parameter space for the stellar parameters
as inferred from the simulated APOGEE and BOSS spectra with realistic noise levels.

Parameter

APOGEE

BOSS

Internal uncertainty (RMS)

Teﬀ , K
log g, dex
v sin i, km s−1
[M/H], dex
RV, km s−1
Reliability

noiseless S/N = 100 S/N = 50 noiseless S/N = 100 S/N = 50
707
0.07
14
0.41
1.67
96.2 %

736
0.08
17
0.46
3.65
96.5 %

791
0.09
23
0.50
6.30
95.6 %

163
0.043
14
0.10
0.65
95.6 %

177
0.044
15
0.10
1.29
97.4%

206
0.045
16
0.11
2.19
97.3%

ZETA-PAYNE

13

Figure 6. Diﬀerences between the parameters inferred with the ZETA-PAYNE algorithm from the simulated noiseless APOGEE
spectra and their true values (black dots), as a function of the true Teﬀ (left) and v sin i (right). From top to bottom: the
diﬀerences are shown for Teﬀ , log g, v sin i, [M/H] and RV. The internal uncertainties per parameter bin are shown with the
magenta full circles with error bars; deﬁnition of the individual parameter bins is given in Table 2.

1000015000200002500002000T_eff [K]010020030040002000100001500020000250000.00.5log(g) [cm/s^2]01002003004000.00.510000150002000025000050v*sin(i) [km/s]010020030040005010000150002000025000101[M/H] [dex]010020030040010110000150002000025000True T_eff [K]20020RV km/s0100200300400True v*sin(i) [km/s]2002014

Straumit et al.

Figure 7. Eﬀect of the Teﬀ and log g parameter changes on the appearance of stellar spectra of late A- to early F-type stars
in the wavelength range of the APOGEE instrument. Top and bottom rows show the eﬀect at signiﬁcantly sub-solar ([M/H]
= -0.8 dex) and solar ([M/H] = 0.0 dex) metallicity, respectively. Left column: blue, orange, and green lines represent models
with Teﬀ = 8 000, 9 000, and 10 000 K, respectively; log g and v sin i are kept ﬁxed at 4.0 dex and 150 km s−1, respectively.
Right column: blue, orange, and green lines represent models with log g = 3.5, 4.0, and 4.5 dex, respectively; Teﬀ and v sin i
are kept ﬁxed at 9 000 K and 150 km s−1, respectively.

and true parameter values are presented for (from top
to bottom) Teﬀ , log g, v sin i, and [M/H], and as a func-
tion of true Teﬀ (left column) and v sin i (right column).
In each panel in Figure 6, we divide the corresponding
dataset into ten equal width bins and compute the inter-
nal uncertainty in each of those bins as described above.
The resulting internal uncertainties per parameter bin
are shown as magenta full circles with error bars in Fig-

ure 6, with the corresponding numerical values listed in
the top part of Table 2 (designated as the “APOGEE
instrument”). The most notable feature seen in Fig-
ure 6 is a “tail” of models in the Teﬀ range between
some 8 000 K and 10 000 K in the top left panel, where
we record about 25 of the ZETA-PAYNE best ﬁt models
that show Teﬀ discrepancies of above some 600 K and up
to some 2 500 K with the true values. The discrepancy

1500015500160001650017000Wavelength [Å]0.8000.8250.8500.8750.9000.9250.9500.9751.000Normalized fluxTeff = 8000 KTeff = 9000 KTeff = 10000 K1500015500160001650017000Wavelength [Å]0.8000.8250.8500.8750.9000.9250.9500.9751.000Normalized fluxlog(g) = 3.5 dexlog(g) = 4.0 dexlog(g) = 4.5 dex1500015500160001650017000Wavelength [Å]0.800.850.900.951.00Normalized fluxTeff = 8000 KTeff = 9000 KTeff = 10000 K1500015500160001650017000Wavelength [Å]0.8000.8250.8500.8750.9000.9250.9500.9751.000Normalized fluxlog(g) = 3.5 dexlog(g) = 4.0 dexlog(g) = 4.5 dexZETA-PAYNE

15

is conﬁned to that speciﬁc ∼2 000 K wide Teﬀ interval
and occurs in the low [M/H] - high v sin i range of the
parameter space. As demonstrated in the top left panel
in Figure 7, the APOGEE spectra are dominated by the
Brackett series of hydrogen lines having very low sensi-
tivity to the Teﬀ variations in that particular Teﬀ inter-
val. Therefore, metal lines represent an important Teﬀ
diagnostic. However, the cumulative eﬀect of low metal-
licity and high projected rotational velocity of the star
makes metal lines appear weak and shallow. Altogether,
the overly weak metal lines and low sensitivity of the
Brackett series to Teﬀ variations act as a source of confu-
sion (hence large internal uncertainty) for the spectrum
analysis algorithm in the Teﬀ bin under consideration.
The degeneracy gets progressively smaller with increas-
ing metallicity (and decreasing projected rotational ve-
locity), so that the internal uncertainty in Teﬀ becomes
comparable to adjacent Teﬀ bins as [M/H] approaches
the solar value (see bottom left panel in Figure 7 where
the growth of strength of metal lines compared to the
low [M/H] case is visible). We also note a larger inter-
nal uncertainty in the eﬀective temperature of the star
at Teﬀ (cid:38) 15 000 K (top left panel in Figure 6) that we at-
tribute to the fact that the APOGEE spectra of late O-
and B-type stars are largely featureless and dominated
by the Brackett series of broad hydrogen lines. The spec-
tra additionally suﬀer from two wavelength gaps present
in the APOGEE data that reduce the amount of avail-
able information and thus contribute to the internal un-
certainty. A lower internal uncertainty in metallicity of
the star is also seen in the low Teﬀ ((cid:46) 8 000 K) and low
v sin i ((cid:46) 40 km s−1) region of the parameter space (see
penultimate panel in the left column in Figure 6). This
result can be explained by larger number of (narrow)
metal lines available in those spectra for the inference of
stellar metallicity, while the lines either disappear or get
signiﬁcantly broadened at higher eﬀective temperatures
and projected rotational velocities, respectively.

Table 3 (left column, designated as “APOGEE”) lists
the internal uncertainties for all ﬁve stellar parameters
(Teﬀ , log g, v sin i, [M/H], and RV) as inferred from the
entire simulated APOGEE dataset, which makes them
representative of the parameter space in consideration.
We also note that a similar exercise was performed for
the simulated APOGEE datasets characterized by S/N
= 50 and 100 as an indication of the eﬀect of Poisson
noise on the resulting internal uncertainties. The re-
sults are summarized in the APOGEE instrument “S/N
= 50” and “S/N = 100” columns in Table 3. One can see
that overall uncertainty in Teﬀ and v sin i increases by
some 15% and 50%, respectively, between the noiseless
and S/N=50 spectra, while there is hardly any change

in the uncertainty for log g of the star. The largest in-
crease by a factor of ∼5 is recorded for the uncertainty
in the RV of the star (1.25 km s−1 in the noiseless case
as compared to 6.27 km s−1 for S/N=50), while the in-
crease of some 0.1 dex is observed for the uncertainty in
stellar metallicity.

The above-described approach is also applied to the
BOSS simulated spectra; the results obtained for the
noiseless dataset are presented in Figure 8 and in Ta-
bles 2 and 3. In addition to the expected increase in the
internal uncertainty for Teﬀ of the star towards higher
eﬀective temperatures (top panel in the left column in
Figure 8), a larger scatter is also recorded for log g of
the star at Teﬀ values below some 10 000 K (second top
panel in the left column in Figure 8). This eﬀect is ex-
plained by low sensitivity of the merit function employed
in the optimization algorithm to log g variations in the
Indeed, as dis-
Teﬀ range of late A- to F-type stars.
cussed in detail, e.g., in Gebruers et al. (2021, see their
Section 4.1), metal lines along with the central cores of
the Balmer lines represent the main diagnostic for the
inference of the surface gravity of these stars at optical
wavelengths. Owing to the low spectral resolution of the
BOSS instrument, the number of spectral bins that ap-
pear to be sensitive to log g variations is small relative
to the total number of bins that contribute to the merit
function. Coupled with partial degeneracy between the
log g and Teﬀ parameters in the spectroscopic analysis
of intermediate spectral type stars, this results in larger
internal uncertainty for log g in the Teﬀ regime of late
A- to F-type stars. Finally, we observe an increase of
the uncertainty for Teﬀ and v sin i of the star by some
25% and 15%, respectively, when degrading the quality
of input data from the noiseless case to S/N of 50. An
increase by a factor of ∼2 is also observed for the RV
uncertainty, while the uncertainties for log g and [M/H]
remain largely unchanged (see Table 3).

5. APPLICATION OF ZETA-PAYNE TO

CONTROL STELLAR SAMPLES

Aside from the successful performance test on simu-
lated spectra discussed in the previous Section, we apply
the ZETA-PAYNE algorithm to spectra of two con-
trol samples of real stars. First, we employ the sam-
ple of Slowly Pulsating B-type (SPB) stars analyzed
in Gebruers et al. (2021) to test if we can reproduce
their results with respect to the atmospheric param-
eters of the stars inferred from both high-resolution
(R≈85 000) HERMES (Raskin et al. 2011) and low-
resolution (R≈1 800) LAMOST optical spectra. At the
time of writing, we do not have any OBAF-type stars ob-
served with the BOSS instrument in SDSS-V that would

16

Straumit et al.

Figure 8. Same as Figure 6 but for the simulated noiseless BOSS data.

100001500020000250005000500T_eff [K]01002003004005000500100001500020000250000.20.00.2log(g) [cm/s^2]01002003004000.20.00.2100001500020000250001000v*sin(i) [km/s]0100200300400100010000150002000025000100v_micro [km/s]0100200300400100100001500020000250000.50.00.5[M/H] [dex]01002003004000.50.00.510000150002000025000True T_eff [K]50RV [km/s]0100200300400True v*sin(i) [km/s]50ZETA-PAYNE

17

Figure 9. Comparison between stellar parameters of 20 Kepler SPB-type stars as inferred from their high-resolution optical
spectra in Gebruers et al. (2021) and in this study. From left to right: Teﬀ , log g, v sin i, and [M/H]. The solid black line
indicates the one-to-one correspondence between the parameters and is shown to help guide the eye. The shown errors bars
reﬂect 1σ statistical uncertainties and do not include the internal uncertainty reported in Sect. 4.

Table 4. Stellar parameters of the 20 SPB stars from Gebruers et al. (2021) as inferred in this study from their HERMES high-
resolution and LAMOST low-resolution optical spectra (2 of these stars only have HERMES spectra). The quoted parameter
uncertainties reﬂect 1σ statistical uncertainties and do not account for the internal uncertainties reported in Sect. 4.

KIC number

10285114
10536147
11360704
12258330
3240411
3756031
3839930
3865742
5941844
6462033
6780397
7760680
8057661
8087269
8381949
8714886
8766405
9964614
11971405
8459899

Teﬀ (K)

log g (dex)

v sin i (km s−1)

[M/H] (dex)

LAMOST
16429 ± 649
21013 ± 1126
17608 ± 957
16432 ± 601
20708 ± 1014
16925 ± 659
17237 ± 660
19941 ± 1210
13806 ± 445
18645 ± 772
13068 ± 373
11858 ± 209
21693 ± 1219
13043 ± 421
22300 ± 1148
18430 ± 675
14427 ± 680
21049 ± 1033

HERMES
15994 ± 262
21225 ± 711
17856 ± 398
16320 ± 149
21985 ± 300
17302 ± 297
17436 ± 239
19776 ± 1242
14105 ± 141
18171 ± 537
13150 ± 141
11570 ± 97
23795 ± 661
13198 ± 471
21288 ± 517
19148 ± 623
14498 ± 156
21387 ± 532
15084 ± 136 —
16311 ± 135 —

LAMOST
4.09 ± 0.13
3.71 ± 0.14
3.90 ± 0.13
4.12 ± 0.13
4.09 ± 0.14
3.90 ± 0.12
4.34 ± 0.13
3.82 ± 0.16
4.26 ± 0.13
4.17 ± 0.13
3.63 ± 0.10
4.22 ± 0.08
4.52 ± 0.17
3.59 ± 0.10
4.23 ± 0.13
4.44 ± 0.13
3.22 ± 0.14
4.22 ± 0.14

HERMES
4.04 ± 0.05
3.81 ± 0.09
3.91 ± 0.06
4.27 ± 0.04
4.22 ± 0.05
3.95 ± 0.06
4.32 ± 0.05
3.89 ± 0.16
4.33 ± 0.04
4.22 ± 0.11
3.77 ± 0.04
3.91 ± 0.03
4.40 ± 0.12
3.73 ± 0.12
3.93 ± 0.07
4.24 ± 0.07
3.49 ± 0.03
4.00 ± 0.08
3.89 ± 0.03 —
3.89 ± 0.03 —

HERMES LAMOST HERMES
236 ± 72
247 ± 24
139 ± 47
174 ± 17
301 ± 64
307 ± 26
78 ± 66
118 ± 7
31 ± 65
36 ± 4
21 ± 39
14 ± 6
30 ± 61
28 ± 6
110 ± 65
132 ± 40
24 ± 98
28 ± 3
28 ± 103
73 ± 18
61 ± 53
57 ± 6
0 ± 30
72 ± 6
33 ± 77
33 ± 9
257 ± 78
287 ± 83
206 ± 60
220 ± 19
35 ± 38
19 ± 7
227 ± 70
209 ± 14
46 ± 10
1 ± 57
223 ± 13 —
—
47 ± 4

-0.04 ± 0.11
-0.20 ± 0.13
-0.12 ± 0.13
-0.10 ± 0.06
-0.12 ± 0.04
-0.35 ± 0.12
0.02 ± 0.07
0.27 ± 0.19
0.05 ± 0.06
-0.08 ± 0.18
-0.07 ± 0.06
0.18 ± 0.08
-0.22 ± 0.09
0.11 ± 0.23
-0.10 ± 0.10
-0.05 ± 0.09
-0.27 ± 0.08
-0.20 ± 0.10
-0.10 ± 0.06 —
0.00 ± 0.05 —

LAMOST
-0.21 ± 0.34
-0.08 ± 0.20
-0.16 ± 0.35
-0.37 ± 0.29
0.01 ± 0.17
-0.33 ± 0.43
-0.27 ± 0.35
0.03 ± 0.22
0.10 ± 0.32
-0.60 ± 0.45
-0.19 ± 0.26
-0.02 ± 0.27
-0.14 ± 0.24
-0.21 ± 0.41
-0.34 ± 0.42
-0.17 ± 0.30
-0.63 ± 0.44
-0.34 ± 0.27

18

Straumit et al.

Table 5. Parameters inferred with the ZETA-PAYNE algorithm from the input artiﬁcial spectra that assume Teﬀ , log g, v sin i,
and [M/H] ﬁxed to 13 000 K, 4.0 dex, 100 km s−1, and 0.0 dex, respectively, and variable microturbulent velocity ξ parameter
as indicated in the ﬁrst column. The quoted parameter errors are 1σ statistical uncertainties.

Input spectrum
ξ (km s−1)
2
4
6
8
10

Inferred parameters

Teﬀ (K)
13 110 ± 22
13 109 ± 31
13 057 ± 45
13 039 ± 52
13 014 ± 62

log g (dex)
4.01 ± 0.01
4.02 ± 0.01
4.03 ± 0.02
4.05 ± 0.03
4.04 ± 0.03

v sin i (km s−1)
94 ± 3
95 ± 4
99 ± 8
95 ± 4
95 ± 5

[M/H] (dex)
+0.02 ± 0.02
+0.15 ± 0.03
+0.29 ± 0.03
+0.42 ± 0.03
+0.49 ± 0.04

Gebruers et al. (2021) used an earlier version of the
ZETA-PAYNE algorithm to analyze a sample of 111 pul-
sating B- and F-type stars in the Kepler ﬁeld based on
high-resolution (R=85 000) optical HERMES spectra.
Two important diﬀerences between the version of the
ZETA-PAYNE algorithm presented in this study and
the version used in Gebruers et al. (2021) are that the
latter study: 1) used a training scheme only based on
a quasi-random sampling of the training examples after
Sobol (1967), and 2) included the microturbulent veloc-
ity as a free parameter in view of the high resolution
of the spectra used in their analysis. Diﬀerence 1) has
important consequences for slowly rotating stars where
extra care has to be taken during the training process to
fully capture the rapidly increasing morphological com-
plexity of stellar spectra compared to the cases of moder-
ate to high projected rotational velocities (Section 3.2).
The inclusion of the microturbulent velocity as a free pa-
rameter is expected to result in a notable diﬀerence in
the inferred stellar metallicity because of non-negligible
correlations between those two parameters.

Figure 9 shows a comparison between the Teﬀ , log g,
v sin i, and [M/H] parameters as inferred from the HER-
MES high-resolution spectra in Gebruers et al. (2021)
and in this study (see also Table 4 for numerical values;
columns designated as “HERMES”). We observe a good
agreement within the quoted 1σ statistical uncertainties
(i.e. not taking the internal uncertainty into account)
for Teﬀ of the star, for log g and v sin i for most part of
the sample. However [M/H] derived here is systemati-
cally higher than the corresponding values obtained in
Gebruers et al. (2021). The small but statistically sig-
niﬁcant discrepancy observed for v sin i for the slowest
rotators in the sample is explained by a more sophis-
ticated and precise training of the neural network per-
formed in this study in the corresponding region of the
parameters space, as discussed in detail in Section 3.2.
There are also ﬁve objects for which we ﬁnd system-
atically larger log g values than reported in Gebruers
et al. (2021) (see second panel in Figure 9). Those are
the ﬁve slowest rotators in the sample for which we also

Figure 10. Synthetic spectra computed for Teﬀ = 13 000 K,
log g = 4.0 dex, v sin i = 100 km s−1, [M/H] = 0.0 dex and
varying microturbulent velocity ξ from 2 to 10 km s−1.

be bright enough for observations with the HERMES in-
strument at the 1.2-m Mercator telescope and with the
APOGEE instrument (see below). Therefore, we de-
cide to use LAMOST spectra instead, given a number
of similarities with the BOSS instrument, among which
are the wavelength coverage, resolving power, spectrum
reduction pipelines, etc. This exercise allows us to quan-
tify potential diﬀerences in the inferred stellar param-
eters with respect to those derived in Gebruers et al.
(2021), as well as to unravel potential systematic ef-
fects in the inferred atmospheric parameters associated
with a factor of ∼40 reduction in the spectral resolution
(HERMES vs. LAMOST). Secondly, we cross-match a
sample of OBAF-type star candidates observed with the
APOGEE instrument as part of the SDSS-V Pathﬁnder
program (Kollmeier et al. 2017, their Section 5) with
archival HERMES high-resolution optical observations,
and analyze both datasets with the ZETA-PAYNE al-
gorithm. These tests oﬀer a cross-validation between
the parameter inference from medium-resolution near-
IR and high-resolution optical spectra. When combined
with the results of the previous exercise based on the
sample of Gebruers et al. (2021), this also allows us to
close the loop of cross-validation between the SDSS-V
APOGEE and BOSS instruments and high-resolution
optical spectroscopy of OBAF-type stars that cannot
be assembled for the large SDSS-V sample.

ZETA-PAYNE

19

Figure 11. Comparison between stellar parameters inferred with the ZETA-PAYNE algorithm from the HERMES high-
resolution and LAMOST low-resolution optical spectra of a sample of 18 SPB stars from Gebruers et al. (2021). The dashed
black line indicates the one-to-one correspondence between the parameters and is shown to help guide the eye. The error bars
reﬂect 1σ statistical uncertainties of the ﬁt and do not account for the internal parameter uncertainties.

ﬁnd discrepant values of the projected rotational veloc-
ity compared with Gebruers et al. (2021) due to their
sub-optimal training of the neural network. The sys-
tematic oﬀset in the derived metallicity of the stars is
associated with our exclusion of the microturbulent ve-
locity ξ from the free parameter vector as we kept it ﬁxed
to 2.0 km s−1. Indeed, as demonstrated in Figure 10, the
depths of most of the spectral lines of metals (and to a
lesser extent of helium) steadily increase with increas-
ing microturbulent velocity. This way, when synthetic
spectra are computed for 2.0 km s−1 ﬁxed value of the
microturbulent velocity while the star in reality shows a

larger value of microturbulence, the spectrum analysis
algorithm tends to compensate for the observed diﬀer-
ence in the line depths of metals, which is most easily
achieved by increasing the [M/H] parameter in the mod-
els. The eﬀect is quantitatively demonstrated in Table 5,
where we summarize the results of the ZETA-PAYNE
analysis of ﬁve artiﬁcial spectra, each one computed with
a diﬀerent value of the microturbulent velocity param-
eter (from 2 km s−1 to 10 km s−1 in steps of 2 km s−1)
but with ﬁxed values of Teﬀ = 13 000 K, log g= 4.0 dex,
v sin i= 100 km s−1, and [M/H] = 0.0 dex. One can see
that while we successfully recover Teﬀ , log g, and v sin i

125001500017500200002250025000T_eff [K], HERMES12000140001600018000200002200024000T_eff [K], LAMOST3.63.84.04.24.4log(g) [cm/s^2], HERMES3.23.43.63.84.04.24.44.6log(g) [cm/s^2], LAMOST0100200300v*sin(i) [km/s], HERMES0100200300v*sin(i) [km/s], LAMOST0.40.20.00.20.4[M/H] [dex], HERMES1.00.80.60.40.20.00.20.4[M/H] [dex], LAMOST20

Straumit et al.

from the input spectrum within the quoted 1σ statisti-
cal uncertainties in all ﬁve test cases, the discrepancy
between the inferred and assumed metallicity steadily
increases with the microturbulent velocity and reaches
some 0.5 dex for the most extreme considered case of
ξ = 10.0 km s−1.

We further proceed with the analysis of the LAMOST
spectra of exactly the same sample of Kepler SPB-type
stars. We note that two out of twenty stars do not
have LAMOST spectra, hence this particular analysis
is restricted to 18 stars for which low-resolution spectra
could be found in the LAMOST data archive. Our goal
here is to quantify the eﬀects of a factor ∼40 reduction
in the resolving power of the instrument and substan-
tially diﬀerent properties of its response function on the
inferred atmospheric parameters of the star. The re-
sults of our analysis are summarized in Figure 11 and
Table 4 (columns designated as “LAMOST”). We ﬁnd
an overall good agreement within the quoted 1σ statis-
tical uncertainties between the Teﬀ , v sin i, and [M/H]
parameters derived from the HERMES high-resolution
and LAMOST low-resolution optical spectra. There is
a small population of stars whose log g values as in-
ferred from the LAMOST spectra exceed those derived
from the HERMES high-resolution spectra, where the
agreement occurs only at 2σ instead of 1σ statistical un-
certainty level (see top right panel in Figure 11). These
discrepant cases are located in the region of high surface
gravity, i.e. log g (cid:38) 3.9 dex, and are in agreement with
each other when internal uncertainties are also taken
into account.

Finally, the ZETA-PAYNE algorithm is applied to a
sample of B- to F-type stars that were observed with the
APOGEE instrument as part of the SDSS-V Pathﬁnder
program in the northern hemisphere and for which high-
resolution optical spectra exist in the HERMES data
archive. The results of our analysis are illustrated in
Figure 12 and summarized in Table 6. As expected, the
v sin i parameter can realistically be inferred from the
APOGEE spectra for the coolest and slowly rotating F-
type stars only, owing to a large number of strong metal
lines found in the spectra of these objects. For the rest
of the sample, the APOGEE spectra are dominated by
the broad hydrogen lines of the Brackett series, which
results in signiﬁcant and systematic overestimation of
the projected rotational velocity of the star compared
to the case of high-resolution optical spectra. Similarly,
we observe a signiﬁcant discrepancy between the sur-
face gravity log g values inferred from the APOGEE and
from the high-resolution optical spectra, with no clear
dependency on Teﬀ or v sin i of the star. The observed
discrepancy is the result of a degeneracy between the

surface gravity of the star and parameters of the resid-
ual response function model in the analysis of the near-
IR APOGEE spectra. Indeed, as illustrated in Figure 7
(right column), the wavelength region in the APOGEE
spectra between some 1.5 µm and 1.6 µm (where the
density of hydrogen lines steadily increases and they
ultimately merge) is the most informative one for the
inference of the surface gravity of B- to F-type stars.
However, that particular part of the spectrum is also
the most uncertain one in ﬁtting the residual response
function,
leading to the above-mentioned degeneracy.
Finally, we ﬁnd a reasonably good agreement between
the Teﬀ values inferred from the near-IR APOGEE and
high-resolution optical spectra, with a small but statisti-
cally signiﬁcant underestimation of the eﬀective temper-
ature of the star from the near-IR spectra. The linear
regression analysis gives an intercept and slope of 104 K
and 0.9, respectively, with the null hypothesis of equal
values being rejected at the level of a p-value of 2.3×10−6
(see also left panel in Figure 12). We interpret the ob-
served diﬀerence in the inferred Teﬀ parameter as being
due to the cumulative eﬀect of (i) much more limited
amount of information in the near-IR spectra of B- to
F-type stars as compared to the optical wavelengths, (ii)
partial methodological degeneracy between Teﬀ , log g,
and parameters of the residual response function model,
and (iii) physical eﬀects like diﬀerent sensitivity of spec-
tral lines of hydrogen and metals to non-LTE eﬀects at
the optical and near-IR wavelengths. We also note that
the above-described analysis was performed assuming a
ﬁxed value of the stellar metallicity [M/H] = 0.0 dex
because of lack of information for the inference of the
respective parameter from the near-IR spectra and the
associated large internal uncertainty (see Figure 6 and
Table 3).

6. CONCLUSIONS AND FUTURE PROSPECTS

In this study, we develop a fully automated, machine
learning-based spectrum analysis algorithm ZETA-
PAYNE, whose main purpose is to serve the Milky Way
Mapper program of the SDSS-V survey in its daily data
analysis routine. Though the algorithm is mainly po-
sitioned for the analysis of intermediate- to high-mass
stars of spectral types O, B, A, and F, it can easily
be extended towards lower stellar eﬀective temperatures
and masses, if necessary. This paper presents a detailed
description of the spectrum analysis algorithm and the
statistical framework it is embedded in. It details the
algorithm training, validation, and testing steps. The
algorithm tests are performed both on artiﬁcial medium-
resolution near-IR and low-resolution optical spectra,
and on two control samples of real stars for which

ZETA-PAYNE

21

Figure 12. Comparison between atmospheric parameters derived from the medium-resolution NIR APOGEE and high-
resolution optical HERMES spectra. From left to right: Teﬀ , log g, and [M/H] of the star. The dashed and solid lines
represent the one-to-one correspondence and the best ﬁt linear regression model, respectively. The error bars shown reﬂect 1σ
statistical uncertainties of the ﬁt.

See text for details.

Table 6. Stellar parameters of 19 B- to F-type stars as derived in this study from their APOGEE medium-resolution near-IR
and HERMES high-resolution optical spectra. The analysis assumes ﬁxed metallicity [M/H] = 0.0 dex. The quoted parameter
uncertainties reﬂect 1σ statistical uncertainties and do not account for the internal uncertainties reported in Sect. 4. See text
for details.

Star name

16371249+7609490
16462193+7701175
16472272+6905558
16524392+7651096
17033403+5729591
17122286+5713243
17264168+5944556
17503133+5726367
18132623+6445575
18440460+6046128
18520222+5940014
18534470+6001044
18585261+6931525
19094260+6451320
19162421+6708066
19181164+6057360
19224444+7438013
19373625+6401001
20000399+6826121

Teﬀ (K)

log g (dex)

HERMES
7493 ± 50
15611 ± 250
11085 ± 35
7152 ± 21
11449 ± 57
10358 ± 93
14724 ± 146
10590 ± 51
13569 ± 141
9095 ± 186
13110 ± 127
14680 ± 159
12736 ± 132
6518 ± 38
22956 ± 256
11633 ± 74
8760 ± 40
7994 ± 36
10127 ± 47

APOGEE
6413 ± 140
13274 ± 424
8008 ± 75
6506 ± 142
11836 ± 329
9625 ± 298
12722 ± 507
10372 ± 271
12864 ± 240
8578 ± 463
10713 ± 333
7124 ± 89
14837 ± 568
7747 ± 102
23502 ± 657
11563 ± 248
9442 ± 291
7232 ± 210
7490 ± 214

HERMES
3.79 ± 0.13
4.06 ± 0.05
4.34 ± 0.02
3.21 ± 0.05
4.58 ± 0.02
3.52 ± 0.05
4.28 ± 0.04
4.10 ± 0.02
3.94 ± 0.04
3.09 ± 0.14
3.91 ± 0.04
3.40 ± 0.04
3.86 ± 0.05
3.00 ± 0.23
3.71 ± 0.05
4.10 ± 0.04
3.92 ± 0.03
4.21 ± 0.10
4.03 ± 0.02

APOGEE
3.28 ± 0.15
3.84 ± 0.15
3.38 ± 0.04
3.32 ± 0.14
3.85 ± 0.08
3.67 ± 0.04
3.62 ± 0.17
3.73 ± 0.05
3.60 ± 0.10
3.00 ± 0.13
3.13 ± 0.11
3.00 ± 0.08
4.19 ± 0.13
3.00 ± 0.22
3.13 ± 0.17
3.78 ± 0.08
3.67 ± 0.05
3.00 ± 0.14
3.00 ± 0.11

v sin i (km s−1)
HERMES APOGEE
6 ± 1
123 ± 11
209 ± 7
53 ± 1
139 ± 13
11 ± 4
25 ± 4
232 ± 14
164 ± 15
13 ± 7
258 ± 15
133 ± 9
108 ± 11
14 ± 1
74 ± 5
0 ± 1
156 ± 8
60 ± 3
124 ± 8

12 ± 4
355 ± 68
324 ± 28
51 ± 14
358 ± 37
228 ± 41
299 ± 105
377 ± 18
301 ± 49
26 ± 30
384 ± 84
287 ± 18
235 ± 76
12 ± 5
122 ± 52
257 ± 49
273 ± 26
293 ± 71
370 ± 39

(HERMES) high- and (LAMOST) low-resolution opti-
cal and (APOGEE) medium-resolution near-IR spectra
have been acquired. The main results and conclusions
of the paper are as follows:

• The ZETA-PAYNE algorithm is purposely gener-
alized to cover data analysis needs of the MWM
program that builds on observations with two
multi-object instruments operating in diﬀerent
wavelength regimes and at diﬀerent resolving pow-

ers. To make the algorithm readily applicable to
both types of data, where APOGEE spectra of
OBAF-type stars in particular suﬀer from the lack
of a well-deﬁned pseudo-continuum, we integrate
the spectrum normalization step into the analy-
sis framework where the pseudo-continuum of the
star is represented by a series of Chebyshev poly-
nomials. Coeﬃcients of the polynomials are opti-
mized along with atmospheric parameters of the
star, thus presenting a valuable alternative to the

10000150002000025000HERMES T_eff [K]500010000150002000025000APOGEE T_eff [K]3.03.54.04.55.0HERMES log(g) [cm/s^2]3.03.54.04.55.0APOGEE log(g) [cm/s^2]800010000120001400016000180002000022000Teff [K]0100200300400HERMES v*sin(i) [km/s]0100200300400APOGEE v*sin(i) [km/s]800010000120001400016000180002000022000Teff [K]22

Straumit et al.

conventional approach where the input spectrum
is (pre)normalized to the local continuum prior to
its detailed analysis.

• For the algorithm training, we employ a mixture
of a quasi-random sampling (Sobol 1967) in the
entire parameter space and an additional random
grid sampled from a Gaussian distribution at low
eﬀective temperatures (Teﬀ (cid:46) 10 000 K) and pro-
jected rotational velocities (v sin i (cid:46) 30 km s−1).
This hybrid training approach allows us to maxi-
mally capture the large diversity in morphological
complexity of stellar spectra when transitioning
from hotter and more rapidly rotating B- and A-
type stars to cooler F-type objects whose spectra
are typically characterized by more narrow metal
lines that are also available in numbers.

• The ZETA-PAYNE algorithm testing on artiﬁcial
APOGEE medium-resolution near-IR and BOSS
low-resolution optical spectra reveals a similar per-
formance at some 96% level in terms of the relia-
bility metric (deﬁned as the probability that the
optimization algorithm converges to a correct set
of atmospheric parameters; see Section 4). How-
ever, signiﬁcantly diﬀerent internal uncertainties
occur for the two wavelength regimes. This overall
i
nternal uncertainty is lower in the low-resolution
¯
optical spectra than in the APOGEE spectra at
S/N values of 100 and 50 by a factor of ∼3-4
for Teﬀ and RV of the star, and some 0.05 dex
and 0.35 dex for its log g and [M/H], respectively.
Thus, we conclude that despite a factor ten lower
resolving power of the BOSS instrument compared
to the APOGEE spectrograph, optical spectra re-
main a preferred option for the extraction of at-
mospheric parameters of OBAF-type stars, unless
the latter suﬀer from high extinction so that their
ﬂux can only be observed at longer (e.g. near-IR)
wavelengths. We note, however, that this conclu-
sion does not concerns inferences of the surface
chemical composition of the stars, where resolving
individual spectral lines of metals becomes an im-
portant factor. The optimal SDSS-V scenario is to
observe a star with both the BOSS and APOGEE
instruments and rely on the optical and near-IR
spectrum for the determination of atmospheric pa-
rameters and surface chemical abundances, respec-
tively. An exception would be O- and early B-type
stars that do not display spectral lines of metals
in the APOGEE spectra (cf. Figure 1).

• Application of the ZETA-PAYNE algorithm to
the HERMES high-resolution and LAMOST low-

resolution optical spectra of 18 objects from the
sample of SPB-type stars analyzed spectroscopi-
cally in Gebruers et al. (2021) reveals a good agree-
ment between the two sets of atmospheric param-
eters, including Teﬀ , log g, v sin i, and [M/H] of
the star. The present version of the ZETA-PAYNE
algorithm brings an improved performance in the
regime of slowly rotating late A- to F-type stars
compared to an earlier version of the algorithm
employed in Gebruers et al. (2021). We conclude
that as long as the LSF of the instrument is prop-
erly accounted for in the analysis of stellar spec-
tra, atmospheric parameters of OBAF-type stars
can still be accurately inferred from low-resolution
optical spectra, albeit with typically lower preci-
sion than from their high-resolution optical spec-
tra. Xiang et al. (2021) come to similar conclu-
sions from the analysis of LAMOST spectra of
some 330 000 OBA-type stars and validation of
their HotPayne algorithm based on medium- to
high-resolution spectra in the literature.

• Application of the ZETA-PAYNE algorithm to the
HERMES high-resolution optical and APOGEE
medium-resolution near-IR spectra of a sample
of 19 BAF-type stars reinforces our conclusions
drawn from the tests with simulated data that the
APOGEE near-IR spectra are less suitable for the
extraction of accurate atmospheric parameters of
OBAF-type stars than optical spectra. Owing to
the large dominance of the hydrogen lines of the
Brackett series in the APOGEE instrument wave-
length range, v sin i can only be reliably inferred
for the coolest F-type stars with slow to moder-
ate rotation. Inference of the stellar surface grav-
ity suﬀers from strong degeneracy with parameters
of the instrument response function model, while
the lack of prominent metal lines in the APOGEE
spectra of OB(early A)-type stars prevents deter-
mination of their atmospheric chemical composi-
tion. Finally, the eﬀective temperature of the star
is derived with higher accuracy and precision than
v sin i and log g. The intercept and slope of the
linear regression model ﬁtted to the diﬀerence be-
tween Teﬀ inferred from HERMES and APOGEE
spectra are 104 K and 0.9, respectively. From the
above results, it may appear that there is limited
advantage in using the APOGEE spectra for the
analysis OBAF-type stars. However, we empha-
size that the results based on the APOGEE spec-
tra obtained with the current version of the ZETA-
PAYNE algorithm are still up for improvement ow-
ing to the following two assumptions made: (i) the

ZETA-PAYNE

23

LSF of the instrument is well known and can be
described with a wavelength-independent Gaus-
sian kernel corresponding to R∼22 500, and (ii)
the residual response function is smooth and suf-
ﬁciently well-behaved such that it can be approx-
imated with a series of Chebyshev polynomials.
None of these assumptions holds in reality and we
need to gain a better understanding of both the
APOGEE LSF and residual response function be-
fore any ﬁrm conclusions can be drawn about the
gain of using the near-IR spectra for the analysis
of OBAF-type stars.

Although the ZETA-PAYNE pipeline requires little to
no human intervention and serves the basic needs of the
Milky Way Mapper spectroscopic survey, there is room
for improvement. This concerns the input physics cur-
rently used in atmosphere models and generalization of
the algorithm beyond the analysis of exclusively stellar
spectra of single stars. In particular, the (near-)future
prospects that we plan for implementation in the forth-
coming second release of the ZETA-PAYNE pipeline are:

• A better understanding and model descriptions of
the APOGEE LSF and residual response function.

• Generalization of the algorithm towards fully auto-
mated detection and subsequent analysis of (com-
posite) spectra of spectroscopic double-lined bi-
nary stars.

• Algorithm extension to allow for the determina-
tion of surfaces abundances of individual chemical
elements such as He, C, N, O, Si, Mg, and Fe.

• Extension of the currently employed input physics
to non-LTE atmosphere models and/or spectral
line formation. As discussed in detail in Nieva &
Przybilla (2007), the use of the hybrid approach
that employs LTE-based atmosphere models and
non-LTE spectral line formation is justiﬁed for
the spectrum analysis of OB-type dwarf and gi-
ant stars. Both, the hybrid and full non-LTE
approaches will be implemented by coupling the
tlusty (Hubeny & Lanz 1995) non-LTE model
atmosphere code to the line formation code cur-
rently employed in the ZETA-PAYNE pipeline.
For modelling spectra of the hottest and most mas-
sive O- and early B-type stars that often have ex-
tended atmospheres and winds, we will employ the
most recent version of the fastwind code (Puls
et al. 2005; Sundqvist et al. 2019) to (re-)train the
ZETA-PAYNE algorithm in the relevant part of
the parameter space.

• Overall, and for the analysis of APOGEE spec-
tra of OBAF-type stars in particular, it is highly
beneﬁcial to include more input options for stellar
observables, such as spectral energy distributions
(SEDs) and/or photometric colors, Gaia informa-
tion, etc. The main purpose of this addition is
to provide extra observational constraints, in par-
ticular for the eﬀective temperature and surface
gravity of the star, to break degeneracies between
various parameters in the spectroscopic analysis of
OBAF-type stars.

ACKNOWLEDGMENTS

Funding for the Sloan Digital Sky Survey V has been
provided by the Alfred P. Sloan Foundation, the Heising-
Simons Foundation, and the Participating Institutions.
SDSS acknowledges support and resources from the Cen-
ter for High-Performance Computing at the University
of Utah. The SDSS web site is www.sdss5.org.

SDSS is managed by the Astrophysical Research Con-
sortium for the Participating Institutions of the SDSS
Collaboration,
including the Carnegie Institution for
Science, Chilean National Time Allocation Committee
(CNTAC) ratiﬁed researchers, the Gotham Participa-
tion Group, Harvard University, Heidelberg University,
The Johns Hopkins University, L’Ecole polytechnique
f´ed´erale de Lausanne (EPFL), Leibniz-Institut f¨ur As-
trophysik Potsdam (AIP), Max-Planck-Institut f¨ur As-
tronomie (MPIA Heidelberg), Max-Planck-Institut f¨ur
Extraterrestrische Physik (MPE), Nanjing University,
National Astronomical Observatories of China (NAOC),
New Mexico State University, The Ohio State Univer-
sity, Pennsylvania State University, Smithsonian Astro-
physical Observatory, Space Telescope Science Institute
(STScI), the Stellar Astrophysics Participation Group,
Universidad Nacional Aut´onoma de M´exico, University
of Arizona, University of Colorado Boulder, University
of Illinois at Urbana-Champaign, University of Toronto,
University of Utah, University of Virginia, Yale Univer-
sity, and Yunnan University.

The research leading to these results has received
funding from the European Research Council (ERC)
under the European Union’s Horizon 2020 research
and innovation programme (grant agreement N◦670519:
from the KU Leuven Research Council
MAMSIE),
(grant C16/18/005: PARADISE), from the Research
Foundation Flanders (FWO) under grant agreement
G0H5416N (ERC Runner Up Project), as well as from
the BELgian federal Science Policy Oﬃce (BELSPO)
through PRODEX grant PLATO. SG gratefully ac-
knowledges support from the Research Foundation Flan-
ders (FWO) by means of a PhD Aspirant mandate un-

24

Straumit et al.

der contract No. 11E5620N. This work is based on ob-
servations obtained with the HERMES spectrograph,
which is supported by the Research Foundation - Flan-
ders (FWO), Belgium, the Research Council of KU Leu-
ven, Belgium, the Fonds National de la Recherche Sci-
entiﬁque (F.R.S.-FNRS), Belgium, the Royal Observa-
tory of Belgium, the Observatoire de Gen`eve, Switzer-
land and the Th¨uringer Landessternwarte Tautenburg,
Germany. The computational resources and services
used in this work were provided by the VSC (Flem-
funded by the Research
ish Supercomputer Centre),

Foundation - Flanders (FWO) and the Flemish Gov-
ernment. YST acknowledges ﬁnancial support from the
Australian Research Council through DECRA Fellow-
ship DE220101520. The authors are grateful to Cole
Johnston (KU Leuven, Radboud University Nijmegen),
Dominic M. Bowman (KU Leuven) and Siemen Burssens
(KU Leuven) for performing HERMES observations,
some of which were used in this study; to Joel Brown-
stein (Utah State University) and Maarten Dirickx (KU
Leuven) for their help with IT aspects of this work.

Aerts, C. 2021, Reviews of Modern Physics, 93, 015001,

Claret, A., & Torres, G. 2019, ApJ, 876, 134,

doi: 10.1103/RevModPhys.93.015001

doi: 10.3847/1538-4357/ab1589

Aerts, C., Christensen-Dalsgaard, J., & Kurtz, D. W. 2010,

Danielski, C., Brucalassi, A., Benatti, S., et al. 2021,

REFERENCES

Asteroseismology (Springer)

Aerts, C., Mathis, S., & Rogers, T. M. 2019, ARA&A, 57,

35, doi: 10.1146/annurev-astro-091918-104359

Aerts, C., Molenberghs, G., Michielsen, M., et al. 2018,

ApJS, 237, 15, doi: 10.3847/1538-4365/aaccfb

Almeida, L. A., Sana, H., Taylor, W., et al. 2017, A&A,

598, A84, doi: 10.1051/0004-6361/201629844

Auvergne, M., Bodin, P., Boisnard, L., et al. 2009, A&A,

506, 411, doi: 10.1051/0004-6361/200810860

Banyard, G., Sana, H., Mahy, L., et al. 2021, arXiv e-prints,

arXiv:2108.07814. https://arxiv.org/abs/2108.07814

Bodensteiner, J., Sana, H., Wang, C., et al. 2021, A&A,

652, A70, doi: 10.1051/0004-6361/202140507

Bonifacio, P., Dalton, G., Trager, S., et al. 2016, in

SF2A-2016: Proceedings of the Annual meeting of the
French Society of Astronomy and Astrophysics, ed.
C. Reyl´e, J. Richard, L. Cambr´esy, M. Deleuil,
E. P´econtal, L. Tresse, & I. Vauglin, 267–270

Borucki, W. J., Koch, D., Basri, G., et al. 2010, Science,

327, 977, doi: 10.1126/science.1185402

Bowen, I. S., & Vaughan, A. H. 1973, Appl. Opt., 12, 1430,

doi: 10.1364/AO.12.001430

Bowman, D. M., Burssens, S., Sim´on-D´ıaz, S., et al. 2020,
A&A, 640, A36, doi: 10.1051/0004-6361/202038224

Bowman, D. M., Burssens, S., Pedersen, M. G., et al. 2019,

Nature Astronomy, 3, 760,
doi: 10.1038/s41550-019-0768-1

Branch, M. A., Coleman, T. F., & Li, Y. 1999, SIAM J. Sci.

Comput., 21, 1

Butler, K. 1984, PhD thesis, University of London, UK

Casey, A. R., Hogg, D. W., Ness, M., et al. 2016, arXiv

e-prints, arXiv:1603.03040.
https://arxiv.org/abs/1603.03040

Experimental Astronomy,
doi: 10.1007/s10686-021-09765-1

de Jong, R. S., Agertz, O., Berbel, A. A., et al. 2019, The

Messenger, 175, 3, doi: 10.18727/0722-6691/5117

De Silva, G. M., Freeman, K. C., Bland-Hawthorn, J., et al.
2015, MNRAS, 449, 2604, doi: 10.1093/mnras/stv327
Deng, L.-C., Newberg, H. J., Liu, C., et al. 2012, Research

in Astronomy and Astrophysics, 12, 735,
doi: 10.1088/1674-4527/12/7/003

Edelmann, P. V. F., Ratnasingam, R. P., Pedersen, M. G.,
et al. 2019, ApJ, 876, 4, doi: 10.3847/1538-4357/ab12df
Gaia Collaboration, Prusti, T., de Bruijne, J. H. J., et al.
2016, A&A, 595, A1, doi: 10.1051/0004-6361/201629272

Gebruers, S., Straumit, I., Tkachenko, A., et al. 2021,
A&A, 650, A151, doi: 10.1051/0004-6361/202140466
Giddings, J. 1981, PhD thesis, University of London, UK
Gilmore, G., Randich, S., Asplund, M., et al. 2012, The

Messenger, 147, 25

Gunn, J. E., Siegmund, W. A., Mannery, E. J., et al. 2006,

AJ, 131, 2332, doi: 10.1086/500975

Horst, L., Edelmann, P. V. F., Andr´assy, R., et al. 2020,
A&A, 641, A18, doi: 10.1051/0004-6361/202037531

Howell, S. B., Sobeck, C., Haas, M., et al. 2014, PASP, 126,

398, doi: 10.1086/676406

Hubeny, I., & Lanz, T. 1995, ApJ, 439, 875,

doi: 10.1086/175226

Kollmeier, J. A., Zasowski, G., Rix, H.-W., et al. 2017,

arXiv e-prints, arXiv:1711.03234.
https://arxiv.org/abs/1711.03234

Kreidberg, L. 2017, Exoplanet Atmosphere Measurements
from Transmission Spectroscopy and Other Planet Star
Combined Light Observations (Cham: Springer
International Publishing), 1–23,
doi: 10.1007/978-3-319-30648-3 100-1

Lenorzer, A., Mokiem, M. R., de Koter, A., & Puls, J.

Sana, H., de Mink, S. E., de Koter, A., et al. 2012, Science,

ZETA-PAYNE

25

2004, A&A, 422, 275, doi: 10.1051/0004-6361:20047174
Limbach, M. A., Schmidt, L. M., DePoy, D. L., et al. 2020,

in Ground-based and Airborne Instrumentation for
Astronomy VIII, ed. C. J. Evans, J. J. Bryant, &
K. Motohara, Vol. 11447, International Society for Optics
and Photonics (SPIE), 1634 – 1647,
doi: 10.1117/12.2562371

Liu, L., Jiang, H., He, P., et al. 2019, arXiv e-prints,

arXiv:1908.03265. https://arxiv.org/abs/1908.03265
Luo, F., Zhao, Y.-H., Li, J., Guo, Y.-J., & Liu, C. 2021,

arXiv e-prints, arXiv:2108.11120.
https://arxiv.org/abs/2108.11120

Massey, P., Zangari, A. M., Morrell, N. I., et al. 2009, ApJ,

692, 618, doi: 10.1088/0004-637X/692/1/618

Ness, M., Hogg, D. W., Rix, H. W., Ho, A. Y. Q., &

Zasowski, G. 2015, ApJ, 808, 16,
doi: 10.1088/0004-637X/808/1/16

Nidever, D. L., Holtzman, J. A., Allende Prieto, C., et al.
2015, AJ, 150, 173, doi: 10.1088/0004-6256/150/6/173

Nieva, M. F., & Przybilla, N. 2007, A&A, 467, 295,

doi: 10.1051/0004-6361:20065757

O’Briain, T., Ting, Y.-S., Fabbro, S., et al. 2021, ApJ, 906,

130, doi: 10.3847/1538-4357/abca96

P´apics, P. I., Tkachenko, A., Van Reeth, T., et al. 2017,
A&A, 598, A74, doi: 10.1051/0004-6361/201629814
Pedersen, M. G., Aerts, C., P´apics, P. I., & Rogers, T. M.

2018, A&A, 614, A128,
doi: 10.1051/0004-6361/201732317

Pedersen, M. G., Aerts, C., P´apics, P. I., et al. 2021, Nature

Astronomy, 5, 715, doi: 10.1038/s41550-021-01351-x

Piskunov, N., & Valenti, J. A. 2017, A&A, 597, A16,

doi: 10.1051/0004-6361/201629124

Poggio, E., Drimmel, R., Cantat-Gaudin, T., et al. 2021,
A&A, 651, A104, doi: 10.1051/0004-6361/202140687
Puls, J., Urbaneja, M. A., Venero, R., et al. 2005, A&A,

435, 669, doi: 10.1051/0004-6361:20042365
Ram´ırez-Preciado, V. G., Roman-Lopes, A.,

Rom´an-Z´u˜niga, C. G., et al. 2020, ApJ, 894, 5,
doi: 10.3847/1538-4357/ab8127

Raskin, G., van Winckel, H., Hensberge, H., et al. 2011,
A&A, 526, A69, doi: 10.1051/0004-6361/201015435
Richards, G. T., Fan, X., Newberg, H. J., et al. 2002, AJ,

123, 2945, doi: 10.1086/340187

Roman-Lopes, A., Rom´an-Z´u˜niga, C., Tapia, M., et al.
2018, ApJ, 855, 68, doi: 10.3847/1538-4357/aaac27

337, 444, doi: 10.1126/science.1223344

Sana, H., de Koter, A., de Mink, S. E., et al. 2013, A&A,

550, A107, doi: 10.1051/0004-6361/201219621

Serenelli, A., Weiss, A., Aerts, C., et al. 2021, A&A Rv, 29,

4, doi: 10.1007/s00159-021-00132-9

Shulyak, D., Tsymbal, V., Ryabchikova, T., St¨utz, C., &

Weiss, W. W. 2004, A&A, 428, 993,
doi: 10.1051/0004-6361:20034169

Smee, S. A., Gunn, J. E., Uomoto, A., et al. 2013, AJ, 146,

32, doi: 10.1088/0004-6256/146/2/32

Sobol, I. M. 1967, USSR Comp. Math. and Math. Phys., 7,
86. http://dx.doi.org/10.1016/0041-5553(67)90144-9
Stoughton, C., Lupton, R. H., Bernardi, M., et al. 2002,

AJ, 123, 485, doi: 10.1086/324741

Strauss, M. A., Weinberg, D. H., Lupton, R. H., et al. 2002,

AJ, 124, 1810, doi: 10.1086/342343

Sundqvist, J. O., Bj¨orklund, R., Puls, J., & Najarro, F.

2019, A&A, 632, A126,
doi: 10.1051/0004-6361/201936580

Thomas, J. D., Richardson, N. D., Eldridge, J. J., et al.

2021, MNRAS, 504, 5221, doi: 10.1093/mnras/stab1181

Ting, Y.-S., Conroy, C., Rix, H.-W., & Cargile, P. 2019,

ApJ, 879, 69, doi: 10.3847/1538-4357/ab2331

Tkachenko, A. 2015, A&A, 581, A129,
doi: 10.1051/0004-6361/201526513

Tkachenko, A., Pavlovski, K., Johnston, C., et al. 2020,
A&A, 637, A60, doi: 10.1051/0004-6361/202037452
Torres, G., Andersen, J., & Gim´enez, A. 2010, A&A Rv,

18, 67, doi: 10.1007/s00159-009-0025-1

Tsymbal, V. 1996, in Astronomical Society of the Paciﬁc

Conference Series, Vol. 108, M.A.S.S., Model
Atmospheres and Spectrum Synthesis, ed. S. J. Adelman,
F. Kupka, & W. W. Weiss, 198

Valenti, J. A., & Piskunov, N. 1996, A&AS, 118, 595
Vanderspek, R. 2019, in AAS/Division for Extreme Solar
Systems Abstracts, Vol. 51, AAS/Division for Extreme
Solar Systems Abstracts, 333.12

Wilson, J. C., Hearty, F. R., Skrutskie, M. F., et al. 2019,
PASP, 131, 055001, doi: 10.1088/1538-3873/ab0075
Xiang, M., Rix, H.-W., Ting, Y.-S., et al. 2021, arXiv

e-prints, arXiv:2108.02878.
https://arxiv.org/abs/2108.02878

Zari, E., Rix, H. W., Frankel, N., et al. 2021, A&A, 650,

A112, doi: 10.1051/0004-6361/202039726

