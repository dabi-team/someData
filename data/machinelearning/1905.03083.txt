Submitted to
manuscript xxxx

Appointment scheduling model in healthcare using
clustering algorithms

∗ Nooshin Youseﬁa, ∗ Farhad Hasankhanib, Mahsa Kianib
aDepartment of Industrial and Systems Engineering, Rutgers University, USA
bDepartment of Industrial Engineering, Clemson University, USA
∗ These two authors contributed equally
no.youseﬁ@rutgers.edu, fhasank@g.clemson.edu, mkiani@g.clemson.edu

In this study we provided a scheduling procedure which is combination of machine learning and mathematical

programming that minimizes the waiting time of higher priority outpatients. Outpatients who request for

appointment in healthcare facilities have diﬀerent priorities. Determining the priority of outpatients and

allocating the capacity based on the priority classes are important concepts that have to be considered in

scheduling of outpatients. In this study, two stages are deﬁned for scheduling an incoming outpatient. In

the ﬁrst stage, we applied and compared two clustering methods; K-means clustering and agglomerative

hierarchical clustering, to classify outpatients into priority classes and suggested the best pattern to cluster

the outpatients. In the second stage, we modeled the scheduling problem as a Markov Decision Process

(MDP) problem since the arrivals are uncertain and the decisions are taken at the end of each day after

observing total requests. Due to the curse of dimensionality, we used ﬂuid approximation method to estimate

the optimal solution of the MDP. We applied our methodology on a data set of Shaheed Rajaei Medical

and Research Center in Iran, and we represented that how our model works in prioritizing and scheduling

of outpatients.

Key words : Machine learning; K-means clustering; Agglomerative hierarchical clustering; Markov decision

process; Outpatient scheduling

0
2
0
2

l
u
J

1
3

]
P
S
.
s
s
e
e
[

2
v
3
8
0
3
0
.
5
0
9
1
:
v
i
X
r
a

1.

Introduction

Nowadays, patients in many healthcare facilities face with a problem of long waiting time. Waiting

times in healthcare clinics are categorized into “indirect waiting time” and “direct waiting time”.

Indirect waiting time is mostly expressed in days, and is deﬁned as the number of days between

appointment request day and appointment day. Direct waiting time is deﬁned as the time that a

1

 
 
 
 
 
 
2

Youseﬁ, Hasankhani, Kiani: Appointment scheduling model in healthcare using clustering algorithms
Article submitted to ; manuscript no. xxxx

patient spends in clinic to see a doctor. Oﬀering appointments with low indirect waiting time is one

of the healthcare managers’ issues. Long indirect waiting times may bring medical impacts specially

for multi-comorbidity and higher priority patients. Long indirect waiting times also increase the no-

show probability of patients that decreases the utilization of the healthcare facility. Prioritization

of patients based on their comorbidities and characteristics and deciding which one should get

sooner appointment is not a simple problem. There are many factors which play important roles

in determining the level of urgency of a patient. Machine learning methods provide a decision

making tool for grouping patients into diﬀerent priority classes which is more accurate than a

human diagnosis. Considering patients’ backgrounds and environments for clustering patients are

important issues which may be ignored by a human. Therefore, having a tool to ﬁnd a pattern

for patients priority, considering patients’ histories and environment factors helps the healthcare

facilities to come up with a more accurate priority diagnosis and following that the better scheduling

process.

Considering the priority of patients is an important issue which has to be considered in their

scheduling. There are several methods to set a priority rule to the patients before appointment

scheduling. However, most of these priority rules are deterministic and ﬁxed based on few param-

eters Cayirli and Veral (2003), Godin and Wang (2010), Patrick and Puterman (2007), Zhu et al.

(2012). There are diﬀerent parameters and patients characteristics which may aﬀect their priority

levels which are not considered in the previous studies. Family history, gender, age, etc., are some

features which are not considered in calculating the priority level of patients in the previous studies.

In the proposed study, a machine learning method is used to consider more factors to categorize

the outpatients into diﬀerent priority classes. The combination of some negligible features may

have a large impact on the health of the patients which is ignored in the previous researches, but

is considered in the machine learning methods to ﬁnd the priority class of each patient.

In this study, we propose a scheduling model in which we categorize outpatients to priority classes

based on their comorbidities. We compared two machine learning methods; K-means clustering

Youseﬁ, Hasankhani, Kiani: Appointment scheduling model in healthcare using clustering algorithms
Article submitted to ; manuscript no. xxxx

3

and agglomerative hierarchical clustering to prioritize outpatients. Then, we schedule outpatients

based on the determined priority classes within a planning horizon. We used a Markov Decision

Process (MDP) model to represent the scheduling process. The reason that we use a MDP model

is that the arrivals are not certain and follow Poisson processes, and the decisions are made at the

end of each day after observing the number of requests on that day and the number of available

appointments in future days. It means that the scheduler observes all the arrivals on each day and

decides about them at the end of that day. Since our MDP problem is a large scale model, we

applied ﬂuid approximation method to approximate the MDP solution. Since it my be diﬃcult

for the healthcare facility to solve the MDP model every day to decide regarding scheduling of

outpatients, we propose a benchmark policy that is easy to implement. This benchmark policy

is obtained based on the optimal policy that is the result of solving the MDP model. Therefore,

at the end of each day, the scheduler just needs to classify outpatients, and then schedule them

based on the benchmark policy. Figure 1 represents a summary of our procedure in this paper for

obtaining a benchmark policy for scheduling of multiple classes of outpatients. Our study is the

ﬁrst study in literature which combines both machine learning methods and MDP modeling to

optimize the scheduling process to decrease indirect waiting time of higher priority outpatients in

receiving appointments.

Figure 1: Summary of the proposed method

4

Youseﬁ, Hasankhani, Kiani: Appointment scheduling model in healthcare using clustering algorithms
Article submitted to ; manuscript no. xxxx

In Section 2, we discuss the uniqueness of our study with respect to prior literature. Section 3.1

explains how we applied K-means clustering and agglomerative hierarchical clustering to prioritize

outpatients. The MDP model and our solution approach to solve it is fully explained in Section

3.2. We tested our model in a data set of Shaheed Rajaei Medical and Research Center in Iran and

the results are presented in Section 4. Finally, Section 5 concludes this study.

2. Related Works

There has been signiﬁcant research in advantage of machine learning development in healthcare sys-

tems. Reducing medical costs, improving disease diagnostics, hospital appointment scheduling, and

medical research initiatives are the possible impacts of machine learning techniques on improving

the healthcare systems.

2.1. Machine learning literature review

Machine learning is collection of data analytical techniques programmed to learn patterns from

data sets. Using mathematical rules and statistical assumptions, machine learning methods develop

a pattern/model among the features of the data sets Sadrfaridpour et al. (2016, 2019). The input of

the machine learning methods consist of diﬀerent measured features in the data set. There are two

main learning techniques: supervised learning and unsupervised learning. In supervised learning,

the model is conducted based on a set of training labeled data, while in unsupervised learning,

a hidden structure should be found in unlabeled data. Clustering methods are the most common

unsupervised learning methods while classiﬁcation and regression are classiﬁed as supervised learn-

ing methods. Though the training steps of the machine learning methods, the optimal model’s

parameters are found by calculating the errors and evaluating the model’s performance through

some back and forth steps. Then, using the optimal parameters, the model can be used for any

new data set.

Recently, there has been signiﬁcant developments and attentions on machine learning methods

in diﬀerent industries. Healthcare is one of the areas that signiﬁcantly beneﬁt from developments of

machine learning techniques. Machine learning has the potential to help both patients and providers

Youseﬁ, Hasankhani, Kiani: Appointment scheduling model in healthcare using clustering algorithms
Article submitted to ; manuscript no. xxxx

5

in terms of better care and lower costs. Huang et al. (2014) developed a machine learning model

for predicting diagnosis of depression up to one year in advance. Pendharkar and Khurana (2014)

compared three diﬀerent machine learning prediction methods for predicting patient’s length of

stay in Pennsylvania Federal and Specialty hospital. Samorani and LaGanga (2015) used machine

learning methods to obtain a show up probability for individual appointments and proposed a

hospital scheduling appointment model using the show up probability of each appointment. Pod-

gorelec and Kokol (1997) developed a model for patient scheduling using genetic algorithm and

machine learning.

There have been several studies on classiﬁcation and clustering of patients based on speciﬁc

diseases. Nieuwenhuis et al. (2012) proposed a model for classifying of schizophrenia patients

based on their brain Magnetic Resonance Imaging (MRI) scans using Support Vector Machine

(SVM) method. Jena and Kamila (2015) compared diﬀerent classiﬁcation algorithms to predict

chronic-kidney-disease. Bhakta and Sau (2016) proposed a prediction method for depression using

a machine learning classiﬁer to expedite the treatment procedure. Manimekalai (2016) compared

diﬀerent machine learning classiﬁers for predicting heart disease, and represented that SVM classi-

ﬁer with genetic algorithm has better prediction accuracy. Aneeshkumar and Venkateswaran (2015)

proposed a fuzzy based classiﬁcation for liver disorder diagnosis. Chaurasia and Pal (2014) con-

centrated on detection of breast cancer using diﬀerent machine learning methods such as RepTree

and Radial Basis Function (RBF) Network.

Shouman et al. (2012) integrated decision tree and K-means clustering to predict the heart

disease on Cleveland Clinic Foundation Heart disease data set. Adegunsoye et al. (2018) used

clustering method to identify four patients’ groups with interstitial lung disease, and showed that

grouping patients could improve the eﬃcacy of therapeutic interventions in future clinical trials.

Clustering patients into diﬀerent priority classes immediately after their arrival could help the

healthcare facility to schedule patients in a better way. Reviewing and analyzing large amount of

data gathered from clinical trials could improve healthcare systems in terms of disease diagnostics,

6

Youseﬁ, Hasankhani, Kiani: Appointment scheduling model in healthcare using clustering algorithms
Article submitted to ; manuscript no. xxxx

patient’s appointment scheduling, etc. As an instance, if a patient comes in with a particular case

of the ﬂu, a physician in the past would rely on what he or she knew about the ﬂu in general or

what other doctors in the area knew; while using big data analytic and machine learning methods

provides a more accurate decision making tool for this diagnosis which depends on various factors

in patients background that a human could ignore in his/her discernment. This fact could also be

true for a hospital receptionist who schedules the patients’ appointments. The priority of a patient

to visit a doctor relies on diﬀerent factors that a human could not pay attention to. Machine

learning methods could be a signiﬁcant help to classify patients based on all their backgrounds

and environments into diﬀerent priority classes. Using machine learning and data analytic methods

brings a more accurate way to district patients to be scheduled to visit a doctor. In this study, we

used two methods to cluster the outpatients into priority classes to be scheduled upon their arrival.

2.2. Outpatient scheduling literature review

Scheduling is the process of controlling and allocating the resources to optimize the total workload

of a process. There has been a signiﬁcant number of scheduling problems in diﬀerent areas of

healthcare, manufacturing, transportation, energy systems, maintenance models, etc. Nazemi and

Jafari (2020), Mahani et al. (2020), Youseﬁ and Coit (2019), Hasankhani and Khademi (2019), Kiani

et al. (2020). Scheduling of outpatients is subject of many previous studies in healthcare systems

literature. Magerlein and Martin (1978) and Cayirli and Veral (2003) provided a comprehensive

review of the outpatients scheduling studies. Magerlein and Martin (1978) classiﬁed the studies

into two main groups: “ scheduling” in which patients are scheduled in advance, and “allocation

scheduling” in which available patients are scheduled on the service day. Our scheduling model

is an advance scheduling model. Patrick et al. (2008) introduced an advance dynamic scheduling

system. The decisions are made at the end of each day, and the outpatients who did not receive

appointment join the next day waiting queue. Chen and Robinson (2014) proposed an appointment

model of a combination of advance and allocation scheduling. The model determines when the same

day appointments should be scheduled throughout the day and how these same day appointments

Youseﬁ, Hasankhani, Kiani: Appointment scheduling model in healthcare using clustering algorithms
Article submitted to ; manuscript no. xxxx

7

aﬀect the routine appointments. Patrick (2012) introduced a MDP model and showed that a short

booking window works better than doing the same day appointments in minimizing the total cost

of the system due to unused capacity that allocation scheduling may cause.

Application of mathematical programming in outpatient scheduling has always been of interest

to healthcare system researchers. The mathematical models used in outpatient studies are deter-

ministic or stochastic. Deterministic models are mostly used in specialty clinics with deterministic

service times. Most of the deterministic outpatients scheduling systems are formulated as inte-

ger or mixed-integer models Ahmadi-Javid et al. (2017). Castro and Petrovic (2012), P´erez et al.

(2011), Turkcan et al. (2012), Wang and Fung (2014) used deterministic formulation to model the

scheduling system. Stochastic models allow schedulers to optimize the scheduling process in the

presence of randomness. For example, Denton and Gupta (2003) used a two stage stochastic model

that is capable of considering ﬂexibility in diﬀerent types of costs. MDP is also a helpful stochas-

tic dynamic programming approach to model online scheduling systems with decisions such as

appointment day and time, reservation of capacity and acceptance of patients Ahmadi-Javid et al.

(2017). Gocgun and Puterman (2014) used a MDP model to formulate chemotherapy appointment

system. In this study, we used a MDP model which decides regarding the acceptance of outpatients

while the appointment day is determined based on the priority class of the outpatient who requests

for appointment and the available capacity. The priority class of the outpatient is determined upon

the arrival based on his/her comorbidities. Prioritizing outpatients based on the patients charac-

teristics and comorbidities is considered in the scheduling models to minimize the waiting time

of higher priority patients in receiving appointment Geng and Xie (2016), Gocgun et al. (2011),

Patrick et al. (2008). However, in the above studies there is not an exact explanation and algorithm

for categorizing outpatients. To the best of our knowledge, our study is the ﬁrst that combines a

machine learning algorithm for prioritizing outpatients with a mathematical scheduling model.

8

Youseﬁ, Hasankhani, Kiani: Appointment scheduling model in healthcare using clustering algorithms
Article submitted to ; manuscript no. xxxx

3. Methodology
3.1. Clustering Algorithm

Clustering is a technique to group data into diﬀerent classes with the aim of high similarity of data

within the groups and low similarity between the groups. The most common types of clustering

approaches are Partitional clustering and Hierarchical clustering.

3.1.1. K-means clustering Partitioning clustering is the most fundamental method of cluster

analysis which arranges the objects of a dataset into diﬀerent exclusive clusters Huang et al. (2014).

K-means clustering is one of the most useful partitional clustering methods. In this method, K

points are randomly selected from data as the centroids of the clusters. All the other points should

be assigned to each cluster using minimum distance of each point to each centroid. The centroid of

each cluster is updated using the data point within it. All these iterations should be repeated until

convergence criteria is met. Euclidean distance is the most useful way to calculate the distance

between two points. Let ¯xi be the centroid of cluster ci and d(xj, ¯xi) be the dissimilarity between

centroid point of each cluster and any point that belongs to that cluster (for all xj ∈ ci). Thus, the

function to be minimized by K-means clustering can be written as follows:

Min E =

K
(cid:88)

(cid:88)

i=1

xj ∈ci

d(xj, ¯xi)

(1)

Figure 2 shows the procedure of clustering data to 3 groups starting with three random initial

points. Algorithm 1 formally describes K-means clustering approach.

Algorithm 1 K-means partitional clustering

Start with K random points as centroids of clusters

Assign each point to its closest centroid

Update the centroid of each cluster

Repeat steps 2 and 3 until the optimality criteria is met and centroids do not change

Youseﬁ, Hasankhani, Kiani: Appointment scheduling model in healthcare using clustering algorithms
Article submitted to ; manuscript no. xxxx

9

Figure 2: K-means clustering procedure

3.1.2. Agglomerative hierarchical clustering In this method, a tree of clusters is used

to separate the data, where each node represents child cluster were combining together based on

their common parents node. In hierarchical clustering we ﬁrst assign each item to a cluster such

that if we have N items then we would have N clusters. Then, we repeat the following steps: ﬁnd

closest pair of clusters and merge them into single cluster. Compute distance between new cluster

and each of the old clusters Pendharkar and Khurana (2014). Agglomerative clustering is one of

the widely used bottom-up hierarchical methods. Algorithm 2 shows the steps of agglomerative

clustering approach.

There are diﬀerent methods to combine the clusters in agglomerative clustering approaches such

Figure 3: Agglomerative clustering approach

as Single Linkage, Complete linkage, Average linkage, Centroid method and Ward’s method Defays

(1977), El-Hamdouchi and Willett (1986), Gower and Ross (1969), Seifoddini (1989).

In this paper, Ward’s method which is an analysis of variance (ANOVA) based approach is

applied. At each stage, one-way univariate ANOVAs are done for each variable with groups deﬁned

by the clusters, and two clusters which have the smallest increase in the combined error sum of

10

Youseﬁ, Hasankhani, Kiani: Appointment scheduling model in healthcare using clustering algorithms
Article submitted to ; manuscript no. xxxx

Algorithm 2 Agglomerative hierarchical clustering

Start with n clusters

Compute the proximity matrix

Merge the closest two clusters

Update the proximity matrix between the new cluster and the original clusters

Repeat until K clusters remains

squares should be merged together. In this paper, K-means clustering and agglomerative hierar-

chical clustering methods are used to group patients into two classes of high and low priority for

appointment scheduling. The Alizadehsani et al. (2013) data set is used for this study. This data set

contains information of 303 random patients visited Shaheed Rajaei Medical and Research Center.

In this paper, for each of the patients we used 29 features that are described in Table 1.

Table 1: Features of dataset

Feature name

Range

Feature name

Age

Weight

Length

Sex

30-86

BP (blood pressure: mmHg)

48-120

PR (pulse rate) (ppm)

140-188

Edema

Male, Female Weak peripheral pulse

DM (history of Diabetes Mellitus)

Yes, No

Lung rales

HTN (history of hypertension)

Yes, No

Systolic murmur

Current smoker

Ex-smoker

Yes, No

Diastolic murmur

Yes, No

Typical Chest Pain

FH (history of heart disease)

Yes, No

Dyspnea

CRF(chronic renal failure)

Yes, No

Function class

CVA (Cerebrovascular Accident)

Yes, No

Atypical

Range

90-190

50-110

Yes, No

Yes, No

Yes, No

Yes, No

Yes, No

Yes, No

Yes, No

1,2,3,4

Yes, No

Yes, No

Airway disease

Thyroid Disease

Yes, No

Nonanginal CP

Yes, No

Exertional CP (Exertional Chest Pain) Yes, No

CHF (congestive heart failure)

Yes, No

Low Th Ang (low Threshold angina)

Yes, No

DLP (Dyslipidemia)
To ﬁnd the most important subset of features, Wrapper method is used in this paper Karegowda

Yes, No

et al. (2010), Talavera (2005). In this method, features are ranked based on their importance, and

the best features subset that has the best cluster quality is selected. The importance of each feature

Youseﬁ, Hasankhani, Kiani: Appointment scheduling model in healthcare using clustering algorithms
Article submitted to ; manuscript no. xxxx

11

is calculated using Entropy. Dash and Liu (2000) proposed the entropy-based ranking for the ﬁrst

time. The entropy for each feature is calculated as follows:

E = −

N
(cid:88)

N
(cid:88)

(cid:16)

i=1

j=1

Sijlog(Sij) + (1 − Sij)log(1 − Sij)

(cid:17)

,

(2)

where Sij is the similarity between two points i and j, and it is calculated based on the distance

between these two points after feature t is removed (disti,j).

Sij = e−α×disti,j

(3)

Here based on Dash and Liu (2000), α is assumed to be α = ln(0.5)

¯dist where

¯dist is the average

distance of all points after feature t is removed. After calculation of all features’ entropy, the best

features subset should be determined by calculating the cluster quality. In this study, scattering

criteria is used to measure the cluster quality, considering the scatter matrix in multiple discrimi-

nant analysis. The within-cluster scatter PW and between-cluster scatter PB can be calculated in

the following way:

PW =

K
(cid:88)

(cid:88)

j=1

xi∈cj

(xi − mj)(xi − mj)T

PB =

K
(cid:88)

j=1

(mj − m)(mj − m)T

(4)

(5)

Here m is the total mean vector and mj is the mean vector for cluster j. Thus, m is obtained

by getting average over all clusters, and mj is obtained by getting the average over cluster j. To

evaluate the cluster quality using between-cluster scatter and within-cluster scatter the “Invariant

criterion” tr(P −1

W PB) is used, which measures the ration of between-cluster to within-cluster scatter.

If we add an important feature to subset, tr(P −1

W PB) increases, and if we add an unimportant

feature to the subset, tr(P −1

W PB) decreases or remains unchanged. Figure 4 shows the procedure

of selecting best feature subset.

12

Youseﬁ, Hasankhani, Kiani: Appointment scheduling model in healthcare using clustering algorithms
Article submitted to ; manuscript no. xxxx

Figure 4: Wrapper algorithm for ﬁnding the best features subset
Wrapper algorithm is one of the sequential forward feature selection algorithms to attempt the

optimal feature subset by iteratively selecting features and comparing the model’s performance.

After ranking the features, this algorithm starts with an empty subset. At each time, one feature is

added to the subset and the method performance measurement which is the “Invariant criterion”,

tr(P W

−1PB) is calculated. By comparing the performance of diﬀerent subsets the optimal subset can

be found at each step. The procedure of adding features to subsets will continue until the stopping

criteria is met. In the paper, we set the stopping criteria to be the point at which tr(P W

−1PB) remains

unchanged. Since the features are added to the subset based on their ranking, this algorithm

calculated at maximum Q subset. One of the reasons that we need feature selection is that it reduces

the complexity of the model, and enable the clustering method to train faster. It can also improve

the accuracy of the model if the subsets are chosen correctly. Thus, we may not face over-ﬁtting.

Therefore, by using the feature selection, without losing the important information, we would have

an accurate model. After ﬁnding the best features subset, two algorithms are applied on data set

to group the patients into multiple classes. K-means clustering and agglomerative algorithms are

applied on the data set with selected features, and their accuracy is compared. Section 4 shows the

result of applying these methods on the data set.

3.2. Markov decision process scheduling model

As a patient requests for appointment, the systems evaluates his/her health information and assigns

the patient to one of the priority classes. Higher priority patients have to receive sooner appoint-

ment. Thus, based on the probable future arrivals and the priority class of the patient, the scheduler

Youseﬁ, Hasankhani, Kiani: Appointment scheduling model in healthcare using clustering algorithms
Article submitted to ; manuscript no. xxxx

13

decides to give an appointment to him/her. To show how the scheduling model would work, we

formulate the problem as a MDP model.

3.3. Decision epochs

At a speciﬁc point of time, when a patient requests for appointment, the scheduler observes the

available capacity over an H-day booking horizon and based on the priority class of the patient,

schedules him/her. Outpatients’ requests for appoint arrive during the day. But in this model, we

assume that the scheduler observes all the arrivals during each day, and then make decision about

them at the end of that day. Actually, the decisions are made at the end of each day over an inﬁnite

horizon. Thus, the model becomes a discrete time MDP. In our model, the planning horizon is

assumed to be rolling. It means that day h at the current decision epoch becomes day h − 1 at the

next decision epoch.

3.4. State space

At the end of each day, the scheduler needs to observe the available capacity at the next H days

and the total number of patients that are waiting to be scheduled. Thus, the state of the system

at each decision epoch takes the form

(cid:126)s = ((cid:126)x, (cid:126)y) = (x1, x2, ..., xI; y1, y2, ..., yH),

(6)

Let xt

i be the number of patients with priority type i at current day (day t), where i = 1, 2, .., I

represents the priority class of patients. We assume that xi ≤ Di where Di shows the maximum

number of type i arrivals. Let yh be the number of available spots at h days ahead where h =

1, 2, ..., H and yh ≤ G where G is the maximum capacity available at each day. In other words,

y1 ≤ y2 ≤ ... ≤ yH and always yH = G. For this study we choose G = 90 and H = 7.

3.5. Action set

The action set of the model at each day takes the form

(cid:126)a = (aih), ∀h ∈ {1, 2, ..., H}, i ∈ {1, 2, ..., I},

(7)

14

Youseﬁ, Hasankhani, Kiani: Appointment scheduling model in healthcare using clustering algorithms
Article submitted to ; manuscript no. xxxx

where aih shows the number of appointments that are oﬀered to patients of type i for h days ahead.

We assume that each patient needs one appointment spot. The number of oﬀered appointments

to a speciﬁc day can not exceed the number of available appointments at that day. Moreover, the

number of accepted appointments in each day can not exceed the number of arrivals at that day.

Thus

I
(cid:88)

i=1
H
(cid:88)

h=1

aih ≤ yh ∀h ∈ {1, 2, ..., H},

aih ≤ xi ∀i ∈ {1, 2, ..., I},

(8)

(9)

3.6. Transition probabilities

After taking a decision, the only statistic elements of the next state are new arrivals of diﬀerent

patient priorities. The arrivals follow Poisson distribution. Let x(cid:48)

i be the new arrivals of the next

day. Thus, the state transition takes the form

(x1, x2, ..., xI; y1, y2, ..., yH) → (x(cid:48)

1, x(cid:48)

2, ..., x(cid:48)

I; y2 +

I
(cid:88)

i=1

ai2, y3 +

I
(cid:88)

i=1

ai3, ..., G),

(10)

which occurs with probability p((cid:126)x(cid:48)) = (cid:81)I

i=1 p(x(cid:48)

i), where p(x(cid:48)

i) is the probability of arrival of x(cid:48)

i type

i patients. The demand of diﬀerent priority patients are independent of each other.

3.7. Costs

The cost associated with each state-action comes from two sources:

1. cost of giving the late appointment to type i patients: bih,

2. cost of delivering or rejecting type i patients: ci,

Thus, the cost function takes the form

c((cid:126)s,(cid:126)a) =

I
(cid:88)

H
(cid:88)

i=1

h=1

bihaih +

I
(cid:88)

i=1

ci(xi −

H
(cid:88)

h=1

aih),

(11)

3.8. The Bellman equation

Let v((cid:126)s) be the total expected discounted cost over the inﬁnite horizon. The discounting factor is

denoted by λ. The Bellman equations are given by

(cid:26)

v((cid:126)s) = min

c((cid:126)s,(cid:126)a) + λ

(cid:88)

s(cid:48)∈S

p((cid:126)s(cid:48)|(cid:126)s,(cid:126)a)v((cid:126)s(cid:48))

(cid:27)

∀(cid:126)s ∈ S

(12)

Youseﬁ, Hasankhani, Kiani: Appointment scheduling model in healthcare using clustering algorithms
Article submitted to ; manuscript no. xxxx

15

The challenge is that even for very small values of arrivals, the size of the state space and the size

of the action set make the problem impossible to be solved by one of the traditional MDP solution

methods. Thus, we refer to ﬂuid approximation method for solving our MDP problem.

3.9. Fluid Approximation

The state space of the MDP in Section 3.2 is extremely large in practice. Therefore, due to the curse

of dimensionality the classical methods for solving MDPs, e.g. value iteration, policy iteration, and

linear programming techniques, cannot be used to solve the Bellman equation (12) of the MDP

model. However, we use the ﬂuid analysis technique to approximate the MDP via a ﬂuid model, and

produce sub-optimal appointment scheduling rules. Note that the ﬂuid model is an optimal control

problem. Let xi(t) be the arrival rate of priority type i patients at time t, yh(t) be the number of

available spots at h days ahead at time t, and uh

i (t) be the rate of oﬀering appointments to patients
of type i for h days ahead. Then, vector z(t) = (cid:0)x(t), y(t)(cid:1) is the vector of state variables of the

optimal control problem that are our state space elements, where x(t) = (cid:0)x1, . . . , xI
(cid:0)y1(t), . . . , yH(t)(cid:1) and u(t) = (cid:0)uh

i (t) : i{1, . . . , I}, h ∈ {1, . . . , H}(cid:1) is the vector of control variables of

(cid:1) and y(t) =

the model. Actually, u is the action vector in the optimal control model.

We let β = (cid:0)βh

i : i{1, . . . , I}, h ∈ {1, . . . , H}(cid:1) be the late cost vector with βh

i being the cost asso-

ciated to giving a late appointment to a patient in priority class i, and γ = (γ1, . . . , γI) be the

delivering/rejecting cost vector with γi being the cost of delivering or rejecting a type i patient.

The objective function of the MDP model is the minimization of the total costs (including late

appointment penalties and delivering/rejecting costs) during the planning horizon [0, ∞). Thus,

the objective function F (cid:0)z(t), u(t)(cid:1) of the ﬂuid model is given by:

F (cid:0)z(t), u(t)(cid:1) =

(cid:90) ∞

(cid:16)

0

βu(t) + γ(cid:0)x(t) −

uh(t)(cid:1)(cid:17)

dt,

H
(cid:88)

h=1

(13)

where uh(t) := (cid:0)uh

I (t)(cid:1). In order to write the state evolution of the system, let λ(t) =
(cid:0)λ1(t), . . . , λI(t)(cid:1) with λi(t) being the change rate of the arrival rate of patient type i at time t.

1 (t), . . . , uh

The state variable evolution constraints can then be written as

˙xi(t) = λi(t),

i = 1, . . . , I, xi(0) = x0
i ,

(14)

16

Youseﬁ, Hasankhani, Kiani: Appointment scheduling model in healthcare using clustering algorithms
Article submitted to ; manuscript no. xxxx

˙yh(t) =

I
(cid:88)

i=1

uh+1
i

(t), h = 1, . . . , H, yh(0) = y0
h,

with the following non-negativity constraints on the state variables

xi(t) ≥ 0,

i = 1, . . . , I,

yh(t) ≥ 0, h = 1, . . . , H,

(15)

(16)

(17)

where x0

i for i = 1, . . . , I and y0

h for h = 1, . . . , H are the initial state of the system. Next, by using

equations (8) and (9) we write the constraints on the control variables of the ﬂuid model as follows:

I
(cid:88)

i=1
H
(cid:88)

h=1

uh
i (t) ≤ yh(t), h = 1, . . . , H,

uh
i (t) ≤ xi(t),

i = 1, . . . , I,

with the following non-negativity constraints on the control variables:

uh
i (t) ≥ 0,

i = 1, . . . , I, h = 1, . . . , H.

Then, the set of feasible actions of the ﬂuid model is given by

Ω(t) =

(cid:110)

u(t) :

I
(cid:88)

i=1

uh
i (t) ≤ yh(t), h = 1, . . . , H ;

H
(cid:88)

h=1

uh
i (t) ≤ xi(t), i = 1, . . . , I;

uh
i (t) ≥ 0, i = 1, . . . , I, h = 1, . . . , H

(cid:111)
.

(18)

(19)

(20)

(21)

Hence, the ﬂuid approximation of the stochastic MDP formulation of the appointment scheduling

system is as follows





VF (z0) = max (cid:82) ∞

0

(cid:16)

βu(t) + γ(cid:0)x(t) − (cid:80)H

h=1 uh(t)(cid:1)(cid:17)

dt

(P1)

subject to (14) − (20),

which is a linear optimal control problem with mixed state-action constraints as the set of feasible

control Ω(t) includes constraints on both state and control variables.

We use the necessary and suﬃcient conditions for optimality of a solution to the optimal control

problem (P1), which is discussed in Hartl et al. (1995), to characterize the structure of its optimal

solution.

Youseﬁ, Hasankhani, Kiani: Appointment scheduling model in healthcare using clustering algorithms
Article submitted to ; manuscript no. xxxx

17

4. Numerical results

K-means clustering and hierarchical clustering are known as the two most common clustering

methods that are described in Section 3. The best number of clusters which is selected on this

problem calculated using elbow method. In this approach, the K-means clustering method is applied

for each number of cluster k between 1 and 10 and the sum of squared errors (SSE) is calculated.

SSE will always decrease with larger K. (SSE is 0 when K is equal to the number of data points

in the data set, because then each data point is its own cluster, and there is no error between it

and the center of its cluster). At some point, the SSE will not decrease much between values, this

implies that probably two centers are used in the same grouping of data, so the squared distance

to either is similar. By using elbow method and using the plot of within-cluster sums of squares

(WCSS) versus K, we can ﬁnd the best priority clusters for this problem.

As it is shown on Figure 5, after K=2 the decreasing of sum of squared distances has lower speed,

Figure 5: Elbow method for optimal number of clusters

so it can be concluded that the best K is K=2. The next step is ﬁnding the best features subset

using Wrapper algorithm, subsequently these two clustering methods are applied to cluster the

patients into two diﬀerent classes of high and low priority. In order to compare the accuracy of these

two clustering methods, Silhouette coeﬃcient is applied. Silhouette coeﬃcient is a measurement of

comparing the similarity of a point to its own cluster with respect to the other clusters. It can be

calculated as follows:

sil(i) =

µ(i) − ζ(i)
Max{ζ(i), µ(i)}

,

(22)

18

Youseﬁ, Hasankhani, Kiani: Appointment scheduling model in healthcare using clustering algorithms
Article submitted to ; manuscript no. xxxx

where ζ(i) is the average distance of point i from all the other points in the same cluster (Ci), and

µ(i) is smallest average distance of point i to all points in other clusters. µ(i) = Mind(i, C), where

d(i, C) is the average distance of point i to other points in cluster C (cid:54)= Ci. Comparing the average

silhouette coeﬃcient for both methods, it can be conducted that K-means clustering has better

performance with silhouette score of 0.87 compare to agglomerative methods with 0.81 silhouette

score. This paper suggests the hospital to use the K-means clustering as a decision making tool to

categorize the arrived patient into one of the priority classes, and then schedule an appointment

for this patient.

Using the data set, the daily arrivals of outpatient types are estimated as Poisson distributions

with means λ1 = 44 and λ2 = 56, where λ1 and λ2 represent the arrival rates of lower and higher

priority outpatients, respectively. Outpatients are scheduled within a week (H=7). According to the

priority classes we estimate the cost parameters of the MDP model. The estimations are provided in

Table 2. According to the table, bih is the cost of giving and appointment h days later to outpatient

class i, and ci is the cost of rejecting an outpatient of priority class i. G is the total number of

available appointments at each day.

Table 2: Parameters values for the MDP model

Parameter Value Parameter Value

b11

b12

b13

b14

b15

b16

b17

b21

b22

0

0.5

1

1.5

2

2.5

3

0

1

b23

b24

b25

b26

b27

c1

c2

G

3

0

1

2

3

5

10

90

After solving the MDP using ﬂuid approximation method the optimal policy is obtained. Accord-

ing to optimal policy, the optimal number of appointments that have to scheduled within the next

7 days are estimated. The results are represented in Table 3. The remaining appointment requests

Youseﬁ, Hasankhani, Kiani: Appointment scheduling model in healthcare using clustering algorithms
Article submitted to ; manuscript no. xxxx

19

have to be canceled. In other words, after observing the optimal policy we come up with a bench-

mark policy that is easy to implement in the healthcare facility. Using this benchmark policy that

is obtained based on the optimal policy, the healthcare facility do not need to solve the MDP

every day. The scheduler just needs to classify the arrivals and then uses the benchmark policy for

scheduling them. According to this benchmark policy in each day, the number of outpatients of

each group that we schedule on the next 7 days are based on the values of Table 3. As an instance,

at the end of each day we schedule 15 outpatients of class 1 and 20 outpatients of class 2 to the next

day appointments. For two days ahead, we always schedule 12 and 17 outpatients of class 1 and 2,

respectively. We continue this procedure for the next 7 days. Therefore, at the end of each day we

schedule some outpatients for the next 7 days. Moreover, we should mention that after fulﬁlling

the appointments based on the proposed numbers, if we still have available appointment for next

day, we schedule more higher priority outpatients to make sure that we use all the capacity. In

the other case, if we do not have enough capacity as much as the individuals we are supposed to

schedule for the next day, we decrease the number of lower priority outpatients that are scheduled

for next day. These cases would happen because of the uncertain arrivals in the real world.

Table 3: Number of appointments that can be scheduled based on the optimal policy

Priority class day 1 day 2 day 3 day 4 day 5 day 6 day 7

1

2

15

20

12

17

9

14

6

11

3

8

0

5

0

2

5. Conclusion

In this paper, we use K-means clustering and agglomerative hierarchical clustering methods to

group outpatients into two classes of high and low priorities. Wrapper algorithm is used to ﬁnd the

best feature of data set to be used in training the clustering pattern. Silhouette coeﬃcient is used

to compared the accuracy of these two clustering methods, and as it is shown K-means clustering

has a higher accuracy than agglomerative hierarchical clustering method. Therefore, K-means clus-

tering method can be used to build a pattern and predict the priority classes of outpatients. Then,

the scheduling model is utilized to schedule outpatients. The scheduling procedure is modeled as a

20

Youseﬁ, Hasankhani, Kiani: Appointment scheduling model in healthcare using clustering algorithms
Article submitted to ; manuscript no. xxxx

MDP, and ﬂuid approximation is used to solve that. The model tries to oﬀer the closest appoint-

ments to higher priority outpatients.Based on the results of the MDP, we propose a benchmark

policy for scheduling multiple classes of outpatients. We used Alizadehsani et al. (2013) data set

and applied our scheduling procedure.

Youseﬁ, Hasankhani, Kiani: Appointment scheduling model in healthcare using clustering algorithms
Article submitted to ; manuscript no. xxxx

21

References

Ayodeji Adegunsoye, Justin M Oldham, Jonathan H Chung, Steven M Montner, Cathryn Lee, Leah J Witt, Danielle

Stahlbaum, Rene S Bermea, Lena W Chen, Scully Hsu, et al. Phenotypic clusters predict outcomes in a

longitudinal interstitial lung disease cohort. Chest, 153(2):349–360, 2018.

Amir Ahmadi-Javid, Zahra Jalali, and Kenneth J Klassen. Outpatient appointment systems in healthcare: A review

of optimization studies. European Journal of Operational Research, 258(1):3–34, 2017.

Roohallah Alizadehsani, Jafar Habibi, Mohammad Javad Hosseini, Hoda Mashayekhi, Reihane Boghrati, Asma Ghan-

deharioun, Behdad Bahadorian, and Zahra Alizadeh Sani. A data mining approach for diagnosis of coronary

artery disease. Computer methods and programs in biomedicine, 111(1):52–61, 2013.

AS Aneeshkumar and C Jothi Venkateswaran. A novel approach for liver disorder classiﬁcation using data mining

techniques. Engineering and Scientiﬁc International Journal, 2(1):15–18, 2015.

Ishita Bhakta and Arkaprabha Sau. Prediction of depression among senior citizens using machine learning classiﬁers.

International Journal of Computer Applications, 144(7):11–16, 2016.

Elkin Castro and Sanja Petrovic. Combined mathematical programming and heuristics for a radiotherapy pre-

treatment scheduling problem. Journal of Scheduling, 15(3):333–346, 2012.

Tugba Cayirli and Emre Veral. Outpatient scheduling in health care: a review of literature. Production and operations

management, 12(4):519–549, 2003.

Vikas Chaurasia and Saurabh Pal. Data mining techniques: to predict and resolve breast cancer survivability. Inter-

national Journal of Computer Science and Mobile Computing IJCSMC, 3(1):10–22, 2014.

Rachel R Chen and Lawrence W Robinson. Sequencing and scheduling appointments with potential call-in patients.

Production and Operations Management, 23(9):1522–1538, 2014.

Manoranjan Dash and Huan Liu. Feature selection for clustering. In Paciﬁc-Asia Conference on knowledge discovery

and data mining, pages 110–121. Springer, 2000.

Daniel Defays. An eﬃcient algorithm for a complete link method. The Computer Journal, 20(4):364–366, 1977.

Brian Denton and Diwakar Gupta. A sequential bounding approach for optimal appointment scheduling. IIE trans-

actions, 35(11):1003–1016, 2003.

Abdelmoula El-Hamdouchi and Peter Willett. Hierarchic document classiﬁcation using ward’s clustering method. In

Proceedings of the 9th annual international ACM SIGIR conference on Research and development in information

retrieval, pages 149–156, 1986.

22

Youseﬁ, Hasankhani, Kiani: Appointment scheduling model in healthcare using clustering algorithms
Article submitted to ; manuscript no. xxxx

Na Geng and Xiaolan Xie. Optimal dynamic outpatient scheduling for a diagnostic facility with two waiting time

targets. IEEE Transactions on Automatic Control, 61(12):3725–3739, 2016.

Yasin Gocgun and Martin L Puterman. Dynamic scheduling with due dates and time windows: an application to

chemotherapy patient appointment booking. Health care management science, 17(1):60–76, 2014.

Yasin Gocgun, Brian W Bresnahan, Archis Ghate, and Martin L Gunn. A markov decision process approach to

multi-category patient scheduling in a diagnostic facility. Artiﬁcial intelligence in medicine, 53(2):73–81, 2011.

Patrice Godin and Chun Wang. Agent-based outpatient scheduling for diagnostic services. In 2010 IEEE International

Conference on Systems, Man and Cybernetics, pages 1851–1856. IEEE, 2010.

John C Gower and Gavin JS Ross. Minimum spanning trees and single linkage cluster analysis. Journal of the Royal

Statistical Society: Series C (Applied Statistics), 18(1):54–64, 1969.

Richard F Hartl, Suresh P Sethi, and Raymond G Vickson. A survey of the maximum principles for optimal control

problems with state constraints. SIAM review, 37(2):181–218, 1995.

Farhad Hasankhani and Amin Khademi.

Is it time to include post-transplant survival in heart transplantation

allocation rules? Available at SSRN 3416214, 2019.

Sandy H Huang, Paea LePendu, Srinivasan V Iyer, Ming Tai-Seale, David Carrell, and Nigam H Shah. Toward

personalizing treatment for depression: predicting diagnosis and severity. Journal of the American Medical

Informatics Association, 21(6):1069–1075, 2014.

Lambodar Jena and Narendra Ku Kamila. Distributed data mining classiﬁcation algorithms for prediction of chronic-

kidney-disease. International Journal of Emerging Research in Management &Technology, 4(11):110–118, 2015.

Asha Gowda Karegowda, MA Jayaram, and AS Manjunath. Feature subset selection problem using wrapper approach

in supervised learning. International journal of Computer applications, 1(7):13–17, 2010.

Mahsa Kiani, Burak Eksioglu, Tugce Isik, Alexandria Thomas, and John Gilpin. Evaluating appointment postpone-

ment in scheduling patients at a diagnostic clinic. Available at SSRN 3565680, 2020.

James M Magerlein and James B Martin. Surgical demand scheduling: A review. Health services research, 13(4):418,

1978.

Khashayar Mahani, Seyyed Danial Nazemi, Maryam Arabzadeh Jamali, and Mohsen A Jafari. Evaluation of the

behind-the-meter beneﬁts of energy storage systems with consideration of ancillary market opportunities. The

Electricity Journal, 33(2):106707, 2020.

K. Manimekalai. Prediction of heart diseases using data mining techniques. 2016.

Youseﬁ, Hasankhani, Kiani: Appointment scheduling model in healthcare using clustering algorithms
Article submitted to ; manuscript no. xxxx

23

Seyyed Danial Nazemi and Mohsen A Jafari. An automated cluster-based approach for asset rescheduling in building

communities. In 2020 IEEE Texas Power and Energy Conference (TPEC), pages 1–5. IEEE, 2020.

Mireille Nieuwenhuis, Neeltje EM van Haren, Hilleke E Hulshoﬀ Pol, Wiepke Cahn, Ren´e S Kahn, and Hugo G

Schnack. Classiﬁcation of schizophrenia patients and healthy controls from structural mri scans in two large

independent samples. Neuroimage, 61(3):606–612, 2012.

Jonathan Patrick. A markov decision model for determining optimal outpatient scheduling. Health care management

science, 15(2):91–102, 2012.

Jonathan Patrick and Martin L Puterman. Improving resource utilization for diagnostic services through ﬂexible

inpatient scheduling: A method for improving resource utilization. Journal of the Operational Research Society,

58(2):235–245, 2007.

Jonathan Patrick, Martin L Puterman, and Maurice Queyranne. Dynamic multipriority patient scheduling for a

diagnostic resource. Operations research, 56(6):1507–1525, 2008.

Parag C Pendharkar and Hitesh Khurana. Machine learning techniques for predicting hospital length of stay in

pennsylvania federal and specialty hospitals. International Journal of Computer Science & Applications, 11(3),

2014.

Eduardo P´erez, Lewis Ntaimo, Wilbert E Wilhelm, Carla Bailey, and Peter McCormack. Patient and resource

scheduling of multi-step medical procedures in nuclear medicine.

IIE Transactions on Healthcare Systems

Engineering, 1(3):168–184, 2011.

Vili Podgorelec and Peter Kokol. Genetic algorithm based system for patient scheduling in highly constrained

situations. Journal of medical systems, 21(6):417–427, 1997.

Ehsan Sadrfaridpour, Sandeep Jeereddy, Ken Kennedy, Andre Luckow, Talayeh Razzaghi, and Ilya Safro. Algebraic

multigrid support vector machines. arXiv preprint arXiv:1611.05487, 2016.

Ehsan Sadrfaridpour, Talayeh Razzaghi, and Ilya Safro. Engineering fast multilevel support vector machines. Machine

Learning, 108(11):1879–1917, 2019.

Michele Samorani and Linda R LaGanga. Outpatient appointment scheduling given individual day-dependent no-

show predictions. European Journal of Operational Research, 240(1):245–257, 2015.

Hamid K Seifoddini. Single linkage versus average linkage clustering in machine cells formation applications. Com-

puters & Industrial Engineering, 16(3):419–426, 1989.

Mai Shouman, Tim Turner, and Rob Stocker. Integrating naive bayes and k-means clustering with diﬀerent initial

centroid selection methods in the diagnosis of heart disease patients. CS & IT-CSCP, pages 125–137, 2012.

24

Youseﬁ, Hasankhani, Kiani: Appointment scheduling model in healthcare using clustering algorithms
Article submitted to ; manuscript no. xxxx

Luis Talavera. An evaluation of ﬁlter and wrapper methods for feature selection in categorical clustering. In Inter-

national Symposium on Intelligent Data Analysis, pages 440–451. Springer, 2005.

Ayten Turkcan, Bo Zeng, and Mark Lawley. Chemotherapy operations planning and scheduling. IIE Transactions

on Healthcare Systems Engineering, 2(1):31–49, 2012.

Jin Wang and YK Fung. An integer programming formulation for outpatient scheduling with patient preference.

Industrial Engineering & Management Systems, 13(2):193–202, 2014.

Nooshin Youseﬁ and David W Coit. Dynamic inspection planning for systems with individually repairable compo-

nents. arXiv preprint arXiv:1903.00932, 2019.

Haibin Zhu, Ming Hou, Chun Wang, and MengChu Zhou. An eﬃcient outpatient scheduling approach.

IEEE

Transactions on Automation science and engineering, 9(4):701–709, 2012.

