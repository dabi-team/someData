0
2
0
2

r
p
A
7

]
h
p
-
t
n
a
u
q
[

1
v
7
0
7
3
0
.
4
0
0
2
:
v
i
X
r
a

Magnetic Field Fingerprinting of Integrated Circuit Activity with a Quantum
Diamond Microscope

Matthew J. Turner,1, 2 Nicholas Langellier,1, 3 Rachel Bainbridge,4 Dan Walters,4
Srujan Meesala,1, ∗ Thomas M. Babinec,5 Pauli Kehayias,6 Amir Yacoby,1, 5 Evelyn
Hu,5 Marko Lonˇcar,5 Ronald L. Walsworth,1, 2, 3, 7, 8, 9 and Edlyn V. Levine1, 4, †
1Department of Physics, Harvard University, Cambridge, MA 02138, USA
2Center for Brain Science, Harvard University, Cambridge, MA 02138, USA
3Harvard-Smithsonian Center for Astrophysics, Cambridge, MA 02138, USA
4The MITRE Corporation, Bedford, MA 01730, USA
5John A. Paulson School of Engineering and Applied Sciences,
Harvard University, Cambridge, Massachusetts 02138, United States
6Sandia National Laboratories, Albuquerque, NM 87123, USA
7Department of Physics, University of Maryland, College Park, MD 20740, USA
8Department of Computer and Electrical Engineering, University of Maryland, College Park, MD 20740, USA
9Quantum Technology Center, University of Maryland, College Park, MD 20740, USA
(Dated: April 9, 2020)

Current density distributions in active integrated circuits (ICs) result in patterns of magnetic
ﬁelds that contain structural and functional information about the IC. Magnetic ﬁelds pass through
standard materials used by the semiconductor industry and provide a powerful means to ﬁngerprint
IC activity for security and failure analysis applications. Here, we demonstrate high spatial resolu-
tion, wide ﬁeld-of-view, vector magnetic ﬁeld imaging of static (DC) magnetic ﬁeld emanations from
an IC in diﬀerent active states using a Quantum Diamond Microscope (QDM). The QDM employs a
dense layer of ﬂuorescent nitrogen-vacancy (NV) quantum defects near the surface of a transparent
diamond substrate placed on the IC to image magnetic ﬁelds. We show that QDM imaging achieves
simultaneous ∼ 10 µm resolution of all three vector magnetic ﬁeld components over the 3.7 mm ×
3.7 mm ﬁeld-of-view of the diamond. We study activity arising from spatially-dependent current
ﬂow in both intact and decapsulated ﬁeld-programmable gate arrays (FPGAs); and ﬁnd that QDM
images can determine pre-programmed IC active states with high ﬁdelity using machine-learning
classiﬁcation methods.

I.

INTRODUCTION

Securing integrated circuits (ICs) against manufac-
turing ﬂaws, hardware attacks, and software attacks is
of vital importance to the semiconductor industry [1].
Hardware attacks often modify the physical layout of an
integrated circuit, thereby changing its function. This
type of attack can occur at any stage of the globalized
semiconductor supply chain, and can range from inser-
tion of malicious Trojan circuitry during the design and
fabrication stages [2], to modiﬁcation or counterfeiting
during packaging and distribution stages [3]. Horizon-
tal integration of the industry has led to contracting of
IC fabrication, packaging, and testing to oﬀshore facil-
ities, resulting in a reduction of secure oversight and
quality control [4]. Additional growth of the second-
hand electronics market has led to a drastic increase in
counterfeit ICs [5]. Detection of IC tampering or coun-
terfeiting has consequently become essential to ensure
hardware can be trusted. Similar issues aﬀect quality
control of unintended manufacturing ﬂaws.

Magnetic ﬁeld emanations from ICs aﬀord a power-
ful means for non-destructive physical testing. Mag-

∗ Current Aﬃliation: Thomas J. Watson, Sr. Laboratory of
Applied Physics, California Institute of Technology, Pasadena,
California 91125, USA

† Corresponding Author: edlynlevine@fas.harvard.edu

netic ﬁelds are generated by current densities in ICs
resulting from power and clock distribution networks,
input/output lines, word and bit lines, and switching
transistors. These currents are present in all operating
logic and memory chips and can be leveraged for study-
ing the operational behavior of an IC during task exe-
cution. In general, the resulting IC magnetic ﬁelds pass
through many standard IC materials, and will vary spa-
tially and temporally in ways that correlate with both
IC architecture and operational state. Thus, combined
high-resolution and wide-ﬁeld-of-view mapping of mag-
netic ﬁelds may yield simultaneous structural and func-
tional information, and may be suitable for identiﬁca-
tion of malicious circuitry or Trojans [6, 7], counterfeit
detection [8], fault detection [9, 10], and manufacturing
ﬂaws [11]. However, leveraging magnetic ﬁeld emana-
tions is challenging due to the tremendous complexity
of circuits integrating billions of transistors of minimum
feature sizes down to tens of nanometers, with inter-
connects distributed across multiple levels of metalliza-
tion [12]. Multi-layered metal interconnects and three-
dimensional stacking give rise to complex magnetic ﬁeld
patterns that are diﬃcult to invert; and large stand-oﬀ
distances of magnetometers reduce amplitudes of mag-
netic ﬁelds and spatial resolution [13].

In this paper, we demonstrate how these challenges
can be approached using a Quantum Diamond Micro-
scope (QDM) [14–16] augmented with machine-learning
classiﬁcation techniques. With the QDM, we perform

 
 
 
 
 
 
2

FIG. 1.
(a) Schematic of the Quantum Diamond Microscope (QDM) experimental setup with insets showing the diamond in
contact with intact and decapsulated FPGAs. The diamond is positioned such that the NV layer is in direct contact with the
FPGA, as indicated by the red layer in the insets. (b) Diamond crystal lattice with the nitrogen (red) vacancy (grey) defect.
Lab frame coordinates (X,Y ,Z) and NV frame coordinates for a single defect (x,y,z) are shown. (c) The ground state energy
level diagram for an NV with ﬁne structure and Zeeman splitting. (d) Example ODMR spectral data for an applied bias ﬁeld
of (BX ,BY ,BZ ) = (2.04 1.57 0.65) mT, showing resonance frequencies of f±,i with i = 1, 2, 3, 4 indicating each of the four NV
axes. Hyperﬁne interactions between the NV− electrons and the spin-1 14N nucleus result in splitting of each NV resonance
into three lines.

simultaneous wide ﬁeld-of-view, high spatial resolution,
vector magnetic ﬁeld imaging of an operational ﬁeld-
programmable gate array (FPGA). FPGAs are conﬁg-
urable ICs that are commonly used for diverse elec-
tronics applications. Systematic and controlled varia-
tion of the circuit activity in the FPGA generates com-
plex magnetic ﬁeld patterns, which we image with the
QDM. The QDM employs a dense surface layer of ﬂu-
orescent nitrogen-vacancy (NV) quantum defects in a
macroscopic diamond substrate placed on the IC under
ambient conditions.

We use the QDM to image magnetic ﬁelds from
both decapsulated (decapped) and through-package (in-
tact) FPGAs under operational conditions using contin-
uous wave (CW) optically detected magnetic resonance
(ODMR) NV spectroscopy. For the decapped FPGA,
our measurements yield magnetic ﬁeld maps that are
distinguishable between operational states over approx-
imately a 4 mm × 4 mm ﬁeld-of-view with a 20 nT
noise ﬂoor, and ∼ 10 µm magnetic ﬁeld spatial resolu-
tion, limited by the thickness of the NV surface layer in
the diamond and the distance to the nearest metal layer.
For the intact FPGA, the QDM measurements provide
magnetic ﬁeld maps with a similar ﬁeld-of-view, 2 nT
noise ﬂoor, and ∼ 500 µm magnetic ﬁeld spatial res-
olution, limited by the stand-oﬀ distance between the
NV layer and the FPGA current sources. In particu-
lar, we ﬁnd that operational states of the intact FPGA

are distinguishable in the QDM images, even with the
diminished magnetic ﬁeld amplitude and spatial resolu-
tion that arise from the large stand-oﬀ between the dia-
mond and the IC die. We use machine learning methods
to demonstrate FPGA operational state classiﬁcation
via magnetic ﬁeld pattern correlation for both decapped
and intact FPGA QDM images. This result provides an
initial demonstration of functional IC characterization
that can be leveraged to ﬁngerprint IC activity.

To date, QDM magnetic ﬁeld imaging has been
used to measure microscopic current and magnetiza-
tion distributions from a wide variety of sources in
both the physical and life sciences [17–23]. Comple-
mentary to existing scanning techniques for charac-
terizing IC magnetic ﬁeld emanations, which include
wire loops [24], probe antennas [25], magnetic force
microscopy [10], SQUID magnetometers [7], and va-
por cell magnetometers [26], the QDM provides simul-
taneous high-resolution (micron-scale) and wide-ﬁeld
(millimeter-scale) vector magnetic imaging. This capa-
bility allows for monitoring of transient behavior over
sequential measurements of a magnetic ﬁeld, provid-
ing a means to study correlations in signal patterns
that can evolve more quickly than a single-sensor scan
time. With these distinctive advantages, the QDM-
based technique aﬀords a promising, novel means for
non-destructive physical testing of ICs.

XYZxiyizi2870 MHzms = 0MWProbems = 0ms = -1ms = +1ms = ±13A2f- , if+ , i2800284028802920MWFrequency(MHz)0.990.9951PLContrastf-,1f-,2f-,3f-,4f+,4f+,3f+,2f+,1XXYYZZxiyizzi2870 MHzms = 0MWProbems = 0ms = -1mss = +1ms = ±13A2f- , if- , iff+ , if+ , if2800284028802920MWFrFrFequencycyc(MHz)0.990.9951PLPLPCoCoCntraasasatstsf-,1f-,2f-,3f-,4f+f+f,4f+f+f,3f+f+f,2f+f+f,1(b)(c)(d)II. EXPERIMENTAL DESIGN

A. QDM Experimental Setup

A schematic of the QDM is shown in Fig. 1(a). The
magnetic ﬁeld sensor consists of a 4 mm × 4 mm × 0.5
mm diamond substrate with a 13 µm surface layer of
NV centers. The diamond is placed directly on the IC
with the NV layer in contact with the IC surface. The
diamond is grown by Element Six Ltd. to have an iso-
topically pure NV layer consisting of [12C] ∼ 99.999%,
[14N] ∼ 27 ppm, and [NV-] ∼ 2 ppm. Light from a 532
nm, CW laser (Lighthouse Photonics Sprout-H-10W)
optically addresses the NV layer with beam power of
about 500 mW uniformly distributed over the 4 mm × 4
mm NV layer. A ﬂat-top beam shaping element (Eksma
Optics GTH-5-250-4-VIS) and a cylindrical lens (Thor-
labs LJ1558RM-A) create a rectangular beam proﬁle (6
mm × 6 mm) incident on the top face of the diamond
at a suﬃciently shallow angle of incidence (4◦) relative
to the top diamond surface to illuminate the entire NV
layer. NV ﬂuorescence is collected with a low magniﬁ-
cation objective (Olympus UPlanFL N 4x 0.13 NA) to
interrogate a large ﬁeld-of-view of about 3.7 mm × 3.7
mm. The ﬂuorescence is ﬁltered with a 633 nm long-
pass ﬁlter (Semrock LP02-633RU-25) and imaged onto
a CMOS camera (Basler acA1920-155um). Resulting
CW ODMR data is transferred to a computer where it
is processed and analyzed with custom software utiliz-
ing LabVIEW and MATLAB.

A pair of 5 cm diameter SmCo permanent magnets
(Super Magnet Man) is placed on opposing sides of the
diamond to apply a uniform bias magnetic ﬁeld (bias
ﬁeld) of B0 = (BX , BY , BZ) = (2.04, 1.57, 0.65) mT.
X, Y , Z are the laboratory frame Cartesian coordi-
nates with the X-Y plane deﬁned as the surface of the
diamond in Fig. 1(b). B0 induces a ±geµBB0 · n Zee-
man splitting of the spin triplet NV m = 1 and m = −1
ground states along each of four tetrahedrally deﬁned
NV symmetry axes, n, with Land´e g-factor ge, and Bohr
magneton µB. The hyperﬁne interaction between the
NV and the 14N isotope nuclear spin (I=1) results in
an additional triplet level splitting. The four symmetry
axes of the NV, shown in Fig. 1(b), are leveraged for
vector magnetic ﬁeld imaging using B0 projection onto
all four NV axes [27]. The ground state energy level
diagram of a single NV axis is depicted in Fig. 1(c),
neglecting hyperﬁne structure.

A 6 mm diameter copper wire loop made from 320 µm
diameter magnet wire delivers 1 W of GHz-frequency
microwave (MW) ﬁelds (TPI-1001-B and ampliﬁed with
a Mini-Circuits ZHL-16W-43S+ ampliﬁer) to drive the
NV electronic spin transitions, ms = 0 ↔ −1 or
ms = 0 ↔ +1, denoted by f−,i and f+,i, respec-
tively, see Fig. 1(c). The MW ﬁeld is modulated on
and oﬀ through the use of a solid-state switch (ZASWA-
2-50DRA+) controlled by a DAQ (NI-USB 6259) and
synchronized with the frame acquisition of the camera
to correct for laser intensity ﬂuctuations and drift.

3

The intensity of optically induced NV ﬂuorescence
decreases for MW ﬁelds on resonance with one of the
spin transition energies. This decrease results from the
m = ±1 spin-selectivity of the non-optical, intersystem
crossing (ISC) mediated decay pathway for optically ex-
cited NVs [28]. The resonance frequencies between NV
ground-state sublevels are determined from the ground-
state Hamiltonian

H/h = (D(T ) + Mz) S2
y − S2
x

+ Mx

(cid:0)S2

z + γ (BxSx + BySy + BzSz)
(cid:1) + My (SxSy + SySx)

(1)

for the projection of B0 along a single NV axis, where h
is Planck’s constant, D(T ) ≈ 2870 MHz is the temper-
ature dependent zero ﬁeld splitting, T is the tempera-
ture, Sk are the dimensionless spin-1 Pauli operators,
γ = 2.803 × 104 MHz/T is the NV gyromagnetic ratio,
Bk are the components of B0 in the NV frame, and
Mk are crystal stress terms [29]. Cartesian coordinates
k = x, y, z are deﬁned in the NV frame with z along
the selected NV axis, see Fig. 1(b). The contribution
of the hyperﬁne interaction between the NV and 14N
nuclear spin is treated as a constant, 2.158 MHz energy
level splitting and is not shown explicitly in Eqn. 1.
Sweeping the frequency of the applied MW ﬁelds across
the range of resonant frequencies and collecting the NV
ﬂuorescence results in an optically detected magnetic
resonance (ODMR) spectrum. Fig. 1(d) depicts the re-
sulting ODMR measurements for a bias ﬁeld alignment
where each NV axis experiences a diﬀerent projection
of the bias magnetic ﬁeld.

Continuous-wave (CW) ODMR is used to image DC
FPGA magnetic ﬁelds. CW ODMR leverages contin-
uous application of the laser and MW ﬁeld. This ap-
proach yields wide ﬁeld-of-view images with high spa-
tial resolution and good magnetic ﬁeld sensitivity, while
minimally perturbing the sample under study [14, 15].
A diamond with suﬃciently low Mz inhomogeneity
across the ﬁeld-of-view is used to minimize degradation
of performance [29]. Further suppression of strain con-
tributions is achieved with application of the static bias
ﬁeld, B0. Thus, the Mx and My terms in Eqn. 1 are
negligible [29, 30]. The ground state Hamiltonian along
a single NV axis reduces to

H/h ≈ (D(T )+Mz)S2

z +γBzSz +γBxSx +γBySy, (2)

and is used to determine the CW ODMR resonance fre-
quencies for each pixel in a QDM image, and thereby
to determine the magnetic ﬁeld image from the sample
FPGA.

B.

IC Preparation, Control, and Layout

The Xilinx 7-series Artix FPGA (XC7A100T-
1CSG324C) shown in Fig. 2(a) and 2(b) is selected for
this study. This FPGA is a 15 mm × 15 mm wirebonded

4

(a) Intact Xilinx 7-series Artix FPGA with die location and dimensions indicated in red (b) X-ray image of the
FIG. 2.
FPGA package determining the position and size of die outlined in red (c) A high resolution image of the decapsulated FPGA
with the ﬁxed diamond measurement ﬁeld-of-view indicated with a blue box, and the location of ring oscillator (RO) clusters
indicated by red boxes labeled R1 - R4. (d) Scanning electron microscope (SEM) image of the FPGA cross-section showing the
500 µm stand-oﬀ distance between the chip die and the top layer. (e) Close-up of the SEM focusing on the metal layers of die.
The thickness of the passivation layer is 5 µm and sets the minimum stand-oﬀ distance for the decapsulated measurements.

chip, fabricated in the TSMC 28 nm technology node,
that has a ∼ 6.5 mm × 10 mm silicon die with eight
clock regions. Digilent Nexys A7 development boards
are used to operate and conﬁgure the Artix-7 FPGA.

The large current draw and controllable location and
size of ring oscillators (ROs) make them ideal functional
units for this study [31]. Patterns of ROs are imple-
mented using the Xilinx Vivado Design Suite® to cre-
ate distinguishable current distributions on the FPGAs
for measurement by the QDM. Clusters of three-inverter
ROs are synthesized, placed, and routed to four diﬀerent
predeﬁned clock regions on the FPGA, with clear spatial
separation and spanning a majority of the die surface
as shown in Fig. 2(c). The clusters consist of variable
numbers of ROs allowing for incremental increase or de-
crease of the current draw at the diﬀerent locations on
the FPGA. The active states of the FPGA are deﬁned
by RO clusters implemented in one of the predeﬁned
regions, and the idle state is deﬁned as the FPGA pow-
ered on with no implemented ROs. The ordering of
states during a series of measurements are randomized
to reduce susceptibility to systematic noise sources.

The die of the Artix-7 FPGA is covered by roughly
500 µm of epoxy resin packaging material, separating
the diamond from the die for the intact conﬁguration.
This stand-oﬀ distance leads to smaller ﬁeld amplitude
at the NV sensor layer and acts as a low-pass ﬁlter de-
creasing the eﬀective QDM spatial resolution of FPGA

current sources [13]. To bring the diamond closer to
the die, one of the Artix-7 FPGAs is decapsulated (de-
capped) using a Nisene JetEtch Pro CuProtect decapsu-
lator (Fig. 2(c)). This process uses fuming sulfuric and
nitric acid to remove the packaging material, exposing
the die while leaving the FPGA electrically functional,
including preservation of the copper wirebonds.

The structure of the wire-bonded Artix 7 die, shown
in Fig. 2(d), is optimal for studies of patterns of power
delivery within the top metal layers of the FPGA. The
thickest layers of the metal stack are usually closest
to the top side of the package in wirebonded chips.
These thick layers are used for power distribution due
to their relatively low resistance characteristics com-
pared to the other layers of the IC. Clock distribution
networks and inputs/outputs (I/Os) occupy the next
thickest layers, and data signals are in the lowest and
thinnest metal layers. Prominent magnetic ﬁelds from
the current densities in the power distribution network
are therefore most easily detected with topside access
of a wirebonded device. Magnetic ﬁeld patterns from
the lower-level data signals are likely not distinguishable
with the present measurements. Note that Fig. 2(d) re-
veals large wire interconnects in the package substrate
connecting the wirebonds and solder balls. These wires
are deeper in the chip and are likely observable as low
spatial frequency components in the magnetic ﬁeld. As
will be seen below, static ﬁelds from solder balls and

15 mm15 mm10 mm6.5 mm3.7 mm500 μmSilicon DieWirebondInterconnectsSolder BallSilicon DieSilicon DieSilicon Die5 μmPassivation LayerGatesTop Metal LayerR3R1R4(a)(c)(d)(e)R2(b)Field of Viewother magnetic materials are also observable with the
QDM; but can be distinguished from functional current
ﬂow by diﬀerential RO measurements.

all four NV orientations for vector measurements, la-
beled by i = 1, 2, 3, 4 in Fig. 1(d), enables solving for
the vector magnetic ﬁeld in the lab frame

5

C. Experimental Protocol and Data Analysis

CW ODMR measurements are taken with the FPGA
in both active and idle states. The duration of each
measurement is ∼ 5 min per NV axis for each state (see
Supplemental Material [32]). Magnetic ﬁeld contribu-
tions from the ROs are determined by subtracting the
measured idle-state ODMR frequencies from the mea-
sured active-state ODMR frequencies, yielding the over-
all magnetic ﬁeld due to the ROs alone. For such mea-
surements, the NV ground-state Hamiltonian is given
by:

(cid:18)

H/h ≈

D +

(cid:19)

∆T + Mz

∂D
∂T
+γ(Bx + ∆Bx)Sx + γ(By + ∆By)Sy

z + γ(Bz + ∆Bz)Sz

S2

(3)

Here, terms with ∆ originate from the FPGA active
states. Following these deﬁnitions and treating the oﬀ-
axis magnetic ﬁelds as perturbative, the idle and active-
state resonant frequencies for the upper (f+) and lower
(f−) transitions of a single NV axis (i) are given by [30]

f±,i,Idle ≈ (D + Mz) +

3γ2
2D

(cid:0)B2

x + B2
y

(cid:1) ± γBz

(4)

and

+

(cid:18)

D +

f±,i,Active ≈
∆T + Mz
3γ2 (cid:2)(Bx + ∆Bx)2 + (By + ∆By)2(cid:3)

∂D
∂T

(cid:19)

2 (cid:0)D + ∂D

∂T ∆T + Mz

(cid:1)

±γ(Bz + ∆Bz).

(5)

The desired FPGA state-dependent magnetic ﬁeld pro-
jection on each NV axis, ∆Bz,i, and the change in local
temperature, ∆T , are given by

∆Bz,i =

∆T =

1
2γ
1
2 ∂D
∂T

(∆f+,i − ∆f−,i) ,

(∆f+,i + ∆f−,i) ,

(6)

where ∆f±,i = f±,i,Active − f±,i,Idle. The oﬀ-axis mag-
netic ﬁelds of the sample are suppressed by the zero-ﬁeld
splitting; thus terms dependent on ∆Bx and ∆By are
suﬃciently small to be neglected in Eqn. 6 (see Sup-
plemental Material [32]). Terms dependent on Bx, By,
Bz, D, and Mz are canceled by subtracting the idle res-
onance frequencies from the active state resonance fre-
quencies. Determining the resonance frequencies from

(∆Bz,2 + ∆Bz,4) ,

(∆Bz,1 + ∆Bz,3) ,

∆BX =

∆BY =

∆BZ =

√
3
√
2
2
√
3
√
2
2
√

3
4

[(∆Bz,1 − ∆Bz,3) − (∆Bz,4 − ∆Bz,2)] ,

(7)

where X, Y , Z are recalled to be the laboratory frame
shown in Fig. 1(b).

The ODMR lineshape for NV ensembles is well ap-
proximated by a Lorentzian lineshape [30]. ODMR
spectra for vector measurements of a 14N diamond sam-
ple contain 24 resonance features, Fig. 1(d) (3 hyper-
ﬁne features × 2 electronic spin transitions × 4 NV
axes). The resonance frequencies of Eqn. 6 are extracted
from the data by ﬁtting all the Lorentzian parameters
for every pixel in the ﬁeld-of-view [15]. Furthermore,
the contrast and linewidth of the resonances are deter-
mined, giving additional state dependent information
[32] which can additionally be used for probing high
frequency magnetic ﬁelds [33]. GPU-based ﬁtting al-
gorithms [34] speed up this computationally intensive
ﬁtting and enable rapid analysis of a large number of
measurements.

III. RESULTS

A. Vector Magnetic Imaging

Fig. 3(a) shows QDM vector magnetic ﬁeld images
measured on the decapsulated FPGA for clusters of
N = 200 ROs in two of the predeﬁned regions indi-
cated in the Vivado ﬂoor planner, labeled R1 and R2 in
Fig. 2(c). The vector magnetic ﬁeld images are derived
from CW ODMR measurements using Eqns. 6 and 7.
Observed maximum magnetic ﬁelds are on the order
of ∼ 15 µT with a noise ﬂoor of ∼ 20 nT (see Supple-
mental Material [32]). Spatial variation of the magnetic
ﬁeld is located on the right of the ﬁeld-of-view for R1
and on the left for R2. This localization corresponds to
the positions of R1 and R2 on the Vivado ﬂoor planner,
indicating that high current densities for power distri-
bution are concentrated to the region of activity on the
die. The vector magnetic ﬁeld measured in the idle state
with 0 ROs, shown in the bottom row of Fig. 3(a), re-
veals the structure of the ball grid array (BGA) that
connects the FPGA to the Digilent board. The state
dependent magnetic ﬁelds due to the RO current den-
sities (see Eqn. 7) are thus measured in superposition
with the spatially inhomogeneous ﬁeld resulting from
the BGA.

The presence of a non-zero BY component in R1 and
R2, as seen in Fig. 3(a) indicates contributions to the

6

FIG. 3.
(a) QDM vector magnetic ﬁeld maps of the decapped FPGA for diﬀerent RO clusters activated in regions, R1 and
R2. The location of the 3.7 mm × 3.7 mm diamond ﬁeld-of-view is ﬁxed on the FPGA for all magnetic ﬁeld images (see
Fig. 2(c)). State dependent magnetic ﬁeld changes (∆BX , ∆BY , ∆BZ ) are calculated by subtracting background idle magnetic
ﬁeld images from active magnetic ﬁeld images. Wires on the top metal layer are generally oriented in the Y direction yielding
prominent ∆BX and ∆BZ ﬁelds. ∆BY magnetic ﬁeld maps show contributions from deeper sources. Background magnetic
ﬁeld maps of the idle FPGA with 0 ROs show variations of the ﬁeld from the mean. Several diﬀerent background ﬁelds are
evident: a gradient from the bias magnet, distortion of the bias ﬁeld from the BGA, and background current delivery. (b) ∆BZ
for 200 ROs in R1 plotted in transparency over a high resolution optical image of circuit die. Regions of interest discussed in
the text are indicated by (i),(ii),(iii), and (iv).

magnetic ﬁeld from current density sources that run un-
derneath and perpendicular to the visible traces of the
top metal layer. These sources are likely a combination
of currents in the lower layers of the metal stack and
in the interconnects between the wirebonds and BGA
seen in the SEM image in Fig. 2(d). Discontinuities
present in the BX and BZ ﬁelds indicate a change of
the current direction guided by through-silicon vias in
the Z direction that connect the diﬀerent, stacked metal
layers. R3 and R4, seen in Fig. 2(c), are both outside
the measurement ﬁeld-of-view. However, in both cases,
state-dependent current is measured in locations corre-
sponding to the direction of current ﬂow in the appropri-
ate location on the die (see Supplemental Information
[32]). This demonstrates the possibility to determine
circuit activity outside of the diamond periphery by ob-
serving correlated magnetic ﬁelds within the nominal
ﬁeld-of-view.

An optical image of the die through the diamond is
used to spatially align the magnetic ﬁeld measurement
with the high resolution optical images taken of the de-
capsulated chip. Spatial variation of the BX and BZ
magnetic ﬁeld components corresponds well with the

physical features of the top metal layer. Fig. 3(b) shows
a zoomed-in overlay of the BZ ﬁeld for 200 ROs in R1
with the optical image of the die, demonstrating fea-
ture alignment. Distinct features are visible in the ﬁelds
that correspond to physical structures, including bends
in the wires labeled (i) and (ii) in the ﬁgure. Some fea-
tures in the magnetic ﬁeld map do not correspond to
any visible features on the top metal layer, such as the
magnetic trace indicated by (iii) or the discontinuity in
ﬁeld direction indicated by (iv). These ﬁelds suggest
the presence of additional current routing by vias and
other structures below the plane of the top metal layer.

B. Single NV-Axis Magnetic Imaging

Single NV-Axis QDM measurements [15] are used to
collect a large data set of magnetic ﬁeld images from RO
clusters for classiﬁcation. These data are taken by moni-
toring the outermost ODMR spectral features (f−,1 and
f+,1) with the same bias ﬁeld in the lab frame, and the
laser polarization and MWs optimized for the NV axis
being monitored to improve measurement contrast [15].

-10010-10010-50050Region 1Active200 ROsRegion 2Active200 ROsXYFPGA IdleBackground0 ROsΔBX (μT)ΔBY (μT)ΔBZ (μT)Region 1 Active, ΔBZ Overlay(i)(ii)(iii)(iv)1 mm1 mm(b)(a)QDM Magnetic Images of Decapped FPGABX (μT)BY (μT)BZ (μT)Projection imaging is useful for large data acquisition
due to the speedup in measurement time; however, the
vector nature of the ﬁeld is not captured. The laser
polarization and MWs are optimized for the single NV
axis being monitored. Measuring only a single pair of
resonance features results in a ∼ 4× speed up by reduc-
ing the number of swept MW frequencies by a factor of
four.

Fig. 4(a) shows example projection magnetic ﬁeld im-
ages, averaged over ten measurements, for 5, 50 and
200 ROs in regions 1 and 2 for the decapsulated FPGA
and the intact FPGA. Magnetic ﬁelds are generally re-
duced with diminishing numbers of ROs, due to the
smaller current densities required for power distribu-
tion to smaller clusters. The maximum ﬁeld amplitude
is found not to scale linearly with number of ROs due
to the currents being distributed over a diﬀering num-
ber of wires on the top metal layer. The ∼ 200 nT
magnetic ﬁeld arising from a single RO is detectable for
the decapsulated chip, Fig. 4(b), given the experimental
noise ﬂoor of 20 nT (see Supplemental Material [32]).
The overlay of the measured magnetic ﬁeld and the top
metal layer illustrates potential location of vias where
current is routed to deeper metal layers.

Magnetic ﬁelds measured for the intact chip are de-
creased in magnitude and have lower intrinsic spatial
resolution due to the large stand-oﬀ distance, compared
to the decapsulated chip. The suppression of higher
spatial frequency signals at large stand-oﬀ distances al-
lows for more aggressive binning and spatial ﬁltering
of the intact data, without sacriﬁcing spatial resolution
and ﬁeld information (see Supplemental Material [32]).
This approach enables a lower noise ﬂoor of 2 nT for the
intact chip data, which partially overcomes the reduc-
tion of ﬁeld amplitude with distance. For some regions
of the ﬁeld-of-view the noise ﬂoor is limited by state-
independent variation in the magnetic ﬁeld (See Sup-
plemental Material [32]) likely due to long-time power
instability of the board. In order to enhance sensitiv-
ity and push the speed at which measurements can be
taken, diamonds with thicker NV layers can be utilized
at the cost of spatial resolution (see Supplemental In-
formation [32]). Such methodology may be especially
beneﬁcial when performing intact measurements, where
the spatial resolution is already limited by the package
stand-oﬀ distance.

The dependence of current on the RO cluster size
leads to state dependent temperature changes of the
FPGA, which are determined from NV ODMR mea-
surements using Eqn. 6 Due to the high thermal conduc-
tivity of the diamond chip, there is no spatial structure
in the resultant temperature maps. However, from tem-
perature measurements over the entire ﬁeld-of-view, we
are able to determine a scaling of ∼ .0075◦C per active
ring oscillator (see Supplemental Material [32]); with a
temperature increase of ∼ 1.5◦C for the 200 RO state.

7

C. Magnetic Field Source Interpretation

The QDM magnetic ﬁeld images shown in Figs. 3
and 4 result from current density sources located at
various depths in the decapped and intact FPGA. Cur-
rent is distributed in the interconnect layers of the sil-
icon die and the package substrate. Each layer acts as
a quasi two-dimensional current source contributing to
the overall magnetic ﬁeld detected by the NVs. The
stand-oﬀ distance between the NV sensing plane and
the current sources determines which metal layer domi-
nates the ﬁeld measurement. Generally, small wire fea-
tures close to the sensing plane will dominate for small
stand-oﬀ distance and large wire features far from the
sensing plane will dominate for large stand-oﬀ distances.
For example, the 21 µm wide wires of the top metal
layer contribute to the measured ∆BX and ∆BZ ﬁelds
in the QDM images of the decapped FPGA, as seen
by the spatial features of the ﬁelds in Fig. 3. Topside
decapsulation removes the 500 µm of epoxy packaging
above the die shown in the SEM in Fig. 2(e). This
results in a 5 − 10 µm stand-oﬀ distance between the
top metal layer and the NV sensing plane which is suf-
ﬁciently small to resolve the spatial variation of ﬁelds
resulting from currents in the top metal layer. Fields
from smaller wires in the metal stacks below the top
metal layer are too distant to contribute signiﬁcantly to
the measured ﬁeld.

The measured magnetic ﬁeld distributions for both
the decapsulated and intact chips include contributions
from large current sources far from the NV sensing
plane. These sources consist primarily of the metal lay-
ers of the 400 µm thick package substrate. The 300 µm
silicon die separates the NV layer from the top of the
package substrate for the decapsulated chip. An addi-
tional separation of ∼500 µm due to the epoxy gives a
total stand-oﬀ distance of about 800 µm for the intact
chip. These large current sources result in the broad fea-
tures of the measured ∆BY data for the decapsulated
chip in Fig. 3(a), and of the measured ∆Bz,1 for the
intact chip in Fig. 4(a). The dominant contribution of
the substrate layers explains diﬀerences in the measured
ﬁelds of the intact chip compared to those of the decap-
sulated chip, even when the latter are low pass ﬁltered
to account for the diﬀerence in measurement stand-oﬀ.
Comparison of the measured data with ﬁnite element
analysis (FEA) simulations support the interpretation
of the data as resulting from contributions of current
sources in diﬀerent layers at diﬀerent depths from the
NV plane. The FEA model, constructed in COMSOL
Multiphysics, consists of 21.6 µm wires in the top metal
layer with inter-wire spacing of 12.7 µm, and 100 µm
thick metal wires in the package substrate layer with
inter-wire spacing of 100 µm. An inter-layer separation
of 300 µm represents the thickness of the silicon die.
A current of ∼10 mA is applied to the wires in each
layer with alternating bias to approximate the current
of 200 active ROs. Plots of BZ for planes at 25 µm
and a 500 µm above the top metal layer are given (see

8

FIG. 4.
(a) QDM magnetic images indicate sensitivity to changing the number of ROs in diﬀerent regions for the decapsulated
and intact chip when performing overlapped measurements. Diﬀerent scale bars are used for feature clarity. (b) Decapsulated
QDM data of ∆Bz,1 for a single active RO in Region 1, demonstrating measurement sensitivity to the magnetic ﬁeld from
current supplying 1 RO. Inset: Overlay of the magniﬁed single RO magnetic ﬁeld image with a high resolution optical image
of the circuit die. Each image is the average of 10 QDM (nominally identical) measurements.

Supplemental Material [32]) for comparison with the
NV measurements at the nominal stand-oﬀ distances for
decapsulated and intact chips respectively. The spatial
features of the small wires are only evident in the BZ
ﬁeld of the plane with small stand-oﬀ, whereas the con-
tribution of the large wires dominates at large stand-oﬀ
distances.

The measurements presented in Figs. 3 and 4 are the
net static magnetic ﬁelds resulting from steady-state
RO operation in the FPGA. The static ﬁelds are inter-
preted to result from a time-averaged superposition of
dynamic current draws from the top metal layer to the
transistor level. The ROs used for this experiment each
consist of three CMOS inverters that sequentially switch
state during RO operation. A small, short-circuit cur-
rent spike occurs in every inverter that switches state
(due to simultaneous conduction through the two tran-
sistors of the inverter inducing a transient current path
from supply voltage to ground). However, the individ-
ual switching of the inverters in the ROs is not tempo-
rally synchronized, resulting in a time-averaged, steady-
state current draw from the top metal layer, and a con-

sequently measurable static magnetic ﬁeld (see Supple-
mental Material [32]).

IV. ANALYSIS

Forward modeling of the current distributions and re-
sulting magnetic ﬁelds for the diﬀerent RO states pro-
grammed on the FPGA is an intractable problem with-
out complete knowledge of the wire layout and current
paths.
Interpretation of the QDM measurements by
comparison with forward-model simulations is therefore
limited to the arguments such as those presented in the
previous section. However, automated machine learn-
ing (ML) algorithms can be applied to the QDM data
to discriminate between and ultimately classify the dif-
ferent operating states. Ideally, a magnetic ﬁeld image
is used as input to an ML algorithm, and the number of
ROs is determined as the output. In practice, this prob-
lem is approached with a limited data set of magnetic
ﬁeld images for each FPGA state; and a dimension-
ality reduction algorithm is employed before applying

-0.500.5-202-10010-0.500.5-202-10010-0.100.1-0.200.20.4012-0.100.1-0.200.20.4012ΔBz,1 (μT)5 ROs50 ROs200 ROsRegion 1 ActiveDecapRegion 1ActiveIntactRegion 2ActiveDecapRegion 2ActiveIntact1 mmXYΔBz,1 (μT)ΔBz,1 (μT)ΔBz,1 (μT)ΔBz,1 (μT)-0.2-0.100.10.2Region 1 Active, 1 RO, Decap1 mm(a)(b)0.2 mmQDM Magnetic Images9

FIG. 5. Principal component analysis (PCA) and support vector machine (SVM) classiﬁcation of QDM images. Region 1 is
active with 0, 1, 5, 10, 50, 100, or 200 ring oscillators (ROs). (a) Example principal component (PC) basis vectors plotted as
images for both decapsulated (decap) and intact data sets. PC1 and PC2 are shown to exemplify PCs that resemble magnetic
ﬁeld images and thus will be useful in chip state classiﬁcation. PC4 is shown as an example PC that captures activity state
independent variations and thus will not be useful in chip state classiﬁcation. (b) The PCA score for PC1, S1,j, is plotted
against the score for PC2, S2,j, for each magnetic ﬁeld image, Bj, as a demonstration of state distinguishability . This
distinguishability is evidenced by the separation of colors representing diﬀering numbers of active ROs. Insets magnify the
scores for small numbers of ROs, and show greater ﬁdelity of state separation in the decapsulated data set compared to the
intact data set. (c) Table of SVM predictions on the test set for the intact images. For each unique value of active ROs, there
are 12 images in the test set. Rows indicate the fraction of images predicted for each of the possible chip states. All but
one prediction (indicated by the red boxes in (b) and (c)) lie on or near the main diagonal demonstrating the high predictive
power of the SVM classiﬁer. The corresponding table for the decapsulated data set is not shown, as the main diagonal would
contain 1’s and the oﬀ diagonals would contain 0’s due to the perfect separability of each state (see Table I).

a classiﬁcation technique using the Python[35] package
scikit-learn[36].

A. Data Preprocessing

QDM data undergoes a series of preprocessing steps
in preparation for dimensionality reduction and classi-
ﬁcation. Only images with Region 1 active are used so
that the number of ROs is predicted by the classiﬁcation
scheme. The number of ROs activated for any given im-

age is one of 0, 1, 5, 10, 50, 100, or 200. The data set
consists of 40 QDM images per RO state for the decap-
sulated chip and 32 images per RO state for the intact
chip. These M ×N images are subsequently binned such
that the decapsulated images contain 600 × 606 pixels
and the intact images contain 300 × 303 pixels, while
covering the same ﬁeld-of-view. Measurements of the
idle state (0 ROs) are randomly taken during data col-
lection to account for long term drifts. These idle state
measurements are subtracted from active state images
nearest in time. The intact and decapsulated data sets

DecapIntact0151050100200Active ROsS 2, j (nT / pixel)S 1, j (nT / pixel)-0.20.0-0.10.0-0.9-0.8-0.4-0.6-10123-0.40.40.4-0.4-10123(a)(b)(c)Intact DecapPC1PC2PC4Intact Test DatasetPrediction Fraction per Chip StateSVM Predicted ROsActive ROs on Chip01510501002000151050100200Principal Component Basis Vectorsare split into training and test sets so that the predic-
tion accuracy of the trained model can be estimated on
data that the training procedure has not encountered.
The splits are 75%/25% for the decapsulated images
and 64%/36% for the intact images.

B. QDM Image Dimensionality Reduction

Each magnetic ﬁeld image is composed of ∼ 105 pixels
and thus occupy a high dimensional space for classiﬁ-
cation. Principal component analysis [37, 38] (PCA) is
therefore used to reduce the dimensionality of the clas-
siﬁcation problem. PCA is a well-established technique
that determines the highest variability axes of a high-
dimensional data set. PCA amounts to an eigenanaly-
sis where the eigenvectors, called principal components
(PC), correspond to the axes of interest; and the eigen-
values relate to the amount of data variance along the
respective PCs.

PCA is applied separately to the data sets of
the decapsulated chip and the intact chip with the
scikit-learn class decomposition.PCA() and yields
PCs such as those plotted in Fig. 5(a). Spatial patterns
evident in the PCs are also present in the magnetic ﬁeld
images of Fig. 4(a), conﬁrming that these features are
physically signiﬁcant and important for distinguishing
between diﬀerent samples. There exist as many PCs
as dimensions in the data set; however, only the ﬁrst
several PCs capture non-noise based information (see
Supplemental Material [32]). We determine that >99%
of the variance in the intact and decapsulated data sets
is captured by the ﬁrst 9 PCs, which are therefore the
only PCs used in this analysis.

The scores of these ﬁrst 9 PCs are used to eﬀectively
reduce the dimensionality of the magnetic ﬁeld images
from ∼ 105 pixels to 9 scores. The PC scores, Si,j, are
determined by taking the dot product of the ith PC,
deﬁned as Wi, with the jth image, Bj, and normalized
by the total number of pixels. This gives

Si,j =

1
M N

M
(cid:88)

N
(cid:88)

m=1

n=1

W i

m,nBj

m,n

(8)

for the ﬁrst 9 PCs. Fig. 5(b) shows examples of the
PCA scores: the score for PC1 is plotted against the
score for PC2 for each magnetic ﬁeld image of both
the decapsulated and intact data (additional principal
components and score plots are given in Supplemental
Material [32]). The plot is color coded by number of
active ROs showing that these two scores are useful in
distinguishing the number of active ROs on the FPGA
for both decapsulated and intact measurements. Classi-
ﬁcation of the active number of ROs is accomplished by
using the ﬁrst 9 PCA scores as input to a support vec-
tor machine (SVM) classiﬁer algorithm. The spread of
data points along a ﬁxed slope for each state in Fig. 5(b)
is consistent with small oﬀsets between diﬀerent image
acquisitions (see Supplemental Material [32]).

10

Number of ROs (Region 1)
10

1

0

5
Decapsulated 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00
0.83 0.75 0.83 0.83 1.00 1.00 1.00 0.89

50 100 200

Intact

Total

TABLE I. Chip state prediction accuracy on the test dataset.

C.

IC Activity State Classiﬁcation

A support vector machine [39] (SVM) is the super-
vised classiﬁcation technique used to classify the mag-
netic ﬁeld images, leveraging their key features charac-
terized by the PCA scores. SVMs are a set of algorithms
that seek to classify samples by creating a boundary be-
tween categories of a training data set that maximizes
the gap separating those categories. Samples from a
test set are then classiﬁed in relation to this boundary.
The scikit-learn class svm.SVC() is used as a
multi-dimension, multi-category classiﬁer. The cate-
gories for classiﬁcation are the chip states given by the
number of ROs. The dimensionality is given by the 9
PCA scores recorded for each image. PCA scores are
ﬁt to the known FPGA states with a linear SVM model
and a regularization parameter of C = 6 (see Supple-
mental material [32]).

D. Classiﬁcation Results

The full ML model, including preprocessing, PCA,
and SVM, is ﬁt using the training set and subsequently
evaluated on the test set, for both decapped and intact
FPGA data. A prior step of cross-validating the model
hyperparameters is taken for the intact FPGA data set
(Supplemental material [32]). The ML model eﬃcacy,
summarized in Table I, is determined by the accuracy
of the test set evaluations. FPGA activity states are
well separated in PCA-space for the decapsulated data
set. Predictions on the test set consequently yield per-
fect accuracy, even for small numbers of ROs, consistent
with expectations (Supplemental material [32]).

Results for intact data set are similarly well separated
for large numbers of ROs, resulting in perfect prediction
accuracy for ≥50 ROs. However, FPGA activity states
are not fully separated for <50 ROs, resulting in im-
perfect predictions. Nonetheless, the trained ML model
achieves ∼ 80% accuracy for each of 0, 1, 5, and 10 RO
active states. Fig. 5(c) additionally shows that incor-
rect predictions are nearly always close to the correct
state. For example, the model predicts 5 ROs correctly
in 83% of test cases, with misclassiﬁcations of 0 or 1
RO otherwise. The red box in Fig. 5(c) indicates a sin-
gle case for which the classiﬁer incorrectly predicts 50
ROs for a 0 RO state. An arrow and analogous red box
in Fig. 5(b) shows that the PCA score for this state
is an outlier in the data. The positive classiﬁcation re-
sults presented in Fig. 5 give an initial demonstration of
the capability of ML techniques to identify chip activity

via non-invasive measurements with the QDM. Larger
data sets populating ML methods have promise to en-
able classiﬁcation of a wide array of chip activity in the
context of hardware security and fault detection.

V. OUTLOOK

We present the ﬁrst demonstration of NV diamond
imaging of the static (DC) magnetic ﬁeld emanations
from an FPGA. The ensemble NV measurement tech-
nique of the Quantum Diamond Microscope (QDM)
yields simultaneous wide ﬁeld-of-view (few mm) with
high resolution (∼ 10µm) vector magnetic ﬁeld images,
which is not achievable using other techniques. We fur-
ther demonstrate that these images can be used with
machine learning (ML) techniques to quantiﬁably de-
termine the active state of the FPGA integrated circuit
(IC), for both decapsulated and intact chips. The ﬁ-
delity of classiﬁcation is dependent on the activity level
and stand-oﬀ distance between the circuit currents and
the measurement plane. Our results show conclusively
that it is possible to use static magnetic ﬁeld measure-
ments to identify targeted, active states on an FPGA
without requiring time domain data.

QDM magnetic imaging of ICs has signiﬁcant poten-
tial to augment state-of-the-art diagnostic techniques
in areas ranging from fault detection, Trojan detection,
counterfeit detection, watermarking, and electromag-
netic side channel characterization. We show that pat-
terns of DC magnetic ﬁelds from the power distribution
network of an IC are a powerful indicator of chip ac-
tivity. The simultaneous wide-ﬁeld and high-resolution
magnetic imaging provide by the QDM may further en-
able detection of correlated spatial and temporal (e.g.,
transient) events over sequential measurements that is
not possible with scanning magnetometry techniques.

Technical improvements enabling faster QDM mea-
surements [14, 40] will be implemented in future work
for extended data collection and further analysis tech-
niques. Larger data sets will also allow for leveraging

11

the full power of convolutional neural networks for ad-
vanced state classiﬁcation. Further time-resolved mea-
surements will also allow for separation of magnetic
ﬁelds by temporal or frequency proﬁles. It is possible
such measurements could be used to resolve the mag-
netic ﬁelds speciﬁc to adjacent circuitry, for example
from clock and power distribution networks as well as
gate level activity, proving further indication of chip ac-
tivity. The unique capabilities of NV diamond magnetic
ﬁeld imaging show great promise for integrated circuit
applications and will be increasingly leveraged with on-
going development.

ACKNOWLEDGMENTS

We thank Ben Le for FPGA development; Adam
Woodbury, Jeﬀ Hamalainen, Maitreyi Ashok, Connor
Hart, David Phillips, Greg Lin, CNS staﬀ, Rebecca
Cheng, and Amirhassan Shams-Ansari for helpful dis-
cussions and support; Raisa Trubko and Roger Fu for
assistance on early measurements; Patrick Scheidegger
and Raisa Trubko for work applying GPUﬁt to the
analysis; Edward Soucy, Brett Graham, and the Har-
vard Center for Brain Science for technical support and
fabrication assistance. This project was fully funded
by the MITRE Corporation through the MITRE Inno-
vation Program. P.K. acknowledges support from the
Sandia National Laboratories Truman Fellowship Pro-
gram, which is funded by the Laboratory Directed Re-
search and Development (LDRD) Program at Sandia
National Laboratories. NV-diamond sensitivity opti-
mization pertinent to this work was developed under the
DARPA DRINQS program (award D18AC00033). This
work was performed in part at the Center for Nanoscale
Systems (CNS), a member of the National Nanotechnol-
ogy Coordinated Infrastructure Network (NNCI), which
is supported by the National Science Foundation under
NSF award no. 1541959. CNS is part of Harvard Uni-
versity.

[1] M. Rostami, F. Koushanfar, and R. Karri, Proceedings

ity 54, 2093 (2014).

of the IEEE 102, 1283 (2014).

[8] Y. Tagro, J. J. Yan, D. F. Kimball, H. Ghajari, and

[2] M. Tehranipoor, H. Salmani, X. Zhang, M. Wang,
R. Karri, J. Rajendran, and K. Rosenfeld, Computer
44, 66 (2010).

[3] Semiconductor Industry Association, SIA Whitepaper,

Washington DC (2013).

[4] P. Hoeper and J. Manferdelli, Defense Science Board

Washington DC USA (2017).

[5] U. Guin, K. Huang, D. DiMase, J. M. Carulli, M. Tehra-
nipoor, and Y. Makris, Proceedings of the IEEE 102,
1207 (2014).

[6] J. Balasch, B. Gierlichs,

and I. Verbauwhede, 2015
IEEE International Symposium on Electromagnetic
Compatibility (EMC) , 246 (2015).

[7] J. Gaudestad and A. Orozco, Microelectronics Reliabil-

D. F. Sievenpiper (2017).

[9] A. Orozco, Magnetic Field Imaging for Electrical Fault

Isolation (2019).

[10] A. N. Campbell, E. Cole, B. A. Dodd, and R. E. Ander-
son, 31st Annual Proceedings Reliability Physics 1993 ,
168 (1993).

[11] H. H. Huston and C. P. Clarke, 30th Annual Proceed-

ings Reliability Physics 1992 , 268 (1992).
[12] Semiconductor Industry Association, (2017).
[13] B. J. Roth, N. G. Sepulveda, and J. P. Wikswo, Journal

of Applied Physics 65, 361 (1989).

[14] E. V. Levine, M. J. Turner, P. Kehayias, C. A. Hart,
N. Langellier, R. Trubko, D. R. Glenn, R. R. Fu, and
R. L. Walsworth, Nanophotonics 8, 1945 (2019).

[15] D. R. Glenn, R. R. Fu, P. Kehayias, D. Le Sage, E. A.
Lima, B. P. Weiss, and R. L. Walsworth, Geochemistry,
Geophysics, Geosystems 18, 3254 (2017).

[16] J. Taylor, P. Cappellaro, L. Childress, L. Jiang, D. Bud-
and

ker, P. Hemmer, A. Yacoby, R. Walsworth,
M. Lukin, Nature Physics 4, 810 (2008).

[17] L. M. Pham, D. Le Sage, P. L. Stanwix, T. K. Yeung,
D. Glenn, A. Trifonov, P. Cappellaro, P. R. Hemmer,
M. D. Lukin, H. Park, A. Yacoby, and R. L. Walsworth,
New Journal of Physics 13, 045021 (2011).

[18] M. J. H. Ku, T. X. Zhou, Q. Li, Y. J. Shin, J. K. Shi,
C. Burch, H. Zhang, F. Casola, T. Taniguchi, K. Watan-
abe, P. Kim, A. Yacoby, and R. L. Walsworth, (2019),
arXiv:1905.10791.

[19] J. F. Barry, M. J. Turner, J. M. Schloss, D. R. Glenn,
Y. Song, M. D. Lukin, H. Park, and R. L. Walsworth,
Proceedings of the National Academy of Sciences 113,
14133 (2016).

[20] A. Nowodzinski, M. Chipaux, L. Toraille, V. Jacques,
J.-F. Roch, and T. Debuisschert, Microelectronics Re-
liability 55, 1549 (2015).

[21] D. A. Simpson, J.-P. Tetienne, J. McCoey, K. Ganesan,
L. T. Hall, S. Petrou, R. E. Scholten, and L. C. L.
Hollenberg, Scientiﬁc Reports 6, 22797 (2016).

[22] D. Le Sage, K. Arai, D. R. Glenn, S. J. DeVience,
L. M. Pham, L. Rahn-Lee, M. D. Lukin, A. Yacoby,
A. Komeili, and R. L. Walsworth, Nature 496, 486
(2013).

[23] R. R. Fu, B. P. Weiss, E. A. Lima, R. J. Harrison, X.-
N. Bai, S. J. Desch, D. S. Ebel, C. Suavet, H. Wang,
D. Glenn, D. Le Sage, T. Kasama, R. L. Walsworth,
and A. T. Kuan, Science 346, 1089 (2014).

[24] E. De Mulder, PhD Thesis (2010).
[25] L. Sauvage, S. Guilley, and Y. Mathieu, ACM Trans-
actions on Reconﬁgurable Technology and Systems
(TRETS) 2, 4 (2009).

[26] A. Horsley, G.-X. Du, and P. Treutlein, New Journal

of Physics 17, 112002 (2015).

[27] J. M. Schloss, J. F. Barry, M. J. Turner, and R. L.

12

Walsworth, Phys. Rev. Applied 10, 034044 (2018).
[28] M. W. Doherty, N. B. Manson, P. Delaney, F. Jelezko,
J. Wrachtrup, and L. C. L. Hollenberg, Physics Reports
528, 1 (2013).

[29] P. Kehayias, M. J. Turner, R. Trubko, J. M. Schloss,
and R. L.

C. A. Hart, M. Wesson, D. R. Glenn,
Walsworth, Phys. Rev. B 100, 174103 (2019).

[30] E. Bauch, C. A. Hart, J. M. Schloss, M. J. Turner, J. F.
Barry, P. Kehayias, S. Singh, and R. L. Walsworth,
Phys. Rev. X 8, 031025 (2018).

[31] X. Zhang and M. Tehranipoor, 2011 Design, Automa-

tion and Test in Europe , 1 (2011).

[32] Additional details are included in the supplemental ma-

terial.

[33] L. Shao, R. Liu, M. Zhang, A. V. Shneidman, X. Au-
dier, M. Markham, H. Dhillon, D. J. Twitchen, Y.-F.
Xiao, and M. Lonar, Advanced Optical Materials 4,
1075 (2016).

[34] A. Przybylski, B. Thiel, J. Keller-Findeisen, B. Stock,

and M. Bates, Scientiﬁc Reports 7 (2017).

[35] G. van Rossum, Python tutorial, Tech. Rep. CS-R9526
(Centrum voor Wiskunde en Informatica (CWI), Ams-
terdam, 1995).

[36] F. Pedregosa, G. Varoquaux, A. Gramfort, V. Michel,
B. Thirion, O. Grisel, M. Blondel, P. Prettenhofer,
R. Weiss, V. Dubourg, J. Vanderplas, A. Passos,
D. Cournapeau, M. Brucher, M. Perrot, and E. Duch-
esnay, Journal of Machine Learning Research 12, 2825
(2011).

[37] K. P. F.R.S., The London, Edinburgh, and Dublin
Philosophical Magazine and Journal of Science 2, 559
(1901).

[38] H. Hotelling, Biometrika 28, 321 (1936).
[39] C. Cortes and V. Vapnik, Machine Learning 20, 273

(1995).

[40] J. F. Barry, J. M. Schloss, E. Bauch, M. J. Turner, C. A.
Hart, L. M. Pham, and R. L. Walsworth, Rev. Mod.
Phys. 92, 015004 (2020).

