1
2
0
2

t
c
O
9
1

]
h
p
-
t
n
a
u
q
[

1
v
3
9
7
9
0
.
0
1
1
2
:
v
i
X
r
a

Toward Reliability in the NISQ Era: Robust Interval Guarantee for Quantum
Measurements on Approximate States

Maurice Weber,1 Abhinav Anand,2 Alba Cervera-Lierta,2, 3 Jakob S. Kottmann,2, 3 Thi
Ha Kyaw,2, 3 Bo Li,4 Alán Aspuru-Guzik,2, 3, 5, 6, ∗ Ce Zhang,1, † and Zhikuan Zhao1, ‡
1Department of Computer Science, ETH Zürich, Universitätstrasse 6, 8092 Zürich, Switzerland
2Chemical Physics Theory Group, Department of Chemistry, University of Toronto, Canada.
3Department of Computer Science, University of Toronto, Canada.
4Department of Computer Science, University of Illinois, Urbana, Illinois 61801, USA
5Vector Institute for Artiﬁcial Intelligence, Toronto, Canada.
6Canadian Institute for Advanced Research (CIFAR) Lebovic Fellow, Toronto, Canada

Quantum computation in noisy, near-term implementations holds promise across multiple domains
ranging from chemistry and many-body physics to machine learning, optimization, and ﬁnance.
However, experimental and algorithmic shortcomings such as noise and decoherence lead to the
preparation of imperfect states which diﬀer from the ideal state and hence lead to faulty measurement
outcomes, ultimately undermining the reliability of near-term quantum algorithms. It is thus crucial
to accurately quantify and bound these errors via intervals which are guaranteed to contain the ideal
measurement outcomes. To address this desire, based on the formulation as a semideﬁnite program,
we derive such robustness intervals for the expectation values of quantum observables using only
their ﬁrst moment and the ﬁdelity to the ideal state. In addition, to get tighter bounds, we take into
account second moments and extend bounds for pure states based on the non-negativity of Gram
matrices to mixed states, thus enabling their applicability in the NISQ era where noisy scenarios are
prevalent. Finally, we demonstrate our results in the context of the variational quantum eigensolver
(VQE) on noisy and noiseless simulations.

I.

INTRODUCTION

Today’s quantum computers are characterized by a low
count of noisy qubits performing imperfect operations in
a limited coherence time. In this era of quantum com-
puting, the noisy intermediate-scale quantum (NISQ) era
[1], researchers and practitioners alike strive to heuristi-
cally harness limited quantum resources in order to solve
classically diﬃcult problems and also to benchmark and
potentially develop new quantum subroutines. A typical
pattern of these NISQ algorithms [2], exempliﬁed by the
seminal variational quantum eigensolver (VQE) [3] and
quantum approximate optimization algorithm (QAOA)
[4], consists of the preparation of ansatz states with a
parameterized unitary circuit followed by useful classical
output being extracted by means of quantum measure-
ments, more generally as expectation value of quantum
observables through repeated measurements.

The promising potential of these NISQ algorithms
spans across a wide spectrum of applications, ranging
from quantum chemistry, many-body physics, and ma-
chine learning to optimization and ﬁnance [2]. However,
as a consequence of their heuristic nature and the preva-
lent imperfections in near-term implementation, it is dif-
ﬁcult to guarantee the degree of validity of the output.
This unfortunate hindrance practically arises from vari-
ous sources such as circuit noise and decoherence [1], lim-

∗ aspuru@utoronto.ca
† ce.zhang@inf.ethz.ch
‡ zhikuan.zhao@inf.ethz.ch

ited expressibility of ansatze [5, 6], barren plateaus dur-
ing optimization in variational hybrid quantum-classical
algorithms [7–9], measurement noise and other experi-
mental imperfections [10, 11]. To determine the useful-
ness of a given NISQ application, it is thus crucial to
quantify the error on the ﬁnal output in the presence of
a multitude of the aforementioned sources of imperfec-
tion.

In this work, we endeavour to systematically certify the
reliability of quantum algorithms by deriving robustness
bounds for estimates of expectation values arising from
imperfect approximations of a target state. To that end,
based on analytical solutions to a semideﬁnite program
(SDP), we present lower and upper bounds to quantum
expectation values of observables which depend only on
the ﬁdelity with the target state and postprocessing of
In addition,
previously obtained measurement results.
to obtain tighter bounds, we take into account higher
moments of the observable by leveraging the Gramian
method for pure states [12] and extend it to derive bounds
which are valid for general density operators. This ex-
tension from pure to mixed states is particularly rele-
vant in the NISQ era as it allows to derive robustness
bounds which are valid in noisy scenarios. We then ap-
ply these bounds numerically and run noisy and noiseless
simulations of VQE for ﬁnding ground state energies of
electronic structure Hamiltonians of several molecules.
Finally, we implement our results in the open source
Tequila [13] library.

The remainder of the paper is organised as fol-
lows.
In Sec. II, we present our main results, namely,
the bounds based on SDP and the Gramian method.
In Sec. III, we present our numerical simulations and

 
 
 
 
 
 
explain the applicability of our bounds in the con-
text of VQE. Sec. III B highlights the implementation
in Tequila and concluding remarks are given in Sec. IV.

II. ROBUSTNESS INTERVALS

In this section, we present our main results, namely
robustness intervals for quantum expectation values of
observables. We ﬁrst introduce the notation, summarize
the technical results, and then proceed with presenting
the robustness intervals.

A. Notation

The Hilbert space corresponding to the quantum sys-
tem of interest is denoted by H ≡ Cd with dimension
d = 2n. We use the Dirac notation for quantum states,
i.e. elements of H are written as kets ∣ψ⟩ ∈ H with the
dual written as a bra ⟨ψ∣. The space of linear operators
acting on elements of H is denoted by L(H) and elements
thereof are written in capital letters A ∈ L(H). The set
of density operators on H is written as S(H) ⊂ L(H) and
lower case greek letters are used to denote its elements
σ ∈ S(H) which are positive semideﬁnite and have trace
equal to 1. For an element A ∈ L(H) we write A ≥ 0 if
it is positive semideﬁnite, AT stands for its transpose,
and A† is the adjoint. Expectation values of observ-
ables, i.e. Hermitian operators A ∈ L(H), are written
as ⟨A⟩σ = Tr[Aσ] for some σ ∈ S(H). The variance of an
2
σ. We write
observable is given by (∆Aσ)
⟩σ − ⟨A⟩
A†A for the trace norm of an
∥A∥1 = Tr[∣A∣] with ∣A∣ =
operator A ∈ L(H). The ﬁdelity between quantum states
2
σ, ρ ∈ S(H) is deﬁned as F(ρ, σ) = maxψρ, ψσ ∣⟨ψρ∣ψσ⟩∣
where the maximum is taken over all puriﬁcations of ρ
and σ. For pure states, the ﬁdelity reduces to the squared
2. Finally, the real part
overlap F(∣ψ⟩⟨ψ∣, ∣φ⟩⟨φ∣) = ∣⟨ψ∣φ⟩∣
of a complex number z ∈ C is written as R(z) and the
imaginary part as I(z).

= ⟨A2

√

2

2

FIG. 1. Bond dissociation curves and robustness interval
(RI) for Lithium Hydride in a basis-set-free approach [14, 15].
The exact, theoretical energies are shown in black, the en-
ergy estimates provided by a noisy VQE with an UpCCGSD
Ansatz [16] is shown in blue. The robustness interval is guar-
anteed to contain the true ground state energy and is based on
the Gramian eigenvalue bounds for mixed states (Theorem 3).

which relates the ﬁdelity between two mixed states to
the trace norm, we extend these results to mixed states.
This ultimately justiﬁes their applicability in the current
NISQ era, where the assumption of a closed quantum sys-
tem is violated and one needs to make use of the density
operator formalism to accurately model these states and
their evolutions.

In Table I, we summarize all the results, together with
the conditions under which they apply and the quantities
that are covered. Fig. 1 shows the ground state energies of
molecular Lithium Hydride in the basis-set-free approach
of Refs. [14, 15] with energy estimates provided by VQE
with an UpCCGSD ansatz. The lower and upper bounds
on the true energy are obtained via the Gramian method
from Theorem 3.

B. Summary of technical results

In this work, we present lower and upper bounds on
the true expectation value ⟨A⟩σ of an observable A under
a target state σ, in terms of an approximate state ρ. To
that end, we employ two diﬀerent techniques, each with
its advantages and disadvantages in terms of eﬃciency
and accuracy. The ﬁrst technique is based on the formu-
lation as an SDP and makes use of a closed form solution
of optimal type-II error probabilities from quantum hy-
pothesis testing [17]. The second technique is based on
the non-negativity of the determinant of Gramian ma-
trices for a suitable collection of vectors. This second
technique was initially proposed by Weinhold [12] in the
context of pure states. Using Uhlmann’s Theorem [18],

C. Bounds via semideﬁnite programming

We present a robustness interval which is based on a
formulation of the problem as a semideﬁnite program.
This interval only requires the knowledge of the ﬁrst mo-
ment of the operator A and a lower bound to the ﬁdelity
F(ρ, σ) between the target state σ and the approxima-
tion ρ. The idea is to deﬁne the problem as a semideﬁnite
program (SDP) and then, using results from quantum
hypothesis testing, derive a corresponding closed form
solution. This yields upper and lower bounds on the
true expectation ⟨A⟩σ which can be expressed in terms
of the ﬁdelity F(ρ, σ) and the expectation ⟨A⟩ρ under
the approximation ρ. We remark that, although used in
a diﬀerent context, this technique is conceptually similar
to the result presented in Theorem 1 of Ref. [17] for ad-

0.51.01.52.02.53.03.54.04.55.0Bond Distance (Å)8.07.87.67.47.27.0EnergyexactVQE (UpCCGSD)RI (Gramian Eigenvalue)SDP

Gramian

Lower Bound

Upper Bound

Assumptions

Expectation ⟨A⟩σ
√

(1 − 2(cid:15))⟨A⟩ρ − 2
(1 − 2(cid:15))⟨A⟩ρ + 2

√

(cid:15)(1 − (cid:15))(1 − ⟨A⟩2
ρ)
ρ)
(cid:15)(1 − (cid:15))(1 − ⟨A⟩2

−1 ≤ A ≤ 1

Expectation ⟨A⟩σ

(1 − 2(cid:15))⟨A⟩ρ − 2

√

(cid:15)(1 − (cid:15))∆Aρ + (cid:15)⟨A2⟩ρ
—
A ≥ 0

⟨A⟩ρ

3

Eigenvalue λ

⟨A⟩ρ − ∆Aρ
⟨A⟩ρ + ∆Aρ

√

√

(cid:15)
1−(cid:15)
(cid:15)
1−(cid:15)

σ = ∣ψ⟩⟨ψ∣ ∧ A∣ψ⟩ = λ∣ψ⟩

TABLE I. Overview of bounds for the expectation values and eigenvalues of an Hermitian operator A under a target state σ,
with ρ an approximation of σ. For the eigenvalue bound, σ = ∣ψ⟩⟨ψ∣ is the density operator corresponding to the eigenstate ∣ψ⟩
with eigenvalue λ = ⟨ψ∣A∣ψ⟩. We remark that the SDP lower and upper bounds are valid for ﬁdelities with F(ρ, σ) ≥ 1 − (cid:15) for
(1 − ⟨A⟩ρ), respectively. The Gramian lower bound for expectation values is valid for
(cid:15) ≥ 0 such that (cid:15) ≤ 1
2
1−(cid:15)/(cid:15) ≥ ∆Aρ/⟨A⟩ρ.
(cid:15) ≥ 0 with

(1 + ⟨A⟩ρ) and (cid:15) ≤ 1
2

√

versarial robustness of quantum classiﬁcation. Formally,
we present the following theorem:

Theorem 1. Let σ, ρ ∈ S(Hd) be density operators with
F(ρ, σ) ≥ 1 − (cid:15) for some (cid:15) ≥ 0. Let A be an observable
with −1 ≤ A ≤ 1 and with expectation value ⟨A⟩ρ under
1
ρ. For (cid:15) ≤
2 (1 + ⟨A⟩ρ), the lower bound of ⟨A⟩σ can be
expressed as

⟨A⟩σ ≥ (1 − 2(cid:15))⟨A⟩ρ − 2

√

(cid:15)(1 − (cid:15))(1 − ⟨A⟩2

ρ).

(1)

reason, one needs to rely on bounds which contain the
exact value with high probability. This can be accounted
for in the bounds from Theorem 1 by noting that they
are monotonic in ⟨A⟩ρ, whose exact value can thus be re-
placed by a corresponding lower or upper bound. Finally,
it is worth noting that, if one has access to an estimate
of the ﬁdelity, i.e. some (cid:15) > 0 with F(ρ, σ) ≥ 1 − (cid:15), this
interval can be calculated by merely postprocessing of
previous measurement results, and hence does not cause
any computational overhead.

Similarly, for (cid:15) ≤
becomes

1
2 (1 − ⟨A⟩ρ), the upper bound of ⟨A⟩σ

⟨A⟩σ ≤ (1 − 2(cid:15))⟨A⟩ρ + 2

√

(cid:15)(1 − (cid:15))(1 − ⟨A⟩2

ρ).

(2)

In a nutshell, this result is obtained by ﬁrst formulating
the problem as an SDP in which the quantity ⟨Λ⟩σ is
maximized (or minimized in case of the lower bound) over
all operators Λ with −1 ≤ Λ ≤ 1 and whose expectation
value is equal to ⟨Λ⟩ρ = ⟨A⟩ρ. Formally, the upper bound
can be expressed as

Λ {⟨Λ⟩σ∣ ⟨Λ⟩ρ = ⟨A⟩ρ, −1 ≤ Λ ≤ 1}
max

(3)

where for the lower bound the maximization is replaced
with a minimization. A closed form solution to these
SDPs can then be derived by expressing it in terms of
a binary quantum hypothesis testing problem. Thus,
Theorem 1 provides an interval which is guaranteed to
contain the true expectation value ⟨A⟩σ of an observable
A ∈ L(H) under a target state σ. In other words, it pro-
vides thresholds on the value of that expectation value
when only an approximation of the state σ, the state ρ,
is provided. Stemming from the formulation as an SDP,
these bounds are tight for pure states in the sense that,
for each bound, there exists an observable A with expec-
tation ⟨A⟩ρ and whose expectation under σ saturates the
bound. In Appendix A 2, we give a formal, constructive
proof for this statement. Furthermore, in practice, it is
typically not feasible to measure the exact expectation
value ⟨A⟩ρ due to ﬁnite sampling errors, measurement
noise, and other experimental imperfections. For this

D. Bounds via non-negativity of the Gramian

Here we employ a diﬀerent technique to derive robust-
ness bounds, taking into account the variance of the
observable as an additional piece of information. The
method is based on the non-negativity of the Gramian
and was pioneered by Weinhold [12]. We ﬁrst give a
brief overview of the Gramian method and then present
the extension to mixed states. This extension is impor-
tant as the restriction to pure states hinders the appli-
cability of this method in practice and, in particular, in
the current NISQ era, where one often has to deal with
noisy states that are expressed as probabilistic ensembles
of pure states in the density operator formalism.

1. Review of the Gramian method

Consider a Hermitian operator A ∈ L(H), a target
state ∣ψ⟩ and an approximation of this state ∣φ⟩. The
Gram matrix for the vectors ∣ψ⟩, ∣φ⟩, A∣φ⟩ is given by

G ≡

⎛
⎜
⎜
⎜
⎝

⟨ψ∣φ⟩
1
⟨φ∣ψ⟩
1
⟨φ∣A∣ψ⟩ ⟨φ∣A∣φ⟩ ⟨φ∣A2

⟨ψ∣A∣φ⟩
⎞
⎟
⟨φ∣A∣φ⟩
⎟
⎟
∣φ⟩
⎠

(4)

where, without loss of generality, it is assumed that the
ovelap ⟨ψ∣φ⟩ is real (otherwise multiply each state by a
global phase). Since Gram matrices are positive semidef-
inite (e.g., Theorem 7.2.10 in [19]), their determinants

are non-negative, det(G) ≥ 0. The function det(G) is a
quadratic polynomial in R(⟨ψ∣A∣φ⟩)

det(G) = −R(⟨ψ∣A∣φ⟩)

2

+ 2⟨A⟩φ⟨ψ∣φ⟩R(⟨ψ∣A∣φ⟩)
⟩φ − I(⟨ψ∣A∣φ⟩)

2
− ∣⟨φ∣ψ⟩∣

⟨A2

(5)

2

+ (∆Aφ)

2

2

2 is the variance of A
∣φ⟩ − ⟨φ∣A∣φ⟩
where (∆Aφ)
under ∣φ⟩. This polynomial vanishes when R(⟨ψ∣A∣φ⟩)
takes the values

= ⟨φ∣A2

√

⟨φ∣ψ⟩⟨A⟩φ ±

2
(∆Aφ)2(1 − ∣⟨φ∣ψ⟩∣

) − I(⟨ψ∣A∣φ⟩)2

(6)

and the non-negativity of G thus limits the permissi-
ble values of R(⟨ψ∣A∣φ⟩) to be within these boundaries.
Since I(⟨ψ∣A∣φ⟩)

2

≥ 0 we have the bounds
√

⟨φ∣ψ⟩⟨A⟩φ − ∆Aφ

2
1 − ∣⟨φ∣ψ⟩∣

≤ R(⟨ψ∣A∣φ⟩) ≤
√

(7)

≤ ⟨φ∣ψ⟩⟨A⟩φ + ∆Aφ

2
1 − ∣⟨φ∣ψ⟩∣

Starting from these inequalities and whithin this
Gramian approach, a bounds for expectation values
of quantum observables have been derived for pure
states [12, 20–26] and in the context of classical meth-
ods for quantum chemistry. While certainly useful, this
leaves a gap for these bounds to be applied in the NISQ
era where noise is prevalent and quantum states and their
evolutions are described by density operators. In the fol-
lowing section, we ﬁll this gap and extend this technique
to mixed states.

2. Gramian method for mixed states

In the NISQ era, it is essential to have bounds which
are valid for mixed states as these appear in noisy scenar-
ios. Here, we build on the Gramian method and derive
bounds which are valid for mixed states and which, in
contrast to Theorem 1, take into account the second mo-
ment of the observable of interest. In principle, as more
information is included, one can expect that this results
in a tighter bound at the cost of having to measure ad-
ditionally the expectation value of A2. The following
theorem provides a lower bound to expectation values of
non-negative observables:

Theorem 2 (Expectation values). Let σ, ρ ∈ S(Hd) be
density operators with F(ρ, σ) ≥ 1 − (cid:15) for some (cid:15) ≥ 0. Let
A ≥ 0 be an arbitrary observable with expectation value
√
⟨A⟩ρ under ρ. For (cid:15) with
(1 − (cid:15))/(cid:15) ≥ ∆Aρ/⟨A⟩ρ, the
lower bound of ⟨A⟩σ can be expressed as

⟨A⟩σ ≥ (1 − 2(cid:15))⟨A⟩ρ − 2

√

(cid:15)(1 − (cid:15))∆Aρ +

(cid:15)⟨A2
⟩ρ
⟨A⟩ρ

.

(8)

In the case where the target state σ is an eigenstate of
an observable A, the Gramian method allows to derive a
further bound. While the assumptions here are stronger,

4

this bound is particularly useful in a applications such
as the variational quantum eigensolver and when the ob-
servable of interest commutes with a Hamiltonian H for
which the target state is an eigenstate. Formally, we have
the following result:

Theorem 3 (Eigenvalues). Let ρ ∈ S(Hd) be a density
operator and let A be an arbitrary observable with eigen-
state ∣ψ⟩ and eigenvalue λ, A∣ψ⟩ = λ∣ψ⟩. Suppose that
(cid:15) ≥ 0 is such that F(ρ, ∣ψ⟩) = ⟨ψ∣ρ∣ψ⟩ ≥ 1 − (cid:15). Then, lower
and upper bounds for λ can be expressed as

√ (cid:15)

√ (cid:15)

.

(9)

1 − (cid:15)

⟨A⟩ρ − ∆Aρ

1 − (cid:15) ≤ λ ≤ ⟨A⟩ρ + ∆Aρ
The proofs for both Theorems presented in this section
take as starting the point Eq. (7) which is ﬁrst extended
to mixed state via puriﬁcations and Uhlmann’s Theorem.
The second step of the proof is a rewriting of the inequal-
ity in the case where the target state is an eigenstate of
A (Theorem 3), and, in the case of Theorem 2, an appli-
cation of the Cauchy-Schwarz inequality. The proofs are
given in Appendix B and Appendix C.

E. Comparison of the bounds

We have seen three diﬀerent methods to derive robust-
ness interval. Namely, the interval based on SDP given
in Theorem 1, the expectation value lower bound based
on the Gramian method from Theorem 2, and the ro-
bustness interval for eigenvalues from Theorem 3, which
is also based on the Gramian method. As a ﬁrst observa-
tion, we notice that the SDP bounds are dependent only
on the ﬁrst moment of the observable, while the bounds
derived from the Gramian method take into account the
second moment via the variance. In principle, this hints
at a trade-oﬀ between accuracy and eﬃciency. That is,
by taking into account higher moments, which comes at a
higher computational cost, one can hope for an improve-
ment in accuracy as more information is included. On
the other hand, the SDP bounds can be calculated as a
postprocessing step and thus do not require to measure
additional statistics. However, as less information is in-
cluded, this typically comes at the cost of lower accuracy.
On the practical side, one needs to consider that for
the SDP bounds to be applicable, it is required that the
observable lies between −1 and 1. In practice, however,
this is not always the case and the observable needs to be
appropriately rescaled, e.g. by using its eigenvalues. As
the exact eigenvalues might not be available, one needs to
use lower and upper bounds on these, which results in a
loss in tightness. This is because the set of feasible points
in the SDP from Eq. (3) becomes larger and hence loosens
the bounds. A similar issue emerges in the lower bound
for expectation values based on the Gramian method
where the observable needs to be positive semideﬁnite.
If this assumption is violated, one again needs to apply
an appropriate transformation of the observable, leading

to a potentially looser bound. Instead of scaling, one can
decompose the observable into individual terms, each sat-
isfying the constraints, and then bound each term sepa-
rately and aggregate the bounds over the decomposition.
In Sec. III we consider such a decomposition in the con-
text of VQE. Speciﬁcally, we decompose the underlying
Hamiltonian into groups of mutually commuting Pauli
terms and bound the expectation of each group sepa-
rately. In contrast, the eigenvalue bound based on the
Gramian method does not suﬀer from these issues and it
is applicable for general observables. It is worth remark-
ing that this comes at the cost of less generality in the
sense that the bound only applies to eigenvalues rather
than general expectation values.

Assuming that the observable A = P is a projection,
satisfying P 2
= P , allows for a direct comparison between
the bounds. Note that, in this case, the variance is fully
2
determined by the ﬁrst moment via (∆Pρ)
= ⟨P ⟩ρ −
2
⟨P ⟩
ρ and hence we expect that the Gramian Expectation
bound should not be tighter than the SDP bound. First,
we incorporate the knowledge that P is a projection in
the SDP lower bound by applying it to the observable
2P − 1 so that we have the bound

⟨P ⟩σ ≥ (1 − 2(cid:15))⟨P ⟩ρ + (cid:15) − 2

√

(cid:15)(1 − (cid:15))(⟨P ⟩ρ − ⟨P ⟩2

ρ) (10)

which is exactly the same as the lower bound derived via
the Gramian method in Theorem 2 when applied to the
projection P . We can also compare this bound to the
Gramian eigenvalue bound from Theorem 3. Since the
latter is less general, in the sense that it only holds for
target states which are eigenstates, we expect this to be
tighter than the expectation value bound. As can be seen
from Fig. 2, this is indeed the case.

√

√(cid:15)∣ψ⊥

1 − (cid:15)∣ψ⟩ +

Finally, we notice that all of the above bounds are
faithful in the sense that, as the approximation error van-
ishes (cid:15) → 0, the bounds converge to the true expectation
value ⟨A⟩σ. To compare the rate of convergence, con-
sider the case of pure states with the target state given
by σ = ∣ψ⟩⟨ψ∣ and the approximation state ρ = ∣φ⟩⟨φ∣ with
⟩ where ∣ψ⊥
∣φ⟩ =
⟩ is orthogonal to ∣ψ⟩
so that F(ρ, σ) = 1 − (cid:15). With this, one can explicitly
show that the error between each bound and the true
√(cid:15)) as (cid:15) → 0. For val-
expectation ⟨A⟩σ scales with O(
ues of (cid:15) close to 1 on the other hand, we remark that
both expectation value bounds tend towards the trivial
bounds, namely 0 for the expectation value bound, and
±1 for the SDP bounds. This ultimately stems from the
underlying assumptions required for the bounds to hold.
In contrast, the Gramian eigenvalue bound has no as-
sumptions on the observable A and the bounds diverge
as (cid:15) approaches 1.

F. Fidelity estimation

All bounds presented so far have in common that they
depend on the ﬁdelity with the target state σ. However,

5

FIG. 2. Diﬀerence between the SDP bounds from Theorem 1
and the Gramian eigenvalue bound from Theorem 3 as a func-
tion of the inﬁdelity (cid:15) and the expectation value ⟨P ⟩ρ. The ob-
servable is assumed to be a projection P and the target state
is an eigenstate of the observable. The diﬀerence is calculated
by subtracting the SDP bound from the Gramian bound. a)
shows the diﬀerence between lower bounds, b) shows the dif-
ference between the upper bounds. As can be seen from the
ﬁgures, the Gramian eigenvalue bound is always more accu-
rate than the expectation bound. Note that the Gramian
expectation value lower bound (Theorem 2) equals the SDP
lower bound under these assumptions.

in many practical settings, it is not possible to access
the target state and thus diﬃcult to obtain even a lower
bound to the true ﬁdelity. Here we address this topic
and present lower bounds on the true ﬁdelity for the case
where the target state is the ground state of a Hamilto-
nian H.

Let H be a Hamiltonian with eigenvalues λ0 ≤ λ1 ≤
. . . ≤ λd and assume that λ0 has geometric multiplicity
1 so that the corresponding ground state ∣ψ0⟩ is unique.
Let ρ be a possibly mixed state approximation of ∣ψ0⟩. If
both λ0 and λ1 are known, one can make use of Eckart’s
criterion [27]:

F(∣ψ0⟩⟨ψ0∣, ρ) = ⟨ψ0∣ρ∣ψ0⟩ ≥

λ1 − ⟨H⟩ρ
λ1 − λ0

.

(11)

In scenarios where knowledge of the lowest lying eigen-
values λ0 and λ1 is available, one can thus directly lower-
bound the ﬁdelity and use Eq. (11) in the computation of
the robustness intervals. In scenarios where one does not
have full knowledge of these eigenvalues (or, in the least,
corresponding bounds), Eckart’s criterion cannot be di-
rectly applied. However, we can still use the inequality
if a lower degree of knowledge about the spectrum of H
is available. If it is known that the energy estimate ⟨H⟩ρ
is closer to λ0 than to λ1 then, as an immediate conse-
quence of Eckart’s criterion, one ﬁnds that

⟨ψ0∣ρ∣ψ0⟩ ≥

1
2

.

(12)

We remark that substituting Eq. (12) into the Gramian
eigenvalue bounds from Theorem 3 yields the mixed state
extension of the Weinstein bounds [28, 29] in the non-
degenerate case. If, in addition, a lower bound δ on the

0.00.51.0†0.00.51.0›Pﬁρa) LBGram−LBSDP0.00.51.0†b) UBGram−UBSDP-1.0-0.50.00.51.0spectral gap is known such that λ1 − λ0 ≥ δ, then we have
the bound derived in Ref. [30],

III. APPLICATIONS

6

⟨ψ0∣ρ∣ψ0⟩ ≥ 1 −

∆Hρ
δ

,

(13)

which is a nontrivial lower bound whenever the variance
is small enough such that ∆Hρ ≤ δ. With a similar tech-
nique, one obtains a further tightening of the bound:

⟨ψ0∣ρ∣ψ0⟩ ≥

1
2

⎛
1 +
⎜
⎝

¿
`
`(cid:192)1 − (

∆Hρ
δ/2 )

2 ⎞
⎟
⎠

,

(14)

for variances with ∆Hρ ≤ δ/2. We note that this bound
has also been reported in Refs. [31, 32] and we provide
an alternative proof in the Appendix.
In practice, the
bound δ on the spectral gap can be estimated via classical
methods [33].

The above bounds hold for Hamiltonians H whose low-
est eigenvalue is non-degenerate. In Appendix D we con-
sider the degenerate case and show that when the approx-
imate state ρ is pure, then there always exists a state ∣ψ⟩
which is an element of the eigenspace associated with the
lowest (possibly degenerate) eigenvalue, and for which
the above ﬁdelity lower bounds hold. However, if ρ is a
mixed state, this cannot in general be said, as is shown in
the appendix with a counterexample. In summary, when
the approximate state ρ is allowed to be mixed, then the
ﬁdelity bounds are applicable only when the underlying
Hamiltonian has a non-degenerate ground state. If, on
the other hand, ρ is pure, then the bounds hold also in
the degenerate case.

The ﬁdelity bounds presented so far have in common
that some degree of knowledge about the ground state
in question is required. However, this degree of knowl-
edge is not necessarily available in practice. One sce-
nario in which this can potentially be circumvented is in
the context of variational quantum imaginary time evo-
lution (VarQITE). In general, VarQITE is a technique
to ﬁnd the ground state of a Hamiltonian H [34–36] by
projecting the time evolution of the initial state to the
evolution of the ansatz parameters. VarQITE typically
comes with an approximation error, stemming from a
limited expressibility of the Ansatz state or from noise. In
Ref. [37], this approximation error is quantiﬁed in terms
of an upper bound on the Bures distance between the
evolved state and the true ground state. Since there is
a one-to-one correspondence between Bures distance and
ﬁdelity, these error bounds can be converted to a lower
bound on the latter. This in turn can then be used to cal-
culate the eigenvalue and expectation bounds presented
in this work. Thus, in this scenario, our bounds can be
evaluated without requiring any knowledge on the true
ground state.

In this section, we put into practice the theoretical
results presented in the previous sections and calculate
the robustness intervals for ground state energies of elec-
tronic structure Hamiltonians when the approximation
of the ground state is provided by a VQE. We remark
that, while VQE serves as an example application, our
results are not limited to ground state energies but can
be used in a more general context where the goal is to
calculate error bounds for expectation values. Consider
a Hamiltonian H with Pauli decomposition

H =

n
∑
j=1

ωjPj

(15)

and let ρ be an approximation to the true ground state
∣ψ0⟩. Given (cid:15) ≥ 0 such that ⟨ψ0∣ρ∣ψ0⟩ ≥ 1 − (cid:15), and an esti-
mate of the variance ⟨H 2
2
⟩ρ − ⟨H⟩
ρ, it is straightforward
to evaluate the Gramian eigenvalue bounds from Theo-
rem 3. For the expectation value bounds derived via SDP
and via the Gramian method from Theorems 1 and 2),
one needs to be more careful since the Hamiltonian H
might violate the underlying assumptions. To evaluate
the latter, we can account for this by adding a suﬃciently
large constant c such that ˜H ∶= H + c1 ≥ 0 and calculate
the bound for ˜H, before reversing the translation in order
to get the desired bound for H. Clearly, a valid choice for
c is given by −λ0 where λ0 is the lowest eigenvalue of H.
However, it is not always clear which constant c leads to
the tightest lower bound. Similarly, to evaluate the SDP
bounds, we need to apply Theorem 1 to operators which
are bounded between ±1. If the full spectrum of H was
known, one could normalize H using these eigenvalues.
However, in the context of VQE, the spectrum is not a
priori known as this is precisely the task that VQE is
designed to solve, and we need a diﬀerent approach for
the expectation value bounds. The idea is to partition
the terms in the Pauli decomposition from Eq. (15) into
groups so that each term corresponding to a group can be
normalized. To this end, we ﬁrst partition H into groups
of mutually qubit-wise commuting terms

H =

M
∑
k=1

Hk, Hk = ∑
j

j P (k)
ω(k)

j

, [P (k)

i

, P (k)
j

] = 0.

(16)

Given such a representation, the spectrum of each of the
˜Hk
Hk can be calculated classically in order to scale Hk →
appropriately such that the assumptions for the bounds
are satisﬁed. One can then compute the bounds for each
of the terms in the summation and get the ﬁnal bounds
by aggregating the individual bounds. We further make
use of the approach presented in Refs. [38, 39] where one
applies a unitary transform Uk to each of the Hk terms
so that single-qubit measurement protocols can be used.
Speciﬁcally, instead of measuring Hk under the state ρ,
†
one measures Ak = UkHkU
k under the unitarily trans-
†
formed UkρU
k. One can then scale each Ak appropri-
ately by classically computing its eigenvalues and apply

7

ness [42] as chemistry backend, qulacs [43] as the sim-
ulation backend for noiseless simulations and qiskit [44]
for simulations which include noise. We model noise as
a combination of bitﬂip channels acting on single qubit
gates with error probability 0.01, and depolarizing noise
acting on two qubit gates, also with an error probability
of 1%.

θ

For a given Hamiltonian H, we ﬁrst approximate its
ground state ∣ψ0⟩ via VQE. That is, for an Ansatz state
ρθ with parameters θ one minimizes the objective ⟨H⟩ρθ
and obtains optimal parameters θ∗
= arg minθ ⟨H⟩ρθ .
It follows from the Rayleigh-Ritz variational princi-
is an upper bound
ple [45, 46] that the expectation ⟨H⟩ρ∗
to the true ground state energy λ0. The such obtained
ground state approximation ρθ∗ is then used to evaluate
the bounds by computing the relevant statistics, i.e. ex-
pectation values and variances of observables under this
state. We notice that the quality of this state in terms
of a distance to the true ground state is not easily ob-
tainable without having some prior knowledge over the
system of interest (see also Sec. II F in this regard). For
this reason and in order to investigate and compare the
bounds, here we assume knowledge of the true ﬁdelity
In practice, this is of course
with the ground state.
not realistic and, as discussed previously, one needs to
approximate the true ﬁdelity. Given the ground state
approximation ρθ∗ and the ﬁdelity F(ρθ∗ , ∣ψ0⟩⟨ψ0∣), we
then estimate the expectation values and variances under
ρθ∗ in order to evaluate the bounds. In the noiseless sce-
nario, these statistics can be calculated exactly, whereas
in the noisy scenario they need to be estimated due to
ﬁnite sampling errors. Thus, in the noisy case, we re-
peat the calculation of the bounds 20 times and report
one-sided 99%-conﬁdence intervals.

In Fig. 3, we consider the noisy scenario and compare
the diﬀerent types of bounds for H2(2, 4) and LiH(2,
4) with approximation states provided by VQE with
an UpCCGSD Ansatz [16] and optimized fermionic
gradients [47]. For both molecules, we notice that the
Gramian eigenvalue bound is the tightest, while the
expectation value bounds are less tight. However, this is
not surprising, as the eigenvalue bound is more suited for
this task, compared to the other bounds which hold more
generally for expectation values.
In Fig. 4, we again
consider the noisy scenario and compare the Gramian
eigenvalue bounds for approximation states obtained
via the SPA Ansatz [48] and via the UpCCGSD Ansatz
for H2(2, 4), LiH(2, 4) and BeH2(4, 8). We ﬁrst notice
that the SPA Ansatz is generally less vulnerable to
noise, which stems from the associated shallow circuits,
compared to the UpCCGSD Ansatz. In particular, SPA
and UpCCGSD have the same expressibility for H2
but, since SPA uses more eﬃcient compiling, its energy
estimates and lower bounds are more accurate compared
to UpCCGSD. A further observation to be made is that
in most cases, the lower bound is closer to the true
ground state energy than the corresponding VQE, as
can be seen from the error plots. The exception here

(a)

(b)

FIG. 3. Comparison of the diﬀerent lower bounds presented
in Sec. II for bond dissocation curves of H2(2, 4) and LiH(2,
4). The approximation states are provided by VQE with an
UpCCGSD ansatz. Both the VQE optimization and the eval-
uation of the bounds were simulated with bit ﬂip and depo-
larization noise with 1% error probability.

the expectation value bounds (Theorems 1 and 2) to each
term separately before aggregating.

A. Numerical simulations

Here, we numerically investigate the diﬀerent robust-
ness bounds for the ground state energies for a set of
electronic structure Hamiltonians, namely H2, LiH and
BeH2 molecules where the qubit Hamiltonians are ob-
tained within the basis-set-free approach of Ref.
[14]
using directly determined pair-natural orbitals on MP2
level [15]. All our experiments have been implemented in
the Tequila [13] library using the qubit encodings from
openfermion [40], optimizers from scipy [41], mad-

0.51.01.52.02.5Bond Distance (Å)1.00.50.00.5EnergyexactUpCCGSDRI (Gramian Eigenvalue)LB (Gramian Expectation)RI (SDP)0.51.01.52.02.53.03.54.04.55.0Bond Distance (Å)8.07.57.06.5EnergyexactUpCCGSDRI (Gramian Eigenvalue)LB (Gramian Expectation)RI (SDP)8

(a)

(b)

(c)

(d)

(e)

(f)

FIG. 4. Bond dissociation curves and robustness intervals (RI) for eigenvalues based on the Gramian method (Theorem 3)
for H2(2, 4), LiH(2, 4) and BeH2(4, 8). The lower half in each ﬁgure shows the error between VQE and the true energy E0
computed as V QE − E0, and the error between E0 and the lower bound (LB) given by E0 − LB. Both the VQE optimization
and the evaluation of the bounds are done under a combination of bit ﬂip and depolarization noise with 1% error probability.

1.11.00.9energyE0VQE (SPA)RI (Gramian Eigenvalue)0.51.01.52.02.5Bond Distance (Å)103102101ErrorVQEE0E0LB1.00.5energyE0VQE (UpCCGSD)RI (Gramian Eigenvalue)0.51.01.52.02.5Bond Distance (Å)102101100ErrorVQEE0E0LB8.07.97.8energyE0VQE (SPA)RI (Gramian Eigenvalue)1.01.52.02.53.03.54.04.55.0Bond Distance (Å)103102101ErrorVQEE0E0LB8.07.87.6energyE0VQE (UpCCGSD)RI (Gramian Eigenvalue)1.01.52.02.53.03.54.04.55.0Bond Distance (Å)102101ErrorVQEE0E0LB15.515.0energyE0VQE (SPA)RI (Gramian Eigenvalue)1.01.52.02.53.03.54.04.5Bond Distance (Å)103102101ErrorVQEE0E0LB1510energyE0UpCCGSDRI (Gramian Eigenvalue)1.01.52.02.53.03.54.04.5Bond Distance (Å)1006×1012×1003×100ErrorVQEE0E0LB9

to trivial bounds and the eigenvalue bound starts to
diverge. In Fig. 5 we consider the noiseless scenario with
an SPA ansatz for LiH and BeH2. Here we again see
that in both cases the lower bound is closer to the true
value than VQE, in some regions even reaching chemical
accuracy where VQE does not. This is interesting,
as it indicates that even though for Ansätze which
lack the expressive power required to approximate the
ground state, it is still possible to obtain an estimate
of the ground state energy within chemical accuracy
by calculating the lower bound.
It is worth remarking
that these bounds are obtained under the assumption
of having complete knowledge of the true ground state
ﬁdelity, an assumption which is idealistic and typically
violated in practice. Nevertheless, these results indicate
that, in principle, it is possible to obtain very accurate
lower bounds to ground state energies of electronic
structure Hamiltonians.

B.

Implementation

All our robustness intervals are implemented in the
open source Tequila [13] library. In the following ex-
ample, we run VQE for the H2 Hamiltonian in a minimal
representation (4 qubits), before computing the lower and
upper bounds based on the optimized circuit, using the
function robustness_interval:

1 import tequila as tq
2 from tequila . apps . robustness import

˙ r o b u s t n es s _ i n t e r v a l

3
4 geom = " H .0 .0 .0\ nH .0 .0 .75 "
5 mol = tq . Molecule ( geom , n_pno =1)
6
7 H = mol . make_hamiltonian ()
8 U = mol . m a k e _ u p cc g s d _ a n s a t z ()
9 E = tq . ExpectationValue ( H =H , U = U )
10 result = tq . minimize ( E )
11
12 lower_bound , energy , upper_bound , _ =

˙ r o b u s t n es s _ i n t e r v a l (U , H , fidelity ,
˙ variables = result . variables )

interval

Used in this way, the function calculates the robustness
interval for all three methods and returns the tightest
bounds. Alternatively, one can specify the type of bound
via the keywords kind and method where the former
stands for which kind of
is desired, that is
expectation or eigenvalue, and the latter stands for the
method used to obtain the bound (Gramian or SDP).
For example, calculating a robustness interval for eigen-
values using the Gramian method, can be implemented
as
robustness_interval(..., kind="eigenvalue",
method="gramian"). In general, any type of expectation
value can be used. Note that our implementation is
agnostic with respect to the molecular representation, so
that replacing n_pno=1 with basis_set="sto-3g" will
lead to a 4 qubit Hamiltonian in a traditional basis set.

(a)

(b)

FIG. 5. Bond dissociation curves, robustness interval (RI) for
eigenvalues based on the Gramian method (Theorem 3) for
LiH(2, 4)and BeH2(4, 8). The lower half in each ﬁgure shows
the error between VQE and the true energy E0 computed
as V QE − E0, and the error between E0 and the lower bound
(LB) given by E0−LB. Here, an ideal scenario without noise is
simulated and the approximation errors stem from the limited
expressibility of the Ansatz state.

is BeH2 with an UpCCGSD Ansatz where the noise
level is too high for VQE to converge to a good enough
approximation.
Indeed, the ground state ﬁdelities for
diﬀerent bond lengths vary between 0.01 and 0.1 for
UpCCGSD and between 0.37 and 0.92 for the SPA
Ansatz. In Appendix E we show robustness intervals for
the LiH(2, 4) molecule with the error rate increased to
10%. For the SPA ansatz, even with this error rate, the
ground state ﬁdelities vary between 0.51 and 0.65 while
the UpCCGSD states have low ground state ﬁdelities
In other words, UpCCGSD fails to
in the range 0.1.
converge to states which are close to the true ground
state.
It is interesting to note that for lowest ground
state ﬁdelities, the expectation value bounds reduce

8.007.957.90energyE0VQE (SPA)RI (Gramian Eigenvalue)1.01.52.02.53.03.54.04.55.0Bond Distance (Å)1014109104ErrorVQEE0E0LB15.7515.5015.25energyE0VQE (SPA)RI (Gramian Eigenvalue)1.01.52.02.53.03.54.04.5Bond Distance (Å)105103101ErrorVQEE0E0LBIV. DISCUSSION AND CONLUSIONS

provements.

10

The current experimental stage of quantum compu-
tation oﬀers the possibility to explore the physical and
chemical properties of small systems and novel quantum
algorithms are being developed to extract the most from
this ﬁrst generation of quantum devices. However, this
potential for computational advantage, compared to clas-
sical methods, comes at a price of noisy and imperfect
simulations stemming from low qubit counts and thus the
lack of quantum error correcting qubits. The Variational
Quantum Eigensolver (VQE) is the canonical example
of these NISQ algorithms that allow us to obtain an ap-
proximation of Hamiltonian eigenstates by exploiting the
variational principle of quantum mechanics. Besides the
broad applications and promising results of this approach
[3, 30, 49], its performance guarantees should be studied
and understood.

In this work we have made ﬁrst progress in this direc-
tion and have derived robustness intervals for quantum
measurements of expectation values. For a target state σ,
these intervals are guaranteed to contain the true expec-
tation value ⟨A⟩σ of an observable A when we only have
access to an approximation ρ. Based on resource con-
straints, accuracy requirements, and depending on the
task, we have seen three diﬀerent types of robustness in-
tervals. Firstly, based on its formulation as an SDP, we
have derived upper and lower bounds to ⟨A⟩σ which take
into account only the ﬁrst moment of the observable A
and can thus be obtained by post-processing measure-
ments of ⟨A⟩ρ together with the ﬁdelity with the target
state F(ρ, σ). Secondly, to take into account further
moments of A and get tighter bounds, we have revisited
the Gramian method [12] and extended this technique to
mixed states, thereby enabling their applicability in noisy
scenarios which are prevalent in the NISQ era. This has
led to a further lower bound to expectation values and,
additionally, to lower and upper bounds on eigenvalues
of a given Hamiltonian. We have also implemented our
bounds in the open source Tequila [13] library. Fur-
thermore, we have validated our results with numerical
simulations of noisy and noiseless scenarios with VQE as
an example application to calculate robustness intervals
for ground state energies of electronic structure Hamilto-
nians of H2, LiH and BeH2. Within these experiments,
we observed that the lower bound on the ground state
energy is up to one order of magnitude closer to the true
ground state energy compared to the respective VQE es-
timate, at times even reaching chemical accuracy where
VQE does not. These results are promising as they indi-
cate that our bounds not only provide sound guarantees
for the performance of these algorithms, but can even
be used in conjunction and deliver further accuracy im-

The main requirement of the bounds obtained is the
knowledge of the ﬁdelity between the target state and
its approximation. Although such a quantity is not al-
ways experimentally accessible and hence poses a chal-
lenge in the practical applicability of these bounds, there
exist algorithms, such as within the variational quan-
tum imaginary time evolution [37] framework, which al-
low for a quantiﬁcation of the required approximation
error in terms of distances between the target and the
approximate state. Nonetheless, our aim is to provide
a formal framework to study the robustness of broadly
used approaches as are the Variational Quantum Algo-
rithms. There are still many questions around the appli-
cability of these quantum algorithms and its robustness
against noise. Within this work, we seek to unravel the
uncertainties around these state-of-the-art quantum al-
gorithms with the goal of improving its performance and
applicability.

ACKNOWLEDGMENTS

The authors are grateful to Joseph Fitzsimons (Hori-
zon Quantum Computing) and Nana Liu (Shanghai Jiao
Tong University) for inspiring discussions on the topic of
robustness of NISQ algorithms. A.A.-G. acknowledges
in the form
the generous support from Google, Inc.
of a Google Focused Award. This work is partly sup-
ported by the U.S. Department of Energy under Award
No. DESC0019374 and the U.S. Oﬃce of Naval Research
(ONS506661). A.A.-G. also acknowledges support from
the Canada Industrial Research Chairs Program and the
Canada 150 Research Chairs Program. A.A.-G. acknowl-
edges generous support from Anders G. Fröseth and Sony
Research. CZ and the DS3Lab gratefully acknowledge
the support from the Swiss National Science Foundation
(Project Number 200021_184628, and 197485), Innosu-
isse/SNF BRIDGE Discovery (Project Number 40B2-
0_187132), European Union Horizon 2020 Research and
Innovation Programme (DAPHNE, 957407), Botnar Re-
search Centre for Child Health, Swiss Data Science Cen-
ter, Alibaba, Cisco, eBay, Google Focused Research
Awards, Kuaishou Inc., Oracle Labs, Zurich Insurance,
and the Department of Computer Science at ETH Zurich.

CODE AVAILABILITY

The code for the numerical simulations is pub-
https://github.com/DS3Lab/

licly
robustness-intervals-quantum-measurements.

available

at

[1] J. Preskill, Quantum 2, 79 (2018).

[2] K. Bharti, A. Cervera-Lierta, T. H. Kyaw, T. Haug,
S. Alperin-Lea, A. Anand, M. Degroote, H. Heimo-

nen, J. S. Kottmann, T. Menke, et al., arXiv:2101.08448
(2021).

[3] A. Peruzzo, J. McClean, P. Shadbolt, M.-H. Yung, X.-Q.
Zhou, P. J. Love, A. Aspuru-Guzik, and J. L. O’Brien,
Nature Communications 5, 4213 (2014).

[4] E. Farhi,

J. Goldstone,

and

S. Gutmann,

arXiv:1411.4028 (2014).

[5] K. Nakaji and N. Yamamoto, Quantum 5, 434 (2021).
[6] S. Sim, P. D. Johnson, and A. Aspuru-Guzik, Advanced

Quantum Technologies 2, 1900070 (2019).

[7] J. R. McClean, S. Boixo, V. N. Smelyanskiy, R. Babbush,
and H. Neven, Nature Communications 9, 4812 (2018).
[8] S. Wang, E. Fontana, M. Cerezo, K. Sharma, A. Sone,
L. Cincio, and P. J. Coles, arXiv:2007.14384 (2020).

[9] C. O. Marrero, M. Kieferová,

and N. Wiebe,

arXiv:2010.15968 (2020).

[10] D. Wecker, M. B. Hastings, and M. Troyer, Physical

Review A 92, 042303 (2015).

[11] W. J. Huggins, J. R. McClean, N. C. Rubin, Z. Jiang,
N. Wiebe, K. B. Whaley, and R. Babbush, npj Quantum
Information 7, 1 (2021).

[12] F. Weinhold, Journal of Physics A: General Physics 1,

305 (1968).

[13] J. S. Kottmann, S. Alperin-Lea, T. Tamayo-Mendoza,
A. Cervera-Lierta, C. Lavigne, T.-C. Yen, V. Vertelet-
skyi, P. Schleich, A. Anand, M. Degroote, et al., Quan-
tum Science and Technology 6, 024009 (2021).

[14] J. S. Kottmann, P. Schleich, T. Tamayo-Mendoza, and
A. Aspuru-Guzik, J. Phys. Chem. Lett. 12, 663 (2021).
[15] J. S. Kottmann, F. A. Bischoﬀ, and E. F. Valeev, The

Journal of Chemical Physics 152, 074105 (2020).

[16] J. Lee, W. J. Huggins, M. Head-Gordon,

and K. B.
Whaley, Journal of Chemical Theory and Computation,
Journal of Chemical Theory and Computation 15, 311
(2019).

[17] M. Weber, N. Liu, B. Li, C. Zhang, and Z. Zhao, npj

Quantum Information 7, 76 (2021).

[18] A. Uhlmann, Reports on Mathematical Physics 9, 273

(1976).

11

[34] S. McArdle, T. Jones, S. Endo, Y. Li, S. C. Benjamin,
and X. Yuan, npj Quantum Information 5, 75 (2019).
[35] X. Yuan, S. Endo, Q. Zhao, Y. Li, and S. C. Benjamin,

Quantum 3, 191 (2019).

[36] M. Motta, C. Sun, A. T. K. Tan, M. J. O’Rourke, E. Ye,
A. J. Minnich, F. G. S. L. Brandão, and G. K.-L. Chan,
Nature Physics 16, 205 (2020).

[37] C. Zoufal, D. Sutter, and S. Woerner, arXiv:2108.00022

(2021).

[38] T.-C. Yen, V. Verteletskyi, and A. F. Izmaylov, Journal
of Chemical Theory and Computation 16, 2400 (2020).
[39] V. Verteletskyi, T.-C. Yen, and A. F. Izmaylov, J. Chem.

Phys. 152, 124114 (2020).

[40] J. R. McClean, K. J. Sung, I. D. Kivlichan, Y. Cao,
C. Dai, E. S. Fried, C. Gidney, B. Gimby, P. Gokhale,
T. Häner, T. Hardikar, V. Havlíček, O. Higgott,
C. Huang, J. Izaac, Z. Jiang, X. Liu, S. McArdle, M. Nee-
ley, T. O’Brien, B. O’Gorman, I. Ozﬁdan, M. D. Radin,
J. Romero, N. Rubin, N. P. D. Sawaya, K. Setia, S. Sim,
D. S. Steiger, M. Steudtner, Q. Sun, W. Sun, D. Wang,
F. Zhang, and R. Babbush, arXiv:1710.07629 (2017).

[41] P. Virtanen, R. Gommers, T. E. Oliphant, M. Haber-
land, T. Reddy, D. Cournapeau, E. Burovski, P. Pe-
terson, W. Weckesser, J. Bright, S. J. van der Walt,
M. Brett, J. Wilson, K. Jarrod Millman, N. Mayorov,
A. R. J. Nelson, E. Jones, R. Kern, E. Larson, C. Carey,
İ. Polat, Y. Feng, E. W. Moore, J. Vand erPlas, D. Lax-
alde, J. Perktold, R. Cimrman, I. Henriksen, E. A. Quin-
tero, C. R. Harris, A. M. Archibald, A. H. Ribeiro, F. Pe-
dregosa, P. van Mulbregt, and S. . . Contributors, Nature
Methods 17, 261 (2020).

[42] R. J. Harrison, G. Beylkin, F. A. Bischoﬀ, J. A. Calvin,
G. I. Fann, J. Fosso-Tande, D. Galindo, J. R. Hammond,
R. Hartman-Baker, J. C. Hill, et al., SIAM J. Sci. Com-
put. 38, S123 (2016).

[43] Y. Suzuki, Y. Kawase, Y. Masumura, Y. Hiraga,
M. Nakadai, J. Chen, K. M. Nakanishi, K. Mitarai,
R. Imai, S. Tamiya, et al., arXiv:2011.13524 (2020).
[44] A. et al., “Qiskit: An open-source framework for quantum

[19] R. A. Horn and C. R. Johnson, Matrix Analysis (Cam-

computing,” (2021).

bridge University Press, 1985).

[20] F. Weinhold, Journal of Physics A: General Physics 1,

[45] J. Rayleigh, Phil. Trans. 161, 77 (1870).
[46] W. Ritz, Journal für die reine und angewandte Mathe-

matik 135, 1 (1909).

[47] J. S. Kottmann, A. Anand, and A. Aspuru-Guzik, Chem.

Sci. , (2021).

[48] J. S. Kottmann and A. Aspuru-Guzik, arXiv:2105.03836

(2021).

[49] F. Arute, K. Arya, R. Babbush, D. Bacon, J. C. Bardin,
R. Barends, S. Boixo, M. Broughton, B. B. Buckley, D. A.
Buell, et al., Science 369, 1084 (2020).

535 (1968).

[21] F. Weinhold, Phys. Rev. 183, 142 (1969).
[22] F. Weinhold, Phys. Rev. A 1, 122 (1970).
[23] P. Wang, Chemical Physics Letters 11, 318 (1971).
[24] R. Blau, A. R. P. Rau, and L. Spruch, Phys. Rev. A 8,

119 (1973).

[25] M. G. Marmorino, Journal of Mathematical Chemistry

32, 19 (2002).

[26] M. G. Marmorino and V. Black, Journal of Mathematical

Chemistry 54, 1973 (2016).

[27] C. Eckart, Phys. Rev. 36, 878 (1930).
[28] D. H. Weinstein, Proceedings of the National Academy

of Sciences 20, 529 (1934).

[29] J. K. L. MacDonald, Phys. Rev. 46, 828 (1934).
[30] J. R. McClean, J. Romero, R. Babbush, and A. Aspuru-
Guzik, New Journal of Physics 18, 023023 (2016).
[31] F. Weinhold, Journal of Mathematical Physics 11, 2127

(1970).

[32] C. Davis and W. M. Kahan, SIAM Journal on Numerical

Analysis 7, 1 (1970).

[33] T. Helgaker, P. Jorgensen,

and J. Olsen, Molecular

Electronic-Structure Theory (Wiley, 2014).

Appendix A: Proof of Theorem 1

1. Auxiliary Lemma

12

Here we state a result from quantum hypothesis testing which serves as a central tool for deriving the bounds in
Theorem 1. We remark that this has been shown in the appendix of Ref. [17], although in a slightly diﬀerent form
and for pure states. For completeness, we include the proof here and refer the reader to [17] for proofs of speciﬁc
lemmas. Recall that the semideﬁnite program for the optimal type-II error probability in binary quantum hypothesis
testing is given by

β∗

(α0; ρ, σ) ∶= minimize Tr[σ(1 − Λ)]
s.t. Tr[ρΛ] ≤ α0,
0 ≤ Λ ≤ 1d

(A1)

The following lemma provides a lower bound to this SDP which, in the case of pure states is saturated.

Lemma 1. Let σ, ρ ∈ S(Hd) be arbitrary quantum states, α0 ∈ [0, 1] and suppose that F(ρ, σ) ≥ 1 − (cid:15) for (cid:15) ≥ 0. Then,
for 1 − (cid:15) ≥ α0, we have

β∗

(α0; ρ, σ) ≥ α0(2(cid:15) − 1) + (1 − (cid:15)) − 2

√

(cid:15)α0(1 − (cid:15))(1 − α0)

(A2)

with equality if the states σ and ρ are pure and F(ρ, σ) = 1 − (cid:15).
Proof. It is well known that solutions to the SDP β∗ are attained by Helstrom operators, i.e. operators of the form
Λt = Pt,+ +Xt with 0 ≤ Xt ≤ Pt,0 where Pt,0 = 1−Pt,+ −Pt,− and Pt,± are projections onto the null, positive and negative
eigenspaces of the operator σ − tρ for t ≥ 0. In particular, optimality of the Helstrom operators follows from the fact
that for any 0 ≤ λ ≤ 1 we have

Tr[Λρ] ≤ Tr[Λtρ] ⇒ Tr[(1 − Λ)σ] ≥ Tr[(1 − Λt)σ].
For a formal proof of this, see Lemma 6 in the supplementary information of [17]. The idea is now to choose t and,
(α0; ρ, σ) = Tr[(1−Λt)σ].
correspondingly, Xt such that Tr[(Pt,++Xt)ρ] = α0 which, by the above implication yields β∗
The next step is then to show that Tr[(1 − Λt)σ] is equal to the RHS in Eq. (A2) for pure states. In the last step,
this is extended to an inequality for mixed states using Uhlmann’s Theorem and the monotonicity of β∗ under the
partial trace.

(A3)

In the sequel, deﬁne t0 to be the nonnegative number

This is well deﬁned since the function t ↦ Tr[Pt,+σ] is non-increasing and continuous from the right (see Lemmas 2
& 3 in the supplementary information of [17] for a proof of this). From Lemma 5 in the supplementary information
of [17] we have the following sandwich inequality

t0 ∶= inf{t ≥ 0∣ Tr[Pt,+ρ] ≤ α0}.

(A4)

which enables us to set Λt0 ∶= Pt0,+ + q0 ⋅ Pt0,0 with

Tr[Pt0,+ρ] ≤ α0 ≤ Tr[(Pt0,+ + Pt0,0)ρ]

q0 =

⎧⎪⎪
0
⎨
α0−Tr[Pt0,+ρ]
⎪⎪⎩
Tr[Pt0 ,0ρ]
It follows that β∗

Tr[Pt0,0ρ] = 0

so that Tr[Λt0 ρ] = α0 as desired.
Tr[(1 − Λt0 )σ] ≥ α0(2(cid:15) − 1) + (1 − (cid:15)) − 2
mixed states in the subsequent step.

√

(α0; ρ, σ) = Tr[(1 − Λt0)σ] and it remains to show that
(cid:15)α0(1 − (cid:15))(1 − α0) for 1 − (cid:15) ≥ α0. We start with pure states and extend to

Suppose that σ = ∣ψ⟩⟨ψ∣ and ρ = ∣φ⟩⟨φ∣ are pure states and let γ = ⟨ψ∣φ⟩. We will show that

Tr[(1 − Λt0)σ] = α0 ⋅ (1 − 2 ∣γ∣

2

2

) + ∣γ∣

− 2

√

2
(1 − α0)(1 − ∣γ∣

) ∣γ∣

2 α0

if α0 ≤ ∣γ∣

2 and zero otherwise. To get an expression for Λt0, consider the eigenvalue problem

(σ − tρ)∣η⟩ = η∣η⟩.

(A7)

(A8)

(A5)

(A6)

Since here σ and ρ are projections of rank one, the operator σ − tρ has rank at most two and there exist at most two
eigenstates ∣η0⟩, ∣η1⟩ corresponding to non-vanishing eigenvalues . In addition, they are linear combinations of ∣ψ⟩, ∣φ⟩
so that we can write

13

with constants zk,ψ, zk,φ. Thus, the eigenvalue problem in Eq. (A8) amounts to the problem

∣ηk⟩ = zk,ψ∣ψ⟩ + zk,φ∣φ⟩,

k = 0, 1

1
γ
−t¯γ −t) ⋅ (
(

zk,ψ
zk,φ

) = ηk (

zk,ψ
zk,φ

)

for which we ﬁnd

η0 =

1
2 (1 − t) − Rt,
zk,ψ = −γAk,

η1 =

1
2 (1 − t) + Rt, Rt =
∣Ak∣

−2

zk,φ = (1 − ηk)Ak,

√

1
4 (1 − t)2 + t(1 − ∣γ∣

2

)

2
= 2Rt ∣ηk − 1 + ∣γ∣

∣

(A9)

(A10)

(A11)

Note that ∀t ≥ 0 we have η0 ≤ 0 and η1 > 0 so that Pt,+ = ∣η1⟩⟨η1∣. Recall that we deﬁned t0 to be the positive number
t0 ∶= inf{t ≥ 0∶ Tr[Pt,+ρ] ≤ α0}. It follows that

2
Tr[Pt,+ρ] = ∣⟨φ∣η1⟩∣

=

1
2

⎛
⎜
⎝

1 −

√

2
1 + t − 2 ∣γ∣
2
(1 + t)2 − 4t ∣γ∣

⎞
⎟
⎠

(A12)

and notice that the right hand side is continuous in t over [0, ∞) whenever ∣γ∣ < 1. Since t ↦ Tr[Pt,+ρ] is non-
2. In this case, we
increasing, it’s maximum is attained at t = 0 so that Tr[Pt,+ρ] ≤ ∣γ∣
2, then we solve the equation Tr[Pt,+ρ] = α0 and obtain the
obtain β∗
expression for t0

(α0; ρ, σ) = 0. If, on the other hand, α0 ≤ ∣γ∣

2 and hence t0 = 0 if α0 > ∣γ∣

t0 = 2 ∣γ∣

2

− 1 − (2α0 − 1)

¿
`
`(cid:192) ∣γ∣

2

2

(1 − ∣γ∣
α0(1 − α0)

)

.

For t = t0 we have η0 < 0 and η1 > 0 so that Λt0 = ∣η1⟩⟨η1∣ and ∣η1⟩ = −γA1∣ψ⟩ + (1 − η1)A1∣φ⟩. Hence

β∗

2
(α0; φ, ψ) = 1 − ∣⟨η1∣ψ⟩∣
∣γ∣

2
= 1 − ∣A1∣

2 η2
1.

Plugging t0 into the expressions above yields

β∗

2
(α0; φ, ψ) = α0 ⋅ (1 − 2 ∣γ∣

) + ∣γ∣

2

− 2

√

(1 − α0)(1 − ∣γ∣

2

) ∣γ∣

2 α0.

(A13)

(A14)

(A15)

Since the right hand side of Eq. (A15) is monotonically decreasing in ∣γ∣
≥ 1 − (cid:15), the claim follows for pure
states. To see that the above expression also constitutes a valid lower bound for mixed states, let Ψ and Φ be arbitrary
puriﬁcations of σ and ρ respectively. It is well known that β∗ is monotonically increasing under the action of any
completely positive and trace preserving map E, i.e. β∗
(α0; E[σ], E[ρ]) for any α0 ∈ [0, 1]. Since the
partial trace is itself a CPTP map, we have the inequality

(α0; σ, ρ) ≤ β∗

2 and ∣γ∣

2

β∗

(α0; ρ, σ) = β∗
≥ β∗

(α0; TrE[∣Φ⟩⟨Φ∣], TrE[∣Ψ⟩⟨Ψ∣])
(α0; Φ, Ψ)

2
= α0 ⋅ (1 − 2 ∣⟨Ψ∣Φ⟩∣

2
) + ∣⟨Ψ∣Φ⟩∣

− 2

2
(1 − α0)(1 − ∣⟨Ψ∣Φ⟩∣

√

) ∣⟨Ψ∣Φ⟩∣

2 α0

(A16)

where TrE[⋅] denotes the partial trace over the purifying system. It follows from Uhlmann’s Theorem that we can
2
choose Ψ, Φ such that ∣⟨Ψ∣Φ⟩∣
= F(ρ, σ). The claim now follows from the observation that the RHS of Eq. (A16) is
monotonically decreasing in ∣⟨Ψ∣Φ⟩∣

2. This completes the proof.

Given this Lemma, we now provide the full proof for Theorem 1.

Theorem 1 (restated). Let σ, ρ ∈ S(Hd) be density operators with F(ρ, σ) ≥ 1 − (cid:15) for some (cid:15) ≥ 0. Let A be an
observable with −1 ≤ A ≤ 1 and with expectation value ⟨A⟩ρ under ρ. For (cid:15) ≤
1
2 (1 + ⟨A⟩ρ), the lower bound of ⟨A⟩σ can
be expressed as

14

⟨A⟩σ ≥ (1 − 2(cid:15))⟨A⟩ρ − 2

√

(cid:15)(1 − (cid:15))(1 − ⟨A⟩2

ρ).

Similarly, for (cid:15) ≤

1
2 (1 − ⟨A⟩ρ), the upper bound of ⟨A⟩σ becomes
√

⟨A⟩σ ≤ (1 − 2(cid:15))⟨A⟩ρ + 2

(cid:15)(1 − (cid:15))(1 − ⟨A⟩2

ρ).

(A17)

(A18)

Proof. The idea is to ﬁrst formalize the problem as a semideﬁntie program which takes into account the ﬁrst moment
of A under ρ and the assumption that −1 ≤ A ≤ 1. This is then connected to the SDP Eq. (A1) from QHT for which
a closed form lower bound is known from Lemma 1. We start with the upper bound. Consider the SDP

which is an upper bound to ⟨A⟩σ since the operator A is feasible. We can rewrite this as

max {Tr[Λσ] ∣ Tr[Λρ] = Tr[Aρ], −1 ≤ Λ ≤ 1}

max {Tr[Λσ] ∣ Tr[Λρ] = Tr[Aρ], −1 ≤ Λ ≤ 1} = −1 + 2 max {Tr[

˜Λσ] ∣ Tr[

˜Λρ] =

1
2 (1 + Tr[Aρ]), 0 ≤

˜Λ ≤ 1}

= 1 − 2β∗

(

1
2 (1 + Tr[Aρ]); ρ, σ)

(A19)

(A20)

where the second equality follows from the fact that replacing the equality with an inequality in the constraint of the
SDP Eq. (A1) leads to the same solution. It then follows from Lemma 1 that

⟨A⟩σ ≤ (1 − 2(cid:15))⟨A⟩ρ + 2

√

(cid:15)(1 − (cid:15))(1 − ⟨A⟩2
ρ)

for (cid:15) ≥ 0 with 1 − (cid:15) ≥

1
2 (1 + ⟨A⟩ρ).

To show the lower bound, consider the SDP

min {Tr[Λσ] ∣ Tr[Λρ] = Tr[Aρ], −1 ≤ Λ ≤ 1}

which is a lower bound to ⟨A⟩σ since the operator A is feasible. We rewrite this as

min {Tr[Λσ] ∣ Tr[Λρ] = Tr[Aρ], −1 ≤ Λ ≤ 1} = 2 min {Tr[(1 −

˜Λ)σ] ∣ Tr[

˜Λρ] =

1
2 (1 − Tr[Aρ]), 0 ≤

˜Λ ≤ 1} − 1

= 2β∗

(

1
2 (1 − Tr[Aρ]); ρ, σ) − 1

and again use Lemma 1 and obtain the lower bound

⟨A⟩σ ≥ (1 − 2(cid:15))⟨A⟩ρ − 2

√

(cid:15)(1 − (cid:15))(1 − ⟨A⟩2
ρ)

for (cid:15) ≥ 0 with 1 − (cid:15) ≥

1
2 (1 − ⟨A⟩ρ).

2. Tightness of the SDP bound

(A21)

(A22)

(A23)

(A24)

Here we show that the SDP bounds presented in Theorem 1 are tight for pure states in the sense that, under the
given assumptions, there exists an observable which saturates the bound in the case that F(ρ, σ) = 1 − (cid:15). Let us ﬁrst
consider the upper bound and recall that in the proof of Theorem 1 we have shown

⟨A⟩σ ≤ max {Tr[Λσ] ∣ Tr[Λρ] = Tr[Aρ], −1 ≤ Λ ≤ 1}
1
2 (1 + Tr[Aρ]); ρ, σ)

= 1 − 2β∗

(

≤ (1 − 2(cid:15))⟨A⟩ρ + 2

(cid:15)(1 − (cid:15))(1 − ⟨A⟩2
ρ)

√

(A25)

where the last inequality follows from Lemma 1. Additionally, it follows from Lemma 1 that for pure states this
inequality is indeed an equality, that is, we have shown that for pure states we have

15

(α0; ρ, σ) = α0(2(cid:15) − 1) + (1 − (cid:15)) − 2
for 1−(cid:15) ≥ α0 for arbitrary α0 ∈ [0, 1]. This followed from constructing an operator Λ⋆ with Tr[σ(1−Λ⋆
Let Λ⋆ be such an operator for α0 = Tr[Λ⋆ρ] and let A⋆

− 1. We notice that

(cid:15)α0(1 − (cid:15))(1 − α0)

∶= 2Λ⋆

β∗

√

(A26)

)] = β∗

(α0; ρ, σ).

⟨A⋆

⟩σ = Tr[σ(2Λ⋆

− 1)]
= 1 − 2Tr[σ(1 − Λ⋆
= 1 − 2β∗

(Tr[Λ⋆ρ]); ρ, σ)

)]

(A27)

which shows that the bound is indeed saturated for the observable A⋆. Tightness of the lower bound can be shown
analogously.

Appendix B: Proof of Theorem 2

Theorem 2 (restated). Let σ, ρ ∈ S(Hd) be density operators with F(ρ, σ) ≥ 1 − (cid:15) for some (cid:15) ≥ 0. Let A ≥ 0 be an
arbitrary observable with expectation value ⟨A⟩ρ under ρ. For (cid:15) with
(1 − (cid:15))/(cid:15) ≥ ∆Aρ/⟨A⟩ρ, the lower bound of ⟨A⟩σ
can be expressed as

√

⟨A⟩σ ≥ (1 − 2(cid:15))⟨A⟩ρ − 2

√

(cid:15)(1 − (cid:15))∆Aρ +

(cid:15)⟨A2
⟩ρ
⟨A⟩ρ

.

Proof. Recall that the Gramian inequalities from Eq. (7) for pure states read

⟨φ∣ψ⟩⟨A⟩φ − ∆Aφ

√

2
1 − ∣⟨φ∣ψ⟩∣

≤ R(⟨ψ∣A∣φ⟩) ≤ ⟨φ∣ψ⟩⟨A⟩φ + ∆Aφ

√

2
1 − ∣⟨φ∣ψ⟩∣

(B1)

(B2)

where ψ denotes the target state and φ the approximate state. The ﬁrst step is to show that this also holds for mixed
states. Uhlmann’s Theorem [18] states that for any two mixed states ρ and σ, we have

F(ρ, σ) = ∥

√

√ρ

σ∥

2

1

.

(B3)

The trace norm in its variational form is given by ∥S∥1 = maxU ∣Tr[U S]∣ for arbitrary S ∈ L(Hd) and where the
maximization is taken over all unitaries. It follows that there exists U such that

F(ρ, σ) = ∣Tr[U √ρ

√

2
σ]∣

(B4)

Let ∣Ω⟩ = ∑
RHS of Eq. (B4) can be rewritten as

d
k=1∣k⟩ ⊗ ∣k⟩ be the unnormalized maximally entangled state on Hd ⊗ Hd and note that the trace in the

Tr[U √ρ

√

σ] = ∑
k

√

σ∣k⟩

⟨k∣U √ρ
⟨k∣U √ρ
⟨k∣ ⊗ ⟨k∣(U √ρ ⊗ 1)(

σ∣l⟩⟨k∣l⟩

√

= ∑
k,l

= ∑
k,l
= ⟨Ω∣(

√ρ ⊗ (U T

√

†

)

)(

σ ⊗ 1)∣Ω⟩

√

σ ⊗ 1)∣l⟩ ⊗ ∣l⟩

(B5)

where the last equality follows from the deﬁnition of ∣Ω⟩ and the fact that (1 ⊗ U )∣Ω⟩ = (U T
states

⊗ 1)∣Ω⟩. Deﬁne the (pure)

∣Ψ⟩ ≡ (

√

σ ⊗ 1)∣Ω⟩,

∣Φ⟩ ≡ (

√ρ ⊗ U T

)∣Ω⟩

(B6)

and note that these states are puriﬁcations of σ and ρ respectively and F(ρ, σ) = ∣⟨Ψ∣Φ⟩∣
⟨A ⊗ 1⟩Ψ = ⟨Ω∣(
√
= Tr[
= ⟨A⟩σ

σ ⊗ 1)(A ⊗ 1)(
σA

σ ⊗ 1)∣Ω⟩

σ]

√

√

√

2. Furthermore, we have

(B7)

and similarly

⟨A ⊗ 1⟩Φ = ⟨Ω∣(
= ⟨Ω∣(
= Tr[
= ⟨A⟩ρ

†

)

√ρ ⊗ (U T
√ρA√ρ ⊗ (U U †
√ρA√ρ]

)(A ⊗ 1)(
)∣Ω⟩
)

T

√ρ ⊗ U T

Replacing A with A2 in the above, we ﬁnd

(∆(A ⊗ 1)Φ)

2

Finally, we have

2
Φ

= ⟨A2
= ⟨A2
= (∆Aρ)

⊗ 1⟩Φ − ⟨A ⊗ 1⟩
⟩ρ − ⟨A⟩
2.

2
ρ

√
σA√ρU ⊗ 1)∣Ω⟩
⟨Ψ∣(A ⊗ 1)∣Φ⟩ = ⟨Ω∣(
√
σA√ρU ]
= Tr[
√
σ, √ρU ⟩HS
= ⟨A

)∣Ω⟩

16

(B8)

(B9)

(B10)

where ⟨⋅, ⋅⟩HS denotes the Hilbert-Schmidt inner product. Without loss of generality, we assume that ⟨Φ∣Ψ⟩ is real and
non-negative since otherwise we can multiply each puriﬁciation by a global phase. Applying the Gramian inequalities
to the observable A ⊗ 1 and the puriﬁcations ∣Ψ⟩, ∣Φ⟩, we ﬁnd

√

F(ρ, σ)⟨A⟩ρ − ∆Aρ

√

1 − F(ρ, σ) = ⟨Φ∣Ψ⟩⟨A ⊗ 1⟩Φ − ∆(A ⊗ 1)Φ
≤ R(⟨Ψ∣(A ⊗ 1)∣Φ⟩)
√
σ, √ρU ⟩HS)
= R(⟨A
≤ ⟨Φ∣Ψ⟩⟨A ⊗ 1⟩Φ + ∆(A ⊗ 1)Φ
F(ρ, σ)⟨A⟩ρ + ∆Aρ

√

√

=

1 − F(ρ, σ).

√

√

2
1 − ∣⟨Φ∣Ψ⟩∣

2
1 − ∣⟨Φ∣Ψ⟩∣

(B11)

Thus, we have shown that inequalities similar to Eq. (7) also hold for mixed states. To ﬁnish the proof, note that by
assumption A ≥ 0 and hence A has a square root A = A1/2A1/2. The Cauchy-Schwarz inequality yields
σ, √ρU ⟩HS∣

σ, √ρU ⟩HS) ≤ ∣⟨A

R(⟨A

√

√
= ∣⟨A1/2√
≤ ∣⟨A1/2√
= ∣Tr[Aσ]∣

1/2

σ, A1/2√ρU ⟩HS∣
σ, A1/2√
σ⟩HS∣
× ∣Tr[Aρ]∣
1/2 leads to

1/2

1/2 .

× ∣⟨A1/2√ρU, A1/2√ρU ⟩HS∣

1/2

Dividing the lower bound in Eq. (B11) by ∣Tr[Aρ]∣

∣Tr[Aσ]∣

1/2

√

≥

√

F(ρ, σ)

⟨A⟩ρ −

√

∆Aρ
√
⟨A⟩ρ

1 − F(ρ, σ)

Under the condition that

√

F(ρ, σ)/(1 − F(ρ, σ)) ≥ ∆Aρ/⟨A⟩ρ, we can square both sides of the inequality

⟨A⟩σ ≥

√

⎛
⎝

F(ρ, σ)

√

⟨A⟩ρ −

√

∆Aρ
√
⟨A⟩ρ

⎞
1 − F(ρ, σ)
⎠

2

= F(ρ, σ)⟨A⟩ρ − 2∆Aρ

√

F(ρ, σ)(1 − F(ρ, σ)) +

1 − F(ρ, σ)
⟨A⟩ρ

(∆Aρ)

2.

Notice that the RHS is monotonically decreasing as F(ρ, σ) decreases. Hence, we can replace the true ﬁdelity by a
lower bound to it. In particular, for (cid:15) ≥ 0 with F(ρ, σ) ≥ 1 − (cid:15) and

(1 − (cid:15))/(cid:15) ≥ ∆Aρ/⟨A⟩ρ we get

√

which is the desired result.

⟨A⟩σ ≥ (1 − 2(cid:15))⟨A⟩ρ − 2

√

(cid:15)(1 − (cid:15))∆Aρ +

(cid:15)⟨A2
⟩ρ
⟨A⟩ρ

(B15)

(B12)

(B13)

(B14)

Appendix C: Proof of Theorem 3

17

Theorem 3 (restated). Let ρ ∈ S(Hd) be a density operator and let A be an arbitrary observable with eigenstate ∣ψ⟩
and eigenvalue λ, A∣ψ⟩ = λ∣ψ⟩. Suppose that (cid:15) ≥ 0 is such that F(ρ, ∣ψ⟩) = ⟨ψ∣ρ∣ψ⟩ ≥ 1 − (cid:15). Then, lower and upper
bounds for λ can be expressed as

⟨A⟩ρ − ∆Aρ

√ (cid:15)

1 − (cid:15) ≤ λ ≤ ⟨A⟩ρ + ∆Aρ

√ (cid:15)

1 − (cid:15)

.

(C1)

Proof. Recall that in the proof of Theorem 2 we have shown that a slight modiﬁcation of the Gramian inequalities
from Eq. (7) also holds for mixed states. Speciﬁcally, we have shown that
√

√

√

√

F(ρ, σ)⟨A⟩ρ − ∆Aρ

1 − F(ρ, σ) ≤ R(⟨A

√

σ, √ρU ⟩HS) ≤

F(ρ, σ)⟨A⟩ρ + ∆Aρ

1 − F(ρ, σ).

(C2)

where ⟨⋅, ⋅⟩HS denotes the Hilbert-Schmidt inner product and U is a unitary such that F(ρ, σ) = ∣⟨Φ∣Ψ⟩∣

2 with

∣Ψ⟩ ≡ (

√

σ ⊗ 1)∣Ω⟩,

∣Φ⟩ ≡ (

√ρ ⊗ U T

)∣Ω⟩.

(C3)

Here, by assumption σ = ∣ψ⟩⟨ψ∣ is pure with ∣ψ⟩ an eigenstate of A with eigenvalue λ, A∣ψ⟩ = λ∣ψ⟩. Note that in this
case

√

⟨A

σ, √ρU ⟩HS = λ ⟨

√

σ, √ρU ⟩HS
√
σ√ρU ]
√
σ√ρU ⊗ 1)∣Ω⟩
σ√ρ ⊗ U T
)∣Ω⟩

√

= λ Tr[
= λ ⟨Ω∣(
= λ ⟨Ω∣(
= λ ⟨Ψ∣Φ⟩

(C4)

where ∣Φ⟩ and ∣Ψ⟩ are the puriﬁcations of ρ and σ given in the proof of Theorem 2 in Eq. (B6). Without loss of
generality, we assume that ⟨Ψ∣Φ⟩ is real and positive, since otherwise each state can be multiplied by a global phase.
√
Dividing each side in Eq. (C2) by ⟨Ψ∣Φ⟩ and noting that

F(ρ, σ) = ⟨Ψ∣Φ⟩ yields

⟨A⟩ρ − ∆Aρ

¿
`
`(cid:192)

1 − F(ρ, σ)
F(ρ, σ)

≤ λ ≤ ⟨A⟩ρ + ∆Aρ

¿
`
`(cid:192)

1 − F(ρ, σ)
F(ρ, σ)

.

(C5)

Since the RHS (LHS) of this inequality is monotonically increasing (decreasing) as F(ρ, σ) decreases, we can replace
the exact ﬁdelity by an upper bound and still get valid bounds. That is, for (cid:15) ≥ 0 with F(ρ, σ) ≥ 1 − (cid:15), we have

⟨A⟩ρ − ∆Aρ

√ (cid:15)

1 − (cid:15) ≤ λ ≤ ⟨A⟩ρ + ∆Aρ

√ (cid:15)

1 − (cid:15)

.

(C6)

which is the desired result.

Appendix D: Lower bounds on the ﬁdelity

Here we give proofs for the ﬁdelity lower bounds reported in Section II F. In the sequel, let H be a Hamiltonian

with spectral decomposition

H =

m
∑
i=0

λiΠi

(D1)

where λi are the eigenvalues (in increasing order), Πi is the projections onto the eigenspace associated with λi and m
is the number of distinct eigenvalues. We write EigH (λi) for the space spanned by eigenvectors of H with eigenvalue
λi. In the following we ﬁrst consider the non-degenerate case, that is when EigH (λ0) is of dimension 1 and treat the
degenerate case separately.

Note that if λ0 is non-degenerate, then we have Π0 = ∣ψ0⟩⟨ψ0∣.

1. Non-degenerate case.

a. Eckart’s Criterion

18

Eckart’s criterion [27] is a method to lower bound the ﬁdelity of an approximate state ρ with one of the ground

states of the Hamiltonian H. We include the proof here completeness. For general H and ρ, note that

and thus

⟨H − λ01d⟩ρ =

m
∑
n=1

(λi − λ0)Tr[Πiρ]

≥ (λ1 − λ0)(1 − ⟨ψ0∣ρ∣ψ0⟩)

⟨ψ0∣ρ∣ψ0⟩ ≥

λ1 − ⟨H⟩ρ
λ1 − λ0

.

b. Eq. (13) & Eq. (14)

(D2)

(D3)

(D4)

The ﬁdelity bound from eq. Eq. (13) has been shown in [30] for pure states. Here, we extend this to mixed states
and will discuss the degenerate case in the next section. Recall that δ is a lower bound on the spectral gap, λ1 −λ0 ≥ δ.
Note that

⟨H⟩ρ = λ0⟨ψ0∣ρ∣ψ0⟩ +

≥ λ0⟨ψ0∣ρ∣ψ0⟩ +

m
∑
i=1
m
∑
i=1

λiTr[Πiρ]

(λ0 + δ)Tr[Πiρ]

(D5)

(D6)

1
Since by assumption λ0 is non-degenerate and ⟨H⟩ρ ≤
2 .
By plugging this lower bound into the Gramian eigenvalue bound (Theorem 3), we recover Weinstein’s lower bound [28]
for mixed states

= λ0⟨ψ0∣ρ∣ψ0⟩ + (λ0 + δ)(1 − ⟨ψ0∣ρ∣ψ0⟩)
= λ0 + δ(1 − ⟨ψ0∣ρ∣ψ0⟩).
1
2 (λ0 + λ1) it follows from Eckart’s condition that ⟨ψ0∣ρ∣ψ0⟩ ≥

(D7)
(D8)

where (∆Hρ)
bound in Eq. (13)

2 is the variance of H. Using this to lower bound λ0 in Eq. (D8) and rearranging terms leads to the

λ0 ≥ ⟨H⟩ρ − ∆Hρ

(D9)

If, on the other hand, we lower bound λ0 in Eq. (13) by the Gramian eigenvalue lower bound (Theorem 3), we obtain
the inequality

⟨ψ0∣ρ∣ψ0⟩ ≥ 1 −

∆Hρ
δ

.

(D10)

⟨ψ0∣ρ∣ψ0⟩ − 1 +

√

∆Hρ
δ

1
⟨ψ0∣ρ∣ψ0⟩

− 1 ≥ 0.

The left hand side can be rewritten as a cubic polynomial in ⟨ψ0∣ρ∣ψ0⟩. Under the assumption that ⟨H⟩ρ ≤
1
2 . It then follows that the inequality is satisﬁed if
we again use Eckart’s condition to ﬁnd that ⟨ψ0∣ρ∣ψ0⟩ ≥

which is the bound given in Eq. (14).

⟨ψ0∣ρ∣ψ0⟩ ≥

1
2

⎛
1 +
⎜
⎝

¿
`
`(cid:192)1 − (

∆Hρ
δ/2 )

2 ⎞
⎟
⎠

2. Degenerate case

(D11)

1
2 (λ0 + λ1)

(D12)

If λ0 is degenerate, then Π0 = ∑

d0
j=0∣ψ0,j⟩⟨ψ0,j∣ where d0 denotes the dimensionality of the eigenspace associated with
λ0. In the following, we ﬁrst show that if ρ is a pure state, then there exists an element ∣ψ⟩ ∈ EigH (λ0) for which each
of the ﬁdelity bounds holds. If, on the other hand, ρ is allowed to be mixed, we construct a simple counterexample
for which the ﬁdelity bounds are violated.

Suppose that ρ is a pure state ρ = ∣φ⟩⟨φ∣. For Eckart’s criterion, an analogous calculation leads to

a. Pure states

d0
∑
j=0

2
∣⟨ψ0,j∣φ⟩∣

≥

λ1 − ⟨H⟩ρ
λ1 − λ0

.

Consider the state

∣ψ⟩ = Γ−1/2

∑
i

⟨ψ0,i∣φ⟩∣ψ0,i⟩, Γ = ∑
i

2
∣⟨ψ0,i∣φ⟩∣

and note that ⟨ψ∣ψ⟩ = 1 and ∣ψ⟩ ∈ EigH (λ0). Furthermore, we have

and hence

2
∣⟨ψ∣φ⟩∣

=

d0
∑
j=0

2
∣⟨ψ0,j∣φ⟩∣

2
∣⟨ψ∣φ⟩∣

≥

λ1 − ⟨H⟩ρ
λ1 − λ0

.

19

(D13)

(D14)

(D15)

(D16)

so that Eckart’s criterion holds in the degenerate case for this particular choice of eigenstate ∣ψ⟩ and for pure ap-
proximation states ∣φ⟩. Using again analogous calculations, we also obtain the extensions of the bounds Eq. (13)
and Eq. (14) for pure approximation state ∣φ⟩ in the degenerate case and for the same choice of eigenstate ∣ψ⟩.

b. Counterexample for mixed states

If the approximation state ρ is allowed to be arbitrarily mixed, the above ﬁdelity bounds do not hold in general.

Indeed, consider the Hamiltonian

H = U ⋅

λ 0 0
0 λ 0
0 0 µ

⎞
⎟
⎠

⎛
⎜
⎝

⋅ U †

(D17)

for arbitrary λ, µ ∈ R with λ < µ and some arbitrary unitary U . Furthermore, let ρ be the maximally mixed state
ρ =

. Thus, for any ∣ψ⟩ we ﬁnd that

13 and note that ⟨H⟩ρ =

2λ+µ
3

1
3

in violation of Eckart’s criterion. To see that we can also construct a counterexample for the other two bounds, we
calculate the variance

⟨ψ∣ρ∣ψ⟩ =

1
3 <

2
3 =

µ − ⟨H⟩ρ
µ − λ

(D18)

and notice that

and similarly

(∆Hρ)

2

= ⟨H 2

⟩ρ − ⟨H⟩

2
ρ =

2
2(µ − λ)
9

⟨ψ∣ρ∣ψ⟩ =

1
3 < 1 −

√
2
3 = 1 −

∆Hρ
δ

⟨ψ∣ρ∣ψ⟩ =

1
3 <

2
3 =

1
2

⎛
1 +
⎜
⎝

¿
`
`(cid:192)1 − (

∆Hρ
δ/2 )

2 ⎞
⎟
⎠

.

(D19)

(D20)

(D21)

Appendix E: Simulations with higher error rates

20

Bond
Distance (Å)

E0

VQE
(SPA)

Fidelity

0.50
0.75
1.00
1.25
1.40
1.50
1.60
1.70
1.75
2.00
2.25
2.50
2.75
3.00
3.25
3.50
3.75
4.00
4.25
4.50
4.75
5.00
5.25

−7.21863 −6.88805 0.642
−7.70845 −7.29597 0.643
−7.90403 −7.49060 0.645
−7.97808 −7.57789 0.642
−7.99541 −7.61078 0.645
−8.00062 −7.62723 0.645
−8.00251 −7.63936 0.646
−8.00213 −7.65290 0.644
−8.00127 −7.65684 0.646
−7.99319 −7.68221 0.644
−7.98161 −7.69596 0.639
−7.96941 −7.70682 0.634
−7.95765 −7.71482 0.632
−7.94669 −7.71586 0.624
−7.93706 −7.72211 0.623
−7.92842 −7.72265 0.613
−7.92096 −7.72526 0.606
−7.91490 −7.72740 0.597
−7.90968 −7.72717 0.583
−7.90590 −7.72953 0.568
−7.90306 −7.73045 0.551
−7.90106 −7.72925 0.527
−7.89982 −7.73207 0.516

Gramian Eigenvalue

Gramian Expectation

SDP

lower bound upper bound

−7.25193
−7.74638
−7.94329
−8.01822
−8.03193
−8.03743
−8.03613
−8.03798
−8.03181
−8.02412
−8.01110
−7.99792
−7.98661
−7.97520
−7.96702
−7.96128
−7.95586
−7.95494
−7.95372
−7.95324
−7.95891
−7.96652
−7.96729

−6.52475
−6.84531
−7.03703
−7.13739
−7.18843
−7.21626
−7.24368
−7.26681
−7.28154
−7.34029
−7.38116
−7.41511
−7.44292
−7.45615
−7.47666
−7.48390
−7.49476
−7.50039
−7.50055
−7.50594
−7.50178
−7.49266
−7.49630

lower bound
−7.32715
−7.83840
−8.03507
−8.10760
−8.12397
−8.12843
−8.12772
−8.12450
−8.12101
−8.10203
−8.08242
−8.06577
−8.04982
−8.06343
−8.09013
−8.10708
−8.11762
−8.13010
−8.14249
−8.15344
−8.16757
−8.18161
−8.18806

lower bound upper bound

−7.34604
−7.86084
−8.05745
−8.12808
−8.14492
−8.14912
−8.14878
−8.14473
−8.14171
−8.12208
−8.10091
−8.08292
−8.06660
−8.07915
−8.11182
−8.13833
−8.16116
−8.18053
−8.19643
−8.21024
−8.22021
−8.22696
−8.23073

−5.78115
−5.93280
−6.10197
−6.23202
−6.30208
−6.34578
−6.40143
−6.45257
−6.49063
−6.63209
−6.75887
−6.85437
−6.94268
−6.96150
−6.95623
−6.94904
−6.94122
−6.93847
−6.93280
−6.92201
−6.92056
−6.91288
−6.91086

TABLE II. Noisy simulations of VQE for ground state energies of LiH(2, 4) with a separable pair approximation ansatz (SPA).
The noise model consists of bitﬂip on single qubit gates and depolarization error on two qubit gates. The error probability for
both noise channels is set to 10%.

21

Bond
Distance (Å)

E0

VQE
(UpCCGSD)

Fidelity

0.50
0.75
1.00
1.25
1.40
1.50
1.60
1.70
1.75
2.00
2.25
2.50
2.75
3.00
3.25
3.50
3.75
4.00
4.25
4.50
4.75
5.00
5.25

−7.21863
−7.70845
−7.90403
−7.97808
−7.99541
−8.00062
−8.00251
−8.00213
−8.00127
−7.99319
−7.98161
−7.96941
−7.95765
−7.94669
−7.93706
−7.92842
−7.92096
−7.91490
−7.90968
−7.90590
−7.90306
−7.90106
−7.89982

−6.66418
−6.99642
−7.17549
−7.27489
−7.30592
−7.34297
−7.37233
−7.39912
−7.41376
−7.47053
−7.51937
−7.55501
−7.58323
−7.60655
−7.62472
−7.64013
−7.65034
−7.66562
−7.68425
−7.69349
−7.70511
−7.70031
−7.70455

0.118
0.120
0.122
0.121
0.107
0.117
0.120
0.120
0.121
0.120
0.120
0.118
0.116
0.116
0.115
0.115
0.103
0.111
0.089
0.089
0.090
0.098
0.077

Gramian Eigenvalue

Gramian Expectation

SDP

lower bound upper bound

−7.71356
−8.30129
−8.49462
−8.56334
−8.61254
−8.56754
−8.53701
−8.52712
−8.51673
−8.46034
−8.41918
−8.38562
−8.36295
−8.33990
−8.32053
−8.31261
−8.33392
−8.31035
−8.34869
−8.35523
−8.35773
−8.36531
−8.45740

−5.61455
−5.69055
−5.85839
−5.98558
−6.00004
−6.12004
−6.20478
−6.26860
−6.31010
−6.48104
−6.62024
−6.72552
−6.80337
−6.87168
−6.92821
−6.96878
−6.96726
−7.02064
−7.01927
−7.03175
−7.05194
−7.03541
−6.95222

lower bound
−7.34604
−7.86084
−8.05745
−8.12808
−8.14492
−8.14912
−8.14878
−8.14473
−8.14171
−8.12208
−8.10091
−8.08292
−8.06660
−8.07915
−8.11182
−8.13833
−8.16116
−8.18053
−8.19643
−8.21024
−8.22021
−8.22696
−8.23073

lower bound upper bound

−7.34604
−7.86084
−8.05745
−8.12808
−8.14492
−8.14912
−8.14878
−8.14473
−8.14171
−8.12208
−8.10091
−8.08292
−8.06660
−8.07915
−8.11182
−8.13833
−8.16116
−8.18053
−8.19643
−8.21024
−8.22021
−8.22696
−8.23073

−5.48348
−5.55101
−5.71484
−5.85695
−5.93376
−5.99011
−6.05390
−6.12434
−6.16141
−6.34924
−6.51810
−6.65920
−6.77282
−6.81481
−6.82651
−6.83591
−6.84353
−6.85062
−6.85685
−6.86264
−6.86835
−6.87387
−6.87932

TABLE III. Noisy simulations of VQE for ground state energies of LiH(2, 4) with an UpCCGSD ansatz. The noise model
consists of bitﬂip on single qubit gates and depolarization error on two qubit gates. The error probability for both noise channels
is set to 10%.

