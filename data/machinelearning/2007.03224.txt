0
2
0
2

l
u
J

0
1

]
T
I
.
s
c
[

2
v
4
2
2
3
0
.
7
0
0
2
:
v
i
X
r
a

Optimal Strategies for Graph-Structured Bandits

Hassan Saber
SequeL Research Group
Inria Lille-Nord Europe & CRIStAL
Villeneuve-d’Ascq, Parc scientiﬁque de la Haute-Borne, France

Pierre Ménard
SequeL Research Group
Inria Lille-Nord Europe & CRIStAL
Villeneuve-d’Ascq, Parc scientiﬁque de la Haute-Borne, France

Odalric-Ambrym Maillard
SequeL Research Group
Inria Lille-Nord Europe & CRIStAL
Villeneuve-d’Ascq, Parc scientiﬁque de la Haute-Borne, France

Editor:

HASSAN.SABER@INRIA.FR

PIERRE.MENARD@INRIA.FR

ODALRIC.MAILLARD@INRIA.FR

Abstract

We study a structured variant of the multi-armed bandit problem speciﬁed by a set of Bernoulli
distributions ν = (νa,b)a∈A,b∈B with means (µa,b)a∈A,b∈B ∈ [0, 1]A×B and by a given weight matrix
ω = (ωb,b(cid:48))b,b(cid:48)∈B, where A is a ﬁnite set of arms and B is a ﬁnite set of users. The weight matrix ω
is such that for any two users b, b(cid:48) ∈ B, maxa∈A |µa,b −µa,b(cid:48)| (cid:54) ωb,b(cid:48). This formulation is ﬂexible
enough to capture various situations, from highly-structured scenarios (ω ∈ {0, 1}B×B) to fully
unstructured setups (ω ≡ 1). We consider two scenarios depending on whether the learner chooses
only the actions to sample rewards from or both users and actions. We ﬁrst derive problem-dependent
lower bounds on the regret for this generic graph-structure that involves a structure dependent linear
programming problem. Second, we adapt to this setting the Indexed Minimum Empirical Divergence
(IMED) algorithm introduced by Honda and Takemura (2015), and introduce the IMED-GS(cid:63) algorithm.
Interestingly, IMED-GS(cid:63) does not require computing the solution of the linear programming problem
more than about log(T ) times after T steps, while being provably asymptotically optimal. Also,
unlike existing bandit strategies designed for other popular structures, IMED-GS(cid:63) does not resort to
an explicit forced exploration scheme and only makes use of local counts of empirical events. We
ﬁnally provide numerical illustration of our results that conﬁrm the performance of IMED-GS(cid:63).

Keywords: Graph-structured stochastic bandits, regret analysis, asymptotic optimality, Indexed
Minimum Empirical Divergence (IMED) algorithm.

1. Introduction

The multi-armed bandit problem is a popular framework to formalize sequential decision making
problems. It was ﬁrst introduced in the context of medical trials (Thompson, 1933, 1935) and later
formalized by Robbins (1952). In this paper, we consider a contextual and structured variant of
the problem, speciﬁed by a set of distributions ν = (νa,b)a∈A,b∈B with means (µa,b)a∈A,b∈B, where
A is a ﬁnite set of arms and B is a ﬁnite set of users. Such ν is called a (bandit) conﬁguration
where each νb = (νa,b)a∈A can be seen as a classical multi-armed bandit problem. The streaming

1

 
 
 
 
 
 
protocol is the following: at each time t (cid:62) 1, the learner deals with a user bt ∈ B and chooses an
arm at ∈ A, based only on the past. We consider two scenarios: either the sequence of users is
deterministic (uncontrolled scenario) or the learner has the possibility to choose the user (controlled
scenario), see Section 1.1. The learner then receives and observes a reward Xt sampled according to
νat,bt conditionally independent from the past. We assume binary rewards: each νa,b is a Bernoulli
distribution Bern(µa,b) with mean µa,b ∈ (0, 1) and we denote by D the set of such conﬁgurations.
The goal of the learner is then to maximize its expected cumulative reward over T rounds, or
equivalently minimize regret given by

R(ν, T ) = Eν

(cid:34) T

(cid:88)

t=1

(cid:35)

max
a∈A

µa,bt − Xt

.

For this problem one can run, for example, a separate instance of a bandit algorithm for each user b,
but we would like to exploit a known structure among the users (which we detail below).

Unstructured bandits The classical bandit problem (when |B| = 1) received increased attention in
the middle of the 20th century. The seminal paper Lai and Robbins (1985) established the ﬁrst lower
bounds on the cumulative regret, showing that designing a strategy that is optimal uniformly over a
given set of conﬁgurations D comes with a price. The study of the lower performance bounds in multi-
armed bandits successfully lead to the development of asymptotically optimal strategies for speciﬁc
conﬁguration sets, such as the KL-UCB strategy (Lai, 1987; Cappé et al., 2013; Maillard, 2018) for
exponential families, or alternatively the DMED and IMED strategies from Honda and Takemura (2011,
2015). The lower bounds from Lai and Robbins (1985), later extended by Burnetas and Katehakis
(1997) did not cover all possible conﬁgurations, and in particular structured conﬁguration sets were
not handled until Agrawal et al. (1989) and then Graves and Lai (1997) established generic lower
bounds. Here, structure refers to the fact that pulling an arm may reveal information that enables
to reﬁne estimation of other arms. Unfortunately, designing efﬁcient strategies that are provably
optimal remains a challenge for many structures at the cost of a high computational complexity.

Structured conﬁgurations Motivated by the growing popularity of bandits in a number of in-
dustrial and societal application domains, the study of structured conﬁguration sets has received
increasing attention over the last few years: The linear bandit problem is one typical illustration
(Abbasi-Yadkori et al., 2011; Srinivas et al., 2010; Durand et al., 2017), for which the linear structure
considerably modiﬁes the achievable lower bound, see Lattimore and Szepesvari (2017). The study
of a unimodal structure naturally appears in the context of wireless communications, and has been
considered in Combes and Proutiere (2014) from a bandit perspective, providing an explicit lower
bound together with a strategy exploiting this structure. Other structures include Lipschitz bandits
(Magureanu et al., 2014), and we refer to the manuscript Magureanu (2018) for other examples, such
as cascading bandits that are useful in the context of recommender systems. Combes et al. (2017)
introduced a generic strategy called OSSB (Optimal Structured Stochastic Bandit), stepping the path
towards generic multi-armed bandit strategies that are adaptive to a given structure.

In this paper, we consider the following structure: For a given weight matrix
Graph-structure
ω = (ωb,b(cid:48))b,b(cid:48)∈B ∈ [0, 1]B×B inducing a metric on B, we assume that for any two users b, b(cid:48) ∈ B,
(cid:12)
(cid:12) (cid:54) ωb,b(cid:48). We see the matrix ω as an adjacency matrix of a
||µb −µb(cid:48)||∞ := maxa∈A
fully connected weighted graph where each vertex represents a user and each weigh ωb,b(cid:48) measures
proximity between two users, hence we call this a “graph structure”. The motivation to study such a

(cid:12)
(cid:12)µa,b −µa,b(cid:48)

2

structure is two-fold. On the one hand, in view of paving the way to solving generic structured bandits,
the graph structure yields nicely interpretable lower bounds that show how ω effectively modiﬁes the
achievable optimal regret and suggests a natural strategy, while being ﬂexible enough to interpolate
between a fully unstructured and a highly structured setup. On the other hand, multi-armed bandits
have been extensively applied to recommender systems: In such systems it is natural to assume
that users may not react arbitrarily differently from each other, but that two users that are "close" in
some sense will also react similarly when presented with the same item (action). Now, the similarity
between any two users may be loosely or accurately known (by studying for instance activities of
users on various social networks and reﬁning this knowledge once in a while): The weight matrix
ω enables to summarize such imprecise knowledge. Indeed ωb,b(cid:48) = 0 means that two users behave
identically, while ωb,b(cid:48) = 1 is not informative on the true similarity (cid:107)µb −µb(cid:48)(cid:107)∞ that can be anything
from arbitrarily small to 1. Hence, studying this structure is both motivated by a theoretical challenge
and more applied considerations. To our knowledge this is the ﬁrst work on graph structure. Other
structured problems such as Clustered bandits (Gentile et al., 2014), Latent bandits (Maillard and
Mannor, 2014), or Spectral bandits (Valko et al., 2014) do not deal with this particular setting.

Goal The primary goal of this paper is to build a provably optimal strategy for this ﬂexible notion
of structure. To do so, we derive lower bounds and use them to build intuition on how to handle
structure, which enables us to establish a novel bandit strategy, that we prove to be optimal. Although
specialized to this structure, the mechanisms leading to the strategy and introduced in the proof
technique are novel and are of independent interest.

Outline and contributions We formally introduce the graph-structure model in Section 1.2. Graph
structure is simple enough while interpolating between a fully unstructured case and highly-structured
settings such as clustered bandits (see Figure 1): This makes it a convenient setting to study structured
multi-armed bandits. In Section 2, we ﬁrst establish in Proposition 5 a lower bound on the asymptotic
number of times a sub-optimal couple must be pulled by any consistent strategy (see Deﬁnition 3),
together with its corresponding lower bound on the regret (see Corollary 8) involving an optimization
problem. In Section 3, we revisit the Indexed Minimum Empirical Divergence (IMED) strategy from
Honda and Takemura (2011) introduced for unstructured multi-armed bandits, and adapt it to the
graph-structured setting, making use of the lower bounds of Section 2. The resulting strategy is
called IMED-GS in the controlled scenario and IMED-GS2 in the uncontrolled scenario. Our analysis
reveals that in view of asymptotic optimality, these strategies may still not optimally exploit the
graph-structure in order to trade-off information gathering and low regret. In order to address this
difﬁculty, we introduce the modiﬁed IMED-GS(cid:63) strategy for the controlled scenario (and IMED-GS(cid:63)
2
in the uncontrolled one). We show in Theorem 11, which is the main result of this paper, that both
2 are asymptotically optimal consistent strategies. Interestingly, IMED-GS(cid:63)
IMED-GS(cid:63) and IMED-GS(cid:63)
does not compute a solution to the optimization problem appearing in the lower bound at each time
step, unlike for instance OSSB introduced for generic structures, but only about log(T ) times after T
steps. Also, if forced exploration does not seem to be avoidable for this problem, IMED-GS(cid:63) does not
make use of an explicit forced exploration scheme but a more implicit one, based on local counters
of empirical events. Up to our knowledge, IMED-GS(cid:63) is the ﬁrst strategy with such properties, in the
context of a structure requiring to solve an optimization problem, that is provably asymptotically
optimal. On a broader perspective, we believe the mechanism used in IMED-GS(cid:63) as well as the
proof techniques could be extended beyond the considered graph-structure, thus opening promising
perspective in order to build structure-adaptive optimal strategies for generic structures. Last, we

3

provide in Section 4 numerical illustrations on synthetic data. They show that IMED-GS(cid:63) is also
numerically efﬁcient in practice, both in terms of regret minimization and computation time; this
contrasts with some bandit strategies introduced for other structures (as in Combes et al. (2017),
Lattimore and Szepesvari (2017)), that in practice suffer from a prohibitive burn-in phase.

1.1 Setting

Let us recall that the goal of the learner is to maximize its expected cumulative reward over T rounds,
or equivalently minimize regret given by

R(ν, T ) = Eν

(cid:34) T

(cid:88)

t=1

(cid:35)

max
a∈A

µa,bt − Xt

.

As mentioned, for this problem one can run, for example, a separate instance of bandit algorithms for
each user b, but we would like to exploit the graph structure. We consider two typical scenarios.

Uncontrolled scenario The sequence of users (bt)t(cid:62)1 is assumed deterministic and does not
depend on the strategy of the learner. At each time step t (cid:62) 1, the user bt is revealed to the learner.

Controlled scenario The sequence of users (bt)t(cid:62)1 is strategy-dependent and at each time step
t (cid:62) 1, the learner has to choose a user bt to deal with, based only on the past.

Both scenarios are motivated by practical considerations: uncontrolled scenario is the most common
setup for recommender systems, while controlled scenario is more natural in case the learner
interacts actively with available users as in advertisement campaigns. In an uncontrolled scenario,
the frequencies of user-arrivals are imposed and may be arbitrary, while in a controlled scenario all
users are available and the learner has to deal with them with similar frequency (even if this means
considering a subset of users). We formalize the notion of frequency in the following deﬁnition.

Deﬁnition 1 (Log-frequency of a user) A sequence of user (bt)t(cid:62)1 has log-frequencies β ∈ [0, 1]B
if, almost surely, the number of times the learner has dealt with user b ∈ B is Nb(T ) = Θ(cid:0)T βb(cid:1)1. In
this case, almost surely we have

∀b ∈ B,

lim
T →∞

log(Nb(T ))
log(T )

= βb .

In an uncontrolled scenario, we assume that the sequence of users (bt)t(cid:62)1 has positive log-frequencies
β ∈ (0, 1]B, with β unknown to the learner. In a controlled scenario, we focus only on strategies
that induce sequences of users with same log-frequencies, hence all equal to 1, independently on the
considered conﬁguration, that is strategies such that, almost surely, Nb(T ) = Θ(T ) for all user b ∈ B.

1.2 Graph Structure

In this section, we introduce the graph structure. We assume that all bandit conﬁgurations ν belong
to a set of the form:

(cid:26)

Dω :=

ν ∈ D : ∀b, b(cid:48) ∈ B, max
a∈A

(cid:12)
(cid:12)µa,b − µa,b(cid:48)

(cid:12)
(cid:12) (cid:54) ωb,b(cid:48)

(cid:27)

,

1. We say that uT = Θ(vT ), if the two sequences uT and vT are equivalent.

4

where ω = (ωb,b(cid:48))b,b(cid:48)∈B ∈ [0, 1]B×B is a weight matrix known to the learner. Intuitively, when the
weights are close to 1, we expect no change to the agnostic situation. But, when the weights are close
to (cid:107)µb −µb(cid:48)(cid:107)∞ := maxa∈A

(cid:12)
(cid:12), we expect signiﬁcantly lower achievable regret.

(cid:12)
(cid:12)µa,b −µa,b(cid:48)

Remark 2 For the speciﬁc case where ωb,b(cid:48) = 0, Dω corresponds to user b and b(cid:48) known to be
perfectly clustered. The weight matrix given in Figure 1 models three smooth clusters of users. Each
cluster is included in a ball of diameter α for the inﬁnite norm (cid:107) · (cid:107)∞.

In the sequel we assume the following properties on the weights.

Assumption 1 (Metric weight property) The weight matrix ω satisﬁes:

- ωb,b = 0 and ωb,b(cid:48) > 0 for all b (cid:54)= b(cid:48) ∈ B,
- ωb,b(cid:48) = ωb(cid:48),b and ωb,b(cid:48) (cid:54) ωb,b(cid:48)(cid:48) +ωb(cid:48)(cid:48),b(cid:48) for all b, b(cid:48), b(cid:48)(cid:48) ∈ B.

This comes without loss of generality, since for the ﬁrst property, if two users share exactly the
same distribution we can see them as one unique user. For the second property, considering
(cid:101)ωb,b(cid:48) = supa∈A,ν∈Dω
(cid:101)ω and it holds
(cid:101)ωb,b(cid:48) = (cid:101)ωb(cid:48),b, (cid:101)ωb,b(cid:48) (cid:54)

(cid:12)
(cid:12)µa,b −µa,b(cid:48)
(cid:101)ωb,b(cid:48)(cid:48) + (cid:101)ωb(cid:48)(cid:48),b(cid:48). Such a weight matrix ω naturally induces a metric on B2.

(cid:12)
(cid:12) leads to the same set of conﬁguration Dω = D














0

(α)

. . .

(α)

0

(1)

0

(α)

. . .

(α)

0














(1)

0

(α)

. . .

(α)

0

Figure 1: A cluster structure. Left: weight matrix of three clusters. Right: range of two armed bandit
problems included in clusters with center (ν1, ν2, ν3) for various α (the larger α the lighter
and larger the box). The value α = 0 corresponds to perfect clusters.

1.3 Notations

b = maxa∈A µa,b denote the optimal mean for user b and A(cid:63)

Let µ(cid:63)
b = argmaxa∈A µa,b the set of
optimal arms for this user. We deﬁne for a couple (a, b) ∈ A×B its gap ∆a,b = µ(cid:63)
b −µa,b. Thus
a couple is optimal if its gap is equal to zero and sub-optimal if it is positive. We denote by
O(cid:63) = {(a, b) ∈ A×B : µa,b = µ(cid:63)
b } the set of optimal couples. Thanks to the chain rule we can rewrite
the regret as follows:

R(ν, T ) =

(cid:88)

∆a,b Eν

(cid:2)Na,b(T )(cid:3) , where Na,b(t) =

a,b∈A×B

t
(cid:88)

s=1

I(cid:8)(as,bs)=(a,b)(cid:9)

is the number of pulls of arm a and user b up to time t.

5

μ1,bμ2,b0ν1ν2ν32. Regret Lower bound

In this subsection, we establish lower bounds on the regret for the structure Dω. In order to obtain
non trivial lower bounds we consider, as in the classical bandit problem, strategies that are consistent
(uniformly good) on Dω.

Deﬁnition 3 (Consistent strategy) A strategy is consistent on Dω if for all conﬁguration ν ∈ Dω,
for all sub-optimal couple (a, b), for all α > 0,

lim
T →∞

Eν

(cid:21)

(cid:20) Na,b(T )
Nb(T )α

= 0 .

Remark 4 When B = {b}, Nb(T ) = T and we recover the usual notion of consistency (Lai and
Robbins, 1985).

Before we provide below the lower bound on the cumulative regret, let us give some intuition: To
that end, we ﬁx a conﬁguration ν ∈ Dω and a sub-optimal couple (a, b). One key observation is that
if for all b(cid:48) ∈ B it holds µ(cid:63)
b −µa,b(cid:48) < ωb,b(cid:48), this means we can form an environment (cid:101)ν ∈ Dω such that
(cid:101)µa(cid:48),b(cid:48) = µa(cid:48),b(cid:48) for all couples (a(cid:48), b(cid:48)) except (a, b), and such that (cid:101)µa,b satisﬁes µ(cid:63)
b < (cid:101)µa,b < µa,b(cid:48) +ωb,b(cid:48).
Indeed, in this novel environment, (cid:101)µa,b− (cid:101)µa,b(cid:48) < ωb,b(cid:48) still holds but (a, b) is now optimal. Hence, we
can transform the sub-optimal couple (a, b) in an optimal one without moving the means of the other
users. Thanks to this remarkable property, and introducing kl(µ|µ(cid:48)) to denote the Kullback-Leibler
divergence between two Bernoulli distributions Bern(µ) and Bern(µ(cid:48)) with the usual conventions,
one can prove then that for all consistent strategy

lim inf
T →∞

Eν

(cid:20) Na,b(T )
log(Nb(T ))

(cid:21)

(cid:62)

1
kl(µa,b|µ(cid:63)
b )

,

which is the lower bound that we get without graph structure. This suggests that only the users b(cid:48) such
that µ(cid:63)
b −µa,b(cid:48) > ωb,b(cid:48) provide information about the behavior of user b. This justiﬁes to introduce for
each couple (a, b) the fundamental set

Ba,b := (cid:8)b(cid:48) ∈ B : µa,b(cid:48) < µ(cid:63)

b − ωb,b(cid:48)

(cid:9) .

(cid:9). Now, in
It is also convenient to introduce its frontier, denoted ∂Ba,b := (cid:8)b(cid:48) ∈ B : µa,b(cid:48) = µ(cid:63)
order to report the lower bounds while avoiding tedious technicalities, we slightly restrict the set Dω.
To this end, we introduce the set

b −ωb,b(cid:48)

Dω := (cid:8)ν ∈ Dω : ∀(a, b) ∈ A × B, ∂Ba,b = ∅(cid:9) .

This deﬁnition is justiﬁed since the closure of Dω is indeed Dω (we only remove from Dω sets of
empty interior). We can now state the following proposition.

Proposition 5 (Graph-structured lower bounds on pulls) Let us consider a consistent strategy.
Then, for all conﬁguration ν ∈ Dω, almost surely it holds for all sub-optimal couple (a, b) /∈ O(cid:63),

lim
T →∞

Nb(T ) < +∞ or

lim inf
T →∞

1
log(Nb(T ))

(cid:88)

b(cid:48)∈Ba,b

kl(cid:0)µa,b(cid:48)

(cid:12)
(cid:12)µ(cid:63)

b − ωb,b(cid:48)

(cid:1) Na,b(cid:48)(T ) (cid:62) 1 .

(1)

6

We then introduce the notion of Pareto-optimality based on the lower bounds given in Proposition 5.

Deﬁnition 6 (Pareto-optimality) A strategy is asymptotically Pareto-optimal if for all ν ∈ Dω,

∀a ∈ A,

lim sup
T →∞

min
b: (a,b) /∈O(cid:63)

1
log(Nb(T ))

(cid:88)

b(cid:48)∈Ba,b

kl(cid:0)µa,b(cid:48)

(cid:12)
(cid:12)µ(cid:63)

b − ωb,b(cid:48)

(cid:1) Na,b(cid:48)(T ) (cid:54) 1 ,

with the convention min∅ = −∞.

Remark 7 This proposition reveals that the set Ba,b = (cid:8)b(cid:48) ∈ B : µa,b(cid:48) < µ(cid:63)
(cid:9) plays a crucial
role in the graph structure. The deﬁnition of Dω excludes speciﬁc situations when there exists b, b(cid:48) ∈ B,
a ∈ A, ωb,b(cid:48) = µ(cid:63)
b −µa,b(cid:48) = ∆a,b +µa,b −µa,b(cid:48), that belong to the close set Dω. Extending the result to
Dω seems possible but at the price of clarity due to the need to handle degenerate cases.

b −ωb,b(cid:48)

In order to derive an asymptotic lower bound on the regret from these asymptotic lowers bounds, we
have to characterize the growth of the counts (Nb(·))b∈B.

Corollary 8 (Lower bounds on the regret) Let us consider a consistent strategy and sequences of
users with log-frequencies β ∈ (0, 1]B independently of the considered conﬁguration in Dω. Then,
for all conﬁguration ν ∈ Dω

lim inf
T →∞

R(ν, T )
log(T )

(cid:62) C(cid:63)

ω(β, ν) := min

(cid:26) (cid:88)

a,b /∈O(cid:63)

∆a,b na,b : n ∈ RA×B

+

s.t. ∀(a, b) /∈ O(cid:63),

(cid:88)

kl(cid:0)µa,b(cid:48)

(cid:12)
(cid:12)µ(cid:63)

b − ωb,b(cid:48)

(cid:1) na,b(cid:48) (cid:62) βb

b(cid:48)∈Ba,b

(2)

(cid:27)

.

Hence such a strategy is asymptotically optimal if for all ν ∈ Dω

lim sup
T →∞

R(ν, T )
log(T )

(cid:54) C(cid:63)

ω(β, ν) .

Remark 9 In the previous corollary, log-frequencies β may be either strategy dependent or indepen-
dent. In an uncontrolled scenario, β is imposed by the setting and does not depend on the followed
strategy, while in a controlled scenario we consider strategies that impose β = 1B := (1)b∈B.

Like other structured bandit problems (as in Combes et al. (2017), Lattimore and Szepesvari (2017))
this lower bound is characterized by a problem-dependent constant C(cid:63)
ω(β, ν) solution to an optimiza-
tion problem. In the agnostic case we recover the lower bound of the classical multi-armed bandit
problem. Indeed, let us introduce for α ∈ [0, 1] the weight matrix ωα where all the weights are equal
to α (except for the zero diagonal). ωα is the same weight matrix as in Figure 1 but only for one
cluster. Then when there is no structure (ω ≡ ω1), we obtain the explicit constant

C(cid:63)

ω1(β, ν) =

(cid:88)

βb

(cid:88)

b∈B

a∈A: (a,b) /∈O(cid:63)

∆a,b
kl(µa,b|µ(cid:63)
b )

,

(3)

7

that corresponds to solving |B| bandit problems in parallel (independently the ones from the
others). Thus the graph structure allows to interpolate smoothly between |B| independent ban-
dit problems and a unique one when all the users share the same distributions. In order to il-
lustrate the gain of information due to the graph structure we plot in Figure 2 the expectation
ω1(1B, ν)(cid:3) of the ratio between the constant in the structured case (2) and
Eν∼U (Dωα )
that in the agnostic case (3), where U(Dωα) denotes the uniform distribution over Dωα, α ∈ [0, 1].

ωα(1B, ν)/C(cid:63)

(cid:2)C(cid:63)

Figure 2: Plot of α (cid:55)→ Eν∼U (Dωα )

ω1(1B, ν)(cid:3) where ωα is a matrix where all the
weights are equal to α (except for the zero diagonal) and ν is sampled uniformly at random
in Dωα.

ωα(1B, ν)/C(cid:63)

(cid:2)C(cid:63)

3. IMED type strategies for Graph-structured Bandits

In this section, we present for both the controlled and uncontrolled scenarios, two strategies: IMED-GS(cid:63)
that matches the asymptotic lower bound of Corollary 8 and IMED-GS with a lower computational
complexity but weaker guaranty. Both are inspired by the Indexed Minimum Empirical Divergence
(IMED) proposed by Honda and Takemura (2011). The general idea behind this algorithm is to
enforce, via a well chosen index, the constraints (1) that appears in the optimization problem (2) of
the asymptotic lower bound. These constraints intuitively serve as tests to assert whether or not a
couple is optimal.

3.1 IMED type strategies for the controlled scenario

We consider the controlled scenario where the sequence of users (bt)t(cid:62)1 is strategy-dependent and at
each time step t (cid:62) 1, the learner has to choose a user bt and an arm at, based only on the past.

3.1.1 THE IMED-GS STRATEGY.

I{(as,bs)=(a,b)}Xs if Na,b(t) > 0, 0 otherwise, the empirical mean
We denote by (cid:98)µa,b(t) = 1
of the rewards from couple (a, b). Guided by the lower bound (1) we generalize the IMED index to

Na,b(t)

t
(cid:80)
s=1

8

take into account the graph structure as follows. For a couple (a, b) and at time t we deﬁne

Ia,b(t) =

(cid:40) log(Na,b(t))
kl(cid:0)
(cid:80)

b(cid:48)∈ (cid:98)Ba,b(t)

(cid:98)µa,b(cid:48)(t)(cid:12)

(cid:12)(cid:98)µ(cid:63)

b (t) − ωb,b(cid:48)

(cid:1) Na,b(cid:48)(t) + log(cid:0)Na,b(cid:48)(t)(cid:1) otherwise

if (a, b) ∈ (cid:98)O(cid:63)(t)

, (4)

where (cid:98)µ(cid:63)

b (t) = maxa∈A (cid:98)µa,b(t) is the current best mean for user b, the current set of optimal couple is

(cid:26)

(cid:98)O(cid:63)(t) :=

(a, b) ∈ A × B : (cid:98)µa,b(t) = (cid:98)µ(cid:63)

b (t)

(cid:27)

and the current set of informative users for an empirical sub-optimal couple (a, b) is

(cid:26)

(cid:98)Ba,b(t) :=

b(cid:48) ∈ B : Na,b(cid:48)(t) > 0 and (cid:98)µa,b(cid:48)(t) < (cid:98)µ(cid:63)

b (t) − ωb,b(cid:48)

(cid:27)

.

This quantity can be seen as a transportation cost for “moving2” a sub-optimal couple to an optimal
one, plus exploration terms (the logarithms of the numbers of pulls). When an optimal couple is
considered, the transportation cost is null and only the exploration part remains. Note that, as stated
in Honda and Takemura (2011), Ia,b(t) is an index in the weaker sense since it is not determined only
by samples from the couple (a, b) but also uses empirical means of current optimal arms. We deﬁne
IMED-GS (Indexed Minimum Empirical Divergence for Graph Structure) to be the strategy consisting
of pulling a couple with minimum index in Algorithm 1. It works well in practice, see Section 4, and
has a low computational complexity (proportional to the number of couples). However, it is known
for other structures, see Lattimore and Szepesvari (2017), that such greedy strategy does not exploit
optimally the structure of the problem. Indeed, at a high level, pulling an apparently sub-optimal
couple (a, b) allows to gather information not only about this particular couple but also about other
couples due to the structure. In order to attain optimality one needs to ﬁnd couples that provide the
best trade-off between information and low regret. This is exactly what is done in the optimization
problem (2).

3.1.2 THE IMED-GS(cid:63) STRATEGY

In order to address this difﬁculty we ﬁrst, thanks to the (weak) indexes, decide whether we need to
exploit or explore. In the second case, in order to explore optimally according to the graph structure
we solve the optimization problem (2) parametrized by the current estimates of the means and then
track the optimal numbers of pulls given by the solution of this problem. More precisely at each
round we choose but not immediately pull a couple with minimum index

(at, bt) ∈ argmin
(a,b)∈A×B

Ia,b(t) .

Exploitation: If this couple is currently optimal, (at, bt) ∈ (cid:98)O(cid:63)(t), we exploit, that is pull this couple.
Exploration: Else we explore arm at+1 = at. To this end, let nopt(t) be a solution of the empirical

2. This notion refers to the generic proof technique used to derive regret lower bounds. It involves a change-of-measure
argument, from the initial conﬁguration in which the couple is sub-optimal to another one chosen to make it optimal.

9

version of (2) with β = 1B, that is

nopt(t) ∈ argmin
n∈RA×B
+

(cid:26) (cid:88)

(a,b)∈A×B

(cid:0)

b (t) − (cid:98)µa,b(t)(cid:1) na,b
(cid:98)µ(cid:63)

s.t.

∀(a, b) /∈ (cid:98)O(cid:63)(t), (cid:98)Ba,b(t) (cid:54)= ∅ :

(cid:88)

kl(cid:0)

b(cid:48)∈ (cid:98)Ba,b(t)

The current optimal numbers of pulls given by

(cid:98)µa,b(cid:48)(t)(cid:12)

(cid:12)(cid:98)µ(cid:63)

b (t) − ωb,b(cid:48)

N opt

a,b (t) = nopt

a,b(t) min
b(cid:48)∈B

Ia,b(cid:48)(t) .

We then track

bt+1 ∈

argmax
b∈ (cid:98)Bat,bt (t)∪{bt}

N opt

at,b(t) − Nat,b(t) .

(cid:1) na,b(cid:48) (cid:62) 1

(5)

(cid:27)

.

(6)

(7)

Asymptotically, we expect that all the sub-optimal couples are pulled roughly log(T ) times. There-
fore, for all sub-optimal couple (a, b), the index Ia,b(T ) should be of order log(T ). Thus we
asymptotically recover in the deﬁnition of N opt
a,b (·) the optimal number of pulls of couple (a, b), that
is nν
a,b log(T ) as suggested in Corollary 8. Finally we pull the selected couple (at+1, bt+1). In order
to ensure optimality, however, such a direct tracking of the current optimal number of pulls is still
a bit too aggressive and we need to force exploration in some exploration rounds. We proceed as
follows: when we explore arm at we automatically pull a couple (at, b) if its number of pulls Na(t),b
is lower than the logarithm of the number of time we decided to explore this arm. See Algorithm 2
for details. This does not hurt the asymptotic optimally because we expect to explore a sub-optimal
arm not more than log(T ) times. On the bright side, this is still different than the traditional forced
exploration. Indeed, only few rounds are dedicated to exploration thanks to the ﬁrst selection with
the indexes and among them only a logarithmic number will consist of pure exploration: Thus, we
expect an overall log log(T ) rounds of forced exploration. Note also that all the quantities involved in
this forced exploration use empirical counters. Putting all together we end up with strategy IMED-GS(cid:63)
described in Algorithm 2.

IMED-GS(cid:63) combines ideas from IMED introduced by Honda and
Comparison with other strategies
Takemura (2011) and from OSSB by Combes et al. (2017). More precisely, it generalizes the index
from IMED to the graph structure. From OSSB it borrows the tracking of the optimal counts given
by the asymptotic lower bound (see also Lattimore and Szepesvari (2017)) and the way to force
exploration sparingly. The main difference with OSSB is that IMED-GS(cid:63) leverages the indexes to deal
with the exploitation-exploration trade-off. In particular IMED-GS(cid:63)does not need to solve at each
round the optimization problem (2). This greatly improves the computational complexity. Also, note
that OSSB requires choosing a tuning parameter that must be positive to ensure theoretical guarantees
but that must be set equal to 0 to work well in practice. This is not the case for IMED-GS(cid:63) that requires
no parameter tuning and that works well both in theory and in practice (see Section 4).

3.2 IMED type strategies for the uncontrolled scenario

In this section, an uncontrolled scenario is considered where the sequence of users (bt)t(cid:62)1 is assumed
deterministic and does not depend on the strategy of the learner. We adapt the two previous strategies
IMED-GS and IMED-GS(cid:63) to this scenario.

10

Algorithm 1 IMED-GS (controlled scenario)
Require: Weight matrix (ωb,b(cid:48))b,b(cid:48)∈B.

for t = 1...T do

Pull (at+1, bt+1) ∈ argmin
(a,b)∈A×B

Ia,b(t)

end for

Algorithm 2 IMED-GS(cid:63) (controlled scenario)
Require: Weight matrix (ωb,b(cid:48))b,b(cid:48)∈B.

∀a ∈ A,
for For t = 1...T do

ca, c+

a ← 1

Choose (at, bt) ∈ argmin
(a,b)∈A×B

Ia,b(t)

if (at, bt) ∈ (cid:98)O(cid:63)(t) then

Choose (at+1, bt+1) = (at, bt)

else

Set at+1 = at
if cat+1 = c+

at+1 then
at+1

← 2c+

c+
at+1
Choose bt+1 ∈ argmin

else

Na,b(t)

b∈B

Choose bt+1∈ argmax

N opt

at+1,b(t)−Nat+1,b(t)

b∈ (cid:98)Bat,bt (t)∪{bt}

end if
cat+1 ← cat+1 + 1

end if
Pull (at+1, bt+1)

end for

IMED-GS2 strategy At time step t (cid:62) 1 the choice of user bt is no longer strategy-dependent but is
imposed by the sequence of users (bt)t(cid:62)1 which is assumed to be deterministic in the uncontrolled
scenario. The learner only chooses an arm to pull at knowing user bt. We deﬁne IMED-GS2 to be the
strategy consisting of pulling an arm with minimum index in Algorithm 3 of Appendix C. IMED-GS2
suffers the same advantages and shortcomings as IMED-GS. It does not exploit optimally the structure
of the problem but it works well in practice, see Section 4, and has a low computational complexity.

IMED-GS(cid:63)
2 strategy In order to explore optimally according to the graph structure in the uncontrolled
scenario, we also track the optimal numbers of pulls. β may be at ﬁrst glance different from 1B.
This requires some normalizations. First, for all time step t (cid:62) 1, nopt(t) now denotes a solution of
the empirical version of (2) with β = ( (cid:98)βb(t))b∈B where (cid:98)βb(t) =log(Nb(t))/ log(t) estimates log-
frequency βb of user b ∈ B. Second, we have to consider normalized indexes (cid:101)Ia,b(t) = Ia,b(t)/ (cid:98)βb(t)
for couples (a, b) ∈ A × B in order to have (cid:101)Ia,b(T ) ∼ log(T ) as in the controlled scenario. An
additional difﬁculty is that at a given time step t (cid:62) 1, while the indexes indicate to explore, the current
tracked user (see Equation 7) given is likely to be different from user bt with whom the learner deals.
This difﬁculty is easy to circumvent by postponing and prioritizing the exploration until the learner
deals with the tracked user. Priority in exploration phases is given to ﬁrst delayed forced-exploration
and delayed exploration based on solving optimization problem (2), then exploration based on current
indexes (see Algorithm 4 in Appendix C). IMED-GS(cid:63)
2 corresponds essentially to IMED-GS(cid:63) with some
delays due to the fact that the tracked and the current users may be different. This has no impact on
the optimality of IMED-GS(cid:63)

2 since log-frequencies of users are enforced to be positive.

3.3 Asymptotic optimality of IMED type strategies

In order to prove the asymptotic optimality of IMED-GS(cid:63) we introduce the following mild assumptions
on the conﬁguration considered.

11

Deﬁnition 10 (Non-peculiar conﬁguration) A conﬁguration ν ∈ Dω is non-peculiar if the optimiza-
tion problem (2) admits a unique solution and each user b admits a unique optimal arm a(cid:63)
b .

In Theorem 11 we state the main result of this paper, namely, the asymptotic optimality of IMED-GS(cid:63)
2. We prove this result for IMED-GS(cid:63) in Appendix E and adapt this proof in Appendix G
and IMED-GS(cid:63)
for IMED-GS(cid:63)
2. Please refer to Proposition 20 (Appendix D) for more reﬁned ﬁnite-time upper bounds.
As a byproduct of this analysis we deduce the Pareto-optimality of IMED-GS and IMED-GS2 stated in
Proposition 12 and proved in Appendix G.

Theorem 11 (Asymptotic optimality) Both IMED-GS(cid:63) and IMED-GS(cid:63)
2 are consistent strategies. Fur-
ther, they are asymptotically optimal on the set of non-peculiar conﬁgurations, that is, for all ν ∈ Dω
non-peculiar, under IMED-GS(cid:63) the sequence of users has log-frequencies 1B and we have

lim sup
T →∞

R(ν, T )
log(T )

(cid:54) C(cid:63)

ω(1B, ν) ,

and, under IMED-GS(cid:63)

2, assuming a sequence of users with log-frequencies β ∈ (0, 1]B, we have

lim sup
T →∞

R(ν, T )
log(T )

(cid:54) C(cid:63)

ω(β, ν) .

Proposition 12 (Asymptotic Pareto-optimality) Both IMED-GS and IMED-GS2 are consistent strate-
gies. Further, they are asymptotically Pareto-optimal on the set of non-peculiar conﬁgurations, that
is, under IMED-GS or IMED-GS2, for all ν ∈ Dω non-peculiar,

∀a ∈ A,

lim sup
T →∞

min
b: (a,b) /∈O(cid:63)

1
log(Nb(T ))

(cid:88)

b(cid:48)∈Ba,b

kl(µa,b(cid:48)|µ(cid:63)

b − ωb,b(cid:48))Na,b(cid:48)(T ) (cid:54) 1 .

Discussion Removing forced exploration remains the most challenging task for structured bandit
problems. In the context of this structure, forced exploration would have been to use criteria like "if
Na,b(T ) < (cid:98)ca,b(T ) log(T ), then pull couple (a, b)" for some constants (cid:98)ca,b(T ) that depends on the
minimization problem coming from the lower bound and where (cid:98)ca,b(T ) log(T ) can be interpreted
as an estimator of the theoretical asymptotic lower bound on the numbers of pulls of couple (a, b).
In stark contrast, in IMED-GS(cid:63) there is no forced exploration in choosing the arm to explore and, in
choosing the user to explore, the used criteria is more intrinsic as it reads "if Na,b(T ) < (cid:98)ca,b(T )Ia(T ),
then pull couple (a, b)", where Ia(T ) ∼ log(T ) but really depends on (Na,b(T ))(a,b) /∈C(cid:63). Thus, the
used criteria are not asymptotic, and do not dependent on the time t but on the current numbers
of pull of sub-optimal arms. Since theoretical asymptotic lower bounds on the numbers of pulls
are signiﬁcantly larger than the current numbers of pulls in ﬁnite horizon (see Figure 3), IMED-GS(cid:63)
strategy is also expected to behave better than strategies based on usual (conservative) forced
exploration. Although entirely removing forced exploration would be nicer, in IMED-GS(cid:63), forced
exploration is only done in a sparing way.

4. Numerical experiments

In this section, we compare empirically the following strategies introduced beforehand: IMED-GS and
IMED-GS(cid:63) described respectively in Algorithms 1, 2, IMED-GS2 and IMED-GS(cid:63)
2 described respectively

12

in Algorithms 3, 4 and the baseline IMED by Honda and Takemura (2011) that does not exploit the
structure. We compare these strategies on two setups, each with |B| = 10 users and |A| = 5 arms.
For the uncontrolled scenario we consider the round-robin sequence of users. As expected the
strategies leveraging the graph structure perform better than the baseline IMED that does not exploit
it. Furthermore, the plots suggest that IMED-GS and IMED-GS(cid:63) (respectively IMED-GS2 and IMED-GS(cid:63)
2)
perform similarly in practice.

Figure 3: Left – For these experiments we investigate these strategies on
Fixed conﬁguration
a ﬁxed conﬁguration. The weight matrix ω and the conﬁguration ν ∈ Dω are given in Appendix I.
This enables us to plot also the asymptotic lower bound on the regret for reference: We plot
the unstructured lower bound (LB_agnostic) in dashed red line, and the structured lower bound
(LB_struct) in dashed blue line.

Figure 3: Right – In these experiments we average regrets over random
Random conﬁgurations
conﬁgurations. We proceed as follows: At each run we sample uniformly at random a weight matrix
ω and then sample uniformly at random a conﬁguration ν ∈ Dω.

Figure 3: Regret approximated over 1000 runs. Top: controlled scenario. Bottom: uncontrolled
scenario, (bt)t(cid:62)1 is the round-robin sequence of users. Left: Fixed conﬁguration. Right:
Random conﬁgurations.

Additional experiments in Appendix I conﬁrm that both IMED-GS and IMED-GS(cid:63) induce sequences of
users with log-frequencies all equal to 1.

Acknowledgments

13

This work was supported by CPER Nord-Pas de Calais/FEDER DATA Advanced data science and
technologies 2015-2020, the French Ministry of Higher Education and Research, the French Agence
Nationale de la Recherche (ANR) under grant ANR-16- CE40-0002 (project BADASS), and Inria
Lille – Nord Europe.

14

References

Yasin Abbasi-Yadkori, Dávid Pál, and Csaba Szepesvári. Improved algorithms for linear stochastic

bandits. In Advances in Neural Information Processing Systems, pages 2312–2320, 2011.

Rajeev Agrawal, Demosthenis Teneketzis, and Venkatachalam Anantharam. Asymptotically efﬁ-
cient adaptive allocation schemes for controlled iid processes: Finite parameter space. IEEE
Transactions on Automatic Control, 34(3), 1989.

Apostolos N. Burnetas and Michael N. Katehakis. Optimal adaptive policies for Markov decision

processes. Mathematics of Operations Research, 22(1):222–255, 1997.

Olivier Cappé, Aurélien Garivier, Odalric-Ambrym Maillard, Rémi Munos, and Gilles Stoltz.
Kullback–Leibler upper conﬁdence bounds for optimal sequential allocation. Annals of Statistics,
41(3):1516–1541, 2013.

Richard Combes and Alexandre Proutiere. Unimodal bandits: Regret lower bounds and optimal

algorithms. In International Conference on Machine Learning, 2014.

Richard Combes, Stefan Magureanu, and Alexandre Proutiere. Minimal exploration in structured
stochastic bandits. In Advances in Neural Information Processing Systems, pages 1763–1771,
2017.

Audrey Durand, Odalric-Ambrym Maillard, and Joelle Pineau. Streaming kernel regression with
provably adaptive mean, variance, and regularization. arXiv preprint arXiv:1708.00768, 2017.

Claudio Gentile, Shuai Li, and Giovanni Zappella. Online clustering of bandits. In International

Conference on Machine Learning, pages 757–765, 2014.

Todd L Graves and Tze Leung Lai. Asymptotically efﬁcient adaptive choice of control laws
incontrolled markov chains. SIAM journal on control and optimization, 35(3):715–743, 1997.

Junya Honda and Akimichi Takemura. An asymptotically optimal policy for ﬁnite support models in

the multiarmed bandit problem. Machine Learning, 85(3):361–391, 2011.

Junya Honda and Akimichi Takemura. Non-asymptotic analysis of a new bandit algorithm for

semi-bounded rewards. Machine Learning, 16:3721–3756, 2015.

Tze Leung Lai. Adaptive treatment allocation and the multi-armed bandit problem. The Annals of

Statistics, pages 1091–1114, 1987.

Tze Leung Lai and Herbert Robbins. Asymptotically efﬁcient adaptive allocation rules. Advances in

applied mathematics, 6(1):4–22, 1985.

Tor Lattimore and Csaba Szepesvari. The end of optimism? an asymptotic analysis of ﬁnite-armed

linear bandits. In Artiﬁcial Intelligence and Statistics, pages 728–737, 2017.

Stefan Magureanu. Efﬁcient Online Learning under Bandit Feedback. PhD thesis, KTH Royal

Institute of Technology, 2018.

15

Stefan Magureanu, Richard Combes, and Alexandre Proutiere. Lipschitz bandits: Regret lower

bounds and optimal algorithms. Machine Learning, 35:1–25, 2014.

O-A Maillard. Boundary crossing probabilities for general exponential families. Mathematical

Methods of Statistics, 27(1):1–31, 2018.

Odalric-Ambrym Maillard and Shie Mannor. Latent bandits. In International Conference on Machine

Learning, pages 136–144, 2014.

H. Robbins. Some aspects of the sequential design of experiments. Bulletin of the American

Mathematics Society, 58:527–535, 1952.

Niranjan Srinivas, Andreas Krause, Sham Kakade, and Matthias Seeger. Gaussian process opti-
mization in the bandit setting: no regret and experimental design. In Proceedings of the 27th
International Conference on International Conference on Machine Learning, pages 1015–1022.
Omnipress, 2010.

William R Thompson. On the likelihood that one unknown probability exceeds another in view of

the evidence of two samples. Biometrika, 25(3/4):285–294, 1933.

William R Thompson. On a criterion for the rejection of observations and the distribution of the ratio
of deviation to sample standard deviation. The Annals of Mathematical Statistics, 6(4):214–219,
1935.

Michal Valko, Rémi Munos, Branislav Kveton, and Tomáš Kocák. Spectral bandits for smooth graph

functions. In International Conference on Machine Learning, 2014.

16

Contents

1

Introduction
1.1 Setting .
.
1.2 Graph Structure .
.
1.3 Notations

.

.

.

.

.

.

.

.
.
.

.
.
.

.
.
.

.
.
.

.
.
.

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

2 Regret Lower bound

3

IMED type strategies for Graph-structured Bandits
3.1

IMED type strategies for the controlled scenario . . . . . . . . . . . . . . . . . . .
3.1.1 The IMED-GS strategy.
. . . . . . . . . . . . . . . . . . . . . . . . . . . .
3.1.2 The IMED-GS(cid:63) strategy . . . . . . . . . . . . . . . . . . . . . . . . . . . .
IMED type strategies for the uncontrolled scenario . . . . . . . . . . . . . . . . . .
. . . . . . . . . . . . . . . . . . .

3.2
3.3 Asymptotic optimality of IMED type strategies

4 Numerical experiments

A Notations and reminders

B Proof related to the regret lower bound (Section 2)

B.1 Almost sure asymptotic lower bounds under consistent strategies . . . . . . . . . .
. . .
T ) tends to 0 when T tends to inﬁnity . . . . . . . . . . . . . .
B.2 Asymptotic lower bounds on the regret . . . . . . . . . . . . . . . . . . . . . . . .

(cid:3) tends to 0 when T tends to inﬁnity . . . . . . .

B.1.1 E
(cid:101)ν
B.1.2 Pν(ΩT ∩ Ec

(cid:2)Nb(T )1−αI{ΩT }

C Algorithms for the uncontrolled scenario

D IMED-GS(cid:63): Finite-time analysis

D.1 Strategy-based empirical bounds . . . . . . . . . . . . . . . . . . . . . . . . . . .
D.2 Reliable current best arm and means . . . . . . . . . . . . . . . . . . . . . . . . .
.
D.3 Pareto-optimality and upper bounds on the numbers of pulls of sub-optimal arms
D.4 IMED-GS(cid:63) is consistent and induces sequences of users with log-frequencies 1B
. .
D.5 The counters ca and c+
a coincide at most O (log(log(T ))) times . . . . . . . . . . .
D.6 All couples (a, b) ∈ A×B are asymptotically pulled an inﬁnite number of times . .
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
D.7 Concentration lemmas .
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
.
D.8 Proof of Lemma 18 .

.

E IMED-GS(cid:63): Proof of Theorem 11 (main result)

E.1 Almost surely nopt(T ) tends to nν . . . . . . . . . . . . . . . . . . . . . . . . . .

E.2 Almost surely and on expectation, for all sub-optimal couple

Na,b(T )
log(T )

tends to nν
a,b

F Concentration lemmas: Proofs

17

1
4
4
5

6

8
8
8
9
10
11

12

18

18
18
20
21
23

24

25
25
28
29
31
33
35
36
37

38
39

40

41

G IMED-GS, IMED-GS2, IMED-GS(cid:63)

2: Finite-time analysis

G.1 IMED-GS ﬁnite-time analysis
. . . . . . . . . . . . . . . . . . . . . . . . . . . . .
G.2 Uncontrolled scenario: Finite-time analysis . . . . . . . . . . . . . . . . . . . . .
G.2.1 Empirical bounds on the numbers of pulls . . . . . . . . . . . . . . . . . .
G.2.2 Concentration inequality with bounded time delays . . . . . . . . . . . . .

H Continuity of solutions to parametric linear programs

I Details on numerical experiments

Appendix A. Notations and reminders

44
44
45
45
46

47

47

For ν ∈ Dν, we deﬁne

εν :=

Then, there exists αν : R(cid:63)
(a, b) /∈ O(cid:63), for all b(cid:48) ∈ B,

min
(a,b) /∈O(cid:63),b(cid:48)∈B

b −ωb,b(cid:48) (cid:54)=0

µa,b(cid:48) −µ(cid:63)
+ → R(cid:63)

+ such that lim
ε→0

(cid:40) (cid:12)

(cid:12)µa,b(cid:48) − µ(cid:63)
b − ωb,b(cid:48)
4

(cid:12)
(cid:12)

,

µa,b
4

,

1 − µ(cid:63)
b
4

(cid:41)

.

αν(ε) = 0 and such that for all 0 < ε < εν, for all

µa,b(cid:48) (cid:54)= µ(cid:63)

b −ωb,b(cid:48) ⇒

kl(µa,b(cid:48)|µ(cid:63)

b − ωb,b(cid:48))

1 + αν(ε)

(cid:54) kl(µa,b(cid:48) ±ε|µ(cid:63)

b −ωb,b(cid:48) ±ε) (cid:54) (1+αν(ε))kl(µa,b(cid:48)|µ(cid:63)

b −ωb,b(cid:48)) .

We also introduce the following constant of interest

Eν := 6e max

a∈A,b∈B

(cid:18)

1 −

log(1 − µa,b − εν)
log(1 − µa,b)

(cid:19)−1 (cid:32)

(cid:18)

−

1−

log(1−µa,b−εν )
log(1−µa,b)

(cid:19)

kl(µa,b|µa,b−εν )

(cid:33)−3

.

1 − e

Lastly, for all couple (a, b) ∈ A × B, for all n (cid:62) 1, we consider the stopping times

and deﬁne

τ n
a,b := inf {t (cid:62) 1 : Na,b(t) = n}

(cid:98)µn
a,b := (cid:98)µa,b(τ n

a,b) .

Appendix B. Proof related to the regret lower bound (Section 2)

In this section we regroup the proofs related to the lower bounds.

B.1 Almost sure asymptotic lower bounds under consistent strategies

In this section we prove Proposition 5.

Let us consider a consistent strategy on Dω. Let ν ∈ Dω and let us consider (a, b) /∈ O(cid:63). We show
that almost surely lim
T →∞

Nb(T ) = +∞ implies

lim inf
T →∞

1
log(Nb(T ))

(cid:88)

b(cid:48)∈Ba,b

Na,b(cid:48)(T )kl(µa,b(cid:48)|µ(cid:63)

b − ωb,b(cid:48)) (cid:62) 1

18

where Ba,b = (cid:8)b(cid:48) ∈ B : (a, b(cid:48)) /∈ O(cid:63) and µa,b(cid:48) < µ(cid:63)
Proof Let us consider (cid:101)ν ∈ Dω, a maximal confusing distribution for the sub-optimal couple (a, b)
such that a is the unique optimal arm of user b for (cid:101)ν, deﬁned as follows:

b − ωb,b(cid:48)

(cid:9).

(cid:12)
(cid:12). Our assumption on Dω ⊂ Dω ensures that ε0 > 0.
(cid:12)
(cid:12) (cid:54) ωb(cid:48),b(cid:48)(cid:48). Indeed we

(cid:12)
(cid:12)(cid:101)µa,b(cid:48) − (cid:101)µa,b(cid:48)(cid:48)

- ∀a(cid:48) (cid:54)= a, b(cid:48) ∈ B,
- ∀b(cid:48)(cid:48) /∈ Ba,b,
- ∀b(cid:48) ∈ Ba,b,

(cid:101)µa(cid:48),b(cid:48) = µa(cid:48),b(cid:48)

(cid:101)µa,b(cid:48)(cid:48) = µa,b(cid:48)(cid:48)
(cid:101)µa,b(cid:48) = µ(cid:63)
(cid:12)
(cid:12)µ(cid:63)

b − ωb,b(cid:48) + ε

b − ωb,b(cid:48) − µa,b(cid:48)

where 0 < ε < ε0 = min
b(cid:48)∈B
Note that ε is chosen in such a way that for all b(cid:48), b(cid:48)(cid:48) ∈ B, max
a∈A
have:
(cid:12)
- for b(cid:48), b(cid:48)(cid:48) ∈ Ba,b :
(cid:12)(cid:101)µa,b(cid:48) − (cid:101)µa,b(cid:48)(cid:48)
(cid:12)
- for b(cid:48), b(cid:48)(cid:48) /∈ Ba,b :
(cid:12)(cid:101)µa,b(cid:48) − (cid:101)µa,b(cid:48)(cid:48)
- for b(cid:48) ∈ Ba,b and b(cid:48)(cid:48) /∈ Ba,b, we have (cid:101)µa,b(cid:48) − (cid:101)µa,b(cid:48)(cid:48) = µ(cid:63)
b(cid:48) ∈ Ba,b it implies µa,b(cid:48) (cid:54) µ(cid:63)
one hand we get

(cid:12)ωb,b(cid:48) − ωb,b(cid:48)(cid:48)
(cid:12)µa,b(cid:48) − µa,b(cid:48)(cid:48)

(cid:12)
(cid:12) (cid:54) ωb(cid:48),b(cid:48)(cid:48)
(cid:12)
(cid:12) (cid:54) ωb(cid:48),b(cid:48)(cid:48)

(cid:12)
(cid:12) = (cid:12)
(cid:12) = (cid:12)
(cid:12)

b − ωb,b(cid:48) and since b(cid:48)(cid:48) /∈ Ba,b : µa,b(cid:48)(cid:48) (cid:62) µ(cid:63)

b − ωb,b(cid:48) + ε − µa,b(cid:48)(cid:48). Since in this case
b − ωb,b(cid:48)(cid:48) + ε0. Therefore on

µ(cid:63)
b − ωb,b(cid:48) + ε − µa,b(cid:48)(cid:48) (cid:62) µa,b(cid:48) − µa,b(cid:48)(cid:48) (cid:62) −ωb(cid:48),b(cid:48)(cid:48) ,

and on the other hand

b − ωb,b(cid:48) + ε − µa,b(cid:48)(cid:48) (cid:54) µ(cid:63)
µ(cid:63)

b − ωb,b(cid:48) + ε − (µ(cid:63)

b − ωb,b(cid:48)(cid:48) + ε0) = ε − ε0 + ωb,b(cid:48)(cid:48) − ωb,b(cid:48) (cid:54) ωb(cid:48),b(cid:48)(cid:48) .

Actually, we can choose 0 < ε < εν so that :

∀b(cid:48) ∈ Ba,b, kl(µa,b(cid:48)|(cid:101)µa,b(cid:48)) (cid:54) (1 + αν(ε))kl(µa,b(cid:48)|µ(cid:63)
We refer to Appendix A for the deﬁnitions of εν and αν(·). Note that αν(·) is such that lim
ε→0

b − ωb,b(cid:48)).

αν(ε) = 0.

Let 0 < c < 1 .We will show that almost surely lim
T →∞

Nb(T ) = +∞ implies

lim inf
T →∞

1
log(Nb(T ))

(cid:88)

b(cid:48)∈Ba,b

Na,b(cid:48)(T )kl(µa,b(cid:48)|(cid:101)µa,b(cid:48)) (cid:62) c .

We start with the following inequality



Pν

lim inf
T →∞

1
log(Nb(T ))

(cid:88)

b(cid:48)∈Ba,b

Na,b(cid:48)(T )kl(µa,b(cid:48)|(cid:101)µa,b(cid:48)) < c,

lim
T →∞

Nb(T ) = ∞







(cid:54) lim inf
T →∞

Pν



1
log(Nb(T ))

(cid:88)

b(cid:48)∈Ba,b

Na,b(cid:48)(T )kl(µa,b(cid:48)|(cid:101)µa,b(cid:48)) < c,

lim
T →∞

Nb(T ) = ∞

 .



Let us consider an horizon T (cid:62) 1 and let us introduce the event

ΩT =




(cid:88)



b(cid:48)∈Ba,b

Na,b(cid:48)(T )kl(µa,b(cid:48)|(cid:101)µa,b(cid:48)) < c log(Nb(T )) ,

lim
T →∞

19

Nb(T ) = ∞






.

We want to provide an upper bound on Pν(ΩT ) to ensure lim
T →∞
advantage of the following lemma.

Pν(ΩT ) = 0. We start by taking

Lemma 13 (Change of measure) For every event Ω and random variable Z both measurable with
respect to ν and (cid:101)ν,

Pν(Ω ∩ E) = E
(cid:101)ν

(ψ)I{Ω∩E}

(cid:54) E
(cid:101)ν

(cid:2)eZI{Ω}

(cid:3)

(cid:21)

(cid:20) dν
d(cid:101)ν

and ψ = ((at, bt), Xt)t=1..T is the sequence of pulled couples

(cid:26)

where E =

log

and rewards.

(cid:19)

(ψ)

(cid:54) Z

(cid:27)

(cid:18) dν
d(cid:101)ν

Let α ∈ (0, 1) and let us introduce the event

(cid:26)

ET =

log

(cid:19)

(ψ)

(cid:18) dν
d(cid:101)ν

(cid:54) (1 − α) log(Nb(T ))

(cid:27)

.

Then we can decompose the probability as follows

Pν(ΩT ) = Pν(ΩT ∩ ET ) + Pν(ΩT ∩ Ec
(cid:2)Nb(T )1−αI{ΩT }

Now, we control successively E
(cid:101)ν
to 0 as T tends to ∞.

T ) (cid:54) E
(cid:101)ν

(cid:2)Nb(T )1−αI{ΩT }

(cid:3) and Pν(ΩT ∩ Ec

(cid:3) + Pν(ΩT ∩ Ec
T )
T ) and show that they both tend

(cid:2)Nb(T )1−αI{ΩT }

B.1.1 E
(cid:101)ν
We ﬁrst provide an upper bound on I{ΩT } as follows, denoting c(cid:48) = c/kl(µa,b(cid:48)|(cid:101)µa,b(cid:48)),

(cid:3) TENDS TO 0 WHEN T TENDS TO INFINITY

ΩT ⊂

=

Thus, we have

(cid:26)

Na,b(T ) < c(cid:48) log(Nb(T )) ,

(cid:27)

lim
T →∞

Nb(T ) = ∞






Nb(T ) < c(cid:48) log(Nb(T )) +

(cid:88)

a(cid:48)(cid:54)=a

Na(cid:48),b(T ),

lim
T →∞

Nb(T ) = ∞






.

I{ΩT } (cid:54) c(cid:48)I{Nb(T )(cid:62)1, Nb(T )→∞}

log(Nb(T ))
Nb(T )

(cid:88)

+

a(cid:48)(cid:54)=a

Na(cid:48),b(T )
Nb(T )

Considering fα : x (cid:62) 1 (cid:55)→ log(x)/xα, we have fα (cid:54) e−1/α. Then, the dominated convergence
theorem ensures

(cid:20)
I{Nb(T )(cid:62)1, Nb(T )→∞}

E
(cid:101)ν

(cid:21)

log(Nb(T ))
Nb(T )α

= o(1) .

Furthermore, since the considered strategy is assumed consistent we know that for a(cid:48) (cid:54)= a, since a(cid:48) is
a sub-optimal arm for user b and conﬁguration (cid:101)ν,

(cid:21)

(cid:20) Na,b(cid:48)(T )
Nb(T )α

E
(cid:101)ν

= o(1) ,

therefore we get

(cid:2)Nb(T )1−αI{ΩT }

(cid:3) = o(1).

E
(cid:101)ν

20

B.1.2 Pν(ΩT ∩ Ec

T ) TENDS TO 0 WHEN T TENDS TO INFINITY

For each time t = 1, . . . , T , the reward Xt is sampled independently from the past and according to
νat,bt. Hence the likelihood ratio rewrites

(ψ) =

dν
d(cid:101)ν

T
(cid:89)

t=1

dνat,bt
d(cid:101)νat,bt

(Xt)

where, for all (a, b) ∈ A × B and for all x ∈ {0, 1}, we have :

dνa,b
d(cid:101)νa,b
Thus, since for all b(cid:48) /∈ Ba,b, µa,b = (cid:101)µa,b, the log-likelihood ratio is

(x) =

µx
a,b(1 − µa,b)1−x
a,b(1 − (cid:101)µa,b)1−x .
(cid:101)µx

log

(cid:18) dν
d(cid:101)ν

(cid:19)

(ψ)

=

(cid:88)

T
(cid:88)

b(cid:48)∈Ba,b

t=1

I{(at,bt)=(a,b(cid:48))} log

(cid:18) dνa,b(cid:48)
d(cid:101)νa,b(cid:48)

(cid:19)

(Xt)

.

Let us introduce, for (a, b) ∈ A × B, X n

a,b = min {t (cid:62) 1 s.t. Na,b(t) = n}.
τ n
Note that the random variables τ n
a,b = t
is measurable
with respect to the ﬁltration generated by ((a1, b1), X1, ..., (at−1, bt−1), Xt−1). Hence we can rewrite
the event ET

a,b are predictable stopping times, since

a,b = Xτ n

where τ n

(cid:111)

(cid:110)

a,b

ET =




(cid:88)

T
(cid:88)



b(cid:48)∈Ba,b

t=1

I{(at,bt)=(a,b)}

dνa,b(cid:48)
d(cid:101)νa,b(cid:48)

(Xt) (cid:54) (1 − α) log(Nb(T ))






and, since ΩT =

(cid:40)

(cid:80)
b(cid:48)∈Ba,b

Na,b(cid:48)(T )kl(µa,b(cid:48)|(cid:101)µa,b(cid:48)) < c log(Nb(T )) ,

lim
T →∞

Nb(T ) = ∞

, we have

(cid:41)

(cid:26)

ΩT ∩ Ec

T ⊂

∃(nb(cid:48))b(cid:48)∈Ba,b : (cid:80)
b(cid:48)∈Ba,b

nb(cid:48)kl(µa,b(cid:48)|(cid:101)µa,b(cid:48)) < c log(Nb(T )) ,

lim
T →∞

Nb(T ) = ∞

and (cid:80)

b(cid:48)∈Ba,b

(cid:80)
n=1..nb(cid:48)

dνa,b(cid:48)
d(cid:101)νa,b(cid:48)

(X n

a,b(cid:48)) > (1 − α) log(Nb(T ))

(cid:27)

.

dνa,b(cid:48)
d(cid:101)νa,b(cid:48)

For b(cid:48) ∈ Ba,b and n (cid:62) 1, let us consider Zn

b(cid:48) =

(X n

a,b(cid:48)). Then Zn

b(cid:48) is positive and bounded by

1
(cid:101)µa,b(cid:48)(1 − (cid:101)µa,b(cid:48))

Bb(cid:48) =
b(cid:48), for b(cid:48) ∈ Ba,b and n (cid:62) 1, are independent. Thus, it holds
Zn

, with mean Eν[Zn

b(cid:48)] = kl(µa,b(cid:48)|(cid:101)µa,b(cid:48)) . Furthermore, the random variables

ΩT ∩ Ec

T ⊂

where




max
b)∈Na,b

(n(cid:48)



(cid:88)

(cid:88)

b(cid:48) − Eν[Zn
Zn

b(cid:48)] >

b(cid:48)∈Ba,b

n=1..nb(cid:48)

(cid:18) 1 − α
c

(cid:19)

− 1

c log(Nb(T )) , Nb(T ) → ∞






,

Na,b :=






(nb(cid:48))b(cid:48)∈Ba,b :

(cid:88)

b(cid:48)∈Ba,b

nb(cid:48)kl(µa,b(cid:48)|(cid:101)µa,b(cid:48)) < c log(T )






.

21

In the following, we apply Doob’s maximal inequality. For b(cid:48) ∈ Ba,b and λ > 0, let us introduce the
super-martingale

(cid:32)

M b(cid:48)

n = exp

λ

n
(cid:88)

k=1

(cid:0)Zk

b(cid:48) − E[Zk

b(cid:48)](cid:1) − nλ2 B2

b(cid:48)
8

(cid:33)

.

Then noting that

(cid:80)
b(cid:48)∈Ba,b

λ2nb(cid:48)

B2
b(cid:48)
8

c log(T )

<

(cid:80)
b(cid:48)∈Ba,b

λ2nb(cid:48)

B2
b(cid:48)
8

(cid:80)
b(cid:48)∈Ba,b

nb(cid:48)kl(µa,b(cid:48)|(cid:101)µa,b(cid:48))

(cid:54) λ2

max
b(cid:48)∈Ba,b

B2
b(cid:48)

8 min
b(cid:48)∈Ba,b

kl(µa,b(cid:48)|(cid:101)µa,b(cid:48))

,





(cid:26)

we obtain

ΩT ∩ Ec

T ⊂

⊂

where nmax =

(cid:104)
λ( 1−α

c −1)−λ2

(cid:89)

b(cid:48)∈Ba,b

M b(cid:48)
n(cid:48)
b

> T

maxb(cid:48)∈Ba,b

B2
b(cid:48)
kl(µa,b(cid:48) |(cid:101)µa,b(cid:48) )

8 minb(cid:48)∈Ba,b

(cid:105)

c

, Nb(T ) → ∞






max
b)∈Na,b

(n(cid:48)

∃b(cid:48) ∈ Ba,b : max
n(cid:54)nmax

M b(cid:48)

n > Nb(T )γ, Nb(T ) → ∞

(cid:27)

,

c log(T )

kl(µa,b(cid:48) |(cid:101)µa,b(cid:48) ) and γ =

min
b(cid:48)∈Ba,b

(cid:104)

λ( 1−α

c − 1) − λ2

maxb(cid:48)∈Ba,b

B2
b(cid:48)
kl(µa,b(cid:48) |(cid:101)µa,b(cid:48) )

(cid:105)

c
|Ba,b|

. In

8 minb(cid:48)∈Ba,b

order to have γ > 0, we impose:
- 0 < α < 1 − c
(cid:26)

(this implies 1−α
1 − α
− 1) − λ(cid:48)2
c

λ(cid:48)(

- λ ∈ argmax

λ(cid:48)(cid:62)0

c − 1 > 0)

maxb(cid:48)∈Ba,b

B2
b(cid:48)
kl(µa,b(cid:48) |(cid:101)µa,b(cid:48) )

8 minb(cid:48)∈Ba,b

(cid:27)

> 0.

Thus for A > 0, we have

Pν(ΩT ∩ Ec

T ) (cid:54) (cid:88)
b(cid:48)∈Ba,b
(cid:54) (cid:88)
b(cid:48)∈Ba,b

Pν

(cid:18)

max
n(cid:54)nmax

M b(cid:48)

n > Nb(T )γ, Nb(T ) → ∞

(cid:19)

(Union bound)

Pν(Nb(T )γ (cid:54) A, Nb(T ) → ∞) + Pν

(cid:18)

max
n(cid:54)nmax

(cid:19)

M b(cid:48)

n > A

(cid:54) |Ba,b| Pν(Nb(T )γ (cid:54) A, Nb(T ) → ∞) +

= |Ba,b| Pν(Nb(T )γ (cid:54) A, Nb(T ) → ∞) +

Eν[M b(cid:48)
0 ]
A

.

(cid:88)

b(cid:48)∈Ba,b
|Ba,b|
A

(Doob’s maximal inequality)

Furthermore, we have

lim
T →∞

P

(cid:101)ν(Nb(T )γ (cid:54) A, Nb(T ) → ∞) (cid:54) P

(cid:101)ν

(cid:54) P

(cid:101)ν

(cid:18)

lim sup
T →∞

(cid:18)

lim sup
T →∞

(Nb(T )γ (cid:54) A) , Nb(T ) → ∞

(cid:19)

Nb(T ) < ∞, Nb(T ) → ∞

= 0 .

(cid:19)

Thus we have shown

∀A > 0,

lim sup
T →∞

Pν(ΩT ∩ Ec

T ) (cid:54)

|Ba,b|
A

,

22

that is Pν(ΩT ∩ Ec

T ) = o(1).

B.2 Asymptotic lower bounds on the regret

Here, we explain how we obtain the lower bounds on the regret given in Corollary 8.
Proof [Proof of Corollary 8.] Let us consider a consistent strategy on Dω and let ν ∈ Dω. Let
(Tk)k∈N be a sub-sequence such that

lim inf
T →∞

R(T, ν)
log(T )

= lim
k→∞

R(Tk, ν)
log(Tk)

.

We assume that this limit is ﬁnite otherwise the result is straightforward. This implies in particular
that for all (a, b) /∈ O(cid:63)

lim sup
k→∞

Eν [Na,b(Tk)]
log(Tk)

< +∞ .

By Cantor’s diagonal argument there exists an extraction of (Tk)k∈N denoted by (T (cid:48)
for all (a, b) /∈ O(cid:63), there exist Na,b (cid:54)∈ O(cid:63) such that

k)k∈N such that

Hence we get

lim
k(cid:48)→∞

Eν [Na,b(T (cid:48)
log(T (cid:48)
k)

k)]

= Na,b .

lim inf
T →∞

R(T, ν)
log(T )

=

(cid:88)

(a,b) /∈O(cid:63)

Na,b∆a,b .

But thanks to Proposition 5 we have for all (a, b) (cid:54)∈ O(cid:63), since user b has a log-frequency βb,

(cid:88)

b(cid:48)∈Ba,b

kl(µa,b(cid:48)|µ(cid:63)

b − ωb,b(cid:48))Na,b(cid:48)

= lim
k→∞

(cid:88)

b(cid:48)∈Ba,b

kl(µa,b(cid:48)|µ(cid:63)

b − ωb,b(cid:48))

(cid:62) lim inf
k→∞

(cid:88)

b(cid:48)∈Ba,b

kl(µa,b(cid:48)|µ(cid:63)

b − ωb,b(cid:48))

Therefore we obtain the lower bound

Eν

k)(cid:3)

(cid:2)Na,b(cid:48)(T (cid:48)
log(T (cid:48)
k)
(cid:2)Na,b(cid:48)(T (cid:48)
Eν
log(cid:0)Nb(T (cid:48)

k)(cid:3)
k)(cid:1) × lim inf

k→∞

log(Nb(T (cid:48)
k))
log(T (cid:48)
k)

(cid:62) βb .

lim inf
T →∞

R(ν, T )
log(T )

(cid:62) C(cid:63)

ω(β, ν) := min

n∈RA×B
+

s.t.

(cid:88)

b(cid:48)∈Ba,b

kl(µa,b(cid:48)|µ(cid:63)

b − ωb,b(cid:48))na,b(cid:48) (cid:62) βb .

(cid:88)

na,b∆a,b

a,b /∈O(cid:63)
∀(a, b) (cid:54)∈ O(cid:63) :

23

Appendix C. Algorithms for the uncontrolled scenario

We regroup in this section the algorithms IMED-GS2 and IMED-GS(cid:63)

2 for the uncontrolled scenario.

Algorithm 3 IMED-GS2
Require: Weight
(ωb,b(cid:48))b,b(cid:48)∈B.
for t = 1...T do

matrix

Pull at+1 ∈ argmin

a∈A

(cid:101)Ia,bt+1(t)

end for

Algorithm 4 IMED-GS(cid:63)
2
Require: Weight matrix (ωb,b(cid:48))b,b(cid:48)∈B.
a ← 1

∀a ∈ A, ca, c+
∀b ∈ B, E(b) ← ∅, FE(b) ← ∅
for For t = 1...T do

Choose at ∈ argmin

a∈A

(cid:101)Ia,bt+1(t)

if (at, bt+1) ∈ (cid:98)O(cid:63)(t) then

Choose at+1 = at

else

Choose (at, bt) ∈ argmin
(a,b)∈A×B

(cid:101)Ia,b(t)

then

if (at, bt) /∈ (cid:98)O(cid:63)(t) then
= c+
if cat
at
c+
← 2c+
at
at
Choose bt ∈ argmin
(cid:1) ← at
FE(cid:0)bt

b∈B

Na,b(t)

N opt

at+1,b(t)−Nat+1,b(t)

else

Choose bt ∈ argmax

b∈ (cid:98)Bat,bt (t)∪{bt}

(cid:1) ← at

E(cid:0)bt
end if
cat+1 ← cat+1 + 1

end if

Priority rule in exploration phases:
if FE(bt+1) (cid:54)= ∅ then

Choose at+1 = FE(bt+1) (delayed forced-exploration)
FE(bt+1) ← ∅

else if E(bt+1) (cid:54)= ∅ then

Choose at+1 = E(bt+1) (delayed exploration)
E(bt+1) ← ∅

else

Choose at+1 = at (current exploration)

end if

end if

Pull at+1

end for

24

Appendix D. IMED-GS(cid:63): Finite-time analysis

IMED-GS(cid:63) strategy implies empirical lower and empirical upper bounds on the numbers of pulls
(Lemma 14, Lemma 15). Based on concentration lemmas (see Appendix D.7), the strategy-based em-
pirical lower bounds ensure the reliability of the estimators of interest (Lemma 19). Then, combining
the reliability of these estimators with the obtained strategy-base empirical upper bounds, we get
upper bounds on the average numbers of pulls (Proposition 20). We ﬁrst show that IMED-GS(cid:63) strategy
is Pareto-optimal (for minimization problem 2) and that it is a consistent strategy which induces
sequences of users with log-frequencies all equal to 1 (independently from the considered bandit
conﬁguration). From an asymptotic analysis, we then prove that IMED-GS(cid:63) strategy is asymptotically
optimal.

D.1 Strategy-based empirical bounds

IMED-GS(cid:63) strategy implies inequalities between the indexes that can be rewritten as inequalities on
the numbers of pulls. While asymptotic analysis suggests lower bounds involving log(cid:0)Nbt+1(t)(cid:1)
might be expected, we show in this non-asymptotic context lower bounds on the numbers of pulls
involving instead the logarithm of the number of pulls of the current chosen arm, log(cid:0)Nat+1,bt+1(t)(cid:1).
In contrast, we provide upper bounds involving log(cid:0)Nbt+1(t)(cid:1) on Nat+1,bt+1(t).

We believe that establishing these empirical lower and upper bounds is a key element of our

proof technique, that is of independent interest and not a priori restricted to the graph structure.

Lemma 14 (Empirical lower bounds) Under IMED-GS(cid:63), at each step time t (cid:62) 1, for all couple
(a, b) /∈ (cid:98)O(cid:63)(t),

log(cid:0)Nat+1,bt+1(t)(cid:1) (cid:54) (cid:88)

Na,b(cid:48)(t) kl(cid:0)

b(cid:48)∈ (cid:98)Ba,b(t)

Furthermore, for all couple (a, b) ∈ (cid:98)O(cid:63)(t),

(cid:98)µa,b(cid:48)(t)(cid:12)

(cid:12)(cid:98)µ(cid:63)

b (t) − ωb,b(cid:48)

(cid:1) + log(cid:0)Na,b(cid:48)(t)(cid:1) .

Proof According to IMED-GS(cid:63) strategy (see Algorithm 2), at+1 = at and for all couple (a, b) ∈ A×B

Nat+1,bt+1(t) (cid:54) Na,b(t) .

Ia,b(t) (cid:62) Iat,bt

(t) .

(t) = log(cid:0)Nat+1,bt+1(t)(cid:1).

There is three possible cases.
Case 1: (at+1, bt+1) = (at, bt) ∈ (cid:98)O(cid:63)(t) and Iat,bt
Case 2: bt+1 ∈ (cid:98)Bat,bt
(t) = (cid:80)
Iat,bt

(t) ∪ {bt} and
(cid:16)
Nat,b(cid:48)(t) kl

b(cid:48)∈ (cid:98)Bat,bt (t)

except if Nat,bt
Case 3: bt+1 ∈ argmin

(t) = 0. Thus Iat,bt

Nat,b(t) and Iat,bt

b∈B

(cid:17)

(cid:12)
(cid:12)(cid:98)µ(cid:63)
(cid:12)
(cid:98)µat,b(cid:48)(t)
bt
(t) (cid:62) log(cid:0)Nat+1,bt+1(t)(cid:1).

(t) − ωbt,b(cid:48)

This implies for all couple (a, b) ∈ A × B,

Ia,b(t) (cid:62) log(cid:0)Nat+1,bt+1(t)(cid:1) .

25

+log(Nat,b(cid:48)(t)). Note that bt ∈ (cid:98)Bat,bt

(t)

(t) (cid:62) minb∈ (cid:98)Bat,bt (t) log(cid:0)Nat+1,b(t)(cid:1) (cid:62) log(cid:0)Nat+1,bt+1(t)(cid:1).

Thus, according to the deﬁnition of the indexes (Eq. 4) for all couple (a, b) /∈ (cid:98)O(cid:63)(t) we obtain

log (cid:0)Nat+1,bt+1(t)(cid:1) (cid:54) (cid:88)

Na,b(cid:48)(t) kl(cid:0)

b(cid:48)∈ (cid:98)Ba,b(t)

(cid:98)µa,b(cid:48)(t)(cid:12)

(cid:12)(cid:98)µ(cid:63)

b (t) − ωb,b(cid:48)

(cid:1) + log (cid:0)Na,b(cid:48)(t)(cid:1) ,

and for all couple (a, b) ∈ (cid:98)O(cid:63)(t),

log (cid:0)Nat+1,bt+1(t)(cid:1) (cid:54) log (Na,b(t)) .
Taking the exponential in the last inequality allows us to conclude.

Lemma 15 (Empirical upper bounds) Under IMED-GS(cid:63), at each step time t (cid:62) 1 such that
(at+1, bt+1) /∈ (cid:98)O(cid:63)(t) we have

(cid:88)

Nat+1,b(cid:48)(t) kl

(cid:16)

(cid:98)µat+1,b(cid:48)(t)

(cid:12)
(cid:12)(cid:98)µ(cid:63)
(cid:12)
bt

(t) − ωbt,b(cid:48)

(cid:17)

(cid:54) log(cid:0)Nbt

(t)(cid:1)

b(cid:48)∈ (cid:98)Bat+1,bt (t)

and

Nat+1,bt+1(t)
log(t)

(cid:54)






(cid:16)

kl

(cid:98)µat+1,bt


min



(cid:16)

kl

1

(t)

(cid:12)
(cid:12)
(cid:12)(cid:98)µ(cid:63)
bt

(cid:17) , if cat+1 = c+

at+1

(t)

1
(cid:12)
(cid:12)
(cid:12)(cid:98)µ(cid:63)
(cid:98)µat+1,bt+1(t)
bt



(cid:17) , nopt

at+1,bt+1

(t)

 otherwise.

(t) − ωbt,bt+1

Proof For all current optimal couple (a, b) ∈ (cid:98)O(cid:63)(t), we have Ia,b(t) = log (Na,b(t)) (cid:54) log(Nb(t)).
This implies

(t) (cid:54) log(cid:0)Nbt
Furthermore, since (at+1, bt+1) /∈ (cid:98)O(cid:63)(t), we have at+1 = at and the previous inequality implies

(t)(cid:1) .

Iat,bt

(cid:88)

Nat+1,b(cid:48)(t) kl

(cid:16)

(cid:12)
(cid:12)(cid:98)µ(cid:63)
(cid:12)
(cid:98)µat+1,b(cid:48)(t)
bt

(t) − ωbt,b(cid:48)

(cid:17)

(cid:54) log(cid:0)Nbt

(t)(cid:1) .

(8)

b(cid:48)∈ (cid:98)Bat+1,bt (t)

In the following we study separately the two cases either cat+1 = c+
Case 1: cat+1 = c+
at+1
Then bt+1 ∈ argmin

Nat+1,b(t) and from Eq. 8 we get

b∈B

at+1 or cat+1 < c+

at+1.

Nat+1,bt+1(t) (cid:54) Nat+1,bt

(t) (cid:54)

(cid:16)

kl

log(t)
(cid:12)
(cid:12)
(cid:12)(cid:98)µ(cid:63)
bt

(t)

(cid:98)µat+1,bt

(cid:17) .

(t)

Case 2: cat+1 < c+
Then bt+1 ∈

at+1
argmax
b∈ (cid:98)Bat,bt (t)∪{bt}

N opt

at,b(t) − Nat,b(t) and we have

Nat+1,bt+1(t) (cid:54)

(cid:16)

kl

log(t)
(cid:12)
(cid:12)
(cid:12)(cid:98)µ(cid:63)
bt

(cid:98)µat+1,bt+1(t)

(t) − ωbt,bt+1

(cid:17) .

26

Last, Lemma 16 stated below implies

Nat+1,bt+1(t) (cid:54) N opt

at+1,bt+1

(t) = nopt

at+1,bt+1

(t) min
b∈B

Iat+1,b(t) (cid:54) nopt

at+1,bt+1

(t) log(t) .

Lemma 16 (N opt dominates N ) Under IMED-GS(cid:63), at each time step t (cid:62) 1 such that
(at, bt) /∈ (cid:98)O(cid:63)(t) we have

max
b∈ (cid:98)Bat,bt (t)∪{bt}

N opt
at,b(t) − Nat,b(t) (cid:62) 0 .

Proof If bt /∈ (cid:98)Bat,bt
assume that bt ∈ (cid:98)Bat,bt

(t), then Nat,bt
(t) (cid:54)= ∅.

(t) = 0 and N opt
at,bt

(t) − Nat,bt

(t) (cid:62) 0. In the following we

From Eq. 6, since min
b(cid:48)∈B

Iat,b(cid:48)(t) = Iat,bt

(t), for all b ∈ (cid:98)Bat,bt

(t) we have

N opt
at,b(t) = nopt

at,b(t) Iat,bt

(t) ,

and, since (at, bt) /∈ (cid:98)O(cid:63)(t), from Eq. 5 we get

(cid:88)

(cid:16)

kl

(cid:98)µat,b(cid:48)(t)

(cid:12)
(cid:12)(cid:98)µ(cid:63)
(cid:12)
bt

(cid:17)

(t) − ωbt,b(cid:48)

nopt
at,b(cid:48)(t) (cid:62) 1 .

b(cid:48)∈ (cid:98)Bat,bt (t)

Then Eq. 9 and 10 imply

(cid:88)

N opt

(cid:16)
at,b(cid:48)(t) kl

(cid:12)
(cid:12)(cid:98)µ(cid:63)
(cid:12)
(cid:98)µat,b(cid:48)(t)
bt

(t) − ωbt,b(cid:48)

(cid:17)

(cid:62) Iat,bt

(t) .

b(cid:48)∈ (cid:98)Bat,bt (t)

Hence from the deﬁnitions of the indexes (Eq. 4) this implies

(cid:88)

N opt

(cid:16)
at,b(cid:48)(t) kl

(cid:12)
(cid:12)(cid:98)µ(cid:63)
(cid:12)
(cid:98)µat,b(cid:48)(t)
bt

(cid:17)

(t) − ωbt,b(cid:48)

b(cid:48)∈ (cid:98)Bat,bt (t)

(cid:62) (cid:88)

(cid:16)
Nat,b(cid:48)(t) kl

(cid:12)
(cid:12)(cid:98)µ(cid:63)
(cid:12)
(cid:98)µat,b(cid:48)(t)
bt

(t) − ωbt,b(cid:48)

(cid:17)

.

b(cid:48)∈ (cid:98)Bat,bt (t)

Since we assume bt ∈ (cid:98)Bat,bt

(t) (cid:54)= ∅, previous Eq. 11 implies

(9)

(10)

(11)

max
b∈ (cid:98)Bat,bt (t)∪{bt}

N opt

at,b(t) − Nat,b(t) = max

b∈ (cid:98)Bat,bt (t)

N opt
at,b(t) − Nat,b(t) (cid:62) 0 .

27

D.2 Reliable current best arm and means

In this subsection, we consider the subset Tε,γ of times where everything behaves well, that is: The
current best couples correspond to the true ones, and, the empirical means of the best couples and the
couples at least pulled proportionally (with a coefﬁcient γ ∈ (0, 1)) to the number of pulls of the
current chosen couple are ε-accurate for 0 < ε < εν, i.e.

(cid:26)

t (cid:62) 1 :

Tε,γ :=

(cid:98)O(cid:63)(t) = O(cid:63)
∀(a, b) s.t. Na,b(t) (cid:62) γ Nat+1,bt+1(t) or (a, b) ∈ O(cid:63), |(cid:98)µa,b(t) − µa,b| < ε

(cid:27)

.

We will show that its complementary is ﬁnite on average. In order to prove this we decompose the
set Tε,γ in the following way. Let Eε,γ be the set of times where the means are well estimated,

Eε,γ :=

(cid:111)
(cid:110)
t (cid:62) 1 : ∀(a, b) s.t. Na,b(t) (cid:62) γ Nat+1,bt+1(t) or (a, b) ∈ (cid:98)O(cid:63)(t), |(cid:98)µa,b(t) − µa,b| < ε

,

and Λε the set of times where the mean of a couple that is not the current optimal neither pulled is
underestimated
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

∀b ∈ B(cid:48), (cid:98)µa,b(t) < µa,b − ε
log(Nat+1,bt+1 (t)) (cid:54) (cid:80)

Na,b(t)kl((cid:98)µa,b(t)|µa,b − εν)+log (Na,b(t))

∃a ∈ A, B(cid:48) ⊂ B :

t (cid:62) 1

Λε :=

(cid:41)

(cid:40)

.

b∈B(cid:48)

Then we prove below the following inclusion.

Lemma 17 (Relations between the subsets of times) For 0 < ε < εν and γ ∈ (0, 1),

ε,γ \ E c
T c

ε,γ ⊂ Λεν .

(12)

Refer to Appendix A for the deﬁnition of εν.

Proof For all user b ∈ B it is assumed that there exists a unique optimal arm a(cid:63)
(a(cid:63)

b ∈ A such that
b , b)}. In particular, for all time step t (cid:62) 1, if (cid:98)O(cid:63)(t) (cid:54)= O(cid:63) then

b , b) ∈ O(cid:63). We have O(cid:63) = (cid:83)

{(a(cid:63)

b∈B

there exists b ∈ B and (cid:98)a(cid:63)

b ∈ A such that ((cid:98)a(cid:63)

b , b) ∈ (cid:98)O(cid:63)(t) \ O(cid:63) (and (cid:98)a(cid:63)

b (cid:54)= a(cid:63)
b ).

ε,γ \ E c
Let t ∈ T c
Thus we know that (cid:98)a(cid:63)
ε < εν , this implies

ε,γ. Then (cid:98)O(cid:63)(t) (cid:54)= O(cid:63) and there exists b ∈ B, (cid:98)a(cid:63)
b ,b = µ(cid:63)

b . In particular, we have µa(cid:63)

b (cid:54)= a(cid:63)

b ∈ A such that ((cid:98)a(cid:63)
b > µ

b , b) ∈ (cid:98)O(cid:63)(t) \ O(cid:63).
b ,b + 2εν. Since t ∈ Eε,γ and
(cid:98)a(cid:63)

µa(cid:63)

b ,b > (cid:98)µ

b ,b(t) + εν = (cid:98)µ(cid:63)
(cid:98)a(cid:63)

b (t) + εν (cid:62)

(cid:98)µa(cid:63)

b

(t) + ε

(13)

and (a(cid:63)

b , b) /∈ (cid:98)O(cid:63)(t). From Lemma 14 we have the following empirical lower bound

log (cid:0)Nat+1,bt+1(t)(cid:1) (cid:54) (cid:88)
b(cid:48)∈ (cid:98)Ba(cid:63)
b

,b(t)

(cid:16)
b ,b(cid:48)(t) kl

Na(cid:63)

b ,b(cid:48)(t)(cid:12)

(cid:12)(cid:98)µ(cid:63)

(cid:98)µa(cid:63)

b (t) − ωb,b(cid:48)

(cid:17)

+ log

(cid:16)

(cid:17)
b ,b(cid:48)(t)

Na(cid:63)

.

(14)

In particular, for all b(cid:48) ∈ (cid:98)Ba(cid:63)

b ,b(t) we have (cid:98)µa(cid:63)

b ,b(cid:48)(t) < (cid:98)µ(cid:63)

b (t) − ωb,b(cid:48) and Eq. 13 implies

(cid:98)µa(cid:63)

b ,b(cid:48)(t) < (cid:98)µ(cid:63)

b (t) − ωb,b(cid:48) < µa(cid:63)

b ,b − εν − ωb,b(cid:48) < µa(cid:63)

b ,b(cid:48) − εν ,

(15)

28

and the monotonic properties of kl(·|·) implies

(cid:16)

kl

b ,b(cid:48)(t)(cid:12)

(cid:12)(cid:98)µ(cid:63)

(cid:98)µa(cid:63)

b (t) − ωb,b(cid:48)

(cid:17)

(cid:16)
(cid:54) kl

(cid:12)
(cid:12)
(cid:12)µa(cid:63)
b ,b(cid:48)(t)

(cid:98)µa(cid:63)

b ,b(cid:48) − εν

(cid:17)

.

(16)

Therefore, by combining Eq. 14, 15 and 16, we have for such t

∀b(cid:48) ∈ (cid:98)Ba(cid:63)

b ,b(t), (cid:98)µa(cid:63)

b ,b(cid:48)(t) < µa(cid:63)

b ,b(cid:48) − εν

and

log (cid:0)Nat+1,bt+1(t)(cid:1) (cid:54) (cid:88)
b(cid:48)∈ (cid:98)Ba(cid:63)
b

,b(t)

(cid:16)
b ,b(cid:48)(t) kl

Na(cid:63)

which concludes the proof.

(cid:12)
(cid:12)
(cid:12)µa(cid:63)
b ,b(cid:48)(t)

(cid:98)µa(cid:63)

b ,b(cid:48) − εν

(cid:17)

(cid:16)

+ log

Na(cid:63)

b ,b(cid:48)(t)

(cid:17)

,

Using classical concentration arguments we prove in Appendix D.8 the following upper bounds.

Lemma 18 (Bounded subsets of times) For 0 < ε < εν and γ ∈ (0, 1/2),

Eν[(cid:12)

(cid:12)E c
ε,γ

(cid:12)] (cid:54) 17
(cid:12)

γε4 |A|2 |B|2

Eν[|Λεν |] (cid:54) 2 |A|2 |B| (1 + Eν)|B| .

Refer to Appendix A for the deﬁnitions of εν and Eν.

Thus combining them with (12) we obtain

Eν[(cid:12)

(cid:12)T c
ε,γ

(cid:12)] (cid:54) Eν[(cid:12)
(cid:12)

(cid:12)E c
ε,γ

(cid:12)] + Eν[|Λεν |] (cid:54) 17
(cid:12)

γε4 |A|2 |B|2 + 2 |A|2 |B| (1 + Eν)|B| .

Hence, we just proved the following lemma.

Lemma 19 (Reliable estimators) For 0 < ε < εν and γ ∈ (0, 1/2),
(cid:12)] (cid:54) 17
(cid:12)

γε4 |A|2 |B|2 + 2 |A|2 |B| (1 + Eν)|B| .

Eν[(cid:12)

(cid:12)T c
ε,γ

Refer to Appendix A for the deﬁnitions of εν and Eν.

D.3 Pareto-optimality and upper bounds on the numbers of pulls of sub-optimal arms

In this section, we combine the different results of the previous sections to prove the following
proposition.

Proposition 20 (Upper bounds) Let ν ∈ Dω. Let 0 < ε < εν and γ ∈ (0, 1/2). Let us consider

(cid:26)

t (cid:62) 1 :

Tε,γ :=

(cid:98)O(cid:63)(t) = O(cid:63)
∀(a, b) s.t. Na,b(t) (cid:62) γ Nat+1,bt+1(t) or (a, b) ∈ O(cid:63), |(cid:98)µa,b(t) − µa,b| < ε

(cid:27)

.

Then under IMED-GS(cid:63) strategy,

Eν[(cid:12)

(cid:12)T c
ε,γ

(cid:12)] (cid:54) 17
(cid:12)

γε4 |A|2 |B|2 + 2 |A|2 |B| (1 + Eν)|B|

29

and for all horizon time T (cid:62) 1,

∀a ∈ A, min

b: (a,b) /∈O(cid:63)

1
log(Nb(T ))

(cid:88)

b(cid:48)∈Ba,b

Na,b(cid:48)(T ) kl(µa,b(cid:48)|µ(cid:63)

b − ωb,b(cid:48)) (cid:54) (1 + αν(ε))

(cid:20)

1 + γ

(cid:21)

Mν
mν

+

Mν |Tε,γ|
minb∈B log(Nb(T ))

where mν and Mν are deﬁned as follows:

mν = min

(a,b) /∈O(cid:63)
b(cid:48)∈Ba,b

kl(µa,b(cid:48)|µ(cid:63)

b − ωb,b(cid:48)),

Mν = max

(a,b) /∈O(cid:63)

(cid:88)

b(cid:48)∈Ba,b

kl(µa,b(cid:48)|µ(cid:63)

b − ωb,b(cid:48)) .

Furthermore, we have

∀(a, b) /∈ O(cid:63), Na,b(T ) (cid:54) 1 + αν(ε)

mν

log(Nb(T )) + (cid:12)

(cid:12)T c
ε,γ

(cid:12)
(cid:12) .

Refer to Appendix A for the deﬁnitions of εν, αν(·) and Eν.

Proof From Lemma 19, we have:

Eν[(cid:12)

(cid:12)T c
ε,γ

(cid:12)] (cid:54) 17
(cid:12)

γε4 |A|2 |B|2 + 2 |A|2 |B| (1 + Eν)|B| .

Let a ∈ A. Let us consider 1 (cid:54) t (cid:54) T such that at+1 = a, (at+1, bt+1) /∈ O(cid:63) and t ∈ Tε,γ. Then,
according to IMED-GS(cid:63) strategy (see Algorithm 2), we have

(a, bt) = (at, bt) /∈ (cid:98)O(cid:63)(t) .

From Lemma 15 this implies

(cid:88)

Na,b(cid:48)(t) kl

(cid:16)

(cid:98)µa,b(cid:48)(t)

(cid:12)
(cid:12)(cid:98)µ(cid:63)
(cid:12)
bt

(cid:17)

(t) − ωbt,b(cid:48)

(cid:54) log(Nb(T )) .

(17)

b(cid:48)∈ (cid:98)Ba,bt (t)

Since t ∈ Tε,γ and ε < εν, we have
(cid:8)b(cid:48) ∈ Ba,bt
Combining inequality (17) with inclusion (18), it comes

: Na,b(cid:48)(t) (cid:62) γNat+1,bt+1(t)(cid:9) ⊂ (cid:98)Ba,bt

(t) .

(18)

(cid:88)

b(cid:48)∈Ba,bt : Na,b(cid:48) (t)(cid:62)γNat+1,bt+1 (t)

(cid:16)

Na,b(cid:48)(t) kl

(cid:98)µa,b(cid:48)(t)

(cid:12)
(cid:12)(cid:98)µ(cid:63)
(cid:12)
bt

(cid:17)

(t) − ωbt,b(cid:48)

(cid:54) log(Nb(T )) .

(19)

Since t ∈ Tε,γ, we have

(cid:12)
(cid:12)(cid:98)µ(cid:63)
(cid:12)
bt

(t) − µ(cid:63)
bt

(cid:12)
(cid:12) < ε and ∀b(cid:48) ∈ Ba,bt s.t. Na,b(cid:48)(t) (cid:62) γNat+1,bt+1(t), (cid:12)
(cid:12)
By construction of αν(·) (see Section A), since ε < εν, inequalities (19) and (20) give us
(cid:16)

(cid:12)(cid:98)µa,b(cid:48)(t) − µa,b(cid:48)

(cid:17)

(cid:12)
(cid:12) < ε .

(cid:88)

(cid:54) (1 + αν(ε))) log(Nb(T )) .

Na,b(cid:48)(t) kl

µa,b(cid:48)

(cid:12)
(cid:12)µ(cid:63)
(cid:12)
bt

− ωbt,b(cid:48)

b(cid:48)∈Ba,bt : Na,b(cid:48) (t)(cid:62)γNat+1,bt+1 (t)

(20)

(21)

30

This implies

(cid:88)

b(cid:48)∈Ba,bt

Na,b(cid:48)(t) kl

(cid:16)

µa,b(cid:48)

(cid:12)
(cid:12)µ(cid:63)
(cid:12)
bt

(cid:17)

− ωbt,b(cid:48)

(cid:54) (1 + αν(ε))) log(Nb(T )) + γMνNat+1,bt+1(t) .

Furthermore, using inequality (21), we get

Nat+1,bt+1(t) (cid:54)






Na,bt

(t) (cid:54) (1 + αν(ε)) log(Nb(T ))
(cid:16)

(cid:17)

kl

µa,bt

(cid:12)
(cid:12)
(cid:12)µ(cid:63)
bt
(1 + αν(ε)) log(Nb(T ))
(cid:12)
(cid:16)
(cid:12)
(cid:12)µ(cid:63)
− ωbt,bt+1
bt

µat+1,bt+1

(cid:17)

kl

if ca = c+
a ,

if ca < c+
a .

(22)

Thus, we have shown that for all arm a ∈ A, for all time step 1 (cid:54) t (cid:54) T such that at+1 = a,
(at+1, bt+1) /∈ O(cid:63) and t ∈ Tε,γ:

min
b: (a,b) /∈O(cid:63)

1
log(Nb(T ))

(cid:88)

b(cid:48)∈Ba,b

Na,b(cid:48)(t) kl(µa,b(cid:48)|µ(cid:63)

b − ωb,b(cid:48)) (cid:54) (1 + αν(ε)))

(cid:18)

1 + γ

(cid:19)

Mν
mν

and

Nat+1,bt+1(t) (cid:54) (1 + αν(ε)) log(Nb(T ))

mν

.

This implies for all arm a ∈ A and for all time step 1 (cid:54) t (cid:54) T ,

min
b: (a,b) /∈O(cid:63)

1
log(Nb(T ))

(cid:88)

b(cid:48)∈Ba,b

Na,b(cid:48)(T ) kl(µa,b(cid:48)|µ(cid:63)

b − ωb,b(cid:48)) (cid:54) (1 + αν(ε))

(cid:20)

1 + γ

(cid:21)

Mν
mν

+

Mν |Tε,γ|
minb∈B log(Nb(T ))

and

∀b : (a, b) /∈ O(cid:63), Na,b(T ) (cid:54) (1 + αν(ε)) log(Nb(T ))

mν

+ (cid:12)

(cid:12)T c
ε,γ

(cid:12)
(cid:12) .

It can be easily proved that under IMED-GS(cid:63) Nb(T ) → ∞ for all b ∈ B (see Lemma 27). From
previous Proposition 20, we deduce the following corollary by doing T → ∞, then ε, γ → 0.

Corollary 21 (Pareto optimality) Let ν ∈ Dω. Let a ∈ A such that {b ∈ B : (a, b) /∈ O(cid:63)} (cid:54)= ∅.
Then, we have

lim sup
T →∞

min
b: (a,b) /∈O(cid:63)

1
log(Nb(T ))

(cid:88)

b(cid:48)∈Ba,b

Na,b(cid:48)(T )kl(µa,b(cid:48)|µ(cid:63)

b − ωb,b(cid:48)) (cid:54) 1 .

D.4 IMED-GS(cid:63) is consistent and induces sequences of users with log-frequencies 1B
In this section we show that IMED-GS(cid:63) is a consistent strategy that induces sequences of users with
log-frequencies all equal to 1, independently from the considered bandit conﬁguration in D.

31

Lemma 22 (Consistency, log-frequencies 1B) IMED-GS(cid:63) is a consistent strategy and induces se-
quences of users with log-frequencies all equal to 1.

Proof We ﬁrst show that IMED-GS(cid:63) induces sequences of users with log-frequencies all equal to 1.

Let ν ∈ Dω and let us consider an horizon T (cid:62) 1. Let 0 < ε < εν and γ ∈ (0, 1/2). Let us consider
again the set of times

Tε,γ =

(cid:26)
T (cid:62) t (cid:62) 1 : (cid:98)O(cid:63)(t) = O(cid:63)

∀(a, b) s.t. Na,b(t) (cid:62) γ Nat+1,bt+1(t) or (a, b) ∈ O(cid:63), |(cid:98)µa,b(t) − µa,b| < ε

Then, according to Proposition 20, under IMED-GS(cid:63) strategy,
(cid:12)] (cid:54) 17
(cid:12)

Eν[(cid:12)

(cid:12)T c
ε,γ

γε4 |A|2 |B|2 + 2 |A|2 |B| (1 + Eν)|B| < ∞ .

(cid:27)

.

(23)

and for all horizon time T (cid:62) 1, for all (a, b) /∈ O(cid:63),

Na,b(T ) (cid:54) 1 + αν(ε)

mν

log(Nb(T )) + (cid:12)

(cid:12)T c
ε,γ

(cid:12) (cid:54) 1 + αν(ε)
(cid:12)
mν

log(T ) + (cid:12)

(cid:12)T c
ε,γ

(cid:12)
(cid:12) ,

(24)

where mν = min

(a,b) /∈O(cid:63)
b(cid:48)∈Ba,b

kl(µa,b(cid:48)|µ(cid:63)

b − ωb,b(cid:48)), and εν, αν(·), Eν deﬁned in Appendix A.

Note that, under IMED-GS(cid:63), for all t (cid:62) 1 such that (at+1, bt+1) ∈ (cid:98)O(cid:63)(t) we have
(at+1, bt+1) ∈ argmin
(a,b)∈ (cid:98)O(cid:63)(t)

Na,b(t). This implies by deﬁnition of Tε,γ that

∀(a, b), (a(cid:48), b(cid:48)) ∈ O(cid:63),

(cid:12)Na,b(T ) − Na(cid:48),b(cid:48)(T )(cid:12)
(cid:12)

(cid:12) (cid:54) (cid:12)

(cid:12)T c
ε,γ

(cid:12)
(cid:12) + 1 .

(25)

Indeed the difference of pulls between two optimal couples is non-decreasing only at times t (cid:62) 1
such that the difference is greater than 1 and (cid:98)O(cid:63)(t) (cid:54)= O(cid:63). Combining Eq. 24 and 25 we get

min
b∈B

Nb(T ) (cid:62) min

(a,b)∈O(cid:63)
(cid:62) max
(a,b)∈O(cid:63)

Na,b(T ) − 1
Na,b(T ) − (cid:12)

(cid:12)T c
ε,γ

(cid:12)
(cid:12) − 1

(Eq. 24)

(cid:62) 1
|B|

=

1
|B|

(cid:62) 1
|B|
(cid:62) T
|B|

(cid:88)

Na,b(T ) − (cid:12)

(cid:12)T c
ε,γ

(cid:12)
(cid:12) − 1


 − (cid:12)

(cid:12)T c
ε,γ

(cid:12)
(cid:12) − 1

Na,b(T )

(a,b)∈O(cid:63)


T −

(cid:88)

(a,b) /∈O(cid:63)

(cid:18)

T − (|A| − 1) |B|

(cid:20) 1 + αν(ε)
mν

log(T ) + (cid:12)

(cid:12)T c
ε,γ

(cid:21)(cid:19)
(cid:12)
(cid:12)

− (cid:12)

(cid:12)T c
ε,γ

(cid:12)
(cid:12) − 1

(Eq. 25)

− |A|

1 + αν(ε)
mν

log(T ) − |A| (cid:12)

(cid:12)T c
ε,γ

(cid:12)
(cid:12) − |A| .

(cid:12)
(cid:2)(cid:12)
(cid:3) < ∞ (see Eq. 23), this implies that IMED-GS(cid:63) induces sequences of users with
Since Eν
(cid:12)T c
(cid:12)
ε,γ
log-frequencies all equal to 1.

32

We show the consistency of IMED-GS(cid:63) in the following. Let (a, b) /∈ O(cid:63) and α ∈ (0, 1). According
to Proposition 20,

Na,b(T ) (cid:54) 1 + αν(ε)

mν

log(Nb(T )) + lim sup
T →∞

(cid:12)
(cid:12)T c
ε,γ

(cid:12)
(cid:12) ,

and monotone convergence theorem ensures

Eν[lim sup
T →∞

(cid:12)
(cid:12)T c
ε,γ

(cid:12)
(cid:12)] = lim sup
T →∞

Eν[(cid:12)

(cid:12)T c
ε,γ

(cid:12)] (cid:54) 17
(cid:12)

γε4 |A|2 |B|2 + 2 |A|2 |B| (1 + Eν)|B| < ∞ .

This implies

Na,b(T )
Nb(T )α

(cid:54) 1 + αν(ε)
mν

log(Nb(T ))
Nb(T )α +

lim sup
T →∞

(cid:12)
(cid:12)T c
ε,γ

(cid:12)
(cid:12)

Nb(T )α

,

and, taking the expectation, dominated convergence theorem implies

Eν

(cid:21)

(cid:20) Na,b(T )
Nb(T )α





(cid:54) Eν

1 + αν(ε)
mν

log(Nb(T ))
Nb(T )α +

lim sup
T →∞

(cid:12)
(cid:12)T c
ε,γ

(cid:12)
(cid:12)



Nb(T )α

 → 0 .

Indeed, it can be easily shown that under IMED-GS(cid:63) Nb(T ) → ∞ (see Lemma 27). This implies

lim sup
T →∞

Eν

(cid:21)

(cid:20) Na,b(T )
Nb(T )α

= 0 .

D.5 The counters ca and c+

a coincide at most O (log(log(T ))) times

Let us consider 0 < ε < εν and γ ∈ (0, 1/2). Let us introduce

Tc(T ) :=

(cid:110)
t ∈ Tε,γ : (at+1, bt+1) /∈ O(cid:63) and cat+1(t) = c+

(cid:111)

,

at+1(t)

where Tε,γ is deﬁne as in Appendix D.2.

In this section, we want to bound |Tc(T )|.

Lemma 23 Let 0 < ε < εν and γ ∈ (0, 1/2). Let us consider an horizon T (cid:62) 1. Then, it holds

|Tc(T )| (cid:54) 2 |A| + |A| log2

(cid:18) (1 + αν(ε)) |B|
mν

log(T ) + |B| (cid:12)

(cid:12)T c
ε,γ

(cid:19)
(cid:12)
(cid:12)

.

where mν = min

(a,b) /∈O(cid:63)
b(cid:48)∈Ba,b

kl(µa,b(cid:48)|µ(cid:63)

b − ωb,b(cid:48)), and εν, αν(·) deﬁned in Appendix A.

33

Proof From Lemma 24, we get:

|Tc(T )| (cid:54) 2 |A| +

(cid:88)

a∈A

log2(ca(T )) .

Then applying Lemma 25, it comes:

|Tc(T )| (cid:54) 2 |A| +



log2



(cid:88)

a∈A

(cid:88)

Na,b(T ) + (cid:12)

(cid:12)T c
ε,γ

(cid:12)
(cid:12)

 .



b: (a,b) /∈O(cid:63)

We end the proof by combining the previous inequality with Proposition 20 that ensures

∀(a, b) /∈ O(cid:63), Na,b(T ) (cid:54) (1 + αν(ε))

mν

log(T ) + (cid:12)

(cid:12)T c
ε,γ

(cid:12)
(cid:12) .

Lemma 24 Let 0 < ε < εν and γ ∈ (0, 1/2). Let us consider an horizon T (cid:62) 1. Then, it holds

|Tc(T )| (cid:54) 2 |A| +

(cid:88)

a∈A

log2(ca(T )) .

Refer to Appendix A for the deﬁnition of εν.

Proof Let a ∈ A. By construction of (ca(t))1(cid:54)t(cid:54)T and (c+

a (t))1(cid:54)t(cid:54)T , we have

c+
a (T ) = 2

T
(cid:80)
t=1

I

{ca(t)=c+

a (t)}−1

.

Furthermore, the following inequalities are satisﬁed

|Tc(T )| (cid:54) (cid:88)

T
(cid:88)

a∈A

t=1

I
{ca(t)=c+

a (t)} and ∀a ∈ A, c+

a (T ) (cid:54) 2ca(T ).

(26)

(27)

Then Eq. 26 and 27 imply

2|Tc(T )|−|A| (cid:54) 2|A| (cid:89)

ca(T ) .

a∈A

Lemma 25 Let 0 < ε < εν and γ ∈ (0, 1/2). Let us consider an horizon T (cid:62) 1. Then, it holds

∀a ∈ A,

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

ca(T ) −

(cid:88)

Na,b(T )

b: (a,b) /∈O(cid:63)

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

(cid:54) (cid:12)

(cid:12)T c
ε,γ

(cid:12)
(cid:12) .

Refer to Appendix A for the deﬁnition of εν.
Proof Let a ∈ A. At each time step t (cid:62) 1 we increment ca(t) only if (at+1, bt+1) /∈ (cid:98)O(cid:63)(t) and
at+1 = a. Then, if t ∈ Tε,γ , we have (cid:98)O(cid:63)(t) = O(cid:63) and we increment ca(t) only if we increment one
of the Na,b(t) for b ∈ B such that (a, b) /∈ O(cid:63).

34

D.6 All couples (a, b) ∈ A×B are asymptotically pulled an inﬁnite number of times

Let 0 < ε < εν (deﬁned in Appendix A) and γ ∈ (0, 1/2). Let us consider

(cid:26)

t (cid:62) 1 :

Tε,γ =

(cid:98)O(cid:63)(t) = O(cid:63)
∀(a, b) s.t. Na,b(t) (cid:62) γ Nat+1,bt+1(t) or (a, b) ∈ O(cid:63), |(cid:98)µa,b(t) − µa,b| < ε

(cid:27)

.

Then, according to Proposition 20, under IMED-GS(cid:63) strategy, Eν[(cid:12)
surely (cid:12)

(cid:12)
(cid:12) < ∞.

(cid:12)T c
ε,γ

(cid:12)T c
ε,γ

(cid:12)
(cid:12)] < ∞. In particular, almost

Lemma 26 (The indexes tend to inﬁnity) For all strategy we have lim
t→∞
under IMED-GS(cid:63),

Nat+1,bt+1(t) = ∞ and,

∀(a, b) ∈ A × B,

lim
t→∞

Ia,b(t) = ∞ .

Proof
For all couple (a, b) ∈ A × B such that Na,b(∞) < ∞, we have I{(at+1,bt+1)=(a,b)} → 0. Then

(cid:88)

I{(at+1,bt+1)=(a,b)} → 1 .

(a,b)∈A×B: Na,b(∞)=∞

This implies

(cid:88)

I{(at+1,bt+1)=(a,b)}Na,b(t)

(a,b)∈A×B: Na,b(∞)=∞

(cid:62)

min
(a,b)∈A×B: Na,b(∞)=∞

Na,b(t)

(cid:88)

I{(at+1,bt+1)=(a,b)} −→ ∞ .

(a,b)∈A×B: Na,b(∞)=∞

Thus, since

we have

Nat+1,bt+1(t) =

(cid:88)

I{(at+1,bt+1)=(a,b)}Na,b(t)

(a,b)∈A×B: Na,b(∞)<∞
(cid:88)

+

(a,b)∈A×B: Na,b(∞)=∞

I{(at+1,bt+1)=(a,b)}Na,b(t) ,

Nat+1,bt+1(t) −→ ∞ .

Furthermore, under IMED-GS(cid:63) strategy we have

∀(a, b) ∈ A × B,

Ia,b(t) (cid:62) log(Nat+1,bt+1(t)) ,

which ends the proof.

35

Lemma 27 (The numbers of pulls tend to inﬁnity) Under IMED-GS(cid:63) the numbers of pulls almost
surely satisfy

∀(a, b) ∈ A × B, Na,b(T ) → ∞ .

In particular, almost surely for all (a, b) ∈ A × B,

T →∞ (cid:98)µa,b(T ) = µa,b.
lim

Proof Lemma 26 ensures lim
T →∞
(cid:12)
(cid:12) < ∞ and ∀T ∈ Tε,γ, (cid:98)O(cid:63)(T ) = O(cid:63), we have for all (a, b) ∈ O(cid:63)

Ia,b(T ) = ∞, for all (a, b) ∈ A × B.

Let (a, b) ∈ O(cid:63). Since (cid:12)

(cid:12)T c
ε,γ

lim
T →∞

log(Na,b(T )) = lim
T →∞

Ia,b(T ) = ∞.

Then, for all (a, b) ∈ O(cid:63),

T →∞ (cid:98)µa,b(T ) = µa,b.
Let (a, b) /∈ O(cid:63) and let T ∈ Tε,γ. Then, the following inequalities occur

Na,b(T ) = ∞ and lim

lim
T →∞

Ia,b(T ) (cid:54) (cid:88)

b(cid:48): (a,b(cid:48)) /∈O(cid:63)

Na,b(cid:48)(t)kl((cid:98)µa,b(cid:48)(t)|(cid:98)µ(cid:63)

b (t) − ωb,b(cid:48)) + log(max(1, Na,b(cid:48)(t)))

(28)

and

∀b ∈ B,

(cid:98)µ(cid:63)
b (t) < 1 − εν .

(29)

Since (cid:12)

(cid:12)T c
ε,γ

(cid:12)
(cid:12) < ∞, Eq. 28 and 29 imply

lim
T →∞

(cid:88)

b(cid:48): (a,b(cid:48)) /∈O(cid:63)

Na,b(cid:48)(T ) → ∞ .

Then, since (cid:12)

(cid:12)T c
ε,γ

(cid:12)
(cid:12) < ∞, from Lemma 25 we get

lim
T →∞

ca(T ) = ∞. This implies

argmax (cid:8)t ∈

1, T
(cid:74)

(cid:75)

: ca(t) = c+

a (t)(cid:9) → ∞ and

lim
T →∞

min
b∈B

Na,b(T ) = ∞ .

D.7 Concentration lemmas

We state two concentration lemmas that do not depend on the followed strategy. Lemma 28 comes
from Lemma B.1 in Combes and Proutiere (2014) and Lemma 29 comes from Lemma 14 in Honda
and Takemura (2015). Proofs are provided in Appendix F.

Lemma 28 (Concentration inequalities) Let ν ∈ Dω. For all 0 < ε, γ (cid:54) 1/2 and for all couples
(a, b), (a(cid:48), b(cid:48)) ∈ A×B,

Eν

(cid:34)

(cid:88)

I

t(cid:62)1

{(at+1,bt+1)=(a,b), Na(cid:48),b(cid:48) (t)(cid:62)γNa,b(t), |(cid:98)µa(cid:48),b(cid:48) (t)−µa(cid:48),b(cid:48)|(cid:62)ε}

(cid:35)

(cid:54) 17
γε4 .

36

,

(cid:35)

Lemma 29 (Large deviation probabilities) Let ν ∈ Dω. For all couple (a, b) ∈ A × B, for all
0 < µ < µa,b ,

Eν

(cid:34)
(cid:88)

I

n(cid:62)1

a,b<µ}n exp(nkl((cid:98)µn

{(cid:98)µn

(cid:35)
a,b|µ))

(cid:18)

1−

(cid:54) 6e

log(1 − µ)
log(1 − µa,b)

(cid:19)-1(cid:32)

1−e

(cid:18)
1− log(1−µ)
log(1−µa,b)

(cid:19)

−

(cid:33)-3

kl(µa,b|µ)

where (cid:98)µn

a,b estimates µa,b after n pulls of couple (a, b) (see Appendix A).

D.8 Proof of Lemma 18

Using Lemma 14, for all time step t (cid:62) 1, we have

∀(a(cid:48), b(cid:48)) ∈ (cid:98)O(cid:63)(t), Na(cid:48),b(cid:48)(t) (cid:62) Nat+1,bt+1(t) (cid:62) γ Nat+1,bt+1(t) .

Then, based on the concentration inequalities from Lemma 28, we obtain

Eν[(cid:12)

(cid:12)E c
ε,γ

(cid:12)
(cid:12)] (cid:54)

(cid:88)

(a,b),(a(cid:48),b(cid:48))∈A×B
(cid:88)

(cid:54)

(a,b),(a(cid:48),b(cid:48))∈A×B

(cid:54) 17

γε4 |A|2 |B|2 .

(cid:34)

Eν

(cid:88)

I

t(cid:62)1

17
γε4

{(at+1,bt+1)=(a,b), Na(cid:48),b(cid:48) (t)(cid:62)γNa,b(t), |(cid:98)µa(cid:48),b(cid:48) (t)−µa(cid:48),b(cid:48)|(cid:62)ε}

Furthermore, for t (cid:62) 1 , a ∈ A and B(cid:48) ⊂ B, we have

log (cid:0)Nat+1,bt+1(t)(cid:1) (cid:54) (cid:88)

Na,b(t) kl((cid:98)µa,b(t)|λa,b) + log (Na,b(t))

⇔ Nat+1,bt+1(t) (cid:54) (cid:89)

b∈B(cid:48)

b∈B(cid:48)
Na,b(t)eNa,b(t) kl((cid:98)µa,b(t)|λa,b) ,

where λa,b = µa,b − εν for all couple (a, b) ∈ A × B. Thus, considering estimators of means based

37

on the numbers of pulls ((cid:98)µn
|Λεν | (cid:54) (cid:88)

(cid:88)

I(cid:40)

a,b)(a,b)∈A×B,n(cid:62)1 (see Appendix A), we have

∀b∈B(cid:48), (cid:98)µa,b(t)<λa,b and Nat+1,bt+1

(t)(cid:54) (cid:81)
b∈B(cid:48)

Na,b(t)e

Na,b (t) kl( (cid:98)µa,b (t)|λa,b )

(cid:41)

(cid:88)

(cid:88)

a∈A
B(cid:48)⊂B
(cid:88)

nb(cid:62)0
b∈B(cid:48)
(cid:88)

a∈A
B(cid:48)⊂B

nb(cid:62)1
b∈B(cid:48)

I
{(at+1,bt+1)=(a(cid:48),b(cid:48)),Na,b(t)=nb}

I(cid:40)

∀b∈B(cid:48), (cid:98)µ

nb
a,b<λa,b, Na(cid:48) ,b(cid:48) (t)(cid:54) (cid:81)
b∈B(cid:48)

nbe

nb kl( (cid:98)µ

nb
a,b

|λa,b )

(cid:41)

I
{(at+1,bt+1)=(a(cid:48),b(cid:48))}

I(cid:110)

∀b∈B(cid:48), (cid:98)µ

nb
a,b<λa,b

(cid:111)I(cid:40)

1(cid:54)Na(cid:48) ,b(cid:48) (t)(cid:54) (cid:81)
b∈B(cid:48)

nb kl( (cid:98)µ

a,b|λa,b)(cid:41)
nb

nbe

I
{(at+1,bt+1)=(a(cid:48),b(cid:48))}

I
{Na(cid:48) ,b(cid:48) (t)=0}

t(cid:62)1

a∈A
B(cid:48)⊂B
(cid:88)

=

t(cid:62)1
(a(cid:48),b(cid:48))∈A×B

(cid:54) (cid:88)
t(cid:62)1
(a(cid:48),b(cid:48))∈A×B
(cid:88)

+

t(cid:62)1
(a(cid:48),b(cid:48))∈A×B

(cid:54) (cid:88)

(cid:88)

(cid:88)

I(cid:110)

(a(cid:48),b(cid:48))∈A×B

a∈A
B(cid:48)⊂B

nb(cid:62)1
b∈B(cid:48)

∀b∈B(cid:48), (cid:98)µ

nb
a,b<λa,b

(cid:111)

(cid:88)

t(cid:62)1

I
{(at+1,bt+1)=(a(cid:48),b(cid:48))}

I(cid:40)

1(cid:54)Na(cid:48),b(cid:48) (t)(cid:54) (cid:81)
b∈B(cid:48)

nbe

nb kl( (cid:98)µ

nb
a,b

|λa,b )

(cid:41)

+ |A| |B|
(cid:54) (cid:88)

(cid:88)

(cid:88)

I(cid:110)

(a(cid:48),b(cid:48))∈A×B

a∈A
B(cid:48)⊂B

= |A| |B|

(cid:88)

(cid:88)

nb(cid:62)1
b∈B(cid:48)
(cid:89)

b∈B(cid:48)

nb(cid:62)1
b∈B(cid:48)

a∈A
B(cid:48)⊂B


1 +





= |A| |B|

∀b∈B(cid:48), (cid:98)µ

nb
a,b<λa,b

(cid:111)

(cid:89)

nbenb kl((cid:98)µ

nb
a,b,λa,b) + |A| |B|

b∈B(cid:48)

I(cid:110)

nb
a,b<λa,b

(cid:98)µ

(cid:16)
nb
a,b|λa,b
(cid:98)µ
(cid:111)nbenb kl

(cid:17)

+ |A| |B|

(cid:88)

(cid:89)

(cid:88)

I(cid:110)

b∈B(cid:48)

n(cid:62)1

a∈A
B(cid:48)⊂B

(cid:111)nen kl((cid:98)µn

a,b|λa,b)

(cid:98)µn
a,b<λa,b







and



Eν[|Λεν |] (cid:54) |A| |B|


1 +

(cid:88)

(cid:89)

Eν

b∈B(cid:48)

a∈A
B(cid:48)⊂B

(cid:34)

(cid:88)

n(cid:62)1

I
{(cid:98)µn

a,b<λa,b}nen kl((cid:98)µn

a,b,λa,b)

Then, by applying Lemma 29 based on large deviation inequalities, we have

∀(a, b) ∈ A × B, Eν

(cid:34)

(cid:88)

I

n(cid:62)1

a,b<λa,b}nen kl((cid:98)µn

{(cid:98)µn

a,b,λa,b)

(cid:35)

(cid:54) Eν ,



(cid:35)

 .

(30)

(31)

where Eν = 6e max

a∈A,b∈B

(cid:16)

1 − log(1−λa,b)
log(1−µa,b)

(cid:32)

(cid:17)−1

−(1−

1 − e

log(1−λa,b)
log(1−µa,b) )kl(µa,b|λa,b)

(cid:33)−3

.

By combining Eq. 30 and 31, we conclude that

Eν[|Λεν |] (cid:54) |A| |B|

(cid:16)

1 + |A| (1 + Eν)|B|(cid:17)

(cid:54) 2 |A|2 |B| (1 + Eν)|B| .

Appendix E. IMED-GS(cid:63): Proof of Theorem 11 (main result)

In this section we prove the asymptotic optimality of IMED-GS(cid:63) strategy. The proof is based on the
ﬁnite time analysis detailed in Appendix D.

38

E.1 Almost surely nopt(T ) tends to nν

For a ∈ A such that Ba = {b ∈ B : (a, b) /∈ O(cid:63)} (cid:54)= ∅, let us deﬁne the linear programming

C(cid:63)

ω,a(ν) := min
n∈RBa
+

(cid:88)

b∈Ba

nb∆a,b

s.t.

∀b ∈ Ba :

(cid:88)

b(cid:48)∈Ba

kl+(µa,b(cid:48)|µ(cid:63)

b − ωb,b(cid:48))na,b(cid:48) (cid:62) 1 .

Then (nν
we can state the following lemma.

a,b)b∈Ba is the unique optimal solution of the previous minimization problem. Furthermore,

Lemma 30 lim
T →∞

(nopt

a,b(T ))b∈Ba = (nν

a,b)b∈Ba.

Proof This a direct application of Lemma 31 and Lemma 43 stated below.

Lemma 31 Let 0 < ε < εν (see Appendix A) and γ ∈ (0, 1). Let a ∈ A such that Ba =
{b ∈ B : (a, b) /∈ O(cid:63)}. Let us consider for T (cid:62) 1, (cid:98)Ka(T ) = (kl+((cid:98)µa,b(cid:48)(T )|(cid:98)µ(cid:63)
b (T ) − ωb,b(cid:48)))b,b(cid:48)∈Ba,
the vector (cid:98)∆a(T ) = ((cid:98)µ(cid:63)
b (T ) − (cid:98)µa,b(T ))b∈Ba and the parameter (cid:98)ha(T ) = ( (cid:98)Ka(T ), (cid:98)∆a(T )). We also
consider
(cid:111)

(cid:110)

Ha :=

(cid:98)ha(T )

, T ∈ Tε,γ

,

where Tε,γ, deﬁned in Appendix D.2, satisﬁes (cid:12)

(cid:12)T c
ε,γ

(cid:12)
(cid:12) < ∞. Then, we have

∀h = (K, ∆) ∈ Ha, K (cid:54)= 0 and

min
h=(K,∆)∈Ha

min
b∈Ba

∆b > 0.

Proof Let h = (K, ∆) ∈ Ha. There exists T ∈ Tε,γ such that h = (K, ∆) = (cid:98)ha(T ) =
( (cid:98)Ka(T ), (cid:98)∆a(T )). Since T ∈ Tε,γ, we have (cid:98)O(cid:63)(T ) = O(cid:63). In particular for all b ∈ Ba, Kb,b =
(cid:98)Ka,b,b(T ) = kl+((cid:98)µa,b(T )|(cid:98)µ(cid:63)

b (T )) > 0. Furthermore, we have

min
b∈Ba

∆b = min
b∈Ba

(cid:98)∆a,b(T ) = min

b∈ (cid:98)Ba(T )

(cid:98)µ(cid:63)
b (T ) − (cid:98)µa,b(T ) > 0 .

Lastly since ∀b ∈ Ba, (cid:98)µ(cid:63)

b (∞) = µ(cid:63)

b , (cid:98)µa,b(∞) = µa,b, we have

min
b∈Ba

(cid:98)∆a,b(T ) → min
b∈Ba

µ(cid:63)

b − µa,b > 0

and

min
h=(K,∆)∈Ha

min
b∈Ba

∆b = min

T /∈E∪T0

min
b∈Ba

(cid:98)∆a,b(T ) > 0 .

39

E.2 Almost surely and on expectation, for all sub-optimal couple

Na,b(T )
log(T )

tends to nν
a,b

Combining the upper bounds from the ﬁnite analysis and the asymptotic behaviour of nopt(·), we
prove the asymptotic optimality of IMED-GS(cid:63).
Lemma 32 (Asymptotic upper bounds) For all sub-optimal couple (a, b) /∈ O(cid:63),

Na,b(T )
log(T )
Proof Let 0 < ε < εν (see Appendix A) and γ ∈ (0, 1/2). Let (a, b) /∈ O(cid:63) and let us consider an
horizon T (cid:62) 1. Let us introduce the random variable

lim sup
T →∞

(cid:54) nν

a,b .

τ := min {t ∈

s.t. t ∈ Tε,γ \ Tc(T ) and (at+1, bt+1) = (a, b)} ,

1, T
(cid:74)

(cid:75)

(cid:12)T c
ε,γ

where Tε,γ and T (T ) are respectively introduced in Appendix D.2 and D.5 . Then, by deﬁnition of τ
and since (cid:12)

(cid:12)
(cid:12) < ∞, from Lemma 23 we have
Na,b(T ) (cid:54) Na,b(τ ) + (cid:12)
Furthermore, since τ /∈ Tc(T ) we have ca(τ ) (cid:54)= c+
(aτ +1, bτ +1) /∈ O(cid:63), Lemma 15 implies the following empirical upper bound

(cid:12)
(cid:12) + |Tc(T )| = Na,b(τ ) + O (log(log(T ))) .

a (τ ). In addition, since τ ∈ Tε,γ and (a, b) =

(cid:12)T c
ε,γ

(32)

Na,b(τ ) (cid:54) log(τ )nopt
In particular, since log(τ ) (cid:54) log(T ), Eq. 32 and 33 imply

a,b(τ ) .

(33)

a.s.

Na,b(T )
log(T )

(cid:54)

Na,b(τ )
log(τ )

+

O (log(log(T )))
log(T )

(cid:54) nopt(τ ) +

O (log(log(T )))
log(T )

and, since a.s.

lim
T →∞

τ = ∞, from Lemma 30 we get

a.s

lim sup
T →∞

Na,b(T )
log(T )

(cid:54) lim sup
T →∞

nopt
a,b(τ ) + lim sup
T →∞

O (log(log(T )))
log(T )

= nν

a,b .

Lemma 33 (Asymptotic optimality) For all sub-optimal couple (a, b) /∈ O(cid:63), we have

a.s.

lim
T →∞

Na,b(T )
log(T )

= nν

a,b and

lim
T →∞

Eν

(cid:21)

(cid:20) Na,b(T )
log(T )

= nν

a,b .

Proof Since IMED-GS(cid:63) is a consistent strategy that induces sequences of users with log-frequencies
equal to 1, we have

∀(a, b) (cid:54)= O(cid:63),

lim inf
T →∞

1
log(T )

(cid:88)

b(cid:48)∈Ba

Na,b(cid:48)(T )kl+(µa,b(cid:48)|µ(cid:63)

b − ωb,b(cid:48)) (cid:62) 1 .

Then, Pareto-optimality of IMED-GS(cid:63) combined with asymptotic upper bounds given in Lemma 32
ensures that for all (a, b) /∈ O(cid:63), Na,b(T )/ log(T ) → nν
a,b. Since, the Na,b(T )/ log(T ) are dominated
by an integrable variable (see Proposition 20 in Appendix D), we also have these convergences on
average.

40

Appendix F. Concentration lemmas: Proofs

Lemma Let ν ∈ Dω. For all 0 < ε, γ (cid:54) 1/2 and for all couples (a, b), (a(cid:48), b(cid:48)) ∈ A×B,

Eν

(cid:34)

(cid:88)

I

t(cid:62)1

{(at+1,bt+1)=(a,b), Na(cid:48),b(cid:48) (t)(cid:62)γNa,b(t), |(cid:98)µa(cid:48),b(cid:48) (t)−µa(cid:48),b(cid:48)|(cid:62)ε}

(cid:35)

(cid:54) 17
γε4 .

Proof Considering the stopping times τ n
(cid:80)
t(cid:62)1

a,b = inf {t (cid:62) 1, Na,b(t) = n} we will rewrite the sum
{(at+1,bt+1)=(a,b), Na(cid:48),b(cid:48) (t)(cid:62)γNa,b(t), |(cid:98)µa(cid:48),b(cid:48) (t)−µa(cid:48),b(cid:48)|(cid:62)ε} and use an Hoeffding’s type argument.

I

I
{(at+1,bt+1)=(a,b), Na(cid:48),b(cid:48) (t)(cid:62)γNa,b(t), |(cid:98)µa(cid:48),b(cid:48) (t)−µa(cid:48),b(cid:48)|(cid:62)ε}

I
{τ n

a,b=t+1,Na(cid:48),b(cid:48) (t)=m}

I(cid:110)

m(cid:62)γ(n−1),

(cid:12)
(cid:12)
(cid:12)(cid:98)µm

a(cid:48),b(cid:48) −µa(cid:48),b(cid:48)

(cid:111)

(cid:12)
(cid:62)ε
(cid:12)
(cid:12)

(cid:88)

t(cid:62)1
(cid:54) (cid:88)
t(cid:62)1
(cid:88)

=

(cid:88)

n(cid:62)1, m(cid:62)0
(cid:88)
I(cid:110)

m(cid:62)0
(cid:54) (cid:88)
m(cid:62)0
(cid:54) (cid:88)
m(cid:62)0

n(cid:62)1
(cid:88)

n(cid:62)1
(cid:88)

n(cid:62)1

m(cid:62)γ(n−1),

(cid:12)
(cid:12)
(cid:12)(cid:98)µm

a(cid:48),b(cid:48) −µa(cid:48),b(cid:48)

(cid:111)

(cid:12)
(cid:62)ε
(cid:12)
(cid:12)

I(cid:110)

m(cid:62)γ(n−1),

(cid:12)
(cid:12)
(cid:12)(cid:98)µm

a(cid:48),b(cid:48) −µa(cid:48),b(cid:48)

(cid:111)

(cid:12)
(cid:62)ε
(cid:12)
(cid:12)

I(cid:110)

m(cid:62)γ(n−1),

(cid:12)
(cid:12)
(cid:12)(cid:98)µm

a(cid:48),b(cid:48) −µa(cid:48),b(cid:48)

(cid:111)

(cid:12)
(cid:62)ε
(cid:12)
(cid:12)

(cid:88)

t(cid:62)1
(cid:88)

t(cid:62)1

I
{τ n

a,b=t+1,Na(cid:48),b(cid:48) (t)=m}

I
{τ n

a,b=t+1}

Taking the expectation , it comes:

(cid:34)

(cid:88)

Eν

I
{(at+1,bt+1)=(a,b), Na(cid:48),b(cid:48) (t)(cid:62)γNa,b(t), |(cid:98)µa(cid:48),b(cid:48) (t)−µa(cid:48),b(cid:48)|(cid:62)ε}

(cid:35)

I{m(cid:62)γ(n−1)}Pν (|(cid:98)µm

a(cid:48) − µa(cid:48)| (cid:62) ε)

I{m(cid:62)γ(n−1)}2e−2mε2

(Hoeffding inequality)

t(cid:62)1
(cid:88)

n(cid:62)1
(cid:88)

(cid:54) (cid:88)
m(cid:62)0
(cid:54) (cid:88)
m(cid:62)0

= 2

= 2

=

1
γ

=

1
γ
(cid:54) 1
γ

n(cid:62)1
(cid:18) m
γ

(cid:88)

m(cid:62)0
(cid:88)

m(cid:62)1

(cid:19)

+ 1

e−2mε2

m
γ

e−2mε2

+ 2

e−2mε2

(cid:88)

m(cid:62)0

2e−2ε2
(1 − e−2ε2)2
2e2ε2
(e2ε2 − 1)2
8e1/2
ε4 +

e2ε2
2ε2

+

+

1
1 − e−2ε2
e2ε2
e2ε2 − 1
(cid:54) 17
γε4 .

41

Lemma Let ν ∈ Dω. For all couple (a, b) ∈ A×B, for all 0 < µ < µa,b,

Eν

(cid:34)

(cid:88)

n(cid:62)1

I
{(cid:98)µn

a,b<µ}n exp(nkl((cid:98)µn

(cid:35)
a,b|µ))

(cid:54)

(1 − log(1−µ)

log(1−µa,b) )

6e

(cid:18)

1 − e

−(1− log(1−µ)

log(1−µa,b) )kl(µa,b|µ)(cid:19)3 ,

where (cid:98)µn

a,b estimates µa,b after n pulls of couple (a, b) (see Appendix A).

Proof The proof is based on a Chernoff type inequality and a calculation by measurement change.
The proof comes from Honda and Takemura (2015). We explicit here the particular case of Bernoulli
distributions for completeness.

Let us rephrase Proposition 11 from Honda and Takemura (2015). Since we consider Bernoulli
distributions, we get a more explicit formulation.

Proposition 34 Let ν ∈ Dω. Let (a, b) ∈ A × B and 0 < µ < µa,b. Then, for all n (cid:62) 0 and u ∈ R,
we have

Pν(kl((cid:98)µn

a,b|µ) (cid:62) u, (cid:98)µn

a,b

(cid:54) µ) (cid:54)






e−nkl(µa,b|µ)

2e(1 + log(1−µa,b)

log(1−µ) n)e−n

if u (cid:54) log(1−µ)
log(1−µa,b) kl(µa,b|µ)
log(1−µa,b)
log(1−µ) u

otherwise.

42

We know rewrite equality (27) from Honda and Takemura (2015) with our notations.
Let n (cid:62) 1. We have from Proposition 34 that :

=

=

=

=

+

(cid:54)

+

(cid:104)
I

Eν
(cid:90) ∞

a,b|µ)(cid:105)

(cid:54)µ}nenkl((cid:98)µn
I
{(cid:98)µn

a,b

(cid:54)µ}nenkl((cid:98)µn

{(cid:98)µn
a,b
(cid:16)

Pν

(cid:17)
a,b|µ) > x

d x

(cid:16)

Pν

nenkl((cid:98)µn

(cid:17)

(cid:54) µ

dx

a,b

a,b|µ) > x, (cid:98)µn
(cid:0)kl((cid:98)µn

a,b|µ) > u, (cid:98)µn

a,b

n2enuPν

−∞
(cid:90) kl(µa,b|µ) log(1−µ)
log(1−µa,b)

0
(cid:90) ∞

0
(cid:90) ∞

−∞
(cid:90) ∞

kl(µa,b|µ) log(1−µ)
log(1−µa,b)
(cid:90) kl(µa,b|µ) log(1−µ)
log(1−µa,b)

n2enue−nkl(µa,b|µ) du

n2enuPν

(cid:0)kl((cid:98)µn

a,b|µ) > u, (cid:98)µn

a,b

(cid:54) µ(cid:1) du

n2enuPν

(cid:0)kl((cid:98)µn

a,b|µ) > u, (cid:98)µn

a,b

(cid:54) µ(cid:1) du

(cid:54) µ(cid:1) du

(x = nenu, dx = n2enu du)

−∞
(cid:90) ∞

kl(µa,b|µ) log(1−µ)
log(1−µa,b)

n2enu2e(1 +

log(1 − µa,b)
log(1 − µ)

n)e−n

log(1−µa,b)
log(1−µ) u du (Proposition 34)

= ne−nkl(µa,b|µ)

(cid:90) kl(µa,b|µ) log(1−µ)
log(1−µa,b)

nenu du

+ 2ne(1 +

−∞
log(1 − µa,b)
log(1 − µ)

n)

(cid:90) ∞

kl(µa,b|µ) log(1−µ)
log(1−µa,b)

ne−(

log(1−µa,b)
log(1−µ) −1)nu du

−n(1− log(1−µ)

log(1−µa,b) )kl(µa,b|µ)

= ne

+ 2ne(1 +

log(1 − µa,b)
log(1 − µ)

e

n)

−n(1− log(1−µ)

log(1−µa,b) )kl(µa,b|µ)

log(1−µa,b)
log(1−µ) − 1



=

1 +



 ne

2e

log(1−µa,b)
log(1−µ) − 1

−n(1− log(1−µ)

log(1−µa,b) )kl(µa,b|µ)

+

2e
1 − log(1−µ)
log(1−µa,b)

n2e

−n(1− log(1−µ)

log(1−µa,b) )kl(µa,b|µ)

To ends the proof, we use the following inequalities for r > 0:

ne−nr (cid:54)

1
(1 − e−r)2

(cid:54)

1
(1 − e−r)3

n2e−nr (cid:54)

2
(1 − e−r)3 .

(cid:88)

n(cid:62)1
(cid:88)

n(cid:62)1

43

Appendix G. IMED-GS, IMED-GS2, IMED-GS(cid:63)

2: Finite-time analysis

In this subsection we rewrite and adapt the results established in Sections D, E for IMED-GS(cid:63) strategy
to the other considered strategies. Mainly, we rewrite the empirical lower bounds and upper bounds
detailed in Lemmas 14, and 15. These inequalities form the basis of the analysis of IMED-GS(cid:63) strategy.
For the sake of brevity and clarity, proofs are not given.

G.1 IMED-GS ﬁnite-time analysis

Under IMED-GS strategy we do not solve empirical versions of optimisation problem 2 and pull the
couples with minimum (pseudo) indexes. This leads to the following empirical bounds.

Lemma 35 (IMED-GS: Empirical lower bounds) Under IMED-GS, at each step time t (cid:62) 1, for all
couple (a, b) /∈ (cid:98)O(cid:63)(t),

log (cid:0)Nat+1,bt+1(t)(cid:1) (cid:54) (cid:88)

Na,b(cid:48)(t) kl(cid:0)

b(cid:48)∈ (cid:98)Ba,b(t)

Furthermore, for all couple (a, b) ∈ (cid:98)O(cid:63)(t),

(cid:98)µa,b(cid:48)(t)(cid:12)

(cid:12)(cid:98)µ(cid:63)

b (t) − ωb,b(cid:48)

(cid:1) + log (cid:0)Na,b(cid:48)(t)(cid:1) .

Nat+1,bt+1(t) (cid:54) Na,b(t) .

Lemma 36 (IMED-GS: Empirical upper bounds) Under IMED-GS, at each step time t (cid:62) 1 such that
(at+1, bt+1) /∈ (cid:98)O(cid:63)(t) we have

(cid:88)

Nat+1,b(cid:48)(t) kl

(cid:16)

(cid:12)
(cid:12)(cid:98)µ(cid:63)
(cid:12)
(cid:98)µat+1,b(cid:48)(t)

bt+1(t) − ωbt+1,b(cid:48)

(cid:17)

(cid:54) log(cid:0)Nbt+1(t)(cid:1) .

b(cid:48)∈ (cid:98)Bat+1,bt+1 (t)

In particular

Nat+1,bt+1(t) kl

(cid:16)

(cid:12)
(cid:12)(cid:98)µ(cid:63)
(cid:12)
(cid:98)µat+1,bt+1(t)

(cid:17)
bt+1(t)

(cid:54) log(cid:0)Nbt+1(t)(cid:1) .

Based on this lemmas, one can prove IMED-GS Pareto-optimality in a similar way as for IMED-GS(cid:63)
strategy.

Proposition 37 (IMED-GS: Upper bounds ) Let ν ∈ Dω. Let 0 < ε < εν and γ ∈ (0, 1/2). Let us
introduce

(cid:26)

t (cid:62) 1 :

Tε,γ :=

(cid:98)O(cid:63)(t) = O(cid:63)
∀(a, b) s.t. Na,b(t) (cid:62) γ Nat+1,bt+1(t) or (a, b) ∈ O(cid:63), |(cid:98)µa,b(t) − µa,b| < ε

(cid:27)

.

Then under IMED-GS strategy,

Eν[(cid:12)

(cid:12)T c
ε,γ

(cid:12)] (cid:54) 17
(cid:12)

γε4 |A|2 |B|2 + 2 |A|2 |B| (1 + Eν)|B|

44

and for all horizon time T (cid:62) 1, for all arm a ∈ A,

min
b: (a,b) /∈O(cid:63)

1
log(Nb(T ))

(cid:88)

b(cid:48)∈Ba,b

Na,b(cid:48)(T ) kl(µa,b(cid:48)|µ(cid:63)

b − ωb,b(cid:48)) (cid:54) (1 + αν(ε))

(cid:20)

1 + γ

(cid:21)

Mν
mν

+

Mν |Tε,γ|
minb∈B log(Nb(T ))

where mν and Mν are deﬁned as follows:

mν = min

(a,b) /∈O(cid:63)
b(cid:48)∈Ba,b

kl(µa,b(cid:48)|µ(cid:63)

b − ωb,b(cid:48)),

Mν = max

(a,b) /∈O(cid:63)

(cid:88)

b(cid:48)∈Ba,b

kl(µa,b(cid:48)|µ(cid:63)

b − ωb,b(cid:48)) .

Furthermore, we have

∀(a, b) /∈ O(cid:63),

Na,b(T )
log(Nb(T ))

(cid:54) 1 + αν(ε)
kl(µa,b|µ(cid:63)
b )

+

(cid:12)
(cid:12)

(cid:12)
(cid:12)T c
ε,γ
log(Nb(T ))

.

Refer to Appendix A for the deﬁnitions of εν, αν(·) and Eν.

From the previous proposition, we deduce the following corollary by doing T → ∞, then ε, γ → 0.

Corollary 38 (IMED-GS: Pareto optimality) Let ν ∈ Dω. Under IMED-GS strategy we have

∀a ∈ A,

lim sup
T →∞

min
b: (a,b) /∈O(cid:63)

1
log(Nb(T ))

(cid:88)

b(cid:48)∈Ba,b

Na,b(cid:48)(T )kl(µa,b(cid:48)|µ(cid:63)

b − ωb,b(cid:48)) (cid:54) 1 .

G.2 Uncontrolled scenario: Finite-time analysis

When uncontrolled scenario is considered, the learner does not choose the users to deal with and the
exploration phases may be performed with some delay. This can be formalized within the empirical
bounds induced by IMED-GS2 and IMED-GS(cid:63)
2 strategies.

G.2.1 EMPIRICAL BOUNDS ON THE NUMBERS OF PULLS
For time step t (cid:62) 1, let us introduce the last return time of couple (at+1, bt+1) ∈ B as

τt := min (cid:8)t − t(cid:48) : bt(cid:48) = bt+1, t (cid:62) t(cid:48) (cid:62) 1(cid:9) .

By deﬁnition of τt we have

Nat+1,bt+1(t) = Nat+1,bt+1(t − τt) .

Now, empirical bounds on the numbers of pull can be formulated for the uncontrolled scenario.
These inequalities are the same as those for the controlled scenario up to (random) time-delays.

Lemma 39 (Uncontrolled scenario: Empirical lower bounds) Under IMED-GS2 and IMED-GS(cid:63)
2, at
each step time t (cid:62) 1 there exists a random time delay σt such that 0 (cid:54) σt (cid:54) τt and for all couple
(a, b) /∈ (cid:98)O(cid:63)(t−σt)
log(cid:0)Nat+1,bt+1(t−σt)(cid:1) (cid:54) (cid:88)

(cid:1)+log(cid:0)Na,b(cid:48)(t−σt)(cid:1) .

Na,b(cid:48)(t−σt) kl(cid:0)

b (t−σt)−ωb,b(cid:48)

(cid:98)µa,b(cid:48)(t−σt)(cid:12)

(cid:12)(cid:98)µ(cid:63)

b(cid:48)∈ (cid:98)Ba,b(t−σt)

45

Furthermore, for all couple (a, b) ∈ (cid:98)O(cid:63)(t−σt),

Nat+1,bt+1(t−σt) (cid:54) Na,b(t−σt) .

Lemma 40 (Empirical upper bounds) Under IMED-GS2 and IMED-GS(cid:63)
that (at+1, bt+1) /∈ (cid:98)O(cid:63)(t), we have

2, at each step time t (cid:62) 1 such

(cid:88)

Nat+1,b(cid:48)(t−σt) kl

(cid:16)

(cid:12)
(cid:12)(cid:98)µ(cid:63)
(cid:12)
(cid:98)µat+1,b(cid:48)(t−σt)
bt

(t−σt) − ωbt,b(cid:48)

(cid:17)

(cid:54) log(Nb(t−σt)) ,

b(cid:48)∈ (cid:98)Bat+1,bt (t−σt)

where σt is a random time delay such that 0 (cid:54) σt (cid:54) τt. Furthermore, we have under IMED-GS2

bt+1 = bt,

Nat+1,bt+1(t−σt) kl

(cid:16)

(cid:98)µat+1,bt+1(t−σt)

(cid:12)
(cid:12)(cid:98)µ(cid:63)
(cid:12)

(cid:17)
bt+1(t−σt)

(cid:54) log(cid:0)Nbt+1(t−σt)(cid:1)

and under IMED-GS(cid:63)
2

Nat+1,bt+1(t−σt)
log(t−σt)

(cid:54)






(cid:16)

kl

(cid:98)µat+1,bt


min



1

(cid:12)
(cid:12)
(cid:12)(cid:98)µ(cid:63)
(t−σt)
bt

(t−σt)

(cid:17) , if cat+1(t−σt) = c+

at+1(t−σt)

1
(cid:12)
(cid:12)
(cid:12)(cid:98)µ(cid:63)
(cid:98)µat+1,bt+1(t−σt)
bt

(cid:16)

kl



(cid:17) , nopt

at+1,bt+1

(t−σt)

, else.

(t−σt) − ωbt,bt+1

Thus, we prove respectively the Pareto-optimality and optimality of IMED-GS2 and IMED-GS(cid:63)
2 since
we show that the empirical means (cid:98)µa,b(t−σt) of couples (a, b) involved in the previous inequalities
concentrate as in the case of the controlled scenario. This is the case as it is stated in Lemmas 41 of
the next subsection.

G.2.2 CONCENTRATION INEQUALITY WITH BOUNDED TIME DELAYS

We prove a concentration lemma that does not depend on the followed strategy. It is a rewritting for
the case of controlled scenario of Lemma 28.

Lemma 41 (Concentration inequalities) Let ν ∈ Dω, 0 < ε, γ (cid:54) 1/2 and (a, b), (a(cid:48), b(cid:48)) ∈ A×B.
Then for all sequence of stopping times (σt)t(cid:62)1 such that 0 (cid:54) σt (cid:54) τt for all t (cid:62) 1, we have

(cid:34)

Eν

(cid:88)

t(cid:62)1

I
{(at+1,bt+1)=(a,b), Na(cid:48),b(cid:48) (t−σt)(cid:62)γNa,b(t−σt), |(cid:98)µa(cid:48),b(cid:48) (t−σt)−µa(cid:48),b(cid:48)|(cid:62)ε}

(cid:35)

(cid:54) 17
γε4 .

Remark 42 There is no need to adapt Lemma 29 for the case of controlled scenario since this
concentration lemma does not involve the current time steps explicitly.

Proof It is pointed out that for all time step t (cid:62) 1, Nat+1,bt+1(t−σt) (cid:62) Nat+1,bt+1(t−τt) = Nat+1,bt+1(t),
then we proceed as in Appendix F.

Considering the stopping times τ n

a,b = inf {t (cid:62) 1, Na,b(t) = n} we will rewrite the sum

(cid:88)

I

t(cid:62)1

{(at+1,bt+1)=(a,b), Na(cid:48),b(cid:48) (t−σt)(cid:62)γNa,b(t−σt), |(cid:98)µa(cid:48),b(cid:48) (t−σt)−µa(cid:48),b(cid:48)|(cid:62)ε}

46

and use an Hoeffding’s type argument.

I

I

{(at+1,bt+1)=(a,b), Na(cid:48),b(cid:48) (t−σt)(cid:62)γNa,b(t−σt), |(cid:98)µa(cid:48),b(cid:48) (t−σt)−µa(cid:48),b(cid:48)|(cid:62)ε}

{(at+1,bt+1)=(a,b), Na(cid:48),b(cid:48) (t−σt)(cid:62)γNa,b(t), |(cid:98)µa(cid:48),b(cid:48) (t−σt)−µa(cid:48),b(cid:48)|(cid:62)ε}

{τ n

a,b=t+1,Na(cid:48),b(cid:48) (t−σt)=m}

I(cid:110)

m(cid:62)γ(n−1),

(cid:12)
(cid:12)
(cid:12)(cid:98)µm

a(cid:48),b(cid:48) −µa(cid:48),b(cid:48)

(cid:111)

(cid:12)
(cid:62)ε
(cid:12)
(cid:12)

(cid:88)

t(cid:62)1
(cid:54) (cid:88)
t(cid:62)1
(cid:54) (cid:88)
t(cid:62)1
(cid:88)

=

(cid:88)

I

n(cid:62)1, m(cid:62)0
(cid:88)
I(cid:110)

m(cid:62)0
(cid:54) (cid:88)
m(cid:62)0
(cid:54) (cid:88)
m(cid:62)0

n(cid:62)1
(cid:88)

n(cid:62)1
(cid:88)

n(cid:62)1

m(cid:62)γ(n−1),

(cid:12)
(cid:12)
(cid:12)(cid:98)µm

a(cid:48),b(cid:48) −µa(cid:48),b(cid:48)

(cid:111)

(cid:12)
(cid:62)ε
(cid:12)
(cid:12)

I(cid:110)

m(cid:62)γ(n−1),

(cid:12)
(cid:12)
(cid:12)(cid:98)µm

a(cid:48),b(cid:48) −µa(cid:48),b(cid:48)

(cid:111)

(cid:12)
(cid:62)ε
(cid:12)
(cid:12)

I(cid:110)

m(cid:62)γ(n−1),

(cid:12)
(cid:12)
(cid:12)(cid:98)µm

a(cid:48),b(cid:48) −µa(cid:48),b(cid:48)

(cid:111) ,

(cid:12)
(cid:62)ε
(cid:12)
(cid:12)

(cid:88)

t(cid:62)1
(cid:88)

t(cid:62)1

I
{τ n

a,b=t+1,Na(cid:48),b(cid:48) (t−σt)=m}

I
{τ n

a,b=t+1}

where the (cid:98)µm

a(cid:48),b(cid:48) are deﬁned in Appendix A. The proof ends the same way as in Appendix F.

Appendix H. Continuity of solutions to parametric linear programs

In this section we recall Lemma 13 established in Magureanu et al. (2014) on the continuity of
solutions to parametric linear programs.

Lemma 43 Consider K ∈ RB×B
the function Q and the set-valued map Q(cid:63)

, ∆ ∈ RB

+

+, and H ⊂ RB×B

+ × RB

+. Deﬁne h = (K, ∆). Consider

Q(h) = inf
x∈RB
+

{∆ · x|K · x (cid:62) 1}

Q(cid:63)(h) = {x (cid:62) 0 : ∆ · x (cid:54) Q(h)|K · x (cid:62) 1} .

Assume that:
(i) For all h ∈ H, all rows and columns of K are non-identically 0
(ii) min
h∈H

∆b > 0.

min
b∈B

Then:
(a) Q is continuous on H
(b) Q(cid:63) is upper hemicontinuous on H.

Appendix I. Details on numerical experiments

For the ﬁxed conﬁguration experiments we used the weight matrix ω of Table 1 and the conﬁguration
ν described in Table 2. ω and ν have been chosen at random in such a way that the regret under IMED
exceeds the structured lower bound on the regret. This means the structure ω is informative for the
bandit conﬁguration ν and not taking it into account hinders optimality.

47

user\user
b1
b2
b3
b4
b5
b6
b7
b8
b9
b10

b1
0
0.07
0.07
0.12
0.20
0.05
0.16
0.14
0.28
0.03

b2
0.07
0
0.14
0.13
0.21
0.12
0.09
0.07
0.21
0.04

b3
0.07
0.14
0
0.19
0.27
0.12
0.11
0.13
0.25
0.10

b4
0.12
0.13
0.19
0
0.26
0.17
0.22
0.20
0.34
0.09

b5
0.20
0.21
0.27
0.26
0
0.25
0.18
0.20
0.32
0.17

b6
0.05
0.12
0.12
0.17
0.25
0
0.21
0.19
0.33
0.08

b7
0.16
0.09
0.11
0.22
0.18
0.21
0
0.02
0.14
0.13

b8
0.14
0.07
0.13
0.20
0.20
0.19
0.02
0
0.16
0.11

b9
0.28
0.21
0.25
0.34
0.32
0.33
0.14
0.16
0
0.25

b10
0.03
0.04
0.10
0.09
0.17
0.08
0.13
0.11
0.25
0

Table 1: weight matrix ω used in the ﬁxed conﬁguration experiment.

arm \user
a1
a2
a3
a4
a5

b1
0.15
0.70
0.13
0.02
0.95

b2
0.11
0.73
0.14
0.04
0.98

b3
0.19
0.71
0.13
0.09
1.00

b4
0.19
0.71
0.15
0.05
0.97

b5
0.08
0.70
0.02
0.16
0.98

b6
0.15
0.71
0.08
0.02
0.98

b7
0.09
0.78
0.17
0.11
0.90

b8
0.08
0.79
0.17
0.11
0.91

b9
0.13
0.64
0.04
0.06
0.84

b10
0.13
0.70
0.14
0.01
0.97

Table 2: conﬁguration ν used in the ﬁxed conﬁguration experiment.

Figure 4: minb∈B Nb(·) approximated over 1000 runs. At each run we sample uniformly at random
a weight matrix ω and then sample uniformly at random a conﬁguration ν ∈ Dω.

48

