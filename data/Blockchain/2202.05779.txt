The Evolution of Blockchain: from Lit to Dark∗

Agostino Capponi†, Ruizhe Jia‡, Ye Wang§

Abstract

Transactions submitted through the blockchain peer-to-peer (P2P) network may

leak out exploitable information. We study the economic incentives behind the adoption

of blockchain dark venues, where users’ transactions are observable only by miners on

these venues. We show that miners may not fully adopt dark venues to preserve rents

extracted from arbitrageurs, hence creating execution risk for users. The dark venue

neither eliminates frontrunning risk nor reduces transaction costs. It strictly increases

payoﬀ of miners, weakly increases payoﬀ of users, and weakly reduces arbitrageurs’

proﬁts. We provide empirical support for our main implications, and show that they

are economically signiﬁcant. A 1% increase in the probability of being frontrun raises

users’ adoption rate of the dark venue by 0.6%. Arbitrageurs’ cost-to-revenue ratio

increases by a third with a dark venue.

Keywords: Blockchain; Miner Extractable Value; Frontrunning arbitrage; Relay Services.

2
2
0
2

b
e
F
1
1

]

N
G
.
n
i
f
-
q
[

1
v
9
7
7
5
0
.
2
0
2
2
:
v
i
X
r
a

∗We are grateful to Shihao Yu for valuable comments and feedback.
†Corresponding author: Columbia University, Department of Industrial Engineering and Operations Research, Email:

ac3827@columbia.edu

‡Columbia University, Department of Industrial Engineering and Operations Research, Email: rj2536@columbia.edu
§ETH Zürich, Department of Information Technology and Electrical Engineering, Email: wangye@ethz.ch

1

 
 
 
 
 
 
1

Introduction

Blockchain was initially conceived by Nakamoto (2008) as the backbone technology behind

digital currencies and decentralized trustless payment systems. Over time, with the devel-

opment of smart contract technologies, blockchain systems have enabled additional services,

such as tokenization of assets, crowdfunding, and decentralized ﬁnance (typically abbrevi-

ated with DeFi). See, for instance, Yermack (2017), Cong et al. (2020b), Gan et al. (2021)

and Harvey et al. (2021).

As blockchain evolves from a payment system to an infrastructure for ﬁnancial ser-

vices, transparency of information becomes a key concern. Because of the anonymity of

the blockchain network, many users cannot send their transactions directly to miners but

have to broadcast their transactions through the blockchain peer-to-peer (P2P) network in

order to get them executed. Those pending transactions are observable by any node in

the network before the execution, including malicious arbitrageurs. Arbitrageurs can ex-

ploit information leaked, and execute frontrunning or backrunning attacks on those pending

transactions (see, for instance, Park (2021), Daian et al. (2020)). These vulnerabilities are

especially pronounced for DeFi transactions. Arbitrages exploiting pending DeFi transac-

tions have generated signiﬁcant losses for users Qin et al. (2021); Wang et al. (2022), and the

losses are often referred to as miner extractable value (MEV1). Moreover, arbitrage transac-

tions make the underlying blockchain more congested, and thus increase transaction costs,

which in turn imposes negative externalities on other users of the same blockchain.

Most innovations of blockchain systems have targeted the improvement of the consensus

protocol and the system performance. However, few of them have considered the communi-

cation mechanism between nodes (especially between users and miners) in the P2P network,

which causes the “built-in” information leakage problem. In the mid of 2021, relay services

such as Flashbots and Eden Network have been introduced2 with the objective of providing

1We refer to https://ethereum.org/en/developers/docs/mev/ for an overview of MEV.
2We refer to https://docs.Flashbots.net/Flashbots-auction/overview/ for an overview of Flash-

bots relay, and to Piatt et al. (2021) for an overview of the Eden Network.

2

protection against frontrunning attacks and mitigating the negative externalities generated

from high transactions costs imposed by arbitrageurs on users. Relay services create venues

for users to send their transactions directly to miners. We call these venues dark, because

pending transactions submitted through them are not publicly observable, and thus the

transaction information cannot be exploited by arbitrageurs.

We build a game theoretical model to analyze the economic incentives behind the adop-

tion of blockchain dark venues. Our model aims at answering the following questions: Will

the dark venue be adopted by participants of the blockchain ecosystem? Will the adoption

reduce frontrunning arbitrage and transaction costs? Is the introduction of a dark venue

welfare enhancing?

We show that the dark venue is at least partially adopted by miners and utilized by

at least one arbitrageur. The introduction of a dark venue neither eliminates frontrunning

arbitrage nor reduces transaction costs. It strictly increases the payoﬀ of miners who adopt

the dark venue, but weakly decreases the payoﬀ of miners who stay on the lit venue. After

the introduction of the dark venue, the payoﬀ of frontrunnable users increases, while the

payoﬀ of arbitrageurs decreases. Aggregate welfare is maximized when all miners adopt the

dark venue. However, this outcome may not be attainable in equilibrium because miners

have a strong incentive to maintain the rents extracted from arbitrageurs. We propose a self-

ﬁnancing payment transfer which resolves the misalignment of incentives between miners and

users.

Our model features three types of agents, i.e., miners, users, and arbitrageurs; and two

transaction submission venues, i.e., a dark venue (relay) and a lit venue (the P2P network).

Miners need to decide whether or not to join the dark venue. Users submit transactions to

the blockchain either through the lit venue or through the dark venue. Transactions sent

through the lit venue are publicly observable by all agents, while transactions submitted

through the dark venue are observable only by miners who join the dark venue. One user

faces frontrunning risk when she submits transactions through the lit venue. We refer to

3

her as the frontrunnable user, and to her transaction as a frontrunnable transaction. The

remaining users do not face frontrunning risk and are referred to as non-frontrunnable users.

Arbitrageurs who identify a frontrunnable transaction in the lit venue compete to exploit

the opportunity. The adoption rate of miners determines the execution probability in the

dark venue. In turn, the venue selection decisions of users and arbitrageurs determine the

beneﬁt of joining the dark venue for miners.

Users and arbitrageurs face the trade-oﬀ between execution risk and information leakage.

On the one hand, using the dark venue alone presents execution risk to users. Transaction

submitted to the dark venue face the risk of not being observed by the miner updating the

blockchain, who may not have adopted the dark venue. On the other hand, users who only

submit through the dark venue avoid the risk of being frontrun. Arbitrageurs who only

use the dark venue would not leak out information about the identiﬁed opportunity to their

competitors. They also gain prioritized execution for their orders because miners on the dark

venue prioritize transactions sent through such venue. We show that both arbitrageurs and

the frontrunnable user will submit their transactions through the dark venue, if suﬃciently

many miners adopt it. If instead the execution risk is high, arbitrageurs will use both the

lit and the dark venue: through the dark venue they gain prioritized execution, and through

the lit venue they are guaranteed execution. Because of arbitrageurs’ competition, paid

transactions fees are above the minimum required for transactions to be executed on the

blockchain. Those fees are passed to miners, and thus miners and arbitrageurs share MEV.

We investigate the trade-oﬀ faced by miners. Each miner can observe more transactions

(i.e., in addition to those submitted to the lit venue) if he were to join the dark venue.

However, if suﬃciently many miners join this venue, execution risk becomes suﬃciently

low to incentivize users to migrate from the lit to the dark venue. This, in turn, eliminates

frontrunning arbitrage opportunities that generate MEV. As a result, it may not be incentive

compatible for miners to adopt the dark venue.

We characterize the subgame perfect equilibrium of the game. If the frontrunning problem

4

is severe, there exists a unique equilibrium where miners fully adopt the dark venue. The

reason is that the frontrunnable user would only submit her transaction through the dark

venue, but not through the blockchain lit venue. In equilibrium, miners fully adopt the dark

venue to attract this user and earn the right to observe her transaction. In such case, the

incentives of miners and users are perfectly aligned. By contrast, if the frontrunning problem

is not too severe, there exists an equilibrium where miners do not not fully adopt the dark

venue. The frontrunnable user would still broadcast through the lit venue and bear the risk

of being frontrun. Miners have insuﬃcient incentives to mitigate frontrunning risk because

they do not want to forgo MEV. As a result, miners only partially adopt the dark venue and

create execution risk, which in turn leads users to prefer submitting transactions through

the lit venue and be subject to potential frontrunning by arbitrageurs.

In equilibrium, we show that both the aggregate transaction fee per block and the min-

imum transaction fee required for inclusion in the blockchain increase if a dark venue is

present. This may, at ﬁrst, appear surprising because a dark venue should at least weakly

reduce the block space occupied by frontrunning arbitrage orders, and thus weakly decrease

transaction costs. However, this is not the case for the following reasons. First, miners adopt

the dark venue if and only if their expected transaction fee revenue increases. Second, the

creation of a dark venue raises the number of transactions, because it attracts those which

would otherwise not be submitted to the blockchain due to high frontrunning risk. Third, a

dark venue increases competition between arbitrageurs and thus raises the bid transaction

fees.

Our analysis generates welfare implications. Miners who join the dark venue are the only

participants of the blockchain ecosystem whose welfare strictly increases in the presence of

a dark venue. The positional advantage of miners, that is, the ability to determine the

execution risk faced by other agents, allows them to extract a larger rent with a dark venue.

Welfare of arbitrageurs is reduced because a larger portion of their proﬁts is extracted by

miners. The payoﬀ of users remains unchanged if miners adopt the dark venue only partially

5

to preserve MEV generated from frontrunning arbitrage. Aggregate welfare of all participants

in the ecosystem is maximized if the dark venue is fully adopted by miners. Full adoption

eliminates the frontrunning problem, and the entire block space gets allocated to users.

However, this outcome is not always attainable in equilibrium because it may not be incentive

compatible for miners to fully adopt the dark venue. We propose a self-ﬁnancing transfer

from the frontrunnable user to miners which aligns their incentives. We show that if the

frontrunnable user commits to subsidize the dark venue and those subsidies are then passed

to miners, the blockchain ecosystem would move to a new full adoption welfare maximizing

equilibrium.

We provide empirical support for our model implications. Our dataset contain dark venue

transaction-level data of Ethereum blockchain collected from Flashbots API, Ethereum block

data, and transaction-level data from Uniswap V2 and Sushiswap AMMs. Our empirical

analysis conﬁrms that the dark venue is partially adopted, and further estimates the dark

venue adoption rate around 60% as of Jul 2021. Our analysis also shows that miners who

join the dark venue have higher revenue than those who stay on the lit venue. Our estimates

indicate that joining the dark venue increases miners’ revenue by around 0.16 ETH (500

USD) per block. Consistent with our model prediction that users migrate from the lit to

the dark venue if frontrunning risk is large, we ﬁnd that the probability of being frontrun

is positively correlated with the proportion of frontrunnable user transactions submitted

through the dark venue. A 1% increase in the probability of being frontrun increases the

proportion of transactions sent through the dark venue by 0.6%. Our empirical results also

conﬁrm that welfare of arbitrageurs decreases after the introduction of a dark venue. We

show that the introduction of dark venue increases arbitrageurs’ cost revenue ratio by around

a third.

Literature Review. Our paper contributes to the scarce literature on the information

structure of blockchain. Cong and He (2019) analyze how blockchain reshapes agents’ infor-

6

mation and incentives. Our study highlights how diﬀerent transaction submission channels

aﬀect blockchain participants’ incentives.

More broadly, our work is related to existing literature on the economic analysis of

blockchain systems. Prior works have studied the economics of consensus protocols Biais

et al. (2019); Saleh (2020); John et al. (2020); Roşu and Saleh (2021); Bakos and Halaburda

(2021), the determination of transaction fees Huberman et al. (2021); Easley et al. (2019);

Chung and Shi (2021); Roughgarden (2021), and mining strategies Capponi et al. (2019);

Cong et al. (2020a); Prat and Walter (2021). We focus on the economic incentives behind the

adoption of blockchain dark venues, designed to mitigate the consequences of information

leakage.

Our paper is also related to the branch of market microstructure literature which has

analyzed dark venues (e.g., Zhu (2014), Buti et al. (2017), Degryse et al. (2009)). These

papers study how the introduction of a dark venue impacts market quality and welfare of

market participants. Zhu (2014) studies how execution risk arising in the dark venue leads

to better information discovery in the lit venue.

In his dark pool setting, execution risk

arises because informed traders may overcrowd one side of the dark market. In our setting,

instead, execution risk in the blockchain dark venue arises because miners earn rents from

MEV opportunities, which acts as a disincentive for them to adopt the dark venue.3

The paper proceeds as follows. We provide background knowledge of relay services in

Section 2. We introduce the game theoretical model in Section 3. We solve for the subgame

perfect equilibrium and examine its economic properties in Section 4. We analyze welfare

implications in Section 5. Section 6 provides empirical supports for out model implications.

Proofs of technical results are relegated to the Appendix.

3In the context of market design adoption, Budish et al. (2019) shows that rent extraction can provide

a disincentive for stock exchanges to eliminate sniping risk.

7

2 Background on Relay Services

In this section, we explain the “built-in" information leakage problem of blockchain, and

discuss the principles of relay services.

2.1 Blockchain and Information Leakage

A blockchain is a decentralized database maintained by distributed participants over a P2P

network. Every participant can issue transactions and broadcast them to every node in the

P2P network. Miners, also referred as validators, collect transactions, add them into blocks,

and append blocks to the existing blockchain. Users attach an upfront fee to their submitted

transactions. Fees allow users to gain execution priority, as miners execute transactions in

decreasing order of fees.

Each node on the blockchain may observe pending transactions in the P2P network.

This transparency is not a concern if blockchain is used as a technology for digital payments,

because there is no gain to be made from frontrunning a payment transaction. Information

leakage becomes worrisome if blockchain is used as an infrastructure for ﬁnancial interme-

diation. For example, the Ethereum blockchain enables DeFi applications, through which

smart contracts act as ﬁnancial intermediaries and provide a broad range of ﬁnancial ser-

vices, including borrowing and lending, token exchanges, leverage trading, and ﬂash loans.

Frontrunning attacks due information leakage can be very costly for users (see Eskandari

et al. (2019)).

Frontrunning attacks include displacement, insertion, and suppression Torres et al. (2021).

In a displacement attack, an attacker observes a proﬁtable transaction from a victim user.

She then broadcasts her own proﬁtable transaction with the same arbitrage strategy but with

a higher transaction fee. The frontrunning transaction will then be executed in advance of

the victim transaction. The attacker will take the proﬁt, while the victim transaction would

fail. In an insertion attack, an attacker observes a frontrunnable transaction from a victim

8

user. She then broadcasts two transactions: one (frontrunning transaction) with a higher

transaction fee than the victim transaction and the other (backrunning transaction) with

a lower transaction fee. After the frontrunning transaction is completed, the market price

changes. Consequently, the price of the victim transaction will be higher than if no attack

had taken place. This results in a worse exchange rate and ﬁnancial losses to the victim,

and the attacker receives the proﬁt with the backrunning transaction. In a suppression at-

tack, an attacker observes an attackable transaction from a victim user. She then broadcasts

transactions with a higher transaction fee in order to prevent the victim transaction from

being included in the block. Note that the suppression frontrunning attack is very expensive

because the attackers try to consume as much gas as possible to reach the capacity limit of

the block. In current DeFi market, insertion frontrunning attacks are most common. Torres

et al. (2021).

2.2 Relay Services

Relay services are an implementation of the dark venue, which provide a private communi-

cation channel between users and miners. A centralized relay service receives transactions

from users and forwards them directly to miners, without broadcasting them on the P2P

network. Therefore, users’ transactions cannot be observed by malicious arbitrageurs. To

ensure that miners in a private channel do not use observed information, the relay platform

screens miners before they join the relay service and monitor their activities. 4 The ﬁrst

relay service, Flashbots, was launched in January 2021.

Miners who join the private channel also have to prioritize execution of the highest bidding

transactions by including them at the top of a block. The execution order of transactions

submitted through the private channel is typically determined by a one-round, seal-bid, ﬁrst

price auction. 5 Hence, the transaction submitter neither knows the transactions submitted

4The Flashbots Fair Market Principles (FFMP) can be found at https://hackmd.io/@Flashbots/

fair-market-principles.

5Flashbots utilizes Coinbase as an additional payment channel between users and miners in addition to

9

by other users nor the attached transaction fees. By contrast, in the P2P network, the

transaction fee bidding takes the form of an ascending price auction, and it consists of

multiple rounds of bid submission. Moreover, pending transactions and their fees are publicly

observable.

3 Model Setup

The timeline of our model consists of three periods indexed by t, t = 1, 2, 3. There are three

types of agents: blockchain users, arbitrageurs, and miners. All agents are risk-neutral.

Miners. There is a continuum of homogeneous, rational miners. All miners have the same

probability of earning the right to append a new block to the blockchain. At the end of period

3, the miner who appends the next block is drawn randomly from a uniform distribution.

The winning miner earns the fees attached to the transactions included in the block plus

a ﬁxed reward.6 The miner can at most include B transactions in a block due to limited

capacity.

There exists two transaction submission venues: the lit venue (blockchain P2P network),

and the dark venue (relay service). In period 1, miners decide whether to join the dark venue.

We assume that joining this venue is costless for miners.7 We denote by α the portion

of miners who join the dark venue in period 1. All miners can observe the transactions

submitted through the lit venue, but only miners who join the dark venue can observe the

transactions submitted through the dark venue. We assume that miners who join the dark

venue do not disclose transaction information.

At the end of period 3, the miner who successfully mines the block will select B trans-

the transaction fee attached to the transaction. See https://docs.Flashbots.net/Flashbots-auction/
searchers/advanced/coinbase-payment/

6The reward amount does not aﬀect our analysis. Regardless of whether or not a miner adopts the dark

venue, his expected block reward remains constant unlike the transaction fees earned.

7As discussed in https://docs.Flashbots.net/Flashbots-auction/miners/faq/, Flashbots relay is

an open-source software and does not charge any fee for usage.

10

actions whose attached fees are the highest. The winning miner can only select from the

transactions he observes. We assume that any tie will be broken uniformly at random. The

miner decides the execution order as follows. If the miner has joined the dark venue, then

he prioritizes the transactions submitted through the dark venue and execute them ﬁrst.8

Those transactions will be executed in decreasing order of bid fees. Subsequently, the win-

ning miner will include the transactions submitted through the lit venue, again in decreasing

order of fees. A miner who has not joined the dark venue would only include the transactions

from the lit venue in decreasing order of fees.

Since a miner’s adoption decision does not aﬀect the probability of mining the next block,

a miner decides whether to join the dark venue to maximize the expected transaction fees

conditional on him successfully mining the next block. The expected transaction fees earned

from adopting the dark venue and from using only the lit venue are both contingent on the

choice of users and arbitrageurs. We denote the expected fee revenue of the winning miner

from adopting the dark venue by rdark(·), and from using the lit venue only by rlit(·).

Users. There are two types of users, and the type depends on the exogenously speciﬁed

nature of their transactions.

The ﬁrst type is a user whose pending transaction is subject to a front-running attack

if submitted through the lit venue and identiﬁed by arbitrageurs. We refer to this user as

frontrunnable and to her transaction as a frontrunnable transaction. If the frontrunnable

transaction is successfully written on the blockchain, it generates a beneﬁt v0 to the initiator,

i.e., to the frontrunnable user. We assume that v0 is common knowledge. However, if the

pending transaction is identiﬁed by an arbitrageur, then the arbitrageur can frontrun and

earn a proﬁt c ≥ 0. This, in turn, results in a loss of c for the frontrunnable user.

The second type of users are those whose transactions are not frontrunnable, even if they

are broadcast through the lit venue. We refer to this type of users as the non-frontrunnable

8Two major relay services, Eden and Flashbots both impose this requirement for miners. See https:

//docs.Flashbots.net/Flashbots-auction/searchers/faq/.

11

users and refer to their transactions as non-frontrunnable transactions. Without loss of

generality, we assume there exist B + 1 non-frontrunnable users, indexed by i ∈ {1, 2, ..., B +

1}, whose transactions have valuations vi, i ∈ {1, 2, ..., B +1} which are common knowledge.9

We also impose the following technical assumption to rule out corner cases in our analysis:

Assumption 1. The diﬀerence vB−2 − vB−1 is suﬃciently small.

In period 2, users simultaneously decide the venue to which they send their transactions.

An user can broadcast her transaction through the lit venue, or through the dark venue, or

choose to not submit her transaction. If a frontrunnable transaction is broadcast through

the lit venue, it will face the risk of being identiﬁed and frontrun by arbitrageurs. If instead a

transaction is only broadcast through the dark venue, then it will not be observed by miners

who do not adopt the dark venue. Its probability of being included in the next block is at

most α, which means that the execution risk of the dark venue is determined by miners’ dark

venue adoption rate. We index the frontrunnable user as user 0. We denote the channel

chosen by user i, i ∈ I = {0, 1, 2, ..., B + 1}, by Ci ∈ {Dark, Lit, None}. User i also attaches

a transaction fee fi to her transaction.

User i chooses her submission venue Ci and attached fee fi to maximize her expected

payoﬀ:

Ui = E [1Executed,i(vi − c1frontrun,i − fi)] ,

where 1Executed,i is the indicator function for the event “transaction by user i is included

in the block by miner", 1frontrun,i is the indicator function for the event “transaction by user

i is frontrun by arbitrageurs". We assume that users break any tie in favour of the lit venue.

Our assumption is justiﬁed by the fact that using the dark venue usually requires more

sophistication, and the interface for the lit venue is, in general, much easier for users to use.

9Having less than B + 1 transactions would make the analysis of transaction costs trivial, because there

would be no competition for block space. We assume that v1 > v2 > ... > vB+1, and v0 > vB−2, c > vB−2.

12

Arbitrageurs.

There are two competing arbitrageurs, indexed by j ∈ J = {1, 2}. The

arbitrageurs have to ﬁrst screen for the pending frontrunnable transaction in the lit venue

and then exploit it. An arbitrageur who successfully exploits the opportunity earns a proﬁt

c ≥ 0. For any pending frontrunnable transaction, each arbitrageur has a probability p

of independently identifying the frontrunning opportunity and exploiting it.

In practice,

to identify an arbitrage opportunity and exploit it, an arbitrageur has to screen at least

hundreds of pending transactions in a few seconds, calculate the proﬁtability of frontrunning

them, construct arbitrage orders, and bid appropriate transaction fees. As a result, not all

arbitrage opportunities can be detected and exploited by arbitrageurs, and the probability

p captures the diﬃculty of the above process.

In period 3, two arbitrageurs ﬁrst search for potential arbitrage opportunities indepen-

dently. For any exploitable identiﬁed opportunity, the arbitrageur will create an order and

decide to which venue to send it: the lit venue, the dark venue, or both. We assume that

if the arbitrageur decides to send an arbitrage order to both venues, then he will give both

transactions the same nonce, that is, a unique identiﬁer. Since each nonce can be used only

once, at most one of these two transactions will be executed. If the winning miner observes

both transactions, he will only include the one with highest transaction fee. If the order

of an arbitrageur is broadcast through the lit venue, the other arbitrageur will observe it

and identify the opportunity. The leaked information then leads to more competition for

arbitrage execution.10 If instead the arbitrage order is only sent to the dark venue, then it

may be executed only if the next block is mined by a miner who adopts the venue. Hence,

sending arbitrage orders only through the dark venue may limit the probability of the or-

der getting executed, and thus presents execution risk to arbitrageurs. We then denote the

channel chosen by arbitrageur j, by Vj ∈ {Lit, Dark, Both}. We denote the transaction fee

bid by arbitrageur j in the private channel by fDj

, and in the lit venue by fLj

. Arbitrageurs

10In practice, arbitrageurs are bots whose addresses do not change often, so their competitors can learn

arbitrage opportunities just by tracking the pending transaction submitted from their addresses.

13

choose their strategy to maximize their expected payoﬀ:

Aj = E [1wins,j1frontrun,0(c − fexecuted,j)] ,

where 1wins,j is the indicator function for the event “the order by arbitrageur j is executed

before the order by the other arbitrageur", and fexecuted,j is the transaction fee paid by

arbitrageur j.

Arbitrageurs employ a mixed strategy when choosing transaction fees. This guarantees

the existence of a Nash equilibrium for the subgame in period 3. The tie-break rules for

arbitrageurs is that “both venues" is their ﬁrst choice, the “lit venue" is their second choice,

and the “dark venue" is their third choice.

Transaction Fee Bidding. The arbitrageur who bids the highest fee can exploit the

opportunity. The transaction fee bidding mechanisms in the two venues are diﬀerent. Trans-

action fee bidding in the lit venue is a variant of an English Auction, i.e., an open-outcry

ascending-price auction. The auction only has r rounds where r is a random variable which

obeys a geometric distribution with a success rate λ. There exists a random deadline for

the transaction fee bidding auction since the time required for miners to mine the block is

random. In each round, only one arbitrageur moves, and the bid increment has to be larger

than (cid:15). If only one arbitrageur identiﬁes an opportunity and decides to broadcast his order

through the lit venue, then he moves ﬁrst. If both arbitrageurs identify the same opportunity

and decide to send their orders through the lit venue, then the ﬁrst mover can be either of

them with the same probability. To minimize downside risk from the arbitrage execution,

arbitrageurs deploy a smart contract. The smart contract would terminate the transaction

if the arbitrage opportunity no longer exists. In this case, the transaction would be deemed

as failed, and the corresponding transaction fee is negligible and assumed to be equal to zero

in our model.

The transaction fee bidding in the dark venue is a one-round, seal-bid, ﬁrst-price auction,

14

where all bidders only have to submit their bids once to the relay, without leaking any

information to other bidders. If two arbitrageurs submit the same order to exploit the same

opportunity, then only the arbitrageur who pays the highest transaction fee will be considered

by miners.

Equilibrium. We solve for the subgame perfect equilibrium (SPE) of the game described

above. The equilibrium actions are the dark venue adoption rate of miners α∗, the venue

selection and transaction fee bidding strategies of users, and the venue selection and trans-

action fee bidding strategies of arbitrageurs.The strategy of user i is a mapping from the the

dark venue adoption rate of miners, α, to her transaction submission venue Ci and transac-

tion fee bid fi. The strategy of arbitrageur j is a mapping from the dark venue adoption

rate of miners, α, and users’ actions, (Ci, fi)i∈I to his selected venue Vj and transaction fees

submitted in each venue fDj , fLj

.

4 Model Analysis

In this section, we solve for the SPE of the game. We begin by analyzing the venue choice

of arbitrageurs and users. We subsequently study the equilibrium adoption rate of the dark

venue, and investigate the corresponding welfare implications.

4.1 Venue Choice of Arbitrageurs

We analyze arbitrageurs’ venue selection strategies, for any dark venue adoption rate α and

assuming that the frontrunnable user chooses the lit venue. Note that it suﬃces to consider

only this choice for the frontrunnable, because if she were to submit her transaction through

the dark venue such transaction would not be observable by arbitrageurs. Hence, they would

not be able to submit any arbitrage order at t = 3.

The main trade-oﬀ faced by arbitrageurs is as follows. On one hand, if an arbitrageur

chooses only the dark venue, his detected opportunity would not be visible to his competing

15

arbitrageur. This, in turn, reduces competition and thus the arbitrageur’s cost from transac-

tion fee bidding. Moreover, the arbitrageur gains prioritized execution, because transactions

submitted through the dark venue are placed at the top of the block by miners who join the

dark venue. On the other hand, using the dark venue only presents execution risk because a

fraction of miners may never observe transactions submitted to the dark venue. The following

proposition characterizes the choice of the arbitrageurs’ venue choice in equilibrium.

Proposition 1 (Venue Selection of Arbitrageurs). There exist two critical thresholds 0 <

α1 < α2 ≤ 1, such that:

1. If α ≤ α1, then the two arbitrageurs send transactions to both the lit and the dark

venues in equilibrium.

2. If α1 < α ≤ α2, then there are two equilibria. In each equilibrium, one arbitrageur uses

both venues while the other arbitrageur only uses the dark venue.

3. If α > α2, then both arbitrageurs only use the dark venue in equilibrium.

The main intuition behind the above result is as follows. If only a small fraction of miners

adopt the dark venue, the execution risk is high. As a result, arbitrageurs will submit their

transactions to both venues. The reason why arbitrageurs would not use only the lit venue

is to gain prioritized execution through the dark venue. If instead a large fraction of miners

joins the dark venue, execution risk becomes small. The beneﬁt of using the dark venue, that

is, of hiding arbitrage opportunities and avoiding intense transaction fee bidding competition,

would dominates its cost, that is, execution risk. Hence, arbitrageurs only use the dark venue.

The next proposition characterizes the transaction fee bidding strategies of arbitrageurs.

Proposition 2 (Transaction Fees Bid by Arbitrageurs). Let α1, α2 be the critical thresholds

identiﬁed in Proposition 1. The following statements hold:

1. If α ≤ α1, then in equilibrium both arbitrageurs bid c in the dark venue. In the lit

venue, one of the arbitrageurs places an opening bid vB−2, and afterwards, in each of

16

his bidding rounds, he increases by the minimal increment (cid:15) from the previous highest

bid.

2. If α1 < α ≤ α2, then in equilibrium the arbitrageur who uses both venue bids vB−2 in

the lit venue and c in the dark venue. The other arbitrageur who only participates in

the dark venue bids c if he observes a bid in the lit venue from the other arbitrageur,

and bids vB−2 otherwise.

3. If α > α2, then in equilibrium both arbitrageurs bid a transaction fee g according to the

probability distribution

P (g) =






1−p
p

·

(1−

g−vB−2
c−vB−2

1
)2·(c−vB−2)

vB−2 ≤ g ≤ (c − vB−2) · p + vB−2

0

g > (c − vB−2) · p + vB−2

If execution risk is high, i.e., α < α1, arbitrageurs submit their transactions through

both venues. Since both arbitrageurs broadcast through the lit venue, if one arbitrageur

detects an opportunity the other arbitrageur will also discover it. Hence, to exploit an

opportunity, arbitrageurs have to outbid their competitors. Recall that transactions sent

through the dark venue will be prioritized by miners who join this venue. To gain this beneﬁt,

both arbitrageurs submit to the dark venue and bid truthfully, that is, bid transaction fees

equal to their proﬁts.

In this case, the dark venue induces an arms race for prioritized

execution between arbitrageurs. If execution risk is low, i.e., α > α2, both arbitrageurs use

only the dark venue to hide their opportunities. Hence, arbitrageurs do not know whether

their competitors have also detected the same opportunity, so the equilibrium must be in

mixed strategies. As arbitrageurs no longer bid their true valuation in the dark venue, the

competition in the dark venue is less intense relative to the case when execution risk is high.

Recall that if α1 < α ≤ α2, one arbitrageur only uses the dark venue, while the other

arbitrageur uses both the lit and the dark venues. On the one hand, since the latter arbi-

trageur uses the lit venue, any arbitrage opportunity detected by him will be discovered by

17

the other arbitrageur who uses only the dark venue. This again leads to an arms race for pri-

oritized execution where both arbitrageurs bid truthfully. On the other hand, any arbitrage

opportunity detected by the arbitrageur who uses only the dark venue will not be visible to

the other arbitrageur. Hence, there will not be any competition, and the arbitrageur who

uses only the dark venue can bid the minimum transaction fee.

Observe that the transaction fee paid by arbitrageurs is pocketed by the winning miners.

Because of competition, the transaction fees bid by arbitrageurs are always higher than vB−2,

that is, the minimum fee which guarantees a transaction to be executed by miners. This

suggests that miners extract a portion of MEV.

4.2 Venue Choice of Users

We analyze the venue selection strategy of the frontrunnable user, for an exogenously spec-

iﬁed relay adoption rate α.

The main trade-oﬀ faced by the frontrunnable user is straightforward. Using the dark

venue exposes her to execution risk but eliminates the risk of being frontrun. Unlike ar-

bitrageurs, the frontrunnable user does not use the dark venue to outbid competitors but

merely to avoid frontrunning. When the dark venue adoption rate of miners is suﬃciently

large, the execution risk is small, and then the user will also adopt it to avoid frontrunning.

The following proposition characterizes her strategy in equilibrium:

Proposition 3 (Venue Selection of Users). There exist three critical thresholds 0 < λ1 <

λ2 < λ3 < 1 such that the frontrunnable user sends her transaction through the dark venue:

1. If and only if α > λ1 whenever α ∈ [0, α1].

2. if and only if α > λ2 whenever α ∈ (α1, α2].

3. if and only if α > λ3 whenever α ∈ (α2, 1].

The thresholds for adoption of the dark venue by the arbitrageurs and by the users depend

18

on the probability p that an arbitrageur detects the opportunity. The following corollary

characterizes how these thresholds vary with p, keeping every other parameter ﬁxed.

Corollary 1 (Sensitivity Analysis). The signs of the sensitivities of α’s and λ’s with respect

to p are as follows:

1. ∂λ1

∂p < 0, ∂λ2

∂p < 0, ∂λ3

∂p < 0

2. ∂α1

∂p > 0, ∂α2

∂p > 0

As p increases, the risk of being frontrun increases, and thus the beneﬁt of using the dark

venue for the frontrunnable user increases. Hence, threshold for the adoption of the dark

venue decreases. Vice-versa, as p increases it becomes easier to detect an arbitrage opportu-

nity, reducing the value of information about the arbitrage opportunity. Hence, arbitrageurs

are less incentivized to use the dark venue for protecting their private information.

4.3 Miners’ adoption and Equilibrium

We derive the equilibrium dark venue adoption rate of miners, α∗, and characterize the SPE.

For any α > 0, the miners who join the dark venue receive a higher payoﬀ than those

who only stay in the lit venue:

rdark(α) ≥ rlit(α).

This is because transactions submitted through the dark venue can only be observed by

miners who adopt the dark. As a result, if the actions of users and arbitrageurs are ﬁxed,

each individual miner has an incentive to join the dark venue.

The situation changes once we account for the strategic responses of users and arbi-

trageurs. If suﬃciently many miners join the dark venue, that is, if α is large enough, then

the payoﬀ of each miner may be lower than their payoﬀ when α = 0. This is because the

frontrunnable user may then route her transaction from the lit to the dark venue if the

execution risk in the dark venue is small enough. The migration of this transaction would

eliminate frontrunning opportunities and thus reduce MEV.

19

We ﬁrst characterize the equilibrium strategy of the frontrunnable user in the benchmark

case where there is no dark venue. This is obtained from our game theoretical framework

by setting α = 0, and considering the subgame at periods t = 2, 3.

Proposition 4 (Only Lit Venue Benchmark). When α = 0, there exists a threshold c1 ≥ 0

such that the frontrunnable user submits the transaction to the blockchain if and only if

c ≤ c1.

If the frontrunning problem is severe, i.e., c > c1, then the frontrunnable user is not willing

to submit her transaction to the blockchain because the cost of being frontrun exceeds the

beneﬁt of executing her transaction. Conversely, if the frontrunning problem is not too

severe, i.e., c ≤ c1, then the frontrunnable user submits to the blockchain even if she faces

the risk of being frontrun.

We next characterize the SPE of our model. We refer to the equilibrium where the

relay adoption rate α∗ = 1 as the full adoption equilibrium, the equilibrium where the relay

adoption rate α∗ ∈ (0, 1) as the partial adoption equilibrium, and the equilibrium where the

relay adoption rate α∗ = 0 as no adoption equilibrium.

Proposition 5 (Characterization of the Equilibrium ). Let c1 be the critical threshold iden-

tiﬁed in Proposition 4. The following statements hold for the SPE of the game:

1. If c > c1, there exists a unique full adoption equilibrium where the relay adoption rate

α∗ = 1, the frontrunnable user selects the dark venue, and the arbitrageurs do not

submit arbitrage orders.

2. If c ≤ c1, there exists a partial adoption equilibrium where the relay adoption rate

α∗ < 1, the frontrunnable user submits her transaction through the lit venue, and the

arbitrageurs send their orders to the dark venue only or to both venues.

The dark venue will be, at least partially, adopted by miners, and the equilibrium outcome

is contingent on the severity of the front-running problem. Suppose the frontrunning problem

20

is severe. In the absence of a dark venue, it is too costly for the frontrunnable user to submit

transactions to the blockchain. To incentivize the frontrunnable user to submit and earn the

transaction fee, miners adopt the dark venue. In equilibrium, all miners decide to join the

dark venue so that they are able to observe the transaction submitted by the frontrunnable

user.

Suppose the frontrunning problem is not too severe. Even without a dark venue, the

frontrunnable user would still submit her transaction to the blockchain even if she bears the

risk of being frontrun. Frontrunning arbitrage generates MEV for miners. To maintain their

MEV, only a small fraction of miners choose to adopt the dark venue, which creates high

execution risk. As a result, the frontrunnable user prefers to submit through the lit venue

and face frontrunning risk. In such case, the introduction of a dark venue does not prevent

frontrunning arbitrage.

5 Welfare Implications

We investigate how the introduction of a dark venue impacts transaction costs on blockchain.

We also analyze how welfare of market participants is impacted by a dark venue.

We impose the following equilibrium selection criterion. Among all equilibria character-

ized in part 3 of Proposition 5, we select the equilibrium which maximizes the aggregate

payoﬀ of all miners. We pick this speciﬁc equilibrium, because it is the most likely to be

coordinated upon by miners. Big mining pools can coordinate and move a suﬃciently large

mass of mining power from one venue to the other. Hence, they can always achieve the

equilibrium that maximizes their aggregate payoﬀ. We also remark that our result is ro-

bust to our equilibrium selection, and selecting any partial adoption equilibrium in part 3 of

Proposition 5 will yield the same results on welfare.

21

5.1 Transaction Costs on Blockchain

We begin by showing that the introduction of a dark venue does not serve its intended

purpose of reducing blockchain congestion and transaction costs.

Proposition 6 (Transaction Costs with Dark and Lit Venues). The introduction of a dark

venue increases both the total fee of all transactions in a block and the minimum fee that

guarantees the execution of a transaction.

Because the introduction of a dark venue weakly reduces the block space used by arbi-

trageurs, one would expect a decline in transaction costs. Our analysis shows that this is

not the case for the reasons outlined next. Miners would adopt the dark venue only if they

earn higher transaction fees, and thus the equilibrium transaction costs increase. Moreover,

as shown in part 2 of Proposition 5, the introduction of the dark venue may generate more

frontrunnable transactions on the blockchain. This drives up the demand for block space

and consequently results in higher transaction costs. Further, as shown in Proposition 2,

the introduction of the dark venue may strengthen the arms race for ﬁrst execution between

arbitrageurs. The latter would bid high transaction fees in the dark venue, which leads to a

higher MEV and transaction costs.

This result implies that the negative externality induced by MEV cannot be mitigated

by the introduction of a dark venue, because it is not incentive-compatible for miners to give

up their rents extracted from users and arbitrageurs.

5.2 Welfare Analysis

We study how the introduction of a dark venue aﬀects the welfare of the agents in the

blockchain ecosystem as well as the aggregate welfare.

Proposition 7 (Welfare of miners, user, and arbitrageur). The introduction of the dark

venue leads to

1. a strict increase in aggregate welfare of miners,

22

2. a strict increase in welfare for miners who adopt the dark venue, and a decrease in

welfare for miners who do not adopt the dark venue,

3. an increase in welfare for the frontrunnable user,

4. a reduction in welfare for arbitrageurs.

Miners’ increase in welfare can be decomposed into two parts: an increase in MEV, and

an increase in transaction fees due to a higher demand for block space. First, recall from

Proposition 2 that the introduction of the dark venue exacerbates competition between arbi-

trageurs and increases MEV. This, in turn, leads to a reduction in welfare for arbitrageurs,

because a higher portion of their arbitrage proﬁts is transferred to miners. Second, recall

that the presence of a dark venue may incentivize the frontrunnable user to submit her

transaction to the blockchain and thus increase the demand for block space. This, in turn,

increases miners’ revenue from transaction costs. Even though the aggregate welfare of min-

ers increase after the introduction of the dark venue, the welfare of miners who do not join

the dark venue weakly decreases. This is because some transactions migrate from the lit to

the dark venue, and miners who stay in the lit venue can no longer observe them.

The welfare of the frontrunnable user increases because she has now access to a privacy-

preserving transaction submission venue. It is worth observing that her welfare does not

necessarily increases strictly. Unless the frontrunning problem is very severe, miners adopt

the dark venue partially and create execution risk. As a result, the frontrunnable user may

ﬁnd it preferable to stay in the lit venue and bear frontrunning risk.

We next analyze aggregate welfare, deﬁned as the sum of expected payoﬀs of miners,

users, and arbitrageurs.

Proposition 8 (Aggregate Welfare). The followings statements hold:

1. The aggregate welfare is maximized when the dark venue is fully adopted by miners.

2. The introduction of the dark venue weakly raises aggregate welfare.

23

3. If c > c1, then the unique full adoption equilibrium attains the maximum aggregate

welfare; if c ≤ c1, then any partial adoption equilibrium yields an aggregate welfare

strictly below the maximum.

The above result can be intuitively understood as follows. The proﬁt of arbitrageurs and

fee revenue of miners are merely transfers of wealth from users. Despite MEV is extracted

from arbitrageurs by miners, it is just a fraction of the proﬁts arbitrageurs extracted from

users. As a result, aggregate welfare is maximized if the sum of the valuation of users’

transactions added to the block is maximized. In particular, maximum welfare can only be

achieved if frontrunning arbitrage does not take up any block space. If the dark venue is fully

adopted by miners, execution risk is small, and the frontrunnable user submits through the

dark venue. Because no arbitrageur demands for block space, the block only includes the B

users’ transactions with the highest valuations, and the aggregate welfare is then maximized.

We have shown that the introduction of the dark venue weakly improves aggregate wel-

fare. Moreover, the private and social optimum coincide if the frontrunning problem is

severe. However, if the frontrunning problem is not too severe, the ecosystem would coordi-

nate on a partial adoption equilibrium where frontrunning arbitrage is still present, and the

block space allocation would not be eﬃcient. The aggregate welfare maximizing outcome

is then unattainable because miners have a positional advantage and can determine other

participants’ execution risk. For miners, the dark venue merely serves to extract larger rents.

We propose a self-ﬁnancing transfer from the frontrunnable user to miners so that the

misalignment of incentives is resolved, and the resulting full adoption equilibrium achieves

the welfare maximizing outcome.

Proposition 9 (Attaining Full Adoption). There exists θ ≥ 0 such that if the frontrunnable

user commits at t = 1 to make a payment θ to the winning miner on the dark venue, then (i)

a unique full adoption equilibrium is attained; (ii) the expected payoﬀ of all miners strictly

increase; (iii) the expected payoﬀ of the frontrunnable user does not decrease.

In the partial adoption equilibrium, the MEV earned by miners is only a fraction of

24

arbitrageurs’ proﬁt extracted from the frontrunnable user. If the frontrunnable user commits

to make a payment to the winning miner on the dark venue, and this payment is above

miners’ expected MEV in the partial adoption equilibrium, then it is incentive compatible

for all miners to adopt the dark venue, and the aggregate welfare is maximized. The payoﬀ of

the frontrunnable user in the full adoption equilibrium net of the payment is strictly higher

than her payoﬀ in the partial adoption equilibrium (where no transfer between the user and

miners occurs). This proposed transfer could be implemented in a straightforward manner.

The relay service can set up a reward pool which allows users to voluntarily deposit ERC-20

tokens into it. Any miner who joins the relay service and successfully mines a new block

that includes transactions sent through the relay service can claim the tokens deposited in

the reward pool.

6 Empirical Analysis

In this section, we provide empirical support to the implications of our model. Section 6.1

lists the model implications we validate. Section 6.2 describes our dataset. Section 6.3

deﬁnes the key variables and stylized facts. Section 6.4 describes our empirical results.

6.1 Testable Implications

Our model generate the following implications:

1. The blockchain dark venue will be partially adopted by miners (see Proposition 5).

2. Miners who adopt dark venue have a higher expected payoﬀ than miners who stay in

the lit venue. (See part 1 of Proposition 7)

3. Users submit transaction through the dark venue when the frontrunning risk is high

(see Proposition 5).

25

4. Arbitrageurs’ transaction costs increase after the introduction of the dark venu. This

is implied from part 3 of Proposition 7.

6.2 Data

We use transaction-level data from Uniswap and Sushiswap to identify frontrunning arbi-

trages. We run our own Ethereum node to get access to the blockchain history. A modiﬁed

geth client is used to export all transaction receipts where a swap event was triggered by a

smart contract of Uniswap or Sushiswap. Our dataset contains all swap transactions from

block number 10000835 created on May 4, 2020 to block number 12344944 created on April

30, 2021. For the AMMs transactions in the data, we follow the method described in Wang

et al. (2022) to identify frontrunning arbitrages and calculate their revenues.

We use the API services provided by Flashbots to collect transactions submitted through

the private channel to the miners. We collect data starting from February 11, 2021, when

the ﬁrst Flashbots block was mined, till July 31, 2021. This choice eliminates the inﬂuence

of the new fee mechanism introduced by EIP 1559 after August 2021.

We acquire the Ethereum block data from Blockchair available at https://gz.blockchair.

com/ethereum/blocks/. The data cover the period from May 1, 2020 to July 31, 2021. The

data include the gas fee revenues earned by miners.

6.3 Deﬁnition of Variables and Stylized Facts

We describe the main variables used in our statistical analysis, and provide empirical regu-

larities observed in our data.

Dark Venue Adoption Rate of Miners. We estimate the dark venue adoption rate

in day t using the number of blocks mined in day t that contains Flashbots transactions

divided by the total number of blocks mined in day t.

Miners’ Revenue per Block.

If a miner mines a block that contains transactions

submitted through Flashbots, then his revenue accounts for Flashbots transactions in this

26

block plus gas fee proceeds from transaction submitted through the mempool. If a miner

mines a block that only contains transaction submitted through mempool, then his revenue

consists of gas fees paid by those transactions. We do not account for the ﬁxed block reward

in our measure of miners’ revenue.

Arbitrageurs’ Cost-to-Revenue Ratio . For each frontrunning arbitrage order iden-

tiﬁed, arbitrageur’s cost-to-revenue ratio is measured by the gas fee paid by this arbitrageur

divided by the revenue of the frontrunning arbitrage. Both the gas fee and arbitrage revenue

are in the unit of ether.

Users’ Probability of Being Frontrun. For each transaction submitted through

the lit venue, we examine whether it is frontrunnable and whether it has been frontrun

using a methodology described in Appendix B.2. The probability of being frontrun in day

t is the number of transactions which were frontrun in day t divided by the number of all

frontrunnable transactions submitted in that day.

Proportion of Users’ Transaction Sent Through the Dark Venue. For each

transaction submitted through the dark venue, we examine whether it would be frontrunnable

if were submitted through the lit venue. The proportion of transactions sent through the

dark venue in day tis the number of frontrunnable transactions submitted through the dark

venue during day t divided by the number of all frontrunnable transactions submitted during

that day.

Descriptive Statistics and Stylized Facts. Table 1 presents summary statistics of

the data. Figure 1 plots the estimated adoption rate of dark venue. For miners who join

the dark venue, we plot the proportion of extracted revenue in Figure 2. We can clearly

observe that dark venue transactions contribute a nontrivial (around 15%) portion to the

revenues of miners who joined dark venue. The distribution of cost-to-revenue ratio of

arbitrageurs is plotted in Figure 3. Comparing panel (a)-(c), we observe that the cost-to-

revenue ratio for arbitrageurs who submit through the dark venue is skewed right and higher

than that of arbitrageur who use lit venue. The average cost-to-revenue ratio increases after

27

s
r
e
n
M

i

f
o

e
t
a
R
n
o
i
t
p
o
d
A
e
u
n
e
V
k
r
a
D

0.8

0.6

0.4

0.2

0

2021-02 2021-04 2021-05 2021-07

Date (YYYY-MM)

Figure 1: Adoption rate of Flashbots.

k
r
a
D
m
o
r
f

e
u
n
e
v
e
R

f
o

n
o
i
t
r
o
p
o
r
P

0.2

0.15

0.1

0.05

0

2021-02 2021-04 2021-05 2021-07

Date ((YYYY-MM))

Figure 2: Proportion of Flashbots miners’
revenue from dark venue.

Figure 3: Panel (a) - top left: Distribution of the cost-to-revenue ratio of attackers in the lit
venue before the introduction of the dark venue. Panel (b) - top right: Distribution of the
cost-to-revenue ratio of attackers in the dark venue. Panel (c) - bottom: Distribution of the
cost-to-revenue ratio of attackers in the lit venue after the introduction of the dark venue.

28

N

Mean SD

10th

50th

90th

Panel A: Miner Data

Daily Dark Venue Adoption Rate
Revenues of Miners at Dark Venue (ETH)
Proportion of Revenue From Dark Venue (ETH)
Revenues of Miners at Lit Venue (ETH)

171
377,366
377,366
2,582,015
Panel B: Arbitrageur Data

Arbitrage Revenue in Dark Venue (ETH)
Arbitrage Cost in Dark Venue (ETH)
Cost-to-revenue Ratio of Arbitrageurs in Dark Venue

29,465
29,465
29,465

Arbitrage Revenue in Lit Venue (ETH)
Arbitrage Cost in Lit Venue (ETH)
Cost-to-revenue Ratio of Arbitrageurs in Lit Venue

394,239
394,239
394,239

Panel C: User Data

0.343
0.972
0.139
1.161

0.248
0.182
0.755

0.204
0.04
0.309

0.239
17.82
0.148
9.585

0.495
0.363
0.151

0.571
0.093
0.239

0.01
0.235
0.024
0.231

0.042
0.032
0.51

0.033
0.004
0.021

0.346
0.606
0.086
0.832

0.125
0.092
0.801

0.091
0.023
0.261

0.613
2.2
0.326
2.36

0.497
0.371
0.901

0.408
0.069
0.662

Daily Probability of Being Attacked
Daily Ratio of Using Dark Venue

80
80

0.165
0.033

0.034
0.038

0.120
0

0.165
0.01

0.209
0.09

Table 1: Summary statistics of the data set

the introduction of the dark venue. Figure 4 plots the daily average cost-to-revenue ratio

of arbitrageurs in the lit and the dark venue. After the introduction of the dark venue, the

cost-to-revenue ratio in the dark venue steadily increases while the cost-to-revenue ratio in

the lit venue decreases. Our model oﬀers a plausible explanation to this observed pattern:

as the miner adoption rate of the dark venue increases, more arbitrageurs migrate from

the lit venue to the dark venue, which increases competition and raises transaction costs.

Recall that transactions sent through the dark venue face execution risk. When the block

is not mined by miners who join the dark venue, arbitrage transactions sent through the lit

venue are executed, and the transaction cost is lower because of the smaller competition.

Figure 5 plots users’ probability of being frontrun (red) and proportion of users’ transaction

submitted to the dark venue (black). The graph suggests that users may migrate to the dark

venue when the frontrunning risk they face increases.

29

o
i
t
a
R
e
u
n
e
v
e
R
t
s
o
C
e
g
a
r
e
v
A
y
l
i
a
D

1

0.8

0.6

0.4

0.2

0.3

0.2

0.1

n
u
r
t
n
o
r
F

g
n

i
e
B

f
o

y
t
i
l
i

b
a
b
o
r
P

0.3

e
u
n
e
V
k
r
a
D
g
n

0.2

i
s
U

f
o

0.1

n
o
i
t
o
p
o
r
P

0
2020-05 2020-08 2020-11 2021-03

Date (YYYY-MM)

Figure 4: Daily average cost-to-revenue
ratio of arbitrageurs. Blue: arbitrageurs
in lit venue before the introduction of the
dark venue, Black: arbitrageurs in dark
venue, Orange: arbitrageurs in lit venue
after the introduction of the dark venue.

0

0
2021-02 2021-03 2021-03 2021-04 2021-05
Date (YYYY-MM)
Figure 5: The black line represents the
daily average probability of being at-
tacked for frontrunnable users. The red
line represents the daily proportion of
frontrunnable transactions sent to dark
venue.

6.4 Empirical Results

6.4.1 The Adoption of Dark Venue.

The average adoption rate from February to March is 0.02, with a standard deviation of

0.02. The average adoption rate from April to May is 0.348, with a standard deviation of

0.01. The average adoption rate from June to July is 0.597, with a standard deviation of

0.033. These estimates are supportive of our model prediction that the dark venue will be

at least partially adopted.

6.4.2 Revenue of Miners in the Dark Venue and in the Lit Venue.

We estimate the following linear model to compare revenues of miners who adopt the dark

venue with revenues of miners who stay in the lit venue:

M inerRevenuet = γt + ρ11Dark + (cid:15)t,

(1)

30

Table 2: Results from regressing a binary variable, indicating whether or not the miner of the
block joins the dark venue, on miner’s revenue from mining the block. The regression data
covers a sample period from Nov 1, 2020 to Jul 31, 2021. Time ﬁxed eﬀects are included for
all regressions. Standard errors are clustered at the day level. Asterisks denote signiﬁcance
levels (***=1%, **=5%, *=10%).

Intercept

Dark

Day ﬁxed eﬀects?
Observations
R2

Note:

Dependent variables: Miner’s Revenue per Block
1.21∗∗∗
(0.06)
0.16∗∗∗
(0.032)

yes
1,762,017
0.02

∗p<0.1; ∗∗p<0.05; ∗∗∗p<0.01

where t indexes the date, M inerRevenuet is the revenue of miner per block, γt is the day

ﬁxed eﬀects, 1Dark is a dummy variable for Flashbots blocks, and (cid:15)t is an error term. We

cluster our standard errors at the day level. The coeﬃcient ρ1 quantiﬁes the sensitivity of

miner’s revenue per block on whether he joins the dark venue.

Table 2 indicates that joining the dark venue on average increases miners’ revenue by

around 0.16 ETH per block. This is supportive of our model prediction that the expected

payoﬀ of miner who join the dark venue is higher than the expected payoﬀ of miners who

stay in the lit venue. In addition, the coeﬃcient estimates reveal that these relationships are

statistically and economically signiﬁcant.

6.4.3 Cost-to-Revenue Ratio of Arbitrageurs

We estimate the following linear models to compare cost-to-revenue ratio of arbitrageurs

before and after the introduction of the dark venue:

CostRevRatio = ρ21Af ter + (cid:15),

CostRevRatio = ρ31Af ter + ρ41Dark + (cid:15),

31

(2)

(3)

Table 3: Results from regressing the cost-to-revenue ratio of arbitrages on whether the dark
venue is introduced and whether the arbitrage order is sent through the dark venue. The
data for regression covers a sample period from May 4, 2020 to Jul 31, 2021. Asterisks
denote signiﬁcance levels (***=1%, **=5%, *=10%).

Dependent variables: Cost-to-revenue Ratio

(a)

0.300∗∗∗
(0.001)
0.091∗∗∗
(0.001)

428,685
0.03

Intercept

After

Dark

Observations
R2

Note:

(b)

0.300∗∗∗
(0.001)
0.013∗∗∗
(0.001)
0.441∗∗∗
(0.002)

428,685
0.19

∗p<0.1; ∗∗p<0.05; ∗∗∗p<0.01

where CostRevRatio is the cost-to-revenue ratio of arbitrage transactions, 1Af ter is a dummy

variable for the period after the introduction of the dark venue, 1Dark is a dummy variable for

transaction submitted through dark venue, and (cid:15) is an error term. The coeﬃcient ρ2 quan-

tiﬁes the diﬀerence in cost-to-revenue ratio of arbitrages before and after the introduction of

the dark venue. The coeﬃcient ρ4 quantiﬁes the diﬀerence between the cost-to-revenue ratio

of arbitrages sent through the lit venue and arbitrages sent through the dar venue, after the

introduction of the dark venue.

Table 3 (a) indicates that, after the introduction of the dark venue, the average cost-to-

revenue ratio of arbitrageurs increases by around 0.09, a increment that is almost a third

of the average cost-to-revenue ratio before the introduction of the dark venue (around 0.3).

Table 3 (b) indicates that the average cost-to-revenue ratio of arbitrageurs in the dark venue

is 0.44 higher than that of arbitrageur using the lit venue. This suggests that the increase in

the cost-to-revenue ratio after the introduction of the dark venue can be mostly attributed to

arbitrageurs who use the dark venue. All results are statistically and economically signiﬁcant.

The regression results support our model prediction that the introduction of the dark venue

32

Table 4: Results from regressing the proportion of frontrunnable transaction sent through
dark venue on the probability of being frontrun. The data for regression covers a sample
period from Feb 11, 2020 to May 1, 2021. Asterisks denote signiﬁcance levels (***=1%,
**=5%, *=10%).

Intercept

Probability of Being Frontrun

Dependent variables:
Proportion of Transactions Through Dark Venue
-0.066∗∗
(0.18)
0.605∗∗∗
(0.010)

Observations
R2

Note:

80
0.3

∗p<0.1; ∗∗p<0.05; ∗∗∗p<0.01

increases the cost of arbitrageurs and lowers their welfare.

6.4.4 The Migration of Users

We estimate the following linear model to measure the relationship between users’ probability

of being frontrun and their venue choice:

P roportionDark = κF rontrunP rob + (cid:15),

(4)

P roportionDark is the proportion of frontrunnable transactions sent through the dark venue,

F rontrunP rob is the probability of being frontrun for transactions sent through the lit venue,

and (cid:15) is an error term. The coeﬃcient κ quantiﬁes the sensitivity of users’ venue selection

on the frontrunning risk faced by users.

Table 4 indicates that an increase in the probability of being frontrun is positively cor-

related (60% correlation) with a higher proportion of transactions sent through the dark

venue. A 1% increase in probability of being frontrun is associated with a 0.6% increase in

the proportion of frontrunnable transactions submitted through the dark venue. The coeﬃ-

cient estimates indicate that these relationships are statistically and economically signiﬁcant.

33

In summary, Table 4 supports our model prediction that frontrunnable users migrate from

the lit venue to the dark venue when they face higher frontrun risk.

34

References

Yannis Bakos and Hanna Halaburda. 2021. Tradeoﬀs in Permissioned vs Permissionless

Blockchains: Trust and Performance. Working Paper.

Bruno Biais, Christophe Bisière, Matthieu Bouvard, and Catherine Casamatta. 2019. The

Blockchain Folk Theorem. The Review of Financial Studies 32, 5 (04 2019), 1662–1715.

Eric Budish, Robin S Lee, and John J Shim. 2019. A Theory of Stock Exchange Competition

and Innovation: Will the Market Fix the Market? Working Paper 25855. National Bureau

of Economic Research.

Sabrina Buti, Barbara Rindi, and Ingrid M. Werner. 2017. Dark pool trading strategies,

market quality and welfare. Journal of Financial Economics 124, 2 (2017), 244–265.

https://EconPapers.repec.org/RePEc:eee:jfinec:v:124:y:2017:i:2:p:244-265

Agostino Capponi, Sveinn Olafsson, and Humoud Alsabah. 2019. Proof-of-Work Cryptocur-

rencies: Does Mining Technology Undermine Decentralization? Working Paper.

Hao Chung and Elaine Shi. 2021. Foundations of Transaction Fee Mechanism Design. arXiv

preprint arXiv:2111.03151 (2021).

Lin William Cong and Zhiguo He. 2019. Blockchain Disruption and Smart Contracts. The

Review of Financial Studies 32, 5 (04 2019), 1754–1797.

Lin William Cong, Zhiguo He, and Jiasun Li. 2020a. Decentralized Mining in Centralized

Pools. The Review of Financial Studies 34, 3 (04 2020), 1191–1235.

Lin William Cong, Ye Li, and Neng Wang. 2020b. Token-Based Platform Finance. NBER

Working Papers 27810. National Bureau of Economic Research, Inc.

P. Daian, S. Goldfeder, T. Kell, Y. Li, X. Zhao, I. Bentov, L. Breidenbach, and A. Juels. 2020.

Flash Boys 2.0: Frontrunning in Decentralized Exchanges, Miner Extractable Value, and

Consensus Instability. In 2020 IEEE Symposium on Security and Privacy (SP). 910–927.

35

Hans Degryse, Mark Van Achter, and Gunther Wuyts. 2009. Dynamic order submission

strategies with competition between a dealer market and a crossing network. Journal of

Financial Economics 91, 3 (2009), 319–338. https://EconPapers.repec.org/RePEc:

eee:jfinec:v:91:y:2009:i:3:p:319-338

David Easley, Maureen O’Hara, and Soumya Basu. 2019. From mining to markets: The

evolution of bitcoin transaction fees. Journal of Financial Economics 134, 1 (2019), 91–

109.

Shayan Eskandari, Seyedehmahsa Moosavi, and Jeremy Clark. 2019. Sok: Transparent

dishonesty: front-running attacks on blockchain. In International Conference on Financial

Cryptography and Data Security. Springer, 170–189.

Jingxing (Rowena) Gan, Gerry Tsoukalas, and Serguei Netessine. 2021. Initial Coin Oﬀerings,

Speculation, and Asset Tokenization. Management Science 67, 2 (2021), 914–931.

Campbell R. Harvey, Ashwin Ramachandran, and Joey Santoro. 2021. DeFi and the Future

of Finance. Working Paper.

Gur Huberman, Jacob D Leshno, and Ciamac Moallemi. 2021. Monopoly without a Monop-

olist: An Economic Analysis of the Bitcoin Payment System. The Review of Economic

Studies 88, 6 (03 2021), 3011–3040.

Kose John, Thomas J Rivera, and Fahad Saleh. 2020. Economic Implications of Scaling

Blockchains: Why the Consensus Protocol Matters. Working Paper.

Satoshi Nakamoto. 2008. Bitcoin: A Peer-to-Peer Electronic Cash System. Unpublished

Manuscript.

Andreas Park. 2021. The Conceptual Flaws of Constant Product Automated Market Making.

Working Paper.

36

Chris Piatt, Jeﬀrey Quesnelle, and Caleb Sheridan. 2021. Eden Network. Unpublished

Manuscript.

Julien Prat and Benjamin Walter. 2021. An Equilibrium Model of the Market for Bitcoin

Mining. Journal of Political Economy 129, 8 (2021), 2415–2452.

Kaihua Qin, Liyi Zhou, and Arthur Gervais. 2021. Quantifying Blockchain Extractable

Value: How dark is the forest? arXiv preprint arXiv:2101.05511 (2021).

Tim Roughgarden. 2021. Transaction fee mechanism design. ACM SIGecom Exchanges 19,

1 (2021), 52–55.

Ioanid Roşu and Fahad Saleh. 2021. Evolution of Shares in a Proof-of-Stake Cryptocurrency.

Management Science 67, 2 (2021), 661–672.

Fahad Saleh. 2020. Blockchain without Waste: Proof-of-Stake. The Review of Financial

Studies 34, 3 (07 2020), 1156–1190.

Christof Ferreira Torres, Ramiro Camino, et al. 2021. Frontrunner Jones and the Raiders

of the Dark Forest: An Empirical Study of Frontrunning on the Ethereum Blockchain. In

30th USENIX Security Symposium (USENIX Security 21). 1343–1359.

Ye Wang, Zuest Partick, Yaxing Yao, Zhicong Lu, and Roger Wattenhofer. 2022. Impact

and User Perception of Sandwich Attacks in the DeFi Ecosystem. In ACM Conference on

Human Factors in Computing Systems (CHI), New Orleans, LA, USA.

David Yermack. 2017. Corporate Governance and Blockchains. Review of Finance 21, 1 (01

2017), 7–31.

Haoxiang Zhu. 2014. Do Dark Pools Harm Price Discovery? The Review of Financial Studies

27, 3 (2014), 747–789. http://www.jstor.org/stable/24465693

37

A Technical Results and Proofs

Proofs of Proposition 1, 2. We ﬁrst outline all six potential equilibrium outcomes for venue

selection of arbitrageurs. We then solve for the equilibrium transaction fee bidding strategies

in all six cases. Finally, we solve for the equilibrium venue selection strategies of arbitrageurs.

There are six potential equilibrium outcomes for arbitrageurs’ venue selection: (1) Both

arbitrageurs choose the dark venue; (2) One arbitrageur chooses the dark venue, and the

other arbitrageur chooses the lit venue; (3) One arbitrageur chooses the dark venue, and the

other arbitrageur chooses both venues; (4) One arbitrageur chooses the lit venue, and the

other arbitrageur chooses both venues; (5) Both arbitrageurs choose the lit venue; (6) Both

arbitrageurs choose both venues.

Case 1: Both arbitrageurs choose the dark venue. We show that there is no pure

strategy Nash equilibrium (PNE), and there exists a unique mixed strategy Nash equilibrium

(MNE) where both arbitrageurs bid g ∈ [vB−2, c], and g follows the probability distribution

P (g) =






1−p
p

·

(1−

g−vB−2
c−vB−2

1
)2·(c−vB−2)

v ≤ (c − vB−2) · p + vB−2

0

v > (c − vB−2) · p + vB−2

We prove the non-existence of PNE in two steps. First, we show that there is no sym-

metric PNE using a contradiction argument. Second, we show that there is no asymmetric

PNE.

Assume there is a symmetric PNE where both arbitrageurs bid the same transaction

price fDi = fDj = g, and the expected utility of arbitrageur i is not higher than the expected
utility of arbitrageur j. We argue that there exists an unilateral deviation which allows

arbitrageur i to improve its expected utility. If g < c, the expected utility of arbitrageur i is

Ai ≤ (1 − p) · (c − g) + p

2 · (c − gi). Arbitrageur i can increase its expected utility by changing
i = c − (g + (cid:15)) > Ai. If
g = c, the expected utility of arbitrageur i is 0. Arbitrageur i can then deviate to a strategy

= g + (cid:15). Its expected payoﬀ would then be A(cid:48)

its strategy to f (cid:48)
Di

38

f (cid:48)
Di

= vB−2. Then its expected payoﬀ is A(cid:48)

i = p · (c − vB−2) > 0. Therefore, there exists no

symmetric PNE.

We next argue that there exists no asymmetric PNE. Assume there exists a PNE where

. We argue that one of the bidding arbitrageurs can improve its expected utility

fDi < fDj
by deviating its strategy. If fDi = g > vB−2, the expected utility of arbitrageur i is Ai =
p · (c − g). Therefore, arbitrageur i can deviate to a strategy with f (cid:48)
= vB−2. In such a
Di

case, A(cid:48)

i = p · (c − vB−2) > Ai. If fDi = vB−2 and fDj = g > vB−2 + (cid:15), the expected utility
of arbitrageur j is Aj = c − g. Therefore, arbitrageur j can deviate to a strategy where

= vB−2 + (cid:15). In this case, A(cid:48)

j = c − (vB−2 + (cid:15)) > Aj. If fDi = vB−2 and fDj = vB−2 + (cid:15), the
f (cid:48)
Dj
expected utility of arbitrageur i is Ai = p · (c − vB−2). Therefore, arbitrageur i can deviate

to a strategy with f (cid:48)
Dj

= vB−2 + 2(cid:15). In this case, A(cid:48)

i = c − (vB−2 + 2(cid:15)) > Ai. Therefore, there

exists no asymmetric PNE.

Next, we discuss MNE. We show that there exists no pure strategy which yield a higher

expected utility than the mixed strategy for all players.

When arbitrageur i play the mixed strategy, its expected utility is

Ai = (1 − p) ·

(cid:90) (c−vB−2)·p+vB−2

P (t) · (c − t)dt

vB−2

(cid:90) (c−vB−2)·p+vB−2

+ p ·

(cid:90) t

P (t) · (

P (s)ds) · (c − t)dt

vB−2

= (1 − p) ·

(cid:90) (c−vB−2)·p+vB−2

vB−2
1 − p
p

·

(1 − t−vB−2
c−vB−2

1
)2 · (c − vB−2)

· (c − t)dt

1 − p
p

·

(1 − t−vB−2
c−vB−2

1
)2 · (c − vB−2)

·

(1 − p) · (t − vB−2)
p · (c − t)

· (c − t)dt

vB−2
(cid:90) (c−vB−2)·p+vB−2

+ p ·

vB−2

= (1 − p) · (c − vB−2)

Then we show that the other bidding strategy cannot outperform the MNE strategy. We

ﬁrst consider the pure strategy where f (cid:48)
Di

=> (c − vB−2) · p + vB−2. The bidder will then

39

always win the game. Therefore, A(cid:48)

j = c − −f (cid:48)
Di

< (1 − p) · (c − vB−2), which indicates that

bidders are not better oﬀ deviating.

Next, we consider the pure strategy where f (cid:48)
Di

≤ (c − vB−2) · p + vB−2. We can write the

expected utility of arbitrageur i as

A(cid:48)
i

= (1 − p) · (c − f (cid:48)
Di

) + p · (c − f (cid:48)
Di

) ·

(cid:90) f (cid:48)
Di

vB−2

P (t)dt = (1 − p) · (c − vB−2).

Therefore, deviating to another strategy f (cid:48)
Di
trageur i when the other bidder plays the mixed strategy. Therefore, a combination of any

cannot increase the expected utility of arbi-

pure strategies cannot outperform the mixed strategy.

Case 2: one arbitrageur chooses the dark venue, and the other arbitrageur

chooses the lit venue. As there is no competition in the dark venue, the arbitrageur

in the dark venue will bid the lowest bid vB−1 when he observes an arbitrage opportunity or

ﬁnds the other arbitrageur’s bid in the lit venue. The arbitrageur in the lit venue also bids

vB−1 because he is the only bidder in the lit venue.

Case 3: one arbitrageur chooses he dark venue, and the other arbitrageur chooses

both venues.

The arbitrageur acting in both venues bids c in the dark venue and vB−2

in the lit venue. It knows that this information will be leaked to the other arbitrageur. It

bids the lowest bid in the lit venue as there is no competition.

It bids truthfully in the

dark venue because this is a sealed-bid ﬁrst-price auction, where both bidders have the same

valuation c. The arbitrageur acting only in the dark venue observes the other arbitrageur

bidding in the lit venue. Then it will bid c in the dark venue. This is because in the dark

venue, the bidding mechanism is a sealed-bid ﬁrst-price auction where both bidders have the

same valuation. If the arbitrageur ﬁnds an opportunity, and it does not observe the bid of

the other arbitrageur, it will just bid vB−2 because there is no competition.

40

Case 4: one arbitrageur chooses the lit venue, and the other arbitrageur chooses

both venues. We ﬁrst consider the arbitrageur which submits too both venue. This

arbitrageur always bids vB−2 in the dark venue because there is no competition in the dark

venue. We then consider both arbitrageurs’ strategies in the lit venue. It is obvious that

the one which submits the opening bid will be vB−1 because this lowers its transaction cost.

If the auction ends in this round, then its transaction cost is minimized.

If the auction

continues, setting up an opening bid as vB−1 also lowers its expected transaction cost. For

each round, both arbitrageurs just increase by the minimal increment (cid:15) because this lowers

their transaction cost.

Case 5: both arbitrageurs choose the lit venue.

If both arbitrageurs choose the lit

venue, their bidding strategy in the lit venue is exactly the same as their strategy in Case 4.

Case 6: both arbitrageurs choose both venues

If both arbitrageurs choose both

venues, they all bid truthfully in the dark venue. This is because the bidding mechanism is

a sealed-bid, ﬁrst-price auction where both arbitrageurs have the same valuation. In the lit

venue, they all use the same bidding strategy as in Case 4.

We then calculate the expected equilibrium payoﬀ of each arbitrageur in all six cases,

and construct the following matrix:

A1,
A2

Dark

Lit

All

Dark

Lit

All

αp(1 − p)(c − vB−2),
αp(1 − p)(c − vB−2)

(1 − α)p(c − vB−2),
α(1 − (1 − p)2)(c − vB−2)

(1 − α)p(c − vB−2),
αp(1 − p)(c − vB−2)

1

1

α(1 − (1 − p)2)(c − vB−2),
(1 − α)p(c − vB−2)
2 (c − γvB−2)(1 − (1 − p)2),
2 (c − γvB−2)(1 − (1 − p)2)
( 1
2 (c − γvB−2)(1 − α)
+α(c − vB−2)(1 − (1 − p)2),
2 (1 − α)(c − γvB−2)(1 − (1 − p)2)

1

αp(1 − p)(c − vB−2),
(1 − α)p(c − vB−2)
1
2 (1 − α)(c − γvB−2)(1 − (1 − p)2),
( 1
2 (c − γvB−2)(1 − α)
+α(c − vB−2)(1 − (1 − p)2)
( 1
2 (c − γvB−2)(1 − α))(1 − (1 − p)2),
( 1
2 (c − γvB−2)(1 − α))(1 − (1 − p)2)

where γ > 1, γvB−2 < c.

We next solve for the equilibrium venue selection strategy of arbitrageurs.

41

If α > α2 = 1
2−p

2(c − γvB−2)(1 − α))(1 − (1 − p)2), and
αp(1 − p)(c − vB−2) > (1 − α)p(c − vB−2). Those two conditions ensure that the unique

, αp(1 − p)(c − vB−2) > ( 1

equilibrium is that both arbitrageurs choose the dark venue.

pγ+p−2γ−1

If α < α1 = pγ−2γ

, αp(1−p)(c−vB−2) < (1−α)p(c−vB−2) and αp(1−p)(c−vB−2) >
2(c − γvB−2)(1 − α))(1 − (1 − p)2). Using the tie-break rule and the two conditions above,
( 1
the unique equilibrium is that both arbitrageurs choose both venues.

If α2 > α > α1, we have αp(1 − p)(c − vB−2) < ( 1

2(c − γvB−2)(1 − α))(1 − (1 − p)2), and
αp(1 − p)(c − vB−2) > (1 − α)p(c − vB−2). Those two conditions ensure that one arbitrageur

choosing both venues, and the other arbitrageur choosing the dark venue is the equilibrium.

Proof of Proposition 3. We only prove the proposition in the case α ∈ (α2, 1]. The other

two cases can be shown using the same procedure. If α ∈ (α2, 1], by Proposition 1, both

arbitrageurs choose the dark venue.

If the frontrunnable user chooses the dark venue, her expected payoﬀ is

α(v0 − vB−1).

If instead the frontrunnable user chooses the lit venue, her expected payoﬀ is

((1 − α) + α(1 − p)2)(v0 − vB−2) + α(1 − (1 − p)2)(v0 − c − vB−2)).

Comparing the payoﬀ in the two venues, we have that the frontrunnable user chooses the

dark venue if and only if α > λ1 =

v0−vB−1
−cp2+2cp+vB−1p2−2vB−1p−vB−1−vB−2p2+2vB−2p+v0

Proof of Proposition 4. Suppose α = 0. If the frontrunnable user submits to the lit venue,

then the payoﬀ of the frontrunnable user is

(1 − p)2(v0 − vB−2) + (1 − (1 − p)2)(v0 − c − vB−2)).

42

The quantity above is positive if and only if c < c1 = v0−vB−2
(1−(1−p)2)

. If it is positive, then

the frontrunnable user will submit her transaction. Otherwise, she will not submit to the

blockchain.

Proof of Proposition 5. If c > c1, the frontrunnable user will only use the dark venue. This is

because using the lit venue generates a payoﬀ (1−p)2(v0−vB−2)+(1−(1−p)2)(v0−c−vB−2)) <

0, while using the dark venue generates a payoﬀ α(v0 − vB−2) ≥ 0

Miners in the lit venue earn rlit(α) = BvB+1 after mining a block. For any suﬃciently

small mass δ > 0 of miners who migrate from the lit to the dark venue, they earn rdark(α +

δ) = BvB > BvB+1. In equilibrium, all miners adopt the dark venue.

If c ≤ c1, we can show that λ1 is a equilibrium, and it is easy to verify that the other

equilibria are λ2, λ3, 1.

At λ1, for a suﬃciently small mass δ > 0 of miners migrating to the dark venue, their

payoﬀs in the dark venue are equal to (B − 1)vB−2 + (1 − p)2vB−1 + c(1 − (1 − p)2). If they

migrate to the lit venue, their payoﬀ in the lit venue are (B − 1)vB−2 + (1 − p)2vB−1 + (1 −

(1 − p)2)γvB−2 < (B − 1)vB−2 + (1 − p)2vB−1 + c(1 − (1 − p)2). Hence, there is no incentive for

them to migrate. For a suﬃciently small mass δ > 0 of miners in lit venue, the payoﬀ is equal

to (B − 1)vB−2 + (1 − p)2vB−1 + (1 − (1 − p)2)γvB−2. If they migrate to the dark venue, their

payoﬀ is equal to rdark(λ1 + δ) = BvB−1 < (B − 1)vB−2 + (1 − p)2vB−1 + (1 − (1 − p)2)γvB−2.

There is no incentive for them to migrate. This is because if α > λ1, the frontrunnable

user migrates to the dark venue, and there is no longer a frontrunning arbitrage. At λ1,

the frontrunnable user still submits to the lit venue as shown in Proposition 3, and the

arbitrageurs submit to both venues as shown in Proposition 1.

Proof of Proposition 6. If c > c1, frontrunnable trader does not submit transactions in the

mempool, thus the minimum fee that guarantees the execution of a transaction is vB and the

total fee of all transactions are B · vB. With the introduction of a dark venue, the execution

fee increases to vB−1, while the total fee increases to B · vB−1.

43

If c ≤ c1, the minimum fee that guarantees the execution of a transaction is always

vB−2. The expected total fee of all transactions before the introduction of a dark venue is

vB−2 ∗ (B − 1) + (1 − p)2vB−1 + (1 − (1 − p)2)γvB−2, while the expected fee increases to

vB−2 ∗ (B − 1) + (1 − p)2vB−1 + (1 − (1 − p)2)c − 2p(1 − p)(c − vB−2) and vB−2 ∗ (B − 1) +

(1 − p)2vB−1 + (1 − (1 − p)2)(c − vB−2) in partially adoption Nash equilibria.

Proof of Proposition 7. We compare the welfare of miners, frontrunnable users, and arbi-

trageurs separately before and after the introduction of the dark venue.

Before the introduction of the dark venue, with probability 1 − (1 − p)2, the transaction

of frontrunnable user will be observed by arbitrageurs. Therefore, the expected payoﬀ of the

frontrunnable user before the introduction of the dark venue is

.

.

.

v0 − vB−2 − (1 − (1 − p)2)c

The expected payoﬀ of the winning miner is

vB−2 ∗ (B − 1) + (1 − p)2vB−1 + (1 − (1 − p)2)γvB−2

The expected payoﬀ of arbitrageurs is

1
2

(c − γvB−2)(1 − (1 − p)2)

The expected payoﬀ of all non-frontrunnable users is

B−2
(cid:88)

i=1

vi − vB−2 ∗ (B − 2)

44

.

Then, we consider the welfare of diﬀerent stakeholders in Nash equilibria.

In the ﬁrst Nash equilibrium, the frontrunnable user selects the lit venue and the ar-

bitrageurs select both the dark venue. The expected payoﬀ of the frontrunnable user is

v0 − vB−2 − (1 − (1 − p)2)c. The expected payoﬀ of the winning miner if she joins the dark

venue is vB−2 ∗ (B − 1) + (1 − p)2vB−1 + (1 − (1 − p)2)c − 2p(1 − p)(c − vB−2). The expected

payoﬀ of the winning miner if she stays in the lit venue is vB−2 ∗ (B − 1) + vB−1. The payoﬀ

of arbitrageurs is αp(1 − p)(c − vB−2). The expected payoﬀ of all non-frontrunnable users is
(cid:80)B−2

i=1 vi − vB−2 ∗ (B − 2).
In the second Nash equilibrium, the frontrunnable user selects the lit venue and the

arbitrageurs select both venues. The expected payoﬀ of the frontrunnable user is v0 −

vB−2 − (1 − (1 − p)2)c. The payoﬀ of the winning miner if she joins the dark venue is

vB−2 ∗ (B − 1) + (1 − p)2vB−1 + (1 − (1 − p)2)c. The expected payoﬀ of the winning miner

if she stays in the lit venue is vB−2 ∗ (B − 1) + (1 − p)2vB−1 + (1 − (1 − p)2)γvB−2. The
2(c − γvB−2)(1 − α))(1 − (1 − p)2). The expected payoﬀ of all

payoﬀ of arbitrageurs is ( 1

non-frontrunnable users is (cid:80)B−2

i=1 vi − vB−2 ∗ (B − 2).

In the third Nash equilibrium, the frontrunnable user selects the lit venue, while one

arbitrageur selects both venues. The expected payoﬀ of the frontrunnable user is v0 − vB−2 −

(1 − (1 − p)2)c. The payoﬀ of the winning miner if she joins the dark venue is vB−2 ∗ (B − 1) +

(1 − p)2vB−1 + (1 − (1 − p)2)(c − vB−2). The expected payoﬀ of the winning miner if she stays

in the lit venue is vB−2 ∗(B −1)+(1−p)2vB−1 +(1−(1−p)2)γvB−2. The payoﬀ of arbitrageurs
2(c − γvB−2)(1 − α) + α(c − vB−2)(1 − (1 − p)2).

2(c − γvB−2)(1 − α))(1 − (1 − p)2) and 1

are ( 1

Proof of Proposition 8. The aggregate welfare of all stakeholders is the sum of the valuations

of transactions included in the block.

If c > c1, then the frontrunnable trader does not submit transactions before the intro-

duction of the dark venue. Therefore, the aggregate social welfare of stakeholders is (cid:80)B

i=1 vi.

45

Because the full adoption is the only equilibrium in this scenario, the aggregate social welfare

will increase to (cid:80)B−1

i=0 vi after the introduction of the dark venue.

If c ≤ c1, the expected aggregate social welfare of stakeholders before the introduction of

the dark venue is (1 − p)2 (cid:80)B−2

i=0 vi + (1 − (1 − p)2) (cid:80)B−1

i=0 vi.

The expected aggregate social welfare of stakeholders after the introduction of the dark

venue is

• (1 − α)((cid:80)B−1

i=0 vi) + α · ((1 − p)2 (cid:80)B−2

i=0 vi + (1 − (1 − p)2) (cid:80)B−1

i=0 vi), if both arbitrageurs

select the dark venue;

• (1 − p)2 (cid:80)B−2

i=0 vi + (1 − (1 − p)2) (cid:80)B−1

i=0 vi, if both arbitrageurs select both venues;

• (1 − p)2 (cid:80)B−2

i=0 vi + (1 − (1 − p)2) (cid:80)B−1

i=0 vi, if one arbitrageur selects the lit venue and

the other selects both venues.

Therefore, the introduction of the dark venue weakly raises aggregate welfare in all Nash

equilibria.

If the dark venue is fully adopted, then the sum of the valuations of transactions included

in the block is (cid:80)B−1

i=0 vi. If the dark venue is only partially, arbitrage transactions might be
included in the block if the winning miner joins the dark venue. As arbitrage transactions

does not generate social welfare and have substituted another non-frontrunnable transaction.

Therefore, the largest expected aggregate social welfare in all NE is (1 − α)((cid:80)B−1
((1 − p)2 (cid:80)B−2

i=0 vi + (1 − (1 − p)2) (cid:80)B−1

i=0 vi) < (cid:80)B−1

i=0 vi.

i=0 vi) + α ·

Proof of Proposition 9. If c > c1, there exists a unique full adoption equilibrium at which

the aggregate welfare is maximized. The required payment is then zero.

If c ≤ c1, then there exists a partial adoption equilibrium. At the partial adoption

equilibrium, the adoption rate of the dark venue is α∗ ∈ {λ1, λ2, λ3}. We only prove the

case where α∗ = λ1, and the other two cases can be shown with the same procedure. At

46

equilibrium, the expected arbitrage loss of the frontrunnable user is (1 − (1 − p)2)c. (1 − (1 −

p)2)c is also the sum of expected arbitrage revenue of two arbitrageurs. The sum of expected

transaction fees paid by two arbitrageurs is (1 − (1 − p)2)γvB−2, where c > γvB−2 as the

arbitrageurs extract non-negative proﬁt from frontrunning. Assume that frontrunnable user

commits to pay (1 − (1 − p)2)c to the winning miner who has adopted the dark venue. When

vB−2 − vB−1 is suﬃciently small, rdark(λ1 + δ) = BvB−1 + (1 − (1 − p)2)c > (B − 1)vB−2 + (1 −

p)2vB−1 + (1 − (1 − p)2)γvB−2 = rlit(λ1 + δ). In this way, a marginal miner will migrate to the

dark venue, and any partial adoption equilibrium does not exist. Besides, the frontrunnable

user is not worse oﬀ after making the payment.

47

B Empirical Methodology

B.1 Frontrunning Arbitrages

In this section, we explain the methodology used to identify frontrunning arbitrages. We

identify a two-legged trade (TA1, TA2) as a frontrunning arbitrage, and a transaction TV as

the corresponding victim transaction, if the following conditions are met:

1. TA1 and TA2 are included in the same block, and TA1 is executed before TA2. TA1 and

TA2 have diﬀerent transaction hashes.

2. TA1 and TA2 swap assets in the same liquidity pool, but in opposite directions. The

input amount for the swap in TA2 is equal to the output amount of the swap in TA1.

In this way, the transaction TA2 closes the position built up in the ﬁrst leg TA1.

3. TV is executed between TA1 and TA2. TV swaps assets in the same liquidity pool as

TA1 and TA2. TV swaps assets in the same direction as TA1.

4. Every transaction TA2 is mapped to exactly one transaction TA1.

There exists frontrunning arbitrages where TA1 and TA2 are placed in diﬀerent blocks.

However, arbitrageurs normally prefer to include TA1 and TA2 in one block to minimize

inventory risk. Nonetheless, the above procedure allows us to ﬁnd a lower bound for the

number of frontrunning arbitrages. The revenue of a frontrunning arbitrage is the diﬀerence

between the output of TA2 and the input of TA1, and the proﬁt is the revenue minus the gas

fee paid for these two transactions.

B.2 Frontrunnable Transactions

In this section, we provide that methodology to identify transactions vulnerable to fron-

trunning arbitrages. Observe that not all frontrunnable transactions are exploited by arbi-

trageurs.

48

There were 17, 644, 672 transactions in the given time frame. The input token of 9, 003, 759

of these transactions is ETH. We only focus on those transactions. This is because most

arbitrageurs are bots, and only conduct arbitrages where ETH serves as input token. For

each transaction, we calculate the optimal revenue that an arbitrageur can attain by fron-

trunning this transaction.

If the revenue is positive, then we identify this transaction as

frontrunnable.

A swap transaction often has a slippage tolerance threshold m which speciﬁes the min-

imum amount of output token to be received in the transaction.

If the price impact of

the frontrunning transaction TA1 is too large, the slippage tolerance threshold of the victim

transaction TV may be triggered and TV will automatically fail. In this case, the arbitrage

will not be proﬁtable. This is why we have to account for the slippage tolerance threshold

for each swap transaction in our calculation. Formally, let v be the amount of input token

speciﬁed in the victim transaction TV , and m the minimum amount of output token to be

received. Let x be the amount of input token swapped in the frontrunning transaction TA1.

Let r1 and r2 represent the liquidity reserves of input token and output token in the pool.

The transaction fee in Uniswap and Sushiswap is 0.3%. The victim transaction will not fail

if

v · 0.997 · (r2 − x·0.997·r2
(r1 + x) + 0.997 · v

r1+0.997·x)

≥ m.

We solve the largest x that satisﬁes the above inequality. The result can be written as

maxInputA1(r1, r2, v, m) =

5.01505 · 10−7 · t
√
m

− 1.0015r1 − 0.4985v,

where

(cid:113)

t =

9000000r2

1m + 3976036000000r1r2v − 5964054000r1mv + 988053892081mv2.

49

The maxInputA1

is the largest trade size of transaction TA1 such that TV will not fail.

We can then calculate the output amount in the second leg of the arbitrage TA2 which closes

the position built up in TA1. TV is frontrunnable if the constructed frontrunning arbitrage

yields a positive revenue. In total, we identify 3, 612, 343 frontrunnable transactions with

ETH as the input token.

50

