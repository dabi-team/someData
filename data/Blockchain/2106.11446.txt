1
2
0
2

l
u
J

6

]

N
G
.
n
i
f
-
q
[

2
v
6
4
4
1
1
.
6
0
1
2
:
v
i
X
r
a

Bitcoin’s Crypto Flow Network

Yoshi Fujiwara1 and Rubaiyat Islam1

1Graduate School of Information Science, University of Hyogo, Kobe 650-0047, Japan

E-mail: yoshi.fujiwara@gmail.com

(Received May 31, 2021)

How crypto ﬂows among Bitcoin users is an important question for understanding the structure and
dynamics of the cryptoasset at a global scale. We compiled all the blockchain data of Bitcoin from
its genesis to the year 2020, identiﬁed users from anonymous addresses of wallets, and constructed
monthly snapshots of networks by focusing on regular users as big players. We apply the methods of
bow-tie structure and Hodge decomposition in order to locate the users in the upstream, downstream,
and core of the entire crypto ﬂow. Additionally, we reveal principal components hidden in the ﬂow
by using non-negative matrix factorization, which we interprete as a probabilistic model. We show
that the model is equivalent to a probabilistic latent semantic analysis in natural language processing,
enabling us to estimate the number of such hidden components. Moreover, we ﬁnd that the bow-tie
structure and the principal components are quite stable among those big players. This study can be a
solid basis on which one can further investigate the temporal change of crypto ﬂow, entry and exit of
big players, and so forth.

Presented at the conference “Blockchain in Kyoto 2021”, and forthcoming in the JPS Conference
Proceedings.
KEYWORDS: Bitcoin, cryptoasset, bow-tie structure, Hodge decomposition, non-negative
matrix factorization, latent Dirichet allocation, complex network

1.

Introduction

Cryptoasset or cryptocurrency is essentially a digital ledger to record transactions between cred-
itors and debtors, just like money. The digital system is based on a collection of non-centralized
ledgers, called blockchain, which contains all the historical record of transactions among anonymous
users. Today there are many cryptoassets being exchanged in markets with ﬁat currencies and also
with each other. The market capitalization is so huge in total ranging from one to a few trillion USD,
and highly volatile potentially having a big impact even on asset markets and prices of non-crypto at
a global scale.

In this paper, we study Bitcoin, the largest one dominating nearly half of the market capitalization
at the time of writing. We attempt to understand the ﬂow of crypto as a complex network comprising
of the users as nodes and the crypto ﬂow as links. There are a number of studies from such a viewpoint
of complex network on cryptoassets. See [1–16] for example, and references therein.

Speciﬁcally, in this paper, we focus on “big players” who are deﬁned as persistently appearing
users, likely to be involved in transactions of high frequencies and large amounts, and address the
following questions. First, it is important to identify the users in the upstream, downstream, or core in
the entire crypto ﬂow. We shall examine the so-called “bow-tie” structure of the network of those big
players to classify the location of the crypto ﬂow based on the binary relationship of links. Second, we
measure the location in a more quantitative way by using the information of ﬂow along the links in the
combinatorial method of Hodge decomposition. Third question is to extract “principal components”
hidden in the entire crypto ﬂow so as to uncover a certain number of latent factors or components.

1

 
 
 
 
 
 
Fourth, because the network is changing in time, what can one say about the stability of the crypto
ﬂow?

In Section 2, we describe our dataset of Bitcoin to identify the anonymous addresses representing
wallets into users. Then we deﬁne regular users as big players and construct networks. In Section 3.1,
we perform the bow-tie analysis to locate users in the stream of crypto ﬂow. In Section 3.2, we use the
method of Hodge decomposition to quantify the location of users. In Section 3.3, we introduce non-
negative matrix factorization as a method of matrix decomposition to reveal principal components
hidden in the ﬂow. We shall show in Section 3.4 that the method can be interpreted as a probabilistic
model, from which one can estimate the number of components. In Section 3.5, we ﬁnd about a dozen
of principal components among several hundred big players, and show that the temporal change of
the network is quite stable. In Section 4, we discuss about several aspects, being worth further investi-
gation, and conclude in Section 5. We add Appendix A for the identities (actual names, business, and
so forth) of selected users. Appendix B illustrates the networks in adjacency matrices. Appendix C
brieﬂy summarizes the above mentioned probabilistic model in relation to latent Dirichlet allocation,
from which the estimation on the number of components is done in Appendix D.

2. Data

We employ the dataset of all transactions recorded in the Bitcoin blockchain from the genesis
block (ﬁrst block issued on January 9, 2009) until the block of height 63,299 (inclusive; issued on
June 4, 2020). Each transaction is a transfer of a certain amount of BTC (monetary unit of Bitcoin)
from one or more addresses to others as we will see shortly. We call such a transfer of BTC as crypto
ﬂow. An address is something like a wallet possessed by a user who can be an individual or, more
frequently today, an agent in the business of exchanges, services, gambling, and so forth.

In the dataset, total number of transactions was 1.38 billion, while the number of diﬀerent ad-
dresses was about 657 million. To study crypto ﬂow of Bitcoin, one needs to know users, rather than
the addresses. However, it is not straightforward to identify users from addresses because of the very
nature of anonymity inherent in the core technology of blockchain. See [17] for technical details.

Let us employ a simple but useful method to identify users from addresses to construct a giant
graph comprising of nodes as users and edges as crypto ﬂow. We shall see that more than 60% of the
addresses can be identiﬁed with users. Additionally we will see that a number of users can be revealed
with their actual names, types of business, and sometimes geographical location at a global scale.
Then we deﬁne regular users as big players in order to focus on a subgraph comprising of frequently
appearing users who are involved in crypto ﬂow with huge amounts of BTC. The subgraph will be
studied in the subsequent sections.

2.1 Identiﬁcation of Users from Addresses

Consider an example of such a transaction (TX) that one day Alice transferred 1 BTC to Bob:

TX1 : {a1, a2} → {a123, a1} ,

(1)

where the addresses a1 and a2 belong to Alice, while a123 belongs to Bob. Alice needs more than
one address as input of TX1, because a single one was not suﬃcient to fulﬁll the amount of 1 BTC.
Output of TX1 includes a1 representing the change. Another day, Alice did another transaction:

TX2 : {a1, a3} → {a45, a3} ,

(2)

where the address a3 also belongs to Alice. Obviously, multiple addresses, if and only if they appear
in an input of a transaction, belong to the same user, namely her wallets. As a consequence from both
of (1) and (2), it follows that a1, a2, a3 can be identiﬁed to belong to the same user. Note that a2 and

2

Fig. 1. Rank-size plot for the number of addresses identiﬁed with users. Size (horizontal) is the number of
addresses identiﬁed with users of type A (a group of addresses appearing in multiple inputs of transactions, so
identiﬁed as user; see main text). Rank (vertical) is the descending order of the size. Maximum size is nearly
20 million, while minimum is 2 and average is 6.7.

a3 did not appear in any record of transactions, TX1 and TX2. By looking at all the transaction in the
history, one can identify many addresses with users.

This simple but useful method to identify users from addresses was proposed by [1] and has been
extensively used in the literature (see [4, 5] and the data of [18, 19], for example). We implemented
an eﬃcient algorithm of this method to process the above mentioned 657 million addresses in the
1.375 billion transactions. We found that 402 million addresses (more than 60%) can be identiﬁed
to obtain 60 million diﬀerent users (denoted as type A). The rest of 255 million addresses, which
never appeared as multiple inputs in any transactions, are regarded as diﬀerent users (type B). This
procedure results in 315 million users all together.

Fig. 1 shows a rank-size plot, in which the size is the number of addresses identiﬁed with users
of type A, and the rank is its descending order. The minimum size is 2 by construction, while the
average is 6.7. It is interesting to observe that the rank-size plot is highly skewed with the maxi-
mum size being nearly 20 million! We labeled all the users of type A in a sequential user ID cor-
responding to the rank (e.g. 0000012345), while users of type B is labeled with its address (e.g.
3CjqmbuRA1LEWmLHiWoSWHcWuTEVPfU24P).

A bunch of transactions is packed into a block in the blockchain. Each block has a timestamp
of its birth, which is UTC (Coordinated Universal Time) when the block was mined or born as an
empty ledger to be ﬁlled with transactions. We associate the time with the transactions contained in
the block. Each block is mined in a mean time of 20 minutes or longer, as is well known, so it should
be understood that by time we mean a rough estimate on when the transaction was made within an
accuracy of an hour or so. One can use this information of the timestamp to obtain the intra-day
activities of users. Fig. 2 is a schematic diagram for typical three users, presumably located in Asia,
Europe including Africa, and USA.

Moreover, with the help of laborious investigation by [19], it is possible to unravel the identity
of users of type A with actual names, types of business, and sometimes geographical location for
many users. Appendix A is the summary of the unraveled identity. Table A·1 gives the classiﬁcation
of business into exchanges, gambling, pools, services and others. Nearly one third in the list are
exchanges. Table A·2 is the list of countries of those exchanges, where China, UK, and USA are

3

Fig. 2. Schematic diagram for the intra-day activities of users. Top is a world map with UTC (Coordinated
Universal Time). The bottom three plots depict the number of transactions involving three users. Each plot
shows the numbers of transactions of out-ﬂow (green), in-ﬂow (blue), self-loop (magenta), and their total (bold
red), where each number is accumulated during the year 2019. Out-ﬂow, in-ﬂow, and self-loop are respectively
the transaction in which the user is its source, destination, and both of them simultaneously. A peak of the red
line shows the most active time, corresponding to the daytime of USA, Europe, and Asia (left to right). Arrows
indicate noon of speciﬁc locations.

dominant, followed by Canada, Australia, Brazil, Singapore, and Russia. In fact, as found in the
top of Table A·3, the user ID 0000000000 corresponding to the maximum size in Fig. 1 is actually
Bit-x.com and Xapo.com, the former of which is an agent of exchange in South Africa.

Exchanges are a typical category of “big players” in the sense that they actually hold a huge
number of individuals and agents as customers resulting in a large number of transfers. As a matter
of fact, the daily number of transfers has an interesting weekly pattern. There is signiﬁcantly less
activity in weekends than in weekdays as found in recent data of Bitcoin1 (see our previous study
[21, 22]). Such a weekly pattern implies that those institutional agents are dominant in the entire ﬂow
of crypto.

2.2 Crypto Flow Network

Now all the transactions among addresses are converted into transfers from users to users, each

of which has the following information:

• user of source s,
• user of destination d,
• amount of Bitcoin transferred from s to d, i.e. s → d,
• UTC time of transfer (from the block containing the transaction).

During a certain period of time T , for a pair of users, there can be more than one transfer as
depicted in Fig. 3 (see the left-hand side). In this example, there are three transfer of crypto for i → j,
one for j → i, and also two for i → i. The last case of self-loop is possible, because one can receive a
change in a transaction, and also because diﬀerent addresses are possibly identiﬁed with a user, like

1Cryptoasset of XRP has a similar weekly pattern according to [20]. In the early history of Bitcoin, the weekly pattern

was quite the opposite; more active in weekends, presumably because individuals were big players at that time.

4

1

i

2

0.1

0.2

0.4

0.1

Aggregated

i

j

fii = 3
gii = 2

fij = 0.7
gij = 3

fji = 0.1
gji = 1

j

Fig. 3. Aggregation of transactions to construct crypto ﬂow network. Left: During a given period of time,
for a pair of users i and j, three transfers for i → j with 0.1, 0.2, 0.4 in BTC, one of j → i with 0.1, and two
for i → i with 1 and 2. Right: After aggregation, one has i → j with frequency fi j = 3 and amount of ﬂow
gi j = 0.7. Similarly, j → i with f ji = 1 and amount of ﬂow g ji = 0.1, and i → i with fii = 2 and gii = 3.

an exchange. Given a time-scale T , it would be reasonable to aggregate these transactions as shown
in the right-hand side of Fig. 3.

After the aggregation, one has a network comprising of nodes as users and edges with direction
given by the transfer of crypto, frequency and amount of transfer occurred during the period of time.
Let us denote the following variables which represent the strength or weight of each edge by

frequency fi j ≡ frequency of transfers for i → j,
amount of ﬂow gi j ≡ amount of total transfers for i → j.

Regarding the time-scale T for aggregating the transactions and the epoch to select in the histor-
ical data, we choose one month and the calendar year of 2019. By examining the time-series for the
daily number and amount of transactions, we assumed that the period of one month is adequate to
study the stability and temporal change of the crypto ﬂow. Shorter period may lead to a trivial result
for the stability and could be insuﬃcient to detect the temporal change, if any change is present. Also
longer period would be misleading due to non-equilibrium nature of the system. The year 2019 was
chosen as the epoch, in which one does not see violent bubble or crush in the price.

The number of all the users is huge, 315 million users in total. Fortunately, however, it is not
necessary to include all of them, because most of them do not appear frequently. In the next section,
we shall extract only a tiny part of the network by focusing on the “regular users” who appeared
everyday during the speciﬁed period.

2.3 Regular Users as Big Players

For our purpose in this paper, it is suﬃcient to focus on the crypto ﬂow with high frequency and
big amount of Bitcoin, because infrequent and/or small amount of ﬂows is obviously unimportant
for the understanding the entire ﬂow. In other words, it suﬃces to focus on “big players” who are
playing some dominant role in the game of crypto ﬂow. It would be possible to deﬁne such a big
player in diﬀerent ways. In this study, we deﬁne it by looking at how persistently the user appears in
transactions during our speciﬁed period of time.

Fig. 4 depicts examples of users who appear in diﬀerent numbers of transactions on daily basis.
The user of the top case is persistent in committing transactions with other users, which can be labeled
as a “regular user”. The middle case changes the persistency from being inactive with no transaction
with anyone else to being active in an abrupt way. The bottom case has little activity, just a few
transactions on particular days having a strong intermittency.

We deﬁne regular users as those appearing everyday during the period of one year in 2019, and
use them as big players. The number of regular users was 479. Then we construct a subgraph in each
month, which is comprised of the regular users as nodes and the crypto ﬂow as links, the latter of
which are aggregated as described in Fig. 3. Thus we have 12 snapshots of such subgraphs, each

5

Fig. 4.
Illustrative examples for the activities of users. Each plot depicts the daily number of transactions,
in each of which the user is either source or destination of the transaction for the period of year 2019. Self-
loops (case of the same source and destination) are excluded. Top is a “regular” user appearing every day. The
middle user became active from being inactive, while the bottom one has intermittency in its activity. We focus
on regular users in this paper.

Fig. 5. Activities of regular users, deﬁned by each user’s peak of transactions, in UTC. Shaded region corre-
sponds to the daytime of Asia, Europe, and USA (left to right).

corresponding to each month in the year, from January to December. Summarizing the processing of
the whole dataset, we constructed the snapshots of networks denoted by Gt = (Vt, Et), where t is the
month, Vt is the set of regular users, Et is the set of links among them, each having the frequency and
amount as depicted in Fig. 3.

We add Fig. 5 showing the histogram for the UTC time of highest activities of all the regular

6

users in the year of 2019. This information gives geographical locations of those regular users.

3. Analysis of Crypto Flow Network

3.1 Basic Properties of Network

For each month t, we constructed a network denoted by Gt = (Vt, Et) as described in the preceding
section. Table I is the summary of basic properties of the networks in the year 2019. Vt corresponds
to the regular users in each month, the number of which is shown by the column |Vt|. The column
|Et| is the number of edges, namely the number of diﬀerent crypto ﬂow from one user to another or
to itself (self-loops as shown in parentheses). Most of the users have self-loops. Temporal change of
the network causes the changes of Vt and Et. The column of |Vt ∩ Vt+1| is the number of users that are
common to successive months in their appearance. One can see that most of the users are appearing
successively. The same is true for the edges as shown in the column of |Et ∩ Et+1|. In other words,
the network is not changing drastically in terms of the entry and exit of nodes and edges during the
time-scale of months.

Table I. Summary of basic properties of the networks in the year 2019, January to December.

t

01
02
03
04
05
06
07
08
09
10
11
12

|Vt|

470
470
473
473
472
471
472
468
470
469
470
466

|Et|

|Vt ∩ Vt+1|

|Et ∩ Et+1| GWCC GSCC/IN/OUT/TE

17,215(408)
16,658(407)
17,618(408)
17,691(415)
17,903(416)
17,787(412)
17,292(410)
16,534(402)
16,288(407)
16,317(402)
15,859(409)
15,584(390)

468
468
471
470
471
469
468
467
468
468
466
—

13,313
13,357
13,942
13,960
14,012
13,705
13,108
12,628
12,652
12,476
12,080
—

468(3)
468(3)
470(4)
469(5)
468(5)
467(5)
470(3)
466(3)
466(5)
467(3)
468(3)
466(1)

327/24/113/4
322/20/120/6
327/25/113/5
336/16/115/2
330/23/112/3
318/23/124/2
333/21/110/6
321/18/123/4
325/23/113/5
322/21/119/5
324/23/116/5
323/18/120/5

Each column represents the following.
t= month of the year 2019
|Vt|= number of nodes
|Et|= number of edges (number of self-loops in parentheses)
|Vt ∩ Vt+1|= number of nodes common to successive months
|Et ∩ Et+1|= number of edges common to successive months
GWCC= number of nodes in giant weakly connected component (number of components in parentheses)
GSCC/IN/OUT/TE= number of nodes in giant strongly connected component/IN/OUT/tendrills

We found that most of the users have self-loops, as shown in the parentheses of column |Et|,
with the frequencies fii and the amounts gii being highly correlated with the number of addresses
identiﬁed in the preceding Section 2.1 as naturally expected. Because our main interest in this paper
is the crypto ﬂow from one user to another, we remove all the self-loops in what follows.

Adjacent matrices with the strength of links given by the frequencies fi j of Gt for all t’s are
illustrated in Appendix B. One can see that the overall picture does not change in time, but the
illustration does not help to uncover the nature of connectivity and ﬂow.

To see the connectivity of network, namely how those regular users are linked among them and
also how they are located in the stream of cypto ﬂow, let us examine the property of connected com-

7

Fig. 6. Temporal change of bow-tie structure in an alluvial diagram. Monthly data of networks in the year
2019, January to December (from left to right). Vertical black segments in each month show the nodes of
corresponding network grouped into GSCC (giant strongly connected component), IN, OUT, and TE (tendrills)
in the bow-tie structure. Horizontal bands represent transitions among such groups from one month to its
successive one.

ponents. First, decompose Gt into weakly connected components (WCC), i.e. connected components
when regarded as an undirected graph. We found that there exists a giant WCC (GWCC) containing
most of the users. See the column GWCC of Table I. There was only a small number of disconnected
components as shown in the same column.

Then, in order to identify the location of users contained in the GWCC, we employed the well-
known analysis of “bow-tie” structure [23]. In general, GWCC can be decomposed into the following
parts:
GSCC Giant strongly connected component: the largest connected component when viewed as a
directed graph. One or more directed paths exist for an arbitrary pair of ﬁrms in the component.

IN The nodes from which the GSCC is reached via at least one directed path.
OUT The nodes that are reachable from the GSCC via at least one directed path.
TE “Tendrils”; the rest of the GWCC.

It follows that

GWCC = GSCC + IN + OUT + TE

(3)

GSCC is the core of the crypto ﬂow’s circulation. The IN and OUT parts are upstream and down-
stream of the ﬂow respectively. The users in the part of IN are playing a role of suppliers of crypto,
while the OUT users are considered to be consumers of crypto.

Table I shows the bow-tie structure in the column of GSCC/IN/OUT/TE. For example, in Septem-
ber, 470 users are located into GSCC (325 users), IN (23), OUT (113), and TE (5). One can observe
that a large fraction of the users in the GWCC is located in the GSCC, as one can easily interpret this
fact in the way that those regular users are circulating crypto globally. There are a less fraction of the
users in IN and OUT with asymmetry in the numbers.

It would be interesting to see how the individual users are located in the temporal change of the
network. Fig. 6 depicts such a diagram of temporal change from one month to its successive one in the
whole year. One can see that the groups of GSCC, IN, and OUT are very stable in each membership
of users. This fact means that those users appearing in successive months are playing stable roles in
the crypto ﬂow’s circulation and the location of upstream and downstream. We remark that analysis

8

of bow-tie structure is based on the binary links, namely either presence or absence among the nodes,
but not on the strength of links such as frequency and amount of crypto ﬂow. In the next section, we
shall see how to quantify the location of users by using the so-called Hodge decomposition.

3.2 Hodge Decomposition

Helmholtz-Hodge-Kodaira decomposition, or simply Hodge decomposition, is a combinatorial
method to decompose ﬂow on a network into circulation and gradient ﬂow. Original idea dates back
to the Helmholtz theorem in vector analysis, which states that under appropriate conditions any vector
ﬁeld can be uniquely represented by the sum of an irrotational or rotation-free (curl-free) vector ﬁeld
and a divergence-free (solenoidal) vector ﬁeld. The theorem can be generalized from Euclidean space
to graph and other entity as shown by Hodge, Kodaira and others. See [24–26] for readable exposition.
The method has a wide range of applications in the studies such as neural network [27], economic
networks [28, 29], and also our previous work on Bitcoin and [30].

We recapitulate the method brieﬂy for the present manuscript to be self-contained. Let Ai j denote

the adjacency matrix:

Ai j =

1 if there is a link of transfer from user i to j,

0 otherwise.



We excluded all the self-loops, implying that Aii = 0. Each link has a ﬂow, denoted by ˜Fi j, either of
the frequency, fi j, or the amount, gi j, of the transfer from i to j (see Fig. 3). Deﬁne

Note that there can be a pair of users such that Ai j = A ji = 1 and ˜Fi j, ˜F ji > 0.

˜Fi j =

fi j or gi j

0



if Ai j = 1,
otherwise.

Let us deﬁne a “net ﬂow” Fi j by

and a “net weight” wi j by

Fi j = ˜Fi j − ˜F ji

wi j = Ai j + A ji.

Note that wi j is symmetric, i.e., wi j = w ji, and non-negative, i.e., wi j ≥ 0 for any pair of i and j2.

Hodge decomposition is given by

Fi j = F(c)

i j + F(g)

i j

,

where the circular ﬂow F(c)

i j satisﬁes

F(c)
i j = 0 ,

Xj

which implies that the circular ﬂow is divergence-free. The gradient ﬂow F(g)

i j can be expressed as

F(g)
i j = wi j(φi − φ j) .

(10)

Thus the weight wi j serves to make the gradient ﬂow possible only where a link exists. We refer to
the quantity φi as the Hodge potential. Large value of φi implies that the user i is in the upstream of
the entire network, while small values implies i is in the downstream.

2It is remarked that (7) is simply a convention to consider the eﬀect of mutual links between i and j. One could multiply

(7) by 0.5 or an arbitrary positive number, which does not change the result signiﬁcantly for a large network.

9

(4)

(5)

(6)

(7)

(8)

(9)

 25

 20

y
c
n
e
u
q
e
r
F

 15

 10

 5

 0

GSCC
IN
OUT

-2

-1

 0
Hodge potential

 1

 2

Fig. 7. Distributions for Hodge potentials of the users in GSCC (black), IN (blue), and OUT (red). The
average of all the potential values is set to be zero (vertical dotted line). Data: 2019-09.

Combine (8), (9), and (10), one can derive the following equation to determine φi.

for i = 1, . . . , N. Here, Li j is the so-called graph Laplacian and deﬁned by

Li jφ j =

Fi j ,

Xj

Xj

Li j = δi j

wik − wi j ,

Xk

(11)

(12)

where δi j is the Kronecker delta.

It is easy to show that the matrix L = (Li j) has only one zero mode (eigenvector with zero
eigenvalue). The presence of this zero mode simply corresponds to the arbitrariness in the origin of φ.
All the other eigenvalues are positive (see, e.g., [30]). Therefore, (11) can be solved for the potentials
by ﬁxing the potentials’ origin. We assume that the average value of φ is zero.

Fig. 7 depicts the distributions for Hodge potentials of the users in GSCC, IN, and OUT. One can
see that the entire set of distributions is bimodal having two peaks at positive and negative values,
while there are a number of values around zero. Obviously, they correspond to IN, OUT, and GSCC,
each being located in the upstream, downstream, and core of the entire crypto ﬂow. Moreover, there
exists a correlation between the value of the Hodge potential and the net amount of demand or supply
of crypto by each user. See [30] for details, where we studied a daily snapshot of the network including
all the users, not only big players. We claim that the same property holds also for the monthly data
restricted to big players of regular users.

3.3 Non-negative Matrix Factorization

It would be a natural question whether there are distinctive ingredients of ﬂows in the crypto ﬂow
or not. The analysis of bow-tie structure is based merely on the binary relationship of links, so does
not give such information, because the crypto ﬂows from upstream to downstream with circulation in
the giant strongly connected component that occupies a large fraction of the entire network. In other

10

words, are there any “principal components” that constitute the entire ﬂow in a decomposition? In
order to ﬁnd such principal components or latent factors in the transfer of crypto among big players,
we shall apply non-negative matrix factorization (NMF) to the strength of links, namely the matrix of
the frequencies and amounts of transfer. We recapitulate the method here. See [31–33] and references
therein for introduction.

Let X be an N × M non-negative matrix, in general, to start with; that is, its elements are all

non-negative, denoted as X ≥ 0. NMF gives an approximation of X by a product of two matrices:

X ≈ S D ,

(13)

where S , D are N × K and K × M non-negative matrices, S , D ≥ 0, respectively3. In practice, one
expects that K is much smaller than N and M so that the factorization gives a compact representation
of X. We shall assume that N = M for our application of crypto ﬂow among N users in what follows.

Explicitly in components, (13) reads

K

Xsd ≈

S skDkd ,

Xk=1

(14)

where the indices s and d represent source and destination (s, d = 1, . . . , N) respectively, and Xsd is
the strength of crypto ﬂow, quantiﬁed by frequency fsd, amount gsd, or similar variables, from s to d
in a certain period of time. We choose

Xsd = fsd ,
in this paper. See Fig. B·1 in Appendix B for the illustration of Xsd. We would expect that K ≪ N,
because of the sparsity of X. How to determine K is discussed later.

(15)

The approximation in (13) is actually given by the following optimization:

min
S ,D≥0

F(X, S D) ,

where the function F(·, ·) is the so-called Kullback-Leibler (KL) divergence deﬁned by

F(A, B) = KL(AkB) ≡

Ai j log

Xi, j  

Ai j
Bi j

− Ai j + Bi j

.

!

(16)

(17)

Note that F(A, B) = 0 if and only if A = B. The reason why we choose the particular function of
(17) will be clariﬁed later4. Technically, one can solve (16) iteratively with the initialization of S , D
using non-negative double singular value decomposition (see the review [32] and references therein).
Although the iterative algorithm yields local minima, our numerical solutions under diﬀerent random
seeds gave essentially the same decomposition.

To understand the meaning of the decomposition, let us consider how a source distributes ﬂow to

diﬀerent destinations. For an arbitrary source s, (14) can be written as

K

Xs ≈

S skDk ,

Xk=1

(18)

where Xs is the vector of s-th row of X, and Dk is the vector of k-th row of D. Equation (18) means
that the ﬂow from the source s can be expanded in terms of “basis” vectors, Dk (k = 1, . . . , K). The

3The decomposition is not unique due to trivial degrees of freedom. One is permutation, S D = S ππ−1D, where π is
a permutation matrix simply exchanging indices. Another is scale transformation, S D = S σσ−1D, where σ is a diagonal
matrix with all elements positive. We shall see that these degrees are ﬁxed after appropriate normalization and ordering.

4See Section 3.4 for a probabilistic interpretation of choosing the KL divergence. Another functional form, often used,

is the so-called Frobenius norm: F(A, B) = (1/2)

i, j(Ai j − Bi j)2, which leads to a diﬀerent probabilistic model.

P

11

components (Dk)d = Dkd represent how destinations are distributed among users in the k-th NMF
component. It is convenient to normalize Dk by L1-norm, that is, by deﬁning

so that one has

Dkd
Dk

Dkd ≡

e

where Dk ≡

Dkd ,

Xd

Dkd = 1 ,

Xd
for all k. With respect to this normalized basis vectors, the expansion in (18) is rewritten as

e

K

Xs ≈

(S skDk)

Dk where

Dk)d =
(

Dkd ,

(19)

(20)

(21)

Xk=1

e

e

e

Thus the outgoing ﬂow from the source s is approximately expressed by a linear combination of K
normalized basis vectors

Dk with coeﬃcients given by S skDk.

Similarly, consider how a destination d collects ﬂow from diﬀerent sources. For an arbitrary

destination d, (14) reads

e

K

Xd ≈

DkdSk ,

(22)

Xk=1
where Xd is the vector of d-th column of X, and Sk is the vector of k-th column of S . The components
of (Sk)s = S sk represent how sources are distributed among users in this k-th NMF component. Deﬁne

S sk
S k

S sk ≡

e

where

S k ≡

S sk ,

Xs

and one has

for all k. Then (22) is rewritten as

S sk = 1 ,

Xs

e

K

Xd ≈

(DkdS k)

Sk where

Sk)s =
(

S sk .

(23)

(24)

(25)

Xk=1

e

e

e

Thus the incoming ﬂow to the destination d is approximately expressed by a linear combination of K
normalized basis vectors

Sk with coeﬃcients given by DkdS k.

How can one determine K? Obviously, the larger K is, the better the approximation (13) is, but
with less parsimonious representation of the data. In the next section, let us make a detour to examine
this issue from a diﬀerent perspective.

e

3.4 NMF as a probabilistic model

We can interpret the NMF as a probabilistic model. Denote the right-hand of (14) by

ξsd ≡

S skDkd ,

Xk

(26)

which are regarded as parameters to be estimated from the data X such that Xsd is assumed to be a
random number chosen from a Poisson distribution with the parameter ξsd as

P(x | ξ) = e−ξ ξx
x!

.

12

(27)

It is easy to see that the log likelihood function L(ξsd) ≡ log P(Xsd | ξsd) takes the maximum value at
ξsd = Xsd. Then one can introduce a quantity to measure how much the estimation of the parameters
is good, that is

(L(Xsd) − L(ξsd)) =

Xs,d

Xsd log

Xs,d  

Xsd
ξsd

− Xsd + ξsd

,

!

(28)

to be minimized. One can see that this quantity is equivalent to the KL divergence in (17)5.

To express the entire framework in probabilistic terms more explicitly, let us normalize the data

X in (15) by

Then let us rewrite (14) as

Xsd =

P

e
Xsd ≈

Xsd
s′,d′ Xs′d′

.

rk

S sk

Dkd ,

where

Dkd and

e
S sk were given by (19) and (23) respectively, and

e

e

Xk

e

e

rk ≡

S kDk
k′ S k′ Dk′

,

which satisﬁes that

P
k rk = 1. Let us denote the right-hand side of (30) by

P

psd ≡

rk

S sk

Dkd ,

(29)

(30)

(31)

(32)

Xk

e

e

s,d psd = 1. We remark that the normalized weight rk deﬁned by (31) gives
which satisﬁes that
the information of relative importance of the k-th NMF component in the expansion with normalized
basis vectors in (32). One can determine the ordering of NMF components uniquely according to the
magnitudes of rk.

P

Suppose that there are N f transfers in total during a period of time. For each pair of source and
destination, s and d, generate a transfer s → d with the probability given by psd, being independently
of other pairs. Under the assumption of a small probability of psd and a large number of N f , Xsd
follows a Poisson distribution with the parameter, ξsd = N f psd.

It turns out that the decomposition in (26), or equivalently (32), has an interesting connection
with machine learning. In natural language processing, it is often necessary to extract topics among
documents comprising of words or terms. In a situation of unsupervised learning, the task is to infer
topics as hidden or latent variables, which can explain a collection of documents, each being an
unordered set of terms. Probabilistic latent semantic analysis (PLSA) is a probabilistic model for
doing such a task [36]. Suppose that there are N documents and M terms. Then the occurrence of
terms can be expressed by a document-term matrix X with size N × M, each element of which is the
frequency of occurrence of a term in a document. Topics are latent variables to explain the data X. A
topic is actually a probability distribution for the occurrence of terms with diﬀerent probabilities. A
document can have a mixture of topics. An example is a document on “inﬂuence of hosting Olympics
to economy” with a mixture of topics on sports and economy.

One of the widely used model of PLSA is latent Dirichlet allocation (LDA). See Appendix C and
references therein. For our purpose, it suﬃces to understand how terms are generated at locations of
documents in a probabilistic way. The probability that a term is chosen at a location in a document is
given by the sum of K factors, each of which is the product of two probabilities; the probability that

5We became aware that this argument is known in the literature. If one assumes Gaussian instead of Poisson, one would
have Frobenius norm for KL divergence in (17). See [34]. One of the present authors (YF) learned a hint on the argument
from Itsuki Noda in his application of NMF to transportation data [35].

13

i

i

)
d
e
z
m
n
m
e
b

i

o
t
(

e
r
u
s
a
e
M

 1

 0.8

 0.6

 0.4

 0.2

 0

 0

 10

CaoJuan (2009)
Arun (2010)
Deveaud (2014)

 20
 30
#Components

 40

 50

)
s
t
i
n
u

y
a
r
t
i
b
r
a

n
i
(

e
r
o
c
s
A
D
L

 45

 40

 35

 30

 25

 20

 15

 10

 5

 0

99% interval
avgerage (20 simulations)

 0

 10

 20
 30
#Components

 40

 50

(a) Comparison of three methods [38–40]

(b) Monte Carlo simulations by the method [39]

Fig. 8. Determining K, the number of NMF components, by using the concept of coherence in LDA. (a) Dif-
ferent methods [38–40] are compared. Each measure of coherence is drawn in the vertical axis so that it is to
be minimized to ﬁnd the optimal number of components. Maximum and minimum values in the region of K
are scaled to 1 and 0 respectively to make the comparison easier. One can see that K = 11 ∼ 13 are optimal.
(b) Monte Carlo simulations by the method [39] with 20 runs for each K. Averages (points) and 99% level
(gray band, narrow) calculated from standard errors are drawn. We conclude that K = 13 is optimal from this
result (b).

a topic is selected in the document and the one that the term is chosen under the selected topic. See
the equation of (C·11) in Appendix C. One can immediately see that (C·11) is essentially the same
as (26), or equivalently (32).

Thus the matrix decomposition of NMF can be put in the framework of probabilistic model of
PLSA and LDA. As a bonus, one can adopt the method of estimating the number of topics to our
problem of determining the number of NMF components, denoted by K in both cases. Interested
readers are guided to look at the literature [37–40] and others given at the end of Appendix C. Let us
take a look at our results in the next section ﬁnishing the detour of this section.

3.5 Result of NMF for Crypto Flow

We ﬁrst show a few results for a snapshot of September in the year 2019 (denoted as 2019-
09), in order to verify if the idea in the preceding section works to determine the number of NMF
components. Fig. 8 shows the measures of coherence by employing three diﬀerent methods of LDA
[38–40]. The methods give mostly the same optimal values of K, namely K = 11 ∼ 13, consistently
as shown in Fig. 8 (a). We found that the measure given in [39] is relatively stable and potentially
useful to determine a speciﬁc value of K. So we performed Monte Carlo simulations in Fig. 8 (b), and
were able to determine the optimal value as K = 13. For this data, X has the dimension of N = 470,
so we conclude that one can have a small number of NMF components that can explain the entire
ﬂow among those regular users.

In Appendix D, we summarize the same result for the data in all the other months of the year
2019. We found that the optimal number K is quite small in the range more than 10 and less than 20,
much smaller than the number of users, N ∼ 500 (see Table I). Additionally, K is relatively stable
irrespectively of the temporal change. See Table D·1 and Fig. D·1.

Let us examine each NMF components obtained with the optimal value of K. Fig. 9 and Fig. 10
Sk, respectively for k = 1, . . . , K.
show the NMF components in terms of the basis vectors,
Dk)d = Dkd meaning how destinations are
In Fig. 9, each plot shows the vector components of (
distributed among users d in the k-th NMF component. Similarly in Fig. 10, each plot shows the

Dk and

e

e

e

14

 
 
 
 
 
 
 
Sk)s = S sk meaning how sources are distributed among users s in the k-
vector components of (
th NMF component. See (19) and (23), and also note the normalization therein. Note that in each of
Fig. 9 and Fig. 10, the plots are ordered (from top to bottom) in the descending order of the probability
rk given in (31).

e

One can immediately notice from the ﬁgures that the components of these basis vectors are con-
centrated on a limited number of users, but are not distributed among many users. To quantify the
eﬀective number of the concentration, let us use the inverse Herﬁndahl-Hirschman index, abbrevi-
ated as IHH, which is deﬁned as follows. Consider “shares” xi ≥ 0 among i = 1, . . . , N things with
the sum equal to 1, i.e.

i xi = 1. The IHH is deﬁned by

P

N

−1

IHH ≡



x2
i 

.

(33)

Xi=1
When the shares are equal, xi = 1/N for all i, then IHH = N. On the other hand, when there is the
strongest concentration, namely, xi = 1 for a particular i and xi = 0 otherwise, then IHH = 1. So
IHH can give an estimate of the eﬀective number of large shares6. The idea can be applied to the
basis vectors, because the vectors are normalized in the same way as shares. In Fig. 9 and Fig. 10, we
displayed all the calculated IHH’s. One can see that the IHH’s are quite small ranging from a few to
a dozen or so, compared with the total number of users N = 470 for the data 2019-09 (see Table I).





How can we use the NMF components to understand the crypto ﬂow? Choose a particular user s
as a source s. The ﬂow from s was approximately expressed by a linear combination of K normalized
Dk, each depicted in Fig. 9, with the coeﬃcients given in (21), i.e. S skDk. The coeﬃ-
basis vectors
cients represent the strength of the decomposed ﬂow from the source s. A similar argument holds by
choosing a particular user d as a destination. The ﬂow to d was expressed by a linear combination in
(25) with the coeﬃcients, DkdS k.

e

For example, consider the user with ID 0000000000 that is located in the GSCC, as a source s.
Fig. 11 shows the coeﬃcients corresponding to K components; see (a). One can see that the coeﬃ-
cients are non-zero at only four components. Such a sparseness tells that the ﬂow from this user can
be expressed with a few components. And the corresponding components have non-zero values at a
small number (recall the IHH’s) of the vector components, Dkd, as shown in Fig. 9, implying that the
users corresponding to these non-zero components constitute a cluster for the outgoing ﬂow from the
source s.

The same user 0000000000 can be regarded as a destination d in the GSCC. Fig. 11 (b) shows
the coeﬃcients, again non-zeros at only one or two components. Together with Fig. 10, one can
ﬁnd another cluster composed of a small number of users for the incoming ﬂow to the d. Similar
arguments hold for the users 0000006178 and 0000000012, respectively located in the IN and OUT.
See Fig. 11 (c) and (d). In this way, one can ﬁnd clusters for either of or both of the outgoing and
incoming ﬂows of each user.

Each NMF component can be represented by a matrix, because the non-negative matrix of Xsd
or its probabilistic counter part psd can be expressed by (18) or (32). It is possible to depict each
component k by the matrix of
Dkd in the normalized way. Fig. 12 and Fig. 13 illustrate such
matrices for the data of 2019-09. This should be compared with Xsd in Appendix B. One can see that
the NMF components provide sparse matrices.

S sk

e

e

Finally, we ﬁnd that the NMF components are relatively stable in the temporal change of network.
Fig. 14 (a) shows the result for cosine similarities of the NMF basis vectors Dk for the two successive
months of 2019-09 and 2019-10. Fig. 14 (b) shows the result for Sk for the same data. In either of
these results, one can see that the NMF components are quite similar except only a few permutation
of indices.

6It is remarked that the paper [20] in this volume also applied but modiﬁes Herﬁndahl-Hirschman index in an interesting

way to characterize the frequencies of transactions in XRP.

15

 0

 100

 200

 300

 400

Destination (user index)

 0.25

 0

 0

 0.25

 0

 0.25

 0

 0.25

 0

 0

 0

 0.75

 0.5

 0.25

 0

 0.25

 0

 0.25

 0

 0

 0.25

 0
 1
 0.75
 0.5
 0.25
 0

k= 1: Prob=27.3%, IHH= 5

k= 2: Prob=13.8%, IHH=35

k= 3: Prob= 9.3%, IHH=10

k= 4: Prob= 8.9%, IHH= 9

k= 5: Prob= 7.6%, IHH= 8

k= 6: Prob= 6.7%, IHH=16

k= 7: Prob= 6.2%, IHH=15

k= 8: Prob= 5.2%, IHH= 2

k= 9: Prob= 4.4%, IHH= 3

k=10: Prob= 3.6%, IHH= 5

k=11: Prob= 3.1%, IHH=12

k=12: Prob= 2.8%, IHH= 6

k=13: Prob= 1.2%, IHH= 2

 0

 100

 200

 300

 400

Dk (k = 1, . . . , 13) from top to bottom. Each plot (

Dk)d = Dkd shows how desti-
Fig. 9. NMF components
d Dkd = 1
nations are distributed among users d in the k-th NMF component. Note that
for all k. See (19) and (20) in the main text. Also shown in each plot are the probability of the component,
denoted by “Prob”, and the inverse Herﬁndahl-Hirschman index “IHH” representing the eﬀective number of
dominant users in the component. Data: 2019-09.

Dk is normalized, i.e.

P

e

e

e

16

 0

 100

 200

 300

 400

Source (user index)

 0.5

 0.25

 0

 0.25

 0

 0.5

 0.25

 0

 0.25

 0

 0.5

 0.25

 0

 0.25

 0

 0.25

 0

 0.5

 0.25

 0
 1
 0.75
 0.5
 0.25
 0
 0.5

 0.25

 0

 0.25

 0

 0.25

 0
 1
 0.75
 0.5
 0.25
 0

k= 1: Prob=27.3%, IHH= 4

k= 2: Prob=13.8%, IHH= 9

k= 3: Prob= 9.3%, IHH= 3

k= 4: Prob= 8.9%, IHH= 8

k= 5: Prob= 7.6%, IHH= 3

k= 6: Prob= 6.7%, IHH= 5

k= 7: Prob= 6.2%, IHH= 5

k= 8: Prob= 5.2%, IHH= 4

k= 9: Prob= 4.4%, IHH= 2

k=10: Prob= 3.6%, IHH= 4

k=11: Prob= 3.1%, IHH= 6

k=12: Prob= 2.8%, IHH= 5

k=13: Prob= 1.2%, IHH= 2

 0

 100

 200

 300

 400

Sk)s = S sk shows how sources
Fig. 10. NMF components
s S sk = 1 for all k.
are distributed among users s in the k-th NMF component. Note that
See (23) and (24) in the main text. See the caption of Fig. 9 for “Prob” and “IHH” in each plot. Data: 2019-09.

Sk (k = 1, . . . , 13) from top to bottom. Each plot (

Sk is normalized, i.e.

e

e

P

e

17

.
(cid:1)
e
o
C

1

.5

0
1

.
(cid:1)
e
o
C

.5

0
1

.
(cid:1)
e
o
C

.5

0
1

.5

0

.
(cid:1)
e
o
C

(a) For a souce in GSCC

(b) For a destination in GSCC

(c) For a souce in IN

(d) For a destination in OUT

 1

 2

 3

 4

 5

 6

 7
Component k

 8

 9

 10

 11

 12

 13

Fig. 11. Coeﬃcients, with which crypto ﬂow from or to a selected user is expanded with respect to the NMF
components. The selected users are 0000000000 (a,b) included in the GSCC of bow-tie structure, 0000006178
(c) in the IN, and 0000000012 (d) in the OUT. The user 0000000000 can be source (a) and destination (b).
The user of (c) is a source, and the user of (d) is a destination. The expansion is given by (21) for the selected
source s, and by (25) for the selected destination d. Data: 2019-09.

18

Fig. 12. NMF components k = 1, . . . , 8 as matrices deﬁned by

S sk

Dkd in (32). Data: 2019-09.

e

e

19

Fig. 13.

(Continued) NMF components k = 9, . . . , 13 as matrices deﬁned by

S sk

Dkd in (32). Data: 2019-09.

e

e

20

(a) Cosine similarity of NMF basis vectors Dk

(b) Cosine similarity of NMF basis vectors Sk

Fig. 14. Temporal change of the NMF components from one month t to its successive month t +1. (a) Cosine
similarities calculated for all the pairs of Dk (k = 1, . . . , 13) between t (vertical) and t + 1. (b) The same for
all the pairs of Sk. For the vertical and horizontal axes in (a) and (b), the order of indices along vertical and
horizontal axes corresponds to the descending order of the probability rk in (31). Data: 2019-09 and 2019-10.

21

4. Discussions

Let us brieﬂy discuss about several aspects that would be worth further investigation.
First, while we succeeded to extract the NMF components and found that the components have
non-zero values only at a relatively small number of users, we still did not identify those users by
exploiting the fact. It is quite likely the case that the extracted users must play important roles in each
of the NMF components, either of key destinations or key sources. We attempted to identify a tiny
fraction of such users by matching the list of such users with the identity given in Appendix A, but the
identiﬁcation was not suﬃcient in order to interpret the meaning of corresponding NMF components.
Instead, such intra-day activities as shown in Fig. 2 of Section 2.1 could give us the geographical
locations of those key users, possibly uncovering the crypto ﬂow in each NMF component at a global
scale. This issue remains to be investigated.

Second, even if the temporal change of the network in terms of the NMF components has such a
stable structure as found in Fig. 14, we noticed that there exists interesting change of a few compo-
nents in the same ﬁgure. A keen reader may have noticed that the components k = 3, 4, 5, 6 at time
t are changed into among themselves at time t + 1, while the cosine similarities are close to 1. This
means that the probabilities rk for those components were changed from one month to the next. Also
one can notice that the optimal number of NMF components showed a slow variation during the pe-
riod (recall Table D·1 of Appendix D). These facts might give us a hint for how to treat the temporal
change of network by paying attention to those slowing varying aspects. Additionally, while we fo-
cused only on regular users appearing everyday during the period under study, it would be necessary
to include the process of entry and exit of big players.

Third, technically, we regarded the method of NMF as a probabilistic model that shares the same
stochastic process as in the probabilistic latent semantic analysis (PLSA). As a bonus, we were able
to employ the latent Dirichlet allocation (LDA) and its known methods to estimate the number of
topics in the context of topic model, or the number of NMF components in out context. In principle,
one could start with the full-ﬂedged Bayesian framework in the LDA and its extension and variations.
It would be worth pursuing in this direction, which is also related to the second point above, because
there are several studies on how to treat temporally changing topics of documents in a long time-span.
Fourth, our methods in this paper can be easily applied to diﬀerent cryptoassets including Ethereum
and XRP. We are aware of the paper [20] in this volume, which is in a similar line of study. It would
be interesting to apply our methods to the data of XRP.

Finally, it would be an extremely interesting problem how the crypto ﬂow among big players is
related to the prices in the exchange markets with ﬁat currencies and also with other cryptoassets. It
is quite likely that the bubble/crash and their precursors might force the big players to react during
such turmoils in a diﬀerent way from tranquil periods. For example, exchanges need to reallocate
cryptoassets in the necessity of making a reservoir or doing a release of cryptoassets under the risk.

5. Summary

Our purpose in this study on the cryptoasset of Bitcoin is to understand the structure and tem-
poral change of crypto ﬂow among big players. We compiled all the transactions contained in the
blockchain of Bitcoin cryptoasset from its genesis to the year 2020, identiﬁed users from anonymous
addresses, and constructed snapshots of networks comprising of users as nodes and links as crypto
ﬂow among the users. While the whole network is huge, we extracted sub-networks by focusing on
regular users who appeared persistently during a certain period. Speciﬁcally, we extracted monthly
snapshots during the year of 2019, and selected roughly 500 regular users.

We ﬁrst analyzed the bow-tie structure from the binary relationship of ﬂow, and then performed
the Hodge decomposition based on the strength of ﬂow deﬁned by frequencies and amounts, in order

22

to locate users in the upstream, downstream, and core of the entire crypto ﬂow. We found that the
bow-tie structure is stable during the period, implying that those regular users have diﬀerent roles in
the crypto ﬂow.

Then, to reveal important ingredients hidden in the ﬂow, we employ the method of non-negative
matrix factorization (NMF) to extract a set of principal components. We discussed that the NMF
method can be regarded as a probabilistic model, which is equivalent to a probabilistic latent semantic
analysis and its typical model of latent Dirichlet allocation. This observation brought us a method to
estimate an optimal number of NMF components, which turned out to be a dozen or so. We found
that the NMF components have non-zero values corresponding to a limited number of users, telling
us their roles of destinations or sources of the crypto ﬂow. Additionally, we found that the NMF
components are quite stable in the temporal change for the time-scale of months.

There remain several points including the further investigation on the users contained in those
NMF components, a treatment of temporally changing network, and technically interesting issues to
be pursued in the future.

Acknowledgment

We would like to thank Hideaki Aoyama, Yuichi Ikeda, and Hiwon Yoon for discussions, Hiroshi
Iyetomi for solving a technical issue of Hodge decomposition, Itsuki Noda for clarifying his applica-
tion of NMF on transportation data, Takeaki Uno for an eﬃcient algorithm to identify users, Shinya
Kawata and Wajun Kawai for technical assistance. This work is supported by JSPS KAKENHI Grant
Numbers, 19K22032 and 20H02391, by the Nomura Foundation (Grants for Social Science), and
also by Kyoto University and Ripple’s collaboration scheme.

References

[1] F. Reid and M. Harrigan. An analysis of anonymity in the bitcoin system. In Y. Altshuler, Y. Elovici, A.
Cremers, N. Aharony, and A. Pentland, editors, Security and Privacy in Social Networks, pages 197–223.
Springer, New York, 2013.

[2] M. Ober, S. Katzenbeisser, and K. Hamacher. Structure and anonymity of the bitcoin transaction graph.

Future Internet, 5(2):237–250, 2013.

[3] D. Ron and A. Shamir. Quantitative analysis of the full bitcoin transaction graph. In Financial Cryptog-

raphy and Data Security, 2013.

[4] D. Kondor, M. P´osfai, I. Csabai, and G. Vattay. Do the rich get richer? an empirical analysis of the bitcoin

transaction network. PLoS ONE, 9(2):e86197, 2014.

[5] D. Kondor, I. Csabai, S. J., M. P´osfai, and G. Vattay. Inferring the interplay between network structure

and market eﬀects in bitcoin. New Journal of Physics, 16(12):125003, 2014.

[6] B. Alvarez-Pereira, M. A. Ayres, A. M. G. L´opez, S. Gorsky, S. W. Hayes, Z. Qiao, and J. Santana. Network
and conversation analyses of bitcoin. In 2014 Complex Systems Summer School Proceedings, 2014.
[7] A. Baumann, B. Fabian, and M. Lischke. Exploring the bitcoin network. In Proceedings of the 10th
International Conference on Web Information Systems and Technologies – Volume 2: WEBIST, 2014.
[8] M. Fleder, M. S. Kester, and S. Pillai. Bitcoin transaction graph analysis. http://arxiv.org/abs/

1502.01657, 2015.

[9] D. Maesa, A. Marino, and L. Ricci. Uncovering the bitcoin blockchain: An analysis of the full users
graph. In Conference: 2016 IEEE International Conference on Data Science and Advanced Analytics
(DSAA), 2016.

[10] M. Lischke and B. Fabian. Analyzing the bitcoin network: The ﬁrst four years. Future Internet, 8(1):7,

2016.

[11] C. G. Akcora, Y. R. Gel, and M. Kantarcioglu. Blockchain: A graph primer. http://arxiv.org/abs/

1708.08749, 2017.

[12] M. Bartoletti, A. Bracciali, S. Lande, and L. Pompianu. A general framework for bitcoin analytics. http:

//arxiv.org/abs/1707.01021, 2017.

23

[13] C. Cachin, A. D. Caro, P. Moreno-Sanchez, B. Tackmann, and M. Vukoli´c. The transaction graph for

modeling blockchain semantics. https://eprint.iacr.org/2017/1070, 2017.

[14] R. Cazabet, B. Rym, and M. Latapy. Tracking bitcoin users activity using community detection on a

network of weak signals. http://arxiv.org/abs/1710.08158, 2017.

[15] D. Maesa, A. Marino, and L. Ricci. Data-driven analysis of bitcoin properties: exploiting the users graph.

International Journal of Data Science and Analytics, 2017.

[16] S. Ranshous, C. Joslyn, S. Kreyling, K. Nowak, N. F. Samatova, C. L. West, and S. Winters. Exchange
pattern mining in the bitcoin transaction directed hypergraph. In Financial Cryptography Workshops,
2017.

[17] A. M. Antonopoulos. Mastering Bitcoin: Programming the Open Blockchain. O’Reilly Media, 2 edition,

2017.

[18] Hungary research group: Elte bitcoin project.

http://www.vo.elte.hu/bitcoin/; https://

senseable2015-6.mit.edu/bitcoin/. Accessed: 2020-01-03.

[19] Bitcoin block explorer with address grouping and wallet labeling. https://www.walletexplorer.

com. Accessed: 2021-03-18.

[20] H. Aoyama. Xrp network and proposal of ﬂow index; see it in this volume., 2021.
[21] R. Islam, Y. Fujiwara, S. Kawata, and H. Yoon. Analyzing outliers activity from the time-series transaction

pattern of bitcoin blockchain. Evolutionary and Institutional Economics Review, 16(1):239–257, 2019.

[22] R. Islam, Y. Fujiwara, S. Kawata, and H. Yoon. Unfolding identity of ﬁnancial institutions in bitcoin

blockchain by weekly pattern of network ﬂows. in preparation, 2020.

[23] A. Broder, R. Kumar, F. Maghoul, P. Raghavan, S. Rajagopalan, R. Stata, A. Tomkins, and J. Wiener.

Graph structure in the Web. Computer Networks, 33(1-6):309–320, 2000.

[24] X. Jiang, L.-H. Lim, Y. Yao, and Y. Ye. Learning to rank with combinatorial hodge theory. available

online, 2008. accessed in January, 2020.

[25] X. Jiang, L.-H. Lim, Y. Yao, and Y. Ye. Statistical ranking and combinatorial hodge theory. Mathematical

Programming, 127(1):203–244, 2011.

[26] J. L. Johnson. Discrete hodge theory on graphs: a tutorial. Computing in Science & Engineering, 15(5):42–

55, 2013.

[27] K. Miura and T. Aoki. Scaling of hodge-kodaira decomposition distinguishes learning rules of neural

networks. IFAC-PapersOnLine, 48(18):175–180, 2015.

[28] Y. Kichikawa, H. Iyetomi, T. Iino, and H. Inoue. Hierarchical and circular ﬂow structure of interﬁrm

transaction networks in japan. https://ssrn.com/abstract=3173955, 2018. May 4, 2018.

[29] Y. Fujiwara, H. Inoue, T. Yamaguchi, H. Aoyama, T. Tanaka, and K. Kikuchi. Money ﬂow network among

ﬁrms’ accounts in a regional bank of japan. EPJ Data Science, 10:19, 2021.

[30] F. Y. and I. R. Advanced Studies of Financial Technologies and Cryptocurrency Markets, chapter Hodge

Decomposition of Bitcoin Money Flow. Springer, Singapore, 2020.

[31] D. D. Lee and H. S. Seung. Learning the parts of objects by non-negative matrix factorization. Nature,

401(6755):788–791, 1999.

[32] M. W. Berry, M. Browne, A. N. Langville, V. P. Pauca, and R. J. Plemmons. Algorithms and applications
for approximate nonnegative matrix factorization. Computational Statistics & Data Analysis, 52(1):155–
173, 2007.

[33] R. Gaujoux and C. Seoighe. A ﬂexible r package for nonnegative matrix factorization. BMC Bioinfor-

matics, 11:367, 2010.

[34] H. Kameoka. Non-negative matrix factorization and its variants with applications to audio signal pro-

cessing. Journal of the Japan Statistical Society, 44(2):383–407, 2015. Japanese.

[35] I. Noda and J. Ochiai. Analysis of od data of ondemand transportation by non-negative matrix factoriza-

tion. 2019. Technical report in the workshop of SIG-DOCMAS, Japanese.

[36] T. Hofmann. Unsupervised learning by probabilistic latent semantic analysis. Machine Learning, 42:177–

196, 2001.

[37] T. L. Griﬃths and M. Steyvers. Finding scientiﬁc topics. Proceedings of the National Academy of Sci-

ences, 101:5228–5235, 2004.

[38] J. Cao, T. Xia, J. Li, Y. Zhang, and S. Tang. A density-based method for adaptive lda model selection.

Neurocomputing, 72(7):1775–1781, 2009.

24

[39] R. Arun, V. Suresh, C. E. Veni Madhavan, and M. N. Narasimha Murthy. On ﬁnding the natural number
of topics with latent dirichlet allocation: Some observations. In M. J. Zaki, J. X. Yu, B. Ravindran, and
V. Pudi, editors, Advances in Knowledge Discovery and Data Mining, pages 391–402. Springer Berlin
Heidelberg, 2010.

[40] R. Deveaud, E. SanJuan, and P. Bellot. Accurate and eﬀective latent concept modeling for ad hoc infor-

mation retrieval. Document Num´erique, 17(1):61–84, 2014.

[41] D. M. Blei, A. Y. Ng, and M. I. Jordan. Latent dirichlet allocation. Journal of Machine Learning Research,

3:993–1022, 2003.

[42] D. M. Blei and J. D. Laﬀerty. Text Mining: Classiﬁcation, Clustering, and Applications, chapter Topic

Models, pages 71–94. CRC Press, 2009.

[43] Gr¨un, Bettina and Hornik, Kurt.

topicmodels: An R Package for Fitting Topic Models. Journal of

Statistical Software, 40(13):1–30, 2011.

[44] Y. W. Teh, M. I. Jordan, M. J. Beal, and D. M. Blei. Hierarchical dirichlet processes. Journal of the

American Statistical Association, 101(476):1–30, 2006.

25

Appendix A:

Identity of Users of Type A

WalletExplorer.com [19] is a web site providing information about identity of addresses in
Bitcoin blockchain. The site merges addresses together, if they are part of the same wallet, and also
identiﬁes wallets with actual names. According to the site, the method to merge addresses is:

Just a basic algorithm is used to determine wallet addresses. Addresses are merged to-
gether, if they are co-spent in one transaction. So if addresses A and B are co-spent in
transaction T1, and addresses B and C are co-spent in transaction T2, all addresses A, B
and C will be part of one wallet.
Sometimes, an address belongs to some service but it was never co-spent with others. Then
that address stays unnamed. It is typically more often at addresses with higher amount (as
there is no need to co-spending).

This method is precisely the same as [1], which is the one we employed in Section 2.1. In addition,
the identiﬁcation of actual names is done by WalletExplorer.com as follows:

In most of the cases, I registered to service, made transaction(s) and saw which wallet
bitcoins were merged with, or from which wallet it was withdrawn.
There is probably no easier way how to discover names other than this.
Please note that the name database is not updated, so it does not contain newer exchanges
(or newer wallets of existing exchanges).

We matched our data with the one in [19] to obtain the identity and additional attributes of users
of type A (see Section 2.1 for the type). Table A·1 is the classiﬁcation into exchanges, services,
gambling, historic, and mining pools. Table A·2 shows the list of countries that exchanges belong to.
Table A·3 is the complete list of this matching.

Table A·1. Classiﬁcation of identiﬁed users (compiled from [19])

Classiﬁcation

#Users Examples

Exchanges
Old/Historic
Services/Others
Gambling
Pools

84
83
45
41
11

Bittrex.com, Huobi.com, Bit-x.com, HitBtc.com
AgoraMarket, EvolutionMarket, SilkRoadMarketplace
Xapo.com, ePay.info, Cubits.com
999Dice.com, CoinGaming.io, SatoshiMines.com
BTCCPool, SlushPool.com, BitMinter.com

Total

264 —

Table A·2. Countries of identiﬁed exchanges (compiled from [19])

Country

#Users

Country

#Users

Country

#Users

China
UK
USA
Canada
Australia
Brazil
Singapore
Russia
Denmark
Finland

14
13
13
4
3
3
3
3
2
2

2
2
2
2
2
1
1
1
1
1

Mexico
Netherlands
Poland
Portugal
South Africa
Austria
Belize
Croatia
Czech
Germany

26

Iran
Korea
Luxembourg
Malta
Panama
Taiwan
Thailand
Vanuatu
Vietnam

Total

1
1
1
1
1
1
1
1
1

84

Table A·3.: Identity of Users (compiled from [19])

Deﬁnitions

No: sequential number
User ID: an arbitrarily but uniquely assigned IDs to each user in our data
#Addr. (1): number of addresses identiﬁed to each User ID in our data (rows are sorted by this column)
#Addr. (2): the same as (1) but provided by WalletExplorer.com (at the timing of writing)

No.

User ID

#Addr. (1)

#Addr. (2)

Name

Category

Country

1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57

0000000000
0000000000
0000000001
0000000002
0000000002
0000000002
0000000002
0000000002
0000000002
0000000006
0000000010
0000000010
0000000011
0000000012
0000000014
0000000017
0000000017
0000000018
0000000022
0000000022
0000000025
0000000028
0000000030
0000000035
0000000037
0000000038
0000000041
0000000042
0000000043
0000000045
0000000049
0000000054
0000000055
0000000057
0000000060
0000000061
0000000063
0000000069
0000000071
0000000075
0000000077
0000000079
0000000082
0000000083
0000000086
0000000090
0000000093
0000000101
0000000107
0000000114
0000000116
0000000120
0000000135
0000000158
0000000159
0000000159
0000000169

18,913,420
18,913,420
13,110,033
5,302,867
5,302,867
5,302,867
5,302,867
5,302,867
5,302,867
2,180,236
1,630,483
1,630,483
1,538,476
1,413,904
1,043,379
992,726
992,726
988,300
912,950
912,950
845,559
811,809
778,990
682,176
659,820
631,985
581,525
546,515
523,330
498,001
478,476
420,632
412,338
398,349
377,140
372,753
350,036
341,160
325,365
307,489
294,238
278,973
266,695
263,074
250,920
241,250
238,480
206,542
197,164
189,776
187,189
186,000
168,885
146,381
145,978
145,978
140,594

1
1
12,469,250
1
1
1
1
1
487,776
1,488,034
1
957,652
1,377,461
1
279,697
1
1
940,605
133,020
770,486
1
2
651,547
1
656,699
1
1
291,443
522,056
498,001
343,039
420,632
249,883
1
305,518
372,753
350,036
61,103
1
307,451
1
2
254,601
262,940
191,689
223,781
238,476
156,203
197,155
189,776
187,086
186,000
1
146,381
1
1
1

Bit-x.com
Xapo.com
ePay.info
Cryptopay.me
Cubits.com
Luno.com
VirWoX.com
Xapo.com
CoinPayments.net
Xapo.com
Huobi.com
Cubits.com
Bittrex.com
Bitstamp.net
Huobi.com
VirWoX.com
Xapo.com
Poloniex.com
AnxPro.com
CoinTrader.net
Cubits.com
Cubits.com
999Dice.com
MoonBit.co.in
CoinGaming.io
Luno.com
Cubits.com
Luno.com
LocalBitcoins.com
AgoraMarket
Bitstamp.net
EvolutionMarket
Cryptonator.com
Xapo.com
Cryptopay.me
SilkRoadMarketplace
SilkRoad2Market
MercadoBitcoin.com.br
Xapo.com
BTC-e.com
Xapo.com
Cubits.com
SatoshiMines.com
YoBit.net
Bitcoin.de
BitcoinFog
Cex.io
CoinJar.com
NitrogenSports.eu
AlphaBayMarket
HitBtc.com
BitPay.com
Luno.com
NucleusMarket
Cryptonator.com
Cubits.com
Bitcoin.de

27

China

South Africa

USA
China
Canada

South Africa
Austria

USA
Luxembourg
China
Austria

Exchanges
Services/Others —
Services/Others —
Services/Others —
Services/Others —
Exchanges
Exchanges
Services/Others —
Services/Others —
Services/Others —
Exchanges
Services/Others —
Exchanges
Exchanges
Exchanges
Exchanges
Services/Others —
Exchanges
Exchanges
Exchanges
Services/Others —
Services/Others —
Gambling
—
Services/Others —
—
Gambling
Exchanges
South Africa
Services/Others —
South Africa
Exchanges
Finland
Exchanges
Old/Historic
—
Luxembourg
Exchanges
Old/Historic
—
Services/Others —
Services/Others —
Services/Others —
Old/Historic
—
Old/Historic
—
Exchanges
Brazil
Services/Others —
Exchanges
Services/Others —
Services/Others —
—
Gambling
Russia
Exchanges
Exchanges
Germany
Services/Others —
Exchanges
UK
Services/Others —
Gambling
—
Services/Others —
UK
Exchanges
Services/Others —
Exchanges
Services/Others —
Services/Others —
Services/Others —
Exchanges

South Africa

Germany

Russia

Continue to next page

Table A·3 continued from previous page

No.

58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121

User ID

#Addr. (1)

#Addr. (2)

Name

Category

Country

0000000169
0000000169
0000000176
0000000182
0000000190
0000000195
0000000199
0000000201
0000000208
0000000210
0000000216
0000000217
0000000219
0000000234
0000000239
0000000244
0000000252
0000000253
0000000259
0000000263
0000000267
0000000269
0000000270
0000000274
0000000278
0000000282
0000000282
0000000286
0000000300
0000000302
0000000307
0000000312
0000000318
0000000325
0000000347
0000000350
0000000358
0000000359
0000000362
0000000366
0000000370
0000000374
0000000387
0000000402
0000000403
0000000407
0000000412
0000000444
0000000447
0000000468
0000000480
0000000482
0000000501
0000000508
0000000508
0000000511
0000000512
0000000527
0000000533
0000000537
0000000539
0000000542
0000000545
0000000556

140,594
140,594
134,559
131,979
125,004
122,249
120,548
119,119
115,775
114,458
109,798
109,151
107,479
96,890
92,226
90,473
85,637
85,566
83,723
82,695
80,987
80,086
79,712
78,849
78,119
76,997
76,997
74,602
68,956
68,658
67,114
66,748
65,367
64,803
57,770
56,952
55,757
55,703
55,167
54,640
53,639
53,102
50,878
48,602
48,525
48,178
47,295
42,750
42,327
40,270
39,013
38,880
36,999
35,537
35,537
35,453
35,433
34,149
33,436
32,823
32,701
32,017
31,940
30,965

1
1
134,559
1
125,004
1
120,491
119,065
115,775
114,458
1
109,151
85,122
96,890
72,581
44,416
85,626
84,679
83,517
27,343
73,965
1
79,712
78,849
78,048
1
52,925
74,602
67,795
55,098
1
1
1
64,803
57,753
56,952
55,757
1
55,167
54,640
53,639
53,102
50,878
48,518
19,434
33,372
47,281
41,150
41,866
1
1
1
36,999
1
28,567
35,453
35,433
34,149
33,389
32,823
32,701
27,693
30,755
30,965

Cubits.com
Poloniex.com
Cryptsy.com
Poloniex.com
PocketDice.io
Bitstamp.net
FortuneJack.com
AbraxasMarket
CoinKite.com
Kraken.com
Luno.com
Instawallet.org
Bleutrade.com
SecondsTrade.com
HolyTransaction.com
CoinSpot.com.au
MintPal.com
Hashnest.com
BtcTrade.com
BTCJam.com
OKCoin.com
Poloniex.com
Bter.com
BitZino.com
OKCoin.com
Cubits.com
BitoEX.com
Rollin.io
CloudBet.com
VirWoX.com
Cubits.com
Luno.com
VirWoX.com
BTCC.com
MaiCoin.com
BTCCPool
PandoraOpenMarket
MercadoBitcoin.com.br
Paxful.com
PrimeDice.com
SheepMarketplace
Cavirtex.com
BlackBankMarket
BX.in.th
MoonBit.co.in
HaoBTC.com
Matbea.com
SatoshiDice.com
BitcoinWallet.com
Cubits.com
VirWoX.com
Huobi.com
Justcoin.com
Bitcoin.de
SafeDice.com
McxNOW.com
C-Cex.com
MiddleEarthMarketplace
Vircurex.com
Purse.io
SatoshiBet.com
SwCPoker.eu
BitBargain.co.uk
SealsWithClubs.eu

28

China
USA
China
—
China

Australia
—
China
China

Services/Others —
USA
Exchanges
USA
Exchanges
USA
Exchanges
—
Gambling
Luxembourg
Exchanges
—
Gambling
Old/Historic
—
Services/Others —
USA
Exchanges
South Africa
Exchanges
Old/Historic
—
Brazil
Exchanges
Gambling
—
Services/Others —
Exchanges
Old/Historic
Exchanges
Exchanges
Services/Others —
Exchanges
Exchanges
Exchanges
Gambling
Exchanges
Services/Others —
Services/Others —
—
Gambling
—
Gambling
Exchanges
Austria
Services/Others —
Exchanges
Exchanges
Exchanges
Exchanges
Pools
Old/Historic
Exchanges
Exchanges
Gambling
Old/Historic
Exchanges
Old/Historic
Exchanges
Services/Others —
Services/Others —
UK
Exchanges
Gambling
—
Services/Others —
Services/Others —
Exchanges
Exchanges
Old/Historic
Exchanges
Gambling
Old/Historic
Exchanges
Old/Historic
Exchanges
Services/Others —
—
Gambling
—
Gambling
UK
Exchanges
Old/Historic
—

South Africa
Austria
China
Taiwan
—
—
Brazil
USA
—
—
Canada
—
Thailand

Austria
China
—
Germany
—
—
UK
—
China

Continue to next page

Table A·3 continued from previous page

No.

122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185

User ID

#Addr. (1)

#Addr. (2)

Name

0000000559
0000000562
0000000563
0000000571
0000000591
0000000605
0000000614
0000000615
0000000626
0000000649
0000000672
0000000676
0000000687
0000000690
0000000717
0000000747
0000000762
0000000774
0000000794
0000000804
0000000869
0000000874
0000000881
0000000891
0000000902
0000000926
0000000934
0000000959
0000001006
0000001007
0000001071
0000001072
0000001093
0000001177
0000001199
0000001235
0000001240
0000001255
0000001313
0000001325
0000001355
0000001368
0000001393
0000001395
0000001397
0000001421
0000001438
0000001497
0000001568
0000001588
0000001631
0000001666
0000001685
0000001739
0000001750
0000001760
0000001796
0000001862
0000001916
0000002012
0000002024
0000002039
0000002055
0000002098

30,624
30,251
30,187
29,256
27,653
26,622
26,013
25,960
25,257
23,841
22,597
22,304
21,693
21,640
20,484
19,810
18,997
18,489
17,705
17,531
15,965
15,905
15,757
15,495
15,260
14,566
14,394
13,713
12,486
12,456
11,221
11,220
10,901
9,667
9,512
9,165
9,122
8,967
8,430
8,371
8,120
8,032
7,865
7,857
7,848
7,585
7,479
7,109
6,788
6,669
6,477
6,309
6,242
6,009
5,966
5,934
5,762
5,481
5,297
5,024
4,996
4,953
4,896
4,775

22,599
16,052
30,183
29,256
23,515
26,622
24,204
25,960
1
20,866
22,597
22,304
21,693
10,439
18,001
19,605
18,997
18,489
17,705
1
15,965
15,905
15,757
15,495
15,260
14,566
1
11,210
12,486
12,456
11,221
11,220
10,900
1
9,512
9,165
9,122
8,967
8,430
4,343
8,120
8,032
7,865
7,766
7,848
7,585
7,479
7,109
6,207
5,369
6,477
6,309
6,242
4,726
5,966
5,934
5,762
5,481
5,295
5,024
4,875
1
4,896
4,775

BlockTrades.us
CoinMotion.com
OkLink.com
Huobi.com
Bit-x.com
BtcDice.com
BitBay.net
Betcoin.ag
Cubits.com
Paymium.com
Loanbase.com
Coinroll.com
FaucetBOX.com
CoinHako.com
FYBSG.com
TheRockTrading.com
BlueSkyMarketplace
Crypto-Games.net
Coin-Swap.net
Luno.com
AnoniBet.com
ChangeTip.com
Bitmit.net
CoinApult.com
BtcMarkets.net
Inputs.io
Huobi.com
Vaultoro.com
CryptoStocks.com
BitAces.me
Coins-e.com
Igot.com
SatoshiRoulette.com
Bittrex.com
Crypto-Trade.com
Cryptorush.in
BTCOracle.com
Genesis-Mining.com
Exmo.com
SlushPool.com
VaultOfSatoshi.com
BitcoinVideoCasino.com
BTCGuild.com
Peerbet.org
796.com
Btc38.com
Betcoins.net
LiteBit.eu
Bitbond.com
HappyCoins.com
Bitcoin-Roulette.com
AllCoin.com
Coin.mx
LakeBTC.com
777Coin.com
GHash.io
DoctorDMarket
Coinomat.com
Coinmate.io
BitVC.com
SatoshiCircle.com
Luno.com
MyBitcoin.com
AllCrypt.com

29

Category

Country

USA
Finland

Exchanges
Exchanges
Services/Others —
China
Exchanges
South Africa
Exchanges
Old/Historic
—
Poland
Exchanges
Gambling
—
Services/Others —
Services/Others —
Services/Others —
Gambling
—
Services/Others —
Singapore
Exchanges
Singapore
Exchanges
Malta
Exchanges
Old/Historic
—
—
Gambling
Old/Historic
—
South Africa
Exchanges
Gambling
—
Services/Others —
Old/Historic
—
Services/Others —
Australia
Exchanges
Old/Historic
—
China
Exchanges
Exchanges
UK
Services/Others —
Old/Historic
—
Canada
Exchanges
Belize
Exchanges
—
Gambling
USA
Exchanges
Old/Historic
—
Old/Historic
—
Gambling
—
Services/Others —
UK
Exchanges
—
Pools
Old/Historic
—
—
Gambling
Old/Historic
—
—
Gambling
Vanuatu
Exchanges
UK
Exchanges
Old/Historic
—
Exchanges
Netherlands
Services/Others —
Netherlands
Exchanges
Old/Historic
—
Old/Historic
—
Old/Historic
—
China
Exchanges
—
Gambling
Pools
—
Services/Others —
UK
Exchanges
UK
Exchanges
China
Exchanges
—
Gambling
South Africa
Exchanges
Old/Historic
—
Old/Historic
—

Continue to next page

Table A·3 continued from previous page

No.

186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249

User ID

#Addr. (1)

#Addr. (2)

Name

0000002155
0000002169
0000002183
0000002192
0000002197
0000002216
0000002243
0000002251
0000002259
0000002265
0000002281
0000002305
0000002403
0000002424
0000002464
0000002471
0000002587
0000002617
0000002661
0000002849
0000002922
0000002952
0000002965
0000003031
0000003139
0000003195
0000003211
0000003249
0000003310
0000003340
0000003348
0000003388
0000003637
0000003756
0000003840
0000004134
0000004187
0000004271
0000004570
0000004580
0000004586
0000004817
0000004840
0000004863
0000004882
0000005002
0000005121
0000005399
0000005547
0000005637
0000006104
0000006381
0000006688
0000006697
0000006747
0000006753
0000007201
0000007312
0000007547
0000007673
0000007783
0000008133
0000008213
0000008232

4,629
4,605
4,551
4,530
4,516
4,451
4,377
4,363
4,354
4,338
4,292
4,232
3,999
3,947
3,861
3,840
3,607
3,545
3,485
3,216
3,121
3,086
3,075
2,979
2,829
2,760
2,744
2,713
2,645
2,618
2,614
2,575
2,355
2,276
2,221
2,023
1,992
1,948
1,812
1,804
1,802
1,713
1,704
1,699
1,690
1,643
1,594
1,508
1,471
1,443
1,314
1,246
1,189
1,188
1,178
1,176
1,095
1,076
1,040
1,020
1,005
978
968
965

4,629
4,605
4,272
4,242
4,516
4,451
4,377
3,800
4,354
4,338
4,277
4,227
3,999
1,571
3,861
3,840
3,607
3,543
3,485
2,181
3,121
3,086
2,640
2,978
2,829
2,760
2,744
2,713
2,645
2,618
2,614
2,575
2,355
2,276
2,221
2,023
1,992
1,948
1,812
1,796
1,802
1,713
1,704
1,699
1,690
1,643
1,594
1,508
1,471
1,443
1,314
1,246
1,189
1,188
1,178
1,176
1,095
1,076
1,040
1,020
1
978
968
965

GermanPlazaMarket
MasterXchange.com
CoinCafe.com
BitKonan.com
QuadrigaCX.com
BitElfin.com
OrderBook.net
SpectroCoin.com
Bitcurex.com
Coinichiwa.com
Betcoin.tm
MeXBT.com
Bitfinex.com
CoinVault
BetsOfBitco.in
JetWin.com
BitZillions.com
Korbit.co.kr
BTCPop.co
YABTCL.com
BIToomBa.com
BitYes.com
BetMoose.com
CoinURL.com
CannabisRoadMarket
Ice-Dice.com
ChBtc.com
CoinArch.com
Comkort.com
BitNZ.com
CleverCoin.com
CoinMkt.com
DiceBitco.in
BitcoinVietnam.com.vn
Indacoin.com
BitClix.com
Coin-Sweeper.com
GoCelery.com
Playt.in
Bitcash.cz
CampBX.com
BTCLend.org
CoinChimp.com
BtcExchange.ro
AdmiralCoin.com
Bitcoinica.com
Gatecoin.com
BetChain.com-old
BabylonMarket
HelixMixer
Bylls.com
Btcst.com-pirateat40
PocketRocketsCasino.eu
Bitso.com
BTCt.com
DaDice.com
Cryptonit.net
BitStarz.com
Ccedk.com
Satoshi-Karoshi.com
VirWoX.com
Just-Dice.com
CryptoLocker
GreenRoadMarket

30

Category

Country

Services/Others —
Old/Historic
—
USA
Exchanges
Croatia
Exchanges
Canada
Exchanges
Old/Historic
—
USA
Exchanges
UK
Exchanges
Poland
Exchanges
—
Gambling
—
Gambling
Mexico
Exchanges
China
Exchanges
Old/Historic
—
Old/Historic
—
—
Gambling
—
Gambling
Exchanges
Korea
Services/Others —
—
Gambling
Old/Historic
—
Old/Historic
—
Gambling
—
Services/Others —
Old/Historic
—
Old/Historic
—
China
Exchanges
Singapore
Exchanges
Old/Historic
—
Services/Others —
USA
Exchanges
Old/Historic
—
Old/Historic
—
Vietnam
Exchanges
Exchanges
UK
Services/Others —
Old/Historic
—
Services/Others —
Old/Historic
—
Old/Historic
—
USA
Exchanges
Services/Others —
Russia
Exchanges
Old/Historic
—
Old/Historic
—
Old/Historic
—
China
Exchanges
—
Gambling
Old/Historic
—
Services/Others —
Services/Others —
Old/Historic
—
Old/Historic
—
Mexico
Exchanges
Old/Historic
—
Old/Historic
—
UK
Exchanges
—
Gambling
Denmark
Exchanges
—
Gambling
Austria
Exchanges
Old/Historic
—
Old/Historic
—
Services/Others —

Continue to next page

Table A·3 continued from previous page

No.

250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313

User ID

#Addr. (1)

#Addr. (2)

Name

Category

Country

0000008325
0000008352
0000009025
0000009100
0000010744
0000010833
0000011035
0000011546
0000011749
0000011857
0000012513
0000012569
0000012639
0000013022
0000013139
0000013870
0000014175
0000014703
0000015353
0000015549
0000016775
0000017189
0000018179
0000019489
0000021056
0000021084
0000021286
0000023185
0000023304
0000024708
0000025249
0000025389
0000025554
0000027509
0000028306
0000028897
0000032828
0000033285
0000034753
0000034912
0000045961
0000062902
0000064830
0000072390
0000074148
0000078381
0000100904
0000108438
0000109665
0000114095
0000157019
0000180141
0000200218
0000206094
0000265341
0000296609
0000302266
0000302626
0000332619
0000417570
0000434094
0000482184
0000489034
0000539744

953
950
876
869
746
741
729
700
686
681
670
668
665
648
643
614
604
593
572
565
527
515
499
473
440
440
436
402
400
390
382
380
377
351
341
334
297
293
280
279
234
195
190
170
166
157
125
117
116
112
96
85
77
75
59
53
52
52
49
40
38
35
34
32

953
950
876
679
746
741
729
700
1
1
669
668
665
648
643
614
604
593
572
565
527
515
499
471
1
439
436
402
400
390
382
380
377
338
341
1
297
293
280
279
234
195
190
170
1
1
125
117
1
112
1
1
77
75
1
53
1
1
49
1
1
35
1
32

CoinRoyale.com
CryptoBounty.com
1Coin.com
Coingi.com
BitcoinWeBank.com
EmpoEX.com
FairProof.com
UseCryptos.com
Cubits.com
VirWoX.com
AntPool.com
Coinbroker.io
UpDown.BT
DiceNow.com
Dagensia.eu
WatchMyBit.com
MPEx.co
Banx.io
CloudHashing.com
Eligius.st
Europex.eu
EveryDice.com
Brawker.com
10xBitco.in
Cubits.com
BitMinter.com
ExchangeMyCoins.com
BW.com
Chainroll.com
DiceCoin.io
FoxBit.com.br
PonziCoin.co
Birwo.com-old
Zyado.com
SuzukiDice.com
Cubits.com
KnCMiner.com
BitcoinPokerTables.com
Polmine.pl
MineField.BitcoinLab.org
SmenarnaBitcoin.cz
Dgex.com
BitLaunder.com
BitMillions.com
Cubits.com
Cubits.com
Vic-Socks.to
Gatecoin.com
VirWoX.com
Bitcoin-24.com
Cubits.com
Poloniex.com
BetcoinDice.tm
Bitfury.org
Cubits.com
50BTC.com
Cubits.com
Cubits.com
BtcEur.eu
VirWoX.com
Luno.com
SecureVPN.to
Xapo.com
MinersCenter.com

31

—
—
China
Panama
—
USA
—
Portugal

Gambling
Old/Historic
Exchanges
Exchanges
Old/Historic
Exchanges
Gambling
Exchanges
Services/Others —
Exchanges
Austria
Pools
—
Exchanges
USA
Old/Historic
—
Gambling
—
Old/Historic
—
Services/Others —
Old/Historic
—
USA
Exchanges
Old/Historic
—
—
Pools
Old/Historic
—
Old/Historic
—
Old/Historic
—
Old/Historic
—
Services/Others —
—
Pools
Denmark
Exchanges
—
Pools
Old/Historic
—
—
Gambling
Brazil
Exchanges
Old/Historic
—
Old/Historic
—
Portugal
Exchanges
Old/Historic
—
Services/Others —
—
Pools
—
Gambling
Old/Historic
—
—
Gambling
Old/Historic
—
Old/Historic
—
Services/Others —
Old/Historic
—
Services/Others —
Services/Others —
Services/Others —
China
Exchanges
Austria
Exchanges
Old/Historic
—
Services/Others —
USA
Exchanges
Old/Historic
—
Pools
—
Services/Others —
Old/Historic
—
Services/Others —
Services/Others —
Old/Historic
—
Austria
Exchanges
Exchanges
South Africa
Services/Others —
Services/Others —
Old/Historic
—

Continue to next page

Table A·3 continued from previous page

No.

314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377

User ID

#Addr. (1)

#Addr. (2)

Name

Category

Country

0000661573
0000727720
0000881383
0001047894
0001068642
0001453639
0001482058
0001615111
0001849904
0001949672
0002236961
0002437346
0002652760
0002867200
0003042379
0003656659
0003733569
0004053833
0004615543
0004719731
0005083698
0005134566
0005316858
0006291300
0006553479
0006787887
0006884235
0007872688
0008064964
0008251183
0009938959
0010541278
0010933272
0011084834
0011993584
0013456456
0014115232
0014366385
0014572029
0015020521
0015254424
0017326362
0018289896
0018738066
0020356858
0021062591
0021163228
0021447975
0022923752
0023037394
0024428379
0026028525
0033718608
0034424835
0034774492
0035023024
0035093871
0036244970
0036353675
0036389109
0039716556
0040013060
0045999467
0046840841

28
26
23
20
20
15
15
14
12
12
11
10
9
9
8
7
7
7
6
6
6
6
6
5
5
5
5
4
4
4
4
4
4
4
3
3
3
3
3
3
3
3
3
3
3
3
3
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2

28
1
1
20
1
1
15
14
12
12
1
1
1
1
1
1
1
7
6
1
1
1
1
1
1
1
5
1
4
1
1
1
4
1
1
3
1
1
1
1
1
1
1
1
1
1
3
1
1
1
1
1
1
1
1
1
1
1
1
2
1
1
2
1

DiceOnCrack.com
Cubits.com
Bittrex.com
ActionCrypto.com
Cubits.com
CoinMotion.com
ASICMiner
Telco214
BTradeAustralia.com
PinballCoin.com
MoonBit.co.in
Cubits.com
Xapo.com
Cubits.com
Xapo.com
Cubits.com
Luno.com
SimpleCoin.cz
LuckyB.it
Cubits.com
Cubits.com
Cubits.com
LakeBTC.com
Cryptopay.me
Xapo.com
Cubits.com
Exchanging.ir
Cubits.com
FoxBit.com.br
Cubits.com
Cubits.com
Bitcoin.de
ePay.info
Cubits.com
Cubits.com
EclipseMC.com
Xapo.com
Cubits.com
StrongCoin.com-fee
Poloniex.com
Cubits.com
Cubits.com
Huobi.com
Cubits.com
Poloniex.com
Cubits.com
ePay.info
Cubits.com
Cubits.com
Cubits.com
Cubits.com
Cubits.com
Xapo.com
VirWoX.com
Cubits.com
MercadoBitcoin.com.br
Huobi.com
Cubits.com
Cubits.com
Dispenser.tf
Poloniex.com
Cubits.com
DeepBit.net
Cubits.com

32

Iran

China

Brazil

Old/Historic
—
Services/Others —
USA
Exchanges
Old/Historic
—
Services/Others —
Exchanges
Finland
Old/Historic
—
Pools
—
Exchanges
Australia
Old/Historic
—
Services/Others —
Services/Others —
Services/Others —
Services/Others —
Services/Others —
Services/Others —
South Africa
Exchanges
Czech
Exchanges
Gambling
—
Services/Others —
Services/Others —
Services/Others —
Exchanges
Services/Others —
Services/Others —
Services/Others —
Exchanges
Services/Others —
Exchanges
Services/Others —
Services/Others —
Exchanges
Services/Others —
Services/Others —
Services/Others —
—
Pools
Services/Others —
Services/Others —
Services/Others —
Exchanges
Services/Others —
Services/Others —
Exchanges
Services/Others —
Exchanges
Services/Others —
Services/Others —
Services/Others —
Services/Others —
Services/Others —
Services/Others —
Services/Others —
Services/Others —
Exchanges
Services/Others —
Exchanges
Exchanges
Services/Others —
Services/Others —
Old/Historic
—
Exchanges
USA
Services/Others —
Old/Historic
—
Services/Others —

Brazil
China

Germany

Austria

China

USA

USA

Continue to next page

Table A·3 continued from previous page

No.

378
379
380
381
382
383
384
385
386
387
388
389

User ID

#Addr. (1)

#Addr. (2)

Name

Category

Country

0047562289
0049075064
0050709449
0051958689
0052140982
0053961615
0055586746
0056053704
0058665155
0058696998
0058767317
0059011161

2
2
2
2
2
2
2
2
2
2
2
2

1
1
1
2
1
1
1
1
1
1
1
1

Cubits.com
Cubits.com
Poloniex.com
CoinWorker.com
Cubits.com
Cubits.com
Cubits.com
Luno.com
Xapo.com
Cubits.com
Cubits.com
Bittrex.com

USA

Services/Others —
Services/Others —
Exchanges
Services/Others —
Services/Others —
Services/Others —
Services/Others —
Exchanges
Services/Others —
Services/Others —
Services/Others —
Exchanges

USA

South Africa

End of Table A·3

33

Appendix B:

Illustrating Adjacent Matrices of Gt or Xsd

Fig. B·1 illustrates the adjacency matrices for all the networks Gt in Table I, or equivalently the

non-negative matrix Xsd given by (15).

Fig. B·1. Adjacent matrices for all the networks Gt in Table I, or equivalently Xsd given by (15). Colors show
the strength of links, expressed by the frequencies.

34

Appendix C: Topic Model of Latent Dirichlet Allocation (LDA)

Topic models in natural language processing and machine learning are probablistic models for
how terms appear in documents in a given corpus. Assumed is the term frequency, irrespective of the
sequential order of term occurences; such an assumption is often called “bag-of-words”. A topic is
a latent variable in the model for explaining term frequency occurrences. Latent Dirichelt allocation
(LDA) [41] is such a model widely used in a variety of applications. See [37, 42, 43] and references
therein for introduction and applications. In this appendix, we brieﬂy summarize the topic model only
for the purpose of explicitly relating it with non-negative matrix factorization (NMF).

D documents in a corpus (a collection of documents) are given with a vocaburary of V terms
(diﬀerent words). Document d (d = 1, . . . , D) comprises Nd words, possibly with duplication, each
denoted by wdn (n = 1, . . . , Nd). K topics are assumed to be present for the given corpus. A topic is
a latent or hidden variable giving a probability distribution for term occurrences. If a document is an
article on sports, terms like “swimming” and “gymnastics” are likely to occur, while “market” and
“employee” will be unlikely.

Consider the example of an article on “inﬂuence of hosting Olylmics to economy” in a corpus of
newspaper. It would be natural to consider that the article belongs to two topics of sports and economy.
In topic models, documents are not assumed to belong to a single topic, but to simultaneously belong
to multiple topics, and the topics vary among documents. Topic models aim at modeling such mixed
membership.

Document d has a topic distribution, which is a multinomial distribution with the parameters:

where θdk = p(k | θd) is the probability that a topic k is assigned to the document d, satisfying

θd = (θd1, . . . , θdK) ,

θdk ≥ 0

and

K

Xk=1

θdk = 1 .

(C·1)

(C·2)

Then a topic zdn ∈ {1, . . . , K} is assigned to each word wdn for n = 1, . . . , Nd. Each topic k is a term
distribution, which is also a multinomial distribution with the parameters:

where φkv = p(v | φk) is the probability that a term v occurs, satisfying

φk = (φk1, . . . , φkV ) ,

φkv ≥ 0

and

V

Xv=1

φkv = 1 .

(C·3)

(C·4)

The topic model of LDA can be most readily understood by looking at how it generates words in

documents as follows.

1. For each topic k = 1, . . . , K, generate the parameters φk for the term distribution by

where ∼ reads that a variable is realized as a sample from the distribution on the right-hand side,
and Dir(·) is the Dirichlet distribution7. β = (β1, . . . , βV ) is a set of hyper-parameters with βi > 0.

φk ∼ Dir(β) ,

(C·5)

7Dirichlet distribution is deﬁned by

Dir(x | ξ) =

Γ

I
i′=1 ξi′
(cid:16)P
(cid:17)
I
i′′=1 Γ(ξi′′ )

I

×

Yi=1

xξi−1
i

,

where I is the number of variables and it is assumed that xi ≥ 0 for all i and
by Γ(u) =

tu−1 e−tdt for u > 0. Dirichlet distribution is a generalization of Beta distribution (the case I = 2).

I
i=1 xi = 1. Γ(·) is the gamma function deﬁned

∞

P

0
R

Q

35

2. Now for each document d = 1, . . . , D,

(a) generate the parameters θd for the topic distribution by

θd ∼ Dir(α) ,

where α = (α1, . . . , αK) is a set of hyper-parameters with αk > 0.

(b) For each word wdn (n = 1, . . . , Nd)

(i) genrate a topic by

zdn ∼ Cat(θd) ,
where Cat(·) is the categorical distribution8, and then

(ii) genrate a word from the vocaburary by

wdn ∼ Cat(φk=zdn ) .

(C·6)

(C·7)

(C·8)

Note that a topic is assigned to each occurence of word wdn at the location n of the document d,
depending on how the document d has a mixture of topics, but is not associated with each term v in
the vocaburary of V terms. In the previous example, the term “swimming” occurs with a relatively
high probability if the topic of sports is assigned at the location of occurence, but the term will not be
likely to occur if the topic of economy is assigned at the same location.

Given the number of topics, K, and the hyper-parameters, β and α, the model M can be speciﬁed
by the parameters {θd}d=1,...,D and {φk}k=1,...,K, while the data D comprises D documents, each of
which is a set of words {wdn}n=1,...,Nd for d = 1, . . . , D. In the Bayesian framework of

p(M | D) =

p(D | M) · p(M)
p(D)

.

(C·9)

the prior distribution p(M) is given by the Dirichlet distributions of (C·5) and (C·6). It is easy to show
that the likelihood p(D | M) can be written by

log p(D | M) =

log

D

Nd

K

Xd=1

Xn=1

Xk=1

θdk · φkwdn ,

(C·10)

which follows from the assumption of bag-of-words and the independence of documents. Estima-
tion of parameters by maximum likelihood or Bayesian frameworks has a diﬃculty due to the log of
sum in (C·10), so there are a variety of technical methods such as EM (expectation and maximiza-
tion), variational Bayes, and MCMC (Markov chain Monte Carlo) algorithms (see [37, 42, 43] and
references therein).

For our purpose, let us turn out attention to how a word is chosen from the V terms in the vocabu-
rary in the D documents, given the model parameters. Looking at (C·7) and (C·8), one can see that
the probability that a term v is chosen as a word in the document d, denoted by λdv, is given by

where it is assumed that

K

λdv =

θdk · φkv ,

Xk=1

λdv ≥ 0

and

V

Xv=1

λdv = 1 .

(C·11)

(C·12)

8Categorical distribution is a multinomial distribution for a single trial (a roll of a dice), i.e.

where v ∈ {1, . . . , V} and φ = (φ1, . . . , φV ) with φv ≥ 0 for all v and

v φv = 1.

Cat(v | φ) = φv ,

P

36

(Note that (C·11) is the factor in the likelihood (C·10)). In terms of matrices, the D × V matrix,
denoted by Λ, with elements λdv is represented by a product of two matrices; the D × K matrix
Θ with elements θdk times the K × V matrix Φ with elements φkv. Note that it is usually the case
that K ≪ V and K ≪ D. One can immediately see that (C·11) is actually a non-negative matrix
factorization (NMF) of Λ by two generally much smaller matrices:

Λ = Θ · Φ

(C·13)

under the conditions of (C·2) and (C·4), from which (C·12) follows.

A document-term matrix is the D × V matrix, the rows and columns of which correspond to
the documents and terms respectively, and each element is the frequency (or any other measure that
represents some intensity) for the term occurences. One can regard the document-term matrix as a
realization in the sense that each element at column v and row d represents how the term v was
realized in the document d according to the categorical (multinomial) distribution with the parameter
λdv. See the main text in Section 3.4.

How to determine the number of topics, K, is important. There have been a number of works on
this issue. A class of studies [38–40] is based on some measure to compute similarities of extracted
topics, called coherence. The idea is that an optimal value of K is the point where the overall dissim-
ilarity among topics achieves a maximum, because extracted topics should be diﬀerent to a certain
degree. Other approaches include the idea of perplexity [37], hierarchical Dirichlet process [44], and
so forth. It is beyond the present paper to review these approches. Interested readers are guided to look
at them and reviews [42, 43] with references therein. In the main text, we use the idea of coherence
[38–40], which we ﬁnd to work well for our purpose.

37

Appendix D: Optimal Number of NMF Components

In Section 3.4, we showed that the matrix decomposition of NMF can be regarded as a probablis-
tic model, which is equivalent to a model of probabilistic latent semantic analysis (PLSA) in natural
language processing, in particular, latent Dirichlet allocation (LDA). The number of NMF compo-
nents is such an analogous parameter as the number of topics in the latter. Then, as a bonus, one can
employ the method of estimating the number of topics to our problem of detemining the number of
NMF components, K. We found that three diﬀerent methods in the literature [38–40] give a consis-
tent result for the optimal value of K, and also that one of them [39] is relatively stable in giving the
optimal (see Fig. 8).

In Fig. D·1, we summarize the same result for the data in all the other months in the same year.
We found that the optimal number K is not volatile in its variation among diﬀerent months, and also
small in its value ranging around 11–18. Table D·1 shows the optimal values for all the months of the
year 2019.

Table D·1. Optimal values for the number of NMF components, K, estimated from Fig. D·1

Month Optimal K

01
02
03
04
05
06
07
08
09
10
11
12

14
16
18
16
16
18
15
12
13
11
13
13

38

Fig. D·1. Determining K, the number of NMF components, by minimizing the measure of coherence [39].
We performed Monte Carlo simulations with 20 runs for each number of components. Averages (points) and
99% level (gray band, narrow) calculated from standard errors are drawn. Data: all months in the year 2019.

39

