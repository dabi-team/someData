1
2
0
2

c
e
D
7

]

A
M

.
s
c
[

1
v
4
4
9
4
0
.
1
0
2
2
:
v
i
X
r
a

Peer-to-Peer Energy Trading in a Microgrid Leveraged
by Smart Contracts

Guilherme Vieira, Jie Zhang*

University of Southampton, U.K.

gbv1e17@soton.ac.uk,

jie.zhang@soton.ac.uk

Abstract

The current electricity networks were not initially designed for the high integration of
variable generation technologies. They suffer signiﬁcant losses due to the combustion of fossil
fuels, the long-distance transmission, and distribution of the power to the network. Recently,
prosumers, both consumers and producers, emerge with the increasing affordability to invest
in domestic solar systems. Prosumers may trade within their communities to better manage
their demand and supply as well as providing social and economic beneﬁts. In this paper, we
explore the use of Blockchain technologies and auction mechanisms to facilitate autonomous
peer-to-peer energy trading within microgrids. We design two frameworks that utilize the smart
contract functionality in Ethereum and employ the continuous double auction and uniform-
price double-sided auction mechanisms, respectively. We validate our design by conducting
A/B tests to compare the performance of different frameworks on a real-world dataset. The key
characteristics of the two frameworks and several cost analyses are presented for comparison.
Our results demonstrate that a P2P trading platform that integrates the blockchain technologies
and agent-based systems is promising to complement the current centralized energy grid. We
also identify a number of limitations, alternative solutions, and directions for future work.

1

Introduction

The current infrastructure of the national grid is aging and has been mainly built to support a one-
way power ﬂow. It is a centralized system that energy is generated in power plants, transmitted
over long distances to consumptions sites, where consumers are majorly passive. See Figure 1(a)
[22] for an illustration. The long-distance transmission not only creates power losses but also does
not integrate demand and supply in real-time, which causes overproduction. For example, during
winter 2017, Germany has experienced unexpected negative electricity prices, where they produce

*Corresponding author.

1

 
 
 
 
 
 
too much when there is not enough demand (over the weekends). As a consequence, they have to
pay to be able to “sell” their product. Thus, people have been looking for alternatives to mitigate
these problems.

Figure 1: (a) Central generation, one-way power ﬂow;

(b) Distributed generation & storage, two-way power ﬂow.

Meanwhile, we are moving to a more distributed network, arguably, also more complex, in
which energy generation will no longer only come from power plants. This distributed network
involves houses with solar photovoltaic panels (PV), electric vehicle (EV) charging stations (that
can act as storage), locally produced wind power, and other renewable energy technologies. Indi-
viduals are no longer just consumers but are actively taking part in the productions of their energy
and collectively feeding electricity into the grid. They are the so-called prosumers, both consumers
and producers of energy. That is to say, the large companies will no longer be the only ones with
a stake in the energy space, but the public as well. This new movement creates a range of oppor-
tunities to retroﬁt the centralized way of managing today’s grid, one of which is the possibility to
introduce the ability to react in real-time to the intermittent generation and volatility of the national
grid in the current wholesale market.

A microgrid is formed by agglomerating small-scale prosumers; they constitute a local energy
market and trade energy within their community. A microgrid can help with reﬂecting the real-
time prices of energy and facilitate a sustainable and reliable way of locally balancing generation
and consumption. The local energy markets can be viewed as a rising form of sharing economy,
in addition to the well-developed house-sharing and transportation sharing. See Figure 1(b) [22]
for an illustration. Such an initiative can help reduce the latency for managing congestion and the
distribution faults [10]. Its decentralized structure can help with cyber attack resilience. Overall, it
helps communities become more self-sustainable, ecologically, and economically.

Smart grid hardware, such as smart meters, has been a signiﬁcant catalyst in moving to more
autonomous networks. They can be used for handling more complex information, such as optimiz-
ing energy consumption patterns, adapting to them, and using these to optimize the price of energy
as well as controlling the parameters of the appliances in their houses by using the customer-
generated energy proﬁle. In the meantime, these systems need a secure, reliable, and transparent
mechanism to manage these markets, helping with their local energy balancing needs, and provid-
ing a user-friendly application for people to use. Therefore, we necessitate new control frameworks
to fulﬁll these requests.

The Blockchain technologies enable the possibility of building up an autonomous, secure, re-
liable, and transparent market. Blockchain is formed by a series of blocks which contain a record

2

of transactions. Each block references the previous block via its hash value, thereby creating a
chain of transactional records that can be traced back to the genesis block. The most trusted and
reliable chain is the longest. The Blockchain is not provided from a single server but is a dis-
tributed transactional database with globally distributed nodes that are linked by gossip protocols.
Blockchain protocols are designed to possess a number of important features including decentral-
ization, immutability, and pseudo-anonimity. Therefore, they provide a level of security, trustless,
and privacy.

Problem Statement. To realize autonomous peer-to-peer energy trading within microgrids,
one must demonstrate that the use of blockchain technologies to build a peer-to-peer energy trading
system is technically feasible and reliable. More importantly, it is desirable to explore associated
costs and limitations.

Contributions. We develop two frameworks that aggregate local demand and supply by auc-
tion mechanisms, buy and sell energy on behalf of prosumers by implementing predeﬁned agents
logic, and enable autonomous transactions through smart contracts functions. The evaluation is
undertaken predominantly from an economic point of view. We would compute the aggregated
costs if households were to always pay to the national grid when they lack energy or not gen-
erating enough from their PV systems. This data will be compared to the results obtained from
the two separate auction mechanisms. These cost analyses would provide an insight into whether
blockchain technologies are effective in integrating necessary components to constitute a micro-
market setup. Last, we reﬂect on the assumptions made, the challenges yet to be addressed, and
point out directions for future work in these emerging applications.

Organization. This paper is organized as follows. Section 2 introduces the integral components
of the system, exhibits the design of the two frameworks, and presents experimental parameters and
some implementation details. Section 3 presents a high-level comparison of the key characteristics
of the two frameworks and the simulation results, including some cost analyses. We conclude with
a reﬂection on the design and discussion of future directions in Section 4.

1.1 Related Work

Blockchain Technology Application in Microgrids. Since the emergence of Blockchain tech-
nologies, people appealed to exploit their applications in the energy sector, with the hope to re-
duce costs, enhance security, enable automation, and improve efﬁciency. This adaption requires
the integration of agent-based modeling, market mechanisms, microgrid infrastructures, and many
more. To the best of our knowledge, there are more attempts toward this direction in industry,
and few developed prototypes documented in the literature. [13] proposed a cooperative model in
which electricity producers and consumers form coalitions and collectively negotiate the electric-
ity price. The model included a transaction settlement system such that the contracts are recorded
in a Blockchain protocol. Their simulation results revealed the connection between the number of
prosumers, the average negotiation time, and the number of ﬁnal contracts. [23] proposed a peer-
to-peer electricity trading mechanism that enables smart contract transactions. In their mechanism,
there was a single seller that aggregates local producers’ supply and auction off the electricity
to individual consumers. The authors ran experiments with 100 prosumers by considering their
satisfaction index and exploit the relation between the demand/generation ratio and satisfaction

3

indices. Mengelkamp et al. [18] contributed to the literature on a conceptual level by presenting a
blockchain-based microgrid energy market and proposed a framework which contains seven mar-
ket components. [12] investigated the pros and cons of several Blockchain protocols and concluded
that Ethereum Smart Contract was most appropriate for building up a Blockchain-based electricity
trading platform in Microgrid.

P2P Energy Trading Platforms. There is a large body of literature on microgrids’ bench-
marks, beneﬁts, and trials [16, 17]. Here, we list a few projects in which the outcome was P2P
energy trading platforms. [21] is an energy trading platform that allows for decentralized selling
and buying of renewable energy. Their platform has a dual-token ecosystem operating on two
blockchain layers, POWR and Sparkz. It provides consumers with access to a variety of energy
markets around the globe. TransActive Grid is a joint venture between a startup LO3 Energy and
a blockchain tech company ConsenSys. They launched a proof-of-concept project, the Brooklyn
Microgrid, which aimed at enabling local transactions based on Blockchain technologies. They
did not have an Initial Coin Offer and expected to proﬁt from transaction fees. To the best of our
knowledge, they were oscillating between developing its cryptocurrencies that fuel their smart con-
tract or employing Ethereum straightaway. There are other P2P energy trading platforms such as
Grid Singularity, NRGcoin, SolarCoin, Piclo, and Vandebron.

Auction Mechanisms. Continuous double auction (CDA) is very common and has become
one of the dominant auction models for trading ﬁnancial products. The Nasdaq Stock Market and
the New York Stock Exchange, for example, implement variants of the CDA. With the ﬂourish
of the electronic commerce, CDA is also adopted by many online marketplaces, such as LabX
and Dallas Gold and Silver Exchange. Since [4], researchers have developed software-based agent
mechanisms to automate double auction for stock trading with or without human interaction. More
recent research on bidding in continuous double auctions and its truthfulness can be seen in [2, 24].
In a uniform-priced double-sided auction [14, 25], a single price at the end of each time interval
is determined by the intersection of the aggregated demand and supply curve derived within the
epoch.

2 Framework Design and Implementation

2.1 Components of the Model

The Rationale of Adopting a Blockchain Protocol. The most inﬂuential consensus mechanisms
are Proof-of-Work (e.g., Bitcoin [19], Ethereum [1], and other Altcoins) and Proof-of-Stake (e.g.,
Algorand [7], Ouroboros [11], Ouroboros Praos [5]). Since ﬁnding a nonce to validate transactions
and create new blocks is computationally intensive, PoW is often criticized by wasting electricity.
Therefore, PoS is more preferred for environmental consideration but is awaiting validation. For
example, Ethereum was the ﬁrst to call for a switch from PoW to PoS and proposed the Slasher
and Casper protocols, and they had even set up deadlines for such a switch; however, upon till now,
they are still using a PoW protocol.

Depends on the range of nodes that can write and read the data on a chain, blockchain pro-
tocols can be classiﬁed as permissionless/public blockchain and permissioned/private Blockchain.

4

A public blockchain (e.g., Bitcoin and Ethereum) offers a high level of decentralization, security,
and immutability. Permissioned Blockchain (e.g., Hyperledger) offers a higher level of efﬁciency,
but it is similar to a distributed system, which is challenged by fault detection, fault tolerance, and
fault resilience.

The three leading contenders that enabled smart contracts are Ethereum, Hyperledger Fabric,
and NEO. Hyperledger Fabric offers an enterprise-grade framework. However, only a small portion
and fragment tools are open access. Implementing a complex and integrated P2P energy trading
platform would require much inferring and debugging their tools. NEO provides fewer resources
and documentation than Ethereum. Ethereum can execute relative complex business logic in a
secure network. Its smart contract is a piece of code that can contain data, its balance of ether, and
functions that can be triggered if the conditions/terms are fulﬁlled within it. Smart contracts enable
a more vast range of applications that can be built on top of the Ethereum network where they can
interact with each other. Therefore, Ethereum was the chosen blockchain technology.

Ethereum Blockchain Costs. In Ethereum, any transaction that changes state in the blockchain
database needs to be mined. Transactions that change state infer a cost, which is paid in gas, the
unit of computation in the Ethereum blockchain. Each operation (e.g., adding, multiplying) have a
pre-deﬁned cost of gas [27]. Therefore, the overall gas necessary to complete a transaction amounts
to the number of operations it needs to perform up to its completion. The total cost of a transaction
is given by:

Cost of Transaction = Gas Limit × Gas Price

(1)

Gas limit is a parameter that is deﬁned in any transaction; it aims to set a maximum limit of gas in
that the user is willing to pay for said transaction. Since the simulation will be run in a local network
using Ganache-cli, we set the gas price to be 2e10 Wei, where Wei is equivalent to e−18 Ether and
is the smallest unit of Ether. One Ether will be considered to cost 250 dollars for the entirety of
the analysis. Although the volatility of cryptocurrencies is beyond the scope of this work, all these
parameters can be customized in the simulation ﬁle. Lastly, each transaction between user accounts
has a set fee of 21,000 gas.

Market Mechanism. The market mechanism deﬁnes the conditions and rules in which energy
is trade. The two mainstream market mechanisms identiﬁed in the literature, the continuous double
auction [18] and the uniform-price double-sided auction [15, 25], are investigated in this work. The
continuous double auction is a mechanism often used in ﬁnancial market exchanges. There are two
sides, the buyer (bids) and sellers (asks) side. Each participant bids their value and quantity of
the desired good; if any bid surpasses the lowest-priced ask, they are matched and trade. The
uniform-priced double-sided auction [14] is more common in day-ahead energy markets. These
markets intend to buy and sell energy for deﬁned time intervals for the following day. This process
prevents volatility in prices of energy, along with providing the reliability of energy available for
the buyer. It also serves for producers to better schedule their generation capacity. The auction
works in discrete intervals, in our case, set to be one hour, where all the bidders and sellers submit
offers. At the end of this hour, a single price is deﬁned by the intersection between the aggregated
demand and supply curve. Trade occurs between all the participants at the equilibrium price, and
the market is reset for the next hour.

5

Dataset Acquisition. The dataset is one of the essential components to validate our design. We
acquire a dataset through the Pecan Street website, a research network with data of over a thousand
homes, out of which 250 were households with installed solar systems [20]. This dataset was
comprised of houses mainly located in Austin, Texas, USA, providing plenty of solar coverage and
with information available about their energy proﬁle, load, demand, how much was required from
the grid, and which utilities constituted the total demand. Each of these agent instances represents
a household, in which all its data (e.g., amount of battery charge, load, demand, ether balance,
historical bids/asks) is stored, along with functions representing the functionality that the agent is
able to perform.

Formulate the Price of Energy. The data was preprocessed using Python to isolate the house-
holds into separate CSV ﬁles and calculating their respective levelised cost of energy (LCOE),
which is the sum of the system cost over a year (considering system life cycle to be 25 years) over
the sum of generation that system produced - giving a $/kWh metric.

LCOE =

Sum of the system cost over a year
Sum of generation that system produced

(2)

The cost of the system was derived by taking the national average of price per kWh of installed
solar capacity applied to the different tiers of installed capacity - e.g., 0-4 kWp, 4-10 kWp, and 10-
50 kWp. Additionally, battery prices were included in the derivation of LCOE, by introducing an
8 kWh battery (Powervault Lithium-ion G200) cost for every system that had a capacity between
2 and 4 kWp, one or two Tesla power wall batteries for systems with a capacity of 4 to 6 kWp or
6 kwp and above respectively. At the end of this process, each household ended up having their
two individual LCOE derived for a system without a battery, and another one with. Finally, a large
biomass producer was introduced as it is a controllable renewable energy system that can be used
to generate a more stable supply than solar - LCOE prices ranging from 5 to 12 cents per kWh to
emulate the different types of biomass used. This provides the microgrid with self-sustainability
by increasing its generation capability.

The pricing of energy is set at a price that beneﬁts both the producer and consumer. That is,
pricing the energy above the sellers base costs but also setting a maximum price for the buyer,
which did not exceed the national grid price. If any energy were to be sold at higher than the grid
price, there would be no incentive for consumers to use the microgrid market. Hence, these two
constraints were taken into consideration, and a normal distribution was attributed to each agent.
The minimum price, i.e., the LCOE for each agent (base electricity cost), was set a two standard
of deviations below the mean, and the national grid price at two standards of deviations above the
mean - resulting in a truncated normal distribution.

2.2 Two Frameworks

In this section, we present two frameworks. The ﬁrst one takes full advantage of the blockchain
technologies, and the second one is less decentralized as it requires a component to be off-chain
in order to alleviate the computational work from the blockchain. We will describe how data and
information ﬂow in the systems and how the application was going to interact with the blockchain.

6

Framework 1 (Decentralized, Continuous Double Auction). The ﬁrst framework (Figure
2(a)) uses the full functionality of the blockchain. It is a server that households can connect to, a
database with immutable information that people can access and write to, as well as a platform
for the exchange of value. The bottom of the diagram indicates that each household, holding a
smart meter, connects and relays information in real-time to its representative agent in the micro-
grid application. This connection is of restricted access to the smart meter that corresponds to the
respective household owner and provides all the information the agent needs in order to make ra-
tional decisions on their behalf. If this is the ﬁrst time an agent is connecting to the blockchain, the
agents will request the creation of a household contract to the household factory through the Web3
interface technology, which enables agents to communicate to the blockchain. The household fac-
tory creates the household contracts on the agent’s behalf and attributes their Ethereum address,
respectively. It is to ensure consistency of the smart contract codes, i.e., no malicious code can be
inserted by any participant if all have to be created by this factory. Moreover, it creates contracts
with the decentralized exchange address automatically conﬁgured, and it is a useful point of access
to request statistics about every participant’s readable information. Household contacts now have
a direct restricted channel to their agent, which provides and updates all the necessary information
- serving as a repository of information. These are then allowed to submit bids/asks, delete them
from the exchange, and make calls to the exchange when triggered by the agent’s logic. The de-
centralized exchange takes all the bids/asks and orders them in ascending and descending order
of price, respectively. This way, it automates the matching process of the offers and relays the ap-
propriate transaction commands between household contracts. All these trades records are stored
in the blockchain. The accountability of each entity’s balance is taken care of by the consensus
mechanism.

Framework 2 (Semi-decentralized, Uniform-price Double Sided Auction). The second frame-

work is shown in Figure 2(b). Comparing to the ﬁrst framework, it implements a uniform-price
double-sided auction instead of a continuous double auction. More importantly, the household
contacts and the factory are removed to reduce an intermediary layer of transactions that gets in-
formation onto the exchange. The decentralized exchange no longer automates the matching of
offers coming from the agents. Instead, the smart contract is used to store the information relayed
from all the different participants of the microgrid. At the end of each epoch, the application col-
lects the offers from the decentralized exchange, consequently calculating the regression curves
of the supply and demand side in order to ﬁnd the interception - the uniform price. The matching
algorithm is then initialized, which relays the respective matching with their respective prices to
each agent. The algorithm triggers their payment functionality, thereby transacting the necessary
amount of Ether from one account to the other through the Web3 interface.

Agent Bidding Strategy Logic. The agent bidding strategy logic is shown in Figure 3. The ﬁrst
decision node from the top is checking whether an agent has excess energy or is lack of energy.
Then, it follows with several thresholds of batteries in which the agent decides to sell/buy energy
or to charge/discharge the batteries. This process results in a behavior in which energy is sold when
prices are high and bought when prices are low. Furthermore, it has a level of ”forecasting” capa-
bility in which it checks the necessary energy that is going to be needed for the following 10 hours
(conﬁgurable). This attempts to emulate the actual forecasting done in energy markets in order to

7

Figure 2:

(a) Framework 1;

(b) Framework 2.

predict how much demand and supply individuals will need in the upcoming day. Forecasting pro-
vides a more reliable level of energy supply, as suppliers can be aware of the amount of necessary
energy that will be required at different times of day, and control systems can prepare accordingly.
Preprocessed data is prepared by acquiring weather data from the National Renewable Energy Lab-
oratory (NREL) within the same time frame and location [26]. This ”forecasting” function permits
agents to reduce the number of transactions they would have to do a day, by ﬁlling their batteries
with the necessary energy they will need for that time interval. Otherwise, they would have to bid
almost every hour that is inconvenient and resulting in a system that would be very costly just in
transaction fees. Finally, there is a safety net mechanism in which the agents will buy energy from
the national grid if the batteries fall under 20% of their total capacity.

Implementation. For the implementation, a wide range of technologies are used, including
Solc, Mocha, React.js, Next.js, Ganachecli, Metamask, Ganache-cli, and Web3. Ganache-cli is an
Ethereum development tool that simulates full client behavior by running a personal blockchain on
a local machine. It is essential to make the testing faster and easier as it can run transactions very
quickly compared to the online Ethereum test networks. Web3 enables an interface to communicate
between the application and the ganache provider, i.e., sending transactions, creating contracts,
requesting blockchain accounts information.

The initial step taken is the creation of adequate smart contracts that would enable the storage of
information and added bidding functionality to the households, name household contracts. These
would then communicate to a smart contract that serves the function of a decentralized exchange
market. The smart contracts are then tested using the Mocha library to check if they are working as
desired and to learn about the contract’s limitations - i.e., memory limitations, computational cost

8

Figure 3: Digram showing the logic behind the agents strategic bidding or selling.

optimization, the functionality of transaction between contracts, and between Ethereum accounts.
Once the smart contracts are sufﬁciently reﬁned, the simpliﬁed UI application is developed using
React.js and Next.js.

We program the market simulation in Javascript as the underlying UI application to match the
stack of technologies that are used to code the front-end of the application. We start by importing
the respective CSV ﬁles containing each household’s hourly load and demand into separate class
instances (data structures) called agents. Each of these agent instances represents a household, in
which all its data (e.g., amount of battery charge, load, demand, ether balance, historical bids/asks)
is stored, along with functions representing the functionality that the agent is able to perform.
These are used to interact either with its own data structures or to interact with the smart contracts.
The agents are coded to take independent actions based on the most attractive conditions in the
market. No coordination between the agents is built into the system. At every epoch, each agent
is given the chance to act according to these sets of actions. At the end of the simulation, the data
is collected from the separate agent data structures, and written to a CSV ﬁle to be examined by a
Python script (better visualization and mathematical tools).

The analysis of the results would be undertaken by calculating the aggregated costs of all the
households if they were to always pay to the national grid when they lack energy or not generating
enough from their PV systems. This data is then compared to the results obtained from the two
frameworks. This analysis will be done predominantly from an economic point of view. These
results will be discussed to assess whether using microgrids is economically beneﬁcial for both

9

Framework 2

Framework 1
Computation and matching are done within
the blockchain through smart contracts
Matching is done externally to the blockchain
Uses more transactions = more gas expenditure Uses less transactions = less gas expenditure
More ﬂexible - can implement more complex
Less ﬂexible - can not implement heavy
procedures (e.g., other auction mechanisms)
computation procedures
Faster system
Slower system
Less secure
More secure

Table 1: The difference of the key characteristics of the two frameworks

consumers and producers, as well as providing an insight into whether blockchain technologies are
effective in integrating necessary components to constitute a micro-market setup.

3 Evaluation

A high-level comparison of the key characteristics of the two frameworks. A comparison of the
two frameworks is given in Table 1. At a high-level, Framework 1 uses the storage, computation,
and exchange of value function of the blockchain, whereas Framework 2 does the computation
externally. It takes advantage of the fact that processing information is quicker and free of costs,
hence vastly reducing the number of transactions used within its operation. However, this com-
putation has to be done in a centralized server, which is prone to attacks as it is less secure than
the data on a blockchain. Nevertheless, one could assume that the current centralized servers have
the same level of security. This is necessary as the computation required to calculate the uniform
price was too much to implement in a smart contract. In contrast, Framework 1 is more secure
as all the information is within the blockchain, yet slower due to the more signiﬁcant amount of
transactions has to execute. In addition to this, it can only run continuous double-auction. Frame-
work 1 is, therefore, more decentralized as every participant pays its share of computation of the
decentralized exchange when placing a bid/ask.

In the next, we present a number of simulation results.
We implemented the two frameworks with real-world data on a weekly base, a monthly base,
and a six-month base. Fig. 4(a) and Fig. 4(b) show the simulation results of Framework 1 and 2
in a week, respectively. At times in which there was more supply than demand in the microgrid,
there were no buying and selling activities in the market. In this case, the prices of electricity were
left unchanged from the previous one, as the ﬂat lines represent. This is merely to allow better
visualization of the prices.

Electricity Prices in the Microgrid. Fig. 4(a) and Fig. 4(b) show that the continuous double
auction results in a higher price average of around 8.0 cents per kWh. In contrast, the uniform-
price auction results in an average of 4.4 cents per kWh as well as exhibiting a more volatile range
of prices. In hindsight, this is to some extent because the mechanism used in the latter does not
follow individual rationality. That is, the interception between demand and supply curve may be

10

Figure 4: (a) Framework 1, continuous double auction;

(b) Framework 2, uniform-price, double-sided auction.

found at lower prices than the cost of the producers (averaged at 7 cents per kWh), which results
in a negative utility. The continuous double auction follows individual rationality, as consumers
are paying less than they would be paying with the national grid, and producers are selling at a
higher cost than their LCOE value, resulting in a beneﬁcial situation for both parties. Furthermore,
the uniform-price auction demonstrates a larger amount of electricity volume being traded. This
characteristic is due to the fact that some orders do not get ﬁlled for not having a high enough
price tag in relation to the sell-side in the continuous double auction. Perhaps introducing more
producers present in the market would add a stronger supply side, thereby pushing the interception
of the curves to a higher price, which would lead to more reasonable prices. Simulations of longer
periods were done and are consistent with this observation. By removing the zero-activity periods,
the average of prices is shown to be 8.1 cents per kWh in Framework 1 and 4.2 cents per kWh in
Framework 2, in a six-month simulation.

Blockchain Framework Average Costs vs. National Grid Average Cost. Fig 5(a) and 5(b)
demonstrate the costs comparison between using the Microgrid P2P trading platforms and the cost
of using the national grid solely. The averaged total trading cost per household comes to around
0.74 dollars per day, whereas the averaged cost of using the grid per household is 2.18 dollars a
day. These remain consistent with the longer periods simulation results, which show that national
grid costs are around three-fold as much as the blockchain P2P trading platform.

Battery Charge Percentages. Figure 6(a) and Figure 6(b) show the average battery charge
percentages in the two frameworks, respectively. We can observe a periodic pattern in the uniform-
price double auction in times when the battery charge gets to 50%, as this triggers the Agents Logic
to purchase enough energy to cover their needs for the following 10 hours. This also coincides with
the supply going up during daylight, implying that the Agents Logic correctly manages the agents’
needs on a day-to-day basis. It regulates its purchases in order for the energy storage to cover its
demand needs up to the following day at early hours in the morning when the sun is present when
it knows it will be able to charge its battery. Similar patterns can be observed in the continuous
double auction mechanism, where the battery charge does not tend to drop much below 50%. The
differences in volume traded in both mechanisms is reﬂected in the differences between these two

11

Figure 5: (a) Average Costs of Framework 1 vs National Grid Average Cost.;
vs National Grid Average Cost.

(b) Average Costs of Framework 2

Figures, like the spikes of battery charge in Figure ?? tend to be less abrupt, some of the bids were
not ﬁlled in the order book due to their lower price.

Figure 6: (a) Average Percentage of Battery Charge in Framework 1;
in Framework 2.

(b) Average Percentage of Battery Charge

4 Reﬂection and Future Work

This section comprises of a critical reﬂection over the framework designs implemented, some
results presented, along with some observations about the applicability of blockchain technologies
in the microgrids use case. Some possibilities for further work are discussed.

Reﬂection. Two market mechanisms have been implemented with real-world data, showing
quite different results. The uniform-price auction has shown to result in more amount of volume
being traded but with a reduction in prices.

12

Some assumptions were made in calculating the prices of solar energy systems. Since the focus
of this paper is the overall architecture design, for simplicity, it does not yet take into consideration
the transmission cost, the distribution costs, and battery charging/discharging inefﬁciencies.

More severely, there are still many challenges facing blockchain technologies. For example,
smart contract limitations prevented the introduction of more complex logic. Also, for this speciﬁc
scenario in a closed testing environment, Ethereum’s transaction throughput was not a concern as
this market would be trading every hour. Therefore the amount of data to the process was not a
problem. As Ethereum has 15s block intervals, there could be plenty of block times to insert all
the necessary transactions for an hour increment. However, this could become more of a problem
as trading intervals lengthen (e.g., 1 or 5 minutes). In that case, not all transactions would be
processed in time for the time interval to ﬁnalize, leaving the network congested and the market
with incomplete information.

Innovative solutions to some of these problems are under developing but would probably take
some time. An example of this is the IOTA project. It is a ’ledger of things’ involving the use of a
tangle framework, which is computationally lighter, has low energy consumption, highly scalable,
and has zero transaction fees. Indeed, this technology is promising but is a highly academic and
untested framework yet, which does not have the same level of reliability as the existing blockchain
protocols. Lately, the IOTA Foundation is working on additional smart contracts layer on top of
their existing tangle framework, which could open new doors to a more effective, low-cost alterna-
tive solution to the problems that the blockchain faces today. It will be interesting to see how these
technologies unfold in the near future and if they can fulﬁll their very ambitious ideas that they
have set themselves.

Future Work. The transaction costs and efﬁciency of the system may be improved by opti-
mizing the parameters in the Agents Logic algorithm. For example, the time and price at which an
order is placed, and the percentage at which the battery is charged and discharged. It is essentially
a minimization problem that takes into account a more substantial amount of parameters and con-
ditions from the market, along with constraints related to the household owner’s components, such
as battery’s depth of discharge and inefﬁciencies associated with them. Further testing would need
more extensive simulations and a consistent framework across both market mechanisms to come
to a solid conclusion about which one is most applicable.

One may also attempt to construct alternative frameworks in which agents would communicate
directly to the decentralized exchange smart contract that uses the continuous double auction (for
its preferable price range and being computationally cheap). A caveat for it is that the smart contract
would not be able to automate the transaction from one party to another when it found a matching.
This is due to the inability of a contract to trigger transactions from a user account to another as it
only has the capability to do that with contract addresses. Alternatively, a contract could be created
for each successful matching/trade that would contain a balance sufﬁcient to ﬁll the desired amount
being bought. This way, when a match is found, the market would automatically trigger the smart
contract to exchange value between the two participants and return the remaining balance. Surely,
any further work would have to test if the creation of said contracts for the trade would be cheaper
or more costly than the current approach.

One may want to consider agents’ possible strategic behavior in designing a framework. Bid-

13

ding strategy is an important problem in auction mechanisms, and many strategies for the con-
tinuous double auction have been subsequently developed. Over the last decade, there has been a
considerable emphasis on strategies for software trading agents with the emergence of electronic
markets [6], such as Zero-Intelligence (ZI) strategy [9], Zero-Intelligence Plus (ZIP) strategy [3],
GD strategy [8].

5 Conclusion

The decentralized models, if fully developed, can potentially minimize the power transmission
dissipation, reduce the probability of cascade failure due to its inherent islanding capability, and
minimize the load on the grid by a signiﬁcant ratio. The autonomous microgrid and the centralized
national grid should complement each other, and contribute to a greener and economical energy
market.

Acknowledgements: Jie Zhang was supported by a Leverhulme Trust Research Project Grant
(2021 – 2024).

References

[1] Vitalik Buterin. Ethereum whitepaper. https://github.com/ethereum/wiki/wiki/White-Paper,

2014.

[2] Moinul Morshed Porag Chowdhury, Christopher Kiekintveld, Son Tran, and William Yeoh.
Bidding in periodic double auctions using heuristics and dynamic monte carlo tree search. In
Proceedings of the Twenty-Seventh International Joint Conference on Artiﬁcial Intelligence,
IJCAI 2018, July 13-19, 2018, Stockholm, Sweden, pages 166–172, 2018.

[3] Dave Cliff. Minimal-intelligence agents for bargaining behaviors in market-based environ-

ments. Technical report, 1997.

[4] Rajarshi Das, James E. Hanson, Jeffrey O. Kephart, and Gerald Tesauro. Agent-human in-
teractions in the continuous double auction. In Proceedings of the Seventeenth International
Joint Conference on Artiﬁcial Intelligence, IJCAI 2001, Seattle, Washington, USA, August
4-10, 2001, pages 1169–1187, 2001.

[5] Bernardo David, Peter Gazi, Aggelos Kiayias, and Alexander Russell. Ouroboros praos: An
adaptively-secure, semi-synchronous proof-of-stake blockchain. In Advances in Cryptology -
EUROCRYPT 2018 - 37th Annual International Conference on the Theory and Applications
of Cryptographic Techniques, Tel Aviv, Israel, April 29 - May 3, 2018 Proceedings, Part II,
pages 66–98, 2018.

[6] Daniel Friedman and John Rust. The double auction market: Institutions, theories, and evi-

dence. Addison-Wesley, New York, 1992.

14

[7] Yossi Gilad, Rotem Hemo, Silvio Micali, Georgios Vlachos, and Nickolai Zeldovich. Algo-
rand: Scaling byzantine agreements for cryptocurrencies. IACR Cryptology ePrint Archive,
2017:454, 2017.

[8] Steven Gjerstad and John Dickhaut. Price formation in double auctions. Games and Eco-

nomic Behavior, 22:1–29, 1998.

[9] Dhananjay K. Gode and Shyam Sunder. Allocative efﬁciency of markets with zero-
intelligence traders: Market as a partial substitute for individual rationality. Journal of Polit-
ical Economy, 101(1):19–137, 1993.

[10] Joseba Jimeno, Jon Anduaga, Jos´e Oyarzabal, and Asier Gil de Muro. Architecture of a
microgrid energy management system. European Transactions on Electrical Power, 21(2):
1142–1158, 2011.

[11] Aggelos Kiayias, Alexander Russell, Bernardo David, and Roman Oliynykov. Ouroboros: A
provably secure proof-of-stake blockchain protocol. In Advances in Cryptology - CRYPTO
2017 - 37th Annual International Cryptology Conference, Santa Barbara, CA, USA, August
20-24, 2017, Proceedings, Part I, pages 357–388, 2017.

[12] GeunYoung Kim, Junhoo Park, and Jaecheol Ryou. A study on utilization of blockchain for
electricity trading in microgrid. In 2018 IEEE International Conference on Big Data and
Smart Computing (BigComp), 2018.

[13] Fengji Luo, Zhao Yang Dong, Gaoqi Liang, Junichi Murata, and Zhao Xu. A distributed
electricity trading system in active distribution networks based on multi-agent coalition and
blockchain. IEEE Transactions on Power Systems, 34(5):4097–4108, 2019.

[14] Indrani Maity and Shrisha Rao. Simulation and pricing mechanism analysis of a solar-

powered electrical microgrid. IEEE Systems Journal, 4(3):275–284, 2010.

[15] Indrani Maity and Shrisha Rao. Simulation and pricing mechanism analysis of a solar-

powered electrical microgrid. IEEE Systems Journal, 4(3):275–284, 2010.

[16] Lubna Mariam, Malabika Basu, and Michael F. Conlon. A review of existing microgrid

architectures. Journal of Engineering, 2013:1–8, 2013.

[17] Lubna Mariam, Malabika Basu, and Michael F. Conlon. Microgrid: Architecture, policy
and future trends. Renewable and Sustainable Energy Reviews, 64(C):477–489, 2016. doi:
10.1016/j.rser.2016.06.03.

[18] Esther Mengelkamp, Johannes G¨arttner, Kerstin Rock, Scott Kessler, Lawrence Orsini, and
Christof Weinhardt. Designing microgrid energy markets: A case study: The brooklyn mi-
crogrid. Applied Energy, 210:870 – 880, 2018.

[19] Satoshi Nakamoto.

Bitcoin: A peer-to-peer

electronic

cash

system.

https://bitcoin.org/bitcoin.pdf, 2008.

15

[20] Pecan street. Pecan street. https://www.pecanstreet.org, Retrieved in June 2020.

[21] Power Ledger Pty Ltd. Power ledger white paper. https://cdn2.hubspot.net/hubfs/4519667/

Documents\%20/Power%20Ledger%20Whitepaper.pdf, 2018.

[22] Dan Rastler. Electric energy storage systems for the electric enterprise trends and opportuni-

ties. Future of Energy Summit, Toronto, Canada, 2012.

[23] Moein Sabounchi and Jin Wei. Towards resilient networked microgrids: Blockchain-enabled
peer-to-peer electricity trading mechanism. In 2017 IEEE Conference on Energy Internet and
Energy System Integration (EI2), 2017.

[24] Erel Segal-Halevi, Avinatan Hassidim, and Yonatan Aumann. MUDA: A truthful multi-
unit double-auction mechanism. In Proceedings of the Thirty-Second AAAI Conference on
Artiﬁcial Intelligence, (AAAI-18), the 30th innovative Applications of Artiﬁcial Intelligence
(IAAI-18), and the 8th AAAI Symposium on Educational Advances in Artiﬁcial Intelligence
(EAAI-18), New Orleans, Louisiana, USA, February 2-7, 2018, pages 1193–1201, 2018.

[25] Arup Sinha, Rabindranath Lahiri, Somenath Byabortta, Shyamapada Chowdhury, Sunetra
Chowdhury, and Peter Crussley. Formulation of pricing mechanism for microgrid energy. In
CIRED Seminar 2008: SmartGrids for Distribution, 2008.

[26] U.S. Department

of Energy.

National

renewable

energy

laboratory

(nrel).

https://www.nrel.gov.

[27] Gavin Wood. Ethereum: A secure decentralised generalised transaction ledger byzantium

version. https://ethereum.github.io/yellowpaper/paper.pdf, 2019.

16

