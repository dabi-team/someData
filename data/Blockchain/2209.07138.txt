IEEE TRANSACTIONS SUBMISSION

1

Self-Healing Secure Blockchain Framework in
Microgrids

Suman Rath, Graduate Student Member, IEEE, Lam Duc Nguyen, Member, IEEE,

Subham Sahoo, Member, IEEE, and Petar Popovski, Fellow, IEEE

2
2
0
2

p
e
S
5
1

]

R
C
.
s
c
[

1
v
8
3
1
7
0
.
9
0
2
2
:
v
i
X
r
a

Abstract—Blockchain has recently been depicted as a secure
protocol
for information exchange in cyber-physical micro-
grids. However, it is still found vulnerable against consensus-
manipulation attacks. These stealth attacks are often difﬁcult
to detect as they use kernel-level access to mask their actions.
In this paper, we ﬁrstly build a trusted and secured peer-to-
peer network mechanism for physical DC microgrids’ validation
of transactions over Distributed Ledger. Secondly, we leverage
from a physics-informed approach for detecting malware-infected
nodes and then recovering from these stealth attacks using
a self-healing recovery scheme augmented into the microgrid
Blockchain network. This scheme allows compromised nodes
to adapt to a reconstructed trustworthy signal in a multi-hop
manner using corresponding measurements from the reliable
nodes in the network. This supplements the capabilities of
Blockchain enabling it to detect and mitigate consensus manip-
ulation attempts.

Index Terms—Blockchain, Microgrids, Cybersecurity, Self-

Healing Mechanism.

I. INTRODUCTION

T HE rapid development of DC microgrids can be as-

cribed to their high ﬂexibility in integrating renewable
energy sources, storage devices and modern electronic loads
in both grid-connected and autonomous modes of operation.
In this regard, distributed control structure has been trending
for microgrids as they facilitate scalability, reliability and
automation in contrast to the centralized controllers, which are
highly vulnerable to single-point-of-failure [1]. Moreover, they
ensure robust performance under cyber imperfections such as
communication delays, link failures and data packet losses.
However, this coordination philosophy can not be designated
to be fully reliable owing to the partial availability of informa-
tion of only neighboring units. This increases the vulnerability
of microgrids to illegitimate sensors and actuators tampering
in the form of cyber attacks [2]. As microgrids are a key
component of mission-critical applications such as military
bases, hospitals, and industrial plants, it is crucial to ensure
their security against adversarial attacks.

In this regard, as the energy sector needs signiﬁcant time
reduction for the management of economic transactions and
the possibility to get rid of third-party authorities [3], the

Suman Rath is with the Department of Computer Science and Engineering,
University of Nevada, Reno, NV 89557, USA (e-mail: srath@nevada.unr.edu)
Lam Duc Nguyen is with Software Systems Research Group, CSIRO’s

Data61, Sydney 2015, Australia. (e-mail: lam.nguyen@data61.csiro.au)

Subham Sahoo is with the Department of Energy, Aalborg University, 9220

Aalborg, Denmark (e-mail: sssa@et.aau.dk).

Petar Popovski is with the Department of Electronic Systems, Aalborg

University, 9220 Aalborg, Denmark. (e-mail:petarp@es.aau.dk)

concept of transactive energy has appeared as one of the
most interesting technologies since the 2017 Gartner Hype
cycle [4]. Any need for an intermediary between two parties
is removed: switching to a decentralized energy system, and
detaching the related ﬁnancial transactions from a centralized
control unit, can be considered as disruptive steps toward a full
decentralization [5]. For example, the authors in [6] proposed
the Blockchain as a distributed tool that goes beyond the eco-
nomic aspects of energy transactions and can be used to make
distributed decisions for technical operations in microgrids. In
particular, the proposed study focuses on the issue of energy
losses tracking and attribution during the energy transaction
and shows that including losses in the Blockchain changes the
timing of information gathering and the role of prosumers and
distributors dramatically.

Networked microgrids, operating as independent agents
or functioning collaboratively, may also complicate distribu-
tion system operations. Conventionally, through supervisory
control and data acquisition (SCADA), microgrids are often
controlled in a centralized manner [7]. In particular,
the
network data is gathered, recorded, and then processed at a
centralized server. Considering the increasing speed and size of
the measurement data, collecting and processing such a wide-
range network in real-time at a single server leads to overload
for the centralized node and a single point of failure problem.
In contrast, attacking a distributed network is more challenging
for attackers, especially for the power grid that is distributed
over a geographically wide-range area. Hence, the computation
and the trust is distributed over the network, which can be
useful for achieving a more secure power network.

The Blockchain is a type of distributed ledger technology
(DLT) that contains a continuously growing list of data records
called blocks [8]. Blocks can contain different types of trans-
actions, for example, ﬁnancial, energy, transportation, data, or
even logic and programs. Blocks are timestamped, unalter-
able, veriﬁable, and connected in a chronological (chained)
sequence. Every DLT node maintains a copy of the Blockchain
and any modiﬁcation of blocks content or order is immediately
revealed by a fast check on block validity. Blockchain sup-
ports immutable and transparent information sharing among
involved untrusted parties [9]. Outside of its role in ﬁnancial
transactions, DLTs1 are seen as a key enabler for trusted
and reliable distributed monitoring systems. The authentication

1The terms DLT and Blockchain will be used interchangeably throughout
this paper. Blockchains are a type of DLT, where chains of blocks are made up
of digital pieces of information called transactions and every node maintains
a copy of the ledger.

 
 
 
 
 
 
IEEE TRANSACTIONS SUBMISSION

2

process for DLTs relies on consensus among multiple nodes in
the network. Blockchain technology is a promising innovation,
which can be used in different microgrid areas.

Probably, the most popular use case application is peer-
to-peer (P2P) trading, where the Blockchain enables energy
trading between peers in a secure way [10].The authors in [11]
have discussed a Blockchain-based scheme for secure energy
transactions. In conventional Blockchain-based schemes, the
trustworthiness of each block is decided through a consensus-
based mechanism where the majority of nodes in the system
must agree on its validity. Such schemes are often vulnerable
to 51% attacks [12]. In general, 51% attacks refer to an
attack strategy where the hacker can access the system’s
internal mining capabilities and use this access to mine com-
promised blocks. Further, this access is also used to manipulate
the consensus-based validation strategy by forcing individual
nodes to stop the conﬁrmation of authentic blocks and/or
make them validate fabricated blocks generated by the attacker
itself. 51% attacks can be executed using stealthy, kernel-level
malware like rootkits [13].

Although the Blockchain being used in many power elec-
tronic applications, it is also essential to evaluate whether
Blockchain could be a feasible tool for exchanging volt-
age/frequency control signals in the microgrid test sys-
tem. This evaluation is essential because, even though the
Blockchain is an essential tool for cyber-secure control, the
time delay created as a consequence of mining new blocks may
have a detrimental effect on microgrid stability [14]. Mahmud
et al. in [15] have proposed the use of Blockchain for control
in microgrids with distributed energy resources and presented
results showing that the proposed framework can perform well
even under time delays. However, the current studies have not
addressed how to prevent stealth & hijacking attacks in their
proposed control mechanism.

The conventional control framework in cyber-physical mi-
crogrids critically rely on a centralized database and com-
munication channels, both of which are vulnerable to ad-
versaries to manipulate the system operation. An effective
solution for countermeasures is the detection and mitigation
of such threats. However, mitigation techniques may be vul-
nerable to adversarial attacks designed with knowledge of the
system dynamics (e.g. adversarial attacks on learning-based
anomaly detectors, reward poisoning attacks against reinforce-
ment learning, etc). Hence, a signiﬁcantly better approach
is the prevention from these threats in the ﬁrst stage itself.
Since the DLT technology offers great potential due to its
advanced data protection and attack prevention capabilities
based on the natural security strength of the cryptographic
system and consensus mechanism [16], we propose to augment
these salient features of the DLT into the physical dynamic
properties of microgrids to enhance its resiliency against
cyber-attacks (along with physics-informed attack detection
metrics to identify any type of consensus-manipulating attack
vector that tries to inject false data into the network). To
recover from such attacks upon detection, we introduce a self-
healing recovery mechanism for Blockchain-based microgrids
that: i) provides a transparency and immutability microgrids
system; ii) addresses the garbage-in garbage-out problem of

the current Blockchain-based systems.

To summarize the key features, the contributions of this

paper are as follows:

• Firstly, we formulate a general model of a DLT-based
transactive DC microgrid system, which include both
infrastructure and security mechanism.
• Secondly, we evaluate the response of

the general
Blockchain model
to stealth attacks and propose the
addition of new physics-informed detection metrics based
on the secondary control dynamics of each node to
identify such attacks and alleviate the detection accuracy
of DLT.

• Finally, we also present a self-healing recovery mech-
anism the form of a reconstructed signal to compensate
for any compromised data/signal at any node. This recov-
ery mechanism is independent of the physical topology
of multiple converters, and will always provide system
resiliency, provided at least one node in the network is
trustworthy.

this paper

The remainder of

is organized as follows.
In Section II, we introduce the background knowledge of
DLTs/Blockchain and the integration of Blockchain into mi-
crogrids. Section III highlights the operating principles and se-
curity issues in cyber-physical microgrids. Section IV presents
the Blockchain-based strategy adopted for cyber-secure control
in DC microgrid. The effectiveness and robustness of the
proposed strategy to illustrate its resilient behavior under dif-
ferent attack scenarios and physical topologies of microgrids
is presented in Section V. Finally, Section VI presents the
conclusion of the paper.

II. BACKGROUND

A. DLTs/Blockchain Concept

A DLT system offers a tamper-proof ledger that is dis-
tributed on a collection of communicating nodes, all sharing
the same initial block of information, commonly termed as
the genesis block [17]. To publish data to the ledger, a node
includes data formatted in transactions in a block with a
pointer to its previous block, which creates a chain of blocks,
the so-called Blockchain. A block generated by a node usually
needs to solve a mathematical crypto-puzzle [18] and gives the
solution as a proof of its workload to get a reward. This process
is called mining. The difﬁculty of the crypto-puzzle is adjusted
based on the total computational power or mining power of
the network. Each correctly behaving miner must adhere to
the same protocol for creating and validating new blocks.
After successfully mining a block, a miner broadcasts it for
validation. Each transaction recorded in the distributed ledger
is essentially immutable since each DLT node in the network
keeps all the committed transactions in the ledger [17]. In
addition, cryptography mechanisms e.g, hash functions, asym-
metric encryption algorithms, and digital signatures, guarantee
the integrity of data blocks in the DLTs. Therefore, the DLTs
can ensure non-repudiation of transactions. Moreover, each
transaction is historically timestamped and identiﬁed, making
it traceable to every user. As shown in Fig. 1, the life cycle
of a transaction in DLT-based networks is described in detail.

IEEE TRANSACTIONS SUBMISSION

3

Blockchain clients, e.g, physical devices, and home alliances
generate or collect data and form it into Blockchain transaction
format [19]. The transactions are then arranged into blocks
and are veriﬁed through the mining process running on peers.
Finally, the transactions are recorded immutably in distributed
ledger and can be queried by clients.

B. Cyber Attacks on Microgrids

Blockchain is considered a typical distributed data stor-
age technology and covers a variety of technologies, for
example, cryptography, distributed consensus algorithms, and
decentralization. Due to the advantage of establishing secured,
trusted, and decentralized autonomous ecosystems for various
scenarios, Blockchain has been investigated in both research
and applications [20]. As a novel and fundamental technical
aspect, Blockchain is suitable for cyber-physical systems’
security protection (CPSs) applications.

Recent cyber attacks against critical physical systems, for
example, the attacks on the Ukrainian power grid in 2015-2016
have motivated multiple studies on security and privacy aspects
for cyber-physical systems, in particular, the power grid [21].
false data
The works in [22] and [23] demonstrated that
injection (FDI) can inject data measurements to induce error in
the operation of power system. A malicious attacker can also
make an effect to forecast systems, which are used to plan
the operation and activities of power systems by exploiting
vulnerabilities of artiﬁcial intelligence models [24]. In general,
FDI attacks need to gather information about the current state
of the system or the models used for making decisions, for
example, the state of the system, topology structure or machine
learning prediction models [25].

Besides,

the attacker also exploits the lack of security
mechanisms of embedded IoT sensors to affect the operation
of power grid systems [26]. The target of adversaries could
be embedded sensors such as environmental sensors, smart
meters, appliances or end-user systems to affect the power
systems. The authors in [27] introduced a novel form of attack
named manipulation of demand via IoT and documented that
if an attacker compromised thousands of nodes, they could
including line
cause various problems to the power grid,
failures, frequency instabilities, and increased operating costs.
In another aspect, the adversaries can compromise IoT devices
responsible for communicating or exchanging data and pay-
ments with other power systems by changing their bids [28].
In the scope of this work, we propose to augment the physical
properties, dynamics and principles of microgrid operation into
Blockchain-based attack detection and mitigation.

III. CYBER-PHYSICAL MICROGRIDS

A. Operating Principle

An exemplary autonomous DC microgrid considered in this
work is shown in Fig. 2. N = 4 DC sources connected via
DC/DC buck converters of equal power rating are intercon-
nected to each other via tie-lines forming the physical layer of
the microgrid. Each converter is operated in voltage-controlled
mode. Cooperative secondary controllers are employed to
improve current sharing performance and voltage regulation

Fig. 1. Schematic of DLT-based network

of these sources. These controllers are made possible using
a distributed communication layer, which shares information
only between the neighboring units. Each unit, represented
as an agent
in the cyber layer, sends and receives xj =
{ ¯Vj, I pu
j } from the neighboring agent(s) to achieve secondary
control objectives namely, average voltage regulation and
proportionate current sharing, where ¯Vj and I pu
denote the
j
average voltage estimate and per unit output current of the
neighboring agents, respectively.

Each agent is represented via a node, and a communication
digraph is represented via edges. They constitute an adjacency
matrix A = [akj] ∈ RN ×N , where the communication
weights are given by: akj > 0, if (ψk, ψj) ∈ E, where E
is an edge connecting two nodes, with ψk and ψj being the
local and neighboring node, respectively. Otherwise, akj = 0.
Further, the incoming cyber information matrix can be denoted
by Zin = (cid:80)
i∈N akj. Hence, if A and Zin match each other,
the Laplacian matrix L is balanced, where L = Zin − A.

Using the preliminaries of the communication graph, the
local control input of the cooperative secondary controller can
be written as:

(1)

uk(t) =

(cid:88)

j(cid:15)Mk

aij(xj(t) − xk(t))
(cid:125)
(cid:123)(cid:122)
(cid:124)
ek(t)
k , eI

k , uI

k}, ek = {eV

k}, respectively as per the

where, uk = {uV
elements in x and Mk is the set of neighbors of kth agent.
Remark I: As per the synchronization law [29], all the agents
participating in distributed control will achieve consensus
using ˙x = −Lx for a well-spanned Laplacian matrix L such
that
xk(t) = c, ∀ k ∈ N , where c is the steady-state
reference and N is the number of agents.

lim
t→∞

Using (1), the control inputs to achieve average voltage
regulation and proportionate current sharing can be obtained
from secondary sublayer I and II respectively by using the
following voltage correction terms for kth agent:
Sublayer I: ∆V1k = H1(s)(Vref − ¯Vk)
Sublayer II: ∆V2k = H2(s)(Iref − uI
k)

(2)

(3)

<code><code><code>PPPCTransactionsPrev-hashdata-hashblock headerContract codeTransactions123peerDLT-basedNetworkclientDistributed LedgerIEEE TRANSACTIONS SUBMISSION

4

TABLE I
STEALTH ATTACKS IN DC MICROGRIDS IN [2] AND [30]

TABLE II
DETECTION CRITERIA FOR STEALTH ATTACKS IN TABLE I

Affected Counterparts

Modeling

Voltage [2]

Current [30]

WxV
WxI

attack = 0
attack = 0

Fig. 2. Networked DC microgrid with N = 4 distributed generations (DGs)
operating with a cooperative ring-based cyber graph.

0

(cid:80)

j∈Mk

where, ¯Vk = Vk + (cid:82) τ
uV
k dτ , while H1(s), H2(s) are
PI controllers. Further, Vref & Iref are the global reference
voltage and current quantities for all the agents, respectively. It
should be noted that Iref = 0 for proportionate current sharing
between the agents. The correction terms obtained in (2)-(3)
are ﬁnally added to the global reference voltage to achieve
local voltage references for kth agent using:

V k
ref = Vref + ∆V1k + ∆V2k .
Using (4) as the local voltage reference for kth agent, the

(4)

abovementioned secondary objectives are met.

Using the distributed consensus algorithm for a well-
connected cyber graph in a DC microgrid, the system objec-
tives for DC microgrids using (1)-(4) shall converge to:

¯Vk(t) = Vref ,

lim
t→∞

lim
t→∞

uI
k(t) = 0 ∀ k ∈ N.

(5)

B. Cybersecurity Issues

As shown in Fig. 2, cyber attackers may inject unknown
exogenous signals in many ways such as the injection of false
data into the controllers, sensors, communication links, etc.
to disrupt the system objectives in (5). These attacks can
be conducted in a coordinated manner to deceive the system
operator in the presence of any such attack elements using the
following modiﬁed inputs in (1), given by:

ua(t) = Lx(t) + Wxattack

(6)

where, ua, x and xattack denote the vector representation of
the attacked control input ua
k = {uV a
k }, the states and the
attack elements xattacki = [xV
]T , respectively.
attackk
attackk
Further, W = [wkj] denotes a row-stochastic matrix with its
elements given by:



k , uIa
, xI

wkj =

1
Mk+1 , j ∈ Mk
1 − (cid:80)
j(cid:15)Mk
0, j (cid:54)∈ Mk, j (cid:54)= k



wkj, j = k

(7)

Stealth Attack

Detection Criteria for kth Agent

Terminology

Voltage [2]

Current [30]

1[(cid:80)

hk
[(cid:80)
j(cid:15)Mi
ck[(cid:80)

[(cid:80)

akj (∆V1j − ∆V1k )]
j(cid:15)Mk
akj (∆V1j + ∆V1k )] > Υ1
)]

akj (I j

− I k

inref

inref
)] > Υ2

+ I k

inref

j(cid:15)Mk
akj (I j

DM k
1

2

DM k
2

j(cid:15)Mk
1 hk is a positive quantity used for ith agent.
2 ck, I k

inref

inref
kth agent.

denote a positive quantity and the input current reference for

The detection strategies for both the stealth attacks in Table I,
have been provided in Table II. More details on its formulation
can be referred from [2] and [30]. As it can be seen in Table II
that the detection strategies for both stealth attacks primarily
depend on local as well as neighboring measurements, this
leaves a tactical opportunity for an attacker to inﬁltrate the
communicated measurements used for the design of the de-
tection strategies. As a result, such consecutive intrusion may
affect the detectability of these attacks when the criteria in
Table II are not met.

2 and DM 3

To provide a clear understanding, a case study is carried
in a DC microgrid with N = 4 agents in Fig. 4 to
out
demonstrate the performance of detection criteria for a stealth
attack on voltages and currents, respectively. In Fig. 4, after
the stealth attack is initiated on currents, it can be seen that
the output currents of each agent are anyway shared equally.
However, the detection mechanism for current measurements
suggests that DM 1
2 are positive, which indicate
compromised current measurements for agent I and III. Further
at t = 4 sec, a balanced set of attack elements {-15, 0, 15,
0} V are injected into the voltage control
inputs in Fig.
4 as per the attack model in [2]. Despite the presence of
attack elements, the voltages return back to pre-attack set-
points. However, the corresponding detection metric DM1
for agent I and II immediately goes positive. Under these
circumstances, if the communicated measurements xj(t) in
(1) are manipulated by the cyber-attacker with considerable
knowledge of the detection strategy, there is a possibility that
the cyber attack alarm might be disinformed. This mandates
a secure mechanism of information exchange between each
agents so that the communicated variables used in the pro-
posed detection approach remain uncompromised. Following
an accurate scanning of the compromised measurement, the
corresponding countermeasures can be applied without any
false alarms.

IV. BLOCKCHAIN FOR SECURITY OF MICROGRIDS

In this section, we present our self-healing Blockchain-
based communication model for the cyber-physical microgrid
shown in Fig. 2. We propose a distributed DLT, where the
nodes can communicate and collaborate to identify attacked
counterpart(s) in a reliable and trustworthy manner. The DLT-
based network consists of nodes connected via the P2P model.
Basically, nodes connect using a unique address and use the
to exchange network information such as
gossip protocol

= = = = = = DG 1Vk= = = = = = IkRcPhysical LayerCyber LayerSecondary ControllerVoltage & Current LoopPWM1234R1R2R3R4R5R6R7R8R9R101243IEEE TRANSACTIONS SUBMISSION

5

Fig. 3. Distributed controller for microgrids under consideration in kth DG.

Fig. 4. Performance of detection strategies in response to stealth attack on
current and voltages at t = 1-2 sec and 4 sec, respectively – the detection
strategies can further be manipulated.

blocks, transactions, and addresses. In DLT-based networks,
there are speciﬁc nodes called miners responsible for ex-
tending the Blockchain by creating new blocks [5]. In the
scope of this research, each node collects and analyzes the
sensor measurement in its area, estimates the local update and
exchange information with other nodes, participates in dis-
tributed consensus procedures, and publishes to the distributed
ledger in its local memory.

A. System Model

We

consider

the DLT-based microgrid system with
M communication channels and N physical agents. As
the system states have already been deﬁned xi(t) =
{Vk(t), Ik(t), DetVk(t − 1), DetIk(t − 1)} in Table II. The
measurements yi(t) = {Vk(t), Ik(t), DetVk(t − 1), DetIk(t −
1)} can be measured from every agent. The microgrid is
modeled as a discrete-time linear dynamic system, as given
below:

xt = Axt1 + vt

yt = Hxt + wt

(8)

(9)

where A ∈ R(2N −1)×(2N −1)
is the state transition ma-
trix, H ∈ RK×2N −1 is the measurement matrix, vt =

[v1,t, ..., v2N −1,t]T is the process noise vector and wt =
[w1,t, ..., wK,t]T is the measurement noise vector. We assume
that vt and wt are independent AWGN process, where vt ∼
(0, σ2, I2N −1) and wt ∼ N (0, σ2

wIK).

the physical agent measurement

For a secure and reliable state update among DLT-based
nodes, we need to guarantee that the previous state estimate
are not modiﬁed,
is not
anomalous, and the DLT nodes are working according to the
predeﬁned agreements. In case the network is attacked, the
state estimates can be recovered using the previous reliable
state estimations that require us to also protect the previous
state estimate against tampering. On one hand, in a DLT-
based network, malicious adversaries can obtain illegitimate
access to the system, for example, via trojan propagation,
stealing the identity of involved nodes, leading the nodes to
get faulty updates during the operation of the system. On the
other hand, as the characteristic of DLT is fully distributed,
there is no single centralized trusted entity to take control
and check whether other nodes are trusted and safe, e.g, the
involved nodes are operating as the pre-deﬁned roles. Hence,
a distributed authentication mechanism is needed to detect
misbehavior nodes.

B. Detection Model

In a DLT-based microgrid network, even though the whole
system is fully distributed, attackers can still manipulate the
system dynamics if they can achieve control of the majority of
the individual nodes, which gives them access of more than
half of the hashing/computational power. This scenario can
be used to manipulate consensual query decisions to inject
false data into sensors/communication links in the system
[12], [23]. In certain cases, the attackers may also create a
fork, extracting speciﬁc transactions, tampering with them,
and injecting them back as True packets. Since these attack
vectors were designed to prey on the vulnerability of the
conventional DLT framework, we integrate system-speciﬁc
knowledge into the DLT setup enabling it to recognize vio-
lations in microgrid dynamics to identify false data disrupt-
ing the secondary controller synchronization among nodes.
The generated data from individual nodes are formatted in
Blockchain-based transactions and synchronized among them.
The detection criteria as mentioned in Table II are in the
form of mismatch error margins (represented by the metric
DM k) between parameter data (measurements) from the dis-
tributed nodes. When an attack vector stealthily manipulates
transactions, the detection metric DM k increases beyond the

Voltage Observer Power SharingH1(s)H2(s)Cyber Layer()jdVt−()jdIt−()kVtrefV()IkutGv(s)()kVtGI(s)PWM= = = = = = DG k()kIt()krefItIEEE TRANSACTIONS SUBMISSION

6

Fig. 5. Distributed Ledger and structure of b block at time t. Note that bt is
the block generated at time t and hash of the SHA H(.) algorithm. The block
includes a block header and body of the local state vectors in corresponding
time.

threshold value Υ predeﬁned in the smart contract, enabling
autonomous attack detection using the physics-informed attack
detection metrics in Table II. A more elaborate explanation
of the integrated setup including the self-healing process is
depicted in the next subsection.

C. Self-healing recovery

The self-healing process designed to enable recovery of
compromised nodes in the DLT-microgrid framework is part
of an integrated setup including both attack detection and mit-
igation. Any transaction performed by a node, leading to the
generation of a new block of data is broadcast to the rest of the
network through a secure sharing scheme. The network uses
the recipient node’s ability to validate transactions using digital
signatures in order to detect any malicious data in the system.
This process is carried out using determination of events,
when an external agent attempts data alteration, leading to
a modiﬁcation of the hash index associated with the detection
metrics in the corresponding block. All subsequent changes
lead to further variation in the computed hash index, which
is detected by the recipient node through comparison with the
last trustworthy block received. In the event of a mismatch,
the recipient queries the rest of the nodes for veriﬁcation. As
shown in Fig. 5, any hash which is declared False by the
majority of the nodes is considered to be associated with a
manipulated block of data and hence, rejected by the receiver.
Thus, the general anomaly detection framework is based upon
a mutual trust-based structure where a block is acceptable, if
and only if it satisﬁes the following criteria:

Na > Nr

(10)

where, Na represents the number of approving nodes, and
Nr is the number of rejecting nodes. Since this framework
is vulnerable to consensus-deceiving hijacking attacks, an
additional set of detection criteria as depicted in Table II
is deﬁned using smart contracts and utilized to detect such
deceptive attacks. Any event resulting in the violation of the
detection criterion in Table II leads to the labeling of the agent
as a misbehaving node.

Fig. 6. Self-healing recovery scheme augmented into DLTs for microgrids
– the detection metrics in Table II initiate the reconstruction process using
trustworthy measurements from neighbors and then self-heal the system by
transmitting back the reconstructed signal I R

1 (ti).

Detection of a misbehaving node triggers the activation of

a self-healing strategy where:

1) ﬁrstly, the compromised transaction is canceled, stop-
ping further communication of any manipulated signal
to neighboring nodes to limit the attack propagation.
2) secondly, the malicious transaction is not recorded in
the ledger and a trustworthy version of the manipu-
lated signal is reconstructed for each compromised node
(using pseudo-anonymous values of trustworthy sensor
data stored in the irreversible ledger), to preserve system
stability. This has been shown in Fig. 6.

3) ﬁnally, this trustworthy event-driven signal is sampled
from measurements of the neighboring nodes (detailed
philosophy can be found in [31]-[32]) and previous
measurements from the same node obtained from the
ledger as per the following equations:

∆V1j (ti) = f1(∆V1k (t), ∆V1j (ti−1))

(11)

∆Idcj (ti) = f2(∆Idck (t), ∆Idcj (ti−1))

(12)

the next

triggering event. Hence,

where, i represents the instant at which the event occurs (also
called the triggering instant) and f (◦) represents the triggering
function as per which the reconstruction is performed. A
major role of f (◦) is to hold the input value of the signal
the recipient node
until
is operated in a localized manner with no communication
inputs from the malicious node. Ultimately, all the manipulated
blocks are substituted with event-driven, secure reconstructed
blocks. This strategy is followed for the reconstruction of
the manipulated signal(s) at each compromised node. The
presence of the terms, ∆V1k (t) and ∆Idck (t) in (11) and
(12) imply that the trustworthy reconstruction of a manipulated
signal will always be possible if at least one of the nodes (here,
represented as the kth node) is reliable (i.e., not affected by the

 TimeStamp Nonce, Merkle Tree, etc...Accepted BlocksBlocks with invalid hashes queried and rejected1432TTTFFTDMHold-ϒ ϒ 1432TTTTTTDetectRepairRecoverIEEE TRANSACTIONS SUBMISSION

7

Fig. 8.
Performance of the self-healing recovery scheme in DLT-based
microgrids when the current of agent I is compromised – in 0.15 sec, the
reconstructed signal from an agent I is re-transmitted back to its neighbors
by retaining the system stability.

Fig. 7. Performance comparison of the microgrid-Blockchain network with
and without additional fortiﬁcations as depicted in Table II. The conventional
Blockchain fails to identify controller-level manipulations and accepts the
attacker’s manipulations as true data.

attack). In an event where even the kth node is infected (i.e.,
100% infection), the mitigation strategy will fail to reconstruct
a trustworthy version of the signal. Hence, the resiliency scale
of the proposed self-healing recovery scheme can be given
by N − 1, with N given by the number of converters in the
system. In simple terms, the above sentence implies that in
a system comprising of N nodes, the proposed scheme will
always provide secure and resilient behavior, even if there is
only one trustworthy node to broadcast its information to self-
heal the system.

V. PERFORMANCE ANALYSIS & RESULTS

To demonstrate the action of the supplementary detection
metric, we validate our results on the considered system in Fig.
2. The system and control parameters used for the simulation
studies can be found in Appendix. In the ﬁrst case study, Fig.
7 presents the magnitude of current signals in a DC microgrid
with N = 4 agents (as shown in Fig. 2), where a malicious
hacker with controller level access executes various types of
consensus-disrupting attacks to perform: (i) hijacking, and
(ii) false data injection. To perform the hijacking attack, the
perpetrator interrupts the communication between a claimant
(here, an incoming block of data) and the veriﬁer (here, one
or more nodes in the Blockchain network) in order to change
the authentication decision. Thus, it cons the recipient into
believing that a malicious, foreign block is authentic. For the
false data injection attack, the attacker internally overwrites

Fig. 9. Performance of the self-healing recovery scheme under cyber attacks
on N −1 converters – the system is able to heal only from a single trustworthy
agent 3.

any unfavorable decision from the veriﬁer to mask malicious
injections into the communication channel. Clearly, the non-
detection of such consensus-manipulating attacks can have
negative repercussions on the system. However, as shown
in 7, a Blockchain network fortiﬁed with the proposed set
of detection metrics in Table II can immediately recognize
the presence of attack elements in the compromised nodes
and hence, effectively negate their actions (through signal
reconstruction).

To explain the working mechanism of the proposed self-
healing strategy in Fig. 6, we have considered an adversarial
situation in the same system, where the attacker has access to
the current of agent 1. Fig. 8 shows the proposed self-healing
blockchain based attack detection and mitigation procedure
under this scenario. Once DM 1
2 detect the presence of attack

(a)(b)(c)0123Time (sec)11.52Currents (A)I1 [T]I2 [T]I3 [T]I4 [T]11.11.21.311.52Hijacking Attack inAgent 12121FTTT2134FT0123Time (sec)22.53Currents (A)I1I2I3I411.11.21.322.53Hijacking Attack inAgent 1, 2 & 4TFFF2134FTFTTT2134TTIEEE TRANSACTIONS SUBMISSION

8

rameters of the system shown in Fig. 10 can be found in
Appendix. From Fig. 10, it can be clearly established that
the performance of the proposed self-healing strategy remains
unaltered with respect to any physical network topology or
systems exhibiting different dynamics. This can be attributed
to the robust physics-informed detection strcuture in Table II,
that are independent of structural and temporal dependencies.
Based on that, it can be seen that the proposed detection and
mitigation strategy augmented into DLT provides resiliency
immediately against stealth attacks injected into agent 2 at t =
1 sec. Hence, the security boundaries of DLT is signiﬁcantly
enhanced due to the augmentation of the physics-informed
detection metrics and self-healing mitigation strategy for net-
worked microgrids.

VI. CONCLUSION

This paper presents a strategy to fortify DC microgrids
against potential cyber-attacks through a Blockchain-based
approach. The proposed strategy uses a consensus-based veriﬁ-
cation technique to determine the authenticity of blocks where
the majority of the nodes must agree upon the validity of
their hash indices for them to be accepted by the recipient
node. However, this veriﬁcation technique may be vulnerable
to hijacking attacks, wherein an attacker uses its system-level
access to mine malicious, new blocks and fool the recipients
into believing their authenticity. Moreover, this access can also
be used to fake the consent of the nodes for rejecting authentic
blocks or accepting fake blocks. To remove this limitation,
this paper combines the general features of the Blockchain
with unique physics-informed attack detection metrics to de-
tect these attacks and trigger mitigation in their presence.
This detection strategy is in the form of a series of rules
(threshold criteria) which when violated, lead to alteration of
a detection metric, signifying attack detection. Detection of
any false block in the network leads to its immediate rejection
by the recipient. It triggers the activation of a self-healing
strategy, where the lost signal/data-point is reconstructed by
obtaining previous values of the same signal and current values
of neighboring measurements (i.e., sensor inputs from other
nodes) from the ledger. This leads to the preservation of system
stability even under adverse scenario, provided that at least one
node in the network is trustworthy). Clearly, a major limitation
of the mitigation method proposed in this paper would be
its inability to reconstruct a trustworthy version of the signal
if all nodes are attacked simultaneously. Hence, we plan to
extend this aspect as a future scope of work by overcoming
this limitation and provide full resiliency.

APPENDIX

System & Control Parameters of System in Fig. 2

In Fig. 2, it is to be noted that four converters (each of
10 kW) are connected to each other through tie-lines Ri.
Moreover, the controller gains are identical for each converter.
Plant: R1 = 1.5 Ω, R2 = 1.2 Ω, R3 = 0.8 Ω, R4 = 0.3 Ω, R5
= 0.5 Ω, R6 = 0.6 Ω, R7 = 0.45 Ω, R8 = 0.4 Ω, R9 = 0.4 Ω,
R10 = 0.6 Ω
Converter: Lsei= 3 mH, Cdci= 250 µF, Idcmin = 0 A, Idcmax

Fig. 10. Performance of the self-healing mechanism being independent of
the physical parameters of the shown microgrid, where the line resistances
and number of converters are different from Fig. 2 – the system resiliency is
still intact under cyber attacks.

elements in agent I, the mitigation mechanism is immediately
triggered, which traces a trustworthy current signal from agent
2, as shown in Fig. 8. After acquiring the trustworthy current
signal from agent 2, the signal reconstruction is performed
to replace the attacked I1(t) with a trustworthy event-driven
signal I1(tk). As shown in Fig. 8, after the highlight event-
driven signal is replaced, its communication to neighbors is
resumed after validation process from DLT in 0.15 sec. In
this way, the considered system operates normally even under
hijacking attack in one of the agents without causing any
power interruption.

To evaluate the N − 1 resiliency scale of the proposed self-
healing strategy, we have also considered additional adver-
sarial situation in Fig. 9, where the attacker has access to
3 nodes out of 4 agents. In this scenario, we anticipate that
the only trustworthy agent III will self-heal the system by
broadcasting its trustworthy information in a step-wise manner.
When currents of agent 1, 2 and 4 are simultaneously attacked
at t = 1 sec in Fig. 9, it can be clearly seen that the system
operates normally despite of heterogeneous transients from
each converter during attacks. The signal authentication is
done in a stepwise manner, which has been highlighted in
Fig. 9, where the event-driven mitigation is ﬁrstly carried out
in agent 2 & 4 and then later followed by agent 1 towards
the end. Hence, the resiliency scale of N − 1 for the proposed
strategy is clearly established in a system of N converters.

In the ﬁnal scenario, we consider the performance of the
proposed self-healing strategy in another network (shown in
Fig. 10) with different system parameters to establish that the
strategy is easily scalable to any physical network topology
with heterogeneous dynamics. The system and control pa-

Physical LayerCyber Layer123R1R2R3R4R512301234Time (sec)012Currents (A)I1I2I3MitigatedStealthAttackInitiatedLoadchangeIEEE TRANSACTIONS SUBMISSION

9

[16] B. Soret, L. D. Nguyen, J. Seeger, A. Br¨oring, C. B. Issaid, S. Sama-
rakoon, A. El Gabli, V. Kulkarni, M. Bennis, and P. Popovski, “Learn-
iot environments:
ing, computing, and trustworthiness in intelligent
Performance-energy tradeoffs,” IEEE Transactions on Green Commu-
nications and Networking, vol. 6, no. 1, pp. 629–644, 2021.

[17] D.-L. Nguyen, I. Leyva-Mayorga, and P. Popovski, “Witness-based
approach for scaling distributed ledgers to massive iot scenarios,” in
2020 IEEE 6th World Forum on Internet of Things (WF-IoT).
IEEE,
2020, pp. 1–6.

[18] N. T. Courtois, M. Grajek, and R. Naik, “Optimizing sha256 in bitcoin
mining,” in International Conference on Cryptography and Security
Systems. Springer, 2014, pp. 131–144.

[19] L. D. Nguyen, A. E. Kalor, I. Leyva-Mayorga, and P. Popovski,
“Trusted wireless monitoring based on distributed ledgers over nb-iot
connectivity,” IEEE Communications Magazine, vol. 58, no. 6, pp. 77–
83, 2020.

[20] I.-C. Lin and T.-C. Liao, “A survey of blockchain security issues and

challenges.” IJ Network Security, vol. 19, no. 5, pp. 653–659, 2017.

[21] R. Deng, P. Zhuang, and H. Liang, “Ccpa: Coordinated cyber-physical
attacks and countermeasures in smart grid,” IEEE Transactions on Smart
Grid, vol. 8, no. 5, pp. 2420–2430, 2017.

[22] L. Jia, R. J. Thomas, and L. Tong, “Malicious data attack on real-time
electricity market,” in 2011 IEEE International Conference on Acoustics,
Speech and Signal Processing (ICASSP).
IEEE, 2011, pp. 5952–5955.
[23] L. Xie, Y. Mo, and B. Sinopoli, “Integrity data attacks in power market
operations,” IEEE Transactions on Smart Grid, vol. 2, no. 4, pp. 659–
666, 2011.

[24] Y. Chen, Y. Tan, and B. Zhang, “Exploiting vulnerabilities of load
forecasting through adversarial attacks,” in Proceedings of the Tenth
ACM International Conference on Future Energy Systems, 2019, pp.
1–11.

[25] C. Barreto and A. A. C´ardenas, “Impact of the market infrastructure on
the security of smart grids,” IEEE Transactions on Industrial Informat-
ics, vol. 15, no. 7, pp. 4342–4351, 2018.

[26] Y. Zhang, W. Zou, X. Chen, C. Yang, and J. Cao, “The security for power
internet of things: Framework, policies, and countermeasures,” in 2014
International Conference on Cyber-Enabled Distributed Computing and
Knowledge Discovery.

IEEE, 2014, pp. 139–142.

[27] B. Huang, A. A. Cardenas, and R. Baldick, “Not everything is dark
and gloomy: Power grid protections against iot demand attacks,” in
28th {USENIX} Security Symposium ({USENIX} Security 19), 2019,
pp. 1115–1132.

[28] M. R. Mengis and A. Tajer, “Data injection attacks on electricity markets
by limited adversaries: Worst-case robustness,” IEEE Transactions on
Smart Grid, vol. 9, no. 6, pp. 5710–5720, 2017.

[29] M. Zhu and S. Mart´ınez, “Discrete-time dynamic average consensus,”

Automatica, vol. 46, no. 2, pp. 322–329, 2010.

[30] S. Sahoo, J. C.-H. Peng, A. Devakumar, S. Mishra, and T. Dragiˇcevi´c,
“On detection of false data in cooperative dc microgrids - a discordant
element approach,” IEEE Transactions on Industrial Electronics, vol. 67,
no. 8, pp. 6562–6571, 2019.

[31] S. Sahoo, T. Dragiˇcevi´c, and F. Blaabjerg, “An event-driven resilient
control strategy for dc microgrids,” IEEE Transactions on Power Elec-
tronics, vol. 35, no. 12, pp. 13 714–13 724, 2020.

[32] ——, “Resilient operation of heterogeneous sources in cooperative dc
microgrids,” IEEE Transactions on Power Electronics, vol. 35, no. 12,
pp. 12 601–12 605, 2020.

= 28 A, Vdcmin = 270 V, Vdcmax = 360 V
Controller: Vref = 315, Iref = 0, K v
2.5, K i

I = 0.05, hi = 2.5.

P = 5, K v

I = 100, K i

P =

System & Control Parameters of System in Fig. 10

To validate the effectiveness of the proposed strategy in
another topology with only 3 converters (each rated 5 kW) and
at different operation conditions, we have considered another
system in Fig. 10. The system and control parameters are as
follows: Plant: R1 = 0.2 Ω, R2 = 0.25 Ω, R3 = 0.32 Ω, R4
= 0.26 Ω, R5 = 0.45 Ω
Converter: Lsei= 2 mH, Cdci= 120 µF, Idcmin = 0 A, Idcmax
= 10 A, Vdcmin = 40 V, Vdcmax = 54 V
Controller: Vref = 48, Iref = 0, K v
2.5, K i

I = 100, K i

P = 5, K v

I = 0.05, hi = 2.5.

P =

REFERENCES

[1] S. Sahoo and S. Mishra, “A distributed ﬁnite-time secondary average
voltage regulation and current sharing controller for dc microgrids,”
IEEE Transactions on Smart Grid, vol. 10, no. 1, pp. 282–292, 2017.
[2] S. Sahoo, S. Mishra, J. C.-H. Peng, and T. Dragiˇcevi´c, “A stealth cyber-
attack detection strategy for dc microgrids,” IEEE Transactions on Power
Electronics, vol. 34, no. 8, pp. 8162–8174, 2018.

[3] M. B. Mollah, J. Zhao, D. Niyato, K.-Y. Lam, X. Zhang, A. M.
Ghias, L. H. Koh, and L. Yang, “Blockchain for future smart grid: A
comprehensive survey,” IEEE Internet of Things Journal, vol. 8, no. 1,
pp. 18–43, 2020.

[4] “Top trends in the gartner hype cycle for emerging technologies, 2017
- smarter with gartner,” https://www.gartner.com/smarterwithgartner/
top-trends-in-the-gartner-hype-cycle-for-emerging-technologies-2017/,
(Accessed on 02/03/2021).

[5] M. Andoni, V. Robu, D. Flynn, S. Abram, D. Geach, D. Jenkins,
P. McCallum, and A. Peacock, “Blockchain technology in the energy
sector: A systematic review of challenges and opportunities,” Renewable
and Sustainable Energy Reviews, vol. 100, pp. 143–174, 2019.

[6] M. L. Di Silvestre, P. Gallo, M. G. Ippolito, E. R. Sanseverino, and
G. Zizzo, “A technical approach to the energy blockchain in microgrids,”
IEEE Transactions on Industrial Informatics, vol. 14, no. 11, pp. 4792–
4803, 2018.

[7] S. Sahoo, T. Dragiˇcevi´c, and F. Blaabjerg, “Cyber security in control of
grid-tied power electronic converters—challenges and vulnerabilities,”
IEEE Journal of Emerging and Selected Topics in Power Electronics,
vol. 9, no. 5, pp. 5326–5340, 2021.

[8] R. B¨ohme, N. Christin, B. Edelman, and T. Moore, “Bitcoin: Economics,
technology, and governance,” Journal of economic Perspectives, vol. 29,
no. 2, pp. 213–38, 2015.

[9] L. D. Nguyen, I. Leyva-Mayorga, A. N. Lewis, and P. Popovski,
“Modeling and analysis of data trading on blockchain-based market in
iot networks,” IEEE Internet of Things Journal, pp. 1–1, 2021.
[10] N. Wang, X. Zhou, X. Lu, Z. Guan, L. Wu, X. Du, and M. Guizani,
“When energy trading meets blockchain in electrical power system: The
state of the art,” Applied Sciences, vol. 9, no. 8, p. 1561, 2019.
[11] T. Gaybullaev, H.-Y. Kwon, T. Kim, and M.-K. Lee, “Efﬁcient and
privacy-preserving energy trading on blockchain using dual binary
encoding for inner product encryption,” Sensors, vol. 21, no. 6, p. 2024,
2021.

[12] V. Aggarwal et al., “Review of security aspects of 51 percent attack on
blockchain,” in International Conference on Machine Learning and Big
Data Analytics. Springer, 2021, pp. 236–243.

[13] S. Rath, I. Zografopoulos, P. P. Vergara, V. C. Nikolaidis, and C. Kon-
stantinou, “Behind closed doors: Process-level rootkit attacks in cyber-
physical microgrid systems,” in IEEE PES General Meeting.
IEEE,
2022.

[14] W. Yao, Y. Wang, Y. Xu, C. Deng, and Q. Wu, “Distributed weight-
average-prediction control and stability analysis for an islanded mi-
crogrid with communication time delay,” IEEE Transactions on Power
Systems, vol. 37, no. 1, pp. 330–342, 2021.

[15] R. Mahmud and G.-S. Seo, “Blockchain-enabled cyber-secure microgrid
control using consensus algorithm,” in 2021 IEEE 22nd Workshop on
Control and Modelling of Power Electronics (COMPEL).
IEEE, 2021,
pp. 1–7.

