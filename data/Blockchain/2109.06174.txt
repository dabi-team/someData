Springer Nature 2021 LATEX template

1
2
0
2

p
e
S
2
1

]

R
C
.
s
c
[

1
v
4
7
1
6
0
.
9
0
1
2
:
v
i
X
r
a

A Decentralized Electronic Prescription
Management System

Vincent Schlatt1,2,3†, Johannes Sedlmeir1,2,3*†, Janina
Traue3† and Fabiane V¨olter1,2,3†

1*Project Goup Business & Information Systems Engineering,
Fraunhofer FIT, Germany.
2FIM Research Center, University of Bayreuth, Germany.
3Faculty of Law, Business & Economics, University of Bayreuth,
Germany.

*Corresponding author(s). E-mail(s):
johannes.sedlmeir@ﬁm-rc.de;
Contributing authors: vincent.schlatt@ﬁt.fraunhofer.de;
janina.traue@uni-bayreuth.de; fabiane.voelter@ﬁm-rc.de;
†These authors contributed equally to this work.

Abstract

The ongoing digital transformation of the medical sector requires solu-
tions that are convenient and eﬃcient for all stakeholders while protect-
ing patients’ sensitive data. One example involving both patients and
health professionals that has already attracted design-oriented research
are medical prescriptions. However, current implementations of elec-
tronic prescriptions typically create centralized data silos, leaving user
data vulnerable to cybersecurity incidents and impeding interoperability.
Research has also proposed decentralized solutions based on blockchain
technology as an alternative, but privacy-related challenges have either
been ignored or shifted to complex or yet non-standardized solutions
so far. This paper presents a design and implementation of a system
for the exchange of electronic prescriptions based on the combination
of two blockchains and a digital wallet app. Our solution combines
the bilateral, veriﬁable, and privacy-focused exchange of information
between doctors, patients, and pharmacies based on a veriﬁable cre-
dential with a token-based, anonymized double-spending check. Our
qualitative and quantitative evaluations suggest that this architecture
can improve existing approaches to electronic prescription management

1

 
 
 
 
 
 
Springer Nature 2021 LATEX template

A Decentralized Electronic Prescription Management System

1

by oﬀering patients control over their data by design, a suﬃcient level of
performance and scalability, and interoperability with emerging digital
identity management solutions for users, businesses, and institutions.

Keywords: Blockchain, Digital Wallet, Healthcare, Self-Sovereign Identity

1 Introduction

The ongoing digital transformation of the healthcare sector aﬀects its stake-
holders in various ways. Healthcare providers, public institutions, and patients
alike face a constant pressure to develop and use digital tools in the health-
care sector. As recent developments caused by the Covid-19 pandemic indicate,
this pressure is often exacerbated by the need to balance privacy require-
ments and adequate digital healthcare provisioning [1]. However, this apparent
dichotomy appeared before the pandemic, too, for example in the context of
digital health records or electronic medical prescriptions [2, 3]. Medical pre-
scriptions refer to authorizations issued by qualiﬁed healthcare practitioners
that allow patients to obtain medication and services for medical treatment.
These authorizations typically manifest as physical, paper-based documents
signed by a qualiﬁed physician, which patients present to pharmacies or health
service providers. However, such paper-based medical prescriptions suﬀer from
various drawbacks. For example, due to their format, they proved to be suscep-
tible to manipulation, unauthorized reproduction, and errors [4]. Paper-based
prescriptions also delay the widespread adoption of telemedicine. In addition,
they are rarely used for processes that might beneﬁt from the exchange of veri-
ﬁable and machine-readable prescription data, such as claiming reimbursement
from health insurances or checking for cross-reactions of pharmaceuticals [5].
Furthermore, the respective documents are inconvenient to use and susceptible
to the disclosure of private information if not handled adequately.

In the hope of obliterating the ﬂaws of a paper-based approach, sev-
eral attempts to introduce medical prescriptions in an electronic format have
emerged in recent years. Electronic medical prescriptions are usually imple-
mented as digital references or documents, whose validity status and sometimes
content are stored in databases run by parties that are regarded as trustworthy
to prevent fraud [5]. As such, existing approaches to electronic prescriptions
(e-prescriptions) are typically reliant on highly centralized infrastructures and
data silos. Consequently, they serve as attractive targets for attackers aiming
to capture sensitive health information on a large scale [6], as recent examples
indicate [7]. They also pose the socio-economic threat of creating monopo-
lies or oligopolies of the corresponding platform owners [8]. Providers of the
centralized infrastructures might further gain insights into patient data, result-
ing in privacy concerns for patients [5]. Also, centralized implementations of
e-prescriptions are often not interoperable as they create lock-in eﬀects. Con-
sequently, patients, healthcare practitioners, or pharmacies need to purchase
proprietary and expensive software [9].

To eliminate these drawbacks of centralized approaches, researchers
recently proposed alternative solutions based on decentralized infrastructures.

Springer Nature 2021 LATEX template

2

A Decentralized Electronic Prescription Management System

These approaches rely on distributed data storage and aim to provide higher
security, privacy, and interoperability than centralized approaches [10] while
at the same time delivering a comparable level of convenience to users. As
such, decentralized approaches solve several issues of both paper-based and
centralized electronic approaches to medical prescriptions. Extant literature
often builds on blockchain technology to serve as the underlying infrastruc-
ture for decentralized approaches to e-prescriptions. A major advantage of
using blockchain technology for e-prescriptions is its function as a synchro-
nized single source of truth, allowing the avoidance of, e.g., manipulating or
double-spending (i.e., redeeming more than once) e-prescriptions [11].

Nevertheless, several issues remain, and new problems emerge in current
implementations based on blockchains. In particular, privacy concerns arising
from the transparency of patient data may be exacerbated due to redundant
data storage as well as the immutability of blockchains that renders later
deletion practically impossible [10, 12]. This aﬀects not only patients’ privacy
and data security interests but also compliance with associated regulatory
requirements, such as the EU general data protection regulation (GDPR), the
California consumer privacy act (CCPA) or the U.S. health insurance porta-
bility and accountability act (HIPAA). Furthermore, interoperability often
remains a problem, as the suggested implementations are not built upon
common standards, and sensitive data is regularly not shared bilaterally but
involves decentralized yet third-party infrastructures. Besides, the existing sug-
gestions often impose the management of cryptographic keys directly to the
users or rely on yet another smartphone app (or device) that users need to use
speciﬁcally for e-prescriptions.

In recent years, an alternative approach for exchanging veriﬁable data
in a decentralized way emerged through portable identities managed in
so-called “digital wallets”. This paradigm is often termed self-sovereign iden-
tity (SSI) [13]. SSI oﬀers standards and protocols for end-to-end encrypted
bilateral communication and practices for selective and veriﬁable informa-
tion disclosure based on digital certiﬁcates [14, 15]. However, preventing the
double-using of e-prescriptions that are purely based on digital certiﬁcates is
not possible solely by bilateral communications, as one pharmacy cannot know
whether an e-prescription certiﬁcate has already been redeemed at another
pharmacy. We hence propose that the combination of blockchain technology
for double-spend prevention and SSI for the veriﬁable exchange of sensitive
e-prescription data and key management potentially oﬀers properties solving
the shortcomings of current solutions to e-prescription management. Thus,
we pose the following research question:

How to design and implement a decentralized system for e-prescription
management using blockchain technology and digital wallets?

To answer this research question, we collect requirements of e-prescription
management systems in a literature review and develop an architecture that
aims to address them. To evaluate our architecture’s practicability and impli-
cations, we subsequently implement and evaluate the design as a technical
artifact. Thus, we propose an alternative solution to the problems of present

Springer Nature 2021 LATEX template

A Decentralized Electronic Prescription Management System

3

designs of e-prescription management systems and evaluate its technical imple-
mentation. In this course, we contribute an extensive discussion regarding the
role of blockchain technology in decentralized architectures that involve the
sharing of sensitive data and the impact of regulatory requirements on the
design. Our contribution to practice is a referential architecture for designing
an e-prescription system and an assessment of its current technical feasibility.
The remainder of this study is structured as follows. In section 2, we present
and discuss the concepts of e-prescriptions, blockchain technology, SSI and
digital wallets. We then review related work on decentralized e-prescription
systems and derive requirements for our prototype in section 3. Section 4 pro-
vides an overview of our architecture, while the following section 5 presents our
technical implementation and evaluation. Subsequently, we discuss the result-
ing implications and conclude the paper in section 7 by providing a summary,
limitations of our work, and avenues for future research.

2 Theoretical Background

2.1 E-Prescriptions

In the UK alone, nearly 1.5 million medical prescriptions are processed on
a daily basis [5]. Similarly, 11.6 prescriptions were ﬁlled in US-pharmacies
per capita in the year 2019 [16]. The value of prescription pharmaceuticals
prescribed globally every year accounts for approximately $1 trillion [17]. To
account for limitations of existing approaches to handling the increasing num-
ber and value of medical prescriptions, researchers and practitioners alike aim
to optimize the process of prescribing and dispensing pharmaceuticals. Accord-
ingly, e-prescription systems have been introduced, which can help to increase
both the accuracy and the eﬃciency of medication to ensure patients’ safety
while streamlining processes [5, 18, 19]. Submitting and exchanging prescrip-
tion information digitally is considered to reduce medication errors, minimize
overhead due to paperwork, and increase patients’ convenience [5, 18]. Accord-
ingly, e-prescription management systems enable the creation of prescriptions
and their transmission to a pharmacy purely digitally. As such, e-prescriptions
serve as a medium for medical data exchange and corresponding systems allow
to redeem prescriptions electronically.

However, e-prescription systems come with several challenges. While
paper-based prescriptions can be physically invalidated upon redemption,
e-prescriptions must have a sophisticated mechanism for preventing double-
spending [20], as copying electronic documents has close to zero marginal costs.
This requires some degree of transparency about whether an e-prescription
has been already used, particularly when the ecosystems involves several
diﬀerent stakeholders and in particular many independent pharmacies and
doctors. These transparency requirements, however, are to be balanced with
data security and privacy. As health data is of high sensitivity, it requires
special protection according to the GDPR within the European Union (EU).
This includes aspects like the right to erasure (“Right to be forgotten”),
meaning that users can request their data to be deleted at any point in
time (Article 17 GDPR) [21]. Besides, the data speciﬁed in a prescription

Springer Nature 2021 LATEX template

4

A Decentralized Electronic Prescription Management System

must also be secure from alteration by unauthorized parties. A further chal-
lenge for e-prescription systems is posed by the need for standardization.
Moreover, transmitting, receiving and processing data between many stake-
holders requires the systems to be interoperable [20]; and achieving this in
an established system likely requires strong network eﬀects or regulatory
obligation.

Countries such as the United States, Australia, the United Kingdom, Spain
and Denmark have already introduced e-prescription systems that are now in
productive operation [5, 9]. The respective systems are usually not standalone
products but embedded in more comprehensive e-health systems including,
e. g., electronic health records of patients. A comparative study conducted
by Aldughayﬁq and Sampalli [5] found that most implementations build on
centralized designs employing a central database for storing prescriptions.
A centralized design choice, in which the associated platform is involved in
basically any transaction related to the e-prescription, can eﬀectively enforce
interoperability and the compliance with business logic (such as double-spend
prevention) and provide ﬁne-grained access management rules. However, it also
bears considerable risks. First, a centralized approach represents a single point
of failure, meaning that the system is more vulnerable to attacks [8], as past
privacy breaches in centralized systems illustrate [22]. Second, patients cannot
be sure that the operator of a centralized system or database does not sell or
distribute sensitive data to third parties. Instead, data is available for any par-
ticipant integrated in the infrastructure with the necessary access rights [5],
and the patient needs to rely on the eﬀectiveness of regulation and audits
to enforce their data privacy. Third, custom solutions challenge the inter-
operability of systems. For example, Bruthans [9] found that e-prescription
systems in Europe suﬀer from a lack thereof as authentication mechanisms
are not compatible. Fourth, due to network eﬀects, centralizing control over
data and operations tends to cause monopolies, which can hinder productive
collaboration [23].

Decentralized systems aim to address some of these problems. For example,
Surescripts, an e-prescription management system in the US, allows entities
such as caregivers to access patient information from patients’ pharmacies and
health insurance companies through the system [5]. However, such approaches
impose signiﬁcant responsibility regarding IT security and access management
on pharmacies and health insurances, which might be particularly problem-
atic for small businesses. Furthermore, in Surescripts, patients have to choose
a speciﬁc dispensing pharmacy when their prescription is created, which
decreases user ﬂexibility and convenience. Consequently, researchers have con-
tinued searching for better solutions, and in recent years, they have considered
blockchain technology as a viable solution for solving the above-mentioned
problems of e-prescription systems [8].

2.2 Blockchain

Since an individual or group under the pseudonym Satoshi Nakamoto unveiled
the ﬁrst application of blockchain as the technological backbone of the Bitcoin
network [24], an increasing number of companies and government agencies
have recognized the potential of the technology to improve cross-organizational

Springer Nature 2021 LATEX template

A Decentralized Electronic Prescription Management System

5

processes [25]. This has led to the emergence of a large number of use cases and
projects at varying stages of maturity, especially in the healthcare sector [26].
At its core, blockchain technology provides a distributed data structure
that redundantly stores transactions grouped in blocks on each node of a
peer-to-peer network [27]. Aiming to obliterate the need for a central trusted
authority [24], the nodes of the peer-to-peer network repeatedly agree on the
state of the system by following a consensus protocol [27, 28]. Each block
in a blockchain is linked to the previous block through a cryptographic hash
pointer. The blocks, therefore, form a chain, creating a tamper-proof histori-
cal data record [29]. Thus, blockchains create a single point of truth between
all participants in the distributed ledger [30]. As such, they provide a solution
to the double-spending problem, which implies that a speciﬁc digital token
can be spent more than once at a time [24]. Due to their technical struc-
ture, blockchain systems provide several important properties. Resulting from
the resistance to crashes or malicious behavior of a small number of nodes,
blockchain systems are highly available and decentralized digital infrastruc-
tures [31]. To participate in consensus or interact with the peer-to-peer network
and authorize transactions, users of a blockchain system must authenticate
using public-key cryptography. As a result, blockchain systems also oﬀer an
integrated public key infrastructure.

To account for the requirements of diﬀerent use cases, various concepts
of blockchain technology emerged. A prominent conceptualization by Peters
[32] distinguishes blockchains along two dimensions. First, transac-
et al.
tions in public blockchains are publicly visible, while transactions in private
blockchains are only visible to authorized parties. Second, permissionless
blockchain systems allow anyone to participate in consensus, while this right
is retained to authorized parties only in permissioned blockchain systems. As
the technology gained increasing prominence, developers introduced advanced
concepts building upon the inherent properties of blockchains. Smart contracts,
which can be deﬁned as computer programs that are executed redundantly
on virtual machines on the nodes of the blockchain system’s peer-to-peer
network [33, 34], enable a large variety of transactions that go well beyond
the transfer of cryptocurrencies [35]. One speciﬁc application area of smart
contracts is the exchange a broad variety of digital assets. These so-called
blockchain tokens are value containers that can be transferred among the par-
ticipants in a blockchain system [36, 37]. The opportunities related to the
“tokenization” of physical and digital objects are considered an essential trend
for the economy [38]. The inherent value of respective tokens can also aid in
implementing incentive mechanisms and, thus, co-ordinate large scale processes
among mutually distrusting parties[39].

Nevertheless, several tradeoﬀs and challenges remain in currently available
blockchain systems [40]. Depending on the ﬁeld of application, blockchains
can introduce disadvantages regarding scalability and data protection due to
the synchronous and redundant execution of transactions [41]. Furthermore,
energy consumption is an often-mentioned issue. Yet, while blockchains are not
the most eﬃcient solution from a resource perspective due to the redundancy
in their computation, several implementations of blockchain and in partic-
ular permissioned blockchains are by far not as energy-intensive as reports
about Bitcoin and Ethereum suggest [42]. Finally, the information exposure

Springer Nature 2021 LATEX template

6

A Decentralized Electronic Prescription Management System

due to the replicated storage and execution in blockchains also implies signiﬁ-
cant challenges both from the perspective of natural persons’ data protection
as well as sensitive business data. The pseudonymization through public keys
as addresses does not considerably mitigate this problem, as the aggrega-
tion of information from diﬀerent domains can provide suﬃcient means for
de-anonymization [43]. While permissioned blockchains partially address this
problem through restricting participation in the network, still all of these par-
ticipants can see each other’s transactions by design; so from the perspective
of an attacker that intends to retrieve sensitive information, a permissioned
blockchain is a centralized system with yet more attack vectors [44]. While
concepts such as private transactions through encryption have been imple-
mented in permissioned blockchains to address enterprises’ requirements (e. g.,
in Hyperledger Fabric and Quorum), they restrict the functionality of smart
contracts, as these typically cannot run on encrypted or hashed data. Crypto-
graphic tools such as zero-knowledge proofs (ZKPs), multiparty computation,
and (fully) homomorphic encryption can be used to bring some of this function-
ality back, but can come at signiﬁcant computational cost and complexity [11].
Therefore, utilization of blockchains is not a good approach to solve privacy
challenges in the ﬁrst place and should be considered an additional tool that
must be carefully utilized, weighing its pros and cons.

2.3 Self-Sovereign Identity and Digital Wallets

The underlying idea behind the concept of SSI is the provision of digital iden-
tities that are not tied to a certain place or organization, and which can be
used across organizations with the identity owners’ consent [45]. SSI involves
three distinct types of entities [46]: the issuer of an identity document, the
holder of the respective document, and the veriﬁer of properties described in
the document. An analogy from the physical world serves as an illustration of
the basic interactions [13]: An SSI system builds upon digital objects compa-
rable to physical ID cards [47]. Appropriate organizations, such as government
authorities, issue the respective ID cards to their holders, who subsequently
store them in a physical infrastructure of their choice, such as a wallet. The
ID cards were designed to be tamper-proof by their issuers and follow a certain
schema, which has been made public by their issuer. As a result, the integrity
of ID cards can be veriﬁed by third parties in bilateral interactions with their
holders.

The building blocks of an SSI system can be derived from this analogy.
Physical ID cards relate to veriﬁable credentials (VCs), which are crypto-
graphically signed digital objects containing claims about the identity of their
holder [13, 15, 48]. Holders store these VCs in an (typically mobile) applica-
tion called “digital wallet”. To prove properties, or claims, described in their
VCs to a veriﬁer, holders generate veriﬁable presentations (VPs). These VPs
are tamper-proof presentations of evidence derived from one or multiple VCs
to address the requirements posed by a veriﬁer [15, 48, 49]. This can either be
achieved by presenting the signed credential itself, e. g., a JSON Web Token
or an X.509 certiﬁcate, or by creating a cryptographic ZKP, for example from
an anonymous credential [50, 51]. The latter method allows data minimiza-
tion in the form of selective disclosure, where only a subset of the attributes
contained in a VC can be revealed. The veriﬁer, who requests proofs of claims

Springer Nature 2021 LATEX template

A Decentralized Electronic Prescription Management System

7

contained in one or more VCs, can be an organization as well as an individual
or even an object. Additionally, the veriﬁer must trust the issuer to recognize
VCs as trustworthy [15, 48].

Entities within an SSI system use so-called decentralized identiﬁers (DIDs),
unique identiﬁers following a standardized schema [52], as identiﬁers and to
create a standardized end-to-end encryption between two parties. DIDs of
public institutions can be made publicly discoverable as an alternative to cer-
tiﬁcate authority (CA)-based binding of public keys and domain names or
IP-addresses. To avoid opportunities for correlation, it is recommendable for
natural persons to use a new DID in each interaction. While these building
blocks provide a solid foundation for an SSI system, a neutral infrastructure is
necessary: information about issuers of VCs, such as their current signing keys,
and revocation-related information must be publicly available to verify the
correctness of VPs. By proving knowledge of the issuer’s digital signature and
non-inclusion of their VC in a public but privacy-protecting revocation registry
(in the form of a cryptographic accumulator), holders can convince a veriﬁer
that their VC has not been revoked without having to contact the credential
issuer. Furthermore, schemas of VCs must be publicly available to verify the
integrity of VPs. Due to its properties as a decentralized and highly available
data structure, blockchain technology is often used for this purpose [14, 46].
Lately, the concept of SSI and digital wallets has been applied in a variety of
endeavours [53].

3 Requirements Analysis

3.1 Literature Review

We conducted a structured literature review to identify relevant previous work
investigating the potential of decentralized technologies for e-prescriptions
following the guidelines proposed by Kitchenham and Charters [54]. Accord-
ingly, we derived our search string on the basis of our research question [54]:
“blockchain AND prescription AND health”. We decided against using syn-
onyms for blockchain technology as it is regarded the most prominent concept
associated with decentralization and often serves as a solution for implementing
e-prescriptions in a decentralized way [12, 19, 55]. We screened the databases
ACM Digital Library, AISeL, arXiv, IEEE Xplore, Google Scholar, ScienceDi-
rect and Web of Science as they represent the prevailing databases in the
computer science and information systems research domain. The initial search
yielded 6,009 results in total (see ﬁgure 1).

Generally, we included research in English language only. During the title
screening of our initial search results, we excluded papers which did not men-
tion blockchain and health (or synonyms) in their titles to ensure the relevance
of our article set. As Google Scholar yielded 5770 results, we screened the
titles of all results until no papers related to our research question could
be identiﬁed for the last 50 results displayed, sorted by relevance. After-
ward, we screened the contents of the remaining papers. First, we excluded
papers which did not focus on solutions for e-prescriptions. Second, follow-
ing the goal of our literature review to identify existing propositions for

Springer Nature 2021 LATEX template

8

A Decentralized Electronic Prescription Management System

Fig. 1 Systematic literature review for the search string “blockchain AND prescription
AND health”.

e-prescriptions, we also excluded papers which do not cover a speciﬁc solu-
tion architecture. Last, we excluded duplicates from our article set. We found
that although blockchain is often mentioned as a viable technology for the
health care sector in general [56–58], extant literature only rarely explicitly
proposes architectures for the management of e-prescriptions. In contrast,
the current literature body is placing its focus on blockchain-enabled medical
supply chains [17, 59, 60], electronic health records [61, 62], and the manage-
ment of medication histories [63, 64]. Furthermore, while some authors address
e-prescriptions explicitly, they focus on implementations and requirements in
a speciﬁc country, hindering the generalization of their ﬁndings [65]. Resulting
from the content screening, we identiﬁed seven papers in total which explicitly
propose or survey blockchain-based solutions for e-prescription processes. After
we identiﬁed the ﬁnal article set, we extracted information about the require-
ments mentioned by the authors, proposed solution architecture, advantages,
and challenges. To ensure intercoder reliability, every paper was coded by at
least two authors. In the following, we will analyze these papers depicted in
table 1 in detail.

Many

papers

exploring

the

ogy for e-prescriptions do not address
of blockchain technology in their

of

advantages

technol-
blockchain
the privacy-related challenges
example,

suggested solutions. For

Authors

Year

Title

Cadoret et al.

Gropper

He et al.

Li et al.

Meena et al.

Thatcher and Acharya

Thatcher and Acharya

2020

2016

2019

2019

2019

2018

2020

Proposed Implementation of Blockchain in British Columbia’s Health Care DataManagement

Powering the Physician-Patient Relationship with HIE of One Blockchain Health IT

BlockMeds: A Blockchain-Based Online Prescription System with Privacy Protection

DMMS: A Decentralized Blockchain Ledger for the Management of Medication Histories

Preserving Patient’s Privacy using Proxy Re-Encryption in Permissioned Blockchain

Pharmaceutical Uses of Blockchain Technology

Towards the Design of a Distributed Immutable Electronic Prescription System

Table 1 Results of the structured literature review (conducted in January 2021).

Index

[66]

[67]

[12]

[68]

[2]

[3]

[19]

Total recordsidentification(6,009)Final articleset(7)Articlesforfull-text reading(87)Exclusioncriteria:•Not relevant•Not publishedin English Exclusioncriteria:•Nofocuson e-prescriptions•Nopropositionofspecificsolutionarchitecture•DuplicatesWebofScience(11)ACM Digital Library(14)IEEE XploreDigital Library(8)ScienceDirect(181)AIS electronic library(24)Google Scholar(5770)arXiv(1)Springer Nature 2021 LATEX template

A Decentralized Electronic Prescription Management System

9

Thatcher and Archarya [3] as well as Thatcher and Archarya [19] propose
an e-prescription management system that integrates a blockchain-based
“immutable database of prescriptions”. While the proposed design ensures
accountability for processing e-prescriptions, the authors acknowledge that it
dismisses patients’ privacy [3], thereby highlighting an essential requirement
for e-prescriptions. In contrast, He et al. [12] acknowledge the presence of
privacy-related issues in current approaches to decentralized e-prescription
systems and suggest a permissioned blockchain for the management of
e-prescriptions. However, their proposed architecture still stores sensitive
patient data on-chain and hence leaves it vulnerable to cyber-attacks as dis-
cussed in section 2.2. Furthermore, patients do not have control over which
data is shared. The latter problem is addressed by Li et al. [68], who outline
how a blockchain for medication management can be integrated into the
existing e-prescription processes in the USA. The design ensures that only
the patient can decrypt data saved on the ledger upon request by pharmacies.
As a result, stakeholders other than the patient are unable to access the
encrypted data. Thus, it seems that the authors chose blockchain not as an
infrastructure for data sharing, but for the sole purpose of achieving data
integrity. However, simpler means to achieve data integrity are not considered
(beyond their implicit role within the blockchain network for authentication):
Digital signatures can be used without facing challenges of compliance related
to the immutable storage on blockchain. In addition, the permanent storage
of encrypted data in a blockchain system may become an attack vector in
the future due to the increase of computing power over time and the poten-
tial availability of suﬃciently powerful quantum computers within the next
decades. This concern is manifested by ongoing controversial debates in the
European Union whether encrypted data should be classiﬁed as personally
identiﬁable information or not [69]. Furthermore, while the system proposed
by Li et al. [68] is based on a public key infrastructure, the authors do not
address how the users’ private and public keys should be managed. In addition,
the architecture does not prevent the double-spending of e-prescriptions.

Meena et al. [2] investigate how patients’ privacy may be preserved in
a blockchain-based approach to e-prescriptions. The authors propose a pro-
totype based on a permissioned blockchain that allows patients to encrypt
and decrypt medical records including e-prescriptions. However, in parallel to
Li et al. [68], the added value of using blockchain as an underlying infras-
tructure remains unclear, as its sole purpose seems to be the provision of
immutability. Furthermore, the authors neglect important user-centric aspects
like the management and sharing of keys between patients and pharmacies.
It remains unclear how patients are enabled to interact with various involved
stakeholders. Similarly, while Ying et al. [2019] propose an architecture that
ensures privacy throughout the process of dispensing drugs, they omit the
integration of central stakeholders such as the users in their considerations.
Cadoret et al. [2020] suggest storing prescription data in private, permissioned
blockchains or using ZKP for addressing privacy challenges, but do not pro-
vide details how the associated access management would work or on which
layer the sensitive data could be exchanged.

Our structured literature review also reveals two concepts building upon
SSI in the underlying context. Gropper et al. [2016] propose an SSI-based

Springer Nature 2021 LATEX template

10

A Decentralized Electronic Prescription Management System

system for overcoming the current challenges of electronic medical records.
However, the authors do not give details how multiple usages of e-prescriptions
can be prevented: If there is only one pharmacy where the e-prescription can
be spent, a serial number in the VC that needs to be revealed can be used
to prevent repeated redemptions. However, in the case of multiple pharma-
cies one would either need to synchronize the serial numbers of redeemed VC
among all pharmacies, resulting in the need for yet another central service or
a decentralized solution like a blockchain as a single source of truth, or require
interactions between pharmacies and doctors, where the pharmacy redeeming
the prescription asks the doctor to revoke the credential. This approach would,
however, introduce signiﬁcant additional complexity.

In summary, we identiﬁed three prevailing patterns of decentralized solu-
tions for e-prescriptions. First, some authors suggest using a blockchain
as a medium for storing sensitive patient data, but neglect privacy-related
issues. Also, methods for eﬃciently and conveniently managing and exchang-
ing decryption keys are lacking in the proposed solutions. Second, proposed
architectures often lack considerations of stakeholder integration. Users or
pharmacies are either not a part of the solution architecture or need to rely on
third-party services or specialized, new applications. Third, also SSI has been
suggested for processing e-prescriptions but does not provide reliable means
for preventing double-spending. As interoperability and extensibility to related
use cases, privacy considerations, and stakeholder integration have not yet
been aligned in current approaches to decentralized e-prescriptions, we hence
suggest an alternative approach in the following.

3.2 Derivation of Requirements

We derive a set of requirements for an e-prescription architecture from our
previous analysis of existing approaches to implementing systems for the
management of e-prescriptions. Both existing paper-based and e-prescription
processes demonstrate certain requirements that must be fulﬁlled. For exam-
ple, the current redemption process of paper-based prescriptions ensures that
each prescription may be redeemed only once. Accordingly, also e-prescription
systems must provide a reliable mechanism to prevent double-spends. Further-
more, our systematic literature review reveals the strengths and weaknesses
of decentralized propositions, which allows to derive additional requirements.
For example, Li et al. [2019] highlighted that users must be able to control
with whom they will share their data. Table 2 summarizes the requirements
and their context. The derived requirements serve as a basis for the remain-
der of this paper and inform and guide the design and implementation of our
proposed system architecture. They also represent the objectives along which
we evaluate our artifact in section 5.

Springer Nature 2021 LATEX template

A Decentralized Electronic Prescription Management System

11

Nr. Requirement

Context

References

R.1 Data control
and privacy

Users must be able to choose who to share their health data with,
including e-prescriptions.

[67],

[66],
[2], [3], [70]

[12],

[68],

R.2 No data silos

To prevent the abuse of patient data through operators of centralized
solutions and large-scale data breaches of sensitive health data, no
centralized data silos containing patient data must exist.

[66], [12], [68], [2], [3]

R.3

Pharmacy
independence

To ensure competition and free choice of patients, the user must not
be bound to a speciﬁc pharmacy for redeeming the prescription.

[12, 67]

R.4 Key

management

The developed system must be convenient to use and should not create
unnecessary overhead due to key management exposed to the users.

[68], [2], [3]

R.5

Interoperability Current implementations for e-prescriptions diﬀer signiﬁcantly, hin-
dering interoperability and thereby adoption as a result. Interoperabil-
ity could furthermore extend the application areas of e-prescription
systems.

[66], [67], [68], [19]

R.6

Scalability and
performance

The e-prescription management system must be able to quickly handle
a suﬃcient number of prescriptions redeemed on a large scale, even
at peak times.

[66], [67], [12]

R.7 Double-
spending
prevention

To prevent fraud, prescriptions must not be redeemed twice, or not
more frequently than the number of times intended in the case of
periodic prescriptions.

[19]

R.8

Information
security (C-I-A)

Personal health data is highly sensitive. Therefore, conﬁdentiality
must be ensured, often stipulated by regulatory eﬀorts. Furthermore,
data integrity is required to guarantee the correctness of medica-
tion information. Availability ensures the independence of users and
supposed functionality of the system.

[67],

[66],
[2], [3], [19]

[12]

[68],

Table 2 Requirements for an e-prescription management system

4 Architecture and Implementation

4.1 Conceptual Architecture

The architecture that we propose in this paper builds upon the two major
paradigms for decentralized digital interactions discussed in section 2: To
address the challenges of existing solutions for e-prescriptions, we employ a
hybrid approach leveraging SSI and digital wallets for the bilateral and veriﬁ-
able information exchange between stakeholders and blockchain technology to
prevent double-spends. The overall architecture including the three types of
stakeholders – doctors, patients, and pharmacies – is illustrated in ﬁgure 4.1.
In our architecture, doctors and pharmacies are each running a digital wal-
let deployed on servers on-premise or in the cloud. The patient is carrying a
digital wallet on their smartphone and interacts bilaterally with the doctors
and pharmacies of their choice. No direct communication between doctors and
pharmacies is necessary, as the authenticity of VPs derived from VCs can be
veriﬁed through the issuer’s signature on the VC and the accumulator state of
a revocation registry on a blockchain.

An intuitive solution for e-prescription management that is purely based
on SSI may be designed as follows: The patient visits their doctor, and the
doctor creates an e-prescription in the form of a VC. Subsequently, the doctor
issues this VC to the patient’s smartphone wallet through a bilateral, end-to-
end (E2E) encrypted communication channel. The patient can then connect
with their pharmacy either remotely or in a branch and give a VP of the
e-prescription VC that convinces the pharmacy of its correctness and validity
(potentially including a proof of non-revocation), provided the pharmacy lists

Springer Nature 2021 LATEX template

12

A Decentralized Electronic Prescription Management System

Fig. 2 E-prescriptions based on veriﬁable credentials with anonymized blockchain-based
tokens for double-spending checks.

the doctor (more precisely, the doctor’s public DID or public key) among a
collection of entities that they trust.

To prevent double-spends without the need for an intermediary, we link a
blockchain-token that does not carry sensitive or correlatable information to
the e-prescription VC. In order to provide an eﬃciently and conveniently usable
key management associated with the token, the e-prescription VC includes
the private key that can be used to control the token: As the patient trusts
the doctor and the pharmacy concerning the prescription that they want to
spend, it is not necessary that the patient has exclusive control over the token
at any point in time – the patient can simply carry information that is nec-
essary to retrieve and invalidate the token for double-spend protection in the
e-prescription VC. As a result, we extend our architecture as follows: Doctors
and pharmacies both run a blockchain client, and upon onboarding, a doctor
creates a (long-term) key pair (skdoctor, pkdoctor) and deploys a smart contract
granting the doctor the right to create new tokens. When the doctor wants
to issue an e-prescription, they generate a new keypair (skpresc, pkpresc) that
is only used for this one speciﬁc prescription. Next, the doctor creates a new
token that can only be spent by the controller of pkpresc, i.e., by anyone who
knows skpresc, in the smart contract by signing an associated transaction with
skdoctor. The doctor then includes the smart contract’s address and skpresc
in the e-prescription VC that includes prescription-speciﬁc information such
as the name of the patient, the name of the pharmaceutical, and the quan-
tity the patient can claim. Consequently, any party that receives a VP of an
e-prescription VC that reveals skpresc can potentially invalidate, i.e., spend,
the associated token if the blockchain with the smart contract is public. Thus,
the patient should not reveal this attribute on the e-prescription VC to a party
that they do not trust. However, selective disclosure still allows to use the
e-prescription VC for VPs towards entities the patient does not trust regarding
the token.

e-prescriptionVerifiableCredential(VC)containssecretkeyfortokenspendingPublic RevocationRegistrywritesreadsWalletSmart Contractstores/retrievese-prescriptionVCTokencreateskeypairsfore-prescriptiontokenfillsand signse-prescriptionVCcreatese-prescriptiontokenspendse-prescriptiontokenverifiese-prescriptionVCPharmacyDoctorHolderSpringer Nature 2021 LATEX template

A Decentralized Electronic Prescription Management System

13

Fig. 3 Technical components of the proposed e-prescription management architecture.

Spending the e-prescription involves minimal eﬀort, as all necessary infor-
mation is contained in the VC: When patients go to the pharmacy, they present
the relevant attributes contained in the e-prescription VC to the pharmacy,
including the smart contract address and skpresc, in a VP. The pharmacy
can verify the authenticity of the VP by verifying the associated proof. Sub-
sequently, the pharmacy can use their blockchain client to invalidate the
respective token, as they can control it using skpresc, which they learned from
the VP. As the transactions in a blockchain are ordered, even in case the
patient tries to spend the e-prescription at many pharmacies in parallel, only
one of the transactions that these pharmacies send to the blockchain will be
the ﬁrst after ordering and succeed in retrieving the token; all the others will
return an error message.

4.2 Implementation

Following the description of our generic architecture, we now illustrate how we
implemented the architecture in our prototype. To this end, we again follow the
two major building blocks of our design to structure our argumentation. The
components of our proposed architecture are illustrated in ﬁgure 3. We set up a
Quorum network, which is a permissioned variant of the Ethereum blockchain,
for deploying the smart contracts on which doctors create the tokens. We
decided for the permissioned option due to its high throughput, low latency,
low energy consumption, and low transaction costs (see also section 2.2). Doc-
tors and pharmacies consequently run Quorum clients for token creation and
spending.

Figure 4 presents the smart contract that a doctor can deploy for a simple
token management to prevent double-spends. The smart contract speciﬁes that
a Prescription token must have two attributes, namely its issuer (the doctor’s
public key) and an indicator of how often it can be spent at most. On instan-
tiation, the contract creates a registry for such prescriptions, i.e., a mapping

Smartphone (Universal wallet)HolderWeb-App and displayPharmacyDoctorWeb-App and displayAries AgentQuorum-BlockchainIndy-BlockchainQuorum-Client Quorum-ClientAries AgentAries AgentMiddle-wareMiddle-wareTails-Files (GitHub)Smart ContractSpringer Nature 2021 LATEX template

14

A Decentralized Electronic Prescription Management System

1 pragma solidity ^0.5.16;
2
3 contract P r e s c r i p t i o n C o n t r a c t {
4

address admin ;

5

6

7

8

9

10

11

12

13

14

15

16

17

18

19

20

21

22

23

24

25

26

27

28

29

30

struct Prescription {

address issuer ; // the doctor ’s public key
uint r e m a i n i n g R e d e m p t i o n s ; // number of times that the prescription

can still be spent

}

constructor () public {

admin = msg . sender ;

}

modifier onlyAdmin () {

require ( msg . sender == admin , " Sender is not the admin of the

contract " ) ;

_ ;

}

// a prescription token registry , associating public keys with

prescriptions

mapping ( address = > Prescription ) public prescriptions ;

function create ( address patient , uint number ) public onlyAdmin () {
prescriptions [ patient ] = Prescription ({ issuer : msg . sender ,

r e m a i n i n g R e d e m p t i o n s : number }) ;

}

function spend () public {

require ( prescriptions [ msg . sender ]. r e m a i n i n g R e d e m p t i o n s >= 1 ,

" Already spent " ) ;

prescriptions [ msg . sender ]. remainingRedemptions - -;

31
32 }

}

Fig. 4 The e-prescription smart contract implementation in Solidity that each doctor
deploys for the token management of the e-prescriptions that they issue.

of public keys (pkpresc) to prescription tokens, and speciﬁes that only the cre-
ator of the contract (the admin, i.e., the doctor) can create new prescription
tokens. The smart contract furthermore ensures that only someone who signed
a spending request for a token owned by pkpresc with skpresc can spend it, and
only as often as initially speciﬁed by the doctor in count. We also deployed
node.js clients for doctors and pharmacies, which invokes transactions for cre-
ating resp. spending tokens, given the contract address and pkpresc resp. the
contract address and skpresc.

Furthermore, we set up a three-node Hyperledger Indy blockchain network
that provides the functionality to store a schema deﬁning the attributes of
e-prescriptions (“template”), doctor-speciﬁc credential deﬁnitions (specifying
a doctor’s signing key) and revocation registries based on cryptographic accu-
mulators that allow the patient to create ZKPs of non-revocation in their VP.
In addition, we deployed an instance of the Aries Cloud Agent in Python,
which acts as an Indy-client and a REST-API for bilateral communication,
issuance of VC and the creation of veriﬁcation of VPs, for doctors and phar-
macies. Furthermore, we implemented a web-application (frontend) with the
Django framework in Python. This web-application can be used for the doc-
tor’s onboarding process (deploying the smart contract) as well as connecting

Springer Nature 2021 LATEX template

A Decentralized Electronic Prescription Management System

15

Fig. 5 Frontend for establishing a connection between the user’s smartphone and the doctor
resp. the pharmacy.

to patients and issuing an e-prescription to them (resp., making a VP in the
case of the pharmacy). To implement the required functionality for the patient,
we employed a smartphone digital wallet app based on the .NET implementa-
tion of the Hyperledger Aries protocol. The wallet has been developed by the
IT company esatus AG and is available for free in the Google Playstore for
Android and the App Store for iOS. It is not built for a speciﬁc use case like
e-prescriptions but for the generic exchange of veriﬁable information (such as
ID cards, credit cards or diploma) based on standards that are related to the
W3C DID and VC standards [15, 52]. The wallet is also interoperable with the
Aries Cloud Agent implementations in .NET and Python. Beyond the basic
capabilities provided by Hyperledger Aries, such as ZKP-based selective dis-
closure, it additionally supports custom Hyperledger Indy networks, provides
backup functionalities, and recently, it was demonstrated that the content of
the esatus wallet (including cryptographic keys and VCs) can be exported to
and imported from another wallet by the provider called Trinsic [71]. Simi-
lar wallets are also oﬀered by Evernym (Connect.me wallet) and the German
IDunion consortium (LISSI wallet).

The aforementioned smartphone wallets can connect with a cloud agent
through scanning a QR-code. Alternatively, existing communication channels
such as an e-mail can be used for the initial exchange of information, e. g., in
the form of a link, on how to establish a connection. The QR-code contains
the cloud agent’s uniform resource locator (URL) endpoint as well as further
meta-information. It can be static or personalized, and it must be accessible
to the patient, e.g. when checking in at the doctor or on a pharmacy’s website.
After the connection has been established, the doctor can ﬁll out the contents
of the e-prescription on a simple web interface or further automated programs,
as they would do for any electronic and machine-readable prescription. By
selecting the connection to the patient, a doctor can trigger the issuance of the
e-prescription VC to the patient and the creation of the associated token in
the doctor’s smart contract. At the pharmacy’s branch or website, the patient

Springer Nature 2021 LATEX template

16

A Decentralized Electronic Prescription Management System

Fig. 6 Screenshots from the user’s wallet: Overview of the user’s VCs (here: only one e-
prescription for simplicity), visual check of requested attributes in a VP, and overview of
active connections as well as shared data in the esatus wallet.

then only needs to scan a static QR-code, which the wallet can again use to
establish an E2E encrypted connection to the pharmacy. This action automat-
ically triggers a proof request from the pharmacy. Consecutively, the patient
must select the e-prescription they want to spend and conﬁrm that they want
to share the requested attributes. During all these processes, the patient has
full control over which of their personal data is shared, which connections they
have established yet, and also an overview of the data that they have shared.
We present screenshots resp. sections thereof from the wallet during and after
the process in ﬁgure 6.

5 Evaluation

Our proposed solution aims to harmonise the requirements that we determined
in section 3. In the following, we evaluate our design and implementation along
the derived requirements.

We address multiple requirements of digital e-prescription management sys-
tems by building upon the SSI paradigm. To this end, we rely on SSI for the
interactions of the involved stakeholders, enabling bilateral and hence decen-
tralized data exchange. First, this approach allows users to be in control of
their data, as the standardized VCs, containing prescription-related informa-
tion and the spending key of the associated token, is transferred to patients
and stored only in their digital wallet of choice. Furthermore, the SSI paradigm
allows patients to interact bilaterally with their doctors and pharmacies. As the
authenticity of VPs derived from VCs can be veriﬁed through the issuer’s sig-
nature, no direct communication between doctors and pharmacies is necessary
to verify the correctness of information included in the e-prescription. Accord-
ingly, analogous to a paper-based prescription, users are in control of their
data and with whom they share it. In contrast to centralized architectures, our

………Springer Nature 2021 LATEX template

A Decentralized Electronic Prescription Management System

17

solution does not bear one central control point aggregating patients’
data and thus also avoids a single point of failure, a requirement that authors
have emphasized in the past [8]. Furthermore, storing the data in the users’
wallets also implies pharmacy independence. This is due to two reasons.
First, as the data is under control of the user rather than being stored in a
central database, patients themselves can permit access rather than doctors
specifying access rights at the time of creation. Second, as the tokens’ spending
key is stored in the VCs, any pharmacy that can access the smart contract (in
our design, this is a trivial condition as the blockchain is public) and the pub-
lic revocation registry is able to verify, accept, and invalidate e-prescriptions.
Thus, our architecture enables patients to select their pharmacy of choice
for redeeming their e-prescriptions, including online pharmacies, as the entire
process is digital.

Storing the tokens’ spending key in the VCs also implies that keys do not
have to be transferred to the user through an additional technical compo-
nent. Accordingly, token-related key management does not involve patients
directly, which decreases complexity for them throughout the prescribing and
redeeming process. Instead, our architecture requires patients to use one digital
wallet that they may already use in other contexts. The digital wallet enables
patients to receive VCs from their doctors and present them to pharmacies.
Our demonstration uses a wallet of esatus AG, which beyond supporting the
Hyperledger Aries standards supports custom icons, backups, and is interop-
erable with the Trinsic wallet. Furthermore, we rely on a Hyperledger Indy
blockchain for providing information about doctors’ signing keys, revocation
registries, and schemas as well as credential deﬁnitions on a neutral and decen-
tralized infrastructure. However, while Hyperledger Indy represents current
standards with regards to SSI frameworks, our implementation is not depen-
dent thereof and could be substituted in case alternative frameworks emerge
that support the described standards. The Decentralized Identity Foundation
has already collected dozens of DID resolvers that support multiple blockchains
for publishing DIDs, and there is ongoing work to also provide the distinct func-
tionalities of Indy, such as cryptographic accumulators for revocation, on other
blockchains. Thus, we argue that our architecture ensures interoperability.
However, we also identify potential for future research with regards to this
aspect. As large-scale health systems often embed e-prescriptions, integration
with existing systems like e.g., electronic health records, should be tested for.
Nevertheless, by avoiding lock-in eﬀects induced by data silos and using generic
components like standardized digital wallets, we argue that our architecture
will likely integrate into other systems without major design changes.

Apart from leveraging digital wallets with the SSI paradigm, to satisfy
various requirements of decentralized e-prescription systems, we rely on a
combination with blockchain technology to address additional requirements.
In speciﬁc, we ensure double-spending prevention through the use of
blockchain tokens. In our proposed solution, each e-prescription VC issued
involves the creation of a corresponding blockchain token. In analogy to
paper-based prescriptions, the doctor can specify the number of times the
e-prescription can be redeemed at the time of issuing the e-prescription token,
which is of particular importance for long-term medication plans. This is due

Springer Nature 2021 LATEX template

18

A Decentralized Electronic Prescription Management System

to the reason that the pharmacy redeeming the prescription will only dis-
pense a pharmaceutical if the associated token has not already been spent. We
employ separate blockchains for storing SSI-related information and managing
the tokens due to their respective properties enabling optimized service provi-
sion for the required operations. In theory, however, one blockchain would be
suﬃcient for all operations related to our design.

To ensure the practicability of our system, aspects regarding scalability
and performance must be considered, including throughput, latency, and
costs. Besides, we also assess performance metrics like the end-to-end duration
of the e-prescription creation and spending process for our prototype. Regard-
ing costs, several observations of the system can be made. If the smart contract
described in ﬁgure 4 was implemented on the public Ethereum blockchain, cre-
ating the token would currently cost around 15 USD, and the redemption of an
e-prescription around 2 USD1. Moreover, the throughput would currently be
limited to around 10 tx/s, and the latency for creating and sending the token
would be on the order of a minute and highly volatile. For this reason, we
propose to use a permissioned blockchain as long as the throughput of public
blockchains is very limited and transaction costs are high. In the near future,
second layer solutions such sharding (splitting the blockchain into sub-chains
with a lower degree of redundancy), zk-rollups (a subgroup of participants cre-
ates succinct proofs of the correctness a large number of transactions in a batch
so that only very little storage computational resources are required for verify-
ing the correctness of the aggregate update), and “side channels” (infrequent
on-chain settlement and oﬀ-chain transactions based on multi-signatures and
fraud-proofs) [72] could enable implementing this architecture also on public
permissionless blockchains with acceptable costs.

To estimate whether the throughput of existing permissioned blockchains
is suﬃcient for a hypothetical large-scale e-prescription management system,
we conducted a performance analysis with the distributed ledger performance
scan (DLPS) [73]: To simulate a cross-European e-prescription system, we
deployed a Quorum network in Amazon Web Services, with 8 nodes each in the
data centers in Frankfurt, Dublin, Milan and Stockholm. As mentioned above,
we chose IBFT as consensus mechanism as it is more fault-tolerant (and, thus,
also has a reduced performance compared to RAFT). This makes our network
comparable to the design currently deployed by European blockchain service
infrastructure (EBSI), where every member state of the European Union is sup-
posed to run a private Ethereum node2. For these 32 nodes, we used instances
from the AWS EC2 m5.2xlarge series that have 8 vCPUs and 16 GB RAM.
This speciﬁcation is on the lower bound of what EBSI lists as requirements
for running a node.

1The Gas costs for creating a prescription in public Ethereum are approximately 85,000 Gas. 1
Gas currently costs around 1011 Wei. One Ether corresponds to 1018 Wei, i.e., 1 Gas corresponds
to 10−7 Ether. One Ether currently costs more than 1000 USD, so

1, 000 USD × 1.5 · 105
107
Gas for spending a prescription again depends on the amount to around 14,000 Gas, i.e., around
1 USD – cheaper, but still way too expensive for our use case.

≈ 15 USD.

ccreate ≈

2Although EBSI does not run Quorum nodes but Hyperledger BESU instead, Quorum and
BESU are at the core both based on very similar protocols [74]. Also, regarding their consen-
sus mechanisms, they have similarities: BESU runs IBFT2, an upgrade of the IBFT consensus
mechanism in our Quorum network.

Springer Nature 2021 LATEX template

A Decentralized Electronic Prescription Management System

19

Fig. 7 Benchmark of creating e-prescription tokens on a 32-node cross-European Quo-
rum network on Amazon web services (AWS) m5.2xlarge instances (8 vCPUs, 16 GB RAM)
network with Istanbul byzantine fault tolerant (IBFT) consensus at a request rate of
550 tx/s. Max respectively min means the maximum measured over all nodes; for CPU usage,
additionally max respectively min is taken over all of a node’s cores ﬁrst.

We concentrated our benchmarking eﬀorts on the createPrescription
method, as spendPrescription is signiﬁcantly less computationally expensive3.
Using the DLPS, we found a maximum sustainable throughput of around
630 tx/s with a latency of 2.0 ± 0.3 s in the described setting (see ﬁgure 7).

On the other hand, there are currently 4.5 billion prescriptions a year ﬁlled
in the U.S. [17] and 1.5 million prescriptions per day in the UK [5]. The max-
imum of these is 14 prescriptions per citizen and year on average. In the EU,
this would therefore hypothetically amount to approximately 6.1 billion pre-
scriptions per year, so an average throughput of 200 tx/s for each creating and
spending e-prescription token is required. We assume that prescriptions will
probably be created and spent mainly on working days between 08:00 and
17:00 and there also will be ﬂuctuations. Thus, a multiplier of at least 5 should
be taken into account, which means that around 2,000 tx/s are required. Note
that a larger throughput than 550 tx/s can be achieved with smaller network
sizes, better hardware, or using the RAFT instead of IBFT consensus mech-
anism. Thus, we conclude that a large-scale implementation of our proposed
solution can be considered realistic with existing technology. We also expect
performance improvements caused by eﬃciency enhancements, optimizations
like second-layer solutions as described above, and the opportunity to set up
two or three separate blockchain networks for token management by the time
that all prescriptions in Europe have been digitized. Concerning costs, even
running 10 of the the described Quorum blockchains would cost only around

3The Gas costs of createPrescription are around 5 times higher than the Gas costs of

spendPrescription.

020406080100CPU utilization (%), Traffic (MB/s)-10010203040506070Time (s)05101520253035Cumulative number of transactions (103)requestslinear(requests): y=550x578responseslinear(responses): y=542x1,550cpu usage (min, max)incoming traffic (max)outgoing traffic (max)i/o utilization (max)Springer Nature 2021 LATEX template

20

A Decentralized Electronic Prescription Management System

1,000,000 USD per year for server provision on AWS, which amounts to less
than 10−3 USD per e-prescription [75].

The latency for the createToken and spendToken methods that the doctor
respectively the pharmacy need to invoke during issuing respectively verifying
an e-prescription in our implementation each take around 2.5 s at low through-
put when the block-time of IBFT is conﬁgured to 1 second. Our measurements
also yield that at higher throughput, latency does not increase considerably.

The steps involved in an SSI-based interaction (establishing a connection,
issuing a VC or verifying a VP) as described do not provide a signiﬁcant
challenge regarding scalability as the interactions are conducted bilaterally:
We found that a single cloud agent that the doctor and the pharmacy run
can issue and verify at least two VCs per second, which should be suﬃcient
even for a medical oﬃce with several doctors. Moreover, these clients can be
scaled horizontally if necessary. The processes conducted on the Hyperledger
Indy network do not negatively aﬀect scalability: Doctors can update their
revocation registries in batches, e. g., once a day; and revocation is likely to
happen only rarely anyway. The creation of credential schemas or credential
deﬁnitions only has to be conducted during onboarding processes of doctors
and thus does not require high throughput. Finally, a single Indy node can
serve several hundred reads per second4, so a medium-sized Indy network
with a two-digit number of nodes can handle suﬃciently many read requests
per second. Note that if no proof of revocation is necessary and a pharmacy
stores the DIDs and public keys (credential deﬁnitions) of the doctors in their
vicinity and only updates this local copy occasionally, a VP would not even
need a single write or read operation on the Indy blockchain. We conclude
that our e-prescription management system provides suﬃcient scalability and
performance for hundreds of millions of users.

Regarding the patient-side processes, it takes around 15 seconds for the
patient to open their wallet, establish a connection with the doctor and accept
that the e-prescription is issued to and stored in the patient’s smartphone wal-
let (this involves two user-side conﬁrmations). A similar time is needed from
the patient opening their wallet, scanning the QR code for the redemption pro-
cess until the pharmacy has veriﬁed the VP and that the token has not been
spent yet. We consider this a reasonable time for the end-to-end automation
of the paper-based process (having in mind future optimizations of the cryp-
tographic libraries in use and workﬂow improvements regarding smartphone
wallets), although practical trials would ultimately need to conﬁrm patient’s
satisfaction with the process’ speed.

Apart from ensuring suﬃcient scalability of the prototype, an important
requirement for e-prescriptions relates to information security, which is usu-
ally achieved through the conﬁdentiality, integrity, and availability of data [76].
First, we ensure conﬁdentiality through bilateral data exchange and provid-
ing patients with an option for selective disclosure of information within their
e-prescriptions. Centralized, platform-based approaches to storing and man-
aging e-prescriptions bear risks regarding security and expose shortcomings
in terms of user control and interoperability as well as potential performance
downsides on large scale. Thus, we adopt digital wallets as the main layer for

4We measured this on our own with the same method as applied for the Quorum benchmark

above and do not detail this further.

Springer Nature 2021 LATEX template

A Decentralized Electronic Prescription Management System

21

the exchange of e-prescription related data. Accordingly, the physical prescrip-
tion is digitized through a VC that is stored only on the patient’s device. The
patient can then present information from the VC in a VP to other entities,
in particular to a pharmacy, in a way that is veriﬁable without the need to
contact the issuer, i.e. the doctor. The data minimization capabilities oﬀered
by existing implementations of digital wallets and in particular the opportu-
nity to leverage selective disclosure gives patients privacy and the maximum
control over which data they share. Second, in addition to conﬁdentiality, we
aim to address data integrity through the use of digital signatures in VCs,
which prevent counterfeiting e-prescriptions. Third, to achieve availability, we
rely on a decentralized and, thus, highly resilient blockchain infrastructure for
functionalities that cannot be resolved bilaterally. This includes the preven-
tion of double-spending tokens as well as, e.g., revocation registries for VCs
issued by a doctor. All additional data required for processing e-prescriptions
is stored on a device by the patient. These entities (including, e.g., a doctor
or even a patient) can also decide to rely on cloud agents to facilitate a high
availability of their digital wallets.

6 Discussion

During the literature analysis, we identiﬁed the requirement “Pharmacy
independence”. Fulﬁlling this requirement necessitates some way of synchro-
nization among pharmacies to prevent double-spending. One way would be
to create a centralized platform on which the pharmacies can exchange infor-
mation, which would, however, again raise the problem of interoperability
and security. Alternatively, the pharmacy could ask the doctor for revocation
as soon as they get a VP involving an e-prescription. However, this again
requires a lot of connections between doctors and pharmacies that need to be
maintained and protected.

In case the patient already has a digital wallet for some other digital doc-
uments, such as a state-issued digital id-card, a digital credit card or digital
diploma, patients’ can rely on existing infrastructure, meaning they do not
need to install and get used to another app. These use cases are currently being
explored on implementations of digital wallets in the public and private sec-
tor, for example, by the United States Department of Homeland Security, the
Canadian provinces British Colombia and Ontario, or the German IDunion
consortium. They are implementing on common interoperable standards that
are close but not yet fully compliant with the world wide web consortium
(W3C) standards DID and VC that we described in section 2.3. There are sev-
eral implementations for smartphone wallets, like Evernym’s connect.me and
wallets by Trinsic, lissi and esatus that are freely available. Moreover, there
are open-source implementation of server-based, so-called cloud-agents, such
as the Hyperledger Aries Cloud Agent in Python or .NET. The named wallets
are largely interoperable (sometimes there are small version conﬂicts as code
development of the wallets and the open-source Hyperledger Aries project that
deﬁnes these standards evolve quickly;

Centralized, platform-based approaches

and managing
e-prescriptions bear risks regarding security and expose shortcomings in terms

storing

to

Springer Nature 2021 LATEX template

22

A Decentralized Electronic Prescription Management System

of user control and interoperability as well as potential performance down-
sides on large scale. Thus, we adopt the SSI and digital wallet paradigm as
the main layer for the exchange of e-prescription related data instead. Accord-
ingly, the physical prescription is digitized through a VC that is stored only on
the patient’s device. The patient can then present information from the VC in
a VP to other entities, in particular to a pharmacy, in a way that is veriﬁable
without the need to contact the issuer, i.e. the doctor. The data minimiza-
tion capabilities oﬀered by existing implementations of digital wallets and in
particular the opportunity to leverage selective disclosure, gives patients’ con-
trol over which data they share. Furthermore, the approach allows to use an
already reasonably standardized infrastructure for e-prescriptions.

After all, the doctor can refuse to issue a prescription or invalidate it
(through revocation) in any case, and the pharmacy could always refuse to
accept an e-prescription either (moreover, through the authenticated and thus
non-repudiable information ﬂows in blockchains and in bilateral communi-
cation with digital wallets, the patient could even demonstrate that they
misbehaved in some scenarios).

Opening the wallet and establishing a connection by scanning the QR-code

at the doctor takes around 10 s for the patient.

Straight conﬁrmation (without reading all the details what they disclose)
takes the patient around 16 s from opening the wallet over scanning the QR-
code until the pharmacy gets the requested attributes including a proof of
correctness, a proof of non-revocation, and a conﬁrmation from the blockchain
that the token has not been spent yet and the remaining Redemption attribute
of the prescription token has been reduced.

This gives the patient maximum control over the data that they share,
removes vulnerable data silos, and also increases system resilience and scal-
ability as there is no bottleneck through which all interactions need to pass
(and read access for getting the revocation status on blockchains scales well
with the blockchain size).

Conceptionally, there is no need to have two blockchains, but currently
there is no blockchain that provides support both for the identity-related
functionalities of Indy and customizable smart contracts as we need them
for creating a smart contract in which the doctor can issue tokens. More-
over, if the contract address indicated in the prescription uniquely speciﬁes
the blockchain and the methods that need to be called to check and invali-
date the token, diﬀerent doctors could even deploy their contracts on diﬀerent
blockchains (however, a large number would likely increase complexity as dif-
ferent, as compatible client applications need to be implemented). The doctor
can specify these properties as the pharmacy will need to trust the doctor to
accept e-prescriptions issued by them; so they will accept the way that the
doctor provides to them to make double-spending checks

7 Discussion and Conclusion

To overcome the challenges of current approaches to the management of
medical prescriptions, we design, implement, and evaluate a decentralized
e-prescription management system using blockchain technology and digital
wallets. We develop and benchmark the proposed system along requirements

Springer Nature 2021 LATEX template

A Decentralized Electronic Prescription Management System

23

derived from a thorough literature review. Thus, we contribute a generic design
as well as an illustrative implementation of an e-prescription management
system. The ﬁndings deduced from our evaluation oﬀer insights into the oppor-
tunities and remaining challenges regarding the development of decentralized
systems dealing with sensitive data and business-logic that involves multiple
stakeholders. Our design and implementation also aid practitioners in develop-
ing systems beyond the health sector with similar requirements. The following
chapter includes a discussion of four important implications related to our
design to provide additional context. We subsequently conclude the paper by
identifying our work’s limitations and highlighting opportunities for future
applications and research.

First, the role and necessity of applying blockchain in the context of
SSI systems remain debatable. In our design, we deliberately chose to use a
blockchain for several distinct purposes. As a transparent, highly available, and
tamper-resistant neutral decentralized infrastructure, one blockchain serves
as a permanent ledger storing information of public interest in the context
of SSI: proﬁles of issuing doctors, privacy-preserving revocation registries for
e-prescriptions, and schemas thereof. These functionalities are relevant in the
context of any SSI system, which is why we deem it reasonable to include
a blockchain for these purposes in the respective designs. Nevertheless, these
functionalities are also achievable using centralized infrastructures, however
giving up some of the advantages coming with a blockchain such as indepen-
dence from CAs (in the context of e-prescriptions) and availability. In many
SSI applications, re-use of VCs is desired, such as for national ID VCs. How-
ever, in our case, avoiding possibilities for double-spending e-prescriptions is of
utmost importance. As a result, we incorporated a second blockchain managing
unique tokens corresponding to each e-prescription VC which prevent double-
spending. In principle, a centralized system could also be used for this purpose,
as the data required for the double-spending check is no more conﬁdential in
our construction. We suggest a design that separates the double-spending check
from the layer of exchange of conﬁdential data for any SSI use case requir-
ing a restricted number of usages in VCs. Separating the restriction regarding
double-spending (token) from invalidation (revocation) also allows to prevent
multiple redemptions but at the same time reusing the VC for information
exchange, e. g., to check for cross-reactions of medicals, without a limit.

Second, it is important to note that SSI and blockchain technologies are
characterized by open-source software philosophies and are often freely avail-
able. Moreover, the respective technologies do not include a central, controlling
party by design. Therefore, the stakeholders need to establish adequate gover-
nance structures to ensure the creation of a functioning ecosystem, including
secure processes outside of the technical system proposed. In the context of
prescriptions, the central entities in the respective communities could take
up important roles in this regard. For example, stakeholders must agree on
mechanisms for certifying doctors or the attributes including their data types
speciﬁed in e-prescription VCs. Due to the technical nature of this publication,
we omitted recommendations about governance; however, valuable work on
this topic exists, both in the realm of blockchain technology [35] and SSI [77].
Third, prior research indicates that the acceptance and usefulness of
e-prescriptions increases when the required functionalities are embedded in a

Springer Nature 2021 LATEX template

24

A Decentralized Electronic Prescription Management System

larger ecosystem [78]. This could, for example, include generic systems for man-
aging and exchanging patient health data. To this end, the generic nature of the
components used in SSI systems can provide several promising opportunities.
Network eﬀects can occur through the interplay of a VC-based e-prescription
with other VCs such as digital insurance cards, ID cards, or vaccination cre-
dentials. Thereby, the mutual utility of such VC can be improved, making
the e-prescription framework even versatile, e. g. for a proof of identity in
telemedicine, communicating with an insurance company, or digitizing the
reimbursement process for prescriptions.

Fourth, by combining SSI and blockchain, we suppose that our solution
addresses several regulatory requirements, especially those imposed by the
strict EU GDPR. These include principles for processing personal data such as
data minimization, integrity, and conﬁdentiality, as well as lawfulness, fairness,
and transparency (Article 5 GDPR) [21]. We address data minimization and
conﬁdentially by relying on ZKP through using selective disclosure and releas-
ing only the data requested by the pharmacy. No third parties have access to
this data. This is complemented by the use of unique DIDs for each connection
as well as E2E encrypted connections to provide a private connection between
the parties involved and to minimize the risk of unintended correlation. Nev-
ertheless, ZKPs have been rarely used for signature schemas in practice so
far and are thus still uncharted territory from a regulatory perspective. We
also respect the rights of data subjects, such as the right to erasure (“right
to be forgotten”) (Article 17 GDPR), as no patient-related data or metadata
is stored on the ledger. Rather, by relying on the SSI paradigm, we give the
user the responsibility for their own data such that the right to erasure and
the right to rectiﬁcation are also adhered to (Article 16 GDPR). This design
choice also addresses the right to data portability (Article 20 GDPR) as we use
components oriented at the DID and VC standards and interoperable wallets
for implementing the paradigm.

Our research is not without limitations. In the current design, we provide
conﬁdence on the veriﬁer side (pharmacy) that a user is actually eligible to
redeem a prescription through cryptographic keys and VCs that are stored in
their device but that could potentially be retrieved. Many SSI implementa-
tions and the digital wallets that we discuss in this paper support a mechanism
that allows to prevent not only theft but also the selective sharing of creden-
tials without the necessity to reveal a publicly correlatable id (like a common
public key) in the software, but they do not yet include secure hardware in
every place. In general use cases, such as telemedicine, mechanisms oﬀering
higher levels of assurance are of utmost importance, but on the other hand,
in the case of the redemption of an e-prescription, credential sharing might be
even desirable. However, to date credential delegation mechanisms that allows
a patient to forward their e-prescription VC (including the spending key) to
another user are not integrated in Hyperledger Indy and Aries. Building on the
theoretical work of Camenisch et al. [2017], the implementation is currently
in progress. Further investigations are also required on whether the revoca-
tion registry can be stored on a blockchain from a regulatory perspective or
whether it should be held in central databases to ensure data protection and
security for data subjects. Despite believing that we comply with the current

Springer Nature 2021 LATEX template

A Decentralized Electronic Prescription Management System

25

GDPR policies through the cryptographic accumulator-based design of revo-
cation registries, we suggest considering our presented solution in light of other
data protection regulations such as the CCPA or the U.S. HIPAA data pro-
tection rules. Interviews with legal experts may support a thorough evaluation
of the regulatory compliance of the proposed system and its implementation.
The missing functionality of credential delegation also implies that certiﬁ-
cate chains are currently not supported in our prototype. As a result, if a
doctor wanted to delegate the issuance of e-prescription VCs to their employ-
ees, these would currently need their own public DID and credential deﬁnition
on the Indy blockchain to be individually recognized by pharmacies as trusted
issuers of e-prescriptions, and their own prescription smart contract. The sup-
port of certiﬁcate chains and delegation in SSI could make such a system
substantially easier to implement, govern, and scale. A delegation mechanism
for the e-prescription smart contract is also not yet implemented, but could
easily be included, for example by adding a method that allows the admin to
add further public keys whose controllers are allowed to create new tokens.

Moreover, with long-term private key pairs used by doctors for deploy-
ing smart contracts, one can see how many prescriptions a doctor has issued
in our current implementation. This shortcoming could be addressed through
the usage of ZKP in future work: Like in cryptocurrencies such as Z-Cash or
anonymity pools such as Tornado Cash on Ethereum, introducing a single pool
for creating and spending e-prescription tokens and replacing the currently
used anonymized valid and redeemed e-prescription tokens by cryptographic
commitments and nulliﬁers can prevent the tracking of doctors’ activities. Fur-
thermore, we have also not tested our prototype in practice so far. As the
system’s potential users are highly heterogeneous, a ﬁeld test and subsequent
evaluation in practice is still a signiﬁcant limitation and will be one of the
next steps in our research. However, when we presented our prototype to stu-
dents and practitioners with expertise on blockchain and SSI, their reactions
were very positive and gave us conﬁdence that the proposed architecture can
experience acceptance by diﬀerent stakeholders.

We derive several promising avenues for future research from the discussion
and limitations of our work. First of all, researchers should explore techni-
cal limitations, such as a strong binding of VC to users when a high level
of assurance is required, e. g, through link secrets, biometrics, secure hard-
ware, but also ﬂexible enough to allow for easy usage in settings where only a
low level of assurance is suﬃcient [79]. Further, support for certiﬁcate hierar-
chies is important for key management in large ecosystems, and a discussion
of advantages and disadvantages of blockchain- and CA-based public key
infrastructures (PKIs), as well as decentralized or centralized double-spending
protection, could be started based on ﬁrst successful implementations. Fur-
thermore, we urge researchers to implement and evaluate similar designs in
other use cases in practice. Due to the novelty of the applied technologies in
our proposed system, studies about the interactions of users with respective
systems are still rare. Thus, corresponding research endeavours could study
the respective interactions and resulting implications as well as improvements
for the implementation of our design.

The health sector is currently undergoing rapid changes due to the con-
stantly advancing digitalization of society. Health data is highly sensitive and

Springer Nature 2021 LATEX template

26

A Decentralized Electronic Prescription Management System

therefore requires the application of secure and privacy-preserving technolo-
gies. Owing to their properties in those regards, both blockchain and SSI, and
in particular their combination, oﬀer promising opportunities for the digital
transformation of the health care sector. However, the need for a high degree of
user control on conﬁdential data is also present in many other scenarios, such
as interactions of citizens with their government, or business-to-business inter-
actions. We encourage researchers and practitioners alike to take up our work
and further advance the future of health care as well as cross-organizational
workﬂows in business and public administration.

Supplementary information.

Acknowledgments. We want
to
to
Matthias Babel for his support with the e-prescription smart contract, to
Jana Gl¨ockler for her groundwork on connecting the Hyperledger Aries Cloud
Agent in Python with the Django framework, and to Jonathan Lautenschlager
for his valuable feedback and suggestions for improvement.

express

special

thanks

our

References

[1] Guggenberger, T., Lockl, J., R¨oglinger, M., Schlatt, V., Sedlmeir, J.,
Stoetzer, J.-C., Urbach, N., V¨olter, F.: Emerging Digital Technologies to
Combat Future Crises : Learnings From COVID-19 to be Prepared for the
Future. International Journal of Innovation and Technology Management
(2021)

[2] Meena, D.K., Dwivedi, R., Shukla, S.: Preserving Patient’s Privacy using
Proxy Re-Encryption in Permissioned Blockchain. In: IEEE Sixth Inter-
national Conference on Internet of Things: Systems, Management and
Security, pp. 450–457 (2019)

[3] Thatcher, C., Acharya, S.: Pharmaceutical Uses of Blockchain Tech-
nology. In: IEEE International Conference on Advanced Networks and
Telecommunications Systems, pp. 1–6 (2018)

[4] Mundy, D., Chadwick, D.W.: A System for Secure Electronic Prescription
Handling. In: Proceedings of The Hospital of the Future, Second Inter-
national Conference On The Management Of Healthcare And Medical
Technology (2002)

[5] Aldughayﬁq, B., Sampalli, S.: Digital Health in Physicians’ and Phar-
macists’ Oﬃce: A Comparative Study of e-Prescription Systems’ Archi-
tecture and Digital Security in Eight Countries. OMICS: A Journal of
Integrative Biology, 1–21 (2020)

[6] Le

Bris, A.,

El Asri, W.:

State

Threats

Cyber
https://blogs.harvard.edu/cybersecurity/ﬁles/2017/01/
risks-and-threats-healthcare-strategic-report.pdf Accessed 2021-07-24

Organizations

Healthcare

in

of Cybersecurity &
(2016).

Springer Nature 2021 LATEX template

A Decentralized Electronic Prescription Management System

27

N.:

[7] Lord,
of
top-10-biggest-healthcare-data-breaches-all-time Accessed 2021-07-24

Breaches
https://digitalguardian.com/blog/

Top
Time

Healthcare

Biggest

(2020).

Data

All

10

[8] Wu, H.-T., Tsai, C.-W.: Toward Blockchains for Health-care Systems:
Applying the Bilinear Pairing Technology to Ensure Privacy Protection
and Accuracy in Data Sharing. IEEE Consumer Electronics Magazine
7(4), 65–71 (2018)

[9] Bruthans, J.: The state of national electronic prescription systems in
the eu in 2018 with special consideration given to interoperability issues.
International Journal of Medical Informatics, 1–6 (2020)

[10] Staﬀord, T.F., Treiblmaier, H.: Characteristics of a blockchain ecosystem
for secure and sharable electronic medical records. IEEE Transactions on
Engineering Management 67(4), 1340–1362 (2020)

[11] Zhang, R., Xue, R., Liu, L.: Security and privacy on blockchain. ACM

Computing Surveys 52(3), 1–34 (2019)

[12] He, M., Han, X., Jiang, F., Zhang, R., Liu, X., Liu, X.: BlockMeds: A
Blockchain-Based Online Prescription System with Privacy Protection.
In: International Conference on Service-Oriented Computing, pp. 299–303
(2019)

[13] Ehrlich, T., Richter, D., Meisel, M., Anke, J.: Self-Sovereign Identity als
Grundlage f¨ur universell einsetzbare digitale Identit¨aten. HMD Praxis der
Wirtschaftsinformatik 58(2), 247–270 (2021)

[14] Ferdous, M.S., Chowdhury, F., Alassaﬁ, M.O.: In Search of Self-sovereign
Identity Leveraging Blockchain Technology. IEEE Access 7, 103059–
103079 (2019)

[15] Sporny, M., Longley, D., Chadwick, D.: Veriﬁable Credentials Data Model
1.0. W3C (2019). https://www.w3.org/TR/vc-data-model/ Accessed
2021-07-24

[16] Kaiser Family Foundation: Retail Prescription Drugs Filled at Pharma-
cies per Capita (2021). https://www.kﬀ.org/health-costs/state-indicator/
retail-rx-drugs-per-capita/ Accessed 2021-07-24

[17] Mattke, J., Maier, C., Hund, A.: How an Enterprise Blockchain Appli-
cation in the U.S. Pharmaceuticals Supply Chain is Saving Lives. MIS
Quarterly Executive 18(4), 245–261 (2019)

[18] Grossman, J.M., Cross, D.A., Boukus, E.R., Cohen, G.R.: Transmit-
ting and Processing Electronic Prescriptions: Experiences of Physician
Practices and Pharmacies. Journal of the American Medical Informatics
Association 19(3), 353–359 (2012)

[19] Thatcher, C., Acharya, S.: RxBlock: Towards the Design of a Distributed

Springer Nature 2021 LATEX template

28

A Decentralized Electronic Prescription Management System

Immutable Electronic Prescription System. Network Modeling Analysis
in Health Informatics and Bioinformatics 9(1), 1–11 (2020)

[20] Kierkegaard, P.: E-Prescription across Europe. Health and Technology

3(3), 205–219 (2013)

[21] European Union: General Data Protection Regulation (GDPR) (2016).

https://gdpr.eu/tag/gdpr/ Accessed 2021-07-24

[22] Papageorgiou, A., Mygiakis, A., Loupos, K., Krousarlis, T.: DPKI: A
Blockchain-Based Decentralized Public Key Infrastructure System. In:
2020 Global Internet of Things Summit (GIoTS), pp. 1–5 (2020)

[23] Hein, A., Schreieck, M., Riasanow, T., Setzke, D.S., Wiesche, M., B¨ohm,
M., Krcmar, H.: Digital platform ecosystems. Electronic Markets, 1–12
(2019)

[24] Nakamoto, S.: Bitcoin: A Peer-to-peer Electronic Cash System (2008).

http://bitcoin.org/bitcoin.pdf Accessed 2021-07-24

[25] Hughes, L., Dwivedi, Y.K., Misra, S.K., Rana, N.P., Raghavan, V., Akella,
V.: Blockchain research, practice and policy: Applications, beneﬁts, lim-
itations, emerging research themes and research agenda. International
Journal of Information Management 49, 114–129 (2019)

[26] McGhin, T., Choo, K.-K.R., Liu, C.Z., He, D.: Blockchain in Healthcare
Applications: Research Challenges and Opportunities. Journal of Network
and Computer Applications 135, 62–75 (2019)

[27] Glaser, F.: Pervasive Decentralisation of Digital Infrastructures: A Frame-
work for Blockchain enabled System and Use Case Analysis. In: 50th
Hawaii International Conference on System Sciences, pp. 1543–1552
(2017)

[28] Chanson, M., Bogner, A., Bilgeri, D., Fleisch, E., Wortmann, F.:
Blockchain for the iot: Privacy-preserving protection of sensor data.
Journal of the Association for Information Systems 20(9), 1274–1309
(2019)

[29] Butijn, B.-J., Tamburri, D.A., Heuvel, W.-J.v.d.: Blockchains: A System-
atic Multivocal Literature Review. ACM Computing Surveys 53(3), 1–37
(2020)

[30] Rossi, M., Mueller-Bloch, C., Thatcher, J.B., Beck, R.: Blockchain
Research in Information Systems: Current Trends and an Inclusive Future
Research Agenda. Journal of the Association for Information Systems
20(9), 1388–1403 (2019)

[31] Amend, J., Fridgen, G., Rieger, A., Roth, T., Stohr, A.: The Evolution
of an Architectural Paradigm – Using Blockchain to Build a Cross-
Organizational Enterprise Service Bus. In: 54th Hawaii International

Springer Nature 2021 LATEX template

A Decentralized Electronic Prescription Management System

29

Conference on System Sciences, pp. 4301–4310 (2021)

[32] Peters, G.W., Panayi, E.: Understanding Modern Banking Ledgers
through Blockchain Technologies: Future of Transaction Processing and
Smart Contracts on the Internet of Money. In: Banking Beyond Banks
and Money, pp. 239–278. Springer, Heidelberg, GER (2016)

[33] Buterin, V., et al.: A Next-Generation Smart Contract and Decen-
tralized Application Platform (2014). https://www.the-blockchain.
com/docs/Ethereum white paper-a next generation smart contract
and decentralized application platform-vitalik-buterin.pdf
2021-07-24

Accessed

[34] Lockl, J., Schlatt, V., Schweizer, A., Urbach, N., Harth, N.: Toward trust
in internet of things ecosystems: Design principles for blockchain-based iot
applications. IEEE Transactions on Engineering Management, 1–9 (2020)

[35] Beck, R., M¨uller-Bloch, C., King, J.L.: Governance in the Blockchain
Economy: A Framework and Research Agenda. Journal of the Association
for Information Systems 19(10), 1020–1034 (2018)

[36] Oliveira, L., Zavolokina, L., Bauer, I., Schwabe, G.: To Token or not to
Token: Tools for Understanding Blockchain Tokens. In: Proceedings of the
39th International Conference on Information Systems, pp. 1–17 (2018)

[37] Pilkington, M.: Blockchain Technology: Principles and Applications. In:
Research Handbook on Digital Transformations. Edward Elgar Publish-
ing, Cheltenham, UK (2016)

[38] Sunyaev, A., Kannengießer, N., Beck, R., Treiblmaier, H., Lacity, M.,
Kranz, J., Fridgen, G., Spankowski, U., Luckow, A.: Token Economy.
Business & Information Systems Engineering, 1–22 (2021)

[39] Lee, K.M., Ra, I.: Data Privacy-preserving Distributed Knowledge Discov-
ery Based on the Blockchain. Information Technology and Management
21(4), 191–204 (2020)

[40] Kannengießer, N., Lins, S., Dehling, T., Sunyaev, A.: Trade-oﬀs between
Distributed Ledger Technology Characteristics. ACM Computing Surveys
53(2), 1–37 (2020)

[41] Kolb, J., AbdelBaky, M., Katz, R.H., Culler, D.E.: Core Concepts, Chal-
lenges, and Future Directions in Blockchain: A Centralized Tutorial. ACM
Computing Surveys 53(1), 1–39 (2020)

[42] Sedlmeir, J., Buhl, H., Fridgen, G., Keller, R.: The Energy Consumption
of Blockchain Technology: Beyond Myth. Business & Information Systems
Engineering 62(6), 599–608 (2020)

[43] Reid, F., Harrigan, M.: An Analysis of Anonymity in the Bitcoin System.
In: Security and Privacy in Social Networks, pp. 197–223. Springer, ???

Springer Nature 2021 LATEX template

30

A Decentralized Electronic Prescription Management System

(2013)

[44] Platt, M., Bandara, R.J., Dr˘agnoiu, A.-E., Krishnamoorthy, S.: In:
Rehman, M., Svetinovic, D., Salah, K., Damiani, E. (eds.) Informa-
tion Privacy in Decentralized Applications. EAI/Springer Innovations in
Communication and Computing. Springer, ??? (2021)

[45] Allen, C.: The Path to Self-Sovereign Identity (2016). http://www.

lifewithalacrity.com/2016/04/the-path-to-self-soverereign-identity.html
Accessed 2021-07-24

[46] M¨uhle, A., Gr¨uner, A., Gayvoronskaya, T., Meinel, C.: A Survey on Essen-
tial Components of a Self-sovereign Identity. Computer Science Review
30, 80–86 (2018)

[47] Avellaneda, O., Bachmann, A., Barbir, A., Brenan, J., Dingle, P., Duﬀy,
K.H., Maler, E., Reed, D., Sporny, M.: Decentralized Identity: Where Did
it Come From and Where is it Going? IEEE Communications Standards
Magazine 3(4), 10–13 (2019)

[48] Preukschat, A., Reed, D.: Self-Sovereign Identity: Decentralized Digital
Identity and Veriﬁable Credentials. Manning, Shelter Island, NY (2021)

[49] Hardman,

D.:

Credentials
gentle-introduction-veriﬁable-credentials/ Accessed 2021-07-24

Gentle

A
(2019).

Veriﬁable
Introduction
https://www.evernym.com/blog/

to

[50] Camenisch, J., Lysyanskaya, A.: An Eﬃcient System for Non-transferable
Anonymous Credentials with Optional Anonymity Revocation. In: Inter-
national Conference on the Theory and Applications of Cryptographic
Techniques, pp. 93–118 (2001). Springer

[51] Hardman, D.: No Paradox Here: ZKPs Deliver Savvy Trust (2020). https:
//www.evernym.com/blog/no-paradox-here-zkps-deliver-savvy-trust/
Accessed 2021-07-24

[52] Sporny, M., Longley, D., Sabadello, M., Reed, D., Steele, O., Allen, C.:
Decentralized Identiﬁers (DIDs) v1.0. W3C (2021). https://w3c.github.
io/did-core/ Accessed 2021-07-24

[53] Kuperberg, M.: Blockchain-based Identity Management: A Survey from
the Enterprise and Ecosystem Perspective. IEEE Transactions on Engi-
neering Management 67(4), 1008–1027 (2020)

[54] Kitchenham, B.A., Charters, S.: Guidelines for performing Systematic
Literature Reviews in Software Engineering. In: EBSE Technical Report
EBSE-2007-01 (2007)

[55] Tanwar, S., Parekh, K., Evans, R.: Blockchain-based Electronic Health-
care Record System for Healthcare 4.0 Applications. Journal of Informa-
tion Security and Applications 50, 2214–2126 (2020)

Springer Nature 2021 LATEX template

A Decentralized Electronic Prescription Management System

31

[56] Engelhardt, M.A.: Hitching Healthcare to the Chain: An Introduction to
Blockchain Technology in the Healthcare Sector. Technology Innovation
Management Review 7(10), 22–34 (2017)

[57] Katuwal, G.J., Pandey, S., Hennessey, M., Lamichhane, B.: Applications
of Blockchain in Healthcare: Current Landscape & Challenges (2018).
https://arxiv.org/pdf/1812.02776 Accessed 2021-07-24

[58] Seitz, J., Wickramasinghe, N.: Opportunities for Using Blockchain Tech-
nology in E-Health: E-Prescribing in Germany. In: Delivering Superior
Health and Wellness Management with IoT and Analytics, pp. 299–316.
Springer, Heidelberg, GER (2020)

[59] Jamil, F., Hang, L., Kim, K., Kim, D.: A Novel Medical Blockchain
Model for Drug Supply Chain Integrity Management in a Smart Hospital.
Electronics 8(5), 1–32 (2019)

[60] Ruby Benita, K., Ganesh Kumar, S., Murugamantham, B., Murugan, A.:
Authentic Drug Usage and Tracking with Blockchain Using Mobile Apps.
International Journal of Interactive Mobile Technologies 14(17), 20–31
(2020)

[61] Chenthara, S., Ahmed, K., Wang, H., Whittaker, F., Chen, Z.:
Healthchain: A Novel Framework on Privacy Preservation of Electronic
Health Records Using Blockchain Technology. Plos one 15(12), 1–35
(2020)

[62] Zhang, P., Schmidt, D.C., White, J., Lenz, G.: Blockchain Technology
Use Cases in Healthcare. In: Advances in Computers vol. 111, pp. 1–41.
Elsevier, Amsterdam, NL (2018)

[63] Kim, J.W., Lee, A.R., Kim, M.G., Kim, I.K., Lee, E.J.: Patient-centric
Medication History Recording System using Blockchain. In: IEEE Inter-
national Conference on Bioinformatics and Biomedicine, pp. 1513–1517
(2019)

[64] Raghavendra, M.: Can Blockchain Technologies Help Tackle the Opioid
Epidemic: A Narrative Review. Pain Medicine 20(10), 1884–1889 (2019)

[65] Mahatpure, J., Motwani, M., Shukla, P.K.: An Electronic Prescription
System Powered by Speech Recognition, Natural Language Process-
ing and Blockchain Technology. International Journal of Scientiﬁc &
Technology Research 8(8), 1454–1462 (2019)

[66] Cadoret, D., Kailas, T., Velmovitsky, P., Morita, P., Igboeli, O.: Proposed
Implementation of Blockchain in British Columbia’s Health Care Data
Management. Journal of Medical Internet Research 22(10), 1–15 (2020)

[67] Gropper, A.: Powering the Physician-Patient Relationship with HIE
of One Blockchain Health IT. In: ONC/NIST Use of Blockchain for

Springer Nature 2021 LATEX template

32

A Decentralized Electronic Prescription Management System

Healthcare and Research Workshop, pp. 1–11 (2016)

[68] Li, P., Nelson, S.D., Malin, B.A., Chen, Y.: DMMS: A Decentral-
ized Blockchain Ledger for the Management of Medication Histories.
Blockchain in Healthcare Today 2, 1–22 (2019)

[69] Finck, M.: Blockchains and Data Protection in the European Union.

European Data Protection Law Review 4, 17–35 (2018)

[70] Ying, B., Sun, W., Mohsen, N.R., Nayak, A.: A secure blockchain-based
prescription drug supply in health-care systems. In: IEEE International
Conference on Smart Applications, Communications and Networking, pp.
1–6 (2019)

[71] Sovrin:
through
sovrin-stewards-wallet-portability/ Accessed 2021-07-24

Interoperability Series: Sovrin Stewards Achieve Break-
https://sovrin.org/

in Wallet

Portability

(2020).

[72] Gudgeon, L., Moreno-Sanchez, P., Roos, S., McCorry, P., Gervais, A.:
SoK: Oﬀ The Chain Transactions (2019). https://eprint.iacr.org/2019/
360.pdf Accessed 2021-07-24

[73] Sedlmeir, J., Ross, P., Luckow, A., Lockl, J., Miehle, D., Fridgen, G.: The
DLPS: A Framework for Benchmarking Blockchains. In: Proceedings of
the 54th Hawaii International Conference on System Sciences, pp. 6855–
6864 (2021)

[74] Comission, E.: EBSI Architecture (2020). https://ec.europa.eu/cefdigital/
wiki/display/CEFDIGITALEBSI/Architecture Accessed 2021-07-24

[75] Services, A.W.: Amazon EC2 On-Demand Pricing (2021). https://aws.
amazon.com/ec2/pricing/on-demand/?nc1=h ls Accessed 2021-07-24

[76] Whitman, M., Mattord, H.: Principles of Information Security. Cengage

Learning, Boston, MA (2011)

[77] Joosten, R., den Breeijen, S., Reed, D.: Decentralized SSI Gover-
nance, the Missing Link in Automating Business Decisions (2021).
https://www.researchgate.net/publication/348325716 Decentralized
SSI Governance the missing link in automating business decisions
Accessed 2021-07-24

[78] Tamblyn, R., Huang, A., Kawasumi, Y., Bartlett, G., Grad, R., Jacques,
A., Dawes, M., Abrahamowicz, M., Perreault, R., Taylor, L., et al.: The
Development and Evaluation of an Integrated Electronic Prescribing and
Drug Management System for Primary Care. Journal of the American
Medical Informatics Association 13(2), 148–159 (2006)

[79] Hardman, D., Harchandani, L., Othman, A., Callahan, J.: Using Bio-
metrics to Fight Credential Fraud. IEEE Communications Standards
Magazine 3(4), 39–45 (2019)

