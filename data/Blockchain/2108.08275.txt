TB-ICT: A Trustworthy Blockchain-Enabled System
for Indoor COVID-19 Contact Tracing

Mohammad Salimibeni†, Graduate Member, IEEE, Zohreh Hajiakhondi-Meybodi‡, Graduate Member, IEEE,
Arash Mohammadi†, Senior Member, IEEE, and Yingxu Wang††, Fellow, IEEE
†Concordia Institute for Information Systems Engineering, Concordia University, Montreal, Canada
‡ Department of Electrical and Computer Engineering, Concordia University, Montreal, Canada
†† Department of Electrical and Computer Engineering, University of Calgary, Calgary, AB, Canada

1
2
0
2

g
u
A
9

]

R
C
.
s
c
[

1
v
5
7
2
8
0
.
8
0
1
2
:
v
i
X
r
a

Abstract—Recently, as a consequence of the COVID-19 pan-
demic, dependence on Contact Tracing (CT) models has signiﬁ-
cantly increased to prevent spread of this highly contagious virus
and be prepared for the potential future ones. Since the spreading
probability of the novel coronavirus in indoor environments is
much higher than that of the outdoors, there is an urgent and
unmet quest to develop/design efﬁcient, autonomous, trustworthy,
and secure indoor CT solutions. Despite such an urgency, this
ﬁeld is still in its infancy. The paper addresses this gap and
proposes the Trustworthy Blockchain-enabled system for Indoor
Contact Tracing (TB-ICT) framework. The TB-ICT framework
is proposed to protect privacy and integrity of the underlying
CT data from unauthorized access. More speciﬁcally, it is a fully
distributed and innovative blockchain platform exploiting the
proposed dynamic Proof of Work (dPoW) credit-based consensus
algorithm coupled with Randomized Hash Window (W-Hash)
and dynamic Proof of Credit (dPoC) mechanisms to differentiate
between honest and dishonest nodes. The TB-ICT not only
provides a decentralization in data replication but also quantiﬁes
the node’s behavior based on its underlying credit-based mecha-
nism. For achieving high localization performance, we capitalize
on availability of Internet of Things (IoT) indoor localization
infrastructures, and develop a data driven localization model
based on Bluetooth Low Energy (BLE) sensor measurements.
The simulation results show that the proposed TB-ICT prevents
the COVID-19 from spreading by implementation of a highly
accurate contact
tracing model while improving the users’
privacy and security.

Index Terms— Blockchain, Contact Tracing, Indoor

Localization, Bluetooth Low Energy (BLE).

I. INTRODUCTION

Novel Coronavirus disease (COVID-19) has abruptly and
undoubtedly changed the world as we knew at the end of
the 2nd decade of the 21st century. Highly contagious nature
of the novel coronavirus has resulted in a global outbreak
and has signiﬁcantly imperiled global healthcare systems [1],
[2]. On account of such a highly contagious disease, people
around the world are being asked to practice strict social
distancing protocols. In this regard, Contact Tracing (CT) [3]–
[5], i.e., contact identiﬁcation, contact listing, and follow-ups,
becomes of paramount importance. Manual CT solutions [6]
are labor-intensive, making it inefﬁcient, error-prone, and time-
consuming in addition to suffering from potential security

This Project was partially supported by the Department of National De-

fence’s Innovation for Defence Excellence and Security (IDEaS) program.

and privacy issues. For these reasons, the focus of recent
research works [7] have been shifted towards development of
autonomous CT models. Using technologies such as Internet
of Things (IoT), mobile applications, and/or wearable devices,
efﬁcient autonomous CT solutions [6], [8] can be implemented
to immediately inform potential users at risk, while reducing
the required amount of labor force. Since the spreading prob-
ability of COVID-19 in indoor environments is higher than
that of outdoors [9], there is an urgent and unmet quest to
develop/design trustworthy indoor CT solutions with highest
achievable tracking capabilities. To achieve these objectives
(i.e., trustworthiness and high indoor localization accuracy),
we focus on (i) Blockchain-enabled design, coupled with (ii)
Angle of Arrival (AoA)-based localization via Bluetooth Low
Energy (BLE) beacons.

With regards to the Objective (i), a critical aspect for wide-
speared adoption of indoor CT models is trustworthiness, i.e.,
assuring and preserving users’ personal data [10], [11]. Sev-
eral countries and related agencies [12] have released recent
reports on security and privacy breaches of CT applications.
Compliance with country-level health and privacy legislation,
however, have yet to be discussed within CT platforms. Decen-
tralized data storage, Decentralized Applications (DApps) [6],
[8], and Blockchain-based methods [13] are potential so-
lutions to address these issues. Among these technologies,
Blockchain-enabled models are favored since they inherently
share users’ data by employing a decentralized structure
and cryptographical encryption that protects the privacy and
security of the shared information. The trust provided based
on a secure/distributed platform that keeps the users’ identity
and personal information anonymously, makes blockchain ap-
proaches an attractive solution to address the aforementioned
concerns [14]. In blockchain-based services, information can
be validated, data storage is immutable, and the data can be
updated in a real-time fashion. More importantly, blockchain-
based applications are, typically, independent of third parties.
Since all nodes share the exact copy of the original data, which
is hashed and chained in different blocks of the blockchain,
it is impossible to manipulate data stored within different
blocks of the system. In summary, in a blockchain-based CT
infrastructure, system’s consistency is not at risk and is widely
resistant to tampering [15].

With regards to the second identiﬁed objective (Objective

 
 
 
 
 
 
(ii), i.e., equipping indoor CT solutions with accurate localiza-
tion), while existing Global Positioning Systems (GPS) can be
used to provide the required accurate localization in outdoor
environments, tracking in indoors is a different and challenging
task. For the design of autonomous indoor CT solutions, pre-
installed IoT sensors [16], [17] can be leveraged to use existing
infrastructures and allow widespread and timely adoption.
To identify, track, and monitor users’ location, which is the
input of an autonomous CT model, several IoT-based indoor
localization technologies such as BLE [18], [19], and Ultra
Wide Band (UWB) [20] frameworks are available. Among
such technologies, BLE-based tracking is of particular interest
due to its ubiquitousness in most modern smart devices, low
power consumption, and low cost. AoA-based localization [21]
triangulation frameworks to
is one of the most efﬁcient
measure users’ location through the direction of the incident
signal. BLE-based AoA estimation, however, was not possible
until recently that direction-ﬁnding feature is introduced to
the Bluetooth 5.1 Core speciﬁcation. Consequently, research
works in this area are still in their infancy. This motivates
the design of a BLE-based AoA estimation to increase the
accuracy of the proposed indoor CT model. Despite recent
researches performed on blockchain-enabled CT models, there
is no integrated infrastructure coupling secure contact iden-
tiﬁcation, accurate indoor localization, and follow-ups via a
decentralized secure approach. The paper addresses this gap.
Contribution: The main contribution of the paper is imple-
mentation of an innovative trustworthy, Blockchain-enabled,
and Smart Indoor Contract Tracing (TB-ICT) framework by
integration of blockchain and IoT technologies. The proposed
blockchain-enabled TB-ICT framework is shown in Fig. 1. In
summary, the paper makes the following key contributions:

• The TB-ICT framework is proposed to protect privacy
and integrity of the underlying CT data from unautho-
rized access. The TB-ICT is an alternative blockchain
platform exploiting the proposed dynamic Proof of Work
(dPoW) credit-based consensus algorithm coupled with a
Randomized Hash Window (W-Hash) and dynamic Proof
of Credit (dPoC) mechanisms to differentiate between
honest and dishonest nodes. Unlike the existing CT
solutions [22]–[25], which are centralized and potentially
vulnerable to information leakage, TB-ICT is a fully dis-
tributed framework without any reliance on third parties.
The TB-ICT not only provides a decentralization in data
replication but also quantiﬁes the node’s behavior based
on its credit-based mechanisms. A Proof of Concept
(PoC) version of the TB-ICT framework implementation
is made publicly accessible1. In this PoC, sample local-
ization data is fed to the local database of distributed
nodes and the proximity of users is calculated and saved
in the database.

• To boost the accuracy of the TB-ICT model, we design
an efﬁcient data driven AoA-based indoor localization
framework. More speciﬁcally, to avoid the need to ana-
lytically model noise, path-loss, and multi-path effects, a
Convolutional Neural Network (CNN) model is designed

1https://github.com/MSBeni/SmartContactTracing Chained

2

on the subspace-based angle estimation in a 3-D indoor
environment. For robust localization even in the worst-
case scenario, we consider an indoor environment without
presence of Line of Sight (LoS) links affected by Additive
White Gaussian Noise (AWGN) with different Signal to
Noise Ratios (SNRs). Moreover, the destructive effect of
the elevation angle of the incident signal is considered.
The rest of the paper is organized as follows: In Section II
related works are discussed. Section III formulates the BLE
signal to extract location information and introduces the pro-
posed CNN-based AoA localization framework. In Section IV,
we introduce the proposed blockchain-based TB-ICT frame-
work. Simulation results are presented in Section V. Finally,
Section VI concludes the paper.

II. RELATED WORKS

Four of the most well-known CT applications recently pro-
posed are TraceTogether from Singapore [22], Google/Apple
joint project on a CT platform [23], COVID-19 application
proposed by National Health Service (NHS) [24], and Chinese
application named Health code system [25]. TraceTogether is a
centralized service that uses Bluetooth technology to discover
and store close proximity of users locally. BLE security con-
cerns, e.g., bugging, snifﬁng, jamming, and power consump-
tion in active advertisement fashions, are the issues related to
this approach. Apple and Google exploit BLE technology as
well. Unlike the TraceTogether, Apple/Google platform does
not hold the user’s real identity/data, but a central server is
used for contact proﬁling and sending necessary notiﬁcations.
The vulnerability in user information leakage, which could
result in privacy issues, is also the same in the NHS COVID-
19 application. On the other hand, the health code system
leveraged a different approach in CT, utilizing QR code-based
relational cross-match instead of BLE. While the health code
is a better platform due to its lower power consumption, the
centralization of the platform and violating the importance of
anonymity of the users are key security issues of this platform.
In what follows, ﬁrst, we provide a brief overview of AoA
and BLE-based localization, then we outline recent literature
on blockchain-based approaches:
BLE Literature Review: High power consumption is one
of the most important challenges of wireless technology for
IoT applications. BLE technology has opened the way for
IoT applications to ﬂourish by enabling low-energy commu-
nications. BLE uses the same frequency spectrum as WiFi,
ranging from 2.4 to 2.48 GHz, with 37 data channels and 3
advertisement channels, each with a bandwidth of 2 MHz [19].
There are several BLE-based indoor localization frameworks
including but not limited to Received Signal Strength (RSS)-
based methods [26], Time of Arrival (ToA) [27], and Angle
of Arrival (AoA) [21]. AoA-based localization is an active
research ﬁeld, where among all possible approaches, subspace-
based angle estimation algorithms [28], [29], such as MUltiple
Signal CLassiﬁcation (MUSIC) and its extensions, are among
the most reliable methods, especially in the presence of
noise. Subspace-based algorithms, however, are prone to the
multi-path effect, which is an unavoidable factor in indoor
environments [30]. Under the assumption that there is a strong

LoS path between the transmitter and the receiver, there are
a variety of approaches to mitigate the multi-path effect,
including channel classiﬁcation [31], Kalman ﬁlter-based tech-
niques [32], and subsample interpolation methods [33]. There
are, however, key challenges ahead: On the one hand, due
to the computational complexity of the multi-path identiﬁca-
tion/mitigation methods, it is challenging to analytically model
and compensate for the multi-path effect. On the other hand,
ensuring that the receiver receives at least one LoS signal is a
particular challenge. For these reasons, the focus has shifted
to data-driven approaches such as those based on Artiﬁcial In-
telligence (AI) [34], [35]. Consequently, the need for complex
and precise analytical models is reduced by considering the
effects of multi-path, noise, and path-loss on the train dataset
of the AI models. In this context, Reference [36] introduced
a CNN-based AoA localization method in a 2-D indoor
environment, where the transmitted signal is only affected by
noise. Although the elevation angle of the incident signal is
not used for localization purposes, it leads to a considerable
location error. Therefore, it is essential to consider a 3-D
indoor environment. For this reason, the effect of noise on
the estimated angle in a 3-D indoor environment measured
by DNNs was investigated by the authors in [37]. Similarly,
authors in [34], [35], [38] proposed a DNN-based localization
framework, where the Channel Impulse Response (CSI) is the
input of the DNN, which is prone to noise, shadowing, and
small-scale fading, increasing the localization error.

Blockchain Literature Review: Blockchain is a distributed
ledger that uses cryptography, Public Key Infrastructure (PKI),
economic modeling, and a shared consensus mechanism to
synchronize a distributed database. Blockchain can be con-
sidered as a Peer-to-Peer (P2P) network, operating on a
large number of distributed devices to securely store/manage
information, and transfer immutable append-only transaction
logs, which are signed cryptographically [47]. More precisely,
blockchain is a hierarchical chain of blocks, where each block
stores transactional records with transactions being distributed
across the network to improve robustness against unautho-
rized modiﬁcations. Each block header consists of several
ﬁelds, including the hash ﬁeld (representing the block’s hash
value), a ﬁeld to store hash value of the previous block,
the nonce ﬁeld for consensus algorithm, and the main body
ﬁeld. Hash-value is utilized to secure the constituent block.
In this regard, each block appends the hash value of its
preceding to provide a secure chain. To ensure integrity of
transactions, blocks are included in the distributed ledger with
time-stamp and hash value [15]. Each block needs to be mined
and validated by all mining nodes across the network, after
which the block is appended to the chain and cannot be
changed or manipulated afterwards. This process maintains
data integrity and provides a tamper-resistant network. Unique
characteristics of blockchain models such as decentralized
structure, fault-tolerance, persistency, anonymity, transparency,
and immutability [15] make them the ideal technology for IoT-
based applications [48], especially, for securely storing CT
information in a trustworthy and distributed fashion without
dependence on a central processing unit.

3

Recently, blockchain-based and privacy-preserving ap-
proaches [42] are proposed in the wake of the COVID-19
outbreak. The main objective is to protect the identity of
infected users and prevent the release of fake information or
false claims that can produce panic in public. Blockchain-
based localization [39] and CT [10], [40], [41] have been
discussed in recent literature. Most recent researches [10],
[41], however, mainly focused on data security and location
privacy in smart CT services. For instance, Martinez et al. [40]
used blockchain to store digitally signed pairwise encounters,
which are transferred between users’ handheld devices, and
also leveraged AI approaches to recognize close contacts.
Moreover, the platform is focused on the Sybil attack not
deploying localization approaches and designing a privacy-
preserving blockchain-based platform for CT purposes. Xu et
al. [41], on the other hand, proposed the BeepTrace, which is
a platform focusing on user’s privacy in the whole CT system.
Two blockchains for notiﬁcation and tracing are implemented,
and different positional technologies are used, yet no elab-
oration is made on the indoor localization approaches. The
same issue is observed with Reference [10], where the authors
represent a uniﬁed blockchain system for proximity-based
CT and location-based CT considering Bluetooth technology.
In [43], a public blockchain is designed to enable each user
to upload information, i.e., the hash of the encounters list,
about the interaction with others at certain distances and for
a certain period of time as qualiﬁed encounters. Avitabile et
al. [44] deﬁned a robust CT proposal based on BLE leveraging
the Difﬁe-Hellman (DH) secret sharing protocol to protect
the system from more sophisticated attacks. Authors in [45],
proposed Bychain as a permissionless blockchain for tracing
BLE-enable nodes or Long-Term Evolution (LTE) stations or
WiFi access points, based on the location. Some certiﬁed nodes
collect the information about the close interactions and submit
them to the blockchain, and smart contracts will be used for the
proof of location without violation of users’ privacy. PriLok
is proposed in [46], which is a permissioned blockchain that
should be handled by collaboration of various entities, e.g.,
health and public authorities and telecommunication ﬁrms.
PriLok uses a cellular network with the idea that the BLE
technology and smartphones are not available as they should
be speciﬁcally for older people.

III. THE TB-ICT LOCALIZATION MODEL
The structure of the TB-ICT framework, as shown in Fig. 1,
consists of the following two main components: (i) Indoor
localization platform, and; (ii) The Blockchain network. In this
section, we focus on the former category, i.e., the localization,
where as can be seen from Fig. 1(a), the IoT nodes (the BLE-
enabled mobile devices) exchange their unique ID with other
nodes within their local neighborhood. To have an efﬁcient
indoor CT model, it is essential to implement a robust localiza-
tion framework with high accuracy. The proposed localization
solution is described below.

A. CNN-based AoA Localization Framework

In this subsection, ﬁrst we formulate BLE wireless signal
model. Then, we present our proposed CNN-based AoA

4

Fig. 1.

(a) TB-ICT Indoor Localization Platform. (b) TB-ICT Blockchain network.

(a)

(b)

localization framework relying on BLE technology. Fig. 2
illustrates different components of the proposed localization
platform, i.e., (1) BLE transmitter; (2) BLE Wireless channel;
(3) BLE receiver; (4) AoA estimation; (5) Data Preparation,
and; (6) CNN-based localization, which are introduced below:
1. BLE Transmitter: The baseband version of the transmitted
signal sb(t) is calculated as

sb(t) = sb
(cid:114)

=

q(t)

i (t) + jsb
(cid:110)
2E
T

cos(φ(t) + φ0) + j sin(φ(t) + φ0)

(cid:111)
.

(1)

where terms E and T represent the energy and the time
interval of the transmitted symbol, respectively. Term φ0 is
the initial phase of the transmitted signal. Finally, term φ(t),
denoting the phase deviation, is expressed as

φ(t) =

πh
T

(cid:90) t

+∞
(cid:88)

−∞

n=−∞

s[n]p(τ − nT )dτ,

(2)

where h, known as the modulation index, is between 0.45
to 0.55 in BLE standard. Terms s[n] = ±1 and p(t) de-
note the baseband pulse sequence and Gaussian Filter (GF),
the transmitted BLE signal s(t) =
respectively. Finally,
Re{sb(t)ej2πfct}, is modulated by Gaussian Frequency-Shift
Keying (GFSK), i.e.,

by AWGN, are received by the BLE beacons. Therefore, the
received BLE signal can be expressed as

r(t) =

N (t)
(cid:88)

k=1

ρk(t, τ )s(t − τk(t)) + n(t),

(4)

where N (t) represents the number of detachable paths. Terms
ρk(t, τ ) and τk(t) denote the attenuation and the delay of the
kth path, respectively. In addition, term n(t) represents the
AWGN channel, which is modelled by n(t) ∼ N (0, σ2). In a
BLE positioning system, the location of users can be obtained
from the estimated CIR, i.e.,

h(t, τ ) =

N (t)
(cid:88)

k=1

ρk(t, τ )δ(t − τk(t)).

(5)

3. BLE Receiver: To extract the angle of the incident signal,
BLE beacons are required to be equipped with an antenna
array, where commonly the Linear Antenna Array (LAA) is
used. In a typical LAA, there are Ne number of elements with
the same distance d0, where the transmitted BLE signal is
received by distinct elements with different phase differences.
The discrete received signal by element e, sampled at time
slot m, denoted by re[m], is obtained as

re[m] = s

(cid:48)

[m]Θ(θ, φ)[m] + n[m],

(6)

where Θ(θ, φ) denotes the array vector, expressed as follows

s(t) =

(cid:114)

2E
T

cos (2πfct + φ(t) + φ0) ,

(3)

Θ(θ, φ) = exp([−j

cos θ cos φ,

(7)

−j

2πd
λ

sin θ cos φ, −j

sin φ]T ),

2πd
λ

2πd
λ

where 2.4 ≤ fc ≤ 2.48 GHz denotes the carrier frequency.
2. BLE Wireless Channel: Because of the obstacles in indoor
environments, a number of phase delayed and power attenu-
ated versions of the transmitted BLE signal, which are affected

where θ and φ represent the azimuth and elevation angles, re-
spectively. Term d indicates the space between two consecutive
elements of the LAA, which is equal to λ
2 , with λ = c/fc.

5

Fig. 2. Block diagram of the BLE transceiver, wireless channel model, and the proposed CNN-based AoA localization framework.

Finally, term c = 3 × 108 m/s is the speed of light. By
assuming M samples in each received signal, we have

r = [r1[m] . . . rNe [m]]T ,
[m]]T .
1[m] . . . s
s

(cid:48)
= [s

(cid:48)
Ne

(cid:48)

and

(8)

(9)

Therefore, the received signal can be expressed as follows

r = Θ(θ, φ)s

(cid:48)

+ n.

(10)

4. AoA Estimation: Given the angle of the incident signal
through a subspace-based angle estimation algorithm, we pro-
pose to use a CNN model for localization. In this regard, the
spatial spectrum of the received signal, denoted by p(θ, φ, t),
is calculated in each time slot as follows

1

,

(11)

p(θ, φ, t) =

N Θ(θ, φ, t)

ΘH (θ, φ, t)EN EH
where EN is the noise eigenvectors of the covariance matrix
R = E[r, rH ], and r denotes the received signal.
5. Data Preparation: In each time slot, a reshaped angle
image is the input of the CNN, which is generated by
P(θ, φ, t) = [p1(θ, φ, t), . . . , pNb
(θ, φ, t)], where Nb indicates
the number of available BLEs in the user’s vicinity. Since
0 ≤ θ ≤ 180, there are 181 samples in pi(θ, φ, t), where
the minimum value of pi(θ, φ, t) indicates the incident angle
θ. Fig. 2(b) illustrates a typical angle image, containing 724
sets of AoA measurements generated by the subspace-based
algorithm. As can be seen in Fig. 2(b), the original angle image
is of size 4 × 181, reshaped to be an square angle image of
size 28 × 28 by zero padding. This completes presentation of
the localization platform of the TB-ICT. Next, we focus on
the blockchain module.

IV. THE TB-ICT BLOCKCHAIN PLATFORM

The TB-ICT network is a blockchain infrastructure where
each entity act as a node in the system. The nodes are divided
into light nodes and full ones, which is a regular categorization

within the blockchain context. Several nodes participating
in the network are power-constrained mobile devices and
cannot store the whole network data as is the case in the
classical blockchain frameworks. Referred to as light nodes
(as shown in Fig. 1(a)), power constraint devices only store
the data associated with the last 14 days (the period deﬁned
and necessary for checking the infection) and can send and
receive different transactions in the network, including but
not limited to Submission Transaction (ST), Trace Transaction
(TT), Query Transaction (QT), Request Transaction (RT), and
Alarm Transaction (AT). Light nodes can also act as miners
and run the consensus algorithm to mine the block, sign and
broadcast it. The TB-ICT network architecture is shown in
Fig. 1(b), which consists of three main components:
(i) Mobile Devises: Users in the network acting as light
nodes and commute in the environment. The proximity of
these nodes to neighboring devices is estimated in a real-time
fashion leveraging the TB-ICT localization platform as dis-
cussed in Section III. Their contacts will be preserved in their
local device to be used, if necessary, in future transactions.
These nodes will receive credits (positive or negative) over
time based on their proximity-based localization results and/or
their behavior in the network. Each mobile device creates
a blockchain account and receives public and private keys
(Pk, Sk) within the initialization phase as the node’s unique
identiﬁer. The key/pair is used to sign the transactions and
create a unique public identiﬁer to be placed in the BLE
advertisement packets and to be shared with its neighbours.
(ii) Authorized Static Nodes: Static nodes, i.e., the full nodes,
are mostly the legally authorized units, which have read access
to data in the Infected Users Pool (IUP). The infected persons’
data, which is saved in the IUP, is distributed among these
nodes and cannot be changed. When an authorized node
receives data about the infection of a node (a user is recognized
to be infected with COVID-19 in a test center), this data will
be broadcasted to the other authorized nodes. Any claim for
infection by the users in the network will be validated with

6

Fig. 3.

Interconnections within the TB-ICT network.

Fig. 4. TB-ICT randomized hash window (W-Hash) solution to enhance the
security of the proposed Blockchain network.

these nodes, and in case of any false claim, the claiming node
will be punished by receiving negative credit points.
(iii) Manager Static Nodes, are speciﬁc full nodes responsible
for managing (add/delete) the authorized nodes in the network
whose public key is hard-coded into the software. Manager
node M (denoted by ANM ) can lunch a transaction T X to
keep the record of the authorized nodes as follows

T X = SignSKANM

(cid:0)P KAN1, P KAN2, . . . , P KANn

(cid:1),

(12)

where SKANM denotes the secret key of the manager and
(P KAN1 , P KAN2, . . . , P KANn ) represents public key of the
other authorized nodes. Since the manager uses his secret
key, which cannot be forged to sign the transaction, other
authorized nodes can simply fetch the list of the authorized
nodes in the blockchain network published by the manager.
The number of the manager nodes can be deﬁned based on
the distribution of the network and national/provincial policies.
Light nodes with high credit and authorized static nodes act
as miners in the network. Other nodes can submit different
transactions to know about the status of the network (e.g.,
QT and ST) and/or claim an infectious status as a transaction
(i.e., the TT). Interactions between different nodes are shown
in Fig. 3. The TB-ICT architecture is distributed and resilient
to potential cyber attacks. Attacks, such as DDoS, Sybil, or
double-spending, however, would not be of interest for the ma-
licious nodes, as the proposed platform is inherently designed
to securely share and distribute data. There is no monetized
structure to urge attackers targeting the system. In any case,
the data itself is precious, and the users’ information must
be kept safe and secure. In this context, most of the existing
blockchain-based platforms use the Proof of Work (PoW)
consensus protocol, which faces the following key challenges:
(i) Network Scalability: The number of blocks that can
be processed per unit
time represents the throughput
of the blockchain network, which shows the platform’s
scalability;

(ii) Security Vulnerabilities: Keeping the submitted records
and mined transactions immutable is a security-wise
concern that should be proved/improved in a blockchain
platform, and;

(iii) Computational Complexities: The difﬁculty level deter-
mines the processing power (computational complexity)
required to mine a new block.

To address these challenges,
the proposed TB-ICT is an
alternative blockchain platform exploiting the Dynamic PoW
(dPoW) Credit-based consensus algorithm along with a Ran-
domized Hash Window (W-Hash), and Dynamic Proof of
Credit (dPoC). Next, each of these components are detailed.

A. Randomized Hash Window

The introduced Randomized Hash Window, referred to as
the W-Hash, is a mechanism to mine a block, which is similar
in nature to the randomized sliding window algorithm and
the check-points concept [48]. More speciﬁcally, a miner
continuously mines the current block with a number, i.e., the
nonce value, to meet the predeﬁned Difﬁculty Level (DL) and
produces the target hash string. W-Hash makes this hashing
process harder, i.e., the W-Hash mechanism slides through the
blockchain ledger similar to the sliding window algorithm.
In other words, as can be seen in Fig. 4, the miner should
hash the current block along with the sliding window of the
previous blocks. For instance, assume W-Hash is 14, and the
current block number is 100, the miner should consider the
concatenation of block 100 with previous 13 blocks (from 87
to 99) to create the window size of 14. Within the initializing
phase of the TB-ICT network, when a W-Hash is larger than
the current number of blocks in the blockchain, the W-Hash
will be set
the current block will be
hashed based on the previous succeeding blocks determined
and concatenated considering the W-Hash. In the long term,
when more blocks become added to the blockchain, the W-
Hash, which is a value between 0 to 100, can be applied to
every block. The drawback of such an approach is that the
overhead complexity is of O(n), where n denotes the W-Hash
value, when compared to the classical blockchain platforms
with a constant PoW difﬁculty level. To address this issue, we
propose dPoW difﬁculty managed by a credit-based evaluation
mechanism as discussed next.

to zero. Otherwise,

7

TABLE I
DIFFICULTY LEVEL (DL) OF THE PROPOSED DYNAMIC POW
MECHANISM.

variable block size is formulated as follows

SBc = OverheadBc+

DL
DLe
DLh

Size (bits)
4
16

Target Hash
SHA256[0:1]
SHA256[0:4]

Difﬁculty
High
Low

B. Dynamic Proof of Work (dPoW)

As stated previously, there is a tradeoff between security
and scalability in blockchain networks. The proposed W-Hash
solution is an innovative approach to maximize the security of
the network. However, W-Hash directly affects the underlying
computational complexity, mining costs, and mining time.
As stated in [48], a dynamic approach can be employed to
deﬁne the different levels to control the rate of the incoming
communication trafﬁc and the mining difﬁculty. Therefore,
Dynamic PoW consensus approach and credit-based difﬁculty
level (DL) determination for the nodes in the network is a
solution to the added complexity of the W-Hash. Intuitively
speaking, the users in the network with higher credit can
exploit a much easier difﬁculty level in the system helping
them to easily mine the blocks, and the conﬁdential W-Hash
value n will be shared with them securely. On the other hand,
a malicious miner now requires both n − 1 blocks and the
W-Hash value n to mine a new block. A fraud process and/or
faulty behaviors are, therefore, costly as they result in high
negative credits for malicious nodes resulting in the higher
difﬁculty.

In the TB-ICT framework, we consider two difﬁculty levels
to be applied for the nodes in different circumstances. As can
be seen in Table I, Difﬁculty level 1 (DLe) has the lowest
difﬁculty achieved by considering the ﬁrst signiﬁcant digit of
the block hash string, which is calculated by incrementing
the nonce continuously and check the results until meeting
the difﬁculty constraints. The ﬁrst level of difﬁculty DLe is
assigned to the legally authorized nodes and the nodes in
the network with a credit larger than a predeﬁned threshold
(αd). Details of the credit evaluation process will be covered
later in Section IV-C. Due to the low level of difﬁculty, even
devices with limited computational power (if they meet the
constraint set by the credit threshold) can participate in the
mining process. The second difﬁculty level (DLh) is four
times harder than DLe, which is achieved by considering the
ﬁrst four signiﬁcant digits of the target hash string. Level 4
is considered for the low incoming communication trafﬁc and
for dishonest nodes with low credits.

Parameters of

the dPoW: Similar in nature to Bitcoin,
data encryption is implemented in the TB-ICT exploiting
Elliptic Curve Cryptography (ECC) with Elliptic Curve Dig-
ital Signature Algorithm (ECDSA). The block size in the
blockchain of Bitcoin is restricted to 1 megabyte. Unlike
the conventional blockchain model [49], [50], which has a
ﬁxed block size, TB-ICT is designed to have a variable block
size considering incorporation of the dPoW approach in its
consensus algorithm. Given the variable block size of TB-ICT,
we set an upper bound of 1 megabyte for the block size. The

[(Data + EncryptionOverhead) × Ndata],

(13)

is the current block size, OverheadBc

where SBc
is the
block metadata (number of bytes representing a block),
EncryptionOverhead is the number of bytes for current
block data encryption, and Ndata is the number of data
samples added to the current block. The difﬁculty level is
deﬁned as follows

DBc =

DL
T argetHash

,

(14)

where DBc represents the difﬁculty level of the current block,
DL is the level of the difﬁculty in the dPoW, i.e., DLe or
DLh, and the T argetHash is the required string to mine
a block. The mining interval of the blocks, representing the
average time required to mine a block, can be formulated as

IntervelB =

DBc × 2b
HashRate

,

(15)

where HashRate is a miner’s computation power for hash
iteration generation per second, and 2b is responsible for
difﬁculty level (DL) bits control, i.e., 16 bits for the DLh
and 4 bits for DLe. Table I, represents the difﬁculty level in
the proposed dynamic structure.

C. Dynamic Proof of Credit (dPoC)

Consider a CT network with Nnodes number of nodes. Node
i, for (1 ≤ i ≤ Nnodes), is assigned a credit CRi(t) at
time instant t > 0, which is a parameter altering in real-
time based on the node’s interactions and behavior in the
environment. Normal Behaviors, i.e., following the physical
distancing regulations and sending transactions after being
recognized as an infected person, will gradually increase the
user’s credit value over time. On the other hand, abnormal
behaviors will diminish the node’s credit over time. Abnormal
behaviors can be classiﬁed into two main categories:

• Disease-Related Violations: Breaching the physical dis-
tancing regulations and other related rules, which are
mostly bond to the proximity-based localization results.
• Anomalous Behavior in Blockchain Network: Different
anomaly behaviors in the networks including attacks
or wrong claims, e.g., false claims of infection to the
COVID-19 or failing to share contact information in the
case of being diagnosed with COVID-19.

Node i, based on its behavior, can receive negative or positive
scores resulting in the following credit

Cri(t) = CrP rox

i

(t) + Cr−

i (t),

(16)

i

where t is the current time index, CrP rox
(t) is the proximity-
based credit (which can be positive or negative), and Cr−
i (t) ≤
0 is the received negative credit score, which is calculated
based on malicious behaviors of the node in the network. Fol-
lowing Section III, let Oi(t) = {o1(t), o2(t), . . . , oNi(t)(t)},
denote the set of Ni(t) BLE-enabled devices observed by the
ith user (excluding the user itself) at time t. Every few seconds,

this set of devices can be changed as the user moves within
the environment. Based on the distance between user i and a
neighboring BLE-enabled device, Node oj, (1 ≤ j ≤ Ni(t)),
we consider two categories, i.e., immediate nodes (less than
2 meters) and non-immediate node (near or far, when the
distance is more than 2 meters). We deﬁne Pi(oj) as the credit
assigned to Node i based on its proximity to the neighbouring
Node oj ∈ Oi(t) as follows

Pi(oj(t)) =

(cid:40) −1∗λ−

L(i,oj (t)) ,
L(i,oj (t))
λ+

Immediate, L(i, oj(t)) < 2

, Near/Far, L(i, oj(t)) ≥ 2

where L(i, oj(t)) denotes the distance between Agent i and
its contact oj(t) at time t. Terms λ− and λ+ are the credit
calculation coefﬁcients that are deﬁned based on the policy
utilized to punish and reward the users. In a difﬁcult situation
when the disease is highly contagious and preventing policy
should be considered more seriously, both λ− and λ+ can have
a higher value. As can be seen, keeping a healthy distance will
be rewarded by a positive credit. On the other hand, in case of
immediate proximity, the node will be charged with a higher
negative credit score proportional to its closeness to the other
contact. These coefﬁcients allow the model to manage credit
weight distribution. Considering Eq. (17), the proximity credit
assigned to Node i is calculated as follows

CrP rox
i

(t) =

(cid:88)

Pi(oj(t)),

(18)

oj (t)∈Oi(t)

i

where CrP rox
(t) is adjusted based on the level of healthy
preventive behavior practiced by Node i. To measure the total
credit value of a node based on the localization result, this
value will be added to the previously calculated proximity-
based credit to calculate the ﬁnal credit. Based on the scanning
and advertising intervals of the BLE devices, every few
seconds, the new credit value of the user will be updated and
added to the previously calculated proximity-based credit.

Disease-related violations are incorporated into the credit
score based on the proximity results obtained from the lo-
calization model. Term Cr−
i (t) is negatively proportional to
the number of anomalous behaviors of Node i, to account for
anomalous behaviors, i.e.,

Data: TB-ICT Block Mining Algorithm
Result: Target Hash String
initialization;
Check Eligibility of the Node:
if Crµ ≥ αd then

High Credit Node;
set target, T = ”0”;

else

, (17)

Low Credit Node;
set target, T = ”0000”;

8

(cid:17)

;

end
set nonce: Nc = 0;
while mining do

for block.index ∈ [0, 100] do

(cid:16)(cid:80)nwh−1

Hc = h
if Hc == SHA256[T ] then

j=1 Bc−j + [Bc + Nc]

break;

else

Nc + +;

end

end

end

Algorithm 1: TB-ICT Block Mining Algorithm

large value, which will make continuous attacking impossible
for a faulty node. The difﬁculty for a speciﬁc node is then set
as follows

(cid:40)

Du(t) =

DL1,
DL2,

if Cri(t) ≥ αd
if Cri(t) < αd

.

(21)

A new block is designed to be concatenated with nwh number
of former blocks through the dPoW consensus replication
approach. Let Bj represent the jth block of the blockchain, Bc
the current block that should be mined, and Nc as its nonce
value. Hash of the current block (Bc) is formulated as follows



nwh−1
(cid:88)

Hc = h





Bc−j + [Bc + Nc]

 ,

(22)

Cr−

i (t) = −

mi(cid:88)

l=1

ω.

∆T
t − tl

(19)

j=1

where mi is the total number of abnormal behaviors performed
by user i, tl indicates time point of the lth abnormal behavior,
and ∆T represents a unit of time. Term ω(x) is the penalty
coefﬁcient and is computed as follows

ω =






ωF C,
ωSC,
ωN A,

If a false claim is made
If a contact violation happened
If a network attack happened

,

(20)

where all coefﬁcients (ωF C, ωSC and ωN A) can be adapted
based on the network’s punishment policy. A node’s credit
can be measured via Eq. (16) by calculating Cr−
i (t) and
CrP rox
(t). In the case of abnormal claims or malicious
i
behavior of a node, the absolute value of Cr−
i (t) becomes a

where Hc is the hash of the current block and (cid:80)n−1
j=1 Bc−j
denotes the n − 1 W-Hash blocks. If Hc meets the difﬁculty
level requirement, i.e., preﬁx zero length, the block can be
mined, and the nonce value is successfully found. Adjusting
the difﬁculty level based on the preﬁx zero is already discussed
in Section (IV-B). A larger minimum required preﬁx zero
makes it more difﬁcult to ﬁnd the nonce value and to mine
a block. Therefore, honest nodes can consume less power
in the mining procedure based on the proposed dynamic
difﬁculty level mechanism. In contrast, the malicious nodes
will be forced to consume more computational resources,
making them unable to conduct any other abnormal behavior.
Algorithm 1 summarizes the block mining procedure of the
TB-ICT framework.

9

Fig. 5. (a) Experimental data collection of the CNN-based AoA localization framework. (b) An angle image, used as the input of the CNN-based framework.

(a)

(b)

Fig. 6. Exploiting DPoW for different W-Hash values to mine 120 sample
blocks: (a) Difﬁculty Level DLe employed for high-credit and legally
authorized nodes. (b) Difﬁculty Level DLh applied for low credit nodes (e.g.,
Malicious Nodes).

V. EXPERIMENTS

To evaluate the proposed TB-ICT framework, we considered
a real experimental testbed in a rectangular indoor area (10 ×
10) m2, divided into 400 square zones each with dimension
of (0.5 × 0.5) m2 (see Fig. 5(a)). There are 16 BLE beacons,
where the distance between each BLE beacon is equal to 4 m.
There exists 1, 000 number of users, where their movements
are modeled by a random walk.

Six different W-Hash values (0, 20, 40, 60, 80, and 100)
are considered to evaluate the proposed system for its two
different difﬁculty levels, i.e., DLe and DLh as are described
in Table I. Fig. 6 shows the different times spent to mine a
block over different W-Hash values. The W-Hash 0, represents
the classical PoW process while the other W-Hash values,
concatenate the nW H number of blocks with the current block
in order to enter the mining process. These plots are formed
based on localization data of 1, 000 indoor users where all the
nodes are active (have movements in the environment) and
have several interactions. All the interactions are considered
to be collected and used to calculate the users’ credit over
time exploiting Algorithm 1. All the proximities affect the
credit value of the user where the close interactions will push
negative scores to the credit, while near or far proximities
(distances between 2 to 10 meters) will bring positive points
to the user’s credit. However, when a user is recognized to
be infected with COVID-19, only the contacts in immediate
distance to that user will be reported in a transaction to the

Fig. 7. Difﬁculty Level and Mining Time relation in TB-ICT.

blockchain. This will keep the block’s incoming data as little
as possible and improves the system’s throughput.

In our current evaluation setup, we mine 120 blocks and
import a mean of 200 number of transactions to each of them.
Fig. 7, shows the median time spent to mine the block for
different difﬁculty levels. Table II, represents the maximum,
minimum, and average time required to mine a block based on
different difﬁculty levels. The time spent to mine these blocks
based on the W-Hash values completely deﬁnes the superiority
of the dynamic approach to make the mining process easier
for high-credit nodes and legally authorized entities. As the
dPoW is based on randomly selecting the W-Hash value for
the current block to make the anomaly behavior harder to
conduct, the average time spent to mine the block based on
two difﬁculty levels can be a reasonable metric to contrast
the applicability of the system. DLe is far much smaller
than DLh, providing a much easier procedure for the high
credit nodes to mine a block. While in Bitcoin [49], every 10
minute, a new block can be mined, this process in the TB-ICT
framework is much easier and sooner for the high credit nodes.
A high credit miner in this network can mine more than one
block in each second and add the necessary transactions to
the network in a timely fashion. In contrast, this process for
the malicious nodes is much longer. Before conducting any
attack in the network and any attempt to change the data of
the previous blocks, other blocks will be added to the network

TABLE II
DIFFICULTY LEVEL (DL), IN THE PROPOSED DYNAMIC POW.

10

DL
DLe
DLh

Size
4
16

Target Hash Min. Time Max. Time
SHA256[0:1]
SHA256[0:4]

0.9287
4986.3987

0.0018
3.823

Ave. Time
0.34501
1286.6703

Fig. 10. Number of users infected in the test indoor environment because of
one infection case when a different proximity recognition algorithm is used.

Fig. 8. Accuracy and loss of the proposed CNN-based AoA scheme.

Fig. 9. Location error ECDF.

via the honest nodes, and tampering with the signed distributed
data in the network will become harder.

A. Localization Performance

Each user can be localized through a set of BLE beacons
if the corresponding user is located in the receptive ﬁeld
of that BLE. The localization dataset is generated based on
three different channel models: (i) AWGN model, where
10 ≤ SNR ≤ 20 dB; (ii) Rayleigh fading channel, and;
(iii) Rayleigh fading channel affected by noise in a 3-D
indoor environment. We also consider the destructive effect
of the elevation angle on the special spectrum of the AoA
measurements in this dataset. We use 76, 545 angle images
labeled by their location for training. Fig. 5(b) illustrates a
typical angle image, containing 724 sets of AoA measurements
generated by the subspace-based algorithm. The original angle
image is of size 4 × 181, reshaped to be a square angle image
of size 28×28 by zero padding. For the validation and test set,
we use 15, 309 and 10, 206 angle images, respectively, which
are all previously unseen and randomly chosen.

Fig. 11. Infection ratio based on two different social distance measures, i.e.,
2 meters and 5 meters.

is well

Fig. 8. As it can be seen from Fig. 8, the model accuracy
increases and the loss decreases in each epoch, which means
the accuracy of the
trained. Moreover,
the model
proposed localization platform over the test set is 87%, which
is a high location accuracy in the presence of noise, Rayleigh
fading, and elevation angle. To illustrate the superiority of
the proposed approach, we compare the Empirical Cumulative
Distribution Function (ECDF) for location error. As it can be
seen from Fig. 9, CNN-based AoA framework is compared
with Extended Kalman Filter AoA (EKFA), EKF Time Dif-
ference of Arrival (TDoA) (EKFT), Unscented Kalman Filter
AoA (UKFA), UKF ToA (UKFT) [20], and UKF TDoA AoA
(UKFTA) frameworks. According to the results, the location
error of the CNN-based AoA framework is signiﬁcantly lower
than that of its counterparts. By leveraging the proposed
CNN-based AoA localization framework implemented and
embedded in our blockchain-based application, the proposed
TB-ICT framework can positively prevent the spreading of the
COVID-19.

The accuracy and the loss of the proposed CNN-based AoA
framework versus the number of epochs are represented in

To evaluate the feasibility of the trustworthy blockchain-
enabled system in terms of the noise level, we have computed

TABLE III
AVERAGE NUMBER OF INTERACTIONS OF INFECTIONS OUT OF 1, 000 USERS IN INDOOR ENVIRONMENT.

Metric
Avg. No. Interactions
Avg. Gained Credit

CNN
76,306.118
57,111.127

UKFTA
75,770.248
49,716.447

EKFT
75,803.404
43,178.33

UKFT
75,640.436
46,985.936

UKFA
72,247.544
2,995.165

EKFA
72,811.806
26918.931

11

Fig. 12. Credit Score Gained by Users in the Network Considering Different Localization Algorithms. (a) Average Gained Credit Scores in First 4000
Interactions (b) Credit Scores Gained By Six Sample Users in CNN-Based Localization Approach.

(a)

(b)

evaluates the disease spreading trend. According to the results,
one infected user can infect at least 341 users (out of 1000) by
considering 2m as the required social distance criteria. Each of
these users themselves can infect a large number of users in the
environment (second cycle of infection). The contagiousness
can be worsened by considering 5 m as shown in Fig. 11).

B. Evaluation of the Credit-based Mechanism

The credit-based approach can assist with management of
the pandemic promoting users to act rationally. As stated
previously, abnormal behaviors can be classiﬁed into two
main categories, i.e., (i) Disease-Related Violations such as
breaching the physical distancing rule and the rules related to
the disease mostly bond to the proximity-based localization
results, and (ii) Anomalous Behavior in Blockchain Network
including different attacks or wrong claims, e.g., false claims
of infection to the COVID-19 or violating the rule of sharing
the last 14 days contact information in case of being diagnosed
as infected. In our experiments, 1, 000 users are moving in
an indoor venue having interactions with each other. Table III
describes these interactions and related credit points exchanged
between users based on different algorithms. It can be seen that
TB-ICT has better results in gaining credits while the interac-
tions are almost the same. In Fig. 12(a), average credit scores
gained in the ﬁrst 4, 000 interactions between one random user
in the network considering different localization algorithms is
illustrated. Agents following the TB-ICT approach are gaining
more credit in the environment. This calculation of the credit
is based on Eq. (17), while the λ− = 12 and λ+ = 2 are
considered as the credit calculation coefﬁcients. Alternative
coefﬁcient values can be considered based on the pandemic
situation and the community reactions. In Fig. 12(b), credit
scores of six sample users out of all 1, 000 users are shown.
Any anomalous behavior will also be punished heavily in
the TB-ICT network. As Fig. 14 shows, in our experiment,
each malicious activity, e.g., attacks in the network, will be

Fig. 13. Location accuracy versus different values of SNR (dB).

the location accuracy of the TB-ICT framework (after a
speciﬁc epoch where the CNN model is well trained) versus
different SNR values. Note that the common value of SNR
in wireless networks is in the range of 15 ≤ SN R ≤ 40
dB [51], where the SNR greater than 40 dB and lower than
15 dB are considered excellent and unreliable connections,
respectively. Here, the localization dataset is affected by noise,
which is modeled by AWGN with 10 ≤ SNR ≤ 20 dB. Fig. 13
illustrates the impact of the SNR on the location accuracy.
According to the results in Fig. 13, increasing the SNR value
leads to decreasing the location error. By considering the effect
of the low SNR in the range of 10 ≤ SN R ≤ 20 dB on the
train dataset of the proposed TB-ICT framework, it can be
observed from Fig. 13 that the TB-ICT framework is robust
against noise.

Infection Spreading Nature: Given the location of users during
their movements and to illustrate the performance of the
proposed TB-ICT framework, ﬁrst, we investigate how one
infected user can infect other users in its close contact. Fig. 10

12

Secure Data Management: Only the unique IDs of the nodes
will be shared in the network. When a claim is transmitted in
the case of a positive infection result, only the contacts’ IDs
will be shared in the network. All users’ personal information
is kept locally on their devices, without the need to be shared.
Additionally, data encryption is implemented exploiting ECC
with ECDSA to guarantee data security.
Computational Complexity: Considering Eq. (22) and Algo-
rithm 1, hash of the current block (Bc) (if the block is not
already mined) is the hash of the concatenation of the current
block and nwh −1 of the previous blocks with the nonce value.
nwh is the current W − Hash value, which is deﬁned and
shared between the high-credit and legally authorized nodes
based on their credit. To mine the block, miners compete to
solve a mathematical puzzle and ﬁnd the target hash string by
adding the nonce in each step via a trial and error procedure.
The target hash string in the TB-ICT platform has 64 digits in
hexadecimal base. A compressed representation (called “Bits”)
of the target hash string hex value, e.g., 0x1b0404cb is stored
in the blocks. The hexadecimal value is calculated based on
this packed form. For example 0000 0000 2F F 4 04CB 0000
0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000,
hexadecimal string of length 64 and the hash value should be
less than this value to mine a block. The leading zeros (eight
leading zeros 0000 0000) in the target hash string represent
the difﬁculty level. As can be seen in Table I, for the nodes
with higher credits and the legally authorized nodes, the ﬁrst
signiﬁcant digit (1 digit) of the block hash string is considered
the leading zeros. This value will be four signiﬁcant digits
of the block target hash string for the nodes with bad credit
scores. To be more precise, lower target values will lead to
the greater difﬁculty of block mining.

Assuming the length of target hash string is b bits, for a
W − Hash value of size nwh, computational complexity is
of O(nwh × tT H ). Term tT H is the required time to generate
the target hash string in the search space of 2b. Therefore,
computational complexity is of O(nwh × 2b). The malicious
node is now forced to ﬁnd the hashes for all the possible
values of the W − Hash sizes, which directly increases its
computational complexity and, consequently, the attack’s cost.
The complexity in this scenario is increased as follows
Complexity = O(nwh × (nwh × tT H )) = O(n2

wh × 2b) (23)
This attribute also makes other possible attacks such as double-
spending and spamming infeasible. Without the W-Hash, the
complexity of the network to conduct an attack would be as
low as O(tT H ), while this complexity, after applying the hash
window, will be O(n2 × tT H ), which requires n × n more test
and operation to ﬁnd the block’s target hash string. Conse-
quently, the security of the network is signiﬁcantly improved.
On the other hand, based on the credit-based platform, any
malicious attempts to even break this difﬁculty level will have
an irreversible and high credit punishment, causing even higher
computational costs to the faulty nodes.
Consistency of TB-ICT Blockchain: In classical blockchain
networks, consistency is provided via all miners’ agreement
on the longest chain, while synchronous updates about the
latest block may be unavailable for all the miners at a speciﬁc

Fig. 14. An attack scenario illustrating network’s behaviour to punish the
attacker (User 500).

punished with a high negative credit score. The nodes that
are punished based on these attacks lose the chance to be an
honest node in the network or act as a miner. Moreover, Fig. 14
represents the difﬁculty level (αd). Nodes with credit values
above the threshold line can be considered as honest nodes and
participate in the mining process. Difﬁculty level 1 (DLe) has
the lowest difﬁculty with considering the ﬁrst one signiﬁcant
digit of the block hash string. The ﬁrst level of difﬁculty is
applied to the legal, authorized nodes and the nodes in the
network with a credit bigger than a threshold (αd). As can be
seen, malicious behavior directly affects the credit values and
can push the nodes’ credits below the threshold line. Both
nodes 0 and 500 experience this situation and losing their
chance to be above the threshold line.

C. Security Analysis

As ﬁnal step, we focus on the security and trustworthiness

of the proposed framework in different aspects as below:
Removing Centralized Trust, Single Point of Failure and Sybil
attack: The TB-ICT platform is a permissionless network
without any dependency on centralized trust. Any central
dependency increases the risk of data leakage and makes the
system susceptible to the single point of failure issue. The
TB-ICT is a distributed ledger that inherently has several
full nodes having the replicated copy of the whole system.
Consequently, the system is resilient to the failure of some
of the nodes in the network. Different characteristics of the
proposed TB-ICT solution, speciﬁcally the dynamic W-Hash
proof of credit platform, coupled with inherited features of
a blockchain network (being resilient to tampering with the
mined and signed information) can be leveraged to guarantee
the refusal of the unauthorized and malicious nodes.
Guaranteeing the Validity of Shared Data: In a pandemic crisis
such as COVID-91, any fake information or false claims can
produce a panic in public, therefore, accuracy and correctness
of the personalized claims are of vital importance. The pro-
posed dPoC algorithm will prevent publishing any false claims
in the network. False or abnormal claims from any node in
the network can have signiﬁcant negative effects on the credit
score and pushing the malicious nodes to participate under
harder difﬁculty constraints. The higher level of difﬁculty,
inherently, will prevent a potential attack or abnormal behavior
in the network by maximizing the cost of malicious activities.

time. More precisely, some miner nodes may receive the latest
block, while some others not. The TB-ICT framework can
offer a perfect solution for consistency based on the high credit
nodes in the network. Keeping track of the credit value of
the nodes in the network enables the system to recognize the
minimum required number of honest mining nodes that can
acknowledge the current length of the chain and guarantee
the agreed chain will not be removed or lost from the current
chain of the blockchain.

VI. CONCLUSION

In this paper, we proposed a trustworthy blockchain-enabled
system for the indoor COVID-19 contact tracing model, which
securely identiﬁes contact history of COVID-19 patients in
indoor environments. To improve the accuracy of the CT
model, we deployed an AI-based localization approach based
on BLE sensor measurements. More precisely, a CNN-based
AoA estimation framework is applied on the subspace-based
angle estimation in a 3-D indoor environment to avoid the need
for analytical modeling of noise, path-loss, and multi-path ef-
fects. The simulation results showed that the proposed TB-ICT
prevents the COVID-19 from spreading by the implementation
of a highly accurate contact tracing model while improving the
users’ privacy and security. The rationale for deploying BLE
sensors during the current pandemic time is that they are more
ubiquitous in comparison to other technologies such as Ultra-
Wideband (UWB). With the emphasis on higher achievable
accuracy, a fruitful direction for future research is the use of
hybrid UWB/BLE technologies.

REFERENCES

[2] T. Mahmud, et al.,

[1] Y. Wang, et al., “The Cognitive and Mathematical Foundations of Ana-
International Conference on Cognitive Informatics
lytic Epidemiology,”
& Cognitive Computing, Tsinghua Univ., Beijing, China, 2020, pp. 6-14.
“CovTANet: A Hybrid Tri-level Attention Based
Network for Lesion Segmentation, Diagnosis, and Severity Prediction of
COVID-19 Chest CT Scans,” IEEE Trans. Ind. Informat., Dec. 2020.
[3] L. Ferretti, C. Wymant, M. Kendall, L. Zhao, A. Nurtay, L. Abeler-
D¨orner, M. Parker, D. Bonsall, and C. Fraser, “Quantifying SARS-CoV-2
Transmission Suggests Epidemic Control with Digital Contact Tracing,”
Science, Vol. 368, Issue 6491, eabb6936, May 2020.

[4] WHO Team,

“World Health Organization, Coronavirus Disease
from:

Available

(COVID-19) Situation Report

2019
https://www.who.int/docs/default-source/coronaviruse/situation-
reports/20200326-sitrep-66-covid-19.pdf?sfvrsn=9e5b8b48 2,
Accessed 26th Mar. 2020.

66,”

-

Last

[5] J. Hellewell, S. Abbott, A. Gimma, N. l. Bosse, C. I. Jarvis, T. W. Russell,
J. D. Munday, A.J. Kucharski, W. J. Edmunds, F. Sun, “Feasibility of
controlling covid-19 outbreaks by isolation of cases and contacts,” The
Lancet Global Health, 2020.

[6] V. Shubina, S. Holcer, M. Gould, E.S. Lohan, “Survey of Decentralized
Solutions with Mobile Devices for User Location Tracking, Proximity
Detection, and Contact Tracing in the COVID-19 Era,” Data, vol. 5, no.
4, 2020.

[7] I. Braithwaite, T. Callender, M. Bullock, and R. W. Aldridge, “Automated
and Partly Automated Contact Tracing: A Systematic Review to Inform
the Control of COVID-19,” The Lancet Digital Health, Nov. 2020.

[8] M. Scudellari,

“COVID-19 Digital Contact Tracing: Apple and
Available from:

Google Work Together as MIT Tests Validity,”
https://spectrum.ieee.org/the-human-os/biomedical/devices/covid19-
digital-contact-tracing-apple-google-mit-tests-validity, Accessed on 13
Sep. 2020.

[9] Nishiura et al., “Closed Environments Facilitate Secondary Transmission

of Coronavirus Disease 2019 (COVID-19),” medRxiv, Mar. 2020.

13

[10] J. Song, T. Gu, X. Feng, Y. Ge, P. Mohapatra,

“Blockchain Meets
COVID-19: a Framework for Contact Information Sharing and Risk
Notiﬁcation System,” ArXiv:2007.10529, July 2020.

[11] J. Chan, et al., “Pact: Privacy Sensitive Protocols and Mechanisms for

Mobile Contact Tracing,” arXiv:2004.03544, 2020.

[12] H. Cho, et al., “Contact Tracing Mobile Apps for COVID-19: Privacy
Considerations and Related Trade-offs,” ArXiv:2003.11511, Mar. 2020.
[13] M. Zhaofeng, W. Xiaochang, D. K. Jain, H. Khan, G. Hongmin and W.
Zhen, “A Blockchain-Based Trusted Data Management Scheme in Edge
Computing,” IEEE Trans. Ind. Informat., vol. 16,pp. 2013-2021, 2020.
[14] V. Chamola, V. Hassija, V. Gupta, M. Guizani, “A comprehensive review
of the covid-19 pandemic and the role of iot, drones, ai, blockchain, and
5g in managing its impact,” IEEE Access, 8:90225-90265, 2020.

[15] K. R. Choo, Z. Yan, W. Meng, “Editorial: Blockchain in Industrial IoT
Applications: Security and Privacy Advances, Challenges, and Opportuni-
ties,” IEEE Trans. Ind. Informat., vol. 16, no. 6, pp. 4119-4121, 2020.
[16] H. Zhu, K. F. Tsang, Y. Liu, Y. Wei, H. Wang, C. K. Wu, H. R. Chi,
“Extreme RSS based Indoor Localization for LoRaWAN with Boundary
Autocorrelation,” IEEE Trans. Ind. Informat., May 2020.

[17] S. Sadowski, P. Spachos and K. N. Plataniotis, “Memoryless Techniques
and Wireless Technologies for Indoor Localization with the Internet of
Things,” IEEE Internet Things J., vol. 7, no. 11, pp. 10996-11005, 2020.
“Ble Beacons in the Smart City:
IEEE Internet

[18] P. Spachos and K. Plataniotis,

Applications, Challenges, and Research Opportunities,”
of Things Magazine, vol. 3, no. 1, pp. 14-18, Mar. 2020.

[19] Z. HajiAkhondi-Meybodi, M. S. Beni, A. Mohammadi, and K. N.
Plataniotis, “Bluetooth Low Energy-based Angle of Arrival Estimation in
Presence of Rayleigh Fading,” IEEE International Conference on Systems,
Man, and Sybernetics, 2020.

[20] S. Youseﬁ, X. Chang, and B. Champagne, “Mobile Localization in Non-
Line-of-Sight Using Constrained Square-Root Unscented Kalman Filter,”
IEEE Trans. Veh. Technol., vol. 64, no. 5, pp. 2071-2083, May 2015.
[21] Z. HajiAkhondi-Meybodi, M. S. Beni, K. N. Plataniotis, and A. Mo-
hammadi, “Bluetooth Low Energy-based Angle of Arrival Estimation via
Switch Antenna Array for Indoor Localization,” in Pros. International
Conference on Information Fusion, July 2020, pp. 1-6.

[22] J. Bay, J. Kek, A. Tan, C. S. Hau, L. Yongquan, and J. Tan, T. A. Quy,
“BlueTrace: A privacy-preserving protocol for communitydriven contact
Singapores Government Technology Agency,
tracing across borders,”
Singapore, White Paper, p. 9, 2020.

[23] “Exposure Notiﬁcation,” Apple Inc., Cupertino, CA, USA and Google

LLC., Mountain View, CA, USA, May 2020.

[24] I. Levy,

“The Security Behind the NHS Contact Tracing App,”
Accessed: May 8, 2020. [Online]. Available: https://www.ncsc.gov.uk/blog-
post/security-behind-nhs-contact-tracing-app.

[25] P. Mozur, R. Zhong, and A. Krolik, “In Coronavirus Fight, China Gives
Citizens a Color Code, With Red Flags,” New York, NY, USA, 2020.
[Online]. Available: https://www.nytimes.com/2020/03/01/business/china-
coronavirus-surveillance.html.

[26] S. Mehryar, P. Malekzadeh, S. Mazuelas, P. Spachos, K. N. Plataniotis,
and A. Mohammadi, “Belief condensation ﬁltering for RSSI-based state
IEEE International Conference on
estimation in indoor localization,”
Acoustics, Speech and Signal Processing (ICASSP), 2019, pp. 8385–8389.
[27] P. Spachos, I. Papapanagiotou and K. N. Plataniotis, “Microlocation
for Smart Buildings in the Era of the Internet of Things: A Survey of
IEEE Signal Processing
Technologies, Techniques, and Approaches,”
Magazine, vol. 35, no. 5, pp. 140–152, Sep. 2018.

[28] L. Cheng, Y. Wu, J. Zhang and L. Liu, “Subspace Identiﬁcation for
DOA Estimation in Massive/Full-Dimension MIMO Systems: Bad Data
Mitigation and Automatic Source Enumeration,” IEEE Transactions on
Signal Processing, vol. 63, no. 22, pp. 5897-5909, Nov. 2015.

[29] R. Shaﬁn, L. Liu, J. Zhang and Y. Wu, “DoA Estimation and Capacity
Analysis for 3-D Millimeter Wave Massive-MIMO/FD-MIMO OFDM
Systems,” IEEE Transactions on Wireless Communications, vol. 15, no.
10, pp. 6963-6978, Oct. 2016.

[30] A. Yassin, Y. Nasser, M. Awad, A. Al-Dubai, R. Liu, Ch. Yuen, R.
Raulefs, and E. Aboutanios, “Recent Advances in Indoor Localization:
A Survey on Theoretical Approaches and Applications,” IEEE Commun.
Surveys Tuts., vol. 19, no. 2, pp. 1327-1346, Secondquarter 2017.

[31] J. He, Y. Geng, F. Liu and C. Xu, “CC-KF: Enhanced TOA Performance
in Multipath and NLOS Indoor Extreme Environment,” EEE Sensors
Journal, vol. 14, no. 11, pp. 3766-3774, Nov. 2014.

[32] C. Zhang, X. Bao, Q. Wei, Q. Ma, Y. Yang, and Q. Wang, “A Kalman
ﬁlter for UWB positioning in LOS/NLOS scenarios,” in Proc. International
Conference on Ubiquitous Positioning, Indoor Navigation and Location
Based Services, Nov. 2016, pp. 73-78.

[33] R. Exel and T. Bigler, “ToA ranging using subsample peak estimation
and equalizer-based multipath reduction,” IEEE Wireless Communications
& Networking Conference, 2014, pp. 2964-2969.

[34] X. Wang, X. Wang, and S. Mao.

“CiFi: Deep convolutional neural
networks for indoor localization with 5 GHz Wi-Fi,” IEEE International
Conference on Communications (ICC), pp. 1-6, May 2017.

[35] X. Wang, X. Wang and S. Mao, “Deep Convolutional Neural Networks
for Indoor Localization with CSI Images,” IEEE Trans. Netw. Sci. Eng.,
vol. 7, no. 1, pp. 316-327, Mar. 2020.

[36] M. Comiter, and H. T. Kung,

Networks Using Angle of Arrival Images,”
Communications Conference, Abu Dhabi, Dec. 2018, pp. 1-7.

“Localization Convolutional Neural
in Proc. IEEE Global

[37] A. Khan, S. Wang and Z. Zhu, “Angle-of-Arrival Estimation Using an
Adaptive Machine Learning Framework,” IEEE Communications Letters,
vol. 23, no. 2, pp. 294-297, Feb. 2019.

[38] C. Hsieh, J. Chen and B. Nien, “Deep Learning-Based Indoor Local-
ization Using Received Signal Strength and Channel State Information,”
IEEE Access, vol. 7, pp. 33256-33267, 2019.

[39] M. Amoretti, G. Brambilla, F. Medioli, F. Zanichelli, “Blockchain-Based
IEEE Int. Conf. Software Quality, Reliability and

Proof of Location,”
Security Companion (QRS-C), Lisbon, Aug. 2018, pp. 146-153.
[40] M. Martinez, A. Hekmati, B. Krishnamachari and S. Yun,

“Mobile
Encounter-based Social Sybil Control,” Seventh International Conference
on Software Deﬁned Systems (SDS), Paris, France, July 2020, pp. 190-195.
“Beeptrace: Blockchain-Enabled Privacy-Preserving
IEEE Internet

Contact Tracing for Covid-19 Pandemic and Beyond,”
Things J., pp. 1-1, Sep. 2020.

[41] H. Xu, et al.,

[42] D. Nguyen, M. Ding, P. N. Pathirana, A. Seneviratne,

“Blockchain
and ai-based solutions to combat coronavirus (covid19)-like epidemics: A
survey,” Preprints 2020, 2020040325.

[43] S. Micali, “Algorand’s approach to Covid-19 tracing,” Tech. Rep., 2020.
[44] G. Avitabile, V. Botta, V. Iovino, and I. Visconti, “Towards defeating
mass surveillance and SARS-CoV-2: The pronto-C2 fully decentralized
automatic contact tracing system,” IACR Cryptol. ePrint Arch., vol. 2020,
p. 493, May 2020.

[45] W. Lv, S. Wu, C. Jiang, Y. Cui, X. Qiu, and Y. Zhang,

“Towards
largescale and privacy-preserving contact tracing in COVID-19 pandemic:
A blockchain perspective,” IEEE Transaction Netw. Sci. Eng., early access,
Oct. 23, 2020.

[46] P. Esteves-Verissimo, J. Decouchant, M. V¨olp, A. Esfahani, and R.
Graczyk, “PriLok: Citizen-protecting distributed epidemic tracing,” 2020,
arXiv:2005.04519. [Online]. Available: http://arxiv.org/abs/2005.04519.
[47] S. Nathan, C. Govindarajan, A. Saraf, M. Sethi, and P. Jayachandran,
“Blockchain Meets Database: Design and Implementation of a Blockchain
Relational Database,” Proc. VLDB Endow., vol. 12, no. 11, pp. 1539-1552,
May 2019.

[48] U. Javaid and B. Sikdar, “A Checkpoint Enabled Scalable Blockchain
Architecture for Industrial Internet of Things,” IEEE Trans. Ind. Informat.,
Oct. 2020.

[49] S. Nakamoto, “Bitcoin: A peer-to-peer electronic cash system,” 03 2009.
[50] Z. Zheng, S. Xie, H. Dai, X. Chen, and H. Wang, “An overview of
blockchain technology: Architecture, consensus, and future trends,” IEEE
Int. Congress on Big Data (BigData Congress), 2017, pp. 557-564.

[51] Available online: https://www.increasebroadbandspeed.co.uk/what-is-a-
good-signal-level-or-signal-to-noise-ratio-snr-for-wi-ﬁ(accessed on 21-05-
25).

Mohammad Salimibeni , received the B.Sc. degree
in Electrical Engineering from the Isfahan University
of Technology (IUT), in 2011 and the M.Sc. degree
in Electrical Engineering from the same university
(IUT) in 2014. He is currently pursuing the Ph.D.
degree at Concordia University, Montreal, Canada.
As a member of I-SIP Lab, His research interests
include signal processing, Reinforcement Learning
and distributed IoT-based networks with a partic-
ular interest in distributed ledger technology and
Blockchain.

14

Zohreh Hajiakhondi-Meybodi received the B.Sc.
degree in Communication Engineering from Yazd
University, Yazd, Iran and the M.Sc. degree in Com-
munication Systems Engineering (with the highest
honor) from Yazd University, Yazd, Iran in 2013 and
2017, respectively. She is a Ph.D. degree candidate
at Electrical and Computer Engineering (ECE), Con-
cordia University, Montreal, Canada. Since 2019,
she has been an active member of I-SIP Lab at
Concordia University. Her research interests include
general areas of wireless communication networks
with a particular emphasis on Femtocaching, Internet of Things (IoT), In-
door Localization, Optimization Algorithms, and Multimedia Wireless Sensor
Networks (WMSN).

Arash Mohammadi
(S’08-M’14-SM’17) is cur-
rently an Associate Professor with Concordia In-
stitute for Information Systems Engineering, Con-
cordia University, Montreal, QC, Canada. Prior to
joining Concordia University and for 2 years, he
was a Postdoctoral Fellow with the Department of
Electrical and Computer Engineering, University of
Toronto, Toronto, ON, Canada. Dr. Mohammadi is
a registered professional engineer in Ontario. He is
Director-Membership Developments of IEEE Sig-
nal Processing Society (SPS); General Co-Chair of
“2021 IEEE International Conference on Autonomous Systems (ICAS),” and;
Guest Editor for IEEE Signal Processing Magazine (SPM) Special Issue
on “Signal Processing for Neurorehabilitation and Assistive Technologies”.
He is also currently serving as Associate Editor on the editorial board of
IEEE Signal Processing Letters. He was Co-Chair of “Symposium on Ad-
vanced Bio-Signal Processing and Machine Learning for Assistive and Neuro-
Rehabilitation Systems” as part of 2019 IEEE GlobalSIP, and “Symposium on
Advanced Bio-Signal Processing and Machine Learning for Medical Cyber-
Physical Systems,” as a part of IEEE GlobalSIP’18; The Organizing Chair of
2018 IEEE Signal Processing Society Video and Image Processing (VIP) Cup,
and the Lead Guest Editor for IEEE Transactions on Signal & Information
Processing over Networks Special Issue on “Distributed Signal Processing for
Security and Privacy in Networked Cyber-Physical Systems”. He is recipient
of several distinguishing awards including the Eshrat Arjomandi Award for
outstanding Ph.D. dissertation from Electrical Engineering and Computer Sci-
ence Department, York University, in 2013; Concordia President’s Excellence
in Teaching Award in 2018, and; 2019 Gina Cody School of Engineering and
Computer Science’s Research and Teaching awards .

Yingxu Wang is professor of cognitive informatics,
brain science, software science, and denotational
mathematics. He is the founding President of In-
ternational Institute of Cognitive Informatics and
Cognitive Computing (ICIC). He is a Fellow of
ICIC, a Fellow of WIF (UK), a P.Eng. of Canada,
and a Senior Member of IEEE and ACM. He has
leaves) at
been visiting professor (on sabbatical
Oxford University (1995), Stanford University (2008
— 2016), UC Berkeley (2008), and MIT (2012),
respectively. He has been a full professor since
1994. He is the founder and steering committee chair of the annual IEEE
International Conference on Cognitive Informatics and Cognitive Computing
(ICCI*CC) since 2002. He is founding Editor-in-Chiefs of International
Journal of Cognitive Informatics & Natural Intelligence; International Journal
of Software Science & Computational Intelligence; Journal of Advanced
Mathematics & Applications; and Journal of Mathematical & Computational
Methods, as well as Associate Editor of IEEE Trans. on SMC - Systems. He
has served as chair or co-chair of 19 IEEE or other int’l conferences and
a member of IEEE Selection Committee for Senior Members in 2011. Dr.
Wang’s publications have been cited for 15,000+ times according to Google
Scholar. According to Research Gate statistics, his research proﬁle has reached
top 2.5 per cent worldwide, top one to 10 (timely vary in the range) at the
University of Calgary, and the most read work in neural networks. He is the
recipient of dozens international awards on academic leadership, outstanding
contributions, best papers, and teaching in the last three decades.

