An Empirical Study on Ethereum
Private Transactions and the Security Implications

2
2
0
2

g
u
A
4

]

R
C
.
s
c
[

1
v
8
5
8
2
0
.
8
0
2
2
:
v
i
X
r
a

Xingyu Lyu1‚àó, Mengya Zhang2‚àó, Xiaokuan Zhang34, Jianyu Niu1, Yinqian Zhang1‚Ä†, Zhiqiang Lin2
1Southern University of Science and Technology
2The Ohio State University
3George Mason University
4Georgia Institute of Technology

Abstract‚ÄîRecently, Decentralized Finance (DeFi) platforms
on Ethereum are booming, and numerous traders are trying
to capitalize on the opportunity for maximizing their beneÔ¨Åts
by launching front-running attacks and extracting Miner
Extractable Values (MEVs) based on information in the public
mempool. To protect end users from being harmed and hide
transactions from the mempool, private transactions, a special type
of transactions that are sent directly to miners, were invented.
Private transactions have a high probability of being packed to
the front positions of a block and being added to the blockchain
by the target miner, without going through the public mempool,
thus reducing the risk of being attacked by malicious entities.

Despite the good intention of inventing private transactions,
due to their stealthy nature, private transactions have also
been used by attackers to launch attacks, which has a negative
impact on the Ethereum ecosystem. However, existing works only
touch upon private transactions as by-products when studying
MEV, while a systematic study on private transactions is still
missing. To Ô¨Åll this gap and paint a complete picture of private
transactions, we take the Ô¨Årst step towards investigating the
private transactions on Ethereum. In particular, we collect large-
scale private transaction datasets and perform analysis on their
characteristics, transaction costs and miner proÔ¨Åts, as well as
security impacts. This work provides deep insights on different
aspects of private transactions.

I.

INTRODUCTION
Recent years have witnessed an explosive growth of
DeFi [26], which provides end users with Ô¨Ånancial products
and services. By June 2022, the Total Value Locked (TVL)
of DeFi has reached about $114 billion [23]. Moreover, the
number of DeFi wallets has increased to around $4.8 million
as of May 2022 [19]. Among all blockchains, Ethereum is
the second-largest blockchain by market capitalization and the
Ô¨Årst to support smart contracts, which are the foundation of
DeFi. Nowadays, the majority of DeFi TVL ($91 billion) lies
in Ethereum.

Due to the popularity of DeFi platforms and the large
amount of money involved, the number of attacks to steal
transactions
money from them is also arising. Since all
in Ethereum need to be broadcasted before mining, every
transaction will need to stay in the public mempool for some
time. Some attackers have exploited this fact and launched
attacks (e.g., frontrunning [17]) targeting pending transactions
in mempool. In particular, in frontrunning attacks, an attacker

‚àóThe Ô¨Årst two authors contributed equally to this work.
‚Ä†Yinqian Zhang is afÔ¨Åliated with Research Institute of Trustworthy
Autonomous Systems and Department of Computer Science and Engineering,
Southern University of Science and Technology, Shenzhen, Guangdong, China.

observes a victim transaction in the mempool and launches an
attack transaction with certain features (e.g., higher gasprice)
so that the attack transaction will be mined before the victim
transaction, thus making proÔ¨Åts. Another example is the Miner
Extractable Value (MEV) [22], which represents the proÔ¨Åt
that miners can extract from the manipulation of transactions.
For example, two MEV Bots have gained $476,000 recently
by targeting the stablecoin swaps [7].

To help protect transactions from being attacked, private
transactions were proposed. A private transaction is a special
transaction that can be sent directly to miners, bypassing the
public mempool (see Fig. 1). By doing so, such transactions
remain private (i.e., only present
in the target miner‚Äôs
mempool) until they are posted by the target miner, and cannot
be monitored by others. As a result, attackers cannot see
these transactions in their mempool, thus thwarting the attacks.
Besides being hidden from others, private transactions have a
high probability of being packaged to the front position of a
new block by the miner and then added to the blockchain. This
property also motivates MEV searchers, frontrunning attackers,
and arbitragers to seek proÔ¨Åt-making opportunities.

It has been two years since private transactions were
Ô¨Årst introduced by SparkPool in August 2020 [69]. However,
private transactions have not attracted much attention from
the research community. There are several works that have
analyzed the Ethereum blockchain and DeFi platforms,
but
they mainly focus on 1) detecting bugs from smart
contracts [37], [46], [47], [55], [58], [72], [73], [76], 2)
measuring Ethereum networks and transactions [4], [14], [49],
[52], [67], [86], [88], and 3) analyzing transactions to uncover
attacks [63], [66], [83], [87].

there are only a few papers [12],
To date, however,
touched upon private transactions as
[59], [62], [81] that
by-products when they study MEVs. However, the scope of
private transactions goes beyond MEVs. A complete view of
private transactions such as their characteristics and impacts on
the Ethereum ecosystem remains unclear. Although the original
intention of inventing private transactions is to protect users
from attacks, how they are actually used in reality is still an
open question.

In this paper, we make the Ô¨Årst step towards understanding
impacts on the Ethereum
private transactions and their
ecosystem. SpeciÔ¨Åcally, we conduct a large-scale empirical
study on private transactions from three different dimensions:
1) the basic characteristics of private transactions, 2) their
economic impacts to Ethereum such as transaction cost and

1

 
 
 
 
 
 
miner proÔ¨Åts of private transactions, and 3) their security
implications such as the real-world attacks hidden in private
transactions. We collect transaction related information from
customized Ethereum nodes, and we retrieve public data from
Etherscan [33], TradingView [74]. In total, we collect four
datasets for our analysis, containing transaction data from May
1, 2021 to April 30, 2022 (one year) and mempool observation
data from May 22, 2022 to May 30, 2022 (nine days). Based on
these large-scale datasets, we perform a detailed analysis of the
basic characteristics of private transactions, their impacts on
economics as well as on security. To the best of our knowledge,
we are the Ô¨Årst to systematically study the private transactions
and their impacts on the blockchain ecosystem.
Contributions. This paper makes the following contribu-
tions:

‚Ä¢ Large-scale private transaction datasets (Sec. III). We
construct four datasets from public data sources and our
modiÔ¨Åed Ethereum nodes. The datasets include transaction
information in a one-year timespan, as well as the DeFi
platforms, miners, ERC20 tokens, and MEV Bots involved
in each of the transactions. We also build datasets from the
local mempools of two Ethereum nodes deployed on two
continents, which is used to measure private transaction
leakage. To facilitate future research, all the datasets used
in our paper will be open-sourced.

‚Ä¢ Characteristics of private transactions (Sec. IV). We
study the characteristics of private transactions. We Ô¨Ånd that
during the last year, the percentage of private transactions
per month is increasing and rises to about 2% of the total
transaction volume. We categorize the purpose of private
transactions. Although private transactions were proposed
to protect end users from attacks, we Ô¨Ånd that only 18.1%
of them were used for that purpose, whereas 28.6% of them
are actually related to MEV Bots. Besides, Ô¨Åve of the top
ten receivers of private transactions are MEV Bots.

‚Ä¢ Impacts

of

on

private

transactions

blockchain
economics (Sec. V). We study how private transactions
affect the transaction fees and miner proÔ¨Åts. We Ô¨Ånd that
the gas used for private transactions is about 737,829 on
average, which is much smaller than the average gas used
(16,673,757) of normal transactions. We also investigate
the impact of EIP-1559 on private transactions. We Ô¨Ånd
that around 50% of private transactions set the gas price
at zero before EIP-1559; after EIP-1559, since basefees
are mandatory, there are around 22% private transactions
setting the priority fee to zero. The revenue of private
transactions is an integral part of miner proÔ¨Åts, accounting
for around 5% of the total revenue.

‚Ä¢ Impacts of private transactions on blockchain security
(Sec. VI). We study security issues related to private
transactions, including MEV, attack case studies, consensus
security and leakage of private transactions. We Ô¨Ånd that
2.6% private transactions senders earned more than ten
ETH as proÔ¨Åts via MEV Bots. Attackers have already uti-
lized private transactions to launch attacks [5], [8], [18]; in
these attacks, the attackers paid a large amount to the miner
as a bribe to get their transactions executed. According
to our evaluation, the miner earned as high as 700 ETH
for mining a single private transaction. This can lead to
serious consensus security issues, such as the undercutting

2

attacks [13], [22]. We also Ô¨Ånd that private transactions are
not always private. By running two Ethereum nodes in two
continents for nine days, we have observed 4.3% private
transactions in our mempool, which means that they are
actually not private. Therefore, users should proceed with
caution when sending private transactions.

A. Ethereum Basics

II. BACKGROUND

Ethereum [11] is a public, decentralized, and permission-
less blockchain platform, which supports Turing-Complete
smart contracts. In Ethereum, nodes, also called Ethereum
clients, are connected through a P2P network. Moreover, nodes
run a discovery protocol
to Ô¨Ånd other nodes [24] and a
TCP-based transport protocol for data communication [25]. In
particular, the nodes who have the capabilities to create new
blocks are called miners. To produce a new block, a miner has
to pack transactions into the block and then solve the difÔ¨Åcult
puzzle according to the Proof-of-Work (PoW) [29] consensus
mechanism. Once mined, the miner broadcasts the block to
other nodes for validation and execution. For each new block,
miners can receive block rewards and gas fees (introduced
shortly) as earned proÔ¨Åts. There is a gas limit of the total gas
used by the transactions within one block. Note that Ethereum
2.0 will use Proof-of-state (PoS) to replace PoW in the near
future [28].
ERC20
for Comments 20
(ERC20) [27] is a token standard for fungible tokens, which is
the second most popular token type in Ethereum, in addition
to ETH. Any user can own and even create such tokens by
implementing the required smart contract features, such as
transfer(), transferFrom() and balanceOf() functions, as well
as related Events.

tokens. Ethereum Request

B. DeFi

ERC20 tokens are the most popular

tokens created
and used by DeFis. DeFis are decentralized Ô¨Ånancial
applications consisting of multiple smart contracts as backends.
token
DeFis mainly serve for borrowing and lending,
exchanging, asset management, and other similar Ô¨Ånancial
functionalities. By February 2022, there are around 4.4 million
unique Ethereum addresses that have interacted with DeFi
contracts [65].
Stablecoin. Stablecoins are implemented based on the ERC20
token standards to ensure the price stability. For example,
Tether (USDT) [70] is a stablecoin with a price pegged to
1 USD. Similarly to other types of ERC20 tokens, they are
global to reach in the Ethereum network and exchangeable
with any other tokens. As the time of writing, the top three
stablecoins by market capitalisation [30] are Tether, USD Coin,
and TerraUSD.

C. Gas and Fees

To pay for the computational resources to execute a
transaction, every transaction is required to pay a fee that is
decided by both the gas and the gas price. SpeciÔ¨Åcally, the
transaction fee is calculated as: TxFee = UsedGas √ó GasPrice,
where UsedGas refers to the gas amount used for executing
a transaction and GasPrice is the amount that the user would
like to pay per unit of gas. As previously mentioned, a gas
limit is enforced to restrict the total gas used of transactions
in each block.

Fig. 1: The two stages of mining a normal transaction (Tx) vs. a private transaction (PTx) in Ethereum. User A sends a normal
transaction (Tx) to a node (N1), which is then put into the mempool of this node. Generally, in Stage 1 N1 broadcasts Tx to
its peers, N2 and M (M is the miner). However, the Stage 1 is different for a private transaction (PTx) sent from User B, in
which PTx is sent directly to M . In Stage 2, M solves the Proof-of-Work puzzle, and includes PTx and Tx in the newly mined
block. In particular, PTx is put in front of Tx.

EIP-1559. EIP-1559 [61] is a proposal requiring transactions
to pay both the base fee and the priority fee as the total
gasprice. SpeciÔ¨Åcally, basefee is algorithmically determined for
each block in Ethereum, and the priority fee is the optional
fee to motivate miners to include the transactions in new
mined blocks. Before EIP-1559,
there is no limitation on
the gasprice. Users can set zero to the gasprice of their
transactions. However, after the EIP-1559 taking effects, the
gasprice is required to be equal or higher than the basefee
of the mined blocks. On the other hand, the basefee is the
minimum gasprice for mined transactions. Generally, miners
usually choose the transactions with the higher gas price, since
the higher the gasprice, the more proÔ¨Åts miners will earn.
Besides, to avoid network congestion, the gas limit of each
block is doubled from 15,000,000 GWei to 30,000,000 GWei.

D. Private Transactions
Private transactions. Every normal
transaction has to go
through two stages to be mined in blockchain, as shown
in Fig. 1. In particular, a user sends a transaction to Ethereum
nodes in the p2p network, and all nodes will add this
transaction to their local mempool. In contrast, a private
transaction is sent directly to the miners and will not appear
in the mempool of normal nodes. Then, miners pack these
transactions into blocks and put the private transaction in front
of the normal transaction. However, there is a price of being a
private transaction, which is usually to pay the additional fee
by directly sending money during the execution of transaction.
Moreover, the private transaction can be leaked as discussed
in [32]. We perform experiments to conÔ¨Årm the leakage and
discuss the related security issues in Sec. VI-D.
Private transaction relay systems. A relay system is built
to provide a private channel for transactions directly being
submitted from users to miners. Flashbots [36] are one of such
relay systems, and around 90% of miners use Flashbots to earn
such extra proÔ¨Åts [85]. Firstly, an Ethereum user that is usually
a searcher, searches for the MEV opportunities to submit
private transactions and such transactions are then packed
into a bundle. Secondly, relayers that are bundle propagation

services forward the transactions to miners. Finally, miners
mine the transactions into the front places of the new mined
block as long as they are satisÔ¨Åed with the rewards. The
workÔ¨Çow is similar in other relay systems, such as Eden
Network [16].

E. MEV

Daian et al. [22] Ô¨Årst propose the concept of MEV
and introduce the potential risks brought by MEV. Although
MEV is called miner extractable value, it is usually users,
instead of miners,
that search for MEV opportunities and
share the earned proÔ¨Åts with miners. Miners only need to
put MEV related transactions to the top places of blocks
and take shared proÔ¨Åts from users. To compete for extracting
MEV, MEV Bots are created to monitor the blockchain
network automatically for transactions with potential MEV
opportunities and immediately launch related transactions via
channels (e.g., Flashbots [36]). Since being coined in 2019,
MEV has been intensively studied by researchers [59], [81].
The extensive exploration on MEV might cause instabilities
and re-organization on the blockchain network, since miners
are incentivized to re-mine blocks. Moreover, users might
suffer Ô¨Ånancial losses if they are attacked or front-run by MEV
transactions.

III. DATASET

To empirically study private transactions, we extract the
necessary data from some reliable data sources including
Etherscan Label Word Cloud [34] and TradingView [74], as
well as our modiÔ¨Åed Ethereum nodes. In this section, we
explain how we collect data in detail. The datasets and how
they are used in later sections are presented in Table I.

A. One-year Replayed Transaction Dataset

We collect the necessary transaction and block information
from our customized Geth [31] node in full mode, which
is an ofÔ¨Åcial Ethereum client implemented in Go language.
SpeciÔ¨Åcally, we replay every transaction from May 1, 2021
(block 12,344,945) to April 30, 2022 (block 14,688,626) to
extract information and construct our one-year dataset, which

3

N2N1MN1 MempoolTx1Tx2TxTxTxTxN2N1MMMempoolGenerateBlock n+1Block nBlock n-1Block nBlock n-1Block n+1TxPTxTx3Stage1: BroadcastStage2: ConsensusPTxBABlock n+1TxsList:PTxTx‚Ä¶Dataset
One-year Replayed Transaction
Nine-day Mempool Transaction
Smart Contract Label
Private Transaction Label

Timespan
One year
Nine days
One year
One year + Nine days

Information
Data Source
Block info, Transaction info
Geth Replay
Tx info received in mempool
Geth Mempool
Etherscan, TradeView Miner, MEVBot, DeFi, Token
Etherscan

Private transactions

Used In
Sec. IV; Sec. V; Sec. VI
Sec. VI
Sec. IV; Sec. V; Sec. VI
Sec. IV; Sec. V; Sec. VI

TABLE I: Datasets used in the paper. One-year timespan is from May 1, 2021 to April 30, 2022; Nice-day timespan is from
May 22, 2022 to May 30, 2022.

contains 446,925,956 transactions in total. We modify the Geth
node to collect the following information:
Block information. For every block, the obtained information
includes block number,
timestamp, miner address, block
reward, gas limit, gas used, basefee, and burnt fee.
Transaction information. For each transaction, we Ô¨Årst collect
the basic information, including hash, block number, success
status (0 means failure and 1 means success), sender address,
receiver address, ETH value, input, gasused, gasprice, and
gasfee. We also collect the following information:
1) Traces: the information of internal transactions that are the
smart contract calls within the transaction. SpeciÔ¨Åcally, every
internal transaction should record the sender address, receiver
address, ETH value, input, and the call graph information.
2) Money Ô¨Çows: token amount, token address, token sender,
token receiver, and MFGIndex.
In particular, MFGIndex
records the index of the position of current money Ô¨Çow among
all the money Ô¨Çows that include both ETH and ERC20 token
transfers.
3) Money Ô¨Çow graph (MFG): To analyze the used tokens
and DeFi platforms, for every DeFi-related transaction, we
build a money Ô¨Çow graph (MFG). In MFG, nodes represent
the token sender and receiver, and edges indicate the token
related information, including MFGIndex, token name, and
token amount.

B. Nine-day Mempool Transaction Dataset

To measure the leakage of private transactions and see if we
can observe any of them before they are mined on blockchains,
we deploy two modiÔ¨Åed Ethereum nodes in two continents
from May 22, 2022, to May 30, 2022 (nine days) and collect
the received transactions from the local mempool. Note that
transactions in the mempool are not yet mined. SpeciÔ¨Åcally,
we customized the Geth node to log the hash, block number,
timestamp of transactions observed from the mempool of the
two nodes. We obtained 6,720,710 transactions from Node 1
and 7,854,054 transactions from Node 2 during the nine days.

C. Private Transaction Label Dataset

We obtain the private transactions within both the one-
year dataset and the nine-day dataset by crawling Etherscan
Label Cloud [34]. SpeciÔ¨Åcally, we observe 7,405,835 private
transactions obtained from our one-year transaction dataset
and the remaining 439,520,121 are normal
(non-private)
transactions. We also obtain 232,729 private transactions from
the nine-day dataset.

D. Smart Contract Label Dataset

To measure the behaviors of different entities involved
in the private transactions, for each address in our one-year
dataset, we check whether they have the following labels; if
so, we collect the corresponding information:

1) Miner: miner address and the related label. We collect the
miner address of every block in our dataset and check the
address related label1 from the Etherscan Label Cloud.
2) MEVBot: addresses whose label are MEVBots. For every
unique sender and receiver of transactions in our dataset, we
check its label from Etherscan. If the label is MEVBot, we
collect it.
3) DeFi: DeFi platform address and the related label. Similarly,
we collect
the addresses which are marked as DeFi by
Etherscan, and their labels.
4) Token: For each smart contract labeled as ERC20 token,
we obtain the token address and name from Etherscan, and
historical price data from TradingView.

IV. CHARACTERISTICS

In this section, we describe the general statistics of private
transactions by measuring their categories classiÔ¨Åed by their
purposes, the involved DeFi tokens and platforms, and the
involved entities.

A. Distribution
The count and percentage of private transactions. Fig. 2
shows the count of private transactions against per month.
There are at least 0.28 million private transactions every month
and around 0.60 million private transactions on average per
month. Besides, the percentage of private transactions among
all the transactions account for 2% on average per month.
Overall, there are not many private transactions in the total
mined transactions, while the percentage of private transactions
keeps increasing slightly every month.
The distribution of private transactions. Fig. 5 plots the
CDF of private transactions within a single block for the
blocks that have at least one private transaction (1,259,251
blocks, 54%). 93.2% of these blocks have less than 10 private
transactions, and 99.5% of these blocks have no more than
20 private transactions. Only 0.5% have the count of private
transactions greater than 20. The largest count of private
transactions in one block is 615.
Abnormal count of private transactions in some blocks.
Fig. 3 presents the count of private transactions against
per block and also the blocks in the peek periods. There
are four
ranges of blocks that seem to have far more
private transactions than other blocks. The block ranges
are [13,404,461 - 13,497,355], [13,926,965 - 13,949,430],
[14,057,403 - 14,133,216], and [14,636,264 - 14,664,418],
respectively. We show the details of the biggest peek in the
Ô¨Ågure. In particular, not all blocks have far more private
transactions than others, and some blocks have the count of
private transactions below the average. In particular, we study
the blocks with more private transactions than others and Ô¨Ånd

1e.g., 0xEA674fdDe714fd979de3EdF0F56AA9716B898ec8 is labeled as Ethermine.

4

Fig. 2: The count and percentage of
private transactions per month.

Fig. 3: The count of private transactions
per block.

Fig. 4: The count of each type of private
transactions per month.

‚Ä¢ Type

IV (Normal

remaining private
transactions whose receivers are normal smart contracts that
cannot be labeled.

services):

the

The categories of private transactions. We present the count
of private transactions of each type against per month in Fig. 4.
For type I, about 18.1% of private transactions are sent to
call DeFi related services. For type II, there are 28.6% of
private transactions that are sent to MEV Bots, which shows
the increasing need for private transactions for MEV searchers
since the competition of MEV becomes more and more
Ô¨Åerce. For type III, 22.4% of private transactions are used for
transfers. In particular, the senders of these private transactions
are miners and well-known services(e.g., Crypto.com [21]).
In addition, the left 30.9% of private transactions belong to
type IV. Among them, about 650,000 transactions are used for
transferring tokens through the smart contracts.

Finding 1: Only 18.1% of the total private transactions
are used for the original purpose‚Äîprotecting DeFi services
from attacks. More private transactions (28.6%) are used
by MEV Bots in search of MEV opportunities. The actual
usage of private transactions has departed from its design
purpose.

C. DeFi Tokens and Platforms

Most Private transactions are used to interact with the
tokens for different purposes mentioned in Sec. IV-B. We
Ô¨Årst brieÔ¨Çy describe some features of the tokens in private
to give an overview of the usage of tokens.
transactions,
Moreover, we classify the token exchange pattern into different
types according to the token exchange count and token types.
Then we demonstrate the usages of DeFis among the private
transactions and the related tokens, for further deep analysis.
in private
The distribution of
transactions. We present
token Ô¨Çow
numbers of transactions that have at least one and no more
than 20 token Ô¨Çows (99.6% of 5,746,633 private transactions)
in Fig. 6. We exclude 1,659,202 private transactions without
token Ô¨Çow. From the Ô¨Ågure, around 88% transactions have no
more than 4 token Ô¨Çows. In particular, the private transaction 2
has the most token Ô¨Çows (600).
The top token exchange pairs in private transactions. We
measure the most frequently used token exchange pairs of the
private transactions in Fig. 7. From the Ô¨Ågure, we observe that
the exchanges from the stablecoin USDC to WETH takes the

token Ô¨Çow number
the distribution of

20x470ceedf30f8c1c533b0911c2b37ab1c55b0cbd83d1e40c0d44cd7e9f5db1569

Fig. 5: Number of private transactions per block. Only 0.5%
of them have more than 20 private transactions.

that many private transactions are used for miners transferring
ETH to EOAs. Moreover, the other three peeks have similar
patterns.
The positions of private transactions inside blocks. Private
transactions are usually bundled together
to miners and
placed at the top of the block. With the collected 1,259,251
blocks who have at least one private transaction, we observe
that all private transactions are located in front of normal
transactions in blocks. The results are expected since private
transactions are created to race for the opportunities before
other transactions. Thus, they should be put in the top positions
of the blocks.

B. Categories

To better measure the usages and draw insights on the
purposes of private transactions, we categorize them into the
following four types.

‚Ä¢ Type I

(Self protection):

the private transactions that
are only used for DeFi services (e.g., Uniswap trader).
SpeciÔ¨Åcally, such private transactions protect themselves
from risks in the public mempool, such as frontrunning
attacks.

‚Ä¢ Type II (MEV related): the private transactions that MEV
Bots participate in. Private transactions of this type should
have MEV Bots as their recipients and are usually used for
MEV extraction.

‚Ä¢ Type III (Miner payout): the private transactions used to
transfer money to EOAs. Private transactions of this type
are normally sent from miners or other well-known services
and used to transfer ETH.

5

                                                                 √ó    & R X Q W             5 D W L R1250000013000000135000001400000014500000100200300400500600700Count of private transactions1340446113497355200400600                                                                                  & R X Q W√ó    7 \ S H  , 7 \ S H  , , 7 \ S H  , , , 7 \ S H  , 902468101214161820Private transactions per block0.00.20.40.60.81.0CDFFig. 6: Number of token Ô¨Çows per private transaction. Only
0.4% of them have more than 20 token Ô¨Çows.

most portion. In addition, the top token exchange pairs usually
contain WETH and stablecoins. It is expected that such tokens
are popular on exchanges, since they are less subtle to market
changes and more valuable to keep.
The token swap patterns in private transactions. To present
more details of the complexity and behaviors, we classify the
token swap patterns in private transactions into the following
Ô¨Åve types and measure them.

‚Ä¢ Type I: involving in one token type.
‚Ä¢ Type II: involving in two types of tokens and two token

transfer edges.

‚Ä¢ Type III: involving in two types of tokens but more than

two token transfer edges.

‚Ä¢ Type IV: involving in three types of tokens.
‚Ä¢ Type V: involving in more than three types of token.

In total, we discover 5,746,633 private transactions
involved in tokens, which accounts for around 78% among all
the private transactions. SpeciÔ¨Åcally, the private transactions
that only exchange two types of tokens (type II and type
III) accounts for about 69% among all types. Moreover, the
percentage of Type V is around 2.2%, which is the smallest
among all types.
The top DeFi services used by private transactions.
We measure the count of private transactions against
the top 3 DeFis are Uniswap
every DeFi. SpeciÔ¨Åcally,
V2 [77], Uniswap V3 [78], and SushiSwap [68], which are
related to 558,919, 332,058, and 177,055 private transactions
respectively. Moreover, more than 60% of
the private
transactions are used for tokens swap in DeFi markets.

D. Entities

We evaluate the entities involved in private transactions,
to give an overview of the general distribution of different
entities. In particular, we measure the top senders, receivers,
and miners.
Sender. Senders of transactions are EOAs. To give an overview
of the senders, we measure the top 10 senders and the
count of sent private transactions. In total, 1,147,181 private
transactions are sent from the top 10 senders, which is about
15.5% portion of the total private transactions. The miner
address Ethermine:0xEA674f is the 1st largest sender creating
581,086 private transactions. It mainly uses private transactions

Fig. 7: The top token exchange pairs in private transactions.
Most of the transactions are related to WETH; stable coins
such as USDC/USDT are also popular.

to transfer money to other addresses for redistributing mining
income. Another special sender is Fund:0x0F4ee9, which is
related to investment or venture funds and ranks in the top
8 for sending out 43,995 private transactions. Such Ethereum
addresses that are labeled as Fund are usually users who own
lots of ETH for fund. Moreover, the rest of the top senders are
all normal EOAs.
Receiver. Receivers are the target addresses of transactions,
which can either be smart contracts or EOAs. We measure
the top 10 receivers that are related to 2,275,695 private
transactions, accounting for about 31% in total. SpeciÔ¨Åcally, all
the top 10 receivers are smart contracts. From Table II, there
are 5 MEV Bots involved in 1,037,924 private transactions.
In addition, there are 1,237,771 private transactions involving
in 4 receivers
that are DeFis addresses. These DeFi
addresses belong to Uniswap and SushiSwap. Morever, the
left top receiver is Tether USDT stable coin address. Private
transactions calling this address usually are used to transfer
the Tether USDT to others.

Receiver Address
0x7a250d5630B4cF539739dF2C5dAcb4c659F2488D
0xa57Bd00134B2850B2a1c55860c9e9ea100fDd6CF
0x00000000003b3cc22aF3aE1EAc0440BcEe416B40
0xE592427A0AEce92De3Edee1F18E0157C05861564

Label
Uniswap
MEV Bot
MEV Bot
Uniswap
SushiSwap 0xd9e1cE17f2641f24aE83637ab66a2cca9C378B9F
Token
MEV Bot
MEV Bot
Uniswap
MEV Bot

Count
558,919
412,563
222,829
216,791
177,055
0xdAC17F958D2ee523a2206206994597C13D831ec7
169,739
0x1d6E8BAC6EA3730825bde4B005ed7B2B39A2932d 151,668
138,867
0x000000000035B5e5ad9019092C665357240f594e
115,267
0x68b3465833fb72A70ecDF485E0e4C7bD8665Fc45
111,997
0x4d246bE90C2f36730bb853aD41d0a189061192d3

TABLE II: The list of top 10 receivers in private transactions
and the related count of received private transactions.

Miner. In total, 278 miners have been identiÔ¨Åed and 145 of
them have mined blocks with private transactions. We list
the top 10 miners in table Table III, which are sorted by the
number of their mined blocks containing private transactions.

6

02468101214161820Token flow number0.00.20.40.60.81.0CDF % 1 7 & 5 9 ' $ , / , 1 . 0 $ 7 , & 6 + , % 6 8 6 + , 8 6 ' & 8 6 ' 7 : % 7 & : ( 7 + 7 R N H Q V  R X W % 1 7 & 5 9 ' $ , / , 1 . 0 $ 7 , & 6 + , % 6 8 6 + , 8 6 ' & 8 6 ' 7 : % 7 & : ( 7 + 7 R N H Q V  L Q                    √ó   Miner

Ethermine
F2Pool
Spark Pool
Hiveon Pool
Flexpool.io
MiningPoolHub
Miner:0xb7e...707
2Miners:PPLNS
Nanopool
BeePool

Blocks with
private
transactions
316,774
168,442
143,767
80,937
46,365
41,701
41,360
36,657
35,541
33,533

Direct
payment

As a sender

482,894
174,541
310,958
57,088
93,563
63,691
39,909
39,967
25,881
82,797

581,086
5,251
969
1,872
484
28,010
81
1089
74
1,728

Total
private
transactions
1,063,980
179,792
311,927
58,960
94,047
91,701
39,990
41,056
25,955
84,525

TABLE III: Miners involved in private transactions.

Fig. 8: The used gas by private transactions per block.

SpeciÔ¨Åcally, the table shows the miner, the number of blocks,
the number of private transactions with direct transfer to the
miner, and the number of private transactions sent to the miner
of the top 10 miners. Generally, the more blocks the miners
have mined, the more private transactions with direct transfers
will be included and the more proÔ¨Åts the miners will earn.
In addition, Ethermine and MiningPub send lots of private
transactions. We conjecture that these two mining pools are
required to redistribute the earned proÔ¨Åts frequently or there
are many miner nodes in the two mining pools. Moreover,
Sparkpool (which Ô¨Årst introduced private txs) and BeePool
stopped mining since September and October of last year,
respectively.

V. TRANSACTION COST AND MINER PROFITS

In this section, we analyze the transaction cost including
used gas and gas price, and measure the miner proÔ¨Åts in terms
of the distribution, detailed income, and Ô¨Çows.

A. Transaction Cost

To present the detailed cost of the transaction fee, we
measure the gas used and the gasprice settings from private
transactions.
The used gas of private transactions. Fig. 8 presents the gas
used of private transactions against per block. The total gas
used for private transactions in each block is about 737,829
on average, which is much smaller than the average gas
used (16,673,757) of normal transactions. Particularly, there
are some blocks where the gas used of private transactions
takes a large portion of the total gas used. It is obvious that
transactions in such blocks are mostly private transactions. For
example, the blocks starting from 13,403,072 to 13,497,355

Fig. 9: The gasprice of
chronological order.

every private

transaction in

Fig. 10: The priority fee of every private transaction after EIP-
1559 in chronological order.

have a high percentage of gas used by private transactions,
which also relate to the Ô¨Årst abnormal period in Sec. IV-A. For
another example, block 14,520,420 has only one transaction
and this transaction is a private transaction. Meanwhile, there
are 367 blocks in total whose used gas percentage by private
transactions is 100%. In particular, 361 blocks are mined after
the gas limit expansion and 6 blocks are mined before the
expansion.

the expansion of

Moreover, we observe that

the gas
limit helps the growth of private transactions. Before the
gas limit expansion in block 12,965,000, the used gas by
total transactions is about 99% of the gas limit on average.
the Ethereum network is somehow crowded
It shows that
and transactions are awaiting to be mined. Besides, after the
gas limit is increased, miners have the ability to pack more
transactions. Accordingly, the number of private transactions
in blocks can be dynamically increased.
The gasprice setting in private transactions We measure
the gas price against every private transaction in Fig. 9.
Particularly, we study the inÔ¨Çuences of EIP-1559 to gas price
of private transactions. In total, there are 1,528,843 private
transactions before EIP-1559 and 5,876,992 after EIP-1559.

Before EIP-1559,

the average gas price of the private
transactions is around 93.3 Gwei. Moreover, the gas price of
771,979 private transactions are set to be 0 accounting for 50%
of the total. Generally, miners will not pack transactions with

7

1234494514688626Block Number123Gas used of private transactions per block√ó107EIP-1559 start02468Gas price in  Gwei√ó1050123Priority fee in Gwei√ó1050 gas fee into the blocks since they are incentived to max their
proÔ¨Åts. However, such private transactions will pay the earned
proÔ¨Åts to miners via the direct transfer in the transactions.
These transactions with 0 gas price are distributed in 318,375
blocks. In particular, blocks containing transactions with 0 gas
price at least include one direct payment transfer from private
transactions to miners, which proves that private transactions
indeed bring proÔ¨Åts to miners. Moreover, the average transfer
of these private transactions is around 0.214 ETH. Detailed
miner proÔ¨Åts will be analyzed later in Sec. V-B.

After EIP-1559,

the average gas price of all private
transactions is around 189 Gwei. SpeciÔ¨Åcally, we observe
that the transaction3 with the highest gas price (729,541.97
Gwei) is from a transfer to an EOA address and the total
transaction fee is 15.32 ETH. As required by EIP-1159, the
gas price is not allowed to be 0 due to the basefee. Private
transactions should pay both basefee and priority fee that is
the tip for miners, as their gas price. To further measure the
transaction fee after EIP-1559, we measure the priority fee
against every private transaction after EIP-1559.Some private
transactions did not set the new gas properties such as priority
after EIP-1559, and we got 4,105,987 private transactions
with priority set in Fig. 10. Among these private transactions,
the private transaction4 pays the highest priority fee, only
transfers 1 GWei from the sender to the sender itself, of
which the priority fee is around 282,093 GWei. In total, the
private transaction pays around 6 ETH as the transactions.
To our knowledge, we doubt that the high-priority fee of this
transaction is mistakenly set. In addition, there are 1,266,449
private transactions whose priority fee is 0,which takes around
22% of the total private transactions. Moreover, 96.5% of them
are sent to call MEV Bots. Transactions with 0 priority fee
are distributed in about 615,508 blocks and all of these blocks
contain at least one direct payment from private transactions
to miners. The average transfer amount is around 0.14 ETH.
As we stated before, while the proÔ¨Åts will decrease due to
the 0 priority fee, miners are still willing to pack such private
transactions into the blocks due to the direct transfer serving
as a bribe.

Finding 2: Some private transactions (around 50% before
EIP-1559 and 22% after) do not use gas fees as rewards
to the miners. Instead, MEV proÔ¨Åts are distributed to the
miners via direct transfers.

B. Miner ProÔ¨Åts

In this section, we investigate the mining proÔ¨Åts and the
Ô¨Çows of the earned proÔ¨Åts to assess the impact of private
transactions on the miners.
The distribution of total proÔ¨Åts. Miners mainly gain beneÔ¨Åts
from the following three types.

‚Ä¢ Type I: Block reward. The reward consists of both normal

and uncle blocks payouts.

‚Ä¢ Type II: ProÔ¨Åts from private transactions. The proÔ¨Åts
include both transaction fee and the bribe to miners
in private transactions. SpeciÔ¨Åcally, basefee in private
transactions will be burnt by the network and deducted from
the earned transaction fee for miners.

30xba5a6f7970f5ff78786bb318085f2b6789488827dfec4f8ceed67e289728a7ee
40xc9951933b0aef59f60b5421d39ab89c30ee48be15d80a0db69cdfbe9f72e874a

Fig. 11: The three types of miner proÔ¨Åts per month.

Fig. 12: The gasfee and transfer in private transactions.

‚Ä¢ Type III: ProÔ¨Åts from normal

transactions. The proÔ¨Åts
include both transaction fee and the bribe to miners in
normal
the earned
transaction fee in normal transactions will remove basefee.

transactions. The same as Type II,

We show the proÔ¨Åts of each type earned by the miners per
month in Ô¨Ågure Fig. 11. From the Ô¨Ågure, most of the proÔ¨Åts
of miners come from the Type I and the amount of the proÔ¨Åts,
which are almost the same in every single month. For Type II,
the average monthly proÔ¨Åts of the miner is 28,122.8 around
ETH, accounting for about 5% of the total miner proÔ¨Åt of per
month. Besides, we observe that the proÔ¨Åts of Type III is pretty
high in May 2021. The reason is that there are about 45 million
transactions in that month, which is higher than the average
count of 36.5 million.

Miner

Ethermine
F2Pool Old
Spark Pool
BeePool
Flexpool.io
Hiveon Pool
MiningPoolHub
2Miners:PPLNS
Miner:0xb7e390
Nanopool

Transfer from
private transactions
(ETH)

Transfer from
normal transactions
(ETH)

59,072.95
63,574.24
20,578.58
5,677.03
5,002.37
4,631.24
3,057.21
2,443.37
2,210.07
1,708.91

46,246.64
40,400.79
164.34
40.81
73.42
84.45
277.08
127.89
21.79
57.67

Total
(ETH)

105,319.59
103,975.03
20,742.92
5,717.84
5,075.79
4,715.69
3,334.29
2,571.26
2,231.86
1,766.58

TABLE IV: The transfer proÔ¨Åts in both private transactions
and normal transactions of top 10 miners.

8

                                                                   9 D O X H  L Q  ( 7 +√ó    7 \ S H  , 7 \ S H  , , 7 \ S H  , , ,                                                                    9 D O X H  L Q  ( 7 +√ó    * D V  I H H 7 U D Q V I H Uthe proÔ¨Åts from the direct

The distribution of proÔ¨Åts from private transactions. In
particular, we present the transaction fee and direct transfer to
miners of private transactions against per month in Fig. 12.
In total, around 23% of all private transactions transfers
money to miners, and the total transferred amount is around
195,381 ETH, which accounts for around 58% among the
total revenue of 337,474 ETH form private transactions. In
the Ô¨Ågure,
transfer exceed the
transaction fee in some months. The reason is that some private
transactions set low priority fee and pay the miners with the
direct transfer. Additionally, we list the top 10 miners sorted
by the income from direct transfers of private transactions
in Table IV. SpeciÔ¨Åcally,
the income of the top 3 miners
accounts for around 90% of the total. From the table, we notice
that most of the transfers come from the private transactions,
which demonstrates that private transactions bring in a lot of
money for miners.
The Ô¨Çow of earned proÔ¨Åts from miners. We observe that
miners frequently transfer a certain amount of ETH to others.
For example, some miners usually send 0.02 ETH to particular
addresses. These transactions are used by miners to redistribute
the income to the mining nodes 5 that perform the mining
work. The money is to reward the computation power of these
nodes. SpeciÔ¨Åcally,
the proÔ¨Åt redistribution transactions is
always private transactions for two reasons. The Ô¨Årst reason is
that miners are capable of sending transactions by themselves
to avoid the long waiting time in blockchains. The second
reason is that miners can save money since they do not have
to pay the priority fee and earn the basefee they pay.

Address

0x909bFe
0x18690F
0xE426ec
0xa4C916
0xbaAa28

Txs
Inbound

509
492
476
327
341

Total
Miner
Inbound
509
468
476
312
341

Private txs
Inbound

Txs
Outbound

Exchange
Outbound

58
67
64
72
52

152
191
49
23
4

152
185
49
23
0

transactions sent

TABLE V: The address preÔ¨Åx, Transaction Inbound (the
to the address), Ethermine
number of
Inbound (the number of transactions Ethermine sends to the
address), Transaction Outbound (the number of transactions
this address sends out), and Exchange Outbound (the number
of transactions sent from the address for token exchanges) of
the top 5 addresses, which are sorted by the count of Ethermine
Inbound.

To study the detailed Ô¨Çows of the proÔ¨Åts of the miner,
we performed a case study on the top miner Ethermine who
sends out 581,086 private transactions. We list the top Ô¨Åve
addresses receiving the largest number of private transactions
from Ethermine in Table V. These Ô¨Åve addresses are all EOA
addresses. From the table, we observe that most of such
addresses are used as the wallets of miner nodes, which
normally receive the proÔ¨Åts from Ethermine and then withdraw
money. For example, the address 6 receives 509 transactions
and all are transfers from miners, in which 58 transactions are
private transactions. Additionally, the address sends out 152

5A miner normally groups multiple mining nodes into a pool to combine
the computation powers, and then splits the rewards to these mining nodes [6].

60x909bfe97a6f77d2bec31b4c19e8c2810136abb90

transactions to withdraw money from their personal wallets via
DeFi platforms (e.g. Binance). The behaviors are pretty similar
for the other four addresses. With the investigation, we have a
better understanding of the money Ô¨Çows of the miner proÔ¨Åts.

Finding 3: Miners take a major share of the proÔ¨Åts of
private transactions. Miners, in turn, re-distribute the proÔ¨Åts
to mining nodes via private transactions, rewarding their
contribution in the computing power.

VI. SECURITY-RELATED ISSUES

In this section, we present the measured results to quantify
the related security issues, including MEV, real-world DeFi
attacks, consensus security, and private transactions leakage.
Moreover, we perform detection on private transactions from
our one-year dataset in Appendix to study arbitrage, which is
one popular type of MEVs.

A. MEV
The earned proÔ¨Åts by MEV Bots. We have identiÔ¨Åed 143
MEV Bots participating in the total private transactions and
they are involved in 2,116,587 private transactions. Among
these private transactions, 766,640 of them are identiÔ¨Åed
to gain proÔ¨Åts. Table VI shows the private transactions
distribution of the earned proÔ¨Åt. SpeciÔ¨Åcally, 2.6% calling
MEV bots gain more than 10 ETH as proÔ¨Åts, while 92.8% earn
less than 1 ETH. Furthermore, we Ô¨Ånd the average transaction
cost of these private transactions is around 0.005 ETH and 60%
of them share the miner with an average transfer of 0.2 ETH.
Moreover, we identify about 3% of these private transactions
ending up with negative pure proÔ¨Åts after deducting transaction
cost and miner proÔ¨Åt share from the earned proÔ¨Åts.

ProÔ¨Åt Range (in ETH)
Count
Percentage

[0,1)
711,441
92.8%

[1,10)
35,265
4.6%

[10,50)
7,794
1.02%

[50,100) ‚â• 100
9,241
1.21%

2,830
0.37%

TABLE VI: The total proÔ¨Åts distribution of proÔ¨Åtable MEV
related private transactions.

Failed transactions. Generally, users need to pay the
transaction fee even though their transactions fail, of which
the fee is decided by both gas price and used gas. However,
before EIP-1559, the gas price can be set to 0 and users can
pay nothing for transactions, regardless of whether they fail
or not. Transactions with 0 gas price are not usually mined to
blockchains since they give miners no proÔ¨Åts in terms of the
transaction fee. But with the appearance of private transaction,
users pay or bribe miners by directly transferring money to
them. Thus, miners are willing to mine such transactions.
SpeciÔ¨Åcally, we observe 94 private transactions fail before EIP-
1559 within our dataset and 58 of them have 0 gas price.
Although EIP-1559 forces the transactions to pay at least the
basefee, private transactions users can set the priority fee to
0, to reduce the potential loss if their transactions fail. We
observe 19,762 failed private transactions and 577 of them
have 0 priority fee after EIP-1559.

Finding 4: Allowing zero gas price before EIP-1559 in
private transactions enables attacks with no economic loss,
whereas the basefee introduced by EIP-1559 increases costs
for failed attacks.

9

B. Attack Case Studies

We investigate three DeFi related attacks that are exploited
via private transactions. SpeciÔ¨Åcally, we perform case studies
on PolkaBridge [60], LI.FI [51], and Multichain [56] attacks.
Moreover, we measure the top 30 private transactions
according to the money transferred to the miners and the top
10 blocks sorted by the amount of proÔ¨Åts from the miners.
PolkaBridge Attack. PolkaBridge is a cross-chain DeFi and
the Ô¨Årst to decentralized bridge between Polkadot platform
and other blockchains. Polkadot [82] is a blockchain protocol
connecting multiple blockchains into one uniÔ¨Åed network.
PolkaBridge mainly is used to support the token exchanges
between multiple blockchains, which is also what the bridge
aims to. PolkaBridge was attacked due to a smart contract
logic error at Nov-22-2021 07:44:02 AM +UTC. In particular,
an attacker can withdraw tokens that did not belong to them
by simply calling the related function. Moreover, The attacker
stole around $632K worth of assets via the transaction7.

As labeled by Etherscan,

this transaction is a private
transaction in Ethereum blockchain and mined in block
13,663,243. Besides, the transaction was placed in the Ô¨Årst
place inside the block by miner Poolin 38. SpeciÔ¨Åcally, the
attacker set the priority fee at 0 and transferred 60.1012422
ETH to the miner as a bribe. This attack case shows that
attackers can utilize private transactions to collude with miners
and attack the exploited platforms. As far as we know, there is
no related report or paper that analyzes the bribe to the miner.
We are the Ô¨Årst to investigate the relationship of attack, miner,
and private transaction.
LI.Fi Attack. We studied another attack on DeFi platform
LI.FI supporting cross-chain bridging, swapping, and messag-
ing. The services provided by LI.FI are similar to the services
from PolkaBridge, which are for token exchanges between
multiple blockchains. According to the report [8], LI.FI was
attacked due to the unchecked external call vulnerability
in smart contracts. The attack happened on Mar-20-2022
02:51:44 AM +UTC via the transaction9, which caused a huge
Ô¨Ånancial loss around $596K. Moreover, the transaction was
mined in block 14,420,687 and the miner was MiningPoolHub.
As expected, the transaction was placed in the Ô¨Årst place inside
the block.

Although the attacking transaction is label as private
transaction by Etherscan, the attack did not share the earned
proÔ¨Åts with the miners. After investigating the token Ô¨Çow of the
attacking transaction, we did not Ô¨Ånd any direct transfer to the
miner and the priority fee was set to be 2.2 GWei. We suspect
that the fee of launching a private transaction was paid off-
chain by the attacker. From these two attacks, we can conclude
that attacking transactions have the urges to not be monitored
by others and placed in the front of the blocks, in case that
attack competitors take the opportunity away.
Multichain Attack. Multichain is also a DeFi platform for
cross-chain services. It was attacked due to the unauthorized
permission, according to the report
the
vulnerable smart contract function did not validate the token
input parameter and the call being successful or not. Moreover,
Multichain was attacked by at least three attacker groups;

[5]. SpeciÔ¨Åcally,

70x36d2f3aaf7d160ea9bd072692555e6d3ff9b76139c8dfa83a475b23cc39cf8e6
80x2a20380dca5bc24d052acfbf79ba23e988ad0050
90x4b4143cbe7f5475029cf23d6dcbb56856366d91794426f2e33819b9b1aac4e96

there were multiple attacking transactions and the total
stolen amount was estimated to be around $3 million. After
investigation, lots of them are labeled as private transactions.
In particular, we studied the attacking transaction10
loss, accounting for 308 ETH
with the highest Ô¨Ånancial
(around $950K). This transaction behaves as the attacking
transaction in PolkaBridge attack. Similarly, it set the priority
fee to be 0 and shared 274.686613834949640784 ETH to
the miner. Moreover, the from address11 is labeled as both
Multichain Exploiter 4 (the fourth found attacker
exploiting this attack) and Whitehat (who aims to rescue
the attacks). The reason is that at Ô¨Årst the address hacked
the smart contracts for attacks and then agreed to return
part of the earned proÔ¨Åts after negotiation [18]. In addition,
transaction is placed at
the very beginning of the block
14,037,237 by the miner Ethermine12. For another example,
attacking transaction13 (labeled as a private transaction) was
launched by another attacker address14, which is labeled as
Multichain Exploiter 7. The patterns between the
two attacking transactions are exactly the same. From these
example transactions, we observe that private transactions
indeed help the attackers to take the priority for attacks.

Finding 5: Real world attacks have used private transactions
to seize the Ô¨Çeeting attack opportunities. In some cases,
the miners take a major share of the proÔ¨Åts, making them
unwitting accomplices in these attacks.

C. Consensus Security

We measure the most proÔ¨Åtable private transactions from
the user side and blocks for the miner side, and Ô¨Ånd that
private transactions have threats on the consensus security.
SpeciÔ¨Åcally, the huge proÔ¨Åts brought by private transactions
increase the risks of undercutting attacks.
The top 50 private transactions. After manually checking
the top 50 private transactions sorted by the transfer amount to
miners, 49 of them are related to MEV and 1 is related to real-
world attacks, which is the Multichain attack we mentioned
above. In addition, MEV related transactions are used for
arbitrage (34 among 50 private transactions) or liquidation (15
among 50 private transactions). For arbitrage, these private
transactions usually interact with Uniswap, SushiSwap, and
Curve. For liquidation, private transactions are usually sent to
Aave, dYdX, and Compound. SpeciÔ¨Åcally, the most proÔ¨Åtable
transaction15
It earns 729.6836279
ETH and shares 706.3337518 ETH with the miner. Besides,
the private transaction costs 0.03407946836279 ETH as the
transaction fee, while the priority fee is set to 0.
The top 20 blocks. To study the inÔ¨Çuences of private
transactions, we present the top 20 blocks that earn the most
proÔ¨Åts in Fig. 13a. From the Ô¨Ågure, we observe that most
of the proÔ¨Åts in the top 20 blocks come from the direct
transfers from private transactions to miners, which takes
around 90% among the total proÔ¨Åts in blocks. In particular,
the top block is 13,417,951 and earns around 747 ETH, in

is used for arbitrage.

100xe50ed602bd916fc304d53c4fed236698b71691a95774ff0aeeb74b699c6227f7
110xfa2731d0bede684993ab1109db7ecf5bf33e8051
120xea674fdde714fd979de3edf0f56aa9716b898ec8
130x6e26e226d81563a96e6aa9423b1301ce798242b5b4387ad7b9ac5b66966c2a44
140xd37448ad7949c4ad8eba5aad1a0afdd3199971d8
150x3b5fc9f804e026a23f1474218bc9d15e69a4fded405c8ffda0beb028e9d61c53

10

(a) Top 20 blocks with private transactions.

(b) Top 20 blocks with normal transactions only.

Fig. 13: Comparison: Top 20 blocks containing private transactions, and top 20 blocks with normal transactions only.

which the transfer from private transactions is about 714
ETH. The most proÔ¨Åtable private transaction we mentioned
above comes from this block and transfers 706.3337518 ETH
to the miner. We can learn that other proÔ¨Åts types only take
a very small portion. For comparison, we show the top 20
blocks without private transactions in Fig. 13b, sorted by
the earned proÔ¨Åts from miners. The most proÔ¨Åtable block
12,839,174 earns around 88 ETH, which is far less than the
proÔ¨Åts from top blocks with private transactions in Fig. 13a.
Moreover, the results shown in Fig. 13b are comparable with
those presented by Daian et al. [22]: the most proÔ¨Åtable block
(block 7,029,147) resulted in around 100 ETH proÔ¨Åt as well.
Undercutting attacks. An undercutting attack happens when
the proÔ¨Åts from transactions exceed the block rewards, in
which miners deliberately fork the existing blockchain and
leave these proÔ¨Åtable transactions unclaimed,
in order to
attract other miners to create new blocks on the undercutting
blockchain. To successfully launch the undercutting attacks,
attackers need to give enough money incentives to the miners
since the main goal of a rational miner is to maximize
its proÔ¨Åts. Previously, Carlsten et al.
the
transaction fees as the only factor that causes undercutting
attacks; In [22], it also takes Ordering Optimization (OO)
fees (including MEV) into account. According to Gong et
al. [39], before private transactions were introduced,
the
money deliberately left by attackers may not be enough to
incentivize the miners to launch the undercutting attack. For
instance, the transactions that are left for attracting miners
might not be able to Ô¨Åt
into the blocks. However, from
the above experiments measuring the top 20 blocks in both
private transactions and normal
transactions (Fig. 13a and
Fig. 13b), private transactions greatly increase the incentives
for undercutting attacks; miners can easily Ô¨Ånd the most
proÔ¨Åtable private transactions and place them into the new
block by squeezing out the less proÔ¨Åtable ones. Therefore, we
Ô¨Ånd that private transactions can be a potential driving factor
that leads to undercutting attacks since the block rewards are

[13] consider

Date

May 22
May 23
May 24
May 25
May 26
May 27
May 28
May 29
May 30

Node 1
View
726,225
735,962
766,517
739,896
776,464
727,589
760,488
752,500
735,069

Node 2
View
935,288
1,025,886
1,035,457
971,091
1,000,375
1,010,602
987,575
951,380
971,857

Two Nodes
Combined
1,015,771
1,060,942
1,059,803
1,010,729
1,011,134
10,20,657
1,027,682
1,005,138
1,041,587

Labeled by
Etherscan
32,831
24,162
33,787
30,708
21,669
31,642
26,772
31,158
32,831

Found in
mempool
1,272 (3.9%)
1,350 (5.6%)
1,381 (4.1%)
1,686 (5.5%)
1,109 (5.1%)
1,346 (4.3%)
1,047 (3.9%)
1,072 (3.4%)
1,319 (4.0%)

TABLE VII: The private transactions in the mempool of two
nodes and comparison with Etherscan.

far lower than other proÔ¨Åts, especially the direct transfers from
private transactions.

Finding 6: Private transactions exacerbate threats
to
consensus protocols. The huge proÔ¨Åts brought by private
transactions might provide the miners additional incentives
to launch undercutting attacks.

D. Leakage of Private Transactions

We notice that

there are some inaccuracies of

the
private transactions label from Etherscan. For example, the
transaction16 is labeled as a private transaction in Etherscan,
but found it in our local mempool.

To study the inaccuracies, we deploy two modiÔ¨Åed full
nodes in two continents to monitor the transactions coming
to the local mempool from the nine-day dataset. Then we
compare the transactions collected from the mempool of two
nodes with the private transactions from Etherscan and present
our results in Table VII. From the table, we observe a 4.3%
leakage in 9 days with the two nodes. We suspect that some
private transactions are leaked due to the uncle block, block
reorganization, the orphan transaction, the loss with the low
gasprice, and so on. For example, when a private transaction
is successfully packed into the block but is then considered as
an uncle block, private transaction will be released to the local
mempool of every node.

160x8d0c16210335a9ee8815d7b0dba22134f9dc722047e8f2d67399184cd92c420f

11

                                                                                                                                                                 % O R F N  1 X P E H U             9 D O X H  L Q  ( 7 + % O R F N  5 H Z D U G 1 R U P D O  7 U D Q V D F W L R Q V  ) H H 1 R U P D O  7 U D Q V D F W L R Q V  7 U D Q V I H U 3 U L D Y W H  7 U D Q V D F W L R Q V  ) H H 3 U L D Y W H  7 U D Q V D F W L R Q V  7 U D Q V I H U                                                                                                                                                                 % O R F N  1 X P E H U             9 D O X H  L Q  ( 7 + % O R F N  5 H Z D U G 1 R U P D O  7 U D Q V D F W L R Q V  ) H H 1 R U P D O  7 U D Q V D F W L R Q V  7 U D Q V I H UThe leakage of private transactions will harm the proÔ¨Åts
of users. For example, if the user of a transaction exchanges
a large amount of tokens and tries to avoid being monitored
by others, he/she will submit a private transaction. However,
assuming the private transaction is leaked and frontran by
MEV Bots,
loss to the
it will cause a huge Ô¨Ånancial
user. Similarly, the leakage can cause the failure of MEV
opportunities. For
the MEV related private
if
transactions is leaked into the mempool and placed in the lower
places of the mined blocks, the competitors are likely to take
advantage of the MEV opportunity before them.

instance,

Finding 7: We observe private transaction leakage from our
two local Ethereum nodes. Therefore, private transactions
are not guaranteed to be absent from the public mempool;
they may still be vulnerable to attacks.

these transactions. For instance,

VII. DISCUSSION
Limitations. In this paper, we use the labels from Etherscan
as our ground truth, similar to previous works [3], [48],
[79]. Etherscan is trusted by the community that it has a
clear and comprehensive view of the labels, since Etherscan
has reliable data sources. For private transaction labels,
Etherscan deploys Ethereum nodes deployed over the world
to capture private transactions. Besides, they fetch the data
from private transaction service providers (e.g., Flashbots [36])
to label
there is a label
called Flashbots in Etherscan Label World, which provides
all the private transactions coming from Flashbots. However,
still have mis-labeled data on private
Etherscan might
transactions. To enhance the authenticity of
the private
transactions labels, we may consult other third-party mempool
services (e.g., BLOXROUTE [9]) and cross-check their labels
with Etherscan‚Äôs labels. We leave this as our future work.
Future extensions. As stated in Sec. VI-D, there is private
transaction leakage at around 4.3% percentage. The leaked
private transactions against
their intentions and may harm
the proÔ¨Åts of their users. We can analyze the purposes and
usages of these private transactions and study the potential
risks. Besides, there are 299 private transactions are leaked
not due to the uncle blocks. It might bring some interesting
insights to measure how they are leaked. Moreover, in this
paper, we perform analysis on arbitrage in private transactions
in the Appendix. It would be interesting to measure other
attacks such as sandwich attacks and Ô¨Çashloans in the private
transaction pool. We leave these to the future work.
Ethereum 2.0. Ethereum will move from PoW to PoS and
replace miners with validators. Users can become validators as
long as they stake 32 ETH as collateral that encourages them to
behave well. SpeciÔ¨Åcally, validators are either chosen to create
blocks or responsible for validating blocks. With the upgrade
of the consensus layer, private transactions will not disappear.
Instead, MEV opportunities will attract more users to stake
Ether and become validators since validators can earn huge
proÔ¨Åts from the private transactions. However, the difference
of income between validators who are responsible to attest
the blocks and the validators who are randomly selected to
create blocks will increase signiÔ¨Åcantly. In particular, users that
have a large validator stake are likely to have more blocks to
create and obtain more rewards from the MEV related private
transactions. Thus, they earn more and have more to stake.

Therefore, the impact of private transactions on Ethereum 2.0
is worth investigating, and Ethereum 2.0 will also affect the
private transactions.
Private transactions on other blockchains. Similar as
Ethereum, Binance Smart Chain (BSC) is built based on
Ethereum Virtual Machine (EVM) and smart contracts.
However, BSC uses a consensus of Proof of Staked Authority
(PoSA) [2]. In BSC, there are only 21 validators that are
similar as miners in Ethereum. Although the validators are
re-elected daily based on the top 21 nodes that meet
the
requirements to be validators, the number is always 21. To the
best of our knowledge, there is no ofÔ¨Åcial private transaction
concept in the BSC while there are MEV Bots. We believe
the reason is that it is hard to become validators in BSC than
Ethereum miners since the there only be 21 validators. Besides,
there are no special channels in BSC (e.g., FlashBots [36]
in Ethereum) for private transactions. For other blockchains,
Polygon that can be considered as a fork of Ethereum uses
a Proof-of-Stake (PoS) consensus mechanism. In order to
participate in the blockchain, validators need to stake money
and take the resposiblities as miners in Ethereum. Similarly,
there are no general channels used for private transactions,
although the MEV related transactions are popular in Polygan.
We believe that there are more to observe and examine in such
blockchains about MEV and private transactions.

VIII. RELATED WORK

In this section, we discuss existing works that are related
to this paper. In particular, we Ô¨Årst discuss existing works
that cover private transactions, then present the measurement
papers on blockchains. We also brieÔ¨Çy discuss works that focus
on Ô¨Ånding bugs in smart contracts.

A. Private Transactions

Private transactions are still very new and have not received
much attention in the research community. To date,
there
are only a few works [12], [59], [62], [81] that touch upon
private transactions as by-products when investigating MEVs.
We compare the scope of our work and these papers in Fig. 14.
In particular, our work mainly study the landscape of private
transactions, while they focus on MEVs.

Piet et al. [59] measured private transactions in transaction
pools from four sources for about 1 day, and found that
most of the private transactions are used for miner proÔ¨Åt
redistribution and MEV extraction. In particular, 91.5% of
MEV extraction is done via private transactions. They also
analyzed the miner proÔ¨Åts among private transactions and
the top Ô¨Åve miners earned most proÔ¨Åts. Besides, 40% of
miners had not mined any private transaction. We are different
in the focuses of analysis. For example, they measure the
inconsistency of private transactions in miners, while our
work focuses on the proÔ¨Åts Ô¨Çows earned by miners. Besides,
we have a much larger dataset (one year) and we present a
study on the security impacts of private transactions.

Weintraub et al. [81] mainly measure and analyze the
impact of Flashbots with focusing on MEV, which provides a
private channel between Ethereum users and miners. Weintraub
et al. also measures other private services providers (e.g., Eden
Network [16]) and shows that most of the MEV extraction
comes from private service providers, especially Flashbots.
They discover the unfairness of Flashbots, in which miners

12

and analysis

on investigating the inÔ¨Çuences of private transactions and the
related security issues.
Measurement
of Ethereum EIP-1559.
Moreover, works [50], [54], [64] conduct an empirical study
on the effects of the EIP-1559 protocol. Liu et al. [54] lead an
empirical study the effects of EIP-1559 protocol on transaction
fee dynamics, transaction waiting time, and security exploits.
Stefanos et al. [50] study both theoretical and experimental
analysis of the dynamics and stability properties of the EIP-
1559 protocol. Daniel et al. [64] study the fee market upgrade
by leveraging the data from Ô¨Årst month after the EIP-1559
protocol. They also propose an alternative rule to replace EIP-
1559 and prove the effectiveness from the experimental results.
Measurement and analysis of MEV. In addition, MEV is
gaining attentions recently. Daian et al. [22] is the Ô¨Årst to
propose the concept of MEV and empirically shows the risks
posed by MEV. Qin et al. [62] is the Ô¨Årst to introduce the
concept of Blockchain Extractable Value (BEV) and measure
the dangers of BEV. SpeciÔ¨Åcally, this paper quantiÔ¨Åes the value
threshold at which BEV would encourage miners to fork the
blockchain. Wang et al. [80] conduct a measurement study
on cyclic arbitrages which is one type of the arbitrages on
the Uniswap platform. Moreover, arbitrage is also measure
in some works. Zhou et al. [89] propose a framework to
automatically construct proÔ¨Åtable arbitrage transactions. They
analyze the MEV or in terms of its risks to the Ethereum
consensus layer, while our article measures the impact of the
MEV from the related private transactions. Also, these papers
detect or simulate the arbitrage in normal transactions while
our work detects arbitrage in private transactions.

C. Bug Detection on Smart Contracts

Due to the immunity of smart contracts and their various
applications, attacks happen consistently and frequently on
Ethreum blockchain, which can cause huge Ô¨Ånancial losses.
To mitigate such attacks, many works [10], [20], [35], [37],
[42], [46], [47], [55], [58], [71], [73], [75], [76] study the
vulnerabilities of smart contracts and on Ethereum. They
usually use static analysis approaches, such as symbolic
execution,
to uncover vulnerabilities and bugs in smart
contracts. Some other works [15], [38], [40], [41], [43],
[44], [53], [57], [72], [84] make use of fuzzing techniques
to discover bugs in smart contracts. In contrast, our work
analyzes private transactions to understand their mechanisms,
incentives, and security risks.

IX. CONCLUSION

In this paper, we conduct

the Ô¨Årst empirical study
on Ethereum private transactions. First, we study the
general characteristics of private transactions, including the
tokens and platforms, and
distribution, categories, DeFi
intention of
the involved entities. Contrary to the original
protecting users, many private transactions are used for
MEV opportunities by MEV searchers. Second, we study
the transaction cost and miner proÔ¨Åts of private transactions.
Private transactions use less gas and bring huge proÔ¨Åts to
miners. Finally, we evaluate security-related issues, including
MEV, real-world attacks, consensus security, and the leakage
of private transactions. The huge proÔ¨Åts of private transactions
might lead to undercutting attacks, and private transactions
have about 4.3% chance of being leaked to the public

Fig. 14: The comparison between related works on private
transactions and our work. Piet et al. [59], Weintraub et al. [81]
and Capponi et al. [12] focus on MEV in private transactions;
Qin et al. [62] investigate BEV, which is a super set of MEV;
Our work focuses on the entire private transaction landscape.

have proÔ¨Åted much more than MEV searchers. Their work
studies private transactions mainly from the perspective of
MEV extraction, while our work gives a more complete view
on private transactions in other aspects.

Qin et al.

[62] measure the Blockchain Extraction
Value (BEV) by detecting sandwich attacks,
liquidation,
and arbitrage in transactions. SpeciÔ¨Åcally, they consider the
transaction with zero gas price as private transactions and
measure the percentage and its value in each BEV category.
Moreover,
their paper formalizes BEV relay systems and
analyzes the impacts on P2P network and consensus layer. their
paper mainly studies BEV, while our work highlights private
transactions.

Capponi et al. [12] propose a game theoretical model to
analyze the economic incentives behind the venues from the
private transactions. In particular, their paper collected and
investigated the transactions summited via the private channel
from the Flashbots. The results show that the implications
on different entities, including the increasement of users and
miners payoffs. Their work highlights the economic incentives
of private transactions, while our work focuses on analyzing
the behavior of private transactions and their impacts.

B. Measurement of Blockchains
Measurement of Ethereum interaction networks. To study
the behaviors of different entities and their interactions, many
works study Ethereum networks between users and smart
contracts. Particularly, Lee et al. [49], Chen et al. [14], Lin
et al. [88], and Bai et al. [4] perform a measurement study on
these interaction networks to observe the activities of Ethereum
and propose some insights, All of these works measure the
general features of the Ethereum interaction networks between
users and contracts from graph analysis, while our paper
focuses on the purposes and usages of private transactions from
the interaction networks.
Measurement of Ethereum transactions. Besides, some
works [52], [67], [86] study transactions via graph analysis
to investigate the transactions behaviors. SpeciÔ¨Åcally, Said et
al. [67] analyze transaction behaviors, community structure
and link prediction. Lin et al. [52] model the transactions
Zanelatto
records as temporal weighted multi-digraphs.
et al. [86] conduct a large-scale study based on 3-year
Ethereum transactions with cryptocurrency. These works
measure the overall features of transactions, while we focus

13

MEVBEVNormal Transactions[62]Private Transactions[12] [59][81]Our Workmempool. This work sheds light on the private transaction
ecosystem, and calls for more actions to protect users from
private transactions.

REFERENCES

[1]

1inch, ‚Äú1inch network,‚Äù https://app.1inch.io/#/1/swap/ETH/DAI, 2022.

[2] B. ACADEMY, ‚ÄúAn introduction to binance smart chain (bsc),‚Äù
https://academy.binance.com/en/articles/an-introduction-to-binance-
smart-chain-bsc, 2021.

[3] R. Agarwal, T. Thapliyal, and S. K. Shukla, ‚ÄúVulnerability and
transaction behavior based detection of malicious smart contracts,‚Äù in
International Symposium on Cyberspace Safety and Security. Springer,
2021, pp. 79‚Äì96.

[4] Q. Bai, C. Zhang, Y. Xu, X. Chen, and X. Wang, ‚ÄúEvolution of
ethereum: A temporal graph perspective,‚Äù 2020. [Online]. Available:
https://arxiv.org/abs/2001.05251

[5] T. Be‚Äôery,

‚ÄúWithout

permit: Multichain‚Äôs

exploit

explained,‚Äù

https://medium.com/zengo/without-permit-multichains-exploit-
explained-8417e8c1639b, 2022.

[6]

beincrypto, ‚ÄúEth pools: Best mining pools for ethereum mining,‚Äù https:
//beincrypto.com/learn/eth-pools-mining/, 2021.

[7] T. Block, ‚ÄúMev bots earn $476,000 by targeting large stablecoin
swaps,‚Äù https://www.theblockcrypto.com/post/139155/mev-bots-earn-
476000-by-targeting-large-stablecoin-swaps/, 2022.

[8] BlockSec, ‚ÄúLi.Ô¨Å attack: a cross-chain bridge vulnerability? no,

it‚Äôs
due to unchecked external call!‚Äù https://blocksecteam.medium.com/li-
Ô¨Å-attack-a-cross-chain-bridge-vulnerability-no-its-due-to-unchecked-
external-call-c31e7dadf60f, 2022.

[9] BLOXROUTE,

‚ÄúFastest mempool

data,‚Äù

https://bloxroute.com/

mempool-data/, 2022.

[10] L. Brent, A. Jurisevic, M. Kong, E. Liu, F. Gauthier, V. Gramoli,
R. Holz, and B. Scholz, ‚ÄúVandal: A scalable security analysis framework
for smart contracts,‚Äù arXiv preprint arXiv:1809.03981, 2018.

[11] V. Buterin, ‚ÄúEthereum white paper: A next generation smart contract
[Online]. Available:

& decentralized application platform,‚Äù 2013.
https://github.com/ethereum/wiki/wiki/White-Paper

[12] A. Capponi, R. Jia, and Y. Wang, ‚ÄúThe evolution of blockchain: from

lit to dark,‚Äù arXiv preprint arXiv:2202.05779, 2022.

[13] M. Carlsten, H. Kalodner, S. M. Weinberg, and A. Narayanan, ‚ÄúOn
the instability of bitcoin without the block reward,‚Äù in Proceedings of
the 2016 ACM SIGSAC Conference on Computer and Communications
Security, 2016, pp. 154‚Äì167.

[14] T. Chen, Z. Li, Y. Zhu, J. Chen, X. Luo, J. C.-S. Lui, X. Lin,
and X. Zhang, ‚ÄúUnderstanding ethereum via graph analysis,‚Äù ACM
Transactions on Internet Technology (TOIT), vol. 20, no. 2, pp. 1‚Äì32,
2020.

[15]

J. Choi, D. Kim, S. Kim, G. Grieco, A. Groce, and S. K. Cha,
‚ÄúSmartian: Enhancing smart contract fuzzing with static and dynamic
data-Ô¨Çow analyses,‚Äù in 2021 36th IEEE/ACM International Conference
on Automated Software Engineering (ASE).
IEEE, 2021, pp. 227‚Äì239.

[16] P. Chris, Q.

Jeffrey, and S. Caleb, ‚ÄúEden network,‚Äù https://
edennetwork.io/EDEN_Network___Whitepaper___2021_07.pdf, 2021.
[17] Coinmarketcap, ‚ÄúFront running,‚Äù https://coinmarketcap.com/alexandria/

glossary/front-running, 2022.

[18] COINTELEGRAPH, ‚ÄúMultichain hacker returns 322 eth, keeps hefty
Ô¨Ånders fee,‚Äù https://cointelegraph.com/news/multichain-hacker-returns-
322-eth-keeps-hefty-Ô¨Ånders-fee, 2022.

[19] CONSENSYS,

‚ÄúDeÔ¨Å market

commentary

| may

2022,‚Äù

https://consensys.net/blog/cryptoeconomic-research/deÔ¨Å-market-
commentary-may-2022/, 2022.

[20] ConsenSys, ‚ÄúMythril classic,‚Äù https://github.com/ConsenSys/mythril-

classic, 2022.

[21] Crypto.com, ‚ÄúCrypto.com: The world‚Äôs fastest growing crypto app,‚Äù

https://crypto.com, 2022.

[22] P. Daian, S. Goldfeder, T. Kell, Y. Li, X. Zhao,

I. Bentov,
Juels, ‚ÄúFlash boys 2.0: Frontrunning,
L. Breidenbach, and A.
transaction reordering, and consensus instability in decentralized
exchanges,‚Äù 2019. [Online]. Available: https://arxiv.org/abs/1904.05234

[23] DappRadar, ‚ÄúDeÔ¨Å overview,‚Äù https://dappradar.com/deÔ¨Å, 2022.
[24] Ethereum, ‚ÄúNode discovery protocol v5,‚Äù https://github.com/ethereum/

devp2p/blob/master/discv5/discv5.md, 2021.

14

[25] ‚Äî‚Äî, ‚ÄúThe rlpx transport protocol,‚Äù https://github.com/ethereum/

devp2p/blob/master/rlpx.md, 2021.

[26] ‚Äî‚Äî,

‚ÄúDecentralized
//ethereum.org/en/deÔ¨Å/, 2022.

Ô¨Ånance

(deÔ¨Å)

|

ethereum.org,‚Äù

https:

[27] ‚Äî‚Äî, ‚ÄúErc-20 token standard | ethereum.org,‚Äù https://ethereum.org/en/

developers/docs/standards/tokens/erc-20/, 2022.

[28] ‚Äî‚Äî, ‚ÄúProof-of-stake (pos) | ethereum.org,‚Äù https://ethereum.org/en/

developers/docs/consensus-mechanisms/pos/, 2022.

[29] ‚Äî‚Äî, ‚ÄúProof-of-work (pow) | ethereum.org,‚Äù https://ethereum.org/en/

developers/docs/consensus-mechanisms/pow/, 2022.

[30] ‚Äî‚Äî, ‚ÄúStablecoins: Digital money for everyday use | ethereum.org,‚Äù

https://ethereum.org/en/stablecoins/, 2022.

[31] G. Ethereum, ‚ÄúOfÔ¨Åcial go implementation of the ethereum protocol,‚Äù

https://github.com/ethereum/go-ethereum, 2022.

[32] Ethermine,
public
1443502516604477445, 2022.

‚ÄúWant
mempool?‚Äù

to keep your dex trades

away from the
https://twitter.com/ethermine_org/status/

[33] Etherscan, ‚ÄúEtherscan,‚Äù https://etherscan.io/, 2022.
[34] ‚Äî‚Äî, ‚ÄúLabel word cloud,‚Äù https://etherscan.io/labelcloud, 2022.
[35]

J. Feist, G. Grieco, and A. Groce, ‚ÄúSlither: a static analysis framework
for smart contracts,‚Äù in 2019 IEEE/ACM 2nd International Workshop on
Emerging Trends in Software Engineering for Blockchain (WETSEB).
IEEE, 2019.

[36] Flashbot, ‚ÄúFlashbots docs,‚Äù https://docs.Ô¨Çashbots.net/Ô¨Çashbots-auction/

[37]

overview/, 2022.
J. Frank, C. Aschermann, and T. Holz, ‚Äú{ETHBMC}: A bounded model
checker for smart contracts,‚Äù in 29th USENIX Security Symposium
(USENIX Security 20), 2020, pp. 2757‚Äì2774.

[38] Y. Fu, M. Ren, F. Ma, H. Shi, X. Yang, Y. Jiang, H. Li, and X. Shi,
‚ÄúEvmfuzzer: detect evm vulnerabilities via fuzz testing,‚Äù in Proceedings
of the 2019 27th ACM joint meeting on european software engineering
conference and symposium on the foundations of software engineering,
2019, pp. 1110‚Äì1114.

[39] T. Gong, M. Minaei, W. Sun, and A. Kate, ‚ÄúTowards overcoming the
undercutting problem,‚Äù arXiv preprint arXiv:2007.11480, 2020.
[40] G. Grieco, W. Song, A. Cygan, J. Feist, and A. Groce, ‚ÄúEchidna:
effective, usable, and fast fuzzing for smart contracts,‚Äù in Proceedings of
the 29th ACM SIGSOFT International Symposium on Software Testing
and Analysis, 2020.

[41] A. Groce and G. Grieco, ‚Äúechidna-parade: a tool for diverse multicore
smart contract fuzzing,‚Äù in Proceedings of the 30th ACM SIGSOFT
International Symposium on Software Testing and Analysis, 2021, pp.
658‚Äì661.
[42] S. Grossman,

I. Abraham, G. Golan-Gueta, Y. Michalevsky,
N. Rinetzky, M. Sagiv, and Y. Zohar, ‚ÄúOnline detection of effectively
callback free objects with applications to smart contracts,‚Äù Proceedings
of the ACM on Programming Languages, 2017.
J. He, M. Balunovi¬¥c, N. Ambroladze, P. Tsankov, and M. Vechev,
‚ÄúLearning to fuzz from symbolic execution with application to smart
contracts,‚Äù in Proceedings of the 2019 ACM SIGSAC Conference on
Computer and Communications Security, 2019, pp. 531‚Äì548.

[43]

[44] B. Jiang, Y. Liu, and W. Chan, ‚ÄúContractfuzzer: Fuzzing smart contracts
for vulnerability detection,‚Äù in 2018 33rd IEEE/ACM International
Conference on Automated Software Engineering (ASE).
IEEE, 2018,
pp. 259‚Äì269.

[45] D. B. Johnson, ‚ÄúFinding all the elementary circuits of a directed graph,‚Äù

SIAM J. Comput., vol. 4, pp. 77‚Äì84, 1975.

[46] S. Kalra, S. Goel, M. Dhawan, and S. Sharma, ‚ÄúZeus: Analyzing safety
of smart contracts,‚Äù in Proceedings of the 25th Annual Network and
Distributed System Security Symposium, 2018.
J. Krupp and C. Rossow, ‚Äúteether: Gnawing at ethereum to automatically
exploit smart contracts,‚Äù in 27th USENIX Security Symposium, 2018.

[47]

[48] N. Kumar, A. Singh, A. Handa, and S. K. Shukla, ‚ÄúDetecting malicious
accounts on the ethereum blockchain with supervised learning,‚Äù in
International Symposium on Cyber Security Cryptography and Machine
Learning. Springer, 2020, pp. 94‚Äì109.

blockchain network,‚Äù in Proceedings of The Web Conference 2020,
2020, pp. 155‚Äì166.

[50] S. Leonardos, B. Monnot, D. Reijsbergen, E. Skoulakis, and
G. Piliouras, ‚ÄúDynamical analysis of the eip-1559 ethereum fee market,‚Äù
in Proceedings of the 3rd ACM Conference on Advances in Financial
Technologies, 2021, pp. 114‚Äì126.

[51] LI.FI, ‚ÄúAdvanced Bridge & DEX Aggregation,‚Äù https://li.Ô¨Å, 2022.
[52] D. Lin, J. Wu, Q. Yuan, and Z. Zheng, ‚ÄúModeling and understanding
ethereum transaction records via a complex network approach,‚Äù IEEE
Transactions on Circuits and Systems II: Express Briefs, vol. 67, no. 11,
pp. 2737‚Äì2741, 2020.

[53] C. Liu, H. Liu, Z. Cao, Z. Chen, B. Chen, and B. Roscoe, ‚ÄúReguard:
Ô¨Ånding reentrancy bugs in smart contracts,‚Äù in IEEE/ACM 40th
International Conference on Software Engineering: Companion (ICSE-
Companion).

IEEE, 2018.

[54] Y. Liu, Y. Lu, K. Nayak, F. Zhang, L. Zhang, and Y. Zhao, ‚ÄúEmpirical
analysis of eip-1559: Transaction fees, waiting time, and consensus
security,‚Äù arXiv preprint arXiv:2201.05574, 2022.

[55] L. Luu, D.-H. Chu, H. Olickel, P. Saxena, and A. Hobor, ‚ÄúMaking smart
contracts smarter,‚Äù in Proceedings of the 2016 ACM SIGSAC conference
on computer and communications security. ACM, 2016.

[56] Multichain, ‚ÄúCross-chain router protocol,‚Äù https://multichain.xyz, 2022.
[57] T. D. Nguyen, L. H. Pham, J. Sun, Y. Lin, and Q. T. Minh, ‚Äúsfuzz: An
efÔ¨Åcient adaptive fuzzer for solidity smart contracts,‚Äù in Proceedings of
the ACM/IEEE 42nd International Conference on Software Engineering,
2020, pp. 778‚Äì788.
I. Nikoli¬¥c, A. Kolluri, I. Sergey, P. Saxena, and A. Hobor, ‚ÄúFinding the
greedy, prodigal, and suicidal contracts at scale,‚Äù in Proceedings of the
34th Annual Computer Security Applications Conference. ACM, 2018.
J. Piet, J. Fairoze, and N. Weaver, ‚ÄúExtracting godl
from
the salt mines: Ethereum miners extracting value,‚Äù arXiv preprint
arXiv:2203.15930, 2022.

[sic]

[59]

[58]

[60] PolkaBridge, ‚ÄúFirst Cross-Chain & MultiChain AMM,‚Äù https://

polkabridge.org, 2022.

[61] E. I. Proposals, ‚ÄúEip-1559: Fee market change for eth 1.0 chain,‚Äù https:

//eips.ethereum.org/EIPS/eip-1559, 2022.

[62] K. Qin, L. Zhou, and A. Gervais, ‚ÄúQuantifying blockchain extractable
value: How dark is the forest?‚Äù arXiv preprint arXiv:2101.05511, 2021.
[63] K. Qin, L. Zhou, B. Livshits, and A. Gervais, ‚ÄúAttacking the deÔ¨Å
fun and proÔ¨Åt,‚Äù in International
ecosystem with Ô¨Çash loans for
Conference on Financial Cryptography and Data Security. Springer,
2021, pp. 3‚Äì32.

[64] D. Reijsbergen, S. Sridhar, B. Monnot, S. Leonardos, S. Skoulakis,
and G. Piliouras, ‚ÄúTransaction fees on a honeymoon: Ethereum‚Äôs
eip-1559 one month later,‚Äù 2021. [Online]. Available: https://arxiv.org/
abs/2110.04753

[65] A. Research, ‚ÄúThe weekly update,‚Äù https://static1.squarespace.com/
static/60377b34e7791c1277aaae97/t/620bb29c47ac8725fed1405f/
1644933791531/Weekly+update+-+Arcane+Research+%28Week+6%
29+2022+-+Free.pdf/, 2022.

[66] M. Rodler, W. Li, G. Karame, and L. Davi, ‚ÄúSereum: Protecting existing
smart contracts against re-entrancy attacks,‚Äù in Proceedings of the 26th
Network and Distributed System Security Symposium, 2019.

[67] A. Said, M. U. Janjua, S.-U. Hassan, Z. Muzammal, T. Saleem,
T. Thaipisutikul, S. Tuarob, and R. Nawaz, ‚ÄúDetailed analysis of
ethereum network on transaction behavior, community structure and
link prediction,‚Äù PeerJ Computer Science, vol. 7, p. e815, 2021.

[68] SushiSwap, ‚ÄúIntroduction,‚Äù https://dev.sushi.com/docs/intro, 2022.
[69] Taichi-Network, ‚ÄúTaichi-network,‚Äù https://github.com/Taichi-Network,

2022.

[70] Tether, ‚ÄúTether: Fiat currencies on the bitcoin blockchain,‚Äù https://

whitepaper.io/document/6/tether-whitepaper, 2022.

[71] S. Tikhomirov, E. Voskresenskaya,

Ivanitskiy, R. Takhaviev,
E. Marchenko, and Y. Alexandrov, ‚ÄúSmartcheck: Static analysis of
ethereum smart contracts,‚Äù in 2018 IEEE/ACM 1st
International
Workshop on Emerging Trends in Software Engineering for Blockchain
(WETSEB).

IEEE, 2018.

I.

[49] X. T. Lee, A. Khan, S. Sen Gupta, Y. H. Ong, and X. Liu,
‚ÄúMeasurements, analyses, and insights on the entire ethereum

[72] C. F. Torres, A. K. Iannillo, A. Gervais, and R. State, ‚ÄúConfuzzius:
A data dependency-aware hybrid fuzzer for smart contracts,‚Äù in 2021

15

IEEE European Symposium on Security and Privacy (EuroS&P). IEEE,
2021.

[73] C. F. Torres, J. Sch√ºtte, and R. State, ‚ÄúOsiris: Hunting for integer bugs in
ethereum smart contracts,‚Äù in Proceedings of the 34th Annual Computer
Security Applications Conference, 2018, pp. 664‚Äì676.

[74] TradingView, ‚ÄúTradingview: look Ô¨Årst,‚Äù https://www.tradingview.com,

2022.

[75] TrailOfBits, ‚ÄúManticore: Symbolic execution tool,‚Äù https://github.com/

trailofbits/manticore, 2022.

[76] P. Tsankov, A. Dan, D. Drachsler-Cohen, A. Gervais, F. Buenzli, and
M. Vechev, ‚ÄúSecurify: Practical security analysis of smart contracts,‚Äù in
Proceedings of the 2018 ACM SIGSAC Conference on Computer and
Communications Security. ACM, 2018.

[77] Uniswap, ‚ÄúUniswap v2 overview,‚Äù https://uniswap.org/blog/uniswap-v2,

2020.

[78] ‚Äî‚Äî, ‚ÄúIntroducing uniswap v3,‚Äù https://uniswap.org/blog/uniswap-v3,

[79]

2021.
J. A. Valadares, V. C. Oliveira, J. E. D. A. Sousa, H. S. Bernardino,
S. M. Villela, A. B. Vieira, and G. Gon√ßalves, ‚ÄúIdentifying user behavior
proÔ¨Åles in ethereum using machine learning techniques,‚Äù in 2021 IEEE
International Conference on Blockchain (Blockchain).
IEEE, 2021, pp.
327‚Äì332.

[80] Y. Wang, Y. Chen, S. Deng, and R. Wattenhofer, ‚ÄúCyclic arbitrage in

decentralized exchange markets,‚Äù Available at SSRN 3834535, 2021.

[81] B. Weintraub, C. F. Torres, C. Nita-Rotaru, and R. State, ‚ÄúA Ô¨Çash (bot)
in the pan: Measuring maximal extractable value in private pools,‚Äù arXiv
preprint arXiv:2206.04185, 2022.

[82] G. Wood,

‚ÄúPolkadot: Vision for

a heterogeneous multi-chain

framework,‚Äù White Paper, vol. 21, pp. 2327‚Äì4662, 2016.

[83] S. Wu, D. Wang, J. He, Y. Zhou, L. Wu, X. Yuan, Q. He, and K. Ren,
‚ÄúDeÔ¨Åranger: Detecting price manipulation attacks on deÔ¨Å applications,‚Äù
arXiv preprint arXiv:2104.15068, 2021.

[84] V. W√ºstholz and M. Christakis, ‚ÄúHarvey: A greybox fuzzer for smart
contracts,‚Äù in Proceedings of the 28th ACM Joint Meeting on European
Software Engineering Conference and Symposium on the Foundations
of Software Engineering, 2020.

[85] XORD, ‚ÄúFlashbots: Mev pi-rate ship,‚Äù https://xord.com/research/mev-

[86]

pi-rate/, 2022.
J. Zanelatto Gavi√£o Mascarenhas, A. Ziviani, K. Wehmuth, and
A. B. Vieira, ‚ÄúOn the transaction dynamics of the ethereum-based
cryptocurrency,‚Äù Journal of Complex Networks, vol. 8, no. 4, p. cnaa042,
2020.

[87] M. Zhang, X. Zhang, Y. Zhang, and Z. Lin, ‚ÄúTxspector: Uncovering
attacks in ethereum from transactions,‚Äù in USENIX Security Symposium,
2020.

[88] L. Zhao, S. Sengupta, A. Khan, and R. Luo, ‚ÄúTemporal analysis
of the entire ethereum blockchain network,‚Äù Proceedings of the Web
Conference 2021, 2021.

[89] L. Zhou, K. Qin, A. Cully, B. Livshits, and A. Gervais, ‚ÄúOn the just-in-
time discovery of proÔ¨Åt-generating transactions in deÔ¨Å protocols,‚Äù arXiv
preprint arXiv:2103.02228, 2021.

APPENDIX

Arbitrage usually triggers several

token exchanges in
transactions,
in which arbitrageurs intend to gain proÔ¨Åts
by making use of the differentials of the token price in
various platforms. We Ô¨Årst describe the steps to extract swaps,
which are the basic elements of detecting arbitrages. Then
we introduce two types of arbitrages and their detection
algorithms. Lastly, we perform detection on our one-year
dataset and analyze the detected results.

A. Extracting Swaps

Swaps are the basic elements to detect arbitrage, which
can be identiÔ¨Åed from the generated MFGs from transactions.
In particular, we use the Johnathan‚Äôs algorithm [45] to extract
all the simple cycles in the MFG. Secondly, we exclude the

16

unlikely cycles forming a swap and identify swaps based on
their patterns. We classify the swaps into three types as follows
and display the pattern of every type in Fig. 15.

‚Ä¢ Type I: Swap contains two token-exchange edges. These

two edges form a cycle between nodes A and B.

‚Ä¢ Type II: Similar to Type I, there should be a cycle; but the
Swap involves more than two nodes, compared to Type I.
There will be at least two different token types and three
edges in the whole Swap. Usually, this type of Swap is
started by node A which tries to exchange tokens with node
B. But there are some intermediate nodes involved, and the
process forms a cycle.

‚Ä¢ Type III: In such swaps, node A plans to exchange tokens
with node B but B does not have enough tokens to
transfer. Thus, the left tokens will be transferred back to
A. SpeciÔ¨Åcally, either node B or another node C which
belongs to the same owners as B will send the tokens back
to node A. Generally, there will be four edges in this type
of swaps including two edges indicating the swap between
node A and node B, one edge of sending the left token
from B or C to node A, and another edge transferring the
exchanged token from node B to node C.

Algorithm 1 The algorithm of Cyclic Arbitrage

Input: Swaps
Output: Cyclic Arbitrage Report

for Swap ‚Üê Swaps1 to SwapsN do

1: function CYCLICARBITRAGE(Swaps)
2:
3:
4:
5:
6:
7:
8: end function

if Swap is ordered then
T s ‚Üê Swap.P ath
for T ‚Üê T1 to TN do
if Check(T ) then

return CyclicArbitrageReport

B. Cyclic Arbitrage

Cyclic arbitrage has the token exchanges in a single swap

consisting a cycle and should gain proÔ¨Åts.
Detection Algorithm. To detect the cyclic arbitrage, we deÔ¨Åne
our detection algorithm in Alg. 1. The algorithm Ô¨Årst iterates
the swaps one by one. For each iteration, the swap will be
checked whether it is ordered. If the MFGIndex in the swap
is increasing one by one (e.g., [1, 2, 3]), the swap is ordered.
With the ordered transfers in money Ô¨Çow, the balance of every
Ethereum address will be calculated. If the address receives
more tokens than sent, then it means the address launches the
cyclic arbitrage and earns beneÔ¨Åts via this transaction. These
conditions are checked in the Check function.

C. None-Cyclic Arbitrage

None-Cyclic arbitrage has the token exchanges in several
swaps, which can be detected by the following two
requirements:

‚Ä¢ Some swaps by the arbitrageur: There should be some

swaps in the transaction with different prices.

‚Ä¢ Arbitrageur makes money: With all

the
arbitrageur makes money that it receives more tokens than
sent.

the swaps,

(a) The swap type I.

(b) The swap type II.

(c) The swap type III.

(d) The swap type III.

Fig. 15: Three types of swaps: x represents the token type; y means the amount of token; A, B, C, and N represent the addresses.

Algorithm 2 The algorithm of None-Cyclic Arbitrage

Input: Swaps
Output: N one ‚àí Cyclic Arbitrage Report

1: function NONECYCLICARBITRAGE(Swaps)
AddrSwapsN ‚Üê SwapByAddr(Swaps)
2:
for AddrSwaps ‚Üê AddrSwaps1 to AddrSwapsN
3:

do

if Check(AddrSwaps) then

if Balance(AddrSwaps) > 0 then

return N oneCyclicArbitrageReport

4:
5:
6:
7: end function

Arbitrageur address
0x74de5d4fcbf63e00296fd95d33236b9794016631
0xdfee68a9adb981cd08699891a11cabe10f25ec44
0x911605012f87a3017322c81fcb4c90ada7c09116
0x5aa3393e361c2eb342408559309b3e873cd876d6
0xa1006d0051a35b0000f961a8000000009ea8d2db
0x5144aca278867ab6c04455464d8f6a2607e3c075
0x9008d19f58aabd9ed0d60971565aa8510560ab41
0x000000000000abe945c436595ce765a8a261317b
0x018d5c4783f5317815f6e8168942a12adde3cd3c
0x7cf09d7a9a74f746edcb06949b9d64bcd9d1604f

Flagged Cyclic
62,121
0
7,814
0
14,184
18,028
24,285
6,325
4,926
1,506

62,122
52,982
37,968
33,826
28,390
26,339
24,297
24,065
23,869
22,158

Non-cyclic
1
52,982
30,154
33,826
14,206
8,311
12
17,740
18,943
20,652

TABLE VIII: The top 10 arbitrageurs in private transactions.

Detection Algorithm. We deÔ¨Åne our detection rules based
on the requirements in Alg. 2. The algorithm Ô¨Årst sorts the
obtained swaps by the swap address. If an address contains
two or more token swaps with different token pairs, then select
it as the arbitrageur candidate since the none-cyclic arbitrage
requires multiple swaps for the same token. Then the swaps
will be looped and the balance of each involved Ethereum
address will be calculated. If at least one address has the
balance larger than 0, then it should be the arbitrageur and
gains money.

D. Analysis

Arbitrage is one type of MEV, which is pretty popular in
rencent days. Arbitragers can submit transactions searching
for opportunities and might cause Ô¨Ånancial losses to users.
We detect these two types of arbitrages in 7,405,835 private
transactions from the one-year dataset. SpeciÔ¨Åcally, there are
1,099,006 private transactions Ô¨Çagged as arbitrage with a total
value of approximately 389 million dollars. There are 376,393
cyclic and 722,613 non-cyclic arbitrages, respectively.
Top 10 arbitraguers in private transactions. We identify
the top 10 arbitrageurs
1,456 arbitrageurs and present
in Table VIII. The arbitrage transactions in the top 10
arbitrageurs account for 31% of the total, and the cumulative
proÔ¨Åts take around 10%. Most of the top arbitrageurs have
preferences on the type of arbitrages. For example, the top 1

Fig. 16: The count of arbitrage in private transactions per type
by month.

arbitrageur only has 1 non-cyclic arbitrage transaction among
the Ô¨Çagged 62,122 arbitrage transactions. Moreover, 95% of
the arbitrage transactions occur in popular DeFis, including
Uniswap [78], Sushiswap [68], and linch [1]. Besides, we
present
two types of arbitrage per month
there are more none-
in Fig. 16. In almost every month,
cyclic than cyclic arbitrage private transactions. In particular,
from July 2021 to December 2021, the count of none-cyclic
arbitrage private transactions is two or three times of the cyclic
arbitrage.

the count of

17

ABtoken (x1, y1)token (x2, y2)ABtoken (x1, y1)token (x2, y2)CNtoken (xn, yn)‚Ä¶ABtoken (x1, y1)token (x1, y2)Ctoken (x1, y1-y2)token (x2, y3)ABtoken (x1, y1)Ctoken (x1, y1-y2)token (x2, y3)token (x1, y2)                                                                  & R X Q W  R I  S U L Y D W H  W U D Q V D F W L R Q V√ó    & \ F O L F  D U E L W U D J H 1 R Q  F \ F O L F  D U E L W U D J HFig. 17: The cumulative proÔ¨Åt of arbitrage in private
transactions by month.

ProÔ¨Åt of the arbitrage private transactions. We present
the proÔ¨Åts of arbitrage by month in Fig. 17. The total proÔ¨Åts
earned from all arbitrage transactions is about 389 million
dollars, of which the proÔ¨Åt (around 1.1 million dollars) in May
2021 is the highest. Moreover, about 40% of the proÔ¨Åts Ô¨Çow
to the miner through transaction fees and direct payments to
miners.
Position of the arbitrage private transactions in blocks.
About 97% of the arbitrage private transactions are within the
top 10 inside the blocks. For the rest 3% arbitrages that are
outside the top 10, their mined blocks usually have lots of
transactions and transactions in the front positions inside these
blocks usually transfer proÔ¨Åts to miners, which causes huge
competitions. It is the reason why arbitrage private transactions
cannot be placed in the very front of blocks.
Tokens in arbitrage private transactions. We present the
count of arbitrage private transactions with the speciÔ¨Åc number
of
token types and DeFis in Table IX, which are used
for exchanging tokens. Arbitrageurs usually make use of
the differentials of token prices in different DeFis, to earn
proÔ¨Åts. From the table, arbitrage private transactions involving
in 2 DeFis accounts for the most. Moreover, we observe
that arbitrageurs normally will hold stablecoins (e.g., USDT,
USDC) as the proÔ¨Åts in the end of the arbitrage private
transactions.

Token Type

2
3
4
‚â• 5

DeFi

1

2

3

4

19,586
205,243
84,451
15,850

326,445
217,684
22,187
3,130

116,071
57,802
28,513
6,598

8,645
66,142
9,033
1,946

‚â• 5

387
6,416
8,198
10,750

TABLE IX: Token swap categories of arbitrage transactions

18

                                                                          9 D O X H    0 L O O L R Q 