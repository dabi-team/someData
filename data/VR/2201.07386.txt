2
2
0
2

n
u
J

6
1

]
T
I
.
s
c
[

2
v
6
8
3
7
0
.
1
0
2
2
:
v
i
X
r
a

An Optimization Framework for General Rate

Splitting for General Multicast

Lingzhi Zhao, Ying Cui, Sheng Yang, and Shlomo Shamai (Shitz)

1

Abstract

Immersive video, such as virtual reality (VR) and multi-view videos, is growing in popularity. Its

wireless streaming is an instance of general multicast, extending conventional unicast and multicast,

whose effective design is still open. This paper investigates general rate splitting for general multicast.

Speciﬁcally, we consider a multi-carrier single-cell wireless network where a multi-antenna base station

(BS) communicates to multiple single-antenna users via general multicast. We consider linear beamform-

ing at the BS and joint decoding at each user in the slow fading and fast fading scenarios. In the slow

fading scenario, we consider the maximization of the weighted sum average rate, which is a challenging

nonconvex stochastic problem with numerous variables. To reduce computational complexity, we de-

couple the original nonconvex stochastic problem into multiple nonconvex deterministic problems, one

for each system channel state. Then, we propose an iterative algorithm for each deterministic problem

to obtain a Karush-Kuhn-Tucker (KKT) point using the concave-convex procedure (CCCP). In the fast

fading scenario, we consider the maximization of the weighted sum ergodic rate. This problem is more

challenging than the one for the slow fading scenario, as it is not separable. First, we propose a stochastic

iterative algorithm to obtain a KKT point using stochastic successive convex approximation (SSCA) and

the exact penalty method. Then, we propose two low-complexity iterative algorithms to obtain feasible

points with promising performance for two cases of channel distributions using approximation and

CCCP. The proposed optimization framework generalizes the existing ones for rate splitting for various

types of services. Finally, we numerically show substantial gains of the proposed solutions over existing

schemes in both scenarios and reveal the design insights of general rate splitting for general multicast.

Index Terms

General multicast, general rate splitting, linear beamforming, joint decoding, optimization, concave-

convex procedure (CCCP), stochastic successive convex approximation (SSCA).

Lingzhi Zhao and Ying Cui are with the Department of Electronic Engineering, Shanghai Jiao Tong University, Shanghai,
China. Sheng Yang is with the Laboratory of Signals and Systems, CentraleSup´elec-CNRS-Paris-Saclay University, Gif-sur-
Yvette, France. Shlomo Shamai (Shitz) is with the Technion–Israel Institute of Technology, Haifa, Israel.

June 17, 2022

DRAFT

 
 
 
 
 
 
2

(a) 360 video

(b) Multi-view video

Fig. 1. Applications of general multicast.

I. INTRODUCTION

Conventional mobile Internet services include (traditional) video, audio, web browsing, social

networking, software downloading, etc. These services can be supported by unicast, unicast with

a common message, single-group multicast, and multi-group multicast. Immersive video, such

as 360 video (projection of virtual reality (VR) spherical video onto a rectangle) and multi-

view video (a key technique in free-viewpoint television, naked-eye 3D and VR), is growing in

popularity. It is predicted that the VR market will reach 87.97 billion USD by 2025 [1]. When

watching a 360 video, the tiles in a user’s current FoV plus a safe margin are usually transmitted

to the user in case of FoV change. On the other hand, when watching a multi-view video, a

user’s current view and adjacent views are usually transmitted to the user in case of a view

switch. In wireless streaming of a popular immersive video to multiple users simultaneously,

multiple messages (e.g., tiles for 360 video and views for multi-view video) are transmitted

to each user, and one message may be intended for multiple users [2], [3], as illustrated in

Fig. 1. This emerging service plays an important role in online gaming, self-driving, and cloud

meeting, etc. but cannot perfectly adapt to the conventional transmission schemes mentioned

above. This motivates us to consider general multicast (also referred to as general connection

[7], [8] and general groupcast [9]) where one message can be intended for any user. Clearly,

general multicast includes conventional unicast, unicast with a common message, single-group

multicast, and multi-group multicast as special cases.

References [2]–[5] are pioneer works for supporting wireless streaming of a 360 video [2], [4]

and wireless streaming of a multi-view video [3], [5], which are instances of general multicast. In

[2]–[5], Orthogonal Multiple Access (OMA), such as Time Division Multiple Access (TDMA)

[2], [3] and Orthogonal Frequency Division Multiple Access (OFDMA) [4], [5], is adopted to

convert general multicast to per resource block single-group multicast. While the OMA-based

June 17, 2022

DRAFT

3

mechanisms are easy to implement, spatial multiplexing gain is not exploited. On the other

hand, non-orthogonal transmission mechanisms achieve higher transmission efﬁciency but are

also more challenging due to interference. Space Division Multiple Access (SDMA) and Non-

Orthogonal Multiple Access (NOMA) are two solutions. The cost to suppress interference in

SDMA can be high when the channels for some users are spatially aligned, while decoding

interference in NOMA may not be possible when the interfering message rate is too high. Thus,

SDMA and NOMA may have unsatisfactory performance. Rate splitting [6], [20] is introduced to

partially suppress interference and partially decode interference to circumvent these limitations.

Rate splitting is originally proposed to effectively support unicast services [12]. Speciﬁcally,

[12] investigates the simplest form of rate splitting for unicast, hereafter called 1-layer rate

splitting, for the two-user interference channel. The idea of 1-layer rate splitting is as follows.

First, each individual message is split into one private part and one common part, respectively.

Then, the common parts of all the messages are re-assembled into one common message that is

multicasted to all the users, and the private parts are unicasted to the corresponding receivers,

respectively. In this way, part of the interference can be removed since it is decodable by design.

Later, in [13], 1-layer rate splitting is applied to the multi-antenna broadcast channel (BC) and

shown to provide a strict sum degree of freedom gain of a BC when only imperfect channel

state information at the transmitter is available. In [14]–[18], the authors investigate the precoder

optimization of 1-layer rate splitting for unicast for Gaussian multiple-input multiple-output

channels. In particular, the rates and beamforming vectors for common and private messages are

optimized to maximize the sum rate [14], [18], worst-case rate [15], [16] or ergodic sum rate

[17]. On the one hand, [19], [20] extend 1-layer rate splitting for unicast to general rate splitting

for unicast and study the optimization of three-user unicast [19] and multi-user unicast [20],

respectively, with linear precoding. On the other hand, [21]–[25] generalize 1-layer rate splitting

for unicast to 1-layer rate splitting for unicast together with a multicast message intended for all

users [21] and multi-group multicast [22]–[25], respectively, and investigate the optimizations

with linear beamforming. Note that most works [14]–[16], [18]–[21], [23]–[25] focus on the

slow fading scenario, whereas [17], [22] concentrates on the fast fading scenario.

Optimization-based random linear network coding designs for general multicast have been

studied in [7], [8] for wired networks. Besides, general rate splitting for general multicast has

been studied in [9] for discrete memoryless broadcast channels. Here, we are interested in

Gaussian fading channels and speciﬁcally the linear beamforming design from the optimization

June 17, 2022

DRAFT

4

perspective. In general rate splitting for general multicast, each message intended for a user group

is split into sub-messages, one for each subset of users containing the user group. Then, the sub-

messages intended for the same group of users are re-assembled and multicasted to the group.

In this way, each user group decodes the desired message and part of the message of any other

user group. Note that general rate splitting for general multicast produces more sub-messages

and enables more ﬂexible and effective interference reduction than brute-force application of

general rate splitting for unicast [19], [20] to general multicast.1 Besides, the optimizations

of rate splitting for unicast and its slight generalization in [21]–[25] cannot apply to general

multicast. Therefore, for general multicast in both slow fading and fast fading scenarios, the

optimization of general rate splitting with linear beamforming remains an open problem.

This paper intends to shed some light on the above issue. Speciﬁcally, we consider a multi-

carrier single-cell wireless network, where a multi-antenna base station (BS) communicates to

multiple single-antenna users via general multicast. Our main contributions are summarized

below.

• We present general rate splitting for general multicast and illustrate its connection with

conventional unicast, unicast with a common message, single-group multicast, and multi-

group multicast. We adopt linear beamforming at the BS and joint decoding at each user

and characterize the corresponding rate regions in the slow fading and fast fading scenarios.

• In the slow fading scenario, we optimize the transmission beamforming vectors and rates

of sub-message units to maximize the weighted sum average rate. Note that the proposed

problem formulation can reduce to those for general rate splitting for unicast [20], unicast

with a common message [21], single-group multicast [26], and 1-layer rate splitting for

multi-group multicast [23]. This problem is a challenging nonconvex stochastic problem

with a large number of variables. To reduce computational complexity, we decouple the

original nonconvex stochastic problem into multiple nonconvex deterministic problems, one

for each system channel state. Then, for each nonconvex deterministic problem, we propose

an iterative algorithm to obtain a Karush-Kuhn-Tucker (KKT) point using the concave-

convex procedure (CCCP).

• In the fast fading scenario, we optimize the transmission beamforming vectors and rates of

sub-message units to maximize the weighted sum ergodic rate and show that the problem

1One can brute-forcely apply general rate splitting [19], [20] for unicast to general multicast by treating a group of users who

request the same message as a virtual user.

June 17, 2022

DRAFT

5

TABLE I. KEY NOTAION

Notation
K
K
I
I
Ik
S
PS
GS
RS
RS(h)
M
N
B
wG,n(h)
wG,n

Description
number of users
set of K user indices
number of messages
set of the indices of I messages
set of the indices of messages requested by user k
subset of K
set of the indices of the messages requested by each user in S and not requested by any user in K\S
subsets of K that contain S
rate of the message unit PS
rate of the message unit PS(h) under h
number of the antennas
number of the subcarriers
bandwidth of each subcarrier
beamforming vector for transmitting ˜PG(h) on subcarrier n under h
constant beamforming vector for transmitting ˜PG on subcarrier n

formulation can reduce to the one for 1-layer rate splitting for unicast [17]. This problem is

more challenging than the one for the slow fading scenario, as it is not separable. First, we

propose a stochastic iterative algorithm to obtain a KKT point using stochastic successive

convex approximation (SSCA) and the exact penalty method. Then, we propose two low-

complexity iterative algorithms to obtain feasible points with promising performance for

two cases of channel distributions, i.e., spatially correlated channel and independent and

identically distributed (i.i.d.) channel, using approximation and CCCP. It is noteworthy that

the proposed optimization framework also provides general rate splitting designs for other

service types in the fast fading scenario.

• We compare the complexities of the proposed solutions in the slow fading and fast fading

scenarios. We also numerically demonstrate substantial gains of the proposed solutions over

existing schemes in both scenarios and reveal the design insights of general rate splitting

for general multicast.

Notation: We represent vectors by boldface lowercase letters (e.g., x), matrices by boldface

uppercase letters (e.g., X), scalar constants by non-boldface letters (e.g., x), sets by calligraphic

letters (e.g., X ), and sets of sets by boldface calligraphic letters (e.g., X ). The notation xi
represents the i-th element of vector x. The symbol (·)H denotes complex conjugate transpose

operator. k · k2 denotes the Euclidean norm of a vector. ℜ{·} denotes the real part of a complex
number. E[·] denotes the statistical expectation. IM ×M denotes the M × M identity matrix. C
denotes the set of complex numbers.

II. SYSTEM MODEL

In this section, we ﬁrst introduce general multicast in a single-cell wireless network and brieﬂy

illustrate its connection with unicast, unicast with a common message, single-group multicast,

June 17, 2022

DRAFT

and multi-group multicast. Then, we present the physical layer model and general rate splitting

with joint decoding for general multicast. The key notation used in this paper is listed in Table

6

I.

A. General Multicast

We consider a single-cell wireless network consisting of one BS and K users. Let K ,
{1, . . . , K} denote the set of user indices. The BS has I independent messages. Let I ,

{1, . . . , I} denote the set of the indices of I messages. We consider general multicast. Speciﬁcally,

each user k ∈ K can request arbitrary Ik messages in I, denoted by Ik ⊆ I, from the BS. We

do not have any assumptions on Ik, k ∈ K except that each message in I is requested by at

least one user, i.e., ∪k∈KIk = I.

To facilitate serving the K users, we partition the message set I according to the requests

from the K users. For all S ⊆ K, S 6= ∅, let

\
denote the set of the indices of messages requested by each user in S and not requested by any





k∈K\S
[

I −



Ik



(1)

PS ,

Ik

!

k∈S
\

user in K\S [2]. Deﬁne

P , {PS|PS 6= ∅, S ⊆ K, S 6= ∅},

S , {S|PS 6= ∅, S ⊆ K, S 6= ∅}.

Thus, P forms a partition of I and S speciﬁes the user groups corresponding to the partition.

We refer to each element in P as a message unit.2 We can see that different message units in

P are requested by different user groups in S.

Example 1 (Illustration of P and S for Two-User Case): As illustrated in Fig. 2 (a), we

consider K = 2, I = 6, I1 = {1, 2, 5, 6}, I2 = {2, 3, 6, 7}. Then, we have P{1} = {1, 5},
P{2} = {3, 7}, P{1,2} = {2, 6}, P = {P{1}, P{2}, P{1,2}}, and S = {{1}, {2}, {1, 2}}. There are

3 message units that are requested by 3 groups of users, respectively. For example, message unit

P{1} is requested only by user 1 and message unit P{1,2} is requested by user 1 and user 2.3

2P and S are assumed to be given in [9].

3This general multicast scenario coincides with unicast with a common message.

June 17, 2022

DRAFT

 
7

(a) K = 2, I = 6, I1 = {1, 2, 5, 6}, I2 = {2, 3, 6, 7}.

(b) K = 3, I = 8, I1 = {1, 2, 5, 6}, I2 = {2, 3, 6, 7},
I3 = {5, 6, 9, 10}.

Fig. 2. Wireless streaming of a tiled 360 video to multiple users. The 360 video is divided into 4 × 4 tiles. The
users have different FoVs which overlap to certain extent.

Example 2 (Illustration of P and S for Three-User Case): As illustrated in Fig. 2 (b), we

consider K = 3, I = 8, I1 = {1, 2, 5, 6}, I2 = {2, 3, 6, 7}, I3 = {5, 6, 9, 10}. Then, we have

P{1} = {1}, P{2} = {3, 7}, P{3} = {9, 10}, P{1,2} = {2}, P{1,3} = {5}, P{1,2,3} = {6},
P = {P{1}, P{2}, P{3}, P{1,2}, P{1,3}, P{1,2,3}}, and S = {{1}, {2}, {3}, {1, 2}, {1, 3}, {1, 2, 3}}.

There are 6 message units that are requested by 6 groups of users, respectively. For example,

message unit P{1} is requested only by user 1, message unit P{1,2} is requested by user 1 and

user 2, and message unit P{1,2,3} is requested by user 1, user 2, and user 3.

Remark 1 (Connection with Unicast and Multicast): The considered general multicast includes

conventional unicast, unicast with a common message, single-group multicast, and multi-group

multicast as special cases. (i) When I = K, Ik = 1, k ∈ K, and Ik 6= Ik′, k, k′ ∈ K, k 6= k′,

general multicast reduces to unicast [14]–[20]. In this case, P = {{1}, {2}, . . . , {K}} and

S = {{1}, {2}, . . . , {K}}. (ii) When I = K + 1, Ik = 2, k ∈ K, Ik 6= Ik′, k, k′ ∈ K, k 6= k′,

and | ∩k∈K Ik| = 1, general multicast reduces to unicast with a common message [21]. In this
case, P = {{1}, {2}, . . . , {K}, K} and S = {{1}, {2}, . . . , {K}, K}. (iii) When I = 1, implying

Ik = 1, k ∈ K, and Ik = Ik′, k, k′ ∈ K, k 6= k′, general multicast becomes single-group multicast
[26]. In this case, P = {{1}} and S = {K}. (iv) When 1 < I < K and Ik = 1, k ∈ K,
general multicast reduces to multi-group (I-group) multicast [22]–[25]. In this case, P =

{{1}, {2}, . . . , {I}} and S = {{k ∈ K|Ik = {1}}, {k ∈ K|Ik = {2}}, . . . , {k ∈ K|Ik = {I}}}.

The general multicast considered in this paper, general connection in [7], [8], and general

groupcast considered in [9] mean the same.

June 17, 2022

DRAFT

8

B. General Rate Splitting

We consider rate splitting in the most general form for general multicast to serve the K users

[9]. It allows each user group to decode not only the desired message unit PS but also part of
6= S, S ′ ∈ S, to ﬂexibly reduce the
the message unit of any other user group, PS ′ for all S ′
interference level. For all S ∈ S, let GS , {X |S ⊆ X ⊆ K}. Namely, GS collects all 2K−|S|
subsets of K that contain S. Deﬁne G ,
S∈S GS. Obviously, S ⊆ G. First, we split each
message unit PS into 2K−|S| sub-message units. Accordingly, the rate of the message unit PS,
denoted by RS, is split into the rates of the 2K−|S| sub-message units, denoted by RS,G, G ∈ GS
4

S

i.e.,

RS =

RS,G, S ∈ S.

G∈GS

(2)

Let S G , {S ∈ S|S ⊆ G}. Then, for all G ∈ G, we re-assemble the sub-message units to form
a transmission unit

PG with rate:

X

e

RG =

RS,G, G ∈ G.

S∈SG

(3)

That is, we ﬁrst split |S| message units, PS, S ∈ S, into
then we re-assemble these sub-message units to form |G| transmission units,

S∈S 2K−|S| sub-message units and

PG, G ∈ G.

P

X

e

Example 3 (Illustration of G and General Rate Splitting for Two-User Case): For Example

1, we have G{1} = {{1}, {1, 2}}, G{2} = {{2}, {1, 2}}, G = {{1}, {2}, {1, 2}}. As shown in

e

Fig. 2 (a), we ﬁrst split 3 message units into 5 sub-message units and then re-assemble the 5

sub-message units to form 3 transmission units.

Example 4 (Illustration of G and General Rate Splitting for Three-User Case): For Exam-

ple 2, we have G{1} = {{1}, {1, 2}, {1, 3}, {1, 2, 3}}, G{2} = {{2}, {1, 2}, {2, 3}, {1, 2, 3}},

G{3} = {{3}, {1, 3}, {2, 3}, {1, 2, 3}}, G{1,2} = {{1, 2}, {1, 2, 3}}, G{1,3} = {{1, 3}, {1, 2, 3}},
G = {{1}, {2}, {3}, {1, 2}, {1, 3}, {2, 3}, {1, 2, 3}}. As shown in Fig. 2 (b), we ﬁrst split 6

message units into 17 sub-message units and then re-assemble the 17 sub-message units to form

7 transmission units.

Remark 2 (Connection with Rate Splitting for Unicast and Multicast): (i) When general

multicast degrades to unicast, the proposed general rate splitting reduces to the general rate

splitting for unicast proposed in our previous work [20], which extends the one-layer rate splitting

4When S = K, GS = {S} and the message unit PS will not be split. For ease of exposition, we let RS = RS,S for S = K.

June 17, 2022

DRAFT

9

for unicast [17]. (ii) When general multicast degrades to unicast with a common message, the

proposed general rate splitting reduces to the one-layer rate splitting for unicast with a common

message [21]. (iii) When general multicast degrades to single-group multicast, the proposed

general rate splitting reduces to the conventional single-group multicast transmission [26]. (iv)

When general multicast degrades to multi-group multicast, the proposed general rate splitting

reduces to the one-layer rate splitting for multi-group multicast [23].

C. Physical Layer Model

The BS is equipped with M antennas, and each user has one antenna. We consider a multi-
carrier system. Let N and N , {1, 2, . . . , N} denote the number of subcarriers and the set of

subcarrier indices, respectively. The bandwidth of each subcarrier is B (in Hz). We consider

a discrete-time system, i.e., time is divided into ﬁxed-length slots. We adopt the block fading

model, i.e., for each user and subcarrier, the channel remains constant within each slot and is
independent and identically distributed (i.i.d.) over slots. Let ϑk,n ∈ H denote the M-dimensional
random channel vector for user k and subcarrier n, where H ⊆ CM denotes the M-dimensional
channel state space. Let ϑ , (ϑk,n)k∈K,n∈N ∈ HKN denote the random system channel state,
where HKN represents the system channel state space. Besides, let h , (hk,n)k∈K,n∈N denote
a realization of ϑ in one slot, where hk,n is a realization of ϑk,n. Assume that user k ∈ K
knows his channel state hk , (hk,n)n∈N in each slot. We consider two channel models which
are presented below.

1) Slow Fading: We assume that the system channel state is known to the BS in each slot

and adopt transmission rate adaptation over slots. We consider channel coding within each slot

and across the N subcarriers. For the sake of exposition, we consider an arbitrary slot with
system channel state h and any user group S ∈ S. Let PS(h) denote the component of PS to

be transmitted to user group S in the slot, also referred to as message unit, and RS(h) denote

the corresponding (transmission) rate of PS(h). Then, the average rate of message unit PS is
given by E[RS (ϑ)]. We apply the general rate splitting scheme presented in Section II-B to
transmit PS(h), S ∈ S to all user groups in S in the slot. Speciﬁcally, for all S ∈ S, message
unit PS(h) is split into 2K−|S| sub-message units. The rate RS(h) of PS(h) and the rates of the
sub-message unit, denoted by RS,G(h), G ∈ GS, satisfy:

RS(h) =

G∈GS

X

RS,G(h), S ∈ S, h ∈ HKN .

(4)

DRAFT

June 17, 2022

Then, for all G ∈ G, we re-assemble sub-message units to form transmission unit

PG(h) with

rate:

RG(h) =

S∈SG

RS,G(h), G ∈ G, h ∈ HKN .

e

(5)

10

For all G ∈ G, transmission unit

e

PG(h) is encoded (channel coding) into codewords that span

X

e

over the N subcarriers. Let sG,n(h) ∈ C denote a symbol for
th subcarrier. For all n ∈ N , let sn(h) , (sG,n(h))G∈G, and assume that E[sn(h)sH
n (h)] = I. We
consider linear beamforming. For all n ∈ N , let wG,n(h) ∈ CM ×1 denote the beamforming vector
PG(h) on subcarrier n in the slot. Using superposition coding, the transmitted
for transmitting
signal on subcarrier n, denoted by xn(h) ∈ CM ×1, is given by:

PG(h) that is transmitted on the n-

e

e

xn(h) =

G∈G

wG,n(h)sG,n(h), n ∈ N , h ∈ HKN .

(6)

The transmission power on subcarrier n ∈ N is given by

transmission power is given by

n∈N

G∈G kwG,n(h)k2

G∈G kwG,n(h)k2

2, and the total
2. In the slow fading scenario, the total

P

X

transmission power constraint is given by:
P

P

n∈N

G∈G

kwG,n(h)k2

2 ≤ P, h ∈ HKN .

(7)

X

X

Here, P denotes the transmission power budget. Deﬁne G(k) , {G ∈ G|k ∈ G}, k ∈ K. Then,
the received signal at user k ∈ K on subcarrier n ∈ N , denoted by yk,n(h) ∈ C, is given by:

yk,n(h) =hH

k,nxn(h) + zk,n = hH
k,n

wG,n(h)sG,n(h)

G∈G(k)

+ hH
k,n

G′∈G\G(k)

X

wG′,n(h)sG′,n(h) + zk,n, k ∈ K, n ∈ N , h ∈ HKN ,

(8)

where the last equality is due to (6), and zk,n ∼ CN (0, σ2) is the additive white gaussian

X

noise (AWGN). In (8), the ﬁrst term represents the desired signal, and the second represents

the interference. It is noteworthy that the main idea of rate splitting is to make the undesired

messages partially decodable in order to reduce interference [20]. To exploit the full potential

of the general rate splitting for general multicast, we consider joint decoding at each user.5 That
PG(h), G ∈ G(k). Thus, in the

is, each user k ∈ K jointly decodes the desired transmission units

slow fading scenario, the achievable rate region of the transmission units in the slot with system

e

5We can easily extend it to successive decoding as in [20].

June 17, 2022

DRAFT

channel state h is described by the following constraints:

RG(h) ≤ B

log2

1 +

G∈X
X

e

n∈N
X

σ2 +

where

RG(h) is given by (5).

k,nwG,n(h)|2

G∈X |hH
G′∈G\G(k) |hH

k,nwG′ ,n(h)|2

P
P

11

, X ⊆ G(k), k ∈ K, h ∈ HKN ,

!

(9)

e

Example 5 (Illustration of Physical Layer Design for Two-user Case in Slow Fading): For

Example 1, the rates of message units P{1}(h), P{2}(h), and P{1,2}(h) are R{1}(h), R{2}(h),
and R{1,2}(h), respectively. The rates of transmission units ˜P{1}(h), ˜P{2}(h), and ˜P{1,2}(h) are
˜R{1}(h) = R{1},{1}(h), ˜R{2}(h) = R{2},{2}(h), and ˜R{1,2}(h) = R{1,2}(h) + R{1},{1,2}(h) +
R{2},{1,2}(h), respectively. The beamforming vectors for transmitting ˜P{1}(h), ˜P{2}(h), and
˜P{1,2}(h) on subcarrier n ∈ N are w{1},n(h), w{2},n(h), and w{1,2},n(h), respectively.

Example 6 (Illustration of Physical Layer Design for Three-user Case in Slow Fading):

For Example 2, the rates of message units P{1}(h), P{2}(h), P{3}(h), P{1,2}(h), P{1,3}(h),

and P{1,2,3}(h) are R{1}(h), R{2}(h), R{3}(h), R{1,2}(h), R{1,3}(h), and R{1,2,3}(h), respec-
tively. The rates of transmission units ˜P{1}(h), ˜P{2}(h), ˜P{3}(h), ˜P{1,2}(h), ˜P{1,3}(h), ˜P{2,3}(h),
and ˜P{1,2,3}(h) are ˜R{1}(h) = R{1},{1}(h), ˜R{2}(h) = R{2},{2}(h), ˜R{3}(h) = R{3},{3}(h),
˜R{1,2}(h) = R{1,2},{1,2}(h)+R{1},{1,2}(h)+R{2},{1,2}(h), ˜R{1,3}(h) = R{1,3},{1,3}(h)+R{1},{1,3}(h)+
R{3},{1,3}(h), ˜R{2,3}(h) = R{2},{2,3}(h)+R{3},{2,3}(h), and ˜R{1,2,3}(h) = R{1,2,3}(h)+R{1,3},{1,2,3}(h)+
R{1,2},{1,2,3}(h) + R{1},{1,2,3}(h) + R{2},{1,2,3}(h) + R{3},{1,2,3}(h), respectively. The beamform-
ing vectors for transmitting ˜P{1}(h), ˜P{2}(h), ˜P{3}(h), ˜P{1,2}(h), ˜P{1,3}(h), ˜P{2,3}(h), and
˜P{1,2,3}(h) on subcarrier n ∈ N are w{1},n(h), w{2},n(h), w{3},n(h), w{1,2},n(h), w{1,3},n(h),
w{2,3},n(h), and w{1,2,3},n(h), respectively.

2) Fast Fading: We assume that the system channel state is unknown to the BS in each

slot, but its distribution is known to the BS. We consider channel coding over many slots and

across the N subcarriers. We apply the general rate splitting scheme presented in Section II-B

to transmit PS, S ∈ S to all user groups in S over many slots. For all G ∈ G, transmission unit
PG is encoded into codewords that span over the N subcarriers and many slots. Let sG,n ∈ C
PG that is transmitted on the n-th subcarrier. Let wG,n ∈ CM ×1 denote
denote a symbol for
e
PG on subcarrier n over these slots. Similarly,
the constant beamforming vector for transmitting

e

e

June 17, 2022

DRAFT

 
using superposition coding, the transmitted signal on subcarrier n is given by:

xn =

wG,nsG,n, n ∈ N .

G∈G

12

(10)

X
The total transmission power is given by

n∈N
total transmission power constraint is given by:

P

G∈G kwG,nk2

2. In the fast fading scenario, the

P

n∈N

G∈G

kwG,nk2

2 ≤ P.

(11)

Then, in a slot with system channel state h, the received signal at user k on subcarrier n, denoted
by yk,n ∈ C, is given by:

X

X

yk,n = hH

k,nxn + zk,n

= hH
k,n

wG,nsG,n + hH
k,n

G∈G(k)

G′∈G\G(k)

wG′,nsG′,n + zk,n, k ∈ K, n ∈ N ,

where the last equality is due to (10). Similarly, we consider joint decoding at each user. The

X

X

achievable ergodic rate region of the transmission units over these slots is given by:

RG ≤ B

E

log2

"

1 +

σ2 +

n∈N
X

G∈X
X

e

where

RG is given by (3).

k,nwG,n|2

G∈X |ϑH
G′∈G\G(k) |ϑH

k,nwG′ ,n|2

P
P

, X ⊆ G(k), k ∈ K,

(12)

!#

e

Example 7 (Illustration of Physical Layer Design for Two-user Case in Fast Fading): For Ex-

ample 1, the rates of message units P{1}, P{2}, and P{1,2} are R{1}, R{2}, and R{1,2}, respectively.
The rates of transmission units ˜P{1}, ˜P{2}, and ˜P{1,2} are ˜R{1} = R{1},{1}, ˜R{2} = R{2},{2}, and
˜R{1,2} = R{1,2} + R{1},{1,2} + R{2},{1,2}, respectively. The beamforming vectors for transmitting
˜P{1}, ˜P{2}, and ˜P{1,2} on subcarrier n ∈ N are w{1},n, w{2},n, and w{1,2},n, respectively.

Example 8 (Illustration of Physical Layer Design for Three-user Case in Fast Fading):

For Example 2, the rates of message units P{1}, P{2}, P{3}, P{1,2}, P{1,3}, and P{1,2,3} are
R{1}, R{2}, R{3}, R{1,2}, R{1,3}, and R{1,2,3}, respectively. The rates of transmission units ˜P{1},
˜P{2}, ˜P{3}, ˜P{1,2}, ˜P{1,3}, ˜P{2,3}, and ˜P{1,2,3} are ˜R{1} = R{1},{1}, ˜R{2} = R{2},{2}, ˜R{3} =
R{3},{3}, ˜R{1,2} = R{1,2},{1,2} + R{1},{1,2} + R{2},{1,2}, ˜R{1,3} = R{1,3},{1,3} + R{1},{1,3} + R{3},{1,3},
˜R{2,3} = R{2},{2,3} + R{3},{2,3}, and ˜R{1,2,3} = R{1,2,3} + R{1,3},{1,2,3} + R{1,2},{1,2,3} + R{1},{1,2,3} +
R{2},{1,2,3} + R{3},{1,2,3}, respectively. The beamforming vectors for transmitting ˜P{1}, ˜P{2}, ˜P{3},

June 17, 2022

DRAFT

 
13

Illustration of the proposed solution framework for the slow fading scenario. “determin.” and “stoch.”
Fig. 3.
are short for “deterministic” and “stochastic”, respectively. “trans.”, “Equiv.”, “Approx.”, and “Prob.” are short for
“transformation”, “Equivalent”, “Approximation”, and “Problem”, respectively.

˜P{1,2}, ˜P{1,3}, ˜P{2,3}, and ˜P{1,2,3} on subcarrier n ∈ N are w{1},n, w{2},n, w{3},n, w{1,2},n,
w{1,3},n, w{2,3},n, and w{1,2,3},n, respectively.

III. AVERAGE RATE MAXIMIZATION IN SLOW FADING SCENARIO

This section considers the slow fading scenario and maximizes the weighted sum average

rate under the achievable rate constraints and total transmission power constraints. The proposed

solution framework for the slow fading scenario is illustrated in Fig. 3.

A. Optimization Problem Formulation

We would like to optimize the transmission beamforming vectors w(h) , (wG,n(h))G∈G,n∈N , h ∈

HKN and rates of the sub-message units R(h) , (RS,G(h))S∈S,G∈G, h ∈ HKN to maximize
S∈S αSE [RS(ϑ)], where the coefﬁcient αS ≥ 0 denotes the
the weighted sum average rate,6
weight for message unit PS, subject to the total transmission power constraints in (7) and the

P

achievable rate constraints in (9). Therefore, we formulate the following optimization problem.

Problem 1 (Weighted Sum Average Rate Maximization):

U (slow)⋆ ,

max
(w(h))h∈HKN ,(R(h))h∈HKN (cid:23)0

s.t.

αSE [RS(ϑ)]

S∈S

X
(7), (9),

where RS(·) is given by (4).

As the objective function and constraints of Problem 1 are seperable with h ∈ HKN , Problem 1

is seperable and can be readily solved by solving the following problems for all h ∈ HKN in

parallel.

6The proposed problem formulation and solution method can be readily extended to maximize the sum average rate and

worst-case average rate as in [20].

June 17, 2022

DRAFT

14

(13)

, X ⊆ G(k), k ∈ K.

(14)

Problem 2 (Weighted Sum Rate Maximization for h):

max
w(h),R(h)(cid:23)0

s.t.

αSRS(h)

XS∈S
kwG,n(h)k2

2 ≤ P,

n∈N
X

XG∈G

RG(h) ≤ B

log2

1 +

k,nwG,n(h)|2

G∈X |hH
G′∈G\G(k) |hH

k,nwG′ ,n(h)|2

!

σ2 +

XG∈X
Remark 3 (Connection with Rate Splitting for Unicast and Multicast): (i) When general

n∈N
X

e

P
P

multicast degrades to unicast, Problem 2 reduces to the weighted sum rate maximization problem

for general rate splitting for unicast in [20]. (ii) When general multicast degrades to unicast with

a common message, Problem 2 can be viewed as a generalization of the weighted sum rate

maximization for unicast with a common message in [21]. (iii) When general multicast degrades

to single-group multicast, Problem 2 reduces to the rate maximization problem for single-group

multicast in [26]. (iv) When general multicast degrades to multi-group multicast, Problem 2 can

be viewed as a generalization of the weighted sum rate maximization for multi-group multicast

in [23].

Therefore, we can focus on solving Problem 2 for all h. Note that the objective function is

linear, the constraint in (13) is convex, and the constraints in (14) are nonconvex. Thus, Problem 2

is nonconvex.7

B. KKT Point

In this subsection, we propose an iterative algorithm to obtain a KKT point of Problem 2

using CCCP. First, we transform Problem 2 into the following equivalent problem by introducing
auxiliary variables e(h) , (ek,n,X (h))X ⊆G(k),k∈K,n∈N and u(h) , (uk,n,X (h))X ⊆G(k),k∈K,n∈N and
extra constraints:

RS,G(h) =

ek,n,X (h), X ⊆ G(k), k ∈ K,

S∈SG
G∈X
X
X
ek,n,X (h)
2
B

n∈N
X

≤ uk,n,X (h), X ⊆ G(k), k ∈ K, n ∈ N ,

(15)

(16)

7There are generally no effective methods for solving a nonconvex problem optimally. The goal of solving a nonconvex
problem is usually to design an iterative algorithm to obtain a stationary point or a KKT point (which satisﬁes necessary
conditions for optimality if strong duality holds).

June 17, 2022

DRAFT

 
|hH

G∈X
k,nwG′ ,n(h)|2 + σ2 − P

|hH

k,nwG,n(h)|2 +

G′∈G\G(k)
P
uk,n,X (h)

|hH

k,nwG′ ,n(h)|2 + σ2

XG′∈G\G(k)

15

≤ 0,

X ⊆ G(k), k ∈ K, n ∈ N .

(17)

Problem 3 (Equivalent DC Problem of Problem 2):

max
w(h),R(h)(cid:23)0,e(h),u(h)

s.t.

αS

RS,G(h)

G∈GS
X

S∈S
X
(13), (15), (16), (17).

Let (w⋆(h), R⋆(h), e⋆(h), u⋆(h)) denote an optimal solution of Problem 3.

Lemma 1 (Equivalence Between Problem 2 and Problem 3): (w⋆(h), R⋆(h), e⋆(h), u⋆(h))
k,n,X (h), X ⊆ G(k), k ∈ K, n ∈ N . Furthermore, Problem 2 and

e⋆
k,n,X (h)
B

= u⋆

satisﬁes 2

Problem 3 are equivalent.

Proof 1: First, by introducing auxiliary variables e(h) and u(h) and extra constraints:

ek,n,X (h)
B

2

= uk,n,X (h), X ⊆ G(k), k ∈ K, n ∈ N ,

(18)

we can equivalently transform Problem 2 into the following problem:

max
w(h),R(h)(cid:23)0,e(h),u(h)

s.t.

αS

RS,G(h)

XS∈S
XG∈GS
(13), (15), (17), (18)

Let (w‡(h), R‡(h), e‡(h), u‡(h)) denote an optimal solution. It is obvious that (w‡(h), R‡(h))

is an optimal solution of Problem 2. Next, we transform the above problem to Problem 3 by

relaxing the constrains in (18) to the constraints in (16). By contradiction and the monotonicity of

the objective function with respect to (w.r.t.) R in Problem 3, we can show that the constraints in

(16) are active at the optimal solution. Thus, (w‡(h), R‡(h), e‡(h), u‡(h)) is an optimal solution
(cid:4)

of Problem 3. Therefore, we can show Lemma 1.

Based on Lemma 1, solving Problem 2 is equivalent to solving Problem 3. Problem 3 is a

difference of convex functions (DC) programming (one type of nonconvex problems), and a

June 17, 2022

DRAFT

16

KKT point can be obtained by CCCP [20].8 The main idea of CCCP is to solve a sequence

of successively reﬁned approximate convex problems, each of which is obtained by linearizing

the concave part and preserving the remaining convex part in the DC problem. Speciﬁcally,

at the i-th iteration, the approximate convex problem of Problem 3 is given as follows. Let

(w(i)(h), R(i)(h), e(i)(h), u(i)(h)) denote an optimal solution of the following problem.

Problem 4 (Approximation of Problem 3 at Iteration i):

max
w(h),R(h)(cid:23)0,e(h),u(h)

αS

RS,G(h)

XS∈S

XG∈GS

s.t.

(13), (15), (16),

Lk,n,X (wn(h), uk,n,X (h); w(i−1)

n

(h), u(i−1)

k,n,X (h)) ≤ 0, X ⊆ G(k), k ∈ K, n ∈ N ,

(19)

where w(i−1)

n

(h) , (w(i−1)

G,n (h))G∈X ∪(G\G(k)), wn(h) , (wG,n(h))G∈X ∪(G\G(k)), and

Lk,n,X (wn(h), uk,n,X (h); w(i−1)

n

(h), u(i−1)

k,n,X (h)) ,

|hH

k,nwG′ ,n(h)|2 + σ2

XG′∈G\G(k)

|hH

k,nw(i−1)

G,n (h)|2 +

+

G∈X
P

|hH

k,nw(i−1)

G′ ,n (h)|2 + σ2

G′∈G\G(k)
P
u(i−1)
k,n,X (h)

2

uk,n,X (h)

!

w(i−1)H
G,n

2ℜ

−

(

G∈X
P

(cid:16)
(cid:17)
(h)hk,nhH
k,nwG,n(h) +

G′∈G\G(k)
P
u(i−1)
k,n,X (h)

w(i−1)H
G′ ,n

(h)hk,nhH

k,nwG′ ,n(h)

+ 2σ2

)

,

X ⊆ G(k), k ∈ K, n ∈ N .

(20)

[28]. Problem 4 has MN|G| +

Problem 4 is convex and can be solved efﬁciently using standard convex optimization methods
k∈K(2|G(k)| − 1) variables and 1 + (2N +
k∈K(2|G(k)| − 1) constraints. Thus, when an interior point method is applied, the compu-
1)
tational complexity for solving Problem 4 is O(K 3.521.75×2K ) as K → ∞ [28]. The details of
CCCP for obtaining a KKT point of Problem 3 are summarized in Algorithm 1.9 As the number of

S∈S 2K−|S| + 2N

P

P

P

iterations of Algorithm 1 does not scale with the problem size [29], the computational complexity

8CCCP can exploit the partial convexity and usually converges faster to a KKT point than conventional gradient methods.

9In practice, we can run each of Algorithms 1-4 multiple times with randomly selected feasible initial points to obtain multiple

KKT points and choose the KKT point with the best objective value.

June 17, 2022

DRAFT

 
Algorithm 1 Obtaining a KKT Point of Problem 3
1: Initialization: Choose any feasible point of Problem 3 (w(0)(h), R(0)(h), e(0)(h), u(0)(h)) and set i = 0.
2: repeat
3: Obtain an optimal solution (w(i)(h), R(i)(h), e(i)(h), u(i)(h)) of Problem 4 with an interior point method.
4: Set i = i + 1.
5: until

k(w(i)(h), R(i)(h), e(i)(h), u(i)(h))

convergence

criterion

the

(w(i−1)(h), R(i−1)(h), e(i−1)(h), u(i−1)(h))k2 ≤ ǫ is met.

17

−

for Algorithm 1 is the same as that for solving Problem 4, i.e., O(K 3.521.75×2K

) as K → ∞.

Theorem 1 (Convergence of Algorithm 1): As i → ∞,

w(i)(h), R(i)(h), e(i)(h), u(i)(h)

obtained by Algorithm 1 converges to a KKT point of Problem 3 [27].

(cid:0)

(cid:1)

Proof 2: The constraints in (13), (15), (16) are convex, and the constraint function in (17) can

be regarded as a difference between two convex functions, i.e.,
G′∈G\G(k) |hH

k,nwG,n(h)|2+P

PG∈X |hH

(h)|2+σ2

k,nw

,n

′

G

and

PG∈X |hH

uk,n,X (h)
k,nwG,n(h)|2+P

G′∈G\G(k) |hH

k,nw

′

,n

G′∈G\G(k) |hH
k,nwG′ ,n(h)|2 + σ2
. Therefore, Problem 3 is a DC programming.
(h)|2+σ2
(h), u(i−1)

P
at (w(i−1)
n

Linearizing

k,n,X (h)) and preserv-
(h), u(i−1)
k,n,X (h)) in (20).
Thus, Algorithm 1 implements CCCP. It has been validated in [27] that solving DC programming

k,nwG′ ,n(h)|2 + σ2 give Lk,n,X (wn(h), uk,n,X (h); w(i−1)

G′∈G\G(k) |hH

uk,n,X (h)

ing

n

G

P

through CCCP always returns a KKT point. Therefore, we can show Theorem 1.

(cid:4)

This paper focuses mainly on exploiting the full potential of general rate splitting for general

multicast. The computational complexity of Algorithm 1 can be formidable with a large K. We

can use successive decoding to reduce the computational complexity to O(K 1.5|S|1.522K) as in

[20].10 We can also apply rate splitting with a reduced number of layers together with successive

decoding to further reduce the computational complexity to O(K 1.5|S|1.5(|Glb|2 + |Glb||S|K +
|S|2K 2)) as in [20], for some Glb satisfying S ⊆ Glb ⊆ G. Note that |Glb| represents the reduced
number of layers and satisﬁes |S| ≤ |Glb| ≤ 2K − 1.11 Low-complexity optimization methods

are beyond the scope of this paper.

IV. ERGODIC RATE MAXIMIZATION IN FAST FADING SCENARIO

This section considers the fast fading scenario and maximizes the weighted sum ergodic

rate under the total transmission power constraint and achievable ergodic rate constraints. The

proposed solution framework for the fast fading scenario is illustrated in Fig. 4. It is noteworthy

10Note that |S| may not scale with K, and how |S| scales with K relies on the user requests. In the case of |S| = O(1),

the reduced computational complexity is O(K 1.522K ), as K → ∞.

11In the case of |S| = O(1) and |Glb| = O(1), the reduced computational complexity is O(N 3.5K 3.5) as K → ∞.

June 17, 2022

DRAFT

18

Fig. 4. Illustration of the proposed solution framework for the fast fading scenario. “Cor.” and “LC” are short for
“Correlated” and “Low Complexity”, respectively. The interpretations of the remaining short forms can be found
in Fig 3.

that in the fast fading scenario when general multicast degrades to unicast, the proposed solutions

based on general rate splitting outperform the one based on 1-layer rate splitting in [17] due to

the fact that our solution can exploit the full potential of rate splitting and obtain a KKT point.

A. Optimization Problem Formulation

We would like to optimize the transmission beamforming vectors w , (wG,n)G∈G,n∈N and
rates of sub-message units R , (RS,G)S∈S,G∈G to maximize the weighted sum ergodic rate,
S∈S αSRS, subject to the total transmission power constraint in (11) and the achievable ergodic

rate constraints in (12). Therefore, we formulate the following problem.
P

Problem 5 (Weighted Sum Ergodic Rate Maximization):

U (fast)⋆ , max
w,R(cid:23)0

s.t.

αSRS

S∈S
X
(11), (12),

where RS is given by (2).

Remark 4 (Connection with Rate Splitting for Unicast and Multicast): When general multicast

degrades to unicast and general rate splitting reduces to 1-layer rate splitting, Problem 5 can

reduce to the weighted sum ergodic rate maximization problem for unicast in [17]. Besides,

Problem 5 can be regards as a generalization the weighted sum ergodic rate maximization

problem for other service types.

Note that the objective function is linear, the constraint in (11) is convex, and the constraints in

(12) involve expectations and are nonconvex. Thus, Problem 5 is a more challenging nonconvex

June 17, 2022

DRAFT

stochastic problem than the one in the slow fading scenario as it is not separable and has

19

stochastic constraints.

B. KKT Point

In this subsection, we propose a stochastic iterative algorithm to obtain a KKT point of

Problem 5 using SSCA together with the exact penalty method [31]. First, we equivalently

transform Problem 5 to a stochastic optimization problem whose objective function is the

weighted sum of the original objective function and the penalty for violating the nonconvex

constraints with expectations in (12).

Problem 6 (Equivalent Problem of Problem 5):

max
w,R(cid:23)0,s(cid:23)0

s.t.

αS

RS,G − ρ

sX ,k

XG∈GS

k∈K XX ⊆G(k)
X

XS∈S
(11),

RG − B

G∈X

X

e

X

n∈N

E

log2

"

1 +

σ2 +

k,nwG,n|2

G∈X |ϑH
G′∈G\G(k) |ϑH

k,nwG′ ,n|2

≤ sX ,k,

!#

X ⊆ G(k), k ∈ K,

(21)

P
P

where s , (sX ,k)X ⊆G(k),k∈K are slack variables, and ρ > 0 is a penalty parameter that trades off
the original objective function and the slack penalty term.

Next, at iteration i, we choose:

(i)
X ,k,n(w) = (1 − ω(i))F

(i−1)
X ,k,n(w) + ω(i) ˆfX ,k,n(w; w(i−1); h(i)), X ⊆ G(k), k ∈ K, n ∈ N ,

F

with F

(0)

X ,k,n(w) = 0 as a convex surrogate function of E

(cid:19)(cid:21)
in (21), where h(i) is the realization of the random system channel state at iteration i, ω(i) is a

(cid:18)

1 +

PG∈X |ϑH
G′∈G\G(k) |ϑH

k,nwG,n|2
k,nw

|2

′

G

,n

σ2+P

log2
(cid:20)

stepsize satisfying ω(i) > 0,

limt→∞ ω(i) = 0,

∞

i=1 ω(i) = ∞, and

ˆfX ,k,n(w; w(i−1), ; h(i)) , log2 

k,nh(i)H
h(i)

G′∈G\G(k) wH(i−1)

1 +

2ℜ

G′ ,n

+

nP

ln 2(σ2 +

P
G∈X |h(i)H
k,n w(i−1)
G,n |2
k,n w(i−1)
G′∈G\G(k) |h(i)H

σ2 +

P
k,n (wG′ ,n − w(i−1)
P
G′ ,n ) +
G′∈G\G(k) |h(i)H
k,n w(i−1)

G′ ,n |2 +
P

G′ ,n |2 

G∈X wH(i−1)
G∈X |h(i)H

G,n

P

P

June 17, 2022

k,n (wG,n − w(i−1)
G,n )

h(i)
k,nh(i)H
k,n w(i−1)

G,n |2)

o

DRAFT

 
2ℜ

−

G′∈G\G(k) wH(i−1)
ln 2(σ2 +

h(i)
k,nh(i)H
G′∈G\G(k) |h(i)H

k,n (wG′ ,n − w(i−1)
G′ ,n )
k,n w(i−1)
G′ ,n |2)

G′ ,n

nP

20

+ τX ,k,nkw − w(i−1)k2,

o

P

X ⊆ G(k), k ∈ K, n ∈ N (22)

is a convex approximation of E

log2

1 +

σ2+P
τX ,k,n > 0 can be any constant, and the term τX ,k,nkw − w(i−1)k2 is used to ensure strong

(cid:19)(cid:21)

(cid:18)

(cid:20)

|2

,n

G

′

around w(i−1). In (22),

PG∈X |ϑH
G′∈G\G(k) |ϑH

k,nwG,n|2
k,nw

convexity. Then, the approximation convex problem at iteration i is given as follows.

Problem 7 (Approximation of Problem 5 at i-th Iteration):

max
w,R(cid:23)0,s(cid:23)0

s.t.

αS

RS,G + ρ

sX ,k

XG∈GS

k∈K XX ⊆G(k)
X

XS∈S
(11),

RG − B

G∈X

n∈N

(i)
X ,k,n(w) ≤ sX ,k, X ⊆ G(k), k ∈ K.

F

(23)

e
Let (w(i), R(i), s(i)) denote an optimal solution of Problem 7.

X

X

It is noted that Problem 7 is a convex optimization problem which is always feasible (as sX ,k
can be arbitrarily large). We can obtain an optimal solution of Problem 7, (w(i), R(i), s(i)), with
the convex optimization techniques [28]. Given w(i), we then update w(i) according to:

w(i) = (1 − γ(i))w(i−1) + γ(i)w(i),

(24)

where γ(i) is a step size satisfying:

γ(i) > 0,

γ(i) = 0,

lim
t→∞

γ(i) = ∞,

∞

i=1
X

∞

t=1
X

2

γ(i)

< ∞,

γ(i)
ω(i) = 0.

lim
t→∞

(cid:0)

(cid:1)

S∈S 2K−|S| +

The detailed procedure is summarized in Algorithm 2. Note that Problem 7 has MN|G| +
k∈K(2|G(k)| − 1) constraints. Thus, when
an interior point method is applied, the computational complexity for solving Problem 7 is
P
O(K 3.521.75×2K ) as K → ∞ [28]. Note that the number of iterations of Algorithm 2, T , is

k∈K(2|G(k)| − 1) variables and 1 +

P

P

ﬁxed, the computational complexity for Algorithm 2 is the same as that for solving Problem
7, i.e., O(K 3.521.75×2K ) as K → ∞. As discussed in Section III-B, we can apply rate splitting

with a reduced number of layers together with successive decoding to reduce the computational

complexity to O(K 1.5|S|1.5(|Glb|2 + |Glb||S|K + |S|2K 2)) as in [20].

Theorem 2 (Convergence of Algorithm 2): {(w(i), R(i), s(i))} generated by Algorithm 2 has a

June 17, 2022

DRAFT

Algorithm 2 SSCA for Obtaining a KKT Point of Problem 6
1: Initialization: Choose any feasible point w(0) of Problem 7 as the initial point and a sufﬁciently large ρ > 0.
2: for i = 0, 1, . . . , T do
3:

Obtain an optimal solution (w(i), R(i), s(i)) of Problem 7 with an interior point method, and update w(i)

according to (24).

4: end for
5: Output: (w(T ), R(T ), s(T ))

21

limit point, denote by (w†, R†, s†), and the following statements hold. (i) (w†, R†, s†) is a KKT

point of Problem 6; (ii) If s† = 0, then (w†, R†) is a KKT point of Problem 5.

Proof 3: Problem 5 and F

(i)
X ,k,n(w) satisfy Assumption 1 and Assumption 2 in [31], respec-
tively. Additionally, Algorithm 2 implements the stochastic iterative algorithm proposed in [31].

Therefore, by Theorem 2 of [31], we can show that statement (i) and statement (ii) hold.

(cid:4)

We can run Algorithm 2 multiple times, each with a random initial point w(0) and a sufﬁciently

large ρ > 0, until a KKT point (w†, R†, s†) of Problem 6 with s† = 0, i.e., a KKT point (w†, R†)

of Problem 5, is obtained.

C. Low-Complexity Solutions

It is noteworthy that a stochastic iterative algorithm usually converges slowly and has low

computation efﬁciency compared with its deterministic counterpart. Thus, in this subsection, we

propose two low-complexity iterative algorithms to obtain feasible points of Problem 5 with

promising performance for two cases of channel distributions using approximation and CCCP.
k,nwG,n|2
By approximating E
k,nw

in (12) with [30]:

PG∈X |ϑH
G′∈G\G(k) |ϑH

log2

σ2+P

1 +

|2

,n

′

G

(cid:19)(cid:21)

log2

1 +

σ2 +

(cid:20)

(cid:18)
|ϑH
E
G∈X
G′∈G\G(k) E
(cid:2)

P

k,nwG,n|2
|ϑH

k,nwG′ ,n|2
(cid:3)

= log2

1 +

σ2 +

!

G,nQk,nwG,n

G∈X wH
G′∈G\G(k) wH

Qk,nwG′ ,n !

G′ ,n

,

P
P

P
where Qk,n , E

ϑk,nϑH
k,n

(cid:2)
(cid:23) 0 represents the channel covariance matrix for user k and

(cid:3)

subcarrier n, we approximate the stochastic nonconvex problem in Problem 5 with the following

(cid:2)

(cid:3)

deterministic nonconvex problem.

Problem 8 (Approximate Problem of Problem 5 for Obtaining w†):

max
w,R(cid:23)0

αS

RS,G

XS∈S

XG∈GS

s.t.

(11),

June 17, 2022

DRAFT

 
 
22

, X ⊆ G(k), k ∈ K.

(25)

RG ≤ B

log2

1 +

G∈X
X

e

n∈N
X

σ2 +

P
P

G,nQk,nwG,n

G∈X wH
G′∈G\G(k) wH

Qk,nwG′ ,n !

G′ ,n

Let w† denote the beamforming vectors corresponding to a KKT point of Problem 8 (which

may not be feasible for Problem 5 because of the adopted approximation). Then, construct the

following deterministic linear programming parametrized by w†.

Problem 9 (Approximate Problem of Problem 5 for Obtaining R†):

max
R(cid:23)0

αS

RS,G

S∈S
X

G∈GS
X

s.t.

RG ≤ B

XG∈X

e

E

"

n∈N
X

log2

1 +

σ2 +

Let R† denote an optimal solution of Problem 9.

P

P

G∈X |ϑH
k,nw†
G′∈G\G(k) |ϑH

G,n|2
k,nw†

G′ ,n|2 !#

, X ⊆ G(k), k ∈ K.

(26)

Lemma 2 (Feasibility of (w†, R†) for Problem 5): (w†, R†) is a feasible point of Problem 5.

Proof 4: w† satisﬁes the constraint in (11). Besides, (w†, R†) satisﬁes the constraints in (12).
(cid:4)

Thus, (w†, R†) is a feasible point of Problem 5.

As the approximation error is usually small, (w†, R†) can be viewed as an approximate solution

of Problem 5. Based on the numerical calculation of E

log2

1 +

k,nw†
PG∈X |ϑH
G′∈G\G(k) |ϑH

G,n|2
k,nw†

σ2+P

, X ⊆

|2

′

G

,n

(cid:19)(cid:21)

(cid:20)

(cid:18)

S∈S 2K−|S| variables and

G(k), k ∈ K, we can easily solve Problem 9 using standard optimization methods. Problem 9 has
k∈K 2|G(k)| −K constraints. Thus, the computational complexity for
solving Problem 9 using an interior point method is O(K 1.520.75×2K ). Moreover, it is expected
P
that the deterministic nonconvex problem in Problem 8 can be more effectively solved than the

P

stochastic nonconvex problem in Problem 5. In what follows, we concentrate on solving Problem

8 in two cases of channel distributions, namely spatially correlated channel (Qk,n has non-zero

non-diagonal elements, for all k ∈ K, n ∈ N ) and independent and identically distributed (i.i.d.)

channel (Qk,n is a diagonal matrix with identical diagonal elements, for all k ∈ K, n ∈ N ).

1) Spatially correlated channel: In this part, we consider the case of spatially correlated

channel, i.e., Qk,n has non-zero non-diagonal elements, for all k ∈ K, n ∈ N . First, using the

same method as in Section III, Problem 8 can be transformed into the following DC programming

by introducing auxiliary variables and extra constraints.

June 17, 2022

DRAFT

 
 
Problem 10 (Equivalent DC Problem of Problem 8):

max
w,R(cid:23)0,e,u

s.t.

(11),

αS

RS,G

XS∈S

XG∈GS

RS,G ≤

ek,n,X , X ⊆ G(k), k ∈ K,

G∈X
X
ek,n,X
2

S∈S,S⊆G
X

n∈N
X
B ≤ uk,n,X , X ⊆ G(k), k ∈ K, n ∈ N ,

G′∈G\G(k)

wH

G′ ,nQk,nwG′ ,n + σ2 −

P

X

G∈X wH

G,nQk,nwG,n +

G′∈G\G(k) wH
uk,n,X
P
X ⊆ G(k), k ∈ K, n ∈ N ,

G′ ,n

23

(27)

(28)

Qk,nwG′ ,n + σ2

≤ 0,

(29)

where e , (ek,n,X )X ⊆G(k),k∈K,n∈N and u , (uk,n,X )X ⊆G(k),k∈K,n∈N (with a slight abuse of
notation). Let (w⋆, R⋆, e⋆, u⋆) denote an optimal solution of Problem 10.

Lemma 3 (Equivalence Between Problem 8 and Problem 10): (w⋆, R⋆, e⋆, u⋆) satisﬁes 2
k,n,X , X ⊆ G(k), k ∈ K, n ∈ N . Furthermore, Problem 8 and Problem 10 are equivalent.
u⋆
Proof 5: The proof is similar to the one for Lemma 1 and is omitted here.

(cid:4)

e⋆
k,n,X
B =

Note that e and u are auxiliary variables, and (27), (28), and (29) are extra constraints.

Analogously, the approximation convex problem of Problem 10 at iteration i is given below. Let

(w(i), R(i), e(i), u(i)) denote an optimal solution of the following problem.

Problem 11 (Approximation of Problem 10 at Iteration i):

max
w,R(cid:23)0,e,u

αS

RS,G

G∈GS
S∈S
X
X
(11), (27), (28),

s.t.

Qk,n,X (wn, uk,n,X ; w(i−1)

n

, u(i−1)

k,n,X ) ≤ 0, X ⊆ G(k), k ∈ K, n ∈ N ,

(30)

where wn , (wG,n)G∈X ∪(G\G(k)), w(i−1)

n

, (w(i−1)

G,n )G∈X ∪(G\G(k)), and

Qk,n,X (wn, uk,n,X ; w(i−1)

n

, u(i−1)

k,n,X ) ,

wH

G′ ,nQk,nwG′ ,n + σ2

G∈X w(i−1)H

G,n Qk,nw(i−1)

G,n +

(cid:16)P

+

XG′∈G\G(k)
G′∈G\G(k) w(i−1)H
u(i−1)
k,n,X

G′ ,n

2

P

Qk,nw(i−1)

G′ ,n + σ2

uk,n,X

(cid:17)

(cid:16)

(cid:17)

June 17, 2022

DRAFT

24

Algorithm 3 Obtaining a Feasible Point of Problem 5
1: Initialization: Choose any feasible point (w(0), R(0), e(0), u(0)), and set i = 0.
2: repeat
3: Obtain an optimal solution (w(i), R(i), e(i), u(i)) of Problem 11 with an interior point method.
4: Set i = i + 1.
5: until the convergence criterion k(w(i), R(i), e(i), u(i)) − (w(i−1), R(i−1), e(i−1), u(i−1))k2 ≤ ǫ is met.
6: Set w† = w(i).
7: Calculate E

k,n

1 +

, X ⊆ G(k), k ∈ K numerically and obtain an optimal

log2

(cid:20)

(cid:18)

w†
PG∈X |ϑH
G′ ∈G\G(k) |ϑH

G,n|2
w†
G

k,n

σ2+P

|2

′

,n

(cid:19)(cid:21)

solution R† of Problem 9 using standard optimization methods.

2ℜ

−

G∈X w(i−1)H

G,n Qk,nwG,n +

nP

G′∈G\G(k) w(i−1)H
u(i−1)
k,n,X

G′ ,n

P

Qk,nwG′ ,n + σ2

+ 2σ2

o

,

X ⊆ G(k), k ∈ K, n ∈ N .

(31)

mization methods. Problem 11 has MN|G| +

Similarly, Problem 11 is a convex problem and can be solved using standard convex opti-
k∈K(2|G(k)| − 1) variables
S∈S 2K−|S| + 2N
k∈K(2|G(k)| − 1) constraints. Thus, when an interior point method is applied,
) as K → ∞ [28]. The

and 1 + (2N + 1)
the computational complexity for solving Problem 11 is O(K 3.521.75×2K

P

P

P

details for obtaining a feasible point of Problem 5 are summarized in Algorithm 3. Similarly,

as the number of iterations of Algorithm 1 does not scale with the problem size [29], we can
conclude that the computational complexity of Steps 2-5 in Algorithm 3 is O(K 3.521.75×2K
K → ∞. Recall that the computational complexity for solving Problem 9 is O(K 1.520.75×2K
).
Thus, the computational complexity of Algorithm 3 is O(K 3.521.75×2K ) as K → ∞. Similarly,
we can reduce the computational complexity to O(K 1.5|S|1.5(|Glb|2 + |Glb||S|K + |S|2K 2)) as

) as

in [20]. Analogously, we have the following convergence result.

Theorem 3 (Convergence of Algorithm 3): As i → ∞, (w(i), R(i), e(i), u(i)) obtained by Steps

1-5 of Algorithm 3 converges to a KKT point of Problem 10 [27].

Proof 6: The constraints in (11), (27), (28) are convex, and the constraint function in (29) can

PG∈X wH

be regarded as a difference between two convex functions, i.e.,
G′∈G\G(k) wH
uk,n,X
PG∈X wH

G,nQk,nwG,n+P

G,nQk,nwG,n+P

Qk,nw

Qk,nw

and

+σ2

,n

,n

G

G

′

′

′

′

P
+σ2

serving

G′∈G\G(k) wH

Similarly, linearizing

k,n,X ) and pre-
Qk,nwG′ ,n + σ2 give Qk,n,X (wn, uk,n,X ; w(i−1)
k,n,X ) in (31). Thus,
Steps 1-5 of Algorithm 3 implements CCCP. It has been validated in [27] that solving DC
programming through CCCP always returns a KKT point. Therefore, we can show Theorem 3.(cid:4)

at (w(i−1)
n
, u(i−1)

, u(i−1)

G′ ,n

P

,n

,n

n

G

G′∈G\G(k) wH
uk,n,X

G

. Therefore, Problem 10 is a DC programming.

G′∈G\G(k) wH

G′ ,n

Qk,nwG′ ,n + σ2

June 17, 2022

DRAFT

2) I.I.D. channel: In this part, we consider i.i.d. channel, i.e., Qk,n = λIM ×M is a diagonal

matrix with identical diagonal elements, for all k ∈ K, n ∈ N . By changing variables, i.e., letting
tG,n , kwG,nk2

2 ≥ 0, Problem 8 can be equivalently converted into the following problem.

Problem 12 (Equivalent problem of Problem 8 for i.i.d. channel):

25

max
t(cid:23)0,R(cid:23)0

s.t.

XS∈S

αS

RS,G

XG∈GS
tG,n ≤ P,

n∈N
X

XG∈G

RG ≤ B

log2

1 +

XG∈X

e

n∈N
X

(32)

, X ⊆ G(k), k ∈ K,

(33)

λ
σ2 + λ

G∈X tG,n
G′∈G\G(k) tG′ ,n !

P
P

where t , (tG,n)G∈G,n∈N . Let (t⋆, R⋆) denote an optimal solution of Problem 12.

Note that Problem 12 for i.i.d. channel is irrelevant to M, as we intend to optimize the

time-invariant beamforming vectors according to channel statistics in the fast fading scenario.

Problem 10 has MN|G| complex optimization variables for beamforming (i.e., w) whereas

Problem 12 has N|G| real optimization variables for beamforming (i.e., t). Thus, it is expected

that Problem 12 has lower computational complexity than Problem 10. Besides, we have the

following result.

Lemma 4 (Equivalence Between Problem 8 and Problem 12): Any (w⋆, R⋆) with kw⋆

G,nk2

2 =

t⋆
G,n is an optimal solution of Problem 8.

Proof 7: When Qk,n = λI, we can transform log2

1 +

G,nQk,nwG,n

PG∈X wH
G′∈G\G(k) wH

′

G

Qk,nw

′

G

,n

σ2+P

to

,n (cid:19)

(cid:18)

1 +

log2

by letting tG,n , kwG,nk2
2 ≥ 0. Thus, the constraints in (11)
and (25) can be equivalently converted to the constraints in (32) and (33), respectively. Thus,

λ PG∈X tG,n
G′∈G\G(k) t
G

σ2+λ P

(cid:19)

(cid:18)

,n

′

Problem 12 is equal to Problem 8.

(cid:4)

Problem 12 is a DC programming, and we can obtain a KKT point using CCCP. Speciﬁcally,

the approximation convex problem at iteration i is given below.

Problem 13 (Approximation of Problem 12 at Iteration i):

max
t(cid:23)0,R(cid:23)0

αS

RS,G

XS∈S

XG∈GS

s.t.

(32),

RG − B

log2

σ2 +

G∈X
X

e

n∈N
X

(cid:18)

G′∈G\G(k)∪X

X

tG′ ,n

+ B

log2

σ2 +

(cid:19)

n∈N
X

(cid:18)

X

G′∈G\G(k) t(i−1)

G′ ,n

(cid:19)

June 17, 2022

DRAFT

 
26

Algorithm 4 Obtaining a Feasible Point of Problem 5
1: Initialization: Choose any feasible point (t(0), R(0)), and set i = 0.
2: repeat
3: Obtain an optimal solution (t(i), R(i)) of Problem 13 with an interior point method.
4: Set i = i + 1.
5: until the convergence criterion k(t(i), R(i)) − (t(i−1), R(i−1))k2 ≤ ǫ is met.
2 = t(i)
6: Set w† = w(i), where kw(i)
G,n.
w†
PG∈X |ϑH
7: Calculate E
G′ ∈G\G(k) |ϑH

G,nk2

log2

σ2+P

1 +

k,n

k,n

|2

′

G,n|2
w†
G

,n

solution R† of Problem 9 using standard optimization methods.

(cid:20)

(cid:18)

(cid:19)(cid:21)

, X ⊆ G(k), k ∈ K numerically and obtain an optimal

+

B
ln 2

G′∈G\G(k)(tG′,n − t(i−1)
G′ ,n )
G′∈G\G(k) t(i−1)
G′ ,n )

(σ2 +

n∈N P
X

≤ 0, X ⊆ G(k), k ∈ K.

(34)

P

Let (t(i), R(i)) denote an optimal solution of Problem 13, where t(i) , (t(i)

G,n)G∈X ∪(G\G(k)),n∈N .
Problem 13 is a convex problem and can be solved using standard convex optimization
k∈K(2|G(k)| − 1)
constraints. Thus, when an interior point method is applied, the computational complexity
P
for solving Problem 13 is O(K 1.520.75×2K +4K) as K → ∞ [28]. The details for obtaining

methods. Note that Problem 13 has N|G| +

S∈S 2K−|S| variables and 1 +

P

a feasible point of Problem 5 are summarized in Algorithm 4. Similarly, the computational
complexity of Steps 2-5 in Algorithm 4 is O(K 1.520.75×2K +4K) as K → ∞. Noting that
the computational complexity for solving Problem 9 is O(K 1.520.75×2K
), the computational
complexity of Algorithm 4 is O(K 1.520.75×2K +4K) as K → ∞. Similarly, we can reduce the
computational complexity to O(K 1.5|S|1.5(|Glb|2 + |Glb||S| + |S|2)) as in [20]. Analogously, we

have the following convergence result.

Theorem 4 (Convergence of Algorithm 4): As i → ∞, (t(i), R(i)) obtained by Steps 1-5 of

Algorithm 4 converges to a KKT point of Problem 13 [27].

Proof 8: The constraint in (32) is linear and each constraint function of (33),

G∈X

RG −

B

n∈N log2

1 +

σ2+λ P

functions,

P

(cid:18)
G∈X

RG−B

λ PG∈X tG,n
G′∈G\G(k) t
G
n∈N log2

′

,n

(cid:19)
σ2 +

can be regarded as a difference between two convex

P

e

G′∈G\G(k)∪X tG′ ,n

and −B

n∈N log2

σ2 +

Thus, Problem 12 is a DC programming. Linearizing −B

P

P

P

(cid:16)

e
t(i) and preserving

G∈X

RG − B

n∈N log2

σ2 +

(cid:17)
n∈N log2
G′∈G\G(k)∪X tG′ ,n
P

(cid:16)

σ2 +
P

(cid:16)
G′∈G\G(k) tG′ ,n
P
(cid:17)
give the constraints
P

(cid:16)
in (34). Thus, Step 1-5 of Algorithm 4 implements CCCP. It has been validated in [27] that

(cid:17)

P

P

e

P

solving DC programming through CCCP always returns a KKT point. Therefore, we can show

Theorem 4.

June 17, 2022

(cid:4)

DRAFT

G′∈G\G(k) tG′ ,n
at

.

(cid:17)

27

V. COMPARISONS BETWEEN SLOW FADING SCENARIO AND FAST FADING SCENARIO

First, we compare the computational complexities for the weighted sum average rate maxi-

mization in the slow fading scenario and the weighted sum ergodic rate maximization in the fast

fading scenario. Algorithm 1 (for obtaining a KKT point in the slow fading scenario based on

CCCP) has higher computational complexity than Algorithm 2 (for obtaining a KKT point in the

fast fading scenario based on SSCA). However, noting that SSCA converges more slowly than

CCCP in general, Algorithm 2 has longer computational time to achieve satisfactory performance

than Algorithm 1. Besides, Algorithm 3 (for obtaining a low complexity solution in the fast

fading scenario with spatially correlated channel based on CCCP) has the same computational

complexity as Algorithm 1. Last, Algorithm 4 (for obtaining a low complexity solution in the

fast fading scenario with i.i.d. channel based on CCCP) has lower computational complexity

than Algorithm 1.

Next, we compare the practical implementation complexities for the solutions in slow fading

scenario and the fast fading scenario. In the slow fading scenario, the BS must obtain the

instantaneous channel condition and adjust the beamforming vectors at each slot according to

the instantaneous system channel state. By contrast, in the fast fading scenario, the BS requires

only the knowledge of channel statistics and adopts constant beamforming vectors, relying on

channel statistics over slots. Therefore, the practical implementation complexities in the slow

fading scenario are obviously higher than the those in the fast fading scenario.

Finally, we compare the optimal values of the weighted sum average rate maximization in the

slow fading scenario and weighted sum ergodic rate maximization in the fast fading scenario.

As the beamforming vectors in the slow fading scenario are adjusted at each slot according to

the instantaneous system channel state, it is expected that the optimal value in the slow fading

scenario is larger than that in the fast fading scenario. Although the gain in the optimal value

cannot be shown analytical, it will be numerically veriﬁed in Section VI.

VI. NUMERICAL RESULTS

In this section, we numerically evaluate the proposed solutions obtained by Algorithm 1 for

the slow fading scenario, namely Slow-Prop-RS and Algorithm 2, Algorithm 3, and Algorithm 4

for the fast fading scenario, namely Fast-Prop-RS, Fast-Prop-COR-RS, and Fast-Prop-IID-RS,

respectively. In the slow fading scenario, we consider three baseline schemes, namely Slow-1L-

RS, Slow-NOMA, and Slow-OFDMA. Slow-1L-RS and Slow-NOMA (both with joint decoding

June 17, 2022

DRAFT

28

for fair comparison) extend 1-layer rate splitting (where each message is split into one private

part and only one common part) [15] and NOMA [33], both for unicast in one slot, to general

multicast in the considered slow fading scenario. More speciﬁcally, Slow-1L-RS and Slow-

NOMA implement Algorithm 1 to obtain KKT points of Problem 2 with GS = {S, K}, S ∈ S
and with GS = {S}, S ∈ S, respectively.12 Slow-OFDMA adopts OFDMA and considers the

maximum ratio transmission (MRT) on each subcarrier and optimizes the subcarrier and power

allocation [4]. In the fast fading scenario, we consider one baseline scheme, namely Fast-1L-

RS.13 Similarly, Fast-1L-RS (with joint decoding) extends 1-layer rate splitting for unicast in

the fast fading scenario [17] to general multicast in the fast fading scenario. In particular, Fast-

1L-RS implements Algorithm 2 to obtain a KKT point of Problem 5 with GS = {S, K}, S ∈ S.

Note that for the proposed solutions, GS = {X |S ⊆ X ⊆ K}. All algorithms adopt the same

stopping criterion that the change in the objective function between two consecutive iterations is
smaller than 0.1. In the slow fading scenario, we generate 100 random realizations of ϑ, solve

the weighted sum rate maximization problem for each realization, and evaluate the weighted

sum average rate of each scheme over the 100 random realizations. In the sequel, the weighted

sum average rate in the slow fading scenario and the weighted sum ergodic rate in the fast fading

scenario are both termed the weighted sum rate for ease of presentation.

In the simulation, we set K = 3, I = 7, I1 = {1, 4, 5, 7}, I2 = {2, 4, 6, 7}, and I3 = {3, 5, 6, 7}.

As a result, we have P{1} = {1}, P{2} = {2}, P{3} = {3}, P{1,2} = {4}, P{1,3} = {5},
P{2,3} = {6}, and P{1,2,3} = {7}. Additionally, we set αS = 1/7, S ∈ S, B = 30 kHz, N =
72, and σ2 = 10−9 W. We consider two cases of channel distributions, i.e., spatially correlated

channel with the correlation following the one-ring scattering model as in [20] and i.i.d. channel
with ϑk,n ∼ CN (0, IM ×M ), k ∈ K, n ∈ N . Note that the channel covariance matrix in the case
of a spatially correlated channel is normalized for a fair comparison. When applying the one-ring

scattering model, let G denote the number of user groups. We set the same angular spreads for

the G groups and the same azimuth angle for the users in each group as in [20]. Note that

G is related to the channel correlation among users. Speciﬁcally, the correlation increases as G

decreases. When G = 1, users belong to one group and have the same channel covariance matrix.

12Slow-NOMA adopts NOMA with joint decoding, which outperforms the commonly adopted NOMA with successive

decoding [33]. Note that it is challenging to optimize the subsequent decoding order for NOMA in general multicast.

13As existing works on NOMA and OFDMA mainly concentrate on one single slot, we do not consider their extensions to

the fast fading scenario, whose performance can be far from satisfactory.

June 17, 2022

DRAFT

e

t

a
r

m
u
s

d
e

t

i

h
g
e
w

f

o
e
g
a
r
e
v
A

16

14

12

10

8

6

4

2

10

Slow-Prop-RS
Fast-Prop-RS
Fast-Prop-COR-RS
Slow-1L-RS
Fast-1L-RS
Slow-NOMA
Slow-OFDMA

50
20
Number of antennas M

40

30

60

29

e
t
a
r

m
u
s

d
e
t
h
g
e
W

i

16

15

14

13

12

11

10

9

8

7

39

Slow-Prop-RS
Fast-Prop-RS
Fast-Prop-COR-RS
Slow-1L-RS
Fast-1L-RS
Slow-NOMA
Slow-OFDMA

1

2
Number of Groups G

3

e

t

a
r

m
u
s

d
e

t

i

h
g
e
w

f

o
e
g
a
r
e
v
A

18

16

14

12

10

8

6
27

Slow-Prop-RS
Fast-Prop-RS
Fast-Prop-COR-RS
Slow-1L-RS
Fast-1L-RS
Slow-NOMA
Slow-OFDMA

30

33
Transmission power budget P

36

(a) Weighted sum rate versus
M .

(b) Weighted sum rate versus
P .

(c) Weighted sum rate versus
G.

Fig. 5. Weighted sum rate in the case of spatially correlated channel.

e
t
a
R

25

20

15

10

5

0

1

2
Number of groups G

3

e
t
a
R

25

20

15

10

5

0

1

2
Number of groups G

3

e
t
a
R

25

20

15

10

5

0

1

2
Number of groups G

3

(a) Rates of transmission units
of Slow-Prop-RS.

(b) Rates of transmission units
of Fast-Prop-RS.

(c) Rates of transmission units
of Fast-Prop-COR-RS.

Fig. 6. Rates of transmission units of the proposed solutions versus G in the case of spatially correlated channel.

When G = 3, users are in different groups and have different channel covariance matrices.

First, we show the weighted sum rate of each scheme in the case of the spatially correlated

channel. Fig. 5 illustrates the weighted sum rate versus the number of transmit antennas M, the

total transmission power budget P , and the number of user groups G in the one-ring scattering

model, respectively, in the case of the spatially correlated channel. From Fig. 5, we have the

following observations. Firstly, the weighted sum rate of each scheme increases with M, P , and

G. Secondly, in the slow fading and fast fading scenarios, the proposed solutions outperform

the corresponding baseline schemes. The gain of Slow-Prop-RS (Fast-Prop-RS or Fast-Prop-

COR-RS) over Slow-1L-RS (Fast-1L-RS) is because each proposed solution unleashes the full

potential of the ﬂexibility of rate splitting. The gain of Slow-Prop-RS over Slow-NOMA arises

because the cost for Slow-NOMA to suppress interference is high. In contrast, rate splitting

together with joint decoding partially decodes interference and partially treats interference as

noise. The gain of Slow-Prop-RS over Slow-OFDMA comes from an effective nonorthogonal

transmission design. Thirdly, Slow-Prop-RS (Slow-1L-RS) outperforms Fast-Prop-RS (Fast-1L-

RS). The gain arises from the fact that Slow-Prop-RS (Slow-1L-RS) optimizes the beamforming

June 17, 2022

DRAFT

 
 
 
 
 
 
 
 
 
 
e

t

a
r

m
u
s
d
e

t

i

h
g
e
W

16

14

12

10

8

6

4

2

10

Slow-Prop-RS
Fast-Prop-RS
Fast-Prop-COR-RS
Slow-1L-RS
Fast-1L-RS
Slow-NOMA
Slow-OFDMA

50
20
Number of antennas M

30

40

60

e

t

a
r

m
u
s
d
e

t

i

h
g
e
W

18

16

14

12

10

8

6
27

Slow-Prop-RS
Fast-Prop-RS
Fast-Prop-COR-RS
Slow-1L-RS
Fast-1L-RS
Slow-NOMA
Slow-OFDMA

30

33
Transmission power budget P

36

39

30

s
e
t
a
r

s
t
i
n
u

i

i

n
o
s
s
m
s
n
a
r
T

Fig. 7. Weighted sum rate versus M .

Fig. 8. Weighted sum rate versus P .

Fig. 9. Rates of transmission units of
Fast-Prop-IID-RS.

vectors at each slot according to the instantaneous system channel state, whereas Fast-Prop-RS

(Fast-1L-RS) adopts the time-invariant beamforming vectors which are optimized according to

the channel statistics. Additionally, Fig. 5 (c) shows that the gain of Slow-Prop-RS (Fast-Prop-

RS or Fast-Prop-COR-RS) over Slow-1L-RS (Fast-1L-RS) and the gain of Slow-Prop-RS over

Slow-NOMA increase as G decreases, demonstrating the advantage of ﬂexibly dealing with

interference in the presence of channel correlation among users. Fig. 6 shows the rates of the

transmission units in each proposed solution versus the number of user groups G in the case of

the spatially correlated channel. We can see that for each proposed solution,

R{1},

R{2}, and

R{3}

increase with G, whereas

R{1,2},

R{1,3},

R{2,3}, and

R{1,2,3} decrease with G. This is because as

e

e

e

channel correlation among the users decreases, it is efﬁcient to decode less interference and treat

e
more interference as noise.

e

e

e

Next, we show the weighted sum rate of each scheme in the case of the i.i.d. channel. Fig. 7

and Fig. 8 plot the weighted sum rate versus the number of transmit antennas M and the

total transmission power budget P in the case of the i.i.d. channel. We observe from these two

ﬁgures that the weighted sum rate of Fast-Prop-IID-RS does not change with M. This is because

Problem 12 is irrelevant to M. Besides, we have the same observations as from Fig. 5 (a) and

(b). Fig. 9 shows the rates of the transmission units of Fast-Prop-IID-RS in the case of the

i.i.d. channel. We can see from Fig. 9 that

R{1},

R{2}, and

R{3} are identical, and

R{1,2},

R{1,3},

and

R{2,3} are identical. The reasons are as follows. The general multicast setup is symmetric
e

e

e

e

e

w.r.t. all users and their requesting messages, i.i.d. channel is considered, and time-invariant

e

beamforming is adopted in the fast fading scenario.

June 17, 2022

DRAFT

 
 
 
 
 
 
31

VII. CONCLUSION

While applications such as content delivery are responsible for a large and increasing fraction

of Internet trafﬁc, general multicast communication will play a central role for future 6G and

beyond networks. This paper investigated the optimization of general rate splitting for general

multicast. We optimized the transmission beamforming vectors and rates of sub-message units

to maximize the weighted sum average rate and the weighted sum ergodic rate in the slow

fading and fast fading scenarios, respectively. We proposed iterative algorithms to obtain KKT

points and low-complexity solutions in both scenarios using various optimization techniques.

The proposed optimization framework generalizes the existing ones for rate splitting for unicast,

unicast with a common message, single-group multicast, and multi-group multicast. Numerical

results demonstrate notable gains of the proposed solutions over existing schemes and reveal

the impact of channel correlation among users on the performance of general rate splitting for

general multicast.

There are still some key aspects that we leave for future investigations. One direction is

to go beyond linear approaches and investigate nonlinear precoders such as binning [9], [34].

Another interesting perspective is general multicast with partial channel state information at the

transmitter side [20], [35].

REFERENCES

[1] “Virtual reality (VR) market - growth, trends, and forecast (2020 - 2025),” Mordor Intelligence, Jan. 2020. [Online].

Available: https://www.mordorintelligence.com/industry-reports/virtualreality-market/

[2] K. Long, Y. Cui, C. Ye, and Z. Liu “Optimal wireless streaming of multi-quality 360 VR video by exploiting natural, relative

smoothness-enabled and transcoding-enabled multicast opportunities,” IEEE Trans. Multimedia, vol. 23, pp. 3670-3683,

Oct. 2021.

[3] W. Xu, Y. Cui, and Z. Liu, “Optimal multi-view video transmission in multiuser wireless networks by exploiting natural

and view synthesisenabled multicast opportunities,” IEEE Trans. Commun., vol. 68, no. 3, pp. 1494-1507, Mar. 2020.

[4] C. Guo, L. Zhao, Y. Cui, Z. Liu, and D. Ng ”Power-efﬁcient transmission of multi-quality tiled 360 VR video in MIMO-

OFDMA systems,” IEEE Trans. Wireless Commun., vol. 20, no. 8, pp. 5408-5422, Aug. 2021.

[5] W. Xu, Y. Cui, Z. Liu, and H. Li, “Optimal multi-view video transmission in OFDMA systems,” IEEE Commun. Lett.,

vol. 24, no. 3, pp. 667-671, Mar. 2020.

[6] Y. Mao, O. Dizdar, B. Clerckx, R. Schober, P. Popovski, and H. V. Poor, “Rate-splitting multiple access: fundamentals,

survey, and future research trends,” arXiv preprint arXiv:2201.03192, Jan. 2022.

[7] Y. Cui, M. M´edard, E. Yeh, D. Leith, F. Lai, and K. R. Duffy, ”A linear network code construction for general integer

connections based on the constraint satisfaction problem,” IEEE/ACM Trans. Netw., vol. 25, no. 6, pp. 3441-3454, Dec.

2017.

June 17, 2022

DRAFT

32

[8] Y. Cui, M. M´edard, E. Yeh, D. Leith, and K. R. Duffy, “Optimization-based linear network coding for general connections

of continuous ﬂows,” IEEE/ACM Trans. Netw., vol. 26, no. 5, pp. 2033-2047, Oct. 2018.

[9] H. P. Romero and M. K. Varanasi, ”Rate splitting, superposition coding and binning for groupcasting over the broadcast

channel: A general framework,” arXiv preprint arXiv:2011.04745, Nov. 2020.

[10] T. Yoo and A. Goldsmith, “On the optimality of multiantenna broadcast scheduling using zero-forcing beamforming,”

IEEE J. Sel. Areas Commun., vol. 24, no. 3, pp. 528–541, Mar. 2006.

[11] Z. Li, S. Yang, and S. Shamai, “On linearly precoded rate splitting for gaussian MIMO broadcast channels,” IEEE Trans.

Inf. Theory, vol. 67, no. 7, pp. 4693-4709, Jul. 2021.

[12] T. Han and K. Kobayashi, “A new achievable rate region for the interference channel,” IEEE Trans. Inf. Theory, vol. 27,

no. 1, pp. 49-60, Jan. 1981.

[13] S. Yang, M. Kobayashi, D. Gesbert, and X. Yi, “Degrees of freedom of time correlated MISO broadcast channel with

delayed CSIT,” IEEE Trans. Inf. Theory, vol. 59, no. 1, pp. 315-328, Jan. 2013.

[14] J. Park, J. Choi, N. Lee, W. Shin, and H. V. Poor, “Rate-splitting multiple access for downlink MIMO: A generalized

power iteration approach,” arXiv preprint arXiv:2108.06844, Aug. 2021.

[15] H. Joudeh and B. Clerckx, “Robust transmission in downlink multiuser MISO systems: A rate-splitting approach,” IEEE

Trans. Signal Process., vol. 64, no. 23, pp. 6227–6242, Dec. 2016.

[16] Y. Mao, B. Clerckx, J. Zhang, V. O. K. Li, and M. A. Arafah, “Max-min fairness of K-user cooperative rate-splitting in

MISO broadcast channel with user relaying,” IEEE Trans. Wireless Commun., vol. 19, no. 10, pp. 6362-6376, Oct. 2020.

[17] H. Joudeh and B. Clerckx, “Sum-rate maximization for linearly precoded downlink multiuser MISO systems with partial

CSIT: A rate-splitting approach,” IEEE Trans. Commun., vol. 64, no. 11, pp. 4847–4861, Nov. 2016.

[18] Z. Yang, M. Chen, W. Saad, and M. Shikh-Bahaei, “Optimization of rate allocation and power control for rate splitting

multiple access (RSMA),” IEEE Trans. Commun., vol. 69, no. 9, pp. 5988-6002, Sep. 2021.

[19] Y. Mao, B. Clerckx, and V. O. K. Li, “Rate-splitting multiple access for downlink communication systems: Bridging,

generalizing, and outperforming SDMA and NOMA,” EURASIP JWCN, vol. 2018, no. 1, p. 133, May 2018.

[20] Z. Li, C. Ye, Y. Cui, S. Yang, and S. Shamai, “Rate splitting for multi-antenna downlink: Precoder design and practical

implementation,” IEEE J. Select. Areas Commun., vol. 38, no. 8, pp. 1910–1924, Jun. 2020.

[21] Y. Mao, B. Clerckx, and V. O.K. Li, “Rate-splitting for multi-antenna non-orthogonal unicast and multicast transmission:

spectral and energy efﬁciency analysis,” IEEE Trans. Commun., vol. 67, no. 12, pp. 8754-8770, Dec. 2019.

[22] L. Yin, B. Clerckx, and Y. Mao, ”Rate-splitting multiple access for multi-antenna broadcast channels with statistical CSIT,”

in Proc. of IEEE WCNCW, Mar. 2021, pp. 1-6.

[23] H. Joudeh and B. Clerckx, “Rate-splitting for max-min fair multigroup multicast beamforming in overloaded systems,”

IEEE Trans. Wireless Commun., vol. 16, no. 11, pp. 7276-7289, Nov. 2017.

[24] A. Z. Yalcin, M. Yuksel, and B. Clerckx, “Rate splitting for multi-group multicasting with a common message,” IEEE

Trans. Veh. Technol., vol. 69, no. 10, pp. 12281-12285, Oct. 2020.

[25] H. Chen, D. Mi, B. Clerckx, Z. Chu, J. Shi, and P. Xiao, “Joint power and subcarrier allocation optimization for multigroup

multicast systems with rate splitting,” IEEE Trans on Veh. Technol., vol. 69, no. 2, pp. 2306-2310, Feb. 2020.

[26] N. D. Sidiropoulos, T. N. Davidson and Z. Luo, “Transmit beamforming for physical-layer multicasting,” IEEE Trans.

Signal Process., vol. 54, no. 6, pp. 2239-2251, Jun. 2006.

[27] Y. Sun, P. Babu, and D. P. Palomar, “Majorization-minimization algorithms in signal processing, communications, and

machine learning,” IEEE Trans. Signal Process., vol. 65, no. 3, pp. 794–816, Feb. 2017.

[28] S. Boyd and L. Vandenberghe, Convex optimization. Cambridge university press, 2004.

June 17, 2022

DRAFT

33

[29] F. Facchinei, V. Kungurtsev, L. Lampariello, and G. Scutari, “Ghost penalties in nonconvex constrained optimization:

Diminishing stepsizes and iteration complexity,” Math. Oper. Res., vol. 46, no. 2, pp. 595-627, Feb. 2021.

[30] Cover, Thomas M. Elements of information theory. John Wiley & Sons, 1999.

[31] C. Ye and Y. Cui, “Stochastic successive convex approximation for general stochastic optimization problems,” IEEE

Wireless Commun. Lett., vol. 9, no. 6, pp. 755-759, Jun. 2020.

[32] A. Adhikary, J. Nam, J. Y. Ahn, and G. Caire, “Joint spatial division and multiplexing—The large-scale array regime,”

IEEE Trans. Inf. Theory, vol. 59, no. 10, pp. 6441–6463, Oct. 2013.

[33] L. Dai, B. Wang, Y. Yuan, S. Han, I. Chih-lin, and Z. Wang, “Non-orthogonal multiple access for 5G: solutions, challenges,

opportunities, and future research trends,” IEEE Commun. Mag., vol. 53, no. 9, pp. 74-81, Sep. 2015.

[34] R. Tang, S. Xie, and Y. Wu, “On the achievable rate region of the K-receiver broadcast channels via exhaustive message

splitting,” Entropy, vol. 23, no. 11: 1408, Oct. 2021.

[35] Y. Mao and B. Clerckx, “Beyond dirty paper coding for multi-antenna broadcast channel with partial CSIT: A rate-splitting

approach,” IEEE Trans. Commun., vol. 68, no. 11, pp. 6775-6791, Nov. 2020.

[36] A. A. Ahmad, Y. Mao, A. Sezgin, and B. Clerckx, “Rate splitting multiple access in C-RAN: A scalable and robust design,”

IEEE Trans. Commun., vol. 69, no. 9, pp. 5727-5743, Sep. 2021.

June 17, 2022

DRAFT

