Motion Feasibility Conditions for
Multi-Agent Control Systems on Lie Groups

Leonardo J. Colombo and Dimos V. Dimarogonas, Senior Member, IEEE

9
1
0
2

n
u
J

8
1

]

Y
S
.
s
c
[

2
v
2
1
6
4
0
.
8
0
8
1
:
v
i
X
r
a

Abstract—We study the problem of motion feasibility for multi-
agent control systems on Lie groups with collision avoidance
constraints. We ﬁrst consider the problem for kinematic left
invariant control systems and next, for dynamical control systems
given by a left-trivialized Lagrangian function. Solutions of the
kinematic problem give rise to linear combinations of the control
inputs in a linear subspace annihilating the collision avoidance
constraints. In the dynamical problem, motion feasibility condi-
tions are obtained by using techniques from variational calculus
on manifolds, given by a set of equations in a vector space,
and Lagrange multipliers annihilating the constraint force that
prevents deviation of solutions from a constraint submanifold.

Index Terms—Mechanical systems on Lie groups, Collision
avoidance, Multi-agent systems, Variational principles, Left-
invariant control systems.

I. INTRODUCTION

Decentralized control strategies for multiple vehicles have
gained increased attention in the last decades in the control
community [4], [14], [16]. In particular, when the conﬁg-
uration space of the agents is on a Lie group the main
applications involved the coordination and synchronization of
spacecraft motions modeled by kinematic systems [18], [19].
Recently, researchers have shown an inceinterest in employing
decentralized motion planning algorithms for multi-agent sys-
tems based on second-order dynamical models [8], [9]. The
main motivation lies in that acceleration controls are more
implementable in vehicle systems than velocity controls.

In this work we consider a set of agents evolving on a
Lie group subject to collision avoidance constraints. We deter-
mine whether there are non-trivial trajectories in the collision
avoidance problem of all agents that maintain the constraints.
The results are applied to build a collision avoidance motion
planning controller for the coordinated motion of the agents.
We assume that the constraints for the distributed edge set
should be non-conﬂicting, and the overall constraint for all
the edges should be realizable in the full Lie group. The
proposed mathematical framework for multi-agent systems
on Lie groups was recently used in [6] for optimal control

L. J. Colombo (leo.colombo@icmat.es) is with Instituto de Ciencias
Matem´aticas (CSIC-UAM-UCM-UC3M), Calle Nicol´as Cabrera 13-15, Cam-
pus Cantoblanco, 28049, Madrid, Spain. D.V. Dimarogonas (dimos@kth.se) is
with Department of Automatic Control, EECS School, KTH, Royal Institute
of Technology, SE-100 44, Stockholm, Sweden.

The work of Leonardo J. Colombo was also partially supported by ACCESS
Linnaeus Center, KTH, Royal Institute of Technology, Sweden; Ministerio
de Econom´ıa, Industria y Competitividad (MINEICO, Spain) under grant
MTM2016-76702-P, Juan de la Cierva Incorporaci´on fellowship and I-Link
Project linkA20079. The project that gave rise to these results received the
support of a fellowship from ”la Caixa” Foundation (ID 100010434). The
fellowship code is LCF/BQ/PI19/11690016.

The work of Dimos V. Dimarogonas is supported by the Swedish Research
Council (VR), Knut och Alice Wallenberg foundation (KAW), the H2020
Project Co4Robots and the H2020 ERC Starting Grant BUCOPHSYS.

problems. We also build on the works [21], [20] by studying
the problem of motion feasibility when agents evolves on Lie
group manifolds.

The motion feasibility problem is studied in two differ-
ent scenarios: when agents are described by kinematic left-
invariant fully actuated control systems and when the agents
are described by dynamical fully actuated control systems.
While the kinematic approach has been studied more in the
literature for the motion feasibility problem (single integrator
dynamics), the main motivation for the second approach lies in
the fact that acceleration control (double integrator dynamics)
is more suitable under the real world requirements of sensors
for multiple vehicles, than velocity controls. It also provides a
ﬁrst step towards the construction of distance-based numerical
estimators via Lie groups variational
integrators [7]. The
solution in the second approach is given by using techniques
of calculus of variations on manifolds and the Lagrange
multiplier theorem, while for the ﬁrst one, we use techniques
of differential calculus on manifolds.

The main contribution of this work consists on provid-
ing a set of necessary conditions for non-trivial collision-
free motions in multi-agent control systems where agents
evolves on a Lie group manifold. The main results of this
work are given in Theorem 5.1 and Theorem 6.1. Theorem
5.1 describes differential-algebraic conditions for the feasible
motion, when the agents are given by kinematic left-invariant
control systems, by ﬁnding the set of admissible velocities
leaving the constraints invariant at a given point on a Lie group
G and describing it as a linear system of algebraic equations
with the control inputs as unknown variables. Theorem 6.1,
provides ﬁrst-order necessary conditions for feasible motion
when the dynamics of each agent is described by a Lagrangian
function on G × g through the constrained Euler-Lagrange
equations, with g being the Lie algebra associated with G.
Such a condition is given by a set of ﬁrst order differential
equations on g.

The paper is structured as follows. Section II provides
the nomenclature. Section III introduces Lie groups actions,
constrained Euler-Lagrange equations and trivializations of the
tangent bundle of a Lie group. Section IV describes left-
invariant kinematic multi-agent control systems, dynamical
multi-agent control systems and the formulation for the motion
feasibility problem. In Section V we consider a differential-
algebraic approach for the motion feasibility problem of
kinematic left-invariant multi-agent systems. In Section VI
we derive ﬁrst-order necessary conditions for feasible motion
through constrained Euler-Lagrange equations arising from a
variational point of view. Section VII studies the applicability
of the conditions found in Sections V and VI for the collision
avoidance problem of three rigid bodies on SE(3) modelling

 
 
 
 
 
 
fully-actuated underwater vehicles.

II. NOMENCLATURE

We begin by establishing the nomenclature used throughout
this paper. The basic notation and methodology is fairly
standard within the differential geometry literature and we
have attempted to use traditional symbols and deﬁnitions
wherever feasible. Table I provides the symbols will be used
frequently along the paper.

Symbol
Q
T Q
T ∗Q
G
g
g∗
n
r
p
T
m
λk
ij : G × G → R
φk
λT G
λT ∗G
g, h
ξ
µ
e
Lg : G → G
ThLg
T ∗
h Lg
Ad : G × g → g
Ad∗ : G × g∗ → g∗
ad : g × g → g
ad∗ : g × g∗ → g∗

TABLE I
NOMENCLATURE

Description
Differentiable manifold
Tangent bundle of Q
Cotangent bundle of Q
Lie group
Lie algebra of G
Dual of the Lie algebra g
Dimension of G
Number of agents
Number of edges in the communication graph
Transpose of a Matrix
Quantity of collision avoidance constraints
Lagrange multiplier
Collision avoidance constraints
Left-trivialization of T G
Left-trivialization of T ∗G
Elements on G
Element on g
Element of g∗
Identity element of G
Left-translation Lgh = gh
tangent map of Lg at h ∈ G
the cotangent map of Lg at h ∈ G
Adjoint action
co-Adjoint action
Adjoint operator
co-Adjoint operator

III. PRELIMINARIES

A. Differential calculus on manifolds

Let Q be a differentiable manifold with dim(Q) = n. Given
a tangent vector vq ∈ TqQ, q = (q1, . . . , qn) ∈ Q, and f ∈
C∞(Q), the set of real valued smooth functions on Q, df · vq
denotes how tangent vectors acts on functions on C∞(Q). df
denotes the differential of the function f ∈ C∞(Q) deﬁned as

df (q) · vq =

n
(cid:88)

i=1

∂f
∂qi · vi
q.

Just as a vector ﬁeld is a “ﬁeld” for tangent vectors, a
differential 1-form is a “ﬁeld” of cotangent vectors, one for
every base point. A cotangent vector based at q ∈ Q, is a
linear map from TqQ to R, and the set of all maps is the
cotangent space T ∗
q Q, which is the dual to the tangent space
TqQ. A 1-form on Q is a map Θ : Q → T ∗Q such that
Θ(q) ∈ T ∗Q for every q ∈ Q. Differential one forms, can be
added together and multiplied by scalar ﬁelds c : Q → R as
(Θ + Θ)(q) = Θ(q) + Θ(q), and (cΘ)(q) = c(q)Θ(q).

map Tqf : TqQ → Tf (q)Q1 satisfying Tqf (vq) · φ = vq · d(φ ◦
f ) for all φ ∈ C∞(Q1) and vq ∈ TqQ. The pullback of f at
q ∈ Q is the dual map T ∗

q Q satisfying

f (q)Q1 → T ∗

q f : T ∗

(cid:104)T ∗

q f (pq), vq(cid:105)∗ = (cid:104)pq, Tqf (vq)(cid:105)∗

(1)

for all vq ∈ TqQ and pq ∈ T ∗
tangent covectors acts on tangent vectors.

f (q)Q1, where (cid:104)·, ·(cid:105)∗ denotes how

Deﬁnition 3.1: Let Q and N be differentiable manifolds
and f : Q → N be a differentiable map between them. The
map f is a submersion at a point q ∈ Q if its differential
df (q) : TqQ → Tf (q)N is a surjective map.

Deﬁnition 3.2: Let U ⊂ Q be an open set, f : U → N be
smooth. If f is a submersion at all points in U then for all
y ∈ N , f −1(y) ⊂ U is a submanifold of Q. The value y ∈ N
is said to be a regular value of f .

Theorem 3.1: [[13], Section 8.3, pp. 219] Let Q be a
differentiable manifold and 0 ∈ Rm a regular value of
Φ : Q → Rm. Given a function S : Q → R, by deﬁning
the function S : Q × Rm → R as

S(q, λ) = S(q) − (cid:104)(cid:104)λ, Φ(q)(cid:105)(cid:105),

for some inner product (cid:104)(cid:104)·, ·(cid:105)(cid:105) on Rm, the Lagrange multiplier
theorem states that q ∈ Φ−1(0) is an extrema of S |Φ−1(0) if
and only if (q, λ) ∈ Q × Rm is an extrema of S.

B. Lie group actions

Deﬁnition 3.3: Let G be a Lie group with the identity
element ¯e ∈ G. A left-action of G on a manifold Q is a
smooth mapping Φ : G × Q → Q such that Φ(e, q) = q for
all q ∈ Q, Φ(g, Φ(h, q)) = Φ(gh, q) for all g, h ∈ G, q ∈ Q
and for every g ∈ G, the map Φg : Q → Q deﬁned by
Φg(q) := Φ(g, q) is a diffeomorphism.

Let G be a ﬁnite dimensional Lie group. The tangent bundle
at a point g ∈ G is denoted as TgG and the cotangent bundle
at a point h ∈ G is denoted as T ∗
h Q. g will denote the Lie
algebra associated to G deﬁned as g := TeG, the tangent space
at the identity e ∈ G. Given that the Lie algebra g is a vector
space, one may consider its dual space. Such dual of the Lie
algebra is denoted by g∗.

Let Lg : G → G be the left translation of the element g ∈ G
given by Lg(h) = gh for h ∈ G. Lg is a diffeomorphism on
G and a left-action from G to G. Their tangent map (i.e, the
linearization or tangent lift of left translations) is denoted by
ThLg : ThG → TghG. Similarly, the cotangent map (cotangent
lift of left translations) is denoted by T ∗
ghG.
It is known that the tangent and cotangent lift are actions (see
[10], Chapter 6).

h G → T ∗

h Lg : T ∗

Consider the vector bundles isomorphisms λT G : G × g →

T G and λT ∗G : G × g∗ → T ∗G deﬁned as

λT G(g, ξ) = (g, TeLg(ξ)), λT ∗G(g, µ) = (g, T ∗

g Lg−1(µ)).

(2)
λT G and λT ∗G are called left-trivializations of T G and T ∗G
respectively. Therefore, the left-trivialization λT G permits to
identify tangent bundle T G with G × g, and by λT ∗G, the
cotangent bundle T ∗G can be identiﬁed with G × g∗.

Given a differentiable function f : Q → Q1 with Q1 a
smooth manifold, the pushforward of f at q ∈ Q is the linear

Deﬁnition 3.4 ([10], Section 2.3 pp.72): The natural pairing
between vectors and co-vectors (cid:104)·, ·(cid:105) : g∗ × g → R is deﬁned

by (cid:104)α, β(cid:105) := α·β for α ∈ g∗ and β ∈ g where α is understood
as a row vector and β a column vector. For matrix Lie algebras
(cid:104)α, β(cid:105) = αT β.

Using the pairing between vectors and co-vectors, one can
write the relation between the tangent and cotangent lifts as

(cid:104)α, ThLg(β)(cid:105) = (cid:104)T ∗

h Lg(α), β(cid:105)

(3)

for g, h ∈ G, α ∈ g∗ and β ∈ g.

Let Φg : Q → Q for any g ∈ G a left action on G; a
function f : Q → R is said to be invariant under the action
Φg, if f ◦ Φg = f , for any g ∈ G. The Adjoint action, denoted
Adg : g → g is deﬁned by Adgχ := gχg−1 where χ ∈ g.
Note that this action represents a change of basis on g

The co-adjoint operator ad∗ : g × g∗ → g∗, (ξ, µ) (cid:55)→ ad∗

ξµ
is deﬁned by (cid:104)ad∗
ξµ, η(cid:105) = (cid:104)µ, adξη(cid:105) for all η ∈ g with ad :
g × g → g the adjoint operator given by adξη := [ξ, η] where
[·, ·] denotes the Lie bracket of vector ﬁelds on g.

The co-Adjoint action Ad∗
: g∗ → g∗ is given by
g−1
(cid:104)Ad∗
g−1 µ, ξ(cid:105) = (cid:104)µ, Adg−1ξ(cid:105) with µ ∈ g∗, ξ ∈ g. Note that
Ad and Ad∗ are actions on Lie groups, while ad and ad∗ are
operators on the Lie algebra and its dual, respectively.

Example 3.5: The co-Adjoint action of SO(3) on so(3)∗,
Ad∗ : SO(3) × so(3)∗ → so(3)∗ is given by (see [10], Ch.
R−1 ˘η = (Rη)˘, and identifying so(3)∗ with R3,
6, pp. 224) Ad∗
R−1 η = Rη with η ∈ R3, ˘η ∈ so(3)∗ and
it is given by Ad∗
(cid:5).
R ∈ SO(3).
Let L : T G → R be a Lagrangian function describing the
dynamics of a mechanical system. After a left-trivialization of
T G we may consider the trivialized Lagrangian L : G×g → R
given by L(g, ξ) = L(g, TgLg−1( ˙g)) = L(g, g−1 ˙g).

A. Left-invariant dynamical multi-agent control systems

(cid:124)

Consider a set N consisting of r free agents evolving each
one on a Lie group G with dimension n. Along this work we
assume that the conﬁguration space of each agent has the same
Lie group structure. Same conﬁguration does not mean the
same agent. For instance, each agent can have different masses
and inertia values, and therefore agents are heterogeneous. We
denote by gi ∈ G the conﬁguration (positions) of an agent
i ∈ N and gi(t) ∈ G describes the evolution of agent i at
time t. The element g ∈ Gr denotes the stacked vector of
positions where Gr := G × . . . × G
represents the cartesian
(cid:125)

(cid:123)(cid:122)
r−times
product of r copies of G. We also consider gr := TeGr the Lie
algebra associated with the Lie group G for the agent i ∈ N
where e = (e1, . . . , er) is the neutral element of Gr with ej
the neutral element of the jth-Lie group which determines Gr.
The neighbor relationships are described by an undirected
static and connected graph G = (N , E) where the set E ⊂ N ×
N denotes the set of ordered edges for the graph. The set of
neighbors for agent i is deﬁned by Ni = {j ∈ N : (i, j) ∈ E}.
The dynamics of each agent i ∈ N is determined by a
Lagrangian function Li : T G → R together with collision
avoidance (holonomic) constraints. Each tangent space T G
can be left-trivialized and therefore, instead of working with
Li : T G → R we shall consider (cid:96)i : G × g → R. Note also
that the left-trivialization is not an extra assumption, we can
always identify T G with G × g by using the isomorphism (2).
Each agent i ∈ N is assumed to be a fully-actuated dynam-
ical Lagrangian control system associated with the Lagrangian
(cid:96)i : G × g → R, that is,

The left-trivialized Euler–Lagrange equations on G×g (see,
e.g., [10], Ch. 7), are given by the system of n ﬁrst order ode’s
(cid:18) ∂L
∂g

= ad∗
ξ

∂L
∂ξ

∂L
∂ξ

+ T ∗

d
dt

e Lg

(4)

(cid:19)

together with the kinematic equation ˙g = TeLgξ, i.e., ˙g = gξ.
The left-trivialized Euler-Lagrange equations together with
the equation ξ = TgLg−1( ˙g) are equivalent to the Euler–
Lagrange equations for L. Note that for a matrix Lie group,
the previous equations means ξ = g−1 ˙g.

If L does not depend on g ∈ G (for instance, as the
Lagrangian for Euler’s equations on the Lie group SO(3)),
equations (4) reduce to the Euler-Poincar´e equations

d
dt

∂L
∂ξ

= ad∗
ξ

∂L
∂ξ

(5)

together with the kinematic equation ˙g = TeLgξ, i.e., ˙g = gξ.

IV. MULTI-AGENT CONTROL SYSTEM ON LIE GROUPS

In this section we introduce multi-agent control systems
where the conﬁguration space of each agent is a Lie group. It
is described by an undirected static and connected graph. First,
we introduce the motion feasibility problem of agents where
each node of the graph is given by a dynamical control system
(i.e., by the controlled trivialized Euler-Lagrange equations)
governed by a Lagrangian function, and next, we consider
that each node is given by a left-invariant control system.

(cid:19)

(cid:18) ∂(cid:96)i
∂gi

ξi

ei

Lgi

d
dt

∂(cid:96)i
∂ξi + T ∗

∂(cid:96)i
∂ξi − ad∗
where for each i,
inputs ui =
in Rn and where gi(·) ∈
i ]T
[u1
C 1([ai, bi], G) with ai, bi ∈ R+, and where [ai, bi] is an
arbitrary interval of R.

the n-tuple of control

take values

i . . . un

= ui,

i ∈ N

(6)

We also assume that each agent i ∈ N occupies a disk of
radius r on G. The quantity r is chosen to be small enough so
that it is possible to pack r disks of radius r on G. We say that
agents i and j avoid mutual collision if d(πi(g), πj(g)) > ¯r
where πi : Gr → G is the canonical projection from Gr over
its ith-factor and d is an appropriated distance function on the
Lie group G.

Consider the set C given by the (holonomic or position-
based) constraints indexed by the edges set CE = {e1, . . . , ep}
with p = |E|, the cardinality of the set of edges. Each eα ∈ CE
for α = 1, . . . , p is a set of constraints for the edge eα =
ij, . . . , φkα
(i, j) ∈ E, that is, eα = {φ1
ij }, being kα the number
of constraints on the edge eα. Let m be the total number of
constraints in the set N , that is,

m =

p
(cid:88)

α=1

kα.

(7)

For each edge eα, φk
ij is a function on G×G deﬁning an inter-
agent collision avoidance constraint between agents i and j for

all k = 1, . . . , kα . The constraint is enforced if and only if
φk
ij(gi, gj) = 0.
The constraints on edge eα, induce the constraints Φk

ij :
Gr → R as Φk
ij(πi(g), πj(g)). If the map Φ : Gr →
Rm is a submersion at any point of its domain, then M =
Φ−1(0) is an (rn − m)-dimensional submanifold of Gr. Its
2(rn − m)-dimensional tangent bundle is given by

ij(g) = φk

T M = {(g, ˙g) ∈ TgGr | Φ(g) = 0, DΦ(g) · ˙g = 0} ⊂ T Gr
(8)
where DΦ(g) denotes the (n × m) Jacobian matrix of the
contraints.

Denote gr := g × . . . × g
, where the Lie algebra structure
(cid:125)

(cid:124)
of gr is given by [ξ1, ξ2] = ([ξ1
ξ1 = (ξ1

1, ξ1
1) ∈ gr and ξ2 = (ξ1

(cid:123)(cid:122)
r−times

1, . . . , ξr
We also denote τi

2], . . . , [ξr
2, . . . , ξr
: gr → g and βi

: T Gr → T G
the corresponding canonical projections over its ith-factors.
Note that, after a left-trivialization, T M can be seen as a
submanifold of Gr × gr given by

1, ξr
2) ∈ gr.

2]) ∈ gr with

M = {(g, ξ) ∈ Gr×gr | Φ(g) = 0, (cid:104)T ∗

¯e Lg−1 (DΦ(g)), ξ(cid:105) = 0}

where ξ = g−1 ˙g ∈ gr.

The control policy for the motion feasibility problem for
multi-agent systems can be determined by solving the corre-
sponding dynamics (trivialized Euler-Lagrange equations (4))
for each i ∈ N subject to the constraint for each edge, as a
unique system of differential equations, by lifting the dynamics
of each vertex to Gr × gr, the constraints to Gr, and to study
the dynamics for the formation problem as a holonomically
constrained Lagrangian system on Gr × gr.

B. Left-invariant kinematic multi-agent control systems

Let X : Gr → T Gr be a vector ﬁeld on Gr. The set X(Gr)
denotes the set of all vector ﬁelds on Gr. The tangent map
TeLg shifts vectors based at e to vectors based at g ∈ Gr. By
doing this operation for every g ∈ Gr we deﬁne a vector ﬁeld
as X g

ξ := TeLg(ξ) for ξ := X(e) ∈ TeGr.

Deﬁnition 4.1: A vector ﬁeld X ∈ X(Gr) is called left-
invariant if ThLg(X(h)) = X(Lg(h)) = X(gh) ∀ g, h ∈ Gr.
In particular for h = e, Deﬁnition 4.1 means that a vector
ﬁeld X is left-invariant if ˙g = X(g) = TeLgξ for ξ = X(e) ∈
gr. Note that if X is a left invariant vector ﬁeld, then ξ =
X(e) = TgLg−1 ˙g.

Consider an undirected static and connected graph G =
(N , E, C), describing the kinematics of each agent given by
r left invariant kinematic control systems each one on G,
together with the constraints deﬁning the set C. As before, N
denotes the set of vertices of the graph, but now, each i ∈ N
is a fully-actuated left invariant kinematic control system, that
is, the kinematics of each agent is determined by

˙gi = TeiLgi(ξi),

gi(0) = gi
0,

(9)

and the set E ⊂ N ×N denotes, as before, the set of edges for
the graph, where gi(·) ∈ C 1([ai, bi], G), ai, bi ∈ R+ is ﬁxed
and ξi is a curve on the Lie algebra g of G. Alternatively,
the left-invariant control system (9) can be written as ξi(t) =

n
(cid:88)

i

TgiLg−1
˙gi. Each curve ξi(t) on the Lie algebra determines a
control input ui(t), where for each i, the n-tuple of control
i ]T takes values in Rn.
inputs ui = [u1
If for each agent, g = span{e1, . . . , en}, then ui satisﬁes

i . . . un

ξi(t) =

us
i (t)es and therefore (9) is given by the drift-free

s=1

kinematic left invariant control system

˙gi = gi

n
(cid:88)

s=1

us
i (t)es.

(10)

Note that we have not made any reference to coordinates on
Gr. We only require a basis for gr. This is all that is necessary
to study left-invariant kinematic systems.

V. A DIFFERENTIAL-ALGEBRAIC APPROACH TO
CHARACTERIZE MOTION FEASIBILITY OF LIMS

In this section, inspired by [21], we consider a differential-
algebraic approach for the motion feasibility problem for for-
mation control of kinematic left-invariant multi-agent systems
(LIMS’s) introduced in Section IV-B.

Given the collision avoidance constraint Φ : Gr → R,
consider the new constraint dΦ : T Gr → R and consider
the corresponding projection into the G × G denoted by
Φij : G × G → R.

Deﬁnition 5.1: The constraint dΦij(g) is said to be left
invariant if T ∗
e Lg−1 dΦij(g) = dΦij(¯e), that is, the pullback
to the identity of the constraint corresponds to the constraint
at the identity.

Note that dΦij ∈ T Gr and dΦij evaluated at a point g ∈

Gr, i.e., dΦij(g), is a one form on Gr.

When the constraint is left-invariant, there exists a left-
invariant distribution of feasible velocities for the formation
given by the annhilator of the constraints at each point, and it
determines a subgroup of Gr. In other words, Φ−1(0) ⊂ Gr is
a subgroup of Gr and classical reduction by symmetries [10],
[13] can be performed in the multi-agent system to obtain an
unconstrained reduced problem on S = Gr/Φ−1(0). Given
that the collision avoidance constraints in general are deﬁned
by the distances among conﬁgurations of the agents, we are
mainly interested in constraints depending explicitly on the
variables on Gr.

The co-Adjoint action on each Lie group G induces a co-
g−1 : (g∗)r → (g∗)r, and
g−1µ, ξ(cid:105) = (cid:104)µ, Adg−1ξ(cid:105) with µ ∈ (g∗)r, ξ ∈ gr
1 , . . . , g−1

Adjoint action on Gr, denoted as Ad∗
given by (cid:104)Ad∗
and g−1 = (g−1

r ) the inverse element of g ∈ Gr.

To give a necessary condition for the existence of feasible
motion in the formation problem for kinematic LIMS’s, we
want to ﬁnd the set of velocities satisfying the kinematics and
the constraints, that is, the set of admissible velocities leaving
the constraints invariant at a given point on Gr.

Theorem 5.1: The set of admissible velocities allowing
feasible motion in the formation problem is given by the set
of elements ξ ∈ g such that for a ﬁxed g ∈ Gr,

(cid:104)Ad∗

g−1(T ∗

e Lg−1(dΦij(g))), ξ(cid:105) = 0.

Proof: The interaction between agents in the formation,
given by the formation constraints on G × G induces the con-
straint on Gr, Φij(g) = φij(πi(g), πj(g)). Motion feasibility

requires that the constraints holds along the trajectories of the
LIMS (10).

Differentiating the constraint Φij(g) on Gr we get

the
is, (cid:104)dΦij(g), ˙g(cid:105) = 0, where
constraint
˙g = [ ˙g1, . . . , ˙gr]T with ˙gi ∈ T(πi(g))G and dΦij(g) is a one-
form on Gr, dΦij(g) ∈ T ∗

˙g ∈ TgGr,

that

g Gr.

The one-forms dΦij(g) ∈ T ∗

g Gr can be translated
back to (g∗)r using left
translations as (cid:104)dΦij(g), ˙g(cid:105) =
e Lg−1 (dΦij(g)), ξ(cid:105), where ξ = g−1 ˙g ∈ gr
(cid:104)T ∗
and
e Lg−1 (dΦij(g)) ∈ (g∗)r are the Lie algebra evaluated con-
T ∗
straints, and where we used that T (Lg ◦Lg−1) = T Lg ◦T Lg−1
is equal to the identity map on T Gr and equation (3).
Note that our problem not only involves

that
satisfy the constraints, which means

so-
lutions must
that
(cid:104)T ∗
e Lg−1 (dΦij(g)), ξ(cid:105) = 0 for g ∈ Gr, g (cid:54)= e. Solutions
must also be left invariant vector ﬁelds, solving (10), that is,
X(g) = gX(e) (see Deﬁnition 4.1). To solve the combined
problem we proceed as in [2] (Section 4), to unify the solution
in a unique algebraic condition. In order to ﬁnd the left-
invariant vector ﬁelds X(g) satisfying the constraints, we must
study how much the vector ﬁelds X(g) ∈ TgGr changes from
ξ = X(e) ∈ gr. As a transformation connecting g and the
identity e in Gr we use the Adjoint operator, this means that
we have to ﬁnd ξ ∈ gr such that for a ﬁxed g ∈ Gr

(cid:104)T ∗

e Lg−1(dΦij(g)), Adg−1ξ(cid:105) = 0.

(11)

The operator Adg−1 represents a change of basis on gr
and equation (11) gives the subspace of gr annihilated by
T ∗
e Lg−1 (dΦij(g)). Therefore the problem consists on ﬁnding
ξ ∈ gr such that for a ﬁxed g ∈ Gr,

(cid:104)Ad∗

g−1 (T ∗

e Lg−1 (dΦij(g))), ξ(cid:105) = 0.

(12)

Remark 5.2: As pointed out in [2], equation (12) gives

n
(cid:88)

uiei

a linear system of algebraic equations with ξ =

i=1

g−1 (T ∗

as unknown variables and Ad∗
e Lg−1(dΦij(g))) as the
known coefﬁcients. Thus, solutions of the latter equation give
rise to linear combinations of the control inputs in the linear
subspace of g annihilating the constraints.This means that in
order for the solution not leave the submanifold which deﬁnes
the constraints, the set of velocities must satisfy equations (12)
Remark 5.3: Note that the one-forms dΦij(g) are not left-
invariant and may change at any point g ∈ Gr, but by using
the co-adjoint action, we can study vector ﬁelds at any point
g ∈ Gr. Therefore, the problem of ﬁnding the orthogonal
subspace of the constraints at points of Gr given in [21], to
characterize the physical allowable directions of motion, in the
context of LIMS’s, is equivalent to ﬁnding the annihilator of
the co-adjoint action for T ∗

e Lg−1(dΦij(g)).

Remark 5.4: Following [21] (Section III-B), when more than
one solutions exist, the solution space can be exploited to ﬁnd a
new distribution which is called in [21] a group abstraction of
the kinematic LIMS (10), that is, a new control system keeping
the formation along solutions. This new control system is given
by studying the kernel of the co-distribution deﬁned by the
union of a basis of dΦ and a basis for the co-distribution
describing the kinematics of the agents.

For LIMS’s, the space of solutions O ⊂ gr is determined

by equation (12), that is,
O := {ξ ∈ gr|(cid:104)Ad∗

g−1 (T ∗

e Lg−1 (dΦij(g))), ξ(cid:105) = 0}

for a ﬁxed g ∈ Gr. As in [21], one may use O to ﬁnd an
abstraction for LIMS. The new control system is given by the
Kernel of O, that is,
GO := {η ∈ O|(cid:104)Ad∗

e Lg−1(dΦij(g))), η(cid:105) = 0} = Ker(O)

g−1(T ∗

giving rise to a group abstraction that describes the set of
admissible velocities keeping the formation of the LIMS.

By considering a basis of GO, denoted {K1, . . . , Ks}, we
can write such a group abstraction as the left-invariant control
system (note that Ker(O) does not depend on G and therefore
its basis is given by left-invariant elements)

s
(cid:88)

˙g =

Kkωk

(13)

k=1
where ωk are the new control inputs that activate the elements
of the base {K1, . . . , Ks} with s ≤ dim(GO). The abstracted
control system (13) provides certain insights on different types
of feasible motions for the agent according to different choices
of ωk for k = 1, . . . , s.
As pointed out
g−1(T ∗

in [21], since for all k = 1, . . . , s,
(cid:104)Ad∗
e Lg−1(dΦij(g))), Kk(cid:105) = 0, all inputs ωk gives rise
to trajectories g(t) satisfying the left invariant multi-agent
control system (9) and the formation constraints Φij(g).

Example 5.5: As an application we consider the motion
feasibility problem for three agents moving in the plane. The
conﬁguration of each agent at any given time is determined
by the element gi ∈ SE(2) ∼= R2 ×SO(2), i = 1, 2, 3 given by

 , where pi = (xi, yi) ∈ R2.

gi =





cos θi − sin θi
cos θi
sin θi
0
0

xi
yi
1

˙pi = Riui,

i = 1, 2, 3, with ui = (u1

The kinematic equations for the multi-agent system are
i , u2
i )
(14)

˙Ri = Riui,
(cid:18) cos θi − sin θi
cos θi
The Lie algebra se(2) of SE(2) is determined by
: A ∈ so(2) and b ∈ R2(cid:111)

∈ SO(2).

se(2) =

sin θi

(15)

(cid:19)

(cid:19)

where Ri =

(cid:110) (cid:18) A b
0
0

where A = −aJ, a ∈ R, with J =
and we
identify the Lie algebra se(2) with R3 via the isomorphism
(cid:18) −aJ
0

(cid:55)→ (a, b).

b
0

(cid:19)

(cid:18) 0
−1

(cid:19)

1
0

Equations (14) gives rise to a left-invariant control system
on (SE(2))3 with the form ˙gi = gi(ei
i ) describing
all directions of allowable motion, where the elements of the
basis of g = se(2) are

i + ei

2u2

1u1

0
0
0

, ei

ei
1 =

(cid:34)0
0
0

(cid:34)0 −1
0
1
0
0
3] = ei
[ei
which satisfy [ei
1, ei
2.
Using the dual pairing, where (cid:104)αi, ξi(cid:105) := tr(αiξi), for any

(cid:35)
1
0
0
3, ei

0
0
0
1, ei

2] = 03×3,

2] = ei
1,

(cid:35)
0
1
0

(cid:34)0
0
0

2 =

3 =

, ei

[ei

(cid:35)
0
0
0

,

ξi ∈ se(2) and αi ∈ se(2)∗, the elements of the basis of
se(2)∗ are given by

e1
i =

(cid:34)0
0
1

0
0
0

(cid:35)
0
0
0

, e2

i =

(cid:34)0
0
0

0
0
1

(cid:35)
0
0
0

,

e3
i =





0
− 1
2

0

1
2
0

0


0
0
 .

0

The communication topology is given by an equilateral trian-
gle where each node communicates with its adjacent vertex.
The formation is completely speciﬁed by the (holonomic)
ij : SE(2) × SE(2) → R, (i.e., φ1
constraints φk
23)
determined by a prescribed distance dij among the positions
of all agent at any time. The constraint for the edge eij is
F − ˜dij where || · ||F is the
given by φij(gi, gj) = ||ψ(gj)gi||2
Frobenius norm, ||A||F = tr (cid:0)AT A(cid:1)1/2
, ˜dij = d2
ij + 3 and
ψ : SE(2) → SE(2) is the smooth map deﬁned as ψ(g) = ¯g

12, φ2

13, φ3

where ¯g =



 ∈ SE(2).





1 0 −x
0 1 −y
1
0 0

is

the

straightforward to check that

It
constraint
φk
ij(gi, gj) = 0 on absolute conﬁgurations on the Lie group
SE(2) × SE(2), is equivalent to the constraint in the rela-
tive conﬁgurations, that is, φk
ij(gi, gj) = 0 is equivalent to
(xi − xj)2 + (yi − yj)2 − d2

tr(ξT
given by (cid:107)ξi(cid:107)se(2) = (cid:104)(cid:104)ξi, ξi(cid:105)(cid:105)1/2

ij = 0.
The inner product on se(2) is given by (cid:104)(cid:104)ξi, ξi(cid:105)(cid:105)se(2) =
i ξi), for any ξi ∈ se(2) and hence, the norm (cid:107)ξi(cid:107)se(2) is
i ξi), ξi ∈ se(2).
Equations (14) are a set of equations on the Lie algebra
se(2)×se(2)×se(2) which together with the set of constraints
C = {φ1
23} specify the formation for the multi-agent
control system.

se(2) = (cid:112)tr(ξT

13, φ3

12, φ2

To apply Theorem 5.1 we need the expression for the co-
Adjoint action on se(2)∗. The co-Adjoint action of SE(2) on
se(2)∗, denoted Ad∗ : SE(2) × se(2)∗ → se(2)∗ is given by
Ad∗
(Ri,pi)−1(µi, βi) = (µi − Riβi · Jpi, Ripi) ∈ se(2)∗, (16)
where we are using the notation gi = (Ri, pi) ∈ SO(2)×R2 =
SE(2), µi ∈ se(2)∗, βi ∈ R2 and J as in (15).

Denote gij

:= ψ(gj)T ψ(gj)gi ∈ SE(2) and ¯gij

:=
e Lg−1(dΦij(g))) in terms

i ∈ SE(2). The matrix T ∗

ψ(gj)gigT
of the basis for se(2)∗ × se(2)∗ × se(2)∗ is given by
T ∗
e1
T ∗
e1
T ∗
e2

12)(g1, g2)
13)(g1, g3)
23)(g2, g3)

T ∗
e Lg−1(dΦij(g)) =

Lg−1
Lg−1
Lg−1

(dφ1
(dφ2
(dφ3











1

1

2





=

(2g12)31e1
(2g13)31e1
(2g23)31e1

1 + (2g12)32e2
1 + (2g13)32e2
2 + (2g23)32e2

1 + (2¯g12)31e1
1 + (2¯g13)31e1
2 + (2¯g23)31e1

2 + (2¯g12)32e2
2
3 + (2¯g13)32e2
3
3 + (2¯g23)32e2
3





where the subindexes 13 and 23 stands for the entry 31 and
32 of the matrices gij and ¯gij, where we have used that
d
dX tr(X T BX) = BX + BT X for matrices X and B, to
compute
∂φij
∂gi

i ψ(gj)T ψ(gj)gi)

∂
∂gi

tr(gT

=

∂

obtain

∂φij
∂gj

= 2ψ(gj)gigT

and similarly we used

∂X tr(BT X T XA) = 2XAAT ,
i . Combining (16) and (17), by
Theorem 5.1, there are trajectories for each agent satisfying
the formation constraints as well the kinematics given by left-
invariant vector ﬁelds.

to

VI. VARIATIONAL CHARACTERIZATION FOR FORMATION
CONTROL OF MULTI-AGENT SYSTEMS ON LIE GROUPS

In this section we study the motion of dynamical multi-agent
control systems on a Lie group by applying techniques from
variational calculus, after a left-trivialization of the tangent
bundle. In order to determine the dynamics for the formation
problem we use the Lagrange multipliers Theorem 3.1.

Assume that the dynamics of each agent is described by a
Lagrangian function (cid:96)i : G × g → R and deﬁne the overall
Lagrangian function L : Gr × gr → R by

L(g, ξ) =

r
(cid:88)

i=1

(cid:96)i(πi(g), τi(ξ))

(18)

with τi : gr → g deﬁned as in Section IV-A.

In the variational principle developed below we introduce
the formation constraints into the dynamics by incorporating

(cid:88)

m
(cid:88)

λkΦk

ij(g) into (18), with λk ∈ R being

the factor

1
2

j∈Ni

k=1

the Lagrange multipliers and m as in (7). The factor 1
2 in the
previous summation is done in order to not count twice the
quantity of functions Φk
ij (note that Φk
ji). This approach
permits to study the formation problem from a decentralized
perspective (see for instance [14] Section 6.5.2).

ij = Φk

Let us denote by C(Gr × gr) = C([0, T ], Gr × gr, g0, gT )
[0, T ] → Gr × gr
the space of smooth functions (g, ξ) :
satisfying g(0) = g0, g(T ) = gT . Denote also by C(Rm) =
C([0, T ], Rm) the space of curves λ : [0, T ] → Rm in Rm,
without boundary conditions.

The action functional S Gr×gr
Gr × gr → R is given by S Gr×gr

: C(Gr × gr) → R for L :

(cid:90) T

(g, ξ) =

L(g, ξ) dt.

0

Consider the augmented Lagrangian L : Gr ×gr ×Rm → R
given by L(g, ξ, λ) = L(g, ξ) − λ · Φ(g), with · being the dot
product on Rm. Note that such an extended Lagrangian can be
associated with an action functional S : C(Gr ×gr ×Rm) → R
given by

(17)

(cid:90) T

S(g, ξ, λ) :=

L(g, ξ) dt − (cid:104)(cid:104)λ, Φ(g)(cid:105)(cid:105)

0
where (cid:104)(cid:104)·, ·(cid:105)(cid:105) denotes the L2 inner product 1 on Rm.

To prove Theorem 6.1 below we need to introduce the class
of inﬁnitesimal variations we shall consider in the variational
principle.

Deﬁnition 6.1: Let g :

[0, T ] → R be a curve on G.
For (cid:15) > 0, the variation of the curve g is the family of
differentiable curves on G, g(cid:15) : (−(cid:15), (cid:15)) × [0, T ] → G such
that g0(t) = g(t). The inﬁnitesimal variation of g is deﬁned
by δg = d

d(cid:15) g(cid:15)(t) |(cid:15)=0.

=ψ(gj)T ψ(gj)gi + ψ(gj)T ψ(gj)gi = 2ψ(gj)T ψ(gj)gi

1recall that given two functions from [0, T ] to Rm, (cid:104)(cid:104)f, g(cid:105)(cid:105) = (cid:82) T

0 f · g dx

Remark 6.2: Given that ξ = g−1 ˙g, inﬁnitesimal variations
for ξ are induced by inﬁnitesimal variations of g, that is δξ =
˙η + adξη where η is an arbitrary path in g deﬁned by η =
TgLg−1(δg) = g−1δg, that is δg = gη (see [10] Section 7.3, p.
255 for the proof) and where from the last equality is follows
that variations of g vanishing at the end points implies that
η must vanish at end points, that is, η(0) = η(T ) = 0 since
g(0) = g0 and g(T ) = gT are not necessarily zero.

Theorem 6.1: If (g, ξ) ∈ C(Gr × gr) is an extrema of
S G×g, and hence solves the Euler-Lagrange equations for L,
then (g, ξ, λ) ∈ C(Gr × gr × Rm) is an extrema of S and
hence solves the constrained Euler-Lagrange equations for the
augmented Lagrangian L given by

0 =

(cid:19)

d
dt

(cid:18) ∂(cid:96)i
∂ξi

(cid:88)

m
(cid:88)

−

j∈Ni

k=1

− ad∗
ξi

(cid:32)

(cid:19)

(cid:18) ∂(cid:96)i
∂ξi

+ T ∗
ei

Lgi

(cid:19)

(cid:18) ∂(cid:96)i
∂gi

λk

T ∗
ei

Lgi

,

i = 1, . . . , r

(cid:33)

∂φk
ij
∂gi

0 =φk

ij(gi, gj) for all k = 1, . . . , m,

i = 1, . . . , r,

j ∈ Ni.

Proof: If (g, ξ) ∈ T M is an extrema of S Gr×gr

, then by the
Lagrange multiplier theorem, (g, ξ, λ) ∈ C(Gr × gr) × C(Rm)
is an extrema of S(g, ξ, λ) = S Gr×gr
(g, ξ) − (cid:104)(cid:104)λ, Φ(g)(cid:105)(cid:105). By
identifying C(Gr × gr) × C(Rm) with C(Gr × gr × Rm) we
note that

S(g, ξ, λ) =S Gr×gr

(g, ξ) − (cid:104)(cid:104)λ, Φ(g)(cid:105)(cid:105)

=

(cid:90) T

0

(L(g, ξ) − λ · Φ(g)) dt

the action functional

the augmented Lagrangian
for
is
L(g, ξ, λ) = L(g, ξ) − λ · Φ(g), where we have used the
deﬁnition of (cid:104)(cid:104)·, ·(cid:105)(cid:105). As (g, ξ, λ) ∈ C(Gr × gr × Rm) must
extremize this action, it is a solution of the Euler-Lagrange
equations for L.

Next, we extremizes S by solving dS = 0 to obtain the
Euler-Lagrange equations for L. The action integral S along

(cid:90) T

L(g(cid:15), ξ(cid:15), λ(cid:15)) dt. The
a variation of the motion is S (cid:15) =
varied value of this action functional can be expressed as a
power series in (cid:15), that is, S (cid:15) = S + (cid:15)δS + O((cid:15)2) where the
inﬁnitesimal variation of S is given by δS =

0

.

S(cid:15)

d
d(cid:15)

(cid:12)
(cid:12)
(cid:12)(cid:15)=0

Hamilton’s principle states that the inﬁnitesimal variation
of S along any motion must be zero, that is, δS = 0 for
all possible inﬁnitesimal variations in (Gr × gr × Rm), where
inﬁnitesimal variations on g are given by curves η : [0, T ] → g
satisfying η(0) = η(T ) = 0 (see Remark 6.2).

Now, note that

(cid:90) T

δ

0

L(g, ξ, λ)dt = δ

(cid:90) T

(cid:32) r

(cid:88)

0

i=1

(cid:96)i(gi, ξi)

−

1
2

(cid:88)

m
(cid:88)

j∈Ni

k=1



λkφk

ij(gi, gj)

 dt

=

(cid:90) T

0

(cid:68) ∂(cid:96)i
∂ξi

(cid:69)

−

, δξi

1
2

(cid:88)

m
(cid:88)

k=1

φk

ij(gi, gj)δλk +

(cid:68) ∂(cid:96)i
∂gi

(cid:69)

, δgi

(cid:88)

m
(cid:88)

λk

k=1

(cid:32)

j∈Ni
(cid:68) ∂φk
ij
∂gi

, ˙ηi + adξiηi

(cid:69)

j∈Ni
(cid:68) ∂(cid:96)i
∂ξi

(cid:69)

+

, δgi

(cid:68) ∂φk
ij
∂gj

(cid:33)

(cid:69)

dt

, δgj

(cid:88)

m
(cid:88)

j∈Ni

k=1

(cid:88)

m
(cid:88)

j∈Ni

k=1

φk

ij(gi, gj)δλk +

(cid:68) ∂(cid:96)i
∂gi

(cid:69)

, δgi

(cid:32)

(cid:68) ∂φk
ij
∂gi

λk

(cid:69)

+

, δgi

(cid:68) ∂φk
ij
∂gj

(cid:33)

(cid:69)

dt

, δgj

=

−

1
2

(cid:90) T

0

−

−

1
2

1
2

where from the second equality the sum over i = 1, . . . , r has
been omitted to reduce space, and in third equality we replaced
the variations on ξi by their corresponding expressions (see
Remark 6.2).

The ﬁrst component of the previous integrand, after apply-
ing integration by parts twice, using the boundary conditions
for ηi and the deﬁnition of co-adjoint action, results in

(cid:90) T

(cid:68)

0

−

(cid:19)

d
dt

(cid:18) ∂(cid:96)i
∂ξi

(cid:19)

+ ad∗
ξi

(cid:18) ∂(cid:96)i
∂ξi
) = T Lgi ◦ T Lg−1

, ηi

(cid:69)
.

Using the fact that T (Lgi ◦ Lg−1
the identity map on T G and ηi = TgiLg−1
6.2), the third component can be written as
(cid:19)

i

i

(cid:68) ∂(cid:96)i
∂gi

(cid:69)

(cid:68)

, δgi

=

T ∗
ei

Lgi

(cid:18) ∂(cid:96)i
∂gi

(cid:69)

, ηi

is equal to
(δgi) (see Remark

i

For the last member of the integrand we observe the

following,

(cid:32)

(cid:32)

1
2

1
2

(cid:88)

m
(cid:88)

j∈Ni

k=1

(cid:88)

m
(cid:88)

j∈Ni

k=1

λk

λk

(cid:68) ∂φk
ij
∂gi

(cid:69)

+

, δgi

(cid:68) ∂φk
ij
∂gj

(cid:33)

(cid:69)

=

, δgj

(cid:68)

T ∗
ei

Lgi

∂φk
ij
∂gi

(cid:69)

(cid:68)

+

, ηi

T ∗
ej

Lgj

(cid:33)

(cid:69)

,

, ηj

∂φk
ij
∂gj

where we used the deﬁnition of left action and Eq. (3). Using
the fact that φk
ji in second term of the last expression,
last sum can be written as

ij = φk

1
2

(cid:88)

m
(cid:88)

λk

j∈Ni

k=1

(cid:32)

(cid:68)

T ∗
ei

Lgi

∂φk
ij
∂gi

(cid:69)

(cid:68)

+

, ηi

T ∗
ej

Lgj

(cid:33)

(cid:69)

.

, ηj

∂φk
ji
∂gj

(19)
By employing a change of variables in second fac-
can be written as

(19)

last

tor of
m
(cid:88)
(cid:88)

the
(cid:68)

λk

j∈Ni

k=1

expression,
∂φk
ij
∂gi

(cid:69)
.

, ηi

T ∗
ei

Lgi

(cid:90) T

Therefore, δ

and δλk implies

0

0 =

(cid:19)

d
dt

(cid:18) ∂(cid:96)i
∂ξi

(cid:88)

m
(cid:88)

−

j∈Ni
k=1
ij(gi, gj).

0 =φk

L(g(t), ξ(t), λ(t))dt = 0, for all δηi, δgi

(cid:19)

(cid:18) ∂(cid:96)i
∂ξi

+ T ∗
ei

Lgi

− ad∗
ξi

(cid:32)

λk

T ∗
ei

Lgi

(cid:33)

,

∂φk
ij
∂gi

(cid:19)

(cid:18) ∂(cid:96)i
∂gi

(20)

(21)

Finally to describe the dynamics into the Lie group and
therefore obtain the absolute conﬁgurations g(t) ∈ Gr we
must also consider the kinematics equation

˙gi = giξi

(22)

with values in g, for each i = 1, . . . , r. Hence, the constrained
Euler-Lagrange equations (20)-(21) and the kinematic equation
(22) deﬁnes the Lagrangian ﬂow on T Gr × Rm described by
(g, ˙g, λ) ∈ T Gr × Rm, and therefore the set of differential
equations (20)-(22) gives rise to necessary conditions for the
existence of feasible motion in the multi-agent system under
(cid:3)
collision avoidance constraints.
Remark 6.3: Note that a feedback control from the motion
feasibility problem can be constructed by solving the left-
trivialized constrained Euler-Lagrange equations (20)-(22) and
using the solution to construct the feedback law ui employing
equation (4). The existence of solutions for the equations of
motion is guaranteed under a regularity condition as follows
(see [1] Section 1.4.2): if the matrix







∂2(cid:96)
∂ξi∂ξi
(cid:18) ∂φk
ij
∂gi

Lgi

(cid:18)

T ∗
¯ei

(cid:19)(cid:19)T

T ∗
¯ei

Lgi

(cid:19)

(cid:18) ∂φk
ij
∂gi

0







is non-singular at every point in an open neighborhood U of
the vector space gr × Rm then there exists a unique solution
γ(t) := (g(t), ξ(t)) ∈ Gr ×gr of the Euler-Lagrange equations
for (cid:96) with boundary values γ(0) = γ0 and γ(T ) = γ1 with
γ0, γ1 ∈ U and satisfying the collision avoidance constraints.

VII. APPLICATION TO MULTIPLE UNDERWATER VEHICLES

A. System model

Consider the collision avoidance problem for three rigid
bodies evolving on the special Euclidean group SE(3). Any

(cid:20)Ri
0

(cid:21)

bi
1

element of SE(3) is given by gi =

with Ri ∈

i , bz

i , by

SO(3) describing the orientation for the ith-body as a rotation
i ) ∈ R3 is the position of the center
matrix and bi = (bx
of mass for the ith-body in the inertial frame of coordinates.
For the shake of simplicity we write gi = (bi, Ri) ∈
SE(3) (cid:39) R3 × SO(3). Therefore the state of each agent
evolves in the 12 dimensional tangent bundle T SE(3). This
space can be left-trivialized as T SE(3) (cid:39) SE(3) × se(3),
where se(3) (cid:39) so(3) × R3 (cid:39) R3 × R3, with so(3) denoting
the space of (3 × 3)-skew-symmetric matrices. We denote by







ˆΩi(t) =

ˆ· : R3 → so(3) the isomorphism between vectors on R3 and
skew-symmetric matrices, given by
i (t) Ω2
−Ω3
i (t)
0
−Ω1
Ω3
i (t)
0
i (t)
−Ω2
i (t) Ω1
0
i (t)
i ) ∈ R3. The space se(3) has elements
where ˆΩi ∈ so(3), νi ∈ R3. Using the inverse
map of the isomorphism ˆ·, ηi can be identiﬁed with the element
(νi, Ωi) ∈ R6, where νi is the translational velocity and Ωi the
angular velocity for the ith agent, both in body coordinates.
For the remainder of the paper, we represent the attitude state
as an element of SE(3) × se(3) (cid:39) SE(3) × R6.

i , Ω2
with Ωi = (Ω1
(cid:20) ˆΩi
(cid:21)
0

i , Ω3

ηi =

νi
1



The kinematic equations are given by

(24)

˙Ri = Ri ˆΩi,

˙bi = Riνi.
the ith agent

The potential energy for
is denoted by
Ui(bi, Ri) : SE(3) → R. Then the Lagrangian for the
motion of the ith rigid body, after a left-trivialization, (cid:96)i :
SE(3) × R6 → R is given by

(cid:96)i(bi, Ri, νi, Ωi) =

1
2

(cid:104)JiΩi, Ωi(cid:105) +

1
2

(cid:104)Miνi, νi(cid:105) − Ui(bi, Ri),

where (cid:104)·, ·(cid:105) is the trace pairing (an inner product) given by
(cid:104)A, B(cid:105) := Tr(AT B), Ji the inertia matrix and Mi the mass
matrix for the ith rigid body.

We assume that each vehicle is fully actuated, where con-
trol acts on the dynamics. The controlled dynamics of each
vehichle is determined by Euler-Lagrange equations (4) with
controls, for the Lagrangian (cid:96)i, i.e., equations (6). In this
context, equations (6) are given by

(23)

Mi ˙νi =Miνi × Ωi + Ui(bi, Ri) + ui,
Ji ˙Ωi =JiΩi × Ωi + Miνi × νi + Wi(bi, Ri) + ui,

(25)

(26)

together with (24), where u = (u1, u2, u3), ¯u = (u4, u5, u6) ∈
R3 and Ui(bi, Ri), Wi(bi, Ri) ∈ R3 are deﬁned by

Ui(bi, Ri) := − RT
i

∂Ui
∂bi

(bi, Ri),

(27)

(cid:99)Wi(bi, Ri) :=

∂U T
i
∂Ri
We assume that each agent occupies a sphere Si = {b ∈ R3 :
||b − bi|| ≤ ri} where bi ∈ R3 coincides with the center of
the sphere and ri its radius.

Ri − RT
i

∂Ui
∂Ri

(28)

.

The feasibility for the coordinated motion is completely
speciﬁed by the (holonomic) collision avoidance constraints
ij ∈ R+
12, φ2
φ1
between the center of masses of the bodies.

23, by giving a prescribed distance dk

13 and φ3

The set of constraints C = {φ1

12, φ2

13, φ3

23} is determined by

ij)2 = 0

ij(gi, gj) = ||bi − bj||2 − (ri + rj + dk
φk

(29)
ij : SE(3)2 → R. Consider the
and speciﬁes the functions Φk
vector valued function Φ : SE(3)3 → R3×1 given by Φ(g) =
[Φ1
23(g)]T , where g = (g1, g2, g3).Denoting
by “grad’ the gradient of functions, a simple computation
show that

12(g), Φ2

13(g), Φ3

TgiLg−1

i

(grad Φk

ij) = 2(0, RT

i (bi − bj), 0, −RT

i (bi − bj)).

Consider the augmented Lagrangian L : SE(3)3 × se(3)3 ×
R3 → R with λ = (λ1, λ2, λ3) ∈ R3 given by

L(b, R, ν, Ω, λ) =

3
(cid:88)

(cid:96)i(bi, Ri, νi, Ωi) −

1
2

λ1φ1

12(g1, g2)

i=1
1
2

−

(λ2φ2

13(g1, g3) + λ3φ3

23(g2, g3)).

By Theorem 6.1,
feasibility in the coordinated motion are given by

the set of differential equations for the

+ λ1RT

M1 ˙ν1 =M1ν1 × Ω1 + U1(b1, R1)
1 (b1 − b2) + λ2RT
M2 ˙ν2 =M2ν2 × Ω2 + U2(b2, R2)
2 (b1 − b3) + λ3RT
M3 ˙ν3 =M3ν3 × Ω3 + U3(b3, R3)
3 (b1 − b3) + λ3RT

+ λ2RT

+ λ1RT

1 (b1 − b3)

2 (b2 − b3)

3 (b2 − b3)

Ji ˙Ωi =JiΩi × Ωi + Miνi × νi + Wi(bi, Ri),

(30)

(31)

(32)

(33)

for i = 1, 2, 3, together with equations (29) and (24).

In some rigid body applications as for instance spacecraft
motion on SO(3), the mass matrix is usually given by Mi =
miIi where mi is the mass of the body and Ii its matrix
of inertia moments. We will consider models for underwater
vehicles where the elements of Mi may be different due to
the fact that added masses have to be taken into account.

For simplicity in this expository modelling for our theoreti-
cal results, we assume that possible dissipative forces acting on
the body under the water are negligible. The potential energy
for the ith underwater vehicle is given by

Ui(Ri, bi) = ργig(cid:104)¯ri, RT

i e3(cid:105) + (ργi − mi)gbz
i ,

where g is the gravitational acceleration, mi are the masses of
each body, ρ, is the density of water, γi is the volume of each
body, and ¯ri ∈ R3 is a vector from the center of gravity to the
center of buoyancy (in the body ﬁxed frame) of each body.
The positive z-axis in R3 for each body, i.e., bz
i , is taken to
point downwards in the same direction as the gravity. Under
these considerations, equations (30)-(33) are given by

1 (m1 − ργ1)ge3

1 (b1 − b2) + λ2RT

1 (b1 − b3)

2 (m2 − ργ2)ge3

2 (b1 − b3) + λ3RT

2 (b2 − b3)

M1 ˙ν1 =M1ν1 × Ω1 − RT
+ λ1RT
M2 ˙ν2 =M2ν2 × Ω2 − RT
+ λ1RT
M3 ˙ν3 =M3ν3 × Ω3 − RT
+ λ2RT

1 (m3 − ρ3γ)ge3

3 (b1 − b3) + λ3RT
Ji ˙Ωi =JiΩi × Ωi + Miνi × νi − ργig¯ri × (RT

3 (b2 − b3)

i e3),

(34)

(35)

(36)

(37)

for i = 1, 2, 3, together with equations (29) and (24).

B. Construction of control law for the cooperative motion

The step-by-step algorithm to construct the control law is

summarized in Algorithm 1.

Algorithm 1 Construction of the control law for the cooper-
ative motion
1: Data: Mi, Ji, ¯ri, ri, ρ, γi, g, dk
2: inputs: Ri(0), Ωi(0), bi(0), νi(0), i = 1, 2, 3, satisfying the

ij, time step h, # of steps N .

constraints (29) and regularity condition (23), T = N h.

3: Compute the derivative w.r.t.

(cid:46) ﬁrst stage: Dynamics of λ(t)
time in equation (29). For the
derivative w.r.t time of each constraint (29), isolate ˙bi and replace
into the obtained expression ˙bj from (24).

4: Compute the second derivative w.r.t. time in equation (29). For
each i isolate ¨bi, and in the isolated expression replace ˙bi from
Step 3 and ˙νi from (34)-(36).

5: From the expression obtained in Step 4, isolate λ(t) as a function

of ˙b and ¨b.

6: Use Steps 3 and 4 of the algorithm to write derivatives of b in the
expression of λ(t) obtained by Step 5, in terms of conﬁgurations
and obtain the expression for the evolution of λ(t) in terms of
bi, νi and Ri.

7: Replace λ(t) in terms of bi, νi and Ri obtained in Step 6 in

equations (34)-(36).

(cid:46) second stage: Solve the equations (34)-(37)

8:
9: for i = 1 → 3 do
10:
11: end for
12: outputs: Ri(t), bi(t), Ωi(t), νi(t) for i = 1, 2, 3.

solve (34)-(37) subject to (24).

(cid:46) third stage: Construction of the control law

13: for i = 1 → 3 do
14:

Replace Ri(t), bi(t), Ωi(t), νi(t),into (25)-(28) and solve for

ui(t) and ¯ui(t).

15: end for
16: outputs: ui(t) and ¯ui(t) from equations (25) and (26).

C. Simulation results

13 = d3

12 = d2

Now we show how the previous algorithm is employed
in numerical simulation. We consider that
the three bod-
ies have mass mi = 123.8kg, and mass (including added
masses) and inertia matrices Mi = miIi + diag(65, 70, 75)kg,
Ji = diag(5.46, 5.29, 5.72)kg× m2 and Ii = Id3×3kg× m2,
with Id3×3 the (3 × 3)-identity matrix. Also assume that
ργig = 1215.8N and ¯ri = (0, 0, −0.007)T m. Initial conditions
are chosen as Ri(0) = Id3×3s−1, Ωi(0) = (0.3, 0.2, 0.1)T s−1,
νi(0) = Ri(0)−1(0.1, 0.2, 1)T ms−1, d1
23 =
10m, b1 = (0, 0, 0)T m, b2 = (10, 6.63324958, 0)T m, b3 =
(10.7446, −5.34363, 0)T m. The radius of the spheres ri which
contains each body is 1m. With the above choice of parameters
and initial conditions satisfying the constraints and the regular-
ity condition (23) we simulate the controlled dynamics of the
vehicles with a step size of h = 0.005s using an Euler method.
In Figure 1 we compare the position of the center of mass of
the bodies without the collision avoidance constraints (left)
and with our method (right) for N = 5000. We observe that
trajectories crosses each others without our method, while the
avoidance of trajectories crossing each others occurs when we
incorporate the collision avoidance constraints (29). In Figure
2 we show different perspectives for the collision avoidance
trajectory. Figures 3 and 4 show the attitude and angular
velocity, respectively, of the three bodies with the collision
avoidance constraints.

[13] J. Marsden, T. Ratiu.

Introduction to Mechanics and Symmetry.

Springer-Verlag, second edition, 1999.

[14] M. Mesbahi and M. Egerstedt. Graph theoretic methods in multiagent

networks. Princeton University Press, 2010.

[15] R. Murray, Z. Li and S. Sastry. A mathematical introduction to robotic

manipulation. CRC Press, 1994.

[16] K. Oh, M. Park and H. Ahn. A survey of multiagent formation control.

Automatica, 53, 424-440, 2015.

[17] P. Pereira, D.V Dimarogonas. Family of controllers for attitude synchro-
nization in S2. Decision and Control (CDC), 2015 IEEE 54th Annual
Conference on, 6761-6766.

[18] A. Sarlette, S. Bonnabel, R. Sepulchre. Coordinated motion design on
Lie groups, IEEE Transactions on Automatic Control, vol. 55 nr. 5, pp.
1047-1058, 2010.

[19] A. Sarlette, R. Sepulchre, and N. E. Leonard. Autonomous rigid body
attitude synchronization. Automatica, vol. 45, no. 2, pp. 572-577, 2009.
[20] Z. Sun and B. D. O. Anderson. Formation feasibility on coordination
control of networked heterogeneous systems with drift terms. Proc. of
the 55th IEEE Conference on Decision and Control (CDC’16), pp. 3462-
3467, Las Vegas, USA, 2016

[21] P. Tabuada, J. Pappas and P. Lima. Motion feasibility for multi-agent

formation. IEEE Transactions on robotics. vol 21 (3), 387-392, 2005.

[22] H. Tanner and A. Kumar. Formation stabilization of multiple agents us-
ing decentralized navigation functions. Robotics: Science and Systems,
MIT Press, 49- 56, 2005.

Leonardo J. Colombo. Leonardo Colombo is a
Postdoctoral Junior Leader from La Caixa Founda-
tion at Instituto de Ciencias Matematicas (ICMAT)
from 2019. He received a B.Sc. in Mathematics from
the Universidad Nacional de La Plata, Argentina
in 2009, a M.S in Applied Mathematics from the
Universidad Aut´onoma of Madrid (UAM) in 2012,
and a Ph.D. from ICMAT and UAM in 2014. His
research interest includes multi-agent control sys-
tems, geometric mechanics, geometric integration,
hybrid systems, robot motion planning, unmanned

aerial vehicles, formation control and control oriented learning.

He was a Postdoc Assistant Professor at University of Michigan, USA
from 2014 to 2017, a Postdoctoral researcher at ACCESS LINEAUS Center,
Department of Automatic Control, School of Electrical Engineering, KTH
Royal Institute of Technology, Stockholm, Sweden between 2017 and 2018
and a Juan de la Cierva Incorporaci´on researcher at ICMAT from 2018
to 2019. He received the Vicent Casseles Award from the Spanish Royal
Mathematical Society and Foundation BBVA in 2016.

Dimos V. Dimarogonas. Dimos V. Dimarogonas
received the Diploma in Electrical and Computer
Engineering in 2001 and the Ph.D. in Mechanical
Engineering in 2007, both from the National Tech-
nical University of Athens (NTUA), Greece. From
May 2007 to February 2009, he was a Postdoctoral
Researcher at
the Automatic Control Laboratory,
School of Electrical Engineering, KTH Royal Insti-
tute of Technology, Stockholm, Sweden, and a Post-
doctoral Associate at the Laboratory for Information
and Decision Systems, Massachusetts Institute of
Technology (MIT), Cambridge, MA, USA. He is currently an Associate
Professor in Automatic Control, School of Electrical Engineering, KTH Royal
Institute of Technology. His current research interests include multi-agent
systems, hybrid systems, robot navigation, networked control and event-
triggered control. Dr. Dimarogonas was awarded a Docent in Automatic
Control from KTH in 2012. He serves on the Editorial Board of Automatica,
the IEEE Transactions on Automation Science and Engineering and the IET
Control Theory and Applications, and is a member of the Technical Chamber
of Greece. He received an ERC Starting Grant from the European Commission
for the proposal BUCOPHSYS in 2014 and was awarded a Wallenberg
Academy Fellow grant in 2015.

Fig. 1. Collision of vehicles vs. collision avoidance.

Fig. 2. Different perspectives of the trajectories for collision avoidance.

Fig. 3. Evolution of Euler angles in the rotation matrix R(t).

Fig. 4. Evolution of angular velocity Ω(t).

REFERENCES

[1] V. Arnold. Mathematical aspects of classical and celestial mechanics.

Springer, 2nd ed. 1993.

[2] C Altaﬁni, R Frezza. Motion on submanifolds of noninvariant holonomic
constraints for a kinematic control system evolving on a matrix Lie
group. Systems & control letters 50 (3), 241-250, 2003.

[3] T. Balch and R. Arkin. Behavior-based formation control for multirobot
systems. IEEE Trans. Robot. Autom. Vol 14 (6), 926-939, 1998.
[4] F. Bullo and J. Cort´es and S. Mart´ınez. Distributed Control of Robotic

Networks. Princeton University Press, 2009.

[5] Y. Cao, W. Yu, W. Ren and G. Chen. An overview of recent progress
in the study of distributed multi-agent coordination. IEEE Transactions
on Industrial informatics, 9(1), 427-438, 2013.

[6] L. J. Colombo and D. V. Dimarogonas. Variational Principles for Op-
timal Control of Left-Invariant Multi-Agent Systems with Asymmetric
Formation Constraints. Preprint available at arXiv:1802.01224.

[7] L. Colombo, H. Garc´ıa de Marina. A Variational Integrator for the
formation control of multi-agent systems. IFAC-PapersOnLine 51 (23),
76-81, 2018.

[8] D. V. Dimarogonas, P. Tsiotras and K. J. Kyriakopoulos. Leader-
Follower Cooperative Attitude Control of Multiple Rigid Bodies, Sys-
tems and Control Letters, Vol. 58, No. 6, pp. 429-435, 2009.

[9] M. Egerstedt and X. Hu. Formation constrained multi-agent control.
IEEE Trans. on Robotics and Automation. 17(6) (2001) 947-951
[10] D. Holm, T. Schmah and C Stoica. Geometric mechanics and symmetry:
from ﬁnite to inﬁnite dimensions. Oxford University Press, 2009.
[11] E. Justh and P. Krishnaprasad. Equilibria and steering laws for planar

formations. Systems & Control Letters 52, 25-38, 2004.

[12] N. Leonard and E. Fiorelli. Virtual leaders, artiﬁcial potentials and
coordinated control of groups. IEEE Conference on Decision and
Control, 2968-2973, 2001.

