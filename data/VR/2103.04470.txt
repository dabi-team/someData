1
2
0
2

g
u
A
0
2

]
T
A
.
h
t
a
m

[

3
v
0
7
4
4
0
.
3
0
1
2
:
v
i
X
r
a

Curvature Sets Over Persistence Diagrams

Mario G´omez1 and Facundo M´emoli2

1Department of Mathematics, The Ohio State University.,
gomezflores.1@osu.edu
2Department of Mathematics and Department of Computer Science and
Engineering, The Ohio State University., memoli@math.osu.edu

August 24, 2021

Abstract

We study an invariant of compact metric spaces which combines the notion of
curvature sets introduced by Gromov in the 1980s together with the notion of Vietoris-
Rips persistent homology. For given integers k ≥ 0 and n ≥ 1 these invariants arise
by considering the degree k Vietoris-Rips persistence diagrams of all subsets of a given
metric space with cardinality at most n. We call these invariants persistence sets and
denote them as DVR
n,k . We argue that computing these invariants could be signiﬁcantly
easier than computing the usual Vietoris-Rips persistence diagrams. We establish
stability results as for these invariants and we also precisely characterize some of them
in the case of spheres with geodesic and Euclidean distances. We identify a rich family
of metric graphs for which DVR
4,1 fully recovers their homotopy type. Along the way we
prove some useful properties of Vietoris-Rips persistence diagrams.

Contents

1 Introduction

1.1 Contributions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
1.2 Related work . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
1.3 Acknowledgements

2 Background

2.1 Metric geometry . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
2.2 Metric measure spaces
2.3 Simplicial complexes
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
2.4 Persistent homology . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
2.5 Stability . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

1

2
6
11
11

12
12
13
14
14
16

 
 
 
 
 
 
3 Curvature sets and Persistence diagrams

3.1 F-persistence sets . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
3.2 F-Persistence measures . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

4 VR-persistence sets

4.1 Some properties of Vietoris-Rips complexes . . . . . . . . . . . . . . . . . . .
4.2 Computational examples . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

5 VR-Persistence sets of spheres

5.1 Characterization of tb(X) and td(X) for X ⊂ S1
. . . . . . . . . . . . . . . .
2k+2,k(S1) for k even . . . . . . . . . . . . . . . . . . .
5.2 Characterization of DVR
2k+2,k(S1) for k odd . . . . . . . . . . . . . . . . . . . .
5.3 Characterization of DVR
4,1 (S1) . . . . . . . . . . . . . . . . . . . . . . . . . . .
5.4 Characterization of UVR
5.5 Persistence sets of Ptolemaic spaces . . . . . . . . . . . . . . . . . . . . . . .
5.6 Persistence sets of the surface with constant curvature κ . . . . . . . . . . .
5.7 Persistence sets of Sm for m ≥ 3 . . . . . . . . . . . . . . . . . . . . . . . . .

6 Concentration of persistence measures

6.1 A concentration theorem . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

7 Coordinates

18
20
23

24
24
30

31
32
34
35
38
41
43
47

51
52

54

8 Persistence sets of metric graphs
8.1 Split metric decompositions
. . . . . . . . . . . . . . . . . . . . . . . . . . .
8.2 A family of metric graphs whose homotopy type can be characterized via DVR

55
55
4,1 . 60

9 Discussion and Questions

68

1

Introduction

The Gromov-Hausdorﬀ (GH) distance, a notion of distance between compact metric spaces,
was introduced by Gromov in the 1980s and was eventually adapted into data/shape analysis
by the second author [M´em05, MS04, MS05] as a tool for measuring the dissimilarity between
shapes/datasets.

Despite its usefulness in providing a mathematical model for shape matching proce-
dures, [MS04, MS05, BBBK08], the Gromov-Hausdorﬀ distance leads to NP-hard problems:
[M´em12b] relates it to the well known Quadratic Assignment Problem, which is NP-hard,
and Schmiedl in his PhD thesis [Sch17] (see also [AFN+18]) directly proves the NP-hardness
of the computation of the Gromov-Hausdorﬀ distance even for ultrametric spaces. Recent
work has also identiﬁed certain Fixed Parameter Tractable algorithms for the GH distance
between ultrametric spaces [MSW19].

These hardness results have motivated research in other directions:

2

(I) ﬁnding suitable relaxations of the Gromov-Hausdorﬀ distance which are more amenable

to computations and

(II) ﬁnding lower bounds for the Gromov-Hausdorﬀ distance which are easier to compute,

yet retain good discriminate power.

Related to the ﬁrst thread, and based on ideas from optimal transport, the notion of
Gromov-Wasserstein distance was proposed in [M´em07, M´em11]. This notion of distance
leads to continuous quadratic optimization problems (as oposed to the combinatorial nature
of the problems induced by the Gromov-Hausdorﬀ distance) and, as such, it has beneﬁted
from the wealth of continuous optimization computational techniques that are available in
the literature [PCS16, PC+19] and has seen a number of applications in data analysis and
machine learning [VCF+20, DSS+20, AMJ18, KM21, BCM+20] in recent years.

The second thread mentioned above is that of obtaining computationally tractable lower
bounds for the usual Gromov-Hausdorﬀ distance. Several such lower bounds were identiﬁed
in [M´em12b] by the second author, and then in [CM08, CM10a] and [CCSG+09] it was
proved that hierarchical clustering dendrograms and persistence diagrams or barcodes, metric
invariants which arose in the Applied Algebraic Topology community, provide a lower bound
for the GH distance. These persistence diagrams will eventually become central to the present
paper, but before reviewing them, we will describe the notion of curvature sets introduced
by Gromov.

Gromov’s curvature sets and curvature measures. Given a compact metric space
(X, dX), in the book [Gro07] Gromov identiﬁed a class of invariants of metric spaces indexed
by the natural numbers that solves the classiﬁcation problem for X. In more detail, Gromov
deﬁnes for each n ∈ N, the n-th curvature set of X, denoted by Kn(X), as the collection of all
n × n matrices that arise from restricting dX to all possible n-tuples of points chosen from X,
possibly with repetitions. The terminology curvature sets is justiﬁed by the observation that
these sets contain, in particular, metric information about conﬁgurations of closely clustered
points in a given metric space. This information is enough to recover the curvature of a
manifold; see Figure 1.

These curvature sets have the property that Kn(X) = Kn(Y ) for all n ∈ N is equivalent
to the statement that the compact metric spaces X and Y are isometric. Constructions
similar to the curvature sets of Gromov were also identiﬁed by Peter Olver in [Olv01] in his
study of invariants for curves and surfaces under diﬀerent group actions (including the group
of Euclidean isometries).

In [M´em12b] it is then noted that the GH distance admits lower bounds based on these

curvature sets:

dGH(X, Y ) ≥ (cid:98)dGH (X, Y ) :=

1
2

sup
n∈N

dH(Kn(X), Kn(Y ))

(1)

for all X, Y compact metric spaces. Here, dH denotes the Hausdorﬀ distance on Rn×n with
(cid:96)∞ distance. As we mentioned above, the computation of the Gromov-Hausdorﬀ distance
leads in general to NP-hard problems, whereas the lower bound in the equation above can

3

Figure 1: The curvature of a smooth curve C can be estimated as the inverse of the radius
R of the circle passing through the points x, x(cid:48) and p. By plane geometry results [COS+98,
Theorem 2.3], this radius can be computed from the 3 interpoint distances a, b, and c, and
hence from K3(C), as R = R(a, b, c) =
((a+b+c)(a+b−c)(a−b+c)(−a+b+c))1/2 . In fact, Calabi et
al. prove: R−1 = κ + 1
3(b − a)κs + · · · where κ and κs are the curvature and its arc length
derivative at the point p.

a b c

be computed in polynomial time when restricted to deﬁnite values of n. In [M´em12b] it is
argued that work of Peter Olver [Olv01] and Boutin and Kemper [BK04a] leads to identifying
rich classes of shapes where these lower bounds permit full discrimination.

In the category of compact mm-spaces, that is triples (X, dX, µX) where (X, dX) is a
compact metric space and µX is a fully supported probability measure on X, Gromov also
discusses the following parallel construction: for an mm-space (X, dX, µX) let

Ψ(n)

X : X ×n −→ Rn×n

be the map that sends the n-tuple (x1, x2, . . . , xn) to the matrix M with elements Mij =
dX(xi, xj). Then, the n-th curvature measure of X is deﬁned as

µn(X) :=

(cid:17)

(cid:16)

Ψ(n)
X

µ⊗n
X .

#

Clearly, curvature measures and curvature sets are related as follows: supp(µn(X)) = Kn(X)
for all n ∈ N. Gromov then proves in his mm-reconstruction theorem that the collection of
all curvature measures permit reconstructing any given mm-space up to isomorphism.

Similarly to (1), [MNO21] proves for each p ≥ 1 that

dGW,p(X, Y ) ≥ (cid:98)dGW,p(X, Y ) :=

1
2

sup
n∈N

dW,p(µn(X), µn(Y )),

(2)

where dW,p denotes the p-Wasserstein distance [Vil03] on P1

(cid:0)Rn×n(cid:1) with (cid:96)∞ distance.

4

Figure 2: The pipeline to compute a persistence diagram. Starting with a distance matrix, we
compute the Vietoris-Rips complex and its homology, and produce an interval decomposition.
Together, we call these three steps PHVR
k .

Ideas related to what is nowadays know as persistent homology
Persistent Homology.
appeared already in the late 1980s and early 1990s in the work of Patrizio Frosini [Fro90b,
Fro99, Fro90a], then in the work of Vanessa Robins [Rob99], in the work of Edelsbrunner
and collaborators [ELZ00], and then in the work of Carlsson and Zomorodian [ZC04]. Some
excellent references for this topic are [EH10, Ghr08, Car14, Wei11].

In a nutshell, persistent homology (PH) assigns to a given compact metric space X and an
k (X) in the plane, known as the k-th (Vietoris-Rips)

integer k ≥ 0, a multiset of points dgmVR
persistence diagram of X. The standard PH pipeline is shown in Figure 2.

These diagrams indicate the presence of k-dimensional multi-scale topological features in
the space X, and can be compared via the bottleneck distance (which is closely related to
but is stronger than the Hausdorﬀ distance in (R2, (cid:96)∞)).

Following work by Cohen-Steiner et al.

[CSEH07], in [CCSG+09] it is proved that the
k (X) sending a given compact metric space to its k-th persistence diagrams

maps X (cid:55)→ dgmVR
is 2-Lipschitz under the GH and bottleneck distances.

Algorithmic work by Edelsbrunner and collaborators [ELZ00] and more recent devel-
opments [Bau19] guarantee that not only can dgmVR
k (X) be computed in polynomial time
(in the cardinality of X) but also it is well known that the bottleneck distance can also
be computed in polynomial time [EH10]. This means that persistence diagrams provide
another source of stable invariants which would permit estimating (lower bounding) the
Gromov-Hausorﬀ distance.

It is known that persistence diagrams are not full invariants of metric spaces. For instance,
any two tree metric spaces, that is metric spaces satisfying the four point condition [Gro87],
have trivial persistence diagrams in all degrees k ≥ 1. It is also not diﬃcult to ﬁnd two ﬁnite
tree metric spaces with the same degree zero persistence diagrams. See [LMO20] for more
examples and [MZ19] for results about stronger invariants (i.e. persistent homotopy groups).

5

Despite the fact that persistence diagrams can be computed with eﬀort which depends
polynomially on the size of the input metric space [EH10, AW20], the computations are
actually quite onerous and, as of today, it is not realistic to compute the degree 1 Vietoris-
Rips persistence diagram of a ﬁnite metric space with more than a few thousand points even
with state of the art implementations such as Ripser [Bau19].

Curvature sets over persistence diagrams.
In this paper, we consider a version of
the curvature set ideas which arises when combining their construction with Vietoris-Rips
persistent homology.

For a compact metric space X and integers n ≥ 1 and k ≥ 0, the (n, k)-Vietoris-Rips
n,k(X) of all persistence diagrams

persistence set of X is (cf. Deﬁnition 3.9) the collection DVR
in degree k of subsets of X with cardinality at most n.

In a manner similar to how the n-th curvature measure µn(X) arose above, we also study
the probability measure UVR
n,k(X) deﬁned as the pushforward of µn(X) under the degree k
Vietoris-Rips persistence diagram map (cf. Deﬁnition 3.16). We also study a more general
version wherein for any stable simplicial ﬁltration functor F (cf. Deﬁnition 2.22), we consider
both the persistence sets DF

n,k(X) and the the persistence measures UF

n,k(X).

1.1 Contributions

We provide a thorough study of persistence sets and in particular analyze the following
points.

Computational cost, paralellizability, and approximation: One argument for con-
sidering the persistent set invariants DVR
n,k(X) as opposed to the standard degree k Vietoris-
Rips persistence diagrams dgmk(X) is that while computing the latter incurs cost O(|X|3(k+2))
in the worst case, computing the former incurs cost O(n3(k+2)|X|n), which is in general (when
n (cid:28) |X|) not only signiﬁcantly smaller but also the associated computational tasks are em-
inently parallelizable. Furthermore, the amount of memory needed for computing persistent
sets is also notably smaller than for computing persistence diagrams over the same data set.
See Remark 3.15 for a detailed discussion. In fact, persistent sets are useful as an alternative
paradigm for the acceleration of the computation of persistent homology based invariants;
cf. Figure 3.

Principal persistence sets, their characterization and an algorithm: Persistence
sets are deﬁned to be sets of persistence diagrams and, although a single persistence diagram
is easy to visualize, large collections of them might not be so. However, when there is a certain
relation between n and k we verify in Theorem 4.4 that there can be at most one point in
the degree k persistence diagram of any metric space with at most n points. This means
that all persistence diagrams in the principal persistence set DVR
2k+2,k(X) can be stacked on
the same axis; see Figure 4.

6

Figure 3: The pipeline to compute Dn,k. Starting with a metric space (X, dX), we take
samples of the distance matrix as elements of Kn(X), apply PHk to each, and aggregate
the resulting persistence diagrams. For example, Theorem 4.4 guarantees that the VR-
persistence diagram in dimension k of a metric space with n = 2k + 2 points only has one
point. The aggregation in this case means plotting the set DVR
n,k(X) by plotting all diagrams
simultaneously in one set of axes. In general, the diagrams in Dn,k(X) have more than 1
point, so one possibility for aggregation is constructing a one-point summary or an average
of a persistence diagram (for instance, a Chebyshev center or an (cid:96)∞ mean) and then plotting
all such points simultaneously.

7

Figure 4: A graphical representation of the principal persistent sets DVR
2k+2,k(X) is obtained
by overlaying the persistence diagrams of all samples Y ⊂ X (with |Y | ≤ 2k + 2) into single
set of axes. This is made possible since by Theorem 4.4 these diagrams have at most one oﬀ
diagonal point.

Our main result, Theorem 4.4 furthermore gives a precise representation of the unique
point in the degree k persistence diagram of a metric space with at most nk := 2k + 2
points via a formula which induces an algorithm for computing the principal persistence
sets. This algorithm is purely geometric in the sense that it does not rely on analyzing
boundary matrices but, in contrast, directly operates at the level of distance matrices. For
any k, this geometric algorithm has cost O(n2
k) ≈ O(k2) as opposed to the much larger cost
O(n3(k+2)
) ≈ O(23k k3(k+2)) incurred by the standard persistent homology algorithms; see
k
Remark 4.6.

Characterization results. We fully characterize the principal persistence sets DVR
In particular, these results prove that DVR
tices ( 2π
4,1 (S1), which are supported on DVR
UVR
probability density function f (tb, td) = 12
speciﬁed in Figure 5.

2k+2,k(S1).
4,1 (S1) coincides with the triangle in R2 with ver-
2 , π), and (π, π); see Figure 5. We also characterize the persistence measure
4,1 (S1) has
π3 (π − td), for any (tb, td) in the triangular region

4,1 (S1), in Proposition 5.8. We show that UVR

3 ), ( π

3 , 2π

Propositions 5.13 and 5.17, and Corollary 5.18 provide additional information about
higher dimensional spheres. Section 4.2 provides some computational examples including
the case of tori.

Our characterization results are in the same spirit as results pioneered by Adamaszek
and Adams related to characterizing the Vietoris-Rips persistence diagrams of circles and
spheres [AA17]; see also [LMO20].

Additionally, the arguments used to characterize the Persistence Set of the sphere can be

generalized to other surfaces. More precisely, we obtained:

Theorem 5.16. Let Mκ be the 2-dimensional model space with constant sectional curvature
κ. Then:

8

DVR

4,1 (S1)

3

2.5

2

1.5

1

0.5

0

0

0.5

1

1.5

2

2.5

3

4,1 (S1): The (4, 1)-persistence set of S1 (with geodesic
Figure 5: Characterization of DVR
distance) is the shaded triangular area where the top left and top right points have coor-
dinates ( π
2 , π) and (π, π), respectively, whereas the lowest diagonal point has coordinates
3 ). The ﬁgure also shows exemplary conﬁgurations X ⊂ S1 with |X| ≤ 4 together with
3 , 2π
( 2π
their respective persistence diagrams inside of DVR

4,1 (S1).

• If κ > 0, DVR

4,1 (Mκ) =

(cid:110)

(tb, td)| sin

(cid:16) √

κ
2 td

√

(cid:17)

≤

2 sin

(cid:17)

(cid:16) √

κ
2 tb

and 0 < tb < td ≤ π√
κ

(cid:111)
.

• If κ = 0, DVR

4,1 (M0) = (cid:8)(tb, td)| 0 ≤ tb < td ≤
(cid:17)

(cid:16) √

(cid:110)

(cid:9).
2tb
√

√

• If κ < 0, DVR

4,1 (Mκ) =

(tb, td)| sinh

−κ
2 td

≤

2 sinh

(cid:16) √

(cid:17)

−κ
2 tb

and 0 < tb < td

(cid:111)
.

A similar result ﬁrst appeared in [BHPW20]. The authors explore the question of whether
persistent homology can detect the curvature of the ambient Mκ. They found a geometric
formula to compute dgm ˇCech
(T ) of a sample T ⊂ Mκ with three points, much in the same vein
as our Theorem 4.4. They used it to ﬁnd the logarithmic persistence Pa(κ) = td(Tκ,a)/tb(Tκ,a)
for an equilateral triangle Tκ,a of ﬁxed side length a > 0, and proved that Pa, when viewed
as a function of κ, is invertible.

1

The present Theorem 5.16 is in the same spirit. Instead of equilateral triangles, we can
use squares with a given td and minimal tb to ﬁnd κ. Qualitatively, we can detect the sign
of the curvature by looking at the boundary of DVR
4,1 (Mκ): it is concave up when κ > 0, a
straight line when κ = 0, and concave down when κ < 0. See Figure 14.

Unlike us, they also detected curvature experimentally. They sampled 1000 points from
a unit disk in Mκ and were able to approximate κ using the average VR death vectors in
dimension 0 and average persistence landscapes in dimension 1 of 100 such samples. For
example, one method consisted in ﬁnding a collection of landscapes Lκ labeled with a known
curvature κ, and estimating κ∗ for an unlabeled L∗ with the average curvature of the three

9

nearest neighbors of L∗. They were also able to approximate κ∗ without labeled examples
by using PCA. See their paper [BHPW20] for more details.

The key ingredient in the proof of Theorem 5.16 is Ptolemy’s inequality and its analogues
in non-Euclidean geometries [Val70a, Val70b]. We generalize these inequalities to CAT(κ)
spaces, albeit with some constraints when κ > 0. In contrast, when κ ≤ 0, we show that the
persistence set DVR
4,1 of the
corresponding model space Mκ.

4,1 (X) of a CAT(κ) space is contained in the persistence set DVR

Stability. We establish the stability of persistence sets and measures under Gromov-
Hausdorﬀ and Gromov-Wasserstein distances in Theorems 3.12 and 3.17. Such results permit
estimating these distances in polynomial time. As an application, we show that the Gromov-
Hausdorﬀ distance between S1 and Sm is bounded below by π
15 when m = 2 (Example 5.19)
and by π
8 when m ≥ 3 (Example 5.20). These bounds are not tight; it is known that
dGH(S1, S2) = π
m+1) ≥ π

4 for m ≥ 3 (see [LMS21]).

3 and dGH(S1, Sm) ≥ 1

2 arccos( −1

Concentration results for UVR
measures is the concentration of UF

n,k. Another consequence of the stability of persistence

n,k(X) as n → ∞. More precisely,

Theorem 6.3. Let (X, dX, µX) be an mm-space and take any stable ﬁltration functor F.
For any n, k ∈ N, consider the random variable D valued in DF
n,k(X) distributed according
to UF

n,k(X). Then:
• For any ε > 0, EUF

(cid:2)dB

(cid:0)D, dgmF

n,k(X)

• As a consequence, the mm-space DF
one-point mm-space as n → ∞.

k(X)(cid:1)(cid:3) < diam(X) · CX(n, ε) + ε.
n,k(X) = (cid:0)DF

n,k(X), dB, UF

n,k(X)(cid:1) concentrates to a

1 , . . . , Sm

Similar results appear in [BGMP12] [CFL+15]. The approach in [CFL+15] is studying
n of n samples Sm
the average persistence landscape λm
n ⊂ X of size m. They show
that this procedure is stable under perturbations of the Gromov-Wasserstein distance, and
provide a bound on the expected (cid:96)∞ distance between the persistence landscape of X and
λm
n . These two results are analogous, respectively, to our Theorem 3.17 and to item 1 of 6.3
above. As for [BGMP12], the authors study the statistical robustness of persistent homology
invariants. They have two results similar to ours. One is the stability of the measures
UF
k (X) instead) under the Gromov-Prokhorov distance (instead of the
Gromov-Hausdorﬀ distance). They second is a central limit theorem, where the measures
UF
n,k(Si) corresponding to an increasing sequence of ﬁnite samples S1 ⊂ S2 ⊂ · · · X converge
in probability to UF

n,k(X) (they write Φn

n,k(X).

k(X) ∈ DF

Persistence sets and measures capture more information than dgmVR
k . Evidently,
dgmF
n,k(X) when n ≥ |X|. What is interesting is that persistence sets can detect
more information than the Vietoris-Rips persistent diagram. See Example 8.5 where G is a
graph that consists of a cycle C with 4 edges attached such that DVR
4,1 (G) contains more points
than DVR
4,1 (C). As far as the Vietoris-Rips complex is concerned, though, VRr(G) (cid:39) VRr(C).

10

In Section 8, as an appli-
An application to detecting homotopy type of graphs:
cation, we study a class of metric graphs for which DVR
4,1 , a rather coarse invariant which is
fairly easy to estimate and compute in practice, is able to characterize the homotopy type of
graphs in this class. In fact, DVR
4,1 detects more features than the Vietoris-Rips persistence
diagram of G. See Figure 19 for an example. There, G is a cycle C with 4 edges attached and
DVR
4,1 (C). In contrast, the Vietoris-Rips complex of both graphs
are homotopy equivalent.

4,1 (G) is diﬀerent from DVR

1.2 Related work

The measures UVR
n,k ﬁrst appeared in a paper in the work by Blumberg et al. [BGMP12] in
2012 and then in print in [BGMP14]. These measures were also exploited a couple years
in the articles [CFL+14, CFL+15] in order to devise bootstrapping
later by Chazal et al.
methods for the estimation of persistence diagrams.

n,k (as well as the more general objects DF

The connection to Gromov’s curvature sets and measures was not mentioned in either of
these two papers. [M´em12b] studied curvature sets and their role in shape comparison and,
as a natural follow up, some results regarding the persistence sets DVR
n,k and the measures
UVR
n,k) were ﬁrst described Banﬀ in 2012
during a conference [M´em12a] by the second author. Then, subsequent develoments were
described in 2013 at ACAT 2013 in Bremen [M´em13a] and Bedlewo [M´em13b], and then
at IMA [M´em14a] and at SAMSI in 2014 [M´em14b].
In these presentations the second
author proposed the invariants DVR
n,k as a Gromov-Hausdorﬀ stable computationally easier
alternative to the usual Vietoris-Rips persistence diagrams of metric spaces [M´em14c].

n,k and UF

In January 2021 Bendich, et al. uploaded a paper to the arXiv [SWB21] with some ideas
related to our construction of DF
n,k. The authors pose questions about the discriminative
power of a certain labeled version of the persistent sets DVR
n,k (even though they do not call
them that) and also mention some stability and computational properties similar to those
mentioned in [M´em12a, M´em13a, M´em14a, M´em14b].

The second author together with Needham [MN18] has recently explored the classiﬁcatory
power of µ2 as well as that of certain localizations of µ2. In [CCM+20] the authors identify
novel classes of simplicial ﬁltrations arising from curvature sets together with suitable notions
of locality. Ongoing work is exploring the classiﬁcatory power of µn for general n [MNO21].
In terms of data intensive applications, the neuroscience paper [SMI+08] made use of

ideas related to UVR

n,k and DVR

n,k in the context of analysis of neuroscience data.

1.3 Acknowledgements

We thank Henry Adams for bringing his paper [AA17] to our attention. The ideas contained
therein were helpful in proving some of the results of Section 5.3.

We acknowledge funding from these sources: NSF AF 1526513, NSF DMS 1723003, NSF

CCF 1740761, and and NSF CCF 1839358.

11

2 Background

For us, M and Mﬁn will denote, respectively, the category of compact and ﬁnite metric
spaces. The morphisms in both categories will be 1-Lipschitz maps, that is, functions ϕ :
X → Y such that dY (ϕ(x), ϕ(x(cid:48))) ≤ dX(x, x(cid:48)) for all (X, dX), (Y, dY ) in M or Mﬁn. We say
that two metric spaces are isometric if there exists a surjective isometry ϕ : X → Y , i.e. a
map such that dY (ϕ(x), ϕ(x(cid:48))) = dX(x, x(cid:48)) for all x, x(cid:48) ∈ X.

2.1 Metric geometry

In this section, we deﬁne the tools that we’ll use to quantitatively compare metric spaces
[BBI01].

Deﬁnition 2.1. For any subset A of a metric space X, its diameter is diamX(A) :=
supa,a(cid:48)∈A dX(a, a(cid:48)), and its radius is radX(A) := inf p∈X supa∈A dX(p, a). Note that radX(A) ≤
diamX(A). The separation of X is sep(X) := inf x(cid:54)=x(cid:48) dX(x, x(cid:48)).

Deﬁnition 2.2 (Hausdorﬀ distance). Let A, B be subsets of a compact metric space (X, dX).
The Hausdorﬀ distance between A and B is deﬁned as

dX
H(A, B) := inf {ε > 0 | A ⊂ Bε and B ⊂ Aε} ,

where Aε := {x ∈ X | inf a∈A dX(x, a) < ε} is the ε-thickening of A.
H(A, B) = 0 if, and only if their closures are equal: ¯A = ¯B.
dX

It is known that

We will use an alternative deﬁnition that is useful for calculations, but is not standard

in the literature. It relies on the concept of a correspondence.

Deﬁnition 2.3. A correspondence between two sets X and Y is a set R ⊂ X × Y such
that π1(R) = X and π2(R) = Y , where πi are projections. We will denote the set of all
correspondences between X and Y as R(X, Y ).

Deﬁnition 2.4 (Proposition 2.1 of [M´em11]). For any compact metric space (X, dX) and
any A, B ⊂ X closed,

dX
H(A, B) := inf

R∈R(A,B)

sup
(a,b)∈R

dX(a, b).

The standard method for comparing two metric spaces is a generalization of the Hausdorﬀ

distance.

Deﬁnition 2.5. For any correspondence R between (X, dX), (Y, dY ) ∈ M, we deﬁne its
distortion as

dis(R) := max {|dX(x, x(cid:48)) − dY (y, y(cid:48))| : (x, y), (x(cid:48), y(cid:48)) ∈ R} .

Then the Gromov-Hausdorﬀ distance between X and Y is deﬁned as

dGH(X, Y ) :=

1
2

inf
R∈R(X,Y )

dis(R).

12

2.2 Metric measure spaces

To model the situation in which points are endowed with a notion of weight (signaling
their trustworthiness), we will also consider ﬁnite metric spaces enriched with probability
measures [M´em11]. Recall that the support supp(ν) of a Borel measure ν deﬁned on a
topological space Z is deﬁned as the minimal closed set Z0 such that ν(Z \ Z0) = 0.
If
ϕ : Z → X is a measurable map from a measure space (Z, ΣZ, ν) into the measurable space
(X, ΣX), then the pushforward measure of ν induced by ϕ is the measure ϕ#ν on X deﬁned
by ϕ#ν(A) = ν(ϕ−1(A)) for all A ∈ ΣX.

Deﬁnition 2.6. A metric measure space is a triple (X, dX, µX) where (X, dX) is a compact
metric space and µX is a Borel probability measure on X with full support, i.e. supp(µ) =
X. Two mm-spaces (X, dX, µX) and (Y, dY , µY ) are isomorphic if there exists an isometry
ϕ : X → Y such that ϕ#µX = µY . We deﬁne the category of mm-spaces Mw, where
the objects are mm-spaces and the morphisms are 1-Lipschitz maps ϕ : X → Y such that
ϕ#µX = µY .

Many tools in metric geometry have been adapted to study mm-spaces. Our ﬁrst step is

the following deﬁnition.

Deﬁnition 2.7. Given two measure spaces (X, ΣX, µX) and (Y, ΣY , µY ), a coupling between
µX and µY is a measure µ on X × Y such that µ(A × Y ) = µX(A) and µ(X × B) = µY (B)
for all measurable A ∈ ΣX and B ∈ ΣY (in other words, (π1)#µ = µX and (π2)#µ = µY ).
We denote the set of couplings between µX and µY as M(µX, µY ).

Remark 2.8 (The support of a coupling is a correspondence). Notice that, since µX is
fully supported and X is ﬁnite, then µ(π−1
1 (x)) = µX({x}) (cid:54)= 0 for any ﬁxed coupling
µ ∈ M(µX, µY ). Thus, the set π−1
1 (x) ∩ supp(µ) is non-empty for every x ∈ X. The same
argument on Y shows that supp(µ) is a correspondence between X and Y . In that regard,
couplings are a probabilistic version of correspondences.

There is also a version of the diameter that considers the measure. The p-diameter of a

subset A of an mm-space X is deﬁned as

diamX,p(A) :=

(cid:18)(cid:90) (cid:90)

A×A

(dX(a, a(cid:48)))pµX(a)µX(a(cid:48))

(cid:19)1/p

for 1 ≤ p < ∞, and set diamX,∞(A) := diamX(A). We use these concepts to deﬁne a
probabilistic version of the Hausdorﬀ distance.

Deﬁnition 2.9. Given two probability measures α, β on (Z, dZ) and p ≥ 1, the Wasserstein
distance of order p is deﬁned as [Vil03]:

dZ
W,p(α, β) := inf

µ∈M(α,β)

diamZ,p(supp(µ)).

In the same spirit, there is a generalization of Gromov-Hausdorﬀ.

13

Deﬁnition 2.10. Given two mm-spaces (X, dX, µX) and (Y, dY , µY ), p ≥ 1, and µ ∈
M(µX, µY ), we deﬁne the p-distortion of µ as:

(cid:18)(cid:90) (cid:90)

disp(µ) :=

|dX(x, x(cid:48)) − dY (y, y(cid:48))|pµ(dx × dy)µ(dx(cid:48) × dy(cid:48))

(cid:19)1/p

.

For p = ∞ we set

dis∞(µ) := dis(supp(µ)).

Then the Gromov-Wasserstein distance of order p ∈ [1, ∞] between X and Y is deﬁned

as [M´em11]:

dGW,p(X, Y ) :=

1
2

inf
µ∈M(µX ,µY )

disp(µ).

(3)

Remark 2.11. It turns out that, for each p ∈ [1, ∞], dGW,p deﬁnes a legitimate metric on
Mw modulo isomorphism of mm-spaces [M´em11].

2.3 Simplicial complexes

Deﬁnition 2.12. Let V be a set. An abstract simplicial complex K with vertex set V is a
collection of ﬁnite subsets of V such that if σ ∈ K, then every τ ⊂ σ is also in K. We also
use K to denote its geometric realization.
A set σ ∈ K is called a k-face if |σ| = k + 1. A simplicial map f : K1 → K2 is a set map
f : V1 → V2 between the vertex sets of K1 and K2 such that if σ ∈ K1, then f (σ) ∈ K2.

Here we deﬁne the simplicial complexes that we will focus on.

Deﬁnition 2.13. Let (X, dX) ∈ M and r ≥ 0. The Vietoris-Rips complex of X at scale r
is the simplicial complex

VRr(X) := {σ ⊂ X ﬁnite : diamX(σ) ≤ r} .

Deﬁnition 2.14. Fix n ≥ 1. Let ei = (0, . . . , 1, . . . , 0) be the i-th standard basis vector in
Rn and V = {±e1, . . . , ±en}. Let Bn be the collection of subsets σ ⊂ V that don’t contain
both ei and −ei. This simplicial complex is called the n-th cross-polytope.

2.4 Persistent homology

The idea behind persistent homology is to construct a ﬁltration of topological spaces (Xt)t>0
and compute the homology at each time t. We will adopt deﬁnitions from [M´em17].

Deﬁnition 2.15. A ﬁltration on a ﬁnite set X is a function FX : pow(X) → R such
that FX(σ) ≤ FX(τ ) whenever σ ⊂ τ , and we call the pair (X, FX) a ﬁltered set. F will
denote the category of ﬁnite ﬁltered sets, where objects are pairs (X, FX) and the morphisms
ϕ : (X, FX) → (Y, FY ) are set maps ϕ : X → Y such that FY (ϕ(σ)) ≤ FX(σ).

14

−e1

e1

−e1

e2

−e2

e3

−e1

e1

−e2

e2

e1

−e3

Figure 6: From left to right: B1, B2, B3 (there is no edge between the vertices of B1).

Deﬁnition 2.16. A ﬁltration functor is any functor F : Mﬁn → F.

Remark 2.17. Given two ﬁnite pseudometric spaces (X, dX) and (Y, dY ), let (X, FX) =
F(X, dX) and (Y, FY ) = F(Y, dY ). Functoriality of F means that for any 1-Lipschitz map
ϕ : X → Y , we have FY (ϕ(σ)) ≤ FX(σ) for all σ ⊂ X.
In particular, if X and Y are
isometric, FX = FY as ﬁltrations.

X (σ) = diam(σ) for σ ⊂ X.

Deﬁnition 2.18. Given (X, dX) ∈ Mﬁn, deﬁne the Vietoris-Rips ﬁltration F VR
X by setting
F VR
It is straightforward to check that this construction is
functorial, so we deﬁne the Vietoris-Rips ﬁltration functor FVR : Mﬁn → F by (X, dX) (cid:55)→
(X, F VR

X ).

Our pipeline for persistent homology starts with a ﬁltration functor F. Given a ﬁnite
X) = F(X, dX). For every r > 0, we construct the
X(σ) ≤ r(cid:9)1, and we get a nested family of simplicial

(pseudo)metric space (X, dX), let (X, F F
simplicial complex Lr := (cid:8)σ ⊂ X : F F
complexes

LF(X) := {Lr0 ⊂ Lr1 ⊂ Lr2 ⊂ · · · ⊂ Lrm}
where range(FX) = {r0 < r1 < r2 < · · · < rm}, and each Lri is, by construction, ﬁnite. Tak-
ing homology with ﬁeld coeﬃcents Hk(·, F) of the family above gives a sequence of vector
spaces and linear maps

PHF

k(X) :=

(cid:110)

Vr0

v0−→ Vr1

v1−→ Vr2

v2−→ · · ·

vm−1−−−→ Vrm

(cid:111)

which is called a persistence vector space. Note that each Vri is ﬁnite dimensional in our
setting.

One particular type of persistent vector spaces are interval modules

I[b, d) := {0 → · · · → 0 → F → · · · → F → 0 → · · · → 0},

where the ﬁrst F appears at time b, and the last one, at time d. The maps between diﬀerent
occurrences of F are identities, whereas the other maps are 0. Persistence vector spaces

1Notice that if F = FVR, then Lr = VRr(X).

15

admit a classiﬁcation up to isomorphism wherein a persistence vector space V is decomposed
as a sum of interval modules V = (cid:76)
I[bα, dα) [CdS10]. These collections of intervals
are sometimes referred to as barcodes or persistence diagrams, depending on the graphical
representation that is adopted [EH10]. We prefer the term persistence diagrams in the
present work, and denote by D the collection of all ﬁnite persistence diagrams. An element
D ∈ D is multiset of points of the form

α∈A

D = {(bα, dα), 0 ≤ bα < dα, α ∈ A}

for some (ﬁnite) index set A. In short, starting with any ﬁltration functor F, we assign a
persistence diagram to (X, dX) via the composition dgmF

k : Mﬁn → D deﬁned by

(X, dX) (cid:55)→ (X, F F

X) (cid:55)→ LF(X) (cid:55)→ PHF

k(X) (cid:55)→ dgmF

k(X).

Notice that we could have also started with just a ﬁltered set (X, FX), instead of a (pseudo)metric
space, and obtain a persistence diagram. We will denote that diagram with dgmk(X, FX).

2.5 Stability

The most useful ﬁltration functors enjoy a property known as stability. Intuitively, it means
that the persistence diagrams they produce are resistant to noise: if the input (pseudo)metric
space is perturbed, the persistence diagram will not change too much. In this section, we will
describe the metrics on ﬁltrations and persistence diagrams that we use to measure stability.
We start with the bottleneck distance between persistence diagrams D1, D2 ∈ D. Deﬁne
the persistence of a point P = (x, y) with x ≤ y as pers(P ) := y − x. The total persistence
of a persistence diagram D ∈ D is the maximal persistence of its points:

pers(D) := max
P ∈D

pers(P ).

Let D1 = {Pα}α∈A1
be two persistence diagrams indexed over the ﬁnite
index sets A1 and A2 respectively. Consider subsets Bi ⊆ Ai with |B1| = |B2| together with
a bijection ϕ : B1 → B2. Deﬁne

and D2 = {Qα}α∈A2

J(ϕ) := max

(cid:18)

max
β∈B1

(cid:107)Pβ − Qϕ(β)(cid:107)∞, max

α∈A1\B1

1
2

pers(Pα), max

α∈A2\B2

(cid:19)

pers(Qα)

.

1
2

Deﬁnition 2.19 ([EH10]). The bottleneck distance between D1, D2 ∈ D is

dB(D1, D2) := min

(B1,B2,ϕ)

J(ϕ),

where (B1, B2, ϕ) ranges over all B1 ⊂ A1, B2 ⊂ A2, and bijections ϕ : B1 → B2. Note that
for any D ∈ D and any one-point diagram Q = {(x, x)}, dB(D, Q) = 1

2pers(D).

16

We can also measure the diﬀerence between two ﬁnite ﬁltered sets (X, FX) and (Y, dY ).
The idea is to pullback and compare the ﬁltrations in a common set Z. To that end, we deﬁne
a tripod, which is a triplet (Z, ϕX, ϕY ) consisting of a ﬁnite set Z and a pair of surjective
maps ϕX : Z → X and ϕY : Z → Y called parametrizations.

Z

ϕX

ϕY

X

Y

The pullback ﬁltration ϕ∗
τ ⊂ Z (similarly for ϕ∗

Y FY ).

XFX on Z is naturally deﬁned as ϕ∗

XFX(τ ) = FX(ϕ(τ )) for every

Deﬁnition 2.20. The ﬁltration distance dF is

dF ((X, FX), (Y, FY )) := inf

(Z,ϕX ,ϕY )

(cid:107)ϕ∗

XFX − ϕ∗

Y FY (cid:107)(cid:96)∞(pow(Z))

= inf

(Z,ϕX ,ϕY )

max
τ ∈pow(Z)

|ϕ∗

XFX(τ ) − ϕ∗

Y FY (τ )|,

where the inﬁmum ranges over all tripods (Z, ϕX, ϕY ).

In other words, we pullback the ﬁltrations FX and FY to a common set Z, where we can
compare them using the (cid:96)∞ norm on pow(Z). The ﬁltration distance is the inﬁmum of this
quantity over all choices of tripods (Z, ϕX, ϕY ).

Proposition 2.21 ([M´em17]). dF is a pseudometric on F.

With these tools at hand, we deﬁne what we mean by stable functors.

Deﬁnition 2.22 (Stable ﬁltration functors). For a given ﬁltration functor F, deﬁne its
Lipschitz constant L(F) as the inﬁmal L > 0 such that

dF (F(X), F(Y )) ≤ L · dGH(X, Y )

for all X, Y ∈ Mﬁn. If L(F) < ∞, we say that F is stable. In this case, we also say that F is
L-stable for all constants L ≥ L(F).

[M´em17] proved the following theorem and its corollary.

Theorem 2.23. For all ﬁnite ﬁltered spaces (X, FX), (Y, FY ) and all k ∈ N, we have

dB(dgmk(X, FX), dgmk(Y, FY )) ≤ dF ((X, FX), (Y, FY )).

Corollary 2.24. For any stable ﬁltration functor F,

dB(dgmF

k(X), dgmF

k(Y )) ≤ L(F) · dGH(X, Y )

for all X, Y ∈ Mﬁn and k ∈ N.

17

Example 2.25. The Lipschitz constant of FVR is 2. Pick any pair of ﬁnite (pseudo)metric
spaces X and Y and let η > 0 and R ∈ R(X, Y ) be such that dis(R) < 2η. Consider
the joint parametrization Z = R, ϕX = π1 and ϕY = π2 of X and Y . For any τ ⊂ Z,
dX(ϕX(z, z(cid:48))) ≤ dY (ϕY (z, z(cid:48))) + 2η. Taking maxima over z, z(cid:48) ∈ Z yields diamX(ϕX(τ )) ≤
diamY (ϕY (τ )) + 2η, and the symmetric argument gives |F VR
Y (ϕY (τ ))| ≤ 2η.
This implies that dF (FVR(X), FVR(Y )) ≤ 2η and the claim follows by taking η → dGH(X, Y ).
The constant 2 is tight because X = (∗, 0) and Y = ∆2(1) satisfy dF (FVR(X), FVR(Y )) =

X (ϕX(τ )) − F VR

2dGH(X, Y ).

3 Curvature sets and Persistence diagrams

Given a compact metric space (X, dX), Gromov identiﬁed a class of full invariants called
curvature sets [Gro07]. Intuitively, the n-th curvature set contains the metric information of
all possible samples of n points from X. In this section, we deﬁne persistence sets, an analog
construction that captures the persistent homology of all n-point samples of X. We start by
recalling Gromov’s deﬁnition with some examples, and an analogue of the Gromov-Hausdorﬀ
distance in terms of curvature sets. We then deﬁne persistence sets and study their stability
with respect to this modiﬁed Gromov-Hausdorﬀ distance. Additionally, when dealing with
metric measure spaces, we can deﬁne measures on curvature and persistence sets via the
pushforward of the product measure on X n. We also study these measures and prove an
appropriate notion of stability.

Deﬁnition 3.1. Let (X, dX) be a metric space. Given a positive integer n, let Ψ(n)
X :
X n → Rn×n be the map that sends an n-tuple (x1, . . . , xn) to the distance matrix M , where
Mij = dX(xi, xj). The n-th curvature set of X is Kn(X) := im(Ψ(n)
X ), the collection of all
distance matrices of n points from X.

Remark 3.2 (Functoriality of curvature sets). Observe curvature sets are functorial in the
sense that if X is isometrically embedded in Y , then Kn(X) ⊂ Kn(Y ).

Example 3.3. K2(X) is the set of distances of X. If X is geodesic, K2(X) = [0, diam(X)].

Example 3.4. Let X = {p, q} be a two point metric space with dX(p, q) = δ. Then

(cid:110)

K3(X) =

=

Ψ(3)

X (p, p, q), Ψ(3)
X (p, p, p), Ψ(3)
X (q, q, p), Ψ(3)
X (q, q, q), Ψ(3)
(cid:16) 0 δ 0
(cid:17)
(cid:16) 0 0 δ
0 0 δ
δ 0 δ
0 δ 0
δ δ 0

X (p, q, p), Ψ(3)
X (q, p, q), Ψ(3)
(cid:17)(cid:111)
(cid:16) 0 δ δ
δ 0 0
δ 0 0

Ψ(3)
(cid:110)(cid:16) 0 0 0
0 0 0
0 0 0

(cid:17)

(cid:17)

,

.

,

,

X (q, p, p),
(cid:111)

X (p, q, q)

For n ≥ 2 and 0 < k < n, let x1 = · · · = xk = p and xk+1 = · · · = xn = q. Deﬁne

Mk(δ) := Ψ(n)

X (x1, . . . , xn) =

0k×k

δ · 1k×(n−k)
δ · 1(n−k)×k 0(n−k)×(n−k)

(cid:19)

,

(cid:18)

18

If we make another choice of
where 1r×s is the r × s matrix with all entries equal to 1.
x1, . . . , xn, the resulting distance matrix will change only by a permutation of its rows and
X (x1, . . . , xn) = ΠT ·Mk(δ)·Π, for some permutation
columns. Thus, if we deﬁne M Π
matrix Π ∈ Sn, then

k (δ) := Ψ(n)

Kn(X) = {0n×n} ∪ (cid:8)M Π

k (δ) : 0 < k < n and Π ∈ Sn

(cid:9) .

Example 3.5. In this example we describe K3(S1), where S1 = [0, 2π]/(0 ∼ 2π) is equipped
with the geodesic metric. Depending on the position of x1, x2, x3, we need two cases. If the
three points are not contained in the same semicircle, then d12 + d23 + d31 = 2π. If they are,
then there exists a point, say x2, that lies in the shortest path joining the other two so that
d13 = d12 + d23 ≤ π. The other possibilities are d12 = d13 + d32 and d23 = d21 + d13.
Since M is symmetric, we only need 3 entries to characterize and plot K3(S1) (see Figure
3.5). If we label x = d12, y = d23 and z = d31, then K3(S1) is the boundary of the 3-simplex
with vertices (0, 0, 0), (π, π, 0), (π, 0, π), and (0, π, π). Each of the cases in the previous
paragraph corresponds to a face of this simplex.

z

y

x

Figure 7: The curvature set K3(S1).

As we mentioned earlier, curvature sets are a full invariant of compact metric spaces,
which means that X (cid:39) Y if, and only if, Kn(X) = Kn(Y ) for all n ≥ 1. It makes sense to
quantitatively measure the diﬀerence between two metric spaces by comparing their curva-
ture sets. The following deﬁnition of [M´em12b] does what we need.

Deﬁnition 3.6 ([M´em12b]). The modiﬁed Gromov-Hausdorﬀ distance between X, Y ∈ M
is

(cid:98)dGH(X, Y ) :=

dH(Kn(X), Kn(Y ))

sup
n∈N

(4)

1
2

Here dH denotes the Hausdorﬀ distance on Rn×n with (cid:96)∞ distance.

Notice that (cid:98)dGH(X, Y ) ≤ dGH(X, Y ). A beneﬁt of (cid:98)dGH when compared to the standard
Gromov-Hausdorﬀ distance is that the computation of the latter leads in general to NP-hard
problems [Sch17], whereas computing the lower bound in the equation above on certain val-
ues of n leads to polynomial time problems. In [M´em12b] it is argued that work of Peter

19

Olver [Olv01] and Boutin and Kemper [BK04b] leads to identifying rich classes of shapes
where these lower bounds permit full discrimination.

The analogous deﬁnitions for mm-spaces are the following.

Deﬁnition 3.7. Let (X, dX, µX) be an mm-space. The n-th curvature measure of X is
deﬁned as

µn(X) :=

(cid:17)

(cid:16)

Ψ(n)
X

µ⊗n
X .

#

We also deﬁne the modiﬁed Gromov-Wasserstein distance between X, Y ∈ Mw as

(cid:98)dGW,p(X, Y ) :=

1
2

sup
n∈N

dW,p(µn(X), µn(Y )),

where dW,p is the p-Wasserstein distance [Vil03] on P1(Rn×n), and Rn×n is equipped with
the (cid:96)∞ distance.

Clearly, supp(µn(X)) = Kn(X) for all n ∈ N, and similarly to equation (4), [MNO21]

proves that (cid:98)dGW,p(X, Y ) ≤ dGW,p(X, Y ).

Remark 3.8 (Interpretation as “motifs”). In network science [MP20], it is of interest to
identify substructures of a dataset (network) X which appear with high frequency. The
interpretation of the deﬁnitions above is that the curvature sets Kn(X) for diﬀerent n ∈ N
capture the information of those substructures whose cardinality is at most n, whereas the
curvature measures µn(X) capture their frequency of occurrence.

3.1 F-persistence sets

The idea behind curvature sets to study a metric space by taking the distance matrix of a
sample of n points. This is the inspiration for the next deﬁnition: we want to study the
persistence of a compact metric space X by looking at the persistence diagrams of samples
with n points.

Deﬁnition 3.9. Fix n ≥ 1 and k ≥ 0. Let (X, dX) ∈ M and F : Mﬁn → F be any ﬁltration
functor. The (n,k)-F persistence set of X is

DF

n,k(X) := (cid:8)dgmF

k(X (cid:48)) : X (cid:48) ⊂ X such that |X (cid:48)| ≤ n(cid:9) ,

and the total F-persistence set of X is

DF

n(X) := (cid:8)DF

n,k(X)(cid:9)

.

k≥0

Remark 3.10 (Functoriality of persistence sets). Notice that, similarly to curvature sets (Cf.
Remark 3.2), persistence sets are functorial. If X (cid:44)→ Y isometrically, then Kn(X) ⊂ Kn(Y ),
and consequently, DF

n,k(Y ) for all n, k ∈ N.

n,k(X) ⊂ DF

20

Remark 3.11. Recall that ﬁltration functors are by deﬁnition isometry invariants (see 2.17).
This means that we can deﬁne the F-persistence diagram of a distance matrix as the diagram
of the underlying pseudometric space. More explicitly, let (X, dX) ∈ M, and take X ∈ X n
and M = Ψ(n)
i=1{pi(X)}, where each pi is the projection
to the i-th coordinate. Notice that dX(xi, xj) = Mij. We deﬁne dgmF
k(X (cid:48)).
n,k(X) as the image of the map dgmF
For that reason, we can view the persistence set DF
k :
Kn(X) → D.

X (X). Deﬁne xi = pi(X) and X (cid:48) = (cid:83)n

k(M ) := dgmF

Ψ(n)
X

X n

Kn(X)

dgmF
k

DF

n,k(X)

⊂

D

X

M

dgmF

k(X (cid:48)).

Persistence sets inherit the stability of the ﬁltration functor. Given their deﬁnition in
terms of curvature sets, the modiﬁed Gromov-Hausdorﬀ distance is a natural metric to use.

Theorem 3.12. Let F be a stable ﬁltration functor with Lipschitz constant L(F). Then for
all compact metric spaces X and Y , n ≥ 1, and k ≥ 0, one has

H(DF
dD

n,k(X), DF

n,k(Y )) ≤ L(F) · (cid:98)dGH(X, Y ),

where dD

H(DF

H denotes the Hausdorﬀ distance between subsets of D.
n,k(X), DF

n,k(Y )) ≤ 1

Proof. We will show that dD
L(F) · (cid:98)dGH(X, Y ) is an upper bound for the right-hand side, the theorem will follow.

2L(F)·dH(Kn(X), Kn(Y )) for all n. Since

X (X) = M1 and D1 = dgmF

Assume dH(Kn(X), Kn(Y )) < η. Pick any D1 ∈ DF

n,k(X). Let X = (x1, . . . , xn) ∈ X n
such that Ψ(n)
k(M1). From the assumption on dH(Kn(X), Kn(Y )),
there exists M2 ∈ Kn(Y ) such that (cid:107)M1 − M2(cid:107)∞ < η. As before, let Y = (y1, . . . , yn) be such
k(M2). Let X (cid:48) = (cid:83)n
that M2 = Ψ(n)
i=1{pi(yi)}.
The deﬁnition of dgmF
k(X (cid:48)) and
D2 = dgmF

i=1{pi(xi)} and Y (cid:48) = (cid:83)n
k on curvature sets (see Remark 3.11) states that D1 = dgmF

Y (Y) and D2 = dgmF

k(Y (cid:48)), so by Corollary 2.24,

dB(D1, D2) ≤ L(F) · dGH(X (cid:48), Y (cid:48)).

dGH(X (cid:48), Y (cid:48)) ≤

By taking the correspondence R = {(xi, yi) ∈ X (cid:48) × Y (cid:48) : i = 1, . . . , n}, we can bound the
dGH(X (cid:48), Y (cid:48)) term by
1
2

1
2
In summary, for every D1 ∈ DF
n,k(X), we can ﬁnd D2 ∈ DF
n,k(Y ) such that dB(D1, D2) ≤
L(F) · dGH(X (cid:48), Y (cid:48)) < L(F) · η/2, and the same argument works when swapping X and Y .
Thus, we let η → dH(Kn(X), Kn(Y )) to conclude

|dX(xi, xj) − dY (yi, yj)| =

(cid:107)M1 − M2(cid:107)∞ <

max
i,j=1,...,n

dis(R) =

η
2

1
2

.

dB(D1, D2) ≤

1
2

L(F) · dH(Kn(X), Kn(Y )),

as desired.

21

Remark 3.13 (Tightness of the bound). Let X = (∗, 0) and Y = ∆2(δ) with δ > 0. Then
dgmVR
0 (Y ) = {[0, δ), [0, ∞)}. Thus,

0 (X) = {[0, ∞)} and dgmVR

H(DVR
dD

2,0 (X), DVR

2,0 (Y )) = dB(dgmVR

0 (X), dgmVR

0 (Y )) = pers(0, δ) = δ.

0 0 ), ( 0 δ

On the other hand, we have that (cid:98)dGH(X, Y ) = δ
{( 0 0
upper bound is given by dGH(X, Y ) = δ
This proves tightness because Example 2.25 established that L(FVR) = 2.

δ 0 )}. This gives a lower bound (cid:98)dGH(X, Y ) ≥ 1

2dH(K2(X), K2(Y )) = δ
2dD

2. Notice that K2(X) = {( 0 0

2. Thus, (cid:98)dGH(X, Y ) = δ

0 0 )} and K2(Y ) =
2, while the
2 (Y )).

2 (X), DVR

H(DVR

2 = 1

Remark 3.14 (Persistent sets are isometry invariant). Note that the persistent sets
DF
n,k are themselves isometry invariants of metric spaces. As such, they can be regarded,
in principle, as signatures that can be used to gain insight into datasets or to discriminate
between diﬀerent shapes.

Remark 3.15 (Computational cost). One thing to keep in mind is that computing the
single diagram dgmVR
1 (X) when X has, say, 1000 points is likely to be much more com-
putationally expensive than computing 10,000 VR one-dimensional persistence diagrams
obtained by randomly sampling points from X, i.e. approximating DVR
n,1 (X) with small n.
More speciﬁcally, computing the degree k VR persistence diagram of a ﬁnite metric space
with N points requires knowledge of the k + 1 skeleton of the full simplex over X, each of
which is a subset of size k + 2, so the complexity is c(N, k) ≈ O(N ω(k+2)) [MMS11]. Here,
we are assuming that multiplication of m × m matrices has cost2 O(mω). Since there are
N n possible n-tuples of points of X, the complexity of computing DVR
n,k(X) is bounded by
O(c(n, k) · N n) ≈ O(nω(k+2) N n). For example, when n = 4 and k = 1, the comparison boils
down to O(N 3ω) ≈ O(N 7.11) versus O(N 4). When k = 2 and n = 6 one needs to compare
O(N 9.49) versus O(N 6).

Another point which lends ﬂexibility to the approximate computation of persistence sets
is that one can actually easily cap the number of n-tuples to be considered by a parameter
Mmax, and this case the complexity associated to estimating DVR
n,k will be O(nω(k+2)Mmax).
One can then easily select random n-tuples from the dataset up to an upper limit Mmax –
this is the pragmatic approach we have followed in the experiments reported in this paper
and in the code on our github repository [GM21].

Furthermore, these calculations are of course eminently pararelizable. Furthermore, for
n,k(X) are substantially
k (X) would require since the boundary matrices

n (cid:28) N , the memory requirements for computing an estimate to DVR
more modest than what computing dgmVR
that one needs to store in memory are several orders of magnitude smaller.

Finally, if one is only interested in the principal persistence set, a much faster geometric

algorithm is available, cf. Remark 4.6.

See our github repository [GM21] for a parfor based Matlab implementation.

2Currently, the best known constant is ω ≈ 2.37286. [AW20]

22

3.2 F-Persistence measures

Much in the same way as curvature measures deﬁne probability measures supported over
curvature sets, one can consider measures supported on D, called persistence measures, which
encode the way mass is distributed on persistence sets.

Deﬁnition 3.16. For each ﬁltration functor F, integers n ≥ 1, k ≥ 0, and X ∈ Mw, deﬁne
the (n, k)-persistence measure of X as (cf. Def. 3.7)
(cid:1)
# µn(X).

n,k(X) := (cid:0)dgmF

UF

k

We also have a stability result for these measures in terms of the Gromov-Wasserstein

distance.

Theorem 3.17. Let F be a given ﬁltration functor with Lipschitz constant L(F). For all
X, Y ∈ Mw and integers n ≥ 1 and k ≥ 0,

W,p(UF
dD

n,k(X), UF

n,k(Y )) ≤

L(F)
2

· dW,p(µn(X), µn(Y ))

and, in consequence,

W,p(UF
dD

n,k(X), UF

n,k(Y )) ≤ L(F) · (cid:98)dGW,p(X, Y ).

Proof. This proof follows roughly the same outline as that of (3.12). Let η > dW,p(µn(X), µn(Y )).
Choose a coupling µ ∈ M(µn(X), µn(Y )) such that

[dW,p(µn(X), µn(Y ))]p ≤

(cid:90) (cid:90)

(cid:107)M − M (cid:48)(cid:107)p

∞µ(dM × dM (cid:48)) < ηp,

Kn(X)×Kn(Y )

where (cid:107) · (cid:107)∞ denotes the (cid:96)∞ norm on Rn×n. It’s a basic fact of measure theory that the
pushforward ν = (dgmF
k)#µ of the coupling µ is a coupling of the pushforwards
(dgmF
k)#µn(X) = UF
n,k(Y ). Thus, a change of variables gives

k × dgmF
n,k(X) and (dgmF

k)#µn(Y ) = UF

(cid:2)dD

W,p(UF

n,k(X), UF

n,k(Y ))(cid:3)p

(cid:90) (cid:90)

(cid:90) (cid:90)

≤

=

[dB(D, D(cid:48))]pν(dD × dD(cid:48))

DF

n,k(X)×DF

n,k(Y )

(cid:2)dB(dgmF

k(M ), dgmF

k(M (cid:48)))(cid:3)p

µ(dM × dM (cid:48)).

Kn(X)×Kn(Y )

Recall from the proof of Theorem 3.12 that dB(dgmF

k(M ), dgmF

k(M (cid:48))) ≤ L(F)

2 (cid:107)M − M (cid:48)(cid:107)∞.

Thus, the previous integral is bounded above by

(cid:90) (cid:90)

Kn(X)×Kn(Y )

(cid:20)L(F)
2

(cid:21)p

(cid:107)M − M (cid:48)(cid:107)∞

µ(dM × dM (cid:48))

(cid:107)M − M (cid:48)(cid:107)p

∞ µ(dM × dM (cid:48))

Kn(X)×Kn(Y )

=

<

(cid:18) L(F)
2
(cid:18) L(F)
2

(cid:19)p (cid:90) (cid:90)

(cid:19)p

ηp.

23

Taking the p-th root and letting η (cid:38) dW,p(µn(X), µn(Y )) gives

W,p(UF
dD

n,k(X), UF

n,k(Y )) ≤

L(F)
2

· dW,p(µn(X), µn(Y )) ≤ L(F) · (cid:98)dGW,p(X, Y ).

4 VR-persistence sets

From this point on, we focus on the Vietoris-Rips persistence sets DVR
n,k with n = 2k + 2. The
reason to do so is Theorem 4.4, which states that the k-dimensional persistence diagram of
VR∗(X) is empty if |X| < 2k + 2 and has at most one point if |X| = 2k + 2. What this
means for persistence sets DVR
n,k(X) is that given a ﬁxed k, the ﬁrst interesting choice of n
is n = 2k + 2. We prove this fact in Section 4.1 and then use it to construct a graphical
representation of DVR

2k+2,k(X). Section 4.2 presents computational examples.

4.1 Some properties of Vietoris-Rips complexes

Let X be a ﬁnite metric space with n points. The highest dimensional simplex of VR∗(X)
has dimension n, but even if VR∗(X) contains k-dimensional simplices, it won’t necessarily
produce persistent homology in dimension k. A good example is n = 3 and k = 1. The
only simplicial 1-cycle in a triangle is the union of its three edges. In order for VRr(X) to
contain all three edges, we must have r ≥ dX(xi, xj) for all i (cid:54)= j. However, this condition is
equivalent to r ≥ diam(X), which makes VRr(X) isomorphic to the 2-simplex, a contractible
complex. In other words, either VRr(X) doesn’t contain any 1-cycle (when r < diam(X))
or it is contractible (when r ≥ diam(X)), so the persistence module PHVR
1 (X) is 0. Among
other things, X needs more points to produce persistent homology in dimension 1.

The ﬁrst deﬁnition of this section is inspired by the structure of the cross-polytope Bm;
see Figure 6. Recall that a set σ ⊂ V = {±e1, . . . , ±em} is a face if it doesn’t contain both
ei and −ei. In particular, there is an edge between ei and every other vertex except −ei.
The next deﬁnition tries to emulate this phenomenon in VR∗(X).

Deﬁnition 4.1. Let (X, dX) be a ﬁnite metric space, A ⊂ X, and let x0 ∈ X ﬁxed. Find
x1, x2 ∈ A such that

dX(x0, x1) ≥ dX(x0, x2) ≥ dX(x0, a) for all a ∈ A \ {x1, x2}.

Deﬁne

and

td(x0, A) := dX(x0, x1)

tb(x0, A) := dX(x0, x2).

24

We set vd(x0, A) := x1 if x1 is unique. When A = X and there is no risk of confu-
sion, we will denote tb(x0, X), td(x0, X), and vd(x0, X) simply as tb(x0), td(x0), and vd(x0),
respectively. Also deﬁne

and

tb(X) := max
x∈X

tb(x, X)

td(X) := min
x∈X

td(x, X).

In a few words, td(x) ≥ tb(x) are the two largest distances between x and any other
point of X. The motivation behind these choices is that if r satisﬁes tb(x) ≤ r < td(x),
then VRr(X) contains all edges between x and all other points of X, except for vd(x). If
this holds for all x ∈ X, then VRr(X) is isomorphic to a cross-polytope. Also, note that
td(x) is the radius rad(X) of X, cf. Deﬁnition 2.1. Also note that according to [LMO20,
Proposition 9.6], the death time of any interval in dgm∗(X) is bounded by rad(X).

Of course, as deﬁned above, vd(x) is not unique in general, but it is well deﬁned in the

case that interests us, as we see next.

Lemma 4.2. Let (X, dX) be a ﬁnite metric space and suppose that tb(X) < td(X). Then
vd : X → X is well deﬁned and vd ◦ vd = id.

Proof. Given a point x ∈ X, suppose there exist x1 (cid:54)= x2 ∈ X such that dX(x, x1) =
dX(x, x2) ≥ dX(x, x(cid:48)) for all x(cid:48) ∈ X. Since tb(x) and td(x) are the two largest distances
between x and any x(cid:48) ∈ X, we have tb(x) = td(x). However, this implies td(X) ≤ td(x) =
tb(x) ≤ tb(X), which contradicts the hypothesis tb(X) < td(X). Thus, we have a unique
choice of vd(x) for every x ∈ X.

For the second claim, suppose that v2

d(x) := vd(vd(x)) (cid:54)= x. Since td(vd(x)) is the
largest distance between vd(x) and any other point of X, td(vd(x)) = dX(vd(x), v2
d(x)) ≥
dX(vd(x), x). Hence, the second largest distance tb(vd(x)) is at least dX(x, vd(x)). However,

td(X) ≤ td(x) = dX(x, vd(x)) ≤ tb(vd(x)) ≤ tb(X),

which is, again, a contradiction. Thus, v2

d(x) = x.

Once vd is well deﬁned, we can produce the desired isomorphism between VRr(X) and a

cross-polytope.

Proposition 4.3. Let (X, dX) be a metric space with |X| = n, where n ≥ 2 is even, and
suppose that tb(X) < td(X). Let k = n
2 − 1. Then VRr(X) is isomorphic, as a simplicial
complex, to the cross-polytope Bk+1 for all r ∈ [tb(X), td(X)).

i , x−

i } such that x−

Proof. Let r ∈ [tb(X), td(X)). Lemma 4.2 implies that we can partition X into k + 1 pairs
{x+
i , for
ε = ±1. Both cross-polytopes and Vietoris-Rips complexes are ﬂag complexes, so it’s enough
to verify that f induces an isomorphism of their 1-skeleta. Indeed, for any i = 1, . . . , k + 1,
ε = ±1, and x (cid:54)= x−ε
i , x) ≤ tb(xε
i ) =

i ), so deﬁne f : {±e1, . . . , ±ek} → X as f (ε · ei) = xε

i ) ≤ tb(X) ≤ r < td(X) ≤ td(xε

, we have dX(xε

i = vd(x+

i

25

i ). Thus, VRr(X) contains the edges [xε

i , x−
dX(x+
f (ε · ei) = xε
[ei, −ei] to the non-simplex [x+

i , x−
i ].

i , f sends the simplices [ε · ei, v] to the simplices [xε

i , x] for x (cid:54)= x−ε
i ]. Since
i
i , f (v)] and the non-simplex

, but not [x+

i , x−

A consequence of the previous proposition is that Hk(VRr(X)) (cid:39) Hk(Bk+1) = F for
r ∈ [tb(X), td(X)). It turns out that n = 2k + 2 is the minimum number of points that X
needs to have in order to produce persistent homology in dimension k, which is what we
prove next. The proof is inspired by the use of the Mayer-Vietoris sequence to ﬁnd Hk(Sk) by
splitting Sk into two hemispheres that intersect in an equator Sk−1. Since the hemispheres are
contractible, the Mayer-Vietoris sequence produces an isomorphism Hk(Sk) (cid:39) Hk−1(Sk−1).
We emulate this by splitting VRr(X) into two halves which, under the right circumstances,
are contractible and ﬁnd the k-th persistent homology of VR∗(X) in terms of the (k − 1)-
dimensional persistent homology of a subcomplex.

Two related results appear in [Kah09, Ada14, CCR13]. Case (1) in our Theorem 4.4 is a
consequence of Lemma 5.3 in [Kah09] and Proposition 5.4 in [Ada14], and the decomposition
VRr(X) = VRr(B0)∪VRr(B1) (see the proof for the deﬁnition of B0 and B1) already appears
as Proposition 2.2 in the appendix of [CCR13]. The novelty in the next Theorem is the
characterization of the persistent module PHVR

k (X) in terms of tb(X) and td(X).

Theorem 4.4. Let (X, dX) be a metric space with n points. Here, PHVR
reduced homology of the VR-complex: (cid:101)Hk(VR∗(X)). Then:

k (X) denotes the

1. For all integers k > n

2. If n is even and k = n

k (X) = 0.

2 − 1, PHVR
2 − 1, then

PHVR

k (X) =




I[tb(X), td(X))

if and only if tb(X) < td(X),



0

otherwise.

Example 4.5.

Let us consider the case k = 1 and n = 4. Let X = {x1, x2, x3, x4} as shown in Figure
1 (X) to be non-zero, VRr(X) has to contain all the “outer edges” and

8. In order for PHVR
none of the “diagonals”. That is, there exists r > 0 such that

d12, d23, d34, d41 ≤ r < d13, d24.

In other words, we require that max(d12, d23, d34, d41) < min(d13, d24) and, in that case,
PHVR

1 (X) = [max(d12, d23, d34, d41), min(d13, d24)). In our language, we have:

td
tb
x1 max(d41, d12) d13
x2 max(d12, d23) d24
x3 max(d23, d34) d13
x4 max(d34, d41) d24

26

x1

d12

d13

d41

d24

d34

x4

x2

d23

x3

Figure 8: A generic metric space with 4 points. In order for PHVR
two “diagonals” d13, d24 should be larger than the outer edges d12, d23, d34, d41.

1 (X) to be non-zero, the

From these, we get tb(X) = max(d12, d23, d34, d41), td(X) = min(d13, d24), and PH1(X) =
I[tb(X), td(X)). We also have vd(x1) = x3, vd(x2) = x4, and vd ◦ vd = id.

However, if we had d12, d23, d34 < d24 < d41 < d13 for example, then the 2-simplex
[x2, x3, x4] appears before the would-be generator [x1, x2] + [x2, x3] + [x3, x4] + [x4, x1], and
PHVR

1 (X) = 0. In this case,

td
tb
x1
d13
d41
x2 max(d12, d23) d24
x3 max(d23, d34) d13
x4
d41
d24

Thus, tb(X) = d41 > d24 = td(X), and vd(x2) = x4 but vd(x4) = x1 (cid:54)= x2.

In general, we want to partition X into pairs of “opposite” points, that is pairs x, y such
that vd(x) = y and vd(y) = x. Intuitively, this says that the diagonals are larger than every
other edge. If not, as in the second case, then no persistence is produced. As for k = 1 and
n = 4, we will generally label the points as x1, x2, x3, x4 in such a way that

tb(X) = max(d12, d23, d34, d41) and
td(X) = min(d13, d24).

k (X) = 0 for all k ≥ 0 > n

Proof of Theorem 4.4. The proof is by induction on n. If n = 1, VRr(X) is contractible for
all r, and so PHVR
2 − 1. If n = 2, let X = {x0, x1}. The space
VRr(X) is two discrete points when r ∈ [0, diam(X)) and an interval when r ≥ diam(X).
0 (X) = I[0, diam(X)). Furthermore, this
Then PHVR
interval module equals I[tb(X), td(X)) because dX(x0, x1) > dX(x0, x0) = 0, so tb(x0) = 0
and td(x0) = dX(x0, x1). The same holds for x1, so tb(X) = 0 and td(X) = dX(x0, x1) =
diam(X).

k (X) = 0 for all k ≥ 1 > n

2 −1, and PHVR

For the inductive step, assume that the proposition holds for every metric space with less
than n points. Fix X with |X| = n and an integer k ≥ n
2 − 1. VRr(X) is contractible when
r ≥ diam(X), so let r < diam(X) and choose any pair x0, x1 ∈ X such that dX(x0, x1) =

27

diam(X). Let Bj = X \ {xj} for j = 0, 1 and A = X \ {x0, x1}. Because of the restriction
on r, VRr(X) contains no simplex σ ⊃ [x0, x1], so VRr(X) = VRr(B0) ∪ VRr(B1). At the
same time, VRr(A) = VRr(B0) ∩ VRr(B1), so we can use the Mayer-Vietoris sequence:

(cid:101)Hk(VRr(B0)) ⊕ (cid:101)Hk(VRr(B1))

(cid:101)Hk(VRr(X))

∂∗

(cid:101)Hk−1(VRr(A))

(cid:101)Hk−1(VRr(B0)) ⊕ (cid:101)Hk−1(VRr(B1))

where ιj are the maps induced by the inclusions A ⊂ Bj. Since |Bj| < n, the induction
hypothesis implies that PHVR
If, in addition,
2 − 1, then PHVR
k > n
k−1(A) is also 0 by the induction hypothesis. Thus, (cid:101)Hk(VRr(X)) is
0 for r ∈ [0, diam(X)] and, since VRr(X) is contractible when r ≥ diam(X), also for
r ∈ [diam(X), ∞). This ﬁnishes the proof of case (1).

k (Bj) = 0, and so ∂∗ is injective for any r.

From this point on, we ﬁx k = n
2 − 1 and focus on case (2). By induction hypothesis,
k−1(A) is either a single interval I[tb(A), td(A)) or 0 depending on whether tb(A) < td(A)
k (X) is non-zero. The

PHVR
or not. However, that is not the condition that determines if PHVR
relevant quantity is the following:

(cid:20)

b := max

tb(A), max
a∈A

dX(x0, a), max
a∈A

(cid:21)
dX(x1, a)

.

(5)

We claim that PHVR

k (X) (cid:54)= 0 if, and only if, b < td(A).

If b < td(A), let r ∈ [b, td(A)). First of all, the deﬁnition of b implies that tb(A) ≤ b, so
k (A) = I[tb(A), td(A))
tb(A) < td(A). Then, the induction hypothesis on A implies that PHVR
and, in particular, (cid:101)Hk−1(VRr(A)) = F for r ∈ [b, td(A)). Now, since maxa∈A dX(x1, a) ≤ b ≤
r, VRr(B0) contains all simplices [x1, a1, . . . , am], where [a1, . . . , am] is a simplex of VRr(A).
In other words, VRr(B0) is a cone C(VRr(A), x1) over VRr(A), so it is contractible. The
same holds for VRr(B1), so their homology is 0, and the Mayer-Vietoris sequence gives an
isomorphism

(cid:101)Hk(VRr(X)) ∼−→ (cid:101)Hk−1(VRr(A)) (cid:39) F.

We now show that (cid:101)Hk(VRr(X)) = 0 for any r /∈ [b, td(A)).

If tb(A) < b, let r ∈ [tb(A), b) and suppose, without loss of generality, that tb(A) <
dX(x0, a0) for some a0 ∈ A. In that case, VRr(B1) doesn’t contain the 1-simplex [x0, a0], so
VRr(A) ⊂ VRr(B1) ⊂ C(VRr(A), x0) \ [x0, a0]◦ (cid:39) VRr(A). Thus, the composition, which is
induced by inclusions,

(cid:101)Hk−1(VRr(A)) → (cid:101)Hk−1(VRr(B1)) → (cid:101)Hk−1(C(VRr(A)) \ [x0, a0]◦)

is an isomorphism. This implies that the ﬁrst map (cid:101)Hk−1(VRr(A)) → (cid:101)Hk−1(VRr(B1)) is in-
jective, which, in turn, makes (cid:101)Hk−1(VRr(A)) → (cid:101)Hk−1(VRr(B0)) ⊕ (cid:101)Hk−1(VRr(B1)) injective.

28

Since ∂∗ in (4.1) is also an injection, (cid:101)Hk(VRr(X)) = 0 for r ∈ [tb(A), b). Next, if r < tb(A)
or td(A) ≤ r < diam(X), (cid:101)Hk(VRr(A)) = 0, so (cid:101)Hk(VRr(X)) = 0 from the Mayer-Vietoris
sequence. Lastly, if r ≥ diam(X), then VRr(X) is contractible. Altogether, these cases give
PHVR
k (X) = 0 by using
the above cases for r ∈ [0, tb(A)), r ∈ [tb(A), b) (if tb(A) < b), and r ∈ [td(A), ∞).

k (X) = I[b, td(A)). If, on the other hand, b ≥ td(A), we obtain PHVR

The last thing left to check is that VR∗(X) produces persistent homology precisely
k (X) = I[b, td(A)) if, and only if, b < td(A),
when tb(X) < td(X). So far we have PHVR
so now we show that tb(X) < td(X) is equivalent to b < td(A). First, suppose that
b < td(A). For every a ∈ A and j = 0, 1, we have dX(a, xj) ≤ b < td(A) ≤ td(a, A)
by deﬁnition of b. Also, for every a(cid:48)
(cid:54)= vd(a, A) we have dX(a, a(cid:48)) ≤ tb(a, A) < td(a, A).
In other words, for every x ∈ X \ {vd(a, A)}, dX(a, x) < td(a, A), which means that
the point in X furthest away from a is still vd(a, A) ∈ A. Thus, td(a, X) = td(a, A)
and tb(a, X) = max [tb(a, A), dX(a, x0), dX(a, x1)]. Additionally, dX(x0, x1) = diam(X),
so clearly vd(x0, X) = x1 and tb(xj, X) = maxa∈A dX(xj, a). Thus,

(cid:26)

(cid:27)

(cid:26)

(cid:27)

td(X) = min

td(x0, X), td(x1, X), min
a∈A

td(a, X)

= min

diam(X), min
a∈A

td(a, A)

= td(A),

and

b = max

= max

(cid:20)

(cid:20)

(cid:20)

= max

max
a∈A

= tb(X).

tb(A), max
a∈A

dX(x0, a), max
a∈A

dX(x1, a)

(cid:21)

max
a∈A

tb(a, A), max
a∈A

dX(x0, a), max
a∈A

(cid:21)
dX(x1, a)

tb(a, X), tb(x0, X), tb(x1, X)

(cid:21)

In conclusion, tb(X) = b < td(A) = td(X), and PHVR

k (X) = I[tb(X), td(X)).

Now suppose b ≥ td(A). Let a0 ∈ A such that td(A) = td(a0, A). Notice that td(a0, X)
can diﬀer from td(a0, A) if dX(a0, xj) ≥ dX(a0, vd(a0, A)) for some j = 0, 1. However, we have
b ≥ dX(a0, xj) by deﬁnition, so b would still be greater than td(a0, X) even if td(a0, X) (cid:54)=
td(a0, A). With this in mind, we have two cases depending on whether b = tb(A) or not. If
they are equal, notice that tb(a, A) ≤ tb(a, X) for every a ∈ A because tb(a, X) takes the
maximum over a larger set than tb(a, A) does. Then

tb(X) ≥ tb(A) = b ≥ td(a0, X) ≥ td(X).

If b > tb(A) instead, write b = dX(a1, xj), where a1 ∈ A and j is either 0 or 1. Observe that
td(xj, X) = diam(X) ≥ dX(a1, xj), so tb(xj, X) ≥ dX(a1, xj). Then

tb(X) ≥ tb(xj, X) ≥ dX(a1, xj) = b ≥ td(a2, X) ≥ td(X).

In either case, tb(X) ≥ td(X), as desired. This completes the proof.

29

Remark 4.6 (A geometric algorithm for computing PHVR
k (X) when |X| = n and
k = n
2 − 1.). Recall that tb(x) and td(x) are the two greatest distances from x to every other
point in X. Both can be found in at most (n − 1) + (n − 2) = 2n − 3 steps because ﬁnding
a maximum takes as many steps as the number of entries. We compute both quantities for
each of the n points in X, and then ﬁnd tb(X) = minx∈X tb(x) and td(X) = minx∈X td(x) in
n steps each. After comparing tb(X) and td(X), we are able to determine whether PHVR
k (X)
is equal to I[tb(X), td(X)) or to 0 in at most n(2n − 3) + 2n + 1 = 2n2 − n + 1 = O(n2) steps.
This is a signiﬁcant improvement from the bound O(nω(k+2)) given in [MMS11] (cf. Remark
3.15). Indeed, using n = 2k + 2, our custom tailored algorithm incurs a cost O(k2) whereas
the standard algorithm incurs the much larger cost ≈ O((2k)ω(k+2)). You can see a parfor
based Matlab implementation in our github repository [GM21].

4.2 Computational examples

Theorem 4.4 has two consequences for VR-persistence sets. The ﬁrst is the following corol-
lary.

Corollary 4.7. Let X be any metric space and k ≥ 0. DVR

n,k(X) is empty for all n < 2k + 2.

This means that the ﬁrst interesting choice of n is n = 2k+2, and in that case, any sample
Y ⊂ X with |Y | = n will produce at most one point in its persistence diagram. What’s
more, this allows us to visualize DVR
2k+2,k(X) by taking all possible such samples Y ⊂ X
and plotting their persistence diagrams in the same axis; see Figure 4. In other words, we
plot DVR
2k+2,k(X) corresponds to a
possibly non-unique n-point sample Y ⊂ X such that dgmVR
k (Y ) = {(tb, td)}; see Figure
5 for an example. We can take this one step further and color the graph according to the
density of the points to obtain a plot of the persistence measure UVR
4,1 (X). For these reasons,
we give a name to this particular persistence set.

2k+2,k(X) as a subset of R2 where each point (tb, td) ∈ DVR

Notation: DVR
and the principal persistence measure of X in dimension k.

2k+2,k(X) and UVR

2k+2,k(X) are called, respectively, the principal persistence set

Figure 9 shows computational approximations to the principal persistence measure UVR
4,1
of S1, S2, and T2 = S1 × S1. The spheres are equipped with their usual Riemannian metrics
dS1 and dS2 respectively. As for the torus, we used the (cid:96)2 product metric deﬁned as

dT2 ((θ1, θ2), (θ(cid:48)

1, θ(cid:48)

2)) :=

(cid:113)

(dS1(θ1, θ(cid:48)

1))2 + (dS1(θ2, θ(cid:48)

2))2,

1, θ(cid:48)

2) ∈ T2. The diagrams were computed using a MATLAB wrapper3 for
for all (θ1, θ2), (θ(cid:48)
Ripser [Bau19] developed by C. Tralie using over 1,000,000 random 4-tuples of points. It
should be noted that only about 12% of those conﬁgurations generated a non-diagonal point.
n,k(Y ) whenever X (cid:44)→ Y in these

We can observe the functioriality property DVR

n,k(X) ⊂ DVR

3The MATLAB wrapper was adapted from the one found in https://github.com/ctralie/Math412S2

017.

30

4,1 (S1)
U VR

4,1 (S2)
U VR

4,1 (T2)
U VR

4,1 (S1), UVR

4,1 (S2), and UVR

Figure 9: From left to right: computational approximations to the 1-dimensional persistence
4,1 (T2). The colors represent the density of points in the
measures UVR
diagram. The support of each measure (that is, the colored region) is the persistence set
DVR
4,1 of the corresponding metric space. Notice how these results agree with the functoriality
property (cf. Remark 3.10): namely, that the persistence set of S1 is a subset of the respective
persistence sets of S2 and T2.

graphs. Notice that S1 embeds into S2 as the equator, and as slices S1 × {x0} and {x0} × S1
in T2. The eﬀect on the persistence sets is that a copy of DVR
4,1 (S2)
and DVR

4,1 (S1) appears in both DVR

4,1 (T2).

5 VR-Persistence sets of spheres

2k+2,k(S1) for all k ≥ 0.
In this section, we will describe the principal persistence sets DVR
After that, we will take advantage of functoriality to ﬁnd some of the persistence sets of the
higher dimensional spheres Sm, m ≥ 2, and describe the limitations (if any) to obtain higher
principal persistence sets. We begin with a general technical lemma.

Lemma 5.1. Let k ≥ 0 and n = 2k + 2. Let (X, dX) be a metric space with n points. Then:

1. td(X) ≤ 2tb(X).

2. pers(dgmVR

k (X)) = td(X) − tb(X) ≤ sep(X).

3. If X can be isometrically embedded on an interval, then tb(X) ≥ td(X).

Proof.
1.

If tb(X) ≥ td(X), then pers(dgmVR

k (X)) = 0 and items 1 and 2 are trivially true.
Suppose, then, tb(X) < td(X). Choose any x0, x ∈ X such that x (cid:54)= x0, vd(x0). By deﬁnition
of vd(x0), we have dX(x0, x) ≤ tb(x0) and dX(x, vd(x0)) ≤ tb(vd(x0)). Then

dX(x0, x) ≥ dX(x0, vd(x0)) − dX(x, vd(x0))
≥ td(x0) − tb(vd(x0))
≥ td(X) − tb(X).

31

00.511.522.5300.511.522.5300.511.522.500.511.522.5300.511.522.533.5400.511.522.533.54Since dX(x0, x) ≤ tb(X), we get the coarse bound td(X) ≤ 2tb(X).
2. The ﬁner bound sep(X) ≥ td(X) − tb(X) = pers(dgmVR

k (X)) follows by taking the

minimum of dX(x0, x) over x0 and x.

3 Suppose, without loss of generality, that X ⊂ R and that x1 < x2 < · · · < xn. Notice
that td(xk) = max(xk − x1, xn − xk) and, in particular, td(x1) = td(xn) = xn − x1. If k (cid:54)= 1, n,
then tb(x1) ≥ xk − x1 and tb(xn) ≥ xn − xk. Then

tb(X) ≥ max(tb(x1), tb(xn)) ≥ max(xk − x1, xn − xk) = td(xk) ≥ td(X).

5.1 Characterization of tb(X) and td(X) for X ⊂ S1
Now we focus on subsets of the circle. We model S1 as the quotient [0, 2π]/0 ∼ 2π equipped
with the geodesic distance, i.e.

dS1(x, y) = min(|x − y|, 2π − |x − y|).

We deﬁne a cyclic order ≺ on S1 by saying that x ≺ y ≺ z if, when viewing x, y, z as elements
of [0, 2π], we have one of the three choices of 0 ≤ x < y < z, x < 2π and 0 ≤ y < z, or
x < y < 2π and 0 ≤ z. In other words, if we deﬁne counter-clockwise to be the increasing
direction in [0, 2π], then x ≺ y ≺ z means that the counter-clockwise path starting at x
meets y before reaching z. We also use (cid:22) to allow the points to be equal.

Throughout this section, k ≥ 1 and n = 2k + 2 will be ﬁxed. Let X = {x1, x2, . . . , xn} ⊂
S1 such that xi ≺ xi+1 ≺ xi+2 for all i (addition is done modulo n). Write dij = dS1(xi, xj)
for the distances, and assume tb(X) < td(X).

Figure 10: This conﬁguration shows the edges that realize tb(x1) = max(d1,1+3, d1,1−3) and
td(x1) = d1,1+3+1 in the case k = 3 and n = 8. In this ﬁgure, the shortest path between x1
and x5 contains x8, x7, x6, so when r > d15, VRr(X) will contain a 4-simplex. These ideas
were inspired by [Kat91].

32

Lemma 5.2.

1. For any i, and tb(xi) = max(di,i+k, di,i−k) and td(xi) = di,i+k+1.

2. For any X ⊂ S1 with |X| = 2k + 2,

and

tb(X) = max
i=1,...,n

di,i+k

td(X) = min
i=1,...,n

di,i+k+1.

3. For all i, di,i+k = di,i+1 + di+1,i+2 + · · · + di+k−1,i+k.

4. tb(X) ≥ k

k+1π.

Proof. 1 Let r ∈ [tb(X), td(X)). By Proposition 4.3, VRr(X) is a cross-polytope with n
points. In particular, VRr(X) contains no simplices of dimension k + 1. We claim that this
forces td(xi) = di,i+k+1 for all i. Indeed, the shortest path between xi and xi+k+1 contains
either the set {xi+1, . . . , xi+k−1} or the set {xi+k+2, . . . , xi−1} (see Figure 10). For any xj in
that shortest path, di,j ≤ di,i+k+1, so if we had di,i+k+1 ≤ r, VRr(X) would contain a k + 1
simplex, either [xi, xi+1, . . . , xi+k+1] or [xi+k+1, xi+k+2, . . . , xi]. Thus, r < di,i+k+1 for all i.

In particular, VRr(X) doesn’t contain the edge [xi, xi+k+1]. According to deﬁnition 2.14,
cross-polytopes contain all edges incident on a ﬁxed point xi except one, so [xi, xj] ∈ VRr(X)
for all j (cid:54)= i+k +1. In consequence, di,j ≤ r < di,i+k+1 for all j (cid:54)= i+k +1, so td(xi) = di,i+k+1
and tb(xi) = maxj(cid:54)=i+k+1 di,j. Additionally, the shortest path between xi and xi+k contains
the set {xi+1, . . . , xi+k−1} rather than {xi+k+2, . . . , xi−1}, so di,i+j ≤ di,i+k for j = 1, . . . , k −1
(otherwise, VRr(X) would contain the k + 2 simplex [xi+k, xi+k+1, . . . , xi]). The analogous
statement di,i−j ≤ di,i−k holds for j = 1, 2, . . . , k − 1. Thus, tb(xi) = max(di,i+k, di,i−k).

2. These equations follow by taking the maximum (resp. minimum) over all i of the

above expression for tb(xi) (resp. td(xi)), as per Deﬁnition 4.1.

3. As we saw in the proof of item 1, the shortest path from xi to xi+k contains the set

{xi+1, . . . , xi+k−1}. The length of this path is di,i+k = di,i+1 + · · · + di+k−1,i+k.

4. By items 2 and 3,

ntb(X) ≥

n
(cid:88)

i=1

di,i+k =

n
(cid:88)

k
(cid:88)

i=1

j=1

di+j−1,i+j =

k
(cid:88)

n
(cid:88)

j=1

i=1

di+j−1,i+j = k · 2π.

Thus, tb(X) ≥ 2k

n π = k

k+1π.

33

x3

x2

x4

td(x1)

x1

x5

x6

Figure 11: Example of a critical conﬁguration for k = 2. The solid blue lines all have
length tb(X) = 2π/3, while the dotted red line has length td(X). Notice that two regular
(k + 1)-gons are formed.

5.2 Characterization of DVR

2k+2,k(S1) for k even

Lemma 5.2 shows that every conﬁguration has tb(X) ≥ k
k+1π. The converse holds in the case
that k is even. We obtain the proof by exhibiting conﬁgurations such that tb(X) = tb and
td(X) = td for every pair of values tb, td with k

Theorem 5.3. DVR

2k+2,k(S1) =

(cid:26)

(tb, td) :

k+1 π ≤ tb < td ≤ π.
(cid:27)
.

π ≤ tb < td ≤ π

k
k + 1

Proof. We will ﬁrst construct what we call the critical conﬁgurations, those where tb(X) =
k
k+1π and td(X) = td ∈ (tb(X), π]. Consider the points

xi =

(cid:40) π

k+1 · (i − 1),
π
k+1 · (i − 1) − (π − td),

i odd
i even,

If i is odd, clearly xi−1 < xi.

for i = 1, . . . , n.
k+1 + td > 0
because of Lemma 5.2 item 4 and the assumption that td > tb. Thus, x1 < x2 < · · · < xn.
Additionally, since td ≤ diam(S1), we have x2k+2 = kπ
k+1 < 2π, so we also have
xi ≺ xi+1 ≺ xi+2 for all i.

If i is even, xi − xi−1 = − kπ

k+1 + td ≤ (2k+1)π

Since k is even, i and i + k have the same parity,

di,i+k = |xi+k − xi| =

π
k + 1

[(i + k − 1) − (i − 1)] =

kπ
k + 1

.

Thus, tb(X) = maxi di,i+k = k
ing on the parity of i. If i ≤ k + 1 is odd (and i + k + 1 ≤ 2k + 2 even),

k+1π. To ﬁnd td(X) = mini di,i+k+1, we have two cases depend-

di,i+k+1 = |xi+k+1 − xi| =

1
k + 1

π[(i + k) − (i − 1)] − (π − td) = td,

34

and if i ≤ k + 1 is even,

di,i+k+1 = 2π − |xi+k+1 − xi| = 2π −

(cid:12)
(cid:12)
(cid:12)
(cid:12)

1
k + 1

(cid:12)
(cid:12)
π[(i + k) − (i − 1)] + (π − td)
(cid:12)
(cid:12)

= td.

Thus, td(X) = td.

Lastly, we can use these critical conﬁgurations to construct X (cid:48) such that tb(X (cid:48)) = tb >
i = xi for i (cid:54)= k + 1. Write
k+2), so

k+1 π > 0, and take x(cid:48)
j). Since tb < td, we have dS1(xk+1, x(cid:48)

k+1 = xk+1 + ε and x(cid:48)

k+1 = dS1(xk+1, x(cid:48)

k

k+1π. Let ε := tb − k
d(cid:48)
i, x(cid:48)
ij = dS1(x(cid:48)
k = xk ≺ xk+1 ≺ x(cid:48)
x(cid:48)

k+1) = ε < td − kπ
k+1), we have

k+1 ≺ x(cid:48)

k+2. As for tb(x(cid:48)

k+1) and td(x(cid:48)

d(cid:48)
k+1,1 = dk+1,1 + ε =

π + ε = tb,

d(cid:48)
k+1,2k+1 = dk+1,2k+1 − ε =

π − ε < tb, and

k
k + 1
k
k + 1

d(cid:48)
k+1,2k+2 = dk+1,2k+2 + ε = td + ε > td.

Thus, tb(X (cid:48)) = max d(cid:48)

i,i+k = tb and td(X (cid:48)) = min d(cid:48)

i,i+k+1 = td, as desired.

5.3 Characterization of DVR

2k+2,k(S1) for k odd

An important diﬀerence between even and odd k is that only for even k can we ﬁnd conﬁg-
urations that have the minimal possible birth time tb(X) = k
k+1π given any td ∈ (tb(X), π].
The diﬀerence is that sequences of the form xi, xi+k, xi+2k, . . . eventually reach all points
when k is odd, but only half of them when k is even (see Figure 11). This allows us to
separate X ⊂ S1 into two regular (k + 1)-gons with ﬁxed tb(X) and it still allows control on
td(X), as shown in Proposition 5.3. For odd k, we will instead use an idea from Proposition
5.4 of [AA17]. We won’t need the result in its full generality, so we only use part of its
argument to provide a bound for tb(X) in terms of td(X).

Theorem 5.4. Let k be an odd positive integer. Then td(X) ≥ (k + 1)(π − tb(X)).

Proof. Fix i ∈ {1, . . . , n}. Let r ≥ k
2(k − 1) · n + 1,
so the path that passes through the points xi, xi+k, . . . , xi+k·k makes 1
2(k − 1) revolutions
around the circle and stops at xi+k2 = xi+1. At the same time, d(cid:96),(cid:96)+k ≤ tb(X). These facts
give:

k π. Notice that k2 = 1

k+1π and δ = r − k−1

1
2

(k − 1) · 2π + di,i+1 =

k
(cid:88)

j=1

di+(j−1)k,i+jk ≤ ktb(X).

Thus, (k − 1)π + maxi=1,...,n di,i+1 ≤ ktb(X).

By Lemma 5.2, there exists an (cid:96) for which d(cid:96),(cid:96)+k+1 = td(X). Let γ be the path between x(cid:96)
and x(cid:96)+k+1 such that d(cid:96),(cid:96)+k+1 + |γ| = 2π. Assume, without loss of generality, that γ contains
x(cid:96)+1. This means that |γ| = d(cid:96),(cid:96)+1 + d(cid:96)+1,(cid:96)+k+1, so

d(cid:96),(cid:96)+1 = |γ| − d(cid:96)+1,(cid:96)+k+1 = 2π − td(X) − d(cid:96)+1,(cid:96)+k+1 ≥ 2π − td(X) − tb(X).

35

Thus, ktb(X) ≥ (k −1)π +maxi=1,...,n di,i+1 ≥ (k +1)π −td(X)−tb(X). Solving this inequality
for td(X) gives the result.

x4

L

x5

s
x6

L

x3

s

x2

tb(x1)

td(x1)

tb(x1)

L

L

x1

L

x8

s

x7

Figure 12: Example of a critical conﬁguration for k = 3 Notice that tb(X) = 2L + s and
td(X) = 2L + 2s.

The critical conﬁgurations are easier to describe in terms of the distances between con-
secutive points. Given 0 < tb < td ≤ π such that td = (k + 1)(π − tb), let L = ktb − (k − 1)π
and s = −(k + 2)tb + (k + 1)π. Set x1 = 0 and deﬁne

xi+1 =

(cid:40)

xi + L,
xi + s,

i ≤ k odd or i > k even,
i < k even or i > k odd

for i = 1, . . . , 2k + 2. In this setup, d12 = L, d23 = s, . . . , dk,k+1 = L, then dk+1,k+2 = L,
and the pattern resumes after the repetition: dk+2,k+3 = s, dk+3,k+4 = L, . . . , d2k+1,2k+2 = s.
Notice that x2k+2 = (k + 1)L + ks = 2π − L, so d2k+2,1 = L.

Now we verify tb(X) = tb and td(X) = td. Recall that di,i+k = di,i+1 + · · · + di+k−1,i+k
from Lemma 5.2 item 3. It can then be shown that di,i+k = ( k+1
2 )s when i (cid:54)= k + 2,
and dk+2,2k+2 = ( k−1
2 )s = tb. To ﬁnd td(X),
let γi be the path from xi to xi+k+1 that passes through xi+1. The distance di,i+k+1 is then
the minimum of |γi| = di,i+1 + · · · + di+k,i+k+1 and |γi+k+1| = di+k+1,i+k+2 + · · · + di−1,i. It
can be veriﬁed that

2 )s. Since s ≤ L, tb(X) = ( k+1

2 )L + ( k−1

2 )L + ( k+1

2 )L + ( k−1

(cid:40)

2 )L + ( k−1
2 )L + ( k+1
Recall that k is odd, so regardless of the parity of i, we have

i < k + 1 odd or i > k + 1 even,
i ≤ k + 1 even or i > k + 1 odd.

2 )s,
2 )s,

( k+3
( k+1

|γi| =

di,i+k+1 = min{|γi|, |γi+k+1|}
2 )L + ( k−1
= min{( k+3
2 )L + ( k+1
= ( k+1
2 )s
= (k + 1)(π − tb(X)).

2 )s, ( k+1

2 )L + ( k+1

2 )s}

36

Thus, td(X) = (k + 1)(π − tb(X)).

Theorem 5.5. For odd k,

DVR

2k+2,k(S1) = {(tb, td) : (k + 1)(π − tb) ≤ td ≤ π and tb ≤ td} .

Proof. We got the inequality (k + 1)(π − tb) ≤ td in Theorem 5.4 and showed that equality
can be achieved in the preceding paragraph. To get a conﬁguration where (k+1)(π −tb) < td,
construct the set X as above so that td(X) = td and tb(X) = π − 1
k+1td(X) is the smallest
birth time possible with death time td(X). Pick any tb such that tb(X) < tb < td(X), and
let ε = tb − tb(X). Deﬁne x(cid:48)
i = xi for i (cid:54)= 1, k + 2. By
Lemma 5.2, ε = tb − tb(X) < td(X) − tb(X) = pers(dgmVR
k (X)) ≤ sep(X). Because of this,
2. Analogously, xk+2 ≺ x(cid:48)
1 = x1 + ε < x1 + sep(X) ≤ x2 = x(cid:48)
x(cid:48)
k+3,
and the cyclic ordering is maintained. As for the distances, we have

k+2 = xk+2 + ε, and x(cid:48)

1 = x1 + ε, x(cid:48)

2, so x1 ≺ x(cid:48)

k+2 ≺ x(cid:48)

1 ≺ x(cid:48)

d(cid:48)
1,1+k = d1,1+k − ε
d(cid:48)
1,1−k = d1,1−k + ε
d(cid:48)
k+2,(k+2)+k = dk+2,(k+2)+k − ε
d(cid:48)
k+2,(k+2)−k = dk+2,(k+2)−k + ε

1,k+2 = d1,k+2. Thus, tb(X (cid:48)) = tb(x(cid:48)

1) = d1,1−k + ε = tb(X) + ε = tb, and td(X (cid:48)) =

and d(cid:48)
td(X) = td.

Remark 5.6. The persistence sets of a circle λ
the results of this section. For example, DVR
and tb < td ≤ λ.

π ·S1 with diameter λ are obtained by rescaling
π · S1) is the set bounded by 2(λ − tb) ≤ td

4,1 ( λ

In general, there are multiple conﬁgurations with the same persistence diagram, even
among those that minimize the death time. The exception is the conﬁguration that has the
minimal birth time, as the following lemma shows.

Proposition 5.7. For any k ≥ 0, let n = 2k + 2. If X ⊂ S1 has n points and satisﬁes
tb(X) = k
k+1π and td(X) = π, then X is a regular n-gon. As a consequence, the conﬁguration
X with n points such that dgmVR

k+1π, π)} is unique up to rotations.

k (X) = {( k

37

Proof. An application of Lemma 5.2 item 3 and the triangle inequality gives:

k
k + 1

π = tb(X) = max(di,i+k) ≥

1
2k + 2

2k+2
(cid:88)

i=1

di,i+k =

1
2k + 2

2k+2
(cid:88)

k
(cid:88)

i=1

j=1

di+j−1,i+j

k
(cid:88)

2k+2
(cid:88)

di+j−1,i+j

j=1

k
(cid:88)

i=1
(cid:34) k+1
(cid:88)

j=1

i=1

di+j−1,i+j +

(cid:35)

di+j−1,i+j

2k+2
(cid:88)

i=k+2

k
(cid:88)

j=1

k
(cid:88)

j=1

[dj,j+k+1 + dj+k+1,j]

[2td(X)]

=

=

1
2k + 2

1
2k + 2

≥

1
2k + 2

≥

=

1
2k + 2

k
k + 1

π.

Thus, all intermediate inequalities become equalities, most notably, di,i+k = k
and dj,j+k+1 = (cid:80)k+1

i=1 di+j−1,i+j = π for all j. Then

k+1π for all i,

di,i+1 = di−k,i+1 − di−k,i = π −

k
k + 1

π =

2π
2k + 2

.

In other words, X is a regular n-gon.

5.4 Characterization of UVR

4,1 (S1)

The case of k = 1 in Theorem 5.5 allows us to ﬁnd a probability density function for UVR
with respect to the Lebesgue measure.

4,1 (S1)

Proposition 5.8. Consider (S1, dS1, µS1) as an mm-space where µS1 is the uniform measure.
Then, the measure UVR

4,1 (S1) has probability density function

f (tb, td) =

12
π3 (π − td)

with respect to the Lebesgue measure in R2. Here, we view DVR

4,1 (S1) ⊂ R2.

Proof. Recall that we are modeling S1 as the quotient [0, 2π]/0 ∼ 2π. Consider a set X =
{x1, x2, x3, x4} ⊂ [0, 2π] of four points chosen uniformly at random. Relabel xi as x(j) ∈
[0, 2π] so that x(1) < x(2) < x(3) < x(4). Consider the image of x(j) under the quotient map
[0, 2π] (cid:16) S1, and let γi be the path between x(i) and x(i+1) that doesn’t contain any other

38

point x(j). Set yi = |γi|. It can be shown that the pushforward of the uniform measure on
[0, 2π]4 into the set

{(x(1), x(2), x(3), x(4)) ∈ [0, 2π]4 : x(1) < x(2) < x(3) < x(4)}

is the uniform measure, and the pushfoward of this measure under the map

(x(1), x(2), x(3), x(4)) (cid:55)→ (y1, y2, y3)

onto

∆3(2π) := {(y1, y2, y3) ∈ [0, 2π]3 : y1 + y2 + y3 ≤ 2π}
is also the uniform measure. Thus, we will model a conﬁguration of four points in S1 as the
set of distances y1, y2, y3, y4 instead.

We will ﬁrst ﬁnd the cumulative distribution function of UVR
4,1 (S1). According to Lemma 5.2,

point (tb, td) ∈ DVR

4,1 (S1). To do that, we ﬁx a

tb(X) = max
i=1,...,4
td(X) = min
i=1,...,4

yi

yi + yi+1.

Since ∆3(2π) has the uniform measure, the probability that tb ≤ tb(X) < td(X) ≤ td is the
volume of the set

R(tb, td) := {(y1, y2, y3) ∈ ∆3(2π) : tb ≤ tb(X) < td(X) ≤ td}

divided by Vol(∆3(2π)) = (2π)3
parametrization of y1, y2, y3.

3!

. We will ﬁnd Vol(R(tb, td)) using an integral with a suitable

Assume that tb(X) = y1. There are four choices for td(X), but to start, let td(X) = y1+y2.
Since y3 ≤ y1 by deﬁnition of tb(X), we have y3 + y2 ≤ y1 + y2, but since y1 + y2 = td(X), we
actually have an equality td(X) = y1 + y2 = y3 + y2. Thus, this case is a subset of the case
when td(X) = y2 + y3. Similarly, the case td(X) = y1 + y4 implies td(X) = y3 + y4. Hence,
we only have two possible choices for td(X). Since they are symmetric, we can choose one
of them and account for the symmetry later. Thus, set td(X) = y2 + y3.

The condition tb(X) = y1 is equivalent to having yi ≤ y1 for i = 2, 3, 4. Also, td(X) =
y2 + y3 gives y2 + y3 ≤ y3 + y4, and so y2 ≤ y4. It can be veriﬁed that the set of inequalities

y2 ≤ y4 ≤ y1
y3 ≤ y1

(6)
(7)

is equivalent to tb(X) = y1 and td(X) = y2 + y3. By rewriting y4 as 2π − y1 − y2 − y3, the
inequalities in (6) become

2y2 + y3 ≤ 2π − y1,
2π − 2y1 ≤ y2 + y3,

39

(8)
(9)

and (7) is equivalent to

(y2 + y3) − y1 ≤ y2.

(10)

Since we are assuming that tb(X) < td(X), we also have y1 < y2 + y3.
If we make the
substitution s = y2 + y3, we ﬁnd that (8)-(10) are equivalent to the following system of
inequalities:

tb ≤ y1 ≤ td
max(2π − 2y1, y1) < s ≤ td

s − y1 ≤ y2 ≤ 2π − s − y1.

Call the region deﬁned by this system of inequalities R(cid:48)(tb, td). Notice that the Jacobian
(cid:12)
(cid:12)
∂(y1,y2,y3)
(cid:12)
(cid:12)
(cid:12) is 1. Also, there were four choices for tb(X) (all four yi) and for each, two choices
(cid:12)
∂(y1,y2,s)
for td(X) (y2 + y3 and y3 + y4 in our case). Thus, there were 8 possible choices for tb(X) and
td(X), so

Vol(R(tb, td)) = 8 Vol(R(cid:48)(tb, td)) = 8

(cid:90) (cid:90) (cid:90)

1 dy2 ds dy1.

R(cid:48)(tb,td)

To ﬁnd this integral, notice that 2π − 2y1 ≤ y1 when 2π

3 ≤ y1. Thus, for tb ≥ 2π

3 , we have

Vol(R(tb, td)) = 8

(cid:90) td

(cid:90) td

(cid:90) 2π−s−y1

1 dy2 ds dy1

tb
16
3

= −

y1

s−y1

d + 8(π + tb)t2
t3

d − (16πtb)td +

(cid:18)

−

8
3

b + 8πt2
t3
b

(cid:19)

.

(11)

3 , td)) = − 16

81 π3.
In order to calculate the
3 , we split the integral into two pieces where tb ≤ y1 ≤ 2π
3
3 ≤ y1 < td, respectively. The second case was calculated above, and in the ﬁrst, we

In particular, Vol(R( 2π
volume of R(tb, td) when tb ≤ 2π
and 2π
have max(2π − 2y1, y1) = 2π − 2y1. Thus:

3 π2td + 224

d − 32

d + 40

3 πt2

3 t3

Vol(R(tb, td)) = Vol(R(2π/3, td)) + 8

(cid:90) 2π/3

(cid:90) td

(cid:90) 2π−s−y1

1 dy2 ds dy1

tb

2π−2y1

= −

16
3

d + 8(π + tb)t2
t3

d − (16πtb)td +

(cid:18)

s−y1
32
3

−

b + 16πt2
t3

b −

(cid:19)

.

π3

32
27

(12)

Now, let f be the probability density function of UVR
tb ≤ tb(X) < td(X) ≤ td is Vol(R(tb, td))/ Vol(∆3(2π)), we have

4,1 (S1). Since the probability of

Vol(R(tb, td))
Vol(∆3(2π))

=

(cid:90) td

(cid:90) td

tb

max(2(π−τb),τb)

f (τb, τd) dτd dτb.

The lower bound on τd comes from Theorem 5.5, which in the case k = 1 gives td ≥ 2(π − tb).
Thus,

(cid:18)

f (tb, td) =

∂
∂td

−

∂
∂tb

Vol(R(tb, td))
Vol(∆3(2π))

(cid:19)

.

40

The mixed derivatives ∂
∂td

(cid:17)

(cid:16)

− ∂
∂tb

of both (11) and (12) are 16(π − td), so

f (tb, td) =

16(π − td)
(2π)3/3!

=

12
π3 (π − td),

regardless of whether tb ≤ 2π
UVR

4,1 (S1).

3 or not. This is the desired probability density function of

Example 5.9. Equation (12) gives

Vol(R(π/2, π))
Vol(∆3(2π))

=

4π3/27
(2π)3/3!

=

1
9

≈ 11%.

This is the probability that a set {x1, x2, x3, x4} ⊂ S1 chosen uniformly at random produces
persistent homology at all in dimension 1. This is consistent with the 10.98% success rate
obtained in the simulations; cf. Section 4.2.

5.5 Persistence sets of Ptolemaic spaces

Example 4.5 showed that in a metric space with four points, the birth time of its one-
dimensional persistent homology is given by the length of the largest side and the death
time, by that of the smaller diagonal. In this section, we use Ptolemy’s inequality, which
relates the lengths of the diagonals and sides of Euclidean quadrilaterals, to bound the ﬁrst
persistence set DVR

4,1 of several spaces and show examples where the bound is attained.

Deﬁnition 5.10. A metric space (X, dX) is called Ptolemaic if for any x1, x2, x3, x4 ∈ X,

dX(x1, x3) · dX(x2, x4) ≤ dX(x1, x2) · dX(x3, x4) + dX(x1, x4) · dX(x2, x3).

It should be noted that the inequality holds for any permutation of x1, x2, x3, x4. Ex-
amples of Ptolemaic metric spaces include the Euclidean spaces Rn and CAT(0) spaces;
see [BFW09] for a more complete list of references. The basic result of this section is the
following.
Proposition 5.11. Let (X, dX) be a Ptolemaic metric space. For any (tb, td) ∈ DVR
where tb < td,

4,1 (X)

√

td ≤

2tb.

Proof. Let X (cid:48) = {x1, x2, x3, x4} ⊂ X be such that tb(X (cid:48)) < td(X (cid:48)). As per Example 4.5,
relabel the points so that tb(X (cid:48)) = max(d12, d23, d34, d41) and td(X (cid:48)) = min(d13, d24). Then,
Ptolemy’s inequality gives

(td(X))2 = (min(d13, d24))2
≤ d13 · d24
≤ d12 · d34 + d23 · d14
≤ 2(max(d12, d23, d34, d41))2
= 2 (tb(X))2 .

Taking square root gives the result.

41

Another way to phrase the above proposition is to say that DVR

set

(cid:110)

√

(tb, td)|0 ≤ tb < td ≤ min(

2tb, diam(X))

.

4,1 (X) is contained in the
(cid:111)

A key example where the containment is strict is the following.

Proposition 5.12. Let S1
Then

E denote the unit circle in R2 equipped with the Euclidean metric.
(cid:40)

(cid:41)

(cid:114)

DVR

4,1 (S1

E) =

(tb, td) (cid:12)

(cid:12) 2tb

1 −

≤ td, and

2 ≤ tb < td ≤ 2

.

√

t2
b
4

Proof. Observe that the Euclidean distance dE between two points in S1 is related to their
geodesic distance d by dE = fE(d) = 2 sin(d/2). Since fE is increasing on [−π, π], an
interval that contains all possible distances between points in S1, a conﬁguration X =
{x1, x2, x3, x4} ⊂ S1 produces non-zero persistence if, and only if, its Euclidean counter-
part XE ⊂ S1

E does. For this reason, DVR

4,1 (S1)(cid:1).

E) = fE

(cid:0)DVR

4,1 (S1

From Theorem 5.5,

DVR

4,1 (S1) = {(tb, td) (cid:12)

(cid:12)2(π − tb) ≤ td ≤ π and π/2 ≤ tb < td ≤ π}.

Applying fE to the bound td ≥ 2(π − tb) gives

td,E = 2 sin(td/2) ≥ 2 sin(π − tb) = 2 sin(tb) = 2 sin(2 arcsin(tb,E/2))
(cid:113)

= 4 sin(arcsin(tb,E/2)) cos(arcsin(tb,E/2)) = 2tb,E

1 − t2

b,E/4,

while the image of the bound π/2 ≤ tb < td ≤ π under fE is

√

2 ≤ tb,E < td,E ≤ 2.

Even though DVR

4,1 (S1

E) doesn’t attain equality in the bound given by Proposition 5.11, it

can be used to show that other spaces do. Two examples are S2 and R2.

Proposition 5.13.

DVR

4,1 (R2) =

DVR

4,1 (S2

E) =

(cid:110)
(tb, td) (cid:12)
(cid:110)
(tb, td) (cid:12)

(cid:12) 0 < tb < td ≤

√

(cid:111)

2tb

, and

√

(cid:111)

.

(cid:12) 0 < tb < td ≤ min(

2tb, 2)

√

(cid:12) 0 < tb < td ≤ min(

4,1 (R2) ⊂ P∞ and DVR

2tb, D)(cid:9). Both R2 and S2
4,1 (S2

Proof. Let PD = (cid:8)(tb, td) (cid:12)
maic spaces, so Proposition 5.11 gives DVR
direction, notice that R2 contains circles R · S1
persistence sets (Remark 3.10), DVR
the line [
tb < td ≤
R = td/2 gives (tb, td) ∈ [
argument with the added restriction of R ≤ 1 shows that P2 ⊂ DVR

E ⊂ R3 are Ptole-
E) ⊂ P2. To show the other
E of any radius R > 0. By functoriality of
4,1 (R2) contains
4,1 (R ·S1
E) from above (see Figure 13). The inequality
√
2
2 td ≤ tb < td, so given any point (tb, td) ∈ P∞, taking
4,1 (R2). The same

4,1 (R · S1
√
2R, 2R)×2R that bounds DVR
√
2tb can be rearranged to

4,1 (R2) so, in particular, DVR

4,1 (R2). Thus, P∞ ⊂ DVR

2R, 2R) × 2R ⊂ DVR

E) ⊂ DVR

√

4,1 (S2

E).

42

DVR

4,1 (S1)

DVR

4,1 (S2)

3

2.5

2

1.5

1

0.5

0

2

1.5

1

0.5

0

0

0.5

1

1.5

2

2.5

3

DVR

4,1 (S1
E)

3

2.5

2

1.5

1

0.5

0

2

1.5

1

0.5

0

0

0.5

1

1.5

2

2.5

3

DVR

4,1 (S2
E)

0

0.5

1

1.5

2

0

0.5

1

1.5

2

Figure 13: Top left: DVR
DVR
diagram. The analogous statement holds for S1

E). Notice that DVR

4,1 (S1). Top right: DVR

4,1 (S1) ⊂ DVR

4,1 (S2

4,1 (S1

4,1 (S2). Bottom right:
4,1 (S2), as indicated by the red line in the top right

E). Bottom left: DVR

E ⊂ S2
E.

Two observations summarize the proof of Proposition 5.13: Ptolemy’s inequality gives a
4,1 (R2), while the circles in R2 produce enough points to ﬁll P∞.
region P∞ that contains DVR
It turns out that this technique can be generalized to other spaces, provided that we have a
suitable analogue of Ptolemy’s inequality. This is explored in the next section.

5.6 Persistence sets of the surface with constant curvature κ

Consider the model space Mκ with constant sectional curvature κ. In this section, we will
characterize DVR
4,1 (Mκ). Proposition 5.13 already has the case κ = 0, so now we deal with
κ (cid:54)= 0. To ﬁx notation, let x, y ∈ R3. Deﬁne

(cid:104)x, y(cid:105) = x1y1 + x2y2 + x3y3, and
(cid:104)x|y(cid:105) = −x1y1 + x2y2 + x3y3.

43

We model Mκ as

(cid:26)

x ∈ R3 | (cid:104)x, x(cid:105) =

(cid:26)

x ∈ R3 | (cid:104)x|x(cid:105) =

Mκ =

Mκ =

1
κ
1
κ

(cid:27)

, if κ > 0, and

(cid:27)

and x1 > 0

, if κ < 0.

√

In other words, Mκ is the sphere of radius 1/
κ if κ > 0, and the hyperbolic plane of
constant curvature κ < 0 with the hyperboloid model. The geodesic distance in Mκ is given
by

(cid:40) 1√
+κ arccos(κ(cid:104)x, y(cid:105)),
1√
−κ arcosh(κ(cid:104)x|y(cid:105)),
To use the same technique as in Proposition 5.13, we use a version of Ptolemy’s inequality

dMκ(x, y) =

if κ > 0,

if κ < 0.

(13)

for spaces of non-zero curvature.

Lemma 5.14 (Spherical Ptolemy’s inequality, [Val70a]).
For κ > 0, let x1, x2, x3, x4 ∈ Mκ, and dij = dMκ(xi, xj). The determinant

Cκ =

(cid:12)
(cid:12)
(cid:12)
(cid:12)

sin2

(cid:18) √
κ
2

(cid:19)(cid:12)
(cid:12)
(cid:12)
(cid:12)

dij

(14)

is non-positive. In particular,

sin

(cid:16) √

κ
2 d13

(cid:17)

sin

(cid:16) √

κ
2 d24

(cid:17)

≤ sin

(cid:16) √

κ
2 d12

(cid:17)

sin

(cid:16) √

κ
2 d34

(cid:17)

+ sin

(cid:16) √

κ
2 d14

(cid:17)

sin

(cid:16) √

κ
2 d23

(cid:17)

.

(15)

Proof. [Val70a] proved that the determinant (14) is non-positive when κ = 1; we obtain the
general version by rescaling the distances as follows. Let xi ∈ Mκ for i = 1, 2, 3, 4; deﬁne
ij = dM1(yi, yj). Notice that (cid:104)yi, yi(cid:105) = κ(cid:104)xi, xi(cid:105) = 1, so yi ∈ M1 and, by
yi =
(13),
√

κxi, and d(cid:48)

√

κ
2

1
2

dij =

arccos(κ(cid:104)xi, xj(cid:105)) =

arccos((cid:104)yi, yj(cid:105)) =

1
2

1
2

d(cid:48)
ij.

Then, the determinant

Cκ(x1, x2, x3, x4) =

(cid:12)
(cid:12)
(cid:12)
(cid:12)

sin2

(cid:18) √
κ
2

(cid:19)(cid:12)
(cid:12)
(cid:12)
(cid:12)

dij

=

(cid:12)
(cid:12)
(cid:12)
(cid:12)

sin2

(cid:18) d(cid:48)
ij
2

(cid:19)(cid:12)
(cid:12)
(cid:12)
(cid:12)

= C1(y1, y2, y3, y4)

is non-positive by Theorem 3.1 of [Val70a] and, by the Corollary following that, we get
(15).

Valentine also generalized this result to hyperbolic geometry. The rescaling is analogous

to the one in the previous lemma, so we omit the proof.

44

Lemma 5.15 (Hyperbolic Ptolemy’s inequality, [Val70b]).
If κ < 0, let x1, x2, x3, x4 ∈ Mκ, and dij = dMκ(xi, xj). Then the determinant

Kκ =

(cid:12)
(cid:12)
(cid:12)
(cid:12)

sinh2

(cid:18) √

−κ
2

dij

(cid:19)(cid:12)
(cid:12)
(cid:12)
(cid:12)

is non-positive. In particular,

sinh

(cid:16) √

(cid:17)

−κ
2 d13

sinh

(cid:16) √

(cid:17)

−κ
2 d24

≤ sinh

(cid:16) √

(cid:17)

−κ
2 d12

sinh

(cid:16) √

(cid:17)

−κ
2 d34

+sinh

(cid:16) √

(cid:17)

−κ
2 d14

sinh

(cid:16) √

(16)

(cid:17)

−κ
2 d23
(17)

.

With these tools, we are ready to prove the main theorem of this section.

Theorem 5.16. Let Mκ be the 2-dimensional model space with constant sectional curvature
κ. Then:

• If κ > 0, DVR

4,1 (Mκ) =

(cid:110)

(tb, td)| sin

(cid:16) √

κ
2 td

(cid:17)

≤

√

2 sin

(cid:17)

(cid:16) √

κ
2 tb

and 0 < tb < td ≤ π√
κ

(cid:111)
.

• If κ = 0, DVR

4,1 (M0) = (cid:8)(tb, td)| 0 ≤ tb < td ≤
(cid:17)

(cid:16) √

(cid:110)

(cid:9).
2tb
√

√

• If κ < 0, DVR

4,1 (Mκ) =

(tb, td)| sinh

−κ
2 td

≤

2 sinh

(cid:16) √

(cid:17)

−κ
2 tb

and 0 < tb < td

(cid:111)
.

Proof. The case κ = 0 was already done in Proposition 5.13. For κ > 0, let

P =

(cid:110)

(tb, td)| sin

(cid:16) √

κ
2 td

√

(cid:17)

≤

2 sin

(cid:17)

(cid:16) √

κ
2 tb

and 0 < tb < td ≤ π√
κ

(cid:111)

.

Let X = {x1, x2, x3, x4} ⊂ Mκ and dij = dMκ(xi, xj). Suppose that tb(X) < td(X) and
label the xi so that tb(X) = max(d12, d23, d34, d41) and td(X) = min(d13, d24). Let sij :=
sin

. By (15),

(cid:16) √

(cid:17)

κ
2 dij

and, since sin

(cid:16) √

(cid:17)
κ
2 t

is increasing when

√
κ
2 t ∈

(cid:104)

0,

(cid:105)
√
κ
2 diam(Mκ)

= (cid:2)0, π

2

(cid:3), we get

s13s24 ≤ s12s34 + s14s23,

sin2 (cid:16) √

κ
2 td(X)

(cid:17)

= (min(s13, s24))2

≤ s13s24
≤ s12s34 + s14s23
≤ 2 sin2 (cid:16) √

κ
2 tb(X)

(cid:17)

.

Thus,

(cid:18) √
κ
2

sin

(cid:19)

td

≤

√

2 sin

(cid:18)√
κ
2

(cid:19)

tb

.

(18)

45

This shows that DVR

4,1 (Mκ) ⊂ P . For the other direction, let 0 < t ≤ 1 and s ∈ [0, π/2],

and consider X = {x1, x2, x3, x4} where

1 − t2,

1 − t2,

1 − t2, − t√

(cid:17)
t√
κ, 0

t√
κ sin(s),
(cid:17)
κ, 0

(cid:17)
t√
κ cos(s)

1 − t2, − t√

κ sin(s), − t√

(cid:17)
κ cos(s)

√

√

√

√

(cid:16) 1√
(cid:16) 1√
(cid:16) 1√
(cid:16) 1√

κ

κ

κ

κ

x1 =

x2 =

x3 =

x4 =

It can be checked that:

• xi ∈ Mκ,

• (cid:104)x1, x3(cid:105) = (cid:104)x2, x4(cid:105) = 1

• (cid:104)x1, x2(cid:105) = (cid:104)x3, x4(cid:105) = 1

• (cid:104)x1, x4(cid:105) = (cid:104)x2, x3(cid:105) = 1

κ(1 − 2t2),
κ(1 − t2(1 − sin(s))), and
κ(1 − t2(1 + sin(s))).

Since arccos(t) is decreasing, we have

tb(X) =

td(X) =

1
√
κ
1
√
κ

arccos (κ(cid:104)x1, x4(cid:105)) =

arccos (κ(cid:104)x1, x3(cid:105)) =

1
√
κ
1
√
κ

arccos(1 − t2(1 + sin(s))), and

arccos(1 − 2t2).

Notice that for a ﬁxed t, tb(X) is minimized at s = 0 and the equality in (18) is achieved.
Also, td(X) is maximized at t = 1, at which point td(X) = π√
κ. Now, let (tb, td) ∈ P be
arbitrary. If we set tb(X) = tb and td(X) = td, we can solve the equations above to get

(cid:114)

t =

sin(s) = 2 ·

√

κtd)

, and

1 − cos(
2
1 − cos(
1 − cos(

√
√

κtb)
κtd)

− 1.

Such a t exists because cos(
2 sin2(x/2) gives the equivalent expression

√

κtd) ≤ 1. As for s, the half-angle identity 1 − cos(x) =

sin(s) = 2 ·

√
√

sin2(
sin2(

κ tb/2)
κ td/2)

− 1.

Since (tb, td) satisﬁes (18), the right side is bounded below by 0 and, since tb < td ≤ π√
κ , it is
also bounded above by 1. Thus, there exists an s ∈ [0, π/2] that satisﬁes the equality. This

46

ﬁnishes the proof of P ⊂ DVR

4,1 (Mκ).

The proof for κ < 0 proceeds in much the same way. The only major change is in the

deﬁnition of the points xi when showing P ⊂ DVR

4,1 (Mκ):

x1 =

x2 =

x3 =

x4 =

√

√

√

√

−κ

(cid:16) 1√
(cid:16) 1√
(cid:16) 1√
(cid:16) 1√

−κ

−κ

−κ

(cid:17)
t√
−κ , 0

1 + t2,

1 + t2,

t√
−κ sin(s),
(cid:17)
−κ, 0
−κ sin(s), − t√

1 + t2, − t√

1 + t2, − t√

(cid:17)
t√
−κ cos(s)

(cid:17)
−κ cos(s)

Other than that, and the fact that Mκ is unbounded when κ < 0, the proof is completely
analogous.

1

A related result appears in [BHPW20]. The authors explore the question of whether
persistent homology can detect the curvature of the ambient Mκ. On the theoretical side,
they found a geometric formula to compute dgm ˇCech
(T ) of a sample T ⊂ Mκ with three
points, much in the same vein as our Theorem 4.4. They used it to ﬁnd the logarithmic
persistence Pa(κ) = td(Tκ,a)/tb(Tκ,a) for an equilateral triangle Tκ,a of ﬁxed side length a > 0,
and proved that Pa, when viewed as a function of κ, is invertible. On the experimental side,
they sampled 1000 points from a unit disk in Mκ and were able to approximate κ using the
average VR death vectors in dimension 0 and average persistence landscapes in dimension 1
of 100 such samples. For example, one method consisted in ﬁnding a collection of landscapes
Lκ labeled with a known curvature κ, and estimating κ∗ for an unlabeled L∗ with the
average curvature of the three nearest neighbors of L∗. They were also able to approximate
κ∗ without labeled examples by using PCA. See their paper [BHPW20] for more details.

Our Theorem 5.16 is in the same spirit. The curvature κ determines the boundary of
DVR
4,1 (Mκ), and instead of triangles, we could use squares with a given td and minimal tb to
ﬁnd κ. Additionally, we can qualitatively detect the sign of the curvature by looking at the
boundary of DVR
4,1 (Mκ): it is concave up when κ > 0, a straight line when κ = 0, and concave
down when κ < 0. See Figure 14.

5.7 Persistence sets of Sm for m ≥ 3

General spheres are another example where our strategy provides a characterization of their
persistence sets. The next proposition is inspired by the equality condition in Ptolemy’s
theorem, that is, equality occurs when the four points lie on a circle. We can generalize that
argument to higher dimensional spheres.

Proposition 5.17. For all m ≥ n − 1 and all k ≥ 0, DVR

n,k(Sm

E ) = (cid:83)

λ∈[0,1] λ · DVR

n,k(Sn−2

E ).

47

Figure 14: The boundary of DVR
4,1 (Mκ) for multiple κ. Observe this set is bounded only when
κ > 0, and that the left boundary of these persistence sets is concave up when κ > 0, a
straight line when κ = 0, and concave down when κ > 0.

E contains copies of λ · Sn−2
Proof. Sm
the other direction, notice that a set X ⊂ Sm
hyperplane which intersects Sm
E ) ⊂ (cid:83)
X ⊂ λ · Sn−2
E , so DVR

n,k(Sn−2
E ). For
E ⊂ Rm+1 with n points generates an (n − 1)-
E on a (n − 2)-dimensional sphere of radius λ ≤ 1. Thus,
λ∈[0,1] λ · DVR

λ∈[0,1] λ · DVR

E ) ⊂ DVR

n,k(Sn−2
E ).

for λ ∈ [0, 1], so (cid:83)

n,k(Sm

n,k(Sm

E

In particular, this gives a description of the ﬁrst principal persistence set of all spheres

with the Euclidean metric.

Corollary 5.18. For all m ≥ 2, DVR

4,1 (Sm

E ) = (cid:8)(tb, td)|0 ≤ tb < td ≤ min(

2tb, π)(cid:9).

√

Proof. By Proposition 5.17, for every m ≥ 3,

DVR

4,1 (Sm

E ) =

(cid:91)

λ∈[0,1]

λ · DVR

4,1 (S2

E).

However, it is clear that λ · DVR

4,1 (S2

E) ⊂ DVR

4,1 (S2

E), as the latter is convex. Thus,

(cid:91)

λ∈[0,1]

λ · DVR

4,1 (S2

E) = DVR

4,1 (S2

E),

and now, Proposition 5.13 gives the result.

48

Figure 15: The diagrams DVR
κ (cid:54)= 0. Also shown is DVR

4,1 (D0) for D0 ⊂ M0, a disk of radius 1.

4,1 (Dκ) for disks Dκ ⊂ Mκ of radius R = π/(cid:112)|κ| for various

Given that we know several persistence sets of spheres, we can use them, together with the
stability in Theorem 3.12, to ﬁnd lower bounds for the Gromov-Hausdorﬀ distance between
the circle and other spheres.

Example 5.19. Since DVR

4,1 (S1) ⊂ DVR

4,1 (S2),

dD
H(DVR

4,1 (S1), DVR

4,1 (S2)) =

sup
D2∈DVR

4,1 (S2)

inf
D1∈DVR

4,1 (S1)

dB(D1, D2).

4,1 (S2) \ DVR

4,1 (S1) and take D1 = (x1, y1) ∈ DVR

4,1 (S1)
Fix a diagram D2 = (x2, y2) ∈ DVR
arbitrary. The distance dB(D1, D2) can be realized by either the (cid:96)∞ distance between D1
and D2 or by half the persistence of either diagram (Deﬁnition 2.19), so in order to minimize
dB(D1, D2), let’s start by ﬁnding the minimum of (cid:107)D1 − D2(cid:107)∞ = max(|x1 − x2|, |y1 − y2|).
Clearly, this distance is smallest when D1 is on the line (cid:96) with equation y = 2(π −x) (case
k = 1 in Theorem 5.4). Additionally, the maximum is minimized when |x1 − x2| = |y1 − y2|.
If both conditions can be achieved, we will have minimized the (cid:96)∞ distance. The only
possibility, though, is x2 ≤ x1 and y2 ≤ y1 (if either inequality is reversed, the (cid:96)∞ distance
would be larger because (cid:96) has negative slope). In that case, the solutions to the system of
equations x1 −x2 = y1 −y2 and y1 = 2(π−x1) are x1 = 1
3(π−x2 +y2).
Thus,

3(2π+x2 −y2) and y1 = 2

d(cid:96)∞(D2, (cid:96)) =

(2π − 2x2 − y2).

1
3

This quantity is positive because x2, y2 is below (cid:96), that is, y2 ≤ 2π − 2x.

Now ﬁx D1 as the solution described in the previous paragraph and let D2 vary. The
distance dB(D1, D2) can be equal to 1
2pers(Di) if that quantity is larger than d(cid:96)∞(D2, (cid:96)) for
either i = 1, 2. Notice, also, that pers(D1) = pers(D2) because x1 − x2 = y1 − y2. If we can
ﬁnd D2 such that

1
2

pers(D2) = d(cid:96)∞(D2, (cid:96)),

(19)

then the maximum will have been achieved. Equation (19) can be simpliﬁed to y2 = − 1
5x2 +
4π
5 . The point D2 = (x2, y2) that realizes the Hausdorﬀ distance will be in the intersection
4,1 (S2) and have maximal persistence. That is achieved in the intersection
of this line and DVR

49

3

2.5

2

1.5

1

0.5

0

0

0.5

1

1.5

2

2.5

3

Figure 16: The point D2 that realizes the Hausdorﬀ distance between DVR
with respect to the bottleneck distance. The shaded region is DVR
5 , the region where 1
outline DVR
and (cid:96) is the line y = 2(π − x) ⊂ ∂(DVR

4,1 (S2). The blue line is y2 = − 1

4,1 (S1) and DVR
4,1 (S2)
4,1 (S1) and the black lines
2pers(D2) = d(cid:96)∞(D2, (cid:96)),

5x2 + 4π

4,1 (S1)).

with the left boundary, the curve x = 2 arcsin
That point is x2 ≈ 1.3788, y2 = 2.2375 (see Figure 16) and will give dD
0.4293. Thus,

(use κ = 1 in Theorem 5.16).
4,1 (S2) ≈

4,1 (S1), DVR

H(DVR

2

2

(cid:16) 1√

sin (cid:0) y

(cid:1)(cid:17)

dGH(S1, S2) ≥

1
2

H(DVR
dD

4,1 (S1), DVR

4,1 (S2)) ≈ 0.2147 ≈

π
14.6344

.

In the case of k ≥ 3, we can obtain a better bound.

Example 5.20. Let n = 2k + 2; we a seek lower bound for dGH(S1, Sk) for k ≥ 3. First,
similarly to Example 5.19, we have
n,k(S1), DVR

n,k(Sk)) =

dB(D1, D2).

dD
H(DVR

sup
D2∈DVR

n,k(Sk)

inf
n,k(S1)
D1∈DVR

We now exhibit a conﬁguration, more speciﬁcally, a cross-polytope X ⊂ Sk, in order to ﬁx a
speciﬁc diagram D2. Let X = {±e1, . . . , ±ek+1} ⊂ Rk+1, where ei is the i-th standard basis
vector. Notice that dSk(±ei, ±ej) = π
2 if j (cid:54)= i, and dSk(ei, −ei) = π. Then tb(ei) = tb(−ei) =
π
2 and td(ei) = td(−ei) = π, so tb(X) = π
2 and td(X) = π. Since X has 2k + 2 = n points, we
just proved that D2 = ( π

2 , π) ∈ DVR
H(DVR
dD

n,k(Sk). Then
n,k(Sk)) ≥

n,k(S1), DVR

inf
n,k(S1)
D1∈DVR

dB(D1, D2).

For concreteness, write D1 = {(x, y)}. Let ϕ : D1 → D2 be the unique bijection. By Lemma
5.2, x ≥ k

k+1π, so

J(ϕ) =

(cid:13)
(cid:13)
(cid:13)

(cid:16) π
2

(cid:17)

, π

− (x, y)

(cid:13)
(cid:13)
(cid:13)∞

≥ x −

π
2

≥

k − 1
2(k + 1)

π.

50

On the other hand, since y ≤ π, pers(D1) = y − x ≤ π
∅ : ∅ → ∅, we have

k+1. Thus, for the empty matching

J(∅) = max

(cid:18) 1
2

pers(D1),

(cid:19)

pers(D2)

=

1
2

1
2

pers(D2) =

π
4

.

4 ≤ k−1

2(k+1) π whenever k ≥ 3, we have dB(D1, D2) = minϕ J(ϕ) = π

4 for all D1 ∈

Since π
DVR

n,k(S1). Thus, by Theorem 3.12,

dGH(S1, Sk) ≥

1
2

H(DVR
dD

n,k(S1), DVR

n,k(Sk)) ≥

1
2

inf
n,k(S1)
D1∈DVR

dB(D1, D2) =

π
8

.

6 Concentration of persistence measures

By paring DF
an mm-space

n,k(X) with the persistence measure UF
n,k(X) := (cid:0)DF

n,k(X), dB, UF

DF

n,k(X), we can view persistence sets as
n,k(X)(cid:1) ∈ Mw,

where dB is restricted to pairs in DF

n,k(X) × DF

n,k(X).

The main result in this section is that DF

n,k(X) concentrates to a one-point mm-space ∗
as n → ∞. Since ∗ is generic, we also prove that the expected bottleneck distance between a
random diagram D ∈ DF
k(X), the degree-k persistence diagram of the space
n,k(X) concentrates to dgmF
X, goes to 0 as n → ∞, eﬀectively showing that DF
k(X) when
the latter is viewed as a one-point mm-space equipped with the trivial choices of metric and
probability measure.

n,k(X) and dgmF

Example 6.1 (The case of an mm-space with two points). Let X = {x1, x2} be a metric
space with two points at distance ε and mass µX(x1) = α, µX(x2) = 1−α for some α ∈ (0, 1).
For each n ∈ N, the matrices in Kn(X) are of the form M0 = 0 ∈ Rn×n
or MΠ = ΠT M1Π
for some Π ∈ Sn, where

+

M1 :=








0 ε 0 · · ·
ε 0 0 · · ·
. . .
0 0 0 · · ·

...








0
0
...
0

∈ Rn×n
+ .

For the curvature measure µn on Kn(X), we have wn := µn(M0) = αn + (1 − α)n. This
comes from choosing either all n points to be x1 or all to be x2. The rest of the mass is
distributed among the non-zero matrices of Kn(X). Notice that wn → 0 as n → ∞.

As for the persistence sets DVR
supported on the two point set DVR
D. From the computations above, UVR

n,k(X), the only interesting case is at k = 0. Here, UVR

n,0 is
n,0 (X) = {0D, (0, ε)}, where 0D is the empty diagram of

n,0 (0D) = wn and UVR

n,0 ((0, ε)) = 1 − wn.

51

The fact that wn → 0 as n → ∞ means that the mass concentrates on (0, ε), so, as an

mm-space, DVR

n,0 (X) is converging to the 1-point mm-space

(cid:0){(0, ε)}, 0, δ(0,ε)

(cid:1),

where δ(0,ε) is the Dirac delta measure concentrated on δ(0,δ). This is the persistence diagram
dgmVR

0 (X) viewed as a 1-point mm-space.

We now generalize this result.

6.1 A concentration theorem

Let (X, dX, µX) be an mm-space. Using terminology from [CM10b, Section 5.3], we deﬁne
the functions fX : R+ → R+ given by ε (cid:55)→ inf x∈X µX(Bε(x)). Note that fX(ε) > 0 for every
ε > 0 since supp(µX) = X is compact. Deﬁne also

given by

CX : N × R+ → R+

(n, ε) (cid:55)→

e−nfX (ε/4)
fX(ε/4)

.

The relevant result from that paper is the following:

Theorem 6.2 (Covering theorem [CM10b, Theorem 34]). Let (X, dX, µX) be an mm-space.
For a given n ∈ N and ε > 0 consider the set

QX(n, ε) := {(x1, . . . , xn) ∈ X n|dX

H({xi}n

i=1, X) > ε}.

Then

µ⊗n
X (QX(n, ε)) ≤ CX(n, ε).

We now prove our concentration result.

Theorem 6.3. Let (X, dX, µX) be an mm-space and take any stable ﬁltration functor F.
For any n, k ∈ N, consider the random variable D valued in DF
n,k(X) distributed according
to UF

n,k(X). Then:

• For any ε > 0, EUF

n,k(X)

(cid:2)dB

(cid:0)D, dgmF

k(X)(cid:1)(cid:3) < diam(X) · CX(n, ε) + ε.

• As a consequence, the mm-space DF
one-point mm-space as n → ∞.

n,k(X) = (cid:0)DF

n,k(X), dB, UF

n,k(X)(cid:1) concentrates to a

Proof. Fix ε > 0. Let X = (x1, . . . , xn) ∈ X n be a random variable distributed according
n,k(X) is the push-forward of the product measure µ⊗n
to µ⊗n
X under the map

X . Since UF

52

k ◦ Ψ(n)

Ψ(n)
X : X n → Kn(X) → D, we have D = dgmF
dgmF
change of variables to rewrite the expected value of dB(D, dgmF
k(X)) as follows:
(cid:105)
X (X)
(cid:105)
X (X)

k(X)
(cid:17)
k(X)

k(X)(cid:1)(cid:3) = Eµ⊗n

dgmF
k
(cid:104)

(cid:0)D, dgmF

, dgmF

, dgmF

dgmF
k

(cid:104)
dB

Ψ(n)

Ψ(n)

EUF

(cid:2)dB

n,k(X)

(cid:17)(cid:105)

dB

=

(cid:16)

(cid:16)

(cid:90)

(cid:104)

X

k

(cid:16)

(cid:17)
X (X)

X (dX).
µ⊗n

. Then, we can make a

X n

By stability of F, the last integral is bounded above by

(cid:90)

L(F)

X n

dGH(X, X) µ⊗n

X (dX) ≤ L(F)

(cid:90)

X n

dH(X, X) µ⊗n

X (dX),

where, by abuse of notation, we see X as a sub-metric space of X. In that case, dH(X, X) =
radX(X) ≤ diam(X), so we split the above integral into the sets QX(n, ε) and X n\QX(n, ε):

(cid:90)

X n

(cid:90)

(cid:90)

X n

dH(X, X) µ⊗n

X (dX) =

=

≤

QX (n,ε)

(cid:90)

QX (n,ε)

radX(X) µ⊗n

X (dX)

radX(X) µ⊗n

X (dX) +

radX(X) µ⊗n

X (dX)

diam(X) µ⊗n

X (dX) +

ε µ⊗n

X (dX)

(cid:90)

X n\QX (n,ε)
(cid:90)

X n

= diam(X) · µ⊗n
< diam(X) · CX(n, ε) + ε.

X (QX(n, ε)) + ε

This proves the ﬁrst claim.

To show that DF

n,k(X) concentrates for a point, we will show that dGW,1

For any mm-space (Z, dZ, µZ),

dGW,1(Z, ∗) =

(cid:90) (cid:90)

1
2

Z×Z

dX(z, z(cid:48)) µZ(dz) µZ(dz(cid:48)).

Then, using the triangle inequality,

(cid:0)DF

n,k(X), ∗(cid:1) → 0.

dGW,1

(cid:0)DF

n,k(X), ∗(cid:1) =

≤

=

1
2

1
2
(cid:90)

(cid:90) (cid:90)

DF

n,k(X)×DF

n,k(X)

(cid:90) (cid:90)

DF

n,k(X)×DF

n,k(X)

dB(D, D(cid:48)) UF

n,k(dD) UF

n,k(dD(cid:48))

(cid:2)dB(D, dgmF

k(X)) + dB(dgmF

k(X), D(cid:48))(cid:3) UF

n,k(dD) UF

n,k(dD(cid:48))

dB(D, dgmF

k(X)) UF

n,k(dD)

DF

n,k(X)

(cid:2)dB
= EUF
< diam(X) · CX(n, ε) + ε.

(cid:0)D, dgmF

n,k(X)

k(X)(cid:1)(cid:3)

However, for any ﬁxed ε, CX(n, ε) → 0 as n → ∞. Thus, EUF
n,k(X), ∗(cid:1) → 0.
and, with that, dGW,1

(cid:0)DF

n,k(X)

(cid:2)dB

(cid:0)D, dgmF

k(X)(cid:1)(cid:3) → 0

53

k(X)(cid:1)(cid:3) in the
Remark 6.4. We can give an explicit upper bound for EUF
case that µX is Ahlfors regular. Given d ≥ 0, µX is Ahlfors d-regular if there exists a constant
C ≥ 1 such that

(cid:0)D, dgmF

(cid:2)dB

n,k(X)

rd
C

≤ µX(Br(x)) ≤ Crd

for all x ∈ X.

To get the upper bound, set ε = 4C 1/d (cid:0) ln n

(cid:1)1/d. If µX is Ahlfors d-regular,

n

fX(ε/4) = inf
x∈X

µX(Bε/4(x)) ≥

(ε/4)d
C

=

ln(n)
n

,

CX(n, ε) =

e−nfX (ε/4)
fX(ε/4)

≤

e− ln(n)
ln(n)/n

=

1
ln(n)

.

and

Then,

EUF

n,k(X)

(cid:2)dB

7 Coordinates

(cid:0)D, dgmF

k(X)(cid:1)(cid:3) < diam(X) · CX(n, ε) + ε
(cid:18)ln n
diam(X)
n
ln(n)

+ 4C 1/d

≤

(cid:19)1/d

.

The objects UF
n,k(X) can be complex, so it is important to ﬁnd simple representations of
them. Since these objects are probability measures on the space of persistence diagrams
D, we follow the statistical mechanics intuition and probe them via functions. In order to
accomplish this, one should concentrate on families of functions ζα : D → R, for α in some
index set A. One example of a family that is compatible with this is the so called maximal
persistence of a persistence diagram: ζ(D) = max(tb,td)∈D(td − tb). In general, one may desire
to obtain a class of coordinates [ACC16, Kal19] that are able to more or less canonically
exhaust all the information contained in a given persistence diagram. A further desire is to
design the class {ζα}α∈A in such a manner that it provides stable information about a given
measure U ∈ P1(D).

A ﬁrst step in this direction is a stability result. To set up notation, let F be a ﬁltration
functor. Let n ≥ 0, k ≥ 0 be integers, and take an mm-space (X, dX, µX). Consider a
n,k(X) is a probability measure on R.
coordinate function ζ : D → R. The pushforward ζ#UF
n,k(X)(cid:0)ζ −1(−∞, t](cid:1) deﬁned for
We denote its distribution function by HX(t; n, k, F, ζ) := UF
t ∈ R.

Theorem 7.1. Let ζ : D → R be an L(ζ)-Lipschitz coordinate function, and suppose F is a
stable ﬁltration functor. Write HX(t) = HX(t; n, k, F, ζ) to simplify the notation. Then, for
any two mm-spaces X and Y ,

(cid:90)

R

|HX(t) − HY (t)|dt ≤ L(ζ)L(F) · dGW,1(X, Y ).

54

Proof. According to [M´em11, Lemma 6.1],

(cid:90)

R

|HX(t) − HY (t)| dt ≤ inf
µ∈MU

(cid:90)

|ζ(D) − ζ(D(cid:48))| µ (dD × dD(cid:48)) ,

DF

n,k(X)×DF

n,k(Y )

where MU is the set of couplings between UF
right side is bounded above by

n,k(X) and UF

n,k(Y ). Since ζ is Lipschitz, the

(cid:90)

L(ζ) ·

inf
µ∈MU

dB(D, D(cid:48)) µ (dD × dD(cid:48))

n,k(X) × DF

n,k(Y ))

DF

= L(ζ) ·

n,k(Y )
diamD,1(DF

n,k(X)×DF
inf
µ∈MU
n,k(X), UF
W,1(UF
≤ L(ζ)L(F) · dGW,1(X, Y ).

= L(ζ) · dD

n,k(Y ))

Theorem 3.17 gives the last bound.

8 Persistence sets of metric graphs

Let G be a metric graph; see [BBI01, Mug19, MO18] for a deﬁnition. The central question
in this section is what features of G are detected by DVR
2k+2,k(G). A ﬁrst setting is the one
when G is a tree.

Lemma 8.1. Let k ≥ 1. For any metric tree T and any X ⊂ T with |X| = n, PHk(X) = 0
and, thus, DVR
n,k(T ) is empty. In particular, if n = 2k + 2, then tb(X) ≥ td(X).

Proof. Any subset X ⊂ T is a tree-like metric space. By Theorem 2.1 of the appendix of
[CCR13], the persistence module PHk(X) is 0 for any k ≥ 1. In particular, if n = 2k + 2,
Theorem 4.4 implies that tb(X) ≥ td(X).

In other words, a metric graph G must have a cycle if DVR

n,k(G) is to be non-empty, and
even if it does, not all conﬁgurations X ⊂ G with |X| = n produce persistence. As we will
see in Example 8.4, even if there is no tree X (cid:44)→ T (cid:44)→ G, X can still be a tree-like metric
space. For this reason, it would be useful to have a notion of a minimal graph containing
X. At least in the case n = 4, split metric decompositions provide a nice framework for our
questions.

8.1 Split metric decompositions

We follow the exposition in [BD92]. Let (X, dX) be a ﬁnite pseudo-metric space. Given a
partition X = A ∪ B, the split metric δA,B is deﬁned as the function

δA,B(x, y) :=

(cid:40)

if x, y ∈ A or x, y ∈ B,

0,
1, otherwise.

55

Let

β{a,a(cid:48)},{b,b(cid:48)} :=

1
2

(cid:0) max [dX(a, b) + dX(a(cid:48), b(cid:48)), dX(a, b(cid:48)) + dX(a(cid:48), b), dX(a, a(cid:48)) + dX(b, b(cid:48))]

− dX(a, a(cid:48)) − dX(b, b(cid:48))(cid:1),

and deﬁne the isolation index αA,B as

αA,B = min (cid:8)β{a,a(cid:48)},{b,b(cid:48)}

(cid:12)
(cid:12) a, a(cid:48) ∈ A and b, b(cid:48) ∈ B(cid:9) .

Notice that both αA,B and β{a,a(cid:48)},{b,b(cid:48)} are non-negative. If the isolation index αA,B is non-
zero, then the unordered partition A, B is called a dX-split. The main theorem regarding
isolation indices and split metrics is the following.

Theorem 8.2 ([BD92]). Any (pseudo-)metric dX on a ﬁnite space can be written uniquely
as

dX = d0 +

αA,BδA,B

(cid:88)

where d0 is a (pseudo-)metric that has no d0-splits (also called split-prime metric), and the
sum runs over all dX-splits A, B.

In what follows, we may write δA,B and αA,B as δa1,...,an and αa1,...,an, respectively, when

A = {a1, . . . , an}, and X and B = X \ A are clear from the context.

Let’s focus on the case in which X has 4 points.

It has been shown that dX has no
split-prime component and, when A = {a, a(cid:48)} and B = {b, b(cid:48)}, αA,B = βA,B. Furthermore,
there is at least one such partition for which dX(a, a(cid:48)) + dX(b, b(cid:48)) is maximal, which implies
αA,B = 0. In that case, X can be isometrically embedded in the graph ΓX shown in Figure
17. We now study the persistence diagram of X.

x2

αx2

αx3

x3

b

αx1

c

αx4

x1

x4

Figure 17: The graph ΓX resulting from the split-metric decomposition of a metric space
i=1 αxiδxi +
with 4 points.
αx1,x2δx1,x2 + αx1,x4δx1,x4.

In this case, αx1,x3 = 0, b = αx1,x4, c = αx1,x2, and dX = (cid:80)4

Proposition 8.3. Let X ⊂ ΓX be the metric space shown in Figure 17, and let ai = αxi, b =
αx1,x4 and c = αx1,x2.

56

1. If tb(X) < td(X), then tb(X) = max(d12, d23, d34, d41) and td(X) = min(d13, d24).

2. tb(X) < td(X) if, and only if,

|a2 − a1| < b, and |a4 − a3| < b,
|a3 − a2| < c, and |a1 − a4| < c.

(20)

3. td(X) − tb(X) ≤ min(a, b), regardless of whether tb(X) < td(X) or not.

Proof. 1. The desired conclusion is equivalent to vd(x1) = x3 and vd(x2) = x4. Suppose,
though, that vd(x1) = x4 and vd(x2) = x3. In particular, this means that d13 < d14 and
d24 < d23, and these inequalities are equivalent to

a1 + (b + c) + a3 < a1 + c + a4
a2 + (b + c) + a4 < a2 + c + a3.

After rearranging them, we get

b < a4 − a3 < −b,
a contradiction. The case vd(x1) = x4 and vd(x2) = x3 follows analogously, so vd(x1) = x3
and vd(x2) = x4.
2. Notice that the inequalities d23 < d13 and d14 < d24 are equivalent to

a2 + c + a3 < a1 + (b + c) + a3
a1 + c + a4 < a2 + (b + c) + a4,

which, after rearranging terms, result in −b < a2 − a1 < b. Using similar combinations, we
ﬁnd that max(d12, d23, d34, d41) < min(d13, d24) is equivalent to the system of inequalities in
(20). If these hold, then tb(X) = max(d12, d23, d34, d41) < min(d13, d24) = td(X). Conversely,
if tb(X) < td(X), then item 1 and the reasoning above imply (20).
3. If tb(X) ≥ td(X), the bound is trivially satisﬁed. Suppose then, without loss of generality,
that tb(X) = d12. Since a3 + b + a4 = d34 ≤ d12 = a1 + b + a2, we have

≤

[d13 + d24] − d12

td(X) − tb(X) = min(d13, d24) − d12
1
2
1
2
1
2
= c.

≤

=

[a1 + a2 + a3 + a4 + 2(b + c)] − (a1 + b + a2)

[a1 + a2 + (a1 + a2) + 2(b + c)] − (a1 + a2) − b

On the other hand, d14 ≤ d12 and d23 ≤ d12 give a4 + c ≤ a2 + b and a3 + c ≤ a1 + b. Then

td(X) − tb(X) ≤

1
2
1
2
= b.

≤

[a1 + a2 + a3 + a4 + 2(b + c)] − (a1 + b + a2)

[a1 + a2 + (a1 + a2) + 4b] − (a1 + a2) − b

57

Figure 18: A graph formed by the wedge of two circles at 0. Left: ΓX is a tree. Center: One
circle contains three points, while the other only has one. Right: Both circles have two out
of four points.

In summary, td(X) − tb(X) ≤ min(a, b).

The following examples illustrate uses of Proposition 8.3.

Example 8.4. Let λ1 (cid:54)= λ2 positive numbers. Let G = ( λ1
circles of diameters λ1, λ2 at a common point p0. The set DVR
bounded by 2(λi − tb) ≤ td and tb < td ≤ λi with vertices ( 1
(see Remark 5.6). By functoriality of persistence sets, we have DVR
DVR

π · S1) ∨ ( λ2
4,1 ( λi
2λi, λi), ( 2
4,1 ( λ1

4,1 (G). We now show that equality holds.
Let X = {x1, x2, x3, x4} ⊂ G, and dij = dG(xi, xj). Deﬁne Xi = X ∩ ( λi
4,1 ( λj

Xi = ∅, then X is contained in the other λj
then, that X1 and X2 are non-empty. Two cases follow.

π · S1, and dgmVR

1 (X) ∈ DVR

π · S1) be a wedge of two
π · S1) is the triangle in R2
3λi), and (λi, λi)
π · S1) ⊂
4,1 ( λ2

π · S1) ∪ DVR

3λi, 2

π · S1). If either
π · S1). Suppose,

First, assume X2 = {x4}, and set X (cid:48) = {p0, x1, x2, x3}. Let t = dG(p0, x4). For i = 1, 2, 3,
di4 = dG(xi, p0) + t, so tb(X (cid:48)) ≤ tb(X) and td(X (cid:48)) ≤ td(X). If tb(X (cid:48)) < td(X (cid:48)), suppose
further that vd(x1) = x3 and vd(x2) = x4. Then 2λ1 ≤ 2tb(X (cid:48)) + td(X (cid:48)) ≤ 2tb(X) + td(X)
In other words, if the
and td(X) ≤ td(x1) = d13 ≤ λ1, regardless of the position of x4.
π · S1), then either tb(X) is still smaller than td(X) and
point (tb(X (cid:48)), td(X (cid:48))) ∈ DVR
(tb(X), td(X)) ∈ DVR
1 (X) is empty.
Even if tb(X (cid:48)) ≥ td(X (cid:48)), it might be possible that tb(X) < td(X). However, several
conditions must be met. First, d13 must be larger than d12 and dG(x1, p0) in order to have
vd(x1) = x3. In that case, td(X) ≤ d13, so we also need tb(X (cid:48)) < d13. Also, tb(X (cid:48)) cannot be
dG(xi, p0) because otherwise, tb(X) = dG(xi, p0) + t = tb(X (cid:48)) + t ≥ td(X (cid:48)) + t ≥ td(X). For
that, the only option is tb(X (cid:48)) = d12 (since d23 < dG(x2, p0) ≤ tb(X (cid:48))). Then,

π · S1), or tb(X) becomes larger than td(X) and dgmVR

4,1 ( λ1

4,1 ( λ1

so d12 > 2λ1

3 , and we have

2λ1 = d12 + d24 + d34 < 3d12,

tb(X) ≥ tb(X (cid:48)) >

2λ1
3
td(X) ≤ td(X (cid:48)) ≤ λ1.

,

58

This point is also contained in DVR

4,1 ( λ1

π · S1), so no new persistence is generated.

For the second case, let X1 = {x1, x2} and X2 = {x3, x4}. Let ai = dG(xi, p0). Notice

that dG(xi, xj) = ai + aj for i ∈ {1, 2} and j ∈ {3, 4}. Then:

dG(x1, x3) + dG(x2, x4) = dG(x1, x4) + dG(x2, x3) = a1 + a2 + a3 + a4,
dG(x1, x2) + dG(x3, x4) ≤ a1 + a2 + a3 + a4.

In consequence,

αx1,x3 = βx1,x3

=

1
2

(cid:2) max (cid:0)dG(x1, x3) + dG(x2, x4), dG(x1, x4) + dG(x2, x3), dG(x1, x2) + dG(x3, x4)(cid:1)

− dG(x1, x3) − dG(x2, x4)(cid:3)

= 0.

Analogously, αx1,x4 = 0 ≤ αx1,x2. Then b = 0 in Proposition 8.3 and item 3 gives that
dgmVR

1 (X) is the empty diagram. Note, in particular, that ΓX is a tree.
In summary, we’ve shown that if X1 and X2 are both non-empty, then either dgmVR

4,1 ( λ1

π · S1) ∪ DVR

4,1 ( λ2

π · S1). Thus, DVR

4,1 (G) = DVR

4,1 ( λ1

1 (X)
π · S1) ∪

is empty or it is in the union DVR
DVR

4,1 ( λ2

π · S1).

Example 8.4 shows that a conﬁguration X ⊂ G produces persistence only if it is close
π · S1, or only one
to a cycle. That can happen when either X is contained in a circle λi
π · S1. In both cases, the graph ΓX contains a cycle since both a and
point is outside of λi
b are non-zero. If |X1| = |X2| = 2, on the other hand, then ΓX is a tree. This might lead
to conjecture that DVR
4,1 (C), where C ⊂ G is a cycle.
However, the following examples show otherwise.

4,1 (G) decomposes as the union of DVR

Example 8.5. Let G be a graph formed by attaching edges of length L to a circle S1 at
If X ⊂ S1, then no new
the points y1 ≺ y2 ≺ y3 ≺ y4. Let X = {x1, x2, x3, x4} ⊂ G.
persistence is produced, so the points in X have to be in the attached edges. Also, if tb(X)
is to be smaller than td(X), then each xi must be on a diﬀerent edge. For example, if x1
and x2 are on the edge attached to y1, and x3 and x4 are on the edges adjacent to y3 and y4,
respectively, let X (cid:48) = {x1, x2, y3, y4}. This X (cid:48) consists of two points inside of a cycle and two
points outside, so as we saw in Example 8.4 when |X1| = |X2| = 2, X (cid:48) is a tree-like metric
space, and attaching edges at y3 and y4 doesn’t change that. Thus, X is also a tree-like
metric space.

Suppose, then, that each xi is on the edge attached to yi. Since the decomposition in

Theorem 8.2 is unique, the isolation indices of the metrics of X and Y satisfy:

α{xi},X\{xi} = α{yi},Y \{yi} + dG(xi, yi),

α{xi,xj },{xh,xk} = α{yi,yj },{yh,yk},

59

where {i, j, h, k} = {1, 2, 3, 4}. Suppose that α{y1,y3},{y2,y4} = 0, and let

m = min(α{y1,y2},{y3,y4}, α{y1,y4},{y2,y3}).

By Proposition 8.3, td(X) − tb(X) ≤ m, so

DVR

4,1 (G) ⊂ DVR

4,1 (S1) ∪ {(tb, td) | tb(Y ) ≤ tb < td ≤ tb + m, and tb ≤ tb(Y ) + 2L}.

Observe that DVR

4,1 (G) can have more points than DVR

4,1 (C). For example, if tb(Y ) < td(Y ),

then the point (tb(Y ) + 2L, td(Y ) + 2L) ∈ DVR

4,1 (G).

Figure 19: A cycle C with four edges of length L=1 attached. This ﬁgure was obtained
by sampling 100,000 conﬁgurations of 4 points from G. About 7.6% of those conﬁgurations
produced a non-diagonal point.

Remark 8.6. It is curious to note that,
DVR
In other words, DVR
complex doesn’t. See Figure 19 for an example.

4,1 (G) (cid:54)= DVR

4,1 (C).

in the last example, VR(G) (cid:39) VR(C), but
4,1 detects a feature of G that the Vietoris-Rips

Example 8.7. Let G be the graph with edges of length 1 shown in Figure 20. Let C be
the cycle that passes through the vertices 1, 2, 6, 5, 8, 7, 3, 4. C has length 8, but there is no
point (2, 4) in DVR
4,1 (G). The reason is that the shortest path between points in C is often
not contained in C, and so C is not isometric to a circle. For example, the edge [1, 5] is not
contained in C despite it being the shortest path from 1 to 5.

8.2 A family of metric graphs whose homotopy type can be char-

acterized via DVR
4,1 .
π · S1) also
4,1 ( λ
Given an isometric embedding λ
π · S1) that has td = 2tb.
appears in DVR
Compare that to the recent examples in which there is a triangle in DVR
4,1 (G), coming from
such an embedding, that is clearly distinguishable from the rest of the diagram. At this point,

π · S1 (cid:44)→ G, the upper corner (λ/2, λ) ∈ DVR

4,1 (G). Moreover, (λ/2, λ) is the only point in DVR

4,1 ( λ

60

1234567891001234500.511.522.533.544.55Figure 20: A graph G with a cycle not isometric to a circle. This ﬁgure was obtained by
sampling 100,000 conﬁgurations of 4 points from G. About 13% of those conﬁgurations
produced a non-diagonal point.

we can ask if there are conditions on G so that a point (tb, td) ∈ DVR
4,1 (G) with td = 2tb must
π · S1 (cid:44)→ G. It turns out that this is the right question, but
come from a conﬁguration X ⊂ λ
the condition that G has to satisfy is elaborate. Before describing it, we prove a preliminary
result.

Lemma 8.8. Let k ≥ 0 and n = 2k+2, and take (X, dX) ∈ M. Suppose (λ/2, λ) ∈ DVR
n,k(X).
Then there exists a set Y = {x1, . . . , xn} ⊂ X with tb(Y ) = λ/2, td(Y ) = λ such that
dX(xi, vd(xi)) = λ and dX(xi, x) = λ/2 for every i and x ∈ Y , x (cid:54)= vd(xi).

Proof. If (λ/2, λ) ∈ DVR
td(Y ) = λ. For any i and x ∈ Y , x (cid:54)= vd(xi), the deﬁnition of tb(Y ) and td(Y ) gives

n,k(X), there exists Y ⊂ X with |Y | = n such that tb(Y ) = λ/2 and

λ ≤ td(xi) = dX(xi, vd(xi)) ≤ dX(xi, x) + dX(x, vd(xi)) ≤ tb(xi) + tb(vd(xi)) ≤ λ.

Hence, dX(xi, vd(xi)) = λ and dX(xi, x) = dX(x, vd(xi)) = λ/2.

In particular, if (λ/2, λ) ∈ DVR

4,1 (G) for a metric graph G, then there exists a “square”
X ⊂ G. By square, we mean that if X = {x1, x2, x3, x4}, then dG(xi, xi+1) = λ/2 and
dG(xi, xi+2) = λ. It is tempting to suggest that X is contained in a cycle C ⊂ G isometric
π · S1, but this is not always the case. An example is shown in Figure 21. However, if G
to λ
satisﬁes the hypothesis of Theorem 8.10, then at least we can ensure that X lies in a speciﬁc
subgraph. Before that, we need one more preparatory result which was inspired by Theorem
3.15 in [AAG+20].

Lemma 8.9. Let G = G1 ∪A G2 be a metric gluing of the graphs G1 and G2 such that
A = G1 ∩ G2 is a closed path of length α. Let (cid:96)j be the length of the shortest cycle contained
in Gj that intersects A, and set (cid:96) = min((cid:96)1, (cid:96)2). Assume that α < (cid:96)
2. Then the shortest path
π · S1 (cid:44)→ G is
γuv between any two points u, v ∈ A is contained in A. As a consequence, if λ
an isometric embedding, then λ

π · S1 is contained in either G1 or G2.

61

12345678012300.511.522.53Figure 21: A graph G and a set X ⊂ G such that tb(X) = π/2 and td(X) = π. Notice that
the outer black cycle C contains X but is not isometric to a circle. If it were, the shortest
path in G between p1 and p2 would be contained in C, but that path is the blue edge of
length π − ε.

Figure 22: Any path in G1 between u and v has length greater than α.

62

Proof. Let γ be any path that joins u and v, and is contained in either G1 or G2 but not
in A; see Figure 22. Then γ ∪ γuv contains a cycle C that intersects A. Since γuv ⊂ A, its
length is smaller than α. Then

2α < (cid:96) ≤ |γ| + |γuv| = |γ| + α.

Thus, |γ| > α ≥ |γuv| = dG(u, v).

Now, a cycle C ⊂ G is isometric to λ

π · S1 if there is a shortest path between any x, x(cid:48) ∈ C
contained in C. If C ∩ A has several connected components, then C can be decomposed as
the union of paths in A and paths contained in G1 or G2. If we pick two points u and v that
lie in diﬀerent connected components of G ∩ A, then the shortest sub-path of C between
them will contain a sub-path that lies either in G1 or G2. By the previous paragraph, the
sub-path contained in G1 or G2 has length larger than α ≥ dG(u, v). Thus, the shortest
π · S1. Instead, the only
path between u and v lies outside of C, so C is not isometric to λ
π · S1 is that C ∩ A is either empty or connected. This
possibility for C to be isometric to λ
implies C ⊂ G1 or C ⊂ G2.

The next theorem is the main result of this section, and it is a generalization of Example
S1, and we showed that if X has tb(X) < td(X) then in the
S1 ∪p0
8.4. In that case, G = λ1
π
S1. We cannot make such a
worst case, only one point of X lies outside of either λ1
π
strong statement in general, but the result can still be useful. The idea is similar to Lemma
8.9. We show that if a conﬁguration X ⊂ G1 ∪A G2 with 4 points has the speciﬁc condition
td(X) = 2tb(X) (as opposed to just tb(X) < td(X)), then it is contained in either G1 or G2.

S1 or λ2
π

λ2
π

Theorem 8.10. Let G = G1 ∪A G2 be a metric gluing of the graphs G1 and G2 such that
A = G1 ∩ G2 is a path of length α. Let (cid:96)j be the length of the shortest cycle contained in Gj
that intersects A, and set (cid:96) = min((cid:96)1, (cid:96)2). Assume that α < (cid:96)
3. If X = {x1, x2, x3, x4} ⊂ G
satisﬁes tb(X) = λ/2 and td(X) = λ, then either X ⊂ G1 or X ⊂ G2.

Proof. Let γij be a shortest path in G from xi to xj. Let X1 = X ∩ G1 and X2 = X ∩ G2.
We decompose a path γ as γ(1) ∪ γ(A) ∪ γ(2), where γ(i) ⊂ Gi, γ(A) ⊂ A and each intersection
γ(i) ∩ γ(A) is a single point. We will break down the proof depending on the size of X1 and
X2.

Case 0: If either X1 or X2 is empty, the theorem holds immediately.

Case 1: X1 or X2 is a singleton.
Suppose that X1 = {x1} (see Figure 23). Let u = γ(1)

8.9, dG(u, v) < |γ(1)
21 ∪ γ(A)
24 = γ(2)
γ(cid:48)

21 | + |γ(1)
21 ∪ γuv ∪ γ(A)

14 ∩ A. By Lemma
14 |. However, if γuv is a shortest path between u and v, then
14 ∪ γ(2)

14 is a path between x2 and x4 such that

21 ∩ A and v = γ(1)

21 | + |γuv| + |γ(A)
21 | + |γ(1)
21 | + |γ(1)

14 | + |γ(2)
14 |
14 | + |γ(2)
14 | + |γ(A)
14 |

|γ(cid:48)

21 | + |γ(A)
24| ≤ |γ(2)
21 | + |γ(A)
< |γ(2)
= |γ21| + |γ14|
= λ.

63

Figure 23: Case 1: x1 ∈ G1 and x2, x3, x4 ∈ G2.

Figure 24: Case 3: X1 = {x1, x2} and X2 = {x3, x4}.

This contradicts the assumption that dG(x2, x4) = λ.

Case 2: |X1| = |X2| = 2.
In this case, we have two ways to distribute the points of X, depending on whether we
pair together the points that are at distance λ/2 or λ. If we choose the second option, we can
write X1 = {x1, x3} and X2 = {x2, x4}. The path γ12 ∪γ23 ∪γ31 is a cycle in G that intersects
both G1 and G2. Let u = γ(1)
23 ∩ A, and let γuv ⊂ A be a path between
them. By Lemma 8.9, dG(u, v) < |γ(2)
23 | + |γ(A)
23 |, so following the reasoning of
12 ∪ γuv ∪ γ(1)
Case 1, γ(1)
23 is a path between x1 and x3 with length less than |γ12| + |γ23| = λ.
This is again a contradiction.

12 ∩ A and v = γ(1)
12 | + |γ(A)

12 | + |γ(2)

Case 3: X1 = {x1, x2} and X2 = {x3, x4}. (See Figure 24)

Let u = γ(1)

14 ∩ A, and v = γ(1)

23 ∩ A. By the triangle inequality,

λ = dG(x1, x3) ≤ dG(x1, u) + dG(u, v) + dG(v, x3).

Analogously,

λ ≤ dG(x2, v) + dG(v, u) + dG(u, x4).

64

(21)

(22)

On the other hand, since γ23 is the shortest path between x2 and x3 and it passes through v,

λ/2 = dG(x2, x3) = dG(x2, v) + dG(v, x3).

If there existed a path between v and x3 of length smaller than dG(v, x3), then the concate-
nation of that path and γ(1)
23 would give a path between x2 and x3 shorter than γ23. The
same reasoning applies to x2 and v, so the above equality holds. By a similar argument, we
get λ/2 = dG(x1, u) + dG(u, x4). Adding these two equations gives

dG(x1, u) + dG(x2, v) + dX(v, x3) + dG(u, x4) = λ,

and combining this last equation with (21) and (22) produces, respectively,

dG(x2, v) + dG(u, x4) ≤ dG(u, v)
dG(x1, u) + dG(v, x3) ≤ dG(v, u).

(23)
(24)

Then, using 24 and 21, we obtain

λ ≤ 2dG(u, v).

Furthermore, since u, v ∈ A, we get λ/2 ≤ dG(u, v) ≤ α.

Now we further break down case 3 depending on whether γ12 and γ34 intersect A or not.

Case 3.1: Suppose that γ12 intersects A.
Write γ12 = γ(1)

12 , and let wi = γ(i)

12 ∪ γ(2)

12 ∪ γ(A)

12 ∩ γ(A)

12 . Let γw1 be a shortest path between

u and w1. By the triangle inequality,

|γw1| = dG(u, w1) ≤ dG(u, x1) + dG(x1, w1) ≤ dG(x1, x4) + dG(x1, x2) = λ.

14 ∪ γw1 ∪ γ(1)

If u (cid:54)= w1, then γ(1)
is a cycle that intersects A of length at most 2λ ≤ 2α.
Then, (cid:96) is smaller than 2α by deﬁnition. However, this is a contradiction because 3α < (cid:96)
by hypothesis. Thus, w1 = u, and an analogous argument shows that w2 = v. Since γ12 is a
shortest path between x1 and x2,

12

λ/2 = dG(x1, x2)

= dG(x1, w1) + dG(w1, w2) + dG(w2, x2)
= dG(x1, u) + dG(u, v) + dG(v, x2)
≥ dG(u, v) ≥ λ/2.

Thus, x1 = u and x2 = v. In other words, X1 ⊂ A ⊂ G2, so X = X1 ∪ X2 ⊂ G2. Naturally,
if γ34 intersected A instead of γ12, then an analogous argument would give X ⊂ G1.

Case 3.2: Neither γ34 nor γ12 intersect A (see Figure 25).

65

Figure 25: Case 3.2: The paths between points of X form a cycle in G.

Once more, let u = γ(1)

23 ∩ A, and ν = dG(u, v). Deﬁne the cycles C =
γ12 ∪ γ23 ∪ γ34 ∪ γ41, C1 = γ12 ∪ γ(1)
23 ∪ γ(2)
23 .
Set L = |C| and Lj = |Cj| for j = 1, 2. Clearly, L = 2λ and L1 + L2 − 2ν = L = 2λ. For
this reason, write λ = L1+L2

41 and C2 = γ34 ∪ γ(2)

41 ∪ γuv ∪ γ(A)

23 ∪ γuv ∪ γ(1)

41 ∪ γ(A)

14 ∩ A, v = γ(1)

2 − ν.

For brevity, let δ1 = dG(x1, u), δ2 = dG(x2, v), δ3 = dG(x3, v), and δ4 = dG(x4, u). By

deﬁnition of u and v, we have

λ/2 = dG(x1, x4) = dG(x1, u) + dG(u, x4) = δ1 + δ4,

λ/2 = dG(x2, x3) = δ2 + δ3.

L1 = |γ12| + |γ(1)

23 | + |γuv| + |γ(1)
14 |

= dG(x1, x2) + dG(x2, v) + dG(u, v) + dG(u, x1)
= λ/2 + δ2 + ν + δ1,

and

Additionally,

and

L2 = |γ34| + |γ(2)

41 ∪ γ(A)

41 | + |γuv| + |γ(A)

23 ∪ γ(2)
23 |

= dG(x3, x4) + dG(x4, u) + dG(u, v) + dG(v, x3)
= λ/2 + δ4 + ν + δ3.

(25)

(26)

(27)

(28)

If we interpret the δi as variables and L1, L2, ν, and λ as constants, equations (25) - (28)
form a system of 4 equations with 4 variables. It can be seen that the matrix of coeﬃcients
has rank 3, so the solution has one parameter. Thus, choosing δ4 = t gives the general

66

solution

δ1 = λ/2 − t
δ2 = L1 − λ − ν + t
δ3 = L2 − λ/2 − ν − t
δ4 = t.

(29)

This means that there exists a particular number 0 ≤ t ≤ λ/2 such that the distances between
points of X and u and v are given by the equations above. With this tool at hand, we now
claim that at least one of the paths γ1 := γ(1)
14 ∪ γuv ∪ γ(1)
23
has length less than λ. This would imply that either dG(x1, x3) or dG(x2, x4) is less than λ,
violating the assumption that td(X) = λ.

23 or γ2 := γ(2)

14 ∪ γuv ∪ γ(A)

14 ∪ γ(A)

23 ∪ γ(2)

An equivalent formulation of the claim is

max
t

(min(|γ1|, |γ2|)) < λ.

(30)

If this inequality holds, then either |γ1| or |γ2| is smaller than λ, regardless of the value of t.
Notice, though, that |γ1| = δ1 + ν + δ3 and |γ2| = δ4 + ν + δ2. Using the equations in (29),
we see that |γ1| + |γ2| = L1 + L2 − λ is a quantity independent of t. Thus, the maximum in
(30) is achieved when |γ1| = |γ2|. This happens when t = 1

4(L2 − L1 + λ), and gives

|γ1| =

L1 + L2
2

− ν −

λ
2

=

L1 + L2
4

+

ν
2

The claim is that this quantity is less than λ = L1+L2
inequality

2 − ν. Solving for ν gives the equivalent

ν <

L1 + L2
6

.

Recall that γuv ⊂ A, the latter of which is a path of length α < (cid:96)
3, and that (cid:96) is the length
of the smallest cycle contained in either G1 or G2 that intersects A. Since Ci ⊂ Gi, we have

ν ≤ α <

(cid:96)
3

≤

L1 + L2
6

,

as desired. This forces dG(x1, x3) ≤ |γ1| < λ, violating the assumption that td(X) = λ. This
concludes the proof of Case 3.2, and gives the Theorem.

To close up this section, we explore a consequence of Theorem 8.10. Once more, this
application is inspired by [AAG+20], speciﬁcally Proposition 4.1. We will assume that all
edges have length 1 for the sake of simplicity.

Theorem 8.11. Let T1, . . . , Tm be a set of trees, and for each k = 1, . . . , n, let Ck be a cycle
of length Lk = 2λk. Suppose that all λk are distinct. Let G be a graph formed by iteratively
attaching either a tree Ti or a cycle Ck along an edge or a vertex. Then, the number of points
(λ/2, λ) ∈ DVR
4,1 (G) is equal to the number of cycles Ck that were attached. Furthermore, if
X ⊂ G is a set of 4 points such that tb(X) = λ/2 and td(X) = λ, then X is contained in a
cycle Ck and Lk = 2λ.

67

Proof. First, label the trees and the cycles as G1, G2, . . . , GN depending on the order that
they were attached. Consider a cycle Ck and denote it as Gm. Suppose that there is a path γ
between x, x(cid:48) ∈ Ck that intersects Ck only at x and x(cid:48). We claim that the edge [x, x(cid:48)] is in Ck.
Otherwise, since we are only attaching graphs at an edge or a vertex, there are two diﬀerent
graphs attached to Ck, one at x and one at x(cid:48). However, if we follow γ, we will ﬁnd a graph
that was attached to the previous graphs at two disconnected segments. This contradicts
the construction of G, so [x, x(cid:48)] is an edge of Ck. Thus, dG(x, x(cid:48)) < |γ|. Moreover, the only
paths between non-adjacent points x, x(cid:48) ∈ Ck lie in Ck. Thus, Ck is isometric to a circle
which, as a metric space, has diamG(Ck) = λk. Then (λk/2, λk) ∈ DVR

4,1 (Ck) ⊂ DVR

4,1 (G).

Now, suppose that there is a point (λ/2, λ) ∈ DVR

4,1 (G) generated by a set X ⊂ G
with four points. Find the largest m such that X ∩ Gm (cid:54)= ∅. By Theorem 8.10, either
X ⊂ G1 ∪ · · · ∪ Gm−1, or X ⊂ Gm. If X is not contained in Gm, we can keep using Theorem
8.10 to remove graphs until we ﬁnd one that contains X. Notice that X cannot be contained
in a tree Ti because of Lemma 8.1, so X ⊂ Ck for some k. Let γi be the shortest path
between xi and xi+1. Then the sum dG(x1, x2) + dG(x2, x3) + dG(x3, x4) + dG(x4, x1) equals
4(λ/2) = 2λ because tb(X) = λ/2, but also Lk because the path γ1 ∪ γ2 ∪ γ3 ∪ γ4 is a cycle
contained in Ck. Since Lk = 2λk, λ = λk.

Since the graphs described in Theorem 8.11 are pasted along a contractible space, we can

detect the homotopy type of the graph.

Corollary 8.12. Let G be a graph constructed as in Theorem 8.11. Then the ﬁrst Betti
number of G equals the number of points (λ/2, λ) ∈ DVR

4,1 (G).

Proof. Attaching a tree to a graph doesn’t change its homotopy type, while attaching a cycle
Ck to G1∪. . . Gm at a contractible subspace induces (G1∪· · ·∪Gm)∪Ck (cid:39) (G1∪· · ·∪Gm)∨Ck.
Thus, by induction, G = C1 ∨ · · · ∨ Cn. Then β1(G) = n, and by Theorem 8.11, the values
of λ for which (λ/2, λ) ∈ DVR

4,1 (G) are λ1, . . . , λn.

9 Discussion and Questions

Here we outline the open questions and conjectures collected so far.

• Are there rich classes of compact metric spaces that can be distinguished

with persistence sets?
This question is a generalization of Theorem 8.11 and Corollary 8.12. The persistence
set DVR
4,1 can capture the number and length of cycles in a metric graph G that was
constructed according to the instructions in Theorem 8.11. Are there other families of
compact metric spaces where higher order diagrams DVR
n,k can detect relevant features?
In other words, are there families C of compact metric spaces such that

sup
n,k

is a metric when X, Y ∈ C?

H(DVR
dD

n,k(X), DVR

n,k(Y ))

68

4,1 (G). The red triangles are the boundaries of the sets DVR

Figure 26: Two examples of admissible graphs G as in Corollary 8.12 and their persistence
set DVR
4,1 (C) for every cycle C ⊂
DVR
4,1 (G). Left: Two cycles of lengths (cid:96)1 = 3.5 and (cid:96)2 = 4.5 pasted over an edge of length
α = 0.5 < 1
3 min((cid:96)1, (cid:96)2). Right: A tree of cycles. Each persistence set was found by sampling
100,000 uniform conﬁgurations from G.

69

123456700.511.522.500.511.522.5123456789101112130123400.511.522.533.52k+2,k(Sm

• Describe DVR

• Stabilization of DVR

2k+2,k(Sm

E ) for all k and m: Propositions 5.13 and 5.17 are a step in
E ) to

that direction. In fact, the latter implies that we only need to ﬁnd DVR
determine DVR
E ) for all spheres with m ≥ 2k + 1.
2k+2,k(Sn

4,1 (Sm)
stabilizes at m = 2 instead of m = 3, as given by Proposition 5.17. The key to the
reduction was the use of Ptolemy’s inequality as in Theorem 5.16. A natural follow up
question, even if it is subsumed by the previous one, is when does DVR
E ) really
stabilize for general k.

E) : When k = 1, Corollary 5.18 shows that DVR

2k+2,k(S2k

2k+2,k(Sm

References

[AA17]

Michal Adamaszek and Henry Adams. The Vietoris-Rips complexes of a circle.
Paciﬁc Journal of Mathematics, 290(1):1–40, 2017.

[AAG+20] Micha(cid:32)l Adamaszek, Henry Adams, Ellen Gasparovic, Maria Gommel, Emilie
Purvine, Radmila Sazdanovic, Bei Wang, Yusu Wang, and Lori Ziegelmeier. On
homotopy types of Vietoris-Rips complexes of metric gluings. Journal of Applied
and Computational Topology, 4(3):425–454, Sep 2020.

[ACC16]

Aaron Adcock, Erik Carlsson, and Gunnar Carlsson. The ring of algebraic
functions on persistence bar codes. Homology, Homotopy and Applications,
18(1):381–402, 2016.

[Ada14]

Micha(cid:32)l Adamaszek. Extremal problems related to Betti numbers of ﬂag com-
plexes. Discrete Applied Mathematics, 173:8–15, 2014.

[AFN+18] Pankaj K Agarwal, Kyle Fox, Abhinandan Nath, Anastasios Sidiropoulos, and
Yusu Wang. Computing the Gromov-Hausdorﬀ distance for metric trees. ACM
Transactions on Algorithms (TALG), 14(2):1–20, 2018.

[AMJ18]

David Alvarez-Melis and Tommi S Jaakkola. Gromov-Wasserstein alignment of
word embedding spaces. arXiv preprint arXiv:1809.00013, 2018.

[AW20]

[Bau19]

Josh Alman and Virginia Vassilevska Williams. A reﬁned laser method and
faster matrix multiplication. arXiv preprint arXiv:2010.05846, 2020.

Ulrich Bauer. Ripser: eﬃcient computation of Vietoris-Rips persistence bar-
codes, 2019. Software available at http://ripser.org/.

[BBBK08] Alexander M Bronstein, Michael Bronstein, Michael M Bronstein, and Ron
Kimmel. Numerical geometry of non-rigid shapes. Springer, 2008.

[BBI01]

Dmitri Burago, Yuri Burago, and Sergei Ivanov. A Course in Metric Geometry,
volume 33 of Graduate Studies in Mathematics. American Mathematical Socitey,
2001.

70

[BCM+20] Andrew J Blumberg, Mathieu Carriere, Michael A Mandell, Raul Rabadan,
and Soledad Villar. MREC: a fast and versatile framework for aligning and
matching point clouds with applications to single cell molecular data. arXiv
preprint arXiv:2001.01666, 2020.

[BD92]

Hans-J¨urgen Bandelt and Andreas W.M Dress. A canonical decomposition the-
ory for metrics on a ﬁnite set. Advances in Mathematics, 92(1):47–105, 1992.

[BFW09]

S. M. Buckley, K. Falk, and D. J. Wraith. Ptolemaic spaces and CAT(0).
Glasgow Mathematical Journal, 51(2):301–314, 2009.

[BGMP12] Andrew J Blumberg, Itamar Gal, Michael A Mandell, and Matthew Pancia.
Robust statistics, hypothesis testing, and conﬁdence intervals for persistent ho-
mology on metric measure spaces. arXiv preprint arXiv:1206.4581, 2012.

[BGMP14] Andrew J Blumberg, Itamar Gal, Michael A Mandell, and Matthew Pancia.
Robust statistics, hypothesis testing, and conﬁdence intervals for persistent ho-
mology on metric measure spaces. Foundations of Computational Mathematics,
14(4):745–789, 2014.

[BHPW20] Peter Bubenik, Michael Hull, Dhruv Patel, and Benjamin Whittle. Persistent

homology detects curvature. Inverse Problems, 36(2):025008, jan 2020.

[BK04a]

[BK04b]

Mireille Boutin and Gregor Kemper. On reconstructing n-point conﬁgurations
from the distribution of distances or areas. Adv. in Appl. Math., 32(4):709–735,
2004.

Mireille Boutin and Gregor Kemper. On reconstructing n-point conﬁgurations
from the distribution of distances or areas. Advances in Applied Mathematics,
32(4):709 – 735, 2004.

[Car14]

Gunnar Carlsson. Topological pattern recognition for point cloud data. Acta
Numerica, 23:289–368, 2014.

[CCM+20] Samir Chowdhury, Nathaniel Clause, Facundo M´emoli, Jose ´Angel S´anchez, and
Zoe Wellner. New families of stable simplicial ﬁltration functors. Topology and
its Applications, 279:107254, 2020.

[CCR13]

Joseph Minhow Chan, Gunnar Carlsson, and Raul Rabadan. Topology of viral
evolution. Proceedings of the National Academy of Sciences, 110(46):18566–
18571, 2013.

[CCSG+09] F. Chazal, D. Cohen-Steiner, L. Guibas, F. M´emoli, and S. Oudot. Gromov-
Hausdorﬀ stable signatures for shapes using persistence. In Proc. of SGP, 2009.

[CdS10]

Gunnar Carlsson and Vin de Silva. Zigzag persistence. Foundations of Compu-
tational Mathematics, 10(4):367–405, August 2010.

71

[CFL+14] Fr´ed´eric Chazal, Brittany Fasy, Fabrizio Lecci, Bertrand Michel, Alessandro
Rinaldo, and Larry Wasserman. Subsampling methods for persistent homology,
2014.

[CFL+15] Fr´ed´eric Chazal, Brittany Fasy, Fabrizio Lecci, Bertrand Michel, Alessandro
Rinaldo, and Larry Wasserman. Subsampling methods for persistent homology.
In International Conference on Machine Learning, pages 2143–2151. PMLR,
2015.

[CM08]

[CM10a]

[CM10b]

Gunnar Carlsson and Facundo M´emoli. Persistent clustering and a theorem of
J. Kleinberg. arXiv preprint arXiv:0808.2241, 2008.

Gunnar Carlsson and Facundo M´emoli. Characterization, stability and conver-
gence of hierarchical clustering methods. Journal of Machine Learning Research,
11:1425–1470, 2010.

Gunnar Carlsson and Facundo M´emoli. Characterization, stability and conver-
gence of hierarchical clustering methods. J. Mach. Learn. Res., 11:1425–1470,
August 2010.

[COS+98] Eugenio Calabi, Peter J Olver, Chehrzad Shakiban, Allen Tannenbaum, and
Steven Haker. Diﬀerential and numerically invariant signature curves applied to
object recognition. International Journal of Computer Vision, 26(2):107–135,
1998.

[CSEH07] David Cohen-Steiner, Herbert Edelsbrunner, and John Harer. Stability of per-
sistence diagrams. Discrete & Computational Geometry, 37(1):103–120, January
2007.

[DSS+20]

Pinar Demetci, Rebecca Santorella, Bjorn Sandstede, William Staﬀord Noble,
and Ritambhara Singh. Gromov-Wasserstein optimal transport to align single-
cell multi-omics data. BioRxiv, 2020.

[EH10]

[ELZ00]

[Fro90a]

[Fro90b]

Herbert Edelsbrunner and John Harer. Computational Topology: An Introduc-
tion. January 2010.

H. Edelsbrunner, D. Letscher, and A. Zomorodian. Topological persistence and
simpliﬁcation. In Proc. 41st Ann. IEEE Sympos. Found Comput. Sci., pages
454–463, 2000.

P. Frosini. A distance for similarity classes of submanifolds of Euclidean space.
Bull. Austral. Math. Soc., 42:3:407–416, 1990.

P. Frosini. Omotopie e invarianti metrici per sottovarieta di spazi euclidei (teoria
della taglia). PhD thesis, University of Florence, Italy., 1990.

72

[Fro99]

[Ghr08]

[GM21]

[Gro87]

[Gro07]

[Kah09]

[Kal19]

[Kat91]

[KM21]

[LMO20]

[LMS21]

[M´em05]

[M´em07]

[M´em11]

Patrizio Frosini. Metric homotopies. Atti Sem. Mat. Fis. Univ. Modena,
47(2):271–292, 1999.

R. Ghrist. Barcodes: The persistent topology of data. Bulletin-American Math-
ematical Society, 45(1):61, 2008.

Mario G´omez and Facundo M´emoli. Github repo for: Curvature sets over persis-
tence diagrams, 2021. https://github.com/ndag/persistence-curv-sets.

M. Gromov. Hyperbolic groups. In Essays in group theory, volume 8 of Math.
Sci. Res. Inst. Publ., pages 75–263. Springer, New York, 1987.

Misha Gromov. Metric Structures for Riemannian and non-Riemannian Spaces.
Modern Birkh¨auser Classics. Birkh¨auser Boston Inc, Boston, MA, 2007.

Matthew Kahle. Topology of random clique complexes. Discrete Mathematics,
309(6):1658–1671, 2009.

Sara Kaliˇsnik. Tropical coordinates on the space of persistence barcodes. Foun-
dations of Computational Mathematics, 19(1):101–129, Feb 2019.

Mikhail Katz. On neighborhoods of the Kuratowski imbedding beyond the ﬁrst
extremum of the diameter functional. Fundamenta Mathematicae, 137(3):161–
175, 1991.

Sakura Kawano and Jeremy K Mason. Classiﬁcation of atomic environments via
the Gromov-Hausdorﬀ-Wasserstein distance. Computational Materials Science,
188:110144, 2021.

Sunhyuk Lim, Facundo Memoli, and Osman Berat Okutan. Vietoris-Rips per-
sistent homology, injective metric spaces, and the ﬁlling radius. arXiv preprint
arXiv:2001.07588, 2020.

Sunhyuk Lim, Facundo M´emoli, and Zane Smith. The Gromov-Hausdorﬀ dis-
tance between spheres, 2021.

Facundo M´emoli. Estimation Of Distance Functions And Geodesics And Its Use
For Shape Comparison And Alignment: Theoretical And Computational Results.
PhD thesis, Electrical and Computer Engineering Department, University of
Minnesota, May 2005.

Facundo M´emoli. On the use of Gromov-Hausdorﬀ distances for shape compar-
ison. In Proceedings of Point Based Graphics 2007, Prague, Czech Republic,
2007.

Facundo M´emoli. Gromov-Wasserstein distances and the metric approach to
object matching. Foundations of Computational Mathematics, 11(4):417–487,
August 2011.

73

[M´em12a] Facundo M´emoli. Curvature sets over persistence diagrams, 2012. Banﬀ 2012:
http://webfiles.birs.ca/events/2012/5-day-workshops/12w5081/video
s/watch/201210161051-Memoli.html.

[M´em12b] Facundo M´emoli. Some properties of Gromov-Hausdorﬀ distances. Discrete &

Computational Geometry, 48(2):416–440, September 2012.

[M´em13a] Facundo M´emoli. Curvature sets over persistence diagrams, 2013. ACAT 2013.
Bremen: https://www.alta.uni-bremen.de/ACAT13/ACAT13 abstracts.p
df.

[M´em13b] Facundo M´emoli. Curvature sets over persistence diagrams, 2013. Bedlewo 2013:

http://bcc.impan.pl/13AppTop/.

[M´em14a] Facundo M´emoli. Curvature sets over persistence diagrams, 2014. IMA 2014:

https://www.ima.umn.edu/2013-2014/W10.7-11.13/14513.

[M´em14b] Facundo M´emoli. Curvature sets over persistence diagrams, 2014. SAMSI 2014:
https://www.samsi.info/programs-and-activities/research-workshop
s/2013-14-ldhd-topological-data-analysis-february-3-7-2014/.

[M´em14c] Facundo M´emoli. Curvature sets over persistence diagrams, 2014. SAMSI 2014:
https://people.math.osu.edu/memolitechera.1/talks/talk-dgh-rips.
pdf.

[M´em17]

Facundo M´emoli. A distance between ﬁltered spaces via tripods. arXiv preprint
arXiv:1704.03965, 2017.

[MMS11]

Nikola Milosavljevi´c, Dmitriy Morozov, and Primoz Skraba. Zigzag persistent
homology in matrix multiplication time. In Proceedings of the Twenty-Seventh
Annual Symposium on Computational Geometry, SoCG ’11, page 216–225, New
York, NY, USA, 2011. Association for Computing Machinery.

[MN18]

Facundo M´emoli and Tom Needham. Distance distributions and inverse prob-
lems for metric measure spaces. arXiv preprint arXiv:1810.09646, 2018.

[MNO21]

F. M´emoli, T. Needham, and P. J. Olver. Generalized shape distributions and
the Gromov-Wasserstein distance (in preparation). 2021.

[MO18]

[MP20]

[MS04]

Facundo Memoli and Osman Berat Okutan. Metric graph approximations of
geodesic spaces, 2018.

Facundo M´emoli and Guilherme Vituri F. Pinto. Motivic clustering schemes for
directed graphs. arXiv preprint arXiv:2001.00278, 2020.

Facundo M´emoli and Guillermo Sapiro. Comparing point clouds. In SGP ’04:
Proceedings of the 2004 Eurographics/ACM SIGGRAPH symposium on Geom-
etry processing, pages 32–40, New York, NY, USA, 2004. ACM.

74

[MS05]

Facundo M´emoli and Guillermo Sapiro. A theoretical and computational frame-
work for isometry invariant recognition of point cloud data. Found. Comput.
Math., 5(3):313–347, 2005.

[MSW19]

Facundo M´emoli, Zane Smith, and Zhengchao Wan. Gromov-Hausdorﬀ
distances on p-metric spaces and ultrametric spaces.
arXiv preprint
arXiv:1912.00564, 2019.

[Mug19]

Delio Mugnolo. What is actually a metric graph?, 2019.

[MZ19]

[Olv01]

[PC+19]

[PCS16]

[Rob99]

[Sch17]

Facundo M´emoli and Ling Zhou. Persistent homotopy groups of metric spaces.
arXiv preprint arXiv:1912.12399, 2019.

P.J. Olver. Joint invariant signatures. Foundations of computational mathemat-
ics, 1(1):3–68, 2001.

Gabriel Peyr´e, Marco Cuturi, et al. Computational optimal transport: With
applications to data science. Foundations and Trends® in Machine Learning,
11(5-6):355–607, 2019.

Gabriel Peyr´e, Marco Cuturi, and Justin Solomon. Gromov-Wasserstein aver-
aging of kernel and distance matrices. In International Conference on Machine
Learning, pages 2664–2672. PMLR, 2016.

Vanessa Robins. Towards computing homology from ﬁnite approximations. In
Topology Proceedings 1999, 1999.

Felix Schmiedl. Computational aspects of the Gromov-Hausdorﬀ distance and its
application in non-rigid shape matching. Discrete & Computational Geometry,
57(4):854–880, Jun 2017.

[SMI+08] Gurjeet Singh, Facundo Memoli, Tigran Ishkhanov, Guillermo Sapiro, Gunnar
Carlsson, and Dario L Ringach. Topological analysis of population activity in
visual cortex. Journal of vision, 8(8):11–11, 2008.

[SWB21]

Elchanan Solomon, Alexander Wagner, and Paul Bendich. From geometry to
topology: Inverse theorems for distributed persistence, 2021.

[Val70a]

[Val70b]

J. E. Valentine. An analogue of Ptolemy’s theorem in spherical geometry. The
American Mathematical Monthly, 77(1):47–51, 1970.

Joseph E. Valentine. An analogue of Ptolemy’s theorem and its converse in
hyperbolic geometry. 1970.

[VCF+20] Titouan Vayer, Laetitia Chapel, R´emi Flamary, Romain Tavenard, and Nicolas
Courty. Fused Gromov-Wasserstein distance for structured objects. Algorithms,
13(9):212, 2020.

75

[Vil03]

[Wei11]

[ZC04]

C´edric Villani. Topics in optimal transportation, volume 58 of Graduate Studies
in Mathematics. American Mathematical Society, Providence, RI, 2003.

Shmuel Weinberger. What is... persistent homology? Notices of the AMS,
58(1):36–39, 2011.

Afra Zomorodian and Gunnar Carlsson. Computing persistent homology. In
SCG ’04: Proceedings of the twentieth annual symposium on Computational
geometry, pages 347–356, New York, NY, USA, 2004. ACM.

76

