2
1
0
2

n
a
J

2

]
T
S
.
n
i
f
-
q
[

1
v
3
3
4
0
.
1
0
2
1
:
v
i
X
r
a

Random matrix approach to the dynamics of stock inventory variations

Wei-Xing Zhou,1, 2, 3, ∗ Guo-Hua Mu,1, 2, 3 and J´anos Kert´esz4, 5, †
1School of Business, East China University of Science and Technology, Shanghai 200237, China
2School of Science, East China University of Science and Technology, Shanghai 200237, China
3Research Center for Econophysics, East China University of Science and Technology, Shanghai 200237, China
4Department of Theoretical Physics, Budapest University of Technology and Economics, Budapest, Hungary
5Laboratory of Computational Engineering, Helsinki University of Technology, Espoo, Finland
(Dated: November 13, 2018)

Investors trade stocks based on diverse strategies trying to beat the market and gain access
returns, whose stock inventories change accordingly. The dynamics of inventory variations thus
contain rich information about the trading behaviors of investors and have crucial inﬂuence on price
ﬂuctuations. We study the cross-correlation matrix Cij of inventory variations of the most active
individual and institutional investors in an emerging market to understand the dynamics of inventory
variations. We ﬁnd that the distribution of cross-correlation coeﬃcient Cij has a power-law form in
the bulk followed by exponential tails and there are more positive coeﬃcients than negative ones. In
addition, it is more possible that two individuals or two institutions have stronger inventory variation
correlation than one individual and one institution. We ﬁnd that the largest and the second largest
eigenvalues (λ1 and λ2) of the correlation matrix cannot be explained by the random matrix theory
and the projection of inventory variations on the ﬁrst eigenvector u(λ1) are linearly correlated with
stock returns, where individual investors play a dominating role. The investors are classiﬁed into
three categories based on the cross-correlation coeﬃcients CV R between inventory variations and
stock returns. Half individuals are reversing investors who exhibit evident buy and sell herding
behaviors, while 6% individuals are trending investors. For institutions, only 10% and 8% investors
are trending and reversing investors. A strong Granger causality is unveiled from stock returns to
inventory variations, which means that a large proportion of individuals hold the reversing trading
strategy and a small part of individuals hold the trending strategy. Comparing with the case of
Spanish market, Chinese investors exhibit common and market-speciﬁc behaviors. Our empirical
ﬁndings have scientiﬁc signiﬁcance in the understanding of investors’ trading behaviors and in the
construction of agent-based models for stock markets.

PACS numbers: 89.65.Gh, 89.75.Da, 02.10.Yn, 05.45.Tp

I.

INTRODUCTION

Stock markets are complex systems, whose elements
are heterogenous individual and institutional investors
interacting with each other by stock exchanges [1–4].
Stock price ﬂuctuates due to investors’ trading activi-
ties and the cross-sectional relation between investors’
stock inventory variations and stock returns have at-
tracted much attention [5]. The huge literature falls into
three groups to study the relation between past returns
and inventory variations, to investigate the contempo-
raneous relation between inventory variations and stock
returns, and to analysis return predictability of inventory
variations [6]. The main ﬁndings are that institutions are
trending investors adopting the momentum trading strat-
egy [6–8], while individuals are reversing investors who
buy previous losers and sell previous winners [6, 8–11],
and stock returns lead inventory variations but not vice
versa [5–8].

However, there is evidence showing diﬀerent trading
patterns. Lillo et al investigated the trading behaviors of
about 80 ﬁrms that were members of the Spanish Stock

∗ wxzhou@ecust.edu.cn
† kertesz@phy.bme.hu

Exchange and found that there were more reversing ﬁrms
than trending ﬁrms [5]. They also found that the largest
eigenvalue of the correlation matrix of inventory varia-
tions cannot be explained by the random matrix theory
and its eigenvector contains information of stock price
ﬂuctuations. Both buying and selling herding behaviors
have been observed for trending and reversing ﬁrms.

In this work, we perform a similar analysis as in Ref. [5]
based on the trading records of Chinese investors in the
Shenzhen Stock Exchange. Diﬀerent from the Spanish
case, our data set contains both individual and institu-
tional investors, which allows us to observe interesting
investor behaviors. Our analysis starts from the perspec-
tive of random matrix theory, which has been extensively
used to investigate the cross-correlations of ﬁnancial re-
turns in diﬀerent stock markets [12–14]. However, very
few studies have been conducted on the Chinese stocks
[15] and, to our knowledge, there is no research reported
on the dynamics of inventory variations of Chinese in-
vestors. Alternatively, there are studies on Chinese equi-
ties at the transaction and trader level from the complex
network perspective [16–19].

This paper is organized as follows. Section II de-
scribes the data and the method to construct the time
series of investors’ inventory variations. Section III stud-
ies the statistical properties of the elements, eigenvalues

 
 
 
 
 
 
and eigenvectors of the correlation matrix of inventory
variations. Section IV investigates the contemporaneous
and lagged cross-correlation between inventors’ inventory
variations and stock returns to divide investors into three
categories and their herding behaviors. Section V sum-
marizes our ﬁndings.

II. DATA

We analyze 39 stocks actively traded on the Shenzhen
Stock Exchange in 2003. The data base contains all the
information needed for the analysis in this work. For
each transaction i of a given stock, the data record the
identities of the buyer and seller, the types (individual
or institution) of the two traders, the price pi and the
size qi of the trade, and the time stamp. Therefore, the
trading history of each investor is known. For each stock,
we identify active traders who had more than 150 trans-
actions, amount to about three transactions per week.
If the number of active traders of a stock is less than
120, we exclude it from analysis. In this way, we have 15
stocks for analysis.

Following Ref. [5], we investigate the dynamics of the
inventory variation of the most active investors who ex-
ecuted more than 120 transactions for each stock. Al-
though the trading period of each day consists of call
auction and continuous auction, their behaviors are dif-
ferent in many aspects and are usually studied separately
[20, 21]. We stress that all the transactions in both call
auction and continuous auction are included in our in-
vestigation. The daily inventory variation of an investor
i trading a given stock on day t is deﬁned as follows

+

−

vi(t) =

pi(t)qi(t)

pi(t)qi(t),

X

X

−
+ pi(t)qi(t) is the total buy quantity on trad-
where
− pi(t)qi(t) is the total sell quantity in
ing day t and
the same day. The basic statistics of the 80 most active
traders and the resultant inventory variations are given
in Table I.

P

P

(1)

III. STATISTICS OF CORRELATION MATRIX
BETWEEN TWO TIME SERIES OF INVENTORY
VARIATIONS

A. Distributions of cross-correlation coeﬃcients

The empirical correlation matrix C is constructed from
the time series of inventory variation vi(t) of the investi-
gated stock, deﬁned as

(vi

Cij = h

− h

vi

)(vj
i
σiσj

vj

− h

)
i
i

.

(2)

Since the results for individual stocks are quantitatively
similar, we put the cross-correlation coeﬃcients of the 15

2

Cij
h

i

−

i

Cij
h

stocks into one sample. We ﬁnd that the mean value
is
= 0.02 for the real data and 0 for the shuf-
ﬂed data. When the types of investors are taken into
account, the mean value of the cross-correlation coeﬃ-
cients is
0.001) for both i and
Cij
h
= 0.014 (shuﬄed: 0) for both
j being individuals,
0.008 (shuﬄed:
i and j being institutions, and

= 0.048 (shuﬄed:
Cij
h

=

−

i

i

i

−

0.001) for i being individual and j being institution.
Figure 1 plots the daily returns of stock 000001 and
the sliding average values of the correlation coeﬃcients
Cij
for comparison. We observe that large values
Cij
h
i
h
appear during periods of large price ﬂuctuations by and
large, which is reminiscent of the similar result for cross-
correlations of ﬁnancial returns [14]. However, the short
time period of our data sample does not allow us to reach
a decisive conclusion. There are also less volatile time
periods with large
. The situation is quite similar
i
for other stocks.

Cij
h

i
j
i

C
h
,

R

0.3

0.2

0.1

0

−0.1
0

>
<C
ij

R

50

100

t

150

200

250

FIG. 1. (Color online) Evolution of the 5-day average cross-
correlation coeﬃcient hCiji and the daily return R.

Figure 2(a) shows the empirical probability distribu-
tions of Cij which is calculated using daily inventory vari-
ation. The four curves with diﬀerent markers correspond
to Cij , Cind,ind, Cind,ins, and Cins,ins, respectively. It is
found that most coeﬃcients are small and the tails are
exponentials:

0.1

e−λ−C ,
e−λ+C ,

0.6 < C
0.1 < C

(3)

P (C)

±

±

±

−

±

±

0.6

∝ (cid:26)

0.2 and λ− = 12.5

0.2 and λ− = 11.1

0.4 for Cind,ins, and λ+ = 6.6

±
0.4 for Cind,ind, λ+ = 10.8

≤ −
≤
0.3 for Cij , λ+ =
where λ+ = 8.8
0.4
8.9
±
0.5 and
and λ− = 10.5
0.5 for Cins,ins, respectively. We ﬁnd that there
λ− = 8.7
are more positive cross-correlation coeﬃcients (λ+ < λ−)
when both investors are individuals or institutions.
In
λ−) when
contrast, the distribution is symmetric (λ+ ≈
one investor is an individual while the other is an insti-
tution. This ﬁnding implies that herding behaviors are
more like to occur among the same type of investors and
individuals have larger probability to herd than institu-
tions. We shuﬄe the original time series and perform the

±

 
 
TABLE I. Basic statistics of the investigated stocks. The ﬁrst column is the stock code, which is the unique identity of each
stock. The second and third columns presents investor-averaged total inventory variation hPt vii and average absolute variation
hh|v|itii. The fourth to eighth columns gives the number of investors N , the number of trending investors N tr, the number
of reversing investors N re, the number of uncategorized investors N un, and the slope of the factor versus stock return k. The
variables in the ninth to thirteenth columns are the same as in the ﬁve “all investors” columns but for individual investors
and the last ﬁve columns are for institutional investors. Each value in the last row gives the sum of the numbers in the same
column.

3

hPt vii

Code
hh|v|itii
000001 −2.99 × 106 1.12 × 105
000002 1.01 × 106 1.46 × 105
000012 −1.64 × 106 7.88 × 104
000021 5.09 × 105 4.35 × 104
000063 1.46 × 107 2.46 × 105
000488 1.35 × 106 8.92 × 104
000550 4.20 × 106 7.53 × 104
000625 1.87 × 106 1.22 × 105
000800 2.53 × 106 2.56 × 105
000825 6.33 × 106 9.38 × 104
000839 8.13 × 105 6.67 × 104
000858 1.75 × 106 1.66 × 105
000898 6.26 × 106 1.20 × 105
200488 3.59 × 106 5.05 × 104
200625 6.27 × 106 1.26 × 105

k

All investors
N Ntr Nre Nun
80
80
81
81
80
80
81
80
80
80
80
82
83
80
83

7
41
6
29
5
20
2
43
9
20
5
5
37
2
10 26
19
6
38
5
40
2
21
4
32
6
30
9
14
9

32 0.83
45 0.49
56 0.19
36 0.78
51 0.13
70 0.08
42 0.18
44 0.71
55 0.30
37 0.69
38 0.84
57 0.33
45 0.79
41 0.65
60 0.50

P

-

-

1211 87 415 709

-

same analysis. The resulting distributions collapse onto
a single curve, which has an exponential form

P (C) = λshuf e−λshuf C

(4)

where the parameter λshuf = 23.3 is determined us-
ing robust regression [22, 23]. It is not surprising that
real data have higher cross-correlations than the shuﬄed
data, which is conﬁrmed by λ± < λshuf . This exponential
distribution is diﬀerent from the Gaussian distribution
for the shuﬄed data of ﬁnancial returns [14].

Figure 2(b) plots the distributions in double logarith-
mic coordinates where the negative parts are reﬂected to
the right with respect to Cij = 0. Nice power laws are
observed spanning over three orders of magnitude:

P (C)

∝ (cid:26)

C)−γ−,
(
−
C−γ+ ,

−

0.01 < C
10−5 < C

10−5
0.01

≤ −
≤

(5)

±

±

±
±

0.01 and γ− = 0.69

0.02 and γ− = 0.62

±
0.02 and γ− = 0.70
0.02 and γ− = 0.73

0.01 for Cij ,
where γ+ = 0.69
0.02 for Cind,ind,
γ+ = 0.67
±
0.02 for Cind,ins, and
γ+ = 0.67
±
0.02 for Cins,ins, respec-
γ+ = 0.72
±
γ+ and all the power-law
tively. It is found that γ−
≈
exponents are close to each other. An intriguing feature
is that the distributions of Cij , Cind,ind and Cind,ins ex-
hibit an evident bimodal behavior, which is reminiscent
of the distributions of waiting times and interevent times
of human short message communication [24]. Certainly,
the underlying mechanisms are diﬀerent and the factors
causing the bimodal distribution of the cross-correlations
are unclear.

Individuals
ind N re
Nind N tr
ind N un
39
4
61
26
2
42
20
5
78
43
2
64
13
2
20
5
2
69
35
0
45
24
8
62
17
2
31
37
3
50
38
2
60
19
0
31
31
0
46
25
7
53
46
9
5
44
758

Institutions
ins N re
ind kind Nins N tr
ins N un
2
3
18 0.83
3
4
14 0.52
0
0
53 0.18
0
2
20 0.78
7
7
5
0.71
0
4
63 0.06
2
2
10 0.18
2
2
30 0.69
2
5
13 0.31
2
2
10 0.70
2
0
20 0.84
2
4
12 0.67
2
6
15 0.80
5
2
21 0.66
5
4
32 0.58
36
47

ins kins
14 0.04
31 0.06
3
0.06
16 0.04
46 0.05
7
0.06
32 0.06
14 0.05
42 0.06
27 0.05
18 0.04
45 0.05
30 0.04
20 0.05
28 0.05
373

19
38
3
17
60
11
36
18
49
30
20
51
37
27
37
453

381 336

-

-

It is natural that we are more interested in large
cross-correlations. The preceding discussions focus on
the cross-correlations not larger than 0.6. As shown in
Fig. 2(a), there are pairs of inventory variation time series
that have very large cross-correlations that look like out-
liers. To have a better visibility, we plot in Fig. 2(c) the
numbers of occurrences of positive and negative cross-
correlations in 10 nonoverlapping intervals for the four
types of pairs. It is shown that N (C > 0) > N (C < 0)
in all intervals for C = Cij , Cind,ind and Cind,ins.
In
contrast, N (Cind, ins > 0) < N (Cind, ins < 0) when
Cind, ins < 0.6 and N (Cind, ins > 0) > N (Cind, ins < 0)
when Cind, ins > 0.6. Hence, for larger cross-correlations
(C > 0.6), there are much more occurrences of positive
cross-correlations than negative ones for all the four types
of pairs. This striking feature can be attributed to two
reasons. The ﬁrst is that a large proportion of investors
react to the same external news in the same direction
[5]: they buy following good news and sell following bad
news. The second is that investors imitate the trading
behaviors of others of the same type and rarely imitate
other investors of diﬀerent type. The second reason is ra-
tional because the friends of individual (or institutional)
investors are more likely individual (or institutional) in-
vestors.

B. Eigenvalue spectrum

For the correlation matrix C of each stock, we can
calculate its eigenvalues, whose density fc(λ) is deﬁned

(a)

all
ind−ind
ind−ins
ins−ins

[12, 14, 25],

fc(λ) =

Q

2πσ2 p

(λmax −

4

(7)

λ)(λ
λ

−

λmin)

,

with λ

∈

[λmin, λmax], where λmax

min is given by

2

10

1

10

0

10

−1

10

−2

10

10

−3
−1

4
10

2
10

0
10

−2

10

−4

10

j
i

)

C
(
P

j
i

)

C
(
P

−6

10

10

−0.5

0
C
ij

0.5

1

(b)

all
ind−ind
ind−ins
ins−ins

−6

−5

10

−4

10

−3

10
C
ij

−2

10

−1

10

0
10

j
i

]
)

(

C
N
+
1
[

0
1

g
o
l

5

4

3

2

1

0
0

(c)

all: +
all: −
ind−ind: +
ind−ind: −
ind−ins: +
ind−ins: −
ins−ins: +
ins−ins: −

0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9
|
|C
ij

1

FIG. 2. (Color online) Empirical distributions of the cross-
correlation coeﬃcients for all the 15 stocks. (a) Log-linear plot
of P (Cij) for cross-correlations between any two investors,
any two individuals, any one individual and one institution,
and any two institutions, which shows exponential forms when
0.1 < |C| ≤ 0.6. The dashed line corresponds to the result of
shuﬄed data. (b) Log-log plot of P (Cij), which shows power-
law forms when 10−5 < |C| ≤ 0.01. (c) Comparison of oc-
currence numbers of positive and negative cross-correlations.
The ordinate gives log10[1+N (Cij )] rather than log10[N (Cij )]
for better presentation.

as follows [12],

fc(λ) =

1
N

dn(λ)
dλ

,

(6)

If M is a T

where n(λ) is the number of eigenvalues of C less than
λ.
N random matrix with zero mean
and unit variance, fc(λ) is self-averaging. Particularly,
in the limit N
1 ﬁxed,
→ ∞
the probability density function fc(λ) of eigenvalues λ of
the random correlation matrix M can be described as

and Q = T /N

→ ∞

, T

≥

×

min = σ2(1 + 1/Q
λmax

±

p

2

1/Q) ,

(8)

and σ2 is equal to the variance of the elements of M
[12, 25]. The variance σ2 is equal to 1 in our normalized
data.

)
λ
(
c

f

1.2

1

0.8

0.6

0.4

0.2

0
0

λ

16
14
12
10
8
6
4
2
0

5
10
Dataset

15

2

4

λ

6

8

10

FIG. 3. (Color online) Eigenvalue spectrum of the correlation
matrix of inventory variation of investors trading stock 000001
within 1 day time horizon in 2003. The solid line is the spec-
tral density obtained by shuﬄing independently the buyers
and the sellers in such a way to maintain the same number of
purchases and sales for each investor as in the real data. The
dashed blue line shows the spectral density predicted by the
random matrix theory using Eq. (7) with Q = 237/80 = 2.96.
The inset shows the largest eigenvalue λ1 ((cid:13)) and the sec-
ond largest eigenvalue λ2 ((cid:3)) of all 15 investigated data sets
from 15 stocks. The solid line indicates the upper thresholds
by shuﬄing experiments, and the dashed line presents the
threshold predicted by the random matrix theory.

Figure 3 illustrates the probability distribution fc(λ) of
the correlation matrix of inventory variation of investors
trading stock 000001. The solid line is the spectral den-
sity obtained by shuﬄing independently the buyers and
the sellers in such a way to maintain the same number of
purchases and sales for each investor as in the real data,
while the dashed blue line shows the spectral density pre-
dicted by the random matrix theory using Eq. (7) with
Q = 237/80 = 2.96. We ﬁnd the largest eigenvalue is well
outside of the bulk and the second largest eigenvalue also
escapes the bulk. The results for other 14 stocks are quite
similar. In the inset of Fig. 3, we plot the largest eigen-
values λ1 and the second largest eigenvalues λ2 for all the
15 stocks. We ﬁnd that all the largest eigenvalues are well
above the upper thresholds determined from shuﬄing ex-
periments and the thresholds λmax in Eq. (8) predicted
by the random matrix theory. Moreover, all the second

 
 
 
 
 
 
largest eigenvalues are above the two threshold lines and
some of them are well above the thresholds. These ﬁnd-
ings indicates that both the largest and the second largest
eigenvalues carry information about the investors, which
is diﬀerent from diﬀerent from the results of the Span-
ish stock market, where only the largest eigenvalue is
larger than the up thresholds while the second largest
eigenvalue is within the bulk [5]. This discrepancy can
be attributed to the diﬀerence of the two markets and
the fact that our analysis contains both individuals and
institutions while Lillo et al studies only ﬁrms.

C. Distribution of eigenvector components

If there is no information contained in an eigenvalue,
the normalized components of its associated eigenvector
should conform to a Gaussian distribution [12–14]:

f (u) =

1
√2π

exp

(cid:18)−

u2
2 (cid:19)

.

(9)

Since the empirical eigenvalue distribution fc(λ) deviates
from the theoretic expression (6) from the random ma-
trix theory with two large eigenvalues outside the bulk of
the distribution, it is expected that the associated eigen-
vectors also contain certain information.

(a)

(c)

0.8

0.6

0.4

0.2

0
1

0.8

0.6

0.4

0.2

)
u
(
f

,
y
t
i
s
n
e
d

y
t
i
l
i
b
a
b
o
r
P

0
−4

−2

(b)

(d)

0

−4
4
Eigenvector components, u

−2

2

0

2

4

FIG. 4. Distribution of eigenvector components u: (a) all
the eigenvectors associated with the eigenvalues in the bulk
λmin < λ < λmax after normalization for each eigenvector for
stock 000001, (b) same as (a) but for stock 200625, (c) all the
eigenvectors associated with the largest eigenvalues λ1 after
normalization for all the stocks, and (d) all the eigenvectors
associated with the second largest eigenvalues λ2 after nor-
malization for all the stocks. The solid lines show the Gaus-
sian distribution predicted by the random matrix theory.

5

in Fig. 4show the empirical distributions of the eigenvec-
tor components u with the eigenvalues in the bulk for
two typical stocks. Rather than analyzing the vector for
one eigenvector, we normalized the components of each
eigenvector and put all the eigenvectors together to gain
better statistics, since each eigenvector has only 80 com-
ponents. We ﬁnd that the distributions of 10 stocks are
well consistent with the Gaussian, while other 5 stocks
exhibit high peaks in the center.

For deviating eigenvalues λ1 and λ2, the distribution
for each stock is very noisy and deviates from Gaussian.
We treat the components of the 15 eigenvectors as a sam-
ple to have better statistics. The two distributions ob-
tained are illustrated in Fig. 4(c) and (d). It is evident
that both deviate from the Gaussian distribution and the
distribution for λ1 is more skewed.

D.

Information in eigenvectors for deviating

eigenvalues

h|

, the total variation

We have shown that the largest and the second largest
eigenvalues deviate from the RMT prediction and the dis-
tributions of their eigenvector components are not Gaus-
sian. It implies that these eigenvectors carry some infor-
mation. For u(λ2), it is not clear what kind of informa-
tion they carry. We ﬁnd no evident dependence of the
magnitude of ui(λ2) on the average absolution inventory
vi, or the maxi-
vi
variation
|i
mal absolute variation max
. Same conclusion is ob-
{|
tained for ui(λ1), which diﬀers from the conclusion that
the eigenvector components of the return correlation ma-
trix depend on the market capitalization in a logarithmic
form [14]. In addition, as we will show in the next section
that the investors can be categorized into three trading
types. We also ﬁnd no relation between the trading strat-
egy category and the magnitude of the vector component
u(λ2). We thus focus on extracting the information from
u(λ1).

P

vi

|}

For the correlation matrix whose elements are the cor-
relation coeﬃcients of price ﬂuctuations of two stocks,
the eigenvector of the largest eigenvalue contains mar-
ket information [12, 13]. The market information indi-
cates the collective behavior of stock price movements
[26], which can be unveiled by the projection of the
time series on the eigenvector [14]. We follow this ap-
proach and calculate the projection G(t) of the time se-
ries Vi(t) = [vi(t)
]/σi on the eigenvector u(λ1)
vi(t)
i
− h
corresponding to the ﬁrst eigenvalue [5]:

G(t) =

Vi(t)

Xi

ui(λ1)(t),

×

(10)

For correlation matrices of ﬁnancial returns, the com-
ponents of an eigenvector with the eigenvalue λ in the
bulk of its distribution (λmin < λ < λmax) are dis-
tributed according to Eq. (9) [12–14]. Panels (a) and (b)

The projection G can be called the factor associated
with the largest eigenvalue [5]. We plot the factor G(t)
against the normalized return R(t) for stock 000001 in
Fig. 5(a). There is a nice linear dependence between
the two variables and a linear regression gives the slope

  
 
 
 
 
 
  
 
 
k = 0.83
0.04. It indicates that these most active in-
vestors have dominating inﬂuence on the price ﬂuctua-
tions.

±

5
G (a)

(b)

(c)

−4 −2 0 2 4
Return, R

−4 −2 0 2 4

,
r
o
t
c
a
F

0

−5

−4 −2 0 2 4

1
s (d)
n
i
k
,
d
n
i
k

0.5

0
0

0.2

0.4

k

0.6

0.8

1

FIG. 5. (Color online) Inﬂuence of the most active investors
trading stock 000001 on the price ﬂuctuations for all the inves-
tigated investors (a), for individual investors (b), and for in-
stitutional investors (c), where the slopes are k = 0.83 ± 0.04,
kind = 0.83 ± 0.04, and kins = 0.41 ± 0.06, respectively. Panel
(d) plots kind and kins against k, where each symbol corre-
sponds to a stock.

±

±

Panels (b) and (c) of Fig. 5 illustrate the relation be-
tween the factor and the return for individuals and insti-
tutions. Linear regression gives kind = 0.83
0.04 and
kins = 0.41
0.06. Comparing (b) and (c) with (a), we
ﬁnd that the inﬂuence of individuals matches excellently
with the whole sample, which can be quantiﬁed by the
facts that kind = k and kind < k. The results are similar
for other stocks. The resulting kind and kins are plotted
in Fgi. 5 against k for all the 15 stocks. For individual
investors, we ﬁnd that kind = k for 13 stocks and kind > k
for 2 stocks. In contrast, we ﬁnd that kins < k except for
one stock.

IV.

INVENTORY VARIATION AND STOCK

RETURN

6

comparing the experimental results with the results of
a null hypothesis based on a block bootstrap of both R
and V . In this regard, 1000 block bootstrap replicas with
a block length of 20 are performed. For each investor,
we have checked whether the estimated correlation with
return exceeds the 0.97725 quantile or is smaller than
the 0.02275 quantile of the correlation distribution ob-
tained from bootstrap replicas. The results are shown in
Fig. 6(a-c). There are 1211 investors in the whole sam-
ple in Fig. 6(a), including 453 institutional investors in
Fig. 6(b) and 758 individual investors in Fig. 6(c).

As shown in the last row of Table I, the numbers of the
three kinds of investors (trending, reversing and uncate-
gorized) are 46, 34 and 373 for institutional investors and
41, 381 and 336 for individual investors, respectively. We
ﬁnd that most institutional investors are uncategorized
and there are more trending investors than reversing in-
vestors. These results are diﬀerent from the Spanish case,
where only one-third investors are uncategorized and the
number of reversing ﬁrm investors is about three times
the number of trending ﬁrm investors [5].
In contrast,
about half individuals are reversing investors and only
6% individuals are trending investors. The observation
that most investors are uncategorized is probably due to
the fact that the Chinese market was emerging and its in-
vestors are not experienced. Comparing individuals and
institutions, we ﬁnd a larger proportion of individuals
exhibiting a reversing behavior. It indicates that these
individuals buy when the price drops and sell when the
price rises in the same day. This ﬁnding is very inter-
esting since it explains the worse performance in stock
markets [10, 11].

The empirical evidence for the signiﬁcant cross-
correlation between inventory variation Vi(t) of trending
and reversing investors and stock return R(t) leads us
to adopt a linear model for the dynamics of inventory
variation as a ﬁrst approximation [5]:

Vi(t) = γiR(t) + ǫi,

(12)

is proportional to the cross-correlation coef-
where γi
It follows immediately that the cross-
ﬁcient CVi,R.
correlation coeﬃcient between the inventory variations
of two investors are

A. Categorization of investors

Cij = CVi,Vi = γiγj.

(13)

Following Ref. [5], we divide the investors into three
categories according to the cross-correlation coeﬃcient
CViR between the inventory variation Vi and the stock
return R. The investor i belongs to the trending or re-
versing category if its inventory variation is positively or
negatively correlated with the return. We use a wieldy
signiﬁcant threshold to categorize the investors:

2σ =

2/

NT ,

(11)

±
where NT is the number of time records for each time
series [5]. We also verify the robustness of Eq. (11) by

p

±

−

−

2σ and γj <

If two investors belong to the same category, either trend-
ing (γi > 2σ and γj > 2σ signiﬁcantly) or reversing
(γi <
2σ signiﬁcantly), the value of Cij
is expected to be signiﬁcantly positive. On the contrary,
if two investors belong respectively to the trending and
reversing categories, the value of Cij is expected to be
signiﬁcantly negative. To show the performance of the
model, we plot the contours of the correlation matrix of
inventory variation for all investors, for individuals and
for institutions, where the investors are sorted according
to their cross-correlation coeﬃcients CV R of the inven-
tory variation with the price return. Figure 6(d) shows

   
 
 
 
 
 
    
 
 
 
 
−3

−2

(a)

R
V

C

0.6

0.4

0.2

0

−0.2

−0.4

−0.6

−0.8
−4

(d)

R
V

C

0.4
0
−0.4
−0.8

log

(size)

−1

10

0

1

2

1

0.8

0.6

0.4

0.2

0

−0.2

−0.4

−0.6

−0.8

0.6

0.4

0.2

0

(b)

R
V

C

(e)

−0.2

−0.4

−0.6

−0.8
−4

−3

−2

log

(size)

−1

10

R
V

C

0.4
0
−0.4
−0.8

(c)

R
V

C

0.6

0.4

0.2

0

−0.2

−0.4

−0.6

−0.8
−4

(f)

R
V

C

0.4
0
−0.4
−0.8

0

1

2

0.8

0.6

0.4

0.2

0

−0.2

−0.4

−3

−2

log

(size)

−1

10

7

0

1

2

0.6

0.4

0.2

0

−0.2

−0.4

FIG. 6. (Color online) Panels (a-c) show the scatter plots of CV R versus a proxy of the size of the investor. For each stock,
the proxy is the ratio of the value exchanged by the investor (scaled by a factor 104) to the capitalization of the stock. Each
marker refers to an investor trading a speciﬁc stock. The three kinds of markers refer to investors whose inventory variations are
positively correlated ((cid:13)), negatively correlated ((cid:3)), or uncorrelated (△) with returns according to the block bootstrap analysis.
The two dashed lines indicate the 2σ threshold calculated using Eq. (11). Panels (d-f) are contour plots of the correlation
matrix of daily inventory variation of investors trading the stock 000001. We have sorted the investors into rows and columns
according to their cross-correlation coeﬃcients of inventory variation with its price return CV R. The evolution of CV R in the
same order as in the matrix is shown in the bottom panel, where the dashed lines bound the ±2σ signiﬁcance intervals.

that the left-top corner gives large positive Cij values and
the left-bottom and right-top corners gives large nega-
tive Cij values, as expected. Figure 6(e) give better re-
sults for individual investors, validating the linear model
(12). The results in Fig. 6(f) are worse for institutional
investors, which is due to the fact that most CV R val-
ues are small for institutions, as illustrated in Fig. 6(c).
However, Fig. 6(f) doses not invalidate the linear model,
since there are only three trending institutions and one
reversing institution. Indeed, the situation is quite simi-
lar for other individual stocks with very few investors of
the same category, as shown in Table I.

B. Causality

In Sec. IV A, we have shown that the inventory varia-
tion Vi(t) and the stock return R(t) have signiﬁcant posi-
tive or negative correlation for part of the investors. It is
interesting to investigate the lead-lag structure between
these two variables. For the largest majority of revers-
ing and trending ﬁrms in the Spanish stock market, it
is found that returns Granger cause inventory variation
but not vice versa at the day or intraday level, and the
Granger causality disappears over longer time intervals
[5]. Here, we aim to study the same topic for both indi-
vidual and institutional investors.

We ﬁrst

investigate the autocorrelation function
CV (t)V (t+τ ) of the inventory variation time series sampled
in 15-min time intervals. Figure 7(a) shows the three au-
tocorrelation functions for all the trending, reversing and
uncategorized investors. Each autocorrelation function
is obtained by averaging the autocorrelation functions of
the investors in the same category to have better statis-
tics. It is found that the inventory variation is long-term
correlated and the correlation is signiﬁcant over dozens of
minutes, which can be partly explained by the order split-
ting behavior of large investors [27–29]. We also ﬁnd that
the correlation is stronger among trending investors than
reversing investors. Figure 7(b) and Fig. 7(c) illustrate
the results for individuals and institutions. We observe
that institutions have stronger long memory than indi-
viduals. It implies that institutions are more specialized
to their trading strategies than individuals [5].

Panels (d-f) of Fig. 7 illustrate the averaged lagged
cross-correlation functions CV (t)R(t+τ ) between inventory
variations and returns. The results in the three panels
are qualitatively the same. For uncategorized investors,
no signiﬁcant cross-correlations are found between inven-
tory variations and returns, which is trivial due to the
“deﬁnition” of this category, as shown in Fig. 6(a-c). For
trending and reversing investors, it is evident that the
returns lead the inventory variations by dozens of min-
utes (τ < 0), where the cross-correlation CV (t)R(t+τ ) is

   
 
 
   
 
 
   
 
 
)
τ
+

t
(
V
)
t
(
V
C

0

10

−1

10

−2

10

−3

10

−4

10

10

−5
0

0.06

0.03

0

−0.03

−0.06

−0.09

)
τ
+

t
(
R
)
t
(
V
C

(a)

Trending
Reversing
Uncategotized

150 300 450 600 750 900 1050

τ (min)

(d)

Trending
Reversing
Uncategotized

0
10

−1

10

−2

10

−3

10

)
τ
+

t
(
V
)
t
(
V
C

10

−4
0

0.08

0.04

0

−0.04

−0.08

)
τ
+

t
(
R
)
t
(
V
C

(b)

Trending
Reversing
Uncategotized

0
10

(c)

Trending
Reversing
Uncategotized

8

150 300 450 600 750 900 1050

τ (min)

(e)

Trending
Reversing
Uncategotized

)
τ
+

t
(
V
)
t
(
V
C

−1

10

−2

10

10

−3
0

0.06

0.03

0

−0.03

−0.06

)
τ
+

t
(
R
)
t
(
V
C

150 300 450 600 750 900 1050

τ (min)

(f)

Trending
Reversing
Uncategotized

−0.12

−0.12

−450 −300 −150

150 300 450

−450 −300 −150

150 300 450

−450 −300 −150

150 300 450

−0.09

0
τ (min)

0
τ (min)

0
τ (min)

(g)

 R →  V
 V →  R

0.8

0.6

0.4

0.2

]
)
y

→
x
(
I
[
E

0.8

0.6

0.4

0.2

]
)
y

→
x
(
I
[
E

(h)

 R →  V
 V →  R

0.6

(i)

 R →  V
 V →  R

]
)
y

→
x
(
I
[
E

0.4

0.2

0

5 min 0.5 hour 1 hour 1 day 1 week
∆T

0

5 min 0.5 hour 1 hour 1 day 1 week
∆T

0

5 min 0.5 hour 1 hour 1 day 1 week
∆T

(j)

 R →  V
 V →  R
shuffled data

1

0.8

0.6

0.4

0.2

]
)
y

→
x
(
I
[
E

(k)

 R →  V
 V →  R
shuffled data

1

0.8

0.6

0.4

0.2

]
)
y

→
x
(
I
[
E

(l)

 R →  V
 V →  R
shuffled data

1

0.8

0.6

0.4

0.2

]
)
y

→
x
(
I
[
E

0

0

−0.3 −0.2 −0.1

0

0.1

0.2

−0.3 −0.2 −0.1

0

0.1

0.2

−0.3 −0.2 −0.1

0

0.1

0.2

0

CV R

CV R

CV R

FIG. 7. (Color online) The ﬁrst column (a,d,g,j) shows the results for all investors. The second column (b,e,h,k) shows the
results for all individual investors. The third column (c,f,i,l) shows the results for all institutional investors. (a-c) Averaged
autocorrelation functions CV (t)V (t+τ ) of the 15-min inventory variation V for trending, reversing and uncategorized investors.
The dashed lines give the 5% signiﬁcance level. (d-f) Averaged lagged cross-correlation functions CV (t)R(t+τ ) of the 15-min
inventory variation for trending, reversing and uncategorized investors. The dashed lines bound the ±2σ signiﬁcance interval.
(g-i) Conditional expected value of the indicator I(x → y) of the rejection of the null hypothesis of non-Granger causality
between x and y with 95% conﬁdence as a function of time horizons ∆T . The dashed lines show the 5% signiﬁcance level. (j-l)
Conditional expected value of the indicator I(x → y) as a function of the simultaneous cross-correlation C[Vi(t), R(t)]. The
black symbols refer to the Granger test on shuﬄed data and the dashed lines bound ±2σ signiﬁcance interval.

signiﬁcantly nonzero. When the price drops, trending in-
vestors will sell stock shares to reduce their inventory in
a few minutes, while reversing investors will buy shares
to increase their inventory. When the price rises, trend-
ing investors will buy shares to increase their inventory
in a few minutes, while reversing investors will sell shares

to reduce their inventory. In the meanwhile, we also ob-
serve nonzero cross-correlations for τ > 0 in shorter time
periods, which means that the inventory variations lead
returns.

To further explore the lead-lag structure between in-
ventory variations and returns, we perform Granger

 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
→

→

→

→

→

R) and I(R

causality analysis. We deﬁne an indicator I(X
Y ),
whose value is 1 if X Granger causes Y and 0 otherwise
[5]. In our analysis, the time resolution of the two time
series is 15-min. The values of I(V
V )
for all investors are determined at diﬀerent time scales
∆T . The average indicator values E[I(V
R)] and
V )] are plotted in Fig. 7(g-i) with respect
E[I(R
to ∆T for all investors, individual investors and insti-
V ) are
tutional investors. Both I(V
→
decreasing functions of ∆T . We note that E[I(X
Y )]
Y ) = 1. Figure
is the percentage of investors with I(X
V ) = 1
7 shows that there are more investors with I(R
than investors with I(V
R) = 1. On average, bidirec-
tional Granger causality is observed at the intraday time
scales and the Granger causality disappears at the weekly
level or longer. Moreover, individual investors are more
probable to be inﬂuenced by the intraday price ﬂuctua-
tions than institutions, because the I(R
V ) values of
individuals are greater than those of institutions at the
same time scale level.

R) and I(R

→

→

→

→

→

→

±

±

We then investigate the impact of investor category
on the causality indicator. The results for ∆T = 4
(i.e., one hour) are depicted in Fig. 7(j-l). The mid-
dle parts bounded by two vertical lines at CV R =
σ
correspond to uncategorized investors. The left parts
σ) correspond to reversing investors and the
(CV R <
−
right parts CV R >
σ correspond to trending investors.
It is found that a investor adjusts his inventory following
price ﬂuctuations with very large probabilities when his
value is large. This conclusion holds for both in-
CV R
|
dividual and institutional investors. The strong Granger
causality from inventory variations to returns and the
weak but signiﬁcant causality from returns to inventory
variations cannot be attributed to the non-Gaussianity
in the distributions of the variables, as veriﬁed by boot-
strapping analysis. Qualitatively similar results are ob-
tained for other ∆T values.

|

C. Herding behavior

Herding and positive feedbacks are essential for the
boom of bubbles [30, 31]. These topics have been stud-
ies extensively to understand the price formation process
[32–35]. Herding is a phenomena that a group of investors
trading in the same direction over a period of time. Here,
we try to investigate possible herding behaviors in diﬀer-
ent groups of investors.

We study possible buy and sell herding behaviors
among the same group of investors. Investors are classi-
ﬁed into diﬀerent groups based on their types (individual
or institution) and their categories (reversing, trending or
uncategorized). We deﬁne a herding index as follows [5]:

h =

N +
N + + N − ,

(14)

where N + is the number of buying investors and N − is
the number of selling investors in the same group over a

9

TABLE II. Number of herding days for diﬀerent groups of
investors. The total number of trading days is 237. The su-
perscripts “+” and “−” indicate buy herding and sell herding,
respectively. The subscripts “d” and “s” indicate individuals
and institutions, respectively. The time horizon is one day.

Code
000001
000002
000012
000021
000063
000488
000550
000625
000800
000825
000839
000858
000898
200488
200625

Reversing
d n−
n+
d n+
60 63 0
23 19 0
26 37 0
54 62 0
34 34 2
0
0
0
17 34 0
21 15 0
29 25 0
34 31 0
61 58 0
38 36 0
55 40 0
31 24 0
0
6
6

s n−
s
0
0
0
0
1
0
0
0
0
0
0
0
0
0
0

Trending
d n−
s n−
n+
d n+
s
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
7
3
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0

Uncategorized
d n−
s n−
n+
d n+
s
0
0
8
6
0
0
6
3
0
0
1
2
0
1
3
4
1
1
0
0
0
0
1
2
1
2
0
0
0
0
2
5
0
0
7
7
0
0
0
0
0
0
7
7
0
0
1
0
0
0
4
3
3
0
7
2
3
0
6
3

given time horizon. When the herding index h is smaller
than 5% under a binomial null hypothesis, we assess that
herding is present. In our analysis, we ﬁx the time hori-
zon into one day and determine the number of days that
herding was present for diﬀerent groups of investors. The
results are depicted in Table II.

According to Table II, there are no buying and sell-
ing herding days observed for trending institutions. For
trending individuals and reversing institutions, herding
is observed in only one stock on very few days. For cate-
gorized investors, we see slightly more herding days in a
few stocks. For reversing investors, the number of herd-
ing days is greater than for other investors and we ob-
serve comparable buying and selling herding days. Our
ﬁndings are consistent with those for the Spanish stock
market, especially in the sense that reversing investors
are more likely to herd [5]. Our analysis also allows us
to conclude that individuals are more likely to herd than
institutions in 2003.

V. SUMMARY

In summary, we have studied the dynamics of in-
vestors’ inventory variations. Our data set contains 15
stocks actively traded on the Shenzhen Stock Exchange
in 2003 and the investors can be identiﬁed as either indi-
viduals or institutions.

We studied the cross-correlation matrix Cij of inven-
tory variations of the most active individual and insti-
tutional investors.
It is found that the distribution of
cross-correlation coeﬃcient Cij is asymmetric and has a
power-law form in the bulk and exponential tails. The in-
ventory variations exhibit stronger correlation when both
investors are either individuals or institutions, which in-

10

dicates that the trading behaviors are more similar within
investors of the same type. The eigenvalue spectrum
shows that the largest and the second largest eigenvalues
of the correlation matrix cannot be explained by the ran-
dom matrix theory and the components of the ﬁrst eigen-
vector u(λ1) carry information about stock price ﬂuctu-
ation. In this respect, the behaviors diﬀer for individual
and institutional investors.

strategies. Moreover, there are far more reversing indi-
viduals (50%) than trending individuals (6%).
In con-
trast, there are slightly more trending institutions (10%)
than reversing institutions (8%). Hence, Chinese indi-
vidual investors are prone to selling winning stocks and
buying losing stocks, which provides supporting evidence
that trading is hazardous to the wealth of individuals
[9, 10].

Based on the contemporaneous cross-correlation coef-
ﬁcients CV R between inventory variations and stock re-
turns, we classiﬁed investors into three categories: trend-
ing investors who buy (sell) when stock price rises (falls),
reversing investors who sell (buy) when stock price rises
(falls), and uncategorized investors. We also observed
that stock returns predict inventory variations. It is in-
teresting to ﬁnd that about 56% individuals hold trend-
ing or reversing strategies and only 18% institutions hold

ACKNOWLEDGMENTS

We are grateful to Fabrizio Lillo for fruitful discussion.
This work was partially supported by the National Nat-
ural Science Foundation of China under grants 11075054
and 71131007, the Shanghai Rising Star Program un-
der grant 11QH1400800, and the Fundamental Research
Funds for the Central Universities.

[1] J.-P. Bouchaud, Nature 455, 1181 (2008).
[2] T. Lux and F. Westerhoﬀ, Nat. Phys. 5, 2 (2009).
[3] J. D. Farmer and D. Foley, Nature 460, 685 (2009).
[4] F. Schweitzer, G. Fagiolo, D. Sornette, F. Vega-
and D. R. White,

Redondo, A. Vespignani,
Science 325, 422 (2009).

collusive cliques in futures markets based on trading be-
haviors from real data,” (2011), arXiv:1110.1522.

[20] G.-F. Gu, W. Chen,
Physica A 387, 3173 (2008).

and W.-X.

Zhou,

[21] G.-F. Gu, F. Ren, X.-H. Ni, W. Chen, and W.-X. Zhou,

Physica A 389, 278 (2010).

[5] F. Lillo, E. Moro, G. Vaglica,
New J. Phys. 10, 043019 (2008).

and R. N. Mantegna,

[22] P. W. Holland and R. E. Welsch, Commun. Statist. The-

ory Methods 9, 813 (1977).

[6] J. Griﬃn,

J. H. Harris,

and S. Topaloglu,

[23] J. O. Street, R. J. Carroll, and D. Ruppert, Ann. Statist.

J. Financ. 58, 2285 (2003).
[7] H. Choe, B. C. Kho,

J. Financ. Econ. 54, 227 (1999).

and R. M.

Stulz,

[8] M.

Grinblatt

and

M.

Keloharju,

42, 152 (1988).

[24] Y.
J.
and
Proc. Natl. Acad. Sci. U.S.A. 107, 18803 (2010).

Wu,
Kurths,

Zhou,
H.

C.-S.

J.-H.

Xiao,
Schellnhuber,

J.

J. Financ. Econ. 55, 43 (2000).

[25] A.

M.

Sengupta

and

P.

P.

Mitra,

[9] T. Odean, J. Financ. 53, 1775 (1998).
[10] B. M. Barber and T. Odean, J. Financ. 55, 773 (2000).
and T. Odean,
[11] B. M. Barber, Y. Lee, Y. Liu,

Rev. Financ. Stud. 22, 609 (2009).

[12] L. Laloux, P. Cizeau, J.-P. Bouchaud, and M. Potters,

Phys. Rev. Lett. 83, 1467 (1999).

[13] V. Plerou, P. Gopikrishnan, B. Rosenow, L. A. N. Ama-
ral, and H. E. Stanley, Phys. Rev. Lett. 83, 1471 (1999).
Rosenow,
P. Gopikrishnan,
and H. E. Stanley,

Plerou,

[14] V.

B.

L. A. N. Amaral, T. Guhr,
Phys. Rev. E 65, 066126 (2002).

[15] J.

B.
EPL (Europhys. Lett.) 86, 48005 (2009).

Shen

and

Phys. Rev. E 60, 3389 (1999).

[26] V. Plerou, P. Gopikrishnan, B. Rosenow, L. A. N. Ama-
ral, and H. E. Stanley, Physica A 299, 175 (2001).

[27] G. Vaglica, F. Lillo, E. Moro,
Phys. Rev. E 77, 036110 (2008).

and R. N. Mantegna,

[28] E. Moro, J. Vicente, L. G. Moyano, A. Gerig, J. D.
and R. N. Mantegna,

Farmer, G. Vaglica, F. Lillo,
Phys. Rev. E 80, 066102 (2009).

[29] G. Vaglica, F. Lillo,

and R. N. Mantegna,

New J. Phys. 12, 075031 (2010).

Zheng,

[30] D. Sornette, Why Stock Markets Crash: Critical Events
in Complex Financial Systems (Princeton University
Press, Princeton, 2003).

[16] Z.-Q.

and
Jiang
Physica A 389, 4929 (2010).

W.-X.

Zhou,

[17] J.-J. Wang and S.-G. Zhou, Physica A 390, 398 (2011).
[18] X.-Q. Sun, X.-Q. Cheng, H.-W. Shen, and Z.-Y. Wang,

Physica A 390, 3427 (2011).

[31] D. Sornette, Phys. Rep. 378, 1 (2003).
[32] J. Lakonishok, A. Shleifer,
J. Financ. Econ. 32, 23 (1992).

and R. W. Vishny,

[33] R. Wermers, J. Financ. 54, 581 (1999).
R.
Nofsinger
[34] J.

and

R.

W.

Sias,

[19] J.-J. Wang, S.-G. Zhou,

and J.-H. Guan, “Detecting

J. Financ. 54, 2263 (1999).

[35] R. W. Sias, Rev. Financ. Stud. 17, 165 (2004).

