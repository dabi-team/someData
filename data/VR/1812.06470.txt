Effective Capacity for Renewal Service Processes
with Applications to HARQ Systems

Zheng Shi, Theodoros Tsiftsis, Weiqiang Tan, Guanghua Yang, Shaodan Ma, and Mohamed-Slim Alouini

1

8
1
0
2

c
e
D
6
1

]
T
I
.
s
c
[

1
v
0
7
4
6
0
.
2
1
8
1
:
v
i
X
r
a

Abstract—Considering the widespread use of effective capacity
in cross-layer design and the extensive existence of renewal ser-
vice processes in communication networks, this paper thoroughly
investigates the effective capacity for renewal processes. Based
on Z-transform, we derive exact analytical expressions for the
effective capacity at a given quality of service (QoS) exponent for
both the renewal processes with constant reward and with vari-
able rewards. Unlike prior literature that the effective capacity is
approximated with no many insightful discussions, our expression
is simple and reveals further meaningful results, such as the
monotonicity and bounds of effective capacity. The analytical
results are then applied to evaluate the cross-layer throughput
for diverse hybrid automatic repeat request (HARQ) systems,
including ﬁxed-rate HARQ (FR-HARQ, e.g., Type I HARQ,
HARQ with chase combining (HARQ-CC) and HARQ with
incremental redundancy (HARQ-IR)), variable-rate HARQ (VR-
HARQ) and cross-packet HARQ (XP-HARQ). Numerical results
corroborate the analytical ones and prove the superiority of our
proposed approach. Furthermore, targeting at maximizing the
effective capacity via the optimal rate selection, it is revealed that
VR-HARQ and XP-HARQ attain almost the same performance,
and both of them perform better than FR-HARQ.

Index Terms—Effective capacity, hybrid automatic repeat re-

quest, QoS exponent, renewal process.

I. INTRODUCTION

5 G has been envisioned to offer extremely high data rate (on

the order of Gbps), ultra-reliability (higher than 99.999%)
and very low latency (sub-1ms) [1]. To fulﬁll these demanding
requirements, plenty of existing works prefer to evaluate
and devise communication systems from physical-layer per-
spective. However, the constraints of link-layer quality of
service (QoS) were rarely considered in the literature, such
as queue length limitation and maximum allowable delay
[2]. Unfortunately, physical-layer models can not capture the
characteristics of these QoS requirements, which depends on
the queueing behavior of the connection model. Ignoring these
QoS limitations grossly overestimates the network perfor-
mance [3], and many QoS-constrained applications cannot be
supported [4]. Therefore, it is imperative to come up with a

Zheng Shi, Theodoros Tsiftsis and Guanghua Yang are with the School
of Electrical and Information Engineering, Jinan University, Zhuhai 519070,
China (e-mails:
theodoros.tsiftsis@gmail.com,
ghyang@jnu.edu.cn).

shizheng0124@gmail.com,

Weiqiang Tan is with the School of Computer Science and Educa-
tional Software, Guangzhou University, Guangzhou 510006, China (e-
mail:wqtan@gzhu.edu.cn).

Shaodan Ma is with the Department of Electrical and Computer En-
shao-

gineering, University of Macau, Macao S.A.R., China (e-mail:
danma@umac.mo).

Mohamed-Slim Alouini is with CEMSE Division, King Abdullah Uni-
versity of Science and Technology, Thuwal 23955-6900, Saudi Arabia (e-
mail:slim.alouini@kaust.edu.sa).

cross-layer performance metric that combines physical-layer
parameters and QoS requirements together.

To address the aforementioned issue, the concept of effec-
tive capacity was developed in [2] initially by considering the
ﬁnite buffer size in practice. This concept has been extensively
employed to evaluate the maximum supportable arrival rate
given a QoS exponent, where the QoS exponent affects the
statistical QoS constraints, including buffer overﬂow probabil-
ity and delay-violation probability. Furthermore, the effective
capacity enables us to optimally design cross-layer parame-
ters for various wireless systems subject to statistical QoS
constraints [5], [6]. However, most of the relevant literature
assumed perfect knowledge of channel state information (CSI)
at the transmitter, which is an impractical assumption due to
the unpredictable noise, quantization errors, etc. Particularly,
in the absence of perfect CSI, the retransmission technique
of hybrid automatic repeat request (HARQ) is frequently
utilized to enhance the system reliability. Nonetheless, the
introduction of HARQ would make the queueing behaviour of
the connection vastly involved, and consequently impedes the
analysis of effective capacity given diverse QoS requirements.
Instead, in [7], large deviation was adopted to convert the
physical-layer throughput of HARQ-IR into effective capacity
approximately. Moreover, the concept of effective throughput
was developed to bypass the complex effective capacity in
[3]. In [8], an accurate approximation of effective capacity
under small QoS exponent was obtained on the basis of the
cumulants of renewal processes. Whereas, the concept of the
effective capacity in [8] represents the maximum arrival rate
that can be supported by HARQ systems. No matter whether
the conveyed message can be recovered by receiver or not,
every HARQ cycle will be counted as a success. Obviously,
it will overestimate the link-layer throughput particularly for
high probability of the decoding failures. Therefore, only the
goodput of HARQ systems was considered into the formula-
tion of the effective capacity in [9], and the effective capacity
was obtained by using the recurrence relation approach. The
similar results were further extended to examine the outage
effective capacity of the buffer-aided diamond relay systems
in [10]. However in both [9], [10], the analytical results are
only applicable to ﬁxed-rate HARQ (FR-HARQ) schemes,
wherein the transmission rates remain constant during all
HARQ rounds.

Unfortunately so far,

the effective capacities of more
advanced and complex HARQ schemes, e.g., variable-rate
HARQ (VR-HARQ)
[11] and cross-packet HARQ (XP-
HARQ) [12], have never been investigated due to the challenge
of analyzing more complicated service process. Moreover,

 
 
 
 
 
 
even if the closed-form expressions have been derived for
the effective capacity of the conventional HARQ schemes
[9], [10], the complex expressions of the effective capacity
provided little insights and it is also difﬁcult to extend the
analytical results to the general case. Hence, they will impede
the effective cross-layer design of HARQ systems to further
enhance the system performance. To combat this issue and
generalize the analytical results, we notice that the HARQ
transmission model can actually be described by a renewal
reward process [13]. Speciﬁcally, the event that the trans-
mitter halts HARQ transmissions for the current message is
recognized to be a renewal, and the number of the transmitted
information bits reﬂects the reward received from the renewal.
In this paper, we ﬁrst derive a simple exact expression for
the effective capacity of the network services that follows
constant reward renewal process. The results are further ex-
tended to the general renewal process with variable rewards.
The simple analytical expressions not only offer accurate
approximation for the effective capacity under small QoS ex-
ponent, but also facilitate the extraction of further meaningful
insights. In particular, the effective capacity decreases with
the QoS exponent and is bounded. The analytical results are
then applied to calculate link-layer throughputs for different
HARQ systems, including the conventional FR-HARQ (e.g.,
Type I HARQ, HARQ with chase combining (HARQ-CC),
HARQ with incremental redundancy (HARQ-IR)), VR-HARQ
and XP-HARQ. Numerical examples are ﬁnally presented to
conﬁrm the proposed approach compared with the already
existing ones. Furthermore, aiming to maximize the effective
capacity through the optimal rate selection,
the numerical
results reveal that XP-HARQ and VR-HARQ reach almost the
same performance in terms of the optimal effective capacity.
The remainder of this paper is structured as follows. Section
II presents preliminaries on effective capacity and HARQ
schemes. In Section III, the effective capacity for the renewal
process with constant reward is derived by means of Laplace
transform and Z-transform, respectively. Section IV then ex-
tends the results to the general renewal reward process. The
analytical results are further applied to evaluate the link-layer
throughput of various HARQ systems in Section V. Numer-
ical results are presented for veriﬁcations and discussions in
Section VI. Section VII ﬁnally concludes this paper.

II. PRELIMINARIES

A. Effective Capacity

The cross-layer model of the typical HARQ system with
limited buffer is shown in Fig. 1. By assuming a constant
arrival rate µ, buffer overﬂows will happen if the queue
length Q exceeds the buffer threshold τ , and it can not
be avoided under limited buffer size. Based on the theory
of large deviations, the buffer overﬂow probability can be
e−θτ for large values of τ
approximated as Pr (Q
≈
[14], where Q and τ stand for the stationary queue length
and buffer’s threshold, respectively. It is worth noting that the
QoS exponent θ plays a critical role in connecting the physical
and link layers. The QoS exponent θ implies how fast the
τ ) decays exponentially
buffer overﬂow probability Pr (Q

τ )

≥

≥

2

ln (Pr (Q

with τ . Accordingly, once a constraint is imposed on the buffer
overﬂow probability, the QoS exponent θ can be determined
τ ))/τ . To meet the requirement of
as θ
≈ −
≥
the QoS exponent,
the constant arrival rate µ should be
properly chosen. To this end, the concept of the effective
capacity was developed to specify the maximum supportable
[2]. Assume that the service
arrival rate, i.e., Ce = max
µ
}
{
process satisﬁes the G¨artner-Ellis theorem [14], given the QoS
exponent θ, the effective capacity is explicitly given by the
limit [2]

Ce =

lim
t→∞

−

1
θt

ln E

e−θSt

,

(1)

{·}

where E
(cid:8)
is the expectation operator and St is the time-
accumulated service process representing the total amount of
reward received until time t. Moreover, the deﬁnition of the
effective capacity was further expanded to the case with ﬁnite
θt ln E
time t in [9], i.e., Ce,t =

e−θSt

(cid:9)

1

.

−

B. HARQ Schemes

(cid:8)

(cid:9)

This paper offers a through analysis of the effective ca-
pacity for various HARQ systems. As a widely used reliable
transmission technique, HARQ leverages both the forward
error correction coding and automatic repeat request such
that the currently received packet could be combined with
the erroneously received packets to diminish the probability
of decoding failures. As shown in Fig. 1, according to the
HARQ mechanism, the delivered message is ﬁrst encoded
into a long codeword, and the generated codeword is then
broken into multiple subcodewords. These subcodewords will
be sent sequentially in different HARQ rounds upon the
reception of negative acknowledgment (NACK) messages,
while the feedback of the positive acknowledgment (ACK)
messages notiﬁes the transmitter about the initiation of a
new HARQ process for the next information message. On
the basis of whether all the subcodeword lengths are ﬁxed
or not, the HARQ scheme can be classiﬁed into FR-HARQ
and VR-HARQ. According to different encoding/decoding
operations performed at the transceiver, the conventional FR-
HARQ can be further categorized into three types, i.e., Type I
HARQ, HARQ-CC and HARQ-IR [13]. To be speciﬁc, Type
I HARQ does not require the aid of the buffer at the receiver
because the failed packets are directly discarded. Whereas,
both HARQ-CC and HARQ-IR have the dedicated buffer
to store the erroneously received packets, and their major
difference lies in that diversity combining and code combining
are employed for the decodings of HARQ-CC and HARQ-
IR, respectively. In contrast with the conventional FR-HARQ,
VR-HARQ assumes the variable lengths of the subcodewords
for further throughput enhancement [11]. It is worth noting
that both FR- and VR-HARQ do not include new information
bits into retransmissions, they may yield the waste of mutual
information. To overcome this issue, VR-HARQ is proposed
to add new information bits to retransmissions for possible
redundant mutual information [12].

Note that the cross-layer HARQ system can be modelled
by using the renewal reward process [13]. Speciﬁcally, the
event that HARQ retransmissions stop for the current mes-
sage is treated as a renewal, and each time a renewal takes

0110010……

……

3

K
C
A
N

K
C
A
N

K
C
A

K
C
A

K
C
A
N

Fig. 1: Cross-layer model for the buffer-limited HARQ System.

place we receive a reward, which is the total amount of
the delivered information bits. Most of the network services
obey renewal reward processes, which incorporate the HARQ
channel service as a special case. Therefore, to ease extension,
the effective capacity of the renewal service process with
constant reward is derived ﬁrst in Section III. A uniﬁed closed-
form expression of the effective capacity is then obtained for
the complex renewal service process with variable rewards
in Section IV. The analytical results are then employed to
obtain the effective capacity of various HARQ schemes. For
the simpliﬁcation of the analysis, the receptions of the HARQ
feedback messages are assumed to be error- and delay-free.

C. Two Useful Theorems

To start with the analysis, two important theorems will be
repeatedly used in the sequel. The ﬁrst theorem is utilized to
derive the effective capacity in a matrix form.

Theorem 1. If z1,
, zK are distinct, the zero points of
the function φ(z) does not coincide with z1,
, zK, and
φ(z) has no poles. The inverse Z-transform of ψ(z) ,
φ (z)/

zk) can be written in a compact form as

· · ·

· · ·

K
k=1 (z

−

−1

Q
Z

ψ (z)
}
{

(t) =

1
2πi

IC

ψ(z)zt−1dz =

det F
det Z ,

(2)

) denotes the inverse Z-transform,
the integration which encir-

j−1

, zK, F =
size K

zi
i,j
K and Z =
i
(cid:1)
K and

h(cid:0)
with size K

×

×

−1(
·

where i = √

1,

Z

−
is the contour path of
the poles z1,

C
cles all of
· · ·
is a Vandermonde matrix of
t−1φ(zi)
i,1≤j≤K−1 ,
(cid:1)

zi
det
h(cid:0)
Proof. Please see Appendix A.

zi
refers to the determinant operation.

j−1

i,K

i

(cid:0)

(cid:1)

·

The second theorem is invoked to prove the monotonicity
of the effective capacity with respect to the QoS exponent θ.

Theorem 2. If f (x) is twice differentiable and f (0) = 0,
η(x) = f (x)/x is increasing whenever f ′′(x)
0 and
decreasing otherwise.

≥

Proof. Please see Appendix B.

III. EFFECTIVE CAPACITY OF THE RENEWAL PROCESS
WITH CONSTANT REWARD

If each time a renewal occurs with a constant reward R, the
total amount of the accumulated reward is St = RNt, where
Nt denotes the renewal counting process. More precisely, the
,
counting process Nt is deﬁned as Nt = max
n :
}
where
is an independent and
Xi, i
identically distributed (i.i.d.) sequence of interarrival times.
Accordingly, the effective capacity of the renewal service
process reduces to [8]

n
i=1 Xi and

n =

n
S

P

≤

N

∈

S

{

{

}

t

Ce =

lim
t→∞

−

1
θt

ln E

e−θRNt

.

(3)

We denote by fX (x) the probability density function (PDF)
of each Xi. Moreover, E
e−θRNt
is the expectation taken
over Nt, such that

(cid:9)

(cid:8)

(cid:9)

(cid:8)

∞

E

e−θRNt

=

e−θRn Pr (Nt = n),

(4)

(cid:8)
and Pr (Nt = n) is given by

(cid:9)

n=0
X

Pr (Nt = n) = Pr

n
{S
= Fn (t)

≤

t
Pr
} −
Fn+1 (t) ,

{S

n+1 ≤

t

}

(5)

−
where Fn (t) represents the cumulative distribution function
(CDF) of

n, i.e.,

S

Fn (t) = Pr

n
{S

≤

t

}

= Pr

n

(

i=1
X

Xi

.

t
)

≤

(6)

A. Laplace Transform-Based Analysis

The independence among Xi’s motivates us to calculate
(6) through Laplace transform. Denote by
(s) the Laplace
F
∞
(s) = E(e−sX ) =
0 e−sxfX (x)dx.
transform of X, i.e.,
By applying the convolutional property of Laplace transform
R
(s))n/s
(t), where
to (6), it follows that Fn (t) =
}
−1 stands for the operator of the inverse Laplace transform.
L
By substituting this result into (5), we get Pr (Nt = n) =
(t). Putting this result into (4)

(s))n (1

(s))/s

(
F

−1

−1

F

L

{

(
F

{

L

− F

}

together with the formula of the sum of a geometric series,
we reach

E

e−θRNt

=

−1

1

L

s (1

(cid:26)

(s)

− F
e−θR

(s))

(cid:27)

(t) ,

(7)

(cid:12)
(cid:12)

(cid:12)
(cid:12)

F

−

−

1/

(cid:9)
(s)

s + λt

−
(cid:0)

(cid:8)
e−θR

e−θRNt

λte−θR

F
where
< 1. By substituting (7) into (3), the
evaluation of the effective capacity can thus be enabled.
By taking the Poisson service process as an example, Nt
follows a Poisson distribution with mean λt, E
=
. On the
(cid:9)
other hand, the interarrival time is found to be exponen-
P
it follows that
tially distributed with mean 1/(λt). Thus,
(s) = λt/(s + λt). By using (7), E
=
−1
,

(cid:1)
e−θRNt
F
λt + λte−θR
(cid:8)
L
which consequently justiﬁes the analytical result.

∞
k=0 e−θRke−λt(λt)k/k! = exp

λt + λte−θR
(cid:8)

(cid:0)
Unfortunately,

(cid:1)
the application of Laplace transform to
qke−sk)
HARQ systems (F (s) is written in the form of
usually results in an inﬁnite number of poles in (7), and
most of the time there is no closed-form expression for the
effective capacity. Moreover, the computation of (7) relying
on numerical methods entails higher complexity and accuracy
due to the calculation of exp(
sk) for extremely high s. These
−
facts hinder the thorough analysis of the effective capacity.
is a discrete renewal
However, if the sequence
Xi, i
process (e.g., HARQ channel service), Z-transform can be
applied to investigate the effective capacity for more insights.

(t) = exp

−
(cid:0)

P

(cid:1)(cid:9)

N

∈

(cid:8)

(cid:9)

{

}

B. Z-Transform-Based Analysis

· · ·

· · ·

, Xi,

If X1, X2,

are i.i.d. discrete and non-negative
integer random variables with the probability mass function
[0, K], Z-transform of the
(pmf) Pr(Xi = k) = qk, k
K
k=0 qkz−k.
distribution of Xi
Similarly, by applying the convolutional property of Z-
P
(z))nz/(z
transform to (6), we have Fn (t) =
.
1)
Z
}
leads to Pr (Nt = n) =
Combining the latter with (5)
(z))n (1
can

. From (4), E

is expressed as

e−θRNt

(z) =

(
X
{

(z))

−

−1

−1

X

∈

Z
be rewritten as

X

z
z−1 (

n
e−θRNt

E

(cid:8)
where
E
e−θRNt
(cid:12)
(cid:12)
(cid:9)
e−θRNt

(cid:8)
E

− X

=

1
2πi

(z

o
z (1
1) (1

(z))
e−θR

− X
−

(cid:8)

(cid:9)
zt−1dz. (8)

(z))

IC
< 1. By using the deﬁnition of

−

(cid:9)
e−θR
X
can be further expressed as

(z)

X

(z),

X

(cid:12)
(cid:12)

=

1

1

−

eθR
−
q0e−θR

1
2πi

zt+K (1−X (z))
z−1
(z

zi)

−

IC

dz,

(9)

K

(cid:8)

X

−

i∈Φ
Q
= 0

(zi)

e−θR

. Clearly, zi

(zi) = eθR

(cid:9)
zi : zi

(cid:8)
where Φ ,
= 0
1
.
if qK
= 0, Φ is therefore equivalent to
zi :
(cid:9)
(cid:0)
(cid:1)
< 1 can be proved by applying
Furthermore, 0 <
zi
(cid:9)
(cid:8)
|
|
(zi) = eθR. We assume that zi’s are
triangle inequality to
X
distinct for analytical tractability. Thus the cardinality of Φ is
K, zK
zk) then
−
Φ, and
follows. The integrand in (9) has K distinct poles zi
it is worthwhile to mention that z = 1 is not a pole because
1) = constant. Accordingly, by using
limz→1(1
− X
Theorem 1, E

q0e−θR)

−
e−θRNt

K
k=1 (z

(z))/(z

e−θR

= (1

(z)

Q

−

−

X

X

∈

1

(cid:1)

(cid:0)

is obtained as
eθR
−
q0e−θR

=

1

1

−

(cid:8)
E

(cid:9)
e−θRNt

(cid:8)

(cid:9)

det B
det A ,

(10)

4

is a Vandermonde matrix of size

j−1

where A =

zi
K and B =

K
with size K

×

i,j
i
j−1

zi
(cid:1)

h(cid:0)
t+K/(zi
i,1≤j≤K−1 ,
K. Plugging (10) into (3) leads to
(cid:1)

zi

(cid:0)

1)

−

i,K

(cid:1)

i

×

h(cid:0)
(1−eθR)det B
(1−q0e−θR)det A
θt

ln

Ce =

lim
t→∞

−

=

lim
t→∞

−

1
θt

ln det B. (11)

Without loss of generality, let z1 be the largest in absolute
value in Φ, i.e.,
zi

, we have

= max

[1, K]

, i

{|

|

∈

}

z1|

|

Ce =

lim
t→∞

−

t+K

ln z1
θt

−1

=

ln z1
θ

=

ln ζ
θ

,

zi
z1
zi

(cid:16)

j−1

zi

(cid:0)

i,1≤j≤K−1 , 
(cid:1)




(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

t+K

(cid:17)
−

1 



i,K

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(12)
(cid:12)

where ζ , z1
expanded on the basis of (12).

−1. In the following, some discussions are

1) Calculation of ζ: It is clear from (12) that ζ

ζ satisﬁes

K

qkζk = eθR.

k=0
X
By applying Jensen’s inequality to (13), we have

K
P
k=0

ζ

kqk

= ζ

E(X).

K

k=0
X

qkζk

≥

1, and

≥

(13)

(14)

θR

θR

e

Thus, ζ
E(X) follows. Note ζ is larger than or equal to 1,
≤
E(X) ]. The latter eases the calculation of ζ.
ζ belongs to [1, e
More speciﬁcally, let us deﬁne g(x) ,
eθR.
Since g(x) is an increasing function of x if x > 0, ζ is
deﬁnitely the unique zero point of g(x) within the range
E(X) ]. Accordingly, the bisection method can be
x
adopted to calculate ζ.

K
k=0 qkxk

[1, e

P

−

∈

θR

2) Approximation of Ce:

If θ is sufﬁciently small,

the

effective capacity can be approximated by Ce
−
2E (X)3
θR2Cov (X)/
from [8]. This can be further con-
ﬁrmed by using Taylor expansion of (12). To proceed, we
(cid:16)
deﬁne u(θ) = ln ζ and h (u) =

K
k=0 qkeku such that

≈

(cid:17)

R/E (X)

h (u(θ)) = eθR.

P

(15)

By using Taylor series expansion, u(θ) can be expanded as

u(θ) = u (0) + u′ (0) θ +

u′′ (0)
2

θ2 + o

θ2

,

(16)

) refers to the little-O notation, u′ and u′′ denote
where o(
·
the ﬁrst and second derivatives of u with respect to (w.r.t.)
θ, respectively. u (0) and its derivatives can be determined as
follows.

(cid:0)

(cid:1)

It is readily found from (15) that u (0) = 1. Taking the
ﬁrst derivative w.r.t. θ at the both sides of (15) leads to
dh
du u′(θ) = ReθR. With the deﬁnition of h(u), u′(θ) can
K
then be obtained as u′(θ) = ReθR /
k=0 qkkeku(θ). Hence,

P

6
6
(18)

equals to one, i.e.,

qkeku(θ)

qkk2eku(θ)



Nt, St is given by

.

(17)

u′(0) = R/E (X). Similarly, taking the ﬁrst derivative of u′(θ)
w.r.t. θ gives u′′(θ) as

u′′(θ) = R2eθR

qkkeku(θ)

K

K

qkkeku(θ)



k=0
X
2

K

−

!

−3

!

×

K

−

k=0
X

k=0
X

k=0
X
R2Cov (X)/(E (X))3, where Cov(
·


Thus, u′′ (0) =
) de-
notes the covariance operator. Substituting u (0), u′(0) and
u′′(0) into (16) together with the deﬁnition of u(θ) arrives
2E (X)3
. Con-
at ζ
sequently, putting ζ into (12) leads to the approximation of
(cid:16)
Ce, which coincides with the result in [8].

θR/E (X)
(cid:16)

θ2R2Cov (X)/

exp

(cid:17)(cid:17)



−

≈

3) Properties of Effective Capacity: By applying the
Cauchy-Schwarz inequality to (17), we have u′′(θ)
0. With
Theorem 2, the effective capacity is found to be a decreasing
function of QoS exponent θ. Moreover, as proved in Appendix
C, Ce is bounded as

≤

R
K ≤

Ce

≤

min

R
K −

ln qK
Kθ

,

R
E(X)

,

(cid:19)

(cid:18)

and limθ→∞ Ce = R/K if qK > 0.

{

}

Xi

4) Extension to the General Case: The result of (12) can
be extended to a general case when
is a non-negative
continuous renewal process. Speciﬁcally, the horizontal axis
of the distribution of Xi can be partitioned into a number
of equal intervals, each with length ∆x. This discretization
leads to a new discrete random variable ˜Xi with pmf given by
Pr( ˜Xi = k) =
fX (x)dx , qk. Therefore, a similar
approach in Subsection III-B can be adopted to approximate
the effective capacity, and the approximation can become more
accurate by using a higher-resolution discretization. As ∆x
→
0, it is readily proved that the exact expression of the effective
capacity is

(k+1)∆x
k∆x

R

Ce =

ln ζ
θ

,

where ζ is the solution to the following equation

E

ζX

= eθR, ζ

0.

≥

(19)

(20)

θR

(cid:0)

(cid:1)

∈

[1, e

E(X) ], and the proof can be found in Appendix D.
ζ
Furthermore, it is readily proved that the same properties as
shown in Subsections III-B1-III-B3 also apply to the general
case except for the bounds of the effective capacity in (18).
Nevertheless, (18) is applicable to the discrete renewal service
process with non-integer interarrival time, and K stands for
the maximum interarrival time herein.

IV. EFFECTIVE CAPACITY OF THE GENERAL RENEWAL
REWARD PROCESS

In general, the reward earned each time could be variable
apart from constant [15]. In communication systems,
the
reward of the i-th renewal commonly varies with the length
of the renewal interval Xi and the channel/termination state

5

Si of each renewal1. We denote by (Xi, Si) the i-th renewal
(Xi, Si) the reward received from
event state, and denote by
the i-th renewal. Likewise, the effective capacity of discrete
renewal service processes is derived ﬁrst, and the analytical
results are further extended to that of continuous ones.

R

By favor of the deﬁnition of the renewal counting process

Nt

St =

i=1
X

(Xi, Si).

R

(21)

Note that the renewal depends on the interarrival time and
the termination state, we deﬁne Rk,s ,
(Xi = k, Si = s)
for notational convenience, where k
[1, vk].
Moreover, denote by qk,s the probability that the renewal event
is ended with interval length k and termination state s, i.e.,
qk,s , Pr (Xi = k, Si = s). Thus, the probability that the
interarrival time is k can be obtained as
vi

[1, K] and s

R

∈

∈

vi

Pr (Xi = k) =

Pr (Xi = k, Si = j) =

qk,j .

(22)

j=1
X

j=1
X

Adding up the probabilities qk,s of all the renewal states

K

vk

k=1

s=1

qk,s = 1.

(23)

X

X
To facilitate the analysis, we deﬁne a vector of
re-
newal counting processes that count the numbers of Rk,s’s
achieved by the network service up to time t as nt =
, where nt,k,s represents the num-
(nt,k,1,
ber of the reward Rk,s’s earned up until time t, and the
(cid:16)
subscript t is omitted in the sequel for simplicity. Moreover,
since the maximum interval between two consecutive renewals
is K, nt should satisfy the following constraint as

, nt,k,vk )K

· · ·

k=1

(cid:17)

K + 1]+

[t

−

K

vk

k=1

s=1

knk,s

t,

≤

(24)

X
where [x]+ = max
is the projection onto the nonneg-
{
ative orthant. With the above deﬁnition, the total amount of
reward given in (21) can be rewritten as

X

≤
0, x
}

St =

K

vk

k=1

s=1

nk,sRk,s.

(25)

X
Therefore, the corresponding effective capacity can be ob-
tained as

X

Ce =

lim
t→∞

−

1
θt

ln E

e−θ PK

k=1 P

vk
s=1 nk,sRk,s

n

ϕ(t)

(26)

,

o

|

{z

where ϕ (t) is given by (27), shown at the top of the next
page. Different from Section III, it is impossible to directly
apply Z-transform to derive the moment generating function
(mgf) of St, ϕ(t), due to the complex vector form of nt. To
address this challenge, the effective capacity with ﬁnite time
is obtained by using the multinomial distribution of nt.

}

1For example, Si represents the outcome whether the receiver succeeds to
decode the message after the termination of HARQ. Moreover, Si could also
be the channel gains if perfect CSI is known at the transmitter, and adaptive
& modulation scheme is adopted.

 
 
ϕ (t) =

K
P
k=1

vk
P
s=1

knk,s∈[[t−K+1]+,t]

X

K
P
k=1

vk
P
s=1

−θ

e

nk,sRk,s

Pr

nt =

(nk,1,

(cid:16)

(cid:16)

· · ·

, nk,vk )K

k=1

.

(cid:17)(cid:17)

6

(27)

˜Bl

,

=

and

i,K

(cid:21)
the

(cid:17)

polynomial
loss of generality,
. Plugging (34) into

i,j

,
(cid:21)

where

˜A

=

˜zj−1
i

,

K

˜zj−1
i

i,1≤j≤K−1

(cid:20)(cid:16)
(cid:17)
κ=l aκ ˜zt+l−κ−1
i
(cid:20)(cid:16)
of
roots
˜zi’s
K
κ=1 aκzK−κ = 0. Without
zK
−
we deﬁne
[1, K]
˜zi
˜z1|
}
{|
|
P
(26) leads to

(cid:17)
are K distinct

= max

(cid:16)P

, i

∈

|

Ce =

lim
t→∞

−

1
θt

ln ˜zt
1

K

l=1
X

ϕ (K

−

l) ˜zl−κ−1
1

i,1≤j≤K−1

det

˜zj−1
i
(cid:16)

"

(cid:17)

ln ˜z−1
1
θ

=

ln ˜ζ
θ

,

×

=

K

,

κ=l
(cid:18)
P
det ˜A

t+l−κ−1

aκ

˜zi
˜z1

(cid:16)

(cid:17)

(cid:19)i,K#

(35)

where ˜ζ = ˜z−1
discussions are carried out as follows based on (35).

1 . In analogous to Subsection III-B, some

≥

1) Calculation of ζ: It is obvious from (35) that ˜ζ is a real
number and ˜ζ
1. Similarly, we deﬁne ˜g(x) =
−
1. Hence, ˜ζ is the zero point of ˜g(x) and uniquely exists owing
to its increasing monotonicity within x
0. The monotonicity
≥
enables us to ﬁnd the zero point ˜ζ with bisection method, and ˜ζ
(X, S))/E (X))], where the upper bound
lies in [1, exp (θE (
is proved in Subsection IV-B3.

K
κ=1 aκxκ

P

R

2) Approximation of Ce: By deﬁning ˜u(θ) = ln ˜ζ and
vκ
˜h (˜u) =
j=1 qκ,je−θRκ,j eκ˜u, we have ˜h (˜u) = 1. In
analogous to Subsection III-B2, ˜u(θ) can be approximated for
P
small θ as

K
κ=1

P

˜u(θ)

≈

˜u (0) + ˜u′ (0) θ +

˜u′′ (0)
2

θ2,

(36)

where ˜u′ and ˜u′′ denote the ﬁrst and second derivatives of ˜u
w.r.t. θ, respectively. Clearly, ˜u(0) = 0. ˜u′(θ) and ˜u′′(θ) are
given by

˜u′(θ) =

P

K
κ=1
K
κ=1

P

vκ
j=1 qκ,jRκ,je−Rκ,j θeκ˜u
vκ
j=1 κqκ,je−Rκ,j θeκ˜u

,

(37)

and (38) at the top of the next page, respectively. Hence, ˜u′(0)
P
and ˜u′′(0) can be respectively obtained as

P

˜u′(0) =

K
κ=1
K
κ=1 κ
P

vκ
j=1 qκ,jRκ,j
vκ
j=1 qκ,j

P

=

E (

(X, S))

R
E (X)

,

(39)

P
E(

P
(X, S)E (X)

˜u′′(0) =

−

R

E (
−
(E (X))3

R

(X, S)) X)2

.

(40)

(39) implies that ˜u′(0) refers to the average reward over time.
Particularly for the HARQ schemes, ˜u′(0) is the so-called the
long term average throughput (LTAT) [13].

(34)

A. Effective Capacity with Finite Time

(cid:16)

−

P

P

· · ·

(cid:17)(cid:17)

K
k=1

(nk,1,

is derived

To proceed, Pr

nt =
(cid:16)

, nk,vk )K
k=1
vk
s=1 knk,s to show
ﬁrst. To do so, we deﬁne τ = t
the time of the last renewal passed before time t. Clearly,
it follows from (24) that τ is bounded as 0
K,
and the interval of the last renewal should be larger than τ ,
i.e., XNt+1 > τ . According to the law of total probability,
is given by (28), shown
Pr
k=1
at the top of the page, where step (a) holds because of the
independence among renewals, and step (b) holds by using
(22). More speciﬁcally, the vector nt−τ follows a multinomial
distribution with the pmf given by (29), shown at the top of this
nQ!) is the multinomial
page, where

nt =
(cid:16)

, nk,vk )K

(nk,1,

(cid:17)(cid:17)

· · ·

≤

≤

(cid:16)

τ

n
n1,··· ,nQ

coefﬁcient and n =

(cid:0)

= n!/ (n1!
Q
q=1 nq.
(cid:1)

· · ·

By substituting (28) and (29) into (27) together with some
algebraic manipulations, ϕ (t) is ﬁnally rewritten as (30) at
the top of the following page. Speciﬁcally, if 0
t < K, (30)
becomes

P

≤

t
P
k=1

vk
P
s=1

−θ

e

Rk,snk,s

ϕ (t) =

vk
Xt
P
P
s=1
k=1

knk,s∈[0,t]

t

vk

× 



k=1
(nk,1,
P
K

· · ·

nk,s
s=1
, nk,vk )t
P
vi

×

vk
t
Xi=t−
P
P
s=1
k=1

knk,s+1

j=1
X

t

vk

nk,s

qk,s

k=1
Y

s=1
Y



k=1


qi,j, 0

t < K,

(31)

≤

and ϕ(0) = 1. However, for large t, the computation of ef-
fective capacity with (30) causes higher complexity overhead.
To address this issue, we turn to the Z-transform to derive the
effective capacity in a closed-form.

B. Z-Transform-Based Analysis

By virtue of the recurrence relation of multinomial coefﬁ-
cient [16, eq.26.4.10], (30) can be rewritten as (32), shown at
the top of the next page. By assuming t
K and switching the
order of summations along with some rearrangements, ϕ (t)
is represented by a homogeneous difference equation as

≥

K

ϕ (t)

−

aκϕ (t

−

κ) = 0, t

K,

≥

(33)

where aκ =
applying Z-transform to (33), ϕ (t) can be expressed as

vκ
j=1 qκ,je−θRκ,j . As proved in Appendix E, by

κ=1
X

P

K

ϕ(t) =

ϕ (K

l=1
X

det ˜Bl
det ˜A

l)

−

, t

≥

K,

(cid:17)(cid:17)

K

Pr

nt =
(cid:16)

(cid:16)

(nk,1,

· · ·

, nk,vk )K

k=1

=

Pr

nt =

(nk,1,

K

(cid:17)(cid:17)

i=τ +1
X

(cid:16)

, nk,vk )K

k=1

· · ·

(a)
= Pr

(b)
= Pr

(cid:16)
nt−τ =

(cid:16)
nt−τ =
(cid:16)

(nk,1,

· · ·

, nk,vk )K

k=1

(cid:16)

(nk,1,

· · ·

, nk,vk )K

k=1

(cid:16)

7

XNt+1 = i

Pr (XNt+1 = i)

(cid:17)(cid:12)
(cid:12)
K
(cid:12)

(cid:17)

Pr (XNt+1 = i)

(cid:17)(cid:17)

i=τ +1
X
K

vi

qi,j,

(28)

(cid:17)(cid:17)

i=τ +1
X

j=1
X

Pr

nt−τ =

(nk,1,

(cid:16)

(cid:16)

· · ·

, nk,vk )K

k=1

=

K

vk

nk,s
s=1
, nk,vk )K
P

k=1

(nk,1,

k=1
P

· · ·





qk,s

nk,s.

(29)

K

vk





k=1
Y

s=1
Y

ϕ (t) =

K
P
k=1

vk
P
s=1

knk,s∈[[t−K+1]+,t]

X

K
P
k=1

vk
P
s=1

−θ

e

Rk,snk,s





vk

nk,s
s=1
, nk,vk )K
P

k=1

(nk,1,

k=1
P

· · ·

nk,s

qk,s

K

vk





k=1
Y

s=1
Y

K

vi

qi,j.

(30)

vk
K
Xi=t−
P
P
s=1
k=1

knk,s+1

j=1
X

K
P
k=1

vk
P
s=1

−θ

e

Rk,snk,s

K

vk

nk,s

qk,s

K

vi

qi,j

ϕ (t) =

K
P
k=1

vk
P
s=1

knk,s∈[[t−K+1]+,t]

X

K

vκ

×

κ=1
X

ν=1
X





(n1,1,

· · ·

, n1,v1 ) ,

· · ·

, (nκ,1,

vk
K
Xi=t−
P
P
s=1
k=1

knk,s+1

j=1
X

nk,s

1

−

k=1
Y

s=1
Y

K

vk

s=1
k=1
, nκ,ν
P
P

· · ·

1,

· · ·

, nκ,vκ ) ,

· · ·

, (nK,1,

· · ·

, nK,vK )

−

K

vκ

κ=1
P
K

j=1
P
vκ

κ=1
P

j=1
P

 −

+









qκ,jRκ,j

2e−Rκ,j θeκ˜u + ˜u′

κqκ,jRκ,je−Rκ,j θeκ˜u

˜u′

−

K

˜u′′(θ) =

K

vκ

κ=1
P
K

j=1
P
vκ

κqκ,jRκ,je−Rκ,j θeκ˜u

K

vκ

!
K

κ=1
P
vκ

κqκ,je−Rκ,j θeκ˜u

j=1
P
qκ,jRκ,je−Rκ,j θeκ˜u

κ2qκ,je−Rκ,j θeκ˜u

κ=1
P
vκ

j=1
P
κqκ,je−Rκ,j θeκ˜u

2

!

!

κ=1
P

j=1
P

.













,

(32)

(38)

κ=1
P

j=1
P

Substituting (39) and (40) into (36) along with (35), the

effective capacity can be approximated as

Ce

≈

E (

(X, S))

R
E (X)
θE

(

R

−

n

(X, S)E (X)

(X, S)) X)2

E (
−
2(E (X))3

R

.

o

(41)

3) Properties of Effective Capacity: It is proved in Ap-
pendix F that the effective capacity is a decreasing function
of θ. Moreover, Ce is bounded as

Rˆκ,ˆj
K ≤

Ce

≤

min

(cid:26)

Rˆκ,ˆj

ˆκ −

ln qˆκ,ˆj
ˆκθ

,

E (

(X, S))

R
E (X)

,

(42)

(cid:27)

where (ˆκ, ˆj) = arg(κ,j) minqκ,j >0 Rκ,j. Accordingly, as θ
approaches to inﬁnity, Ce is bounded as
Rˆκ,ˆj
K ≤

Rˆκ,ˆj
ˆκ

lim
θ→∞

(43)

Ce

≤

.

{

(Xi, Si)
}

4) Extension to the Continuous Ones: Similarly to Subsec-
tion III-B4, the result of (35) can also be extended to the
case that
is a non-negative continuous renewal
process and the reward is variable. Speciﬁcally, the horizon-
tal and vertical axis of the distribution of (Xi, Si) can be
partitioned into a number of equal rectangles, each with area
∆s. This discretization leads to two new discrete random
∆x
variables ( ˜Xi, ˜Si) with pmf given by Pr( ˜Xi = k, ˜Si =
(l−1)∆s fX,S(x, s)dxds , qk,l. Therefore,
l) =
R

k∆x
(k−1)∆x

l∆s

×

R

 
 
→

EX,S

the similar approach in Subsection IV-B can be employed to
approximate the effective capacity. As ∆x, ∆s
0, we get
the exact expression of the effective capacity that is the same
as (19), where ζ is the solution to the following equation
e−θR(X,S)ζX
(cid:16)

Similarly, the effective capacity of the continuous case also
follows same properties as shown in Subsections IV-B1-IV-B3
except for the bounds of the effective capacity in (42) and
(43). Nevertheless, (42) and (43) are applicable to the discrete
renewal service process with non-integer interarrival time,
where K is the maximum interarrival time.

= 1, ζ

(44)

1.

≥

(cid:17)

V. APPLICATIONS TO HARQ SYSTEMS

A. Fixed-Rate HARQ Systems

Since HARQ transmissions can be modelled by the renewal-
reward process [13], the proceeding analysis of the effective
capacity can be used to characterize the cross-layer throughput
of HARQ [8]. To this end, a renewal of HARQ transmissions
is deﬁned as an event that the receiver successfully receives
the message or the maximum number of transmissions is
reached. It is assumed that the number of transmissions for
due to congestion avoidance.
each message is allowed up to
K
In addition, Nt is the number of renewals that occur up until
time t, and Xk is the random time between two consecutive
renewals.

We assume that each delivered packet contains b information
bits, and each one is ﬁrst encoded into a long codeword.
Following the FR-HARQ scheme, the generated codeword is
then partitioned into
subcodewords, and each subcodeword
consists of L symbols. Suppose that each symbol duration is
normalized to unit. More speciﬁcally, Xi is the time interval
demanded in the successful delivery of the i-th message, i.e.,
Xk = kL and k
. The pmf of Xk, i.e., qk is given by
[13]

≤ K

K

Pr(X = kL) , qk

= pk−1 −

pk1(k

=

), k

[1,

],

K

∈

K

(45)

where pk is the outage probability after k HARQ rounds
and the indicator function 1(A) is one whenever A is true
and zero otherwise. By applying capacity-achieving codes,
the outage expressions for three different HARQ schemes are
given respectively by [13]

pk =

Pr (log2 (1 + max (γ1,

k

Pr

log2

1 +

γl

(cid:18)

k

Pr

(cid:18)
log2 (1 + γl)

l=1
P

(cid:19)

≤






, γk))

≤

R

,

(cid:19)
,

R ) , Type I

CC

IR.

(46)

· · ·

≤

R

l=1
P

(cid:18)

(cid:19)
where R = b/L is the transmission rate (normalized reward
per renewal), γl = γT αl represents the signal-to-noise ratio
(SNR) of the l-th transmission, γT and αl correspond to
the transmit SNR and the l-th channel gain, respectively and
p0 = 1 by convention. The outage performance of HARQ
schemes under various fading channels has been extensively

8

investigated. In particular, the outage probabilities of Type I
HARQ and HARQ-CC have been derived in closed-form by
considering general fading channels in [17, eqs. (8), (11)].
Moreover, the outage expression of HARQ-IR has been given
in [18, eq. (17)]. Nonetheless, the speciﬁc expressions are
omitted here due to space limitation.

,

1) Maximum Arrival Rate: In [8], the effective capacity is
used to assess the maximum arrival rate of HARQ schemes. To
do so, by putting (46) into (45) and then combining with (12)
and (13), the effective capacities of the three HARQ schemes
K
k=1 qkζkL = eθb.
can be calculated as Ce = ln ζ/θ, where
By introducing ¯ζ = ζL and ¯θ = Lθ, the effective capacity can
be obtained as

ln ¯ζ
¯θ
k=1 qk ¯ζk = e ¯θR . From (47), the effective capacity of
where
the HARQ scheme is equivalent to that of a new renewal ser-
vice process with the interarrival time ranged from 1 to
and
the constant reward R . Moreover, Ce can be approximated for
small θ by using the Taylor series expansion as illustrated in
Subsection III-B2. With (18), the effective capacity is bounded
as R/K

K−1
k=0 pk and limθ→∞ Ce = R /K.

Ce =

(47)

R /

Ce

P

P

K

K

P

Since both the decoding successes and failures are counted
as rewards, the effective capacity obtained in (47) indicates
the maximum service rate supported by HARQ systems. In
addition, the maximum arrival rate can be used to evaluate the
throughput of the lossless HARQ scheme, which is allowed
to have an inﬁnite number of transmissions, i.e.,
, to
guarantee no decoding failures.

∞

=

K

≤

≤

K

<

∞

i.e.

. To address this issue,

2) Outage Effective Capacity: As pointed out in Subsection
V-A1, the maximum arrival rate does not imply that all the
incoming data will be successfully delivered to the receiver
because of the presence of decoding failures. In particular,
the outage events usually take place for the truncated HARQ
the outage
schemes,
effective capacity is proposed in [9], [10]. Unlike the max-
imum arrival rate studied in Subsection V-A1, the reward of
each renewal is a two-value function for the truncated HARQ
schemes. More speciﬁcally, the reward is b if the message is
successfully decoded and zero otherwise. Therefore, the ana-
lytical results in Section IV can be used herein to evaluate the
outage effective capacity. For truncated HARQ schemes, Xi
and Si represent the number of HARQ transmissions involved
into the delivery of the i-th message, and the termination state
whether the receiver successfully recovers the message or not,
respectively. Hence, the joint pmf qk,s of truncated HARQ
schemes is given by

Pr(X = kL, S = s) = qk,s
k
k =

pk−1 −
pK,

pk,

=

(cid:26)

&s = S
&s = F

≤ K
K

,

(48)

where the notations S and F denote the success and the failure
(X, S)
of the decoding, respectively. The reward function
is explicitly given by

R

(X = kL, S = s) =

R

(cid:26)

k
b,
0, k =

≤ K
K

&s = S
&s = F

.

(49)

6
e

= ln ζ/θ, where ζ satisﬁes

By using (35), the outage effective capacity can be obtained
K
k=1 qk,SebθζkL +
as Cout
qK,FζKL = 1. Similarly, with the same deﬁnitions of ¯ζ = ζL
and ¯θ = Lθ, the outage effective capacity can be rewritten as
Cout

e = ln ¯ζ/¯θ, where ¯ζ satisﬁes

P

the next page, where the explicit deﬁnition of the generalized
Fox’s H function Y m,n
) is omitted here to conserve space
p,q (
·
(see [20]).

The joint pmf of the interarrival time ˆX and the termination

state ˆS, ˆqk,s, is given by

9

K

qk,SeR ¯θ ¯ζk + qK,F ¯ζK = 1, ¯ζ

0.

≥

(50)

k=1
X

e

Accordingly, (50) implies that Cout
is equivalent to the outage
effective capacity of a simpliﬁed HARQ service process with
the interarrival time ranged from 1 to
the QoS expo-
nent ¯θ and the constant reward R . This result is consistent
with [9]. By using (41), the outage effective capacity can
be approximated for small θ. Moreover, from (42), since
(X, S), the outage effective
(
K
capacity is bounded as

L, F) = arg(κ,j) minqκ,j >0 R

K

,

min

0

Cout

e ≤

≤
where the LTAT E (
E (

ln qK,F
¯θ

−

E (

,

(X, S))

R
E (X)

K

(cid:26)
(X, S))/E (X) is given by [19]
R
(X, S))

R (1

(cid:27)

R
E (X)

=

pK)
−
K−1
k=0 pk

.

,

(51)

As expected, the outage effective capacity is less than or equal
to the LTAT due to the constraint of the limited buffer length.
In addition, (43) indicates that

P

lim
θ→∞

Cout

e = 0.

(53)

This is different from the maximal arrival rate because erro-
neously received messages are counted as null rewards. As
θ increases, the buffer overﬂow probability becomes much
more stringent, which consequently leads to the continuous
declination of the outage effective capacity.

B. Variable-Rate HARQ-IR Systems

Unlike the conventional FR-HARQ schemes, the transmis-
sion rate of the HARQ-IR scheme could be changeable from
one transmission to another. More speciﬁcally, we assume
that the length of the k-th subcodeword is Lk. By applying
capacity achieving channel coding, an outage event happens
when the accumulated mutual information is below b. The
outage probability after k HARQ rounds is thus written as
[11]

k

ˆpk = Pr

1
Rl

log2 (1 + γl) < 1

,

(54)

!

∈

K

[1,

l=1
X
where Rk = b/Lk for k
]. From (54), the outage
probability of VR-HARQ scheme can be derived in closed-
form if the fading channels are independently Nakagami-
m distributed among different HARQ rounds. The channel
, αK are independent Gamma random variables
gains α1,
under the circumstance, and we assume αl
(ml, Ωl/ml),
where ml and Ωl stand for the fading order and average
channel power gain, respectively. As proved in Appendix G,
by using Mellin transform, ˆpk can be derived in terms of the
generalized Fox’s H function as (55), shown at the top of

∼ G

· · ·

Pr

ˆX =

(cid:18)

=

k

l=1

Ll, ˆS = s

= ˆqk,s

X

(cid:26)

ˆpk,

ˆpk−1 −
ˆpK,

(cid:19)
k
k =

≤ K
K

&s = S
&s = F

Moreover,
expressed as

the corresponding reward function

.

(56)

( ˆX, ˆS) is

R

( ˆX =

k

Ll, ˆS = s) =

b,
k
0, k =

≤ K
K

&s = S
&s = F

.

(57)

(cid:26)

l=1

X

R
Therefore, the effective capacity is obtained as Cout

e =
l=1 Ll +
ln ζ/θ, where ζ
l=1 Ll = 1. By deﬁning ˆθ = bθ and ˆζ = ζb, the
ˆqK,FζP
effective capacity can be rewritten as Ce = ln ˆζ/ˆθ, where
ˆζ satisﬁes

k=1 ˆqk,SebθζPk

is given by

P

K

K

(52)

K

k
P
l=1

ˆθ ˆζ

−1

Rl

ˆqk,Se

K
P
l=1

+ ˆqK,F ˆζ

−1

Rl

= 1.

(58)

k=1
X

With (41), the effective capacity can be approximated. In
analogous to (51), the effective capacity is bounded as

Ce

0

≤

≤

min

−

ˆθ




ln ˆqK,F
K
l=1 Rl

,

−1

E

(cid:16)

( ˆX, ˆS)
(cid:17)

ˆX

R
E

,

(59)




where the LTAT E



P
( ˆX, ˆS)
(cid:17)

R
(cid:16)
( ˆX, ˆS)

=

(cid:17)

ˆX

/E

ˆX
(cid:16)
1
K−1

E

(cid:16)

R
E

(cid:16)

(cid:17)

is given by [11]



(cid:17)

ˆpK

−
Rk+1

−1 ˆpk

.

(60)

k=0
P
Furthermore, the result limθ→∞ Cout
be obtained.

(cid:17)

(cid:16)

e = 0 similar to (53) can

C. Cross-Packet HARQ Systems

In the retransmissions of both the FR- and VR-HARQ
schemes, the retransmitted subcodewords do not involve new
information bits. Particularly for FR-HARQ, the provisioning
of the throughput close to ergodic capacity is prevented from
exploiting the possible redundant mutual information. Instead,
the XP-HARQ scheme was devised to avoid the waste of
mutual information to substantially improve the throughput
[12]. More speciﬁcally, the XP-HARQ scheme introduces new
information bits in retransmissions besides the redundancy
bits. We assume the number of the new introduced information
bits in the k-th HARQ round is bk, and the number of the
information bits in the initial transmission is b1. During the
k-th HARQ round, the currently introduced information bits
is ﬁrst concatenated with all the previously introduced ones to
construct a long message. The resultant message thus contains
k
l=1 bl information bits, and is then encoded into the k-th
codeword of length L symbols. According to the decoding
P

 
ˆpk = Y k,1

1,k+1

1, 1
R1

, m1
γT Ω1

, m1

,

"

(cid:16)

(cid:17)

(1, 1, 0, 1)
1, 1
Rk

,

, mk
γT Ωk

· · ·

(cid:16)

k

2

l=1 (cid:18)
Y

ml
γT Ωl (cid:19)

1
Rl

,

#

, mk

, (0, 1, 0, 1) (cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

(cid:17)

10

(55)

conditions of XP-HARQ studied in [12], the outage event takes
place after k HARQ rounds if and only if the accumulated
mutual information is below the number of the delivered
information bits in the current and previous HARQ rounds.
Therefore, the outage probability of the XP-HARQ scheme
can be obtained as [12]

k

κ

κ

˘pk = Pr

(

κ=1  
[

l=1
X

Llog2 (1 + γl) <

bl

l=1
X

!)











= Pr

k

κ



log2 (1 + γl)

<

κ



˘Rl

,

(61)

Iκ

l=1
X

l=1
X

κ=1
[












where ˘Rl = bl/L and
|
{z
) represents the union of events.
Unfortunately, due to the presence of the correlation among
S
K,
the accumulated mutual informations per symbol
it is intractable to derive an exact expression for (61) and there
is still no readily available result in the literature. In this paper,
˘pk is computed by conducting Monte Carlo simulations.

I1,

· · ·

(
·

I

}

,

In order to obtain the effective capacity of the XP-HARQ
scheme, the pmf of the interarrival time ˘X and the termination
state ˘S, ˘qk,s, is derived as

Pr

(cid:16)

˘X = kL, ˘S = s
(cid:17)
˘pk,
˘pk−1 −
˘pK,

=

= ˘qk,s

(cid:26)

k
k =

≤ K
K

&s = S
&s = F

.

(62)

And the reward function

( ˘X = kL, ˘S = s) =

R

R

( ˘X, ˘S) is given by

k
l=1 bl,
0,

k
k =

≤ K
K

&s = S
&s = F

(cid:26) P

. (63)

K

Accordingly, the effective capacity of XP-HARQ is cal-
= ln ζ/θ, where ζ is determined by
e
l=1 bl ζkL + ˘qK,FζkL = 1. By deﬁning ˘θ = Lθ

culated as Cout
k=1 ˘qk,Seθ Pk

and ˘ζ = ζL, we have Ce = ln ˘ζ/˘θ, where ˘θ is given by
P

K

˘θ

k
P
l=1

˘qk,Se

˘Rl ˘ζk + ˘qK,F ˘ζk = 1.

(64)

k=1
X

With (41),
analogous to (51), the effective capacity is bounded as

the effective capacity can be approximated. In

Ce

0

≤

≤

min

ln ˘qK,F
˘θ

K

,

−




E

(cid:16)

R
E

( ˘X, ˘S)

where the LTAT of XP-HARQ, E
given by [12]



˘X

,

(cid:17)




(65)

(cid:16)
(cid:17)
( ˘X, ˘S)
(cid:17)

R

/E


,

is

˘X
(cid:16)

(cid:17)

˘pK)

.

(66)

(cid:16)
˘Rk (˘pk−1 −
K−1
k=0 ˘pk

E

( ˘X, ˘S)
(cid:17)

˘X

R
E

(cid:16)

K
k=1

=

P

(cid:16)

(cid:17)

P

Furthermore, the similar result to (53) can be demonstrated,
i.e., limθ→∞ Ce = 0.

Finally, the calculations of the effective capacity for various

HARQ schemes are brieﬂy summarized in Table I.

VI. VERIFICATIONS AND DISCUSSIONS

In this section, numerical examples are presented for veriﬁ-
cations and discussions. Unless otherwise speciﬁed, we set
γT = 20dB, R = 4bps/Hz,
= 5 and b = 1080bits
[21]. In addition, we assume that all HARQ links experience
independent Rayleigh fading with unit average power, i.e.,
E(αl) = Ωl = 1 and ml = 1 for l

[1,

K

].

∈

K

A. FR-HARQ Scheme

To start with, the maximum arrival rate against the QoS
exponent θ for the three conventional FR-HARQ schemes is
depicted in Fig. 2, and the approximate results obtained in [8]
are provided for comparison. It is observed that Ce decreases
with θ, which is consistent with our analysis. This is because
that higher θ represents stricter queuing constraints imposed
on buffer overﬂow probability, which limits the increase of
service arrival rate, and consequently results in the decrease
of the capacity. As shown in Fig. 2, the gap between the
approximate and the exact results grows with θ, which justiﬁes
the signiﬁcance of the exact analysis, especially, for large θ.
As θ approaches to inﬁnity, the maximum arrival rate tends
to a lower bound that is given by (18), i.e., limθ→∞ Ce =
R/K = 0.8bps/Hz. Moreover, Fig. 2 further substantiates that
HARQ-IR is superior to other HARQ schemes in terms of the
maximum arrival rate.

In Fig. 3, the outage effective capacity Ce is plotted versus
the QoS exponent. It can be seen that the tendency of Ce for
the three conventional HARQ schemes is the same as Fig. 2,
and their approximations given by (41) are also shown for
comparison. It is readily found that the approximate results
coincide with the exact ones under small QoS exponent.
Unlike the maximum arrival rate in Fig. 2, the outage effec-
tive capacity approaches to zero as θ tends to inﬁnity. This
difference is due to the fact that the amount of unsuccessfully
delivered data is not counted as reward while computing the
outage effective capacity. The smaller θ means the stricter
QoS constraint, which needs smaller arrival rate µ to ensure
a tighter constraint on buffer overﬂow probability.

Fig. 4 illustrates the impact of the transmit SNR γT on the
effective capacity, and also shows the comparison between the
maximum arrival rate and the outage effective capacity. It is
not out of expectation that both the maximum arrival rate and
the effective capacity increase with γT . Nonetheless, both of
them are found to be bounded no matter how high γT is,
because the bounds of the maximum arrival rate given in (18)
R /E(X) < R = 4bps/Hz.
manifest that 0.8bps/Hz
Whereas, the bounds of the outage effective capacity given by

Ce

≤

≤

TABLE I: The effective capacity for various HARQ schemes.

HARQ

Metrics

Ce

θ

FR-HARQ-Maximum
Arrival Rate

FR-HARQ-Outage
Effective Capacity

Ce = ln ¯ζ/¯θ

¯θ = Lθ

VR-HARQ

Ce = ln ˆζ/ˆθ

ˆθ = bθ

XP-HARQ

Ce = ln ˘ζ/˘θ

˘θ = Lθ

ζ

K

k=1
P
K

k=1
P
K

k=1
P
K

k=1
P

qk ¯ζk = e ¯θR

qk,SeR ¯θ ¯ζk + qK,F ¯ζK = 1

k
P
l=1

ˆqk,Se ˆθ ˆζ

−1

Rl

K
P
l=1

+ ˆqK,F ˆζ

−1

Rl

= 1

˘θ

k
P
l=1

˘qk,Se

˘Rl ˘ζk + ˘qK,F ˘ζk = 1

]
z
H
/
s
p
b
[

C

e
t
a
r

l
a
v
i
r
r
a
m
u
m
i
x
a
M

3.5

3.0

e

2.5

2.0

1.5

1.0

0.5

0.0

 Type I-Exact

 Maximum arrival rate

 Type I-App.[8]

 Outage effective capacity

 CC-Exact

 CC-App.[8]

 IR-Exact

 IR-App.[8]

]
z
H
/
s
p
b
[

C

e

11

E(R(X,S))
E(X)

R
K−1
P
k=0

pk

R (1−pK)

K−1
P
k=0

pk

1− ˆpK

Rk+1

−1 ˆpk

˘Rk(˘pk−1− ˘pK)

K−1
P
k=0
K
P
k=1

K−1
P
k=0

˘pk

Type I HARQ

-4

-3

-2

-1

0

10

10

10

10

10

Fig. 2: The maximum arrival rate versus the QoS exponent for
FR-HARQ schemes.

Fig. 4: The comparison between the maximum arrival rate and
the outage effective capacity with parameter θ = 10−3.

QoS exponent  

Transmit SNR 

[

d

]

]
z
H
/
s
p
b
[

C

y
t
i
c
a
p
a
c

e
v
i
t
c
e
f
f
e

e
g
a
t
u
O

3.5

3.0

e

2.5

2.0

1.5

1.0

0.5

0.0

 Type I-Exact

 Type I-App.-eq.(41)

 CC-Exact

 CC-App.-eq.(41)

 IR-Exact

 IR-App.-eq.(41)

]
z
H
/
s
p
b
[

C

y
t
i
c
a
p
a
c

e
v
i
t
c
e
f
f
E

3.5

3.0

2.5

e

2.0

1.5

1.0

0.5

0.0

=[4,3,3,2,2],

dB

=[2,2,3,3,4],

dB

=[4,3,3,2,2],

dB

 Exact

 App.-eq.(41)

-4

-3

-2

-1

0

-4

-3

-2

-1

0

10

10

10

10

10

10

10

10

10

10

Fig. 3: The outage effective capacity versus the QoS exponent
for FR-HARQ schemes.

Fig. 5: The effective capacity versus the QoS exponent for the
VR-HARQ schemes.

QoS exponent  

QoS exponent  

(42) show that 0bps/Hz
4bps/Hz.

≤

Ce

≤

R (1

−

pK)/E(X) < R =

B. VR-HARQ Scheme

Fig. 5 shows the effective capacity of the VR-HARQ
schemes against the effect of the QoS exponent, and the
notation r herein is deﬁned as r = [R1,
is
observed in Fig. 5 that the exact results perfectly agree with
the approximate ones for small θ. Similarly to Fig. 3, the
effective capacity decreases to zero as θ increases to inﬁnity
in Fig. 5. Unsurprisingly, the increase of the transmit SNR
improves the effective capacity. For example, for ﬁxed values

, RK]. It

· · ·

of r = [4, 3, 3, 2, 2]bps/Hz and θ = 10−4, the effective capac-
ity increases by 1.5bps/Hz if the transmit SNR is increased
from 10dB to 20dB. Furthermore, it is seen from this ﬁgure
that the rate selection has a signiﬁcant impact on the effective
capacity.

C. XP-HARQ Scheme

The effective capacity for XP-HARQ scheme is plotted
against the QoS exponent in Fig. 6, wherein ˘r = [ ˘R1,
, ˘RK].
It can be observed that there is a perfect agreement between
the exact results and the approximate ones under a small θ.
Similarly, the effective capacity of the XP-HARQ scheme is

· · ·

 
 
 
 
 
 
 
 
]
z
H
/
s
p
b
[

C
y
t
i
c
a
p
a
c

e
v
i
t
c
e
f
f
E

4.0

3.5

3.0

e

2.5

2.0

1.5

1.0

0.5

0.0

=[4,1,1,1,1],

dB

=[3,1,1,1,1],

dB

=[4,1,1,1,1],

dB

 Exact

 App.-eq.(41)

-5

-4

-3

-2

-1

0

10

10

10

10

10

10

Fig. 6: The effective capacity versus the QoS exponent for the
XP-HARQ scheme.

QoS exponent 

-3

-5

 FR-HARQ-IR- =10

 VR-HARQ- =10

-3

 XP-HARQ- =10

-3

 FR-HARQ-IR- =10

 VR-HARQ- =10

-5

 XP-HARQ- =10

-5

]
z
H
/
s
p
b
[

C

y
t
i
c
a
p
a
c

e
v
i
t
c
e
f
f
e

l
a
m

i
t
p
O

4.5

4.0

e

3.5

3.0

2.5

2.0

1.5

1.0

0.5

5

10

15

20

Transmit SNR 

[

d

]

Fig. 7: Optimal effective capacities of different HARQ-IR
= 2.
schemes with parameter

K

a decreasing function of the QoS exponent as well as the
transmit SNR. In addition, it is seen from Fig. 6 that the
transmission rates of the XP-HARQ considerably inﬂuences
the effective capacity.

Note that the selection of transmission rates has a critical
impact on the effective capacity, the effective capacity can be
maximized via optimizing transmission rates of the HARQ-IR
scheme. To compare the three different HARQ-IR schemes,
including FR-HARQ-IR, VR-HARQ and XP-HARQ, Fig. 7
exhibits their optimal effective capacities versus the transmit
SNR. Nevertheless, the optimal design of transmission rates
for HARQ schemes is out of the scope of this paper due
to the non-convexity of the objective function. Similarly to
[12], we conduct an exhaustive search over the space of
following available transmission rates: FR-HARQ-IR and VR-
HARQ adopt R , Rk
bps/Hz, while
1.5, 1.75, 2,
∈ {
XP-HARQ adopts ˘R1 ∈ {
bps/Hz for
the initial round and ˘Rk
bps/Hz for
∈ {
the others. Fig. 7 reveals that VR-HARQ and XP-HARQ
can achieve almost the same optimal effective capacity, while
FR-HARQ performs the worst. This is because that VR-
HARQ turns to the variable-length coding to fully exploit
the statistical information of fading channels. Whereas, XP-
HARQ attempts to incorporate new information bits into
retransmission to make the utmost of the possible redundant
mutual information.

· · ·
1.5, 1.75, 2,
0, 0.25, 0.5,

}
, 3.75
}
, 3.75
}

· · ·
· · ·

, 3.75

VII. CONCLUSIONS

This paper has derived a uniﬁed exact formula for the
effective capacity of the renewal network service process at

12

a given QoS exponent, with which the cross-layer throughput
for various HARQ systems has been accurately evaluated,
including FR-HARQ (e.g., Type I HARQ, HARQ-CC and
HARQ-IR), VR-HARQ and XP-HARQ. The formula not only
has gained many insightful results, but also has paved the way
for the exact cross-layer design by integrating the channel
model of physical-layer to QoS requirements of link-layer.
Speciﬁcally, the effective capacity has been found to decrease
with QoS exponent as well as be bounded. Furthermore, if
the transmission rates are optimally chosen to maximize the
effective capacity, it has been shown that VR-HARQ and XP-
HARQ achieve almost the same performance, and both of
them surpass FR-HARQ.

APPENDIX A
PROOF OF THEOREM 1
By using residue theorem, the inverse Z-transform of ψ(z)

can be expressed as

−1

Z

ψ (z)
}
{

(t) =

K

i=1
X

K

=

zt−1φ (z)
K

(z

Res 

k=1

Q
t−1φ (zi)
zi
K

−

zk)

,

, z = zi



(67)

i=1
X

(zi

zj)

−

j=1,j6=i
Q
where the notation of Res(f (x), u) stands for the residue
of f (x) at pole x = u. Identifying (67) with the Laplace
expansion of Vandermonde determinant yields

(t)

ψ (z)
}
1)K+izi

(
−

−1

Z

{
K

=

i=1
P

t−1φ (zi)

K

K

zi

=

i=1
P

1≤m<n≤K
Q
t−1φ (zi)Fi,K

det Z

=

det F
det Z ,

K

1≤m6=i<n6=i≤K
Q
zm)

(zn

−

(zn

−

zm)

(68)

where Fi,j represents the cofactor of the (i, j)-th entry of F.

APPENDIX B
PROOF OF THEOREM 2

To complete the proof of Theorem 2, it will sufﬁce to show
that the ﬁrst derivative of η(x) = f (x)/x is larger than or
equal to zero. The ﬁrst derivative of η(x) w.r.t. x is

η′(x) =

1
x

f ′ (x)

f (x)
x

−

(cid:18)

.

(69)

By repeatedly using mean value theorem, it follows that

η′(x) =

1
x
= (1

(f ′ (x)

f ′(α1x))
α1) f ′′ (α1x + α2 (1

−

−

α1) x) .

(70)

where α1, α2 ∈
by f ′′(x). The monotonicity of η(x) is thus proved.

(0, 1). Clearly, the sign of η′(x) is determined

(cid:19)

−

 
 
 
 
 
APPENDIX C
BOUNDS OF Ce
Thanks to the monotonic decreasing function of Ce, Ce
is bounded as limθ→∞ u(θ)/θ
limθ→0 u(θ)/θ.
Clearly, the corresponding upper bound is limθ→0 u(θ)/θ =
u′(0) = R/E(X). With regard to the lower bound, (15)
qKeKθCe. Accordingly, we have
indicates eKθCe
ln qK/(Kθ). As θ approaches to inﬁn-
R/K
ity, using squeeze theorem yields limθ→∞ u(θ)/θ = R/K if
qK > 0. The bounds of the effective capacity are consequently
simpliﬁed into (18).

≥
R/K

eθR

Ce

Ce

≤

≥

≤

≤

≤

−

APPENDIX D
PROOF OF (20)

Since E

ζX

can be approximated as

E

ζX

≈

k=0
X

(cid:0)

(cid:1)

(cid:0)

K

(cid:1)

K

qkζk∆x =

qk

ζ−∆x

−k

=

˜Xi

X

(z) , (71)

1
2πi

k=0
X

(cid:0)

(cid:1)

→

where z = ζ−∆x and the approximation becomes an equality
as ∆
0, the effective capacity of a renewal process by taking
˜Xi as the i-th interarrival time can be used to approximate Ce.
Speciﬁcally, Ce can be approximately obtained by using the
same approach in Section III-B as

Ce

≈ −

lim
t→∞

e−θRNt/∆x

ln E

1
θt
t
∆x + K
(cid:8)
θt
(cid:1)

= lim
t→∞
K
k=0 qkz−k = eθR, i.e.,
where
˜Xi
relationship between ζ and z, we have

X

(cid:0)

P

ln z−1

(cid:9)

,

(72)

(z) = eθR. Due to the

Ce = lim
t→∞

where E

ζX

= eθR.

(cid:0)

(cid:1)

ln ζ∆x

t
∆x + K
θ1t
(cid:1)

(cid:0)

=

ln ζ
θ

,

(73)

APPENDIX E
PROOF OF (34)

The solution to the homogeneous difference equation (33)
can be solved by employing Z-transform. To this end, it is
indispensable to know the initial conditions of the difference
equation, and the initial conditions of the K-th order linear
difference equation are ϕ(0),
1). In order to apply
· · ·
Z-transform, we deﬁne a new sequence ϕK (t) by shifting the
sequence ϕ (t) to the left by K such that ϕK (t) = ϕ (t + K),
where t
0. Hence, (33) can be rewritten in terms of ϕK (t)
as

, ϕ(K

≥

−

K

aκϕK (t

κ) = 0, t

0,

≥

−

(74)

where ϕK (
1]. Applying
the translation property of Z-transform [22, eq.12.4.1] to the
both sides of (74) gives

k) and k

[0, K

−

−

−

∈

ϕK (t)

−

κ=1
X
k) = ϕ(K

13

where
Accordingly,

Z {

ϕK (t)
}
ϕK (t)
}

Z {

(z) stands for the Z-transform of ϕK (t).

(z) is simpliﬁed as

ϕK (t)
}

Z {

(z) =

K

κ=1
P

aκz−κ

κ

l=1
P
K

ϕ (K

l) zl

−

aκz−κ

.

(76)

By applying the inverse Z-transform to (76), we have

ϕK (t) =

Ic Z {
Thus, ϕ(t) can be obtained as

1
2πi

ϕ (t) =

ϕK (t)

}

(z) zt−1dz.

(77)

1

−

κ=1
P

K

κ

aκϕ (K

l) zt+l−κ−1

−

κ=1
P

l=1
P

zK

Ic

−

K

aκzK−κ

κ=1
P

dz, t

K.

≥

(78)

K

κ=1 aκzK−κ =

With the deﬁnition of ˜z1,
K
κ=1(z

−
˜zκ). By putting the latter into
(78) and using Theorem 1, (78) can be further rewritten as
P
(79).

it follows that zK

· · ·
−

, ˜zK,

Q

APPENDIX F
PROOF OF THE PROPERTIES OF EFFECTIVE CAPACITY

A. Decreasing Monotonicity of Ce w.r.t. θ

By deﬁning ℓt (θ) =

ln E
/t, the effective ca-
pacity can be expressed as Ce = limt→∞ ℓt (θ)/θ. More
speciﬁcally, ℓt (0) = 0 and the second derivative of ℓt (θ)
w.r.t. θ is less than or equal to zero because

e−θSt

−

(cid:8)

(cid:9)

E

St

2e−θSt

(cid:8)

−

0,

(cid:9)

ℓ′′
t (θ) =

≤

E

E
(E
(cid:8)

e−θSt

−
)2t
(cid:0)

e−θSt
(cid:9)
}

{

Ste−θSt

2

(cid:8)

(cid:9)(cid:1)

(80)

where the last step holds by using Cauchy-Schwarz inequality.
0. By
Hence, we get limt→∞ ℓt (0) = 0 and limt→∞ ℓt
using Theorem 2, the decreasing monotonicity of Ce w.r.t. θ
is thus proved.

′′ (θ)

≥

B. Bounds of the Effective Capacity

Owing to the decreasing monotonicity of the effective

capacity, the effective capacity is upper bounded as Ce
lim
θ→0

Ce, where the upper bound is given by

≤

lim
θ→0

Ce = lim
θ→0

˜u(θ)
θ

= ˜u′(0) =

E (

(X, S))

R
E (X)

.

(81)

On the other hand, we ﬁrst deﬁne the lowest reward as Rˆκ,ˆj,
where (ˆκ, ˆj) = arg(κ,j) minqκ,j >0 Rκ,j. Hence, the effective
capacity satisﬁes

(z)

−

Z {
K

ϕK (t)
}
aκz−κ

κ=1
X

ϕK (t)
}

(z) +

 Z {

−1

l=−κ
X

ϕK (l) z−l

!

= 0,

(75)

K

vκ

κ=1
X

j=1
X

qκ,je−θ(Rκ,j −Rˆκ,ˆj)eκθCe = eθRˆκ,ˆj .

(82)

14

(79)

s−1
Rl dx

ml
γT Ωl (cid:19)

.

(89)

˜zj−1
i

det

"

(cid:16)

i,1≤j≤K−1

(cid:17)

ϕ (t) =

K

κ

,

aκϕ (K

(cid:18)

κ=1
l=1
P
P
det ˜A

l) ˜zt+l−κ−1

i

−

(cid:19)i,K#

det

˜zj−1
i
(cid:16)

(cid:17)

z




l)

−

K

=

ϕ (K

l=1
X

˜Bl

K

,

}|

κ=l
X

det ˜A

i,1≤j≤K−1

aκ ˜zt+l−κ−1

i

!i,K

{




.

From (82), it follows that

By substituting (88) into (87) yields

K

vκ

qˆκ,ˆjeˆκθCe

≤

j=1
X
Thus Ce is bounded as

κ=1
X

qκ,je−θ(Rκ,j −Rˆκ,ˆj)eκθCe

eKθCe.

≤

fGk }

{M

(s) =

k

ml

ml
γT Ωl (cid:19)
e− ml

γT Ωl

1
Γ (ml)

×

l=1 (cid:18)
Y
∞

0
Z
ml

xxml−1(1 + x)

k

=

l=1 (cid:18)
Y

ml
γT Ωl (cid:19)

Ψ

ml,

(cid:18)

1

s

−
Rl

+ ml + 1;

(83)

(84)

Rˆκ,ˆj
K ≤

Ce

Rˆκ,ˆj

≤

ˆκ −

ln qˆκ,ˆj
ˆκθ

.

Combining (81) and (84) leads to (42). Consequently, we
complete the proof.

Plugging the latter into (86) and then applying inverse Mellin
transform, FGk (x) can be expressed as

APPENDIX G
PROOF OF (55)

=

From (54), ˆpk can be rewritten as

ˆpk = Pr 

k

l=1

(1 + γl)

1
Rl

< 2

= FGk (2) ,

(85)

Y

Gk





|





where FGk (x) refers to the CDF of Gk. By using the Mellin
transform, the Mellin transform w.r.t. FGk (x) can be obtained
by using [22, eq.8.3.15] as

{z

}

FGk }

{M

(s) =

1
s {M

−

fGk }

(s + 1) ,

(86)

where fGk(x) denotes the PDF of Gk. The Mellin transform
w.r.t. fGk (x) can be expressed as

fGk }

{M

(s) = E

s−1

Gk

(cid:8)
k

(cid:9)

∞

k

(a)
=

E

(1 + γl)

s−1
Rl

n

l=1
Y
s−1
Rl fγl (x) dx.

(1 + x)

o

(87)

=

0
l=1 Z
Y

where step (a) holds because of the independence among
fading channels. Note γl = γT αl and αl
(ml, Ωl/ml),
the PDF of γl is given by

∼ G

fγl (x) =

(cid:18)

ml xml−1e− ml
Γ (ml)

γT Ωl

ml
γT Ωl (cid:19)

x

.

(88)

(s) x−sds

FGk }

Z

˜C {M
ml

FGk (x) =

1
2πi

k

−

ml
γT Ωl (cid:19)
l=1 (cid:18)
Y
1
1
s
2πi

Ψ

k

˜C

×

s
Rl

ml
γT Ωl (cid:19)

ml,

+ ml + 1;

x−sds,

(90)

(cid:18)

l=1
Y

Z
where ˜
is a Mellin-Barnes contour path. By using [18, eq.55],
C
FGk (x) can thus be expressed in terms of the generalized
Fox’s H function [20] as (91), shown at the top of the next
page. By putting (91) into (84), ˆpk is consequently obtained
as (55).

REFERENCES

[1] P. Popovski, “Ultra-reliable communication in 5G wireless systems,”
in Proc. International Conference on 5G for Ubiquitous Connectivity
(5GU), Sep. 2014, pp. 146–151.

[2] D. Wu and R. Negi, “Effective capacity: a wireless link model for
support of quality of service,” IEEE Trans. Wireless Commun., vol. 2,
no. 4, pp. 630–643, Jul. 2003.

[3] D. To, H. X. Nguyen, Q.-T. Vien, and L.-K. Huang, “Power allocation
for HARQ-IR systems under QoS constraints and limited feedback,”
IEEE Trans. Wireless Commun., vol. 14, no. 3, pp. 1581–1594, Mar.
2015.

[4] K. T. Phan, T. Le-Ngoc, and L. B. Le, “Optimal resource allocation
for buffer-aided relaying with statistical QoS constraint,” IEEE Trans.
Commun., vol. 64, no. 3, pp. 959–972, Mar. 2016.

[5] T. Abr˜ao, S. Yang, L. D. H. Sampaio, P. J. E. Jeszensky, and L. Hanzo,
“Achieving maximum effective capacity in OFDMA networks operating
under statistical delay guarantee,” IEEE Access, vol. 5, pp. 14 333–
14 346, Aug. 2017.

[6] Y. Hu, M. Ozmen, M. C. Gursoy, and A. Schmeink, “Optimal power
allocation for QoS-constrained downlink multi-user networks in the
ﬁnite blocklength regime,” IEEE Trans. Wireless Commun., vol. 17,
no. 9, pp. 5827–5840, Sep. 2018.

[7] J. Choi, “On large deviations of HARQ with incremental redundancy
over fading channels,” IEEE Commun. Lett., vol. 16, no. 6, pp. 913–
916, Jun. 2012.

 
FGk (x) = Y k,1

1,k+1

1, 1
R1

, m1
γT Ω1

, m1

,

(cid:17)

"

(cid:16)

(1, 1, 0, 1)
1, 1
Rk

,

, mk
γT Ωk

· · ·

(cid:16)

k

x

l=1 (cid:18)
Y

ml
γT Ωl (cid:19)

1
Rl

,

#

, mk

, (0, 1, 0, 1) (cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

(cid:17)

15

(91)

[8] Y. Li, M. C. Gursoy, and S. Velipasalar, “On the throughput of hybrid-
ARQ under statistical queuing constraints.” IEEE Trans. Veh. Technol.,
vol. 64, no. 6, pp. 2725–2732, Jul. 2015.

[9] P. Larsson, J. Gross, H. Al-Zubaidy, L. K. Rasmussen, and M. Skoglund,
“Effective capacity of retransmission schemes: a recurrence relation
approach,” IEEE Trans. Commun., vol. 64, no. 11, pp. 4817–4835, Nov.
2016.

[10] D. Qiao, “Outage effective capacity of buffer-aided diamond relay

systems using HARQ-IR,” IEEE Trans. Veh. Technol., pp. 1–1, 2018.

[11] L. Szczecinski, S. R. Khosravirad, P. Duhamel, and M. Rahman, “Rate
allocation and adaptation for incremental redundancy truncated HARQ,”
IEEE Trans. Commun., vol. 61, no. 6, pp. 2580–2590, Jun. 2013.
[12] M. Jabi, A. Benyouss, M. Le Treust, E. Pierre-Doray, and L. Szczecinski,
“Adaptive cross-packet HARQ,” IEEE Trans. Commun., vol. 65, no. 5,
pp. 2022–2035, May 2017.

[13] G. Caire and D. Tuninetti, “The throughput of hybrid-ARQ protocols
for the Gaussian collision channel,” IEEE Trans. Inf. Theory, vol. 47,
no. 5, pp. 1971–1988, Jul. 2001.

[14] C.-S. Chang and J. A. Thomas, “Effective bandwidth in high-speed
digital networks,” IEEE J. Sel. Areas Commun., vol. 13, no. 6, pp. 1091–
1100, Aug. 1995.

[15] S. M. Ross, Introduction to probability models. Academic press, 2014.
[16] F. W. Olver, NIST handbook of mathematical functions. Cambridge

University Press, 2010.

[17] Z. Shi, S. Ma, F. Hou, K.-W. Tam, and Y.-C. Wu, “Optimal power
allocation for HARQ schemes over time-correlated Nakagami-m fading
channels,” in Proc. IEEE Int. Conf. on Commun. Syst. (ICCS), Jan. 2016,
pp. 1–6.

[18] Z. Shi, S. Ma, G. Yang, K. W. Tam, and M. Xia, “Asymptotic outage
analysis of HARQ-IR over time-correlated Nakagami-m fading chan-
nels,” IEEE Trans. Wireless Commun., vol. 16, no. 9, pp. 6119–6134,
Sep. 2017.

[19] A. Chelli, E. Zedini, M.-S. Alouini, J. Barry, and M. Patzold, “Perfor-
mance and delay analysis of hybrid ARQ with incremental redundancy
over double Rayleigh fading channels,” IEEE Trans. Wireless Commun.,
vol. 13, no. 11, pp. 6245–6258, Nov. 2014.

[20] F. Yilmaz and M.-S. Alouini, “Outage capacity of multicarrier sys-
tems,” in Proc. IEEE International Conference on Telecommunications
(ICT’10), Apr. 2010, pp. 260–265.

[21] Q. Liu, S. Zhou, and G. B. Giannakis, “Cross-layer combining of
adaptive modulation and coding with truncated ARQ over wireless
links,” IEEE Trans. Wireless Commun., vol. 3, no. 5, pp. 1746–1755,
Sep. 2004.

[22] L. Debnath and D. Bhatta, Integral transforms and their applications.

CRC press, 2010.

