Optimal-time Quadcopter Descent Trajectories
Avoiding the Vortex Ring and Autorotation States

Amin Talaeizadeha, Duarte Antunesb,∗, Hossein Nejat Pishkenaria,∗ and Aria Alastya

1

9
1
0
2

p
e
S
9
1

]
S
D
.
h
t
a
m

[

1
v
9
6
0
9
0
.
9
0
9
1
:
v
i
X
r
a

Abstract—It is well-known that helicopters descending fast
may enter the so-called Vortex Ring State (VRS), a region
in the velocity space where the blades lift differs signiﬁcantly
from regular regions. This may lead to instability and therefore
this region is avoided, typically by increasing the horizontal
speed. This paper researches this phenomenon in the context of
small-scale quadcopters. The region corresponding to the VRS
is identiﬁed by combining ﬁrst-principles modeling and wind-
tunnel experiments. Moreover, we propose that the so called
Windmill-Brake State (WBS) or autorotation region should also
be avoided for quadcopters, which is not necessarily the case
for helicopters. A model is proposed for the velocity constraints
that the quadcopter must meet to avoid these regions. Then,
the problem of designing optimal time descend trajectories that
avoid the VRS and WBS regions is tackled. Finally, the optimal
trajectories are implemented on a quadcopter. The ﬂight tests
show that by following the designed trajectories, the quadcopter
is able to descend considerably faster than purely vertical
trajectories that also avoid the VRS and WBS.

Index Terms—Vortex ring state, Quadcopter, Windmill brake
state, Optimal trajectory design, Vortex ring avoidance trajectory,
Quadcopter fast descent.

I. INTRODUCTION

Q UADCOPTERS have been introduced in recent years

and are expected to have a large impact on many
applications, such as agriculture monitoring, industrial inspec-
tion, entertainment industry, among others [1]. One of the
interesting features of these aerial robots is that they are able
to perform aggressive maneuvers due to their agility. In order
to safely conduct these aggressive maneuvers, it is important
to model and understand the dynamic behavior at high speeds,
where non-trivial aerodynamic effects come into play.

Such aerodynamic effects have been extensively studied
in the context of helicopters, where one can ﬁnd several
seminal papers [2]–[7]. As explained in these papers, there are
three regions in the velocity space called Vortex Ring State
(VRS), Windmill-Brake State (WBS) and Turbulence Wake
State (TWS) in which the behavior of the helicopter and the
effect of the environment is different from regular regions.
The VRS and TWS regions must be avoided, but it is still
possible, although undesired, to control the helicopter in the
WBS region. However, these effects have received only limited

a Mechanical Engineering Department, Sharif University of Technology,

Tehran, I.R.Iran

b Control Systems Technology Group, Department of Mechanical En-
gineering, Eindhoven University of Technology, 5600MB Eindhoven, The
Netherlands
Email

(A. Talaeizadeh),
(D. Antunes), nejat@sharif.edu (H. Nejat Pishkenari),

amtalaiezadeh@mech.sharif.edu

addresses:

d.antunes@tue.nl
aalasti@sharif.edu (A. Alasty).

attention in the context of quadcopters, despite the fact that
they can play a very important role due to their agility. Some
exceptions are [8]–[16].

In [8] it is reported that for descending trajectories and for
some velocity state space regions a quadcopter can become
unstable. Other studies show that these instabilities are due
to the VRS effects, see [9]–[11], where simple models are
deﬁned for explaining the boundary of these regions. These
simple models are similar to helicopter models and are used
in some works to design controllers that avoid entering the
VRS [12]–[16]. In fact, these studies are similar to helicopter
VRS avoiding controllers introduced in [17], [18]. However,
the results of these models and control strategies have only
been shown through simulation and have not been validated
through real measurements. Moreover, due to differences in
the blades mechanisms between helicopters and quadcopters1,
high ﬂuctuation regions are different. Furthermore, such con-
trollers are not time-optimal, which is often required in the
context of aggressive maneuvers. (see [19]–[21] which tackle
the problem of ﬁnding time-optimal trajectories without con-
sidering aerodynamic constraints.)

In this paper, we conduct static experimental tests on a
wind tunnel to identify the regions where ﬂuctuations occur.
Combining this information with the VRS and TWS regions
predicted by a theoretical model, we provide a simple model
for the region in the velocity space to be avoided by the
quadcopter. As we will discuss, we claim that the quadcopter,
contrarily to helicopters, should also avoid the WBS region.
According to the model for constraints and state bounds,
different optimal trajectories are designed, considering planar
2D and full 3D models for the motion of the quadcopter.
Due to the complexity of this nonlinear optimal control
problem, we resort to the optimal control toolbox, GPOPS-
II [22]. The designed trajectories to descend as fast as possible
boil down to intuitive maneuvers, such as oblique and ﬂips
maneuvers in 2D, and helix type maneuvers in 3D. Finally,
the optimal trajectories are implemented on a quadcopter. The
ﬂight tests show that by following the designed trajectories, the
quadcopter is able to descend considerably faster than purely
vertical trajectories that also avoid the VRS.

The remainder of the paper is organized as follows. In
Section II, the aerodynamic effects in descent maneuvers that

1The helicopters blades have a constant rotational speed and their pitch
angle is variable with a swashplate mechanism for changing the direction of
the blade disk thrust. In contrast, quadcopters motor speed is variable, and their
blades pitch angle is usually ﬁxed. Moreover, the hings of the helicopter blades
provide a ﬂapping degree of freedom, whereas in contrast to the quadcopter
where the blades are rigid.

 
 
 
 
 
 
2

Fig. 1: The VRS, TWS and WBS regions in the velocity state
space for helicopters are shown in the ﬁgure. Both vertical,
vz, and horizontal vH speeds are normalized by the induced
velocity at hover, where vH and vz are horizontal and vertical
speeds in the blade disk frame, respectively [2].

may cause instability are described, and two major regions in
the descent of quadcopters are introduced, based on a theoret-
ical model borrowed from helicopter aerodynamic theory. In
Section III, the wind tunnel test results are described and a
model is suggested for the boundaries of the unstable regions
in the velocity space. Section IV provides optimal minimum
time trajectories in 2D and 3D spaces that are designed
considering the VRS constraints, a model of the quadcopter,
and GPOPS-II. Section V presents the ﬂight test experiments
by which the quadcopter follows the optimal time trajectories
while avoiding the VRS. Section VI provides a brief discussion
and research lines for future work.

II. MODEL OF CRITICAL REGIONS DURING DESCENT

In this section, the behavior of the quadcopter in descent
maneuvers is described based on the theory available for
helicopters. When a helicopter is descending, in some regions
in the velocity state space, intensive vibrations and ﬂuctuations
in thrust occur. By increasing the horizontal speed of the
helicopter, these effects can be reduced. Depending on the
vertical and horizontal speeds, the amplitude of ﬂuctuations
in thrust can vary. The low and high amplitude ﬂuctuations
are known as VRS and TWS, respectively. In Figure 1, the
VRS and TWS regions are illustrated in the velocity space
normalized by the induced velocity at hover. The induced
velocity corresponds to the ﬂow at the tip of the blade from the
high-pressure air at the bottom of the blade to the low-pressure
air at the top of the blade. For a helicopter, the descent modes
can be divided into four modes:

• Normal Descent: In this mode, there is no ﬂuctuation on
the thrust. This corresponds to a normal ﬂight mode.
• VRS: In a descent maneuver, the ﬁrst low ﬂuctuations in
the thrust are in the Vortex Ring state region. This region
is described in Section II-1.

• TWS: In this region, because of high amplitude ﬂuctua-
tions on the thrust, the helicopter experiences intensive
vibrations which might lead to instability. This region is

Fig. 2: Tip vortexes velocities in oblique descent, used in
Onera’s criterion [13]. VS in this ﬁgure is the velocity of air
stream in the blade disk.

also considered as VRS in this paper because this region
is encompassed by the VRS region in the velocity state
space.

• WBS:(or autorotation) In this region, while the helicopter
still suffers high amplitude ﬂuctuations, there is enough
lift created by the airﬂow (contrarily to the VRS) such
that the helicopter can still be controlled.2 This can be
achieved by switching off the motors and changing the
pitch angle of the blades to simply control the angle
of attack (the pilot can, e.g., change a positive angle
of attack to a negative one to produce the thrust and
change the thrust vector direction with the swashplate to
control the orientation of the helicopter [7]). The blades
lift (and rotation) will now be caused by the air moving up
through the blade disk and not by the motors. This effect
is equivalent to the gliding ﬂight in ﬁxed-wing planes.
In Section II-2, the differences between helicopter and
quadcopter, and the behavior of the quadcopter in this
region are explained.

To determine the behavior of the quadcopter in the descent
phases, ﬁrstly, we will provide a model for the VRS and
TWS regions. For the WBS region, we will discuss that due
to the differences between the helicopter’s and quadcopter’s
blade disks, the WBS models for helicopters are not valid for
quadcopters, and we will ﬁnd the behavior of the quadcopter’s
blade disks by wind tunnel
tests which are provided in
Section III.

1) Vortex Ring State Model in Quadcopter: The momentum
theory is not valid in the VRS and TWS regions. However, it
is possible to ﬁnd the boundary of these regions to identify
if the quadcopter is in these regions or not. For modeling
the VRS and TWS boundaries, there are many suggestions
in the literature [23]–[25]. One of the closest models to the
experiments is Oneras model [26]. Let (cid:107)Vtv(cid:107) be the speed
of blade’s tip vortex and let (cid:15)cr be the critical velocity of the
blade’s tip vortexes. Then the following criterion deﬁnes the
critical region [26]:

(cid:107)Vtv(cid:107) ≤ (cid:15)cr,

(1)

where the speed of blade’s tip vortex can be calculated from:

Vtv = vH jbd + (vi/2 + vz)kbd,

(2)

2A helicopter typically enters WBS or autorotation region when it cannot

use its engine because of motor’s or tail-rotor’s malfunctioning.

Windmill Brake State (WBS)vHVortex Ring State(VRS)Turbulence Wake State(TWS)vzVSvHvz +viVSVvz vHTip VortexVtvjbdkbd3

Fig. 3: Asymmetry in maneuvers with horizontal speeds per-
taining to Onera’s criterion for the vortex ring state model [13].
I and II are two vortex rings leaving the rotor with the
same velocity, but moving in the parallel and perpendicular
directions, respectively. After a time t, the they will move the
distance d, however Figure 3 shows that tip vortex I is still in
contact with the blade disk while vortex II is not.

where vH and vz are the horizontal and vertical speeds in the
blade disk frame, respectively, vi is the induced velocity in the
blade disk, and the unity vectors, jbd and kbd are parallel and
perpendicular to the blade disk, as shown in Figure 2. Using
(1), (2), the criterion can be rewritten as:

(cid:113)

(cid:107)Vtv(cid:107) =

tvH + V 2
V 2

tvz ≤ (cid:15)cr.

(3)

where VtvH = vH and Vtvz = vi/2 + vz. Figure 2 illustrates
this setting. However, this model is not symmetric when the
quadcopter has a horizontal speed, as shown in Figure 3. Let
us consider I and II as two vortex rings leaving the rotor with
the same velocity, but moving in the parallel and perpendicular
directions, respectively. After a time t, the they will move the
distance d, however Figure 3 shows that tip vortex I is still in
contact with the blade disk while vortex II is not.

To improve the accuracy of this model, assuming asymmet-
ric effects, a correction coefﬁcient, k, should be added to the
criterion as introduced in the following equation:

(cid:112)(vH /k)2 + (vi/2 + vz)2 ≤ (cid:15)cr,
where k is a parameter larger than one, k ≥ 1. Then VtvH =
vH /k and Vtvz = vi/2 + vz. Therefore, in order to meet (4)
the following conditions are necessary:

(4)

(cid:26) VtvH ≤ (cid:15)H
Vtvz ≤ (cid:15)z

, (cid:15)z ≤ (cid:15)H ,

(5)

where (cid:15)H = k(cid:15)z and (cid:15)z = (cid:15)cr. (cid:15)z and (cid:15)H are critical blade’s
tip vortex velocity in pure vertical and horizontal maneuvers,
respectively. To calculate the induced velocity, the following
equation can be used [4]:

(cid:113)

vi

H + (vi + vz)2 = v2
v2
h,

(6)

where vh is given constant coinciding with the induced veloc-
ity in the blade disk at hover and can be calculated as:

vh = (cid:112)THover/2ρA,
where THover is the thrust of the motor at hover, ρ is the air
density, and A is the blade disk area. Usually, THover/A is
denoted by the disk load. Let

(7)

(cid:15) = (cid:112)(vH /k)2 + (vi/2 + vz)2.

(8)

Fig. 4: Variation of (cid:15) based on different values of vH and vz.
The effect of the horizontal speed in the blade disk frame is
obvious, more horizontal speed, more (cid:15) value. In this ﬁgure,
THover = 0.5 kg, ρ = 1.2kg/m3, and the blade disk diameter
is 0.2m.

If we ﬁx vH , we can compute vi as a function of vz from
(6) and plot (cid:15), as a function of vz. This plot is shown in
Figure 4 for different values of vH . This ﬁgure illustrates that
by increasing the horizontal speed in the blade disk frame vH ,
the (cid:15) value will increase and therefore it is possible to increase
the vertical (descent) speed vz without entering the VRS and
TWS regions. Such regions are deﬁned by (cid:15) ≤ (cid:15)cr, and are
also depicted in Figure 4.

Figure 5 shows the numerical solution of criterion (4) with
k = 6 and (cid:15)cr = 0.4 for the VRS (which illustrates with orange
stars) and (cid:15)cr = 0.2 for the TWS (which illustrates with red
circles). The induced velocity is calculated from (6). Figure 5
illustrates the VRS and TWS based on Onera’s criterion. Note
that following Oneras criterion one cannot identify the WBS
which is a limitation of this theoretical model. Such a region
will be identiﬁed experimentally in the next section. Since the
TWS is encompassed by the VRS, we will simply consider
the union of these regions as a prohibited region and denoted
this region simply by the VRS region.

2) Windmill Brake State in quadcopters: As explained
before, the control of a helicopter in this region is achieved
by changing the pitch. This is possible due to the pitch
angle degree of freedom in the helicopters blade mechanism.
However, for quadcopters, there is no degree of freedom in
pitch angles, and there is not a swashplate mechanism to
handle the thrust vector in the absence of the motor. Since
if we turn off the motors of the quadcopter, we will lose the
controllability of the quadcopter, the autorotation effect acts
as a brake in the blade disk. In the autorotation mode, by the
action of upward air, the blades tend to rotate in the opposite
direction, the motor performs torque to turn the blades and this
may cause ﬂuctuations on the blade disk. Hence, WBS regions
should be considered as a forbidden area for quadcopters like
the VRS and TWS regions.

ddIIITip Vortex-3.5-3-2.5-2-1.5-1-0.5000.511.522.533.54crk = 6vH=1 m/svH=2 m/svH=3 m/svH=4 m/svH=5 m/svH=6 m/s4

Fig. 6: Motor-blade tester to measure thrust, rpm, voltage and
PWM adapted for simulating various oblique descent angles in
wind tunnel. Setup angle is measured by a digital inclinometer.

Fig. 7: Emulation of descent in wind tunnel with variable angle
mechanism for thrust tester setup.

results where stars and
Fig. 8: Wind tunnel experiment
squares deﬁne the high ﬂuctuation and low ﬂuctuation points,
respectively. The VRS region, using the Onera’s criterion
is illustrated with red color. The blue color region is also
prohibited due to the high ﬂuctuations, and it concluded in this
research that these ﬂuctuations are the WBS effect. Normal
regions are depicted by green color. To simplify this constraint,
the top region of the orange line is considered as the allowable
region

Fig. 5: Numerical solution of the Oneras criterion. The VRS
and TWS are illustrated by orange stars and red circles, respec-
tively. The region identiﬁed with green squares corresponds
to normal descent in Onera’s criterion, however this region
may include WBS in reality. In this ﬁgure, THover = 0.5 kg,
ρ = 1.2kg/m3, and the blade disk diameter is 0.2m.

III. IDENTIFICATION OF THE DESCEND REGIMES IN THE
QUADCOPTERS

To identify the behavior of the brushless motors with ﬁxed
pitch angle blades, in different descent velocities and angles,
an experimental setup has been designed, see Figure 6. This
experimental setup can measure the force of motor-blades,
rpm, current, voltage. The angle of the setup can be modiﬁed
so that it emulates the oblique descent in the wind tunnel, see
Figure 7. For these experiments, the wind tunnel of the Eind-
hoven University of Technology (TU/e) is used. In this wind
tunnel, we measured the amount of thrust and its ﬂuctuation,
the motor rpm, and the motor Pulse Width Modulation (PWM)
and voltage input in different wind velocities and different
setup angles (to simulate the different angles of descent).
These tests were performed with different blades and motors.
However, the results, illustrated in Figure 8 are for T-Motor
Air 2213 brushless motor and T9545 Propeller. The results
are normalized by the induced velocity at hover. Regions with
high ﬂuctuations (∆T /T ≥ 10% for thrust ﬂuctuations) are
deﬁned as prohibited regions.

As predicted, based on the theoretical analysis, high ﬂuctu-
ations occur in the VRS region computed from the Oneras
criterion. Interestingly, ﬂuctuations also occur in the blue
regions shown in Figure 8, which is identiﬁed as the WBS
(which as mentioned before, is not predicted from Oneras
model). As also depicted in Figure 8, and also in Figure 9, we
can deﬁne a simpliﬁed region where high ﬂuctuations do not
occur. This is summarized in the next deﬁnition.

Deﬁnition 1. Simpliﬁed VRS Velocity Constraint

|vH | tan 20◦ ≥ vz,
∀vz ≤ 0, vH ∈ IR,

(9)

where vH and vz are in the body ﬁxed frame.

TAir stream00.511.522.5-1.4-1.2-1-0.8-0.6-0.4-0.20Normal DescentVRS+TWSAdditional Prohibited Region5

Fig. 10: Quadcopter, its motors’ thrusts, the inertial, body and
blade disk NED frames are illustrated.

change of the angular momentum.
(cid:88)

M = dH/dt = ˙H + ω × H.

(11)

The torques that are applied to the robot from motors depend
on the conﬁguration of the quadcopter. For an X shaped
quadcopter, the torques are given by:

M =






Mx
My
Mz











=

b(−T1 + T2 + T3 − T4)
b(T1 + T2 − T3 − T4)
(−M1 + M2 − M3 + M4)






+ Mext,

(12)
where Ti is the output thrust of the ith motor, b is the distance
between motors and center of gravity, Mi is the output torque
of ith motor and Mext is the external torque vector. In (11), H
is the angular momentum of the robot that can be calculated
as:

H = Iω,

(13)

where I is the bodys inertia tensor of the quadcopter, and ω
is the angular velocity of the quadcopters body.












ω =

=

.









ωx
ωy
ωz

p
q
r

(14)

Therefore, equation (11) can be rewritten as:

(cid:88)

M = I ˙ω + S(ω)Iω,

where

S(ω) =





0 −r
r
−q

q
0 −p
0
p



 .

Finally, the equations of motion are given by:
˙P = V,
˙V = (cid:80) FI/m,
I
˙R
b = RI
bS(ω),
I ˙ω = (cid:80) M − S(ω)Iω,

(15)

(16)

(17)

where P and V are the position and the velocity of the
quadcopter’s center of mass in the inertial frame, respectively,
and m is the quadcopter’s mass.
I
Alternatively to the equation ˙R
b = RI

bS(ω), we can write:

˙q = G(q)ω,

(18)

Fig. 9: The simpliﬁed constraint used for optimal trajectory
design. Regions I and II are allowed and prohibited regions,
respectively.

Remark 1. The motion planner should design a trajectory to
avoid these regions. Note that to take into account these con-
straints it is necessary to compute the relative wind velocities
in the blade disk frame, not in the inertial frame, as it will be
discussed in the next section.

Remark 2. The dimensions of the velocity constraints are
normalized by the induced velocity at hover. Therefore, this
model can be used for every kind of quadcopters’ blade disks
with different disk loads and diameters that have ﬁxed-pitch
blades.

IV. DESIGN OF OPTIMAL TRAJECTORIES

This section tackles the problem of designing optimal
trajectories for a quadcopter to descend as fast as possible,
considering the VRS and WBS constraints. Section IV-A pro-
vides the equations of motion of a quadcopter. In Section IV-B
and Section IV-C, the motion of the quadcopter is considered
in 2D and 3D space, respectively, and descend trajectories with
minimum time are designed.

A. Quadcopter Equations of Motion

If we consider the North-East-Down (NED) as the inertial
frame, and a body ﬁxed frame, denoted by b with its origin
coinciding with the center, z axis aligned with the gravitational
vector when the quadcopter is at hover and x and y axis as
shown in Figure 10, the total external force FI expressed in
the inertial frame acting on the quadcopter can be expressed
as follows (see [27]):

(cid:88)

FI = RI
b






0
0
1(−Ti)

(cid:80)4






+






0
0
mg






+ Fext,

(10)

where Fext is disturbance force vector, RI
b is the rotation
matrix from the body to the inertial frame and Ti denotes
the thrust generated by the ith motor.

By the Euler-Newton formalism, the summation of torques
that are applied to the quadcopter is equal to the time rate of

vHvz20˚ IIIIIT1T2T3T4xyzXYZBody Frame (i, j, k)Inertial Frame (I, J, K)Blade Disk Frame (ibd, jbd, kbd)xbdybdzbd6

Our goal is to design a control law for the quadcopter to move
from the initial state at height h1 to the ﬁnal state at height
h2 both at hover.

The cost function for the optimal trajectory design, J, is for

the minimum time problem:

J = min

(cid:90) tf

0

g(S, U )dt = min

(cid:90) tf

0

1dt.

(24)

Taking into account the relation between velocities in the body
ﬁxed frame (vH , vz) and the inertial frame (VY , VZ):

(cid:19)

(cid:18)vH
vz

=

(cid:20)cos φ − sin φ
cos φ
sin φ

(cid:21) (cid:18)VY
VZ

(cid:19)

,

we can consider
C(VY , VZ, φ) ≥ 0, where:

the simpliﬁed velocity constraint

(25)

(9),

C(VY , VZ, φ) = VZ(1 − B tan φ) − VY (B + tan φ),

(26)

and B = tan(20◦). This constraint is obtained by ﬁnding the
air relative velocity in the body ﬁxed frame and using the
Deﬁnition 1. To take into account this constraint we modify
the Hamiltonian to:

H(S, U, λ) = g(S, U ) + λT f (S, U ) + λCC(VY , VZ, φ),
(27)

where λ denotes the co-state variables:

λ = (cid:2)λY

λVY

λZ λVZ λφ

(cid:3)T

.

(28)

Using cost function, dynamic and path equations, the Hamil-
tonian can be written as:

+λVZ (−fcoll cos φ + g) + λφωx+
λC(VZ(1 − B tan φ) − VY (B + tan φ)).

(29)
Using the Maximum Principle for problems with mixed in-
equality constraints conditions [29] and Hamitonian in (29),
we obtain:

dS (S∗(t), U ∗(t), λ(t))T ,

˙λ(t) = − dH
˙λY
= 0 → λY = c1,
˙λvY = −λY + λC(B + tan φ),
˙λZ
= 0 → λZ = c3,
˙λvZ = −λZ − λC(1 − B tan φ),
˙λφ

= fcoll(−λvY cos φ − λvZ sin φ)
−λC/(cos φ)2(VZB − VY ),

(30)

where λC ≥ 0 and λCC(VY , VZ, φ) = 0 are complementary
slackness conditions, and c1 and c3 are constants.

This problem is very complex and it is hard to solve this
nonlinear optimal control problem analytically, so we use a
numerical method to solve it. Namely, we used GPOPS-II, a
Matlab plugin, to solve this optimization problem. GPOPS-II
implements a new class of variable-order Gaussian quadrature
methods where a continuous-time optimal control problem
is approximated as a sparse Nonlinear Programming (NLP)
problem [22].

Besides the constraints corresponding to the dynamics (23),
the constraint that should be satisﬁed during the whole path
is (26).

(19)

H(S, U, λ) = 1 + λY VY + λVY (fcoll sin φ) + λZVZ

Fig. 11: Quadcopter in 2D analysis, including two motors. The
inertial and body frames are illustrated.

where q = [q0, q1, q2, q3] are the quaternions and G(q) is a
matrix of quaternions [28].

B. 2D Optimal Trajectories

Consider the quadcopter is in the Y-Z plane, as shown in
Figure 11, its motion is planar and there are only three degrees
of freedom. Let us combine two pairs of motors on each side,
so that we can assume a single thrust force is applied on each
side. Although this leads to a simple planar model, it is still an
underactuated system, such as the full 3D quadcopter model.
The equations of motion for this simpliﬁed can be derived
from the full model (17) and are given by:

¨Z = −fcoll cos φ + g,
¨Y = fcoll sin φ,
Ixx

¨φ = ml(fa − fc),

where fcoll
thrusts:

is the collective acceleration from the motors’

fcoll = fa + fc,

(20)

where fa and fc are the thrusts of each motor, divided by the
mass. If we assume the angular velocity as a control input, the
kinematic equation can be assumed to be simply given by:

˙φ = ωx.

The system states, S, and inputs, U , are:

S = (Y, VY , Z, VZ, φ),
U = (fcoll, ωx).

The state space equation is:










˙Y
˙VY


˙Z


˙VZ

˙φ

=


0
0


0


0

0

1 0 0
0 0 0
0 0 1
0 0 0
0 0 0

0
0
0
sin φ


0
0


− cos φ 0

1

0

















0
0
0
0
0









Y
VY
Z
VZ
φ









+

(cid:21)

(cid:20)fcoll
ωx

+



0
0




0




g


0

(21)

(22)

(23)

ZzYφfcfafcollωx TABLE I: Initial and ﬁnal values as well as admissible
intervals of the system variables

Variable

Initial Cond.

Final Cond.

Admissible Intervals

Y
VY
Z
VZ
φ
fcoll
ω

0
0
0
0
0
g
0

0
0
5
0
0
g
0

[−15, 15]
[−10, 10]
[−15, 15]
[−10, 10]
[−π/3, π/3]
[−20, 20]
[−1, 1]

7

Fig. 13: Optimal 2D trajectories design for free (ﬁnal Y is not
ﬁxed but it is bounded) and bounded horizontal displacement,
that let the system have oblique and Zig-Zag trajectories,
respectively. Moreover, the φ interval is [−π/3, π/3]. It is
obvious that if the pure oblique descent is allowed, then the
trajectory will be faster than Zig-Zag maneuver. Moreover, by
increasing the horizontal displacement limitation, the trajec-
tory duration will be increased.

the optimal trajectory time will increase.

Also, if we assume that the φ angle is free, it is permissible
that the system has ﬂip maneuvers in its trajectory. With this
assumption, the optimal time of the optimal trajectory is 2.27
seconds. Figure 14 illustrates that the trajectory with ﬂips
when the system has freedom in the φ angle; however it should
come back to its initial Y position because of predeﬁned ﬁnal
conditions. Due to the upside down maneuver, the quadcopter
can descend with an acceleration higher than the gravity.
Moreover, because of this rotation, the descent velocity will
be positive in the body ﬁxed frame where there is no velocity
constraint in positive body ﬁxed frame z velocity region and
the quadcopter can descent freely with high velocity.

Finally, if we assume that the Y displacement is free as
well as the φ angle, the trajectory would be a combination
of the oblique and ﬂip maneuvers, illustrated in Figure 15.
This trajectory takes 2.07 seconds for descending 5 meters.
It shows that the fastest trajectory is a trajectory, including
ﬂips and oblique maneuvers. A comparison between methods
depending on admissible intervals and allowed maneuvers, is
provided in Table II.

Based on a brief review of different optimal trajectories,
provided in Table II, it is evident that the fastest trajectory
is a trajectory including ﬂips and oblique maneuvers, when
there are no limitations in the horizontal direction. Moreover,
the lowest-speed trajectory is the Zig-Zag trajectory when
there are strict limitations on the Y displacement. However, if

Fig. 12: Optimal 2D trajectory design for equal initial and
ﬁnal Y position is shown for the whole trajectory with blue to
red colors. The velocity constraint, considering the velocities
in the blade disk is satisﬁed.

Initial, ﬁnal and admissible intervals of the system variables
are deﬁned in Table I. According to these initial and ﬁnal
the minimum time trajectory can be
values and bounds,
designed. With this trajectory, the quadcopter can descend 5
meters in 5.33 seconds. The simulation results and designed
optimal trajectory are shown in Figure 12. This ﬁgure illus-
trates that even if the ﬁnal horizontal displacement is not
desired, the quadcopter should move in the horizontal direction
meanwhile and come back to its initial Y , in order to satisfy
the velocity constraint. It shows that the pure descent (without
any horizontal displacement during the trajectory) is not the
fastest trajectory to descend.

Moreover, if we assume that the ﬁnal Y -position is free, but
bounded between [-2, 2], [-5, 5] or [-10, 10] meters, depending
on the bounds, the designed trajectories are either Zig-Zag or
pure oblique trajectories as illustrated in Figure 13. For the
mentioned bounds, the time of the optimal trajectory is 6.80,
4.60 and 3.39 seconds, respectively. It is obvious that the pure
oblique trajectory is faster than the Zig-Zag trajectories, but the
latter requires a much smaller space in the 2D space. Also, by
decreasing the admissible interval in the horizontal direction,

024-6-4-202t = 0t = 5.326T0TfTime024-505024012302401020024-101-505-2-1.5-1-0.50012345Time (s)-10-505-6-4-202t = 0t = 6.8t = 3.39t = 4.6T0TfTime0246-505y=[-5,5]y=[-10,10]y=[-2,2]02460240246-200200246-101-505-2-1.5-1-0.500123456Time (s)8

TABLE II: Optimal trajectories with different maneuvers and
admissible intervals, to descend 5 meters in the Z direction.
Initial and ﬁnal φ angles are zero, as well as initial Y
condition.

Y Intervals

φ Intervals

Final Y

[−15, 15]
[−2, 2]
[−5, 5]
[−10, 10]
[−15, 15]
[−15, 15]

[−π/3, π/3]
[−π/3, π/3]
[−π/3, π/3]
[−π/3, π/3]
free
free

ﬁxed(0)
bounded
bounded
free
ﬁxed(0)
free

Ob.
(cid:55)
(cid:55)
(cid:55)
(cid:88)
(cid:55)
(cid:88)

Z.Z.
(cid:88)
(cid:88)
(cid:88)
(cid:55)
(cid:55)
(cid:55)

Fl.
(cid:55)
(cid:55)
(cid:55)
(cid:55)
(cid:88)
(cid:88)

Traj. Dur.

5.33 s
6.80 s
4.60 s
3.39 s
2.27 s
2.08 s

the ﬂip maneuver is not allowed in the trajectory, the simple
oblique trajectory will be the fastest solution for a fast descent,
considering the velocity constraint.

C. 3D Optimal Trajectories

As we have shown in the 2D analysis, the fastest trajectory
is the trajectory where φ and Y are free. However, if aggres-
sive maneuvers are not desired, we should limit the allowed
rotation angle of the quadcopter. In the 2D analysis, between
the limited φ trajectories, Y free trajectories are the fastest.
However, in real ﬂights, the quadcopter needs to descend fast,
mostly we do not have enough space for such large movement
in the Y direction, in conﬁned environments, these trajectories
are not possible. As we shall see shortly, the trajectories we
will obtain in this 3D analysis are helix type trajectories.
Note that for helix type trajectories, a centrifugal force is also
present.

Due to the centrifugal force in helix type trajectory, the
quadcopter should have a pitch angle around the y axis of
body frame in addition to a roll rotation around x. The thrust
vector in the inertial frame is:

TI = RI
b





0
0
−T



 .

(31)

If the yaw angle is such that the velocity vector belongs to
the xz plane in body ﬁxed coordinates, then the component of
thrust for the centrifugal force can be calculated from:

|Tcent| =

(cid:16)(cid:88)

FI(cid:17)

.en

(32)

where Tcent
is the component of the thrust vector in the
centrifugal direction, and en is the unity vector perpendicular
to the trajectory curve, toward to the curvature center. The
magnitude of centrifugal force is:

(cid:107)Tcent(cid:107) = mV 2/r.

(33)

where r is the radius of the trajectory curve each time. For
ﬁnding the quadcopter velocity in the body frame, by assuming
that the heading of the robot is in the forward direction of
motion, we can use the rotational matrices. The wind velocity
with respect to the quadcopter body in the inertial frame is:

VI

Wrel

= W − V,

(34)

where W is the wind speed, and V is the quadcopter’s velocity.
To ﬁnd the wind velocity in the body frame, we can use:

Vb

Wrel

= Rb

I VI

Wrel

,

(35)

Fig. 14: Optimal 2D trajectory design for equal initial and
ﬁnal Y , no limitation is considered for φ allowing for ﬂip
maneuvers. It shows that although the ﬁnal Y is ﬁxed and
equal to initial Y , the trajectory with ﬂips is faster than ones
with simple oblique maneuvers as illustrated in Figure 13.
That is because of the maximum acceleration in the vertical
direction is gravitational acceleration, however using ﬂips, the
quadcopter can use its thrusts to increase the acceleration in
the downward direction.

Fig. 15: Optimal 2D trajectory design with no limitation
on ﬁnal Y , horizontal displacement, and φ angle interval,
allowing for oblique and ﬂips maneuvers, simultaneously. We
can see that using oblique maneuver in the combination of
ﬂip maneuvers can decrease the ﬁnal trajectory time. This
trajectory is the fastest trajectory that can be designed using
the mentioned assumptions, limitations and constraints.

00.511.52-20200.511.52024600.511.52-2002000.511.52-505-505-20246800.511.52Time (s)-202-6-4-202t = 0t = 2.2744T0TfTime00.511.52-3-2-1000.511.52024600.511.52-2002000.511.52-505-505-20246800.511.52Time (s)-4-202-6-4-202t = 0t = 2.076T0TfTimewhere Rb
frame.

I is the rotation matrix from the inertial to the body

Using the velocity constraint deﬁned in (9), the constraint

in the 3D analysis will be:

9

where:

and:

|Vb

WH

| tan 20◦ ≥ Vb
Wz

,





V b
Wx
V b
Wy
VWz


 = Rb
I







 ,

VX
VY
VZ

V b
WH

=

(cid:113)

(V b
Wx

2 + V b
Wy

2).

(36)

(37)

(38)

To solve the optimal-time problem for ﬁnding the fastest
descent trajectory, the cost function in (24) is used. The states
and control inputs in the 3D analysis are deﬁned as:

S = (X, VX , Y, VY , Z, VZ, q, ˙q),
U = (T1, T2, T3, T4).

(39)

Note that quaternions were used to avoid singularities. More-
over, if we use the equations of motion in 3D space provided
in Section IV-A, considering the VRS velocity constraint
in (9), we will ﬁnd more complex Hamiltonian conditions
that are very difﬁcult to solve analytically. Then, numerical
methods are used as for the 2D analysis. Using the GPOPS-
II as the numerical solver to ﬁnd the optimal trajectory, in
3D motion, the helix type trajectory can be generated for
minimum time trajectory, illustrated in Figure 16. For this
design, 5 meters descent and coming back to its initial X
and Y positions are desired. As we have seen in the 2D
analysis, for non-ﬂip trajectories, the oblique trajectory is the
fastest way to descend. Hence, in 3D analysis, the helix type
trajectory is the equivalent of oblique in 2D, with consideration
of Y -displacement limitation. Then, in real 3D ﬂights, an
appropriate non-aggressive (without ﬂips) maneuver for fast
descent is a helix type. This trajectory helps motion planners
to design a faster descent in their mission, and it is considered
for ﬂight experiments.

V. EXPERIMENTS
For real ﬂight tests, the Parrot Mambo drone shown in
Figure 17 was utilized. This quadcopter has the following
sensors: IMU, barometer, ultrasound, and a downward camera
using optical ﬂow algorithm for positioning. The controller
and designed trajectories are uploaded on the Mambo from
Matlab/Simulink via Bluetooth.

The mass of the Mambo quadcopter is 63 gr, and each blade
disk diameter is 6.5 cm. Using the equation (7), the induced
velocity at hover is 1.54 m/s.

To show the ﬂuctuations and instability in the VRS and
WBS regions in the real ﬂight, a sinusoidal desired trajectory
in the Z direction with increasing frequency is designed, which
is given by:

Zdes = A sin(ωt) + Z0,

(40)

where ω = ω0t.

By using reference, the vertical speed would grow slowly,
and we can see the effects of entering the prohibited regions,
in a limited ﬂight space.

(a)

(b)

Fig. 16: Optimal 3D trajectory design for fast descent using
GPOPS-II, a) Position and 3D Trajectory of generated tra-
jectory, b) Orientation and velocity of the quadcopter in the
generated trajectory.

Fig. 17: Parrot Minidrone Mambo used for the ﬂight tests

00.511.52-20200.511.52-20200.511.52-20200.511.52-2002000.511.52-2002000.511.52-20020BatteryOptical Flow and Ultra sound sensorsIMU and Barometer sensorsBlades Guard Brushless Motor10

(a) Position and vertical velocity of the ﬂying Quadcopter

(a) Position and vertical velocity of the ﬂying quadcopter

(b) Angular velocity of the quadcopter

Fig. 18: Flight tests with variable frequency sinusoidal tra-
jectory in the Z direction that provides increasing descent
velocity. This test shows that by entering into the VRS or
TWS regions, the quadcopter experiences ﬂuctuation and by
increasing descent velocity, without any horizontal maneuver,
the ﬂuctuations are higher till the system becomes completely
unstable, at time 24 s.

(b) Angular velocity of the quadcopter

Fig. 19: Drone with a helix type trajectory for achieving the
is illustrated that by following
high speeds in descent. It
the helix type trajectory, the quadcopter can achieve high
descent speeds considering the VRS and WBS constraints on
air stream velocities in the blade disk frame.

As we can see in Figure 18, by entering into the VRS region
(that is 0.6 m/s velocity in the Z direction), there will be low
ﬂuctuations in the quadcopter. Entering deeper into the VRS
and WBS regions, more ﬂuctuations are experienced by the
quadcopter, till the quadcopter becomes completely unstable,
and crashes at 24 seconds. The data in the plots after this
moment (24 seconds) pertain to the crashing effects with the
ground.

This experiment shows that the VRS and WBS regions are
present in the quadcopter and for the trajectory design for these
rotary-wing drones, it is vital to assume the velocity constraint.
To descend as fast as possible, avoiding the VRS and WBS
regions, and assuming non-aggressive maneuvers, a helix type
trajectory is suggested from the analysis provided in the
previous section. We can see that in Figure 19 even by having
descent velocity higher than 0.6 m/s for more than 2 seconds, it
can descend fast. Therefore by following a helix type trajectory

and thereby adding horizontal speed in the blade disk frame
the quadcopter avoids the VRS and WBS regions and does
not become unstable.

In the regular descent, the quadcopter can descent 5 meters
with a pure descent in 8.3 seconds. However, using VRS
avoiding trajectory, the quadcopter can descend 5 meters in
2.5 seconds which is much less than the pure descent.

VI. CONCLUSIONS

In this paper, the existence of the VRS and WBS in the
context of quadcopters have been investigated. Subsequently,
using experiments in wind tunnel, a normalized model for
the quadcopter drones was obtained which is independent
from the disk load and the blade disks diameters. Then, for
trajectory designs, a simple model is provided. Due to the
complex optimal problem for minimum time trajectory design,

0510152025-202ReferenceReal0510152025-2020510152025-3-2-100510152025-20240510152025-100100510152025-100100510152025-10010051015time (s)-202X (m)ReferenceReal051015time (s)-202Y (m)051015time (s)-4-20Z (m)051015time (s)-1012VZ (m)051015time (s)-10010p (rad/s)051015time (s)-10010q (rad/s)051015time (s)-10010r (rad/s)we designed optimal 2D and 3D trajectories for descent,
using GPOPS-II package as a numerical solver. Finally, we
the VRS
performed ﬂight experiments which showed that
is present for quadcopters. In fact, this might be the cause
of instability and crashes in fast descents. Furthermore, it
is explained that by increasing the horizontal speed to the
the ﬂuctuations can be reduced in the ﬂight.
blade disk,
By descending with a helix type trajectory as an optimal
descending trajectory, the quadcopter can descend fast without
entering to the unstable regions.

Possible directions for future work are to use learning
methods to identify the unstable boundaries, controlling the
quadcopter with learning methods, and investigating the be-
havior of variable pith quadcopters in the VRS and WBS
regions.

REFERENCES

[1] G. Cai, J. Dias, and L. Seneviratne, “A survey of small-scale unmanned
aerial vehicles: Recent advances and future development trends,” Un-
manned Systems, vol. 2, no. 02, pp. 175–199, 2014.

[2] G. H. Saunders, Dynamics of helicopter ﬂight.

John Wiley & Sons,

1975.

[3] W. Johnson, “Model for vortex ring state inﬂuence on rotorcraft ﬂight

dynamics,” NASA Ames Research Center, 2005.

[4] D. A. Peters and S.-Y. Chen, “Momentum theory, dynamic inﬂow,
and the vortex-ring state,” Journal of the American Helicopter Society,
vol. 27, no. 3, pp. 18–24, 1982.

[5] P.-M. Basset, C. Chen, J. Prasad, and S. Kolb, “Prediction of vortex
ring state boundary of a helicopter in descending ﬂight by simulation,”
Journal of the American Helicopter Society, vol. 53, no. 2, pp. 139–151,
2008.

[6] G. J. Leishman, Principles of helicopter aerodynamics with CD extra.

Cambridge university press, 2006.

[7] J. Seddon and S. Newman, Basic helicopter aerodynamics. American

Institute of Aeronautics and Astronautics, 2001.

[8] H. Huang, G. M. Hoffmann, S. L. Waslander, and C. J. Tomlin, “Aero-
dynamics and control of autonomous quadrotor helicopters in aggressive
maneuvering,” in Proceedings of IEEE International Conference on
Robotics and Automation, 2009, pp. 3277–3282.

[9] O. Westbrook-Netherton and C. Toomer, “An investigation into predict-
ing vortex ring state in rotary aircraft,” Royal Aeronautical Society, 2014.
[10] J. V. Foster and D. Hartman, “High-ﬁdelity multi-rotor unmanned air-
craft system (uas) simulation development for trajectory prediction under
off-nominal ﬂight dynamics,” in Proceedings of 17th AIAA Aviation
Technology, Integration, and Operations Conference, 2017, p. 3271.

[11] G. M. Hoffmann, H. Huang, S. L. Waslander, and C. J. Tomlin, “Pre-
cision ﬂight control for a multi-vehicle quadrotor helicopter testbed,”
Control engineering practice, vol. 19, no. 9, pp. 1023–1036, 2011.
[12] L. Chenglong, F. Zhou, W. Jiafang, and Z. Xiang, “A vortex-ring-
state-avoiding descending control strategy for multi-rotor uavs,” in
Proceedings of 34th Chinese Control Conference (CCC), 2015, pp.
4465–4471.

[13] J. Jimenez, A. Desopper, A. Taghizad, and L. Binet, “Induced velocity
model in steep descent and vortex-ring state prediction,” Laboratoire
ONERA-cole de L’Air, 2001.

[14] J. Prasad and C. Chen, “Prediction of vortex ring state using ring vortex
model for single-rotor and multi-rotor conﬁgurations,” in Proceedings
of AIAA Atmospheric Flight Mechanics Conference and Exhibit, 2006,
p. 6632.

[15] S. Taamallah, “A qualitative introduction to the vortex-ring-state, au-
torotation, and optimal autorotation,” in Proceeding of 36th European
Rotorcraft Forum, Paris, France, 2010.

[16] M. Bangura and R. Mahony, “Nonlinear dynamic modeling for high
performance control of a quadrotor,” in Proceedings of Australasian
Conference on Robotics and Automation, Victoria University of Welling-
ton, New Zealand. Australian Robotics and Automation Association,
2012.

[17] M. Abildgaard and L. Binet, “Active sidesticks used for vortex ring state
avoidance,” in Proceedings of 35th European Rotorcraft Forum,, 2009.
[18] M. Ribera, “Helicopter ﬂight dynamics simulation with a time-accurate

free-vortex wake model,” Ph.D. dissertation, 2007.

11

[19] M. Hehn, R. Ritz, and R. DAndrea, “Performance benchmarking of
quadrotor systems using time-optimal control,” Autonomous Robots,
vol. 33, no. 1-2, pp. 69–88, 2012.

[20] X. Liang, Y. Fang, N. Sun, and H. Lin, “Dynamics analysis and
time-optimal motion planning for unmanned quadrotor transportation
systems,” Mechatronics, vol. 50, pp. 16–29, 2018.

[21] S. K. Phang, S. Lai, F. Wang, M. Lan, and B. M. Chen, “Systems design
and implementation with jerk-optimized trajectory generation for uav
calligraphy,” Mechatronics, vol. 30, pp. 65–75, 2015.

[22] M. A. Patterson and A. V. Rao, “GPOPS-II: A MATLAB software
for solving multiple-phase optimal control problems using hp-adaptive
Gaussian quadrature collocation methods and sparse nonlinear program-
ming,” ACM Transactions on Mathematical Software (TOMS), vol. 41,
no. 1, p. 1, 2014.

[23] W. Castles Jr and R. B. Gray, “Empirical relation between induced
velocity, thrust, and rate of descent of a helicopter rotor as determined
by wind-tunnel tests on four model rotors,” NACA TN 2474, 1951.
[24] P. F. Yaggy and K. W. Mort, Wind-tunnel tests of two vtol propellers in
descent. National Aeronautics and Space Administration, 1963.
[25] A. Azuma, J. Koo, T. Oka, and K. Washizu, “Experiments on a model
helicopter rotor operating in the vortex ringstate.” Journal of Aircraft,
vol. 3, no. 3, pp. 225–230, 1966.

[26] A. Taghizad, “Experimental and theoretical investigations to develop a
model of rotor aerodynamics adapted to steep descents,” in Proceedings
of American Helicopter Society 58th Annual Forum, 2002.

[27] A. Talaeizadeh, Y. Goodarzi, H. N. Pishkenari, and A. Alasty, “Ac-
curate simulator for motion of the quadcopter; assuming dynamic and
aerodynamic effects,” in Proceedings of the 27th Annual International
Conference on Mechanical Engineering, 2019, pp. 391–396.
[28] H. Baruh, Analytical dynamics. WCB/McGraw-Hill Boston, 1999.
[29] S. P. Sethi, Optimal Control Theory. Springer, 2019.

Amin Talaeizadeh received his B.Sc. and M.Sc.
degrees in mechanical engineering from the Amirk-
abir University of Technology, Tehran, Iran, in 2011
and 2013, respectively. He is currently pursuing the
Ph.D. degree from the Sharif University of Tech-
nology, Tehran, Iran. He is now a visiting Ph.D.
student in the CST group of Eindhoven University
of Technology (TU/e). His current research interests
include optimal trajectory design, robotics, model-
based design, and optimal control.

Duarte Antunes received the Licenciatura in Elec-
trical and Computer Engineering in 2005 and his
Ph.D. in 2011 from the Instituto Superior Tcnico
(IST), Lisbon, Portugal,in 2005. From 2011 to 2013
he held a postdoctoral position at the department of
mechanical engineering at the Eindhoven University
of Technology (TU/e), where he is currently an
Assistant Professor.

Hossein Nejat Pishkenari earned his B.Sc., M.Sc.
and Ph.D. degrees in Mechanical Engineering from
the Sharif University of Technology in 2003, 2005
and 2010, respectively. Then he joined the De-
partment of Mechanical Engineering at the Sharif
University of Technology in 2012. Currently, he
is directing the Nano-robotics Laboratory and the
corresponding ongoing research projects in the mul-
tidisciplinary ﬁeld of Nanotechnology.

Aria Alasty received his B.Sc. and M.Sc. degrees
in Mechanical engineering from Sharif University of
Technology (SUT), Tehran, Iran in 1987 and 1989.
He also received his Ph.D. degree in Mechanical en-
gineering from Carleton University, Ottawa, Canada,
in 1996. At present, he is a professor of mechanical
engineering in Sharif University of Technology. He
has been a member of Center of Excellence in
Design, Robotics, and Automation(CEDRA) since
2001. His ﬁelds of research are mainly in Non-
linear and Chaotic systems control, Computational
Nano/Micro mechanics and control, special purpose robotics,robotic swarm
control, and fuzzy system control.

12

