Astronomy & Astrophysics manuscript no. clumpytorus5
August 1, 2019

©ESO 2019

9
1
0
2

l
u
J

0
3

]
E
H
.
h
p
-
o
r
t
s
a
[

1
v
7
3
1
3
1
.
7
0
9
1
:
v
i
X
r
a

X-ray spectral and eclipsing model of the clumpy obscurer
in active galactic nuclei

Johannes Buchner1, 2(cid:63), Murray Brightman3, Kirpal Nandra4, Robert Nikutta5, 1, Franz E. Bauer1, 6, 7

1 Pontiﬁcia Universidad Católica de Chile, Instituto de Astrofísica, Casilla 306, Santiago 22, Chile
2 Excellence Cluster Universe, Boltzmannstr. 2, D-85748, Garching, Germany
3 Cahill Center for Astrophysics, California Institute of Technology, 1216 East California Boulevard,

Pasadena, CA 91125, USA

4 Max Planck Institute for Extraterrestrial Physics, Giessenbachstrasse, 85741 Garching, Germany
5 National Optical Astronomy Observatory, 950 N Cherry Avenue, Tucson, AZ 85719, USA
6 Millenium Institute of Astrophysics, Vicuña MacKenna 4860, 7820436 Macul, Santiago, Chile
7 Space Science Institute, 4750 Walnut Street, Suite 205, Boulder, Colorado 80301

-Received date / Accepted date

ABSTRACT

We present a uniﬁcation model for a clumpy obscurer in active galactic nuclei (AGN) and investigate the
properties of the resulting X-ray spectrum. Our model is constructed to reproduce the column density
distribution of the AGN population and cloud eclipse events in terms of their angular sizes and frequency.
We developed and release a generalised Monte Carlo X-ray radiative transfer code, XARS, to compute X-ray
spectra of obscurer models. The geometry results in strong Compton scattering, causing soft photons to
escape also along Compton-thick sight lines. This makes our model spectra very similar to the Brightman &
Nandra TORUS model. However, only if we introduce an additional Compton-thick reﬂector near the corona,
we achieve good ﬁts to NuSTAR spectra. This additional component in our model can be interpreted as part
of the dust-free broad-line region, an inner wall or rim, or a warped disk. It cannot be attributed to a simple
disk because the reﬂector must simultaneously block the line of sight to the corona and reﬂect its radiation.
We release our model as an Xspec table model and present corresponding CLUMPY infrared spectra, paving
the way for self-consistent multi-wavelength analyses.

1. Introduction
X-ray spectroscopy is a powerful method for charac-
terising the accretion onto supermassive black holes,
even when the accretion disk is hidden behind thick
columns of gas and dust. For the most heavily ob-
scured Compton-thick active galactic nuclei (CT AGN,
NH (cid:38) 1024cm−2) inference on the accretion and nature
of the obscurer requires a correct spectral model for the
obscurer (the ‘torus’). To date, the explored range of
X-ray spectral models has been limited to simple ge-
ometries, while observations have shown that the real
geometry is more complex.

For instance, strong evidence exists today that the
obscurer is clumpy and has a large covering factor.
The former is found through X-ray eclipse events (e.g.
Risaliti et al. 2002; Markowitz et al. 2014), while the
latter is evident from the large fractions of obscured
AGN found in ﬂux-limited X-ray surveys (e.g. Treister
et al. 2004; Brightman et al. 2014; Ueda et al. 2014;
Buchner et al. 2015; Aird et al. 2015). Following the
orientation-only version of the uniﬁcation paradigm
(straw-person model, Antonucci 1993), a single obscur-
ing structure may explain the diversity of obscured and
unobscured AGN as well as eclipse events through sam-
pling diﬀerent viewing angles. However, such a strict
uniﬁcation across all AGN is ruled out because the ac-
cretion luminosity is anti-correlated with the obscured
fraction (e.g. Ueda et al. 2003; Hasinger et al. 2005;
Buchner et al. 2015). In both the infrared and X-ray

(cid:63) johannes.buchner.acad@gmx.com

regime, many studies have therefore attempted to con-
strain the covering factor of individual AGN.

Therefore, physically motivated geometric models
are needed. Early modelling eﬀorts (see e.g. Matt
et al. 2000, and references therein) of the global, low-
resolution X-ray spectra at the time employed simplis-
tic models (e.g.
slab appropriate for cold reﬂection
from accretion disks; Magdziarz & Zdziarski 1995). As
knowledge and capabilities in spectral and spatial res-
olution progressed, more realistic modelling was de-
veloped, allowing reﬁned parameter constraints and
interpretations (e.g. Murphy & Yaqoob 2009; Bright-
man & Nandra 2011a; Ikeda et al. 2009). Studies of
nearby (e.g. Matt 2000, and references therein) and
distant (e.g. Buchner et al. 2014) obscured AGN show
that X-ray spectra are to ﬁrst order consistent with
a photo-electrically absorbed power law, but addition-
ally require varying degrees of Compton-scattering to
ﬁt the generally ﬂat spectra and the ∼ 30keV Compton
hump. This can be seen in the literature, for exam-
ple by many ﬁts preferring the model of Brightman &
Nandra (2011a), BNTORUS, which produces a ﬂat spec-
trum for Compton-thick obscured AGN, similar to that
created by cold disk reﬂection. Some studies even ﬁnd
additional Compton reﬂection beyond this model, with
examples both in individual local AGN (e.g. Arévalo
et al. 2014; Bauer et al. 2015) and large X-ray sur-
veys (e.g. Rivers et al. 2013; Buchner et al. 2014). The
arrival of NuSTAR (Harrison et al. 2013) revealed, in
detail, the complexity of spectral shapes above 10keV
for many local AGN. The analysis of these data is lim-

Article number, page 1 of 15

 
 
 
 
 
 
Simulated X-ray spectra, with geometries shown on top. The left panel presents spectra of a Compton-thick
Fig. 1.
bi-cone cut-out geometry in edge-on view. Liu & Li (2015, shown as (cid:172)) demonstrated that the model of Brightman &
Nandra (2011a, shown as (cid:173)) should not leak soft ((cid:46) 4keV) photons. We obtained with our code XARS (shown as (cid:174)) the
same spectrum as Liu & Li (2015). The right panel compares this uniform density toroid with a gradient toroid (shown
as (cid:175)) and our uniﬁed clumpy model (shown as (cid:176)). The arrow highlights that, unlike the smooth geometry, leakage of
soft photons is possible in the clumpy torus. In the main plots, we removed spectral lines to highlight the continuum
shape. The insets show a zoom around the Fe Kα and β features, normalised at 7.07keV. They feature the strongest
scattering low-energy tails in the (cid:176)uniﬁed clumpy model.

ited by the currently freely available, easy-to-install
X-ray spectral models of AGN obscurers. The two
physically motivated models most commonly used to-
day are:
the BNTORUS model of a bi-conical sphere
cutout, and the ‘donut’ geometry of Murphy & Yaqoob
(2009), MYTORUS. Both assume simple geometries and a
smooth distribution of obscuring material, which can-
not explain AGN with time-variable line-of-sight col-
umn densities, commonly interpreted as cloud eclipse
events (e.g. Risaliti et al. 2002). A few clumpy geome-
try models have been recently proposed (e.g. Liu & Li
2014; Furui et al. 2016), but have not been used to ex-
plain eclipse events. To explore various possible geome-
tries, interest has grown in the availability of Monte
Carlo codes (e.g. Paltani & Ricci 2017; Baloković et al.
2018). An extendable open source Monte Carlo simu-
lation package is not available yet.

To compute X-ray spectra we developed a new
Monte Carlo simulation code, XARS. We begin in §2
by describing this code and basic results for inhomo-
geneous media. In §3 we construct a clumpy, uniﬁed
AGN obscurer model which reproduces (1) the column
density distribution of AGN at various luminosities
and (2) the distribution of cloud eclipse events. Al-
though our initial model spectra produce strong Comp-
ton scattering signatures, in §5 we demonstrate that
we must add another reﬂection component to ﬁt NuS-
TAR data. We interpret this result and discuss phys-
ical origins in §6.2. Finally, we show how our clumpy

obscurer model allows self-consistent infrared & high-
energy studies in combination with Clumpy models
(Nenkova et al. 2008a,b).

2. Computation of X-ray spectra in

inhomogenous media

2.1. Simulation code XARS

We compute the emerging X-ray spectrum for several
torus geometries of interest through Monte Carlo sim-
ulations. We assume that an isotropically emitting
point-source generates photons at the centre of our ob-
scurer geometry. Photo-electric absorption, Compton
scattering and line ﬂuorescence (Fe Kα+Kβ; Kα of
C, O, Ne, Mg, Si, Ar, Ca, Cr and Ni) are simulated
self-consistently as photons pass through matter. The
simulation method has already been described in detail
in Brightman & Nandra (2011a), but we provide some
computational details in §A. Solar abundances (Anders
& Grevesse 1989) are assumed with cross-sections from
Verner et al. (1996).

We make our modular, Python-based simula-
tion code XARS (X-ray Absorption Re-emission Scat-
tering) publicly available at https://github.com/
JohannesBuchner/xars. Users can specify their ob-
scurer geometries by implementing a class which pre-
scribes how photons propagate through the medium,
and easily change the input abundances and emission

Article number, page 2 of 15

100101102Energy [keV]10-410-310-210-1Photon Flux [arb. units]1 Geant4, Liu & Li20152 BNTorus3 1 Liu & Li (2015)2 Brightman & Nandra (2011)3 With our codeHomogeneous density66.57110100101102Energy [keV]10-410-310-210-1Photon Flux [arb. units]3 4 5 ClumpyInhomogeneous density4 Gradient5 Unified Clumpy66.5711060◦Buchner et al.: Clumpy uniﬁed AGN obscurer model

lines without modifying the code. Once the Green’s
functions at each energy grid point and viewing angle
have been computed with adequate signal-to-noise, an
input photon spectrum, for example a powerlaw, can
be applied, and an Xspec grid model compiled.

We veriﬁed our code ﬁrst by comparing with other
implementation. We also veriﬁed generated spectra
from (1) the SPHERE geometry of Brightman & Nan-
dra (2011a) and Liu & Li (2015), discussed below,
(2) disk reﬂection oﬀ a semi-inﬁnite plane-parallel slab
(Magdziarz & Zdziarski 1995), discussed in the Ap-
pendix, (3) reﬂection oﬀ individual spheres (Nandra
& George 1994, see Appendix B) and (4) the biconi-
cal cut-out geometry studied in the next section. As
a benchmark, for a Compton-thick sphere, XARS can
compute very high-quality spectra (109 photons in-
put across 1000 energy bins) in 90 minutes on a single
2GHz laptop CPU, and is trivial to parallelise through
independent executions.

2.2. Inhomogenous geometries leak soft photons

An interesting test case studied in previous works is a
sphere with a biconical cut-out, illustrated in the top
left of Figure 1. The left panel of Figure 1 compares (cid:174)
our results with those of the Geant4-based code of Liu
& Li (2015) ((cid:172), grey thick line). For the spectra shown
in Figure 1 we have chosen an edge-on line of sight with
column density NH = 1024cm−2 and a photon index of
Γ = 1.8, consistent with Liu & Li (2015). We ﬁnd con-
sistent results. In Brightman & Nandra (2011a), the
geometry code erroneously1 let photons back-scattered
from the inner wall escape without considering re-entry
into the torus (cid:173). This aﬀects the geometric inter-
pretability of ﬁts with this model, and potentially the
parameters inferred from jointly ﬁt components. Nev-
ertheless, it is very interesting that across the literature
this model is found to describe observational data well
(e.g., Brightman & Nandra 2011a,b; Rivers et al. 2013;
Buchner et al. 2014; Ricci et al. 2017).

Next we simulated the spectrum of a clumpy model
(similar to Clumpy geometries, see next section for de-
tails). We assume spheres of constant density2. Our
cloud geometry code uses LightRayRider (see Buchner
et al. 2017, for details) with parallelised and optimised
C routines to quickly solve the individual photon paths
through millions of clouds exactly. However, our tests
indicate that beyond 104 clouds, the resulting spec-
trum is not aﬀected any more by the number of clouds.
We generated ∼ 109 photons for each geometry. For
the photons not absorbed inside the obscurer and es-
caping to inﬁnity we record energy and direction. The
LOS column density NH of that direction from the cen-
tral source is then computed, and the photon assigned
to that particular NH and altitude angle bin3. In the
right panel of Figure 1 we plot the energy distribution
of photons emerging from directions with LOS column
densities of NH = 1024cm−2. Photons originally on
paths of lower LOS column densities can be scattered
into the LOS. This leads to a substantial component
of soft photons proportional to the scattering surface

1 J. Buchner & M. Brightman, priv. comm.
2 See Appendix B for the impact of assuming diﬀerent den-
sity proﬁles.
3 The models considered here are azimuthally symmetric.

Fig. 2. Column density distribution and associated cov-
ering fractions produced by our clumpy model. The curves
represent variations of the angular width parameter σ. Ob-
scured fractions from AGN surveys are shown as black and
grey symbols, for bright and faint AGN, respectively. Vary-
ing σ allows a single instance of our model to reproduce the
column density distributions of the population at various
luminosities. Thin grey curves show the comparatively nar-
row column density distributions of a single sphere and a
torus, each with a maximum crossing column density of
NH = 1022cm−2.

(covering fraction) in (cid:176) clumpy torus models, as noted
in previous works (Liu & Li 2014; Furui et al. 2016).
We also consider a smooth torus with gradually varying
density layers (cid:175) reproducing the same column density
distribution.
In contrast to the clumpy model, this
In the
geometry blocks soft photons from escaping.
clumpy model, ﬂuorescent lines are also scattered far-
ther and emerge with strong horns in the spectrum
(inset plot of Figure 1).

3. Clumpy Torus Geometry

3.1. Cloud population geometry from obscured fractions

In principle, the construction of a clumpy obscurer
model has inﬁnite degrees of freedom, as each loca-
tion can have an arbitrary density. To simplify this
problem, we assume symmetry around one axis and
that the obscurer column density is, at least on av-
erage, a monotonic function with decreasing column
density towards the poles. We use the Nenkova et al.
(2008b, N08 hereafter) formalism to describe the dis-
tribution and properties of clouds. In that formalism,
the number of clouds N seen along a radial line-of-
sight is axi-symmetric, and decreases from N0 at the
equatorial plane with inclination angle β towards the
poles, according to a Gaussian function:

(cid:26)

N = N0 · exp

−

(cid:19)m(cid:27)

(cid:18) β
σ

(1)

The angular width, σ, controlling the torus scale height
and the average number of clouds in the equatorial

Article number, page 3 of 15

1020102110221023102410251026Column Density NH0.00.20.40.60.81.0Covering Factor f(>NH)faintBuchner+16Host galaxy subtractedbrightObscured Fractions=85=35=15=5Buchner+15Ricci+16logNH=22 spherelogNH=22 torusrange of preferentially Compton-thin column density
changes (e.g. Risaliti et al. 2002, 2005; Markowitz et al.
2014), and Compton-thick variations have also been
seen when telescopes with good sensitivity and angu-
lar resolution at > 10keV became available (e.g., Ricci
et al. 2016; Marinucci et al. 2016). We therefore allow
a range of values for the column density of individual
clouds, N cloud
. Clouds are placed randomly according
to the distributions (and re-drawn when overlapping).
Fitting the angular width σ, the total number of clouds
and the parameters of a log-normal distribution simul-
taneously, we ﬁnd a suitable ﬁt with 105 clouds with a
1 dex wide distribution centred at 1023cm−2. This is
shown in Figure 2. Varying the angular width σ makes
our model (coloured thick curves) reproduce the col-
umn density distribution of the bright or faint AGN
population (black and grey points, respectively).

H

The radial cloud distribution was assumed to
be uniform across two orders of magnitude. While
the model
is scale-free, we can deﬁne the ratio of
outermost-to-innermost radial distances of clouds, Y =
Rout/Rin. Observations (e.g. Lira et al. 2013; Fuller
et al. 2016; García-Burillo et al. 2016; Ichikawa et al.
2016) indicate that the clouds relevant for the infrared
radiation extend out up to approximately one order of
magnitude farther than the dust sublimation radius,
that is, Y = Rout/Rd ≈ 10 − 20. For X-rays how-
ever, inner ionised clouds4 can also act as absorbers.
We choose Y = 100 for the X-ray model computa-
tion, so that the X-ray obscurer spans two radial orders
of magnitude, while the UV/optical, dusty obscurer
spans only the last magnitude in radial scale (moti-
vated by Tristram & Schartmann 2011 and Markowitz
et al. 2014). For a consistent infrared model, each
cloud outside the sublimation radius can be assigned
an optical depth of τV , related to the column density
/ (cid:0)2 · 1021cm−2(cid:1), the galactic relation-
via τV = N cloud
ship (Predehl & Schmitt 1995; Nowak et al. 2012, see
also Burtscher et al. 2016).

H

3.2. Properties of clouds from eclipse events

Cloud eclipse events provide constraints on the angu-
lar size of individual clouds. In general, the clouds are
observed to be very small in angular extent subtended
at the black hole (∼ 0.1(cid:48) − 1°, Nikutta et al., in prep.).
However, observational biases due to limited observing
periods preferentially select clouds with high angular
velocities and small angular extents. It is furthermore
reasonable to assume that the sizes of clouds show a
powerlaw-like distribution which spans several orders
of magnitude. In other words, we expect the observed
distribution to only cover the low-end tail of the intrin-
sic powerlaw angular size distribution. For simplicity,
we adopt an exponential distribution of the angular
sizes centred around θcloud = 1°, shown in the inset of
Figure 3. This encompasses observed sizes (black his-
togram). The clouds are assumed to be spherical blobs
with diameter Dcloud = d · sin θcloud for a distance d.

Our model is also constructed to reproduce eclipse
event rates. The systematic study of cloud events by
Markowitz et al. (2014) found that the probability to
see a cloud event increases with the number of days be-
tween observations. Figure 3 indicates detected events

4 e.g. those in the broad-line region (BLR)

Predicted rates of eclipses by our model. The
Fig. 3.
probability for an eclipse in a sightline after a given de-
lay is computed, with model clouds on random, circular
Keplerian orbits. The systematic study of eclipse event
rates measured with the RXTE satellite by Markowitz
et al. (2014) are drawn with orange/cyan error bars (type-
1/type-2, respectively), with steps approximating their ob-
servation window function. We analyse two cases: How fre-
quently an obscured sightline becomes more obscured (red
curve) in a high-covering geometry, and how frequently an
unobscured sightline becomes obscured in a low-covering
geometry (dashed blue curve). The eclipse probability in-
creases with the covering factor. The angular diameter dis-
tribution of the model clouds is shown in the inset (blue:
low-covering model, red: high-covering model). Sizes of
individual observed eclipsing clouds are shown as a black
histogram (Nikutta et al., in prep), covering the low-end
tail of the intrinsic distribution.

plane, N0, are free parameters a priori. We follow pre-
vious studies (e.g. N08) which adopted a Gaussian
proﬁle (m = 2). Using an exponential distribution in-
stead does not aﬀect our conclusions.

To narrow down the possible geometries in a re-
alistic way, we ﬁrst attempt to ﬁt the model to sev-
eral known constraints. The ﬁrst constraint applied
is the column density distribution. For luminous
(moderately luminous) AGN, we should reproduce the
fractions of 25% (35%) for NH (cid:38) 1024cm−2 and 30%
(65%) at NH > 1022cm−2 (from Buchner et al. 2015;
Aird et al. 2015; Ricci et al. 2015). These are intrinsic
fractions (observed, but corrected for selection bias)
with the obscuration of the host galaxy subtracted
(see Buchner & Bauer 2017, for details). Simultane-
ously, the obscurer should allow, albeit rarely, column
densities up to NH = 1026cm−2, since sources with
NH > 1025cm−2 are known (e.g. NGC 1068, Matt
et al. 2000). However, when assuming each cloud has
the same column density, the column density distribu-
tion produced by Equation 1 is too narrow.

Widening the model column density distribution
can be achieved by allowing at a given luminosity a
diversity of opening angles or by giving the clouds a
diversity in column densities. We choose the latter op-
tion, as we prefer to remain with a uniﬁcation model.
Additionally, absorber variability studies show a wide

Article number, page 4 of 15

101102103Time [days]104103102101100Eclipse probabilityRXTE Sy1 eclipsesRXTE Sy2 eclipsesUnobsc LOS eclipsed (Model =15)Obsc LOS eclipsed (Model =40)2011'1''110100100010000ModelObservations ×2Cloud angular size distributionBuchner et al.: Clumpy uniﬁed AGN obscurer model

Fig. 4. Cross-sections of clumpy torus model. The left and right geometries diﬀer in the vertical extent σ, which controls
the Gaussian distribution away from the equatorial plane. The red cross indicates the central point source. The clouds
vary in size and column density (darkness). A ﬂy-through video is available at https://doi.org/10.5281/zenodo.602282.

(error bars) and the sensitivity of their survey based
on their windowing function (steps), taken from their
Figure 7. The frequency of events in type 1 (cyan)
and type 2 (orange) appear to approximately follow a
power law relation. To predict such observables from
our clumpy geometry, we assume for simplicity circu-
lar Keplerian orbits on random planes of orientation.
We set the orbital period of the innermost cloud to
one day, which for the outer-most clouds translates to
a period of eight years. The corresponding distances5
are consistent with observationally inferred distances
(approximately light days, see Markowitz et al. 2014,
for a review of constraints). We then advance all or-
bits by a time ∆t (x-axis) and determine what fraction
of 20,000 random viewing sight-lines change column
density signiﬁcantly (for type-1: unobscured become
obscured, for type-2: obscured at least double the col-
umn; obscured refers to the NH = 1022cm−2 thresh-
old). Because of the diﬀerent sample selection, we do
not assume the same σ values as in Figure 2. Instead,
we assume that type-2 detections are more likely to be
created in a more covered torus (σ = 40° gives the best
ﬁt) than type-1 AGN (σ = 15°). The slope and eclipse
event rates of type-1/type-2 AGN are reproduced, as
Figure 3 demonstrates. When reproducing the data
of Markowitz et al. (2014) in Figure 3, we were free
to chose the clumpy model parameter σ and the time
normalisation. These control the normalisation in the
y and x-axis, respectively. The key result is however
that a powerlaw over suﬃcient orders of magnitudes
is predicted, with the correct slope. This result stems
from the combination of our assumed exponential an-
gular size distribution and our wide range in distances
for the clouds (Y = 100) leading to a wide range of
orbital and eclipse durations.

A visualisation of our model is presented in Fig-
ure 4. This shows a cross-section through the verti-

5 The
inner most
42 au (cid:0)MBH/107M(cid:12)

(cid:1)1/3.

cloud has a orbital

radius of

Compton-thick cloud ring around central point
Fig. 5.
source (red). Here six touching clouds are shown, with a
second row of gap-ﬁlling clouds. This conﬁguration has a
covering factor of 30%. Our model allows variations in the
covering factor between 0% (no cloud ring) and 60% (3
touching inner clouds).

cal mid-plane for the two models with angular widths
σ = 15° and 40°. Table 2 in the appendix summarises
the assumptions and parameters of our clumpy model.

3.3. Final model geometry with optional inner ring

However, the clumpy model constructed above cannot
ﬁt some local heavily obscured AGN. As discussed be-
low and in more detail in a companion paper, a highly
covering, high-column density (NH (cid:38) 1025cm−2) re-
ﬂector is necessary to reproduce the narrow high-
energy Compton hump of some local heavily obscured
AGN, as traced by 8 − 10 − 20keV X-ray colours (see
Buchner et al., in prep). Brieﬂy speaking, the clumpy
structure is composed of a wide range of column densi-
ties, together producing a broad Compton hump. See
Appendix B for further details regarding the spectrum
of reﬂection oﬀ individual clouds, as well as earlier
work by Nandra & George (1994). Introducing an ac-
cretion disk that provides reﬂection to the powerlaw
spectrum proved ineﬀective, because both the intrin-
sic and reﬂected emission is strongly attenuated by the
torus. Instead, a reﬂecting mirror is needed that has
a virtually unobscured sight-line both to the corona
and the observer, while the sight-line between observer
and corona is obscured. To address this, we introduce
into our clumpy model an optional Compton-thick ob-

Article number, page 5 of 15

σ=15◦20212223242526Cloud column densityσ=40◦viewing angles. Towards the Compton-thick regime, a
scattering component appears and allows soft photons
to escape. Higher column densities also create a deeper
trough at ∼ 10keV relative to the Compton hump. The
trough also becomes deeper with C, as comparing solid
and dashed black curves reveals. In a companion pa-
per, Buchner et al. (in prep.), we explore this trough
in detail with a 8 − 10 − 20keV X-ray colour-colour di-
agram. There we show that local Compton-thick AGN
show remarkably ﬂat spectra at 8 − 10keV, similar to
the dashed red curve in Figure 6, which are diﬃcult
to reproduce by existing models. We demonstrate this
below in §5.

4.2. X-ray spectral model release

We release our spectral model, UxClumpy (Uniﬁed
X-ray Clumpy model), as an Xspec table model for
download at https://doi.org/10.5281/zenodo.602282.
The parameters of the model are listed in Table 1.

The model can be used as follows in Xspec syntax:

model a t a b l e { uxclumpy . f i t s }

The model also allows for an exponential high-energy
cut-oﬀ to more realistically represent the X-ray contin-
uum. This, and the addition of other components, can
make model ﬁtting more degenerate and create mul-
tiple local optima in parameter space. Therefore, we
recommend to initially freeze Ecut to the maximum
value. Once a reasonable ﬁt has been obtained, con-
straining Ecut can be attempted. Unrealistic ﬁts show
low photon indices (Γ < 1.4) and low energy cut-oﬀs
to mimic a Compton hump.
Compared to previous

(e.g.
BNTORUS, MYTORUS), there are some important diﬀer-
ences:

spectral models

(1) The meaning of NH and viewing angle: In our
model, the NH ﬁtting parameter is the LOS column
density. A given geometry (TORsigma, CTKcover) pro-
duces a diversity of LOS column densities. To under-
stand the implications of the NH and Theta_inc pa-
rameters better, a few technicalities should be men-
tioned: For each simulated photon escaping to inﬁnity,
its direction is noted. For the same direction from the
X-ray point source, the LOS column density is com-
puted. The photon is then placed in a bin correspond-
ing to column density and viewing angle (0-30°: face-
on, 30-60°: intermediate, 60°-90°: edge-on). This bin-
ning scheme partitions the sky around the corona
by column density and viewing angle. In practice,
this makes spectral ﬁtting easier, as the LOS column
density is the primary inﬂuence on spectral shape. Fur-
thermore, physically meaningful ﬁts of column density
variations over multiple observation epochs are possi-
ble: Unlike existing models, it is not required that the
geometry (or equatorial torus column density) changes
from source to source, or from observation to obser-
vation, or that the viewing angle changes drastically.
Instead, multiple LOS column densities are possible at
very similar viewing angles, allowing realistic eclipse
events by slight rotation self-consistently in our model.
We recommend that multi-epoch ﬁts keep the geome-
try constant, but allow variations in NH.

(2) Opening angles: A key geometric parameter of
torus models is the opening angle, θop. In our model,
the inner Compton-thick covering, CTKcover, can be

Fig. 6. Clumpy model spectra. Viewing angles (dashed
& solid lines) and LOS column densities (labelled at their
respective turn-overs energies) gives diversity in spectral
shapes. The highest column density, NH = 1026cm−2 is
shown in red. The lines present typical face-on viewing an-
gles (dotted lines, preferentially low column densities, 0°)
and edge-on viewing angles (solid and dashed lines, prefer-
entially high column densities, 90°). The dashed lines have
the inner ring described in §3.3 enabled.

scurer. While there are multiple equally satisfactory
geometries one could choose for this component, for
computational eﬃciency we compose it also of spheres.
As illustrated in Figure 5, two rings of Compton-thick
clouds, just touching each other, form a thick donut.
The covering fraction, C, determines the radius and
number of touching inner clouds used (three to six-
teen). This component remains optional so that its
presence can be tested by parameter ﬁtting. The dis-
cussion section §6.2 covers physical interpretations of
this component.

We compute our ﬁnal,

two-component clumpy
model grid across two parameters: (1) the dispersion
of the cloud population, TORsigma σ, and (2) the cov-
ering factor of the Compton-thick inner ring, CTKcover
C, by changing the number of clouds. For computa-
tional eﬃciency, and because the X-ray spectrum re-
mains largely uneﬀected by this choice, we reduce the
number of clouds by a factor of ten to Ntot = 105
and proportionally increase their angular area, setting
10 · 1° ≈ 3°. Column density distribu-
θcloud =
tions and cloud eclipse predictions when this compo-
nent is included are shown in Figure C.1 in the ap-
pendix. To achieve a smoother column density distri-
bution we also altered the cloud log-normal distribu-
tion to N cloud

= 1023.5±1.0cm−2.

√

H

4. X-ray spectral model

4.1. Model spectrum

Figure 6 presents various spectra produced by one
model geometry σ = 30°. We input a powerlaw source
of photon index Γ = 2 without a high-energy cut-oﬀ.
Five LOS column densities are shown, as well as two

Article number, page 6 of 15

100101Energy [keV]104103102101100Photon Flux [arb. units]1020cm2NH=1022cm2NH=1023.5cm2NH=1024.5cm2NH=1026cm2face-onedge-onedge-on, C=0.5Table 1. Clumpy model spectral parameters.

Buchner et al.: Clumpy uniﬁed AGN obscurer model

Name

Symbol

PhoIndex
Ecut

Γ
Ecut

NH

NH(LOS) 1020−26

1 − 3

Range

Description
Photon index
60 − 400 Energy cut-oﬀ
[keV]
Total LOS
column density
[cm−2]
Cloud dispersion
Covering fraction
of inner ring
Viewing angle

6 − 90°
0 − 0.6

0 − 90°

TORsigma
CTKcover

σ
C

Theta_inc θinc

directly interpreted as a covering factor for that com-
ponent. The cloud population has however a fuzzy
opening angle boundary, which is deﬁned by the an-
gular width σ from the plane where the LOS num-
ber of clouds decrease to their 1σ value. The cor-
responding opening angle depends on the considered
column density and can be read oﬀ Figure 2. Our an-
gular width deﬁnition is consistent with the existing
Clumpy model deﬁnition (see §6.1). In the BNTORUS
model, the opening angle Θtor can change slightly the
Compton hump of that model, and this has been used
in some studies to constrain the torus opening angle.
In our model, the CTKcover parameter provides a more
powerful, geometrically consistent way to probe the re-
ﬂector geometry. Unfortunately, there exists no simple
geometry mapping between the models, as the best-
matching photon index is diﬀerent at the correspond-
ing LOS column densities.

4.3. Warm mirror component

Absorbed AGN spectra frequently show excess soft
photons. This can be interpreted as a warm mirror:
hot electrons Compton scattering the intrinsic power-
law past the obscurer (e.g. Matt et al. 2000; Bianchi
et al. 2006, 2010; Brightman et al. 2014). Frequently
this component is simply modelled as a powerlaw with
the same photon index as the intrinsic powerlaw but a
fraction of the normalisation, following the Thomson
scattering approximation. In Xspec, this can be added
with:

model a t a b l e { uxclumpy . f i t s }+c o n s t ∗ zpower

The parameters of the additional powerlaw should be
set to the same values as that of the UxClumpy ob-
scurer model.

However, if the warm mirror is volume-ﬁlling inter-
clump hot gas or the narrow-line region, the spectrum
is probably more complex, combining warm (hot gas)
and cold reﬂection (dense clouds). As an improved ap-
proximation, we sum the emission over all angles (4π)
for each geometry. To ﬁrst order, this angle-averaged
spectrum is a powerlaw, because it is dominated by
photons escaping without absorption. To second order,
a mild Compton hump and Fe K feature are present,
as in the unobscured sight-lines in Figure 6. To rep-
resent the warm mirror more accurately, we provide
a second table model that can be added instead of a
simple powerlaw:

model

a t a b l e { uxclumpy . f i t s } +
c o n s t ∗ a t a b l e { uxclumpy−s c a t t e r e d . f i t s }

NuSTAR observations of Circinus ﬁtted with
Fig. 7.
clumpy torus model without inner ring component. For
visualisation, the data are binned here to 1000 counts and
deconvolved with the model. Additionally, a warm mirror
component (orange dotted line, see §4.3) and lines at rest-
frame energy 6.5 and 7.1keV were added to the ﬁt. The best
ﬁt has a LOS column density of NH = 3 × 1024cm−2 and
a photon index of Γ = 1.69. This model rises already at ∼
8keV and produces a shallow Compton hump. In contrast,
the data remain ﬂat until 10keV before rising steeply. This
leads to substantial systematic residuals (positive at 6keV,
negative at 10keV, positive at 20 − 30keV) in the lower
panel.

All table parameters of the angle-averaged table model
(uxclumpy-scattered, warm reﬂected component)
should be linked to their counterparts in the obscurer
model (uxclumpy, which includes transmitted and cold
reﬂected component). The relative normalisation con-
stant should not exceed ∼ 10% to avoid ambiguous
powerlaw shapes and unrealistic scattering eﬃciencies.
Additional galactic and warm absorption layers can be
added on top as usual.

5. Fitting local Compton-thick AGN

The nearby Seyfert 2 Circinus Galaxy (hereafter Circi-
nus) is a prototypical Compton-thick AGN, and due
to its proximity has X-ray observations of the nucleus
with high signal-to-noise ratios and spatial resolution
(see Arévalo et al. 2014, for a recent analysis). The
NuSTAR spectrum was extracted following standard
procedures with the NuSTAR pipeline (see Brightman
et al. 2015, for details).

First, we disable the inner ring component (C = 0,
see §3.3). Figure 7 presents the best ﬁt6 of this sim-
ple clumpy model. In the NuSTAR data the Comp-
ton hump begins to rise at relatively high energies
(∼ 10 keV), with the model producing a shallower
Compton hump. This is caused by the diversity of
In low column
clouds creating Compton reﬂection:
density clouds, singly and doubly Compton scattered

6 We use the X-ray ﬁtting tools Xspec (Arnaud 1996),
and Sherpa (Freeman et al. 2001) with BXA (Buchner et al.
2014), bin spectra to 20 counts, and employ χ2 statistics.

Article number, page 7 of 15

103102Energy flux [#/cm2/s]Clumpy model without inner ring (C=0) vs CircinusTotal modelSimple clumpy torusWarm mirrorNuSTAR data4681020304060Energy [keV]0.751.001.25data/modelLeft panels: Clumpy torus model ﬁt of Circinus, NGC 424 and ESO 103-G035 NuSTAR observations,
Fig. 8.
respectively. In each case a reasonable ﬁt (black line) is obtained with our uniﬁed clumpy torus model including an inner
ring (see §3.3). We added a Thomson scattered component (see Section §4 for details), which contributes substantially
in Circinus. Right panels show constraints on the geometry parameters of the inner ring (CTK covering factor, y-axis)
and the cloud population (σ, x-axis), within the allowed ranges of our model. High Compton-thick covering factors are
preferred for all three sources.

Article number, page 8 of 15

103102Energy flux [#/cm2/s]UxClumpy model (with inner ring)vs CircinusTotal modelClumpy torusWarm mirrorNuSTAR data4681020304060Energy [keV]0.751.001.25data/model620406090Cloud population 0%20%40%60%CTK Covering Factor Cmost probable fit1 sigma equiv. uncertainty2 sigma equiv. uncertainty105104103Energy flux [#/cm2/s]UxClumpy model (with inner ring)NGC 424Clumpy torusNuSTAR data3681020304060Energy [keV]0.51.01.5data/model620406090Cloud population 0%20%40%60%CTK Covering Factor Cmost probable fit1 sigma equiv. uncertainty2 sigma equiv. uncertainty103Energy flux [#/cm2/s]UxClumpy model (with inner ring)ESO 103-G035Clumpy torusNuSTAR data3681020304060Energy [keV]0.51.01.5data/model620406090Cloud population 0%20%40%60%CTK Covering Factor Cmost probable fit1 sigma equiv. uncertainty2 sigma equiv. uncertaintyBuchner et al.: Clumpy uniﬁed AGN obscurer model

emission can escape. High column density clouds lead
to self-absorption and a trough at 8 − 15 keV. In Ap-
pendix B we discuss the reﬂection spectra arising from
single clouds in more detail. We ﬁnd similar results
with other Compton-thick AGN (NGC 1068, NGC 424,
NGC 3393), and discuss this problem in more detail
in a companion paper, using a X-ray colour-colour di-
agnostic to characterise Compton hump shapes. The
spectral shape mismatch results in a poor ﬁt (χ2/dof =
2774/1703 ≈ 1.6). A “pure” high-column density re-
ﬂector dominating over all contamination by lower col-
umn density reﬂectors (the majority of our current
cloud population) is needed. We anticipated the need
for such a component in §3.3. To reduce strong line
residuals distracting from the main point of Figure 7,
we included additional gaussian lines. While our model
already includes line emission, extended line emission
from beyond the torus ((cid:29)10pc) is known in this source
(Arévalo et al. 2014). Our results and conclusions are
consistent with and without these additional lines.

We now reﬁt the data, with the inner ring com-
ponent enabled. The ﬁt is much better (χ2/dof =
1765/1714 ≈ 1.0, top left panel in Figure 8), with the
residuals (lower panel) not showing systematic devia-
tions. The best-ﬁt has a photon index of Γ = 2.11, as-
suming no energy cut-oﬀ, behind a line-of-sight column
density of NH(LOS) = 4×1024cm−2. Because the NuS-
TAR extraction region exhibits substantial contamina-
tion by other X-ray sources (Arévalo et al. 2014), we
now focus on ﬁtting only the ≥ 8 keV energy range
to derive physical properties of the reﬂector. In this
case, we ﬁnd a photon index of Γ = 1. 81 ± 0. 10,
behind a line-of-sight column density of NH(LOS) =
-16 × 1024 cm−2. The high-energy cutoﬀ uncertain-
31+25
ties, Ecut = 209 ± 69, are degenerate with those of Γ.
Importantly, we are able to constrain the geometry of
the obscurer (contours in top right panel of Figure 8).
The clumpy component has a covering angle σ below
45°, and the Compton-thick covering factor of the in-
ner ring is C > 40%, that is, the corona is extensively
covered by Compton-thick material.

To study the soft energy AGN emission as well,
we consider NGC 424. Other nearby Compton-thick
AGN (such as Circinus) are often contaminated by
nearby sources in the host galaxy, such as supernova
remnants, ultraluminous X-ray sources and X-ray bi-
naries. NGC 424 is much more luminous than Circi-
nus and therefore its nuclear emission dominates over
such host galaxy contaminants. The soft energies show
no contamination in XMM-Newton observations down
to energies of ∼ 3keV (Marinucci et al. 2011). The
middle left panel of Figure 8 presents our best ﬁt to
NuSTAR spectra in the 3 − 65keV range. The ﬁt is
of good quality (χ2/dof = 84/79 ≈ 1.1) and gives a
photon index of Γ = 2. 29 ± 0. 14 without the need
for a high-energy cutoﬀ (parameter unconstrained).
Such a high photon index is expected from this high-
Eddington accretion rate source (Lbol/LEdd ≈ 0.1,
Bian & Gu 2007; Brightman et al. 2013, 2017). This X-
ray emitter is behind a line-of-sight column density of
NH(LOS) = 26+25
-20 × 1024 cm−2. We are able to con-
strain the geometry of the obscurer (contours in the
centre right panel of Figure 8): The clumpy component
has a covering angle σ < 60°, and the Compton-thick
covering factor of the inner ring is C > 30%.

We further consider ESO 103-G035, a Compton-
thin source. The NuSTAR spectrum of this source
is soft without strong obscuration or host contamina-
tion, therefore we consider the entire NuSTAR spec-
trum (3 − 70 keV). The bottom left panel of Fig-
ure 8 shows our best ﬁt for this source, which is again
of good quality (χ2/dof = 978.58/1020 ≈ 0.96) and
gives a photon index of Γ = 1. 84 ± 0. 04 with a high-
energy cutoﬀ Ecut = 209 ± 69. This X-ray emitter
is behind a line-of-sight column density of NH(LOS) =
(1. 6 ± 0. 1) × 1023 cm−2. We are also able to constrain
the geometry of the obscurer in this case (contours in
the bottom right panel of Figure 8): The clumpy com-
ponent has a covering angle σ > 60° under a face-on
viewing angle and the Compton-thick covering factor
of the inner ring is C = 28 ± 7 %.

All three spectra prefer large covering fractions
of the high-column density inner ring reﬂector.
In
Compton-thick AGN the cloud population, by means
of low σ values, tends to be hidden away in the shadow
of this inner ring, avoiding low-column density reﬂec-
tion. Indeed, the emerging spectrum and ﬁts change
insigniﬁcantly when the torus clumps are removed
(σ = 0).
In Compton-thin AGN, the cloud popula-
tion provides the Compton-thin line-of-sight absorber,
while the inner ring is again signiﬁcantly needed as a
Compton-thick reﬂector.

6. Discussion

We have presented a clumpy torus model geometry,
UxClumpy, from which we simulate X-ray spectra.
UxClumpy provides (1) a wide coverage of energies
(0.1 − 1000keV), (2) a wide range of LOS column den-
sities (1020−26cm−2), (3) a variable energy cut-oﬀ and
(4) ﬂuorescent emission lines self-consistently. Addi-
tionally, the clumps in our geometry reproduce the
frequency, duration and sizes of eclipse events and X-
ray eclipse event observations can be modelled self-
consistently without requiring a drastic change in the
viewing angle.

The spectral shapes around the Compton hump
and trough above the Fe edge diﬀer for the various
geometries and viewing angles, and are diverse (see
Figure 6). We additionally compute a better approxi-
mation of the warm mirror component. Overall how-
ever UxClumpy produces spectral shapes similar to
the BNTORUS model, which has been found to ﬁt obser-
vations well. The added beneﬁt of UxClumpy is the
ability to infer novel physical characteristics from the
spectral ﬁts and consider the energy cut-oﬀ. Below we
discuss the multi-wavelength spectrum of our model
and interpret our inner ring component.

6.1. Multi-wavelength Spectrum

Infrared and X-ray data can be self-consistently anal-
ysed under our clumpy geometry model, by construc-
tion. The emerging infrared model was computed us-
ing CLUMPY (Nenkova et al. 2008a,b) and is de-
picted in Figure 9. CLUMPY performs probabilistic
ultraviolet-optical-infrared radiative transfer. This ap-
proximation requires that the volume ﬁlling factor is
small (< 10%) and the cloud sizes are small, which is
the case given our assumed small angular sizes.

Article number, page 9 of 15

Fig. 9. Multiwavelength spectrum of our uniﬁed clumpy geometry. The clumpy torus with σ = 30° (left panel of 4)
is seen through a obscured, Compton-thick line-of-sight either edge-on (red) or face-on (blue). Dashed lines indicate the
case of a unobscured view of the accretion disk.

Table 2. Model parameters.

Description
Total number of clouds
Vertical distribution
Vertical dispersion
Radial distribution
Radial extent
Cloud sizes
Column density of clouds
Number of clouds (plane)
Volume ﬁlling factor
Cloud mean optical depth

Distribution Parameter

ﬁxed
Gaussian
variable
uniform
ﬁxed
Exponential
Log-Normal
(from above)
(from above)
(from above)

Ntot
m
σ
q
Y
θcloud
N cloud
H
N0
fV
τV

Value
105
2
6°- 90°
0
100 (X-ray), 10 (IR)
1°
1023.5±1.0
2 − 9
2 − 5%
150

Determined from
Column density distribution
Column density distribution
Column density distribution
Assumed
Assumed
Eclipsing events
Column density distribution
Computed
Computed
Assuming Galactic relation

Table 2 presents the model parameters and assump-
tions that went into constructing our clumpy cloud
population. For a self-consistent physical model in
the infrared, the Clumpy torus parameters should be
set as follows (see Table 2): Y ≈ 10 − 20 (< 100),
σ = TORsigma, N0 = 2 − 5 (depending mildly on σ),
q = 0, and τV ≈ 120 − 160.

Figure 9 presents the X-ray model spectrum with
the reprocessed infrared emission from the . We nor-
malised at 12µm and use the empirical ratio of 1.7
between the 12µm and intrinsic 2 − 10 keV luminosity
(e.g. Asmus et al. 2015). In the optical and ultraviolet
the intrinsic AGN disk emission dominates along un-
obscured sight-lines (dashed lines in Figure 9). At long
wavelengths, the reprocessed emission is gray-body-like
and dominated by the coldest dust regions. In the mid-
infrared, self-absorption in edge-on systems hides the
hot inner dust emission, while face-on views expose a
range of temperatures. The silicate feature is visible
around 10 and 18µm. In the X-ray regime very ener-
getic photons can penetrate the obscurer and escape.
Between ∼ 0.2 − 1nm a tail of soft photons circum-
vents the line-of-sight obscurer by being reﬂected oﬀ
In addition to the continuuum, K
distant material.
shell ﬂuorescence features are clearly visible, the most
prominent being Fe K.

We now attempt a multi-wavelength ﬁt of the
obscurer from X-rays to infrared. To illustrate the

clumpy obscurer, we select NGC 1365, notorious for
changing its LOS column density several times over
time-scales of days to years (e.g., Risaliti et al. 2005,
2007; Rivers et al. 2015). A successful model should
allow the obscurer geometry and inclination to stay the
same with only small changes in the sight-line to the
corona. Simultaneously, we expect the same geometry
to also ﬁt the infrared photometry. Archival photo-
metric data (McAlary et al. 1983; Skrutskie et al. 2006;
Ramos Almeida et al. 2009; Asmus et al. 2014, we im-
posed a 10% minimum ﬂux uncertainty) and NuSTAR
spectra (Rivers et al. 2015, ObsIDs 60002046005,7,9;
5-77 keV) are presented in Figure 10.
In the three
observations (blue, orange, green) in the left of Fig-
In the
ure 10, the spectra diﬀer noticibly in shape.
insets, the UxClumpy parameter probability distri-
butions of a ﬁt to each spectrum are shown with cor-
responding colours. Fitting the infrared photometry
with CLUMPY leads to two solutions, shown in brown
dashed and purple dot-dashed curves. The parame-
ter distributions are again shown in the insets. We
compare the solution shown in brown, with a face-
on inclination i < 20◦, a substantial torus thickness
σ > 30◦ (see central insets of Figure 10) to the con-
straints from the X-ray ﬁts (or assumed UxClumpy
parameters shown in the right insets). Overall, the de-
rived parameters are compatible. This allows the inter-
pretation that a clumpy structure surrounds NGC 1365

Article number, page 10 of 15

106105104103102101100101102103Wavelength [m]104103102101100101Torus Energy Flux densityAGN TorusEdge-onFace-onX-rayUnobscured AGNInfraredBuchner et al.: Clumpy uniﬁed AGN obscurer model

Fig. 10. Multiwavelength ﬁt of our uniﬁed clumpy geometry to data of NGC 1365. Infrared photometry on the left
overlayed with two CLUMPY ﬁt solutions, and spectra from three NuSTAR observations are shown on the right with
UxClumpy ﬁts. Insets show parameter probability distributions for each ﬁtted dataset in corresponding colours. The
infrared ﬁt solution shown in brown is overall compatible with the X-ray ﬁts (blue, green, orange).

whose inner-most clouds vary the X-ray column den-
sity and whose outer, dusty clouds irradiate in the in-
frared. A single geometry, with the same inclination
angle was able to simultaneously reproduce column
density variations over time and the broad-band X-
ray to infrared spectral energy distribution. However,
the presented ﬁt does not model all of the complexities
present in the data. For example, the least obscured
spectrum (orange) shows complex, warm absorption
(see Rivers et al. 2015). Additionally, in other variable-
obscuration sources we ﬁnd that a multi-wavelength ﬁt
gives incompatible geometry constraints, perhaps indi-
cating that the structures diﬀer. This indicates that
further modelling is needed and will be addressed in
future work.

6.2. Interpretation of the inner ring component

When the inner ring component is present, the X-ray
spectrum around the Compton hump is similar to pure
cold reﬂection (e.g. oﬀ an inﬁnitely thick slab, or a
smooth donut). In the literature such a bulged compo-
nent has been proposed and interpreted for a variety
of reasons.
It could be a Compton-thick cloud wind
launch site (Krolik & Begelman 1988), an inner wall
(Lightman & White 1988) or a puﬀed up inner rim of
a hot disk as seen in proto-planetary disks (Dullemond
et al. 2001; Dullemond & Monnier 2010). The spectral
shapes are also similar to the spectrum of a warped
disk (see Buchner et al., in prep), and can also be in-
terpreted as one. This is probably the most suitable
interpretation for Circinus, where an edge-on maser
disk is seen (Greenhill et al. 2003). In the companion
paper Buchner et al. (in prep), a warped disk model
provides the best ﬁt.

For compatibility with CLUMPY IR models, we
can assume that the inner Compton-thick reﬂector is
dust-free and does not contribute signiﬁcantly to the
infrared spectrum (see simulations of Gallagher et al.
2015, for a component of similar column density). In
this case,
if it is interpreted as part of a dust-free
broad emission line region, very smooth line proﬁles
do not necessitate that it has further discrete clumpy
substructure (e.g., Laor et al. 2006). Alternatively, a
similar inner ring component was introduced by Pier &
Krolik (1993) to explain the observed, hot (∼ 1300K)
dust component (see Netzer 2015, for a review); see
also Kishimoto et al. (2011) and Hönig et al. (2012)
who considered transferring the “puﬀed-up inner rim”
model from proto-planetary disks (Dullemond et al.
2001; Dullemond & Monnier 2010) to AGN.

Recent interferometric observations in the mid-
infrared indicate that the dust emission is in several
sources primarily polar with respect to the disk (As-
mus et al. 2016; Tristram et al. 2014). Incorporation of
these results goes beyond this work. However, clumpy
geometries that address these can be calculated rapidly
with our XARS code.

7. Conclusion

We constructed a clumpy model for the obscurer of
AGN which reproduces 1) the column density distri-
bution of the AGN population and 2) observed cloud
eclipse events. However, when applying the clumpy
model to several nearby, heavily obscured AGN, we
ﬁnd diﬀerences between the observed NuSTAR spec-
tra and the model, in particular in the energy region
between the Fe K edge and the Compton hump. To
resolve this, it is necessary to insert close to the corona

Article number, page 11 of 15

104103102101100101102Wavelength [m]103102101F [Jy/m]2012-122013-012013-02X-rayInfrared0.00.5C1.52.020.022.5logNH2080i0459030100300V0.02.5q51015N050100Y10121013101410151016101710181019Frequency [Hz]a Compton-thick reﬂector with a substantial covering
factor. This new inner component could be interpreted
as an inner rim, or a warped or bulged disk. It cannot
be attributed to reﬂection oﬀ a simple disk because the
reﬂector must simultaneously block the line of sight to
the central engine and reﬂect it.

The need for the inner Compton-thick reﬂector
(from X-ray spectral ﬁts) and the need for the clumpy
component (from eclipses and infrared observations)
together could imply three classes of AGN of increas-
ing inclination angle: 1) Unobscured; 2) Obscured by
clumps; and 3) Heavily obscured by the inner reﬂec-
tor. The former two can have strong Compton reﬂec-
tion from the inner ring and show eclipses. The lat-
ter is reﬂection-dominated and may produce Compton-
thick column density variations (as seen for instance in
NGC 1068, Marinucci et al. 2016).

We have developed a powerful Monte Carlo X-ray
radiative transfer code, XARS, which can deal with arbi-
trary geometries. We release this open source software
at https://github.com/JohannesBuchner/xars.

We release our UxClumpy model as Xspec tables
available at https://doi.org/10.5281/zenodo.602282.
The spectral model is similar in its ease of use, pa-
rameters and spectral shape as the popular BNTORUS
It also allows a physical interpre-
model (see §4).
tation of the underlying geometry including covering
factors and enables self-consistent analysis of variable
column densities (see also Simm et al. 2018). We also
note that our geometry has corresponding CLUMPY
infrared spectra7, paving the way for self-consistent
multi-wavelength analyses.

8. Acknowledgements
We thank the anonymous referee for careful reading
of the manuscript and their insightful comments. JB
thanks Marc Schartmann and Leonard Burtscher for
discussions on tori in the infrared. JB thanks Eva
Lefa for sharing her Monte Carlo code to verify our
Compton scattering implementation. JB thanks Mis-
lav Baloković for insightful conversations.

We acknowledge support from the CONICYT-
Chile grants Basal-CATA PFB-06/2007 & AFB-
170002 (JB, FEB), FONDECYT Regular 1141218
(FEB), FONDECYT Postdoctorados 3160439 (JB)
and the Ministry of Economy, Development, and
Tourism’s Millennium Science Initiative through grant
IC120009, awarded to The Millennium Institute of As-
trophysics, MAS (JB, FEB). This research was sup-
ported by the DFG cluster of excellence “Origin and
Structure of the Universe”.

References

Aird, J., Coil, A. L., Georgakakis, A., et al. 2015, ArXiv e-prints
Anders, E. & Grevesse, N. 1989, Geochim. Cosmochim. Acta,

53, 197

Antonucci, R. 1993, ARA&A, 31, 473
Arévalo, P., Bauer, F. E., Puccetti, S., et al. 2014, ApJ, 791, 81
Arnaud, K. A. 1996, in Astronomical Society of the Paciﬁc Con-
ference Series, Vol. 101, Astronomical Data Analysis Software
and Systems V, ed. G. H. Jacoby & J. Barnes, 17

Asmus, D., Gandhi, P., Hönig, S. F., Smette, A., & Duschl,

W. J. 2015, MNRAS, 454, 766

Asmus, D., Hönig, S. F., & Gandhi, P. 2016, ApJ, 822, 109

7 Available at https://www.clumpy.org

Asmus, D., Hönig, S. F., Gandhi, P., Smette, A., & Duschl,

W. J. 2014, MNRAS, 439, 1648

Baloković, M., Brightman, M., Harrison, F. A., et al. 2018,

ArXiv e-prints

Bauer, F. E., Arévalo, P., Walton, D. J., et al. 2015, ApJ, 812,

116

Bian, W. & Gu, Q. 2007, ApJ, 657, 159
Bianchi, S., Chiaberge, M., Evans, D. A., et al. 2010, MNRAS,

405, 553

Bianchi, S., Guainazzi, M., & Chiaberge, M. 2006, A&A, 448,

499

Brightman, M., Baloković, M., Ballantyne, D. R., et al. 2017,

ArXiv e-prints

Brightman, M., Baloković, M., Stern, D., et al. 2015, ApJ, 805,

41

Brightman, M. & Nandra, K. 2011a, MNRAS, 413, 1206
Brightman, M. & Nandra, K. 2011b, MNRAS, 414, 3084
Brightman, M., Nandra, K., Salvato, M., et al. 2014, MNRAS,

443, 1999

Brightman, M., Silverman, J. D., Mainieri, V., et al. 2013, MN-

RAS, 433, 2485

Buchner, J. & Bauer, F. E. 2017, MNRAS, 465, 4348
Buchner, J., Georgakakis, A., Nandra, K., et al. 2015, ApJ, 802,

89

Buchner, J., Georgakakis, A., Nandra, K., et al. 2014, A&A,

564, A125

Buchner, J., Schulze, S., & Bauer, F. E. 2017, MNRAS, 464,

4545

Burtscher, L., Davies, R. I., Graciá-Carpio, J., et al. 2016, A&A,

586, A28

Dullemond, C. P., Dominik, C., & Natta, A. 2001, ApJ, 560, 957
Dullemond, C. P. & Monnier, J. D. 2010, ARA&A, 48, 205
Freeman, P., Doe, S., & Siemiginowska, A. 2001, in Society of
Photo-Optical Instrumentation Engineers (SPIE) Conference
Series, Vol. 4477, Society of Photo-Optical Instrumentation
Engineers (SPIE) Conference Series, ed. J.-L. Starck & F. D.
Murtagh, 76–87

Fuller, L., Lopez-Rodriguez, E., Packham, C., et al. 2016, ArXiv

e-prints

Furui, S., Fukazawa, Y., Odaka, H., et al. 2016, ApJ, 818, 164
Gallagher, S. C., Everett, J. E., Abado, M. M., & Keating, S. K.

2015, MNRAS, 451, 2991

García-Burillo, S., Combes, F., Ramos Almeida, C., et al. 2016,

ApJ, 823, L12

George, I. M. & Fabian, A. C. 1991, MNRAS, 249, 352
Greenhill, L. J., Booth, R. S., Ellingsen, S. P., et al. 2003, ApJ,

590, 162

Harrison, F. A., Craig, W. W., Christensen, F. E., et al. 2013,

ApJ, 770, 103

Hasinger, G., Miyaji, T., & Schmidt, M. 2005, A&A, 441, 417
Hönig, S. F., Kishimoto, M., Antonucci, R., et al. 2012, ApJ,

755, 149

Ichikawa, K., Ricci, C., Ueda, Y., et al. 2016, ArXiv e-prints
Ikeda, S., Awaki, H., & Terashima, Y. 2009, ApJ, 692, 608
Kishimoto, M., Hoenig, S. F., Antonucci, R., et al. 2011, ArXiv

e-prints

Krolik, J. H. & Begelman, M. C. 1988, ApJ, 329, 702
Laor, A., Barth, A. J., Ho, L. C., & Filippenko, A. V. 2006,

ApJ, 636, 83

Lightman, A. P. & White, T. R. 1988, ApJ, 335, 57
Lira, P., Videla, L., Wu, Y., et al. 2013, ApJ, 764, 159
Liu, Y. & Li, X. 2014, ApJ, 787, 52
Liu, Y. & Li, X. 2015, MNRAS, 448, L53
Magdziarz, P. & Zdziarski, A. A. 1995, MNRAS, 273, 837
Marinucci, A., Bianchi, S., Matt, G., et al. 2016, MNRAS, 456,

L94

Marinucci, A., Bianchi, S., Matt, G., et al. 2011, A&A, 526, A36
Markowitz, A. G., Krumpe, M., & Nikutta, R. 2014, MNRAS,

439, 1403

Matt, G. 2000, A&A, 355, L31
Matt, G., Fabian, A. C., Guainazzi, M., et al. 2000, MNRAS,

318, 173

McAlary, C. W., McLaren, R. A., McGonegal, R. J., & Maza,

J. 1983, ApJS, 52, 341

Murphy, K. D. & Yaqoob, T. 2009, MNRAS, 397, 1549
Nandra, K. & George, I. M. 1994, MNRAS, 267, 974
Nandra, K., O’Neill, P. M., George, I. M., & Reeves, J. N. 2007,

MNRAS, 382, 194

Nenkova, M., Sirocky, M. M., Ivezić, Ž., & Elitzur, M. 2008a,

ApJ, 685, 147

Nenkova, M., Sirocky, M. M., Nikutta, R., Ivezić, Ž., & Elitzur,

M. 2008b, ApJ, 685, 160

Netzer, H. 2015, ARA&A, 53, 365

Article number, page 12 of 15

Buchner et al.: Clumpy uniﬁed AGN obscurer model

Nowak, M. A., Neilsen, J., Markoﬀ, S. B., et al. 2012, ApJ, 759,

95

Paltani, S. & Ricci, C. 2017, A&A, 607, A31
Pier, E. A. & Krolik, J. H. 1993, ApJ, 418, 673
Predehl, P. & Schmitt, J. H. M. M. 1995, A&A, 293
Ramos Almeida, C., Levenson, N. A., Rodríguez Espinosa, J. M.,

et al. 2009, ApJ, 702, 1127

Ricci, C., Bauer, F. E., Arevalo, P., et al. 2016, ApJ, 820, 5
Ricci, C., Trakhtenbrot, B., Koss, M. J., et al. 2017, ArXiv e-

prints

Ricci, C., Ueda, Y., Koss, M. J., et al. 2015, ApJ, 815, L13
Risaliti, G., Elvis, M., Fabbiano, G., Baldi, A., & Zezas, A. 2005,

ApJ, 623, L93

Risaliti, G., Elvis, M., Fabbiano, G., et al. 2007, ApJ, 659, L111
Risaliti, G., Elvis, M., & Nicastro, F. 2002, ApJ, 571, 234
Rivers, E., Markowitz, A., & Rothschild, R. 2013, ApJ, 772, 114
Rivers, E., Risaliti, G., Walton, D. J., et al. 2015, ApJ, 804, 107
Rybicki, G. B. & Lightman, A. P. 1986, Radiative Processes in

Astrophysics

Simm, T., Buchner, J., Merloni, A., et al. 2018, MNRAS, 480,

4912

Skrutskie, M. F., Cutri, R. M., Stiening, R., et al. 2006, AJ, 131,

1163

Treister, E., Urry, C. M., Chatzichristou, E., et al. 2004, ApJ,

616, 123

Tristram, K. R. W., Burtscher, L., Jaﬀe, W., et al. 2014, A&A,

563, A82

Tristram, K. R. W. & Schartmann, M. 2011, A&A, 531, A99
Ueda, Y., Akiyama, M., Hasinger, G., Miyaji, T., & Watson,

M. G. 2014, ApJ, 786, 104

Ueda, Y., Akiyama, M., Ohta, K., & Miyaji, T. 2003, ApJ, 598,

886

Verner, D. A., Ferland, G. J., Korista, K. T., & Yakovlev, D. G.

1996, ApJ, 465, 487

Appendix A: Green function computation
We brieﬂy outline how XARS computes the response
spectrum to an input energy as seen from a distant
observer. The user provides a function that describes
the geometry, and a function that speciﬁes how emerg-
ing photons are gridded (e.g. in viewing angle).

Given an input energy, a set of photons is created,
typically originating at the geometry origin and di-
rected at all angles uniformly. Then these photons are
pumped through the geometry as follows.

The distance traveled by the photon is calculated
following an exponential distribution with expectation
unity in units of optical depth. The optical depth
is deﬁned as the cross-section to both photo-electric
absorption and Compton scattering. Because the en-
ergies are suﬃciently high, electrons appear unbound
during scattering, allowing the Klein-Nishina approxi-
mation to within a small error (Liu & Li 2014). With
the distance in units of NH to travel, the geometry user
function is called with the current position, direction
and distance to travel. It computes the coordinates of
the end point. This is achieved by integrating from the
start point in the direction until the NH value has been
accumulated.
In a simple geometry such as a single
unit sphere, the end point is the direction times dis-
tance from the current position, where the distance is
related to the ratio of NH to the radial column density
through the sphere. In more complex geometries (e.g.
many spheres), gaps between objects have to be con-
sidered.
In any case, the user function returns both
the end point and whether the photon has escaped
to inﬁnity. After this propagation, all photons still
in the medium are interacting with it. Proportional
to the relative photo-electric absorption to Compton
scattering cross-section at the current energy, the pho-
ton is randomly either absorbed or Compton scattered.

Fig. B.1. Blob irradiation geometry. A isotropic source
irradiates the blob from a certain distance, and the spec-
trum of all reﬂected photons is assessed in Figure B.2.

Compton scattering follows standard formulae (see Ry-
bicki & Lightman 1986; Brightman & Nandra 2011a;
Paltani & Ricci 2017) and assigns a new energy and di-
rection. In the case of absorption, there is a chance for
the photon to be re-emitted as a ﬂuorescent line. The
ratio of the line yield multiplied with abundance to the
total absorption cross-section of that element gives the
relative probability of line emission (we use the ener-
gies and line yields speciﬁed in Brightman & Nandra
2011a). Based on these proportionalities, we distribute
the photon to one of the ﬂuorescence lines, with a new
randomly drawn direction.
In either case (Compton
scattering, ﬂuorescent emission), the pumping repeats
from the start. If the photon however left the medium,
the photon energy, location and direction are passed
to the second user function to accumulate the Green
function response to the current input energy.

In each pumping step, millions of photons can be
processed simultaneously through the use of numpy ar-
rays, making XARS eﬃcient even though it is Python-
based.

Appendix B: Irradiation of a single blob under

various density proﬁles

In this work we have approximated clumps as spheres
ﬁlled with uniform density proﬁles. In this section we
determine if more realistic proﬁles without sharp cut-
oﬀs (e.g. polytropes) would yield diﬀerent results. In
particular we are interested in the shape of the Comp-
ton reﬂection, and if varying the density proﬁle could
alleviate the need for our inner ring component.

Our test geometry is simple and shown in Fig-
ure B.1: X-rays from an isotropic source irradiate a
single, isolated blob. We adopt (1) a uniform density
proﬁle, (2) a Gaussian proﬁle and (3) an exponential
proﬁle. For the last two we require that the density
at the border is 10−6 of the centre density. The pro-
ﬁles are normalised so that maximum column density
is NH = 1023,24,25,26/cm2 (i.e.
through the centre).
Any reﬂected/reprocessed X-rays escaping to inﬁnity,
from any angle, are collected and their X-ray spectrum
determined.

The reﬂection spectra are shown in Figure B.2,
with the panels corresponding to the three proﬁles.
In each panel we also include reﬂection oﬀ a plane-
parallel semi-inﬁnite disk under a 50° inclination angle
(orange line). This is taken from the pexmon spec-
trum of (Magdziarz & Zdziarski 1995; George & Fabian
1991; Nandra et al. 2007), and comparable to the angle-

Article number, page 13 of 15

Column density distribution and associated
Fig. C.1.
covering fractions produced by our clumpy models includ-
ing the inner ring component. Data points (as in Fig-
ure 2) represent intrinsic AGN obscured fractions at dif-
ferent luminosities. Compared to Figure 2, the Compton-
thick column densities are more frequent because of the
inner Compton-thick ring.

ent shapes, as shown in the other panels of Figure B.2
for Gaussian and exponential proﬁles. The Compton
hump is much weaker, and the spectrum ﬂatter to-
wards low energies. This is not just because these blobs
have a lower mass: high-column density results diﬀer
throughout also from results of lower column density
uniform spheres. The location where reﬂection pri-
marily occurs is at the surface of uniform blobs, but
In the latter, a
deeper inside for the other proﬁles.
photon can pass into the blob further, and after scat-
tering may escape oﬀ the more common lower column
density routes. A single scattering is more likely to put
the ﬂight direction of a photon away from the centre
than towards it. In the Gaussian/exponential proﬁles,
this decreases the eﬀective column density after each
scatter, and subsequently allows high-energy photons
to pass through much more easily than in a uniform
density proﬁle.

The spectral shape of NuSTAR data studied in this
work is similar to the black lines in the left panel,
that is, reﬂection dominated with a strong Compton
hump. The addition of the torus ring component
emphasises reﬂection oﬀ high-column clouds and sur-
presses the reﬂection oﬀ low-density clouds (grey in left
panel). As Figure B.2 shows, introducing Gaussian/-
exponential proﬁle clumps would worsen the situation
(as their spectra peak at lower energies) and would
under-predict the Compton hump.

Reﬂection oﬀ blobs with various proﬁles and
Fig. B.2.
column densities. For comparison, reﬂection oﬀ a semi-
inﬁnite disk is shown in all panels (orange curve: 50° incli-
nation angle; red curve: angle-averaged, our code).

averaged spectrum produced by our XARS code of the
same geometry (red line). In the top panel, reﬂection
oﬀ high-column density uniform blobs (black lines) re-
sembles the disk reﬂection. At lower column densi-
ties (grey) the spectrum peaks at lower energies. The
same results were obtained in Nandra & George (1994).
Varying the density proﬁle yields signiﬁcantly diﬀer-

Appendix C: Clumpy model distributions

Figure C.1 presents the column density distribution of
the ﬁnal model. Similar to Figure 2, a wide range of
column densities are produced by each geometry. Now,
extremely thick column densities are more common.

Article number, page 14 of 15

105104103102Flux density [arb. units]Uniform density spherepexmondiskNH=23.0NH=24.0NH=25.0NH=26.0100101Energy [keV]101100101Ratio105104103102Flux density [arb. units]Gaussian profilepexmondiskNH=23.0NH=24.0NH=25.0NH=26.0100101Energy [keV]101100101Ratio105104103102Flux density [arb. units]Exponential profilepexmondiskNH=23.0NH=24.0NH=25.0NH=26.0100101Energy [keV]101100101Ratio1020102110221023102410251026Column Density NH0.00.20.40.60.81.0Covering Factor f(>NH)faintBuchner+16Host galaxy subtractedbrightObscured Fractions=85 N=10000=35 N=10000=15 N=10000=5 N=10000Buchner+15Ricci+16Buchner et al.: Clumpy uniﬁed AGN obscurer model

Eclipse rates predicted when including the
Fig. C.2.
inner ring component. Curves as in Figure 3, with orange
and cyan error bars and curves representing eclipse mea-
surements by Markowitz et al. (2014). Now we show Ux-
Clumpy with σ = 15° and σ = 35° to reproduce Sy1 and
Sy2, respectively.

Figure C.2 presents the frequency of eclipse of the
ﬁnal model. Similar to Figure 3, observed cloud sizes
and eclipse frequencies can be reproduced, albeit with
diﬀerent model parameters. This is because the inner
ring component shades clouds below its covering factor,
requiring higher σ values.

Article number, page 15 of 15

101102103Time [days]104103102101100Eclipse probabilityRXTE Sy1 eclipsesRXTE Sy2 eclipsesUnobsc LOS eclipsed (Model =35)Obsc LOS eclipsed (Model =15)2011'1''1101001000ModelObservations ×2Cloud angular size distribution