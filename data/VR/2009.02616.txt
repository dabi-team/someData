0
2
0
2

p
e
S
5

]
P
S
.
s
s
e
e
[

1
v
6
1
6
2
0
.
9
0
0
2
:
v
i
X
r
a

1

XL-MIMO Energy-Eﬃcient Antenna Selection

under Non-Stationary Channels

Gabriel Avanzi Ubiali, Tauﬁk Abrão

Abstract

Massive multiple-input-multiple-output (M-MIMO) is a key technology for 5G networks. Within

this research area, new types of deployment are arising, such as the extremely-large regime (XL-

MIMO), where the antenna array at the base station (BS) has extreme dimensions. As a conse-

quence, spatial non-stationary properties appear as the users see only a portion of the antenna

array, which is called visibility region (VR). In this challenging transmission-reception scenario, an

algorithm to select the appropriate antenna-elements for processing the received signal of a given

user in the uplink (UL), as well as to transmit the signal of this user during downlink (DL) is

proposed. The advantage of not using all the available antenna-elements at the BS is the com-

putational burden and circuit power consumption reduction, improving the energy eﬃciency (EE)

substantially. Numerical results demonstrate that one can increase the EE without compromising

considerably the spectral eﬃciency (SE). Under few active users scenario, the performance of the

XL-MIMO system shows that the EE is maximized using less than 20% of the antenna-elements

of the array, without compromising the SE severely.

Index Terms

Extremely-large antenna regime; Non-Stationary Channels; Antenna selection; Energy eﬃ-

ciency; spectral eﬃciency; precoding; combining

I. Introduction

Massive multiple-input-multiple-output (M-MIMO) is one of the key technologies for 5G networks

[1], which permits that more than one single user transmits simultaneously with high spectral and

energy eﬃciencies and using the same spectrum, i.e., many antennas simultaneously serve many users

using the same time-frequency resource [2]. In MIMO networks, the base station (BS) estimates the

channel coeﬃcients and employs a transmit precoding scheme in the downlink (DL) and a receive

Copyright (c)2020. Personal use of this material is permitted.

This work was supported in part by the Coordenacão de Aperfeicoamento de Pessoal de Nível Superior - Brazil

(CAPES) - Finance Code 001, by the Arrangement between the European Commission (ERC) and the Brazilian

National Council of State Funding Agencies (CONFAP), CONFAP-ERC Agreement H2020, by the National Council

for Scientiﬁc and Technological Development (CNPq) of Brazil under grant 310681/2019-7.

September 8, 2020

DRAFT

 
 
 
 
 
 
2

combining scheme in the uplink (UL), giving each user a diﬀerent spatial signature [3], [4]. M-

MIMO wireless communication is a special case of MIMO systems using hundreds of antennas at

the BS, providing suﬃcient spatial dimensions to uncover the fundamental properties of M-MIMO:

channel hardening, large array gain and asymptotic inter-terminal channel orthogonality (favorable

propagation) [5]. Thus, it can provide large improvements over traditional systems in both energy

and spectral eﬃciencies.

As the number of BS antennas increases, it is possible to focus the transmission and reception

of signal energy into ever-smaller regions of space, which brings huge improvements in throughput

and EE. However, it may come with the computational complexity increasing, as well as with the

increasing of implementation cost and power consumption, what advocates for new deployments

that take real advantage from increasing the number of BS antennas to the order of hundreds or

thousands, without severe problems due to the holdbacks above cited. Moreover, in order to make

real advantage from the deployment of such a large number of antenna elements, it is desirable

to distribute them over a substantially large area in order to increase the antenna separation and

coverage [6]. One potential approach is the extremely-large MIMO (XL-MIMO) regime, where the

antenna array is integrated into large building structures [5].

When a moderate number of (several tens of) antennas is compactly deployed in the BS, the

entire array will receive approximately the same amount of energy from each user, i.e., the channel is

spatially stationary [7]. On the other hand, in the XL-MIMO regime, diﬀerent parts of the array may

observe the same propagation paths with varying power and phases or distinct propagation paths.

Then, the majority of energy received from a speciﬁc user concentrates on small portions of the entire

array, which is a channel property called spatial non-stationarity, which has been observed by recent

channel measurements [8]–[10] and can be introduced in the channel model by using the concept of

visibility region (VR) [5], [11]–[13]. However, it is worth saying that the density of VRs inﬂuences on

the size of the portion of the array that the user can see. For instance, if the VR density is suﬃciently

high, all portions of the array are able to receive some signal energy.

The conventional M-MIMO signal processing architecture is centralized at the BS, what means

that the signals are received at the BS (UL) and transmitted by the BS (DL) deploying all elements

of antennas. Then, the associated computational complexity becomes a challenge when employing

extremely large arrays, specially in crowded scenarios, due to the need to transfer excessively large

amounts of data received by the array to the processing unit [7]. A promising solution is to use only

a portion of the whole element-antennas array to perform receive combining as well as the transmit

precoding to each user.

Hence, by appropriately selecting a subset of BS antennas to communicate with each user, the

receiver is able to capture almost the totality of the energy transmitted by that user, while reducing the

September 8, 2020

DRAFT

3

interference coming from the other users and therefore potentially increasing the spectral eﬃciency

(SE). Furthermore, by having higher SE and reduced power consumption, one can obtain higher

EE. It is important to highlight that there is a growing concern about how to improve the EE in

wireless communications, as the increasing data rates and the increasing number of users connected

to the network increase substantially the overall energy consumption [14]. For this reason, in this

work we take both SE and EE as performance metrics to be analyzed in section V. Finally, on can

summarize the beneﬁts of the VR-based subarray antenna selection architecture as: a) computational

complexity reduction; b) overall energy saving by activating a reduced number of antenna-elements;

c) as a result an EE increasing; d) while potentially improving the overall system SE by selecting

appropriate antenna-elements associated to the each user VR.

Considering that the antenna array experiences spatial non-stationarities when using large-aperture

arrays, in [15], authors propose two new channel estimation methods that, besides estimating the

channel vector, obtains the position of the scatterers and the visibility regions, which may be useful

for transceiver design. In [11], authors study the impact of spatial non-stationarity where the channel

energy is concentrated on a portion of the array, i.e., the VR, in terms of signal-to-interference-

plus-noise ratio (SINR) performance. In [5], authors show that, when M-MIMO systems operate

in extra-large scale regime, several important MIMO design aspects change, due to spatial non-

stationarities, where the users see only a portion of the array and, inside the VR, diﬀerent parts of

the array see diﬀerent propagation paths. Moreover, three low-complexity data detection algorithms

are proposed in [12] as candidates for uplink communication in XL-MIMO systems.

In [7], authors designed an eﬃcient detector for extra-large-scale massive MIMO systems with the

subarray-based processing architecture, by extending the application of the expectation propagation

principle. Their analysis is based on bit error rate (BER) performance. A diﬀerent approach to

the antenna selection methodology proposed herein, in [16], authors propose a design based on

machine learning to select a small portion of the array that contains the beamforming energy to the

user, aiming to overcome the prohibitive complexity of XL-MIMO systems. They provide numerical

results in terms of sum-rate performance. To the best of author’s knowledge, this is the ﬁrst work

addressing the subarray-based processing architecture, which remarkably provides huge reduction in

the computational complexity, through the point of view of improving the overall system EE.
Contribution. We deal with an XL-MIMO system eqquiped with a subarray-based processing archi-

tecture, in order to reduce the overall system computational complexity. In such scenario, we propose

a novel algorithm to judiciously select the antenna-elements subarray that will communicate with each

user, aiming at obtaining higher EE while reducing the power consumption, when compared to the

whole antenna array activation to communicate with every user. Thus, the contribution of this work
can be summarized as: i ) we propose an antenna selection procedure to improve simultaneously the

September 8, 2020

DRAFT

4

overall system EE by reducing the power consumption, taking into account the spatial non-stationarity
assumption while taking advantage of the VRs features; ii ) the proposed algorithm also provides a
considerable computational complexity reduction; iii ) a comprehensive analysis development on how

the proposed procedure impacts the system performance is developed, highlighting and characterizing

its beneﬁts when comparing to the condition of using the entire antenna array to communicate with

every user.

The remainder of the paper is organized as follows. The adopted XL-MIMO channel model and

the channel estimation procedure is developed in Section II; this section also provides the ergodic UL

and DL spectral eﬃciencies expressions, based on the signal-to-interference-plus-noise ratio (SINR).

Section III focuses on the proposed antenna selection procedure, as well as on the computational

complexity aspects. The EE deﬁnition and a detailed circuit power model are discussed in Section

IV. Section V examines numerical results corroborating our ﬁndings, while the main conclusions are

presented in Section VI.

II. System Model

We consider the UL and the DL of a single-cell multiuser XL-MIMO system with an M -antenna BS

and K single-antenna users at each cell, operating over a bandwidth of B Hz. The channel estimates

are acquired via UL synchronous pilot transmission. The time-division duplex (TDD) operation mode

was chosen because of its advantages over the frequency-division duplex (FDD) mode. TDD does

not require quantized channel state information (CSI) to be sent by the BS to the user via feedback,

because of channel reciprocity, avoiding excessive overhead [3], [17].

The channel coherence time (TC) is divided into UL pilot, UL data and DL data transmission, as

Figure 1 shows. The number of symbols that ﬁts in a channel coherence block is τc = TCBC, being

BC the coherence bandwidth [2]. In order to estimate the channel, each of the K users of a given

cell is assigned a diﬀerent pilot sequence. There are τc symbols per coherence block, of which τp are
dedicated to UL pilot transmission, τu = ǫu (τc −
and τd = ǫd (τc −
of available orthogonal pilot sequences is equal to its length (τp). As we need K sequences, we can

τp) symbols are dedicated to DL data transmission, where ǫu +ǫd = 1. The number

τp) symbols are dedicated to UL data transmission

take τp = K. Thus, the time required for pilots is proportional to the number of users served. The

number of users that can be served is therefore limited by the coherence time, which itself depends

on the mobility of the users [2].

The antenna-elements are uniformly spaced over a uniform linear L-length array containing M

elements (M -ULA). The coordinates of the ﬁrst and the M -th antennas are (0, 0) and (L, 0),

respectively, which means that, when M

M −1 . The users
are placed over a rectangle that extends along the antenna array in one dimension and between

1, the spacing between the antennas is

≥

L

September 8, 2020

DRAFT

5

!"#$%&’(
()*+,-%,,%’+

!"#.*(*
()*+,-%,,%’+

/"#.*(*
()*+,-%,,%’+

,0-1’&,

,0-1’&,

,0-1’&,

2’34)4+54#1&’567

,0-1’&,

Figure 1: Each coherence block is divided into the UL pilot transmission for channel estimation
purpose, the UL data transmission, and the DL data transmission.

a minimum (dmin) and a maximum distance (dmax) in the other dimension, following a uniform

distribution over this area. The coordinates of the m-th antenna are denoted by (am, 0), and its

distance to the k-th user is denoted by dmk. A typical system conﬁguration is represented by Figure

2.

y(cid:13)

d(cid:13) max(cid:13)

(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)

2(cid:13)

3(cid:13)

4(cid:13)

(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)

(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)

d(cid:13) min(cid:13)

1(cid:13)

2(cid:13)

1(cid:13)

...(cid:13)

x(cid:13)

M(cid:13)

L(cid:13)

Figure 2: Typical system spatial conﬁguration.

A. XL-MIMO Channel Model

In XL-MIMO systems, spatial non-stationarities occur frequently since typically dmax < L, what

means that a given user probably sees only a small part of the antenna array. The propagation

environment contains numerous objects reﬂecting the signal, which are called scattering points. Each

scattering point has an associated VR. Herein, we assume that each user can see the antenna array

through Nc diﬀerent VRs. The i-th VR that is visible to the k-th user extends from the cik-th to the

(cik + Nik)-th antenna and is denoted by

overlap, and the set

k =

C

C1,k

∪

. . .

∪ C

ik =

cik , cik + 1 , . . . , cik + Nik
{

C
NC,k contains the indices of the antennas that are visible

. These VRs may
}

September 8, 2020

DRAFT

6

to the k-th user. Considering that each user sees the antenna array through more than one VR, it is

a way of taking into account that not only one subset of the array containing contiguous antenna

elements may be visible. Indeed, the mobile user may see more than one portion of the array. For

instance, if M = 100 in Figure 2, it may see antennas 10 to 20 and 25 to 40, which means there is

something in the propagation environment preventing the signal from reaching antennas 21 to 24.

In general, the distances between a given user and all the BS antennas are considered to be the

same. However, in the XL-MIMO scenario, as the length of the antenna array is not negligible, the
pathloss varies throughout the array, mainly when dmax ≪
m-th antenna and the k-th user is given by:

L. The pathloss coeﬃcient between the

bmk =

b0
(dmk)γ

(1)

where γ

≥

2 is the pathloss exponent and b0 determines the median channel gain at a reference

distance of 1 m [6]. The parameters b0 and γ are functions of the carrier frequency, antenna gains,

and vertical heights of the antennas, which are derived from ﬁtting (1) to measurements [6]. Finally,

the channel vector hk = [h1k . . . hM k]T between the BS and the k-th user is given by:

⊙ p
where bk is a vector whose m-th element is bmk, and hk is the independent Rayleigh fading

⊙

hk = ak

bk

hk

(2)

component, which accounts for the short-scale fading and follows a complex-Gaussian distribution

hk

∼ CN

(0M , IM ). The coeﬃcient amk = [ak]m indicates whether the m-th antenna is visible to

the k-th user (amk = 1) or not (amk = 0), and is given by:

1
amk = 

0


B. UL Pilot Transmission

m

k

∈ C
otherwise.

(3)

We assume the channel is estimated via UL synchronous pilot transmission, which means that all

users simultaneously send pilot sequences from the same pilot codebook. They have length τp and

form an orthogonal set. Herein, it is assumed that each user is assigned a diﬀerent pilot sequence.
Then, the pilot sequences’ set is Ψ = [ψ1 . . . ψK]
Cτp×K and the orthogonality condition states
that ΨHΨ = τpIτp, i.e.:

∈

τp

ψH

i ψk = 

0


i = k,

i

= k.

During the UL pilot transmission, the k-th user transmits the pilot sequence ψk

(4)

Cτp, with

∈

transmit power pp. The elements of ψk are scaled by √pp, forming the signal sk = √ppψH

k , to be

September 8, 2020

DRAFT

6
transmitted over τp UL samples. As a result, the BS receives the signal Yp

CM ×τp:

∈

Yp =

K

Xi=1

√pphiψH

i + Np

7

(5)

∈

where Np

CM ×τp is the noise matrix at the receiver of the BS with i.i.d. entries following a complex

normal distribution with zero mean and variance σ2

UL.
As the information about which antennas are visible for each user is unknown, it might be necessary

to consider obtaining the channel estimates by using estimators that require no prior statistical

information, such as the least-squares (LS). Moreover, as we consider that each user is assigned a

diﬀerent pilot sequence and these sequences are mutually orthogonal, there is no pilot contamination.

Hence, the imperfections on the channel estimates are just due to the noise power at the BS antennas

during the UL pilot transmission. It advocates for using LS channel estimation rather than MMSE.

The LS estimate of hk is attained by [6]:

ˆhk =

1
τp√pp

Ypψk

= hk +

1
τp√pp

Npψk

(6a)

(6b)

The last term in (6b) is the equivalent noise vector, which adds imperfections to the channel

estimates and follows a complex normal distribution: Npψk
estimated channel matrix is ˆH = [ˆh1 . . . ˆhK], while H = [h1 · · ·

∼ CN

(0M , τpσ2

hK]

∈

ULIM ). Finally, the
CM ×K is the true

channel matrix. According to equation (6a), the channel estimation process corresponds to the inner

product of M complex vectors of length τp, requiring M τp multiplications between complex numbers
(or 3M τp multiplications between real numbers1) to estimate the channel vector of each of the K

users. Herein, we consider that both multiplication and division between real numbers correspond to

1 ﬂoating-point operation (ﬂop). As the channel estimation process is performed once per coherence

block, its computational complexity, deﬁned in number of ﬂops per coherence block [fpcb], is:

CCE = 3M Kτp

[fpcb]

C. UL Data Transmission

The received signal r

∈

CM at the BS during the UL data transmission is:

K

r =

hkxk + n

Xk=1

(7)

(8)

1

Consider x = a + jb and y = c + jd. The hardware implementation of the complex multiplication xy = ac − bd +
j[(a + b)(c + d) − ac − bd] involves 3 real multiplications and 5 real sums. Only those will be considered, due to their
very greater hardware complexity compared to the real sum operation.

September 8, 2020

DRAFT

8

where xk is the signal sent by the k-th user and n

∼ CN

(0M , σ2

the BS antennas. By utilizing a suitable combining vector, vk

signal as follows:

∈

ULIM ) contains the noise received at
CM , the BS detects the k-th user’s

yk = vH
k r

(9)

Herein we consider the two simplest types of linear processing for receive combining: zero-forcing

(ZF) and maximum-ratio (MR), which are respectively deﬁned by:

and

V = ˆH( ˆH

H ˆH)−1

V = ˆH

(10)

(11)

where the matrix V = [v1 . . . vK] is the collection of the combining vectors. ZF induces considerably

smaller intra-cell interference than MR, yielding signiﬁcantly better performance under interference-

limited conditions, which is normally the case. On the other hand, it increases computational com-

plexity signiﬁcantly when employing large antenna arrays, due to multiplications of complex numbers,

and when serving a great number of users, due to the size of the K

K matrix that is inverted [3],

×

[6]. Due to these particularities, it is interesting to compare the system performance in terms of SE

and EE considering such linear processing techniques.

The channels are practically constant within a coherence block, while the signals and noise take

new realization at every sample. Then, the instantaneous SINR is actually an expectation over one

coherence block, what means that pUL

k = E

xk

{|

2
|

}

- and σ2

UL will be taken instead of the instantaneous values of

- which is the UL transmit power of the kth user

xk
|

2 and
|

nk
|

2, respectively. Thus,
|

one can deﬁne the SINR of the kth user during the UL data transmission as

γUL
k =

pUL
i

K

Pi=1
i6=k

pUL
k |
vH
k hi
|

vH
k hk

2
|
2 + σ2
|

vk

2
||

UL||

As a result, the UL ergodic spectral eﬃciency is deﬁned by [6]:

SEUL =

τu
τc

K

Xk=1

E

log2(1 + γUL
k )
}
{

D. DL Data Transmission

(12)

(13)

In the DL, the information to be transmitted by the BS to the k-th user, xk, needs to be precoded,
CM , is generated

by using the precoding vector wk. The signal to be transmitted, denoted by s

∈

September 8, 2020

DRAFT

as:

K

s =

wkxk

Xk=1

9

(14)

We denote the matrix containing the collection of the precoding vectors by W = [w1 · · ·

∈
CM ×K. The UL-DL duality motivates a simple precoding design principle: selecting the DL precoding

wK ]

vectors as the normalized version of their respective combining vectors [6]:

wk =

v∗
k
vk
||

||

Assuming no receive combining, user k receives the signal:

yk = hT

k s + nk

(15)

(16)

where the received noise follows the distribution nk

(0, σ2

DL). Analogously to (12) for the UL,

∼ CN

the SINR of the kth user in the DL data transmission is deﬁned as:

γDL
k =

K

Pi=1
i6=k

hT
k wk

pDL
k |
hT
k wi
|

2
|
2 + σ2
DL
|

pDL
i

where pDL
k

is the downlink transmit power assigned for user k, i.e.,

(17)

pDL
k

scales the vector wk, which

q

has unit norm. Finally, the DL ergodic spectral eﬃciency is given by [6]:

SEDL =

τd
τc

K

Xk=1

E

log2(1 + γDL
k )
}
{

(18)

III. Antenna Selection for Combining and Precoding in XL-MIMO

In this section, we propose an algorithm to select the antenna-elements in an XL-MIMO system for

received signal processing (combiner) of a given user during the UL and transmit the signal (precoder)

of this user during the DL. One advantage of not using all the M available antennas is the reduction

of the computational complexity and the circuit power consumption (Tx and Rx operations), as less

antennas are active at the same time. Furthermore, the throughput potentially increases, because

the interference power at the receivers decreases since each antenna individually does not serve all

the K users simultaneously.

A. HRNP-based Antenna Selection Criterion and Algorithm

First, Algorithm 1 computes the vector θk

∈

CM , which is a quantitative indicator of the quality

September 8, 2020

DRAFT

of the channel between the k-th user and each of the M antennas as:

10

ˆhmk
θmk = |
K

2
|
ˆhmi
|

2
|

Pi=1
i6=k

,

m = 1, 2, . . . , M

(19)

where ˆhmk = [ˆhk]m and θmk = [θk]m. A high signal intensity may be obtained when

ˆhmk
|

2 is strong.
|

Selecting the N strongest θmk values among m = 1, . . . , M in (19) for each user, provides the highest

received normalized power (HRNP) antenna selection criterion. On the other hand, the terms

ˆhmi
|

2,
|

i

= k, are related to the interference intensity. Higher θmk values are therefore associated to higher

SINRs on the signal detection, as deﬁned by the equations (12) and (17), and consequently higher

SE and EE.

Second, the Algorithm 1 obtains the set

k (lines 5–10), which contains the indices of the N

D

antennas with the highest θmk values. Only these N antenna-elements are activated for user k.

Lastly, Algorithm 1 computes the receive combining and the transmit precoding vectors of the k-th
user (lines 11–14) based on the matrix ˆHk
CN ×K , which contains all the columns of the estimated
channel ˆH but only the rows corresponding to the elements of the set

∈

k.

D

As the set

k contains the indices of the antennas that are active for the kth user, the superset

D

K contains all the indices of the antennas that are active for any user. The number

, denoted by Nact, corresponds to the total number of active elements of antenna.

D

Notice that the rows of the combining and the precoding matrices corresponding to the antennas

whose indices are not in the set

k are set equal zero.

D

Algorithm 1 Antenna selection (AS) for receive combining and transmit precoding

Input: M , N , K, ˆH
Output: V, W

=

D1 ∪ · · · ∪ D

D
of elements in

1: Initialize the combining matrix V with 0M ×K
2: for k = 1 to K do
3:
4:
5:
6:
7:

Compute vector θk via eq. (19)
Reinitialize the set of the indices of the antennas:
Initialize
D
for n = 1 to N do

k =

∅

ﬁnd m∗ = arg max
m∈M

θmk

=

1, . . . , M
{

}

M

8:
9:
10:
11:
12:

m∗

∪ {

m∗

=
M
M\
k =
k
D
D
end for
ˆHk = ˆH(
k, :)
If MR is selected: VMR(
If ZF is selected: VZF(

D

}

V(:,k)∗
||V(:,k)||

D

13:
14: W(:, k) =
15: end for

k, k) = ˆHk(:, k)
D
H
k, k) = [ ˆHk( ˆH
k

ˆHk)−1](:,k)

September 8, 2020

DRAFT

6
B. Computational Complexity

We ﬁrst address the complexity of computing the ZF combining vectors (line 13, Algorithm 1).

11

Recalling that ˆHk
2 N complex multiplica-
tions2, using the Hermitian symmetry. When the inverse of a matrix is multiplied by another matrix,

CN ×K, the multiplication of ˆH

k by ˆHk requires K 2+K

∈

H

the LDLH decomposition can be used to achieve an eﬃcient hardware implementation [6]. The
decomposition of ˆH
complex multiplications [6]. Finally, we need to multiply the
matrix ˆHk by the k-th column of the matrix ( ˆH
ˆHk)−1, which requires KN complex multiplications
plus K complex divisions to compute D−1 [6], [18]. Considering complex multiplications and complex

ˆHk requires K 3−K

H
k

H
k

3

divisions to correspond to 3 and 7 ﬂops3, respectively, the computation of the combining vector

vk has a complexity of 3

2 N + K 3−K
computational complexity to obtain the whole combining matrix V is given by:

3 + KN

K 2+K

(cid:17)

(cid:16)

+ 7K ﬂops per coherence block. Thus, the

C UL-ZF

SP-C = K 4 +

K 3N +

3
2

9
2

K 2N + 6K 2

[fpcb]

(20)

As deﬁned in (11), MR combining does not require multiplications or divisions, because it is given

directly from the channel estimates (from Algorithm 1, one can see that the k-th column of the MR
combining matrix is simply a copy of the k-th column of ˆHk). However, in practical implementations,
we typically normalize the combining vector such that vH

k hk in front of the desired signal xk is close
to one. Thus, this normalization requires 1 complex division per user [6], resulting in a total of 7K

ﬂops per coherence block. Finally, the complexity of computing the MR combining matrix is given

by:

C UL-MR

SP-C = 7K

[fpcb]

(21)

The precoding vectors (wk) are chosen as the normalized versions of the combining vectors (vk),

as described in equation (15). The computation of

requires 2N real multiplications4 and the

vk
||

||

division of vk by

vk
||

||

also requires 2N real divisions5, resulting in a total of 4N ﬂops. Thus, the

2

Being A ∈ Ca×b and B ∈ Cb×c, the multiplication AB requires ac inner products between b-length vector, what
, the Hermitian symmetry is utilized. Thus, only the
b

corresponds to abc complex multiplications. However, if B = AH
a diagonal elements of A · B and half of the a2 − a oﬀ-diagonal elements need to be computed, what gives a
complex multiplications [6].

2+a
2

Considering x = a + jb and y = c + jd, then x

y = xy
|y|2 , while the computation of xy∗ requires 3 real
∗
multiplications. The computation of |y|2 = c2 + d2 requires 2 real multiplications. Finally, the complex division xy
|y|2
corresponds to 2 real divisions, making a total of 7 real operations.

yy∗ = xy

∗

∗

4

Consider the complex vector x = [x1, . . . , xN ]. The computation of ||x|| =

obtaining |xm|2. Being xn = an + jbn a complex scalar, |xn|2 = a2
n + b2
sum. Therefore, the computation of ||xk|| requires 2N real multiplications.

N

|xn|2 depends on previously

s

n=1
P

n requires 2 real multiplications and 1 real

The division of a complex scalar x = a + jb by a real scalar c requires 2 real divisions. Therefore, the division of x

3

5

by ||x|| requires 2N real divisions.

September 8, 2020

DRAFT

computation of the precoding matrix has a complexity of:

C DL

SP-C = 4KN

[fpcb]

12

(22)

Notice that the rows of the combining and the precoding vectors of the user k that correspond

to the antennas whose indices are not in the set

k are set equal zero. It reduces the complexity

D

to obtain yk, as in (9), because the BS will use N elements of the vectors vk and r, instead of M

elements, resulting in 3N ﬂops. This procedure is repeated τu times per coherence block. Similarly,

the complexity to precode the information during DL, wkxk, following (14), is reduced since the BS

only uses N elements of the vector wk, also resulting in 3N ﬂops. This task is performed τd times per

coherence block. Finally, the computational complexity associated to the reception and transmission

of the information, in number of ﬂops per coherence block, is:

CSP-R/T = 3(τu + τd)KN

[fpcb]

(23)

To obtain θmk in (19), the BS computes 2K real multiplications and 1 real division. As there are

M antennas and K users, the associated complexity is:

CSP,θ = (2K + 1)M K

[fpcb]

(24)

Finally, the total signal processing computational complexity, in ﬂops per coherence block, when

employing MR and ZF processing in the context of XL-MIMO antenna selection is given respectively

by:

and

CTSP = C UL-MR

SP-C + C DL

SP-C + CSP-R/T + CSP,θ [fpcb]

CTSP = C UL-ZF

SP-C + C DL

SP-C + CSP-R/T + CSP,θ

[fpcb]

(25)

(26)

Hence, if antenna selection (AS) procedure is not applied, the complexities given in (20), (22) and

(23) will be higher, since all the M antennas always will be active for all the K users, i.e., N = M .

IV. SE and EE in XL-MIMO Systems

The SE is deﬁned as the sum-rate in bits per channel use [bpcu] achieved in the UL + DL,

expressed as:

SE = SEUL + SEDL

[bpcu]

(27)

September 8, 2020

DRAFT

13

The overall network EE can be deﬁned as the number of bits that can be reliably transmitted per

unit of energy, which is the same as the throughput per unit of power

bit/s
W

h

i

, given by:

EE =

B
SE
·
TX + P tr
TX + P DL
P UL

TX + PCP

bit
J (cid:21)

(cid:20)

(28)

where the denominator includes all power consumption terms required to make the wireless commu-

nication system operational. Hence, the term

P tr

TX =

τp
τc

1
ηUL Kpp

(29)

accounts for the total power consumed by the power ampliﬁers during the UL pilot transmission,

while

and

P UL

TX =

τu
τc

1
ηUL

P DL

TX =

τd
τc

1
ηDL

K

Xk=1

K

Xk=1

pUL
k

pDL
k

(30)

(31)

refers to the UL and DL power consumed for data transmission, respectively, being ηUL and ηDL the

power ampliﬁer eﬃciency at the BS and at the users, respectively. PCP represents the circuit power

consumption. A detailed model for PCP is discussed in the sequel.

A. Circuit Power Model

The following circuit power consumption model based on [6] is adopted in this work:

PCP = PFIX + PTC + PCE + PC/D + PBH + PSP

(32)

where PFIX is a constant quantity. It accounts for the power consumption required for site-cooling,

control signaling and load-independent power of backhaul infrastructure and baseband processors.

The power consumed by the backhaul is commonly modeled as the sum of two parts: load-independent

and load-dependent. The last one will be included in PBH, and is typically the least signiﬁcant part

(around 20%) [6].

The other terms of the model represented in (32) account for the power consumption of the

transceiver chains (PTC), the channel estimation process (PCE), the channel coding and decoding

units (PC/D), the load-dependent backhaul (PBH) and the linear processing at the BS (PLP). Each of

these terms depends on at least one of the main system parameters: M , K and the ergodic spectral

eﬃciency (SE).

The power consumption of the transceiver chains (PTC) involves the power consumed by the BS

local oscillator (PLO), the power required by the circuit components (converters, mixers and ﬁlters)

September 8, 2020

DRAFT

14

of each BS antenna (PBS) and the power necessary to run the circuit components (mixers, ﬁlters,

ampliﬁers and oscillator) of each single-antenna user (PUE), as described by the equation

PTC = PLO + NactPBS + KPUE

(33)

The computational complexity associated to the channel estimation process is given by the equation

(7). Hence, the resulting power consumption is given by6:

where LBS is the computational eﬃciency at the BS, in [ﬂop/s W]. Similarly, the total signal power

PCE =

BCCE
τcLBS

(34)

consumption is given by:

PSP =

BCTSP
τcLBS

The power consumed by the channel coding and decoding units is deﬁned as

PC/D = B SE (

PCOD +

PDEC)

(35)

(36)

which increases linearly with the actual rates.

densities, respectively, in

UL and DL.

watt
bit/s

h

. For simplicity,
i

PCOD and
PCOD and

PDEC are the coding and decoding power
PDEC are assumed to be the same in both

The load-dependent backhaul power consumption, necessary for the UL and DL data transmission

between the BS and the core network, is modeled as

PBH = B SE

PBT

(37)

where

PBT is the backhaul traﬃc power density, in
h
power consumption, which can be included in PFIX.

watt
bit/s

. There is also a load-independent backhaul
i

V. Numerical Results

In the sequel we present numerical results based on Monte-Carlo simulations with the objective

to demonstrate that the proposed algorithm provides an EE increase while reducing considerably the

computational complexity and the power consumption in the context of XL-MIMO systems. Table I

contains a list of the main deployed parameter values, similar to those adopted in [6], [19], [20].

6

As each coherence block contains τc symbols per second, B/τc is the number of coherence blocks per second. If a
given signal processing has a computational complexity denoted by C, representing the number of ﬂops per coherence
block, and L is the computational eﬃciency, representing the number of ﬂops per Joule of energy, then C
L represents
the energy consumption per coherence block. Therefore, the associated power consumption is BC
τcL .

September 8, 2020

DRAFT

15

A. Simulation Setup and System Conﬁguration

In our simulations, the antenna array contains M = 100 antenna elements and each user sees the

array through 3 diﬀerent VRs, i.e., Nc = 3. Furthermore, Nik is taken as a uniform random variable

distribution over the interval [0.1M, 0.3M ], while the index of the ﬁrst antenna that is inside this

VR, denoted by cik, follows a uniform distribution in the interval [1, M

Nik].

−

The set

k =

C

C1,k

∪

. . .

∪ C

NC,k contains the indices of the antennas that sees the k-th user.

Thus, the number of elements in

C

k corresponds to the total number of antennas seen by user k. We

obtained this value numerically from our simulations. As well as the other numerical results presented

in the paper, this value was averaged out of 1,000 random realizations, obtaining the average number

of active antennas for the k-user as

|C|

= 55.8. It means that approximately 56 antennas are seen by

each user, on average. Also from our simulations, we found that, when K = 4, each antenna sees

an average of 2.23 users, while for K = 40 this number goes to 22.3, resulting in higher interference

levels.

Moreover, we assume equal power allocation (EPA), what means the transmit power is the same for

all users. Hence, during the UL data transmission, pUL

k = pUL, while during the DL data transmission,

the total available transmit power at the BS, PDL, is equally divided among the K users, so that the
power allocated to the k-th user is pDL

k = PDL/K. We have adopted pP = pUL = 0.1 W and PDL =

1 W. Although the position of the users (and consequently the pathloss), the short-scale fading and

the VRs are random variables, the numerical results are statically relevant because they represent an

average over 1,000 realizations.

Figure 3 shows an example of the XL-MIMO system user spatial distribution, where K = 4 and

M = 16, for simplicity. Each triangle represents one of the 16 BS antennas, while each colored

circle represents one of the 4 mobile users, which are randomly distributed over a rectangular area.

Taking a random channel realization, the portion of the array that each user sees is indicated by the

horizontal line with its correspondent color. User 1, for example, sees the antennas 1 to 10, while

user 2 sees the antennas 9 to 15, excepting the antenna 13. This fragmentation of the VR into two

parts may occur if any object is blocking the signal in that region.

In this example, the algorithm was set up to deﬁne N = 4 antennas to communicate with each

user. In the ﬁgure, the triangle that represents a given antenna m is painted with the user k color if

user k sees antenna m. For example, antennas 1, 2, 3 and 9, which are in blue, were designated to

communicate with user 1. Notice that all these 4 antennas are part of the VR of user 1. Although

the signal from user 1 probably achieves the antennas 4 to 8 with higher intensity than antenna

9, choosing one of these antennas would increase the received interference power, mainly due to

user 3. Observe that antenna 4 is not active, while antenna 14 serves users 2 and 4, simultaneously.

September 8, 2020

DRAFT

Table I: Summary of system and channel adopted parameter values, similar to those adopted in [6],
[19], [20]

16

T

Parameter
Pathloss attenuation exponent: γ
Median channel gain at a distance of 1 m: b0
Number of NLoS VRs for each user: NC
Antenna array length: L
Number of BS antennas (ULA), M
Number of mobile users, K
Minimum distance (dmin)
Maximum distance (dmax)
Number of Monte Carlo realizations:
Transmission bandwidth: B
Channel coherence bandwidth: BC
Channel coherence time: TC
Total UL noise power: σ2
UL
Total DL noise power: σ2
DL
UL pilot transmit power per user: pP
UL data transmit power per user: pUL
Total DL data transmit power: PDL
Fraction of UL transmission: ǫu
Fraction of DL transmission: ǫd
Power ampliﬁer eﬃciency at the users: ηUL
Power ampliﬁer eﬃciency at the BSs: ηDL
Computational eﬃciency at the BS: LBS
Fixed power consumption: PFIX
Power consumed by local oscillators at BS: PSYN
Power consumed by circuit components at BS: PBS
Power consumed by circuit components at UE: PUE
Power density for coding of data signals:

PCOD

Power density for decoding of data signals:

PDEC

Power density for backhaul traﬃc:

PBT

2.95

Value
2.5

10−4
·
3
60 m
100
4; 40
}
{
5 m
30 m
1,000
20 MHz
100 kHz
2 ms
100 dBm
80 dBm
0.1 W
0.1 W
1.0 W
0.4
0.6
0.5
0.4
Gﬂop/s
W
h
10 W
0.2 W
0.2 W
0.2 W
W
Gbit/s
W
Gbit/s
i
W
Gbit/s

i

h

i

h

h

i

−
−

75

0.1

0.8

0.25

+,-./!

+,-./$

+,-./#

+,-./"

! " # $

% & ) *

’ !( !! !"

!# !$ !% !&

Figure 3: Example of a XL-MIMO system, with 4 users being served by a BS equipped with a
16-antenna linear antenna array. The ﬁgure illustrates each user’s VR and the antennas that the
proposed algorithm designates to communicate with each user.

September 8, 2020

DRAFT

17

Therefore, considering that only one antenna was designated to communicate with 2 users at the

same time, we can say that the algorithm succeeded in avoiding the interference from other users to

aﬀect the SINR while reducing the computational complexity.

B. Dependency of the System Performance on N

In the following, we present numerical results demonstrating how the number of active antennas

per user (N ) inﬂuences the system performance, in terms of throughput and EE, and the resource

consumption, in terms of computational complexity and power consumption. From these results, we

can see the advantages of appropriately selecting the antennas subset (AS strategy) against utilizing

the whole antenna array strategy to serve all users at the same time (no-AS strategy). To reﬁne

the comprehension upon these results, which depend on the processing scheme (MR or ZF), Fig. 4

provides, for two diﬀerent scenarios (K = 4 and K = 40), valuable insights on how N inﬂuences

the received signal, interference and noise power, during the UL and during the DL, which are given

by the deﬁnitions in Table II.

Table II: Deﬁnitions considered in Fig. 4, in [dBm].

Deﬁnition 1: UL average received signal power:
K

log10 (cid:18)

SUL = 10
Deﬁnition 2: UL average received interference power

+ 30

Pk=1

}(cid:19)

pUL
k |
{

vH
k hk

2
|

·

1
K

E

IUL = 10

·

log10



1
K

K

K

Pk=1

Pi=1
i6=k

E

pUL
i
{

vH
k hi
|

2
|

+ 30


}






Deﬁnition 3: UL average received noise power

K

σ2
UL
K

E

·

log10 (cid:18)

NUL = 10
Pk=1
Deﬁnition 4: DL average received signal power
K

+ 30

}(cid:19)

{||

vk

2
||

log10 (cid:18)

SDL = 10
Deﬁnition 5: DL average received interference power

+ 30

Pk=1

}(cid:19)

pDL
k |
{

hH
k wk

2
|

1
K

E

·

K

K

·

E

1
K

pDL
i
{

hH
k wi
|

IDL = 10

log10 




}


Deﬁnition 6: DL average received noise power
NDL = 10

log10

+ 30

Pk=1

Pi=1
i6=k

2
|

·

σ2
DL
(cid:0)

(cid:1)

+ 30

Figures 4a and 4b compare the UL signal, interference and noise power, as given by the deﬁnitions

September 8, 2020

DRAFT

18

Def. 1 to 3, when the number of users is 4 and 40, respectively. When N < K, it is not possible to
H ˆH. First, one can see that the received
execute ZF, due to singularity problems with the matrix ˆH

power levels of ZF are higher than of MR. The reason is that ZF receive combining is the pseudoinverse
of ˆH (recall that the elements of the channel matrix include the pathloss eﬀect), while MR combining
is simply a copy of ˆH. Second, by comparing Figures 4a and 4b, one can observe that,as expected,
IUL) is higher than when K = 4, because the
selectivity of the receive combining deteriorates. Third, looking at the MR curves, one can verify

when K = 40, the received interference power (

that, by selecting more antennas to be active for each user, the received signal power increases,

but so does the interference and noise power. It does not occur when employing ZF combining. By

increasing N , ZF performs better at reducing the interference and noise power, because the receive

force the average received signal power (

combining becomes more selective. Fourth, if the channel estimates are reliable, ZF combining will
SUL) to pUL, as
combining. It can be observed in the ﬁgure, what attests that the channel estimation predicted by

2 = 1, from the deﬁnition of ZF
|

vH
k hk
|

eq. (6a) provides good estimates.

Unlike the UL case, during the DL (see Fig. 4c and 4d), the average received noise,

NDL, does not
depend on the precoding scheme (compare Def. 3 and 6). Another important point is that the desired
SDL) is the same magnitude order for both MR and ZF, because the precoding vectors
are normalized, unlike the combining vectors. Finally, as the total available DL transmit power (PDL)
is distributed among the K users, the individual DL transmit power (pDL

signal power (

k ) is inversely proportional

to K. That is why the average signal and interference power are smaller in Fig. 4d than in Fig. 4c.
IDL when employing MR precoding, which is less eﬃcient than ZF at eliminating

The exception is

the interference.

Fig. 4e and 4f depict the UL, DL and UL+DL throughput, given by B

SEUL, B

·

·

SEDL and B

SE,

·

respectively. The throughput resulting from the no-AS strategy can be obtained in the point N =

100. Thus, we can see that in a scenario with few active users, the AS strategy improves considerably

the system throughput when using MR. On the other side, considering the K = 40 scenario, the high

interference levels deteriorate the selectivity of MR combining and precoding, and the AS strategy

cannot improve the throughput. The same behavior is observed with ZF processing, independently of

the number of users. However, as the array is physically large and the users have a VR corresponding

to around 50% of the array, on average (as discussed in the beginning of Section V-A), increasing N

beyond M/2 can barely improves the throughput. Thus, by taking N close to M/2, we can obtain

almost the same throughput achieved with the no-AS strategy, as shown in Figures 4e and 4f, while

beneﬁting from lower computational complexity and consequently lower power consumption.

September 8, 2020

DRAFT

50

0

-50

-100

-150

-200

-20

-30

-40

-50

-60

-70

-80

-90

-100

-110

1.5

1

0.5

19

40

20

0

-20

-40

-60

-80

-100

-120

-140

-160

1

12

23

34

45

56

67

78

89

100

1

12

23

34

45

56

67

78

89

100

(a) UL received power, K = 4

(b) UL received power, K = 40

-30

-40

-50

-60

-70

-80

-90

-100

-110

1

12

23

34

45

56

67

78

89

100

1

12

23

34

45

56

67

78

89

100

(c) DL received power, K = 4

(d) DL received power, K = 40

12

10

8

6

4

2

0

1

12

23

34

45

56

67

78

89

100

0

1

12

23

34

45

56

67

78

89

100

(e) Throughput, K = 4

(f) Throughput, K = 40

Figure 4: Average received power of the desired signal, undesired signal (interference) and noise as
given by Def. 1 to 6), as well as the system throughput, during the UL and the DL data transmission.
Two scenarios are considered: K = 4 and K = 40 users.

September 8, 2020

DRAFT

20

C. Computational Complexity

While

k contains the indices of the N antennas that are active for user k, the set

D

contains

D

the indices of antennas Nact that are active for any of the K users. Fig. 5 addresses the dependency

of Nact on N . In the scenario with 4 users, the whole antenna array is expected to be active when

N

≥

34, approximately. When K = 40, Nact scales faster than when K = 4, and reaches the limit

of 100 when N

≈

8. If a small N is suﬃcient to substantially increase the EE or throughput, one

will beneﬁt from the reduced circuit power consumption, as PTC is proportional to Nact, according

to (33). It can be evidenced by Fig. 6c and 6d that with small values of N , the AS strategy provides

considerable reduction on the power consumption comparing to the entire antenna array activation

(no-AS strategy).

100

90

80

70

60

50

40

30

20

10

0

1

12

23

34

45

56

67

78

89

100

Figure 5: Average number of active antennas per user (N ) versus the total number of active BS
antennas (Nact).

Table III provides a quantitative analysis of the impact of the proposed HRNP-based AS scheme

on the overall XL-MIMO computational complexity, given by C = CCE + CTSP. The complexity

associated to the no-AS strategy can be obtained from (20), (21), (22) and (23) by simply replacing

N with M in these equations, and cancelling CSP,θ out in (25) and (26). The complexities are in

the unit of [ﬂop/s], which is given by BC/τc, recalling that C is measured in ﬂop per coherence

block [fpcb]. The ﬁrst three columns of the table deﬁne four scenarios, with diﬀerent values of M ,

N and K. The other columns contain the complexity associated to each processing scheme (MR and

ZF), when using or not the AS algorithm. Notice that the algorithm yields very lower complexities,

which is particularly advantageous in high system dimensions (many BS antennas and many users).

Also, although providing lower throughput than ZF, one can beneﬁt from using MR due to its much

September 8, 2020

DRAFT

21

smaller complexity. However, in the fourth scenario, the AS’s complexity surpasses the no-AS’s when

employing MR, because CSP,θ is the only term of CTSP that is proportional to K 2. It does not occur
with ZF, as the term C UL-ZF

SP-C is much more signiﬁcative than CSP,θ.

Table III: AS computational complexity in [Gﬂop/s], discriminated by processing scheme.

M N
4
32
16
128
512
64
256
2048

K no-AS MR AS MR no-AS ZF
4
2
76
8
3,848
32
702,031
128

1
12
369
17,551

4
62
990
15,834

AS ZF
1
14
819
126,822

Fig. 6a shows the linear dependency of the computational complexity on N and the remarkable

computational complexity reduction provided by the adopted AS strategy. As a consequence, there

is also a reduction in the total power consumption, deﬁned as Ptot = P UL

TX + PCP, as
depicted in Fig. 6c. Moreover, Fig. 6b reveals a signiﬁcant complexity increase when the number of

TX + P DL

TX + P tr

active users grows from 4 to 40. Furthermore, by avoiding all antennas to be simultaneously active,

the adopted HRNP-AS strategy in eq. (19) reduces the transceiver chains power consumption7,

and consequently the total power consumption, as indicated in Fig. 6c and 6d. As a ﬁnal remark

on the advantage in adopting the HRNP-AS strategy is the operation point where the AS power

consumption curves meet the no-AS curves is very close to the point where the average number of

active antennas meet M in Fig. 5.

D. Energy Eﬃciency

Fig. 7 conﬁrms the EE improvement when AS strategy based on highest received power is adopted.

Under reduced loading scenario (K = 4), the EE is maximized when N = 6 and N = 1 for

ZF and MR, respectively. It demonstrates that the HRNP-AS strategy can guarantee huge EE

improvements in a scenario with few users, while reducing considerably the power consumption and

the computational burden, as discussed above. On the other hand, results in Fig. 7b demonstrate that,

the AS strategy cannot improve the EE considerably when XL-MIMO operates under high loading

scenarios (K = 40). However, the HRNP-based AS strategy is still advantageous over the no-AS

strategy, as it still provides a considerable complexity reduction. Thus, regardless of the number of

users, it is not reasonable to use the whole antenna array to serve all users if about half of the

antennas is suﬃcient to achieve a remarkable EE increasing with a lower computational complexity.

7

Notice that from (33), power consumption is linearly dependent on Nact.

September 8, 2020

DRAFT

1010

3

2.5

2

1.5

1

0.5

0

1

49

48

47

46

45

44

43

42

22

1011

16

14

12

10

8

6

4

2

0

12

23

34

45

56

67

78

89

100

1

12

23

34

45

56

67

78

89

100

(a) Computational complexity, K = 4

(b) Computational complexity, K = 40

49

48

47

46

45

44

43

42

1

12

23

34

45

56

67

78

89

100

1

12

23

34

45

56

67

78

89

100

(c) Power consumption, K = 4

(d) Power consumption, K = 40

Figure 6: The average consumption of computational and power resources raises when increasing N ,
while depends on the adopted AS strategy.

70

60

50

40

30

20

10

1

12

23

34

45

56

67

78

89

100

140

120

100

80

60

40

20

0

1

12

23

34

45

56

67

78

89

100

(a) K = 4

(b) K = 40

Figure 7: Energy eﬃciency as a function of N , in both low and high loading scenarios: K = 4 and
K = 40.

September 8, 2020

DRAFT

23

E. Overall XL-MIMO Performance Comparison

Table IV shows the optimal number of selected antennas (N ∗) that maximizes the EE, when

employing both linear MR or ZF ﬁltering. According to the data, N ∗ is strongly inﬂuenced by the

number of active users K. As a rule of thumb, when the number of active users is up to a limit,

namely Kmax, the EE is maximized when the AS algorithm selects less than 10% of the antenna

array to communicate with each user, i.e., N ∗

≤

Kmax = 20 for MR and Kmax = 6 for ZF.

M/10. From the data in Table IV, we see that

Table IV: Optimal number of selected antennas for maximizing the EE (N ∗) versus the number of
active users.

K 2
N ∗ MR 3
5
ZF

4 6
8
1
1
1
6 8 64

10
1
62

12
1
60

16 20 24
1 48
1
57
57
58

32
48
60

40
48
65

50
47
75

Figs. 8a, 8b, 8c and 8d depict the EE, throughput, power consumption and computational com-

plexity, respectively, for the proposed HRNP-AS and no-AS strategy assuming N = N ∗. If the system

operates under the bound K

≤

Kmax, the HRNP-AS strategy provides an increasing in the EE and

simultaneously reduces the power consumption and the computational burden, while the throughput

is very close to the obtained with the no-AS strategy.

Besides, when increasing K until it is close to Kmax, the EE gradually decreases until it meets

the no-AS strategy EE curve. It occurs because taking N

M/10 is no longer enough to mitigate

the interference. Besides, from the point K = Kmax, N ∗ suddenly jumps to about 50 or 60% of the

≤

ULA array size, M = 100. Finally, when the XL-MIMO system operates over the maximum number

of user bound, K > Kmax, the AS-strategy is no longer able to improve the EE and simultaneously

reduce the power consumption considerably. However, it is still advantageous when compared to the

all-antennas activation strategy, as it is still able to reduce the computational burden.

VI. Conclusion

In XL-MIMO systems operating under non-stationary channels, the users see only a portion of

the antenna array and the majority of the energy sent by the users is concentrated on this part of

the array. Therefore, by appropriately selecting a subset of antennas that communicate to each user,

it can be guaranteed to capture almost the totality of the incident energy from that user, while

reducing substantially the interference coming from the other (K

1) users. As corroborated by

−

extensive numerical results, the HRNP antenna selection criterion reduces considerably the complexity

of computing the combiners and precoders and consequently reducing the power consumption also.

September 8, 2020

DRAFT

24

12

10

8

6

4

2

0

2 4 6 8 10 12

16

20

24

32

40

50

2 4 6 8 10 12

16

20

24

32

40

50

(a) Energy eﬃciency

(b) Throughput (sum rate)

50

49

48

47

46

45

44

43

42

41

150

100

50

0

3000

2500

2000

1500

1000

500

0

2 4 6 8 10 12

16

20

24

32

40

50

2 4 6 8 10 12

16

20

24

32

40

50

(c) Total computational complexity

(d) Total power consumption

Figure 8: EE, throughput, power consumption and computational complexity for the HRNP-AS and
and no-AS strategies taking N = N ∗.

Furthermore, when the AS-HRNP algorithm is set to select only a few N antennas per user, there may

be several antennas which are not activated, reducing the transceiver chains power consumption. As

the HRNP-based AS strategy results in almost the same spectral eﬃciency as the no-AS strategy and

a considerable substantial power consumption reduction, as a result, the EE is increased signiﬁcantly.

Furthermore, the extensive numerical results demonstrated the existence of an optimal value of N

in terms of maximizing the EE, which depends on the number of users and array size. Also, it is not

even advantageous to increase N beyond this optimal value, since neither the throughput nor the

EE would be considerably improved while computational burden and energy consumption increases

remarkably.

References

[1] F. Boccardi, R. W. Heath, A. Lozano, T. L. Marzetta, and P. Popovski, “Five disruptive technology directions

for 5g,” IEEE Communications Magazine, vol. 52, no. 2, pp. 74–80, 2014.

September 8, 2020

DRAFT

25

[2] T. L. Marzetta, “Noncooperative cellular wireless with unlimited numbers of base station antennas,” IEEE

Transactions on Wireless Communications, vol. 9, no. 11, pp. 3590–3600, November 2010.

[3] T. Marzetta,

E.

Larsson,

H.

Yang,

and H. Ngo,

Fundamentals

of Massive MIMO,

ser. Fundamentals

of Massive MIMO.

Cambridge University Press,

2016.

[Online]. Available:

https://books.google.com.br/books?id=IM0iDQAAQBAJ

[4] A. Chockalingam and B. S. Rajan, Large MIMO Systems. Cambridge University Press, 2014.

[5] E. de Carvalho, A. Ali, A. Amiri, M. Angjelichinoski, and R. W. H. Jr., “Non-stationarities in extra-large scale

massive MIMO,” CoRR, vol. abs/1903.03085, 2019. [Online]. Available: http://arxiv.org/abs/1903.03085

[6] E. Björnson, J. Hoydis, and L. Sanguinetti, “Massive MIMO networks: Spectral, energy, and hardware eﬃciency,”

Foundations and Trends R(cid:13) in Signal Processing, vol. 11, no. 3-4, pp. 154–655, 2017. [Online]. Available:

http://dx.doi.org/10.1561/2000000093

[7] H. Wang, A. Kosasih, C. Wen, S. Jin, and W. Hardjawana, “Expectation propagation detector for extra-large

scale massive mimo,” IEEE Transactions on Wireless Communications, vol. 19, no. 3, pp. 2036–2051, 2020.

[8] S. Hou, Y. Wang, T. Zeng, and S. Wu, “Sparse channel estimation for spatial non-stationary massive mimo

channels,” IEEE Communications Letters, vol. 24, no. 3, pp. 681–684, 2020.

[9] J. Li, B. Ai, R. He, M. Yang, Z. Zhong, Y. Hao, and G. Shi, “The 3d spatial non-stationarity and spherical wavefront

in massive mimo channel measurement,” in 2018 10th International Conference on Wireless Communications and

Signal Processing (WCSP), 2018, pp. 1–6.

[10] J. Chen, X. Yin, X. Cai, and S. Wang, “Measurement-based massive mimo channel modeling for outdoor los and

nlos environments,” IEEE Access, vol. 5, pp. 2126–2140, 2017.

[11] A. Ali, E. D. Carvalho, and R. W. Heath, “Linear receivers in non-stationary massive mimo channels with visibility

regions,” IEEE Wireless Communications Letters, vol. 8, no. 3, pp. 885–888, June 2019.

[12] A. Amiri, M. Angjelichinoski, E. de Carvalho, and R. W. Heath, “Extremely large aperture massive mimo: Low

complexity receiver architectures,” in 2018 IEEE Globecom Workshops (GC Wkshps), 2018, pp. 1–6.

[13] J. Flordelis, X. Li, O. Edfors, and F. Tufvesson, “Massive mimo extensions to the cost 2100 channel model:

Modeling and validation,” IEEE Transactions on Wireless Communications, vol. 19, no. 1, pp. 380–394, 2020.

[14] Y. Huang, S. He, J. Wang, and J. Zhu, “Spectral and energy eﬃciency tradeoﬀ for massive mimo systems,” IEEE

Transactions on Vehicular Technology, pp. 1–1, 2018.

[15] Y. Han, S. Jin, C. Wen, and X. Ma, “Channel estimation for extremely large-scale massive mimo systems,” IEEE

Wireless Communications Letters, pp. 1–1, 2020.

[16] A. Amiri, C. N. Manch’on, and E. de Carvalho, “Deep learning based spatial user mapping on extra large mimo

arrays,” 2020.

[17] J. Flordelis, F. Rusek, F. Tufvesson, E. G. Larsson, and O. Edfors, “Massive mimo performance—tdd versus fdd:

What do measurements say?” IEEE Transactions on Wireless Communications, vol. 17, no. 4, pp. 2247–2261,

April 2018.

[18] S. Boyd and L. Vandenberghe, Convex Optimization. Cambridge University Press, 2004.

[19] E. Björnson, L. Sanguinetti, J. Hoydis, and M. Debbah, “Optimal design of energy-eﬃcient multi-user mimo

systems: Is massive mimo the answer?” IEEE Transactions on Wireless Communications, vol. 14, no. 6, pp.

3059–3075, June 2015.

[20] J. C. M. Filho, C. Panazio, T. Abrão, and S. Tomasin, “Total energy eﬃciency of tr-mrc and fd-mrc receivers for

massive mimo uplink,” IEEE Systems Journal, vol. 13, no. 3, pp. 2285–2296, 2019.

September 8, 2020

DRAFT

