0
2
0
2

c
e
D
9

]
P
A

.
t
a
t
s
[

1
v
8
7
8
4
0
.
2
1
0
2
:
v
i
X
r
a

DISCOVERING
CLINICALLY MEANINGFUL SHAPE FEATURES FOR
THE ANALYSIS OF
TUMOR PATHOLOGY IMAGES

By Esteban Fern´andez Morales†, Cong Zhang†, Guanghua Xiao‡,
Chul Moon§, and Qiwei Li†,∗

The University of Texas at Dallas†, The University of Texas Southwestern
Medical Center‡, and Southern Methodist University§

With the advanced imaging technology, digital pathology imag-
ing of tumor tissue slides is becoming a routine clinical procedure
for cancer diagnosis. This process produces massive imaging data
that capture histological details in high resolution. Recent develop-
ments in deep-learning methods have enabled us to automatically
detect and characterize the tumor regions in pathology images at
large scale. From each identiﬁed tumor region, we extracted 30 well-
deﬁned descriptors that quantify its shape, geometry, and topology.
We demonstrated how those descriptor features were associated with
patient survival outcome in lung adenocarcinoma patients from the
National Lung Screening Trial (n = 143). Besides, a descriptor-based
prognostic model was developed and validated in an independent
patient cohort from The Cancer Genome Atlas Program program
(n = 318). This study proposes new insights into the relationship
between tumor shape, geometrical, and topological features and pa-
tient prognosis. We provide software in the form of R code on GitHub:
https://github.com/estfernandez/Slide Image Segmentation and Extraction.

1. Introduction. Lung cancer is the leading cause of cancer death for
both females and males (Siegel, Miller and Jemal, 2020). Lung adenocar-
cinoma (ADC) is heterogeneous in morphological features, highly volatile
in prognosis, and compromises half of all lung cancer cases (Matsuda and
Machii, 2015; Wang et al., 2018). While mortality rates have rapidly declined,
lung cancer in 2017 has caused more deaths than breast, prostate, colorectal,
and brain cancer combined (Siegel, Miller and Jemal, 2020).

With the advanced imaging technology, digital hematoxylin and eosin
(H&E)-stained pathology imaging of tumor tissue slides is becoming a routine
clinical procedure for cancer diagnosis. This process produces massive imag-
ing data that capture histological details in high spatial resolution. Recent
developments in deep-learning methods have enabled us to automatically

∗Address correspondence to qiwei.li@utdallas.edu.

1

 
 
 
 
 
 
2

FERN ´ANDEZ MORALES ET AL.

detect and characterize the tumor regions in pathology images on a large
scale (Wang et al., 2018). Through these developments, Wang et al. (2018)
discovered a relationship between tumor shape and patient survival outcome
in lung cancer patients. Although numerous studies have associated morpho-
logical features with patient prognosis (Wang et al., 2014; Yu et al., 2016;
Luo et al., 2017), this study was the ﬁrst to incorporate shape into a prog-
nostic model. Furthermore, this association reﬂects multiple studies in brain
and breast cancer (Kilday, Palmieri and Fox, 1993; Pohlman et al., 1996),
though further systemic research with additional techniques to represent and
quantify tumor shape is necessary.

Existing approaches to describe the shape and boundary of regions have
been the objective of shape analysis (Wirth, 2004; Mingqiang, Kidiyo and
Joseph, 2008). Shape representations characterize and visualize regions,
while shape descriptors quantify the regions themselves. These shape rep-
resentations, either one or two-dimensional, involve the regions or their
contours. From these shape representations, we can compute shape descrip-
tors to quantify the shape, geometry, and topology of the original regions.
In general, shape descriptors should be translation, rotation, and scale-
invariant (Mingqiang, Kidiyo and Joseph, 2008). Additionally, they should
be application-dependent with a low computational complexity (Zhang and
Lu, 2004).

In this paper, we develop a segmentation procedure and analysis pipeline
to study the relationship between tumor shape and patient survival outcome.
The analysis pipeline, based on Wang et al. (2018), can be summarized in
four parts: image pre-processing, feature extraction, survival analysis, and
predictive performance. Image pre-processing relies on an automated tumor
recognition system to convert raw pathology images into machine-readable
representations; the results lead to a feature extraction process that computes
shape, geometric, and topological features from the extracted tumors in the
pathology images. A regularized Cox proportional-hazards (CoxPH) model,
dependent on the shape-based features, is used as an objective prognostic
method. The evaluation of its predictive performance, adjusted for clinical
variables, concludes the analysis pipeline. We summarize these steps in
Figure 1.

SHAPE ANALYSIS OF TUMOR PATHOLOGY IMAGES

3

Fig 1. Analysis pipeline with segmentation procedure and survival analysis.

We organize the remaining of this paper as follows. Section 2 introduces
the segmentation procedure that allows us to extract tumors from pathology
images. Section 3 presents the shape representations used to represent tumors
and compute shape-based features; these features being deﬁned in Section 4.
In section 5, we evaluate the prognostic performance of these features, while
developing a shape-based prognostic model that varies from the one presented
in Wang et al. (2018). We discuss the results and conclude the paper in
Section 6.

2. Tumor Segmentation. We developed a processing procedure to
extract tumors in raw pathology images. Section 2.1 introduces the matrix
representation of a whole-slide image that is used by the procedure and
referred to as the reconstructed heat map. The intermediate tissue segmen-
tation step is outlined in Section 2.2, while the main tumor segmentation
step is detailed in Section 2.3.

2.1. Reconstructed Heat Map. Automatic tumor recognition systems,
such as the one developed in Wang et al. (2018), create machine-readable
representations of whole-slide images. A matrix results from the pathology
image given to the recognition system or other imaging tools, where each
entry corresponds to an empty region, non-malignant tissue, or tumor tissue
in the raw sample. We refer to this matrix as a reconstructed heat map,
which we can use to segment the tumor regions within the pathology image.
For example, an automatic tumor recognition systems can be used with H&E
stained pathology images (see Figure 2), where we can obtain a reconstructed
heat map, as shown in Figure 3 (top-left). We continue the processing

Automated Tumor Region Recognition System NormalTumorEmptyFeatureExtractionTopological(Total of 1)Boundary(Total of 10)Shape(Total of 19)Regularized CoxPH ModelClinical DataBiomarkersTumor SegmentationRaw ImageImage PatchPredicted TypeReconstructed HeatmapExtracted Tumor RegionPredictorsPatient Risk Score4

FERN ´ANDEZ MORALES ET AL.

procedure by segmenting the tissue regions.

Fig 2. An example of an H&E stained pathology image from a lung cancer patient in the
TCGA cohort.

Fig 3. Steps of tumor segmentation procedure. Top-left ﬁgure shows the reconstructed heat
map of the H&E stained pathology image. Bottom-right and bottom-left ﬁgures show the
identiﬁed tissue regions and segmented tumors, respectively. The key on the right shows the
integer coding for each tumor.

50100150200250300100200300400500Tumor RegionsSegmented Tissues50100150200250300Reconstructed Heatmap0123456SHAPE ANALYSIS OF TUMOR PATHOLOGY IMAGES

5

2.2. Tissue Segmentation. Since a pathology image can contain mul-
tiple tissue samples, disconnected tissue regions are identiﬁed and seg-
mented through standard morphological operations, usually based on a
four-connectivity (Gonzalez, Woods and Eddins, 2020). We show this seg-
mentation in Figure 3 (bottom-left). Furthermore, we remove the tissue
regions with an area less than one-fourth of the largest tissue region to
remove the eﬀects of small tissue samples (Wang et al., 2018). For each tissue
region, we can ﬁnalize the processing procedure by segmenting the tumor
regions.

2.3. Tumor Segmentation.

Individual tumor regions, which also contain
empty and non-malignant categories within them, were extracted from each
tissue region with a similar procedure as the tissue segmentation in Sec-
tion 2.2. Similarly, to reduce the inﬂuence of small tumors, we disregard
tumor regions with an area less than 150 and consider them as “islands” to an-
alyze, separately. We create two separate segmented matrices from the tumor
regions and the non-malignant categories, respectively; the non-malignant
categories make up the holes within the tumors. An integer coding is used to
diﬀerentiate each tumor and their respective holes. We show the segmented
tumor regions from the continued example in Figure 3 (bottom-left).

3. Shape Representations. From the segmented tumor regions, de-
tailed in Section 2.3, we can represent tumors with various one and two-
dimensional techniques. These representation techniques should have invari-
ance properties (rotation, scaling, translation), low computational complexity,
and being application-independent (Mingqiang, Kidiyo and Joseph, 2008).
Section 3.1 and the beginning of Section 3.2 make up the primary shape
representations, while the remaining sections make up the derived shape
representations.1 A visualization of these are shown in Figures 4 and 5, while
Table 1 summarizes the introduced notation. We begin by introducing the
binary matrix, which is used to represent individual tumors in the segmented
matrix.

1The derived shape representations depend on the primary representations.

6

FERN ´ANDEZ MORALES ET AL.

Table 1
Summary of original and derived shape representations.

Name

Notation

Support

Region Matrix
Polygon Chain
Convex Hull Chain
Bounding Box Chain
Chain Code
Curvature Chain Code
Radial Lengths
Normalized Radial Lengths
Smoothed Radial Lengths

Rwl ∈ {0, 1}
Pi· = (xi, yi) ∈ N2
PCHi· ∈ P
PMBBi· ∈ R2
ci ∈ N ∩ [0, 7]

RW ×L
P(n+1)×2
PCH
PMBB
c = [ci]1×n
∆c = [∆ci]1×n ∆ci ∈ N ∩ [−2, 2]
r = [ri]1×n
˜r = [˜ri]1×n
ˆr = [ˆri]1×n

ri ∈ R+
˜ri ∈ [0, 1]
ˆri ∈ [0, 1]

Fig 4. Examples for the 2-dimensional shape representations, based on a tumor region
in the NLST cohort. Top two make up the primary representations: region matrix and
polygon chain, respectively. Bottom two make up the derived representations: convex hull
and minimum bounding box, respectively. We overlay the polygon chain on the derived
representations.

0.00.20.40.60.81.00.00.20.40.60.81.04005006007008009001002003004005001176351526701876105140050060070080090010020030040050020040060080010000200400600SHAPE ANALYSIS OF TUMOR PATHOLOGY IMAGES

7

Fig 5. Examples for the 1-dimensional shape representations, based on the tumor region in
Figure 4. All four make up the derived shape representations: chain code, curvature chain
code, radial lengths, smoothed radial lengths, respectively. We overlay the mean for the two
bottom representations.

3.1. Binary Matrix. Let RW ×L be a binary matrix representing an arbi-
trary W -by-L image, containing a 4-connected region, where the foreground
and background are composed of ones and zeros, respectively. Additionally,
we can represent each pixel in the image as a point in a 2-dimensional discrete
plane, that is, each entry Rwl ∈ R can be denoted as a point (l, w) ∈ N2.
Furthermore, to diﬀerentiate between foreground and background points, let
IR : N2 → {0, 1} be the indicator function for an image matrix given by

IR(l, w) =

(cid:40)
1
0

(l, w) is a foreground pixel,
(l, w) is a background pixel.

The indicator function IR and distribution of points (l, w)’s will be used to
recreate the region’s contour in a two dimensional Cartesian plane, known
as the polygon chain.

3.2. Polygon Chain. We can ﬁnd the entries in the image matrix that
make up the region’s boundary to, subsequently, obtain the equivalent points

45046648249851453054601234567450466482498514530546−2−101201000200030000.00.20.40.60.81.001000200030000.00.20.40.60.81.08

FERN ´ANDEZ MORALES ET AL.

by using the Moore-Neighbor tracing algorithm, modiﬁed by Jacob’s stopping
criteria (Gonzalez, Woods and Eddins, 2020). The algorithm has three
arguments:

1. starting boundary point,
2. direction to traverse the boundary (clockwise or counter-clockwise),

and

3. the pixel connectivity.

Clearly, since the image matrix contains a 4-connected component, the pixel
connectivity must be four. Furthermore, in our case, the boundary shall be
traced in a clockwise direction. For the starting boundary point, we shall
choose the point that represents the lowest left-most entry in the region.
That is, let

(cid:26)

(cid:27)

S =

(li, wi) : IR(li, wi) = 1 ∧ wi = min
1≤k≤W

wk

be the collection of points that make up the region and are located in the
lowest y-coordinate such that

(l1, w1) =






S1
min
li

|S| = 1,
otherwise.

S

Applying the Moore-Neighbor tracing algorithm to the region matrix, results
in the points that make up the boundary of the region, speciﬁcally, where
the boundary begins at the lowest left-most area of the region and traverse
through the boundary in a clockwise direction.

From the boundary points, we can create a sequence of points, known
as the closed polygon chain, that represents the boundary of the region by
creating a closed and simple polygon. Let N = (cid:80)
l,w IR(l, w) be the total
number of points that make up the region and P(n+1)×2 be the collection of
points that make up the closed polygon chain of the region such that

1. n ≤ N is the number of boundary points,
2. Pi· = (xi, yi) ∈ N2, for i = 1, . . . , (n + 1), and
3. (x1, y1) = (xn+1, yn+1).

Through the polygon chain, we can derive further two- and one-dimensional
shape representations that can be used to compute speciﬁc descriptors.

3.2.1. Convex Hull Chain. The convex hull of an arbitrary shape is
deﬁned as the smallest convex polygon that encloses the shape. Therefore,
we can introduce the collection of points which create a closed and simple
polygon, known as the convex hull chain and denoted by PCH, such that

SHAPE ANALYSIS OF TUMOR PATHOLOGY IMAGES

9

1. the convex polygon created by PCH encloses the shape,
2. the number of points in PCH is less than or equal to n, and
3. each point PCHi· ∈ P.

Since the polygon chain forms a closed and simple polygon, we can use
the linear time algorithm introduced in Lee (1983) to obtain the points
Pi· ∈ P that make up the convex hull of the shape to, subsequently, create
the convex hull chain using the directional and starting point requirements
in Section 3.2.

3.2.2. Bounding Box Chain. The minimum area rectangle, or MAR,
encloses an arbitrary shape with the smallest area possible (Freeman and
Shapira, 1975). Let the minimum bounding box chain, denoted as PMBB, be
the 4 × 2 vector that makes up of the collection of points in the minimum
area rectangle. To determine these points, we make use of the theorem in
Freeman and Shapira (1975) which states that the minimum area rectangle
has a side collinear with the side of the convex polygon it encloses.

That is, to obtain the MAR of the shape formed by the polygon chain,
we need the convex hull chain. Additionally, at least one side of the convex
hull, formed by two points PCHi· and PCHi+1·, will align with one side of
the MAR. As a result, the linear-time algorithm presented in Toussaint
(1983) can be applied to PCH to construct PMBB. This algorithm obtains
the points PMBBi· ∈ PMBB and decreases the running time of the original
algorithm in Freeman and Shapira (1975) from O(n2) to O(n) by using
rotating calipers (Toussaint, 1983).

3.3. Chain Code. The slope of a shape’s contour can be approximated
by the directional changes between two consecutive boundary points. These
directional changes can be encoded to, essentially, assign a number (from 0
to 7) to each possible relative direction resulting in an encoding list, each
element known as the chain code, that provides a compact representation
of the shape’s contour (Wirth, 2004; Emmanuel O. Agu, 2014). Let c be a
1 × n vector representing the chain codes of the polygon chain where each
entry ci ∈ N ∩ [0, 7] corresponds to a direction in the 8-way split of the unit
circle and determined by a series of steps.

First, we determine the angle between the vector composed of the diﬀerence
between the two consecutive points and the x-axis, that is, let θi = arctan2(di)
be the resulting angle where di = Pi· − Pi+1· is the diﬀerence. Since θi ∈
[−π, π], we have to transform the angle to

ˆθi =

(cid:40)

θi
θi ≥ 0,
θi + 2π θi < 0,

10

FERN ´ANDEZ MORALES ET AL.

such that ˆθi ∈ [0, 2π). As a result, we can now determine the corresponding
chain code
(cid:36) ˆθi
π/4

ci =

(cid:39)

.

Clearly, we can see that this procedure splits the unit circle into eight equal
parts. Additionally, if the directional change does not exactly align within
the eight splits, then the rounding operator (cid:98) (cid:101) will approximate the chain
code to the nearest integer.

3.3.1. Curvature Chain Code. Let ∆c be a 1 × n vector representing the
curvature chain code such that each entry is formed from a transformation of
the diﬀerence between two consecutive chain codes, that is, let ˆdi = ci − ci+1
and

∆ci =






ˆdi + 7
ˆdi − 7
ˆdi

ˆdi < 2,
ˆdi > 2,
otherwise.

This simple chain code derivation estimates the curvature and contains
information on the convexity of the shape (Wirth, 2004).

3.4. Radial Lengths. Let r be a 1 × n vector of radial lengths, that is,
each entry ri = (cid:107)Pi· − Pc(cid:107), for i = 1, . . . , n, is the Euclidean distance from
the boundary point to the shape’s centroid (See Appendix A.1). Clearly,
the radial lengths are not scale-invariant (as the Euclidean distance is not).
Therefore, to properly analyze the structure of r, the individual radial lengths
must be normalized.

Let r(n) be the maximum radial length in r such that we can introduce
a 1 × n vector of normalized radial lengths, denoted as ˜r, where each entry
˜ri = ri / r(n), i = 1, . . . , n. By normalizing the radial lengths, we have obtain
a 1-dimensional signal that is scale-invariant and which we can use to analyze
the ﬁne details of the shape’s contour (Wirth, 2004).

3.4.1. Smoothed Radial Lengths. While the normalized radial lengths
make up a scale-invariant representation of the shape’s contour, this can
still produce extra noise that impacts shape descriptors. We can remove any
noise in the 1-dimensional signal of the shape by smoothing the normalized
radial lengths; speciﬁcally, we apply a mean ﬁlter with a size equal to 10%
of the shape’s perimeter to the normalized radial lengths (Pohlman et al.,
1996). Let the window size w be 10% of the shape’s perimeter and ˆr be a

SHAPE ANALYSIS OF TUMOR PATHOLOGY IMAGES

11

1 × n vector representing the smoothed radial lengths such that each entry

ˆri =

1
w

k
(cid:88)

j=i

I(j ≤ n) · ˜rj,

k = i + w − 1,

i = 1, . . . , n.

4. Feature Extraction. From the shape representations in Section 3,
we can compute shape-based features, known as shape descriptors. These
features allow us to quantify the shape, geometry, and topology of a tumor
and are categorized into either shape, boundary, or topological features.

The continuation of the processing procedure in Section 2, relies on con-
verting the segmented tumors in Section 2.3 to individual binary matrices.
Furthermore, The polygon chain for the contour of each tumor is created
and the derived shape representations are also obtained. From these results,
we can compute the tumor-level features of each category.

These categories and their respective features are introduced, below, while
Table 2 shows an example of some of the features extracted from the tumor
regions in Figure 3 (bottom-left). In Section 4.1, we introduce the shape fea-
tures while in Sections 4.2 and 4.3 we introduce the boundary and topological
features, respectively. The dependencies for these features are summarized
in Figure 6.

Table 2
Computed features from the tumor regions in Figure 3. Each row corresponds to a tumor
where the Tumor ID is based on the integer coding found on the key of Figure 3.

Tumor Thick-

# of Perimeter
ness Holes Perimeter

37
24
5
5
4
3

873
328
26
24
17
19

5801.6652
6928.8683
639.1371
667.2376
470.8528
509.9239

Area

159203.0
96094.5
3242.0
2821.5
2458.0
2016.5

Major Axis Minor Axis
Length

Length

Fibre
Length

Fibre
Width

644.0000
608.2032
117.2818
106.7748
113.0000
105.1036

404.00000
501.90189
67.34740
63.32211
38.00000
47.72370

55.961409
27.963134
10.489217
8.683261
10.949922
8.170879

2844.8712
3436.4710
309.0793
324.9355
224.4765
246.7911

ID

1
2
3
4
5
6

12

FERN ´ANDEZ MORALES ET AL.

Fig 6. Dependencies of shape descriptors and representations. Colored boxes refer to the
categories of the shape descriptors. Green denotes geometrical, grey topological, and orange
shape.

4.1. Shape Features. The shape features characterize the geometry and
shape of tumor, relying on the 2-dimensional shape representations, that is,
the binary matrix R, polygon chain P, convex hull chain PCH, and bounding
box chain PMBB. We begin by introducing the region moments, features
derived from regular statistical moments.

𝐑=𝑅!"#×%ThicknessNet AreaAspect RatioElongationHu’s Moment 𝐻&Number of HolesEuler Number𝐏=𝑃’.)*&×+PerimeterFilled AreaCompactnessRoundnessCircularityConvexityDensityFibre LengthFibre WidthMajor Axis LengthMajor Axis AngleMinor Axis LengthEccentricityRectangularityCurl𝐏!"𝐏#$$𝐜=𝑐’&×)𝚫𝐜=Δ𝑐’&×)𝐫=𝑟’&×)Bending EnergyTotal Absolute CurvatureMean of (𝐫Standard Deviation of (𝐫EntropyArea RatioZero Crossing CountAverage RoughnessMargin Fluctuation&𝐫=̂𝑟’&×)’𝐫=̃𝑟’&×)Hu’s Moment 𝐻+Hu’s Moment 𝐻,Hu’s Moment 𝐻-Hu’s Moment 𝐻.Hu’s Moment 𝐻/Hu’s Moment 𝐻0Number of ComponentsSHAPE ANALYSIS OF TUMOR PATHOLOGY IMAGES

13

4.1.1. Region Moments. Since we can view the entries in the region matrix
as points in a 2-dimensional discrete plane, we can view the points as a
statistical distribution in a 2-dimensional space (Emmanuel O. Agu, 2014).
From this statistical distribution, we can calculate the concrete physical
properties, known as statistical moments, of the region (Emmanuel O. Agu,
2014).

We start with the low-order moments, denoted as mpq and known as the

ordinary moments of order p and q, given by

mpq =

(cid:88)

l,w

IR(l, w) · lpwq

and identical to standard statistical moments; that is, mpq takes the pth
moment in the l-direction and the qth moment in the w-direction.

Clearly, ordinary moments are not translation-invariant as the values
depend on the lw-coordinates. Therefore, central moments, denoted as µpq,
measure characteristic properties with respect to the region’s centroid (¯l, ¯w)
which result in translation-invariant features. The central moments are, hence,
given by

(cid:88)

µpq =

IR(l, w) · (l − ¯l)p · (w − ¯w)q

where the centroid (¯l, ¯w) is determined by

l,w

¯l =

m10
m00

and

¯w =

m01
m00

.

Although central moments are translation-invariant, they are impacted by
the area of the region and are, thus, not scale-invariant.

Normalizing the central moments by some uniform factor allows the
computation of translation- and scale-invariant features (Emmanuel O. Agu,
2014). This normalization procedure yields the normalized central moments,
denoted as ηpq, given by

ηpq = µpq ·

(cid:18) 1
µ00

(cid:19)(p+q+2)/2

such that (p + q) ≥ 2. With the normalized central moments, we can derive
the linear combinations known as Hu’s moments, denoted as Hi, which are
invariant to translation, rotation, and scaling (Emmanuel O. Agu, 2014).
Although Hu’s moments are linear, their formulation cannot be generalized.

14

FERN ´ANDEZ MORALES ET AL.

Therefore, we only give the ﬁrst three of Hu’s moments given by

H1 = η20 + η02
H2 = (η20 + η02)2 + 4 · η2
11
H3 = (η30 − 3 · η12)2 + (3 · η21 − η03)2

...

4.1.2. Aspect Ratio. The aspect ratio is the relationship between the

dimensions of the image and is given by

AspectRatio(R) =

W
L

,

where W and L are the width and length of the image, respectively (Wirth,
2004). Unlike other descriptors, the aspect ratio does not depend on the
shape of the region within the image.

4.1.3. Net Area. The net area is the number of pixels that make up the

region:

AreaNet(R) =

(cid:88)

l,w

Rwl = |R| .

4.1.4. Thickness. The thickness of a region, without holes, is determined

by the number of of erosion steps until the region disappears:

Thickness(R) = |E| = d,

where E := {Ri} is the sequence of eroded region matrices such that Ri =
Erode(Ri−1), R1 = R, and |Rd| = 0, for i = 1, . . . , d (Wirth, 2004).

4.1.5. Elongation. The elongation of a region is the relationship between

the area and the squared-thickness, given by

Elongation(R) =

AreaNet(R)
2 · (Thickness(R))2 ;

we note that this descriptor becomes distorted as the curvature of the region
increases (Wirth, 2004).

4.1.6. Perimeter. The perimeter is the length of the region’s contour, an

approximation to number of pixels that make up the region:

Perimeter(P) =

n
(cid:88)

i=1

(cid:107)Pi· − Pi+1·(cid:107) .

SHAPE ANALYSIS OF TUMOR PATHOLOGY IMAGES

15

4.1.7. Filled Area. The ﬁlled area is the approximate area of the polygon

that represents the region, estimated using Gauss’s area formula:

AreaFilled(P) ≈

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

1
2

n
(cid:88)

i=1

(cid:12)
(cid:12)
(cid:12)
(xiyi+1 − xi+1yi)
(cid:12)
(cid:12)

This descriptor is also known as the area of connected region, that is, the
area of the region without holes (Emmanuel O. Agu, 2014).

4.1.8. Compactness. The compactness of a region is a dimensionless
quantity that increases as the irregularity of the shape increases, given by
the relationship between perimeter and area (Castleman, 1996). That is, the
formulae is given by

Compactness(P) =

(Perimeter(P))2
AreaFilled(P)

.

4.1.9. Roundness. The roundness of a region is the compactness normal-
ized against a ﬁlled circle, that is, the relationship between the area of the
region and the area of a circle with the same perimeter (Wirth, 2004). The
formulae is given by

Roundness(P) = 4π ·

AreaFilled(P)
(Perimeter(P))2

4.1.10. Fibre Length and Width. The ﬁbre length and width are, clearly,
another form of measurements for a shape’s length and width, respectively.
The ﬁbre length is given by

FibreLength(P) =

Perimeter(P) −

(cid:113)

(Perimeter(P))2 − 16 · AreaFilled(P)

4

and the ﬁbre width by

FibreWidth(P) =

AreaFilled(P)
FibreLength(P)

.

4.1.11. Circularity. The circularity of a region is the relationship between
the area of the region and the area of a circle with same convex perimeter:

Circularity(P, PCH) = 4π ·

AreaFilled(P)
(Perimeter(PCH))2 .

This descriptor decreases as the shapes becomes less circular, but is relatively
insensitive to irregular boundaries (Wirth, 2004).

16

FERN ´ANDEZ MORALES ET AL.

4.1.12. Convexity. The convexity of a region is the relationship between

the perimeter of the region’s convex hull and the perimeter of the region:

Convexity(P, PCH) =

Perimeter(PCH)
Perimeter(P)

.

Therefore, this descriptor quantiﬁes how much the shape diﬀers from a convex
shape as well as accounting for any irregularities along the boundary of the
shape (Wirth, 2004).

4.1.13. Density. The density of a region is a measurement of solidity,
obtained from the ratio of the area of the region to the area of the region’s
convex hull (Wirth, 2004). That is,

Density(P, PCH) =

AreaFilled(P)
AreaFilled(PCH)

.

4.1.14. Major Axis Length. The major axis length is the length of the
line segment that runs along the longest part of the region and is, clearly, an
approximate measurement of the region’s length (Wirth, 2004; Emmanuel O.
Agu, 2014). The formulae is given by

MajorAxisLength(PMBB) = (cid:107)bl(cid:107) ,

where l = arg max

1≤i≤4

(cid:107)bi(cid:107) and bi = PMBBi· − PMBBi+1·.

4.1.15. Major Axis Angle. The major axis angle describes the direction

of the major axis, relative to the x-axis, and is given by

MajorAxisAngle(PMBB) = arctan2(bk).

4.1.16. Minor Axis Length. Opposite to the major axis length, the minor
axis length is the length of the line segment that runs along the shortest part of
the region (Emmanuel O. Agu, 2014). Clearly, an approximate measurement
of the region’s width (Wirth, 2004). The formulae is given by

MinorAxisLength(PMBB) = (cid:107)bs(cid:107) ,

where s = arg min
1≤i≤4

(cid:107)bi(cid:107) and bi = PMBBi· − PMBBi+1·.

SHAPE ANALYSIS OF TUMOR PATHOLOGY IMAGES

17

4.1.17. Eccentricity. The eccentricity of a region is the relationship be-
tween the major and minor axis; this descriptor is another way to measure
the elongation of a region and is given by

Eccentricity(PMBB) =

MajorAxisLength(PMBB)
MinorAxisLength(PMBB)

We notice that as the eccentricity approaches one, the shape of the region
becomes less elongated and roughly square or circular (Wirth, 2004).

4.1.18. Rectangularity. The rectangularity of a region is the relationship
between the area of a region and the area of the region’s minimum bounding
box, given by

Rectangularity(P, PMBB) =

AreaFilled(P)
AreaFilled(PMBB)

.

4.1.19. Curl. The curl of a region quantiﬁes how much its shape is “curled

up”, given by

Curl(P, PMBB) =

MajorAxisLength(PMBB)
FibreLength(P)

.

We can see that as the descriptor decreases, the degree to which the region
is “curled up” increases (Wirth, 2004).

4.2. Boundary Features. The boundary features characterize the contour
of the tumor, relying on the 1-dimensional shape representations, that is,
the chain code c, curvature chain code ∆c, radial lengths ˜r, smoothed
radial lengths ˆr. We begin by introducing the contour-equivalent of the
region moments: the boundary moments. We rely on the radial lengths r,
but Mingqiang, Kidiyo and Joseph (2008) notes that any 1-dimensional
representation works.

4.2.1. Boundary Moments. Using the radial lengths as a 1-dimensional
representation, we can reduce the dimension of the shape with boundary
moments (Mingqiang, Kidiyo and Joseph, 2008; Sonka, Hlavac and Boyle,
2014). Similar to region moments, we can estimate both the pth moment mp
and central moment µp by

mp =

1
n

n
(cid:88)

(ri)p

i=1

and µp =

1
n

n
(cid:88)

i=1

(ri − m1)p.

18

FERN ´ANDEZ MORALES ET AL.

Additionally, we also have two normalized moments given by

¯mp =

mp
(µ2)r/2

and ¯µp =

µp
(µ2)r/2

which are invariant to translation, rotation, and scaling. From these moments,
less noise-sensitive descriptors can be obtained and are given by

F1 =

(µ2)1/2
m1

, F2 =

µ3
(µ2)3/2

,

and F3 =

µ4
(µ2)2 .

4.2.2. Bending Energy. The total bending energy of a region is, theoret-
ically, the energy necessary to bend a rod the shape of the region (Wirth,
2004). As a result, the minimum value for this descriptor is 2π
R for a circle of
radius R (Wirth, 2004). This robust descriptor is given by

E∆c =

1
n

n
(cid:88)

i=1

(∆ci)2.

4.2.3. Total Absolute Curvature. The total absolute of a curvature for a

region is given by

∆ctotal =

1
n

n
(cid:88)

i=1

|∆ci| ,

where the minimum is obtained for all convex shapes (Wirth, 2004).

4.2.4. Radial Mean and Standard Deviation. The average of the normal-

ized radial lengths is given by

¯r =

1
n

n
(cid:88)

i=1

˜ri

and can measure macroscopic changes in the shape’s contour. Similarly, the
standard deviation is given by

sr =

(cid:118)
(cid:117)
(cid:117)
(cid:116)

1
n

n
(cid:88)

i=1

(˜ri − ¯r)2

and can indicate ﬁne contour changes.

SHAPE ANALYSIS OF TUMOR PATHOLOGY IMAGES

19

4.2.5. Circularity. Another derivation for the circularity of a region, using

the normalized radial lengths, is given by

Circularity(˜r) =

¯r
sr

,

where ¯r and sr are the mean and standard deviation of the radial lengths,
respectively. This derivation increases as the shape becomes more circu-
lar (Haralick, 1974).

4.2.6. Entropy. The entropy relies on the K-bin histogram of the radial
lengths and is a probabilistic measure that quantiﬁes how well the radial
lengths can be estimated (Kilday, Palmieri and Fox, 1993; Wirth, 2004). The
formulae is given by

K
(cid:88)

E(˜r) = −

pk log(pk),

k=1
where pk is the kth entry of the K-bin histogram2. This descriptor incorporates
the roundness and roughness of a shape (Kilday, Palmieri and Fox, 1993).

4.2.7. Area Ratio. The area ratio measures how much of the shape is
outside the circle with a radius deﬁned by the radial mean, describing the
macroscopic characteristics of the shape (Kilday, Palmieri and Fox, 1993).
The formulae is given by

AreaRatio(˜r) =

1
n · ¯r

n
(cid:88)

i=1

I(˜ri > ¯r) · (˜ri − ¯r).

4.2.8. Zero-crossing Count.

In conjunction with the area ratio, the zero-
crossing count measures the number of times the shape crosses the contour of
the circle with a radius deﬁned by the radial mean. This descriptor captures
the ﬁne detail of the shape’s contour and is given by

ZeroCrossing(˜r) =

n
(cid:88)

I

i=1

(cid:110)

(˜ri − ¯r) · (˜ri+1 − ¯r) < 0

(cid:111)
.

4.2.9. Average Roughness Index. The average roughness index divides
the contour of the shape into small segments of equal length, computing

2Kilday, Palmieri and Fox (1993) relied on the 100-bin probability histogram to compute

the entropy of tumor regions.

20

FERN ´ANDEZ MORALES ET AL.

a roughness measure on each segment and averaging the results (Kilday,
Palmieri and Fox, 1993). That is,

AveR(˜r) =

(cid:22) l
n

(cid:23) (cid:98)n/l(cid:99)
(cid:88)

j=1

R(j),

where l is the number of points in a ﬁxed interval and

R(j) =

l+j
(cid:88)

k=j

|˜rk − ˜rk+1| ,

j = 1, . . . ,

(cid:107)

.

(cid:106) n
l

4.2.10. Margin Fluctuation. The margin ﬂuctuation is the standard de-
viation of the diﬀerences between the normalized radial lengths and their
corresponding smoothed radial length, that is,

MarginFluctuation(˜r, ˆr) =

(cid:118)
(cid:117)
(cid:117)
(cid:116)

1
n

n
(cid:88)

(di − ¯d)2

i=1

where di = ˜ri − ˆri and

¯d =

1
n

(cid:88)

i=1

di.

This descriptor was shown to be greater for spiculated shapes in Giger,
Vyborny and Schmidt (1994).

4.3. Topological Features. The topological features are not impacted by
degradations or deformations in the shape (Wirth, 2004). Therefore, they are
invariant to rotation, scaling, and translation. These makes them useful global
shape descriptor, that can characterize the structure of a region (Wirth, 2004;
Emmanuel O. Agu, 2014). Features based on topological data analysis, have
been a rising focus of shape analysis. Although, in this section, we introduce
only three simple topological features.

4.3.1. Number of Holes. The number of holes within a region is a simple

and robust measurement, given by

NH (R) = max

k

Segment(H),

where H := FillHoles(R) − R is the matrix that contains the holes.

SHAPE ANALYSIS OF TUMOR PATHOLOGY IMAGES

21

4.3.2. Number of Connected Components. The number of connected com-
ponents is, trivially, the number of regions in the image based on a 4-
connectivity or 8-connectivity (Gonzalez, Woods and Eddins, 2020) and is
given by

NR(R) = max

k

Segment(R).

4.3.3. Euler Number. The Euler number is the number of connected

components minus the number of holes:

NE(R) = NR(R) − NH (R).

This simple descriptor is invariant to rotation, scaling, translation (Wirth,
2004).

5. Real Data Analysis. We studied the association between tumor
shape and prognostic outcomes by applying univariate and multivariate
survival analysis techniques to real data. Section 5.1 describes the univariate
and multivariate survival analyses, while Section 5.2 concludes the chapter
by developing and validating a prognostic model to predict patient survival
outcomes.

Two independent cohorts provided the pathology images with the cor-
responding clinical data. Speciﬁcally, the National Lung Screening Trial
(NLST) provided 267 40× images for 143 lung ADC patients, while The
Cancer Genome Atlas (TCGA) program provided 457 40× images for 318
lung ADC patients.3 We considered the NLST dataset for initial analyses
and training of the prognostic model while the TCGA dataset was used only
for validation purposes. Table 3 presents a clinical summary of the patients
in each cohort.

3The NLST website (https://biometry.nci.nih.gov/cdas/learn/nlst) provides additional
information on how the images, based on H&E-stained slides from blocks of tissues, were
obtained.

22

FERN ´ANDEZ MORALES ET AL.

Table 3
Patient characteristics of training and validation datasets. Hypothesis testing was
performed to test the diﬀerences in the two patient cohort; two sample t-test (unequal
variances) was used for age and chi-square test for remaining variables.

NLST (training) TCGA (validation)

p-value

Number of Patients
Age
Gender
Male
Female

Smoking Status

Yes
No
Stage
I
II
III
IV

143
64.01±5.19

318
64.52±10.28

80 (55.9%)
63 (44.1%)

75 (52.4%)
68 (47.6%)

95 (66.4%)
15 (10.5%)
23 (16.1%)
10 (7%)

137 (43.1%)
181 (56.9%)

214 (67.3%)
104 (32.7%)

174 (54.7%)
78 (24.5%)
45 (14.2%)
21 (6.6%)

0.4819
0.0140

0.0032

0.0066

Values are either mean ± standard deviation, or number (percentage).

The automated tumor recognition system, based on a convolutional neural
network (CNN) and developed in Wang et al. (2018), created a reconstructed
heat map from each pathology image. Furthermore, each reconstructed heat
map was processed using the procedure in Section 2, resulting in their shape
representations and shape-based features. The aforementioned 30 features
were computed for each tumor region. Only the primary tumor regions were
kept, that is, the largest tumor region in the largest tissue sample of each
slide image.

We note that, for each analysis, the response is overall survival, deﬁned as
the period from diagnosis until death or last contact. Additionally, whenever
possible, we adjust for clinical variables (age, gender, smoking status, and
stage) and account for patients with multiple slide images by clustering
patient identiﬁers. If clustering is unavailable, we summarize the features at
the patient-level, using the median. Survival analysis was performed with R
software, version 4.02, and R packages survival (version 3.2-7) and glmnet
(version 4.0-2) (Simon et al., 2011; R Core Team, 2020; Therneau, 2020).
The results were considered signiﬁcant if the two-tailed p-value ≤ 0.05 and
the analyses were based on the methodology in Wang et al. (2018).

SHAPE ANALYSIS OF TUMOR PATHOLOGY IMAGES

23

5.1. Survival Analysis. We ﬁt a univariate Cox proportional-hazards
model (CoxPH) to each scaled feature4, adjusting for age, gender, smoking
status, and stage as well as clustering by patient identiﬁers, to study the
association between each individual feature and prognostic outcome. The
results, using the NLST dataset, are summarized in Table 4. Only eight
features were statistically signiﬁcant (p-value ≤ 0.05) with patient survival
outcome. Out of the eight, seven were shape features, one was a topological
feature, while none were boundary features. All of these features were corre-
lated with poor survival outcome with hazard ratios (HRs) > 1). Serving as
a negative control, the aspect ratio and major axis angle were not correlated
with patient prognosis (p-value > 0.05; Table 4).

Table 4
Univariate analysis of shape-based features in NLST training dataset. A Cox
proportional-hazards (CoxPH) model was ﬁtted to each scaled feature, clustering by patient
identiﬁer (Patient ID) and adjusting for clinical variables (see Section 5.1).

Coeﬃcient Hazard ratio (HR)

Standard error (SE) Robust SE

p-value

Aspect Ratio
Net Area
Elongation
Thickness
Number of Holes
Polygon-Based Perimeter
Polygon-Based Area
Compactness
Roundness
Circularity
Convexity
Density
Major Axis Length
Major Axis Angle
Minor Axis Length
Rectangularity
Eccentricity
Fibre Length
Fibre Width
Curl
Total Absolute Curvature
Bending Energy
Radial Mean
Radial SD
Radial-Based Circularity
Radial Entropy
Area Ratio
Zero-crossing Count
Average Roughness Index
Margin Fluctuation

-0.0403
0.2547
-0.2347
0.2577
0.2432
0.3404
0.2631
0.0349
0.1258
0.0857
0.0800
0.2305
0.3738
-0.0744
0.2767
0.1342
-0.2324
0.2481
0.3336
0.0238
0.1121
0.1099
0.0862
-0.0670
0.0720
-0.0507
-0.0474
0.1040
-0.1156
-0.0669

Bolding signiﬁes features with p-value ≤ 0.05.

0.9605
1.2901
0.7908
1.2939
1.2753
1.4055
1.3009
1.0355
1.1340
1.0895
1.0833
1.2593
1.4532
0.9283
1.3188
1.1436
0.7926
1.2816
1.3959
1.0240
1.1186
1.1162
1.0901
0.9352
1.0747
0.9506
0.9537
1.1096
0.8908
0.9353

0.1177
0.0946
0.1613
0.1017
0.0920
0.1178
0.0962
0.1263
0.1212
0.1271
0.1244
0.1332
0.1148
0.1117
0.1132
0.1213
0.1168
0.1023
0.1178
0.1215
0.1200
0.1203
0.1226
0.1188
0.1172
0.1174
0.1203
0.1127
0.1552
0.1104

0.1059
0.1321
0.1416
0.1236
0.0974
0.1380
0.1230
0.1223
0.1357
0.1531
0.1428
0.1528
0.1363
0.1147
0.1317
0.1440
0.1207
0.1182
0.1375
0.1198
0.1628
0.1623
0.1343
0.1161
0.1195
0.1118
0.1226
0.1275
0.2609
0.1203

0.7031
0.0538
0.0976
0.0370
0.0125
0.0136
0.0324
0.7756
0.3539
0.5754
0.5752
0.1314
0.0061
0.5169
0.0356
0.3514
0.0542
0.0358
0.0153
0.8428
0.4912
0.4984
0.5209
0.5642
0.5466
0.6503
0.6992
0.4146
0.6577
0.5785

All shape-based features, scaled like in the univariate analysis, were selected

4Features were scaled (standardized) by their respective mean and standard deviation.

24

FERN ´ANDEZ MORALES ET AL.

to build a multivariate Cox proportional-hazards model with a lasso penalty;
using Harrell’s concordance measure, the penalty coeﬃcient λ was determined
through 10-fold cross validation (Simon et al., 2011; Wang et al., 2018). We
chose the penalty coeﬃcient λ such that this value was within 1 standard
error of the value that gave the minimum mean cross-validated error (Simon
et al., 2011). The mean cross-validated errors for various penalty coeﬃcients
λ are shown in Figure 7 (left).

Fig 7. Results from the regularized Cox proportional-hazards (CoxPH) model. The left
ﬁgure shows the mean cross-validated errors, based on Harrell’s concordance measure, for
each penalty coeﬃcient λ. The right ﬁgure shows the importance of each feature kept by the
regularized CoxPH model, based on the magnitude of each coeﬃcient.

Similarly, we summarized the standardized coeﬃcients kept by the regu-
larized CoxPH model in Table 5. Scaling the feature before ﬁtting the model,
allowed us to obtain the standardized coeﬃcients. This allowed us to compare
the regularized coeﬃcients with the coeﬃcients obtained in the univariate
analysis (Table 4). Additionally, we can also show the importance of each
feature in Figure 7 (right), based on the magnitudes of each regularized
coeﬃcient. Clustering of patient identiﬁers was not used in the regularized
Cox proportional-hazards model; instead, we summarized the features at
the patient-level. The shape-based prognostic model, based on the predicted
risk score of the regularized CoxPH model, was developed, and its predictive
performance validated as follows.

5.2. Predictive Performance. Since the multivariate model in Section 5.1
was based on the patient-level features, similar processing was applied to
the TCGA cohort. Additionally, the features were centered and scaled based
on the means and standard deviations of the features in the NLST cohort.
These transformations prevent bias and allow us to independently validate

−8−7−6−5−4−3−20.50.60.70.80.91.0Log(l)Concordance Index282828282724211921201816129886411Zero Crossing CountNumber of HolesMinor Axis LengthMajor Axis AngleRoundnessEccentricityElongationAverage Roughness IndexPolygon−Based PerimeterMagnitude of Regularized Coefficient0.00.10.20.30.40.5SHAPE ANALYSIS OF TUMOR PATHOLOGY IMAGES

25

Table 5
Multivariate analysis of shape-based features in NLST training dataset. A regularized Cox
proportional-hazards (CoxPH) model with a lasso penalty was ﬁtted to each scaled feature.
The penalty coeﬃcient λ was chosen based on 10-fold cross validation. The resulting
coeﬃcient values can be compared to the univariate coeﬃcients summarized in Table 4.

Coeﬃcient

exp(Coeﬃcient)

Aspect Ratio
Net Area
Elongation
Thickness
Number of Holes
Polygon-Based Perimeter
Polygon-Based Area
Compactness
Roundness
Circularity
Convexity
Density
Major Axis Length
Major Axis Angle
Minor Axis Length
Rectangularity
Eccentricity
Fibre Length
Fibre Width
Curl
Total Absolute Curvature
Bending Energy
Radial Mean
Radial SD
Radial-Based Circularity
Radial Entropy
Area Ratio
Zero-crossing Count
Average Roughness Index
Margin Fluctuation

–
–
-0.3276
–
0.0754
0.5106
–
–
0.2139
–
–
–
–
-0.1956
0.0888
–
-0.2600
–
–
–
–
–
–
–
–
–
–
0.0054
0.3468
–

–
–
0.7206
–
1.0783
1.6663
–
–
1.2385
–
–
–
–
0.8223
1.0929
–
0.7710
–
–
–
–
–
–
–
–
–
–
1.0054
1.4145
–

26

FERN ´ANDEZ MORALES ET AL.

the prognostic performance of this model. A shape-based risk score was
computed for each patient to assign patients into predicted high-risk and
low-risk groups, using the median as a cutoﬀ (Wang et al., 2018). The survival
curves for the predicted high-risk and low-risk groups were estimated using
the Kaplan-Meier method and are shown in Figure 8, as well as the results
of the log-rank test to compare the survival diﬀerence between risk groups.
We associate a worse survival outcome with the predicted high-risk group
(log-rank test, p-value = 0.0049, Figure 8).

Fig 8. Survival curves, estimated using the Kaplan-Meier method, for both high-risk and
low-risk groups. A log-rank test was performed to test the diﬀerence between these two
curves. The p-value of the log-rank test is overlaid and the 95% pointwise conﬁdence
intervals are also shown for each risk group.

The prognostic performance of the shape-based risk score was validated by
a multivariate CoxPH model and the resulting coeﬃcients are summarized in
Table 6. After adjusting for clinical variables, including age, gender, smoking
status, and stage, the predicted risk groups independently predicted prognosis
(high-risk vs. low-risk, HR = 2.11, CI 1.24–3.59, p-value = 0.0059, Table 6).

010002000300040005000600070000.00.20.40.60.81.0Time (Days)Survival ProbabilityHigh−RiskLow−Risklog−rank test, p−value = 0.0049SHAPE ANALYSIS OF TUMOR PATHOLOGY IMAGES

27

Table 6
Multivariate analysis of the predicted risk group. A Cox proportional-hazards (CoxPH)
model was ﬁtted to test the predictive performance of the predicted risk group, adjust for
clinical variables and based on the TCGA cohort.

Hazard Ratio (HR) with 95% conﬁdence interval (CI)

p-value

High-Risk vs. Low-Risk
Age
Female vs. Male
Smoker vs. Non-Smoker
Stage II vs. Stage I
Stage III vs. Stage I
Stage IV vs. Stage I

2.11 (1.24–3.59)
1.02 (0.99–1.04)
1.66 (0.94–2.96)
0.81 (0.48–1.36)
2.48 (1.34–4.59)
4.98 (2.59–9.61)
3.48 (1.46–8.28)

0.0059
0.2008
0.0829
0.4200
0.0038
≤ 0.001
0.0047

Bolding signiﬁes features with p-value ≤ 0.05.

6. Discussion and Conclusion. A whole-slide image processing pro-
cedure was developed to extract tumor regions and compute shape-based
descriptors from them. This procedure facilitated the analyses performed to
study the association between tumor shape and patient survival outcome.
While this procedure successfully extracted and visualized tumor regions,
further inspection is necessary to ensure the extracted objects accurately
represent the tumors in the whole-slide image. Speciﬁcally, various morpho-
logical operations (Gonzalez, Woods and Eddins, 2020) could be used in the
procedure to improve the main tumor representation.

The univariate analysis discovered eight statistically signiﬁcant features
(at the 5% level of signiﬁcance); of these eight features, seven attempted to
quantify the size and length of the tumor: thickness, polygon-based perimeter
and area, major and minor axis length, and ﬁbre length and width (Table 4).
The only topological feature proved to be signiﬁcant: the number of holes,
which quantiﬁes the degradations within the tumors. We note that none
of these seven features were based on the derived shape representations;
speciﬁcally, the thickness feature was based on the binary matrix, while the
remaining features were based on the polygon chain. Therefore, with the
features used, the derived shape representations were ineﬀective in diversifying
the tumor shape. Interestingly, the results align with some of the signiﬁcant
features found in Wang et al. (2018) such as the area, perimeter, major axis
length, minor axis length, and the number of holes.

The multivariate analysis used regularization to avoid overﬁtting and
selected nine features: perimeter, average roughness index, elongation, eccen-
tricity, roundness, major axis angle, minor axis length, number of holes, and
zero-crossing count (ordered from largest to smallest importance; Figure 7).

28

FERN ´ANDEZ MORALES ET AL.

Out of the nine features three were signiﬁcant in the univariate analysis:
perimeter, minor axis length, and the number of holes. Interestingly, the
major axis angle, a negative control, was kept in the regularized model.
Furthermore, the radial-based features, average roughness index, and zero-
crossing count, insigniﬁcant in the univariate analysis, were also kept by the
model. This indicates that further research regarding the derived shape repre-
sentations and their features should be conducted. The resulting regularized
model was used to compute patient risk scores to, subsequently, dichotomize
patients into high-risk and low-risk groups. Through an independent cohort,
the predicted risk score proved to be a signiﬁcant prognostic factor, alongside
other clinical variables (Table 6).

Tumor regions obtained from whole-slide images tend to have a complex
shape and boundary. These complexities can, potentially, introduce noise
into the shape representations. As a result, this noise disrupts the computed
features. This issue could be resolved by introducing noise-resistant shape
representations and features. We also cannot disregard the 3-dimensional
spatial information that is lost due to two-dimensional imaging procedures.
Therefore, we can apply feature extraction to other imaging techniques,
such as computed tomography (CT) colonography, magnetic resonance imag-
ing (MRI), and positron emission tomography (PET)/CT colonography, to
produce more comprehensive and diverse shape-based features that further
quantify the tumor shape, geometry, and topology as well as improving the
performance of current risk-based prognostic models (Wang et al., 2018).

In this study, we developed a whole-slide image processing procedure and
shape-based prognostic model to evaluate the relationship between tumor
shape, geometry, and topology and patient survival outcome. Our image
processing procedure, eﬃciently, extracted tumor regions, and computed
shape-based features from pathology images. This procedure can be adapted
to include more shape representations and features; it can also be adapted to
other cancer types such as the brain, breast, and kidney cancer. The univariate
and multivariate provided new insights into the relationship between tumor
shape and patient prognosis. Additionally, our results supported the ﬁndings
in Wang et al. (2018). Our shape-based prognostic model, adapted from
Wang et al. (2018), predicted patient risk scores. These risk scores served
as a prognostic factor, independent of other clinical variables. In all, the
proposed processing and model development pipeline provided an objective
prognostic method as well as contributing to the shape analysis of tumors.

SHAPE ANALYSIS OF TUMOR PATHOLOGY IMAGES

29

APPENDIX A: ADDITIONAL FORMULAS

A.1. Centroid. The centroid of a shape Pc = (xc, yc), also known as

the center of gravity, is given by

xc =

yc =

1
6A

1
6A

n
(cid:88)

(xi + xi+1)(xiyi+1 − xi+1yi)

i=1
n
(cid:88)

(yi + yi+1)(xiyi+1 − xi+1yi)

i=1

A =

1
2

n
(cid:88)

(xiyi+1 − xi+1yi)

i=1

where

is the signed area of the shape, obtained using Gauss’s area formula. For a
region, represented in a two-dimensional discrete plane, the centroid ¯c = (¯l, ¯w)
is given by

¯l =

1
N

(cid:88)

l

IR(l, w) · l

and

¯w =

1
N

(cid:88)

w

IR(l, w) · w

where N = (cid:80)

l,w IR(l, w) is the number of points that make up the region.5

5We can see that the coordinates of the centroid are the means of the xy-coordinates

that make up the region.

30

FERN ´ANDEZ MORALES ET AL.

REFERENCES

Castleman, K. R. (1996). Digital Image Processing. Prentice Hall.
Emmanuel O. Agu, P. (2014). Digital Image Processing (CS/ECE 545) Lecture 8: Regions

in Binary Images (Part 2) and Color (Part 1).

Freeman, H. and Shapira, R. (1975). Determining the Minimum-Area Encasing Rectangle

for an Arbitrary Closed Curve. Communications of the ACM 18 409–413.

Giger, M. L., Vyborny, C. J. and Schmidt, R. A. (1994). Computerized characterization

of mammographic masses: analysis of spiculation. Cancer Letters 77 201–211.

Gonzalez, R. C., Woods, R. E. and Eddins, S. L. (2020). Digital Image Processing

Using MATLAB. Gatesmark Publishing, Knoxville, Tennessee.

Haralick, R. M. (1974). A measure for circularity of digital ﬁgures. IEEE Transactions

on Systems, Man, and Cybernetics 4 394–396.

Kilday, J., Palmieri, F. and Fox, M. D. (1993). Classifying Mammographic Lesions Using
Computerized Image Analysis. IEEE Transactions on Medical Imaging 12 664–669.
Lee, D. T. (1983). On ﬁnding the convex hull of a simple polygon. International Journal

of Computer & Information Sciences 12 87–98.

Luo, X., Zang, X., Yang, L., Huang, J., Liang, F., Rodriguez-Canales, J., Wis-
tuba, I. I., Gazdar, A., Xie, Y. and Xiao, G. (2017). Comprehensive Computational
Pathological Image Analysis Predicts Lung Cancer Prognosis. Journal of Thoracic
Oncology 12 501–509.

Matsuda, T. and Machii, R. (2015). Morphological distribution of lung cancer from
Cancer Incidence in Five Continents Vol. X. Japanese journal of clinical oncology 45
404–404.

Mingqiang, Y., Kidiyo, K. and Joseph, R. (2008). A Survey of Shape Feature Extraction
Techniques. In Pattern Recognition Techniques, Technology and Applications 43–90.
Pohlman, S., Powell, K. A., Obuchowski, N. A., Chilcote, W. A. and Grundfest-
Broniatowski, S. (1996). Quantitative classiﬁcation of breast tumors in digitized
mammograms. Medical Physics 23 1337–1345.

Siegel, R. L., Miller, K. D. and Jemal, A. (2020). Cancer statistics, 2020. CA: A

Cancer Journal for Clinicians 70 7–30.

Simon, N., Friedman, J., Hastie, T. and Tibshirani, R. (2011). Regularization Paths
for Cox’s Proportional Hazards Model via Coordinate Descent. Journal of Statistical
Software 39 1–13.

Sonka, M., Hlavac, V. and Boyle, R. (2014). Image Processing, Analysis, and Machine

Vision, 4th ed. Cengage Learning.

R Core Team (2020). R: A Language and Environment for Statistical Computing R

Foundation for Statistical Computing, Vienna, Austria.

Therneau, T. M. (2020). A Package for Survival Analysis in R.
Toussaint, G. T. (1983). Solving geometric problems with the rotating calipers. In Proc.

IEEE Melecon 83 A10.

Wang, H., Xing, F., Su, H., Stromberg, A. and Yang, L. (2014). Novel image markers
for non-small cell lung cancer classiﬁcation and survival prediction. BMC Bioinformatics
15 310.

Wang, S., Chen, A., Yang, L., Cai, L., Xie, Y., Fujimoto, J., Gazdar, A. and
Xiao, G. (2018). Comprehensive analysis of lung cancer pathology images to discover
tumor shape and boundary features that predict survival outcome. Scientiﬁc Reports 8.
Wirth, M. A. (2004). Shape Analysis & Measurement Technical Report, University of

Guelph.

Yu, K. H., Zhang, C., Berry, G. J., Altman, R. B., R´e, C., Rubin, D. L. and

SHAPE ANALYSIS OF TUMOR PATHOLOGY IMAGES

31

Snyder, M. (2016). Predicting non-small cell lung cancer prognosis by fully automated
microscopic pathology image features. Nature Communications 7 1–10.

Zhang, D. and Lu, G. (2004). Review of shape representation and description techniques.

Pattern Recognition 37 1–19.

Esteban Fern´andez Morales, Cong Zhang, and Qiwei Li
800 W Campbell Rd
Mathematical Sciences, FO 35
The University of Texas at Dallas
Richardson, TX 75080, United States
E-mail:
E-mail:
E-mail:

Guanghua Xiao
5323 Harry Hines Blvd
Quantitative Biology Research Center, Suite H9.124
The University of Texas Southwestern Medical Center
Dallas, TX 75390, United States
E-mail:

Chul Moon
3225 Daniel Ave
104 Heroy Science Hall
Southern Methodist University
Dallas, TX 75275, United States
E-mail:

