1

Reconﬁgurable Intelligent Surface Enabled
Vehicular Communication: Joint User Scheduling
and Passive Beamforming
Ahmed Al-Hilo∗, Moataz Samir∗, Mohamed Elhattab∗, Chadi Assi∗, and Sanaa Sharafeddine†
∗Concordia University, †Lebanese American University

1
2
0
2

n
a
J

8
2

]
P
S
.
s
s
e
e
[

1
v
7
4
2
2
1
.
1
0
1
2
:
v
i
X
r
a

Abstract—Given its ability to control and manipulate wire-
less environments, reconﬁgurable intelligent surface (RIS), also
known as intelligent reﬂecting surface (IRS), has emerged as
a key enabler technology for the six-generation (6G) cellular
networks. In the meantime, vehicular environment radio prop-
agation is negatively inﬂuenced by a large set of objects that
cause transmission distortion such as high buildings. Therefore,
this work is devoted to explore the area of RIS technology
integration with vehicular communications while considering the
dynamic nature of such communication environment. Speciﬁcally,
we provide a system model where RoadSide Unit (RSU) leverages
RIS to provide indirect wireless transmissions to disconnected
areas, known as dark zones. Dark zones are spots within RSU
coverage where the communication links are blocked due to the
existence of blockages. In details, a discrete RIS is utilized to
provide communication links between the RSU and the vehicles
passing through out-of-service zones. Therefore, the joint problem
of RSU resource scheduling and RIS passive beamforming or
phase-shift matrix is formulated as an optimization problem with
the objective of maximizing the minimum average bit rate. The
formulated problem is mixed integer non-convex program which
is difﬁcult to be solved and does not account for the uncertain
dynamic environment in vehicular networks. Thereby, we resort
to alternative methods based on Deep Reinforcement Learning
to determine RSU wireless scheduling and Block Coordinate
Descent (BCD) to solve for the phase-shift matrix, i.e., passive
beamforming, of the RIS. The Markov Decision Process (MDP)
the solution approach is
is deﬁned and the complexity of
discussed. Our numerical results demonstrate the superiority of
our proposed approach over baseline techniques.

Keywords— Vehicular communication, reconﬁgurable intel-

ligent surface, Deep Reinforcement Learning, scheduling.

I. INTRODUCTION

Vehicular communications are deemed as integral compo-
nent for the Intelligent Transportation Systems (ITS) that allow
automobiles to stay connected with their surroundings as well
as remote entities. They aim to provide anytime-anywhere
connectivity to enable a wide range of critical and convenient
services for vehicles. Indeed, the emergence of sophisticated
vehicular communication technologies, i.e., cellular vehicle-to-
everything (C-V2X) or Internet of Connected Vehicle (IoCV)
[1], [2], are forecast to effectively contribute in paving the
way to support a plethora of essential applications including
safety and non-safety related such as HD Maps, autonomous
driving, 4K Video streaming, virtual and augmented reality,
to name a few. Such applications urge for strict requirements
such as higher throughput, lower latency, and massive connec-
tivity. However, in the context of vehicular environment, it is

strenuous to offer seamless communication experiences with
ubiquitous connectivity and to enhance the quality of service.
Technically speaking, in many areas where large objects,
i.e., high-rise buildings or trucks, appear, it is very probable
that wireless links between terrestrial infrastructures and vehi-
cles face frequent disturbances. Hence, the service quality falls
below the desirable levels and sometimes for extended periods
of time. Moreover, certain regions, where obstacles severely
block Line of Sight (LoS), are permanently out of coverage
which, here, are dubbed as dark zones. Expanding wireless
coverage to unserved areas translates to dramatic raise in
costs. Meanwhile, recently, reconﬁgurable intelligent surfaces
(RIS) have been recognized as a key promising technology
for achieving cost- and energy-efﬁcient communications via
smartly reshaping the wireless propagation environment [3].
RIS is composed of a number of passive low-cost elements,
each of which has the ability to independently tune the phase-
shift of the incident radio waves. By adequately conﬁguring
the phase-shifts with the assistance of the RIS controller,
the reﬂected signals can be constructively added [4]. Thus,
the received signal strength can be improved at the point of
interest.

Consequently, by leveraging RIS, an indirect LoS wireless
communication link can be provided for vehicles travelling in
a dark zone; i.e. a road where large buildings block the LoS of
the Road Side Unit (RSU) [5]. It is assumed that those vehicles
are requesting service and the RSU is interested in maximizing
the quality-of-service (QoS) for the passing by vehicles. To
this end,
the RSU operator may need to jointly optimize
the RSU resource scheduling and RIS element coefﬁcients
(passive beamforming) such that the minimum average bit
rates of vehicles is maximized. In addition, despite that a
few works have addressed RIS phase-shift conﬁguration in
vehicular networks, only non-practical phase-shift RIS case is
considered where RIS elements can have continuous element
tuning. However, due to limited hardware, phase-shift elements
of RIS can only have limited number of values [6], [7].

Leveraging RIS in highly dynamic environments similar to
vehicular communications implies a multitude of challenges.
First, vehicles constantly change their position, hence, the
distance between the RIS and vehicles is varying over time
and that would highly affect the channel quality between them.
Second, the RSU has limited resources in terms of the number
of available wireless channels. Thereby, the RSU needs to op-
timize the radio scheduling while considering the mobility of

 
 
 
 
 
 
vehicles which makes the problem more challenging especially
when accounting for multi-user scenarios [8]. Third, vehicles
move at different and varying speeds, that is, vehicles have
various residence times. Considering the same service amounts
for all the vehicles passing by the dark zones will deteriorate
the performance of low speed vehicles. Subsequently, maxi-
mizing the minimum average bit rates provided to navigating
vehicles regardless of their sojourn times should be considered.
Fourth, the arrival times and speed of upcoming vehicles are
not available, in practice, upfront to the RSU operator which
makes the problem further more intricate. Finally and most
importantly, discrete RIS phase-shift matrix conﬁguration is
a well-known problem which is generally hard to be solved
especially in a context where the phase-shift matrix of the RIS
together with wireless scheduling are jointly optimized.

To the best of our knowledge, this work is the ﬁrst to
consider practical/discrete RIS in vehicular networks where
the mobility of vehicles together with the environment un-
certainties are addressed. To this end, to tackle the aforemen-
tioned challenges, an intelligent solution approach is proposed,
namely Deep Reinforcement Learning, along with effective
optimization technique based on block coordinate descent
(BCD). The contributions of this work can be summarized
as follows:

• A system model

leverages discrete
is presented that
phase-shift RIS technology to extend and enhance RSU
communication. Precisely, a RSU provides service for
vehicles passing through a blocked zone indirectly by
employing a RIS where the mobility of vehicles and
future arrivals are considered.

• We investigate the joint vehicle scheduling and passive
beamforming in RIS-empowered vehicular communica-
tion. This framework is formulated as an optimization
problem with the goal of maximizing the minimum
achievable bit rate for the vehicles passing through the
dark zone. However, the formulated problem ends up to
mixed integer non-convex problem, which is known to
be difﬁcult to solve.

• In order to tackle this challenge, we decouple the formu-
lated problem into two sub-problems; wireless scheduling
sub-problem and phase-shift matrix optimization sub-
problem. Then, we resort to solve the ﬁrst sub-problem
via Deep Reinforcement Learning (DRL). To do so,
the Markov Decision Process (MDP) is deﬁned to be
solved via DRL algorithm. Further, we propose BCD to
solve the second sub-problem. We also demonstrate the
robustness of our BCD algorithm. And, the computational
complexity of the proposed algorithms are analyzed.
• Two case studies are carried out. The ﬁrst one is to
investigate how recent vehicular technologies can enable
RIS integration with vehicular communications through
obtaining precise vehicle positioning. Also, another study
explores the area of RIS placement to optimize the overall
network performance.

• Several extensive simulation based experiments are con-
ducted using Simulation of Urban MObility (SUMO) to
validate the effectiveness of our solution method and to

2

compare with counterpart methods.

The remaining of this paper is organized as follows. Section
II presents the major contributions that have been done in
similar contexts. In Section III, we discusses our system
model. Section IV formulates the problem mathematically
along with the objective function. Next, Section V explains our
solution approach in details. In section VI, two case studies are
discussed regarding RIS placement and vehicle positioning.
Then, section VII shows our numerical results. Finally, we
sum up the paper in Section VIII.

Notations: Vectors are denoted by bold-face italic letters.
diag(x) denotes a diagonal matrix whose diagonal element is
the corresponding element in x. CM ×N denotes a complex
matrix of M × N . For any matrix M , M H and M T denote
its conjugate transpose and transpose, respectively. P r(A | B)
denotes the probability of event A given event B.

II. RELATED WORK

Lately, high research efforts have been devoted towards
investigating the introduction of the RIS to vehicular networks.
In [9], the authors studied resource allocation of RIS-aided
vehicular communications where they aim to maximize vehicle
to base station link quality while guaranteeing vehicle to
vehicle communications. The authors of [10] provided analysis
for outage probability in RIS-enabled vehicular networks. This
paper derives an expression of outage probability showing
that RIS can reduce the outage probability for vehicles in its
vicinity. The analysis also proves that higher density roads
increase outage probability since passing vehicles can block
the communication links. In [11], the authors proposed RIS-
aided vehicular networks while considering two scenarios to
estimate the channels. The ﬁrst one is by assuming ﬁxed
channel estimation within a coherence time. While the second
one neglects the small scale fading based on the fact that
vehicular positions can be realised in advance. [12] consid-
ered constraint discrete phase-shift RIS with two challenges;
channel estimation and passive beamforming.

Another body of works on RIS deals with practical consider-
ations of discrete RIS elements. In [7], the authors introduced a
ﬁnite number of phase-shift elements of RIS where the power
is minimized while maintaining certain signal-to-interference-
plus-noise ratio threshold. [13] proved how discrete phase-
shift RIS is able to achieve high performance with minimum
required number of phase quantization levels. This work shows
that 3 levels are enough to attain the full diversity order. In
addition, the authors of [14] also worked on practical RIS
where multiple users are served in parallel. The objective of
this work is to maximize the sum rate where the continuous
digital beamforming and discrete RIS beamforming are done.
[15] proposed RIS to assist multiple-input multiple-output
(MIMO) systems with 2-bit phase-shift elements. In [16],
the authors proposed utilizing RIS in cognitive radio systems
yielding improved spectral efﬁciency and energy efﬁciency.
[17] maximized the achievable sum rate of multi-users while
the RIS sends information via controlling the reﬂecting mod-
ulation. [18] proposed a new location-based RIS where users’
locations are not perfectly known. Hence, the angle between

3

the users and RIS are estimated to conﬁgure the beams of
the RIS and trasmitter. In addition, some other works also
leverage RIS for security purposes, for example [19] suggested
that RIS can help in alleviating security breaches related to
eavesdropping. In [20], the authors studied the security issues
related to eavesdropping attacks under different circumstances
including active and passive relays (RIS).
As opposed to the previous papers,

this work accounts
for vehicles mobility where vehicles constantly change their
position with time. Additionally, as time progresses, new
vehicles arrive to the concerned area while others depart. This
process of birth-and-death vehicles brings many uncertainties
to the context which are hard to cope with. Thus, we aim to
ﬁnd a solution approach that can handle the dynamic nature
of this context besides anticipating the upcoming arrivals and
other hidden information about the environment. Accounting
for these two objectives will help the RSU-RIS to better decide
when and how to serve vehicles during their residence time.
Moreover, unlike many existing works in the literature, we
propose to use practical/discrete RIS.

Fig. 1: System Model

b bits. Hence, each one can be tuned to one of 2b different
angles.

III. SYSTEM MODEL

A. Communication Model

We consider a particular road segment with no direct
connectivity via a RSU as depicted in Fig. 1. The line of
sight (LoS) is assumed to be blocked by an obstacle, i.e., a
high building [21]. We also consider a predeﬁned time horizon
of length N which encompasses several smaller time slots,
[0, 1, .., n, ..., N ]. Meanwhile, we assume a ﬂow of vehicles
indexed by v is navigating and requesting communication
services from the RSU located at (xR, yR, zR) where xR, yr
are the Cartesian coordinates and zR is height of the infras-
tructure. The vehicles are moving at different and varying
speeds, therefore, at each time slot n ∈ N , vehicle v location
is denoted by (xn
v , zv). In order to provide uninterrupted
service, the network operator leverages an RIS equipped with
M elements, which is situated on a building and possesses
a strong LoS with both the moving vehicles passing by the
dark zone and the RSU. Here, we denote the RIS location by
(xI , yI , zI ). The RSU operator aims to satisfy the vehicles by
providing favourable quality of service.

v , yn

The RSU is assumed to have a number of channels C to be
scheduled for the vehicles [22]1. In case when there are several
vehicles present, the RSU has to determine how to schedule
its resources and tune the RIS elements. Further, due to the
mobility nature of the vehicular environment the distances
between the RIS and vehicles change as time progresses.
Meaning, the network operator has to take into consideration
that link quality degrades as vehicles moving far from the RIS.
Unlike prior work which deals with continuous phase-shift
RIS, we assume a realistic scenario of a RIS where phase-shift
coefﬁcients are discrete. This scenario is more practical since
it accounts for the real-world hardware limitations. However,
discrete RIS is more challenging due to the additional con-
straint of discrete phase-shift. Moreover, the RIS consists of
M elements, [1, ..., m, ..., M ], each of which is controlled via

In the proposed model, we consider a uniform linear array
(ULA) RIS [21]. In addition, similar to the RSU, the RIS is
assumed to have a certain height, zI . The communication links
between RSU and RIS and that between RIS and vehicle v are
assumed to have a dominant line-of-sight (LoS). Thus, these
communication links experience small-scale fading which are
modeled as Rician fading with pure LoS components [23],
[24]. Consequently, the channel gain between the RSU and
RIS, hI,R ∈ CM ×1, can be formulated as follows.

hI,R =

(cid:113)

(cid:124)

ρ(dI,R)−α
(cid:123)(cid:122)
(cid:125)
path loss

(cid:114) K

¯h

,

LoS
I,R
(cid:125)

1 + K
(cid:123)(cid:122)
Rician fading

(cid:124)

(1)

where ρ is the average path loss power gain at reference
LoS
distance d0 = 1m. Also, K is the Rician factor and ¯h
I,R
is the deterministic LoS component which can be deﬁned as
follows

¯hLoS

I,R =

(cid:34)
1, e−j 2π

λ dφI,R , ..., e−j 2π

λ (M −1)dφI,R

(cid:124)

(cid:123)(cid:122)
array response

, ∀n ∈ N,

(2)

(cid:35)T

(cid:125)

is

the

dI,R

distance

and RSU and

Euclidean
can

where
the RIS
(cid:112)(xI − xR)2 + (yI − yR)2 + (zI − zR)2. φI,R =
is cosine of the angle of arrival of signal from RSU to RIS.
d is the separation between RIS elements and λ is the carrier
wavelength.

between
from
xI − xR
dI,R

computed

be

Similarly, we can compute the channel gain between the
I,v ∈ CM ×1 as in Eq

RIS and vehicles which is denoted by hn
(3).

(cid:113)

hn

I,v =

(cid:114) K

ρ(dn
I,v)−α
(cid:123)(cid:122)
(cid:125)
path loss

(cid:124)

¯hn LoS
I,v

1 + K
(cid:123)(cid:122)
Rician fading

(cid:125)

, ∀v, n ∈ N,

(3)

1For simplicity, we assume each vehicle can only be served via one channel.

(cid:124)

(cid:35)T

,

(cid:125)

(4)

TABLE I: Mathematical notation

Parameters

4

¯hn LoS

I,v =

(cid:34)
1, e−j 2π

λ dφn

I,v , ..., e−j 2π

λ (M −1)dφn

I,v

(cid:124)

(cid:123)(cid:122)
array response

∀v, n ∈ N,

where dn

I,v is the euclidean distance between the RIS and
I,v =
. Finally, we

vehicle v at time slot n and φn

xI − xn
v
dn
I,v

assume the channel is completely blocked between the RSU
and vehicles in that zone similar to [21]2.

1 , ..., ejθn

M }, where θn

Denote the phase-shift matrix of the RIS in the nth time
slot as θn = diag{ejθn
m is the phase-
shift of the mth reﬂecting element m = 1, 2, , M . Due to
the hardware limitations, the phase-shift can only be selected
from a ﬁnite set of discrete values. Speciﬁcally, the set of
discrete values for each reﬂecting RIS element can be given
}, where Q = 2b and b is
as θn
Q
the number of bits that control the number of available phase-
shifts for the RIS elements. Hence, the signal to noise ratio
(SNR) is:

Q , . . . , 2π(Q−1)

m ∈ Ω = {0, 2π

λn
v =

P |hH

I,v|2

I,Rθnhn
σ2

, ∀v, n ∈ N,

(5)

where P is the transmission power of the RSU and σ2 is the
thermal noise power.

Then, we can compute hH

I,Rθnhn

I,v based on Eq (2) and Eq

(3).

I,Rθnhn
hH

I,v =

K
ρ
K + 1
I,i)α(cid:112)(dI,R)α

(cid:113)

(dn

×

(6)

M
(cid:88)

m=1

ej(θn

m+ 2π

λ (m−1)dφn

I,v− 2π

λ (m−1)dφI,R), ∀v, n ∈ N.

Now, instantaneous bit rate given to each vehicle is calcu-

lated as.

v = jn
ln

v log2(1 + λn

v ), ∀v, n,

(7)

v ∈ [0, 1]

where jn
is a decision variable to schedule the
resources of RSU to vehicle v at time slot n. Hence, jn
v = 1
means vehicle v is served at time slot n and 0 otherwise.
Now, the average bit rate each vehicle receives throughout its
sojourn time can be computed by the following.

zv =

1
Hv

N
(cid:88)

n=1

ln
v , ∀v,

(8)

where Hv is the residence time of vehicle v in the dark zone.
Next, we formally deﬁne our problem as:

Deﬁnition 1 Assume a ﬂow of vehicles travelling through a
dark zone. The vehicles are demanding connection to a remote
RSU. Meanwhile, a RIS is deployed at speciﬁc point, i.e., on a
building, where it possesses a strong LoS with the RSU and the
dark zone. The RIS has a certain number of elements where
the operator can tune their coefﬁcients to provide service for
vehicles in order to enhance channel gains and improve bit
rates. During a certain time horizon (encompassing multiple

2In this work, we assume that the channel gain between RIS and vehicles

is ﬁxed within one time slot.

xI , yI , zI
RIS location
xR, yR, zR RSU location
v , yn
v , zn
xn
v
N

Vehicle v location at time slot n
Time horizon consists of smaller time
slots.
Set of available vehicles during time slot
n
Number of RSU channels
Vehicle v residence time
Angle of arrival at RIS from RSU
Angle of arrival between the RIS and
vehicle v at time slot n
Path loss exponent
Transmission power of the RSU
Median of the mean path gain at reference
distance = 1m
Thermal noise power
Number of control bits for the RIS ele-
ments
Number of RIS phase-shift patterns

Variables

1: if vehicle v is scheduled for service by
the RSU at n and 0 otherwise
RIS element m phase-shift angle at time
slot n

V n

C
Hv
φI,R
φn
I,v

α
P
ρ

σ
b

Q

jn
v

θn
m

time slots), what is the best RSU wireless scheduling and
phase-shift conﬁguration for the RIS elements such that the
minimum average bit rate provided to vehicles is maximized.

IV. MATHEMATICAL FORMULATION

In this section we formulate the problem of RSU wireless
scheduling and RIS element tuning mathematically. Let Av
and Dv denote the arrival time and departure time of vehicle
v, respectively. The notations used in this corresponding are
listed in Table I.

The optimization problem alongside the objective function
can be mathematically written as follows. For the sake of
clarity, let Θ = {θ1, θ2, . . . , θN } and J = {jn
v , ∀v, n ∈ N }.

max
Θ, J

s.t.

{min zv}

V n
(cid:88)

jn
v ≤ C, ∀n ∈ N,

v=1
jn
v ∈ [0, 1], ∀n ∈ N, v,
jn
v ≤ max(n − Av, 0), ∀n ∈ N, v,
jn
v ≤ max(Dv − n, 0), ∀n ∈ N, v,
θn
m ∈ Ω, ∀n ∈ N, m ∈ M.

(9a)

(9b)

(9c)

(9d)

(9e)

(9f)

Here, the objective function, Eq (9a), is max-min which
translates to maximizing the minimum average bit rate. Con-
straint (9b) ensures that the number of channels scheduled to

vehicles is no more than that available at the RSU. Constraint
(9c) allows vehicles to be served via one channel only.
Constraints (9d) and (9e) make sure that vehicle can only be
served via RIS while it is within the area of the dark zone.
Finally, constraint (9f) restrains the number of phase-shift
values. Now, the problem is non-convex due to the discrete RIS
element phase-shift optimization. Also, the phase-shift matrix
is hard to be solved. For instance, if the phase-shift is tuned to
optimally serve the ﬁrst vehicle, the other ones might receive
less quality and vise versa. Furthermore, in this problem, it is
hard to eliminate the coupling relationship between phase-shift
conﬁguration and wireless scheduling. In addition, the infor-
mation of vehicles such as their arrival, speed, and departure,
are unknown in advance. Due to the dynamic nature of the
environment, it is impractical to assume such information is
given. Hence, a effective solution mechanism has not only to
deal with the difﬁculties of such problem, but it has also to
predict for the hidden parameters.

In order to address the above challenges, we resort to Deep
Reinforcement Learning (DRL) with multi-binary action space
to ﬁnd a policy that maximizes the minimum average bit rate
for vehicles. However, if DRL is used to solve for the two
decisions of resource scheduling and phase-shift matrix, the
action space will be equal to all the possible combinations of
wireless scheduling and phase-shift patterns for M elements
which is unbearably large. Such massive action space would
increase the DRL agent difﬁculty to learn. Similar to [25],
[26], a more practical solution approach can be realised by
delegating one decision to an optimization technique while
dedicating the second one to machine learning based approach.
In particular, the DRL agent ﬁrst determines which vehicles
are going to be served at time slot n. While, BCD algorithm
is invoked to conﬁgure the phase-shift matrix such that the
service offered to the scheduled vehicles is optimized. Next,
the solution approach, in details, will be discussed.

V. SOLUTION APPROACH

The solution approach for joint resource scheduling and
passive beamforming is presented in this section. First, we de-
compose the aforementioned problem into two sub-problems,
the ﬁrst sub-problem is due to the resource scheduling and
second one corresponds to the phase-shift matrix of the RIS.
The information and mobility of the upcoming vehicles are
unknown in advance. That is, solving the ﬁrst sub-problem
is quite challenging. Hence, we resort to DRL to observe the
environment and tackle multi-user RSU scheduling. Next, the
RIS elements are tuned based on Block Coordinate Descent
(BCD) [27]–[29]. The details of our solution methodology are
laid out in the next sections.

A. DRL for Wireless Scheduling

For the DRL, we need to deﬁne a Markov Decision Process
tuple (cid:104)S, A, γ, R, G(cid:105) that represents the environment. First, let
us deﬁne four new notations; f n, ∀n ∈ N which denotes the
current minimum average bit rate until time slot n, kn
v , ∀n ∈
N, v denotes the speed of vehicle v at time slot n, zn
v ∀n ∈ N, v
is the current average bit rate of vehicle v until time slot n, η

5

is the largest number of vehicles existing simultaneously, and
U is the number of possible actions. Now, the MDP is deﬁned
as follows:

• S is the state space where its size is large as it contains
unbounded parameters of real numbers. The system state
sn ∈ S is a vector that indicates current minimum service
provided up to n − 1, the speeds of the existing vehicles
(kn
v , ∀v) in that time slots, their cumulative average bit
rates up to n (zn
v , ∀v). The
state s can be expressed as:

v , ∀v), and their locations (xn

{f n, kn

1 , xn
1 , zn
1
(cid:123)(cid:122)
(cid:125)
v=1

, kn
(cid:124)

, ..., kn
2 , xn
2 , zn
2
(cid:125)
(cid:123)(cid:122)
(cid:124)
v=2

η , xn
η , zn
}, ∀n.
η
(cid:125)
(cid:123)(cid:122)
v=η

(10)

(cid:124)

• A is the action space where the action taken for each
time slot n is an ∈ A. an is a binary vector of size
η. Also, the sum of vector an should be equal to C (to
enforce constraint (9b)). For example, if an[0] = 1, then
the ﬁrst existing vehicle is being served at time slot n
and so forth. The number of actions can be computed
by U = η!/(C!(η − C)!). The possible combinations of
action vectors is similar to the example below.

{ 0
(cid:124)(cid:123)(cid:122)(cid:125)
1

, 0, 1, ..., 1
(cid:124)(cid:123)(cid:122)(cid:125)
η

(cid:124)

(cid:123)(cid:122)
1

, ..., {1, 1, 0, ..., 0}
, {0, 1, 1, ..., 1}
}
(cid:125)
(cid:125)
(cid:123)(cid:122)
(cid:124)
2

(cid:123)(cid:122)
U

(cid:124)

(cid:125)

(11)
• R is the discounted cumulative reward produced after
executing every step n ∈ N and it is deﬁned as follows:

R =

N
(cid:88)

n=1

γn−1rn,

(12)

Here, the step reward rn is computed as follows. During
the beginning of the operational phase, rn = 0 until the
ﬁrst vehicle departs. For the ﬁrst vehicle, the step reward
is equal to its average bit rate. Henceforth, whenever any
vehicle leaves the dark zone, the step reward is given
as a penalty if and only if that vehicle has received
less average bit rate than the other vehicles which left
previously. It is worth noting that since the agent seeks
to maximize the minimum average bit rate, it does not
count reward if a vehicle received higher bit rate than
others.

• G denotes state transition probabilities which is the
probability of being in state s(cid:48) after applying action an
in state sn. The probability of transition from one state to
another depends only on the current state as in Eq (13).

P r(sn+1 = s(cid:48) | sn, an) = P r(f n+1 | f n, an)

v

× P r(kn+1
× P r(xn+1
× P r(zn+1

v

v

| kn
v )
| xn
v , kn
v )
v , an).
| zn

(13)

That is, the probability of having minimum average bit
rate of f n+1 depends on the current value f n and the
time slot an. The probability of
action taken at
vehicle having certain speed, kn+1
, depends on its current
speed. Moreover, the probability of vehicle v being in
depends on its current location (xn
next location, xn+1
v )

that

v

v

v

and its speed (kn
having certain average bit rate (zn+1
the current one (zn

v ). Finally, the probability of vehicle
) depends only on
v ) and the action taken at that time slot.
Remark selecting an action is a non-trivial task for the
problem explained above. Actually, since our objective is to
maximize the minimum average bit rate for all vehicles, it
is not easy to decide which vehicles to serve at each time
slot. For instance, a vehicle has just entered may have plenty
of time to be served later while a vehicle near the end of
the road segment may have no much time to receive service.
In contrary, a vehicle located at the end is way far than
those vehicles near the RIS. Hence, the latter can receive
much higher bit rate if selected to be served. Moreover, if
the RSU postpones the service for one vehicle, other vehicles
may arrive, therefore, that vehicle will have less chances to
be served later. In addition, in our work, we consider multi-
user communication where more than one vehicle might be
scheduled by the RSU simultaneously which makes the action
space more complicated. Hence, the agent needs to interact
with the environment and try different actions and scheduling
policies in order to ﬁgure out which one attains the best
cumulative reward.

For DRL, we exploit PPO to develop our agent as laid out
in Algorithm 1. First, the agent initializes random sampling
policy and value function for the neural networks as in lines 3
and 4. Then, in each epoch, the agent observes the environment
which consists of the set of vehicles and their information,
minimum average bit rate achieved up to n. Then at each time
slot n, the agent selects an action which is a binary vector
that determine which set of vehicles will be served via the
RSU. Based on that action, the BCD algorithm is then invoked
to conﬁgure the phase-shift matrix in order to maximize the
channel gain. Eventually, the time step reward is worked out
which has three cases. First, if no vehicle has departed yet,
rn = 0. Second, if the very ﬁrst vehicle departs, the reward
is set to its average bit rate. Third, the consecutive vehicles
leaving the area will be accounted as a penalty if and only if
their average bit rate is less than f n when they have departed.
After gathering the set of samples and computing the
rewards, the agent works out the advantage function (line 19),
ˆA, which is deﬁned as the resultant of subtracting the expected
value function from the actual reward. ˆA is the estimated
advantage function or relative value of the selected action.
It helps the system to understand how good it is preforming
based on its normal estimate function value [30].

Our agent is based on proximal policy optimization which
usually is implemented in Actor-Critic framework, where more
objective functions are added to the surrogate objective. Based
on [31], the complexity of connected network with P layers
is O((cid:80)P
p=0 npnp−1) where np denotes the total number of
neurons in layer p.

B. BCD for RIS Phase-Shift Coefﬁcients

Block coordinate descent (BCD) has been proposed in the
literature to solve for RIS phase-shift matrix [28], [29]. In this
correspondence, we aim to leverage BCD to maximize the sum

6

v , zn

v , ∀v ∈ V n.

Algorithm 1 Proposed DRL for Scheduling
1: Inputs: N , v, Learning Rate, γ, (cid:15).
2: Outputs: RSU resource scheduling and θn.
3: Initial policy π with random parameter θ and threshold (cid:15)
4: Initial value function V with random parameters φ
5: for each episode k ∈ {0, 1, 2, ...} do
for n : {0, 1, 2, ..., N } do
6:
v , xn
Observe state f n, kn
7:
Select action an from πθold
8:
Assign channel to vehicle v if it is scheduled to be served.
9:
Conﬁgure RIS phase-shift matrix using Algorithm 2.
10:
if Vehicle v is the ﬁrst one to leave then
11:
12:
13:
14:
15:
16:
17:
18:
19:
20:
21:
22: end for

end for
Compute advantage estimate ˆA for all epochs.
Optimize surrogate loss function using Adam optimizer.
Update policy πθold ← πθ.

else if Vehicle v departed and zv < f n then

Set rn = f n − zv

Set rn = zv

rn = 0

end if

else

of immediate sum of bit rates of all vehicles selected to be
served at time slot n.

V n
(cid:88)

v=1

v ln
jn

v , ∀n.

(14)

To do so, Algorithm 2 receives the action selected by
DRL in Algorithm 1, J n. Once the decision is taken by
the agent, the BCD is then called to optimize the phase-
shift matrix in iterative way. In each iteration, a sequence of
block optimization procedures are performed. In each one, all
elements are ﬁxed while one is optimized by checking all its
possible values, 2b. The one that maximizes the objective will
be selected. After that, the next element will be selected to
optimize and so forth. This operation is iterated until Eq (14)
has converged. In practice, Algorithm 1 needs one iteration to
surpass 95% threshold of its maximum performance. Hence,
this algorithm is pretty robust in dealing with the phase-shift
coefﬁcients.

Algorithm 2 BCD to Tune the RIS Phase-Shift Matrix
1: Inputs: J n.
2: Outputs: θn
3: while Eq (14) not converged do
for m = 1, ..., M do
4:
5:
6:

Fix m(cid:48), ∀m(cid:48) (cid:54)= m, m(cid:48) ∈ M
Set θn
Eq(14)

m = arg max

Ω

end for
Obtain Eq (14)

7:
8:
9: end while

Concerning the complexity of Algorithm 2, it is O(IM 2b)
where I stands for the number of iterations until Eq (14)
converges. In details, there are three loops in this Algorithm;
ﬁrst is the number of iterations, second is the number of RIS
elements, and third is the number of angles available to control
each element. An experiment is conducted to study the BCD
performance and the results are shown in Fig. 2. In this exper-

7

Fig. 3: RIS placement with corresponding channel gain, in the
background, in 1D space.

Fig. 2: BCD convergence over iterations with different RIS
elements (M ), users (C), and quantization levels (b).

Where the phase-shifts of RIS cancel out the ones of RIS-

RSU and RIS-vehicle, Eq (6) can be rewritten as:

iment, we vary the number of RIS elements from 25 to 100
elements. Moreover, we try different number of users (C) and
control bits (b). Based on the outcomes, we can approximate
the complexity of Algorithm 2 to O(M 2b). The complexity
can further be approximated to O(M 23) = O(8M ) based on
the fact that a b of 3 is enough [6]3.

VI. CASE STUDY: RIS PLACEMENT AND VEHICLE
POSITIONING
In the literature, RIS is often proposed to tune static wireless
environments such as user equipment or IoT devices. However,
implementing RIS in dynamic medium is far more challenging
owing to the highly sensitivity of RIS phase-shift alignment.
Therefore, we carry out two studies to address the practical
RIS placement and the impacts of vehicle positioning accuracy
in the context of RIS-assist vehicular communications.

A. RIS Placement

In this section, we discuss the issue of placing RIS at
different places. We statistically study how placing the RIS at
different locations can actually improve or worsen the overall
performance. Then, we will see what is the optimal location
to situate the RIS. We start off by a hypothesis stating that
the optimal RIS placement is the closest one to the RSU.
This hypothesis is based on initial observations that indicate
the shorter the distance between the RIS and RSU, the best
channel gain can be achieved. In order to prove our claim, we
are going to derive it mathematically and then back it up with
simulation experiments.

(cid:48)

Theorem 1 Given xI < x

I , xR < xI , xR < xv, ∀v, the

inequality of zv(xI ) > zv(x

I ), ∀xI < x

I always holds.

Proof: Here, for simplicity, we take a RIS and try to place
it at different points to serve a single vehicle as shown in Fig.
3. Hence, the RIS elements will always be tuned to maximize
the channel gain for that vehicle. Fortunately, Eq (6) can be
obtained in a closed form for a single user [32].

(cid:48)

(cid:48)

θn
m =

2π
λ

(m−1)dφn

I,v +

2π
λ

(m−1)dφI,R, ∀m ∈ M, n. (15)

3Note that, based on our experiments, we found that b = 2 is enough to

achieve high performance in our context as demonstrated in Section VII.

I,Rθnhn
hH

I,v =

(cid:113)

K
M
ρ
1 + K
I,i)α(cid:112)(dI,R)α

(dn

.

(16)

Since ρ, M , and α are constant, the only factors that remain
variable are dn
I,v and dI,R which denote the distances of RSU-
RIS-vehicle. We can also notice that Eq (16) is a decreasing
function with respect to distances. Now, we need to prove that
zv(xI ) > zv(x
I . To do so, let us assume a vehicle
has Hv = N (we assume there is a single vehicle on the road).
I ) is greater when the sum of bit
To this end, zv(xI ) > zv(x
rates received throughout Hv is larger.

I ), ∀xI < x

(cid:48)

(cid:48)

(cid:48)

v(xI ) + ... + lN
v(xI ) + l2
l1
l2
I ) + ... + ln
v(x

v (xI ) > l1
v (x

(cid:48)

(cid:48)

I ), ∀xI < x

I .

v(x

(cid:48)

I )+

(cid:48)

(17)

Next, for clarity, let Y =

P ρ2

(cid:18) K

(cid:19)2

1 + K
σ2

M 2

which is a

invariant value. Hence, Eq (17) can be rewritten as:

log2(1 +

Y

I,v)α(dI,R)α ) + log2(1 +
(d1

+log2(1 +

Y
I,v)α(dI,R)α

(dN

log2(1 +

Y
I,v)α(d(cid:48)

(d(cid:48)2

I,R)α

) > log2(1 +

) + ... + log2(1 +

Y

I,v)α(dI,R)α ) + ...
(d2
Y
)+
I,v)α(d(cid:48)
I,R)α
Y
I,v)α(d(cid:48)

(d(cid:48)N

(d(cid:48)1

)

I,R)α
I .
, ∀xI < x
(18)

(cid:48)

Now, only the distance would affect the sum of bit rates
over N . To facilitate the expressions, let us further assume
one dimensional environment. Hence, dI,R = |xI − xR| and
I,v = |xn
dn
v − xI |. We can also assume α = 1. Therefore, as
absolute values are multiplicative:

dI,R × dn

I,v = |xI xn

v − x2

I − xRxn

v + xRxI |.

(19)

In Fig 4 (a), note that Eq (19) has its lowest value when
xI = xR or xI = xn
v . The ﬁrst term can always be achieved,
during the entire time horizon (∀n ∈ N ) and for all vehicles,
as long as xI and xR are ﬁxed. However, the second one,
xI = xn
v , as vehicles driving, only holds true for one time slot
n and for a speciﬁc vehicle. Therefore, with Hv > 1, we can

8

B. Vehicle Positioning Precision

One of the challenging issues in vehicular communications
is vehicle positioning in such highly dynamic environment.
Hence, in the context of RIS-assist vehicle communication,
inaccurate vehicles positioning might lead to severe conse-
quences that negatively impact the channel gain. Thus, we
attempt to understand whether it is possible to leverage the
emerging technologies related to vehicle positioning such as
3D-LIDAR (Light Detection and Ranging), Global Positioning
System, etc., for the beneﬁts of accurately estimating real ve-
hicle positions to enable RIS-aided vehicular communications.
First, based on the channel gain equations laid out in Eq
(6), the impact of inaccurate vehicle positioning on the RIS-
based system performance will be examined. Let ∆ be the
error in vehicles positioning, then, the estimated position is
xn
v ± ∆. It is worth noting that in this context, the small error
(∆) in vehicle positioning will not have signiﬁcant impact on
the cascaded channel (RSU-RIS-vehicle) path loss. Thus, we
only study the phase-shift angle deviation (difference between
accurate and estimated angles of arrival). Next, we highlight
the components in Eq (6) that are affected by inaccurate
vehicles positioning. The next equation describes the phase-
shift multiplication of the two angles of arrival, φR,I and φn
I,v,
with the RIS elements at the real position.

(a) Eq (18) curve with varying xI values.

θn
m +

2π
λ

(m − 1)d

xI − xn
v

(cid:112)(xI − xn

v )2 + Y

−

2π
λ

(m − 1)dφI,R,

(21)

∀m ∈ M, n ∈ N.

Next, we formulate the same equation, yet, at the estimated

(b) Multi-user scenario with varying xI values.

Fig. 4: Simulation results for Eq (18) and RIS placement.

position.

θn
m +

2π
λ

(m − 1)d

xI − xn

v ± ∆

(cid:112)(xI − xn

v ± ∆)2 + Y

−

(22)

2π
λ

(m − 1)dφI,R, ∀m ∈ M, n ∈ N.

conﬁdently say:

N
(cid:88)

n=1

log2(1 +

Y

I,v)α(dI,R)α ) >
(dn

N
(cid:88)

n=1

log2(1 +

T
I,v)α(d(cid:48)n

(d(cid:48)n

I,R)α

),

∀xI < x

(cid:48)

I .
(20)

After subtracting the two equations, real and estimated one

(Eq (21) - Eq (22)), we end up with the following.

2π
λ

(m − 1)d(

xI − xn
v

(cid:112)(xI − xn

v )2 + Y

−

xI − xn

v ± ∆

(cid:112)(xI − xn

v ± ∆)2 + Y
, ∀m ∈ M, n ∈ N.

)

Consequently, the right side is greater the left side which

completes the proof.

In Theorem 1, we have shown that, for a single vehicle, the
ideal place for the RIS is to be as closer as it can to the RSU.
However, in practice, there exists several constraints that force
the RIS to be distant from the RSU. For example, the LoS has
to be clear between the RIS and RSU and between the RIS
and the vehicles it serves. Otherwise, the wireless links would
be highly disturbed and the RIS will lose its functionality. In
line with our proof and discussion above, we carry out three
experiments to see the achievable minimum average bit rate for
multi-user scenario. We set xR = 0, xI = [10, 20, 30, 40, 50].
Vehicles are generated by SUMO. The outcomes are displayed
in Fig. 4 (b). One can observe that with RIS closer to RSU,
the performance was much higher. However, this performance
started to degrade dramatically as the RIS moves away from
the RSU.

(23)

Eq (23) clearly states that the cosine angle of arrival between
RIS and vehicles is affected by the error in vehicle positioning.
It is also noted that this impact occurs for all the RIS elements.
How much this deviation from the real position affects the
performance is what we answer next.

In order to show the impact of that error ∆, an experiment is
conducted to realise how the bit rate is changed while varying
the value of ∆ with various vehicle positions (the distance
from the vehicle to the RIS). The results are displayed in
Fig. 5 and indicate that the RIS can keep up to 90% of its
performance with error ∆ ranging form 20 to 100 centimeters
depending on the vehicle position. It is observed that distant
vehicles from the RIS are less impacted by ∆ as φn
I,v is
less inﬂuenced by ∆ when the distance between the vehicle
and RIS is larger. One can also see in this ﬁgure that as
∆ grows up, the bit rate decreases. Yet, the RIS elements

can be tuned with plausible ∆ values to maintain most
of the original performance expected from RIS deployment.
According to [33], vehicular carrier-phase differential Global
Navigation Satellite System (GNSS) positioning can estimate
vehicle positions with accuracy of less than 17 centimeters
accompanied by a success rate reaches up to 95%. As shown
in Fig. 5, the minimum tolerance (to achieve 90% of the
performance) of vehicle positioning is 20 centimeters which
is compatible with GNSS precision. Note that, for simplicity,
in this work, xn

v is assumed to be accurately estimated.

VII. SIMULATION AND EVALUATION

A. Simulation Setup

As mentioned earlier, we use SUMO to mimic vehicu-
lar environment. Two ﬂows of vehicles are generated; one
with normal speed (max speed 50Kph) and the other with
slow speed (max speed 30Kph). For the Deep Reinforcement
Learning, 3 linear layers are used with tanh as activation
function for the middle layers and softmax for the output layer.
Internal layers contain 64 units each and Adam optimizer is
incorporated to minimize the loss function. Learning rate is set
to 0.002, γ to 0.08, and clip to 0.02. The results were averaged
over 500 tests. The remaining parameters used in our study
are listed in Table II (unless otherwise indicated).

TABLE II: Simulation Parameters

Parameter
Road segment length
Arrival rate
σ2
K
α
P
C
ρ
M
b
xI , yI , zI
xR, yR, zR
v , zn
yn
v

Value
100 m
0.2 Veh/sec
−110 dBm
10 dB [23]
4
20 dBm
3
10 dBm
100
2 bits
10, 20, 10
0, 40, 10
20, 1

B. Numerical Results

First, we attempt to see the behaviour of the DRL agent.
As illustrated in Fig. 6, the cumulative reward, here represents
minimum average bit rate, is remarkably increasing as the
agent is exposed to more epochs/iterations. One can note that
after around 7000 iterations, the system starts to converge.

• Greedy Scheduling with BCD (GS-BCD):

In order to validate the performance of the proposed algo-
rithm, it is compared with three other benchmarks as follows
In this
scheme, the vehicle schedule sub-problem is solved with
greedy algorithm; meanwhile the passive beamforming
sub-problem is obtained using the proposed BCD scheme.
The greedy algorithm can be explained as follows. At
each time slot n ∈ N , a greedy algorithm ranks the set
of vehicles V n based on their cumulative bit rate achieved

9

up to n (zn
v ). Then, those with the lowest average bit rates
will be scheduled to be served in the following time slot.
• Random Scheduling with BCD (RS-BCD): In this
scheme, each time slot, the vehicles are randomly sched-
uled. While the proposed BCD is used for obtaining the
passive beamforming at the RIS.

• DRL with Random Phase-Shift Matrix (DRL-
RPS):The proposed DRL algorithm is used to schedule
RSU resources without any optimization over phase-
shift for the RIS elements (Random values for the RIS
elements’ phase-shift).

It is worthwhile to compare with these baseline methods
as they will show us how the performance would be if one
of the two sub-problems are solved via an alternative widely-
used method such as greedy or random while the second one
is solved with the same method we propose.

The effect of RIS number of elements M is ﬁrst studied.
As demonstrated in Fig. 7, with small number of elements, the
achievable minimum average bit rate is very limited. However,
as more elements are incorporated, the gain starts to grow
up gradually, especially for our proposed solution approach.
Another insight one can notice is the gap between the proposed
solution with other methods over different M values. It is very
apparent that this gap widens proportionally as M increases.
With M = 150, the difference between the proposed one
and the greedy algorithm is about 17%. Meanwhile, GS-BCD
seems to have also a good performance compared to the other
two methods. The reason behind that is GS-BCD attempts to
reduce the minimum average bit rates for those vehicles with
low bit rate levels. In addition, as GS-BCD leverages BCD, it
also beneﬁts from the good RIS conﬁguration. RS-BCD, on the
other hand, comes in the third place with clear gap from GS-
BCD as it does not take into account low bit rate vehicles. At
the end, DRL-RPS attains very poor performance that indicates
that without a proper RIS conﬁguration,
the performance
would be very poor even if the wireless scheduling is done
carefully.

In our next experiment, we vary the value of b for practical
RIS. When b is high, more phases are available for the
conﬁguration which is better for optimal RIS tuning. As it can
be seen in Fig. 8, larger b means better performance. Yet, one
can also notice that b of 2 or 3 can almost obtain the highest
gain. These behaviours have also been highlighted in other
works related to non-dynamic environment [5]. In the same
ﬁgure, we can see that the proposed solution always achieves
the highest performance regardless of b. Indeed, the difference
can reach up to 19% from GS-BCD. In the meantime. RS-BCD
could only achieve minimal gain with larger b and still below
0.6 of minimum average bit rate in all scenarios. In contrast
to the other methods, DRL-RPS was unable to add any gain
with larger b. That is due to the fact that this method does not
consider RIS element tuning in the ﬁrst place. Hence, higher
b values may also mean higher probability of falling to align
with the vehicles as the options of angles for the RIS elements
become larger.

Next, the impacts of road density on the network is studied.
Here, we vary the arrival rates of vehicles which results in
more or less vehicles available simultaneously within the road

10

(a)

(b)

(c)

(d)

Fig. 5: Inaccurate vehicle positioning effects on the bit rate at different positions ((a) xv = 20 (b) xv = 30 (c) xv = 40 (d)
xv = 50).

Fig. 6: Convergence over time.

Fig. 8: Discrete quantization levels effects.

RIS and vehicles. It always assigns the resources for those
with less zn
v regardless of their location or speed. Therefore,
the wireless resources might be wasted on far vehicles instead
of making beneﬁt by serving nearest ones. Also, selecting
two or more vehicles with relatively large gap between them
reduces the efﬁciency of the RIS to serve both of them since
the RIS needs to maximize the sum of immediate bit rates
which is undesirable in such scenario4. This especially appears
when less numbers of vehicles exist on the road and the
RSU oftentimes schedules for distant vehicles. In contrast,
RS-BCD attains steep increase in minimum average bit rates
with low road density since there will be less vehicles and
the probability of vehicles being served is much higher. This
impact is much less signiﬁcance with DRL-RPS due to the
miss alignment in phase-shifts with the vehicles.

Finally, one of the insightful

indices to use in similar
problem of max-min is Jain’s fairness index [34]. The formula
for this index is:

v=1 zv)2
v=1(zv)2
Then, we conduct an experiment to see the levels of jain’s

((cid:80)V
V (cid:80)V

(24)

4Note that,

the immediate average bit rate, denoted by zn

v , does not
necessarily reﬂect the ultimate average bit rate of vehicle v. It only represents
what was the average bit rate up to n which depends on the time elapsed since
vehicle v arrival. Intuitively, this value decreases over time as the elapsed time
increases, and this issue is not taken into consideration by GS-BCD.

Fig. 7: RIS number of elements M effects on network perfor-
mance.

segment. Intuitively, with small arrival rate, the RSU and RIS
can better serve the vehicles. As seen in Fig. 9, minimum
average bit rate is slightly above 1.4 bps/Hz. However, as
the road segment becomes more dense, the value degrades
to approach approximately 1 bps/Hz. For the other methods,
we can observe similar behaviours expect for GS-BCD where
its gain seems to saturate at very low arrival rates. That is
because GS-BCD does not consider the distance between the

11

study, we have also seen that DRL is an appealing solution
to cope with the highly dynamic nature of such environment
and it can adapt to various road conditions and RIS options.
In addition, BCD was also leveraged to provide efﬁcient yet
robust solutions to the RIS phase-shift matrix. In the numerical
results,
the performance of our solution method has been
analyzed thoroughly by comparing it with other benchmarks.
Aside from that, we have also carried out a study on RIS
placement to attain optimized wireless communication with
the RSU and non-static receivers.

In terms of future work, we will extend this work consid-
ering wireless resource allocation where the spectrum can be
allocated to each vehicle based on its individual needs. As
a result, the RIS phase-shift conﬁguration method can also
be updated to consider various link qualities for each speciﬁc
vehicle depending on the allocated wireless resources.

REFERENCES

[1] V. V. Chetlur and H. S. Dhillon, “Coverage and rate analysis of downlink
cellular vehicle-to-everything (C-V2X) communication,” IEEE Trans.
Wireless Commun., vol. 19, no. 3, pp. 1738–1753, 2019.

[2] A. Al-Hilo, M. Samir, C. Assi, S. Sharafeddine, and D. Ebrahimi,
“UAV-assisted content delivery in intelligent transportation systems-joint
trajectory planning and cache management,” IEEE Trans. Intell. Transp.
Syst., 2020.

[3] Q. Wu and R. Zhang, “Towards smart and reconﬁgurable environment:
Intelligent reﬂecting surface aided wireless network,” IEEE Commun.
Mag., vol. 58, no. 1, pp. 106–112, 2019.

[4] M. Elhattab, M. A. Arfaoui, C. Assi, and A. Ghrayeb, “Reconﬁgurable
intelligent surface assisted coordinated multipoint in downlink NOMA
networks,” IEEE Commun. Lett., pp. 1–1, 2020.

[5] B. Di, H. Zhang, L. Song, Y. Li, Z. Han, and H. V. Poor, “Hybrid
beamforming for reconﬁgurable intelligent surface based multi-user
communications: Achievable rates with limited discrete phase shifts,”
IEEE J. Sel. Areas Commun., vol. 38, no. 8, pp. 1809–1822, 2020.
[6] H. Zhang, B. Di, L. Song, and Z. Han, “Reconﬁgurable intelligent
surfaces assisted communications with limited phase shifts: How many
phase shifts are enough?” IEEE Trans. Veh. Technol., vol. 69, no. 4, pp.
4498–4502, 2020.

[7] Q. Wu and R. Zhang, “Beamforming optimization for wireless network
aided by intelligent reﬂecting surface with discrete phase shifts,” IEEE
Trans. Commun., vol. 68, no. 3, pp. 1838–1851, 2019.

[8] H. Alwazani, A. Kammoun, A. Chaaban, M. Debbah, M.-S. Alouini
et al., “Intelligent reﬂecting surface-assisted multi-user MISO commu-
nication: Channel estimation and beamforming design,” IEEE Open J.
Commun. Soc., vol. 1, pp. 661–680, 2020.

[9] Y. Chen, Y. Wang, J. Zhang, and Z. Li, “Resource allocation for
intelligent reﬂecting surface aided vehicular communications,” IEEE
Trans. Veh. Technol., 2020.

[10] J. Wang, W. Zhang, X. Bao, T. Song, and C. Pan, “Outage analysis
for intelligent reﬂecting surface assisted vehicular communication net-
works,” arXiv preprint arXiv:2004.08063, 2020.

[11] D. Dampahalage, K. Manosha, N. Rajatheva et al., “Intelligent
reﬂecting surface aided vehicular communications,” arXiv preprint
arXiv:2011.03071, 2020.

[12] C. You, B. Zheng, and R. Zhang, “Channel estimation and passive
beamforming for intelligent reﬂecting surface: Discrete phase shift and
progressive reﬁnement,” IEEE J. Sel. Areas Commun., vol. 38, no. 11,
pp. 2604–2620, 2020.

[13] P. Xu, G. Chen, Z. Yang, and M. Di Renzo, “Reconﬁgurable intelligent
surfaces assisted communications with discrete phase shifts: How many
quantization levels are required to achieve full diversity?” IEEE Wireless
Commun. Lett., 2020.

[14] B. Di, H. Zhang, L. Li, L. Song, Y. Li, and Z. Han, “Practical hybrid
beamforming with ﬁnite-resolution phase shifters for reconﬁgurable
intelligent surface based multi-user communications,” IEEE Trans. Veh.
Technol., vol. 69, no. 4, pp. 4565–4570, 2020.

[15] W. Tang, J. Y. Dai, M. Z. Chen, K.-K. Wong, X. Li, X. Zhao, S. Jin,
Q. Cheng, and T. J. Cui, “MIMO transmission through reconﬁgurable
intelligent surface: System design, analysis, and implementation,” IEEE
J. Sel. Areas Commun., vol. 38, no. 11, pp. 2683–2699, 2020.

Fig. 9: Min average bit rate values over different vehicle arrival
rates.

Fig. 10: Comparison for the Jain´s fairness (M = 100).

fairness attained by the four algorithms. We can notice in Fig.
10 that our proposed solution achieved the highest level of
fairness in comparison to the other methods. But, one can also
see that the four methods, in fact, obtain high levels in general.
For GS-BCD, it actually attempts to reduce the discrepancies
in minimum average bit rates among all vehicles, hence, it
enhances the fairness. RS-BCD, on the other hand, schedules
the resources at random with uniform distribution which also
improves the fairness. Finally, DRL-RPS leverages our DRL
agent which indeed tries to maximize the original maxmin
problem. That is, all the methods are able to maintain nice
levels of fairness among the vehicles. Despite this fact, it is still
true that only our proposed solution approach can achieve the
highest fairness levels while notably maximizing the minimum
average bit rates through considering the coupling effects of
the two sup-problems.

VIII. CONCLUSION

We have investigated the area of RIS integration with ve-
hicular communications. That is, the core of this work evolved
around a system model that employs RIS to provide favourable
wireless experiences for vehicles travelling in a dark zone.
The RIS has demonstrated high competence in establishing
indirect links between the RSU and vehicles. Throughout this

12

[16] J. Yuan, Y.-C. Liang, J. Joung, G. Feng, and E. G. Larsson, “Intelligent
reﬂecting surface-assisted cognitive radio system,” IEEE Trans. Com-
mun., 2020.

[17] W. Yan, X. Yuan, Z.-Q. He, and X. Kuai, “Passive beamforming and
information transfer design for reconﬁgurable intelligent surfaces aided
multiuser MIMO systems,” IEEE J. Sel. Areas Commun., vol. 38, no. 8,
pp. 1793–1808, 2020.

[18] X. Hu, C. Zhong, Y. Zhang, X. Chen, and Z. Zhang, “Location
information aided multiple intelligent reﬂecting surface systems,” IEEE
Trans. Commun., 2020.

[19] Y. Ai, L. Kong, M. Cheffena, S. Chatzinotas, and B. Ottersten, “Secure
vehicular communications through reconﬁgurable intelligent surfaces,”
arXiv preprint arXiv:2011.14899, 2020.

[20] N. Mensi, D. B. Rawat, and E. Balti, “Physical

layer security for
V2I communications: Reﬂecting surfaces vs. relaying,” arXiv preprint
arXiv:2010.07216, 2020.

[21] H. Long, M. Chen, Z. Yang, B. Wang, Z. Li, X. Yun, and M. Shikh-
Bahaei, “Reﬂections in the sky: Joint trajectory and passive beamforming
design for secure UAV networks with reconﬁgurable intelligent surface,”
arXiv preprint arXiv:2005.10559, 2020.

[22] Q. Wang, S. Leng, H. Fu, and Y. Zhang, “An IEEE 802.11 p-based
multichannel MAC scheme with channel coordination for vehicular ad
hoc networks,” IEEE Trans. Intell. Transp. Syst., vol. 13, no. 2, pp.
449–458, 2011.

[23] Z. Abdullah, G. Chen, S. Lambotharan, and J. A. Chambers, “A
hybrid relay and intelligent reﬂecting surface network and its ergodic
performance analysis,” IEEE Wireless Commun. Lett., vol. 9, no. 10, pp.
1653–1657, 2020.

[24] M. Samir, M. Elhattab, C. Assi, S. Sharafeddine, and A. Ghrayeb,
“Optimizing age of information through aerial reconﬁgurable intelligent
learning approach,” arXiv preprint
surfaces: A deep reinforcement
arXiv:2011.04817, 2020.

[25] G. Lee, M. Jung, A. T. Z. Kasgari, W. Saad, and M. Bennis, “Deep rein-
forcement learning for energy-efﬁcient networking with reconﬁgurable
intelligent surfaces,” in ICC 2020-2020 IEEE International Conference
on Communications (ICC).

IEEE, 2020, pp. 1–6.

[26] Q. Zhang, W. Saad, and M. Bennis, “Distributional reinforcement
learning for mmwave communications with intelligent reﬂectors on a
uav,” arXiv preprint arXiv:2011.01840, 2020.

[27] T. Bai, C. Pan, Y. Deng, M. Elkashlan, A. Nallanathan, and L. Hanzo,
“Latency minimization for intelligent reﬂecting surface aided mobile
edge computing,” IEEE J. Sel. Areas Commun., vol. 38, no. 11, pp.
2666–2682, 2020.

[28] J. He, K. Yu, Y. Shi, Y. Zhou, W. Chen, and K. B. Letaief, “Re-
conﬁgurable intelligent surface assisted massive MIMO with antenna
selection,” arXiv preprint arXiv:2009.07546, 2020.

[29] S. Abeywickrama, R. Zhang, Q. Wu, and C. Yuen, “Intelligent reﬂecting
surface: Practical phase shift model and beamforming optimization,”
arXiv preprint arXiv:2002.10112, 2020.

[30] E. Bøhn, E. M. Coates, S. Moe, and T. A. Johansen, “Deep reinforcement
learning attitude control of ﬁxed-wing UAVs using proximal policy
optimization,” in Proc. Int. Conf. Unmanned Aircraft Syst. (ICUAS),
2019, pp. 523–533.

[31] M. S. Shokry, D. Ebrahimi, C. Assi, S. Sharafeddine, and A. Ghrayeb,
“Leveraging UAVs for coverage in cell-free vehicular networks: A deep
reinforcement learning approach,” IEEE Trans. Mobile Comput., 2020.
[32] S. Li, B. Duo, X. Yuan, Y.-C. Liang, and M. Di Renzo, “Reconﬁgurable
intelligent surface assisted UAV communication: Joint trajectory design
and passive beamforming,” IEEE Wireless Commun. Lett., vol. 9, no. 5,
pp. 716–720, 2020.

[33] T. E. Humphreys, M. J. Murrian, and L. Narula, “Deep-urban unaided
precise global navigation satellite system vehicle positioning,” IEEE
Intell. Transp. Syst. Mag., vol. 12, no. 3, pp. 109–122, 2020.

[34] A. B. Sediq, R. H. Gohary, R. Schoenen, and H. Yanikomeroglu,
“Optimal tradeoff between sum-rate efﬁciency and jain’s fairness index
in resource allocation,” IEEE Trans. Wireless Commun., vol. 12, no. 7,
pp. 3496–3509, 2013.

