ProQ3D:ImprovedmodelqualityassessmentsusingDeepLearning.KarolisUziela1†,DavidMen´endezHurtado1†,Bj¨ornWallner2andArneElofsson1∗1DepartmentofBiochemistryandBiophysicsandScienceforLifeLaboratory,StockholmUniversity,17121Solna,Swedenand2DepartmentofPhysics,ChemistryandBiology(IFM)/Bioinformatics.Link¨opingUniversity,58183Link¨oping,Sweden.∗Towhomcorrespondenceshouldbeaddressed.†ContributedequallyNovember23,2021AbstractSummary:Proteinqualityassessmentisalong-standingprobleminbioinformatics.Formorethanadecadewehavedevelopedstate-of-artpredictorsbycarefullyselectingandoptimisinginputstoamachinelearningmethod.Thecorrelationhasincreasedfrom0.60inProQto0.81inProQ2and0.85inProQ3mainlybyaddingalargesetofcarefullytunedde-scriptionsofaprotein.Here,weshowthatasub-stantialimprovementcanbeobtainedusingexactlythesameinputsasinProQ2orProQ3butreplacingthesupportvectormachinebyadeepneuralnetwork.ThisimprovesthePearsoncorrelationto0.90(0.85usingProQ2inputfeatures).Availability:ProQ3Disfreelyavailablebothasawebserverandastand-aloneprogramathttp://proq3.bioinfo.se/Contact:arne@bioinfo.seSupplementaryinformation:SupplementarydataareavailableatarXivonline.1IntroductionIn2003wedevelopedtheﬁrstrealmodelqual-ityestimationprogramProQ(WallnerandElofs-son,2003).Incontrasttoearliermethods,suchasParkandLevitt(1996),ProQisnottrainedtorecognisethenativestructurebuttoestimatethequalityofamodel.ProQusesamachinelearn-ingapproachandmanyfeaturesdescribingapro-teinmodel.InProQthequalityiscalculatedfortheentiremodelbutin2005weextendedittoesti-matethequalityofeachresidue(WallnerandElof-sson,2006).Thequalityoftheentiremodelwasthenestimatedbysummingupthepredictedqual-itiesforeachresidue.InProQ2proﬁleweightswereaddedtoimprovethepredictions(Rayetal.,2012)andinProQ3(Uzielaetal.,2016)weaddedenergytermscalculatedfromRosetta(Leaver-Fayetal.,2011).TheProQmethodshavesincetheirintroduc-tionbeenthebestsingle-modelbasedqualityasses-sorsinCASP(Kryshtafovychetal.,2016).ProQ,ProQ2andProQ3usealargenumberofcarefullytunedinputsthatarecalculatedfromeachproteinmodel.Allparametersareoptimisedtobein-dependentofproteinsizeandtohavealimitedrange.Theseparametersarethenusedtotrainasupportvectormachineusingalinearkernel(ProQusedaneuralnetwork).Moreadvancedkernelsarecom-putationallyexpensiveanddonotproduceanysig-niﬁcantimprovements.ThismeansthatProQ2andProQ3basicallyarelinearcombinationsofalargesetoffeaturesthatallindependentlyshowaweakcorre-lationwithmodelquality.Whenthesefeaturesarecombinedamuchbettercorrelationisachieved.How-ever,theProQ2andProQ3methodscannotidentifyrelationshipswherethediﬀerentfeaturesprovideop-positeresults,i.e.itcannotidentifymorecompli-cated,non-linear,relationshipsbetweenthefeatures.Inthelastfewyearsmachinelearningusingsocalleddeepneuralnetworkshasproventobeclearlysuperiortoothermachinelearningmethods.Thesenetworksareabletoidentifynon-linearrelationships1arXiv:1610.05189v2  [q-bio.BM]  18 Oct 2016betweeninputfeatures.Weﬁndthatusingidenti-calinputsasinProQ2andProQ3butreplacingthesupportvectormachinewithadeepneuralnetworkasubstantialimprovementcanbeobtainedforbothProQ2andProQ3.Theimprovementisofasimi-larmagnitudeasobtainedbytheyearsofoptimisa-tionthatwasusedtooptimizetheinputfeaturesforProQ3,andthegaptotheconsensusbasedassessor,Pcons(Lundstrometal.,2001)hasneverbeenthissmall(CC=0.90vs0.95).2MethodsAsinProQ2andProQ3alargenumberoffeaturesarecalculateddescribingamodelandthenusedtopredictthequality,asmeasuredbytheS-score(Rayetal.,2012),forasingleresidue.TrainingwasdoneusingallmodelsfromCASP9andCASP10,thisissubstantiallymorethanwecouldusewhentrainingProQ3.TestingwasdoneonallmodelsfromCASP11excludingcancelledtargetsandtargetsshorterthan50residues.ThePearsoncorrelationforlocalandglobalqualitywasusedtoevaluatetheperformance.ThelearningwasperformedusingtheKerasPythonlibrarywiththeTheanobackend.Weusedtwodensehiddenlayerswith200and600neuronsre-spectively.Increasingthenumberoflayersandneu-ronsdidnotimprovetheresults.TheﬁnalmodelwastrainedwithAdadeltaand10−11penaltyfortheL2regularizationandshuﬄingthetrainingdata,fordetailsseesupportinginformation.3ResultsandDiscussionToestimatetheglobalqualityofaproteinmodelwithProQthepredictedqualitiesforeachresiduearesummedandthesumisdividedbytheproteinsequencelength.Thecorrelationofoverall(global)qualityissubstantiallyimprovedusingeitherProQ2orProQ3inputsbothwhenwecalculatethecorre-lationforallmodelstogether(CC-glob)orwhenthepertargetcorrelationsarestudied(CC-target),Ta-ble1andFigure1.Inaddition,proteinmodelqual-ityassessmentcanbeusedtoidentifygoodandbadTable1:PerformanceofdiﬀerentQAmethodsonCASP11.CC-globCC-targetCC-locCC-modelGDTlossProQ0.600.440.500.390.06Qprob0.710.56--0.07Qmean0.730.570.570.420.08ProQ20.810.650.690.470.06ProQ30.850.650.730.510.06ProQ2D0.850.680.720.490.05ProQ3D0.900.710.770.540.06ConsensusbasedmethodsPcons0.950.770.870.680.07Figure1:PredictedglobalmodelqualityonCASP11datasetforProQ2(top)andProQ3(bottom)trainedwithaSVM(left)orTheano(right).RMSEisarootmeansquareerrorbetweenthepredictionandthetargetvalue(lowervaluesarebetter).(a)ProQ2,SVM,(b)ProQ2D,Theano,(c)ProQ3,SVM,(d)ProQ3D,Theanoregionsofamodel,i.e.thelocalquality.Hereweob-tainasimilarimprovementasachievedfortheglobal2qualityestimationindependentlyifitismeasuredforallresidues(CC-loc)orpermodel(CC-model)Ta-ble1.Finally,weexaminedifbettertop-rankedmod-elscouldbeselectedusingthenewqualityestima-tors.WecalculatedtheaverageGDTlossoftheﬁrstrankedmodelsforeachmethod.Unfortunately,theselectionoftoprankedmodelsdoesnotshowanysigniﬁcantimprovementbetweenanyofthetopQAmethods.However,thesameisobservedwhenus-ingPcons,althoughthecorrelationisprobablyquiteclosetothetheoreticallimit,asitishigherthanthecorrelationbetweendiﬀerentmethodsusedtoeval-uatethequalityofamodelWallnerandElofsson(2007).Thisindicatesthattoadvancefurtheritwillbenecessarytouseadiﬀerentapproach.FundingThisworkwassupportedbygrantsfromtheSwedishResearchCouncil(VR-NT2012-5046toAEand2012-5270toBW)andSwedishe-ScienceResearchCenter(BW).Computationalresourceswerepro-videdbytheSwedishNationalInfrastructureforComputing(SNIC)atNSC.ReferencesKryshtafovych,A.,Barbato,A.,Monastyrskyy,B.,Fidelis,K.,Schwede,T.,andTramontano,A.,2016.Methodsofmodelaccuracyestimationcanhelpselectingthebestmodelsfromdecoysets:AssessmentofmodelaccuracyestimationsinCASP11.Proteins,84Suppl1:349–369.Leaver-Fay,A.,Tyka,M.,Lewis,S.,Lange,O.,Thompson,J.,Jacak,R.,Kaufman,K.,Ren-frew,P.,Smith,C.,Sheﬄer,W.,etal.,2011.ROSETTA3:anobject-orientedsoftwaresuiteforthesimulationanddesignofmacromolecules.MethodsEnzymol,487:545–574.Lundstrom,J.,Rychlewski,L.,Bujnicki,J.,andElof-sson,A.,2001.Pcons:aneural-network-basedconsensuspredictorthatimprovesfoldrecognition.ProteinSci,10(11):2354–2362.Park,B.andLevitt,M.,1996.Energyfunctionsthatdiscriminatex-rayandnearnativefoldsfromwell-constructeddecoys.JMolBiol,258(2):367–392.Ray,A.,Lindahl,E.,andWallner,B.,2012.Im-provedmodelqualityassessmentusingproq2.BMCBioinformatics,13:224.Uziela,K.,Shu,N.,Wallner,B.,andElofsson,A.,2016.Proq3:Improvedmodelqualityassessmentsusingrosettaenergyterms.SciRep,6:33509.Wallner,B.andElofsson,A.,2003.Cancorrectpro-teinmodelsbeidentiﬁed?ProteinSci,12(5):1073–1086.Wallner,B.andElofsson,A.,2006.Identiﬁcationofcorrectregionsinproteinmodelsusingstructural,alignment,andconsensusinformation.ProteinSci,15(4):900–913.Wallner,B.andElofsson,A.,2007.PredictionofglobalandlocalmodelqualityinCASP7usingpconsandproq.Proteins,69Suppl8:184–193.3Supportingmaterialfor:”ProQ3D:ImprovedmodelqualityassessmentsusingDeepLearning.”KarolisUziela,DavidMenendezHurtado,NanjiangShu,Bj¨ornWallnerandArneElofsson1SupplementaryResultsHere,weprovideresultsthatareanalogicaltotheonesinthemaintextbutonanotherdataset-CAMEO(Haasetal.,2013).AllCAMEOmodelsfrom2014-06-06to2015-05-30wereused.TableS1showsthecorrelationsandGDTlossforCAMEOdatasetandFigureS1showsthemodelqualitypredictionscatterplots.AswealreadynotedforCASP11,thedeeplearningversionsofthepredictors(ProQ2DandProQ3D)aresuperiortotheirSVM-basedcounterparts(ProQ2andProQ3).Additionally,weprovidethelocalprediction(residue-level)scatterplotsforCASPandCAMEOdatasets(Fig-ureS2andS3).ThedensityplotssuggestthatthedeeplearningversionsofmethodsarebetteratdistinguishinglowqualitymodelsonCASP11dataset(S-score<0.1)andhighqualitymodelsonCAMEOdataset(S-score>0.9).InthebenchmarkweusedtheupdatedProQversion(ProQres)thatisabletopredictthelocalmodelquality(Wall-nerandElofsson,2006).Wehavealsocomparedourmethodswithtwootherstate-of-the-artmethods:Qmean(Benkertetal.,2008)andQprob(CaoandCheng,2016),aswellasareferenceconsensusmethodPcons(Lundstrometal.,2001).2Methods2.1ArchitectureThechosenarchitectureisthatofaMultiLayerPerceptron(MLP)(LeCunetal.,1998)withtwohiddenlayersof600and200hiddenunitsrespectively,andusingReLU(Glorotetal.,2011)asanonlinearity.TheparametersareoptimisedwithAdadelta(Zeiler,2012),amodiﬁcationontheStochasticGradientDescentthatcanautomaticallyadaptthelearningrate,tryingtooptimisethemeansquarederror.Weusedtworegularisationmethods:dropout(Srivastavaetal.,2014)andL2penaltyontheweights.Varyingthenumberofneuronsineachlayerdidnotyieldasigniﬁcantdiﬀerenceintheresults.Addingmorehiddenlayersgivesworseresultsbecausetheconvergenceissloweddown(GlorotandBengio,2010),andthemodeldoesnotgainexpressivenesssinceitisalreadyanuniversalapproximator(Horniketal.,1989).2.2DropoutWithdropout,attrainingtime,wesettozero(”drops”)arandomfractionpofthehiddenneuronsofeachlayerineachiteration,whilemultiplyingtherestbyafactor1/p.ForamodelwithHhiddenunits,theoutputattesttimeisthegeometricmeanofthe2Hpossiblecombinations,eachofwhichhasseenatmostonedatapoint,andarestronglyregularisedtowardstheconsensus.Followingtheoriginalpaper,wesetp=0.5.1arXiv:1610.05189v2  [q-bio.BM]  18 Oct 20162.3L2penaltyWiththeaimtodiscouragelargeweightsandimprovegeneralisationaccuracy,weaddatermtothelossfunction:λXW2ij,(1)whereλisascalarandWaretheweightmatricesoftheMLP.Thispreventsweightstogrowtoolargeunlesstheyaresuﬃcientlybeneﬁcial,thatis,theycanovercomethepenaltyinthelossfunction.Wetesteddiﬀerenttrainingpenaltiesrangingfrom10−4to10−12,withminoreﬀectsonthequalityoftheresults.2.4ImplementationTheimplementationwasdoneusingtheKerasframework(Chollet,2015)andtheTheanobackend(TheanoDevel-opmentTeam,2016),andtrainedonGPUs.However,theProQ3DprogramdoesnotrequireGPUtorun,becausepredictionworksfastenoughonCPU(lessthan1secondpermodel,excludingfeaturegeneration).2TableS1:PerformanceofdiﬀerentQAmethodsonCAMEOdatasetCC-globCC-targetCC-locCC-modelGDTlossProQ0.670.540.520.450.04Qprob0.680.53--0.04Qmean0.680.480.540.470.05ProQ20.750.570.600.500.04ProQ30.790.580.650.550.04ProQ2D0.790.600.640.520.04ProQ3D0.820.600.690.580.04ConsensusbasedmethodsPcons0.890.670.810.700.05ReferencesBenkert,P.,Tosatto,S.,andSchomburg,D.(2008).QMEAN:Acomprehensivescoringfunctionformodelqualityassessment.Proteins,71(1),261–277.Cao,R.andCheng,J.(2016).Proteinsingle-modelqualityassessmentbyfeature-basedprobabilitydensityfunctions.SciRep,6,23990.Chollet,F.(2015).Keras.https://github.com/fchollet/keras.Glorot,X.andBengio,Y.(2010).Understandingthediﬃcultyoftrainingdeepfeedforwardneuralnetworks.InInProceedingsoftheInternationalConferenceonArtiﬁcialIntelligenceandStatistics(AISTATS10).SocietyforArtiﬁcialIntelligenceandStatistics.Glorot,X.,Bordes,A.,andBengio,Y.(2011).Deepsparserectiﬁerneuralnetworks.InG.J.GordonandD.B.Dunson,editors,ProceedingsoftheFourteenthInternationalConferenceonArtiﬁcialIntelligenceandStatistics(AISTATS-11),volume15,pages315–323.JournalofMachineLearningResearch-WorkshopandConferenceProceedings.Haas,J.,Roth,S.,Arnold,K.,Kiefer,F.,Schmidt,T.,Bordoli,L.,andSchwede,T.(2013).Theproteinmodelportal–acomprehensiveresourceforproteinstructureandmodelinformation.Database(Oxford),2013,bat031.Hornik,K.,Stinchcombe,M.,andWhite,H.(1989).Multilayerfeedforwardnetworksareuniversalapproximators.NeuralNetworks,2(5),359–366.LeCun,Y.,Bottou,L.,Orr,G.B.,andM¨uller,K.-R.(1998).Eﬃicientbackprop.InNeuralNetworks:TricksoftheTrade,ThisBookisanOutgrowthofa1996NIPSWorkshop,pages9–50,London,UK,UK.Springer-Verlag.Lundstrom,J.,Rychlewski,L.,Bujnicki,J.,andElofsson,A.(2001).Pcons:aneural-network-basedconsensuspredictorthatimprovesfoldrecognition.ProteinSci,10(11),2354–2362.Srivastava,N.,Hinton,G.E.,Krizhevsky,A.,Sutskever,I.,andSalakhutdinov,R.(2014).Dropout:asimplewaytopreventneuralnetworksfromoverﬁtting.JournalofMachineLearningResearch,15(1),1929–1958.TheanoDevelopmentTeam(2016).Theano:APythonframeworkforfastcomputationofmathematicalexpressions.arXive-prints,abs/1605.02688.3FigureS1:PredictedglobalmodelqualityonCAMEOdatasetforProQ2(top)andProQ3(bottom)trainedwithaSVM(left)orTheano(right).RMSEisarootmeansquareerrorbetweenthepredictionandthetargetvalue(lowervaluesarebetter).(a)ProQ2,SVM,(b)ProQ2D,Theano,(c)ProQ3,SVM,(d)ProQ3D,Theano4FigureS2:PredictedlocalmodelqualityonCASP11datasetforProQ2(top)andProQ3(bottom)trainedwithaSVM(left)orTheano(right).RMSEisarootmeansquareerrorbetweenthepredictionandthetargetvalue(lowervaluesarebetter).(a)ProQ2,SVM,(b)ProQ2D,Theano,(c)ProQ3,SVM,(d)ProQ3D,Theano5FigureS3:PredictedlocalmodelqualityonCAMEOdatasetforProQ2(top)andProQ3(bottom)trainedwithaSVM(left)orTheano(right).RMSEisarootmeansquareerrorbetweenthepredictionandthetargetvalue(lowervaluesarebetter).(a)ProQ2,SVM,(b)ProQ2D,Theano,(c)ProQ3,SVM,(d)ProQ3D,Theano6Wallner,B.andElofsson,A.(2006).Identiﬁcationofcorrectregionsinproteinmodelsusingstructural,alignment,andconsensusinformation.ProteinSci,15(4),900–913.Zeiler,M.D.(2012).ADADELTA:anadaptivelearningratemethod.CoRR,abs/1212.5701.7