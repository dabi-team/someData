Visual Forecasting by Imitating Dynamics in Natural Sequences

Kuo-Hao Zeng‚Ä†‚Ä° William B. Shen‚Ä† De-An Huang‚Ä† Min Sun‚Ä° Juan Carlos Niebles‚Ä†
‚Ä†Stanford University ‚Ä°National Tsing Hua University
{khzeng, bshen88, dahuang, jniebles}@cs.stanford.edu sunmin@ee.nthu.edu.tw

7
1
0
2

g
u
A
9
1

]

V
C
.
s
c
[

1
v
7
2
8
5
0
.
8
0
7
1
:
v
i
X
r
a

Abstract

We introduce a general framework for visual forecast-
ing, which directly imitates visual sequences without ad-
ditional supervision.
As a result, our model can be ap-
plied at several semantic levels and does not require any
domain knowledge or handcrafted features. We achieve this
by formulating visual forecasting as an inverse reinforce-
ment learning (IRL) problem, and directly imitate the dy-
namics in natural sequences from their raw pixel values.
The key challenge is the high-dimensional and continuous
state-action space that prohibits the application of previous
IRL algorithms. We address this computational bottleneck
by extending recent progress in model-free imitation with
trainable deep feature representations, which (1) bypasses
the exhaustive state-action pair visits in dynamic program-
ming by using a dual formulation and (2) avoids explicit
state sampling at gradient computation using a deep feature
reparametrization. This allows us to apply IRL at scale and
directly imitate the dynamics in high-dimensional continu-
ous visual sequences from the raw pixel values. We evaluate
our approach at three different level-of-abstraction, from
low level pixels to higher level semantics: future frame gen-
eration, action anticipation, visual story forecasting. At all
levels, our approach outperforms existing methods.

1. Introduction

Our goal is to expand the boundaries of video analy-
sis towards visual forecasting by building intelligent sys-
tems that are capable of imitating the dynamics in natu-
ral visual sequences. The idea of visual forecasting has
been studied in several contexts, such as trajectory forecast-
ing [1, 19, 46], activity prediction [23, 40], and future frame
synthesis [18, 50]. However, most previous work either as-
sumes short forecasting horizons [42, 47], or focuses on a
speciÔ¨Åc application, such as walking trajectories [1, 19, 49]
or human actions [14, 23], where handcrafted features play
an important role.

In this paper, we propose a general framework for visual
forecasting1, where it can be applied to learn a model at any

1http://ai.stanford.edu/Àúkhzeng/projects/vfid/

Figure 1. We propose a general framework for visual forecasting.
We formulate this as an imitation learning problem, where the nat-
ural visual sequences are served as expert behaviors, and visual
forecasting is reformulated as learning a policy to reproduce the
expert‚Äôs behavior. Our framework imitate dynamics in visual se-
quences directly from its raw pixel value and is applicable to tasks
with different levels of abstraction.

given semantic-level (see Figure 1) and does not require any
domain knowledge or handcrafted features. Such frame-
work for forecasting can be widely useful in real world sce-
narios: robot motion planning [17, 20] or warning systems
for autonomous vehicles [4]. We achieve this by formu-
lating visual forecasting as an inverse reinforcement learn-
ing (IRL) [31] problem, where the natural sequences serve
as expert demonstrations, and the goal becomes recover-
ing the underlying cost function that prioritizes the entire
expert trajectories over others. This eliminates the com-
pounding error problem of single-timestep decisions [11],
and has been proven effective in long-term prediction in
both robotics [6, 21, 54] and vision [19, 27].

Our key insight is to extend previous IRL work in vi-
sion to directly imitate the dynamics in visual sequences
from their raw pixel values, where no domain knowledge or
handcrafted feature would be required. This is in contrast
to previous work that applies IRL on handcrafted features,
such as the semantic scene labeling for trajectory forecast-
ing [19, 26] and interaction statistics for dual agent inter-
action [14]. The main challenge is that both the state and
action space would become high-dimensional and continu-

Hug?StateStateStateStateùíÇActionùíÇFuture Frames Generationùëéùëé?Storyline?ForecastingùëéùëéActionAnticipationùëéùëéHigh-level Low-levelt 
 
 
 
 
 
ous in such setting, which prevent scaling up existing IRL
algorithms used in previous work [11, 54].

We address this challenge by extending recent progress
in model-free imitation learning [11, 12] with the capac-
ity of jointly trainable deep feature representations. More
speciÔ¨Åcally, we extend the Generative Adversarial Imita-
tion Learning framework of Ho and Ermon [11] with deep
feature reparametrization to forecast the dynamics in natu-
ral visual sequences. The deep representation is fully dif-
ferentiable and we optimize it jointly using policy gradi-
ent, which results in learning an intermediate representa-
tion that is best-suited for visual forecasting. The resulting
model (1) bypasses the dynamic programming based sub-
routine of [54] that exhaustively visits every state-action
pair by using a dual formulation, and (2) avoids explicit
state sampling (image synthesis in this case) of gradient
computation in [11] with reparametrization using deep fea-
ture representations. This allows us to operate beyond low-
dimensional state-action spaces and directly forecast the
natural sequence from the pixel-level.

We demonstrate the effectiveness of our approach by ap-
plying our model to three tasks that require different lev-
els of understanding of visual dynamics. First, we exam-
ine the ability of our method to perform generation of fu-
ture frames on the moving MNIST data sequences [41].
Results from future frame generation demonstrate that our
framework can capture the low-level (pixel-level) visual dy-
namics between consecutive frames. Second, we exam-
ine the ability of our method to perform action anticipa-
tion by unsupervised training on the THUMOS15 dataset
[8], and evaluating the resulting model on the TV Human
Interactions dataset [35]. Results from action anticipation
show that our framework is effective in modeling mid-level
(motion-level) visual dynamics in natural videos. Finally,
we apply our method on the Visual Storytelling dataset [15]
and try to forecast the next photo in a story composed of im-
ages. Results on this task demonstrate that our framework
can generalize to visual dynamics on a highly abstract level
(semantic-level). In each task, our method outperforms all
existing methods.

In summary, the main contributions of our work are: (1)
We propose a general IRL based formulation for visual se-
quence forecasting that requires no domain knowledge or
handcrafted features. (2) We address the computational bot-
tlenecks of IRL when operating at high-dimensional contin-
uous spaces by using a dual formulation and reparametriza-
tion with deep feature representations. (3) We evaluate our
method on three tasks at different levels of abstraction and
show that our framework outperforms all existing methods.

2. Related Work

Visual Prediction. There has been growing interest in
developing computational models of human activities that

can extrapolate unseen information and predict future un-
observed activities [5, 28, 33, 41, 43, 45, 50, 53]. Some
of the existing approaches [5, 28, 43, 44, 45, 50] tried to
generate realistic future frames using generative adversarial
networks [7]. Unlike these methods, we emphasize longer-
term sequential dynamics in videos using inverse reinforce-
ment learning. Other line of work attempted to infer the ac-
tion or human trajectories that will occur in the subsequent
time-step based on previous observation [1, 14, 19, 23, 42].
Our model directly imitates the natural sequence from the
pixel-level and assumes no domain knowledge.
Reinforcement Learning in Computer Vision. Reinforce-
ment learning (RL) achieves remarkable success in mul-
tiple domains ranging from robotics [9], computer vision
[3, 30, 32] and natural language processing [25, 52].
In
the RL setting, the reward function that the agent aims to
maximize is given as signal for training, where the goal
is to learn a behavior that maximizes the expected reward.
On the other hand, we work on the inverse reinforcement
learning (IRL) problem, where the reward function must
be discovered from demonstrated behavior [11, 31, 54].
This is inspired by recent progress of IRL in computer vi-
sion [6, 14, 19, 26, 27, 46]. Nonetheless, these frameworks
require heavy use of domain knowledge to construct the
handcrafted features that are important to the task. Unlike
these approaches, we aim to generalize IRL to natural se-
quential data without annotations.
Unsupervised Representation Learning in Video. Our
combination of deep neural networks with IRL to directly
imitate natural videos is related to recent progress in un-
supervised representation learning in videos. The temporal
information in the video has been utilized to learn useful
features based on tracking [48], Ô¨Çow prediction [47], future
frame synthesis [41], frame order [29], and object move-
ment [34]. Our work utilizes not only the frame-to-frame
dynamics, but tries to imitate the entire sequence directly to
utilize long-range temporal information.
Generative Adversarial Learning. Our extension of gen-
erative adversarial imitation learning [11] is related to re-
cent progress in generative adversarial networks (GAN) [7].
While there has been multiple works on applying GAN to
image and video [16, 37, 43, 51], we extend it to long-term
prediction of natural visual sequences and directly imitate
the high-dimensional continuous sequence.

3. Forecasting Natural Sequences

Our goal is to build a system that can forecast the dynam-
ics of natural videos. We formulate this as an inverse rein-
forcement learning problem, where the goal is to recover
the underlying cost function that induces the natural visual
sequence. This is equivalent to learning a policy œÄ(v(cid:48)|v)
that parameterizes the transition from a current frame v to
the next frame v(cid:48). As shown in Figure 2, at training time,

sequences. Therefore, p(v(cid:48)|v, a) = 1 for the single visual
state v(cid:48) = va that we can visit after taking action a, and is
zero otherwise. In this case, the policy œÄ(va|v) of moving to
a state va is equivalent to choosing the corresponding action
œÄ(a|v). As result, we are able to use œÄ(v(cid:48)|v) and œÄ(a|v) in-
terchangeably depending on the context (same for c(v, v(cid:48))
and c(v, a)). Our goal of inverse reinforcement learning
(IRL) is in contrast to reinforcement learning (RL), where
the cost function is observed and the goal is to learn the
optimal policy œÄ(a|v) that minimizes the expected cost. In
IRL, the cost function is not observed, and the goal is to
imitate the behaviors of the expert by recovering the under-
lying cost function c(v, a) that induces the observed optimal
behavior by the expert.

3.2. Imitating Natural Visual Sequences

We formulate the visual prediction as an inverse rein-
forcement learning problem, where the goal is to imitate
the behavior of natural sequences that are treated as expert
demonstrations. In this section, we discuss the model-free
imitation learning framework of Ho and Ermon [11] that
allows us to bypass the exhaustive state-action pair visit
in dynamic programming of Maximum Entropy (MaxEnt)
IOC [54] used in previous works [14, 19]. In the next sec-
tion, we discuss how we apply it efÔ¨Åciently to natural visual
sequences from the pixel level.

In contrast to reinforcement learning, the cost function
in IRL is not given and has to be recovered from expert
demonstrations œÑE. We follow previous work and adopt the
maximum causal entropy framework [54] for the optimiza-
tion of our cost function:

max
c‚ààC

( min
œÄ‚ààŒ†

‚àíH(œÄ) + EœÄ[c(v, a)] ) ‚àí EœÄE [c(v, a)],

(1)

where Œ† is a policy space and H(œÄ) (cid:44) EœÄ[‚àílog œÄ(a|v)] is
the Œ≥-discounted causal entropy [2] of the policy œÄ.

The standard approach for this IRL problem used in pre-
vious work [19, 54] involves a RL inner loop that utilizes
dynamic programming to exhaustively visit every state and
the available actions for value function computation. How-
ever, such procedure is intractable in our problem, as both
our state and action spaces are high-dimensional and con-
tinuous. The key observation to resolve this problem is
that IRL Eq. (1) is actually a dual of an occupancy mea-
sure matching problem [12]. Here, the occupancy measure
œÅœÄ(v, a) of a policy œÄ is deÔ¨Åned as the distribution of the
visit of state-action pairs while following the policy œÄ. This
reformulates Eq. (1) as:

min
œÄ

dœà(œÅœÄ, œÅœÄE ) ‚àí H(œÄ),

(2)

where dœà(¬∑, ¬∑) measures the difference between two occu-
pancy measures depending on the regularizer œà. Intuitively,

Figure 2. We formulate visual prediction as an imitation learn-
ing problem, where the goal becomes learning a policy œÄ that can
generate trajectory œÑ following the behavior of natural visual se-
quence, or expert demonstration œÑE. This is reformulated as Ô¨Ånd-
ing a policy œÄ that has a state-action pair visit distribution œÅ that
is similar to that of the expert (œÅE). At test time, we thus have
a learned policy œÄ that can mimic the behavior of natural visual
sequence and perform visual prediction.

our model observes and imitates a large amount of natu-
ral visual sequences to learn the policy. At testing time,
the learned policy œÄ(v(cid:48)|v) can then be directly applied to
an image for long-term visual prediction. Despite its many
potential applications, learning œÄ(v(cid:48)|v) is challenging as v
is an image that is high-dimensional and continuous. This
makes both the exhaustive state-action pairs visit and the
explicit state sampling in previous work [11, 54] intractable
at scale. Our solution to this extends and reparametrizes the
model from Ho and Ermon [11] with deep representations.
Our framework bypasses exhaustive state-action pair visit
of [54] by the dual formulation of [11], and avoids explicit
state sampling (which is equivalent to frame synthesis) dur-
ing the gradient computation in [11].

In the following, we discuss how we formulate natural
visual sequences as Markov Decision Processes so that our
inverse reinforcement learning framework can be applied.

3.1. Visual Sequences as Markov Decision Process

In this work, we model natural visual sequences as
Markov Decision Processes (MDP) [36]. At each time step,
the sequence is at some frame/image v, which is deÔ¨Åned
as the state of our MDP. Given a chosen action a from the
state, the process responds by moving to a new state, or
frame v(cid:48) based on the transition model p(v(cid:48)|v, a) and re-
ceives a cost c(v, a). In this work, the transition model is
deterministic as we are directly imitating the natural visual

ùúèEùúèùúãùúãTrainingTestingùúãinput ùë£prediction ùë£‚Ä≤ùúãùúèSCurrent Policy (ùúã)‚âàùúåEùúåFigure 3. Overview of our imitation learning. The optimization iterates between policy update and cost function update. During the cost
(D) update, the goal is to Ô¨Ånd a cost that best differentiate expert‚Äôs trajectory œÑE from our generated trajectory œÑ . During the policy (œÄ)
update, we estimate the expected cost Q and use policy gradient with roll out to minimize it (see more detail in supplementary). This
framework also has a generative adversarial learning interpretation, where the cost is operating as the discriminator and the policy is
functioning as the generator.

this aims to induce a policy that visits state-action pairs with
similar frequency to that of the expert policy. This allows us
to use the demonstrated state-action pairs of expert directly
as learning signal to encourage the policy toward expert-like
region in state-action space and bypass the exhaustive visit
of dynamic programming.

As presented in [11], under certain selection regularizer

œà, dœà(¬∑, ¬∑) becomes:

max
D

EœÄŒ∏ [log(D(v, a))] + EœÄE[log(1 ‚àí D(v, a))],

(3)

where D(v, a) can be interpreted as a discriminator that
tries to distinguish the state-action pairs from the expert or
the induced policy. This interpretation connects imitation
learning with generative adversarial network (GAN) [7].
Essentially, our imitation learning of natural visual se-
quences can be seen as jointly training (1) a discriminator
that tries to distinguish our generated sequence from ex-
pert‚Äôs and (2) a policy that forms as a generator that uses
the learning signal provided by the discriminator to move
toward expert-like regions. We refer the readers to [11] for
more details of the algorithm. The important note is that no
speciÔ¨Åc restriction would be put on the form of approxima-
tion for both D and œÄ and this allows us to directly imitate
high-dimensional continuous sequence.
Optimization. Let Dw be D parameterized by weights w,
œÄŒ∏ be œÄ parameterized by Œ∏, œÑ = {vt} be trajectory of states
vt from current policy, and œÑE = {vE
t } be expert trajectory
given as demonstration, the optimization of Eq. (2) with Eq.
(3) alternates between the maximizing the discriminative
power of Dw through (the left panel in Figure 3):

EœÑ ‚àºœÄŒ∏ [‚àáw log(Dw(vt, vt+1))]
+ EœÑE‚àºœÄE[‚àáw log(1 ‚àí Dw(vE

t , vE

t+1))],

and a policy gradient step (the right panel in Figure 3):

EœÑ ‚àºœÄŒ∏ [‚àáŒ∏ log(œÄŒ∏(vt+1|vt))Q(vt, vt+1)]

(4)

(5)

(6)

that aims to maximize the expected return Q(vt, vt+1),
which is in turn deÔ¨Åned as

Q(v, v(cid:48)) = EœÑ ‚àºœÄŒ∏ [log(Dw(vt, vt+1))|v0 = v, v1 = v(cid:48)],

(7)
the expectation of confusing the discriminator that the gen-
erated sequence œÑ is a expert‚Äôs sequence.

3.3. EfÔ¨Åcient Sampling with Deep Representation

Now we have formulated visual prediction as an IRL
problem and presented a generative adversarial imitation
learning framework [11] that is applicable to our problem,
because it bypasses the dynamic programming based sub-
routine that iterates through all the states and actions. How-
ever, we would like to point out there is still a remaining
computational bottleneck that prevents the direct applica-
tion of this framework to the image space.

Notice in the gradient computation for both the discrim-
inator and the policy (Eq. (5) and Eq. (6)) that we are re-
quired to sample trajectories œÑ from the current policy œÄŒ∏.
This is equivalent to sampling a sequence of images/frames
at each gradient computation. The problem of image syn-
thesis itself is challenging and computational intensive [18],
and prevents the direct application of their framework to
large scale visual sequence datasets.

Our key insight to address this is to parameterize both
the discriminator Dw and the policy œÄŒ∏ with a intermedi-
ate representation œÜ(¬∑) that is feasible to sample at the op-
timization, but still captures sufÔ¨Åcient information from the
image:

œÄ(vt+1|vt) = ÀÜœÄ(œÜ(vt+1)|œÜ(vt)),
D(vt, vt+1) = ÀÜD(œÜ(vt), œÜ(vt+1)).
(9)
In this case, the sampling of vt+1 from vt is a three step
process (all steps in Figure 4):

(8)

vt+1 = œÜ‚àí1(ht+1),

ht+1 ‚àº ÀÜœÄŒ∏(¬∑|ht),

ht = œÜ(vt).

(10)

ùê∑ùúãùúèùúèEùúèùê∑ùúãùúãFix ùúã, Update ùê∑Expertùúãùúã‚Ä¶‚Ä¶ùê∑‡∑úùë£3,‡∑úùë£4‚Ä¶ùëÑùë£1,ùë£2Fix ùê∑, Update ùúãGen.ùê∑ùë£2,‡∑úùë£3ùê∑ùë£1,ùë£2ùë£1ùë£2ùë£3‡∑úùë£3‡∑úùë£4‡∑§ùë£4ance matching. We show that our method can still mimic
human behavior at the semantic-level from the pixel values.

4.1. Future Frame Generation

In this experiment, we examine our method‚Äôs ability to
perform future frame generation by training on the moving
MNIST data sequences [41]. Unlike the two following ex-
periments, frame generation (œÜ‚àí1) is feasible at this scale
and we thus also optimize it in our framework and explic-
itly sample images at the gradient computation.
Dataset. The moving MNIST dataset generates moving
digits by randomly selecting 2 digits from MNIST dataset
[24] and randomly moving the digits according to the posi-
tions in the previous frame. The size of frames are 64 √ó 64.
Implementation Details. We note that the state of this
dataset is not fully speciÔ¨Åed by a single image, because
the lack of motion information. We thus deÔ¨Åne the state
as three consecutive images. We extend the architecture
of DCGAN [37] to have multi-frame input for frame syn-
thesis, which consists of a 5-layer 3D convolutional neu-
ral network encoder capturing the information of the image,
and a 5-layer 2D deconvolutional neural network with up-
sampling as decoder for image generation (See more detail
in supplementary). The encoder is treated as our œÜ(¬∑) and
decoder is treated as our œÜ(¬∑)‚àí1. We train on sequences
of length 10. We use curriculum learning to sequentially
increase the prediction horizon. At test time, the goal is
to generate four consecutive frames given only the initial
frame.
Baselines. We compare to the following models:
- L1 loss. We use the same network architecture as ours
based on DCGAN [37], but only use the L1 reconstruction
error of future frame as loss.
- LSTM. We compare to the LSTM prediction model of [41].
- Generative Adversarial Network (GAN). We perform the
ablation study of our model by removing the sequence mod-
eling of imitation learning to demonstrate its importance. In
this case, the policy directly aims to minimize the local cost
function D from the discriminator without sampling it to be
its long term expectation Q. On the other hand, the discrim-
inator only aims to differentiate a single step generated by
our policy from the expert‚Äôs. This reduces our model to be
equivalent to GAN [7].
Metric. We follow previous works [43] and evaluate all
methods by human evaluation (See more detail for the set-
ting of human evaluation in supplementary). We show on
average how many times the output sequence of a method
can fool the annotator that it is an actual sequence from
the moving MNIST dataset. In this case, the upper bound
would be 50% where the generated sequence is the same as
real, and the differentiation of real and generated is just by
chance.
Results. The result is shown in Table 1.

It veriÔ¨Åes that

Figure 4. We reparametrize the policy with deep feature represen-
tation to avoid explicit state sampling during the gradient com-
putation. The steps of sampling from œÄ is decomposed in to (1)
applying œÜ(vt) to get the hidden representation ht, (2) sampling
from reparametrized policy ÀÜœÄ to get ht+1, (3) applying œÜ‚àí1(ht+1)
for the next state. However, the third step is not required as we sub-
sequently apply œÜ(œÜ‚àí1(ht+1)) for the sampling in the next time
step and cancel out the inverse operation.

The main advantage of this parameterization is that the chal-
lenging œÜ‚àí1 (image synthesis from hidden representation)
is actually not required in the gradient computation, since:

œÄ(vt+1|vt) = ÀÜœÄ(œÜ(vt+1)|œÜ(vt))
= ÀÜœÄ(œÜ(œÜ‚àí1(ht+1))|ht) = ÀÜœÄ(ht+1|ht),

(11)

(12)

and similar for the discriminator. In this case, only the inter-
mediate representation is required to be sampled for the gra-
dient computation (the top path in Figure 4). In this work,
we use the deep convolutional neural networks as our œÜ(¬∑)
because of its success in representing the visual informa-
tion [22]. It is important to note that this œÜ(¬∑) is also fully
differentiable and we approximate it by optimizing it jointly
in the policy gradient step of Eq. (6). This reparametrization
allows us to directly imitate natural visual sequences from
its pixel value and goes beyond the computational limitation
in previous works.

4. Experiments

We evaluate our model on three challenging tasks at
three different levels of abstraction. The Ô¨Årst is future frame
generation in the moving MNIST dataset [41], where the
image synthesis (œÜ‚àí1) is feasible to verify the effectiveness
of our imitation learning formulation. The second task is ac-
tion anticipation on the TV Human Interactions dataset [35].
We verify the predictive capacity of our model directly im-
itating natural video [8] from the pixel-level with our deep
reparametrization. Finally, we apply our method on the Vi-
sual Storytelling dataset [15] to predict the next photo in a
storyline that consists of Ô¨Åve photos. This is extremely chal-
lenging as there can be no clue from direct visual appear-

ùúãùúã‡∑úùúã‡∑úùúãùõªùúã,ùõªùê∑ùúëùë£ùë°ùë£ùë°+1ùë£ùë°+2‚Ñéùë°‚Ñéùë°+1‚Ñéùë°+2Accuracy (%) Real sequence
Real sequence
Our method
GAN
LSTM [13]
L1

50.0
15.1
10.2
1.4
0.3

Table 1. Human evaluation results on the moving MNIST dataset.
Our imitation learning framework is able to predict and synthe-
size more realistic consecutive future frames compared to the base-
lines because our IRL‚Äôs minimization of long-term expected cost
at training.

Figure 5. Qualitative results on the moving MNIST dataset. Our
model trained with IRL aims to minimize long-term expected cost
over the entire sequence. This results in having consistent high-
quality frame prediction across time step, and avoids the com-
pounding error problem of baselines.

our method can better generate realistic future frames com-
pared to all baselines. The qualitative results are shown in
Figure 5 (See more qualitative results in supplementary).
It is important to note the difference of our method com-
pared to GAN. As shown in Figure 5, the result of GAN
becomes much worse and drifts away from the original dig-
its as the time step increases. This is due to the fact that
it only considers the local cost at training time in contrast
to our IRL framework that handles the compounding error
problem in long-term prediction. On the other hand, our
method is trained with IRL objective and effectively show
high-quality synthesis even for long-term prediction.

4.2. Action Prediction on Videos in the Wild

We examined our method‚Äôs ability to perform action pre-
diction on the videos in the wild following the setup of [42],
where the goal is to forecast basic human actions one sec-
ond before they start. In this experiment, frames synthesis
(œÜ‚àí1) is no longer computationally feasible at scale. There-
fore we need to use our deep reparametrization of the frame-
work in Section 3.3. We demonstrate the model‚Äôs ability to
capture the dynamics of natural videos directly from raw
pixels.
Dataset. We evaluate our results on TV Human Interac-

tions dataset [35], which has 300 videos of four different
interactive actions performed by people. We follow pre-
vious work [42] and use the THUMOS15 dataset [8] as
our unsupervised imitation learning dataset. THUMOS15
consists of trimmed UCF-101 dataset [39] and untrimmed
background videos. It has 101 action categories covering a
wide range of actions in real world.
Implementation Details. We follow the training procedure
and hyperparameters in [42] and reimplemented their meth-
ods for a fair comparison. Our reported number is similar to
that reported in [42]. We train our model with the same set-
ting. We Ô¨Årst do imitation learning on the THUMOS dataset
with the states/frames being sampled at the same rate as test
time (one second in this case). The predictive methods use
the ‚Äúadapted‚Äù setting in [42] during training. As it is in-
feasible to perform frame synthesis in this task, we use our
reparametrization of policy. Our œÜ(¬∑) uses the architecture
in [10]. This architecture is also used baselines. Our ÀÜœÄ for
sampling the learned deep representation uses autoencoder
with 3-layer encoder and decoder (See more detail in sup-
plementary).
Baselines. We compare to the following methods:
- SVM. Two setups on SVM training are considered [42].
The Ô¨Årst setup is to train SVM one second before the action
starts in the training time. In this case, the distribution of
visual features are the same at both training and testing time.
The second is to train SVM during the action at the training
time. In this case, the input at testing (one second before the
action) has different distribution from training, but training
frames are given the correct feature for the action. We refer
to the Ô¨Årst one as SVM and the second and SVM static.
- LSTM. We compare to the LSTM prediction model of [41]
as sequential training baseline that addresses the com-
pounding error problem.
- Deep Regression Network [42]. We compare to the direct
deep feature regression approach of Vondrick et al. [42].
Their K = 1 model can be treated as a proxy of ablation
study of our approach by replacing IRL with L2 regres-
sion loss. We also reimplemented their best performing ap-
proach with explicit mixture model (K = 3) for predicting
multiple possible futures as reference.
-Pixel Synthesis. As mentioned in Section 3.3, we resolve
the challenge of computational bottleneck from pixel syn-
thesis by introducing a reparametrization that jointly learns
a deep representation. It is important to point out that this
not only makes our framework efÔ¨Åcient, but also makes it
effective for semantic prediction. We develop a baseline
to demonstrate that our reparametrization is more effective
than synthesizing pixels of the future frames. We follow our
approach in Section 4.1 and apply the model to downsam-
pled version (64 x 64) of the videos. We anticipate the ac-
tion with the same setting used by other baselines. The only
difference is that now the SVM is applied to deep features

Ground TruthOur MethodGANLSTML1tFigure 6. Single step action prediction results. Given an input
frame one second before the the interaction takes place, our model
is able to robustly predict the future frame and improve signiÔ¨Å-
cantly over the baselines for action prediction. The frame visu-
alization is retrieved by nearest neighbor image of the predicted
deep representation.

Model
Random
SVM static
SVM
Deep Regression (K = 1) [42]
LSTM [41]
Pixel Synthesis
Ours
Deep Regression (K = 3) [42]

Accuracy (%)
25.0
36.2
35.8
37.5
40.5
26.1
45.8
44.0

Table 2. Accuracy of action prediction on the TV Human Interac-
tion dataset. Our learned policy signiÔ¨Åcantly outperforms recon-
struction loss based baselines. Our single mode policy also out-
performs deep mixture regression model which is designed specif-
ically for this task.

extracted from the synthesized future frames rather than the
deep representation directly predicted by our model.
Results. The results for action anticipation are shown in
Table 2. Our IRL formulation of action prediction signiÔ¨Å-
cantly outperforms the corresponding version using just L2
loss (Deep Regression K = 1). In addition, we are able
to outperform the sequential baseline using just the recon-
struction loss (LSTM). It is also important to note that our
single mode policy without mixture model is already able
to outperform the best performing Deep Regression with
explicit mixture model for handling multiple possible fu-
tures. Note that our reported reimplementation of K = 1
is slightly worse than their reporting number because we
perform unsupervised learning for all methods only on the
THUMOS dataset for a fair comparison. This indicates

Figure 7. Multi-step video prediction results. Given only a single
frame as input, our learned policy is able to accurately forecast
multiple future frames in natural video. This veriÔ¨Åes the effec-
tiveness of our IRL formulation and reparametrization that allows
direct imitation from the pixel level. Images are retrieved by near-
est neighbor of predicted deep feature.

that single mode regression is more prone to be affected by
dataset bias and demonstrate the robustness of our method.
On the other hand, the accuracy of Pixel Synthesis is 26.1%,
which is lower than our framework by a large margin. This
veriÔ¨Åes the importance of bypassing pixel synthesis in our
framework for anticipating action in natural videos. Quali-
tative results of action prediction is shown in Figure 6 (See
more qualitative results in supplementary). It can be seen
that our learned policy robustly predicts the action after one
second. We further demonstrate that our model is able to
predict more than one step into future frames. The qual-
itative results are shown in Figure 7. This shows the ef-
fectiveness of our imitation learning framework for visual
prediction, and veriÔ¨Åes that our model can imitate natural
video from the pixel value using our reparametrization of
deep representation.

4.3. Storyline Forecasting on Semantic Dynamics

In the Ô¨Ånal experiment, we evaluate our method on the
challenging semantic forecasting in visual storylines [15,
38]. Given a storyline consisting of images, our goal is to
predict the next image. This is challenging as the change of
semantic meaning might not be capture directly through vi-
sual feature matching. Our setup is similar to the prediction
task of [38].
Dataset.
We use the Visual Storytelling Dataset
(VIST) [15] for our storyline forecasting task. The dataset
consists of photos from more than 100,000 albums from
Flickr. We randomly select one photo sequence of story-
line from each album. Using the original dataset split in the
dataset, this results in total 8024 training, 1011 testing, and
998 validation storylines, where each consists of Ô¨Åve photos
illustrating a story. Note that while we follow the evalua-
tion setup of [38], their dataset is not applicable to our task
as they only have 10 storylines per concept for evaluation
only and does not have the large scale human demonstrated

HandshakeHigh FiveHugKissKissHugPredicted FrameInputIncorrectCorrectGroundTruthInputPredicted FramesFigure 8. Accuracy of storyline prediction on the Visual Story-
telling Dataset. We follow previous work and evaluate short-term
and long-term prediction separately.
It can be seen that nearest
neighbor on the deep feature representation is a strong baseline
is this case because the goal is similar to retrieve visually simi-
lar frames. On the other hand, nearest neighbor does not work
for long-term prediction. Our general visual prediction framework
performs the best for the long-term prediction. This veriÔ¨Åes that
our model can also be applied to the challenging semantic predic-
tion, while learning directly from the pixel.

storyline available for imitation learning.
Experimental Setup and Metrics. We follow [38] and
split the storyline evaluation into two goals:
the Ô¨Årst is
short-term, where the image is visually similar consecutive
image in the album. The second goal is long-term predic-
tion, where prediction is for the next representative event in-
volving large visual appearance change. We follow [38] and
posed this as a classiÔ¨Åcation task, where the goal is to select
the true image along with other four other images selected
randomly from the same album. We use the training set
storylines as expert demonstrations for both our imitation
learning and unsupervised learning of baselines. We report
resulting accuracy for the test split on both the short-term
and long-term prediction (See more detail for experimental
setup in supplementary).
Baselines. We again compare to LSTM [41] and Deep Re-
gression Network [42] from the previous task. In addition,
we compare to nearest neighbor of the ResNet-101 feature
representation [10], which is proven to be a strong baseline
for short-term prediction [38].
Results. The results of short-term and long-term predic-
tion are shown in Figure 8. For short term prediction, we
observe the similar results as with in [38], where nearest
neighbor is the strongest baseline as the goal is similar to
Ô¨Ånding the photo with the most similar visual feature.
It
is important to note that our method still outperforms re-
construction loss based baselines (LSTM and Deep Regres-
sion Network) in this case. For the long-term prediction,
it can be seen that the nearest neighbor of visual appear-
ance matching no longer works and performs poorly. On
the other hand, our direct imitation of storyline photos from
the pixel values is proven effective compared to both LSTM
and Deep Regression Networks. This veriÔ¨Åes that our ap-

Figure 9. Qualitative results of storyline forecasting. Green boxes
indicate correct prediction of the next image in the storyline, and
red boxes indicate incorrect predictions. Our imitation learning
based framework can best capture the semantics by imitating sto-
rylines generated by human. On the other hand, baselines focusing
on appearance matching or reconstruction loss is harder to suc-
cessfully predict semantics in the storylines.

proach is general and can even applied to imitate human be-
havior at the challenging semantic-level. Qualitative results
are shown in Figure 9 (See more qualitative results in sup-
plementary). It can be seen from the Ô¨Ågure that our method
can better predict semantically meaning next photo in the
storyline. First three rows show our correct prediction, and
the Ô¨Ånal row shows incorrect prediction. It can be seen that
our method is able to capture the semantic meaning (event
or location) of the input photo and continue to forecast pho-
tos with similar semantic meaning.

5. Conclusion

We have presented a general framework for long-term vi-
sual prediction. We formulate this as an IRL problem, and
extend previous works to directly imitate natural visual se-
quences from the pixel level. The key challenge is the high-
dimensional and continuous natural of images. We address
this by (1) introducing dual formulation of IRL to natural
visual sequences that bypasses exhaustive state-action pair
visit, and (2) reparametrization using deep representation to
avoid explicit state synthesis during gradient computation.
We demonstrated that our framework is general and effec-
tive using three tasks at different level of abstractions: (1)
future frame generation, (2) action prediction, (3) storyline
forecasting. We veriÔ¨Åed that our uniÔ¨Åed framework is able
to outperform existing methods on all three tasks.

Acknowledgement. We thank National Taiwan University
(NTU-106R104045), NOVATEK Fellowship, MediaTek,
Intel, Naval Research (N00014-15- 1-2813), and Panasonic
for their support. We thank Danfei Xu, Linxi Fan, Animesh
Garg, Tseng-Hung Chen and Hou-Ning Hu for helpful com-
ments and discussion.

InputOurNNDeep Regression (K=3)Ground TruthReferences

[1] A. Alahi, K. Goel, V. Ramanathan, A. Robicquet,
L. Fei-Fei, and S. Savarese. Social lstm: Human tra-
jectory prediction in crowded spaces. In CVPR, 2016.
1, 2

[2] M. Bloem and N. Bambos. InÔ¨Ånite time horizon max-
imum causal entropy inverse reinforcement learning.
In CDC, 2014. 3

[3] N. J. Butko and J. R. Movellan. Optimal scanning for

faster object detection. In CVPR, 2009. 2

[4] F.-H. Chan, Y.-T. Chen, Y. Xiang, and M. Sun. Antic-
ipating accidents in dashcam videos. In ACCV, 2016.
1

[5] C. Finn, I. Goodfellow, and S. Levine. Unsupervised
learning for physical interaction through video predic-
tion. In NIPS, 2016. 2

[6] C. Finn, S. Levine, and P. Abbeel. Guided cost learn-
ing: Deep inverse optimal control via policy optimiza-
tion. In ICML, 2016. 1, 2

[7] I. Goodfellow, J. Pouget-Abadie, M. Mirza, B. Xu,
D. Warde-Farley, S. Ozair, A. Courville, and Y. Ben-
gio. Generative adversarial nets. In NIPS, 2014. 2, 4,
5

[8] A. Gorban, H. Idrees, Y.-G. Jiang, A. Roshan Zamir,
I. Laptev, M. Shah, and R. Sukthankar. THUMOS
challenge: Action recognition with a large number of
classes, 2015. 2, 5, 6

[9] S. Gu, E. Holly, T. Lillicrap, and S. Levine. Deep
reinforcement learning for robotic manipulation with
asynchronous off-policy updates. In ICRA, 2017. 2

[10] K. He, X. Zhang, S. Ren, and J. Sun. Deep residual

learning for image recognition. In CVPR, 2016. 6, 8

[11] J. Ho and S. Ermon. Generative adversarial imitation

learning. In NIPS, 2016. 1, 2, 3, 4

[17] A. Jain, A. Singh, H. S. Koppula, S. Soh, and A. Sax-
ena. Recurrent neural networks for driver activity an-
In ICRA,
ticipation via sensory-fusion architecture.
2016. 1

[18] N. Kalchbrenner, A. v. d. Oord, K. Simonyan,
and
I. Danihelka, O. Vinyals, A. Graves,
arXiv
K. Kavukcuoglu. Video pixel networks.
preprint arXiv:1610.00527, 2016. 1, 4

[19] K. M. Kitani, B. D. Ziebart, J. A. Bagnell, and
M. Hebert. Activity forecasting. In ECCV, 2012. 1, 2,
3

[20] H. Koppula and A. Saxena. Anticipating human activ-
ities using object affordances for reactive robotic re-
sponse. In TPAMI, 2015. 1

[21] H. Kretzschmar, M. Spies, C. Sprunk, and W. Bur-
gard. Socially compliant mobile robot navigation via
inverse reinforcement learning. IJRR, 2016. 1

[22] A. Krizhevsky, I. Sutskever, and G. E. Hinton.

Im-
agenet classiÔ¨Åcation with deep convolutional neural
networks. In NIPS, 2012. 5

[23] T. Lan, T.-C. Chen, and S. Savarese. A hierarchical
representation for future action prediction. In ECCV,
2014. 1, 2

[24] Y. LeCun, L. Bottou, Y. Bengio, and P. Haffner.
Gradient-based learning applied to document recog-
nition. IEEE, 1998. 5

[25] J. Li, W. Monroe, T. Shi, A. Ritter, and D. Jurafsky.
Adversarial learning for neural dialogue generation. In
EMNLP, 2017. 2

[26] W.-C. Ma, D.-A. Huang, N. Lee, and K. M. Kitani.
Forecasting interactive dynamics of pedestrians with
Ô¨Åctitious play. In CVPR, 2017. 1, 2

[27] S. Mathe and C. Sminchisescu. Action from still im-
age dataset and inverse optimal control to learn task
speciÔ¨Åc visual scanpaths. In NIPS, 2013. 1, 2

[12] J. Ho, J. K. Gupta, and S. Ermon. Model-free imitation
learning with policy optimization. In ICML, 2016. 2,
3

[28] M. Mathieu, C. Couprie, and Y. LeCun. Deep multi-
scale video prediction beyond mean square error. In
ICLR, 2016. 2

[13] S. Hochreiter and J. Schmidhuber. Long short-term

memory. Neural computation, 1997. 6

[14] D.-A. Huang and K. M. Kitani. Action-reaction: Fore-
casting the dynamics of human interaction. In ECCV,
2014. 1, 2, 3

[15] T.-H. K. Huang, F. Ferraro, N. Mostafazadeh, I. Misra,
J. Devlin, A. Agrawal, R. Girshick, X. He, P. Kohli,
D. Batra, et al. Visual storytelling. In NAACL, 2016.
2, 5, 7

[16] P. Isola, J.-Y. Zhu, T. Zhou, and A. A. Efros. Image-
to-image translation with conditional adversarial net-
works. In CVPR, 2017. 2

[29] I. Misra, C. L. Zitnick, and M. Hebert. ShufÔ¨Çe and
learn: unsupervised learning using temporal order ver-
iÔ¨Åcation. In ECCV, 2016. 2

[30] V. Mnih, N. Heess, A. Graves, et al. Recurrent models

of visual attention. In NIPS, 2014. 2

[31] A. Y. Ng, S. J. Russell, et al. Algorithms for inverse

reinforcement learning. In ICML, 2000. 1, 2

[32] L. Paletta, G. Fritz, and C. Seifert. Q-learning of se-
quential attention for visual object recognition from
informative local descriptors. In ICML, 2005. 2
[33] H. S. Park, J.-J. Hwang, Y. Niu, and J. Shi. Egocentric

future localization. In CVPR, 2016. 2

[34] D. Pathak, R. Girshick, P. Doll¬¥ar, T. Darrell, and
B. Hariharan. Learning features by watching objects
move. In CVPR, 2017. 2

[51] X. Yan, J. Yang, K. Sohn, and H. Lee.

At-
tribute2image: Conditional image generation from vi-
sual attributes. In ECCV, 2016. 2

[35] A. Patron-Perez, M. Marszalek, A. Zisserman, and
I. D. Reid. High Ô¨Åve: Recognising human interactions
in tv shows. In BMVC, 2010. 2, 5, 6

[52] L. Yu, W. Zhang, J. Wang, and Y. Yu. Seqgan: se-
quence generative adversarial nets with policy gradi-
ent. In AAAI, 2017. 2

[53] K.-H. Zeng, S.-H. Chou, F.-H. Chan, J. C. Niebles,
and M. Sun. Agent-centric risk assessment: Accident
anticipation and risky region localization. In CVPR,
2017. 2

[54] B. D. Ziebart, A. L. Maas, J. A. Bagnell, and A. K.
Dey. Maximum entropy inverse reinforcement learn-
ing. In AAAI, 2008. 1, 2, 3

[36] M. L. Puterman. Markov decision processes: discrete
stochastic dynamic programming. John Wiley & Sons,
2014. 3

[37] A. Radford, L. Metz, and S. Chintala. Unsupervised
representation learning with deep convolutional gen-
erative adversarial networks. In ICLR, 2016. 2, 5

[38] G. A. Sigurdsson, X. Chen, and A. Gupta. Learning
visual storylines with skipping recurrent neural net-
works. In ECCV, 2016. 7, 8

[39] K. Soomro, A. R. Zamir, and M. Shah. Ucf101: A
dataset of 101 human actions classes from videos in
the wild. arXiv preprint arXiv:1212.0402, 2012. 6

[40] B. Soran, A. Farhadi, and L. Shapiro. Generating no-
tiÔ¨Åcations for missing actions: Don‚Äôt forget to turn the
lights off! In ICCV, 2015. 1

[41] N. Srivastava, E. Mansimov, and R. Salakhutdinov.
Unsupervised learning of video representations using
lstms. In ICML, 2015. 2, 5, 6, 7, 8

[42] C. Vondrick, H. Pirsiavash, and A. Torralba. Antici-
pating visual representations from unlabeled video. In
CVPR, 2016. 1, 2, 6, 7, 8

[43] C. Vondrick, H. Pirsiavash, and A. Torralba. Gener-
ating videos with scene dynamics. In NIPS, 2016. 2,
5

[44] C. Vondrick and A. Torralba. Generating the future
with adversarial transformers. In CVPR, 2017. 2

[45] J. Walker, C. Doersch, A. Gupta, and M. Hebert. An
uncertain future: Forecasting from variational autoen-
coders. In ECCV, 2016. 2

[46] J. Walker, A. Gupta, and M. Hebert. Patch to the fu-
ture: Unsupervised visual prediction. In CVPR, 2014.
1, 2

[47] J. Walker, A. Gupta, and M. Hebert. Dense optical
Ô¨Çow prediction from a static image. In ICCV, 2015. 1,
2

[48] X. Wang and A. Gupta. Unsupervised learning of vi-

sual representations using videos. In ICCV, 2015. 2

[49] D. Xie, S. Todorovic, and S.-C. Zhu. Inferring ‚Äúdark
In ICCV,

matter‚Äù and ‚Äúdark energy‚Äù from videos.
2013. 1

[50] T. Xue, J. Wu, K. Bouman, and B. Freeman. Vi-
sual dynamics: Probabilistic future frame synthesis
via cross convolutional networks. In NIPS, 2016. 1, 2

