7
1
0
2

n
u
J

9
2

]
P
A

.
t
a
t
s
[

2
v
0
4
4
8
0
.
6
0
7
1
:
v
i
X
r
a

Challenges to estimating contagion effects from
observational data

Elizabeth L. Ogburn

1 Background

2 Motivating example

Suppose that students attending the residential Faber College are measured and
weighed at the start and close of each school year, and a complete social network
census is taken, cataloguing all social ties among members of the student body. In
addition, researchers have access to basic demographic covariates measured on each
student. Researchers are interested in testing whether there is a contagion effect for
body mass index (BMI): if one individual–the ego–gains (or looses) weight, does
that make his or her social contacts–the alters–more likely to do the same? They are
also interested in estimating the contagion effect if one exists: if an ego gains (or
looses) weight, what is the expected increase (or decrease) in the alters’ body mass
indices?

There are many different procedures one could use to test for or estimate a con-
tagion effect, using different models, different assumptions, different sets of covari-
ates, different ways of calculating intervals or uncertainty, and the list goes on. In
order for a procedure to be useful, it has to satisfy two requirements. First, it has
to isolate the causal effect of the ego’s change in BMI on the alters’ changes in
BMI from potential other sources of similarity between the ego’s and the alters’
outcomes. This has to do with confounding, which is the subject of Section 4.

The second requirement for a useful analysis is that it must be generalizable to
populations beyond the precise student body used in the analysis. We would like to
be able to extrapolate what we learn about contagion from the Faber student body
to contagion of BMI in similar college populations across different colleges or even
across different years at Faber College. Assume that the student body we observe

Elizabeth L. Ogburn
Johns Hopkins Bloomberg School of Public Health, 615 N. Wolfe St. Baltimore MD, e-mail:
eogburn@jhsph.edu;supportfromONRgrantN000141512343

1

 
 
 
 
 
 
2

Elizabeth L. Ogburn

at Faber College is representative of these other student populations, that is, that
the true underlying contagion effect for the observed sample of Faber students is
the same as the true underlying contagion effect in the other college populations to
which we want to extrapolate. Then one way to determine whether we are warranted
in extrapolating from Faber students to the other similar groups of students is to
calculate a conﬁdence interval for the true contagion effect, based on a model of
asymptotic growth of the sample. For example, if the sample is large enough that a
central limit theorem approximately holds for the contagion effect estimate, then a
Gaussian conﬁdence interval around the sample mean is approximately valid. Under
the assumption of the same true underlying contagion effect, our conﬁdence that this
interval covers the true contagion effect for Faber College students is the same as our
conﬁdence that it covers the true contagion effect for students at a different college
or in a different year. As in many settings for statistical inference, asymptotics are
appropriate not because we care about an inﬁnite population but because they shed
light on ﬁnite samples. This requires valid statistical inference, which is the subject
of Section 5.

3 Deﬁning causal effects

ego(yt−1

ego(y) −Y t

Questions about the inﬂuence one subject has on the outcome of another subject are
inherently questions about causal effects: contagion is a causal effect on an ego’s
outcome at time t of his alter’s outcome at time s for some s < t. Causal effects
are deﬁned in terms of potential or counterfactual outcomes (see e.g. Hern´an, 2004;
Rubin, 2005). In general, a unit-level potential outcome, Yi(z), is deﬁned as the out-
come that we would have observed for subject i if we could have intervened to
set that subject’s treatment or exposure Zi to value z. A contagion effect of inter-
est for dyadic data might be a contrast of counterfactuals of the form Y t
alter),
for example E (cid:2)Y t
ego(y − 1)(cid:3) would be the expected difference in the ego’s
counterfactual outcome at time t had the alter’s outcome at time t − 1 been set to
y compared to y − 1. In data comprised of independent dyads this contagion effect
is well-deﬁned, but social networks represent a paradigmatic opportunity for inter-
ference, whereby one subject’s exposure may affect not only his own outcome but
also the outcomes of his social contacts and possibly other subjects. Under inter-
ference, the traditional unit-level potential outcomes are not well-deﬁned. Instead,
Yi(z) is the outcome that we would have observed if we could have set the vector
of exposures for the entire population, Z, to z = (z1, ..., zn) where for each i, zi is
in the support of Z. The causal inference literature distinguishes between interfer-
ence, which is present when one subject’s treatment or exposure may affect others’
outcomes, and contagion, which is present when one subject’s outcome may inﬂu-
ence or transmit to other subjects (e.g. Ogburn and VanderWeele, 2014a), but in fact
they are usually intertwined. Consider three Faber students: Alex, Andy, and Ari,
all friends with each other. Alex’s outcome at time t depends on both Andy’s and
Ari’s outcomes at time t − 1, Andy’s outcome at time t depends on Alex’s and Ari’s

Challenges to estimating contagion effects from observational data

3

Ari ), Y t

Alex(yt−1

Andy(yt−1

Andy, yt−1

Ari ), and Y t

at time t − 1, and Ari’s outcome at time t depends on Alex’s and Andy’s at time
t − 1. This results in a situation that is hardly distinguishable from the hallmarks of
Alex, yt−1
interference: Y t
Andy) are potential
outcomes that depend on multiple “treatments” and those treatments are overlapping
across subjects. Furthermore, just as in settings with interference, a counterfactual
outcome for node i that omits some of the treatments to which node i is exposed (i.e.
the outcomes at time t − 1 for some of i’s alters) is not well-deﬁned. This has been
overlooked in most of the literature on contagion in observational social network
data, which generally focuses on alter-ego pairs, thereby inherently considering ill-
deﬁned counterfactuals like Y t

Alex, yt−1

Ari(yt−1

Alex(yt−1

Andy).

ego(yt−1

This points to an under-appreciated challenge for the study of contagion in a
social network: simply deﬁning the causal effect of interest. If researchers sample
non-overlapping alter-ego dyads from the network then Y t
alter) may be well-
deﬁned, but if they wish to use all of the available data, comprised of overlapping
dyads, causal effects must be deﬁned in terms of all of the alters for a particular ego.
In the latter case, we could deﬁne a contagion effect that compares the mean coun-
terfactual outcome for an ego had the mean outcome among the alters been set to
one value as opposed to a different value. For simplicity, in the remaining sections
we will talk about alter-ego pairs rather than clusters of an ego with all of its alters.
This is in keeping with the existing applied literature, but it is important to note
that close attention should be paid in future work to the deﬁnition of causal conta-
gion effects for non-dyadic data. Numerous papers and researchers have addressed
the deﬁnition of counterfactuals and causal effects in settings with interference (e.g.
Aronow and Samii, 2012; Halloran and Struchiner, 1995; Halloran and Hudgens,
2011; Hong and Raudenbush, 2006; Hudgens and Halloran, 2008; Ogburn and Van-
derWeele, 2014a; Rosenbaum, 2007; Rubin, 1990; Sobel, 2006; Tchetgen Tchetgen
and VanderWeele, 2012); similar attention should be paid to contagion effects.

4 Confounding

Confounding, is, loosely, the presence of a non-causal association that may be mis-
interpreted as a causal effect of one variable on another. Most commonly, confound-
ing is due to the presence of a confounder that has a causal effect on both the hy-
pothesized cause and the hypothesized effect. Such a confounder generates an asso-
ciation between the hypothesized cause and effect which, without careful analysis,
could be taken as evidence of a causal effect. There are two types of confounding
that are nearly ubiquitous and especially intransigent in the context of contagion
effects in social networks: homophily is the tendency of people who are similar to
begin with to share network ties, and environmental confounding is the tendency
of people who share network ties to also share environmental exposures that could
jointly affect their outcomes. We elucidate these two types of confounding below.

4

4.1 Homophily

Elizabeth L. Ogburn

Consider the Faber College student body. Suppose that two students, Pat and Lee,
meet in September and bond over the fact that they both used to be competitive
runners but recently developed injuries that prevent them from running and from
participating in other active hobbies they used to enjoy. Soon Pat and Lee are close
friends. Over the course of a few months, the sedentary lifestyle catches up with
Pat, who gains a considerable amount of weight. It takes longer for Lee, but by
the close of the school year Lee has also gained a lot of weight. If you did not
have access to the back story and only observed that Pat gained weight and then
Pat’s close friend Lee did too, this looks like potential evidence of a causal effect of
Pat’s change in BMI on Lee’s change in BMI. In fact, this is a case of homophily:
unobserved covariates related to the propensity to gain weight (in this case, recent
injury) caused Pat and Lee to become friends and also caused them to both undergo
changes in BMI.

Some carefully considered studies attempt to control for all sources of homophily
(see Shalizi and Thomas, 2011 for details and references), but this is generally not
possible unless researchers have a high degree of control over data collection and
can collect extremely rich (and therefore expensive!) data on the covariates that af-
fect ties. Any traits that are related to the formation, duration, or strength of ties and
to the outcome of interest must be measured. For some outcomes, such as infectious
diseases, it may be possible to enumerate and observe all such traits, but for other
outcomes, such as BMI, endless permutations of the Pat-and-Lee story are possible
(e.g. friendship based on shared body norms, shared love of sugary snacks, shared
appreciation for a particular celebrity whose BMI changes could affect both Pat and
Lee’s, etc.), making it nearly impossible to control for all potentially confounding
traits. In addition to the challenge of enumerating the potentially confounding traits,
there are huge costs to collecting such rich data, and available social network data
are highly unlikely to include adequate covariates.

For these reasons, researchers have developed clever tricks to try to control for
homophily using only data the network and the outcome of interest. One such trick
is to include both the alter and the ego’s outcomes ate time t − 2 as covariates in a
regression of the ego’s outcome at time t on the alter’s outcome at time t − 1. The
argument used to justify this method is that any traits related to tie formation and to
the outcome are fully captured by the similarity in the alter and ego’s outcomes at
time t − 2; any association between the alter’s outcome at time t − 1 and the ego’s
at time t after controlling for this baseline similarity must be due to contagion. But
the story of Pat and Lee demonstrates one ﬂaw in this argument: baseline traits can
affect outcome trajectories over time and so conditioning on the outcome at a single
time point does not render all future outcome measures independent of the baseline
covariates. Another ﬂaw in the argument is that homophily operates not only through
the propensity to form ties, but also through the propensity to maintain ties and
through the strength of the ties; neither strength nor duration can be captured by
past outcomes (Noel and Nyhan, 2011). Furthermore, Shalizi and Thomas (2011)
demonstrated that, even if a baseline trait only affects friendship formation (not

Challenges to estimating contagion effects from observational data

5

strength or duration), merely conditioning on the presence of a tie, which is inherent
in all analyses focused on alter-ego pairs, creates a spurious association between the
alter’s outcome at time t − 1 and the ego’s outcome at time t. This is because the
presence of a tie is a collider: a common effect of two variables, conditioning on
which creates a spurious association between the two causes. (For an accessible
review of colliders see Elwert and Winship, 2014.)

Another clever trick is to compare the strength of the association between an al-
ter’s and an ego’s outcomes across different types of ties: undirected, or mutual; di-
rected, with the ego naming the alter as a friend but not vice versa; and directed, with
the alter naming the ego as a friend but not vice versa. Suppose Pat claims Lee as a
friend but Lee does not claim Pat as a friend. Any similarity in baseline traits that Pat
and Lee share is a symmetric relationship, the argument goes, and therefore if the
regression of Pat’s BMI at time t on Lee’s BMI at time t − 1 results in a larger coefﬁ-
cient than does the regression of Lee’s BMI at time t on Pat’s BMI at time t − 1, this
is evidence of contagion. Unfortunately, this argument is also ﬂawed (Lyons, 2011;
Shalizi and Thomas, 2011). This is because, somewhat counterintuitively, similarity
in baseline traits does not have to be symmetric. Suppose Pat claims Lee as a friend
because Lee is the only person Pat knows who is going through a painful separation
with running and other active hobbies, while Lee participates in a support group for
recently injured former runners and considers only one participant, Lou, who has
the exact same injury and prognosis, as a friend. By construction, even though Lee
is the node with the most baseline similarity to Pat from among all of Pat’s potential
friends, the reverse is not true: Lou, not Pat, is the node with the most similarity to
Lee from among all of Lee’s potential friends. Therefore, if Lou’s outcome at time
t − 1 has a stronger association with Lee’s outcome at time t − 1 than Pat’s does, this
could be evidence of greater similarity on baseline characteristics rather than con-
tagion. Furthermore, it can be shown that a similar story results in reciprocated ties
having the strongest association of all (Lyons, 2011). Shalizi and Thomas (2011)
used a slightly different data-generating process to show that purported evidence
for contagion due to asymmetry in the association of an alter’s outcome with an
ego’s outcome for different types of ties is consistent with homophily rather than
contagion.

4.2 Shared environment

Let’s turn to a different pair of Faber students, Cam and Sam, who both decided to
move off campus to a neighborhood across town from the college. Over the course
of the school year, both the grocery store and the gym in their neighborhood closed
down and were replaced with fast food restaurants. Cam immediately starts taking
every meal at the fast food joint and gains weight fairly quickly, while Sam holds out
for several months, taking the bus to a distant grocery store, but when time winter
weather and ﬁnal exams pile on Sam, too, falls prey to the fast food marketing. By
the end of the year both students have gained weight. This is confounding due to

6

Elizabeth L. Ogburn

shared environment, another source of confounding that plagues attempts to learn
about contagion from observational data. People who share network ties tend to live
near each other, work together, pay attention to the same information, or work in the
same industry, all of which can generate confounding due to shared environment
(which need not be restricted to physical environment). Note that confounding due
to shared environment is present whether Cam and Sam are friends because they
live in the same neighborhood or they moved to the same neighborhood because
they were friends. The distinction between homophily and shared environment is
not always clearcut; if Cam and Sam became friends because they lived in the same
neighborhood that would simultaneously be an example of homophily and of shared
environment. The same strategies described above for dealing with homophily have
been used in an attempt to control for confounding due to shared environment, but
similar reasoning controverts their effectiveness.

Cohen-Cole and Fletcher (2008) proposed controlling for confounding by shared
environment by including ﬁxed effects for “community” in regressions of an ego’s
outcome at time t on an alter’s outcome at time t − 1. If all such confounding occurs
due to clearly delineated and known communities, like well-deﬁned neighborhoods
in the example above, this is potentially a good solution, though in many cases the
operative communities, or their membership, will likely be unknown.

5 Dependence

Suppose confounding is not an issue, because researchers at Faber were well-funded
and prescient enough to collect data on every possible confounder of the conta-
gion effect, and further suppose that the researchers have a model–maybe a regres-
sion, maybe a propensity-score based method (Aral et al, 2009), maybe some other
model–that they believe gives an estimate of the causal contagion effect. We now
turn to the question of how to perform valid statistical inference using a model ﬁt
to data from a social network. The issue of valid statistical inference is entirely sep-
arate from the issue of confounding or even contagion; it applies whether we want
to estimate a simple mean or a complicated causal effect. The key points made in
this section apply to anything that we want to estimate using social network data.
Most estimators of causal effects, including The coefﬁcient on the alter’s outcome
at time t − 1 in a regression of the ego’s outcome at time t, are closely related to
sample means (to be technical, they are M-estimators), so all of the points made
below apply.

Going back to Faber College, administrators are now interested in the simpler
problem of estimating the mean BMI for the student body at the end of the school
year. There are n students, or nodes in the social network comprised of students,
and each one furnishes an observed BMI measurement Yi. Our goal is to perform
valid (frequentist) statistical inference about the true mean µ of Y using a sample
mean ¯Y = 1
i=1 Yi of dependent observations Y = (Y1, ...,Yn), where the depen-
dence among observations is determined or informed by network structure. But for

n ∑n

Challenges to estimating contagion effects from observational data

7

the dependence, this is a familiar problem. In general, when we want to use a sample
mean to perform inference about a true mean, we take the sample mean as our point
estimate, calculate a standard error for the sample mean, and tack on a conﬁdence
interval based on that standard error. The unique challenge for the social network
setting is the effect of dependence on the standard error. To keep things as simple
as possible, let’s assume that Yi, ...,Yn are identically, though not independently, dis-
tributed, so the mean of Yi is µ and the variance of Yi is σ 2, which we assume is
ﬁnite, for all i. (In fact, it is easier to deal with observations that are not identically
distributed than it is to deal with observations that are dependent, so relaxing this
assumption is not too difﬁcult.)

Recall that the standard error of ¯Y is the square-root of its variance, where

Var( ¯Y ) =

1
n2 Var

(cid:33)

(cid:32) n
∑
i=1

Yi

=

1
n2

σ 2 + ∑

i(cid:54)= j

(cid:41)

cov(Yi,Yj)

+

1
n2 ∑

i(cid:54)= j

cov(Yi,Yj).

(cid:40) n
∑
i=1
σ 2
n

=

When Yi, ...,Yn are independent, the covariance term cov(Yi,Yj) is equal to 0 for
all i (cid:54)= j pairs, so the variance of ¯Y is σ 2
n , which should be familiar from any in-
troductory statistics or data analysis class. But when Yi, ...,Yn are dependent, in
particular when they are positively correlated (which is the type of dependence
that we would expect to see in just about every social network setting), the vari-
ance of ¯Y is bigger than σ 2
n because it includes the term 1
n2 ∑i(cid:54)= j cov(Yi,Yj). Deﬁne
bn = 1
n ∑i(cid:54)= j cov(Yi,Yj). Then

var( ¯Y ) =

σ 2
(cid:16)
1+ bn
σ 2

(cid:17)

n/

(cid:17)

(cid:17)

. We call n/

(cid:16)
1 + bn
σ 2

and we can see that the factor by which the variance of ¯Y is bigger than what it
(cid:16)
1 + bn
would be if Yi, ...,Yn were independent is
the effec-
σ 2
tive sample size of our sample of n dependent observations Y1, ...,Yn. The effective
is smaller than the true sample size n; heuristically this
sample size n/
is because each observation Yi contains some new information about the target of
inference µ and some information that is rendered redundant by dependence. Under
independence each observation furnishes 1 “bit” of information about µ, whereas
under dependence each observation furnishes only 1/
bit of information
about µ.

(cid:16)
1 + bn
σ 2

(cid:16)
1 + bn
σ 2

(cid:17)

(cid:17)

In order to explain the impact of this dependence on statistical inference, we
ﬁrst review the standard inferential procedure for independent data. When Yi, ...,Yn
are independent, a typical procedure would be to calculate an approximate 95%

8

Elizabeth L. Ogburn

conﬁdence interval for µ as ¯Y ± 1.96 × ˆσ√
n , where ˆσ is the square root of an estimate
of the variance of Y . The factor 1.96 is the 97.5th quantile of the standard Normal
distribution; t-distribution quantiles could be used instead to account for the fact that
σ is estimated rather than known. This procedure relies on several preliminaries: (1)
ˆσ√
¯Y is unbiased for µ, (2) ¯Y is approximately Normally distributed, and (3)
n is a
good estimate of the variance of ¯Y . These preliminaries hold, at least approximately,
in most settings with independent data and moderate to large n. Dependence doesn’t
affect (1), but it does affect (2) and (3).

√
√

n ( ¯Y − µ) is not 0, in which case

When Yi, ...,Yn are independent, the Central Limit Theorem (CLT) tells us that
n ( ¯Y − µ) converges in distribution to a Normal distribution as n → ∞. The factor
n is called the rate of convergence and it is needed to make sure that the variance
√
√
n ( ¯Y − µ) would converge to a constant
of
√
n ( ¯Y − µ) would not
rather than a distribution, and is not inﬁnite, in which case
converge at all. The variance of ¯Y (equivalently, the variance of ¯Y − µ) is σ 2/n, so
n ( ¯Y − µ) is n × (cid:0)σ 2/n(cid:1) = σ 2, which is a positive, ﬁnite constant.
the variance of
When Yi, ...,Yn are dependent, the rate of convergence may be different (slower)
n. (In fact, if the dependence is strong and widespread enough, the CLT may
than
not hold at all; determining what types of social network dependence are consistent
with the CLT is an important area for future study.) This is because the rate of
convergence is determined by the effective sample size instead of by n: the variance

√

√

of ¯Y is σ 2/

(cid:110)

n/

(cid:16)
1 + bn
σ 2

(cid:17)(cid:111)

, so (as long as a CLT holds),

n/

(cid:17)

(cid:16)
1 + bn
σ 2

( ¯Y − µ) will

(cid:114)

converge to a Normal distribution as n → ∞ and the rate of convergence is given by
(cid:114)

rather than

n. Sometimes, in particular when bn is ﬁxed as n → ∞,

√

n/

(cid:17)

(cid:16)
1 + bn
σ 2

this distinction will be meaningless. But sometimes, when bn grows with n, it is
a meaningfully slower rate of convergence. (Note that bn/n must converge to 0 as
n → ∞ in order for a CLT to hold, so bn must grow slower than n.) This matters
because it informs when the approximate Normality of the CLT kicks in, i.e. at what
sample size it is safe to assume that ¯Y is approximately Normally distributed. Many
different rules of thumb exist for determining when approximate Normality holds;
one popular rule of thumb is that n = 30 sufﬁces. With dependent data, this number
is larger, and sometimes considerably so. The effective sample size, rather than n,
should be used to assess whether the sample size is large enough to approximate the
distribution of ¯Y with a Normal distribution. When researchers ignore dependence
and rely on the Normal approximation in samples that have large enough n but
not large enough effective sample size, there is no reason to think that their 95%
conﬁdence intervals will have good coverage properties.

Ignoring dependence is most dangerous when estimating the standard error of
¯Y . Any estimate of var( ¯Y ) that is based only on the marginal variances σ 2 of Yi
and ignore the covariances cov(Yi,Yj) will underestimate the standard error of ¯Y ,
often severely. Inference that is based on an underestimated standard error is an-
ticonservative: conﬁdence intervals are narrower than they should be and p-values
are lower than they should be, leading researchers to draw conclusions that are not
in fact substantiated by the data. Even if each observation is dependent only on a

Challenges to estimating contagion effects from observational data

9

ﬁxed and ﬁnite number of other observations, so that dependence is asymptotically
negligible and does not affect the rate of convergence of the CLT, in ﬁnite samples
ignoring the covariance terms in var( ¯Y ) could still have substantial implications on
inference. This is particularly a problem because no good solutions exist. Statis-
ticians are good at dealing with dependence that arises due to space or time, or
even other more complicated processes that can be expressed using Euclidean ge-
ometry. But dependence that is informed by a network is very different from these
well-understood types of dependence, and, unfortunately, statisticians are only just
beginning to develop methods for taking it into account. Most published research
about social contagion uses regression models or generalized estimating equations
(GEEs) to estimate contagion effects; though some of these models account for the
dependence due to observing the same nodes over multiple time points, none of
them account for dependence among nodes.

5.1 Sources of network dependence

In the literature on spatial and temporal dependence, dependence is often implicitly
assumed to be the result of latent traits that are more similar for observations that are
close in Euclidean distance than for distant observations. This type of dependence
is likely to be present in many network contexts as well. In networks, edges present
opportunities to transmit traits or information, and contagion or inﬂuence is an im-
portant additional source of dependence that depends on the underlying network
structure.

Latent trait dependence will be present in data sampled from a network whenever
observations from nodes that are close to one another are more likely to share un-
measured traits than are observations from distant nodes. Homophily is a paradig-
matic example of latent trait dependence. If the outcome under study in a social
network has a genetic component, then we would expect latent variable dependence
due the fact that family members, who share latent genetic traits, are more likely
to be close in social distance than people who are unrelated. If the outcome were
affected by geography or physical environment, latent variable dependence could
arise because people who live close to one another are more likely to be friends than
those who are geographically distant. Of course, whether these traits are latent or
observed they can create dependence, but if they are observed then conditioning on
them renders observations independent, so only when they are latent do they result
in dependence that requires new tools for statistical inference. Just like in the spa-
tial dependence context, there is often little reason to think that we could identify,
let alone measure, all of these sources of dependence. The notions of latent sources
of homophily or latent correlates of shared environment are familiar from the dis-
cussion of confounding, above, but there is an important distinction to be made
between latent sources of confounding and latent sources of dependence: in order to
be a source of unmeasured confounding, a latent trait must affect both the exposure
(e.g. the alter’s outcome at time t − 1) and the outcome (ego’s outcome at time t)

10

Elizabeth L. Ogburn

of interest. In order to be a source of dependence, a latent trait must affect two or
more outcomes of interest. Latent trait dependence is the most general form of de-
pendence, in that it provides no structure that can be harnessed to propel inference.
In order to make any progress towards valid inference in the presence of latent trait
dependence, some structure must be assumed, namely that the range of inﬂuence of
the latent traits is primarily local in the network and that any long-range effects are
negligible.

Contagion or inﬂuence arises when the outcome under study is transmitted from
node to node along edges in the network. The diagram in Figure 1 depicts contagion
in a network with three nodes in which node 2 is connected to nodes 1 and 3 but there
is no edge between 1 and 3. Y t
i represents the outcome for node i at time t, and the
unit of time is small enough that at most one transmission event can occur between
consecutive time points. Dependence due to contagion has known, though possibly
unobserved, structures that can sometimes be harnessed to facilitate inference; we
touch on this brieﬂy in Section 6. Crucially, whenever contagion is present so is
dependence, and therefore statistical analysis must take dependence into account in
order to result in valid inference.

Fig. 1 Dependence by contagion

6 Solutions

Researchers have known for decades that learning about contagion from observa-
tional data is fraught with difﬁculty, perhaps most famously expressed by Manski
(1993). Recent years have seen incremental methodological progress, but huge hur-
dles remain. Most of the constructive ideas in Shalizi and Thomas (2011) involve
bounding contagion effects rather than attempting to point identify them; looking
for bounds rather than point estimates is a general approach that could prove fruit-
ful in the future. Indeed, Ver Steeg and Galstyan (2010) built upon the ideas in

Challenges to estimating contagion effects from observational data

11

Shalizi and Thomas (2011) and were able to derive bounds on the association due
to homophily on traits that do not change over time (“static homophily”). Another
general approach is to make use of sensitivity analyses whenever an estimation pro-
cedure relies on assumptions that may not be realistic (e.g. VanderWeele, 2011).
Some of the problems discussed above have solutions in some settings; below we
discuss solutions that exploit features of speciﬁc settings rather than providing gen-
eral approaches to the problem of estimating contagion effects. (Some of the mate-
rial below was ﬁrst published in Ogburn and Volfovsky, 2016.)

6.1 Randomization

If it is possible to randomize some members of a social network to receive an inter-
vention, and if it is known that an alter’s receiving an intervention can only affect
the ego’s outcome through contagion (as opposed to directly; see Ogburn and Van-
derWeele 2014a for discussion), then problems of confounding and dependence can
be entirely obviated. Randomization-based inference, pioneered by Fisher (Fisher,
1922) and applied to network-like settings by Rosenbaum (2007) and Bowers et al
(2013), is founded on the very intuitive notion that, under the null hypothesis of no
effect of treatment on any subject (sometimes called the sharp null hypothesis to dis-
tinguish it from other null hypotheses that may be of interest), the treated and control
groups are random samples from the same underlying distribution. Randomization-
based inference treats outcomes as ﬁxed and treatment assignments as random vari-
ables: quantities that depend on the vector of treatment assignments are the only
random variables in this paradigm. Therefore, dependence among outcomes is a
non-issue. Typically this type of inference is reserved for hypothesis testing, though
researchers have extended it to estimation. We leave the details, including several
subtleties and challenges that are speciﬁc to the social network context, to a later
chapter (see also Ogburn and Volfovsky, 2016 for a review).

Randomizing the formation of network ties themselves obviates confounding due
to the effects of homophily on tie formation. A number of studies have taken ad-
vantage of naturally occurring randomizations of this kind, such as the assignment
of students to dorm rooms (Sacerdote, 2000) or of children to classrooms (Kang,
2007). However, this does not sufﬁce to control for the effects of homophily on tie
strength or duration, or to control for confounding due to shared environment.

6.2 Parametric models

If researchers are willing to commit to certain types of parametric models, it may be
possible isolate contagion from confounding (Snijders et al, 2007). It is a reliance
on strong parametric models, for example, that underpins mathematical modeling

12

Elizabeth L. Ogburn

or agent based modeling approaches to contagion (Burk et al, 2007; Snijders et al,
2010; Railsback and Grimm, 2011).

This might seem benign–after all, most statistical analyses rely on parametric
models of one kind or another–but there is a fundamental difference between, for
example, using a linear regression when the true underlying relationships is not
linear, and relying on parametric models to identify a causal effect that is otherwise
hopelessly confounded. In the ﬁrst case, a misspeciﬁed model may bias the estimate
we are interested in, often in ways that are well-understood, and often in proportion
to the ﬁt of the model to the data (i.e. the worse the misspeciﬁcation, the greater the
bias). In the latter case, at least in the absence of a model-speciﬁc proof otherwise,
any hint of misspeciﬁcation undermines the causal interpretation we would like to be
able to justify and what looks like evidence of a causal effect could just be evidence
of confounding. George Box’s oft-cited aphorism, “all models are wrong but some
are useful,” justiﬁes the use of misspeciﬁed parametric models in many settings, but
when the parametric form of the model is the only bulwark against confounding, the
model must (in the absence of a proof to the contrary) in fact be correct in order to
be useful.

6.3 Instrumental variable methods

O’Malley et al (2014) proposed an instrumental variable (IV) solution to the prob-
lem of disentangling contagion from homophily. An instrument is a random vari-
able, V , that affects exposure but has no effect on the outcome conditional on expo-
sure. When the exposure - outcome relation suffers from unmeasured confounding
but an instrument can be found that is not confounded with the outcome, IV meth-
ods can be used to recover valid estimates of the causal effect of the exposure on the
outcome. In this case there is unmeasured confounding of the relation between an
alter’s outcome at time t − 1 and an ego’s outcome at time t whenever there is ho-
mophily on unmeasured traits. Angrist and Pischke (2008), Greenland (2000), and
Pearl (2000) provide accessible reviews of IV methods.

O’Malley et al (2014) propose using a gene that is known to be associated with
the outcome of interest as an instrument. In their paper they focus on perhaps the
most highly publicized claim of peer effects, namely that there are signiﬁcant peer
effects of body mass index (BMI) and obesity (Christakis and Fowler, 2007). If there
is a gene that affects BMI but that does not affect other homophilous traits, then that
gene is a valid instrument for the effect of an alter’s BMI on his ego’s BMI. The gene
affects the ego’s BMI only through the alter’s manifest BMI (and it is independent
of the ego’s BMI conditional on the alter’s BMI), and there is unlikely to be any
confounding, measured or unmeasured, of the relation between an alter’s gene and
the ego’s BMI.

There are two important challenges to this approach. First, the power to detect
peer effects is dependent in part upon the strength of the instrument - exposure
relation which, for genetic instruments, is often weak. Indeed, O’Malley et al (2014)

Challenges to estimating contagion effects from observational data

13

reported low power for their data analyses. Second, in order to assess contagion at
more than a single time point (i.e. the average effect of the alter’s outcomes on the
ego’s outcomes up to that time point), multiple instruments are required. O’Malley
et al (2014) suggest using a single gene interacted with age to capture time-varying
gene expression, but this could further attenuate the instrument - exposure relation
and this method is not valid unless the effect of the gene on the outcome really does
vary with time; if the gene-by-age interactions are highly collinear then they will
fail to act as differentiated instruments for different time points.

6.4 Data from multiple independent networks

When multiple independent networks are observed, the problems of confounding
due to shared environment and of dependence may be considerably easier to deal
with. A large literature on interference in causal inference is dedicated to inference
in the setting where independent groups of individuals interact and affect one an-
other within, but not between, groups; this is analogous to multiple independent
social networks (see, e.g., Sobel, 2006; Hong and Raudenbush, 2006; Hudgens
and Halloran, 2008; Tchetgen Tchetgen and VanderWeele, 2012; Liu and Hudgens,
2014). If environmental factors can shared within but not across networks, it may
be possible to control for confounding by shared environment via a ﬁxed effect for
each network, as in Cohen-Cole and Fletcher (2008).

6.5 Contagion operating alone

If researchers have reason to believe that there is no unmeasured homophily or fea-
tures of shared environments that contribute to confounding or to dependence, i.e. if
contagion is the only mechanism giving rise to either dependence or to associations
among the outcomes of interest, then there are a few recent methodological advances
that can be used to estimate contagion effects (van der Laan, 2012; Ogburn and Van-
derWeele, 2014b; Ogburn et al, 2017). Dependence due to contagion has known,
though possibly unobserved, structures that can sometimes be harnessed to facil-
itate inference. Time and distance act as information barriers for dependence due
to contagion, giving rise to many conditional independencies that can sometimes
be used to make network dependence tractable. Two examples of the many condi-
tional independencies that hold in Figure (1) are (cid:2)Y t
(cid:3)
, Y t−1
1 ⊥ Y t
2
and (cid:2)Y t−1
(cid:3). The ﬁrst conditional independence statement illustrates the
principle that outcomes measured at a particular time point are mutually indepen-
dent conditional on all past outcomes. The second conditional independence state-
ment illustrates the fact that outcomes sampled from two nonadjacent nodes are
independent if the amount of time that passed between the two measurements was
not sufﬁciently long for information to travel along the shortest path from one node

1 ⊥ Y t

2 | Y t−2
1

3 | Y t−2
2

, Y t−2
2

, Y t−1
1

14

Elizabeth L. Ogburn

to the other, conditional any information that could have simultaneously inﬂuenced
the sampled nodes (in this case Y t−2
). Observing outcomes in a network on a ﬁne
enough time scale to observe all transmissions requires a richness of data that will
not usually be available, and if the network under a contagious process is observed
at a single time point, dependence due to contagion is indistinguishable from latent
variable dependence and the structure is lost.

2

Acknowledgements This work was funded by the Ofﬁce of Naval Research grant N00014-15-1-
2343.

References

Ali MM, Dwyer DS (2009) Estimating peer effects in adolescent smoking behavior:

A longitudinal analysis. Journal of Adolescent Health 45(4):402–408

Angrist JD, Pischke JS (2008) Mostly harmless econometrics: An empiricist’s com-

panion. Princeton university press

Aral S, Muchnik L, Sundararajan A (2009) Distinguishing inﬂuence-based conta-
gion from homophily-driven diffusion in dynamic networks. Proceedings of the
National Academy of Sciences 106(51):21,544–21,549

Aronow PM, Samii C (2012) Estimating average causal effects under general inter-

ference. Tech. rep.

Besag J (1974) On spatial-temporal models and markov ﬁelds. In: Transactions of
the Seventh Prague Conference on Information Theory, Statistical Decision Func-
tions, and Random Processes, Springer, pp 47–55

Bowers J, Fredrickson MM, Panagopoulos C (2013) Reasoning about interference

between units: A general framework. Political Analysis 21(1):97–124

Burk WJ, Steglich CE, Snijders TA (2007) Beyond dyadic interdependence: Actor-
oriented models for co-evolving social networks and individual behaviors. Inter-
national journal of behavioral development 31(4):397–404

Cacioppo JT, Fowler JH, Christakis NA (2009) Alone in the crowd: the structure and
spread of loneliness in a large social network. Journal of personality and social
psychology 97(6):977

Christakis N, Fowler J (2007) The spread of obesity in a large social network over

32 years. New England journal of medicine 357(4):370–379

Christakis N, Fowler J (2008) The collective dynamics of smoking in a large social

network. New England journal of medicine 358(21):2249–2258

Christakis N, Fowler J (2010) Social network sensors for early detection of conta-

gious outbreaks. PloS one 5(9):e12,948

Cohen-Cole E, Fletcher JM (2008) Is obesity contagious? social networks vs.
environmental factors in the obesity epidemic. Journal of Health Economics
27(5):1382–1387

Elwert F, Winship C (2014) Endogenous selection bias: The problem of condition-

ing on a collider variable. Annual Review of Sociology 40:31–53

Challenges to estimating contagion effects from observational data

15

Fisher RA (1922) On the mathematical foundations of theoretical statistics. Philo-
sophical Transactions of the Royal Society of London Series A, Containing Pa-
pers of a Mathematical or Physical Character 222:309–368

Goetzke F (2008) Network effects in public transit use: evidence from a spatially
autoregressive mode choice model for new york. Urban Studies 45(2):407–417
Greenland S (2000) An introduction to instrumental variables for epidemiologists.

International journal of epidemiology 29(4):722–729

Halloran M, Hudgens M (2011) Causal inference for vaccine effects on infectious-
ness. The University of North Carolina at Chapel Hill Department of Biostatistics
Technical Report Series p 20

Halloran ME, Struchiner CJ (1995) Causal inference in infectious diseases. Epi-

demiology 6(2):142–151

Hern´an MA (2004) A deﬁnition of causal effect for epidemiological research. Jour-

nal of Epidemiology and Community Health 58(4):265–271

Hong G, Raudenbush S (2006) Evaluating kindergarten retention policy. Journal of

the American Statistical Association 101(475):901–910

Hudgens M, Halloran M (2008) Toward causal inference with interference. Journal

of the American Statistical Association 103(482):832–842

Kang C (2007) Classroom peer effects and academic achievement: Quasi-
randomization evidence from south korea. Journal of Urban Economics
61(3):458–495

van der Laan MJ (2012) Causal inference for networks. UC Berkeley Division of

Biostatistics Working Paper Series Working Paper 300

Lauritzen SL, Richardson TS (2002) Chain graph models and their causal interpreta-
tions. Journal of the Royal Statistical Society: Series B (Statistical Methodology)
64(3):321–348

Lazer D, Rubineau B, Chetkovich C, Katz N, Neblo M (2010) The coevolution of

networks and political attitudes. Political Communication 27(3):248–274

Lee LF (2004) Asymptotic distributions of quasi-maximum likelihood estimators

for spatial autoregressive models. Econometrica 72(6):1899–1925

Lin X (2005) Peer effects and student academic achievement: an application of
spatial autoregressive model with group unobservables. Unpublished manuscript,
Ohio State University

Liu L, Hudgens MG (2014) Large sample randomization inference of causal ef-
fects in the presence of interference. Journal of the american statistical association
109(505):288–301

Lyons R (2011) The spread of evidence-poor medicine via ﬂawed social-network

analysis. Statistics, Politics, and Policy 2(1)

Manski CF (1993) Identiﬁcation of endogenous social effects: The reﬂection prob-

lem. The review of economic studies 60(3):531–542

Noel H, Nyhan B (2011) The unfriending problem: The consequences of homophily
in friendship retention for causal estimates of social inﬂuence. Social Networks
33(3):211–218

Ogburn EL, VanderWeele TJ (2014a) Causal diagrams for interference. Statistical

Science

16

Elizabeth L. Ogburn

Ogburn EL, VanderWeele TJ (2014b) Vaccines, contagion, and social networks.

arXiv preprint arXiv:14031241

Ogburn EL, Volfovsky A (2016) Networks. In: P B, P D, M K, van der Laan MJ

(eds) Handbook of Big Data, Chapman & Hall/CRC

Ogburn EL, O S, van der Laan MJ, I D (2017) Causal inference for social network

data with contagion. Tech. rep., Johns Hopkins University

O’Malley AJ, Elwert F, Rosenquist JN, Zaslavsky AM, Christakis NA (2014) Esti-
mating peer effects in longitudinal dyadic data using instrumental variables. Bio-
metrics

O’Malley JA, Marsden PV (2008) The analysis of social networks. Health services

and outcomes research methodology 8(4):222–269

Pearl J (2000) Causality: models, reasoning and inference. Cambridge Univ Press
Railsback SF, Grimm V (2011) Agent-based and individual-based modeling: a prac-

tical introduction. Princeton university press

Rosenbaum P (2007) Interference between units in randomized experiments. Jour-

nal of the American Statistical Association 102(477):191–200

Rosenquist JN, Murabito J, Fowler JH, Christakis NA (2010) The spread of alco-
hol consumption behavior in a large social network. Annals of Internal Medicine
152(7):426–433

Rubin D (1990) On the application of probability theory to agricultural experiments.
essay on principles. section 9. comment: Neyman (1923) and causal inference in
experiments and observational studies. Statistical Science 5(4):472–480

Rubin DB (2005) Causal inference using potential outcomes: Design, modeling,
decisions. Journal of the American Statistical Association 100(469):322–331
Sacerdote B (2000) Peer effects with random assignment: Results for dartmouth

roommates. Tech. rep., National Bureau of Economic Research

Shalizi CR (2012) Comment on ”why and when ’ﬂawed’ social network analyses

still yield valid tests of no contagion”. Statistics, Politics, and Policy 3(1)

Shalizi CR, Thomas AC (2011) Homophily and contagion are generically con-
founded in observational social network studies. Sociological Methods & Re-
search 40(2):211–239

Snijders T, Steglich C, Schweinberger M (2007) Modeling the coevolution of net-

works and behavior. na

Snijders TA, Van de Bunt GG, Steglich CE (2010) Introduction to stochastic actor-

based models for network dynamics. Social networks 32(1):44–60

Sobel M (2006) What do randomized studies of housing mobility demonstrate?

Journal of the American Statistical Association 101(476):1398–1407

Tchetgen Tchetgen EJ, VanderWeele T (2012) On causal inference in the presence

of interference. Statistical Methods in Medical Research 21(1):55–75

Thomas A (2013) The social contagion hypothesis: comment on ‘social contagion
theory: examining dynamic social networks and human behavior’. Statistical in
Medicine 32(4):581–590

VanderWeele TJ (2011) Sensitivity analysis for contagion effects in social networks.

Sociological Methods & Research 40(2):240–255

Challenges to estimating contagion effects from observational data

17

VanderWeele TJ, Ogburn EL, Tchetgen EJT (2012) Statistics, politics, and policy.

Politics, and Policy 3(1):4

Ver Steeg G, Galstyan A (2010) Ruling out latent homophily in social networks.

NIPSWorkshop on Social Computing

