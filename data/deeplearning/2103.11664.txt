OnionNet-2:AConvolutionalNeuralNetworkModelforPredictingProtein-LigandBindingAﬃnitybasedonResidue-AtomContactingShellsZechenWang,∗LiangzhenZheng,†YangLiu,∗YuanyuanQu,∗Yong-QiangLi,∗MingwenZhao,∗YuguangMu,‡andWeifengLi§Onekeytaskinvirtualscreeningistoaccuratelypredictthebindingaﬃnity(4G)ofprotein-ligandcomplexes.Recently,deeplearning(DL)hassigniﬁcantlyincreasedthepredictingaccuracyofscoringfunctionsduetotheextraordinaryabilityofDLtoextractusefulfeaturesfromrawdata.Nevertheless,moreeﬀortsstillneedtobepaidinmanyaspects,fortheaimofincreasingpredictionaccuracyanddecreasingcomputationalcost.Inthisstudy,weproposedasimplescoringfunction(calledOnionNet-2)basedonconvolutionalneuralnetworktopredict4G.Theprotein-ligandinteractionsarecharacterizedbythenumberofcontactsbetweenproteinresiduesandligandatomsinmultipledistanceshells.Comparedtopublishedmodels,theeﬃcacyofOnionNet-2isdemonstratedtobethebestfortwowidelyuseddatasetsCASF-2016andCASF-2013benchmarks.TheOnionNet-2modelwasfurtherveriﬁedbynon-experimentaldecoystructuresfromdockingprogramandtheCSARNRC-HiQdataset(ahigh-qualitydatasetprovidedbyCSAR),whichshowedgreatsuccess.Thus,ourstudyprovidesasimplebuteﬃcientscoringfunctionforpredictingprotein-ligandbindingfreeenergy.INTRODUCTIONProtein-ligandbindingisthebasicofalmostallpro-cessesinlivingorganisms[1]thuspredictingbindingaﬃnity(4G)ofprotein-ligandcomplexbecomesthere-searchfocusofbioinformaticsanddrugdesign.[2–4]Theoretically,moleculardynamics(MD)simulationsandfreeenergycalculations(forinstance,thermalintegra-tionmethodandfreeenergyperturbationcanprovideaccuratepredictionsof4Grelyingonextensiveconﬁgu-rationalsamplingandcalculation,leadingtoalargede-mandincomputationalcost.[4–7]Therefore,developingsimple,accurateandeﬃcientscoringmethodstopre-dictprotein-ligandbindingwillgreatlyacceleratethedrugdesignprocess.[8]Toachievethis,severaltheoreticalmethods(scoringfunctions)havebeenproposed.Typi-cally,thescoringfunctionsarebasedoncalculationsofinteractionsbetweenproteinandligandatoms.[1,8–10]Thisincludesquantummechanicscalculations,moleculardynamicssimulations(electrostaticinteraction,vanderWaalsinteraction,hydrogen-bondandetc.),empirical-basedinteractingmodels.[1,9–11]Inrecentyears,approachesbasedonmachinelearning(ML)havebeenappliedinscoringfunctionsanddemon-stratedgreatsuccess.[12–15]Forinstance,RF-Score[16]andNNScorearetwopioneeringML-basedscoringfunctions.[17]Comparedwithclassicalapproaches,theseML-basedmethodsallowhigherﬂexibilityinselectingconﬁgurationalrepresentationsorfeaturesforproteinandligand.Moreimportantly,thesemethodshavebeendemonstratedtoperformbetterandmoreeﬀec-tivethanclassicalapproaches.[18,19]Recently,thedeeplearning(DL)approacheshaveprovidedalternativeso-lution.ComparedwithML,theDLmodelsperformbet-teratlearningfeaturesfromtherawdatatoextracttherelationshipbetweenthesefeaturesandlabels.[20–22]Thus,DLalgorithmshavebeenintroducedtomodelthestructure-activityrelationships.[23–25]OneofthemostpopularmethodsofDListheconvolutionalneuralnet-work(CNN),whichisamulti-layerperceptroninspiredbytheneuralnetworkoflivingorganisms.[26]InspiredbythegreatsuccessofDLandCNNtech-niques,severalmodelsapplyingCNNtovirtualscreeningand4Gpredictionhavebeenreported.[27–35]Forexam-ple,¨Ozt¨urkandco-workersreportedaDeepDTAmodelbasedonone-dimensional(1D)convolution,whichtookproteinsequencesandsimpliﬁedmolecularinputlineen-tryspeciﬁcation(SMILES)codesofligandasinputstopredictdrug-target4G.[30]Using3DCNNmodel,twoindependentgroupsdevelopedscoringfunctions,namedPafnucy[31]andKdeep[29],tomodelthecomplexinacubicboxcenteredonthegeometriccenterofthelig-andtopredictthe4Gofprotein-ligandcomplex.Moreinterestingly,Russetal.employedGraph-CNNstoau-tomaticallyextractfeaturesfromproteinpocketand2Dligandgraphs,anddemonstratedthattheGraph-CNNframeworkcanachievesuperiorperformancewithoutre-lyingonprotein-ligandcomplexes.[34]Ourgrouphaspro-poseda2Dconvolution-basedpredictor,calledOnion-Net,basedonelement-pair-speciﬁccontactsbetweenlig-andsandproteinatoms.[32]Asisshown,theseDLandCNNbasedapproaches,achievedhigheraccuracyin4Gpredictionthanmosttraditionalscoringfunctions,suchasAutoDock,[36,37]X-Score[38]andKScore.[39]ForDLscoringfunctions,howtotreatwiththehigh-dimensionalstructuralinformationencodedinthe3Dstructuresandconverttothelow-dimensionalfeaturesforML(orDL)trainingiscritical.Formoststructure-basedML/DLmodels,thefeaturesareusuallyderivedfromtheatomicinformationofproteinsandligands,suchastheelementtypeandspatialcoordinatesoftheatomandevenotheratomicproperties.[29,31]Wenoticedthatsameelementsindiﬀerentresidueshavequitediﬀerentphysicalandchemicalproperties,arXiv:2103.11664v1  [q-bio.QM]  22 Mar 20212whichmightgreatlyaﬀectthepredictingperformanceofscoringfunctions.Consideringthatthetwentytypesofaminoacidscanbetreatedasintrinsicclassiﬁcationsofproteincompoundswhichinvolvelayfeaturesofthem,likepolar,apolar,aromaticandetc.WeanticipatethatitmaybemorebeneﬁcialtoencodeproteinasresiduesinsteadofatomsindevelopingDLscoringfunctions.Inthiswork,weproposedasimpleOnionNet-2–a2DCNNbasedregressionmodel,whichadoptstherotation-freeresidue-atom-speciﬁccontactsinmultipledistanceshellstodescribetheprotein(residues)-ligand(atoms)interactions.Wedemonstratedthat,ourpresentmethodcansigniﬁcantlyimprovethepredictionpowerbyabout3.7%thanpreviousmodels,thusprovidinganeﬃcientandaccurateapproachforpredictingprotein-ligandin-teractionsanduncoveranewtrendofusingDLtechniqueformassivebiologicalstructurestrainingfordrugdesign.METHODSDescriptorsThefeaturesemployedarethepairnumbersofthespeciﬁcresidue(protein)-atom(ligand)combinationinmultipledistanceshells.Theminimumdistancesbe-tweenanyatomintheligandandanyresidueofpro-teinaretreatedastherepresentativedistances.First,aroundeachatomintheligand,wedeﬁnedNcontin-uouslypackedshells.Thethicknessofeachshellisδ,exceptthattheﬁrstshellisaspherewitharadiusofd0.TheboundaryKioftheithshellisasfollows0<Ki<d0,i=1d0+(i-2)δ≤Ki<d0+(i-1)δ,i≥2Meanwhile,weclassiﬁedatomsintheligandintoeighttypes,namelyC,H,O,N,P,S,HALandDU,whereHALrepresentsthehalogenelements(F,Cl,BrandI),andDUrepresentstheelementtypesexcludedintheseseventypes.Te∈{C,H,O,N,P,S,HAL,DU}Whenpre-processingthestructureﬁle,waterandionsweretreatedexplicitlybecausecrystalwatermoleculesandionscouldaﬀecttheprotein-ligandbinding.[40,41]Inadditiontothetwentystandardresidues,weaddedanexpandedtypenamed“OTH”torepresentwater,ionsandanyothernon-standardresidues.Tr∈{GLY,ALA,VAL,LEU,ILE,PRO,PHE,TYR,TRP,SER,THR,CYS,MET,ASN,GLN,ASP,GLU,LYS,ARG,HIS,OTH}Itisworthmentionthattheresidue-atomdistanceisdeﬁnedasthedistancebetweentheatomintheligandandthenearestheavyatomintheresidue.A2DvisualFIG.1.WorkﬂowofOnionNet-2.representationisdepictedattheupperleftofFig.1.Foranyshell,thenumberofcontactsforeachresidue-atompairiscalculatedandusedasafeature.Eachshellhas8×21=168residue-atomcombinations,whichmeansthatthereare168featuresforashell.Thus,ifthetotalnumberofshellsisN,168×Nfeatureswillbegenerated.nTr,Te=RXr=1EXe=1cir,e(1)cir,e=(1,(i−2)δ+d0≤dr,e<(i−1)δ+d00,otherwise(2)Here,Risthetotalnumberofresiduesintheprotein,andEisthetotalnumberofatomsintheligand.Thedr,eistheminimumdistancebetweentheresiduerintheproteinandtheatomeintheligand,andniTr,Teisthenumberofcontactsofthespeciﬁcresidue-elementcombi-nationintheithshell.Thecir,eis1when(i−2)δ+d0≤dr,e<(i−1)δ+d0,otherwisecir,eis0.Followingourpre-viousstudy,[32]weusedd0=1˚Aandδ=0.5˚A.Interest-inglysuchshell-like,orradial,representationsofproteinenvironments,havebeendemonstratedtobesuperiorfeaturesinproteinfunctionprediction.[35]Theprepara-tionofdatasetsandtheCNNarchitecture[42,43]canbefoundinSI.ThesourcecodeofOnionNet-2isavailableathttps://github.com/zchwang/OnionNet-2/.EvaluationmetricsToevaluatetheperformanceoftheOnionNet-2,weadoptedthelossfunctiondeﬁnedinthepreviouswork.[32]loss=α(1−R)+(1−α)RMSE(3)R=Pni(xi−¯x)(yi−¯y)qPni(xi−¯x)2pPni(yi−¯y)2(4)3whereRandRMSErepresentPearsoncorrelationcoef-ﬁcient(Eq.3)androot-mean-squarederror,respectively;xiisthepredictedpKaforithcomplex;yiistheexper-imentalpKaofthiscomplex;¯xand¯yaretheaveragesofallpredictedvaluesandexperimentalvalues.[44]Theα(0≤α≤1)valueisanadjustablefactorforadjust-ingtheweightwithRandRMSE,whichwasﬁnallysetto0.7.Foreachindependenttrainingtask,weadoptedearlystopping(patience=20,thatis,ifthechangeofthelossvalueinthevalidatingsetislessthan0.001af-ter20epochs,thetrainingisterminated)andsavethemodelthatperformedbestonthevalidatingset.Forthepredictionineachcase,ﬁveindependentlytrainingswereconductedtoobtainthepredictedmeanvalue.RESULTSANDDISCUSSIONSThepredictivepowerofOnionNet-2FIG.2.ThePearsoncorrelationcoeﬃcientwithrespecttotheshellnumberNforOnionNet-2testingwithcoresetv.2016.ThebarsindicatethestandarddeviationsoftheRvaluesforﬁveindependentruns.Firstly,weexploredtheeﬀectofshellnumberNonthepredictivecapabilityoftheOnionNet-2model.Arangeofthetotalshellnumber10≤N≤90wastestedwithintervalof2.Accordingtoourdeﬁnitionsofdis-tanceshell,thiscoversaseparationbetweentheresidueandtheatomfrom0.55nmto4.55nm.Fig.2depictsthetrendoftheRvaluetoshellnumberNtestingwithcoresetv.2016[44].ForNfrom10to20,theRquicklyincreasesasthetotalnumberofshellsincreases.Thisisexpectedbecauseasthenumberofshellsincreases,theinteractionsbetweenligandandproteinweregrad-uallycapturedbythemodel.TheRvaluereachedtheﬁrstpeakforNis30.ThismeansthatOnionNet-2canachievehighpredictionaccuracyatarelativelylowcom-putationalcost.Then,Rﬂuctuatesinarangeof0.01untilreachestheglobalmaximumvaluewhenN=62.FIG.3.OnionNet-2predictedpKawithrespecttoexper-imentaldeterminedpKaon(a)trainingset,(b)validatingset,andtwotestsetsof(c)coresetv.2016and(d)coresetv.2013.Fig.3summarizedthepredictedmeanpKa,withre-specttoexperimentalvalue,usingN=62,onthetrainingset(Fig.3a),validatingset(Fig.3b)andtwotestingsets,coresetv.2016(Fig.3c)andcoresetv.2013[45–47](Fig.3d).ItshowsthatthepredictedpKaandexperi-mentalpKaarehighlycorrelatedforthetwotestingsetsandvalidatingset.Afterthispoint,RdecreaseswhenNincrease.Weattributethistotheenormousdatathatleadstotheintroductionofnoiseinthetraining.Unlessotherwisespeciﬁed,weadoptedNof62inthefollowingdiscussions.Inaddition,wealsore-trainedthemodelwithtwoelderversions(v.2016andv.2018)ofthePDB-binddatabase,andtheRvaluesofourre-trainedmodelsarealmostthesame(Fig.S1andTableS1).Theperformanceofsomepublishedscoringfunctions[48,49]andOnionNet-2testedonCASF-2016andCASF-2013areshowedinFig.4andFig.S2,respectively.ThecorrespondingRandRMSE(orSD)achievedbytheserepresentativescoringfunctionscanbefoundinTableS2inSI.Firstly,ourOnionNet-2modelachievedhighestRof0.864andRMSEof1.164withthecoresetv.2016,andR=0.821andRMSE=1.357withthecoresetv.2013.Theseweresigniﬁcantlyhigherthanotherscoringfunctions.The2ndbestscoringfunctionwasAGL,whichadoptedthegradientboostingtrees(GBTs)algorithm,focusingonmultiscaleweightedla-beledalgebraicsubgraphstocharacterizeprotein-ligandinteractions.[48]Fortwo3Dconvolution-basedscoringfunctionsKdeep[29]andPafnucy[31],theyadopted3D4voxelrepresentationtomodeltheprotein-ligandcomplexandexplicitlytreatedwithphysicalpropertiesofatomssuchashydrophobic,hydrogen-bonddonororacceptorandaromaticetc.intoconsideration.Itisinterestingtoﬁndthatalthoughweonlyemployedtheresidue-atomcontacttomimictheinteractionsbetweentheproteinandtheligandinOnionNet-2,thepredictingpowerishigher.ThisfurtherrevealsthattheselectedfeatureshaveagreatimpactonthepredictivepoweroftheCNN-basedscoringfunctions.Secondly,asisexpected,theintroductionofML/DLtechniquesintomodelshassystematicallyenhancedthepredictingaccuracy.FIG.4.PearsoncorrelationcoeﬃcientofdiﬀerentscoringfunctionsonCASF-2016benchmark.EvaluationofthegeneralizationabilityofthemodelondiﬀerenttestsetsGenerally,DLmodelsdisplayagoodgeneralizationbe-haviorinpracticalapplications.[50]Toverifythegener-alizationabilityoftheOnionNet-2,theCSARNRC-HiQdatasetprovidedbyCSAR[51]wasusedasanadditionaltestsetinthisstudy.Thisdatasetcontainstwosubsetswhichcontain176and167protein-ligandcomplexesre-spectively.ForthetwopreviousMLmodels,KdeepandRF-Score,theresearchersused55and49complexesintwosubsetsrespectivelyastestdata.[29]Toprovideadirectcomparisonwiththem,weadoptedthesamedatafortheOnionNet-2test.ItisworthmentionthatthetwotestsubsetsfromtheCSARNRC-HiQonlyhavetwocommoncomplexeswithcoresetv.2013,namely2jdyand2qmj,anddoesnotoverlapwiththetrainingset,valida-tionsetandcoresetv.2016.TheperformanceofKdeep,RF-ScoreandOnionNet-2onthesetwosubsetsareshowninTableI,andthescatterplotsofthepKapredictedbyOnionNet-2withrespecttoexperimentalpKacanbefoundinFig.S3inSI.Asexpected,ourmodelachievedahigherperformancethanKdeepandRF-score.Forsub-set1,thepresentOnionNet-2achievedRof0.89,whichisconsiderablyhigherthanthatofKdeep(0.72)andRF-Score(0.78).Thisisalsotrueforsubset2.Especiallythat,theRvalueofKdeepmodelisonly0.65forsubset2,indicatingweakpredictingcapabilityonthesedata.TheseresultseﬀectivelydemonstratedthatOnionNet-2hasagoodgeneralizationability.TABLEI.TheperformanceofOnionNet-2,KdeepandRF-ScoreachievedonsubsetsfromCSARNRC-HiQdatasetSubset1Subset2RRMSERRMSEOnionNet-20.891.500.871.21Kdeep[29]0.722.090.651.92RF-Score[29]0.781.990.751.66Evaluationsonsubsetsofnon-experimentaldecoystructuresAsallthetrainingandvalidatingsetsarecomposedofwell-validatednativestructuresinpreviousstudies,itislargelyunknownwhethertheDLmethodiscapa-bletodistinguish“baddata”thatareincorporatedintheseintegrateddatasets,forinstance,non-nativebind-ingposes.Toverifythis,wetestedOnionNet-2todealwithnon-experimentalstructures(generatedbydockingprograms).Technically,non-nativebindingposes(calleddecoys)weregeneratedbasedoncoresetv.2016com-plexesbyAutoDockVina.[52,53]Thedetailedinfor-mationofthegenerationofdecoyscanbefoundintheSI.[54,55]Thepredictingaccuracywasevaluatedbycalculat-ingtheRMSEbetweenthepredictedpKaofthede-coycomplexandthepKaofthecorrespondingnativereceptor-ligandcomplexwhichisshowninFig.5.Itisclearthat,theRMSEquicklyincreasedwithincreas-ingRMSD.ThisisexpectedbecausedecoyswithlargerRMSDresultinmoreseverechangeofδG.Thesere-sultsrevealthatOnionNet-2canaccuratelyrespondtochangesoftheligandbindingposesanddistinguishthenativestructure.Eﬀectsofhydrophobicscale,buriedsolvent-accessibleareaandexcludedvolumeinsidethebindingpocketsonthepredictionaccuracyPrincipally,thephysicalinteractionsbetweenproteinandliganddeterminethe4G.Thedominatingfac-torsforoverall4Ginvolveelectrostaticinteractions,vanderWaalsinteractions,hydrogenbonds,hydration/de-hydrationduringcomplexation.However,suchmecha-nisticinteractionswerenotdirectlyinputintoDLfea-tures.Atmolecularlevel,theseinvolvesthesizeandshapeofthebindingpocket,andthenatureofresiduesaroundthebindingpocketwhichdetermineitsphysico-chemicalcharacteristics.[56]WhetherDLmodelscanac-5TABLEII.PearsoncorrelationcoeﬃcientsachievedbyOnionNet-2andpreviousscoringfunctionsonthreeseriesofsubsetsSubsetHSubsetSSubsetVH1H2H3S1S2S3V1V2V3OnionNet-20.8720.8660.8560.8680.8390.8690.8560.7740.8664VinaRF20*0.8200.8320.8040.8430.7650.8230.7270.7600.818X-Score*0.6980.5700.6610.7430.5360.5720.4370.6220.579X-ScoreHS*0.7110.5650.6470.7480.5570.5460.4330.6300.5594SAS*0.6410.6430.5890.7460.5720.4940.4800.6690.541X-ScoreHP*0.6690.5580.6720.7400.5100.5750.4500.5750.580AutoDockVina*0.6260.5860.6410.7450.5210.5070.4840.5640.486*ResultsofthelastsixrowstakenfromSuetal.[44]FIG.5.RMSEbetweenthepredictedpKaofthedecoycom-plexandthepKaofthecorrespondingnativereceptor-ligandcomplexachievedbyOnionNet-2ondiﬀerentprotein-decoycomplexessubsets.ThebarsindicatethestandarddeviationsofRMSEforﬁveindependentruns.curatelyrepresentthestructuralspeciﬁcityofthebindingpocketispoorlydocumented.TheentireCASF-2016testsetcanbedividedintothreesubsetsbyeachofthreedescriptorsaccordingtophysicalclassiﬁcationsofthebindingpocketonthetar-getprotein.[44]ThethreedescriptorsincludeH-scale(hy-drophobicscaleofthebindingpocket),4SAS(buriedpercentageofthesolvent-accessibleareaoftheligandafterbinding)and4VOL(excludedvolumeinsidethebindingpocketafterligandbinding).Protein-ligandcomplexesinCASF-2016weregroupedinto57clusters,andtheauthorssortedall57clustersinascendingorderbyeachdescriptor.Then,thesecomplexclustersweredividedintothreesubsetsaccordingtothechosende-scriptor,labeledasH1,H2andH3orS1,S2andS3orV1,V2andV3.ThesesubsetswereusedasvalidationsofourOnionNet-2model.Ascomparison,previousscoringfunctionswerealsotestedonthesethreesetsofsubsetsbySuetal.[44],andtheresultsaresummarizedinTableII.AscanbeseeninTableII,OnionNet-2achievedhigherpredictionaccuracycomparedwithothersoringfunctionswhentestedonH-,S-andV-seriessubsets.Thisindi-catesthatthefeaturebasedonthecontactnumberofresidue-atompairsinmultipleshelliscapableofcaptur-ingthehydrophobicscaleofthebindingpocket.Thenumberofcontactsindiﬀerentshells(speciﬁcallytheshellswithinthebindingpocket)maybeabletore-ﬂecttheburiedsolvent-accessiblesurfaceareaandtheexcludedvolumeoftheligand.Wenoticedthat,comparedtoothersubsets,theRvalueofOnionNet-2onV2subsetisclearlylowerthanothersubsets(neverthelessitisstillhighthanotherscor-ingfunctions).Thismayindicatethatourmodelislesssensitivetomedium-sizedbindingpockets.Thusitmaybestillchallengingforcurrentscoringfunctionstorec-ognizethesizeandshapeofthebindingpocket.Furthermore,weplottedthedetailedscatterplotsofpredictedpKaandexperimentalpKainFig.S4accord-ingtothespeciﬁcH,SandVrange.ItisinterestingtoﬁndalmostnodependenceofpKawiththevaluesofH,SorV.Thuswespeculatethatamorerealisticdescrip-torfortheligandcharacteristicinthebindingpocketisessentialtoguidetheprotein-ligand4Gprediction.CONCLUSIONTosummarize,a2Dconvolution-basedCNNmodel,OnionNet-2,isproposedforpredictionoftheprotein-ligandbindingfreeenergy.ThecontactingpairnumbersbetweentheproteinresiduesandtheligandatomswereusedasfeaturesforDLtraining.UsingCASF-2013andCASF-2016asbenchmarks,ourmodelachievedthehigh-estaccuracytopredict4Gthanpreviousscoringfunc-tions.Inaddition,whenemployingdiﬀerentversionsofPDBbinddatabasefortraining,theperformanceofOnionNet-2isnearlythesame.Thegeneralizationabil-ityofthemodelwasveriﬁedbytheCSARNRC-HiQdatasetanddecoystructures.OurresultalsoindicatesthatOnionNet-2hasthecapabilitytorecognizethesephysi-calnatures(indetail,hydrophobicscaleofthebindingpocket,buriedpercentageofthesolvent-accessibleareaoftheliganduponbindingandexcludedvolumeinside6thebindingpocketuponligandbinding)oftheligand-bindingpocketinteractions.ThisworkissupportedbytheNaturalScienceFounda-tionofShandongProvince(ZR2020JQ04),NationalNat-uralScienceFoundationofChina(11874238)andSinga-poreMOETier1GrantRG146/17.∗SchoolofPhysics,ShandongUniversity,Jinan,Shan-dong,China,250100†TencentAILab,Shenzhen,Guangdong,China,518000‡ygmu@ntu.edu.sg;SchoolofBiologicalSciences,NanyangTechnologicalUniversity,Singapore,637551§lwf@sdu.edu.cn;SchoolofPhysics,ShandongUniversity,Jinan,Shandong,China,250100[1]X.Du,Y.Li,Y.L.Xia,S.M.Ai,J.Liang,P.Sang,X.L.Ji,andS.Q.Liu,IntJMolSci17(2016).[2]I.A.Guedes,F.S.S.Pereira,andL.E.Dardenne,FrontPharmacol9,1089(2018).[3]O.GuvenchandA.D.MacKerell,Jr.,CurrOpinStructBiol19,56(2009).[4]S.R.Ellingson,B.Davis,andJ.Allen,BiochimicaetBiophysicaActa(BBA)-GeneralSubjects1864,129545(2020).[5]J.MichelandJ.W.Essex,JComputAidedMolDes24,639(2010).[6]M.K.GilsonandH.X.Zhou,AnnuRevBiophysBiomolStruct36,21(2007).[7]N.HansenandW.F.vanGunsteren,JChemTheoryComput10,2632(2014).[8]J.LiuandR.Wang,JChemInfModel55,475(2015).[9]S.Y.Huang,S.Z.Grinter,andX.Zou,PhysChemChemPhys12,12899(2010).[10]S.Z.GrinterandX.Zou,Molecules19,10150(2014).[11]N.Huang,ChakrapaniKalyanaraman,JohnJ.Irwin,andMatthewP.Jacobson.,JChemInfModel46,243(2006).[12]Y.C.Lo,S.E.Rensi,W.Torng,andR.B.Altman,DrugDiscovToday23,1538(2018).[13]J.Vamathevanetal.,NatRevDrugDiscov18,463(2019).[14]C.Shen,J.Ding,Z.Wang,D.Cao,X.Ding,andT.Hou,WIREsComputationalMolecularScience10(2019).[15]A.Lavecchia,DrugDiscovToday20,318(2015).[16]P.J.BallesterandJ.B.O.Mitchell,Bioinformatics26,1169(2010).[17]J.D.DurrantandJ.A.McCammon,JChemInfModel50,1865(2010).[18]Q.U.Ain,A.Aleksandrova,F.D.Roessler,andP.J.Ballester,WileyInterdisciplinaryReviews:Computa-tionalMolecularScience5,405(2015).[19]G.S.Heck,V.O.Pintro,R.R.Pereira,M.B.deAvila,N.M.B.Levin,andW.F.deAzevedo,CurrMedChem24,2459(2017).[20]W.WangandX.Gao,Methods166,1(2019).[21]E.Gawehn,J.A.Hiss,andG.Schneider,MolInform35,3(2016).[22]H.Chen,O.Engkvist,Y.Wang,M.Olivecrona,andT.Blaschke,DrugDiscovToday23,1241(2018).[23]K.Yangetal.,JChemInfModel59,3370(2019).[24]R.Winter,F.Montanari,F.Noe,andD.A.Clevert,ChemSci10,1692(2019).[25]F.Ghasemi,A.Mehridehnavi,A.Perez-Garrido,andH.Perez-Sanchez,DrugDiscovToday23,1784(2018).[26]A.Lavecchia,DrugDiscovToday24,2017(2019).[27]J.Jimenez,S.Doerr,G.Martinez-Rosell,A.S.Rose,andG.DeFabritiis,Bioinformatics33,3036(2017).[28]J.Gomes,B.Ramsundar,K.Fackeldey,andM.S.Pacella,arXiv:1703.10603.[29]J.Jim´enez,M.ˇskaliˇc,G.Mart´ınez-RosellandG.DeFab-ritiis,JChemInfModel58,287(2018).[30]H.¨Ozt¨urk,A.¨Ozg¨urandE.Ozkirimli,Bioinformatics34,i821(2018).[31]M.M.Stepniewska-Dziubinska,P.Zielenkiewicz,andP.Siedlecki,Bioinformatics34,3666(2018).[32]L.Zheng,J.Fan,andY.Mu,ACSOmega4,15956(2019).[33]J.A.Morrone,J.K.Weber,T.Huynh,H.Luo,andW.D.Cornell,JChemInfModel60,4170(2020).[34]W.TorngandR.B.Altman,JChemInfModel59,4131(2019).[35]W.Torng,R.B.Altman,andA.Valencia,Bioinformatics35,1503(2019).[36]G.M.Morris,D.S.Goodsell,R.S.Halliday,R.Huey,W.E.Hart,R.K.Belew,andA.J.Olson,JComputChem19,1639(1998).[37]R.Huey,G.M.Morris,A.J.Olson,andD.S.Goodsell,JComputChem28,1145(2007).[38]R.Wang,L.Lai,andS.Wang,JComputAidedMolDes16,11(2002).[39]X.Zhaoetal.,JChemInfModel48,1438(2008).[40]A.T.Garcia-Sosa,JChemInfModel53,1388(2013).[41]F.Spyrakis,M.H.Ahmed,A.S.Bayden,P.Cozzini,A.Mozzarelli,andG.E.Kellogg,JMedChem60,6781(2017).[42]M.Abadietal.,inOSDI’1612thUSENIXsymposiumonoperatingsystemsdesignandimplementation2016,pp.265.[43]F.Pedregosaetal.,JournalofMachineLearningRe-search12,2825(2011).[44]M.Su,Q.Yang,Y.Du,G.Feng,Z.Liu,Y.Li,andR.Wang,JChemInfModel59,895(2019).[45]Y.Li,Z.Liu,J.Li,L.Han,J.Liu,Z.Zhao,andR.Wang,JChemInfModel54,1700(2014).[46]Y.Li,L.Han,Z.Liu,andR.Wang,JChemInfModel54,1717(2014).[47]Y.Li,M.Su,Z.Liu,J.Li,J.Liu,L.Han,andR.Wang,NatProtoc13,666(2018).[48]D.D.NguyenandG.W.Wei,JChemInfModel59,3291(2019).[49]M.A.KhamisandW.Gomaa,EngineeringApplicationsofArtiﬁcialIntelligence45,136(2015).[50]B.Neyshabur,S.Bhojanapalli,D.McAllesterandN.Srebro,arXiv:1706.08947.[51]J.B.Dunbar,Jr.,R.D.Smith,C.Y.Yang,P.M.Ung,K.W.Lexa,N.A.Khazanov,J.A.Stuckey,S.Wang,andH.A.Carlson,JChemInfModel51,2036(2011).[52]O.TrottandA.J.Olson,JComputChem31,455(2010).[53]S.Forli,R.Huey,M.E.Pique,M.F.Sanner,D.S.Good-sell,andA.J.Olson,NatProtoc11,905(2016).[54]W.J.AllenandR.C.Rizzo,JChemInfModel54,518(2014).7[55]R.MeliandP.C.Biggin,JournalofCheminformatics12,1(2020).[56]A.Stank,D.B.Kokh,J.C.Fuller,andR.C.Wade,AccChemRes49,809(2016).SupportingInformationOnionNet-2:AConvolutionalNeuralNetworkModelforPredictingProtein-LigandBindingAﬃnitybasedonResidue-AtomContactingShellsZechenWang,∗LiangzhenZheng,†YangLiu,∗YuanyuanQu,∗Yong-QiangLi,∗MingwenZhao,∗YuguangMu,‡andWeifengLi§PARTI.PREPARATIONOFDATASETANDARCHITECTUREPreparationoftrainingset,validatingsetandtestingsetsWemainlyusedtheprotein-ligandcomplexesofPDB-binddatabasev.2019(http://www.pdbbind-cn.org/)fortraining.Thisdatabaseconsistsoftwooverlappingsubsets,thegeneralsetandthereﬁnedset.Thegen-eralsetincludesallavailablecomplexesandthereﬁnedsetcomprisesprotein-ligandcomplexeswithhigh-qualitystructureandbindinginformationselectedfromthegen-eralset.Foreachstructureoftheprotein-ligandcom-plex,thecorrespondingbindingaﬃnityisrepresentedbythenegativelogarithms(pKa)ofthedissociationcon-stants(Kd),inhibitionconstants(Ki)orhalfinhibitionconcentrations(IC50).Inordertoevaluatethepredic-tiveabilityandcomparewithotherscoringfunctions,OnionNet-2wasevaluatedontheCASF-2016testset(coresetv.2016)[1]andCASF-2013testset(coresetv.2013)[2–4].ItshouldbenotedthattheCASF-2016testsetisthelatestupdateofCASF-2016,whichcontains285high-qualitycomplexes.Whileforcoresetv.2013,itisasubsetofthePDBbinddatabasev.2013,consist-ingof195protein-ligandcomplexesclassiﬁedin65clus-terswithbindingconstantsspanningnearly10ordersofmagnitude.Besides,adatasetcalledCSARNRC-HiQ,consistingoftwosubsetscontaining176and167com-plexesrespectively,[5]wasemployedasathirdtestset.ForthepreviousmodelsofKdeepandRF-score,55and49complexesintwosubsetswereusedastestdata.[6]ToprovideadirectcomparisonwithKdeepandRF-score,weadoptedthesamedatafortheOnionNet-2test.Inordertoperformnormaltrainingandtesting,itisnecessarytoredistributeremainingcomplexesinPDBbinddatabasev.2019.First,weexcludedthecomplexescontainedinthreetestsetsfromPDBbinddatabasev.2019(generalsetandreﬁnedset).Then,asacommonpractice(Refer-ence:Pafnucy[7]andOnionNet[8]),1000complexeswererandomlysampledfromv.2019reﬁnedset(afterﬁlteringallcomplexesusedinthetestsetsdescribedpreviously)asthevalidatingset.Finally,theremainingcomplexes(thatis,thecomplexesthatarenotincludedinthethreetestsetsandvalidatingset)wereadoptedforthetrain-ingset.Thisensuresthatthereisnooverlappingprotein-ligandcomplexinthetrainingset,validatingsetandtestsets.ArchitectureWeadoptedaCNNmodelbasedon2Dconvolutiontolearntherelationshipbetweenthecontactfeaturesandthe4G.ThemodelwasconstructedusingtheKeraspackageintensorﬂow.[9]TheworkﬂowarchitectureisshowninFig.1.Therawdataispre-processedbeforeinputintotheCNNmodel.Here,thefeaturesarestandardizedthroughthescikit-learnpackage.[10]Threeconvolutionallayers,with32,64and128ﬁltersrespectivelywereusedandtheﬁltersizeswereallsetas4,withstridesas1.Afterpreliminarytests,twofullyconnectedlayerswith100and50neuronsareusedbeforetheoutputlayer,whichiscapableofcapturingthenonlinearrelationshipbetweenthefeaturesandthepKavalues.Tofurtherincreasethenonlinearabilityofthemodel,arectiﬁedlinearunit(RELU)layerwasaddedaftereachconvolutionallayerandfullyconnectedlayer.Also,abatchnormalizationlayerwasusedafterthefullycon-nectedlayer.Thestochasticgradientdescent(SGD)optimizerwasadoptedandthelearningratewassetas0.001.Toreduceoverﬁtting,L2regularizationwithweightdecayλ=0.01wasusedaftereachfullyconnectedlayer.Thenumberofsamplesprocessedperbatchis64.PARTII.THESTATISTICALINFORMATIONOFTHETRAININGSETANDVALIDATINGSETWHENUSINGDIFFERENTVERSIONSOFPDBBINDDATABASEGenerally,thesizeofthedatasetshasanimpactonthepredictiveabilityoftheDLmodel.[11,12]Tomakeafaircomparisonwithpreviousscoringfunctions,were-trainedthemodelwithtwoelderversions(v.2016andv.2018)ofthePDBbinddatabase,andthenumberofsamplesinthetrainingsetandvalidatingsetisshowninTableS1.Inaddition,weonlyre-trainedthemod-elsusingN=58,60and62.Theperformanceoncoresetv.2013andcoresetv.2016aresummarizedinFig.4.Itisclearthat,althoughthethreeversionsofPDB-binddatabasediﬀeredgreatlyinsize,theRvaluesofourre-trainedmodelsarealmostthesame.ThissuggestsarXiv:2103.11664v1  [q-bio.QM]  22 Mar 20212thatthediﬀerencebetweenthesethreedatabases(inde-tail,PDBbinddatabasev.2016,v.2018andv.2019)hasaratherlimitedimpactonourOnionNet-2model.FIG.S1.PearsoncorrelationcoeﬃcientsachievedbyOnionNet-2on(A)coresetv.2016and(B)coresetv.2013whendiﬀerentversionsofPDBbinddatabaseareusedfortraining(thetotalnumberofshellsissetto58,60and62).TABLES1.Thenumberofsamplesintrainingsetandvali-datingsetforthreeversionsofPDBbinddatabase.TrainingsetValidatingsetv.2016118201000v.2018146861000v.2019166261000PARTIII.COMPARISONOFONIONNET-2WITHSOMEREPRESENTATIVESCORINGFUNCTIONSTABLES2.Comparisonofthepredictivepowerofscoringfunctionsonthecoresetv.2016andv.2013CASF-2016CASF-2013ScoringfunctionsRRMSERSDOnionNet-20.8641.1640.8211.29AGL[13]0.8331.2710.7921.45Kdeep[6]0.821.27OnionNet[8]0.8161.2780.781.45RF-Score-v3[7]0.801.390.741.51Pafnucy[7]0.781.420.701.61kNN-Score[14]0.6721.65X-Score[14]0.6141.78ChemScore[14]0.5921.82AutoDockVina[15]0.541.90AutoDock[15]0.541.91FIG.S2.PearsoncorrelationcoeﬃcientofdiﬀerentscoringfunctionsontwobenchmarksCASF-2013.FIG.S3.TheresultachievedbyOnionNet-2onCSAR-HiQsubsets.PARTIV.THEDETAILEDINFORMATIONOFTHEGENERATIONOFDECOYSInCASF-2016benchmark,thesimilaritybetweentwobindingposesismeasuredbytheroot-mean-squarede-viation(RMSD)value.[4]FollowingpreviousstudiesbyAllenetal.,[16]weadoptedtheHungarianalgorithmtocalculateRMSDbetweendecoyligandandnativestruc-turewhichisimplementedinspyrmsd.[17]Inthisstudy,weusedAutoDockVinatogeneratenon-nativebindingpose(calleddecoys).Thesamplingspaceisa27˚A×27˚A×27˚Acubic,whichiscenteredonthegeometriccen-terofthenativeligandbindingpose.Theexhaustivenessvaluewassetto12.ItisworthnotingthatAutoDockVinaignorestheeﬀectsofwatermoleculesandionswhencalculatingprotein-ligandbindingenergy.Inaddition,changesintheligandbindingposeswillbeaccompaniedbychangesinthesurroundingmicroenvironment.There-fore,thereceptor-decoycomplexesheredonotincludewatermoleculesandions.1.Foreachreceptor,upto20decoyligandsweregener-atedbyAutoDockVina.Theactualnumbermaybelessthan20becauseoflimitedsizeandshapeofthebindingpocketinthetargetprotein.Foreachdecoy,theRMSDwithrespecttonativestructurewascalculated.2.Weused10RMSDintervals,[0˚A,2˚A],[2˚A,3˚A],3[3˚A,4˚A],...,[9˚A,10˚A]and[10˚A:].3.Forallligandsineveryinterval,weselectedthedecoywiththesmallestRMSDvaluetoputintothecor-respondingsubsets.4.Tentestsubsetscontainingnon-experimentalcom-plexeswereusedforOnionNet-2training.PARTV.ONIONNET-2PREDICTEDPKAWITHRESPECTTOEXPERIMENTALDETERMINEDPKAONTHREESERIESSUBSETSFIG.S4.OnionNet-2predictedpKawithrespecttoexperi-mentaldeterminedpKaon(A)H-,(B)S-and(C)Vseriessubsets.∗SchoolofPhysics,ShandongUniversity,Jinan,Shan-dong,China,250100†TencentAILab,Shenzhen,Guangdong,China,518000‡ygmu@ntu.edu.sg;SchoolofBiologicalSciences,NanyangTechnologicalUniversity,Singapore,637551§lwf@sdu.edu.cn;SchoolofPhysics,ShandongUniversity,Jinan,Shandong,China,250100[1]M.Su,Q.Yang,Y.Du,G.Feng,Z.Liu,Y.Li,andR.Wang,JChemInfModel59,895(2019).[2]Y.Li,Z.Liu,J.Li,L.Han,J.Liu,Z.Zhao,andR.Wang,JChemInfModel54,1700(2014).[3]Y.Li,L.Han,Z.Liu,andR.Wang,JChemInfModel54,1717(2014).[4]Y.Li,M.Su,Z.Liu,J.Li,J.Liu,L.Han,andR.Wang,NatProtoc13,666(2018).[5]J.B.Dunbar,Jr.,R.D.Smith,C.Y.Yang,P.M.Ung,K.W.Lexa,N.A.Khazanov,J.A.Stuckey,S.Wang,andH.A.Carlson,JChemInfModel51,2036(2011).[6]J.Jim´enez,M.ˇSkaliˇc,G.Mart´ınez-Rosell,andG.DeFabritiis,JChemInfModel58,287(2018).[7]M.M.Stepniewska-Dziubinska,P.Zielenkiewicz,andP.Siedlecki,Bioinformatics34,3666(2018).[8]L.Zheng,J.Fan,andY.Mu,ACSOmega4,15956(2019).[9]M.Abadietal.,inOSDI’1612thUSENIXsymposiumonoperatingsystemsdesignandimplementation2016,pp.265.[10]F.Pedregosaetal.,JournalofMachineLearningRe-search12,2825(2011).[11]C.Sun,A.Shrivastava,S.Singh,andA.Gupta,Proceed-ingsoftheIEEEinternationalconferenceoncomputervision.,pp.843(2017).[12]A.Lavecchia,DrugDiscovToday24,2017(2019).[13]D.D.NguyenandG.W.Wei,JChemInfModel59,3291(2019).[14]M.A.KhamisandW.Gomaa,EngineeringApplicationsofArtiﬁcialIntelligence45,136(2015).[15]T.Gaillard,JChemInfModel58,1697(2018).[16]W.J.AllenandR.C.Rizzo,JChemInfModel54,518(2014).[17]R.MeliandP.C.Biggin,JournalofCheminformatics12,1(2020).