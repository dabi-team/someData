Paradigm shift in electron-based crystallography via machine learning  

Kevin Kaufmann1, Chaoyi Zhu2*, Alexander S. Rosengarten1*, Daniel Maryanovsky3, Tyler J. Harrington2, 
Eduardo Marin1, and Kenneth S. Vecchio1,2 

1Department of NanoEngineering, UC San Diego, La Jolla, CA 92093, USA 
2Materials Science and Engineering Program, UC San Diego, La Jolla, CA 92093, USA 
3Department of Cognitive Science, UC San Diego, La Jolla, CA 92093, USA 
*These authors contributed equally to this work. 

Abstract 

Accurately  determining  the  crystallographic  structure  of  a  material,  organic  or  inorganic,  is  a  critical 

primary  step  in  material  development  and  analysis.    The  most  common  practices  involve  analysis  of 

diffraction patterns produced in laboratory X-ray diffractometers, transmission electron microscopes, and 

synchrotron X-ray sources.  However, these techniques are slow, require careful sample preparation, can 

be difficult to access, and are prone to human error during analysis.  This paper presents a newly developed 

methodology that represents a paradigm change in electron diffraction-based structure analysis techniques, 

with  the  potential  to  revolutionize  multiple  crystallography-related  fields.    A  machine  learning-based 

approach for rapid and autonomous identification of the crystal structure of metals and alloys, ceramics, 

and  geological  specimens,  without  any  prior  knowledge  of  the  sample,  is  presented  and  demonstrated 

utilizing  the  electron  backscatter  diffraction  technique.    Electron  backscatter  diffraction  patterns  are 

collected  from  materials  with  well-known  crystal  structures,  then  a  deep  neural  network  model  is 

constructed for classification to a specific Bravais lattice or point group.  The applicability of this approach 

is evaluated on diffraction patterns from samples unknown to the computer without any human input or 

data filtering.  This is in comparison to traditional Hough transform electron backscatter diffraction, which 

requires that you have already determined the phases present in your sample.  The internal operations of 

the neural network are elucidated through visualizing the symmetry features learned by the convolutional 

neural network.  It is determined that the model looks for the same features a crystallographer would use, 

even though it is not explicitly programmed to do so.  This study opens the door to fully automated, high-

throughput determination of crystal structures via several electron-based diffraction techniques.  

1 

 
 
Main text 

Identifying  structure  is  a  crucial  step  in  the  analysis  of  proteins1–3,  micro-4,5  and  macro-molecules6, 

pharmaceuticals7, geological specimens8, synthetic materials9–11, and many other fields.  In the materials 

science  realm,  it  is  well  known  that  the  crystal  structure  plays  a  significant  role  in  the  properties 

exhibited12,13.  Determining the complete crystal structure (i.e. crystal symmetry) of the phases in a material 

can  be  a  challenging  task,  especially  for  multi-phase  materials  or  those  with  low  symmetry  phases.  

Currently,  the  most  common  techniques  involve  either  X-ray  diffraction  (XRD),  via  laboratory 

diffractometers  or  synchrotron  radiation  sources,  or  transmission  electron  microscopy  (TEM)-based 

convergent beam electron diffraction (CBED)14–16.  XRD is the faster of these two techniques, requiring 

only a powder or polished bulk sample, a few hours to collect diffraction intensities over a range of angles, 

and the time for pattern refinement to match the experimentally collected pattern to those in a database or 

theoretical model.  However, this process is subject to misclassification by users, owing to shifts in lattice 

parameter, the overlapping nature of XRD peaks in multi-phase samples, texture effects, and the thresholds 

set  by  researchers  for  what  qualifies  as  a  ‘match’.    TEM  studies  employing  convergent  beam  electron 

diffraction (CBED) are more precise than XRD in their ability to pinpoint the location of individual crystals, 

produce singular diffraction patterns for a given phase, and capture subtle symmetry information; however, 

CBED  has  limitations  in  sample  preparation  and  the  rate  of  data  collection  and  analysis,  and  requires 

significant operator expertise17–19.   

A scanning electron microscope (SEM), equipped with an electron backscatter diffraction (EBSD) system, 

has  become  an  essential  part  of  characterization  for crystalline  materials  and  geological  samples8.   The 

discovery of electron backscatter diffraction patterns was reported by Nishikawa and Kikuchi in 192820.  

The  emergence  of  commercial  EBSD  systems  can  be  attributed  to  the  early  research  by  Alam  et  al.21, 

Venables et al.22, Dingley23, and the development of fully automated image analysis methods in the early 

90s24,25.  Since the introduction of automated EBSD, commercial software and hardware have evolved to 

capture  more  than  3000  patterns  per  second,  which  expands  the  applicability  of  the  technique  to  assist 

2 

 
researchers  with  more  complex  problems26.    For  example,  the  high-throughput  capability  of  a  modern 

EBSD system enables determination of fine-scale grain structures, sample texture, point-to-point crystal 

orientation, residual stress/strain, geometrically necessary dislocation densities, etc.27–31  The relative ease 

of sample preparation compared with TEM samples, as well as analysis of a significantly larger sample 

area in less time makes SEM-EBSD an attractive technique to study location specific orientation with high 

precision (~2°), misorientation resolution (0.2°) and a spatial resolution ~40 nm32.  Combined with other 

analytical techniques such as energy dispersive X-ray spectroscopy (EDS) or wavelength dispersive X-ray 

spectroscopy  (WDS),  phase  identification  is  also  possible33–35,  given  that  the  chemical  and  structural 

information of the phase exists in a  theoretical model or crystal database, such as the Inorganic Crystal 

Structure Database* (ICSD).  Additionally, a method for determination of an unknown Bravais lattice using 

a  single  electron  backscatter  diffraction  pattern,  without  EDS  data,  has  also  been  recently  proposed36.  

However,  this  technique  requires  hand-drawn  lines  to  be  overlaid  with  a  high  degree  of  accuracy  on 

individual Kikuchi bands.  This results in a slow and tedious methodology that requires manual annotation 

of each individual pattern. 

However, electron backscatter diffraction (EBSD) has historically been limited to elucidating orientation 

of user-defined crystal structures (i.e. the crystal structure is known or assumed and only its orientation 

determined in EBSD).  This is achieved utilizing the Hough transform, an image processing technique for 

finding  the  intersection  of  diffraction  maxima  (Kikuchi  lines)  in  the  image,  and  a  look-up  table  of  the 

orientations  for  only  the  user-defined  phases  (typically  less  than  5  phases).    Furthermore,  the  Hough 

transform  is  unable  to  differentiate  different  crystal  structures  with  similar  symmetries  or  specific 

orientations  that  produce  a  similar  Hough  transform37.    Therefore,  the  state-of-the-art  Hough  transform 

EBSD method requires a large amount of knowledge about the sample and/or a highly experienced user for 

it to be utilized in its current form.  Simply put, the Hough transform approach to EBSD is incapable of 

* http://www2.fiz-karlsruhe.de/icsd_home.html 

3 

 
                                                           
‘determining’ crystal structure and can only determine the orientation of a known crystal structure, which 

is preselected by the user.  

Recently, the materials science field has begun to embrace the big data revolution38.  This development has 

sparked  an  interest  in  machine  learning,  mainly  for  application  in  the  discovery  of  new  materials.  

Researchers have shown the ability to predict new compositions for bulk metallic glasses39, shape memory 

alloys40, Heusler compunds41, and ultraincompressible superhard materials42. Other groups are developing 

machine learning methods to establish structure-property linkages43,44, or predict the crystal stability of new 

materials45.   There also exists a few machine learning tools for analysis of fabricated alloys. Holm et al. 

46,47, have demonstrated the classification of 105 optical microscopy images into one of seven groups with 

greater than 80% accuracy46, as well as microconstituent segmentation using the PixelNet convolutional 

neural network (CNN) architecture trained on manually annotated micrographs of ultrahigh carbon steel48.  

These  machine  learning  driven  analysis  techniques  represent  important  developments  in  the  materials 

science toolbox, but are not broadly applicable.  Optical images of microstructure are often easily confused 

in  the  real  world  and  do  not  provide  information  about  crystal  structures  or  chemistry.    The  PixelNet 

example  is  highly  application  specific  and  is  only  applicable  to  high-throughput  segmentation  and 

classification of the material space it is trained on.  The need for more broadly applicable analysis tools 

remains, and the development of a machine learning methodology for the identification of crystal symmetry 

from  diffraction  patterns  demonstrates  an  approach  broadly  applicable  to  multiple  diffraction-based 

analyses. 

Herein, we demonstrate a novel methodology, EBSD coupled with a machine learning algorithm, to identify 

the origin Bravais lattice or point group of a sample from diffraction patterns.  This hybrid approach to 

identify the underlying structure of a material in electron-based diffraction techniques functions without 

the need for highly skilled operators or human-based indexing approaches.  The trained machine learning 

model  is  subsequently  applied  to  materials  it  was  not  trained  on,  but  which  contain  the  same  crystal 

symmetry, and identifies the correct Bravais lattice or point group with a high degree of accuracy (greater 

4 

 
than 90% overall).  This can be applied to autonomously generate crystal structure phase maps of unknown 

single or multi-phase materials without any prior knowledge.  Moreover, the ability for machine learning 

to glean the symmetry features associated with crystal structure is established by monitoring the activations 

of the trained model.  The high degree of success with determination of specific Bravais lattices, leads to 

the exploration of this novel methodology’s ability to distinguish between structures based on their crystal 

point  groups.    Furthermore,  the  deep  learning  methodology  employed  herein  could  be  applied  to  other 

disciplines  outside  of  the  materials  science  field  including  geology,  pharmacology,  and  even  structural 

biology49. 

The  classification  model.    Having  collected  approximately  400,000  EBSD  patterns  from  40  different 

materials, it is necessary to classify each of these images based solely on the information contained in the 

image  file.    The  classical  computer  vision  approach  is  to  manually  engineer  features  and  use  a 

discriminatory model to make the ultimate decision about the  Bravais lattice to which the source image 

belongs.    Such  an  approach  would  require  a  multitude  of  heuristics—such  as  detecting  Kikuchi  bands, 

accounting for their slight orientation changes, looking for symmetry in the image, etc., and carrying the 

burden  of  developing  the  logic  that  defines  these  abstract  qualities.    The  process  of  generating  the 

corresponding  computer  logic  is  even  more  challenging  when  one  considers  the  smallest  changes  in 

diffraction patterns resulting from orientation changes or minute atomic position differences and defects in 

materials of the same crystal structure. Thus, the traditional computer vision approach becomes less feasible 

as the number of categories grows, cannot be generalized to other crystal classes (including expanding these 

capabilities  to  point  and  space  groups),  and  lacks  a  procedure  to  systematically  improve  prediction 

capabilities. On the other hand, one could use a technique that determines its own internal representation 

of the data so long as it performs well at the discrimination task. This is the underlying principle behind 

deep representation learning (i.e. deep neural networks)50. Such methods allow the model to find patterns 

that may be unintuitive or too nuanced for humans to discern.  Other discovered features might be obvious 

to experts, but difficult to translate into specific logic.   

5 

 
These  deep  learning  systems  take  in  raw  data  and  automatically  discover,  through  filters  learned  via 

backpropagation51, the abstract representations that maximize classification performance. In convolutional 

neural networks, such as the ones used in this work, the early layers typically learn to look for the presence 

or absence of edges or curves, while the later layers assemble these motifs into representative combinations 

and eventually familiar objects. In this case, these more familiar objects are the symmetry elements present 

in the diffraction pattern encoding a Bravais lattice.  A schematic representation of the CNN utilized in this 

work is shown in Fig. 1.  In the first step, a learnable filter is convolved across the image, and the scalar 

product between the filter and the input at every position, or ‘patch’, is computed to form a feature map.  

This  is  called  a  convolutional  layer.    Next,  a  series  of  alternating  convolutional  and  pooling  layers  are 

stacked sequentially.  The units in a convolutional layer are organized in feature maps, and each feature 

map is connected to local patches in the previous layer through a set of weights called a filter bank.  All 

units in a feature map share the same filter banks (also called kernels), while different feature maps in a 

convolutional layer use different filter banks.  Pooling layers are placed after convolutional layers to down 

sample the feature maps and produce coarse grain representations and spatial information about the features 

in  the  data.      The  key  aspect  of  deep  learning  is  that  these  layers  of  feature  detection  nodes  are  not 

programmed into lengthy scripts or hand-designed feature extractors, but instead ‘learned’ from the data.  

In  this  case,  such  motifs  encode  the  underlying  crystallographic  symmetry  present  in  the  diffraction 

patterns, as demonstrated below, by investigating the learned features of the convolutional neural network. 

6 

 
Fig. 1 |  Illustration  of  the  inner  workings  of  a  convolutional  neural  network.    Convolutional  neural 

networks  are  composed  of  a  series  of  alternating  convolutional  and  pooling  layers.  Each 

convolutional layer extracts features from its preceding layer, using filters (or kernels) learned from 

training the model, to form feature maps. These feature maps are then down-sampled by a pooling 

layer to exploit data locality. A traditional dense neural network, a simple type of classification 

network, is placed as the last layer of the CNN, where the probability that the input diffraction 

pattern belongs to a given class (e.g. Bravais lattice or point group) is computed. 

Performance of the model.  The trained model was first applied to new diffraction patterns (meaning the 

computer has never seen these EBSD patterns previously, and the patterns are a random mix of orientations, 

which may or may not be similar to the training patterns) collected from the same materials utilized for 

7 

 
 
 
training  the  model  via  backpropagation.    In  Fig.  2  and  Extended  Data  Fig.  1,  both  the  ResNet50  and 

Xception architecture correctly classify nearly 300,000 diffraction patterns with a high degree of accuracy 

(>90%  overall  accuracy  for  each  architecture).      Specifically,  this  means  the  individual  EBSPs  were 

identified as belonging to one of the fourteen Bravais lattices with no user input.   For further validation, 

EBSD  patterns  from  nine  completely  different  materials  were  selected  for  blind  testing  of  the  machine 

learning approach to autonomous identification of crystal structures.  Fig. 3 and Extended Data Fig. 2 show 

modified confusion matrices, where correct classification is shown in the green squares rather than along 

the diagonal, and utilizes more than 50,000 diffraction patterns to highlight the capabilities of the proposed 

methodology.  Each architecture correctly classifies the Bravais lattice of the unknown material with 93.5% 

and 91.2 % overall accuracy for ResNet50 and Xception, respectively.  It is observed that the base-centered 

monoclinic  crystal  structure  has  a  propensity  to  be  incorrectly  classified  as  primitive  orthorhombic  or 

rhombohedral.  Further investigation as to the cause of this misclassification reveals that the base-centered 

monoclinic, primitive orthorhombic, and rhombohedral Bravais lattices belong to the 2/m, mmm, and  m 

point group, respectively.   

8 

 
 
Fig. 2 | Confusion matrix displaying the model’s classification results for the 14 Bravais lattices.  A new 

set of diffraction patterns from fourteen of the materials were classified by the trained model with 

ResNet50 architecture.  The diagonal (blue shaded boxes) in these tables represent the successful 

matching of the CNN predictions to the true Bravais lattices of the sample.   

As seen in Extended Data Table 1, the 2/m and mmm point groups each only have 2-fold axis symmetry, 

mirror plane symmetry, and inversion center symmetry.  The rhombohedral  m point group shares these 

same symmetry elements, with the addition of one 3-fold axis symmetry.  This high level of attention to 

specific symmetry elements present in the diffraction pattern strongly suggests that this methodology is 

capable  of  classification  beyond  Bravais  lattices  into  point  groups  and  perhaps  space  groups.    The 

practicality of point group level classification is demonstrated in the following section. 

9 

 
 
 
 
Fig.  3  |  Performance  of  the  machine  learning  models  on  data  from  new  materials.  The  ResNet50 

convolutional  neural  network  architecture  perform  exceedingly  well  on  electron  backscatter 

diffraction patterns collected from materials not used to train the model.  Correct classification is 

identified by the green squares instead of along the diagonal. 

Classification of point groups.  The previous results allude to the possibility of point group determination 

in EBSD in an autonomous and high-throughput manner via machine learning.  In Fig. 4 and Extended 

Data Fig. 3, point group classification is demonstrated for a disordered and ordered atomic arrangement of 

the primitive cubic, face-centered cubic, and body-centered cubic lattices.  This represents a significant 

development in the capabilities of the EBSD technique, as well as strong evidence that the machine learning 

approach developed and presented herein will be capable of at least point group level classification in other 

structure probing techniques. 

10 

 
 
 
Fig. 4 |  Demonstration  of  machine  learning  aided  EBSD’s  capability  to  autonomously  identify  point 

groups. a, An electron backscatter diffraction pattern for each of the four materials. Zone axes with 

the  same  symmetry  are  seen  in  each  diffraction  pattern.  b,  Results  of  training  the  model  to 

discriminate between the B2 (atomically ordered) and BCC (atomically disordered) point groups. 

c, Resultant confusion matrix after testing the model blindly on two materials from the same point 

groups. 

Visualizing the learned features.  The excellent performance of these deep neural networks in correctly 

identifying the structure of materials previously unknown to the system inherently requires an intuitive and 

understandable interpretation of how the model is arriving at the correct classifications.  Fig. 5 elucidates 

an example of how the model accomplishes this by finding features in the diffraction patterns that represent 

the symmetry present in the origin lattice.   Two diffraction patterns, one for nickel and one for aluminum, 

of similar crystallographic orientation, were selected for analysis of the ‘importance’ of the features present.  

The weight of local regions in the image is discovered using the neural network architecture and employing 

a set of tools called Grad-CAM52.   After computing the ‘importance’ of these local regions in the diffraction 

image, the weights are normalized from 0 (dark blue) to 1 (dark red) and overlaid on the original image as 

a heatmap.  In the example provided for diffraction patterns collected from similarly oriented crystals of 

nickel and aluminum, it is observed that the activation maps are remarkably similar and elucidate the intense 

11 

 
 
 
interest of the network in symmetry located at the zone axes.  For each diffraction pattern, the [11̅2] and 

[112] zone axes (2-fold symmetry) are the regions of greatest interest.  The machine learning algorithm 

couples this information with the presence of the [001] (4-fold symmetry) and [01̅3] (2-fold symmetry), 

as well as their spatial relationship owing to pooling layers, to correctly identify the origin Bravais lattice 

as face-centered cubic.  Extended Data Fig. 4 displays one similar heatmap for each of the 28 materials 

utilized in the training set.  For each material, a similar interest in the information nearest the zone axes is 

observed.  

Fig. 5 | Visualizing the features utilized for classification of a diffraction pattern to face-centered cubic 

(FCC).    An  electron  backscatter  diffraction  pattern  from  nickel  (Ni)  and  aluminum  (Al)  were 

selected from nearly identical orientations. In the diffraction patterns, four of the zone axes present 

in  each  are  labeled.   The  corresponding  heatmap  displays  the  importance  of  information  in the 

image for correctly classifying it as FCC.  It is observed that for each of these two images, the 

symmetry information near the [11̅2] zone axis produces the highest activation, followed by the 

[112] zone axis, and symmetry shared by the [001] and [01̅3] zone axes.  

Phase  mapping  with  machine  learning.    To  date,  it  has  been  generally  accepted  that  computers  are 

incapable of band detection utilizing the original diffraction patterns, hence the use of a Hough transform 

to  locate  diffraction  maxima  in  the  EBSP.    However,  Hough  transform  EBSD  is  limited  to  orientation 

determination of user-defined phases (i.e. the crystal structure is known or assumed and only its orientation 

determined).  Rather than utilizing the Kikuchi diffraction lines directly, the Hough transform is utilized to 

12 

 
 
 
locate diffraction maxima and compare a small amount of information from the transformed image to a 

dictionary of orientations for the small subset (typically less than 5) user-selected phases.  The small subset 

of information being utilized often results in mis-classification of similar crystal structures and orientations 

that produce similar diffraction maxima in different crystal systems37.  Therefore, the applicability of the 

state-of-the-art technique is limited to situations, where a great deal of information is already known about 

the  sample,  and  an  experienced  operator  is  available  to  confirm  the  diffraction  patterns  are  not  being 

incorrectly indexed.  

The methodology demonstrated herein reduces the requirements for prior knowledge of the sample and 

highly trained operators.  Instead of relying on a subset of user selected phases, this approach autonomously 

utilizes all the information in each collected diffraction pattern to determine the crystal structure at that 

location.  This advancement is demonstrated in Fig. 6 on a sample of rutilated quartz.   Fig. 6b is a forward 

scattered  electron  image,  which  clearly  demonstrates  the  two-phase  nature  of  the  sample,  with  quartz 

appearing recessed and rutile appearing raised above the surface.  In Fig. 6a, a phase map of quartz and 

rutile  was  generated  after a  user  selected  the  quartz  and  rutile phases to  serve as  the  look-up  table  and 

subsequently  collected  diffraction  patterns  for  Hough  transform  indexing.    Fig.  6c  was  generated  by 

collecting the diffraction patterns and allowing the convolutional neural network to determine the crystal 

structure, out of all the possible 14 Bravais lattices, that produced each diffraction pattern.  The machine 

learning generated phase map is nearly identical to that generated by the state-of-the-art method, except it 

was  generated  without  any  human  supplied  information.    Future  combination  of  this  technique  with 

chemistry information and a crystal database has the potential to enable highly accurate autonomous phase 

identification. 

13 

 
 
Fig. 6  | Utilizing machine learning to predict the number of phases and their location in the material. The 

phase map on the left was generated by traditional means where the user had to select quartz and 

rutile as the two specific phases present in the sample. The center electron image is the region of 

the sample from which the diffraction patterns were collected. The image on right is a phase map 

generated via machine learning determination of the Bravais lattice for each diffraction pattern.  

Black scale bar in (a) is 100µm. 

Conclusions 

A revolutionary approach to identifying  the underlying structure of a material in electron-based diffraction 

techniques has been presented here and its success demonstrated in determining the origin Bravais lattice 

or point group of an electron backscatter diffraction pattern.  This methodology immediately enables high-

throughput autonomous determination of crystal symmetry in electron backscatter diffraction and will be 

of great importance to multiple techniques and disciplines, including those outside of EBSD and materials 

science.  The method is demonstrated and validated via a comprehensive set of studies to be capable of 

classification of diffraction patterns to the 14 Bravais lattices and the 32 point groups; areas where the state-

of-the-art  Hough  transform  based  EBSD  fails  and  only  convergent  beam  electron  diffraction,  precision 

XRD, and synchrotron are viable techniques. Feature visualization demonstrates that the CNN identifies 

14 

 
 
 
specific features resulting from unique crystal symmetry operations within the diffraction pattern images. 

This demonstrates feasibility of moving toward determination of precise space groups of unknown systems, 

where the only differences may be a single different symmetry operator.  Moreover, we show the application 

of  this  method  to  phase  map  the  Bravais  lattice  of  a  two-phase  specimen  without  any  human  supplied 

information and compare the results with the traditional Hough transform-based approach supplied with 

user selected libraries.  Future improvements to our methodology could be realized with the design of neural 

network architectures developed specifically for this task, an increased range of materials for the network 

to  learn  from,  or  data  filters  to  prevent  the  network  learning  from  or  attempting  to  classify  diffraction 

patterns without enough information present for robust classification.  In the near future, we foresee this 

hybrid  approach  being  utilized  to  develop  similar  revolutionary  electron-based  structure  determination 

methodologies  in  a  multitude  of  other  crystallography-related  fields  including  pharmacology,  structural 

biology, and geology, and should be extendable to X-ray diffraction techniques as well. 

Methods 

Electron backscatter diffraction pattern collection.   Elements or alloys of known crystal structure were 

collected and polished for EBSD.  High purity samples of each metal, alloy, or ceramic material (Cr3Si, 

Mo3Si, V8C7, Si, Ni, Al, NbC, TaC, W, Ta, β-Ti, Fe, WC, Ti, Al2O3, Sn,  Mo5Si3, Mo2C, TiSi2, Al3Zr2, 

Ni2V, MoPt2, AuSn4, ZrSi2, Nb2O5, Fe4Al13, FeNi3,TiC, NiAl, and Ni3Al), and carefully selected geological 

specimens (quartz, ilmenite, rutile, anatase, forsterite, enstatite, malachite, jadeite, diopside, and anorthite) 

were  selected.    Extended  Data  Fig.  5  displays  the  materials  and  their  Bravais  lattice.    In  multi-phase 

geological specimens, only patterns identifiable to one of the phases were analyzed.  EBSPs were collected 

in a Thermo-Fisher (formerly FEI) APREO scanning electron microscope (SEM) equipped with an Oxford 

Symmetry EBSD detector. Extended Data Fig. 6 details the experimental setup within the SEM chamber.  

The  Oxford  Symmetry  EBSD  detector  was  utilized  in  high  resolution  (1244x1024)  mode  with  frame 

averaging.  EBSPs were collected from multiple large areas with large step sizes chosen to maximize the 

number of differently oriented patterns taken from unique grains.   After collecting high resolution EBSPs 

15 

 
from each material, all patterns collected were exported as  tiff images.   Extended Data Fig. 7 displays 

example images of the high-resolution diffraction patterns collected.  None of the collected patterns were 

excluded from training, testing, or validation studies unless their origin was uncertain (i.e. non-indexable 

patterns from  multi-phase geological specimens).  That is to say, the collected data was not filtered  for 

pattern quality via any means, and the library of images for each phase may contain partial or low-quality 

diffraction patterns, which will decrease the accuracy of their identification.   

Neural network architecture and training procedure.  Two well-studied CNN architectures designed 

for broad image classification tasks, ResNet5053 and Xception54, were utilized in this work.  Training was 

performed using Adam optimization55, with batches of 32 images, and a minimum delta of 0.001 in the 

validation loss for early stopping criteria.  The CNNs were implemented with TensorFlow56 and Keras57.  

Refer to Extended Data Fig. 8 for a detailed schematic of the test-train workflow, and refer to Extended 

Data Fig. 9 for the connection between the 7 crystal structures, 14 Bravais lattices, 32 crystal point groups, 

and 230 crystal space groups. 

For the 14 Bravais lattices, two materials from each class were selected as training materials (e.g. nickel 

and aluminum for face centered cubic). Two materials were selected for training to increase the network’s 

focus on common symmetry elements in the diffraction patterns.  For training the model, 640 diffraction 

patterns from each material were randomly selected, and the 300,000 remaining diffraction patterns from 

those same materials were employed as the test set to gauge the model’s accuracy after training.  

In  the  point  group  classification  example,  the  ResNet50  convolutional  neural  network  was  trained  as  a 

binary  classifier  between  an  atomically  ordered  and  disordered  version  of  the  same  lattice.    The  three 

models were trained using diffraction patterns from FeNi3 (L12) and Cr3Si (primitive cubic), TiC (B1) and 

Ni (FCC), and NiAl (B2) and Ta (BCC).  The trained model was then blind tested on two materials that 

were new to the machine learning model: Ni3Al (L12) and Mo3Si (primitive cubic), TaC (B1) and Al (FCC), 

and FeAl (B2) and W (BCC).  

16 

 
Validation  studies.    The  accuracy  of  the  trained  models  was  evaluated  using  new  diffraction  patterns 

collected from each of the materials utilized to train the deep neural network as well as diffraction patterns 

from materials the model had not previously encountered.   Heatmap overlays giving class-specific gradient 

information at the classification layer of the Xception architecture were produced using Grad-CAM52.  This 

technique reveals the importance of local regions in the diffraction pattern to assist in the determination of 

why the algorithm classified the image to a particular structure. 

Data  availability.    The  trained  models  generated  during  and/or  analyzed  during  the  current  study  are 

available from the corresponding author on reasonable request.  The python code for implementing these 

models with Keras and Tensorflow is available from the corresponding author upon request.  The diffraction 

patterns analyzed during the current study are not made available due to the sheer size of the library (nearly 

3 terabytes). 

17 

 
References 

1. 

Abrams, I. M., McBain, J. W. and Parsons, D. F., A closed cell for electron microscopy, Science 

100, 273–4 (1944). 

2. 

3. 

Walz, T. et al., The three-dimensional structure of aquaporin-1, Nature 387, 624–627 (1997). 

Rodriguez, J. A. et al., Structure of the toxic core of α-synuclein from invisible crystals, Nature 

525, 486–490 (2015). 

4. 

Hedberg, K. et al., Bond lengths in free molecules of buckminsterfullerene, c60, from gas-phase 

electron diffraction, Science 254, 410–2 (1991). 

5. 

Blaga, C. I. et al., Imaging ultrafast molecular dynamics with laser-induced electron diffraction, 

Nature 483, 194–197 (2012). 

6. 

Hui, S. W. and Parsons, D. F., Electron diffraction of wet biological membranes, Science 184, 77–8 

(1974). 

7. 

Palatinus, L. et al., Hydrogen positions in single nanocrystals revealed by electron diffraction, 

Science 355, 166–169 (2017). 

8. 

Bestmann, M., Piazolo, S., Spiers, C. J. and Prior, D. J., Microstructural evolution during initial 

stages of static recovery and recrystallization: new insights from in-situ heating experiments 

combined with electron backscatter diffraction analysis, J. Struct. Geol. 27, 447–457 (2005). 

9. 

Huang, W. J. et al., Coordination-dependent surface atomic contraction in nanocrystals revealed 

by coherent diffraction, Nat. Mater. 7, 308–313 (2008). 

10.  Midgley, P. A. and Dunin-Borkowski, R. E., Electron tomography and holography in materials 

science, Nat. Mater. 8, 271–280 (2009). 

11. 

Curtarolo, S., Morgan, D., Persson, K., Rodgers, J. and Ceder, G., Predicting Crystal Structures with 

Data Mining of Quantum Calculations, Phys. Rev. Lett. 91, 135503 (2003). 

12. 

Nye, J. F., Physical properties of crystals: their representation by tensors and matrices, Clarendon 

18 

 
Press, Oxford, Great Britain, (1985). 

13. 

Tan, J. C. and Cheetham, A. K., Mechanical properties of hybrid inorganic–organic framework 

materials: establishing fundamental structure–property relationships, Chem. Soc. Rev. 40, 1059 

(2011). 

14. 

Ollivier, B., Retoux, R., Lacorre, P., Massiot, D. and Férey, G., Crystal structure of κ-alumina: an X-

ray powder diffraction, TEM and NMR study, J. Mater. Chem. 7, 1049–1056 (1997). 

15. 

Post, J. E. and Veblen, D. R., Crystal structure determinations of synthetic sodium, magnesium, 

and potassium birnessite using TEM and the Rietveld method, American Mineralogist 75, (1990). 

16. 

Andersen, S. J. et al., The crystal structure of the β″ phase in Al–Mg–Si alloys, Acta Mater. 46, 

3283–3298 (1998). 

17. 

Vecchio, K. S. and Williams, D. B., Convergent beam electron diffraction analysis of theT 1 

(Al2CuLi) phase in Al-Li-Cu alloys, Metall. Trans. A 19, 2885–2891 (1988). 

18. 

Vecchio, K. S. and Williams, D. B., Convergent beam electron diffraction study of Al3Zr in Al-Zr 

AND Al-Li-Zr alloys, Acta Metall. 35, 2959–2970 (1987). 

19. 

Images of Materials, Oxford University Press, (1991). 

20. 

Nishikawa, S. and Kikuchi, S., Diffraction of Cathode Rays by Calcite, Nature 122, 726–726 (1928). 

21. 

Alam, M. N., Blackman, M. and Pashley, D. W., High-Angle Kikuchi Patterns. Proc. R. Soc. A Math., 

Phys. Eng. Sci. 221, 224–242 (1954). 

22. 

Venables, J. A. and Harland, C. J., Electron back-scattering patterns—a new technique for 

obtaining crystallographic information in the scanning electron microscope, Philos. Mag. 27, 

1193–1200 (1973). 

23. 

Dingley, D. J., A comparison of diffraction techniques for the SEM, Scan. Electron Microsc. 4, 273–

286 (1981). 

24. 

Adams, B. L., Wright, S. I. and Kunze, K., Orientation imaging: The emergence of a new 

19 

 
microscopy, Metall. Trans. A 24, 819–831 (1993). 

25. 

Krieger Lassen, N. C., Juul Jensen, D. and Conradsen, K., Image processing procedures for analysis 

of electron back scattering patterns, Scan. Micros., 6, 115–121 (1992). 

26. 

Goulden, J., Trimby, P. and Bewick, A., The Benefits and Applications of a CMOS-based EBSD 

Detector. Microsc. Microanal., 24, 1128–1129 (2018). 

27. 

Schwartz, A. J., Kumar, M., Adams, B. L. and Field, D. P., Electron backscatter diffraction in 

materials science. Electron Backscatter Diffr., Mater. Sci. 1–403 (2009). doi:10.1007/978-0-387-

88136-2 

28. 

Randle, V., Engler, O. and Engler, O., Introduction to Texture Analysis, CRC Press, (2014). 

doi:10.1201/9781482287479 

29. 

Zhu, C. et al. Investigation of the shear response and geometrically necessary dislocation 

densities in shear localization in high-purity titanium, Int. J. Plast. 92, 148–163 (2017). 

30. 

Zhu, C., Harrington, T., Gray, G. T. and Vecchio, K. S. Dislocation-type evolution in quasi-statically 

compressed polycrystalline nickel, Acta Mater. 155, 104–116 (2018). 

31. 

Zhu, C., Harrington, T., Livescu, V., Gray, G. T. and Vecchio, K. S., Determination of geometrically 

necessary dislocations in large shear strain localization in aluminum, Acta Mater. 118, 383–394 

(2016). 

32. 

Chen, D., Kuo, J. C. and Wu, W. T., Effect of microscopic parameters on EBSD spatial resolution, 

Ultramicroscopy 111, 1488–1494 (2011). 

33. 

Dingley, D. J. and Wright, S. I., Phase Identification Through Symmetry Determination in EBSD 

Patterns, in Electron Backscatter Diffraction in Materials Science (eds. Schwartz, A., Kumar, M., 

Adams, B. and Field, D.) 97–107 (Springer, 2009). doi:10.1007/978-0-387-88136-2 

34. 

Nowell, M. M. and Wright, S. I., Phase differentiation via combined EBSD and XEDS, J. Microsc. 

213, 296–305 (2004). 

20 

 
35. 

Goehner, R. P. and Michael, J. R., Phase Identification in a Scanning Electron Microscope Using 

Backscattered Electron Kikuchi Patterns, J. Res. Natl. Inst. Stand. Technol. 101, 301–308 (1996). 

36. 

Li, L. and Han, M., Determining the Bravais lattice using a single electron backscatter diffraction 

pattern,  J. Appl. Crystallogr. 48, 107–115 (2015). 

37. 

Karthikeyan, T., Dash, M. K., Saroja, S. and Vijayalakshmi, M., Evaluation of misindexing of EBSD 

patterns in a ferritic steel, J. Microsc. 249, 26–35 (2013). 

38.  White, A. A., Big data are shaping the future of materials science, MRS Bull. 38, 594–595 (2013). 

39. 

Ren, F. et al., Accelerated discovery of metallic glasses through iteration of machine learning and 

high-throughput experiments, Sci. Adv. 4, 1566 (2018). 

40. 

Xue, D. et al., Accelerated search for materials with targeted properties by adaptive design, Nat. 

Commun. 7, 11241 (2016). 

41. 

Oliynyk, A. O. et al., High-Throughput Machine-Learning-Driven Synthesis of Full-Heusler 

Compounds, Chem. Mater. 28, 7324–7331 (2016). 

42.  Mansouri Tehrani, A. et al., Machine Learning Directed Search for Ultraincompressible, 

Superhard Materials, J. Am. Chem. Soc. 140, 9844–9853 (2018). 

43. 

Xie, T. and Grossman, J. C., Crystal Graph Convolutional Neural Networks for an Accurate and 

Interpretable Prediction of Material Properties, Phys. Rev. Lett. 120, 145301 (2018). 

44. 

Jung, J., Yoon, J. I., Park, H. K., Kim, J. Y. and Kim, H. S., An efficient machine learning approach to 

establish structure-property linkages, Comput. Mater. Sci. 156, 17–25 (2019). 

45. 

Ye, W., Chen, C., Wang, Z., Chu, I.-H. and Ong, S. P., Deep neural networks for accurate 

predictions of crystal stability, Nat. Commun. 9, 3800 (2018). 

46. 

DeCost, B. L. and Holm, E. A., A computer vision approach for automated analysis and 

classification of microstructural image data, Comput. Mater. Sci. 110, 126–133 (2015). 

47. 

DeCost, B. L., Francis, T. and Holm, E. A., High throughput quantitative metallography for complex 

21 

 
microstructures using deep learning: A case study in ultrahigh carbon steel, (2018). 

doi:10.2118/162526-PA 

48. 

Cowley, J. M., Goodman, P., Vainshtein, B. K., Zvyagin, B. B. and Dorset, D. L., Electron diffraction 

and electron microscopy in structure determination, in International Tables for Crystallography 

276–345, International Union of Crystallography, (2006). doi:10.1107/97809553602060000558 

49. 

LeCun, Y., Bengio, Y. and Hinton, G., Deep learning, Nature 521, 436–444 (2015). 

50. 

Rumelhart, D. E., Hinton, G. E. and Williams, R. J., Learning representations by back-propagating 

errors, Nature 323, 533–536 (1986). 

51. 

Selvaraju, R. R. et al. Grad-CAM: Visual Explanations from Deep Networks via Gradient-Based 

Localization, in Proceedings of the IEEE International Conference on Computer Vision 2017–Octob, 

618–626 (2017). 

52. 

He, K., Zhang, X., Ren, S. and Sun, J., Deep Residual Learning for Image Recognition, in 

Proceedings of the IEEE International Conference on Computer Vision, 770–778 (2016). 

53. 

Chollet, F., Xception: Deep Learning with Depthwise Separable Convolutions, in Proceedings of 

the IEEE International Conference on Computer Vision, 1251–1258 (2017). 

54. 

Kingma, D. P. and Ba, J., Adam: A Method for Stochastic Optimization, in International Conference 

on Learning Representations, 1–15 (2014). 

55. 

Abadi, M. et al., TensorFlow: A System for Large-Scale Machine Learning, in Proceedings of the 

12th USENIX Symposium on Operating Systems Design and Implementation, 265–283 (2016). 

56. 

Chollet, F. Keras. (2015), Available at: https://github.com/keras-team/keras.  

57. 

Hoffmann, F., The Space Group List Project (2014). Available at: 

https://crystalsymmetry.wordpress.com/230-2/.  

58.  Momma, K. and Izumi, F., VESTA 3 for three-dimensional visualization of crystal, volumetric and 

morphology data. J. Appl. Crystallogr. 44, 1272–1276 (2011). 

22 

 
Acknowledgements.  K.  Kaufmann  was  supported  by  the  Department  of  Defense  (DoD)  through  the 

National Defense Science and Engineering Graduate Fellowship (NDSEG) Program.  K. Kaufmann would 

also  like  to  acknowledge  the  support  of  the  ARCS  Foundation.    C.  Zhu  is  partially  sponsored  by  Joint 

DoD/DOE Munitions Technology Development Program and the Dynamic Materials Science Campaign at 

LANL.    The  authors  would  like  to  thank  Dr.  Emily  Chin  of  Scripps  Institute  of  Oceanography  and  her 

students for their assistance collecting and identifying mineral and geological samples. KV would like to 

acknowledge the financial generosity of the Oerlikon Group in support of his research group.  

Author contributions.  K. K. assisted in developing the idea, performed the bulk of the experimental work, 

worked  on  later  versions  of  the  neural  network  python  code,  and  prepared  the  initial  draft  of  the 

manuscript and figures.  C. Z. assisted with the development of the idea into a scientific study, contributed 

his knowledge of EBSD, assisted with the figures, and developed MATLAB code for phase mapping the 

machine learning predictions and pattern database management.  A. S. R. developed the initial python 

code for implementing the neural networks.  A. S. R. and D. M. managed the deployment of Grad-CAM 

tools and assisted in the analysis of the results from the deep learning models.  T. J. H. assisted K. K. with 

materials selection, fabrication, and processing.  T. J. H. also helped focus the research direction.  E. M. 

assisted K. K. with materials fabrication, processing, and analysis. K. V. led the development of the idea, 

guiding the focus of the project, and reviewed and revised the manuscript.  All the authors participated in 

analyzing and interpreting the final data.  All authors contributed to the discussions and revisions of the 

manuscript. 

Competing interests. The authors declare no competing interests. 

Correspondence and requests for materials should be addressed to K. V. 

23 

 
 
 
Extended Data: 

Extended Data Table 1 | The point groups and their respective lattices are listed with the symmetry elements 

that are present for the crystal structure. 

24 

 
 
 
 
 
25 

 
 
26 

 
 
Extended Data Fig. 1 | Confusion matrices displaying the classification results for the 14 Bravais lattices.  

A new set of diffraction patterns were classified by the ResNet50 (a) and Xception (b, c) architecture.  The 

two trained models were tested using newly collected diffraction patterns from the twenty-eight materials 

used to train the machine learning models.  The diagonal (blue shaded boxes) in these tables represent the 

successful matching of the CNN predictions to the true Bravais lattices of the sample.   

27 

 
 
 
Extended  Data  Fig.  2  |  Performance  of  the  machine  learning  model  on  data  from  new  materials.  The 

Xception  convolutional  neural  network  architecture  performs  exceedingly  well  on  electron  backscatter 

diffraction patterns collected from materials not used to train the model.  Correct classification is identified 

by the green squares instead of along the diagonal. 

28 

 
 
 
 
 
 
 
 
Extended  Data  Fig.  3  |  Demonstrations  of  machine  learning  aided  EBSD’s  capability  to  autonomously 

identify point groups in new materials. a, d, An example electron backscatter diffraction pattern for each 

of the materials. Zone axes with the same symmetry can be seen in each diffraction pattern. b, e, Results of 

training the model to discriminate between an atomically ordered and atomically disordered point group 

for  the  same  crystal  structure.  c,  f,  Resultant  confusion  matrix  after  testing  the  model  blindly  on  two 

materials from the same point groups. 

29 

 
 
 
 
 
 
 
 
Extended Data Fig. 4 | Heatmaps elucidating the normalized importance of features (dark blue to dark red) 

in each diffraction pattern for classification of the correct Bravais lattice.  One example is presented for 

each material utilized in the training set. It is observed that the symmetry features present in the image 

produce the highest activations for determining their origin Bravais lattice.  

30 

 
 
 
 
Extended Data Fig. 5 | Diagram of the materials and their Bravais lattice. For each of the fourteen Bravais 

lattices,  diffraction  patterns  from  at  least  two  materials  were  collected.    Diffraction  patterns  from 

supplementary materials in each Bravais lattice were utilized to test the performance of the model without 

it having any prior knowledge of the material. 

31 

 
 
 
 
 
 
Extended Data Fig. 6 | Annotated image of the experimental setup within the SEM chamber. The sample is 

at 70 degrees from horizontal and is facing the EBSD detector. Some of the electrons which enter the sample 

may backscatter and exit the sample at the Bragg condition of the periodic atomic lattice planes.  These 

electrons diffract to form Kikuchi bands corresponding to each of the lattice diffracting crystal planes.  Most 

commercial systems then use look-up tables of user selected phases for orientation indexing. 

32 

 
 
 
 
 
 
 
 
 
Extended Data Fig. 7 | An example diffraction pattern for each of the 28 materials used for training the 

machine  learning  model.    This  represents  just  one  of  the  infinite  number  of  orientations,  and  therefore 

diffraction patterns, the crystal can occupy in three-dimensional space. 

33 

 
 
 
 
 
 
 
 
Extended  Data  Fig.  8  |  Schematic  describing  the  process  of  training  a  machine  learning  algorithm  to 

recognize the symmetry features present in diffraction patterns.  In the presented approach, a small subset 

of the EBSD patterns were randomly selected from two materials per class and then randomly subdivided 

into a training and testing set.  The training set is then randomly divided again into a training set from which 

the  machine  learning  model  extracts  features,  and  a  validation  set  is  used  to  test  the  usefulness  of  the 

features in correctly classifying the diffraction patterns.  The feature bank is constantly tuned and evaluated 

such that the  learned features produce  the  highest accuracy  in  classifying  the  validation  set.   When  the 

machine learning algorithm determines it has found the best features for accurate classification, the learned 

filters are saved, and the predictive model can be applied to the classification of new diffraction patterns. 

34 

 
 
 
Extended  Data  Fig.  9  |  Crystal  structure  relationships  from  the  seven  crystal  systems  to  the  230  space 

groups. a, Illustration of the fourteen Bravais lattices and their associated symmetries. b, A table of the 32 

point groups and the crystal family they belong to. c, An example of each of the 230 space groups. Space 

groups represent the minute details of atomic arrangement within a point group. c) has been reproduced 

with permission from creator Frank Hoffmann under a creative commons (CC BY-NC-SA) license57 and 

the crystal structures drawn with VESTA58. 

35 

 
 
