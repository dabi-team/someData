1End-to-EndSignalClassiﬁcationinSignedCumulativeDistributionTransformSpaceAbuHasnatMohammadRubaiyat,ShiyingLi,XuwangYin,MohammadShifat-E-Rabbi,YanZhuang,andGustavoK.RohdeAbstract—Thispaperpresentsanewend-to-endsignalclassiﬁcationmethodusingthesignedcumulativedistributiontransform(SCDT).Weadoptatransport-basedgenerativemodeltodeﬁnetheclassiﬁcationproblem.WethenmakeuseofmathematicalpropertiesoftheSCDTtorendertheproblemeasierintransformdomain,andsolvefortheclassofanunknownsampleusinganearestlocalsubspace(NLS)searchalgorithminSCDTdomain.Experimentsshowthattheproposedmethodprovideshighaccuracyclassiﬁcationresultswhilebeingcomputationallycheap,dataefﬁcient,androbusttoout-of-distributionsampleswithrespecttotheexistingend-to-endclassiﬁcationmethods.TheimplementationoftheproposedmethodinPythonlanguageisintegratedasapartofthesoftwarepackagePyTransKit[1].IndexTerms—signalclassiﬁcation,timeseriesevents,generativemodel,SCDT,nearestlocalsubspace.F1INTRODUCTIONSIGNAL(timeseries)classiﬁcationisconsideredachallengingproblemindatascience.Itreferstotheautomaticpredictionoftheclasslabelofanunknowntimeserieseventusingtheinformationextractedfromthecorrespondingsignalintensities.Timeseriesdataclassiﬁcationtaskscanbefoundinmanyap-plicationssuchashumanactivityrecognition(HAR)[2],physi-ologicalsignalassessment[3][4],communications[5],structuralormachinehealthmonitoringsystems[6][7],ﬁnancialmodeling[8],andothers.Inmanyapplications(e.g.,HAR,ECG,etc.)thetimeserieseventsofinterestcanbemodeledasinstancesofacertain(oftenunknown)templateorprototypepatternobservedunderunknowntimewarps[9].Hereweproposeanewend-to-endtoolforclassiﬁcationofsignalsortimeserieseventsofthistypeusingthesignedcumulativedistributiontransform(SCDT),anewmathematicalsignaltransformintroducedin[10].Existingsignalclassiﬁcationapproachescanbecategorizedintotwobroad,andattimesoverlapping,categories:1)featureengineering-basedclassiﬁersand2)end-to-endlearningclassi-ﬁers,suchasconvolutionalneuralnetworks(CNNs).Featureengineering-basedmethods[11][12][13]usuallyrelyontheextractionofnumericalfeatures(e.g.,timedomainfeatures,fre-quencydomainfeatures,waveletfeatures)fromtherawsignaldata,andthentheapplicationofdifferentmultivariateregression-basedclassiﬁcationmethodsincludinglineardiscriminantanal-ysis,supportvectormachines,randomforests,andothers.Deeplearning-basedsignalclassiﬁcationmethods[14][15][16],ontheotherhand,connecttherawinputdatatotheoutputclasslabelbyutilizingalargenumberofhiddenlayers.Thesemethodshavewidelybeenstudiedrecentlyastheyhaveshownhighaccuracyincertainclassiﬁcationtasks.A.H.M.Rubaiyat,X.Yin,andY.ZhuangarewiththeDepartmentofElectricalandComputerEngineering,UniversityofVirginia,Charlottesville,VA22904USA(e-mail:{ar3fx,xy4cm,yz8bk}@virginia.edu).S.LiandM.Shifat-E-RabbiarewiththeDepartmentofBiomedicalEngineer-ing,UniversityofVirginia,Charlottesville,VA22908,USA(e-mail:{sl8jx,mr2kz}@virginia.edu).G.K.RohdeiswiththeDepartmentofBiomedicalEngineeringandtheDepartmentofElectricalandComputerEngineering,UniversityofVirginia,Charlottesville,VA22908,USA(e-mail:gustavo@virginia.edu).Featureengineeringsignalclassiﬁcationapproachesprimarilydifferinthetypesoffeatureschosentocharacterizeeachsignal.Thebag-of-featuresframework[17]extractsintervalfeaturesusingﬁxed-andvariable-lengthintervals,andtrainsaclassiﬁerontheextractedfeatures.Ensemble-basedapproachessuchasCOTE[18],HIVE-COTE[19],timeseriesforest(TSF)[20],andotherscombinedifferentfeaturesandclassiﬁerstoachievehighclassiﬁcationaccuracy.Mostofthesemethodsrequirecraftingespeciallydesignedfeatures(featureengineering)aswellassomeamountofdatapreprocessing.Traditionalend-to-endsignalclassiﬁcationtechniquesincludedistance-basedmethods[21][22]thatworkdirectlyonrawtimeserieswithsomesimilaritymeasuressuchasEuclideandistanceordynamictimewarping(DTW)[23].Particularly,acombinationof1-nearestneighbor(1NN)withDTWdistanceisknowntobeaveryeffectivetimeseriesclassiﬁcationapproach[24].However,itisknowntohavehighcomputationalcomplexity[25].Approachesbasedondeepneuralnetworks,especiallyconvolutionalneuralnetworks(CNN)[26],havebeenexploredinrecentyearsforend-to-endsignalclassiﬁcation.Wangetal.[27],forexample,providedthreestandarddeeplearningbenchmarkmodelsfortimeseriesclassiﬁcation:deepmultilayerperceptrons(MLP),fullyconvolutionalnetworks(FCN),andresidualnetworks(ResNet).Themethodknownasmulti-scaleconvolutionalneuralnetwork(MCNN)[28]isanotherdeeplearningapproachthattakesad-vantageofCNNsforend-to-endclassiﬁcationofunivariatetimeseries.Karimetal.[29]proposedtheLSTM-FCN,animprove-mentoverFCNbyaugmentingtheFCNmodulewithaLongShortTermRecurrentNeuralNetwork(LSTMRNN)sub-module.Thoughtheycanproduceaccurateresultsinmanyinstances,thesemethodstendtorequireextensiveamountsoftrainingdata,arecomputationallyexpensive,andoftenvulnerabletoout-of-distributionexamples.Furthermore,existingend-to-endclassiﬁersoftenlackaproperdatamodelandaclearformulationoftheclassiﬁcationproblem,makingtheclassiﬁcationmodelsdifﬁculttointerpret.Inparticular,thelackofanunderlyingmathematicalfoundationoftenleadstouncertaintyastowhichexactsituationsorapplicationstheywillwork,andwhentheywillfail.arXiv:2205.00348v2  [eess.SP]  23 Jul 20222TABLE1:DescriptionofsymbolsSymbolsDescriptions(t)Signals0(y)Referencesignaltocalculatethetransformbs(y)SCDTofsignals(t)g(t)Strictlyincreasinganddifferentiablefunctions◦gs(g(t)):compositionofs(t)withg(t)TSetofallpossibleincreasingdiffeomorphismsS/bSSetofsignals/SCDTofthesignalsInrecentyears,someefforthasbeenmadetoexploittrans-porttransformsforsignalclassiﬁcation[30]asanalternativetothetechniquesmentionedabove.Thecumulativedistributiontransform(CDT),basedonthe1DWassersteinembedding,wasintroducedin[31]asameansofclassifyingstrictlypositivesignalsfollowingthelinearoptimaltransportframeworkproposedin[32].Aldroubietal.[10]extendedtheCDTtogeneralsignedsignalsandproposedthesignedcumulativedistributiontransform(SCDT).Bothtransformshaveanumberofpropertieswhichallowonetosolvenonlinearclassiﬁcationproblemsusinglinearclassiﬁers,suchasFisherdiscriminantanalysis,supportvectormachines,orlogisticregression,insignaltransformspace.Theclassiﬁcationmethodproposedin[9]utilizesthenearestsubspacemethodtoclassifysignalsinSCDTdomain.Assumingthedatacorrespondingtoaparticularclassascompositionsofasingletemplate,thismethodformedalinearsubspaceforeachclass.Themethodweproposehereisanextensionofthisapproach.Inthispaper,weproposeanewgenerativemodeltorepresentthesignaldatasuchthatthesignalsfromeachclasscanbeseenasobservationsofasetofunknowntemplatesundersomeunknowndeformations.Wethenformulateasignalclassiﬁcationproblemforthedatathatfollowsthegenerativemodel,andemployanearestlocalsubspacesearchalgorithminSCDTdomaintodeviseasolution.Wedemonstratetheadvantagesofthemethodoverstate-of-the-artdeeplearningmethodsintermsofclassiﬁcationaccuracyona10datasetswithcomprehensiveexperiments.Theproposedmethodalsoprovidescompetitiveperformanceinclassi-fyingsignalswithverylowcomputationalcostwithrespecttoadistancebasedend-to-endsystem(1NN-DTW).Inaddition,experimentshighlightotherinterestingpropertiesofthemethodincomparisontoalternativeend-to-endsolutionsincludingdataefﬁciencyandrobustnesstoout-of-distributionconditions.Theremainingofthispaperisorganizedasfollows:insection2,webrieﬂyreviewthedeﬁnitionsandpropertiesoftheCDTandtheSCDT.Insection3,westatetheclassiﬁcationproblemandtheproposedsolution.Experimentalsetup,datasets,andresultsaredescribedinsection4,withthediscussionoftheresultsinsection5.Finally,section6providesconcludingremarks.2PRELIMINARIES2.1NotationThroughoutthemanuscript,weworkwithL1signalss,i.e.RΩs|s(t)|dt<∞,whereΩs⊆Risthedomainoverwhichsisdeﬁned.Weuses(c)j,mtorepresentasignalgeneratedfromthem-thtemplateofclasscunderdeformationgj.Wedenotethem-thtemplatefromclasscasϕ(c)m.SomesymbolsusedthroughoutthemanuscriptarelistedinTable1.2.2TheCumulativeDistributionTransformTheCumulativeDistributionTransform(CDT)wasintroducedin[31]forpositivesmoothnormalizedfunctions.Itisaninvertiblenonlinear1Dsignaltransformfromthespaceofsmoothpositiveprobabilitydensitiestothespaceofdiffeomorphisms,whichcanbedescribedasfollows:lets(t),t∈Ωsands0(y),y∈Ωs0deﬁneagivensignalandareferencesignal,respectively,suchthatRΩss(u)du=RΩs0s0(u)du=1ands0(y),s(t)>0intheirrespectivedomains.TheCDTofthesignals(t)isthendeﬁnedtobethefunctions∗(y)thatsolves,Zs∗(y)inf(Ωs)s(u)du=Zyinf(Ωs0)s0(u)du.(1)Nowconsideringthecumulativedistributionfunctions(CDFs)S(t)=Rt−∞s(u)duandS0(y)=Ry−∞s0(u)du,analternativeexpressionfors∗(y)isgivenby,s∗(y)=S−1(S0(y)).(2)TheCDTisthereforeseentoinheritthedomainofthereferencesignal.Moreover,iftheuniformreferencesignalisused(i.e.,s0(y)=1inΩs0=[0,1]),wecanwriteS0(y)=yands∗(y)=S−1(y).Thatistosay,theCDTistheinverseofthecumulativedistributionfunctionofthegivensignals(t).NotethatthedeﬁnitionoftheCDTdescribedaboveisslightlydifferentfromtheformulationusedin[31].Forsimplicity,hereweusetheCDTdeﬁnitiondescribedin[33].TheCDTisinvertible,andtheinverseformulaisdeﬁnedindifferentialformas:s(t)=(cid:16)s∗−1(t)(cid:17)0s0(s∗−1(t)).(3)AlthoughtheCDTcanbeusedinsolvingmanyclassiﬁcation[31]andestimation[33]problems,theframeworkdescribedaboveisdeﬁnedonlyforpositivedensityfunctions.Aldroubietal.[10]extendedtheCDTtogeneralﬁnitesignedsignalsandnamedthenewsignaltransformationtechniqueasthesignedcumulativedistributiontransform(SCDT).2.3TheSignedCumulativeDistributionTransformThesignedcumulativedistributiontransform(SCDT)[10]isanextensionoftheCDT,whichisdeﬁnedforgeneralﬁnitesignedsignalswithnorequirementsonthetotalmass.First,thetransformisdeﬁnedforthenon-negativesignals(t)witharbitrarymassas:bs(y)=((s∗(y),kskL1),ifs6=0(0,0),ifs=0,(4)wherekskL1istheL1normofsignalsands∗istheCDT(deﬁnedineqn.(2))ofthenormalizedsignal1kskL1s.Nowforasignedsignal,theJordandecomposition[34]isusedtodeﬁnethetransform.TheJordandecompositionofasignedsignals(t)isgivenbys(t)=s+(t)−s−(t),wheres+(t)ands−(t)aretheabsolutevaluesofthepositiveandnegativepartsofthesignals(t).TheSCDTofs(t)isthendeﬁnedas:bs(y)=(cid:0)bs+(y),bs−(y)(cid:1),(5)wherebs+(y)andbs−(y)arethetransforms(deﬁnedineqn.(4))forthesignalss+(t)ands−(t),respectively.Fig.1showsan3Fig.1:SCDT(withouttheconstantterms)ofanexamplesignal.exampleoftheSCDTofasignal.LiketheCDT,theSCDTisalsoaninvertibleoperation,withtheinversebeing,s(t)=ks+kL1(cid:16)(s+)∗−1(t)(cid:17)0s0((s+)∗−1(t))−ks−kL1(cid:16)(s−)∗−1(t)(cid:17)0s0((s−)∗−1(t)).(6)Moreover,theSCDThasanumberofpropertiesthatwillhelpussimplifythesignalclassiﬁcationproblems.2.3.1CompositionpropertyIftheSCDTofasignedsignalsisdenotedasbs,theSCDTofthesignalsg=g0s◦gisgivenby:bsg=(cid:0)g−1◦(s+)∗,ks+kL1,g−1◦(s−)∗,ks−kL1(cid:1),(7)where,g(t)isaninvertibleanddifferentiableincreasingfunction,s◦g=s(g(t)),andg0(t)=dg(t)/dt[10].Forexample,incaseofshiftandlineardispersion(i.e.,g(t)=ωt−τ)ofagivensignals(t),theSCDTofthesignalsg(t)=ωs(ωt−µ)canbederivedfromcompositionpropertyas:bsg=(cid:18)(s+)∗+µω,ks+kL1,(s−)∗+µω,ks−kL1(cid:19).Thecompositionpropertyimpliesthatvariationsalongtheinde-pendentvariablecausedbyg(t)willchangeonlythedependentvariableinthetransformdomain.2.3.2ConvexitypropertyLetS={sj|sj=g0jϕ◦gj,∀gj∈G}beasetofsignals,whereϕisagivensignalandG⊂Tdenotesasetof1Dspatialdeformationsofaspeciﬁckind(e.g.,translation,dilation,etc.).TheconvexitypropertyoftheSCDT[10]statesthatthesetbS={bsj:sj∈S}isconvexforeveryϕifandonlyifG−1={g−1j:gj∈G}isconvex.ThesetSdeﬁnedabovecanbeinterpretedasagenerativemodelforasignalclasswhileϕbeingthetemplatesignalcorrespondingtothatclass.Inthenextsectionwedescribeagenerativemodel-basedproblemformulationfortimeserieseventclassiﬁcation,andthenshowhowthecompositionandconvexitypropertiesoftheSCDThelpfacilitatesignalclassiﬁcation.3PROPOSEDMETHOD3.1GenerativemodelandproblemstatementIn[9],agenerativemodel-basedproblemstatementwasproposedforsignalclassiﬁcationproblemswhereeachsignalclasscanbemodeledasinstancesofacertaintemplateobservedundersomeunknowndeformations(e.g.,translation,dispersion,etc.).Signalclassesofsuchtypecanbedescribedwiththefollowinggenerativemodel:Fig.2:Generativemodelexampleforasignalclass‘c’.ThesetofallsignalsfromclasscisdenotedasS(c),whichismodeledastheunionofsubsetsSϕ(c)m,G(c)m(form=1,2)containingdatageneratedfromatemplateϕ(c)munderdeformationG(c)m.3.1.1Generativemodel(singletemplate)LetG(c)⊂Tdenoteasetofincreasing1Ddeformationsofaspeciﬁckind,whereTisasetofallpossibleincreasingdiffeomorphismsfromRtoR.The1Dmasspreservinggenerativemodelforclasscisthendeﬁnedtobetheset:S(c)={s(c)j|s(c)j=g0jϕ(c)◦gj,gj∈G(c),g0j>0},(8)wheres(c)jisthej-thsignalfromclassc,andϕ(c)isthetemplatepatterncorrespondingtothatclass.However,inmanyapplicationsitisdifﬁculttoﬁndasignalclassthatcanberepresentedusingthesingletemplate-basedgenerativemodeldeﬁnedabove.Inthispaper,weuseamultipletemplate-basedgenerativemodeltorepresentsuchsignalclasses.3.1.2Generativemodel(multipletemplates)Forasetofincreasing1DspatialdeformationsdenotedasG(c)m⊂T,the1Dmasspreservinggenerativemodelforclasscisdeﬁnedtobetheset:S(c)=Mc[m=1Sϕ(c)m,G(c)m,Sϕ(c)m,G(c)m=ns(c)j,m|s(c)j,m=g0jϕ(c)m◦gj,g0j>0,gj∈G(c)mo,(cid:16)G(c)m(cid:17)−1=(kXi=1αif(c)i,m,αi≥0),(9)wherenf(c)1,m,f(c)2,m,...,f(c)k,modenotesasetoflinearlyindependentandstrictlyincreasing(withinthedomainofthesignals)functions.MeaningthegenerativemodelforclasscismodeledastheunionofMcsubsets,whereeachsubset(Sϕ(c)m,G(c)m)correspondstodatageneratedfromaparticulartemplate(ϕ(c)m)undersometimedeformations(G(c)m).Here,Mcisthetotalnumberoftemplatesusedtorepresentclassc,ϕ(c)misthem-thtemplatesignalfromclassc,ands(c)j,misthej-thsignalgeneratedfromm-thtemplateunderdeformationdeﬁnedbygj.Fig.2illustratesafewexamplesofsuchdeformations.4Fig.3:Geometricinterpretationofdatafollowingtheproposedgenerativemodeldeﬁnedinequations(9)and(10).Ontheleftpanel,twoclasses(S(1)andS(2))aredepictedinsignalspace.ThesetS(c)forclasscismodeledastheunionoftwosubsets:Sϕ(c)1,G(c)1andSϕ(c)2,G(c)2,c=1,2,whereboththesubsetsarenon-convex.TherightpanelshowsthegeometryofthesignalclassesinSCDTdomainmodeledastheunionofconvex(forconvex(G(c)1)−1and(G(c)2)−1asdeﬁnedin(9))subsets:bSϕ(c)1,G(c)1andbSϕ(c)2,G(c)2forc=1,2.Consideringthegenerativemodel,theclassiﬁcationproblemcanbedeﬁnedasfollows:Classiﬁcationproblem:LetG(c)m⊂TbeasetofspatialdeformationsandS(c)bedeﬁnedasineq.(9),forclassesc=1,···,Nc.Givenasetoftrainingsamples{s(c)1,s(c)2,...}⊂S(c)forclassc,determinetheclasslabelofanunknownsignals.3.2ProposedsolutionWeproposeasolutiontotheclassiﬁcationproblemdeﬁnedaboveusingtheSCDTincombinationwiththenearestlocalsubspacemethod.Foragiventestsample,thealgorithmﬁrstsearchesforkclosesttrainingsamples(fromaparticularclass)tothetestsignalinSCDTdomainbasedonadistancedeﬁnitionspeciﬁedlater.Next,alocalsubspaceisspannedbythesesamplesforeachclass.TheunknownclasslabelofthetestsampleisthenestimatedbasedontheshortestdistancefromtheSCDTofthetestsignaltotheselocalsubspaces.Asstatedin[9]and[35],thegenerativemodeldescribedineq.(9)generallyyieldsnonconvexsignalclasses,causingtheaboveclassiﬁcationproblemtobedifﬁculttosolve.Asspeciﬁedaboveinsection2.3.2(see[10]formoredetails),undercertainassumptions,thegeometryofthesignalclasscanbesimpliﬁed.Hence,theproposedsolutionbeginswithapplyingtheSCDTdeﬁnedineq.(5)ontheinputsignals.Thegenerativemodelinthetransformdomainisthengivenby,bS(c)=Mc[m=1bSϕ(c)m,G(c)m,bSϕ(c)m,G(c)m=nbs(c)j,m|bs(c)j,m=g−1j◦bϕ(c)m,gj∈G(c)mo,(cid:16)G(c)m(cid:17)−1=(kXi=1αif(c)i,m,αi≥0),(10)whereg−1j◦bϕ(c)mistheSCDTofthesignalg0jϕ(c)m◦gj.Here,theset(cid:16)G(c)m(cid:17)−1isconvexbydeﬁnition.Therefore,usingthecon-vexitypropertyhighlightedearlier,itcanbeshownthatbSϕ(c)m,G(c)mgivenineq.(10)formsaconvexset.Moreover,sincetheSCDTisaone-to-onemap,itfollowsthatifSϕ(c)m,G(c)m∩Sϕ(p)w,G(p)w=∅forc6=p,thenbSϕ(c)m,G(c)m∩bSϕ(p)w,G(p)w=∅.Fig.3illustratesthegeometryofsignalclassesthatfollowtheproposedgenerativemodeldeﬁnedinequations(9)and(10)correspondingtosignalandSCDTdomains,respectively.Toformulatethesolutionoftheproblemdeﬁnedabove,weadaptthesubspace-basedtechniqueproposedin[9]forthemultipletemplate-basedgenerativemodel.First,LetusdeﬁneasubspacegeneratedbytheconvexsetbSϕ(c)m,G(c)mas:bV(c)m=span(cid:16)bSϕ(c)m,G(c)m(cid:17).(11)SincebSϕ(c)m,G(c)m∩bSϕ(p)w,G(p)w=∅(whenc6=p)and(cid:16)G(c)m(cid:17)−1isconvexbydeﬁnition,itisreasonabletoassumethatbS(c)∩bV(p)w=∅foranyw=1,...,Mp(seeAppendixAinsupplementarymaterialsformoreexplanation).Now,ifatestsamplesisgeneratedaccordingtothegenerativemodeldeﬁnedineq.(9),thenthereexistacertainclass‘c’andacertaintemplateϕ(c)mforwhichd2(bs,bV(c)m)=0.Here,bsistheSCDTofthetestsamples,andd2(bs,bV(c)m)istheEuclideandistancebetweenbsandthenearestpointinsubspacebV(c)m.Italsofollows,d2(bs,bV(p)w)>0whenp6=c.Therefore,undertheassumptionthatthetestsamplesisgeneratedaccordingtothegenerativemodelforoneofthe(unknown)classes,theunknownclasslabelcanbeuniquelypredictedbysolving,argmincminmd2(cid:16)bs,bV(c)m(cid:17),(12)5wherebV(c)misgivenbyeq.(11).Theproposedalgorithmtosolvetheclassiﬁcationproblemisoutlinedbelow.3.3Algorithm:nearestlocalsubspaceinSCDTdomainInthesignalclassiﬁcationtasksconsideredbelow,asusuallythecase,thetemplateϕ(c)mandthedeformationsetG(c)mareusuallyunknown.ThereforethesubsetbSϕ(c)m,G(c)misalsounknown;hence,wecannotreadilyestimatebV(c)musingeq.(11).HerewedeviseanalgorithmtoapproximatebV(c)musingtrainingsamplesfromclassc.LetusassumethatthetestsamplesisgeneratedaccordingtothegenerativemodelSϕ(c)m,G(c)m.Fromeq.(10),Sϕ(c)m,G(c)mcanbedeﬁnedintheSCDTdomainas:bSϕ(c)m,G(c)m=( kXi=1αif(c)i,m!◦bϕ(c)m,αi≥0),wherenf(c)1,m,f(c)2,m,...,f(c)k,moisasetofklinearlyindependentincreasingfunctions.Fromthisdeﬁnition,itisevidentthatbV(c)m(asdeﬁnedineq.(11))isakdimensionalspace.Therefore,ifweweretoestimatethisspan,wewouldneedatleastklinearlyindependentelementsfromthesetbSϕ(c)m,G(c)mtomodelit.SincewedonothavetheknowledgeofbSϕ(c)m,G(c)m,weemployanearestlocalsubspace(NLS)searchalgorithminSCDTdomaintoapproximatebV(c)m.LetusdenotetheestimatedlocalsubspaceforclasscasebV(c)m.Thesolutiontotheproblemdeﬁnedineq.(12)isthenestimatedbysolving,argmincd2(cid:18)bs,ebV(c)m(cid:19).(13)Considerasetoftrainingsamplesns(c)1,...,s(c)j,...,s(c)Lco⊂S(c)forclassc,whereLcisthetotalnumberoftrainingsamplesgivenforclasscands(c)jisthej-thsample.Theunknownclassofatestsamplesisestimatedintwosteps:Step1:Wesearchforthekclosesttrainingsamplestobsfromclasscbasedonthedistancebetweenbsandthespanofeachtrainingsample.First,wesorttheelementsfromtheset{bs(c)1,...,bs(c)Lc}into{bz(c)1,...,bz(c)Lc}suchthatd2(bs,bV(c)z1)≤···≤d2(bs,bV(c)zl)≤···,(14)wherebV(c)zl=span(cid:16){bz(c)l}(cid:17).Thenwepicktheﬁrstkelementsfromthesortedsettoform{bz(c)1,···,bz(c)k}fork≤Lc,whichgivesthesetofkclosesttrainingsamplestobsfromclasscintheabovesense(Fig.4b-4c).Werepeatthisstepforallotherclasses(Fig.4d).Step2:ComputeebV(c)mby:ebV(c)m=span(cid:16){bz(c)1,···,bz(c)k}(cid:17),(15)whichapproximatesthenearestlocalsubspacefromclasscwithrespecttobs.Wethenpredicttheunknownclassofthetestsamplesbysolvingeq.(13).Fig.4eillustratesthesecondstep.Notethatsimilarlocalsubspaceclassiﬁcationtechniquescanbefoundintheliterature[36][37].Here,weemploythenearestlocalsubspacesearchtechniqueintheSCDTdomaintoexploitthepropertiesoftheSCDTthatsimplifytheclassiﬁcationproblemdescribedabove.Next,weshowthattheperformanceoftheclassiﬁercanfurtherbeimprovedbyutilizingthecompositionpropertyoftheSCDTthroughanalyticalenrichmentofthesubspacemethod.3.3.1SubspaceenrichmentThealgorithmoutlinedabovesearchesforthekclosesttrainingsamplestoagiventestsampleinSCDTdomain,andthenformsalocalsubspaceusingtheseksamples.Inspiredby[35],[38],hereweadaptthetechniquetomathematicallyenrichtheensuingsubspacewithcertainprescribeddeformations.HereweenrichebV(c)minsuchawaythatitwillautomaticallyincludethesamplesundergoingcertaintimedeformations.Thespanningsetscorrespondingtocertainspeciﬁcdeformationsarederivedbelow:•Translation:Incaseoftranslation,g(t)isgivenbyt−µ,whereµ∈Risthetranslationparameter.UsingthecompositionpropertyoftheSCDT,thetransformofthetranslatedsignalsg(t)=s(t−µ)isgivenbybsg=((s+)∗+µ,ks+kL1,(s−)∗+µ,ks−kL1).Itim-pliesthatthetranslationappliedtothesignalalongtheindependentaxisresultsintranslationalongthedependentaxisinSCDTdomain.Hence,thespanningsetfortrans-lationisdeﬁnedasUT={u(t)},whereu(t)=1.•Dilation:Atime-dilated(scaled)versionofasignals(t)isdeﬁnedas:sg(t)=αs(αt),α∈R+.Thetransformofthesignalsg(t)isgivenby:bsg=(cid:16)(s+)∗α,ks+kL1,(s−)∗α,ks−kL1,(cid:17).Anadditionalspan-ningsetisnotrequiredfordilation,asitisinherentinthemodelingofthesubspace.•Time-warpingsotherthantranslationanddilationarealsoobservedincertainclassiﬁcationproblems.ToincludethosedeformationsintheSCDTdomain,weapproximatetheincreasingfunctiong−1◦bz(c)las:g−1◦bz(c)l=NPn=−Ncnζn(bz(c)l)forn6=0c0bz(c)lforn=0(16)where,cn>0,PNn=−Ncn=1,andζn(bz(c)l)="bz(c)l−sinnπbz(c)l|n|π#.Fortheset{bz(c)1,···,bz(c)k}fromeq.(15),thespanningsetisgivenbythesetUH={ζn(bz(c)1),...,ζn(bz(c)k)},forn=−N,...,−1,1,...,N.Inlightofthediscussionabove,thesubspaceebV(c)mineq.(15)canbeenrichedasfollows:ebV(c)m=span(cid:16){bz(c)1,···,bz(c)k}∪UT∪UH(cid:17).(17)NotethatthesubspacebV(c)zlin(14)canalsobeenrichedinsimilarmanner,i.e.bV(c)zl=span(cid:16){bz(c)l}∪UT∪UH(cid:17),whereUH={ζn(bz(c)l)},forn=−N,...,−1,1,...,N.3.3.2TrainingphaseInthetrainingphaseofthealgorithm,thesubspacecorrespondingtoeachoftrainingsampleiscalculated.TheﬁrststepistocomputeSCDTsforalltrainingsamplesfromclassc.Then,wetakeatrainingsamplebs(c)landorthogonalize{bs(c)l}∪UT∪UHtoobtainthebasisvectorsthatspantheenrichedsubspacecorrespondingtothatsample.LetB(c)l=hb(c)l,1,b(c)l,2,...ibeamatrixthatcontainsthebasisvectorsinitscolumn.Werepeatthesecalculationsfor6Fig.4:Outlineofproposedalgorithm:(a)applySCDTonthetestsignalstoobtainbs,(b)measuredistancebetweenbsandsubspacecorrespondingtoeachtrainingsamplefromaparticularclass(class-1inthisexample),(c)ﬁndkclosesttrainingsamples(k=2inthisexample)tobsfromclass-1,(d)repeatpreviousstepsforotherclasses(class-2inthisexample),(e)buildlocalsubspaceforeachclassusingtheksamplesfoundinpreviousstepsandsearchforthenearestlocalsubspacetopredicttheclassofs.allthetrainingsamplestoformB(c)lforl=1,2,...,Lcandc=1,2,...,etc.3.3.3TestingphaseThetestingalgorithmbeginswithtakingSCDTofthetestsamplestoobtainbsfollowedbythenearestlocalsubspacesearchinSCDTdomain.Intheﬁrststepofthealgorithm,weestimatethedistanceofthesubspacecorrespondingtoeachofthetrainingsamplesfrombsby:(cid:15)l=kbs−B(c)lB(c)Tlbsk2,l=1,2,...,Lc,wherek.kdenotesL2norm.NotethatB(c)lB(c)Tlistheorthog-onalprojectionmatrixontothespacegeneratedbythespanofthecolumnsofB(c)l(computedinthetrainingphase).Wethenﬁnd{bz(c)1,···,bz(c)k},asetofkclosesttrainingsamplestothetestsamplebsfromclassc,basedonthedistances(cid:15)1,...,(cid:15)Lc.Inthenextstep,weorthogonalize{bz(c)1,···,bz(c)k}∪UT∪UHtoobtainthebasisvectors{b(c)1,b(c)2,...}spanningthelocalsubspacefromclasscwithrespecttobs.LetB(c)=hb(c)1,b(c)2,...iforc=1,2,...,etc.Theunknownclassofsisthenestimatedby:argminckbs−B(c)B(c)Tbsk.(18)NotethattheproposedalgorithmrequirestwoparameterskandN(seeeq.(16))tobetunedpriortothetestingphase.Weuseavalidationsetsplitfromthetrainingsettoestimatetheoptimumvaluesfortheseparameters.WethenfollowthestepsoftheproposedalgorithmoutlinedabovewiththevalidationsetforvaryingkandN.Parametervaluescorrespondingtothebestvalidationaccuracyarechosentobeusedinthetestingphase.Thisstepisdoneduringthetrainingphase.3.4Proof-of-conceptsimulationTodemonstratetheefﬁcacyoftheproposedalgorithminsolvingtheclassiﬁcationproblemstatedinsection3.1weperformedasimulatedexperiment.WetooksixprototypesignalsshowninFig.5asthetemplates(ϕ(c)m)correspondingtothreedifferentclasses(c=1,2,3),i.e.,eachclasshastwotemplates(m=1,2).Wethengeneratedasyntheticdatasetbyapplyingspeciﬁctimedeformationsontheprototypesignalsasfollows:s(c)j=g0j(t)ϕ(c)m(gj(t)),gj(t)=ωζ(t)+τ,g0j(t)>0,ζ0(t)=∂∂tζ(t)=NXn=1αn1√2πwne−12(t−µnwn)2(19)7Fig.5:Asimulatedexperimenttodemonstratetheefﬁcacyoftheproposedmethodinclassifyingsignalclassesthatfollowthegenerativemodeldeﬁnedineq.(9).whereαn>0,Pnαn=1andtheparametervaluesusedtocalculategj(t)arerandomlychosenfromﬁxedintervals.Thedatasetwasequallysplitintotrainingandtestingsets.Theproposedclassiﬁcationmethodwasthentrainedwithavaryingnumberoftrainingsamplesperclassrandomlychosenfromthetrainingsetandevaluatedonthetestingset.Notethatthesampleswerechoseninsuchawaythatthetrainingsetcontainsanequalnumberofsamplesgeneratedfromeachtemplate.Fig.5showsthetestaccuracyplotswithrespecttothenumberoftrainingsamplesperclass.Itdemonstratesthattheproposedmethodachievestheperfectclassiﬁcationaccuracywithfewtrainingsamples(obtained99.97%testaccuracywithonly16trainingsamplesperclass),whilesomealternativeend-to-endsystems(discussedinnextsection)failtoachievesuchperformanceevenwithhighernumberoftrainingdata.Thatmeans,ifthesignalclassesfollowthegenerativemodeldeﬁnedineq.(9),theproposedmethodsolvesthesignalclassiﬁcationproblemstatedinsection3.1.4EXPERIMENTSANDRESULTS4.1ExperimentalsetupThegoalistoevaluatetheperformanceoftheproposedgenericend-to-endclassiﬁerwithrespecttoselectedstate-of-the-artend-to-endtimeseriesclassiﬁcationtechniques.Theclassiﬁcationperformanceofthedifferentmethodswerestudiedintermsoftestaccuracy,dataefﬁciency,computationalefﬁciency,androbustnesstotheout-of-distributionsamples.Weconductedexperimentsonseveraltimeseriesdataandcomparedtheresultsagainstseveralmethods:MultilayerPerceptrons(MLP)[39],1DVisualGeometryGroup(VGG)[39],1DResidualNetwork(ResNet)[40][39],LongShortTermMemory(LSTM)[41][39],LongShortTermMemoryFullyConvolutionalNetwork(LSTM-FCN)[29][39],and1-nearestneighborDTW(1NN-DTW)[24].Fortheneuralnetworkmethods,weusedtheimplementationsoutlinedin[39]withoutanydataaugmentation.Duringthetrainingprocess,10%ofthetrainingsampleswereusedasthevalidationset,andthetestperformancewasreportedbasedonthemodelthathadthebestvalidationperformance.Incaseofthe1NN-DTWmethod,thevalidationsetwasusedtotunetheparametercorrespondingtothewarpingwindowsize.Toshowtheefﬁcacyoftheproposedmultipletemplate-basedgenerativemodel(deﬁnedineq.(9))overthesingletemplate-basedmodel(eq.(8)),wealsocomparedtheresultsagainsttheSCDT-NSclassiﬁer[9]proposedearlier.Wefollowedthetrainingandtestingproceduresoutlinedintheprevioussectionfortheproposedmethod.Theorthogonalizationoperationswereperformedusingsingularvaluedecomposition(SVD).TheleftsingularvectorsobtainedbytheSVDswereusedtoconstructthematricesB(c)landB(c).Following[35],thenumberofthebasisvectorswaschoseninsuchawaythatthesumofvariancesexplainedbytheselectedbasisvectorscapturesatleast99%ofthetotalvarianceexplainedbyallthesamplesinthesortedset{bz(c)1,···,bz(c)k}.TheSCDTswerecomputedwithrespecttoa1Duniformprobabilitydensityfunction.4.2DatasetsToevaluatethecomparativeperformanceoftheproposedmethodwithrespecttootherend-to-endclassiﬁersweselectedmultipledatasetswithsignalclassesrepresentingwell-deﬁnedtimeseriesevents.Forexample,theaccelerometerdataplottedinFig.6(a)representparticularhandgestures.Similarly,signalsshowninFig.6(i)representeithernormalorabnormalheartbeats.Withafocustowardsthiscondition,weidentiﬁed10differenttimeseriesdatasets,8ofwhichweredownloadedfromtheUCRtimeseriesclassiﬁcationarchive[42].SomeexamplesignalsfromthesedatasetsareshowninFig.6.Detailsaboutthedatasetsaregivenbelow:•GesturePebbleZ2[43]:AccelerometerdatacollectedusingPebblesmartwatchfrom4differentpersonsperforming6handgestures.(classes:6,trainsamples:22∼25perclass,testsamples:25∼32perclass).•InsectEPGRegularTrain[44]:Containselectricalpenetra-tiongraph(EPG)datawhichcapturevoltagechangesoftheelectricalcircuitthatconnectsinsectsandtheirfoodsource.(classes:2,trainsamples:22∼30perclass,testsamples:89∼118perclass).•PLAID:PlugLoadApplianceIdentiﬁcationDataset[45].Thedataareintendedforloadidentiﬁcationresearchusingtransientvoltage/currentmeasurementsfrom11differentappliancetypes.(classes:11,trainsamples:13∼88perclass,testsamples:13∼87perclass).•UWaveGestureLibraryAll[46]:Asetofeightsimpleges-turesgeneratedfromaccelerometersusingWiiremote.(classes:8,trainsamples:100∼127perclass,testsamples:433∼460perclass).•Wafer[47]:Acollectionofinlineprocesscontrolmea-surementsrecordedfromvarioussensorsduringthepro-cessingofsiliconwafers.Thetwoclassesarenormalandabnormal,withasigniﬁcantclassimbalance.Hence,asubsetoftheoriginaldatasetisusedtoensuretheclassbalance.(classes:2,trainsamples:97∼100perclass,testsamples:665∼700perclass).•StarLightCurves[48]:Collectionoftimeseriessignalsrepresentingthebrightnessofcelestialobjectsasafunc-tionoftime.(classes:3,trainsamples:150perclass,testsamples:500perclass).•TwoPatterns[49]:Asimulateddataset(classes:4,trainsamples:237∼271perclass,testsamples:959∼1035perclass).8•ECG5000[42]:AsubsetofBIDMCCongestiveHeartFailureDatabase(CHFDB)downloadedfromPhysioNet.Withapurposeofevaluatingthemethodstrainedwithalargeset,weinterchangedthetrainandtestsetsoftheoriginaldataset.(classes:2,trainsamples:1873∼2627perclass,testsamples:208∼292perclass).•ECG(MLII)[50]:Asubsetofapubliclyavailabledatasetreportedin[51].TheECGsignalswerecollectedfromthePhysioNetMIT-BIHArrythmiadatabase[52].Amethoddescribedin[53]wasusedtosegmenttheheartbeatsfromtheECGfragments.(classes:3,trainsamples:200perclass,testsamples:200perclass).•ConnectionistBench(Sonar,Minesvs.Rocks)[54][55]:Thisdatasetcontainsenergypatterns(withrespecttofrequencybands)ofthesignalsobtainedbybouncingsonarsignalsoffametalcylinderandsomerocksatvariousanglesandundervariousconditions.(classes:2,trainsamples:49∼55perclass,testsamples:48∼56).Inadditiontothedatasetslistedabove,wehaveusedanotherdatasetwheretimeserieseventsarenotwell-deﬁnedasanexam-plewheretheproposedmethodisnotexpectedtoworkwell.Wehaveusedthegearboxfaultdiagnosisdata[56],acollectionofvibrationsignalsrecordedbyusingSpectraQuest’sGearboxFaultDiagnosticsSimulator.Thedatasetwasrecordedintwodifferentscenarios:1)healthyand2)brokentoothconditions.4.3TestaccuracyTodemonstratetheefﬁcacyoftheproposedmethodasagenericclassiﬁer,weappliedittothedatasetslistedaboveandcomparedthetestaccuraciesagainsttheaforementionedend-to-endclassi-ﬁcationmethods.Table2showstheresultsandacomprehensivecomparisonwithﬁveneuralnetwork-basedclassiﬁers,1NN-DTW,andSCDT-NS.Theresultsreportedinthetableshowthatinmostofthedatasets(8outof10),theproposedmethodoutperformedthedeeplearningmethodsandprovidedcompetitivetestaccuracywithrespectto1NN-DTW.Theaveragearithmeticandgeometricrankingsalsodemonstratetheefﬁcacyoftheproposedmethodasagenericend-to-endtechniquetoclassifysegmentabletimeseriesevents.Besidestestaccuracyandrank-basedstatistics,wealsocalcu-latedmeanperclasserror(MPCE)foreachmethod.Thismetricwasproposedin[27]toevaluatetheperformanceofagenericclassiﬁeronmultipledatasets.MPCEisdeﬁnedasthearithmeticmeanoftheperclasserror(PCE)whichiscalculatedfori-thmodelonj-thdatasetas:PCEi,j=ei,jcj.Hereei,jistheerrorrateofi-thmodelonj-thdataset,andcjisthetotalnumberofclassespresentinj-thdataset.MPCEforthecorrespondingmodelisgivenby,MPCEi=1JJXj=1PCEi,j,whereJisthetotalnumberofdatasetsusedintheexperiment.TheMPCEvaluesreportedinTable2indicatethattheproposedmethodgeneratestheleastexpectederrorrateperclassacrossallthedatasetsincomparisontootherclassiﬁers.4.4DataefﬁciencyToshowthedataefﬁciencyoftheproposedmethod,wesetupanexperimentwherewetrainedthemodelswithavaryingnumberoftrainingsamplesperclass.Foratrainingsplitofaparticularsize,itssampleswererandomlydrawnfromtheoriginaltrainingset,andtheexperimentsforthisparticularsizewererepeated10times.Fig.7showsaverageaccuracieswithrespecttothenumberoftrainingsamplesperclassfortwodatasets:UWaveGestureLibraryAllandTwoPatterns.Thestandarddeviationforeachsplitisalsoshownusingtheerrorbar.Theplotsillustratethattheproposedmethodachieveshigheraccuracythanthedeeplearningmethodswithfewertrainingsamples.Similarresultscanbeseeninotherdatasetsaswell(seeAppendixBinsupplementarymaterials).4.5ComputationalefﬁciencyTheproposedclassiﬁcationtechniqueisnotonlyeffectiveinclas-sifyingtimeserieseventsbutalsocomputationallyveryefﬁcient.Fig.8showsthecomputationalcomplexityplotsoftheproposedmethodand1NN-DTWasafunctionofnumberoftrainingsamplesperclassforTwoPatternsdataset.ItdemonstratesthattheproposedclassiﬁerrequireslessCPUoperationsincomparisonto1NN-DTW.Fig.9(upperpanel)plotstheaveragetime(inseconds)requiredduringthetrainingphaseasafunctionofaccuracyforeachmethod.Itillustratesthatallthealternativeend-to-endsolutionsrequiregreaternumberofcomputationstotrainthemodelswithrespecttotheproposedsolutiontoachievesamelevelofaccuracy.Despitethefactthatourmethodsearchesfork-closesttrainingsamplesforagiventestsignal,itstillprovidescompetitiveperformanceasshowninFig.9(lowerpanel)intermsoftesttimeincomparisontodeeplearning-basedmethods.Theplotsoftheaveragetime(inseconds)takenbytheclassiﬁcationmethodstotestasignalfromTwoPatternsdatasetshowthatthetesttimeoftheproposedmethodisclosetotheneuralnetwork-basedclassiﬁers,while1NN-DTWishighlyexpensiveintermsofcomputationduringtestingphase.NotethattheSCDTiscurrentlyimplementedwithforloopsinpython,whichislessthanidealintermsofexecutiontime.Acompiledlanguage(e.g.C,C++)wouldexecuteforloopsmuchfaster.4.6Robusttoout-of-distributionsamplesTodemonstratetherobustnesstoout-of-distributionexamples,weadoptedasimilarconceptusedin[9].Wegeneratedasyntheticdatasetbyapplyingtimedeformationsdeﬁnedineq.(19)onthreeprototypesignals:aGaborwave,anapodizedsawtoothwave,andanapodizedsquarewave(showninthetoprowofFig.7).Notethatweusedasingletemplateperclasstogeneratedataformaintainingasimpleexperimentalsetup.Wevariedthemagnitudeoftheconfoundingfactors(i.e.,theparametersusedtocalculategj(t))togeneratedifferentdistributionsfortrainingandtestingsets.The‘in-distribution’setusedduringthetrainingprocessconsistedofsignalswithparametervalueschosenrandomlyfromsmallerintervalswithrespecttothe‘out-distribution’(testing)set.Table3showsthelistoftheparametersofinterestforthe‘out-of-distribution’experiment.Theintervals(fromwhichtheparametervalueswerechosen)correspondingtothetrainingandtestingsetsarealsogiveninthetable.Fig.10showstestaccuracieswithrespecttothenumberoftrainingsamplesperclassforthecomparingmethods.Theplotshowsthattheproposedmethodsigniﬁcantlyoutperformsotherend-to-endsolutionswithveryfewtrainingsamples.Meaning,theproposedclassiﬁcationtechniqueprovidesthebestclassiﬁcationresultifthetestsignalbelongstothe‘out-distribution’setintheabovesensebutfollowsthegenerativemodeldiscussedintheprevioussection.9Fig.6:Someexamplesignalsfromthedatasetsusedtoevaluatetheproposedmethod.DatasetMLP1D-VGG1D-ResNetLSTMLSTM-FCNSCDT-NS1NN-DTWProposedGesturePebbleZ283.9248.9963.2360.1985.8281.6494.9494.30InsectEPGRegularTrain80.9282.0750.5857.0559.9573.4382.6190.82PLAID39.6519.3529.8126.3539.5758.2973.5670.95UWaveGestureLibraryAll94.7496.4242.8630.7294.1690.494.2294.95Wafer68.6994.0353.6651.3686.7092.7598.1695.60StarLightCurves75.8570.056.5360.5474.3877.483.8084.2TwoPatterns88.1295.1587.4280.6298.4795.1599.9099.92ECG500098.998.9298.9298.3698.7693.499.297.6ECG(MLII)33.3333.3356.5544.2066.4256.6745.6768.83Sonar68.3680.5753.8553.8553.8561.5476.9278.85Win02000044AVGarithmeticranking4.64.36.17.04.74.72.22.2AVGgeometricranking4.463.385.736.944.44.481.851.84MPCE0.0840.0720.1230.1280.0790.0710.0490.038TABLE2:Testaccuracy(%),rank-basedstatistics,andMPCEcalculatedfortheclassiﬁersacrossdifferentdatasets.ParameterTrainTestN[2,5][2,10]µnN(0.5,0.2)N(0.5,0.3)ω[0.9,1.1][0.75,1.25]τ[−0.05,0.05][−0.1,0.1]TABLE3:Intervalsusedintheout-of-distributionsetup.4.7AdatasetthatdoesnotfollowgenerativemodelAsdescribedin4.2,theproposedmethodperformswellifthetimeseriesdataiswellsegmented,i.e.containseventswithwell-deﬁnedstartandendpoints.Thereareexamplesofsignalclassiﬁcationproblemswheredatadonotfollowtheseconditions.Onesuchexampleisthegearboxfaultdiagnosisdataset[56],wherevibrationsignalsareusedtodetectafaultygearbox.Fig.11(a)showsthatthevibrationsignalsdonotpossesssegmentabletimeseriesevents.Hence,theproposedmethodisnotsuitableforclassifyingrawgearboxvibrationdata,asshowninthetableinFig.11.However,wecantransformeachtimeseriestofrequencydomainusingtheFouriertransform[57],wheresignalsofﬁnitelengtharenecessarilybandlimited(andthushaveabeginningandendinfrequencydomain).AsexpectedtheproposedmethodperformsbetterwhenappliedtothefrequencydomainsignalsshowninFig.11(b).5DISCUSSIONClassiﬁcationtestaccuracies,rank-basedstatistics,andMPCEreportedinTable2across10differenttimeseriesdatasetssuggestthattheproposedmethodisaverygoodgenericend-to-endsignalclassiﬁcationmodelfortimeseriescontainingsegmentedevents.Moreover,Fig.7showsthattheproposedmethodcanachievehighaccuracywithfewtrainingsamples.Thecomputationalefﬁciencyoftheproposedclassiﬁerisalsodemonstratedinﬁgures8and9intermsofCPUoperations,andaveragetrainingandtestingtimewithrespecttootherend-to-endclassiﬁers.ItisalsoevidentfromTable2thattheproposedmethodoutperformstheSCDT-NSclassiﬁer[9]whichusesasingletemplate-basedgenerativemodel.Anothercompellingpropertyoftheproposedmethodistherobustnesstoout-of-distributionsamplessinceitgeneralizestosamplesoutsidetheknowndistributionwhenthesignalclassesconformtothespeciﬁcgenerativemodel.PlotsinFig.10showthatothermethodsfailtoachievegoodperformanceundertheout-of-distributionsetup,whereastheproposedmethodachievesperfecttestaccuracywithveryfewtrainingsamples(∼16perclass).Thereasonbehindtherobustnesstotheout-of-distributionsetupisthattheproposedmethodiscapableoflearningtheunderlyingdatamodel,morespeciﬁcally,thetypesofunknowndeformationspresentinthesignals.Itcanthensuccessfully10Fig.7:Accuracyasafunctionofnumberoftrainingsamplesperclassfordifferentclassiﬁcationmethods.Fig.8:Computationalcomplexityplotsof1NN-DTWandtheproposedmethodasafunctionofnumberoftrainingsamples.ComplexitiesofthesetwomethodsaregivenbyO(pnr)andO(ck2n),respectively,wherecisthenumberofclasses,pisthetotalnumberoftrainingsamples,nisthesignallength,risthewindowlengthtocalculateDTW,andkisthenumberofclosestsampleswithrespecttoatestsampleusedtobuildthelocalsubspaceinproposedmethod.classifyanunknownsignalinpresenceofsuchdeformationsbutwithdifferentmagnitudes.Themainassumptionoftheproposedmethodisthatthedatasetneedstoconformtotheunderlyinggenerativemodelproposedearlier.Speciﬁcally,weshowedabovethatthemethodworksbestwhenthetimeseries(signal)beingclassiﬁedcontainssegmentedeventswithﬁniteduration.Fig.11showsanexamplewhererawsignals(fromagearboxvibrationexperimentalsetup)donotpossesswell-deﬁnedtimeserieseventsofﬁniteduration.Hence,theproposedmethodperformspoorlyinclassifyingthosesignals.However,thesamesignalsinfrequencydomainseemtoﬁtthegenerativemodelbetterandtheproposedmethodperformsbetterinclassifyingthegearboxdatainfrequencydomain.Tosummarize,thispaperpresentsanewideaofrepresentingFig.9:(Upper)Trainingtimeinsecondsvstestaccuracyfordifferentclassiﬁcationmethods.(Lower)Averagetimetakenbytheclassiﬁcationmethodstopredicttheclassofatestsignal.ExperimentswererunusingPythonversion3.6.9onacomputerwithanIntel(R)Xeon(R)CPUE5-2630v4processorrunningat2.20GHzusing62GBofRAM.Fig.10:Accuracyasafunctionofnumberoftrainingsamplesperclassundertheout-of-distributionsetup.segmentedsignaldatausingagenerativemodelsuchthatsignalsfromaparticularclasscanbeconsideredasobservationsofasetofunknowntemplatesundersomeunknowndeformations.Underthisassumption,weformulatedaclassiﬁcationproblemforsegmentedsignalclasses.Thenweshowedthatifthedatafollowtheproposedgenerativemodel,asimplesolutioncanbedevisedbysearchingnearestlocalsubspaceinSCDTdomain.Throughextensiveexperiments,wedemonstratedthattheproposedsolutioniseffectiveinclassifyingunknownsignals,computationallyverycheap,dataefﬁcient,androbusttoout-of-distributionsamples.6CONCLUSIONThispaperintroducedanewend-to-endsignalclassiﬁcationmethodbasedonarecentlydevelopedsignaltransform.First,weformulatedtheproblemstatementbasedonamultipletemplate-basedgenerativemodelobservedunderunknowndeformations.11MethodTimedomainFrequencydomainMLP55.6790.451D-VGG50.7756.021D-ResNet71.550.0LSTM57.3272.35LSTM-FCN76.590.92SCDT-NS52.7591.51NN-DTW75.7593.5Proposed57.2589.5Fig.11:Plotsin(a)showfewexamplesfromthegearboxfaultdiagnosisdatasetthatdonotfollowthegenerativemodel.Plotsin(b)showthesignalsinfrequencydomaincorrespondingtothesig-nalsshownin(a),whichseemtoﬁtthegenerativemodel;hence,theproposedmethodperformsbetterinclassifyingthesesignals.Tableinlowerpanelshowsthetestaccuracy(%)generatedbytheclassiﬁersonbothtimeandfrequencydomaindata.Then,weproposedanend-to-endsolutiontotheproblembyemployinganearestlocalsubspacesearchalgorithminSCDTdomain.Althoughtheproblemstatementandsolutionarebasedontheassumptionthatsignalsareobservationsoftemplatesunderconfoundingdeformations,knowledgeofthesetemplatesorconfounddeformationsisnotrequired.Themodelwasdemon-stratedtoachievehightestaccuracyacrossmultipletimeseriesdatasets.Severalexperimentsshowthattheproposedmethodnotonlyoutperformsthestate-of-the-artdeeplearningbasedend-to-endmethodsbutalsoisdataefﬁcientandrobusttoout-of-distributionexamples.Moreover,itprovidescompetitiveperfor-manceinclassifyingsegmentedtimeserieseventswithrespectto1NN-DTWwithverycheapcomputationalcomplexity.Wenotethattheapproachassumesthatthedatabeingclassiﬁedfollowsacertaingenerativemodel.Namely,eachtimeseriesshouldcontainaneventwithﬁnitesupport,thatis,withbeginningandendwithintherecordedtimeseries.Weshowedthatforsignalclassesthatdonotcontaineventsofﬁnitedurationtheapproachislesseffective.Futureworkwillincludeexploringwaystoextendthismethodtoclassifytimeserieseventsthatarenotreadilysegmentable.ACKNOWLEDGEMENTSThisworkwassupportedinpartbyNIHgrantGM130825.REFERENCES[1]Imaginganddatasciencelab,“PyTransKit,”https://github.com/rohdelab/PyTransKit.[2]O.D.LaraandM.A.Labrador,“Asurveyonhumanactivityrecognitionusingwearablesensors,”IEEEcommunicationssurveys&tutorials,vol.15,no.3,pp.1192–1209,2012.[3]S.K.Berkaya,A.K.Uysal,E.S.Gunal,S.Ergin,S.G.,andM.B.Gulmezoglu,“AsurveyonECGanalysis,”BiomedicalSignalProcessingandControl,vol.43,pp.216–235,2018.[4]A.SubasiandM.I.Gursoy,“EEGsignalclassiﬁcationusingPCA,ICA,LDAandsupportvectormachines,”Expertsystemswithapplications,vol.37,no.12,pp.8659–8666,2010.[5]A.Fehske,J.Gaeddert,andJ.H.Reed,“Anewapproachtosignalclassiﬁcationusingspectralcorrelationandneuralnetworks,”inFirstIEEEInternationalSymposiumonNewFrontiersinDynamicSpectrumAccessNetworks,2005.DySPAN2005.IEEE,2005,pp.144–150.[6]O.Abdeljaber,O.Avci,M.S.Kiranyaz,B.Boashash,H.Sodano,andD.J.Inman,“1-DCNNsforstructuraldamagedetection:Veriﬁcationonastructuralhealthmonitoringbenchmarkdata,”Neurocomputing,vol.275,pp.1308–1317,2018.[7]R.Zhao,R.Yan,Z.Chen,K.Mao,P.Wang,andR.X.Gao,“Deeplearninganditsapplicationstomachinehealthmonitoring,”MechanicalSystemsandSignalProcessing,vol.115,pp.213–237,2019.[8]C.Lu,T.Lee,andC.Chiu,“Financialtimeseriesforecastingusingindependentcomponentanalysisandsupportvectorregression,”Decisionsupportsystems,vol.47,no.2,pp.115–125,2009.[9]A.H.M.Rubaiyat,M.Shifat-E-Rabbi,Y.Zhuang,S.Li,andG.K.Rohde,“Nearestsubspacesearchinthesignedcumulativedistributiontransformspacefor1dsignalclassiﬁcation,”inICASSP2022-2022IEEEInternationalConferenceonAcoustics,SpeechandSignalProcessing(ICASSP).IEEE,2022,pp.3508–3512.[10]A.Aldroubi,R.D.Martin,I.Medri,G.K.Rohde,andS.Thareja,“Thesignedcumulativedistributiontransformfor1-Dsignalanalysisandclassiﬁcation,”FoundationsofDataScience,2022.[11]A.Nanopoulos,R.Alcock,andY.Manolopoulos,“Feature-basedclas-siﬁcationoftime-seriesdata,”InternationalJournalofComputerRe-search,vol.10,no.3,pp.49–61,2001.[12]A.Bagnall,J.Lines,A.Bostrom,J.Large,andE.Keogh,“Thegreattimeseriesclassiﬁcationbakeoff:areviewandexperimentalevaluationofrecentalgorithmicadvances,”Dataminingandknowledgediscovery,vol.31,no.3,pp.606–660,2017.[13]B.D.FulcherandN.S.Jones,“Highlycomparativefeature-basedtime-seriesclassiﬁcation,”IEEETransactionsonKnowledgeandDataEngineering,vol.26,no.12,pp.3026–3037,2014.[14]H.I.Fawaz,G.Forestier,J.Weber,L.Idoumghar,andP.-A.Muller,“Deeplearningfortimeseriesclassiﬁcation:areview,”Dataminingandknowledgediscovery,vol.33,no.4,pp.917–963,2019.[15]J.Wang,Y.Chen,S.Hao,X.Peng,andL.Hu,“Deeplearningforsensor-basedactivityrecognition:Asurvey,”PatternRecognitionLetters,vol.119,pp.3–11,2019.[16]M.M.AlRahhal,Y.Bazi,H.AlHichri,N.Alajlan,F.Melgani,andR.R.Yager,“Deeplearningapproachforactiveclassiﬁcationofelectrocardio-gramsignals,”InformationSciences,vol.345,pp.340–354,2016.[17]M.G.Baydogan,G.Runger,andE.Tuv,“Abag-of-featuresframeworktoclassifytimeseries,”IEEEtransactionsonpatternanalysisandmachineintelligence,vol.35,no.11,pp.2796–2802,2013.[18]A.Bagnall,J.Lines,J.Hills,andA.Bostrom,“Time-seriesclassiﬁcationwithCOTE:thecollectiveoftransformation-basedensembles,”IEEETransactionsonKnowledgeandDataEngineering,vol.27,no.9,pp.2522–2535,2015.[19]J.Lines,S.Taylor,andA.Bagnall,“TimeseriesclassiﬁcationwithHIVE-COTE:Thehierarchicalvotecollectiveoftransformation-basedensembles,”ACMTransactionsonKnowledgeDiscoveryfromData,vol.12,no.5,2018.[20]H.Deng,G.Runger,E.Tuv,andM.Vladimir,“Atimeseriesforestforclassiﬁcationandfeatureextraction,”InformationSciences,vol.239,pp.142–153,2013.[21]A.Abanda,U.Mori,andJ.A.Lozano,“Areviewondistancebasedtimeseriesclassiﬁcation,”DataMiningandKnowledgeDiscovery,vol.33,no.2,pp.378–412,2019.[22]J.LinesandA.Bagnall,“Timeseriesclassiﬁcationwithensemblesofelasticdistancemeasures,”DataMiningandKnowledgeDiscovery,vol.29,no.3,pp.565–592,2015.[23]D.J.BerndtandJ.Clifford,“Usingdynamictimewarpingtoﬁndpatternsintimeseries.”inKDDworkshop,vol.10,no.16.Seattle,WA,USA:,1994,pp.359–370.[24]X.Xi,E.Keogh,C.Shelton,L.Wei,andC.A.Ratanamahatana,“Fasttimeseriesclassiﬁcationusingnumerosityreduction,”inProceedingsofthe23rdinternationalconferenceonMachinelearning,2006,pp.1033–1040.[25]Y.Zheng,Q.Liu,E.Chen,Y.Ge,andJ.L.Zhao,“Timeseriesclassiﬁ-cationusingmulti-channelsdeepconvolutionalneuralnetworks,”inIn-ternationalconferenceonweb-ageinformationmanagement.Springer,2014,pp.298–310.12[26]B.Zhao,H.Lu,S.Chen,J.Liu,andD.Wu,“Convolutionalneuralnetworksfortimeseriesclassiﬁcation,”JournalofSystemsEngineeringandElectronics,vol.28,no.1,pp.162–169,2017.[27]Z.Wang,W.Yan,andT.Oates,“Timeseriesclassiﬁcationfromscratchwithdeepneuralnetworks:Astrongbaseline,”in2017Internationaljointconferenceonneuralnetworks(IJCNN).IEEE,2017,pp.1578–1585.[28]Z.Cui,W.Chen,andY.Chen,“Multi-scaleconvolutionalneuralnet-worksfortimeseriesclassiﬁcation,”arXivpreprintarXiv:1603.06995,2016.[29]F.Karim,S.Majumdar,H.Darabi,andS.Chen,“LSTMfullyconvolu-tionalnetworksfortimeseriesclassiﬁcation,”IEEEaccess,vol.6,pp.1662–1669,2017.[30]S.Kolouri,S.R.Park,M.Thorpe,D.Slepcev,andG.K.Rohde,“Optimalmasstransport:Signalprocessingandmachine-learningapplications,”IEEEsignalprocessingmagazine,vol.34,no.4,pp.43–59,2017.[31]S.R.Park,S.Kolouri,S.Kundu,andG.K.Rohde,“Thecumulativedistributiontransformandlinearpatternrecognition,”Appliedandcom-putationalharmonicanalysis,vol.45,pp.616–641,2018.[32]W.Wang,D.Slepˇcev,S.Basu,J.A.Ozolek,andG.K.Rohde,“Alinearoptimaltransportationframeworkforquantifyingandvisualizingvariationsinsetsofimages,”Internationaljournalofcomputervision,vol.101,no.2,pp.254–269,2013.[33]A.H.M.Rubaiyat,K.M.Hallam,J.M.Nichols,M.N.Hutchinson,S.Li,andG.K.Rohde,“Parametricsignalestimationusingthecumu-lativedistributiontransform,”IEEETransactionsonSignalProcessing,vol.68,pp.3312–3324,2020.[34]H.L.RoydenandP.Fitzpatrick,Realanalysis.MacmillanNewYork,1988,vol.32.[35]M.Shifat-E-Rabbi,X.Yin,A.H.M.Rubaiyat,S.Li,S.Kolouri,A.Aldroubi,J.M.Nichols,andG.K.Rohde,“Radoncumulativedistri-butiontransformsubspacemodelingforimageclassiﬁcation,”JournalofMathematicalImagingandVision,pp.1–19,2021.[36]J.Laaksonen,“Localsubspaceclassiﬁer,”inInternationalConferenceonArtiﬁcialNeuralNetworks.Springer,1997,pp.637–642.[37]H.Cevikalp,D.Larlus,M.Douze,andF.Jurie,“Localsubspaceclassiﬁers:Linearandnonlinearapproaches,”in2007IEEEWorkshoponMachineLearningforSignalProcessing.IEEE,2007,pp.57–62.[38]M.S.E.Rabbi,Y.Zhuang,S.Li,A.H.M.Rubaiyat,X.Yin,andG.K.Rohde,“Invarianceencodinginsliced-Wassersteinspaceforimageclas-siﬁcationwithlimitedtrainingdata,”arXivpreprintarXiv:2201.02980,2022.[39]B.K.IwanaandS.Uchida,“Anempiricalsurveyofdataaugmentationfortimeseriesclassiﬁcationwithneuralnetworks,”Plosone,vol.16,no.7,p.e0254841,2021.[40]H.I.Fawaz,G.Forestier,J.Weber,L.Idoumghar,andP.-A.Muller,“Dataaugmentationusingsyntheticdatafortimeseriesclassiﬁcationwithdeepresidualnetworks,”arXivpreprintarXiv:1808.02455,2018.[41]S.HochreiterandJ.Schmidhuber,“Longshort-termmemory,”Neuralcomputation,vol.9,no.8,pp.1735–1780,1997.[42]H.A.Dau,E.Keogh,K.Kamgar,C.-C.M.Yeh,Y.Zhu,S.Gharghabi,C.A.Ratanamahatana,Yanping,B.Hu,N.Begum,A.Bagnall,A.Mueen,G.Batista,andHexagon-ML,“TheUCRtimeseriesclassi-ﬁcationarchive,”October2018,https://www.cs.ucr.edu/∼eamonn/timeseriesdata2018/.[43]A.MezariandI.Maglogiannis,“Gesturerecognitionusingsymbolicaggregateapproximationanddynamictimewarpingonmotiondata,”inProceedingsofthe11thEAIInternationalConferenceonPervasiveComputingTechnologiesforHealthcare,2017,pp.342–347.[44]D.S.Willett,J.George,N.S.Willett,L.L.Stelinski,andS.L.Lapointe,“Machinelearningforcharacterizationofinsectvectorfeeding,”PLoScomputationalbiology,vol.12,no.11,p.e1005158,2016.[45]J.Gao,S.Giri,E.C.Kara,andM.Berg´es,“PLAID:apublicdatasetofhigh-resoultionelectricalappliancemeasurementsforloadidentiﬁcationresearch:demoabstract,”inproceedingsofthe1stACMConferenceonEmbeddedSystemsforEnergy-EfﬁcientBuildings,2014,pp.198–199.[46]J.Liu,L.Zhong,J.Wickramasuriya,andV.Vasudevan,“uWave:Accelerometer-basedpersonalizedgesturerecognitionanditsapplica-tions,”PervasiveandMobileComputing,vol.5,no.6,pp.657–675,2009.[47]R.T.Olszewski,Generalizedfeatureextractionforstructuralpatternrecognitionintime-seriesdata.CarnegieMellonUniversity,2001.[48]U.Rebbapragada,P.Protopapas,C.E.Brodley,andC.Alcock,“Findinganomalousperiodictimeseries,”Machinelearning,vol.74,no.3,pp.281–313,2009.[49]P.Geurts,“Contributionstodecisiontreeinduction:bias/variancetrade-offandtimeseriesclassiﬁcation,”Ph.D.dissertation,ULi`ege-UniversityofLi`ege,2002.[50]P.Pławiak,“ECGsignals(744fragments),”2017.[51]P.Pławiak,“Novelgeneticensemblesofclassiﬁersappliedtomy-ocardiumdysfunctionrecognitionbasedonECGsignals,”Swarmandevolutionarycomputation,vol.39,pp.192–208,2018.[52]S.MousaviandF.Afghah,“Inter-andintra-patientECGheartbeatclas-siﬁcationforarrhythmiadetection:asequencetosequencedeeplearningapproach,”inICASSP2019-2019IEEEInternationalConferenceonAcoustics,SpeechandSignalProcessing(ICASSP).IEEE,2019,pp.1308–1312.[53]M.M.Bassiouni,E.A.El-Dahshan,W.Khalefa,andA.M.Salem,“IntelligenthybridapproachesforhumanECGsignalsidentiﬁcation,”Signal,ImageandVideoProcessing,vol.12,no.5,pp.941–949,2018.[54]D.DuaandC.Graff,“UCImachinelearningrepository,”2017.[Online].Available:http://archive.ics.uci.edu/ml[55]R.P.GormanandT.J.Sejnowski,“Analysisofhiddenunitsinalayerednetworktrainedtoclassifysonartargets,”Neuralnetworks,vol.1,no.1,pp.75–89,1988.[56]N.R.E.Laboratory,“Gearboxfaultdiagnosisdata[dataset],”2018,http://data.openei.org/submissions/623.[57]R.N.BracewellandR.N.Bracewell,TheFouriertransformanditsapplications.McGraw-hillNewYork,1986,vol.31999.1APPENDIXAADDITIONALFACTSANDREMARKSObservation1:Letc6=pbetwoclasslabels,andS(c)andS(p)bedeﬁnedasineq.(10),respectively.Assumethatforanyϕ(c)j∈S(c),fj,ϕ(p)w/∈spann(cid:0)G(p)w(cid:1)−1oforanyw=1,...,Mpwhere(fj,ϕ(p)w)0ϕ(c)j(fj,ϕw)=ϕ(p)w,itfollowsthatbV(p)w∩bS(c)=∅foranyw=1,...,Mp.Proof.Assumebycontradictionthatthereexistssomeϕ(c)j∈S(c)suchthatbϕ(c)j∈bV(p)w∩bS(c).Bythecompositionpropertyandthedeﬁnitionoffj,ϕ(p)wabove,wehavethatf−1j,ϕ(p)w◦bϕ(c)j=bϕ(p)wandhencebϕ(c)j=fj,ϕ(p)w◦bϕ(p)w.Sincebyassumptionbϕ(c)j∈bV(p)w,itfollowsthatfj,ϕ(p)w∈spann(cid:0)G(p)w(cid:1)−1o,whichisacontradiction.Remark1:ThelastargumentabovefollowsfromthesimplefactthatbV(p)w=span(cid:16)bSϕw,G(p)w(cid:17)=nkPi=1βif(p)i,w◦bϕ(p)w:βi∈Ro=nf◦bϕ(p)w:f∈span(cid:0)G(p)w(cid:1)−1o.Remark2:Bythedisjointnessassumptionaboutdifferentsignalclasses,i.e.,S(p)∩S(c)=∅forc6=p,itfollowsthatfj,ϕ(p)w/∈(cid:0)G(p)w(cid:1)−1forallp=1,...,Mp.ThispropertyintuitivelysaysthatsignalsinS(c)differs“signiﬁcantly”fromthetemplateϕ(p)winthesensethattheycannotberecoveredusingϕ(p)wunderdeformationsinG(p)w.Recallthat(cid:0)G(p)w(cid:1)−1=nkPi=1αif(p)i,w:αi≥0o,whichdiffersfromspann(cid:0)G(p)w(cid:1)−1ointhesensethatthelatterhasnorestrictionontheαi’s.WecommentlooselythattheassumptionsinObservation1isnotunreasonablewhensignalsinclass(c)are”signiﬁcantly”differentthantemplatesinclass(p)andthedeformationsetsarereasonably“small”inthesensethatfj,ϕ(p)w/∈spann(cid:0)G(p)w(cid:1)−1o.APPENDIXBDATAEFFICIENCYOFTHEPROPOSEDMETHODSectionIV-DofthepapershowsthattheproposedmethodisdataefﬁcientincomparisonwiththeCNNsandprovidestwoexamples.Fig.1showstheresultsfromsameexperimentsetupforfourotherdatasets.Fig.1:Accuracyasafunctionofnumberoftrainingsamplesperclassfordifferentclassiﬁcationmethods.arXiv:2205.00348v2  [eess.SP]  23 Jul 2022