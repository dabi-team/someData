2
2
0
2

p
e
S
2

]
h
p
-
m
e
h
c
.
s
c
i
s
y
h
p
[

1
v
7
5
9
3
0
.
9
0
2
2
:
v
i
X
r
a

AN UNIFIED STATISTICAL PROCEDURE TO ANALYSE IRREVERSIBLE
THERMAL CURVES

JHIMLI BHATTACHARYYA, GOPINATHA SURESH KUMAR, SOUVIK MAITI, DAISUKE MIYOSHI,
AND SANJAY CHAUDHURI

Abstract. The phenomenon of hysteresis is commonly observed in many UV thermal experiments involving
unmodiﬁed or modiﬁed nucleic acids. In presence of hysteresis the thermal curves are irreversible and demand
a signiﬁcant eﬀort to produce the reaction speciﬁc kinetic and thermodynamic parameters. In this article we
describe a uniﬁed statistical procedure to analyse such thermal curves. Our method applies to experiments
with intramolecular as well as intermolecular reactions. More speciﬁcally, the proposed method allows one
to handle the thermal curves for the formation of duplexes, triplexes and various quadruplexes in exactly
the same way. The proposed method uses a local polynomial regression for ﬁnding the smoothed thermal
curves and calculate their slopes. This method is more ﬂexible and easy to implement than the least squares
polynomial smoothing which is currently almost universally used for such purposes. Full analyses of the
curves including computation of kinetic and thermodynamic parameters can be done using freely available
statistical softwares. At the end, we illustrate our method by analysing irreversible curves encountered in
the formations of a G-quadruplex and a LNA-modiﬁed parallel duplex.

1. Introduction

Analysis of experimental data is an integral part of chemical research. Even if a chemical experiment
is well designed and extremely well executed, no conclusions can be drawn from it unless the results are
properly analyzed. In fact, erroneous analysis of experimental data can lead to wrong conclusions, resulting
in a huge waste of eﬀort and resources.

Data obtained from chemical experiments require several advanced statistical tools for a proper analysis.
Each of these steps are computationally intensive and demands an advanced mathematical and statistical
expertise from a researcher. Many procedures require tedious calculations, too diﬃcult and time consuming
to perform without advanced computational facilities. Many researchers use computational tools designed
speciﬁcally for their own needs.(Nakano et al., 2004; Miyoshi et al., 2006, 2009; Ray et al., 1996; Mirzoev
and Lyubartsev, 2013) However, in most cases no statistical software is freely available. Many commercial
softwares focus only on a part of the task and diﬀerent softwares are required to complete the procedure.
Lack of analytic tools often restrict choices at the design stage of the experiment and more often inﬂates the
cost and eﬀort even with a loss of accuracy.

As an example, we can cite the thermodynamic and kinetic analyses of hybridization reactions involv-
ing various unmodiﬁed and modiﬁed nucleic acids which have been a topic of immense interest among the
researchers in biophysical chemistry for at least half a century. Such investigations can be helpful in de-
termining the stability of the secondary structures in nucleic acids. They can also be used to study the
hybridization between an oligonucleotide and a speciﬁc target. Results from these studies are useful for PCR
primer design, gene sequencing and a host of bio-medical applications. In order to study the biophysical
characteristics of any nucleic acid hybridization reaction spectrophotometrically, UV thermal experiments
are useful. For nucleic acids, denaturation (heating/melting) and renaturation (cooling/annealing) processes
are usually reversible. (Mergny and Lacroix, 2003) That is, if a sample of denatured nucleic acid is cooled,
in most cases renaturation of the structure is observed. Thermodynamic parameters can be obtained by
analyzing such thermal curves, (Nakano et al., 2004; Miyoshi et al., 2006, 2009; Mergny and Lacroix, 2003;
Sugimoto et al., 2001; Roug´ee et al., 1992) provided the denaturation (melting) and renaturation (annealing)
curves can be superimposed on each other (i.e the folding and unfolding rate constants of the nucleic acids
are equal). With many modiﬁed and unmodiﬁed oligonucleotides however, such is not the case. For various
reasons the renaturation process may be quite slow.(Mergny and Lacroix, 2003; Cantor and Schimmel, 1980;
Brown et al., 2005) As a result, if the temperature gradient during the melting and annealing is not slow
1

 
 
 
 
 
 
enough, the heating and cooling curves are not superimposed and thus none of them correspond to the true
equilibrium curve. (Mergny and Lacroix, 2003) This phenomenon is known as hysteresis.

Hysteresis has been discussed by several authors before. Anshelevich et al. (1984) perform a theoretical
study of melting processes where hysteresis is observed. A classic example can be seen during the fast melting
and annealing of calf thymus DNA. (Cantor and Schimmel, 1980) In recent times, such a phenomenon has
been reported from the study of RNA and DNA binding to a pyrrolidine-amide oligonucleotide mimic (POM)
(Hickman et al., 2000) and the hybridization of locked nucleic acid (LNA) modiﬁed non canonical structures.
(Kaur et al., 2007; Bhattacharyya et al., 2011) Roug´ee et al. (1992) reported and analyzed non-equilibrium
thermal curves in triplex formation.
It has also been observed in triplex formation of DNA oligomers
with Guanidinium and methylthiourea-link nucleosides. (Blask´o et al., 1996; Arya and Bruice, 1999) Same
phenomenon was seen in triplex formation with α-L-LNA (Kumar et al., 2006) and peptide nucleic acids
(PNA). (Lesnik et al., 1997) It is known that melting of tetramolecular DNA and RNA quadruplexes is not
kinetically reversible. (Mergny et al., 2005; Tran et al., 2013) However, for other, specially the intramolecular
G-quadruplexes hysteresis is commonly observed. (Mergny and Lacroix, 2001, 2003; Brown et al., 2005; Sacc`a
et al., 2005; Zhang and Balasubramanian, 2012; Pandey et al., 2013)

If hysteresis is observed, the thermodynamic parameters cannot be estimated directly from the thermal
curves. Nevertheless, it is possible to observe a simple one way reaction from a folded state to an unfolded
state with a melting curve, whereas the annealing curve traces the transition from an unfolded random
coil to a folded hybrid. Thus, if hysteresis is observed, kinetic analysis of melting and annealing curves
can be attempted. (Bhattacharyya et al., 2011) The annealing and melting curves respectively allow one
to determine the association and dissociation rate constants. Assuming a two state (all or none) model,
these kinetic rate constants yield the corresponding activation energies. From these rate constants and
the activation energies, thermodynamic parameters, e.g. changes in free energy, enthalpy or entropy can be
obtained. The analysis mentioned above was ﬁrst described by Roug´ee et al. (1992) and has been successfully
used for kinetic analysis of many non-canonical structures. However, as we shall demonstrate below, it is
pretty laborious to perform this kinetic analysis manually. First of all, the raw experimental data has
to be smoothed and the value of the derivative has to be accurately calculated at each observation. The
values of rate constants at each temperature are obtained by solving a pair of simultaneous equations. The
activation energies are calculated from the rates of changes in the two rate constants. To our knowledge,
no software which tackles the whole procedure is available. In most cases if the UV thermal curves show
hysteresis, estimation of the kinetic parameters, activation energies and hence the thermodynamic proﬁle
become extremely time consuming. Thus in such cases thermodynamic analysis is often not attempted
from the spectrophotometric data. However, a thorough thermodynamic proﬁle is necessary to understand
the chemical interactions of nucleic acids. This thermodynamic proﬁle complements the structural data
providing a clear and coherent picture. (Kaur et al., 2007, 2008; Sugimoto et al., 2001; Das et al., 2011;
Bhadra and Suresh Kumar, 2011; Saha et al., 2010)

In this article we describe a uniﬁed statistical procedure for kinetic analysis of UV thermal curves showing
hysteresis. Our procedure can be implemented using freely available libraries and codes from a statistical
software called R. (R Core Team, 2012) We use local polynomial regression method to smooth the raw
experimental data and estimate the derivative of the underlying thermal curve at each temperature. Our
software calculates the kinetic rate constants, activation energies and the thermodynamic parameters using
R as well. We illustrate our procedure with two data from four sets of thermal curves. The ﬁrst two sets
consider intramolecular G-quadruplex formation of two speciﬁc RNA strands. Stability of these nucleic
acids were investigated by Pandey et al. (2013), who however, in order to avoid hysteresis performed the
experiment with a ﬂatter temperature gradient than the data used here. Next, we use data reported by
Bhattacharyya et al. (2011) where kinetic and thermodynamic eﬀects of LNA modiﬁcation on parallel and
antiparallel DNA duplexes were reported. Signiﬁcant hysteresis was observed for LNA modiﬁed parallel
duplexes for all temperature gradients used. The extent of hysteresis increased with the increase in the
number LNA modiﬁcations. Our results closely match with those reported in the original references.

2. UV Spectrophotometric Experiment to Obtain the Thermal Curves

The UV absorbance spectra are recorded on a spectrophotometer equipped with a temperature controller.
The heating and cooling rates are usually kept constant throughout the experiment. The sample is usually
2

ﬁrst annealed from a high (95◦ C) to a low (0◦ C) temperature at a steady rate. The annealed sample is then
incubated at the low temperature for some time. When the temperature is below 20◦C the cell chamber is
ﬂushed with dry nitrogen gas to avoid condensation. Then at the melting stage the temperature is steadily
increased from low to a high value. The annealing and the melting curves are usually obtained by measuring
the UV absorbance at 260 or 295 nm. A buﬀer is used to control the pH of the system. The ﬁnal data is
obtained by subtracting the absorbance due to the buﬀer from the observed data.

3. The Theory Behind the Kinetic and Thermodynamic Analysis of Thermal Curves

Exhibiting Hysteresis

In presence of hysteresis, for a kinetic analysis of the thermal curves one uses a two-state model between
the reactant (R) and the product (P ). Many situations are possible in this case. For example, a single
strand can fold into a duplex or a more complex hybrid. The reaction may be bimolecular involving either
two autocomplimentary oligoes or two diﬀerent complimentary oligonucleotides. The kinetic order of the
reaction diﬀers from one group to another. We consider two broad classes of reactions discussed in Table
2 of Mergny and Lacroix (2003) below. Pronounced hysteresis have been observed by several authors, for
reactions belonging to these classes.

3.0.1. Intramolecular reactions. For intramolecular reactions, a monomeric nucleic acid strand (R) folds to
produce various hybrid structures (P ). Hairpin duplex, intramolecular triplex, intramolecular G-quadruplex
formations are examples belonging to this class.

At equilibrium, the reaction can be written as:

(1)

R (cid:28) P.

Suppose kon denotes the rate constant of annealing or cooling, which means association and koﬀ is the rate
constant of melting or heating which results in dissociation. From (1) the rate of change of concentration of
the product P at time t is given by

(2)

d[P ]
dt

= kon[R] − koﬀ[P ].

Notice that, (1) is a ﬁrst order reaction. The equilibrium would be independent of the initial concentration
of the reactant.

3.0.2. Intermolecular reactions with two complimentary oligoes. For this class of reactions two complimentary
oligoes R1 and R2 hybridize to form the product P . This class of reactions is large and includes most of
the hybridization reactions involving various nucleic acids. Hysteresis is quite commonly observed in this
group of reactions. As for example, R1 and R2 may both be single stranded oligoes which hybridize to
produce a duplex. Bhattacharyya et al. (2011) observed hysteresis in parallel duplex formation where
one of the constituent strand was modiﬁed by LNA. Similar examples of hysteresis in duplex formation
abound.(Hickman et al., 2000; Kaur et al., 2007) Various triplex formations where one of the reactants is a
duplex and the other a single strand also show pronounced hysteresis. (Roug´ee et al., 1992; Arya and Bruice,
1999; Kumar et al., 2006)

The reaction in this case is of second order. At equilibrium it can be expressed as:(Mergny and Lacroix,

2003; Kaur et al., 2007; Bhattacharyya et al., 2011)

(3)

R1 + R2 (cid:28) P.

As before, if we assume kon and koﬀ respectively denote the rate constants of annealing and melting, from
(3) the rate of change of concentration of the product P at time t is given by

(4)

d[P ]
dt

= kon[R1][R2] − koﬀ[P ].

It is clearly seen that unlike the intramolecular reactions, the equilibrium in a bimolecular reaction depends
on the initial concentration of the two reactants.

3

Absmax

AbsT

Absmin

Tmin

F PT

(cid:54)

(cid:63)
(cid:54)

F RT

(cid:63)

T

(a)

Absmax

AbsT

Tmax

Absmin

Tmin

(cid:54)

F RT

F PT

(cid:63)
(cid:54)

(cid:63)

T

(b)

1.0

α(T )

Tmax

0.0

Tmin

T

Tmax

(c)

Figure 1. A schematic curve of absorbance at 260 nm 1(a) and at 295 nm 1(b). Hyper-
chromicity is observed in the former and not in the latter. F RT and F PT are respectively
the fraction of reactant and the product at temperature T . Notice that, depending on the
presence and absence of hyperchromicity, the deﬁnitions of F RT and F PT change in the
plot. 1(c) A schematic diagram of F PT = α(T ) obtained from equations (7) and (8) below.

3.0.3. Kinetic and Thermodynamic equations in presence of hysteresis. In both (2) and (4) the temperature
is held ﬁxed. The concentration would vary with time, rate constants kon, koﬀ would remain ﬁxed. If the
temperature T increase or decrease with time as well, the concentration as well as the rate constants will
vary with it. If dT /dt denotes the rate of change of T at time t, (2) and (4) can respectively be re-expressed
as

(5)

and

(6)

d[P ]
dT

=

(cid:18) dT
dt

(cid:19)−1 (cid:110)

kon[R] − koﬀ[P ]

(cid:111)

d[P ]
dT

=

(cid:18) dT
dt

(cid:19)−1 (cid:110)

kon[R1][R2] − koﬀ[P ]

(cid:111)
.

Here kon, koﬀ and the concentrations are taken to vary with T .

We assume that the fraction of the product P , at temperature T , denoted by α(T ) can be obtained from
the absorbance of the heating and cooling curves at temperature T . Suppose Abs(T ) is the absorbance
at temperature T , Absmin and Absmax are respectively the minimum and maximum absorbance of the
thermal curve under consideration. The formula to obtain α(T ) is determined by the presence or absence of
hyperchromicity at the wavelength being used in the experiment. If hyperchromicity is observed, e.g. duplex
formation observed at 260 nm, the absorbance increases with temperature. That is higher absorbance
implies higher fraction of single strands (see Figure 1(a) above). In such cases the fraction of product at any
temperature T is calculated: (Kumar et al., 2006; Kaur et al., 2007; Bhattacharyya et al., 2011)

(7)

α(T ) =

Absmax − Abs(T )
Absmax − Absmin

.

On the other hand in the absence of hyperchromicity, e.g. triplex formation reaction recorded at 295
nm,(Mergny and Lacroix, 2003) absorbance decreases with the increase in fraction of the single strands (see
Figure 1(b)). Thus the fraction of triplex should be calculated using the formula: (Arora and Maiti, 2009)

(8)

α(T ) =

Abs(T ) − Absmin
Absmax − Absmin

.

Note that, by our deﬁnition for both (7) and (8), 0 ≤ α(T ) ≤ 1, α(Tmin) = 1 which is the completely
hybridized state and α(Tmax) = 0 which corresponds to the completely dissociated state. A schematic plot
of α(T ) with temperature for both cases is shown in Figure 1(c) above. Since the fraction decreases with
4

temperature, the derivative is negative. This implies that the Van’t Hoﬀ temperatures i.e. the apparent
temperatures of mid-transition in the melting and annealing phases can be approximated by the temperature
corresponding to minimum value of this derivative.

Our choice of the Absmax and Absmin as baselines, constant over the values of T is a special case in
a set of possible choices of baselines. Many researchers, specially Mergny and his co-authors suggest that
time dependent baselines are more appropriate and strongly recommend their use throughout.(Mergny and
Lacroix, 2001, 2003, 2009) The kinetic and thermodynamic parameters computed from the experimental
data would change if the baselines are changed. In that sense, the choice of baselines are crucial. However,
there is no objective way of ﬁnding them. In most cases, baselines that are linear with temperature are used.
Even then, the choice of their slopes and intercepts are subjective. In some cases (eg. Roug´ee et al. (1992))
baselines were obtained through separate experiments. For intramolecular G-quadruplex formation without
any evidence of hysteresis, such baselines have been obtained through model ﬁtting. (Arora and Maiti, 2009)
Many authors however, prefer constant baselines. (Arya and Bruice, 1999; Blask´o et al., 1996; Kumar et al.,
2006; Bhattacharyya et al., 2011) Our choice is in line with them.

We should also note that, in equations (7) and (8) we have made an implicit assumption that a melting
curve always begin with a fully (i.e. 100%) folded state and end at a fully unfolded state, where as an
annealing curve start and end respectively with a fully denatured and renatured states. This may not hold
in many cases. As for example, if the temperature of midtransition is too low (eg. 20◦ C or below), structure
of the corresponding DNA may be too unstable to fold perfectly at 0◦ C. As a result the melting curve will
not start from a 100% denatured state. On the other hand, in presence of K + ions G-Quadruplexes are too
stable and a melting curve involving such DNA structures may not end at a fully denatured state. However,
equations (7) and (8) are still relevant. If there is evidence that the nucleic acid is not fully folded at 0◦ C
or fully unfolded at 95◦ C, the observed thermal curves are extrapolated beyond this range to determine the
temperatures corresponding to fully renatured and denatured states. We don’t discuss the actual procedure
for such extrapolation here, but equations (7) and (8) can be applied to the extrapolated curves as well.

In presence of hysteresis, the concentration of the product at any temperature T is diﬀerent on the
annealing and melting curves. Let α(1)
c (T ) respectively denote the association and dissociation
rates of the product at temperature T . From equations (5) and (6), assuming equal stochiometric ratios of
the reactants in (6) and (|dT /dt|)−1 = γ, we get:

h (T ) and α(1)

(9a)

(9b)

and

(10a)

(10b)

α(1)

h (T ) =

α(1)

c (T ) =

dαh
dT
dαc
dT

=γ [kon(1 − αh) − koﬀαh] ,

= − γ [kon(1 − αc) − koﬀαc] .

α(1)

h (T ) =

α(1)

c (T ) =

dαh
dT
dαc
dT

=γ (cid:2)konC(1 − αh)2 − koﬀαh

(cid:3) ,

= − γ (cid:2)konC(1 − αc)2 − koﬀαc

(cid:3) .

Here C is the molar concentration of the reactant strands in (6). Notice that, in (10b), T decreases with

time, so (dT /dt)−1 = −γ.

Equations (9a) and (9b) do not depend on the initial concentration of the reactant strand. This again
indicates that the equilibrium is not dependent on the concentration factor in this case. The assumption
that the concentrations of two reactant strands are equal is crucial for equations (10a) and (10b). In the
general case these equations would be a bit more complex.(Roug´ee et al., 1992; Blask´o et al., 1996)

For any experiment C and γ are speciﬁed by the design. Thus in order to calculate the rate constants kon
and koﬀ at a given temperature T , one needs to ﬁnd out αh, αc, dαh/dT and dαc/dT at temperature T and
solve the equations (10a) and (10b).

Once the values of kon and koﬀ are known for each temperature T , the thermodynamic parameters can be
obtained from these values using the Arrhenius equation. The change in the Free Energy at the temperature
T (i.e. ∆G◦
T ) can be directly obtained as −RT log(kon/koﬀ), where kon and koﬀ are the values of the rate
constants at temperature T .

5

The activation energies of annealing (Eon) and melting (Eoﬀ) are related to kon and koﬀ through the

Arrhenius equations,

(11)

(12)

log(kon) = log(Aon) −

log(koﬀ) = log(Aoﬀ) −

Eon
RT

,

Eoﬀ
RT

.

The other two thermodynamic parameters, i.e the change in enthalpy, ∆H ◦ = Eon − Eoﬀ and the product
T can be computed once Eon and Eoﬀ is

of temperature and the change in entropy T ∆S◦ = ∆H ◦ − ∆G◦
known.

Values of the pairs (Aon, Eon) and (Aoﬀ, Eoﬀ) can be determined from the Arrhenius plot of log(Ckon) vs.
1/T and log(koﬀ) vs. 1/T respectively. In particular, Eon and Eoﬀ are obtained from the slopes of the plots.
We discuss this topic in more details in Section 4.0.3 below.

In equations (9) and (10), we have assumed that the absolute values of both the rates of cooling and
heating respectively at the annealing and melting phases are γ. That is, the rate at which the temperature
goes down at the cooling phase and the rate at which it goes up at the heating phase are equal. Simple
calculations show that in such cases, the slopes of the Arrhenius plots do not depend on γ. This proves that
the change in enthalpy, ∆H ◦ does not depend on γ either. Furthermore, even though the intercepts of the
Arrhenius plots depend on γ, it can be shown that the ratio of the kinetic rate constants i.e kon/koﬀ is still
T and T ∆S◦ are independent of γ as well. This implies that even if for
independent of it. As a result ∆G◦
some reason γ is speciﬁed wrong, the kinetic analyses as described above would produce correct values of
the thermodynamic parameters.

We conclude this section by noting that Tm, i.e. the temperatures of mid-transitionfor the intramolecular
and intermolecular reactions considered satisfy ∆GTm = 0 and ∆GTm = RTm log(C/2) respectively.(Mergny
and Lacroix, 2003) Later we show how Tm can be estimated from the non-equilibrium thermal curves using
our procedure.

4. A Statistical Procedure for Data Analysis

Suppose αci = αc(Ti) and αhi = αh(Ti), i = 1, 2, . . . , n were observed at temperatures Ti, with Ti+1 − Ti
constant for all i. In order to calculate the kinetic rate constants kon and koﬀ using equations (10a) and
(10b) one requires accurate values of absorbance and their rates of changes with the temperature from this
experimental data. Clearly, α(1)
hi = dαh(Ti)/dT cannot be recorded during the run of
the experiment for any Ti. They have to be estimated from the recorded αci and αhi values.

ci = αc(Ti)/dT and α(1)

At any Ti, the fraction of the duplex αi = α(Ti) (for both the melting and annealing stages) is recorded
with noise. Presence of this random noise makes the estimation of α(1)
i = dα(Ti)/dT diﬃcult. It is well
known that the ﬁrst order diﬀerence quotients i.e ri = (αi+1 − αi−1) / (Ti+1 − Ti−1) can lead to extremely
noisy and wrong estimates of α(1)
. One possible solution used by several authors (eg. Kaur et al. (2007))
is ﬁrst to smooth αi and then use the ﬁrst order diﬀerence quotients of the smoothed data to estimate the
derivative.

i

Several methods of smoothing experimental data and estimating derivatives up to several orders have
been discussed in Literature before. The most popular is the so called Least-squares polynomial smoothing
(LSP) introduced by Savitzky and Golay (1964). Assuming equi-spaced data, for the smoothed value at αi
this method ﬁts polynomials of degree up to ﬁve up to twenty ﬁve points around Ti. The article provides
values of the coeﬃcients for these smoothing polynomials and for the ﬁrst to ﬁfth derivatives. This method
has been widely used computational chemistry. The ﬁve-point third degree LSP is used in many standard
data-acquisition hardware and software packages.

In an article Marchand and Marmet (1983) discuss several pitfalls of LSP method and propose a binomial
smoothing ﬁlter as an alternative. Several other methods based on smoothing splines, wavelets etc. have
been proposed. Wavelets are usually computationally demanding and the smoothing splines require one to
make a crucial choice of the smoothing parameter. (Brabanter et al., 2013) In a recent article Brabanter
6

et al. (2013) discuss a new method to estimate α(1)
orders from the un-smoothed data.

i

as a weighted sum of diﬀerence quotients of various

An alternative to all these methods are provided by local polynomial regression (LPR). This method
provides an computationally eﬃcient and easily implementable way to smooth the noisy data and estimate
its derivatives.

4.0.1. Local Polynomial Regression. In local polynomial regression (LPR), one estimates the smoothed curve
and its derivatives by ﬁtting a polynomial within a local neighborhood of each point.

The data is assumed to be generated from the model

(13)

α = m (T ) + (cid:15),

for some unknown function m of temperature T . The variable (cid:15) is the random noise, with E [(cid:15)] = 0 and
V ar [(cid:15)] = σ2. If we assume that the (p + 1)th derivative of m exist, we can locally approximate m by a
polynomial of order p. For any point T0 strictly with in the range of the temperature concerned and for any
T in a neighborhood of T0, a Taylor series expansion yields, (Wand and Jones, 1995; Brabanter et al., 2013)

(14)

m (T ) ≈ m (T0) + m(1) (T0) (T − T0) + · · · +

m(j) (T0)
j!

(T − T0)j + · · · +

m(p) (T0)
p!

(T − T0)p .

Here m(j) (T0) is the value of the jth derivative of m at T0. Note that, none of the derivatives are known
and has to be estimated from the data.
Equation (14) can be re written as:

(15)

m (T ) ≈

p
(cid:88)

j=0

m(j) (T0)
j!

(T − T0)j =

p
(cid:88)

j=0

βj (T − T0)j .

An estimate of the unknown vector of coeﬃcients β = (β0, β1, . . . , βp) in (15) denoted ˆβ is obtained as the
solution to the weighted local least squares regression problem given by,

(16)

ˆβ = arg min
β






n
(cid:88)

i=1

αi −

p
(cid:88)

j=0

βj (Ti − T0)j


2




1
h

K

(cid:18) Ti − T0
h

(cid:19)

.

We note that, the expression in (14) and (15) are local. Thus ˆβ will be diﬀerent for diﬀerent T0.

The kernel function K and the pre-speciﬁed bandwidth h in (16) controls the weights put on the individual
observations as well as the size of the neighborhood of T0 used in estimating m(T0). The kernel function
K has to satisfy certain properties, which we don’t discuss in this article (see Wand and Jones (1995) for
details). There are several choices for K. Some popular ones are,

(17)

(18)

(19)

K(x) =

K(x) =

1
2
3
4

1{|x|<1},

(1 − x2)1{|x|<1},

K(x) = (2π)−1/2e−x2/2.

(Uniform)

(Epanechnikov)

(Gaussian)

Each Kernel puts more weight on the observations nearer to T0 than those which are further away. It may
put zero weight on some observations, as in (17) and (18) above. The Gaussian kernel (19) is positive for all
values of x and thus takes into account all observations, but the weights of observations further away than
−3 and 3 are negligible.

The bandwidth h plays a crucial role. Small h would produce a non-smooth m essentially interpolating
the data. A larger than necessary h would result in over-smoothing. For p = 1, when a straight line ﬁtted
locally, an optimal value of h can be obtained from the observed data. We refer to Wand and Jones (1995)
for details.

Once the kernel K and bandwidth h is speciﬁed, at any T0, ˆβ in (16) can be easily obtained using weighted
regression. In fact, an analytic formula, involving only matrix manipulation to ﬁnd ˆβ is available. From (15)
the estimate of m(T0) and α (T0), denoted ˆα (T0) = ˆm(T0) = ˆβ0.

7

4.0.2. Derivative Estimation. Using LPR technique, any point T0 the value of m(j)(T0) can be easily esti-
mated. From (15), the estimate is simply given by:

(20)

(cid:100)m(j)(T0) = j! · ˆβj.

Thus the estimated value of α(1) (T0) (denoted ˆα(1) (T0)) is simply ˆβ1 obtained from LPR at T0.

The estimate in (20) is in general diﬀerent from the derivative of ˆm at T0. In fact, the latter would be a

bad estimate for noisy data especially for large values of j. (Brabanter et al., 2013)

The accuracy of (cid:100)m(j) depends on the value of p i.e the order of the polynomial being ﬁt locally. It can
be shown that (Wand and Jones, 1995) in order to estimate the jth derivative, a in some sense it is better
to choose p such that p − j is an odd number.

We close this section by making two comments. First of all, for LPR it is not strictly required that the
temperatures Ti be equi-spaced. Furthermore, T0 does not need to equal Ti for any i. It is suﬃcient that T0
is a point within the range of observed temperatures. Thus we can estimate α and α(1) on a temperature grid
ﬁner than width γ. It is not also required to use that same bandwidth for the whole data. It is natural often
to use diﬀerent bandwidth for diﬀerent T0. Several adaptive procedures to obtain such optimal variable local
bandwidths are available. However, LPR would not be give accurate results T0 is too close to the boundary.
This is an inconvenience common to many smoothing techniques.

4.0.3. Kinetic and Thermodynamic Parameter Estimation. The smoothed values of αci (i.e ˆαci), α(1)
(i.e
ci
ci ) and those of αhi (i.e ˆαhi), α(1)
ˆα(1)
hi ) can be determined using LPR for all values of Ti from
the annealing and melting curves respectively. Once these values are available, depending on the system,
equations (9a),(9b) or (10a),(10b) can be solved at each Ti to obtain the values of Ckon and koﬀ at Ti. Here
for convenience we take C = 1 for intramolecular reactions.

(i.e ˆα(1)

hi

c

If hysteresis is observed, the apparent half temperatures of the annealing and melting phase denoted
T1/2-anneal and T1/2-melt respectively will be far apart. They are the temperatures at which the minimum
values of ˆα(1)

h were respectively obtained.

and ˆα(1)

In order to estimate the activation energies Eon and Eoﬀ the Arrhenius Plot is used. Because of larger
change in the absorbance on the annealing and melting curves around respective T1/2-anneal and T1/2-melt
kon and koﬀ can be accurately measured around these temperatures. Thus the Arrhenius Plot is drawn near
these two temperatures.

In order to estimate Aon and Eon we perform a linear regression of log(Ckon) on 1/T around T1/2-anneal.
Suppose aon and bon are respectively the estimated intercept and slope of this ﬁt. From (11) it is clear
that the estimates of Aon (denoted ˆAon) and Eon (denoted ˆEon) are given by, log( ˆAon) = aon − log(C) and
ˆEon = −R · bon.

Similarly, suppose aon and bon are respectively the estimated intercept and slope of the regression of

log(koﬀ) with 1/T around T1/2-melt. Thus, from (12) one can ﬁnd log( ˆAoﬀ) = aoﬀ and ˆEoﬀ = −R · boﬀ.

We can express the change in enthalpy in terms of bon and boﬀ as

(21)

∆H ◦ = ˆEon − ˆEoﬀ = −R (bon − boﬀ) .

The change in free energy at any given temperature T (cid:63) is given by ∆G◦

T (cid:63) = −RT (cid:63) log (kon (T (cid:63))) +
RT (cid:63) log (koﬀ (T (cid:63))). However, since the relation between kon and koﬀ with T can only be accurately deter-
mined closer to T1/2-anneal and T1/2-melt, Bhattacharyya et al. (2011) suggest using the predicted values
obtained from the linear ﬁts described above. Thus at T (cid:63) we get,

(22)

(23)

(24)

log (kon (T (cid:63))) = aon − log(C) +

bon
T (cid:63) ,

log (koﬀ (T (cid:63))) = aoﬀ +

∆G◦

T (cid:63) = −RT (cid:63)

boﬀ
T (cid:63) ,
(cid:26)

(aon − log(C) − aoﬀ) +

8

(cid:27)
1
T (cid:63) (bon − boﬀ)

.

From the expressions of ∆H ◦ and ∆G◦

T (cid:63) above, we can express T (cid:63)∆S◦ = ∆H ◦ − ∆G◦

T (cid:63) in terms of aon,

aoﬀ, bon and boﬀ. The explicit expression turns out to be,

(25)

T (cid:63)∆S◦ = RT (cid:63) (aon − log(C) − aoﬀ) .

Clearly, ∆H ◦ and T (cid:63)∆S◦ can be obtained directly from the linear ﬁts on the Arrhenius plot. ∆G◦

T (cid:63) can

then be calculated from ∆H ◦ and T (cid:63)∆S◦.

4.0.4. Finding the temperature of mid-transition. The temperature of mid-transition Tm can be computed
by solving (24) with known values of ∆GTm . For intramolecular reactions it is known that ∆GTm = 0, which
implies

(26)

Tm =

boﬀ − bon
aon − aoﬀ

◦ K.

For intermolecular reactions with two complimentary oligoes ∆GTm = RTm log(C/2). This leads to

(27)

Tm =

boﬀ − bon
aon − aoﬀ − log(2)

◦ K.

In both cases Tm does not depend on either γ or C.

5. Software Implementation

The whole procedure described in Section 4 can be implemented with available statistical softwares. For
our purpose we use packages from a statistical repository called R. (R Core Team, 2012) This repository is
completely free and contains the most up to date tools available to statisticians. Furthermore, one can easily
write codes in R and thus all parts of the procedures mentioned above can be integrated in a single piece of
code.

As we have mentioned before, determination of the bandwidth h used in LPR is crucial. A bad choice of h
may produce a over or under smoothed solution, which will aﬀect the values of kon, koﬀ and other parameters
at a later stage. We are not required to use the same h for all the points. The thermal curves do not change
much near the two ends, but large changes in absorbance are observed around T1/2-anneal and T1/2-melt.
Thus it is advisable to use diﬀerent bandwidths for diﬀerent parts of the curves.

The optimal bandwidth depends on the choice of kernel function K as well. There is a vast literature in
statistics dealing with determination of optimal global or local optimal bandwidths. We skip the technical
details here.

ci and ˆα(1)

For our purposes we use the a function named lokerns from the package named lokern (Herrmann and
Maechler, 2013) in R. In order to ﬁnd the smoothed values ˆαci of αci at any temperature Ti, the lokerns
function uses Gaussian kernel to compute an adaptive local plug-in bandwidth. With this variable local
bandwidth and using Gaussian kernel the values of ˆαci are ﬁnally calculated. The smoothed values ˆαhi and
derivatives ˆα(1)
hi at each Ti are calculated similarly. We use separate runs of lokerns to calculate
the above four functions. Thus the optimal local bandwidths for each of them are diﬀerent. After obtaining
ˆα(1)
h , The values of T1/2-anneal and T1/2-melt can be easily obtained. One however, needs to be
c
careful about the spurious low values of the derivatives near the ends of the temperature range.
ci and ˆα(1)

hi at each Ti, it is easy to solve equations (10a) and (10b)
to obtain the values of Ckon and koﬀ. For the purpose of the Arrhenius plot it is suﬃcient to obtain these
values near T1/2-anneal andT1/2-melt. However, we compute Ckon and koﬀ for all available temperatures.
This is computationally wasteful but only slightly.

From the available values of ˆαci, ˆαhi, ˆα(1)

and ˆα(1)

The linear ﬁts in the Arrhenius plots are easily obtained using the lm function in R. From lm the values
of aon, bon, aoﬀ and boﬀ are obtained. The thermodynamic parameters at a temperature T (cid:63) are calculated
from these using the formula in equations (21), (24) and (25).

6. Illustrative Examples

In this section we present two illustrative examples of the procedure described above. Our ﬁrst example
considers intramolecular G-Quadruplex formation of two speciﬁc RNA strands. In the second example we
consider duplex formation by LNA modiﬁed DNA strands at two diﬀerent pH values.

9

(a) Smoothed data.

(b) Derivative.

(c) Arrhenius Plot.

Figure 2. Smoothed curve 2(a), Derivative 2(b) and Arrhenius Plot 2(c) for the intramolec-
ular G-quadruplex formation described in Pandey et al. (2013). The fraction of the Quadru-
plex was calculated using Equation (7). The results were obtained from the proposed soft-
ware. The solid lines correspond to melting and the dashed lines correspond to annealing.

6.0.1. Intramolecular G-Quadruplex formation. Pandey et al. (2013) considered the eﬀect of loops and G-
quartets on the stability of RNA G-quadruplexes. We select two RNA strands from this article. They are
namely, BAP1 (5(cid:48)-GGGUGGGCCCUGGGC UCUGGG-3(cid:48)) and CCDC64 (5(cid:48)−GGGCCCCAUGGGUCCGGGAGGG−3(cid:48)).
For both of these strands hysteresis was observed for a temperature gradient of 0.25◦C per minute.

The ﬁtted values, derivative and the Arrhenius Plot for the BAP1 strand is presented in Figure 2. The
ﬁgures were drawn using the basic plotting function in R. The ﬁtted values (Figure 2(a)) show pronounced
hysteresis which is reﬂected in the diﬀerence in the values of T1/2-melt and T1/2-anneal as observed in Figure
2(b). The Arrhenius plot is in Figure 2(c).

In Table 1 we present the values of the kinetic and thermodynamic parameters of the G-quadruplex
formation of BAP1 and CCDC64 obtained using our method. The quoted values of kon and koﬀ are for
25.0◦C. These values were found by extrapolating the linear ﬁts of their corresponding values near T1/2-anneal
and T1/2-melt in the Arrhenius Plot (see equations (22) and (23)). The values of Tm turns out to be 71.0◦C
and 67.7◦C respectively. These values are pretty close to corresponding temperatures reported by Pandey
et al. (2013), which are 73.0◦C and 70.0◦C for BAP1 and CCDC64 respectively. This shows that using the
proposed procedure one can compute the value of Tm quite accurately from non-equilibrium thermal curves.

6.0.2. LNA modiﬁed duplex formation. For our second illustrative example, we consider data from a hy-
bridization experiment of duplex formation consisting of PuP (5(cid:48) − AGAAAGAGAAGA − 3(cid:48)) and Py0
(5(cid:48) − TCTTTCTCTTCT − 3(cid:48)). These sequences were used by Bhattacharyya et al. (2011), who further
introduced LNA modiﬁcation at the cytosine bases of Py0.

They performed the melting and annealing both with a temperature gradient of 0.5◦C per minute with
C = 10−6 mol and reported marked hysteresis in the hybridization of PuP and LNA modiﬁed Py0. Extent

Table 1. Kinetic and thermodynamic parameters of the hybridization experiment of in-
tramolecular RNA G-Quadruplexes formation from Pandey et al. (2013). The quoted values
of kon, koﬀ, T ∆S◦ and ∆G◦
T are those predicted at 25.0◦ C by the linear ﬁts of the Arrhenius
plot.

Strand

T1/2-anneal T1/2-melt

BAP1
CCDC64

71.0◦C
66.6◦C

75.0◦C
70.8◦C

kon
(M −1s−1)
2.67
23.6

koﬀ
(s−1)
1.75 × 10−4
1.32 × 10−4

∆H ◦
(kcal mol−1)
−43.0
−57.5

T ∆S◦
(kcal mol−1)
−37.2
−50.3

∆G◦
T
(kcal mol−1)
−5.74
−7.21

10

4050607080900.00.20.40.60.81.0Temperature in degree CFraction of Quadruplex70.9774.97405060708090−0.04−0.03−0.02−0.010.00Temperature in degree CDerivative of Fraction of Quadruplex70.9774.970.002870.002890.00291−6.8−6.7−6.6−6.5Temperature in degree K-1Logarithm of C.kon or koffllllllllllll(a) Smoothed data.

(b) Derivative.

(c) Arrhenius Plot.

Figure 3. Smoothed curve 3(a), Derivative 3(b) and Arrhenius Plot 3(c) for PuP/Py4
sequence as described in Bhattacharyya et al. (2011). The solid lines correspond to melting
and the dashed lines correspond to annealing. The fraction of the duplex was calculated
using Equation (7). The results were obtained from the proposed software. Note that our
value for T1/2-melt and T1/2-anneal are close to the values of these parameters reported in
Bhattacharyya et al. (2011).

of this hysteresis increased with the number of LNA modiﬁcations. We choose data from the hybridization
of Py0 and Py4 (5(cid:48) − TCLTTTCLTCLTTCLT − 3(cid:48)), with LNA modiﬁcation (denoted by CL) on all four
cytosine bases of Py0 for our purpose.

The hybridization of PuP/Py4 shows a marked Hysteresis for both pH (5.0 and 7.0) values. We present
the ﬁtted values, derivative and the Arrhenius Plot for pH 7.0 in Figure 3. In Table 2 the values of the kinetic
and thermodynamic parameters of the hybridization experiment of PuP/Py0 and PuP/Py4 obtained using
our method are presented. As before the quoted values of kon and koﬀ are for 25.0◦ C and were obtained by
extrapolating the linear ﬁts in the Arrhenius Plot as described above.

7. Conclusion

In this article we describe a statistical procedure to analyze UV thermal curves from nucleic acid hy-
bridization experiments showing hysteresis. Our procedure provides an uniﬁed tool to obtain all the kinetic
and thermodynamic parameters of the experiment. We use a statistical technique called local Polynomial
regression to smooth the experimental data and to ﬁnd the derivative of the smoothed curve. The kinetic
rate constants are then computed by solving a pair of linear equations. The thermodynamic constants are
obtained from these kinetic constants via the Arrhenius plot. All the tools used in our package are available

Table 2. Kinetic and thermodynamic parameters of the hybridization experiment of
PuP/Py0 and PuP/Py4 reported in Bhattacharyya et al. (2011). The quoted values of
kon, koﬀ, ∆H ◦, T ∆S◦ and ∆G◦
T are those predicted at 25.0◦C by the linear ﬁts of the
Arrhenius plot.

Strand pH T1/2-anneal T1/2-melt

Py0

Py4

5.0
7.0
5.0
7.0

25.5◦C
15.4◦C
53.0◦C
32.9◦C

28.5◦C
19.2◦C
71.0◦C
48.8◦C

kon
(M −1s−1)
5.07 × 107
1.67 × 107
1.44 × 1010
8.50 × 107

koﬀ
(s−1)
11.8
16.9
4.70 × 10−6
0.18

∆H ◦
(kcal mol−1)
−59.4
−40.8
−116.0
−66.1

T ∆S◦
(kcal mol−1)
−50.3
−32.6
−94.4
−54.2

∆G◦
T
(kcal mol−1)
−9.11
−8.23
−21.2
−11.9

11

0204060800.00.20.40.60.81.0Temperature in degree CFraction of Duplex32.948.8020406080−0.05−0.03−0.010.01Temperature in degree CDerivative of Fraction of Duplex32.948.80.003150.003200.003252.02.22.42.62.83.03.2Temperature in degree K-1Logarithm of C.kon or kofflllllllllllfor free from a statistical software called R. An user-friendly web based version of our package is under
construction and will be made available soon.

Acknowledgement

J. Bhattacharyya was a recipient of the Research Associateship from the CSIR (Govt. of India). D.
Miyoshi is supported in part by Grants-in-Aid for Scientiﬁc Research, the “Core Research” project (2009 −
2014) from the Ministry of Education, Culture, Sports, Science and Technology, Japan, the Hirao Taro
Foundation of the Konan University Association for Academic Research, and the Long-Range Research
Initiative Project of Japan Chemical Industry Association. S. Chaudhuri is partially supported by the Grant
R-155-000-111-112 from National University of Singapore. Support and cooperation from the members of
the Biophysical Chemistry Laboratory, Indian Institute of Chemical Biology and Departments of Chemistry
and Computer Science, National Institute of Technology Nagaland are gratefully acknowledged.

References

Nakano, S.; Karimata, H.; Ohmichi, T.; Kawakami, J.; Sugimoto, N. Journal of the American Chemical

Society 2004, 126, 14330–14331.

Miyoshi, D.; Karimata, H.; Sugimoto, N. Journal of the American Chemical Society 2006, 128, 7957–7963.
Miyoshi, D.; Nakamura, K.; Tateishi-Karimata, H.; Ohmichi, T.; Sugimoto, N. Journal of the American

Chemical Society 2009, 131, 3522–3531.

Ray, A.; Maiti, M.; Nandy, A. Comput. Biol. Med. 1996, 26, 497–503.
Mirzoev, A.; Lyubartsev, A. P. Journal of Chemical Theory and Computaion 2013, 9, 1512–1520.
Mergny, J.-L.; Lacroix, L. Oligonucleotides 2003, 515–537.
Sugimoto, N.; Wu, P.; Hara, H.; Kawamoto, Y. Biochemistry 2001, 9396–9405.
Roug´ee, M.; Faucon, B.; Mergny, J. L.; Bercelo, F.; Giovannangeli, C.; Garestier, T.; H`el`ene, C. Biochemistry

1992, 9269–9278.

Cantor, C. R.; Schimmel, P. R. Biophysical Chemistry Part III ; W. H. Freeman and Company, 1980.
Brown, N. M.; Rachwal, P. A.; Brown, T.; Fox, K. R. Org. Biomol. Chem. 2005, 3, 4153–4157.
Anshelevich, V. V.; Vologodskii, A. V.; Lukashin, A. V.; Frank-Kamenetskii, M. D. Biopolymers 1984, 23,

39–58.

Hickman, D. T.; King, P. M.; Cooper, M. A.; Slater, J. M.; Mickleﬁeld, J. Chem. Commun. 2000,
Kaur, H.; Babu, B. R.; Maiti, S. Chem. Rev. 2007, 107, 4672–4692.
Bhattacharyya, J.; Maiti, S.; Muhuri, S.; Nakano, S.; Miyoshi, D.; Sugimoto, N. Biochemistry 2011, 7414–

7425.

Blask´o, A.; Dempcy, R. O.; Minyat, E. E.; Bruice, T. C. Journal of the American Chemical Society 1996,

118, 7892–7899.

Arya, D. P.; Bruice, T. C. Proceedings of the National Academy of Sciences 1999, 96, 4384–4389.
Kumar, N.; Nielsen, K. E.; Maiti, S.; Petersen, M. J. Am. Chem. Soc. 2006, 128, 14–15.
Lesnik, E. A.; Risen, L. M.; Driver, D. A.; Griﬃth, M. C.; Sprankle, K.; Freier, S. M. Nucleic Acids Research

1997, 25, 568–574.

Mergny, J.-L.; De Cian, A.; Ghelab, A.; Sacc`a, B.; Lacroix, L. Nucleic Acids Research 2005, 33, 81–94.
Tran, P.; De Cian, A.; Gros, J.; Moriyama, R.; Mergny, J.-L. In Quadruplex Nucleic Acids; Chaires, J. B.,
Graves, D., Eds.; Topics in Current Chemistry; Springer Berlin Heidelberg, 2013; Vol. 330; pp 243–273.

Mergny, J.-L.; Lacroix, L. Current Protocols in Nucleic Acid Chemistry; John Wiley & Sons, Inc., 2001.
Sacc`a, B.; Lacroix, L.; Mergny, J.-L. Nucleic Acids Research 2005, 33, 1182–1192.
Zhang, A. Y. Q.; Balasubramanian, S. Journal of the American Chemical Society 2012, 134, 19297–19308.
Pandey, S.; Agarwal, P.; Maiti, S. J. Phyis. Chem. B 2013, 6896–6905.
Kaur, H.; Wengel, J.; Maiti, S. Biochemistry 2008, 47, 1218–1227.
Das, A.; Bhadra, K.; Suresh Kumar, G. PLOS One 2011, 6, e23186.
Bhadra, K.; Suresh Kumar, G. Med. Res. Rev. 2011, 31, 821–862.
Saha, I.; Hossain, M.; Suresh Kumar, G. J. Phys. Chem. B. 2010, 114, 15278–15287.
R Core Team, R: A Language and Environment for Statistical Computing. R Foundation for Statistical

Computing: Vienna, Austria, 2012; ISBN 3-900051-07-0.

12

Arora, A.; Maiti, S. J. Phys. Chem. B 2009, 113, 10515–10520.
Mergny, J.-L.; Lacroix, L. Current protocols in Nucleic acid Chemistry 2009,
Savitzky, A.; Golay, M. J. E. Anal. Chem. 1964, 36, 1627–1639.
Marchand, P.; Marmet, L. Rev. Sci. Instrum. 1983, 54, 1034–1041.
Brabanter, K. D.; Brabanter, J. D.; Moor, B. D.; Gijbels, I. J. Mach. Learn. Res. 2013, 14, 281–301.
Wand, M. P.; Jones, M. C. Kernel Smoothing; Chapman & Hall/CRC: Boca Raton, FL, 1995.
Herrmann, E.; Maechler, M. lokern: Kernel Regression Smoothing with Local or Global Plug-in Bandwidth.

2013.
Email address: jhimli.bhattacharyya@gmail.com

Department of Chemistry, National Institute of Technology Nagaland, Chumukedima, Dimapur, Nagaland, 797

103, India.

Biophysical Chemistry Laboratory, CSIR-Indian Institute of Chemical Biology, 4 Raja S. C. Mullick Road,

Jadavpur, Kolkata 700 032, India

Proteomics and Structural Biology Unit, Institute of Genomics and Integrative Biology, CSIR, Mall Road,

Delhi, 110 007, India

Frontiers of Innovative Research in Science and Technology (FIRST), Konan University, 7-1-20 Minatojima-

minamimachi, Chuo-Ku,Kobe 650-0047, Japan

Email address: stasc@nus.edu.sg

Department of Statistics and Applied Probability, National University of Singapore, 6 Science drive 2, Singa-

pore 117 546

13

