BenchmarkingDFTB+ontheﬁrstsingletverticalexcitationenergyofsmallorganicmoleculesAndr´esI.BertoniandCristi´anG.S´anchez∗InstitutoInterdisciplinariodeCienciasB´asicas(ICB-CONICET),UniversidadNacionaldeCuyo,PadreJorgeContreras1300,Mendoza5502,ArgentinaWebenchmarkedtheexcitedstatemethodsthatarecurrentlyavailablewithintheDFTB+suiteofdensityfunctionalbasedtightbinding(DFTB)implementations.Forthistask,wecomputedtheﬁrstsinglet-singletverticalexcitationenergy(E1)forthenearly21,800smallorganicmoleculesintheGDB-8chemicalspace.Wecomparedtheseresultswiththoseoflessapproximatemethodsfromareferencedatasetanddiscussedthenatureoftheencounteredlimitationsintermsoftheapproximationsmadetotheparentformalism,densityfunctionaltheory(DFT).Combiningourbenchmarkresultswithchemicalintuition,weconstructeda“ruleofthumb”toassisttheDFTB+communityofusersinselectingthemostreliableDFTB-approximatemethodfortheexcitedstatecalculationsoftheirmolecularsystemsofinterest.Formostchemicalsubfamilies,followingthissetofrecommendationsledtoE1estimationswithseeminglynormalerrordistributions,mostlycontainedwithin±1eV.Basedonourdiscussionoftheidentiﬁedlimitations,wealsoproposedtothedevelopercommunityapossibledirectionforimprovement.INTRODUCTIONDFTB+isapopularandopensourcescientiﬁcsoft-warepackagethatoﬀersafastandscalableimple-mentationofthedensityfunctionalbasedtightbind-ing(DFTB)method[1].Amongthemanyimple-mentedfeatures,whicharebeingactivelydeveloped[2]byitsvastcommunityofusers,thereisavailableasetofmethodsforsimulatingthephoto-absorptionspectroscopyofmolecularsystems;namely,thetime-dependentDFTBmethod(TD-DFTB)andtheDFTB-approximateparticle-particlerandomphaseapproxima-tion(ppRPA)[3].InDFTB+,TD-DFTBexistsastwodistinctbutequivalentimplementations:oneisbasedonCasida’slinearresponse(LR)approach[4]andtheotherisareal-timeimplementationbasedonthesemi-classicalEhrenfestmethodfornuclear-electronicdynamics[5].Employingasemi-empiricalmethodsuchasDFTBtoapproximatetheelectronicexcitedstatesofmoleculesiscertainlyexpectedtobeachallenge,consideringthatitsapproximationstotheparentabinitiomethod,densityfunctionaltheory(DFT)[6,7],entailalossofaccuracyinthecomputedpredictions.Nonetheless,therelativelyloweraccuracyofDFTBiswidelycompensatedbyasub-stantialdropincomputationalcost,whichextendsthefeasibilityupperlimitinsize,timescaleandcomplexityofthesystemstobestudied.Inotherwords,theap-proximationsofDFTBbringquantummechanicstosys-temsthatotherwisewouldbetreatedwithclassicalforceﬁelds.Asaresult,DFTBisbeingwidelyemployedinpureandhybridQM-schemesforthesimulationofthespectroscopicpropertiesofnanostructures[8],photoac-tivematerials[9]andcomplexbiologicalsystems[10]ofmanythousandsofatoms.Onewaytomeasuretheimpactofamethod’sapprox-imationsonitsresultsisbybenchmarkingitscapabili-tiesincomparisonwithareferencemethod.Abench-markcanalsosavetheuserfromhavingtosystemati-callyexplorewhichoftheavailabletoolsorapproacheswithinthepreferredsoftwarepackageisthemostade-quatechoiceforthesystemathand.Althoughtherearereportedsomeotherbenchmarksconcerningspeciﬁcim-plementationsinDFTB+[11–15],wecouldnotﬁndanas-sessmentofitscapabilitiesregardingthepredictionofex-citationenergiesforalargenumberoforganicmoleculeswithdiversechemicalidentities.Inthisworkwebench-markthecurrentlyavailablemethodsinDFTB+forsimu-latingthespectroscopyofmolecularsystems,bycomput-ingtheﬁrstsinglet-singletverticalexcitationenergy(E1)forthenearly21,800smallorganicmoleculesintheGDB-8chemicalspace[16].Inordertodetectthestrengthsandlimitationsofthebenchmarkedmethods,wecom-pareitspredictionswithlessapproximatemethodsfromareferencedataset,andusemoleculardescriptorsbasedonchemicalidentitytoperformthedataanalysis.Addi-tionally,inordertoimprovetheinitialE1estimations,webenchmarkedsomeimplementedextensionstothestan-dardDFTBformalism,andproposetothecommunityofdevelopersapossibledirectionforimprovementregard-ingtheidentiﬁedlimitations.Lastly,weprovidea“ruleofthumb”toaidthecommunityofusersinthecompu-tationoflow-lyingsingletverticalexcitationenergiesofmolecularsystemsusingDFTB+.OVERVIEWOFMETHODSOurworkisaimedtobothexpertsandbeginnersintheDFTB+communitythatshareaninterestinthecom-putationofexcitationenergieswithintheDFTBframe-work.Thus,wehavedecidedtoincludebriefoverviewsofthemethodsrevisedinthiswork,whichwillaidthereaderinthediscussionoftheresults.However,westronglyrecommendthereaderstorefertotheorigi-arXiv:2205.06195v2  [physics.chem-ph]  13 Jul 20222nalpublicationsfortherespectiveimplementationsofDFTB[2],TD-DFTB(DFTB-Casida)[11]andpp-DFTB(DFTB-ppRPA)[3].Wealsowanttorecommendaped-agogicalintroductiontothosewhoarecompletelynewtoDFTB[17].SCC-DFTBapproximationstoKS-DFTWecancompletelycharacterisetheself-charge-consistentversionofDFTB(SCC-DFTB)bylistingitsapproximationstoKohn-Sham’sDFT(KS-DFT).Thissetofadditionalapproximationstotheparentframeworkarekeytoitssuperioreﬃciency.DFTBisderivedfromatruncatedexpansionoftheKS-DFTtotalenergyfunc-tional.Inthiswork,wemadeuseofSCC-DFTB,whichincludestermsuptothesecondorderintheexpansionoftheground-stateelectrondensityρ,aroundareferencedensityρ0beingperturbedbydensityﬂuctuationsδρ:ESCC-DFTB[ρ0+δρ]=E0[ρ0]+E1[ρ0,δρ]+E2hρ0,(δρ)2iThetruncationthatleadstotheaboveexpressionconsti-tutestheﬁrstapproximationofSCC-DFTBtotheexactKS-DFTtotalenergyfunctional.Sinceρ0istypicallyconstructedasasuperpositionofneutralatomicdensi-ties,δρwouldbeaccountingforthechemicalenviron-mentofeachatomwithinthemolecule.InapproximateKS-DFT,themolecularorbitalsareexpandedinthebasisofatomcenteredbasisfunctions,i.easalinearcombina-tionofatomicorbitals(LCAO):ψi(r)=Xµciµφµ(r)Thisprojectiononatom-centeredbasisfunctionscon-vertsthetime-independentSchr¨odingerequationintoaneigenvalueproblem.Asasecondapproximation,DFTB’sstandardformulationemploysaminimumsetofvalenceorbitalbasisfunctions(i.e.aminimalbasisset)tosim-plifythelinearalgebraoperations.Inpractice,theseba-sisfunctionsareslightlycompressedatomic-likesolutionstotheKS-DFTequations.Intheexpansionofthetotalenergy,thezeroth-ordertermE0[ρ0]istheenergyassociatedwiththerepulsioninteractionbetweenthenucleiandbetweentheatomiccontributionstothereferencedensityρ0.Thethirdap-proximationofDFTBistowriteE0[ρ0]asasumofpair-potentials:E0[ρ0]≈12XABVrepAB(RAB)Theﬁrst-ordertermE1[ρ0,δρ]istheband-structureen-ergy,whichinvolvesthecomputationofmatrixelementsofthereferenceHamiltonianH[ρ0]:E1[ρ0,δρ]=XifiXµνci∗µciνH0µνµ∈A,ν∈BwherefiaretheFermioccupationsoftheground-statemolecularorbitalswithintheLCAOansatz.Obtain-ingthesematrixelementsrequirethecomputationofthree-centerintegrals,becausetheyinvolveatomicor-bitalsfromtwodiﬀerentcenters,φµ(r)andφν(r),andtheeﬀectivepotentialatthereferencedensity,Vs[ρ0](r).ThefourthapproximationofDFTBistoneglectthetwo-centercrystal-ﬁeldcontributionsandthethree-centerin-teractionsinthebandenergyterm,transformingtheref-erenceHamiltoniandiagonalandnon-diagonalelements,H0µµandH0µν,intolessexpensiveone-andtwo-centerintegrals,respectively.Additionally,SCC-DFTBmakestwoapproxima-tionstotheenergyfromchargeﬂuctuations,i.e.thesecond-orderterminthetotalenergyexpression(E2hρ0,(δρ)2i).TheﬁfthapproximationofSCC-DFTBisthemonopoleapproximationofthegroundstate(GS)chargedensityδρ.Thezeroth-ordertruncationofthemultipoleexpansionofδρneglectstheone-centertwo-electronintegralsandintroducesthecomputationofpar-tialatomicchargesqA(andatomicpopulations∆qA)fromtwo-centerorbitaloverlapmatrixelementsSµν,un-dertheMullikenpopulationanalysis:∆qA=qA−q0AwhereqA≡XifiXµ∈AXν12(cid:0)ci∗µciνSµν+ci∗νciµSµν(cid:1)andq0AisthenumberofvalenceelectronsinneutralatomA.Noticethatthecharge-ﬂuctuationenergytermistheoneturningDFTBintoaSCCmethod,sincetheatomicpopulationsthemselvesdependonthemolecularorbitalcoeﬃcients.Lastly,SCC-DFTB’ssixthapprox-imationistoenforcethelocalityofXCcontributions,makingthecharge-ﬂuctuationinteractiononlyelectro-static(i.e.Coulombic)fordiﬀerentcenters.Theinter-actionsbetweentheatomicpopulationsfollowsadepen-dencewiththeinter-atomicdistancegivenbyananalyt-icaldensityproﬁlefunctionγAB(e.g.aGaussianpro-ﬁle)thatbecomesequaltotheHubbardUAparameterwhenA=B,whichisanon-sitecontributionlinkedtothechemicalhardnessoftheatom:E2hρ0,(δρ)2i≈12XABγAB(RAB)∆qA∆qBAverystrongpointtowardsthesuperiorcomputationalperformanceofDFTBisthepre-computationofmatrixelementsandrepulsionpair-potentialsplines.Withthisstrategy,thecostassociatedwithhavingtocomputetheapproximateintegralsistransferredtoaone-timeparam-eterizationprocess.TheHamiltonianandoverlapmatrixelementsH0µµandSµν,neededfortheﬁrst-andsecond-orderenergyterms,arehighlytransferableastheyare3pre-determinedforareferencedensity.Withinthestan-dardSCC-DFTB,theseelectronicparametersarepre-computedforvariousinteratomicdistancesusingamin-imalbasissetofpseudo-atomicKS-orbitals,obtainedfromatomicDFTcalculationswithaconﬁningpoten-tialandalocal-XCfunctional,suchastheparameter-freePerdew-Burke-Ernzerhof(PBE)functionalofthegeneralisedgradientapproximation(GGA)class.Inanindependentstageoftheparameterizationprocess,thezeroth-orderrepulsivepair-potentialsaremostoftenﬁt-tedtoresultsfromDFTcalculations[1,18–20]forasetofelementpairs,butthesefunctionscanalsobeﬁttedtoexperimentaldata(e.g.,equilibriumgeometries,atom-izationenergiesandvibrationalfrequencies)[21].WhenDFTisusedtoﬁttherepulsivefunctions,calculationsareexpectedtobeperformedclosetothebasissetlimitandwithhigh-qualityfunctionals.TheserepulsionfunctionsaretheparametersthatmakeDFTBasemi-empiricalmethodand,instandardSCC-DFTB,areexpectedtoencodeallthechemicallyrelevantnon-localnatureoftheelectron-electroninteraction.TheHubbardUAparame-tersarealsoobtainedfromDFTpre-computations.AllthesenumbersaregeneratedviatheSlater-Koster(SK)technique[22]andstoredasSK-ﬁlesfordiﬀerentpairsofchemicalelements;thissetofﬁlesiswhatwecallaparametersetinDFTB.Itisalsopossibletoimprovetheﬁrstapproximationandextendtheexpansionofthetotalenergytoincludehigher-orderenergyterms.DFTB+canperformcomputa-tionsuptothethird-orderinenergy.However,thisextraenergytermonlybecomesimportantwhenbondingre-sultsinlargeatomicchargeﬂuctuations,i.e.forlocaldensitiesdeviatingsigniﬁcantlyfromthereferenceone.TD-DFTBfromCasida’sLR-TD-DFTTheTD-DFTBmethodforcomputingexcitationener-giesisbasedonCasida’sLR-approach[23]toTD-DFT,thetime-dependentextensionoftheHohenberg-Kohntheorems.InthedynamicLRtreatmentoftheGSelec-trondensitybeingperturbedbyanexternalelectricpo-tential,Casidaderivedapseudo-eigenvalueequationinthespaceofsingle-orbitaltransitionsfromi,j-occupiedtoa,b-virtualmolecularorbitals:Xjb(cid:2)ω2iaδijδab+4√ωiaKijab√ωjb(cid:3)FjbI=ω2IFiaIwheretheKSorbitalenergygaps,ωia,andthecouplingmatrixelements,Kijab,areconstructedfromthegroundstate.ThisproblemcanbesolvedforanumberofIelec-tronictransitions,inordertodeterminetheirexcitationenergiesωIandtransitioncontributionsFiaI,whichareneededtocomputethecorrespondingtransitiondipolemomentsandapproximateexcitedstatewavefunctions.ItcanbenoticedthatωIresultsfromthecorrectionmadebythecouplingmatrix,whichaccountsfortheelectron-holeinteraction,totheinitialexcitationenergyestimategivenbytheKSenergydiﬀerence.Furthermore,FIbeingavectorindicatesthatelectronictransitionscandisplaymulti-orbitalcharacter.TD-DFTBisatranslationoftheCasida’seigenvalueproblemtotheDFTBframework.Itconsistsonextend-ingSCC-DFTBapproximationstosigniﬁcantlysimplifythecomputationofthecouplingmatrixelementsKijab.Theone-center(oron-site)exchange-likeintegralsareneglectedandtheremainingexpensivetwo-centertwo-electronintegralsareconvertedintosimplesumsforatompairs.Thefollowingistheresultingapproximateexpres-sionvalidforsinglet-singlettransitions:Kijab≈XABγAB(RAB)qiaAqjbBwhereqiaA≡Xµ∈AXν12(cid:0)ci∗µcaνSµν+ci∗νcaµSµν(cid:1)aretransitionchargesintroducedbytheMullikenmonopoleapproximation.TheXCtermintheexactex-pressionforthecouplingmatrixelementsKiajbdependsonthefullground-stateelectrondensityρ.ThatmeansthattheXCcontributionnotonlydependsontheref-erencedensity,asinthesecond-orderenergyterm,butalsoonthedensityﬂuctuationsfromtheρ0GS-reference.ThiswouldrequirepromotingtheHubbardUAparam-etersintofunctionsofthesite’satomicpopulation,i.e.UA(∆qA).However,athirdapproximationismadetoTD-DFTBinordertoneglectthesechargeﬂuctuationswhencomputingthecouplingmatrixelements,allowingreuseoftheapproximateproﬁlesγABfromtheinitialGScomputations.Itisworthpointingoutthat,asNiehaushaspreviouslyshown[11],theresultsfromtheDFTB-approximateCasidaeigenvalueproblemarecompletelyequivalenttothoseextractedfromthereal-timeTD-DFTBapproach,forwhichanimplementationinDFTB+wasreportedbyBonaf´eetal.[5].Thelatterapproachmayposeachal-lengeinthedeconvolutionofexcitationpeaksforspectro-scopicallycomplexsystems,butithassomeadvantagesoverTD-DFTB-Casida:(i)itdoesnotrequiretruncat-ingthenumberofexcitationstobecomputed,(ii)itcanresultinasuperiorcomputationalperformanceforverylargesystems,and(iii)itcanbeextendedforthecalcu-lationoftransientabsorptionspectra(TAS)simulations.Forsmallsystems,liketheonesweareemployingforthisbenchmark,TD-DFTB-Casidawasthemostconvenientchoiceintermsofperformanceandoutputparsing.4FIG.1.DiagramdepictinghowppRPAcomputesexci-tationenergiesfromtheenergiesoftwo-electronadditionprocesses.AnexcitationenergyfortheN-electronsystem(ω0→n)canbecomputedasthediﬀerencebetweentheener-giesoftwo-electronadditionprocesses(ω+20andω+2n),fromthegroundstateofatwo-electrondeﬁcientsystem(i.e.withN-2electrons)intothegroundandn-thexcitedstatesoftheresultingN-electronsystem.Thehorizontalbarsrep-resentelectronicstatesofthesamesystem,withenergiesE0(N−2)>>En(N)>E0(N).DFTB-approximateppRPABorrowedfromnuclearphysics,ppRPAisaneigen-valueproblemdescribing2-electronadditionandremovalprocesses.Itcanbeusedtopredicttheexcitationen-ergiesofN-electronsystemsviathetreatmentoftwo-electronadditionsincorrespondingtwo-electrondeﬁcient(N-2)systems:ω0→n=ω+2n−ω+20whereω+2e0andω+2enaretheeigenvaluesforthegroundstateandthen-excitedstate,respectively.TheaboveexpressioncanbebetterunderstoodwiththehelpofthediagraminFigure1.Onceagain,thetranslationintotheDFTBframeworkconsistsontheapproxima-tionofbottleneckintegrals.Originally,thematrixel-ementstobecalculatedbeforesolvingtheeigenvalueproblemeachinvolvetwointegralsoftwoelectrons.InDFTB-approximateppRPA,theMullikenmonopoleap-proximationreducestheseexpensiveintegralstosum-mationsofsimplerterms,whichsharestrongsimilaritieswiththeexpressionforthecouplingmatrixelementsinTD-DFTB.COMPUTATIONALDETAILSReferencedatasetForourbenchmarkweselectedtheQM8datasetasref-erence[16],whichcomprisesthe21786organicmoleculeswithCHONFatomsthatmaketheGDB-8subsetoftheGDB-9chemicalspace[24].Thisdatasetwascreatedforthedevelopmentofmachinelearningmodelsandin-cludestheﬁrsttwosinglet-singletverticalexcitationen-ergies,withcorrespondingoscillatorstrengths,computedwithsecond-orderapproximatecoupled-cluster(CC2)andlinear-responsetime-dependentDFT(TD-DFT).AsRamakrishnanetal.,wehavedecidedtotakeCC2withthepolarizedtriple-zetavalencesecond-generationbasisset(def2TZVP)asthereferencemethod.TheauthorsbasedtheirdecisiononthefactthatCC2/def2TZVPwasshowntopredictvalenceexcitationenergiesinverycloseproximitytoexperimentaldata[25]andtoahigher-ordercomputationalprediction[26],withmeanabsoluteerrorsof0.12eVand0.10eV,respectively.ComputingtheﬁrstsingletverticalexcitationenergyPriortothecomputationofexcitationenergies,themoleculargeometrieswerere-optimisedwithSCC-DFTBandachosenparametersetfromwww.dftb.org.Ge-ometrieswererelaxedviathelimited-memoryBroyden-Fletcher-Goldfarb-Shanno(L-BFGS)algorithm,inor-dertoachievemaximumforcecomponentsbelow10−5Eh/a0.ForeachDFTB-optimisedgeometrywithintheaddressedchemicalsub-space,wecomputedE1withthetwoapproximatemethodsavailableforthistaskinthelastversionofDFTB+[2]:DFTB-CasidaandDFTB-ppRPA.Currently,theseDFTB-approximateex-citedstatemethodsareonlyimplementedformolecularsystemsandtheSCC-DFTBleveloftheory.AlthoughwewereonlyinterestedinE1,thenumberofcomputedexcitationenergieswassetupto20,whenpossible,toaidtheconvergenceoftheeigenvaluesolvers.Speciﬁ-callyforDFTB-ppRPAcalculations,wealsosetthemax-imumnumberofvirtualstatesto1000andprovidedtheHubbard-likeparametersfromtheAppendixKoftheDFTB+manual[27].Forbothapproaches,weemployedthegeneralpurposeparameterset3OB(-3-1)[19],whichhasparametersforawidevarietyofelementspresentinbiologicalandorganicsystems.For3OB,theHamil-tonianandoverlapmatrixelementswerepre-computedusingDFTwithPBEandaminimalbasisset.Itshouldbecautionedthat,asstandardSCC-DFTBusesaminimalbasisset,RydbergstatesareoutsidethescopeofDFTB-approximateES-methods;thesepartic-ularelectronicexcitationswouldinsteadrequiretheuseofaverydiﬀusebasisset.However,webelievethatsuchstatesareunlikelytoappearastheﬁrstsingletelectronicexcitationoftypicalmolecules,sincewewouldexpectva-lenceexcitationstoplaythatrole.Inthiswork,wedecidedtocomparetheerrorofeachDFTB-approximatemethodinthepredictionofE1withrespecttoCC2/def2TZVP(∆CC2E1)withresultsfromtheparentmethod,DFT.Withthisanalysis,ouraimistodetectwhichofthelimitationsinthepredictionofE1arebeingsharedbetweentherelatedmethodsandwhichareuniquetothestandardformulationofDFTB.AstheparentmethodforthiscomparisonweselectedTD-DFT5withthehybridHF-XCvariantofthelocalPBEfunc-tional(PBE0)andthepolarizedsplit-valencesecond-generationbasisset(def2SVP).ThischoicecorrespondstothemethodwithintheQM8datasetthatismostre-latedtoDFTB:aDFTmethodusingthemostlocalXCfunctionalandthesmallestbasisset.DespitethehybridfunctionalPBE0istheclosestoneintheQM8datasettoPBE(i.e.,theGGAfunctionalemployedtocalculatetheelectronicparametersforDFTB),systematicdiﬀerencesbetweenlocalandhybridfunctionalsshouldbeexpectedregardingelectronicexcitationswithinTD-DFT;thisfactwillcontributetotheoveralldiﬀerencesinperformancebetweenTD-DFTandTD-DFTB,particularlyforπ-typeexcitations.Formoreinformationonthistopic,wewouldliketorecommendtheworkofMaierandKauppetal.[28],whichincludesasystematiccomparisonbetween(semi-)localandglobalhybridfunctionals,withrespecttothepredictionofTD-DFTelectronicexcitationener-gies,forasetoforganicmoleculesexhibitingsingletandtripletvalence,Rydberg,CT,andcoreexcitations.Val-uesofE1fromthereferencemethod,CC2/def2TZVP,andthetime-dependentextensionoftheparentmethod,TD-DFT:PBE0/def2SVP,weredirectlytakenfromtheQM8dataset;thesevalueswerecomputedfromgeome-triesrelaxedviaDFTwiththeBecke3-parameterLee-Yang-ParrhybridXC-functional(DFT/B3LYP)andthepolarizedPople-style6-31G(2df,p)basisset.UsingmoleculardescriptorsfordataanalysisForeachmoleculeinthedataset,weusedthePythonlibraryrdkit[29]toidentifyitslevelofpi-conjugationandthepresenceofcertainchemicalgroups,throughtheanalysisoftheirSMILESstrings[30].Inthatmanner,moleculeswereassignedtooneofthreemainfamiliesofchemicalcompounds:(i)π-conjugatedunsaturatedmolecules,(ii)non-conjugatedunsaturatedmolecules(i.ewithisolateddoubleortriplebonds)and(iii)saturatedmolecules(i.e.withonlysinglebonds).ViardkittoolsforhandlingtheSMILESarbitrarytargetspeciﬁcation(SMARTS)language,weassignedamoredetailedchemical-identitytothemoleculesofeachprincipalchemicalfamily.Forthistask,extrachemi-caldescriptorswereemployedinahierarchicalfashion(i.e.basedontheorderofassignationoflabels);inotherwords,amoleculeassignedtoaparticularchemi-calsub-familywasremovedfromthepoolofmoleculestobeidentiﬁedaspartofanyothersub-groupwithinthesamemainfamily.TheSMARTSfragmentsemployedareavailableinTableIofthesupplementarymaterial.Itisworthnotingoneaspectofourdataanalysis.ThemoleculesintheGDB-8chemicalsubspaceweregener-atedfollowingsyntheticfeasibilityrules,butthecombi-natorialnatureofthestructuregenerationalgorithmmayhaveresultedinstructuresthatmaybeconsideredun-usual.However,weclassiﬁedthemoleculesintochemicalfamiliesbasedontheirfunctionalgroupwiththehighestlevelofconjugation,becauseweexpectthemostcon-jugatedfunctionalgroupinamoleculetobethemaincontributortothefrontiermolecularorbitals,thuschar-acterisingthelowestelectronicexcitation.Therefore,therestofthemoleculewouldbeactingasaverylocalchem-icalenvironmentthatmodulatestheexcitationenergyofthemostconjugatedfunctionalgroup,regardlessofhowrarethechemicalarrangementis.Thisway,theconclu-sionstobedrawnmayalsoapplytomoleculeslargerthanthoseinthedataset(i.e.,ofmorethan26atoms),iftheadditionalatomsdonotextendtheconjugatedsystems;however,ifthatisthecase,thentheselargermoleculeswouldhavetheirE1closertothevisiblelightregion,butwouldstillbemembersoftheπ-conjugatedfamily,andthuswouldbeexpectedtosuﬀerfromthesamelimita-tionsastheoneswewilldiscussinthiswork.Includinglong-rangecorrectionsinTD-DFTBTobetteraccountfornon-localcontributionsandre-producethecorrect-1/RasymptotictrendforCoulom-bicinteractionsinthelongdistance,parametersetsforDFTBcanbeconstructedwithrange-separatedorlong-rangecorrected(LC)XCfunctionals.Withinthisscheme,thetwo-electroninteractionissplitintoshort-rangeandlong-rangecomponents,withthesplittingbe-ingmodulatedbytherange-separationparameterω:1r=1−e−ωrr+e−ωrrTheimplementationofDFTB+LC[4,31,32]intoDFTB+isquiterecentandthereforethereisonlyoneopenlyavailableparametersetpreparedtoincludethesecorrec-tionsintoDFTB:OB2(-1-1)[20].ThisSK-setemploysarange-separationparameterω=0.3a−10andmanagestoreproducesGSgeometriesandvibrationsofCHONor-ganicmoleculeswithasimilarqualityasDFTB3:3OB.ThankstotheDFTB+communitybeingactivelyworkingtoextendexistingparametersets,thereisreportedaveryrecentre-parameterisationofOB2toincludesulphurhet-eroatomsinorganicmolecules[33].Yet,wecouldnotﬁndanyotherreportedextensionofOB2andthereforewede-cidedtoignoretheﬂuorinatedorganicmoleculesforourDFTB+LCcalculations,asubsetthatonlyrepresentsabout1.4%ofallthemoleculesinthedataset.Includingon-sitecorrectionsinTD-DFTBThestandardSCC-DFTBformalismcanbeextendedtopartiallycorrectthemonopoleapproximationofthetransitionchargedensityinCasidaTD-DFTB,inordertonolongerneglecttheon-siteintegralsoftheexchange6type.ThisimplementationisknowninDFTB+ason-sitecorrections(OC)[13].Thiscorrectionrequiresprovid-ingadditionalon-siteconstantsthatdependonlyontheXC-kernel,whichweextractedfromtheAppendixJoftheDFTB+manual[27].Onceagain,wehaveignoredﬂu-orinatedmoleculesfortheDFTB+OCcomputations,astherearenoavailablepre-computedon-siteconstantsforﬂuorine.PartiallypolarizingtheminimalbasissetThestandardformulationofDFTBischaracterisedbytheuseofaminimalbasisset.However,wecouldinsteademployanextended,yetlimited,basissetforthepre-computationoftheelectronicintegralsintheparametersetSK-ﬁles.WiththeSkProgspackage[34]forDFTB+,wecus-tomisedthe3OBparametersettoslightlyextendthebasissetandallowtheminimalpolarizationofonlytheHatoms;wedecidedtonamethisproof-of-conceptpa-rameterset“3OB(H*)”.Toachievethisminimallypo-larizedminimalbasisset,weaddedempty2porbitalstoprovideextraangulardegreesoffreedomtothevalenceelectronsonthehydrogencentersandbreaktheoriginalradialsymmetryofthe1sorbital.Theradialdependenceoftheextrapolarizationorbitalswasscaledtobringitclosertothatofthe1svalenceorbital,butwithoutcom-promisingitsoriginalproﬁle.WeachievedthecustomradialprobabilitydensitiesofFigure2bylimitingtheradialwavefunction(seeequation7.2intheDFTB+man-ual[27])toonevariationalcoeﬃcientcandoneexponentα=√2:Rp(r)=cre−√2rAsweonlyintendedtoperformsingle-pointcomputa-tions,itwasnotnecessarytore-parameterisethepair-repulsionsplines,whichwekeptfromtheoriginal3OBSK-ﬁles.RESULTSANDDISCUSSIONInitialdiagnosticsThepredictionaccuracyofE1wascomparedbe-tweentheapproximateDFTBmethodsandTD-DFT:PBE0/def2SVP.Speciﬁcally,westartedwiththecomparisonofpredictionerrors∆CC2E1forDFTB-Casida:3OBandDFTB-ppRPA:3OB,whichareshownasdatapointsinpanelsAandBofFigure3,respectively.Thescatteredpointscorrespondtoeachofthenearly21,800moleculesintheGDB-8chemicalsubspace,andarecolouredtoreﬂecttheirmembershiptooneoftheFIG.2.Radialprobabilitydensitiesforthehydrogenorbitalsintheoriginal3OBandinthecustomH-polarized3OB(H*)parametersets.Aswasintended,thecustom1sorbitalforHinthe3OB(H*)parameterset(redsolidline)coincideswiththatoftheoriginal3OBset(blackdashedline).Thethree2porbitalsin3OB(H*),allowingpolarization,havearadialwavefunctionwithaprobabilitydensity(bluesolidline)thatpartiallyoverlapsthatofthe1sorbital.threemainchemicalfamilieswedeﬁnedbefore.Thesedatapointswerelocatedoneachofthe2Dplanesaccord-ingtothepredictionerror∆CC2E1foreachmolecule,ascomputedwiththebenchmarkedmethod(horizon-talaxis)andTD-DFT:PBE0/def2SVP(verticalaxis).Accordingly,moleculesinthelower-leftquadrant(bluebackground)haveE1valuesthatareunderestimatedbybothmethods,whilethoseintheupper-rightquadrant(redbackground)havetheirE1overestimatedbybothmethods.Inaddition,eachgroupofcolouredpointswasalsoprojectedontoeachaxis,ashistograms,toshowtheE1errordistributionforeachchemicalfamily,foreachofthecomparedmethods.Firstofall,Fig.3showsthattheerrorofE1predic-tionsstronglydependsonthemolecules’mainchemicalidentity.BasedonerrordistributionsofE1forTD-DFT,Ramakrishnanetal.ﬁrstnoticedthatpredictionscouldbedividedintotwodistinctivesetsofmoleculeswithlowenergyexcitationsofeitherπ-orσ-type;theyobservedthat,overall,E1wasunderestimatedforunsaturatedmoleculesandoverestimatedforsaturatedmolecules.InpanelAofFig.3,wefoundbroadlythesamesaturated-unsaturatedpatternforDFTB-Casida:3OB,asthevastmajorityofpointsareeitherintheunderestimationoroverestimationquadrants.ThisreproductionofgeneraltrendsbetweenTD-DFTBandTD-DFTisnotentirelysurprising,astheformermethodisanapproximationtothelatter.Ontheonehand,DFTB-Casida:3OBsystematicun-derestimationofE1forunsaturatedmolecules(withπ-typeexcitations)arisefromtheDFT-inheritedself-interactionerror(SIE).Thiswell-knownerrorinvolvesin-dividualelectronsinteractingwiththeirowndensity[35].7FIG.3.Comparisonofpredictionerrors∆CC2E1forTD-DFT:PBE0/def2SVPandfourdiﬀerentDFTB-approximateap-proaches:(A)Casida:3OB,(B)ppRPA:3OB,(C)Casida+LC:OB2and(D)Casida:3OB(H*).Thescattereddatapointscorre-spondtoeachofthenearly21,800moleculesintheGDB-8chemicalsubspace.Thedatapointsandtheprojectedhistogramswerecolouredaccordingtothemainchemicalidentityofthecompounds:greenforsaturatedmolecules,orangefornon-conjugatedmoleculeswithanisolateddoubleortriplebond,andpurpleformoleculeswithπ-conjugatedsystems.ThenumberofoccurrencesperchemicalfamilyandsubgroupisavailableintheﬁrstcolumnofTableIV,inthesupplementarymaterial.TheSIEisrelatedtothelocalapproximationoftheXCcontributiontothechargeinteractionenergy,andarisesfromtheCoulombandexchangetermsincorrectlynotcancellingeachotherexactlyatlargedistances[36].AsthesolutionsofSCC-DFTBarefoundself-consistently[37],theSIEleadstoanincorrectchargedistributioninthegroundstate,withtheconsequentartiﬁcialstabilisa-tionofthedelocalisedsolutions[38–40].ThisresultsintheunderestimationofHOMO-LUMOgaps[41]andex-citationenergiesor,equivalently,intheoverestimationofdipolepolarizabilities[42].ThisiswhyTD-DFTwithlo-calorsemi-localfunctionalsisnotrecommendedforlow-lyingelectronictransitionsinvolvingπ-conjugatedstates[42–44],noritisrecommendedforcharge-transfer(CT)excitations[28,45,46].TheSIEisparticularlyproblem-aticforCT-excitations[47],mostnotablyforsystems8withexcesscharge(e.g.,ions[48]orradicalions[49,50])andandfortransitionsinvolvingoccupiedandvirtualmolecularorbitals(MOs)withminimalspatialoverlap[51].Ontheotherhand,thereasonsbehindDFTB-Casida:3OBoverestimationofσ-typeexcitationsinsat-uratedmoleculesarenotnearlyasdiscussedastheself-interactionerrorofDFT.However,aswewilldiscusswithmoredetailinanextsubsection,thislimitationappearstoberelatedtothelowqualitydescriptionoftheMOs,duetotheuseofaminimalbasisset,andtotheapproximationstothechargedensityintheexcitedstatemethod.Oneshouldbeawarethaterrorsrelatedtothenon-completenessofthebasissetarenotexclusivetoDFTB,sinceemployingaﬁnitebasissetisanapproxima-tionpresentinmostnumericalmethodsfortheelectronicstructureofmolecules,whichofcourseincludesDFT.AlthoughTD-DFTBappearstobeinheritinglimitationsfromitsparentformalism,TD-DFT,thereareobviousdiﬀerences.Comparatively,TD-DFT:PBE0/def2SVPcanbeconsideredtobemorepreciseforallchemicalgroups,sincethevastmajorityofitspredictionsforE1haveanerrorwithin±1eV.Incontrast,theE1errordispersionforDFTB-Casida:3OBpredictionsishighlydependentonchemicaliden-tity:itisconsiderablylargeforsaturatedmolecules,with+1eV<∆CC2E1<+6eV,whileforunsat-uratedmoleculesitismoremoderate,with∆CC2E1rangingbetween−2eVand+1eV.Overall,theTD-DFT:PBE0/def2SVPmethodisexpectedtobemoreprecise—andalsocomputationallymoreexpensive—becauseitislessapproximatedthanTD-DFTB:(i)itisanabinitiomethod(i.e.aparameter-free),wheretheexpressionforthetotalenergyisasexactastheapprox-imateXC-functionalbeingchosen;(ii)itcomputestheactualXC-functional,whichisnotnecessarilypurelylocal,e.g.PBE0isahybridXC-functionalwith25%exact-HFexchange,andthereforeperformssigniﬁcantlybetterthan(semi-)localfunctionalsforvalenceandCTexcitations[28];(iii)itemploysthedef2SVPbasissetthat,althoughitisconsideredtobesmallforDFT,itiscertainlynotminimalandevenincludessomepolarization.Withintheunsaturatedmoleculesgroup,itcanbeseenthat,formoleculescharacterisedbyanisolateddoubleortriplebond,DFTB-Casida:3OBpopulatesmorethanTD-DFTthelineat∆CC2E1=0,whichcorrespondstothepredictionsofE1exactlymatchingthoseofCC2.Inotherwords,althoughthemultipleapproximationsofDFTBtoDFTmakeE1predictionslessaccurate,theyalsoledtoanincreaseincaseswhereerrorsmightbebeingcompensatedfortoproducethesamepredictionsasmethodswithahigherleveloftheory.WhileTD-DFTBandTD-DFTarestronglyrelatedinformalism,DFTB-ppRPAhasaverydiﬀerentconcep-tualorigin.DFTB-ppRPAisexpectedtoperformbetterthanTD-DFT(B)forπ-typeexcitations,andspeciﬁcallyforexcitationswithchargetransfer(CT)nature,becauseitmanagestoreproducethecorrectasymptotic−1/Rtrendfortheelectron-holeinteractioninthelongrange,evenwithinthemonopoleapproximation[3].Becauseofthis,inpanelBofFig.3itcanbeseenthatDFTB-ppRPA:3OBisnotunderestimatingE1foralloftheunsaturatedmolecules,asCasida-DFTB:3OBandTD-DFT:PBE0/def2SVPdo.Infact,DFTB-ppRPA:3OBoverestimatesmostofthenon-conjugatedunsaturatedmoleculesand,forπ-conjugatedmolecules,resultsinaE1errordistributionthatiscenteredat∆CC2E1=0,althoughwithconsiderabledispersion.Regardingthesaturatedmolecules,weobserveanE1errordistributionthatisverysimilartothatofDFTB-Casida:3OB,sug-gestingthatthislimitationoriginatesalreadyinthebaseformalism,SCC-DFTB.Basedontheresultswediscussedsofar,neitherofthetwoapproachesbasedonthestandardSCC-DFTBformalismwouldbeacceptableforpredictingE1forsaturatedmolecules.Withrespecttotheunsaturatedmolecules,DFTB-ppRPAgenerateddecentE1predic-tionsforthoseπ-conjugatedwhileDFTB-Casida:3OBdidsofornon-conjugatedones.Thisﬁrstattemptofa“ruleofthumb”fortheunsaturatedmoleculeswasim-provedbyincludinganotherlayerofchemicaldetail.InFigureS1,availableinthesupplementarymaterial,itcanbeseenthatDFTB-Casida:3OBperformedbestfornon-conjugatedmoleculeswithcarbonyl,cyanoandalkynegroups,forwhichtheirE1errordistributionsarecenterednear∆CC2E1=0andmostlycontainedwithin±1eV.However,DFTB-Casida:3OBmaynotbethepreferredchoicefornon-conjugatedalkenes,asitsestimatesofE1areaﬀectedbyasystematicunderestimationandasig-niﬁcanterrordispersion.WesuspectthatthissystematicunderestimationofE1foralkenesisalsorelatedtotheself-interactionerror.NotallsystemsareequallyaﬀectedbytheSIE.Weex-pecttheSIE-inducedunderestimationofthedelocalisedsolutionstobemorepronouncedinmoleculeswithnatu-rallydelocalisedmolecularorbitalsoflargespatialextent(e.g.,π-conjugatedsystems).Ifthedelocalisedorbitalsdoparticipateinlow-lyingelectronictransitions(e.g.,frontierorbitalssuchasHOMOorLUMO),thenasys-tematicunderestimationofthecorrespondingexcitationenergiesisalsotobeexpected.Moleculesofthechemicalsubgroupofalkenesarecharacterisedbythepresenceofanisolatedcarbon-carbondoublebondthatisnotpartofaconjugatedπ-systemand,therefore,isratherspatiallyconﬁned.Inthecaseofalkeneswewouldhaveexpectedafairlysmallunderestimationoftheﬁrstexcitationenergy.However,asitcanbeseeninFig.S1,alkenesappeartobestronglyaﬀectedbyasystematicunderestimationofE1.ForsystemsaﬀectedbytheSIE,theDFTB-ppRPAmethodisexpectedtoachievebetterresultsand,asitcanbeseeninFig.S1,thisisindeedwhatisobservedfor9alkenes.Itremainstobeaskedwhatmakesalkenesmoresusceptibletothiserrorthanothercompoundswithiso-lateddoubleortriplebonds.WespeculatethatalkenesmaysuﬀerfromtheSIE-inducedartiﬁcialstabilisationofdelocalisedsolutionstoagreaterextent,andthushaveunderestimatedtheirE1predictions,becausetheyaremoreeasilypolarisablethantheothersubfamiliesofnon-conjugatedunsaturatedmolecules,withperma-nentdipolemoments(e.g.,carbonylandcyanogroups)orwithhigherorderbonds(i.e.,alkynes).InTableIIIofthesupplementarymaterialitcanbeseenthatthatthemeasuredpolarisabilities[52–54]oflinearalkenesareindeedhigherthanthoseofotherlinearnon-conjugatedunsaturatedmoleculesofthesamelength(i.e.,withthesamenumberofnon-Hatoms).Onarelatedsidenote,theSIEwasfoundtodecreasewithincreasingdispar-ityofelectronaﬃnitiesbetweentheelectronandholeregions[37],whichmayreinforcethereasonwhytheSIEislowerforcarbonylandcyanogroups,whereex-citationsbetweenfrontierMOsareexpectedtoinvolveanon-bondingmolecularorbital(n)highlylocalisedontheheteroatom(OorN,respectively)andananti-bondingπorbital(π∗)delocalisedoverthedoublebond.Basedonthediscussionsofar,weshouldavoidDFTB-approximatemethodsforsaturatedmolecules,useDFTB-ppRPAforπ-conjugatedmoleculesandnon-conjugatedalkenes,andDFTB-Casidafortheothernon-conjugatedmoleculeswithcarbonyl,cyanoandalkynegroups.However,thereareextensionstothestandardSCC-DFTBformalismthatarealreadyimplementedinDFTB+andareworthtestingifwewanttoimproveourinitialestimatesofE1.Thisiswhatwedidinhopeofresolvingthelimitationsbehindthebroadoverestima-tionofσ-typeexcitationenergiesinsaturatedmoleculesandbehindtheunderestimationofπ-typeexcitations,particularlyforπ-conjugatedmolecules.WedecidedtofocusonimprovingDFTB-Casidafromnowon,asitismoregeneralthanthecurrentimplementationofDFTB-ppRPA,whichnecessarilyinvolvesthehighestoccupiedmolecularorbital(HOMO)inthepredictionofelectronicexcitations.DealingwiththelimitationsUnderestimationofπ-typeexcitationenergiesThisworkisnottheﬁrstreportedencounteroftheSIEinDFTB.ThisDFT-inheritederrorhasalreadybeende-tectedbeforeinthestandardformulationofSCC-DFTB[37,55]andwastracedbacktotheapproximationsmadetothecharge-ﬂuctuationinteractionterm,wheretheXC-componentofthecharge-chargeinteractiontermisre-ducedtoasinglenumberperelement,i.e.theon-siteHubbard-likeparametersUA.Thehighlylocalandvari-ationalnatureoftheSCCtermresultsininteractionsnotconvergingatlargedistances,instarkcontrasttoHFornon-SCCDFTB.BecauseoftheSIE,thestandardformulationofSCC-DFTBendsupunderestimatingtheenergyofdelocalisedsolutions,almostasmuchasanyotherGGAfunctionalforDFT(e.g.PBE)[37].Asat-temptstoovercomethislimitation,diverseextensionstothestandardSCC-DFTBwereproposed,e.g.:LDA+U-DFTB[55],coarse-grainedDFTB[50]andconﬁgurationinteraction(CI)withinSCC-DFTB[56].Arguably,themostpopularandwidelyacceptedstrategytocorrecttheSIEistoincludelong-rangecorrections(LC)intoSCC-DFTB.Forthebenchmarkofthiscorrection,were-computedE1withDFTB-Casida+LCandtheOB2parameterset,whichiscurrentlytheonlySK-setavailableinDFTB+thatiscompatiblewithDFTB+LC.InpanelCofFig.3wecanobservethatDFTB+LC-Casida:OB2increasesthevalueofalltheinitialestimatesofE1,resultingintheshiftofallcorrespondingerrordistributionstomorepositivevalues.Thisresultsinanimprovementforπ-conjugatedmoleculesastheirnewE1errordis-tributionisnowcenteredcloserto∆CC2E1=0andmostlycontainedwithin±1eV.Itisinterestingtonotethatincludinglong-rangecorrectionsintoDFTB-Casidacomputations(DFTB+LC-Casida:OB2)achievesanac-curacysimilartothatofDFTB-ppRPA:3OBwithapre-cisionclosetothatofDFTB-Casida:3OB;thiscompar-isoncanbeappreciatedmoreeasilyinFig.S2,avail-ableinthesupplementarymaterial.Thisimprovedac-curacyofDFTB+LCcomputationsmayarisefromthenewlygainedabilitytoreproducethecorrecttrendforinteractionsoverlongdistances,asDFTB-ppRPAdoes.Thiscorrectionbeingincludedalreadyfromtheparam-eterisationprocesscouldbethereasonwhyDFTB+LC-Casida:OB2ismoreprecisethanDFTB-ppRPA:3OB,de-spitetheirverysimilaraccuracies.Giventhatthecor-rectionisincludedviatheXCfunctional,itwouldbeexpectedforthepre-computedintegralsandrepulsionsplinesofDFTB+LCtoencodeadditionalXCinforma-tion.Incontrast,DFTB-ppRPA:3OBisbasedonparam-etersgeneratedwiththenon-correctedPBEfunctional,whichisshort-rangedandpurelylocal.TheLCshiftedtheE1predictionstohigherenergiesforallmoleculesinthedataset.AlthoughitresultedinamarkedimprovementfortheinitiallyunderestimatedE1predictions(i.e.fortheπ-conjugatedmolecules),italsoworsenedtheestimatesformoleculesthatwereal-readyoverestimated.Therefore,ascanbeseenintheprojectedhistogramsofFig.3C,thismethodcannotberecommendedfornon-conjugatedunsaturatedorsatu-ratedmolecules.OurupdatedruleofthumbnowrecommendsDFTB+LC-Casida:OB2forπ-conjugatedmolecules.Thisrecommendationshouldbecomemorerelevantwhenstudyingelectronicexcitationsbetweendiﬀerentmolec-ularfragments(e.g.solvatedchromophores[57]),in10conductingsystemsormoleculeswithverylargeπ-conjugatedsystems(e.g.polyacenes[14]),andinanyotherstudycasewheretheSIEisexpectedtobesigniﬁ-cant.Overestimationofσ-typeexcitationenergiesWecouldidentifytwomainsourcesfortheerrorthatiscausingtheoverestimationofσ-typeexcitationener-gies.Theﬁrstsourceoferroristruncatingthemulti-poleexpansionofthechargedensityforthecomputationofthecouplingmatrixelementsinCasidaTD-DFTB.Thesecondsourceoferrorisemployingaminimalba-sisset,whichresultsinalowqualitydescriptionoftheGS-MOs.Atﬁrstglance,whatthesetwoapproximationshaveincommoniscontributingtoanover-simpliﬁcationinthedescriptionofthegroundstatedensity,eitherinthegroundorexcitedstateformulations.Previously,welistedthreeapproximationsthatTD-DFTBmadetoLR-TD-DFT.TheﬁrsttwooftheseapproximationswererequiredtotranslatetheCasida’seigenvalueproblemtotheDFTBframework,oneofwhichistheMullikenmonopoleapproximationtothetransitionchargedensity.ThethirdapproximationofTD-DFTBwasintroducedtominimisetheeﬀortinthecomputationofthecouplingmatrixelements,byneglect-ingthechargeﬂuctuationscontributions.Thelatterap-proximationwasconsideredtobesafebyNiehausetal.[11],havingfoundthattheinclusionof∆qA-dependentHubbard-likeUAparametershadanegligibleeﬀectonthecorrectedexcitationenergies.However,thesamecan-notbesaidfortheMullikenmonopoleapproximation,sinceitbecomestroublesomewhendealingwithhighlylocalisedexcitations(i.e.withnearfullorbitaloverlap),forwhichitpredictsheavilyunderestimatedtransitioncharges.Incasesoffullorbitaloverlap,thetransitionchargesvanishand,consequently,sodoesthecouplingmatrix;therefore,inthosecasesTD-DFTBendsuppre-dictingexcitationenergiesthatareexactlyequaltotheKSorbitalenergydiﬀerence.Allthingsconsidered,withafocusonimprovingσ-typeexcitations,wecouldtry(i)tocorrectthemonopoleap-proximationintheexcitedstatemethodor(ii)improvethegroundstateestimationoftheKSenergygap.ThesecondstrategytakesintoaccountsystemsforwhichE1cannaturallybeexpectedtobeveryclosetothecorre-spondingorbitalenergydiﬀerence.Ontheonehand,theﬁrststrategycanbeaddressedwiththeinclusionofon-sitecorrections,whichwereal-readyimplementedinDFTB+byDom´ınguezetal.Ontheotherhand,toimprovetheKSenergygap,eﬀortsshouldbedirectedatreﬁningtheenergyestimatesforthegroundstateMOs.Thiscanbedonebyincreasingthesizeofthebasisset,whichweessentiallyviewasastabilisationofthevirtualMOs.Becausethetight-bindingapproachassumestightlyboundelectrons,itisjustiﬁedtoemployaminimalba-sissettoexpandthemolecularHamiltonianeigenstates.ThisapproximationisnotoftenaproblemforDFTBwithadecentparameterization,asitmostlydoesverywellintermsofaccuracyandperformanceformostofitsapplications,whichfrequentlyconcerngroundstateproperties.However,whendealingwiththeenergeticsofreactionsorexcitations,thelimitationsimposedbytheconstraineddescriptionoftheorbitalsolutionsbe-comesmorenoticeable.Forexample,Niehaus[11]de-tectedthat,becauseoftheminimalbasissetdescription,KSenergydiﬀerenceswerelargerforDFTBcomparedtoDFT.Furthermore,Gausetal.[19]recognisedthattheminimalbasissetrepresentedacruciallimittoDFTB’saccuracyregardingthepredictionofreactionenergies.Webelievethattheincompletenessofthebasissetpre-dominantlyimpactsontheoverestimationofthevirtualstateenergies,astheunoccupiedMOswouldnotbesuf-ﬁcientlywelldescribed.BecauseoftheRayleightheoremforeigenvalues,addingmorebasisfunctionsnecessarilylowerstheeigenvaluesofthemolecularHamiltonianand,thankstothevariationalprinciple,expandingthebasissetisnotexpectedtosigniﬁcantlyaltertheenergiesoftheoccupiedMOs.However,increasingthenumberofbasisfunctionshasthepotentialtosigniﬁcantlystabilisethevirtualMOs,astheyarealwaysfullydeterminedinshapeandenergybytherequirementoforthogonalitywithre-specttothevariationally-determinedoccupiedMOs[58],whicharebetterdescribedwithlargerbasissets.Theeasiestwaywethoughtofextendingtheminimalbasisset,onlyforperformingexcitedstatecomputations,wastoaddpseudopolarizationorbitalsonlytoHatoms.Thestrategyweprovideforpreparingtheminimallypo-larizedminimalbasisset,3OB(H*),maynotbesophisti-catedenough,butwebelievethatitservesasaproof-of-conceptapproachtoargueinfavourofemployingpolar-izedbasissetswhenpredictingσ-typeexcitationenergiesforsaturatedsystems.Webenchmarkedthesetwostrategiesbycomput-ingE1usingDFTB-Casida+OC:3OBandDFTB-Casida:3OB(H*).ThecompletesetofresultsarebeingdisplayedinFigureS3(availableinthesupplementarymaterial)andinpanelDofFig.3,respectively.Sincethesetwostrategieswereoriginallymotivatedonimprov-ingE1predictionsforsaturatedmolecules,inFigure4wedecidedtocomparethissubsetofresultsusinganextralayerofchemicaldetail.AsseeninFig.4,bothmethodsperformedbestforthesubfamiliesofsaturatedmoleculescontaininghighlystrainedthree-memberedrings,suchasepoxide,aziri-dineandcyclopropylgroups.Theseringstructureshavemarkedlyacutebondanglesandthereforegreaterp-characterthanthenon-strainedsaturatedmolecules.To-getherwiththelargeorbitaloverlapthatexistsatthecenterofthesesmallrings,σ-electronsendupdelocal-11FIG.4.OverlappedE1errordistributionsforchem-icalsubfamilieswithinthefamilyofsaturatedmolecules.On-sitecorrectedTD-DFTBresults,obtainedwithDFTB-Casida+OC:3OB,aredisplayedatthetoponawhiteback-ground.HistogramscomputedfromresultsobtainedwithDFTB-Casida:3OB(H*)(i.e.CasidaTD-DFTBemployingaminimallypolarizedminimalbasisset)areshownatthebot-tomonagreybackground.Foreaseofcomparison,inbothbackgroundswehaveincludedtoscaletheoriginalE1errordistributionforDFTB-Casida:3OB,correspondingtoallsat-uratedmolecules(asdark-greyshadedareas).ThenumberofoccurrencesperchemicalfamilyandsubgroupisavailableintheﬁrstcolumnofTableIV,inthesupplementarymaterial.isingwithastabilisingeﬀectontheanti-bondingvir-tualMOs,inwhatisknownashyperconjugation[59].Theelectrondensitytobedelocalisedontheringscanalsocomefromgeminaln-orbitals(duetoaninterac-tionknownasnegativehyperconjugation)andfromelec-tropositivesubstituents[60].Thehighlystrainedsatu-ratedmoleculesareaspecialcase.Ontheonehand,be-ingsaturatedmolecules,theirelectronicexcitationsareexpectedtoinvolveσ-typeoccupiedmolecularorbitalsand,therefore,maybeinneedofabetterdescriptionoftheelectrondensitytoavoidoverestimatingtheirener-gies.Ontheotherhand,theirhigherp-characterwouldgiverisetodelocalisedMOs,particularlyvirtualstatesnearthefrontier,whichcanpotentiallybeunderesti-matedinenergybytheSIE.Therefore,forthesesub-groupsofmoleculeswewouldexpectcasesthatgiverisetobeneﬁcialerrorcompensation.Wecalculatedtheav-erageshiftsobservedin∆CC2E1aftertheinclusionofpartialpolarisation(H*)andoflong-rangecorrections(LC),forthesetsofthree-memberedringmolecules;foreachofthechemicalgroupsdiscussedwehaveobservedsmoothmonomodaldistributionswithafullwidthathalfmaximum(FWHM)between0.5eVand1eV(notshown).Onaside,theadditionofpartialpolarisationred-shiftedE1inallcases,suggestingthattheelectrondensityoversimpliﬁcationerrorwaspresent;weobservedthelargestmeanshiftforcyclopropanes(-0.66eV),fol-lowedbyaziridines(-0.53eV)andepoxides(-0.40eV);wecorrelatedthiswiththenumberofgeminallonepairsineachchemicalgroup(epoxideshavetwobecauseofoxygen,aziridineshaveonefromnitrogen,andthecyclo-propylgrouphasnone).Wewouldexpectmoleculeswithfewervalencep-electronstorelymoreonthequalityoftheelectrondensityofσbondsfortheirE1predictions.Ontheotherside,theinclusionoflong-rangecorrectionsresultedinadetrimentalblue-shiftforallE1predictions,whichwouldsignalthattheSIEwaspresent.Again,weobservedthelargestaverageshiftforcyclopropanes(+2.15eV),butthistimeitwasfollowedbyepoxides(+1.85eV)andthenaziridines(+1.48eV).Weprevi-ouslyconjecturedthatsystemswithmoredelocalisedso-lutionsandhigherpolarisabilitieswereexpectedtobemoreaﬀectedbytheSIE.Tocomparethepolarisabil-itiesofthesethreechemicalsubgroupswecanrefertoTableIIIofthesupplementarymaterial.Wecanseethatthereisatrendinpolarisabilitiesbasedonelemen-talcomposition:hydrocarbonsaremorepolarisablethanmoleculeswithoxygen,andbotharemorepolarisablethannitrogen-containingmolecules.Althoughthedis-cussedcompoundsarecyclic,andsolelycomprisedofsinglebonds,wecanthinkofthree-memberedringsasbeingmoresimilartotheirveryshort(2and3non-Hatoms)linearanalogues.Theinclusionofon-sitecorrectionsresultedinared-shiftofE1forallsaturatedmoleculescontainingatleastoneoxygenornitrogenheteroatom;themostfrequentshiftobservedforepoxideswasofabout-1.2eV,androughly-0.9eVforaziridines,whilehydrocarbons(satu-ratedmoleculesofCandHonly)werealmostunaﬀectedbythiscorrection.Thankstothiscorrection,DFTB-Casida+OC:3OBisabletoprovideacceptableE1pre-dictionsforthesubfamilyofmoleculeswithanepoxyfunctionalgroup.Asfortherestofthesaturatedmolecules,theexten-sionoftheminimalbasisset(toincludepolarizationforHatoms)wouldbepartiallycorrectingtheelectronden-sityoversimpliﬁcationerror.Asaconsequence,DFTB-Casida:3OB(H*)seemstohaveconsiderablyimprovedthepredictionsofE1fortheentiretyofthesaturatedmolecules.Theminimalpolarizationofthebasissetre-sultedinasigniﬁcantcontractionoftheE1errordistri-butionforthesaturatedmolecules(seeFigureS4,inthesupplementarymaterial),buthadalargercorrectiveef-fectonthesubfamilieswithmores-character,i.e.ethers,alcoholsandsaturatedhydrocarbons(seeFig.5).Consis-tently,fortheunsaturatedmolecules,conjugatedornot,polarizingtheHatomshadanalmostnegligibleeﬀectontheirE1predictions,leavingtheerrordistributionsap-preciablyunchangedforπ-typeexcitations(alsoseeninFig.S4).Whileitwouldcertainlybeinterestingtofurtherin-vestigateourhypothesisonerrorcompensation,itisalsobeyondthescopeofthisstudy.Fornow,weshouldup-12dateourruleofthumbtoincludetherecommendationtouseDFTB-Casida+OC:3OBwhenpredictingE1forsaturatedmoleculesoftheepoxyfamily.Asfortherestofthesaturatedmolecules,basedonourresultswecannotrecommendanyoftheherebench-markedmethodstopredictE1.Thecustomparam-eterset3OB(H*)wasonlyemployedtohighlightthefavourableimpactthatincludingpolarizationorbitalshasonE1predictions,asitimprovestheGSestimatesoftheKSenergygaps.Atmost,whatweproposedshouldservetoassistthedevelopercommunityofDFTB+inset-tingthedirectionforimprovementtowardsamorecom-prehensivesolution.Ifthecommunityreaﬃrmsitsinterestinstudyingtheexcitedstateofsaturatedsystems,werecommendasanextrastepinDFTB+’sdevelopmentroadmaptheinclu-sionofextrapolarizationorbitalsforeachoftheelementsin3OB,whatmayrequireare-parameterizationofthetwo-centerrepulsionsplines.Thenaturalfollowingstepwouldbetoextendthebaseformalismtoallowpolar-izationviathemultipoleexpansionofthechargedensityδρ,beyondthezerothorder.Essentially,weareproposingthatfutureimplementa-tionsofDFTB+regardingthistopicshouldbebasedontheGaussianpolarizable-iontightbiding(GTB)method,developedbyHorsﬁeld,Boleiningeretal.[61].GTBper-formson-the-ﬂycomputationsofthemultipolemoments,uptoquadrupoleorder,fromaGaussianbasissetwiththepotentialtoincludepolarizationorbitals.Currently,animplementationofthismethodexistswithinanothersuiteofprogramsforcomputationalchemistry,namedPlato[62–64].Forareducedsetofsmallhydrocarbonmolecules,GTBpredictedmeanpolarizabilityvolumes(αm)inexcellentagreementwithexperimentaldetermi-nations,similarlytoDFT-PBEbutatafractionofthecomputationalcost.Wefocusedonasubsetoftheseresults,comprisingH2andtheﬁrstfourelementsofthehomologousseriesofstraight-chainalkanes(showninTa-bleIIofoursupplementarymaterial).Forthesesatu-ratedmolecules,inordertosigniﬁcantlycounteractthesharpunderestimationofαm,leadingtothediscussedoverestimationoftheσ-typeE1,itisnecessarytoap-pendpolarizationorbitalstotheminimalbasisset,sincethemultipoleexpansionofthechargedensityaloneisapparentlynotsuﬃcient.ForGTBwithasecond-orderexpansionofthechargedensity,themeanrelativeab-solutepercentageerrorofαmgoesfromapproximately68%tonear8%,justwiththeadditionofpolarizationorbitalsforeachelement(i.e.porbitalsforHanddor-bitalsforC);forcomparison,thiserrorwascloseto5%forDFT:PBE/cc-pVQZ.Lastly,itisworthmentioninganotheralternativetoimproveσ-typeexcitationenergies,whichwedonotcoverinthisworkasitisnotimplementedintoDFTB+.Itcon-sistsonextendingSCC-DFTBtoincludethechemical-potentialequalisation(CPE)approach,inwhichanad-ditionalresponsedensityissuppliedinordertoovercomethelimitationsoftheminimalbasissetwithrespecttoresponseproperties[65].SUMMARYANDCONCLUSIONSDFTBisaconsiderablymoreapproximatemethodthanDFT,buttheseapproximationsarepreciselythereasonforitssuperiorcomputationalperformance.TD-DFTBapproximationsresultinacomputationalscalingreducedbythreeordersofmagnitudewithrespecttoTD-DFTinitsdefaultformulation(fromN6toN3,whereNisthenumberofatomsinthesystem)[2].Thesubstan-tiallylowercomputationalcostofDFTB-approximatemethodsextendstheupperlimitoffeasibilityintermsofsize,timescaleandcomplexityofthesystemstobestud-ied,bringingquantummechanicstosystemspreviouslytreatedwithclassicalforceﬁelds.Despitebeingmoreapproximate,DFTBmethodssuf-ferfromthesamelimitationsastheirparentmethod(i.e.DFT)inthepredictionofE1,albeittoagreaterextent.Ontheonehand,thereistheself-interactionerror,whichmainlyaﬀectsπ-typeexcitationsinmoleculeswithhighp-character.Ontheotherhand,thereistheerrorduetotheuseofanon-completebasisset,whichhasasigniﬁ-cantimpactonσ-typeexcitations,inmoleculeswithpre-dominantlys-character.However,inthisworkweshowedthatwecanusechemicalintuitiontochoosebetweenthecurrentlyimplementedmethodsandcorrectionsofDFTB+topredictE1witherrorsmostlywithin±1eV.Itisimportanttohighlightthatourdataanalysisdidnottakeintoaccountthesymmetryoftheexcitedstatesand,therefore,thatmayactasasourceofsystematicunderestimationerrorforE1(whichcanalternativelybeviewedasaqualitativeerrorintermsofsymmetry).Inotherwords,forcaseswhereDFT-orDFTB-basedmeth-odspredictanexcitationenergythatexactlymatchesthereferencevalue(i.e.,ofCC2),thepredictedsymmetryofthecorrespondingexcitedstatemaynotmatchtheref-erence,asitispossiblefortheenergyrankingofthestatestochangewiththemethod.However,akeyas-pectofthisworkisthatwewereabletoextractrobustinsightsonthestrengthsandweaknessesofthebench-markedESmethodsviathedataanalysisofjusttheﬁrstsingletexcitationenergy[66],thankstotakingintoaccountthechemicalidentityofmoleculesfromasuﬃ-cientlylargeandchemicallydiversetestset.Afterall,withour“symmetry-blind”but“chemicallyinformed”analysisoftheGDB-8chemicalsubspace,wewereabletoidentifycleartrendsinthepredictionerrordistribu-tionsforE1.Bewarethat,asthisworkbasesitscon-clusionsongeneraltrends,anysystem-speciﬁcanalysisonthecorrectnessoftheenergyandsymmetryrankingofthelow-lyingexcitedstatesbecomesdelegatedtore-searchersinterestedinstudyingsuchparticularsystems.13FIG.5.ComparisonofE1errordistributions(∆CC2E1)nor-malisedbyarea,forchemicalsubfamiliesofmoleculesfromthedataset,computedusingdiﬀerentDFTBmethods(atthetop,onawhitebackground)andTD-DFT:PBE0/def2SVP(atthebottom,onagreybackground).TocomputeE1withDFTB+wefollowedtheruleofthumbweconstructedthroughoutthediscussionofresults.Accordingly,weem-ployed:DFTB-Casida+OC:3OBforsaturatedmoleculeswithepoxidegroups(bluesolidline),DFTB-Casida:3OBfortherestofthesaturatedmolecules(greensolidline),DFTB-Casida+LC:OB2forπ-conjugatedunsaturatedmolecules(purplesolidline),DFTB-Casida:3OBfornon-conjugatedun-saturatedmoleculeswithcarbonyl,cyanooralkynegroups(orangesolidline)andDFTB-ppRPA:3OBforunsaturatedmoleculeswithisolatedalkenegroups(redsolidline).ThecombinederrordistributionsforDFTandDFTBmethodsareshown(asdashedblacklines)superimposedontheirre-spectivesidesoftheplot.ThecombinederrordistributionfortheDFTB-approximatemethodsignoresthenon-epoxysaturatedmolecules,aswecouldnotrecommendanysuit-ableimplementationwithinDFTB+.Forbettervisualisation,allDFTBdistributionswerescaledtodouble.ThenumberofoccurrencesperchemicalfamilyandsubgroupisavailableintheﬁrstcolumnofTableIV,inthesupplementarymaterial.OurbenchmarkallowedustoconstructaruleofthumbintendedtoassistthecommunityofusersinselectingthemostreliableDFTBapproximationfortheexcitedstatecalculationsoftheirmolecularsys-temsofinterest.Accordingtothisrule,visuallysummarisedinFigure5,tocomputeE1withDFTB+werecommend:(i)employingDFTB-Casida+OC:3OBforsaturatedmoleculeswithepoxidegroups,(ii)DFTB-Casida+LC:OB2forπ-conjugatedunsaturatedmolecules,(iii)DFTB-Casida:3OBfornon-conjugatedunsaturatedmoleculeswithcarbonyl,cyanooralkynegroups,and(iv)DFTB-ppRPA:3OBforunsaturatedmoleculeswithisolatedalkenegroups.Ignoringnon-epoxysaturatedmolecules,thecombinederrordistributionresultingfromusingtheproposedruleofthumbisalmostasacceptableasthatofthecom-putationallymoreexpensiveTD-DFTmethodwithacorrectedexchangefunctional(PBE0)andapartiallypolarisedbasisset(def2SVP).Surprisingly,Fig.5alsoshowsthat,incontrasttoTD-DFT,thecombineder-rordistributionoftheDFTB-approximatemethodsisnearlycentredon∆CC2E1=0,i.e.thelinecorrespond-ingtoexactmatcheswithCC2predictions.Asdiscussedabove,webelievethat,sinceDFTB’spredictionsofE1appeartobequitesensitivetotheidentiﬁedsourcesoferror,theoccurrenceofbeneﬁcialerrorcompensationin-creases.AlthoughwecannotrecommendanyDFTB-approximatemethodwithinDFTB+topredictE1formostsaturatedmolecules,ifthecommunityreaﬃrmsitsinterestinstudyingtheexcitedstateofthesesystems,werecommendaddingthefollowingstepstothedevel-opmentroadmapofDFTB+:(i)theinclusionofextrapolarisationorbitalsin3OBand(ii)theextensionofthebaseformalismtoallowforpolarisationviathemulti-poleexpansionofthechargedensity,beyondzerothor-der.ThiswillrequirereferringtotheGTBmethodbyHorsﬁeld,Boleiningeretal.[61].SUPPLEMENTARYMATERIALInthesupplementarymaterialPDFﬁleyouwillﬁnd:atablelistingtheSMARTSfragmentsemployedtoiden-tifythechemicalsub-families(TableI);atablewithanorderedsubsetofresultsfromBoleiningeretal.[61](TableII);plotsof∆CC2E1errordistributionswithad-ditionalchemicaldetail,forunsaturatedandsaturatedmolecules(Figs.S1-2,4);anda2Dplot,similartothatofFig.3,forDFTB-Casida+OC:3OB(Fig.S3).Youwillalsoﬁndthenumberofoccurrencesinthedataset,perchemicalfamilyandsubgroup,andabriefanalysisoftheoscillatorstrengthsassociatedwithE1(TableIVandFig.S5).WealsoattachaTXTﬁlecontainingtheﬁrsttwoexcitationenergies(E1andE2),andcorrespondingoscillationstrengths(f1andf2),computedforallthemoleculesintheQM8dataset(i.e.theGDB-8chem-icalsubspace)withDFTB-approximatemethodsfromDFTB+:DFTB-Casida:3OB,DFTB-ppRPA:3OB,DFTB-Casida+LC:OB2,DFTB-Casida+OC:3OBandDFTB-Casida:3OB(H*).AlthoughweonlyemployedE1fortheanalysisofthiswork,wedecidedtocalculatetheextraquantitiesinordertoextendtheoriginalQM8datasetwithresultsobtainedwiththebenchmarkedsetofDFTB-approximatemethods.ACKNOWLEDGMENTSWewouldliketothanktheanonymousreviewersfortheircriticalreadingandforcontributingtotheimprove-mentoftheoverallqualityofthisrevisedmanuscript.TheauthorsacknowledgeﬁnancialsupportbytheCon-sejoNacionaldeInvestigacionesC´ıentiﬁcasyT´ecnicas14(CONICET)andtheAgenciaNacionaldePromoci´onCient´ıﬁcayTecnol´ogica(AgenciaI+D+i),Argentina,throughgrantsPIP112-2017-0100892COandPICT-2017-1506.A.I.B.alsothanksCONICETforthedoc-toralfellowship.CONFLICTSOFINTERESTSTATEMENTTheauthorshavenoconﬂictstodisclose.DATAAVAILABILITYSTATEMENTWebelievethatalldatanecessarytoreproducetheﬁndingsofthisstudyareavailablewithinthearticleanditssupplementarymaterial.However,dataconsideredtobemissingcanbemadeavailablefromthecorrespondingauthorsuponreasonablerequest.∗Correspondingauthor:csanchez@mendoza-conicet.gob.ar[1]M.Elstner,D.Porezag,G.Jungnickel,J.Elsner,M.Haugk,T.Frauenheim,S.Suhai,andG.Seifert,Phys-icalReviewB58,7260(1998).[2]B.Hourahine,B.Aradi,V.Blum,F.Bonaf´e,A.Buc-cheri,C.Camacho,C.Cevallos,M.Y.Deshaye,T.Du-mitric˘a,A.Dominguez,S.Ehlert,M.Elstner,T.vanderHeide,J.Hermann,S.Irle,J.J.Kranz,C.K¨ohler,T.Kowalczyk,T.Kubaˇr,I.S.Lee,V.Lutsker,R.J.Maurer,S.K.Min,I.Mitchell,C.Negre,T.A.Niehaus,A.M.N.Niklasson,A.J.Page,A.Pecchia,G.Penazzi,M.P.Persson,J.ˇRez´aˇc,C.G.S´anchez,M.Sternberg,M.St¨ohr,F.Stuckenberg,A.Tkatchenko,V.W.z.Yu,andT.Frauenheim,TheJournalofChemicalPhysics152,124101(2020).[3]Y.Yang,A.Dominguez,D.Zhang,V.Lutsker,T.A.Niehaus,T.Frauenheim,andW.Yang,TheJournalofChemicalPhysics146,124104(2017).[4]T.A.Niehaus,S.Suhai,F.D.Sala,P.Lugli,M.Elstner,G.Seifert,andT.Frauenheim,PhysicalReviewB63,085108(2001).[5]F.P.Bonaf´e,B.Aradi,B.Hourahine,C.R.Medrano,F.J.Hern´andez,T.Frauenheim,andC.G.S´anchez,JournalofChemicalTheoryandComputation16,4454(2020).[6]P.HohenbergandW.Kohn,PhysicalReview136,B864(1964).[7]W.KohnandL.J.Sham,PhysicalReview140,A1133(1965).[8]M.Berdakin,G.Soldano,F.P.Bonaf´e,V.Liubov,B.Aradi,T.Frauenheim,andC.G.S´anchez,Nanoscale14,2816(2022).[9]C.R.Lien-Medrano,F.P.Bonaf´e,C.Y.Yam,C.-A.Palma,C.G.S´anchez,andT.Frauenheim,NanoLetters22,911(2022).[10]S.Maity,B.M.Bold,J.D.Prajapati,M.Sokolov,T.Kubar,M.Elstner,andU.Kleinekath¨ofer,TheJour-nalofPhysicalChemistryLetters11,8660(2020).[11]T.A.Niehaus,JournalofMolecularStructure:THEOCHEM914,38(2009).[12]F.Trani,G.Scalmani,G.Zheng,I.Carnimeo,M.J.Frisch,andV.Barone,JournalofChemicalTheoryandComputation7,3304(2011).[13]A.Dom´ınguez,B.Aradi,T.Frauenheim,V.Lutsker,andT.A.Niehaus,JournalofChemicalTheoryandCompu-tation9,4901(2013).[14]J.J.Kranz,M.Elstner,B.Aradi,T.Frauenheim,V.Lutsker,A.Dom´ınguez,andT.A.Niehaus,JournalofChemicalTheoryandComputation13,1737(2017).[15]A.FiheyandD.Jacquemin,JournalofChemicalTheoryandComputation15,6267(2019).[16]R.Ramakrishnan,M.Hartmann,E.Tapavicza,andO.A.vonLilienfeld,TheJournalofChemicalPhysics143,084111(2015).[17]P.KoskinenandV.M¨akinen,ComputationalMaterialsScience47,237(2009).[18]D.Porezag,T.Frauenheim,T.K¨ohler,G.Seifert,andR.Kaschner,PhysicalReviewB51,12947(1995).[19]M.Gaus,A.Goez,andM.Elstner,JournalofChemicalTheoryandComputation9,338(2013).[20]V.Q.Vuong,J.A.Kuriappan,M.Kubillus,J.J.Kranz,T.Mast,T.A.Niehaus,S.Irle,andM.Elstner,JournalofChemicalTheoryandComputation14,115(2018).[21]M.Gaus,C.-P.Chou,H.Witek,andM.Elstner,TheJournalofPhysicalChemistryA113,11866(2009).[22]J.C.SlaterandG.F.Koster,PhysicalReview94,1498(1954).[23]M.E.Casida,RecentAdvancesinDensityFunctionalMethods5,155(1995).[24]R.Ramakrishnan,P.O.Dral,M.Rupp,andO.A.vonLilienfeld,ScientiﬁcData1,140022(2014).[25]R.Send,M.K¨uhn,andF.Furche,JournalofChemicalTheoryandComputation7,2376(2011).[26]D.K´ann´arandP.G.Szalay,JournalofChemicalTheoryandComputation10,3757(2014).[27]DFTB+UserManual,https://dftbplus.org/documentation(Lastaccessed:2022-05-04).[28]T.M.Maier,H.Bahmann,A.V.Arbuznikov,andM.Kauppb,TheJournalofChemicalPhysics144,074106(2016).[29]RDKit:Open-SourceCheminformaticsSoftware,https://rdkit.org(Lastaccessed:2022-05-04).[30]D.Weininger,JournalofChemicalInformationandMod-eling28,31(1988).[31]T.A.NiehausandF.D.Sala,PhysicaStatusSolidi(b)249,237(2012).[32]V.Lutsker,B.Aradi,andT.A.Niehaus,TheJournalofChemicalPhysics143,184107(2015).[33]M.T.doN.Varella,L.Stojanovi´c,V.Q.Vuong,S.Irle,T.A.Niehaus,andM.Barbatti,TheJournalofPhysicalChemistryC125,5458(2021).[34]B.Hourahine,SkProgs:Packagecontainingafewpro-gramsthatareusefulingeneratingSlater-KosterﬁlesfortheDFTB-method,https://github.com/dftbplus/skprogs(Lastaccessed:2022-05-04).[35]M.Lundberg,Y.Nishimoto,andS.Irle,InternationalJournalofQuantumChemistry112,1701(2012).[36]J.P.PerdewandA.Zunger,PhysicalReviewB23,5048(1981).15[37]M.Lundberg,Y.Nishimoto,andS.Irle,InternationalJournalofQuantumChemistry112,1701(2012).[38]A.Savin,inRecentDevelopmentsandApplicationsofModernDensityFunctionalTheory,Vol.4(ElsevierSci-ence,1996)pp.327–357.[39]F.D.SalaandA.G¨orling,PhysicalReviewLetters89,033003(2002).[40]L.KronikandS.K¨ummel,Gas-phasevalence-electronphotoemissionspectroscopyusingdensityfunctionalthe-ory,inFirstPrinciplesApproachestoSpectroscopicProp-ertiesofComplexMaterials,Vol.347(SpringerBerlinHeidelberg,2014)pp.137–191.[41]Y.NishimotoandD.Fedorov,PhysicalChemistryChem-icalPhysics18,22047(2016).[42]S.GrimmeandM.Parac,ChemPhysChem4,292(2003).[43]B.ChampagneandE.A.Perp`ete,TheJournalofChem-icalPhysics109,10489(1998).[44]B.Champagne,E.A.Perp`ete,D.Jacquemin,S.J.A.vanGisbergen,E.-J.Baerends,C.Soubra-Ghaoui,K.A.Robins,andB.Kirtman,TheJournalofPhysicalChem-istryA104,4755(2000).[45]A.Dreuw,J.L.Weisman,andM.Head-Gordon,TheJournalofChemicalPhysics119,2943(2003).[46]A.DreuwandM.Head-Gordon,ChemicalReviews105,4009(2005).[47]D.Tozer,TheJournalofChemicalPhysics119,12697(2003).[48]F.Grozema,S.Tonzani,Y.Berlin,G.Schatz,L.Siebbe-les,andM.Ratner,JournalofAmericanChemicalSoci-ety130,5157(2009).[49]J.-D.ChaiandM.Head-Gordon,TheJournalofChem-icalPhysics128,084106(2008).[50]T.KubaˇrandM.Elstner,TheJournalofPhysicalChem-istryB114,11221(2010).[51]M.LundbergandP.Siegbahn,TheJournalofChemicalPhysics122,224103(2005).[52]M.Gussoni,R.Rui,andG.Zerbi,JournalofMolecularStructure447,163(1998).[53]R.J.(editor),NISTStandardReferenceDatabase101,http://cccbdb.nist.gov/(2022).[54]Y.ZevatskiiandS.Lysova,RussianJournalofAppliedChemistry79,967–974(2006).[55]B.Hourahine,S.Sanna,B.Aradi,C.K¨ohler,T.Niehaus,andT.Frauenheim,TheJournalofPhysicalChemistryA111,5671(2007).[56]M.Rapacioli,F.Spiegelman,A.Scemama,andA.Mirtschink,JournalofChemicalTheoryandCom-putation7,44(2011).[57]C.M.Isborn,B.D.Mar,B.F.E.Curchod,I.Tavernelli,andT.J.Mart´ınez,TheJournalofPhysicalChemistryB117,12189(2013).[58]D.B.Cook,InternationalJournalofQuantumChemistry60,793(1996).[59]S.Inagaki,Y.Ishitani,andT.Kakefu,JournaloftheAmericanChemicalSociety116,1994(1994).[60]J.I.-C.WuandR.Schleyer,PureandAppliedChemistry85,921(2013).[61]M.Boleininger,A.A.Y.Guilbert,andA.P.Horsﬁeld,JournalofChemicalPhysics145,144103(2016).[62]A.P.Horsﬁeld,PhysicalReviewB56,6594(1997).[63]A.P.HorsﬁeldandA.Bratkovsky,JournalofPhysics:CondensedMatter12,R1(2000).[64]S.D.KennyandA.P.Horsﬁeld,ComputerPhysicsCom-munications180,2616(2009).[65]S.Kaminski,T.J.Giese,M.Gaus,D.M.York,andM.Elstner,TheJournalofPhysicalChemistryA116,9131(2012).[66]WealsoconductedabriefanalysisoftheoscillatorstrengthsassociatedwithE1(i.e.,f1)andfoundresultscompatiblewiththeconclusionsofthiswork.Thisaddi-tionaldataarepresentedinFig.S5andTableIVofthesupplementarymaterial.SupplementaryMaterialfor”BenchmarkingDFTB+ontheﬁrstsingletverticalexcitationenergyofsmallorganicmolecules”Andr´esI.BertoniandCristi´anG.S´anchez∗InstitutoInterdisciplinariodeCienciasB´asicas(ICB-CONICET),UniversidadNacionaldeCuyo,PadreJorgeContreras1300,Mendoza5502,ArgentinaMainchemicalfamilyChemicalsub-familySMARTSfragmentSaturatedmoleculesEpoxy[C;r3]-[O;r3]-[C;r3]Aziridine[C;r3]-[N;r3]-[C;r3]Cyclopropane[C;r3]-[C;r3]-[C;r3]Oxetane/Azetidine[C;r4]-[O,N;r4]-[C;r4]Tetrahydrofurane/Pyrrolidine/Pentane[C;r5]-[O,N,C;r5]-[C;r5]Ether/Alcohol[C]-[O]OtherAliphatic[CX4]Non-conjugatedunsaturatedmoleculesCarbonylC=OAlkyneC#CCyanoC#NAlkeneC=CImineC=NTABLEI.ThistableshowstheSMARTSfragmentsthatwereemployedtorecognisechemicalsub-familieswithineachofthemainprincipalchemicalfamilies.Theseadditionalmoleculardescriptorswereappliedintheorderinwhichtheyappearinthetable,fromtoptobottom.Wemadenodistinctionofsub-familieswithinthefamilyofpi-conjugatedmolecules.∗Correspondingauthor:csanchez@mendoza-conicet.gob.ar[1]Boleininger,M.;Guilbert,A.A.Y.;Horsﬁeld,A.P.Gaussianpolarizable-iontightbinding.JournalofChemicalPhysics2016,145(14),144103.[2]Olney,T.N.;Cann,N.M.;Cooper,G.;Brion,C.E.Absolutescaledeterminationforphotoabsorptionspectraandthecalculationofmolecularpropertiesusingdipolesum-rules.ChemicalPhysics1997,223(1),59-98.[3]Gussoni,M.;Rui,R.;Zerbi,G.Electronicandrelaxationcontributiontolinearmolecularpolarizability.Ananalysisoftheexperimentalvalues.JournalofMolecularStructure1998,447(3),163-215.[4]Johnson,R.D.NISTComputationalChemistryComparisonandBenchmarkDatabase.NISTStandardReferenceDatabase2022,101(22),http://cccbdb.nist.gov/.[5]Zevatskii,Y.E.;Lysova,S.S.Relationshipbetweenthemolarvolumeandenthalpyofformation,polarizability,andionizationpotentialofCHNO-containingorganicsubstances.RussianJournalofAppliedChemistry2006,79(6),967–974.arXiv:2205.06195v2  [physics.chem-ph]  13 Jul 20222GTB2/SV[1]GTB2/SVP[1]DFT:PBE/cc-pVQZ[1]Expt.[2]H20.180.900.700.79methane0.772.302.462.45ethane1.463.944.324.23propane2.135.566.235.92butane2.817.228.147.69TABLEII.ThistableshowsanorderedsubsetofresultsobtainedbyBoleiningeretal.[1],exactlyastheyappearintheiroriginalpublication.Theycorrespondtomeanpolarizabilityvolumes(αm)in˚A3,computedwiththeGaussianpolarizable-ionTightBindingmethodwithasecond-orderexpansionofthechargedensity(GTB2)forH2andfoursaturatedmolecules(theﬁrstfourelementsinthehomologousseriesofstraight-chainalkanes).Calculationswerecarriedoutwithaminimalbasisset(SV)andapolarizablebasisset(SVP).Forcomparison,weincludedexperimentaldeterminationsbyOlneyetal.[2]andresultsfromDFT-PBEwiththecorrelation-consistentquadruple-zetavalencebasisset(cc-pVQZ)[1].FigureS1.OverlappedE1errordistributionsforchemicalsubfamilieswithinthefamilyofnon-conjugatedunsaturatedmolecules(i.e.moleculescharacterisedbyisolateddoubleandtriplebonds).HistogramswerecomputedusingresultsfromDFTB-Casida:3OB(solidlines)andDFTB-ppRPA:3OB(dashedline).SeetheﬁrstcolumnofTableIVforthenumberofoccurrencesperchemicalfamilyandsubgroup.3FigureS2.OverlappedE1errordistributionhistogramsforunsaturatedπ-conjugatedmolecules,computedusingDFTB-Casida:3OB(reddashedline),DFTB-ppRPA:3OB(bluedashedline)andDFTB-Casida+LC:3OB(blacksolidline).Notethatincludinglong-rangecorrectionsintoDFTB-Casidacomputations(i.e.computingwithDFTB+LC-Casida:OB2)achievesanaccuracysimilartothatofDFTB-ppRPA:3OBwithaprecisionclosetothatofDFTB-Casida:3OB.SeetheﬁrstcolumnofTableIVforthenumberofoccurrencesperchemicalfamilyandsubgroup.FigureS3.Comparisonofpredictionerrors∆CC2E1forTD-DFT:PBE0/def2SVPandDFTB-Casida+OC:3OB.Thescattereddatapointscorrespondtoeachofthenearly21,800moleculesintheGDB-8chemicalsubspace.Thedatapointsandtheprojectedhistogramswerecolouredaccordingtothemainchemicalidentityofthecompounds:greenforsaturatedmolecules,orangefornon-conjugatedmoleculeswithanisolateddoubleortriplebond,andpurpleformoleculeswithπ-conjugatedsystems.SeetheﬁrstcolumnofTableIVforthenumberofoccurrencesperchemicalfamilyandsubgroup.4FigureS4.Right:OverlappedE1errordistributionscorrespondingtoallthemoleculesinthedataset,computedusingDFTB-Casidawiththeoriginalparameterset3OB(redsolidline)andthecustomminimallypolarizedset3OB(H*)(bluesolidline).Histogramsof∆CC2E1thatcorrespondonlytothesubsetofsaturatedmoleculesarebeinghighlightedasdashedlinesinadarkercolour.Left:CumulativepercentagedistributionofsaturatedmoleculeswithE1predictionerrorsbellow∆CC2E1;foreachmethod,wehighlightthevalueof∆CC2E1belowwhich99%ofthesaturatedmoleculesarecontained.SeetheﬁrstcolumnofTableIVforthenumberofoccurrencesperchemicalfamilyandsubgroup.[Polarizabilities]n:numberofnon-Hatoms(C,O,N)n=2n=3n=4n=5·C-C·(alkanes)CH3CH3(ethane)[4.226˚A3]H(CH2)2CH3(propane)[5.921˚A3]H(CH2)3CH3(butane)[8.020˚A3]H(CH2)4CH3(pentane)[9.88˚A3]·C=C·(alkenes)CH2CH2(ethlene)[4.076˚A3]CH3CHCH2(propene)[5.990˚A3]H(CH2)2CHCH2(1-butene)[7.830˚A3]H(CH2)3CHCH2(1-pentene)[9.65˚A3]·C≡C·(alkynes)CHCH(acetylene)[3.487˚A3]CH3CCH(propyne)[5.550˚A3]H(CH2)2CCH(1-butyne)[7.410˚A3]H(CH2)3CCH(1-pentyne)[9.12˚A3]·C=O(aldehydes)CH2O(formaldehyde)[2.770˚A3]CH3CHO(acetaldehyde)[4.278˚A3]H(CH2)2CHO(propanal)[6.350˚A3]H(CH2)3CHO(butanal)[8.20˚A3]·C≡N(cyanides)HCN(hydrogencyanide)[2.346˚A3]CH3CN(acetonitrile)[4.280˚A3]H(CH2)2CN(propionitrile)[6.240˚A3]H(CH2)3CN(butanenitrile)[8.40˚A3]TableIII.ThistableshowsanorderedsubsetofresultsthatoriginallyappearedinpublicationsbyGussonietal.[3](alsoavailableattheNISTdatabase[4])andZevatskiietal.[5].Thevaluescorrespondtoexperimentallymeasuredelectricdipolepolarisabilitiesin˚A3units,fornon-conjugatedunsaturatedlinearorganicmoleculescontainingthefunctionalgroupatoneend;weaddedlinearalkanesforcomparison.Notethatformoleculesofthesamelength(equalnumberofnon-Hatoms,n),thepolarisabilitiesofalkenesarehigherthanthoseoftheotherunsaturatednon-conjugatedcompounds;interestingly,ageneraltrendcanbeextractedforthesepolarisability(α)values:α(alkanes)>α(alkenes)>α(alkynes)>α(aldehydes)>α(cyanides).5FigureS5.Comparisonofpredictionerrors∆CC2f1,wheref1istheoscillatorstrengthassociatedtoE1,forTD-DFT:PBE0/def2SVPandthreediﬀerentDFTB-approximateapproaches:Casida:3OB(1stcolumn),Casida+LC:OB2(2ndcol-umn)andCasida:3OB(H*)(3rdcolumn).Thescattereddatapointscorrespondtoeachofthenearly21,800moleculesintheGDB-8chemicalsubspace.Thedatapointsandtheprojectedhistogramswerecolouredaccordingtothemainchemicalidentityofthecompounds:greenforsaturatedmolecules(1strow),orangefornon-conjugatedmoleculeswithanisolateddoubleortriplebond(2ndrow),andpurpleformoleculeswithπ-conjugatedsystems(3rdrow).SeetheﬁrstcolumnofTableIVforthenumberofoccurrencesperchemicalfamilyandsubgroup.Noticethefollowing:(i)forsaturatedmolecules,f1predictionerrorsarepresentalmostexclusivelyfortheDFTB-approximatemethods(seedatapointspopulatingthehorizontallineaty=0);(ii)forπ-conjugatedmolecules,theunderlyinglimitationisbeingsharedbetweenthecomparedmethods(seedatapointsalongthediagonallineaty=x);(iii)fortheunsaturatednon-conjugatedmolecules,f1predictionerrorsarepresentbutrathermild(seedatapointsclusteredneartheorigin).6|∆CC2f1|<0.01(|∆DFTf1|<0.01)TD-DFT:PBE0/def2SVPDFTB-Casida:3OBDFTB-Casida+LC:OB2DFTB-Casida:3OB(H*)AllSaturated[5531]87.7%45.2%(49.3%)32.4%(34.9%)46.7%(51.0%),→Epoxy[734]78.3%60.2%(72.8%)56.5%(71.5%)60.6%(73.0%),→Aziridine[1010]86.4%43.9%(47.0%)24.1%(28.0%)45.7%(48.3%),→Cyclopropane[1693]92.1%24.1%(24.7%)11.8%(11.1%)20.4%(21.3%),→Oxetane/Azetidine[755]85.8%68.0%(74.6%)54.6%(55.6%)73.3%(78.9%),→Tetrahydrofurane/Pyrrolidine/Cyclopentane[276]94.2%60.5%(66.3%)52.9%(55.6%)59.4%(61.2%),→Ether/Alcohol[852]90.6%52.8%(52.3%)39.7%(36.5%)59.6%(64.7%),→OtherAliphatic[211]78.0%36.8%(40.2%)19.6%(19.6%)50.7%(56.0%)AllUnsaturatednon-conjugated[6757]86.1%72.3%(77.8%)73.7%(78.1%)72.4%(78.2%),→Carbonyl[2775]100.0%96.0%(96.2%)99.3%(99.3%)95.6%(96.0%),→Alkyne[1520]86.5%69.9%(76.4%)65.1%(69.3%)72.4%(79.9%),→Cyano[1443]75.1%56.4%(70.8%)55.2%(66.3%)55.2%(69.3%),→Alkene[1019]63.6%33.7%(39.6%)42.8%(50.2%)33.3%(40.7%)AllUnsaturatedπ-conjugated[9498]74.9%66.0%(73.3%)63.5%(69.9%)66.3%(72.7%),→3-4Conj.atoms[4131]93.1%86.8%(90.5%)87.3%(91.3%)87.7%(90.8%),→5-6Conj.atoms[2909]63.5%53.7%(60.6%)49.5%(56.1%)54.3%(59.3%),→7-8Conj.atoms[2458]57.8%45.7%(59.3%)40.0%(50.2%)44.6%(58.1%)TableIV.Thistableshowsthepercentageofmoleculeswithoscillatingstrengths(f1)thatareconsideredgoodestimates(comparedtoCC2),forTD-DFT:PBE0/def2SVPandDFTB-approximateESmethodsinFig.S5.Inotherwords,thistableshowsforeachchemicalfamilyandsubgroupthepercentageofmoleculeswithabsolutef1predictionerrors(|∆CC2f1|)thatfellbelowthe0.01threshold(depictedasdashedlinesinFig.S5),avaluethatiscustomarilyusedtodistinguishbetweendark(f<0.01)andbright(f>=0.01)excitations.Inparentheses,wereportthepercentageofmoleculeswithoscillatorstrengthsthatareconsideredtobesimilarbetweenthecomparedmethods(i.e.,|∆DFTf1|<0.01).Intheﬁrstcolumn,foreachchemicalfamilyandsubgroupwealsoindicatethenumberofoccurrencesinthedataset(insidethesquarebrackets).