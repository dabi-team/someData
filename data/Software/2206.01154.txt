Astronomy & Astrophysics manuscript no. 43275corr
September 15, 2022

©ESO 2022

A graph-theory-based multi-scale analysis of hierarchical cascade
in molecular clouds

Application to the NGC 2264 region

Thomasson B.1, Joncour I.1, Moraux E.1, Crespelle C.2, Motte F.1, Pouteau Y.1, and Nony T.3

1 IPAG - Université Grenoble-Alpes
2 LIP - Université Claude Bernard Lyon 1
3 Instituto de Radioastronomía y Astrofísica, Universidad Nacional Autónoma de México, Apdo. Postal 3-72, 58089 Morelia, Mi-

choacán, Mexico

Received <date> / Accepted <date>

ABSTRACT

Context. The spatial properties of small star clusters suggest that they may originate from a fragmentation cascade starting from
molecular cloud, of which there might be traces found at spatial scales up to a few tens of thousands of astronomical units (kAU).
Aims. Our goal is to investigate the multi-scale spatial structure of gas clumps, to probe the existence of a hierarchical cascade over a
range of characteristic spatial scales, and to evaluate its possible link with star production in terms of multiplicity.
Methods. From the Herschel emission maps of NGC 2264 at [70, 160, 250, 350, 500] µm, clumps are extracted using getsf software
at each of the associated spatial resolutions (respectively [8.4, 13.5, 18.2, 24.9, 36.3]"). Using the spatial distribution of these clumps
and the class 0/I young stellar object (YSO) from Spitzer data, we developed a graph-theoretic analysis to represent the multi-scale
structure of the cloud as a connected network. This network is organised in levels, and each level represents a characteristic scale
among the available spatial scales. A link is created between two nodes which could be either a clump or a YSO from two diﬀerent
levels if their footprints overlap with each other. A parent node is then associated with a child node from a lower scale. The way in
which the network subdivides scale after scale is compared with a geometric model that we have developed. This model generates
extended objects that have a particularity in that they are geometrically constrained and subdivide along the scales following a fractal
law. This graph-theoretic representation allows us to develop new statistical metrics and tools aiming at characterising, in a quantitative
way, the multi-scale nature of molecular clouds.
Results. We obtain three classes of multi-scale structure in NGC 2264 according to the number of nodes produced at the deepest level
(called graph-sinks): hierarchical (several graph-sinks), linear (a single graph-sink with at most a single parent at each level), and
isolated (no connection to any other node). The class of structure is strongly correlated with the column density NH2 of NGC 2264.
= 6 × 1022 cm−2. Although the latter are in
The hierarchical structures dominate the regions whose column density exceeds NH2
the minority, namely 23% of the total number of structures, they contain half of the class 0/I YSOs, proving that they are highly
eﬃcient in producing stars. We deﬁne a novel statistical metric, the fractality coeﬃcient F , corresponding to the fractal index that
an equivalent population of clumps would have if they were generated by an ideal fractal cascade. For NGC 2264, over the whole
range of spatial scales (1.4-26 kAU), this coeﬃcient is globally estimated to be F = 1.45±0.12 and its dispersion suggests that the
cascade may depend on local physical conditions. However, a single fractal index is not the best ﬁt for the NGC 2264 data because
the hierarchical cascade starts at a 13 kAU characteristic spatial scale.
Conclusions. Our novel methodology allows us to correlate YSOs with their gaseous environment which displays some degree of
hierarchy for spatial scales below 13 kAU. We identify hierarchical multi-scale structures, which we associate with a hierarchical
fragmentation process, and linear structures, which we associate with a monolithic fragmentation process. Hierarchical structures are
observed as the main vectors of star formation. This cascade, which drives eﬃcient star formation, is then suspected of being both
hierarchical and rooted by the larger scale gas environment up to 13 kAU. We do not see evidence for any hierarchical structural
signature of the cloud within the 13-26 kAU range, implying that the structure of the cloud does not follow a simple fractal law along
the scales but instead might be submitted to a multi-fractal process.

Key words. Methods: data analysis - Methods: statistical - Stars: formation - open clusters and associations: individual: NGC 2264
- ISM: clouds

2
2
0
2

p
e
S
4
1

]

A
G
.
h
p
-
o
r
t
s
a
[

3
v
4
5
1
1
0
.
6
0
2
2
:
v
i
X
r
a

1. Introduction

Molecular clouds are large, cold, dense, and substructured
gaseous objects that host the formation of young stellar objects
(YSOs). Most of these YSOs are not found to be isolated
but are rather in close multiple systems (Duchêne & Kraus
2013), ultra-wide multiple pairs (UWPs, Joncour et al. 2017),
or are even concentrated in small local stellar groups deﬁned
as nested elementary structures (NESTs, Joncour et al. 2018;

González et al. 2021). These stellar structures cover spatial
scales ranging from a few thousand astronomical units (kAU)
to a few tens of kAU, suggesting that they originate from a
hierarchical fragmentation cascade of the cloud on a larger scale.

In order to study the large-scale hierarchy in molecular
clouds, Houlahan & Scalo (1992) and then Rosolowsky et al.
(2008) applied connected tree statistics (dendrograms). This

Article number, page 1 of 14

 
 
 
 
 
 
A&A proofs: manuscript no. 43275corr

method consists of separating a single image into several pixel-
intensity thresholds in order to describe the architecture of a
molecular cloud. In these dendrograms, the low-intensity iso-
contours of an image are connected to the higher intensity iso-
contours. As a result, the dendrogram branches out towards
higher intensity levels. By construction, this method extracts a
hierarchy in column density, and builds a network whose struc-
ture can be described using metrics; for example, the path length
between two nodes or the branching of a node. In addition,
Pokhrel et al. (2018) studied the hierarchical aspect of sizes
using several observations ranging from the cloud scale to the
prestellar core scale. This method has the advantage of being
based on a series of independent observations whose associ-
ated maps cover a wide range of spatial scales. Consequently,
the structural and multi-scale description of the hierarchical cas-
cade of the cloud can be highlighted. However, in contrast to the
work of Houlahan & Scalo (1992), the analysis of Pokhrel et al.
(2018) does not provide a simple framework to deﬁne metrics
that would allow the comparison of diﬀerent regions or of obser-
vational results with numerical simulations. Therefore, we pro-
pose a novel approach that takes advantage of both the network
representation of Houlahan & Scalo (1992) and Rosolowsky
et al. (2008) and the multi-scale description of the cloud from
independent observations (Pokhrel et al. 2018). The latter, cou-
pled with a network representation, would then make it possible
to compare, based on network metrics, diﬀerent star formation
regions with numerical simulations. These tools would then sup-
ply constraints to star-formation scenarios. In particular, we aim
to probe the ∼5-30kAU spatial scales in order to look for clues
as to the origin of small stellar groups such as UWPs (Joncour
et al. 2017) and NESTs (Joncour et al. 2018).

In order to test our methodology, we apply it to the molec-
ular cloud NGC 2264. Located at 723 pc (Cantat-Gaudin, T.
et al. 2018) in the Mon OB1 molecular cloud, NGC 2264 has
a complex star formation history. This cloud has an active
star-forming region in its central part, where the majority of
class 0/I YSOs have been identiﬁed (Rapson et al. 2014), as
well as two main clusters in the process of forming massive
stars (Cunningham et al. 2016; Nony et al. 2021). The distri-
bution of YSOs is characterised by an age gradient from the
northern part, which contains most of the older stars (Rapson
et al. 2014; Venuti et al. 2018), to the quiescent southern
part (Venuti et al. 2018). The analysis of this type of cloud
could therefore provide clues as to the fragmentation signa-
ture of a massive region that may trace the star formation history.

This paper is organised as follows. In Section 2, we present
the multi-scale data of NGC 2264 and our graph-theoretic
methodology applied to these data. In Section 3, we develop a
fractal hierarchical cascade model with extended objects before
deﬁning a network metric that can describe such a cascade. Us-
ing our model and metrics, we study the fractal behaviour of the
network of NGC 2264. In Section 4, we discuss the physical ori-
gin of the observed properties of the hierarchical cascade. We
conclude in Section 5 with a summary of our results and other
possible applications of our methodology.

2. Multi-scale representation of clumps and YSOs

in NGC 2264

In this section, our goal is to probe the existence of a hierarchical
cascade in NGC 2264. As we want to investigate this cascade
along spatial scales, we use a collection of Herschel maps of
NGC 2264 obtained at diﬀerent wavelengths to extract a set of

Article number, page 2 of 14

gaseous clumps covering a large range of spatial scales. Using a
network-based approach, we then connect the nested clumps and
identify disconnected graph components to evaluate the degree
of hierarchy in regards to the number of ﬁnal nodes contained in
each of these components.

2.1. NGC 2264 data

In order to span the ∼5-30kAU spatial scales that appear to be
the crucial range where hierarchical fragmentation may produce
UWPs, NESTs, and clusters of NESTs (Joncour et al. 2017;
Joncour et al. 2018), we use the Herschel imaging survey of
OB YSOs (HOBYS) multi-band observation data (Motte et al.
2010) of NGC 2264. These data are composed of ﬁve emission
images at [70, 160, 250, 350, 500] µm with respective spatial
resolutions of [8.4, 13.5, 18.2, 24.9, 36.3]”, corresponding re-
spectively to spatial scales of ∼[6, 10, 13, 18, 26] kAU consid-
ering the distance of NGC 2264 at 723 pc (Cantat-Gaudin, T.
et al. 2018). To extract intensity-peaked clumps in the ﬁve Her-
schel images, we used the multi-scale source and ﬁlament ex-
traction method getsf version v210609 (Men’shchikov 2021).
This algorithm applied to an image distinguishes three compo-
nents which are the sources, the ﬁlaments, and the background.
As we are only interested here in the extraction of clumps, that
is, the sources, we do not take into account the ﬁlamentary com-
ponent which remains embedded in the background component.
To extract the sources, the getsf method spatially decomposes
the image into several scales in order to give a ﬁrst identiﬁca-
tion of the sources and the background. The source images are
ﬂattened and small noise ﬂuctuations are removed such that the
sources are detected as signiﬁcant peaks of emission. The geo-
metric and ﬂux properties of the sources are ﬁnally measured in
the original image that has been dissociated with its background.
The catalogues produced by getsf contain the spatial character-
istics of the ellipsoid sources, in particular the major and minor
axes of the ellipses deﬁned as the full width at half maximum
(FWHM) of their Gaussian emission proﬁle. The getsf method
requires only one input parameter which is the maximum size
of the extracted sources, taken here to be about 2.5 times the
size of the beam associated with the image. This choice allows
us to not be too selective in the extraction, and to avoid extract-
ing objects that are too extended.As a result, [231, 202, 126, 92,
46] ellipsoidal clumps are extracted for their respective spatial
resolution of [8.4, 13.5, 18.2, 24.9, 36.3]”. This procedure of ex-
traction allows us to monitor the existence of clumps along mul-
tiple independent images with diﬀerent scales and to probe the
persistence of the gas structures throughout the scales. To com-
plement these ﬁve catalogues of clumps, we use a catalogue of
YSOs extracted from the Spitzer survey by Rapson et al. (2014).
This catalogue originally contains populations of Class III, II,
and 0/I YSOs. Only class 0/I YSOs are selected in this work.
Indeed, these YSOs are the most likely to be connected to their
parental environment, as they are among the youngest; see for
example Nony et al. (2021). As 5% of class 0/I YSOs are pri-
marily detected by the Multi-Band Imaging Photometer (MIPS),
the resolution of which is ∼7", and 95% of these YSOs are also
detected with the InfraRed Array Camera (IRAC), the resolution
of which is ∼2" , we choose 2" to be the associated scale for
the class 0/I YSOs. This resolution corresponds to a 1.4 kAU
spatial scale. As the getsf extraction is performed on a rectan-
gular window of (RA-DEC) corner coordinates [(100.10-10.15),
(99.52-9.53), (100.40-8.72), (100.98-9.34)]◦, we only keep the
YSOs that are inside this ﬁeld of view. A total of 87 class 0/I

Thomasson B.1 et al.: A graph theory-based multi-scale analysis of hierarchical cascade

YSOs are kept in this post-selection. Clumps and YSOs are then
connected according to the procedure presented in Section 2.2.

A column density image was also computed, which is used
in Section 2.4. This image at 18.2" resolution is provided by the
getsf method highres. This image was derived as follow. Us-
ing the [160-500]µm emission images, column density and tem-
perature images at diﬀerent resolutions were computed by ﬁt-
ting the spectral energy distribution (SED), assuming optically
thin thermal emission. These images were then recombined to
produce a high-resolution image of column density that contains
spatial information from all images at all resolutions. More de-
tailed information about the getsf source extraction method can
be found in Men’shchikov (2021).

2.2. Network methodology

In the previous section, we describe how we built catalogues of
clumps and YSOs, which we refer to here as substructures for
simplicity. Each substructure is associated with a speciﬁc spatial
scale s which corresponds to the resolution of clump extraction
and YSO detection. These substructures can be spatially con-
nected to each other if they overlap, that is, if one substructure is
contained within another at a larger scale. The nested substruc-
ture is called a ‘child’ while the container is called a ‘parent’.
We deﬁne a criterion of connection between two substructures
of two diﬀerent spatial scales. This criterion must take into ac-
count the spatial extent of the substructures we consider, both
child and parent. We establish the following inclusion criterion:
two substructures are connected if at least 75% 1 of the child
total surface is contained inside the extent of the parent. The
representation of our data by a connected network appears to be
the most adequate description. Indeed, a network is composed
of an ensemble of nodes, for which one node contains some data
information (in nodal attributes, e.g. size, wavelength, measured
ﬂux, etc.). These nodes are connected together with edges that
reﬂect the speciﬁc relationship between nodes. In our case, one
node describes a substructure which can be a clump extracted
from a speciﬁc image or a YSO. One edge reﬂects the inclu-
sion relationship that two substructures might have. Moreover,
a network makes it possible to organise the diﬀerent scales sl in
diﬀerent levels l as shown in Figure 1. Each of our six catalogues
is associated with an l level so that a total of six levels can be de-
ﬁned. The edge created between two nodes is oriented from the
parent (high-scale) to the child (low-scale) such that an oriented
network is constructed from l = 0 to l = L − 1, where L is the
total number of levels. In this work, L = 6 with s0 = 26 kAU and
s5 = 1.4 kAU. The number of substructures at each level l can be
written as: {N0, N1, ..., NL−1}. With this method of connection be-
tween substructures and between scales, the resulting connected
network contains several subnetworks that are independent of
each other. These subnetworks are disconnected from their coun-
terparts; they are components of the main network. From a phys-
ical point of view, this organisation reﬂects the spatial correla-
tion a parent has with its children. Indeed, a single component
describes a whole complex of connected substructures that are
all aﬃliated. On the contrary, two diﬀerent components describe
two spatially unaﬃliated complexes of substructures and two in-
dependent structures are deﬁned. In the remainder of this paper,
we use the term ‘structure’ to refer to these network components.

1 Here we use the 2σ extension of the ellipses. We multiply each axis
to get the 2σ Gaussian width from the FWHM axis provided
by
by getsf catalogues, and then check the overlap criterion.

2 ln(2)

1√

Fig. 1. Organisation of a network and deﬁnition of nodes. Each colour
corresponds to a scale. Each node shape corresponds to a speciﬁc kind
(source, sink, intermediate, or isolated). Three structures are repre-
sented: hierarchical, linear, or isolated. One example of each type of
structure is shown.

Inside a structure, there are nodes connected to each other. These
nodes are labelled as follows:

– Graph-sinks: nodes without children that inherit from at least

one parent.

– Graph-sources: nodes without a parent that breed at least one

child.

– Intermediates: nodes with child(ren) and parent(s).
– Isolated: nodes without a child or a parent.

If we write as {N0, N1, ..., NL−1} the number of substructures
contained in the structures shown in Figure 1 at all levels l, we
deﬁne the following structures types:

– Hierarchical: Structure with multiple substructures in at least
one level; for example {1, 2, 3, 3} substructures at level l.
– Linear: Structure with at most one single substructure at all

levels; for example {1, 1, 1, 1} substructures at level l.

– Isolated: Structure that is an isolated node; for example

{0, 1, 0, 0} substructure at level l.

We can then diﬀerentiate between non-persistent structures
(isolated), structures that physically only represent a single ob-
ject (linear), and structures that show some degree of multiplicity
and clustering between substructures (hierarchical). We use this
procedure to construct a network for NGC 2264 in the following
section (Section 2.3).

2.3. Extracted structures in NGC 2264

In NGC 2264, the network built by the procedure described in
Section 2.2 is composed of six levels of scale: ﬁve of them
contain clumps at their associated resolution and one contains
class 0/I YSOs. The network involves a total of 334 structures
in which 23 are hierarchical, 135 are linear, and 176 are iso-
lated (see Table 1 and left panel of Figure 2). Inside the same
class of structure, one can observe the diﬀerent physical nature
of graph-sinks (see Figure 3) as they can be associated either to
YSOs or clumps. In fact, some structures do not cascade down to
the last possible level, but stop before that. A structure that con-
tains a YSO might be in a more evolved stage of collapse since
star formation actually happened. The diversity in the nature of

Article number, page 3 of 14

A&A proofs: manuscript no. 43275corr

the graph-sinks inside hierarchical structure can also indicate the
global evolutionary stage. Indeed, if a hierarchical structure con-
tains YSOs as graph-sinks only, it is more likely to have ended its
star formation process than a structure hosting sibling YSOs and
clumps. With this representation, the existence of YSOs inside a
structure can be readily evaluated along with their multiplicity.

Fig. 2. Left: Statistics of extracted structures. Precise numbers are
shown above the bars. Hierarchical structures are represented with blue
bars (line hatching), linear with red bars (star hatching), and isolated
with black bars (circle hatching). Right: Statistics for each type of sub-
structure (YSOs or clumps) inside each type of structure.

Hierarchical structures contain 52% of the total YSO pop-
ulation and 28% of the total gaseous substructures (see Figure
2). As a majority of YSOs are forming inside hierarchical struc-
tures despite their under-representation in the cloud (∼7%), these
structures are not irrelevant when it comes to the formation of
young stars. Linear structures contain 50% of the population of
whole clumps but host only 28% of the total YSO population in
the cloud. To further evaluate the role of hierarchy in star for-
mation, we can assess the average production of YSOs and the
proportion of graph-sinks they represent. The hierarchical struc-
tures produce on average 2.0 YSOs while the linear structures
produce on average 0.2 YSOs. We would expect the linear struc-
tures to produce a maximum of one single YSO, which means
that most of the linear structures do not cascade down to the
stage of forming a young star (see Figure 3), or at least not yet.
In addition, the ratio (YSOs: graph-sinks) contained in a type of
structure indicates the actual proportion of YSOs found at the
end of the cascade. We ﬁnd that linear structures (8: 45 ratio)
are mainly composed of gaseous graph-sinks whereas hierarchi-
cal structures (45: 94 ratio) show a more dominant presence of
YSOs.

Consequently, hierarchical structures dominate the total pro-
duction of YSOs in the cloud and cascade more towards lower
levels compared with linear structures. Therefore, hierarchical
structures seem to be either more evolved than their linear coun-
terparts, or are the main vectors for the formation of YSOs; this
latter case would mean that hierarchical structures are closely
linked to the formation of stellar groups.

2.4. Spatial distribution
Another major diﬀerence between the types of structures we
extracted despite their YSO multiplicity is their location in
the cloud with respect to the column density background Σ.
In NGC 2264, structures appear to be partitioned with graph-
sources of all scales. The hierarchical structures are mainly lo-

Article number, page 4 of 14

Table 1. Number of structures of each class inside NGC 2264 with the
numbers of clumps and YSOs inside each of them. An X indicates the
absence of graph-sinks and graph-sources within isolated structures as
these structures do not contain them by deﬁnition.

Structures
Hierarchical Linear

Clumps
included

Number
YSOs included
70 µm
160 µm
250 µm
350 µm
500 µm
Total
YSOs + clumps
Graph-sinks
Graph-sources

23
45
69
52
33
25
16
195
240
94
34

135
24
77
91
84
63
29
344
368
135
135

Isolated
176
18
85
59
9
4
1
158
176
X
X

Total
334
87
231
202
126
92
46
697
784
229
169

calised in the two central hub regions (see Figure 4), while the
linear structures are mostly localised in the north and south ﬁl-
aments, and on the eastern region. Isolated structures are dis-
tributed everywhere and do not seem to have a preferential lo-
cation. In order to investigate the correlation between structure
type and local column density, we associated each class of struc-
ture to the number of pixels of the column density image they
cover. Then, inside a bin of column density BΣ, we evaluated
the proportion of pixels contained in a structure compared to
the total number of pixels of BΣ. In other words, we evalu-
ate the proportion of area covered by a type of structure inside
each bin of column density. We ﬁnd that hierarchical structures
occupy more than 95% of the map area with column density
NH2 > 6 × 1022cm−2 (see Figure 5). Hierarchical structures start
being dominant for density NH2 > 3 × 1022cm−2 with an area oc-
cupation > 40% while below NH2 ∼ 3 × 1022cm−2 all structures
coexist. This behaviour is consistent with the deﬁnition of hubs
and ridges, which are high-density (and therefore high-column
density) cloud structures forming clusters of stars with a high
star-formation rate (see e.g. Louvet, F. et al. 2014; Motte et al.
2018). In addition, the linear structures show a peak of presence
at NH2 ≈ 6 × 1021cm−2. This peak could indicate that local phys-
ical conditions govern the successive emergence of linear and
hierarchical modes in the cloud. As in this work we only focus
on the analysis of hierarchical structure, this eﬀect is not inves-
tigated further here. It is also important to consider that the cas-
cade might appear linear but may become hierarchical at higher
resolution, which we do not probe here. This eﬀect might convert
some of the pixels associated to linear structures into hierarchi-
cal structures, and thus increase the total hierarchy in the cloud.

3. Towards a fractal model of the hierarchical

cascade

In Section 2, we identify diﬀerent types of multi-scale structures
in NGC 2264. In this section, we focus on the hierarchical struc-
tures we highlighted. This hierarchical cascade is occurring in-
side the densest region of NGC 2264, and dominates the star
production in the cloud. However, the characteristics of this cas-
cade throughout the scales has not yet been investigated. In this
section we aim to evaluate the scale-free property of this cas-
cade. For this purpose, we compare the hierarchical cascade of
NGC 2264 with a fractal cascade model. To make a proper com-
parison, our model displays the spatial properties of substruc-

Thomasson B.1 et al.: A graph theory-based multi-scale analysis of hierarchical cascade

Fig. 3. Network representation of the data.
Each substructure is represented as a node with
respect to its speciﬁc scale, associated with a
ring. Rings from I to VI represent respectively
[26, 18, 13, 10, 6] kAU and class 0/I YSOs
at 1.4 kAU such that inner rings represent the
larger substructures and the scale is decreas-
ing towards the outer rings. The angular po-
sition indicates the membership of substruc-
tures to a structure. The cascade of one struc-
ture is processed in the same direction towards
the exterior of the wheel. Blue, red, and black
colours represent hierarchical, linear, and iso-
lated structures, respectively.

tures: these are spatially extended as ellipsoids and belong to a
speciﬁc scale. We also deﬁne a network metric to ease the com-
parison between the cascade of NGC 2264 and the fractal model.

3.1. Geometrical fractal model generation

3.1.1. Parameters and bases

The model proposed here consists of generating a population
of extended ellipsoidal clumps that subdivide into nested and
smaller ellipsoids along the spatial scale at diﬀerent levels l. In
order to reproduce the same network architecture that we build
for the data, we deﬁne multiple levels l associated to scales sl. As
the model is scale-free, the only important quantity is the scal-
ing ratio rl→l+1 > 1 between two spatial scales sl and sl+1 with
sl > sl+1:

rl→l+1 = sl
sl+1

.

(1)

The value of the initial scale s0 is intrinsically irrelevant as
the process we want to model is scale-free; however, it allows us
to deﬁne all the levels in the network and to assign a physical
dimension to the substructures we model. For example, the scale
s1 is deﬁned with respect to s0 with the scaling ratio r0→1. These
substructures subdivide following a fractal law of constant frac-
tal index N[r0] such that N[r0] children are generated each time the
scale of the parental substructure is reduced by a factor r0. If the
scale is reduced by any factor rm→l between two levels m and l,
we can always deﬁne x such that rm→l = r0
x where the exponent
x corresponds to the number of times the scale has been reduced
by r0 between levels m and l. The exponent x can be written as:

x = ln rm→l
ln r0

.

(2)

The number of substructures Nm→l produced from the level

m to the level l is then N[r0]

x, which leads to

ln Nm→l = ln rm→l
ln(r0)

× ln N[r0].

(3)

In particular, the total number of substructures Nl produced

by a level s0 graph-source at the level l is given by

ln Nl =

(cid:17)

ln

(cid:16) s0
sl
ln(r0)

× ln N[r0].

(4)

As N[r0] is deﬁned with respect to an arbitrary scaling ra-
tio r0, the scaling ratio rl→l+1 we request in the model does not
aﬀect the total multiplicity at the scale sl. Indeed, with these def-
initions, the fractal index allows a parental substructure to sub-
divide into the right number of pieces irrespective of the value of
rl→l+1. For example, a parental node in level l with fractal index
N[2] = 2 produces 2 substructures for rl→l+1 = 2; and 22 = 4
substructures for rl→l+1 = 4, which is consistent. Without this
scaling ratio of reference r0 in the deﬁnition of the fractal index,
the production of substructures would be the same for two diﬀer-
ent rl→l+1, which can lead to diﬀerent multiplicity, and therefore
to inconsistencies when we stop at the same scale whether we
take two, three, or more levels to reach it.

3.1.2. Generative subdivision process

Once the two parameters N[r0] and rl→l+1 of the model are de-
ﬁned, we can establish a procedure to generate extended sub-
structures. To start this generative process, an initial population
of Nini graph-sources is deﬁned at the initial scale s0. Each graph-
source subdivides into N1 pieces of size s1 < s0. Sizes are deter-
mined by the scaling ratio r0→1 (see equation 1) requested in the
process. N1 is determined by equation 4 with l = 1. Each sibling
placement inside a graph-source takes into account the spatial
extent of substructures (see Section 3.2). This procedure is re-
peated for all scales sl → sl+1 until the last scale sL is reached.

Article number, page 5 of 14

A&A proofs: manuscript no. 43275corr

Fig. 4. Column density image of NGC 2264 at 18.2" resolution. Extracted multi-scale structures are superimposed as coloured imprints with the
class 0/I YSOs (white crosses). Cyan (diagonal hatch), red (vertical hatch), and black (horizontal hatch) ellipses locate hierarchical, linear, and
isolated structures, respectively. The white arrow indicates the north.

As Nl represents the total number of substructures produced by a
graph-source at the level l, we redistribute these Nl substructures
equally into their Nl−1 parents, which will contain N = Nl/Nl−1
substructures each. For the case in which N is a non-integer num-
ber, the selection of the ‘real’ (cid:101)N is done randomly using a bino-
mial rule between (cid:98)N(cid:99) and (cid:100)N(cid:101) with respective probability 1−{N}
and {N}; where (cid:98)x(cid:99) and (cid:100)x(cid:101) denote the ﬂoor and ceiling function
of x, respectively, and {x} denotes its fractional part. It is not ex-
cluded that two graph-sources share a child in common if their
extent overlaps; in this instance, they would be part of the same
structure. Consequently, a structure generated by our model pos-
sesses on average Nini × Nl substructures at the level l, but indi-
vidual structures may not host exactly Nini × Nl substructures if
Nini × Nl is a non-integer.

terms of inheritance. Each substructure is deﬁned by its centroid
coordinates (x, y); by its major and minor axis (a, b), respec-
tively; and by its position angle θ in 2D space. The coordinates
of the graph-sources are sampled uniformly in a squared window
while the coordinates of the children are sampled uniformly in-
side their parental ellipsoids (more details in Sections 3.2.3 and
3.2.4). The orientation is sampled uniformly between 0 and π.
The major axis a is sampled in a normal distribution N(sl, sl
10 )2
for which the mean value sl is the scale of the substructure in-
side the level l, and the standard deviation is equivalent to 10%
of its typical scale to allow small ﬂuctuations. The minor axis is
taken from the value of the major axis and the aspect ratio which
is sampled uniformly between 0.5 and 1 as getsf extraction re-
jects clumps with aspect ratios < 0.5.

3.2. Rules of substructure selection

3.2.1. Geometrical parameter sampling

Because our model generates extended objects, it is necessary
to establish rules in order to synthesize a coherent population
both in terms of spatial coverage inside the same level l, and in

Article number, page 6 of 14

2 The probability of getting a negative value is given by the cumulative
(cid:17)
(cid:16)
1 + er f (− 0−µ
function P(x < 0) = 1
, where er f represents the error
√
2
σ
2
function. This probability is independent of sl because µ = sl and σ =
sl
10 in our case. As P(X < 0) < 1.10−16, the probability of sampling a
negative value is unlikely.

)

Thomasson B.1 et al.: A graph theory-based multi-scale analysis of hierarchical cascade

Fig. 5. Stacked histogram of the surface covered by structures per bin of
surface density, normalised by the total area covered by a bin of surface
density. White bars are unassigned pixels, red (stars) are linear struc-
tures, blue (lines) are hierarchical, and black (circles) are isolated. Ver-
tical lines represent threshold for the proportion of area covered by hi-
erarchical structures, from left to right: 0%, 40%, 100%.

Fig. 6. Rules of selection for the model. Rule#1: The distance d between
the centroids of two substructures of the same level at scale sl needs to
exceed the indicated tolerance. Rule#2: As the child (red) lies within
its parent (blue), its extent can go beyond the grey area as long as 75%
of its area remains inside its progenitor. Rule#3: Child (red) centroid
lies within its parent (blue), but avoids the forbidden area at the centre
(grey). The minimal separation dmin between the centroids of siblings is
seen as the diameter of the forbidden area.

because this is the tolerance requested to deﬁne our structures in
the data for NGC 2264.

3.2.2. Rule#1: Minimal distance between substructures of an

l level

3.2.4. Rule#3: Room for siblings

Two substructures that belong to the same level l cannot be closer
(taking the centroid distance) than their typical scale, or they
would blend. Their spatial extent can only overlap up to a cer-
tain limit. In this model, the typical scale sl of generated sub-
structures is taken to be 2σ of the extent of a real substructure.
However, in observational data, the typical scale of substructure,
which can be associated to the image beam, is deﬁned with re-
spect to their FWHM. In our model, two substructures of scale
sl cannot be closer than
2 ln(2) is the
scaling factor between FWHM and 2σ such that the scale de-
ﬁned in the model is comparable to the scale one can deﬁne in
real data. This leads to Rule#1: the minimal distance between the
2 ln(2) × sl.
centroids of two substructures inside the level l is

2 ln(2) × sl. The factor

√

√

√

3.2.3. Rule#2: Child coverage inside its parent

In Section 2.2, the inheritance property of the network is deﬁned
as the inclusion relationship between a child and its parent. The
two are connected if 75% of the child spatial extent is contained
inside its parent (see Fig 6). This relationship needs to be kept
when a child is placed inside a parent during the generative pro-
cedure. In polar coordinates [R; φ], the equation of the border of
an ellipse of half major axis a and half minor axis b is:

(cid:115)

Rmax = a

cos2 φ +

(cid:33)2

(cid:32)

b
a

sin2 φ.

(5)

The child centroid coordinate inside such an ellipse is sampled
in:
(cid:40)R ∈ [0, Rmax]
φ ∈ [0, 2π]

(6)

.

During the generation of hierarchical structures, it is expected
that more than one child need to be placed inside a parent. When
adding siblings, a geometrical constraint can appear if the ﬁrst
selected child lies in the middle of its parent. A child placed in
the central area may prevent its siblings from being placed as its
presence drastically reduces the available space. If this happens,
the parental clump may be overcrowded and there could be in-
suﬃcient space available to actually select a sibling according to
Rule#1 and Rule#2. To reduce this geometrical constraint, the in-
ner area of the parent is forbidden for the centroid selection of a
child. By adding this forbidden area, the probability of choosing
a child that prevents the placement of siblings is reduced, relax-
ing the constraint. The full extent of this inner region is taken
as the minimal separation between two clumps (consequence of
Rule#1), and is supposed to be circular (isotropic because the
distribution of orientation θ is uniform). Therefore, the radius of
the inner region is half of its full extent (see Fig. 6). In case of
multiple children, centroid coordinates are selected according to
Rule#3 which alters the original selection as follows:

(cid:34) √

2 ln(2) × sl
2

, Rmax

(cid:35)

.

(7)



R ∈


φ ∈ [0, 2π]

We note that if only one child is desired, this area becomes
useless and the child is able to be placed anywhere inside its
parental area, provided that Rule#2 is fulﬁlled. Consequently,
our model generates a population of substructures and takes into
account their spatial extent. The resulting network mimics those
that can be derived from a real observational data set and can be
tested.

A threshold limit is then imposed to verify that the proportion of
the area of the child that lies within that of its parent actually ex-
ceeds 75%. This deﬁnes Rule#2: a parent needs to cover at least
75% of the area of its child for this child to actually exist and
be placed. This threshold is purely arbitrary and 75% is chosen

3.3. Metric to describe a fractal hierarchical cascade

3.3.1. A measure of the network fractality

Our geometrical fractal model generates a population of ex-
tended substructures. These substructures can form hierarchical

Article number, page 7 of 14

A&A proofs: manuscript no. 43275corr

structures (for N[r0] > 1) or linear structures (for N[r0] = 1). As
we focus on hierarchical structures, we consider that the popula-
tion of structures generated by our model is hierarchical. In order
to characterise the hierarchical cascade in terms of multiplicity,
we deﬁne a network fractality coeﬃcient F . This coeﬃcient is
a measure of the fractal index that would best describe a net-
work (e.g a hierarchical structure). Computing this coeﬃcient
for a structure generated by our model returns the input free pa-
rameter N[r0]. Therefore, by measuring F in the data, we aim to
estimate the parameter N[r0] that would best ﬁt our model. To
compute this coeﬃcient F in the data, we ﬁrst measure the to-
tal number of nodes (i.e. substructures) V0 of a network G0 that
possesses L levels of scales sl. We then compare this number of
nodes with the expected number of nodes produced by an ideal
fractal network using equation 4. Consider an ideal fractal net-
work G that subdivides into N[r0] pieces for each scale reduction
of an arbitrary factor r0. This network of reference contains the
same levels as G0. On one hand, G0 possesses a total number of
V0 nodes. On the other hand, the total number of nodes V pos-
sessed by G is the sum over the levels of all nodes contained in
the level l. To lighten the notation, we consider here N = N[r0].
The number of nodes at a level l is, according to equation 4, N xl
where xl = ln(s0/sl)
ln(r0) . The total number of nodes belonging to G is

V = N x0 + N x1 + ... + N xL = (cid:80)L



xl = ln (s0/sl)
ln(r0)

l=0 N xl

(8)

.

Because both networks need to be equivalent in terms of the
number of nodes for comparison, we have V0 = V. When this
condition is fulﬁlled, the measure of the fractality F of G0 is
equivalent to the fractal index N by deﬁnition. Hence, F = N
when V0 = V. The previous equation can therefore be written as

The measurement of F can be performed for any network
built under our graph-theoretic representation, whether data
comes from the model or real data. From this measurement, we
can assess the number of subdivisions one equivalent fractal net-
work would have with the same number of levels. We can eval-
uate the production of substructures scale by scale and compare
it with an equivalent fractal network using our fractal model.

3.3.2. Structure productivity at each scale

The productivity of structures evaluates, at each scale sl of a
structure, the number of substructures that appears with respect
to the number of graph-sources Nsources in this structure. This
is the ratio between the number of substructures at a scale sl,
and the number of graph-sources of the structure. Normalising
by Nsources is interesting because if a structure contains multiple
graph-sources, the total number of substructures (assuming an
ideal fractal cascade) would be multiplied by Nsources, and the
production rate might be biased. For a fractal process of index
N[r0], Equation 4 gives the relationship between the number of
substructures Nl produced at the scale sl and N[r0]. By dividing
the equation by Nsources:

Nl
Nsources

=

N

sl )/ln r0

ln( s0
[r0]
Nsources

.

This leads to

(cid:32)

ln

Nl
Nsources

(cid:33)

=

Letting Y = ln
written as

ln

(cid:17)

(cid:16) s0
sl
ln(r0)
(cid:16) Nl
Nsources

(11)

(12)

× ln N[r0] − ln Nsources.

(cid:17)

and X = ln

(cid:17)

(cid:16) s0
sl

, the relation can be






V0 −

L−1(cid:80)
l=0

F xl = 0

xl = ln (s0/sl)
ln(r0)

.

(9)

Y = ln N[r0]
ln(r0)

× X − ln Nsources.

(13)

Consequently, F is the root solution of the previous equa-
tion, and can be computed numerically. With the deﬁnition of
the exponent xl, F is independent of the set of scales sl avail-
able. Indeed, a diﬀerent set of scales would have no impact on
the theoretical value of F because it is deﬁned with respect to a
ﬁxed, arbitrary scaling ratio r0. However, some of the hierarchi-
cal structures in the data for NGC 2264 contain multiple graph-
sources, whereas Equation 9 accounts for networks with a single
graph-source. For each graph-source i of a structure, we compute
a fractality Fi that is computed from the subnetwork described
by all the nodes that are directly aﬃliated to this graph-source
i. For example, consider a hierarchical structure with a graph-
source i = 0 that is linked with nodes labelled A, B, and C. An-
other graph-source i = 1 is aﬃliated to nodes C, D, and E. Then,
F0 is computed from nodes A, B, and C regardless of D and E,
even though these latter are part of the structure. Similarly, F1
is computed from nodes C, D, and E. Hence, the fractality of
the whole structure is deﬁned as the average of these individual
fractality coeﬃcients over all the graph-sources:

F = < Fi >sources =

Fi

Nsources(cid:80)
i=0
Nsources

.

Article number, page 8 of 14

(10)

The productivity of an ideal fractal cascade should be de-
scribed by a power law in which the slope in a log–log scale
ln N[r0 ]
ln(r0) . In order to test the fractal behaviour
indicates the value of
of a structure, we can evaluate the compatibility between the pro-
ductivity of the structures in NGC 2264 data and the productivity
of a fractal structure with a similar fractality.

This can be done easily as the slope of the productivity de-
pends directly on our model parameters. Moreover, in the case
of an ideal fractal cascade, the measurement of the fractality
corresponds to the fractal index we need to put in our model.
Therefore, measuring the average fractality per graph-source in
a structure gives us what should be the fractal index, which we
put in the model for comparison.

3.3.3. Fractality uncertainty and limit of the model

In this subsection, we aim to characterise the uncertainty of the
fractility coeﬃcients computed from our model, which we want
to compare to the theoretical fractality index of an ideal cascade
process. Unlike the former network, the ideal cascade is charac-
terised by a fractional number of substructures for a given scale.
The network built from the NGC 2264 data or our model is char-
acterised by an integer number of substructures for a given scale.

Thomasson B.1 et al.: A graph theory-based multi-scale analysis of hierarchical cascade

Therefore, for each individual hierarchical structure, we derive
an approximate value of the fractality. However, if we assume
that a population of structures subdivide with the same fractal
law (e.g. generated by our model), then taking the average of
the fractality coeﬃcients of this population must converge to the
true value of the fractality.

There is another source of error when considering model-
generated data. Indeed, our model requires that a substructure at
a level l subfragments into at least one child for the cascade to
continue towards lower levels. This condition guarantees that the
resulting network is continuous along the branches, and that each
branch is equivalent from one to another. For example, consider
structures that are supposed to contain 1.2 substructures at the
level l = 1 and 1.5 substructures at the level l = 2 on average,
and speciﬁcally any graph-source of one of the structures. At the
level l, the model selects an integer number of substructures to
put into the level l = 1: either 1 or 2 can be selected, but on
average it has to be 1.2. Assuming the model selects 2, we need
to place 1.5 substructures at the level l = 2 inside two existing
substructures at level l = 1. As zero children is impossible, the
model always puts one substructure inside each of the existing
substructures. The choice of selecting two substructures at the
level l = 1 always results in two substructures at the level l = 2.
However, the choice of selecting one substructure at the level l =
1 results in 1.5 substructures on average at the level l = 2. The
total number of substructures tends to be overestimated. As a
consequence, the fractality is overestimated. This can be seen in
Figure 7 where the value of the fractality is systematically above
the expected value for model-generated data. However, this error
is always less than 5% of the expected value. This eﬀect is due
to a low fractal index coupled to a low scaling ratio between two
consecutive levels.
If we want

to compare our model with the data for
NGC 2264, we need to take into account another eﬀect. Indeed,
in these data, some of the intermediate substructures might not
be detected at a speciﬁc scale. An undetected clump at this scale
directly aﬀects the fractality value because it reduces the num-
ber of nodes of the structure by adding a hole in the cascade (see
Figure 8). Our model can be used to quantify the error caused by
the missed detections to determine a fractality conﬁdence inter-
val. For diﬀerent fractal index (see Figure 9), we use the scaling
ratios that are deﬁned by the NGC 2264 data set and we generate
a population of 1 000 graph-sources. We then randomly delete
a speciﬁc proportion of nodes inside each structure, excluding
their graph-sources, and compute the fractality.

3.4. Fractal hierarchy in NGC 2264

Further analysis regarding the hierarchical structures is per-
formed with NGC 2264 data using both our geometrical
model and the metric F deﬁned in Section 3.3. This analysis
is performed speciﬁcally on hierarchical structures because
both the model and the metric we designed were made to
describe hierarchy. Computing the fractality on linear structures
systematically returns a value of 1, and computing it for isolated
structures is useless by deﬁnition. As pointed out in Section
3.3.3, fractality computation is biased by the fact that some
hierarchical structures may miss intermediates substructures.
In order to properly compare the structures of NGC 2264
with the model, we need to estimate the number of missing
substructures in these structures. As the networks that represent
these structures contain holes at some levels instead of nodes,
we count the number of holes. Hence, a structure containing
{1, 0, 0, 2} substructures at a level l is considered to possess four

Fig. 7. Average fractality relative error over the structures for diﬀerent
fractal index put in the model. For each fractal index we sample 1 000
initial graph-sources, subdividing through levels deﬁned by the scaling
N − 1 where σ is the
ratios of NGC 2264. Error bars are taken as σ/
standard deviation of the fractality of the N structures.

√

holes in total (two holes per graph-sink). Under the assumption
that no graph-sink is missing, and in the worst case scenario,
this structure can have a {1, 2, 2, 2} conﬁguration. This method
overestimates the number of holes, because it does not consider
the eventual merging of substructures at higher scales. As we
overestimate the number of substructures, we overestimate the
fractality we want to compute. Hence, we can assess an upper
limit. To estimate a lower limit, we take the fractality value
without any hole-ﬁlling.

On average,

the extracted hierarchical population for
NGC 2264 gives F = 1.45. However, the median value (1.33)
seems to be a more appropriate estimator because of the asym-
metry of the distribution (see Figure 10). As our data contain
holes, this estimation of the fractality is underestimated. We
therefore take Fmin = 1.33 as a lower limit for the fractality. We
estimate the maximum proportion of holes in hierarchical struc-
tures to be 45%. This corresponds to a fractality negative varia-
tion of ∼15% according to Figure 9. Solving (1 − 0.15)Fmax =
1.33, we estimate the upper limit Fmax = 1.57. This value is also
consistent with the median of the fractality distribution after ﬁll-
ing the holes in the structures. As the true fractality for the whole
population is likely to ﬂuctuate between 1.33 and 1.57, we derive
F = 1.45±0.12 for the total population of hierarchical structures
in NGC 2264.

Taking into account the bias introduced by the holes, we
choose to compare the NGC 2264 hierarchical structures with
the structures of our fractal model of index 1.57, where we
randomly deleted 45% of the nodes inside each structure. In
particular, the distribution of fractality coeﬃcient in NGC 2264
is wider than the distribution extracted from our model (see
Figure 10). This means that the NGC 2264 structures and
our model are not equivalent in terms of fractality despite
our correction concerning the holes. In fact, a single value of
fractality fails to describe every single structure in the data.
If the fractal assumption were true, we would expect to get
a homogeneous fractality coeﬃcient
the cloud
regardless of the scale considered (assumption of mono-fractal
process) and also independent of the physical environment
(temperature, density, turbulence). This dispersion may suggest
that the fractality of structures, and by extension the multiplicity

throughout

Article number, page 9 of 14

A&A proofs: manuscript no. 43275corr

Geometry

Network
rl→l+1
node removed
F computed

4
0
2.0
Fig. 8. Example of structures generated by the model with a scaling index N[2] = 2 and multiple constant scaling ratio rl→l+1 = r, ∀l. Nodes
were removed randomly to simulate the types of structures that the observation can provide. The fractality coeﬃcient F is reported as well as the
number of missing nodes. In all of these generations, F = 2 is expected.

1.5
4
1.8

1.5
0
2.0

2
4
1.7

2
0
2.0

4
4
1.9

that we encounter the same issue as before concerning the po-
tentially missed intermediate substructures. The previous tech-
nique that consists of ﬁlling the holes cannot be used here be-
cause it assumes that the hierarchy begins at the highest levels
in order to assess what would be the worst-case scenario to eval-
uate an uncertainty, while here we investigate the multiplicity
property scale by scale. A similar correction would completely
bias the result, given that we do not know whether or not the
hierarchical cascade actually has a starting scale; and if it does,
we do not know what this starting scale would be. Therefore, we
consider the curve without any correction and discuss its relia-
bility in Section 4.1. A depletion of YSOs can be seen below
6 kAU: structures in NGC 2264 do not produce as many sub-
structures as the model at the last level. Indeed, down to 1 kAU,
the model predicts about four class 0/I YSOs per graph-source
in a structure, whereas about one or two YSOs are produced per
graph-source in most structures in NGC 2264. There are multiple
factors that could explain this eﬀect: half of the graph-sinks are
clumps which might indicate that the gas reservoir is not fully
depleted, and star formation can still occur in the future ; the
subdivision rate slows down to produce YSOs ; the oldest class
0/I evolve towards class II objects and are not taken into account
in this study.

4. Discussion

Fig. 9. Ten thousand graph-sources sampled in our model and subdi-
vided along the scales deﬁned for NGC 2264 (see Section 2.1) for the
four diﬀerent fractal indices N[r0] reported in the legend. Top: Average
fractality of the whole population for each fractal index as a function
of the removed nodes. Horizontal dashed line indicates the fractality
measured for NGC 2264 in Section 3.4. The vertical dashed line cor-
responds to the estimation of the maximum proportion of nodes unde-
tected in NGC 2264 in Section 3.4. Bottom: Relative error of the fractal-
ity as a function of the removed nodes. Horizontal dashed line indicates
a 0% variation. Positive relative errors are due to over-sampled substruc-
tures in the model with low fractal index (more details in text Section
3.3.3).

of their substructures, could depend either on local physical
conditions or on the scale itself.

4.1. Origin of the plateau observed in the hierarchical

cascade

The hierarchical property of the structures of NGC 2264 can
be tested by analysing the hierarchical cascade scale by scale
using the productivity of structures per graph-source as intro-
duced in Section 3.3.2. The result of the productivity curve in
NGC 2264 is also compared with our model in Figure 11 with a
fractal index of 1.57 with 45% of the nodes removed. This com-
parison conﬁrms that the hierarchical structures in NGC 2264
are incompatible with a single fractal fragmentation. Indeed, be-
tween 26 kAU and 13 kAU, the productivity of the structures
of NGC 2264 remains constant: the networks are locally linear
until the resolution is high enough to observe a subdivision. No
hierarchical cascade seems to occur at these scales. Because we
do not obtain the same trend with our geometrical model, this
eﬀect is not due to low scaling ratios between the scales. The
geometrical constraints coupled with random deletion of holes
cannot explain this result. It is important to consider the fact

Article number, page 10 of 14

In Section 3.4 we show that
the hierarchical cascade in
NGC 2264 is not fractal over the full 6-26 kAU range. Indeed,
the substructure production scale by scale plateaued on scales of
> 13 kAU. We perform a series of tests allowing us to evaluate
the robustness of the cascade and check whether the plateau
may arise from spatial resolution and/or wavelength eﬀects.

4.1.1. Spatial resolution effect
First, we start by checking spatial resolution eﬀects. When a
cloud is observed, the ﬂux received at a given wavelength is
convolved with the instrumental beam whose size deﬁnes the
angular resolution. Through convolution, two substructures at
a given scale may or may not merge. If the substructures are
spaced far enough apart such that they do not merge, we would

Thomasson B.1 et al.: A graph theory-based multi-scale analysis of hierarchical cascade

catalogues were then reprocessed by our network procedure in
order to extract the new structures, keeping the original 70 µm
and class 0/I YSO data at lower scales. When we investigate the
substructure production scale by scale with these modelled data,
we do not observe any plateau on scales > 13 kAU, but we see
an actual increase in the substructure production (see Figure 11).
Therefore, the plateau cannot originate from a pure spatial reso-
lution eﬀect.

4.1.2. Wavelength effect

Secondly, we discuss the inﬂuence of the wavelength on the
detection of clumps. Indeed, each spatial resolution is associated
with a speciﬁc wavelength, and each wavelength is associated
with a diﬀerent ﬂux and emission temperature of dust. We do
not observe exactly the same sky between images at 500 µm and
images at 250 µm or at 160 µm. The plateau that is observed
for scales larger than 13 kAU (see Figure 11) could be due to
the failure to detect large-scale clumps that would allow their
productivity curve to ﬂatten at high scales. We also investigated
whether there is indeed a tendency to loose clumps at large
scales.

Let us set I(θ, λ) as the map associated with the θ resolution
in arcsec and λ wavelength in µm for simplicity. We already
have original data for which a wavelength is associated with a
resolution (i.e. I(36.3, 500), I(24.9, 350), I(18.2, 250), I(13.5,
160)), and the data we obtained by convolving the 160 µm
map to higher resolutions (i.e I(13.5-to-36.3, 160)). In order to
complete these two data sets, we additionally convolved the 250
and 350 µm maps at 36.3" resolution and extracted clumps with
the getsf procedure. We thus obtained new I(36.3, 250) and
I(36.3, 350) data. Using our methodology of associating clumps
with each other, we can connect the I(36.3, 160-to-500) data
in terms of wavelength (and not in terms of scales). With these
data we investigated the persistence of the clumps in each of the
data sets, which is the proportion of clumps that are found from
one scale or wavelength to another. This study was performed
in terms of constant wavelength (I(13.5-to-36.3, 160)), constant
resolution (I(36.3, 160-to-500)), and real data (I(13.5-to-36.3,
160-to-500)). We completely ignored the 70 µm clumps and
YSOs because we only want the large-scale information and,
unlike longer wavelengths, 70 µm does not trace optically thin
thermal emission. We want to assess how the appearance of a
clump changes along the wavelengths. As we are convolving
the images to have new datasets and populations of clumps,
we want to avoid the case where a clump in the vicinity of the
one we are looking at interferes in any way with its persistence
measurement. As hierarchical structures are a complex of
clumps, and isolated structures are observable in only one wave-
length, we need to consider only the linear structures. Indeed,
the latter represent multi-scale and multi-wavelength single
objects without immediate proximity of another object. With
this method of synthesising data at several diﬀerent wavelengths
(I(36.3, 160-to-500)), we implicitly couple the resolution eﬀect
with the wavelength eﬀect. Indeed, with successive convolutions
of a map, the ﬂux of a clump is diluted in its close environment,
which corresponds to the size of the Gaussian kernel with which
we convolve the map. Despite this, we know what happens
during a pure convolution with the set I(13.5-to-36.3, 160) (see
Section 4.1.1).

Comparing the persistence of I(13.5-to-36.3, 160-to-500)
and I(13.5-to-36.3, 160) data, we show (see Figure 12) that the

Article number, page 11 of 14

Fig. 10. Normalised distribution of fractality coeﬃcient F for diﬀerent
sets of data. In blue, F distribution for the hierarchical structures in
NGC 2264. In red, F distribution with our fractal model of index 1.57
where we have removed 45% of the nodes. In black, F distribution for
the convolved data (see Section 4). The red dotted line corresponds to
the median value of 1.33.

Fig. 11. Average productivity of hierarchical structures for each scale.
Blue circles represent NGC 2264 data. Red triangles represent a popula-
tion of 1 000 structures generated by our geometrical model with a frac-
tal index of 1.57 where we have removed 45% of the nodes. Blue dot-
ted curve represents an ideal fractal fragmentation of index 1.33. Black
crosses represent the same curve for convolved data (see Section 4).

expect to have a one-to-one correspondence between the orig-
inal substructures and their convoluted counterparts, that is, a
plateau in terms of substructure production. If the substructures
are close enough to merge at higher resolution, then this plateau
cannot exist as there is no longer a one-to-one correspondence.
In order to evaluate the inﬂuence of spatial resolution on our re-
sults, we performed a convolution of the 160 µm emission image
at [18.2, 24.9, 36.3]" resolution. New catalogues of clumps were
obtained using getsf source extraction on the new images using
the same setup as for the original data (see Section 2.1). These

A&A proofs: manuscript no. 43275corr

persistence of the original data is very similar to the persistence
of data obtained from the convolution. For the 24.9" to 36.3"
transition in both data sets, 45% of the clumps at 24.9" can be
retrieved at 36.3". In the other transition, 70% of the I(18.2, 250)
clumps are retrieved in the I(24.9, 350) data whereas 54% of the
I(18.2, 160) clumps are retrieved in the I(24.9, 160) data. This
suggests that from one scale to another, on average, the resolu-
tion eﬀect dominates the probability of detecting a clump, and
wavelength might inﬂuence the detection of clumps. Neverthe-
less, we systematically detect more clumps at equal resolution in
I(13.5-to-36.3, 160-to-500) than in I(13.5-to-36.3, 160). There-
fore, if there is a wavelength eﬀect, it tends to increase the num-
ber of clumps detected. However, in order to ﬂatten the produc-
tivity curve at large scales, the number of substructures needs
to be reduced so that a plateau can be obtained. Furthermore,
the reason we have a plateau in the productivity curve is that a
single substructure is produced between 250 and 500 µm. There
should be a loss of detection in this area. If we look at the per-
sistence on the I(36.3, 160-to-500) data, by degrading the map
at 350 µm to 36.3" resolution, we ﬁnd 79% of the clumps de-
tected at 500 µm. Therefore, if we have a 21% loss between 500
and 350 µm, this means that one clump out of ﬁve disappears.
To explain the plateau, we would need one clump out of two
given the geometrical constraints, which is at least a 50% loss.
As this loss is not obtained at longer wavelengths, the lack of
clumps on this range seems unlikely. The same applies to losses
between 350 and 250 µm. On the other hand, if there were a ten-
dency for clumps to appear at longer wavelengths, this could not
explain a ﬂattening of the curve because there would be more
substructures in this wavelength domain. Wavelength eﬀects ap-
pear to be negligible compared to resolution eﬀects and seem
insuﬃcient to explain a ﬂattening of the hierarchical cascade at
large scale. The spatial resolution eﬀects are already contained
in the 160 µm convolved data set, and are already contained in
the productivity curve in Figure 11. We can therefore assess the
physical reality of the plateau observed in the productivity curve
for scales of between 13 kAU and 26 kAU.

4.2. Interpretation of the hierarchical cascade

The hierarchical cascade we outlined can be interpreted as a
fragmentation cascade. According to this framework, the turbu-
lent (Larson 1978; Padoan 1995) or gravo-turbulent (Hopkins
2013; Guszejnov et al. 2018a; Vázquez-Semadeni et al. 2019)
fragmentation model assumes that the gravitational instabilities
responsible for the cloud fragmentation originate from super-
sonic (Padoan 1995) velocity propagation. These turbulent mo-
tions allow matter to condense locally, resulting in a cascade of
turbulence from large to small scales. These instabilities subse-
quently ‘subfragment’, allowing a chain of ‘collapse within col-
lapse’ (Vázquez-Semadeni et al. 2019; Krause et al. 2020) in
which the smaller scales accrete matter from the larger scales.
However, this idea of a hierarchy in the fragmentation process is
not universal. Indeed, as the gas ﬂow velocities become subsonic
(Mach number > 2-3, Hopkins 2013; Guszejnov et al. 2018b),
the cloud may collapse into a single massive fragment instead
of forming several sibling fragments (Guszejnov et al. 2018b).
Therefore, if we consider that the hierarchical cascade originates
from fragmentation processes, we can dissociate two regimes.
Indeed, in this interpretation, hierarchical structures describe a
mode of hierarchical fragmentation (e.g. Hoyle 1953; Vázquez-
Semadeni et al. 2019) in which a single clump fragments into
multiple pieces while linear structures may be associated to a
monolithic fragmentation where the collapse is radially concen-

Article number, page 12 of 14

Fig. 12. Representation of the successive association of clumps between
scales and wavelengths for linear structures. Red markers are associated
with the original data from NGC 2264. Blue markers are associated with
the data from the convolution of the image at 160 µm to resolutions
of 13.5, 24.9, and 36.3". Green markers are associated with data from
the convolution of the 160, 250, and 350 µm maps to a resolution of
36.3". The numbers in the markers indicate the number of associated
substructures. Triangle markers are turning points to make it clear that
even though the data are the same, the substructures associated with
the linear structures may change. The percentage in the middle of the
arrows gives the proportion of substructures that persist from the out-
coming node to the in-coming node.

trated and one clump collapses into a single clump or YSO (e.g.
Shu 1977; Krause et al. 2020).

This concept of hierarchical ‘subfragmentation’ originates
from Hoyle (1953) who studied the hierarchical collapse from
Galactic scale down to prestellar cores assuming isothermal col-
lapse of a spherical cloud. In this model, we expect a fractal pro-
cess of fragmentation in which two fragments are formed each
time the scale of the parent is reduced by a factor of two. Ap-
plied to our work, this process would be associated to a fractal-
ity value of two. Considering a fragmentation process that starts
at 13kAU, a fractality of two would, on average at 6kAU, in-
duce 2.17 fragments per graph-source whereas we actually get
2.05 ± 0.20 fragments at 6kAU in NGC 2264 which is consis-
tent with the hierarchical model of Hoyle (1953). Nevertheless,
hierarchical fragmentation is associated with turbulent scale-free
processes which one would expect to exhibit fractal behaviour.
However, there does not seem to be any fractal subdivision in
NGC 2264, but rather a range of scales for which the cloud
does not fragment before starting these hierarchical processes.
Therefore, it appears that turbulent processes alone do not fully
describe the hierarchical cascade observed in NGC 2264. Hop-
kins (2013) modelled intermittency phenomena that can origi-
nate with shocks or sound waves. These intermittency phenom-
ena have the eﬀect of constraining the hierarchical cascade pro-
cess between several scales, which could explain the plateau for
scales > 13kAU seen in the hierarchical cascade in NGC 2264.
Consequently, it would be necessary to develop a multi-fractal
description of the cloud, where the hierarchical cascade is not
scale-free but scale-dependent.

Thomasson B.1 et al.: A graph theory-based multi-scale analysis of hierarchical cascade

4.3. Inﬂuence of star formation history

Regarding the stellar component of the hierarchical structures, it
appears that the production of YSOs slows down below a cer-
tain scale of < 6kAU. However, it is also possible that this is an
incompleteness eﬀect with respect to the star formation phenom-
ena that occurred in the past in NGC 2264. Indeed, we have only
taken into account the class 0/I YSOs, leaving aside the more
evolved class II YSOs. Knowing that the hierarchical structures
are mainly located in the central hubs, it is likely that the avail-
able gas reservoir replenishes throughout the ﬁlaments (conveyor
belt model, Longmore et al. 2014) which would allow the pro-
duction of YSOs for several star forming events. This hypothe-
sis would favour the cohabitation of class 0/I with class II YSOs
within the hierarchical structures. However, this scenario does
not seem to be able to fully explain this decrease in star produc-
tion because, taking into account the class II YSOs from Rapson
et al. (2014), the hierarchical structures would produce on aver-
age 2.26 ± 0.28 YSOs per graph-source (instead of 1.75 ± 0.24
with class 0/I only). Considering the Hoyle (1953) fragmentation
estimation (fractality F = 2), we expect to produce on average
nine YSOs per graph-source. Therefore, the fragmentation of the
clumps into YSOs seems to be inhibited, or is still in the process
of forming prestellar objects.

5. Conclusion

We designed a methodology based on connected network rep-
resentation to link clumps of diﬀerent scales and YSOs. This
linkage respects an inclusion principle in order to study a snap-
shot of the spatial properties of the hierarchical cascade. The
computed network is structured in diﬀerent levels, each one of
them being associated with a speciﬁc spatial scale. We designed
a geometric model to generate a population of extended objects
that subdivide according to a fractal law whose associated frac-
tal index takes into account the scaling ratios between the lev-
els. Using the Herschel ﬁve-band observation of resolution [8.4,
13.5, 18.2, 24.9, 36.3]" coupled with the class 0/I YSOs from the
Spitzer survey of NGC 2264, we applied our methodology and
extracted structures of three types: hierarchical, which we as-
sociate with a hierarchical fragmentation process; linear, which
we interpret as a monolithic fragmentation process; and a ﬁnal
isolated mode. Our analysis of the structures reveals various phe-
nomena. We observed that linear structures that incubate a YSO
exist, showing that monolithic collapse and hierarchical collapse
can coexist within the same cloud. In particular, the hierarchical
structures are the main incubators of YSOs in NGC 2264, and
have therefore been the main fuel for star formation. Finally, re-
gions with high column density are correlated with hierarchical
collapse while other regions are dominated by monolithic col-
lapse.

Our network analysis and comparison with our model show
that although we were able to measure an average fractality of
F = 1.45 ± 0.12 on the whole network, the hierarchical cascade
is incompatible with a purely fractal model when we analyse it
scale after scale. We also ﬁnd that no hierarchical cascade oc-
curs between 26 and 13 kAU, and that no obvious hierarchical
cascade seems to occur between 6 kAU and the YSO scale of
class 0/I at 1.4kAU, indicating that hierarchical cascade may oc-
cur mainly between 6 and 13 kAU in NGC 2264.

Our methodology provides a new approach to studying frag-
mentation processes within molecular clouds. We are planning
future work to deﬁne a metric to quantify how the subdivision
of our structures deviates from a scale-free, or fractal, process.

However, the fractality coeﬃcient we deﬁne can be reapplied
to analyse the subdivision of dendrograms (Rosolowsky et al.
2008) in order to study the hierarchy in column density instead
of hierarchy in scales as is done in the present paper. By study-
ing the hierarchy in density using dendrograms, it is possible to
investigate the cascade from a larger dynamic.

One of the goals of this work is to provide tools to study the
links between multi-scale structure of gas and the multiplicity of
YSOs/NESTs. However, the current study is limited by the scale
dynamics of the gas to which we have access, from 6 kAU to
26 kAU. In order to better investigate the link between multiple
systems (< 1 kAU), the UWPs of high-order multiplicity (<
10 kAU) (Joncour et al. 2017), and the small stellar groups
(NESTs, Joncour et al. 2018) together with the multi-scale
hierarchical cascade of the gas, we would need to investigate
scales smaller than 6 kAU. Indeed, at this stage we cannot
explain the high multiplicity observed in these stellar structures
which contain more than four YSOs each. In order to probe
scales smaller than 6 kAU in NGC 2264, more observations
need to be carried out using the NOrthern Extended Millimeter
Array (NOEMA, the updated Plateau de Bure Interferometer
Guilloteau et al. 1992), or the Atacama Large Millimeter Array
(ALMA, Wootten & Thompson 2009) facilities.

The application of clustering methods to our structures could
also help to elucidate the close relationship between the spatial
properties (separation, ﬁrst neighbours, etc.) of stellar systems
and their environment, which can be single clumps or clusters of
clumps. Do small stellar groups arise from a simple hierarchical
collapse of a clump, or are their spatial extent and multiplicity
more compatible with an association of clumps that would result
from the fragmentation of a ﬁlament, with each of these clumps
in turn collapsing hierarchically or monolithically? Most proba-
bly, both scenarios exist (Oﬀner et al. 2022): the UWPs and large
NESTs may result from the fragmentation of ﬁlaments (scale >
13 kAU), and the hierarchical fragmentation of clumps may pro-
ceed at smaller range, whereas disc fragmentation around YSOs
may explain the very close stellar systems (scale < 100 AU). Our
methodology is suitable for studying the spatial characteristics of
hierarchical fragmentation, but gives no indication of the tempo-
ral aspects. However, the same metrics can be used to describe
the temporal evolution of fragmentation in simulations.

Acknowledgements. The authors would like to deeply and sincerely thank A.
Men’shchikov for his mentorship regarding the learning process of handling
getsf software. We are also grateful to the ECOGAL project (European Re-
search Council synergy, Grant: 855130) and its members for all the discussion
and workshop opportunities we beneﬁt from.

References

Cantat-Gaudin, T., Jordi, C., Vallenari, A., et al. 2018, A&A, 618, A93
Cunningham, N., Lumsden, S., Cyganowski, C., Maud, L., & Purcell, C. 2016,

Monthly Notices of the Royal Astronomical Society, 458, stw359

Duchêne, G. & Kraus, A. 2013, Annual Review of Astronomy and Astrophysics,

51, 269

González, M., Joncour, I., Buckner, A. S. M., et al. 2021, A&A, 647, A14
Guilloteau, S., Delannoy, J., Downes, D., et al. 1992, A&A, 262, 624
Guszejnov, D., Hopkins, P. F., & Grudi´c, M. Y. 2018a, Monthly Notices of the

Royal Astronomical Society, 477, 5139

Guszejnov, D., Hopkins, P. F., Grudi´c, M. Y., Krumholz, M. R., & Federrath, C.

2018b, Monthly Notices of the Royal Astronomical Society, 480, 182

Hopkins, P. F. 2013, Monthly Notices of the Royal Astronomical Society, 430,

1653

Houlahan, P. & Scalo, J. 1992, The Astrophysical Journal, 393, 172
Hoyle, F. 1953, The Astrophysical Journal, 118, 513
Joncour, I., Duchêne, G., & Moraux, E. 2017, A&A, 599, A14

Article number, page 13 of 14

A&A proofs: manuscript no. 43275corr

Joncour, I., Duchêne, G., Moraux, E., & Motte, F. 2018, Astronomy and Astro-

physics, 620, A27

Krause, M. G. H., Oﬀner, S. S. R., Charbonnel, C., et al. 2020, Space Science

Reviews, 216, 64

Larson, R. B. 1978, Monthly Notices of the Royal Astronomical Society, 184,

69

Longmore, S. N., Kruijssen, J. M. D., Bastian, N., et al. 2014, in Protostars and
Planets VI, ed. H. Beuther, R. S. Klessen, C. P. Dullemond, & T. Henning,
291

Louvet, F., Motte, F., Hennebelle, P., et al. 2014, A&A, 570, A15
Men’shchikov, A. 2021, A&A, 649, A89
Motte, F., Bontemps, S., & Louvet, F. 2018, Annual Review of Astronomy and

Astrophysics, 56, 41

Motte, F., Zavagno, A., Bontemps, S., et al. 2010, Astronomy and Astrophysics,

518, L77

Nony, T., Robitaille, J.-F., Motte, F., et al. 2021, Astronomy & Astrophysics,

645, A94

Oﬀner, S. S. R., Moe, M., Kratter, K. M., et al. 2022, arXiv e-prints,

arXiv:2203.10066

Padoan, P. 1995, Monthly Notices of the Royal Astronomical Society, 277, 377
Pokhrel, R., Myers, P. C., Dunham, M. M., et al. 2018, The Astrophysical Jour-

nal, 853, 5

Rapson, V. A., Pipher, J. L., Gutermuth, R. A., et al. 2014, The Astrophysical

Journal, 794, 124

Rosolowsky, E. W., Pineda, J. E., Kauﬀmann, J., & Goodman, A. A. 2008, The

Astrophysical Journal, 679, 1338

Shu, F. H. 1977, The Astrophysical Journal, 214, 488
Venuti, L., Prisinzano, L., Sacco, G. G., et al. 2018, A&A, 609, A10
Vázquez-Semadeni, E., Palau, A., Ballesteros-Paredes, J., Gómez, G. C., &
Zamora-Avilés, M. 2019, Monthly Notices of the Royal Astronomical So-
ciety, 490, 3061

Wootten, A. & Thompson, A. R. 2009, Proceedings of the IEEE, 97, 1463

Article number, page 14 of 14

