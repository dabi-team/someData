2
2
0
2

n
u
J

7
1

]

A
G
.
h
p
-
o
r
t
s
a
[

1
v
7
7
8
8
0
.
6
0
2
2
:
v
i
X
r
a

MNRAS 000, 1–20 (2022)

Preprint 20 June 2022

Compiled using MNRAS LATEX style ﬁle v3.0

BUDDI-MaNGA I: A statistical sample of cleanly decomposed bulge and
disc spectra

Evelyn J. Johnston1★, Boris Häußler2, & Keerthana Jegatheesan1.
1 Núcleo de Astronomía, Facultad de Ingeniería y Ciencias, Universidad Diego Portales, Av. Ejército Libertador 441, Santiago, Chile
2 European Southern Observatory, Alonso de Cordova 3107, Vitacura, Santiago, Chile

20 June 2022

ABSTRACT
Many galaxies display clear bulges and discs, and understanding how these components form is a vital step towards understanding
how the galaxy has evolved into what we see today. The BUDDI-MaNGA project aims to study galaxy evolution and morpholog-
ical transformations through the star-formation histories of the bulges and discs. We have applied our buddi software to galaxies
from the MaNGA Survey in the SDSS DR15 in order to isolate their bulge and disc spectra, from which we derived their stellar
populations. To date, this work provides the largest sample of clean bulge and disc spectra extracted from IFU datacubes using
the galaxies light proﬁle information, and will form the basis for a series of papers aiming to answer open questions on how
galaxies have formed and evolved, and the role of their individual structures. This paper presents an introduction to the project,
including an overview of these ﬁts, a characterisation of the sample, and a series of tests on the ﬁts to ensure reliability.

Key words: galaxies: bulges – galaxies: disc – galaxies: fundamental parameters – galaxies: structure

1 INTRODUCTION

In the hierarchical model of galaxy evolution, galaxies have built up
their mass through mergers and accretion of other galaxies (e.g. Guo
& White 2008). Many galaxies display multiple components, such as
bulges and discs, and as the galaxy grows in mass, interactions and
star formation activity within the galaxy aﬀects these components
diﬀerently. Therefore, understanding how these structures assemble
their mass is a key element in understanding galaxy evolution in
general. Many galaxies are also known to consist of only one compo-
nent, such as a pure disc or a pure bulge (i.e. an elliptical galaxy), and
so investigating the transformation between one and two-component
systems (in both directions) will also help us explain the existence of
these systems.

Many studies of bulges and discs have been carried out via bulge–
disc decomposition techniques on photometric data, in which the
light proﬁle of each component is ﬁtted either in one or two dimen-
sions and used to create a best-ﬁtting model for each component.
From these models, the structural parameters, such as the size and lu-
minosity of each component, can be derived. In the last two decades,
this technique has been employed by many large photometric sur-
veys of galaxies, such as SDSS (e.g. Simard et al. 2011), GAMA
(e.g. Lange et al. 2016), CANDELS (e.g. Dimauro et al. 2018), and
CANDELS+HFF (Nedkova et al, in prep), in order to obtain statisti-
cally signiﬁcant results on their properties over a range of redshifts.
Applying this technique to multi-waveband data provides magnitudes
for the bulge and disc in each band. These colours can in turn be used
to derive their stellar populations through SED ﬁtting (e.g. Kennedy
et al. 2016).

★ Contact e-mail: evelyn.johnston@mail.udp.cl

© 2022 The Authors

However, deriving estimates of the ages and metallicities of stellar
populations from such broad-band colours alone can result in highly
degenerate stellar populations (Worthey et al. 1994), and can also
be aﬀected by dust reddening (Disney et al. 1989). The addition of
spectroscopic information is vital towards breaking this degeneracy
and measuring the star-formation histories across galaxies. In re-
cent years, several approaches have been used to cleanly separate
the light from diﬀerent components within galaxies observed with
long-slit spectroscopy, using either the diﬀerences in their light pro-
ﬁles (e.g. Sil’chenko et al. 2012; Johnston et al. 2012, 2014) or their
distinct kinematics (e.g. Coccato et al. 2011; Johnston et al. 2013;
Tabor et al. 2017). With the introduction of integral-ﬁeld spectro-
graphs with high spatial resolution and large ﬁelds of view, such as
the Multi-Unit Spectroscopic Explorer (MUSE, Bacon et al. 2010),
and surveys like the Calar Alto Legacy Integral Field spectroscopy
Area survey (CALIFA, Sánchez et al. 2012), the Sydney-AAO Multi-
object Integral-ﬁeld spectrograph survey (SAMI, Croom et al. 2012),
and the SDSS-IV Mapping Nearby Galaxies at Apache Point Obser-
vatory survey (MaNGA, Bundy et al. 2015), these spectroscopic
decomposition techniques can now be adapted to make the most
of the combined spatial and spectroscopic information that is now
available.

For example, several works have focussed on the diﬀerent kinemat-
ics of the bulges and discs to separate their spectra. Typically, one
expects the galaxy to consist of a spherical, dispersion-supported
bulge surrounded by a rotating disc, and so one can try to model
the kinematics of each component using this assumption to extract
the spectra of the kinematic bulge and disc. This idea has been
used successfully by Tabor et al. (2017) and Tabor et al. (2019)
for CALIFA and MaNGA galaxies, respectively. They used photo-
metric decomposition to determine the ratio of light from the bulge

 
 
 
 
 
 
2

E. J. Johnston et al

and disc throughout the galaxy, and used these light ratios as con-
straints when modelling the spectra with 2 kinematic components. A
similar approach has also been used to study the bulge and disc of
NGC 3521 by Coccato et al. (2018) and a large sample of galaxies
from the SAMI survey by Oh et al. (2020). And another study by Du
et al. (2020) applied this technique to galaxies in the TNG100 run
of IllustrisTNG to compare the properties of the morphological and
kinematic components present in disc galaxies.

Other approaches use the 2-dimensional light proﬁle of the galaxy
to separate the bulge and disc spectra. For example, Fraser-McKelvie
et al. (2018) used decomposition of SDSS photometric data to deter-
mine which spaxels lay in bulge- and disc-dominated regions within
MaNGA galaxies in order to minimize contamination from other
structures. They then concentrated their analysis on these areas to
derive the properties of the stellar populations of the disc and bulge
regions. A similar approach was used by Pak et al. (2021), while
Barsanti et al. (2021) combined this idea with two other approaches
(i.e. using photometric decomposition of the galaxy to determine the
mass and ﬂux fractions of the bulge and disc across the IFU ﬁeld
of view (FOV) in addition to simply identifying bulge- and disc-
dominated regions) for their spectroscopic decomposition of SAMI
galaxies.

The next natural step is to apply this bulge–disc decomposition
directly to the IFU data itself to make full use of the spatial and
spectroscopic information available in the datacubes. One approach
that uses this idea is Bulge–Disc Decomposition of IFU data (buddi,
Johnston et al. 2017), which uses galfitm (Häußler et al. 2013), a
modiﬁed form of galfit (Peng et al. 2002, 2010) that can model
the light proﬁle of multi-waveband images of a galaxy simultane-
ously. buddi uses information from the entire datacube to create a
wavelength-dependent model of each component within the galaxy,
from which the spectra of each component can be cleanly extracted.
It was developed and tested on prototype data from the MaNGA Sur-
vey in Johnston et al. (2017), and has since been successfully used to
separate the light from many diﬀerent components within galaxies,
such as bulges, discs and lenses of S0 galaxies (Johnston et al. 2021),
to extended stellar haloes around cD galaxies (Johnston et al. 2018),
and down to the nuclear star clusters in the cores of dwarf galaxies
(Johnston et al. 2020).

A similar technique to buddi is c2d, which was developed by
Méndez-Abreu et al. (2019a). In this case, the initial ﬁt to the galaxy
light proﬁle is carried out on complementary imaging data, as op-
posed to the white-light image of the galaxy itself as in the case of
buddi, but it uses the same general idea of modelling the galaxies
light proﬁle as a function of wavelength. c2d has been successfully
applied to galaxies in the CALIFA survey to study the properties of
ETGs (Méndez-Abreu et al. 2019b), and of bulges and discs over a
wide range of galaxy morphologies (Méndez-Abreu et al. 2021).

We are now entering an exciting time, where these diﬀerent IFU
decomposition techniques are transitioning from proof-of-concept
ideas to being used for science. While they have so far mainly been
applied to small samples of galaxies, where each galaxy could be
modelled carefully by the user, the ﬁeld is now moving towards au-
tomated ﬁts to large data sets to carry out statistical studies of the
spectroscopic stellar populations of galaxy components. To this end,
this work presents the BUDDI-MaNGA project, in which we apply
buddi to all suitable galaxies included in the recent MaNGA data
release 15 (hereafter DR15, Aguado et al. 2019). We identify the
‘good’ ﬁts to the data (see Section 4.2), and extract clean bulge and
disc spectra for these galaxies and estimates their stellar populations
and star-formation histories. This work will produce the largest sam-
ple of clean bulge and disc spectra to date, allowing statistical studies

MNRAS 000, 1–20 (2022)

of the stellar populations of each component for the ﬁrst time, and will
be expanded in the future with SDSS Data Release 17 (Abdurro’uf
et al. 2022).

This paper is the ﬁrst in the series, and provides an overview of the
project, while Johnston et al (submitted) presents the ﬁrst scientiﬁc
analysis of the S0 galaxies in the sample. Future works will further
explore galaxy formation, evolution, and morphological transforma-
tions through the eﬀects on the diﬀerent components within the
galaxies.

This paper is laid out as follows: Section 2 outlines the data and
catalogs used, Section 3 gives an overview of buddi and details
of the ﬁts that are speciﬁc to the MaNGA data. Section 4 presents
the results for the structural parameters derived using buddi and the
criteria used to determine which ﬁts are considered to be good enough
for further analysis, and the stellar populations analysis is given in
Section 5. We then present a comparison of the stellar populations
estimates when the ﬁts are repeated using the structural parameters
derived from ﬁts to photometric data instead in Section 6, and ﬁnally
we present our conclusions in Section 7.

2 DATA

The data used in this paper came from the SDSS DR15 of the MaNGA
Survey. It should be noted that the MaNGA data products included
as part of data release 16 (DR16, Ahumada et al. 2020) are identical
to those in DR15, and this data counts as the third data release for
MaNGA. Data from the full survey became public in SDSS DR17,
and will be used for future works within the scope of the BUDDI-
MaNGA project.

MaNGA is an integral ﬁeld spectroscopic survey using the BOSS
spectrograph (Smee et al. 2013) on the 2.5 m SDSS telescope (Gunn
et al. 2006) at the Apache Point Observatory, and is part of the Sloan
Digital Sky Survey-IV (SDSS-IV, Blanton et al. 2017). By the end of
the survey in 2020, MaNGA observed ∼ 10, 000 galaxies, of which
4824 have been released publicly as part of DR15. The galaxies were
selected to cover a wide range in mass and morphology, with redshifts
in the range 0.01 < 𝑧 < 0.15 (Yan et al. 2016). The observations for
each galaxy provide spatial coverage out to ∼ 1.5𝑅𝑒 for ∼ 66 per cent
of the total sample, and out to ∼ 2.5𝑅𝑒 for the remaining galaxies.
This coverage is achieved using a series of hexagonal IFUs of diﬀerent
sizes, from the 19-ﬁbre IFUs which have a 12(cid:48)(cid:48) diameter up to the
127-ﬁbre IFUs with a diameter of 32(cid:48)(cid:48) (Drory et al. 2015). The ﬁnal
data has a continuous wavelength coverage between 3600 to 10300 Å,
with a spectral resolution of 𝑅 ∼ 1400 at 4000 Å to 𝑅 ∼ 2600 at
9000 Å (Drory et al. 2015).

The decomposition technique used in this paper is the buddi code
(Johnston et al. 2017), which was originally developed and tested on
commissioning data observed as part of the MaNGA survey. As part
of these tests, a series of simulated datacubes were created based
on the MaNGA datacubes for galaxies observed with the 127, 91
and 61-ﬁbre IFUs, and these datacubes were modelled with buddi
to compare the extracted parameters with those used to create the
models. We found that buddi was able to successfully extract the
physical parameters and line strengths for 2 component ﬁts in the 127
and 91-ﬁbre IFUs, while the scatter in the results increased in the
smaller IFUs due to the small number of resolution elements, critical
to a successful decomposition. In particular, the ﬁts to the 61-ﬁbre
IFUs were found to result in overestimates for the bulge Sérsic index
and 𝑅𝑒 in about half the simulated datacubes, and underestimates
for the line strengths measured from the extracted disc spectra. This
eﬀect on the line strengths is likely due to the overmodeling of the

Table 1. Overview of the galaxy sample modelled with the single Sérsic (SS)
and Sérsic+exponential (SE) models

Number of galaxies (DR15)
Number of candidate galaxies (IFU only)
Number of candidate galaxies (MPP-VAC)
Number of failed/crashed ﬁts
Number of bad ﬁts
Number of successful ﬁts

SS

4,824
1,926
1,719
402
279
1,038

SE

4,824
1,926
1,705
405
609
691

The number of candidate galaxies (IFU only) refers only to the number
of galaxies observed with the 91 and 127-ﬁbre IFUs, while the MPP-VAC
candidate galaxies give the numbers of galaxies that have been ﬂagged as
having successful ﬁts in the MPP-VAC for each model. The failed and bad
ﬁts refer to those that were attempted using the MPP-VAC parameters as
initial estimates, but in which Galfitm crashed during the ﬁtting process
(i.e. the ﬁt failed to converge) or where the ﬁts completed but the ﬁt
parameters were deemed unphysical and fell outside of the conditions set
for good ﬁts in Section 4.2, respectively.

bulges due to the eﬀect on the Sérsic indices and sizes, resulting
in poor ﬁts to the discs and low S/N for their spectra. As a result,
the data sample selected for this study was restricted to only those
galaxies observed with the 91 and 127-ﬁbre IFUs. This limitation
consequently resulted in a total sample of 1,926 candidate galaxies
in SDSS DR15, which we used as our starting sample. The breakdown
of the numbers of galaxies used in the ﬁts is given in Table 1.

In addition to the MaNGA datacubes, several Value Added Cata-
logs from the DR15 were used in this project, namely the MaNGA
PyMorph DR15 Photometric Value Added Catalog (MPP-VAC; Fis-
cher et al. 2019) and the MaNGA Deep Learning Morphology Value
Added Catalogue (MDLM-VAC, Domínguez Sánchez et al. 2018).
These catalogs will be described in more detail later in the paper.

3 MODELLING THE GALAXIES WITH BUDDI

Each galaxy datacube was modelled with buddi using both a single
Sérsic (SS) model and a Sérsic+exponential (SE) model, where the
latter may be interpreted as a ﬁt to the bulge and disc respectively.
buddi uses galfitm (Häußler et al. 2013), a modiﬁed form of galfit
(Peng et al. 2002, 2010), to model the light proﬁle of multi-waveband
images of a galaxy simultaneously. The beneﬁt of using galfitm
over galfit is that the variations in the structural parameters of
each component with wavelength can be modelled using user-deﬁned
Chebychev polynomials. As a result, the ﬁt to each image slice uses
information from the entire datacube, thus boosting the S/N over
that of any individual image and allowing reasonable estimates to
be derived for the structural parameters at wavelengths where the
image slices have lower S/N. This technique is especially powerful in
separating diﬀerent components of diﬀerent colours (Häußler et al.
2022), ideal to separate the spectra of bulge and disc. While we
encourage readers to be familiar with buddi, where a full description
can be found in Johnston et al. (2017), a brief overview and workﬂow
are presented below, and visualized in Fig. 1.

3.1 Preparation: Create the mask and PSF proﬁle

The ﬁrst step towards carrying out the ﬁts with buddi is to prepare
the data, including the corresponding Point Spread Function (PSF),
bad pixel mask and uncertainty, or sigma, datacubes.

BUDDI-MaNGA I

3

3.1.1 Bad-pixel mask

Since the MaNGA IFUs have hexagonal FOVs, the rectangular dat-
acubes contain many pixels with 0 values ﬁlling in the space outside
the MaNGA ﬁeld. If left unmasked, galfitm will assume that these
pixels are valid and represent the sky level, which will aﬀect the ﬁt
due to the sharp cut oﬀ where the galaxies extend out of the MaNGA
FOV. Consequently, the ﬁrst step was to create a bad pixel datacube
to mask out these spaxels, which was extracted from the mask exten-
sion within each MaNGA datacube. This extension gives details on
the quality of each spaxel in the datacube, including information on
the eﬀects of the IFU footprint and missing data, and thus identiﬁes
which spaxels should be used or ignored as a function of wavelength
in the analysis. Consequently the mask varies as a function of wave-
length, and so the next steps carried out with buddi applied the same
binning steps to the mask datacube that were used for the science
datacube to ensure the correct spaxels were masked out in all steps
of the ﬁt.

In the current version of the data, no further steps were taken to
mask out other objects within the FOV, such as foreground stars or
background/neighbouring galaxies, which may ultimately aﬀect the
ﬁnal ﬁts. However, this step is to be included in the next round of ﬁts
using the data released as part of DR17.

3.1.2 PSF model

Another part of the preparation was to create a model PSF datacube
for each galaxy, which will be convolved with the ﬁt to all images in
the datacube to improve the ﬁt. Yan et al. (2016) describes how the
IFU ﬁbre bundles used by the MaNGA survey cannot alone provide
an accurate PSF shape since some ﬂux is lost in each exposure to the
gaps between the ﬁbres, resulting in it being spatially undersampled.
While a three point dither pattern was used for all observations to
provide full spatial coverage and to create a more uniform circular
PSF (Law et al. 2015), additional steps were taken to identify the
shape of the PSF in order to reﬁne the scale of the PSF observed with
the ﬁbre bundles.

To reﬁne the shape of the PSF, the images of the guide stars were
used. For each 15 minute exposure, a series of guider images were
stored, and the integrated PSF was created by bias subtracting and
ﬂat ﬁelding these images before stacking them. The resulting image
is the time-integrated PSF, and includes any smearing introduced
by imperfect guiding. The typical FWHM of this stacked PSF im-
age is ∼ 1.5(cid:48)(cid:48). The MaNGA data reduction pipeline then modeled
the focal-plane PSF observed by the ﬁbre bundles with a double
Gaussian proﬁle, and used this proﬁle to reﬁne the shape of the PSF
created from the guider images. The result is the reconstructed PSF,
which is included in the datacubes for the 𝑔𝑟𝑖𝑧-bands. According to
Law et al. (2016), the MaNGA reconstructed PSF is nearly constant
with wavelength, and the spatial covariance matrix also varies only
slowly with wavelength. Therefore, the 𝑔𝑟𝑖𝑧-band reconstructed PSF
images describe the covariance in the data cubes by providing sparse
correlation matrices in the 𝑔𝑟𝑖𝑧-bands, from which the PSF image at
any wavelength can be created by interpolation.

In this work, the PSF datacubes were thus created by interpolating
between the reconstructed PSF images in the 𝑔𝑟𝑖𝑧-bands, using the
ﬁlter transmission curves to determine the relative ﬂux of each PSF
image at each wavelength.

MNRAS 000, 1–20 (2022)

4

E. J. Johnston et al

Figure 1. An overview of the steps to decompose a MaNGA datacube with BUDDI. The free parameters are the integrated magnitude (𝑚𝑎𝑔), eﬀective radius
(𝑅𝑒), Sérsic index (𝑛; in the SE ﬁts, 𝑛𝑆 and 𝑛𝑒𝑥 𝑝 refer to the Sérsic indices of the Sérsic and exponential component respectively), position angle (𝑃 𝐴), axes
ratio (𝑞) and residual sky value (𝑅𝑆). SS and SE refer to the single Sérsic and Sérsic+exponential ﬁts, respectively, and the colours of each parameter identify
how it varies with wavelength - dark blue means it’s completely free with wavelength, purple is allowed to vary according to a linear polynomial, light blue can
be diﬀerent for diﬀerent components, but remains constant with wavelength, and red is held ﬁxed according to the best ﬁt polynomial from the previous step.

3.1.3 Sigma datacube

To further improve the ﬁt, a sigma datacube was created from the
inverse variance (IVAR) datacube included in the extension of the
𝐼𝑉 𝐴𝑅. This datacube can be
MaNGA datacube using 𝑠𝑖𝑔𝑚𝑎 = 1/
handed over to GalfitM as part of the ﬁt, and allows more accurate
estimation of the ﬂux uncertainty in each pixel than an internal
estimation by GalfitM from header keywords.

√

Finally, the target and sigma datacubes were converted from ﬂux
units of erg/s/cm2/Å into Janskys. This conversion results in the
spectra having a constant magnitude zeropoint of 8.9 over the entire
wavelength range, which is one of the input parameters for GalfitM,
and allows greater ﬂexibility when using buddi for data from diﬀerent
IFU spectrographs. Note that this conversion is reversed at the end
of the process (See Section 3.5).

3.2 Step 1: Obliterate the kinematics

The ﬁrst step that buddi carried out was to measure and obliter-
ate the kinematics across the galaxy, thus ensuring that the image
of the galaxy at each wavelength is at the same rest-frame wave-
length and giving a symmetric light proﬁle. This step is important
because buddi uses GalfitM to model symmetric light proﬁles for
each galaxy in this study. The kinematics of the galaxy would result

MNRAS 000, 1–20 (2022)

in asymmetric images of the galaxy in the uncorrected datacube at
wavelengths around strong spectral features due to the red and blue
shifts of those features along the major axis of the galaxy. Addition-
ally, the decrease in velocity dispersion with radius would contribute
to further asymmetries in the light proﬁles of individual image slices,
where the light in the inner parts of the galaxy may reﬂect the wings
of a spectral feature while in the outskirts it comes from the stellar
continuum. Fitting an uncorrected datacube of a galaxy with buddi
results in spectral features similar to P Cygni proﬁles in the ﬁnal
spectra of each component, and so these corrections are necessary
for the quality of the ﬁnal spectra.

In order to carry out these corrections, the datacubes were ﬁrst
binned using the Voronoi tessellation technique of Cappellari &
Copin (2003), and the kinematics of the binned spectra were mea-
sured with the penalised Pixel Fitting software (ppxf) of Cappellari &
Emsellem (2004). This latter step was carried out using the template
spectra of Vazdekis et al. (2010), which are based on the MILES
stellar library of Sánchez-Blázquez et al. (2006). They consist of 156
template spectra ranging in metallicity from −1.71 to +0.22, and in
age from 1 to 17.78 Gyrs. Having measured the kinematics across the
galaxy, the spectra in each spaxel within the datacube were shifted
to correct for the line-of-sight velocity, and broadened to match the
maximum velocity dispersion measured within the galaxy. To re-
move erroneous measurements due to the background noise, a limit

BindatatomeasurekinematicsObliteratekinematicsFitsingle“broad-bandimage”(SS:mag,Re,n,PA,q,RSfree)(SE:mag,Re,nS,PA,q,RSfree;nexp=1)Fit“narrow-bandimages”(SS:mag,RSfree;Re,n,linear;PA,qconstant)(SE:mag,RSfree;Re,nS,PA,qconstant;nexp=1)Fitimageslices(SS:mag,RSfree;Re,n,PA,qﬁxedbypolynomial)(SE:mag,RSfree;Re,nS,PA,qﬁxedbypolynomial;nexp=1)Constructbulgeanddiscspectraanddatacubesof S/N = 3 per pixel at ∼ 6000Å was implemented to only include
those spaxels that were not dominated by noise.

3.3 Step 2: Fit the white-light image

Having obliterated the kinematics across the datacube, the light-
proﬁle ﬁtting can start. The ﬁrst step is to create the white-light image
of the galaxy, and ﬁt it using the SS and SE models, respectively. This
step provides a quick way to determine the best initial parameters and
number of components for the ﬁts using an image with the maximum
S/N. While this procedure is mainly useful for manual ﬁtting of small
samples of galaxies, it is still useful for the automated ﬁts carried
out in this work as it helps to reﬁne the initial estimates for the ﬁt
parameters (integrated magnitude, 𝑚𝑡𝑜𝑡 ; eﬀective radius, 𝑅𝑒; Sérsic
index, 𝑛; axis ratio, 𝑞; and position angle, 𝑃 𝐴) before introducing
the wavelength information. The initial parameters for these two
ﬁts were taken from the MPP-VAC, in which the 𝑔, 𝑟 and 𝑖-band
images of the galaxies included in the DR15 MaNGA sample from
the NASA-Sloan Atlas catalog (hereafter NSA, Blanton et al. 2011)
were modelled with the PyMorph code (Vikram et al. 2010), which
also uses Galfit, albeit single-band. The MPP-VAC carried out these
ﬁts for both SS and SE models. Therefore, for each galaxy, the 𝑟-
band parameters from the MPP-VAC for the corresponding model
(SS or SE) were used as initial parameters for the ﬁts with buddi
since this band falls closest to the centre of the MaNGA spectra
wavelength range. Additionally, the eﬀective radius measurements
from the MPP-VAC were corrected for the pixel scale of the MaNGA
datacubes, and the position angle from the MPP-VAC was corrected
to agree with how Galfit measures the angle.

The MPP-VAC includes ﬂags to identify failed ﬁts within the
sample for either the SS or SE models, which usually occurred for
galaxies with irregular morphologies, in the process of merging or
where multiple galaxies are superimposed within the FOV. Conse-
quently, only those galaxies marked as having a successful ﬁt in the
MPP-VAC were modelled with buddi. This additional constraint re-
duced the total number of candidate galaxies that could be ﬁtted to
1,710 for the SS model, and 1,705 for the SE model (listed as Number
of candidate galaxies (MPP-VAC) in Table 1). The ﬁts with each of
these two models were carried out independently, resulting in some
galaxies that were modelled successfully with one model but not the
other.

3.4 Step 3: Fit the narrow-band images

Having carried out the ﬁt to the white light image, the next step is
to introduce variations due to wavelength. If the ﬁt to the white-light
image was successful (i.e. GalfitM converged on a solution and
didn’t crash), the datacube was rebinned into a series of 10 narrow-
band images along the wavelength direction, where these images
have higher S/N than any individual image slice within the datacube.
While the user can deﬁne the number of narrow band images, we
decided to use 10 since it gave a good compromise between the
speed of the ﬁts (more images means more free parameters and
slower ﬁts) and a good coverage of the wavelength range. The initial
estimates for the ﬁt parameters for these images were taken as the ﬁt
parameters from the ﬁts to the white light images in the previous step.
In each case (SS and SE), the ﬁrst ﬁt to these narrow band images
was allowed complete freedom in the ﬁt parameters, simulating the
results obtained by running Galfit on each image independently.
This step gives a good idea of how the structural parameters vary
as a function of wavelength. In manual ﬁts for small samples of

BUDDI-MaNGA I

5

galaxies, these results would be useful for determining the correct
Chebychev polynomials for each parameter to reﬂect the general
variation as a function of wavelength. In these automated ﬁts however,
the Chebychev polynomials are predeﬁned. But it was still decided
to run these free ﬁts since they may be useful for identifying galaxies
that are not so well modelled with these set polynomials for a future
follow-up study.

Having completed the free ﬁts, the ﬁts were then repeated using
Chebychev polynomials to constrain the parameters for eﬀective ra-
dius (𝑅𝑒), Sérsic index (𝑛), axis ratio (𝑞) and position angle (𝑃 𝐴)
as a function of wavelength while leaving the integrated magnitude
(𝑚𝑡𝑜𝑡 ) free. In the SS ﬁts, a polynomial of order 2 was selected for
the 𝑅𝑒 and 𝑛 and an order of 1 used for the 𝑃 𝐴 and 𝑞, following
the approach of Vulcani et al. (2014), while in the SE ﬁts, poly-
nomials of order 1 (constant with wavelength) were used for these
parameters. In both cases, the integrated magnitude was allowed full
freedom. This additional degree of freedom in the sizes and Sérsic
indices for the SS ﬁts eﬀectively mimics colour gradients across the
galaxy and allows for a better single component ﬁt in the case of
2-component galaxies which would be more bulge dominated in the
inner regions and more disc dominated in the outskirts. In such cases,
the galaxy would appear larger and with a lower Sérsic index at bluer
wavelengths, and more compact and potentially with a higher Sérsic
index at redder wavelengths. Thus, allowing these variations with
wavelength enables GalﬁtM to derive a more accurate ﬁt to the light
proﬁle of the galaxy as a whole.

3.5 Step 4: Fit the image slices and extract the decomposed

spectra

Once the structural parameters have been determined in the narrow
band images, it is now possible to determine the magnitude/ﬂux at
each wavelength, which ultimately will be used to derive the spectra
for each component. This step was carried out by ﬁtting the unbinned
image slices from the kinematics-obliterated datacube. In order to re-
duce the computing time and to avoid memory issues, each datacube
was split up into batches of 10 consecutive image slices, which were
modelled by GalfitM simultaneously. In these ﬁts, the structural
parameters (𝑅𝑒, 𝑛, 𝑃 𝐴, and 𝑞) were held ﬁxed for each image slice,
using the values that were determined in the previous step, while the
integrated magnitude was left completely free. The initial estimates
for the magnitudes for each image slice were determined by interpo-
lation at the corresponding wavelength between the ﬁts to the binned
images. It should be noted at this point that no special treatment was
applied for galaxies containing emission lines. Since the parameters
were held ﬁxed according to the polynomials used, any emission
lines that displayed a similar light proﬁle to one of the components
was included in the ﬁt, and thus the spectrum, for that component.
If however the emission lines followed a diﬀerent distribution, Gal-
fitM would still model the underlying galaxy and the emission line
features would appear in the residual images and datacube. Tests were
carried out comparing the stellar populations derived from the Sér-
sic and exponential component spectra with those from the original
datacube in galaxies that contain emission lines, and no signiﬁcant
diﬀerence in the ﬁnal results was seen. However, this topic will be
explored in greater detail when we repeat the ﬁts to the DR17 dataset.
Once the ﬁts to these image slices were completed, the spectra for
each component were created in 2 ways. First, as one-dimensional
integrated spectra for the galaxy component as a whole, produced
by plotting the integrated ﬂux (derived from the magnitude from
GalfitM) of that component as a function of wavelength, and second
as model datacubes, created using the best-ﬁt model images of each

MNRAS 000, 1–20 (2022)

6

E. J. Johnston et al

Figure 2. Top row: the MaNGA white-light image of 8445-12702, the best ﬁt model for the SE ﬁt, and the residual image. Middle row: the model images for
the exponential and Sérsic components, including information on the 𝑅𝑒 and 𝑛 from the ﬁts, and the SDSS 𝑔𝑟 𝑖-band image, downloaded using the Marvin
Python client (Cherinka et al. 2019). All images from the MaNGA data have been scaled to the same ﬂux range for easier comparison. Bottom row: The
normalized integrated ﬂux of the galaxy (black) from the MaNGA datacube, with the spectra extracted for the exponential and Sérsic components in blue and red,
respectively. The dark and light grey lines represent the residuals from faint asymmetric features and background objects and the sky background, respectively.
The feature in the sky spectrum at 5577Å is the [OI] sky line. The purple line represents the combined exponential+Sérsic+sky spectrum, superimposed upon
the integrated spectrum of the galaxy. On the right is a zoom-in of the normalised exponential and Sérsic spectra over the spectral region marked by the grey
band on the left plot, showing the diﬀerences in the line strengths of the H𝛽 feature between the discs and the bulge.

component at each wavelength from GalfitM. In both, the ﬂuxes of
these spectra were converted from Janskys back into the original ﬂux
units. An example of the ﬁt to galaxy 8445-12702 and the spectra
extracted for the Sérsic and exponential components are shown in
Fig. 2, along with a zoom in on the H𝛽 feature to show the diﬀerences
in the ﬁnal spectra. The images created from the MaNGA data have
all been scaled to the same ﬂux levels for easier comparison, and the

residual image reveals faint spiral arms within the disc of this galaxy
that cannot be seen in the original MaNGA datacube or the SDSS
𝑔𝑟𝑖-band image.

The results presented and discussed in the rest of this paper use
the one-dimensional integrated spectra. Due to the polynomials used
in the ﬁts to the image slices, the decomposed datacubes show the
same spectrum, and thus stellar populations, in every spaxel. There-

MNRAS 000, 1–20 (2022)

10"Original: 8445-12702ModelResidualsExponentialRe=12.3"n=1.0SersicRe=1.9"n=2.3240004500500055006000650070007500800085009000Wavelength (Å)0.00.20.40.60.81.01.21.41.6Relative FluxHMgbNaDHCaII TripletGalaxyBest FitResidualsSkyExponentialSersic49005000Wavelength (Å)0.850.900.951.001.05Normalized Fluxfore, while these datacubes do not show any variations across the
bulge or disc components, they can still be useful for comparing
the bulge and disc luminosity fractions across the galaxy and thus
better understanding the stellar population gradients seen within a
galaxy (e.g. see Figures 14, 15 and 16 of Johnston et al. 2017, and
Figure 7 of Johnston et al. 2018). Additionally, they can be used to
create a residual datacube that is free from the light of the galaxy,
which can be useful for studying faint background or neighbouring
sources whose light would otherwise be contaminated by the light of
the main galaxy (e.g. see Solimano et al, submitted).

4 OVERVIEW OF THE FITS

As described in Section 2, 1926 candidate galaxies were identiﬁed
from the total sample included in the DR15 by selecting only those
observed with the 91 and 127-ﬁbre IFUs. However, not all of these
galaxies had successful ﬁts, and consequently ﬁt parameters, in the
MPP-VAC. By including only those galaxies with successful ﬁts in
the MPP-VAC, the sample was reduced to 1719 and 1705 for the
SS and SE ﬁts, respectively. Of these galaxies, good ﬁts with buddi
were achieved for 1038 (SS) and 691 (SE) galaxies, corresponding
to a success rate of ∼ 70% and 53%, respectively. The remaining
galaxies fell into two categories- those in which the ﬁt with GalfitM
crashed and/or failed to converge (see Section 4.1), and those that
were considered poor ﬁts due to unphysical structural parameters
(see Section 4.2). An overview of these numbers is given in Table 1.
In this section, we will explore the properties of the ﬁts, the criteria

used to identify a good ﬁt, and the reasons for some ﬁts failing.

4.1 Common reasons for failed/crashed ﬁts

In around 23% of the model ﬁts by GalfitM to the candidate galaxies
(i.e. those with successful ﬁts in the MPP-VAC), the ﬁts crashed or
failed to converge, either when modelling the white-light image, the
narrow band images, or the image slices (see Sections 3.3, 3.4 and
3.5, respectively). There are several reasons for these ﬁts to fail,
which are discussed below.

One reason for many of the failed ﬁts is due to the small FOV
of the MaNGA images compared to the SDSS imaging data used
for the ﬁts in the MPP-VAC. Since the MaNGA galaxies are only
observed out to 1.5 or 2.5 𝑅𝑒, limited information is available for the
outskirts of the galaxies. This issue becomes particularly problematic
for more face-on galaxies, where the MaNGA FOV has few or no
pixels representing the light from the outskirts of the galaxy or purely
the sky background. As a result, in these cases, the ﬁt fails due to
insuﬃcient information being available.

Another issue is that foreground and background objects that fall
within the MaNGA FOV are not masked out in the ﬁts with buddi-
the masks created only represent the spaxels within the datacube that
contain no light from the IFU ﬁbres. Any bright, unmasked objects
in the ﬁeld can aﬀect the ﬁts by distorting the shape of the model
created by GalfitM. While this issue is limited by the small FOV of
the MaNGA datacubes, the eﬀect is not negligible. In a future version
of the ﬁts to the full MaNGA sample, the masking algorithm will be
improved to identify such contaminating sources and to mask them
out.

While the MPP-VAC gives a ﬂag for successful ﬁts, which were
used as initial estimates for the ﬁts by buddi, in some cases the ﬁt
parameters given in the MPP-VAC were unphysical. For example, a
small number of galaxies showed axes ratios for one component as
being < 0.1, or having very small eﬀective radii (e.g. less than half a

BUDDI-MaNGA I

7

pixel width in the SDSS imaging data). Consequently, in some cases,
using these unphysical parameters as initial estimates for the ﬁts with
buddi resulted in some of the ﬁts failing.

Finally, another reason for some ﬁts failing is due to the models
either containing too many/few components. For example, attempting
to ﬁt a galaxy with a complex morphology, such as with a bulge,
disc, bar and spiral arms, with the SS or SE models may result in
a poor ﬁt due to the complexity of the galaxy. A similar but related
issue is caused where one component is particularly faint at speciﬁc
wavelengths. For example, in some galaxies it was found that the
bulge was very bright at redder wavelengths but very faint in the blue
end of the spectrum. As a result, the ﬁts to the image slices failed
at bluer wavelengths since the bulge was too faint to be reliably
detected, but were successful at redder wavelengths where the bulge
was brighter.

While the reasons outlined above account for the common issues
that led to the majority of the crashed ﬁts, they do not represent an
exhaustive list of all the possible reasons that caused the ﬁts to fail.

4.2 Classiﬁcation of a good ﬁt

Of the ﬁts that completed successfully and provided spectra for each
component included in the models, a further selection was applied
to distinguish between good (i.e. reliable) and bad (unreliable) ﬁts.
This selection criteria was based on the feasibility of the ﬁnal struc-
tural parameters of the ﬁt, where those that converged on unphysical
parameters were considered bad ﬁts, and were applied to the ﬁts to
the narrow-band images. The following criteria were used to identify
good ﬁts:

(i) Δ𝑚𝑎𝑔𝑟 (cid:54) 2.5 (SE models only)
(ii) 0.25 (cid:54) 𝑅𝑒 (cid:54) 50(cid:48)(cid:48),
(iii) 0.205 (cid:54) 𝑛 (cid:54) 7.95,
(iv) 0.1 (cid:54) 𝑞 (cid:54) 1.0.

In the SE models, if only one component was found to fall outside
of these parameters, the ﬁt to the whole galaxy was considered bad.
The limit on the magnitude diﬀerence in the SE ﬁts was selected
since it represents a case where the minimum light fraction of both
components is 10%. A visual inspection of the ﬁts showed that in
many cases where Δ𝑚𝑎𝑔𝑟 > 2.5, the galaxy was well modelled
with a single Sérsic proﬁle. Thus, in these cases, the SE ﬁts ‘failed’
because the galaxies are single component systems, i.e. they do not
contain a distinct bulge and disc.

The lower limit for the 𝑅𝑒 corresponds to half a spaxel in the
MaNGA datacube (∼ 10% of the PSF FWHM), which was consid-
ered the minimum reasonable size that could be determined with
galfitm. Häußler et al. (2013) and Häußler et al. (2022) have shown
that, if the PSF is well known, recovering a object size well below
1 pixel is feasible without systematic bias (down to 0.3 pixels for
one-component ﬁts in Häußler et al. 2013 and 0.5 pixels for two-
component ﬁts in Häußler et al. 2022). From ﬁts to single band
images, Gadotti (2008) recommended a lower limit of 𝑅𝑒 of 0.8
times the half width at half maximum (HWHM) of the seeing PSF
(i.e. 0.6(cid:48)(cid:48) in this work). We therefore looked at the eﬀect on the ﬁnal
sample using diﬀerent lower limits to the 𝑅𝑒, ﬁnding no cases with
𝑅𝑒 < 0.6(cid:48)(cid:48) for the SS models, and only 1 exponential and 8 Sérsic
components with 𝑅𝑒 < 0.6(cid:48)(cid:48) for the SE ﬁts (with the majority of these
still having radii of greater than 0.5(cid:48)(cid:48)). Since so few galaxies are af-
fected by increasing the lower limit, we decided to use the lower limit
for 𝑅𝑒 based on the multi-band ﬁts of Häußler et al. (2013, 2022).
The upper limit in 𝑅𝑒 is larger than the FOV of all MaNGA IFUs,
and was selected to try to maximise the sample of good ﬁts while

MNRAS 000, 1–20 (2022)

8

E. J. Johnston et al

eliminating any obviously unreliable ﬁts. In Johnston et al. (2017),
It was found that for more edge on galaxies observed with MaNGA,
galfitm can overestimate the eﬀective radius, sometimes to a value
outside of the radius of the FOV, since only the inner regions and the
minor axis of the galaxy falls within the FOV. However, despite this
issue, the residual images show a very good ﬁt to the galaxy within
the FOV, and so the spectra extracted for both components were con-
sidered reliable. However, in these cases in particular, it should be
noted that the resulting spectra will only represent the inner regions
of the galaxy within the FOV available.

The ﬁts were carried out using a range of Sérsic indices of between
0.2 and 8, which are the typical upper and lower limits generally
imposed upon similar ﬁts in the literature. In order to avoid using
any models that hit these hard limits and thus failed to converge,
we followed Häußler et al. (2022) to use the range 0.205 (cid:54) 𝑛 (cid:54)
7.95. This limitation had the largest eﬀect on the number of galaxies
considered to have a ‘good’ ﬁt, and in the next version of the ﬁts to
the DR17 data we plan to revisit the ﬁts that hit these limits to try to
improve the models using diﬀerent starting parameters or a narrower
range for the Sérsic index.

The lower limit on the axes ratio rules out poor ﬁts due to unmasked
foreground stars within the FOV that galfitm attempted to include in
the ﬁt. This limit are in alignment with the sample selection carried
out in Häußler et al. (2013) and other works using GalfitM.

∼ 7% and ∼ 23% of the ﬁts to candidate galaxies resulted in bad
ﬁts based on the criteria above for the SS and SE models, respec-
tively. It was found that in general, the ﬁts that resulted in unphysical
parameters were either nearly face-on galaxies, where it was diﬃcult
for galfitm to reliably model the sky background or the outskirts
of the galaxy, or those that showed other objects within the MaNGA
FOV, such as foreground stars, neighbouring/background galaxies,
bright spiral arms or star-forming regions. While some of these cases
resulted in the ﬁts crashing (see above), others led to distorted models
for the galaxy and unphysical structural parameters.

The presence of bars should also be taken into account when
considering the ﬁts as this component may aﬀect the ﬁt to the bulge,
thus aﬀecting the structural parameters and the derived spectra. While
a full analysis of the eﬀect of bars on the ﬁts is beyond the scope of
this paper, we can however look at the expected fraction of bars in the
sample of galaxies. The MDLM-VAC gives the probability for each
galaxy containing a signature of a bar from Galaxy Zoo 2 (Willett
et al. 2013) and Nair & Abraham (2010), which uses data from the
SDSS DR4 (Stoughton et al. 2002). By adopting a limit of 0.5 for the
presence of a bar, we ﬁnd that 112 and 126 galaxies successfully ﬁtted
with the SE model have a clear bar signature according to Galaxy
Zoo 2 and Nair & Abraham (2010), respectively. Of these galaxies,
72 galaxies are in common between the two catalogs, accounting for
∼ 10 percent of the SE sample of galaxies with successful ﬁts. Thus,
the majority of the galaxies modelled with the SE model in this work
can be considered unbarred.

A summary of the number of candidate galaxies versus the number
of galaxies that were modelled successfully with buddi is given in
Table 1. Throughout the rest of this paper, the discussion will focus on
the successful ﬁts using the criteria above, unless speciﬁed otherwise.
It should be noted at this point that the classiﬁcation of successful
ﬁts does not take into account the S/N of the extracted spectra, and
future works using the BUDDI-MaNGA data may choose to use their
own selection criteria depending on their science goals.

MNRAS 000, 1–20 (2022)

4.3 Distributions of the successful ﬁts

Having identiﬁed the galaxies with successful ﬁts within the sample,
we can now explore the properties of those galaxies components.
The distribution of the galaxies with successful ﬁts in terms of total
mass, morphology and redshift are shown in Fig 3. The masses
and redshifts were taken from the NSA, while the morphologies
come from the MDLM-VAC, where early type galaxies (ellipticals
and S0s) are considered to have T-Type < 0 while late type (spiral)
galaxies have T-Types > 0 and irregular galaxies are identiﬁed with T-
Type = 10. The ﬁgure also shows the distribution of the full sample
of MaNGA candidate galaxies from DR15 (i.e. those with initial
estimates for the ﬁt parameters from the MPP-VAC and observed
with the 91 or 127-ﬁbre IFUs) in grey for comparison. It can be seen
that the distribution of the galaxies successfully modelled by buddi
do follow approximately the same shape as the full DR15 sample,
with approximately 40 − 50% of galaxies in each bin successfully
modelled in SE, with signiﬁcantly more in SS. The morphologies
show peaks at T-Types -2.5 and 4.5, corresponding to early and
late types respectively, and do not appear to show any bias against a
certain T-Type, and the redshifts rise sharply to 𝑧 ∼ 0.03 with a longer
tail out to 𝑧 ∼ 0.15. The shapes for the distributions for the SS and
SE ﬁts are very similar for morphology and redshift, but they show
a larger diﬀerence in the galaxy stellar mass, where the SS models
successfully ﬁt more lower mass galaxies (log(𝑀/𝑀(cid:12)) < 10) than
the SE ﬁts. One contributing factor to this eﬀect could be that the
lower mass galaxies were observed with the smaller IFUs, in this
case the 91-ﬁbre IFU, where it’s harder to achieve a good ﬁt with 2
components. Another consideration is that, in general, it is harder to
separate the components in fainter galaxies due to lower S/N.

However, in general, the sample of DR15 galaxies that have been
successfully modelled with buddi follow similar distributions in
terms of the masses, morphologies and redshifts as the full MaNGA
DR15 sample, indicating that these ﬁts have introduced no signiﬁcant
bias to the sample.

4.4 Statistics of the ﬁt parameters

The histograms in Fig. 4 present the distribution for each of the
structural parameters (𝑅𝑒, 𝑛, 𝑃 𝐴 and 𝑞) for all the successful ﬁts
with buddi in blue, with the distribution of the initial estimates
from the MPP-VAC for the same galaxies in red for comparison. The
distributions for 𝑅𝑒 in all plots show a peak at 𝑅𝑒 < 10(cid:48)(cid:48) with a long
tail to larger radii. This trend is likely to be due to a selection bias
in the original sample, where the IFU-bundle used to observe each
galaxy was selected to cover the inner 1.5-2.5 𝑅𝑒. As a reference,
the vertical dashed and dot-dashed lines in these plots mark the radii
of the 91 and 127-ﬁbre IFUs, respectively. The ﬁts to some of the
galaxies with large values of 𝑅𝑒 were checked by eye, and it was
found that many of them have high inclinations and appear very
edge-on, making it hard to accurately measure the 𝑅𝑒 due to the
small FOV. In the SE ﬁts, it can be seen that the mean 𝑅𝑒 value
for the exponential components is higher than the Sérsic component.
Assuming these components model the discs and bulges respectively,
this result reﬂects the scenario where the discs are more extended
and the bulges more compact.

The Sérsic index distributions are also interesting, showing a bias
towards lower values in the SS plot that peak at around 𝑛 = 1. The
distribution in the morphologies in Fig. 3 shows that the majority of
the sample are late-type galaxies (T-Type > 0), thus explaining the
bias towards lower 𝑛. However, the ﬁts to the Sérsic component in
the SE ﬁts also show a peak at very low 𝑛. There are several possible

BUDDI-MaNGA I

9

Figure 3. Overview of the masses (left), morphologies (middle) and redshifts (right) for ‘good’ ﬁts with the SS (top) and SE (bottom) models. The grey bars
represent the morphologies of all galaxies where ﬁts where attempted (i.e. observed with the 91 and 127-ﬁbre IFUs with successful ﬁts in the MPP-VAC for SS
or SE proﬁles).

reasons for this trend. For example, it could be due to the majority of
bulges in this sample of galaxies being closer to pseudobulges than
classical bulges (using 𝑛 < 2.0 and 𝑛 > 2.0 respectively, using the
deﬁnition of Fisher & Drory 2008), or that GalfitM has ‘ﬂipped’
the components, such that the exponential proﬁle ﬁts dominates the
light in the inner regions and the Sérsic proﬁle models the more
extended component. This phenomenon will be explored further in
Section 4.6.

The distribution in the 𝑃 𝐴 is relatively ﬂat for both sets of ﬁts, as
expected, and the axis ratio (𝑞) for the SS ﬁts are relatively ﬂat up
to 𝑞 ∼ 0.8, where they start to drop. While this result may reﬂect
the sample selection in the larger DR15 sample of galaxies, another
signiﬁcant contributing factor is that it’s harder to get a good ﬁt
to more face-on galaxies in the MaNGA sample due to the small
ﬁelds of view, resulting in the outskirts of the galaxy and the sky
background not being included in the ﬁt. Another factor to consider
is that determining axis ratios for more face on galaxies is harder
than more edge on galaxies, i.e. the diﬀerence from axes ratios of 0.9
and 1.0 is much smaller than from 0.05 to 0.15. The SE ﬁts, on the
other hand, show a peak at 𝑞 ∼ 0.65 for both components, with the
ﬁts to the exponential component dropping faster to higher values
of 𝑞 while the Sérsic proﬁles drop more steeply to lower values for

𝑞. Again, assuming that these two proﬁles generally model the discs
and bulges respectively, these trends simply reﬂect that the discs
have higher ellipticities while the bulges appear rounder, as would
be expected.

4.5 Comparing the ﬁt parameters with the MPP-VAC

Since the MaNGA images have a smaller FOV and slightly lower
spatial resolution than the imaging data used for MPP-VAC, the ﬁt
parameters for each galaxy derived by both methods may be diﬀerent
because buddi has less information to model the outskirts of the
galaxy and the sky background. To explore the eﬀect of this smaller
ﬁeld of view on the reliability of the ﬁts, Johnston et al. (2017)
created a series of simulated datacubes based on the MaNGA data
for diﬀerent IFU sizes, and ran these datacubes through buddi using
an SE model to compare the derived structural parameters and stellar
populations with those used to create the datacubes. They found
that for the datacubes based on the 127 and 91-ﬁbre IFUs, the ﬁnal
structural parameters and the stellar populations derived from the
resulting spectra were consistent with the properties that went into
the model datacubes. They therefore concluded that these two IFU
sizes in the MaNGA data have suﬃcient resolution elements to obtain

MNRAS 000, 1–20 (2022)

89101112log(M/M)050100150200250300Number of Galaxies89101112log(M/M)050100150200250300Number of Galaxies0.000.050.100.150.20z0100200300400500600700800Number of GalaxiesSingle Sersic Fitno. galaxies: 10380.000.050.100.150.20z0100200300400500600700800Number of GalaxiesSersic + Exponential Fitno. galaxies: 691-20246810T-Type0100200300400Number of Galaxies-20246810T-Type0100200300400Number of Galaxies10

E. J. Johnston et al

Figure 4. Overview of the ﬁt parameters for ‘good’ ﬁts, deﬁned as having 0.25 < 𝑅𝑒 < 50(cid:48)(cid:48), 0.205 < 𝑛 < 7.95 and 𝑞 > 0.1. The red line represents the
distribution in the ﬁt parameters from the MPP-VAC for the same sample of galaxies for comparison. The vertical dashed and dot-dashed lines in the top row
indicate the radii of the FOV for the 91 and 127-ﬁbre IFUs respectively. The insets in each plot show the histograms for the ratio of the 𝑅𝑒 and 𝑛 from buddi
relative to the MPP-VAC values for the same galaxy and component (top two rows), and the diﬀerences in the buddi and MPP-VAC values for the 𝑃 𝐴 and
𝑞 in the bottom two rows. The numbers in the insets reﬂect the median value for the distributions in those histograms (i.e. the median value for the ratios or
diﬀerences), and the dashed grey lines reﬂect ratios of 1 and diﬀerences of 0 as a guide.

MNRAS 000, 1–20 (2022)

01020304050Re (arcsec)050100150200250300Number of Galaxiesno. galaxies: 1038Single Sersic Fit01020304050Re (arcsec)0255075100125150175no. galaxies: 691Sersic + Exponential Fit  Exponential01020304050Re (arcsec)050100150200250no. galaxies: 691Sersic + Exponential Fit  Sersic02468n050100150200250Number of Galaxies02468n010020030040050060070002468n0255075100125150175-90-60-300306090PA020406080100120Number of Galaxies-90-60-300306090PA020406080-90-60-300306090PA0204060800.00.20.40.60.81.0q020406080100120140Number of Galaxies0.00.20.40.60.81.0q0204060801001200.00.20.40.60.81.0q0204060801001200123Re ratio02004001.080123Re ratio01002001.040123Re ratio01002000.980123n ratio02004001.090123n ratio01000.9020020PA02004006008000.3520020PA02004000.3620020PA01002000.040.20.00.2Q0200400600-0.000.20.00.2Q0100200-0.010.20.00.2Q0100200-0.01a reliable two component ﬁt. In the smaller IFU sizes however, the
structural parameters and, in particular the stellar populations, were
found to become increasingly unreliable. However, those tests were
run on a small number of simulated datacubes. With the data set used
in this work, it is possible to repeat these tests in a more statistically
signiﬁcant way by comparing the ﬁt parameters to those derived from
photometric data and provided in the MPP-VAC.

The red lines in the histograms in Fig. 4 represent the distributions
in the ﬁt parameters from the MPP-VAC for the same sample of
galaxies. In general, the distributions are very similar, indicating that
in the majority of these cases the MaNGA FOV is suﬃciently large
to achieve a good ﬁt with galfitm.

To further explore the diﬀerences in the ﬁt parameters for each
component modelled within each galaxy, the insets in each plot within
Fig. 4 directly compare the parameters between buddi and the MPP-
VAC for each galaxy, plotting the ratio of the 𝑅𝑒 and 𝑛 from buddi
over the input value from the MPP-VAC in the top two rows, and
the physical diﬀerence between the two ﬁts for the 𝑃 𝐴 and 𝑞 in the
bottom two rows. The median values for each distribution are given
in the top right of each inset, and are listed in Table 2 along with the
values of the ﬁrst and third quartiles of the distributions. It can be
seen that in all cases, the distributions peak at around 1 for the ratios,
and around 0 for the diﬀerences, indicating that, in general, the ﬁts
by buddi are not too diﬀerent to the initial parameters taken for that
galaxy or component from the MPP-VAC. Figure 5 also presents the
ﬁt parameters from buddi and the MPP-VAC as scatter plots. Again,
it can be seen that the ﬁt parameters are generally consistent, but with
larger scatter for the 𝑅𝑒 and 𝑛. For example, one can see that buddi
appears to over-estimate the 𝑅𝑒 for the single Sérsic ﬁts to larger
galaxies, which is likely to be an eﬀect of these galaxies ﬁlling more
of the FOV and being poorly modelled by a single component. The
Sérsic indices for the Sérsic components in the SE ﬁts also display
large scatter. Again, this trend may be an artefact from the eﬀects
already mentioned, but in some cases they may also be the result of
the components being ﬂipped by buddi and not in the MPP-VAC,
or vice versa. In other words, the Sérsic component may reﬂect the
more extended component in the buddi ﬁt but the more compact
component in the MPP-VAC. This phenomenon will be discussed
further in Section 4.6, but for now those galaxies that have been
identiﬁed as ﬂipped by buddi but not in the MPP-VAC are highlighted
in red in Fig. 5, and do appear to account for some of the scatter at
low 𝑛 with buddi. Another eﬀect may be the diﬀerent approaches
used in this work and the MPP-VAC for ﬁtting galaxies with high
Sérsic indices, where in the MPP-VAC, the authors repeated the ﬁts
to the bulge components that converged on 𝑛 = 8 with a reduced
upper limit on the Sérsic index constraining the ﬁt, generally with
1 < 𝑛𝑙𝑖𝑚 < 3. They then evaluated each ﬁt in terms of the 𝜒2 of the
ﬁnal ﬁts, and selected the better ﬁt, which was often the one with
the lower limit for 𝑛. This process of repeating the ﬁts explains the
higher frequencies for 𝑛 ∼ 1 in the MPP-VAC catalog seen in Fig. 4,
but may introduce potential bias in the ﬁts to artiﬁcially low Sérsic
indices and leads to an inhomogeneous ﬁtting sample due to the
use of diﬀerent constraints. Finally, while Häußler et al. (2013) and
Häußler et al. (2022) show that multi-waveband ﬁts, such as those
used in this study, allow sizes and Sérsic indices to be recovered
more accurately, they still ﬁnd that the Sérsic index is the hardest
parameter to derive accurately when applying light proﬁle ﬁts for
both one and two-component models. Therefore, the scatter seen in
the Sérsic indices in Fig. 5 is to be expected.

BUDDI-MaNGA I

11

Table 2. Overview of the distributions in the ratios of the 𝑅𝑒 and 𝑛 from
buddi relative to the MPP-VAC values for the same galaxy and component,
and the diﬀerences in the buddi and MPP-VAC values for the 𝑃 𝐴 and 𝑞,
giving the median values and the values of the ﬁrst and third quartiles.

Q1 Median

Q3

SS
𝑅𝑒
𝑛
𝑃 𝐴
𝑞

SE, exponential
𝑅𝑒
𝑃 𝐴
𝑞

SE, Sérsic
𝑅𝑒
𝑛
𝑃 𝐴
𝑞

0.96
0.90
-0.45
-0.02

0.73
-2.51
-0.07

0.72
0.63
-8.31
-0.07

1.08
1.09
0.35
0.00

1.04
0.36
-0.01

0.98
0.90
0.04
-0.01

1.48
1.37
1.05
0.01

1.30
4.00
0.06

1.21
1.48
6.43
0.03

4.6 Flipped galaxies

In the MPP-VAC, Fischer et al. (2019) described the phenomenon
of ‘ﬂipped’ galaxies, where the Sérsic component models the more
extended structure while the exponential component was found to be
more compact. They identiﬁed the ﬂipped galaxies as those having
𝑅𝑒,exp < 𝑅𝑒,Sérsic and 𝑛Sérsic < 1, and thus labelled the bulge and
disc components in their ﬁts accordingly.

This phenomenon is explored in this data set in Figure 6, which
compares the 𝑅𝑒 of the Sérsic and exponential components, colour-
coded according to the Sérsic index of the Sérsic model. It can be
seen that the majority of galaxies with 𝑅𝑒,exp < 𝑅𝑒,Sérsic fall into
two categories- those with very high Sérsic indices (i.e. 𝑛 > 5),
representing bright cores and broad wings (∼ 20% of the sample,
displayed as light red points), and those with Sérsic indices 𝑛 < 1
(∼ 75% of the sample, blue points). Consequently, in the majority of
cases where the Sérsic component models the more extended struc-
ture within the galaxy, it also has a Sérsic index of below 1. Clearly,
this scenario does not ﬁt with the assumption that the Sérsic and ex-
ponential components always model the bulge and disc respectively,
but is in agreement with the ﬁndings of Fischer et al. (2019).

We followed Fischer et al. (2019) and identiﬁed ﬂipped galaxies
as those with 𝑛Sérsic < 1 and 𝑅𝑒,exp < 𝑅𝑒,Sérsic. However, before
oﬃcially identifying these galaxies as ﬂipped, a ﬁnal consistency
check was carried out. In Fig. 7, the Sérsic-to-Total and Bulge-to-
Total ﬂux ratios for each galaxy are plotted against the morphology.
In this plot, the ﬂipped galaxies are highlighted in red. If the bulges
and discs have been correctly identiﬁed, one would expect that the
Bulge-to-Total ﬂux ratio would decrease with increasing T-Type as
one moves from early to late type galaxies. This trend can clearly be
seen in the plot for the Bulge-to-Total ﬂux ratios, while the Sérsic-to-
Total light ratios are actually seen to increase for the later type spirals.
Consequently it can be seen that in this sample, the identiﬁcation of
ﬂipped galaxies appears to work, and that the majority of the ﬂipped
galaxies have later type morphologies.

In this sample, ∼ 33% of the galaxies are considered to be ﬂipped.
This number is signiﬁcantly higher than the ∼ 13% found by Fis-
cher et al. (2019), which may be due to a combination of factors.
For example, the MaNGA images used for the ﬁts in this work use
a smaller sample of galaxies with a smaller FOV and lower spatial

MNRAS 000, 1–20 (2022)

12

E. J. Johnston et al

Figure 5. A comparison of the ﬁt parameters derived using buddi with the input parameters from the MPP-VAC for galaxies considered to have ‘good’ ﬁts in
both catalogs. Red points reﬂect galaxies identiﬁed as having been ﬂipped by buddi but not in the MPP-VAC. The layout follows Fig. 4

resolution, which may introduce some inherent biases to the ﬁts. Fur-
thermore, it could also be due to diﬀerences in the ﬁtting procedures,
where Fischer et al. (2019) carried out repeated ﬁts for galaxies with
𝑛Sérsic = 8 to constrain the upper limit for the Sérsic index. This
additional step was not carried out in this study, and may have some
eﬀect on whether some galaxies are ﬂipped. And ﬁnally, the initial
parameters used for the ﬁts with buddi came from the MPP-VAC,

and so if a galaxy was ﬂipped in that sample, the buddi ﬁt also started
as being ﬂipped.

Due to the presence of likely ﬂipped galaxies in both this work and
the MPP-VAC, we follow the methodology of Fischer et al. (2019) to
report the sizes of both components in terms of 𝑅𝑒 instead of using the
scale length, 𝑅𝑑, for the size of the exponential component. However,
should one want to use the scale length of the exponential component,

MNRAS 000, 1–20 (2022)

0.11.010.0Re (MPP-VAC)0.11.010.0Re (this work)Single Sersic Fit0.11.010.0Re (MPP-VAC)0.11.010.0Sersic + Exponential Fit  Exponential0.11.010.0Re (MPP-VAC)0.11.010.0Sersic + Exponential Fit  Sersic0.11.010.0n (MPP-VAC)0.11.010.0n (this work)0.11.010.0n (MPP-VAC)0.11.010.00.11.010.0n (MPP-VAC)0.11.010.0-90-60-300306090PA (MPP-VAC)-90-60-300306090PA (this work)-90-60-300306090PA (MPP-VAC)-90-60-300306090-90-60-300306090PA (MPP-VAC)-90-60-3003060900.00.20.40.60.81.0q (MPP-VAC)0.00.20.40.60.81.0q (this work)0.00.20.40.60.81.0q (MPP-VAC)0.00.20.40.60.81.00.00.20.40.60.81.0q (MPP-VAC)0.00.20.40.60.81.0BUDDI-MaNGA I

13

Figure 6. Comparison of the 𝑅𝑒 for the Sérsic and exponential components in
each SE ﬁt, with blue, red and light red points representing 𝑛 < 1, 1 < 𝑛 < 5
and 𝑛 > 5, respectively.

it can be calculated from the eﬀective radius using 𝑅𝑑 = 𝑅𝑒/1.678
(Meert et al. 2015).

5 OVERVIEW OF THE STELLAR POPULATION

PROPERTIES

Having cleanly extracted the spectra for each component and iden-
tiﬁed the galaxies with good ﬁts, the next step was to derive the
stellar populations. A detailed analysis of the stellar populations in
each component as a function of galaxy morphology, mass etc is
beyond the scope of this work, and will be explored in future papers.
However, an overview of the basic stellar populations properties is
presented here, alongside some further tests of the reliability of the
ﬁts using a more statistical sample than was available in Johnston
et al. (2017).

5.1 Analysis of the Mass-Weighted Stellar Populations

The mass-weighted stellar populations were measured from each
spectrum through full-spectral ﬁtting using ppxf. A regularized ﬁt
was applied to each spectrum using a linear combination of template
spectra of known relative ages and metallicities from the MILES
evolutionary synthesis models of Vazdekis et al. (2015). These
model spectra span an age and metallicity range of 0.03 − 14 Gyr
and [M/H]=−2.27 to +0.40 respectively, and were created using
the BaSTI isochrones (Pietrinferni et al. 2004, 2006). The ﬁts were
also carried out with the template spectra created using the Padova
isochrones (Girardi et al. 2000), but while the results were consistent
between the two sets of models, the sparser sampling in the high-
metallicity regime led to some artefacts in the metallicities measured
after regularization. Consequently, the results presented in this sec-
tion were derived using the BaSTI isochrone templates. The best ﬁt
models were convolved with a multiplicative Legendre polynomial
of order 10 to model the shape of the continuum, thus reducing
the sensitivity to dust reddening and omitting the requirement of a
reddening curve (Cappellari 2017).

The regularization process is designed to smooth the variation in
the weights of the templates with similar ages and metallicities. This
step reduces the chances of template mismatch, which contributes to

Figure 7. The Sérsic-to-Total (top) and Bulge-to-Total (bottom) ﬂux ratios
of each galaxy as a function of T-Type. The solid line represents the rolling
median, with the dashed lines showing ±1𝜎. The red points mark the galaxies
that were identiﬁed as being ﬂipped.

the noise in the stellar population parameters, and attaches a physical
meaning to the weights assigned to the templates in term of the
star formation history, age and metallicity distribution within an
individual galaxy. In order to determine the level of regularization
required, an unregularized ﬁt is ﬁrst applied to each spectrum to
measure the 𝜒2 value for the ﬁt. The noise spectrum was then scaled
appropriately until 𝜒2/𝑁𝐷𝑂𝐹 = 1, where 𝑁𝐷𝑂𝐹 is the number of
degrees of freedom in the ﬁt (i.e. the number of unmasked pixels in
the input spectrum). Finally, the ﬁt to the spectrum was repeated using
the scaled noise spectrum and increasing the regularization value in
steps until the 𝜒2 of the ﬁt increased by Δ𝜒2 = √︁2 × 𝑁𝐷𝑂𝐹 . This
value represents the limit between a smooth ﬁt that still reﬂects the
star-formation history of the galaxy and one that has been smoothed
excessively. However, it is important to note that this ﬁt may not
reﬂect the true star-formation history of the galaxy, in particular for
variations in the star-formation activity over shorter timescales than
the models allow. Consequently, these regularized ﬁts are designed to
reduce the age-metallicity degeneracy between spectra. The template
spectra used in these ﬁts are modelled for an initial birth cloud

MNRAS 000, 1–20 (2022)

110Re (Exponential) (arcsec)110Re (Sersic) (arcsec)n < 11 < n < 5n > 50.00.20.40.60.81.0Sersic/Total Flux Ratio-2.00.02.04.06.0T-Type0.00.20.40.60.81.0Bulge/Total Flux Ratio14

E. J. Johnston et al

of 1M(cid:12), meaning that the ﬁnal weight of each template reﬂects
the ‘zero-age’ mass-to-light ratio of that stellar population. As a
result, the smoothed weighting of template spectra with similar ages
and metallicities represents a simpliﬁed star-formation history of the
component being modelled by deﬁning the relative mass contribution
of each stellar population (see e.g. McDermid et al. 2015).

An example of the regularized SFH derived for the spiral galaxy
with the MaNGA plate-IFU number 8991-12704 is shown in Fig. 8.
This ﬁgure includes the MaNGA white-light image of the galaxy
alongside the SDSS 𝑔𝑟𝑖-band image, the residual image after sub-
tracting the SE model, and the best-ﬁtting model images for the SS
model and the exponential and Sérsic components in the SE ﬁt. Below
each model image are the smoothed age-metallicity weights grids,
which represent the SFHs for the spectra extracted using the corre-
sponding models, and the ﬁt to the spectrum by ppxf. For this galaxy,
one can see that the SFH derived from the SS ﬁt shows that the galaxy
has undergone an extended star formation history, with the majority
of the mass being built up between 1 − 10 billion years ago. When we
consider the SFHs of the Sérsic and exponential components, their
independent SFHs become clear. The exponential component shows
generally younger stellar populations than the Sérsic component, and
was built up over a longer timescale, while the Sérsic component
shows that the majority of its stellar mass was formed early in the
lifetime of the galaxy with only a tiny fraction of the mass formed
more recently. These results are consistent with the model that the
exponential and Sérsic components represent the disc and bulge re-
spectively, and the typical scenario where spiral galaxies contain an
old bulge surrounded by a star forming disc. Thus, this ﬁgure demon-
strates the strength of using buddi to cleanly disentangle the stellar
populations of distinct components within galaxies.

In order to compare the stellar populations of the bulges and discs
across the entire sample, the mean mass-weighted ages and metallic-
ities of each galaxy as a whole (from the SS ﬁt) and of their bulges
and discs (from the SE ﬁt) were calculated using

log(AgeM-W) =

(cid:205) 𝜔𝑖log(Agetemplate,𝑖)
(cid:205) 𝜔𝑖

and

[M/H]M-W =

(cid:205) 𝜔𝑖[M/H]template,𝑖
(cid:205) 𝜔𝑖

(1)

(2)

respectively, where 𝜔𝑖 represents the weight of the 𝑖𝑡 ℎ template (i.e.
the value by which the 𝑖𝑡 ℎ stellar template is multiplied to best ﬁt
the galaxy spectrum), and [M/H]template,𝑖 and Agetemplate,𝑖 are the
metallicity and age of the 𝑖𝑡 ℎ template respectively.

Figure 9 presents an example of the mass-weighted ages and metal-
licities for all galaxies successfully ﬁtted with the SS and SE models,
plotted against the mass of the total galaxy and colour coded ac-
cording to the morphology in terms of T-Type (red indicates earlier
types while blue indicates later type morphologies). In the plots for
the SS ﬁts, one can clearly see the red and blue sequences, such
that the higher-mass ETGs generally have older, more metal-rich
stellar populations while the lower-mass LTGs have younger, more
metal-poor stellar populations. Furthermore, the distributions in the
ages and metallicities of the LTGs are much broader than the ETGs.
These trends are in agreement with the stellar mass-metallicity and
mass-age relations in the literature. For example, the ﬁrst study of
the stellar mass-metallicity relation was by Gallazzi et al. (2005),
in which they found that low-mass galaxies tended to be younger
and more metal-poor than the higher-mass galaxies, with a rapid
transition between these two regimes occurring for the mass range
3 × 109 − 3 × 1010M(cid:12). This same transition in age and metallicity

MNRAS 000, 1–20 (2022)

can be seen in the SS plots in Fig. 9. A recent study by Zenocratti
et al. (2022) of the mass-metallicity relation using galaxies in the
EAGLE simulation also found a link with morphology, such that at
a given mass, the rotationally-supported disc galaxies tend to have
lower metallicities than the dispersion supported spheroidal galaxies.
They concluded that this trend arose due to the disc galaxies having
recently accreted low-metallicity gas, which fuelled more recent star
formation, while the spheroidal galaxies instead formed stars earlier
on by using their own gas reservoirs.

When looking at the plots for the SE ﬁts, the same general trends
appear to also hold true for the bulges and discs, though with more
scatter. For example, in the higher mass galaxies (𝑀 > 1010 𝑀(cid:12)),
the discs show a broader distribution in both age and metallicity
than the bulges. This trend could indicate fundamental diﬀerences in
the evolution of the bulges and discs themselves in this mass range,
potentially reﬂecting more recent star formation in the discs of high-
mass galaxies fuelled by accreted low-metallicity gas while the bulges
have evolved more passively, as was already proposed by Zenocratti
et al. (2022) for disc-dominated galaxies. In low-mass galaxies how-
ever, both the bulges and discs show evidence of younger and more
metal-poor stellar populations, indicating that both components may
have formed more recently than in the higher mass galaxies. A more
detailed analysis of the bulge and disc star-formation histories in the
S0s in this sample by Johnston et al (submitted) have indeed found
this trend, where the bulges of galaxies with masses M > 1010M(cid:12)
formed rapidly in the early lifetime of the galaxy, while those in
lower mass galaxies formed more recently over longer timescales.
Additionally, a more detailed analysis of this trend for spiral galaxies
is ongoing, and will be presented in Jegatheesan et al (in prep). How-
ever, similar trends have been seen in studies that applied bulge-disc
decomposition techniques to photometric data. For example, a recent
study by Robotham et al. (2022) used the ProFUSE package to ex-
plore the mass-size-age plane for galaxy components through SED
ﬁtting to 𝑢𝑔𝑟𝑖ZYJHKs imaging from the GAMA survey, ﬁnding a
strong trend in the disc metallicity with the disc mass such that higher
mass discs have higher metallicities, as seen in Fig. 9.

5.2 Investigating the eﬀect of the Chebychev polynomials

In Section 3.4 we discussed the Chebychev polynomials selected for
the ﬁt parameters, speciﬁcally using a polynomial of order 1 for the
𝑅𝑒 and 𝑛 in the SE ﬁts and an order of 2 for these parameters in the
SS ﬁts (the 𝑞 and 𝑃 𝐴 used polynomials of order 1 throughout). This
additional degree of freedom was selected for the SS ﬁts to improve
the models of 2-component galaxies by allowing for colour gradients.
Such gradients could be created, for example, in spiral galaxies with
old, red bulges surrounded by younger, star-forming discs, making
them appear larger at bluer wavelengths and more compact in the
redder end of the spectrum. Since these polynomials model the gen-
eral shape of the light distribution throughout the galaxy, the choice
of polynomial between orders 1 and 2 should not aﬀect the strength
of the spectral features signiﬁcantly.

In order to test this hypothesis, the SS ﬁts were repeated using a
polynomial of order 1 for the 𝑅𝑒 and 𝑛, and the stellar populations
derived in the same way. Apart from the choice of polynomial, the
ﬁts and the analysis were identical. Figure 10 compares the ages
and metallicities of the galaxies using these two polynomial orders,
and show that the results are generally consistent, with standard
deviations of 0.38 Gyrs in age and 0.05 in metallicity. Consequently,
we can say that the stellar populations derived from the spectra
extracted by buddi are fairly insensitive to the choice of polynomial
between an order of 1 and 2.

BUDDI-MaNGA I

15

Figure 8. An example of the ﬁt to galaxy 8991-12704. The top row shows the MaNGA white-light image (left), and SDSS 𝑔𝑟 𝑖-band image with the MaNGA
FOV outlined (middle), and the white-light residual image from the SE ﬁt (right). The second row shows the best ﬁt for the SS model (left) and the exponential
and Sérsic components for the SE ﬁt (middle and right). For each model, the smoothed age-metallicity grid and the ppxf ﬁt to the integrated spectrum for that
component are given below in the bottom two rows. Note that in the bottom row, the gas spectrum and the residuals have been oﬀset for clarity, and several key
emission and absorption lines have been identiﬁed in the ﬁt to the Sérsic component spectrum for reference.

6 COMPARISON WITH MPP-VAC

In section 4 we explored the diﬀerences in the structural parameters
between the ﬁts obtained by buddi and those in the MPP-VAC that
were derived from SDSS images of the MaNGA galaxies using the
pymorph code. While no signiﬁcant diﬀerences were detected in the
trends for the structural parameters, even small diﬀerences in the
ﬁts could potentially lead to signiﬁcantly diﬀerent estimates of the
stellar populations in each component. While this issue was explored
in Johnston et al. (2017) for the prototype MaNGA data, the small

number of galaxies available at the time meant that the tests were
carried out on a series of simulated datacubes. In this section, we will
explore this issue in more detail by comparing the stellar populations
derived from the spectra extracted using the buddi and MPP-VAC ﬁt
parameters.

For this test, the galaxies were modelled again with buddi using
the ﬁt parameters for each component in the MPP-VAC, and with 0-
order polynomials for the 𝑅𝑒, 𝑛, 𝑞 and 𝑃 𝐴 (i.e. holding them ﬁxed at
the input values along the entire wavelength range) and allowing the
magnitudes complete freedom. The mean mass-weighted ages and

MNRAS 000, 1–20 (2022)

8991-12704ResidualsExponentialSersicSS 0.1 1.0 10.0Age (Gyrs)2.01.51.00.50.0[M/H]SS0.0000.0030.006Mass Fraction 0.1 1.0 10.0Age (Gyrs)2.01.51.00.50.0[M/H]Exponential0.0000.0050.010Mass Fraction 0.1 1.0 10.0Age (Gyrs)2.01.51.00.50.0[M/H]Sersic0.0000.0050.0100.015Mass Fraction5000520054005600Wavelength (Å)0.51.01.5Relative FluxGalaxyBest FitStarsGasResiduals5000520054005600Wavelength (Å)0.51.01.5Relative Flux5000520054005600Wavelength (Å)0.51.01.5Relative FluxH[OIII]4959[OIII]5007MgB16

E. J. Johnston et al

Figure 9. Ages (top) and metallicities (bottom) as a function of the total galaxy mass for the SS ﬁts (left) and the discs and bulges of the SE ﬁts (middle and
right respectively), colour-coded by the T-Type of each galaxy.

metallicities for the SS and SE ﬁts are very consistent, though the SE
ﬁts do show a larger scatter, particularly for the exponential compo-
nent. The colours of the data points show that many of the outliers
in the results for the exponential component are early-type galax-
ies, with T-Types< 0, and so it is possible that in some cases these
poor results are due to forcing a 2-component ﬁt on an elliptical
galaxy that is already well modelled with a single Sérsic proﬁle,
which makes proﬁles ﬁts inherently unreliable. The outliers in the
Sérsic components of the SE ﬁts, on the other hand, tend to be LTGs,
but the correlation is much tighter in this case. Since Fig. 7 shows
that the majority of ﬂipped galaxies have late type morphologies, it
is possible that this scatter is due to mismatched components, i.e.
where the Sérsic and exponential components have been ﬂipped in
one set of ﬁts but not the other. However, only ∼ 4% of these galaxies
were found to fall into this category (i.e. ﬂipped in one set of ﬁts but
not the other), and so this mismatch does not completely explain the
scatter.

To further explore the outliers, Fig. 12 has been replotted in Fig-
ures A2 and A2 in Appendix A, this time colour coding the points
according to the ratios of the values derived by buddi to those from
the MPP-VAC. While no obvious trend can be seen between the
diﬀerence in the stellar populations and these ﬁt parameters, it is
interesting to note that the outliers in the exponential components
that are marked as ETGs in Fig. 12 also appear to show lower ratios
in the 𝑅𝑒 and 𝑛 values between the two sets of ﬁts, i.e. the values
derived by buddi are signiﬁcantly lower than those in the MPP-VAC.
Again, this eﬀect may be a result of forcing a 2-component ﬁt upon
galaxies that are better modelled with a single Sérsic component.

A closer inspection was carried out on the ﬁts to some of the outly-
ing points to better understand the discrepancy in their measurements.
The largest outlier in the age and metallicity plots for the exponen-
tial components corresponds to galaxy 8249-12705 (marked with a
circle around the point in Fig. 11), and the corresponding spectra for

Figure 10. A comparison of the mass-weighted ages (left) and metallicities
(right) for the spectra derived from the SS ﬁts using Chebychev polynomials of
orders 1 and 2 to model the variation in 𝑅𝑒 and 𝑛 with wavelength. The mean
diﬀerences in the age and metallicity measurements are given in the bottom
right of each plot, with the uncertainty reﬂecting the standard deviation of the
scatter.

metallicites of the resulting bulge and disc spectra were derived in the
same way as described in Section 5, and are plotted in Fig. 11 for both
the SS and SE ﬁts. As before, the colours reﬂect the morphology of
each galaxy. It should be noted that these plots only include the results
for spectra that were derived from successful ﬁts in both cases, using
the criteria outlined in Section 4.2, where the parameters derived by
buddi and the MPP-VAC were assessed independently. The mean
diﬀerences between the ages and metallicities measured in the two
sets of ﬁts, along with the standard deviation of the scatter, are given
in the bottom right of each plot.

One can see that, in general, the measurements for the ages and

MNRAS 000, 1–20 (2022)

89101112log10(M/M)0.1110Age (Gyrs)SS89101112log10(M/M)0.1110Bulge89101112log10(M/M)0.1110Age (Gyrs)Disc89101112log10(M/M)2.01.51.00.50.00.5[M/H]89101112log10(M/M)2.01.51.00.50.00.589101112log10(M/M)2.01.51.00.50.00.5[M/H]3210123456T-Type0.1110Polynomial order 20.1110Polynomial order 1Age (Gyrs)Age = 0.0±0.4 Gyrs2.01.51.00.50.00.5Polynomial order 22.01.51.00.50.00.5Polynomial order 1[M/H][M/H] = 0.01±0.053210123456T-TypeBUDDI-MaNGA I

17

Figure 11. Comparison of the stellar populations for each component extracted using the buddi and pymorph ﬁt parameters. The colours correspond to
the morphology, as indicated in the colour bar on the right, with redder colours reﬂecting ETGs (T-Type< 0). The mean diﬀerences in age and metallicity
measurements are given in the bottom right of each plot, with the uncertainty reﬂecting the standard deviation. The data points with the circle around them
identify the measurements for 8249-12705, for which the spectra extracted for the exponential component are plotted in Fig. 12.

the exponential component derived using the buddi and MPP-VAC
ﬁt parameters are shown in Fig. 12. This ﬁgure also shows the SDSS
𝑔𝑟𝑖-band image of this galaxy and the model images for each com-
ponent from both sets of ﬁt parameters. It can be seen that despite
using the MPP-VAC parameters as the initial estimates, buddi has
converged on a very diﬀerent ﬁt where the Sérsic component is much
more compact and with a lower Sérsic index, and where the exponen-
tial component is brighter (the exponential-to-total light ratio is 0.59
for the buddi ﬁt compared to 0.11 for the MPP-VAC ﬁt). Below these
images, the spectra derived for the exponential component are given,
with the best ﬁt by ppxf over plotted in red, and the smoothed age-
metallicity grid is also given, showing the weights of the template
spectra used in that ﬁt. It can be seen that the spectrum extracted
by buddi has higher S/N with clear spectral features, whereas the
spectrum created using the MPP-VAC ﬁt parameters is much noisier
with few clear spectral features. This lower S/N for the MPP-VAC ﬁt
is simply due to the faintness of the exponential component in the
model, where the Sérsic component dominates the light in all spaxels
in the FOV, and which is not the case for the buddi ﬁt. As a result, the
ﬁt to the MPP-VAC exponential spectrum is very poor, and produces
signiﬁcantly younger, more metal-poor measurements for the stellar
populations. The morphology of this galaxy is listed in the MDLM-
VAC as T-Type= −2.4 and a probability of being an S0 of 0.2, making
it a likely Elliptical galaxy. As a result, any 2-component ﬁts to this
galaxy should be used with care and should not be assumed to repre-
sent the bulge and disc components. In general, though, where good
ﬁts are achieved with the structural parameters derived by buddi and
using those from the MPP-VAC, the results, in terms of both the ﬁt
parameters and the stellar populations derived from the spectra, are
generally consistent. Consequently, we conclude that the buddi ﬁts
are reliable, and that the stellar populations derived truly reﬂect those

of the components modelled in the ﬁts. These results also show that
buddi can be used for IFU data with less coverage of the galaxy if
the structural parameters can be measured reliably from broad-band
photometric data and held ﬁxed within buddi.

A natural question occurs here- why use buddi for the full ﬁts
when it’s been shown that you can achieve similar results using ﬁt
parameters from catalogs such as the MPP-VAC, or from applying
your own ﬁts to imaging data of the same galaxies? The main advan-
tage of using buddi is that it is self contained- imaging data of the
targets may not be available over the same wavelength range or to
the same depth as the IFU datacube. By carrying out the ﬁts within
buddi, you can ensure that you have derived reliable ﬁt parameters
over the wavelength range you are actually using, and avoid intro-
ducing errors or bias when converting pixel scales etc between the
imaging and spectroscopic data. Fits to simulated data by Häußler
et al. (2022) have shown that such multi-band ﬁtting signiﬁcantly
improves the measurements of the parameter values, particularly of
the eﬀective radii and Sérsic indices, when compared to ﬁtting a
single image. Furthermore, running the initial ﬁts within buddi also
allows the user more ﬂexibility to modify the initial parameters, in-
clude or exclude components, and to update the polynomials for the
ﬁt parameters as a function of wavelength to ensure the best ﬁt to the
datacube for their science case. While this step is also possible with
separate imaging data, diﬀerences in the depth of the images and the
spatial resolution may result in poor ﬁts when one tries to include
too many components in the ﬁt to the IFU data.

Of course, using buddi in this way assumes you are using IFU
datacubes with suﬃcient spatial resolution and a wide ﬁeld-of-view.
buddi has so far only been tested on data from MUSE and the
MaNGA and CALIFA surveys. It is likely that additional imaging data
is required for the ﬁts with buddi to datacubes from IFU instruments

MNRAS 000, 1–20 (2022)

0.1110Age from PyMorph fit (Gyrs)0.1110Age from BUDDI fit (Gyrs)SSAge = 0.0±0.6 Gyrs0.1110Age from PyMorph fit (Gyrs)0.1110SESersicAge = 0.1±1.0 Gyrs0.1110Age from PyMorph fit (Gyrs)0.1110Age from BUDDI fit (Gyrs)SEExponentialAge = 0.5±2.4 Gyrs2.01.51.00.50.00.5[M/H] from PyMorph fit2.01.51.00.50.00.5[M/H] from BUDDI fit[M/H] = 0.0±0.12.01.51.00.50.00.5[M/H] from PyMorph fit2.01.51.00.50.00.5[M/H] from BUDDI fit[M/H] = 0.0±0.22.01.51.00.50.00.5[M/H] from PyMorph fit2.01.51.00.50.00.5[M/H] from BUDDI fit[M/H] = 0.1±0.33210123456T-Type18

E. J. Johnston et al

Figure 12. An example of the ﬁts to galaxy 8249-12705 using the parameters derived using buddi (left) and with those from the MPP-VAC (right). The top row
shows the SDSS 𝑔𝑟 𝑖-band image of galaxy alongside the model images for the exponential and Sérsic components from each ﬁt. The key ﬁt parameters for the
two ﬁts (𝑅𝑒, 𝑛𝑆𝑟 𝑠𝑖𝑐 and exponential-to-total light ratio) are also given. The middle row shows the spectrum extracted for the exponential component in the SE
ﬁt using both sets of ﬁt parameters, along with the best ﬁt from ppxf superimposed in red. The bottom row shows the corresponding smoothed age-metallicity
grid for the ﬁts to the spectra in the middle row.

with smaller ﬁelds of view, such as SAURON (Bacon et al. 2001),
KCWI (Morrissey et al. 2018) and the SAMI survey. buddi has
therefore been written to allow the user the ﬂexibility to deﬁne the
structural parameters for the ﬁts based on alternative imaging data
for such scenarios.

7 DISCUSSION AND CONCLUSIONS

We have used buddi to carry out automated light proﬁle ﬁts to IFU
datacubes of a large sample of galaxies observed as part of the SDSS-
IV MaNGA Survey and released as part of the SDSS DR15. We used
a single Sérsic (SS) and Sérsic+exponential (SE) models to cleanly
extract the spectra of the galaxy and the bulge and disc respectively.
As the ﬁrst paper in this series, the purpose of this work is to introduce
the BUDDI-MaNGA project, focussing on the procedure for the ﬁt,
characterising the ﬁnal sample, and testing the results. Future papers
will focus more on the scientiﬁc results of this data set.

We used the publicly available MaNGA data from the DR15, ini-
tially selecting only those galaxies observed with the 91 and 127-ﬁbre
IFUs and which had successful ﬁts in the MPP-VAC. The ﬁts with
buddi were carried out using the MPP-VAC parameters as initial esti-
mates for the structural parameters. After modelling all the galaxies,
we identiﬁed a ﬁnal sample of galaxies with ‘good’ ﬁts, using crite-
ria based on physically meaningful structural parameters. This ﬁnal
sample consisted of 1038 galaxies for the SS model and 691 galaxies
for the SE model. The spectra extracted using the SS model represent

MNRAS 000, 1–20 (2022)

the mean global spectrum of the galaxy, while those created using
the SE model represent the bulge and disc components.

The ﬁrst step in the analysis was to carry out a comparison of the
ﬁt parameters derived by buddi with the initial parameters from the
MPP-VAC. We found similar trends in their distributions, indicating
that buddi was able to model the light proﬁles of the galaxies reliably
despite the smaller FOV of the MaNGA data. The main diﬀerence
was that the buddi ﬁts resulted in more Sérsic components with
𝑛 ∼ 8 while the MPP-VAC showed a higher frequency of 𝑛 < 2. This
trend is mainly down to variations in the approach towards the ﬁts
between these two works– in this work the galaxies were modelled
once, whereas in Fischer et al. (2019) the ﬁts with high Sérsic indices
were repeated with reduced upper limits on this parameter and then
manually checked one by one to determine the best ﬁt.

We also observed the phenomenon of ﬂipped galaxies, already
reported by Fischer et al. (2019) and Lange et al. (2016), where the
Sérsic proﬁle models the more extended component while the ex-
ponential proﬁle ﬁts the more compact component. As in Fischer
et al. (2019), we found that in the majority of cases where the Sérsic
component was more extended than the exponential component, it
also had a low Sérsic index (𝑛 < 1). Consequently, for the remainder
of this work, we identiﬁed the discs as the more extended compo-
nent and bulges as the more compact component. In most cases, the
bulges and discs corresponded to the Sérsic and exponential com-
ponents respectively, except in the cases where 𝑅𝑒,exp > 𝑅𝑒,Sérsic
and 𝑛Sérsic < 1 where the bulges and discs were taken to be the
exponential and Sérsic components respectively.

8249-12705480052005600600064006800Wavelength (Å)0.51.01.5Relative FluxHMgBNaDHGalaxyBest Fit (PPXF)StarsGasResiduals 0.1 1.0 10.0Age (Gyrs)2.01.51.00.50.0[M/H]0.000.010.020.03Mass Fraction480052005600600064006800Wavelength (Å)0.51.01.5Relative Flux 0.1 1.0 10.0Age (Gyrs)2.01.51.00.50.0[M/H]0.000.050.10Mass FractionExponentialBUDDI parametersSersicExponentialMPP-VAC parametersSersicBUDDI fitRe,exp=9.4"Re,ser=1.6"nser=1.94exp/Total=0.59MPP-VAC fitRe,exp=12.2"Re,ser=9.8"nser=6.3exp/Total=0.11Having extracted the spectra for each component, we used ppxf to
carry out regularized ﬁts to the spectra in order to derive estimates
of their mean mass-weighted stellar populations. While these pop-
ulations will be analysed in more detail in future work, the mass-
metallicity and mass-age plots for the SS ﬁts, representing each
galaxy a whole, and the bulge and disc components in the SE ﬁts
were presented. The plots for the SS ﬁts showed clear trends such
that high mass and early type galaxies generally contain older and
more metal-rich stellar populations, while lower-mass and later-type
galaxies are younger and more metal-poor. Since the mass-weighted
stellar populations provide information on when the majority of the
stellar mass was created in these galaxies, this trend reﬂects the
known trend that many of the ETGs were formed a long time ago,
while the LTGs have undergone signiﬁcant star formation throughout
their lives. Similar trends were seen for the two components in the SE
ﬁts, but with a larger scatter in particular in the discs of higher mass
galaxies. These results reﬂect that the discs in most galaxies in this
sample have built their mass over a longer period than the bulges,
likely through a combination of ongoing star formation, accretion
and minor mergers.

Two sets of tests were used to investigate the reliability of the
ﬁts. In the ﬁrst case, the SS ﬁts were repeated using Chebychev
polynomials of order 1 for the Sérsic index and eﬀective radius.
The stellar populations were derived in the same way, and the mean
mass-weighted ages and metallicities compared. Both methods were
found to give consistent values, indicating that the spectra extracted
by buddi are fairly insensitive to the choice of polynomial between
orders of 1 and 2.

The second reliability test focussed on the ﬁt structural parameters
themselves, and how they compare to the ﬁts using the values in the
MPP-VAC. The SS and SE ﬁts were repeated using the MPP-VAC
structural parameters, holding these values ﬁxed and only allowing
the magnitude to vary in each case. The stellar populations were
derived in the same way and compared with the original ﬁts, and it
was found that for galaxies that were considered to have ‘good’ ﬁts
with both sets of parameters, the stellar populations were generally
consistent. As a result, we encourage the use of buddi to determine
the best ﬁt parameters for each galaxy, but acknowledge that in cases
where the FOV is small and the coverage of the galaxy within the
IFU datacube is poor, using ﬁt parameters derived from photometric
data will suﬃce.

In conclusion, in this paper we present the BUDDI-MaNGA
project, in which ∼ 1000 MaNGA galaxies have been modelled
successfully with buddi using single Sérsic and Sérsic+exponential
models to cleanly extract the spectra of each galaxy and their bulges
and disc components respectively. To date, this work provides the
largest sample of clean bulge and disc spectra extracted from IFU
datacubes using the galaxies light proﬁle information. The spectra
derived using these parameters and the subsequent stellar popula-
tions analysis will be used in future papers in this series to explore
the themes of galaxy formation, evolution, and morphological trans-
formations through their eﬀects on the diﬀerent components within
the galaxies.

ACKNOWLEDGEMENTS

We would like to thank the referee for their useful comments which
have helped to improve this paper. E.J.J. acknowledges support from
FONDECYT Iniciación en investigación 2020 Project 11200263.
K.J. acknowledges ﬁnancial support from ANID Doctorado Nacional
2021 project number 21211770. We gratefully thank the bomberos

BUDDI-MaNGA I

19

de Santiago for extinguishing the ﬁre at PUC before it reached the
server room where the BUDDI-MANGA data are stored.

Funding for the Sloan Digital Sky Survey IV has been provided
by the Alfred P. Sloan Foundation, the U.S. Department of Energy
Oﬃce of Science, and the Participating Institutions.

SDSS-IV acknowledges support and resources from the Center for
High Performance Computing at the University of Utah. The SDSS
website is www.sdss.org.

SDSS-IV is managed by the Astrophysical Research Consortium
for the Participating Institutions of the SDSS Collaboration includ-
ing the Brazilian Participation Group, the Carnegie Institution for
Science, Carnegie Mellon University, Center for Astrophysics | Har-
vard & Smithsonian, the Chilean Participation Group, the French
Participation Group, Instituto de Astrofísica de Canarias, The Johns
Hopkins University, Kavli Institute for the Physics and Mathemat-
ics of the Universe (IPMU) / University of Tokyo, the Korean Par-
ticipation Group, Lawrence Berkeley National Laboratory, Leibniz
Institut für Astrophysik Potsdam (AIP), Max-Planck-Institut für As-
tronomie (MPIA Heidelberg), Max-Planck-Institut für Astrophysik
(MPA Garching), Max-Planck-Institut für Extraterrestrische Physik
(MPE), National Astronomical Observatories of China, New Mexico
State University, New York University, University of Notre Dame,
Observatário Nacional / MCTI, The Ohio State University, Pennsyl-
vania State University, Shanghai Astronomical Observatory, United
Kingdom Participation Group, Universidad Nacional Autónoma de
México, University of Arizona, University of Colorado Boulder, Uni-
versity of Oxford, University of Portsmouth, University of Utah,
University of Virginia, University of Washington, University of Wis-
consin, Vanderbilt University, and Yale University.

DATA AVAILABILITY

The MaNGA data used in this paper is already publicly available
as part of SDSS DR15 and the associated Value Added Catalogs.
The BUDDI-MaNGA derived data, including the ﬁt parameters and
stellar populations etc, will be made public in the future after we
have carried out the ﬁts to the DR17 data. However, anyone inter-
ested in using the current data are welcome to contact us to discuss
collaboration.

REFERENCES

Abdurro’uf et al., 2022, ApJS, 259, 35
Aguado D. S., et al., 2019, ApJS, 240, 23
Ahumada R., et al., 2020, ApJS, 249, 3
Bacon R., et al., 2001, MNRAS, 326, 23
Bacon R., et al., 2010, in Ground-based and Airborne Instrumentation for

Astronomy III. p. 773508, doi:10.1117/12.856027

Barsanti S., et al., 2021, ApJ, 906, 100
Blanton M. R., Kazin E., Muna D., Weaver B. A., Price-Whelan A., 2011,

AJ, 142, 31

Blanton M. R., et al., 2017, AJ, 154, 28
Bundy K., et al., 2015, ApJ, 798, 7
Cappellari M., 2017, MNRAS, 466, 798
Cappellari M., Copin Y., 2003, MNRAS, 342, 345
Cappellari M., Emsellem E., 2004, PASP, 116, 138
Cherinka B., et al., 2019, AJ, 158, 74
Coccato L., Morelli L., Corsini E. M., Buson L., Pizzella A., Vergani D.,

Bertola F., 2011, MNRAS, 412, L113

Coccato L., Fabricius M. H., Saglia R. P., Bender R., Erwin P., Drory N.,

Morelli L., 2018, MNRAS, 477, 1958
Croom S. M., et al., 2012, MNRAS, 421, 872

MNRAS 000, 1–20 (2022)

Vazdekis A., Sánchez-Blázquez P., Falcón-Barroso J., Cenarro A. J., Beasley
M. A., Cardiel N., Gorgas J., Peletier R. F., 2010, MNRAS, 404, 1639

Vazdekis A., et al., 2015, MNRAS, 449, 1177
Vikram V., Wadadekar Y., Kembhavi A. K., Vĳayagovindan G. V., 2010,

MNRAS, 409, 1379

Vulcani B., et al., 2014, MNRAS, 441, 1340
Willett K. W., et al., 2013, MNRAS, 435, 2835
Worthey G., Faber S. M., Gonzalez J. J., Burstein D., 1994, ApJS, 94, 687
Yan R., et al., 2016, AJ, 152, 197
Zenocratti L. J., De Rossi M. E., Theuns T., Lara-López M. A., 2022, MNRAS,

512, 6164

APPENDIX A: FURTHER EXPLORATION OF THE
EFFECT ON STELLAR POPULATIONS FROM THE FIT
PARAMETERS

In this section, we replot Fig. 11 to compare the stellar populations
derived from spectra extracted using the buddi and MPP-VAC ﬁt
parameters, now colour coding the points according to the ratio of
the 𝑅𝑒 (Fig. A1) and 𝑛 (Fig. A2) values derived by buddi and the
MPP-VAC. Note that the colours for the exponential component in
Fig. A2 correspond to the ratio in the values for 𝑛 for the Sérsic
component since this component has a ﬁxed value for 𝑛.

This paper has been typeset from a TEX/LATEX ﬁle prepared by the author.

20

E. J. Johnston et al

Dimauro P., et al., 2018, MNRAS, 478, 5410
Disney M., Davies J., Phillipps S., 1989, MNRAS, 239, 939
Domínguez Sánchez H., Huertas-Company M., Bernardi M., Tuccillo D.,

Fischer J. L., 2018, MNRAS, 476, 3661

Drory N., et al., 2015, AJ, 149, 77
Du M., Ho L. C., Debattista V. P., Pillepich A., Nelson D., Zhao D., Hernquist

L., 2020, ApJ, 895, 139

Fischer J. L., Domínguez Sánchez H., Bernardi M., 2019, MNRAS, 483,

2057

Fisher D. B., Drory N., 2008, AJ, 136, 773
Fraser-McKelvie A., Aragón-Salamanca A., Merriﬁeld M., Tabor M.,
Bernardi M., Drory N., Parikh T., Argudo-Fernández M., 2018, MN-
RAS, 481, 5580

Gadotti D. A., 2008, MNRAS, 384, 420
Gallazzi A., Charlot S., Brinchmann J., White S. D. M., Tremonti C. A., 2005,

MNRAS, 362, 41

Girardi L., Bressan A., Bertelli G., Chiosi C., 2000, A&AS, 141, 371
Gunn J. E., et al., 2006, AJ, 131, 2332
Guo Q., White S. D. M., 2008, MNRAS, 384, 2
Häußler B., et al., 2013, MNRAS, 430, 330
Häußler B., et al., 2022, arXiv e-prints, p. arXiv:2204.05907
Johnston E. J., Aragón-Salamanca A., Merriﬁeld M. R., Bedregal A. G., 2012,

MNRAS, 422, 2590

Johnston E. J., Merriﬁeld M. R., Aragón-Salamanca A., Cappellari M., 2013,

MNRAS, 428, 1296

Johnston E. J., Aragón-Salamanca A., Merriﬁeld M. R., 2014, MNRAS, 441,

333

Johnston E. J., et al., 2017, MNRAS, 465, 2317
Johnston E. J., Merriﬁeld M., Aragón-Salamanca A., 2018, MNRAS, 478,

4255

Johnston E. J., et al., 2020, MNRAS, 495, 2247
Johnston E. J., et al., 2021, MNRAS, 500, 4193
Kennedy R., et al., 2016, MNRAS, 460, 3458
Lange R., et al., 2016, MNRAS, 462, 1470
Law D. R., et al., 2015, AJ, 150, 19
Law D. R., et al., 2016, AJ, 152, 83
McDermid R. M., et al., 2015, MNRAS, 448, 3484
Meert A., Vikram V., Bernardi M., 2015, MNRAS, 446, 3943
Méndez-Abreu J., Sánchez S. F., de Lorenzo-Cáceres A., 2019a, MNRAS,

484, 4298

Méndez-Abreu J., Sánchez S. F., de Lorenzo-Cáceres A., 2019b, MNRAS,

488, L80

Méndez-Abreu J., de Lorenzo-Cáceres A., Sánchez S. F., 2021, MNRAS,

504, 3058

Morrissey P., et al., 2018, ApJ, 864, 93
Nair P. B., Abraham R. G., 2010, ApJ, 714, L260
Oh S., et al., 2020, MNRAS, 495, 4638
Pak M., Lee J. H., Oh S., D’Eugenio F., Colless M., Jeong H., Jeong W.-S.,

2021, ApJ, 921, 49

Peng C. Y., Ho L. C., Impey C. D., Rix H.-W., 2002, AJ, 124, 266
Peng C. Y., Ho L. C., Impey C. D., Rix H.-W., 2010, AJ, 139, 2097
Pietrinferni A., Cassisi S., Salaris M., Castelli F., 2004, ApJ, 612, 168
Pietrinferni A., Cassisi S., Salaris M., Castelli F., 2006, ApJ, 642, 797
Robotham A. S. G., Bellstedt S., Driver S. P., 2022, MNRAS,
Sánchez-Blázquez P., et al., 2006, MNRAS, 371, 703
Sánchez S. F., et al., 2012, A&A, 538, A8
Sil’chenko O. K., Proshina I. S., Shulga A. P., Koposov S. E., 2012, MNRAS,

427, 790

Simard L., Mendel J. T., Patton D. R., Ellison S. L., McConnachie A. W.,

2011, ApJS, 196, 11

Smee S. A., et al., 2013, AJ, 146, 32
Stoughton C., et al., 2002, AJ, 123, 485
Tabor M., Merriﬁeld M., Aragón-Salamanca A., Cappellari M., Bamford

S. P., Johnston E., 2017, MNRAS, 466, 2024

Tabor M., Merriﬁeld M., Aragón-Salamanca A., Fraser-McKelvie A., Pe-
terken T., Smethurst R., Drory N., Lane R. R., 2019, MNRAS, 485,
1546

MNRAS 000, 1–20 (2022)

BUDDI-MaNGA I

21

Figure A1. As for Fig. 11, but colour coded according to the ratio of the 𝑅𝑒 values derived by buddi relative to those in the MPP-VAC.

Figure A2. As for Fig. 11, but colour coded according to the ratio of the 𝑛 values derived by buddi relative to those in the MPP-VAC. Note that in the case of
the exponential component, the ratio of the Sérsic indices actually corresponds to those of the Sérsic component.

MNRAS 000, 1–20 (2022)

0.1110Age from PyMorph fit (Gyrs)0.1110Age from BUDDI fit (Gyrs)SS0.1110Age from PyMorph fit (Gyrs)0.1110Age from BUDDI fit (Gyrs)SEExponential0.1110Age from PyMorph fit (Gyrs)0.1110SESersic2.01.51.00.50.00.5[M/H] from PyMorph fit2.01.51.00.50.00.5[M/H] from BUDDI fitSS2.01.51.00.50.00.5[M/H] from PyMorph fit2.01.51.00.50.00.5[M/H] from BUDDI fitSEExponential2.01.51.00.50.00.5[M/H] from PyMorph fit2.01.51.00.50.00.5SESersic0.00.51.01.52.02.53.0ReBUDDI/ReMPPVAC0.1110Age from PyMorph fit (Gyrs)0.1110Age from BUDDI fit (Gyrs)SS0.1110Age from PyMorph fit (Gyrs)0.1110Age from BUDDI fit (Gyrs)SEExponential0.1110Age from PyMorph fit (Gyrs)0.1110SESersic2.01.51.00.50.00.5[M/H] from PyMorph fit2.01.51.00.50.00.5[M/H] from BUDDI fitSS2.01.51.00.50.00.5[M/H] from PyMorph fit2.01.51.00.50.00.5[M/H] from BUDDI fitSEExponential2.01.51.00.50.00.5[M/H] from PyMorph fit2.01.51.00.50.00.5SESersic0.00.51.01.52.02.53.0nBUDDI/nMPPVAC