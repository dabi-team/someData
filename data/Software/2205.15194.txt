Exploring Bifurcations in Bose-Einstein Condensates via Phase Field Crystal Models

A. B. Steinberg,1, a) F. Maucher,2, b) S. V. Gurevich,1, 3, c) and U. Thiele1, 3, d)

1)Institut für Theoretische Physik, Westfälische Wilhelms-Universität Münster,

Wilhelm-Klemm-Strasse 9, 48149 Münster, Germany

2)Departament de Física, Universitat de les Illes Balears & IAC-3, Campus UIB,

E-07122 Palma de Mallorca, Spain

3)Center of Nonlinear Science (CeNoS), Westfälische Wilhelms-Universität Münster,

Corrensstrasse 2, 48149 Münster, Germany

(Dated: 31 May 2022)

To facilitate the analysis of pattern formation and of the related phase transitions in Bose-

Einstein condensates (BECs) we present an explicit approximate mapping from the nonlo-

cal Gross-Pitaevskii equation with cubic nonlinearity to a phase ﬁeld crystal (PFC) model.

This approximation is valid close to the superﬂuid-supersolid phase transition boundary.

The simpliﬁed PFC model permits the exploration of bifurcations and phase transitions via

numerical path continuation employing standard software. While revealing the detailed

structure of the bifurcations present in the system, we demonstrate the existence of local-

ized states. Finally, we discuss how higher-order nonlinearities change the structure of the

bifurcation diagram representing the transitions found in the system.

2
2
0
2

y
a
M
0
3

]
S
P
.
n
i
l
n
[

1
v
4
9
1
5
1
.
5
0
2
2
:
v
i
X
r
a

a)ORCID: 0000-0001-6598-9700
b)ORCID: 0000-0002-5808-3967
c)ORCID: 0000-0002-5101-4686
d)ORCID: 0000-0001-7989-9271;

Electronic mail: u.thiele@uni-muenster.de; http://www.uwethiele.de

1

 
 
 
 
 
 
The formation of patterns in Bose-Einstein condensates (BECs) has been of great interest in

recent years, but their description through nonlinear integro-differential equations makes

detailed analyses tedious. An approximation in the vicinity of the superﬂuid-supersolid

phase transition boundary in the form of a phase ﬁeld crystal (PFC) model allows us to

investigate the bifurcation structure and existence regions of different patterns. Of partic-

ular interest are localized states, which are commonly investigated for PFC-type models,

but have rarely been discussed for Bose-Einstein condensates. Furthermore, we discuss how

high-order nonlinearities affect the structure of the underlying transitions.

I.

INTRODUCTION

The formation of patterns and structures has always captivated scientists from a broad range of
physical disciplines1,2 with topics reaching from the dendritic structure of snowﬂakes3 to patterns
of well deﬁned length scales in reaction-diffusion systems or in morphogenesis.4 A particular uni-

versal model to describe formation of regular patterns in various systems is the Swift-Hohenberg
equation.5 It was originally formulated for Rayleigh–Bénard convection but also arises in a num-
ber of chemical,6 ecological7 and optical8 systems, as well as for elastic materials9 to name just a

few.

Five decades ago speculations on a quantum state of matter featuring discrete translational

symmetry whilst maintaining a large superﬂuid fraction brought together traditional pattern forma-
tion and quantum physics communities.10–12 These states of matter are referred to as supersolids.

At ﬁrst, the realisation of such a phase remained elusive. However, recent pioneering experi-
ments13,14 involving dipolar Bose-Einstein condensates (BECs) revealed that beyond-mean ﬁeld

contributions describing quantum-ﬂuctuations can lead to a stabilization, a fact that is also true for
mixtures of BECs.15,16 Ultimately, ultracold dipolar quantum gases turned out to be excellent ex-
perimental platform to explore supersolidity.13,14,17–24 Here, we take a step back for simplicity and

to furthermore complement the discussions on the corresponding dipolar system. In particular, we
employ a commonly adopted prototypical toy model of soft-core bosons,25–30 which approximates

the interaction that is realized when off-resonantly optically coupling to highly excited Rydberg
states25,31 via Rydberg-blockade.32 Here, we primarily seek to present the method rather than to

connect it to speciﬁc physical systems.

2

In order to include supersolidity into the frame of the well-established ﬁeld of pattern-formation

we ﬁrst derive an approximate mapping valid at the superﬂuid-supersolid phase transition of the

nonlocal Gross-Pitaevskii equation (GPE) to a so-called conserved Swift-Hohenberg (SH) equa-
tion, also referred to as phase ﬁeld crystal (PFC) model,33–35 which only involves local nonlinear-

ities (cf. Sec. II). This mapping is sufﬁciently general to be applicable to other settings involving

nonlocal nonlinearities. For example, there are a range of optical systems that are also approxi-
mately governed by nonlocal nonlinearities and are suspected to give rise to pattern formation.36,37
This idea has already been formulated and explored,38 however, here we propose an alternative

mapping that aims at approximating the behavior of the nonlocal GPE close to the phase transition

to modulated states.

Our approach permits, on the one hand, the employment of well-established methods for nu-
merical path continuation39,40 and, on the other hand, potential synergies of concepts. One such

synergy is the concept of localized states that thus far has not yet been explored in depth in the

context of BECs. Localized states refer to a situation in which there is a ﬁnite patch of one pattern

co-existing with a background of another state, often a uniform one. In the context of phase transi-
tions they occur in parameter regions of phase coexistence.41,42 Localized states display distinctive

features that are independent of the individual examples, such as a bifurcation diagram featuring a
snakes-and-ladders structure, alternately referred to as ’homoclinic snaking’.43,44 Employing nu-
merical path continuation using, e.g., the package PDE2PATH,45 permits one to trace out unstable

states as well as stable ones. This allows for a comprehensive exploration of the structure of bi-

furcation diagrams. As the method is numerically challenging it remains elusive for the nonlocal

GPE. Our aim here is to employ it for the local approximation and to explore the advantages and

limitations of this approach.

This paper is organized as follows: In Sec. II we start with the mapping of the GPE onto a PFC

type model. This is done for an arbitrary interaction in Sec. II A. Next, in Sec. II B, we specify the

interaction that is subsequently employed. Sec. II C brieﬂy explains the used numerical methods

while Sec. II D discusses the validity of the approximated model for the nonlocal GPE. Sec. III

presents bifurcation diagrams for one- and two-dimensional systems including branches of stable

and unstable patterned and localized states. In Sec. IV we add a higher order nonlinearity to the

model and subsequently discuss linear stability (Sec. IV A) as well as the resulting changes in the

bifurcation diagram (Sec. IV B). Finally, in Sec. V, we summarize and conclude.

3

II. MAPPING THE NONLOCAL GPE TO A PFC MODEL

A. Governing Equations and Mapping

On the mean-ﬁeld level the dynamics of a BEC is described by a nonlocal GPE for a com-

plex scalar ﬁeld Ψ = Ψ(r,t), where the long-range interaction between the bosons gives rise to a
convolution. The nonlocal GPE can be written in rescaled form as46,47
(cid:18)

(cid:19)

i∂tΨ =

−

(cid:90)

∆ +

1
2

dr(cid:48)

2R(r
Ψ(r(cid:48))
|
|

r(cid:48))

Ψ .

−

(1)

Here, R reﬂects both, long-range interatomic interactions and short-range interactions due to s-

wave scattering. As only the product between the amplitude of R (i.e., the interaction strength)
2 enters, one can absorb the amplitude of the long-range part of R into the mean
Ψ
|
|

and the density
density. Therefore, throughout this paper we use ¯ρ = 1
V

2dnr as a free parameter.
Ψ
|
|

(cid:82)

We would like to approximate Eq. (1) around the phase transition in a way that does not involve

a convolution. To approach this problem let us start by writing the corresponding dispersion
relation (or excitation spectrum in the superﬂuid phase),48 given by

ω 2(k) =

k2
2

(cid:18)k2
2

(cid:19)

+ 2 ¯ρ ˆR(k)

,

(2)

where ˆR(k) is the Fourier transform of R(r

r(cid:48)). We expect the dispersion relation to show a

−

classical “maxon-roton structure”, i.e., starting from ω = 0 at k = 0 it ﬁrst has a maximum, the

“maxon”, and then a minimum, also called “roton minimum” (see, e.g., Fig. 1 (a)). The roton

minimum indicates the onset of linear instability for the uniform state as at the corresponding

wave number the dispersion relation ﬁrst crosses zero.

We can introduce the critical values ¯ρc and kc, corresponding to the linear stability threshold of

(cid:12)
the uniform state via ω 2(kc) = 0 and
(cid:12)k=kc
dispersion relation Eq. (2) at the phase transition (kc, ¯ρc) using a Taylor series ˆR(T )(k):

= 0. Our goal is to match approximately the given

∂ ω 2
∂ k

ˆR(T )(k) = g0 + g2k2 + g4k4

with the corresponding dispersion relation

ω 2(T ) =

k2
2

(cid:18)k2
2

+ 2 ¯ρ ˆR(T )

(cid:19)

.

(3)

(4)

In analogy, one can introduce k(T )

c

via ω 2(T )(k(T )

c

) = 0 and

∂ ω 2(T )
∂ k

(cid:12)
(cid:12)k=k(T )

c

= 0. To proceed we have

to ﬁx the three free parameters (g0, g2, g4) in an appropriate manner. As we want to approximate

4

the behavior close to the linear stability threshold a reasonable request for the function ω 2(T ) is

that it should feature the same critical wavenumber kc, the same critical density ¯ρc, and the same

curvature in the roton minimum

given by

∂ 2ω 2
∂ k2

(cid:12)
(cid:12)k=kc

. This can be realized by solving the set of equations

c

kc = k(T )
,
¯ρc = ¯ρ (T )

,

∂ 2ω 2
∂ k2

(cid:12)
(cid:12)k=kc

=

c
∂ 2ω 2(T )
∂ k2

(cid:12)
(cid:12)k=k(T )

c

.

(5)

(6)

(7)

Independently of the speciﬁcs of the long-range interaction, the formal solution of this set is given

by

2 ˆR(kc)

,

c ∂kk ˆR(kc)
k2
−
8
ˆR(kc)
−
k2
c

2g0

g0 =

g2 =

g4 =

−
g0
k4
c

c ∂kk ˆR(kc)
k2
−
4k2
c

=

−

6 ˆR(kc)

,

.

(8)

This differs from the approach in Ref. 38, where ˆR(k) is approximated based on its form up to

the ﬁrst minimum. These approaches are similar to gradient expansions of the linear term when
deriving PFC models49 or to the weakly nonlocal limit in the context of optics.50

The approximated version of Eq. (1) now reads:

i∂tΨ =

(cid:18)

−

1
2

∆ + g0

2
Ψ
|
|

2 + g4∆2
g2∆
Ψ
|
|

2
Ψ
|
|

−

(cid:19)

Ψ .

(9)

As the set (g0, g2, g4) is ﬁxed by Eq. (8), this equation only depends on the same parameter ¯ρ as

before and g0, g2, g4 are uniquely determined by the geometry of the potential.

Through a Madelung transformation,51,52 Ψ = √ρeiϕ and separating real and imaginary parts

we can rewrite Eq. (9) in the following fashion:

∂tϕ =

(cid:20)∆ρ
4ρ −

(∇ρ)2
8ρ 2 −

(∇ϕ)2

2 −

(cid:0)g0ρ

−

(cid:21)
g2∆ρ + g4∆2ρ(cid:1)

,

∂tρ =

∇

−

·

(ρ∇ϕ) .

(10)

(11)

An equation for steady states (including the ground states) is obtained employing the ansatz ϕ =

µt, implying ∇ϕ = 0 and ∂tϕ = µ. It reads

µ =

(cid:20)∆ρ
4ρ −

(∇ρ)2
8ρ 2 −

(cid:0)g0ρ

−

(cid:21)
g2∆ρ + g4∆2ρ(cid:1)

.

(12)

5

To describe a dissipative approach to these states we follow appendix D.1 of Ref. 38 and employ

a dissipative, locally density-conserving dynamics, i.e., we use a continuity equation ∂tρ =

∇

−

j

·

as Eq. (11) but using the ﬂux j = ∇µ. The resulting kinetic equation reads
(cid:18)(∇ρ)2

(cid:19)

∂tρ = ∆

(cid:20)1
2

∆ρ
2ρ

+ (cid:0)g0ρ

−

4ρ 2 −

(cid:21)
g2∆ρ + g4∆2ρ(cid:1)

.

(13)

An alternative to the outlined approach to ﬁnd groundstates is called "complex/imaginary" time

evolution (see e.g., Ref. 53), which employs a Wick-rotation t

it and renormalizes of the

→ −

wavefunction after each propagation step. Note that the resulting Eq. (13) corresponds to a PFC
model34,35 with an amended energy functional. Then, µ takes the role of a chemical potential.

At this point we rescale the governing equation (13) to obtain the conventional form for con-

served SH-type equations – apart from the peculiar form of the nonlinearity – via

(cid:114)

g2
2g4

,

,

−
4g4
g2
2
g2)
(
−
2

.

r

t

r(cid:48)

t(cid:48)

→

→

ρ

→

ρ (cid:48)

Using Eqs. (14)-(16) and dropping the primes we ﬁnd

∂tρ = ∆

(cid:20)(∇ρ)2

8ρ 2 −

∆ρ
4ρ

+ (αu + 1)ρ + 2∆ρ + ∆2ρ

(cid:21)

,

where we use the same interaction parameter

αu =

4g0g4
g2
2 −

1

(14)

(15)

(16)

(17)

(18)

as in Ref. 38. In the following, αu will be a crucial parameter, so we add the convenient formula

αu(kc, ¯ρc) =

(cid:0)k2
(cid:0)k2

c ∂kk ˆR(kc)
c ∂kk ˆR(kc)

−

−

2 ˆR(kc)(cid:1)2
6 ˆR(kc)(cid:1)2 −

1 .

(19)

It stems from Eqs. (8) and directly links Eq. (17) with the original Eq. (1).

For an appropriate mapping it is important to restrict the range of αu to values that are in the

interval [

1, 0]. For smaller values, amplitudes become excessively large and lead to unphysical

−

negative densities. For the interactions considered here, αu < 0 follows naturally.

Written in gradient dynamics form, Eq. (17) reads

∂ ρ
∂t

= ∆

δ F
δ ρ

,

6

(20)

where the chemical potential is deﬁned as the functional derivative

µ =

δ F
δ ρ

of the free energy functional

F[ρ] =

(cid:90)

(cid:20)

V

2
∇ρ
|
|
4ρ

1
2

+ (αu + 1)ρ 2 + 2ρ∆ρ + ρ∆2ρ

(cid:21)

dnr .

(21)

(22)

Note, that we use the notion of a "free energy" despite the temperature dependence being sup-

pressed. In our case, it stems from the fact that imposing ∇ϕ = 0 for Eq. (12) implies that we

consider dissipative pseudo dynamics and adopt the vocabulary of soft-matter physics.

The corresponding grand potential density is Ω/V with

Ω = F

(cid:90)

−

µρdnr.

(23)

Both, µ and Ω/V are important for the investigation of the existence of coexisting states at phase

transitions.

B. Soft-core Bosons and their Dispersion Relation

In the following, we consider a Heaviside step function Θ(1

as prototypical
toy model for soft-core interactions25,27,28 and a delta function δ (r) to describe s-wave scattering,

r) with r =

r
|
|

−

hence

−
Here, a corresponds to the rescaled scattering length, and the strength of the long-ranged inter-

R(r) = Θ(1

r) + aδ (r) .

(24)

action has been absorbed in the mean density. We employ this particularly simple interaction to

conveniently illustrate the method. We do not discuss the subject of collapse that can occur for
attractive scattering length, as it has been discussed elsewhere in depth.5455 Here, we merely use

the scattering length to deform the dispersion relation.

The resulting dispersion relation Eq. (2) and its approximation Eq. (4) are compared in Fig. 1.

When evaluating Eqs. (8) it has to be noted that they are implicit expressions: kc and ¯ρc depend

parametrically on a and have to be found from Eq. (2). We ﬁnd




ˆR(k) =

2 sin(k)
k
J1(k)
k

2π



7

+ a ,

1D

+ a , 2D

(25)

FIG. 1. Comparison between the exact model [Eq. (1)] and its approximation [Eq. (9) or Eq. (17)]. (a)

Dispersion relations given by Eq. (2) (solid lines) and the approximation (4) (dashed lines) at the onset of

the modulational instability. One- (1D) and two-dimensional (2D) cases are represented in red/orange and

blue/purple, respectively (see legend). Also given are the dependencies of the (b-c) critical wavenumber kc

and the (e-f) critical density ¯ρc on the rescaled scattering length a. Panel (d) shows the dependency of αu on

a. The two axis on the left and right of panels (b,c,e,f) relate to the unscaled and scaled system, respectively.

As the scaling is nonlinear for both, ¯ρc and kc, the right axis is nonlinear.

where J1(k) is the Bessel function of the ﬁrst kind. It is instructive to compare the dispersion

relations of the approximated model Eq. (4) and the original model Eq. (2). Figure 1 (a) compares

such relations in the cases of one-dimensional (1D) and two-dimensional (2D) systems. By con-

struction, wavenumber kc and density ¯ρc perfectly match while features like the curvature at k = 0

and characteristics of the maximum deviate. Figures 1 (b) to (f) furthermore show, how kc, ¯ρc and

αu depend on the rescaled scattering length a. Before we proceed in the discussion of the validity

of the approximated model in section II D, we comment on the employed numerical methods.

8

24k0100ω2(a)1D2D1Dapproximation2Dapproximation3.54.0k0c(b)0.840.90.96kc4.55.0k0c(c)0.880.920.96kc−0.50.0a−0.4−0.2αu(d)102030¯ρ0c(e)0.51.32.1¯ρc−0.50.0a2550¯ρ0c(f)0.61.83.0¯ρcC. Numerical Methods

The ground state, i.e., the steady state with minimal energy of the GPE (1) and its approxi-

mation [Eq. (9)] can be obtained via direct numerical simulations using Fourier split-step method

combined with the so-called complex time evolution. The latter consists in converting the orig-

inal equation in a diffusion-type equation via a Wick rotation of the time coordinate, t

it

→ −

and renormalizing the norm after each step. In particular, the Fourier split-step method implies

that the corresponding Hamiltonian is split, according to the Baker–Campbell–Hausdorff formula,

into a linear kinetic part that is diagonal in Fourier space and a nonlinear part that is diagonal in

real space. However, this method only gives access to stable ground states and does not permit

calculating unstable any solution branches.

While the results based upon direct numerical integration allow one to obtain basic estimates

of the stability range for a generic parameter set, a full bifurcation study of the system is still

lacking. In order to track the pertinent states in parameter space we employ numerical pseudo-
arclength continuation methods.39,40 They trace branches of steady states through parameter space

employing a combination of tangent predictor steps and correction steps using Newton’s method.
Here, we use path continuation employing the package PDE2PATH.45

Normally, we employ periodic boundary conditions (BC) implying a valid continuous trans-

lational symmetry. Mean density and phase conservation are enforced via auxiliary conditions.

The latter account for the continuous symmetries where the auxiliary conditions prevent a mo-
tion along the corresponding group orbit during continuation.40 To improve the performance of

the path continuation in the 2D case, we choose domain geometry and size that match a speciﬁc

pattern symmetry. Occasionally, the periodic 2D domain can be further reduced by exploiting the

symmetry of the pattern that is traced. For instance, a square pattern in a square domain may be

considered in a domain one forth of the original size by employing Neumann BC that also au-

tomatically enforce the phase conditions for translation. However, bifurcations which break that

symmetry can no longer be detected.

D. Validity of the Approximated Model

In the following, we compute the ground states and their phase transition from uniform to

modulated states for R(r) = Θ(1

−

r) (i.e., for a = 0) for both, Eq. (1) and Eqs. (9) [or Eq. (17)] to

9

probe the validity of the approximation. As path continuation now allows us to trace out unstable

solutions of the approximated model, we will add them to the bifurcation diagrams as well.

Figure 2 shows the resulting bifurcation diagram for steady states in 1D and 2D in dependence

of the mean concentration ¯ρ. The states are characterized by the contrast

C =

ρmin
ρmax
−
ρmax + ρmin

,

(26)

where zero contrast represents a uniform superﬂuid state. As expected, the linear stability thresh-

olds exactly agree, e.g., ¯ρ (cid:48)c = 10.5 for the 1D case. Consistently between exact model and approx-
imation, the primary bifurcation at ¯ρc, is supercritical in 1D and subcritical in 2D. In consequence,

in 1D the weakly and fully nonlinear behaviors ﬁrst closely agrees and then quantitatively devi-

ates further from the threshold once the amplitude of the density wave increases. The difference is

about 20% at the right hand side end of the diagram in Fig. 2 (a). In the 2D case, the linear stability

threshold is at ¯ρ (cid:48)c = 14.7 where the branch of patterned states subcritically emerges, leading to a
region of bistability (not to be confused with thermodynamic coexistence which would indicate

localized states). Note that the unstable states on the subcritical part of the branch can be obtained

by path-continuation but not by time simulation. Here, we are only able to employ continuation

for the approximate, i.e., local model, but not for the exact, i.e., nonlocal model. For the latter

we can only employ time simulations to calculate stable states, i.e., the states beyond the stabi-

lizing saddle-node bifurcation. Therefore, the subcritical part where we expect good agreement

unfortunately can not be compared. As the saddle-node bifurcation occurs in the fully nonlinear

regime, there is an appreciable deviation (of about 10% in absolute terms) between its positions in

the exact and approximate model [see Fig. 2 (b)]. Note, that Ref. 49 also points out several closely

related consequences of applying such an approximation to dynamic density functional theory,

such as changes to the phase boundaries and regions without physical solutions.

III. PERIODIC PATTERNS AND LOCALIZED STATES

In this section we will explore different types of periodic patterns as well as localized states

supported by the approximated model (9) mainly in the 2D case. However, we will start with a

brief discussion of the 1D case.

10

FIG. 2. Comparison between steady states of the GPE [Eq. (1), blue line] and its approximation [Eq. (17)

or (9), red line]. The contrast C [Eq. (26)] is shown for (a) 1D and (b) 2D systems as a function of the mean

density ¯ρ and ¯ρ

. The domain size correspond to multiple of 2π/kc. The black ﬁlled circle indicates the
(cid:48)

linear stability threshold [cf. Fig. 1 (b-d)].

1. One-dimensional results

In one spatial dimension and with a cubic nonlinearity in Eqs. (1) and (9) the bifurcation

between a uniform perfect superﬂuid and a modulated state is typically supercritical (see Ap-

pendix B) as illustrated in the corresponding example in Fig. 2(a).

In case of a transition between states in a system without mass conservation the terms “second

order” and “supercritical bifurcation” are synonymous. However, there are systems with mass

conservation that show supercritical bifurcations in a bifurcation diagram with mean density as

control parameter, but still feature ﬁrst order phase transitions and coexistence of states. This

statement might seem contradictory, however, its validity rests in the fact that coexisting states

11

10.511.011.512.012.513.013.5¯ρ00.800.850.900.951.001.051.100.00.5C(a)NonlocalGPEApproximation12.513.013.514.014.50.900.951.001.051.10¯ρ0.00.51.0C(b)unstableLinearStabilityBorderFIG. 3. The grand potential density Ω/V is given as a function of the chemical potential µ for the patterned

and uniform states in the approximated 1D case of Fig. 2 (a). Modulated and uniform states are given as red

and black lines, respectively. Solid and dashed lines refer to stable and unstable states, respectively. As the

lines do not cross, uniform and modulated states do not coexist and no localized states exist.

normally represent different mean densities, i.e., are located at different values of the control

parameter. A direct consequence of such coexisting states is the possible presence of localized

states. Such a presence can than be taken as indicative for the existence of a ﬁrst order transition.

To assess this possibility, one has to check in detail whether states of identical chemical potential µ

and grand potential Ω but different mean density exist. These are then the states coexisting in the
thermodynamic limit. A well analyzed example is provided by the phase ﬁeld crystal model.35,41,42

To test this condition, we plot the grand potential density Ω/V as a function of the chemical

potential µ for the branches of uniform and patterned states in Fig. 3 obtained with the approxi-

mated model presented in Fig. 2 (a). For the coexistence of the patterned and the uniform phase a
crossing of the curves for two different stable states is required.41 As such a crossing does not oc-

cur, we conclude that in the considered parameter region, the transition is indeed of second order.
This also implies that no localized states can be expected.56

12

12131415µ−8.0−7.5−7.0−6.5−6.0−5.5Ω/Vuniformstableuniformunstablemodulatedstable2. Results in Two Dimensions

To determine patterns in two dimensions and their ranges of stability as a function of ¯ρ, we

use pseudo-arclength continuation at different ﬁxed values of αu. Thereby, the domain size is

optimized for a hexagonal pattern with the critical wavenumber kc. The corresponding length is
Lc = 2π
kc

Ly = 2
√3
particular, to accurately predict the stability of the stripe phase and related secondary bifurcations.

2Lc. Note that periodic BC are required, in

resulting in the domain size Lx

Lc

×

×

Neumann BC do not allow for certain changes of symmetry, resulting in missing unstable modes
and therefore bifurcations.57

Examples of the different occurring patterns are shown in Fig. 4. In particular, we present up-

hexagons (hexagonal pattern of peaks Fig. 4 (a)), a honeycomb or down-hexagon pattern (hexag-

onal pattern of holes Fig. 4 (b)), stripe pattern (Fig. 4 (c)) and a rectangular pattern of peaks

(Fig. 4 (d)). The latter is a consequence of the rectangular domain allowing for hexagons. On a

square domain, these would become square patterns, but no ideal hexagonal patterns would exist.

Figure 5 presents the resulting bifurcation diagram in the ( ¯ρ, C)-plane obtained at αu =

0.4.

−

The critical wave vector is kc = 0.88 leading to Lc = 7.14. One can see that the uniform state

undergoes a primary bifurcation at the expected critical value of ¯ρc = 0.555. At this transcritical

bifurcation, coming from low densities, the stable uniform state loses stability and the unstable

hexagon branch (blue line) at ¯ρ < ¯ρc becomes the honeycomb branch (purple line) at ¯ρ > ¯ρc that

is also unstable. The hexagon branch passes a saddle-node bifurcation at ¯ρ = 0.498 (where it

stays unstable, but with fewer unstable modes) and turns back towards larger mean densities. It

stabilizes at a pitchfork bifurcation at ¯ρ = 0.512, i.e., below ¯ρc. This implies that there exists

some hysteresis that in practice can lead to a jump in the amplitude typical for a ﬁrst order phase

transition.

In addition to the hexagon/honeycomb branches an unstable branch of stripe patterns (red line)

also emerges at the primary bifurcation. When ignoring all other lines the bifurcation would be

classiﬁed as a supercritical pitchfork. In the considered ﬁnite rectangular domain, the branch of

rectangular patterns (orange line) emerges in a subcritical pitchfork bifurcation from the branch of

stripes. Both are always unstable. Note that in an inﬁnite system it would correspond to a branch

of square patterns and also emerge from in the primary bifurcations.

As in the 1D case we test the stable states for thermodynamic coexistence by plotting in Fig. 6

the grand potential density Ω/V as a function of the chemical potential µ for the corresponding

13

FIG. 4. Patterns occurring in a two-dimensional system at αu =

0.4: (a) hexagon, (b) honeycomb, (c)

−

stripe (d) rectangle and (e) localized state corresponding to a patch of patterned state in background of

uniform ground state. The domain sizes Lx

Ly are (a)-(d) 2
√3

Lc

×

×

2Lc and (e) 16Lc/√3

2Lc.

×

branches. Indeed this time, in contrast to the 1D result, the corresponding lines cross indicating

that stable uniform state and stable hexagonal pattern can coexist in an inﬁnite domain. Note that

the corresponding states have different densities and are marked in the bifurcation diagram Fig. 5

by two ﬁlled blue circles. This indicates that at a sufﬁciently large domain size the system exhibits

localized states, for instance, for a domain size 16Lc/√3

2Lc given by the gray line in Fig. 5.

×

A corresponding proﬁle is given in Fig. 4 (e). Note that this localized state is only localized in

x-direction, while it is periodic in y-direction. In case of a small 2D system which cannot host

localized states, the hexagons stabilize directly at their saddle-node bifurcation, while the jump to

the hexagons as the energetically favored state occurs at ¯ρ = 0.505.

Coming back to the branch of localized states in Fig. 5 we notice that it does not seem to exhibit
the expected typical snaking behaviour found, e.g., in the PFC model.41 This is also the case for

larger domain sizes of up to 24Lc/√3

×

2Lc where one would usually ﬁnd pronounced snaking

behaviour (see, e.g., Ref. 58). However, Ref. 35 shows that in the PFC model a larger effective

14

−303−505y(a)−303(b)−303(c)−303(d)−20020x−505y(e)ρminρmaxFIG. 5. Bifurcation diagram of the steady state solutions in 2D of Eq. 17 as a function of ¯ρ at ﬁxed

αu =

0.4. The domain sizes are as in Fig. 4. The solutions are characterized through the contrast C [see

−

Eq. (26)]. Solid and dotted lines represent stable and unstable states, respectively. The respective patterns

are indicated at the curves. The two ﬁlled blue circles represent stable states coexisting in a inﬁnite domain

(identical grand potential and chemical potential (see Fig. 6). This indicates the range where localized states

(grey line) may, in principle, exist.

temperature eventually destroys the pronounced snaking that involves saddle-node bifurcations of

the branches of localized states. The number of peaks still changes when going along the branch,

however, all saddle-node bifurcations have been annihilated. We believe that in the present case

the value of αu is too high for snaking to be found. Indeed, lowering αu leads to steeper transitions

between the uniform background and the patterned part within the localized states. However, as

the system reacts very sensitively to a decrease in αu, we are not able to lower it signiﬁcantly

15

0.4750.5000.5250.5500.5750.6000.625¯ρ0.00.20.40.60.81.0Cuniformhexagonshoneycombstripesrectangleslocalizedhexagonsmultistablitythermodynamiccoexistenceregionstableunstabletherm.coexistenceFIG. 6. The grand potential density Ω/V as a function of the chemical potential µ for the branches of

hexagonal patterns (blue lines) and uniform states (black lines) is shown for the 2D case in Fig. 5. The

crossing of the lines marked by a ﬁlled circle indicates that these states can coexist and localized states may

exist. The coexisting states are also marked in Fig. 5.

further due to the occurrence of negative densities that result in a break down of the numerical

procedure. Finally, the lack of a second branch of localized states with an even number of lines of

peaks (cf. Fig. 15 (d) of Ref. 41) is due to the numerical limitation of the size of the box and the

choice of Neumann BC [Fig. 4 (e)].

Further increasing the value of the interaction parameter to αu =

0.216 and αu =

−

0.113

−

results in the bifurcation diagrams shown in Figs. 7 (a) and 7 (b), respectively. First, inspecting

Fig. 7 (a) and comparing it to Fig. 5 one notes that the branch of localized states does not exist any-

more. In consequence, the hexagonal patterns become linearly stable directly at the saddle-node

bifurcation. The bifurcation from the stripe state to the rectangles is replaced by a supercritical

pitchfork bifurcation resulting in states that transform the stripes into an unstable superlattice-

like pattern, namely, a rectangular arrangements of peaks with these rectangles being situated on

a hexagonal lattice. This is allowed for by the Neumann BC applied to the same domain size as

16

0.2780.2800.2820.2840.2860.2880.290µ−0.070−0.069−0.068−0.067−0.066−0.065−0.064Ω/VunstablestablethermodynamiccoexistenceFIG. 7. Bifurcation diagrams of steady states of Eq. 17 in 2D as a function of ¯ρ at ﬁxed (a) αu =

0.216

−

and (b) αu =

0.113. The domain size is 2Lc/√3

−

×

2Lc. Solution measure, line styles, markers and pattern

types are as in Fig. 5. The purple line in (a) corresponds to a superlattice-like pattern, namely, a rectangular

arrangement of peaks with these rectangles being located on a hexagonal lattice

17

1.01.11.21.31.41.5¯ρ0.00.20.40.60.81.0C(a)uniformhexagonshoneycombstripesstableunstabletherm.coexistence2.02.12.22.32.42.5¯ρ0.00.20.40.60.81.0C(b)uniformhexagonshoneycombstripesstableunstabletherm.coexistencebefore used with the periodic BC. This effectively corresponds to a doubled domain size with peri-
odic BC.59 The second length scale present in the superlattice pattern is not intrinsic to the model,

but reﬂects the domain size. In other words, the conﬁnement creates defects in the pattern that

are then repeated periodically due to the boundary condition. The bifurcation’s relative distance

to the primary bifurcation is slightly larger than at αu =

0.4. Second, focusing on Fig. 7 (b), the

−

picture has simpliﬁed as an increase in αu rapidly moves the secondary bifurcation on the branch

of stripes towards large densities outside the ¯ρ-range of Fig. 7.

In both cases, the primary bifurcation occurs at the expected value, namely, at ¯ρ = 1.09 and

¯ρ = 2.15 in Fig. 7 (a) and (b), respectively. The saddle-node bifurcation on the branch of hexagonal

patterns are at ¯ρ = 1.99 and ¯ρ = 0.99, respectively, i.e., with increasing ¯ρ it moves further away

from the primary bifurcation (in terms of relative density).

Summarizing, one may say that the range of bistability of hexagons and the uniform state

increases with increasing interaction parameter αu. However, in contrast to this the actual range of

thermodynamic coexistence between the two states shrinks with increasing αu as indicated by the

decreasing density difference between the respective two ﬁlled circles in Figs. 5, 7 (a) and 7 (b) that

indicate the coexisting states, i.e., the positions of the binodals. Also note that for the two larger

αu both respective binodal densities are in the density range where the uniform state is linearly

stable. Thermodynamically speaking, the spinodal does not lie between the binodals. This is in
contrast to PFC results35,41 and resembles the behaviour encountered in density functional theories

of colloidal crystallization (cf. Fig. 2 of Ref. 60).

Even for a narrow coexistence region one would still expect localized states to exist. We believe

that they could only be found for the parameters in Fig. 7(b) if a much larger domain size was used

as at present possible for us. In accordance with Ref. 35 the increase in αu leads to wider fronts

between the pattern and the uniform state implying the need for larger domains.

IV. HIGHER-ORDER NONLINEARITIES

In the context of dipolar BECs it has been shown that deep quantum effects, so-called quan-
tum ﬂuctuations,61 can lead to qualitative changes in the stability properties of the accessible
patterns.62–64 Furthermore, they can give rise to qualitative changes in the character of the phase
transition: The hexagonal crystallisation into a supersolid can be of second order62 in contrast to

the ﬁrst order transition described above. Here, we qualitatively explore features facilitated by a

18

phenomenological addition of a higher-order nonlinearity to the equation of motion. This shall al-

low for an improved understanding of the emergence of the different phases and of accompanying

changes in the bifurcation diagram. Note, however, that for illustration purposes the parameter val-

ues we consider are signiﬁcantly larger than the values one would obtain in an actual computation

of beyond mean-ﬁeld corrections for the speciﬁc interaction considered here.

The considered nonlinearity has the form

3Ψ with prefactor b > 0. Our (rescaled) governing
Ψ
|
|

equation (9) of motion is modiﬁed to

i∂tΨ =

(cid:18)

−

∆
2

+ (αu + 1)
Ψ
|

2 + 2∆
|

2 + ∆2
Ψ
|
|

Ψ
|

2 + b
|

3
Ψ
|
|

(cid:19)

Ψ.

(27)

The free energy functional deﬁned by Eq. (22) as well as the steady state equation (13) are modiﬁed

accordingly. We have

and

F =

(cid:90)

V

dnr

(cid:20)

2
∇ρ
|
|
8ρ

+ b

2
5

ρ 5/2 +

(αu + 1)
2

ρ 2 + ρ∆ρ +

(cid:21)

∆2ρ

ρ
2

∂tρ = ∆

(cid:20)(∇ρ)2

8ρ 2 −

∆ρ
4ρ

+ (αu + 1)ρ + 2∆ρ + ∆2ρ + bρ 3/2

(cid:21)

.

(28)

(29)

In consequence, the equations (8) are no longer suitable and have to be adapted accordingly. This

is done in Appendix A. Next, we investigate the changes caused by the unusual scaling of the

additional nonlinearity.

A.

Inﬂuence on Linear Stability

Inserting a uniform density with the perturbation ρ

Eq. (29), where ε

(cid:28)

¯ρ, results in the amended dispersion relation

ω (cid:48)

2(k) = ω 2 +

k2
2

3b ¯ρ(cid:112) ¯ρ .

¯ρ = ε

(cid:16)

vei(ωt

kx)

−

−

i(ωt

we−

kx)(cid:17)
−

into

−

(30)

Perturbations grow exponentially when ω (cid:48)

2 < 0 with the threshold of instability at ω (cid:48)

2 = 0 which

coincides with the emergence of nontrivial roots other than k0 = 0:

k2
0 = 1

1
8 ¯ρ ±

−

(cid:115)(cid:18)
1

1
8 ¯ρ

−

(cid:19)2

(cid:18)

αu + 1 +

−

b(cid:112) ¯ρ

(cid:19)

.

3
2

(31)

Therefore in a system of inﬁnite size the threshold of instability, where only one k0 = kc exists,

can be described through Eq. (32), where αuc is the critical value of αu. It is depicted in Fig. 8.

αuc =

(cid:19)2

(cid:18)
1

1
8 ¯ρ

−

1

−

−

b(cid:112) ¯ρ

3
2

for

¯ρ

≥

1
8 .

(32)

19

FIG. 8. Linear stability region of the uniform (superﬂuid) state ρ(x) = ¯ρ in the ( ¯ρ, αu) plane. The stability

thresholds according to Eq. (32) are given as black lines for various values of the strength of the quantum

ﬂuctuation term b. Thereby, the solid line corresponds to the case without the quantum ﬂuctuation term,

while the dashed, dot-dashed and dotted lines correspond to b = 0.1, b = 0.2 and b = 0.3, respectively. The

regions above the respective lines correspond to stable uniform states. The thin red line indicates the position

of the maximum of the curves when continuously changing b. Note that for b

0 the corresponding ¯ρ also

→

diverges. Correspondingly, the thin blue line indicates the position of the quadruple point where the phase

transition is of second order (for details see main text). To the left [right] of the blue line the ﬁrst stable

pattern is the hexagon [honeycomb]. In both cases the phase transition is of ﬁrst order.

As expected from the arguments laid out in Ref. 62, the higher-order (quartic) nonlinearity in

Eq. (27) signiﬁcantly changes the phase diagram. This is illustrated in Fig. 8 which shows the

critical αuc as a function of ¯ρ. At b = 0 we see that αuc( ¯ρ) has no local maximum, instead the

maximum is at inﬁnite ¯ρ. However, for nonzero values of b the maximum moves to ﬁnite values of

¯ρ – its changing position is indicated by the red line. In consequence, for increasing b the region

of stable uniform states is extended towards smaller values of αuc and larger values of ¯ρ. The blue

20

2.55.07.510.012.515.017.5¯ρ−1.0−0.8−0.6−0.4−0.20.0αustableunstableb=0b=0.1b=0.2b=0.3maximum2ndordermaximum2ndordercurve indicates the single point at each value of b where the phase transition is of second order. As

explained below, this is computed from a one-mode approximation. In other words, the line mark

the parameter values where the transcritical bifurcation between uniform and hexagon/honeycomb

pattern corresponds to orthogonally crossing branches, therefore giving no immediate hysteresis.

In consequence, to the left of the blue line the ﬁrst stable pattern is a hexagon (or possibly a

localized hexagon state) while to the right it is a honeycomb (possibly localized).

B. Changes to Patterns and Phase Transition

To conﬁrm the expected changes62–64 caused by the high-order nonlinearity in existence region

and stability of different patterns and the corresponding phase transitions we apply a one-mode

approximation (for details see Appendix B). In other words, the patterned state is approximated

by harmonics of a single wavelength with small amplitude A. Inserting this ansatz into the free

energy F combined with a Taylor expansion in A

1 gives

(cid:28)

F0 = q2A2 + q3A3 + q4A4

F

−

(33)

which is a reasonable approximation close to the border of linear stability where the modulation

amplitude A is small. Minimizing F with respect to k gives the critical wave number kc and allows

one to obtain the expressions for q2, q3 and q4 given in Table I in Appendix B. Minimizing F with
respect to A one then determines the state of lowest energy.62

As we only consider a polynomial in A up to fourth order, the results depicted in Fig. 9 only

provide an approximate phase diagram. The expected hexagonal pattern forms the ground state

in the low-density part of the region of linearly unstable uniform states. In contrast, in the high-

density part the honeycomb pattern is of lowest energy while at intermediate densities the stripe

phase dominates. Note that both, hexagon and honeycomb regions of dominance extend beyond

the border of linear stability of the uniform state. This suggests a region of coexistence and there-

fore a ﬁrst order phase transition. The coexistence region shrinks when approaching the quadruple

point where the borders of thermodynamic stability meet for all four stable states. When crossing

the phase boundary at this point there is no coexistence and therefore it corresponds to a second

order phase transition.

The quadruple point is determined as an intersection of q3 = (16b ¯ρ

8 + 1/ ¯ρ)3/256 = 0 and

−

Eq. (32). The latter relation characterizes the primary bifurcation and the former states that the

21

FIG. 9. Energetically favored ground states as obtained in a one-mode approximation at αu =

0.4. The

−

border of stability, Eq. (32), is given as black line. The ground states are the uniform state (white region),

hexagons (light gray region), stripes (medium gray region) and honeycomb (dark gray region). All four

meet in a single point, where no coexistence with the uniform state exists, making it a second order phase

transition. Horizontal dashed lines indicate b-values employed for the bifurcation diagrams in Figs. 11 and

12.

energy F only depends on even powers of the pattern amplitude, so neither hexagons (positive

A) nor honeycombs (negative A) are favored. We ﬁnd its location (αuQ, ¯ρQ) as function of b or

alternately (bQ, ¯ρQ) as function of αu by solving

bQ =

αuQ =

8 ¯ρ
1
−
16 ¯ρ 5/2
7
64 ¯ρ 2 −

1
¯ρ

(34)

(35)

Alternatively, the blue line in Fig. 8 marks the resulting location of the quadruple point in the

( ¯ρ, αu)-plane for continuously changing b. Note that the quadruple point actually corresponds

to a thermodynamic critical point. Its location within the phase diagram in Fig. 9 looks unusual

because the parameters b, αu and ¯ρ are not independent.

22

1.01.52.02.53.03.5¯ρ0.1150.1200.1250.130buniformhexagonshoneycombstripesinstabilitythresholdThe predicted existence of different phase transitions is highlighted in the corresponding bi-

furcation diagram with ¯ρ as control parameter as given in Fig. 10. It shows the branches of the

emerging states of a two-dimensional system with αu =

0.4 at b = 0.1286. The parameters are

chosen in such a way that at lower ¯ρ a ﬁrst order phase transition between uniform state and

−

hexagons is found while at higher ¯ρ the quadruple point is passed, i.e., at this speciﬁc value of b,

this bifurcation is of higher codimension and stable hexagons and stripes both emerge vertically.

The domain size is again chosen to ﬁt hexagonal states with 2Lc/√3

2Lc.

×

At lower densities we see the expected transcritical bifurcation which here indicates a ﬁrst order

phase transition. Again, the ﬁlled circles indicate coexisting uniform and hexagon states, i.e., states

of identical chemical potential and grand potential density. This implies that localized states could

exist in principle, but are not observed at the domain sizes we are able to consider. At higher

densities, however, the bifurcation occurs on the critical point, i.e., at the speciﬁc parameter value

where the transcritical bifurcation between hexagons and honeycombs and the related saddle-

node bifurcation of the hexagons exactly coincide. As there are no points of identical chemical

potential and grand potential density, there are no points of coexistence of these states with the

uniform state, and the corresponding phase transition is of second order. Note furthermore that the

honeycomb state is unstable everywhere on the branch, while the stripe state has a narrow linearly

stable region at high densities. However, in contrast to the result of the one-mode approximation

(Fig. 9), it never becomes the energetically favored state, but only reaches the same low energy as

the hexagons.

Figure 11 shows the bifurcation diagram of steady states at ﬁxed αu =

0.4 and b = 0.1286

−

(along the upper horizontal line in Fig. 9). Then shadings highlight regions where the four dif-

ferent possible states are globally stable, i.e., correspond to the ground states. There are four

transitions between them, for each we indicate respective pairs of coexisting states that have iden-

tical chemical potential and grand potential density and here show nearly the same value of ¯ρ with
2 or lower. Again, in consequence of the coexisting states we

the difference being of order 10−

expect localized states to exist that could be calculated in larger domains. The coexistences imply

that all transitions are of ﬁrst order. There are the ﬁrst order phase transitions at low and high

densities between the uniform state and hexagon and honeycomb patterns, respectively. Both are

related to a combination of transcritical and saddle-node bifurcations. Furthermore, the ¯ρ-range of

globally stable stripe patterns ends at ﬁrst order transitions to hexagons and honeycombs, respec-

tively. Staring at low ¯ρ, the uniform state is energetically favoured up to ¯ρ = 1.07, followed by

23

FIG. 10. Bifurcation diagram showing branches of steady states of Eq. (29) as a function of ¯ρ at ﬁxed

αu =
domain size 2Lc/(cid:112)

−

0.4 and b = 0.1286 (along the upper horizontal line in Fig. 9). The considered 2D system has

(3)

2Lc. The solutions are characterized through the contrast C (see Eq. (26)). Line

×

styles are as in Fig. 7 with the addition of stripe to hexagon transition states in cyan. The bifurcation at

low ¯ρ is related to points of thermodynamic coexistence between the uniform and hexagon states (indicated

by ﬁlled circles). No such coexistence occurs for the bifurcation at high ¯ρ that is related to a second order

transition.

hexagons up to ¯ρ = 2.7. Then, stripes have the lowest energy until ¯ρ = 3.28 where honeycombs

take over. Finally, at ¯ρ = 3.56 the uniform state becomes again dominant.

The line connecting stable and unstable hexagons [honeycombs] is interrupted by a small gap,

as numerically the corresponding pitchfork bifurcations becomes a perturbed pitchfork because

the numerical grid does not fully reﬂect the symmetries of the involved patterns. Typical proﬁles

of state from the transition branch between stripes and hexagons/honeycombs are given in Fig. 12.

The sequence starts with a stable hexagon pattern (leftmost image), transitions into stripes (cen-

tral image), before becoming a honeycomb (rightmost image). Close inspection shows why it is

necessary to use appropriate BC in the y-direction: while the hexagon-stripe transition works well

24

1.41.61.82.02.22.4¯ρ0.00.10.20.30.40.50.6Cuniformstripeshexagonshoneycombstableunstabletherm.coexistenceFIG. 11. Bifurcation diagram as in Fig. 10 at smaller b = 0.1175 (along the lower horizontal line in Fig. 9).

Domain size, line styles, solution measure and markers are as in Fig. 10. The additional dotted orange

lines correspond to transition states between hexagons and honeycombs. The background shading locally

matches the colors of the respective ground state. Thermodynamic coexistence of pairs of states is marked

by ﬁlled circles: the two colors of ﬁlling and contour refer to the respective coexisting states.

with Neumann BC, the subsequent stripe-honeycomb transition requires periodic BC. Note that

the reverse is true when starting from a periodic honeycomb pattern that is placed in such a way

in the ﬁnite domain that Neumann BC apply. This issue may lead to bifurcations of the plane ﬁll-

ing patterns being missed when considering ﬁnite domains. In consequence it may even result in

stripe patterns that are shifted by half a period showing different stabilities. Therefore, bifurcation

diagrams for ﬁnite domains have to be carefully interpreted.

There exist further transition states on connecting branches between hexagon and honeycomb

states (orange dotted lines in Fig. 11). These unstable patterns include triangles and patchwork

quilt patterns (as in Ref. 65, chapter 5.4). We do not exclude the possibility of further connect-

ing branches between these states, but expect all of them to be unstable. Note, however, that in

consequence of the various unstable states time evolutions may show intricate behaviour in the

25

1.01.52.02.53.03.5¯ρ0.00.20.40.60.8Cuniformhexagonshoneycombstripesstableunstabletherm.coexistenceFIG. 12. Examples of steady patterns illustrating the transition from hexagons to stripes and further to

honeycombs in Fig. 11 (for parameters see its caption). The sequence is as follows: From left to right

there are a stable hexagon at ¯ρ = 2.75, unstable transition states at ¯ρ = 2.7 and ¯ρ = 2.69, a stable stripe at

¯ρ = 2.67, unstable transition states at ¯ρ = 3.27 and ¯ρ = 3.25, and a stable hexagon at ¯ρ = 3.19.

¯ρ

range around ¯ρ = 3.0 as unstable states may ﬁrst attract and then repel the evolution, e.g., a

−

time simulation started with perturbed triangle patterns, ﬁrst approaches an unstable patchwork

quilt pattern before converging to the globally stable stripe pattern (not shown).

V. SUMMARY & CONCLUSIONS

In the present work, we have investigated a PFC type model for BECs, employing arclength

continuation techniques, stability analysis and one-mode approximations. The results have been

presented in the form of bifurcation diagrams and phase diagrams. As a ﬁrst step, we have approx-

imated the nonlocal GPE around the phase transition by a PFC model. To do so we have proposed

an alternative approach to Ref. 38 that aims at matching the dispersion relations at the onset of

instability of the uniform state. The approach is general and does not depend on the speciﬁcs of

the interatomic interactions (or nonlocal nonlinearity in case of optics), as long as the dispersion

relation shows the expected maxon-roton form.

We have then benchmarked the validity of the PFC model as an approximation for the behav-

ior of the full nonlocal GPE (Eq. (1)): The PFC model is able to correctly predict the onset of

modulational stability and shows qualitative agreement with the GPE regarding the order of the

phase transition. However, there is a clear quantitative disagreement between the models when

comparing ﬁnite-amplitude modulated steady states. This can be expected as we only expanded to

26

-303-505y-303-303-303x-303−303-303ρminρmaxfourth order.

Subsequently, we have presented bifurcation diagrams for spatially one and two dimensional

systems, detailing possible steady states, coexistence regions and the existence of localized states.

To the authors knowledge, localized states have not been discussed in depth in the context of

BECs. Their analysis could turn out to be quite useful to experiments, as rich information could

be extracted from individual images of a localized state.

As expected, in the analyzed case no localized states have been encountered in a one-dimensional
system with cubic nonlinearity.66 However, we have found localized states in the two-dimensional

system. Although they were found employing an approximative local model, we conjecture that

these states also persist in the full nonlocal model. Here, it has turned out to be numerically con-

venient to choose sufﬁciently low values of the interaction parameter αu, as this leads to smaller

transition regions between coexisting states. Nonetheless, we have to caution that the model is

not suitable for excessively low values of αu, which result in unphysical negative densities. Note

that we did not encounter slanted snaking of branches of localized states, which could have been
expected in analogy to similar systems.35 Most likely this is due to computational limitations that

do not allow us to consider very large domains at interaction parameters sufﬁciently far from the

critical point.

In the ﬁnal part we have considered how a phenomenological addition of a higher-order nonlin-

earity (in analogy to quantum ﬂuctuations in dipolar BECs) changes the structure of the bifurcation

diagram. We have found that such a nonlinearity stabilizes superﬂuid states with high densities

and adds additional stable patterns. This is in close similarity to what has been recognized in dipo-
lar BECs,62–64 thereby underpinning that, despite of our dramatically different model, the general

behavior and topology persist.

In summary, we have presented an approximate mapping that permits to employ standard bifur-

cation software and subsequently investigated bifurcation diagrams that include unstable states. In

this way we have gained a deeper understanding of the speciﬁcs of the bifurcations present in the

system. We believe that our results will remain qualitatively valid for other nonlocal GPE models

and provide a reference case for their future bifurcation analysis. Note that the presented methods
can also be applied to nonlocal optical systems that display pattern formation.36,37 Furthermore,

the mapping could turn out to be useful for fast calculations of approximate excitation spectra as

the matrix occurring in the Boguliobov-de-Gennes equations that needs to be diagonalized is no
longer full.21,28

27

ACKNOWLEDGMENTS

Discussions with Max Holl and Tobias Frohoff-Hülsmann are acknowledged. F.M. acknowl-

edges stimulating discussions with Yongchang Zhang and Thomas Pohl.

DATA AVAILABILITY STATEMENT

The data that support the ﬁndings of this study are openly available on zenodo at http://doi.org/

10.5281/zenodo.6594198, in Ref. 67.

Appendix A: Deriving the Approximation Parameters with Higher Nonlinearities

Starting from the dispersion relation in Eq. (30), we once again replace ˆR(k) with the polyno-

mial in Eq. (3) and demand that the requirements from Eqs. (5)-(7) hold.

Given the critical values kc and ¯ρc of k and ¯ρ we can now determine g0, g2 and g4:

g0 =

g2 =

g4 =

2 ˆR(kc) + 4kc∂k ˆR(kc) + k2

c ∂kk ˆR(kc)

8

+

3k2
c
8 ¯ρc −

27b√ ¯ρ
8

,

2g0 +

(cid:18)

1
k2
c
(cid:18)

−
1
k4
c

g0 +

3
2

k2
c
4 ¯ρc
b(cid:112) ¯ρ

b(cid:112) ¯ρ

(cid:19)

,

3
2

+

(cid:19)

.

∂k ˆR and ∂kk ˆR are the ﬁrst and second derivatives of ˆR with respect to k.

Those g0, g2 and g4 can now be used in the rescaling as before, with the addition of:

b

→

b(cid:48)

αu + 1
g0

(cid:115)

.

2
g2

−

Appendix B: One-Mode Approximation

The one-mode approximation is used to get the minimum energy by inserting the ansatz

ρ = ¯ρ + ¯ρA

3
∑
i=1

cos (kir)

for hexagons [honeycomb] with A > 0 [A < 0] or

ρ = ¯ρ + ¯ρA cos (k1r)

28

(A1)

(A2)

(A3)

(A4)

(B1)

(B2)

hexagons/honeycomb

1D/stripes

q2

q3

q4

192αu ¯ρ 2+48 ¯ρ+288b√ ¯ρ 5
256
24 ¯ρ+48b√ ¯ρ 5+3
256
90b√ ¯ρ 5
1024

240 ¯ρ

33

−

−

−

3
−

64αu ¯ρ 2+16 ¯ρ+96b√ ¯ρ 5
256

1
−

0

8 ¯ρ

3b√ ¯ρ 5
512

−

1
−

TABLE I. Prefactors to the amplitudes in the energy equation (Eq. (B3)) of the one mode approximation up

to fourth order, depending only on the model parameters.

for one dimensional solutions or stripes in two dimensions, into the energy F given by Eq. (28).

The lattice vectors ki are k1 = (k, 0), k2 = (

k/2, k√3/2) and k3 = (

k/2,

−

k√3/2). The am-

−

−

plitude of the pattern is ¯ρA and A

1.

(cid:28)

We get results of the form

F0 = q2A2 + q3A3 + q4A4 ,

F

−

(B3)

where F0 is the uniform ground state energy at A = 0.

From there the energy is minimized ﬁrst with respect to k, therefore ∂kF = 0 at k = kc. Inserting

kc into F and neglecting all terms of order O(A5) and higher gives the results in Tab. I.

In one dimension the sign of q4 distinguishes between super- (q4 > 0) and subcritical (q4 < 0)

pitchfork bifurcation. At b = 0 we get q4 > 0 for ¯ρ > 0.125 meaning the bifurcation is supercritical

as seen in the examples above. A subcritical pitchfork is not possible as ¯ρ < 0.125 and therefore

1 is not a valid parameter region in this model.

αu <

−
For b

emerges and get q4 =

64αu ¯ρ 2 + 272 ¯ρ

16384

33

−

, meaning

= 0 we set b so it matches the border of linear stability (see Eq. (8)) where the bifurcation

33
64 ¯ρ 2 −

17
4 ¯ρ




< αu



> αu

→

→

supercritical ,

subcritical .

(B4)

1. Beyond that

−

The former is always true for 0.125 < ¯ρ < 4.125 as the model requires αu >

subcritical bifurcations are possible.

Appendix C: Bifurcations in 1D

The patterns a one dimensional system of size L = 20 exhibits while keeping the mean density

at a constant value of ¯ρ = 1 and varying αu are depicted in the bifurcation diagram in Fig. 13,

detailing which patterns appear at which values of αu categorized by their mode and contrast C.

29

(cid:54)
FIG. 13. Shown are branches of steady states of Eq. 17 as a function of the interaction parameter αu at

ﬁxed ¯ρ = 1 and domain size L = 20. The states are characterized by their contrast C. Continuous and dotted

lines represent stable and unstable states, respectively. The horizontal black line corresponds to the uniform

state. The colored lines correspond to periodic states, where the red state has 3 peaks, the blue state has

two peaks and the purple state has two peaks of alternating height, where the smaller peak eventually splits

into two peaks of equal height. The phase transition between the uniform and patterned stable states is of

second order and there are no localized states.

There is a phase transition between the uniform and the patterned state at αu =

0.235, match-

−

ing the theoretical value for a system of size L with a mode number three. As the bifurcation is

supercritical there is no hysteresis and therefore no jump in the amplitude, making this a second

order phase transition. The mode three state is stable until around αu =

0.62, where the approx-

−

imation reaches its limit, leading to states with negative densities and therefore no more stable

states.

At ﬁnite system size of L = 20 there exists a second patterned state with mode number two,

also emerging supercritical but unlike the mode three state it is unstable for all values of αu.

There are also mixed states, where the system changes between the two modes, also unstable,

30

−0.7−0.6−0.5−0.4−0.3−0.2αu0.00.20.40.60.81.0CunstablestableFIG. 14. Steady states of Eq. 17 as a function of ¯ρ at ﬁxed αu =

0.5 with the domain size L = 20. The

−

solutions are characterized through the contrast C. Line styles are as in Fig. 13.

except for right at the border where the approximation is no longer usable, making their usefulness

in predicting real systems somewhat sketchy.

The small gap between the end of the stable region for the uniform state and the onset of the

stable patterned state is due to the threshold of instability matching the theoretical value for an

inﬁnite system, while the position of the bifurcation is inﬂuenced by the domain size.

Similarly a bifurcation diagram in a system of size L = 20 where ¯ρ is varied while the interac-

tion potential is kept at a speciﬁc form, represented by αu =

0.5, can be found in Fig. 14.

−

We ﬁnd very similar results to those discussed for Fig 13, with supercritical bifurcations and

second order phase transitions. Its position matches the theoretical value of ¯ρ = 0.456 for a system

of size L = 20 and mode number 3.

As before we test for localized states by looking for states with equal chemical potential µ

and grand potential density Ω, with the results shown in Figs. 15 (a) and (b), where we plotted

the grand potential density ω = Ω/L plotted against the chemical potential for the stable states of

31

0.40.50.60.70.80.91.0¯ρ0.00.20.40.60.81.0CunstablestableFIG. 15. Diagram of the grand potential density as a function of the chemical potential for the stable states

in (a) Fig. 13 and (b) Fig. 14 with line styles matching those in Fig. 13. There are no cross sections and

therefore no states which can coexist indeﬁnitely.

Fig. 13 and 14 respectively.

As expected there is no crossing of the curves for two different stable states and therefore no

localized states can be found.

REFERENCES

1L. M. Pismen, Patterns and Interfaces in Dissipative Dynamics, 1st ed. (Springer Berlin Heidel-

berg, Berlin, Heidelberg, 2006).
2M. C. Cross and P. C. Hohenberg, “Pattern formation outside of equilibrium,” Rev. Mod. Phys.

65, 851–1112 (1993).
3P. Ball, “In retrospect: On the six-cornered snowﬂake,” Nature 480, 455–455 (2011).
4A. M. Turing, “The chemical basis of morphogenesis,” Philos. Trans. R. Soc. Lond. Ser. B-Biol.

Sci. 23, 237 (1952).

32

0.250.500.75µ−0.40−0.35−0.30−0.25−0.20−0.15−0.10Ω/V(a)0.20.3µ−0.16−0.14−0.12−0.10−0.08−0.06−0.04(b)uniformstableuniformunstablemodulatedstable5J. Swift and P. C. Hohenberg, “Hydrodynamic ﬂuctuations at the convective instability,” Phys.

Rev. A 15, 319–328 (1977).
6M. Hilali, G. Dewel, and P. Borckmans, “Subharmonic and strong resonances through coupling

with a zero mode,” Phys. Lett. A 217, 263 – 268 (1996).
7R. Lefever, N. Barbier, P. Couteron, and O. Lejeune, “Deeply gapped vegetation patterns: On

crown/root allometry, criticality and desertiﬁcation,” J. Theor. Biol. 261, 194–209 (2009).
8M. Tlidi, P. Mandel, and R. Lefever, “Localized structures and localized patterns in optical

bistability,” Phys. Rev. Lett. 73, 640–643 (1994).
9N. Stoop, R. Lagrange, D. Terwagne, P. Reis, and J. Dunkel, “Curvature-induced symmetry

breaking determines elastic surface patterns,” Nat. Mater 14, 337–342 (2015).

10A. F. Andreev and I. M. Lifshitz, “Quantum theory of defects in crystals,” Sov. Phys. JETP 29,

1107–1113 (1969).

11A. J. Leggett, “Can a solid be “superﬂuid”?” Phys. Rev. Lett. 25, 1543–1546 (1970).
12G. V. Chester, “Speculations on Bose-Einstein condensation and quantum crystals,” Phys. Rev.

A 2, 256–258 (1970).

13H. Kadau, M. Schmitt, M. Wenzel, C. Wink, T. Maier, I. Ferrier-Barbut, and T. Pfau, “Observing

the Rosensweig instability of a quantum ferroﬂuid,” Nature 530, 194–197 (2016).

14M. Schmitt, M. Wenzel, F. Böttcher, I. Ferrier-Barbut, and T. Pfau, “Self-bound droplets of a

dilute magnetic quantum liquid,” Nature 539, 259–262 (2016).

15D. S. Petrov, “Quantum mechanical stabilization of a collapsing Bose-Bose mixture,” Phys. Rev.

Lett. 115, 155302 (2015).

16C. R. Cabrera, L. Tanzi, J. Sanz, B. Naylor, P. Thomas, P. Cheiney, and L. Tarruell, “Quantum

liquid droplets in a mixture of Bose-Einstein condensates,” Science 359, 301–304 (2018).

17L. Tanzi, E. Lucioni, F. Famà, J. Catani, A. Fioretti, C. Gabbanini, R. N. Bisset, L. Santos, and

G. Modugno, “Observation of a dipolar quantum gas with metastable supersolid properties,”

Phys. Rev. Lett. 122, 130405 (2019).

18F. Böttcher, J.-N. Schmidt, M. Wenzel, J. Hertkorn, M. Guo, T. Langen, and T. Pfau, “Transient

supersolid properties in an array of dipolar quantum droplets,” Phys. Rev. X 9, 011051 (2019).
19L. Chomaz, D. Petter, P. Ilzhöfer, G. Natale, A. Trautmann, C. Politi, G. Durastante, R. M. W.

van Bijnen, A. Patscheider, M. Sohmen, M. J. Mark, and F. Ferlaino, “Long-lived and transient

supersolid behaviors in dipolar quantum gases,” Phys. Rev. X 9, 021012 (2019).

20L. Tanzi, S. M. Roccuzzo, E. Lucioni, F. Famà, A. Fioretti, C. Gabbanini, G. Modugno, A. Re-

33

cati, and S. Stringari, “Supersolid symmetry breaking from compressional oscillations in a dipo-

lar quantum gas,” Nature 574, 382–385 (2019).

21M. Guo, F. Böttcher, J. Hertkorn, J.-N. Schmidt, M. Wenzel, H. P. Büchler, T. Langen, and

T. Pfau, “The low-energy Goldstone mode in a trapped dipolar supersolid,” Nature 574, 386–

389 (2019).

22G. Natale, R. M. W. van Bijnen, A. Patscheider, D. Petter, M. J. Mark, L. Chomaz, and F. Fer-

laino, “Excitation spectrum of a trapped dipolar supersolid and its experimental evidence,” Phys.

Rev. Lett. 123, 050402 (2019).

23M. A. Norcia, C. Politi, L. Klaus, E. Poli, M. Sohmen, M. J. Mark, R. N. Bisset, L. Santos, and

F. Ferlaino, “Two-dimensional supersolidity in a dipolar quantum gas,” Nature 596, 357–361

(2021).

24L. Tanzi, J. G. Maloberti, G. Biagioni, A. Fioretti, C. Gabbanini, and G. Modugno, “Evidence

of superﬂuidity in a dipolar supersolid from nonclassical rotational inertia,” Science 371, 1162–

1165 (2021).

25N. Henkel, R. Nath, and T. Pohl, “Three-dimensional roton excitations and supersolid formation

in Rydberg-excited Bose-Einstein condensates,” Phys. Rev. Lett. 104, 195302 (2010).

26F. Cinti, P. Jain, M. Boninsegni, A. Micheli, P. Zoller, and G. Pupillo, “Supersolid droplet crystal

in a dipole-blockaded gas,” Phys. Rev. Lett. 105, 135301 (2010).

27S. Saccani, S. Moroni, and M. Boninsegni, “Excitation spectrum of a supersolid,” Phys. Rev.

Lett. 108, 175301 (2012).

28T. Macrì, F. Maucher, F. Cinti, and T. Pohl, “Elementary excitations of ultracold soft-core bosons

across the superﬂuid-supersolid phase transition,” Phys. Rev. A 87, 061602 (2013).

29T. Macrì, S. Saccani, and F. Cinti, “Ground state and excitation properties of soft-core bosons,”

J. Low Temp. Phys. 177, 59 (2014).

30F. Cinti, M. Boninsegni, and T. Pohl, “Exchange-induced crystallization of soft-core bosons,”

New J. Phys. 16, 033038 (2014).

31F. Maucher, N. Henkel, M. Saffman, W. Królikowski, S. Skupin, and T. Pohl, “Rydberg-induced

solitons: Three-dimensional self-trapping of matter waves,” Phys. Rev. Lett. 106, 170401 (2011).
32M. D. Lukin, M. Fleischhauer, R. Cote, L. M. Duan, D. Jaksch, J. I. Cirac, and P. Zoller, “Dipole

blockade and quantum information processing in mesoscopic atomic ensembles,” Phys. Rev.

Lett. 87, 037901 (2001).

33K. R. Elder and M. Grant, “Modeling elastic and plastic deformations in nonequilibrium pro-

34

cessing using phase ﬁeld crystals,” Phys. Rev. E 70, 051605 (2004).

34H. Emmerich, H. Löwen, R. Wittkowski, T. Gruhn, G. Tóth, G. Tegze, and L. Gránásy, “Phase-

ﬁeld-crystal models for condensed matter dynamics on atomic length and diffusive time scales:

An overview,” Adv. Phys. 61 (2012), 10.1080/00018732.2012.737555.

35U. Thiele, A. J. Archer, M. J. Robbins, H. Gomez, and E. Knobloch, “Localized states in the

conserved Swift-Hohenberg equation with cubic nonlinearity,” Phys. Rev. E 87, 042915 (2013).
36S. Sevinçli, N. Henkel, C. Ates, and T. Pohl, “Nonlocal nonlinear optics in cold Rydberg gases,”

Phys. Rev. Lett. 107, 153001 (2011).

37F. Maucher, T. Pohl, S. Skupin, and W. Krolikowski, “Self-organization of light in optical media

with competing nonlinearities,” Phys. Rev. Lett. 116, 163902 (2016).

38V. Heinonen, K. J. Burns, and J. Dunkel, “Quantum hydrodynamics for supersolid crystals and

quasicrystals,” Phys. Rev. A 99, 063621 (2019).

39B. Krauskopf and H. M. Osinga, “Computing invariant manifolds via the continuation of orbit

segments,” in Numerical Continuation Methods for Dynamical Systems: Path following and

boundary value problems, edited by B. Krauskopf, H. M. Osinga, and J. Galán-Vioque (Springer

Netherlands, Dordrecht, 2007) pp. 117–154.

40S. Engelnkemper, S. V. Gurevich, H. Uecker, D. Wetzel, and U. Thiele, “Continuation for thin

ﬁlm hydrodynamics and related scalar problems,” in Computational Modeling of Bifurcations

and Instabilities in Fluid Mechanics, Computational Methods in Applied Sciences, vol 50, edited

by A. Gelfgat (Springer, Cham, 2019) pp. 459–501, http://arxiv.org/abs/1808.02321.

41U. Thiele, T. Frohoff-Hülsmann, S. Engelnkemper, E. Knobloch, and A. J. Archer, “First order

phase transitions and the thermodynamic limit,” New J. Phys. 21, 123021 (2019).

42M. P. Holl, A. J. Archer, S. V. Gurevich, E. Knobloch, L. Ophaus, and U. Thiele, “Localized

states in passive and active phase-ﬁeld-crystal models,” IMA J. Appl. Math. 86, 896–923 (2021).
43J. Burke and E. Knobloch, “Localized states in the generalized Swift-Hohenberg equation,”

Phys. Rev. E 73, 056211 (2006).

44P. Woods and A. Champneys, “Heteroclinic tangles and homoclinic snaking in the unfolding of

a degenerate reversible Hamiltonian–Hopf bifurcation,” Phys. D Nonlinear Phenom. 129, 147–

170 (1999).

45H. Uecker, D. Wetzel, and J. D. M. Rademacher, “pde2path - a matlab package for continuation

and bifurcation in 2d elliptic systems,” Numer. Math. Theor. Meth. Appl. 7, 58–106 (2014).
46E. Gross, “Structure of a quantized vortex in boson systems,” Nuovo Cim. 20, 454–477 (1961).

35

47L. P. Pitaevskii, “Vortex lines in an imperfect Bose gas,” Sov. Phys. JETP 13, 451 (1961).
48The ansatz for the wave function is ¯ρ + ε(vei(ωt
49A. J. Archer, D. J. Ratliff, A. M. Rucklidge, and P. Subramanian, “Deriving phase ﬁeld crystal

kx)).
−

we−

i(ωt

kx)

−

−

theory from dynamical density functional theory: Consequences of the approximations,” Phys.

Rev. E 100, 022140 (2019).

50W. Krolikowski, O. Bang, J. J. Rasmussen, and J. Wyller, “Modulational instability in nonlocal

nonlinear Kerr media,” Phys. Rev. E 64, 016612 (2001).

51E. Madelung, “Quantentheorie in hydrodynamischer Form,” Z. Physik 40, 322–326 (1927).
52R. Carles, R. Danchin, and J.-C. Saut, “Madelung, Gross-Pitaevskii and Korteweg,” Nonlinearity

25, 2843–2873 (2012).

53M. L. Chiofalo, S. Succi, and M. P. Tosi, “Ground state of trapped interacting Bose-Einstein

condensates by an explicit imaginary-time algorithm,” Phys. Rev. E 62, 7438–7444 (2000).
54E. A. Donley, N. R. Claussen, S. L. Cornish, J. L. Roberts, E. A. Cornell, and C. E. Wie-

man, “Dynamics of collapsing and exploding bose–einstein condensates,” Nature 412, 295–299

(2001).

55F. Maucher, S. Skupin, and W. Krolikowski, “Collapse in the nonlocal nonlinear schrödinger

equation,” Nonlinearity 24, 1987–2001 (2011).

56Actually, weakly nonlinear analysis shows (see section IV B and Appendix B below) that coex-

istence can be expected close to αu =

1 where the primary bifurcation can become subcritical.

−
However, this parameter region is unphysical as one obtains negative densities.

57Bifurcations for transition states between stripes and hexagons directly inﬂuence the amount

of positive eigenvalues of the stripe solution. Fig. 12 shows that depending on the phase of

the stripes the pattern resulting from such a transition might not have mirror symmetry with

respect to the x-axis. As the latter is required by Neumann BC the corresponding bifurcation is

then missed. Therefore, Neumann BC ultimately give rise to the artefact that stripes of different

phase exhibit different stabilities.

58M. P. Holl, A. J. Archer, and U. Thiele, “Efﬁcient calculation of phase coexistence and phase

diagrams: Application to a binary phase-ﬁeld crystal model,” J. Phys.: Condens. Matter 33,

115401 (2021).

59J. D. Crawford, M. Golubitsky, M. G. M. Gomes, E. Knobloch, and I. M. Stewart, “Boundary

conditions as symmetry constraints,” in Singularity Theory and its Applications, Part II, Lecture

Notes in Mathematics, Vol. 1463 (Springer, New York, 1991) pp. 63–79.

36

60A. J. Archer, M. C. Walters, U. Thiele, and E. Knobloch, “Solidiﬁcation in soft-core ﬂuids:

Disordered solids from fast solidiﬁcation fronts,” Phys. Rev. E 90, 042404 (2014).

61A. R. P. Lima and A. Pelster, “Quantum ﬂuctuations in dipolar Bose gases,” Phys. Rev. A 84,

041604 (2011).

62Y.-C. Zhang, F. Maucher, and T. Pohl, “Supersolidity around a critical point in dipolar Bose-

Einstein condensates,” Phys. Rev. Lett. 123, 015301 (2019).

63Y.-C. Zhang, T. Pohl, and F. Maucher, “Phases of supersolids in conﬁned dipolar Bose-Einstein

condensates,” Phys. Rev. A 104, 013310 (2021).

64J. Hertkorn, J.-N. Schmidt, M. Guo, F. Böttcher, K. S. H. Ng, S. D. Graham, P. Uerlings, T. Lan-

gen, M. Zwierlein, and T. Pfau, “Pattern formation in quantum ferroﬂuids: From supersolids to

superglasses,” Phys. Rev. Research 3, 033125 (2021).

65R. Hoyle, Pattern Formation: An Introduction to Methods, repr. ed. (Cambridge Univ. Press,

Cambridge [u.a.], 2007).

66L. Landau, “On the theory of phase transitions,” Zh. Eksp. Teor. Fiz. 7, 19 (1937).
67A. B. Steinberg, F. Maucher, S. V. Gurevich, and U. Thiele, “Data supplement for ’Explor-

ing bifurcations in Bose-Einstein condensates via phase ﬁeld crystal models’,” 10.5281/zen-

odo.6594198 (2022).

37

