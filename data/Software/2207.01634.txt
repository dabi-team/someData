Astronomy & Astrophysics manuscript no. main
July 6, 2022

©ESO 2022

2
2
0
2

l
u
J

4

]

A
G
.
h
p
-
o
r
t
s
a
[

1
v
4
3
6
1
0
.
7
0
2
2
:
v
i
X
r
a

Environmental Effects on the Dynamical Evolution of Star Clusters
in Turbulent Molecular Clouds

Paolo Suin1(cid:63) ID , Steven N. Shore1, 2 ID , and Václav Pavlík3 ID

1 Dipartimento di Fisica, Università di Pisa, largo B. Pontecorvo 3, Pisa 56127, Italy
2 INFN, Sezione di Pisa, largo B. Pontecorvo 3, Pisa 56127, Italy
3 Indiana University, Department of Astronomy, Swain Hall West, 727 E 3rd Street, Bloomington, IN 47405, USA

Received 18 March 2022 / Accepted 1 July 2022

ABSTRACT

Context. Star clusters form within giant molecular clouds that are strongly altered by the feedback action of the massive stars, but the
cluster still remains embedded in a dense, highly turbulent medium and interactions with ambient structures may modify its dynamical
evolution from that expected if it were isolated.
Aims. We aim to study coupling mechanisms between the dynamical evolution of the cluster, accelerated by the mass segregation
process, with harassment eﬀects caused by the gaseous environment.
Methods. We simulated the cluster dynamical evolution combining N-body and hydrodynamic codes within the Astronomical Multi-
purpose Software Environment (AMUSE).
Results. Tidal harassment produces a sparser conﬁguration more rapidly than the isolated reference simulations. The evolution of the
asymptotic power-law density distribution exponent also shows substantially diﬀerent behaviour in the two cases. The background is
more eﬀective on clusters in advanced stages of dynamical development.

Key words. galaxies: star clusters: general – galaxies: kinematics and dynamics – globular clusters: general – open clusters and
associations: general – methods: numerical

1. Introduction and physical scenario

Understanding the evolution of star cluster has been the subject
of many eﬀorts over the past decades. Much work has been done
to uncover how the internal eﬀects of dynamical interactions
(e.g., Spitzer & Shapley 1940; Chandrasekhar 1942; Lynden-
Bell & Eggleton 1980; Spitzer 1987) and stellar evolution (e.g.,
Chernoﬀ & Weinberg 1990; Portegies Zwart et al. 2007) impact
its properties. Yet no cluster is truly isolated, and modelling the
interaction with the environment, such as the large scale Galactic
potential, spiral arms and high-density structure in the interstel-
lar medium (ISM; e.g., Spitzer 1987; Terlevich 1987; Gnedin
& Ostriker 1997; Gieles et al. 2006) also received great atten-
tion from the scientiﬁc community. Indeed, star clusters and
associations originate in molecular clouds that are restructured
through feedback from the stars, such as winds and explosive
mass ejections (Lada & Lada 2003; Colín et al. 2013; Kruijssen
et al. 2019; Adamo et al. 2020; Kim et al. 2021). Whatever the
history of this interaction is, once free from the immediate na-
tal gas, a young cluster still ﬁnds itself embedded in the larger
scale, structurally complex environment from which the parent
cloud emerged. This environment is dynamically chaotic since
turbulence produces density and velocity ﬂuctuations on a wide
range of length scales (e.g., Vázquez-Semadeni 1994; Federrath
& Klessen 2013; Chevance et al. 2020). These dense, evanes-
cent turbulent structures generate a ﬂuctuating potential that will
harass the cluster and alter its evolution from that expected if
it were isolated (Kruijssen et al. 2012). Before exiting from the
formation region, the cluster has to pass through this denser en-

vironment. Here it will experience a variable potential that can
distort its spatial distribution and increase its global velocity dis-
persion (see, e.g., Gieles et al. 2006).

In this work, we study how this gaseous environment aﬀects
a cluster’s dynamical evolution through numerical models that
treat the hydrodynamics of the gas and the dynamics of the stars
simultaneously. We focused on young massive clusters (YMC),
that display ideal characteristics to analyse the eﬀect. The ma-
jority of them originates from massive star-forming complexes
(Grosbøl & Dottori 2012; Kruijssen et al. 2019), where the high
densities and the structures created by supersonic motions are
likely to have a more prominent impact on their evolution. In ad-
dition, their short evolutionary timescale allows us to study the
presence of coupling between the processes.

2. Simulation methods

To simulate the interaction between a star cluster and its sur-
rounding environment, each component requires a diﬀerent ap-
proach (N-body and hydrodynamical, respectively). We used
specialised codes to follow their evolution and handled the inter-
action between them with AMUSE 1 (Portegies Zwart et al. 2009;
Pelupessy et al. 2013; Portegies Zwart & McMillan 2018). We
adopted the N-body code PeTar (Wang et al. 2020), which com-
bines algorithmic regularisations, particle–particle and particle–
tree techniques (Kustaanheimo & Stiefel 1965; Ahmad & Co-
hen 1973; Barnes & Hut 1986), for the cluster dynamics, and
the smoothed-particle hydrodynamics (SPH) codes GADGET-2
(Springel 2005) and Fi (Gerritsen & Icke 1997; Pelupessy et al.

(cid:63) e-mail: p.suin@studenti.unipi.it

1 Astrophysical Multipurpose Software Environment

Article number, page 1 of 9

 
 
 
 
 
 
A&A proofs: manuscript no. main

2004) to treat the environment. We performed four diﬀerent sets
of simulations: clusters with equal mass stars, clusters with an
initial mass function (IMF), and each of these with and with-
out the environment. For convenience, we marked pure N-body
reference runs (i.e, without environment) with the suﬃx Nb. We
describe the choice of the initial conditions below.

2.1. Star cluster

We chose the physical parameters to resemble a typical YMC
(see, e.g., Portegies Zwart et al. 2010), with the total mass of
each model M = 104 M(cid:12). To study the eﬀects of the inter-
play of the dynamical processes in the cluster and the envi-
ronment, we chose ﬁve diﬀerent IMFs: Salpeter (1955) with
0.15 ≤ m/M(cid:12) ≤ 3 and with 0.15 ≤ m/M(cid:12) ≤ 6; Kroupa (2001)
with 0.1 ≤ m/M(cid:12) ≤ 3 and with 0.1 ≤ m/M(cid:12) ≤ 6 (the change
from 0.15 to 0.1 M(cid:12) yields a more similar mean mass to the mod-
els with the Salpeter IMF); and an equal-mass stellar popula-
tion with m = 0.38 M(cid:12), which is the mean mass of the narrower
Salpeter distribution. For the star cluster sizes, we adopted three
diﬀerent values of the virial radius, rvir = 0.7, 1.3 and 3.0 pc.
We generated the stellar positions and velocities according to the
Plummer (1911) proﬁle. The corresponding core density, ρc, and
all combinations of the initial conditions used are listed in Ta-
ble A.1. The models names are a combination of rvir and the IMF
with the upper mass limit (the name contains the suﬃx “_Nb”
when the model evolves only as an isolated N-body system).

The observed relative motions between clusters in star-
forming regions are of the order of a few km s−1, leading to
an evolution inside the dense region of a few tens of Myr (see
Sec. 2.2; Elson et al. 1987; Kuhn et al. 2019; Roccatagliata et al.
2018, 2020). Therefore, we followed the evolution of each star
cluster for (cid:38)100 Myr, which would be a conservative choice to
let the system escape the high-density environment. We did not
include stellar evolution since even the most massive stars in our
models (i.e., 6 M(cid:12)) would have the main sequence phase of a
similar length as the time span of our simulations (cf. Kippen-
hahn et al. 2012).

2.2. Environment

We modelled the region surrounding the star cluster with
GADGET-2 using equal-mass SPH particles, initially distributed
uniformly and at rest in a box of size L = 400 pc, with peri-
odic boundary conditions. The mean number density and the
mean molecular weight were the same in all models, that is,
(cid:104)n(cid:105) = 10 cm−3 and µ = 1.27, respectively. These values are
typical for giant molecular clouds complexes (see, e.g., Blitz &
Shu 1980; Elmegreen 2007; Heiner et al. 2008a,b; Ballesteros-
Paredes et al. 2020). With the resolution adopted in the refer-
ence simulation (1283 SPH particles), these parameters lead to a
mass for each gas particles of 9.3 M(cid:12). In addition, we introduced
the gas thermal behaviour according to the method described in
Vázquez-Semadeni et al. (2007), adopting the parametric heat-
ing and cooling functions from Koyama & Inutsuka (2002).

We gradually developed a divergence-free turbulent ﬁeld by
injecting a ﬁxed amount of energy at each integration time-step,
giving a random velocity kick to each gas particle. We deﬁned
this energy input using a prescription from Mac Low (1999)
such that the equilibrium with the turbulent dissipation would be
reached when the box had a velocity dispersion of Vrms (see Ta-
ble A.2 for the exact values in the simulations). We generate the
kicks according to a Gaussian random ﬁeld having ﬂat spectrum

Article number, page 2 of 9

only in between kkick ≤ k ≤ kkick + 1, where we randomly chose
the value of kkick at each time-step from a uniform distribution in
the range listed in Table A.2.

We did not include the self-gravity of the gas. However, the
supersonic turbulent motions (with Vrms ≈ 15 times the sonic
speed at equilibrium for gas densities of n = 10 cm−3) and the
thermal instability (Field 1965) allowed by the heating and cool-
ing functions are suﬃcient to create dense structures in the gas.
Moreover, in our set-up, we do not expect gravity to play a cru-
cial role on the large scale structures (see also, e.g., Klessen et al.
2000 for an in-depth study of the relative importance of gravity
and supersonic motions in highly turbulent environments.). Fur-
ther details of the environmental setup are in Suin (2022).

2.3. Cluster and environment

In the environmental simulations of clusters, we ﬁrst let the envi-
ronment fully develop the turbulent ﬁeld. Once the velocity dis-
persion of the box stabilises on the desired Vrms, we insert the star
cluster. To avoid the phase space of the simulations becoming too
wide, we limited this part of the study to a single set of parame-
ters of the background (Vrms = 15 km s−1 and kkick ∈ [4, 8], using
a resolution of 1283 SPH particles; see Table A.2). This setup
mimics the mean velocity dispersion (Mac Low & Klessen 2004;
Dib et al. 2006; Klessen & Hennebelle 2010; Kritsuk et al. 2017)
and driving wavelength of the physical regions we are schema-
tising (cf. Norman & Ferrara 1996; Scalo & Elmegreen 2004;
Brunt et al. 2009). We also check that there are no massive struc-
tures nearby as they could alter the dynamical evolution signif-
icantly – we required that the mass of gas included within two
virial radii was (cid:46) 5 % of the cluster mass. The systems then con-
tinue to evolve together, with the cluster perceiving the potential
generated by the environment. We treated this interaction using
the Bridge routine implemented in AMUSE, and letting the code
Fi (Gerritsen & Icke 1997; Pelupessy et al. 2004) generate the
potential ﬁeld of the gas (Rieder et al. 2022). We note that the
domain of the gaseous environment is periodic. Thus, stars es-
caping the cluster at higher velocities can depart arbitrarily far
from the cluster and still feel the generated potential.

3. Results

We describe the impact of the surrounding environment on the
star cluster evolution in three separate ways. First, we focus on
the eﬀect of environmental harassment on the core evolution. In
the second part, we analyse the cluster outer density distribution.
Finally, we look at the overall stellar mass loss.

3.1. Core evolution

Although the tidal force acting on the stars increases linearly
with the distance from the cluster centre, the environment also
has a profound eﬀect on the inner parts of the cluster – its pres-
ence leads to a quantitative acceleration of the core contraction.
Tidal shocks increase the velocity dispersion of the cluster so
that more stars evaporate from the core to the outer halo. This
acts in the same direction as the dynamical relaxation, and the
evolution of the core speeds up (Spitzer 1987). We can see this
for selected models in Fig. 1 which shows the evolution of the
core radius, deﬁned as

rc =

(cid:115) (cid:80)
i ρ2
i r2
i
(cid:80)
i ρ2
i

(1)

Suin, Shore & Pavlík: Star Clusters in Turbulent Molecular Clouds

Fig. 1. Evolution of the core radius, see Eq. (1), normalised to the initial core radius. The plots show the clusters with the Salpeter IMF or equal-
mass stars, both isolated and embedded into the environment (as labelled in the legends, we note that the two black lines are almost superimposed).
The left-hand plot shows the more compact models with rvir = 0.7 pc, the right-hand one is for rvir = 1.3 pc. The moments of core collapse are
highlighted with a vertical line.

(cf. Aarseth 2003). Here ρi is the density estimator near the i-th
cluster member, computed with the Hop clump-ﬁnd algorithm
(Eisenstein & Hut 1998) using its nearest 12 neighbours, and
ri is its distance from the cluster density centre (Casertano &
Hut 1985). Both compact models with an IMF experience core
collapse (highlighted with a vertical line in the left-hand plots of
Fig. 1), but the environmental run reaches it sooner. This faster
contraction of the core is also evident in the models where core
collapse did not happen within the simulated temporal interval
(see how the lines spread in the right-hand plot). Moreover, the
plots show that the presence of a background has almost no eﬀect
on the core evolution of the equal mass clusters (the black lines
remains superimposed during the whole simulation). The same is
true during the very ﬁrst phases of evolution in cluster with IMF
(up to 10 Myr in the compact cluster and 30 Myr in the other).

Although useful for tracking the temporal development of
the core, Eq. (1) is a functional form that diﬀers from the actual
core radius in a way that depends on the shape of the cluster
itself (see, e.g., Table 2 in Casertano & Hut 1985). To identify
the moment of core collapse, tcc, we followed the self-similar
argument of Lynden-Bell & Eggleton (1980). The core radius
evolves as

rc(t) ∝ (tcc − t)2/(6−α) ,

(2)

for t ≤ tcc, where α is a ﬁtting parameter determined through
numerical simulations. To apply this equation, we used the pro-
cedure of Pavlík & Šubr (2018) who show that before core col-
lapse, the minima of Lagrangian radii are a ﬁxed multiple of rc.
Consequently, the evolution of these minima follows Eq. (2)2.

Tab. 1 displays the results of the ﬁt for the core collapsed
clusters. In all simulations, we recover the expected value of
α ≈ 2.21 (e.g., Takahashi 1995; Lynden-Bell & Eggleton 1980)
within 3 σ uncertainties. However, there is a tendency towards
lower values in the simulations with an upper mass limit of

2 During their evolution, Lagrangian radii exhibit large ﬂuctuations.
These are particularly important in the inner regions, where the number
of star is small, leading to a high statistical noise. To achieve a greater
accuracy in the localisation of the minima, we smoothed the Lagrangian
radii, using Savitzky & Golay (1964) smoothing algorithm with a sec-
ond degree polynomial, as in Pavlík & Šubr (2018). The smoothing
window corresponded to 9 data-points, i.e., 4.5 Myr. The algorithm is
implemented in Python as scipy.signal.savgol_filter.

Table 1. List of ﬁt results. The ﬁrst column identiﬁes the run (with Nb
highlighting the reference N-body runs), the second the time at which
the core collapsed according to the ﬁt algorithm and the third the expo-
nent α. We note that the higher uncertainties in run R13_Sal6_Nb are
physical, see the text.

Name
R07_Sal3
R07_Sal3_Nb
R07_Sal6
R07_Sal6_Nb
R13_Sal6
R13_Sal6_Nb
R13_Kr6
R13_Kr6_Nb

tcc/Myr
45.6 ± 0.2
49.6 ± 0.3
22.0 ± 0.1
20.3 ± 0.3
53.1 ± 0.4
58.2 ± 3.0
61.1 ± 0.1
66.0 ± 0.7

α
2.29 ± 0.23
2.32 ± 0.17
1.99 ± 0.13
1.87 ± 0.28
2.00 ± 0.27
2.32 ± 0.41
1.56 ± 0.22
2.13 ± 0.31

6 M(cid:12). This is compatible with the result of Pavlík & Šubr (2018),
who found α ≈ 1.5 using a Salpeter IMF with an about ten
times wider range than ours. The R13_Sal6_Nb model shows
the greatest error in both ﬁt parameters. In this simulation, the
core contraction is less pronounced, which makes the location of
the Lagrangian radii minima extremely sensitive to random ﬂuc-
tuations. Concerning the moment of collapse, Tab. 1 shows that
the gaseous background accelerates the cluster evolution. Envi-
ronmental simulations display smaller tcc with respect to their
N-body counterpart. The only exception is run R07_Sal6, for
which the dynamical timescale is short and the eﬀect of the en-
vironment is negligible.

We also analysed the binary ejected by the clusters after
core collapse. There is a good correlation between the forma-
tion of the ﬁrst tight binary (cf. Fujii & Zwart 2014; Pavlík &
Šubr 2018). We repeated the simulation R07_Sal6 four times
with the environment and eight without increasing the size of
the ejected binaries sample. We did not detect any statistically
signiﬁcant diﬀerence between the binding energy distributions
extracted from the two cases. We refer to Suin (2022) for the
in-depth study of the binary characteristics.

3.2. Outer region

We evaluated the impact of the background on the evolution of
the radial density proﬁle of the outer region. We chose the radial

Article number, page 3 of 9

020406080100t[Myr]0.11rc/rc,0R07_NoImf_NbR07_NoImfR07_Sal3_NbR07_Sal3020406080100t[Myr]0.11rc/rc,0R13_NoImf_NbR13_NoImfR13_Sal3_NbR13_Sal3A&A proofs: manuscript no. main

Fig. 3 shows the temporal evolution of β in the simulations
with and without the ambient gas, along with the indicator Ξtid
of the environmental run. In the isolated simulations, β remains
almost constant initially, ﬂuctuating around the initial value of 5
(which comes from the Plummer model). It then starts to de-
crease approximately linearly in time while approaching core
collapse.

Fig. 2. Temporal evolution of the modulus of the surface density expo-
nent in the simulation R07_Sal3, projected onto the planes xz (blue)
and yz (red). We smoothed the data with a simple moving weighted av-
erage between 5 points (2.5 Myr). The black line shows the value of Ξtid
(axes on the right), computed at the centre of the cluster.

shells between the 94 % and 98 % Lagrangian radii with binning
by 0.5 % and performed a least-square ﬁt for the power-law

ρ(r) ∝ r−β .

(3)

We selected the lower bound to achieve an error smaller than
5 % for a Plummer model ﬁt3. The upper bound reduces the im-
pact of statistical relative ﬂuctuations (bigger in the more sparse
regions) on the ﬁt. The procedure implicitly assumes spherical
symmetry. This, however, is justiﬁed by Fig. 2, which shows
the behaviour of the surface density in run R07_Sal3 projected
on the planes xz and yz. The two sequences closely follow
each other, so the three-dimensional nature of the problem only
marginally aﬀects the exponent β.

To compare the behaviour of β with the tidal ﬁeld acting on
the cluster, we deﬁned the variable Ξtid(t) as the sum in quadra-
ture of tidal tensor elements, computed at the cluster core cen-
tre xc,

(cid:113)

Ξαβ(xc, t)Ξαβ(xc, t) ,

Ξtid(t) ≡

where

Ξαβ(xc, t) ≡ −

∂2φ
∂xα∂xβ

(xc, t) ,

(4)

(5)

and φ(x, t) is the gravitational potential per unit mass generated
by the gas at time t. We adopt the Einstein convention, summing
over repeated indices. Ξtid(t) has dimension of Myr−2 and is in-
variant under the change of coordinates, so it provides a good
indicator of the strength of the tidal ﬁeld aﬀecting the cluster.
To give an idea of the physical value of Ξtid, a point-like ob-
ject of mass Mg and distance Rg from the cluster would exert
Ξtid =

g. In physical units, this scales as

6 GMg/R3

√

Runs with the environment show greater ﬂuctuations of β.
In addition, we see that the eﬀect of the background increases if
the cluster is wider and its evolutionary phase more advanced.
Large clusters are more sensitive to tides, and the core contrac-
tion sends stars out to the halo, where tides are stronger. A com-
parison between R07_NoImf (Fig. 3a) and R13_NoImf (Fig. 3c)
allows us to discuss the ﬁrst aspect. Without a mass function,
the dynamical evolution of these clusters is almost negligible
throughout the simulations (see the black lines in Fig. 1), and
we can extract the eﬀect of the tides on the evolution directly.
The clusters do not signiﬁcantly diﬀer from the evolution of their
isolated counterpart. However, the ﬂuctuations are bigger in both
cases. The same can also be inferred from R30_Sal6 (Fig. 3f) –
in this case, the low stellar density slows down the mass seg-
regation process and makes its dynamical development simi-
larly slow as in the equal-mass case. In addition, in R13_NoImf
(Fig. 3c) the trigger for the largest ﬂuctuations in β is the ma-
jor encounter at ≈ 10, 40 , 65 Myr, although in run R07_NoImf
it is not possible to extract a clear correspondence between close
encounters (peaks in Ξtid) and variation of the power-law slope.
the evolutionary
timescale, and enhances the eﬀect of the background. Core col-
lapsed clusters (Fig. 3a-3e) display a more step-like evolution
of the exponent β when inserted into the environment. While
approaching core collapse, the density gradient becomes more
sensitive to the peaks in Ξtid. Close to these peaks, β initially in-
creases and the cluster becomes more compact. Then, stars pop-
ulate the outer halo and β decreases. The situation is similar in
Gieles et al. (2006), where the simplest example consists in a
head-on encounter of the cluster with a spherical cloud. While
approaching the cloud, the cluster contracts as stars suﬀer a net
acceleration toward the centre along the direction perpendicular
to the motion. After the encounter, the cluster expands due to
the relative perpendicular velocities acquired by particles. The
parallel velocity variation, instead, cancels out during the whole
encounter.

Widening the mass

range decreases

By the end of the simulation, the harassed clusters display
softer outer power-law slopes. This also shows up in the last
≈ 20 Myr of model R13_Sal3 (Fig. 3d), which at the end of the
simulation is close to experiencing core collapse (as can also be
deduced from Fig. 1). When far from core collapse, these clus-
ters behave similarly to the equal mass case. At early stages of
evolution, its shape did not change, and the environment does not
aﬀect the outer region permanently. Even though showing larger
ﬂuctuation than the reference runs, β does not depart signiﬁ-
cantly from the initial value. As soon as a tidal shock occurs and
the cluster has an evolved conﬁguration, β departs from the linear
behaviour of the isolated case (see the shocks at ≈ 40, 70 Myr
and the subsequent decrease in β in Fig. 3a–3e).

Ξtid ∼ 0.01

(cid:32) Mg
103 M(cid:12)

(cid:33) (cid:32) Rg
10 pc

(cid:33)−3

Myr−2 .

The trace, in this case, would be zero.

3 For a Plummer model of scale radius a, β = 5x2/(1 + x2), where
x ≡ r/a. Taking r to be the 94 % Lagrangian radius, the exponent diﬀers
from its asymptotic value by ≈ 0.045

Article number, page 4 of 9

(6)

3.3. Cluster mass loss

To determine whether a star is bound to the cluster is not straight-
forward when an external potential is present. The cluster mem-
bers are constantly interacting with the gaseous environment
which can diﬀerentially accelerate them. While passing through
or near a cloud, a star in the cluster gains enough kinetic en-

Suin, Shore & Pavlík: Star Clusters in Turbulent Molecular Clouds

(a) R07_NoImf

(b) R07_Sal3

(c) R13_NoImf

(d) R13_Sal3

(e) R13_Sal6

(f) R30_Sal6

Fig. 3. Evolution of β throughout a selected set of simulations, with the axis on the left. The shaded areas identify the value of the ﬁt within
1σ (blue for the N-body runs, red for those with environment). We smoothed the data with a simple moving weighted average of width 2.5 Myr
(5 model outputs). The black line shows the value of Ξtid of the environmental runs, as in Fig. 2 (axis on the right). The vertical dashed lines in the
plots (b) and (e) highlight the moment of core collapse (see also Tab. 1).

ergy to appear unbound, and the usual deﬁnition, which labels
escaping stars based on their instantaneous binding energy to the
system, fails. However, over a whole encounter, only the orthog-
onal velocity component remains high, while any velocity gains
in the parallel component cancel out. To avoid the ﬂuctuations

in the mass loss due to these encounters, we only mark as “es-
capers” the stars that remain unbound throughout the last 5 Myr
of the simulation (see Appendix B for further justiﬁcation of this
choice).

Article number, page 5 of 9

020406080100t[Myr]4.004.254.504.755.005.255.505.756.00βN-bodyrunEnvironmentalrunΞtid0.050.100.150.20Ξtid[Myr−2]020406080100t[Myr]020406080100t[Myr]4.004.254.504.755.005.255.505.756.00β0.050.100.150.20Ξtid[Myr−2]020406080100t[Myr]020406080100t[Myr]4.004.254.504.755.005.255.505.756.00β0.050.100.150.20Ξtid[Myr−2]020406080100t[Myr]A&A proofs: manuscript no. main

Table 2. Mass loss of simulated cluster computed at 95 Myr. The ﬁrst
column is the name of the run with environment and IMF, in which mass
loss is speciﬁed in the second column. That of the respective isolated
cluster is shown in the second column, while the fourth and the ﬁfth are
the mass loss from simulation of the same cluster without IMF.

Cluster

R07_Sal3
R07_Sal6
R13_Sal3
R13_Sal6
R13_Kr3
R13_Kr6
R30_Sal3
R30_Sal6

IMF
2.47
3.66
0.46
1.73
0.77
1.47
1.73
1.89

% Mlost

IMF, Nb No IMF No IMF, Nb

1.78
3.25
0.24
1.02
0.32
1.22
0.15
0.18

0.14
0.14
0.26
0.26
0.26
0.26
1.64
1.64

0.08
0.08
0.01
0.01
0.01
0.01
< 0.01
< 0.01

Tab. 2 provides the mass lost in each simulation after 95 Myr.
In every simulation, the mass loss from the isolated equal mass
cluster is negligible. This supports the choice of using the em-
bedded equal mass cluster as a reference for the evolution caused
only by environmental harassment. As expected, the importance
of the tides increases as the cluster expands. In contrast, the mass
lost in pure N-body simulations depends only on the mass seg-
regation timescale, which is proportional to ρ−1/2 and inversely
proportional to the width of the IMF.

Finally, it is worth noting that two-body relaxation and tidal
interactions aﬀect the IMF in diﬀerent ways. The former causes
mass segregation with higher-mass stars moving inward and
lower-mass stars outward, which enables the lower-mass stars to
evaporate from the cluster (see also, e.g., Chandrasekhar 1942;
Spitzer 1969; Binney & Tremaine 2008). The cluster then forms
a dense core of high-mass stars and once it starts to collapse,
binaries form in the centre. These perturb their neighbours, and
we begin to observe massive stars escaping from the mass segre-
gated core (see also Hills 1975; Hut 1985). On the other hand, if
the relaxation timescales are long, the cluster does not segregate
as quickly and the tidal harassment is the dominant reason for
mass-loss. Stars are peeled-oﬀ from the outer regions indepen-
dent of their masses. Consequently, the relative contributions of
these two processes determine the mass distribution of the es-
capers. This is shown in Fig. 5, where the mass distribution of
escaping stars divided by the original IMF in models R07_Sal13
and R07_Sal13_Nb. When the environment is present, the tidal
shocks enhance fraction of escaping stars at intermediate masses.
Instead, the loss of massive stars, similar in the two models, can
be linked to the relaxation process ongoing in the core that is
composed almost exclusively of massive stars and binaries at
later times. In our model, the percentage of mass loss is small
so this does not signiﬁcantly aﬀect the mass function of the re-
maining members. However, the same process happens in pro-
toclusters still embedded in the parent cloud. Their gas density
is orders of magnitude higher than our n = 10 cm−3, and struc-
tures are closer to the cluster (Kruijssen et al. 2012; Kruijssen
2012). At the same time, the IMF of massive protoclusters is
much wider, since massive stars are still on the main sequence,
so that the evolutionary timescale is also reduced (Allison et al.
2009; Yu et al. 2011). In the end, the eﬀects we described could
indeed play a crucial role when inferring the IMF of young clus-
ters.

Fig. 4. Evolution of the cluster mass loss in percents of the total initial
mass (see the text for the deﬁnition).

Fig. 5. Mass distribution of escapers normalised to the initial IMF for
the runs R07_Sal3 (red) and its N-body reference run (blue).

Fig. 4 shows two examples of the cumulative mass loss over
time, comparing the simulations with and without the environ-
ment, along with the mass loss from the equal mass clusters.
This highlights the presence of a coupling mechanism between
the two evolutions. As for the outer density distribution, the cou-
pling only shows up when both eﬀects are present. The mass loss
of run R07_Sal3 is particularly explanatory (see the top panel
of Fig. 4), as it follows the isolated cluster until just before core
collapse. In addition, after core collapse the mass loss presents a
steeper increase than in the isolated cluster.

Article number, page 6 of 9

020406080100t[Myr]0.00.51.01.52.02.5%MlostR07_NoImf_NbR07_NoImfR07_Sal3_NbR07_Sal3020406080100t[Myr]0.00.51.01.52.02.5%MlostR13_NoImf_NbR13_NoImfR13_Sal6_NbR13_Sal60.150.5123m?[M(cid:12)]10−210−1RelativeescapefractionR07_Sal3_NbR07_Sal3Suin, Shore & Pavlík: Star Clusters in Turbulent Molecular Clouds

4. Limitations
The choice of initial conditions has trade-oﬀs. Adopting the
Plummer model and truncating the IMF at 6 M(cid:12) allows us to
avoid the more complex stages of the cluster formation that a
more physical model would require. However, stellar evolution
and feedback play a signiﬁcant role when including younger
stars with higher masses. Massive stars sink faster toward the
cluster centre and die earlier (Portegies Zwart et al. 2007). The
presence of a denser environment also enhances tidal perturba-
tions. Nevertheless, the mechanisms studied here will impact the
evolution of the cluster. Regarding the background setup, we
mimicked the averaged observed values of star-forming regions.
The constant energy input generated a constant turbulent ﬁeld
in which structures formed and dissolved. The feedback mecha-
nisms acting in such environments are complicated and still far
from completely understood. Adding self-gravity increases the
computational times due to the collapsing high-density regions.
Our work is, instead, intended to show that even simple models
have observational consequences and to provide insights regard-
ing the interplay between the dynamical evolution of star clus-
ters and the gaseous background that will only be magniﬁed by
achieving more physical simulations.

5. Conclusions

We conducted a series of numerical simulations following the
evolution of both the star cluster and its surrounding ISM en-
vironment. Gaseous structures, created by supersonically driven
turbulent motions, produced a spatially and temporally varying
external potential which perturbed the embedded cluster.

The core evolution and the external power-law slope of the
density distribution both exhibited eﬀects induced by the gas.
The tidal shocks increase the fractions of core stars that are sent
into the halo. This process acts similarly to dynamical relaxation.
We note that this sped-up redistribution of energy can also con-
tinue to later stages of the cluster evolution, every time the clus-
ter passes through a star-forming region. This supports the ﬁnd-
ing of Gnedin et al. (1999) of a reduced core collapse timescale
using spherical Fokker–Planck models.

For the cluster periphery, we found that the exponent of the
asymptotic density distribution, β, displays greater ﬂuctuations
induced by the environment. While approaching core collapse,
tides signiﬁcantly aﬀect β. The slope departs from the almost lin-
ear temporal evolution expected in the isolated case, displaying
a more step-like behaviour. In addition, all core collapsed runs
end up with a lower value of β as a result of the accelerated evo-
lution. Both eﬀects would contribute to observing more clusters
in a more relaxed and expanded conﬁguration (e.g., Portegies
Zwart et al. 2010; Banerjee & Kroupa 2017).

This coupling also manifests in the cluster mass loss. In each
environmental simulation, the ﬁnal mass loss is larger than the
sum of the respective reference runs. This highlights a coupling
between the dynamical evolution and the presence of the envi-
ronment.

Acknowledgements. We thank Maurizio Davini and the Direzione Infrastrutture
Digitali of the University of Pisa for providing access to two 128-core DELL
R630i servers of the High-Performance Computing Division of the San Piero a
Grado Green Data Center, without which this work would not have been possi-
ble. We are grateful to Veronica Roccatagliata and Michele Cignoni for insight-
ful discussions. We also thank the AMUSE team for the support provided. This
research has made use of NASA’s Astrophysics Data System Bibliographic Ser-
vices. The Python programming language with NumPy (Harris et al. 2020) and
Matplotlib (Hunter 2007) were used in this project.

References

Aarseth, S. J. 2003, Gravitational N-Body Simulations (University of Cambridge

Press)

Adamo, A., Zeidler, P., Kruijssen, J. M., et al. 2020, Space Sci. Rev., 216, 69
Ahmad, A. & Cohen, L. 1973, Journal of Computational Physics, 12, 389
Allison, R. J., Goodwin, S. P., Parker, R. J., et al. 2009, ApJ, 700, L99
Ballesteros-Paredes, J., André, P., Hennebelle, P., et al. 2020, Space Sci. Rev.,

216, 76

Banerjee, S. & Kroupa, P. 2017, A&A, 597, A28
Barnes, J. & Hut, P. 1986, Nature, 324, 446
Binney, J. & Tremaine, S. 2008, Galactic Dynamics: Second Edition (Princeton

University Press)

Blitz, L. & Shu, F. H. 1980, ApJ, 238, 148
Brunt, C. M., Heyer, M. H., & Mac Low, M. M. 2009, A&A, 504, 883
Casertano, S. & Hut, P. 1985, ApJ, 298, 80
Chandrasekhar, S. 1942, Principles of Stellar Dynamics (University of Chicago

Press), 321

Chernoﬀ, D. F. & Weinberg, M. D. 1990, ApJ, 351, 121
Chevance, M., Kruijssen, J. M. D., Vazquez-Semadeni, E., et al. 2020,

Space Sci. Rev., 216, 50

Colín, P., Vázquez-Semadeni, E., & Gómez, G. C. 2013, MNRAS, 435, 1701
Dib, S., Bell, E., & Burkert, A. 2006, ApJ, 638, 797
Eisenstein, D. J. & Hut, P. 1998, ApJ, 498, 137
Elmegreen, B. G. 2007, ApJ, 668, 1064
Elson, R. A. W., Fall, S. M., & Freeman, K. C. 1987, ApJ, 323, 54
Federrath, C. & Klessen, R. S. 2013, ApJ, 763, 51
Field, G. B. 1965, ApJ, 142, 531
Fujii, M. S. & Zwart, S. P. 2014, MNRAS, 439, 1003
Gerritsen, J. P. & Icke, V. 1997, A&A, 325, 972
Gieles, M., Portegies Zwart, S. F., Baumgardt, H., et al. 2006, MNRAS, 371, 793
Gnedin, O. Y., Lee, H. M., & Ostriker, J. P. 1999, ApJ, 522, 935
Gnedin, O. Y. & Ostriker, J. P. 1997, ApJ, 474, 223
Grosbøl, P. & Dottori, H. 2012, A&A, 542, A39
Harris, C. R., Millman, K. J., van der Walt, S. J., et al. 2020, Nature, 585, 357
Heiner, J. S., Allen, R. J., Emonts, B. H. C., & van der Kruit, P. C. 2008a, ApJ,

673, 798

Heiner, J. S., Allen, R. J., Wong, O. I., & Van Der Kruit, P. C. 2008b, A&A, 489,

533

Hills, J. G. 1975, AJ, 80, 809
Hunter, J. D. 2007, Computing in Science & Engineering, 9, 90
Hut, P. 1985, in Dynamics of Star Clusters: Proceedings of the 113th Symposium
of the International Astronomical Union, ed. J. Goodman & P. Hut (Princeton
(New Jersey, U.S.A): Reidel Publishing Company), 231–249

Kim, J., Chevance, M., Diederik Kruijssen, J. M., et al. 2021, MNRAS, 504, 487
Kippenhahn, R., Weigert, A., & Weiss, A. 2012, Stellar Structure and Evolution,
Astronomy and Astrophysics Library (Berlin, Heidelberg: Springer Berlin
Heidelberg)

Klessen, R. S., Heitsch, F., & Mac Low, M.-M. 2000, ApJ, 535, 887
Klessen, R. S. & Hennebelle, P. 2010, A&A, 520, 17
Koyama, H. & Inutsuka, S.-I. 2002, ApJ, 564, L97
Kritsuk, A. G., Ustyugov, S. D., & Norman, M. L. 2017, New J. Phys., 19,

065003

Kroupa, P. 2001, MNRAS, 322, 231
Kruijssen, J. M. D. 2012, MNRAS, 426, 3008
Kruijssen, J. M. D., Maschberger, T., Moeckel, N., et al. 2012, MNRAS, 419,

841

Kruijssen, J. M. D., Schruba, A., Chevance, M., et al. 2019, Nature, 569, 519
Kuhn, M. A., Hillenbrand, L. A., Sills, A., Feigelson, E. D., & Getman, K. V.

2019, ApJ, 870, 32

Kustaanheimo, P. & Stiefel, E. 1965, J. Reine Angew. Math., 1965, 204
Lada, C. J. & Lada, E. A. 2003, ARA&A, 41, 57
Lynden-Bell, D. & Eggleton, P. P. 1980, MNRAS, 191, 483
Mac Low, M. 1999, ApJ, 524, 169
Mac Low, M.-M. & Klessen, R. S. 2004, Reviews of Modern Physics, 76, 125
Norman, C. A. & Ferrara, A. 1996, ApJ, 467, 280
Pavlík, V. & Šubr, L. 2018, A&A, 620, A70
Pelupessy, F. I., Van Der Werf, P. P., & Icke, V. 2004, A&A, 422, 55
Pelupessy, F. I., van Elteren, A., de Vries, N., et al. 2013, A&A, 557, A84
Plummer, H. C. 1911, MNRAS, 71, 460
Portegies Zwart, S. & McMillan, S. 2018, Astrophysical Recipes: The art of

AMUSE (IOP Publishing)

Portegies Zwart, S., McMillan, S., Harfst, S., et al. 2009, New A, 14, 369
Portegies Zwart, S. F., McMillan, S. L., & Gieles, M. 2010, ARA&A, 48, 431
Portegies Zwart, S. F., McMillan, S. L., & Makino, J. 2007, MNRAS, 374, 95
Rieder, S., Dobbs, C., Bending, T., Liow, K. Y., & Wurster, J. 2022, MNRAS,

509, 6155

Roccatagliata, V., Franciosini, E., Sacco, G. G., Randich, S., & Sicilia-Aguilar,

A. 2020, A&A, 638, A85

Article number, page 7 of 9

A&A proofs: manuscript no. main

Roccatagliata, V., Sacco, G. G., Franciosini, E., & Randich, S. 2018, A&A, 617,

L4

Salpeter, E. E. 1955, ApJ, 121, 161
Savitzky, A. & Golay, M. J. 1964, Anal. Chem., 36, 1627
Scalo, J. & Elmegreen, B. G. 2004, ARA&A, 42, 275
Spitzer, L. 1969, ApJ, 158, L139
Spitzer, L. 1987, Dynamical Evolution of Globular Clusters (University of

Princeton Press)

Spitzer, L. & Shapley, H. 1940, MNRAS, 100, 396
Springel, V. 2005, MNRAS, 364, 1105
Suin, P. 2022, Master’s thesis, Department of Physics, University of Pisa,

https://etd.adm.unipi.it/t/etd-01062022-202945/

Takahashi, K. 1995, PASJ, 47, 561
Terlevich, E. 1987, MNRAS, 224, 193
Vázquez-Semadeni, E. 1994, ApJ, 423, 681
Vázquez-Semadeni, E., Gómez, G. C., Jappsen, A. K., et al. 2007, ApJ, 657, 870
Wang, L., Iwasawa, M., Nitadori, K., & Makino, J. 2020, MNRAS, 497, 536
Yu, J., de Grijs, R., & Chen, L. 2011, ApJ, 732, 16

Article number, page 8 of 9

Suin, Shore & Pavlík: Star Clusters in Turbulent Molecular Clouds

Appendix A: Model parameters

Table A.1. List of N-body simulations of the star cluster. For each one, the follow-
ing initial parameters are given: the virial radius, the core density, the IMF and its
mass range, and the mean stellar mass. We note that the total mass of each model is
104 M(cid:12).

rvir/pc ρc/(M(cid:12) pc−3)

Name
R07_NoImf
R07_Sal3
R07_Sal6
R07_Kr6
R13_NoImf
R13_Sal3
R13_Sal6
R13_Kr3
R13_Kr6
R30_NoImf
R30_Sal3
R30_Sal6

0.7
0.7
0.7
0.7
1.3
1.3
1.3
1.3
1.3
3.0
3.0
3.0

3.5 · 104
3.5 · 104
3.5 · 104
3.5 · 104
5.5 · 103
5.5 · 103
5.5 · 103
5.5 · 103
5.5 · 103
5.0 · 102
5.0 · 102
5.0 · 102

IMF
eq. mass
Salpeter
Salpeter
Kroupa
eq. mass
Salpeter
Salpeter
Kroupa
Kroupa
eq. mass
Salpeter
Salpeter

m/M(cid:12)
—
[0.15, 3]
[0.15, 6]
[0.1, 6]
—
[0.15, 3]
[0.15, 6]
[0.1, 3]
[0.1, 6]
—
[0.15, 3]
[0.15, 6]

(cid:104)m(cid:105)/M(cid:12)
0.38
0.38
0.42
0.48
0.38
0.38
0.42
0.43
0.48
0.38
0.38
0.42

Table A.2. List of SPH simulations of the environment.
For each one, the following initial conditions are given: the
root mean square velocity, the range of the kick wavenum-
ber, and the number of SPH particles. We note that the
mean number density is (cid:104)n(cid:105) = 10 cm−3 and the simulation
box size is L = 400 pc in all models.

Name
V10_k[4-8]
V15_k[4-8]_lra
V15_k[4-8]b
V15_k[4-8]_hra
V15_k[2-4]
V15_k[8-16]
V20_k[4-8]
V40_k[4-8]

Vrms/km s−1
10
15
15
15
15
15
20
40

kkick
[4, 8]
[4, 8]
[4, 8]
[4, 8]
[2, 4]
[8,16]
[4, 8]
[4, 8]

Nsph
1283
643
1283
2563
1283
1283
1283
1283

Notes. (a) Labels “lr” and “hr” identify the low and high
resolution runs, respectively.
(b) V15_k[4-8] is the model used in the simulations of star
clusters embedded in the environment.

Appendix B: Stellar mass loss

Encounters with the environment increase the velocities of stars relative to the cluster centre, making them appear unbound for a
short period of time (see the red line in Fig. B.1. The spikes, which show the instantaneous increase of the number of stars with
positive energy, correspond to the moments when the cluster passes near a cloud. After the passage, most stars decelerate and return
to a bound state. To minimise these episodic ﬂuctuations, we consider as “escapers” only stars that appear unbound for the last
5 Myr of the simulation (see the black lines in Fig. B.1, and also Mlost in Sect. 3.2, Fig. 4 and Tab. 2). The choice of this particular
interval is dictated by the time with which the autocorrelation of Ξtid, averaged between the simulations, crosses zero (see Suin
2022 for further details). An alternative method is to label as escapers those stars that remain unbound for at least some predeﬁned
interval, τw, starting from the time of their ﬁrst detection as unbound. In this way, the evolution of Mlost is independent of the ﬁnal
state of the system. A limitation is that its monotonicity might be lost if τw were too small (see, e.g., the yellow line in Fig. B.1).
If, however, τw = 5 Myr this method and the one we used in Sect. 3.2 are equivalent, with the latter being less computationally
demanding.

Fig. B.1. Comparison of the methods to compute the fractional mass loss in model R07_Sal6. Left: Comparison between our model (black) and
the mass loss calculated instantaneously (red). Right: The alternative method proposed in the text compared to our model (black line), coloured
lines correspond to diﬀerent window lengths τw.

Article number, page 9 of 9

020406080100t[Myr]0.000.020.040.060.080.100.12%MlostInstantaneousOurmethod020406080100t[Myr]0.000.010.020.030.040.05%Mlostτw=1Myrτw=5MyrOurmethod