2
2
0
2

n
u
J

4
2

]

M

I
.
h
p
-
o
r
t
s
a
[

1
v
4
0
5
2
1
.
6
0
2
2
:
v
i
X
r
a

Gamma-ray detector and mission design
simulations

Eric A. Charles and Henrike Fleischhack and Clio Sleator

Abstract Detectors for gamma-ray astronomy are complex: they often comprise
multiple sub-systems and utilize new and/or custom-developed detector components
and readout electronics. Gamma rays are typically not detected directly: ground-
based detectors measure extensive air showers of charged particles initiated by cos-
mic gamma-rays, and even so-called “direct detection” experiments on balloons
or satellites usually reconstruct the incoming gamma-ray photons’ properties from
the secondary particles produced in the detector. At the same time, there are few
“standard candles” and no feasible terrestrial sources of high-energy and very-high-
energy gamma rays that could be used to calibrate the detectors. Simulations of par-
ticles interacting in the atmosphere and/or with the instrument are thus ubiquitous in
gamma-ray astronomy. These simulations are used in event reconstruction and data
analysis, to characterize detector performance, and to optimize detector design. In
this chapter, we give an overview of how and why simulations are used in gamma-
ray astronomy, as well as their limitations. We discuss extensive air shower simula-
tions, simulations of gamma rays and secondary particles interacting in the detec-
tor, and simulations of the readout electronics. We provide examples for software
packages that are used for various aspects of simulations in gamma-ray astronomy.
Lastly, we describe the performance metrics and instrument response functions that
are generated from these simulations, which are critical to instrument design and
data analysis.

Eric A. Charles
Kavli Institute for Particle Astrophysics and Cosmology, SLAC National Accelerator Laboratory,
Menlo Park, CA 94025, USA e-mail: echarles@slac.stanford.edu

Henrike Fleischhack
Catholic University of America, Washington, DC 20064, USA; NASA/GSFC, Greenbelt, MD
20771, USA; CRESST II, Greenbelt, MD 20771, USA e-mail: fleischhack@cua.edu

Clio Sleator
U.S. Naval Research Laboratory, Washington DC 20375, USA e-mail: clio.sleator@nrl.
navy.mil

1

 
 
 
 
 
 
2

Eric A. Charles and Henrike Fleischhack and Clio Sleator

1 Keywords

gamma rays; simulations; monte-carlo technique; instrument response; air show-
ers; IACTs; balloon-based gamma-ray detection; space-based gamma-ray detection;
ground-based gamma-ray detection

2 Introduction: why we do simulations and how we use them

In the course of designing and operating gamma-ray telescopes and space missions,
many different types of Monte-Carlo simulations are used. Depending on the type
of instrument, these can include: simulations of the interactions between gamma
rays and the instrument, simulations of the interactions of the gamma-rays with
the atmosphere above the instrument, simulations of interactions of other types of
particles with the instrument or the atmosphere, simulations of the ﬂuxes of gamma-
rays from celestial sources incident on the instrument or atmosphere, simulations of
the ﬂuxes of other types of particles, and simulations of the electronics response to
the energy deposited in the active volumes of the detector by incoming particles.

In short, we use these simulations to explore the vastly complicated spaces of
source ﬂuxes, particle interaction chains, and detector responses that determine how
much of the ﬂux of celestial gamma rays a given instrument will detect, how accu-
rately it will measure interaction properties such as energy and incident direction,
and how much the gamma ray sample may be contaminated by other types of par-
ticles mis-identiﬁed as gamma rays. More speciﬁcally, we use the simulations to
characterize the response of a given instrument and instrument conﬁguration to a
set of known input ﬂuxes. We then use these characterized responses in a number of
ways.

While designing a telescope or mission, we use characterizations of the instru-
ment performance for “trade studies”, in which we explore the trade-offs associated
with various design choices to arrive at an optimal instrument design. Going a step
further, we can use the same characterizations to arrive at “sensitivity estimates”,
i.e., estimates of the minimum ﬂux detectable given a particular set of observations.
We can then use these sensitivity estimates to explore the science potential of a par-
ticular instrument; asking questions such as the number of sources the instrument
might detect, or the precision to which it might measure ﬂuxes or source positions.
When operating a telescope or mission, the role of simulations shifts somewhat.
Although some amount of instrument and observing strategy optimization will con-
tinue, during operations we primarily use simulations in the model ﬁtting we do
as part of the scientiﬁc data analysis. Speciﬁcally, most gamma-ray astronomy data
analysis is done with “forward folding” techniques, wherein we convolve a model
of source ﬂuxes with representation of the instrument response obtained from sim-
ulations and compare the result to the data obtained by the instrument. The model
ﬁtting procedure then consists of ﬁnding the set of model parameters which result
in the best ﬁt to the data.

Gamma-ray detector and mission design simulations

3

3 Common aspects of simulations

3.1 Astronomical inputs, sources, ﬂuxes, backgrounds

Astronomical inputs to simulations consist of two components: sources and back-
grounds. Astronomical sources can either be point sources, such as Gamma-Ray
Bursts (GRBs), neutron stars, etc., or diffuse emission, such as the positron anni-
hilation line from the Galactic center. When describing sources, in addition to the
source extent, the source position relative to the instrument must be speciﬁed, since
it affects the instrument response: for example, the instrument efﬁciency is gener-
ally higher for a source directly on-axis compared to a source at the edge of the ﬁeld
of view. The source ﬂux and energy spectrum information are related, as the ﬂux of
astrophysical sources is energy dependent. The energy spectrum is often given as
an empirical function such as a power law, in which case the ﬂux is usually given
at a single energy and then extrapolated to all energies. In the case of gamma ray
nuclear line sources, the energy spectrum is given as discrete single energies, and
potentially the associated line widths, each with a speciﬁed ﬂux.

Simulations of the background are required to determine instrument sensitivity
estimates, as well as to test certain aspects of analysis methods such as classifying
events as source or background. For satellite missions, cosmic rays are the main
source of background. Primary cosmic ray particles, predominantly protons, elec-
trons, and heavier ions, can interact directly with the instrument. Additionally, these
primary cosmic rays interact in the atmosphere, producing both charged and neutral
secondaries. Since the signature of charged particles and neutrons in a detector is
often sufﬁciently distinct from the signature of a gamma ray, charged particle back-
ground events are usually straightforward to identify. The gamma rays produced as
secondaries, however, are more difﬁcult to separate from source events.

Simulating the interaction of cosmic rays with the instrument is also important
to mimic instrument activation. When the instrument is bombarded with primary
and secondary cosmic ray particles, nuclear reactions are induced in the instrument
material and radioactive isotopes are formed. These radioactive isotopes decay and
can emit gamma rays that are difﬁcult to distinguish from source photons.

The spectrum and ﬂux of the cosmic ray background primarily depend on the
orbit altitude and inclination in addition to the current solar activity. See [16] and
[38] for in-depth discussions on cosmic ray background models.

The background environment changes for balloon-borne instruments that ﬂoat
at the upper edge of the atmosphere, and for ground-based instruments that detect
the highest energy gamma rays via Cherenkov radiation. At typical altitudes for
balloon-borne instruments (30-40 km), the albedo radiation produced by cosmic
rays interacting in the Earth’s atmosphere is much brighter than at satellite orbital
altitudes. Balloon backgrounds are often estimated using models based on data from
previous balloon ﬂights (e.g. [33]).

The dominant backgrounds for ground-based gamma ray detectors are due to
air showers induced by (charged) cosmic rays. While simulations are often used

4

Eric A. Charles and Henrike Fleischhack and Clio Sleator

for trade studies and to estimate sensitivities, data-driven background estimation
methods (e.g. using off-source data) are preferred whenever available due to the
uncertainties in both the cosmic-ray ﬂuxes/spectra and the air shower simulations.

i.e.,

Instruments detecting atmospheric Cherenkov emission,

imaging air-
Cherenkov Telescopes (IACTs), also suffer from so-called night-sky background
(NSB): optical and ultraviolet (UV) light from both astronomical and terrestrial
sources. NSB is affected by the phase of the moon, stars in the ﬁeld of view, and
atmospheric conditions (clouds, aerosols). NSB affects IACTs in several ways: ﬁrst,
by adding noise on top of real air shower signals, and second, by increasing the trig-
ger rate due to chance coincidences of noise. In some instruments, bright starlight
can also lead to camera pixels being temporarily turned off or removed from the
trigger. Purely NSB-induced events can be suppressed by increasing the trigger
threshold or applying cuts on the reconstruction quality, at the cost of increasing
the effective energy threshold and decreasing the effective area. NSB noise (from
measurements or dedicated simulations) is often added to the air shower simula-
tions after the fact, so that the same air shower simulations can be re-used under
different NSB conditions.

3.2 Detector geometries

In addition to the astronomical inputs, a mass model of the instrument is required
for simulations. The mass model describes the type, amount, and location of all of
the material that makes up the instrument. In addition to the active detectors, the
mass model must also include passive material since gamma rays can interact with
the passive material of the instrument. For example, gamma rays that ﬁrst interact
in passive (non-instrumented) material will enter the detectors with a lower energy,
which affects the measured spectrum, the event reconstruction, and the general in-
strument response; it is important to include these effects in simulations. The passive
material closest to the detectors should be modeled with as much detail as possible.
For a space-based instrument, the spacecraft bus should also be included in the mass
model.

Instrument activation can occur when cosmic rays interact in the instrument ma-
terial and produce radioactive isotopes, which then decay. These decays can produce
gamma rays which are then detected by the instrument. Simulating this activation
background component requires an accurate mass model, since the half-life of the
radioactive isotopes and the energy of the emitted gamma rays are dependent on the
speciﬁc materials used to build the instrument.

Gamma-ray detector and mission design simulations

5

3.3 Physics Input

Simulation engines used for gamma-ray astronomy have to take into account a vari-
ety of possible interactions with gamma-ray photons and charged particles with the
Earth’s atmosphere and/or the detector, as described in the following subsections.

3.3.1 Extensive air showers

When gamma rays with energies of tens of MeV or more strike the atmosphere, they
primarily interact via production of electron-positron pairs in the electric ﬁelds of
ambient electrons or ambient nuclei. If the newly produced electrons and positrons
are energetic enough, they can in turn emit gamma rays via Bremsstrahlung in the
same electric ﬁelds, which can produce more electron-positron pairs and so on.
This process continues until the energy of the electrons and positrons falls below
the critical energy of about 90 MeV, below which they tend to interact via ion-
ization rather than Bremsstrahlung. The resulting cascade of electrons, positrons,
and gamma rays is called an extended air shower. Hadronic cosmic rays (protons
and nuclei) can also initiate similar particle cascades when they collide with nuclei
in the atmosphere, producing pions and other mesons, nucleons, and fragments of
the original nuclei. Hadronic air showers may also contain muons, neutrinos, and
electro-magnetic sub-showers from meson decays. Hadronic air showers make up
the main background for ground-based gamma-ray telescopes. For more detailed
information see e.g. [25, 55].

The mean interaction length in air is given by χ0 = 37 g/cm2 for Bremsstrahlung
and 9
7 χ0 for pair production. For reference, the column density at sea level corre-
sponds to about 1000 g/cm2. In a simple approximation (Heitler model), the num-
ber of particles (including gamma rays) in the air-shower doubles every interaction
length, whereas the average energy per particle is halved. Thus, a 100 GeV gamma-
ray photon could produce ten generations of particles whereas a 100 TeV gamma-ray
photon would produce twenty generations.

There are multiple methods for detecting air showers at the ground. The two most
important ones for gamma-ray astronomy are the imaging air Cherenkov technique
and particle detector arrays.

4π µ(ω)ω

(cid:16)
1 − c2

dx dω = q2

Imaging air Cherenkov telescopes utilize the fact that charged particles in air
showers can emit Cherenkov light in the atmosphere if their speed v exceeds the
local speed of light. The amount of energy emitted at frequency ω per unit length
is given by d2E
, where q is the particle’s charge and
n (ω) and µ (ω) are the (frequency-dependent) index of refraction and permeability
of air. The refractivity n (ω) is approximately proportional to the density of the
atmosphere, but also depends on the humidity. The Cherenkov spectrum in air peaks
at blue or UV frequencies.

Cherenkov light is emitted at an angle of θC = cos−1 (cid:16) 1

. The Cherenkov
emission in air is strongly beamed forwards, with a maximum angle of 2° near sea

v2n2(ω)

n(ω)

(cid:17)

(cid:17)

6

Eric A. Charles and Henrike Fleischhack and Clio Sleator

level. Cherenkov telescopes are set up to focus the Cherenkov light onto a very
sensitive camera, typically consisting of hundreds or thousands of photo-multiplier
tubes (PMTs) or silicon photo-multipliers (SiPMs). The shape and brightness of
these images are used to reconstruct the direction and energy of the primary particle
that initiated the shower.

Particle detector arrays detect the charged components of air showers directly.
They typically consist of water tanks or scintillator plates, instrumented with PMTs
which detect Cherenkov emission from charged particles crossing through the de-
tector. The timing and the strength of the signal are used to reconstruct the direction
and energy of the primary particle.

3.3.2 Particle interactions in the detector volume

Gamma rays predominantly interact with matter in three different ways, with the
dominant mechanism depending on the photon’s energy and the material. Above
tens of MeV, pair production generally dominates: the photon disappears and an
electron-positron pair is produced in the electric ﬁeld of an atomic nucleus or elec-
tron. If the electron or positron have sufﬁcient energy, they can emit further gamma
rays which can in turn produce more electron-positron pairs. These cascades de-
velop similar to the air showers described above, but on smaller length scales in
solid media compared to the atmosphere.

Between tens of keV and tens of MeV, the dominant process is Compton scat-
tering, in which the gamma ray transfers some of its energy to an electron and
is deﬂected by an angle φ . Assuming the energy loss of the photon is much
larger than the ionization energy, the energy of the scattered photon is given by
1+(Eγ /mec2)(1−cos φ ) , where Eγ is the initial photon energy and me is the elec-
Eγ (cid:48) =
tron mass.

Eγ

For energies below tens of keV, the photoelectric effect is the dominant interac-
tion mechanism, in which the photon’s energy is completely absorbed by an electron
in an atomic shell, releasing the electron. Any energy in excess of the binding energy
is converted to kinetic energy of the electron.

Charged particles such as electrons, muons, and protons mainly interact via
ionization. Electrons (and positrons) with energies above some tens of MeV emit
Bremsstrahlung in the presence of nuclear electric ﬁelds, emitting gamma-ray pho-
tons and, if they are sufﬁciently energetic, initiating an electromagnetic cascade
as described above. Protons, neutrons, and nuclei of sufﬁcient energy may interact
with other nuclei via the strong interaction, producing pions and other mesons in
a hadronic cascade, which proceeds similarly to the electromagnetic showers de-
scribed above.

Gamma-ray detector and mission design simulations

7

3.4 Detector readout

Simulating the detector readout adds realism to the simulated events. The resolu-
tions of the measured quantities, such as energy, position, and timing, affect the
event reconstruction and the overall instrument performance. The position resolu-
tion is generally the size of the instrument segmentation; e.g. the size of a single
detector, strip, or pixel. The energy and timing resolutions are dependent on both
the detector properties, such as material and size, as well as the readout electron-
ics. The energy and timing measurements are also discretized when the signals are
digitized (e.g. with an analog to digital converter).

Additional detector readout effects, including but not limited to dead time,
thresholds, and trigger conditions, also affect the overall instrument performance.
Dead time can affect overall count rates and, depending on the trigger system, lead
to incompletely detected events. For example, consider the case in which the multi-
ple detectors that make up an instrument trigger independently of each other. If an
event occurs while the readout of a single detector is processing the previous event,
it is possible that the event scatters in the dead detector and thus not all of its de-
posited energy is detected. Similarly, sub-threshold interactions, in which a particle
deposits energy below the threshold of the readout element, can lead to undetected
or incompletely detected events. Other common electronics effects, such as cross
talk, can distort the measured parameters.

Incompletely detected events and distortions of the measured parameters due to
realistic resolutions and electronics effects will affect the event reconstruction, and
consequently, the ﬁnal instrument performance. Additionally, an accurate simulated
count rate is essential for estimating the ﬂux of astrophysical sources. The detector
readout is thus a key component of simulations. These effects are generally mea-
sured and modeled during the instrument calibration, and then incorporated into the
simulation pipeline.

3.5 Event reconstruction

Gamma-ray telescopes typically record many signals for each incident particle. This
number can range from a few, in the case of relatively low energy Compton inter-
actions, to thousands, it the case of very high energy events. The task of the “event
reconstruction” is to extract information about the incoming particle from all of
those signals. Figs. 1, 2, 3 and 4 show examples of the single event information that
is available for different types of gamma-ray telescopes (Compton, pair, IACT, and
particle detector array, respectively). As far as simulations are concerned, the key
point is to have enough ﬁdelity and granularity to develop and optimize the event
reconstruction algorithms.

In the later three cases, the result of the event reconstruction includes estimates
of the direction and energy of the incoming particle, as well as “quality” estimators

8

Eric A. Charles and Henrike Fleischhack and Clio Sleator

Fig. 1: A simulated gamma-ray photon interacting in the proposed AMEGO-X[23]
detector via Compton interaction. The gamma ray crossed the top half of the tracker
(in cyan) without interaction before Compton scattering. The scattered electron
(blue track) was detected in four tracker layers before being absorbed. The scat-
tered photon continued to travel through the tracker without interaction (green line)
and deposited the remainder of its energy in the calorimeter (red) via a photoelectric
effect interaction. Image produced with the MEGAlib simulation framework and
previously published in [23]. © H. Fleischhack, reproduced with permission.

that indicate if the event is more or less likely to be a gamma ray or cosmic-ray
background.

In the case of Compton event reconstruction, it is typically not possible to fully
identify the direction of the incoming particle; rather the event reconstruction iden-
tiﬁes a cone around the incoming direction. The opening angle of the cone is given
by the Compton scatter angle, and can be very large. Further analysis of Comp-
ton events is often done in the “Compton” data space [54], which is deﬁned by the
astrophysical coordinates of the vector joining the ﬁrst Compton scatter and the sec-
ond interaction, and the Compton scatter angle as estimated from the kinematics of
the event. Additionally, Compton event reconstruction does typically estimate the
energy and the event “quality”.

3.6 High-level data analysis

High-level data analysis typically takes as input reduced data, such as lists of pho-
tons or photon candidates with associated information from the event reconstruction
such as arrival direction, arrival time, energy, and potentially other parameters mea-
suring reconstruction quality or “gamma-ness”. The input can also be binned data
such as sky-maps, typically binned in Right Ascension (RA or α) and Declination

Gamma-ray detector and mission design simulations

9

Fig. 2: A simulated Fermi-LAT Event. The simulated gamma ray had 27 GeV of
energy. The small crosses represent the clusters in the silicon tracker, while the
variable-size squares indicate the reconstructed location and magnitude of the en-
ergy deposition for every hit crystal in the calorimeter. The dotted line represents the
true gamma-ray direction. The ”backsplash” from the calorimeter shower generates
tens of hits in the tracker, and a few hits in the anti-coincidence detector (colored
boxes), which, however, are away from the direction extrapolation and therefore
do not compromise our ability to correctly classify the event as a gamma ray. This
ﬁgure appeared as Fig. 12(a) of Ref.[3]; reproduced by permission of the AAS.

(DEC or δ ) or in Galactic latitude (b) and longitude (l) according to the photon’s
arrival direction, plus further bins according to energy, arrival time, etc. Instrument
response ﬁles (effective areas, angular resolution, etc.), which are generated from
simulations, are needed as well. The output of the high-level analysis generally con-
sists of results such as the location(s), detection signiﬁcance(s), morphology, and
energy spectrum/spectra of detected source(s).

In general, most of the ﬁeld uses either maximum likelihood estimation or
Bayesian sampling of the posterior distribution. The likelihood is derived from com-
paring the detected number of photon counts per bin to a model of the source(s)
convolved with the instrument response. Model parameters such as source location
and the ﬂux normalization of each source are varied to minimize the likelihood.

Many tools for high-level analyses of this kind exist, typically speciﬁc to an in-
strument or data format [e.g., 21, 53, 36]. Several efforts exist that allow simulta-
neous likelihood ﬁts to data from multiple instruments, either by unifying the data
format [18] or by allowing encapsulating data and instrument response access into
plugins, allowing the joint analysis of data in disparate formats [50]. Many of these
packages include tools for high-level simulation, e.g. to generate synthetic measured
spectra or skymaps given a “true” spectrum and instrument response.

yz(a) ray directionγIncoming 10

Eric A. Charles and Henrike Fleischhack and Clio Sleator

Fig. 3: Simulated image of a gamma-ray air shower in the CTA camera. The sim-
ulated gamma-ray source (black star) was located in the center of the camera. The
reconstructed photon direction is marked with the purple star. Left: Single-telescope
view. Colors correspond to the measured charge in each camera pixel (PMT/SiPM).
Medium and large dots indicate that the pixel in question has passed “image clean-
ing” (removal of pixels containing just noise) and is being used for the reconstruc-
tion. Right: Multiple images of the same shower seen by different telescopes in the
array, all pointing in the same direction. Colors correspond to the telescope ID, dot
sizes to the measured charge. Images previously published in [36]. © G. Maier and
J. Holder, reproduced with permission.

3.7 Performance metrics

Standard metrics of instrument performance are useful in comparing instruments
to each other and completing trade studies when designing a new instrument. The
main performance metrics are the instrument energy resolution, angular resolution,
effective area, and sensitivity. In addition, the minimum detectable polarization is a
useful metric for instruments with polarimetry capabilities. These metrics are gen-
erally dependent on the photon energy and the source’s location in the instrument’s
ﬁeld of view, and (for ground-based instruments) the elevation angle under which a
source is observed. The performance is affected by any imperfections in the event
calibration and event reconstruction pipelines.

The energy resolution describes how well an instrument can measure the energy
of an incident photon, and can be determined by measuring the width of the Gaus-
sian lines that occur when a (real or simulated) monoenergetic source is incident
upon the instrument. The full instrument energy resolution differs from that of the
individual elements, such as a single detector pixel or strip, if most gamma rays in-
teract multiple times within the instrument. For ground-based instruments, the pho-
ton energy is reconstructed from either the Cherenkov light or the small part of the

Gamma-ray detector and mission design simulations

11

Fig. 4: A simulated gamma-ray shower seen by the HAWC detector. Each large cir-
cle corresponds to one water tank, with the smaller circles depicting the four PMTs
in each tank. PMTs detecting light are marked by colored circles. The color cor-
responds to the hit time (used to reconstruct the shower direction) and the size
of each circle corresponds to the amount of light seen (used to reconstruct the
gamma-ray energy). Image from https://www.hawc-observatory.org/
observatory/ghsep.php, reproduced with permission.

air shower that reaches the detector. Since the energies and detector sizes involved
make beam tests impractical, both the energy reconstruction and the resolution mea-
surements are entirely based on simulations. It is thus important to not just model
the detector, but also the atmospheric proﬁle and the shower development well to
understand the energy resolution and other performance metrics.

The angular resolution describes the instrument’s ability to spatially resolve
sources on the sky. The angular resolution is determined by the point spread func-
tion (PSF), and is often deﬁned as the angle in which 68% of events are contained.
For pair telescopes and ground-based instruments, the PSF is the probability dis-
tribution function of the offsets between the true ˆν and reconstructed ˆν (cid:48) directions
of each gamma ray. In the case of a Compton telescope, which localizes each pho-
ton to an event circle on the sky, the PSF is a distribution of the angular resolution
measure (ARM): the ARM of each event is deﬁned as the smallest angular distance
from the event circle to the true source position. The shape of the PSF varies based
on the incident gamma ray energy and the source location in the instrument’s ﬁeld
of view. The angular resolution can be determined either from simulations or from
measurements (e.g. beam test, radioactive lab sources, observations of known point-
like sources).

The effective area is the area of a perfectly efﬁcient ideal detector that detects
the same number of counts as the real instrument, and is computed by multiplying
the instrument efﬁciency by the cross-sectional geometric collecting area (for direct
detection instruments) or the instrument area folded with the footprint of a gamma-
ray air shower (for ground-based instruments). Thus, the effective area is a measure

12

Eric A. Charles and Henrike Fleischhack and Clio Sleator

of instrument size and efﬁciency, which varies depending on the incident energy and
source location in the instrument reference frame.

Since linearly polarized gamma rays exhibit sinusoidal modulation in the az-
imuthal Compton scatter angle, Compton telescopes can detect polarization by mea-
suring this modulation (see e.g. [32] for an in-depth discussion of gamma ray po-
larimetry). The minimum detectable polarization (MDP) is the degree of linear po-
larization above which a statistically signiﬁcant detection can be made, and is com-
monly used as a metric of the polarimetric performance. The MDP is a function of
the source and background count rates, the observation time, and the modulation
factor of a 100% polarized beam (the modulation factor is the amplitude divided by
the offset of the measured sinusoidal modulation) [51]. The modulation factor used
in the MDP is often determined from simulations, since producing a fully polarized
beam in the lab is non-trivial. The source and background rates are dependent on
the source properties and the instrument effective area.

3.8 Sensitivity estimates

An extremely useful ﬁgure of merit is the “ﬂux sensitivity”, i.e., the minimum ﬂux
that is likely to result in a statistically signiﬁcant source detection given a ﬁxed
observing program. In short, this requires detecting a source above a background.

The ﬂux sensitivity can always be estimated with an exhaustive simulation of a
“grid” of sources with varying ﬂuxes and spectral indices generated on top of simu-
lated backgrounds, which are then passed through the standard event reconstruction
and high-level analysis chain to determine which ﬂuxes and indices are detectable.
The approach is also used with “fake source injection” techniques, wherein sources
with known properties are injected into copies of the real data; this latter approach
better captures both the sky backgrounds and instrumental artifacts.

However, it is often possible to get a quite accurate estimate of the ﬂux sensi-
tivity with far less work. Several methods exist to do this, and they are typically
enhancements of “aperture photometry”, i.e., counting the photons that lie within
an aperture deﬁned by the PSF containment radius, and using that to estimate the
ﬂux needed to establish a signiﬁcant excess above the expected background level.
Typically, the enhancements involve weighting the backgrounds to discount events
that are further away from the source position, or have energies that are less likely to
be from the source. In practice this involves 1.) estimating “effective background”
at the source location by convolving the ﬂux model of the background with the
IRFs, 2.) determining the number of counts from the source (nsrc,detect) that would
be needed to establish a detection at a given statistical signiﬁcance threshold, 3.)
converting nsrc,detect back to the minimum detectable ﬂux given the instrument re-
sponse functions (IRFs, see §6.1) and the observing program in question.

An example of such a method is described in Appendix A of Ref. [40], where it

is also used to provide an estimate of the source localization power.

Gamma-ray detector and mission design simulations

13

4 Simulation tools for different types of instruments

4.1 Simulating energy deposition in the instrument

4.1.1 Air shower simulations

There are several software packages that simulate extensive air showers, the most
commonly used one being the CORSIKA framework [27]. Air shower physics are
complex and the simulations require inputs from quantum electrondynamics (QED),
quantum chromodynamics (QCD), nuclear physics, classical electrodynamics, and
optics. Additionally, good models of the atmospheric properties (gas content, pres-
sure, optical properties) are needed. Simulation steps include the simulation of hard
(high-energy) interactions between the primary particle (or energetic secondary par-
ticles) and the atmosphere, production (and decay, if applicable) of secondary par-
ticles, the energy loss of charged particles via ionization and other mechanisms,
deﬂection of charged particles in the Earth’s magnetic ﬁeld, and (if required) the
emission of Cherenkov light, ﬂuorescence light, or radio waves.

Pure QED and QCD calculations are prohibitive due to convergence issues. In-
stead, various (interfaces to) external models have been implemented to treat high-
energy hadronic [e.g., 43, 45, 52], low-energy hadronic [e.g., 22, 12, 11], and elec-
tromagnetic interactions [e.g., 30]. These codes are typically tuned to match mea-
surements at particle colliders and from air shower experiments. The users can pick
which interaction model to use. The differences between predictions from differ-
ent interaction models are a measure for the systematic uncertainty of these codes.
The uncertainties can be pretty signiﬁcant, especially for hadronic interactions and
high energies. For ground-based gamma ray observatories, it is often preferable to
measure the hadronic background instead of relying completely on simulations.

For particle detector arrays such as HAWC and Tibet-ASgamma, the optical
properties of the atmosphere are unimportant as the data analysis only relies on
a prediction of how many charged particles will deposit energy in the detectors. The
shower development does depend on the density proﬁle, but to ﬁrst order it is enough
to know the total mass overburden, which can be derived from a simple measure-
ment of the air pressure at the detector site. Conversely, IACTs rely on the amount
of Cherenkov light reaching the detector, which requires detailed knowledge of the
density proﬁle and composition of the atmosphere. Both the intensity and the an-
gle of the emitted Cherenkov light depend on the index of refraction at the position
where the light is emitted, and the light loss due to scattering and absorption de-
pends on the composition of the atmosphere (including its aerosol content) down
to the telescope site. See [13] for details. CORSIKA includes several atmospheric
models appropriate for various latitudes. The users can also supply their own.

In many cases, it is appropriate to approximate the Earth’s surface as a plane,
rather than taking its curvature into account. This speeds up air shower simulations
signiﬁcantly. However, for the simulation of very inclined showers it is necessary to
model the atmosphere as a spherical shell.

14

Eric A. Charles and Henrike Fleischhack and Clio Sleator

Another way to reduce computing time and memory usage is to follow only a
representative set of shower particles, where each representative is a stand-in for
many real particles. This method is called “thinning”. Thinning may introduce ar-
tiﬁcial ﬂuctuations or graininess into the simulated shower proﬁle. The equivalent
for Cherenkov photons is also referred to as “bunching”. The bunch size is typically
chosen such that each bunch produces on average one photo-electron in the cam-
era, after losses due to atmospheric absorption, inefﬁcient mirrors etc. are taken into
account.

4.1.2 Ray tracing

Dedicated ray-tracing simulations are performed to follow the path of Cherenkov
photons through the optical structure of Cherenkov telescopes. Optical elements of
Cherenkov telescopes typically comprise segmented spherical or parabolic mirrors,
as well as bafﬂes or Winston cones around the camera pixels to limit background
light. Ray-tracing simulations should take into account the (wavelength-dependent)
reﬂectivity of the mirrors and Winston cones (if installed), the optical point spread
function and alignment of each mirror facet, and losses due to gaps between mirrors
or shadowing by the camera or support structure. Ray-tracing can be performed by
dedicated software such as ROBAST [42] used e.g. by Cherenkov Telescope Array
(CTA), or as part of telescope-speciﬁc simulations packages such as sim telarray
[14] and matelsim [34]. Ray tracing can either be performed for each simulated
gamma ray event separately, or ray-tracing simulations can be used to derive effec-
tive optical point spread functions and efﬁciencies which can then be folded into the
simulated gamma ray images on the camera.

4.1.3 Simulating particles in matter with Geant4

The Geant4 [5, 10, 9] simulation toolkit is the standard tool used in high-energy
particle physics to simulate the passage of particles through matter, as well as the
energy that the particles leave in active detectors. In summary, Geant4 propagates
particles through a detailed spatial model of a detector, keeping track of particle
interactions and decays, and propagating any resulting particles until they exit the
detector volume, decay or are otherwise destroyed in an interaction, or come to rest
because of interaction induced energy losses. Geant4 then produces a list of the
resulting particles and their interactions with the detector model (i.e., the identity
of the interactive particle, the position of the interaction, and the amount of energy
deposited). At that point it is up to the users to model the detector response to the
deposited energy, i.e., to simulate the resulting digitized signals that would result
from the deposited energy.

Geant4 is used extensively as a front-end by the MEGALib package (see §4.2),
by SoftWare for Optimization of Radiation Detectors (SWORD) [19], and by Glas-
tRelease, the software framework used to simulate and reconstruct the interactions

Gamma-ray detector and mission design simulations

15

of individual gamma rays with the Fermi-LAT (again, see §4.2). In practice, Geant4
is the standard software package for simulating the interactions of high-energy
particles with meter-scale instruments (as opposed simulations of much larger air-
showers, which are done with the other tools described in this section).

4.2 Simulating detector electronics

The tools used to simulate detector electronics vary widely across experiments.
Often the detector electronics effects are incorporated into the simulations with
instrument-speciﬁc tools. In the case of Fermi-LAT, for example, the same packages
that calibrate the events are used to simulate the detector readout; these packages
are part of the Fermi software tools1. Detector electronics can also be incorporated
into simulations via more general software tools: in particular, MEGAlib [53] and
sim telarray [14].

GlastRelease, the suite of software packages use to simulate, reconstruct and
analyze Fermi-LAT data, includes dedicated packages to simulate the detector elec-
tronics response of each of the instrument sub-systems. These packages can use the
instrument calibrations as input, in effect inverting the calibrations so as to map
energy deposition to a digital signal level, and applying thresholding to determine
which hits would actually be read out by the instrument.

MEGAlib is a software package designed for the simulation and analysis of
Compton telescopes. MEGAlib includes energy resolution, depth resolution, trigger
thresholds, and other detector electronics effects in the simulations. These param-
eters are speciﬁed in the mass model and can thus be easily incorporated in any
post-simulation analysis. However, MEGAlib in its current form does not allow the
user to vary electronics effects across a single detector. In other words, a standalone
tool is needed to vary resolutions and trigger thresholds across the pixels or strips
of a single detector, if such a variation is required. Since MEGAlib is open source,
it is straightforward for such a standalone tool to interface with the MEGAlib simu-
lations and mass model.

sim telarray is an extension to CORSIKA that simulates the detector electronics
for IACTs. In addition to electronics effects, sim telarray can also simulate other
instrumental and atmospheric effects.

4.3 Event reconstruction

The reconstruction of simulated events typically uses the same software and pro-
cessing chain as measured data. In some cases, simulations require certain pre-
processing steps. For example, the addition of detector electronics noise may be

1 https://github.com/fermi-lat

16

Eric A. Charles and Henrike Fleischhack and Clio Sleator

performed at the reconstruction stage, enabling the same simulation ﬁle to be used
under different noise conditions.

5 Trade studies and instrument design

5.1 Figures of merit and sensitivity metrics

When designing an instrument, simulations are used to determine the projected per-
formance. Figures of merit such as energy resolution, angular resolution, and effec-
tive area are useful in assessing the scientiﬁc potential of an instrument design. For
example, improved angular resolution leads to improved source localization accu-
racy, and improved energy resolution can lead to gains in gamma ray line science
capabilities.

The projected instrument sensitivity describes the minimum signal that an instru-
ment can detect above the background, and is commonly compared to the sensitivi-
ties of already existing instruments. These sensitivity comparisons can be complex,
since one must assume an observation time, a background rate, the energy spectrum
of the source, and the effective area of the instrument. The background rate and ef-
fective area are often determined from simulations, but the effective area can change
based on the source position in the instrument’s ﬁeld of view. Typical observation
times are 1 Ms, 1 year, or the lifetime of the mission. Variations in the assumed
observation times of the sensitivity curves from different instruments can make sen-
sitivity comparisons non-trivial. However, it is not necessarily the best practice to
assume the same observation time across instruments, since observing strategies and
instrument ﬁelds of view differ. In other words, a pointed instrument with a narrow
ﬁeld of view will observe a source for less time than a wide ﬁeld instrument, and an
instrument cannot observe for longer than its lifetime.

An example sensitivity comparison performed by the e-ASTROGAM collabora-
tion is shown in Figure 5 [17]. The e-ASTROGAM team assumed an observation
time of 1 year to compute the 3σ sensitivity.

5.2 Examples of trade studies

Trade studies are a crucial part of the instrument design process. The instrument
design is optimized by varying several parameters and comparing the predicted per-
formance as well as costs and potential risk factors of the different implementations.
Simulations play an important role here as they are typically many orders of magni-
tude cheaper and faster than building detector prototypes.

In addition to science performance, trade studies also need to take into account
various external factors such as differences in cost and timelines for development,

Gamma-ray detector and mission design simulations

17

Fig. 5: A comparison of the continuum sensitivities of numerous gamma ray instru-
ments, adapted from Figure 1.0.1 in Ref. [17].

procurement, and production. For ground-based instruments, accessibility of the site
and other geographical constraints must be considered, whereas for space-based
and balloon-borne instruments, limits on size, weight, and power are an important
consideration.

Many trade studies are only conducted internally and not published in full. Some
examples of trade studies are the comparison of the CTA site candidates [26] and
array layouts [15].

6 Using simulations for science

6.1 IRFs: instrument response characterization

Instrument response functions (IRFs) are parametrized representations of the in-
strument performance, and are needed to determine source properties from obser-
vations. For example, to perform spectral analysis of an astrophysical source, IRFs
are used to extrapolate the emitted spectrum and ﬂux of the source from the mea-
sured spectrum and count rate. IRFs are generally calculated from Monte Carlo
simulations of gamma rays interacting with the instrument and often can be sepa-
rated into three parts: the energy dispersion, the effective area, and the point spread
function. Each of these three IRFs is usually dependent on the incident energy of
the gamma ray, the incident direction of the gamma ray in the instrument reference
frame, and the event selections used. The IRFs are typically parametrized in “local”
or “instrument” coordinates. For a space-based instrument such as Fermi-LAT, lo-
cal coordinates refer to the polar and azimuthal angle with respect to the instrument
boresight. For ground-based instruments, local coordinates refer to the altitude (i.e.
the amount of atmosphere above the instrument) and the azimuth.

10-1510-1410-1310-1210-1110-1010-910-210-11101021031041051061071081091010e-ASTROGAM(1-yr effective exposure)SPIIBIS-ISGRIIBIS-PICsITJEM-XCOMPTELEGRETCTA SouthFermi-LATLHAASOHiSCOREMAGICHESS/VERITASHAWCEnergy (MeV)Sensitivity (erg cm-2 s-1)18

Eric A. Charles and Henrike Fleischhack and Clio Sleator

The energy dispersion function, sometimes known as the energy redistribution
function, describes the probability of measuring an event at energy E(cid:48) for a gamma
ray with incident energy E. The instrument energy resolution is baked into the en-
ergy dispersion function as a spreading in measured energy E(cid:48) around true energy
E. The energy dispersion function also incorporates other instrumental effects that
skew the measured energy, such as low energy tailing due to incompletely absorbed
events. Fig. 6 shows the energy resolution as a function of energy for Compton tele-
scope aboard the Compton Gamma-Ray Observatory (CRGO-COMPTEL) (MeV
energy range), Fermi-LAT (GeV energy range), and CTA (TeV energy range). The
energy resolution is often conveniently used to summarize the information contained
in the energy dispersion function, and is usually shown as a function of energy (as
in Fig. 6) or as a function of instrument boresight angle.

The effective area, introduced in §3.7, is the area of an ideal instrument that
detects the same number of photons as the real instrument. The effective area is
required for measuring the ﬂux of astrophysical sources. Fig. 7 shows the on-axis
effective area as a function of energy for CGRO-COMPTEL, Fermi-LAT, and CTA.
The effective area is also often plotted as a function of instrument boresight or az-
imuth at a single energy.

The point spread function (PSF) describes the instrument’s imaging response. For
pair telescopes and ground-based detectors (IACTs, water Cherenkov), the PSF is
the probability density to reconstruct an incident direction ˆν (cid:48) for a gamma ray with
incident direction ˆν. The PSF is usually taken to be radially symmetric with a central
peak and more or less signiﬁcant tails, and modeled for example as a Gaussian
distribution or a King function [31] (re-parametrized Student-t function [49]).

In the case of a Compton telescope, the PSF is more complex, since each photon
is reconstructed to an event circle on the sky rather than a point. The PSF is deﬁned
in the Compton data space, a data space consisting of the initial Compton scatter
angle φ and the direction of the scattered gamma ray in celestial coordinates (ψ, ξ ).
In this data space, a point source creates a cone with an opening angle of 90◦ and
an apex at the point source position in celestial coordinates (ψ0, ξ0); this cone is the
PSF of a Compton telescope [54]. The thickness of the Compton data space cone de-
scribes the angular resolution, and the ARM described in §3.7 is a one-dimensional
projection of this cone. The Compton imaging response describes the probability
that an event emitted in a certain image space bin (with a particular energy) is de-
tected in the Compton data space bin, and thus has at minimum 5 dimensions: the
three data space dimensions representing the initial Compton scatter angle and the
direction of the scattered gamma ray; and the two dimensional coordinates of the
image space bin [54]. Two additional dimensions representing the emitted energy
and the measured energy would ideally also be incorporated.

The angular resolution as a function of energy is shown in Fig. 8 for CGRO-
COMPTEL, Fermi-LAT, and CTA. Similarly to the energy resolution, the angular
resolution can be used to summarize the information contained in the PSF, and is
often deﬁned as the angle in which 68% of events are contained in the PSF. The
angular resolution is often shown as a function of energy, instrument boresight, or
azimuth.

Gamma-ray detector and mission design simulations

19

(a)

(b)

(c)

Fig. 6: The energy resolution as a function of energy for (a) CGRO-COMPTEL
[46], (b) Fermi-LAT [20], and (c) CTA [41]. The energy resolution is expressed as
the width of the interval around the true energy which contains 68% of the distribu-
tion. If the spectral lines are ﬁt with a Gaussian distribution, the 68% containment
is equivalent to one Gaussian sigma, as in (a). In (b), “front” and “back” refer to the
location of the pair conversion in the tracker. In (c), the energy resolution of CTA
is compared to that of Fermi-LAT and VERITAS. Fig. (a) appeared as Fig. 30 of
Ref.[46]; reproduced by permission of the AAS. Fig. (b) reproduced by permission
of the Fermi-LAT collaboration. Fig. (c) made use of the CTA instrument response
functions provided by the CTA Consortium and Observatory, see https://www.cta-
observatory.org/science/cta-performance/ (version prod5 v0.1; [41]) for more de-
tails.

20

Eric A. Charles and Henrike Fleischhack and Clio Sleator

(a)

(b)

(c)

Fig. 7: The effective area of (a) CGRO-COMPTEL [48], (b) Fermi-LAT [20], and
(c) CTA [41] as a function of energy. (a) The effective area on-axis (0◦) and at 50◦
off-axis is shown, each with no event selections and the COMPTEL standard event
selections. (b) The on-axis effective area, in which “front” and “back” refer to the
conversion location of the pair event in the tracker. (c) The effective area for a vari-
ety of observation times, without an event cut in the reconstructed event direction.
Fig. (a) appeared as Fig. 2 in [48], reproduced with permission ©ESO. Fig. (b) re-
produced by permission of the Fermi-LAT collaboration. Fig. (c) made use of the
CTA instrument response functions provided by the CTA Consortium and Observa-
tory, see https://www.cta-observatory.org/science/cta-performance/ (version prod5
v0.1; [41]) for more details.

Gamma-ray detector and mission design simulations

21

(a)

(b)

(c)

Fig. 8: The angular resolution as a function of energy for (a) CGRO-COMPTEL
[46], (b) Fermi-LAT [20], and (c) CTA [41]. (a) The one sigma width of the CGRO-
COMPTEL ARM distribution. (b) The 68% and 95% containment angles of the
Fermi-LAT PSF, in which “front” and “back” refer to the conversion location of
the pair event in the tracker. (c) The 68% containment angle of the CTA PSF,
compared to a few other gamma ray instruments. Fig. (a) appeared as Fig. 28 in
Ref.[46]; reproduced by permission of the AAS. Fig. (b) reproduced by permission
of the Fermi-LAT collaboration. Fig. (c) made use of the CTA instrument response
functions provided by the CTA Consortium and Observatory, see https://www.cta-
observatory.org/science/cta-performance/ (version prod5 v0.1; [41]) for more de-
tails.

22

Eric A. Charles and Henrike Fleischhack and Clio Sleator

6.2 IRFs for variable observing conditions

In addition to the energy and direction of the incoming photon, the instrument re-
sponse of gamma ray detectors can depend signiﬁcantly on various observing con-
ditions as well as the state of the detector (e.g., aging of detector components, noisy
or disabled sub-detectors).

IACTs are particularly sensitive to atmospheric conditions (seasonal variations
in the density proﬁles, the presence of aerosols or clouds) and night sky background
(e.g. stars or planets in the ﬁeld of view and scattered moonlight, both of which can
be either attenuated or further scattered towards the telescope by clouds). Mirror
alignment and reﬂectivity as well as the gain of the photomultipliers degrades over
time, but can be improved by periodically cleaning, re-coating, and re-aligning the
mirrors and Winston cones and adjusting the PMT voltage. PMTs or even entire
telescopes can be temporarily disabled due to stars in the ﬁeld of view or hardware
issues. Additionally, the three existing large IACT facilities H.E.S.S., MAGIC, and
VERITAS have all undergone signiﬁcant changes and hardware upgrades over the
years [24, 44, 39, 7, 8]. Observations might also be performed under different trig-
ger/voltage settings or with additional ﬁlters in front of the cameras.

There are two strategies of coping with these different observing conditions
and hardware conﬁgurations. The ﬁrst one involves simulating a large, multi-
dimensional grid of atmospheric, observing, and instrument conditions, to cover
all combinations occurring in data (by potentially interpolating between neighbor-
ing grid points). In this case, simulations can be performed independently of data
taking, and data are ready to be analyzed as soon as they have been recorded. The
downside is that the number of grid points and hence the needed resources (com-
puting time, disk space) grow quickly as the number of dimensions increases, while
only a small fraction of the simulated combinations may actually occur in reality.
Another strategy employed e.g. by the H.E.S.S. collaboration is to produce dedi-
cated simulations for each night’s observing runs, following the actual position of
the observed sources in the sky and simulating all other conditions as close to reality
as possible [28]. The downside of this approach is that these dedicated simulations
(potentially including cut optimization etc) have to be run after data-taking has con-
cluded, before the data can be analyzed.

Particle detectors like HAWC are much less sensitive to changes in atmosphere
and do not rely on the optical properties at all, thus not necessitating many different
sets of instrument responses.

Balloon-borne gamma ray detectors, especially on long and ultra-long duration
balloon ﬂights, can be subject to atmospheric changes as they ﬂoat around the Earth.
In particular, changes in altitude affect the geomagnetic cutoff rigidity and thus the
background count rate. Similarly to the IACT approach, one can include an altitude
dimension in the IRFs – in other words, compute a separate IRF for each altitude
bin – , as was done for the analysis of the COSI 2016 balloon ﬂight data (e.g. [47]).
Satellite-based experiments like Fermi-LAT are less prone to degradation (not
being exposed to the atmosphere) and once launched, the hardware is typically not
upgraded. However, the rate of background hits caused by cosmic-ray events varies

Gamma-ray detector and mission design simulations

23

over the orbit (e.g. depending on proximity to the South Atlantic Anomaly region),
which may necessitate separate response functions binned in noise rates.

6.3 Fast simulations to characterize signal signiﬁcance

In general, the following are needed to be able characterize the statistical signiﬁ-
cance of a signal:

1. instrument response functions for gamma rays,
2. ﬂux model for sky,
3. simulation of non-gamma ray backgrounds.

In principle the signal signiﬁcance can then be calculated either with forward-
modeling likelihood ﬁts or with Bayesian sampling. When characterizing signal
signiﬁcance, however, it is common to make a number of simplifying assumptions:

• Fixing the instrument response, i.e., not ﬁtting for parameters in the instrument

response;

• Fixing all source ﬂuxes except a test source and a large-scale diffuse background;
• Fixing the spectrum of the test-source, e.g., to be a ﬁxed-index power-law.

With these simplifying assumptions, it is possible to model a region of interest
with a single free parameter for the source (i.e., the normalization), and one param-
eter for the background. (i.e., the normalization of the large scale background).

This makes it tractable to analytically compute good approximations to the likeli-
hood function, and often to ﬁnd analytic forms for the derivatives of the likelihood.
In some cases it is even possible to ﬁnd an analytic expression or semi-analytic
expression for the set of parameters that maximize the likelihood, and estimate cur-
vature of the likelihood (and hence the parameter uncertainties) near the maximum.
For an example of such a computation, see the “semi-analytic sensitivity esti-

mate” provided in Ref. [40].

In spirit, these methods are extensions of photon counting methods, i.e., estimat-
ing the number of background events that lie in the signal region, and then estimat-
ing the signal signiﬁcance based on any excess of events in the signal region with
respect to that background estimate.

6.4 Simulating events using IRFs

If the IRFs are tabulated, it is often much faster to simulate events using the tab-
ulated IRFs than a full simulation of the instrument. If, for example, the IRFs can
be factored in separate pieces representing the effective collecting area (Aeff), the
point-spread function (P( ˆν (cid:48)| ˆν)) (i.e., the probability to assign a direction ˆν (cid:48) given
the ˆν) and the energy dispersion D(E(cid:48)|E) (i.e., the probability to reconstruct the

24

Eric A. Charles and Henrike Fleischhack and Clio Sleator

event energy as E(cid:48) given the true energy E), then simulating events can be factored
into generating events with true energy and directions E, ˆν given the source charac-
teristics and the Aeff, and then use the PSF and the energy dispersion to smear E, ˆν
into E(cid:48), ˆν (cid:48).

Unfortunately, the extra dimensionality of the Compton data space used to ana-
lyze Compton scattering events makes it impractically difﬁcult to generate and use
IRF tables in the same way for Compton data analysis.

6.5 Simulating maps using IRFs and exposure tables

If the “observing proﬁle” (the amount of time a given part of the sky was observed
at a particular angle in the instrument reference frame) or the “observing history”
(the amount of time a source was observed under particular observing conditions) is
known, and corresponding IRFs for all of the observing conditions are also known,
then, at the cost of the loss of some information, fast simulations can be produced by
ﬁrst creating “mean” IRFs; in other words, IRFs that are averaged over the observing
proﬁle or observing history. These IRFs can then be applied to binned maps of the
sky.

This technique is used extensively in the Fermi-LAT data analysis and particular
in the Fermipy software suite2. One of the standard data products generated by the
mission provided Fermitools3 is the “livetime cube”, which is actually a table that
gives the amount of time each direction (α, δ ) in the sky was observed at a partic-
ular angle (θ ) with respect to the LAT boresight: tlive(θ |α, δ ). Other standard tools
generate the mean IRFs and convolve them with ﬂux models of the sources being
analyzed to generate templates that can be used to compute the maps of the number
of photons observed for a given source ﬂux. Particular points to note here are that
by using a single, averaged, set of IRFs for the entire observation, the smearing can
be simpliﬁed to simply convolving the maps with the PSF; and similarly, the energy
dispersion can be reduced to applying at energy redistribution matrix to the energy
counts per bin. This avoids having to go back to the individual events, and greatly
speeds that data analysis.

It is also very important to understand that maps generated using these fast-
simulation techniques are extremely useful, as they provide an expected number of
photons per pixel and per energy, i.e. nexpect(E, α, δ |ﬂux, model), and a great many
simulated observations can be generated simply by throwing Poisson-distributed
counts with respect to nexpect, which can be critical for computing expectation bands
or doing Bayesian parameter estimation.

2 https://fermipy.readthedocs.io/en/latest/
3 https://fermi.gsfc.nasa.gov/ssc/data/analysis/

Gamma-ray detector and mission design simulations

25

7 Simulation veriﬁcation and limitations

Simulations can never perfectly replicate real data. Air shower physics are com-
plex and the models used for simulations all make various simplifying assump-
tions. Models of the atmosphere can at best approximate the actual atmospheric
proﬁle, and detector models can never hope to reproduce all the small defects, mis-
alignments, inefﬁciencies etc. of a real detector. Yet, even with these limitations,
simulations are still a very useful tool, as long as we acknowledge and study their
limitations.

Predictions from simulations are typically compared to measurements to val-
idate the simulations. The validation procedure can include calibration measure-
ments in the lab, at testbeams, or in ﬂight/in situ, as well as comparisons of certain
distributions such as gamma-hadron separation parameters and the measured di-
rection of reconstructed photons from known point-like gamma-ray sources. Mea-
sured ﬂuxes and energy spectra can be compared to results from other instruments
(cross-calibration). Often, dedicated simulations of for example a test beam setup
are needed. The detector model and detector effects engine used in simulations typ-
ically undergo multiple revisions and and are tweaked until they match the mea-
surements. Parameters of the detector model that can not be fully constrained by
calibrations and other measurements should be considered as part of the systematic
uncertainty of the instrument. This can be done for example by preparing alternative
sets of instrument response ﬁles based on simulations with certain parameters in the
detector model changed with respect to the nominal. The Crab nebula, one of the
strongest known sustained gamma-ray emitters, is often used to validate the ﬁnal
instrument model, see for example [8, 35, 1, 2, 37, 4, 6, 29]. Other strong sources
such as gamma-ray pulsars and active galactic nuclei can be used as well [3].

Background simulations can be validated against measurements on source-free
regions on the sky (or source-free time intervals). However, backgrounds from cos-
mic rays and detector noise are notoriously hard to predict well in simulations. It
is thus preferred to use measured background distributions whenever possible (after
launch/inauguration).

8 Summary

Many different types of simulations are crucial pieces of the tool kit for high-energy
astronomy. They are used to develop the case for new instruments, to design those
instruments, to develop the data reduction and event analysis pipelines for those in-
struments, to construct the IRFs used to analyze the data from those instruments,
and to generate the simulated datasets needed to perform high-level analysis. Be-
cause of the ubiquity of the need for simulations coupled with the variety of the
particular details relevant for any given type of instrument, as well as the variety of
the different contexts in which simulations are used, a great many simulation tools
exist within high-energy astronomy. In this chapter, we have described the com-

26

Eric A. Charles and Henrike Fleischhack and Clio Sleator

mon aspects of simulations, given a short survey of the available simulation tools,
and discussed how simulations are used for instrument design and data analysis in
high-energy astronomy.

9 Cross-References

Orbits and background of gamma-ray space instruments
Compton telescopes
Pair-creation telescopes
The COMPTEL instrument on the CGRO mission
The AGILE mission
The Fermi Gamma-ray Space Telescope mission
The Large Area Telescope on the Fermi mission
HAWC: The High Altitude Water Cherenkov detector
The Major Gamma-ray Imaging Cherenkov Telescopes (MAGIC)
The Very Energetic Radiation Imaging Telescope Array System (VERITAS)
The High Energy Stereoscopic System (H.E.S.S.)
The Cherenkov Telescope array (CTA): a worldwide endeavor for the next level of
ground-based gamma-ray astronomy

10 Acknowledgments

C. S. acknowledges support by the NRL Isabella and Jerome Karle Distinguished
Scholar Fellowship Program. H. F. acknowledges support by NASA under award
number 80GSFC21M0002.

Citations

[1] Abeysekara AU, Albert A, Alfaro R, Alvarez C, ´Alvarez JD, Arceo R, Arteaga-
Vel´azquez JC, Solares HAA, Barber AS, Bautista-Elivar N, et al (2017) Ob-
servation of the crab nebula with the hawc gamma-ray observatory. The As-
trophysical Journal 843(1):39, DOI 10.3847/1538-4357/aa7555, URL http:
//dx.doi.org/10.3847/1538-4357/aa7555

[2] Abeysekara AU, Albert A, Alfaro R, Alvarez C, ´Alvarez JD, Camacho JRA,
Arceo R, Arteaga-Vel´azquez JC, Arunbabu KP, Rojas DA, Solares HAA,
Baghmanyan V, Belmont-Moreno E, BenZvi SY, Brisbois C, Caballero-Mora
KS, Capistr´an T, Carrami˜nana A, Casanova S, Cotti U, Cotzomi J, de Le´on SC,
la Fuente ED, de Le´on C, Dichiara S, Dingus BL, DuVernois MA, D´ıaz-V´elez

Gamma-ray detector and mission design simulations

27

JC, Ellsworth RW, Engel K, Espinoza C, Fick B, Fleischhack H, Fraija N,
Galv´an-G´amez A, Garc´ıa-Gonz´alez JA, Garﬁas F, Gonz´alez MM, Goodman
JA, Harding JP, Hernandez S, Hinton J, Hona B, Hueyotl-Zahuantitla F, Hui
CM, H¨untemeyer P, Iriarte A, Jardin-Blicq A, Joshi V, Kaufmann S, Kieda
D, Lara A, Lee WH, Vargas HL, Linnemann JT, Longinotti AL, Luis-Raya
G, Lundeen J, Malone K, Marinelli SS, Martinez O, Martinez-Castellanos I,
Mart´ınez-Castro J, Mart´ınez-Huerta H, Matthews JA, Miranda-Romagnoli P,
Morales-Soto JA, Moreno E, Mostaf´a M, Nayerhoda A, Nellen L, Newbold
M, Nisa MU, Noriega-Papaqui R, Peisker A, P´erez-P´erez EG, Pretz J, Ren Z,
Rho CD, Rivi`ere C, Rosa-Gonz´alez D, Rosenberg M, Ruiz-Velasco E, Salazar
H, Greus FS, Sandoval A, Schneider M, Schoorlemmer H, Arroyo MS, Sinnis
G, Smith AJ, Springer RW, Surajbali P, Tabachnick E, Tanner M, Tibolla O,
Tollefson K, Torres I, Weisgarber T, Westerhoff S, Wood J, Yapici T, Zepeda
A, and HZ (2019) Measurement of the crab nebula spectrum past 100 TeV
with HAWC. The Astrophysical Journal 881(2):134, DOI 10.3847/1538-4357/
ab2f7d, URL https://doi.org/10.3847/1538-4357/ab2f7d
[3] Ackermann M, et al. (2012) The Fermi Large Area Telescope on Orbit: Event
Classiﬁcation, Instrument Response Functions, and Calibration. Astrophysical
Journal Supplmental Series 203:4, DOI 10.1088/0067-0049/203/1/4, 1206.
1896

[4] Adams CB, Benbow W, Brill A, Buckley JH, Christiansen JL, Falcone
A, Feng Q, Finley JP, Foote GM, Fortson L, et al (2021) The through-
put calibration of the veritas telescopes. Astronomy & Astrophysics DOI
10.1051/0004-6361/202142275, URL http://dx.doi.org/10.1051/
0004-6361/202142275

[5] Agostinelli S, Allison J, Amako K, Apostolakis J, Araujo H, Arce P, Asai
M, Axen D, Banerjee S, Barrand G, Behner F, Bellagamba L, Boudreau J,
Broglia L, Brunengo A, Burkhardt H, Chauvie S, Chuma J, Chytracek R,
Cooperman G, Cosmo G, Degtyarenko P, Dell’Acqua A, Depaola G, Diet-
rich D, Enami R, Feliciello A, Ferguson C, Fesefeldt H, Folger G, Foppi-
ano F, Forti A, Garelli S, Giani S, Giannitrapani R, Gibin D, G´omez Ca-
denas J, Gonz´alez I, Gracia Abril G, Greeniaus G, Greiner W, Grichine V,
Grossheim A, Guatelli S, Gumplinger P, Hamatsu R, Hashimoto K, Hasui H,
Heikkinen A, Howard A, Ivanchenko V, Johnson A, Jones F, Kallenbach J,
Kanaya N, Kawabata M, Kawabata Y, Kawaguti M, Kelner S, Kent P, Kimura
A, Kodama T, Kokoulin R, Kossov M, Kurashige H, Lamanna E, Lamp´en
T, Lara V, Lefebure V, Lei F, Liendl M, Lockman W, Longo F, Magni S,
Maire M, Medernach E, Minamimoto K, Mora de Freitas P, Morita Y, Mu-
rakami K, Nagamatu M, Nartallo R, Nieminen P, Nishimura T, Ohtsubo K,
Okamura M, O’Neale S, Oohata Y, Paech K, Perl J, Pfeiffer A, Pia M, Ran-
jard F, Rybin A, Sadilov S, Di Salvo E, Santin G, Sasaki T, Savvas N, Sawada
Y, Scherer S, Sei S, Sirotenko V, Smith D, Starkov N, Stoecker H, Sulkimo
J, Takahata M, Tanaka S, Tcherniaev E, Safai Tehrani E, Tropeano M, Tr-
uscott P, Uno H, Urban L, Urban P, Verderi M, Walkden A, Wander W, We-
ber H, Wellisch J, Wenaus T, Williams D, Wright D, Yamada T, Yoshida H,

28

Eric A. Charles and Henrike Fleischhack and Clio Sleator

Zschiesche D (2003) Geant4—a simulation toolkit. Nuclear Instruments and
Methods in Physics Research Section A: Accelerators, Spectrometers, Detec-
tors and Associated Equipment 506(3):250–303, DOI https://doi.org/10.1016/
S0168-9002(03)01368-8, URL https://www.sciencedirect.com/
science/article/pii/S0168900203013688

[6] Aharonian F, et al.

the Crab Nebula with
H.E.S.S. Astron Astrophys 457:899–915, DOI 10.1051/0004-6361:20065351,
astro-ph/0607333

(2006) Observations of

[7] Aleksi´c J, Ansoldi S, Antonelli L, Antoranz P, Babic A, Bangale P, Barcel´o
M, Barrio J, Becerra Gonz´alez J, Bednarek W, et al (2016) The major up-
grade of the magic telescopes, part i: The hardware improvements and the
commissioning of the system. Astroparticle Physics 72:61–75, DOI 10.1016/
j.astropartphys.2015.04.004, URL http://dx.doi.org/10.1016/j.
astropartphys.2015.04.004

[8] Aleksi´c J, Ansoldi S, Antonelli L, Antoranz P, Babic A, Bangale P, Bar-
cel´o M, Barrio J, Becerra Gonz´alez J, Bednarek W, et al (2016) The major
upgrade of the magic telescopes, part ii: A performance study using obser-
vations of the crab nebula. Astroparticle Physics 72:76–94, DOI 10.1016/
j.astropartphys.2015.02.005, URL http://dx.doi.org/10.1016/j.
astropartphys.2015.02.005

[9] Allison J, Amako K, Apostolakis J, Araujo H, Arce Dubois P, Asai M, Barrand
G, Capra R, Chauvie S, Chytracek R, Cirrone G, Cooperman G, Cosmo G,
Cuttone G, Daquino G, Donszelmann M, Dressel M, Folger G, Foppiano F,
Generowicz J, Grichine V, Guatelli S, Gumplinger P, Heikkinen A, Hrivnacova
I, Howard A, Incerti S, Ivanchenko V, Johnson T, Jones F, Koi T, Kokoulin R,
Kossov M, Kurashige H, Lara V, Larsson S, Lei F, Link O, Longo F, Maire
M, Mantero A, Mascialino B, McLaren I, Mendez Lorenzo P, Minamimoto K,
Murakami K, Nieminen P, Pandola L, Parlati S, Peralta L, Perl J, Pfeiffer A,
Pia M, Ribon A, Rodrigues P, Russo G, Sadilov S, Santin G, Sasaki T, Smith
D, Starkov N, Tanaka S, Tcherniaev E, Tome B, Trindade A, Truscott P, Urban
L, Verderi M, Walkden A, Wellisch J, Williams D, Wright D, Yoshida H (2006)
Geant4 developments and applications. IEEE Transactions on Nuclear Science
53(1):270–278, DOI 10.1109/TNS.2006.869826

[10] Allison J, Amako K, Apostolakis J, Arce P, Asai M, Aso T, Bagli E, Bag-
ulya A, Banerjee S, Barrand G, Beck B, Bogdanov A, Brandt D, Brown J,
Burkhardt H, Canal P, Cano-Ott D, Chauvie S, Cho K, Cirrone G, Coop-
erman G, Cort´es-Giraldo M, Cosmo G, Cuttone G, Depaola G, Desorgher
L, Dong X, Dotti A, Elvira V, Folger G, Francis Z, Galoyan A, Garnier
L, Gayer M, Genser K, Grichine V, Guatelli S, Gu`eye P, Gumplinger P,
Howard A, Hˇrivn´aˇcov´a I, Hwang S, Incerti S, Ivanchenko A, Ivanchenko
V, Jones F, Jun S, Kaitaniemi P, Karakatsanis N, Karamitros M, Kelsey M,
Kimura A, Koi T, Kurashige H, Lechner A, Lee S, Longo F, Maire M,
Mancusi D, Mantero A, Mendoza E, Morgan B, Murakami K, Nikitina T,
Pandola L, Paprocki P, Perl J, Petrovi´c I, Pia M, Pokorski W, Quesada J,
Raine M, Reis M, Ribon A, Risti´c Fira A, Romano F, Russo G, Santin G,

Gamma-ray detector and mission design simulations

29

Sasaki T, Sawkey D, Shin J, Strakovsky I, Taborda A, Tanaka S, Tom´e B,
Toshito T, Tran H, Truscott P, Urban L, Uzhinsky V, Verbeke J, Verderi M,
Wendt B, Wenzel H, Wright D, Wright D, Yamashita T, Yarba J, Yoshida
H (2016) Recent developments in geant4. Nuclear Instruments and Meth-
ods in Physics Research Section A: Accelerators, Spectrometers, Detectors
and Associated Equipment 835:186–225, DOI https://doi.org/10.1016/j.nima.
2016.06.125, URL https://www.sciencedirect.com/science/
article/pii/S0168900216306957

[11] Bass S (1998) Microscopic models for ultrarelativistic heavy ion col-
lisions. Progress in Particle and Nuclear Physics 41:255–369, DOI 10.
1016/s0146-6410(98)00058-1, URL http://dx.doi.org/10.1016/
S0146-6410(98)00058-1

[12] Battistoni G, Boehlen T, Cerutti F, Chin PW, Esposito LS, Fass`o A, Ferrari A,
Lechner A, Empl A, Mairani A, Mereghetti A, Ortega PG, Ranft J, Roesler
S, Sala PR, Vlachoudis V, Smirnov G (2015) Overview of the ﬂuka code.
Annals of Nuclear Energy 82:10–18, DOI https://doi.org/10.1016/j.anucene.
2014.11.007, URL https://www.sciencedirect.com/science/
article/pii/S0306454914005878, joint International Conference on
Supercomputing in Nuclear Applications and Monte Carlo 2013, SNA + MC
2013. Pluri- and Trans-disciplinarity, Towards New Modeling and Numerical
Simulation Paradigms
[13] Bernl¨ohr K (2000)

atmospheric parameters on the

Impact of

cherenkov

mospheric
268,
https://www.sciencedirect.com/science/article/pii/
S0927650599000936

https://doi.org/10.1016/S0927-6505(99)00093-6,

technique. Astroparticle

Physics

DOI

at-
12(4):255–
URL

[14] Bernl¨ohr K (2008) Simulation of imaging atmospheric cherenkov tele-
scopes with corsika and sim telarray. Astroparticle Physics 30(3):149–158,
DOI 10.1016/j.astropartphys.2008.07.009, URL http://dx.doi.org/
10.1016/j.astropartphys.2008.07.009

[15] Cumani P, Hassan T, Arrabito L, Bernl¨ohr K, Bregeon J, Maier G, Moralejo A,
Consortium C (2017) Baseline telescope layouts of the Cherenkov Telescope
Array. In: 35th International Cosmic Ray Conference (ICRC2017), Interna-
tional Cosmic Ray Conference, vol 301, p 811, 1709.00206

[16] Cumani P, Hernanz M, Kiener J, Tatischeff V, Zoglauer A (2019) Background
for a gamma-ray satellite on a low-Earth orbit. Exper Astron 47(3):273–302,
DOI 10.1007/s10686-019-09624-0, 1902.06944

[17] De Angelis A, Tatischeff V, Grenier I, McEnery J, Mallamaci M, Tavani M,
Oberlack U, Hanlon L, Walter R, Argan A, Von Ballmoos P, Bulgarelli A,
Bykov A, Hernanz M, Kanbach G, Kuvvetli I, Pearce M, Zdziarski A, Conrad
J, Ghisellini G, Harding A, Isern J, Leising M, Longo F, Madejski G, Mar-
tinez M, Mazziotta M, Paredes J, Pohl M, Rando R, Razzano M, Aboudan
A, Ackermann M, Addazi A, Ajello M, Albertus C, ´Alvarez J, Ambrosi G,
Ant´on S, Antonelli L, Babic A, Baibussinov B, Balbo M, Baldini L, Balman
S, Bambi C, Barres de Almeida U, Barrio J, Bartels R, Bastieri D, Bednarek

30

Eric A. Charles and Henrike Fleischhack and Clio Sleator

W, Bernard D, Bernardini E, Bernasconi T, Bertucci B, Biland A, Bissaldi E,
Boettcher M, Bonvicini V, Bosch-Ramon V, Bottacini E, Bozhilov V, Bretz T,
Branchesi M, Brdar V, Bringmann T, Brogna A, Budtz Jørgensen C, Busetto
G, Buson S, Busso M, Caccianiga A, Camera S, Campana R, Caraveo P,
Cardillo M, Carlson P, Celestin S, Cerme˜no M, Chen A, Cheung C, Chura-
zov E, Ciprini S, Coc A, Colafrancesco S, Coleiro A, Collmar W, Coppi P,
Curado da Silva R, Cutini S, D’Ammando F, De Lotto B, de Martino D, De
Rosa A, Del Santo M, Delgado L, Diehl R, Dietrich S, Dolgov A, Dom´ınguez
A, Dominis Prester D, Donnarumma I, Dorner D, Doro M, Dutra M, El-
saesser D, Fabrizio M, Fern´andez-Barral A, Fioretti V, Foffano L, Formato
V, Fornengo N, Foschini L, Franceschini A, Franckowiak A, Funk S, Fuschino
F, Gaggero D, Galanti G, Gargano F, Gasparrini D, Gehrz R, Giammaria P,
Giglietto N, Giommi P, Giordano F, Giroletti M, Ghirlanda G, Godinovic N,
Gouiff´es C, Grove J, Hamadache C, Hartmann D, Hayashida M, Hryczuk A,
Jean P, Johnson T, Jos´e J, Kaufmann S, Kheliﬁ B, Kiener J, Kn¨odlseder J,
Kole M, Kopp J, Kozhuharov V, Labanti C, Lalkovski S, Laurent P, Limousin
O, Linares M, Lindfors E, Lindner M, Liu J, Lombardi S, Loparco F, L´opez-
Coto R, L´opez Moya M, Lott B, Lubrano P, Malyshev D, Mankuzhiyil N,
Mannheim K, March˜a M, Marcian`o A, Marcote B, Mariotti M, Marisaldi M,
McBreen S, Mereghetti S, Merle A, Mignani R, Minervini G, Moiseev A,
Morselli A, Moura F, Nakazawa K, Nava L, Nieto D, Orienti M, Orio M, Or-
lando E, Orleanski P, Paiano S, Paoletti R, Papitto A, Pasquato M, Patricelli B,
P´erez-Garc´ıa M, Persic M, Piano G, Pichel A, Pimenta M, Pittori C, Porter T,
Poutanen J, Prandini E, Prantzos N, Produit N, Profumo S, Queiroz F, Rain´o S,
Raklev A, Regis M, Reichardt I, Rephaeli Y, Rico J, Rodejohann W, Rodriguez
Fernandez G, Roncadelli M, Roso L, Rovero A, Rufﬁni R, Sala G, S´anchez-
Conde M, Santangelo A, Saz Parkinson P, Sbarrato T, Shearer A, Shellard R,
Short K, Siegert T, Siqueira C, Spinelli P, Stamerra A, Starrﬁeld S, Strong A,
Str¨umke I, Tavecchio F, Taverna R, Terzi´c T, Thompson D, Tibolla O, Tor-
res D, Turolla R, Ulyanov A, Ursi A, Vacchi A, Van den Abeele J, Vankova-
Kirilovai G, Venter C, Verrecchia F, Vincent P, Wang X, Weniger C, Wu X,
Zaharijaˇs G, Zampieri L, Zane S, Zimmer S, Zoglauer A (2018) Science with
e-astrogam: A space mission for mev–gev gamma-ray astrophysics. Journal
of High Energy Astrophysics 19:1–106, DOI https://doi.org/10.1016/j.jheap.
2018.07.001, URL https://www.sciencedirect.com/science/
article/pii/S2214404818300168

[18] Deil C, Zanin R, Lefaucheur J, Boisson C, Kheliﬁ B, Terrier R, Wood M,
Mohrmann L, Chakraborty N, Watson J, Lopez-Coto R, Klepser S, Cerruti M,
Lenain JP, Acero F, Djannati-Ata¨ı A, Pita S, Bosnjak Z, Trichard C, Vuillaume
T, Donath A, Consortium C, King J, Jouvin L, Owen E, Sipocz B, Lennarz
D, Voruganti A, Spir-Jacob M, Ruiz JE, Arribas MP (2017) Gammapy - A
prototype for the CTA science tools. In: 35th International Cosmic Ray Con-
ference (ICRC2017), International Cosmic Ray Conference, vol 301, p 766,
1709.01751

Gamma-ray detector and mission design simulations

31

[19] Duvall W, Phlips B, Hutcheson A, Cordes R, Hartsell J, Strickman M (2019)
Improving radiation transport simulation capabilities for nuclear threat detec-
tion using sword. In: 2019 IEEE International Symposium on Technologies for
Homeland Security (HST), pp 1–6, DOI 10.1109/HST47167.2019.9032903

[20] Fermi LAT Collaboration (Accessed: 2021-11-30) Fermi LAT Per-
formance. URL https://www.slac.stanford.edu/exp/glast/
groups/canda/lat_Performance.htm

[21] Fermi Science Support Development Team (2019) Fermitools: Fermi Science

Tools. 1905.011

[22] Fesefeldt HS (1985) The simulation of hadronic showers: physics and appli-
cations. Tech. rep., Aachen TU 3. Inst. Phys., Aachen, URL http://cds.
cern.ch/record/162911

[23] Fleischhack H (2021) AMEGO-X: MeV gamma-ray Astronomy in the
Multi-messenger Era. PoS ICRC2021:649, DOI 10.22323/1.395.0649, 2108.
02860

[24] Giavitto G, et al. (2017) The upgrade of the H.E.S.S. cameras. Nucl Instrum

Meth A 876:35–38, DOI 10.1016/j.nima.2016.12.057

[25] Grieder P (2010) Extensive Air Showers. Springer, DOI https://doi.org/10.

1007/978-3-540-76941-5 4

[26] Hassan T, Arrabito L, Bernl¨ohr K, Bregeon J, Cortina J, Cumani P, Di
Pierro F, Falceta-Goncalves D, Lang R, Hinton J, Jogler T, Maier G,
Moralejo A, Morselli A, Todero Peixoto C, Wood M (2017) Monte carlo
performance studies for the site selection of the cherenkov telescope array.
Astroparticle Physics 93:76–85, DOI https://doi.org/10.1016/j.astropartphys.
2017.05.001, URL https://www.sciencedirect.com/science/
article/pii/S0927650517300087

[27] Heck D, Knapp J, Capdevielle JN, Schatz G, Thouw T (1998) CORSIKA: a
Monte Carlo code to simulate extensive air showers. Forschungszentrum Karl-
sruhe Report FZKA 6019

[28] Holler M, Lenain JP, de Naurois M, Rauth R, Sanchez DA (2020) A Run-Wise
Simulation and Analysis Framework for Imaging Atmospheric Cherenkov
Telescope Arrays. Astropart Phys 123:102491, DOI 10.1016/j.astropartphys.
2020.102491, 2007.01697

[29] Holler M, et al. (2016) Observations of the Crab Nebula with H.E.S.S. Phase

II. PoS ICRC2015:847, DOI 10.22323/1.236.0847, 1509.02902

[30] Kawrakow I, Rogers D, Mainegra-Hing E, Tessier F, Townson R, Walters B
(2000) Egsnrc toolkit for monte carlo simulation of ionizing radiation trans-
port. doi:10.4224/40001303 [release v2021]

[31] King I (1962) The structure of star clusters. I. an empirical density law. Astro-

nomical Journal 67:471, DOI 10.1086/108756

[32] Lei F, Dean A, Hills G (1997) Compton polarimetry in gamma-ray astron-
omy. Space Science Reviews 82:309–388, DOI https://doi.org/10.1023/A:
1005027107614

[33] Ling JC (1975) A semiempirical model for atmospheric gamma rays from
0.3 to 10 mev at λ = 40◦. Journal of Geophysical Research (1896-1977)

32

Eric A. Charles and Henrike Fleischhack and Clio Sleator

80(22):3241–3252, DOI https://doi.org/10.1029/JA080i022p03241, URL
https://agupubs.onlinelibrary.wiley.com/doi/abs/10.
1029/JA080i022p03241, https://agupubs.onlinelibrary.
wiley.com/doi/pdf/10.1029/JA080i022p03241

[34] Lopez M (2013) Simulations of the MAGIC Telescopes with Matelsim. In:
International Cosmic Ray Conference, International Cosmic Ray Conference,
vol 33, p 3132

[35] MAGIC Collaboration, Acciari, V A, Ansoldi, S, Antonelli, L A, Arbet En-
gels, A, Baack, D, Babi´c, A, Banerjee, B, Barres de Almeida, U, Barrio, J
A, Becerra Gonz´alez, J, Bednarek, W, Bellizzi, L, Bernardini, E, Berti, A,
Besenrieder, J, Bhattacharyya, W, Bigongiari, C, Biland, A, Blanch, O, Bon-
noli, G, Bosnjak, Z, Busetto, G, Carosi, R, Ceribella, G, Chai, Y, Chilin-
garyan, A, Cikota, S, Colak, S M, Colin, U, Colombo, E, Contreras, J L,
Cortina, J, Covino, S, D´Elia, V, Da Vela, P, Dazzi, F, De Angelis, A, De
Lotto, B, Delﬁno, M, Delgado, J, Depaoli, D, Di Pierro, F, Di Venere, L,
Do Souto Espi˜neira, E, Dominis Prester, D, Donini, A, Dorner, D, Doro, M,
Elsaesser, D, Fallah Ramazani, V, Fattorini, A, Ferrara, G, Fidalgo, D, Fof-
fano, L, Fonseca, M V, Font, L, Fruck, C, Fukami, S, Garc´ıa L´opez, R J,
Garczarczyk, M, Gasparyan, S, Gaug, M, Giglietto, N, Giordano, F, Godi-
novi´c, N, Green, D, Guberman, D, Hadasch, D, Hahn, A, Herrera, J, Hoang,
J, Hrupec, D, H¨utten, M, Inada, T, Inoue, S, Ishio, K, Iwamura, Y, Jou-
vin, L, Kerszberg, D, Kubo, H, Kushida, J, Lamastra, A, Lelas, D, Leone,
F, Lindfors, E, Lombardi, S, Longo, F, L´opez, M, L´opez-Coto, R, L´opez-
Oramas, A, Loporchio, S, Machado de Oliveira Fraga, B, Maggio, C, Majum-
dar, P, Makariev, M, Mallamaci, M, Maneva, G, Manganaro, M, Mannheim,
K, Maraschi, L, Mariotti, M, Mart´ınez, M, Mazin, D, Mi´canovi´c, S, Miceli,
D, Minev, M, Miranda, J M, Mirzoyan, R, Molina, E, Moralejo, A, Mor-
cuende, D, Moreno, V, Moretti, E, Munar-Adrover, P, Neustroev, V, Nigro,
C, Nilsson, K, Ninci, D, Nishijima, K, Noda, K, Nogu´es, L, Nozaki, S, Pa-
iano, S, Palacio, J, Palatiello, M, Paneque, D, Paoletti, R, Paredes, J M,
Pe˜nil, P, Peresano, M, Persic, M, Prada Moroni, P G, Prandini, E, Puljak, I,
Rhode, W, Rib´o, M, Rico, J, Righi, C, Rugliancich, A, Saha, L, Sahakyan,
N, Saito, T, Sakurai, S, Satalecka, K, Schmidt, K, Schweizer, T, Sitarek,
J, Snidari´c, I, Sobczynska, D, Somero, A, Stamerra, A, Strom, D, Strzys,
M, Suda, Y, Suri´c, T, Takahashi, M, Tavecchio, F, Temnikov, P, Terzi´c,
T, Teshima, M, Torres-Alb`a, N, Tosti, L, Vagelli, V, van Scherpenberg, J,
Vanzo, G, Vazquez Acosta, M, Vigorito, C F, Vitale, V, Vovk, I, Will, M,
Zari´c, D (2020) Magic very large zenith angle observations of the crab neb-
ula up to 100 tev. A&A 635:A158, DOI 10.1051/0004-6361/201936899, URL
https://doi.org/10.1051/0004-6361/201936899

[36] Maier G, Holder J (2018) Eventdisplay: An Analysis and Reconstruction Pack-
age for Ground-based Gamma-ray Astronomy. PoS ICRC2017:747, DOI
10.22323/1.301.0747, 1708.04048

[37] Meagher K (2016) Six years of VERITAS observations of the Crab Nebula.

PoS ICRC2015:792, DOI 10.22323/1.236.0792, 1508.06442

Gamma-ray detector and mission design simulations

33

[38] Mizuno T, Kamae T, Godfrey G, Handa T, Thompson DJ, Lauben D, Fukazawa
Y, Ozaki M (2004) Cosmic-ray background ﬂux model based on aGamma-ray
large area space TelescopeBalloon ﬂight engineering model. American As-
tronomical Society 614(2):1113–1123, DOI 10.1086/423801, URL https:
//doi.org/10.1086/423801

[39] Nepomuk Otte A (2009) Upgrade of the VERITAS Cherenkov Telescope Ar-

ray. arXiv e-prints arXiv:0907.4826, 0907.4826

[40] Nolan PL, Abdo AA, Ackermann M, Ajello M, Allafort A, Antolini E, At-
wood WB, Axelsson M, Baldini L, Ballet J, Barbiellini G, Bastieri D, Bechtol
K, Belﬁore A, Bellazzini R, Berenji B, Bignami GF, Blandford RD, Bloom
ED, Bonamente E, Bonnell J, Borgland AW, Bottacini E, Bouvier A, Brandt
TJ, Bregeon J, Brigida M, Bruel P, Buehler R, Burnett TH, Buson S, Caliandro
GA, Cameron RA, Campana R, Ca˜nadas B, Cannon A, Caraveo PA, Casand-
jian JM, Cavazzuti E, Ceccanti M, Cecchi C, C¸ elik ¨O, Charles E, Chekhtman
A, Cheung CC, Chiang J, Chipaux R, Ciprini S, Claus R, Cohen-Tanugi J,
Cominsky LR, Conrad J, Corbet R, Cutini S, D’Ammando F, Davis DS, de
Angelis A, DeCesar ME, DeKlotz M, De Luca A, den Hartog PR, de Palma
F, Dermer CD, Digel SW, Silva EdCe, Drell PS, Drlica-Wagner A, Dubois
R, Dumora D, Enoto T, Escande L, Fabiani D, Falletti L, Favuzzi C, Fegan
SJ, Ferrara EC, Focke WB, Fortin P, Frailis M, Fukazawa Y, Funk S, Fusco
P, Gargano F, Gasparrini D, Gehrels N, Germani S, Giebels B, Giglietto N,
Giommi P, Giordano F, Giroletti M, Glanzman T, Godfrey G, Grenier IA,
Grondin MH, Grove JE, Guillemot L, Guiriec S, Gustafsson M, Hadasch D,
Hanabata Y, Harding AK, Hayashida M, Hays E, Hill AB, Horan D, Hou X,
Hughes RE, Iafrate G, Itoh R, J´ohannesson G, Johnson RP, Johnson TE, John-
son AS, Johnson TJ, Kamae T, Katagiri H, Kataoka J, Katsuta J, Kawai N,
Kerr M, Kn¨odlseder J, Kocevski D, Kuss M, Lande J, Landriu D, Latronico
L, Lemoine-Goumard M, Lionetto AM, Llena Garde M, Longo F, Loparco
F, Lott B, Lovellette MN, Lubrano P, Madejski GM, Marelli M, Massaro E,
Mazziotta MN, McConville W, McEnery JE, Mehault J, Michelson PF, Minuti
M, Mitthumsiri W, Mizuno T, Moiseev AA, Mongelli M, Monte C, Monzani
ME, Morselli A, Moskalenko IV, Murgia S, Nakamori T, Naumann-Godo M,
Norris JP, Nuss E, Nymark T, Ohno M, Ohsugi T, Okumura A, Omodei N,
Orlando E, Ormes JF, Ozaki M, Paneque D, Panetta JH, Parent D, Perkins JS,
Pesce-Rollins M, Pierbattista M, Pinchera M, Piron F, Pivato G, Porter TA,
Racusin JL, Rain`o S, Rando R, Razzano M, Razzaque S, Reimer A, Reimer
O, Reposeur T, Ritz S, Rochester LS, Romani RW, Roth M, Rousseau R, Ryde
F, Sadrozinski HFW, Salvetti D, Sanchez DA, Saz Parkinson PM, Sbarra C,
Scargle JD, Schalk TL, Sgr`o C, Shaw MS, Shrader C, Siskind EJ, Smith DA,
Spandre G, Spinelli P, Stephens TE, Strickman MS, Suson DJ, Tajima H, Taka-
hashi H, Takahashi T, Tanaka T, Thayer JG, Thayer JB, Thompson DJ, Tibaldo
L, Tibolla O, Tinebra F, Tinivella M, Torres DF, Tosti G, Troja E, Uchiyama Y,
Vandenbroucke J, Van Etten A, Van Klaveren B, Vasileiou V, Vianello G, Vi-
tale V, Waite AP, Wallace E, Wang P, Werner M, Winer BL, Wood DL, Wood
KS, Wood M, Yang Z, Zimmer S (2012) Fermi Large Area Telescope Second

34

Eric A. Charles and Henrike Fleischhack and Clio Sleator

Source Catalog. ApJ Suppl Ser 199(2):31, DOI 10.1088/0067-0049/199/2/31,
1108.1435

[41] Observatory CTA, Consortium CTA (2021) CTAO Instrument Response Func-
tions - prod5 version v0.1. DOI 10.5281/zenodo.5499840, URL https:
//doi.org/10.5281/zenodo.5499840

[42] Okumura A, Noda K, Rulten C (2016) Robast: Development of a root-
based ray-tracing library for cosmic-ray telescopes and its applications in
the cherenkov telescope array. Astroparticle Physics 76:38–47, DOI 10.1016/
j.astropartphys.2015.12.003, URL http://dx.doi.org/10.1016/j.
astropartphys.2015.12.003

[43] Ostapchenko S (2006) Qgsjet-ii:

towards reliable description of very
high energy hadronic interactions. Nuclear Physics B - Proceedings
Supplements 151(1):143–146, DOI https://doi.org/10.1016/j.nuclphysbps.
2005.07.026, URL https://www.sciencedirect.com/science/
article/pii/S0920563205009175, vERY HIGH ENERGY COS-
MIC RAY INTERACTIONS

[44] Rajotte JF (2014) Upgrade and performance of the VERITAS telescope array.

Nucl Instrum Meth A 766:61–64, DOI 10.1016/j.nima.2014.04.075

[45] Riehn F, Dembinski HP, Engel R, Fedynitch A, Gaisser TK, Stanev T (2018)
The hadronic interaction model SIBYLL 2.3c and Feynman scaling. PoS
ICRC2017:301, DOI 10.22323/1.301.0301, 1709.07227

[46] Schoenfelder V, Aarts H, Bennett K, de Boer H, Clear J, Collmar W, Con-
nors A, Deerenberg A, Diehl R, von Dordrecht A, den Herder JW, Hermsen
W, Kippen M, Kuiper L, Lichti G, Lockwood J, Macri J, McConnell M, Mor-
ris D, Much R, Ryan J, Simpson G, Snelling M, Stacy G, Steinle H, Strong
A, Swanenburg BN, Taylor B, de Vries C, Winkler C (1993) Instrument De-
scription and Performance of the Imaging Gamma-Ray Telescope COMPTEL
aboard the Compton Gamma-Ray Observatory. ApJ Suppl Ser 86:657, DOI
10.1086/191794

[47] Siegert T, Boggs SE, Tomsick JA, Zoglauer AC, Kierans CA, Sleator CC,
Beechert J, Brandt TJ, Jean P, Lazar H, Lowell AW, Roberts JM, Ballmoos
Pv (2020) Imaging the 511 keV Positron Annihilation Sky with COSI. ApJ
897(1):45, DOI 10.3847/1538-4357/ab9607, 2005.10950

[48] Stacy JG, Kippen RM, Kappadath SC, McConnell M, Morris D, Miller R,
Connors A, Hersh B, Ryan J, Macri J, Simpson G, Schoenfelder V, Steinle
H, van Dijk R, Williams OR (1996) The response of the CGRO COMPTEL
determined from Monte Carlo simulation studies. A&A Suppl Ser 120:691–
694

[49] Student (1908) The probable error of a mean. Biometrika 6(1):1–25, URL

http://www.jstor.org/stable/2331554

[50] Vianello G, Lauer RJ, Younk P, Tibaldo L, Burgess JM, Ayala H, Harding P,
Hui M, Omodei N, Zhou H (2015) The Multi-Mission Maximum Likelihood
framework (3ML). In: Proceedings of the 34th ICRC, PoS, 1507.08343
[51] Weisskopf MC, Elsner RF, O’Dell SL (2010) On understanding the ﬁgures
of merit for detection and measurement of x-ray polarization. In: Arnaud M,

Gamma-ray detector and mission design simulations

35

Murray SS, Takahashi T (eds) Space Telescopes and Instrumentation 2010:
Ultraviolet to Gamma Ray, International Society for Optics and Photonics,
SPIE, vol 7732, pp 98 – 102, DOI 10.1117/12.857357, URL https://doi.
org/10.1117/12.857357

[52] Werner K, Pierog T (2007) Extended Air Shower Simulations Based on EPOS.
AIP Conf Proc 928(1):111–117, DOI 10.1063/1.2775903, 0707.3330
[53] Zoglauer A, Andritschke R, Schopper F (2006) Megalib – the medium
library. New Astronomy Reviews
https://doi.org/10.1016/j.newar.2006.06.049, URL

energy
50(7):629–632, DOI
https://www.sciencedirect.com/science/article/pii/
S1387647306000972, astronomy with Radioactivities. V

gamma-ray

astronomy

[54] Zoglauer A, Siegert T, Lowell A, Mochizuki B, Kierans C, Sleator C, Hart-
mann DH, Lazar H, Gulick H, Beechert J, Roberts JM, Tomsick JA, Leis-
ing MD, Pellegrini N, Boggs SE, Brandt TJ (2021) COSI: From Calibra-
tions and Observations to All-sky Images. arXiv e-prints arXiv:2102.13158,
2102.13158

[55] Zyla P, et al. (2020) Review of Particle Physics. PTEP 2020(8):083C01, DOI

10.1093/ptep/ptaa104

