This paper has been accepted for presentation at the 20th Mediterranean Communication and Computer Networking Conference. ©2022 IEEE.
Please cite it as: P. Testolina, M. Lecci, A. Traspadini, and M. Zorzi, “An Open Framework to Model Diffraction by Dynamic Blockers in Millimeter
Wave Simulations,” in IEEE 20th Mediterranean Communication and Computer Networking Conference (MedComNet), Paphos, Cyprus, Jun. 2022.

An Open Framework to Model Diffraction by
Dynamic Blockers in Millimeter Wave Simulations

Paolo Testolina, Mattia Lecci, Alessandro Traspadini, and Michele Zorzi
Department of Information Engineering, University of Padova, Italy
E-mail: {testolina,leccimat,traspadini,zorzi}@dei.unipd.it

2
2
0
2

n
u
J

0
1

]
I

N
.
s
c
[

1
v
0
0
0
5
0
.
6
0
2
2
:
v
i
X
r
a

Abstract—The millimeter wave (mmWave) band will be ex-
ploited to address the growing demand for high data rates
and low latency. The higher frequencies, however, are prone to
limitations on the propagation of the signal in the environment.
Thus, highly directional beamforming is needed to increase the
antenna gain. Another crucial problem of the mmWave fre-
quencies is their vulnerability to blockage by physical obstacles.
To this aim, we studied the problem of modeling the impact
of second-order effects on mmWave channels, speciﬁcally the
susceptibility of the mmWave signals to physical blockers. With
respect to existing works on this topic, our project focuses
on scenarios where mmWaves interact with multiple, dynamic
blockers. Our open source software includes diffraction-based
blockage models and interfaces directly with an open source
Radio Frequency (RF) ray-tracing software.

Index Terms—5G, millimeter wave networks, simulation,

channel model, diffraction, propagation.

I. INTRODUCTION

The millimeter wave (mmWave) frequencies feature large
chunks of untapped bandwidth that can increase the data
rate provided to the end users, and the small wavelength
enables the design of antenna arrays with tens of elements in
a small form factor to support beamformed transmissions.
While these promising characteristics make the mmWave
technology able to meet the requirements of 5th generation
(5G) cellular systems and Wi-Fi networks [1], [2], there are
several concerns regarding the propagation characteristics at
these frequencies that justify a more accurate study and the
need for new channel models. First, the high propagation
loss limits the coverage region of mmWave base stations,
although large antenna arrays and complex beamforming
techniques can mitigate the problem. Second, at mmWaves,
the increased diffraction loss results in deep shadow regions,
thus further degrading the communications performance [3],
[4]. Furthermore, mmWave signals can be easily blocked by
obstacles (e.g., vehicles, buildings, vegetation, human bod-
ies), which may prevent direct Line-of-Sight (LoS) communi-
cations. These (often unpredictable) propagation components
make it
the dynamics of
the surrounding environment, and to design communication
protocols, and especially beam-tracking algorithms, taking
into account these disruptive events.

imperative to accurately model

In this context, ray tracing has emerged as an essential
tool to model the mmWave channel [5], especially, but not
limited to, when detailed link-level protocols need to be sim-
ulated. With respect to stochastic channel models, ray tracers

This work was partially supported by the National Institute of Standards
and Technology (NIST) under award no. 60NANB20D082. The work of M.
Lecci and P. Testolina was supported by Fondazione CaRiPaRo under grants
“Dottorati di Ricerca” 2018 and 2019.

(RTs) exploit a digital reconstruction of the environment to
achieve a greater degree of accuracy, at the cost of additional
computational load [6]. Generally, the digital model includes
the static elements of the scenario, e.g., the ﬂoor, ceiling and
walls, and the tables, screens and other objects, depending
on its level of detail. Its design is not trivial, as it requires
the use of a Computer-Aided Design (CAD) software, a
complex and time-consuming task. Furthermore, dynamic
elements, e.g., moving humans and vehicles, are not generally
considered, as their movements can not be included in a
single CAD ﬁle. Thus, these elements are often overlooked
in RT simulations, despite the signiﬁcant role they play in the
propagation of the signal [7], [8]. Furthermore, the study of
the impact of blockers on the network performance has been
limited to ad hoc scenarios, often considering a single blocker
and only at the PHY layer. On the contrary, their effect
on large-scale, high-level network simulations has not yet
been fully characterized, due to the complexity of designing
the scenario and modeling the diffraction when considering
moving obstacles.

In this work, we present the Blockage Manager1, a novel
open-source software to model dynamic blockers in RT
simulations. The application was designed to post-process
information typically obtained from RT software, offering the
user a simple yet powerful interface to introduce blockage
models on top of them, making their simulations more real-
istic and dynamic. Starting from a pre-processed simulation
allows the user to later add as many obstacles as desired,
with custom mobility and settings, without the need to run
an entirely new ray-tracing simulation from scratch, which
can take a signiﬁcant amount of time. The software has been
designed to present as simple an API as possible, so that
the user only has to create a high-level description of the
desired obstacles, while still having some control on ﬁne-
tuning parameters if desired, and leaving all the complexity
to the simulator.

The aim of this work is to describe an open-source software
able to (i) interface directly with qd-realization [9], an open-
importing and exporting
source RF ray-tracing software,
channel traces with a single line of code, (ii) process pre-
computed RT simulations, adding multiple mobile obstacles
on top of them, (iii) support already implemented blockage
models, with varying degrees of complexity and accuracy.
Furthermore, we showcase some basic network scenarios
processed with our Blockage Manager, describing the ob-
tained results and discussing future works that will enable it
to closely mimic real channel behaviors in the presence of

1The Blockage Manager is available at https://github.com/signetlabdei/rt-

blockage-manager.

©2022 IEEE. Personal use of this material is permitted. Permission from IEEE must be obtained for all other uses, in any current or future media, including
reprinting/republishing this material for advertising or promotional purposes, creating new collective works, for resale or redistribution to servers or lists,
or reuse of any copyrighted component of this work in other works.

 
 
 
 
 
 
obstacles, allowing the community to better study and design
link-level protocols for mmWave communications.

In the remainder of the paper, we ﬁrst report the state
of the art on diffraction modeling (Sec. II). Then, Sec. III
offers a brief overview of the framework architecture, giving
the essential details to understand its main components. In
Sec. IV, we present the blockage models that are currently
implemented in the framework. Finally, the results in Sec. V
serve the double purpose of showcasing the usage of the
Blockage Manager and of highlighting the impact of dynamic
blockage in mmWave networks, and Sec. VI presents some
concluding remarks and future work directions.

II. STATE OF THE ART

Signals at mmWave frequencies are prone to limitations on
their propagation in the environment. Therefore, understand-
ing and precisely characterizing the interaction between radio
waves and the surroundings is fundamental to characterize
communications in different scenarios.

This reason has led to different modeling approaches for
the mmWave channel, which have various degrees of com-
plexity and accuracy, and can be applied to different contexts
and evaluations [6]. Thus, channel models can be summarized
in: analytical, stochastic, and Quasi Deterministic (QD).

Analytical channel models: These models generally
offer a simpliﬁed representation of the channel, based on
propagation loss and a random variable representing fading.
This kind of model has a limited accuracy and can be used to
characterize communications in a generic environment [10]–
[12], without accounting for the features of speciﬁc scenarios
and their interaction with the elements typical of mmWave
propagation (e.g., realistic antenna arrays and beamforming).
Stochastic channel models: They derive the entries of
the channel matrix from a set of random distributions, whose
parameters are determined by statistical ﬁts on channel mea-
surements for a generic scenario (e.g., a common rural or
urban environment). Their speed and their stochastic nature
allow to easily generate the radio channels for generic, large-
scale scenarios. Models of this type, e.g., the one proposed
in 3GPP TR 38.901 [13], have been used in the performance
evaluations of mmWave networks [14], [15].

Quasi-Deterministic channel models: QD channels, in-
stead, can accurately model the interactions of the mmWave
signal with a speciﬁc environment [16]–[18]. However, since
the Multi Path Components (MPCs) are generated by the
interaction between the transmitted signal and the elements
of a given environment, they can offer improved accuracy at
the cost of a higher processing load.

Including the effect of blockage on the channel model
is a non-trivial task. The high-level, generic nature of the
analytical models makes it difﬁcult to model the blockage by
multiple, possibly moving obstacles (e.g., people, vehicles,
foliage, etc.). Similarly, since stochastic channel models do
not require a model of the propagation environment, it is
difﬁcult to deﬁne a temporally and spatially consistent behav-
ior of the blockers. Furthermore, modeling speciﬁc mobility
patterns does not agree well with the stochastic nature of the
channel, and can decrease the advantages of these kinds of
models (i.e., their being lightweight and easy to use). Finally,
as mentioned in Sec. I, placing (possibly dynamic) blockers
in an RT simulation can also be challenging, thus motivating
this work. In the remainder of this section, we present the

existing models in the literature that deal with this problem.
Namely, we ﬁrst report the main works on blockage at the
channel modeling level, and then its modeling at the higher
layers of the network stack.

The authors of [19] analyzed the scattering of a vehicle
and showed that RT simulations of complex objects allow
the derivation of simpliﬁed scattering models. This is fun-
damental, since only by reducing the complexity of large
objects does it become possible to simulate realistic scenarios.
Their results show that, rather than introducing a complex
model with a high polygon count, it is possible to reduce the
complexity of simulations involving cars by only considering
a few key points producing scattering, e.g., wing mirrors.

Another simpliﬁcation was described also for human
blockage in [20], where the authors analyzed their mea-
surements taken at 10.5 GHz and concluded that a metal
cylinder affects the radio channel similarly to a human body.
This result justiﬁes the usage of such a simple model in
practical simulations rather than modeling a detailed person,
a signiﬁcantly harder task to perform with a correspondingly
much higher computational cost.

The 3GPP also proposes a map-based hybrid channel
model [13] using [21] for the deterministic component of
the channel, and adding a random component
to model
clusters of MPCs. It also proposes the usage of two blockage
models, to better represent a dynamic and realistic channel. In
the stochastic blockage model (Blockage model A), random
rectangular regions are blocked, considering the temporal and
spatial correlation for completeness. The geometric blockage
model (Blockage model B) deploys rectangular screens, spec-
ifying their relative dimensions and mobility patterns. In both
cases, a Knife-Edge Diffraction (KED) at four edges is de-
ﬁned, using the arctan approximation, described in Sec. IV,
for the diffraction loss.

A low-complexity enhancement of this approximation was
studied in [22] using a Fourier-based model for human ob-
stacles. Its authors compared their simulations with measure-
ments at 2.44 GHz in an indoor Non-Line-of-Sight (NLoS)
scenario and showed that their approximation produces shad-
owing loss closer to the Fresnel formulas for Double Knife-
Edge Diffraction (DKED) than the simpler arctan model.

Besides, the validity of the KED model was proved for
narrow obstacles also using complex speciﬁc solvers for
Maxwell’s equations as described in [23].

A series of modiﬁcations and criteria to improve the
accuracy of the 3GPP model are provided in [24]. It proposed,
in case of multiple blockers in close proximity, to consider
them as a single blocker with increased size. The authors also
suggest a way to increase the accuracy when the transmitted
beam does not cover the entire obstacle surface, for instance,
when highly directional antennas at a relative short distance
are employed. In such cases, the idea consists of taking
into consideration the transmitted beam pattern to choose
the position of the diffraction points on the surface of the
obstacles. A measurement campaign was carried out, and
its results showed that with these modiﬁcations the loss
prediction provided by the 3GPP model can be improved.

The literature also includes some studies analyzing block-
age experimentally [7], [8], [25]. The authors in [7] analyzed
accurate measurements of human body blockage at 60 GHz
with a person that traversed a linear trajectory perpendicular
to the direct path between the Transmitter (TX) and the

Receiver (RX). They derived a diffraction model and com-
pared it with their measurements. Eventually, they showed
that when a human obstacle is close to the path of the direct
ray, it also creates a strong reﬂected ray, thus acting as a 2-ray
propagation model.

A similar scenario was studied in [8] at 73 GHz. Its anal-
ysis showed that the use of directive antennas has a crucial
impact on human blockage measurement results, especially
when the blocker was close either to the TX or to the RX.

Furthermore, [26] explores the impact of human block-
age on the channel model
speciﬁcally proposed for
IEEE 802.11ad [27], based on measurements at 60 GHz. Its
authors analyzed ray tracing simulations in a human blockage
scenario considering also diffraction effects. They found that
the impact of human blockage is twofold. First of all, the
Signal-to-Noise Ratio (SNR) at the RX decreases due to the
additional attenuation, even if smart antennas are employed.
On the other hand,
the delay spread and the frequency
selectivity in general increase, because the channel conditions
change from LoS to NLoS. Both effects deteriorate the link,
causing a higher bit error probability during communications.
The modern literature not only provides examples of works
studying blockage at mmWaves from a physical measurement
and modeling perspective, but also recognizes it as an issue
that mmWave communication protocols need to address.
In fact, while high frequencies are in principle capable of
delivering the exceptional performance that they promise,
they are also heavily affected by bad channel conditions,
making the system much less stable thus worsening the
Quality of Experience (QoE).

An analysis of blockage was performed in [25] to evaluate
the effect of blockers on an End-to-End (E2E) application.
The authors used a phased array system that measured the
channel in multiple directions, in order to fully understand
the path diversity.

Different analyses on Transmission Control Protocol (TCP)
[28]–[31], studying the behavior of this protocol at mmWave
frequencies, employed obstacles to simulate NLoS scenarios.
Indeed, the extreme variability of the signal quality over
mmWave links yields either degraded TCP goodput and very
low utilization of the resources at mmWave frequencies, or, in
the presence of link-layer retransmissions, high goodput at the
price of high latency. Therefore, especially at mmWaves, the
effect of obstacles is crucial to understand the actual condition
of the channel.

As blockage is so impactful, especially on TCP-based
communications, some works have proposed and tested ways
of relying on multiple simultaneous connections, on both
high and low frequencies,
to balance resilience and raw
throughput. Protocols such as Multipath TCP (MPTCP) have
been analyzed [31]–[36], showing their advantages when, for
example, buildings block the direct mmWave path or fast
mobility cannot be fully supported by the mmWave network.
In [29], the authors assessed the goodput of a scenario
in which obstacles of different sizes are placed in the area
between the TX and the RX. The application layer simulated
a ﬁle transfer with full buffer and the authors noticed that
the number of obstacles plays a major role in the achievable
goodput. With fewer obstacles, there is a higher probability
of having a LoS channel and this has a crucial impact on the
data rate available at the physical layer.

Thus, the use of more accurate channel models, modeling

for instance the diffraction effect of obstacles and considering
appropriately the presence of multiple blockers, can provide
more precise results. For example, even in a simple human
blockage scenario where an obstacle moves perpendicularly
to the line between the TX and the RX, the loss is higher
when the obstacle crosses the LoS closer to one of the
nodes. This phenomenon, shown in our simulations, can be
described only by taking into account the diffraction effect
of the obstacles. Thus, it can be easily understood that in
more complex scenarios with many obstacles this effect has
a critical
impact on results. This is the reason why we
implemented an open source software able to (i) include
diffraction-based blockage models, (ii) interface directly with
an open source Radio Frequency (RF) ray-tracing software,
(iii) support multiple mobile blockers.

III. SOFTWARE ARCHITECTURE

The Blockage Manager was designed as a self-contained
software to model the effect of blockage in RT traces. Doing
it
in post-processing allows running the computationally-
demanding RT only once, including in the simulation all the
static elements with a single CAD model. Any distribution of
the dynamic elements, i.e., blockers, can then be introduced
in the static scenario using the Blockage Manager, that can
use the same RT output as a static baseline for any blocker
conﬁguration.

The Blockage Manager is organized in modules, each
providing a set of classes and functions to handle the elements
required for the simulation. Here, we report a brief overview
of the different modules,
to offer some insights on the
implementation and to clarify how the results presented in
Sec. V were obtained.

Although geometry libraries exist in Python [37], [38], in
order to meet all the simulation requirements (3D geometry
with fast computation time), and to build a self-contained
package, we decided to implement all the basic geometrical
objects and operations from scratch. Thus, we developed a
custom Geometry module to handle the geometry of the
ray and of the obstacles themselves, and to deﬁne consistent
mobility patterns of the latter. This module underlies most of
the operations carried out during the simulation and can be
optimized independently in the future, thanks to the common
object interface.

The RT traces can be imported in the Blockage Man-
ager using the Scenario interface, that deﬁnes common
traces in the target format, as
methods to import/export
well as to access and update sets of rays between nodes.
Currently, the Scenario interface supports traces from the
qd-realization software, which is speciﬁcally able to handle
channel traces for multiple users and timesteps. However, the
interface allows for the possibility to support different ray-
tracing formats, that could be implemented in the future. The
information for each ray (delay, path gain, phase, path) is
stored in a Ray object, that also offers a simple interface to
consistently compute Angles of Departure (AoDs) and Angles
of Arrival (AoAs).

Then, blockers can be introduced in the scenario with
the common Obstacle interface, that handles obstructions,
diffraction, and other effects that a generic obstacle may
impose over the Rays of the imported Scenario. Currently,
a sphere, a rectangular and an orthogonal-rectangular screens

The Fresnel integral can be computed by numerical calcu-
lation, however [39] provides a simple way to compute an
approximate result.

Obstruction

When an obstacle cuts through a transmission path, the
simplest obstruction model consists in applying a constant
loss L during the shadowing window, resulting in a sharp
transition between an obstructed and an unobstructed path.
The obstruction loss is generally computed based on the
absorption properties of the obstacle. Depending on the model
assumptions, an obstructed path may be completely removed
from the scenario. Its simplicity makes this model desirable
in terms of computational and implementation complexity,
so that
it has often been chosen for end-to-end network
simulations [40]–[42]. Unfortunately, the unrealistic sharp
drop not only yields imprecise results, but can also affect
some beam-tracking algorithms, which are of the utmost
importance when it comes to mmWave communication.

METIS

The Mobile and wireless communications Enablers for
the Twenty-twenty Information Society (METIS) channel
model [21] provides a simpliﬁed method to account for the
diffraction contribution at mmWave frequencies. The screen
is assumed to be vertical and perpendicularly oriented with
respect to the considered ray segment in the projection from
above. The diffraction loss is modeled using a KED model
for the four edges of the screen as:

L = −20 log10 (1 − (lh1 + lh2)(lw1 + lw2))

[dB]

(4)

where lhi and lwi are the Single Knife-Edge Diffraction
(SKED) at edge i, corresponding to the height h and the
width w of the obstacle. The loss of each single edge is
provided by:

(cid:18)

± π
2

(cid:113) π(dT ,i+dR,i−r)
λ

(cid:19)

atan

li =

π

(5)

where, as shown in Fig. 1, dT,i and dR,i are the distances
between the nodes and edge i of the screen, and r is the
distance between the TX and the RX. If the link is NLoS,
then each contribution is taken as positive, whereas for LoS
condition, only the farthest edge from the link provides a
positive contribution.

Double Knife-Edge Diffraction (DKED)

This model [43] computes the SKED from the screen edges
evaluating both amplitudes and phases. Since only the lateral
edges are considered for the KED, the interaction of the
obstacle with the propagating waves is that of a vertical
stripe of inﬁnite vertical extent. The SKED for edge i can
be computed as:

li =

1 + j
2

(cid:20)(cid:18) 1
2

(cid:19)

− C(νi)

− j

(cid:18) 1
2

(cid:19)(cid:21)

− S(νi)

(6)

and then, this model computes the superposition of each
contribution to obtain the diffraction loss:

L = −20 log10(|l1 + l2|)

[dB]

(7)

Besides, as the Semi-empirical ITU model, it provides a valid
solution even for non-orthogonal obstacles, and thus can be
exploited for a larger variety of obstacles.

Fig. 1: DKED geometry.

are implemented. We deﬁned the orthogonal-rectangular ob-
stacle as an ideal rectangular screen that behaves as if it
were orthogonal to any considered ray, when computing the
interaction between the two. As detailed in Sec. IV, this
artiﬁcial obstacle was introduced to meet the hypotheses of
several diffraction models, that could thus be included in
the software. On the contrary, the rectangular screen can
be tilted in both the azimuth and elevation directions, thus
providing a more general obstacle mobility at the cost of a
limited set of available diffraction models. The movement
of an obstacle during the simulation is described by a
MobilityModel. At each time step, the position of each
obstacle is updated based on such model, thereby providing
accurate and temporally-correlated mobility and making the
channel temporally consistent. The whole simulation, i.e.,
computing the interactions of the rays with the obstacles, and
updating the positions of the obstacles at each time step, is
handled by the Environment, that constitutes the core of
the software, with just a few lines of code.

IV. BLOCKAGE MODELS

When considering the interaction between an object and a
signal propagating in the free space from point T to point
R, the Fresnel Zones offer a useful model to analyze the
intensity of the diffraction. The Fresnel zones are concentric
ellipses with focal points at T and R, and radius

(cid:114)

rn =

nλ

dT dR
dT + dR

(1)

where λ is the wavelength of the transmitted signal, dT
(dR) is the distance between the diffraction point and the
transmitter (receiver), and n is the order of the Fresnel Zone.
If the cross section of the First Fresnel Zone is obstructed,
diffraction becomes the dominant term in the interaction with
the object, with signiﬁcant impact on the communication
performance. In the Blockage Manager, several models to
describe the diffraction loss are available. In this section, we
provide a brief overview of those that were considered for
the simulations described in Sec. V.

As the majority of the diffraction models is based on the
Fresnel formulation, we deﬁne the complex Fresnel integral
as:

F (ν) =

(cid:90) ν

ej πs2

2 ds

where ν is the Fresnel-Kirchhoff diffraction parameter:

0

ν(h) = h

(cid:114) 2
λ

dT + dR
dT dR

(2)

(3)

and depends on the obstruction depth h. The real and imag-
inary parts of F (ν) can be recalled as follows:

F (ν) = C(ν) + jS(ν)

TXRXedge]

B
d
[

s
s
o
L

n
o
i
t
c
a
r
f
f
i

D

0

−10

−20

]

B
d
[

s
s
o
L

n
o
i
t
c
a
r
f
f
i

D

0

−10

−20

−30

]

B
d
[

s
s
o
L

n
o
i
t
c
a
r
f
f
i

D

0

−10

−20

Baseline
Obstruction
METIS
DKED+PC
DKED
ITU SE

−0.4

−0.2

0

0.2

0.4

0

2

4

6

8

Obstacle Location [m]

Obstacle Distance from TX [m]

(a) Models at 60 GHz

(b) Different obstacle’s distance

Fig. 2: Comparison between the implemented models using a carrier frequency of 60 GHz.

10 GHz

30 GHz

60 GHz

100 GHz

0

−10

−20

−30

0

−10

−20

−30

0

−10

−20

−30

−0.4 −0.2

0

0.2

0.4

−0.4 −0.2

0

0.2

0.4

−0.4 −0.2

0

0.2

0.4

−0.4 −0.2

0

0.2

0.4

Obstacle Location [m]

Obstacle Location [m]

Obstacle Location [m]

Obstacle Location [m]

(a) METIS

(b) DKED

(c) DKED+PC

(d) Semi-Empirical ITU

Fig. 3: Comparison of the implemented models at different frequencies.

Double Knife-Edge Diffraction with Phase Correction
(DKED+PC)

In [43], the authors present also a modiﬁed version of
the DKED. Namely, the SKED is computed for the two
contributions (front and back of the body) as described
by Eq. (6) for the DKED model. Additionally, this method
takes into account the phase shift of the diffracted rays path
when combining the two contributions.

L = −20 log10

(cid:16)(cid:12)
(cid:12)l1 · e−j 2π∆d1
(cid:12)

λ + l2 · e−j 2π∆d2

λ

(cid:17)

[dB]

(cid:12)
(cid:12)
(cid:12)

(8)
where ∆di is the length of the i-th diffracted ray. The model
is presented and calibrated for ultra-wideband measurements
between 4 and 10 GHz. However, its analytical derivation is
based on the Fresnel diffraction theory, that holds also for
higher frequencies, as reported in [7].

ITU-R P.526-15

The International Telecommunication Union (ITU) pro-
vides guidelines on the modeling of the diffraction in [39].
Based on the Uniform Theory of Diffraction (UTD) and on
high-precision measurements, two approximations are given
for estimating the minimum and the average diffraction
loss. Furthermore, a Semi-Empirical method (ITU SE) is
derived for thin rectangular screens, that exhibits the rapid
ﬂuctuations of the ﬁeld strength due to the constructive and
destructive interference of the diffraction from the edges.
This method can be used also for non-orthogonal obstacles.
Moreover, with reasonable accuracy, it does not require the
Fresnel integral to be solved. Both models can be applied
when the wavelength is fairly small in relation to the size of
the obstacles, which is the case when considering human-size
blockers at mmWave frequencies. The mathematical details
of this method are reported in [39].

V. RESULTS
In this section, we present a set of results obtained using
the Blockage Manager, to showcase the framework and offer
some insight on the impact of blockage modeling on network
simulations, and to compare the different diffraction models.
First, in Sec. V-A, we will show their general behavior as
thus considering the
directly described by the equations,
effect that the obstacle has when passing through the direct
ray between transmitter and receiver.

Then, Sec. V-B will consider a more realistic static sce-
nario, where transmitter and receiver are still ﬁxed but placed
in a room, and reﬂections, computed using a ray-tracer, also
interact with the moving obstacle.

Finally, in Sec. V-C a more complex dynamic scenario is
evaluated, where we consider an access point placed on the
ceiling of a room and a user moving away from it. In this
case, multiple obstacles move in the scenario, to make the
simulation even more realistic.

All the scenarios but one consider the obstacle(s) passing
through the LoS ray to better highlight the effect of the
diffraction on the received power. As detailed in the follow-
ing, we consider also the case where the obstacles do not
intercept the main ray, but only the reﬂected ones, to show
that diffraction is relevant also in this situation. For this work,
we consider an (orthogonal-rectangular) thin screen, which
provides a simpliﬁed yet realistic representation of the human
body, according to measurements [7], [43] and standards [21],
to 10 dB, obtained by
[39]. The obstruction loss is set
averaging the mean loss of the considered diffraction models.
First, the qd-realization traces are imported in the Blockage
Manager, that applies the diffraction loss to the rays ac-
cording to the obstacle conﬁguration. Link-layer simulations
are then run on the traces using the same custom MATLAB
simulator as in [6], [44], to observe the blockage effect on the
SNR. However, given that the format of the output traces of

40

35

30

25

]

B
d
[

R
N
S

METIS
Baseline
DKED+PC
DKED
ITU SE
Obstruction

0

0.5

1

1.5

2

2.5

3

3.5

4

4.5

5

(a) Static scenario.

Time [s]

(b) Max reﬂection order: 2

Fig. 4: Static scenario including second-order reﬂections.

z

3

0
0

TXref

RXref

19

5

x

10 0

y

Fig. 5: Dynamic scenario

the Blockage Manager is the same as that of qd-realization,
they are compatible with other simulators such as Network
Simulator 3 (ns-3) [45]. The main parameters used for link-
level simulations are listed in Table I. Beamforming at both
the transmitter and the receiver is achieved using an antenna
array with omnidirectional antenna elements and λ/2 element
spacing.

A. Model Comparison

All implemented models have their own distinct charac-
teristics derived by their formulations. To give the reader an
idea of their behavior, we show a set of key comparisons for
these models in scenarios of interest.

We ﬁrst consider a TX at 1.6 m height, and a RX at
the same height placed 8 m away from the transmitter. An
obstacle of size 0.2×1.7 m passes perpendicularly halfway
between TX and RX, blocking the LoS between the two
nodes. To highlight the effect of the models, we only process
the direct ray, normalizing the received power to obtain the
diffraction loss. Fig. 2a shows the losses of the different
models at a 60 GHz carrier frequency.

TABLE I: Simulation parameters

TX Antenna
Antenna Spacing
Carrier Frequency
TX Power

8×8
λ
2
60 GHz
20 dBm

RX Antenna
Antenna Element
Bandwidth
Noise Figure

4×4
omni-directional
2.16 GHz
10 dB

In particular, the difference between the simple obstruction
and the more complex diffraction models can be clearly
observed. Complex physics-based models, in fact, show an
oscillatory behavior before and after the obstacle even inter-
cepts the LoS, due to its effect on the surrounding propaga-
tion environment, with peaks of almost 2 dB. Furthermore,
within the blockage region, very sharp deep fades affect the
channel with over 10 dB extra losses, due to destructive
interference among the rays curving around the obstacle. This
phenomenon, together with the high obstruction loss, can
make channel estimation and adaptation harder, thus further
reducing the communication efﬁciency in the presence of
obstacles. It is also possible to observe that different models
have different average obstruction losses, making us question
which one, if any, is close to the real-world measurements.

Instead, Fig. 2b shows what happens for the different
models when the same obstacle moves starting close to the
TX and moving towards the RX, always obstructing the direct
path between the two. For all diffraction models, the distance
between the obstacle and the nodes is taken into account
when modeling its effect on the channel. The ﬁgure shows
a symmetric behavior, justiﬁed by the symmetry of wireless
propagation, and all curves follow approximately the same
the loss tends to be higher when the
trend. Speciﬁcally,
obstacle is close to one of the nodes, and is lowest when
the obstacle is exactly in the middle, a trend that is observed
irrespective of the distance between TX and RX. Intuitively,
in fact, rays that need a sharper turn to surpass the obstacle
(i.e., when the obstacle is close to one of the nodes) lose
more energy than rays that need a shallower turn (i.e., when
the obstacle is farthest). A different explanation can be given
by thinking about the apparent size of the obstacle, as seen
from one of the nodes. The same obstacle has a different
apparent size depending on how far it is from its observer,
where closer objects appear larger than farther objects and
thus result in a deeper shadow.

Finally, it is important to remember that these models
heavily depend on the carrier frequency. In fact, in general
higher frequencies will present sharper and larger losses, due
to the larger electrical size of the obstacle with respect to the
wavelength. The short wavelength will also be more prone
to creating constructive and destructive interference between
the rays bending around the obstacle, creating deeper and

TXRX{{14 m7 m3 m1 mMETIS
DKED

Baseline
ITU SE

DKED+PC
Obstruction

]

B
d
[

R
N
S

50

40

30

20

0

5

10

Time [s]

(a) Obstacle locations (static).

(b) Full scenario

38

36

34

15

32

5

5.2

5.4

5.6

5.8

6

Time [s]

(c) Zoom

Fig. 6: Dynamic scenario with 4 static obstacles.

]

B
d
[

R
N
S

50

40

30

20

50

40

30

(a) The 15 moving obstacles inter-
cept the LoS ray as the RX moves
through the room.

0

5

10

Time [s]

(b) Full scenario

15

20

2.2

2.4

2.6

2.8

3

3.2

Time [s]

(c) Zoom

Fig. 7: Dynamic scenario with 15 dynamic obstacles.

more frequent loss peaks. Longer wavelength, instead, will be
able to more easily bend around an obstacle, greatly reducing
the obstruction losses. These results can also be observed in
Fig. 3.

B. Static Scenario

We tested our framework in a scenario inspired by [7].
Speciﬁcally, two static nodes are placed in positions p1 =
(1, 3, 1.6) and p2 = (9, 3, 1.6) within a 14×7×3 m3
room, as shown in Fig. 4a. We simulated the channel with
qd-realization [9], an open-source ray-tracing software for
mmWave propagation, considering up to second-order reﬂec-
tions.

We then imported the channel trace into the Blockage Man-
ager software, conﬁguring an orthogonal-rectangular screen
moving from pstart = (5, 0, 0) upwards at 1.2 m/s, and
sampled the channel every 3.4 ms for 1500 samples, for a
total of about 5 s of simulation time. We considered a thin
screen with a width of 20 cm and a height of 1.7 m, in an
attempt to emulate the size of the human body.

Fig. 4b reports the SNR observed by the receiving node.
As the obstacle crosses through the LoS, the SNR decreases
rapidly, showing a behavior similar to that described in
Sec. V-A both in shape and in amplitude. Speciﬁcally, ob-
serving a diffraction loss so close to the one presented in
Fig. 2 highlights how the LoS ray carries the great majority
of the signal power to the receiver, while the reﬂected ray can
not compensate for the diffraction loss caused by the blocker.
On the other hand, while the average loss is similar to the
one described in Sec. V-A, the deepest fades are mitigated
by secondary reﬂected rays carrying far less power. Namely,
the troughs observed in most of the diffraction models often
overestimate the fade depth [7]. However, a complete channel
simulation, where the transceivers and the obstacles are
immersed in a realistic three-dimensional environment, tends
to average them out, reducing the overall overshooting.

C. Dynamic Scenario

For this scenario, a different room is considered: the length
and width are respectively equal to 19 m and 10 m, whereas
the height is 3 m as described in Fig. 5.

Although the environment, a rectangular room, is similar
to the previous one, in this case the receiver is not ﬁxed
and the two nodes are not at the same height. Indeed the
transmitter has a ﬁxed position in p1 = (5, 0.1, 2.9) and the
receiver starts from a position right below the transmitter,
pstart = (5, 0.1, 1.5), and moves away from it at 1.2 m/s for
about 15.7 s, reaching the position pﬁnal = (5, 18.9, 1.5) next
to the farthest wall from the TX position. The total number of
samples is 3133, achieved using a sampling period of 5 ms.
Following the results from [6], we simulated up to second-
order reﬂections, and excluded rays less powerful than the
most prominent one by more than 40 dB. These parameters
were shown to yield a good balance between computational
effort and accuracy of results. We then imported the results
into the Blockage Manager software with two different ob-
stacle settings.

In the ﬁrst scenario, reported in Fig. 6a, 4 static obstacles
of size 0.4×1.7 m2 are considered, none of them blocking the
direct ray. The obstacles are placed at decreasing distances
from the LoS, speciﬁcally in p1 = (5.2, 15.14, 0), p2 =
(5.8, 7.62, 0), p3 = (5.4, 11.38, 0), and p4 = (6.2, 3.86, 0).

As shown in Fig. 6, although the obstacles do not create
strong or sudden effects on the received power, they still
play an important role in the total received power, showing
differences with respect to the baseline of up to 8.2 dB. On the
other hand, as the RX passes by the ﬁrst three obstacles, all
models behave almost indistinguishably from each other, with
an absolute error of at most 1.6 dB with respect to the simple
obstruction model. On the contrary, the diffraction introduced
by the last and closest screen is signiﬁcant, with the SNR of
the diffraction models presenting a difference of about 5 dB

}}}}from that of the obstruction model. This justiﬁes our design
choice of setting a distance threshold on the diffraction model,
so that obstacles far enough from the ray will not affect it,
making it sufﬁcient to only model the most signiﬁcant effects
of the diffraction. Similarly, we also allow the user to fall back
to a simpler obstruction model for secondary or less powerful
rays, which have a much smaller effect on the total received
power.

Finally, in the second scenario we consider 15 obstacles
traversing the room at regular intervals, as represented in
Fig. 7a. The results in Fig. 7 show all the effects discussed so
far in the previous sections, combined in a more complex and
realistic scenario. In particular, it is possible to observe that (i)
all models behave as expected during obstruction (highlighted
in gray), (ii) obstacles affect the channel also when not di-
rectly blocking the LoS, (iii) constructive interference before
and after obstruction can actually be very signiﬁcant, even
overshooting the baseline, (iv) using a constant obstruction
loss does not represent well the complex interaction between
transceivers and obstacles, (v) when the receiver reaches the
other side of the room, and with multiple rays having similar
power to the direct path, obstruction is less severe and small
scale fading is actually the main concern.

VI. CONCLUSIONS

to model

In this paper we presented a novel open source tool, the
Blockage Manager,
the diffraction by dynamic
obstacles in RT traces. Namely, the software post-processes
the output from a ray-tracer, allowing the user to introduce an
arbitrary number of obstacles in the simulation, and modeling
their interactions with the rays choosing from a number
of diffraction models. The potential of the software was
showcased with simple yet insightful network simulations,
which already provided interesting results. We hope that
this tool lays the foundations for more accurate, large-scale
studies on the effects of blockage on mmWave networks.

Comparison with real-world data is an essential step to
validate the framework. A more precise calibration of the
diffraction models against measurements is currently being
considered, and we plan to provide a calibration toolbox as
an additional module for the framework.

Future steps will also focus on making the Blockage Man-
ager able to describe a much wider variety of scenarios, intro-
ducing new obstacles and diffraction models. For instance, a
foliage model could be implemented to increase the accuracy
in outdoor environments where the signal propagates through
trees and vegetation. Furthermore, UTD may be considered as
a more general approach to model the diffraction, including
obstacles of arbitrary shape and dimension.

Finally, a full stack analysis of a real scenario with accurate
obstacle models is essential to understand more precisely the
actual effect of multiple, dynamic obstacles on the ﬁnal user
experience in different practical situations.

REFERENCES

[1] T. S. Rappaport, S. Sun, R. Mayzus, H. Zhao, Y. Azar, K. Wang, G. N.
Wong, J. K. Schulz, M. Samimi, and F. Gutierrez, “Millimeter wave
mobile communications for 5G cellular: It will work!” IEEE Access,
vol. 1, pp. 335–349, 2013.

[2] S. Rangan, T. S. Rappaport, and E. Erkip, “Millimeter-wave cellular
wireless networks: Potentials and challenges,” Proceedings of the IEEE,
vol. 102, no. 3, pp. 366–385, Mar. 2014.

[3] S. Deng, G. R. MacCartney, and T. S. Rappaport, “Indoor and outdoor
5G diffraction measurements and models at 10, 20, and 26 GHz,” in
IEEE Global Communications Conference (GLOBECOM), Dec. 2016.

[4] I. A. Hemadeh, K. Satyanarayana, M. El-Hajjar, and L. Hanzo,
“Millimeter-wave communications: Physical channel models, design
considerations, antenna constructions, and link-budget,” IEEE Commu-
nications Surveys and Tutorials, vol. 20, no. 2, pp. 870–913, Second
Quarter 2018.

[5] M. Lecci, P. Testolina, M. Giordani, M. Polese, T. Ropitault, C. Gentile,
N. Varshney, A. Bodi, and M. Zorzi, “Simpliﬁed Ray Tracing for the
Millimeter Wave Channel: A Performance Evaluation,” in Information
Theory and Applications Workshop (ITA), San Diego, CA, USA, Feb.
2020.

[6] M. Lecci, P. Testolina, M. Polese, M. Giordani, and M. Zorzi, “Ac-
curacy Versus Complexity for mmWave Ray-Tracing: A Full Stack
Perspective,” IEEE Transactions on Wireless Communications, vol. 20,
no. 12, pp. 7826–7841, Dec. 2021.

[7] A. Bhardwaj, D. Caudill, C. Gentile, J. Chuang, J. Senic, and D. G.
Michelson, “Geometrical-empirical channel propagation model for
human presence at 60 GHz,” IEEE Access, vol. 9, pp. 38 467–38 478,
2021.

[8] G. R. MacCartney, S. Deng, S. Sun, and T. S. Rappaport, “Millimeter-
wave human blockage at 73 GHz with a simple double knife-edge
diffraction model and extension for directional antennas,” in IEEE 84th
Vehicular Technology Conference (VTC-Fall), Sep. 2016, pp. 1–6.

[9] wigig-tools,

“qd-realization,”

realization/tree/feature/power-threshold,
implementation.

https://github.com/signetlabdei/qd-
ray-tracer

open-source

[10] T. Bai and R. W. Heath, “Coverage and rate analysis for millimeter-
wave cellular networks,” IEEE Transactions on Wireless Communica-
tions, vol. 14, no. 2, pp. 1100–1114, Feb. 2015.

[11] J. G. Andrews, T. Bai, M. N. Kulkarni, A. Alkhateeb, A. K. Gupta,
and R. W. Heath, “Modeling and analyzing millimeter wave cellular
systems,” IEEE Transactions on Communications, vol. 65, no. 1, pp.
403–430, Jan. 2017.

[12] P. Ferrand, M. Amara, S. Valentin, and M. Guillaud, “Trends and
challenges in wireless channel modeling for evolving radio access,”
IEEE Communications Magazine, vol. 54, no. 7, pp. 93–99, Jul. 2016.
[13] 3GPP, “Study on channel model for frequencies from 0.5 to 100 GHz,”
3rd Generation Partnership Project (3GPP), Technical Report (TR)
38.901, Jun. 2018, version 15.0.0.

[14] M. Gapeyenko, V. Petrov, D. Moltchanov, S. Andreev, Y. Koucheryavy,
M. Valkama, M. R. Akdeniz, and N. Himayat, “An Analytical
the 3GPP 3D Channel Model Parameters for
Representation of
MmWave Bands,” in Proceedings of
the 2nd ACM Workshop on
Millimeter Wave Networks and Sensing Systems, ser. mmNets ’18.
New Delhi, India: Association for Computing Machinery, 2018, p.
33–38. [Online]. Available: https://doi.org/10.1145/3264492.3264498

[15] T. Zugno, M. Polese, N. Patriciello, B. Bojovi´c, S. Lagen, and M. Zorzi,
“Implementation of a Spatial Channel Model for Ns-3,” in ACM
Workshop on Ns-3 (WNS3), Gaithersburg, MD, USA, Jun. 2020.
[16] M. Lecci, M. Polese, C. Lai, J. Wang, C. Gentile, N. Golmie, and
M. Zorzi, “Quasi-Deterministic Channel Model for mmWaves: Math-
ematical Formalization and Validation,” in IEEE Global Communica-
tions Conference (GLOBECOM), Taipei, Taiwan, Dec. 2020.

[17] V. Degli-Esposti, F. Fuschini, E. M. Vitucci, M. Barbiroli, M. Zoli,
L. Tian, X. Yin, D. A. Dupleich, R. M¨uller, C. Schneider, and
R. S. Thom¨a, “Ray-tracing-based mm-Wave beamforming assessment,”
IEEE Access, vol. 2, pp. 1314–1325, 2014.

[18] J. McKown and R. Hamilton, “Ray tracing as a design tool for radio
networks,” IEEE Network, vol. 5, no. 6, pp. 27–30, Nov. 1991.
[19] K. Schuler, D. Becker, and W. Wiesbeck, “Extraction of virtual scatter-
ing centers of vehicles by ray-tracing simulations,” IEEE Transactions
on Antennas and Propagation, vol. 56, no. 11, pp. 3543–3551, Nov.
2008.

[20] M. Ghaddar, L. Talbi, T. A. Denidni, and A. Sebak, “A conducting
cylinder for modeling human body presence in indoor propagation
channel,” IEEE Transactions on Antennas and Propagation, vol. 55,
no. 11, pp. 3099–3103, Nov. 2007.

[21] “METIS Channel Models,” Deliverable D1.4, Feb. 2015.
[22] J. Medbo and F. Harrysson, “Channel modeling for the stationary UE
scenario,” in 7th European Conference on Antennas and Propagation
(EuCAP), Gothenburg, Sweden, Apr. 2013.

[23] M. D. Casciato, “Radio wave diffraction and scattering models for
wireless channel simulation,” Ph.D. dissertation, University of Michi-
gan, 2001.

[24] D. Prado-Alvarez, S. Inca, D. Mart´ın-Sacrist´an, and J. F. Monserrat,
“Millimeter-wave human blockage model enhancements for direc-
tional antennas and multiple blockers,” IEEE Communications Letters,
vol. 25, no. 9, pp. 2776–2780, Sep. 2021.

[25] C. Slezak, M. Zhang, M. Mezzavilla, and S. Rangan, “Understanding
End-to-End Effects of Channel Dynamics in Millimeter Wave 5G New
Radio,” in IEEE 19th International Workshop on Signal Processing
Advances in Wireless Communications (SPAWC), 2018, pp. 1–5.

[26] M. Jacob, S. Priebe, A. Maltsev, A. Lomayev, V. Erceg, and T. Kurner,
“A ray tracing based stochastic human blockage model for the IEEE
802.11ad 60 GHz channel model,” in 5th European Conference on
Antennas and Propagation (EuCAP), Rome, Italy, Apr. 2011.

[27] A. Maltsev et al., “Channel models for 60 GHz WLAN systems,”
09/0334r8, IEEE Task Group ad (TGad), Tech. Rep., May 2010.
[28] M. Zhang, M. Polese, M. Mezzavilla, J. Zhu, S. Rangan, S. Panwar,
and M. Zorzi, “Will TCP Work in mmWave 5G Cellular Networks?”
IEEE Communications Magazine, vol. 57, no. 1, pp. 65–71, January
2019.

[29] M. Polese, M. Mezzavilla, S. Rangan, and M. Zorzi, “Mobility Man-
agement for TCP in MmWave Networks,” in 1st ACM Workshop on
Millimeter-Wave Networks and Sensing Systems (mmNets), ser. mmNets
’17, Snowbird, Utah, USA, Oct. 2017.

[30] M. Polese, M. Mezzavilla, M. Zhang, J. Zhu, S. Rangan, S. Panwar,
and M. Zorzi, “milliProxy: A TCP proxy architecture for 5G mmWave
cellular systems,” in 51st Asilomar Conference on Signals, Systems,
and Computers, 2017, pp. 951–957.

[31] M. Polese, R. Jana, and M. Zorzi, “TCP in 5G mmWave networks: Link
level retransmissions and MP-TCP,” in IEEE Conference on Computer
Communications Workshops (INFOCOM WKSHPS), 2017, pp. 343–
348.

[32] ——, “TCP and MP-TCP in 5G mmWave Networks,” IEEE Internet

Computing, vol. 21, no. 5, pp. 12–19, Sep. 2017.

[33] M. Mezzavilla, M. Zhang, M. Polese, R. Ford, S. Dutta, S. Rangan,
and M. Zorzi, “End-to-end simulation of 5G mmWave networks,” IEEE
Communications Surveys and Tutorials, vol. 20, no. 3, pp. 2237–2263,
Third Quarter 2018.

[34] Y. Ren, W. Yang, X. Zhou, H. Chen, and B. Liu, “A survey on TCP
over mmWave,” Computer Communications, vol. 171, pp. 80–88, Apr.
2021.

[35] I. Khan, M. Ghoshal, S. Aggarwal, D. Koutsonikolas, and J. Widmer,
“Multipath TCP in Smartphones Equipped with Millimeter Wave
Radios,” in 15th ACM Workshop on Wireless Network Testbeds, Exper-
imental Evaluation and Characterization (WiNTECH), New Orleans,
LA, USA, Jan. 2022.

[36] C. Lee, S. Song, H. Cho, G. Lim, and J.-M. Chung, “Optimal Multipath
TCP Ofﬂoading Over 5G NR and LTE Networks,” IEEE Wireless
Communications Letters, vol. 8, no. 1, pp. 293–296, Feb. 2019.

[37] A. Meurer, C. P. Smith, M. Paprocki, O.

Ivanov,

ˇCert´ık, S. B. Kirpichev,
M. Rocklin, A. Kumar, S.
J. K. Moore, S. Singh,
T. Rathnayake, S. Vig, B. E. Granger, R. P. Muller, F. Bonazzi,
H. Gupta, S. Vats, F. Johansson, F. Pedregosa, M. J. Curry, A. R.
Terrel, v. Rouˇcka, A. Saboo, I. Fernando, S. Kulal, R. Cimrman,
and A. Scopatz, “Sympy: symbolic computing in python,” PeerJ
Computer Science, vol. 3, p. e103, Jan. 2017. [Online]. Available:
https://doi.org/10.7717/peerj-cs.103

[38] S. Gillies et al., “Shapely: manipulation and analysis of geometric ob-
jects,” 2007–. [Online]. Available: https://github.com/shapely/shapely
[39] ITU-R, “Propagation by diffraction,” Recommendation ITU-R P.526-

15, Oct. 2019.

[40] R. Ford, M. Zhang, S. Dutta, M. Mezzavilla, S. Rangan, and M. Zorzi,
“A Framework for End-to-End Evaluation of 5G MmWave Cellular
Networks in Ns-3,” in Proceedings of the ACM Workshop on Ns-3
(WNS3), Seattle, WA, USA, Jun. 2016.

[41] H. Assasa and J. Widmer, “Implementation and Evaluation of a WLAN
IEEE 802.11ad Model in Ns-3,” in Proceedings of the Workshop on
Ns-3 (WNS3), Seattle, WA, USA, Jun. 2016.

[42] ——, “Extending the IEEE 802.11ad Model: Scheduled Access, Spatial
Reuse, Clustering, and Relaying,” in Proceedings of the Workshop on
Ns-3 (WNS3), Porto, Portugal, Jun. 2017.

[43] J. Kunisch and J. Pamp, “Ultra-wideband double vertical knife-edge
model for obstruction of a ray by a person,” in IEEE International
Conference on Ultra-Wideband, Hannover, Germany, Sep. 2008.
[44] P. Testolina, M. Lecci, M. Polese, M. Giordani, and M. Zorzi, “Scalable
and accurate modeling of the millimeter wave channel,” in International
Conference on Computing, Networking and Communications (ICNC),
Feb. 2020, pp. 969–974.

[45] T. R. Henderson, M. Lacage, G. F. Riley, C. Dowell, and J. Kopena,
“Network simulations with the ns-3 simulator,” vol. 14, no. 14, 2008,
p. 527.

