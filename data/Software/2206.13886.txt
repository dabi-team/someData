Modal analysis of photonic and plasmonic resonators: user guide 
for the MAN program 

T. Wu1,†, D. Arrivault1, W. Yan2,3, P. Lalanne1,* 
1LP2N, Institut d’Optique Graduate School, CNRS, Univ. Bordeaux, 33400 Talence, France 
2Key Laboratory of 3D Micro/Nano Fabrication and Characterization of Zhejiang Province, School of 
Engineering, Westlake University, 18 Shilongshan Road, Hangzhou 310024, Zhejiang Province, China 
3Institute of Advanced Technology, Westlake Institute for Advanced Study, 18 Shilongshan Road, 
Hangzhou 310024, Zhejiang Province, China 
* philippe.lalanne@institutoptique.fr     
† wutong1121@gmail.com  

Abstract 

Any  electromagnetic  system,  in  particular  resonators,  has  resonances  with  finite  lifetimes.  The 
associated eigenstates, also called quasinormal modes, are essentially non-Hermitian and determine 
optical responses of the system. We introduce MAN (Modal Analysis of Nanoresonators), a software 
with  many  open  scripts  which  computes  and  normalizes  the  quasinormal  modes  of  virtually  any 
electromagnetic  resonator,  be  it  composed  of  dispersive,  anisotropic,  or  non-reciprocal  materials. 
MAN reconstructs the scattered field in the basis formed by the quasinormal modes of the resonator 
and provides a transparent interpretation of the physics. 

The software is implemented in MATLAB and has been developed over the past ten years. MAN 
features many toolboxes that illustrate how to use the software for various emblematic computations 
in nanophotonics. A specific effort has been devoted to interface the solver with the finite-element 
software COMSOL Multiphysics. However, the software can also be used with other frequency-domain 
numerical  solvers.  This  article  introduces  the  program,  summarizes  the  relevant  theory,  and  is 
supplemented by a comprehensive suite of classic examples that can be downloaded from our web. 

Program Summary 

Program title: MAN 
CPC Library link to program files: XXXXX 
Licensing provisions: GNU General Public License 3 
Developer’s repository link: https://www.lp2n.institutoptique.fr/equipes-de-recherche-du-lp2n/light-
complex-nanostructures  
Programming language: Matlab, Comsol 
Nature of problem: Compute and normalize the quasinormal-modes of optical resonators of any type, 
be it composed of dispersive, anisotropic, or non-reciprocal materials. Use the quasinormal-modes to 
reconstruct the optical responses: scattered field, local density of states, second-harmonic field, and 
so on. 
Solution method: Two methods are offered. The quasi-normal modes are computed either by solving 
the linearized Maxwell’s equation or searching poles in the complex frequency plane. 

KEYWORDS: Computational electromagnetic methods,  Resonators,  Quasinormal mode, Microcavity 
devices, Nanoresonator, Inverse design, Plasmon. 

 
 
 
1. Motivation 

The  interaction  of  light  with  electromagnetic  resonators  is  fundamentally  driven  by  the  natural 
resonances of the system. Under excitation by a pulse, the resonances are initially loaded, and then 
release their energy by exponentially decaying in time. Resonators are open non-Hermitian systems 
that do not conserve their energy. This is why their supported resonances are often called quasinormal 
modes (QNMs), therein emphasizing that they are the eigenvectors of a non-Hermitian operator, the 
Maxwell operator, with complex eigenfrequencies. They are formally defined as the time-harmonic 
solutions to the source-free Maxwell equations [1] 

∇ × 𝐄̃ = −𝑖𝜔̃𝛍(𝐫, 𝜔̃)𝐇̃ ,
∇ × 𝐇̃ = 𝑖𝜔̃𝛆(𝐫, 𝜔̃)𝐄̃ ,
+ outgoing waves conditions at infinity.

(1) 

We use the exp(𝑖𝜔𝑡) convention and denote with a tilde QNM complex-valued frequencies, 𝜔̃ =
Ω + 𝑖𝛤/2, where 𝛤 stands for the decay rate, i.e., the inverse of the mode lifetime 𝜏 = 1/Γ. The factor 
1/2  accounts  for  the  difference  between  amplitude  and  energy  decays.  Throughout  the  article, 
[𝐄̃(𝐫), 𝐇̃(𝐫)] denotes the electric and magnetic fields of normalized QNMs. Normalization is central in 
QNM theory. It is not documented in the present article; for more informations, please refer to other 
sources, e.g. Sec. 4 in [2] that reviews and compares various methods to normalize QNMs. 

In this work, we present MAN (Modal Analysis of Nanoresonator), an open-source software that 
uses  the  QNM  basis  for  analyzing  the  response  of  virtually  any  micro  or  nanoresonators,  be  them 
photonic,  plasmonic,  or  composed  of  non-reciprocal  dispersive  materials.  MAN  is  the  result  of  a 
collective  effort,  initiated  at  the  Institut  d’Optique  in  Palaiseau  by  Jean-Paul  Hugonin,  Christophe 
Sauvan and Philippe Lalanne [3,4] and continued in Bordeaux over the last decade [1,2,5-12]. 

MAN has two main purposes. First, it offers efficient ways to compute and normalize the QNMs by 
gathering  the  two  first  available  freeware,  QNMPole  [3,4]  and  QNMEig  [6]  that  were  respectively 
launched in 2013 and 2018, in a user-friendly package implemented in MATLAB. Second, it provides 
various  toolboxes  for  reconstructing  the  resonator  responses,  e.g.  scattered  field,  extinction  and 
absorption cross-sections, local density of electromagnetic states (LDOS), as a superposition of QNMs. 
MAN is conceived to help the user to analyze the physics of electromagnetic resonators and identify 
the dominant QNMs to offer physical transparency in the design or interpretation. It devotes special 
attention  to  the  computation  of  key  QNM  figures  of  merit,  such  as  the  mode  volume,  a  complex 
quantity  for  non-Hermitian  systems  that  is  central  to  the  notion  of  LDOS  involved  in  the  resonant 
interaction  of  light  with  molecules  or  atoms  [1,11].  It  also  informs  the  user  on  important  QNM 
properties,  such  as  their  far-field  radiation  pattern,  their  multipolar  nature,  or  their  brightness  for 
absorptive resonators. 

2. Underlying principles of the code 

2.1. Overview 
Figure  1  shows  the  structure  of  the  software.  The  source  code  is  composed  of  four  main  folders: 
TUTORIALS, SOLVERS, TOOLBOXES, and DOC, which are completed by a +tests folder for internal use 
by the software developers.  

The TUTORIALS folder contains several MATLAB scripts, e.g.  Tutorial2D.m and Tutorial3D.m, which 
provide  a  step-by-step  guidance  to  help  the  user  to compute,  normalize,  sort,  and  save  the  QNMs 
computed with the solvers QNMEig or QNMPole. See Section 2.2 for details. 

The SOLVER  folder contains all the MATLAB functions used by  the QNM solvers  and  companion 

scripts for QNMs computation, postprocessing, and visualization.  

The  QNM solvers are  valued by an increasing number of toolboxes  gathered in the  TOOLBOXES 
folder.  The  toolboxes  contain  illustrative  examples  and  user  guides  of  emblematic  problems  in 

 
nanophotonics. A detailed introduction to the toolboxes is found in Sec. 4. The toolboxes are solver 
dependent; this is quite formal since, with a minor effort from the user, the toolboxes developed for 
one solver may be adapted for use with the other solver. 

The DOC folder contains user guides for QNMEig, QNMPole, and all the toolboxes in MAN.  
By  executing  the  MATLAB buildAndSaveComsolModels.m  script  of  the  TUTORIALS  folder,  a  new 
folder  named  MANMODELS  will  be  created  in  the  root  folder  of  MAN.  The  MANMODELS  folder  is 
composed of  over  20  COMSOL  models,  including  photonic  crystal cavities,  plasmonic  nanospheres, 
nano-particle-on-mirror (NPoM) geometries, and so on. Each model is solver-dependent. They can be 
studied with either QNMEig or QNMPole, but not with both solvers. The panel of models will grow up 
and develop over time.  

Fig. 1. Structure of MAN. 

2.2. QNM solvers 
To cover a broad scope of applications, MAN implements two largely different QNM solvers.  

QNMEig  can  be  viewed  as  an  extension  of  the  eigenmode  solver  implemented  in  the  COMSOL 
Multiphysics RF Module. The RF Module eigenmode solver is effective and accurate only for QNMs of 
non-dispersive  materials.  For  dispersive  materials,  the  Maxwell  operator  defines  a  non-linear 
eigenproblem since the permittivity (or permeability) depends on the eigenvalue and the RF Module 
solver  becomes  inaccurate.  QNMEig  computes  the  QNMs  by  coupling  the  built-in  RF  Module  and 
Weak-form  Module.  The  solver  linearizes  the  eigenproblem  with  auxiliary  fields  and  efficiently 
computes  a  large  number  (assigned  by  the  user)  of  QNMs  with  high  accuracy  [6],  even  for  highly 

 
dispersive media. The QNMs are then normalized by computing a volume integral with the so-called 
PML-normalization  [2,3].  Sections  5.1  and 5.2  provide  more  details,  see  also  [6].  Approximately  20 
COMSOL models can be used with QNMEig. They cover many geometries and materials (see Table 1) 
of current interest in nanophotonics.  

QNMPole computes and normalizes the QNMs by searching poles in the complex frequency plane 
[4], starting from an initial guess value and iteratively exploring the complex plane around the pole. 
Compared  to  QNMEig,  QNMPole  is  more  general, since  it  can  be  used  for  any  material  dispersion 
(Table  1).  It  also  requires  less  computational  skills  than  QNMEig,  since  the  user  does  not  have  to 
linearize  the  eigenvalue  problem  with  auxiliary  fields.  However,  it  is  in  general  less  efficient  than 
QNMEig, since the QNMs have to be computed sequentially. The use of QNMPole is recommended to 
compute a few QNMs, or if the permittivities of some dispersive constitutive materials do not obey 
the Lorentz-Drude and 𝑁-pole Lorentz models. QNMPole in principle can be used with any software 
capable of solving Maxwell equations in the frequency domain. We have presently only provided an 
interface  with  the  RF  Module  of  COMSOL.  The  user  has  to  supply  the  interface  if  they  use  other 
software. The documentation explains how to  build the interface with MATLAB and how to enable 
computations  at  complex  frequencies  with  a  software  initially  restrained  for  operation  at  real 
frequencies, e.g. the RF module of COMSOL. For details, please refer to the user guide QNMPole V7.pdf 
in the DOC/pdf/solvers/pole folder. 

Table 1. Summary of the QNMEig and QNMPole solvers. 

Constitutive materials 

Companion software needed 

Solver 

QNM 
computation 
method 

QNMEig 

[6] 

Auxiliary fields for 
solving a 
linearized version 
of the eigenvalue 
problem. 

2 − 𝑖𝜔𝛾𝑛 ). 

Lorentz-Drude: 
𝜀(𝜔)/𝜀∞ = 1 − Σ𝑛=1
                𝜔0𝑛
N-pole Lorentz: 
𝜀(𝜔) = 1 + Σ𝑛=1
             𝐴𝑛
Constant tensor. 

∗ /(𝜔 + 𝜔𝑛

∗ )]. 

𝑁 𝜔𝑝𝑛

2 /(𝜔2 −

𝑁 [𝐴𝑛/(𝜔 − 𝜔𝑛) −

QNMPole 

[4] 

Iterative pole 
search in the 
complex 
frequency plane. 

Any permittivity or permeability with a 
frequency dependence that is 
analytically known. 

•  COMSOL Multiphysics RF Module 
•  COMSOL  Multiphysics  Weak-form 

Module 

•  MATLAB  (for  postprocessing  and 

data visualization) 

•  Any software solving Maxwell 
equations in the frequency 
domain. 

•  MATLAB (for driving Maxwell 

solvers to search poles, 
postprocessing, and data 
visualization) 

Note that QNMPole and QNMEig strictly provide the same eigenfrequencies and normalized QNMs 

if they are both used with the same mesh. 

2.3. QNM expansion 
QNM expansion consists in decomposing the optical response as  a sum of QNM contributions. It is 
central  in  any  resonator  analysis  and  is  implemented  in  several  toolboxes  of  MAN,  e.g.  the 
reconstruction, non-linear, grating toolboxes (see Section 4 for details). 

The literature distinguishes two classes of methods to expand the response (i.e., the field 𝐄𝑆(𝐫, 𝜔) 
scattered by the  resonator excited by a monochromatic driving field at  frequency 𝜔)  into a sum of 
QNM contributions, see Table 1 in Ref. [2]. 

The  residue-expansion method  exploits the fact  that, under certain conditions, a representative 
function  of  the  system  response  (often  its  Green’s  tensor)  is  a  meromorphic  function  that  can  be 
decomposed as a sum of its poles (Mittag-Leffler theorem), which are the QNMs [13]. Completeness 
of  the  QNM  expansion  of  the  scattered  field, [𝐄𝑆(𝐫, 𝜔), 𝐇𝑆(𝐫, 𝜔)] = ∑ 𝛼𝑚(𝜔)[𝐄̃𝑚(𝐫), 𝐇̃ 𝑚(𝐫)]
,  is 

𝑚

achieved  for  a subspace of ℝ3 (inside  the resonator) only  for resonators surrounded by a uniform 
background (no substrate) [2]. 

In the second method adopted in MAN, the continuous Maxwell operator, originally defined on an 
open space, is replaced by a discretized linear operator, with a bounded physical domain surrounded 
by perfectly matched layers (PMLs) [14]. The latter transforms the open space into a regularized Hilbert 
space [2,6,15], replacing the exponential growth of the QNM field in the open space by an exponential 
decay in the PMLs. The regularized  eigenvectors of the discretized operator are composed of a finite 
subset  of  the  true  QNMs  [𝐄̃𝑚(𝐫), 𝐇̃ 𝑚(𝐫)]  of  the  open  system  (typically  the  subset  includes  the 
dominant  resonances  driving  the  resonator  response)  and  a  large  subset  of  numerical  modes 
(sometimes called PML modes [15]), which originates from the finite-discretized space bounded by 
PMLs [2,6]. The QNM expansion 

[

𝐄𝑆(𝐫, 𝜔)
𝐇𝑆(𝐫, 𝜔)

] = ∑

𝑚=1…∞

𝛼𝑚(𝜔)

𝐄̃𝑚(𝐫)
[
𝐇̃ 𝑚(𝐫)

] + ∑

𝑝=1…∞

𝑛𝑢𝑚(𝜔)

𝛼𝑝

𝐄̃𝑝
𝑛𝑢𝑚(𝐫)
[
𝐇̃ 𝑝
𝑛𝑢𝑚(𝐫)

], 

(2) 

is complete for all 𝐫 of the regularized (numerical) space, including the PMLs (see Section 5.3 for detail). 
In Eq. (2), the numerical modes [𝐄̃𝑝
 are denoted just like the true QNMs, by simply 
adding a superscript ‘𝑛𝑢𝑚’ for the sake of differentiation. They are computed exactly as the true QNMs, 
by solving the source-free Maxwell equations of Eq. (1). 

𝑛𝑢𝑚(𝐫), 𝐇̃ 𝑝

𝑇
𝑛𝑢𝑚(𝐫)]

The dependence of the excitation coefficients, 𝛼𝑚 or 𝛼𝑝

𝑛𝑢𝑚, with the driving field is analytical, as 
will be highlighted in Sections 4.2.1 and 4.2.2. This implies that, once the eigenvectors are computed 
and  normalized,  the  reconstruction  of  the  scattered  field  for  many  instances  of  the  driving  field 
becomes trivial, even in the temporal domain for resonators illuminated by pulses (see Section 4.3). 

The true QNMs and the numerical modes are treated in MAN in exactly the same way; they are 
computed  with  the  same  solvers,  and  their  excitation  coefficients  obey  the  same  closed-form 
expression.  In  fact,  mathematically,  it  is  therefore  not  necessary  to  distinguish  them,  and  we  will 
abusively refer to both types of eigenvectors as QNMs, hereafter. 

3. Getting started 

3.1. Installation 
To install MAN, one simply needs to unzip MAN-8.zip, then starts COMSOL Multiphysics with MATLAB, 
and adds the path of the main directory as well as the paths of all subfolders to the MATLAB search 
path. To do it, the user may run the function addManPath.m in the main directory: 
>> addManPath; 
   MAN incorporates more than 20 COMSOL models with various geometries and materials. They can 
be helpful to the users to create their own models. When using MAN for the first time, start by running 
buildAndSaveComsolModels.m in the TUTORIALS folder: 
>> buildAndSaveComsolModels; 
    This  will  create  a  new  folder  named  MANMODELS  in  the  root  directory  of  MAN.  MANMODELS 
contains all the COMSOL models (‘.mph’ files). The user will find two kinds of models with filenames 
started with ‘QNMEig’ and ‘QNMPole’, respectively  
    The QNMEig models can be used with the QNMEig solver. They can be run independently of any 
MATLAB script in MAN if the user goal is just to compute the normalized QNMs. Together with the 
models,  we  have  provided  several  documents  (click  Sphere,  Cubesubstrate,  …  in  the  MAN  User 
Guide.html file in the DOC folder) explaining how these COMSOL models are built. Special attention 
has been paid to explain how to handle dispersive media by coupling the COMSOL RF and Weak-form 
Modules.  Note  that  depending  on  whether  the  permittivity  (or  permeability  by  a  straightforward 
extension)  of the  dispersive  constitutive  materials  is described  by  Drude-Lorentz  or  N-Pole  Lorentz 
functions,  the  formulas  entered  in  the  Weak-form  Module  are  different.  The  documents  Sphere, 

Cubesubstrate, … provide the procedures to deal with the Drude-Lorentz permittivity. The user may 
refer to the model QNMEig_NanolettSi.mph for an example of a N-Pole Lorentz permittivity. 

The QNMPole models can be used with the QNMPole solver. In contrast to QNMEig files, these 
models need to be operated by a MATLAB script to compute and normalize the QNMs by iteratively 
searching for poles in the complex frequency plane [4]. The building of these QNMPole models is fairly 
easy, as they are very similar to the COMSOL models used for simulating the scattered field of the 
resonator at real frequency.  

The users are encouraged to build their own models by modifying the existing examples that are 

provided. 

3.2. Initial step: tutorial 
For a quick start, please start with one of the examples of the TUTORIALS folder, e.g. Tutorial2D.m, 
Tutorial3D.m,  which  provides  a  step-by-step  illustration  of  how  to  compute,  normalize,  sort,  and 
visualize QNMs using QNMEig or QNMPole. These examples may help understand the toolboxes that 
will be described in Section 4 to inspire the user to develop their own applications. 

Let us just consider the script Tutorial2D.m dedicated to 2D problems. A similar script, Tutorial3D.m, 
exists for 3D.  Tutorial2D.m  computes  the  TE or TM  supermodes of  a  pair  of silicon  nanowires. The 
computation can be performed by using either QNMEig or QNMPole.  
>>mansolver = 'eig'; or >>mansolver = 'pole'; 

Then, the user should choose a model in a predefined list (obtained by calling get2DEigModelList 
or get2DPoleModelList) or should build their own model. The MATLAB script either drives COMSOL to 
compute the QNMs or loads the precomputed results if the models in the folder MANMODELS are 
used. In general, the computation of the QNMs will consume most of the computer time. To save time 
for  further  use,  we  strongly  recommend  that  the  user  save  their  model  into  a  COMSOL  file  in 
MANMODELS after the first computation by calling 
>> [mphfile,mphfolder] = saveModel(Model); 

Hence, the QNMs do not have to be recomputed and can be loaded by calling 

>> QNM = getEigQNMs(Model); 

3.3. Minimal example 
Once the QNMs are computed or loaded, the next step is to determine the QNMs of interest. Important 
information about the QNMs is dsiplaced using the function plotComplexPlane: 
>> plotComplexPlane(Model,QNM);  

Figure 2 displays the MATLAB figure generated by the function, showing the position of the complex 
eigenfrequencies of all the computed eigenstates in the complex frequency plane. In general, the user 
is first interested in identifying the dominant QNMs that drive the physics of their systems. It is often 
a tedious task, and MAN helps the user by introducing two figures of merit: 
•  the  mode  ratio  (𝑀𝑅 ∈ [0,1],  see  the  MAN  User  Guide.html  in  the  DOC  folder  for  the  precise 
definition)  shown  by  the  disk  color  of  every  eigenvalue,  which  indicates  the  likelihood  that  the 
eigenstate is a true QNM (𝑀𝑅 = 1, yellow) or a numerical mode (𝑀𝑅 = 0, blue); 

•  the excitation strength (𝐸𝑆 ∈ [0,1], see the MAN User Guide.html for the precise definition) shown 
by the disk size of every eigenvalue, which characterizes the likelihood that the mode is excited by 
a plane wave. 

Fig. 2. Complex frequency plane and QNM information for a coupled pair of 2D silicon nanowires 
displayed with the function plotComplexPlane. The size and color of the markers visualize the 
excitation strength and mode ratio, respectively. Other important information  about the QNMs 
can be shown by clicking the mode in the figure. Inset: Sketch of the nanowire pair.  

Finally, it is possible to load the QNM near fields and permittivities in any user-defined coordinates 

by calling the functions, 
>> QNM = getModalFields(Model, QNM,'coord',coord); 

>> permitt = getRelativePermittivity(Model, QNM,coord); 

and plot maps of the QNM fields and the permittivity. 

4. Toolboxes 

4.1 Overview 
Table 2 lists the toolboxes of the Version 8. New toolboxes may be added in future versions for other 
applications.  This  section  provides  a  short  introduction  to  the  toolboxes  content;  a  step-by-step 
presentation can be found in the user guide documents inside the DOC folder. 

Table 2. List of the toolboxes in MAN. (*) denotes the toolboxes released for the first time in Version 
8. 

Toolbox acronym (Year of 
first release) 

Further 
reading 

Description 

reconstruction (*) (2022) 

[3,4,6] 

alpha-coefficient (2019) 

[6] 

nonreciprocal (2021) 

[11,12] 

nonlinear (2020) 

grating (2019) 

[9] 

[7] 

the  QNM  excitation  coefficients  𝛼 . 
Compute 
Reconstruct the electromagnetic fields, absorption and 
extinction  cross-sections,  Purcell  factors,  and  LDOS 
using QNMs. 

Same as for the reconstruction toolbox, but only valid 
for the simplest case where the resonator embedded 
in free space is excited with a plane wave. 

Compute  and  normalize  QNMs  for  nonreciprocal 
resonators. 

Solve nonlinear response of nanoresonators (second-
harmonic generation) in the QNM basis. 

Compute  the  specular  reflection  of  1D  grating  using 
QNM expansions. 

 
far-field-radiation (*) (2022) 

[11,16] 

Generate the far-field radiation diagrams of QNMs. 

multipole (2020) 

interpolation (2021) 

[8] 

[10] 

temporal-domain (*) (2022) 

[5,6] 

axisymmetric (*) (2022) 

Compute the intrinsic multipole moments of QNMs for 
resonators in free space. 

Provide  a  fast  and  accurate  reconstruction  of  the 
resonator response by interpolating the non-resonant 
contribution at real frequency. 

Reconstruct  the  temporal  response  of  the  resonator 
using QNMs. 

Same  as  the  reconstruction  toolbox,  but  valid  for 
optical resonators with axial symmetry. 

Toolbox organization. Each toolbox can be found in a separate folder, which is composed of a user 
guide document and several dedicated MATLAB source codes. Since most toolboxes rely on general 
MATLAB functions in the SOLVER folder to generate figures and load QNM fields and other information 
from COMSOL models, this folder should be added to the MATLAB path before using the toolboxes.  
   The toolboxes use the COMSOL models of MANMODELS for computing the QNMs. To study other 
optical systems, new COMSOL models should be implemented by the user. Since the toolboxes often 
rely  on  parameters  defined  in  the  COMSOL  models,  e.g.  the  parameters  of  the  Drude-Lorentz 
functions, the background permittivity, and domain numbers of the resonator, we recommend that 
the user follows the instruction of MAN User Guide.html to build their own models for accurate access 
to these parameters.  
Caution. The toolboxes have been developed over different periods; their level of development may 
differ.  For  example,  in  the  reconstruction  toolbox,  the  user only  needs  to  provide  the  angle of  the 
incident  plane  wave  and  the  background  layered  medium,  and  the  background  field  inside  the 
resonator (required to further compute the QNM excitation coefficients) is automatically computed. 
In the nonlinear toolbox, an analytical formula has to be provided for the background field inside the 
resonator. When starting with MAN, it is advised to study the code examples that are provided and 
follow  them  to  develop  a  new  application.  Similar  to  the  tutorial  scripts,  e.g.  Tutorial2D.m  or 
Tutorial3D.m, the example codes of the toolboxes also aim at giving pedagogical presentations that 
help the user to develop their own applications. 

4.2 Near-field reconstruction in the frequency domain 
In the  reconstruction  and the  alpha-coefficient toolboxes, the reconstruction is performed with the 
QNM expansion of Eq. (2) over the regularized space, including the PMLs. If all the eigenvectors are 
considered  in  the  expansion,  the  reconstruction  is  exact,  in  the  sense  that  the  reconstructed  field 
obtained with a sum of QNM contributions is mathematically equal to the field computed with a real 
frequency solver with the same mesh [6]. 

An important question is how fast one approaches the exact result by increasing the number 𝑁 of 
QNMs retained in the expansion. We may be interested in two kinds of convergence speed: asymptotic 
behaviors as 𝑁 → ∞ or initial behaviors on the  accuracy  achieved with only a few dominant QNMs 
(typically 𝑁 < 10)  that  govern  the  physics  of  the  system.  The  first  kind  of  convergence  is  more 
mathematically directed, and the second kind is very important in practice. So far, the whole literature 
provides no clear answer to the questions of the convergence issues. Only a few numerical studies 
have been performed from case to case. State-of-the-art studies of the convergence performance for 
landmark plasmonic resonators can be found in Ref. [6]. Other interesting cases can be found in Refs. 
[7,15,17-19]. 

The convergence issue is also complicated due to the existence of an infinite number of rigorous 
𝑛𝑢𝑚 ’s) for dispersive materials. The non-uniqueness arises from subtleties 
formulas for the 𝛼𝑚’s (or 𝛼𝑝
when choosing the source term with auxiliary fields, see Ref. [19] for details. Close to the resonance 
frequency (𝜔̃𝑚 → 𝜔), all the formulas converge to the same value, see Section 4.2 in [1]. However, 

 
 
away from the resonance, the formulas give rise to significantly different values of 𝛼𝑚’s. We believe 
that the choice of the source term has a weak impact on the asymptotic convergence rate. However, 
it has an impact on the accuracy achieved for small 𝑁′𝑠. 

Over  the  past  five  years,  we  have  studied  this  accuracy  for  various  nanoresonator  geometries. 
Depending on the geometry, we observe either very similar [19] or markedly different reconstruction 
accuracies [8,9]. We could not establish general rules, and this is the reason why special attention has 
been devoted to the implementation of the reconstruction toolbox. Overall, the latter offers a quite 
complete overview of the main methods available for reconstructing the near fields. In general terms, 
we recommend that the user follows the approach in [6] (method M 1 hereafter). Then, if they are not 
satisfied with the convergence or accuracy, they may try the other methods, especially method M 2 
that helped us much in our recent works [8,9]. 

The reconstruction and alpha-coefficient toolboxes also compute useful optical responses, e.g. the 
extinction  and  absorption  cross-sections,  and  the  Purcell  factors.  Note  that,  in  contrast  with  the 
reconstruction toolbox, the alpha-coefficient toolbox is valid only for resonators in free space and does 
not reconstruct the near-field. The later can be viewed as a simplified verion of the former that may 
have a better practicality for resonator in uniform media (without substrate). 

4.2.1 QNM excitation coefficient 
For non-dispersive materials, there is a unique expression for the 𝛼𝑚’s (or 𝛼𝑝

𝑛𝑢𝑚 ’s) [4,19] 

𝛼𝑚(𝜔) =   ∭ (Δ𝜀(𝐫, 𝜔) 𝜔
𝑉𝑟𝑒𝑠

𝜔̃ 𝑚−𝜔

) 𝐄𝑏 ∙ 𝐄̃𝑚𝑑3𝐫
, 

(3) 

where Δ𝜀(𝐫, 𝜔) = 𝜀(𝐫, 𝜔) − 𝜀𝑏 is the permittivity difference defining the resonator volume 𝑉𝑟𝑒𝑠 in the 
scattering  field  formulation,  see  Annex  2  in  Ref.  [1] for  details,  and 𝐄𝑏 is  the  background  field  (the 
driving  field  computed  for Δ𝜀 = 0).  Note  that  a 𝜔-dependence  is  included  in Δ𝜀(𝐫, 𝜔) in  Eq. (3)  to 
account for the fact that the expression is also valid for dispersive materials. 

For  resonators  with  Drude,  multi-pole  Drude-Lorentz,  or  multi-pole  Lorentz  permittivities,  a 

classical and well-documented expression is [6] 

𝛼𝑚(𝜔) =   ∭ (𝜀𝑏(𝐫, 𝜔) − 𝜀∞(𝐫)   + Δ𝜀(𝐫, 𝜔̃𝑚) 𝜔̃ 𝑚
𝜔̃ 𝑚−𝜔

𝑉𝑟𝑒𝑠

) 𝐄𝑏 ∙ 𝐄̃𝑚𝑑3𝐫
, 

(4) 

where 𝜀𝑏(𝐫, 𝜔) is the background permittivity and 𝜀∞(𝐫) is the permittivity 𝜀(𝐫, 𝜔 → ∞). Note that for 
non-dispersive materials, Eq. (3) and Eq. (4) are identical. 𝜀𝑏(𝐫, 𝜔) does not necessarily correspond to 
a homogeneous medium. It may correspond to a layered substrate, as illustrated in Fig. 3. Then, the 
background  field  𝐄𝑏  is  composed  of  counterpropagating  plane  waves  that  are  reflected  and 
transmitted  in  the  layers  under  illumination  by  the  incident  field. 𝐄𝑏  can  be  computed  with 2 × 2 
matrix  products  for  isotropic  materials;  this  computation  is  automatically  performed  by  the 
reconstruction toolbox provided that the user defines the background permittivities and the incident 
plane-wave parameters as explained in . 

According  to  our  experience,  the  formulas  of  Eqs.  (3)  and  (4)  provide  similar  convergence 

performance when reconstructing the total field using the methods in Table 3.  

Expressions for 𝛼𝑚′𝑠 also exist for resonators driven by localized sources, such as localized sources 
with an electric dipole 𝐩 or magnetic dipole 𝐦 moments located at a position 𝐫0 in the near field. An 
infinity of expressions may also be derived for dispersive resonators; however, in contrast to the plane 
wave case, the whole literature seems to have adopted the convenient (fully analytical) expression 
[3,11] 

(𝑡)(𝜔) =
𝛼𝑚

𝜔
𝜔̃ 𝑚−𝜔

[𝐩 ∙ 𝐄̃𝑚(𝐫0, 𝜔̃𝑚) − 𝐦 ∙ 𝐁̃𝑚(𝐫0, 𝜔̃𝑚)], 

(5) 

for  the  total  field [𝐄𝑡𝑜𝑡(𝐫, 𝜔), 𝐇𝑡𝑜𝑡(𝐫, 𝜔)] = ∑ 𝛼𝑚
Section 5.2 in [1]. The reconstruction toolbox implements this expression only. 

(𝑡)(𝜔)[𝐄̃𝑚(𝐫), 𝐇̃ 𝑚(𝐫)]

𝑚

,  see  also  the  discussion  in 

4.2.2 Field reconstruction 
To illustrate the possibilities offered by the reconstruction toolbox, consider the representative system 
shown in Fig. 3. The system is composed of five domains corresponding to five different materials. The 
background is composed of three domains, labeled 2, 3, and 4. The resonator is composed of two other 
domains. We assume that only the materials of domains 1 and 4 are dispersive. 

Fig. 3. Illustrative example of a system suited for simulation with the reconstruction toolbox. The 
background is defined by a multilayer structure (domains 2, 3, 4). The resonator is defined by the 
two other domains, 1 and 5. Only the materials of domains 1 and 4 are dispersive. 

The  QNMs  have  different  field  components,  and  each  component  can  be  used  for  the 
reconstruction of the total electric field 𝐄𝑡𝑜𝑡 (see Section 5.4 for details). The reconstruction toolbox 
implements 2×4 different methods (labeled M 1, M 2, M 3, and M 4 in Table 3) to reconstruct 𝐄𝑡𝑜𝑡 for 
illumination by a plane wave. The factor 2 accounts for the fact that two different equations for the 
𝛼𝑚’s can be used for each method. The methods have been selected for their accuracy, simplicity, or 
broad use. 

For all methods, the reconstruction in the non-dispersive domains (2, 3, 5 in the example) is always 

performed with 

[𝐄𝑡𝑜𝑡(𝐫, 𝜔), 𝐇𝑡𝑜𝑡(𝐫, 𝜔)]   = [𝐄𝑏(𝐫, 𝜔), 𝐇𝑏(𝐫, 𝜔)] + ∑ 𝛼𝑚(𝜔)[𝐄̃𝑚(𝐫), 𝐇̃ 𝑚(𝐫)]
, 

𝑚

(6) 

𝛼𝑚(𝜔) being given either Eq. (3) or Eq. (4). The methods differ only for the dispersive domains, 1 and 
4. 

Table  3.  A  summary  of  important  formulas  implemented  in  the  reconstruction  toolbox  for 
reconstructing the total field, 𝐄𝒕𝒐𝒕, in dispersive domains. Four methods (M 1-M 4) are considered, 
and each may rely on two different formulas for the 𝜶𝒎’s.  

𝛼𝑚 
Dispersive 
Dom. nº 

M 1 

M 2 

M 3 

M 4 

Eq. (4) 

Eq. (3) 

1 (resonator) 

4 (background) 

1 (resonator) 

4 (background) 

∑ 𝛼𝑚(𝜔)𝐄̃𝑚 + 𝐄𝑏 

∑ 𝛼𝑚(𝜔)

𝐄̃𝑚 

𝜀(𝜔̃𝑚) − 𝜀∞
𝜀(𝜔) − 𝜀∞
𝜀(𝜔̃𝑚) − 𝜀∞
𝜀(𝜔) − 𝜀∞

𝜔̃𝑚
𝜔

∑ 𝛼𝑚(𝜔)

𝐄̃𝑚 + 𝐄𝑏 

𝜀(𝜔̃𝑚) − 𝜀∞
𝜀(𝜔) − 𝜀∞
𝜀(𝜔̃𝑚) − 𝜀∞
𝜀(𝜔) − 𝜀∞

𝜔̃𝑚
𝜔

∑ 𝛼𝑚(𝜔)

𝐄̃𝑚 

∑ 𝛼𝑚(𝜔)

𝐄̃𝑚 + 𝐄𝑏 

∑ 𝛼𝑚(𝜔)

𝜀(𝜔̃𝑚)
𝜀(𝜔)

𝜔̃𝑚
𝜔

𝐄̃𝑚 +

𝜀𝑏(𝜔)
𝜀(𝜔)

𝐄𝑏 

All the methods asymptotically converge towards the same value if all the eigenvectors are included 
in  the  expansion.  However,  for  small  truncation  ranks,  they  may  provide  significantly  different 
accuracies.  Figure  4  illustrates our  purpose  for  a  simple  plasmonic  system,  a Dolmen composed of 
three Drude silver nanorods embedded in an air background. The response of the Dolmen at optical 

 
 
frequencies  is  dominated  by  four  QNMs  shown  in  Fig.  4(b).  Figure  4(c)  shows  the  reconstruction 
performed with methods M 1-4 and 𝛼𝑚(𝜔) computed with Eq. (4) for a wavelength of 700 nm. They 
are  obtained  for  an  incident  field  polarized  along  the 𝑥 -direction,   𝐄𝑏 = −𝐞𝑥 exp(𝑖𝑘𝑏𝑧),  and  are 
compared with Fig. 4(d) that displays the full-wave frequency simulated result obtained with COMSOL. 
For the reconstruction inside the dolmen, methods M 2-M 4 are more accurate compared to the most 
intuitive  method  M  1.  We  have  also  observed  a  faster  convergence  of  M  2-M  4  for  other 
nanostructures, such as a Si nanocylinder on a low refractive index substrate [9]. We refer the readers 
to Section 5.4 for a possible explanation of the faster convergence of M 2-M 4 when reconstructing 
with a small set of QNMs. 

Fig 4. QNM reconstruction of the real part of the electric field, Re(𝐸𝑥), for a Dolmen-like structure. 
(a) The plasmonic dolmen is made of silver and composed of an upper rod (66 × 26 × 20 nm3) 
separated by a gap of width 𝑔 = 10nm from two lower rods (30 × 100 × 20 nm3) separated by 
30 nm. The silver permittivity of the nanorods is approximated by a single-pole Drude model with 
𝜀∞ =  1, 𝜔𝑝 = 1.366  ×   1016 rad, and 𝛾  =  0.0023𝜔𝑝. The dolmen is embedded in air (𝜀𝑏 = 1). 
(b)  Electric  field  𝑥 -component  Re(𝐸̃𝑥)  in  𝑥𝑦 -plane  of  the  four  dominant  QNMs  used  in  the 
reconstruction. (c) Real part of the scattered electric fields Re(𝐸𝑥) for 𝜆 = 700 nm reconstructed 
with  methods 𝐌 𝟏-𝐌 𝟒.  The  incident  field  is  a  plane  wave  polarized  along  the 𝑥-direction.  (d) 
Re(𝐸𝑥) obtained with fully vectorial numerical computations. The user is encouraged to repeat the 
figure by running QNMToolbox_reconstruction_Dolmen2.m in the TOOLBOXES folder. 

4.2.3 Extinction and scattering cross-sections, Purcell factor 
In the reconstruction and alpha-coefficient toolboxes, the extinction and scattering cross-sections, 𝜎𝐸𝑥𝑡 
and 𝜎𝐴𝑏𝑠, are accurately computed with the following formulas [4] 

𝜎𝐸𝑥𝑡 = −

and  

𝜎𝐴𝑏𝑠 = −

𝜔
2𝐼0

𝜔
2𝐼0

∭ Im[Δ𝜀(𝜔)𝐄𝑡𝑜𝑡 ∙ 𝐄𝑏

∗ ]𝑑𝑉

𝑉𝑟𝑒𝑠

∭ Im[𝜀(𝜔)]|𝐄𝑡𝑜𝑡|2𝑑𝑉

𝑉𝑟𝑒𝑠

, 

, 

(7) 

(8) 

where 𝐼0 is the time averaging Poynting vector of the incident plane wave. The scattering cross section 
is then deduced with the difference 𝜎𝑆𝑐𝑎 = 𝜎𝐸𝑥𝑡 − 𝜎𝐴𝑏𝑠. 

Since multiple methods can be used for the reconstruction of 𝐄𝑡𝑜𝑡, an equal number of expressions 
for 𝜎𝐸𝑥𝑡 and 𝜎𝐴𝑏𝑠 that give different results for truncated expansions are available. The reconstruction 
toolbox implements time-tested expressions in our previous papers [4,6].  

For  dispersive  resonators  and  provided  that  the 𝛼𝑚 ’s  are  computed  with  Eq.  (4),  we  use  the 
formulas  derived  in  Ref.  [6].  The Δ𝜀(𝜔)𝐄𝑡𝑜𝑡  term  in 𝜎𝐸𝑥𝑡,  Eq.  (7),  is  decomposed  into  two  terms: 

 
Δε(𝐫, 𝜔)𝐄𝑡𝑜𝑡 = (𝜀∞ − 𝜀𝑏)𝐄𝑡𝑜𝑡 + (𝜀(𝜔) − 𝜀∞)𝐄𝑡𝑜𝑡. We use M 1 (resp. M 3) in Table 3 to reconstruct 
𝐄𝑡𝑜𝑡 in the first (resp. second) term. For 𝜎𝐴𝑏𝑠, we use M 3 to reconstruct 𝐄𝑡𝑜𝑡. These formulas may 
benefit from the fact that M 3 may offer a faster convergence as compared to M 1 when considering 
a small set of QNMs. For non-dispersive resonators, the 𝛼𝑚’s are obtained with Eq. (3), 𝜎𝐸𝑥𝑡 and 𝜎𝐴𝑏𝑠 
are obtained by reconstructing 𝐄𝑡𝑜𝑡 with method M 1 [4]. 

Table 4 summarizes the formulas for computing 𝜎𝐸𝑥𝑡 and 𝜎𝐴𝑏𝑠 with the reconstruction toolbox.  

Table  4.  A  summary  of  important  formulas  implemented  in  the  reconstruction  toolbox  for 
reconstructing the extinction and absorption cross-sections.  

𝛼𝑚’s computed with Eq. (3)  

𝛼𝑚’s computed with Eq. (4)  

𝜎𝐸𝑥𝑡 

𝜎𝐴𝑏𝑠 

−

𝜔
2𝐼0

∭ Im [Δε(𝜔) (∑ 𝛼𝑚𝐄̃𝑚 + 𝐄𝑏) ∙ 𝐄𝑏

∗ ] 𝑑𝑉

𝑉𝑟𝑒𝑠

−

𝜔
2𝐼0

2
∭ Im[ε(𝜔)] |∑ 𝛼𝑚𝐄̃𝑚 + 𝐄𝑏|

𝑑𝑉

𝑉𝑟𝑒𝑠

  ∭ −Im [∑[[𝜀(𝜔̃𝑚) − 𝜀∞]𝜔̃𝑚 + [𝜀∞ − 𝜀𝑏]𝜔]𝛼𝑚

] 𝑑𝑉

𝑉𝑟𝑒𝑠

−

𝜔
2𝐼0

∭ Im[ε(𝜔)] |∑ 𝛼𝑚

𝑉𝑟𝑒𝑠

𝜀(𝜔̃𝑚) − 𝜀∞
𝜀(𝜔) − 𝜀∞

𝜔̃𝑚
𝜔

𝐄̃𝑚 ∙ 𝐄𝑏
∗
2𝐼0
2
𝐄̃𝑚|

𝑑𝑉

Figures  5(a-b)  show  examples  of  results  obtained  with  the  reconstruction  toolbox  for  a  silver 
nanocube antenna on a gold substrate, separated by an 8 nm thick polymer spacer. The geometrical 
and material parameters are found in Fig 5(a). The antenna is illuminated with a plane wave for an 
incidence  angle 𝜃𝑖 = 55°.  We  adopt  Eq.  (4)  to  compute  the 𝛼𝑚 ’s.  As  the  antenna  materials  are 
dispersive,  the  reconstruction  toolbox  automatically  selects  the  formulas  of  the  second  column  of 
Table 4 to compute 𝜎𝐸𝑥𝑡 and 𝜎𝐴𝑏𝑠. The blue (extinction) and red (absorption) curves are obtained by 
considering two QNMs.. For the sake of comparison, we also show reference data (circles) obtained 
with the frequency-domain solver of COMSOL. The agreement is quantitative over the entire spectrum. 

Fig. 5. Some well-converged examples of reconstruction in the QNM basis for very small 𝑁’s. (a) 
Schematic  representation  of  an  Ag  nanocube  antenna  of  size 𝑎 = 65 nm  deposited  on  a 8-nm-
thick polymer film (refractive index 𝑛 = 1.5) coated on an Au substrate. The incident wave is an 
oblique  TM-polarized  plane  wave.  (b)  Cross-section  spectra  (solid  blue  and  red  curves) 
reconstructed  with  2  QNMs  and  compared  with  reference  ‘exact’  data  (circles)  computed  with 
COMSOL. (c) An Au nanorod (𝐿 = 65 nm, 𝑅 = 15 nm) is embedded in a host medium of refractive 
index 𝑛 = 1.5. (d) Normalized decay-rate spectrum for an on-axis dipole oriented parallel to the 
nanorod (red dot) and located at a distance 𝑑  = 10 nm. The Ag permittivity is found in the caption 
of  Fig. 4.  For  gold,  we  use  a  double  pole  Drude–Lorentz  model  with  𝜀∞ = 6 ,  𝜔𝑝1 = 5.37  ×

 
 
 
 
 
 
 
 1015 rad ,  𝛾1   =  6.22  ×   1013 rad ,  𝜔01 = 0 rad ,  𝜔𝑝2 = 2.26  ×   1015 rad ,  𝜔02 = 4.57 ×
 1015 rad,  and 𝛾2 = 1.33 ×   1015 rad.  The  user  is  encouraged  to  repeat  the  figures  by  running 
QNMToolbox_reconstruction_NPoM_cube.m  and  QNMToolbox_reconstruction_rod_dipole.m  in 
the TOOLBOXES folder. 

    The reconstruction toolbox also incorporates functions that allow to compute the Purcell factor 𝑃𝑚 
and normalized LDOS (𝛾/𝛾0), when a resonator is driven by electric 𝐩 or magnetic 𝐦 dipoles (or a Dirac 
source with both moments) [3,11] 

𝛾
𝛾0

= Σ𝑚𝑃𝑚 = −

2
ℏ𝛾0

∑ Im [𝛼𝑚

𝑚

(𝑡)(𝐩∗ ∙ 𝐄̃𝑚(𝐫0) + 𝐦∗ ∙ 𝐁̃𝑚(𝐫0))]
, 

(9) 

where  the  excitation  coefficient  𝛼𝑚
(3𝜋𝜀0ℏ𝑐3) denotes the vacuum spontaneous decay rate.  

(𝑡)  is  computed  using  Eq. (5)  and  𝛾0 = 𝜔3 [|𝐩|2 + |𝐦|2/𝑐2]/

Figure  5  (c-d)  illustrates  a  simple  problem,  a  gold  nanorod  driven  by  an  electric  dipole  emitter 
oriented parallel to the nanorod axis, for which the Purcell factor is accurately computed  with a single 
QNM in the expansion [4]. Using the classical frequency-domain solver of COMSOL, we first compute 
Im[𝐩∗ ∙ 𝐄𝑡𝑜𝑡(𝐫0)]. We then reconstruct the 
the normalized LDOS according to the definition: 
LDOS  using  Eq. (9).  The  result  reconstructed  by  considering  only  the  longitudinal  electric  dipole 
antenna QNM is shown with the red line. 

2
ℏ𝛾0

= −

𝛾
𝛾0

Figure 5 provide two examples for which the optical response can be accurately reconstructed with 
a  very  few  number  of  QNMs.  In  practice,  there  also  exist  systems,  e.g.  resonators  on  substrates 
supporting guiding modes, dipole emittors placed very close to metal surfaces and quenched, and low 
Q  resonators,  where  a  large  set  of  QNMs  have  to  be  incorporated  to  achieve  an  accurate 
reconstruction [6]. However, we do not recommend the user to compute a large number of QNMs, as 
it is time consuming. Rather we recommend to compute the few QNMs that capture the main resonant 
feature of  the  spectrum,  and  use  the  interpolation  toolbox  (see  Section  4.9)  to  obtain  an  accurate 
reconstruction with a small amount of computational loads. 

4.3 Reconstruction in the temporal domain 
The  study  of  the  dynamics  of  optical  nanoresonators  under  irradiance  by  a  pulsed  beam  is 
indispensable for analyzing ultrafast optical phenomena and nonlinear light-matter interactions [20]. 
To obtain insights into the physics of the temporal responses, the analysis is best performed in the 
QNM basis, see Fig. 6. 

The  temporal-domain  toolbox  takes  advantage  of  the 𝜔 −analyticity  of  the  frequency-domain 
expansion of Eq. (2) to effectively compute the temporal responses of optical nanoresonators in the 
QNM basis by applying a temporal (𝜔 ↔ 𝑡) Fourier transformation (FT) 

[𝐄𝑆(𝐫, 𝑡), 𝐇𝑆(𝐫, 𝑡)] = Re(∑ 𝛽𝑚(𝑡)[𝐄̃𝑚(𝐫), 𝐇̃ 𝑚(𝐫)]

𝑚

), 

with 𝛽𝑚(𝑡) the time-dependent modal excitation coefficient given by 

𝛽𝑚(𝑡) = FT[𝛼𝑚(𝜔)]. 

(10) 

 (11) 

In the toolbox, by default, the temporal intensity profile of the incident wave has a Gaussian shape, 
and the spatial profile is a plane wave. The parameters of the pulsed light, including central frequency, 
pulse  duration,  propagation  direction  and  polarization,  are  set  by  the  user.  Two  different 𝛽𝑚′𝑠 are 
computed from Eqs. (3) [5] and (4) [6].  

For resonators that can be modeled with a few QNMs, the temporal QNM reconstruction can be 
extremely  advantageous  in  terms  of  computational  loads.  Indeed,  once  the  QNMs  are  known,  the 
incident pulse duration, polarization or incidence angle can be changed at will since the reconstruction 
just relies on a 1D Fourier transform, which can be evaluated in a few seconds. In contrast, with the 
FDTD, any new instance of the driving field requires a new computation. Additionally, the knowledge 

of the individual contribution of each QNM in the temporal responses significantly helps in interpreting 
the physics. These two decisive advantages are illustrated in Fig. 6 for a dolmen-type nanoresonator 
composed of three gold nanorods. The literature on temporal QNM reconstruction in nanophotonics 
is scarce; an advanced example of reconstruction with an analysis of the kind of shape that can be 
obtained for 𝛽𝑚(𝑡) can be found in [6]. 

Fig. 6. Analysis of the temporal response of nanoresonators with QNM expansions. A dolmen-type 
nanoresonator is illuminated by a 10 fs plane-wave Gaussian pulse with a central frequency 𝜔0 =
2.9 × 1015 rad/s. Its near-field response at point 𝐴, as predicted with the FDTD (red), is faithfully 
reconstructed and explained as resulting from the beating of three dominant QNMs. The dolmen 
example and the comparison between the FDTD data and the 3-QNM reconstruction are further 
analyzed in Ref. [5]. 

4.4 QNM far-field radiation 
The QNMEig and QNMPole  solvers  compute the near-field pattern of normalized QNMs. For many 
applications, it is also interesting to know the QNM contribution to the far-field radiation.  

The  far-field  is  easily  computed  by  applying  a  near-to-far-field  transformation  (NFFT),  which 

computes radiation diagrams. We may symbolically write  

 NFFT𝜔[𝐄𝑆(𝐫, 𝜔), 𝐇𝑆(𝐫, 𝜔)] = ∑ 𝛼𝑚(𝜔) NFFT𝜔[𝐄̃𝑚(𝐫), 𝐇̃ 𝑚(𝐫)]
. 
𝑚

(12) 

As shown in Fig. 4d in [6], the reconstruction of the field scattered in the far-field with Eq. (12) is 
very accurate. Theoretically, the near-to-far-field transform depends on the frequency of interest 𝜔, 
and  this  is  the  reason  why  we  add  a  subscript 𝜔 to NFFT in  Eq. (12).  This  implies  that  one  should 
perform a new near-to-far-field transform to know the far-field radiation at each new frequency, say 
𝜔′ ≠ 𝜔.  This may be demanding in computational ressources. 

To reduce the number of computations, the toolbox performs the near-to-far-field transform for 

each QNM at its own frequency Re(𝜔̃𝑚); the far field then reads as 
NFFT𝜔[𝐄𝑆(𝐫, 𝜔), 𝐇𝑆(𝐫, 𝜔)] ≈ ∑ 𝛼𝑚(𝜔) NFFTRe(𝜔̃ 𝑚)[𝐄̃𝑚(𝐫), 𝐇̃ 𝑚(𝐫)]
,  
and NFFTRe(𝜔̃ 𝑚)[𝐄̃𝑚(𝐫), 𝐇̃ 𝑚(𝐫)] becomes a quantity that is intrinsic to the QNM and that is computed 
once  and  for  all.  Equation (13)  is  approximate;  it  is  accurate  only  if  the  QNMs  with  a  resonance 
frequency 𝜔̃𝑚 ≈ 𝜔 are considered in the expansion. 

(13) 

𝑚

The build-in near-to-far-field transform of COMSOL Multiphysics is valid only for objects surrounded 
by uniform media (free space). Thus, we recommend that the user downloads [21] and installs the 

 
freeware RETOP [16] before using the toolbox. RETOP operates for objects on substrates or buried in 
stratified  media  and  computes  the  radiation  diagram  in  the  superstrate  and  substrate.  When  the 
substrate  supports  guided  modes  or  surface  plasmon  modes,  RETOP  additionally  computes  the  in-
plane radiation diagram of the guided modes. 

The knowledge of the far-field radiated by a QNM is useful in practice. For instance, when an excited 
molecule  dominantly  decays  into  a  bright  QNM,  an  important  question  that  arises  is  how  the 
nanoresonator redirects the emitted light in the  far-field or which numerical aperture is needed to 
collect most  of the  radiated light.  This  is central to  access QNM  brightness  [11]  and even optimize 
nanoresonator geometries to enhance the brightness through inverse design. 

Note  that  the  approximation  made  by  computing  the  near-to-far-field  transform  at Re(𝜔̃𝑚) in 

Eq. (13) can be removed [22]. 

4.5 Multipole expansion 
Interference between multipole moments of photonic or plasmonic nanoresonators is known to lead 
to many exotic phenomena, like zero forward or backward scattering, non-radiating anapole responses, 
and Fano resonances [23,24]. A standard approach to analyze the multipolar response of a resonator 
consists in expanding the scattered field upon a specific excitation into spherical harmonics [25]. The 
multipole analysis is thus performed for a particular instance of the driving field (wavelength, incident 
direction, and polarization) it is not intrinsic to the resonator and does not give any insight into the 
resonator properties at other wavelengths. 

In contrast, the multipole toolbox analyzes the multipolar content of QNMs at complex frequencies. 
It  provides  transparent  physics  since  the  multipolar  content  becomes  an  intrinsic  property  of  the 
resonance,  irrespectively  of  the  illumination  condition.  This  markedly  changes  design  perspectives 
toward operation over a broad range of frequencies or incidence angles or both [8].  

The multipolar decomposition at complex frequencies implemented in the toolbox is analogous to 
the  decomposition  performed  at  real  frequencies  [25].  When  the  resonator  is  immersed  in  a 
homogenous medium with a refractive index 𝑛𝑏, the multipolar content of a QNM is determined by 
expanding its electric field 𝐄̃  in vector spherical wave functions (VSWFs) [8] 

𝐄̃(𝐫) = 𝑘̃ 2 ∑

∞
𝑛=1

𝑛
∑
𝑚=−𝑛

𝐸𝑛𝑚 

[𝑎̃𝑛𝑚𝐍̃𝑛𝑚

(3) (𝐫, 𝜔̃) + 𝑏̃𝑛𝑚𝐌̃ 𝑛𝑚

(3) (𝐫, 𝜔̃)]
, 

(14) 

(3) (𝐫, 𝜔̃) are 
where  𝑎̃𝑛𝑚 and 𝑏̃𝑛𝑚 are electric and magnetic multipole coefficients, 𝐍̃𝑛𝑚
the  outgoing  VSWFs  and  𝑘̃ = 𝜔̃/𝑐  is  the  complex  wavevector  of  QNM.  The  Multipole  toolbox 
computes the coefficients 𝑎̃𝑛𝑚 and 𝑏̃𝑛𝑚 by performing an inner product between the QNM field and 
the vector spherical wave functions (VSWFs) on a sphere surface circumscribing the resonator (see Fig. 
7(a)). The Cartesian multipole moments of the QNM, electric dipole 𝐩̃, magnetic dipole 𝐦̃ , and electric 
quadrupole 𝐐̃ 𝑒, can then be retrieved by matching their far-field expressions with those of the VSWFs 
in spherical coordinates [8,23]. The relation between the Cartesian multipole moments and the VSWF 
coefficients can be found in Ref. [8]. 

(3) (𝐫, 𝜔̃) and 𝐌̃ 𝑛𝑚

Figure 7(b) shows the example proposed in the toolbox, which may be reproduced by running the 
MATLAB script main_field_multipole.m. The Dolmen (same structure as Fig. 4) is designed so that 𝑝̃𝑥 
and 𝑚̃ 𝑧/𝑐 dominantly respond, have similar amplitudes, and are out of phase by approximately 90° 
(blue and red represent the real and imaginary parts) to implement a Janus response [8]. 

Fig. 7. (a) The multipole toolbox computes the coefficients  𝑎̃𝑛𝑚 and 𝑏̃
𝑛𝑚 by performing an inner 
product between the QNM field and the vector spherical wave functions (VSWFs).  (b) Multipole 
content of a Dolmen QNM provided by the multipole toolbox. The QNM is composed of electric 
and magnetic dipole moments, 𝑝̃𝑥 and 𝑚̃ 𝑧, which have similar amplitudes and are out of phase by 
 90° (Janus particle). The electric quadrupole component, 𝑄̃𝑥𝑦, is real and three time smaller. 

4.6 Non-reciprocal materials 
Non-reciprocal  materials  are  usually  found  in  magneto-optical  materials  biased  by  an  external 
magnetic field. They are characterized by non-symmetric permeability or permittivity tensors, 𝛍 ≠ 𝛍T 
or 𝛆 ≠ 𝛆T.  The  orthonormalization  of  QNMs  deserves  specific  attention  [2,11,12,26]  in  this  case.  It 
(𝐿), which can be found by solving the eigenvectors of the source-
requires computing a left QNM, 𝐄̃𝑚
free  Maxwell  operator  with  transposed  permittivity  and  permeability,  𝛆T  and  𝛍T .  Note  that,  for 
(𝑅)  and 
(𝐿)]  and  right  [𝐄̃𝑚
nonreciprocal  systems,  the  left  [𝐄̃𝑚
𝑛
(𝑅) (the right QNMs are the eigenvectors discussed in all other sections obtained for 𝛆 and 𝛍 
(𝐿) ≠ 𝐄̃
𝐄̃
𝑛
𝑛
tensors). However, the left and right QNMs share the same eigenvalues, 𝜔̃𝑛

(𝑅)]  QNMs  differ:    𝐇̃

(𝐿) ≡ 𝜔̃𝑛.  

(𝑅) = 𝜔̃𝑛

(𝐿) ≠ 𝐇̃
𝑛

(𝑅), 𝐇̃ 𝑚

(𝐿), 𝐇̃ 𝑚

The expression of the QNM norm 𝑄𝑁𝑛 for non-reciprocal systems is [2,11,12] 

𝑄𝑁𝑛 = ∭

Ω∪ΩPML

(𝐿) ∙
𝐄̃𝑛

𝜕(𝜔𝛆)
𝜕𝜔

 𝐄̃𝑛

(𝑅) − 𝐇̃ 𝑛

(𝐿) ∙

𝜕(𝜔𝛍)
𝜕𝜔

(𝑅)𝑑𝑉

𝐇̃ 𝑛

, 

(15) 

where the integral is performed in the PML layer ΩPML and the physical space Ω. Similarly, the mode 
volume reads as 

𝑉̃𝑛(𝐫, 𝐮) = [2𝜀0 (𝐄̃𝑛

(𝐿) ∙ 𝐮) (𝐄̃𝑛

(𝑅) ∙ 𝐮) /𝑄𝑁𝑛]

−1

, 

(16) 

𝐮 being the unit vector defining the polarization direction. For a derivation of these formulas and the 
related  orthogonality  condition,  the  reader  may  refer  to  Ref. [2]  and  the  documentation  of  the 
nonreciprocal_resonators toolbox [12]. The latter presents a COMSOL model of a didactical example 
for computing and normalizing the non-reciprocal QNMs of a 2D yttrium-iron garnet wire in air. In this 
(𝑅) largely  differs,  see  Fig.  8  of  [2].  Therefore,  to  compute 𝑄𝑁𝑛 or 𝑉̃𝑛(𝐫, 𝐮),  the 
(𝐿) and 𝐄̃𝑛
example, 𝐄̃𝑛
eigensolver should be called twice. 

4.7 Nonlinear nanophononics 
The nonlinear toolbox illustrates a generic example of how to perform a QNM analysis of a second-
harmonic  generation  with  localized  resonances  in  the  small-signal  regime.  It  promotes  important 
nonlinear concepts such as mode overlap, field enhancement,  and phase matching between 𝜔 and 
2𝜔 signals. 

With  the  small-signal  approximation,  the  pump  depletion  can  be  neglected,  and  the  second-
harmonic generation is described via two coherent processes. Under excitation by an external pump 
beam 𝐄𝑏(𝐫, 𝜔),  a total  field  distribution 𝐄𝑡𝑜𝑡(𝐫, 𝜔) is  generated  at  the fundamental  frequency 𝜔.  It 

 
further induces a local nonlinear current inside the resonator, 𝐉(2)(𝐫, 2𝜔), which acts as the source for 
the second-harmonic radiation at 2𝜔. 

In the nonlinear toolbox, the total field 𝐄𝑡𝑜𝑡(𝐫, 𝜔) is expanded using Eq. (4) and M 2 in Table 3. The 
nonlinear  displacement  current,  𝐉(2)(𝐫, 2𝜔) ,  is  then  derived  from  the  second-order  nonlinear 
(2)(𝐫, 2𝜔) generated at 2𝜔 is reconstructed in the QNM basis 
susceptibility 𝜒(2) and the total field 𝐄𝑡𝑜𝑡
(2)(2𝜔)  are 
(2)(𝐫, 2𝜔) = ∑ 𝛼𝑚
𝐄𝑡𝑜𝑡
computed by performing overlap integrals between the QNMs and the nonlinear current 𝐉(2)(𝐫, 2𝜔). 
(2)(2𝜔), a classical 
Finally, from the knowledge of 𝐄𝑡𝑜𝑡
figure  of  merit  defined  as  the  ratio  between  the  generated  power  at 2𝜔 and  the  intensity  of  the 
incident field, is derived. 

(2)(𝐫, 2𝜔), the nonlinear extinction cross-section 𝜎𝑒𝑥𝑡

(𝐫) .  The  analytically  known  modal  coefficients  𝛼𝑚

(2)(2𝜔)𝐄̃𝑚

𝑚

In the nonlinear toolbox, the second-harmonic generation is presented for an AlGaAs nanocylinder 
on a glass substrate [9]. The generic example may help the reader to implement other geometries or 
nonlinear processes.  

4.8 Grating analysis and band diagram of crystal 
Grating  spectra  exhibit  sharp  variations  of  the  scattered  light,  known  as  grating  anomalies  or 
resonances,  which  are  used  in  many  applications.  Using  the  example  of  a  1D  periodic  grating 
illuminated by a plane wave at oblique incidence, the grating toolbox illustrates how to compute and 
normalize the QNMs of periodic structures, to reconstruct the scattered field in the QNM basis. 

In many works [15,27,28], the QNMs are defined for a fixed in-plane (parallel to the 𝑥-direction in 
Fig. 8) Bloch-wavevector 𝒌𝑝. 𝒌𝑝-QNMs are relevant for computing band diagrams but are irrelevant 
for analyzing grating spectra [7]. 

What sets the specificity of the grating toolbox is that it considers resonances that are effectively 
revealed by any experimental grating spectra measured for fixed incident angles. The resonances are 
QNMs  obtained  for  a  fixed  angle  of  incidence  (𝜼-QNMs),  i.e.  a  fixed  “directionality”  vector 𝜼 =
𝑛𝑖𝑛𝑐sin  𝜃𝒙̂ .  𝜼 is a real vector that depends on the incident angle 𝜃 and the refractive index 𝑛𝑖𝑛𝑐 of 
the incident medium, but not on the frequency 𝜔. 𝒌𝑝- and 𝜼-QNMs are intrinsically different and have 
distinct normalizations [7]. Similarly, in a sensing experiment, the shift in resonance frequency is due 
to  a  perturbation  of  𝜼 -QNMs,  not  𝒌𝑝 -QNMs,  except  if,  unlikely,  one  records  the  spectra  by 
simultaneously tuning the angle of incidence for every frequency of measurement. 

The normalization of a 𝜼-QNM requires computing two QNMs: one with a “directionality” vector 𝜼 
and another one with another “directionality” vector −𝜼, see Fig. 8. The −𝜼-QNM should be computed 
numerically, except if the grating has a mirror symmetry with respect to the vertical axis 𝑦, in which 
case, it can be deduced analytically from the 𝜼-QNM. 

Figure 8 illustrates one of the few reconstructions available in the literature with 𝜼-QNMs [7]. 

Fig. 8. grating toolbox. (a) The normalization of 𝜼-QNMs with a fixed “directionality” vector 𝜼 relies 
on  two  reciprocal  QNMs  with  “directionality”  vectors  𝜼  and  −𝜼 .  (b)  Reconstruction  of  the 
reflectance  spectrum  of  a  gold  lamellar  grating  illuminated  by  a  TM-polarized  plane  wave  (𝜃 =
30°).  The  reconstructed  spectrum  obtained  with  200  modes  is  compared  with  reference  data 
obtained  with  the  RCWA  [28].  The  upper  inset  shows  the  magnetic-field  moduli  of  the  seven 
dominant QNMs, labeled A, B, … G. More details are found in the documentation and in [19]. 

4.9 Effective reconstruction with interpolation 
Accurate reconstructions often require considering a large set of QNMs in the expansion in addition to 
the  dominant  QNMs  of  physical  significance.  For  instance,  it  is  systematically  the  case  when  the 
background is not uniform, since branch cuts, modeled as many individual poles, may then significantly 
contribute  to  the  reconstruction  [2,6].  The  computation  of  all  these  poles  (often  referred  to  as 
numerical modes [2] or ‘PML modes’ [15]) is usually time-consuming and significantly dilutes the force 
of the modal approach.  

The interpolation toolbox implements a simple approach to get around the necessity to consider 
the  numerical  modes.  It  relies  on  the  ansatz  that  the  numerical  modes  gently  contribute  to  the 
reconstruction in the spectral range of interest: either their quality factors are extremely small (< 1) 
or their frequencies lie outside the spectral window of interest. The interpolation toolbox illustrates 
how  to  efficiently  interpolate  the  smooth  contribution  with  only  a  few  ( < 10 )  real  frequency 
simulations, to reconstruct the scattered field as a combination of two contributions, that of the few 
dominant QNMs and that interpolated.  

In  this way,  the  physics  of  the  resonator  is made  transparent  and  a  fast  computation  with  high 
accuracy is achieved; in general, the computation is much faster than those required with purely real 
frequency or temporal analysis [10].  

5. Theoretical and numerical issues 

5.1 The QNMPole and QNMEig solvers 
QNMPole  solver.  QNMPole  computes  and  normalizes  the  QNMs  by  an  iterative  procedure  that 
computes poles following a Padé approximation [4]. The field 𝐄𝑆(𝐫, 𝜔) scattered by a resonator under 
excitation by a monochromatic field at frequency 𝜔 can be expanded as a superposition of its QNMs 
and numerical modes, see Eq. (2), and the excitation coefficient 𝛼𝑚(𝜔) is proportional to (𝜔 − 𝜔̃𝑚)−1 
for first-order poles. This implies that the poles are the same for all 𝐫.  

 
The iterative procedure focuses on one of the scattered field components, e.g. the 𝑧-component 
𝐸𝑆𝑧(𝐫0), at a fixed position 𝐫0. It starts by considering three guessed frequencies, 𝜔1, 𝜔2 and 𝜔3, that 
are provided by the user and are slightly different from the searched pole and computes the three 
associated  fields, 𝐸𝑆𝑧(𝜔1), 𝐸𝑆𝑧(𝜔2), 𝐸𝑆𝑧(𝜔3).  From  this  initial  step,  a  new  frequency, 𝜔4 = 𝑓( 𝜔1,
𝜔2, 𝜔3, 𝐸𝑆𝑧(𝜔1), 𝐸𝑆𝑧(𝜔2), 𝐸𝑆𝑧(𝜔3)), is automatically generated using the Padé approximation and the 
field 𝐸𝑆𝑧(𝜔4) at frequency 𝜔4 is computed. The function 𝑓 is given by Eq. (20) in Ref. [4]. The iterative 
procedure  then  starts.    𝑓(𝜔2, 𝜔3, 𝜔4, 𝐸𝑆𝑧(𝜔2), 𝐸𝑆𝑧(𝜔3), 𝐸𝑆𝑧(𝜔4))  is  used  to  compute  𝜔5 .  As  the 
iteration number increases, 𝐸𝑧(𝜔𝑛) diverges and 𝜔𝑛 rapidly tends toward the eigenfrequency 𝜔̃. The 
convergence is usually achieved in about 5 iteration steps, see Fig. 9, provided that the initial values 
𝜔1, 𝜔2 and 𝜔3 are close enough from the pole. 

Thus,  QNMPole  requires  a  frequency-domain  solver  that  solves  Maxwell  equations  at  complex 
frequencies. Commercial softwares, e.g. the COMSOL RF Module, are retained to real frequencies in 
general.  The  documentation  userguide_QNMPole_V7.pdf  explains  how  to  easily  modify  the 
permittivities and permeabilities of the system to trick the solver by artificially implementing complex 
frequencies with real ones. 

Fig.  9.  Typical  convergence  observed  with  the  QNMPole.  The  three  guessed  frequencies  are 
labeled with blue circles. Further iterations are represented with pink circles. Left inset: Inverse of 
the scattered field computed at every iteration at the evaluation point; the inverse value should 
decrease by several orders of magnitude to guarantee convergence as one approaches the pole 𝜔̃. 
(right):  Convergence  of Re(𝜔𝑛 ) and Im(𝜔𝑛 ) as  one  approaches  the  pole.  A  plateau  is  already 
observed for the first iteration. 

QNMEig  solver.  QNMEig  extends  the  existing  possibilities  of  the eigenmode  solver  of  the  COMSOL 
Multiphysics RF Module. It solves a quadratic eigenvalue problem of Maxwell’s equations and handles 
materials with  a  Lorentz-Drude  or 𝑁-pole  Lorentz  dispersions  (see  Table 1)  using  the  auxiliary-field 
method [6,29-31]. These dispersions encompass many cases of interest in nanophotonics. Other types 
of dispersion can be implemented by the user following the linearization procedure implemented in 
QNMEig. For illustrating the procedure [6], let us consider the case of a material with a Lorentz-Drude 

dispersion 𝜀(𝜔)/𝜀∞ = 1 − ∑

𝑁
𝑖=1

2
𝜔𝑝,𝑖
2 −𝑖𝜔𝛾𝑖
𝜔2−𝜔0,𝑖

as 

𝐊̂𝒖 + 𝜔̃𝐂̂𝒖 + 𝜔̃2𝐌̂ 𝒖 = 𝟎. 

 . The quadratic eigenvalue formulation of the QNM reads 

(17)                 

Equation (17) formally corresponds to the Lorentz oscillator model. In the terminology of the finite-
element method, 𝐊̂, 𝐂̂ and 𝐌̂  are the so-called stiffness, damping, and mass matrices, respectively 

 
 
∇ × 𝜇0

−1∇ ×
2

𝜀∞𝜔𝑝,1
2
𝜀𝜔𝑝,2
⋮

𝐊̂ =

[

0
2
−𝜔0,1
0
⋮

0
0
2
−𝜔0,2
⋮

…
…

…
⋱]

, 

𝐂̂ = [

0

0
0 −𝑖𝛾1
0
⋮

0
⋮

0
0

…
…
−𝑖𝛾2 …
⋱

⋮

], 

𝐌̂ = [

−𝜀∞ −1 −1 …
0 …
1
1 …
0
⋱
⋮
⋮

0
0
⋮

]. 

In Eq. (17), 𝒖 is the augmented field vector, 

(18) 

(19) 

(20)                                                                                                                      

𝒖 = [𝐄̃ 𝐏̃𝟏 𝐏̃𝟐 …],  
which  includes  the  electric  field  𝐄̃  and  the  introduced  auxiliary  polarization  fields  𝐏̃𝑖  ( 𝐏̃𝑖 ≡
−𝜀∞

𝐄̃). 

(21) 

2
𝜔𝑝,𝑖
2 −𝑖𝜔̃ 𝛾𝑖
𝜔̃ 2−𝜔0,𝑖

The validity of Eq. (17) can be checked by replacing  𝐏̃𝑖 with its definition in terms of 𝐄̃ to obtain the 
Helmholtz equation. Equation (17) is fully compatible with the COMSOL eigenmode solver that solves 
quadratic  eigenproblems  with  a  remarkable  efficiency  through  the  so-called  first  companion 
linearization 
[𝐊̂ 𝐂̂
𝟎 𝟏

] + 𝜔̃ [ 𝟎 𝐌̂
𝒖
𝒗
−𝟏 𝟎

] = 0, 

(22) 

𝒖
𝒗

] [

] [

by introducing 𝒗 ≡ 𝜔̃𝒖.                                                           

The implementation in COMSOL Multiphysics starts by reformulating Eq. (17) into an integral form 
called the weak formulation. In a weak formulation, as suggested by its name, differential equations 
are no longer satisfied exactly at every point of the mesh. Instead, they are satisfied in a “weak” sense 
by considering an overlap integral that involves the multiplication of the equation by certain test (basis) 
functions. One unique advantage of the weak formulation is that the order of a differential equation 
can be reduced by using the method of integration by parts to improve numerical stability. Consider 
Eq. (17) and taking its first-line second-order partial differential equation as an example, we obtain  

∇ × 𝜇0

−1∇ × 𝐄̃ − 𝜔̃2𝜀∞𝐄̃ − 𝜔̃2𝐏̃ = 0.                                                                                                              (23) 

The weak formulation of Eq. (23) is derived by introducing a test function denoted by  𝐄̃test and 

evaluating the following overlap integral in the simulation domain 𝛀,  

 ∫ 𝐄̃test(𝐫) ⋅ ∇ × 𝜇0
Ω

−1∇ × 𝐄̃(𝐫) − 𝜔̃2𝜀∞ 𝐄̃test(𝐫) ⋅ 𝐄̃(𝐫) − 𝜔̃2 𝐄̃test(𝐫) ⋅ 𝐏̃(𝐫)

𝑑3𝒓 = 0.                        (24) 

The  second-order  derivation  in  Eq. (23)  is  then  reduced  to  the  first  order  by  the  technique  of 
integration by parts, 

 ∫ ∇ × 𝐄̃test(𝐫) ⋅ 𝜇0
Ω

−1∇ × 𝐄̃(𝐫) − 𝜔̃2𝜀∞ 𝐄̃test(𝐫) ⋅ 𝐄̃(𝐫) − 𝜔̃2 𝐄̃test(𝐫) ⋅ 𝐏̃(𝐫)

𝑑3𝒓 = 0.                      (25) 

Here the boundary condition that the electric fields vanish on the outer boundaries of the simulation 
domain is used. The tutorials of QNMEig provide a step-by-step presentation of how to implement the 
weak formulation using the COMSOL syntax. 

 
 
 
 
 
 
 
 
5.2 QNM normalization 
Normalization enables a direct assessment of the QNM excitation strength 𝛼𝑚 used for reconstruction 
[3]. It is also directly related to one of the main figures of merit of QNM, the field enhancement or the 
mode  volume    𝑉̃ ,  which  quantify  the  interaction  strength  of  the  mode  with  point-like  dipoles 
(molecules):  𝑉̃ ∝ 𝐄̃ −2  (or  𝐇̃ −2 )  for  dipolar  electric  (or  magnetic)  interactions,  𝐄̃  and  𝐇̃  being  the 
normalized fields. QNM normalization thus represents an essential step in QNM theory. 

The  literature  on  QNM  normalization,  including  milestone  publications,  is  quite  confusing, 
sometimes misleading, and not free of mistakes. We refer the reader to Section 4 of the recent review 
[2],  in  which  the  normalization  issue  has  been  put  into  historical  perspective  and  a  thorough 
comparison of all the existing methods has enabled to highlight mistakes and fully clarify the domain 
of validity. For newcomers, let us mention that the normalization of QNMs (i.e. of open non-Hermitian 
systems) differs from the classical energy-based norm used for normalizing the normal modes of closed 
non-Hermitian systems, but no more complicated to implement. 

Two markedly different normalization methods are used in MAN. Albeit very different in form, they 
are theoretically equivalent [2,4] and, they are both very easy to implement numerically; they lead to 
quasi-identical  (if  the  same  mesh  is  used  for  their  computation,  >11  common  digits  are  obtained) 
numerical values, see Fig. 6 in Ref. [2]. 

𝐄̃𝑚 ∙

Ω∪Ω𝑃𝑀𝐿

𝜕𝜔𝛆
𝜕𝜔

 𝐄̃𝑚 − 𝐇̃ 𝑚 ∙

The  QNMEig  solver uses the  so-called PML-norm [3].  As the name of the method suggests, this 
norm  requires  that  perfectly  matched  layers  (PMLs)  be  used  to  truncate  the  physical  domain  and 
satisfy the outgoing wave condition at the boundary of the computational domain. In practice, the 
 𝐇̃ 𝑚
norm  𝑄𝑁 = ∭
𝑑𝑉 is easily computed as a volume integral over 
the entire computational domain composed of the PML domain Ω𝑃𝑀𝐿 and the inner physical domain 
Ω surrounded by the PML. Note that in COMSOL, a complex coordinate stretching is performed inside 
the PML layer. The PML domain Ω𝑃𝑀𝐿, therefore denotes a volume in complex space. In practice, when 
evaluating  the  volume  integral  with  real  coordinates,  one  needs  to  multiply  by  a  Jacobian  to 
 with ‖J̅‖ the Jacobian, 

accommodate for the change of coordinates : ∭ … 𝑑𝑉
and 𝑉𝑃𝑀𝐿 the volume of the PML layer mapped onto the real coordinates.  

= ∭ … ‖J̅‖𝑑𝑉

𝜕𝜔𝛍
𝜕𝜔

Ω𝑃𝑀𝐿

𝑉𝑃𝑀𝐿

The normalization adopted by the QNMPole solver does not rely on the calculation of any volume 
integrals and does not require PMLs. It has been introduced in Ref. [4] and is referred to as the pole-
response norm in the literature [2]. It relies on the fact that, for complex frequencies 𝜔 sufficiently 
close to the QNM eigenfrequency 𝜔̃𝑚, the scattered field is proportional to the normalized QNM field 
(𝜔 −
with 
𝜔̃𝑚)𝛼𝑚(𝜔̃𝑚)𝐄̃𝑚(𝐫). As mentioned earlier, there is an infinity of expressions for 𝛼𝑚(𝜔̃𝑚); however, 
they  all  tend  towards  the  same  asymptotic  expression  𝛼𝑚(𝜔̃𝑚)  as  𝜔 → 𝜔̃𝑚  and  thus  the 
normalization is unique.  

(𝜔 − 𝜔̃𝑚)𝐄𝑠(𝐫, 𝜔) = lim𝜔→𝜔̃ 𝑚

lim𝜔→𝜔̃ 𝑚

coefficient: 

excitation 

known 

a 

The  pole-response  method  is  the  most  general  method  for  QNM  normalization:  it  can  be 
implemented  with  any  frequency-domain  Maxwell  solvers  and  can  be  used  for  any  geometries, 
including those that cannot accommodate PML boundary conditions, such as photonic-crystal cavities 
that leak into semi-infinite periodic waveguides [32]. 

At last, let us emphasize that the basic QNMEig and QNMPole solvers implemented in MAN are 
dedicated to reciprocal materials for which the right and left QNMs (the left eigenvectors are solutions 
of  the  source-free  transposed  Maxwell  operator,  see  Appendix  C  in  [2])  are  identical.  For  periodic 
structures (see Section 4.8) or resonators with non-reciprocal materials (see Section 4.6), the right and 
left  eigenvectors  are  different,  and  the  normalization  thus  requires  performing  two  independent 
computations, one for the right QNMs and the other for the left ones. The nonreciprocal and grating 
toolboxes are dedicated to these two special cases. 

5.3 Completeness of QNM expansion 
Completeness  refers  to  the  possibility  of  rigorously  reconstructing  the  field  [𝐄𝑆(𝐫, 𝜔), 𝐇𝑆(𝐫, 𝜔)] 
scattered by the resonator in the QNM basis, at least for 𝐫 belonging to a compact subspace of ℝ𝟑[33-
35]. We refer the reader to a recent review [2]. 

Disappointingly, completeness of expansions involving only true QNMs is rarely met. It is generally 
admitted that these expansions are complete only inside the resonators (𝐫 ∈ 𝑉𝑟𝑒𝑠) and for resonators 
in free space (without substrate), owing to the existence of branch cuts for geometries with a substrate. 
As explained in [2], there might be hope for future theoretical improvements, but so far, the literature 
suggests only two possibilities to move towards realistic cases with resonators deposited on substrates, 
embedded in thin films, or coupled to waveguides. 

The  first  possibility  relies  on  complementing  a  restricted  finite  subset  of  QNMs  with  another 
contribution that might be called a non-resonant contribution. Two approaches to compute the non-
resonant contribution are available.  The  first  approach, the so-called Riesz projection method [36], 
relies  on  computing  the  non-resonant  contribution  using  a  finite-length  contour  in  the  complex 
frequency  plane.  Alternatively,  the  non-resonant  contribution  may  also  be  computed  by  directly 
solving Maxwell equations at a few real frequencies, and since it is expected to gently vary with the 
frequency, it can be easily interpolated [10]. This second approach is implemented in the interpolation 
toolbox described in Section 4.9. 

The  second  possibility,  which  can  be  implemented  with  the  QNMEig  solver  approach  and  the 
reconstruction toolbox, relies on a regularization procedure, initially launched in quantum mechanics, 
which  transforms  the  open  space  into  a  regularized  Hilbert  space  using  a  complex  coordinate 
transform implemented with perfectly-matched layers [2,3,6,7,15,19]. The spectrum of the regularized 
operator incorporates true QNMs and numerical modes, which obey the same orthogonality product 
and,  together,  admittedly  form  a  complete  basis  of  the  regularized  (‘PMLized’)  Hilbert  space  that 
features square-integrable vectors. A more in-depth discussion can be found in Section 3.4.3 in [2]. 

State-of-the-art reconstructions of the scattered field by increasing the total number of QNMs and 
numerical  modes  retained  in  the  expansion  have  been  obtained  with  the  QNMEig  solver  [6].  The 
results  are  quite  convincing  since  convergence  is  numerically  achieved  over  a  broad  range  of 
frequencies  for  complicated  geometries:  resonators  with  dispersive  materials,  resonators  lying  on 
dielectric  substrates  with  guiding  layers  (with  branch  cuts),  nanoresonators  on  metallic  substrates 
(with branch cuts and accumulation points). In [19], the authors consider simpler geometries, namely 
2D cylinders and spheres in free space. They have numerically verified that expansions with QNMs and 
numerical modes  are  complete  both  inside  and outside  the  resonator. They have also verified that 
expansions based on QNMs only are incomplete everywhere, even inside the resonator, owing to the 
branch-cut of the Green function in 2D, see Fig. 2 in [19] for more details. The convergence has also 
been numerically demonstrated in the temporal domain [6]. Another example of converged results is 
found in Fig. 11 in [7], in which a metal grating with many branch cuts (corresponding to the passing-
off of diffraction orders) is analyzed. 

5.4 Different methods for reconstruction 
Table  3  presents  2 × 4  methods  for  reconstructing  the  total  field  𝐄𝑡𝑜𝑡 .  This  section  qualitatively 
explains the origin for the existence of various methods. 
    As the reader may have noted, in Table 3, the analytical expressions for the reconstruction depend 
on the formula, Eq. (3) or Eq. (4), used to compute the excitation coefficient 𝛼𝑚. This is because we 
have  projected  different  state  vectors  onto  the  QNM  basis  [19].  The  projected  state  vectors  are 
[𝐄𝑆, 𝐇𝑆, 𝐏𝑆, 𝐉𝑆]𝑇 and [𝐄𝑆, 𝐇𝑆, 𝐏𝑡𝑜𝑡, 𝐉𝑡𝑜𝑡]𝑇 for  Eqs.  (3)  and  (4),  respectively.  Therefore,  when  adopting 
Eq. (3),  the  scattered  auxiliary  fields  can  be  decomposed  into  a  sum  of  QNMs,  [𝐏𝑠, 𝐉𝑠] =
(𝜀(𝜔) − 𝜀∞)[𝐄𝑠, 𝑖𝜔𝐄𝑠] = ∑ 𝛼𝑚[𝐏̃𝑚, 𝐉̃𝑚]
,  whereas,  the  same  formula  holds  for  the  total  auxiliary 
fields, [𝐏𝑡𝑜𝑡, 𝐉𝑡𝑜𝑡] = (𝜀(𝜔) − 𝜀∞)[𝐄𝑡𝑜𝑡, 𝑖𝜔𝐄𝑡𝑜𝑡] = ∑ 𝛼𝑚[𝐏̃𝑚, 𝐉̃𝑚]

, when adopting Eq. (4). 

𝑚

𝑚

    Let us now explain how the method M 4 is obtained. Let us start by reconstructing the total magnetic 
𝐇̃ 𝑚 + 𝐇𝑏. Then we use the Maxwell equation, 𝐄𝑡𝑜𝑡 =
field with the simplest formula, 𝐇𝑡𝑜𝑡 = ∑ 𝛼𝑚𝑚
[𝑖𝜔𝜀(𝜔)]−1∇ × 𝐇𝑡𝑜𝑡,  to  deduce  the 𝐄𝑡𝑜𝑡 (method  M  4  in  Table  3).  Indeed, when  all  the  QNMs  are 
𝐄̃𝑚 + 𝐄𝑏) are 
retained in the expansion, the  𝐄𝑡𝑜𝑡 expressions of methods M 4 and M 1 (𝐄𝑡𝑜𝑡 = ∑ 𝛼𝑚𝑚
mathematically equivalent; however, when truncating the series, they differ. Likewise, for dispersive 
resonators, 𝐄𝑡𝑜𝑡  can  also  be  deduced  from  the  reconstructed  auxiliary  fields 𝐏𝑡𝑜𝑡 and 𝐉𝑡𝑜𝑡 ,  therein 
leading to methods M 2 and M 3. 

It  is  natural  to  wonder  which  reconstruction  method  provides  the  most  accurate  prediction  by 
retaining the smallest number of QNMs  in the expansion.  According to our experience,  there  is no 
general answer to that question. When reconstructing the fields for plasmonic resonators [8] and high-
index dielectric Mie nanoresonators [9], we have observed that the accuracies achieved with methods 
M 2, M 3, M 4 are comparable when considering dozens of QNMs. Methods M 3 and M 4 may have a 
slightly  slower  convergence  for  high-index  nanoresonators,  possibly  because  the  contribution  of 
numerous high-frequency modes is boosted with the prefactor 𝜔̃𝑚/𝜔.  

On  the  other  hand,  we  have  observed  that  the  simplest  and  most  widespread  reconstruction 
[𝐄̃𝑚, 𝐇̃ 𝑚] + [𝐄𝑏, 𝐇𝑏]) is rarely capable of providing very accurate 
method  M 1 ([𝐄𝑡𝑜𝑡, 𝐇𝑡𝑜𝑡] = ∑ 𝛼𝑚𝑚
reconstructions (an example is provided in Fig. 4), except for some simple cases for which the optical 
response  can  be  fully  described  with  1  or  2  dominant  QNMs  [3,4].  The  reason  can  be  intuitively 
understood. Consider the reconstruction of the total electric field of a non-dispersive resonator and 
imagine that the resonator is illuminated by a plane wave. The continuity of the normal component of 
the electric displacement field across the boundary of the resonator 𝐧 ∙ 𝐃𝑡𝑜𝑡+ = 𝐧 ∙ 𝐃𝑡𝑜𝑡− has to be 
fulfilled. However, since the background electric field 𝐄𝑏 is a continuous function across the boundary 
of the resonator,  the  reconstruction with  ‘transverse’  QNMs  satisfying 𝐧 ∙ 𝐃̃ 𝑚+ = 𝐧 ∙ 𝐃̃ 𝑚− naturally 
results in a discontinuity 𝐧 ∙ (𝜀+𝐄𝑏+ − 𝜀−𝐄𝑏−) of the normal component of the electric displacement, 
which can only be compensated by the contribution of a large set of longitudinal QNMs satisfying 𝐧 ∙
𝐃̃ 𝑚+ ≠ 𝐧 ∙ 𝐃̃ 𝑚− .  These  longitudinal  QNMs  satisfy  the  source-free  Maxwell  equations  at  zero 
frequency, ∇ × 𝐄̃𝑚 = 0, and are called electric static QNMs [18,37] in the literature. We have not yet 
understood  for  which  geometry  their  contribution  is  significant  or  negligible.  However,  if  their 
contribution  cannot  be  neglected,  they  may  require  to  compute  a  large  number  of  numerical 
electroststaic-like modes with complex frequencies close to the zero frequency. In a few occasions, we 
have also computed them with the electrostatic solver of COMSOL [38]. Note that the contribution of 
the electrostatic-like modes is a smooth function of the frequency in the visible and that it is easily 
taken into account with the interpolation toolbox.  

5.5 Symmetry 
Mirror  Symmetry.  Many  optical  resonators  exhibit  mirror  symmetry,  i.e.  the  resonator  can  be 
superimposed  with  itself  by  flipping  it  with  respect  to  one  or  several  planes.  It  is  beneficial  to 
implement perfect electric/magnetic conductors (PEC/PMC) at the symmetry planes and only mesh 
one-half,  one-quarter,  or  even  one-eighth  of  the  systems,  to  speed  up  the  QNMs  computation  by 
approximately  one  order  of  magnitude  in  3D.  Depending  on  whether  the  implemented  boundary 
condition  at  the  symmetry  plane  is  PMC  or  PEC,  QNMs  with  the  specific  mirror  symmetry  will  be 
computed.  For  example,  for  a  PEC  in  the  𝑥 - 𝑦  plane,  only  the  QNM  with [𝐸̃𝑥(𝐫), 𝐸̃𝑦(𝐫), 𝐸̃𝑧(𝐫)] =
[−𝐸̃𝑥(𝐫′), −𝐸̃𝑦(𝐫′), 𝐸̃𝑧(𝐫′)], with 𝐫 = [𝑥, 𝑦, 𝑧] and 𝐫′ = [𝑥, 𝑦, −𝑧] , will be computed in the upper half-
space (𝑧 > 0). MAN includes built-in functions to automatically derive the QNM fields in the unmeshed 
space, in such case the lower half-space (𝑧 < 0).  

Axisymmetry.  3D  axisymmetric  optical  nanoresonators  are  widely  experienced  in  nanophotonics. 
Typical examples include whispering gallery resonators, spherical dimers, nanodisks, and so on. The 
QNM  computation  for  these  geometries  can  be  simplified  to  a  2D  problem  by  implementing  axial 

 
symmetry.  The average time for computing one QNM can be reduced by a few orders of magnitude, 
and numerical stability can be greatly enhanced. 

In the cylindrical coordinate system {𝜌, 𝜙, z },  the axisymmetric QNM fields can be expressed as   

𝐄̃𝑚(𝐫) = 𝐞̃𝑚(𝜌, 𝑧) exp(𝑖𝑚𝜙), and 𝐇̃ 𝑚(𝐫) = 𝐡̃ 𝑚(𝜌, 𝑧) exp(𝑖𝑚𝜙),                                                     (26) 

where 𝑚 = 0, ±1, ±2, ⋯ denotes the azimuthal order of the mode. The azimuthal dependence of the 
fields  exp(𝑖𝑚𝜙)  being  explicit,  the  determination  of  𝐞̃𝑚(𝜌, 𝑧)  and  𝐡̃ 𝑚(𝜌, 𝑧)  corresponds  to  a  2D 
problem since only two variables, 𝜌 and 𝑧, are involved. The COMSOL model QNMEig_axi_NPoM.mph 
illustrates  how  to  implement  the  axial  symmetry  illustrates  for  metal  nanocylinders  on  a  metal 
substrate  (NPoM)  or  on  a  hybrid  nanostructure  consisting  of  a  2D  material  and  a  plasmonic 
nanoantenna. They may help the user to develop their own models. 

For reciprocal systems, i.e.,  𝛍 = 𝛍T or 𝛆 = 𝛆T, the normalization of axisymmetric QNMs involves 

{𝐞̃𝑚(𝜌, 𝑧), 𝐡̃

𝑚(𝜌, 𝑧)} and  {𝐞̃−𝑚(𝜌, 𝑧), 𝐡̃

−𝑚(𝜌, 𝑧)} 

Ω∪ΩPML

𝜕(𝜔𝛆)
𝜕𝜔

𝜌 (𝐞̃−𝑚 ∙

𝑄𝑁 = 2𝜋 ∬

 𝐞̃𝑚 − 𝐡̃ −𝑚 ∙

𝜕(𝜔𝛍)
𝜕𝜔
However since  {𝐞̃𝑚(ρ, 𝑧), 𝐡̃ 𝑚(ρ, 𝑧)} can be directly deduced from {𝐞̃−𝑚(ρ, 𝑧), 𝐡̃ −𝑚(ρ, 𝑧)}, 𝐞̃𝑚  ⋅  𝜌̂ =
𝐞̃−𝑚 ⋅  𝜌̂,   𝐞̃𝑚  ⋅  𝑧̂ = 𝐞̃−𝑚 ⋅  𝑧̂,  𝐞̃𝑚  ⋅  𝜙̂ = −𝐞̃−𝑚 ⋅  𝜙̂,  𝐡̃ 𝑚  ⋅  𝜌̂ = −𝐡̃ −𝑚 ⋅  𝜌̂ , 𝐡̃ 𝑚  ⋅  𝑧̂ = −𝐡̃ −𝑚 ⋅  𝑧̂, and  
𝐡̃ 𝑚  ⋅  𝜙̂ = 𝐡̃ −𝑚 ⋅  𝜙̂, 𝑄𝑁 can be calculated with a single QNM computation. 

.                                                        (27) 

𝐡̃ 𝑚) 𝑑𝜌𝑑𝑧

6. Conclusion 

We  have  introduced  MAN,  an  open-source  MATLAB  program  to  model  light  scattering  by 
electromagnetic  resonators  based  on  quasinormal-mode  exapnsions.  The  manuscript  provides  an 
overview of the possibilities offered by the software and references the key formulas implemented in 
the  program.  MAN  also  includes  a  comprehensive  suite  of  self-contained  geometry  examples  to 
illustrate  the  program’s  capabilities  for  realistic  calculations  and  various  emblematic  resonators  in 
modern photonics. We  hope  this program will be  useful to the  nanophotonics community, and we 
welcome contributions to extend the program use cases. 

MAN  gathers  two  QNM  solvers,  QNMPole  and  QNMEig,  which  have  already  acquired  a  good 
reputation as can be seen from the number of citations of the referent publications [3,4,6] or software 
downloads [21]. QNMEig provides a comprehensive interface to the commercial software COMSOL 
Multiphysics;  QNMPole can be used with any software capable of solving Maxwell equations in the 
frequency domain. The solvers are completely different, and together, they cover a broad scope of 
applications  in  nanophotonics  and  quantum  optics,  as  illustrated  by  the  increasing  number  of 
toolboxes incorporated in the software.     

The present version achieves a major shift in the development of the software. We conclude below 

with a summary of the main new features: 

•  Unified use of the QNMEig and QNMPole solvers   
•  User-friendly TUTORIALS scripts that provide a step-by-step illustration of how to compute, 

normalize, sort, and visualize QNMs with both QNM solvers 

•  Export of QNM fields in any user-defined coordinates 
•  A set of built-in functions that provide direct access to important QNM figures of merit, e.g. 

mode volume, brightness, radiation diagram, multipolar content 

•  A dedicated toolbox for reconstructing the scattered field in the QNM basis 
•  An extended set of COMSOL models encompassing a great variety of nanophotonic devices  
•  Additional built-in material dielectric functions 

Overall, we expect that the new version is much more didactical and will assist the user to develop 

their own applications. 

Acknowledgment 

The authors acknowledge the help of Marc Duruflé (INRIA Bordeaux), Rémi Faggiani (Greenerwave), 
Jianji  Yang  (Meta/FRL),  Alexandre  Gras,  Carlo  Gigli  (EPFL),  Qiang  Bai,  Mondher  Besbes,  Jean-Paul 
Hugonin and Christophe Sauvan.  

Data Availability 

Data underlying the results presented in this paper are not publicly available at this time but may be 
obtained from the authors upon reasonable request. 

Declaration of Competing Interest  

The authors declare that they have no known competing financial interests or personal relationships 
that could have appeared to influence the work reported in this paper. 

References 

1.  P. Lalanne, W. Yan, V. Kevin, C. Sauvan, J.-P. Hugonin, Laser Photon. Rev. 12 (2018) 1700113. 
2.  C. Sauvan, T. Wu, R. Zarouf, E. A. Muljarov, P. Lalanne, Opt. Express 30 (2022) 6846. 
3.  C. Sauvan, J.-P. Hugonin, I.S. Maksymov, P. Lalanne, Phys. Rev. Lett. 110 (2013) 237401. 
4.  Q. Bai, M. Perrin, C. Sauvan, J.-P. Hugonin, P. Lalanne, Opt. Express 21 (2013) 27371. 
5.  R. Faggiani, A. Losquin, J. Yang, E. Mårsell, A. Mikkelsen, P. Lalanne, ACS Photonics 4 (2017) 

897. 

6.  W. Yan, R. Faggiani, P. Lalanne, Phys. Rev. B 97 (2018) 205422. 
7.  A. Gras, W. Yan, P. Lalanne, Opt. Lett. 44 (2019) 3494. 
8.  T. Wu, A. Baron, P. Lalanne, K. Vynck, Phys. Rev. A 101 (2020) 011803(R). 
9.  C. Gigli, T. Wu, G. Marino, A. Borne, G. Leo, P. Lalanne, ACS Photonics 7 (2020) 1197.  
10. T. Wu, D. Arrivault, M. Duruflé, A. Gras, F. Binkowski, S. Burger, W. Yan, P. Lalanne, J. Opt. Soc. 

Am. A 38 (2021) 1224. 

11. T. Wu, M. Gurioli, P. Lalanne, ACS Photonics 8 (2021) 1522. 
12. T. Wu, P. Lalanne, arXiv:2106.05502 (2021). 
13. E. A. Muljarov, W. Langbein, Phys. Rev. B 93 (2016) 075417  
14. W. C. Chew, W. H. Weedon, Microwave Opt. Technol. Lett. 7 (1994) 599. 
15. B. Vial, A. Nicolet, F. Zolla, M. Commandré, Phys. Rev. A 89 (2014) 023829. 
16. J. Yang, J.-P. Hugonin, P. Lalanne, ACS Photonics 3 (2016) 395.  
17. M. D. Truong, A. Nicolet, G. Demésy, F. Zolla, Opt. Express 28 (2020) 29016. 
18. C. Sauvan, Opt. Express 29 (2021) 8268. 
19. A. Gras, P. Lalanne, M. Duruflé, J. Opt. Soc. Am. A 37 (2020) 1219. 
20. M.  P.  Fischer,  N.  Maccaferri,  K.  Gallacher,  J.  Frigerio,  G.  Pellegrini,  D.  J.  Paul,  G.  Isella,  A. 

Leitenstorfer, P. Biagioni, D. Brida, Optica 8 (2021) 898. 

21. https://www.lp2n.institutoptique.fr/equipes-de-recherche-du-lp2n/light-complex-

nanostructures  

22. F. Binkowski, F. Betz, R. Colom, M. Hammerschmidt, L. Zschiedrich, S. Burger, Phys. Rev. B 102 

(2020) 035432. 

23. R. Alaee, C. Rockstuhl, I. Fernandez-Corbaton, Adv. Opt. Mater 7 (2019) 1800783. 
24. W. Liu, Y. Kivshar, Opt. Express 26 (2018) 13085. 
25. P. D. Terekhov, K. V. Baryshnikova, Y. A. Artemyev, A. Karabchevsky, A. S. Shalin, A. B. Evlyukhin, 

Phys. Rev. B 96 (2017) 035443. 

26. F. Zolla, A. Nicolet, G. Demésy, Opt. Lett. 43 (2018) 5813. 
27. B. Vial, G. Demésy, F. Zolla, A. Nicolet, M. Commandré, C. Hecquet, T. Begou, S. Tisserand, S. 

Gautier, V. Sauget, J. Opt. Soc. Am. B 31 (2014) 1339. 
28. P. Lalanne, G. M. Morris, J. Opt. Soc. Am. A 13 (1996) 779. 

29. A. Raman, S. Fan, Phys. Rev. Lett. 104 (2010) 087401. 
30. A. Taflove, S.G. Johnson, A. Oskooi, (Artech House, Boston, Mass., 2013). "Advances in FDTD 

Computational Electrodynamics: Photonics and Nanotechnology" 

31. J. Zimmerling, L. Wei, P. Urbach, R. Remis, J. Comput. Phys. 315 (2016) 348. 
32. R. Faggiani, J. Yang, R. Hostein, P. Lalanne, Optica 4 (2017) 393. 
33. R. M. More, Phys. Rev. A 4 (1971) 1782. 
34. [C. E. Baum, Interaction Note 88, December 1971. See 

https://apps.dtic.mil/sti/citations/ADA066905 

35. P. T. Leung, S. Y. Liu, K. Young, Phys. Rev. A 49 (1994) 3057. 
36. L. Zschiedrich, F. Binkowski, N. Nikolay, O. Benson, G. Kewes, S. Burger, Phys. Rev. A 98 (2018) 

043806. 

37. M. B. Doost, W. Langbein, E. A. Muljarov, Phys. Rev. A 90 (2014) 013834. 
38. W. Yan, P. Lalanne, M. Qiu, Phys. Rev. Lett. 125 (2020) 013901. 

