Designing a Sample Stage for Detecting Magnetic Field Feedback of
Superconducting Materials Based on Numerical Simulation of Electromagnetic Fields

Ziyan Li and Mengbo Guo
Physics Department, Wuhan University, Wuhan 430072, China
(Dated: June 14, 2022)

To explore the feedback of two-dimensional superconducting materials to the external magnetic ﬁeld, these
materials will be put inside an analyzer chamber under ultra-high vacuum conditions so that the temperature
could be easily adjusted to a low temperature below 1K. Therefore, to realize the placement and acceptance of
the magnetic ﬁeld, we designed a device consisting of a drive coil and a receiver coil. The drive coil inputs
an external magnetic ﬁeld to the superconducting material while the receiving coil receives the magnetic ﬁeld
feedback. Superconducting materials are placed right below these coils and the distance between the coil and
the material is adjustable. Instead of using commercial COMSOL software to achieve the evaluation of the
electromagnetic ﬁelds[1], the highlight of the article is to accurately determine the size and parameters of the
device based on the ﬁrst-principles numerical simulation of electromagnetic ﬁelds throughout space.

I. EXPERIMENTAL NEEDS

(a)

(b)

FIG. 1. (a) Top view of the EDA vacuum system and the analyzer
chamber with the ellipsoidal display. (b) Sample stage for holding
superconducting materials

In experiments to explore the magnetic properties of su-
perconducting materials, ultra-high vacuum and low temper-
ature are often necessary conditions. Therefore, experiments
are often carried out in a highly conﬁned space, such as the
analyzer chamber[2] in Fig.1(a). The sample material to be
tested is placed on the sample stage in Fig.1(b) and sent into
the chamber. Once the sample stage is in place, the interior of
the chamber must be isolated from the outside world. How-
ever, this isolation is not conducive to detecting the feedback
of the superconducting material to the applied magnetic ﬁeld.
Because it is not easy for us to apply a magnetic ﬁeld and it is
difﬁcult to collect the magnetic ﬁeld that the superconducting
material feeds back to us.

In order to realize the measurement of the magnetic ﬁeld in

the closed cavity, we modiﬁed the sample stage to facilitate
the application of the electromagnetic ﬁeld and the feedback
of the magnetic ﬁeld from the superconducting material. The
key point of designing this new sample stage is how to deter-
mine the parameters of this sample stage with high accuracy
so that the collected feedback magnetic ﬁeld is large enough
to be measured. In the process of numerical simulation of the
magnetic ﬁeld distribution in space, we refer to the relevant
theory of superconducting materials for the feedback of exter-
nal magnetic ﬁeld (Meisner effect[3]).

The mirror method[4] is used to estimate feedback in super-
conducting materials, which is a kind of numerical simulation
based on ﬁrst principles and will be explained later. Com-
pared with the commercial software COMSOL for simulation,
its advantage is that it can easily change various parameter set-
tings, and can achieve the same accurate numerical simulation
effect as COMSOL.

II. NUMERICAL SIMULATION MODEL

The simulation of the magnetic ﬁeld in space is based on the
Biot-Savart law[5], and combined with the shape and size of
the magnetic ﬁeld source, the magnetic ﬁeld distribution in the
space is calculated to realize the numerical simulation of the
magnetic ﬁeld. In order to simultaneously apply the magnetic
ﬁeld and detect the receiving magnetic ﬁeld, we place the coil
for applying the magnetic ﬁeld in the middle of the upper and
lower coils for receiving the magnetic ﬁeld, and the sample
material to be detected is placed directly under these coils.

A. Drive Coils to Apply the Magnetic Field

The drive coils in the FIG.2 is connected to the external AC
power supply. The current in the coil satisﬁes I = I0sin(ωt), in
which I0 represents the amplitude of the current and ω = 2π f
represents the angular frequency. Using Biot-Savart law, we
can ﬁnd the magnitude of the magnetic ﬁeld of each coil at a

2
2
0
2

n
u
J

2
1

]
n
o
c
-
r
p
u
s
.
t
a
m
-
d
n
o
c
[

1
v
6
8
6
5
0
.

6
0
2
2
:
v
i
X
r
a

 
 
 
 
 
 
The mirror method is used to simulate the magnetic ﬁeld
feedback that occurs when the sample material is supercon-
ducting.

2

FIG. 3. Above the sample is a receiving coil, which is connected to a
current signal ampliﬁer for converting the magnetic ﬁeld fed back by
the superconducting material into current and amplifying it. Below
the sample is a mirror image of the drive coil relative to the sample
to simulate the feedback magnetic ﬁeld generated by the sample.

In order to simplify the calculation and ensure that the error
is within a controllable range at the same time. We assume
that the magnetic ﬁeld generated by the mirror coil in the re-
ceiving coil is constant and can be replaced by the magnetic
ﬁeld generated by the mirror coil in the middle of the receiv-
ing coil. The distance between the top of the mirror coil and
the middle of the upper and lower coils can be recorded as
Hupper and Hlower respectively.

Using equation (2) and Faraday’s law of electromagnetic
induction[9, 10], the electromotive force generated by the mir-
ror coil at the upper and lower parts of the receiving coil can
be obtained:

Ulower = −NRec

dΦlower
dt

= −NRec

d[BDrive(Hlower, NDri)]z × πr2
dt

coil

(3a)

Uupper = −NRec

dΦupper
dt

= −NRec

d[BDrive(Hupper, NDri)]z × πr2
dt

coil

(3b)

∆U = |Uupper −Ulower|

(3c)

The potential difference shown in equation (3c) can be am-
pliﬁed by the ampliﬁer[11, 12] for subsequent analysis and
processing. The existing instrument can measure the poten-
tial difference greater than 100nV. That is to say, as long as
the measured potential difference is greater than 100nV, it can
meet the needs of the experiment.

We substitute all parameters into equation (3c) and we

could rewrite it in the way:

FIG. 2. The drive coil is connected to the power supply and the
magnetic ﬁeld is passed through the sample material directly below

point on its axis at a distance h(the radius of the coil is rcoil):

B(h) =

µ0
4π

(cid:73) Idr(cid:48) × (r − r(cid:48))
|r − r(cid:48)|3

=

µ0I
4π

Nθ
∑
i(cid:48)=0

rcoildθ (cid:126)eθi(cid:48) × (−r(cid:48))

(h2 + r2

coil)

3
2

(1)
The equation (1) represents the discretization of Biot-Savart
law[6–8], the circumference angle is discretized into Ntheta
parts. The number of the drive coils is NDri and the over-
all length of these coils is LDri. We sum the magnetic ﬁeld
strengths generated by each coil on the axis to obtain the mag-
netic ﬁeld distribution on the axis of the drive coils.

BDrive(H0, NDri) =

NDri−1
∑
i=0

B(h0 + i∆L)

(2)

The distance between adjacent coils ∆L in equation(2) is
determined by LDri/NDri, and LDri is often deterministic for a
model. It is worth noting that h0 refers to the distance between
the bottom of the drive coil and a point on the axis. For exam-
ple, if we consider the distance from the center of the sample
then h0 = H0 (See FIG. 2)

B. Magnetic Field Feedback and Mirror Method

The magnetic ﬁeld generated by the driving coil will pass
through the sample material directly below. When the temper-
ature drops below the superconducting critical temperature, a
surface current will form on the surface of the sample accord-
ing to the Meissner effect (Appendix A), and the magnetic
ﬁeld generated by the surface current will change the magnetic
ﬁeld in the entire space. Such changes should be accepted and
analyzed.

We place two coils with the same parameters in terms of
number of turns NRec, radius rcoil, and total length LRec on the
upper and lower sides of the driving coil at equal distances, so
as to eliminate the inﬂuence of the magnetic ﬁeld generated by
the driving coil on the loop where the receiving coil is located
(produced equal large but reverse electromotive force).

∆U = NRec f πr2

coil

µ0Irms
2

|

NDri−1
∑
i=0

(cid:110) Nθ
∑
i(cid:48)=0

rcoildθ [ (cid:126)eθi(cid:48) × (−r(cid:48))]z
)2 + r2

[(Hupper + i × LDri
NDri

coil]

Nθ
∑
i(cid:48)(cid:48)=0

−

3
2

rcoildθ [ (cid:126)eθi(cid:48)(cid:48) × (−r(cid:48)(cid:48))]z
)2 + r2

[(Hlower + i × LDri
NDri

coil]

3

(4)

(cid:111)
|

3
2

TABLE I. Other parameters except NRec and NDri, referring to the
speciﬁcations and sizes of speciﬁc experimental equipment. Irms is
the rms value of the alternating current in the drive line.

the coils will be would be smaller than the size of the coil
itself, which is impossible. We can take NDri=40, NRec=30 so
the corresponding ∆U is 314.06nV. It is already greater than
the detectable 100nV, so this turns ratio is acceptable.

f /kHz rcoil/mm Irms/µA Hlower/mm Hupper/mm LDri/mm Nθ
100
17.5
100

30.5

500

8

2

D. The Boundary Effect

However, an important prerequisite for the feasibility of the
mirror method is that we can ignore the boundary effect of the
sample[13–16], which requires the sample to be large enough.
Therefore, we need to estimate the magnitude of the magnetic
ﬁeld generated by the drive coil on the sample surface to en-
sure the radius R of the sample is larger than a critical value
so that the magnetic ﬁeld generated by the drive coil outside
this radius is negligible.

C. Determination of Parameters in the Model

Equation 4 provides many parameters, many of which are
inconvenient to change, such as NRec, NDri, rcoil, ∆L, so this
requires us to ﬁx these parameters when designing the model.
It is also the meaning of numerical simulation, to determine
in advance some parameters that are inconvenient to change
in the experiment so as to ensure that the voltage difference
received by the receiving coil during the experiment is basi-
cally within the range that can be detected. In other words to
make ∆U as large as possible. This is the purpose and core of
the entire numerical simulation.

In practice, the total length of the coil is always within a cer-
tain range, that is to say, LDri and LRec should match the size
of other experimental equipment. In the process of numerical
simulation, only NDri and NRec are to be ﬁxed. Therefore, we
select appropriate values for other parameters in TABLE I, in
order to ﬁnd the appropriate NDri and NRec to maximize the
∆U.

(a)

(b)

FIG. 5.
(a) Convergence of magnetic ﬂux in the sample material
given different height H0=8mm, 10mm and 12mm. The abscissa R
is the radius of the sample. (b) The magnetic ﬁeld distribution in the
sample plane with length 50mm and height H0=10mm

FIG 5(a) proves that the magnetic ﬂux on the sample sur-
face has converged to a ﬁxed value when the sample radius

FIG. 4. The result of the numerical calculation of the voltage differ-
ence. The voltage difference increases with the increase of NRec and
NDri. ∆U exceeds 600nV when NRec = NDri = 50.

FIG 4 shows the results of the numerical calculation of the
voltage difference. It can be seen that the calculated voltage
difference increases with the number of turns of the driving
coils and the receiving coils. However, the number of coil
turns should not be too large, otherwise the distance between

4

(a) Front View

(b) Left View

(c) Top View

(d) Whole Model

FIG. 6. Three views and 3D model made with SOLIDWORKS software. In order to facilitate the drawing of the three views, the proportions
consistent with the stated scale are not taken. (a) The front view, A is the interlayer where the receiving coil is placed; B is the hole for
connecting the external power supply; C is the interlayer where the driving coil is placed; D is the sample stage where the sample is placed.
(b) The left view. (c) The top view. (d) The view of the whole model.

is greater than 25mm, while FIG 5(b) can prove that when
the sample size exceeds this critical value, the magnetic ﬁeld
strength outside this radius is almost negligible.

In fact,

there are other numerical simulation meth-
ods(details in Appendix B), but they all need to consider the
boundary effects of electromagnetic ﬁelds.

III.

3D MODELING OF THE DEVICE

Using the parameters given in section II C, we can use
SOLIDWORKS software to draw the 3D model[17, 18] to
have an intuitive understanding of the model. The scale of
the drawing is not drawn according to the real scale, this is for
the convenience of display.

From the main view in FIG 6(a), we can see that the entire
model is mainly composed of two parts: a movable cylindrical
barrel for loading coils and a sample stage for placing sam-
ples. The cylindrical barrel consists of three layers, the mid-
dle layer is used to place the driving coil, the upper and lower
layers are used to place the receiving coil, and each layer has
holes to connect with the external driving circuit or receiving
circuit. Just below the cylindrical barrel is the place to carry
the sample, and the distance H0 from the sample to the bottom
of the cylindrical barrel can be changed as required.

ACKNOWLEDGMENTS

We wish to acknowledge the support of Professor Jing Shi
from Wuhan University, China, encouraging we to ﬁnish and
perfect this project. We also wish to acknowledge the guid-
ance of Professor Yuanbo Zhang, Master Zhiwei Huang and
Master Hengsheng Luo from Fudan University, China, pro-
viding the experimental environment and giving some impor-
tant suggestions.

AUTHOR DECLARATIONS

Conﬂict of Interest

The authors declare no conﬂicts of interest.

Author Contributions

Ziyan Li is the major contributor and Mengbo Guo is the

minor contributor.

Appendix A: Meissner Effect and London Equation

The Meissner effect refers to the superconductivity that oc-
curs when a material changes from a normal state to a super-
conducting state with an applied magnetic ﬁeld. Since this
phenomenon[19] was discovered in 1933, people have been
looking for relevant theories to explain it, and the London
equation[20] proposed by the London brothers is a relatively
classic and simple explanation model.

This model assumes that electrons in the superconducting
state can be divided into two types: electrons in the normal
state and electrons in the superconducting state. The surface
current density of the material can be related to the corre-
sponding magnetic vector potential:

J = −

nse2
me

A

(A1)

Take the curl for quantities in both sides. Then we can get

the relation between current density and magnetic ﬁeld:

∇ × J = −

nse2
me

B

Combining the Maxwell’s equation[21, 22]:

∇ × B = µ0J

(A2)

(A3)

Combining all the above formulas to obtain the magnetic

ﬁeld:

B(x) = B0exp(−

x
λ

)

(A4)

In equation A4, we ﬁnd that the magnetic ﬁeld B decreases
exponentially, indicating that the magnetic ﬁeld cannot pene-
trate the surface of the sample, which is also the reason why
the magnetic ﬁeld B has no vertical component inside the sam-
ple.

5

FIG. 8. Ring current used in place of surface current.

A, this method replaces the surface currents with a loop of
toroidal currents.

As long as the ring current is determined, the feedback
magnetic ﬁeld of the superconducting material can be calcu-
lated by using the Biot-Savart law. The method of conﬁrming
the magnitude of the current is to use the sum of the mag-
netic ﬂuxes generated by the annular current[25, 26] inside it
to be equal to the magnetic ﬂuxes generated by the external
magnetic ﬁeld.

Similar to equation 1 , taking the center of the ring current
as the origin, we can ﬁnd the vertical component of the mag-
netic ﬁeld generated by the ring current at its interior r:

Bsur f (r) =

µ0I
4π

Nθ
∑
i(cid:48)=0

|r|dθ (cid:126)eθi(cid:48) × (r − r(cid:48))
|r − r(cid:48)|3

(B1)

FIG. 7. Surface current generated when a magnetic ﬁeld is applied
directly over a superconducting sample.

As shown in FIG. 7, we can use the formula for surface
current to calculate the magnetic ﬁeld feedback generated by
the sample, but this approach is essentially consistent with the
mirror method. The mirror method makes the numerical cal-
culation of this model easier, so we do not encourage numeri-
cal calculation using the surface current method[23, 24].

Appendix B: Numerical Simulation Based on Annular Current

FIG. 9. Ring current used in place of surface current.

Integrating the magnetic ﬁeld inside the ring current can get

the magnetic ﬂux Φsur f generated by the ring current:

This is also a method similar to using surface currents
to simulate feedback magnetic ﬁelds, but unlike Appendix

Φsur f =

(cid:90) Rsur f

0

|Bsur f |z2πrdr

(B2)

As for the sum of the magnetic ﬂuxes ΦDri generated by
the driving coil inside the annular current, it is not difﬁcult to
obtain it by analogy with equation 2. The derivation process
is very simple, so it is not expanded here. Therefore, we can
obtain the equation for solving the magnitude of the annular
current:

Φsur f + ΦDri = 0

(B3)

6

When we take the same parameters as in Table I and choose
different radii of the ring current, the potential difference cal-
culated by the method of annular current is shown in FIG. 9.

It can be seen from FIG. 9 that the potential difference cal-
culated by the ring current will vary with the radius Rsur f
taken, indicating that this is not a suitable method. What’s
more, the maximum value is about 115nV, which is lower than
the 314.06nV measured by the mirror method.

[1] S. Liao, W. Li, S. Lin, K. Tang, C. Liou, and C. Tsou, Sensors

Transactions on Industrial Electronics 67, 1348 (2020).

and Actuators A: Physical 269, 99 (2018).

[14] G. Shou, L. Xia, F. Liu, M. Zhu, Y. Li, and S. Crozier, IEEE

[2] T. Dütemeyer, C. Quitmann, M. Kitz, K. Dörnemann, L. Jo-
hansson, and B. Reihl, Review of Scientiﬁc Instruments 72,
2638 (2001).

[3] H. Essén and M. C. Fiolhais, American Journal of Physics 80,

164 (2012).

[4] T. Emig, Journal of Statistical Mechanics: Theory and Experi-

ment 2008, P04007 (2008).

Transactions on Magnetics 46, 1052 (2010).

[15] T. Evans, R. Moyer, J. Watkins, P. Thomas, T. Osborne,
J. Boedo, M. Fenstermacher, K. Finken, R. Groebner, M. Groth,
J. Harris, G. Jackson, R. L. Haye, C. Lasnier, M. Schaffer,
G. Wang, and L. Zeng, Journal of Nuclear Materials 337-339,
691 (2005), pSI-16.

[16] B. W. Yu and S. L. Girshick, Journal of applied physics 69, 656

[5] T. Charitat and F. Graner, European Journal of Physics 24, 267

(1991).

(2003).

[17] P. Schilling and R. Shih, Parametric Modeling with SOLID-

[6] M. Albani and P. Bernardi, IEEE Transactions on Microwave

WORKS 2019 (SDC Publications, 2019).

Theory and Techniques 22, 446 (1974).

[18] J. E. Akin, Finite element analysis concepts: via SolidWorks

[7] K. Árnason, in Three-Dimensional Electromagnetics (Society

(World Scientiﬁc, 2010).

of Exploration Geophysicists, 1999) pp. 103–118.

[8] A. Bossavit, in Numerical Methods in Electromagnetics, Hand-
book of Numerical Analysis, Vol. 13 (Elsevier, 2005) pp. 105–
197.

[9] G. Giuliani, EPL (Europhysics Letters) 81, 60002 (2008).
[10] I. Galili, D. Kaplan,

and Y. Lehavi, American journal of

physics 74, 337 (2006).

[11] A. Uranga, N. Lago, X. Navarro, and N. Barniol, in 2004 IEEE
International Symposium on Circuits and Systems (IEEE Cat.
No.04CH37512), Vol. 4 (2004) pp. IV–21.

[12] S. GUIDE, Power 18, 11.
[13] D. Pan, S. Lin, L. Li, J. Li, Y. Jin, Z. Sun, and T. Liu, IEEE

[19] P. Anderson and B. Matthias, Science 144, 373 (1964).
[20] N. Kaloper and A. Lawrence, Physical Review D 95, 063526

(2017).

[21] M. Lax and D. Nelson, Physical Review B 13, 1777 (1976).
[22] F. Assous, P. Degond, E. Heintze, P. Raviart, and J. Segre, Jour-

nal of Computational Physics 109, 222 (1993).

[23] V. Gurevich and R. Laiho, Physical Review B 48, 8307 (1993).
[24] V. Gurevich, R. Laiho, and A. Lashkul, Physical review letters

69, 180 (1992).

[25] L. Tsai, IEEE Transactions on Antennas and Propagation 20,

569 (1972).

[26] D. Webb and G. Hewitt, International Journal of Multiphase

Flow 2, 35 (1975).

